*% IF FIN_PUT_RCE_QC2                                             
      *<<<< FIN_PUT_RCE_QC2                                             
           IF RCE-COD-SIST IN QC2-FLD NOT > SPACES                          
              IF SCR-SISG NOT > SPACES                                     
           DISPLAY 'RCE-COD-SIST IN QC2-FLD 002'
                 MOVE SCR-SIST TO RCE-COD-SIST IN QC2-FLD
              ELSE                                                         
           DISPLAY 'RCE-COD-SIST IN QC2-FLD 003'
                 MOVE SCR-SISG TO RCE-COD-SIST IN QC2-FLD.    
      *BUS-TAB busca glosa de codigo en tabla                           
           MOVE 'GNS'                   TO TAB-COD-SIST.   
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.                                          
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SIST IN QC2-FLD.     

      *     IF SCR-SISG NOT > SPACES                                     
      *           MOVE SCR-SIST TO TAB-COD-SIST                            
      *        ELSE                                                         
      *           MOVE SCR-SISG TO TAB-COD-SIST.                           
      *BUS-TAB busca glosa de codigo en tabla                           
           IF RCE-COD-ENTI IN QC2-FLD > SPACES                          
              MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-SIST
              MOVE 'ENT'                   TO TAB-COD-TTAB IN TAB
              MOVE RCE-COD-ENTI IN QC2-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                          
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN QC2-FLD.     
      *>>>>                                                             

*% END
*% IF FIN_PUT_DBC_QC2
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE SPACES   TO DBC-GLS-NOMC IN QC2-FLD.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN QC2-FLD.
*% END
*% IF INI_KEY_RCE_QC2
      *<<<< INI_KEY_RCE_CMT                                             
           MOVE SPACES TO RCE-COD-SENT IN RCE.                          
      *>>>>                                                             
*% END
*% IF FIN_KEY_RCE_QC2                                             

      *<<<< FIN_KEY_RCE_QC2                                             
      *     IF SCR-SISG NOT > SPACES                                     
      *         MOVE SCR-SIST TO RCE-COD-SIST                            
      *     ELSE                                                         
      *         MOVE SCR-SISG TO RCE-COD-SIST.                           
      *>>>>                                                             

*% END
*% IF RCE_COD_SIST

           IF RCE-COD-SIST IN QC2-FLD NOT > SPACES AND
      *RGD-INI 12-01-2018
              (FRM-COD-AUTD IN QC2-FLD > SPACES OR
               FRM-FEC-FDES IN QC2-FLD > ZEROES OR
               FRM-FEC-FHAS IN QC2-FLD > ZEROES OR
               FRM-CAI-IENT IN QC2-FLD > SPACES OR
               FRM-IIC-IENT IN QC2-FLD > SPACES ) 
      *RGD-FIN
               GO TO FIN-VAL-RCE-COD-SIST.

           IF RCE-COD-SIST IN QC2-FLD NOT > SPACES                          
              IF SCR-SISG NOT > SPACES                                     
           DISPLAY 'RCE-COD-SIST IN QC2-FLD 004'
                 MOVE SCR-SIST TO RCE-COD-SIST IN QC2-FLD
              ELSE                                                         
           DISPLAY 'RCE-COD-SIST IN QC2-FLD 005'
                 MOVE SCR-SISG TO RCE-COD-SIST IN QC2-FLD.                           
      *BUS-TAB busca glosa de codigo en tabla                           
           MOVE 'GNS'                   TO TAB-COD-SIST.                            
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
           ELSE
               MOVE TAB-GLS-DESC TO FRM-GLS-SIST IN QC2-FLD.

*% END
*% IF RCE_COD_ENTI                                                

      *<<<< RCE_COD_ENTI                                                
      *RGD-INI
           IF (FRM-COD-AUTD IN QC2-FLD > SPACES OR
               FRM-FEC-FDES IN QC2-FLD > ZEROES OR
      *RGD-INI 12-01-2018
      *        FRM-FEC-FHAS IN QC2-FLD > ZEROES ) AND
               FRM-FEC-FHAS IN QC2-FLD > ZEROES OR
               FRM-CAI-IENT IN QC2-FLD > SPACES OR
               FRM-IIC-IENT IN QC2-FLD > SPACES ) AND
      *RGD-FIN
               RCE-COD-ENTI IN QC2-FLD NOT > SPACES
              GO TO FIN-VAL-RCE-COD-ENTI.
      *RGD-FIN
           IF SCR-IINS = WSS-YA-BUSQUE-GLOSAS                           
               GO TO FIN-VAL-RCE-COD-ENTI.                              
      *RGD-INI
            MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-SIST.
      *     IF SCR-SISG NOT > SPACES                                     
      *         MOVE SCR-SIST TO TAB-COD-SIST                            
      *     ELSE                                                         
      *         MOVE SCR-SISG TO TAB-COD-SIST.                           
      *RGD-FIN

           IF RCE-COD-ENTI IN QC2-FLD > SPACES                          
               GO TO CON-VAL-RCE-COD-ENTI.                              

           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 )           
               PERFORM ERR-GLS                                          
               GO TO FIN-VAL-RCE-COD-ENTI.                              

           MOVE 'ENT'        TO TAB-COD-TTAB IN TAB.                          
           MOVE SPACES       TO TAB-COD-CTAB IN TAB.                          
           MOVE TAB-COD-SIST TO FIO-SIST.                               
           MOVE FIO-GET-NLS  TO FIO-CMND.                               

       LUP-VAL-RCE-COD-ENTI.                                            
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'ENT'              
               IF TAB-COD-CTAB IN TAB > SPACES AND                      
                  TAB-MSC-STAT IN TAB NOT = 'N'                         
                   MOVE TAB-COD-CTAB IN TAB TO RCE-COD-ENTI IN QC2-FLD  
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN QC2-FLD  
                   PERFORM BUS-FRM-NORD                                 
                   PERFORM BUS-KEY-QUE                                  
                   GO TO FIN-VAL-RCE-COD-ENTI                           
               ELSE                                                     
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO LUP-VAL-RCE-COD-ENTI                           
           ELSE                                                         
               MOVE 'GNS'        TO MSG-COD-SIST                        
               MOVE 'CODCTABNEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-RCE-COD-ENTI.                              
               
               
               
               
       CON-VAL-RCE-COD-ENTI.                                            
      *    Valida codigo de tabla                                       
           MOVE 'ENT' TO TAB-COD-TTAB IN TAB.                           
           MOVE RCE-COD-ENTI IN QC2-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             

           IF MSG-COD-MENS NOT = 'COD    NEX' AND                       
              RCE-COD-ENTI IN QC2-FLD > SPACES                          
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN QC2-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-ENTI IN QC2-FLD.                  

           IF FRM-SUAR = FRM-SUAR-MAL                                   
               GO TO FIN-VAL-RCE-COD-ENTI.                              

           PERFORM CLR-KEY-KFRM.                                        
           PERFORM BUS-FRM-NORD.                                        
           PERFORM BUS-KEY-QUE.                                         
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               GO TO FIN-VAL-RCE-COD-ENTI.                              

           MOVE FRM-CPIM-AEY TO RCE-COD-ENTI-ATR IN QC2-FLD.            

           MOVE 'GNS'          TO MSG-COD-SIST.   
           MOVE 'GKY    KEYS+' TO MSG-COD-MENS.                         
           PERFORM GET-MSG.                                             

           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
           MOVE WSS-YA-BUSQUE-GLOSAS TO SCR-IINS.                       
      *>>>>                                                             
*% END
*% IF FRM_COD_AUTD
      *RGD-INI 
           IF RCE-COD-SIST IN QC2-FLD > SPACES OR 
      *RGD-INI 12-01-2018
      *       RCE-COD-ENTI IN QC2-FLD > SPACES
              RCE-COD-ENTI IN QC2-FLD > SPACES OR
              FRM-CAI-IENT IN QC2-FLD > SPACES OR
              FRM-IIC-IENT IN QC2-FLD > SPACES 
      *RGD-FIN
              GO TO FIN-VAL-FRM-COD-AUTD.    
              
           IF FRM-COD-AUTD IN QC2-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-COD-AUTD.    
              
           MOVE 'USR'        TO USR-COD-TTAB IN USR.                 
           MOVE FRM-COD-AUTD IN QC2-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           IF NOT FIO-STAT-OKS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               MOVE USR-GLS-DESC IN USR TO FRM-MENS
               GO TO FIN-VAL-FRM-COD-AUTD.
           
      *RGD-FIN
*% END
*% IF FRM_FEC_FDES

      *RGD-INI 
           IF RCE-COD-SIST IN QC2-FLD > SPACES OR 
      *RGD-INI 12-01-2018
      *       RCE-COD-ENTI IN QC2-FLD > SPACES
              RCE-COD-ENTI IN QC2-FLD > SPACES OR
              FRM-CAI-IENT IN QC2-FLD > SPACES OR
              FRM-IIC-IENT IN QC2-FLD > SPACES 
      *RGD-FIN
              GO TO FIN-VAL-FRM-FEC-FDES.    

           IF FRM-FEC-FDES IN QC2-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-FEC-FDES.    
      *RGD-FIN
*% END
*% IF FRM_FEC_FHAS
      *RGD-INI 
           IF RCE-COD-SIST IN QC2-FLD > SPACES OR 
      *RGD-INI 12-01-2018
      *       RCE-COD-ENTI IN QC2-FLD > SPACES
              RCE-COD-ENTI IN QC2-FLD > SPACES OR
              FRM-CAI-IENT IN QC2-FLD > SPACES OR
              FRM-IIC-IENT IN QC2-FLD > SPACES 
      *RGD-FIN
              GO TO FIN-VAL-FRM-FEC-FHAS.    

           IF FRM-FEC-FHAS IN QC2-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-FEC-FHAS.    
      *RGD-FIN
*% END
*% IF FIN_FRM_FEC_FHAS

      *RGD-INI 
           MOVE FRM-NUM-DDES IN QC2-FLD TO WSS-NUM-DDES.
           MOVE FRM-NUM-MDES IN QC2-FLD TO WSS-NUM-MDES.
           MOVE FRM-NUM-SDES IN QC2-FLD TO WSS-NUM-SDES.
           MOVE FRM-NUM-ADES IN QC2-FLD TO WSS-NUM-ADES.
           MOVE FRM-NUM-DHAS IN QC2-FLD TO WSS-NUM-DHAS.
           MOVE FRM-NUM-MHAS IN QC2-FLD TO WSS-NUM-MHAS.
           MOVE FRM-NUM-SHAS IN QC2-FLD TO WSS-NUM-SHAS.
           MOVE FRM-NUM-AHAS IN QC2-FLD TO WSS-NUM-AHAS.
           IF WSS-FEC-HASTA NOT >= WSS-FEC-DESDE
              MOVE 'GNS'          TO MSG-COD-SIST                        
              MOVE 'FECDESHASERR' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                          
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *RGD-FIN
*% END
*% IF FRM_IIC_IENT
      *RGD-INI 12-01-2018
           IF RCE-COD-SIST IN QC2-FLD > SPACES OR 
              RCE-COD-ENTI IN QC2-FLD > SPACES OR
              FRM-COD-AUTD IN QC2-FLD > SPACES OR
              FRM-FEC-FDES IN QC2-FLD > ZEROES OR
              FRM-FEC-FHAS IN QC2-FLD > ZEROES
              GO TO FIN-VAL-FRM-IIC-IENT.    

           IF FRM-IIC-IENT IN QC2-FLD  NOT > ZEROES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-IIC-IENT.    
      *RGD-FIN
*% END
*% IF EOF_BQ
      *<<<< EOF                                                         
       BUS-FRM-NORD SECTION.                                            
       INI-BUS-FRM-NROD.                                                
           MOVE SPACES TO WSS-COD-CTAB.                                 
           MOVE 'CMT'  TO WSS-COD-TENT.                                 
           MOVE RCE-COD-ENTI IN QC2-FLD TO WSS-COD-ENTX.                
      *RGD-INI
            IF RCE-COD-SIST IN QC2-FLD > SPACES
               MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-SIST FIO-SIST
            ELSE
      *RGD FIN
            IF SCR-SISG NOT > SPACES                                     
                MOVE SCR-SIST TO TAB-COD-SIST FIO-SIST                            
            ELSE                                                         
                MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST.                           
               
           MOVE 'FRM'        TO TAB-COD-TTAB IN TAB.                    
           MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-BUS-FRM-NORD.                                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               IF FIO-CMND = FIO-GET-NXT                                
      *RGD-INI
      *            MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-SIST FIO-SIST
                 MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST               
      *RGD-FIN
                  MOVE FIO-END-BRW TO FIO-CMND                         
                  PERFORM GNS-FIO-TAB                                  
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB                 
               IF WSS-COD-ENTX NOT = RCE-COD-ENTI IN QC2-FLD            
      *RGD-INI
      *            MOVE RCE-COD-SIST IN QC2-FLD TO TAB-COD-SIST FIO-SIST
                 MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST               
      *RGD-FIN
                   MOVE FIO-END-BRW TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB.                                 
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.                    
           IF NOT ( FIO-STAT-OKS AND WSS-COD-TENT = 'CMT' AND           
                    WSS-COD-ENTX = RCE-COD-ENTI IN QC2-FLD )            
               GO TO FIN-BUS-FRM-NORD.                
               
           IF TAB-GLS-DESC IN TAB NOT > SPACES OR                       
              TAB-MSC-STAT IN TAB = 'N'                                 
               GO TO NXT-BUS-FRM-NORD.                                  
               
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-NORD.                    
           IF WSS-COD-CORR = '01'                                       
               MOVE TAB-GLS-DCOR TO FRM-GLS-TNOM IN QC2-FLD             
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(1)                     
               IF SCR-CCPP NOT = 'ING'                                  
                   MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR IN QC2-FLD     
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF WSS-COD-CORR = '02'                                       
               MOVE TAB-GLS-DCOR TO FRM-GLS-TIDC IN QC2-FLD             
               MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN QC2-FLD         
               MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN QC2-FLD         
               MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN QC2-FLD         
               MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN QC2-FLD         
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(1)                     
           ELSE                                                         
           IF WSS-COD-CORR = '03'                                       
               MOVE TAB-GLS-DCOR TO FRM-GLS-TOPE IN QC2-FLD             
               MOVE FRM-CPIM-UBY TO FRM-CAI-IOPE-ATR IN QC2-FLD         
               MOVE FRM-CPIM-UBY TO FRM-IIC-IOPE-ATR IN QC2-FLD         
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(2)                
           ELSE                                                         
           IF WSS-COD-CORR = '04'                                       
               MOVE TAB-GLS-DCOR TO FRM-GLS-TFEC IN QC2-FLD             
               MOVE FRM-CPIM-UBY TO FRM-FEC-FENT-ATR IN QC2-FLD         
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(3)                     
           ELSE                                                         
           IF WSS-COD-CORR = '05'                                       
               MOVE TAB-GLS-ABRV TO FRM-GLS-TNRO IN QC2-FLD             
               MOVE FRM-CPIM-UBY TO FRM-NUM-IENT-ATR IN QC2-FLD         
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(4)                     
           ELSE                                                         
           IF WSS-COD-CORR = '06'                                       
               MOVE TAB-GLS-DCOR TO FRM-GLS-TCOD IN QC2-FLD             
               MOVE FRM-CPIM-UBY TO FRM-COD-IENT-ATR IN QC2-FLD         
               MOVE WSS-NUM-NORD TO SCR-NUM-NORD(5).                    
               
       NXT-BUS-FRM-NORD.                                                
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-BUS-FRM-NORD.                                      
       FIN-BUS-FRM-NORD.                                                
           EXIT.                                                        

       BUS-KEY-QUE SECTION.                                             
       INI-BUS-KEY-QUE.                                                 
           PERFORM GNS-ERR-QUE.                                             
           MOVE EIBTRMID TO QUE-TERM.                                   
           MOVE 'KEY'    TO QUE-TYPE.                                   
           MOVE     1    TO QUE-NITM.                                   
           MOVE +3000    TO QUE-LITM.                                   
           MOVE QUE-GET  TO QUE-CMND.                                   
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
                IF QUE-IKEY = 'ENT'                                     
                    MOVE QUE-DATA TO KEY-VARI                           
                    MOVE KEY-COD-ENTI TO RCE-COD-ENTI IN QC2-FLD        
                    MOVE KEY-GLS-NOMC TO DBC-GLS-NOMC IN QC2-FLD        
                    MOVE KEY-NUM-ICLI TO DBC-NUM-ICLI IN QC2-FLD        
                    MOVE KEY-VRF-ICLI TO DBC-VRF-ICLI IN QC2-FLD        
                    MOVE KEY-IND-ICLI TO DBC-IND-ICLI IN QC2-FLD        
                    MOVE KEY-GLS-ICLI TO DBC-GLS-ICLI IN QC2-FLD        
                    MOVE KEY-CAI-IOPE TO FRM-CAI-IOPE IN QC2-FLD        
                    MOVE KEY-IIC-IOPE TO FRM-IIC-IOPE IN QC2-FLD.        

       FIN-BUS-KEY-QUE.                                                 
           EXIT.                                                        

       CLR-KEY-KFRM SECTION.                                            
       INI-CLR-KEY-KFRM.                                                
           MOVE SPACES TO FRM-GLS-TNOM IN QC2-FLD.                      
           MOVE SPACES TO FRM-GLS-TIDC IN QC2-FLD.                      
           MOVE SPACES TO FRM-GLS-TOPE IN QC2-FLD.                      
           MOVE SPACES TO FRM-GLS-TFEC IN QC2-FLD.                      
           MOVE SPACES TO FRM-GLS-TNRO IN QC2-FLD.                      
           MOVE SPACES TO FRM-GLS-TCOD IN QC2-FLD.                      
           MOVE SPACES TO DBC-GLS-NOMC IN QC2-FLD.                      
           MOVE ZEROES TO DBC-NUM-ICLI IN QC2-FLD.                      
           MOVE SPACES TO DBC-VRF-ICLI IN QC2-FLD.                      
           MOVE SPACES TO DBC-IND-ICLI IN QC2-FLD.                      
           MOVE SPACES TO DBC-GLS-ICLI IN QC2-FLD.                      
           MOVE SPACES TO FRM-CAI-IOPE IN QC2-FLD.                      
           MOVE ZEROES TO FRM-IIC-IOPE IN QC2-FLD.                      

       FIN-CLR-KEY-KFRM.                                                
           EXIT.                                                        

      *>>>>                                                             
*% END
