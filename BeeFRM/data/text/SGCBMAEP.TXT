*%! Codigo adicional para archivo
*% IF NOT PGM_PER
*% IF INI_PUT_ALL_AEP
      *<<<< INI_PUT_ALL_AEP
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF INI_PUT_AEP_AEP
      *<<<< INI_PUT_AEP_AEP
           IF PGM-STAT-AEP-NUL
               GO TO FIN-PUT-AEP-AEP.
           IF NOT PGM-STAT-AEP-OKS
               PERFORM CLR-AEP-AEP
               PERFORM CLR-FRM-AEP
               GO TO FIN-PUT-AEP-AEP.
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF INI_PUT_DBC_AEP
      *<<<< INI_PUT_DBC_AEP
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-AEP.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-AEP
               GO TO FIN-PUT-DBC-AEP.
      *>>>>
*% END
*% END
*% IF FIN_PUT_ALL_AEP
      *<<<< FIN_PUT_ALL_AEP
      *>>>>
*% END
*% IF FIN_KEY_ALL_AEP
      *<<<< FIN_KEY_ALL_AEP
      *>>>> FIN_KEY_ALL_AEP
*% END
*% IF FIN_PUT_DBC_AEP
      *<<<< FIN_PUT_DBC_AEP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN AEP-FLD.
      *>>>>
*% END
*% IF FIN_PUT_AEP_AEP
      *<<<< FIN_PUT_AEP_AEP
       CAL-FRM-VAL-TING.
           ADD AEP-VAL-RLCL IN AEP-FLD
               AEP-VAL-RLCJ IN AEP-FLD
               AEP-VAL-OING IN AEP-FLD
               GIVING FRM-VAL-TING IN AEP-FLD.

       CAL-FRM-VAL-TEGR.
           ADD AEP-VAL-DMEN IN AEP-FLD
               AEP-VAL-ARRD IN AEP-FLD
               AEP-VAL-OEGR IN AEP-FLD
               GIVING FRM-VAL-TEGR IN AEP-FLD.

       CAL-FRM-VAL-TACT.
           ADD AEP-VAL-DPZO IN AEP-FLD
               AEP-VAL-ACBO IN AEP-FLD
               AEP-VAL-BIRA IN AEP-FLD
               AEP-VAL-VEHI IN AEP-FLD
               AEP-VAL-ASOC IN AEP-FLD
               AEP-VAL-OACT IN AEP-FLD
               GIVING FRM-VAL-TACT IN AEP-FLD.

       CAL-FRM-VAL-TPAS.
           ADD AEP-VAL-DBYC IN AEP-FLD
               AEP-VAL-DHIP IN AEP-FLD
               AEP-VAL-OPAS IN AEP-FLD
               GIVING FRM-VAL-TPAS IN AEP-FLD.

       CAL-FRM-VAL-PATR.
           SUBTRACT FRM-VAL-TPAS IN AEP-FLD
               FROM FRM-VAL-TACT IN AEP-FLD
               GIVING FRM-VAL-PATR IN AEP-FLD.

       CAL-FRM-VAL-IDIS.
           SUBTRACT FRM-VAL-TEGR IN AEP-FLD
               FROM FRM-VAL-TING IN AEP-FLD
               GIVING FRM-VAL-IDIS IN AEP-FLD.
      *>>>>
*% END
*% IF FIN_PRO_IKY_AEP
      *<<<< FIN_PRO_IKY_AEP
           MOVE FRM-CPIM-AEY TO AEP-FEC-FAEP-ATR IN AEP-FLD.
      *>>>>
*% END
*% IF INI_VAL_IKY_AEP
      *<<<<
      *RGD-INI 04-08-2009 "ORIGEN DE RENTA"
           PERFORM VAL-AEP-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO AEP-CAI-ICLI-LEN IN AEP-FLD
                GO TO FIN-VAL-IKY-AEP.
           PERFORM VAL-AEP-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO AEP-IIC-ICLI-LEN IN AEP-FLD
                GO TO FIN-VAL-IKY-AEP.
      *RGD-FIN 04-08-2009
      *>>>>
*% END
*% IF DBC_GLS_NOMC
      *<<<<
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF DBC_IND_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF DBC_GLS_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF DBC_NUM_ICLI
      *<<<<
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF DBC_VRF_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF INI_AEP_FEC_FAEP
      *<<<< INI_AEP_FEC_FAEP
      *BEE-INI 06-08-2009 Codigo en duro que no es gererable por Genesis
           IF SCR-CCPP = 'ING' AND
              AEP-FEC-FAEP IN AEP-FLD NOT > ZEROES AND
              SCR-HDR-MRCA = 'BCS'
                 MOVE HOY-DHOY TO AEP-NUM-DAEP IN AEP-FLD
                 MOVE HOY-MHOY TO AEP-NUM-MAEP IN AEP-FLD
                 MOVE HOY-SHOY TO AEP-NUM-SAEP IN AEP-FLD
                 MOVE HOY-AHOY TO AEP-NUM-AAEP IN AEP-FLD.
      *BEE-FIN 06-08-2009      
           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF SCR-CCPP = 'ING'
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
      *BEE-INI 06-08-2009 Codigo en duro que no es gererable por Genesis
       CIC-VAL-AEP-FEC-FAEP.
      *BEE-FIN 06-08-2009
      *>>>>
*% END
*% IF AEP_FEC_FAEP
      *<<<< AEP_FEC_FAEP
      *BEE-INI 06-08-2009 Codigo en duro que no es gererable por Genesis
           IF SCR-CCPP = 'ING' AND
              NOT FEC-STAT-HBL AND SCR-HDR-MRCA = 'BCS'
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE 1            TO FEC-NDIA
              PERFORM CAL-FEC
              GO TO CIC-VAL-AEP-FEC-FAEP.
      *BEE-FIN 06-08-2009
      *>>>> AEP_FEC_FAEP
*% END
*% IF INI_AEP_FEC_FVRF
      *<<<< INI_AEP_FEC_FVRF
           IF AEP-FEC-FVRF IN AEP-FLD  NOT > ZEROES
               MOVE ZEROES TO AEP-FEC-FVRF IN AEP-FLD.
           MOVE AEP-FEC-FVRF IN AEP-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
       CIC-VAL-AEP-FEC-FVRF.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL AND SCR-HDR-MRCA = 'BCS'
               MOVE FEC-SUM-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               PERFORM CAL-FEC
               GO TO CIC-VAL-AEP-FEC-FVRF.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO AEP-FEC-FVRF IN AEP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-AEP-FEC-FVRF.
           IF AEP-FEC-FVRF IN AEP-FLD > ZEROES
               MOVE AEP-FEC-FAEP IN AEP-FLD TO FEC-FEC1
               MOVE AEP-FEC-FVRF IN AEP-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFAEPFVRF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-AEP-FEC-FVRF.
      *>>>>
*% END
*% IF FIN_PUT_DCC_AEP
      *<<<< FIN-PUT-DCC-AEP
      * RGD-INI 04-06-2009 "ORIGEN DE RENTA"
      * BUS-TAB busca glosa de codigo en tabla
      *    MOVE SPACES TO FRM-GLS-ORNT IN AEP-FLD.
      * RGD-FIN 29-07-2009
           IF DCC-COD-BDIR IN AEP-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'BDR'                   TO TAB-COD-TTAB IN TAB
               MOVE DCC-COD-BDIR IN AEP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB.
      *>>>>
*% END
*% IF INI_RET_AEP_AEP
      *<<<< INI_RET_AEP_AEP
      *RGD-INI 03-08-2009 "ORIGEN DE RENTA"
 RGD01     IF SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                                        SCR-CCPP = 'MOD'
 RGD01        PERFORM VAL-FECHA-RENTA
 RGD01        IF ( NOT FEC-STAT-OKS ) OR
 RGD01           ( FEC-STAT-OKS AND
      * MPS-INI Nueva Banca MicroEmpresarios 30/06/2015
 RGD01*            TAB-CIC-CTAB IN TAB NOT = 'PBM' AND FEC-NMES < 24)
                 ( TAB-CIC-CTAB IN TAB NOT = PGM-PBM
                   AND FEC-NMES < PGM-24) OR
                 ( TAB-CIC-CTAB IN TAB NOT = PGM-PMV
                   AND FEC-NMES < PGM-24))
      * MPS-FIN Nueva Banca MicroEmpresarios 30/06/2015
 RGD01           GO TO FIN-RET-AEP-AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                      AEP-NUM-DVRF IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-DVRF IN AEP-FLD TO AEP-NUM-DVRF IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                      AEP-NUM-MVRF IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-MVRF IN AEP-FLD TO AEP-NUM-MVRF IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                      AEP-NUM-SVRF IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-SVRF IN AEP-FLD TO AEP-NUM-SVRF IN AEP.

 RGD01*    Se agrega campo faltante
 RGD01     IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
 RGD01                AEP-NUM-AVRF IN AEP > ZEROES )

 RGD01     MOVE AEP-NUM-AVRF IN AEP-FLD TO AEP-NUM-AVRF IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                      AEP-VAL-RLCL IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-RLCL IN AEP-FLD TO AEP-VAL-RLCL IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                      AEP-VAL-DMEN IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-DMEN IN AEP-FLD TO AEP-VAL-DMEN IN AEP.


      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-MLCL IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-MLCL IN AEP-FLD TO AEP-NUM-MLCL IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-SLCL IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-SLCL IN AEP-FLD TO AEP-NUM-SLCL IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-ALCL IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-ALCL IN AEP-FLD TO AEP-NUM-ALCL IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-ARRD IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-ARRD IN AEP-FLD TO AEP-VAL-ARRD IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-RLCJ IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-RLCJ IN AEP-FLD TO AEP-VAL-RLCJ IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-OEGR IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-OEGR IN AEP-FLD TO AEP-VAL-OEGR IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-OING IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-OING IN AEP-FLD TO AEP-VAL-OING IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-MING IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-MING IN AEP-FLD TO AEP-NUM-MING IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-SING IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-SING IN AEP-FLD TO AEP-NUM-SING IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-NUM-AING IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-NUM-AING IN AEP-FLD TO AEP-NUM-AING IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-DPZO IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-DPZO IN AEP-FLD TO AEP-VAL-DPZO IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-DBYC IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-DBYC IN AEP-FLD TO AEP-VAL-DBYC IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-ACBO IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-ACBO IN AEP-FLD TO AEP-VAL-ACBO IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-DHIP IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-DHIP IN AEP-FLD TO AEP-VAL-DHIP IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-BIRA IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-BIRA IN AEP-FLD TO AEP-VAL-BIRA IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-OPAS IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-OPAS IN AEP-FLD TO AEP-VAL-OPAS IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-VEHI IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-VEHI IN AEP-FLD TO AEP-VAL-VEHI IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-ASOC IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-ASOC IN AEP-FLD TO AEP-VAL-ASOC IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-OACT IN AEP > ZEROES )
      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-OACT IN AEP-FLD TO AEP-VAL-OACT IN AEP.

      *  VNA-INI : MODIFICACIONES PARA  INGRESADAS PARA NOVA

           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    AEP-VAL-AVAL IN AEP > ZEROES )

      *  VNA-FIN : MODIFICACIONES PARA  INGRESADAS PARA NOVA
           MOVE AEP-VAL-AVAL IN AEP-FLD TO AEP-VAL-AVAL IN AEP.

      *RGD-INI 04-08-2009 "ORIGEN DE RENTA"
           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    DCC-COD-BDIR IN DCC > ZEROES )
              MOVE DCC-COD-BDIR IN AEP-FLD TO DCC-COD-BDIR IN DCC.

      *RGD-INI 04-08-2009

           GO TO FIN-RET-AEP-AEP.
      *RGD-FIN 03-08-2009
      *>>>>
*% END
*% IF INI_RET_DCC_AEP
      *<<<< INI_RET_DCC_AEP
      *RGD-INI 03-08-2009 "ORIGEN DE RENTA"
           IF NOT ( SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS' AND
                    SCR-CCPP = 'MOD' AND
                    DCC-COD-BDIR IN DCC > SPACES )
               MOVE DCC-COD-BDIR IN AEP-FLD TO DCC-COD-BDIR IN DCC.
           GO TO FIN-RET-DCC-AEP.
      *RGD-FIN 03-08-2009
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_AEP
      *<<<< INI_VAL_CON_IKY_AEP
           IF     AEP-CAI-ICLI IN AEP-FLD NOT > SPACES
              AND AEP-IIC-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-NUM-ICLI IN AEP-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-IND-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN AEP-FLD NOT > SPACES
              AND AEP-FEC-FAEP IN AEP-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-AEP.
	   GO TO FIN-VAL-CON-IKY-AEP.
      *>>>>
*% END
*% IF INI_FST_FLD_AEP
      *<<<< INI_FST_FLD_AEP
           MOVE -1 TO AEP-FEC-FVRF-LEN IN AEP-FLD.
           GO TO FIN-FST-FLD-AEP.
      *>>>>
*% END
*% IF INI_CLR_KEY_AEP
      *<<<< INI_CLR_KEY_AEP
      *RGD-INI 03-08-2009 "ORIGEN DE RENTA"
           MOVE SPACES TO AEP-CAI-ICLI IN AEP-FLD.
           MOVE SPACES TO AEP-IIC-ICLI IN AEP-FLD.
           MOVE ZEROES TO AEP-FEC-FAEP IN AEP-FLD.
      *RGD-FIN 03-08-2009
      *>>>>
*% END
*% IF INI_KEY_AEP_AEP
      *<<<< INI_KEY_AEP_AEP
      *RGD-INI 03-08-2009 "ORIGEN DE RENTA"
           MOVE AEP-CAI-ICLI IN AEP-FLD TO AEP-CAI-ICLI IN AEP.
           MOVE AEP-IIC-ICLI IN AEP-FLD TO AEP-IIC-ICLI IN AEP.
           MOVE AEP-NUM-DAEP IN AEP-FLD TO AEP-NUM-DAEP IN AEP.
           MOVE AEP-NUM-MAEP IN AEP-FLD TO AEP-NUM-MAEP IN AEP.
           MOVE AEP-NUM-SAEP IN AEP-FLD TO AEP-NUM-SAEP IN AEP.
           MOVE AEP-NUM-AAEP IN AEP-FLD TO AEP-NUM-AAEP IN AEP.
      *RGD-FIN 03-08-2009
      *>>>>
*% END
*% IF INI_VAL_FLD_AEP
*% END
*% IF DCC_COD_BDIR
      *<<<< DCC_COD_BDIR
      * RGD-INI 04-06-2009 "ORIGEN DE RENTA"
           IF SCR-COD-BDIR = DCC-COD-BDIR IN AEP-FLD AND
              DCC-COD-BDIR IN AEP-FLD NOT = SPACES
               GO TO FIN-VAL-DCC-COD-BDIR.
           IF SCR-OFRM-SRV AND SCR-HDR-MRCA = 'BCS'
               PERFORM VALIDA-VERSION
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
                  GO TO FIN-VAL-DCC-COD-BDIR.
      *VAL-COD Valida codigo de tabla
           MOVE 'SGC'  TO TAB-COD-SIST.
           MOVE 'BDR ' TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-BDIR IN AEP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      * RGD-FIN 04-06-2009
      *>>>>
*% END
*% IF VAL_CON_FLD_AEP
      *<<<< VAL_CON_FLD_AEP
           ADD AEP-VAL-RLCL IN AEP-FLD
               AEP-VAL-RLCJ IN AEP-FLD
               AEP-VAL-OING IN AEP-FLD
               GIVING WSS-VAL-TING.
           IF SCR-HDR-MRCA = 'BCS' AND
              SCR-OFRM-SRV AND
              SCR-CCPP = 'MOD'
                MOVE WSS-VAL-TING TO FRM-VAL-TING IN AEP-FLD.
      *PVG INI 12-AGO-2009
           IF FRM-VAL-TING IN AEP-FLD NOT > ZEROES
              MOVE WSS-VAL-TING IN WSS-VARI TO
                   FRM-VAL-TING IN AEP-FLD.
      *PVG FIN 12-AGO-2009
           IF FRM-VAL-TING IN AEP-FLD NOT = WSS-VAL-TING
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTINGERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DMEN IN AEP-FLD
               AEP-VAL-ARRD IN AEP-FLD
               AEP-VAL-OEGR IN AEP-FLD
               GIVING WSS-VAL-TEGR.
      *PVG INI 12-AGO-2009
           IF FRM-VAL-TEGR IN AEP-FLD NOT > ZEROES
              MOVE WSS-VAL-TEGR IN WSS-VARI TO
                   FRM-VAL-TEGR IN AEP-FLD.
      *PVG FIN 12-AGO-2009
           IF FRM-VAL-TEGR IN AEP-FLD NOT = WSS-VAL-TEGR
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTEGRERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DPZO IN AEP-FLD
               AEP-VAL-ACBO IN AEP-FLD
               AEP-VAL-BIRA IN AEP-FLD
               AEP-VAL-VEHI IN AEP-FLD
               AEP-VAL-ASOC IN AEP-FLD
               AEP-VAL-OACT IN AEP-FLD
               GIVING WSS-VAL-TACT.
      *PVG INI 12-AGO-2009
           IF FRM-VAL-TACT IN AEP-FLD NOT > ZEROES
              MOVE WSS-VAL-TACT IN WSS-VARI TO
                   FRM-VAL-TACT IN AEP-FLD.
      *PVG FIN 12-AGO-2009
           IF FRM-VAL-TACT IN AEP-FLD NOT = WSS-VAL-TACT
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTACTERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DBYC IN AEP-FLD
               AEP-VAL-DHIP IN AEP-FLD
               AEP-VAL-OPAS IN AEP-FLD
               GIVING WSS-VAL-TPAS.
      *PVG INI 12-AGO-2009
           IF FRM-VAL-TPAS IN AEP-FLD NOT > ZEROES
              MOVE WSS-VAL-TPAS IN WSS-VARI TO
                   FRM-VAL-TPAS IN AEP-FLD.
      *PVG FIN 12-AGO-2009
           IF FRM-VAL-TPAS IN AEP-FLD NOT = WSS-VAL-TPAS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
       CAL-FRM-VAL-IDIS.
           SUBTRACT FRM-VAL-TEGR IN AEP-FLD
               FROM FRM-VAL-TING IN AEP-FLD
               GIVING FRM-VAL-IDIS IN AEP-FLD.

       CAL-FRM-VAL-PATR.
           SUBTRACT FRM-VAL-TPAS IN AEP-FLD
               FROM FRM-VAL-TACT IN AEP-FLD
               GIVING FRM-VAL-PATR IN AEP-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_AEP
      *<<<< INI_VAL_CON_KEY_AEP
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-AEP.
           IF     AEP-CAI-ICLI IN AEP-FLD NOT > SPACES
              AND AEP-IIC-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-GLS-NOMC IN AEP-FLD NOT > SPACES
              AND DBC-NUM-ICLI IN AEP-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-IND-ICLI IN AEP-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN AEP-FLD NOT > SPACES
              AND AEP-FEC-FAEP IN AEP-FLD NOT > SPACES
              AND AEP-NUM-DAEP IN AEP-FLD NOT > SPACES
              AND AEP-NUM-MAEP IN AEP-FLD NOT > SPACES
              AND AEP-NUM-SAEP IN AEP-FLD NOT > SPACES
              AND AEP-NUM-AAEP IN AEP-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-AEP.
      *>>>>
*% END
*% IF INI_AEP_MSA_FLCL
      *<<<< INI_AEP_MSA_FLCL
           MOVE AEP-MSA-FLCL IN AEP-FLD TO FEC-FECH.
           MOVE FEC-FORM-MSA TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
       CIC-VAL-AEP-MSA-FLCL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO AEP-MSA-FLCL IN AEP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
           GO TO FIN-VAL-AEP-MSA-FLCL.
      *>>>>
*% END
*% IF INI_AEP_MSA_FING
      *<<<< INI_AEP_MSA_FING
           MOVE AEP-MSA-FING IN AEP-FLD TO FEC-FECH.
           MOVE FEC-FORM-MSA TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO AEP-MSA-FING IN AEP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
           GO TO FIN-VAL-AEP-MSA-FING.
      *>>>>
*% END
*% IF FIN_UNP_AEP_AEP
      *<<<< FIN_UNP_AEP_AEP
      *>>>> FIN_UNP_AEP_AEP
*% END
*% IF FIN_CLR_AEP_AEP
      *<<<< FIN_CLR_AEP_AEP
      *>>>> FIN_CLR_AEP_AEP
*% END
*% IF FIN_CLR_FLD_AEP
      *<<<< FIN_CLR_FLD_AEP
      *>>>> FIN_CLR_FLD_AEP
*% END
*% IF INI_FST_KEY_AEP
      *<<<< INI_FST_KEY_AEP
      *>>>> INI_FST_KEY_AEP
*% END
*% IF FIN_UNP_FLD_AEP
      *<<<< FIN_UNP_FLD_AEP
      *>>>> FIN_UNP_FLD_AEP
*% END
*% IF FIN_VAL_CON_KEY_AEP
      *<<<< FIN_VAL_CON_KEY_AEP
           IF DBC-NUM-ICLI IN AEP-FLD NOT > ZEROES AND
              DBC-GLS-NOMC IN AEP-FLD NOT > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-AEP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CLR-FRM-AEP SECTION.
       INI-CLR-FRM-AEP.
           MOVE ZEROES TO FRM-VAL-TING IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TEGR IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-IDIS IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TACT IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-PATR IN AEP-FLD.
       FIN-CLR-FRM-AEP.
           EXIT.
*% IF PGM_BU
       VALIDA-VERSION SECTION.
       INI-VALIDA-VERSION.
      * RGD-INI 04-06-2009 "ORIGEN DE RENTA"
           MOVE 'SGC'                TO TAB-COD-SIST.
           MOVE 'VSN'                TO TAB-COD-TTAB IN TAB.
           MOVE 'BCSORENTA'          TO TAB-COD-CTAB IN TAB.
           MOVE TAB-COD-SIST         TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-COD-DAT3(1) TO DCC-COD-BDIR IN AEP-FLD.
      * RGD-FIN 04-06-2009
       FIN-VALIDA-VERSION.
           EXIT.
       VAL-FECHA-RENTA SECTION.
       INI-VAL-FECHA-RENTA.
           MOVE AEP-KEY-IAEP IN AEP TO DCP-KEY-IDCP IN DCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
              GO TO FIN-VAL-FECHA-RENTA.
      *VAL-COD VALIDA CODIGO DE TABLA
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'BAN ' TO TAB-COD-TTAB IN TAB.
           MOVE DCP-COD-TBAN IN DCP TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT FIO-STAT-OKS
              MOVE 'SGC'        TO MSG-COD-SIST
              MOVE 'TBAN   NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              GO TO FIN-VAL-FECHA-RENTA.

           IF TAB-CIC-CTAB IN TAB = PGM-PBM
      * MPS-INI Nueva Banca MicroEmpresarios 30/06/2015
           OR TAB-CIC-CTAB IN TAB = PGM-PMV
      * MPS-FIN Nueva Banca MicroEmpresarios 30/06/2015
              PERFORM CLR-AEP-AEP2
           ELSE
              MOVE AEP-NUM-DVRF IN AEP     TO FEC-DEC1
              MOVE AEP-NUM-MVRF IN AEP     TO FEC-MEC1
              MOVE AEP-NUM-SVRF IN AEP     TO FEC-SEC1
              MOVE AEP-NUM-AVRF IN AEP     TO FEC-AEC1
              MOVE AEP-NUM-DVRF IN AEP-FLD TO FEC-DEC2
              MOVE AEP-NUM-MVRF IN AEP-FLD TO FEC-MEC2
              MOVE AEP-NUM-SVRF IN AEP-FLD TO FEC-SEC2
              MOVE AEP-NUM-AVRF IN AEP-FLD TO FEC-AEC2
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-DIF-MES  TO FEC-CMND
              PERFORM CAL-FEC
              IF FEC-STAT-OKS
                 IF FEC-NMES  > 23
                    PERFORM LIMPIA-CAMPOS-AEP.
       FIN-VAL-FECHA-RENTA.
           EXIT.
       LIMPIA-CAMPOS-AEP SECTION.
       INI-CAMPOS-AEP.
           MOVE 0 TO AEP-NUM-DVRF IN AEP.
           MOVE 0 TO AEP-NUM-MVRF IN AEP.
           MOVE 0 TO AEP-NUM-SVRF IN AEP.
           MOVE 0 TO AEP-NUM-AVRF IN AEP.
           MOVE 0 TO AEP-VAL-RLCL IN AEP.
           MOVE 0 TO AEP-NUM-MLCL IN AEP.
           MOVE 0 TO AEP-NUM-SLCL IN AEP.
           MOVE 0 TO AEP-NUM-ALCL IN AEP.
           MOVE 0 TO AEP-VAL-OING IN AEP.
           MOVE 0 TO AEP-NUM-MING IN AEP.
           MOVE 0 TO AEP-NUM-SING IN AEP.
           MOVE 0 TO AEP-NUM-AING IN AEP.
       FIN-CAMPOS-AEP.
           EXIT.
       CLR-AEP-AEP2 SECTION.
       INI-CLR-AEP-AEP2.
      *RGD-INI 03-08-2009 "ORIGEN DE RENTA"
           MOVE ZEROES TO AEP-FEC-FVRF IN AEP.
           MOVE ZEROES TO AEP-VAL-RLCL IN AEP.
           MOVE ZEROES TO AEP-VAL-DMEN IN AEP.
           MOVE ZEROES TO AEP-MSA-FLCL IN AEP.
           MOVE ZEROES TO AEP-VAL-ARRD IN AEP.
           MOVE ZEROES TO AEP-VAL-RLCJ IN AEP.
           MOVE ZEROES TO AEP-VAL-OEGR IN AEP.
           MOVE ZEROES TO AEP-VAL-OING IN AEP.
           MOVE ZEROES TO AEP-MSA-FING IN AEP.
           MOVE ZEROES TO AEP-VAL-DPZO IN AEP.
           MOVE ZEROES TO AEP-VAL-DBYC IN AEP.
           MOVE ZEROES TO AEP-VAL-ACBO IN AEP.
           MOVE ZEROES TO AEP-VAL-DHIP IN AEP.
           MOVE ZEROES TO AEP-VAL-BIRA IN AEP.
           MOVE ZEROES TO AEP-VAL-OPAS IN AEP.
           MOVE ZEROES TO AEP-VAL-VEHI IN AEP.
           MOVE ZEROES TO AEP-VAL-ASOC IN AEP.
           MOVE ZEROES TO AEP-VAL-OACT IN AEP.
           MOVE ZEROES TO AEP-VAL-AVAL IN AEP.
      *RGD-FIN 03-08-2009
       FIN-CLR-AEP-AEP2.
           EXIT.
*% END
*% IF PGM_BQ
      *MVG-INI 19-JUL-2019 IGUALACION SGC
       VAL-AEP-CAI-ICLI SECTION.
       INI-VAL-AEP-CAI-ICLI.
       FIN-VAL-AEP-CAI-ICLI.
           EXIT.

       VAL-AEP-IIC-ICLI SECTION.
       INI-VAL-AEP-IIC-ICLI.
       FIN-VAL-AEP-IIC-ICLI.
           EXIT.
      *MVG-FIN 19-JUL-2019 IGUALACION SGC
*% END
*% END
