<?xml version = "1.0" encoding = "ISO-8859-1" ?>

<additional xmlns        = "http://cl/bee/genfrmjava/adddef/schema"
      xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation = "http://cl/bee/genfrmjava/adddef/schema adddef.xsd"
      system             = "TAB"
      form               = "OFI">

  <!-- ========================================================================================== ==
    == FIN_PUT_ALL_OFI
    == ========================================================================================== -->

  <section name="FIN_PUT_ALL_OFI">

    <code><![CDATA[      *<<<< FIN_PUT_ALL_OFI
           IF OFI-COD-COMU IN OFI-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'COM' TO TAB-COD-TTAB IN TAB
               MOVE OFI-COD-COMU IN OFI-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COMU IN OFI-FLD.
           IF OFI-COD-PLZA IN OFI-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PZA' TO TAB-COD-TTAB IN TAB
               MOVE OFI-COD-PLZA IN OFI-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PLZA IN OFI-FLD.
           IF OFI-COD-OREG IN OFI-FLD NOT = OFI-COD-OFIC IN OFI-FLD
               MOVE OFI-COD-OREG IN OFI-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OREG IN OFI-FLD
               IF FIO-STAT-OKS
                   MOVE OFI-COD-JFOF IN OFI TO USR-COD-USER IN USR
                   PERFORM BUS-USR
                   MOVE USR-GLS-DESC IN USR TO FRM-GLS-GREG IN OFI-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-GREG IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OREG IN OFI-FLD
                              FRM-GLS-GREG IN OFI-FLD.
           IF OFI-COD-OFCO IN OFI-FLD NOT = OFI-COD-OFIC IN OFI-FLD
               MOVE OFI-COD-OFCO IN OFI-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCO IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFCO IN OFI-FLD.
           IF OFI-IND-COPE IN OFI-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'COPE' TO MSC-COD-TMSC IN MSC
               MOVE OFI-IND-COPE IN OFI-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-COPE IN OFI-FLD.
           IF OFI-IND-CCOM IN OFI-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'CCOM' TO MSC-COD-TMSC IN MSC
               MOVE OFI-IND-CCOM IN OFI-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CCOM IN OFI-FLD.
           IF OFI-COD-JFOF IN OFI-FLD > SPACES
               MOVE OFI-COD-JFOF IN OFI-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-JFOF IN OFI-FLD.
           IF OFI-COD-JOOF IN OFI-FLD > SPACES
               MOVE OFI-COD-JOOF IN OFI-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-JOOF IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_OFI_VRF_CCON
    == ========================================================================================== -->

  <section name="INI_OFI_VRF_CCON">

    <code><![CDATA[      *<<<< INI_OFI_VRF_CCON
      * SE SALTA VALIDACION AUTOMATICA
           GO TO NO-VAL-VRF-CCON.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_OFI_VRF_CCTE
    == ========================================================================================== -->

  <section name="INI_OFI_VRF_CCTE">

    <code><![CDATA[      *<<<< INI_OFI_VRF_CCTE
      * SE SALTA VALIDACION AUTOMATICA
           GO TO NO-VAL-VRF-CCTE.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_CIC_OFIC
    == ========================================================================================== -->

  <section name="OFI_CIC_OFIC">

    <code><![CDATA[      *<<<< OFI_CIC_OFIC
           IF OFI-CIC-OFIC IN OFI-FLD NOT > SPACES
               MOVE OFI-COD-OFIC IN OFI-FLD TO OFI-CIC-OFIC IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_COMU
    == ========================================================================================== -->

  <section name="OFI_COD_COMU">

    <code><![CDATA[      *<<<< OFI_COD_COMU
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE OFI-COD-COMU IN OFI-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-COMU IN OFI-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COMU IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COMU IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_JFOF
    == ========================================================================================== -->

  <section name="OFI_COD_JFOF">

    <code><![CDATA[      *<<<< OFI_COD_JFOF
           MOVE OFI-COD-JFOF IN OFI-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-JFOF IN OFI-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-JFOF IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-JFOF IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_JOOF
    == ========================================================================================== -->

  <section name="OFI_COD_JOOF">

    <code><![CDATA[      *<<<< OFI_COD_JOOF
           MOVE OFI-COD-JOOF IN OFI-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-JOOF IN OFI-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-JOOF IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-JOOF IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_OFCO
    == ========================================================================================== -->

  <section name="OFI_COD_OFCO">

    <code><![CDATA[      *<<<< OFI_COD_OFCO
           IF OFI-COD-OFCO IN OFI-FLD = OFI-COD-OFIC IN OFI-FLD
               MOVE SPACES TO FRM-GLS-OFCO IN OFI-FLD
               GO TO FIN-VAL-OFI-COD-OFCO.
           MOVE OFI-COD-OFCO IN OFI-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-OFCO IN OFI-FLD > SPACES
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCO IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFCO IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_OREG
    == ========================================================================================== -->

  <section name="OFI_COD_OREG">

    <code><![CDATA[      *<<<< OFI_COD_OREG
           IF OFI-COD-OREG IN OFI-FLD = OFI-COD-OFIC IN OFI-FLD
               MOVE SPACES TO FRM-GLS-OREG IN OFI-FLD
                              FRM-GLS-GREG IN OFI-FLD
               GO TO FIN-VAL-OFI-COD-OREG.
           MOVE OFI-COD-OREG IN OFI-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-OREG IN OFI-FLD > SPACES
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OREG IN OFI-FLD
               MOVE OFI-COD-JFOF IN OFI TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-GREG IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OREG IN OFI-FLD
                              FRM-GLS-GREG IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_COD_PLZA
    == ========================================================================================== -->

  <section name="OFI_COD_PLZA">

    <code><![CDATA[      *<<<< OFI_COD_PLZA
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PZA' TO TAB-COD-TTAB IN TAB.
           MOVE OFI-COD-PLZA IN OFI-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-PLZA IN OFI-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PLZA IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-PLZA IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_IND_CCOM
    == ========================================================================================== -->

  <section name="OFI_IND_CCOM">

    <code><![CDATA[      *<<<< OFI_IND_CCOM
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'CCOM' TO MSC-COD-TMSC IN MSC.
           MOVE OFI-IND-CCOM IN OFI-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-IND-CCOM IN OFI-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CCOM IN OFI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CCOM IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_IND_COPE
    == ========================================================================================== -->

  <section name="OFI_IND_COPE">

    <code><![CDATA[      *<<<< OFI_IND_COPE
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'COPE' TO MSC-COD-TMSC IN MSC.
           MOVE OFI-IND-COPE IN OFI-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-IND-COPE IN OFI-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-COPE IN OFI-FLD
               MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-CMSC
           ELSE
               MOVE SPACES TO FRM-GLS-COPE IN OFI-FLD
               MOVE SPACES TO WSS-CIC-CMSC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_VRF_CCON
    == ========================================================================================== -->

  <section name="OFI_VRF_CCON">

    <code><![CDATA[      *<<<< OFI_VRF_CCON
       NO-VAL-VRF-CCON.
           IF WSS-CIC-CMSC = 'R'
               MOVE ZEROES TO OFI-NUM-CCON IN OFI-FLD
               MOVE SPACES TO OFI-VRF-CCON IN OFI-FLD
           ELSE
               MOVE OFI-NUM-CCON IN OFI-FLD TO VRF-NUME
               MOVE OFI-VRF-CCON IN OFI-FLD TO VRF-DVRF
               MOVE VRF-SVRF-1 TO VRF-SVRF
               MOVE VRF-ZERO-S TO VRF-ZERO
               MOVE VRF-VAL TO VRF-CMND
               MOVE 8 TO VRF-LMAX
               PERFORM PRO-VRF
               IF MSG-COD-MENS = SPACES
                   MOVE VRF-NUME TO OFI-NUM-CCON IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == OFI_VRF_CCTE
    == ========================================================================================== -->

  <section name="OFI_VRF_CCTE">

    <code><![CDATA[      *<<<< OFI_VRF_CCTE
       NO-VAL-VRF-CCTE.
           IF WSS-CIC-CMSC = 'R'
               MOVE ZEROES TO OFI-NUM-CCTE IN OFI-FLD
               MOVE SPACES TO OFI-VRF-CCTE IN OFI-FLD
           ELSE
               MOVE OFI-NUM-CCTE IN OFI-FLD TO VRF-NUME
               MOVE OFI-VRF-CCTE IN OFI-FLD TO VRF-DVRF
      *         MOVE VRF-SVRF-1 TO VRF-SVRF
               MOVE VRF-ZERO-S TO VRF-ZERO
               MOVE VRF-VAL TO VRF-CMND
               MOVE 8 TO VRF-LMAX
               PERFORM PRO-VRF
               IF MSG-COD-MENS = SPACES
                   MOVE VRF-NUME TO OFI-NUM-CCTE IN OFI-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == VAL_CON_FLD_OFI
    == ========================================================================================== -->

  <section name="VAL_CON_FLD_OFI">

    <code><![CDATA[      *<<<< VAL_CON_FLD_OFI
           IF OFI-FEC-FCIE IN OFI-FLD > ZEROES
               IF OFI-FEC-FAPE IN OFI-FLD > ZEROES
                   MOVE OFI-FEC-FAPE IN OFI-FLD TO FEC-FEC1
                   MOVE OFI-FEC-FCIE IN OFI-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'TAB' TO MSG-COD-SIST
                       MOVE 'FECFAPE>FCIE' TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'FECFAPEFCIE' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-OFI.

           IF OFI-FEC-FJFO IN OFI-FLD > ZEROES
               IF OFI-FEC-FAPE IN OFI-FLD > ZEROES
                   MOVE OFI-FEC-FAPE IN OFI-FLD TO FEC-FEC1
                   MOVE OFI-FEC-FJFO IN OFI-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'TAB' TO MSG-COD-SIST
                       MOVE 'FECFAPE>FJFO' TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-OFI.

           IF OFI-FEC-FJOO IN OFI-FLD > ZEROES
               IF OFI-FEC-FAPE IN OFI-FLD > ZEROES
                   MOVE OFI-FEC-FAPE IN OFI-FLD TO FEC-FEC1
                   MOVE OFI-FEC-FJOO IN OFI-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'TAB' TO MSG-COD-SIST
                       MOVE 'FECFAPE>FJOO' TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-OFI.
           IF OFI-FEC-FJFO IN OFI-FLD > ZEROES
               IF OFI-FEC-FCIE IN OFI-FLD > ZEROES
                   MOVE OFI-FEC-FJFO IN OFI-FLD TO FEC-FEC1
                   MOVE OFI-FEC-FCIE IN OFI-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'TAB' TO MSG-COD-SIST
                       MOVE 'FECFJFO>FCIE' TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-OFI.

           IF OFI-FEC-FJOO IN OFI-FLD > ZEROES
               IF OFI-FEC-FCIE IN OFI-FLD > ZEROES
                   MOVE OFI-FEC-FJOO IN OFI-FLD TO FEC-FEC1
                   MOVE OFI-FEC-FCIE IN OFI-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'TAB' TO MSG-COD-SIST
                       MOVE 'FECFJOO>FCIE' TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-OFI.

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    ==
    == ========================================================================================== -->

</additional>
