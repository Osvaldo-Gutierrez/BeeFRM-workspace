<?xml version = "1.0" encoding = "ISO-8859-1" ?>

<additional xmlns        = "http://cl/bee/genfrmjava/adddef/schema"
      xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation = "http://cl/bee/genfrmjava/adddef/schema adddef.xsd"
      system             = "COL"
      form               = "DLC">

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI" concatenate="1">

    <code><![CDATA[      *<<<< DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               IF DBC-IND-ICLI IN DLC-FLD NOT = 'M'
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-IND-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
               ELSE
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
           ELSE
               IF DBC-IND-ICLI IN DLC-FLD = 'M'
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'INDNUMICLII' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI AND PGM_BU
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI AND PGM_BU" concatenate="2">

    <code><![CDATA[
      * RBG/INI/17-ABR-1997
           IF SCR-CMND = 'ING' OR 'MOD'
      *IDC-CLI Busca Cliente por medio de IdC.
           MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC
           MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC
           MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM SGC-FIO-DBC
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI AND PGM_BU AND PGM_BX
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI AND PGM_BU AND PGM_BX" concatenate="3">

    <code><![CDATA[      *AFRI-INI/SEP2005
               IF SCR-HDR-MRCA = 'BCS'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    NODBC' TO MSG-COD-MENS IN MSG
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI AND PGM_BU$1
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI AND PGM_BU$1" concatenate="4">

    <code><![CDATA[           IF FIO-STAT-OKS
      * Si RUT cliente > 50.000.000 no validar Fecha Nacimiento.
                   IF DBC-NUM-ICLI IN DBC < WSS-NUM-ICLI IN WSS-VARI
                      AND DBC-IND-TICL IN DBC = 'P'
                       MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DCP
                       IF FIO-STAT-OKS
                           IF DCP-FEC-FNAC IN DCP NOT > ZEROES
                               MOVE 'COL'          TO MSG-COD-SIST
                               MOVE 'FECNAC   NEX' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC  TO FRM-MENS
                               MOVE FRM-SUAR-MAL  TO FRM-SUAR
                           ELSE
                               NEXT SENTENCE
                       ELSE
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE 'CLI    NODCP' TO MSG-COD-MENS IN MSG
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC  TO FRM-MENS
                           MOVE FRM-SUAR-MAL  TO FRM-SUAR
                   ELSE
                       GO TO FIN-VAL-DBC-NUM-ICLI
               ELSE
      *AFRI-INI/SEP2005
               IF SCR-HDR-MRCA = 'BCS'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    NODBC' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE 'COL'                   TO WSS-MSG-COD-SIST
                   MOVE MSG-COD-MENS IN MSG     TO WSS-MSG-COD-MENS
                   MOVE SPACES                  TO WSS-MSG-COD-FIL1
                   MOVE DBC-NUM-ICLI IN DLC-FLD TO WSS-DBC-NUM-ICLI
                   MOVE '-'                     TO WSS-MSG-COD-FIL2
                   MOVE DBC-VRF-ICLI IN DLC-FLD TO WSS-DBC-VRF-ICLI
                   MOVE SPACES                  TO WSS-MSG-COD-FIL3
                   MOVE MSG-GLS-DESC            TO WSS-MSG-GLS-DESC
                   MOVE MSG-GLS-DATA            TO WSS-MSG-GLS-DATA
                   MOVE WSS-MENS                TO FRM-MENS
                   MOVE FRM-SUAR-MAL            TO FRM-SUAR
               ELSE
      *AFRI-INI/SEP2005
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    NODBC' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC  TO FRM-MENS
                   MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      * RBG/FIN/17/ABR/1997
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI$1
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI$1" concatenate="5">

    <code><![CDATA[      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_VRF_ICLI
    == ========================================================================================== -->

  <section name="DBC_VRF_ICLI">

    <code><![CDATA[      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
      *ISP NO ACEPTA MULTIPLES DEUDORES INDIRECTOS PARA VERSION BCI
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDIND' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES

                   MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

      *VAL-RUT Valida Rut
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                              DBC-IND-ICLI IN DLC-FLD
                              DBC-GLS-ICLI IN DLC-FLD
                              RDC-CAI-ICLI IN DLC-FLD
                              RDC-IIC-ICLI IN DLC-FLD
                              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN DLC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DLC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN DLC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN DLC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN DLC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE WSS-HAY TO WSS-FRDC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    ==
    == ========================================================================================== -->

</additional>
