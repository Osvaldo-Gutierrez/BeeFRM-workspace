<?xml version = "1.0" encoding = "ISO-8859-1" ?>

<additional xmlns        = "http://cl/bee/genfrmjava/adddef/schema"
      xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation = "http://cl/bee/genfrmjava/adddef/schema adddef.xsd"
      system             = "COL"
      form               = "DLC">

  <!-- ========================================================================================== ==
    == DBC_GLS_ICLI
    == ========================================================================================== -->

  <section name="DBC_GLS_ICLI">

    <code><![CDATA[      *<<<< DBC_GLS_ICLI
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DLC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_IND_ICLI
    == ========================================================================================== -->

  <section name="DBC_IND_ICLI">

    <code><![CDATA[      *<<<< DBC_IND_ICLI
      *VAL-IND o VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DLC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_NUM_ICLI
    == ========================================================================================== -->

  <section name="DBC_NUM_ICLI">

    <code><![CDATA[      *<<<< DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               IF DBC-IND-ICLI IN DLC-FLD NOT = 'M'
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-IND-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
               ELSE
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
           ELSE
               IF DBC-IND-ICLI IN DLC-FLD = 'M'
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'INDNUMICLII' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DBC_VRF_ICLI
    == ========================================================================================== -->

  <section name="DBC_VRF_ICLI">

    <code><![CDATA[      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
      *ISP NO ACEPTA MULTIPLES DEUDORES INDIRECTOS PARA VERSION BCI
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDIND' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES

                   MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

      *VAL-RUT Valida Rut
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                              DBC-IND-ICLI IN DLC-FLD
                              DBC-GLS-ICLI IN DLC-FLD
                              RDC-CAI-ICLI IN DLC-FLD
                              RDC-IIC-ICLI IN DLC-FLD
                              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN DLC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DLC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN DLC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN DLC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN DLC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE WSS-HAY TO WSS-FRDC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_CAI_IOPC
    == ========================================================================================== -->

  <section name="DLC_CAI_IOPC">

    <code><![CDATA[      *<<<< DLC_CAI_IOPC
           IF DLC-CAI-IOPC IN DLC-FLD NOT > SPACES
               MOVE SPACES TO DLC-CAI-IOPC IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_COD_NOTC
    == ========================================================================================== -->

  <section name="DLC_COD_NOTC">

    <code><![CDATA[      *<<<< DLC_COD_NOTC
           IF DLC-COD-NOTC IN DLC-FLD NOT > SPACES
               MOVE SPACES TO DLC-COD-NOTC IN DLC-FLD
               MOVE SPACES TO FRM-GLS-NOTC IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-NOTC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_COD_PAGO
    == ========================================================================================== -->

  <section name="DLC_COD_PAGO">

    <code><![CDATA[      *<<<< DLC_COD_PAGO
      *MHM-INI 05-MAY-2006
           IF SCR-OFRM-SRV
               GO TO FIN-VAL-DLC-COD-PAGO.
      *MHM-FIN 05-MAY-2006
      *AFRI-INI/FEB-2006
           IF SCR-CMND = 'CEB' OR 'MOD' OR 'ING'
              IF DLC-COD-PAGO IN DLC-FLD NOT > SPACES AND
                (OPC-COD-TOOC IN OPC = 'BGT' OR
                 OPC-COD-TOOC IN OPC = 'BEX')
      *AFRI-FIN/FEB-2006
                 PERFORM ERR-GLS
                 GO TO FIN-VAL-DLC-COD-PAGO.
           MOVE 'COL'                   TO TAB-COD-SIST
           MOVE 'TPG'                   TO TAB-COD-TTAB IN TAB
           MOVE DLC-COD-PAGO IN DLC-FLD TO TAB-COD-CTAB
           PERFORM VAL-COD
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'NOT    VAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DLC-COD-PAGO.
           MOVE TAB-GLS-DESC IN TAB TO
                               FRM-GLS-PAGO IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_COD_PLZA
    == ========================================================================================== -->

  <section name="DLC_COD_PLZA">

    <code><![CDATA[      *<<<< DLC_COD_PLZA
           IF DLC-COD-PLZA IN DLC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-PLZA.
           MOVE DLC-COD-PLZA IN DLC-FLD TO WSS-COD-PLZA IN WSS-VARI.
           IF WSS-IND-OFIC IN WSS-VARI = 'O'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS NOT = SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-PLZA
               ELSE
                   MOVE OFI-COD-PLZA IN OFI TO WSS-COD-PLAZ IN WSS-VARI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-PLZA IN DLC-FLD
                   MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   IF OFI-COD-PLZA IN OFI = WSS-COD-PLAZ IN WSS-VARI
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'PLAZAS    =' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-DLC-COD-PLZA
                   ELSE
                       GO TO FIN-VAL-DLC-COD-PLZA.
      *ALD
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'CODPLZAINV' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-DLC-COD-PLZA.

      *     IF OPC-COD-OFOC IN DLC-FLD > SPACES AND
      *        DLC-COD-PLZA IN DLC-FLD NOT > SPACES
      *         MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
      *         PERFORM BUS-OFI
      *         MOVE OFI-COD-PLZA IN OFI TO DLC-COD-PLZA IN DLC-FLD.
      *     MOVE 'TAB' TO TAB-COD-SIST.
      *     MOVE 'PZA' TO TAB-COD-TTAB IN TAB.
      *     MOVE DLC-COD-PLZA IN DLC-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF NOT (MSG-COD-MENS NOT = 'COD    NEX' AND
      *        DLC-COD-PLZA IN DLC-FLD > SPACES )
      *         MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
      *         GO TO FIN-VAL-DLC-COD-PLZA.
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PLZA IN DLC-FLD.
      *     IF TAB-COD-DAT3 (1) > SPACES
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODPLZAINV' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *     GO TO FIN-VAL-DLC-COD-PLZA.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_COD_TDOC
    == ========================================================================================== -->

  <section name="DLC_COD_TDOC">

    <code><![CDATA[      *<<<< DLC_COD_TDOC
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
               MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
               MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
               MOVE ZEROES              TO POC-NUM-IPOC IN POC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-POC
               MOVE FIO-STAT TO PGM-STAT-POC.
           IF SCR-CMND = 'MCA'
               MOVE '23' TO PGM-STAT-POC.
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-DLC-COD-TDOC.
      *IGUALACION VAX/INI/OGB/07-2013
      *AFRI-INI/07-2006
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'DOC'                   TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-TDOC IN DLC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
            DLC-COD-TDOC IN DLC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TDOC IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-TDOC
           ELSE
               IF POC-COD-TDOC IN POC NOT > SPACES AND
                 DLC-COD-TDOC IN DLC-FLD = TAB-COD-CTAB IN TAB
                  GO TO CON-VAL-DLC-COD-TDOC
               ELSE
                IF TAB-CIC-CTAB IN TAB NOT = POC-COD-TDOC IN POC
                 IF DLC-COD-TDOC IN DLC-FLD NOT = POC-COD-TDOC IN POC
                   MOVE 'COL'            TO MSG-COD-SIST
                   MOVE 'TIPODOCNOVAL'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC     TO FRM-MENS
                   MOVE FRM-SUAR-MAL     TO FRM-SUAR
                   GO TO FIN-VAL-DLC-COD-TDOC
                 ELSE
                   NEXT SENTENCE
                ELSE
                   MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TDOC IN DLC-FLD.
      *AFRI-INI/07-2006
      *    IF DLC-COD-TDOC IN DLC-FLD NOT = POC-COD-TDOC IN POC AND
      *        POC-COD-TDOC IN POC > SPACES
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODTDOCNOPLT' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MEN1
      *         MOVE POC-COD-TDOC IN POC TO FRM-MEN2
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-DLC-COD-TDOC.
      *IGUALACION VAX/FIN/OGB/07-2013
       CON-VAL-DLC-COD-TDOC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_COD_UBFD
    == ========================================================================================== -->

  <section name="DLC_COD_UBFD">

    <code><![CDATA[      *<<<< DLC_COD_UBFD
           IF DLC-COD-UBFD IN DLC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-UBFD.
           MOVE DLC-COD-UBFD IN DLC-FLD TO WSS-UBFD.
           IF WSS-TAB-UBFD = 'OFI'
               MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-UBFD
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO
                        FRM-GLS-UBFD IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-UBFD.
           IF WSS-TAB-UBFD = 'BCO'
               GO TO BCO-UBFD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-TAB-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
                GO TO FIN-VAL-DLC-COD-UBFD.
       BCO-UBFD.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE WSS-TAB-UBFD IN WSS-UBFD TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-UBFD IN WSS-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN DLC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_FEC_FDEV
    == ========================================================================================== -->

  <section name="DLC_FEC_FDEV">

    <code><![CDATA[      *<<<< DLC_FEC_FDEV
      *     IF SCR-CCPP = 'ING'
      *         MOVE OPC-NUM-DCOL IN OPC TO DLC-NUM-DDEV IN DLC-FLD
      *         MOVE OPC-NUM-MCOL IN OPC TO DLC-NUM-MDEV IN DLC-FLD
      *         MOVE OPC-NUM-SCOL IN OPC TO DLC-NUM-SDEV IN DLC-FLD
      *         MOVE OPC-NUM-ACOL IN OPC TO DLC-NUM-ADEV IN DLC-FLD.
           MOVE  ZEROES TO DLC-FEC-FDEV IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_IND_ESTA
    == ========================================================================================== -->

  <section name="DLC_IND_ESTA">

    <code><![CDATA[      *<<<< DLC_IND_ESTA
      *AFRI-INI/FEB-2006
           IF SCR-CMND = 'ING' AND
             (OPC-COD-TOOC IN OPC = 'BGT' OR
              OPC-COD-TOOC IN OPC = 'BEX')
              MOVE 'PEN' TO DLC-IND-ESTA IN DLC-FLD.
      *AFRI-FIN/FEB-2006
      *VAL-COD Valida codigo de tabla
            IF SCR-CMND NOT = 'CEB'
                GO TO FIN-VAL-DLC-IND-ESTA.
            MOVE 'COL'                   TO TAB-COD-SIST.
            MOVE 'STB '                  TO TAB-COD-TTAB IN TAB.
            MOVE DLC-IND-ESTA IN DLC-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS = 'COD    NEX'
                GO TO FIN-VAL-DLC-IND-ESTA.
            IF DLC-IND-ESTA IN DLC = DLC-IND-ESTA IN DLC-FLD
                GO TO FIN-VAL-DLC-IND-ESTA.
      *VAL-COD Valida codigo de tabla y graba
            MOVE 'COL'               TO FIO-SIST.
            MOVE 'STB'               TO TAB-COD-TTAB.
            MOVE DLC-IND-ESTA IN DLC TO TAB-COD-CTAB.
            MOVE FIO-GET-KEY    TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF FIO-STAT-OKS
               MOVE TAB-GLS-DATA(1:3)  TO WSS-IND-ESTA-DLC
               IF DLC-IND-ESTA IN DLC-FLD NOT = WSS-IND-ESTA-DLC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DLCINDESTANV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DLC-IND-ESTA.
            MOVE 'COL'                   TO TAB-COD-SIST.
            MOVE 'REE'                   TO TAB-COD-TTAB IN TAB.
            MOVE DLC-IND-ESTA IN DLC-FLD TO TAB-COD-CTAB (1:3).
            MOVE DLC-IND-ETAP IN DLC-FLD TO TAB-COD-CTAB (4:3).
            PERFORM VAL-COD.
            IF MSG-COD-MENS = 'COD    NEX' OR
               DLC-IND-ETAP IN DLC-FLD NOT > SPACES
                MOVE 'COL'        TO MSG-COD-SIST
                MOVE 'NOTREE VAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-DLC-IND-ESTA.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_IND_ETAP
    == ========================================================================================== -->

  <section name="DLC_IND_ETAP">

    <code><![CDATA[      *<<<< DLC_IND_ETAP
      *AFRI-INI/FEB-2006
           IF SCR-CMND = 'ING' AND
             (OPC-COD-TOOC IN OPC = 'BGT' OR
              OPC-COD-TOOC IN OPC = 'BEX')
              MOVE 'NOA' TO DLC-IND-ETAP IN DLC-FLD.
      *AFRI-FIN/FEB-2006
      *<<<< DLC_IND_ETAP
      *       IF DLC-IND-ETAP IN DLC-FLD NOT > SPACES
      *           MOVE SPACES TO DLC-IND-ETAP IN DLC-FLD
      *           GO TO FIN-VAL-DLC-IND-ETAP.
      *     IF SCR-CMND = 'CEB'
      *         IF DLC-IND-ETAP IN DLC-FLD NOT > SPACES
      *             MOVE 'ING' TO DLC-IND-ETAP IN DLC-FLD
      *             PERFORM ERR-GLS
      *             GO TO FIN-VAL-DLC-IND-ETAP.
            IF SCR-CMND NOT = 'CEB'
                GO TO FIN-VAL-DLC-IND-ETAP.
      *VAL-COD Valida codigo de tabla
            MOVE 'COL'                   TO TAB-COD-SIST.
            MOVE 'EBG '                  TO TAB-COD-TTAB IN TAB.
            MOVE DLC-IND-ETAP IN DLC-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS = 'COD    NEX'
                GO TO FIN-VAL-DLC-IND-ETAP.
            MOVE DLC-CAI-IOPC IN DLC-FLD TO DLC-CAI-IOPC IN DLC.
            MOVE DLC-IIC-IOPC IN DLC-FLD TO DLC-IIC-IOPC IN DLC.
            MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLC IN DLC.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM COL-FIO-DLC.
            IF DLC-IND-ETAP IN DLC = DLC-IND-ETAP IN DLC-FLD
                GO TO FIN-VAL-DLC-IND-ETAP.
            MOVE 'COL'               TO FIO-SIST.
            MOVE 'EBG'               TO TAB-COD-TTAB.
            MOVE DLC-IND-ETAP IN DLC TO TAB-COD-CTAB.
            MOVE FIO-GET-KEY    TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF FIO-STAT-OKS
               MOVE TAB-GLS-DATA(1:3) TO WSS-IND-ETAP-DLC
               IF DLC-IND-ETAP IN DLC-FLD NOT = WSS-IND-ETAP-DLC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DLCINDETAPNV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DLC-IND-ETAP.
           IF DLC-IND-ETAP IN DLC-FLD NOT > SPACES
              MOVE SPACES TO DLC-IND-ETAP IN DLC-FLD.

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_MSC_MIPL
    == ========================================================================================== -->

  <section name="DLC_MSC_MIPL">

    <code><![CDATA[      *<<<< DLC_MSC_MIPL
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-DLC-MSC-MIPL.
           IF DLC-MSC-MIPL IN DLC-FLD NOT = POC-MSC-MIPL IN POC AND
              POC-MSC-MIPL IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCMIPLNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-MIPL IN POC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-MSC-MIPL.
       CON-VAL-DLC-MSC-MIPL.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_MSC_TIMP
    == ========================================================================================== -->

  <section name="DLC_MSC_TIMP">

    <code><![CDATA[      *<<<< DLC_MSC_TIMP
      *MHM-INI 09-MAY-2008
           IF NOT SCR-OFRM-SRV
               GO TO CNT-VAL-DLC-MSC-TIMP.
      *MHM-FIN 09-MAY-2008
      *LFZ-INI 2007-12-18
           MOVE 'COL'               TO FIO-SIST.
           MOVE 'TII'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS  AND
              TAB-IND-VIGE = 'S'
              IF DLC-VAL-IMPU IN DLC-FLD > ZEROES
                 MOVE TAB-GLS-DAT1(1:1) TO DLC-MSC-TIMP IN DLC-FLD
              ELSE
                 MOVE TAB-GLS-DAT1(2:1) TO DLC-MSC-TIMP IN DLC-FLD.
      *LFZ-FIN 2007-12-18
      *MHM-INI 09-MAY-2008
       CNT-VAL-DLC-MSC-TIMP.
      *MHM-FIN 09-MAY-2008

           IF SCR-CMND NOT = 'MCA'
               MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
               MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF OPC-IND-RENO IN OPC = 'PRO'
                  PERFORM PRO-DLC-PROG
                   IF FIO-STAT-OKS
                   IF DLC-MSC-TIMP IN DLC NOT = DLC-MSC-TIMP IN DLC-FLD
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'TIMPNOT=IMP' TO MSG-COD-MENS
      *                MOVE DLC-IIC-IOCO IN DLC-FLD TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-DLC-MSC-TIMP.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_VAL_NDLC
    == ========================================================================================== -->

  <section name="DLC_VAL_NDLC">

    <code><![CDATA[      *<<<< DLC_VAL_NDLC
      *BUS-TAB busca glosa de codigo en tabla
           MOVE OPC-COD-TOOC IN DLC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTOC NEX' TO MSG-COD-MENS
               PERFORM GET-MSG

      *        STRING MSG-GLS-DESC
      *               MSG-GLS-DATA DELIMITED BY SIZE
      *        INTO FRM-MENS

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-VAL-NDLC.

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'INDOPECNEX' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

      *        STRING MSG-GLS-DESC
      *               MSG-GLS-DATA DELIMITED BY SIZE
      *        INTO FRM-MENS

               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-VAL-NDLC.
      *
      *     IF MSC-CIC-CMSC IN MSC = 'D'
      *             GO TO FIN-VAL-DLC-VAL-NDLC.
           IF DLC-VAL-NDLC IN DLC-FLD NOT > ZEROES
               MOVE OPC-VAL-CRED IN OPC TO DLC-VAL-NDLC IN DLC-FLD.
           IF DLC-VAL-NDLC IN DLC-FLD > OPC-VAL-CRED IN OPC
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VALNDLCCRED>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == DLC_VAL_SDLC
    == ========================================================================================== -->

  <section name="DLC_VAL_SDLC">

    <code><![CDATA[      *<<<< DLC_VAL_SDLC
           IF OPC-MSC-STAT IN OPC NOT = 'C'
               MOVE DLC-VAL-NDLC IN DLC-FLD TO DLC-VAL-SDLC IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == EOF_BU
    == ========================================================================================== -->

  <section name="EOF_BU">

    <code><![CDATA[      *<<<< EOF_BU
       RET-CXE-DLC SECTION.
       INI-RET-CXE-DLC.
      *MHM-INI 05-MAY-2006
           MOVE FRM-NUM-PIMP IN DLC-FLD TO CXE-SGV-TINT IN CXE.
      *MHM-FIN 05-MAY-2006
       FIN-RET-CXE-DLC.
           EXIT.

      *INI-AFRI-IMPP/DIC2005
       KEY-CXE-DLC SECTION.
       INI-KEY-CXE-DLC.
           MOVE LOW-VALUES TO CXE.
           MOVE SPACES                  TO CXE-GLS-FLAG IN CXE.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO CXE-CAI-IOPC IN CXE.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO CXE-IIC-IOPC IN CXE.
           MOVE ZEROES                  TO CXE-NUM-EVEN IN CXE.
           MOVE 'CUR'                   TO CXE-COD-EVEN IN CXE.
           MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
           MOVE 'IMPPRG'                TO CXE-COD-CPTO IN CXE.
       FIN-KEY-CXE-DLC.
           EXIT.
      *FIN-AFRI-IMPP/DIC2005
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == EOF_BU$1
    == ========================================================================================== -->

  <section name="EOF_BU$1">

    <code><![CDATA[      *<<<< EOF_BU
       PRO-DLC-PROG SECTION.
       INI-PRO-DLC-PROG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES                  TO ROV-CAI-IOPV IN ROV.
           MOVE SPACES                  TO ROV-IIC-IOPV IN ROV.
           MOVE ZEROES                  TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
              ROV-CAI-IOPC IN ROV = DLC-CAI-IOPC IN DLC-FLD AND
              ROV-IIC-IOPC IN ROV = DLC-IIC-IOPC IN DLC-FLD )
               MOVE '23' TO FIO-STAT
               GO TO FIN-PRO-DLC-PROG.
           MOVE ROV-CAI-IOPV IN ROV TO CAN-CAI-IOPC IN CAN.
           MOVE ROV-IIC-IOPV IN ROV TO CAN-IIC-IOPC IN CAN.
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-PROG.
           IF CAN-MSC-TCAN IN CAN NOT = 'P'
               MOVE '23' TO FIO-STAT
               GO TO FIN-PRO-DLC-PROG.
           MOVE ROV-CAI-IOPV IN ROV     TO DLC-CAI-IOPC IN DLC.
           MOVE ROV-IIC-IOPV IN ROV     TO DLC-IIC-IOPC IN DLC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-PROG.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'FECHAPTT    ' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
                  TAB-IND-VIGE IN TAB = 'N'
                   MOVE '20060822' TO WSS-FEC-FPRO
           ELSE
               MOVE TAB-GLS-DATA IN TAB TO WSS-VEC-DATA.
           MOVE ROV-CAI-IOPV IN ROV     TO OPC-CAI-IOPC IN OPC.
           MOVE ROV-IIC-IOPV IN ROV     TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC
           IF OPC-FEC-FINP IN OPC < WSS-FEC-FPRO
               IF DLC-MSC-TIMP IN DLC = 'E'
                   MOVE SPACES TO DLC-MSC-TIMP IN DLC-FLD
                   MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
                   MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-PRO-DLC-PROG.

           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-PRO-DLC-PROG.
           EXIT.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_DLC_IND_HPER
    == ========================================================================================== -->

  <section name="FIN_DLC_IND_HPER">

    <code><![CDATA[      *<<<< FIN_DLC_IND_HPER
      * OGB-INI 09-OCT-2013 CALCULO IMPUESTOS
           IF MSG-COD-MENS  > SPACES
              GO TO FIN-VAL-DLC-IND-HPER.
           MOVE TAB-GLS-DATA TO WSS-COD-DATA IN WSS-VARI.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE OPC-IND-RENO IN OPC TO WSS-IND-RENO IN WSS-VARI.
           IF WSS-IND-RENO NOT > SPACES
              IF WSS-IND-ICUR = WSS-IND-N
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE WSS-IND-SCOL TO MSG-COD-SIST
                 MOVE WSS-GLS-NCUR TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                 GO TO FIN-VAL-DLC-IND-HPER.
           IF WSS-IND-RENO = WSS-COD-RENO
              IF WSS-IND-IREN = WSS-IND-N
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE WSS-IND-SCOL TO MSG-COD-SIST
                 MOVE WSS-GLS-NREN TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                 GO TO FIN-VAL-DLC-IND-HPER.
           IF WSS-IND-RENO = WSS-COD-PROR
              IF WSS-IND-IPRO = WSS-IND-N
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE WSS-IND-SCOL TO MSG-COD-SIST
                 MOVE WSS-GLS-NPRO TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                 GO TO FIN-VAL-DLC-IND-HPER.
      * OGB-INI 09-OCT-2013 CALCULO IMPUESTOS
      *>>>> FIN_DLC_IND_HPER
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_DLC_IND_SCBZ
    == ========================================================================================== -->

  <section name="FIN_DLC_IND_SCBZ">

    <code><![CDATA[      *<<<< FIN_DLC_IND_SCBZ
      *AFRI-INI/JUN2008 (MAE)
           PERFORM IND-OPC-PRO.
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           IF DLC-IND-EPRO = 'J'
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'ERRDLCJUDIC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-IND-SCBZ.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
           IF DLC-IND-EPRO = 'S'
      *LOP-INI 25-10-2010 PEDIDO DE DANIEL GONZALEZ
              MOVE DLC-IND-SCRT IN DLC-VARI TO DLC-IND-SCRT IN DLC-FLD
              MOVE DLC-IND-SCTB IN DLC-VARI TO DLC-IND-SCTB IN DLC-FLD
      *LOP-FIN 25-10-2010 PEDIDO DE DANIEL GONZALEZ
              MOVE DLC-IND-SCBZ IN DLC-VARI TO DLC-IND-SCBZ IN DLC-FLD.
      *AFRI-FIN/JUN2008 (MAE)
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PRO_DLC_DLC
    == ========================================================================================== -->

  <section name="FIN_PRO_DLC_DLC">

    <code><![CDATA[      *<<<< FIN_PRO_DLC_DLC

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_DBC_DLC
    == ========================================================================================== -->

  <section name="FIN_PUT_DBC_DLC">

    <code><![CDATA[      *<<<< FIN_PUT_DBC_DLC
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_DLC_DLC
    == ========================================================================================== -->

  <section name="FIN_PUT_DLC_DLC">

    <code><![CDATA[      *<<<< FIN_PUT_DLC_DLC
      *BUS-TAB busca glosa de codigo en tabla
      *     IF DLC-COD-PAGO IN DLC-FLD > SPACES
      *         MOVE 'COL' TO TAB-COD-SIST
      *         MOVE 'TPG ' TO TAB-COD-TTAB IN TAB
      *         MOVE DLC-COD-PAGO IN DLC-FLD TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DCOR IN TAB TO
      *              FRM-GLS-PAGO IN DLC-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-PAGO IN DLC-FLD.

      *BUS-TAB busca glosa de codigo en tabla
           MOVE DLC-COD-UBFD IN DLC-FLD TO WSS-UBFD.
           IF WSS-TAB-UBFD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
           ELSE
           IF WSS-TAB-UBFD = 'OFI'
               MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO
                        FRM-GLS-UBFD IN DLC-FLD
            ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE WSS-TAB-UBFD TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-UBFD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN DLC-FLD.
           IF DLC-COD-PLZA IN DLC-FLD NOT > SPACES
               GO TO CON-PUT-DLC-DLC.
           MOVE DLC-COD-PLZA IN DLC-FLD TO WSS-COD-PLZA IN WSS-VARI.
           IF WSS-IND-OFIC IN WSS-VARI = 'O'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-PLZA IN DLC-FLD.
       CON-PUT-DLC-DLC.
      *AFRI-INI
           MOVE LOW-VALUES TO CXE.
           MOVE SPACES               TO CXE-GLS-FLAG IN CXE.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO  CXE-CAI-IOPC IN CXE.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO  CXE-IIC-IOPC IN CXE.
           MOVE ZEROES               TO CXE-NUM-EVEN IN CXE.
           MOVE 'CUR'                TO CXE-COD-EVEN IN CXE.
           MOVE SPACES               TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES               TO CXE-NUM-IVCT IN CXE.
           MOVE 'IMPPRG'             TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE CXE-SGV-TINT IN CXE TO FRM-NUM-PIMP IN DLC-FLD
               MOVE 'P'      TO FRM-IND-PIMP IN DLC-FLD
               MOVE 'PRD'    TO FRM-GLS-PIMP IN DLC-FLD
           ELSE
               MOVE SPACES   TO FRM-IND-PIMP IN DLC-FLD
               MOVE SPACES   TO FRM-GLS-PIMP IN DLC-FLD
               MOVE ZEROES              TO FRM-NUM-PIMP IN DLC-FLD.
      *AFRI-FIN
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_ICG_DLC
    == ========================================================================================== -->

  <section name="FIN_PUT_ICG_DLC">

    <code><![CDATA[      *<<<< FIN_PUT_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_OPC_DLC
    == ========================================================================================== -->

  <section name="FIN_PUT_OPC_DLC">

    <code><![CDATA[      *<<<< FIN_PUT_OPC_DLC
      *BUS-TAB busca glosa de codigo en tabla
      * NO EXISTE OPC-COD-VCOC IN DLC-FLD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_RDC_DLC
    == ========================================================================================== -->

  <section name="FIN_PUT_RDC_DLC">

    <code><![CDATA[      *<<<< FIN_PUT_RDC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO RDC-NUM-DIRE IN DLC-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_RET_ALL_DLC
    == ========================================================================================== -->

  <section name="FIN_RET_ALL_DLC">

    <code><![CDATA[      *<<<< FIN_RET_ALL_DLC
           PERFORM RET-CXE-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_RET_ICG_DLC
    == ========================================================================================== -->

  <section name="FIN_RET_ICG_DLC">

    <code><![CDATA[      *<<<< FIN_RET_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-SPRD IN ICG.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_UNP_DLC_DLC
    == ========================================================================================== -->

  <section name="FIN_UNP_DLC_DLC">

    <code><![CDATA[      *<<<< FIN_UNP_DLC_DLC

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_VAL_CON_IKY_DLC
    == ========================================================================================== -->

  <section name="FIN_VAL_CON_IKY_DLC">

    <code><![CDATA[      *<<<< FIN_VAL_CON_IKY_DLC
           IF DLC-IIC-IOPC IN DLC-FLD NOT > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'IICIDLCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_VAL_CON_KEY_DLC
    == ========================================================================================== -->

  <section name="FIN_VAL_CON_KEY_DLC">

    <code><![CDATA[      *<<<< FIN_VAL_CON_KEY_DLC
           IF NOT (   DLC-IIC-IOPC IN DLC-FLD > SPACES   OR

                    ( DLC-IIC-IOPC IN DLC-FLD > SPACES   AND
                      DLC-NUM-IDLC IN DLC-FLD > ZEROES ) OR

                    ( DBC-NUM-ICLI IN DLC-FLD > ZEROES ) OR

                    ( DBC-GLS-NOMC IN DLC-FLD > SPACES ) )
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_GLS_PAGO
    == ========================================================================================== -->

  <section name="FRM_GLS_PAGO">

    <code><![CDATA[      *<<<< FRM_GLS_PAGO
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_FRM_NUM_PIMP
    == ========================================================================================== -->

  <section name="INI_FRM_NUM_PIMP">

    <code><![CDATA[      *<<<< INI_FRM_NUM_PIMP
           IF FRM-NUM-PIMP IN DLC-FLD > 12
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'NUMPIMP>12 ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_FST_FLD_DLC
    == ========================================================================================== -->

  <section name="INI_FST_FLD_DLC">

    <code><![CDATA[      *<<<< INI_FST_FLD_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE -1 TO DLC-VAL-NDLC-LEN IN DLC-FLD
               GO TO FIN-FST-FLD-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_PRO_FLD_DLC
    == ========================================================================================== -->

  <section name="INI_PRO_FLD_DLC">

    <code><![CDATA[      *<<<< INI_PRO_FLD_DLC
      *Igualacion vax/INI/OGB/07-2013
      *vax
           MOVE FRM-CPIM-AEY TO FRM-GLS-MIPL-ATR IN DLC-FLD.
      *OGB-INI/IMPUESTOS/08-2013
      *    MOVE FRM-CPIM-AEY TO FRM-NUM-PIMP-ATR IN DLC-FLD.
      *OGB-FIN/IMPUESTOS/08-2013
      *fin-vax
      *Igualacion vax/FIN/OGB/07-2013

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_PUT_DBC_DLC
    == ========================================================================================== -->

  <section name="INI_PUT_DBC_DLC">

    <code><![CDATA[      *<<<< INI_PUT_DBC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_UNP_FLD_DLC
    == ========================================================================================== -->

  <section name="INI_UNP_FLD_DLC">

    <code><![CDATA[      *<<<< INI_UNP_FLD_DLC

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_VAL_CON_KEY_DLC
    == ========================================================================================== -->

  <section name="INI_VAL_CON_KEY_DLC">

    <code><![CDATA[      *<<<< INI_VAL_CON_KEY_DLC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_VAL_FLD_DLC
    == ========================================================================================== -->

  <section name="INI_VAL_FLD_DLC">

    <code><![CDATA[      *<<<< INI_VAL_FLD_DLC
      *RRM-INI MAYO-2018 Cambio en Comando CEB
           IF SCR-CMND = 'CEB'
              PERFORM VAL-FRM-GLS-PAGO
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 MOVE FRM-IND-ERRO TO FRM-GLS-PAGO-LEN IN DLC-FLD
                 GO TO FIN-VAL-FLD-DLC
              ELSE
              PERFORM VAL-DLC-IND-ESTA
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 MOVE FRM-IND-ERRO TO DLC-IND-ESTA-LEN IN DLC-FLD
                 GO TO FIN-VAL-FLD-DLC
              ELSE
              PERFORM VAL-DLC-IND-ETAP
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 MOVE FRM-IND-ERRO TO DLC-IND-ETAP-LEN IN DLC-FLD
                 GO TO FIN-VAL-FLD-DLC
              ELSE
              PERFORM VAL-DLC-IND-HPER
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 MOVE FRM-IND-ERRO TO DLC-IND-HPER-LEN IN DLC-FLD
                 GO TO FIN-VAL-FLD-DLC
              ELSE
                 GO TO FIN-VAL-FLD-DLC.
      *RRM-FIN MAYO-2018 Cambio en Comando CEB
      *PVG INI 25-AGO-2006
           IF SCR-CMND = 'MCL'
              PERFORM VAL-DLC-COD-NOTC
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 MOVE FRM-IND-ERRO TO DLC-COD-NOTC-LEN IN DLC-FLD
                 GO TO FIN-VAL-FLD-DLC
              ELSE
                 GO TO FIN-VAL-FLD-DLC.
      *PVG FIN 25-AGO-2006
           IF SCR-CMND NOT = 'MCA'
               GO TO CON-VAL-FLD-DLC.
           PERFORM VAL-FRM-NUM-PIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-PIMP-LEN IN DLC-FLD
                GO TO FIN-VAL-FLD-DLC.
           PERFORM VAL-FRM-IND-PIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-PIMP-LEN IN DLC-FLD
                GO TO FIN-VAL-FLD-DLC.
           PERFORM VAL-FRM-GLS-PIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PIMP-LEN IN DLC-FLD
                GO TO FIN-VAL-FLD-DLC.
           PERFORM VAL-DLC-VAL-IMPU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DLC-VAL-IMPU-LEN IN DLC-FLD
                GO TO FIN-VAL-FLD-DLC.
           PERFORM VAL-DLC-MSC-TIMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DLC-MSC-TIMP-LEN IN DLC-FLD
                GO TO FIN-VAL-FLD-DLC.
           GO TO FIN-VAL-FLD-DLC.
       CON-VAL-FLD-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU
    == ========================================================================================== -->

  <section name="PGM_BU">

    <code><![CDATA[      *<<<< INI_FST_FLD_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE -1 TO DLC-VAL-NDLC-LEN IN DLC-FLD
               GO TO FIN-FST-FLD-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == RDC_NUM_DIRE
    == ========================================================================================== -->

  <section name="RDC_NUM_DIRE">

    <code><![CDATA[      *<<<< RDC_NUM_DIRE
           IF DBC-IND-ICLI IN DLC-FLD = 'M' OR
              DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               MOVE ZEROES TO RDC-NUM-DIRE IN DLC-FLD
               GO TO FIN-VAL-RDC-NUM-DIRE.
           IF RDC-NUM-DIRE IN DLC-FLD NOT > ZEROES
               PERFORM BUS-DOM
               IF RCD-GLS-DIRE IN RCD > SPACES
                   MOVE RCD-NUM-DIRE IN RCD TO RDC-NUM-DIRE IN DLC-FLD
                   GO TO FIN-VAL-RDC-NUM-DIRE
               ELSE
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'NUMDONINEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RDC-NUM-DIRE.

           MOVE RDC-CAI-ICLI IN DLC-FLD TO RCD-CAI-ICLI IN RCD.
           MOVE RDC-IIC-ICLI IN DLC-FLD TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN DLC-FLD TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'NUMDIRENEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RDC-NUM-DIRE.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == SETTAG
    == ========================================================================================== -->

  <section name="SETTAG">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == VAL_CON_FLD_DLC
    == ========================================================================================== -->

  <section name="VAL_CON_FLD_DLC">

    <code><![CDATA[      *<<<< VAL_CON_FLD_DLC
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD.

           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
               MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
               MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
               MOVE ZEROES              TO POC-NUM-IPOC IN POC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-POC
               MOVE FIO-STAT TO PGM-STAT-POC.

           IF SCR-CMND = 'MCA'
               MOVE '23' TO PGM-STAT-POC.

           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              PGM-STAT-POC-OKS                     AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               IF POC-IND-AVAL IN POC = 'S'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-DLC.
      *ALDI
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               MOVE 'COL'  TO FIO-SIST
               MOVE 'GARA' TO MSC-CIC-TMSC IN MSC
               MOVE '2'    TO MSC-CIC-CMSC IN MSC
               MOVE 'MSC-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS AND
                  OPC-IND-GARA IN OPC = MSC-COD-CMSC IN MSC
      *ALD-AFRI-INI
      *           AND OPC-COD-TTRN IN OPC NOT = '130'
                  PERFORM BUS-CNAL
                  IF WSS-EXT-CNAL = 'NO'
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-CON-FLD-DLC.
      *ALDF
      *INI-AFRI-PDM/JUN2006
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               MOVE 'COL'  TO FIO-SIST
               MOVE 'GARA' TO MSC-CIC-TMSC IN MSC
               MOVE '13'    TO MSC-CIC-CMSC IN MSC
               MOVE 'MSC-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS AND
                  OPC-IND-GARA IN OPC = MSC-COD-CMSC IN MSC
                  PERFORM BUS-CNAL
                  IF WSS-EXT-CNAL = 'NO'
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-CON-FLD-DLC.
      *FIN-AFRI-PDM/JUN2006
      *ALD-AFRI-FIN
           PERFORM VAL-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL
                GO TO FIN-VAL-CON-FLD-DLC.

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF DLC-MSC-TIMP IN DLC-FLD > SPACES
               MOVE 'COL'                   TO MSC-COD-SIST
               MOVE 'TIMP'                  TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-TIMP IN DLC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               IF MSC-CIC-MSCL IN MSC = 'I'
                   IF DLC-VAL-IMPU IN DLC-FLD NOT > ZEROES
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE 'COL'        TO MSG-COD-SIST
                       MOVE 'VALIMPUZER' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       GO TO FIN-VAL-CON-FLD-DLC.
      *    ELSE CALCULO

      *LOP-INI GASTOS DE NOTARIO INFORMADOS OPERACIONES CONOSUR
           MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VALIMPUZER' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               GO TO FIN-VAL-CON-FLD-DLC
           ELSE
              IF OFI-COD-MODL IN OFI = '8'
                 GO TO NOT-NOTC.
      *LOP-FIN GASTOS DE NOTARIO INFORMADOS OPERACIONES CONOSUR

           IF DLC-COD-NOTC IN DLC-FLD NOT  > SPACES
               MOVE ZEROES TO DLC-VAL-GNOT IN DLC-FLD
               GO TO NOT-NOTC.
      *
      *PVG INI 18-ENE-2006 INTEGRACION CGN-MC2
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'NOT '                  TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-NOTC IN DLC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-CIC-CTAB IN TAB = 'PRECIO'
              MOVE ZEROES TO DLC-VAL-GNOT IN DLC-FLD
              GO TO NOT-NOTC.
      *PVG FIN 18-ENE-2006
           MOVE 'NTR'                   TO NTR-COD-TTAB IN NTR.
           MOVE DLC-COD-NOTC IN DLC-FLD TO NTR-COD-NOTA IN NTR.
           MOVE OPC-COD-OFOC IN DLC-FLD TO NTR-COD-OFIC IN NTR.
           MOVE DLC-COD-TDOC IN DLC-FLD TO NTR-COD-TDOC IN NTR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-NTR.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-NTR
               IF NTR-IND-VIGE = 'N'
                    MOVE 'COL'        TO MSG-COD-SIST
                    MOVE 'CODNOTCNVG' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-CON-FLD-DLC
               ELSE
                   MOVE SPACES TO MSG-COD-MENS
                                   MSG-GLS-DESC
           ELSE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CODNOTGSTNE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC.

           IF PGM-STAT-NTR-OKS AND
              NTR-IND-VIGE NOT = 'N' AND
              NTR-CIC-GNOT IN NTR = 'I'
               IF DLC-VAL-GNOT IN DLC-FLD NOT > ZEROES
                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'VALGNOTZERO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-DLC.

      *      IF PGM-STAT-NTR-OKS AND
      *         DLC-VAL-GNOT IN DLC-FLD NOT > ZEROES

       NOT-NOTC.
      *DAD ini 22-MAR-1991
      * Valida que cuando sea Pesos la moneda no acepte valores con deci
       INI-VAL-PES-DECI.
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC
           ELSE
               IF OPC-COD-VCOC IN OPC NOT = TAB-COD-CTAB IN TAB
                   GO TO FIN-VAL-PES-DECI.

           MOVE DLC-VAL-NDLC IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-NDLC IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE DLC-VAL-IMPU IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-IMPU IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE DLC-VAL-GNOT IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-GNOT IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           GO TO FIN-VAL-PES-DECI.
       MSG-VAL-PES-DECI.
           MOVE 'COL'       TO MSG-COD-SIST.
           MOVE 'VALNODECI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-FLD-DLC.
       FIN-VAL-PES-DECI.
      *DAD fin  22-MAR-1991
      *DAD ini  06-AUG-1992   (Memo.22-07-92 Pto.3)
      *     IF FRM-COD-TOSB IN DLC-FLD NOT > SPACES
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *     MOVE 'COL'  TO FIO-SIST.
      *     MOVE 'TCCT' TO MSC-CIC-TMSC IN MSC.
      *     MOVE 'CAP'  TO MSC-CIC-CMSC IN MSC.
      *     MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-MSC.
      *     IF FIO-STAT-OKS
      *         MOVE MSC-COD-CMSC IN MSC TO DCC-MSC-TCCT IN DCC
      *     ELSE
      *         MOVE 'CAP' TO DCC-MSC-TCCT IN DCC.
      *     MOVE OPC-COD-VCOC IN OPC     TO DCC-COD-VCAM IN DCC.
      *     MOVE OPC-COD-COOC IN OPC     TO DCC-COD-COCR IN DCC.
      *     MOVE DLC-COD-PLZO IN DLC-FLD TO DCC-COD-PLZO IN DCC.
      *     MOVE DLC-IND-SCRT IN DLC-FLD TO DCC-IND-SCRT IN DCC.
      *     MOVE DLC-IND-SCTB IN DLC-FLD TO DCC-IND-SCTB IN DCC.
      *     MOVE DLC-IND-SCBZ IN DLC-FLD TO DCC-IND-SCBZ IN DCC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-DCC.
      *     IF ( NOT FIO-STAT-OKS) OR
      *        DCC-CIC-TCCT IN DCC NOT = FRM-COD-TOSB IN DLC-FLD
      *         MOVE 'COL'        TO MSG-COD-SIST
      *         MOVE 'CODTOSBNEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *DAD fin  06-AUG-1992
      *     IF DLC-VAL-IMPU IN DLC-FLD > DLC-VAL-DPES IN DLC-FLD
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'VALIMPUDPES>' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *     IF DLC-VAL-GNOT IN DLC-FLD > DLC-VAL-DPES IN DLC-FLD
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'VALGNOTDPES>' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    ==
    == ========================================================================================== -->

</additional>
