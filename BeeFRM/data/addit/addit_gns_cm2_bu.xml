<?xml version = "1.0" encoding = "ISO-8859-1" ?>

<additional xmlns        = "http://cl/bee/genfrmjava/adddef/schema"
      xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation = "http://cl/bee/genfrmjava/adddef/schema adddef.xsd"
      system             = "GNS"
      form               = "CM2">

  <!-- ========================================================================================== ==
    == CM2_COD_AUTC
    == ========================================================================================== -->

  <section name="CM2_COD_AUTC">

    <code><![CDATA[      *<<<< CM2_COD_AUTC
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'USR'        TO USR-COD-TTAB IN USR.
           MOVE CM2-COD-AUTC IN CM2-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              CM2-COD-AUTC IN CM2-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUTC IN CM2-FLD
               MOVE USR-COD-UBIC IN USR TO CM2-COD-UBIC IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AUTC IN CM2-FLD
               MOVE SPACES TO CM2-COD-UBIC IN CM2-FLD
               MOVE SPACES TO USR-COD-UBIC IN USR.
           IF USR-COD-UBIC IN USR > SPACES
               IF USR-IND-UBIC IN USR = 'O'
                   MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN CM2-FLD
               ELSE
                   MOVE 'UBI' TO TAB-COD-TTAB IN TAB
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE USR-COD-UBIC IN USR TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN CM2-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_COD_OTRN
    == ========================================================================================== -->

  <section name="CM2_COD_OTRN">

    <code><![CDATA[      *<<<< CM2_COD_OTRN
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF CM2-COD-OTRN IN CM2-FLD NOT > SPACES
              GO TO FIN-VAL-CM2-COD-OTRN.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'CNL' TO TAB-COD-TTAB IN TAB.
           MOVE CM2-COD-OTRN IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-OTRN IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OTRN IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_COD_TCOM
    == ========================================================================================== -->

  <section name="CM2_COD_TCOM">

    <code><![CDATA[
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'TCO' TO TAB-COD-TTAB IN TAB.
           MOVE CM2-COD-TCOM IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCOM IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCOM IN CM2-FLD.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_FEC_FCMT
    == ========================================================================================== -->

  <section name="CM2_FEC_FCMT">

    <code><![CDATA[      *<<<< CM2_FEC_FCMT
           IF SCR-CCPP = 'ING' AND
              CM2-FEC-FCMT IN CM2-FLD NOT > ZEROES
               PERFORM GET-FHOY
               MOVE HOY-DHOY IN HOY-VARI TO CM2-NUM-DCMT IN CM2-FLD
               MOVE HOY-MHOY IN HOY-VARI TO CM2-NUM-MCMT IN CM2-FLD
               MOVE HOY-SHOY IN HOY-VARI TO CM2-NUM-SCMT IN CM2-FLD
               MOVE HOY-AHOY IN HOY-VARI TO CM2-NUM-ACMT IN CM2-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_GLS_DISP
    == ========================================================================================== -->

  <section name="CM2_GLS_DISP">

    <code><![CDATA[      *<<<< CM2_GLS_DISP
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF CM2-GLS-DISP IN CM2-FLD NOT > SPACES
              GO TO FIN-VAL-CM2-GLS-DISP.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'DSP' TO TAB-COD-TTAB IN TAB.
           MOVE CM2-GLS-DISP IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DISP IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-DISP IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_GLS_REFE
    == ========================================================================================== -->

  <section name="CM2_GLS_REFE">

    <code><![CDATA[      *<<<< CM2_GLS_REFE
           IF CM2-GLS-REFE IN CM2-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == CM2_MSC_STAT
    == ========================================================================================== -->

  <section name="CM2_MSC_STAT">

    <code><![CDATA[      *<<<< CM2_MSC_STAT
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF CM2-MSC-STAT IN CM2-FLD NOT > SPACES
              GO TO FIN-VAL-CM2-MSC-STAT.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'EST' TO TAB-COD-TTAB IN TAB.
           MOVE CM2-MSC-STAT IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-STAT IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STAT IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == EOF
    == ========================================================================================== -->

  <section name="EOF">

    <code><![CDATA[      *<<<< EOF
       BUS-FRM-NORD SECTION.
       INI-BUS-FRM-NROD.
           MOVE SPACES TO WSS-COD-CTAB.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    MOVE 'CMT'  TO WSS-COD-TENT.

           MOVE WSS-COD-PREF TO WSS-COD-TENT.
           MOVE ZEROES TO WSS-NUM-Y.
           MOVE SPACES TO WSS-COD-ERROR.

           IF RC2-COD-ENTI IN CM2-FLD NOT > SPACES
              GO TO FIN-BUS-FRM-NORD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           MOVE RC2-COD-ENTI IN CM2-FLD TO WSS-COD-ENTI.
           IF RC2-COD-SIST IN CM2-FLD > SPACES
              MOVE RC2-COD-SIST IN CM2-FLD TO TAB-COD-SIST FIO-SIST
           ELSE
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO TAB-COD-SIST FIO-SIST
           ELSE
               MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST.
           MOVE 'FRM'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-BUS-FRM-NORD.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               IF FIO-CMND = FIO-GET-NXT
                   MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM GNS-FIO-TAB
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB
               IF WSS-COD-ENTI NOT = RC2-COD-ENTI IN CM2-FLD
                   MOVE SCR-SISG TO TAB-COD-SIST FIO-SIST
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM GNS-FIO-TAB.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.

           IF NOT ( FIO-STAT-OKS AND WSS-COD-TENT = WSS-COD-PREF AND
                    WSS-COD-ENTI = RC2-COD-ENTI IN CM2-FLD )
               GO TO FIN-BUS-FRM-NORD.

           IF TAB-GLS-DESC IN TAB NOT > SPACES OR
              TAB-MSC-STAT IN TAB = 'N'
               GO TO NXT-BUS-FRM-NORD.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-NORD.

      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    IF WSS-COD-CORR = '01'
      *        MOVE TAB-GLS-DCOR TO FRM-GLS-TNOM IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(1)
      *        IF SCR-CCPP NOT = 'ING'
      *            MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR IN CM2-FLD
      *        ELSE
      *            NEXT SENTENCE
      *    ELSE
      *    IF WSS-COD-CORR = '02'
      *        MOVE TAB-GLS-DCOR TO FRM-GLS-TIDC IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(1)
      *    ELSE
      *    IF WSS-COD-CORR = '03'
      *        MOVE TAB-GLS-DCOR TO FRM-GLS-TOPE IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO FRM-CAI-IOPE-ATR IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO FRM-IIC-IOPE-ATR IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(2)
      *    ELSE
      *    IF WSS-COD-CORR = '04'
      *        MOVE TAB-GLS-DCOR TO FRM-GLS-TFEC IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO FRM-FEC-FENT-ATR IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(3)
      *    ELSE
      *    IF WSS-COD-CORR = '05'
      *        MOVE TAB-GLS-ABRV TO FRM-GLS-TNRO IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO FRM-NUM-IENT-ATR IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(4)
      *    ELSE
      *    IF WSS-COD-CORR = '06'
      *        MOVE TAB-GLS-DCOR TO FRM-GLS-TCOD IN CM2-FLD
      *        MOVE FRM-CPIM-UBY TO FRM-COD-IENT-ATR IN CM2-FLD
      *        MOVE WSS-NUM-NORD TO SCR-NUM-NORD(5).

           MOVE WSS-COD-CORR TO TIPO-LLAVE.
           IF NOT VALID-KEY
              GO TO NXT-BUS-FRM-NORD.

      *REVISA SI YA ESTA LA POSICION DEL ORDEN
           IF WSS-CHK-ORDN(WSS-NUM-NORD) = 'S'
              MOVE 'CM2 ERRORDEN'  TO WSS-COD-ERROR
              GO TO FIN-BUS-FRM-NORD.

           MOVE 'S' TO WSS-CHK-ORDN(WSS-NUM-NORD).

      *PARAMETRO OK, SE GUARDA EN MATRIZ
           ADD 1 TO WSS-NUM-Y.

           MOVE TIPO-LLAVE   TO WSS-NUM-TIPO-ALF(WSS-NUM-X,WSS-NUM-Y).
           MOVE TAB-GLS-DCOR TO WSS-GLS-DESC(WSS-NUM-X,WSS-NUM-Y).
           MOVE WSS-NUM-NORD TO WSS-NUM-ORDN(WSS-NUM-X,WSS-NUM-Y).

           MOVE 'S'          TO WSS-IND-FKEY.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
       NXT-BUS-FRM-NORD.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-FRM-NORD.

       FIN-BUS-FRM-NORD.
           EXIT.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *--------------------------------------------
      *--------------------------------------------
       BUS-TAB-FRM-ORDEN SECTION.
       INI-BUS-TAB-FRM-ORDEN.
           MOVE 'N' TO WSS-IND-FKEY.
           MOVE SPACES TO WSS-VEC-ORDN.

           IF RC2-COD-ENTI IN CM2-FLD NOT > SPACES
              GO TO FIN-BUS-TAB-FRM-ORDEN.

      *LEE TABLA FRM CON LOS 3 CODIGOS Y LOS GUARDA EN MATRIZ
           MOVE SPACES TO WSS-COD-CTAB.
           MOVE 'CMT'  TO WSS-COD-PREF.
           MOVE 1      TO WSS-NUM-X.
           PERFORM BUS-FRM-NORD.
           IF WSS-COD-ERROR > SPACES
              GO TO FIN-BUS-TAB-FRM-ORDEN.

           MOVE SPACES TO WSS-COD-CTAB.
           MOVE 'CM2'  TO WSS-COD-PREF.
           MOVE 2      TO WSS-NUM-X.
           PERFORM BUS-FRM-NORD.
           IF WSS-COD-ERROR > SPACES
              GO TO FIN-BUS-TAB-FRM-ORDEN.

           MOVE SPACES TO WSS-COD-CTAB.
           MOVE 'CM3'  TO WSS-COD-PREF.
           MOVE 3      TO WSS-NUM-X.
           PERFORM BUS-FRM-NORD.
           IF WSS-COD-ERROR > SPACES
              GO TO FIN-BUS-TAB-FRM-ORDEN.

           IF WSS-IND-FKEY NOT = 'S'
             GO TO FIN-BUS-TAB-FRM-ORDEN.

           PERFORM ORDENAR-LLAVES.

           PERFORM UNLOCK-KEYS VARYING WSS-NUM-X FROM 1 BY 1 UNTIL
                 WSS-NUM-X > 5.

       FIN-BUS-TAB-FRM-ORDEN.
           EXIT.
      *--------------------------------------------
      *--------------------------------------------
       ORDENAR-LLAVES SECTION.
       INI-ORDENAR-LLAVES.
           DISPLAY ' '.
           DISPLAY '== ORDENA LLAVES == '.

      *SE RECORRE MATRIZ PARA BUSCAR ORDEN, RESULTADO FINAL ES UN
      *VECTOR ORDENADO CON LOS 5 CAMPOS DE LLAVES (POSIBLES)

           MOVE ZEROES TO WSS-X.
           MOVE ZEROES TO WSS-Y.
           MOVE 1      TO WSS-POS-VEC.

       LUP-COLUMNA.

           ADD 1       TO WSS-X.
           MOVE ZEROES TO WSS-Y.

           IF WSS-POS-VEC > 5
              GO TO FIN-ORDENAR-LLAVES.

           IF WSS-X > 3
              MOVE ZEROES TO WSS-X
              MOVE ZEROES TO WSS-Y
              ADD 1       TO WSS-POS-VEC
              GO TO NXT-COLUMNA.

           DISPLAY 'BUSCA ORDEN NRO:' WSS-POS-VEC.

       LUP-FILA.

           ADD 1 TO WSS-Y.

           IF WSS-Y > 5
              GO TO NXT-COLUMNA.

           DISPLAY '(X,Y) - ('WSS-X','WSS-Y')'.

           IF WSS-NUM-TIPO-ALF(WSS-X,WSS-Y) NOT > SPACES
              DISPLAY ' VACIO'
              GO TO NXT-FILA.

           IF WSS-NUM-ORDN(WSS-X,WSS-Y) = WSS-POS-VEC
              MOVE WSS-NUM-TIPO(WSS-X,WSS-Y)
                                      TO SCR-NUM-NORD(WSS-POS-VEC)
              MOVE WSS-GLS-DESC(WSS-X,WSS-Y)
                                      TO SCR-GLS-DESC(WSS-POS-VEC)
              DISPLAY  '-----'
              DISPLAY  ' AGREGA A VECTOR:' SCR-NUM-NORD(WSS-POS-VEC)
              DISPLAY  '                :' SCR-GLS-DESC(WSS-POS-VEC)
              DISPLAY  '        POSICION:'WSS-POS-VEC
              DISPLAY  '-----'
              DISPLAY  ' '
              MOVE ZEROES TO WSS-X
              MOVE ZEROES TO WSS-Y
              ADD 1       TO WSS-POS-VEC
              GO TO NXT-COLUMNA.

       NXT-FILA.
           GO TO LUP-FILA.

       NXT-COLUMNA.
           GO TO LUP-COLUMNA.

       FIN-ORDENAR-LLAVES.
           EXIT.
      *--------------------------------------------
      *--------------------------------------------
       UNLOCK-KEYS SECTION.
       INI-UNLOCK-KEYS.
           DISPLAY ' '.
           DISPLAY '=== DESBLOQUEA LLAVES ==='.

      *SE REVISA VECTOR SCR-NUM-NORD-IDX DESPROTEGIENDO LLAVES
      *ENCONTRADAS
           DISPLAY ' - TIPO LLAVE:'SCR-NUM-NORD-ALF(WSS-NUM-X).

           IF SCR-NUM-NORD(WSS-NUM-X) NOT > ZEROES
              DISPLAY ' NO DESBLOQUEA'
              GO TO FIN-UNLOCK-KEYS.


           EVALUATE WSS-NUM-X
               WHEN 1
                    DISPLAY ' UNLOCK KEY 1'
                    MOVE SCR-GLS-DESC(WSS-NUM-X) TO
                                         FRM-GLS-KEY1 IN CM2-FLD
                    MOVE FRM-CPIM-UBY TO FRM-COD-KEY1-ATR IN CM2-FLD
               WHEN 2
                    DISPLAY ' UNLOCK KEY 2'
                    MOVE SCR-GLS-DESC(WSS-NUM-X) TO
                                         FRM-GLS-KEY2 IN CM2-FLD
                    MOVE FRM-CPIM-UBY TO FRM-COD-KEY2-ATR IN CM2-FLD
               WHEN 3
                    MOVE SCR-GLS-DESC(WSS-NUM-X) TO
                                         FRM-GLS-KEY3 IN CM2-FLD
                    DISPLAY ' UNLOCK KEY 3'
                    MOVE FRM-CPIM-UBY TO FRM-COD-KEY3-ATR IN CM2-FLD
               WHEN 4
                    DISPLAY ' UNLOCK KEY 4'
                    MOVE SCR-GLS-DESC(WSS-NUM-X) TO
                                         FRM-GLS-KEY4 IN CM2-FLD
                    MOVE FRM-CPIM-UBY TO FRM-COD-KEY4-ATR IN CM2-FLD
               WHEN 5
                    MOVE SCR-GLS-DESC(WSS-NUM-X) TO
                                         FRM-GLS-KEY5 IN CM2-FLD
                    DISPLAY ' UNLOCK KEY 5'
                    MOVE FRM-CPIM-UBY TO FRM-COD-KEY5-ATR IN CM2-FLD.

       FIN-UNLOCK-KEYS.
           EXIT.
      *--------------------------------------------
      *--------------------------------------------
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
       BUS-AUTC SECTION.
       INI-BUS-AUTC.
           IF CM2-COD-AUTC IN CM2-FLD > SPACES
               MOVE 'USR'        TO USR-COD-TTAB IN USR
               MOVE CM2-COD-AUTC IN CM2-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUTC IN CM2-FLD.
           IF USR-COD-UBIC IN USR > SPACES
               IF USR-IND-UBIC IN USR = 'O'
                   MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN CM2-FLD
               ELSE
                   MOVE 'UBI' TO TAB-COD-TTAB IN TAB
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE USR-COD-UBIC IN USR TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN CM2-FLD.
       FIN-BUS-AUTC.
           EXIT.
       CLR-KEY-KFRM SECTION.
       INI-CLR-KEY-KFRM.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    MOVE SPACES TO FRM-GLS-TNOM IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-TIDC IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-TOPE IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-TFEC IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-TNRO IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-TCOD IN CM2-FLD.
      *    MOVE SPACES TO DBC-GLS-NOMC IN CM2-FLD.
      *    MOVE ZEROES TO DBC-NUM-ICLI IN CM2-FLD.
      *    MOVE SPACES TO DBC-VRF-ICLI IN CM2-FLD.
      *    MOVE SPACES TO DBC-IND-ICLI IN CM2-FLD.
      *    MOVE SPACES TO DBC-GLS-ICLI IN CM2-FLD.
      *    MOVE SPACES TO FRM-CAI-IOPE IN CM2-FLD.
      *    MOVE ZEROES TO FRM-IIC-IOPE IN CM2-FLD.
      *    MOVE SPACES TO FRM-FEC-FENT IN CM2-FLD.
      *    MOVE ZEROES TO FRM-NUM-IENT IN CM2-FLD.
      *    MOVE SPACES TO FRM-COD-IENT IN CM2-FLD.
      *    MOVE SPACES TO FRM-GLS-IENT IN CM2-FLD.
      *    MOVE SPACES TO CM2-CIC-IENT IN CM2-FLD.
      *    MOVE SPACES TO CM2-FEC-FCMT IN CM2-FLD.
      *    MOVE ZEROES TO CM2-NUM-GCMT IN CM2-FLD.
      *    MOVE ZEROES TO CM2-NUM-CCMT IN CM2-FLD.

           MOVE SPACES TO FRM-GLS-KEY1 IN CM2-FLD.
           MOVE SPACES TO FRM-GLS-KEY2 IN CM2-FLD.
           MOVE SPACES TO FRM-GLS-KEY3 IN CM2-FLD.
           MOVE SPACES TO FRM-GLS-KEY4 IN CM2-FLD.
           MOVE SPACES TO FRM-GLS-KEY5 IN CM2-FLD.
           MOVE SPACES TO FRM-COD-KEY1 IN CM2-FLD.
           MOVE SPACES TO FRM-COD-KEY2 IN CM2-FLD.
           MOVE SPACES TO FRM-COD-KEY3 IN CM2-FLD.
           MOVE SPACES TO FRM-COD-KEY4 IN CM2-FLD.
           MOVE SPACES TO FRM-COD-KEY5 IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           MOVE 1 TO FRM-IFLD.
       LUP-CLR-KEY-KFRM.
           MOVE ZEROES TO SCR-NUM-NORD(FRM-IFLD).
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           MOVE SPACES TO SCR-GLS-DESC(FRM-IFLD).
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > WSS-NKEY
               GO TO LUP-CLR-KEY-KFRM.
       FIN-CLR-KEY-KFRM.
           EXIT.

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == EOF_BU
    == ========================================================================================== -->

  <section name="EOF_BU">

    <code><![CDATA[      *<<<< EOF_BU
      *LRH ini 17-JUN-1994
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *     IF DBC-VRF-ICLI IN CM2-FLD NOT > SPACES
      *        MOVE SPACES TO DBC-VRF-ICLI IN CM2-FLD.
      **VAL-RUT Valida Rut para campo IDC
      *     MOVE IDC-ZERO-S TO IDC-ZERO.
      *     MOVE DBC-NUM-ICLI IN CM2-FLD TO IDC-NUM-RUTV.
      *     MOVE DBC-VRF-ICLI IN CM2-FLD TO IDC-VRF-RUTV.
      **<<<< INI_DBC_VRF_ICLI
      *     IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
      *         GO TO FIN-VAL-DBC-VRF-ICLI.
      **>>>>
      *     PERFORM VAL-RUT.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
      *     IF DBC-IND-ICLI IN CM2-FLD NOT > SPACES
      *        MOVE SPACES TO DBC-IND-ICLI IN CM2-FLD.
      **<<<< INI_DBC_IND_ICLI
      *     IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
      *         GO TO FIN-VAL-DBC-IND-ICLI.
      **>>>>
      **VAL-IDC Valida identificador
      *     MOVE DBC-IND-ICLI IN CM2-FLD TO IDC-IND-RUTV.
      *     PERFORM VAL-IDC.
      *     MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       VAL-IKY-CM2 SECTION.
       INI-VAL-IKY-CM2.
           PERFORM VAL-RC2-COD-ENTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RC2-COD-ENTI-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-ENTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ENTI-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-KEY1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KEY1-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-COD-KEY1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-KEY1-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-KEY2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KEY2-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-COD-KEY2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-KEY2-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-KEY3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KEY3-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-COD-KEY3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-KEY3-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-KEY4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KEY4-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-COD-KEY4.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-KEY4-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-GLS-KEY5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-KEY5-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-FRM-COD-KEY5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-KEY5-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-CM2-CIC-IENT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CM2-CIC-IENT-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-CM2-FEC-FCMT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CM2-FEC-FCMT-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
           PERFORM VAL-CM2-NUM-CCMT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CM2-NUM-CCMT-LEN IN CM2-FLD
                GO TO FIN-VAL-IKY-CM2.
       FIN-VAL-IKY-CM2.
           EXIT.


       VAL-FRM-GLS-ENTI SECTION.
       INI-VAL-FRM-GLS-ENTI.
       FIN-VAL-FRM-GLS-ENTI.
           EXIT.


       VAL-CM2-CIC-IENT SECTION.
       INI-VAL-CM2-CIC-IENT.
       FIN-VAL-CM2-CIC-IENT.
           EXIT.

       VAL-FRM-GLS-KEY1 SECTION.
       INI-VAL-FRM-GLS-KEY1.
       FIN-VAL-FRM-GLS-KEY1.
           EXIT.

       VAL-FRM-COD-KEY1 SECTION.
       INI-VAL-FRM-COD-KEY1.
           IF FRM-COD-KEY1 IN CM2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-KEY1 IN CM2-FLD.
       FIN-VAL-FRM-COD-KEY1.
           EXIT.

       VAL-FRM-GLS-KEY2 SECTION.
       INI-VAL-FRM-GLS-KEY2.
       FIN-VAL-FRM-GLS-KEY2.
           EXIT.

       VAL-FRM-COD-KEY2 SECTION.
       INI-VAL-FRM-COD-KEY2.
           IF FRM-COD-KEY2 IN CM2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-KEY2 IN CM2-FLD.
       FIN-VAL-FRM-COD-KEY2.
           EXIT.

       VAL-FRM-GLS-KEY3 SECTION.
       INI-VAL-FRM-GLS-KEY3.
       FIN-VAL-FRM-GLS-KEY3.
           EXIT.

       VAL-FRM-COD-KEY3 SECTION.
       INI-VAL-FRM-COD-KEY3.
           IF FRM-COD-KEY3 IN CM2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-KEY3 IN CM2-FLD.
       FIN-VAL-FRM-COD-KEY3.
           EXIT.

       VAL-FRM-GLS-KEY4 SECTION.
       INI-VAL-FRM-GLS-KEY4.
       FIN-VAL-FRM-GLS-KEY4.
           EXIT.

       VAL-FRM-COD-KEY4 SECTION.
       INI-VAL-FRM-COD-KEY4.
           IF FRM-COD-KEY4 IN CM2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-KEY4 IN CM2-FLD.
       FIN-VAL-FRM-COD-KEY4.
           EXIT.

       VAL-FRM-GLS-KEY5 SECTION.
       INI-VAL-FRM-GLS-KEY5.
       FIN-VAL-FRM-GLS-KEY5.
           EXIT.

       VAL-FRM-COD-KEY5 SECTION.
       INI-VAL-FRM-COD-KEY5.
           IF FRM-COD-KEY5 IN CM2-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-KEY5 IN CM2-FLD.
       FIN-VAL-FRM-COD-KEY5.
           EXIT.

       VAL-CM2-FEC-FCMT SECTION.
       INI-VAL-CM2-FEC-FCMT.
      *VAL-FEC Validar Fecha
           MOVE CM2-FEC-FCMT IN CM2-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CM2-FEC-FCMT IN CM2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CM2-FEC-FCMT.
      *<<<< CM2_FEC_FCMT
           IF SCR-CCPP = 'ING' AND
              CM2-FEC-FCMT IN CM2-FLD NOT > ZEROES
               PERFORM GET-FHOY
               MOVE HOY-DHOY IN HOY-VARI TO CM2-NUM-DCMT IN CM2-FLD
               MOVE HOY-MHOY IN HOY-VARI TO CM2-NUM-MCMT IN CM2-FLD
               MOVE HOY-SHOY IN HOY-VARI TO CM2-NUM-SCMT IN CM2-FLD
               MOVE HOY-AHOY IN HOY-VARI TO CM2-NUM-ACMT IN CM2-FLD.
      *>>>>
       FIN-VAL-CM2-FEC-FCMT.
           EXIT.

       VAL-CM2-NUM-CCMT SECTION.
       INI-VAL-CM2-NUM-CCMT.
       FIN-VAL-CM2-NUM-CCMT.
           EXIT.
      *LRH fin 17-JUN-1994
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_KEY_CM2_CM2
    == ========================================================================================== -->

  <section name="FIN_KEY_CM2_CM2">

    <code><![CDATA[      *<<<< FIN_KEY_CM2_CM2
           MOVE 1 TO CM2-NUM-CCMT IN CM2.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PRO_IKY_CM2
    == ========================================================================================== -->

  <section name="FIN_PRO_IKY_CM2">

    <code><![CDATA[   *<<<<FIN_PRO_IKY_CM2
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    MOVE FRM-CPIM-AEY TO FRM-CAI-IOPE-ATR IN CM2-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-IIC-IOPE-ATR IN CM2-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-FEC-FENT-ATR IN CM2-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-NUM-IENT-ATR IN CM2-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-COD-IENT-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN CM2-FLD.

           MOVE FRM-CPIM-AEY TO FRM-COD-KEY1-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-KEY2-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-KEY3-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-KEY4-ATR IN CM2-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-KEY5-ATR IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
   *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_CM2_CM2
    == ========================================================================================== -->

  <section name="FIN_PUT_CM2_CM2">

    <code><![CDATA[      *<<<< FIN_PUT_CM2_CM2
      *BUS-USR busca usuario en tablas
           PERFORM BUS-AUTC.

           IF CM2-COD-TCOM IN CM2 > SPACES
              MOVE 'GNS' TO TAB-COD-SIST
              MOVE 'TCO' TO TAB-COD-TTAB IN TAB
              MOVE CM2-COD-TCOM IN CM2-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCOM IN CM2-FLD.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF CM2-COD-OTRN IN CM2 > SPACES
              MOVE 'GNS' TO TAB-COD-SIST
              MOVE 'CNL' TO TAB-COD-TTAB IN TAB
              MOVE CM2-COD-OTRN IN CM2-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-OTRN IN CM2-FLD.


           IF CM2-MSC-STAT IN CM2 > SPACES
              MOVE 'GNS' TO TAB-COD-SIST
              MOVE 'EST' TO TAB-COD-TTAB IN TAB
              MOVE CM2-MSC-STAT IN CM2-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-STAT IN CM2-FLD.


           IF CM2-GLS-DISP IN CM2 > SPACES
              MOVE 'GNS' TO TAB-COD-SIST
              MOVE 'EST' TO TAB-COD-TTAB IN TAB
              MOVE CM2-GLS-DISP IN CM2-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DISP IN CM2-FLD.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_DBC_CM2
    == ========================================================================================== -->

  <section name="FIN_PUT_DBC_CM2">

    <code><![CDATA[      *<<<< FIN_PUT_DBC_CM2
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CM2-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_RC2_CM2
    == ========================================================================================== -->

  <section name="FIN_PUT_RC2_CM2">

    <code><![CDATA[      *<<<< FIN_PUT_RC2_CM2
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE RC2-COD-SIST IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SIST IN CM2-FLD.

           IF RC2-COD-SIST IN CM2-FLD > SPACES
              MOVE RC2-COD-SIST IN RC2 TO TAB-COD-SIST
           ELSE
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO TAB-COD-SIST
           ELSE
               MOVE SCR-SISG TO TAB-COD-SIST.
      *BUS-TAB busca glosa de codigo en tabla
           IF RC2-COD-ENTI IN CM2-FLD > SPACES
               MOVE 'ENT' TO TAB-COD-TTAB IN TAB
               MOVE RC2-COD-ENTI IN CM2-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN CM2-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_RET_ALL_CM2
    == ========================================================================================== -->

  <section name="FIN_RET_ALL_CM2">

    <code><![CDATA[      *<<<< FIN_RET_ALL_CM2
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO CM2-MSC-TACC IN CM2
               MOVE 'I' TO CM2-MSC-STAT IN CM2
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO CM2-MSC-TACC IN CM2
               MOVE 'M' TO CM2-MSC-STAT IN CM2.

           IF CM2-MSC-STAT IN CM2-FLD > SPACES
              MOVE CM2-MSC-STAT IN CM2-FLD TO CM2-MSC-STAT IN CM2.

           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO CM2-FEC-FTRN IN CM2.
      *    Hora Transaccion
           MOVE HOY-HHOY TO CM2-HRA-HRTR IN CM2.

      *    Autor Transaccion
           MOVE SCR-USER TO CM2-COD-ATRN IN CM2.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_COD_KEY1
    == ========================================================================================== -->

  <section name="FRM_COD_KEY1">

    <code><![CDATA[      *<<<< FRM_COD_KEY1
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY1 IN CM2-FLD > SPACES
              IF FRM-COD-KEY1 NOT > SPACES
              MOVE 'GNS' TO MSG-COD-SIST
              MOVE 'GLS    BLK' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY1.

           MOVE SPACES          TO WSS-GLS-LLAVE.
           MOVE SCR-NUM-NORD(1) TO WSS-NUM-LLAVE
           MOVE FRM-COD-KEY1    TO WSS-GLS-LLAVE.
           MOVE 1               TO WSS-POS-VEC.

           PERFORM VALIDA-FORMATO-LLAVE.

           IF FEC-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-KEY1.

           IF WSS-COD-ERROR > SPACES
              MOVE WSS-SIS-ERROR TO MSG-COD-SIST
              MOVE WSS-COD-ERROR TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY1.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_COD_KEY2
    == ========================================================================================== -->

  <section name="FRM_COD_KEY2">

    <code><![CDATA[      *<<<< FRM_COD_KEY2
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY2 IN CM2-FLD > SPACES
              IF FRM-COD-KEY2 NOT > SPACES
              MOVE 'GNS' TO MSG-COD-SIST
              MOVE 'GLS    BLK' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY2.

           MOVE SPACES          TO WSS-GLS-LLAVE.
           MOVE SCR-NUM-NORD(2) TO WSS-NUM-LLAVE
           MOVE FRM-COD-KEY2    TO WSS-GLS-LLAVE.
           MOVE 2               TO WSS-POS-VEC.

           PERFORM VALIDA-FORMATO-LLAVE.

           IF FEC-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-KEY2.

           IF WSS-COD-ERROR > SPACES
              MOVE WSS-SIS-ERROR TO MSG-COD-SIST
              MOVE WSS-COD-ERROR TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY2.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_COD_KEY3
    == ========================================================================================== -->

  <section name="FRM_COD_KEY3">

    <code><![CDATA[      *<<<< FRM_COD_KEY3
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY3 IN CM2-FLD > SPACES
              IF FRM-COD-KEY3 NOT > SPACES
              MOVE 'GNS' TO MSG-COD-SIST
              MOVE 'GLS    BLK' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY3.

           MOVE SPACES          TO WSS-GLS-LLAVE.
           MOVE SCR-NUM-NORD(3) TO WSS-NUM-LLAVE
           MOVE FRM-COD-KEY3    TO WSS-GLS-LLAVE.
           MOVE 3               TO WSS-POS-VEC.

           PERFORM VALIDA-FORMATO-LLAVE.

           IF FEC-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-KEY3.

           IF WSS-COD-ERROR > SPACES
              MOVE WSS-SIS-ERROR TO MSG-COD-SIST
              MOVE WSS-COD-ERROR TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY3.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_COD_KEY4
    == ========================================================================================== -->

  <section name="FRM_COD_KEY4">

    <code><![CDATA[      *<<<< FRM_COD_KEY4
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY4 IN CM2-FLD > SPACES
              IF FRM-COD-KEY4 NOT > SPACES
              MOVE 'GNS' TO MSG-COD-SIST
              MOVE 'GLS    BLK' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY4.

           MOVE SPACES          TO WSS-GLS-LLAVE.
           MOVE SCR-NUM-NORD(4) TO WSS-NUM-LLAVE
           MOVE FRM-COD-KEY4    TO WSS-GLS-LLAVE.
           MOVE 4               TO WSS-POS-VEC.

           PERFORM VALIDA-FORMATO-LLAVE.

           IF FEC-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-KEY4.

           IF WSS-COD-ERROR > SPACES
              MOVE WSS-SIS-ERROR TO MSG-COD-SIST
              MOVE WSS-COD-ERROR TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY4.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FRM_COD_KEY5
    == ========================================================================================== -->

  <section name="FRM_COD_KEY5">

    <code><![CDATA[      *<<<< FRM_COD_KEY5
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY5 IN CM2-FLD > SPACES
              IF FRM-COD-KEY5 NOT > SPACES
              MOVE 'GNS' TO MSG-COD-SIST
              MOVE 'GLS    BLK' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY5.

           MOVE SPACES          TO WSS-GLS-LLAVE.
           MOVE SCR-NUM-NORD(5) TO WSS-NUM-LLAVE
           MOVE FRM-COD-KEY5    TO WSS-GLS-LLAVE.
           MOVE 5               TO WSS-POS-VEC.

           PERFORM VALIDA-FORMATO-LLAVE.

           IF FEC-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-KEY5.

           IF WSS-COD-ERROR > SPACES
              MOVE WSS-SIS-ERROR TO MSG-COD-SIST
              MOVE WSS-COD-ERROR TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-KEY5.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_CM2_FEC_FCMT
    == ========================================================================================== -->

  <section name="INI_CM2_FEC_FCMT">

    <code><![CDATA[      *<<<< INI_CM2_FEC_FCMT
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_DBC_GLS_ICLI
    == ========================================================================================== -->

  <section name="INI_DBC_GLS_ICLI">

    <code><![CDATA[   *<<<<INI_DBC_GLS_ICLI
           IF DBC-GLS-ICLI IN CM2-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN CM2-FLD.
      *<<<< INI_DBC_GLS_ICLI
           IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-GLS-ICLI.
      *>>>>
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN CM2-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN CM2-FLD.
        GO TO FIN-VAL-DBC-GLS-ICLI.
   *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_DBC_IND_ICLI
    == ========================================================================================== -->

  <section name="INI_DBC_IND_ICLI">

    <code><![CDATA[   *<<<<INI_VAL_DBC_IND_ICLI
           IF DBC-IND-ICLI IN CM2-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN CM2-FLD.
      *<<<< INI_DBC_IND_ICLI
           IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-IND-ICLI.
      *>>>>
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN CM2-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN CM2-FLD.
           GO TO FIN-VAL-DBC-IND-ICLI.
   *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_DBC_VRF_ICLI
    == ========================================================================================== -->

  <section name="INI_DBC_VRF_ICLI">

    <code><![CDATA[    *<<<<INI_DBC_VRF_ICLI
           IF DBC-VRF-ICLI IN CM2-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN CM2-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN CM2-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN CM2-FLD TO IDC-VRF-RUTV.
      *<<<< INI_DBC_VRF_ICLI
           IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
           PERFORM VAL-RUT.
           GO TO FIN-VAL-DBC-VRF-ICLI.
    *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_KEY_RC2_CM2
    == ========================================================================================== -->

  <section name="INI_KEY_RC2_CM2">

    <code><![CDATA[      *<<<< INI_KEY_RC2_CM2
           MOVE SPACES TO RC2-COD-SENT IN RC2.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_VAL_CON_IKY_CM2
    == ========================================================================================== -->

  <section name="INI_VAL_CON_IKY_CM2">

    <code><![CDATA[      *<<<< INI_VAL_CON_IKY_CM2
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-IKY-CM2.
           IF NOT ( SCR-IINS = WSS-YA-BUSQUE-GLOSAS )
               GO TO FIN-VAL-CON-IKY-CM2.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    IF FRM-GLS-TIDC IN CM2-FLD > SPACES
      *        IF DBC-NUM-ICLI IN CM2-FLD = ZEROES
      *            GO TO ERR-VAL-CON-IKY-CM2.
      *    IF FRM-GLS-TOPE IN CM2-FLD > SPACES
      *        IF FRM-IIC-IOPE IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-IKY-CM2.
      *    IF FRM-GLS-TFEC IN CM2-FLD > SPACES
      *        IF FRM-FEC-FENT IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-IKY-CM2.
      *    IF FRM-GLS-TNRO IN CM2-FLD > SPACES
      *        IF FRM-NUM-IENT IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-IKY-CM2.
      *    IF FRM-GLS-TCOD IN CM2-FLD > SPACES
      *        IF FRM-COD-IENT IN CM2-FLD NOT > SPACES
      *            GO TO ERR-VAL-CON-IKY-CM2.
      *     IF CM2-FEC-FCMT IN CM2-FLD NOT > ZEROES
      *         GO TO ERR-VAL-CON-IKY-CM2.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           GO TO FIN-VAL-CON-IKY-CM2.
       ERR-VAL-CON-IKY-CM2.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'VALCONKEY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-IKY-CM2.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_VAL_CON_KEY_CM2
    == ========================================================================================== -->

  <section name="INI_VAL_CON_KEY_CM2">

    <code><![CDATA[      *<<<< INI_VAL_CON_KEY_CM2
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               IF SCR-IINS = WSS-YA-BUSQUE-GLOSAS AND
                  SCR-NUM-NORD(1) NOT = 1
                   MOVE 'GNS'    TO MSG-COD-SIST
                   MOVE 'PFSINV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-KEY-CM2
               ELSE
                   GO TO FIN-VAL-CON-KEY-CM2.
           IF NOT ( SCR-IINS = WSS-YA-BUSQUE-GLOSAS )
               GO TO FIN-VAL-CON-KEY-CM2.

      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-GLS-KEY1 IN CM2-FLD > SPACES
              IF FRM-COD-KEY1 NOT > SPACES
                 GO TO ERR-VAL-CON-KEY-CM2.
           IF FRM-GLS-KEY2 IN CM2-FLD > SPACES
              IF FRM-COD-KEY2 NOT > SPACES
                 GO TO ERR-VAL-CON-KEY-CM2.
           IF FRM-GLS-KEY3 IN CM2-FLD > SPACES
              IF FRM-COD-KEY3 NOT > SPACES
                 GO TO ERR-VAL-CON-KEY-CM2.
           IF FRM-GLS-KEY4 IN CM2-FLD > SPACES
              IF FRM-COD-KEY4 NOT > SPACES
                 GO TO ERR-VAL-CON-KEY-CM2.
           IF FRM-GLS-KEY5 IN CM2-FLD > SPACES
              IF FRM-COD-KEY5 NOT > SPACES
                 GO TO ERR-VAL-CON-KEY-CM2.

      *    IF FRM-GLS-TNOM IN CM2-FLD > SPACES
      *        IF DBC-GLS-NOMC IN CM2-FLD NOT > SPACES AND
      *           DBC-NUM-ICLI IN CM2-FLD =     ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF FRM-GLS-TIDC IN CM2-FLD > SPACES
      *        IF DBC-GLS-NOMC IN CM2-FLD NOT > SPACES AND
      *           DBC-NUM-ICLI IN CM2-FLD =     ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF FRM-GLS-TOPE IN CM2-FLD > SPACES
      *        IF FRM-IIC-IOPE IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF FRM-GLS-TFEC IN CM2-FLD > SPACES
      *        IF FRM-FEC-FENT IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF FRM-GLS-TNRO IN CM2-FLD > SPACES
      *        IF FRM-NUM-IENT IN CM2-FLD NOT > ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF FRM-GLS-TCOD IN CM2-FLD > SPACES
      *        IF FRM-COD-IENT IN CM2-FLD NOT > SPACES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *    IF CM2-FEC-FCMT IN CM2-FLD NOT > ZEROES
      *        IF CM2-NUM-GCMT IN CM2-FLD > ZEROES
      *            GO TO ERR-VAL-CON-KEY-CM2.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           GO TO FIN-VAL-CON-KEY-CM2.
       ERR-VAL-CON-KEY-CM2.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'VALCONKEY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-KEY-CM2.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BQ
    == ========================================================================================== -->

  <section name="PGM_BQ">

    <code><![CDATA[    *<<<<INI_DBC_VRF_ICLI
           IF DBC-VRF-ICLI IN CM2-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN CM2-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN CM2-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN CM2-FLD TO IDC-VRF-RUTV.
      *<<<< INI_DBC_VRF_ICLI
           IF FRM-GLS-TIDC IN CM2-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
           PERFORM VAL-RUT.
           GO TO FIN-VAL-DBC-VRF-ICLI.
    *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == RC2_COD_ENTI
    == ========================================================================================== -->

  <section name="RC2_COD_ENTI">

    <code><![CDATA[      *<<<< RC2_COD_ENTI
           IF (FRM-NUM-ICLI IN CM2-FLD > ZEROES OR
               FRM-VRF-ICLI IN CM2-FLD > SPACES OR
               FRM-IND-ICLI IN CM2-FLD > SPACES OR
               FRM-GLS-ICLI IN CM2-FLD > SPACES OR
               RC2-CAI-IEN2 IN CM2-FLD > SPACES OR
               RC2-IIC-IEN2 IN CM2-FLD > SPACES ) AND
               RC2-COD-ENTI IN CM2-FLD NOT > SPACES
              GO TO FIN-VAL-RC2-COD-ENTI.
           IF RC2-COD-ENTI IN CM2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RC2-COD-ENTI.

           IF SCR-IINS = WSS-YA-BUSQUE-GLOSAS
               GO TO FIN-VAL-RC2-COD-ENTI.
           MOVE RC2-COD-SIST IN CM2-FLD TO TAB-COD-SIST.
           IF RC2-COD-ENTI IN CM2-FLD > SPACES
               GO TO CON-VAL-RC2-COD-ENTI.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 )
               PERFORM ERR-GLS
               GO TO FIN-VAL-RC2-COD-ENTI.
           MOVE 'ENT'  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAB-COD-SIST TO FIO-SIST.
           MOVE FIO-GET-NLS  TO FIO-CMND.
       LUP-VAL-RC2-COD-ENTI.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'ENT'
               IF TAB-COD-CTAB IN TAB > SPACES AND
                  TAB-MSC-STAT IN TAB NOT = 'N'
                   MOVE TAB-COD-CTAB IN TAB TO RC2-COD-ENTI IN CM2-FLD
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN CM2-FLD
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *            PERFORM BUS-FRM-NORD
                   DISPLAY '=== VAL-RC2-COD-ENTI ==='
                   PERFORM BUS-TAB-FRM-ORDEN
      *            PERFORM BUS-KEY-QUE
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
                   GO TO FIN-VAL-RC2-COD-ENTI
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-VAL-RC2-COD-ENTI
           ELSE
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CODCTABNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RC2-COD-ENTI.
       CON-VAL-RC2-COD-ENTI.
      *    Valida codigo de tabla
           MOVE 'ENT' TO TAB-COD-TTAB IN TAB.
           MOVE RC2-COD-ENTI IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              RC2-COD-ENTI IN CM2-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ENTI IN CM2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ENTI IN CM2-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-RC2-COD-ENTI.
           PERFORM CLR-KEY-KFRM.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    PERFORM BUS-FRM-NORD.
           DISPLAY '=== VAL-RC2-COD-ENTI 2==='
           PERFORM BUS-TAB-FRM-ORDEN.
           IF WSS-COD-ERROR > SPACES
               MOVE 'GNS'         TO MSG-COD-SIST
               MOVE WSS-COD-ERROR TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RC2-COD-ENTI.

      *    PERFORM BUS-KEY-QUE.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-RC2-COD-ENTI.
           MOVE FRM-CPIM-AEY TO RC2-COD-ENTI-ATR IN CM2-FLD.
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-UBY TO CM2-FEC-FCMT-ATR IN CM2-FLD
           ELSE
               MOVE FRM-CPIM-UBY TO CM2-FEC-FCMT-ATR IN CM2-FLD
               MOVE FRM-CPIM-UBY TO CM2-NUM-GCMT-ATR IN CM2-FLD.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'GKY    KEYS+' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE WSS-YA-BUSQUE-GLOSAS TO SCR-IINS.

      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == RC2_COD_SIST
    == ========================================================================================== -->

  <section name="RC2_COD_SIST">

    <code><![CDATA[
           IF RC2-COD-SIST IN CM2-FLD NOT > SPACES AND
              (FRM-NUM-ICLI IN CM2-FLD > ZEROES OR
               FRM-VRF-ICLI IN CM2-FLD > SPACES OR
               FRM-IND-ICLI IN CM2-FLD > SPACES OR
               FRM-GLS-ICLI IN CM2-FLD > SPACES OR
               RC2-CAI-IEN2 IN CM2-FLD > SPACES OR
               RC2-IIC-IEN2 IN CM2-FLD > SPACES )
               GO TO FIN-VAL-RC2-COD-SIST.
           IF RC2-COD-SIST IN CM2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RC2-COD-SIST.

           IF RC2-COD-SIST IN CM2-FLD NOT > SPACES
              IF SCR-SISG NOT > SPACES
                 MOVE SCR-SIST TO RC2-COD-SIST IN CM2-FLD
              ELSE
                 MOVE SCR-SISG TO RC2-COD-SIST IN CM2-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE RC2-COD-SIST IN CM2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DESC TO FRM-GLS-SIST IN CM2-FLD.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == VAL_CON_FLD_CM2
    == ========================================================================================== -->

  <section name="VAL_CON_FLD_CM2">

    <code><![CDATA[      *<<<< VAL_CON_FLD_CM2
      *LRH ini 17-JUN-1994
           IF SCR-CMND NOT = 'COP'
               GO TO FIN-VAL-CON-FLD-CM2.

           PERFORM VAL-IKY-CM2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR OR
              MSG-COD-MENS > SPACES
               GO TO FIN-VAL-CON-FLD-CM2.

      * se hace lo mismo que en FND-KEY
      * se asegura que i) si CM2-CIC-IENT existe se suma 1 al CRR
      * ii) si CM2-CIC-IENT no existe, se asegurar que se otorgue
      *     en CMN-ING con CRR 1
      *
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
      *OGB-INI OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
      *    MOVE CPT-STRN TO DBC-GLS-NOMC IN CM2-FLD.

           PERFORM KEY-RC2-CM2.
      *    PERFORM STR-KEYS.
           PERFORM PRO-KEYS.
           MOVE WSS-GLS-IENT TO RC2-GLS-IENT IN RC2.
      *OGB-FIN OCT-2020 MOD FUNCIONALIDAD COMENTARIOS
           MOVE 'RC2-KEY-IENT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-RC2.
           MOVE FIO-STAT TO PGM-STAT-RC2.
           IF FIO-STAT-OKS
               MOVE 'N' TO SCR-IRC2
               MOVE RC2-CIC-IENT IN RC2 TO CM2-CIC-IENT IN CM2-FLD
               PERFORM BUS-COR-CM2
               PERFORM KEY-ALL-CM2
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-CM2
               MOVE FIO-STAT TO PGM-STAT-CM2
               IF FIO-STAT-OKS
                   MOVE '99' TO CM2-NUM-ICMT IN CM2
                   MOVE FIO-GET-LEQ TO FIO-CMND
                   PERFORM GNS-FIO-CM2
                   MOVE FIO-STAT TO PGM-STAT-CM2
                   IF FIO-STAT-OKS
                       ADD 1 TO CM2-NUM-GCMT IN CM2-FLD
                       GO TO FIN-VAL-CON-FLD-CM2
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 1   TO CM2-NUM-GCMT IN CM2-FLD
                   MOVE 1   TO CM2-NUM-CCMT IN CM2-FLD
                   GO TO FIN-VAL-CON-FLD-CM2
           ELSE
               MOVE 'N' TO SCR-IRC2
               GO TO FIN-VAL-CON-FLD-CM2.
      *LRH fin 17-JUN-1994
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    ==
    == ========================================================================================== -->

</additional>
