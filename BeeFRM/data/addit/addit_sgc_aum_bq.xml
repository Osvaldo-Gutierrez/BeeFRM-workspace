<?xml version = "1.0" encoding = "ISO-8859-1" ?>

<additional xmlns        = "http://cl/bee/genfrmjava/adddef/schema"
      xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation = "http://cl/bee/genfrmjava/adddef/schema adddef.xsd"
      system             = "SGC"
      form               = "AUM">

  <!-- ========================================================================================== ==
    == DBC_GLS_ICLI
    == ========================================================================================== -->

  <section name="DBC_GLS_ICLI">

    <code><![CDATA[      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN AUM-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN AUM-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN AUM-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN AUM-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN AUM-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-GLS-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN AUM-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI
                   MOVE DBC-COD-EJEC IN DBC TO DBC-COD-EJEC IN AUM-FLD
                   MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN AUM-FLD
                   MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR
                   PERFORM BUS-USR
                   MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN AUM-FLD
                   MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN AUM-FLD
                   PERFORM BUS-BAN.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == EOF_BQ
    == ========================================================================================== -->

  <section name="EOF_BQ">

    <code><![CDATA[      *<<<< EOF_BQ

       BUS-BAN SECTION.
       INI-BUS-BAN.
           MOVE SPACES TO FRM-COD-TBAN IN AUM-FLD.
           MOVE SPACES TO FRM-GLS-TBAN IN AUM-FLD.
           MOVE SPACES TO FRM-COD-TPLN IN AUM-FLD.
           MOVE SPACES TO FRM-GLS-TPLN IN AUM-FLD.

           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-CAI-ICLI IN DBC TO DCP-CAI-ICLI IN DCP
               MOVE DBC-IIC-ICLI IN DBC TO DCP-IIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF FIO-STAT-OKS
                  MOVE DCP-COD-TBAN IN DCP TO FRM-COD-TBAN IN AUM-FLD
                  MOVE DCP-COD-TPLN IN DCP TO FRM-COD-TPLN IN AUM-FLD.

           IF DBC-IND-TICL IN DBC = 'E'
               MOVE DBC-CAI-ICLI IN DBC TO DCE-CAI-ICLI IN DCE
               MOVE DBC-IIC-ICLI IN DBC TO DCE-IIC-ICLI IN DCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF FIO-STAT-OKS
                  MOVE DCE-COD-TBAN IN DCE TO FRM-COD-TBAN IN AUM-FLD
                  MOVE DCE-COD-TPLN IN DCE TO FRM-COD-TPLN IN AUM-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'SGC'                   TO TAB-COD-SIST.
           MOVE 'BAN '                  TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TBAN IN AUM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-TBAN IN AUM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TBAN IN AUM-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TBAN IN AUM-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'PLN '                  TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TPLN IN AUM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-TPLN IN AUM-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TPLN IN AUM-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TPLN IN AUM-FLD.
       FIN-BUS-BAN.
           EXIT.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_FRM_COD_MOVI
    == ========================================================================================== -->

  <section name="FIN_FRM_COD_MOVI">

    <code><![CDATA[           MOVE TAB-GLS-DAT1 IN TAB(1:3) TO WSS-COD-TCAM.
           MOVE WSS-COD-TCAM IN MOV-OUT TO WSS-COD-CAMB.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_FST_FLD_AUM
    == ========================================================================================== -->

  <section name="FIN_FST_FLD_AUM">

    <code><![CDATA[
           IF  WSS-IND-VEJE  = 'S'
                MOVE -1 TO FRM-COD-EJED-LEN IN AUM-FLD
                GO TO FIN-FST-FLD-AUM.

           IF  WSS-IND-VBAN  = 'S'
                MOVE 0  TO FRM-COD-EJED-LEN IN AUM-FLD
                MOVE -1 TO FRM-COD-TBAD-LEN IN AUM-FLD
                GO TO FIN-FST-FLD-AUM.

           IF  WSS-IND-VOFI  = 'S'
                MOVE 0  TO FRM-COD-EJED-LEN IN AUM-FLD
                MOVE -1 TO FRM-COD-OFID-LEN IN AUM-FLD
                GO TO FIN-FST-FLD-AUM.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PRO_IKY_AUM
    == ========================================================================================== -->

  <section name="FIN_PRO_IKY_AUM">

    <code><![CDATA[           MOVE FRM-CPIM-AEY TO FRM-COD-MOVI-ATR IN AUM-FLD.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_DBC_AUM
    == ========================================================================================== -->

  <section name="FIN_PUT_DBC_AUM">

    <code><![CDATA[      *<<<< FIN_PUT_DBC_AUM
           PERFORM BUS-BAN.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_PUT_DBC_AUM$1
    == ========================================================================================== -->

  <section name="FIN_PUT_DBC_AUM$1">

    <code><![CDATA[      *<<<< FIN_PUT_DBC_AUM
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
           PERFORM CPT-BLKS
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN AUM-FLD.
      *>>>>
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == FIN_UNP_FLD_AUM
    == ========================================================================================== -->

  <section name="FIN_UNP_FLD_AUM">

    <code><![CDATA[
           MOVE FRM-CPIM-AEY TO FRM-COD-EJED-ATR IN AUM-FLD.

           MOVE FRM-CPIM-AEY TO FRM-COD-EJED-ATR IN AUM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-OFID-ATR IN AUM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-TBAD-ATR IN AUM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-TPLD-ATR IN AUM-FLD.
           IF  WSS-IND-VEJE  = 'S'
                MOVE FRM-CPIM-UBY TO FRM-COD-EJED-ATR IN AUM-FLD.

           IF  WSS-IND-VBAN  = 'S'
                MOVE FRM-CPIM-UBY TO FRM-COD-TBAD-ATR IN AUM-FLD
                MOVE FRM-CPIM-UBY TO FRM-COD-TPLD-ATR IN AUM-FLD.

           IF  WSS-IND-VOFI  = 'S'
                MOVE FRM-CPIM-UBY TO FRM-COD-OFID-ATR IN AUM-FLD.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == INI_FRM_COD_MOVI
    == ========================================================================================== -->

  <section name="INI_FRM_COD_MOVI">

    <code><![CDATA[           IF SCR-CMND = 'CON'
               MOVE SPACES TO FRM-COD-MOVI IN AUM-FLD
               GO TO FIN-VAL-FRM-COD-MOVI.

           IF SCR-CMND = 'VRF' OR 'ACT'
              IF FRM-COD-MOVI IN AUM-FLD NOT > SPACES
                  PERFORM ERR-GLS
                  GO TO FIN-VAL-FRM-COD-MOVI.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU
    == ========================================================================================== -->

  <section name="PGM_BU">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND FRM_COD_EJED
    == ========================================================================================== -->

  <section name="PGM_BU AND FRM_COD_EJED" concatenate="1">

    <code><![CDATA[
           IF WSS-IND-VEJE NOT = 'S'
               GO TO FIN-VAL-FRM-COD-EJED.

           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VEJE = 'S'
               IF FRM-COD-EJED IN AUM-FLD NOT > SPACES
                   PERFORM ERR-GLS.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND FRM_COD_OFID
    == ========================================================================================== -->

  <section name="PGM_BU AND FRM_COD_OFID" concatenate="1">

    <code><![CDATA[
           IF WSS-IND-VOFI NOT = 'S'
               GO TO FIN-VAL-FRM-COD-OFID.

           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VOFI = 'S'
               IF FRM-COD-OFID IN AUM-FLD NOT > SPACES
                   PERFORM ERR-GLS.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND FRM_COD_TBAD
    == ========================================================================================== -->

  <section name="PGM_BU AND FRM_COD_TBAD" concatenate="1">

    <code><![CDATA[           IF WSS-IND-VBAN NOT = 'S'
               GO TO FIN-VAL-FRM-COD-TBAD.

           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VBAN = 'S'
              IF FRM-COD-TBAD IN AUM-FLD NOT > SPACES
                  PERFORM ERR-GLS.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND INI_FRM_COD_TPLD
    == ========================================================================================== -->

  <section name="PGM_BU AND INI_FRM_COD_TPLD" concatenate="1">

    <code><![CDATA[           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VBAN = 'S'
               IF FRM-COD-TPLD IN AUM-FLD NOT > SPACES
                   PERFORM ERR-GLS.

           IF WSS-IND-VBAN NOT = 'S'
               GO TO FIN-VAL-FRM-COD-TPLD.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND INI_FRM_GLS_EJED
    == ========================================================================================== -->

  <section name="PGM_BU AND INI_FRM_GLS_EJED" concatenate="1">

    <code><![CDATA[           IF WSS-IND-VEJE NOT = 'S'
               GO TO FIN-VAL-FRM-GLS-EJED.

           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VEJE = 'S'
               MOVE FRM-COD-EJED IN AUM-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJED IN AUM-FLD.
]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU AND INI_FRM_GLS_OFID
    == ========================================================================================== -->

  <section name="PGM_BU AND INI_FRM_GLS_OFID" concatenate="1">

    <code><![CDATA[           IF WSS-IND-VOFI NOT = 'S'
               GO TO FIN-VAL-FRM-GLS-OFID.

           IF SCR-CMND NOT = 'CON' AND
              WSS-IND-VOFI = 'S'
               MOVE FRM-COD-OFID IN AUM-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFID IN AUM-FLD.

]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$1
    == ========================================================================================== -->

  <section name="PGM_BU$1">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$2
    == ========================================================================================== -->

  <section name="PGM_BU$2">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$3
    == ========================================================================================== -->

  <section name="PGM_BU$3">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$4
    == ========================================================================================== -->

  <section name="PGM_BU$4">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$5
    == ========================================================================================== -->

  <section name="PGM_BU$5">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    == PGM_BU$6
    == ========================================================================================== -->

  <section name="PGM_BU$6">

    <code><![CDATA[]]></code>

  </section>

  <!-- ========================================================================================== ==
    ==
    == ========================================================================================== -->

</additional>
