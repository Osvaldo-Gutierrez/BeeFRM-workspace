       IDENTIFICATION DIVISION.
      *>========================
       PROGRAM-ID.    GNSPPIDM.
       AUTHOR.        BEE (AFRI)
       DATE-WRITTEN.  16-ABR-2019
      *>-----------------------------------------------------------------
      *> BUSCA INFORMACION DE MODULO A EJECUTAR SEGUN PARAMETRIA
      *>-----------------------------------------------------------------
      
       ENVIRONMENT DIVISION.
      *>=====================
       CONFIGURATION SECTION.
      *>----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
      
       DATA DIVISION.
      *>==============
       WORKING-STORAGE SECTION.
      *>------------------------
       01  SCR-CTTS.                                                    
           03 SCR-INST-INI                PIC X(03) VALUE 'INI'.        
           03 SCR-INST-HCM                PIC X(03) VALUE 'HCM'.        
           03 SCR-INST-GCM                PIC X(03) VALUE 'GCM'.        
           03 SCR-INST-HKY                PIC X(03) VALUE 'HKY'.        
           03 SCR-INST-GKY                PIC X(03) VALUE 'GKY'.        
           03 SCR-INST-HFL                PIC X(03) VALUE 'HFL'.        
           03 SCR-INST-GFL                PIC X(03) VALUE 'GFL'.        
           03 SCR-INST-GCS                PIC X(03) VALUE 'GCS'.        
           03 SCR-INST-GAB                PIC X(03) VALUE 'GAB'.        
           03 SCR-INST-GCF                PIC X(03) VALUE 'GCF'.        
           03 SCR-INST-SIS                PIC X(03) VALUE 'SIS'.        
           03 SCR-INST-BRW                PIC X(03) VALUE 'BRW'.        
           03 SCR-STAT-CON                PIC X(01) VALUE 'C'.          
           03 SCR-STAT-ABT                PIC X(01) VALUE 'K'.          
           03 SCR-STAT-MOD                PIC X(01) VALUE 'M'.          
           03 SCR-STAT-SON                PIC X(01) VALUE 'A'.          
           03 SCR-ACTU-MOD                PIC X(03) VALUE 'MOD'.        
           03 SCR-ACTU-ING                PIC X(03) VALUE 'ING'.        
           03 SCR-VFLD-NOT                PIC X(01) VALUE 'N'.          
           03 SCR-VFLD-YES                PIC X(01) VALUE 'S'.          
           03 SCR-MFLD-NOT                PIC X(01) VALUE 'N'.          
           03 SCR-MFLD-YES                PIC X(01) VALUE 'S'.          
                     
       01  SCR-VARI.                                                    
           03 SCR-TCMA  COMP              PIC S9(04).                   
           03 SCR-SIST                    PIC X(03).                    
           03 SCR-SISG                    PIC X(03).                    
           03 SCR-NTRN                    PIC X(04).                    
           03 SCR-PROG                    PIC X(08).                    
           03 SCR-NTRV                    PIC X(04).                    
           03 SCR-PROV                    PIC X(08).                    
           03 SCR-NLIB                    PIC X(07).                    
           03 SCR-NMAP                    PIC X(07).                    
           03 SCR-RFBY                    PIC X(01).                    
           03 SCR-STAT                    PIC X(01).                    
           03 SCR-INST                    PIC X(03).                    
           03 SCR-ACTU                    PIC X(03).                    
           03 SCR-CMNP                    PIC X(08).                    
           03 SCR-CRPF.                                                 
              05 SCR-CMND                 PIC X(03).                    
              05 SCR-CCPP                 PIC X(03).                    
              05 SCR-STPP                 PIC X(01).                    
              05 SCR-PRMT                 PIC X(25).                    
              05 SCR-CONF                 PIC X(25).                    
           03 SCR-USER                    PIC X(12).                    
           03 SCR-OTRN                    PIC X(04).                    
           03 SCR-UMOD                    PIC X(14).                    
           03 SCR-ICMN                    PIC X(01).                    
              88 SCR-DESDE-MEN VALUE 'M'.                               
              88 SCR-DESDE-HDR VALUE 'H'.                               
              88 SCR-DESDE-CMN VALUE 'C'.                               
              88 SCR-DESDE-PGM VALUE 'P'.                               
           03 SCR-QIDD                    PIC X(08).                    
           03 SCR-LIDD COMP               PIC S9(04).                   
      *>                                                                 
           03 SCR-NEMO                    PIC X(12).                    
           03 SCR-LDOC                    PIC X(12).                    
      *>    03 SCR-NDOC  PIC X(25).                                      
           03 SCR-NDOC.                                                 
              05 SCR-HDR-BNCO             PIC X(00003).                 
              05 SCR-HDR-MRCA             PIC X(00003).                 
              05 SCR-HDR-CART             PIC X(00003).                 
              05 SCR-HDR-LENG             PIC X(00002).                 
              05 SCR-HDR-PAIS             PIC X(00002).                 
              05 SCR-HDR-VRNT             PIC X(00001).                 
              05 SCR-NDOC-DISP            PIC X(00011).                 
           03 SCR-FRET                    PIC X(12).                    
           03 SCR-IPRV                    PIC X(01).                    
      *>                                                                 
           03 SCR-MFLD                    PIC X(01).                    
           03 SCR-VFLD                    PIC X(01).                    
           03 SCR-FFLD                    PIC X(01).                    
              88 SCR-FFLD-RET   VALUE ''''.                             
              88 SCR-FFLD-PF1   VALUE '1'.                              
              88 SCR-FFLD-PF2   VALUE '2'.                              
              88 SCR-FFLD-PF3   VALUE '3'.                              
              88 SCR-FFLD-PF4   VALUE '4'.                              
              88 SCR-FFLD-PF5   VALUE '5'.                              
              88 SCR-FFLD-PF6   VALUE '6'.                              
              88 SCR-FFLD-PF7   VALUE '7'.                              
              88 SCR-FFLD-PF8   VALUE '8'.                              
              88 SCR-FFLD-PF9   VALUE '9'.                              
              88 SCR-FFLD-PF10  VALUE ':'.                              
              88 SCR-FFLD-PF11  VALUE '#'.                              
              88 SCR-FFLD-PF12  VALUE '@'.                              
              88 SCR-FFLD-PFA   VALUE 'A'.                              
              88 SCR-FFLD-PFB   VALUE 'B'.                              
              88 SCR-FFLD-PFC   VALUE 'C'.                              
              88 SCR-FFLD-PFD   VALUE 'D'.                              
              88 SCR-FFLD-PFE   VALUE 'E'.                              
              88 SCR-FFLD-PFF   VALUE 'F'.                              
              88 SCR-FFLD-PFG   VALUE 'G'.                              
              88 SCR-FFLD-PFH   VALUE 'H'.                              
              88 SCR-FFLD-PFI   VALUE 'I'.                              
              88 SCR-FFLD-PFJ   VALUE '?'.                              
              88 SCR-FFLD-PFK   VALUE '.'.                              
              88 SCR-FFLD-PFL   VALUE '<'.                              
           03 SCR-DISP                    PIC X(25).                    
                     
      *>    Request Area                                                 
       01  ADR-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                     
      *> User Information Block                                          
       01  ADR-UIFB.                                                    
      *>                                                                 
      *>    Programa                                                     
           03 ADR-PROG                                  PIC X(08).      
      *>                                                                 
           03 FILLER                                    PIC X(24).      
                     
      *> Variables para compactar blancos de un string de caracteres     
       01  CPT-VARI.                                                    
           03 CPT-STRN.                                                 
              05 CPT-STR1                         PIC  X(40).           
              05 CPT-STR2                         PIC  X(60).           
           03 CPT-STRN-RED REDEFINES CPT-STRN     PIC  X(01)            
                           OCCURS 100.                                  
           03 CPT-LENG                  VALUE 100 PIC  9(03).           
           03 CPT-IBLK                            PIC  X(01).           
              88 CPT-PONGO-BLANCO       VALUE 'S'.                      
           03 CPT-UBLK                  VALUE 0   PIC  9(03).           
           03 CPT-I                     VALUE 0   PIC  9(03).           
           03 CPT-J                     VALUE 0   PIC  9(03).           
                     
      *>    Element List                                                 
       01  ADR-ELLS.                                                    
      *>    Elemento 1                                                   
           03 ADR-ELM1                                  PIC X(05).      
      *>    Codigo de Seguridad                                          
           03 ADR-CSEG                                  PIC X(01).      
      *>    Fin de Element List                                          
           03 FILLER                    VALUE SPACES    PIC X(05).      
                     
      *>    Constantes para las rutinas FIO"s                            
       01  FIO-CTTS.                                                    
      *>                                                                 
      *>    DEFault access for other users                               
           03 FIO-ACCS-DEF        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    NOT     access for other users                               
           03 FIO-ACCS-NOT        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    INPut   access for other users                               
           03 FIO-ACCS-INP        VALUE 2       PIC 9(01).              
      *>                                                                 
      *>    UPDate  access for other users                               
           03 FIO-ACCS-UPD        VALUE 3       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on record locked                             
           03 FIO-RLCK-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on record locked                             
           03 FIO-RLCK-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on input file not found                      
           03 FIO-IFNF-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on input file not found                      
           03 FIO-IFNF-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    Status Registro Inexistente                                  
           03 FIO-STAT-NEX                      PIC X(02) VALUE '39'.   
      *>                                                                 
      *>    Comandos para las rutinas FIO"s                              
           03 FIO-VCMN.                                                 
      *>                                                                 
      *>       Read Key                                                  
              05 FIO-GET-KEY           VALUE  1 PIC 9(04).              
      *>                                                                 
      *>       Read Next                                                 
              05 FIO-GET-NXT           VALUE  2 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next                                   
              05 FIO-GET-FST           VALUE  3 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next                                
              05 FIO-GET-NLS           VALUE  4 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next                                 
              05 FIO-GET-GRT           VALUE  5 PIC 9(04).              
      *>                                                                 
      *>       Write                                                     
              05 FIO-PUT               VALUE  6 PIC 9(04).              
      *>                                                                 
      *>       Rewrite                                                   
              05 FIO-MOD               VALUE  7 PIC 9(04).              
      *>                                                                 
      *>       Delete                                                    
              05 FIO-DEL               VALUE  8 PIC 9(04).              
      *>                                                                 
      *>       Change                                                    
              05 FIO-CHG               VALUE  9 PIC 9(04).              
      *>                                                                 
      *>       Open Input                                                
              05 FIO-INP               VALUE 10 PIC 9(04).              
      *>                                                                 
      *>       Open Output                                               
              05 FIO-OUT               VALUE 11 PIC 9(04).              
      *>                                                                 
      *>       Open I-O                                                  
              05 FIO-UPD               VALUE 12 PIC 9(04).              
      *>                                                                 
      *>       Close                                                     
              05 FIO-CLO               VALUE 13 PIC 9(04).              
      *>                                                                 
      *>       Start Equal                                               
              05 FIO-FND-EQL           VALUE 14 PIC 9(04).              
      *>                                                                 
      *>       Start First                                               
              05 FIO-FND-FST           VALUE 15 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less                                            
              05 FIO-FND-NLS           VALUE 16 PIC 9(04).              
      *>                                                                 
      *>       Start Greater                                             
              05 FIO-FND-GRT           VALUE 17 PIC 9(04).              
      *>                                                                 
      *>       Unlock Record                                             
              05 FIO-ULK-REC           VALUE 18 PIC 9(04).              
      *>                                                                 
      *>       Unlock All                                                
              05 FIO-ULK-ALL           VALUE 19 PIC 9(04).              
      *>                                                                 
      *>       Value of ID                                               
              05 FIO-VID               VALUE 20 PIC 9(04).              
      *>                                                                 
      *>       Acceso                                                    
              05 FIO-ACC               VALUE 21 PIC 9(04).              
      *>                                                                 
      *>       Record Locked                                             
              05 FIO-REC-LCK           VALUE 22 PIC 9(04).              
      *>                                                                 
      *>       File Not Found                                            
              05 FIO-FNF               VALUE 23 PIC 9(04).              
      *>                                                                 
      *>       Record Length                                             
              05 FIO-REC-LEN           VALUE 24 PIC 9(04).              
      *>                                                                 
      *>       Open Extend                                               
              05 FIO-EXT               VALUE 25 PIC 9(04).              
      *>                                                                 
      *>       Read Key ( Alternate Key )                                
              05 FIO-GET-KEY-ALT       VALUE 26 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next ( Alternate Key )                 
              05 FIO-GET-FST-ALT       VALUE 27 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next ( Alternate Key )              
              05 FIO-GET-NLS-ALT       VALUE 28 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next ( Alternate Key )               
              05 FIO-GET-GRT-ALT       VALUE 29 PIC 9(04).              
      *>                                                                 
      *>       Start Equal ( Alternate Key )                             
              05 FIO-FND-EQL-ALT       VALUE 30 PIC 9(04).              
      *>                                                                 
      *>       Start First ( Alternate Key )                             
              05 FIO-FND-FST-ALT       VALUE 31 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less ( Alternate Key )                          
              05 FIO-FND-NLS-ALT       VALUE 32 PIC 9(04).              
      *>                                                                 
      *>       Start Greater ( Alternate Key )                           
              05 FIO-FND-GRT-ALT       VALUE 33 PIC 9(04).              
      *>                                                                 
      *>       Get Next con llave Alternativa                            
              05 FIO-GET-NXT-ALT       VALUE 34 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update con llave Alternativa                      
              05 FIO-GET-KEY-UPD-ALT   VALUE 35 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update                                            
              05 FIO-GET-KEY-UPD       VALUE 36 PIC 9(04).              
      *>                                                                 
      *>       End Browse                                                
              05 FIO-END-BRW           VALUE 37 PIC 9(04).              
      *>                                                                 
      *>       Back Out Transaction                                      
              05 FIO-BCK-OUT           VALUE 38 PIC 9(04).              
      *>                                                                 
      *>       Get Less or Equal                                         
              05 FIO-GET-LEQ           VALUE 39 PIC 9(04).              
      *>                                                                 
      *>       Get Previous                                              
              05 FIO-GET-PRV           VALUE 40 PIC 9(04).              
      *>                                                                 
      *>       Check Point                                               
              05 FIO-CHK-PNT           VALUE 41 PIC 9(04).              
      *>                                                                 
      *>       Buffer Refresh                                            
              05 FIO-BFR-RFH           VALUE 42 PIC 9(04).              
      *>                                                                 
      *>       End Browse All                                            
              05 FIO-EBR-ALL           VALUE 43 PIC 9(04).              
      *>                                                                 
      *>       BEGin TRaNsacction                                        
              05 FIO-BEG-TRN           VALUE 44 PIC 9(04).              
      *>                                                                 
           03 FIO-VCMN-RED    REDEFINES FIO-VCMN.                       
              05 FIO-IDX-VCMN OCCURS 44 TIMES   PIC 9(04).              
      *>                                                                 
      *>    Programa que usa servicio de FIO                             
           03 FIO-PROG                          PIC X(08).              
      *>                                                                 
      *>    Programa  FIO                             
           03 FIO-GLS-PROG                      PIC X(08).              
      *>                                                                 
      *>    Valor de Key                                                 
           03 FIO-VKEY                          PIC X(180).             
      *>                                                                 
      *>    Valor de Key para Comparacion con FIO-VKEY   ( VSI )         
           03 FIO-CKEY                          PIC X(180).             
      *>                                                                 
      *>    Key Length                                                   
           03 FIO-KLEN  COMP                    PIC S9(4).              
      *>                                                                 
      *>    Campo Data para FIO                                          
           03 FIO-DFLD                          PIC X(1536).            
      *>                                                                 
      *>    Mensaje                                                      
           03 FIO-MENS              VALUE SPACES.                       
      *>                                                                 
      *>       Mensaje 1                                                 
              05 FIO-MEN1                       PIC X(71).              
      *>                                                                 
      *>       Mensaje 2                                                 
              05 FIO-MEN2                       PIC X(09).              
      *>                                                                 
           03 FIO-MENS-RED REDEFINES FIO-MENS.                          
              05 FIO-MENS-DSC                   PIC X(13).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-STT                   PIC X(02).              
              05 FIO-MENS-NTT REDEFINES FIO-MENS-STT PIC 9(02).         
              05 FIO-MENS-SST                   PIC X(01).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GKY                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-KEY                   PIC X(32).              
              05 FIO-MENS-KEY-RED REDEFINES FIO-MENS-KEY.               
                 07 FIO-MENS-KDT                PIC X(05).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-GBD                PIC X(10).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-DBI                PIC X(05).              
                 07 FILLER                      PIC X(10).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GCM                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-CMD                   PIC X(05).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GFL                   PIC X(04).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-FIL                   PIC X(09).              
              05 FIO-MENS-FIL-RED REDEFINES FIO-MENS-FIL.               
                 07 FIO-MENS-SIS                PIC X(03).              
                 07 FIO-MENS-REG                PIC X(06).              
              05 FILLER                         PIC X(01).              
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IAKY                 VALUE  0 PIC 9(04).              
              88 FIO-IAKY-CON          VALUE 26 THRU 35.                
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IGET                 VALUE  0 PIC 9(04).              
              88 FIO-IGET-YES          VALUE  1 THRU 5, 26 THRU 29,     
                                             34, 35, 36, 39, 40.        
              88 FIO-ICBR-YES          VALUE  2, 34, 40.                
      *>                                                                 
      *>    Indicador de Llaves de Default                               
           03 FIO-KDEF                 VALUE 0 PIC 9(01).               
           03 FIO-KDEF-N               VALUE 0 PIC 9(01).               
           03 FIO-KDEF-S               VALUE 1 PIC 9(01).               
      *>                                                                 
      *>    Indicador de primera VEZ                                     
           03 FIO-IVEZ            VALUE SPACES PIC X(01).               
      *>                                                                 
      *>    Vector de status de archivos                                 
           03 FIO-MSFL VALUE SPACES.                                    
              05 FIO-VSFL OCCURS 20 INDEXED BY FIO-ITBL.                
                 07 FIO-NFIL                   PIC X(07).               
      *>                                                                 
      *>    Indice maximo                                                
           03 FIO-MXFL               VALUE 20  PIC 9(02).               
      *>                                                                 
      *>    Indicador de Start-Browse abierto                            
           03 FIO-ISBR               VALUE 'N' PIC X(01).               
      *>                                                                 
      *>    Indice auxiliar                                              
           03 FIO-IAUX               VALUE 0   PIC 9(02).               
      
       01 FIO-ORACLE.
           03 FIO-ORACLE-VARI                  PIC X(0080).
           03 FIO-ORACLE-DFLD                  PIC X(1536).
           03 FIO-ORACLE-RQA                   PIC X(0630).
           03 FIO-ORACLE-MENS                  PIC X(0080).
           03 FIO-ORACLE-PROG.
              05 FIO-ORACLE-PROG-TAB           PIC X(0003).
              05 FIO-ORACLE-PROG-NUM           PIC 9(0003).
           03 FIO-ORACLE-FILL                  PIC X(0668).
      
       01 RECV-STRING-FIO                      PIC X(3000).
       
       01 SEND-STRING-FIO                      PIC X(3000).
                     
      *>    Variables para las rutinas FIO"s                             
      *>    ( Linkage Section para VSAM BATCH )                          
       01  FIO-VARI.                                                    
      *>                                                                 
      *>    Nombre de la llave alternativa                               
           03 FIO-AKEY       VALUE SPACES               PIC X(32).      
      *>                                                                 
      *>    Esta variable FILE STATUS es el codigo de retorno            
      *>    de las subrutinas FIO                                        
           03 FIO-STAT.                                                 
      *>                                                                 
      *>          Created Duplicate Key                                  
                 88 FIO-STAT-CDK        VALUE '02'.                     
      *>                                                                 
      *>          End Of File                                            
                 88 FIO-STAT-EOF        VALUE '10'.                     
      *>                                                                 
      *>          No Ascending Key                                       
                 88 FIO-STAT-NAK        VALUE '21'.                     
      *>                                                                 
      *>          Invalid KeY                                            
                 88 FIO-STAT-IKY        VALUE '22' '23'.                
      *>                                                                 
      *>          Duplicate Alternate Key                                
                 88 FIO-STAT-DAK        VALUE '22'.                     
      *>                                                                 
      *>          Record Not Found                                       
                 88 FIO-STAT-RNF        VALUE '23'.                     
      *>                                                                 
      *>          Boundary Violation Error                               
                 88 FIO-STAT-BVE        VALUE '24' '34'.                
      *>                                                                 
      *>          Other Permanent Errors                                 
                 88 FIO-STAT-OPE        VALUE '30'.                     
      *>                                                                 
      *>          Other Device Errors                                    
                 88 FIO-STAT-ODE        VALUE '90'.                     
      *>                                                                 
      *>          PassWord Failure                                       
                 88 FIO-STAT-PWF        VALUE '91'.                     
      *>                                                                 
      *>          LoGic Error                                            
                 88 FIO-STAT-LGE        VALUE '92'.                     
      *>                                                                 
      *>          Resource Not Available                                 
                 88 FIO-STAT-RNA        VALUE '93'.                     
      *>                                                                 
      *>          No Previous Read                                       
                 88 FIO-STAT-NPR        VALUE '94'.                     
      *>                                                                 
      *>          Invalid or incomplete File Information                 
                 88 FIO-STAT-IFI        VALUE '95'.                     
      *>                                                                 
      *>          Bad File Identification                                
                 88 FIO-STAT-BFI        VALUE '96'.                     
      *>                                                                 
      *>          File Intergrity Verified                               
                 88 FIO-STAT-FIV        VALUE '97'.                     
      *>JSS                                                              
      *>             Fatal                                               
                    88 FIO-STAT-FTL        VALUE '99'.                  
      *>JSS                                                              
      *>             Duplicate Master Key                                
                    88 FIO-STAT-DMK        VALUE '22'.                  
      *>JSS                                                              
      *>             Invalid Master Key                                  
                    88 FIO-STAT-IMK        VALUE '23'.                  
      *>JSS                                                              
      *>             Special Deleted Record                              
                    88 FIO-STAT-SDR        VALUE '43'.                  
      *>JSS                                                              
      *>             Exclusive Control Duplicate                         
                    88 FIO-STAT-ECD        VALUE '44'.                  
      *>JSS                                                              
      *>             Set Selection Interrupt                             
                    88 FIO-STAT-SSI        VALUE '45'.                  
      *>JSS                                                              
      *>             Attempt to Position PAST END/BEG-OF-SET             
                    88 FIO-STAT-APS        VALUE '46'.                  
      *>JSS                                                              
      *>             Exclusive Control Interlock                         
                    88 FIO-STAT-ECI        VALUE '47'.                  
      *>                                                                 
                 05 FIO-STT1                    PIC 9(01).              
      *>                                                                 
      *>               OK Status                                         
                      88 FIO-STAT-OKS   VALUE 0.                        
      *>                                                                 
      *>               At End Status                                     
                      88 FIO-STAT-AES   VALUE 1.                        
      *>                                                                 
      *>               Invalid Key Status                                
                      88 FIO-STAT-IKS   VALUE 2.                        
      *>                                                                 
      *>               ERRors                                            
                      88 FIO-STAT-ERR   VALUE 3.                        
      *>JSS                                                              
      *>               DATACOM Errors                                    
                      88 FIO-STAT-DTC   VALUE 4.                        
      *>                                                                 
      *>               Device Dependant Errors                           
                      88 FIO-STAT-DDE   VALUE 9.                        
      *>                                                                 
                 05 FIO-STT2                    PIC 9(01).              
      *>                                                                 
      *>               No Further Information                            
                      88 FIO-STAT-NFI   VALUE 0.                        
      *>                                                                 
      *>               SEQuential access                                 
                      88 FIO-STAT-SEQ   VALUE 1.                        
      *>                                                                 
      *>               DUPlicates                                        
                      88 FIO-STAT-DUP   VALUE 2.                        
      *>                                                                 
      *>               No Current Record                                 
                      88 FIO-STAT-NCR   VALUE 3.                        
      *>                                                                 
      *>    Esta variable RELATIVE KEY indica a las subrutinas FIO       
      *>    la llave de un archivo relativo para su acceso.              
           03 FIO-RKEY          COMP            PIC 9(09).              
      *>                                                                 
      *>    Comando de las Subrutinas FIO                                
           03 FIO-CMND                 VALUE  0 PIC 9(04).              
      *>                                                                 
      *>    Esta variable  ACCESS indica a las subrutinas                
      *>    FIO la forma de abrir un archivo en cuanto al                
      *>    acceso desde otros programas                                 
           03 FIO-ACCS                      PIC 9(01).                  
      *>                                                                 
      *>       0 = DEFault access                                        
      *>       1 = NOT     access                                        
      *>       2 = INPut   access                                        
      *>       3 = UPDate  access                                        
      *>                                                                 
      *>    Esta variable RECORD LOCKED indica a las subrutinas          
      *>    FIO si tomar o no el control cuando hay un registro          
      *>    ocupado                                                      
           03 FIO-RLCK                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on record locked ( Default )          
      *>       1 = ProGraM control on record locked                      
      *>                                                                 
      *>    Esta variable INPUT FILE NOT FOUND indica a las              
      *>    subrutinas  FIO si tomar o no el control cuando              
      *>    al abrir un archivo de Input, este no existe                 
           03 FIO-IFNF                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on file not found                     
      *>       1 = ProGraM control on file not found                     
      *>                                                                 
      *>    Esta  variable  RECORD LENGTH  debe ser  llenada  con el     
      *>    largo  del  registro, para  registros de largo variable,     
      *>    antes de llamar a las subrutinas FIO con comando REC_LEN     
           03 FIO-RLEN     COMP                 PIC S9(04).             
      *>                                                                 
      *>    Value Of ID                                                  
           03 FIO-VOID.                                                 
      *>                                                                 
      *>       Sistema                                                   
              05 FIO-SIST                       PIC X(03).              
      *>                                                                 
      *>       Tipo                                                      
              05 FIO-FTYP                       PIC X(01).              
      *>                                                                 
      *>       Nombre                                                    
              05 FIO-FNAM                       PIC X(04).              
                                                                        
      *>       RESPALDO FIO-SIST                                         
           03 FIO-SIST-BKP                      PIC X(03).              
                                                                        
      *>                                                                 
      *>    Filler                                                       
           03 FILLER                            PIC X(15).              
                     
      *>Variables para independencia de datos 15-JAN-1990 17:04:48       
       01  IDD-VARI.                                                    
           03 IDD-PROG                          PIC X(08).              
           03 IDD-DAUX.                                                 
              05 IDD-SAUX                       PIC X(03).              
              05 IDD-GAUX                       PIC X(01).              
              05 IDD-RAUX                       PIC X(03).              
           03 IDD-IAUX                          PIC 9(02).              
           03 IDD-REGI.                                                 
              05 FILLER                         PIC X(01).              
              05 IDD-CIDD                       PIC X(12).              
              05 IDD-FSIS.                                              
                 07 IDD-VSIS OCCURS 43 INDEXED BY IDD-ITBL.             
                    09 IDD-DENT.                                        
                       11 IDD-SIST              PIC X(03).              
                       11 IDD-GRPO              PIC X(01).              
                       11 IDD-RGST              PIC X(03).              
                    09 IDD-TENT                 PIC X(01).              
                    09 IDD-IENT                 PIC X(03).              
      *>ESTE REDEFINES TIENE COMO PROPOSITO COMPILAR                     
      *>PROGRAMAS NUEVOS CON FIO"S ANTIGUAS ( SIN GENERARLAS )           
      *>              09 IFD-GSIS REDEFINES IDD-IENT                     
      *>                                          PIC X(03).             
              05 FILLER                         PIC X(04).              
                     
      *>COPY GNSWGFRM.
        01  TPSVCRET-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCRET.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCRET.cbl     
      *>
      *>  TPSVCRET.cbl
      *>
        05 TP-RETURN-VAL PIC S9(9) COMP-5.
                88 TPSUCCESS  VALUE 0.
                88 TPFAIL     VALUE 1.
                88 TPEXIT     VALUE 2.
                88 TPLONGJUMP VALUE 3.
                88 TPBREAK    VALUE 4.
        05 APPL-CODE          PIC S9(9) COMP-5.
      
      *>
        01  TPTYPE-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPTYPE.cbl  $Revision: 1.4 $"
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPTYPE.cbl       
      *>
      *>  TPTYPE.cbl
      *>
        05 REC-TYPE         PIC X(8).
                88 X-OCTET   VALUE "X_OCTET".
                88 X-COMMON  VALUE "X_COMMON".
        05 SUB-TYPE         PIC X(16).
        05 LEN              PIC S9(9) COMP-5.
                88 NO-LENGTH VALUE 0.
        05 TPTYPE-STATUS    PIC S9(9) COMP-5.
                88 TPTYPEOK     VALUE 0.
                88 TPTRUNCATE   VALUE 1.
      *>
      *>
        01 TPSTATUS-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSTATUS.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSTATUS.cbl     
      *>
      *>  TPSTATUS.cbl
      *>
        05 TP-STATUS  PIC S9(9) COMP-5.
                88 TPOK                 VALUE 0.
                88 TPEABORT             VALUE 1.
                88 TPEBADDESC           VALUE 2.
                88 TPEBLOCK             VALUE 3.
                88 TPEINVAL             VALUE 4.
                88 TPELIMIT             VALUE 5.
                88 TPENOENT             VALUE 6.
                88 TPEOS                VALUE 7.
                88 TPEPERM              VALUE 8.
                88 TPEPROTO             VALUE 9.
                88 TPESVCERR            VALUE 10.
                88 TPESVCFAIL           VALUE 11.
                88 TPESYSTEM            VALUE 12.
                88 TPETIME              VALUE 13.
                88 TPETRAN              VALUE 14.
                88 TPEGOTSIG            VALUE 15.
                88 TPERMERR             VALUE 16.
                88 TPEITYPE             VALUE 17.
                88 TPEOTYPE             VALUE 18.
                88 TPERELEASE           VALUE 19.
                88 TPEHAZARD            VALUE 20.
                88 TPEHEURISTIC         VALUE 21.
                88 TPEEVENT             VALUE 22.
                88 TPEMATCH             VALUE 23.
                88 TPEDIAGNOSTIC        VALUE 24.
                88 TPEMIB               VALUE 25.
                88 TPEMAXVAL            VALUE 26.
      *>
        05 TPEVENT                PIC S9(9) COMP-5.
                88 TPEV-NOEVENT         VALUE 0.
                88 TPEV-DISCONIMM       VALUE 1.
                88 TPEV-SENDONLY        VALUE 2.
                88 TPEV-SVCERR          VALUE 3.
                88 TPEV-SVCFAIL         VALUE 4.
                88 TPEV-SVCSUCC         VALUE 5.
      *>
        05 APPL-RETURN-CODE       PIC S9(9) COMP-5.
      *>
        01  TPSVCDEF-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCDEF.cbl        $Revision: 1.5 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCDEF.cbl     
      *>
      *>  TPSVCDEF.cbl
      *>
        05 COMM-HANDLE          PIC S9(9) COMP-5.
        05 TPBLOCK-FLAG         PIC S9(9) COMP-5.
                88 TPBLOCK         VALUE 0.
                88 TPNOBLOCK       VALUE 1.
        05 TPTRAN-FLAG          PIC S9(9) COMP-5.
                88 TPTRAN          VALUE 0.
                88 TPNOTRAN        VALUE 1.
        05 TPREPLY-FLAG         PIC S9(9) COMP-5.
                88 TPREPLY         VALUE 0.
                88 TPNOREPLY       VALUE 1.
        05 TPACK-FLAG         REDEFINES TPREPLY-FLAG.
           10 FILLER PIC S9(9) COMP-5.
                88 TPNOACK         VALUE 0.
                88 TPACK           VALUE 1.
        05 TPTIME-FLAG          PIC S9(9) COMP-5.
                88 TPTIME          VALUE 0.
                88 TPNOTIME        VALUE 1.
        05 TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
                88 TPNOSIGRSTRT    VALUE 0.
                88 TPSIGRSTRT      VALUE 1.
        05 TPGETANY-FLAG        PIC S9(9) COMP-5.
                88 TPGETHANDLE     VALUE 0.
                88 TPGETANY        VALUE 1.
        05 TPSENDRECV-FLAG      PIC S9(9) COMP-5.
                88 TPSENDONLY      VALUE 0.
                88 TPRECVONLY      VALUE 1.
        05 TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
                88 TPCHANGE        VALUE 0.
                88 TPNOCHANGE      VALUE 1.
        05 TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
                88  TPREQRSP       VALUE IS 0.
                88  TPCONV         VALUE IS 1.
      *>
        05 APPKEY               PIC S9(9) COMP-5.
        05 CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
        05 SERVICE-NAME            PIC X(127).
      
      *>*****************************************************
      *> Log message definitions 
      *>*****************************************************
        01  LOGMSG.
                05  LOGMSG-PROG  VALUE 'GNSPQTAB :' PIC X(10) .
                05  LOGMSG-NUMB  VALUE '00'         PIC X(02).
                05  LOGMSG-TIME  VALUE '00000000'   PIC X(08).
                05  LOGMSG-TEXT.
                    07  LOGMSG-TEXT-1               PIC X(04).
                    07  LOGMSG-TEXT-2               PIC X(06).
                    07  LOGMSG-TEXT-3               PIC X(40).
                
        01  LOGMSG-LEN            PIC S9(9)  COMP-5.
      
      *> VARIABLES FRM                                                   
      *> PROCESA INTERFACES BMS Y PTC V31                                
      *>                                                                 
       01  FRM-VARI.                                                    
           03 FRM-TCMA  COMP          PIC S9(4).                        
           03 FRM-CMMA.                                                 
              05 FRM-SCR-MENS         PIC X(79).                        
              05 FRM-SCR-VARI         PIC X(3421).                      
           03 FRM-STAT                PIC X(03).                        
              88 FRM-STAT-OKS   VALUE 'OKS'.                            
              88 FRM-STAT-ABT   VALUE 'ABT'.                            
           03 FRM-NAME                PIC X(007).                       
           03 FRM-NLIB                PIC X(007).                       
           03 FRM-PLIN       VALUE 1  PIC 9(02).                        
           03 FRM-NLIN       VALUE 0  PIC 9(02).                        
           03 FRM-PCUR  COMP          PIC S9(04).                       
           03 FRM-UCUR  VALUE SPACES  PIC  X(01).                       
           03 FRM-TFLD  COMP          PIC S9(04).                       
           03 FRM-AUXI                PIC X(2000).                      
           03 FRM-DFLD.                                                 
              05 FRM-COD-MENS         PIC X(12).                        
              05 FRM-GLS-MENS         PIC X(79).                        
              05 FRM-DATA.                                              
                 07 FRM-NAME-IDEN     PIC X(12).                        
                 07 FRM-NAME-CMPL     PIC X(1988).                      
           03 FRM-LFLD  COMP          PIC S9(04).                       
           03 FRM-IFLD  COMP          PIC  9(09).                       
           03 FRM-MENS                PIC X(79).                        
           03 FRM-MENS-RED REDEFINES  FRM-MENS.                         
              05 FRM-MEN1             PIC X(40).                        
              05 FRM-MEN2             PIC X(39).                        
           03 FRM-ABRV                PIC X(05).                        
           03 FRM-FFLD                PIC X.                            
           03 FRM-SUAR                PIC X(03).                        
           03 FRM-SINI                PIC 9(01).                        
           03 FRM-CMND                PIC 9(02).                        
           03 FRM-IHDL   VALUE SPACES PIC X(01).                        
      *> PTC: VARIABLES NECESARIAS AMBIENTE PLATAFORMA COMERCIAL         
      *> PTC: COLA                                                       
           03 FRM-COLA.                                                 
      *> PTC: TERMINAL PARA CONFORMAR COLAS LECTURA/ESCRITURA            
              05 FRM-TERM             PIC X(04).                        
      *> PTC: IDENTIFICAR COLAS LECTURA/ESCRITURA                        
              05 FRM-TYPE             PIC X(03).                        
      *> PTC: LARGO ITEM DE COLA                                         
           03 FRM-LITM  COMP          PIC S9(4).                        
                                                                        
       01  FRM-CTTS.                                                    
           03 FRM-INI                 PIC 9(02) VALUE 1.                
           03 FRM-GET-ALL             PIC 9(02) VALUE 2.                
           03 FRM-PUT-ALL             PIC 9(02) VALUE 3.                
           03 FRM-CLR-ALL             PIC 9(02) VALUE 4.                
           03 FRM-MSG                 PIC 9(02) VALUE 5.                
           03 FRM-RCV                 PIC 9(02) VALUE 6.                
      *> MHM-INI 28-FEB-2011 MODERNIZACION MIGRACION DB2
           03 FRM-ABT                 PIC 9(02) VALUE 10.               
      *> MHM-FIN 28-FEB-2011 MODERNIZACION MIGRACION DB2
           03 FRM-CLR-FRM             PIC 9(02) VALUE 7.                
           03 FRM-SINI-DB1F           PIC 9(01) VALUE 0.                
           03 FRM-SINI-DBNF           PIC 9(01) VALUE 1.                
           03 FRM-SINI-DBLF           PIC 9(01) VALUE 2.                
           03 FRM-SINI-MB1F           PIC 9(01) VALUE 3.                
           03 FRM-SINI-MBNF           PIC 9(01) VALUE 4.                
           03 FRM-SINI-MBLF           PIC 9(05) VALUE 5.                
           03 FRM-FFLD-PA1            PIC X VALUE '%'.                  
           03 FRM-FFLD-PA2            PIC X VALUE '>'.                  
           03 FRM-FFLD-PA3            PIC X VALUE ','.                  
           03 FRM-FFLD-RET            PIC X VALUE ''''.                 
           03 FRM-FFLD-TAB            PIC X VALUE '3'.                  
           03 FRM-FFLD-PF1            PIC X VALUE '1'.                  
           03 FRM-FFLD-PF2            PIC X VALUE '2'.                  
           03 FRM-FFLD-PF3            PIC X VALUE '3'.                  
           03 FRM-FFLD-PF4            PIC X VALUE '4'.                  
           03 FRM-FFLD-PF5            PIC X VALUE '5'.                  
           03 FRM-FFLD-PF6            PIC X VALUE '6'.                  
           03 FRM-FFLD-PF7            PIC X VALUE '7'.                  
           03 FRM-FFLD-PF8            PIC X VALUE '8'.                  
           03 FRM-FFLD-PF9            PIC X VALUE '9'.                  
           03 FRM-FFLD-PF10           PIC X VALUE ':'.                  
           03 FRM-FFLD-PF11           PIC X VALUE '#'.                  
           03 FRM-FFLD-PF12           PIC X VALUE '@'.                  
           03 FRM-FFLD-PFA            PIC X VALUE 'A'.                  
           03 FRM-FFLD-PFB            PIC X VALUE 'B'.                  
           03 FRM-FFLD-PFC            PIC X VALUE 'C'.                  
           03 FRM-FFLD-PFD            PIC X VALUE 'D'.                  
           03 FRM-FFLD-PFE            PIC X VALUE 'E'.                  
           03 FRM-FFLD-PFF            PIC X VALUE 'F'.                  
           03 FRM-FFLD-PFG            PIC X VALUE 'G'.                  
           03 FRM-FFLD-PFH            PIC X VALUE 'H'.                  
           03 FRM-FFLD-PFI            PIC X VALUE 'I'.                  
           03 FRM-FFLD-PFJ            PIC X VALUE '?'.                  
           03 FRM-FFLD-PFK            PIC X VALUE '.'.                  
           03 FRM-FFLD-PFL            PIC X VALUE '<'.                  
           03 FRM-SUAR-MAL            PIC X(3) VALUE 'MAL'.             
           03 FRM-SUAR-WRN            PIC X(3) VALUE 'WRN'.             
           03 FRM-SUAR-CLR            PIC X(3) VALUE 'CLR'.             
           03 FRM-SUAR-OKS            PIC X(3) VALUE 'OKS'.             
           03 FRM-CPIM.                                                 
      *> AEY = Protegido, normal                                         
              05 FRM-CPIM-AEY         PIC X(01) VALUE '1'.              
      *> UBY = Desprotegido, brillante                                   
              05 FRM-CPIM-UBY         PIC X(01) VALUE 'I'.              
      *> ANY = Protegido, non-display                                    
              05 FRM-CPIM-ANY         PIC X(01) VALUE '_'.              
      *> UNY = Desprotegido, non-display                                 
              05 FRM-CPIM-UNY         PIC X(01) VALUE '('.              
      *> ANY = Protegido, normal                                         
              05 FRM-CPSF-AEY         PIC X(01) VALUE '-'.              
      *> ABY = Protegido, brillante                                      
              05 FRM-CPIM-ABY         PIC X(01) VALUE '9'.              
      *> UST = Virtual para BMS, pues es campo STOPPER en UNISYS         
              05 FRM-CPIM-UST         PIC X(01) VALUE SPACES.           
           03 FRM-POS-CURS COMP   PIC S9(04) VALUE -1.                  
           03 FRM-IND-ERRO COMP   PIC S9(04) VALUE -1.                  
           03 FRM-ERR-NUME COMP   PIC S9(04) VALUE -9.                  
           03 FRM-RST-PCUR COMP   PIC S9(04) VALUE ZEROES.              
                     
       01 FRM-NTRN                PIC X(04).                        
       01 FRM-PROG                PIC X(08).                        
       01 FRM-PROG-RED REDEFINES FRM-PROG                           
                       OCCURS 8   PIC X(01).                        
      *>    Variables para Rutinas del Sistema. GNSWGSYS V-3.1
       01  SYS-VARI.
      *>    Variables para Current-Date
           03 SYS-FHOY-2B.
              05 SYS-AHOY-2B                   PIC 9(02).
              05 SYS-MHOY-2B                   PIC 9(02).
              05 SYS-DHOY-2B                   PIC 9(02).
           03 SYS-SHOY                         PIC 9(02).
           03 SYS-FHOY.
              05 SYS-DHOY                      PIC 9(02).
              05 SYS-SLH1                      PIC X(01).
              05 SYS-MHOY                      PIC 9(02).
              05 SYS-SLH2                      PIC X(01).
              05 SYS-AHOY                      PIC 9(02).
           03 SYS-HHOY-2B  VALUE ZEROES        PIC 9(08).
           03 SYS-HHOY-2B-RED REDEFINES SYS-HHOY-2B.
              05 SYS-HHHY-2B                   PIC 9(02).
              05 SYS-MMHY-2B                   PIC 9(02).
              05 SYS-SSHY-2B                   PIC 9(02).
              05 SYS-CCHY-2B                   PIC 9(02).
           03 SYS-HHOY  VALUE ZEROES           PIC 9(06).
           03 SYS-HHOY-RED REDEFINES SYS-HHOY.
              05 SYS-HHHY                      PIC 9(02).
              05 SYS-MMHY                      PIC 9(02).
              05 SYS-SSHY                      PIC 9(02).
           03 SYS-JHOY                         PIC 9(05).
           03 SYS-JHOY-RED REDEFINES SYS-JHOY.
              05 SYS-AAHY                      PIC 9(02).
              05 SYS-DDHY                      PIC 9(03).
           03 SYS-TSTP.
              05 SYS-SSTP                      PIC 9(02).
              05 SYS-FSTP.
                 07 SYS-AATS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-DDTS                   PIC 9(02).
              05 SYS-HSTP                      PIC 9(06).
              05 SYS-HSTP-RED REDEFINES SYS-HSTP.
                 07 SYS-HHTS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-SSTS                   PIC 9(02).
      *>    Tamano de Communication Area
           03 SYS-TCMA  COMP                   PIC S9(4).
      *>    Communication Area
           03 SYS-CMMA.
              05 SYS-SCR-MENS                  PIC X(79).
              05 SYS-SCR-VARI                  PIC X(3421).
      *>INI-PENTA TUXEDO ORACLE
              05 SYS-SCR-NTRN                  PIC X(04).
      *>FIN-PENTA TUXEDO ORACLE
      *>    Transaccion
           03 SYS-NTRN                         PIC X(04).
      *>    Programa
           03 SYS-PROG                         PIC X(08).
           03 SYS-PROG-RED REDEFINES SYS-PROG
                                      OCCURS 8 PIC X(01).
      *>    Programa a ABorTo
           03 SYS-PABT  VALUE 'GNSPPABT'       PIC X(08).
      *>    Comando
           03 SYS-CMND                 VALUE 0 PIC 9(02).
      *>    Mensaje
           03 SYS-MENS.
              05 SYS-MEN1                      PIC X(40).
              05 SYS-MEN2                      PIC X(40).
      *>    Resto
           03 SYS-REST                         PIC 9(01).
      *>    Indice
           03 SYS-SIND                         PIC 9(02).
      *>    Status
           03 SYS-STAT                         PIC X(02).
           03 SYS-STAT-OKS        VALUE '00'   PIC X(02).
           03 SYS-STAT-NUM                     PIC 9(02).
      *>    Indicador de Handler
           03 SYS-IHDL            VALUE SPACES PIC X(01).
      *> MHM-INI 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *>    Indicador de Abend
           03 SYS-ABND            VALUE ' '    PIC X(01).
              88 SYS-ABND-YES     VALUE 'S'.
      
      *> MHM-FIN 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *> IMV-INI 01-JUL-2014 MARCA SIMULACION FUTURA
           03 SYS-SMFT            VALUE 'N'    PIC X(01).
      *> IMV-FIN 01-JUL-2014 MARCA SIMULACION FUTURA
      
      *>INI-PENTA TUXEDO ORACLE
      
      *>    FLAG SERVICIO DE FECHA
           03 SYS-HORA-HABI      VALUE 'N'     PIC X(01).
           03 SYS-HORA-FLAG      VALUE 'N'     PIC X(01).
      
      
       01 EIBTRMID       VALUE SPACES          PIC X(04).
       01 EIBTRNID       VALUE SPACES          PIC X(04).
       01 EIBTASKN       VALUE SPACES          PIC X(04).
       01 EIBCALEN       VALUE 1               PIC 9(04).
       01 EIBAID         VALUE ''''            PIC X(01).
       01 EIBRESP        VALUE 0               PIC S9(04).
      
       01 EIBTASKN-1.
          03 EIBTASKN-11 VALUE SPACES          PIC X(04).
          03 EIBTASKN-12 VALUE SPACES          PIC X(04).
      *> Variables genericas para servicio de fecha y hora
       01  FYH-VARI.
           03  FYH-PROG            VALUE 'GNSPPFYH' PIC X(08).
           03  FYH-TCMA            VALUE 22         PIC 9(08).
           03  FYH-CMSG            VALUE SPACES     PIC X(12).
           03  FYH-MENS.
               05 FYH-MEN2         VALUE SPACES     PIC X(40).
      *>    MENSAJE
           03  FYH-CMMA.
               05 FYH-GLS-RSPT.
      *>           FECHA
                  07 FYH-FEC-FHOY.
                     09 FYH-NUM-SHOY                PIC 9(02).
                     09 FYH-NUM-AHOY                PIC 9(02).
                     09 FYH-NUM-MHOY                PIC 9(02).
                     09 FYH-NUM-DHOY                PIC 9(02).
      *>           HORA
                  07 FYH-HRA-HHOY.
                     09 FYH-NUM-HHHY                PIC 9(02).
                     09 FYH-NUM-MMHY                PIC 9(02).
                     09 FYH-NUM-SSHY                PIC 9(02).
      *>           JULIANO
                  07 FYH-NUM-JULI                   PIC 9(08).
      
      *>FIN-PENTA TUXEDO ORACLE
      *>
      *>    Constantes para Rutinas del Sistema.
       01  SYS-CTTS.
      *>    Comandos
           03 SYS-GET-DATE             VALUE 1 PIC 9(01).
           03 SYS-GET-TIME             VALUE 2 PIC 9(01).
           03 SYS-RTRN                 VALUE 3 PIC 9(01).
           03 SYS-XCTL                 VALUE 4 PIC 9(01).
           03 SYS-LINK                 VALUE 5 PIC 9(01).
           03 SYS-ABOR                 VALUE 6 PIC 9(01).
      *>    Cantidad de Dias Acumulados en cada Mes
           03 SYS-VACU VALUE '000031060091121152182213244274305335'.
              05 SYS-DACU       OCCURS 12      PIC 9(03).
                     
        01 TSK-TX-RETURN-STATUS.
           05 TSK-TX-STATUS PIC S9(9) COMP-5.
                88 TSK-TX-NOT-SUPPORTED             VALUE 1.
      *> Normal execution
                88 TSK-TX-OK                        VALUE 0.
      *> Normal execution
                88 TSK-TX-OUTSIDE                   VALUE -1.
      *> Application is in an RM local transaction
                88 TSK-TX-ROLLBACK                  VALUE -2.
      *> Transaction was rolled back
                88 TSK-TX-MIXED                     VALUE -3.
      *> Transaction was partially committed and partially rolled
                88 TSK-TX-HAZARD                    VALUE -4.
      *> Transaction may have been partially committed and partial
      *> rolled back
                88 TSK-TX-PROTOCOL-ERROR            VALUE -5.
      *> Routine invoked in an improper context
                88 TSK-TX-ERROR                     VALUE -6.
      *> Transient error
                88 TSK-TX-FAIL                      VALUE -7.
      *> Fatal error
                88 TSK-TX-EINVAL                    VALUE -8.
      *> Invalid arguments were given
                88 TSK-TX-COMMITTED                 VALUE -9.
      *> The transaction was heuristically committed
                88 TSK-TX-NO-BEGIN                  VALUE -100.
      *> Transaction committed plus new transaction could not be s
                88 TSK-TX-ROLLBACK-NO-BEGIN         VALUE  -102.
      *> Transaction rollback plus new transaction could not be st
                88 TSK-TX-MIXED-NO-BEGIN            VALUE  -103.
      *> Mixed plus new transaction could not be started
                88 TSK-TX-HAZARD-NO-BEGIN           VALUE  -104.
      *> Hazard plus new transaction could not be started
                88 TSK-TX-COMMITTED-NO-BEGIN        VALUE  -109.
      *> Heuristically committed plus transaction could not be sta
      *>
        01 TSK-TX-INFO-AREA.
      *> XID record
           05 TSK-XID-REC.
              10 TSK-FORMAT-ID        PIC S9(9) COMP-5.
      *> A value of -1 in FORMAT-ID means that the XID is null
              10 TSK-GTRID-LENGTH     PIC S9(9) COMP-5.
              10 TSK-BRANCH-LENGTH    PIC S9(9) COMP-5.
              10 TSK-XID-DATA         PIC X(128).
      *> Transaction mode settings
           05 TSK-TRANSACTION-MODE     PIC S9(9) COMP-5.
              88 TSK-TX-NOT-IN-TRAN   VALUE 0.
              88 TSK-TX-IN-TRAN       VALUE 1.
      *> Commit_return settings
           05 TSK-COMMIT-RETURN        PIC S9(9) COMP-5.
              88 TSK-TX-COMMIT-COMPLETED          VALUE 0.
              88 TSK-TX-COMMIT-DECISION-LOGGED    VALUE 1.
      *> Transaction_control settings
           05 TSK-TRANSACTION-CONTROL  PIC S9(9) COMP-5.
              88 TSK-TX-UNCHAINED     VALUE 0.
              88 TSK-TX-CHAINED       VALUE 1.
      *> Transaction_timeout value
           05 TSK-TRANSACTION-TIMEOUT  PIC S9(9) COMP-5.
              88 NO-TIMEOUT       VALUE 0.
      *> Transaction_state information
           05 TSK-TRANSACTION-STATE    PIC S9(9) COMP-5.
              88 TSK-TX-ACTIVE        VALUE 0.
              88 TSK-TX-TIMEOUT-ROLLBACK-ONLY     VALUE 1.
              88 TSK-TX-ROLLBACK-ONLY             VALUE 2.
      
      
        01 TPTRXLEV-REC.
      *>
      *>  TPTRXLEV.cbl
      *>
        05 TPTRXLEV-FLAG           PIC S9(9) COMP-5.
                88 TP-NOT-IN-TRAN  VALUE 0.
                88 TP-IN-TRAN      VALUE 1.
      *>
      
        01 TPTRXDEF-REC.
      *>
      *>  TPTRXDEF.cbl
      *>
        05 T-OUT        PIC S9(9) COMP-5 VALUE IS 0.
        05 TRANID       OCCURS 6 TIMES PIC S9(9) COMP-5.
      
      
      
      
      
       01  TSK-VARI.                                                    
      
            03 TSK-TERM-ORIGEN    VALUE 'N'           PIC  X(01).       
      
            03 TSK-TRANID.
               05 TSK-TRANID-1                        PIC S9(10).
               05 TSK-TRANID-2                        PIC S9(10).
               05 TSK-TRANID-3                        PIC S9(10).
               05 TSK-TRANID-4                        PIC S9(10).
               05 TSK-TRANID-5                        PIC S9(10).
               05 TSK-TRANID-6                        PIC S9(10).
            03 TSK-TRANID-ALF REDEFINES   TSK-TRANID  PIC  X(60).       
      
            03 TSK-INFO-TRAN.
               05 TSK-INFO-TRANID                     PIC 9(07).
               05 TSK-INFO-TRANID-ALF REDEFINES 
                                    TSK-INFO-TRANID   PIC X(07).        
               05 TSK-INFO-COMMIT                     PIC 9(01).
      
            03 TSK-TERM-NUM               COMP-3      PIC S9(07).       
            03 TSK-TERM-ALF REDEFINES   TSK-TERM-NUM  PIC  X(04).       
      
            03 TSK-TERM-TUX                           PIC  X(256).  
            
            03 TSK-TERM-NUM-TUX                       PIC  9(07).       
            03 TSK-TERM-NUM-TUX-ALF REDEFINES 
                                    TSK-TERM-NUM-TUX  PIC  X(07).       
      
            03 TSK-TERM-NUM-TUX-6                     PIC  9(06).       
            03 TSK-TERM-NUM-TUX-ALF-6 REDEFINES 
                                  TSK-TERM-NUM-TUX-6  PIC  X(06).       
      
      
      
       01  HEADER-VARI.
           03 HEADER-NOM-TSPT.
              05 HEADER-COD-TERM   VALUE 'HE'              PIC X(02).   
              05 HEADER-COD-TYPE   VALUE SPACES            PIC X(06).   
      
       01  HEADER-MENS VALUE SPACES.                              
           03 HEADER-VERS                        PIC X(00004).
           03 HEADER-BNCO                        PIC X(00003).
           03 HEADER-MRCA                        PIC X(00003).
           03 HEADER-CART                        PIC X(00003).
           03 HEADER-LENG                        PIC X(00002).
           03 HEADER-PAIS                        PIC X(00002).
           03 HEADER-VRNT                        PIC X(00001).
           03 HEADER-USER                        PIC X(00012).
           03 HEADER-CNAL                        PIC X(00005).
           03 HEADER-UMUA                        PIC X(00012).
           03 HEADER-PROG                        PIC X(00008).
           03 HEADER-IBYA                        PIC X(00001).
           03 HEADER-BCKI                        PIC X(00001).
           03 HEADER-I24H                        PIC X(00001).
           03 HEADER-MODO                                    
                          REDEFINES HEADER-I24H PIC X(00001).           
           03 HEADER-MNSF                        PIC X(00001).
           03 HEADER-ORIG                        PIC X(00003).
           03 HEADER-MSGC                        PIC X(00001).
           03 HEADER-MSGM                        PIC X(00001).
           03 HEADER-DIS1                        PIC X(00026).
           03 HEADER-IREQ.                                    
              05 HEADER-IR01                     PIC X(00001).
              05 HEADER-IR02                     PIC X(00001).
              05 HEADER-IR03                     PIC X(00001).
              05 HEADER-IR04                     PIC X(00001).
              05 HEADER-IR05                     PIC X(00001).
              05 HEADER-IR06                     PIC X(00001).
              05 HEADER-IR07                     PIC X(00001).
              05 HEADER-IR08                     PIC X(00001).
              05 HEADER-IR09                     PIC X(00001).
              05 HEADER-IR10                     PIC X(00001).
      
      
      
      
       01  MULMSG-VARI.
           03 MULMSG-NOM-TSPT.
              05 MULMSG-COD-TERM   VALUE SPACES  PIC X(04).       
              05 MULMSG-COD-TYPE   VALUE 'MMSG'  PIC X(04).       
      
       01  MULMSG-MENS VALUE SPACES.                              
           03 MULMSG-TIPO                        PIC X(00001).
           03 MULMSG-FORM                        PIC X(00003).
           03 MULMSG-SIST                        PIC X(00003).
           03 MULMSG-CODI                        PIC X(00012).
           03 MULMSG-DATO                        PIC X(01005).
      
      
      
                     
      *>    Variables para manejo de Fechas.                             
      *>    11-OCT-1989 14:10                                            
       01  FEC-VARI.                                                    
      *>    Fecha                                                        
           03 FEC-FECH.                                                 
              05 FEC-ITM1                                 PIC 9(02).    
              05 FEC-ITM2                                 PIC 9(02).    
              05 FEC-ITM3                                 PIC 9(02).    
              05 FEC-ITM4                                 PIC 9(02).    
              05 FILLER                                   PIC X(02).    
           03 FEC-FECH-RED REDEFINES FEC-FECH.                          
              05 FEC-ITM1-RED                             PIC X(02).    
              05 FEC-ITM2-RED                             PIC X(02).    
              05 FEC-ITM3-RED                             PIC X(02).    
              05 FEC-ITM4-RED                             PIC X(02).    
           03 FEC-FECH-RED2 REDEFINES FEC-FECH.                         
              05 FEC-FECH-FDM                             PIC X(04).    
              05 FILLER                                   PIC X(04).    
           03 FEC-FECH-RED3 REDEFINES FEC-FECH.                         
              05 FEC-FECH-CHR                    OCCURS 8 PIC X(01).    
      *>    Fecha de validacion Siglo-Ano-Mes-Dia                        
           03 FEC-FVLD.                                                 
              05 FEC-SVLD                                 PIC 9(02).    
              05 FEC-AVLD                                 PIC 9(02).    
              05 FEC-MVLD                                 PIC 9(02).    
              05 FEC-DVLD                                 PIC 9(02).    
           03 FEC-FVLD-RED REDEFINES FEC-FVLD.                          
              05 FEC-SVLD-RED                             PIC X(02).    
              05 FEC-AVLD-RED                             PIC X(02).    
              05 FEC-MVLD-RED                             PIC X(02).    
              05 FEC-DVLD-RED                             PIC X(02).    
           03 FEC-FVLD-NUM REDEFINES FEC-FVLD.                          
              05 FEC-FANO                                 PIC 9(04).    
              05 FEC-FMES                                 PIC 9(02).    
              05 FEC-FDIA                                 PIC 9(02).    
      *>    Fecha 1                                                      
           03 FEC-FEC1.                                                 
              05 FEC-DEC1                                 PIC 9(02).    
              05 FEC-MEC1                                 PIC 9(02).    
              05 FEC-SEC1                                 PIC 9(02).    
              05 FEC-AEC1                                 PIC 9(02).    
              05 FILLER                                   PIC X(02).    
           03 FEC-FEC1-RED REDEFINES FEC-FEC1.                          
              05 FILLER                                   PIC X(04).    
              05 FEC-FSA1                                 PIC 9(04).    
      *>    Fecha 2                                                      
           03 FEC-FEC2.                                                 
              05 FEC-DEC2                                 PIC 9(02).    
              05 FEC-MEC2                                 PIC 9(02).    
              05 FEC-SEC2                                 PIC 9(02).    
              05 FEC-AEC2                                 PIC 9(02).    
              05 FILLER                                   PIC X(02).    
           03 FEC-FEC2-RED REDEFINES FEC-FEC2.                          
              05 FILLER                                   PIC X(04).    
              05 FEC-FSA2                                 PIC 9(04).    
           03 FEC-FSLH.                                                 
              05 FEC-FSLH-IT1                             PIC X(02).    
              05 FEC-FSLH-SL1                             PIC X(01).    
              05 FEC-FSLH-IT2                             PIC X(02).    
              05 FEC-FSLH-SL2                             PIC X(01).    
              05 FEC-FSLH-IT3                             PIC X(02).    
              05 FEC-FSLH-IT4                             PIC X(02).    
           03 FEC-FSLH-RED REDEFINES FEC-FSLH.                          
              05 FILLER                                   PIC X(05).    
              05 FEC-FSLH-IT5                             PIC X(02).    
              05 FEC-FSLH-IT6                             PIC X(02).    
           03 FEC-IEDT                       VALUE SPACES PIC X(01).    
      *>    Fecha Juliana                                                
           03 FEC-FJUL                           VALUE 0  PIC 9(06).    
      *>    Fecha Juliana auxiliar                                       
           03 FEC-XJUL                           VALUE 0  PIC 9(06).    
      *>    Numero de Anos                                               
           03 FEC-NANO                           VALUE 0  PIC 9(06).    
      *>    Numero de Meses                                              
           03 FEC-NMES                           VALUE 0  PIC 9(06).    
      *>    Numero de Dias                                               
           03 FEC-NDIA                           VALUE 0  PIC 9(06).    
      *>    Numero de Bisiestos                                          
           03 FEC-NABI                           VALUE 0  PIC 9(03).    
      *>    Auxiliar                                                     
           03 FEC-AUXI                           VALUE 0  PIC 9(01).    
      *>    Variables para Current-Date                                  
           03 FEC-SHOY                                    PIC 9(02).    
           03 FEC-FHOY.                                                 
              05 FEC-DHOY                                 PIC 9(02).    
              05 FILLER                                   PIC X(01).    
              05 FEC-MHOY                                 PIC 9(02).    
              05 FILLER                                   PIC X(01).    
              05 FEC-AHOY                                 PIC 9(02).    
           03 FEC-JHOY                                    PIC 9(05).    
           03 FEC-JHOY-RED REDEFINES FEC-JHOY.                          
              05 FEC-AAHY                                 PIC 9(02).    
              05 FEC-DDHY                                 PIC 9(03).    
           03 FEC-HHOY                                    PIC 9(06).    
           03 FEC-HHOY-RED REDEFINES FEC-HHOY.                          
              05 FEC-HHHY                                 PIC 9(02).    
              05 FEC-MMHY                                 PIC 9(02).    
              05 FEC-SSHY                                 PIC 9(02).    
      *>    Mensaje                                                      
           03 FEC-MENS                                    PIC X(79).    
      *>    Resto                                                        
           03 FEC-REST                                    PIC 9(02).    
      *>    Indice                                                       
           03 FEC-SIND                                    PIC 9(02).    
      *>    Formato                                                      
           03 FEC-FORM.                                                 
              05 FEC-FORM-DIA                 VALUE ' '   PIC X(01).    
                 88 FEC-TIENE-DIA             VALUE 'D'.                
              05 FEC-FORM-MES                 VALUE ' '   PIC X(01).    
                 88 FEC-TIENE-MES             VALUE 'M'.                
              05 FEC-FORM-SGL                 VALUE ' '   PIC X(01).    
                 88 FEC-TIENE-SIGLO           VALUE 'S'.                
              05 FEC-FORM-ANO                 VALUE ' '   PIC X(01).    
                 88 FEC-TIENE-ANO             VALUE 'A' 'Q'.            
                 88 FEC-TIENE-QUIEBRE         VALUE 'A'.                
                 88 FEC-NO-TIENE-QUIEBRE      VALUE 'Q'.                
      *>    Para aceptar fecha en blanco o zeroes                        
           03 FEC-FBLK                         VALUE 0    PIC 9(01).    
      *>    Para validar dia habil                                       
           03 FEC-VHBL                         VALUE 0    PIC 9(01).    
      *>    Para comparar con HOY                                        
           03 FEC-CHOY                         VALUE 0    PIC 9(01).    
      *>    Comando                                                      
           03 FEC-CMND                                    PIC X(07).    
      *>    Status                                                       
           03 FEC-STAT.                                                 
              88 FEC-STAT-HBL        VALUE '01'.                        
              88 FEC-STAT-LES        VALUE '03'.                        
              88 FEC-STAT-EQL        VALUE '04'.                        
      *>JSS    88 FEC-STAT-LEQ        VALUE "03" "04".                   
              88 FEC-STAT-GRT        VALUE '05'.                        
              88 FEC-STAT-BLK        VALUE '06'.                        
      *>JSS    88 FEC-STAT-GEQ        VALUE "04" "05".                   
              88 FEC-STAT-OBL        VALUE '70'.                        
              88 FEC-STAT-NN1        VALUE '80'.                        
              88 FEC-STAT-NN2        VALUE '81'.                        
              88 FEC-STAT-SIG        VALUE '91'.                        
              88 FEC-STAT-ANO        VALUE '92'.                        
              88 FEC-STAT-MES        VALUE '93'.                        
              88 FEC-STAT-DIA        VALUE '94'.                        
              88 FEC-STAT-FER        VALUE '95'.                        
              05 FEC-STT1                                 PIC 9(01).    
                 88 FEC-STAT-OKS     VALUE 0.                           
                 88 FEC-STAT-NNU     VALUE 8.                           
                 88 FEC-STAT-ERR     VALUE 9.                           
              05 FEC-STT2                                 PIC 9(01).    
      *>    Constantes para manejo de Fechas.                            
       01  FEC-CTTS.                                                    
      *>    Cantidad de Dias de cada Mes                                 
           03 FEC-VMES VALUE             '312931303130313130313031'.    
              05 FEC-DMES       OCCURS 12                 PIC 9(02).    
      *>    Cantidad de Dias Acumulados en cada Mes                      
           03 FEC-VACU VALUE '031060091121152182213244274305335366'.    
              05 FEC-DACU       OCCURS 12                 PIC 9(03).    
      *>    Dias de la Semana                                            
           03 FEC-VDIA           VALUE                                  
           '  LUNES   MARTES  MIERCOLES JUEVES   VIERNES   SABADO  DOMINGO '.                                                       
              05 FEC-DDIA       OCCURS 7                  PIC X(09).    
      *>    Ano 1                                                        
           03 FEC-ANO1                         VALUE 1800 PIC 9(04).    
      *>    Dia 1 ( Segun L M M J V S D )                                
           03 FEC-DIA1                         VALUE    1 PIC 9(01).    
      *>    Bisiesto 1                                                   
           03 FEC-BST1                         VALUE 1800 PIC 9(04).    
      *>    Constantes de Status                                         
           03 FEC-SOKS                         VALUE  0   PIC 9(01).    
           03 FEC-SHBL                         VALUE '01' PIC X(02).    
           03 FEC-SLES                         VALUE '03' PIC X(02).    
           03 FEC-SEQL                         VALUE '04' PIC X(02).    
           03 FEC-SGRT                         VALUE '05' PIC X(02).    
           03 FEC-SBLK                         VALUE '06' PIC X(02).    
           03 FEC-SOBL                         VALUE '70' PIC X(02).    
           03 FEC-SMAL                         VALUE  9   PIC 9(01).    
           03 FEC-SSIG                         VALUE '91' PIC X(02).    
           03 FEC-SANO                         VALUE '92' PIC X(02).    
           03 FEC-SMES                         VALUE '93' PIC X(02).    
           03 FEC-SDIA                         VALUE '94' PIC X(02).    
           03 FEC-SFER                         VALUE '95' PIC X(02).    
           03 FEC-SNN1                         VALUE '80' PIC X(02).    
           03 FEC-SNN2                         VALUE '81' PIC X(02).    
      *>    Para aceptar fecha en blanco o zeroes                        
           03 FEC-FBLK-S                       VALUE 1    PIC 9(01).    
           03 FEC-FBLK-N                       VALUE 0    PIC 9(01).    
      *>    Para validar dia habil                                       
           03 FEC-VHBL-S                       VALUE 0    PIC 9(01).    
           03 FEC-VHBL-N                       VALUE 1    PIC 9(01).    
      *>    Para comparar con HOY                                        
           03 FEC-CHOY-L                       VALUE 1    PIC 9(01).    
           03 FEC-CHOY-E                       VALUE 2    PIC 9(01).    
           03 FEC-CHOY-G                       VALUE 3    PIC 9(01).    
           03 FEC-CHOY-LE                      VALUE 0    PIC 9(01).    
           03 FEC-CHOY-GE                      VALUE 4    PIC 9(01).    
           03 FEC-CHOY-LG                      VALUE 5    PIC 9(01).    
           03 FEC-CHOY-N                       VALUE 6    PIC 9(01).    
      *>    Formatos de Fechas                                           
           03 FEC-FORM-FEC                    VALUE 'DMSA' PIC X(04).   
           03 FEC-FORM-DMA                    VALUE 'DM A' PIC X(04).   
           03 FEC-FORM-DMQ                    VALUE 'DM Q' PIC X(04).   
           03 FEC-FORM-MSA                    VALUE ' MSA' PIC X(04).   
           03 FEC-FORM-FMA                    VALUE ' M A' PIC X(04).   
           03 FEC-FORM-FMQ                    VALUE ' M Q' PIC X(04).   
           03 FEC-FORM-FSA                    VALUE '  SA' PIC X(04).   
           03 FEC-FORM-FFA                    VALUE '   A' PIC X(04).   
           03 FEC-FORM-FFQ                    VALUE '   Q' PIC X(04).   
      *>    Comandos                                                     
           03 FEC-VAL-FEC       VALUE   'VAL-FEC'         PIC X(07).    
           03 FEC-CMP-FEC       VALUE   'CMP-FEC'         PIC X(07).    
           03 FEC-CMP-HOY       VALUE   'CMP-HOY'         PIC X(07).    
           03 FEC-RET-JUL       VALUE   'RET-JUL'         PIC X(07).    
           03 FEC-RET-FEC       VALUE   'RET-FEC'         PIC X(07).    
           03 FEC-SIG-HBL       VALUE   'SIG-HBL'         PIC X(07).    
      *>MHM INI 24-0CT-2011 PENTA
           03 FEC-ANT-HBL       VALUE   'ANT-HBL'         PIC X(07).    
      *>MHM INI 24-0CT-2011 PENTA
           03 FEC-SUM-DIA       VALUE   'SUM-DIA'         PIC X(07).    
           03 FEC-SUM-MES       VALUE   'SUM-MES'         PIC X(07).    
           03 FEC-SUM-ANO       VALUE   'SUM-ANO'         PIC X(07).    
           03 FEC-RST-DIA       VALUE   'RST-DIA'         PIC X(07).    
           03 FEC-RST-MES       VALUE   'RST-MES'         PIC X(07).    
           03 FEC-RST-ANO       VALUE   'RST-ANO'         PIC X(07).    
           03 FEC-DIF-DIA       VALUE   'DIF-DIA'         PIC X(07).    
           03 FEC-DIF-MES       VALUE   'DIF-MES'         PIC X(07).    
           03 FEC-DIF-ANO       VALUE   'DIF-ANO'         PIC X(07).    
                     
      *> Variables para Current-Date                                     
       01  HOY-VARI.                                                    
           03 HOY-STP-ITRN.                                             
              05 HOY-FHOY.                                              
                 07 HOY-SHOY                      PIC 9(02).            
                 07 HOY-AHOY                      PIC 9(02).            
                 07 HOY-MHOY                      PIC 9(02).            
                 07 HOY-DHOY                      PIC 9(02).            
              05 HOY-HHOY                         PIC 9(06).            
              05 HOY-HHOY-RED REDEFINES HOY-HHOY.                       
                 07 HOY-HHHY                      PIC 9(02).            
                 07 HOY-MMHY                      PIC 9(02).            
                 07 HOY-SSHY                      PIC 9(02).            
                     
      *> Variables para rutina redondeo decimales                        
      *>DAD  14-ABR-1993  AUMENTO A 13 ENTEROS VARIABLES                 
      *>DAD  02-AGO-1994  AGREGADA VARIABLE COD-VCAM                     
       01  PES-VARI.                                                    
           03  PES-NUM-DECI          VALUE ZEROES       PIC 9(01).      
           03  PES-SGV-DECI             COMP-3          PIC S9(13)V9(4).
           03  PES-SGV-ENTE             COMP-3          PIC S9(13)V9(4).
           03  PES-SGV-ENT0             COMP-3          PIC S9(13).     
           03  PES-SGV-ENT1             COMP-3          PIC S9(13)V9(1).
           03  PES-SGV-ENT2             COMP-3          PIC S9(13)V9(2).
           03  PES-SGV-ENT3             COMP-3          PIC S9(13)V9(3).
           03  PES-COD-VCAM VALUE SPACES                PIC X(06).      
           03  PES-CIC-VCAM VALUE SPACES.                               
               04 PES-CIC-TVAL                          PIC X(01).      
               04 PES-CIC-CVAL                          PIC X(03).      
               04 PES-CIC-TCAM                          PIC X(08).      
                                                                        
      *> ISP: INDEPENDENCIA DE CICS DE MONEDAS                           
       01  PDB-VARI.                                                    
      *>    03  PDB-CIC-0999     VALUE "0999  "   PIC X(06).             
           03  PDB-CIC-0999     VALUE '0999  '   PIC X(06).             
                                                                        
      *>    03  PDB-CIC-0998     VALUE "0998  "   PIC X(06).             
           03  PDB-CIC-0998     VALUE '0998  '   PIC X(06).             
                                                                        
           03  PDB-CIC-0013     VALUE '0994  '   PIC X(06).             
      *>    03  PDB-CIC-0013     VALUE "0013  "   PIC X(06).             
                                                                        
      *>    03  PDB-CIC-1013     VALUE "1013  "   PIC X(06).             
           03  PDB-CIC-1013     VALUE '1013  '   PIC X(06).             
                                                                        
      *>    03  PDB-CIC-MNAC     VALUE "0"        PIC X(01).             
           03  PDB-CIC-MNAC     VALUE '0'        PIC X(01).             
                                                                        
      *>    03  PDB-CIC-MEXT     VALUE "1"        PIC X(01).             
           03  PDB-CIC-MEXT     VALUE '1'        PIC X(01).             
                                                                        
      *>    03  PDB-COD-TVAL-DOLO   VALUE "01"    PIC X(02).             
           03  PDB-COD-TVAL-DOLO   VALUE '01'    PIC X(02).             
                                                                        
                     
      *>                                                                 
       01  QUE-VARI.                                                    
           03 QUE-COLA.                                                 
              05 QUE-TERM                              PIC  X(04).      
              05 QUE-TYPE                              PIC  X(04).      
           03 QUE-NITM       COMP VALUE +0             PIC S9(04).      
           03 QUE-LITM       COMP                      PIC S9(04).      
           03 QUE-ITEM.                                                 
              05 QUE-IKEY                              PIC  X(03).      
              05 QUE-LDAT    COMP VALUE +0             PIC S9(04).      
              05 QUE-PCUR    COMP VALUE +0             PIC S9(04).      
              05 QUE-DATA                              PIC  X(3000).    
           03 QUE-STAT            VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-OKS        VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-NEX        VALUE 'NEX'          PIC  X(03).      
           03 QUE-STAT-EOQ        VALUE 'EOQ'          PIC  X(03).      
           03 QUE-CMND                                 PIC  X(03).      
           03 QUE-MENS.                                                 
              05 QUE-MEN1                              PIC  X(40).      
              05 QUE-MEN2                              PIC  X(39).
           01 QUE-NUM-STAT                             PIC  S9(09).
           01 QUE-GLS-STAT                             PIC  S9(09).
              
       01  QUE-CTTS.                                                    
           03 QUE-PUT             VALUE 'PUT'          PIC  X(03).      
           03 QUE-GET             VALUE 'GET'          PIC  X(03).      
           03 QUE-MOD             VALUE 'MOD'          PIC  X(03).      
           03 QUE-DEL             VALUE 'DEL'          PIC  X(03).      
      
       01  QUE-SEND.                                                    
           03 QUE-COM-SEND                             PIC  X(03).      
           03 QUE-NAM-SEND                             PIC  X(300).     
           03 QUE-NUM-SEND                             PIC  9(04).      
           03 QUE-LAR-SEND                             PIC  9(04).      
           03 QUE-TRX-SEND                             PIC  X(256).     
           03 QUE-DAT-SEND                             PIC  X(9000).    
      
       01  QUE-RECV.                                                    
           03 QUE-FIL-RECV                             PIC  9(02).      
           03 QUE-STA-RECV                             PIC  9(18).      
           03 QUE-NUM-RECV                             PIC  9(04).      
           03 QUE-LAR-RECV                             PIC  9(04).      
           03 QUE-TRX-RECV                             PIC  X(256).     
           03 QUE-DAT-RECV                             PIC  X(9000).    
      
       01  QUE-TPTYPE-REC-SEND.
           05 QUE-REC-SEND-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-SEND-SUB-TYPE                 PIC X(16).
           05 QUE-REC-SEND-LEN       VALUE 9568     PIC S9(9) COMP-5.
           05 QUE-REC-SEND-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-SEND-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-SEND-TPTRUNCATE   VALUE 1.
      
       01  QUE-TPTYPE-REC-RECV.
           05 QUE-REC-RECV-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-RECV-SUB-TYPE                 PIC X(16).
           05 QUE-REC-RECV-LEN       VALUE 9285     PIC S9(9) COMP-5.
           05 QUE-REC-RECV-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-RECV-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-RECV-TPTRUNCATE   VALUE 1.
              
       01 QUE-TPSVCDEF-REC.
       05 QUE-COMM-HANDLE          PIC S9(9) COMP-5.
       05 QUE-TPBLOCK-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPBLOCK         VALUE 0.
               88 QUE-TPNOBLOCK       VALUE 1.
       05 QUE-TPTRAN-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTRAN          VALUE 0.
               88 QUE-TPNOTRAN        VALUE 1.
       05 QUE-TPREPLY-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPREPLY         VALUE 0.
               88 QUE-TPNOREPLY       VALUE 1.
       05 QUE-TPACK-FLAG         REDEFINES QUE-TPREPLY-FLAG.
          10 FILLER PIC S9(9) COMP-5.
               88 QUE-TPNOACK         VALUE 0.
               88 QUE-TPACK           VALUE 1.
       05 QUE-TPTIME-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTIME          VALUE 0.
               88 QUE-TPNOTIME        VALUE 1.
       05 QUE-TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPNOSIGRSTRT    VALUE 0.
               88 QUE-TPSIGRSTRT      VALUE 1.
       05 QUE-TPGETANY-FLAG        PIC S9(9) COMP-5.
               88 QUE-TPGETHANDLE     VALUE 0.
               88 QUE-TPGETANY        VALUE 1.
       05 QUE-TPSENDRECV-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPSENDONLY      VALUE 0.
               88 QUE-TPRECVONLY      VALUE 1.
       05 QUE-TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPCHANGE        VALUE 0.
               88 QUE-TPNOCHANGE      VALUE 1.
       05 QUE-TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
               88 QUE-TPREQRSP       VALUE IS 0.
               88 QUE-TPCONV         VALUE IS 1.
       05 QUE-APPKEY               PIC S9(9) COMP-5.
       05 QUE-CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
       05 QUE-SERVICE-NAME   VALUE "ts" PIC X(127).
      
      
      
      *> VARIABLES PARA ENGANCHE PROGRAMAS COMENTARIOS                   
       01  KEY-VARI.                                                    
      *>    ENTIDAD                                                      
           03 KEY-COD-ENTI                             PIC X(03).       
      *>    NOMBRE                                                       
           03  KEY-GLS-NOMC                            PIC X(60).       
      *>    RUT                                                          
           03  KEY-CIC-IRUT.                                            
               05  KEY-NUM-ICLI                        PIC 9(08).       
               05  KEY-VRF-ICLI                        PIC X(01).       
               05  KEY-IND-ICLI                        PIC X(01).       
               05  KEY-GLS-ICLI                        PIC X(03).       
      *>    CIC OPE                                                      
           03  KEY-CIC-IOPE.                                            
               05  KEY-CAI-IOPE                        PIC X(04).       
               05  KEY-IIC-IOPE                        PIC X(08).       
      *>    FECHA                                                        
           03  KEY-FEC-FENT.                                            
               05 KEY-NUM-DENT                         PIC 9(02).       
               05 KEY-NUM-MENT                         PIC 9(02).       
               05 KEY-NUM-SENT                         PIC 9(02).       
               05 KEY-NUM-AENT                         PIC 9(02).       
      *>    CORRELATIVO                                                  
           03 KEY-NUM-IENT                             PIC 9(03).       
      *>    CODIGO                                                       
           03 KEY-COD-IENT                             PIC X(03).       
      *>    FECHA COMENTARIO                                             
           03  KEY-FEC-FCMT.                                            
               05 KEY-NUM-DCMT                         PIC 9(02).       
               05 KEY-NUM-MCMT                         PIC 9(02).       
               05 KEY-NUM-SCMT                         PIC 9(02).       
               05 KEY-NUM-ACMT                         PIC 9(02).       
      *>    CORRELATIVO COMENTARIO                                       
           03 KEY-NUM-GCMT                             PIC 9(03).       
      *>    USUARIO                                                      
           03 KEY-COD-USER                             PIC X(12).       
                     
      *>    Registro Generico de Mensajes                                
      *>    -----------------------------                                
      *>                                                                 
      *>    Nombre Registro : MSG                                        
      *>    Clave(s)        : MSG-KY0-TABS(UU),
      *>                      MSG-KY1-TABS(UU), MSG-KY2-TABS(UU)
      *>    Largo           : 206
      *>    Bloqueo         : 2                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  MSG.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  MSG-GLS-FLAG                             PIC X(01).      
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  MSG-KEY-IREG.                                            
      *>                                                                 
      *>KEY     Tipo + Codigo ( LLave Primaria )                         
               05  MSG-KY0-TABS.
                   07  MSG-COD-TABL.
      *>                                                                 
      *>            Codigo Tipo Tabla                                    
                       09  MSG-COD-TTAB                     PIC X(03).
      *>                                                                 
      *>            Codigo Mensaje                                       
                       09  MSG-COD-MENS.
      *>                                                                 
      *>                Tipo Mensaje                                     
                           11  MSG-COD-TMSG                 PIC X(07).
      *>                                                                 
      *>                Codigo Mensaje                                   
                           11  MSG-COD-CMSG                 PIC X(05).
      *>                                                                 
      *>        Time Stamp Transaccion                                   
               05  MSG-COD-ITRS.
                   07  MSG-STP-ITRN.
      *>                                                                 
      *>            Fecha Transaccion                                    
                       09  MSG-FEC-FTRN.
                           11  MSG-NUM-STRN                 PIC 9(02).
                           11  MSG-NUM-ATRN                 PIC 9(02).
                           11  MSG-NUM-MTRN                 PIC 9(02).
                           11  MSG-NUM-DTRN                 PIC 9(02).
      *>                                                                 
      *>            Hora Transaccion                                     
                       09  MSG-HRA-HRTR.
                           11  MSG-NUM-HHTR                 PIC 9(02).
                           11  MSG-NUM-MMTR                 PIC 9(02).
                           11  MSG-NUM-SSTR                 PIC 9(02).
      *>                                                                 
      *>    Indicador Tipo Accion                                        
           03  MSG-MSC-TACC                             PIC X(01).      
      *>                                                                 
      *>    Indicador Status                                             
           03  MSG-MSC-STAT                             PIC X(01).      
      *>                                                                 
      *>    Indicador Vigencia                           GNS VIGE        
           03  MSG-IND-VIGE  REDEFINES  MSG-MSC-STAT    PIC X(01).      
      *>                                                                 
      *>    Codigo Origen Transaccion                                    
           03  MSG-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  MSG-MSC-TTRN                         PIC X(01).      
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  MSG-COD-TTRN                         PIC X(03).      
      *>                                                                 
      *>    Autor Transaccion                                            
           03  MSG-COD-ATRN                             PIC X(12).      
      *>                                                                 
      *>KEY Tipo + Codigo ( Interno Computacional )                      
           03  MSG-KY1-TABS.
               05  MSG-CIC-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  MSG-CIC-TTAB                         PIC X(03).
      *>                                                                 
      *>        Codigo Mensaje                                           
                   07  MSG-CIC-MENS.
      *>                                                                 
      *>            Tipo Mensaje                                         
                       09  MSG-CIC-TMSG                     PIC X(07).
      *>                                                                 
      *>            Codigo Mensaje                                       
                       09  MSG-CIC-CMSG                     PIC X(05).
      *>                                                                 
      *>    Codigo Externo                                               
           03  MSG-KY2-TABS.
               05  MSG-EXT-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  MSG-EXT-TTAB                         PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  MSG-EXT-CTAB                         PIC X(05).
      *>                                                                 
      *>    Descripcion Corta                                            
           03  MSG-GLS-DCOR                             PIC X(12).      
      *>                                                                 
      *>    Abreviacion Descripcion                                      
           03  MSG-GLS-ABRV                             PIC X(05).      
      *>                                                                 
      *>    Descripcion del Codigo                                       
           03  MSG-GLS-DESC.                                            
               05  MSG-GLS-DES1                         PIC X(20).      
               05  MSG-GLS-DES2                         PIC X(20).      
      *>                                                                 
      *>    Datos Anexos                                                 
           03  MSG-GLS-DATA.                                            
      *>                                                                 
      *>        Glosa Mensaje                                            
               05  MSG-GLS-MENS                         PIC X(40).      
      *>                                                                 
      *>        Disponible                                               
               05  MSG-GLS-DISP                         PIC X(20).      
      *>                                                                 
      *>    Clave Soundex                                                
           03  MSG-SNX-TABL.                                            
               05  MSG-SNX-TTAB                         PIC X(03).      
               05  MSG-SNX-MENS                         PIC X(03).      
      *>                                                                 
      *>    Variables de Mensajes                                        
       01  MSG-VARI.                                                    
      *>                                                                 
      *>    Nombre de Programa FIO para Mensajes                         
           03  MSG-GLS-FMSG.                                            
      *>                                                                 
      *>        Codigo Sistema                                           
               05  MSG-COD-SIST                         PIC X(03).      
      *>                                                                 
      *>        Nombre "fijo" de FIO Mensajes                            
               05  MSG-COD-FMSG           VALUE 'PFTAB' PIC X(05).      
      *>
                     
      *> COPY GNSBRTAB.                                                  
      *>    Registro Generico de Tablas                                  
      *>    NECESARIO PARA COMPILAR CICS RESCATADO EL 02.07.98.          
      *>    ---------------------------                                  
      *>                                                                 
      *>    Nombre Registro : TAB                                        
      *>    Clave(s)        : TAB-KY0-TABS(UU),
      *>                      TAB-KY1-TABS(UU), TAB-KY1-TABS(DC)
      *>    Largo           : 206
      *>    Bloqueo         : 2                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  TAB.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  TAB-GLS-FLAG                             PIC X(01).      
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  TAB-KEY-IREG.                                            
      *>                                                                 
      *>KEY     Tipo + Codigo ( LLave Primaria )                         
               05  TAB-KY0-TABS.
                   07  TAB-COD-TABL.
      *>                                                                 
      *>            Codigo Tipo Tabla                                    
                       09  TAB-COD-TTAB                 PIC X(03).
      *>                                                                 
      *>            Codigo Tabla                                         
                       09  TAB-COD-CTAB                 PIC X(12).
      *>                                                                 
      *>        Time Stamp Transaccion                                   
               05  TAB-COD-ITRS.
                   07  TAB-STP-ITRN.
      *>                                                                 
      *>            Fecha Transaccion                                    
                       09  TAB-FEC-FTRN.
                           11  TAB-NUM-STRN             PIC 9(02).
                           11  TAB-NUM-ATRN             PIC 9(02).
                           11  TAB-NUM-MTRN             PIC 9(02).
                           11  TAB-NUM-DTRN             PIC 9(02).
      *>                                                                 
      *>            Hora Transaccion                                     
                       09  TAB-HRA-HRTR.
                           11  TAB-NUM-HHTR             PIC 9(02).
                           11  TAB-NUM-MMTR             PIC 9(02).
                           11  TAB-NUM-SSTR             PIC 9(02).
      *>                                                                 
      *>    Indicador Tipo Accion                                        
           03  TAB-MSC-TACC                             PIC X(01).      
      *>                                                                 
      *>    Indicador Status                                             
           03  TAB-MSC-STAT                             PIC X(01).      
      *>                                                                 
      *>    Indicador Vigencia                           GNS VIGE        
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).      
      *>                                                                 
      *>    Codigo Origen Transaccion                                    
           03  TAB-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  TAB-MSC-TTRN                         PIC X(01).      
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  TAB-COD-TTRN                         PIC X(03).      
      *>                                                                 
      *>    Autor Transaccion                                            
           03  TAB-COD-ATRN                             PIC X(12).      
      *>                                                                 
      *>KEY Tipo + Codigo ( Interno Computacional )                      
           03  TAB-KY1-TABS.
               05  TAB-CIC-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-CIC-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-CIC-CTAB                     PIC X(12).
      *>                                                                 
      *>    Codigo Externo                                               
           03  TAB-KY2-TABS.
               05  TAB-EXT-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-EXT-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-EXT-CTAB                     PIC X(05).
      *>                                                                 
      *>    Descripcion Corta                                            
           03  TAB-GLS-DCOR                             PIC X(12).      
      *>                                                                 
      *>    Abreviacion Descripcion                                      
           03  TAB-GLS-ABRV                             PIC X(05).      
      *>                                                                 
      *>    Descripcion del Codigo                                       
           03  TAB-GLS-DESC                             PIC X(40).      
      *>                                                                 
      *>    Datos Anexos                                                 
           03  TAB-GLS-DATA.                                            
               05  TAB-GLS-DAT1.                                        
                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).      
               05  TAB-GLS-DAT2.                                        
                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).      
               05  TAB-GLS-DAT3.                                        
                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).      
      *>                                                                 
      *>    Clave Soundex                                                
           03  TAB-SNX-TABL.                                            
               05  TAB-SNX-TTAB                         PIC X(03).      
               05  TAB-SNX-CTAB                         PIC X(03).      
      *>                                                                 
      *>    Variables de Tablas                                          
       01  TAB-VARI.                                                    
      *>                                                                 
      *>    Nombre de Programa FIO para TABlas                           
           03  TAB-GLS-FTAB.                                            
      *>                                                                 
      *>        Codigo Sistema                                           
               05  TAB-COD-SIST                         PIC X(03).      
      *>                                                                 
      *>        Nombre "fijo" de FIO TABlas                              
               05  TAB-COD-FTAB           VALUE 'PFTAB' PIC X(05).      
      *>
                     
      *>    Registro Generico de Miscelaneos                             
      *>    --------------------------------                             
      *>                                                                 
      *>    Nombre Registro : MSC                                        
      *>    Clave(s)        : MSC-KY0-TABS(UU),
      *>                      MSC-KY1-TABS(UU), MSC-KY2-TABS(DC)
      *>    Largo           : 206
      *>    Bloqueo         : 2                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  MSC.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  MSC-GLS-FLAG                             PIC X(01).      
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  MSC-KEY-IREG.                                            
      *>                                                                 
      *>KEY     Tipo + Codigo ( LLave Primaria )                         
               05  MSC-KY0-TABS.
                   07  MSC-COD-TABL.
      *>                                                                 
      *>            Codigo Tipo Tabla                                    
                       09  MSC-COD-TTAB                 PIC X(03).
      *>                                                                 
      *>            Codigo Miscelaneo                                    
                       09  MSC-COD-MSCL.
      *>                                                                 
      *>                Tipo Miscelaneo                                  
                           11  MSC-COD-TMSC             PIC X(04).
      *>                                                                 
      *>                Codigo Miscelaneo                                
                           11  MSC-COD-CMSC             PIC X(08).
      *>                                                                 
      *>        Time Stamp Transaccion                                   
               05  MSC-COD-ITRS.
                   07  MSC-STP-ITRN.
      *>                                                                 
      *>            Fecha Transaccion                                    
                       09  MSC-FEC-FTRN.
                           11  MSC-NUM-STRN             PIC 9(02).
                           11  MSC-NUM-ATRN             PIC 9(02).
                           11  MSC-NUM-MTRN             PIC 9(02).
                           11  MSC-NUM-DTRN             PIC 9(02).
      *>                                                                 
      *>            Hora Transaccion                                     
                       09  MSC-HRA-HRTR.
                           11  MSC-NUM-HHTR             PIC 9(02).
                           11  MSC-NUM-MMTR             PIC 9(02).
                           11  MSC-NUM-SSTR             PIC 9(02).
      *>                                                                 
      *>    Indicador Tipo Accion                                        
           03  MSC-MSC-TACC                             PIC X(01).      
      *>                                                                 
      *>    Indicador Status                                             
           03  MSC-MSC-STAT                             PIC X(01).      
      *>                                                                 
      *>    Indicador Vigencia                           GNS VIGE        
           03  MSC-IND-VIGE  REDEFINES  MSC-MSC-STAT    PIC X(01).      
      *>                                                                 
      *>    Codigo Origen Transaccion                                    
           03  MSC-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  MSC-MSC-TTRN                         PIC X(01).      
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  MSC-COD-TTRN                         PIC X(03).      
      *>                                                                 
      *>    Autor Transaccion                                            
           03  MSC-COD-ATRN                             PIC X(12).      
      *>                                                                 
      *>KEY Tipo + Codigo ( Interno Computacional )                      
           03  MSC-KY1-TABS.
               05  MSC-CIC-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  MSC-CIC-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Miscelaneo                                        
                   07  MSC-CIC-MSCL.
      *>                                                                 
      *>            Tipo Miscelaneo                                      
                       09  MSC-CIC-TMSC                 PIC X(04).
      *>                                                                 
      *>            Codigo Miscelaneo                                    
                       09  MSC-CIC-CMSC                 PIC X(08).
      *>                                                                 
      *>    Codigo Externo                                               
           03  MSC-KY2-TABS.
               05  MSC-EXT-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  MSC-EXT-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  MSC-EXT-CTAB.
      *>                                                                 
      *>            Tipo Miscelaneo                                      
                       09  MSC-EXT-TMSC                 PIC X(04).
      *>                                                                 
      *>            Codigo Miscelaneo                                    
                       09  MSC-EXT-CMSC                 PIC X(01).
      *>                                                                 
      *>    Descripcion Corta                                            
           03  MSC-GLS-DCOR                             PIC X(12).      
      *>                                                                 
      *>    Abreviacion Descripcion                                      
           03  MSC-GLS-ABRV                             PIC X(05).      
      *>                                                                 
      *>    Descripcion del Codigo                                       
           03  MSC-GLS-DESC                             PIC X(40).      
      *>                                                                 
      *>    Datos Anexos                                                 
           03  MSC-GLS-DATA.                                            
      *>                                                                 
      *>        Glosa Mensaje                                            
               05  MSC-GLS-MENS                         PIC X(40).      
      *>                                                                 
      *>        Codigo Mensaje                                           
               05  MSC-COD-MENS                         PIC X(12).      
      *>                                                                 
      *>        Disponible                                               
               05  MSC-GLS-DISP                         PIC X(08).      
      *>                                                                 
           03  MSC-GLS-DATA-RED REDEFINES MSC-GLS-DATA.                 
               05  MSC-GLS-DAT1.                                        
                   07  MSC-COD-DAT1     OCCURS 10       PIC X(01).      
               05  MSC-GLS-DAT2.                                        
                   07  MSC-COD-DAT2     OCCURS 10       PIC X(02).      
               05  MSC-GLS-DAT3.                                        
                   07  MSC-COD-DAT3     OCCURS 10       PIC X(03).      
      *>                                                                 
      *>    Clave Soundex                                                
           03  MSC-SNX-TABL.                                            
               05  MSC-SNX-TTAB                         PIC X(03).      
               05  MSC-SNX-MSCL                         PIC X(03).      
      *>                                                                 
      *>    Variables Miscelaneas                                        
       01  MSC-VARI.                                                    
      *>                                                                 
      *>    Codigo Sistema                                               
           03  MSC-COD-SIST                             PIC X(03).      
      *>
                     
      *>    Request Area                                                 
       01  ADR-MSG-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>    Request Area                                                 
       01  ADR-TAB-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>    Request Area                                                 
       01  ADR-MSC-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      
      *> Variables para Codigo Interno Computacional                     
       01  CIC-VARI.                                                    
      *>                                                                 
      *>    Digito Verificador                                           
           03  CIC-DVRF                                 PIC X(01).      
      *>                                                                 
      *>    Status de Retorno                                            
           03  CIC-STAT                    VALUE SPACES PIC X(03).      
      *>                                                                 
      *>    Mensaje                                                      
           03  CIC-MENS                                 PIC X(80).      
      *>                                                                 
      *>    Comando                                                      
           03  CIC-CMND         COMP                    PIC 9(04).      
      *>                                                                 
      *> Constantes para Codigo Interno Computacional                    
       01  CIC-CTTS.                                                    
           03  CIC-GET          COMP    VALUE 1         PIC 9(04).      
           03  CIC-INI          COMP    VALUE 2         PIC 9(04).      
           03  CIC-FIN          COMP    VALUE 3         PIC 9(04).      
           03  CIC-STAT-OKS             VALUE SPACES    PIC X(05).      
      *>PGV 03  CIC-STAT-MAL             VALUE NOT SPACESPIC X(05).      
           03  CIC-STAT-NEX             VALUE 'NEX'     PIC X(05).      
           03  CIC-STAT-NVG             VALUE 'NVG'     PIC X(05).      
           03  CIC-STAT-ERR             VALUE 'ERR'     PIC X(05).      
           03  CIC-STAT-CNV             VALUE 'CNV'     PIC X(05).      
                     
      *>    Constantes para VRF                                          
       01  VRF-CTTS.                                                    
      *>    Verificador "K"                                              
           03 VRF-SVRF-K                VALUE 0         PIC 9(01).      
      *>    Verificador "0"                                              
           03 VRF-SVRF-0                VALUE 1         PIC 9(01).      
      *>    Verificador "1"                                              
           03 VRF-SVRF-1                VALUE 2         PIC 9(01).      
      *>    Validacion dado un Numero y su Verificador                   
           03 VRF-VAL           COMP    VALUE 1         PIC 9(04).      
      *>    Obtencion del Verificador para un Numero dado.               
           03 VRF-GET           COMP    VALUE 2         PIC 9(04).      
      *>    No acepta numero en cero                                     
           03 VRF-ZERO-N                VALUE 0         PIC 9(01).      
      *>    Si acepta numero en cero                                     
           03 VRF-ZERO-S                VALUE 1         PIC 9(01).      
      *>    Status BLK                                                   
           03 VRF-SBLK                  VALUE 2         PIC 9(01).      
                     
      *>    Variables para VRF                                           
       01  VRF-VARI.                                                    
      *>    Numero + Digito Verificador                                  
           03 VRF-NUDV          JUST RIGHT              PIC X(13).      
           03 VRF-NUDV-RED REDEFINES VRF-NUDV.                          
      *>       Numero                                                    
              05 VRF-NUME                               PIC 9(12).      
              05 VRF-NUME-RED REDEFINES VRF-NUME.                       
                 07 VRF-DIGI OCCURS 12                  PIC 9(01).      
      *>       Digito Verificador                                        
              05 VRF-DVRF                               PIC X(01).      
      *>    Switch para Verificador "K" o "0"                            
           03 VRF-SVRF                                  PIC 9(01).      
      *>    Status de Retorno                                            
           03 VRF-STAT                                  PIC 9(01).      
              88 VRF-STAT-OKS           VALUE 0.                        
              88 VRF-STAT-MAL           VALUE 1 THRU 9.                 
              88 VRF-STAT-NUM           VALUE 1.                        
              88 VRF-STAT-BLK           VALUE 2.                        
              88 VRF-STAT-VRF           VALUE 3.                        
      *>    Switch para que acepte o no numero en cero                   
           03 VRF-ZERO                  VALUE 0         PIC 9(01).      
      *>    Mensaje de Retorno                                           
           03 VRF-CMSG                  VALUE SPACES    PIC X(12).      
      *>    Comando                                                      
           03 VRF-CMND          COMP                    PIC 9(04).      
      *>    Limite superior                                              
           03 VRF-LMAX          COMP                    PIC 9(04).      
      *>    INDICADOR SI D.V. VIENE EN ULTIMO DIGITO DEL NUMERO
           03 VRF-SFDV                                  PIC X(01).
           
                     
       01 IDM-CMMA.
           03 IDM-RIDD.
               05 IDM-QIDD.
                   07 IDM-QUEU            VALUE SPACES PIC X(04).
                   07 IDM-TERM            VALUE SPACES PIC X(04).
               05 IDM-LIDD          COMP VALUE ZEROES PIC S9(04).
           03 IDM-ENTR.
               05 IDM-SIST                             PIC X(03).
               05 IDM-KEY-TAB.
                   07 IDM-OPCI                         PIC X(09).
                   07 IDM-CANA                         PIC X(03).
           03 IDM-SALI.
               05 IDM-IND-ERROR           VALUE SPACES PIC X(01).
               05 IDM-COD-ERROR           VALUE SPACES PIC X(12).
               05 IDM-GLS-ERROR           VALUE SPACES PIC X(40).
               05 IDM-SEDE                VALUE SPACES PIC X(12).
               05 IDM-FUNC                VALUE SPACES PIC X(40).
               05 IDM-VIGE                VALUE SPACES PIC X(01).
      *>--------------------------------------------------------------
       01 IDM-VARI.
           03 IDM-TCMA             VALUE +3000      PIC S9(04).
                     
      
       01 WCC-VARI.
           03 WCC-S               VALUE 'S'          PIC X(01).
           03 WCC-GNSPPIDM        VALUE 'GNSPPIDM'   PIC X(08).
           03 WCC-KEYNOEXI        VALUE 'KEYNOEXI'   PIC X(08).
           03 WCC-IDM             VALUE 'IDM'        PIC X(03).
      
      *>INI-MFC TUXEDO ORACLE
      *> LINKAGE SECTION.
      
                     
      *>FIN-MFC TUXEDO ORACLE
      *>----------------
       01  DFHCOMMAREA.
           03 FILLER                          PIC X(3000).
      *>GNSLGFIO CB2                                                     
       01  FIO-BUF0.                                                    
           02 FILLER                 PIC X(1536).                       
                     
      
       PROCEDURE DIVISION.
      *>===================
       MAIN SECTION.
       INI-MAIN.
      *>INI-MFC TUXEDO ORACLE
            PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *>FIN-MFC TUXEDO ORACLE
       
           MOVE LENGTH OF LOGMSG TO LOGMSG-LEN. 
      
           MOVE 'TPSVCSTART       '       TO LOGMSG-TEXT.
           MOVE '00'                      TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
           MOVE LENGTH OF DFHCOMMAREA TO LEN.
           MOVE LENGTH OF DFHCOMMAREA TO EIBCALEN.
           CALL "TPSVCSTART" USING TPSVCDEF-REC 
                        TPTYPE-REC 
                        DFHCOMMAREA
                        TPSTATUS-REC.      
      
           IF NOT TPOK
                MOVE "TPSVCSTART Failed" TO LOGMSG-TEXT
                    PERFORM DO-USERLOG 
                PERFORM PRG-ABT 
           END-IF.
      
      *>     IF TPTRUNCATE 
      *>          MOVE "Data was truncated" TO LOGMSG-TEXT
      *>              PERFORM DO-USERLOG 
      *>          PERFORM PRG-ABT 
      *>     END-IF.
      
           IF EIBCALEN = 0                                              
                 GOBACK.                                                
                      
           CALL "TPGETLEV" USING TPTRXLEV-REC TPSTATUS-REC. 
           IF NOT TPOK
              DISPLAY 'ERROR  TPGETLEV :' TP-STATUS
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'TPGETLEV TP-NOT-IN-TRAN:' TP-STATUS.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC TPSTATUS-REC.            
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
           
           CALL "TPRESUME" USING TPTRXDEF-REC TPSTATUS-REC.             
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           MOVE TRANID(1)           TO TSK-TRANID-1.
           MOVE TRANID(2)           TO TSK-TRANID-2.
           MOVE TRANID(3)           TO TSK-TRANID-3.
           MOVE TRANID(4)           TO TSK-TRANID-4.
           MOVE TRANID(5)           TO TSK-TRANID-5.
           MOVE TRANID(6)           TO TSK-TRANID-6.
           MOVE 'S'                 TO TSK-TERM-ORIGEN.
           MOVE SPACES              TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF      TO TSK-TERM-TUX.
           MOVE TSK-TERM-TUX        TO TSK-TERM-TUX.                    
           MOVE 'GET'               TO QUE-COM-SEND.                    
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.      
           MOVE 1                   TO QUE-NUM-SEND.      
           MOVE 4                   TO QUE-LAR-SEND.      
           MOVE SPACES              TO QUE-TRX-SEND.      
           MOVE SPACES              TO QUE-DAT-SEND.                    
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              DISPLAY 'NO ENCONTRO COLA ASUME 1111111 :' TSK-TERM-TUX  
              MOVE 1111111          TO TSK-TERM-NUM-TUX
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-NUM     TO EIBTASKN
              MOVE TSK-TERM-ALF     TO EIBTRMID
           ELSE           
              MOVE QUE-DAT-RECV     TO QUE-ITEM           
              MOVE QUE-DATA         TO TSK-TERM-NUM-TUX-ALF
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-ALF     TO EIBTASKN
              MOVE TSK-TERM-ALF     TO EIBTRMID.
                     
      *>     ENTRY "DBMSCBL".                                            
                                                                        
                     
           MOVE DFHCOMMAREA(1:EIBCALEN) TO IDM-CMMA.
           DISPLAY 'EIBCALEN : ' EIBCALEN.
           DISPLAY 'DFHCOMMAREA : ' DFHCOMMAREA(1:EIBCALEN).
           MOVE WCC-GNSPPIDM TO FIO-PROG.
           MOVE IDM-QIDD TO SCR-QIDD.
           MOVE IDM-LIDD TO SCR-LIDD.
           MOVE IDM-SIST  TO SCR-SIST.
           DISPLAY 'PPIDM 001'.
           PERFORM GNS-BUS-IDD.
           DISPLAY 'PPIDM 002'.
           PERFORM GNS-ERR-QUE.
           DISPLAY 'PPIDM 003'.
      
      *>RGD-INI
           PERFORM GET-TSK-TERM.
           DISPLAY 'PPIDM 004'.
      *>RGD-FIN
           PERFORM BUS-SEDE-RESP.
           DISPLAY 'PPIDM 005'.
           MOVE IDM-CMMA TO DFHCOMMAREA(1:EIBCALEN).
        FIN-MAIN.
      *>INI-PENTA TUXEDO ORACLE
      *>     EXEC CICS RETURN END-EXEC.
           MOVE +0 TO EIBRESP.
      *>         EXEC CICS
      *>         RETURN
      *>     END-EXEC.
      
           MOVE LENGTH OF DFHCOMMAREA TO LEN
           SET TPSUCCESS TO TRUE
           CALL "TPRETURN" USING TPSVCRET-REC
                                 TPTYPE-REC
                                 DFHCOMMAREA
                                 TPSTATUS-REC
           IF NOT TPOK
                DISPLAY 'TPCALL TP-STATUS :' TP-STATUS
                GOBACK
           ELSE
                GOBACK.
                     
           GOBACK.                                                      
                                                                        
                     
           EXIT.
      *>FIN-PENTA TUXEDO ORACLE
      *>----------------------------------------------------------------
       BUS-SEDE-RESP SECTION.
       INI-BUS-SEDE-RESP.
      
           MOVE SPACES TO IDM-SALI.
      
           MOVE IDM-SIST TO FIO-SIST TAB-COD-SIST.
           MOVE WCC-IDM TO TAB-COD-TTAB IN TAB.
           MOVE IDM-KEY-TAB TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           DISPLAY 'PPIDM 0041:' TAB '>'.
           PERFORM GNS-FIO-TAB.
           DISPLAY 'PPIDM 0042'.
           IF NOT FIO-STAT-OKS
               MOVE WCC-S TO IDM-IND-ERROR
               MOVE WCC-KEYNOEXI TO IDM-COD-ERROR
               MOVE WCC-KEYNOEXI TO MSG-COD-MENS
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO IDM-GLS-ERROR
               GO TO FIN-BUS-SEDE-RESP.
      
           MOVE TAB-GLS-DATA IN TAB(1:8) TO IDM-SEDE.
           MOVE TAB-GLS-DESC IN TAB TO IDM-FUNC.
           MOVE TAB-IND-VIGE IN TAB TO IDM-VIGE.
      
      
       FIN-BUS-SEDE-RESP.
           EXIT.
      *>----------------------------------------------------------------
      *> Modulo FIO para registro MSG en DATACOM                         
       GNS-FIO-MSG SECTION.                                             
       INI-GNS-FIO-MSG.                                                 
      *>JSS          
           MOVE 'MSG' TO MSG-COD-TTAB IN MSG                            
                         MSG-CIC-TTAB IN MSG                            
                         MSG-EXT-TTAB IN MSG                            
                         MSG-SNX-TTAB IN MSG.                           
      *>                                                                 
           MOVE ADR-MSG-REQA TO ADR-REQA.                               
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.                          
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-MSG.                                   
       GRP-GNS-FIO-MSG.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-MSG, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-MSG.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      *>                                                                 
           MOVE 'TAB00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'MSG-COD-TABL' OR FIO-AKEY NOT > SPACES )    
               MOVE MSG-COD-TABL IN MSG TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSG-STP-ITRN'                                 
               MOVE MSG-STP-ITRN IN MSG TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSG-CIC-TABL'                                 
               MOVE MSG-CIC-TABL IN MSG TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSG-EXT-TABL'                                 
               MOVE MSG-EXT-TABL IN MSG TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-MSG, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      *>JSS                                                              
           IF FIO-CMND = FIO-PUT OR FIO-MOD                             
               MOVE MSG-COD-TTAB IN MSG TO MSG-CIC-TTAB IN MSG          
                                           MSG-EXT-TTAB IN MSG          
                                           MSG-SNX-TTAB IN MSG.         
      *>                                                                 
           MOVE MSG TO FIO-DFLD.                                        
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO MSG                                     
           ELSE                                                         
      *>JSS     MOVE "GNSMSG" TO FIO-MEN2                                
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'TAB'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
               DISPLAY 'RGDABT 002'
                   PERFORM PRG-ABT.                                     
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-MSG-REQA.                               
       FIN-GNS-FIO-MSG.                                                 
           EXIT.                                                        
                     
      *> Modulo FIO para registro TAB en DATACOM                         
       GNS-FIO-TAB SECTION.                                             
       INI-GNS-FIO-TAB.              
           MOVE ADR-TAB-REQA       TO ADR-REQA.                         
           MOVE 'TAB'              TO ADR-TABL IN ADR-REQA. 
           
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-TAB.                                   
       GRP-GNS-FIO-TAB.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-TAB, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-TAB.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      *>                                                                 
           MOVE 'TAB00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )    
               MOVE TAB-COD-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-STP-ITRN'                                 
               MOVE TAB-STP-ITRN IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-CIC-TABL'                                 
               MOVE TAB-CIC-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-EXT-TABL'                                 
               MOVE TAB-EXT-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-TAB, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      *>JSS                                                              
           IF FIO-CMND = FIO-PUT OR FIO-MOD                             
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB          
                                           TAB-EXT-TTAB IN TAB          
                                           TAB-SNX-TTAB IN TAB.         
      *>                                                                 
           MOVE TAB TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO TAB                                     
           ELSE                                                         
      *>JSS     MOVE "GNSTAB" TO FIO-MEN2                                
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'TAB'    TO FIO-MENS-REG                            
      *>                                                                 
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-TAB-REQA.                               
       FIN-GNS-FIO-TAB.                                                 
           EXIT.                                                        
                     
      *> Modulo FIO para registro MSC en DATACOM                         
       GNS-FIO-MSC SECTION.                                             
       INI-GNS-FIO-MSC.                                                 
      *>JSS                                                              
           MOVE 'MSC' TO MSC-COD-TTAB IN MSC                            
                         MSC-CIC-TTAB IN MSC                            
                         MSC-EXT-TTAB IN MSC                            
                         MSC-SNX-TTAB IN MSC.                           
      *>                                                                 
           MOVE ADR-MSC-REQA TO ADR-REQA.                               
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.                          
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-MSC.                                   
       GRP-GNS-FIO-MSC.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-MSC, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-MSC.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      *>                                                                 
           MOVE 'TAB00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'MSC-COD-TABL' OR FIO-AKEY NOT > SPACES )    
               MOVE MSC-COD-TABL IN MSC TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSC-STP-ITRN'                                 
               MOVE MSC-STP-ITRN IN MSC TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSC-CIC-TABL'                                 
               MOVE MSC-CIC-TABL IN MSC TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MSC-EXT-TABL'                                 
               MOVE MSC-EXT-TABL IN MSC TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-MSC, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      *>JSS                                                              
           IF FIO-CMND = FIO-PUT OR FIO-MOD                             
               MOVE MSC-COD-TTAB IN MSC TO MSC-CIC-TTAB IN MSC          
                                           MSC-EXT-TTAB IN MSC          
                                           MSC-SNX-TTAB IN MSC.         
      *>                                                                 
           MOVE MSC TO FIO-DFLD.                                        
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO MSC                                     
           ELSE                                                         
      *>JSS     MOVE "GNSMSC" TO FIO-MEN2                                
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'TAB'    TO FIO-MENS-REG                            
      *>                                                                 
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
                              
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-MSC-REQA.                               
       FIN-GNS-FIO-MSC.                                                 
           EXIT.                                                        
                     
      *> Obtencion de Mensaje                                            
       GET-MSG SECTION.                                                 
       INI-GET-MSG.                                                     
           MOVE SCR-SIST TO FIO-SIST.                                   
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-MSG.                                         
           IF FIO-STAT-OKS AND MSG-IND-VIGE NOT = 'N'                   
               GO TO FIN-GET-MSG.                                       
           IF MSG-COD-SIST NOT = SCR-SIST                               
               MOVE MSG-COD-SIST TO FIO-SIST                            
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-MSG.                                     
           IF NOT FIO-STAT-OKS                                          
               MOVE MSG-COD-MENS           TO MSG-GLS-DES1              
               MOVE ' MENSAJE INEXISTENTE' TO MSG-GLS-DES2              
           ELSE                                                         
               IF MSG-IND-VIGE = 'N'                                    
                   MOVE MSG-COD-MENS          TO MSG-GLS-DES1           
                   MOVE ' MENSAJE NO VIGENTE' TO MSG-GLS-DES2.          
       FIN-GET-MSG.                                                     
           EXIT.                                                        
                     
      *> Modulo para Proceso de Fechas y Hora                            
      *> 24-MAY-1989 20:21:31                                            
       PRO-FEC SECTION.                                                 
       INI-PRO-FEC.                                                     
           MOVE FEC-SOKS TO FEC-STT1                                    
                            FEC-STT2.                                   
           MOVE SPACES TO MSG-COD-MENS IN MSG.                          
           IF FEC-CMND = FEC-VAL-FEC                                    
               PERFORM FEC-VALD-FEC                                     
      
      *>        IF FEC-STAT-OKS AND NOT FEC-STAT-BLK AND FEC-TIENE-DIA   
               IF FEC-STAT-OKS AND NOT FEC-STAT-BLK                     
                   PERFORM FEC-OTRA-VAL                                 
                   GO TO MSG-PRO-FEC                                    
               ELSE                                                     
                   GO TO MSG-PRO-FEC.                                   
           IF FEC-CMND = FEC-CMP-FEC                                    
               PERFORM FEC-COMP-FEC                                     
               GO TO MSG-PRO-FEC.                                       
       ERR-PRO-FEC.                                                     
           MOVE 'GNS'          TO MSG-COD-SIST.                         
           MOVE 'PROFEC CMDNX' TO MSG-COD-MENS IN MSG.                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC IN MSG TO SYS-MEN1.                        
           MOVE FEC-CMND            TO SYS-MEN2.                        
           MOVE SYS-ABOR            TO SYS-CMND.                        
           PERFORM GNS-PRO-SYS.                                         
       MSG-PRO-FEC.                                                     
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'GNS'     TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FEC-MENS                     
           ELSE                                                         
           IF NOT FEC-STAT-OKS                                          
               MOVE 'FECSTAT' TO MSG-COD-TMSG IN MSG                    
               MOVE FEC-STAT  TO MSG-COD-CMSG IN MSG                    
               MOVE 'GNS'     TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FEC-MENS                     
           ELSE                                                         
           IF ( FEC-CMND = FEC-VAL-FEC OR FEC-RET-FEC OR FEC-SIG-HBL OR 
                           FEC-SUM-DIA OR FEC-SUM-MES OR FEC-SUM-ANO OR 
                           FEC-RST-DIA OR FEC-RST-MES OR FEC-RST-ANO )  
              AND FEC-IEDT > SPACES                                     
               PERFORM FEC-PUT-SLSH.                                    
       FIN-PRO-FEC.                                                     
           EXIT.                                                        
                                                                        
       FEC-VALD-FEC SECTION.                                            
       INI-FEC-VALD-FEC.                                                
      *>     IF FEC-IEDT > SPACES                                        
               PERFORM FEC-EXT-SLSH.                                    
                                                                        
           MOVE 1 TO FEC-SIND.                                          
       LUP-FEC-VALD-FEC.                                                
           IF FEC-FECH-CHR( FEC-SIND ) NOT > SPACES                     
               MOVE ZEROES TO FEC-FECH-CHR( FEC-SIND ).                 
           ADD 1 TO FEC-SIND.                                           
           IF FEC-SIND NOT > 8                                          
               GO TO LUP-FEC-VALD-FEC.                                  
           MOVE FEC-ITM1-RED TO FEC-SVLD-RED.                           
           MOVE FEC-ITM2-RED TO FEC-AVLD-RED.                           
           MOVE FEC-ITM3-RED TO FEC-MVLD-RED.                           
           MOVE FEC-ITM4-RED TO FEC-DVLD-RED.                           
           PERFORM FEC-VNUM-FEC.                                        
           IF NOT FEC-STAT-OKS                                          
               GO TO FIN-FEC-VALD-FEC.                                  
           MOVE FEC-FVLD TO FEC-FECH.                                   
           IF FEC-STAT-BLK                                              
               GO TO FIN-FEC-VALD-FEC.                                  
           PERFORM FEC-TRDC-FEC.                                        
           IF FEC-MVLD < 1 OR FEC-MVLD > 12                             
               MOVE FEC-SMES TO FEC-STAT                                
               GO TO FIN-FEC-VALD-FEC.                                  
           IF FEC-MVLD NOT = 02                                         
              IF FEC-DVLD < 1 OR FEC-DVLD > FEC-DMES(FEC-MVLD)          
                  MOVE FEC-SDIA TO FEC-STAT                             
                  GO TO FIN-FEC-VALD-FEC                                
              ELSE                                                      
                  NEXT SENTENCE                                         
           ELSE                                                         
               DIVIDE FEC-AVLD BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST = 0                                          
                   IF FEC-DVLD < 1 OR FEC-DVLD > 29                     
                       MOVE FEC-SDIA TO FEC-STAT                        
                       GO TO FIN-FEC-VALD-FEC                           
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
                   IF FEC-DVLD < 1 OR FEC-DVLD > 28                     
                       MOVE FEC-SDIA TO FEC-STAT                        
                       GO TO FIN-FEC-VALD-FEC.                          
           IF FEC-SVLD < 18 OR FEC-SVLD > 20                            
               MOVE FEC-SSIG TO FEC-STAT                                
               GO TO FIN-FEC-VALD-FEC.                                  
       FIN-FEC-VALD-FEC.                                                
           EXIT.                                                        
                                                                        
       FEC-OTRA-VAL SECTION.                                            
       INI-FEC-OTRA-VAL.                                                
           IF FEC-CHOY = FEC-CHOY-L  OR FEC-CHOY-E  OR FEC-CHOY-G OR    
                         FEC-CHOY-LE OR FEC-CHOY-GE OR FEC-CHOY-LG      
               MOVE FEC-DVLD TO FEC-DEC1                                
               MOVE FEC-MVLD TO FEC-MEC1                                
               MOVE FEC-SVLD TO FEC-SEC1                                
               MOVE FEC-AVLD TO FEC-AEC1                                
               MOVE FEC-DHOY TO FEC-DEC2                                
               MOVE FEC-MHOY TO FEC-MEC2                                
               MOVE FEC-SHOY TO FEC-SEC2                                
               MOVE FEC-AHOY TO FEC-AEC2                                
               PERFORM CMP-FEC-COMP-FEC THRU FIN-FEC-COMP-FEC           
               IF FEC-STAT-LES AND                                      
                  ( FEC-CHOY = FEC-CHOY-E OR FEC-CHOY-G OR FEC-CHOY-GE )
                   MOVE 'FEC    <HOY' TO MSG-COD-MENS                   
                   MOVE FEC-SMAL TO FEC-STAT                            
                   GO TO FIN-FEC-OTRA-VAL                               
               ELSE                                                     
               IF FEC-STAT-EQL AND                                      
                  ( FEC-CHOY = FEC-CHOY-L OR FEC-CHOY-G OR FEC-CHOY-LG )
                   MOVE 'FEC    =HOY' TO MSG-COD-MENS                   
                   MOVE FEC-SMAL TO FEC-STAT                            
                   GO TO FIN-FEC-OTRA-VAL                               
               ELSE                                                     
               IF FEC-STAT-GRT AND                                      
                  ( FEC-CHOY = FEC-CHOY-L OR FEC-CHOY-E OR FEC-CHOY-LE )
                   MOVE 'FEC    >HOY' TO MSG-COD-MENS                   
                   MOVE FEC-SMAL TO FEC-STAT                            
                   GO TO FIN-FEC-OTRA-VAL.                              
           IF FEC-VHBL = FEC-VHBL-S AND FEC-TIENE-DIA                   
               PERFORM FEC-VALD-HBL.                                    
       FIN-FEC-OTRA-VAL.                                                
           EXIT.                                                        
                                                                        
       FEC-COMP-FEC SECTION.                                            
       INI-FEC-COMP-FEC.                                                
           MOVE FEC-FEC1 TO FEC-FECH.                                   
           PERFORM FEC-EXT-SLSH.                                        
           PERFORM FEC-TRDC-FEC.                                        
           MOVE FEC-DVLD TO FEC-DEC1.                                   
           MOVE FEC-MVLD TO FEC-MEC1.                                   
           MOVE FEC-SVLD TO FEC-SEC1.                                   
           MOVE FEC-AVLD TO FEC-AEC1.                                   
           MOVE FEC-FEC2 TO FEC-FECH.                                   
           PERFORM FEC-EXT-SLSH.                                        
           PERFORM FEC-TRDC-FEC.                                        
           MOVE FEC-DVLD TO FEC-DEC2.                                   
           MOVE FEC-MVLD TO FEC-MEC2.                                   
           MOVE FEC-SVLD TO FEC-SEC2.                                   
           MOVE FEC-AVLD TO FEC-AEC2.                                   
       CMP-FEC-COMP-FEC.                                                
           IF FEC-SEC1 > FEC-SEC2                                       
               MOVE FEC-SGRT TO FEC-STAT                                
           ELSE                                                         
           IF FEC-SEC1 < FEC-SEC2                                       
               MOVE FEC-SLES TO FEC-STAT                                
           ELSE                                                         
               MOVE FEC-SEQL TO FEC-STAT                                
               IF FEC-AEC1 > FEC-AEC2                                   
                   MOVE FEC-SGRT TO FEC-STAT                            
               ELSE                                                     
               IF FEC-AEC1 < FEC-AEC2                                   
                   MOVE FEC-SLES TO FEC-STAT                            
               ELSE                                                     
                   MOVE FEC-SEQL TO FEC-STAT                            
                   IF FEC-MEC1 > FEC-MEC2                               
                       MOVE FEC-SGRT TO FEC-STAT                        
                   ELSE                                                 
                   IF FEC-MEC1 < FEC-MEC2                               
                       MOVE FEC-SLES TO FEC-STAT                        
                   ELSE                                                 
                       MOVE FEC-SEQL TO FEC-STAT                        
                       IF FEC-DEC1 > FEC-DEC2                           
                           MOVE FEC-SGRT TO FEC-STAT                    
                       ELSE                                             
                       IF FEC-DEC1 < FEC-DEC2                           
                           MOVE FEC-SLES TO FEC-STAT                    
                       ELSE                                             
                           MOVE FEC-SEQL TO FEC-STAT.                   
       FIN-FEC-COMP-FEC.                                                
           EXIT.                                                        
                                                                        
       FEC-TRDC-FEC SECTION.                                            
       INI-FEC-TRDC-FEC.                                                
           PERFORM FEC-GDAT.                                            
           IF NOT FEC-TIENE-MES                                         
               MOVE FEC-MHOY TO FEC-MVLD                                
           ELSE                                                         
           IF FEC-TIENE-DIA                                             
               MOVE FEC-ITM2 TO FEC-MVLD                                
           ELSE                                                         
               MOVE FEC-ITM1 TO FEC-MVLD.                               
           IF FEC-TIENE-DIA                                             
               MOVE FEC-ITM1 TO FEC-DVLD                                
           ELSE                                                         
               IF FEC-MHOY = FEC-MVLD                                   
                   MOVE FEC-DHOY TO FEC-DVLD                            
               ELSE                                                     
                   MOVE 1 TO FEC-DVLD.                                  
           IF NOT FEC-TIENE-SIGLO                                       
               MOVE FEC-SHOY TO FEC-SVLD                                
           ELSE                                                         
           IF FEC-TIENE-DIA AND FEC-TIENE-MES                           
               MOVE FEC-ITM3 TO FEC-SVLD                                
           ELSE                                                         
           IF ( NOT FEC-TIENE-DIA ) AND ( NOT FEC-TIENE-MES )           
               MOVE FEC-ITM1  TO FEC-SVLD                               
           ELSE                                                         
               MOVE FEC-ITM2 TO FEC-SVLD.                               
           IF NOT FEC-TIENE-ANO                                         
               MOVE FEC-AHOY TO FEC-AVLD                                
           ELSE                                                         
           IF FEC-TIENE-DIA AND FEC-TIENE-MES AND FEC-TIENE-SIGLO       
               MOVE FEC-ITM4 TO FEC-AVLD                                
           ELSE                                                         
           IF ( FEC-TIENE-DIA AND FEC-TIENE-MES   ) OR                  
              ( FEC-TIENE-MES AND FEC-TIENE-SIGLO )                     
               MOVE FEC-ITM3 TO FEC-AVLD                                
           ELSE                                                         
           IF FEC-TIENE-MES OR FEC-TIENE-SIGLO                          
               MOVE FEC-ITM2 TO FEC-AVLD                                
           ELSE                                                         
               MOVE FEC-ITM1 TO FEC-AVLD.                               
           IF ( NOT FEC-TIENE-SIGLO ) AND ( FEC-TIENE-QUIEBRE )         
      *>JSS-INI 12-MAR-1999   (DAD)                                      
      *>    AND ( FEC-AVLD NOT > 50 )                                    
      *>        ADD 1 TO FEC-SVLD.                                       
               IF FEC-SVLD = 19                                         
                   IF FEC-AVLD NOT > 60                                 
                       ADD 1 TO FEC-SVLD                                
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
                   IF FEC-AVLD > 60                                     
                       SUBTRACT 1 FROM FEC-SVLD.                        
      *>JSS-FIN 12-MAR-1999   (DAD)                                      
       FIN-FEC-TRDC-FEC.                                                
           EXIT.                                                        
                                                                        
       FEC-VNUM-FEC SECTION.                                            
       INI-FEC-VNUM-FEC.                                                
           IF ( FEC-FVLD NOT > SPACES OR FEC-FVLD = ZEROES ) AND        
              FEC-FBLK = FEC-FBLK-S                                     
               MOVE ZEROES TO FEC-FVLD                                  
               MOVE FEC-SBLK TO FEC-STAT                                
               GO TO FIN-FEC-VNUM-FEC.                                  
           IF ( FEC-FVLD NOT > SPACES OR FEC-FVLD = ZEROES ) AND        
              FEC-FBLK = FEC-FBLK-N                                     
                MOVE FEC-SOBL TO FEC-STAT                               
                GO TO FIN-FEC-VNUM-FEC.                                 
           IF FEC-FVLD IS NOT NUMERIC                                   
               MOVE FEC-SNN1 TO FEC-STAT.                               
       FIN-FEC-VNUM-FEC.                                                
           EXIT.                                                        
                                                                        
       FEC-GDAT SECTION.                                                
       INI-FEC-GDAT.                                                    
           PERFORM GET-FHOY.                                            
           MOVE HOY-DHOY TO FEC-DHOY.                                   
           MOVE HOY-MHOY TO FEC-MHOY.                                   
           MOVE HOY-SHOY TO FEC-SHOY.                                   
           MOVE HOY-AHOY TO FEC-AHOY.                                   
           MOVE HOY-HHHY TO FEC-HHHY.                                   
           MOVE HOY-MMHY TO FEC-MMHY.                                   
           MOVE HOY-SSHY TO FEC-SSHY.                                   
       FIN-FEC-GDAT.                                                    
           EXIT.                                                        
                                                                        
       FEC-VALD-HBL SECTION.                                            
       INI-FEC-VALD-HBL.                                                
           PERFORM FEC-RTRN-JUL.                                        
           DIVIDE FEC-FJUL BY 7 GIVING FEC-REST REMAINDER FEC-REST.     
           SUBTRACT FEC-DIA1 FROM 7 GIVING FEC-AUXI.                    
           ADD 1 FEC-AUXI GIVING FEC-SIND.                              
           IF FEC-SIND > 6                                              
               MOVE 0 TO FEC-SIND.                                      
           IF FEC-REST = FEC-AUXI OR FEC-SIND                           
               MOVE FEC-SFER TO FEC-STAT                                
           ELSE                                                         
               MOVE 'FER'        TO TAB-COD-TTAB IN TAB                 
               MOVE FEC-FECH-FDM TO TAB-COD-CTAB IN TAB                 
               MOVE 'GNS'        TO FIO-SIST                            
               MOVE FIO-GET-KEY  TO FIO-CMND                            
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N'        
                   MOVE FEC-SFER TO FEC-STAT                            
               ELSE                                                     
                   MOVE 'FER'    TO TAB-COD-TTAB IN TAB                 
                   MOVE FEC-FECH TO TAB-COD-CTAB IN TAB                 
                   MOVE 'GNS'       TO FIO-SIST                         
                   MOVE FIO-GET-KEY TO FIO-CMND                         
                   PERFORM GNS-FIO-TAB                                  
                   IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N'    
                       MOVE FEC-SFER TO FEC-STAT                        
                   ELSE                                                 
                       MOVE FEC-SHBL TO FEC-STAT.                       
       FIN-FEC-VALD-HBL.                                                
           EXIT.                                                        
                                                                        
       FEC-RTRN-JUL SECTION.                                            
       INI-FEC-RTRN-JUL.                                                
           IF FEC-BST1 < FEC-FANO                                       
               SUBTRACT FEC-BST1 FROM FEC-FANO GIVING FEC-FJUL          
           ELSE                                                         
               MOVE 0 TO FEC-FJUL.                                      
           DIVIDE FEC-FJUL BY 4 GIVING FEC-FJUL REMAINDER FEC-REST.     
           COMPUTE FEC-FJUL = FEC-FJUL + ( FEC-FANO - FEC-ANO1 ) * 365. 
           IF FEC-REST > 0                                              
               ADD 1 TO FEC-FJUL.                                       
           MOVE 1 TO FEC-SIND.                                          
       LUP-FEC-RTRN-JUL.                                                
           IF FEC-SIND < FEC-FMES                                       
               ADD FEC-DMES( FEC-SIND ) TO FEC-FJUL                     
               ADD 1 TO FEC-SIND                                        
               GO TO LUP-FEC-RTRN-JUL.                                  
           ADD FEC-FDIA TO FEC-FJUL.                                    
           DIVIDE FEC-FANO BY 4 GIVING FEC-REST REMAINDER FEC-REST.     
           IF FEC-REST NOT = 0 AND FEC-FMES > 2                         
               SUBTRACT 1 FROM FEC-FJUL.                                
       FIN-FEC-RTRN-JUL.                                                
           EXIT.                                                        
                                                                        
       FEC-EXT-SLSH SECTION.                                            
       INI-FEC-EXT-SLSH.                                                
           MOVE FEC-FECH TO FEC-FSLH.                                   
           IF FEC-FORM = FEC-FORM-FEC OR FEC-FORM-DMA                   
      *>        IF FEC-FSLH-SL1 = FEC-IEDT AND FEC-FSLH-SL2 = FEC-IEDT   
               IF FEC-FSLH-SL1 = '/' AND FEC-FSLH-SL2 = '/'             
                   MOVE SPACES       TO FEC-FECH                        
                   MOVE FEC-FSLH-IT1 TO FEC-ITM1                        
                   MOVE FEC-FSLH-IT2 TO FEC-ITM2                        
                   MOVE FEC-FSLH-IT3 TO FEC-ITM3                        
                   MOVE FEC-FSLH-IT4 TO FEC-ITM4                        
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
           IF FEC-FORM = FEC-FORM-MSA OR FEC-FORM-FMA                   
      *>        IF FEC-FSLH-SL1 = FEC-IEDT                               
               IF FEC-FSLH-SL1 = '/'                                    
                   MOVE SPACES       TO FEC-FECH                        
                   MOVE FEC-FSLH-IT1 TO FEC-ITM1                        
                   MOVE FEC-FSLH-IT2 TO FEC-ITM2                        
                   MOVE FEC-FSLH-IT5 TO FEC-ITM3                        
                   MOVE FEC-FSLH-IT6 TO FEC-ITM4                        
               ELSE                                                     
                   NEXT SENTENCE.                                       
       FIN-FEC-EXT-SLSH.                                                
           EXIT.                                                        
                                                                        
       FEC-PUT-SLSH SECTION.                                            
       INI-FEC-PUT-SLSH.                                                
           MOVE SPACES TO FEC-FSLH.                                     
           IF FEC-FORM = FEC-FORM-FEC OR FEC-FORM-DMA                   
               MOVE FEC-ITM1 TO FEC-FSLH-IT1                            
      *>        MOVE FEC-IEDT TO FEC-FSLH-SL1                            
               MOVE '/'      TO FEC-FSLH-SL1                            
               MOVE FEC-ITM2 TO FEC-FSLH-IT2                            
      *>        MOVE FEC-IEDT TO FEC-FSLH-SL2                            
               MOVE '/'      TO FEC-FSLH-SL2                            
               MOVE FEC-ITM3 TO FEC-FSLH-IT3                            
               MOVE FEC-ITM4 TO FEC-FSLH-IT4                            
               MOVE FEC-FSLH TO FEC-FECH                                
           ELSE                                                         
           IF FEC-FORM = FEC-FORM-MSA OR FEC-FORM-FMA                   
               MOVE FEC-ITM1 TO FEC-FSLH-IT1                            
      *>        MOVE FEC-IEDT TO FEC-FSLH-SL1                            
               MOVE '/'      TO FEC-FSLH-SL1                            
               MOVE FEC-ITM2 TO FEC-FSLH-IT5                            
               MOVE FEC-ITM3 TO FEC-FSLH-IT6                            
               MOVE FEC-FSLH TO FEC-FECH.                               
           MOVE SPACES TO FEC-IEDT.                                     
       FIN-FEC-PUT-SLSH.                                                
           EXIT.                                                        
                     
      *> Modulo para Proceso de Fechas y Hora                            
      *> 24-MAY-1989 20:21:31                                            
       CAL-FEC SECTION.                                                 
       INI-CAL-FEC.                                                     
           MOVE FEC-SOKS TO FEC-STT1                                    
                            FEC-STT2.                                   
           MOVE SPACES TO MSG-COD-MENS IN MSG.                          
           IF FEC-CMND = FEC-CMP-HOY                                    
               PERFORM FEC-COMP-HOY                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-RET-JUL                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-RTRN-JUL                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-RET-FEC                                    
               PERFORM FEC-RTRN-FEC                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-SIG-HBL                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-SIGU-HBL                                     
               GO TO MSG-CAL-FEC.                                       
      *>MHM INI 24-0CT-2011 PENTA
           IF FEC-CMND = FEC-ANT-HBL                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-ANTE-HBL                                     
               GO TO MSG-CAL-FEC.                                       
      *>MHM FIN 24-0CT-2011 PENTA
           IF FEC-CMND = FEC-SUM-DIA                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-SUMA-DIA                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-SUM-MES                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-SUMA-MES                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-SUM-ANO                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-SUMA-ANO                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-RST-DIA                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-REST-DIA                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-RST-MES                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-REST-MES                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-RST-ANO                                    
               PERFORM FEC-EXT-SLSH                                     
               PERFORM FEC-TRDC-FEC                                     
               PERFORM FEC-REST-ANO                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-DIF-DIA                                    
               PERFORM FEC-DIFF-DIA                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-DIF-MES                                    
               PERFORM FEC-DIFF-MES                                     
               GO TO MSG-CAL-FEC.                                       
           IF FEC-CMND = FEC-DIF-ANO                                    
               PERFORM FEC-DIFF-ANO                                     
               GO TO MSG-CAL-FEC.                                       
       ERR-CAL-FEC.                                                     
           MOVE 'GNS'          TO MSG-COD-SIST.                         
           MOVE 'CALFEC CMDNX' TO MSG-COD-MENS IN MSG.                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC IN MSG TO SYS-MEN1.                        
           MOVE FEC-CMND            TO SYS-MEN2.                        
           MOVE SYS-ABOR            TO SYS-CMND.                        
           PERFORM GNS-PRO-SYS.                                         
       MSG-CAL-FEC.                                                     
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'GNS'     TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FEC-MENS                     
           ELSE                                                         
           IF NOT FEC-STAT-OKS                                          
               MOVE 'FECSTAT' TO MSG-COD-TMSG IN MSG                    
               MOVE FEC-STAT  TO MSG-COD-CMSG IN MSG                    
               MOVE 'GNS'     TO MSG-COD-SIST                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC IN MSG TO FEC-MENS                     
           ELSE                                                         
           IF ( FEC-CMND = FEC-VAL-FEC OR FEC-RET-FEC OR FEC-SIG-HBL OR 
                           FEC-SUM-DIA OR FEC-SUM-MES OR FEC-SUM-ANO OR 
                           FEC-RST-DIA OR FEC-RST-MES OR FEC-RST-ANO )  
              AND FEC-IEDT > SPACES                                     
               PERFORM FEC-PUT-SLSH.                                    
       FIN-CAL-FEC.                                                     
           EXIT.                                                        
                                                                        
       FEC-COMP-HOY SECTION.                                            
       INI-FEC-COMP-HOY.                                                
           PERFORM FEC-EXT-SLSH.                                        
           PERFORM FEC-TRDC-FEC.                                        
           MOVE FEC-DVLD TO FEC-DEC1.                                   
           MOVE FEC-MVLD TO FEC-MEC1.                                   
           MOVE FEC-SVLD TO FEC-SEC1.                                   
           MOVE FEC-AVLD TO FEC-AEC1.                                   
           PERFORM FEC-GDAT.                                            
           MOVE FEC-DHOY TO FEC-DEC2.                                   
           MOVE FEC-MHOY TO FEC-MEC2.                                   
           MOVE FEC-SHOY TO FEC-SEC2.                                   
           MOVE FEC-AHOY TO FEC-AEC2.                                   
           PERFORM CMP-FEC-COMP-FEC THRU FIN-FEC-COMP-FEC.              
       FIN-FEC-COMP-HOY.                                                
           EXIT.                                                        
                                                                        
       FEC-RTRN-FEC SECTION.                                            
       INI-FEC-RTRN-FEC.                                                
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE SPACES       TO FEC-FECH.                               
           DIVIDE FEC-FJUL BY 365 GIVING FEC-NANO REMAINDER FEC-NDIA.   
           COMPUTE FEC-NABI = FEC-NANO - ( FEC-BST1 - FEC-ANO1 ) + 3.   
           DIVIDE FEC-NABI BY 4 GIVING FEC-NABI REMAINDER FEC-REST.     
      *>    IF FEC-NABI > 24                                             
      *>        SUBTRACT 1 FROM FEC-NABI.                                
           IF FEC-NDIA NOT < FEC-NABI                                   
               SUBTRACT FEC-NABI FROM FEC-NDIA GIVING FEC-NDIA          
           ELSE                                                         
               SUBTRACT 1 FROM FEC-NANO                                 
               IF FEC-NANO = 0                                          
                   MOVE 0 TO FEC-NABI                                   
                   IF FEC-REST = 0                                      
                       COMPUTE FEC-NDIA = 366 + FEC-NDIA                
                   ELSE                                                 
                       COMPUTE FEC-NDIA = 365 + FEC-NDIA                
               ELSE                                                     
                   IF FEC-REST = 0                                      
                       COMPUTE FEC-NDIA = 366 - ( FEC-NABI - FEC-NDIA ) 
                   ELSE                                                 
                       COMPUTE FEC-NDIA = 365 - ( FEC-NABI - FEC-NDIA ).
           ADD FEC-ANO1 FEC-NANO GIVING FEC-FANO.                       
           IF FEC-NDIA = 0                                              
               SUBTRACT 1 FROM FEC-FANO                                 
               MOVE 31       TO FEC-ITM1                                
               MOVE 12       TO FEC-ITM2                                
               MOVE FEC-SVLD TO FEC-ITM3                                
               MOVE FEC-AVLD TO FEC-ITM4                                
           ELSE                                                         
               MOVE FEC-SVLD TO FEC-ITM3                                
               MOVE FEC-AVLD TO FEC-ITM4                                
               DIVIDE FEC-FANO BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               MOVE 0 TO FEC-AUXI                                       
               PERFORM FEC-OBT-MES VARYING FEC-ITM2 FROM 1 BY 1         
                       UNTIL FEC-ITM2 > 12 OR FEC-AUXI = 1              
      *>JSS    IF FEC-ITM2 < 12                                          
      *>            SUBTRACT 1 FROM FEC-ITM2                             
      *>        ELSE                                                     
      *>            MOVE 12 TO FEC-ITM2.                                 
              IF FEC-ITM2 > 1                                           
                  SUBTRACT 1 FROM FEC-ITM2.                             
       FIN-FEC-RTRN-FEC.                                                
           EXIT.                                                        
                                                                        
       FEC-OBT-MES SECTION.                                             
       INI-FEC-OBT-MES.                                                 
           MOVE FEC-DACU( FEC-ITM2 ) TO FEC-FANO.                       
           IF FEC-REST NOT = 0 AND FEC-ITM2 > 1                         
               SUBTRACT 1 FROM FEC-FANO.                                
           IF FEC-NDIA NOT > FEC-FANO                                   
               MOVE 1 TO FEC-AUXI                                       
               IF FEC-ITM2 > 1                                          
                   SUBTRACT 1 FROM FEC-ITM2 GIVING FEC-SIND             
                   SUBTRACT FEC-DACU( FEC-SIND ) FROM FEC-NDIA          
                            GIVING FEC-ITM1                             
                   IF FEC-REST NOT = 0 AND FEC-ITM2 > 2                 
                       ADD 1 TO FEC-ITM1                                
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
                   MOVE FEC-NDIA TO FEC-ITM1.                           
       FIN-FEC-OBT-MES.                                                 
           EXIT.                                                        
                                                                        
       FEC-SIGU-HBL SECTION.                                            
       INI-FEC-SIGU-HBL.                                                
           PERFORM FEC-RTRN-JUL.                                        
       LUP-FEC-SIGU-HBL.                                                
           ADD 1 TO FEC-FJUL.                                           
           PERFORM FEC-RTRN-FEC.                                        
           MOVE FEC-ITM1 TO FEC-DVLD.                                   
           MOVE FEC-ITM2 TO FEC-MVLD.                                   
           MOVE FEC-ITM3 TO FEC-SVLD.                                   
           MOVE FEC-ITM4 TO FEC-AVLD.                                   
           PERFORM FEC-VALD-HBL.                                        
           IF FEC-STAT = FEC-SFER                                       
               GO TO LUP-FEC-SIGU-HBL.                                  
       FIN-FEC-SIGU-HBL.                                                
           EXIT.                                                        
                                                                        
      *>MHM INI 24-0CT-2011 PENTA
       FEC-ANTE-HBL SECTION.                                            
       INI-FEC-ANTE-HBL.                                                
           PERFORM FEC-RTRN-JUL.                                        
       LUP-FEC-ANTE-HBL.                                                
           SUBTRACT 1 FROM FEC-FJUL.                                    
           PERFORM FEC-RTRN-FEC.                                        
           MOVE FEC-ITM1 TO FEC-DVLD.                                   
           MOVE FEC-ITM2 TO FEC-MVLD.                                   
           MOVE FEC-ITM3 TO FEC-SVLD.                                   
           MOVE FEC-ITM4 TO FEC-AVLD.                                   
           PERFORM FEC-VALD-HBL.                                        
           IF FEC-STAT = FEC-SFER                                       
               GO TO LUP-FEC-ANTE-HBL.                                  
       FIN-FEC-ANTE-HBL.                                                
           EXIT.                                                        
      *>MHM FIN 24-0CT-2011 PENTA
      
       FEC-SUMA-DIA SECTION.                                            
       INI-FEC-SUMA-DIA.                                                
           IF FEC-NDIA = 1                                              
               IF FEC-MVLD = 3 OR 5 OR 7 OR 8 OR 10 OR 12               
                   IF FEC-DVLD < 31                                     
                       ADD 1 TO FEC-DVLD                                
                       MOVE FEC-DVLD TO FEC-ITM1                        
                       MOVE FEC-MVLD TO FEC-ITM2                        
                       MOVE FEC-SVLD TO FEC-ITM3                        
                       MOVE FEC-AVLD TO FEC-ITM4                        
                       GO TO FIN-FEC-SUMA-DIA                           
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
               IF FEC-MVLD = 1 OR 4 OR 6 OR 9 OR 11                     
                   IF FEC-DVLD < 30                                     
                       ADD 1 TO FEC-DVLD                                
                       MOVE FEC-DVLD TO FEC-ITM1                        
                       MOVE FEC-MVLD TO FEC-ITM2                        
                       MOVE FEC-SVLD TO FEC-ITM3                        
                       MOVE FEC-AVLD TO FEC-ITM4                        
                       GO TO FIN-FEC-SUMA-DIA                           
                   ELSE                                                 
                       NEXT SENTENCE                                    
               ELSE                                                     
                   IF FEC-DVLD < 28                                     
                       ADD 1 TO FEC-DVLD                                
                       MOVE FEC-DVLD TO FEC-ITM1                        
                       MOVE FEC-MVLD TO FEC-ITM2                        
                       MOVE FEC-SVLD TO FEC-ITM3                        
                       MOVE FEC-AVLD TO FEC-ITM4                        
                       GO TO FIN-FEC-SUMA-DIA.                          
           PERFORM FEC-RTRN-JUL.                                        
           ADD FEC-NDIA TO FEC-FJUL.                                    
           PERFORM FEC-RTRN-FEC.                                        
       FIN-FEC-SUMA-DIA.                                                
           EXIT.                                                        
                                                                        
       FEC-SUMA-MES SECTION.                                            
       INI-FEC-SUMA-MES.                                                
           DIVIDE FEC-NMES BY 12 GIVING FEC-NANO REMAINDER FEC-REST.    
           MOVE FEC-REST TO FEC-NMES.                                   
           ADD FEC-NANO TO FEC-FANO.                                    
           ADD FEC-REST TO FEC-FMES.                                    
           IF FEC-FMES > 12                                             
               ADD 1 TO FEC-FANO                                        
               SUBTRACT 12 FROM FEC-FMES.                               
           IF FEC-FDIA NOT < FEC-DMES(FEC-FMES)                         
               MOVE FEC-DMES(FEC-FMES) TO FEC-FDIA                      
               IF FEC-FMES = 2                                          
                   DIVIDE FEC-FANO BY 4 GIVING FEC-REST                 
                                        REMAINDER FEC-REST              
                   IF FEC-REST NOT = 0                                  
                       SUBTRACT 1 FROM FEC-FDIA.                        
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
       FIN-FEC-SUMA-MES.                                                
           EXIT.                                                        
                                                                        
       FEC-SUMA-ANO SECTION.                                            
       INI-FEC-SUMA-ANO.                                                
           ADD FEC-NANO TO FEC-FANO.                                    
      *>JSS-INI 16-DEC-1998                                              
           IF FEC-MVLD = 2                                              
               DIVIDE FEC-FANO BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-DVLD = 29 AND FEC-REST NOT = 0                    
                   MOVE 28 TO FEC-DVLD.                                 
      *>JSS-FIN 16-DEC-1998                                              
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
       FIN-FEC-SUMA-ANO.                                                
           EXIT.                                                        
                                                                        
       FEC-REST-DIA SECTION.                                            
       INI-FEC-REST-DIA.                                                
           PERFORM FEC-RTRN-JUL.                                        
           SUBTRACT FEC-NDIA FROM FEC-FJUL.                             
           PERFORM FEC-RTRN-FEC.                                        
       FIN-FEC-REST-DIA.                                                
           EXIT.                                                        
                                                                        
       FEC-REST-MES SECTION.                                            
       INI-FEC-REST-MES.                                                
           DIVIDE FEC-NMES BY 12 GIVING FEC-NANO REMAINDER FEC-NMES.    
           SUBTRACT FEC-NANO FROM FEC-FANO.                             
           IF FEC-NMES < FEC-FMES                                       
               SUBTRACT FEC-NMES FROM FEC-FMES                          
           ELSE                                                         
               SUBTRACT 1        FROM FEC-FANO                          
               SUBTRACT FEC-FMES FROM FEC-NMES                          
               SUBTRACT FEC-NMES FROM 12 GIVING FEC-FMES.               
           IF FEC-FDIA > FEC-DMES(FEC-FMES)                             
               MOVE FEC-DMES(FEC-FMES) TO FEC-FDIA.                     
           IF FEC-FDIA = FEC-DMES(2) AND FEC-FMES = 2                   
               DIVIDE FEC-FANO BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST NOT = 0                                      
                   SUBTRACT 1 FROM FEC-FDIA.                            
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
       FIN-FEC-REST-MES.                                                
           EXIT.                                                        
                                                                        
       FEC-REST-ANO SECTION.                                            
       INI-FEC-REST-ANO.                                                
           SUBTRACT FEC-NANO FROM FEC-FANO.                             
           IF FEC-FDIA = FEC-DMES(2) AND FEC-FMES = 2                   
               DIVIDE FEC-FANO BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST NOT = 0                                      
                   SUBTRACT 1 FROM FEC-FDIA.                            
           MOVE FEC-DVLD TO FEC-ITM1.                                   
           MOVE FEC-MVLD TO FEC-ITM2.                                   
           MOVE FEC-SVLD TO FEC-ITM3.                                   
           MOVE FEC-AVLD TO FEC-ITM4.                                   
       FIN-FEC-REST-ANO.                                                
           EXIT.                                                        
                                                                        
       FEC-DIFF-DIA SECTION.                                            
       INI-FEC-DIFF-DIA.                                                
           PERFORM FEC-CMP-F12.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-FEC-DIFF-DIA.                                  
                                                                        
           MOVE FEC-DEC1 TO FEC-DVLD.                                   
           MOVE FEC-MEC1 TO FEC-MVLD.                                   
           MOVE FEC-SEC1 TO FEC-SVLD.                                   
           MOVE FEC-AEC1 TO FEC-AVLD.                                   
           PERFORM FEC-RTRN-JUL.                                        
           MOVE FEC-FJUL TO FEC-XJUL.                                   
                                                                        
           MOVE FEC-DEC2 TO FEC-DVLD.                                   
           MOVE FEC-MEC2 TO FEC-MVLD.                                   
           MOVE FEC-SEC2 TO FEC-SVLD.                                   
           MOVE FEC-AEC2 TO FEC-AVLD.                                   
           PERFORM FEC-RTRN-JUL.                                        
                                                                        
           IF FEC-FJUL NOT < FEC-XJUL                                   
               SUBTRACT FEC-XJUL FROM FEC-FJUL GIVING FEC-NDIA          
           ELSE                                                         
               SUBTRACT FEC-FJUL FROM FEC-XJUL GIVING FEC-NDIA.         
       FIN-FEC-DIFF-DIA.                                                
           EXIT.                                                        
                                                                        
       FEC-DIFF-MES SECTION.                                            
       INI-FEC-DIFF-MES.                                                
           PERFORM FEC-CMP-F12.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-FEC-DIFF-MES.                                  
           MOVE 0 TO FEC-NDIA.                                          
           IF FEC-MEC1 = 2                                              
               DIVIDE FEC-AEC1 BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST = 0                                          
                   MOVE FEC-DMES(2) TO FEC-SIND                         
               ELSE                                                     
                   SUBTRACT 1 FROM FEC-DMES(2) GIVING FEC-SIND          
           ELSE                                                         
               MOVE FEC-DMES(FEC-MEC1) TO FEC-SIND.                     
           IF FEC-MEC2 = 2                                              
               DIVIDE FEC-AEC2 BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST = 0                                          
                   MOVE FEC-DMES(2) TO FEC-REST                         
               ELSE                                                     
                   SUBTRACT 1 FROM FEC-DMES(2) GIVING FEC-REST          
           ELSE                                                         
               MOVE FEC-DMES(FEC-MEC2) TO FEC-REST.                     
                                                                        
           MOVE 0 TO FEC-NMES.                                          
           SUBTRACT FEC-FSA1 FROM FEC-FSA2 GIVING FEC-NANO.             
           IF FEC-NANO > 0                                              
               IF ( FEC-MEC2 < FEC-MEC1 ) OR                            
                  ( FEC-MEC2 = FEC-MEC1 AND FEC-DEC2 < FEC-DEC1 AND     
                    ( FEC-DEC1 NOT = FEC-SIND OR                        
                      FEC-DEC2 NOT = FEC-REST ) )                       
                   SUBTRACT 1 FROM FEC-NANO GIVING FEC-NANO.            
           IF ( FEC-MEC2 = FEC-MEC1 AND FEC-DEC1 = FEC-DEC2 )           
      *>JSS-INI 16-DEC-1998                                              
                OR                                                      
              ( FEC-MEC1 = 2        AND FEC-MEC2 = 2 AND                
                FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST )           
      *>JSS-FIN 16-DEC-1998                                              
               GO TO CPU-FEC-DIFF-MES.                                  
                                                                        
           IF FEC-MEC2 < FEC-MEC1                                       
               SUBTRACT FEC-MEC1 FROM 12 GIVING FEC-NMES                
               ADD FEC-MEC2 TO FEC-NMES                                 
           ELSE                                                         
           IF FEC-MEC2 > FEC-MEC1                                       
               SUBTRACT FEC-MEC1 FROM FEC-MEC2 GIVING FEC-NMES          
           ELSE                                                         
               IF FEC-DEC2 NOT < FEC-DEC1                               
                   MOVE 0 TO FEC-NMES                                   
               ELSE                                                     
                   IF FEC-FSA1 NOT = FEC-FSA2                           
                       SUBTRACT FEC-MEC1 FROM 12 GIVING FEC-NMES        
                       ADD FEC-MEC2 TO FEC-NMES                         
                   ELSE                                                 
                       MOVE 0 TO FEC-NMES.                              
                                                                        
       CPU-FEC-DIFF-MES.                                                
           COMPUTE FEC-NMES = FEC-NMES + ( FEC-NANO * 12 ).             
           IF FEC-DEC2 < FEC-DEC1 AND FEC-NMES > 0 AND                  
      *>       ( FEC-DEC1 NOT = FEC-SIND OR FEC-DEC2 NOT = FEC-REST )    
              ( FEC-DEC2 NOT = FEC-REST )                               
               SUBTRACT 1 FROM FEC-NMES.                                
           IF ( FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST ) OR        
              ( FEC-DEC2 < FEC-DEC1 AND FEC-DEC2 = FEC-REST )           
               MOVE 0 TO FEC-NDIA                                       
               GO TO FIN-FEC-DIFF-MES.                                  
           IF FEC-DEC1 < FEC-DEC2                                       
               SUBTRACT FEC-DEC1 FROM FEC-DEC2 GIVING FEC-NDIA          
           ELSE                                                         
           IF FEC-DEC1 > FEC-DEC2                                       
               SUBTRACT FEC-DEC1 FROM FEC-SIND GIVING FEC-NDIA          
               ADD FEC-DEC2 TO FEC-NDIA.                                
       FIN-FEC-DIFF-MES.                                                
           EXIT.                                                        
                                                                        
       FEC-DIFF-ANO SECTION.                                            
       INI-FEC-DIFF-ANO.                                                
           PERFORM FEC-CMP-F12.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-FEC-DIFF-ANO.                                  
      *>JSS-INI 16-DEC-1998                                              
           IF FEC-MEC1 = 2                                              
               DIVIDE FEC-AEC1 BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST = 0                                          
                   MOVE FEC-DMES(2) TO FEC-SIND                         
               ELSE                                                     
                   SUBTRACT 1 FROM FEC-DMES(2) GIVING FEC-SIND          
           ELSE                                                         
               MOVE FEC-DMES(FEC-MEC1) TO FEC-SIND.                     
           IF FEC-MEC2 = 2                                              
               DIVIDE FEC-AEC2 BY 4 GIVING FEC-REST REMAINDER FEC-REST  
               IF FEC-REST = 0                                          
                   MOVE FEC-DMES(2) TO FEC-REST                         
               ELSE                                                     
                   SUBTRACT 1 FROM FEC-DMES(2) GIVING FEC-REST          
           ELSE                                                         
               MOVE FEC-DMES(FEC-MEC2) TO FEC-REST.                     
      *>JSS-FIN 16-DEC-1998                                              
           SUBTRACT FEC-FSA1 FROM FEC-FSA2 GIVING FEC-NANO.             
           IF FEC-NANO > 0                                              
               IF ( FEC-MEC2 < FEC-MEC1 ) OR                            
                  ( FEC-MEC2 = FEC-MEC1 AND FEC-DEC2 < FEC-DEC1         
      *>JSS-INI 16-DEC-1998                                              
                  AND NOT                                               
                  ( FEC-MEC1 = 2 AND FEC-MEC2 = 2 AND                   
                    FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST ) )     
      *>JSS-FIN 16-DEC-1998                                              
                   SUBTRACT 1 FROM FEC-NANO  GIVING FEC-NANO.           
       FIN-FEC-DIFF-ANO.                                                
           EXIT.                                                        
                                                                        
       FEC-CMP-F12 SECTION.                                             
       INI-FEC-CMP-F12.                                                 
           MOVE FEC-FEC1 TO FEC-FECH.                                   
           PERFORM FEC-EXT-SLSH.                                        
           PERFORM FEC-TRDC-FEC.                                        
           MOVE FEC-DVLD TO FEC-DEC1.                                   
           MOVE FEC-MVLD TO FEC-MEC1.                                   
           MOVE FEC-SVLD TO FEC-SEC1.                                   
           MOVE FEC-AVLD TO FEC-AEC1.                                   
                                                                        
           MOVE FEC-FEC2 TO FEC-FECH.                                   
           PERFORM FEC-EXT-SLSH.                                        
           PERFORM FEC-TRDC-FEC.                                        
           MOVE FEC-DVLD TO FEC-DEC2.                                   
           MOVE FEC-MVLD TO FEC-MEC2.                                   
           MOVE FEC-SVLD TO FEC-SEC2.                                   
           MOVE FEC-AVLD TO FEC-AEC2.                                   
                                                                        
           IF ( FEC-SEC1 > FEC-SEC2 )                         OR        
              ( FEC-SEC1 = FEC-SEC2 AND FEC-AEC1 > FEC-AEC2 ) OR        
              ( FEC-SEC1 = FEC-SEC2 AND FEC-AEC1 = FEC-AEC2 AND         
                FEC-MEC1 > FEC-MEC2 )                         OR        
              ( FEC-SEC1 = FEC-SEC2 AND FEC-AEC1 = FEC-AEC2 AND         
                FEC-MEC1 = FEC-MEC2 AND FEC-DEC1 > FEC-DEC2 )           
               MOVE '99' TO FEC-STAT                                    
               MOVE 'FECFEC1FEC2>' TO MSG-COD-MENS.                     
       FIN-FEC-CMP-F12.                                                 
           EXIT.                                                        
                     
      *> Obtiene Fecha y Hora Actual                                     
       GET-FHOY SECTION.                                                
       INI-GET-FHOY.                                                    
           MOVE SYS-GET-DATE TO SYS-CMND.                               
           PERFORM GNS-PRO-SYS.                                         
           MOVE SYS-DHOY TO HOY-DHOY.                                   
           MOVE SYS-MHOY TO HOY-MHOY.                                   
           MOVE SYS-SHOY TO HOY-SHOY.                                   
           MOVE SYS-AHOY TO HOY-AHOY.                                   
           MOVE SYS-HHHY TO HOY-HHHY.                                   
           MOVE SYS-MMHY TO HOY-MMHY.                                   
           MOVE SYS-SSHY TO HOY-SSHY.                                   
       FIN-GET-FHOY.                                                    
           EXIT.                                                        
                     
      *>****************************************************
      *>  Issue a TPCALL
      *>****************************************************
       GNS-FIO-DTC SECTION.
       INI-GNS-FIO-DTC.
      
           MOVE ADR-REQA             TO FIO-ORACLE-RQA.
           MOVE FIO-DFLD             TO FIO-ORACLE-DFLD.
           MOVE FIO-MENS             TO FIO-ORACLE-MENS.
           MOVE FIO-VARI             TO FIO-ORACLE-VARI.
           MOVE ADR-TABL IN ADR-REQA TO FIO-ORACLE-PROG-TAB.
           MOVE ADR-DBID IN ADR-REQA TO FIO-ORACLE-PROG-NUM.
           MOVE FIO-ORACLE           TO SEND-STRING-FIO.
      
           IF FIO-CMND = 38
              MOVE ZEROES TO FIO-STAT
              PERFORM TUX-BACK-OUT
              GO TO FIN-GNS-FIO-DTC.
      
           MOVE 3000                 TO LEN.
           MOVE "CARRAY"             TO REC-TYPE.
           MOVE FIO-ORACLE-PROG      TO SERVICE-NAME.
      
      
           MOVE FIO-CMND             TO LOGMSG-TEXT-1.
           MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
           MOVE SPACES               TO LOGMSG-TEXT-3.
           MOVE '40'                 TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
      
           SET TPBLOCK    IN TPSVCDEF-REC TO TRUE.
           SET TPTRAN     IN TPSVCDEF-REC TO TRUE.
           SET TPNOTIME   IN TPSVCDEF-REC TO TRUE.
           SET TPSIGRSTRT IN TPSVCDEF-REC TO TRUE.
           SET TPCHANGE   IN TPSVCDEF-REC TO TRUE.
      
           CALL "TPCALL" USING TPSVCDEF-REC
                TPTYPE-REC
                SEND-STRING-FIO
                TPTYPE-REC
                RECV-STRING-FIO
                TPSTATUS-REC.
      
      
           IF NOT TPOK
                DISPLAY 'GNSBGDTC :' FIO-ORACLE-PROG ' ' TP-STATUS
                MOVE "TPCALL Failed" TO FIO-MENS
                PERFORM PRG-ABT.
      
      
           MOVE FIO-CMND             TO LOGMSG-TEXT-1.
           MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
           MOVE SPACES               TO LOGMSG-TEXT-3.
           MOVE '41'                 TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
      
      
           MOVE RECV-STRING-FIO     TO FIO-ORACLE.
           MOVE FIO-ORACLE-RQA      TO ADR-REQA.
           MOVE FIO-ORACLE-DFLD     TO FIO-DFLD.
           MOVE FIO-ORACLE-MENS     TO FIO-MENS.
           MOVE FIO-ORACLE-VARI     TO FIO-VARI.
      
       FIN-GNS-FIO-DTC.
           EXIT.
      
       TUX-BACK-OUT SECTION.
       INI-TUX-BACK-OUT.
      
           CALL "TPGETLEV" USING TPTRXLEV-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPGETLEV:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'GNSBGDTC TUX-BACK-OUT TP-NOT-IN-TRAN:'
                                                TP-STATUS
                 GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPSUSPEND:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPRESUME" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPRESUME:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE TRANID(1)           TO TSK-TRANID-1.
           MOVE TRANID(2)           TO TSK-TRANID-2.
           MOVE TRANID(3)           TO TSK-TRANID-3.
           MOVE TRANID(4)           TO TSK-TRANID-4.
           MOVE TRANID(5)           TO TSK-TRANID-5.
           MOVE TRANID(6)           TO TSK-TRANID-6.
           MOVE SPACES              TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF      TO TSK-TERM-TUX.
      
           MOVE 'GET'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE SPACES              TO QUE-TRX-SEND.
           MOVE SPACES              TO QUE-DAT-SEND.
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE QUE-DAT-RECV        TO QUE-ITEM.
           MOVE QUE-DATA            TO TSK-INFO-TRAN.
           MOVE 1                   TO TSK-INFO-COMMIT.
      
           MOVE 'MOD'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE TSK-INFO-TRANID-ALF TO QUE-TRX-SEND.
      
           MOVE TSK-INFO-TRAN       TO QUE-DATA.
           MOVE QUE-ITEM            TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
       FIN-TUX-BACK-OUT.
           EXIT.
                     
      *> Modulo de Aborto Program  Interactivo                           
       PRG-ABT SECTION.                                                 
       INI-PRG-ABT.                                                     
           IF FRM-MENS > SPACES AND FIO-MENS NOT > SPACES               
               MOVE FRM-MENS TO FIO-MENS.                               
           MOVE FIO-MENS TO SYS-MENS.                                   
           MOVE SYS-ABOR TO SYS-CMND.                                   
           PERFORM GNS-PRO-SYS.                                         
       FIN-PRG-ABT.                                                     
           EXIT.                                                        
                     
      *>******************** FRM *********************                   
      *> V 2.0 SIN PTC                                                   
       GNS-PRO-FRM SECTION.                                             
       INI-GNS-PRO-FRM.                                                 
           GO TO CIC-FRM-INIT CIC-FRM-GETA CIC-FRM-PUTA CIC-FRM-CLRA    
                 CIC-FRM-EXIT CIC-FRM-XCTL CIC-FRM-MSGD CIC-FRM-RCEV    
                 CIC-FRM-FCLR CIC-FRM-FABT CIC-FRM-LINK                 
           DEPENDING ON FRM-CMND.                                       
           MOVE 'ABORTO: COMANDO INVALIDO EN GNS-PRO-FRM ' TO FRM-MEN1. 
           MOVE FRM-CMND                                   TO FRM-MEN2. 
           GO TO CIC-FRM-FABT.                                          
       CIC-FRM-INIT.                                                    
           IF FRM-SINI = FRM-SINI-MB1F OR FRM-SINI-DB1F                 
      *>EXEC CICS SEND                                                   
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          FROM(FRM-DFLD) CURSOR                                  
      *>          ERASE                                                  
      *>END-EXEC                                                         
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE QUE-DEL          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE FRM-DFLD         TO QUE-DATA                         
              MOVE QUE-PUT          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
                                                                        
           ELSE                                                         
           IF FRM-SINI = FRM-SINI-MBNF OR FRM-SINI-DBNF                 
      *>EXEC CICS SEND                                                   
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          FROM(FRM-DFLD) CURSOR                                  
      *>END-EXEC                                                         
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE QUE-DEL          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE FRM-DFLD         TO QUE-DATA                         
              MOVE QUE-PUT          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
           ELSE                                                         
      *>EXEC CICS SEND                                                   
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          CURSOR                                                 
      *>          MAPONLY                                                
      *>END-EXEC.                                                        
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE QUE-DEL          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE FRM-DFLD         TO QUE-DATA                         
              MOVE QUE-PUT          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE.                                      
                                                                        
       FIN-CIC-FRM-INIT.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-GETA.                                                    
      *>EXEC CICS RECEIVE                                                
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          INTO(FRM-DFLD)                                         
      *>END-EXEC.                                                        
           MOVE TSK-TERM-ALF     TO QUE-TERM.                           
           MOVE 'TSI'            TO QUE-TYPE.                           
           MOVE 1                TO QUE-NITM                            
           MOVE +2014            TO QUE-LITM.                           
           MOVE QUE-GET          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                      
           IF QUE-STAT = QUE-STAT-OKS                               
               MOVE QUE-DATA TO FRM-DFLD                            
               MOVE FRM-FFLD-RET TO FRM-FFLD                        
           ELSE                                                     
               MOVE SPACES TO FRM-DFLD                              
               MOVE FRM-FFLD-RET TO FRM-FFLD.                       
                                                                        
                                                                        
           MOVE EIBAID TO FRM-FFLD.                                     
           IF FRM-FFLD = FRM-FFLD-PFA                                   
               MOVE FRM-FFLD-PF1 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFB                                   
               MOVE FRM-FFLD-PF2 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFC                                   
               MOVE FRM-FFLD-PF3 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFD                                   
               MOVE FRM-FFLD-PF4 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFE                                   
               MOVE FRM-FFLD-PF5 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFF                                   
               MOVE FRM-FFLD-PF6 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFG                                   
               MOVE FRM-FFLD-PF7 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFH                                   
               MOVE FRM-FFLD-PF8 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFI                                   
               MOVE FRM-FFLD-PF9 TO FRM-FFLD                            
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFJ                                   
               MOVE FRM-FFLD-PF10 TO FRM-FFLD                           
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFK                                   
               MOVE FRM-FFLD-PF11 TO FRM-FFLD                           
           ELSE                                                         
           IF FRM-FFLD = FRM-FFLD-PFL                                   
               MOVE FRM-FFLD-PF12 TO FRM-FFLD.                          
           IF FRM-FFLD = FRM-FFLD-PF3  OR FRM-FFLD-PF12                 
               MOVE 'ABT' TO FRM-STAT.                                  
       FIN-CIC-FRM-GETA.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-PUTA.                                                    
      *>EXEC CICS SEND                                                   
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          FROM(FRM-DFLD) CURSOR                                  
      *>          DATAONLY                                               
      *>END-EXEC.                                                        
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE QUE-DEL          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE FRM-DFLD         TO QUE-DATA                         
              MOVE QUE-PUT          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE.                                      
                                                                        
       FIN-CIC-FRM-PUTA.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-CLRA.                                                    
      *>EXEC CICS SEND                                                   
      *>          MAP(FRM-NAME)                                          
      *>          MAPSET(FRM-NLIB)                                       
      *>          FROM(FRM-DFLD) CURSOR                                  
      *>          DATAONLY                                               
      *>          ERASEAUP                                               
      *>END-EXEC.                                                        
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE QUE-DEL          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE                                      
              MOVE TSK-TERM-ALF     TO QUE-TERM                         
              MOVE 'TSI'            TO QUE-TYPE                         
              MOVE 1                TO QUE-NITM                         
              MOVE +2014            TO QUE-LITM                         
              MOVE FRM-DFLD         TO QUE-DATA                         
              MOVE QUE-PUT          TO QUE-CMND                         
              PERFORM GNS-PRO-QUE.                                      
                                                                        
                                                                        
       FIN-CIC-FRM-CLRA.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-EXIT.                                                    
      *>EXEC CICS RETURN                                                 
      *>          TRANSID(FRM-NTRN)                                      
      *>          COMMAREA(FRM-CMMA)                                     
      *>          LENGTH(FRM-TCMA)                                       
      *>END-EXEC.                                                        
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE FRM-NTRN TO SYS-SCR-NTRN. 
           MOVE FRM-TCMA TO LEN.
           SET TPSUCCESS TO TRUE.
           CALL "TPRETURN" USING TPSVCRET-REC
                                 TPTYPE-REC
                                 FRM-CMMA
                                 TPSTATUS-REC.
           GOBACK.                                                      
                                                                        
       FIN-CIC-FRM-EXIT.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-XCTL.                                                    
      *>EXEC CICS XCTL                                                   
      *>          PROGRAM(FRM-PROG)                                      
      *>          COMMAREA(FRM-CMMA)                                     
      *>          LENGTH(FRM-TCMA)                                       
      *>END-EXEC.                                                        
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE FRM-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE FRM-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  FRM-CMMA
                                  TPSTATUS-REC.
           GOBACK.                                                      
                                                                        
       FIN-CIC-FRM-XCTL.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-MSGD.                                                    
      *>EXEC CICS SEND                                                   
      *>          FROM(FRM-MENS)                                         
      *>          LENGTH(79)                                             
      *>END-EXEC.                                                        
      
       FIN-CIC-FRM-MSGD.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-RCEV.                                                    
      *>EXEC CICS RECEIVE                                                
      *>          INTO(FRM-DFLD)                                         
      *>          LENGTH(FRM-LFLD)                                       
      *>END-EXEC.                                                        
           MOVE TSK-TERM-ALF     TO QUE-TERM.                           
           MOVE 'TSI'            TO QUE-TYPE.                           
           MOVE 1                TO QUE-NITM                            
           MOVE +2014            TO QUE-LITM.                           
           MOVE QUE-GET          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                      
           IF QUE-STAT = QUE-STAT-OKS                               
               MOVE QUE-DATA TO FRM-DFLD                            
               MOVE FRM-FFLD-RET TO FRM-FFLD                        
           ELSE                                                     
               MOVE SPACES TO FRM-DFLD                              
               MOVE FRM-FFLD-RET TO FRM-FFLD.                       
                                                                        
                                                                        
                                                                        
       FIN-CIC-FRM-RCEV.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-FCLR.                                                    
                                                                        
       FIN-CIC-FRM-FCLR.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-FABT.                                                    
           MOVE SYS-PABT TO FRM-PROG.                                   
           MOVE +3500    TO FRM-TCMA.                                   
           MOVE FRM-MENS TO FRM-SCR-MENS.                               
           MOVE SCR-VARI TO FRM-SCR-VARI.                               
      *>EXEC CICS XCTL                                                   
      *>          PROGRAM(FRM-PROG)                                      
      *>          COMMAREA(FRM-CMMA)                                     
      *>          LENGTH(FRM-TCMA)                                       
      *>END-EXEC.                                                        
           MOVE FRM-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE FRM-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  FRM-CMMA
                                  TPSTATUS-REC.
                                                                        
                                                                        
                                                                        
       FIN-CIC-FRM-FABT.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       CIC-FRM-LINK.                                                    
      *>EXEC CICS LINK                                                   
      *>          PROGRAM(FRM-PROG)                                      
      *>          COMMAREA(FRM-CMMA)                                     
      *>          LENGTH(FRM-TCMA)                                       
      *>END-EXEC.                                                        
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE FRM-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE FRM-PROG   TO SERVICE-NAME.
           CALL "TPCALL" USING TPSVCDEF-REC 
                               TPTYPE-REC 
                               FRM-CMMA
                               TPTYPE-REC 
                               FRM-CMMA
                               TPSTATUS-REC. 
                                                                        
                                                                        
                                                                        
       FIN-CIC-FRM-LINK.                                                
           GO TO FIN-GNS-PRO-FRM.                                       
       FIN-GNS-PRO-FRM.                                                 
           EXIT.                                                        
                     
      *> Rutina de Servicios del Sistema
       GNS-PRO-SYS SECTION.
       INI-GNS-PRO-SYS.
      
      
           MOVE SYS-STAT-OKS TO SYS-STAT.
           IF SYS-IHDL NOT > SPACES
               MOVE 'N' TO SYS-IHDL.
      
           GO TO DAT-GNS-PRO-SYS TIM-GNS-PRO-SYS EXT-GNS-PRO-SYS
                 XCT-GNS-PRO-SYS LNK-GNS-PRO-SYS ABT-GNS-PRO-SYS
           DEPENDING ON SYS-CMND.
           MOVE 'ABORTO, comando invalido en GNS-PRO-SYS:' TO SYS-MEN1.
           MOVE SYS-CMND                                   TO SYS-MEN2.
           GO TO ABT-GNS-PRO-SYS.
      
       DAT-GNS-PRO-SYS.
      
      
           IF SYS-HORA-HABI = 'S' AND SYS-HORA-FLAG = 'S'
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
           ACCEPT SYS-FHOY-2B FROM DATE.
      
           MOVE SYS-DHOY-2B TO SYS-DHOY.
           MOVE '/'         TO SYS-SLH1.
           MOVE SYS-MHOY-2B TO SYS-MHOY.
           MOVE '/'         TO SYS-SLH2.
           MOVE SYS-AHOY-2B TO SYS-AHOY.
      
           ACCEPT SYS-HHOY-2B FROM TIME.
      
           MOVE   SYS-HHHY-2B TO SYS-HHHY.
           MOVE   SYS-MMHY-2B TO SYS-MMHY.
           MOVE   SYS-SSHY-2B TO SYS-SSHY.
      
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
           IF SYS-AHOY < 60
               MOVE 20 TO SYS-SHOY SYS-SSTP
           ELSE
               MOVE 19 TO SYS-SHOY SYS-SSTP.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
      
      
           MOVE FYH-TCMA       TO LEN.
           MOVE "CARRAY"       TO REC-TYPE.
           MOVE FYH-PROG       TO SERVICE-NAME.
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               FYH-CMMA
                               TPTYPE-REC
                               FYH-CMMA
                               TPSTATUS-REC.
      
           IF NOT TPOK
              DISPLAY 'DAT-GNS-PRO-SYS    :' FYH-PROG
                                       ' '   TP-STATUS
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
      
           MOVE FYH-NUM-DHOY IN FYH-CMMA TO SYS-DHOY.
           MOVE '/'                      TO SYS-SLH1.
           MOVE FYH-NUM-MHOY IN FYH-CMMA TO SYS-MHOY.
           MOVE '/'                      TO SYS-SLH2.
           MOVE FYH-NUM-AHOY IN FYH-CMMA TO SYS-AHOY.
      
           MOVE FYH-NUM-HHHY IN FYH-CMMA TO SYS-HHHY.
           MOVE FYH-NUM-MMHY IN FYH-CMMA TO SYS-MMHY.
           MOVE FYH-NUM-SSHY IN FYH-CMMA TO SYS-SSHY.
      
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
           IF SYS-AHOY < 60
               MOVE 20 TO SYS-SHOY SYS-SSTP
           ELSE
               MOVE 19 TO SYS-SHOY SYS-SSTP.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
      
           IF SYS-HORA-HABI = 'S' 
              MOVE 'S' TO SYS-HORA-FLAG
           ELSE   
              MOVE 'N' TO SYS-HORA-FLAG.
      
           GO TO FIN-GNS-PRO-SYS.
       TIM-GNS-PRO-SYS.
      
           ACCEPT SYS-HHOY-2B FROM TIME.
           MOVE   SYS-HHHY-2B TO SYS-HHHY.
           MOVE   SYS-MMHY-2B TO SYS-MMHY.
           MOVE   SYS-SSHY-2B TO SYS-SSHY.
      
      
           MOVE FYH-TCMA       TO LEN.
           MOVE "CARRAY"       TO REC-TYPE.
           MOVE FYH-PROG       TO SERVICE-NAME.
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               FYH-CMMA
                               TPTYPE-REC
                               FYH-CMMA
                               TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'TIM-GNS-PRO-SYS    :' FYH-PROG
                                       ' '   TP-STATUS
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
           MOVE FYH-NUM-HHHY IN FYH-CMMA TO SYS-HHHY.
           MOVE FYH-NUM-MMHY IN FYH-CMMA TO SYS-MMHY.
           MOVE FYH-NUM-SSHY IN FYH-CMMA TO SYS-SSHY.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
           GO TO FIN-GNS-PRO-SYS.
      
       EXT-GNS-PRO-SYS.
      
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-NTRN TO SYS-SCR-NTRN.
           MOVE +3500 TO LEN.
      
           SET TPSUCCESS TO TRUE.
           CALL "TPRETURN" USING TPSVCRET-REC
                                 TPTYPE-REC
                                 SYS-CMMA
                                 TPSTATUS-REC.
      
           GOBACK.
           GO TO STT-GNS-PRO-SYS.
       XCT-GNS-PRO-SYS.
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-TCMA   TO LEN.
           DISPLAY 'GNS SYS-CMMA:'SYS-CMMA.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  SYS-CMMA
                                  TPSTATUS-REC.
           IF NOT TPOK
           DISPLAY 'XCT-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
           GOBACK.
           GO TO STT-GNS-PRO-SYS.
       LNK-GNS-PRO-SYS.
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
      
           DISPLAY 'SYS-CMMA :' SYS-CMMA.
      
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               SYS-CMMA
                               TPTYPE-REC
                               SYS-CMMA
                               TPSTATUS-REC.
      
           IF NOT TPOK
           DISPLAY 'LNK-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
      
           GO TO STT-GNS-PRO-SYS.
      
       ABT-GNS-PRO-SYS.
      
           MOVE 'GNSPPABT' TO SYS-PROG.
           MOVE +79        TO SYS-TCMA.
           MOVE SYS-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  SYS-MENS
                                  TPSTATUS-REC.
           IF NOT TPOK
           DISPLAY 'ABT-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
           GOBACK.
      
       STT-GNS-PRO-SYS.
           IF TPOK
               MOVE '00' TO SYS-STAT
               GO TO FIN-GNS-PRO-SYS.
      
           MOVE TP-STATUS                         TO SYS-STAT-NUM.
           MOVE 'Aborto, EN GNS-PRO-SYS , CMD : ' TO SYS-MEN1.
           MOVE SYS-CMND                          TO SYS-MEN2.
           MOVE SYS-STAT-NUM TO SYS-STAT.
           GO TO ABT-GNS-PRO-SYS.
      
       FIN-GNS-PRO-SYS.
           EXIT.
      
      *>*****************************************************
      *> Write out a log err messages
      *>*****************************************************
       DO-USERLOG SECTION.
       INI-DO-USERLOG.
      
           MOVE LENGTH OF LOGMSG TO LOGMSG-LEN.
           ACCEPT SYS-HHOY-2B  FROM TIME.
           MOVE  SYS-HHOY-2B     TO LOGMSG-TIME.
           CALL "USERLOG" USING LOGMSG
                LOGMSG-LEN
                TPSTATUS-REC.
      
       FIN-DO-USERLOG.
           EXIT.
                     
      *> Rutina para redondeo de decimales
       PES-SCTV SECTION.
       INI-PES-SCTV.
           IF PES-NUM-DECI IN PES-VARI NOT > 0
      *>ADA-INI 8-ENE-2002
      *>       IF PES-CIC-VCAM = PDB-CIC-1013
      *>          MOVE 2 TO PES-NUM-DECI IN PES-VARI
      *>       ELSE
      *>       IF PES-CIC-VCAM = PDB-CIC-0998
      *>          MOVE 4 TO PES-NUM-DECI IN PES-VARI.
              IF PES-CIC-VCAM = PDB-CIC-0999
                  NEXT SENTENCE
              ELSE
              IF PES-CIC-VCAM = PDB-CIC-0998
                  MOVE 4 TO PES-NUM-DECI IN PES-VARI
              ELSE
              IF PES-CIC-TVAL = PDB-CIC-MEXT
                  MOVE 2 TO PES-NUM-DECI IN PES-VARI.
      *>ADA-FIN 8-ENE-2002
      
      *> Parrafo para 0 ROUNDED
           IF PES-NUM-DECI IN PES-VARI = 0
              ADD 0 PES-SGV-DECI IN PES-VARI
              GIVING PES-SGV-ENT0 IN PES-VARI ROUNDED
              MOVE PES-SGV-ENT0 IN PES-VARI TO
                                PES-SGV-ENTE IN PES-VARI
           ELSE
      *> Parrafo para 1 ROUNDED
           IF PES-NUM-DECI IN PES-VARI = 1
              ADD 0 PES-SGV-DECI IN PES-VARI
              GIVING PES-SGV-ENT1 IN PES-VARI ROUNDED
              MOVE PES-SGV-ENT1 IN PES-VARI TO
                                PES-SGV-ENTE IN PES-VARI
           ELSE
      *> Parrafo para 2 ROUNDED
           IF PES-NUM-DECI IN PES-VARI = 2
              ADD 0 PES-SGV-DECI IN PES-VARI
              GIVING PES-SGV-ENT2 IN PES-VARI ROUNDED
              MOVE PES-SGV-ENT2 IN PES-VARI TO
                                PES-SGV-ENTE IN PES-VARI
           ELSE
      *> Parrafo para 3 ROUNDED
           IF PES-NUM-DECI IN PES-VARI = 3
              ADD 0 PES-SGV-DECI IN PES-VARI
              GIVING PES-SGV-ENT3 IN PES-VARI ROUNDED
              MOVE PES-SGV-ENT3 IN PES-VARI TO
                                PES-SGV-ENTE IN PES-VARI
           ELSE
      *> Parrafo para 4 ROUNDED
              ADD 0 PES-SGV-DECI IN PES-VARI
              GIVING PES-SGV-ENTE IN PES-VARI ROUNDED.
      
           MOVE 0      TO PES-NUM-DECI IN PES-VARI.
           MOVE SPACES TO PES-CIC-VCAM IN PES-VARI.
       FIN-PES-SCTV.
           EXIT.
                     
      *> Rutina para compactar blancos de un string de caracteres        
       CPT-BLKS SECTION.                                                
       INI-CPT-BLKS.                                                    
           MOVE 1   TO CPT-I CPT-J.                                     
           MOVE 'N' TO CPT-IBLK.                                        
       LUP-CPT-BLKS.                                                    
           IF CPT-STRN-RED(CPT-J) > SPACES                              
               MOVE CPT-STRN-RED(CPT-J) TO CPT-STRN-RED(CPT-I)          
               ADD 1 TO CPT-I                                           
               ADD 1 TO CPT-J                                           
               MOVE 'S' TO CPT-IBLK                                     
           ELSE                                                         
               IF CPT-PONGO-BLANCO                                      
                   MOVE SPACES TO CPT-STRN-RED(CPT-I)                   
                   MOVE 'N'   TO CPT-IBLK                               
                   MOVE CPT-I TO CPT-UBLK                               
                   ADD 1 TO CPT-I                                       
                   ADD 1 TO CPT-J                                       
               ELSE                                                     
                   ADD 1 TO CPT-J.                                      
           IF CPT-J NOT > CPT-LENG                                      
               GO TO LUP-CPT-BLKS.                                      
       BLK-CPT-BLKS.                                                    
           IF CPT-UBLK = ZEROES                                         
               MOVE SPACES TO CPT-STRN                                  
           ELSE                                                         
           IF CPT-UBLK NOT > CPT-LENG                                   
               MOVE SPACES TO CPT-STRN-RED(CPT-UBLK)                    
               ADD 1 TO CPT-UBLK                                        
               GO TO BLK-CPT-BLKS.                                      
       FIN-CPT-BLKS.                                                    
           EXIT.                                                        
                     
      *> Procesa Digito Verificador                                      
       PRO-VRF SECTION.                                                 
       INI-PRO-VRF.                                                     
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE ZEROES TO VRF-STAT.                                     
      *>JSS                                                              
           IF VRF-NUME = ZEROES                                         
               IF VRF-ZERO = VRF-ZERO-N                                 
                   MOVE VRF-SBLK     TO VRF-STAT                        
                   MOVE 'NUM    BLK' TO MSG-COD-MENS                    
                   GO TO ERR-PRO-VRF                                    
               ELSE                                                     
               IF VRF-DVRF > SPACES                                     
                   MOVE VRF-SBLK       TO VRF-STAT                      
                   MOVE 'VRF    SNNUM' TO MSG-COD-MENS                  
                   GO TO ERR-PRO-VRF                                    
               ELSE                                                     
                   GO TO FIN-PRO-VRF.                                   
      *>                                                                 
      *>    CALL "GNSPKVRF" USING DFHEIBLK DFHCOMMAREA VRF-VARI.         
           PERFORM VAL-VRF.
           IF VRF-STAT-OKS                                              
               GO TO FIN-PRO-VRF.                                       
           IF VRF-CMSG > SPACES                                         
               MOVE VRF-CMSG TO MSG-COD-MENS                            
           ELSE                                                         
               MOVE 'VRF    NOT' TO MSG-COD-MENS.                       
       ERR-PRO-VRF.                                                     
           MOVE 'GNS' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
       FIN-PRO-VRF.                                                     
           EXIT.                                                        
       VAL-VRF SECTION.
       INI-VAL-VRF.
           CALL 'GNSPKVRF' USING VRF-VARI.
      *>     MOVE VRF-VARI            TO SYS-CMMA.
      *>     MOVE +37                 TO SYS-TCMA.
      *>     MOVE SYS-LINK            TO SYS-CMND.
      *>     MOVE "GNSPPVRF"          TO SYS-PROG.
      *>     PERFORM GNS-PRO-SYS.
      *>     MOVE SYS-CMMA            TO VRF-VARI. 
       FIN-VAL-VRF.
           EXIT.
                     
      *>Modulo interactivo que busca IDD.                                
       GNS-BUS-IDD SECTION.                                             
       INI-GNS-BUS-IDD.                                                 
           IF SCR-QIDD > SPACES                                         
      *>EXEC CICS READQ TS                                               
      *>          QUEUE(SCR-QIDD)                                        
      *>          INTO(IDD-REGI)                                         
      *>          LENGTH(SCR-LIDD)                                       
      *>          ITEM(1)                                                
      *>END-EXEC.     
      
      
           MOVE 'GET'    TO QUE-COM-SEND
           MOVE SCR-QIDD TO QUE-NAM-SEND
           MOVE 1        TO QUE-NUM-SEND
           MOVE SCR-LIDD TO QUE-LAR-SEND
           MOVE SPACES   TO QUE-TRX-SEND
           MOVE SPACES   TO QUE-DAT-SEND
           PERFORM GNS-MSJ-QUE
           IF QUE-STAT = QUE-STAT-OKS
             MOVE QUE-ITEM TO IDD-REGI     
             GO TO FIN-GNS-BUS-IDD.                                     
       
           MOVE 'GIDD'    TO EIBTASKN-11
           MOVE EIBTASKN  TO EIBTASKN-12
      
           MOVE 'GET'      TO QUE-COM-SEND
           MOVE EIBTASKN-1 TO QUE-NAM-SEND
           MOVE 1          TO QUE-NUM-SEND
           MOVE SCR-LIDD   TO QUE-LAR-SEND
           MOVE SPACES     TO QUE-TRX-SEND
           MOVE SPACES     TO QUE-DAT-SEND
           PERFORM GNS-MSJ-QUE
           IF QUE-STAT = QUE-STAT-OKS
             MOVE QUE-ITEM TO IDD-REGI                                  
             GO TO FIN-GNS-BUS-IDD.                                     
       
           DISPLAY 'NO ENCONTRO IDD :' EIBTASKN-1
                                       SCR-QIDD.
      
       FIN-GNS-BUS-IDD.                                                 
           EXIT.                                                        
                     
      *>Modulo Generico Manejo de Colas
      
       GNS-CHK-QUEU SECTION.
      
       INI-GNS-CHK-QUEU.
      
           MOVE 1 TO QUE-NITM.
      
           MOVE QUE-GET TO QUE-CMND.
      
           PERFORM GNS-PRO-QUE.
      
       FIN-GNS-CHK-QUEU.
      
           EXIT.
      
      
      
       GNS-QUE-EOQ SECTION.
      
       INI-GNS-QUE-EOQ.
      
           MOVE QUE-STAT-EOQ TO QUE-STAT.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-QUE-EOQ.
      
           EXIT.
      
      
      
       GNS-QUE-NEX SECTION.
      
       INI-GNS-QUE-NEX.
      
           MOVE QUE-STAT-NEX TO QUE-STAT.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-QUE-NEX.
      
           EXIT.
      
      
      
       GNS-ERR-QUE SECTION.
      
       INI-GNS-ERR-QUE.
      
      
      
      *>     EXEC CICS HANDLE CONDITION
      
      *>               QIDERR (GNS-QUE-NEX)
      
      *>               ITEMERR(GNS-QUE-EOQ)
      
      *>               LENGERR(GNS-QUE-NEX)
      
      *>     END-EXEC.
      
      
      
       FIN-GNS-ERR-QUE.
      
           EXIT.
      
      
      
       GNS-PRO-QUE SECTION.
      
       INI-GNS-PRO-QUE.
      
      
      
           MOVE QUE-STAT-OKS TO QUE-STAT.
      
      
      
           IF QUE-CMND = QUE-PUT
      
               GO TO GNS-PUT-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-GET
      
               GO TO GNS-GET-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-MOD
      
               GO TO GNS-MOD-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-DEL
      
               GO TO GNS-DEL-QUE.
      
      
      
      
      
      
      
           MOVE 'Comando invalido :' TO QUE-MEN1.
      
           MOVE QUE-CMND             TO QUE-MEN2.
      
           MOVE QUE-MENS             TO FIO-MENS.
      
      
      
      *>     EXEC CICS XCTL
      
      *>               PROGRAM("GNSPPABT")
      
      *>               COMMAREA(QUE-MENS)
      
      *>               LENGTH(+79)
      
      *>     END-EXEC.
      
      
      
           MOVE +79                  TO LEN.
      
           MOVE "CARRAY"             TO REC-TYPE.
      
           MOVE 'GNSPPABT'           TO SERVICE-NAME.
      
           CALL "TPFORWARD" USING TPSVCDEF-REC
      
                                  TPTYPE-REC
      
                                  QUE-MENS
      
                                  TPSTATUS-REC.
      
      
      
           GOBACK.
      
      
      
      
      
      
      
      
      
       GNS-PUT-QUE.
      
      
      
      *>     EXEC CICS WRITEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               FROM(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               AUXILIARY
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE ZEROES   TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE QUE-ITEM TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
      
      
       FIN-GNS-PUT-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       GNS-GET-QUE.
      
      
      
      *>     EXEC CICS READQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               INTO(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               ITEM(QUE-NITM)
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE SPACES   TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
       FIN-GNS-GET-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       GNS-MOD-QUE.
      
      
      
      *>     EXEC CICS WRITEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               FROM(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               ITEM(QUE-NITM)
      
      *>               REWRITE
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE QUE-ITEM TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
       FIN-GNS-MOD-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
      
      
       GNS-DEL-QUE.
      
      
      
      *>     EXEC CICS DELETEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
      *>    MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE ZEROES   TO QUE-NUM-SEND.
      
           MOVE ZEROES   TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE SPACES   TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
      
      
       FIN-GNS-DEL-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-PRO-QUE.
      
           EXIT.
      
      
      
       GNS-MSJ-QUE SECTION.
      
       INI-GNS-MSJ-QUE.
      
      
      
      *>     SET QUE-TPNOTRAN    TO TRUE.
      
           SET QUE-TPTRAN      TO TRUE.
      
           SET QUE-TPBLOCK     TO TRUE.
      
           SET QUE-TPNOTIME    TO TRUE.
      
           SET QUE-TPSIGRSTRT  TO TRUE.
      
           SET QUE-TPCHANGE    TO TRUE.
      
          
           MOVE SPACES TO QUE-RECV.
      
      
      *>    MOVE "00"         TO LOGMSG-NUMB.
      
      *>    MOVE QUE-COM-SEND TO LOGMSG-TEXT.
      
      *>    PERFORM DO-USERLOG.
      
      
      
           CALL "TPCALL" USING QUE-TPSVCDEF-REC
      
                QUE-TPTYPE-REC-SEND
      
                QUE-SEND
      
                QUE-TPTYPE-REC-RECV
      
                QUE-RECV
      
                TPSTATUS-REC.
      
      
      
      *>    MOVE "01"         TO LOGMSG-NUMB.
      
      *>    MOVE QUE-COM-SEND TO LOGMSG-TEXT.
      
      *>    PERFORM DO-USERLOG.
      
      
      
           IF NOT TPOK
      
              MOVE QUE-STAT-NEX TO QUE-STAT
      
              DISPLAY 'TEMPORAL STORAGE :' TP-STATUS
      
              MOVE TP-STATUS    TO QUE-NUM-STAT
      
              MOVE QUE-NUM-STAT TO QUE-GLS-STAT
      
           ELSE
      
              IF QUE-STA-RECV = ZEROES
      
                 MOVE QUE-STAT-OKS TO QUE-STAT
      
                 MOVE QUE-DAT-RECV TO QUE-ITEM
      
              ELSE
      
                 MOVE QUE-STAT-NEX TO QUE-STAT.
      
      
      
       FIN-GNS-MSJ-QUE.
      
           EXIT.
      
      
      
                     
       GET-TSK-TERM SECTION.                                            
       INI-GET-TSK-TERM.                                                
      
           IF TSK-TERM-ORIGEN = 'S'
              GO TO FIN-GET-TSK-TERM.                                   
      
           CALL "TPGETLEV" USING TPTRXLEV-REC
                                 TPSTATUS-REC. 
           IF NOT TPOK
              DISPLAY 'ERROR  TPGETLEV :' TP-STATUS
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'TPGETLEV TP-NOT-IN-TRAN:' TP-STATUS.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC
                                 TPSTATUS-REC.                          
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           
           CALL "TPRESUME" USING TPTRXDEF-REC
                                 TPSTATUS-REC.             
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           MOVE TRANID(1) TO TSK-TRANID-1.
           MOVE TRANID(2) TO TSK-TRANID-2.
           MOVE TRANID(3) TO TSK-TRANID-3.
           MOVE TRANID(4) TO TSK-TRANID-4.
           MOVE TRANID(5) TO TSK-TRANID-5.
           MOVE TRANID(6) TO TSK-TRANID-6.
      
           MOVE SPACES         TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF TO TSK-TERM-TUX.
      
           MOVE TSK-TERM-TUX        TO TSK-TERM-TUX.                    
           MOVE 'GET'               TO QUE-COM-SEND.                    
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.      
           MOVE 1                   TO QUE-NUM-SEND.      
           MOVE 4                   TO QUE-LAR-SEND.      
           MOVE SPACES              TO QUE-TRX-SEND.      
           MOVE SPACES              TO QUE-DAT-SEND.                    
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              DISPLAY 'NO ENCONTRO COLA ASUME 1111111 :' TSK-TERM-TUX  
              MOVE 1111111          TO TSK-TERM-NUM-TUX
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-NUM     TO EIBTASKN
              GO TO FIN-GET-TSK-TERM.                                   
           
           
           MOVE QUE-DAT-RECV        TO QUE-ITEM.           
           MOVE QUE-DATA            TO TSK-TERM-NUM-TUX-ALF.
           MOVE TSK-TERM-NUM-TUX    TO TSK-TERM-NUM.
           MOVE TSK-TERM-ALF        TO EIBTASKN.
           MOVE TSK-TERM-ALF        TO EIBTRMID.
           
      *>     DISPLAY "SI ENCONTRO COLA ASUME " TSK-TERM-NUM-TUX " :" 
      *>                                       TSK-TERM-TUX " :"
      *>                                       TSK-TERM-ALF " :"  
      *>                                       EIBTASKN.
      
       FIN-GET-TSK-TERM.                                                
           EXIT.                                                        
                     
      *>INI-MFC TUXEDO ORACLE
       GNS-PRO-LIMPIAR-VARIABLES SECTION.
       INI-GNS-PRO-LIMPIAR-VARIABLES.
      
           MOVE 0 TO SCR-TCMA IN SCR-VARI.
           MOVE SPACES TO SCR-SIST IN SCR-VARI.
           MOVE SPACES TO SCR-SISG IN SCR-VARI.
           MOVE SPACES TO SCR-NTRN IN SCR-VARI.
           MOVE SPACES TO SCR-PROG IN SCR-VARI.
           MOVE SPACES TO SCR-NTRV IN SCR-VARI.
           MOVE SPACES TO SCR-PROV IN SCR-VARI.
           MOVE SPACES TO SCR-NLIB IN SCR-VARI.
           MOVE SPACES TO SCR-NMAP IN SCR-VARI.
           MOVE SPACES TO SCR-RFBY IN SCR-VARI.
           MOVE SPACES TO SCR-STAT IN SCR-VARI.
           MOVE SPACES TO SCR-INST IN SCR-VARI.
           MOVE SPACES TO SCR-ACTU IN SCR-VARI.
           MOVE SPACES TO SCR-CMNP IN SCR-VARI.
           MOVE LOW-VALUE TO SCR-CRPF IN SCR-VARI.
           MOVE SPACES TO SCR-CMND IN SCR-CRPF.
           MOVE SPACES TO SCR-CCPP IN SCR-CRPF.
           MOVE SPACES TO SCR-STPP IN SCR-CRPF.
           MOVE SPACES TO SCR-PRMT IN SCR-CRPF.
           MOVE SPACES TO SCR-CONF IN SCR-CRPF.
           MOVE SPACES TO SCR-USER IN SCR-VARI.
           MOVE SPACES TO SCR-OTRN IN SCR-VARI.
           MOVE SPACES TO SCR-UMOD IN SCR-VARI.
           MOVE SPACES TO SCR-ICMN IN SCR-VARI.
           MOVE SPACES TO SCR-QIDD IN SCR-VARI.
           MOVE 0 TO SCR-LIDD IN SCR-VARI.
           MOVE SPACES TO SCR-NEMO IN SCR-VARI.
           MOVE SPACES TO SCR-LDOC IN SCR-VARI.
           MOVE LOW-VALUE TO SCR-NDOC IN SCR-VARI.
           MOVE SPACES TO SCR-HDR-BNCO IN SCR-NDOC.
           MOVE SPACES TO SCR-HDR-MRCA IN SCR-NDOC.
           MOVE SPACES TO SCR-HDR-CART IN SCR-NDOC.
           MOVE SPACES TO SCR-HDR-LENG IN SCR-NDOC.
           MOVE SPACES TO SCR-HDR-PAIS IN SCR-NDOC.
           MOVE SPACES TO SCR-HDR-VRNT IN SCR-NDOC.
           MOVE SPACES TO SCR-NDOC-DISP IN SCR-NDOC.
           MOVE SPACES TO SCR-FRET IN SCR-VARI.
           MOVE SPACES TO SCR-IPRV IN SCR-VARI.
           MOVE SPACES TO SCR-MFLD IN SCR-VARI.
           MOVE SPACES TO SCR-VFLD IN SCR-VARI.
           MOVE SPACES TO SCR-FFLD IN SCR-VARI.
           MOVE SPACES TO SCR-DISP IN SCR-VARI.
           MOVE SPACES TO ADR-PROG IN ADR-UIFB.
           MOVE LOW-VALUE TO CPT-STRN IN CPT-VARI.
           MOVE SPACES TO CPT-STR1 IN CPT-STRN.
           MOVE SPACES TO CPT-STR2 IN CPT-STRN.
           MOVE 100 TO CPT-LENG IN CPT-VARI.
           MOVE SPACES TO CPT-IBLK IN CPT-VARI.
           MOVE 0 TO CPT-UBLK IN CPT-VARI.
           MOVE 0 TO CPT-I IN CPT-VARI.
           MOVE 0 TO CPT-J IN CPT-VARI.
           MOVE SPACES TO ADR-ELM1 IN ADR-ELLS.
           MOVE SPACES TO ADR-CSEG IN ADR-ELLS.
           MOVE 0 TO FIO-ACCS-DEF IN FIO-CTTS.
           MOVE 1 TO FIO-ACCS-NOT IN FIO-CTTS.
           MOVE 2 TO FIO-ACCS-INP IN FIO-CTTS.
           MOVE 3 TO FIO-ACCS-UPD IN FIO-CTTS.
           MOVE 0 TO FIO-RLCK-FIO IN FIO-CTTS.
           MOVE 1 TO FIO-RLCK-PGM IN FIO-CTTS.
           MOVE 0 TO FIO-IFNF-FIO IN FIO-CTTS.
           MOVE 1 TO FIO-IFNF-PGM IN FIO-CTTS.
           MOVE '39' TO FIO-STAT-NEX IN FIO-CTTS.
           MOVE LOW-VALUE TO FIO-VCMN IN FIO-CTTS.
           MOVE 1 TO FIO-GET-KEY IN FIO-VCMN.
           MOVE 2 TO FIO-GET-NXT IN FIO-VCMN.
           MOVE 3 TO FIO-GET-FST IN FIO-VCMN.
           MOVE 4 TO FIO-GET-NLS IN FIO-VCMN.
           MOVE 5 TO FIO-GET-GRT IN FIO-VCMN.
           MOVE 6 TO FIO-PUT IN FIO-VCMN.
           MOVE 7 TO FIO-MOD IN FIO-VCMN.
           MOVE 8 TO FIO-DEL IN FIO-VCMN.
           MOVE 9 TO FIO-CHG IN FIO-VCMN.
           MOVE 10 TO FIO-INP IN FIO-VCMN.
           MOVE 11 TO FIO-OUT IN FIO-VCMN.
           MOVE 12 TO FIO-UPD IN FIO-VCMN.
           MOVE 13 TO FIO-CLO IN FIO-VCMN.
           MOVE 14 TO FIO-FND-EQL IN FIO-VCMN.
           MOVE 15 TO FIO-FND-FST IN FIO-VCMN.
           MOVE 16 TO FIO-FND-NLS IN FIO-VCMN.
           MOVE 17 TO FIO-FND-GRT IN FIO-VCMN.
           MOVE 18 TO FIO-ULK-REC IN FIO-VCMN.
           MOVE 19 TO FIO-ULK-ALL IN FIO-VCMN.
           MOVE 20 TO FIO-VID IN FIO-VCMN.
           MOVE 21 TO FIO-ACC IN FIO-VCMN.
           MOVE 22 TO FIO-REC-LCK IN FIO-VCMN.
           MOVE 23 TO FIO-FNF IN FIO-VCMN.
           MOVE 24 TO FIO-REC-LEN IN FIO-VCMN.
           MOVE 25 TO FIO-EXT IN FIO-VCMN.
           MOVE 26 TO FIO-GET-KEY-ALT IN FIO-VCMN.
           MOVE 27 TO FIO-GET-FST-ALT IN FIO-VCMN.
           MOVE 28 TO FIO-GET-NLS-ALT IN FIO-VCMN.
           MOVE 29 TO FIO-GET-GRT-ALT IN FIO-VCMN.
           MOVE 30 TO FIO-FND-EQL-ALT IN FIO-VCMN.
           MOVE 31 TO FIO-FND-FST-ALT IN FIO-VCMN.
           MOVE 32 TO FIO-FND-NLS-ALT IN FIO-VCMN.
           MOVE 33 TO FIO-FND-GRT-ALT IN FIO-VCMN.
           MOVE 34 TO FIO-GET-NXT-ALT IN FIO-VCMN.
           MOVE 35 TO FIO-GET-KEY-UPD-ALT IN FIO-VCMN.
           MOVE 36 TO FIO-GET-KEY-UPD IN FIO-VCMN.
           MOVE 37 TO FIO-END-BRW IN FIO-VCMN.
           MOVE 38 TO FIO-BCK-OUT IN FIO-VCMN.
           MOVE 39 TO FIO-GET-LEQ IN FIO-VCMN.
           MOVE 40 TO FIO-GET-PRV IN FIO-VCMN.
           MOVE 41 TO FIO-CHK-PNT IN FIO-VCMN.
           MOVE 42 TO FIO-BFR-RFH IN FIO-VCMN.
           MOVE 43 TO FIO-EBR-ALL IN FIO-VCMN.
           MOVE 44 TO FIO-BEG-TRN IN FIO-VCMN.
           MOVE SPACES TO FIO-PROG IN FIO-CTTS.
           MOVE SPACES TO FIO-GLS-PROG IN FIO-CTTS.
           MOVE SPACES TO FIO-VKEY IN FIO-CTTS.
           MOVE SPACES TO FIO-CKEY IN FIO-CTTS.
           MOVE 0 TO FIO-KLEN IN FIO-CTTS.
           MOVE SPACES TO FIO-DFLD IN FIO-CTTS.
           MOVE SPACES TO FIO-MENS IN FIO-CTTS.
           MOVE SPACES TO FIO-MEN1 IN FIO-MENS.
           MOVE SPACES TO FIO-MEN2 IN FIO-MENS.
           MOVE 0 TO FIO-IAKY IN FIO-CTTS.
           MOVE 0 TO FIO-IGET IN FIO-CTTS.
           MOVE 0 TO FIO-KDEF IN FIO-CTTS.
           MOVE 0 TO FIO-KDEF-N IN FIO-CTTS.
           MOVE 1 TO FIO-KDEF-S IN FIO-CTTS.
           MOVE SPACES TO FIO-IVEZ IN FIO-CTTS.
           MOVE SPACES TO FIO-MSFL IN FIO-CTTS.
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(1).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(2).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(3).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(4).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(5).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(6).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(7).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(8).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(9).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(10).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(11).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(12).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(13).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(14).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(15).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(16).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(17).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(18).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(19).
           MOVE SPACES TO FIO-NFIL IN FIO-VSFL(20).
           MOVE 20 TO FIO-MXFL IN FIO-CTTS.
           MOVE 'N' TO FIO-ISBR IN FIO-CTTS.
           MOVE 0 TO FIO-IAUX IN FIO-CTTS.
           MOVE SPACES TO FIO-ORACLE-VARI IN FIO-ORACLE.
           MOVE SPACES TO FIO-ORACLE-DFLD IN FIO-ORACLE.
           MOVE SPACES TO FIO-ORACLE-RQA IN FIO-ORACLE.
           MOVE SPACES TO FIO-ORACLE-MENS IN FIO-ORACLE.
           MOVE LOW-VALUE TO FIO-ORACLE-PROG IN FIO-ORACLE.
           MOVE SPACES TO FIO-ORACLE-PROG-TAB IN FIO-ORACLE-PROG.
           MOVE 0 TO FIO-ORACLE-PROG-NUM IN FIO-ORACLE-PROG.
           MOVE SPACES TO FIO-ORACLE-FILL IN FIO-ORACLE.
           MOVE SPACES TO RECV-STRING-FIO.
           MOVE SPACES TO SEND-STRING-FIO.
           MOVE SPACES TO FIO-AKEY IN FIO-VARI.
           MOVE LOW-VALUE TO FIO-STAT IN FIO-VARI.
           MOVE 0 TO FIO-STT1 IN FIO-STAT.
           MOVE 0 TO FIO-STT2 IN FIO-STAT.
           MOVE 0 TO FIO-RKEY IN FIO-VARI.
           MOVE 0 TO FIO-CMND IN FIO-VARI.
           MOVE 0 TO FIO-ACCS IN FIO-VARI.
           MOVE 0 TO FIO-RLCK IN FIO-VARI.
           MOVE 0 TO FIO-IFNF IN FIO-VARI.
           MOVE 0 TO FIO-RLEN IN FIO-VARI.
           MOVE LOW-VALUE TO FIO-VOID IN FIO-VARI.
           MOVE SPACES TO FIO-SIST IN FIO-VOID.
           MOVE SPACES TO FIO-FTYP IN FIO-VOID.
           MOVE SPACES TO FIO-FNAM IN FIO-VOID.
           MOVE SPACES TO FIO-SIST-BKP IN FIO-VARI.
           MOVE SPACES TO IDD-PROG IN IDD-VARI.
           MOVE LOW-VALUE TO IDD-DAUX IN IDD-VARI.
           MOVE SPACES TO IDD-SAUX IN IDD-DAUX.
           MOVE SPACES TO IDD-GAUX IN IDD-DAUX.
           MOVE SPACES TO IDD-RAUX IN IDD-DAUX.
           MOVE 0 TO IDD-IAUX IN IDD-VARI.
           MOVE LOW-VALUE TO IDD-REGI IN IDD-VARI.
           MOVE SPACES TO IDD-CIDD IN IDD-REGI.
           MOVE LOW-VALUE TO IDD-FSIS IN IDD-REGI.
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(1).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(2).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(3).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(4).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(5).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(6).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(7).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(8).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(9).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(10).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(11).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(12).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(13).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(14).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(15).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(16).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(17).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(18).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(19).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(20).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(21).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(22).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(23).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(24).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(25).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(26).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(27).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(28).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(29).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(30).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(31).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(32).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(33).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(34).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(35).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(36).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(37).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(38).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(39).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(40).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(41).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(42).
           MOVE LOW-VALUE TO IDD-DENT IN IDD-VSIS(43).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(1).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(2).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(3).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(4).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(5).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(6).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(7).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(8).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(9).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(10).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(11).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(12).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(13).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(14).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(15).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(16).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(17).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(18).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(19).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(20).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(21).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(22).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(23).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(24).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(25).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(26).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(27).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(28).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(29).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(30).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(31).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(32).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(33).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(34).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(35).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(36).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(37).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(38).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(39).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(40).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(41).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(42).
           MOVE SPACES TO IDD-TENT IN IDD-VSIS(43).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(1).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(2).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(3).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(4).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(5).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(6).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(7).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(8).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(9).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(10).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(11).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(12).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(13).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(14).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(15).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(16).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(17).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(18).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(19).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(20).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(21).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(22).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(23).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(24).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(25).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(26).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(27).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(28).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(29).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(30).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(31).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(32).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(33).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(34).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(35).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(36).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(37).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(38).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(39).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(40).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(41).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(42).
           MOVE SPACES TO IDD-IENT IN IDD-VSIS(43).
           MOVE 0 TO TP-RETURN-VAL IN TPSVCRET-REC.
           MOVE 0 TO APPL-CODE IN TPSVCRET-REC.
           MOVE SPACES TO REC-TYPE IN TPTYPE-REC.
           MOVE SPACES TO SUB-TYPE IN TPTYPE-REC.
           MOVE 0 TO LEN IN TPTYPE-REC.
           MOVE 0 TO TPTYPE-STATUS IN TPTYPE-REC.
           MOVE 0 TO TP-STATUS IN TPSTATUS-REC.
           MOVE 0 TO TPEVENT IN TPSTATUS-REC.
           MOVE 0 TO APPL-RETURN-CODE IN TPSTATUS-REC.
           MOVE 0 TO COMM-HANDLE IN TPSVCDEF-REC.
           MOVE 0 TO TPBLOCK-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPTRAN-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPREPLY-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPTIME-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPSIGRSTRT-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPGETANY-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPSENDRECV-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPNOCHANGE-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO TPSERVICETYPE-FLAG IN TPSVCDEF-REC.
           MOVE 0 TO APPKEY IN TPSVCDEF-REC.
           MOVE 0 TO CLIENTID IN TPSVCDEF-REC(1).
           MOVE 0 TO CLIENTID IN TPSVCDEF-REC(2).
           MOVE 0 TO CLIENTID IN TPSVCDEF-REC(3).
           MOVE 0 TO CLIENTID IN TPSVCDEF-REC(4).
           MOVE SPACES TO SERVICE-NAME IN TPSVCDEF-REC.
           MOVE 'GNSPQTAB :' TO LOGMSG-PROG IN LOGMSG.
           MOVE '00' TO LOGMSG-NUMB IN LOGMSG.
           MOVE '00000000' TO LOGMSG-TIME IN LOGMSG.
           MOVE LOW-VALUE TO LOGMSG-TEXT IN LOGMSG.
           MOVE SPACES TO LOGMSG-TEXT-1 IN LOGMSG-TEXT.
           MOVE SPACES TO LOGMSG-TEXT-2 IN LOGMSG-TEXT.
           MOVE SPACES TO LOGMSG-TEXT-3 IN LOGMSG-TEXT.
           MOVE 0 TO LOGMSG-LEN.
           MOVE 0 TO FRM-TCMA IN FRM-VARI.
           MOVE LOW-VALUE TO FRM-CMMA IN FRM-VARI.
           MOVE SPACES TO FRM-SCR-MENS IN FRM-CMMA.
           MOVE SPACES TO FRM-SCR-VARI IN FRM-CMMA.
           MOVE SPACES TO FRM-STAT IN FRM-VARI.
           MOVE SPACES TO FRM-NAME IN FRM-VARI.
           MOVE SPACES TO FRM-NLIB IN FRM-VARI.
           MOVE 1 TO FRM-PLIN IN FRM-VARI.
           MOVE 0 TO FRM-NLIN IN FRM-VARI.
           MOVE 0 TO FRM-PCUR IN FRM-VARI.
           MOVE SPACES TO FRM-UCUR IN FRM-VARI.
           MOVE 0 TO FRM-TFLD IN FRM-VARI.
           MOVE SPACES TO FRM-AUXI IN FRM-VARI.
           MOVE LOW-VALUE TO FRM-DFLD IN FRM-VARI.
           MOVE SPACES TO FRM-COD-MENS IN FRM-DFLD.
           MOVE SPACES TO FRM-GLS-MENS IN FRM-DFLD.
           MOVE LOW-VALUE TO FRM-DATA IN FRM-DFLD.
           MOVE SPACES TO FRM-NAME-IDEN IN FRM-DATA.
           MOVE SPACES TO FRM-NAME-CMPL IN FRM-DATA.
           MOVE 0 TO FRM-LFLD IN FRM-VARI.
           MOVE 0 TO FRM-IFLD IN FRM-VARI.
           MOVE SPACES TO FRM-MENS IN FRM-VARI.
           MOVE SPACES TO FRM-ABRV IN FRM-VARI.
           MOVE SPACES TO FRM-FFLD IN FRM-VARI.
           MOVE SPACES TO FRM-SUAR IN FRM-VARI.
           MOVE 0 TO FRM-SINI IN FRM-VARI.
           MOVE 0 TO FRM-CMND IN FRM-VARI.
           MOVE SPACES TO FRM-IHDL IN FRM-VARI.
           MOVE LOW-VALUE TO FRM-COLA IN FRM-VARI.
           MOVE SPACES TO FRM-TERM IN FRM-COLA.
           MOVE SPACES TO FRM-TYPE IN FRM-COLA.
           MOVE 0 TO FRM-LITM IN FRM-VARI.
           MOVE 1 TO FRM-INI IN FRM-CTTS.
           MOVE 2 TO FRM-GET-ALL IN FRM-CTTS.
           MOVE 3 TO FRM-PUT-ALL IN FRM-CTTS.
           MOVE 4 TO FRM-CLR-ALL IN FRM-CTTS.
           MOVE 5 TO FRM-MSG IN FRM-CTTS.
           MOVE 6 TO FRM-RCV IN FRM-CTTS.
           MOVE 10 TO FRM-ABT IN FRM-CTTS.
           MOVE 7 TO FRM-CLR-FRM IN FRM-CTTS.
           MOVE 0 TO FRM-SINI-DB1F IN FRM-CTTS.
           MOVE 1 TO FRM-SINI-DBNF IN FRM-CTTS.
           MOVE 2 TO FRM-SINI-DBLF IN FRM-CTTS.
           MOVE 3 TO FRM-SINI-MB1F IN FRM-CTTS.
           MOVE 4 TO FRM-SINI-MBNF IN FRM-CTTS.
           MOVE 5 TO FRM-SINI-MBLF IN FRM-CTTS.
           MOVE '%' TO FRM-FFLD-PA1 IN FRM-CTTS.
           MOVE '>' TO FRM-FFLD-PA2 IN FRM-CTTS.
           MOVE ',' TO FRM-FFLD-PA3 IN FRM-CTTS.
           MOVE '''' TO FRM-FFLD-RET IN FRM-CTTS.
           MOVE '3' TO FRM-FFLD-TAB IN FRM-CTTS.
           MOVE '1' TO FRM-FFLD-PF1 IN FRM-CTTS.
           MOVE '2' TO FRM-FFLD-PF2 IN FRM-CTTS.
           MOVE '3' TO FRM-FFLD-PF3 IN FRM-CTTS.
           MOVE '4' TO FRM-FFLD-PF4 IN FRM-CTTS.
           MOVE '5' TO FRM-FFLD-PF5 IN FRM-CTTS.
           MOVE '6' TO FRM-FFLD-PF6 IN FRM-CTTS.
           MOVE '7' TO FRM-FFLD-PF7 IN FRM-CTTS.
           MOVE '8' TO FRM-FFLD-PF8 IN FRM-CTTS.
           MOVE '9' TO FRM-FFLD-PF9 IN FRM-CTTS.
           MOVE ':' TO FRM-FFLD-PF10 IN FRM-CTTS.
           MOVE '#' TO FRM-FFLD-PF11 IN FRM-CTTS.
           MOVE '@' TO FRM-FFLD-PF12 IN FRM-CTTS.
           MOVE 'A' TO FRM-FFLD-PFA IN FRM-CTTS.
           MOVE 'B' TO FRM-FFLD-PFB IN FRM-CTTS.
           MOVE 'C' TO FRM-FFLD-PFC IN FRM-CTTS.
           MOVE 'D' TO FRM-FFLD-PFD IN FRM-CTTS.
           MOVE 'E' TO FRM-FFLD-PFE IN FRM-CTTS.
           MOVE 'F' TO FRM-FFLD-PFF IN FRM-CTTS.
           MOVE 'G' TO FRM-FFLD-PFG IN FRM-CTTS.
           MOVE 'H' TO FRM-FFLD-PFH IN FRM-CTTS.
           MOVE 'I' TO FRM-FFLD-PFI IN FRM-CTTS.
           MOVE '?' TO FRM-FFLD-PFJ IN FRM-CTTS.
           MOVE '.' TO FRM-FFLD-PFK IN FRM-CTTS.
           MOVE '<' TO FRM-FFLD-PFL IN FRM-CTTS.
           MOVE 'MAL' TO FRM-SUAR-MAL IN FRM-CTTS.
           MOVE 'WRN' TO FRM-SUAR-WRN IN FRM-CTTS.
           MOVE 'CLR' TO FRM-SUAR-CLR IN FRM-CTTS.
           MOVE 'OKS' TO FRM-SUAR-OKS IN FRM-CTTS.
           MOVE LOW-VALUE TO FRM-CPIM IN FRM-CTTS.
           MOVE '1' TO FRM-CPIM-AEY IN FRM-CPIM.
           MOVE 'I' TO FRM-CPIM-UBY IN FRM-CPIM.
           MOVE '_' TO FRM-CPIM-ANY IN FRM-CPIM.
           MOVE '(' TO FRM-CPIM-UNY IN FRM-CPIM.
           MOVE '-' TO FRM-CPSF-AEY IN FRM-CPIM.
           MOVE '9' TO FRM-CPIM-ABY IN FRM-CPIM.
           MOVE SPACES TO FRM-CPIM-UST IN FRM-CPIM.
           MOVE -1 TO FRM-POS-CURS IN FRM-CTTS.
           MOVE -1 TO FRM-IND-ERRO IN FRM-CTTS.
           MOVE -9 TO FRM-ERR-NUME IN FRM-CTTS.
           MOVE ZEROES TO FRM-RST-PCUR IN FRM-CTTS.
           MOVE SPACES TO FRM-NTRN.
           MOVE SPACES TO FRM-PROG.
           MOVE LOW-VALUE TO SYS-FHOY-2B IN SYS-VARI.
           MOVE 0 TO SYS-AHOY-2B IN SYS-FHOY-2B.
           MOVE 0 TO SYS-MHOY-2B IN SYS-FHOY-2B.
           MOVE 0 TO SYS-DHOY-2B IN SYS-FHOY-2B.
           MOVE 0 TO SYS-SHOY IN SYS-VARI.
           MOVE LOW-VALUE TO SYS-FHOY IN SYS-VARI.
           MOVE 0 TO SYS-DHOY IN SYS-FHOY.
           MOVE SPACES TO SYS-SLH1 IN SYS-FHOY.
           MOVE 0 TO SYS-MHOY IN SYS-FHOY.
           MOVE SPACES TO SYS-SLH2 IN SYS-FHOY.
           MOVE 0 TO SYS-AHOY IN SYS-FHOY.
           MOVE ZEROES TO SYS-HHOY-2B IN SYS-VARI.
           MOVE ZEROES TO SYS-HHOY IN SYS-VARI.
           MOVE 0 TO SYS-JHOY IN SYS-VARI.
           MOVE LOW-VALUE TO SYS-TSTP IN SYS-VARI.
           MOVE 0 TO SYS-SSTP IN SYS-TSTP.
           MOVE LOW-VALUE TO SYS-FSTP IN SYS-TSTP.
           MOVE 0 TO SYS-AATS IN SYS-FSTP.
           MOVE 0 TO SYS-MMTS IN SYS-FSTP.
           MOVE 0 TO SYS-DDTS IN SYS-FSTP.
           MOVE 0 TO SYS-HSTP IN SYS-TSTP.
           MOVE 0 TO SYS-TCMA IN SYS-VARI.
           MOVE LOW-VALUE TO SYS-CMMA IN SYS-VARI.
           MOVE SPACES TO SYS-SCR-MENS IN SYS-CMMA.
           MOVE SPACES TO SYS-SCR-VARI IN SYS-CMMA.
           MOVE SPACES TO SYS-SCR-NTRN IN SYS-CMMA.
           MOVE SPACES TO SYS-NTRN IN SYS-VARI.
           MOVE SPACES TO SYS-PROG IN SYS-VARI.
           MOVE 'GNSPPABT' TO SYS-PABT IN SYS-VARI.
           MOVE 0 TO SYS-CMND IN SYS-VARI.
           MOVE LOW-VALUE TO SYS-MENS IN SYS-VARI.
           MOVE SPACES TO SYS-MEN1 IN SYS-MENS.
           MOVE SPACES TO SYS-MEN2 IN SYS-MENS.
           MOVE 0 TO SYS-REST IN SYS-VARI.
           MOVE 0 TO SYS-SIND IN SYS-VARI.
           MOVE SPACES TO SYS-STAT IN SYS-VARI.
           MOVE '00' TO SYS-STAT-OKS IN SYS-VARI.
           MOVE 0 TO SYS-STAT-NUM IN SYS-VARI.
           MOVE SPACES TO SYS-IHDL IN SYS-VARI.
           MOVE ' ' TO SYS-ABND IN SYS-VARI.
           MOVE 'N' TO SYS-SMFT IN SYS-VARI.
           MOVE 'N' TO SYS-HORA-HABI IN SYS-VARI.
           MOVE 'N' TO SYS-HORA-FLAG IN SYS-VARI.
           MOVE SPACES TO EIBTRMID.
           MOVE SPACES TO EIBTRNID.
           MOVE SPACES TO EIBTASKN.
           MOVE 1 TO EIBCALEN.
           MOVE '''' TO EIBAID.
           MOVE 0 TO EIBRESP.
           MOVE SPACES TO EIBTASKN-11 IN EIBTASKN-1.
           MOVE SPACES TO EIBTASKN-12 IN EIBTASKN-1.
           MOVE 'GNSPPFYH' TO FYH-PROG IN FYH-VARI.
           MOVE 22 TO FYH-TCMA IN FYH-VARI.
           MOVE SPACES TO FYH-CMSG IN FYH-VARI.
           MOVE LOW-VALUE TO FYH-MENS IN FYH-VARI.
           MOVE SPACES TO FYH-MEN2 IN FYH-MENS.
           MOVE LOW-VALUE TO FYH-CMMA IN FYH-VARI.
           MOVE LOW-VALUE TO FYH-GLS-RSPT IN FYH-CMMA.
           MOVE LOW-VALUE TO FYH-FEC-FHOY IN FYH-GLS-RSPT.
           MOVE 0 TO FYH-NUM-SHOY IN FYH-FEC-FHOY.
           MOVE 0 TO FYH-NUM-AHOY IN FYH-FEC-FHOY.
           MOVE 0 TO FYH-NUM-MHOY IN FYH-FEC-FHOY.
           MOVE 0 TO FYH-NUM-DHOY IN FYH-FEC-FHOY.
           MOVE LOW-VALUE TO FYH-HRA-HHOY IN FYH-GLS-RSPT.
           MOVE 0 TO FYH-NUM-HHHY IN FYH-HRA-HHOY.
           MOVE 0 TO FYH-NUM-MMHY IN FYH-HRA-HHOY.
           MOVE 0 TO FYH-NUM-SSHY IN FYH-HRA-HHOY.
           MOVE 0 TO FYH-NUM-JULI IN FYH-GLS-RSPT.
           MOVE 1 TO SYS-GET-DATE IN SYS-CTTS.
           MOVE 2 TO SYS-GET-TIME IN SYS-CTTS.
           MOVE 3 TO SYS-RTRN IN SYS-CTTS.
           MOVE 4 TO SYS-XCTL IN SYS-CTTS.
           MOVE 5 TO SYS-LINK IN SYS-CTTS.
           MOVE 6 TO SYS-ABOR IN SYS-CTTS.
           MOVE '000031060091121152182213244274305335' TO SYS-VACU IN
           SYS-CTTS.
           MOVE 0 TO TSK-TX-STATUS IN TSK-TX-RETURN-STATUS.
           MOVE LOW-VALUE TO TSK-XID-REC IN TSK-TX-INFO-AREA.
           MOVE 0 TO TSK-FORMAT-ID IN TSK-XID-REC.
           MOVE 0 TO TSK-GTRID-LENGTH IN TSK-XID-REC.
           MOVE 0 TO TSK-BRANCH-LENGTH IN TSK-XID-REC.
           MOVE SPACES TO TSK-XID-DATA IN TSK-XID-REC.
           MOVE 0 TO TSK-TRANSACTION-MODE IN TSK-TX-INFO-AREA.
           MOVE 0 TO TSK-COMMIT-RETURN IN TSK-TX-INFO-AREA.
           MOVE 0 TO TSK-TRANSACTION-CONTROL IN TSK-TX-INFO-AREA.
           MOVE 0 TO TSK-TRANSACTION-TIMEOUT IN TSK-TX-INFO-AREA.
           MOVE 0 TO TSK-TRANSACTION-STATE IN TSK-TX-INFO-AREA.
           MOVE 0 TO TPTRXLEV-FLAG IN TPTRXLEV-REC.
           MOVE 0 TO T-OUT IN TPTRXDEF-REC.
           MOVE 0 TO TRANID IN TPTRXDEF-REC(1).
           MOVE 0 TO TRANID IN TPTRXDEF-REC(2).
           MOVE 0 TO TRANID IN TPTRXDEF-REC(3).
           MOVE 0 TO TRANID IN TPTRXDEF-REC(4).
           MOVE 0 TO TRANID IN TPTRXDEF-REC(5).
           MOVE 0 TO TRANID IN TPTRXDEF-REC(6).
           MOVE 'N' TO TSK-TERM-ORIGEN IN TSK-VARI.
           MOVE LOW-VALUE TO TSK-TRANID IN TSK-VARI.
           MOVE 0 TO TSK-TRANID-1 IN TSK-TRANID.
           MOVE 0 TO TSK-TRANID-2 IN TSK-TRANID.
           MOVE 0 TO TSK-TRANID-3 IN TSK-TRANID.
           MOVE 0 TO TSK-TRANID-4 IN TSK-TRANID.
           MOVE 0 TO TSK-TRANID-5 IN TSK-TRANID.
           MOVE 0 TO TSK-TRANID-6 IN TSK-TRANID.
           MOVE LOW-VALUE TO TSK-INFO-TRAN IN TSK-VARI.
           MOVE 0 TO TSK-INFO-TRANID IN TSK-INFO-TRAN.
           MOVE 0 TO TSK-INFO-COMMIT IN TSK-INFO-TRAN.
           MOVE 0 TO TSK-TERM-NUM IN TSK-VARI.
           MOVE SPACES TO TSK-TERM-TUX IN TSK-VARI.
           MOVE 0 TO TSK-TERM-NUM-TUX IN TSK-VARI.
           MOVE 0 TO TSK-TERM-NUM-TUX-6 IN TSK-VARI.
           MOVE LOW-VALUE TO HEADER-NOM-TSPT IN HEADER-VARI.
           MOVE 'HE' TO HEADER-COD-TERM IN HEADER-NOM-TSPT.
           MOVE SPACES TO HEADER-COD-TYPE IN HEADER-NOM-TSPT.
           MOVE SPACES TO HEADER-VERS IN HEADER-MENS.
           MOVE SPACES TO HEADER-BNCO IN HEADER-MENS.
           MOVE SPACES TO HEADER-MRCA IN HEADER-MENS.
           MOVE SPACES TO HEADER-CART IN HEADER-MENS.
           MOVE SPACES TO HEADER-LENG IN HEADER-MENS.
           MOVE SPACES TO HEADER-PAIS IN HEADER-MENS.
           MOVE SPACES TO HEADER-VRNT IN HEADER-MENS.
           MOVE SPACES TO HEADER-USER IN HEADER-MENS.
           MOVE SPACES TO HEADER-CNAL IN HEADER-MENS.
           MOVE SPACES TO HEADER-UMUA IN HEADER-MENS.
           MOVE SPACES TO HEADER-PROG IN HEADER-MENS.
           MOVE SPACES TO HEADER-IBYA IN HEADER-MENS.
           MOVE SPACES TO HEADER-BCKI IN HEADER-MENS.
           MOVE SPACES TO HEADER-I24H IN HEADER-MENS.
           MOVE SPACES TO HEADER-MNSF IN HEADER-MENS.
           MOVE SPACES TO HEADER-ORIG IN HEADER-MENS.
           MOVE SPACES TO HEADER-MSGC IN HEADER-MENS.
           MOVE SPACES TO HEADER-MSGM IN HEADER-MENS.
           MOVE SPACES TO HEADER-DIS1 IN HEADER-MENS.
           MOVE LOW-VALUE TO HEADER-IREQ IN HEADER-MENS.
           MOVE SPACES TO HEADER-IR01 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR02 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR03 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR04 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR05 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR06 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR07 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR08 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR09 IN HEADER-IREQ.
           MOVE SPACES TO HEADER-IR10 IN HEADER-IREQ.
           MOVE LOW-VALUE TO MULMSG-NOM-TSPT IN MULMSG-VARI.
           MOVE SPACES TO MULMSG-COD-TERM IN MULMSG-NOM-TSPT.
           MOVE 'MMSG' TO MULMSG-COD-TYPE IN MULMSG-NOM-TSPT.
           MOVE SPACES TO MULMSG-TIPO IN MULMSG-MENS.
           MOVE SPACES TO MULMSG-FORM IN MULMSG-MENS.
           MOVE SPACES TO MULMSG-SIST IN MULMSG-MENS.
           MOVE SPACES TO MULMSG-CODI IN MULMSG-MENS.
           MOVE SPACES TO MULMSG-DATO IN MULMSG-MENS.
           MOVE LOW-VALUE TO HOY-STP-ITRN IN HOY-VARI.
           MOVE LOW-VALUE TO HOY-FHOY IN HOY-STP-ITRN.
           MOVE 0 TO HOY-SHOY IN HOY-FHOY.
           MOVE 0 TO HOY-AHOY IN HOY-FHOY.
           MOVE 0 TO HOY-MHOY IN HOY-FHOY.
           MOVE 0 TO HOY-DHOY IN HOY-FHOY.
           MOVE 0 TO HOY-HHOY IN HOY-STP-ITRN.
           MOVE ZEROES TO PES-NUM-DECI IN PES-VARI.
           MOVE 0 TO PES-SGV-DECI IN PES-VARI.
           MOVE 0 TO PES-SGV-ENTE IN PES-VARI.
           MOVE 0 TO PES-SGV-ENT0 IN PES-VARI.
           MOVE 0 TO PES-SGV-ENT1 IN PES-VARI.
           MOVE 0 TO PES-SGV-ENT2 IN PES-VARI.
           MOVE 0 TO PES-SGV-ENT3 IN PES-VARI.
           MOVE SPACES TO PES-COD-VCAM IN PES-VARI.
           MOVE SPACES TO PES-CIC-VCAM IN PES-VARI.
           MOVE SPACES TO PES-CIC-TVAL IN PES-CIC-VCAM.
           MOVE SPACES TO PES-CIC-CVAL IN PES-CIC-VCAM.
           MOVE SPACES TO PES-CIC-TCAM IN PES-CIC-VCAM.
           MOVE '0999  ' TO PDB-CIC-0999 IN PDB-VARI.
           MOVE '0998  ' TO PDB-CIC-0998 IN PDB-VARI.
           MOVE '0994  ' TO PDB-CIC-0013 IN PDB-VARI.
           MOVE '1013  ' TO PDB-CIC-1013 IN PDB-VARI.
           MOVE '0' TO PDB-CIC-MNAC IN PDB-VARI.
           MOVE '1' TO PDB-CIC-MEXT IN PDB-VARI.
           MOVE '01' TO PDB-COD-TVAL-DOLO IN PDB-VARI.
           MOVE LOW-VALUE TO QUE-COLA IN QUE-VARI.
           MOVE SPACES TO QUE-TERM IN QUE-COLA.
           MOVE SPACES TO QUE-TYPE IN QUE-COLA.
           MOVE +0 TO QUE-NITM IN QUE-VARI.
           MOVE 0 TO QUE-LITM IN QUE-VARI.
           MOVE LOW-VALUE TO QUE-ITEM IN QUE-VARI.
           MOVE SPACES TO QUE-IKEY IN QUE-ITEM.
           MOVE +0 TO QUE-LDAT IN QUE-ITEM.
           MOVE +0 TO QUE-PCUR IN QUE-ITEM.
           MOVE SPACES TO QUE-DATA IN QUE-ITEM.
           MOVE 'OKS' TO QUE-STAT IN QUE-VARI.
           MOVE 'OKS' TO QUE-STAT-OKS IN QUE-VARI.
           MOVE 'NEX' TO QUE-STAT-NEX IN QUE-VARI.
           MOVE 'EOQ' TO QUE-STAT-EOQ IN QUE-VARI.
           MOVE SPACES TO QUE-CMND IN QUE-VARI.
           MOVE LOW-VALUE TO QUE-MENS IN QUE-VARI.
           MOVE SPACES TO QUE-MEN1 IN QUE-MENS.
           MOVE SPACES TO QUE-MEN2 IN QUE-MENS.
           MOVE 0 TO QUE-NUM-STAT.
           MOVE 0 TO QUE-GLS-STAT.
           MOVE 'PUT' TO QUE-PUT IN QUE-CTTS.
           MOVE 'GET' TO QUE-GET IN QUE-CTTS.
           MOVE 'MOD' TO QUE-MOD IN QUE-CTTS.
           MOVE 'DEL' TO QUE-DEL IN QUE-CTTS.
           MOVE SPACES TO QUE-COM-SEND IN QUE-SEND.
           MOVE SPACES TO QUE-NAM-SEND IN QUE-SEND.
           MOVE 0 TO QUE-NUM-SEND IN QUE-SEND.
           MOVE 0 TO QUE-LAR-SEND IN QUE-SEND.
           MOVE SPACES TO QUE-TRX-SEND IN QUE-SEND.
           MOVE SPACES TO QUE-DAT-SEND IN QUE-SEND.
           MOVE 0 TO QUE-FIL-RECV IN QUE-RECV.
           MOVE 0 TO QUE-STA-RECV IN QUE-RECV.
           MOVE 0 TO QUE-NUM-RECV IN QUE-RECV.
           MOVE 0 TO QUE-LAR-RECV IN QUE-RECV.
           MOVE SPACES TO QUE-TRX-RECV IN QUE-RECV.
           MOVE SPACES TO QUE-DAT-RECV IN QUE-RECV.
           MOVE "CARRAY" TO QUE-REC-SEND-REC-TYPE IN
           QUE-TPTYPE-REC-SEND.
           MOVE SPACES TO QUE-REC-SEND-SUB-TYPE IN QUE-TPTYPE-REC-SEND.
           MOVE 9568 TO QUE-REC-SEND-LEN IN QUE-TPTYPE-REC-SEND.
           MOVE 0 TO QUE-REC-SEND-TPTYPE-STATUS IN QUE-TPTYPE-REC-SEND.
           MOVE "CARRAY" TO QUE-REC-RECV-REC-TYPE IN
           QUE-TPTYPE-REC-RECV.
           MOVE SPACES TO QUE-REC-RECV-SUB-TYPE IN QUE-TPTYPE-REC-RECV.
           MOVE 9285 TO QUE-REC-RECV-LEN IN QUE-TPTYPE-REC-RECV.
           MOVE 0 TO QUE-REC-RECV-TPTYPE-STATUS IN QUE-TPTYPE-REC-RECV.
           MOVE 0 TO QUE-COMM-HANDLE IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPBLOCK-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPTRAN-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPREPLY-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPTIME-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPSIGRSTRT-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPGETANY-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPSENDRECV-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPNOCHANGE-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-TPSERVICETYPE-FLAG IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-APPKEY IN QUE-TPSVCDEF-REC.
           MOVE 0 TO QUE-CLIENTID IN QUE-TPSVCDEF-REC(1).
           MOVE 0 TO QUE-CLIENTID IN QUE-TPSVCDEF-REC(2).
           MOVE 0 TO QUE-CLIENTID IN QUE-TPSVCDEF-REC(3).
           MOVE 0 TO QUE-CLIENTID IN QUE-TPSVCDEF-REC(4).
           MOVE "ts" TO QUE-SERVICE-NAME IN QUE-TPSVCDEF-REC.
           MOVE SPACES TO KEY-COD-ENTI IN KEY-VARI.
           MOVE SPACES TO KEY-GLS-NOMC IN KEY-VARI.
           MOVE LOW-VALUE TO KEY-CIC-IRUT IN KEY-VARI.
           MOVE 0 TO KEY-NUM-ICLI IN KEY-CIC-IRUT.
           MOVE SPACES TO KEY-VRF-ICLI IN KEY-CIC-IRUT.
           MOVE SPACES TO KEY-IND-ICLI IN KEY-CIC-IRUT.
           MOVE SPACES TO KEY-GLS-ICLI IN KEY-CIC-IRUT.
           MOVE LOW-VALUE TO KEY-CIC-IOPE IN KEY-VARI.
           MOVE SPACES TO KEY-CAI-IOPE IN KEY-CIC-IOPE.
           MOVE SPACES TO KEY-IIC-IOPE IN KEY-CIC-IOPE.
           MOVE LOW-VALUE TO KEY-FEC-FENT IN KEY-VARI.
           MOVE 0 TO KEY-NUM-DENT IN KEY-FEC-FENT.
           MOVE 0 TO KEY-NUM-MENT IN KEY-FEC-FENT.
           MOVE 0 TO KEY-NUM-SENT IN KEY-FEC-FENT.
           MOVE 0 TO KEY-NUM-AENT IN KEY-FEC-FENT.
           MOVE 0 TO KEY-NUM-IENT IN KEY-VARI.
           MOVE SPACES TO KEY-COD-IENT IN KEY-VARI.
           MOVE LOW-VALUE TO KEY-FEC-FCMT IN KEY-VARI.
           MOVE 0 TO KEY-NUM-DCMT IN KEY-FEC-FCMT.
           MOVE 0 TO KEY-NUM-MCMT IN KEY-FEC-FCMT.
           MOVE 0 TO KEY-NUM-SCMT IN KEY-FEC-FCMT.
           MOVE 0 TO KEY-NUM-ACMT IN KEY-FEC-FCMT.
           MOVE 0 TO KEY-NUM-GCMT IN KEY-VARI.
           MOVE SPACES TO KEY-COD-USER IN KEY-VARI.
           MOVE SPACES TO MSG-GLS-FLAG IN MSG.
           MOVE LOW-VALUE TO MSG-KEY-IREG IN MSG.
           MOVE LOW-VALUE TO MSG-KY0-TABS IN MSG-KEY-IREG.
           MOVE LOW-VALUE TO MSG-COD-TABL IN MSG-KY0-TABS.
           MOVE SPACES TO MSG-COD-TTAB IN MSG-COD-TABL.
           MOVE LOW-VALUE TO MSG-COD-MENS IN MSG-COD-TABL.
           MOVE SPACES TO MSG-COD-TMSG IN MSG-COD-MENS.
           MOVE SPACES TO MSG-COD-CMSG IN MSG-COD-MENS.
           MOVE LOW-VALUE TO MSG-COD-ITRS IN MSG-KEY-IREG.
           MOVE LOW-VALUE TO MSG-STP-ITRN IN MSG-COD-ITRS.
           MOVE LOW-VALUE TO MSG-FEC-FTRN IN MSG-STP-ITRN.
           MOVE 0 TO MSG-NUM-STRN IN MSG-FEC-FTRN.
           MOVE 0 TO MSG-NUM-ATRN IN MSG-FEC-FTRN.
           MOVE 0 TO MSG-NUM-MTRN IN MSG-FEC-FTRN.
           MOVE 0 TO MSG-NUM-DTRN IN MSG-FEC-FTRN.
           MOVE LOW-VALUE TO MSG-HRA-HRTR IN MSG-STP-ITRN.
           MOVE 0 TO MSG-NUM-HHTR IN MSG-HRA-HRTR.
           MOVE 0 TO MSG-NUM-MMTR IN MSG-HRA-HRTR.
           MOVE 0 TO MSG-NUM-SSTR IN MSG-HRA-HRTR.
           MOVE SPACES TO MSG-MSC-TACC IN MSG.
           MOVE SPACES TO MSG-MSC-STAT IN MSG.
           MOVE LOW-VALUE TO MSG-COD-OTRN IN MSG.
           MOVE SPACES TO MSG-MSC-TTRN IN MSG-COD-OTRN.
           MOVE SPACES TO MSG-COD-TTRN IN MSG-COD-OTRN.
           MOVE SPACES TO MSG-COD-ATRN IN MSG.
           MOVE LOW-VALUE TO MSG-KY1-TABS IN MSG.
           MOVE LOW-VALUE TO MSG-CIC-TABL IN MSG-KY1-TABS.
           MOVE SPACES TO MSG-CIC-TTAB IN MSG-CIC-TABL.
           MOVE LOW-VALUE TO MSG-CIC-MENS IN MSG-CIC-TABL.
           MOVE SPACES TO MSG-CIC-TMSG IN MSG-CIC-MENS.
           MOVE SPACES TO MSG-CIC-CMSG IN MSG-CIC-MENS.
           MOVE LOW-VALUE TO MSG-KY2-TABS IN MSG.
           MOVE LOW-VALUE TO MSG-EXT-TABL IN MSG-KY2-TABS.
           MOVE SPACES TO MSG-EXT-TTAB IN MSG-EXT-TABL.
           MOVE SPACES TO MSG-EXT-CTAB IN MSG-EXT-TABL.
           MOVE SPACES TO MSG-GLS-DCOR IN MSG.
           MOVE SPACES TO MSG-GLS-ABRV IN MSG.
           MOVE LOW-VALUE TO MSG-GLS-DESC IN MSG.
           MOVE SPACES TO MSG-GLS-DES1 IN MSG-GLS-DESC.
           MOVE SPACES TO MSG-GLS-DES2 IN MSG-GLS-DESC.
           MOVE LOW-VALUE TO MSG-GLS-DATA IN MSG.
           MOVE SPACES TO MSG-GLS-MENS IN MSG-GLS-DATA.
           MOVE SPACES TO MSG-GLS-DISP IN MSG-GLS-DATA.
           MOVE LOW-VALUE TO MSG-SNX-TABL IN MSG.
           MOVE SPACES TO MSG-SNX-TTAB IN MSG-SNX-TABL.
           MOVE SPACES TO MSG-SNX-MENS IN MSG-SNX-TABL.
           MOVE LOW-VALUE TO MSG-GLS-FMSG IN MSG-VARI.
           MOVE SPACES TO MSG-COD-SIST IN MSG-GLS-FMSG.
           MOVE 'PFTAB' TO MSG-COD-FMSG IN MSG-GLS-FMSG.
           MOVE SPACES TO TAB-GLS-FLAG IN TAB.
           MOVE LOW-VALUE TO TAB-KEY-IREG IN TAB.
           MOVE LOW-VALUE TO TAB-KY0-TABS IN TAB-KEY-IREG.
           MOVE LOW-VALUE TO TAB-COD-TABL IN TAB-KY0-TABS.
           MOVE SPACES TO TAB-COD-TTAB IN TAB-COD-TABL.
           MOVE SPACES TO TAB-COD-CTAB IN TAB-COD-TABL.
           MOVE LOW-VALUE TO TAB-COD-ITRS IN TAB-KEY-IREG.
           MOVE LOW-VALUE TO TAB-STP-ITRN IN TAB-COD-ITRS.
           MOVE LOW-VALUE TO TAB-FEC-FTRN IN TAB-STP-ITRN.
           MOVE 0 TO TAB-NUM-STRN IN TAB-FEC-FTRN.
           MOVE 0 TO TAB-NUM-ATRN IN TAB-FEC-FTRN.
           MOVE 0 TO TAB-NUM-MTRN IN TAB-FEC-FTRN.
           MOVE 0 TO TAB-NUM-DTRN IN TAB-FEC-FTRN.
           MOVE LOW-VALUE TO TAB-HRA-HRTR IN TAB-STP-ITRN.
           MOVE 0 TO TAB-NUM-HHTR IN TAB-HRA-HRTR.
           MOVE 0 TO TAB-NUM-MMTR IN TAB-HRA-HRTR.
           MOVE 0 TO TAB-NUM-SSTR IN TAB-HRA-HRTR.
           MOVE SPACES TO TAB-MSC-TACC IN TAB.
           MOVE SPACES TO TAB-MSC-STAT IN TAB.
           MOVE LOW-VALUE TO TAB-COD-OTRN IN TAB.
           MOVE SPACES TO TAB-MSC-TTRN IN TAB-COD-OTRN.
           MOVE SPACES TO TAB-COD-TTRN IN TAB-COD-OTRN.
           MOVE SPACES TO TAB-COD-ATRN IN TAB.
           MOVE LOW-VALUE TO TAB-KY1-TABS IN TAB.
           MOVE LOW-VALUE TO TAB-CIC-TABL IN TAB-KY1-TABS.
           MOVE SPACES TO TAB-CIC-TTAB IN TAB-CIC-TABL.
           MOVE SPACES TO TAB-CIC-CTAB IN TAB-CIC-TABL.
           MOVE LOW-VALUE TO TAB-KY2-TABS IN TAB.
           MOVE LOW-VALUE TO TAB-EXT-TABL IN TAB-KY2-TABS.
           MOVE SPACES TO TAB-EXT-TTAB IN TAB-EXT-TABL.
           MOVE SPACES TO TAB-EXT-CTAB IN TAB-EXT-TABL.
           MOVE SPACES TO TAB-GLS-DCOR IN TAB.
           MOVE SPACES TO TAB-GLS-ABRV IN TAB.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           MOVE LOW-VALUE TO TAB-GLS-DATA IN TAB.
           MOVE LOW-VALUE TO TAB-GLS-DAT1 IN TAB-GLS-DATA.
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(1).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(2).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(3).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(4).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(5).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(6).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(7).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(8).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(9).
           MOVE SPACES TO TAB-COD-DAT1 IN TAB-GLS-DAT1(10).
           MOVE LOW-VALUE TO TAB-GLS-DAT2 IN TAB-GLS-DATA.
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(1).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(2).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(3).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(4).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(5).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(6).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(7).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(8).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(9).
           MOVE SPACES TO TAB-COD-DAT2 IN TAB-GLS-DAT2(10).
           MOVE LOW-VALUE TO TAB-GLS-DAT3 IN TAB-GLS-DATA.
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(1).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(2).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(3).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(4).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(5).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(6).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(7).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(8).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(9).
           MOVE SPACES TO TAB-COD-DAT3 IN TAB-GLS-DAT3(10).
           MOVE LOW-VALUE TO TAB-SNX-TABL IN TAB.
           MOVE SPACES TO TAB-SNX-TTAB IN TAB-SNX-TABL.
           MOVE SPACES TO TAB-SNX-CTAB IN TAB-SNX-TABL.
           MOVE LOW-VALUE TO TAB-GLS-FTAB IN TAB-VARI.
           MOVE SPACES TO TAB-COD-SIST IN TAB-GLS-FTAB.
           MOVE 'PFTAB' TO TAB-COD-FTAB IN TAB-GLS-FTAB.
           MOVE SPACES TO MSC-GLS-FLAG IN MSC.
           MOVE LOW-VALUE TO MSC-KEY-IREG IN MSC.
           MOVE LOW-VALUE TO MSC-KY0-TABS IN MSC-KEY-IREG.
           MOVE LOW-VALUE TO MSC-COD-TABL IN MSC-KY0-TABS.
           MOVE SPACES TO MSC-COD-TTAB IN MSC-COD-TABL.
           MOVE LOW-VALUE TO MSC-COD-MSCL IN MSC-COD-TABL.
           MOVE SPACES TO MSC-COD-TMSC IN MSC-COD-MSCL.
           MOVE SPACES TO MSC-COD-CMSC IN MSC-COD-MSCL.
           MOVE LOW-VALUE TO MSC-COD-ITRS IN MSC-KEY-IREG.
           MOVE LOW-VALUE TO MSC-STP-ITRN IN MSC-COD-ITRS.
           MOVE LOW-VALUE TO MSC-FEC-FTRN IN MSC-STP-ITRN.
           MOVE 0 TO MSC-NUM-STRN IN MSC-FEC-FTRN.
           MOVE 0 TO MSC-NUM-ATRN IN MSC-FEC-FTRN.
           MOVE 0 TO MSC-NUM-MTRN IN MSC-FEC-FTRN.
           MOVE 0 TO MSC-NUM-DTRN IN MSC-FEC-FTRN.
           MOVE LOW-VALUE TO MSC-HRA-HRTR IN MSC-STP-ITRN.
           MOVE 0 TO MSC-NUM-HHTR IN MSC-HRA-HRTR.
           MOVE 0 TO MSC-NUM-MMTR IN MSC-HRA-HRTR.
           MOVE 0 TO MSC-NUM-SSTR IN MSC-HRA-HRTR.
           MOVE SPACES TO MSC-MSC-TACC IN MSC.
           MOVE SPACES TO MSC-MSC-STAT IN MSC.
           MOVE LOW-VALUE TO MSC-COD-OTRN IN MSC.
           MOVE SPACES TO MSC-MSC-TTRN IN MSC-COD-OTRN.
           MOVE SPACES TO MSC-COD-TTRN IN MSC-COD-OTRN.
           MOVE SPACES TO MSC-COD-ATRN IN MSC.
           MOVE LOW-VALUE TO MSC-KY1-TABS IN MSC.
           MOVE LOW-VALUE TO MSC-CIC-TABL IN MSC-KY1-TABS.
           MOVE SPACES TO MSC-CIC-TTAB IN MSC-CIC-TABL.
           MOVE LOW-VALUE TO MSC-CIC-MSCL IN MSC-CIC-TABL.
           MOVE SPACES TO MSC-CIC-TMSC IN MSC-CIC-MSCL.
           MOVE SPACES TO MSC-CIC-CMSC IN MSC-CIC-MSCL.
           MOVE LOW-VALUE TO MSC-KY2-TABS IN MSC.
           MOVE LOW-VALUE TO MSC-EXT-TABL IN MSC-KY2-TABS.
           MOVE SPACES TO MSC-EXT-TTAB IN MSC-EXT-TABL.
           MOVE LOW-VALUE TO MSC-EXT-CTAB IN MSC-EXT-TABL.
           MOVE SPACES TO MSC-EXT-TMSC IN MSC-EXT-CTAB.
           MOVE SPACES TO MSC-EXT-CMSC IN MSC-EXT-CTAB.
           MOVE SPACES TO MSC-GLS-DCOR IN MSC.
           MOVE SPACES TO MSC-GLS-ABRV IN MSC.
           MOVE SPACES TO MSC-GLS-DESC IN MSC.
           MOVE LOW-VALUE TO MSC-GLS-DATA IN MSC.
           MOVE SPACES TO MSC-GLS-MENS IN MSC-GLS-DATA.
           MOVE SPACES TO MSC-COD-MENS IN MSC-GLS-DATA.
           MOVE SPACES TO MSC-GLS-DISP IN MSC-GLS-DATA.
           MOVE LOW-VALUE TO MSC-SNX-TABL IN MSC.
           MOVE SPACES TO MSC-SNX-TTAB IN MSC-SNX-TABL.
           MOVE SPACES TO MSC-SNX-MSCL IN MSC-SNX-TABL.
           MOVE SPACES TO MSC-COD-SIST IN MSC-VARI.
           MOVE SPACES TO CIC-DVRF IN CIC-VARI.
           MOVE SPACES TO CIC-STAT IN CIC-VARI.
           MOVE SPACES TO CIC-MENS IN CIC-VARI.
           MOVE 0 TO CIC-CMND IN CIC-VARI.
           MOVE 1 TO CIC-GET IN CIC-CTTS.
           MOVE 2 TO CIC-INI IN CIC-CTTS.
           MOVE 3 TO CIC-FIN IN CIC-CTTS.
           MOVE SPACES TO CIC-STAT-OKS IN CIC-CTTS.
           MOVE 'NEX' TO CIC-STAT-NEX IN CIC-CTTS.
           MOVE 'NVG' TO CIC-STAT-NVG IN CIC-CTTS.
           MOVE 'ERR' TO CIC-STAT-ERR IN CIC-CTTS.
           MOVE 'CNV' TO CIC-STAT-CNV IN CIC-CTTS.
           MOVE 0 TO VRF-SVRF-K IN VRF-CTTS.
           MOVE 1 TO VRF-SVRF-0 IN VRF-CTTS.
           MOVE 2 TO VRF-SVRF-1 IN VRF-CTTS.
           MOVE 1 TO VRF-VAL IN VRF-CTTS.
           MOVE 2 TO VRF-GET IN VRF-CTTS.
           MOVE 0 TO VRF-ZERO-N IN VRF-CTTS.
           MOVE 1 TO VRF-ZERO-S IN VRF-CTTS.
           MOVE 2 TO VRF-SBLK IN VRF-CTTS.
           MOVE SPACES TO VRF-NUDV IN VRF-VARI.
           MOVE 0 TO VRF-SVRF IN VRF-VARI.
           MOVE 0 TO VRF-STAT IN VRF-VARI.
           MOVE 0 TO VRF-ZERO IN VRF-VARI.
           MOVE SPACES TO VRF-CMSG IN VRF-VARI.
           MOVE 0 TO VRF-CMND IN VRF-VARI.
           MOVE 0 TO VRF-LMAX IN VRF-VARI.
           MOVE SPACES TO VRF-SFDV IN VRF-VARI.
           MOVE LOW-VALUE TO IDM-RIDD IN IDM-CMMA.
           MOVE LOW-VALUE TO IDM-QIDD IN IDM-RIDD.
           MOVE SPACES TO IDM-QUEU IN IDM-QIDD.
           MOVE SPACES TO IDM-TERM IN IDM-QIDD.
           MOVE ZEROES TO IDM-LIDD IN IDM-RIDD.
           MOVE LOW-VALUE TO IDM-ENTR IN IDM-CMMA.
           MOVE SPACES TO IDM-SIST IN IDM-ENTR.
           MOVE LOW-VALUE TO IDM-KEY-TAB IN IDM-ENTR.
           MOVE SPACES TO IDM-OPCI IN IDM-KEY-TAB.
           MOVE SPACES TO IDM-CANA IN IDM-KEY-TAB.
           MOVE LOW-VALUE TO IDM-SALI IN IDM-CMMA.
           MOVE SPACES TO IDM-IND-ERROR IN IDM-SALI.
           MOVE SPACES TO IDM-COD-ERROR IN IDM-SALI.
           MOVE SPACES TO IDM-GLS-ERROR IN IDM-SALI.
           MOVE SPACES TO IDM-SEDE IN IDM-SALI.
           MOVE SPACES TO IDM-FUNC IN IDM-SALI.
           MOVE SPACES TO IDM-VIGE IN IDM-SALI.
           MOVE +3000 TO IDM-TCMA IN IDM-VARI.
           MOVE 'S' TO WCC-S IN WCC-VARI.
           MOVE 'GNSPPIDM' TO WCC-GNSPPIDM IN WCC-VARI.
           MOVE 'KEYNOEXI' TO WCC-KEYNOEXI IN WCC-VARI.
           MOVE 'IDM' TO WCC-IDM IN WCC-VARI.
      
       FIN-GNS-PRO-LIMPIAR-VARIABLES.
           EXIT.
                     
      *>FIN-MFC TUXEDO ORACLE
