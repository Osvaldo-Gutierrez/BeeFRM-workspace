       IDENTIFICATION DIVISION.                                         
      *>=======================                                          
       PROGRAM-ID.      GNSPPCPM.                                       
       AUTHOR.          CONSIST.                                        
       DATE-WRITTEN.    26-DEC-2003 16:23:11.
                                                                        
      *> Programa actualizador de parametros MCI VSAM Y DTC              
      
      *> MODIFICADO X E.DEZA EL 09/04/2008 "WSS-SOLO-TAB"  *
                                                                        
       ENVIRONMENT DIVISION.                                            
      *>====================                                             
       CONFIGURATION SECTION.                                           
      *>---------------------                                            
       SPECIAL-NAMES.                                                   
            DECIMAL-POINT IS COMMA.                                     
      *> INPUT-OUTPUT SECTION.                                           
      *>--------------------                                             
      *> FILE-CONTROL.                                                   
                                                                        
       DATA DIVISION.                                                   
      *>=============                                                    
      *> FILE SECTION.                                                   
      *>------------                                                     
                                                                        
       WORKING-STORAGE SECTION.                                         
      *>-----------------------                                          
       77  WSS-TAG-GNSPPCPM PIC X(125) VALUE
           '<IDNPGM NOM=$GNSPPCPM$ SKL=$08.04.10$ VSN=$08.04.10$GEN=$10-ABR-08 19:15 PM$ FNC=$MK2TFL$/>'.
      
      *>INI-PENTA TUXEDO ORACLE        
      *>
        01  TPINFDEF-REC VALUE LOW-VALUES.
      *>
      *>    Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *>    THIS IS UNPUBLISHED PROPRIETARY
      *>    SOURCE CODE OF USL
      *>    The copyright notice above does not
      *>    evidence any actual or intended
      *>    publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an 
      *> unpublished work.   
      *>
      *> #ident    "@(#) cobol/cobatmi/TPINFDEF.cbl    $Revision: 1.4 $" 
      *> static    char    sccsid[] = "@(#) cobol/cobatmi/TPINFDEF.cbl   
      *>
      *>  TPINFDEF.cbl
      *>
        05 USRNAME        PIC X(30).
        05 CLTNAME        PIC X(30).
        05 PASSWD         PIC X(30).
        05 GRPNAME        PIC X(30).
        05 NOTIFICATION-FLAG     PIC S9(9) COMP-5.
           88  TPU-SIG     VALUE 1.
           88  TPU-DIP     VALUE 2.
           88  TPU-IGN     VALUE 3.
        05 ACCESS-FLAG           PIC S9(9) COMP-5.
           88  TPSA-FASTPATH      VALUE 1.
           88  TPSA-PROTECTED     VALUE 2.
        05 CONTEXTS-FLAG         PIC S9(9) COMP-5.
           88  TP-SINGLE-CONTEXT  VALUE 0.
           88  TP-MULTI-CONTEXTS  VALUE 1.
        05 DATALEN        PIC S9(9) COMP-5.
                      
      
        01  TPSVCRET-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCRET.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCRET.cbl     
      *>
      *>  TPSVCRET.cbl
      *>
        05 TP-RETURN-VAL PIC S9(9) COMP-5.
                88 TPSUCCESS  VALUE 0.
                88 TPFAIL     VALUE 1.
                88 TPEXIT     VALUE 2.
                88 TPLONGJUMP VALUE 3.
                88 TPBREAK    VALUE 4.
        05 APPL-CODE          PIC S9(9) COMP-5.
      
      *>
        01  TPTYPE-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPTYPE.cbl  $Revision: 1.4 $"
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPTYPE.cbl       
      *>
      *>  TPTYPE.cbl
      *>
        05 REC-TYPE         PIC X(8).
                88 X-OCTET   VALUE "X_OCTET".
                88 X-COMMON  VALUE "X_COMMON".
        05 SUB-TYPE         PIC X(16).
        05 LEN              PIC S9(9) COMP-5.
                88 NO-LENGTH VALUE 0.
        05 TPTYPE-STATUS    PIC S9(9) COMP-5.
                88 TPTYPEOK     VALUE 0.
                88 TPTRUNCATE   VALUE 1.
      *>
      *>
        01 TPSTATUS-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSTATUS.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSTATUS.cbl     
      *>
      *>  TPSTATUS.cbl
      *>
        05 TP-STATUS  PIC S9(9) COMP-5.
                88 TPOK                 VALUE 0.
                88 TPEABORT             VALUE 1.
                88 TPEBADDESC           VALUE 2.
                88 TPEBLOCK             VALUE 3.
                88 TPEINVAL             VALUE 4.
                88 TPELIMIT             VALUE 5.
                88 TPENOENT             VALUE 6.
                88 TPEOS                VALUE 7.
                88 TPEPERM              VALUE 8.
                88 TPEPROTO             VALUE 9.
                88 TPESVCERR            VALUE 10.
                88 TPESVCFAIL           VALUE 11.
                88 TPESYSTEM            VALUE 12.
                88 TPETIME              VALUE 13.
                88 TPETRAN              VALUE 14.
                88 TPEGOTSIG            VALUE 15.
                88 TPERMERR             VALUE 16.
                88 TPEITYPE             VALUE 17.
                88 TPEOTYPE             VALUE 18.
                88 TPERELEASE           VALUE 19.
                88 TPEHAZARD            VALUE 20.
                88 TPEHEURISTIC         VALUE 21.
                88 TPEEVENT             VALUE 22.
                88 TPEMATCH             VALUE 23.
                88 TPEDIAGNOSTIC        VALUE 24.
                88 TPEMIB               VALUE 25.
                88 TPEMAXVAL            VALUE 26.
      *>
        05 TPEVENT                PIC S9(9) COMP-5.
                88 TPEV-NOEVENT         VALUE 0.
                88 TPEV-DISCONIMM       VALUE 1.
                88 TPEV-SENDONLY        VALUE 2.
                88 TPEV-SVCERR          VALUE 3.
                88 TPEV-SVCFAIL         VALUE 4.
                88 TPEV-SVCSUCC         VALUE 5.
      *>
        05 APPL-RETURN-CODE       PIC S9(9) COMP-5.
      *>
        01  TPSVCDEF-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCDEF.cbl        $Revision: 1.5 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCDEF.cbl     
      *>
      *>  TPSVCDEF.cbl
      *>
        05 COMM-HANDLE          PIC S9(9) COMP-5.
        05 TPBLOCK-FLAG         PIC S9(9) COMP-5.
                88 TPBLOCK         VALUE 0.
                88 TPNOBLOCK       VALUE 1.
        05 TPTRAN-FLAG          PIC S9(9) COMP-5.
                88 TPTRAN          VALUE 0.
                88 TPNOTRAN        VALUE 1.
        05 TPREPLY-FLAG         PIC S9(9) COMP-5.
                88 TPREPLY         VALUE 0.
                88 TPNOREPLY       VALUE 1.
        05 TPACK-FLAG         REDEFINES TPREPLY-FLAG.
           10 FILLER PIC S9(9) COMP-5.
                88 TPNOACK         VALUE 0.
                88 TPACK           VALUE 1.
        05 TPTIME-FLAG          PIC S9(9) COMP-5.
                88 TPTIME          VALUE 0.
                88 TPNOTIME        VALUE 1.
        05 TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
                88 TPNOSIGRSTRT    VALUE 0.
                88 TPSIGRSTRT      VALUE 1.
        05 TPGETANY-FLAG        PIC S9(9) COMP-5.
                88 TPGETHANDLE     VALUE 0.
                88 TPGETANY        VALUE 1.
        05 TPSENDRECV-FLAG      PIC S9(9) COMP-5.
                88 TPSENDONLY      VALUE 0.
                88 TPRECVONLY      VALUE 1.
        05 TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
                88 TPCHANGE        VALUE 0.
                88 TPNOCHANGE      VALUE 1.
        05 TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
                88  TPREQRSP       VALUE IS 0.
                88  TPCONV         VALUE IS 1.
      *>
        05 APPKEY               PIC S9(9) COMP-5.
        05 CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
        05 SERVICE-NAME            PIC X(127).
      
      
      *>*****************************************************
      *> Log message definitions 
      *>*****************************************************
        01  LOGMSG.
                05  LOGMSG-PROG  VALUE 'GNSPQTAB :' PIC X(10) .
                05  LOGMSG-NUMB  VALUE '00'         PIC X(02).
                05  LOGMSG-TIME  VALUE '00000000'   PIC X(08).
                05  LOGMSG-TEXT.
                    07  LOGMSG-TEXT-1               PIC X(04).
                    07  LOGMSG-TEXT-2               PIC X(06).
                    07  LOGMSG-TEXT-3               PIC X(40).
                
        01  LOGMSG-LEN            PIC S9(9)  COMP-5.
      
                      
        01 TSK-TX-RETURN-STATUS.
           05 TSK-TX-STATUS PIC S9(9) COMP-5.
                88 TSK-TX-NOT-SUPPORTED             VALUE 1.
      *> Normal execution
                88 TSK-TX-OK                        VALUE 0.
      *> Normal execution
                88 TSK-TX-OUTSIDE                   VALUE -1.
      *> Application is in an RM local transaction
                88 TSK-TX-ROLLBACK                  VALUE -2.
      *> Transaction was rolled back
                88 TSK-TX-MIXED                     VALUE -3.
      *> Transaction was partially committed and partially rolled
                88 TSK-TX-HAZARD                    VALUE -4.
      *> Transaction may have been partially committed and partial
      *> rolled back
                88 TSK-TX-PROTOCOL-ERROR            VALUE -5.
      *> Routine invoked in an improper context
                88 TSK-TX-ERROR                     VALUE -6.
      *> Transient error
                88 TSK-TX-FAIL                      VALUE -7.
      *> Fatal error
                88 TSK-TX-EINVAL                    VALUE -8.
      *> Invalid arguments were given
                88 TSK-TX-COMMITTED                 VALUE -9.
      *> The transaction was heuristically committed
                88 TSK-TX-NO-BEGIN                  VALUE -100.
      *> Transaction committed plus new transaction could not be s
                88 TSK-TX-ROLLBACK-NO-BEGIN         VALUE  -102.
      *> Transaction rollback plus new transaction could not be st
                88 TSK-TX-MIXED-NO-BEGIN            VALUE  -103.
      *> Mixed plus new transaction could not be started
                88 TSK-TX-HAZARD-NO-BEGIN           VALUE  -104.
      *> Hazard plus new transaction could not be started
                88 TSK-TX-COMMITTED-NO-BEGIN        VALUE  -109.
      *> Heuristically committed plus transaction could not be sta
      *>
        01 TSK-TX-INFO-AREA.
      *> XID record
           05 TSK-XID-REC.
              10 TSK-FORMAT-ID        PIC S9(9) COMP-5.
      *> A value of -1 in FORMAT-ID means that the XID is null
              10 TSK-GTRID-LENGTH     PIC S9(9) COMP-5.
              10 TSK-BRANCH-LENGTH    PIC S9(9) COMP-5.
              10 TSK-XID-DATA         PIC X(128).
      *> Transaction mode settings
           05 TSK-TRANSACTION-MODE     PIC S9(9) COMP-5.
              88 TSK-TX-NOT-IN-TRAN   VALUE 0.
              88 TSK-TX-IN-TRAN       VALUE 1.
      *> Commit_return settings
           05 TSK-COMMIT-RETURN        PIC S9(9) COMP-5.
              88 TSK-TX-COMMIT-COMPLETED          VALUE 0.
              88 TSK-TX-COMMIT-DECISION-LOGGED    VALUE 1.
      *> Transaction_control settings
           05 TSK-TRANSACTION-CONTROL  PIC S9(9) COMP-5.
              88 TSK-TX-UNCHAINED     VALUE 0.
              88 TSK-TX-CHAINED       VALUE 1.
      *> Transaction_timeout value
           05 TSK-TRANSACTION-TIMEOUT  PIC S9(9) COMP-5.
              88 NO-TIMEOUT       VALUE 0.
      *> Transaction_state information
           05 TSK-TRANSACTION-STATE    PIC S9(9) COMP-5.
              88 TSK-TX-ACTIVE        VALUE 0.
              88 TSK-TX-TIMEOUT-ROLLBACK-ONLY     VALUE 1.
              88 TSK-TX-ROLLBACK-ONLY             VALUE 2.
      
      
        01 TPTRXLEV-REC.
      *>
      *>  TPTRXLEV.cbl
      *>
        05 TPTRXLEV-FLAG           PIC S9(9) COMP-5.
                88 TP-NOT-IN-TRAN  VALUE 0.
                88 TP-IN-TRAN      VALUE 1.
      *>
      
        01 TPTRXDEF-REC.
      *>
      *>  TPTRXDEF.cbl
      *>
        05 T-OUT        PIC S9(9) COMP-5 VALUE IS 0.
        05 TRANID       OCCURS 6 TIMES PIC S9(9) COMP-5.
      
      
      
      
      
       01  TSK-VARI.                                                    
      
            03 TSK-TERM-ORIGEN    VALUE 'N'           PIC  X(01).       
      
            03 TSK-TRANID.
               05 TSK-TRANID-1                        PIC S9(10).
               05 TSK-TRANID-2                        PIC S9(10).
               05 TSK-TRANID-3                        PIC S9(10).
               05 TSK-TRANID-4                        PIC S9(10).
               05 TSK-TRANID-5                        PIC S9(10).
               05 TSK-TRANID-6                        PIC S9(10).
            03 TSK-TRANID-ALF REDEFINES   TSK-TRANID  PIC  X(60).       
      
            03 TSK-INFO-TRAN.
               05 TSK-INFO-TRANID                     PIC 9(07).
               05 TSK-INFO-TRANID-ALF REDEFINES 
                                    TSK-INFO-TRANID   PIC X(07).        
               05 TSK-INFO-COMMIT                     PIC 9(01).
      
            03 TSK-TERM-NUM               COMP-3      PIC S9(07).       
            03 TSK-TERM-ALF REDEFINES   TSK-TERM-NUM  PIC  X(04).       
      
            03 TSK-TERM-TUX                           PIC  X(256).  
            
            03 TSK-TERM-NUM-TUX                       PIC  9(07).       
            03 TSK-TERM-NUM-TUX-ALF REDEFINES 
                                    TSK-TERM-NUM-TUX  PIC  X(07).       
      
            03 TSK-TERM-NUM-TUX-6                     PIC  9(06).       
            03 TSK-TERM-NUM-TUX-ALF-6 REDEFINES 
                                  TSK-TERM-NUM-TUX-6  PIC  X(06).       
      
      
      
       01  HEADER-VARI.
           03 HEADER-NOM-TSPT.
              05 HEADER-COD-TERM   VALUE 'HE'              PIC X(02).   
              05 HEADER-COD-TYPE   VALUE SPACES            PIC X(06).   
      
       01  HEADER-MENS VALUE SPACES.                              
           03 HEADER-VERS                        PIC X(00004).
           03 HEADER-BNCO                        PIC X(00003).
           03 HEADER-MRCA                        PIC X(00003).
           03 HEADER-CART                        PIC X(00003).
           03 HEADER-LENG                        PIC X(00002).
           03 HEADER-PAIS                        PIC X(00002).
           03 HEADER-VRNT                        PIC X(00001).
           03 HEADER-USER                        PIC X(00012).
           03 HEADER-CNAL                        PIC X(00005).
           03 HEADER-UMUA                        PIC X(00012).
           03 HEADER-PROG                        PIC X(00008).
           03 HEADER-IBYA                        PIC X(00001).
           03 HEADER-BCKI                        PIC X(00001).
           03 HEADER-I24H                        PIC X(00001).
           03 HEADER-MODO                                    
                          REDEFINES HEADER-I24H PIC X(00001).           
           03 HEADER-MNSF                        PIC X(00001).
           03 HEADER-ORIG                        PIC X(00003).
           03 HEADER-MSGC                        PIC X(00001).
           03 HEADER-MSGM                        PIC X(00001).
           03 HEADER-DIS1                        PIC X(00026).
           03 HEADER-IREQ.                                    
              05 HEADER-IR01                     PIC X(00001).
              05 HEADER-IR02                     PIC X(00001).
              05 HEADER-IR03                     PIC X(00001).
              05 HEADER-IR04                     PIC X(00001).
              05 HEADER-IR05                     PIC X(00001).
              05 HEADER-IR06                     PIC X(00001).
              05 HEADER-IR07                     PIC X(00001).
              05 HEADER-IR08                     PIC X(00001).
              05 HEADER-IR09                     PIC X(00001).
              05 HEADER-IR10                     PIC X(00001).
      
      
      
      
       01  MULMSG-VARI.
           03 MULMSG-NOM-TSPT.
              05 MULMSG-COD-TERM   VALUE SPACES  PIC X(04).       
              05 MULMSG-COD-TYPE   VALUE 'MMSG'  PIC X(04).       
      
       01  MULMSG-MENS VALUE SPACES.                              
           03 MULMSG-TIPO                        PIC X(00001).
           03 MULMSG-FORM                        PIC X(00003).
           03 MULMSG-SIST                        PIC X(00003).
           03 MULMSG-CODI                        PIC X(00012).
           03 MULMSG-DATO                        PIC X(01005).
      
      
      
                          
      *>                                                                 
       01  QUE-VARI.                                                    
           03 QUE-COLA.                                                 
              05 QUE-TERM                              PIC  X(04).      
              05 QUE-TYPE                              PIC  X(04).      
           03 QUE-NITM       COMP VALUE +0             PIC S9(04).      
           03 QUE-LITM       COMP                      PIC S9(04).      
           03 QUE-ITEM.                                                 
              05 QUE-IKEY                              PIC  X(03).      
              05 QUE-LDAT    COMP VALUE +0             PIC S9(04).      
              05 QUE-PCUR    COMP VALUE +0             PIC S9(04).      
              05 QUE-DATA                              PIC  X(3000).    
           03 QUE-STAT            VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-OKS        VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-NEX        VALUE 'NEX'          PIC  X(03).      
           03 QUE-STAT-EOQ        VALUE 'EOQ'          PIC  X(03).      
           03 QUE-CMND                                 PIC  X(03).      
           03 QUE-MENS.                                                 
              05 QUE-MEN1                              PIC  X(40).      
              05 QUE-MEN2                              PIC  X(39).
           01 QUE-NUM-STAT                             PIC  S9(09).
           01 QUE-GLS-STAT                             PIC  S9(09).
              
       01  QUE-CTTS.                                                    
           03 QUE-PUT             VALUE 'PUT'          PIC  X(03).      
           03 QUE-GET             VALUE 'GET'          PIC  X(03).      
           03 QUE-MOD             VALUE 'MOD'          PIC  X(03).      
           03 QUE-DEL             VALUE 'DEL'          PIC  X(03).      
      
       01  QUE-SEND.                                                    
           03 QUE-COM-SEND                             PIC  X(03).      
           03 QUE-NAM-SEND                             PIC  X(300).     
           03 QUE-NUM-SEND                             PIC  9(04).      
           03 QUE-LAR-SEND                             PIC  9(04).      
           03 QUE-TRX-SEND                             PIC  X(256).     
           03 QUE-DAT-SEND                             PIC  X(9000).    
      
       01  QUE-RECV.                                                    
           03 QUE-FIL-RECV                             PIC  9(02).      
           03 QUE-STA-RECV                             PIC  9(18).      
           03 QUE-NUM-RECV                             PIC  9(04).      
           03 QUE-LAR-RECV                             PIC  9(04).      
           03 QUE-TRX-RECV                             PIC  X(256).     
           03 QUE-DAT-RECV                             PIC  X(9000).    
      
       01  QUE-TPTYPE-REC-SEND.
           05 QUE-REC-SEND-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-SEND-SUB-TYPE                 PIC X(16).
           05 QUE-REC-SEND-LEN       VALUE 9568     PIC S9(9) COMP-5.
           05 QUE-REC-SEND-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-SEND-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-SEND-TPTRUNCATE   VALUE 1.
      
       01  QUE-TPTYPE-REC-RECV.
           05 QUE-REC-RECV-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-RECV-SUB-TYPE                 PIC X(16).
           05 QUE-REC-RECV-LEN       VALUE 9285     PIC S9(9) COMP-5.
           05 QUE-REC-RECV-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-RECV-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-RECV-TPTRUNCATE   VALUE 1.
              
       01 QUE-TPSVCDEF-REC.
       05 QUE-COMM-HANDLE          PIC S9(9) COMP-5.
       05 QUE-TPBLOCK-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPBLOCK         VALUE 0.
               88 QUE-TPNOBLOCK       VALUE 1.
       05 QUE-TPTRAN-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTRAN          VALUE 0.
               88 QUE-TPNOTRAN        VALUE 1.
       05 QUE-TPREPLY-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPREPLY         VALUE 0.
               88 QUE-TPNOREPLY       VALUE 1.
       05 QUE-TPACK-FLAG         REDEFINES QUE-TPREPLY-FLAG.
          10 FILLER PIC S9(9) COMP-5.
               88 QUE-TPNOACK         VALUE 0.
               88 QUE-TPACK           VALUE 1.
       05 QUE-TPTIME-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTIME          VALUE 0.
               88 QUE-TPNOTIME        VALUE 1.
       05 QUE-TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPNOSIGRSTRT    VALUE 0.
               88 QUE-TPSIGRSTRT      VALUE 1.
       05 QUE-TPGETANY-FLAG        PIC S9(9) COMP-5.
               88 QUE-TPGETHANDLE     VALUE 0.
               88 QUE-TPGETANY        VALUE 1.
       05 QUE-TPSENDRECV-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPSENDONLY      VALUE 0.
               88 QUE-TPRECVONLY      VALUE 1.
       05 QUE-TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPCHANGE        VALUE 0.
               88 QUE-TPNOCHANGE      VALUE 1.
       05 QUE-TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
               88 QUE-TPREQRSP       VALUE IS 0.
               88 QUE-TPCONV         VALUE IS 1.
       05 QUE-APPKEY               PIC S9(9) COMP-5.
       05 QUE-CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
       05 QUE-SERVICE-NAME   VALUE "ts" PIC X(127).
      
      
      
      *> VARIABLES PARA ENGANCHE PROGRAMAS COMENTARIOS                   
       01  KEY-VARI.                                                    
      *>    ENTIDAD                                                      
           03 KEY-COD-ENTI                             PIC X(03).       
      *>    NOMBRE                                                       
           03  KEY-GLS-NOMC                            PIC X(60).       
      *>    RUT                                                          
           03  KEY-CIC-IRUT.                                            
               05  KEY-NUM-ICLI                        PIC 9(08).       
               05  KEY-VRF-ICLI                        PIC X(01).       
               05  KEY-IND-ICLI                        PIC X(01).       
               05  KEY-GLS-ICLI                        PIC X(03).       
      *>    CIC OPE                                                      
           03  KEY-CIC-IOPE.                                            
               05  KEY-CAI-IOPE                        PIC X(04).       
               05  KEY-IIC-IOPE                        PIC X(08).       
      *>    FECHA                                                        
           03  KEY-FEC-FENT.                                            
               05 KEY-NUM-DENT                         PIC 9(02).       
               05 KEY-NUM-MENT                         PIC 9(02).       
               05 KEY-NUM-SENT                         PIC 9(02).       
               05 KEY-NUM-AENT                         PIC 9(02).       
      *>    CORRELATIVO                                                  
           03 KEY-NUM-IENT                             PIC 9(03).       
      *>    CODIGO                                                       
           03 KEY-COD-IENT                             PIC X(03).       
      *>    FECHA COMENTARIO                                             
           03  KEY-FEC-FCMT.                                            
               05 KEY-NUM-DCMT                         PIC 9(02).       
               05 KEY-NUM-MCMT                         PIC 9(02).       
               05 KEY-NUM-SCMT                         PIC 9(02).       
               05 KEY-NUM-ACMT                         PIC 9(02).       
      *>    CORRELATIVO COMENTARIO                                       
           03 KEY-NUM-GCMT                             PIC 9(03).       
      *>    USUARIO                                                      
           03 KEY-COD-USER                             PIC X(12).       
                     
      
        01  USER-DATA-REC          PIC X(75).
      
      *>FIN-PENTA TUXEDO ORACLE
      
                                                                        
      *>    Request Area                                                 
       01  ADR-MNU-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                        
      *>    Request Area                                                 
       01  ADR-RPF-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                        
      *>    Request Area                                                 
       01  ADR-TAB-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                        
      *>    Request Area                                                 
       01  ADR-IDD-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                        
                                                                        
      *>    Archivo de Menu
      *>    ---------------
      *>
      *>    Nombre Registro : MNU
      *>    Clave(s)        : MNU-COD-NEMS(UU),MNU-COD-OPCS(UC),
      *>                      MNU-COD-IMES(UC)
      *>    Largo           : 492
      *>    Bloqueo         : 1
      *>    Observaciones   :
      *>
       01  MNU.
      *>
      *>       Filler Compatibilidad VSAM/MVS
           03 MNU-GLS-FLAG                              PIC X(01).
      *>
      *>       Llave primaria nemotecnica
           03 MNU-COD-NEMS.
      *>
      *>       Llave primaria nemotecnica OLD
              05 MNU-COD-NEMO.
      *>
      *>          Sistema
                 07 MNU-COD-SYST                        PIC X(03).
      *>
      *>          Codigo accion
                 07 MNU-COD-CACC                        PIC X(03).
      *>
      *>          Codigo de Funcion
                 07 MNU-COD-FUNC.
      *>
      *>             Entidad
                    09 MNU-COD-ENTI                     PIC X(03).
      *>
      *>             Comando
                    09 MNU-COD-COMD                     PIC X(03).
      *>
           03 MNU-COD-OPCS.
      *>
              05 MNU-COD-IPCN.
      *>       Llave secundaria 1: Opcion
                 07 MNU-COD-OPCI                        PIC X(03).
      *>
      *>       Llave secundaria 2: Menu + Ordinal
           03 MNU-COD-IMES.
      *>
              05 MNU-COD-IMEN.
      *>          Codigo menu
                 07 MNU-COD-CMEN                        PIC X(03).
      *>
      *>          Ordinal
                 07 MNU-NUM-ORDI                        PIC 9(03).
      *>
      *>CAH-INI 12-MAY-1998
      *>    Time Stamp Transaccion
      *>     03  MNU-STP-ITRN.
      *>
      *>        Fecha Transaccion
      *>         05  MNU-FEC-FTRN.
      *>             07  MNU-NUM-STRN                 PIC 9(02).
      *>             07  MNU-NUM-ATRN                 PIC 9(02).
      *>             07  MNU-NUM-MTRN                 PIC 9(02).
      *>             07  MNU-NUM-DTRN                 PIC 9(02).
      *>
      *>            Hora Transaccion
      *>         05  MNU-HRA-HRTR.
      *>             07  MNU-NUM-HHTR                 PIC 9(02).
      *>             07  MNU-NUM-MMTR                 PIC 9(02).
      *>             07  MNU-NUM-SSTR                 PIC 9(02).
      *>
      *>REQ Indicador Tipo Accion
      *>     03  MNU-MSC-TACC                             PIC X(01).
      *>
      *>    Indicador Status
      *>     03  MNU-MSC-STAT                             PIC X(01).
      *>
      *>REQ Codigo Origen Transaccion
      *>     03  MNU-COD-OTRN.
      *>
      *>        Indicador Tipo Origen
      *>         05  MNU-MSC-TTRN                         PIC X(01).
      *>
      *>        Codigo Tipo Origen
      *>         05  MNU-COD-TTRN                         PIC X(03).
      *>
      *>REQ Autor Transaccion
      *>     03  MNU-COD-ATRN                             PIC X(12).
      *>
      *>       Tipo funcion
           03 MNU-COD-TFUN                              PIC X(03).
      *>
      *>       Glosa funcion menu
           03 MNU-GLS-FMEN                              PIC X(30).
      *>
      *>       Comando
           03 MNU-GLS-CMND.
      *>
      *>          Prefijo comando
              05 MNU-GLS-COMD                           PIC X(12).
      *>
      *>          Programa
              05 MNU-GLS-PROG                           PIC X(12).
      *>
      *>          Resto comando
              05 MNU-GLS-FILL                           PIC X(29).
      *>
      *>       Transaccion
           03 MNU-GLS-TRAN                              PIC X(04).
      *>
      *>       Comando ingreso programa
           03 MNU-COD-CMND                              PIC X(03).
      *>
      *>       Biblioteca documentacion.
           03 MNU-GLS-LDOC                              PIC X(07).
      *>
      *>       Nombre modulo documentacion
           03 MNU-GLS-NDOC                              PIC X(24).
      *>
      *>       Biblioteca formulario
           03 MNU-GLS-LFRM                              PIC X(07).
      *>
      *>       Nombre formulario
           03 MNU-GLS-NFRM                              PIC X(07).
      *>
      *>       Glosa funcion programa
           03 MNU-GLS-FPRO                              PIC X(30).
      *>
      *>       Fila
           03 MNU-NUM-FILA          COMP                PIC S9(02).
      *>
      *>       Columna
           03 MNU-NUM-COLU          COMP                PIC S9(02).     
      
      *>
      *>       Funcion retorno  (default)
           03 MNU-COD-FRET                              PIC X(12).
      *>
      *>       Indicador confirmacion
           03 MNU-IND-CONF                              PIC X(01).
      *>
      *>       Menu
           03 MNU-COD-MENU                              PIC X(03).
      *>
      *>       Indicador de privilegios
           03 MNU-IND-IPRV                              PIC X(01).
      *>
      *>       Instancia ingreso programa
           03 MNU-COD-INST                              PIC X(03).
      *>
      *>       Indicador si expande o no glosa de menu
           03 MNU-IND-EXGL                              PIC X(01).
      *>
      *>       Indicador transferencia de control
           03 MNU-IND-SEQU                              PIC X(03).
      *>
      *>       Sistema
           03 MNU-COD-SIST                              PIC X(03).
      *>
      *>       Codigo de traspaso de control al programa
           03 MNU-COD-TCTL                              PIC X(04).
      *>
      *>       Accion a ejecutar sobre formulario
           03 MNU-COD-EJFR                              PIC X(03).
      *>
      *>       Funcion anterior
           03 MNU-COD-FANT                              PIC X(12).
      *>
      *>       Codigo Tabla
           03 MNU-COD-TABL.
              05 MNU-COD-TTAB                           PIC X(03).
              05 MNU-COD-CTAB                           PIC X(12).
      *>
      *>       Indicador clear
           03 MNU-IND-NCLR                              PIC X(01).
      *>
      *>       Biblioteca formulario para VAX
           03 MNU-GLS-LFVX                              PIC X(07).
      *>
      *>       Nombre formulario para VAX
           03 MNU-GLS-NFVX                              PIC X(07).
      *>
      *>       Programa
           03 MNU-GLS-PRGM                              PIC X(08).
      *>
      *>       Independencia Fisica Datos
           03 MNU-COD-CIFD                              PIC X(12).
      *>
      *>       Codigo de traspaso de informacion al programa
           03 MNU-COD-TINF                              PIC X(03).
      *>
      *>       Modalidad de Salida del programa
           03 MNU-COD-MSAL                              PIC X(03).
      *>
      *>       Accion a ejecutar con pantalla
           03 MNU-COD-ASCR                              PIC X(01).
      *>
      *>       Accion a ejecutar con mapa programa
           03 MNU-COD-AMPG                              PIC X(01).
      *>
      *>       Nombre Mapa Header
           03 MNU-GLS-NMHD                              PIC X(07).
      *>
      *>       Libreria Mapa Header
           03 MNU-GLS-LMHD                              PIC X(07).
      *>
      *>       Accion a ejecutar con mapa header
           03 MNU-COD-AMHD                              PIC X(01).
      *>
      *>       Nombre Mapa Comandos
           03 MNU-GLS-NMCM                              PIC X(07).
      *>
      *>       Libreria Mapa Comandos
           03 MNU-GLS-LMCM                              PIC X(07).
      *>
      *>       Accion a ejecutar con Mapa comandos
           03 MNU-COD-AMCM                              PIC X(01).
      *>
      *>       Usa IDD
           03 MNU-COD-UIDD                              PIC X(03).
      *>
      *>       Disponible Futuras Ampliaciones
           03 MNU-GLS-DISP                              PIC X(118).
      *>
      *>    Variables de Menu
       01  MNU-VARI.
      *>
      *>    Nombre de Programa FIO para Menu
           03  MNU-GLS-FMNU.
      *>
      *>        Codigo Sistema
               05  MNU-COD-STMA                         PIC X(03).
      *>
      *>        Nombre "fijo" de FIO Menu
               05  MNU-COD-FMNU           VALUE 'PFMNU' PIC X(05).
      *>
                                                                        
      *>        RELACION PROGRAMA - FORMULARIO                           
      *>
      *>    Nombre Registro : RPF
      *>    Clave(s)        : RPF-COD-DPTS(UU)
      *>    Largo           : 128
      *>    Bloqueo         : 1
      *>    Observaciones   :
      *>
       01  RPF.                                                         
      *>                                                                 
      *>    FILLER COMPATIBILIDAD VSAM/MVS                               
      *>    03 RPF-GLS-FLAG                         PIC X(01).           
      *>                                                                 
           03 RPF-COD-DPTS.
      *>
      *>        DESCRIPCION PROGRAMA + TIPO REGISTRO (LLAVE)             
               05 RPF-COD-DPTR.
      *>                                                                 
      *>        DESCRIPCION PROGRAMA                                     
                  07 RPF-COD-DPRO                      PIC X(12).
      *>                                                                 
      *>        TIPO REGISTRO Y CORRELATIVO                              
      *>          A   =   AUTOR                                          
      *>          B   =   ARCHIVO BASE                                   
      *>          C   =   COMANDOS                                       
      *>          C0  =   COMANDO 0                                      
      *>          C1  =   COMANDO 1                                      
      *>          .                                                      
      *>          .                                                      
      *>          C9  =   COMANDO 9                                      
      *>          P1  =   FORMULARIO 1                                   
      *>          .                                                      
      *>          .                                                      
      *>          P9  =   FORMULARIO 9                                   
      *>          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA        
      *>           0  =   LLAVE                                          
      *>           1  =   VARIABLE 1                                     
      *>           .                                                     
      *>           .                                                     
      *>           9  =   VARIABLE 9                                     
      *>                                                                 
                  07 RPF-COD-TRYC.
      *>                                                                 
      *>        TIPO REGISTRO                                            
                    09 RPF-COD-TREG                    PIC X(01).
      *>                                                                 
      *>        CORRELATIVO                                              
                 09 RPF-COD-CORR                       PIC 9(01).
      *>                                                                 
      *>        DESCRIPCION ARCHIVOS                                     
                  07 RPF-COD-DARC                      PIC X(08).
      *>                                                                 
           03 RPF-KEY-DPTS REDEFINES RPF-COD-DPTS.
      *>
               05 RPF-KEY-DPTR.
      *>        DESCRIPCION PROGRAMA                                     
                  07 RPF-KEY-DPRO                      PIC X(12).
      *>                                                                 
      *>        TIPO REGISTRO Y CORRELATIVO                              
      *>          A   =   AUTOR                                          
      *>          B   =   ARCHIVO BASE                                   
      *>          C   =   COMANDOS                                       
      *>          C0  =   COMANDO 0                                      
      *>          C1  =   COMANDO 1                                      
      *>          .                                                      
      *>          .                                                      
      *>          C9  =   COMANDO 9                                      
      *>          P1  =   FORMULARIO 1                                   
      *>          .                                                      
      *>          .                                                      
      *>          P9  =   FORMULARIO 9                                   
      *>          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA        
      *>           0  =   LLAVE                                          
      *>           1  =   VARIABLE 1                                     
      *>           .                                                     
      *>           .                                                     
      *>           9  =   VARIABLE 9                                     
      *>                                                                 
                  07 RPF-KEY-TRYC.
      *>                                                                 
      *>        TIPO REGISTRO                                            
                    09 RPF-KEY-TREG                    PIC X(01).
      *>                                                                 
      *>        CORRELATIVO                                              
                 09 RPF-KEY-CORR                       PIC 9(01).       
      *>                                                                 
      *>        DESCRIPCION ARCHIVOS                                     
                  07 RPF-KEY-DARC                      PIC X(08).
      *>
      *>CAH-INI 12-MAY-1998
      *>    Time Stamp Transaccion
      *>     03  RPF-STP-ITRN.
      *>
      *>        Fecha Transaccion
      *>         05  RPF-FEC-FTRN.
      *>             07  RPF-NUM-STRN                 PIC 9(02).
      *>             07  RPF-NUM-ATRN                 PIC 9(02).
      *>             07  RPF-NUM-MTRN                 PIC 9(02).
      *>             07  RPF-NUM-DTRN                 PIC 9(02).
      *>
      *>            Hora Transaccion
      *>         05  RPF-HRA-HRTR.
      *>             07  RPF-NUM-HHTR                 PIC 9(02).
      *>             07  RPF-NUM-MMTR                 PIC 9(02).
      *>             07  RPF-NUM-SSTR                 PIC 9(02).
      *>
      *>REQ Indicador Tipo Accion
      *>     03  RPF-MSC-TACC                             PIC X(01).
      *>
      *>    Indicador Status
      *>     03  RPF-MSC-STAT                             PIC X(01).
      *>
      *>REQ Codigo Origen Transaccion
      *>     03  RPF-COD-OTRN.
      *>
      *>        Indicador Tipo Origen
      *>         05  RPF-MSC-TTRN                         PIC X(01).
      *>
      *>        Codigo Tipo Origen
      *>         05  RPF-COD-TTRN                         PIC X(03).
      *>
      *>REQ Autor Transaccion
      *>     03  RPF-COD-ATRN                             PIC X(12).
      *>
      *>        DATO ANEXO                                               
           03 RPF-GLS-DATA                         PIC X(70).           
      *>                                                                 
           03 RPF-GLS-DAT1 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION AUTOR                                        
              05 RPF-GLS-DAUT                      PIC X(42).           
      *>                                                                 
      *>        CODIGO INDEPEDENCIA FISICA DE DATOS                      
              05 RPF-COD-CIFD                      PIC X(12).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS1                      PIC X(16).           
      *>                                                                 
           03 RPF-GLS-DAT2 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        ARCHIVO BASE                                             
              05 RPF-GLS-ABAS                      PIC X(08).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS2                      PIC X(62).           
      *>                                                                 
           03 RPF-GLS-DAT3 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-COD-DIS3                      PIC X(03).           
      *>                                                                 
      *>        GLOSA COMANDOS                                           
              05 RPF-GLS-DCMN                      PIC X(25).           
      *>                                                                 
      *>        GLOSA ABORTO                                             
              05 RPF-GLS-ABRT                      PIC X(25).           
      *>                                                                 
      *>        SUBRUTINA ALTERNATIVA COMANDOS                           
              05 RPF-GLS-UARA                      PIC X(12).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS3                      PIC X(05).           
      *>                                                                 
           03 RPF-GLS-DAT4 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        CODIGO COMANDO                                           
              05 RPF-COD-CCMN                      PIC X(03).           
      *>                                                                 
      *>        GLOSA PROMPT                                             
              05 RPF-GLS-PRMT                      PIC X(25).           
      *>                                                                 
      *>        GLOSA CONFIRMACION                                       
              05 RPF-GLS-CONF                      PIC X(25).           
      *>                                                                 
      *>        SUBRUTINA COMANDO                                        
              05 RPF-GLS-UARC                      PIC X(12).           
      *>                                                                 
      *>        CODIGO COMANDO PARA PROGRAMA                             
              05 RPF-COD-CCPP                      PIC X(03).           
      *>                                                                 
      *>        ESTADO COMANDO PARA PROGRAMA                             
              05 RPF-IND-STPP                      PIC X(01).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS4                      PIC X(01).           
      *>                                                                 
           03 RPF-GLS-DAT5 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION BIBLIOTECA DE FORMULARIO                     
              05 RPF-GLS-LFRM                      PIC X(06).           
      *>                                                                 
      *>        DESCRIPCION DE FORMULARIO                                
              05 RPF-GLS-NFRM                      PIC X(06).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS5                      PIC X(58).           
      *>                                                                 
           03 RPF-GLS-DAT6 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        LUGAR DEL CODIGO EN PROGRAMA                             
              05 RPF-KEY-LCEP                      PIC X(02).           
      *>                                                                 
      *>        FORMULARIO DEL CODIGO EN PROGRAMA                        
              05 RPF-KEY-FCEP                      PIC X(06).           
      *>                                                                 
      *>        VARIABLE DEL CODIGO EN PROGRAMA                          
              05 RPF-KEY-VCEP                      PIC X(32).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS6                      PIC X(30).           
      *>                                                                 
           03 RPF-GLS-DAT7 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION LLAVE                                        
              05 RPF-GLS-DKEY                      PIC X(10).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS7                      PIC X(60).           
      *>                                                                 
           03 RPF-GLS-DAT8 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION VARIABLE PARA FORMAR LLAVE                   
              05 RPF-GLS-DVAR                      PIC X(32).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS8                      PIC X(38).           
      *>
                                                                        
      *> COPY GNSBRTAB.                                                  
      *>    Registro Generico de Tablas                                  
      *>    NECESARIO PARA COMPILAR CICS RESCATADO EL 02.07.98.          
      *>    ---------------------------                                  
      *>                                                                 
      *>    Nombre Registro : TAB                                        
      *>    Clave(s)        : TAB-KY0-TABS(UU),
      *>                      TAB-KY1-TABS(UU), TAB-KY1-TABS(DC)
      *>    Largo           : 206
      *>    Bloqueo         : 2                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  TAB.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  TAB-GLS-FLAG                             PIC X(01).      
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  TAB-KEY-IREG.                                            
      *>                                                                 
      *>KEY     Tipo + Codigo ( LLave Primaria )                         
               05  TAB-KY0-TABS.
                   07  TAB-COD-TABL.
      *>                                                                 
      *>            Codigo Tipo Tabla                                    
                       09  TAB-COD-TTAB                 PIC X(03).
      *>                                                                 
      *>            Codigo Tabla                                         
                       09  TAB-COD-CTAB                 PIC X(12).
      *>                                                                 
      *>        Time Stamp Transaccion                                   
               05  TAB-COD-ITRS.
                   07  TAB-STP-ITRN.
      *>                                                                 
      *>            Fecha Transaccion                                    
                       09  TAB-FEC-FTRN.
                           11  TAB-NUM-STRN             PIC 9(02).
                           11  TAB-NUM-ATRN             PIC 9(02).
                           11  TAB-NUM-MTRN             PIC 9(02).
                           11  TAB-NUM-DTRN             PIC 9(02).
      *>                                                                 
      *>            Hora Transaccion                                     
                       09  TAB-HRA-HRTR.
                           11  TAB-NUM-HHTR             PIC 9(02).
                           11  TAB-NUM-MMTR             PIC 9(02).
                           11  TAB-NUM-SSTR             PIC 9(02).
      *>                                                                 
      *>    Indicador Tipo Accion                                        
           03  TAB-MSC-TACC                             PIC X(01).      
      *>                                                                 
      *>    Indicador Status                                             
           03  TAB-MSC-STAT                             PIC X(01).      
      *>                                                                 
      *>    Indicador Vigencia                           GNS VIGE        
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).      
      *>                                                                 
      *>    Codigo Origen Transaccion                                    
           03  TAB-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  TAB-MSC-TTRN                         PIC X(01).      
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  TAB-COD-TTRN                         PIC X(03).      
      *>                                                                 
      *>    Autor Transaccion                                            
           03  TAB-COD-ATRN                             PIC X(12).      
      *>                                                                 
      *>KEY Tipo + Codigo ( Interno Computacional )                      
           03  TAB-KY1-TABS.
               05  TAB-CIC-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-CIC-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-CIC-CTAB                     PIC X(12).
      *>                                                                 
      *>    Codigo Externo                                               
           03  TAB-KY2-TABS.
               05  TAB-EXT-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-EXT-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-EXT-CTAB                     PIC X(05).
      *>                                                                 
      *>    Descripcion Corta                                            
           03  TAB-GLS-DCOR                             PIC X(12).      
      *>                                                                 
      *>    Abreviacion Descripcion                                      
           03  TAB-GLS-ABRV                             PIC X(05).      
      *>                                                                 
      *>    Descripcion del Codigo                                       
           03  TAB-GLS-DESC                             PIC X(40).      
      *>                                                                 
      *>    Datos Anexos                                                 
           03  TAB-GLS-DATA.                                            
               05  TAB-GLS-DAT1.                                        
                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).      
               05  TAB-GLS-DAT2.                                        
                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).      
               05  TAB-GLS-DAT3.                                        
                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).      
      *>                                                                 
      *>    Clave Soundex                                                
           03  TAB-SNX-TABL.                                            
               05  TAB-SNX-TTAB                         PIC X(03).      
               05  TAB-SNX-CTAB                         PIC X(03).      
      *>                                                                 
      *>    Variables de Tablas                                          
       01  TAB-VARI.                                                    
      *>                                                                 
      *>    Nombre de Programa FIO para TABlas                           
           03  TAB-GLS-FTAB.                                            
      *>                                                                 
      *>        Codigo Sistema                                           
               05  TAB-COD-SIST                         PIC X(03).      
      *>                                                                 
      *>        Nombre "fijo" de FIO TABlas                              
               05  TAB-COD-FTAB           VALUE 'PFTAB' PIC X(05).      
      *>
                                                                        
                                                                        
      *>    Request Area                                                 
       01  ADR-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                        
      *> User Information Block                                          
       01  ADR-UIFB.                                                    
      *>                                                                 
      *>    Programa                                                     
           03 ADR-PROG                                  PIC X(08).      
      *>                                                                 
           03 FILLER                                    PIC X(24).      
                                                                        
      *>    Element List                                                 
       01  ADR-ELLS.                                                    
      *>    Elemento 1                                                   
           03 ADR-ELM1                                  PIC X(05).      
      *>    Codigo de Seguridad                                          
           03 ADR-CSEG                                  PIC X(01).      
      *>    Fin de Element List                                          
           03 FILLER                    VALUE SPACES    PIC X(05).      
                                                                        
      *>    Registro Independencia de Datos                              
      *>    -------------------------------                              
      *>                                                                 
      *>    Nombre Registro : IDD                                        
      *>    Clave(s)        : IDD-COD-CIDD                               
      *>    Largo           : 490                                        
      *>    Bloqueo         : 1                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  IDD.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03 IDD-GLS-FLAG                              PIC X(01).      
      *>                                                                 
      *>    Codigo Identificacion IDD ( Clave Primaria Registro )        
           03 IDD-COD-CIDD                              PIC X(12).      
      *>                                                                 
      *>    Tabla Independencia de datos                                 
           03 IDD-GLS-FSIS.                                             
              05 IDD-GLS-VSIS OCCURS 43 INDEXED BY IDD-NUM-ITBL.        
      *>                                                                 
      *>          Descripcion de la entidad                              
                 07 IDD-GLS-DENT.                                       
      *>                                                                 
      *>             Sistema                                             
                    09 IDD-COD-SIST                     PIC X(03).      
      *>                                                                 
      *>             Grupo                                               
                    09 IDD-COD-GRPO                     PIC X(01).      
      *>                                                                 
      *>             Registro                                            
                    09 IDD-COD-RGST                     PIC X(03).      
      *>                                                                 
      *>          Tipo de la Entidad                                     
                 07 IDD-COD-TENT                        PIC X(01).      
      *>                                                                 
      *>          Identificacion de la Entidad                           
                 07 IDD-COD-IENT                        PIC X(03).      
      *>                                                                 
      *>    Disponible                                                   
           03 IDD-GLS-DISP                              PIC X(04).      
      *>
                                                                        
      *>Variables para independencia de datos 15-JAN-1990 17:04:48       
       01  IDD-VARI.                                                    
           03 IDD-PROG                          PIC X(08).              
           03 IDD-DAUX.                                                 
              05 IDD-SAUX                       PIC X(03).              
              05 IDD-GAUX                       PIC X(01).              
              05 IDD-RAUX                       PIC X(03).              
           03 IDD-IAUX                          PIC 9(02).              
           03 IDD-REGI.                                                 
              05 FILLER                         PIC X(01).              
              05 IDD-CIDD                       PIC X(12).              
              05 IDD-FSIS.                                              
                 07 IDD-VSIS OCCURS 43 INDEXED BY IDD-ITBL.             
                    09 IDD-DENT.                                        
                       11 IDD-SIST              PIC X(03).              
                       11 IDD-GRPO              PIC X(01).              
                       11 IDD-RGST              PIC X(03).              
                    09 IDD-TENT                 PIC X(01).              
                    09 IDD-IENT                 PIC X(03).              
      *>ESTE REDEFINES TIENE COMO PROPOSITO COMPILAR                     
      *>PROGRAMAS NUEVOS CON FIO"S ANTIGUAS ( SIN GENERARLAS )           
      *>              09 IFD-GSIS REDEFINES IDD-IENT                     
      *>                                          PIC X(03).             
              05 FILLER                         PIC X(04).              
                                                                        
      *>    Constantes para las rutinas FIO"s                            
       01  FIO-CTTS.                                                    
      *>                                                                 
      *>    DEFault access for other users                               
           03 FIO-ACCS-DEF        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    NOT     access for other users                               
           03 FIO-ACCS-NOT        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    INPut   access for other users                               
           03 FIO-ACCS-INP        VALUE 2       PIC 9(01).              
      *>                                                                 
      *>    UPDate  access for other users                               
           03 FIO-ACCS-UPD        VALUE 3       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on record locked                             
           03 FIO-RLCK-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on record locked                             
           03 FIO-RLCK-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on input file not found                      
           03 FIO-IFNF-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on input file not found                      
           03 FIO-IFNF-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    Status Registro Inexistente                                  
           03 FIO-STAT-NEX                      PIC X(02) VALUE '39'.   
      *>                                                                 
      *>    Comandos para las rutinas FIO"s                              
           03 FIO-VCMN.                                                 
      *>                                                                 
      *>       Read Key                                                  
              05 FIO-GET-KEY           VALUE  1 PIC 9(04).              
      *>                                                                 
      *>       Read Next                                                 
              05 FIO-GET-NXT           VALUE  2 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next                                   
              05 FIO-GET-FST           VALUE  3 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next                                
              05 FIO-GET-NLS           VALUE  4 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next                                 
              05 FIO-GET-GRT           VALUE  5 PIC 9(04).              
      *>                                                                 
      *>       Write                                                     
              05 FIO-PUT               VALUE  6 PIC 9(04).              
      *>                                                                 
      *>       Rewrite                                                   
              05 FIO-MOD               VALUE  7 PIC 9(04).              
      *>                                                                 
      *>       Delete                                                    
              05 FIO-DEL               VALUE  8 PIC 9(04).              
      *>                                                                 
      *>       Change                                                    
              05 FIO-CHG               VALUE  9 PIC 9(04).              
      *>                                                                 
      *>       Open Input                                                
              05 FIO-INP               VALUE 10 PIC 9(04).              
      *>                                                                 
      *>       Open Output                                               
              05 FIO-OUT               VALUE 11 PIC 9(04).              
      *>                                                                 
      *>       Open I-O                                                  
              05 FIO-UPD               VALUE 12 PIC 9(04).              
      *>                                                                 
      *>       Close                                                     
              05 FIO-CLO               VALUE 13 PIC 9(04).              
      *>                                                                 
      *>       Start Equal                                               
              05 FIO-FND-EQL           VALUE 14 PIC 9(04).              
      *>                                                                 
      *>       Start First                                               
              05 FIO-FND-FST           VALUE 15 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less                                            
              05 FIO-FND-NLS           VALUE 16 PIC 9(04).              
      *>                                                                 
      *>       Start Greater                                             
              05 FIO-FND-GRT           VALUE 17 PIC 9(04).              
      *>                                                                 
      *>       Unlock Record                                             
              05 FIO-ULK-REC           VALUE 18 PIC 9(04).              
      *>                                                                 
      *>       Unlock All                                                
              05 FIO-ULK-ALL           VALUE 19 PIC 9(04).              
      *>                                                                 
      *>       Value of ID                                               
              05 FIO-VID               VALUE 20 PIC 9(04).              
      *>                                                                 
      *>       Acceso                                                    
              05 FIO-ACC               VALUE 21 PIC 9(04).              
      *>                                                                 
      *>       Record Locked                                             
              05 FIO-REC-LCK           VALUE 22 PIC 9(04).              
      *>                                                                 
      *>       File Not Found                                            
              05 FIO-FNF               VALUE 23 PIC 9(04).              
      *>                                                                 
      *>       Record Length                                             
              05 FIO-REC-LEN           VALUE 24 PIC 9(04).              
      *>                                                                 
      *>       Open Extend                                               
              05 FIO-EXT               VALUE 25 PIC 9(04).              
      *>                                                                 
      *>       Read Key ( Alternate Key )                                
              05 FIO-GET-KEY-ALT       VALUE 26 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next ( Alternate Key )                 
              05 FIO-GET-FST-ALT       VALUE 27 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next ( Alternate Key )              
              05 FIO-GET-NLS-ALT       VALUE 28 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next ( Alternate Key )               
              05 FIO-GET-GRT-ALT       VALUE 29 PIC 9(04).              
      *>                                                                 
      *>       Start Equal ( Alternate Key )                             
              05 FIO-FND-EQL-ALT       VALUE 30 PIC 9(04).              
      *>                                                                 
      *>       Start First ( Alternate Key )                             
              05 FIO-FND-FST-ALT       VALUE 31 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less ( Alternate Key )                          
              05 FIO-FND-NLS-ALT       VALUE 32 PIC 9(04).              
      *>                                                                 
      *>       Start Greater ( Alternate Key )                           
              05 FIO-FND-GRT-ALT       VALUE 33 PIC 9(04).              
      *>                                                                 
      *>       Get Next con llave Alternativa                            
              05 FIO-GET-NXT-ALT       VALUE 34 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update con llave Alternativa                      
              05 FIO-GET-KEY-UPD-ALT   VALUE 35 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update                                            
              05 FIO-GET-KEY-UPD       VALUE 36 PIC 9(04).              
      *>                                                                 
      *>       End Browse                                                
              05 FIO-END-BRW           VALUE 37 PIC 9(04).              
      *>                                                                 
      *>       Back Out Transaction                                      
              05 FIO-BCK-OUT           VALUE 38 PIC 9(04).              
      *>                                                                 
      *>       Get Less or Equal                                         
              05 FIO-GET-LEQ           VALUE 39 PIC 9(04).              
      *>                                                                 
      *>       Get Previous                                              
              05 FIO-GET-PRV           VALUE 40 PIC 9(04).              
      *>                                                                 
      *>       Check Point                                               
              05 FIO-CHK-PNT           VALUE 41 PIC 9(04).              
      *>                                                                 
      *>       Buffer Refresh                                            
              05 FIO-BFR-RFH           VALUE 42 PIC 9(04).              
      *>                                                                 
      *>       End Browse All                                            
              05 FIO-EBR-ALL           VALUE 43 PIC 9(04).              
      *>                                                                 
      *>       BEGin TRaNsacction                                        
              05 FIO-BEG-TRN           VALUE 44 PIC 9(04).              
      *>                                                                 
           03 FIO-VCMN-RED    REDEFINES FIO-VCMN.                       
              05 FIO-IDX-VCMN OCCURS 44 TIMES   PIC 9(04).              
      *>                                                                 
      *>    Programa que usa servicio de FIO                             
           03 FIO-PROG                          PIC X(08).              
      *>                                                                 
      *>    Programa  FIO                             
           03 FIO-GLS-PROG                      PIC X(08).              
      *>                                                                 
      *>    Valor de Key                                                 
           03 FIO-VKEY                          PIC X(180).             
      *>                                                                 
      *>    Valor de Key para Comparacion con FIO-VKEY   ( VSI )         
           03 FIO-CKEY                          PIC X(180).             
      *>                                                                 
      *>    Key Length                                                   
           03 FIO-KLEN  COMP                    PIC S9(4).              
      *>                                                                 
      *>    Campo Data para FIO                                          
           03 FIO-DFLD                          PIC X(1536).            
      *>                                                                 
      *>    Mensaje                                                      
           03 FIO-MENS              VALUE SPACES.                       
      *>                                                                 
      *>       Mensaje 1                                                 
              05 FIO-MEN1                       PIC X(71).              
      *>                                                                 
      *>       Mensaje 2                                                 
              05 FIO-MEN2                       PIC X(09).              
      *>                                                                 
           03 FIO-MENS-RED REDEFINES FIO-MENS.                          
              05 FIO-MENS-DSC                   PIC X(13).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-STT                   PIC X(02).              
              05 FIO-MENS-NTT REDEFINES FIO-MENS-STT PIC 9(02).         
              05 FIO-MENS-SST                   PIC X(01).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GKY                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-KEY                   PIC X(32).              
              05 FIO-MENS-KEY-RED REDEFINES FIO-MENS-KEY.               
                 07 FIO-MENS-KDT                PIC X(05).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-GBD                PIC X(10).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-DBI                PIC X(05).              
                 07 FILLER                      PIC X(10).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GCM                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-CMD                   PIC X(05).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GFL                   PIC X(04).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-FIL                   PIC X(09).              
              05 FIO-MENS-FIL-RED REDEFINES FIO-MENS-FIL.               
                 07 FIO-MENS-SIS                PIC X(03).              
                 07 FIO-MENS-REG                PIC X(06).              
              05 FILLER                         PIC X(01).              
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IAKY                 VALUE  0 PIC 9(04).              
              88 FIO-IAKY-CON          VALUE 26 THRU 35.                
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IGET                 VALUE  0 PIC 9(04).              
              88 FIO-IGET-YES          VALUE  1 THRU 5, 26 THRU 29,     
                                             34, 35, 36, 39, 40.        
              88 FIO-ICBR-YES          VALUE  2, 34, 40.                
      *>                                                                 
      *>    Indicador de Llaves de Default                               
           03 FIO-KDEF                 VALUE 0 PIC 9(01).               
           03 FIO-KDEF-N               VALUE 0 PIC 9(01).               
           03 FIO-KDEF-S               VALUE 1 PIC 9(01).               
      *>                                                                 
      *>    Indicador de primera VEZ                                     
           03 FIO-IVEZ            VALUE SPACES PIC X(01).               
      *>                                                                 
      *>    Vector de status de archivos                                 
           03 FIO-MSFL VALUE SPACES.                                    
              05 FIO-VSFL OCCURS 20 INDEXED BY FIO-ITBL.                
                 07 FIO-NFIL                   PIC X(07).               
      *>                                                                 
      *>    Indice maximo                                                
           03 FIO-MXFL               VALUE 20  PIC 9(02).               
      *>                                                                 
      *>    Indicador de Start-Browse abierto                            
           03 FIO-ISBR               VALUE 'N' PIC X(01).               
      *>                                                                 
      *>    Indice auxiliar                                              
           03 FIO-IAUX               VALUE 0   PIC 9(02).               
      
       01 FIO-ORACLE.
           03 FIO-ORACLE-VARI                  PIC X(0080).
           03 FIO-ORACLE-DFLD                  PIC X(1536).
           03 FIO-ORACLE-RQA                   PIC X(0630).
           03 FIO-ORACLE-MENS                  PIC X(0080).
           03 FIO-ORACLE-PROG.
              05 FIO-ORACLE-PROG-TAB           PIC X(0003).
              05 FIO-ORACLE-PROG-NUM           PIC 9(0003).
           03 FIO-ORACLE-FILL                  PIC X(0668).
      
       01 RECV-STRING-FIO                      PIC X(3000).
       
       01 SEND-STRING-FIO                      PIC X(3000).
                                                                        
      *>    Variables para las rutinas FIO"s                             
      *>    ( Linkage Section para VSAM BATCH )                          
       01  FIO-VARI.                                                    
      *>                                                                 
      *>    Nombre de la llave alternativa                               
           03 FIO-AKEY       VALUE SPACES               PIC X(32).      
      *>                                                                 
      *>    Esta variable FILE STATUS es el codigo de retorno            
      *>    de las subrutinas FIO                                        
           03 FIO-STAT.                                                 
      *>                                                                 
      *>          Created Duplicate Key                                  
                 88 FIO-STAT-CDK        VALUE '02'.                     
      *>                                                                 
      *>          End Of File                                            
                 88 FIO-STAT-EOF        VALUE '10'.                     
      *>                                                                 
      *>          No Ascending Key                                       
                 88 FIO-STAT-NAK        VALUE '21'.                     
      *>                                                                 
      *>          Invalid KeY                                            
                 88 FIO-STAT-IKY        VALUE '22' '23'.                
      *>                                                                 
      *>          Duplicate Alternate Key                                
                 88 FIO-STAT-DAK        VALUE '22'.                     
      *>                                                                 
      *>          Record Not Found                                       
                 88 FIO-STAT-RNF        VALUE '23'.                     
      *>                                                                 
      *>          Boundary Violation Error                               
                 88 FIO-STAT-BVE        VALUE '24' '34'.                
      *>                                                                 
      *>          Other Permanent Errors                                 
                 88 FIO-STAT-OPE        VALUE '30'.                     
      *>                                                                 
      *>          Other Device Errors                                    
                 88 FIO-STAT-ODE        VALUE '90'.                     
      *>                                                                 
      *>          PassWord Failure                                       
                 88 FIO-STAT-PWF        VALUE '91'.                     
      *>                                                                 
      *>          LoGic Error                                            
                 88 FIO-STAT-LGE        VALUE '92'.                     
      *>                                                                 
      *>          Resource Not Available                                 
                 88 FIO-STAT-RNA        VALUE '93'.                     
      *>                                                                 
      *>          No Previous Read                                       
                 88 FIO-STAT-NPR        VALUE '94'.                     
      *>                                                                 
      *>          Invalid or incomplete File Information                 
                 88 FIO-STAT-IFI        VALUE '95'.                     
      *>                                                                 
      *>          Bad File Identification                                
                 88 FIO-STAT-BFI        VALUE '96'.                     
      *>                                                                 
      *>          File Intergrity Verified                               
                 88 FIO-STAT-FIV        VALUE '97'.                     
      *>JSS                                                              
      *>             Fatal                                               
                    88 FIO-STAT-FTL        VALUE '99'.                  
      *>JSS                                                              
      *>             Duplicate Master Key                                
                    88 FIO-STAT-DMK        VALUE '22'.                  
      *>JSS                                                              
      *>             Invalid Master Key                                  
                    88 FIO-STAT-IMK        VALUE '23'.                  
      *>JSS                                                              
      *>             Special Deleted Record                              
                    88 FIO-STAT-SDR        VALUE '43'.                  
      *>JSS                                                              
      *>             Exclusive Control Duplicate                         
                    88 FIO-STAT-ECD        VALUE '44'.                  
      *>JSS                                                              
      *>             Set Selection Interrupt                             
                    88 FIO-STAT-SSI        VALUE '45'.                  
      *>JSS                                                              
      *>             Attempt to Position PAST END/BEG-OF-SET             
                    88 FIO-STAT-APS        VALUE '46'.                  
      *>JSS                                                              
      *>             Exclusive Control Interlock                         
                    88 FIO-STAT-ECI        VALUE '47'.                  
      *>                                                                 
                 05 FIO-STT1                    PIC 9(01).              
      *>                                                                 
      *>               OK Status                                         
                      88 FIO-STAT-OKS   VALUE 0.                        
      *>                                                                 
      *>               At End Status                                     
                      88 FIO-STAT-AES   VALUE 1.                        
      *>                                                                 
      *>               Invalid Key Status                                
                      88 FIO-STAT-IKS   VALUE 2.                        
      *>                                                                 
      *>               ERRors                                            
                      88 FIO-STAT-ERR   VALUE 3.                        
      *>JSS                                                              
      *>               DATACOM Errors                                    
                      88 FIO-STAT-DTC   VALUE 4.                        
      *>                                                                 
      *>               Device Dependant Errors                           
                      88 FIO-STAT-DDE   VALUE 9.                        
      *>                                                                 
                 05 FIO-STT2                    PIC 9(01).              
      *>                                                                 
      *>               No Further Information                            
                      88 FIO-STAT-NFI   VALUE 0.                        
      *>                                                                 
      *>               SEQuential access                                 
                      88 FIO-STAT-SEQ   VALUE 1.                        
      *>                                                                 
      *>               DUPlicates                                        
                      88 FIO-STAT-DUP   VALUE 2.                        
      *>                                                                 
      *>               No Current Record                                 
                      88 FIO-STAT-NCR   VALUE 3.                        
      *>                                                                 
      *>    Esta variable RELATIVE KEY indica a las subrutinas FIO       
      *>    la llave de un archivo relativo para su acceso.              
           03 FIO-RKEY          COMP            PIC 9(09).              
      *>                                                                 
      *>    Comando de las Subrutinas FIO                                
           03 FIO-CMND                 VALUE  0 PIC 9(04).              
      *>                                                                 
      *>    Esta variable  ACCESS indica a las subrutinas                
      *>    FIO la forma de abrir un archivo en cuanto al                
      *>    acceso desde otros programas                                 
           03 FIO-ACCS                      PIC 9(01).                  
      *>                                                                 
      *>       0 = DEFault access                                        
      *>       1 = NOT     access                                        
      *>       2 = INPut   access                                        
      *>       3 = UPDate  access                                        
      *>                                                                 
      *>    Esta variable RECORD LOCKED indica a las subrutinas          
      *>    FIO si tomar o no el control cuando hay un registro          
      *>    ocupado                                                      
           03 FIO-RLCK                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on record locked ( Default )          
      *>       1 = ProGraM control on record locked                      
      *>                                                                 
      *>    Esta variable INPUT FILE NOT FOUND indica a las              
      *>    subrutinas  FIO si tomar o no el control cuando              
      *>    al abrir un archivo de Input, este no existe                 
           03 FIO-IFNF                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on file not found                     
      *>       1 = ProGraM control on file not found                     
      *>                                                                 
      *>    Esta  variable  RECORD LENGTH  debe ser  llenada  con el     
      *>    largo  del  registro, para  registros de largo variable,     
      *>    antes de llamar a las subrutinas FIO con comando REC_LEN     
           03 FIO-RLEN     COMP                 PIC S9(04).             
      *>                                                                 
      *>    Value Of ID                                                  
           03 FIO-VOID.                                                 
      *>                                                                 
      *>       Sistema                                                   
              05 FIO-SIST                       PIC X(03).              
      *>                                                                 
      *>       Tipo                                                      
              05 FIO-FTYP                       PIC X(01).              
      *>                                                                 
      *>       Nombre                                                    
              05 FIO-FNAM                       PIC X(04).              
                                                                        
      *>       RESPALDO FIO-SIST                                         
           03 FIO-SIST-BKP                      PIC X(03).              
                                                                        
      *>                                                                 
      *>    Filler                                                       
           03 FILLER                            PIC X(15).              
                                                                        
      *>    Variables para Rutinas del Sistema. GNSWGSYS V-3.1
       01  SYS-VARI.
      *>    Variables para Current-Date
           03 SYS-FHOY-2B.
              05 SYS-AHOY-2B                   PIC 9(02).
              05 SYS-MHOY-2B                   PIC 9(02).
              05 SYS-DHOY-2B                   PIC 9(02).
           03 SYS-SHOY                         PIC 9(02).
           03 SYS-FHOY.
              05 SYS-DHOY                      PIC 9(02).
              05 SYS-SLH1                      PIC X(01).
              05 SYS-MHOY                      PIC 9(02).
              05 SYS-SLH2                      PIC X(01).
              05 SYS-AHOY                      PIC 9(02).
           03 SYS-HHOY-2B  VALUE ZEROES        PIC 9(08).
           03 SYS-HHOY-2B-RED REDEFINES SYS-HHOY-2B.
              05 SYS-HHHY-2B                   PIC 9(02).
              05 SYS-MMHY-2B                   PIC 9(02).
              05 SYS-SSHY-2B                   PIC 9(02).
              05 SYS-CCHY-2B                   PIC 9(02).
           03 SYS-HHOY  VALUE ZEROES           PIC 9(06).
           03 SYS-HHOY-RED REDEFINES SYS-HHOY.
              05 SYS-HHHY                      PIC 9(02).
              05 SYS-MMHY                      PIC 9(02).
              05 SYS-SSHY                      PIC 9(02).
           03 SYS-JHOY                         PIC 9(05).
           03 SYS-JHOY-RED REDEFINES SYS-JHOY.
              05 SYS-AAHY                      PIC 9(02).
              05 SYS-DDHY                      PIC 9(03).
           03 SYS-TSTP.
              05 SYS-SSTP                      PIC 9(02).
              05 SYS-FSTP.
                 07 SYS-AATS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-DDTS                   PIC 9(02).
              05 SYS-HSTP                      PIC 9(06).
              05 SYS-HSTP-RED REDEFINES SYS-HSTP.
                 07 SYS-HHTS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-SSTS                   PIC 9(02).
      *>    Tamano de Communication Area
           03 SYS-TCMA  COMP                   PIC S9(4).
      *>    Communication Area
           03 SYS-CMMA.
              05 SYS-SCR-MENS                  PIC X(79).
              05 SYS-SCR-VARI                  PIC X(3421).
      *>INI-PENTA TUXEDO ORACLE
              05 SYS-SCR-NTRN                  PIC X(04).
      *>FIN-PENTA TUXEDO ORACLE
      *>    Transaccion
           03 SYS-NTRN                         PIC X(04).
      *>    Programa
           03 SYS-PROG                         PIC X(08).
           03 SYS-PROG-RED REDEFINES SYS-PROG
                                      OCCURS 8 PIC X(01).
      *>    Programa a ABorTo
           03 SYS-PABT  VALUE 'GNSPPABT'       PIC X(08).
      *>    Comando
           03 SYS-CMND                 VALUE 0 PIC 9(02).
      *>    Mensaje
           03 SYS-MENS.
              05 SYS-MEN1                      PIC X(40).
              05 SYS-MEN2                      PIC X(40).
      *>    Resto
           03 SYS-REST                         PIC 9(01).
      *>    Indice
           03 SYS-SIND                         PIC 9(02).
      *>    Status
           03 SYS-STAT                         PIC X(02).
           03 SYS-STAT-OKS        VALUE '00'   PIC X(02).
           03 SYS-STAT-NUM                     PIC 9(02).
      *>    Indicador de Handler
           03 SYS-IHDL            VALUE SPACES PIC X(01).
      *> MHM-INI 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *>    Indicador de Abend
           03 SYS-ABND            VALUE ' '    PIC X(01).
              88 SYS-ABND-YES     VALUE 'S'.
      
      *> MHM-FIN 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *> IMV-INI 01-JUL-2014 MARCA SIMULACION FUTURA
           03 SYS-SMFT            VALUE 'N'    PIC X(01).
      *> IMV-FIN 01-JUL-2014 MARCA SIMULACION FUTURA
      
      *>INI-PENTA TUXEDO ORACLE
      
      *>    FLAG SERVICIO DE FECHA
           03 SYS-HORA-HABI      VALUE 'N'     PIC X(01).
           03 SYS-HORA-FLAG      VALUE 'N'     PIC X(01).
      
      
       01 EIBTRMID       VALUE SPACES          PIC X(04).
       01 EIBTRNID       VALUE SPACES          PIC X(04).
       01 EIBTASKN       VALUE SPACES          PIC X(04).
       01 EIBCALEN       VALUE 1               PIC 9(04).
       01 EIBAID         VALUE ''''            PIC X(01).
       01 EIBRESP        VALUE 0               PIC S9(04).
      
       01 EIBTASKN-1.
          03 EIBTASKN-11 VALUE SPACES          PIC X(04).
          03 EIBTASKN-12 VALUE SPACES          PIC X(04).
      *> Variables genericas para servicio de fecha y hora
       01  FYH-VARI.
           03  FYH-PROG            VALUE 'GNSPPFYH' PIC X(08).
           03  FYH-TCMA            VALUE 22         PIC 9(08).
           03  FYH-CMSG            VALUE SPACES     PIC X(12).
           03  FYH-MENS.
               05 FYH-MEN2         VALUE SPACES     PIC X(40).
      *>    MENSAJE
           03  FYH-CMMA.
               05 FYH-GLS-RSPT.
      *>           FECHA
                  07 FYH-FEC-FHOY.
                     09 FYH-NUM-SHOY                PIC 9(02).
                     09 FYH-NUM-AHOY                PIC 9(02).
                     09 FYH-NUM-MHOY                PIC 9(02).
                     09 FYH-NUM-DHOY                PIC 9(02).
      *>           HORA
                  07 FYH-HRA-HHOY.
                     09 FYH-NUM-HHHY                PIC 9(02).
                     09 FYH-NUM-MMHY                PIC 9(02).
                     09 FYH-NUM-SSHY                PIC 9(02).
      *>           JULIANO
                  07 FYH-NUM-JULI                   PIC 9(08).
      
      *>FIN-PENTA TUXEDO ORACLE
      *>
      *>    Constantes para Rutinas del Sistema.
       01  SYS-CTTS.
      *>    Comandos
           03 SYS-GET-DATE             VALUE 1 PIC 9(01).
           03 SYS-GET-TIME             VALUE 2 PIC 9(01).
           03 SYS-RTRN                 VALUE 3 PIC 9(01).
           03 SYS-XCTL                 VALUE 4 PIC 9(01).
           03 SYS-LINK                 VALUE 5 PIC 9(01).
           03 SYS-ABOR                 VALUE 6 PIC 9(01).
      *>    Cantidad de Dias Acumulados en cada Mes
           03 SYS-VACU VALUE '000031060091121152182213244274305335'.
              05 SYS-DACU       OCCURS 12      PIC 9(03).
                                                                        
                                                                        
        77  WSS-SWI-CRGA    VALUE 'C'                 PIC X(01).
      *> 01  PGM-STAT.                                                   
      *>     03 PGM-STAT-SRT        VALUE " " PIC X(01).                 
      *>        88 PGM-STAT-SRT-OKS VALUE " ".                           
      *>        88 PGM-STAT-SRT-MAL VALUE "M".                           
      *>     03 PGM-SOKS            VALUE " " PIC X(01).                 
      *>     03 PGM-SMAL            VALUE "M" PIC X(01).                 
                                                                        
       01  BUF-ACP.                                                     
           03 BUF-ACP1                                PIC X(06).
           03 BUF-ACP2                                PIC X(03).
           03 BUF-ACP3                                PIC X(51).
                                                                        
       01  WSS-MNU.                                                     
           03 WSS-MNU1                                PIC X(60).
           03 WSS-MNU2                                PIC X(60).
           03 WSS-MNU3                                PIC X(60).
           03 WSS-MNU4                                PIC X(60).
           03 WSS-MNU5                                PIC X(60).
           03 WSS-MNU6                                PIC X(60).
           03 WSS-MNU7                                PIC X(60).
           03 WSS-MNU8                                PIC X(60).
           03 WSS-MNU9                                PIC X(60).
                                                                        
       01  WSS-TOT.                                                     
           03 WSS-MNU-ERP              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-ERP-EDT                         PIC ZZZZ9.
           03 WSS-MNU-ERM              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-ERM-EDT                         PIC ZZZZ9.
           03 WSS-MNU-ERE              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-ERE-EDT                         PIC ZZZZ9.
           03 WSS-MNU-PUT              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-PUT-EDT                         PIC ZZZZ9.
           03 WSS-MNU-MOD              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-MOD-EDT                         PIC ZZZZ9.
           03 WSS-MNU-ELI              VALUE ZEROES   PIC 9(05).
           03 WSS-MNU-ELI-EDT                         PIC ZZZZ9.
                                                                        
           03 WSS-RPF-ERP              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-ERP-EDT                         PIC ZZZZ9.
           03 WSS-RPF-ERM              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-ERM-EDT                         PIC ZZZZ9.
           03 WSS-RPF-ERE              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-ERE-EDT                         PIC ZZZZ9.
           03 WSS-RPF-PUT              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-PUT-EDT                         PIC ZZZZ9.
           03 WSS-RPF-MOD              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-MOD-EDT                         PIC ZZZZ9.
           03 WSS-RPF-ELI              VALUE ZEROES   PIC 9(05).
           03 WSS-RPF-ELI-EDT                         PIC ZZZZ9.
                                                                        
           03 WSS-TAB-ERP              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-ERP-EDT                         PIC ZZZZ9.
           03 WSS-TAB-ERM              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-ERM-EDT                         PIC ZZZZ9.
           03 WSS-TAB-ERE              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-ERE-EDT                         PIC ZZZZ9.
           03 WSS-TAB-PUT              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-PUT-EDT                         PIC ZZZZ9.
           03 WSS-TAB-MOD              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-MOD-EDT                         PIC ZZZZ9.
           03 WSS-TAB-ELI              VALUE ZEROES   PIC 9(05).
           03 WSS-TAB-ELI-EDT                         PIC ZZZZ9.
                                                                        
       01  WSS-RPF.                                                     
           03 WSS-RPF1                                PIC X(60).
           03 WSS-RPF2                                PIC X(60).
                                                                        
       01  WSS-TAB.                                                     
           03 WSS-TAB1                                PIC X(60).
           03 WSS-TAB2                                PIC X(60).
           03 WSS-TAB3                                PIC X(60).
           03 WSS-TAB4                                PIC X(60).
                                                                        
       01  WSS-MEN1.
           03 FILLER                   PIC X(70) VALUE ALL '-'.
      
       01  WSS-MEN2.
           03 FILLER                   PIC X(10) VALUE '| CMT : | '.
           03 MEN2-AREA                PIC X(59) VALUE SPACES.
           03 FILLER                   PIC X(01) VALUE '|'.
      
       01  WSS-VARI.                                                    
           03 WSS-I                    VALUE ZEROES   PIC 9(06).
           03 WSS-SIST                 VALUE '   '    PIC X(03).
           03 WSS-SOLO-TAB             VALUE 'N'      PIC X(01).
           03 WSS-MNU-OPEN             VALUE 'N'      PIC X(01).
           03 WSS-RPF-OPEN             VALUE 'N'      PIC X(01).
                                                                        
       PROCEDURE DIVISION.                                              
      *>==================                                               
       MAIN SECTION.                                                    
       INI-MAIN.                                                        
      *>     ENTRY "DBMSCBL".                                            
                                                                        
                                                                        
      
           PERFORM DO-TPINIT. 
           
           PERFORM GNS-PUT-TSK.
           
      
           DISPLAY 'INICIO GNSPPCPM VERSION : '.
           DISPLAY WSS-TAG-GNSPPCPM.
           MOVE SPACES TO IDD-CIDD.                                     
           MOVE 'GNSPPCPM' TO FIO-PROG.                                 
           PERFORM GNS-BUS-IDD.                                         
           DISPLAY ' '.
           DISPLAY WSS-MEN1.
                                                                        
           PERFORM PRO-INP.                                             
      
           PERFORM DSP-STD.                                             
      
           PERFORM GNS-GET-TSK.
      
           PERFORM DO-TPTERM. 
      
           PERFORM GNS-PRO-END.                                         
       FIN-MAIN.                                                        
           EXIT.                                                        
                                                                        
       PRO-INP SECTION.                                                 
       INI-PRO-INP.                                                     
           MOVE SPACES TO BUF-ACP.                                      
           ACCEPT  BUF-ACP.                                             
           IF BUF-ACP1 = 'REGMNU'                                       
              PERFORM PRO-ACT-MNU                                       
           ELSE                                                         
           IF BUF-ACP1 = 'REGRPF'                                       
              PERFORM PRO-ACT-RPF                                       
           ELSE                                                         
           IF BUF-ACP1 = 'REGTAB'                                       
              PERFORM PRO-ACT-TAB                                       
           ELSE                                                         
           IF BUF-ACP  = '      *    OPC = D'
              MOVE 'D' TO WSS-SWI-CRGA
              DISPLAY 'PROGRAMA DESCARGARA PARAMETROS'
           ELSE
           IF BUF-ACP  = '      *SOLOTAB'
              MOVE 'S' TO WSS-SOLO-TAB
              DISPLAY '---------------------------------'
              DISPLAY '|PROGRAMA DESCARGARA SOLO TABLAS|'
              DISPLAY '---------------------------------'
           ELSE
           IF BUF-ACP1 NOT = 'FINPI1'                                   
              MOVE BUF-ACP     TO MEN2-AREA
              DISPLAY WSS-MEN2
           ELSE                                                         
              GO TO FIN-PRO-INP.                                        
           GO TO INI-PRO-INP.                                           
       FIN-PRO-INP.                                                     
           EXIT.                                                        
                                                                        
       PRO-ACT-MNU SECTION.                                             
       INI-PRO-ACT-MNU.                                                 
      
           IF BUF-ACP2 NOT > SPACES                                     
              DISPLAY 'NO SE INDICA SISTEMA DE MNU : ' BUF-ACP          
              GO TO FIN-PRO-ACT-MNU.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU1.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU2.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU3.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU4.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU5.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU6.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU7.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU8.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-MNU9.                                    
                                                                        
           MOVE WSS-MNU         TO MNU.                                 
           MOVE FIO-GET-KEY     TO FIO-CMND.                            
           MOVE WSS-SIST        TO FIO-SIST.                            
           PERFORM GNS-FIO-MNU.  
           DISPLAY 'MNU 1:' FIO-STAT MNU.
           DISPLAY 'MNU 2:' FIO-STAT WSS-MNU.
           IF FIO-STAT-OKS                                              
              MOVE WSS-MNU TO MNU                                       
              IF WSS-SWI-CRGA = 'C'
                 MOVE FIO-MOD TO FIO-CMND
              ELSE
                 MOVE FIO-DEL TO FIO-CMND
              END-IF
           ELSE                                                         
              IF WSS-SWI-CRGA = 'C'
                 MOVE WSS-MNU TO MNU
                 MOVE FIO-PUT TO FIO-CMND
              ELSE
                 GO TO FIN-PRO-ACT-MNU.                                 
              
                                                                        
           MOVE WSS-SIST        TO FIO-SIST.                            
           IF   WSS-SOLO-TAB = 'S'
                MOVE '00'     TO FIO-STAT
           DISPLAY 'MNU 3:' FIO-STAT MNU
           ELSE
           DISPLAY 'MNU 4:' FIO-STAT MNU
           PERFORM GNS-FIO-MNU.                                         
           DISPLAY 'MNU 5:' FIO-STAT MNU
           IF NOT FIO-STAT-OKS                                          
               IF FIO-CMND = FIO-PUT                                    
                  ADD 1 TO WSS-MNU-ERP
                  DISPLAY 'ERROR AL GRABAR MNU '
                  DISPLAY 'FIO-STAT MNU-COD-NEMO : ' FIO-STAT ' '
                           MNU-COD-NEMO IN MNU
               ELSE
               IF FIO-CMND = FIO-DEL
                  ADD 1 TO WSS-MNU-ERE
                  DISPLAY 'ERROR AL ELIMINAR  MNU '
                  DISPLAY 'FIO-STAT MNU-COD-NEMO : ' FIO-STAT ' '
                           MNU-COD-NEMO IN MNU
               ELSE                                                     
                  ADD 1 TO WSS-MNU-ERM
                  DISPLAY 'ERROR AL MODIFICAR MNU '
                  DISPLAY 'FIO-STAT MNU-COD-NEMO : ' FIO-STAT ' '
                           MNU-COD-NEMO IN MNU
           ELSE                                                         
              IF FIO-CMND = FIO-PUT                                     
                 DISPLAY MNU-COD-NEMO '           : MNU INGRESADO'
                 ADD 1 TO WSS-MNU-PUT
              ELSE                                                      
              IF FIO-CMND = FIO-DEL
                 DISPLAY MNU-COD-NEMO '           : MNU ELIMINADO'
                 ADD 1 TO WSS-MNU-ELI
              ELSE
                 DISPLAY MNU-COD-NEMO '           : MNU MODIFICADO'
                 ADD 1 TO WSS-MNU-MOD.
       FIN-PRO-ACT-MNU.                                                 
           EXIT.                                                        
                                                                        
       PRO-ACT-RPF SECTION.                                             
       INI-PRO-ACT-RPF.                                                 
           IF BUF-ACP2 NOT > SPACES                                     
              DISPLAY 'NO SE INDICA SISTEMA DE RPF : ' BUF-ACP          
              GO TO FIN-PRO-ACT-RPF.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-RPF1.                                    
                                                                        
           MOVE SPACES  TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP TO WSS-RPF2.                                    
                                                                        
           MOVE WSS-RPF         TO RPF.                                 
           MOVE FIO-GET-KEY     TO FIO-CMND.                            
           MOVE WSS-SIST        TO FIO-SIST.                            
           PERFORM GNS-FIO-RPF.                                         
           DISPLAY 'RPF :' RPF.
           DISPLAY 'RPF :' WSS-RPF.
           IF FIO-STAT-OKS                                              
              MOVE WSS-RPF TO RPF                                       
              IF WSS-SWI-CRGA = 'C'
                 MOVE FIO-MOD TO FIO-CMND
              ELSE
                 MOVE FIO-DEL TO FIO-CMND
              END-IF
           ELSE                                                         
              IF WSS-SWI-CRGA = 'C'
                 MOVE WSS-RPF TO RPF
                 MOVE FIO-PUT TO FIO-CMND
              ELSE
                 GO TO FIN-PRO-ACT-RPF.                                 
                 
                                                                        
           MOVE WSS-SIST      TO FIO-SIST.
           IF   WSS-SOLO-TAB = 'S'
                MOVE '00'     TO FIO-STAT
           ELSE
           PERFORM GNS-FIO-RPF.                                         
           IF NOT FIO-STAT-OKS                                          
              IF FIO-CMND = FIO-PUT                                     
                 ADD 1 TO WSS-RPF-ERP
                 DISPLAY 'ERROR AL GRABAR RPF '
                 DISPLAY 'FIO-STAT RPF-COD-DPTR : ' FIO-STAT ' '
                          RPF-COD-DPTR IN RPF
              ELSE
              IF FIO-CMND = FIO-DEL
                 ADD 1 TO WSS-RPF-ERE
                 DISPLAY 'ERROR AL ELIMINAR RPF '
                 DISPLAY 'FIO-STAT RPF-COD-DPTR : ' FIO-STAT ' '
                          RPF-COD-DPTR IN RPF
              ELSE                                                      
                  ADD 1 TO WSS-RPF-ERM                                  
                  DISPLAY 'ERROR AL MODIFICAR RPF '                     
                  DISPLAY 'FIO-STAT RPF-COD-DPTR : ' FIO-STAT ' '       
                                               RPF-COD-DPTR IN RPF      
           ELSE                                                         
              IF FIO-CMND = FIO-PUT                                     
                 DISPLAY RPF-COD-DPTR ' : RPF INGRESADO'
                 ADD 1 TO WSS-RPF-PUT
              ELSE                                                      
              IF FIO-CMND = FIO-DEL
                 DISPLAY RPF-COD-DPTR ' : RPF ELIMINADO'
                 ADD 1 TO WSS-RPF-ELI
              ELSE
                 DISPLAY RPF-COD-DPTR ' : RPF MODIFICADO'
                 ADD 1 TO WSS-RPF-MOD.
       FIN-PRO-ACT-RPF.                                                 
           EXIT.                                                        
                                                                        
       PRO-ACT-TAB SECTION.                                             
       INI-PRO-ACT-TAB.                                                 
           IF BUF-ACP2 NOT > SPACES                                     
              DISPLAY 'NO SE INDICA SISTEMA DE TAB : ' BUF-ACP          
              GO TO FIN-PRO-ACT-TAB.                                    
                                                                        
           MOVE BUF-ACP2 TO FIO-SIST WSS-SIST.                          
           MOVE SPACES   TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP  TO WSS-TAB1.
                                                                        
           MOVE SPACES   TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP  TO WSS-TAB2.
                                                                        
           MOVE SPACES   TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP  TO WSS-TAB3.
                                                                        
           MOVE SPACES   TO BUF-ACP.
           ACCEPT BUF-ACP.                                              
           MOVE BUF-ACP  TO WSS-TAB4.
                                                                        
           MOVE WSS-TAB         TO TAB.                                 
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           MOVE WSS-SIST        TO FIO-SIST.                            
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
              MOVE WSS-TAB TO TAB                                       
              IF WSS-SWI-CRGA = 'C'
                 DISPLAY 'MODIFICA  TAB'
                 MOVE FIO-MOD TO FIO-CMND
              ELSE
                 DISPLAY 'ELIMINARA TAB'
                 MOVE FIO-DEL TO FIO-CMND
              END-IF
           ELSE                                                         
              IF WSS-SWI-CRGA = 'C'
                 MOVE WSS-TAB TO TAB
                 MOVE FIO-PUT TO FIO-CMND
              ELSE
                 GO TO FIN-PRO-ACT-TAB.                                 
                                                                        
           MOVE WSS-SIST      TO FIO-SIST.
           PERFORM GNS-FIO-TAB.                                         
                                                                        
           IF NOT FIO-STAT-OKS                                          
              IF FIO-CMND = FIO-PUT                                     
                 ADD 1 TO WSS-TAB-ERP
                 DISPLAY 'ERROR AL GRABAR TAB '
                 DISPLAY 'FIO-STAT TAB          : ' FIO-STAT ' '
                          TAB-COD-CTAB IN TAB
              ELSE
              IF FIO-CMND = FIO-DEL
                 ADD 1 TO WSS-TAB-ERE
                 DISPLAY 'ERROR AL ELIMINAR   '
                 DISPLAY 'FIO-STAT TAB-COD-CTAB : ' FIO-STAT ' '
                          TAB-COD-CTAB IN TAB
              ELSE                                                      
                 IF  WSS-SWI-CRGA = 'D'
                     ADD 1 TO WSS-TAB-ERE
                     DISPLAY 'ERROR AL ELIMINAR TAB '
                     DISPLAY 'FIO-STAT TAB-COD-CTAB : ' FIO-STAT ' '
                              TAB-COD-CTAB IN TAB
                 ELSE
                     ADD 1 TO WSS-TAB-ERM
                     DISPLAY 'ERROR AL MODIFICAR TAB '
                     DISPLAY 'FIO-STAT TAB-COD-CTAB : ' FIO-STAT ' '
                              TAB-COD-CTAB IN TAB
           ELSE                                                         
              IF FIO-CMND = FIO-PUT                                     
                 DISPLAY TAB-COD-CTAB '           : TAB INGRESADO'
                 ADD 1 TO WSS-TAB-PUT
              ELSE                                                      
              IF FIO-CMND = FIO-DEL
                 DISPLAY TAB-COD-CTAB '           : TAB ELIMINADO'
                 ADD 1 TO WSS-TAB-ELI
              ELSE
                 DISPLAY TAB-COD-CTAB '           : TAB MODIFICADO'
                 ADD 1 TO WSS-TAB-MOD.
       FIN-PRO-ACT-TAB.                                                 
           EXIT.                                                        
                                                                        
       DSP-STD SECTION.                                                 
       INI-DSP-STD.                                                     
           MOVE FIO-CLO  TO FIO-CMND.                                   
           MOVE 'GNS' TO FIO-SIST.                                      
           PERFORM GNS-FIO-MNU.                                         
                                                                        
           MOVE FIO-CLO  TO FIO-CMND.                                   
           MOVE 'GNS' TO FIO-SIST.                                      
           PERFORM GNS-FIO-RPF.                                         
                                                                        
           MOVE WSS-MNU-ERP TO WSS-MNU-ERP-EDT.                         
           MOVE WSS-MNU-ERM TO WSS-MNU-ERM-EDT.                         
           MOVE WSS-MNU-ERE TO WSS-MNU-ERE-EDT.
           MOVE WSS-MNU-PUT TO WSS-MNU-PUT-EDT.                         
           MOVE WSS-MNU-MOD TO WSS-MNU-MOD-EDT.                         
           MOVE WSS-MNU-ELI TO WSS-MNU-ELI-EDT.
           DISPLAY '===== ESTADISTICAS MNU ====='.                      
           DISPLAY 'PUT OK      MOD OK      ELI OK      PUT ERR'
                   '      MOD ERR      ELI ERR'.
           DISPLAY '======      ======      ======      ======='
                   '      =======      ======='.
           DISPLAY ' ' WSS-MNU-PUT-EDT '       ' WSS-MNU-MOD-EDT        
                   '       ' WSS-MNU-ELI-EDT '        '
                   WSS-MNU-ERP-EDT '        ' WSS-MNU-ERM-EDT
                   '        ' WSS-MNU-ERE-EDT.
           DISPLAY ' '.                                                 
                                                                        
           MOVE WSS-RPF-ERP TO WSS-RPF-ERP-EDT.                         
           MOVE WSS-RPF-ERM TO WSS-RPF-ERM-EDT.                         
           MOVE WSS-RPF-ERE TO WSS-RPF-ERE-EDT.
           MOVE WSS-RPF-PUT TO WSS-RPF-PUT-EDT.                         
           MOVE WSS-RPF-MOD TO WSS-RPF-MOD-EDT.                         
           MOVE WSS-RPF-ELI TO WSS-RPF-ELI-EDT.
           DISPLAY '===== ESTADISTICAS RPF ====='.                      
           DISPLAY 'PUT OK      MOD OK      ELI OK      PUT ERR'
                   '      MOD ERR      ELI ERR'.
           DISPLAY '======      ======      ======      ======='
                   '      =======      ======='.
           DISPLAY ' ' WSS-RPF-PUT-EDT '       ' WSS-RPF-MOD-EDT        
                   '       ' WSS-RPF-ELI-EDT '        '
                   WSS-RPF-ERP-EDT '        ' WSS-RPF-ERM-EDT
                   '        ' WSS-RPF-ERE-EDT.
           DISPLAY ' '.                                                 
                                                                        
           MOVE WSS-TAB-ERP TO WSS-TAB-ERP-EDT.                         
           MOVE WSS-TAB-ERM TO WSS-TAB-ERM-EDT.                         
           MOVE WSS-TAB-ERE TO WSS-TAB-ERE-EDT.
           MOVE WSS-TAB-PUT TO WSS-TAB-PUT-EDT.                         
           MOVE WSS-TAB-MOD TO WSS-TAB-MOD-EDT.                         
           MOVE WSS-TAB-ELI TO WSS-TAB-ELI-EDT.
           DISPLAY '===== ESTADISTICAS TAB ====='.                      
           DISPLAY 'PUT OK      MOD OK      ELI OK      PUT ERR'
                   '      MOD ERR      ELI ERR'.
           DISPLAY '======      ======      ======      ======='
                   '      =======      ======='.
           DISPLAY ' ' WSS-TAB-PUT-EDT '       ' WSS-TAB-MOD-EDT        
                   '       ' WSS-TAB-ELI-EDT '        '
                   WSS-TAB-ERP-EDT '        ' WSS-TAB-ERM-EDT
                   '        ' WSS-TAB-ERE-EDT.
           DISPLAY ' '.                                                 
       FIN-DSP-STD.                                                     
           EXIT.                                                        
                                                                        
      *> Modulo FIO para registro MNU en DATACOM
       GNS-FIO-MNU SECTION.
       INI-GNS-FIO-MNU.
      
      
           MOVE ADR-MNU-REQA       TO ADR-REQA.
           MOVE 'MNU'              TO ADR-TABL IN ADR-REQA.
      *>
           MOVE FIO-SIST TO IDD-SAUX.
           MOVE 'C'      TO IDD-GAUX.
           MOVE SPACES   TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               GO TO FSR-GNS-FIO-MNU.
       GRP-GNS-FIO-MNU.
           MOVE SPACES TO IDD-GAUX.
           MOVE 1      TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
               AT END
                   MOVE 'En GNS-FIO-MNU, NO existe en IDD:' TO FIO-MEN1
                   MOVE IDD-DAUX                            TO FIO-MEN2
                   DISPLAY 'ABORTO NO ENCONTRO IDD'
                   PERFORM PRG-ABT
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
                   NEXT SENTENCE.
       FSR-GNS-FIO-MNU.
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'MNU-COD-NEMO' TO FIO-AKEY.
      
           MOVE 'MNU00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'MNU-COD-NEMO' OR FIO-AKEY NOT > SPACES )
               MOVE MNU-COD-NEMO IN MNU TO ADR-VKEY IN ADR-REQA
               MOVE 'MNU00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MNU-COD-OPCI'
               MOVE MNU-COD-OPCI IN MNU TO ADR-VKEY IN ADR-REQA
               MOVE 'MNU01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MNU-COD-IMEN'
               MOVE MNU-COD-IMES IN MNU TO ADR-VKEY IN ADR-REQA
               MOVE 'MNU02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MNU-COD-SYST'
               MOVE MNU-COD-IMES IN MNU TO ADR-VKEY IN ADR-REQA
               MOVE 'MNU03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En GNS-FIO-MNU, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
      
           MOVE MNU TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO MNU
           ELSE
               MOVE FIO-SIST TO FIO-MENS-SIS
               MOVE 'MNU'    TO FIO-MENS-REG
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
      
           MOVE SPACES   TO FIO-AKEY.
           MOVE ADR-REQA TO ADR-MNU-REQA.
      
       FIN-GNS-FIO-MNU.
           EXIT.
      
                                                                        
      *> Modulo FIO para registro RPF en DATACOM                         
       GNS-FIO-RPF SECTION.                                             
       INI-GNS-FIO-RPF.              
       
           MOVE ADR-RPF-REQA       TO ADR-REQA.                         
           MOVE 'RPF'              TO ADR-TABL IN ADR-REQA.   
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-RPF.                                   
       GRP-GNS-FIO-RPF.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-RPF, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-RPF.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'RPF-COD-DPTR' TO FIO-AKEY.
      
           MOVE 'RPF00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'RPF-COD-DPTR' OR FIO-AKEY NOT > SPACES )    
               MOVE RPF-COD-DPTR IN RPF TO ADR-VKEY IN ADR-REQA         
               MOVE 'RPF00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-RPF, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      
           MOVE RPF TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO RPF                                     
           ELSE                                                         
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'RPF'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-RPF-REQA.                               
      
       FIN-GNS-FIO-RPF.                                                 
           EXIT.                                                        
                                                                        
      
      *> Modulo FIO para registro TAB en DATACOM                         
       GNS-FIO-TAB SECTION.                                             
       INI-GNS-FIO-TAB.              
           MOVE ADR-TAB-REQA       TO ADR-REQA.                         
           MOVE 'TAB'              TO ADR-TABL IN ADR-REQA. 
           
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-TAB.                                   
       GRP-GNS-FIO-TAB.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-TAB, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-TAB.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      *>                                                                 
           MOVE 'TAB00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )    
               MOVE TAB-COD-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-STP-ITRN'                                 
               MOVE TAB-STP-ITRN IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-CIC-TABL'                                 
               MOVE TAB-CIC-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-EXT-TABL'                                 
               MOVE TAB-EXT-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-TAB, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      *>JSS                                                              
           IF FIO-CMND = FIO-PUT OR FIO-MOD                             
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB          
                                           TAB-EXT-TTAB IN TAB          
                                           TAB-SNX-TTAB IN TAB.         
      *>                                                                 
           MOVE TAB TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO TAB                                     
           ELSE                                                         
      *>JSS     MOVE "GNSTAB" TO FIO-MEN2                                
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'TAB'    TO FIO-MENS-REG                            
      *>                                                                 
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-TAB-REQA.                               
       FIN-GNS-FIO-TAB.                                                 
           EXIT.                                                        
                                                                        
      *>****************************************************
      *>  Issue a TPCALL
      *>****************************************************
       GNS-FIO-DTC SECTION.
       INI-GNS-FIO-DTC.
      
           MOVE ADR-REQA             TO FIO-ORACLE-RQA.
           MOVE FIO-DFLD             TO FIO-ORACLE-DFLD.
           MOVE FIO-MENS             TO FIO-ORACLE-MENS.
           MOVE FIO-VARI             TO FIO-ORACLE-VARI.
           MOVE ADR-TABL IN ADR-REQA TO FIO-ORACLE-PROG-TAB.
           MOVE ADR-DBID IN ADR-REQA TO FIO-ORACLE-PROG-NUM.
           MOVE FIO-ORACLE           TO SEND-STRING-FIO.
      
           IF FIO-CMND = 38
              MOVE ZEROES TO FIO-STAT
              PERFORM TUX-BACK-OUT
              GO TO FIN-GNS-FIO-DTC.
      
           MOVE 3000                 TO LEN.
           MOVE "CARRAY"             TO REC-TYPE.
           MOVE FIO-ORACLE-PROG      TO SERVICE-NAME.
      
      
      *>    MOVE FIO-CMND             TO LOGMSG-TEXT-1.
      *>    MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
      *>    MOVE SPACES               TO LOGMSG-TEXT-3.
      *>    MOVE "40"                 TO LOGMSG-NUMB.
      *>    PERFORM DO-USERLOG.
      
      
           SET TPBLOCK    IN TPSVCDEF-REC TO TRUE.
           SET TPTRAN     IN TPSVCDEF-REC TO TRUE.
           SET TPNOTIME   IN TPSVCDEF-REC TO TRUE.
           SET TPSIGRSTRT IN TPSVCDEF-REC TO TRUE.
           SET TPCHANGE   IN TPSVCDEF-REC TO TRUE.
      
           CALL "TPCALL" USING TPSVCDEF-REC
                TPTYPE-REC
                SEND-STRING-FIO
                TPTYPE-REC
                RECV-STRING-FIO
                TPSTATUS-REC.
      
      
           IF NOT TPOK
                DISPLAY 'GNSBGDTC :' FIO-ORACLE-PROG ' ' TP-STATUS
                MOVE "TPCALL Failed" TO FIO-MENS
                PERFORM PRG-ABT.
      
      
      *>    MOVE FIO-CMND             TO LOGMSG-TEXT-1.
      *>    MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
      *>    MOVE SPACES               TO LOGMSG-TEXT-3.
      *>    MOVE "41"                 TO LOGMSG-NUMB.
      *>    PERFORM DO-USERLOG.
      
      
      
           MOVE RECV-STRING-FIO     TO FIO-ORACLE.
           MOVE FIO-ORACLE-RQA      TO ADR-REQA.
           MOVE FIO-ORACLE-DFLD     TO FIO-DFLD.
           MOVE FIO-ORACLE-MENS     TO FIO-MENS.
           MOVE FIO-ORACLE-VARI     TO FIO-VARI.
      
       FIN-GNS-FIO-DTC.
           EXIT.
      
       TUX-BACK-OUT SECTION.
       INI-TUX-BACK-OUT.
      
           CALL "TPGETLEV" USING TPTRXLEV-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPGETLEV:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'GNSBGDTC TUX-BACK-OUT TP-NOT-IN-TRAN:'
                                                TP-STATUS
                 GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPSUSPEND:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPRESUME" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPRESUME:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE TRANID(1)           TO TSK-TRANID-1.
           MOVE TRANID(2)           TO TSK-TRANID-2.
           MOVE TRANID(3)           TO TSK-TRANID-3.
           MOVE TRANID(4)           TO TSK-TRANID-4.
           MOVE TRANID(5)           TO TSK-TRANID-5.
           MOVE TRANID(6)           TO TSK-TRANID-6.
           MOVE SPACES              TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF      TO TSK-TERM-TUX.
      
           MOVE 'GET'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE SPACES              TO QUE-TRX-SEND.
           MOVE SPACES              TO QUE-DAT-SEND.
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE QUE-DAT-RECV        TO QUE-ITEM.
           MOVE QUE-DATA            TO TSK-INFO-TRAN.
           MOVE 1                   TO TSK-INFO-COMMIT.
      
           MOVE 'MOD'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE TSK-INFO-TRANID-ALF TO QUE-TRX-SEND.
      
           MOVE TSK-INFO-TRAN       TO QUE-DATA.
           MOVE QUE-ITEM            TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
       FIN-TUX-BACK-OUT.
           EXIT.
                                                                        
      *> Carga Identificacion de Bases de Datos de los Sistemas ( BATCH )
      *> 15-JAN-1990 17:10:47
       GNS-BUS-IDD SECTION.
       INI-GNS-BUS-IDD.
      
      
           IF IDD-CIDD IN IDD-REGI NOT > SPACES
               MOVE FIO-PROG TO IDD-COD-CIDD IN IDD.
      
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IDD.
           IF NOT FIO-STAT-OKS
               DISPLAY
                   'NO EXISTE IDENTIFICACION INDEPENDENCIA DE DATOS: '
                                                 IDD-CIDD IN IDD-REGI
               IF IDD-CIDD IN IDD-REGI NOT = 'DEFAULT'
                   MOVE 'DEFAULT' TO IDD-COD-CIDD IN IDD
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-IDD
                   IF NOT FIO-STAT-OKS
                      DISPLAY 'NO EXISTE EL DEFAULT'
                              'COMO IDENTIFICACION INDEPENDENCIA DATOS'
                   ELSE
                      MOVE IDD TO IDD-REGI
                      GO TO EXT-GNS-BUS-IDD
               ELSE
                  NEXT SENTENCE
           ELSE
               MOVE IDD TO IDD-REGI
               GO TO EXT-GNS-BUS-IDD.
      
           MOVE SPACES               TO IDD-REGI.
           MOVE 'DEFECTO'            TO IDD-CIDD.
           MOVE 'GNS'                TO IDD-SIST(01).
           MOVE 'C'                  TO IDD-GRPO(01).
           MOVE 'D'                  TO IDD-TENT(01).
           MOVE '180'                TO IDD-IENT(01).
           MOVE 'TAB'                TO IDD-SIST(02).
           MOVE 'C'                  TO IDD-GRPO(02).
           MOVE 'D'                  TO IDD-TENT(02).
           MOVE '150'                TO IDD-IENT(02).
           MOVE 'GES'                TO IDD-SIST(03).
           MOVE 'M'                  TO IDD-GRPO(03).
           MOVE 'D'                  TO IDD-TENT(03).
           MOVE '360'                TO IDD-IENT(03).
           MOVE 'SGC'                TO IDD-SIST(04).
           MOVE 'M'                  TO IDD-GRPO(04).
           MOVE 'D'                  TO IDD-TENT(04).
           MOVE '100'                TO IDD-IENT(04).
           MOVE 'SGC'                TO IDD-SIST(05).
           MOVE 'C'                  TO IDD-GRPO(05).
           MOVE 'D'                  TO IDD-TENT(05).
           MOVE '190'                TO IDD-IENT(05).
           MOVE 'SGC'                TO IDD-SIST(06).
           MOVE 'T'                  TO IDD-GRPO(06).
           MOVE 'D'                  TO IDD-TENT(06).
           MOVE '100'                TO IDD-IENT(06).
           MOVE 'DEU'                TO IDD-SIST(07).
           MOVE 'M'                  TO IDD-GRPO(07).
           MOVE 'D'                  TO IDD-TENT(07).
           MOVE '140'                TO IDD-IENT(07).
           MOVE 'GNS'                TO IDD-SIST(08).
           MOVE 'M'                  TO IDD-GRPO(08).
           MOVE 'D'                  TO IDD-TENT(08).
           MOVE '180'                TO IDD-IENT(08).
           MOVE 'DEU'                TO IDD-SIST(09).
           MOVE 'C'                  TO IDD-GRPO(09).
           MOVE 'D'                  TO IDD-TENT(09).
           MOVE '200'                TO IDD-IENT(09).
           MOVE 'MC2'                TO IDD-SIST(10).
           MOVE 'C'                  TO IDD-GRPO(10).
           MOVE 'D'                  TO IDD-TENT(10).
           MOVE '501'                TO IDD-IENT(10).
           MOVE 'GES'                TO IDD-SIST(11).
           MOVE 'T'                  TO IDD-GRPO(11).
           MOVE 'D'                  TO IDD-TENT(11).
           MOVE '362'                TO IDD-IENT(11).
           MOVE 'GES'                TO IDD-SIST(12).
           MOVE 'C'                  TO IDD-GRPO(12).
           MOVE 'D'                  TO IDD-TENT(12).
           MOVE '354'                TO IDD-IENT(12).
           MOVE 'COL'                TO IDD-SIST(13).
           MOVE 'M'                  TO IDD-GRPO(13).
           MOVE 'D'                  TO IDD-TENT(13).
           MOVE '160'                TO IDD-IENT(13).
           MOVE 'COL'                TO IDD-SIST(14).
           MOVE 'T'                  TO IDD-GRPO(14).
           MOVE 'D'                  TO IDD-TENT(14).
           MOVE '170'                TO IDD-IENT(14).
           MOVE 'COL'                TO IDD-SIST(15).
           MOVE 'C'                  TO IDD-GRPO(15).
           MOVE 'D'                  TO IDD-TENT(15).
           MOVE '210'                TO IDD-IENT(15).
           MOVE 'BGL'                TO IDD-SIST(16).
           MOVE 'M'                  TO IDD-GRPO(16).
           MOVE 'D'                  TO IDD-TENT(16).
           MOVE '209'                TO IDD-IENT(16).
           MOVE 'GAR'                TO IDD-SIST(17).
           MOVE 'T'                  TO IDD-GRPO(17).
           MOVE 'D'                  TO IDD-TENT(17).
           MOVE '130'                TO IDD-IENT(17).
           MOVE 'DAP'                TO IDD-SIST(18).
           MOVE 'M'                  TO IDD-GRPO(18).
           MOVE 'D'                  TO IDD-TENT(18).
           MOVE '370'                TO IDD-IENT(18).
           MOVE 'SIN'                TO IDD-SIST(19).
           MOVE 'C'                  TO IDD-GRPO(19).
           MOVE 'D'                  TO IDD-TENT(19).
           MOVE '190'                TO IDD-IENT(19).
           MOVE 'SPA'                TO IDD-SIST(20).
           MOVE 'C'                  TO IDD-GRPO(20).
           MOVE 'D'                  TO IDD-TENT(20).
           MOVE '355'                TO IDD-IENT(20).
           MOVE 'SGC'                TO IDD-SIST(21).
           MOVE 'S'                  TO IDD-GRPO(21).
           MOVE 'D'                  TO IDD-TENT(21).
           MOVE '101'                TO IDD-IENT(21).
           MOVE 'SPA'                TO IDD-SIST(22).
           MOVE 'M'                  TO IDD-GRPO(22).
           MOVE 'D'                  TO IDD-TENT(22).
           MOVE '355'                TO IDD-IENT(22).
           MOVE 'GES'                TO IDD-SIST(23).
           MOVE 'C'                  TO IDD-GRPO(23).
           MOVE 'D'                  TO IDD-TENT(23).
           MOVE '354'                TO IDD-IENT(23).
           MOVE 'CCT'                TO IDD-SIST(24).
           MOVE 'C'                  TO IDD-GRPO(24).
           MOVE 'D'                  TO IDD-TENT(24).
           MOVE '381'                TO IDD-IENT(24).
           MOVE 'DAP'                TO IDD-SIST(25).
           MOVE 'C'                  TO IDD-GRPO(25).
           MOVE 'D'                  TO IDD-TENT(25).
           MOVE '371'                TO IDD-IENT(25).
           MOVE 'DAP'                TO IDD-SIST(26).
           MOVE 'T'                  TO IDD-GRPO(26).
           MOVE 'D'                  TO IDD-TENT(26).
           MOVE '372'                TO IDD-IENT(26).
           MOVE 'SEC'                TO IDD-SIST(27).
           MOVE 'C'                  TO IDD-GRPO(27).
           MOVE 'D'                  TO IDD-TENT(27).
           MOVE '341'                TO IDD-IENT(27).
           MOVE 'SUP'                TO IDD-SIST(28).
           MOVE 'M'                  TO IDD-GRPO(28).
           MOVE 'D'                  TO IDD-TENT(28).
           MOVE '230'                TO IDD-IENT(28).
           MOVE 'SUP'                TO IDD-SIST(29).
           MOVE 'C'                  TO IDD-GRPO(29).
           MOVE 'D'                  TO IDD-TENT(29).
           MOVE '230'                TO IDD-IENT(29).
           MOVE 'LDC'                TO IDD-SIST(30).
           MOVE 'M'                  TO IDD-GRPO(30).
           MOVE 'D'                  TO IDD-TENT(30).
           MOVE '260'                TO IDD-IENT(30).
           MOVE 'SEC'                TO IDD-SIST(31).
           MOVE 'M'                  TO IDD-GRPO(31).
           MOVE 'D'                  TO IDD-TENT(31).
           MOVE '341'                TO IDD-IENT(31).
           MOVE 'LDC'                TO IDD-SIST(32).
           MOVE 'C'                  TO IDD-GRPO(32).
           MOVE 'D'                  TO IDD-TENT(32).
           MOVE '261'                TO IDD-IENT(32).
           MOVE 'CCT'                TO IDD-SIST(33).
           MOVE 'M'                  TO IDD-GRPO(33).
           MOVE 'D'                  TO IDD-TENT(33).
           MOVE '380'                TO IDD-IENT(33).
           MOVE 'BGL'                TO IDD-SIST(34).
           MOVE 'C'                  TO IDD-GRPO(34).
           MOVE 'D'                  TO IDD-TENT(34).
           MOVE '211'                TO IDD-IENT(34).
           MOVE 'MC2'                TO IDD-SIST(35).
           MOVE 'M'                  TO IDD-GRPO(35).
           MOVE 'D'                  TO IDD-TENT(35).
           MOVE '500'                TO IDD-IENT(35).
      
       EXT-GNS-BUS-IDD.
           DISPLAY 'PROGRAMA USARA : ' IDD-CIDD IN IDD-REGI
                   ' COMO IDENTIFICACION INDEPENDENCIA DE DATOS : '
           DISPLAY 'SISTEMA GRUPO TABLA TIPO IDENTIFICACION'.
           DISPLAY '======================================='.
           MOVE 1 TO IDD-IAUX.
       LUP-GNS-BUS-IDD.
           IF IDD-SIST IN IDD-VARI(IDD-IAUX) > SPACES
               DISPLAY '| ' IDD-SIST IN IDD-VARI(IDD-IAUX) '     '
                            IDD-GRPO IN IDD-VARI(IDD-IAUX) '    '
                            IDD-RGST IN IDD-VARI(IDD-IAUX) '   '
                            IDD-TENT IN IDD-VARI(IDD-IAUX) '        '
                            IDD-IENT IN IDD-VARI(IDD-IAUX) '     |'.
           ADD 1 TO IDD-IAUX.
           IF IDD-IAUX NOT > 30
               GO TO LUP-GNS-BUS-IDD.
           DISPLAY '======================================='.
       FIN-GNS-BUS-IDD.
           EXIT.
                                                                        
      *> Modulo FIO para registro IDD en DATACOM                         
       GNS-FIO-IDD SECTION.                                             
       INI-GNS-FIO-IDD.              
      
      
      
           MOVE ADR-IDD-REQA       TO ADR-REQA.                         
           MOVE 'IDD'              TO ADR-TABL IN ADR-REQA.   
           MOVE 999                TO ADR-DBID IN ADR-REQA
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'IDD-COD-CIDD' TO FIO-AKEY.
      
           MOVE 'IDD00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'IDD-COD-CIDD' OR FIO-AKEY NOT > SPACES )    
               MOVE IDD-COD-CIDD IN IDD TO ADR-VKEY IN ADR-REQA         
               MOVE 'IDD00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-IDD, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      
           MOVE IDD TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO IDD                                     
           ELSE                                                         
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'IDD'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-IDD-REQA.                               
      
       FIN-GNS-FIO-IDD.                                                 
           EXIT.                                                        
                                                                        
      *> Modulo para detener ejecucion de programa                       
       GNS-PRO-END SECTION.                                             
       INI-GNS-PRO-END.                                                 
           GOBACK.                                                      
       FIN-GNS-PRO-END.                                                 
           EXIT PROGRAM.                                                
                                                                        
                                                                        
      *>****************************************************
      *> Now register the client with the system.
      *>****************************************************
       DO-TPINIT SECTION.
       INI-DO-TPINIT.
           MOVE SPACES TO USRNAME.
           MOVE SPACES TO CLTNAME.
           MOVE SPACES TO PASSWD.
           MOVE SPACES TO GRPNAME.
           MOVE ZERO TO DATALEN.
           SET TPU-DIP TO TRUE.
      *>
           CALL "TPINITIALIZE" USING TPINFDEF-REC 
                USER-DATA-REC 
                TPSTATUS-REC.      
      
           IF NOT TPOK
                MOVE "TPINITIALIZE Failed" TO LOGMSG-TEXT
                DISPLAY 'LOGMSG :' LOGMSG
                PERFORM EXIT-PROGRAM
           END-IF.
       FIN-DO-TPINIT.
           EXIT.                                                        
      
      *>****************************************************
      *> Leave TUXEDO  
      *>****************************************************
       DO-TPTERM SECTION.
       INI-DO-TPTERM.
           DISPLAY 'PERFORM DO-TPTERM'.
           CALL "TPTERM" USING TPSTATUS-REC.      
           IF  NOT TPOK
                MOVE "TPTERM Failed" TO LOGMSG-TEXT
                DISPLAY 'LOGMSG :' LOGMSG
           END-IF.
       FIN-DO-TPTERM.
           EXIT.                                                        
      
      *>****************************************************
      *>Leave Application
      *>****************************************************
       EXIT-PROGRAM SECTION.
       INI-EXIT-PROGRAM.
           MOVE "Ended" TO LOGMSG-TEXT.
           DISPLAY 'LOGMSG :' LOGMSG.
           STOP RUN.
      
       FIN-EXIT-PROGRAM.
           EXIT.                                                        
      
       GNS-PUT-TSK SECTION.                                             
       INI-GNS-PUT-TSK.   
      
           CALL "TPBEGIN" USING TPTRXDEF-REC TPSTATUS-REC
           IF NOT TPOK
              PERFORM PRG-ABT
           ELSE
              DISPLAY 'TPGETLEV TP-IN-TRAN    :' TP-STATUS.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC
                                 TPSTATUS-REC.                          
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
      
           CALL "TPRESUME" USING TPTRXDEF-REC
                                 TPSTATUS-REC.             
           IF NOT TPOK
              DISPLAY 'ERROR  TPRESUME  :' TP-STATUS.
      
           MOVE TRANID(1) TO TSK-TRANID-1.
           MOVE TRANID(2) TO TSK-TRANID-2.
           MOVE TRANID(3) TO TSK-TRANID-3.
           MOVE TRANID(4) TO TSK-TRANID-4.
           MOVE TRANID(5) TO TSK-TRANID-5.
           MOVE TRANID(6) TO TSK-TRANID-6.
           MOVE SPACES         TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF TO TSK-TERM-TUX.
      
           DISPLAY 'NO VIENE NUMERO  ASUME 1111111'
                                            ':' TSK-TERM-TUX
                                            
           MOVE 1111111              TO TSK-TERM-NUM-TUX.
           MOVE TSK-TERM-NUM-TUX     TO TSK-TERM-NUM
           MOVE TSK-TERM-NUM         TO EIBTASKN
      
      
           MOVE 'DEL'              TO QUE-COM-SEND.                     
           MOVE TSK-TERM-TUX       TO QUE-NAM-SEND.      
           MOVE ZEROES             TO QUE-NUM-SEND.      
           MOVE 7                  TO QUE-LAR-SEND.      
           MOVE TSK-TERM-NUM-TUX   TO QUE-TRX-SEND.  
           MOVE SPACES             TO QUE-DAT-SEND.                     
           PERFORM GNS-MSJ-QUE.    
                        
           MOVE 'PUT'              TO QUE-COM-SEND.                     
           MOVE TSK-TERM-TUX       TO QUE-NAM-SEND.      
           MOVE 1                  TO QUE-NUM-SEND.      
           MOVE 8                  TO QUE-LAR-SEND.      
           MOVE TSK-TERM-NUM-TUX   TO QUE-TRX-SEND.      
      
           MOVE TSK-TERM-NUM-TUX   TO TSK-INFO-TRANID.
           MOVE 0                  TO TSK-INFO-COMMIT.
           
           MOVE TSK-INFO-TRAN      TO QUE-DATA.                         
           MOVE QUE-ITEM           TO QUE-DAT-SEND.                     
           PERFORM GNS-MSJ-QUE.
      
       FIN-GNS-PUT-TSK.                                                 
            EXIT.                                                      
      
       GNS-GET-TSK SECTION.                                             
       INI-GNS-GET-TSK.   
      
           MOVE 0                  TO TSK-INFO-COMMIT.
                        
           MOVE 'GET'              TO QUE-COM-SEND.                     
           MOVE TSK-TERM-TUX       TO QUE-NAM-SEND.      
           MOVE 1                  TO QUE-NUM-SEND.      
           MOVE 8                  TO QUE-LAR-SEND.      
           MOVE TSK-TERM-NUM-TUX   TO QUE-TRX-SEND.      
           MOVE SPACES             TO QUE-DAT-SEND.                     
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              GO TO FIN-GNS-GET-TSK.                                    
      
           MOVE QUE-DATA           TO TSK-INFO-TRAN.
      
           MOVE 'DEL'              TO QUE-COM-SEND.                     
           MOVE TSK-TERM-TUX       TO QUE-NAM-SEND.      
           MOVE ZEROES             TO QUE-NUM-SEND.      
           MOVE 7                  TO QUE-LAR-SEND.      
           MOVE TSK-TERM-NUM-TUX   TO QUE-TRX-SEND.  
           MOVE SPACES             TO QUE-DAT-SEND.                     
           PERFORM GNS-MSJ-QUE.    
      
           IF TSK-INFO-COMMIT = 1
              CALL "TPABORT" USING TPTRXDEF-REC TPSTATUS-REC
              IF NOT TPOK
                 DISPLAY 'TPABORT TP-STATUS :' TP-STATUS 
                 PERFORM PRG-ABT
              ELSE
                 DISPLAY 'TPABORT TP-STATUS :' TP-STATUS 
                 PERFORM PRG-ABT
           ELSE              
              CALL "TPCOMMIT" USING TPTRXDEF-REC TPSTATUS-REC
              IF NOT TPOK
                 DISPLAY 'TPCOMMIT TP-STATUS :' TP-STATUS 
                 PERFORM PRG-ABT.
      
      
       FIN-GNS-GET-TSK.                                                 
            EXIT.                                                      
      
      
                                                                        
       PRG-ABT SECTION.                                                 
       INI-PRG-ABT.                                                     
           DISPLAY 'ABORTANDO EN PRG-ABT '.                             
           DISPLAY 'FIO-MENS : ' FIO-MENS.                              
           MOVE 100 TO RETURN-CODE.                                     
           GOBACK.                                                      
       FIN-PRG-ABT.                                                     
           EXIT.                                                        
      
      *>INI-PENTA TUXEDO ORACLE
      *>Modulo Generico Manejo de Colas
      
       GNS-CHK-QUEU SECTION.
      
       INI-GNS-CHK-QUEU.
      
           MOVE 1 TO QUE-NITM.
      
           MOVE QUE-GET TO QUE-CMND.
      
           PERFORM GNS-PRO-QUE.
      
       FIN-GNS-CHK-QUEU.
      
           EXIT.
      
      
      
       GNS-QUE-EOQ SECTION.
      
       INI-GNS-QUE-EOQ.
      
           MOVE QUE-STAT-EOQ TO QUE-STAT.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-QUE-EOQ.
      
           EXIT.
      
      
      
       GNS-QUE-NEX SECTION.
      
       INI-GNS-QUE-NEX.
      
           MOVE QUE-STAT-NEX TO QUE-STAT.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-QUE-NEX.
      
           EXIT.
      
      
      
       GNS-ERR-QUE SECTION.
      
       INI-GNS-ERR-QUE.
      
      
      
      *>     EXEC CICS HANDLE CONDITION
      
      *>               QIDERR (GNS-QUE-NEX)
      
      *>               ITEMERR(GNS-QUE-EOQ)
      
      *>               LENGERR(GNS-QUE-NEX)
      
      *>     END-EXEC.
      
      
      
       FIN-GNS-ERR-QUE.
      
           EXIT.
      
      
      
       GNS-PRO-QUE SECTION.
      
       INI-GNS-PRO-QUE.
      
      
      
           MOVE QUE-STAT-OKS TO QUE-STAT.
      
      
      
           IF QUE-CMND = QUE-PUT
      
               GO TO GNS-PUT-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-GET
      
               GO TO GNS-GET-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-MOD
      
               GO TO GNS-MOD-QUE
      
           ELSE
      
           IF QUE-CMND = QUE-DEL
      
               GO TO GNS-DEL-QUE.
      
      
      
      
      
      
      
           MOVE 'Comando invalido :' TO QUE-MEN1.
      
           MOVE QUE-CMND             TO QUE-MEN2.
      
           MOVE QUE-MENS             TO FIO-MENS.
      
      
      
      *>     EXEC CICS XCTL
      
      *>               PROGRAM("GNSPPABT")
      
      *>               COMMAREA(QUE-MENS)
      
      *>               LENGTH(+79)
      
      *>     END-EXEC.
      
      
      
           MOVE +79                  TO LEN.
      
           MOVE "CARRAY"             TO REC-TYPE.
      
           MOVE 'GNSPPABT'           TO SERVICE-NAME.
      
           CALL "TPFORWARD" USING TPSVCDEF-REC
      
                                  TPTYPE-REC
      
                                  QUE-MENS
      
                                  TPSTATUS-REC.
      
      
      
           GOBACK.
      
      
      
      
      
      
      
      
      
       GNS-PUT-QUE.
      
      
      
      *>     EXEC CICS WRITEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               FROM(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               AUXILIARY
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE ZEROES   TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE QUE-ITEM TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
      
      
       FIN-GNS-PUT-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       GNS-GET-QUE.
      
      
      
      *>     EXEC CICS READQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               INTO(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               ITEM(QUE-NITM)
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE SPACES   TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
       FIN-GNS-GET-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       GNS-MOD-QUE.
      
      
      
      *>     EXEC CICS WRITEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>               FROM(QUE-ITEM)
      
      *>               LENGTH(QUE-LITM)
      
      *>               ITEM(QUE-NITM)
      
      *>               REWRITE
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
           MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE QUE-LITM TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE QUE-ITEM TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
       FIN-GNS-MOD-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
      
      
       GNS-DEL-QUE.
      
      
      
      *>     EXEC CICS DELETEQ TS
      
      *>               QUEUE(QUE-COLA)
      
      *>     END-EXEC.
      
      
      
           MOVE QUE-CMND TO QUE-COM-SEND.
      
           MOVE SPACES   TO QUE-NAM-SEND.
      
           MOVE QUE-COLA TO QUE-NAM-SEND.
      
      *>    MOVE QUE-NITM TO QUE-NUM-SEND.
      
           MOVE ZEROES   TO QUE-NUM-SEND.
      
           MOVE ZEROES   TO QUE-LAR-SEND.
      
           MOVE SPACES   TO QUE-TRX-SEND.
      
           MOVE TSK-TERM-ALF TO QUE-TRX-SEND.
      
           MOVE SPACES   TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
      
      
      
      
       FIN-GNS-DEL-QUE.
      
           GO TO FIN-GNS-PRO-QUE.
      
       FIN-GNS-PRO-QUE.
      
           EXIT.
      
      
      
       GNS-MSJ-QUE SECTION.
      
       INI-GNS-MSJ-QUE.
      
      
      
      *>     SET QUE-TPNOTRAN    TO TRUE.
      
           SET QUE-TPTRAN      TO TRUE.
      
           SET QUE-TPBLOCK     TO TRUE.
      
           SET QUE-TPNOTIME    TO TRUE.
      
           SET QUE-TPSIGRSTRT  TO TRUE.
      
           SET QUE-TPCHANGE    TO TRUE.
      
          
           MOVE SPACES TO QUE-RECV.
      
      
      *>    MOVE "00"         TO LOGMSG-NUMB.
      
      *>    MOVE QUE-COM-SEND TO LOGMSG-TEXT.
      
      *>    PERFORM DO-USERLOG.
      
      
      
           CALL "TPCALL" USING QUE-TPSVCDEF-REC
      
                QUE-TPTYPE-REC-SEND
      
                QUE-SEND
      
                QUE-TPTYPE-REC-RECV
      
                QUE-RECV
      
                TPSTATUS-REC.
      
      
      
      *>    MOVE "01"         TO LOGMSG-NUMB.
      
      *>    MOVE QUE-COM-SEND TO LOGMSG-TEXT.
      
      *>    PERFORM DO-USERLOG.
      
      
      
           IF NOT TPOK
      
              MOVE QUE-STAT-NEX TO QUE-STAT
      
              DISPLAY 'TEMPORAL STORAGE :' TP-STATUS
      
              MOVE TP-STATUS    TO QUE-NUM-STAT
      
              MOVE QUE-NUM-STAT TO QUE-GLS-STAT
      
           ELSE
      
              IF QUE-STA-RECV = ZEROES
      
                 MOVE QUE-STAT-OKS TO QUE-STAT
      
                 MOVE QUE-DAT-RECV TO QUE-ITEM
      
              ELSE
      
                 MOVE QUE-STAT-NEX TO QUE-STAT.
      
      
      
       FIN-GNS-MSJ-QUE.
      
           EXIT.
      
      
      
                     
      *>FIN-PENTA TUXEDO ORACLE
