       IDENTIFICATION DIVISION.
      *>========================
       PROGRAM-ID. GNSPPMTI.
       AUTHOR. BEE.
       DATE-WRITTEN.  13-JAN-2004 19:39:35
      *> IDENTIFICACION = MULTI-V1B1
      *>
      *> MENU PARA TRANSIENT DATA
      *>
       ENVIRONMENT DIVISION.
      *>=====================
       DATA DIVISION.
      *>==============
      
       WORKING-STORAGE SECTION.
      *>------------------------
       77  WSS-TAG-GNSPPMTI           PIC X(0125) VALUE
           '<IDNPGM NOM=$GNSPPMTI$ VSN=$05.06.13$ GEN=$13-06-200517:16$ FNC=$INFORMA MULTI + WSS-HDR-MNSF$/>'.
      
      
       01  WSS-IDD-VARI.
           03 WSS-QIDD-LEN  VALUE +490     COMP PIC S9(04).
           03 WSS-QIDD.
              05 WSS-NIDD VALUE 'GIDD'    PIC X(04).
              05 WSS-TIDD                 PIC X(04).
      *> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      *> 77  WSS-AUXI-NUM3    VALUE ZEROES PIC 9(03).
      *> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      *> VARIABLES PARA DESPLEGAR CAMPOS CON ATRIBUTOS
      *> 77  WSS-DSP-TSO VALUE "N"    PIC X(01).
       77  WSS-IDX-CAMPO VALUE ZEROES   PIC 9(04).
       01  WSS-TAB-CAMPO.
           03  WSS-TAB-CAMPO-OCC OCCURS 120 TIMES.
               05 WSS-TAB-CAMPO-ELM    PIC X(01).
      *> VARIABLES PARA DESPLEGAR CAMPOS CON ATRIBUTOS
      
      *>AMB-FIN MANEJO DE HEADER Y BYTE ATRIBUTOS
                                                                        
       01  WSS-TSL-COLA.                                                
           03 WSS-TSL-TERM         VALUE SPACES       PIC X(04).        
           03 WSS-TSL-TYPE         VALUE 'AMBI'       PIC X(04).        
      *> 01  WSS-TSL.                                                    
      *>        05  WSS-TSC-BNCO     VALUE SPACES       PIC X(03).       
      *>        05  WSS-TSC-MRCA     VALUE SPACES       PIC X(03).       
      *>        05  WSS-TSC-CART     VALUE SPACES       PIC X(03).       
      *>        05  WSS-TSC-LENG     VALUE SPACES       PIC X(02).       
      *>        05  WSS-TSC-PAIS     VALUE SPACES       PIC X(02).       
      *>        05  WSS-TSC-VRNT     VALUE SPACES       PIC X(01).       
      *>        05  WSS-TSC-CNAL     VALUE SPACES       PIC X(05).       
      *>        05  WSS-TSC-UMUA     VALUE SPACES       PIC X(12).       
      *>        05  WSS-TSC-MODO     VALUE SPACES       PIC X(01).       
                                                                        
       77  WSS-TSL-LITM      VALUE +32   COMP PIC S9(04).               
                                                                        
      *> ESTA VARIABLE ESTA EN GNSWGMXX CON LARGO 3                      
      *> GNSPPMTI LA PONE EN 100                                         
      *> 77  WSS-HDR-LITM      VALUE +100   COMP PIC S9(04).             
      *>01  WSS-HDR-COLA.                                                
      *>     03 WSS-HDR-TERM         VALUE SPACES       PIC X(04).       
      *>     03 WSS-HDR-TYPE         VALUE "AMBI"       PIC X(04).       
      *> ESTRUCTURA DE HEADER                                            
       01  WSS-HDR VALUE SPACES.                                        
      *>              "HV01" IMPLEMENTA VERSION MUTLI BCI                
      *>                     LARGO = 100                                 
           03 WSS-HDR-VERS                        PIC X(00004).         
           03 WSS-HDR-BNCO                        PIC X(00003).         
           03 WSS-HDR-MRCA                        PIC X(00003).         
           03 WSS-HDR-CART                        PIC X(00003).         
           03 WSS-HDR-LENG                        PIC X(00002).         
           03 WSS-HDR-PAIS                        PIC X(00002).         
           03 WSS-HDR-VRNT                        PIC X(00001).         
           03 WSS-HDR-USER                        PIC X(00012).         
           03 WSS-HDR-CNAL                        PIC X(00005).         
           03 WSS-HDR-UMUA                        PIC X(00012).         
           03 WSS-HDR-PROG                        PIC X(00008).         
           03 WSS-HDR-IBYA                        PIC X(00001).         
           03 WSS-HDR-BCKI                        PIC X(00001).         
           03 WSS-HDR-I24H                        PIC X(00001).         
           03 WSS-HDR-MODO                                              
              REDEFINES WSS-HDR-I24H PIC X(00001).                      
           03 WSS-HDR-MNSF                        PIC X(00001).         
           03 WSS-HDR-DIS1                        PIC X(00031).         
           03 WSS-HDR-IREQ.                                             
              05 WSS-HDR-IR01                     PIC X(00001).         
              05 WSS-HDR-IR02                     PIC X(00001).         
              05 WSS-HDR-IR03                     PIC X(00001).         
              05 WSS-HDR-IR04                     PIC X(00001).         
              05 WSS-HDR-IR05                     PIC X(00001).         
              05 WSS-HDR-IR06                     PIC X(00001).         
              05 WSS-HDR-IR07                     PIC X(00001).         
              05 WSS-HDR-IR08                     PIC X(00001).         
              05 WSS-HDR-IR09                     PIC X(00001).         
              05 WSS-HDR-IR10                     PIC X(00001).         
                     
      *>    Relacion Concepto IDD                                        
      *>    ---------------------                                        
      *>                                                                 
      *>    Nombre Registro : RCI                                        
      *>    Clave_1         : RCI-KEY-IRCI(UU) [01,78]                   
      *>    Clave_2         : RCI-COD-CIDD(UU) [67,12]                   
      *>    Largo           : 119                                        
      *>    Bloqueo         : 1                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  RCI.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  RCI-GLS-FLAG                              PIC X(01).     
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  RCI-KEY-IRCI.                                            
      *>                                                                 
      *>        Clave de Concepto                                        
               05  RCI-KEY-CPTO.                                        
      *>                                                                 
      *>            Codigo de Concepto                    GNS CPT        
                   07  RCI-COD-CPTO                      PIC X(12).     
      *>                                                                 
      *>            Ambiente                                             
                   07  RCI-GLS-AMBT.                                    
      *>                                                                 
      *>                Codigo Banco                                     
                       09  RCI-COD-BNCO                  PIC X(03).     
      *>                                                                 
      *>                Codigo Marca                                     
                       09  RCI-COD-MRCA                  PIC X(03).     
      *>                                                                 
      *>                Codigo Cartera                                   
                       09  RCI-COD-CART                  PIC X(03).     
      *>                                                                 
      *>                Codigo Lenguaje                                  
                       09  RCI-COD-LENG                  PIC X(02).     
      *>                                                                 
      *>                Codigo Pais                                      
                       09  RCI-COD-PAIS                  PIC X(02).     
      *>                                                                 
      *>                Codigo Variante                                  
                       09  RCI-COD-VRNT                  PIC X(01).     
      *>                                                                 
      *>                Canal                                            
                       09  RCI-COD-CNAL                  PIC X(05).     
      *>                                                                 
      *>                Usuario                                          
                       09  RCI-COD-USER                  PIC X(12).     
      *>                                                                 
      *>                                                                 
      *>                Usuario Ambiente                                 
                       09  RCI-COD-UMUA   REDEFINES                     
                           RCI-COD-USER   PIC X(12).                    
      *>                                                                 
      *>                Modo                                             
                       09  RCI-COD-MODO                  PIC X(01).     
      *>                                                                 
      *>                Disponible                                       
                       09  RCI-KEY-DISP                  PIC X(22).     
      *>                                                                 
      *>        Codigo de IDD                                            
               05  RCI-COD-CIDD                          PIC X(12).     
      *>                                                                 
      *>    Time Stamp Transaccion                                       
           03  RCI-STP-ITRN.                                            
      *>                                                                 
      *>        Fecha Transaccion                                        
               05  RCI-FEC-FTRN.                                        
                   07  RCI-NUM-STRN                      PIC 9(02).     
                   07  RCI-NUM-ATRN                      PIC 9(02).     
                   07  RCI-NUM-MTRN                      PIC 9(02).     
                   07  RCI-NUM-DTRN                      PIC 9(02).     
      *>                                                                 
      *>        Hora Transaccion                                         
               05  RCI-HRA-HRTR.                                        
                   07  RCI-NUM-HHTR                      PIC 9(02).     
                   07  RCI-NUM-MMTR                      PIC 9(02).     
                   07  RCI-NUM-SSTR                      PIC 9(02).     
      *>                                                                 
      *>REQ Indicador Tipo Accion                                        
           03  RCI-MSC-TACC                              PIC X(01).     
      *>                                                                 
      *>    Indicador Status                                             
           03  RCI-MSC-STAT                              PIC X(01).     
      *>                                                                 
      *>REQ Codigo Origen Transaccion                                    
           03  RCI-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  RCI-MSC-TTRN                          PIC X(01).     
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  RCI-COD-TTRN                          PIC X(03).     
      *>                                                                 
      *>REQ Autor Transaccion                                            
           03  RCI-COD-ATRN                              PIC X(12).     
      *>                                                                 
      *>REQ Codigo de Vigencia                            GNS SON        
           03  RCI-IND-VIGE                              PIC X(01).     
      *>                                                                 
      *>    Glosa Disponible                                             
           03  RCI-GLS-DISP                              PIC X(07).     
                     
       77  RCI-FST-RRCI VALUE 'S'                          PIC X(01).   
       77  RCI-DFL-RRCI VALUE 'N'                          PIC X(01).   
       77  RCI-CNAD-RRCI VALUE SPACES                      PIC X(02).   
       01  RCI-VARI VALUE SPACES.                                       
           03 RCI-IDD.                                                  
              05 RCI-GLS-FLAG                              PIC X(01).   
              05 RCI-COD-CIDD                              PIC X(12).   
              05 RCI-GLS-FSIS.                                          
                 07 RCI-GLS-VSIS OCCURS 43.                             
                    09 RCI-GLS-DENT.                                    
                       11 RCI-COD-SIST                     PIC X(03).   
                       11 RCI-COD-GRPO                     PIC X(01).   
                       11 RCI-COD-RGST                     PIC X(03).   
                    09 RCI-COD-TENT                        PIC X(01).   
                    09 RCI-COD-IENT                        PIC X(03).   
              05 RCI-GLS-DISP                              PIC X(04).   
           03 RCI-NUM-IND1                                 PIC 9(03).   
           03 RCI-NUM-IND2                                 PIC 9(03).   
           03 RCI-MSG-ABT.                                              
              05 RCI-MSG-ABT1                              PIC X(25).   
              05 RCI-MSG-ABT2                              PIC X(65).   
      *> Variables Recibidas como Parametros                             
           03 RCI-KEY-CPTO.                                             
              05 RCI-COD-CPTO                              PIC X(12).   
              05 RCI-GLS-AMBT.                                          
                 07 RCI-COD-BNCO                           PIC X(03).   
                 07 RCI-COD-MRCA                           PIC X(03).   
                 07 RCI-COD-CART                           PIC X(03).   
                 07 RCI-COD-LENG                           PIC X(02).   
                 07 RCI-COD-PAIS                           PIC X(02).   
                 07 RCI-COD-VRNT                           PIC X(01).   
                 07 RCI-COD-CNAL                           PIC X(05).   
                 07 RCI-COD-UMUA                           PIC X(12).   
                 07 RCI-COD-MODO                           PIC X(01).   
                 07 RCI-KEY-DISP                           PIC X(22).   
      *> Variables Respaldo                                              
           03 RCI-KEY-CPTO-BKP.                                         
              05 RCI-GLS-AMBT-BKP.                                      
                 07 RCI-COD-CNAL-BKP                       PIC X(05).   
                 07 RCI-COD-USER-BKP                       PIC X(12).   
                                                                        
                     
      
       01  WSS-MIRA    VALUE '*()*' PIC X(04).
       01  WSS-COD-CIFD VALUE SPACES PIC X(12).
      
       01  MSG-TDO.
           03 MSG-TDO-COD-STAT       PIC X(01).
           03 MSG-TDO-COD-MSJE       PIC X(12).
           03 MSG-TDO-GLS-MSJE       PIC X(79).
       77  WSS-PREG-POR-SPAC    VALUE 'N' PIC X(01).
      
      *> CH-INI
      *>COPY LDCBRTSM.
       01  TDI.                                                         
           03 TDI-NUM-RECO                      PIC 9(03).              
           03 TDI-GLS-DATA.                                             
              05 TDI-GLS-DESC.                                          
                 07 TDI-COD-TDI OCCURS 18000 TIMES PIC X(01).           
              05 TDI-GLS-DESC-RED REDEFINES TDI-GLS-DESC.               
                 07 TDI-GLS-DESC-1            PIC X(9000).              
                 07 TDI-GLS-DESC-2            PIC X(9000).              
      *>                                                                 
       01  TDO REDEFINES TDI.                                           
           03 TDO-NUM-RECO                         PIC 9(03).           
           03 TDO-GLS-DATA.                                             
              05 TDO-GLS-DESC.                                          
                 07 TDO-GLS-MENS-MSG.                                   
                    09 TDO-COD-STAT                PIC X(0001).         
                    09 TDO-GLS-MENS.                                    
                       11 TDO-GLS-MENS1            PIC X(0020).         
                       11 TDO-GLS-MENS2            PIC X(0059).         
                 07 TDO-DESC-OCC.                                       
                    09 TDO-COD-TDO OCCURS  17920 TIMES PIC X(01).       
              05 TDO-GLS-DESC-RED REDEFINES TDO-GLS-DESC.               
                 07 TDO-GLS-DESC-1                PIC X(9000).          
                 07 TDO-GLS-DESC-2                PIC X(9000).          
                                                                        
       01  TDI-VARI.                                                    
           03 TDI-COLA.                                                 
              05 TDI-TYPE-R         COMP-3         PIC S9(07).          
              05 TDI-TYPE  REDEFINES  TDI-TYPE-R   PIC  X(04).          
              05 TDI-TERM                          PIC  X(04).          
       01  TDO-VARI.                                                    
           03 TDO-COLA.                                                 
              05 TDO-TYPE-R         COMP-3         PIC S9(07).          
              05 TDO-TYPE  REDEFINES  TDO-TYPE-R   PIC  X(04).          
              05 TDO-TERM                          PIC  X(04).          
                     
      *> CH-FIN
      
      *> CH-INI
      *> COPY LDCWGMTX.
       77  WSS-TAG-GNSWGMXX         PIC X(125) VALUE                    
           '<IDNMOD NOM=$GNSWGMXX$ VGM=$MANUAL$   VSN=$04.07.13$         GEN=$13-JUL-04 17:22 PM$ FNC=$ROK+USER$/>'.                
      *>  VARIABLE PARA DISTINGUIR AMBIENTE                              
      *>                                                                 
      *> REALIA                                                          
      *>01  WSS-IND-AMB       VALUE "REA"     PIC X(03).                 
      *>                                                                 
      *> HOST                                                            
       01 CTM-VARI.                                                     
           03 CTM-COD-TCPIP                 PIC X(06).                  
           03 CTM-COD-TRAN                  PIC X(12).                  
                                                                        
       01  WSS-IND-AMB       VALUE 'HST'     PIC X(03).                 
      *>                                                                 
      *> INPUT A RECIBIR DESDE EL PC                                     
      *>                                                                 
       01  WSS-FORM-RCV.                                                
           03 WSS-PC-A-TRADUCTOR.                                       
              05 WSS-HEADER.                                            
                 07 WSS-TRAN               PIC X(0012).                 
                                                                        
      *>**********************************************                   
                                                                        
       77  WSS-PT-CHR-01        VALUE SPACES   PIC X(01).               
       77  WSS-PT-LARG          VALUE ZEROES   PIC 9(05).               
       77  WSS-PT-IDX-PT-ORIG   VALUE ZEROES   PIC 9(05).               
       77  WSS-PT-IDX-PT-DEST   VALUE ZEROES   PIC 9(05).               
       77  WSS-PT-IDX-PT-PNTR   VALUE ZEROES   PIC 9(05).               
                                                                        
       77  WSS-PT-IDX-HDR-DEST  VALUE ZEROES   PIC 9(05).               
       77  WSS-PT-IDX-HDR-ORIG  VALUE ZEROES   PIC 9(05).               
                                                                        
       77  WSS-TX-IDX-ORIG      VALUE ZEROES   PIC 9(05).               
       77  WSS-TX-IDX-DEST      VALUE ZEROES   PIC 9(05).               
       77  WSS-TX-IDX-LARG      VALUE ZEROES   PIC 9(05).               
       77  WSS-TX-IDX-PNTR      VALUE ZEROES   PIC 9(05).               
                                                                        
       01  WSS-IDN-HDR.                                                 
           03  WSS-IDN-HDR-OCC           OCCURS 12 TIMES.               
               05  WSS-IDN-HDR-ELM             PIC X(01).               
                                                                        
       01  PTC-I24H-VARI.                                               
           03  PTC-I24H-TYPE  VALUE 'I24H'      PIC  X(04).             
           03  PTC-I24H-LENG  VALUE +20 COMP    PIC S9(04).             
                                                                        
       01  PTC-CNAL-VARI.                                               
           03  PTC-CNAL-TYPE  VALUE 'CNAL'      PIC  X(04).             
      *>    03  PTC-CNAL-LENG  VALUE +3 COMP     PIC S9(04).             
           03  PTC-CNAL-LENG  VALUE +15 COMP    PIC S9(04).             
       01  PTC-CNAL-ITEM.                                               
           03  PTC-CNAL-ITEM-CNAL               PIC X(03).              
           03  PTC-CNAL-ITEM-USER               PIC X(12).              
                                                                        
       77  WSS-IND-IBYA   VALUE 'N'             PIC X(01).              
       01  PTC-IBYA-VARI.                                               
           03  PTC-IBYA-TYPE  VALUE 'IBYA'      PIC  X(04).             
           03  PTC-IBYA-LENG  VALUE +1 COMP     PIC S9(04).             
                                                                        
      *> estas variables son manejadas por estructura anterior           
      *> estas varaibles se encontraban en GNSPPMTD.MUL                  
       01  WSS-BYA-VARI.                                                
           03 WSS-BYA-COLA.                                             
              05  WSS-BYA-TYPE VALUE 'MBYA'           PIC X(04).        
              05  WSS-BYA-TERM                        PIC X(04).        
           03 WSS-BYA-LITM COMP  VALUE +1             PIC S9(04).       
           03 WSS-BYA-ITEM                            PIC X(01).        
                                                                        
      *> SI EXISTE NO ACTUALIZA ARCHIVO VSAM SAFE, UTIL PARA SIMULACION  
       77  WSS-RBCK-SAFE   VALUE SPACES         PIC X(01).              
       01  PTC-SAFE-VARI.                                               
           03  PTC-SAFE-TYPE  VALUE 'SAFE'      PIC  X(04).             
           03  PTC-SAFE-LENG  VALUE +3 COMP     PIC S9(04).             
                                                                        
       77  PTC-WSS-BCKI-VAL  VALUE SPACES       PIC X(01).              
       77  PTC-WSS-BCKI-QUE  VALUE SPACES       PIC X(01).              
                                                                        
       01  PTC-BCKI-VARI.                                               
           03  PTC-BCKI-TYPE  VALUE 'BCKI'      PIC  X(04).             
           03  PTC-BCKI-LENG  VALUE +3 COMP     PIC S9(04).             
                                                                        
       01  WSS-HDR-VARI.                                                
           03 WSS-HDR-COLA.                                             
              05  WSS-HDR-TYPE VALUE 'MHDR'           PIC X(04).        
              05  WSS-HDR-TERM                        PIC X(04).        
           03 WSS-HDR-LITM COMP  VALUE +3             PIC S9(04).       
           03 WSS-HDR-ITEM.                                             
              05  WSS-HDR-LHDR                        PIC 9(03).        
                                                                        
      *> estas varaibles se encontraban en GNSPPMTD.MUL                  
       01  WSS-ERR-MNU-MENS.                                            
           03 WSS-ERR-MNU-MENS-1            PIC X(04).                  
           03 WSS-ERR-MNU-MENS-2            PIC X(13).                  
           03 WSS-ERR-MNU-MENS-3            PIC X(62).                  
                                                                        
      *> estas varaibles se encontraban en GNSPPMTD.MUL                  
       01  WSS-ABP-AMB.                                                 
           03 WSS-ABP-AMB-COD-MENS VALUE 'N' PIC X(01).                 
           03 WSS-ABP-AMB-GLS-MENS           PIC X(79).                 
                                                                        
      *>01  WSS-IND-QUE      VALUE SPACES      PIC X(03).                
                     
      *> CH-FIN
       01  WSS-XXXX    VALUE '(**)' PIC X(04).
        01 TSK-TX-RETURN-STATUS.
           05 TSK-TX-STATUS PIC S9(9) COMP-5.
                88 TSK-TX-NOT-SUPPORTED             VALUE 1.
      *> Normal execution
                88 TSK-TX-OK                        VALUE 0.
      *> Normal execution
                88 TSK-TX-OUTSIDE                   VALUE -1.
      *> Application is in an RM local transaction
                88 TSK-TX-ROLLBACK                  VALUE -2.
      *> Transaction was rolled back
                88 TSK-TX-MIXED                     VALUE -3.
      *> Transaction was partially committed and partially rolled
                88 TSK-TX-HAZARD                    VALUE -4.
      *> Transaction may have been partially committed and partial
      *> rolled back
                88 TSK-TX-PROTOCOL-ERROR            VALUE -5.
      *> Routine invoked in an improper context
                88 TSK-TX-ERROR                     VALUE -6.
      *> Transient error
                88 TSK-TX-FAIL                      VALUE -7.
      *> Fatal error
                88 TSK-TX-EINVAL                    VALUE -8.
      *> Invalid arguments were given
                88 TSK-TX-COMMITTED                 VALUE -9.
      *> The transaction was heuristically committed
                88 TSK-TX-NO-BEGIN                  VALUE -100.
      *> Transaction committed plus new transaction could not be s
                88 TSK-TX-ROLLBACK-NO-BEGIN         VALUE  -102.
      *> Transaction rollback plus new transaction could not be st
                88 TSK-TX-MIXED-NO-BEGIN            VALUE  -103.
      *> Mixed plus new transaction could not be started
                88 TSK-TX-HAZARD-NO-BEGIN           VALUE  -104.
      *> Hazard plus new transaction could not be started
                88 TSK-TX-COMMITTED-NO-BEGIN        VALUE  -109.
      *> Heuristically committed plus transaction could not be sta
      *>
        01 TSK-TX-INFO-AREA.
      *> XID record
           05 TSK-XID-REC.
              10 TSK-FORMAT-ID        PIC S9(9) COMP-5.
      *> A value of -1 in FORMAT-ID means that the XID is null
              10 TSK-GTRID-LENGTH     PIC S9(9) COMP-5.
              10 TSK-BRANCH-LENGTH    PIC S9(9) COMP-5.
              10 TSK-XID-DATA         PIC X(128).
      *> Transaction mode settings
           05 TSK-TRANSACTION-MODE     PIC S9(9) COMP-5.
              88 TSK-TX-NOT-IN-TRAN   VALUE 0.
              88 TSK-TX-IN-TRAN       VALUE 1.
      *> Commit_return settings
           05 TSK-COMMIT-RETURN        PIC S9(9) COMP-5.
              88 TSK-TX-COMMIT-COMPLETED          VALUE 0.
              88 TSK-TX-COMMIT-DECISION-LOGGED    VALUE 1.
      *> Transaction_control settings
           05 TSK-TRANSACTION-CONTROL  PIC S9(9) COMP-5.
              88 TSK-TX-UNCHAINED     VALUE 0.
              88 TSK-TX-CHAINED       VALUE 1.
      *> Transaction_timeout value
           05 TSK-TRANSACTION-TIMEOUT  PIC S9(9) COMP-5.
              88 NO-TIMEOUT       VALUE 0.
      *> Transaction_state information
           05 TSK-TRANSACTION-STATE    PIC S9(9) COMP-5.
              88 TSK-TX-ACTIVE        VALUE 0.
              88 TSK-TX-TIMEOUT-ROLLBACK-ONLY     VALUE 1.
              88 TSK-TX-ROLLBACK-ONLY             VALUE 2.
      
      
        01 TPTRXLEV-REC.
      *>
      *>  TPTRXLEV.cbl
      *>
        05 TPTRXLEV-FLAG           PIC S9(9) COMP-5.
                88 TP-NOT-IN-TRAN  VALUE 0.
                88 TP-IN-TRAN      VALUE 1.
      *>
      
        01 TPTRXDEF-REC.
      *>
      *>  TPTRXDEF.cbl
      *>
        05 T-OUT        PIC S9(9) COMP-5 VALUE IS 0.
        05 TRANID       OCCURS 6 TIMES PIC S9(9) COMP-5.
      
      
      
      
      
       01  TSK-VARI.                                                    
      
            03 TSK-TERM-ORIGEN    VALUE 'N'           PIC  X(01).       
      
            03 TSK-TRANID.
               05 TSK-TRANID-1                        PIC S9(10).
               05 TSK-TRANID-2                        PIC S9(10).
               05 TSK-TRANID-3                        PIC S9(10).
               05 TSK-TRANID-4                        PIC S9(10).
               05 TSK-TRANID-5                        PIC S9(10).
               05 TSK-TRANID-6                        PIC S9(10).
            03 TSK-TRANID-ALF REDEFINES   TSK-TRANID  PIC  X(60).       
      
            03 TSK-INFO-TRAN.
               05 TSK-INFO-TRANID                     PIC 9(07).
               05 TSK-INFO-TRANID-ALF REDEFINES 
                                    TSK-INFO-TRANID   PIC X(07).        
               05 TSK-INFO-COMMIT                     PIC 9(01).
      
            03 TSK-TERM-NUM               COMP-3      PIC S9(07).       
            03 TSK-TERM-ALF REDEFINES   TSK-TERM-NUM  PIC  X(04).       
      
            03 TSK-TERM-TUX                           PIC  X(256).  
            
            03 TSK-TERM-NUM-TUX                       PIC  9(07).       
            03 TSK-TERM-NUM-TUX-ALF REDEFINES 
                                    TSK-TERM-NUM-TUX  PIC  X(07).       
      
            03 TSK-TERM-NUM-TUX-6                     PIC  9(06).       
            03 TSK-TERM-NUM-TUX-ALF-6 REDEFINES 
                                  TSK-TERM-NUM-TUX-6  PIC  X(06).       
      
      
      
       01  HEADER-VARI.
           03 HEADER-NOM-TSPT.
              05 HEADER-COD-TERM   VALUE 'HE'              PIC X(02).   
              05 HEADER-COD-TYPE   VALUE SPACES            PIC X(06).   
      
       01  HEADER-MENS VALUE SPACES.                              
           03 HEADER-VERS                        PIC X(00004).
           03 HEADER-BNCO                        PIC X(00003).
           03 HEADER-MRCA                        PIC X(00003).
           03 HEADER-CART                        PIC X(00003).
           03 HEADER-LENG                        PIC X(00002).
           03 HEADER-PAIS                        PIC X(00002).
           03 HEADER-VRNT                        PIC X(00001).
           03 HEADER-USER                        PIC X(00012).
           03 HEADER-CNAL                        PIC X(00005).
           03 HEADER-UMUA                        PIC X(00012).
           03 HEADER-PROG                        PIC X(00008).
           03 HEADER-IBYA                        PIC X(00001).
           03 HEADER-BCKI                        PIC X(00001).
           03 HEADER-I24H                        PIC X(00001).
           03 HEADER-MODO                                    
                          REDEFINES HEADER-I24H PIC X(00001).           
           03 HEADER-MNSF                        PIC X(00001).
           03 HEADER-ORIG                        PIC X(00003).
           03 HEADER-MSGC                        PIC X(00001).
           03 HEADER-MSGM                        PIC X(00001).
           03 HEADER-DIS1                        PIC X(00026).
           03 HEADER-IREQ.                                    
              05 HEADER-IR01                     PIC X(00001).
              05 HEADER-IR02                     PIC X(00001).
              05 HEADER-IR03                     PIC X(00001).
              05 HEADER-IR04                     PIC X(00001).
              05 HEADER-IR05                     PIC X(00001).
              05 HEADER-IR06                     PIC X(00001).
              05 HEADER-IR07                     PIC X(00001).
              05 HEADER-IR08                     PIC X(00001).
              05 HEADER-IR09                     PIC X(00001).
              05 HEADER-IR10                     PIC X(00001).
      
      
      
      
       01  MULMSG-VARI.
           03 MULMSG-NOM-TSPT.
              05 MULMSG-COD-TERM   VALUE SPACES  PIC X(04).       
              05 MULMSG-COD-TYPE   VALUE 'MMSG'  PIC X(04).       
      
       01  MULMSG-MENS VALUE SPACES.                              
           03 MULMSG-TIPO                        PIC X(00001).
           03 MULMSG-FORM                        PIC X(00003).
           03 MULMSG-SIST                        PIC X(00003).
           03 MULMSG-CODI                        PIC X(00012).
           03 MULMSG-DATO                        PIC X(01005).
      
      
      
                     
      *>    Variables para Rutinas del Sistema. GNSWGSYS V-3.1
       01  SYS-VARI.
      *>    Variables para Current-Date
           03 SYS-FHOY-2B.
              05 SYS-AHOY-2B                   PIC 9(02).
              05 SYS-MHOY-2B                   PIC 9(02).
              05 SYS-DHOY-2B                   PIC 9(02).
           03 SYS-SHOY                         PIC 9(02).
           03 SYS-FHOY.
              05 SYS-DHOY                      PIC 9(02).
              05 SYS-SLH1                      PIC X(01).
              05 SYS-MHOY                      PIC 9(02).
              05 SYS-SLH2                      PIC X(01).
              05 SYS-AHOY                      PIC 9(02).
           03 SYS-HHOY-2B  VALUE ZEROES        PIC 9(08).
           03 SYS-HHOY-2B-RED REDEFINES SYS-HHOY-2B.
              05 SYS-HHHY-2B                   PIC 9(02).
              05 SYS-MMHY-2B                   PIC 9(02).
              05 SYS-SSHY-2B                   PIC 9(02).
              05 SYS-CCHY-2B                   PIC 9(02).
           03 SYS-HHOY  VALUE ZEROES           PIC 9(06).
           03 SYS-HHOY-RED REDEFINES SYS-HHOY.
              05 SYS-HHHY                      PIC 9(02).
              05 SYS-MMHY                      PIC 9(02).
              05 SYS-SSHY                      PIC 9(02).
           03 SYS-JHOY                         PIC 9(05).
           03 SYS-JHOY-RED REDEFINES SYS-JHOY.
              05 SYS-AAHY                      PIC 9(02).
              05 SYS-DDHY                      PIC 9(03).
           03 SYS-TSTP.
              05 SYS-SSTP                      PIC 9(02).
              05 SYS-FSTP.
                 07 SYS-AATS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-DDTS                   PIC 9(02).
              05 SYS-HSTP                      PIC 9(06).
              05 SYS-HSTP-RED REDEFINES SYS-HSTP.
                 07 SYS-HHTS                   PIC 9(02).
                 07 SYS-MMTS                   PIC 9(02).
                 07 SYS-SSTS                   PIC 9(02).
      *>    Tamano de Communication Area
           03 SYS-TCMA  COMP                   PIC S9(4).
      *>    Communication Area
           03 SYS-CMMA.
              05 SYS-SCR-MENS                  PIC X(79).
              05 SYS-SCR-VARI                  PIC X(3421).
      *>INI-PENTA TUXEDO ORACLE
              05 SYS-SCR-NTRN                  PIC X(04).
      *>FIN-PENTA TUXEDO ORACLE
      *>    Transaccion
           03 SYS-NTRN                         PIC X(04).
      *>    Programa
           03 SYS-PROG                         PIC X(08).
           03 SYS-PROG-RED REDEFINES SYS-PROG
                                      OCCURS 8 PIC X(01).
      *>    Programa a ABorTo
           03 SYS-PABT  VALUE 'GNSPPABT'       PIC X(08).
      *>    Comando
           03 SYS-CMND                 VALUE 0 PIC 9(02).
      *>    Mensaje
           03 SYS-MENS.
              05 SYS-MEN1                      PIC X(40).
              05 SYS-MEN2                      PIC X(40).
      *>    Resto
           03 SYS-REST                         PIC 9(01).
      *>    Indice
           03 SYS-SIND                         PIC 9(02).
      *>    Status
           03 SYS-STAT                         PIC X(02).
           03 SYS-STAT-OKS        VALUE '00'   PIC X(02).
           03 SYS-STAT-NUM                     PIC 9(02).
      *>    Indicador de Handler
           03 SYS-IHDL            VALUE SPACES PIC X(01).
      *> MHM-INI 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *>    Indicador de Abend
           03 SYS-ABND            VALUE ' '    PIC X(01).
              88 SYS-ABND-YES     VALUE 'S'.
      
      *> MHM-FIN 28-FEB-2011 MODERNIZACION MIGRACION DB2
      *> IMV-INI 01-JUL-2014 MARCA SIMULACION FUTURA
           03 SYS-SMFT            VALUE 'N'    PIC X(01).
      *> IMV-FIN 01-JUL-2014 MARCA SIMULACION FUTURA
      
      *>INI-PENTA TUXEDO ORACLE
      
      *>    FLAG SERVICIO DE FECHA
           03 SYS-HORA-HABI      VALUE 'N'     PIC X(01).
           03 SYS-HORA-FLAG      VALUE 'N'     PIC X(01).
      
      
       01 EIBTRMID       VALUE SPACES          PIC X(04).
       01 EIBTRNID       VALUE SPACES          PIC X(04).
       01 EIBTASKN       VALUE SPACES          PIC X(04).
       01 EIBCALEN       VALUE 1               PIC 9(04).
       01 EIBAID         VALUE ''''            PIC X(01).
       01 EIBRESP        VALUE 0               PIC S9(04).
      
       01 EIBTASKN-1.
          03 EIBTASKN-11 VALUE SPACES          PIC X(04).
          03 EIBTASKN-12 VALUE SPACES          PIC X(04).
      *> Variables genericas para servicio de fecha y hora
       01  FYH-VARI.
           03  FYH-PROG            VALUE 'GNSPPFYH' PIC X(08).
           03  FYH-TCMA            VALUE 22         PIC 9(08).
           03  FYH-CMSG            VALUE SPACES     PIC X(12).
           03  FYH-MENS.
               05 FYH-MEN2         VALUE SPACES     PIC X(40).
      *>    MENSAJE
           03  FYH-CMMA.
               05 FYH-GLS-RSPT.
      *>           FECHA
                  07 FYH-FEC-FHOY.
                     09 FYH-NUM-SHOY                PIC 9(02).
                     09 FYH-NUM-AHOY                PIC 9(02).
                     09 FYH-NUM-MHOY                PIC 9(02).
                     09 FYH-NUM-DHOY                PIC 9(02).
      *>           HORA
                  07 FYH-HRA-HHOY.
                     09 FYH-NUM-HHHY                PIC 9(02).
                     09 FYH-NUM-MMHY                PIC 9(02).
                     09 FYH-NUM-SSHY                PIC 9(02).
      *>           JULIANO
                  07 FYH-NUM-JULI                   PIC 9(08).
      
      *>FIN-PENTA TUXEDO ORACLE
      *>
      *>    Constantes para Rutinas del Sistema.
       01  SYS-CTTS.
      *>    Comandos
           03 SYS-GET-DATE             VALUE 1 PIC 9(01).
           03 SYS-GET-TIME             VALUE 2 PIC 9(01).
           03 SYS-RTRN                 VALUE 3 PIC 9(01).
           03 SYS-XCTL                 VALUE 4 PIC 9(01).
           03 SYS-LINK                 VALUE 5 PIC 9(01).
           03 SYS-ABOR                 VALUE 6 PIC 9(01).
      *>    Cantidad de Dias Acumulados en cada Mes
           03 SYS-VACU VALUE '000031060091121152182213244274305335'.
              05 SYS-DACU       OCCURS 12      PIC 9(03).
                     
      *>    Archivo de Menu
      *>    ---------------
      *>
      *>    Nombre Registro : MNU
      *>    Clave(s)        : MNU-COD-NEMS(UU),MNU-COD-OPCS(UC),
      *>                      MNU-COD-IMES(UC)
      *>    Largo           : 492
      *>    Bloqueo         : 1
      *>    Observaciones   :
      *>
       01  MNU.
      *>
      *>       Filler Compatibilidad VSAM/MVS
           03 MNU-GLS-FLAG                              PIC X(01).
      *>
      *>       Llave primaria nemotecnica
           03 MNU-COD-NEMS.
      *>
      *>       Llave primaria nemotecnica OLD
              05 MNU-COD-NEMO.
      *>
      *>          Sistema
                 07 MNU-COD-SYST                        PIC X(03).
      *>
      *>          Codigo accion
                 07 MNU-COD-CACC                        PIC X(03).
      *>
      *>          Codigo de Funcion
                 07 MNU-COD-FUNC.
      *>
      *>             Entidad
                    09 MNU-COD-ENTI                     PIC X(03).
      *>
      *>             Comando
                    09 MNU-COD-COMD                     PIC X(03).
      *>
           03 MNU-COD-OPCS.
      *>
              05 MNU-COD-IPCN.
      *>       Llave secundaria 1: Opcion
                 07 MNU-COD-OPCI                        PIC X(03).
      *>
      *>       Llave secundaria 2: Menu + Ordinal
           03 MNU-COD-IMES.
      *>
              05 MNU-COD-IMEN.
      *>          Codigo menu
                 07 MNU-COD-CMEN                        PIC X(03).
      *>
      *>          Ordinal
                 07 MNU-NUM-ORDI                        PIC 9(03).
      *>
      *>CAH-INI 12-MAY-1998
      *>    Time Stamp Transaccion
      *>     03  MNU-STP-ITRN.
      *>
      *>        Fecha Transaccion
      *>         05  MNU-FEC-FTRN.
      *>             07  MNU-NUM-STRN                 PIC 9(02).
      *>             07  MNU-NUM-ATRN                 PIC 9(02).
      *>             07  MNU-NUM-MTRN                 PIC 9(02).
      *>             07  MNU-NUM-DTRN                 PIC 9(02).
      *>
      *>            Hora Transaccion
      *>         05  MNU-HRA-HRTR.
      *>             07  MNU-NUM-HHTR                 PIC 9(02).
      *>             07  MNU-NUM-MMTR                 PIC 9(02).
      *>             07  MNU-NUM-SSTR                 PIC 9(02).
      *>
      *>REQ Indicador Tipo Accion
      *>     03  MNU-MSC-TACC                             PIC X(01).
      *>
      *>    Indicador Status
      *>     03  MNU-MSC-STAT                             PIC X(01).
      *>
      *>REQ Codigo Origen Transaccion
      *>     03  MNU-COD-OTRN.
      *>
      *>        Indicador Tipo Origen
      *>         05  MNU-MSC-TTRN                         PIC X(01).
      *>
      *>        Codigo Tipo Origen
      *>         05  MNU-COD-TTRN                         PIC X(03).
      *>
      *>REQ Autor Transaccion
      *>     03  MNU-COD-ATRN                             PIC X(12).
      *>
      *>       Tipo funcion
           03 MNU-COD-TFUN                              PIC X(03).
      *>
      *>       Glosa funcion menu
           03 MNU-GLS-FMEN                              PIC X(30).
      *>
      *>       Comando
           03 MNU-GLS-CMND.
      *>
      *>          Prefijo comando
              05 MNU-GLS-COMD                           PIC X(12).
      *>
      *>          Programa
              05 MNU-GLS-PROG                           PIC X(12).
      *>
      *>          Resto comando
              05 MNU-GLS-FILL                           PIC X(29).
      *>
      *>       Transaccion
           03 MNU-GLS-TRAN                              PIC X(04).
      *>
      *>       Comando ingreso programa
           03 MNU-COD-CMND                              PIC X(03).
      *>
      *>       Biblioteca documentacion.
           03 MNU-GLS-LDOC                              PIC X(07).
      *>
      *>       Nombre modulo documentacion
           03 MNU-GLS-NDOC                              PIC X(24).
      *>
      *>       Biblioteca formulario
           03 MNU-GLS-LFRM                              PIC X(07).
      *>
      *>       Nombre formulario
           03 MNU-GLS-NFRM                              PIC X(07).
      *>
      *>       Glosa funcion programa
           03 MNU-GLS-FPRO                              PIC X(30).
      *>
      *>       Fila
           03 MNU-NUM-FILA          COMP                PIC S9(02).
      *>
      *>       Columna
           03 MNU-NUM-COLU          COMP                PIC S9(02).     
      
      *>
      *>       Funcion retorno  (default)
           03 MNU-COD-FRET                              PIC X(12).
      *>
      *>       Indicador confirmacion
           03 MNU-IND-CONF                              PIC X(01).
      *>
      *>       Menu
           03 MNU-COD-MENU                              PIC X(03).
      *>
      *>       Indicador de privilegios
           03 MNU-IND-IPRV                              PIC X(01).
      *>
      *>       Instancia ingreso programa
           03 MNU-COD-INST                              PIC X(03).
      *>
      *>       Indicador si expande o no glosa de menu
           03 MNU-IND-EXGL                              PIC X(01).
      *>
      *>       Indicador transferencia de control
           03 MNU-IND-SEQU                              PIC X(03).
      *>
      *>       Sistema
           03 MNU-COD-SIST                              PIC X(03).
      *>
      *>       Codigo de traspaso de control al programa
           03 MNU-COD-TCTL                              PIC X(04).
      *>
      *>       Accion a ejecutar sobre formulario
           03 MNU-COD-EJFR                              PIC X(03).
      *>
      *>       Funcion anterior
           03 MNU-COD-FANT                              PIC X(12).
      *>
      *>       Codigo Tabla
           03 MNU-COD-TABL.
              05 MNU-COD-TTAB                           PIC X(03).
              05 MNU-COD-CTAB                           PIC X(12).
      *>
      *>       Indicador clear
           03 MNU-IND-NCLR                              PIC X(01).
      *>
      *>       Biblioteca formulario para VAX
           03 MNU-GLS-LFVX                              PIC X(07).
      *>
      *>       Nombre formulario para VAX
           03 MNU-GLS-NFVX                              PIC X(07).
      *>
      *>       Programa
           03 MNU-GLS-PRGM                              PIC X(08).
      *>
      *>       Independencia Fisica Datos
           03 MNU-COD-CIFD                              PIC X(12).
      *>
      *>       Codigo de traspaso de informacion al programa
           03 MNU-COD-TINF                              PIC X(03).
      *>
      *>       Modalidad de Salida del programa
           03 MNU-COD-MSAL                              PIC X(03).
      *>
      *>       Accion a ejecutar con pantalla
           03 MNU-COD-ASCR                              PIC X(01).
      *>
      *>       Accion a ejecutar con mapa programa
           03 MNU-COD-AMPG                              PIC X(01).
      *>
      *>       Nombre Mapa Header
           03 MNU-GLS-NMHD                              PIC X(07).
      *>
      *>       Libreria Mapa Header
           03 MNU-GLS-LMHD                              PIC X(07).
      *>
      *>       Accion a ejecutar con mapa header
           03 MNU-COD-AMHD                              PIC X(01).
      *>
      *>       Nombre Mapa Comandos
           03 MNU-GLS-NMCM                              PIC X(07).
      *>
      *>       Libreria Mapa Comandos
           03 MNU-GLS-LMCM                              PIC X(07).
      *>
      *>       Accion a ejecutar con Mapa comandos
           03 MNU-COD-AMCM                              PIC X(01).
      *>
      *>       Usa IDD
           03 MNU-COD-UIDD                              PIC X(03).
      *>
      *>       Disponible Futuras Ampliaciones
           03 MNU-GLS-DISP                              PIC X(118).
      *>
      *>    Variables de Menu
       01  MNU-VARI.
      *>
      *>    Nombre de Programa FIO para Menu
           03  MNU-GLS-FMNU.
      *>
      *>        Codigo Sistema
               05  MNU-COD-STMA                         PIC X(03).
      *>
      *>        Nombre "fijo" de FIO Menu
               05  MNU-COD-FMNU           VALUE 'PFMNU' PIC X(05).
      *>
                     
      *>        RELACION PROGRAMA - FORMULARIO                           
      *>
      *>    Nombre Registro : RPF
      *>    Clave(s)        : RPF-COD-DPTS(UU)
      *>    Largo           : 128
      *>    Bloqueo         : 1
      *>    Observaciones   :
      *>
       01  RPF.                                                         
      *>                                                                 
      *>    FILLER COMPATIBILIDAD VSAM/MVS                               
      *>    03 RPF-GLS-FLAG                         PIC X(01).           
      *>                                                                 
           03 RPF-COD-DPTS.
      *>
      *>        DESCRIPCION PROGRAMA + TIPO REGISTRO (LLAVE)             
               05 RPF-COD-DPTR.
      *>                                                                 
      *>        DESCRIPCION PROGRAMA                                     
                  07 RPF-COD-DPRO                      PIC X(12).
      *>                                                                 
      *>        TIPO REGISTRO Y CORRELATIVO                              
      *>          A   =   AUTOR                                          
      *>          B   =   ARCHIVO BASE                                   
      *>          C   =   COMANDOS                                       
      *>          C0  =   COMANDO 0                                      
      *>          C1  =   COMANDO 1                                      
      *>          .                                                      
      *>          .                                                      
      *>          C9  =   COMANDO 9                                      
      *>          P1  =   FORMULARIO 1                                   
      *>          .                                                      
      *>          .                                                      
      *>          P9  =   FORMULARIO 9                                   
      *>          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA        
      *>           0  =   LLAVE                                          
      *>           1  =   VARIABLE 1                                     
      *>           .                                                     
      *>           .                                                     
      *>           9  =   VARIABLE 9                                     
      *>                                                                 
                  07 RPF-COD-TRYC.
      *>                                                                 
      *>        TIPO REGISTRO                                            
                    09 RPF-COD-TREG                    PIC X(01).
      *>                                                                 
      *>        CORRELATIVO                                              
                 09 RPF-COD-CORR                       PIC 9(01).
      *>                                                                 
      *>        DESCRIPCION ARCHIVOS                                     
                  07 RPF-COD-DARC                      PIC X(08).
      *>                                                                 
           03 RPF-KEY-DPTS REDEFINES RPF-COD-DPTS.
      *>
               05 RPF-KEY-DPTR.
      *>        DESCRIPCION PROGRAMA                                     
                  07 RPF-KEY-DPRO                      PIC X(12).
      *>                                                                 
      *>        TIPO REGISTRO Y CORRELATIVO                              
      *>          A   =   AUTOR                                          
      *>          B   =   ARCHIVO BASE                                   
      *>          C   =   COMANDOS                                       
      *>          C0  =   COMANDO 0                                      
      *>          C1  =   COMANDO 1                                      
      *>          .                                                      
      *>          .                                                      
      *>          C9  =   COMANDO 9                                      
      *>          P1  =   FORMULARIO 1                                   
      *>          .                                                      
      *>          .                                                      
      *>          P9  =   FORMULARIO 9                                   
      *>          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA        
      *>           0  =   LLAVE                                          
      *>           1  =   VARIABLE 1                                     
      *>           .                                                     
      *>           .                                                     
      *>           9  =   VARIABLE 9                                     
      *>                                                                 
                  07 RPF-KEY-TRYC.
      *>                                                                 
      *>        TIPO REGISTRO                                            
                    09 RPF-KEY-TREG                    PIC X(01).
      *>                                                                 
      *>        CORRELATIVO                                              
                 09 RPF-KEY-CORR                       PIC 9(01).       
      *>                                                                 
      *>        DESCRIPCION ARCHIVOS                                     
                  07 RPF-KEY-DARC                      PIC X(08).
      *>
      *>CAH-INI 12-MAY-1998
      *>    Time Stamp Transaccion
      *>     03  RPF-STP-ITRN.
      *>
      *>        Fecha Transaccion
      *>         05  RPF-FEC-FTRN.
      *>             07  RPF-NUM-STRN                 PIC 9(02).
      *>             07  RPF-NUM-ATRN                 PIC 9(02).
      *>             07  RPF-NUM-MTRN                 PIC 9(02).
      *>             07  RPF-NUM-DTRN                 PIC 9(02).
      *>
      *>            Hora Transaccion
      *>         05  RPF-HRA-HRTR.
      *>             07  RPF-NUM-HHTR                 PIC 9(02).
      *>             07  RPF-NUM-MMTR                 PIC 9(02).
      *>             07  RPF-NUM-SSTR                 PIC 9(02).
      *>
      *>REQ Indicador Tipo Accion
      *>     03  RPF-MSC-TACC                             PIC X(01).
      *>
      *>    Indicador Status
      *>     03  RPF-MSC-STAT                             PIC X(01).
      *>
      *>REQ Codigo Origen Transaccion
      *>     03  RPF-COD-OTRN.
      *>
      *>        Indicador Tipo Origen
      *>         05  RPF-MSC-TTRN                         PIC X(01).
      *>
      *>        Codigo Tipo Origen
      *>         05  RPF-COD-TTRN                         PIC X(03).
      *>
      *>REQ Autor Transaccion
      *>     03  RPF-COD-ATRN                             PIC X(12).
      *>
      *>        DATO ANEXO                                               
           03 RPF-GLS-DATA                         PIC X(70).           
      *>                                                                 
           03 RPF-GLS-DAT1 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION AUTOR                                        
              05 RPF-GLS-DAUT                      PIC X(42).           
      *>                                                                 
      *>        CODIGO INDEPEDENCIA FISICA DE DATOS                      
              05 RPF-COD-CIFD                      PIC X(12).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS1                      PIC X(16).           
      *>                                                                 
           03 RPF-GLS-DAT2 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        ARCHIVO BASE                                             
              05 RPF-GLS-ABAS                      PIC X(08).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS2                      PIC X(62).           
      *>                                                                 
           03 RPF-GLS-DAT3 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-COD-DIS3                      PIC X(03).           
      *>                                                                 
      *>        GLOSA COMANDOS                                           
              05 RPF-GLS-DCMN                      PIC X(25).           
      *>                                                                 
      *>        GLOSA ABORTO                                             
              05 RPF-GLS-ABRT                      PIC X(25).           
      *>                                                                 
      *>        SUBRUTINA ALTERNATIVA COMANDOS                           
              05 RPF-GLS-UARA                      PIC X(12).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS3                      PIC X(05).           
      *>                                                                 
           03 RPF-GLS-DAT4 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        CODIGO COMANDO                                           
              05 RPF-COD-CCMN                      PIC X(03).           
      *>                                                                 
      *>        GLOSA PROMPT                                             
              05 RPF-GLS-PRMT                      PIC X(25).           
      *>                                                                 
      *>        GLOSA CONFIRMACION                                       
              05 RPF-GLS-CONF                      PIC X(25).           
      *>                                                                 
      *>        SUBRUTINA COMANDO                                        
              05 RPF-GLS-UARC                      PIC X(12).           
      *>                                                                 
      *>        CODIGO COMANDO PARA PROGRAMA                             
              05 RPF-COD-CCPP                      PIC X(03).           
      *>                                                                 
      *>        ESTADO COMANDO PARA PROGRAMA                             
              05 RPF-IND-STPP                      PIC X(01).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS4                      PIC X(01).           
      *>                                                                 
           03 RPF-GLS-DAT5 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION BIBLIOTECA DE FORMULARIO                     
              05 RPF-GLS-LFRM                      PIC X(06).           
      *>                                                                 
      *>        DESCRIPCION DE FORMULARIO                                
              05 RPF-GLS-NFRM                      PIC X(06).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS5                      PIC X(58).           
      *>                                                                 
           03 RPF-GLS-DAT6 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        LUGAR DEL CODIGO EN PROGRAMA                             
              05 RPF-KEY-LCEP                      PIC X(02).           
      *>                                                                 
      *>        FORMULARIO DEL CODIGO EN PROGRAMA                        
              05 RPF-KEY-FCEP                      PIC X(06).           
      *>                                                                 
      *>        VARIABLE DEL CODIGO EN PROGRAMA                          
              05 RPF-KEY-VCEP                      PIC X(32).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS6                      PIC X(30).           
      *>                                                                 
           03 RPF-GLS-DAT7 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION LLAVE                                        
              05 RPF-GLS-DKEY                      PIC X(10).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS7                      PIC X(60).           
      *>                                                                 
           03 RPF-GLS-DAT8 REDEFINES RPF-GLS-DATA.                      
      *>                                                                 
      *>        DESCRIPCION VARIABLE PARA FORMAR LLAVE                   
              05 RPF-GLS-DVAR                      PIC X(32).           
      *>                                                                 
      *>        FILLER                                                   
              05 RPF-GLS-DIS8                      PIC X(38).           
      *>
                     
      
      
                                                                        
      *> ISP: VECTOR PARA ESTRUCTURAR REGISTRO IMAGEN HOST               
      *> LENGTH = 2014                                                   
       01  TSI.                                                         
           03 TSI-NUM-RECO                   PIC 9(03).                 
           03 TSI-DATA.                                                 
              05 TSI-COD-MSJE                PIC X(12).                 
              05 TSI-GLS-MSJE                PIC X(79).                 
              05 TSI-GLS-FRM-HST     VALUE  SPACES.                     
                 07 TSI-GLS-NFRM                       PIC X(12).       
                 07 TSI-COD-FRM-HST OCCURS 1908 TIMES  PIC X(01).       
                     
      *> COPY GNSBRABP.
                                                                        
      *> ISP: VECTOR PARA ESTRUCTURAR REGISTRO IMAGEN HOST               
       01  TSO.                                                         
           03 TSO-NUM-RECO                   PIC 9(03).                 
           03 TSO-DATA.                                                 
              05 TSO-MSJE.                                              
                 07 TSO-COD-MSJE             PIC X(12).                 
                 07 TSO-GLS-MSJE             PIC X(79).                 
              05 TSO-GLS-FRM-HST     VALUE  SPACES.                     
                 07 TSO-COD-FRM-HST OCCURS 1920 TIMES  PIC X(01).       
                                                                        
                     
      *> Estructura de cada pantalla ( Header y datos )                  
       01  TDI-FRM VALUE SPACES.                                        
           03 TDI-HDR-FRM.                                              
              05 TDI-COD-SIST-FRM               PIC X(03).              
              05 TDI-COD-NEMO-FRM               PIC X(12).              
              05 TDI-COD-FINP-FRM               PIC X(03).              
              05 TDI-COD-FOUT-FRM               PIC X(03).              
              05 TDI-GLS-DISP-FRM               PIC X(1899).            
       01  TDI-GLS-DESC-FRM REDEFINES TDI-FRM.                          
              05  TDI-COD-TDI-FRM OCCURS 1920                           
                                          TIMES PIC X(01).              
      *> 01  TDI-LTDI      VALUE +1260 COMP       PIC S9(04).            
       01  TDI-LTDI      VALUE +4063 COMP       PIC S9(04).             
       01  TDI-FIO-TERM                         PIC X(04).              
                     
      *> Estructura de cada pantalla ( Header y datos )                  
       01  TDO-FRM VALUE SPACES.                                        
           03 TDO-HDR-FRM.                                              
              05 TDO-COD-SIST-FRM               PIC X(03).              
              05 TDO-COD-NEMO-FRM               PIC X(12).              
              05 TDO-COD-NFRM-FRM               PIC X(07).              
              05 TDO-COD-FINP-FRM               PIC X(03).              
              05 TDO-COD-FOUT-FRM               PIC X(03).              
              05 TDO-GLS-DISP-FRM               PIC X(1892).            
       01  TDO-GLS-DESC-FRM REDEFINES TDO-FRM.                          
              05  TDO-COD-TDO-FRM OCCURS 1920                           
                                          TIMES PIC X(01).              
      *> 01  TDO-LTDO      VALUE +1260 COMP       PIC S9(04).            
       01  TDO-LTDO      VALUE +4063 COMP       PIC S9(04).             
       01  TDO-FIO-TERM                         PIC X(04).              
                     
      *> ISP: VARIABLE INDICE DE ESTRUCTURA REGISTRO IMAGEN              
      *>      POSICION DE INICIO                                         
       01  TSI-IDX-FRM-HST VALUE 1              PIC 9(05).              
       01  TSI-FIO-TERM                         PIC X(04).              
                     
      *> COPY GNSWGABP.
      *> ISP: VARIABLE INDICE DE ESTRUCTURA REGISTRO IMAGEN              
      *>      POSICION DE INICIO                                         
       01  TSO-IDX-FRM-HST VALUE 13             PIC 9(05).              
       01  TSO-FIO-TERM                         PIC X(04).              
                     
      
      *> ISP  11-NOV-1992
      *>
      *> BCI-COPY
      *>COPY GNSWVPCC.
       01  SCR-VARI.                                                    
           03 SCR-TCMA  COMP              PIC S9(04).                   
           03 SCR-SIST                    PIC X(03).                    
           03 SCR-SISG                    PIC X(03).                    
           03 SCR-NTRN                    PIC X(04).                    
           03 SCR-PROG                    PIC X(08).                    
           03 SCR-NTRV                    PIC X(04).                    
           03 SCR-PROV                    PIC X(08).                    
           03 SCR-NLIB                    PIC X(07).                    
           03 SCR-NMAP                    PIC X(07).                    
           03 SCR-RFBY                    PIC X(01).                    
           03 SCR-STAT                    PIC X(01).                    
           03 SCR-INST                    PIC X(03).                    
           03 SCR-ACTU                    PIC X(03).                    
           03 SCR-CMNP                    PIC X(08).                    
           03 SCR-CRPF.                                                 
              05 SCR-CMND                 PIC X(03).                    
              05 SCR-CCPP                 PIC X(03).                    
              05 SCR-STPP                 PIC X(01).                    
              05 SCR-PRMT                 PIC X(25).                    
              05 SCR-CONF                 PIC X(25).                    
           03 SCR-USER                    PIC X(12).                    
           03 SCR-OTRN                    PIC X(04).                    
           03 SCR-UMOD                    PIC X(14).                    
           03 SCR-ICMN                    PIC X(01).                    
              88 SCR-DESDE-MEN VALUE 'M'.                               
              88 SCR-DESDE-HDR VALUE 'H'.                               
              88 SCR-DESDE-CMN VALUE 'C'.                               
              88 SCR-DESDE-PGM VALUE 'P'.                               
           03 SCR-QIDD                    PIC X(08).                    
           03 SCR-LIDD COMP               PIC S9(04).                   
      *>                                                                 
           03 SCR-NEMO                    PIC X(12).                    
           03 SCR-LDOC                    PIC X(12).                    
      *>    03 SCR-NDOC  PIC X(25).                                      
           03 SCR-NDOC.                                                 
              05 SCR-HDR-BNCO             PIC X(00003).                 
              05 SCR-HDR-MRCA             PIC X(00003).                 
              05 SCR-HDR-CART             PIC X(00003).                 
              05 SCR-HDR-LENG             PIC X(00002).                 
              05 SCR-HDR-PAIS             PIC X(00002).                 
              05 SCR-HDR-VRNT             PIC X(00001).                 
              05 SCR-NDOC-DISP            PIC X(00011).                 
           03 SCR-FRET                    PIC X(12).                    
           03 SCR-IPRV                    PIC X(01).                    
      *>                                                                 
           03 SCR-MFLD                    PIC X(01).                    
           03 SCR-VFLD                    PIC X(01).                    
           03 SCR-FFLD                    PIC X(01).                    
              88 SCR-FFLD-RET   VALUE ''''.                             
              88 SCR-FFLD-PF1   VALUE '1'.                              
              88 SCR-FFLD-PF2   VALUE '2'.                              
              88 SCR-FFLD-PF3   VALUE '3'.                              
              88 SCR-FFLD-PF4   VALUE '4'.                              
              88 SCR-FFLD-PF5   VALUE '5'.                              
              88 SCR-FFLD-PF6   VALUE '6'.                              
              88 SCR-FFLD-PF7   VALUE '7'.                              
              88 SCR-FFLD-PF8   VALUE '8'.                              
              88 SCR-FFLD-PF9   VALUE '9'.                              
              88 SCR-FFLD-PF10  VALUE ':'.                              
              88 SCR-FFLD-PF11  VALUE '#'.                              
              88 SCR-FFLD-PF12  VALUE '@'.                              
              88 SCR-FFLD-PFA   VALUE 'A'.                              
              88 SCR-FFLD-PFB   VALUE 'B'.                              
              88 SCR-FFLD-PFC   VALUE 'C'.                              
              88 SCR-FFLD-PFD   VALUE 'D'.                              
              88 SCR-FFLD-PFE   VALUE 'E'.                              
              88 SCR-FFLD-PFF   VALUE 'F'.                              
              88 SCR-FFLD-PFG   VALUE 'G'.                              
              88 SCR-FFLD-PFH   VALUE 'H'.                              
              88 SCR-FFLD-PFI   VALUE 'I'.                              
              88 SCR-FFLD-PFJ   VALUE '?'.                              
              88 SCR-FFLD-PFK   VALUE '.'.                              
              88 SCR-FFLD-PFL   VALUE '<'.                              
           03 SCR-OFRM                    PIC X(01).                    
              88 SCR-OFRM-SRV   VALUE 'S'.                              
      *>        88 SCR-OFRM-BMS   VALUE "B".                             
           03 SCR-IERR                    PIC X(01).                    
              88 SCR-IERR-YES   VALUE 'S'.                              
              88 SCR-IERR-NOT   VALUE 'N'.                              
      *>ADA-INI 15-NOV-2001                                              
      *>    03 SCR-DISP                    PIC X(23).                    
           03 SCR-ORIG.                                                 
               05 SCR-MODO                PIC X(01).                    
               05 SCR-CNAL                PIC X(03).                    
           03 SCR-DISP                    PIC X(19).                    
      *>ADA-FIN 15-NOV-2001                                              
                     
      *>
      *> ISP: CONTINUACION CMMA
           03 SCR-CONT                    PIC X(2750).
       01  SCR-CTTS.                                                    
           03 SCR-INST-INI                PIC X(03) VALUE 'INI'.        
           03 SCR-INST-HCM                PIC X(03) VALUE 'HCM'.        
           03 SCR-INST-GCM                PIC X(03) VALUE 'GCM'.        
           03 SCR-INST-HKY                PIC X(03) VALUE 'HKY'.        
           03 SCR-INST-GKY                PIC X(03) VALUE 'GKY'.        
           03 SCR-INST-HFL                PIC X(03) VALUE 'HFL'.        
           03 SCR-INST-GFL                PIC X(03) VALUE 'GFL'.        
           03 SCR-INST-GCS                PIC X(03) VALUE 'GCS'.        
           03 SCR-INST-GAB                PIC X(03) VALUE 'GAB'.        
           03 SCR-INST-GCF                PIC X(03) VALUE 'GCF'.        
           03 SCR-INST-SIS                PIC X(03) VALUE 'SIS'.        
           03 SCR-INST-BRW                PIC X(03) VALUE 'BRW'.        
           03 SCR-STAT-CON                PIC X(01) VALUE 'C'.          
           03 SCR-STAT-ABT                PIC X(01) VALUE 'K'.          
           03 SCR-STAT-MOD                PIC X(01) VALUE 'M'.          
           03 SCR-STAT-SON                PIC X(01) VALUE 'A'.          
           03 SCR-ACTU-MOD                PIC X(03) VALUE 'MOD'.        
           03 SCR-ACTU-ING                PIC X(03) VALUE 'ING'.        
           03 SCR-VFLD-NOT                PIC X(01) VALUE 'N'.          
           03 SCR-VFLD-YES                PIC X(01) VALUE 'S'.          
           03 SCR-MFLD-NOT                PIC X(01) VALUE 'N'.          
           03 SCR-MFLD-YES                PIC X(01) VALUE 'S'.          
                     
      
      *> ISP  11-NOV-1992
      *>
      *> BCI-COPY
      *>COPY GNSWGPCO.
      *> PTC:                                                            
      *> VARIABLES SCR- 2.0                                              
       01  OSC-VARI.                                                    
           03 OSC-TCMA  COMP              PIC S9(04).                   
           03 OSC-SIST                    PIC X(03).                    
           03 OSC-FUNC                    PIC X(08).                    
           03 OSC-NEMO                    PIC X(12).                    
      *>    03 OSC-CPRO                    PIC X(06).                    
           03 OSC-RFBY                    PIC X(01).                    
      *>    03 FILLER                      PIC X(05).                    
           03 OSC-NTRV                    PIC X(04).                    
           03 FILLER                      PIC X(01).                    
      *>                                                                 
           03 OSC-NTRN                    PIC X(04).                    
           03 OSC-PROG                    PIC X(08).                    
           03 IFD-PROG REDEFINES OSC-PROG PIC X(08).                    
           03 OSC-NLIB                    PIC X(07).                    
           03 OSC-NMAP                    PIC X(07).                    
           03 OSC-LDOC                    PIC X(25).                    
           03 OSC-NDOC                    PIC X(12).                    
           03 OSC-FRET                    PIC X(12).                    
           03 OSC-IPRV                    PIC X(01).                    
           03 OSC-SISG                    PIC X(03).                    
           03 OSC-STAT                    PIC X(01).                    
           03 OSC-INST                    PIC X(03).                    
           03 OSC-VFLD                    PIC X(01).                    
           03 OSC-ACTU                    PIC X(03).                    
           03 OSC-TFUN                    PIC X(03).                    
           03 OSC-CMNP                    PIC X(08).                    
           03 OSC-FFLD                    PIC X(01).                    
              88 OSC-FFLD-RET   VALUE ''''.                             
              88 OSC-FFLD-PF1   VALUE '1'.                              
              88 OSC-FFLD-PF2   VALUE '2'.                              
              88 OSC-FFLD-PF3   VALUE '3'.                              
              88 OSC-FFLD-PF4   VALUE '4'.                              
              88 OSC-FFLD-PF5   VALUE '5'.                              
              88 OSC-FFLD-PF6   VALUE '6'.                              
              88 OSC-FFLD-PF7   VALUE '7'.                              
              88 OSC-FFLD-PF8   VALUE '8'.                              
              88 OSC-FFLD-PF9   VALUE '9'.                              
              88 OSC-FFLD-PF10  VALUE ':'.                              
              88 OSC-FFLD-PF11  VALUE '#'.                              
              88 OSC-FFLD-PF12  VALUE '@'.                              
              88 OSC-FFLD-PFA   VALUE 'A'.                              
              88 OSC-FFLD-PFB   VALUE 'B'.                              
              88 OSC-FFLD-PFC   VALUE 'C'.                              
              88 OSC-FFLD-PFD   VALUE 'D'.                              
              88 OSC-FFLD-PFE   VALUE 'E'.                              
              88 OSC-FFLD-PFF   VALUE 'F'.                              
              88 OSC-FFLD-PFG   VALUE 'G'.                              
              88 OSC-FFLD-PFH   VALUE 'H'.                              
              88 OSC-FFLD-PFI   VALUE 'I'.                              
              88 OSC-FFLD-PFJ   VALUE ':'.                              
              88 OSC-FFLD-PFK   VALUE '.'.                              
              88 OSC-FFLD-PFL   VALUE '<'.                              
           03 OSC-I                       PIC 9(02).                    
           03 OSC-CMND                    PIC X(03).                    
           03 OSC-MFLD                    PIC X(01).                    
           03 OSC-PRMC                    PIC X(25).                    
           03 OSC-CCPP                    PIC X(03).                    
           03 OSC-STPP                    PIC X(01).                    
           03 OSC-CRPF.                                                 
              05 OSC-TABL OCCURS 10   INDEXED BY OSC-ITBL.              
                 07 OSC-COD-CCMN          PIC X(03).                    
                 07 OSC-COD-CCPP          PIC X(03).                    
                 07 OSC-IND-STPP          PIC X(01).                    
              05 OSC-GLS-UARC             PIC X(12) OCCURS 10.          
              05 OSC-GLS-PRMT             PIC X(25) OCCURS 10.          
              05 OSC-GLS-CONF             PIC X(25) OCCURS 10.          
           03 OSC-USER                    PIC X(12).                    
           03 OSC-OTRN                    PIC X(04).                    
      *>    03 FILLER                      PIC X(09).                    
           03 OSC-PROV                    PIC X(08).                    
           03 FILLER                      PIC X(01).                    
      *>                                                                 
           03 OSC-UMOD                    PIC X(14).                    
           03 IFD-FSIS.                                                 
              05 IFD-VSIS OCCURS 30   INDEXED BY IFD-ITBL.              
                 07 IFD-DSIS.                                           
                    09 IFD-SIST           PIC X(03).                    
                    09 IFD-QSIS           PIC X(01).                    
                 07 IFD-GSIS              PIC X(03).                    
           03 OSC-ICMN                    PIC X(01).                    
              88 OSC-DESDE-MEN VALUE 'M'.                               
              88 OSC-DESDE-HDR VALUE 'H'.                               
              88 OSC-DESDE-CMN VALUE 'C'.                               
              88 OSC-DESDE-PGM VALUE 'P'.                               
           03 OSC-OFRM                    PIC X(01).                    
              88 OSC-OFRM-SRV   VALUE 'S'.                              
              88 OSC-OFRM-BMS   VALUE 'B'.                              
           03 OSC-IERR                    PIC X(01).                    
              88 OSC-IERR-YES   VALUE 'S'.                              
              88 OSC-IERR-NOT   VALUE 'N'.                              
           03 OSC-DISP                    PIC X(03).                    
                     
      *>
      *> ISP: CONTINUACION CMMA
           03 OSC-CONT                    PIC X(001).
      
      *>    Constantes para las rutinas FIO"s                            
       01  FIO-CTTS.                                                    
      *>                                                                 
      *>    DEFault access for other users                               
           03 FIO-ACCS-DEF        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    NOT     access for other users                               
           03 FIO-ACCS-NOT        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    INPut   access for other users                               
           03 FIO-ACCS-INP        VALUE 2       PIC 9(01).              
      *>                                                                 
      *>    UPDate  access for other users                               
           03 FIO-ACCS-UPD        VALUE 3       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on record locked                             
           03 FIO-RLCK-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on record locked                             
           03 FIO-RLCK-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    FIO     control on input file not found                      
           03 FIO-IFNF-FIO        VALUE 0       PIC 9(01).              
      *>                                                                 
      *>    ProGraM control on input file not found                      
           03 FIO-IFNF-PGM        VALUE 1       PIC 9(01).              
      *>                                                                 
      *>    Status Registro Inexistente                                  
           03 FIO-STAT-NEX                      PIC X(02) VALUE '39'.   
      *>                                                                 
      *>    Comandos para las rutinas FIO"s                              
           03 FIO-VCMN.                                                 
      *>                                                                 
      *>       Read Key                                                  
              05 FIO-GET-KEY           VALUE  1 PIC 9(04).              
      *>                                                                 
      *>       Read Next                                                 
              05 FIO-GET-NXT           VALUE  2 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next                                   
              05 FIO-GET-FST           VALUE  3 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next                                
              05 FIO-GET-NLS           VALUE  4 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next                                 
              05 FIO-GET-GRT           VALUE  5 PIC 9(04).              
      *>                                                                 
      *>       Write                                                     
              05 FIO-PUT               VALUE  6 PIC 9(04).              
      *>                                                                 
      *>       Rewrite                                                   
              05 FIO-MOD               VALUE  7 PIC 9(04).              
      *>                                                                 
      *>       Delete                                                    
              05 FIO-DEL               VALUE  8 PIC 9(04).              
      *>                                                                 
      *>       Change                                                    
              05 FIO-CHG               VALUE  9 PIC 9(04).              
      *>                                                                 
      *>       Open Input                                                
              05 FIO-INP               VALUE 10 PIC 9(04).              
      *>                                                                 
      *>       Open Output                                               
              05 FIO-OUT               VALUE 11 PIC 9(04).              
      *>                                                                 
      *>       Open I-O                                                  
              05 FIO-UPD               VALUE 12 PIC 9(04).              
      *>                                                                 
      *>       Close                                                     
              05 FIO-CLO               VALUE 13 PIC 9(04).              
      *>                                                                 
      *>       Start Equal                                               
              05 FIO-FND-EQL           VALUE 14 PIC 9(04).              
      *>                                                                 
      *>       Start First                                               
              05 FIO-FND-FST           VALUE 15 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less                                            
              05 FIO-FND-NLS           VALUE 16 PIC 9(04).              
      *>                                                                 
      *>       Start Greater                                             
              05 FIO-FND-GRT           VALUE 17 PIC 9(04).              
      *>                                                                 
      *>       Unlock Record                                             
              05 FIO-ULK-REC           VALUE 18 PIC 9(04).              
      *>                                                                 
      *>       Unlock All                                                
              05 FIO-ULK-ALL           VALUE 19 PIC 9(04).              
      *>                                                                 
      *>       Value of ID                                               
              05 FIO-VID               VALUE 20 PIC 9(04).              
      *>                                                                 
      *>       Acceso                                                    
              05 FIO-ACC               VALUE 21 PIC 9(04).              
      *>                                                                 
      *>       Record Locked                                             
              05 FIO-REC-LCK           VALUE 22 PIC 9(04).              
      *>                                                                 
      *>       File Not Found                                            
              05 FIO-FNF               VALUE 23 PIC 9(04).              
      *>                                                                 
      *>       Record Length                                             
              05 FIO-REC-LEN           VALUE 24 PIC 9(04).              
      *>                                                                 
      *>       Open Extend                                               
              05 FIO-EXT               VALUE 25 PIC 9(04).              
      *>                                                                 
      *>       Read Key ( Alternate Key )                                
              05 FIO-GET-KEY-ALT       VALUE 26 PIC 9(04).              
      *>                                                                 
      *>       Start First + Read Next ( Alternate Key )                 
              05 FIO-GET-FST-ALT       VALUE 27 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less + Read Next ( Alternate Key )              
              05 FIO-GET-NLS-ALT       VALUE 28 PIC 9(04).              
      *>                                                                 
      *>       Start Greater + Read Next ( Alternate Key )               
              05 FIO-GET-GRT-ALT       VALUE 29 PIC 9(04).              
      *>                                                                 
      *>       Start Equal ( Alternate Key )                             
              05 FIO-FND-EQL-ALT       VALUE 30 PIC 9(04).              
      *>                                                                 
      *>       Start First ( Alternate Key )                             
              05 FIO-FND-FST-ALT       VALUE 31 PIC 9(04).              
      *>                                                                 
      *>       Start Not Less ( Alternate Key )                          
              05 FIO-FND-NLS-ALT       VALUE 32 PIC 9(04).              
      *>                                                                 
      *>       Start Greater ( Alternate Key )                           
              05 FIO-FND-GRT-ALT       VALUE 33 PIC 9(04).              
      *>                                                                 
      *>       Get Next con llave Alternativa                            
              05 FIO-GET-NXT-ALT       VALUE 34 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update con llave Alternativa                      
              05 FIO-GET-KEY-UPD-ALT   VALUE 35 PIC 9(04).              
      *>                                                                 
      *>       Get Key Update                                            
              05 FIO-GET-KEY-UPD       VALUE 36 PIC 9(04).              
      *>                                                                 
      *>       End Browse                                                
              05 FIO-END-BRW           VALUE 37 PIC 9(04).              
      *>                                                                 
      *>       Back Out Transaction                                      
              05 FIO-BCK-OUT           VALUE 38 PIC 9(04).              
      *>                                                                 
      *>       Get Less or Equal                                         
              05 FIO-GET-LEQ           VALUE 39 PIC 9(04).              
      *>                                                                 
      *>       Get Previous                                              
              05 FIO-GET-PRV           VALUE 40 PIC 9(04).              
      *>                                                                 
      *>       Check Point                                               
              05 FIO-CHK-PNT           VALUE 41 PIC 9(04).              
      *>                                                                 
      *>       Buffer Refresh                                            
              05 FIO-BFR-RFH           VALUE 42 PIC 9(04).              
      *>                                                                 
      *>       End Browse All                                            
              05 FIO-EBR-ALL           VALUE 43 PIC 9(04).              
      *>                                                                 
      *>       BEGin TRaNsacction                                        
              05 FIO-BEG-TRN           VALUE 44 PIC 9(04).              
      *>                                                                 
           03 FIO-VCMN-RED    REDEFINES FIO-VCMN.                       
              05 FIO-IDX-VCMN OCCURS 44 TIMES   PIC 9(04).              
      *>                                                                 
      *>    Programa que usa servicio de FIO                             
           03 FIO-PROG                          PIC X(08).              
      *>                                                                 
      *>    Programa  FIO                             
           03 FIO-GLS-PROG                      PIC X(08).              
      *>                                                                 
      *>    Valor de Key                                                 
           03 FIO-VKEY                          PIC X(180).             
      *>                                                                 
      *>    Valor de Key para Comparacion con FIO-VKEY   ( VSI )         
           03 FIO-CKEY                          PIC X(180).             
      *>                                                                 
      *>    Key Length                                                   
           03 FIO-KLEN  COMP                    PIC S9(4).              
      *>                                                                 
      *>    Campo Data para FIO                                          
           03 FIO-DFLD                          PIC X(1536).            
      *>                                                                 
      *>    Mensaje                                                      
           03 FIO-MENS              VALUE SPACES.                       
      *>                                                                 
      *>       Mensaje 1                                                 
              05 FIO-MEN1                       PIC X(71).              
      *>                                                                 
      *>       Mensaje 2                                                 
              05 FIO-MEN2                       PIC X(09).              
      *>                                                                 
           03 FIO-MENS-RED REDEFINES FIO-MENS.                          
              05 FIO-MENS-DSC                   PIC X(13).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-STT                   PIC X(02).              
              05 FIO-MENS-NTT REDEFINES FIO-MENS-STT PIC 9(02).         
              05 FIO-MENS-SST                   PIC X(01).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GKY                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-KEY                   PIC X(32).              
              05 FIO-MENS-KEY-RED REDEFINES FIO-MENS-KEY.               
                 07 FIO-MENS-KDT                PIC X(05).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-GBD                PIC X(10).              
                 07 FILLER                      PIC X(01).              
                 07 FIO-MENS-DBI                PIC X(05).              
                 07 FILLER                      PIC X(10).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GCM                   PIC X(03).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-CMD                   PIC X(05).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-GFL                   PIC X(04).              
              05 FILLER                         PIC X(01).              
              05 FIO-MENS-FIL                   PIC X(09).              
              05 FIO-MENS-FIL-RED REDEFINES FIO-MENS-FIL.               
                 07 FIO-MENS-SIS                PIC X(03).              
                 07 FIO-MENS-REG                PIC X(06).              
              05 FILLER                         PIC X(01).              
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IAKY                 VALUE  0 PIC 9(04).              
              88 FIO-IAKY-CON          VALUE 26 THRU 35.                
      *>                                                                 
      *>    Indicador de uso de Llave alternativa                        
           03 FIO-IGET                 VALUE  0 PIC 9(04).              
              88 FIO-IGET-YES          VALUE  1 THRU 5, 26 THRU 29,     
                                             34, 35, 36, 39, 40.        
              88 FIO-ICBR-YES          VALUE  2, 34, 40.                
      *>                                                                 
      *>    Indicador de Llaves de Default                               
           03 FIO-KDEF                 VALUE 0 PIC 9(01).               
           03 FIO-KDEF-N               VALUE 0 PIC 9(01).               
           03 FIO-KDEF-S               VALUE 1 PIC 9(01).               
      *>                                                                 
      *>    Indicador de primera VEZ                                     
           03 FIO-IVEZ            VALUE SPACES PIC X(01).               
      *>                                                                 
      *>    Vector de status de archivos                                 
           03 FIO-MSFL VALUE SPACES.                                    
              05 FIO-VSFL OCCURS 20 INDEXED BY FIO-ITBL.                
                 07 FIO-NFIL                   PIC X(07).               
      *>                                                                 
      *>    Indice maximo                                                
           03 FIO-MXFL               VALUE 20  PIC 9(02).               
      *>                                                                 
      *>    Indicador de Start-Browse abierto                            
           03 FIO-ISBR               VALUE 'N' PIC X(01).               
      *>                                                                 
      *>    Indice auxiliar                                              
           03 FIO-IAUX               VALUE 0   PIC 9(02).               
      
       01 FIO-ORACLE.
           03 FIO-ORACLE-VARI                  PIC X(0080).
           03 FIO-ORACLE-DFLD                  PIC X(1536).
           03 FIO-ORACLE-RQA                   PIC X(0630).
           03 FIO-ORACLE-MENS                  PIC X(0080).
           03 FIO-ORACLE-PROG.
              05 FIO-ORACLE-PROG-TAB           PIC X(0003).
              05 FIO-ORACLE-PROG-NUM           PIC 9(0003).
           03 FIO-ORACLE-FILL                  PIC X(0668).
      
       01 RECV-STRING-FIO                      PIC X(3000).
       
       01 SEND-STRING-FIO                      PIC X(3000).
                     
      *>    Variables para las rutinas FIO"s                             
      *>    ( Linkage Section para VSAM BATCH )                          
       01  FIO-VARI.                                                    
      *>                                                                 
      *>    Nombre de la llave alternativa                               
           03 FIO-AKEY       VALUE SPACES               PIC X(32).      
      *>                                                                 
      *>    Esta variable FILE STATUS es el codigo de retorno            
      *>    de las subrutinas FIO                                        
           03 FIO-STAT.                                                 
      *>                                                                 
      *>          Created Duplicate Key                                  
                 88 FIO-STAT-CDK        VALUE '02'.                     
      *>                                                                 
      *>          End Of File                                            
                 88 FIO-STAT-EOF        VALUE '10'.                     
      *>                                                                 
      *>          No Ascending Key                                       
                 88 FIO-STAT-NAK        VALUE '21'.                     
      *>                                                                 
      *>          Invalid KeY                                            
                 88 FIO-STAT-IKY        VALUE '22' '23'.                
      *>                                                                 
      *>          Duplicate Alternate Key                                
                 88 FIO-STAT-DAK        VALUE '22'.                     
      *>                                                                 
      *>          Record Not Found                                       
                 88 FIO-STAT-RNF        VALUE '23'.                     
      *>                                                                 
      *>          Boundary Violation Error                               
                 88 FIO-STAT-BVE        VALUE '24' '34'.                
      *>                                                                 
      *>          Other Permanent Errors                                 
                 88 FIO-STAT-OPE        VALUE '30'.                     
      *>                                                                 
      *>          Other Device Errors                                    
                 88 FIO-STAT-ODE        VALUE '90'.                     
      *>                                                                 
      *>          PassWord Failure                                       
                 88 FIO-STAT-PWF        VALUE '91'.                     
      *>                                                                 
      *>          LoGic Error                                            
                 88 FIO-STAT-LGE        VALUE '92'.                     
      *>                                                                 
      *>          Resource Not Available                                 
                 88 FIO-STAT-RNA        VALUE '93'.                     
      *>                                                                 
      *>          No Previous Read                                       
                 88 FIO-STAT-NPR        VALUE '94'.                     
      *>                                                                 
      *>          Invalid or incomplete File Information                 
                 88 FIO-STAT-IFI        VALUE '95'.                     
      *>                                                                 
      *>          Bad File Identification                                
                 88 FIO-STAT-BFI        VALUE '96'.                     
      *>                                                                 
      *>          File Intergrity Verified                               
                 88 FIO-STAT-FIV        VALUE '97'.                     
      *>JSS                                                              
      *>             Fatal                                               
                    88 FIO-STAT-FTL        VALUE '99'.                  
      *>JSS                                                              
      *>             Duplicate Master Key                                
                    88 FIO-STAT-DMK        VALUE '22'.                  
      *>JSS                                                              
      *>             Invalid Master Key                                  
                    88 FIO-STAT-IMK        VALUE '23'.                  
      *>JSS                                                              
      *>             Special Deleted Record                              
                    88 FIO-STAT-SDR        VALUE '43'.                  
      *>JSS                                                              
      *>             Exclusive Control Duplicate                         
                    88 FIO-STAT-ECD        VALUE '44'.                  
      *>JSS                                                              
      *>             Set Selection Interrupt                             
                    88 FIO-STAT-SSI        VALUE '45'.                  
      *>JSS                                                              
      *>             Attempt to Position PAST END/BEG-OF-SET             
                    88 FIO-STAT-APS        VALUE '46'.                  
      *>JSS                                                              
      *>             Exclusive Control Interlock                         
                    88 FIO-STAT-ECI        VALUE '47'.                  
      *>                                                                 
                 05 FIO-STT1                    PIC 9(01).              
      *>                                                                 
      *>               OK Status                                         
                      88 FIO-STAT-OKS   VALUE 0.                        
      *>                                                                 
      *>               At End Status                                     
                      88 FIO-STAT-AES   VALUE 1.                        
      *>                                                                 
      *>               Invalid Key Status                                
                      88 FIO-STAT-IKS   VALUE 2.                        
      *>                                                                 
      *>               ERRors                                            
                      88 FIO-STAT-ERR   VALUE 3.                        
      *>JSS                                                              
      *>               DATACOM Errors                                    
                      88 FIO-STAT-DTC   VALUE 4.                        
      *>                                                                 
      *>               Device Dependant Errors                           
                      88 FIO-STAT-DDE   VALUE 9.                        
      *>                                                                 
                 05 FIO-STT2                    PIC 9(01).              
      *>                                                                 
      *>               No Further Information                            
                      88 FIO-STAT-NFI   VALUE 0.                        
      *>                                                                 
      *>               SEQuential access                                 
                      88 FIO-STAT-SEQ   VALUE 1.                        
      *>                                                                 
      *>               DUPlicates                                        
                      88 FIO-STAT-DUP   VALUE 2.                        
      *>                                                                 
      *>               No Current Record                                 
                      88 FIO-STAT-NCR   VALUE 3.                        
      *>                                                                 
      *>    Esta variable RELATIVE KEY indica a las subrutinas FIO       
      *>    la llave de un archivo relativo para su acceso.              
           03 FIO-RKEY          COMP            PIC 9(09).              
      *>                                                                 
      *>    Comando de las Subrutinas FIO                                
           03 FIO-CMND                 VALUE  0 PIC 9(04).              
      *>                                                                 
      *>    Esta variable  ACCESS indica a las subrutinas                
      *>    FIO la forma de abrir un archivo en cuanto al                
      *>    acceso desde otros programas                                 
           03 FIO-ACCS                      PIC 9(01).                  
      *>                                                                 
      *>       0 = DEFault access                                        
      *>       1 = NOT     access                                        
      *>       2 = INPut   access                                        
      *>       3 = UPDate  access                                        
      *>                                                                 
      *>    Esta variable RECORD LOCKED indica a las subrutinas          
      *>    FIO si tomar o no el control cuando hay un registro          
      *>    ocupado                                                      
           03 FIO-RLCK                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on record locked ( Default )          
      *>       1 = ProGraM control on record locked                      
      *>                                                                 
      *>    Esta variable INPUT FILE NOT FOUND indica a las              
      *>    subrutinas  FIO si tomar o no el control cuando              
      *>    al abrir un archivo de Input, este no existe                 
           03 FIO-IFNF                      PIC 9(01).                  
      *>                                                                 
      *>       0 = FIO     control on file not found                     
      *>       1 = ProGraM control on file not found                     
      *>                                                                 
      *>    Esta  variable  RECORD LENGTH  debe ser  llenada  con el     
      *>    largo  del  registro, para  registros de largo variable,     
      *>    antes de llamar a las subrutinas FIO con comando REC_LEN     
           03 FIO-RLEN     COMP                 PIC S9(04).             
      *>                                                                 
      *>    Value Of ID                                                  
           03 FIO-VOID.                                                 
      *>                                                                 
      *>       Sistema                                                   
              05 FIO-SIST                       PIC X(03).              
      *>                                                                 
      *>       Tipo                                                      
              05 FIO-FTYP                       PIC X(01).              
      *>                                                                 
      *>       Nombre                                                    
              05 FIO-FNAM                       PIC X(04).              
                                                                        
      *>       RESPALDO FIO-SIST                                         
           03 FIO-SIST-BKP                      PIC X(03).              
                                                                        
      *>                                                                 
      *>    Filler                                                       
           03 FILLER                            PIC X(15).              
                     
      *> User Information Block                                          
       01  ADR-UIFB.                                                    
      *>                                                                 
      *>    Programa                                                     
           03 ADR-PROG                                  PIC X(08).      
      *>                                                                 
           03 FILLER                                    PIC X(24).      
                     
      *>    Element List                                                 
       01  ADR-ELLS.                                                    
      *>    Elemento 1                                                   
           03 ADR-ELM1                                  PIC X(05).      
      *>    Codigo de Seguridad                                          
           03 ADR-CSEG                                  PIC X(01).      
      *>    Fin de Element List                                          
           03 FILLER                    VALUE SPACES    PIC X(05).      
                     
      *>    Request Area                                                 
       01  ADR-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                     
      *>    Request Area                                                 
       01  ADR-TAB-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>    Request Area                                                 
       01  ADR-RCI-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>INI-PENTA TUXEDO ORACLE
      *>    Request Area                                                 
       01  ADR-IDD-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>    Request Area                                                 
       01  ADR-MNU-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>    Request Area                                                 
       01  ADR-RPF-REQA.                                                    
      *>    Comando                                                      
           03 ADR-CMND                                  PIC  X(05).     
      *>    Tabla                                                        
           03 ADR-TABL                                  PIC  X(03).     
      *>    Descripcion de llave                                         
           03 ADR-DKEY                                  PIC  X(05).     
      *>    Status                                                       
           03 ADR-STAT                  VALUE SPACES    PIC  X(02).     
              88 ADR-STAT-OKS           VALUE SPACES.                   
      *>    Sub Status                                                   
           03 ADR-SSTT                  VALUE SPACES    PIC  X(01).     
      *>    Identificacion de la base de datos                           
           03 ADR-DBID                          COMP    PIC S9(04).     
      *>    Identificacion del Registro                                  
           03 ADR-RCID                                  PIC  X(07).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(25).     
      *>    Contador Maximo                                              
           03 ADR-CTMX                          COMP    PIC S9(04).     
      *>    Contador de Input/Output                                     
           03 ADR-CTIO                          COMP    PIC S9(04).     
      *>    Reservado                                                    
           03 FILLER                                    PIC  X(22).     
      *>    Valor de Llave                                               
           03 ADR-VKEY                                  PIC  X(180).    
      *>    Valor de llave 1                                             
           03 ADR-VKY1                                  PIC  X(180).    
      *>    Valor de llave 2                                             
           03 ADR-VKY2                                  PIC  X(180).    
                                                                
      *>FIN-PENTA TUXEDO ORACLE
      
      *>    Registro Independencia de Datos                              
      *>    -------------------------------                              
      *>                                                                 
      *>    Nombre Registro : IDD                                        
      *>    Clave(s)        : IDD-COD-CIDD                               
      *>    Largo           : 490                                        
      *>    Bloqueo         : 1                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  IDD.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03 IDD-GLS-FLAG                              PIC X(01).      
      *>                                                                 
      *>    Codigo Identificacion IDD ( Clave Primaria Registro )        
           03 IDD-COD-CIDD                              PIC X(12).      
      *>                                                                 
      *>    Tabla Independencia de datos                                 
           03 IDD-GLS-FSIS.                                             
              05 IDD-GLS-VSIS OCCURS 43 INDEXED BY IDD-NUM-ITBL.        
      *>                                                                 
      *>          Descripcion de la entidad                              
                 07 IDD-GLS-DENT.                                       
      *>                                                                 
      *>             Sistema                                             
                    09 IDD-COD-SIST                     PIC X(03).      
      *>                                                                 
      *>             Grupo                                               
                    09 IDD-COD-GRPO                     PIC X(01).      
      *>                                                                 
      *>             Registro                                            
                    09 IDD-COD-RGST                     PIC X(03).      
      *>                                                                 
      *>          Tipo de la Entidad                                     
                 07 IDD-COD-TENT                        PIC X(01).      
      *>                                                                 
      *>          Identificacion de la Entidad                           
                 07 IDD-COD-IENT                        PIC X(03).      
      *>                                                                 
      *>    Disponible                                                   
           03 IDD-GLS-DISP                              PIC X(04).      
      *>
                     
      *>Variables para independencia de datos 15-JAN-1990 17:04:48       
       01  IDD-VARI.                                                    
           03 IDD-PROG                          PIC X(08).              
           03 IDD-DAUX.                                                 
              05 IDD-SAUX                       PIC X(03).              
              05 IDD-GAUX                       PIC X(01).              
              05 IDD-RAUX                       PIC X(03).              
           03 IDD-IAUX                          PIC 9(02).              
           03 IDD-REGI.                                                 
              05 FILLER                         PIC X(01).              
              05 IDD-CIDD                       PIC X(12).              
              05 IDD-FSIS.                                              
                 07 IDD-VSIS OCCURS 43 INDEXED BY IDD-ITBL.             
                    09 IDD-DENT.                                        
                       11 IDD-SIST              PIC X(03).              
                       11 IDD-GRPO              PIC X(01).              
                       11 IDD-RGST              PIC X(03).              
                    09 IDD-TENT                 PIC X(01).              
                    09 IDD-IENT                 PIC X(03).              
      *>ESTE REDEFINES TIENE COMO PROPOSITO COMPILAR                     
      *>PROGRAMAS NUEVOS CON FIO"S ANTIGUAS ( SIN GENERARLAS )           
      *>              09 IFD-GSIS REDEFINES IDD-IENT                     
      *>                                          PIC X(03).             
              05 FILLER                         PIC X(04).              
                     
       01  WSS-IND-QUE                           PIC X(03).
       01  IFD.
           03  FILLER                            PIC X(01).
           03  IFD-COD-CIFD                      PIC X(12).
           03  IFD-GLS-DATA                      PIC X(210).
           03  FILLER                            PIC X(18).
      *>                                                                 
       01  QUE-VARI.                                                    
           03 QUE-COLA.                                                 
              05 QUE-TERM                              PIC  X(04).      
              05 QUE-TYPE                              PIC  X(04).      
           03 QUE-NITM       COMP VALUE +0             PIC S9(04).      
           03 QUE-LITM       COMP                      PIC S9(04).      
           03 QUE-ITEM.                                                 
              05 QUE-IKEY                              PIC  X(03).      
              05 QUE-LDAT    COMP VALUE +0             PIC S9(04).      
              05 QUE-PCUR    COMP VALUE +0             PIC S9(04).      
              05 QUE-DATA                              PIC  X(3000).    
           03 QUE-STAT            VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-OKS        VALUE 'OKS'          PIC  X(03).      
           03 QUE-STAT-NEX        VALUE 'NEX'          PIC  X(03).      
           03 QUE-STAT-EOQ        VALUE 'EOQ'          PIC  X(03).      
           03 QUE-CMND                                 PIC  X(03).      
           03 QUE-MENS.                                                 
              05 QUE-MEN1                              PIC  X(40).      
              05 QUE-MEN2                              PIC  X(39).
           01 QUE-NUM-STAT                             PIC  S9(09).
           01 QUE-GLS-STAT                             PIC  S9(09).
              
       01  QUE-CTTS.                                                    
           03 QUE-PUT             VALUE 'PUT'          PIC  X(03).      
           03 QUE-GET             VALUE 'GET'          PIC  X(03).      
           03 QUE-MOD             VALUE 'MOD'          PIC  X(03).      
           03 QUE-DEL             VALUE 'DEL'          PIC  X(03).      
      
       01  QUE-SEND.                                                    
           03 QUE-COM-SEND                             PIC  X(03).      
           03 QUE-NAM-SEND                             PIC  X(300).     
           03 QUE-NUM-SEND                             PIC  9(04).      
           03 QUE-LAR-SEND                             PIC  9(04).      
           03 QUE-TRX-SEND                             PIC  X(256).     
           03 QUE-DAT-SEND                             PIC  X(9000).    
      
       01  QUE-RECV.                                                    
           03 QUE-FIL-RECV                             PIC  9(02).      
           03 QUE-STA-RECV                             PIC  9(18).      
           03 QUE-NUM-RECV                             PIC  9(04).      
           03 QUE-LAR-RECV                             PIC  9(04).      
           03 QUE-TRX-RECV                             PIC  X(256).     
           03 QUE-DAT-RECV                             PIC  X(9000).    
      
       01  QUE-TPTYPE-REC-SEND.
           05 QUE-REC-SEND-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-SEND-SUB-TYPE                 PIC X(16).
           05 QUE-REC-SEND-LEN       VALUE 9568     PIC S9(9) COMP-5.
           05 QUE-REC-SEND-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-SEND-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-SEND-TPTRUNCATE   VALUE 1.
      
       01  QUE-TPTYPE-REC-RECV.
           05 QUE-REC-RECV-REC-TYPE  VALUE "CARRAY" PIC X(8).
           05 QUE-REC-RECV-SUB-TYPE                 PIC X(16).
           05 QUE-REC-RECV-LEN       VALUE 9285     PIC S9(9) COMP-5.
           05 QUE-REC-RECV-TPTYPE-STATUS            PIC S9(9) COMP-5.
              88 QUE-TPTYPE-REC-RECV-TPTYPEOK     VALUE 0.
              88 QUE-TPTYPE-REC-RECV-TPTRUNCATE   VALUE 1.
              
       01 QUE-TPSVCDEF-REC.
       05 QUE-COMM-HANDLE          PIC S9(9) COMP-5.
       05 QUE-TPBLOCK-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPBLOCK         VALUE 0.
               88 QUE-TPNOBLOCK       VALUE 1.
       05 QUE-TPTRAN-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTRAN          VALUE 0.
               88 QUE-TPNOTRAN        VALUE 1.
       05 QUE-TPREPLY-FLAG         PIC S9(9) COMP-5.
               88 QUE-TPREPLY         VALUE 0.
               88 QUE-TPNOREPLY       VALUE 1.
       05 QUE-TPACK-FLAG         REDEFINES QUE-TPREPLY-FLAG.
          10 FILLER PIC S9(9) COMP-5.
               88 QUE-TPNOACK         VALUE 0.
               88 QUE-TPACK           VALUE 1.
       05 QUE-TPTIME-FLAG          PIC S9(9) COMP-5.
               88 QUE-TPTIME          VALUE 0.
               88 QUE-TPNOTIME        VALUE 1.
       05 QUE-TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPNOSIGRSTRT    VALUE 0.
               88 QUE-TPSIGRSTRT      VALUE 1.
       05 QUE-TPGETANY-FLAG        PIC S9(9) COMP-5.
               88 QUE-TPGETHANDLE     VALUE 0.
               88 QUE-TPGETANY        VALUE 1.
       05 QUE-TPSENDRECV-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPSENDONLY      VALUE 0.
               88 QUE-TPRECVONLY      VALUE 1.
       05 QUE-TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
               88 QUE-TPCHANGE        VALUE 0.
               88 QUE-TPNOCHANGE      VALUE 1.
       05 QUE-TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
               88 QUE-TPREQRSP       VALUE IS 0.
               88 QUE-TPCONV         VALUE IS 1.
       05 QUE-APPKEY               PIC S9(9) COMP-5.
       05 QUE-CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
       05 QUE-SERVICE-NAME   VALUE "ts" PIC X(127).
      
      
      
      *> VARIABLES PARA ENGANCHE PROGRAMAS COMENTARIOS                   
       01  KEY-VARI.                                                    
      *>    ENTIDAD                                                      
           03 KEY-COD-ENTI                             PIC X(03).       
      *>    NOMBRE                                                       
           03  KEY-GLS-NOMC                            PIC X(60).       
      *>    RUT                                                          
           03  KEY-CIC-IRUT.                                            
               05  KEY-NUM-ICLI                        PIC 9(08).       
               05  KEY-VRF-ICLI                        PIC X(01).       
               05  KEY-IND-ICLI                        PIC X(01).       
               05  KEY-GLS-ICLI                        PIC X(03).       
      *>    CIC OPE                                                      
           03  KEY-CIC-IOPE.                                            
               05  KEY-CAI-IOPE                        PIC X(04).       
               05  KEY-IIC-IOPE                        PIC X(08).       
      *>    FECHA                                                        
           03  KEY-FEC-FENT.                                            
               05 KEY-NUM-DENT                         PIC 9(02).       
               05 KEY-NUM-MENT                         PIC 9(02).       
               05 KEY-NUM-SENT                         PIC 9(02).       
               05 KEY-NUM-AENT                         PIC 9(02).       
      *>    CORRELATIVO                                                  
           03 KEY-NUM-IENT                             PIC 9(03).       
      *>    CODIGO                                                       
           03 KEY-COD-IENT                             PIC X(03).       
      *>    FECHA COMENTARIO                                             
           03  KEY-FEC-FCMT.                                            
               05 KEY-NUM-DCMT                         PIC 9(02).       
               05 KEY-NUM-MCMT                         PIC 9(02).       
               05 KEY-NUM-SCMT                         PIC 9(02).       
               05 KEY-NUM-ACMT                         PIC 9(02).       
      *>    CORRELATIVO COMENTARIO                                       
           03 KEY-NUM-GCMT                             PIC 9(03).       
      *>    USUARIO                                                      
           03 KEY-COD-USER                             PIC X(12).       
                     
      *> ISP  11-NOV-1992
      *> COPY GNSWGTDQ.
      *> IDENTIFICACION = MULTI-V1B1                                     
      *>Variables de procesador de menu y comandos                       
       01  TSC-CTTS.                                                    
           03 TSC-TTSC COMP            VALUE 1000 PIC 9(04).            
       01  TSC-VARI.                                                    
           03 TSC-COLA.                                                 
              05  TSC-TYPE VALUE 'GTSC'           PIC X(04).            
              05  TSC-TERM                        PIC X(04).            
           03 TSC-LITM COMP                       PIC S9(04).           
           03 TSC-ITEM.                                                 
              05  TSC-ICMN                        PIC X(01).            
              05  TSC-TFUN                        PIC X(03).            
                  88 TSC-TFUN-OLD VALUE 'PGI' 'HMC' 'HMX'               
                                        'XMC' 'XMX' 'RET'.              
                  88 TSC-TFUN-NPC VALUE 'NPC'.                          
              05  TSC-INST                        PIC X(03).            
              05  TSC-PROG                        PIC X(08).            
              05  TSC-NTRN                        PIC X(04).            
              05  TSC-SIST                        PIC X(03).            
              05  TSC-SISG                        PIC X(03).            
              05  TSC-FRET                        PIC X(12).            
              05  TSC-FFLD                        PIC X(01).            
              05  TSC-NEMO                        PIC X(12).            
              05  TSC-CMNP                        PIC X(12).            
              05  TSC-CMND                        PIC X(03).            
              05  TSC-OPCI                        PIC X(03).            
              05  TSC-NLIB                        PIC X(07).            
              05  TSC-NMAP                        PIC X(07).            
              05  TSC-LDOC                        PIC X(12).            
              05  TSC-NDOC                        PIC X(25).            
              05  TSC-IPRV                        PIC X(01).            
              05  TSC-TINS                        PIC X(03).            
              05  TSC-TCTL                        PIC X(04).            
              05  TSC-TINF.                                             
                  07  TSC-TINV                    PIC X(01).            
                  07  TSC-TIND                    PIC X(01).            
                  07  FILLER                      PIC X(01).            
              05  TSC-ASCR                        PIC X(01).            
              05  TSC-AMPG                        PIC X(01).            
              05  TSC-NMHD                        PIC X(07).            
              05  TSC-LMHD                        PIC X(07).            
              05  TSC-AMHD                        PIC X(01).            
              05  TSC-NMCM                        PIC X(07).            
              05  TSC-LMCM                        PIC X(07).            
              05  TSC-AMCM                        PIC X(01).            
              05  TSC-MSAL                        PIC X(03).            
              05  TSC-TCMA               COMP     PIC S9(04).           
              05  TSC-PROV                        PIC X(12).            
              05  TSC-NTRV                        PIC X(04).            
              05  TSC-CIDD                        PIC X(12).            
              05  TSC-I                           PIC 9(02).            
              05  TSC-PRMC                        PIC X(25).            
              05  TSC-USER                        PIC X(12).            
              05  TSC-OTRN                        PIC X(04).            
              05  TSC-CRPF.                                             
                  07  TSC-TABL OCCURS 10 INDEXED BY TSC-ITBL.           
                      09  TSC-CCMN                PIC X(03).            
                      09  TSC-CCPP                PIC X(03).            
                      09  TSC-STPP                PIC X(01).            
                      09  TSC-PRMT                PIC X(25).            
                      09  TSC-CONF                PIC X(25).            
                      09  TSC-UARC.                                     
                          11  TSC-NUAR            PIC X(08).            
                          11  TSC-TUAR            PIC X(04).            
              05  TSC-RFBY                        PIC X(01).            
              05  TSC-PASW                        PIC X(01).            
              05  TSC-OACC                        PIC X(11).            
              05  TSC-RPRV                        PIC X(01).            
              05  TSC-BNCO     VALUE SPACES       PIC X(03).            
              05  TSC-MRCA     VALUE SPACES       PIC X(03).            
              05  TSC-CART     VALUE SPACES       PIC X(03).            
              05  TSC-LENG     VALUE SPACES       PIC X(02).            
              05  TSC-PAIS     VALUE SPACES       PIC X(02).            
              05  TSC-VRNT     VALUE SPACES       PIC X(01).            
              05  TSC-CNAL     VALUE SPACES       PIC X(05).            
              05  TSC-CNAD     VALUE SPACES       PIC X(02).            
              05  TSC-UMUA     VALUE SPACES       PIC X(12).            
              05  TSC-MODO     VALUE SPACES       PIC X(01).            
              05  TSC-UIDD     VALUE SPACES       PIC X(03).            
              05  TSC-DISP                        PIC X(21).            
                     
      *>
      *> COPY GNSBRTAB.                                                  
      *>    Registro Generico de Tablas                                  
      *>    NECESARIO PARA COMPILAR CICS RESCATADO EL 02.07.98.          
      *>    ---------------------------                                  
      *>                                                                 
      *>    Nombre Registro : TAB                                        
      *>    Clave(s)        : TAB-KY0-TABS(UU),
      *>                      TAB-KY1-TABS(UU), TAB-KY1-TABS(DC)
      *>    Largo           : 206
      *>    Bloqueo         : 2                                          
      *>    Observaciones   :                                            
      *>                                                                 
       01  TAB.                                                         
      *>                                                                 
      *>    Filler Compatibilidad VSAM/MVS                               
           03  TAB-GLS-FLAG                             PIC X(01).      
      *>                                                                 
      *>    Clave Primaria Registro                                      
           03  TAB-KEY-IREG.                                            
      *>                                                                 
      *>KEY     Tipo + Codigo ( LLave Primaria )                         
               05  TAB-KY0-TABS.
                   07  TAB-COD-TABL.
      *>                                                                 
      *>            Codigo Tipo Tabla                                    
                       09  TAB-COD-TTAB                 PIC X(03).
      *>                                                                 
      *>            Codigo Tabla                                         
                       09  TAB-COD-CTAB                 PIC X(12).
      *>                                                                 
      *>        Time Stamp Transaccion                                   
               05  TAB-COD-ITRS.
                   07  TAB-STP-ITRN.
      *>                                                                 
      *>            Fecha Transaccion                                    
                       09  TAB-FEC-FTRN.
                           11  TAB-NUM-STRN             PIC 9(02).
                           11  TAB-NUM-ATRN             PIC 9(02).
                           11  TAB-NUM-MTRN             PIC 9(02).
                           11  TAB-NUM-DTRN             PIC 9(02).
      *>                                                                 
      *>            Hora Transaccion                                     
                       09  TAB-HRA-HRTR.
                           11  TAB-NUM-HHTR             PIC 9(02).
                           11  TAB-NUM-MMTR             PIC 9(02).
                           11  TAB-NUM-SSTR             PIC 9(02).
      *>                                                                 
      *>    Indicador Tipo Accion                                        
           03  TAB-MSC-TACC                             PIC X(01).      
      *>                                                                 
      *>    Indicador Status                                             
           03  TAB-MSC-STAT                             PIC X(01).      
      *>                                                                 
      *>    Indicador Vigencia                           GNS VIGE        
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).      
      *>                                                                 
      *>    Codigo Origen Transaccion                                    
           03  TAB-COD-OTRN.                                            
      *>                                                                 
      *>        Indicador Tipo Origen                                    
               05  TAB-MSC-TTRN                         PIC X(01).      
      *>                                                                 
      *>        Codigo Tipo Origen                                       
               05  TAB-COD-TTRN                         PIC X(03).      
      *>                                                                 
      *>    Autor Transaccion                                            
           03  TAB-COD-ATRN                             PIC X(12).      
      *>                                                                 
      *>KEY Tipo + Codigo ( Interno Computacional )                      
           03  TAB-KY1-TABS.
               05  TAB-CIC-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-CIC-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-CIC-CTAB                     PIC X(12).
      *>                                                                 
      *>    Codigo Externo                                               
           03  TAB-KY2-TABS.
               05  TAB-EXT-TABL.
      *>                                                                 
      *>        Codigo Tipo Tabla                                        
                   07  TAB-EXT-TTAB                     PIC X(03).
      *>                                                                 
      *>        Codigo Tabla                                             
                   07  TAB-EXT-CTAB                     PIC X(05).
      *>                                                                 
      *>    Descripcion Corta                                            
           03  TAB-GLS-DCOR                             PIC X(12).      
      *>                                                                 
      *>    Abreviacion Descripcion                                      
           03  TAB-GLS-ABRV                             PIC X(05).      
      *>                                                                 
      *>    Descripcion del Codigo                                       
           03  TAB-GLS-DESC                             PIC X(40).      
      *>                                                                 
      *>    Datos Anexos                                                 
           03  TAB-GLS-DATA.                                            
               05  TAB-GLS-DAT1.                                        
                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).      
               05  TAB-GLS-DAT2.                                        
                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).      
               05  TAB-GLS-DAT3.                                        
                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).      
      *>                                                                 
      *>    Clave Soundex                                                
           03  TAB-SNX-TABL.                                            
               05  TAB-SNX-TTAB                         PIC X(03).      
               05  TAB-SNX-CTAB                         PIC X(03).      
      *>                                                                 
      *>    Variables de Tablas                                          
       01  TAB-VARI.                                                    
      *>                                                                 
      *>    Nombre de Programa FIO para TABlas                           
           03  TAB-GLS-FTAB.                                            
      *>                                                                 
      *>        Codigo Sistema                                           
               05  TAB-COD-SIST                         PIC X(03).      
      *>                                                                 
      *>        Nombre "fijo" de FIO TABlas                              
               05  TAB-COD-FTAB           VALUE 'PFTAB' PIC X(05).      
      *>
                     
      *> ISP  11-NOV-1992
      *>
      *> BCI-COPY
        01  TPSVCRET-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCRET.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCRET.cbl     
      *>
      *>  TPSVCRET.cbl
      *>
        05 TP-RETURN-VAL PIC S9(9) COMP-5.
                88 TPSUCCESS  VALUE 0.
                88 TPFAIL     VALUE 1.
                88 TPEXIT     VALUE 2.
                88 TPLONGJUMP VALUE 3.
                88 TPBREAK    VALUE 4.
        05 APPL-CODE          PIC S9(9) COMP-5.
      
      *>
        01  TPTYPE-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPTYPE.cbl  $Revision: 1.4 $"
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPTYPE.cbl       
      *>
      *>  TPTYPE.cbl
      *>
        05 REC-TYPE         PIC X(8).
                88 X-OCTET   VALUE "X_OCTET".
                88 X-COMMON  VALUE "X_COMMON".
        05 SUB-TYPE         PIC X(16).
        05 LEN              PIC S9(9) COMP-5.
                88 NO-LENGTH VALUE 0.
        05 TPTYPE-STATUS    PIC S9(9) COMP-5.
                88 TPTYPEOK     VALUE 0.
                88 TPTRUNCATE   VALUE 1.
      *>
      *>
        01 TPSTATUS-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSTATUS.cbl        $Revision: 1.4 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSTATUS.cbl     
      *>
      *>  TPSTATUS.cbl
      *>
        05 TP-STATUS  PIC S9(9) COMP-5.
                88 TPOK                 VALUE 0.
                88 TPEABORT             VALUE 1.
                88 TPEBADDESC           VALUE 2.
                88 TPEBLOCK             VALUE 3.
                88 TPEINVAL             VALUE 4.
                88 TPELIMIT             VALUE 5.
                88 TPENOENT             VALUE 6.
                88 TPEOS                VALUE 7.
                88 TPEPERM              VALUE 8.
                88 TPEPROTO             VALUE 9.
                88 TPESVCERR            VALUE 10.
                88 TPESVCFAIL           VALUE 11.
                88 TPESYSTEM            VALUE 12.
                88 TPETIME              VALUE 13.
                88 TPETRAN              VALUE 14.
                88 TPEGOTSIG            VALUE 15.
                88 TPERMERR             VALUE 16.
                88 TPEITYPE             VALUE 17.
                88 TPEOTYPE             VALUE 18.
                88 TPERELEASE           VALUE 19.
                88 TPEHAZARD            VALUE 20.
                88 TPEHEURISTIC         VALUE 21.
                88 TPEEVENT             VALUE 22.
                88 TPEMATCH             VALUE 23.
                88 TPEDIAGNOSTIC        VALUE 24.
                88 TPEMIB               VALUE 25.
                88 TPEMAXVAL            VALUE 26.
      *>
        05 TPEVENT                PIC S9(9) COMP-5.
                88 TPEV-NOEVENT         VALUE 0.
                88 TPEV-DISCONIMM       VALUE 1.
                88 TPEV-SENDONLY        VALUE 2.
                88 TPEV-SVCERR          VALUE 3.
                88 TPEV-SVCFAIL         VALUE 4.
                88 TPEV-SVCSUCC         VALUE 5.
      *>
        05 APPL-RETURN-CODE       PIC S9(9) COMP-5.
      *>
        01  TPSVCDEF-REC.
      *>
      *> Copyright (c) 1992 USL
      *> All rights reserved
      *>
      *> THIS IS UNPUBLISHED PROPRIETARY
      *> SOURCE CODE OF USL
      *> The copyright notice above does not
      *> evidence any actual or intended
      *> publication of such source code.
      *>
      *>   Copyright:   (c) 1991, 1992, by BULL HN Information Systems Lt
      *> This Source Code has been provided by Bull Information Systems L
      *> under a License Agreement containing restrictions on its disclos
      *> This software contains proprietary information constituting valu
      *> Bull trade secrets and is also protected by copyright law as an
      *> unpublished work.
      *>
      *> #ident  "@(#) cobol/cobatmi/TPSVCDEF.cbl        $Revision: 1.5 $
      *> static  char    sccsid[] = "@(#) cobol/cobatmi/TPSVCDEF.cbl     
      *>
      *>  TPSVCDEF.cbl
      *>
        05 COMM-HANDLE          PIC S9(9) COMP-5.
        05 TPBLOCK-FLAG         PIC S9(9) COMP-5.
                88 TPBLOCK         VALUE 0.
                88 TPNOBLOCK       VALUE 1.
        05 TPTRAN-FLAG          PIC S9(9) COMP-5.
                88 TPTRAN          VALUE 0.
                88 TPNOTRAN        VALUE 1.
        05 TPREPLY-FLAG         PIC S9(9) COMP-5.
                88 TPREPLY         VALUE 0.
                88 TPNOREPLY       VALUE 1.
        05 TPACK-FLAG         REDEFINES TPREPLY-FLAG.
           10 FILLER PIC S9(9) COMP-5.
                88 TPNOACK         VALUE 0.
                88 TPACK           VALUE 1.
        05 TPTIME-FLAG          PIC S9(9) COMP-5.
                88 TPTIME          VALUE 0.
                88 TPNOTIME        VALUE 1.
        05 TPSIGRSTRT-FLAG      PIC S9(9) COMP-5.
                88 TPNOSIGRSTRT    VALUE 0.
                88 TPSIGRSTRT      VALUE 1.
        05 TPGETANY-FLAG        PIC S9(9) COMP-5.
                88 TPGETHANDLE     VALUE 0.
                88 TPGETANY        VALUE 1.
        05 TPSENDRECV-FLAG      PIC S9(9) COMP-5.
                88 TPSENDONLY      VALUE 0.
                88 TPRECVONLY      VALUE 1.
        05 TPNOCHANGE-FLAG      PIC S9(9) COMP-5.
                88 TPCHANGE        VALUE 0.
                88 TPNOCHANGE      VALUE 1.
        05 TPSERVICETYPE-FLAG   PIC S9(9) COMP-5.
                88  TPREQRSP       VALUE IS 0.
                88  TPCONV         VALUE IS 1.
      *>
        05 APPKEY               PIC S9(9) COMP-5.
        05 CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.
        05 SERVICE-NAME            PIC X(127).
      
      *>*****************************************************
      *> Log message definitions 
      *>*****************************************************
        01  LOGMSG.
                05  LOGMSG-PROG  VALUE 'GNSPQTAB :' PIC X(10) .
                05  LOGMSG-NUMB  VALUE '00'         PIC X(02).
                05  LOGMSG-TIME  VALUE '00000000'   PIC X(08).
                05  LOGMSG-TEXT.
                    07  LOGMSG-TEXT-1               PIC X(04).
                    07  LOGMSG-TEXT-2               PIC X(06).
                    07  LOGMSG-TEXT-3               PIC X(40).
                
        01  LOGMSG-LEN            PIC S9(9)  COMP-5.
      
      *> VARIABLES FRM                                                   
      *> PROCESA INTERFACES BMS Y PTC V31                                
      *>                                                                 
       01  FRM-VARI.                                                    
           03 FRM-TCMA  COMP          PIC S9(4).                        
           03 FRM-CMMA.                                                 
              05 FRM-SCR-MENS         PIC X(79).                        
              05 FRM-SCR-VARI         PIC X(3421).                      
           03 FRM-STAT                PIC X(03).                        
              88 FRM-STAT-OKS   VALUE 'OKS'.                            
              88 FRM-STAT-ABT   VALUE 'ABT'.                            
           03 FRM-NAME                PIC X(007).                       
           03 FRM-NLIB                PIC X(007).                       
           03 FRM-PLIN       VALUE 1  PIC 9(02).                        
           03 FRM-NLIN       VALUE 0  PIC 9(02).                        
           03 FRM-PCUR  COMP          PIC S9(04).                       
           03 FRM-UCUR  VALUE SPACES  PIC  X(01).                       
           03 FRM-TFLD  COMP          PIC S9(04).                       
           03 FRM-AUXI                PIC X(2000).                      
           03 FRM-DFLD.                                                 
              05 FRM-COD-MENS         PIC X(12).                        
              05 FRM-GLS-MENS         PIC X(79).                        
              05 FRM-DATA.                                              
                 07 FRM-NAME-IDEN     PIC X(12).                        
                 07 FRM-NAME-CMPL     PIC X(1988).                      
           03 FRM-LFLD  COMP          PIC S9(04).                       
           03 FRM-IFLD  COMP          PIC  9(09).                       
           03 FRM-MENS                PIC X(79).                        
           03 FRM-MENS-RED REDEFINES  FRM-MENS.                         
              05 FRM-MEN1             PIC X(40).                        
              05 FRM-MEN2             PIC X(39).                        
           03 FRM-ABRV                PIC X(05).                        
           03 FRM-FFLD                PIC X.                            
           03 FRM-SUAR                PIC X(03).                        
           03 FRM-SINI                PIC 9(01).                        
           03 FRM-CMND                PIC 9(02).                        
           03 FRM-IHDL   VALUE SPACES PIC X(01).                        
      *> PTC: VARIABLES NECESARIAS AMBIENTE PLATAFORMA COMERCIAL         
      *> PTC: COLA                                                       
           03 FRM-COLA.                                                 
      *> PTC: TERMINAL PARA CONFORMAR COLAS LECTURA/ESCRITURA            
              05 FRM-TERM             PIC X(04).                        
      *> PTC: IDENTIFICAR COLAS LECTURA/ESCRITURA                        
              05 FRM-TYPE             PIC X(03).                        
      *> PTC: LARGO ITEM DE COLA                                         
           03 FRM-LITM  COMP          PIC S9(4).                        
                                                                        
       01  FRM-CTTS.                                                    
           03 FRM-INI                 PIC 9(02) VALUE 1.                
           03 FRM-GET-ALL             PIC 9(02) VALUE 2.                
           03 FRM-PUT-ALL             PIC 9(02) VALUE 3.                
           03 FRM-CLR-ALL             PIC 9(02) VALUE 4.                
           03 FRM-MSG                 PIC 9(02) VALUE 5.                
           03 FRM-RCV                 PIC 9(02) VALUE 6.                
      *> MHM-INI 28-FEB-2011 MODERNIZACION MIGRACION DB2
           03 FRM-ABT                 PIC 9(02) VALUE 10.               
      *> MHM-FIN 28-FEB-2011 MODERNIZACION MIGRACION DB2
           03 FRM-CLR-FRM             PIC 9(02) VALUE 7.                
           03 FRM-SINI-DB1F           PIC 9(01) VALUE 0.                
           03 FRM-SINI-DBNF           PIC 9(01) VALUE 1.                
           03 FRM-SINI-DBLF           PIC 9(01) VALUE 2.                
           03 FRM-SINI-MB1F           PIC 9(01) VALUE 3.                
           03 FRM-SINI-MBNF           PIC 9(01) VALUE 4.                
           03 FRM-SINI-MBLF           PIC 9(05) VALUE 5.                
           03 FRM-FFLD-PA1            PIC X VALUE '%'.                  
           03 FRM-FFLD-PA2            PIC X VALUE '>'.                  
           03 FRM-FFLD-PA3            PIC X VALUE ','.                  
           03 FRM-FFLD-RET            PIC X VALUE ''''.                 
           03 FRM-FFLD-TAB            PIC X VALUE '3'.                  
           03 FRM-FFLD-PF1            PIC X VALUE '1'.                  
           03 FRM-FFLD-PF2            PIC X VALUE '2'.                  
           03 FRM-FFLD-PF3            PIC X VALUE '3'.                  
           03 FRM-FFLD-PF4            PIC X VALUE '4'.                  
           03 FRM-FFLD-PF5            PIC X VALUE '5'.                  
           03 FRM-FFLD-PF6            PIC X VALUE '6'.                  
           03 FRM-FFLD-PF7            PIC X VALUE '7'.                  
           03 FRM-FFLD-PF8            PIC X VALUE '8'.                  
           03 FRM-FFLD-PF9            PIC X VALUE '9'.                  
           03 FRM-FFLD-PF10           PIC X VALUE ':'.                  
           03 FRM-FFLD-PF11           PIC X VALUE '#'.                  
           03 FRM-FFLD-PF12           PIC X VALUE '@'.                  
           03 FRM-FFLD-PFA            PIC X VALUE 'A'.                  
           03 FRM-FFLD-PFB            PIC X VALUE 'B'.                  
           03 FRM-FFLD-PFC            PIC X VALUE 'C'.                  
           03 FRM-FFLD-PFD            PIC X VALUE 'D'.                  
           03 FRM-FFLD-PFE            PIC X VALUE 'E'.                  
           03 FRM-FFLD-PFF            PIC X VALUE 'F'.                  
           03 FRM-FFLD-PFG            PIC X VALUE 'G'.                  
           03 FRM-FFLD-PFH            PIC X VALUE 'H'.                  
           03 FRM-FFLD-PFI            PIC X VALUE 'I'.                  
           03 FRM-FFLD-PFJ            PIC X VALUE '?'.                  
           03 FRM-FFLD-PFK            PIC X VALUE '.'.                  
           03 FRM-FFLD-PFL            PIC X VALUE '<'.                  
           03 FRM-SUAR-MAL            PIC X(3) VALUE 'MAL'.             
           03 FRM-SUAR-WRN            PIC X(3) VALUE 'WRN'.             
           03 FRM-SUAR-CLR            PIC X(3) VALUE 'CLR'.             
           03 FRM-SUAR-OKS            PIC X(3) VALUE 'OKS'.             
           03 FRM-CPIM.                                                 
      *> AEY = Protegido, normal                                         
              05 FRM-CPIM-AEY         PIC X(01) VALUE '1'.              
      *> UBY = Desprotegido, brillante                                   
              05 FRM-CPIM-UBY         PIC X(01) VALUE 'I'.              
      *> ANY = Protegido, non-display                                    
              05 FRM-CPIM-ANY         PIC X(01) VALUE '_'.              
      *> UNY = Desprotegido, non-display                                 
              05 FRM-CPIM-UNY         PIC X(01) VALUE '('.              
      *> ANY = Protegido, normal                                         
              05 FRM-CPSF-AEY         PIC X(01) VALUE '-'.              
      *> ABY = Protegido, brillante                                      
              05 FRM-CPIM-ABY         PIC X(01) VALUE '9'.              
      *> UST = Virtual para BMS, pues es campo STOPPER en UNISYS         
              05 FRM-CPIM-UST         PIC X(01) VALUE SPACES.           
           03 FRM-POS-CURS COMP   PIC S9(04) VALUE -1.                  
           03 FRM-IND-ERRO COMP   PIC S9(04) VALUE -1.                  
           03 FRM-ERR-NUME COMP   PIC S9(04) VALUE -9.                  
           03 FRM-RST-PCUR COMP   PIC S9(04) VALUE ZEROES.              
                     
      *> COPY GNSWGFRM.
      *>
       01  PGM-STAT.
              05 PGM-STAT-TSI           VALUE '23'      PIC X(02).
                 88 PGM-STAT-TSI-OKS    VALUE '00'.
                 88 PGM-STAT-TSI-NUL    VALUE '  '.
      *> VARIABLES A TRANSFERIR A COMMAND DESDE ZOOM.
      *>    TAMANO
       01  WSS-TCMA-CMN  COMP              PIC S9(4).
      *>01  WSS-VARI.
      *>     03 WSS-QIDD.
      *>        05 WSS-NIDD VALUE "GIDD"    PIC X(04).
      *>        05 WSS-TIDD                 PIC X(04).
           03 WSS-J             VALUE 0                PIC 9(04).
           03 WSS-K             VALUE 0                PIC 9(04).
      *>LGM-BNL-06.04.1995-INI
           03 WSS-IND-PRIMER    VALUE ZEROES           PIC 9.
              88 PRIMERA-VEZ    VALUE 1.
           03 WSS-NUM-TSO       VALUE ZEROES           PIC 9(03).
           03 WSS-IND-ERROR     VALUE 999              PIC 9(03).
           03 WSS-MNU-GLS-ERRO  VALUE SPACES           PIC X(07).
           03 WSS-MNU-COD-CMND  VALUE SPACES           PIC X(03).
           03 WSS-TDI-ERROR     VALUE SPACES           PIC X.
              88 TDI-GLS-ERROR  VALUE 'S'.
      *>     03 WSS-TSO           VALUE SPACES           PIC X(2014).
      *>LGM-BNL-06.04.1995-FIN
           03 WSS-NITM          VALUE 1                PIC 9(03).
      
      *> VARIABLES PARA MANEJO DE ERROR
       01  WSS-ERR-VARI.
           03 WSS-DTC-ERR                    PIC X(01).
           03 WSS-IDX-ERR                    PIC 9(05).
           03 WSS-IDX-FLD-ERR                PIC 9(05).
           03 WSS-MAX-FLD-HST                PIC 9(05).
           03 WSS-NUM-L3                     PIC 9(03).
           03 WSS-MSG-PTC.
              05 WSS-MSG-PTC0                PIC X(02).
              05 WSS-MSG-PTC1                PIC X(03).
      *>        05 WSS-MSG-PTC2                PIC X(03).
              05 WSS-MSG-PTC3                PIC X(04).
           03 WSS-SEP-NFRM.
              05 WSS-SEP-NFRM1               PIC X(04).
              05 WSS-SEP-NFRM2               PIC X(03).
           03 WSS-NUM-ERR-PTC                PIC 9(04).
           03 WSS-GLS-ERR-PTC VALUE SPACES   PIC X(20).
      
      *> VARIABLES PARA MANEJO DE ESTADISTICAS
       01  WSS-ESTD.
      *> PARA COMPARAR REGISTROS A ELIMINAR
           03 WSS-ESTD-ELIM         VALUE SPACES       PIC X(10).
      *> PARA EDITAR HORA
           03 WSS-ESTD-HORA            PIC Z(9).
           03 WSS-ESTD-CTAB.
              05 WSS-ESTD-CTAB-01   VALUE 'MONITORPTC' PIC X(10).
              05 WSS-ESTD-CTAB-02   VALUE ZEROES       PIC 9(02).
           03 WSS-ESTD-DESC.
      
      *> FUNCION DE MENU
              05 WSS-ESTD-DESC-01   VALUE SPACES PIC X(12).
      
      *> ESPACIOS
              05 WSS-ESTD-DESC-02   VALUE SPACES PIC X(02).
      
      *> INSTANCIA
      *>   INIPGM INICIO DEL PROGRAMA COLPPMTD
      *>   LEEMNU LECTURA DE UNA NUEVA FUNCION DE MENU
      *>   LINK   INVOCACION A UN PROGRAMA
      *>   RETURN RETORNO DE UN PROGRAMA
      *>   INIRSP INICIO ESTRUCTURACION DE RESPUESTA
      *>   FINPGM FIN DEL PROGRAMA
              05 WSS-ESTD-DESC-03   VALUE SPACES PIC X(06).
      
      *> ESPACIOS
              05 WSS-ESTD-DESC-04   VALUE SPACES PIC X(02).
      
      *> HORA DEL EVENTO
              05 WSS-ESTD-DESC-05   VALUE SPACES PIC X(30).
      
       01  WSS-VARI.
           03 WSS-INST-OLD                   PIC X(03).
           03 WSS-INST-NEW                   PIC X(03).
      *> ISP: PUNTEROS VARIOS
           03 WSS-AUXI     VALUE ZEROES      PIC 9(05).
           03 WSS-I        VALUE ZEROES      PIC 9(05).
           03 WSS-PINI     VALUE ZEROES      PIC 9(05).
           03 WSS-LENG     VALUE ZEROES      PIC 9(05).
           03 WSS-ELEM     VALUE ZEROES      PIC 9(05).
           03 WSS-RKEY-ABP VALUE ZEROES      PIC 9(05).
           03 WSS-RKEY-TSI VALUE ZEROES      PIC 9(05).
           03 WSS-RKEY-TSO VALUE ZEROES      PIC 9(05).
           03 WSS-BTDI     VALUE ZEROES      PIC 9(05).
           03 WSS-BTSI     VALUE ZEROES      PIC 9(05).
           03 WSS-LTDI     VALUE ZEROES      PIC 9(05).
           03 WSS-LMSG-SRV VALUE ZEROES      PIC 9(05).
           03 WSS-CTDI     VALUE ZEROES      PIC 9(05).
           03 WSS-ITDI     VALUE ZEROES      PIC 9(05).
      *> PUNTERO PARA MOVER UNO A UNO LOS CARACTERES A TDO, EN DEFINITIVA
      *> QUEDA CON EL LARGO DEL MENSAJE EN TDO
           03 WSS-ISRV     VALUE ZEROES      PIC 9(05).
           03 WSS-FST-SRV                    PIC X(01).
      
      *> ISP: NUMERO NUMERICO
           03 WSS-NUM-99   VALUE ZEROES      PIC 9(02).
      *> ISP: NUMERO ALFABETICO
           03 WSS-NUM-XX REDEFINES WSS-NUM-99.
              05 WSS-NUM-XX1                 PIC X(01).
              05 WSS-NUM-XX2                 PIC X(01).
      
      *> ISP: AMBIENTE QUE ORIGINO EL MENSAJE ( HST O SRV )
           03 WSS-COD-ORIG                   PIC X(03).
      *> ISP: ORIGINARIO DE HOST
           03 WSS-COD-ORIG-HST VALUE 'HST'   PIC X(03).
      *> ISP: ORIGINARIO DE SERVER
           03 WSS-COD-ORIG-SRV VALUE 'SRV'   PIC X(03).
           03 WSS-COD-CTAB.
              05 WSS-COD-1TAB                PIC X(07).
              05 WSS-COD-2TAB                PIC X(05).
      
      *> ISP: VARIABLE PARA GUARDAR NOMBRE DE PANTALLA
           03 WSS-MNU-GLS-NFRM                   PIC X(07).
      *> ISP: VARIABLE PARA COMPARACION NOMBRE PANTALLA HOST
           03 WSS-GLS-NFRM-HST                   PIC X(07).
      *> ISP: VARIABLE PARA COMPARACION NOMBRE PANTALLA SERVER
           03 WSS-GLS-NFRM-SRV                   PIC X(10).
      
      *> ISP: VARIABLE INDICE PARA BUSCAR SI EXISTE OCURRENCIA
      *>      DE CAMPO CORRELATIVO "HST" EN TABLA "SRV"
      *>      DE ESTA FORMA LA TABLA "SRV" NO NECESARIAMENTE
      *>      DEBE ESTAR ORDENADA ASCENDENTEMENTE
           03 WSS-IDX-SRV-ASC VALUE ZEROES        PIC 9(05).
      *> ISP: VARIABLE PARA INDICAR SI ENCUENTRA OCURRENCIA
      *>      EN TABLA SRV
           03 WSS-IND-ESRV    VALUE SPACES        PIC X(01).
      *> ISP: VARIABLE AUXILIAR PARA SUMAR WSS-IDX-FLD-SRV
           03 WSS-IDX-AUX     VALUE ZEROES        PIC 9(05).
      *>
      *> ISP: VARIABLE QUE UNE DESCRIPCION DE TABLA
           03 WSS-GLS-TAB.
              05 WSS-GLS-DESC                PIC X(40).
              05 WSS-GLS-DATA                PIC X(60).
      
           03 WSS-GLS-TAB-HST REDEFINES WSS-GLS-TAB.
              05 WSS-COD-TAB-HST OCCURS 50 TIMES PIC 9(02).
      
           03 WSS-GLS-TAB-SRV REDEFINES WSS-GLS-TAB.
              05 WSS-COD-TAB-SRV OCCURS 33 TIMES PIC 9(03).
              05 WSS-COD-TAB-SRV-RST             PIC X(01).
      *> ISP: VARIABLE INDICE DE ESTRUCTURA TABLA HST
           03 WSS-IDX-TAB-HST VALUE ZEROES        PIC 9(05).
      *> ISP: VARIABLE INDICE DE ESTRUCTURA TABLA SRV
           03 WSS-IDX-TAB-SRV VALUE ZEROES        PIC 9(05).
      
      
      *> ISP: VECTOR PARA ESTRUCTURAR REGISTRO IMAGEN SERVER
           03 WSS-GLS-MSG-SRV.
              05 WSS-GLS-HDR-SRV     VALUE  SPACES PIC X(25).
              05 WSS-GLS-FRM-SRV     VALUE  SPACES.
                 07 WSS-COD-FRM-SRV OCCURS 1330 TIMES  PIC X(01).
      *> ISP: VARIABLE INDICE DE ESTRUCTURA REGISTRO IMAGEN
      *>      POSICION DE INICIO
           03 WSS-IDX-FRM-SRV VALUE ZEROES          PIC 9(05).
      
      *> ISP: VECTOR DE POSICIONES REGISTRO IMAGEN HOST
           03 WSS-GLS-POS-HST VALUE ZEROES.
              05 WSS-NUM-POS-HST OCCURS 300 TIMES  PIC 9(05).
      
      *> ISP: VARIABLE INDICE DE VECTOR DE POSICIONES
      *>      REGISTRO IMAGEN HOST ( CONTADOR DE CAMPOS )
           03 WSS-IDX-FLD-HST        VALUE ZEROES   PIC 9(05).
      *> ISP: VARIABLE INDICE DE VECTOR DE POSICIONES SERVER
      *>      REGISTRO IMAGEN SERVER ( CONTADOR DE CAMPOS )
           03 WSS-IDX-FLD-SRV        VALUE ZEROES   PIC 9(05).
      
      *> ISP: VECTOR DE LARGOS REGISTRO IMAGEN HOST
           03 WSS-GLS-LEN-HST VALUE ZEROES.
              05 WSS-NUM-LEN-HST OCCURS 300 TIMES  PIC 9(03).
      
      *> ISP: VECTOR DE CAMPOS QUE COMPONEN REGISTRO IMAGEN SERVER
           03 WSS-GLS-FLD-SRV VALUE ZEROES.
              05 WSS-COD-FLD-SRV OCCURS 300 TIMES  PIC 9(03).
      
      *> ISP: TOTAL DE CAMPOS EN DEFINICION MAPA HOST
           03 WSS-TOT-FLD-HST        VALUE ZEROES   PIC 9(05).
      *> ISP: TOTAL DE CAMPOS EN DEFINICION MAPA SERVER
           03 WSS-TOT-FLD-SRV        VALUE ZEROES   PIC 9(05).
      *> ISP: VARIABLE AUXILIAR PARA MANEJO DE PANTALLA CON
      *>      CODIGO DE MENSAJE Y GLOSA DE MENSAJE
           03 WSS-FRM-TSI                   PIC X(2011).
      *> ISP: VARIABLE INDICADOR DE ERROR
      *>
           03 WSS-IND-ERR VALUE 'N'         PIC X(01).
      *>
      *> ISP: VARIABLES DE RESPALDO PARA MENSAJE AL SERVER
           03 WSS-IDX-SRV  VALUE ZEROES      PIC 9(05).
      *> ESTRUCTURA PARA GUARDAR INFORMACION HISTORICA DEL SERVER
      *>ISP INI ERROR DESDE EL INICIO DEL SISTEMA TOT TXS MTX
      *>    03 WSS-SRV-VARI OCCURS 30 TIMES.
           03 WSS-SRV-VARI OCCURS 80 TIMES.
      *>ISP FIN ERROR DESDE EL INICIO DEL SISTEMA TOT TXS MTX
      
      *> SISTEMA DONDE SE ENCUENTRA LA DEFINICION DEL FORMATO
              05 WSS-SRV-SIST                PIC X(03).
      
      *> NOMBRE DE LA PANTALLA PARA BUSCAR EL FORMATO
              05 WSS-SRV-NFRM                PIC X(07).
      
      *> FORMATO DE INPUT ASOCIADO A CADA SUBMENSAJE DE OUTPUT
      *> ( QUE RESPONDER POR CADA PANTALLA, PUEDE ESTAR VACIO )
              05 WSS-SRV-FOUT                PIC X(03).
      
      *> ISP: VARIABLES PARA REVISAR Y LIMPIAR CAMPOS DE TAL MODO QUE
      *>      SIEMPRE SE RESPETE LO QUE EL USUARIO DIGITO
      *>      EJ: SOBREPOSICION DE CAMPOS NUMERICOS
           03 WSS-SWI-FLD-USR                PIC X(01).
           03 WSS-IDX-FLD-USR                PIC 9(05).
      
       01  WSS-CMMA VALUE SPACES.
           03  WSS-ORIG.
               05  WSS-MODO                  PIC X(01).
               05  WSS-CNAL                  PIC X(03).
               05  WSS-IERR                  PIC X(01).
       01  WSS-TCMA                 VALUE +5 PIC S9(04).
      
      *>INI-PENTA TUXEDO ORACLE
      *> LINKAGE SECTION.
      
                     
      *>FIN-PENTA TUXEDO ORACLE
      *>----------------
       01  DFHCOMMAREA.
           02 FILLER                             PIC X(18).
      *>GNSLGFIO CB2                                                     
       01  FIO-BUF0.                                                    
           02 FILLER                 PIC X(1536).                       
                     
      
       PROCEDURE DIVISION.
      *>===================
      
       MAIN SECTION.
       INI-MAIN.
      *>ini Limpieza de variables
           DISPLAY 'entro a gnsppmti  :'.
           MOVE 0                TO WSS-J.
           MOVE 0                TO WSS-K.
           MOVE ZEROES           TO WSS-IND-PRIMER.
           MOVE ZEROES           TO WSS-NUM-TSO.
           MOVE 999              TO WSS-IND-ERROR.
           MOVE 1                TO WSS-NITM.
           MOVE ZEROES           TO WSS-IDX-SRV.
           MOVE ZEROES           TO WSS-AUXI.
           MOVE ZEROES           TO WSS-I.
           MOVE ZEROES           TO WSS-PINI.
           MOVE ZEROES           TO WSS-LENG.
           MOVE ZEROES           TO WSS-ELEM.
           MOVE ZEROES           TO WSS-RKEY-ABP.
           MOVE ZEROES           TO WSS-RKEY-TSI.
           MOVE ZEROES           TO WSS-RKEY-TSO.
           MOVE ZEROES           TO WSS-BTDI.
           MOVE ZEROES           TO WSS-BTSI.
           MOVE ZEROES           TO WSS-LTDI.
           MOVE ZEROES           TO WSS-LMSG-SRV.
           MOVE ZEROES           TO WSS-CTDI.
           MOVE ZEROES           TO WSS-ITDI.
           MOVE ZEROES           TO WSS-ISRV.
           MOVE ZEROES           TO WSS-NUM-99.
           MOVE ZEROES           TO WSS-IDX-SRV-ASC.
           MOVE ZEROES           TO WSS-IDX-AUX.
           MOVE ZEROES           TO WSS-IDX-TAB-HST.
           MOVE ZEROES           TO WSS-IDX-TAB-SRV.
           MOVE ZEROES           TO WSS-IDX-FRM-SRV.
           MOVE ZEROES           TO WSS-GLS-POS-HST.
           MOVE ZEROES           TO WSS-IDX-FLD-HST.
           MOVE ZEROES           TO WSS-IDX-FLD-SRV.
           MOVE ZEROES           TO WSS-GLS-LEN-HST.
           MOVE ZEROES           TO WSS-GLS-FLD-SRV.
           MOVE ZEROES           TO WSS-TOT-FLD-HST.
           MOVE ZEROES           TO WSS-TOT-FLD-SRV.
           MOVE +5               TO WSS-TCMA.
      
           MOVE 'N'              TO WSS-IND-ERR.
           MOVE '23'             TO PGM-STAT-TSI.
           MOVE SPACES           TO WSS-GLS-ERR-PTC.
           MOVE SPACES           TO WSS-ESTD-ELIM.
           MOVE 'MONITORPTC'     TO WSS-ESTD-CTAB-01.
           MOVE ZEROES           TO WSS-ESTD-CTAB-02.
           MOVE SPACES           TO WSS-ESTD-DESC-01.
           MOVE SPACES           TO WSS-ESTD-DESC-02.
           MOVE SPACES           TO WSS-ESTD-DESC-03.
           MOVE SPACES           TO WSS-ESTD-DESC-04.
           MOVE SPACES           TO WSS-ESTD-DESC-05.
           MOVE SPACES           TO WSS-IND-ESRV.
           MOVE SPACES           TO WSS-GLS-HDR-SRV.
           MOVE SPACES           TO WSS-GLS-FRM-SRV.
           MOVE SPACES           TO WSS-MNU-GLS-ERRO.
           MOVE SPACES           TO WSS-MNU-COD-CMND.
           MOVE SPACES           TO WSS-TDI-ERROR.
      
      *>GNSWGMXX
           MOVE 'N'              TO WSS-IND-IBYA.
           MOVE ZEROES           TO WSS-PT-CHR-01.
           MOVE ZEROES           TO WSS-PT-LARG.
           MOVE ZEROES           TO WSS-PT-IDX-PT-ORIG.
           MOVE ZEROES           TO WSS-PT-IDX-PT-DEST.
           MOVE ZEROES           TO WSS-PT-IDX-PT-PNTR.
           MOVE ZEROES           TO WSS-PT-IDX-HDR-DEST.
           MOVE ZEROES           TO WSS-PT-IDX-HDR-ORIG.
           MOVE ZEROES           TO WSS-TX-IDX-ORIG.
           MOVE ZEROES           TO WSS-TX-IDX-DEST.
           MOVE ZEROES           TO WSS-TX-IDX-LARG.
           MOVE ZEROES           TO WSS-TX-IDX-PNTR.
           MOVE SPACES           TO PTC-WSS-BCKI-VAL.
           MOVE SPACES           TO PTC-WSS-BCKI-QUE.
      
           MOVE LENGTH OF LOGMSG TO LOGMSG-LEN.
           MOVE 'GNSPPMTI :'     TO LOGMSG-PROG.
      
      
      *>fin Limpieza de variables
      
      *>     ENTRY "DBMSCBL".                                            
                                                                        
                     
      *>INI-PENTA TUXEDO ORACLE
       
           MOVE LENGTH OF LOGMSG TO LOGMSG-LEN. 
      
           MOVE 'TPSVCSTART       '       TO LOGMSG-TEXT.
           MOVE '00'                      TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
           MOVE LENGTH OF DFHCOMMAREA TO LEN.
           MOVE LENGTH OF DFHCOMMAREA TO EIBCALEN.
           CALL "TPSVCSTART" USING TPSVCDEF-REC 
                        TPTYPE-REC 
                        DFHCOMMAREA
                        TPSTATUS-REC.      
      
           IF NOT TPOK
                MOVE "TPSVCSTART Failed" TO LOGMSG-TEXT
                    PERFORM DO-USERLOG 
                PERFORM PRG-ABT 
           END-IF.
      
      *>     IF TPTRUNCATE 
      *>          MOVE "Data was truncated" TO LOGMSG-TEXT
      *>              PERFORM DO-USERLOG 
      *>          PERFORM PRG-ABT 
      *>     END-IF.
      
           IF EIBCALEN = 0                                              
                 GOBACK.                                                
                      
           CALL "TPGETLEV" USING TPTRXLEV-REC TPSTATUS-REC. 
           IF NOT TPOK
              DISPLAY 'ERROR  TPGETLEV :' TP-STATUS
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'TPGETLEV TP-NOT-IN-TRAN:' TP-STATUS.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC TPSTATUS-REC.            
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
           
           CALL "TPRESUME" USING TPTRXDEF-REC TPSTATUS-REC.             
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           MOVE TRANID(1)           TO TSK-TRANID-1.
           MOVE TRANID(2)           TO TSK-TRANID-2.
           MOVE TRANID(3)           TO TSK-TRANID-3.
           MOVE TRANID(4)           TO TSK-TRANID-4.
           MOVE TRANID(5)           TO TSK-TRANID-5.
           MOVE TRANID(6)           TO TSK-TRANID-6.
           MOVE 'S'                 TO TSK-TERM-ORIGEN.
           MOVE SPACES              TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF      TO TSK-TERM-TUX.
           MOVE TSK-TERM-TUX        TO TSK-TERM-TUX.                    
           MOVE 'GET'               TO QUE-COM-SEND.                    
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.      
           MOVE 1                   TO QUE-NUM-SEND.      
           MOVE 4                   TO QUE-LAR-SEND.      
           MOVE SPACES              TO QUE-TRX-SEND.      
           MOVE SPACES              TO QUE-DAT-SEND.                    
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              DISPLAY 'NO ENCONTRO COLA ASUME 1111111 :' TSK-TERM-TUX  
              MOVE 1111111          TO TSK-TERM-NUM-TUX
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-NUM     TO EIBTASKN
              MOVE TSK-TERM-ALF     TO EIBTRMID
           ELSE           
              MOVE QUE-DAT-RECV     TO QUE-ITEM           
              MOVE QUE-DATA         TO TSK-TERM-NUM-TUX-ALF
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-ALF     TO EIBTASKN
              MOVE TSK-TERM-ALF     TO EIBTRMID.
                     
      *>FIN-PENTA TUXEDO ORACLE
           MOVE SPACES TO WSS-CMMA.
           IF EIBCALEN > 0
               IF EIBCALEN < WSS-TCMA
                   MOVE EIBCALEN TO WSS-TCMA
               END-IF
               MOVE DFHCOMMAREA(1:WSS-TCMA) TO WSS-CMMA
           END-IF.
      
           PERFORM GNS-HDL-VSM.
           MOVE DFHCOMMAREA(1:EIBCALEN) TO CTM-VARI.
      
      
      
      
      *> ESTA VERSION MANEJA COLA CON LARGO 100
      *> EN GNSWGMXX TIENE LARGO 3
           MOVE +100 TO WSS-HDR-LITM.
      
           MOVE +3327 TO TDI-LTDI.
           MOVE +3328 TO TDO-LTDO.
           MOVE +9000 TO TDI-LTDI.
           MOVE +9000 TO TDO-LTDO.
           PERFORM GET-TSK-TERM.
      
      
      *>DAD ini  08-OCT-1992
           PERFORM GNS-ERR-QUE.
      *>DAD fin  08-OCT-1992
      
           MOVE 'PTCQ' TO TDI-FIO-TERM
                          TDO-FIO-TERM.
           MOVE '00' TO FIO-STAT.
      
      
           PERFORM GET-TDI.
      
           PERFORM GNS-ERR-QUE.
      
           MOVE TSK-TERM-ALF TO TSI-FIO-TERM.
           MOVE TSK-TERM-ALF TO TSO-FIO-TERM.
           MOVE TSK-TERM-ALF TO SCR-OTRN.
           MOVE TSK-TERM-ALF TO OSC-OTRN.
           MOVE TSK-TERM-ALF TO TSC-OTRN.
           MOVE TDI-GLS-DESC TO WSS-HDR.
      
           DISPLAY 'WSS-HDR-VERS  :' WSS-HDR-VERS.
      
           IF WSS-HDR-VERS = 'HV01'
                MOVE 100 TO WSS-HDR-LHDR
                PERFORM SET-PREG-MNSF
                MOVE WSS-HDR-IBYA TO WSS-IND-IBYA
                MOVE WSS-HDR-USER TO     TSC-USER
                DISPLAY 'WSS-HDR-BNCO :' WSS-HDR-BNCO
                IF WSS-HDR-BNCO NOT > SPACES
                    PERFORM SET-DFL-AMB
                ELSE
                    PERFORM SET-CNX-HDR
      
           ELSE
                MOVE ZEROES TO WSS-HDR-LHDR
                    PERFORM SET-DFL-AMB.
      
           PERFORM PRO-CCI.
      
           MOVE 1 TO WSS-BTDI.
      
           ADD WSS-HDR-LHDR TO WSS-BTDI.
      
           MOVE WSS-COD-ORIG-SRV TO WSS-COD-ORIG.
      
           PERFORM DFL-TO-TSC.
      
           PERFORM HDR-TO-TSC.
      
           PERFORM DEL-TSI.
      
           PERFORM DEL-TSO.
      
           DISPLAY 'TDI-GLS-DATA :' TDI-GLS-DATA.
      
           PERFORM MSG-FROM-SRV UNTIL
              TDI-COD-TDI(WSS-BTDI) NOT > SPACES OR
              WSS-IND-ERR = 'S'.
      
           MOVE ZEROES TO WSS-RKEY-TSI.
           MOVE WSS-COD-ORIG-HST TO WSS-COD-ORIG.
           MOVE 1 TO WSS-BTDI.
           MOVE ZEROES TO WSS-IDX-FRM-SRV.
      
           MOVE ZEROES TO WSS-IDX-SRV.
           MOVE SPACES TO TDO-GLS-DATA IN TDO.
      
           PERFORM MSG-TO-SRV.
      
           IF WSS-IND-ERR = 'S'
               PERFORM BUS-ERR.
      
      
           PERFORM PUT-TDO.
      
           MOVE WSS-IND-ERR TO WSS-IERR.
           IF EIBCALEN > 0
               IF EIBCALEN < WSS-TCMA
                   MOVE EIBCALEN TO WSS-TCMA
               END-IF
               MOVE WSS-CMMA(1:WSS-TCMA) TO DFHCOMMAREA
           END-IF.
      
           PERFORM FIN.
       FIN-MAIN.
           EXIT.
      
       SET-PREG-MNSF SECTION.
       INI-SET-PREG-MNSF.
           MOVE WSS-HDR-MNSF TO WSS-PREG-POR-SPAC.
           IF WSS-PREG-POR-SPAC NOT > SPACES
               MOVE 'N' TO WSS-PREG-POR-SPAC.
       FIN-SET-PREG-MNSF.
           EXIT.
      
       SET-DFL-AMB SECTION.
       INI-SET-DFL-AMB.
      
           MOVE 'PNT'        TO TSC-BNCO.
           MOVE 'PNT'        TO TSC-MRCA.
           MOVE 'BEE'        TO TSC-CART.
           MOVE 'ES'         TO TSC-LENG.
           MOVE 'CL'         TO TSC-PAIS.
           MOVE SPACES       TO TSC-VRNT.
           MOVE SPACES       TO TSC-UMUA.
           MOVE SPACES       TO TSC-MODO.
      
           DISPLAY 'SET-DFL-AMB :' TSC-MRCA.
      
       FIN-SET-DFL-AMB.
           EXIT.
      
      
       SET-CNX-HDR SECTION.
       INI-SET-CNX-HDR.
           MOVE WSS-HDR-BNCO TO TSC-BNCO.
           MOVE WSS-HDR-MRCA TO TSC-MRCA.
           MOVE WSS-HDR-CART TO TSC-CART.
           MOVE WSS-HDR-LENG TO TSC-LENG.
           MOVE WSS-HDR-PAIS TO TSC-PAIS.
           MOVE WSS-HDR-VRNT TO TSC-VRNT.
           MOVE WSS-HDR-CNAL TO TSC-CNAL.
           MOVE WSS-HDR-CNAL TO WSS-CNAL.
           MOVE WSS-HDR-UMUA TO TSC-UMUA.
           MOVE WSS-HDR-MODO TO TSC-MODO.
      
           DISPLAY 'SET-CNX-HDR :' TSC-MRCA.
      
       FIN-SET-CNX-HDR.
           EXIT.
      
      
       PUT-ESTD SECTION.
       INI-PUT-ESTD.
      *>    ADD 1 TO WSS-ESTD-CTAB-02.
      *>    MOVE "GNS" TO FIO-SIST.
      *>    MOVE "MSG" TO TAB-COD-TTAB IN TAB.
      *>    MOVE WSS-ESTD-CTAB TO TAB-COD-CTAB IN TAB.
      *>    MOVE EIBTIME TO WSS-ESTD-HORA.
      *>    MOVE WSS-ESTD-HORA TO WSS-ESTD-DESC-05.
      *>    MOVE WSS-ESTD-DESC TO TAB-GLS-DESC.
      *>    MOVE FIO-PUT TO FIO-CMND.
      *>    PERFORM GNS-FIO-TAB.
       FIN-PUT-ESTD.
           EXIT.
       BUS-ERR SECTION.
       INI-BUS-ERR.
      
           MOVE 'DTCERR' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
      *>    PERFORM GNS-PRO-QUE.
      
           MOVE SPACES TO QUE-ITEM.
           MOVE 'DTCERR' TO QUE-COLA.
           MOVE WSS-MAX-FLD-HST TO WSS-NUM-L3.
           MOVE WSS-NUM-L3 TO QUE-IKEY.
           MOVE TSO TO QUE-DATA.
           MOVE +2000 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
      *>    PERFORM GNS-PRO-QUE.
      
           MOVE SPACES TO QUE-ITEM.
           MOVE 'DTCERR' TO QUE-COLA.
           MOVE WSS-GLS-POS-HST TO QUE-DATA.
           MOVE +2000 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
      *>    PERFORM GNS-PRO-QUE.
      
           IF SCR-IERR = 'A'
                MOVE 'ERROR DE SISTEMA : ' TO WSS-GLS-ERR-PTC
                GO TO FIN-BUS-ERR.
           MOVE 'N' TO WSS-DTC-ERR.
           SUBTRACT 1 FROM WSS-TOT-FLD-HST GIVING
               WSS-MAX-FLD-HST.
           PERFORM DTC-ERR VARYING WSS-IDX-ERR FROM 1
               BY 1 UNTIL WSS-DTC-ERR = 'S' OR
                       WSS-IDX-ERR > WSS-MAX-FLD-HST.
      
      *>LGM-BNL-06.04.1995-INI
           IF TDI-GLS-ERROR AND WSS-DTC-ERR = 'S'
              MOVE WSS-MNU-GLS-ERRO TO MNU-GLS-NFRM
              MOVE WSS-MNU-COD-CMND TO MNU-COD-CMND.
      *>LGM-BNL-06.04.1995-FIN
      
           IF WSS-DTC-ERR = 'S'
      *>          PERFORM PUT-POS
                MOVE TDI-COD-SIST-FRM TO FIO-SIST
                MOVE 'MSG' TO TAB-COD-TTAB IN TAB
      *> && : CORRELATIVO DE CAMPO
                MOVE '&&'         TO WSS-MSG-PTC0
                MOVE MNU-GLS-NFRM TO WSS-SEP-NFRM
                MOVE WSS-SEP-NFRM2 TO WSS-MSG-PTC1
      *>          MOVE MNU-COD-CMND TO WSS-MSG-PTC2
                MOVE WSS-NUM-ERR-PTC TO WSS-MSG-PTC3
                MOVE WSS-MSG-PTC TO TAB-COD-CTAB IN TAB
      *> << a.e.v. 27-03-1995  - ini
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS
                   MOVE TAB-GLS-DESC TO WSS-GLS-ERR-PTC
               ELSE
      *> << a.e.v. 27-03-1995  -fin
                    MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-ERR-PTC.
       FIN-BUS-ERR.
           EXIT.
      
       DTC-ERR SECTION.
       INI-DTC-ERR.
      *> ADD 12 - 3 = 9 : , PUES EN ESTA INSTANCIA ESTA ENTREGANDO
      *> EN VECTOR DE POSICIONES, LA POSICION DONDE EMPIEZA
      *> EL CAMPO Y SE REQUIERe LA POSICION DEL BYTE DE ATRIBUTOS
      *> DIFF ISP 10-02-1996
      *> DIFF ISP ESTA DIFERENCIA AUN NO HA SIDO DETECTADA
      *> SI SE DEBE SUMAR 9 O 12
           ADD 9 WSS-NUM-POS-HST(WSS-IDX-ERR)
      *>    ADD 12 WSS-NUM-POS-HST(WSS-IDX-ERR)
               GIVING WSS-IDX-FLD-ERR.
           MOVE TSO-COD-FRM-HST(WSS-IDX-FLD-ERR) TO WSS-NUM-XX1.
           ADD 1 TO WSS-IDX-FLD-ERR.
           MOVE TSO-COD-FRM-HST(WSS-IDX-FLD-ERR) TO WSS-NUM-XX2.
           IF WSS-NUM-99 NOT NUMERIC
               MOVE WSS-IDX-ERR TO WSS-NUM-ERR-PTC
               MOVE 'S' TO WSS-DTC-ERR.
       FIN-DTC-ERR.
           EXIT.
      
       PUT-POS SECTION.
       INI-PUT-POS.
      
      *> ESTE CODIGO GRABA LAS POSICIONES DE LOS CAMPOS
      *> PARA DEBUG EN DESARROLLO
      *>
           MOVE 'GNS' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'ZZZZZZZZZZZZ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE WSS-GLS-POS-HST TO TAB-GLS-DESC IN TAB.
           PERFORM GNS-FIO-TAB.
       FIN-PUT-POS.
           EXIT.
      
      *> GNS-GET-IDD SECTION.
      *> INI-GNS-GET-IDD.
      *>*La independencia de datos es IDD EN TEMPORARY
      *>*STORAGE ( VERSION 3
      *>     MOVE TSC-CIDD TO IDD-COD-CIDD IN IDD.
      *>     MOVE FIO-GET-KEY TO FIO-CMND.
      *>     PERFORM GNS-FIO-IDD.
      *>     IF FIO-STAT-OKS
      *>         MOVE IDD TO IDD-REGI
      *>         GO TO FIN-GNS-GET-IDD.
      *>     MOVE "DEFAULT" TO IDD-COD-CIDD IN IDD.
      *>     MOVE FIO-GET-KEY TO FIO-CMND.
      *>     PERFORM GNS-FIO-IDD.
      *>     IF NOT FIO-STAT-OKS
      *>         MOVE "NO EXISTE REGISTRO IDD CON LLAVE : " TO SYS-MEN1
      *>         MOVE IDD-COD-CIDD IN IDD                   TO SYS-MEN2
      *>         MOVE SYS-ABOR TO SYS-CMND
      *>         PERFORM GNS-PRO-SYS
      *>     ELSE
      *>         MOVE IDD TO IDD-REGI.
      *> FIN-GNS-GET-IDD.
      *>     EXIT.
      
      *> Modulo interactivo que busca IDD.
      *> ( EN ESTE PROGRAMA NO USA SCR-QIDD)
       GNS-GET-IDD SECTION.
       INI-GNS-GET-IDD.
      
           MOVE WSS-QIDD      TO QUE-COLA.
           MOVE   +1          TO QUE-NITM.
           MOVE WSS-QIDD-LEN  TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
      
           MOVE SPACES TO WSS-IND-QUE.
           PERFORM GNS-PRO-QUE.
           MOVE QUE-ITEM TO IDD-REGI.
       FIN-GNS-GET-IDD.
           EXIT.
      
      
      *> GET-IDD-IFD SECTION.
      *> INI-GET-IDD-IFD.
      *>     IF TSC-TIND = "T"
      *>         PERFORM GET-IDD
      *>     ELSE
      *>         PERFORM GET-IFD.
      *> FIN-GET-IDD-IFD.
      *>     EXIT.
      
      *> GET-IDD SECTION.
      *> INI-GET-IDD.
      *>     MOVE TSC-CIDD TO IDD-COD-CIDD IN IDD
      *>     MOVE FIO-GET-KEY TO FIO-CMND
      *>     PERFORM GNS-FIO-IDD
      *>     IF NOT FIO-STAT-OKS
      *>          MOVE "DEFAULT" TO IDD-COD-CIDD IN IDD
      *>          MOVE FIO-GET-KEY TO FIO-CMND
      *>          PERFORM GNS-FIO-IDD
      *>          IF NOT FIO-STAT-OKS
      *>              MOVE "NO EXISTE REGISTRO IDD CON LLAVE :"
      *>                            TO SYS-MEN1
      *>              MOVE TSC-CIDD TO SYS-MEN2
      *>              MOVE SYS-ABOR TO SYS-CMND
      *>              PERFORM GNS-PRO-SYS.
      
      *>    MOVE IDD TO IDD-REGI.
      *>    PERFORM GNS-PUT-IDD.
      *>    MOVE WSS-QIDD TO SCR-QIDD.
      *>    MOVE QUE-LITM TO SCR-LIDD.
      *>FIN-GET-IDD.
      *>    EXIT.
      
      *> GET-IFD SECTION.
      *> INI-GET-IFD.
      *>*    IF ( TSC-TIND = "C" ) OR ( TSC-TINF NOT > SPACES )
      *>     MOVE TSC-CIDD  TO IFD-COD-CIFD IN IFD
      *>     MOVE FIO-GET-KEY TO FIO-CMND
      *>     PERFORM GNS-FIO-IFD
      *>     IF NOT FIO-STAT-OKS
      *>         MOVE "DEFAULT" TO IFD-COD-CIFD IN IFD
      *>         MOVE FIO-GET-KEY TO FIO-CMND
      *>         PERFORM GNS-FIO-IFD
      *>         IF NOT FIO-STAT-OKS
      *>             MOVE "NO EXISTE REGISTRO IFD CON LLAVE :"
      *>                           TO SYS-MEN1
      *>             MOVE TSC-CIDD TO SYS-MEN2
      *>             MOVE SYS-ABOR TO SYS-CMND
      *>             PERFORM GNS-PRO-SYS.
      
      *>     MOVE IFD-GLS-DATA IN IFD TO IFD-FSIS.
      *> FIN-GET-IFD.
      *>     EXIT.
      
       GNS-PUT-IDD SECTION.
       INI-GNS-PUT-IDD.
      
           MOVE +490         TO QUE-LITM.
           MOVE TSK-TERM-ALF TO WSS-TIDD.
           MOVE +1           TO QUE-NITM.
      
      
           MOVE 'MOD'        TO QUE-COM-SEND.
           MOVE WSS-QIDD     TO QUE-NAM-SEND.
           MOVE QUE-NITM     TO QUE-NUM-SEND.
           MOVE QUE-LITM     TO QUE-LAR-SEND.
           MOVE SPACES       TO QUE-TRX-SEND.
           MOVE IDD-REGI     TO QUE-DAT-SEND.
           DISPLAY 'IDD-REGI ' IDD-REGI.
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              GO TO FIN-GNS-PUT-IDD.
      
           MOVE 'PUT'        TO QUE-COM-SEND.
           MOVE WSS-QIDD     TO QUE-NAM-SEND.
           MOVE ZEROES       TO QUE-NUM-SEND.
           MOVE QUE-LITM     TO QUE-LAR-SEND.
           MOVE SPACES       TO QUE-TRX-SEND.
           MOVE IDD-REGI     TO QUE-DAT-SEND.
           PERFORM GNS-MSJ-QUE.
      
       FIN-GNS-PUT-IDD.
            EXIT.
      
      *> COPY GNSBBIDD.
      *> Modulo FIO para registro IDD en DATACOM                         
       GNS-FIO-IDD SECTION.                                             
       INI-GNS-FIO-IDD.              
      
      
      
           MOVE ADR-IDD-REQA       TO ADR-REQA.                         
           MOVE 'IDD'              TO ADR-TABL IN ADR-REQA.   
           MOVE 999                TO ADR-DBID IN ADR-REQA
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'IDD-COD-CIDD' TO FIO-AKEY.
      
           MOVE 'IDD00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'IDD-COD-CIDD' OR FIO-AKEY NOT > SPACES )    
               MOVE IDD-COD-CIDD IN IDD TO ADR-VKEY IN ADR-REQA         
               MOVE 'IDD00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-IDD, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      
           MOVE IDD TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO IDD                                     
           ELSE                                                         
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'IDD'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-IDD-REQA.                               
      
       FIN-GNS-FIO-IDD.                                                 
           EXIT.                                                        
                     
      *> COPY GNSBFIFD.
      *> COPY GNSBGVSM.
      
      *> ISP  11-NOV-1992
      *> COPY GNSBGTDQ.
      *>
      *> CH-INI
      *>COPY LDCBFTDI.
       GNS-FIO-TDI SECTION.                                             
       INI-GNS-FIO-TDI.                                                 
           MOVE 'TDI' TO WSS-IND-QUE.                                   
           MOVE 'PL01'                   TO TDI-TYPE IN TDI-VARI.       
           MOVE TSK-TERM-ALF             TO TDI-TERM IN TDI-VARI.       
           MOVE TDI-COLA     IN TDI-VARI TO QUE-COLA.                   
           MOVE TDI-NUM-RECO IN TDI      TO QUE-NITM.                   
           MOVE TDI-LTDI TO QUE-LITM.                                   
           IF FIO-CMND = FIO-PUT                                        
               MOVE QUE-PUT  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-GET-KEY OR                                 
              FIO-CMND = FIO-GET-KEY-UPD                                
               MOVE QUE-GET  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-DEL                                        
               MOVE QUE-DEL  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-MOD                                        
               MOVE QUE-MOD  TO QUE-CMND.                               
                                                                        
           PERFORM GNS-PRO-QUE.                                         
           MOVE SPACES TO WSS-IND-QUE.                                  
                                                                        
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE '00' TO FIO-STAT                                    
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
       FIN-GNS-FIO-TDI.                                                 
           EXIT.                                                        
                                                                        
                     
      *> CH-FIN
      
      *> CH-INI
       GNS-FIO-TDO SECTION.                                             
       INI-GNS-FIO-TDO.                                                 
           MOVE 'TDO' TO WSS-IND-QUE.                                   
           MOVE 'PL02'               TO TDO-TYPE IN TDO-VARI.           
           MOVE TSK-TERM-ALF         TO TDO-TERM IN TDO-VARI.           
           MOVE TDO-COLA IN TDO-VARI TO QUE-COLA.                       
           MOVE 1                    TO QUE-NITM.                       
           MOVE TDO-LTDO TO QUE-LITM.                                   
           IF FIO-CMND = FIO-PUT                                        
               MOVE QUE-PUT  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-GET-KEY OR                                 
              FIO-CMND = FIO-GET-KEY-UPD                                
               MOVE QUE-GET  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-DEL                                        
               MOVE QUE-DEL  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-MOD                                        
               MOVE QUE-MOD  TO QUE-CMND.                               
                                                                        
           PERFORM GNS-PRO-QUE.                                         
           MOVE SPACES TO WSS-IND-QUE.                                  
                                                                        
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE '00' TO FIO-STAT                                    
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
                                                                        
       FIN-GNS-FIO-TDO.                                                 
           EXIT.                                                        
                     
      *> CH-FIN
      
      *> Modulo FIO para registro TSI en QUEUE                           
       GNS-FIO-TSI SECTION.                                             
       INI-GNS-FIO-TSI.                                                 
           MOVE TSI-FIO-TERM TO QUE-TERM.                               
           MOVE 'TSI'        TO QUE-TYPE.                               
           MOVE TSI-NUM-RECO IN TSI TO QUE-NITM.                        
           MOVE +2014 TO QUE-LITM.                                      
           IF FIO-CMND = FIO-PUT                                        
               MOVE QUE-PUT  TO QUE-CMND                                
               MOVE TSI-DATA TO QUE-DATA                                
           ELSE                                                         
           IF FIO-CMND = FIO-GET-KEY OR                                 
              FIO-CMND = FIO-GET-KEY-UPD                                
               MOVE QUE-GET  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-DEL                                        
               MOVE QUE-DEL  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-MOD                                        
               MOVE TSI-DATA TO QUE-DATA                                
               MOVE QUE-MOD  TO QUE-CMND.                               
                                                                        
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE '00' TO FIO-STAT                                    
               IF QUE-CMND = QUE-GET                                    
                    MOVE QUE-DATA TO TSI-DATA                           
              ELSE                                                      
                    NEXT SENTENCE                                       
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
       FIN-GNS-FIO-TSI.                                                 
           EXIT.                                                        
                     
      *> Modulo FIO para registro TSO en QUEUE                           
       GNS-FIO-TSO SECTION.                                             
       INI-GNS-FIO-TSO.                                                 
           MOVE TSO-FIO-TERM TO QUE-TERM.                               
           MOVE 'TSO'        TO QUE-TYPE.                               
           MOVE TSO-NUM-RECO IN TSO TO QUE-NITM.                        
           MOVE +2014 TO QUE-LITM.                                      
           IF FIO-CMND = FIO-PUT                                        
               MOVE QUE-PUT  TO QUE-CMND                                
               MOVE TSO-DATA TO QUE-DATA                                
           ELSE                                                         
           IF FIO-CMND = FIO-GET-KEY OR                                 
              FIO-CMND = FIO-GET-KEY-UPD                                
               MOVE QUE-GET  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-DEL                                        
               MOVE QUE-DEL  TO QUE-CMND                                
           ELSE                                                         
           IF FIO-CMND = FIO-MOD                                        
               MOVE TSO-DATA TO QUE-DATA                                
               MOVE QUE-MOD  TO QUE-CMND.                               
                                                                        
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
               MOVE '00' TO FIO-STAT                                    
               IF QUE-CMND = QUE-GET                                    
                    MOVE QUE-DATA TO TSO-DATA                           
              ELSE                                                      
                    NEXT SENTENCE                                       
           ELSE                                                         
               MOVE '23' TO FIO-STAT.                                   
       FIN-GNS-FIO-TSO.                                                 
           EXIT.                                                        
                     
      *> Version AIX
                     
       GNS-HDL-VSM SECTION.
       INI-GNS-HDL-VSM.
       
       FIN-GNS-HDL-VSM.
           EXIT.
                     
      
      *> Modulo para detener ejecucion de programa                       
       GNS-PRO-END SECTION.                                             
       INI-GNS-PRO-END.                                                 
           GOBACK.                                                      
       FIN-GNS-PRO-END.                                                 
           EXIT PROGRAM.                                                
                     
      *> Modulo FIO para registro TAB en DATACOM                         
       GNS-FIO-TAB SECTION.                                             
       INI-GNS-FIO-TAB.              
           MOVE ADR-TAB-REQA       TO ADR-REQA.                         
           MOVE 'TAB'              TO ADR-TABL IN ADR-REQA. 
           
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-TAB.                                   
       GRP-GNS-FIO-TAB.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-TAB, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-TAB.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      *>                                                                 
           MOVE 'TAB00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )    
               MOVE TAB-COD-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-STP-ITRN'                                 
               MOVE TAB-STP-ITRN IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-CIC-TABL'                                 
               MOVE TAB-CIC-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'TAB-EXT-TABL'                                 
               MOVE TAB-EXT-TABL IN TAB TO ADR-VKEY IN ADR-REQA         
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-TAB, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      *>JSS                                                              
           IF FIO-CMND = FIO-PUT OR FIO-MOD                             
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB          
                                           TAB-EXT-TTAB IN TAB          
                                           TAB-SNX-TTAB IN TAB.         
      *>                                                                 
           MOVE TAB TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO TAB                                     
           ELSE                                                         
      *>JSS     MOVE "GNSTAB" TO FIO-MEN2                                
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'TAB'    TO FIO-MENS-REG                            
      *>                                                                 
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-TAB-REQA.                               
       FIN-GNS-FIO-TAB.                                                 
           EXIT.                                                        
                     
      
      *>******************** ERR *********************                   
       GNS-HDL-SYS SECTION.                                             
       INI-GNS-HDL-SYS.                                                 
      *>EXEC CICS HANDLE CONDITION                                       
      *>          INVREQ   (OPE-GNS-ERR-SYS)                             
      *>          LENGERR  (IFI-GNS-ERR-SYS)                             
      *>          PGMIDERR (PGM-GNS-ERR-SYS)                             
      *>END-EXEC.                                                        
       FIN-GNS-HDL-SYS.                                                 
           EXIT.                                                        
       GNS-ERR-SYS SECTION.                                             
       OPE-GNS-ERR-SYS.                                                 
           MOVE 'ERROR PERMANENTE' TO SYS-MENS.                         
           GO TO ABT-GNS-ERR-SYS.                                       
       IFI-GNS-ERR-SYS.                                                 
           MOVE 'ERROR DE LARGO'   TO SYS-MENS.                         
           GO TO ABT-GNS-ERR-SYS.                                       
       PGM-GNS-ERR-SYS.                                                 
           MOVE 'PROGRAM ID ERROR' TO SYS-MENS.                         
           GO TO RET-GNS-ERR-SYS.                                       
       RET-GNS-ERR-SYS.                                                 
           GO TO FIN-GNS-PRO-SYS.                                       
       ABT-GNS-ERR-SYS.                                                 
      *>EXEC CICS XCTL                                                   
      *>          PROGRAM("GNSPPABT")                                    
      *>          COMMAREA(SYS-MENS)                                     
      *>          LENGTH(+79)                                            
      *>END-EXEC.                                                        
           MOVE +79        TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE 'GNSPPABT' TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                 TPTYPE-REC
                                 SYS-MENS
                                 TPSTATUS-REC.
       FIN-GNS-ERR-SYS.                                                 
           EXIT.                                                        
                     
      *> Rutina de Servicios del Sistema
       GNS-PRO-SYS SECTION.
       INI-GNS-PRO-SYS.
      
      
           MOVE SYS-STAT-OKS TO SYS-STAT.
           IF SYS-IHDL NOT > SPACES
               MOVE 'N' TO SYS-IHDL.
      
           GO TO DAT-GNS-PRO-SYS TIM-GNS-PRO-SYS EXT-GNS-PRO-SYS
                 XCT-GNS-PRO-SYS LNK-GNS-PRO-SYS ABT-GNS-PRO-SYS
           DEPENDING ON SYS-CMND.
           MOVE 'ABORTO, comando invalido en GNS-PRO-SYS:' TO SYS-MEN1.
           MOVE SYS-CMND                                   TO SYS-MEN2.
           GO TO ABT-GNS-PRO-SYS.
      
       DAT-GNS-PRO-SYS.
      
      
           IF SYS-HORA-HABI = 'S' AND SYS-HORA-FLAG = 'S'
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
           ACCEPT SYS-FHOY-2B FROM DATE.
      
           MOVE SYS-DHOY-2B TO SYS-DHOY.
           MOVE '/'         TO SYS-SLH1.
           MOVE SYS-MHOY-2B TO SYS-MHOY.
           MOVE '/'         TO SYS-SLH2.
           MOVE SYS-AHOY-2B TO SYS-AHOY.
      
           ACCEPT SYS-HHOY-2B FROM TIME.
      
           MOVE   SYS-HHHY-2B TO SYS-HHHY.
           MOVE   SYS-MMHY-2B TO SYS-MMHY.
           MOVE   SYS-SSHY-2B TO SYS-SSHY.
      
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
           IF SYS-AHOY < 60
               MOVE 20 TO SYS-SHOY SYS-SSTP
           ELSE
               MOVE 19 TO SYS-SHOY SYS-SSTP.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
      
      
           MOVE FYH-TCMA       TO LEN.
           MOVE "CARRAY"       TO REC-TYPE.
           MOVE FYH-PROG       TO SERVICE-NAME.
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               FYH-CMMA
                               TPTYPE-REC
                               FYH-CMMA
                               TPSTATUS-REC.
      
           IF NOT TPOK
              DISPLAY 'DAT-GNS-PRO-SYS    :' FYH-PROG
                                       ' '   TP-STATUS
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
      
           MOVE FYH-NUM-DHOY IN FYH-CMMA TO SYS-DHOY.
           MOVE '/'                      TO SYS-SLH1.
           MOVE FYH-NUM-MHOY IN FYH-CMMA TO SYS-MHOY.
           MOVE '/'                      TO SYS-SLH2.
           MOVE FYH-NUM-AHOY IN FYH-CMMA TO SYS-AHOY.
      
           MOVE FYH-NUM-HHHY IN FYH-CMMA TO SYS-HHHY.
           MOVE FYH-NUM-MMHY IN FYH-CMMA TO SYS-MMHY.
           MOVE FYH-NUM-SSHY IN FYH-CMMA TO SYS-SSHY.
      
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
           IF SYS-AHOY < 60
               MOVE 20 TO SYS-SHOY SYS-SSTP
           ELSE
               MOVE 19 TO SYS-SHOY SYS-SSTP.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
      
           IF SYS-HORA-HABI = 'S' 
              MOVE 'S' TO SYS-HORA-FLAG
           ELSE   
              MOVE 'N' TO SYS-HORA-FLAG.
      
           GO TO FIN-GNS-PRO-SYS.
       TIM-GNS-PRO-SYS.
      
           ACCEPT SYS-HHOY-2B FROM TIME.
           MOVE   SYS-HHHY-2B TO SYS-HHHY.
           MOVE   SYS-MMHY-2B TO SYS-MMHY.
           MOVE   SYS-SSHY-2B TO SYS-SSHY.
      
      
           MOVE FYH-TCMA       TO LEN.
           MOVE "CARRAY"       TO REC-TYPE.
           MOVE FYH-PROG       TO SERVICE-NAME.
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               FYH-CMMA
                               TPTYPE-REC
                               FYH-CMMA
                               TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'TIM-GNS-PRO-SYS    :' FYH-PROG
                                       ' '   TP-STATUS
              MOVE 0 TO TP-STATUS
              GO TO FIN-GNS-PRO-SYS.
      
           MOVE FYH-NUM-HHHY IN FYH-CMMA TO SYS-HHHY.
           MOVE FYH-NUM-MMHY IN FYH-CMMA TO SYS-MMHY.
           MOVE FYH-NUM-SSHY IN FYH-CMMA TO SYS-SSHY.
           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.
           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.
           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.
           GO TO FIN-GNS-PRO-SYS.
      
       EXT-GNS-PRO-SYS.
      
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-NTRN TO SYS-SCR-NTRN.
           MOVE +3500 TO LEN.
      
           SET TPSUCCESS TO TRUE.
           CALL "TPRETURN" USING TPSVCRET-REC
                                 TPTYPE-REC
                                 SYS-CMMA
                                 TPSTATUS-REC.
      
           GOBACK.
           GO TO STT-GNS-PRO-SYS.
       XCT-GNS-PRO-SYS.
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-TCMA   TO LEN.
           DISPLAY 'GNS SYS-CMMA:'SYS-CMMA.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  SYS-CMMA
                                  TPSTATUS-REC.
           IF NOT TPOK
           DISPLAY 'XCT-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
           GOBACK.
           GO TO STT-GNS-PRO-SYS.
       LNK-GNS-PRO-SYS.
      
           MOVE SPACES   TO SYS-SCR-NTRN.
           MOVE SYS-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
      
           DISPLAY 'SYS-CMMA :' SYS-CMMA.
      
           CALL "TPCALL" USING TPSVCDEF-REC
                               TPTYPE-REC
                               SYS-CMMA
                               TPTYPE-REC
                               SYS-CMMA
                               TPSTATUS-REC.
      
           IF NOT TPOK
           DISPLAY 'LNK-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
      
           GO TO STT-GNS-PRO-SYS.
      
       ABT-GNS-PRO-SYS.
      
           MOVE 'GNSPPABT' TO SYS-PROG.
           MOVE +79        TO SYS-TCMA.
           MOVE SYS-TCMA   TO LEN.
           MOVE "CARRAY"   TO REC-TYPE.
           MOVE SYS-PROG   TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  SYS-MENS
                                  TPSTATUS-REC.
           IF NOT TPOK
           DISPLAY 'ABT-GNS-PRO-SYS    :' SYS-PROG
                                    ' '   TP-STATUS.
      
           GOBACK.
      
       STT-GNS-PRO-SYS.
           IF TPOK
               MOVE '00' TO SYS-STAT
               GO TO FIN-GNS-PRO-SYS.
      
           MOVE TP-STATUS                         TO SYS-STAT-NUM.
           MOVE 'Aborto, EN GNS-PRO-SYS , CMD : ' TO SYS-MEN1.
           MOVE SYS-CMND                          TO SYS-MEN2.
           MOVE SYS-STAT-NUM TO SYS-STAT.
           GO TO ABT-GNS-PRO-SYS.
      
       FIN-GNS-PRO-SYS.
           EXIT.
      
      *>*****************************************************
      *> Write out a log err messages
      *>*****************************************************
       DO-USERLOG SECTION.
       INI-DO-USERLOG.
      
           MOVE LENGTH OF LOGMSG TO LOGMSG-LEN.
           ACCEPT SYS-HHOY-2B  FROM TIME.
           MOVE  SYS-HHOY-2B     TO LOGMSG-TIME.
           CALL "USERLOG" USING LOGMSG
                LOGMSG-LEN
                TPSTATUS-REC.
      
       FIN-DO-USERLOG.
           EXIT.
                     
      
      *> Modulo FIO para registro MNU en DATACOM                         
       GNS-FIO-MNU SECTION.                                             
       INI-GNS-FIO-MNU.              
      
           MOVE ADR-MNU-REQA       TO ADR-REQA.                         
           MOVE 'MNU'              TO ADR-TABL IN ADR-REQA.   
      *>                                                                 
      
      
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX. 
           
      *>    DISPLAY "IDD-FSIS :" IDD-FSIS.
      *>    DISPLAY "IDD-DAUX :" IDD-DAUX.
           
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-MNU.                                   
       GRP-GNS-FIO-MNU.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-MNU, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2
                   DISPLAY 'ABORTO NO ENCONTRO IDD'
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-MNU.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'MNU-COD-NEMO' TO FIO-AKEY.
      
           MOVE 'MNU00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'MNU-COD-NEMO' OR FIO-AKEY NOT > SPACES )    
               MOVE MNU-COD-NEMO IN MNU TO ADR-VKEY IN ADR-REQA         
               MOVE 'MNU00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MNU-COD-OPCI'                                 
               MOVE MNU-COD-OPCI IN MNU TO ADR-VKEY IN ADR-REQA         
               MOVE 'MNU01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'MNU-COD-IMES'                                 
               MOVE MNU-COD-IMES IN MNU TO ADR-VKEY IN ADR-REQA         
               MOVE 'MNU02' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-MNU, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      
           MOVE MNU TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO MNU                                     
           ELSE                                                         
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'MNU'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
      
           MOVE FIO-STAT               TO LOGMSG-TEXT.
           PERFORM DO-USERLOG.
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-MNU-REQA.                               
      
       FIN-GNS-FIO-MNU.                                                 
           EXIT.                                                        
      
                     
      *> Modulo FIO para registro RPF en DATACOM                         
       GNS-FIO-RPF SECTION.                                             
       INI-GNS-FIO-RPF.              
       
      *>     MOVE ADR-RPF-REQA       TO ADR-REQA.                        
      *>     MOVE "RPF"              TO ADR-TABL IN ADR-REQA.   
      *>     MOVE 180                TO ADR-DBID IN ADR-REQA
      
           MOVE ADR-RPF-REQA       TO ADR-REQA.                         
           MOVE 'RPF'              TO ADR-TABL IN ADR-REQA.   
      *>                                                                 
           MOVE FIO-SIST TO IDD-SAUX.                                   
           MOVE 'C'      TO IDD-GAUX.                                   
           MOVE SPACES   TO IDD-RAUX.                                   
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               GO TO FSR-GNS-FIO-RPF.                                   
       GRP-GNS-FIO-RPF.                                                 
           MOVE SPACES TO IDD-GAUX.                                     
           MOVE 1      TO IDD-IAUX.                                     
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
               AT END                                                   
                   MOVE 'En GNS-FIO-RPF, NO existe en IDD:' TO FIO-MEN1 
                   MOVE IDD-DAUX                            TO FIO-MEN2 
                   PERFORM PRG-ABT                                      
               WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                     
                   NEXT SENTENCE.                                       
       FSR-GNS-FIO-RPF.                                                 
           MOVE IDD-IENT( IDD-ITBL ) TO ADR-DBID IN ADR-REQA.           
      
           IF FIO-AKEY NOT > SPACES
              MOVE 'RPF-COD-DPTR' TO FIO-AKEY.
      
           MOVE 'RPF00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'RPF-COD-DPTR' OR FIO-AKEY NOT > SPACES )    
               MOVE RPF-COD-DPTR IN RPF TO ADR-VKEY IN ADR-REQA         
               MOVE 'RPF00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-RPF, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
      
           MOVE RPF TO FIO-DFLD. 
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO RPF                                     
           ELSE                                                         
               MOVE FIO-SIST TO FIO-MENS-SIS                            
               MOVE 'RPF'    TO FIO-MENS-REG                            
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
      
           MOVE FIO-STAT               TO LOGMSG-TEXT.
           PERFORM DO-USERLOG.
      
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE ADR-REQA TO ADR-RPF-REQA.                               
      
       FIN-GNS-FIO-RPF.                                                 
           EXIT.                                                        
                     
      *> Modulo de Aborto Program  Interactivo                           
       PRG-ABT SECTION.                                                 
       INI-PRG-ABT.                                                     
           IF FRM-MENS > SPACES AND FIO-MENS NOT > SPACES               
               MOVE FRM-MENS TO FIO-MENS.                               
           MOVE FIO-MENS TO SYS-MENS.                                   
           MOVE SYS-ABOR TO SYS-CMND.                                   
           PERFORM GNS-PRO-SYS.                                         
       FIN-PRG-ABT.                                                     
           EXIT.                                                        
                     
      
       MSG-FROM-SRV SECTION.
       INI-MSG-FROM-SRV.
      
           ADD 21 WSS-BTDI GIVING WSS-IDX-FRM-SRV.
           MOVE 21 TO WSS-LTDI.
           MOVE ZEROES TO WSS-CTDI.
      
           PERFORM MOV-HDR-SRV VARYING WSS-ITDI FROM WSS-BTDI BY 1
             UNTIL WSS-CTDI = WSS-LTDI.
      
           MOVE WSS-ITDI TO WSS-BTDI.
      
           PERFORM TDI-TO-TSC.
      
           PERFORM GET-MNU.
      
           MOVE MNU-GLS-NFRM IN MNU TO WSS-MNU-GLS-NFRM.
      
           ADD 1 TO WSS-IDX-SRV.
           MOVE TDI-COD-SIST-FRM    TO WSS-SRV-SIST(WSS-IDX-SRV).
           MOVE TDI-COD-FOUT-FRM    TO WSS-SRV-FOUT(WSS-IDX-SRV).
           MOVE MNU-GLS-NFRM IN MNU TO WSS-SRV-NFRM(WSS-IDX-SRV).
      
           PERFORM GET-TSI.
      
           IF FIO-STAT-OKS
               IF MNU-GLS-NFRM IN MNU NOT = TSI-GLS-NFRM IN TSI OR
                  MNU-COD-INST = 'GKY'
                   PERFORM DEL-TSI
                   MOVE SPACES TO TSI-DATA
                   MOVE '23' TO PGM-STAT-TSI
               ELSE
                   MOVE '00' TO PGM-STAT-TSI
           ELSE
                   MOVE '23' TO PGM-STAT-TSI.
      
           PERFORM MNU-TO-TSC.
      
           PERFORM GET-RPF.
      
           IF TSC-I > ZEROES
               PERFORM RPF-TO-TSC.
      
      *>     PERFORM GET-IDD-IFD.
      
      
      *>SE CARGAN VARIABLES DEPENDIENDO DE TSC-TINF
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )
               PERFORM PRO-MOVE-SCR1
           ELSE
               PERFORM PRO-MOVE-SCR2.
      
           PERFORM PRO-MOVE-VSYS.
      
      *> CARGA EL SISTEMA DONDE BUSCAR LA DEFINICION DE FORMATOS
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.
           PERFORM GET-DEF-SRV.
      
           PERFORM GET-DEF-HST.
      
      
           MOVE 1 TO WSS-IDX-FLD-SRV.
      
           PERFORM PUT-INF-TO-HST VARYING WSS-IDX-FLD-HST
                 FROM 1 BY 1 UNTIL WSS-IDX-FLD-HST > WSS-TOT-FLD-HST
                   ADD 15 WSS-NUM-POS-HST(WSS-TOT-FLD-HST)
                       GIVING WSS-PINI
                   ADD WSS-NUM-LEN-HST(WSS-TOT-FLD-HST) TO WSS-PINI
                   MOVE ' ' TO TSI-COD-FRM-HST(WSS-PINI).
      
           IF NOT PGM-STAT-TSI-OKS
               PERFORM PUT-TSI
           ELSE
               PERFORM MOD-TSI.
      
      
           PERFORM PRO-CALL-LINK.
           MOVE WSS-IDX-FRM-SRV TO WSS-BTDI.
       FIN-MSG-FROM-SRV.
           EXIT.
      
       MSG-TO-SRV SECTION.
       INI-MSG-TO-SRV.
      
           PERFORM GET-TSO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MSG-TO-SRV.
      
      *> ISP: SIMULA CAMPOS DEL MNU PARA CARGAR DEFINICIONES
      
           ADD 1 TO WSS-IDX-SRV.
           MOVE WSS-SRV-NFRM(WSS-IDX-SRV) TO MNU-GLS-NFRM IN MNU.
           MOVE WSS-SRV-FOUT(WSS-IDX-SRV) TO TDI-COD-FOUT-FRM.
           MOVE WSS-SRV-SIST(WSS-IDX-SRV) TO FIO-SIST.
      
           PERFORM GET-DEF-SRV.
      
           PERFORM GET-DEF-HST.
      
           IF TDI-COD-FOUT-FRM NOT > SPACES
               GO TO INI-MSG-TO-SRV.
      
           DISPLAY 'TSO-GLS-FRM-HST :' TSO-GLS-FRM-HST.
      
           PERFORM PUT-INF-TO-SRV VARYING WSS-IDX-FLD-SRV
                 FROM 1 BY 1 UNTIL WSS-IDX-FLD-SRV > WSS-TOT-FLD-SRV.
      
           ADD WSS-LMSG-SRV TO WSS-BTDI.
           GO TO INI-MSG-TO-SRV.
       FIN-MSG-TO-SRV.
           EXIT.
      
       LEE-TSO SECTION.
       INI-LEE-TSO.
      
           PERFORM GET-TSO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-LEE-TSO.
      
           GO TO INI-LEE-TSO.
       FIN-LEE-TSO.
           EXIT.
      
       GET-TDI SECTION.
       INI-GET-TDI.
           MOVE 1 TO TDI-NUM-RECO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
           IF NOT FIO-STAT-OKS AND
                  QUE-NITM = 2
                    MOVE '00' TO FIO-STAT
                    MOVE QUE-STAT-OKS TO QUE-STAT.
           IF NOT FIO-STAT-OKS
               MOVE 'ABORTO: NO EXISTE MENSAJE DESDE TDI' TO SYS-MENS
               MOVE SYS-ABOR TO SYS-CMND
               PERFORM GNS-PRO-SYS.
       FIN-GET-TDI.
           EXIT.
      
       PUT-TDO SECTION.
       INI-PUT-TDO.
      
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TDO.
      
           IF TSO-COD-MSJE NOT > SPACES
               MOVE SPACES TO TSO-COD-MSJE.
           IF TSO-GLS-MSJE NOT > SPACES
               MOVE SPACES TO TSO-GLS-MSJE.
      
           IF WSS-IND-ERR = 'N'
               MOVE TSO-GLS-MSJE    TO TDO-GLS-MENS
               MOVE '0'    TO TDO-COD-STAT
           ELSE
               MOVE SPACES TO TDO-GLS-DESC IN TDO
               MOVE '1'    TO TDO-COD-STAT
               MOVE WSS-GLS-ERR-PTC TO TDO-GLS-MENS1
               PERFORM SET-MSG-VERS.
      
      
           DISPLAY 'PUT-TDO :' TDO.
      
           MOVE SYS-GET-DATE    TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
      
           MOVE 1               TO TDO-NUM-RECO.
           MOVE FIO-PUT         TO FIO-CMND.
      
           PERFORM GNS-FIO-TDO.
           IF NOT FIO-STAT-OKS
               MOVE 'ABORTO: ERROR AL GRABAR MENSAJE TDO' TO SYS-MENS
               MOVE SYS-ABOR TO SYS-CMND
               PERFORM GNS-PRO-SYS.
      
       FIN-PUT-TDO.
           EXIT.
      
       SET-MSG-VERS SECTION.
       INI-SET-MSG-VERS.
           MOVE TSK-TERM-ALF TO QUE-TERM.
      *> NO CONTEX MSG FIELD
           MOVE 'NCMF' TO QUE-TYPE.
           MOVE +1 TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE TDO-COD-STAT TO MSG-TDO-COD-STAT
                MOVE TSO-COD-MSJE TO MSG-TDO-COD-MSJE
                MOVE TSO-GLS-MSJE TO MSG-TDO-GLS-MSJE
                MOVE MSG-TDO      TO TDO-GLS-DESC
           ELSE
              MOVE TSO-GLS-MSJE   TO TDO-GLS-MENS2.
       FIN-SET-MSG-VERS.
           EXIT.
      
       GET-TSI SECTION.
       INI-GET-TSI.
      *> ISP  11-NOV-1992
      *>     PERFORM GNS-ERR-QUE.
           MOVE 1 TO WSS-RKEY-TSI.
           MOVE WSS-RKEY-TSI TO TSI-NUM-RECO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TSI.
      
           DISPLAY 'GET-TSI TSI-DATA :' TSI-DATA.
      
      
       FIN-GET-TSI.
           EXIT.
      
       PUT-TSI SECTION.
       INI-PUT-TSI.
      *> ISP  11-NOV-1992
      *>     PERFORM GNS-ERR-QUE.
           MOVE 1 TO WSS-RKEY-TSI.
           MOVE WSS-RKEY-TSI TO TSI-NUM-RECO.
           MOVE WSS-MNU-GLS-NFRM TO TSI-GLS-NFRM IN TSI.
      *> ISP: GRABA AL PROGRAMA SOLO LA PANTALLA
           MOVE TSI-GLS-FRM-HST TO WSS-FRM-TSI.
           MOVE WSS-FRM-TSI TO TSI-DATA.
      
           DISPLAY 'PUT-TSI TSI-DATA :' TSI-DATA.
      
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-TSI.
           IF NOT FIO-STAT-OKS
               MOVE 'ABORTO: ERROR AL GRABAR MENSAJE TSI' TO SYS-MENS
               MOVE SYS-ABOR TO SYS-CMND
               PERFORM GNS-PRO-SYS.
      
           MOVE SPACES TO TSI-GLS-FRM-HST.
           MOVE ZEROES TO WSS-NUM-99.
           MOVE ZEROES TO WSS-IDX-FLD-HST.
           MOVE 1 TO TSI-IDX-FRM-HST.
           MOVE ZEROES TO WSS-IDX-FLD-SRV.
       FIN-PUT-TSI.
           EXIT.
      
       PUT-ABP SECTION.
       INI-PUT-ABP.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'APTC' TO       QUE-TYPE.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'APTC' TO       QUE-TYPE.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE SPACES TO QUE-ITEM.
           MOVE +2 TO QUE-LITM.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-ABP.
           EXIT.
      
      *> DEL-ABP SECTION.
      *> INI-DEL-ABP.
      *>     MOVE 1 TO ABP-NUM-RECO.
      *>* ISP  11-NOV-1992
      *>*     PERFORM GNS-ERR-QUE.
      *>     MOVE FIO-DEL TO FIO-CMND.
      *>     PERFORM GNS-FIO-ABP.
      *> FIN-DEL-ABP.
      *>     EXIT.
      
       MOD-TSI SECTION.
       INI-MOD-TSI.
           PERFORM DEL-TSI.
           PERFORM PUT-TSI.
       FIN-MOD-TSI.
           EXIT.
      
       DEL-TSI SECTION.
       INI-DEL-TSI.
           MOVE 1 TO TSI-NUM-RECO.
      *> ISP  11-NOV-1992
      *>     PERFORM GNS-ERR-QUE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TSI.
       FIN-DEL-TSI.
           EXIT.
      
      
       DEL-TSO SECTION.
       INI-DEL-TSO.
           MOVE 1 TO TSO-NUM-RECO.
      *> ISP  11-NOV-1992
      *>     PERFORM GNS-ERR-QUE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TSO.
       FIN-DEL-TSO.
           EXIT.
      
       GET-TSO SECTION.
       INI-GET-TSO.
      *> ISP  11-NOV-1992
      *>     PERFORM GNS-ERR-QUE.
           MOVE 1 TO TSI-IDX-FRM-HST.
           ADD 1 TO WSS-RKEY-TSO.
           MOVE WSS-RKEY-TSO TO TSO-NUM-RECO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TSO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-TSO.
       FIN-GET-TSO.
           EXIT.
      
       GET-MNU SECTION.
       INI-GET-MNU.
      
           DISPLAY 'TDI-COD-NEMO-FRM :' TDI-COD-NEMO-FRM.
           DISPLAY 'FIO-SIST         :' FIO-SIST.
      
           MOVE TDI-COD-NEMO-FRM TO MNU-COD-NEMO IN MNU.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM VID-MNU.
           IF NOT FIO-STAT-OKS
               PERFORM ERR-MNU.
      *>
      *>Buscar idd con codigo TSC-CIDD.
      *>     PERFORM GNS-GET-TSC.
       FIN-GET-MNU.
           EXIT.
      
       GET-RPF SECTION.
       INI-GET-RPF.
           MOVE ZEROES TO TSC-I.
           MOVE SPACES TO RPF.
           MOVE MNU-GLS-PROG TO RPF-KEY-DPRO.
           MOVE 'C0'         TO RPF-KEY-TRYC.
      *>     MOVE FIO-FND-NLS  TO FIO-CMND.
      
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM VID-RPF.
           DISPLAY 'RPF :' RPF.
           IF NOT FIO-STAT-OKS
                 GO TO FIN-GET-RPF.
           PERFORM LEE-CRPF.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM VID-RPF.
       FIN-GET-RPF.
           EXIT.
      
       LEE-CRPF SECTION.
       INI-LEE-CRPF.
           IF NOT ( FIO-STAT-OKS AND RPF-KEY-DPRO = MNU-GLS-PROG AND
                                     RPF-KEY-TREG = 'C' )
                   GO TO FIN-LEE-CRPF.
           IF NOT ( MNU-COD-CMND IN MNU > SPACES AND
                    MNU-COD-CMND = RPF-COD-CCMN )
      
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM VID-RPF
               DISPLAY 'RPF :' RPF
      
               GO TO INI-LEE-CRPF.
      
      
           MOVE 1 TO TSC-I.
       FIN-LEE-CRPF.
           EXIT.
      
       DFL-TO-TSC SECTION.
       INI-DFL-TO-TSC.
           MOVE SPACES TO TSC-COLA
                          TSC-ICMN
                          TSC-INST
                          TSC-SISG
                          TSC-FFLD
                          TSC-IPRV
                          TSC-PROV
                          TSC-NTRV
                          TSC-PRMC
                          TSC-RFBY.
           MOVE ZEROES TO TSC-TCMA.
       FIN-DFL-TO-TSC.
           EXIT.
      
       HDR-TO-TSC SECTION.
       INI-HDR-TO-TSC.
      *>     MOVE TDI-COD-USER TO TSC-USER.
       FIN-HDR-TO-TSC.
           EXIT.
      
       TDI-TO-TSC SECTION.
       INI-TDI-TO-TSC.
           MOVE TDI-COD-SIST-FRM TO TSC-SIST.
       FIN-TDI-TO-TSC.
           EXIT.
      
       MNU-TO-TSC SECTION.
       INI-MNU-TO-TSC.
           MOVE MNU-COD-OPCI TO TSC-OPCI.
           MOVE MNU-COD-NEMO TO TSC-NEMO.
      *>
           MOVE MNU-GLS-TRAN TO TSC-NTRN.
           MOVE MNU-GLS-PROG TO TSC-PROG.
           MOVE MNU-GLS-LFRM TO TSC-NLIB.
           MOVE MNU-GLS-NFRM TO TSC-NMAP.
           MOVE MNU-GLS-LDOC TO TSC-LDOC.
           MOVE MNU-GLS-NDOC TO TSC-NDOC.
           MOVE MNU-COD-FRET TO TSC-FRET.
           MOVE MNU-COD-INST TO TSC-TINS.
           MOVE MNU-COD-TCTL TO TSC-TCTL.
           MOVE MNU-COD-TINF TO TSC-TINF.
           MOVE MNU-COD-TFUN TO TSC-TFUN.
      
           IF WSS-COD-CIFD > SPACES
               MOVE WSS-COD-CIFD TO MNU-COD-CIFD.
      
           MOVE MNU-COD-CIFD TO TSC-CIDD.
      
       FIN-MNU-TO-TSC.
           EXIT.
      
       RPF-TO-TSC SECTION.
       INI-RPF-TO-TSC.
           MOVE MNU-COD-CMND TO TSC-CCMN ( TSC-I )
                                TSC-CMND.
           MOVE RPF-COD-CCPP TO TSC-CCPP ( TSC-I )
                                TSC-CMNP.
           MOVE RPF-IND-STPP TO TSC-STPP ( TSC-I ).
           MOVE SPACES       TO TSC-PRMT ( TSC-I ).
      *>ISP  15-OCT-1993
      *> SI RPF-GLS-CONF = SPACES, NO SE RESCATA MENSAJE Y POR LO TANTO
      *> PROGRAMA NO CONFIRMA, SI RPF-GLS-CONF = "NOMSG" TAMPOCO CONFIRMA
      *>     MOVE SPACES       TO TSC-CONF ( TSC-I ).
           IF RPF-GLS-CONF IN RPF = 'NOMSG'
               MOVE SPACES TO RPF-GLS-CONF IN RPF.
           MOVE RPF-GLS-CONF IN RPF TO TSC-CONF ( TSC-I ).
           MOVE SPACES       TO TSC-UARC ( TSC-I ).
           IF RPF-GLS-UARC IN RPF > SPACES
                MOVE RPF-GLS-UARC IN RPF TO MNU-GLS-PROG IN MNU
                                            TSC-PROG.
       FIN-RPF-TO-TSC.
           EXIT.
      
       VID-MNU SECTION.
       INI-VID-MNU.
      
           DISPLAY 'TDI-COD-SIST-FRM :' TDI-COD-SIST-FRM.
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.
           PERFORM GNS-FIO-MNU.
       FIN-VID-MNU.
           EXIT.
      
       VID-RPF SECTION.
       INI-VID-RPF.
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.
           PERFORM GNS-FIO-RPF.
       FIN-VID-RPF.
           EXIT.
      
       PRO-MOVE-SCR1 SECTION.
       INI-PRO-MOVE-SCR1.
           MOVE +1110              TO OSC-TCMA.
           MOVE TSC-SIST           TO OSC-SIST.
           MOVE TSC-OPCI           TO OSC-FUNC.
           MOVE TSC-NEMO           TO OSC-NEMO.
           MOVE TSC-NTRV           TO OSC-NTRV.
           MOVE TSC-NTRN           TO OSC-NTRN.
           MOVE TSC-PROG           TO OSC-PROG.
           MOVE TSC-NLIB           TO OSC-NLIB.
           MOVE TSC-NMAP           TO OSC-NMAP.
           MOVE TSC-LDOC           TO OSC-LDOC.
           MOVE TSC-NDOC           TO OSC-NDOC.
           MOVE TSC-FRET           TO OSC-FRET.
           MOVE TSC-IPRV           TO OSC-IPRV.
           MOVE TSC-SISG           TO OSC-SISG.
           IF TSC-TINS > SPACES
               MOVE TSC-TINS       TO OSC-INST
           ELSE
               MOVE SCR-INST-HKY   TO OSC-INST.
           MOVE TSC-TFUN           TO OSC-TFUN.
           MOVE TSC-CMNP           TO OSC-CMNP.
           MOVE TSC-FFLD           TO OSC-FFLD.
           MOVE TSC-I              TO OSC-I.
      *>    MOVE TSC-CMND           TO OSC-CMND.
           MOVE TSC-CCMN( TSC-I )  TO OSC-CMND.
           MOVE TSC-PRMC           TO OSC-PRMC.
           MOVE TSC-CCPP( TSC-I )  TO OSC-CCPP.
           MOVE TSC-STPP( TSC-I )  TO OSC-STPP.
           MOVE 1 TO FRM-IFLD.
       LUP-PRO-MOVE-SCR1.
           MOVE TSC-CCMN(FRM-IFLD) TO OSC-COD-CCMN(FRM-IFLD).
           MOVE TSC-CCPP(FRM-IFLD) TO OSC-COD-CCPP(FRM-IFLD).
           MOVE TSC-STPP(FRM-IFLD) TO OSC-IND-STPP(FRM-IFLD).
           MOVE TSC-PRMT(FRM-IFLD) TO OSC-GLS-PRMT(FRM-IFLD).
           MOVE TSC-CONF(FRM-IFLD) TO OSC-GLS-CONF(FRM-IFLD).
           MOVE TSC-UARC(FRM-IFLD) TO OSC-GLS-UARC(FRM-IFLD).
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > 10
               GO TO LUP-PRO-MOVE-SCR1.
           IF TSC-USER NOT > SPACES
               MOVE SPACES TO TSC-USER.
           MOVE TSC-USER           TO OSC-USER.
           MOVE TSC-PROV           TO OSC-PROV.
           IF OSC-INST = 'GKY'
               MOVE 'C'                TO OSC-ICMN
           ELSE
               MOVE 'P'                TO OSC-ICMN.
      *> ISP: ORIGEN DESDE PTC
           MOVE 'S'                TO OSC-OFRM.
      *> JSS: ORIGEN DESDE PTC
           MOVE 'N'                TO OSC-IERR.
       FIN-PRO-MOVE-SCR1.
           EXIT.
      
      *>HACE MOVE A VARIABLES DE PROGRAMA ( NUEVA VERSION )
       PRO-MOVE-SCR2 SECTION.
       INI-PRO-MOVE-SCR2.
           MOVE +250               TO SCR-TCMA.
      *> ISP:  19-AUG-1995 11:27:19
      *>       EN REALIA TIENE IMPORTANCIA ESTE VALOR, PUES SIEMPRE
      *>       ESTABA ENVIANDO TCMA = 250, PERO CON SYS-CMMA 3500
      *>       Y LOS PROGRAMAS HOST RECUPERABAN BIEN LA CMMA ADICIONAL
           MOVE +3500               TO SCR-TCMA.
           MOVE TSC-SIST           TO SCR-SIST.
           MOVE TSC-SISG           TO SCR-SISG.
           MOVE TSC-NTRN           TO SCR-NTRN.
           MOVE TSC-PROG           TO SCR-PROG.
           MOVE TSC-NTRV           TO SCR-NTRV.
           MOVE TSC-PROV           TO SCR-PROV.
           MOVE TSC-NLIB           TO SCR-NLIB.
           MOVE TSC-NMAP           TO SCR-NMAP.
           IF TSC-TINS > SPACES
               MOVE TSC-TINS       TO SCR-INST
           ELSE
               MOVE SCR-INST-HKY   TO SCR-INST.
           MOVE TSC-CMNP           TO SCR-CMNP.
      *>    MOVE TSC-CMND           TO SCR-CMND.
           MOVE TSC-CCMN( TSC-I )  TO SCR-CMND.
           MOVE TSC-CCPP( TSC-I )  TO SCR-CCPP.
           MOVE TSC-STPP( TSC-I )  TO SCR-STPP.
           MOVE TSC-PRMT( TSC-I )  TO SCR-PRMT.
           MOVE TSC-CONF( TSC-I )  TO SCR-CONF.
           IF TSC-USER NOT > SPACES
               MOVE SPACES TO TSC-USER.
           MOVE TSC-USER           TO SCR-USER.
           IF SCR-INST = 'GKY'
                MOVE 'C'                TO SCR-ICMN
           ELSE
                MOVE 'P'                TO SCR-ICMN.
           MOVE WSS-QIDD                TO SCR-QIDD.
           MOVE WSS-QIDD-LEN            TO SCR-LIDD.
           MOVE TSC-NEMO           TO SCR-NEMO.
           MOVE TSC-LDOC           TO SCR-LDOC.
      
           MOVE TSC-NDOC           TO SCR-NDOC-DISP.
           MOVE TSC-BNCO           TO SCR-HDR-BNCO.
           MOVE TSC-MRCA           TO SCR-HDR-MRCA.
           MOVE TSC-CART           TO SCR-HDR-CART.
           MOVE TSC-LENG           TO SCR-HDR-LENG.
           MOVE TSC-PAIS           TO SCR-HDR-PAIS.
           MOVE TSC-VRNT           TO SCR-HDR-VRNT.
      
           MOVE TSC-FRET           TO SCR-FRET.
           MOVE TSC-IPRV           TO SCR-IPRV.
           MOVE TSC-FFLD           TO SCR-FFLD.
      *> ISP: ORIGEN DESDE PTC
           MOVE 'S'                TO SCR-OFRM.
      *>    MOVE WSS-ORIG TO SCR-ORIG.
      *> ISP: ORIGEN DESDE PTC
           MOVE 'N'                TO SCR-IERR.
      *>    IF WSS-COD-CIFD > SPACES
      *>        MOVE "T" TO SCR-MODO.
               MOVE TSC-MODO TO SCR-MODO.
           MOVE WSS-CNAL TO SCR-CNAL.
       FIN-PRO-MOVE-SCR2.
           EXIT.
      
       PRO-MOVE-VSYS SECTION.
       INI-PRO-MOVE-VSYS.
      *>SI LAS VARIABLES DEL PROGRAMA VAN EN COMMAREA VERSION 1
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )
               PERFORM CLR-SCR-DISP
               MOVE OSC-VARI TO SYS-CMMA
      *>        MOVE OSC-TCMA TO SYS-TCMA
               MOVE +3500    TO SYS-TCMA
           ELSE
      *>SI LAS VARIABLES DEL PROGRAMA VAN EN COMMAREA VERSION 2
           IF TSC-TINV = 'O'
               PERFORM CLR-SCR-DISP
               MOVE SCR-VARI TO SYS-CMMA
               MOVE SCR-TCMA TO SYS-TCMA
           ELSE
      *>SE ASUME "T" = SI LAS VARIABLES DEL PROGRAMA VAN EN TS
              MOVE SPACES   TO SYS-CMMA
              MOVE 0        TO SYS-TCMA.
           MOVE TSC-PROG TO SYS-PROG.
           MOVE TSC-NTRN TO SYS-NTRN.
       FIN-PRO-MOVE-VSYS.
           EXIT.
      
       CLR-SCR-DISP SECTION.
       INI-CLR-SCR-DISP.
      
      *>     EXEC CICS WRITEQ TS
      *>               QUEUE(SCR-VARI)
      *>               FROM(SCR-VARI)
      *>               LENGTH(+4000)
      *>               AUXILIARY
      *>     END-EXEC.
      
      *>     IF SCR-INST = "GKY"
      *>         MOVE SPACES TO SCR-DISP
      *>         MOVE SPACES TO SCR-CONT.
       FIN-CLR-SCR-DISP.
           EXIT.
      
       ERR-MNU SECTION.
       INI-ERR-MNU.
           PERFORM GNS-PRO-END.
       FIN-ERR-MNU.
           EXIT.
      
       GET-DEF-HST SECTION.
       INI-GET-DEF-HST.
           MOVE ZEROES TO WSS-IDX-FLD-HST.
           MOVE TDI-COD-SIST-FRM TO TAB-COD-SIST.
           MOVE WSS-COD-ORIG-HST TO TAB-COD-TTAB IN TAB.
           MOVE MNU-GLS-NFRM     TO TAB-COD-CTAB IN TAB.
           MOVE SPACES TO WSS-GLS-TAB.
      
      *> EJEMPLO DE CARGA FIJA DE PARAMETROS HST
      *>
      *>     IF MNU-GLS-NFRM IN MNU = "COLFOPC"
      *>         MOVE
      *>     "01030304081314140408490308010103020615040319261904080303190
      *>-    "0806260808081809092012030116010116160320"
      *>         TO WSS-GLS-TAB
      *>         PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1
      *>             UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC
      *>             OR WSS-IDX-TAB-HST > 50
      *>         MOVE
      *>     "1208054004080319040879"
      *>         TO WSS-GLS-TAB
      *>         PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1
      *>             UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC
      *>             OR WSS-IDX-TAB-HST > 50.
      
      
      
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-DEF-HST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO EXT-GET-DEF-HST.
      
           MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-NFRM-HST.
           IF WSS-GLS-NFRM-HST = MNU-GLS-NFRM
               MOVE TAB-GLS-DESC TO WSS-GLS-DESC
               MOVE TAB-GLS-DATA TO WSS-GLS-DATA
               PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1
                   UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC
                   OR WSS-IDX-TAB-HST > 50
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-DEF-HST.
       EXT-GET-DEF-HST.
           MOVE WSS-IDX-FLD-HST TO WSS-TOT-FLD-HST.
      
       FIN-GET-DEF-HST.
           EXIT.
      
       CRG-DEF-HST SECTION.
       INI-CRG-DEF-HST.
      *> ISP: DETECTA UN NUEVO CAMPO CORRELATIVO
           ADD 1 TO WSS-IDX-FLD-HST.
      
           DISPLAY 'HOST (' WSS-IDX-FLD-HST ') = <'
                    WSS-COD-TAB-HST(WSS-IDX-TAB-HST) '>'.
      
      *> ISP: CARGA LARGO DE CAMPO CORRELATIVO
           MOVE WSS-COD-TAB-HST(WSS-IDX-TAB-HST) TO
                WSS-NUM-LEN-HST(WSS-IDX-FLD-HST).
      
      *> ISP: CARGA POSICION DE INICIO DE CAMPO CORRELATIVO
           IF WSS-COD-ORIG = WSS-COD-ORIG-HST
               ADD 3 TO TSI-IDX-FRM-HST.
           MOVE TSI-IDX-FRM-HST TO WSS-NUM-POS-HST(WSS-IDX-FLD-HST).
      
      *> ISP: SUMA LARGO Y ATRIBUTO ( 3 )
           IF WSS-COD-ORIG = WSS-COD-ORIG-SRV
               ADD 3 TO TSI-IDX-FRM-HST.
      
           ADD  WSS-COD-TAB-HST(WSS-IDX-TAB-HST) TO TSI-IDX-FRM-HST.
       FIN-CRG-DEF-HST.
           EXIT.
      
       PUT-INF-TO-HST SECTION.
       INI-PUT-INF-TO-HST.
      *>     ADD 12 TO WSS-NUM-POS-HST(WSS-IDX-FLD-HST)
      *>            GIVING WSS-BTSI.
      
           MOVE WSS-NUM-POS-HST(WSS-IDX-FLD-HST) TO WSS-BTSI.
           MOVE WSS-NUM-LEN-HST(WSS-IDX-FLD-HST) TO WSS-LTDI.
      *>
      *> SIEMPRE REINICIALIZA LA NUMERACION DE LOS CAMPOS
      *> DEL MAPA-WI PARA NO CONFUNDIR LOS ERRORES CON
      *> POSICIONAMIENTOS CORRECTOS DEL CURSOR ENTRE DOS
      *> TRANSACCIONES QUE USAN EL MISMO MAPA
      *>
      *>    IF NOT PGM-STAT-TSI-OKS
               ADD 1 TO WSS-NUM-99
               MOVE WSS-NUM-XX1 TO TSI-COD-FRM-HST(WSS-BTSI)
               ADD  1           TO                 WSS-BTSI
               MOVE WSS-NUM-XX2 TO TSI-COD-FRM-HST(WSS-BTSI)
               ADD  1           TO                 WSS-BTSI
               MOVE '&' TO TSI-COD-FRM-HST(WSS-BTSI)
               ADD  1           TO                 WSS-BTSI
      *>    ELSE
      *>        ADD 3 TO WSS-BTSI.
      
      
      
      *> DETERMINA SI EL CAMPO CORRELATIVO DE LA TABLA "HST" QUE ESTA
      *> PROCESANDO, EXISTE EN ALGUNA OCURRENCIA DE LA TABLA "SRV".
      *> NO ASUME QUE LA TABLA "SRV" VIENE ORDENADA ASCENDENTEMENTE
           MOVE ZEROES TO WSS-IDX-FLD-SRV.
           MOVE WSS-BTDI TO WSS-IDX-FRM-SRV
           MOVE 'N' TO WSS-IND-ESRV.
           PERFORM BUS-FLD-SRV VARYING WSS-IDX-SRV-ASC
                     FROM 1 BY 1 UNTIL WSS-IDX-SRV-ASC >
                                       WSS-TOT-FLD-SRV OR
                                       WSS-IND-ESRV = 'S'.
      
           IF WSS-IND-ESRV = 'S'
      *>         ADD 1 TO WSS-IDX-FLD-SRV
      *>ISP SI EL USUARIO INFORMA DATOS, PRIMERO SE LIMPIA EL AREA RECEPT
      *>    Y LUEGO SE PONE LO QUE EL USUARIO INFORMO; UTIL POR EJEMPLO P
      *>    REDIGITACION DE CAMPOS NUMERICO
      *>
               MOVE ZEROES TO WSS-CTDI
      *>        ASUME QUE EL USUARIO NO DIGITO NADA
               MOVE 'N' TO WSS-SWI-FLD-USR
               MOVE WSS-IDX-FRM-SRV TO WSS-IDX-FLD-USR
               PERFORM REV-FLD-USR VARYING WSS-ITDI FROM WSS-BTSI BY 1
                    UNTIL WSS-CTDI NOT < WSS-LTDI
      
               IF WSS-SWI-FLD-USR = 'S'
                   MOVE ZEROES TO WSS-CTDI
                   PERFORM CLR-FLD-USR VARYING WSS-ITDI FROM WSS-BTSI
                     BY 1
                    UNTIL WSS-CTDI = WSS-LTDI
      *>prueba-ini
                    MOVE 1 TO WSS-IDX-CAMPO
                    MOVE ALL '.' TO WSS-TAB-CAMPO
      *>prueba-fin
      
                    MOVE ZEROES TO WSS-CTDI
                    PERFORM PUT-ALL-HST VARYING WSS-ITDI FROM WSS-BTSI
                     BY 1
                    UNTIL WSS-CTDI = WSS-LTDI
      
      *>prueba-ini
                    DISPLAY 'WSS-TAB-CAMPO :' WSS-TAB-CAMPO
      *>prueba-fin
      
      
               ELSE
      *>prueba-ini
                    MOVE 1 TO WSS-IDX-CAMPO
                    MOVE ALL '.' TO WSS-TAB-CAMPO
      *>prueba-fin
                    MOVE ZEROES TO WSS-CTDI
                    PERFORM PUT-ALL-HST VARYING WSS-ITDI FROM WSS-BTSI
                     BY 1
      *>prueba-ini
      *>              UNTIL WSS-CTDI = WSS-LTDI.
                    UNTIL WSS-CTDI = WSS-LTDI
                    DISPLAY 'WSS-TAB-CAMPO :' WSS-TAB-CAMPO.
      *>prueba-fin
      
      
       FIN-PUT-INF-TO-HST.
           EXIT.
      
       BUS-FLD-SRV SECTION.
       INI-BUS-FLD-SRV.
           IF WSS-IDX-FLD-HST = WSS-COD-FLD-SRV(WSS-IDX-SRV-ASC)
               MOVE 'S' TO WSS-IND-ESRV
               GO TO FIN-BUS-FLD-SRV.
      
           MOVE WSS-COD-FLD-SRV(WSS-IDX-SRV-ASC) TO WSS-IDX-AUX.
           ADD WSS-NUM-LEN-HST(WSS-IDX-AUX) TO
               WSS-IDX-FRM-SRV.
       FIN-BUS-FLD-SRV.
           EXIT.
      
       REV-FLD-USR SECTION.
       INI-REV-FLD-USR.
           IF TDI-COD-TDI(WSS-IDX-FLD-USR) > SPACES
               MOVE 'S' TO WSS-SWI-FLD-USR
               MOVE WSS-LTDI TO WSS-CTDI
           ELSE
               ADD 1 TO WSS-IDX-FLD-USR
               ADD 1 TO WSS-CTDI.
       FIN-REV-FLD-USR.
           EXIT.
      
       CLR-FLD-USR SECTION.
       INI-CLR-FLD-USR.
           MOVE SPACES TO TSI-COD-FRM-HST(WSS-ITDI).
           ADD 1 TO WSS-CTDI.
       FIN-CLR-FLD-USR.
           EXIT.
      
       PUT-ALL-HST SECTION.
       INI-PUT-ALL-HST.
      *> ISP  11-NOV-1992
      *> DEBE RESPETAR DATOS QUE PUSO LA PLANTILLA Y ESTAN DEFINIDOS EN
      *> LOS FORMATOS DE TRANSMISION, PERO EL USUARIO LOS DEJA EN BLANCO
      *> ISP 15-03-1996 SIEMPRE MUEVE TODOS LOS DATOS,
      *> INCLUSIVE AQUELLOS CON BLANCOS
      *> PUT-SOLO-LLENOS
           IF WSS-PREG-POR-SPAC = 'N'
               MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO
                    TSI-COD-FRM-HST(WSS-ITDI)
      
      *>PRUEBA  INI
           MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO
                WSS-TAB-CAMPO-ELM(WSS-IDX-CAMPO)
           ADD 1 TO WSS-IDX-CAMPO
      *>PRUEBA  FIN
      
      
           ELSE
               IF TDI-COD-TDI(WSS-IDX-FRM-SRV) > SPACES
      *>PRUEBA  INI
           MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO
                WSS-TAB-CAMPO-ELM(WSS-IDX-CAMPO)
           ADD 1 TO WSS-IDX-CAMPO
      *>PRUEBA  FIN
                   MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO
                      TSI-COD-FRM-HST(WSS-ITDI).
      
           ADD 1 TO WSS-IDX-FRM-SRV.
           ADD 1 TO WSS-CTDI.
       FIN-PUT-ALL-HST.
           EXIT.
      
       PUT-INF-TO-SRV SECTION.
       INI-PUT-INF-TO-SRV.
           MOVE WSS-COD-FLD-SRV(WSS-IDX-FLD-SRV) TO WSS-IDX-FLD-HST.
      
           MOVE WSS-NUM-LEN-HST(WSS-IDX-FLD-HST) TO WSS-LTDI.
           MOVE ZEROES                           TO WSS-CTDI.
           MOVE WSS-NUM-POS-HST(WSS-IDX-FLD-HST) TO WSS-PINI.
      
      
           DISPLAY ' SERV <' WSS-COD-FLD-SRV(WSS-IDX-FLD-SRV) '>'
                   ' LARG <' WSS-NUM-LEN-HST(WSS-IDX-FLD-HST) '>'
                   ' POSI <' WSS-NUM-POS-HST(WSS-IDX-FLD-HST) '>'
                   ' ATRI <' WSS-IND-IBYA                     '>'.
      
      
           PERFORM PRO-BYA.
      
           PERFORM LIM-ISRV.
      
           MOVE 1 TO WSS-IDX-CAMPO.
           MOVE ALL '.' TO WSS-TAB-CAMPO.
      
      
           PERFORM PUT-ALL-SRV VARYING WSS-ITDI FROM WSS-PINI BY 1
                    UNTIL WSS-CTDI = WSS-LTDI.
      
           DISPLAY 'WSS-TAB-CAMPO :' WSS-TAB-CAMPO.
      
       FIN-PUT-INF-TO-SRV.
           EXIT.
      
       PRO-BYA SECTION.
       INI-PRO-BYA.
           IF WSS-IND-IBYA = 'S'
               ADD 12 WSS-PINI GIVING WSS-AUXI
               SUBTRACT 1 FROM WSS-AUXI
               ADD 1 TO WSS-ISRV
      *> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      *>        MOVE "BYA" TO QUE-COLA.
      *>        MOVE TSO-COD-FRM-HST(WSS-AUXI) TO QUE-ITEM.
      *>        MOVE QUE-PUT TO QUE-CMND.
      *>        MOVE +1 TO QUE-LITM.
      *>        PERFORM GNS-PRO-QUE.
      *>        MOVE WSS-AUXI TO WSS-AUXI-NUM3.
      *>        MOVE "POS" TO QUE-COLA.
      *>        MOVE WSS-AUXI-NUM3 TO QUE-ITEM.
      *>        MOVE QUE-PUT TO QUE-CMND.
      *>        MOVE +3 TO QUE-LITM.
      *>        PERFORM GNS-PRO-QUE.
      *> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
               IF TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPIM-AEY OR
                  TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPIM-ANY OR
                  TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPSF-AEY OR
                  TSO-COD-FRM-HST(WSS-AUXI) = '&'
                   MOVE 'P' TO TDO-COD-TDO(WSS-ISRV)
               ELSE
                   MOVE 'D' TO TDO-COD-TDO(WSS-ISRV).
       FIN-PRO-BYA.
           EXIT.
      
       PUT-ALL-SRV SECTION.
       INI-PUT-ALL-SRV.
      
      
           ADD 1 TO WSS-ISRV.
      *>     ADD 16 WSS-ITDI GIVING WSS-AUXI.
           ADD 12 WSS-ITDI GIVING WSS-AUXI.
           MOVE TSO-COD-FRM-HST(WSS-AUXI) TO
                TDO-COD-TDO(WSS-ISRV).
           ADD 1 TO WSS-CTDI.
      
      
      *>PRUEBA  INI
           MOVE TDO-COD-TDO(WSS-ISRV) TO
                WSS-TAB-CAMPO-ELM(WSS-IDX-CAMPO).
           ADD 1 TO WSS-IDX-CAMPO.
      *>PRUEBA  FIN
      
      
      *>DBG MOVE +1   TO QUE-LITM.
      *>DBG MOVE "XXXISP" TO QUE-COLA.
      *>DBG MOVE TSO-COD-FRM-HST(WSS-AUXI)   TO QUE-ITEM.
      *>DBG MOVE QUE-PUT TO QUE-CMND.
      *>DBG PERFORM GNS-PRO-QUE.
       FIN-PUT-ALL-SRV.
           EXIT.
      
       LIM-ISRV SECTION.
       INI-LIM-ISRV.
      *>     ADD 1 TO WSS-ISRV.
      *>     MOVE "%" TO TDO-COD-TDO(WSS-ISRV).
       FIN-LIM-ISRV.
           EXIT.
      
       GET-DEF-SRV SECTION.
       INI-GET-DEF-SRV.
           MOVE ZEROES TO WSS-GLS-FLD-SRV.
           IF WSS-COD-ORIG = WSS-COD-ORIG-HST
                MOVE ZEROES TO WSS-IDX-FLD-SRV.
           MOVE 'S' TO WSS-FST-SRV.
      
           IF WSS-COD-ORIG = WSS-COD-ORIG-SRV
                MOVE TDI-COD-FINP-FRM TO WSS-COD-2TAB
           ELSE
                MOVE TDI-COD-FOUT-FRM TO WSS-COD-2TAB.
      *> EJEMPLO DE CARGA FIJA DE PARAMETROS SRV
      *>     IF MNU-GLS-NFRM IN MNU = "COLFOPC"
      *>        IF WSS-COD-2TAB = "009"
      *>         MOVE
      *>     "00200300400500901001201301401501601701802102202702803503603
      *>-    "042051053055056057059060"
      *>         TO WSS-GLS-TAB
      *>         PERFORM CRG-DEF-SRV VARYING WSS-IDX-TAB-SRV FROM 1 BY 1
      *>            UNTIL WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) NOT NUMERIC
      *>            OR WSS-IDX-TAB-SRV > 33.
      
      
      
           MOVE TDI-COD-SIST-FRM TO TAB-COD-SIST.
           MOVE WSS-COD-ORIG-SRV TO TAB-COD-TTAB IN TAB.
           MOVE MNU-GLS-NFRM     TO WSS-COD-1TAB.
           MOVE WSS-COD-CTAB     TO TAB-COD-CTAB IN TAB.
      
           MOVE FIO-GET-NLS TO FIO-CMND.
      
       CIC-GET-DEF-SRV.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-DEF-SRV.
      
      
           MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-NFRM-SRV.
           IF WSS-FST-SRV = 'S'
               MOVE 'N' TO WSS-FST-SRV
               MOVE TAB-GLS-ABRV TO WSS-LMSG-SRV.
      
           IF WSS-GLS-NFRM-SRV = WSS-COD-CTAB
               DISPLAY 'TAB SRV :' TAB
               MOVE TAB-GLS-DESC TO WSS-GLS-DESC
               MOVE TAB-GLS-DATA TO WSS-GLS-DATA
      *>DBG MOVE +100 TO QUE-LITM
      *>DBG MOVE "TABISP" TO QUE-COLA
      *>DBG MOVE WSS-GLS-TAB TO QUE-ITEM
      *>DBG MOVE QUE-PUT TO QUE-CMND
      *>DBG PERFORM GNS-PRO-QUE
               PERFORM CRG-DEF-SRV VARYING WSS-IDX-TAB-SRV FROM 1 BY 1
                  UNTIL WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) NOT NUMERIC
                  OR WSS-IDX-TAB-SRV > 33
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-DEF-SRV.
      
           MOVE WSS-IDX-FLD-SRV TO WSS-TOT-FLD-SRV.
      
       FIN-GET-DEF-SRV.
           EXIT.
      
       CRG-DEF-SRV SECTION.
       INI-CRG-DEF-SRV.
      *> ISP: DETECTA UN NUEVO CAMPO CORRELATIVO
           ADD 1 TO WSS-IDX-FLD-SRV.
      
           DISPLAY 'SERVER (' WSS-IDX-FLD-SRV ' ) = <'
                    WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) '>'.
      
      *> ISP: CARGA LARGO DE CAMPO CORRELATIVO
           MOVE WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) TO
                WSS-COD-FLD-SRV(WSS-IDX-FLD-SRV).
      
       FIN-CRG-DEF-SRV.
           EXIT.
      
       MOV-HDR-SRV SECTION.
       INI-MOV-HDR-SRV.
      *> ISP: RESCATA CARACTER A CARACTER EL HEADER DE CADA UNO DE LOS
      *>      MENSAJES DE LA CADENA DEL SERVER
           ADD 1 TO WSS-CTDI.
           MOVE TDI-COD-TDI(WSS-ITDI) TO TDI-COD-TDI-FRM(WSS-CTDI).
       FIN-MOV-HDR-SRV.
           EXIT.
      
       PRO-CALL-LINK SECTION.
       INI-PRO-CALL-LINK.
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )
               MOVE OSC-INST TO WSS-INST-OLD
           ELSE
               MOVE SCR-INST TO WSS-INST-OLD.
      
           MOVE SYS-LINK TO SYS-CMND.
           MOVE TSC-PROG TO SYS-PROG.
           DISPLAY 'PRO-CALL-LINK ANTES GNS-PRO-SYS :' SYS-CMMA.
           PERFORM GNS-PRO-SYS.
           DISPLAY 'PRO-CALL-LINK SALIO GNS-PRO-SYS :' SYS-CMMA.
      
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )
               MOVE SYS-CMMA TO OSC-VARI
               MOVE OSC-INST TO WSS-INST-NEW
           ELSE
               MOVE SYS-CMMA TO SCR-VARI
               MOVE SCR-INST TO WSS-INST-NEW.
      
      *>     IF WSS-INST-OLD = WSS-INST-NEW
      *>          PERFORM DEL-TSI
      *>          MOVE "S" TO WSS-IND-ERR
      *>          PERFORM BCK-OUT.
      
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )
               IF OSC-IERR-YES
                   PERFORM DEL-TSI
                   MOVE 'S' TO WSS-IND-ERR
                   MOVE 'S' TO PTC-WSS-BCKI-VAL
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-IERR-YES
                   PERFORM DEL-TSI
                   MOVE 'S' TO WSS-IND-ERR
                   MOVE 'S' TO PTC-WSS-BCKI-VAL.
      
           IF PTC-WSS-BCKI-VAL = 'S'
                   PERFORM BCK-OUT.
       FIN-PRO-CALL-LINK.
           EXIT.
      
      
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *>        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.
      
       BUS-FSIS SECTION.
       INI-BUS-FSIS.
      *> ISP: ABORTO CUANDO NO ENCUENTRA IDD
       FIN-BUS-FSIS.
           EXIT.
      
       LINK-ERR SECTION.
       INI-LINK-ERR.
      *> ISP: ABORTO CUANDO FALLA LINK
       FIN-LINK-ERR.
           EXIT.
      
       FIN SECTION.
       INI-FIN.
           MOVE WSS-QIDD TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
           IF PTC-WSS-BCKI-QUE = 'S'
                   PERFORM BCK-OUT.
      
      *>     MOVE "GNS" TO FIO-SIST.
      *>     MOVE FIO-EBR-ALL TO FIO-CMND.
      *>     PERFORM GNS-FIO-TAB.
      
           MOVE TSK-TERM-ALF        TO QUE-TERM.
           MOVE 'CTM '              TO QUE-TYPE.
           MOVE +18                 TO QUE-LITM.
           MOVE 1                   TO QUE-NITM.
           MOVE QUE-GET             TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                 MOVE 0 TO SYS-TCMA
                 MOVE SPACES TO SYS-CMMA
                 MOVE SYS-XCTL TO SYS-CMND
                 MOVE 'LDCPPTRO' TO SYS-PROG
                 PERFORM GNS-PRO-SYS
           ELSE
      *>INI-PENTA TUXEDO ORACLE
      *>           EXEC CICS
      *>             RETURN
      *>           END-EXEC.
                 MOVE 'TPRETURN '      TO LOGMSG-TEXT
                 MOVE '01'             TO LOGMSG-NUMB
                 PERFORM DO-USERLOG
                 MOVE LENGTH OF DFHCOMMAREA TO LEN
                 SET TPSUCCESS TO TRUE.
                 CALL "TPRETURN" USING TPSVCRET-REC
                                 TPTYPE-REC
                                 DFHCOMMAREA
                                 TPSTATUS-REC.
      *>FIN-PENTA TUXEDO ORACLE
      
      
      
      *>INI-PENTA TUXEDO ORACLE
      *>     EXEC CICS
      *>        FREE
      *>     END-EXEC.
            GOBACK.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-FIN.
           EXIT.
      *>COPY LDCBGQUE.
      
      *>Modulo Generico Manejo de
       GNS-CHK-QUEU SECTION.
       INI-GNS-CHK-QUEU.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GNS-CHK-QUEU.
           EXIT.
      
       GNS-QUE-EOQ SECTION.
       INI-GNS-QUE-EOQ.
           MOVE QUE-STAT-EOQ TO QUE-STAT.
           GO TO FIN-GNS-PRO-QUE.
       FIN-GNS-QUE-EOQ.
           EXIT.
      
       GNS-QUE-NEX SECTION.
       INI-GNS-QUE-NEX.
           MOVE QUE-STAT-NEX TO QUE-STAT.
           GO TO FIN-GNS-PRO-QUE.
       FIN-GNS-QUE-NEX.
           EXIT.
      
      *>*************************************************************
       GNS-ERR-QUE SECTION.
       INI-GNS-ERR-QUE.
      *>INI-PENTA TUXEDO ORACLE
      *>     EXEC CICS HANDLE CONDITION
      *>               QIDERR (GNS-QUE-NEX)
      *>               ITEMERR(GNS-QUE-EOQ)
      *>               LENGERR(GNS-QUE-NEX)
      *>     END-EXEC.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-GNS-ERR-QUE.
           EXIT.
      
       GNS-PRO-QUE SECTION.
       INI-GNS-PRO-QUE.
           MOVE QUE-STAT-OKS TO QUE-STAT.
           IF QUE-CMND = QUE-PUT
              GO TO GNS-PUT-QUE
           ELSE
           IF QUE-CMND = QUE-GET
              GO TO GNS-GET-QUE
           ELSE
           IF QUE-CMND = QUE-MOD
              GO TO GNS-MOD-QUE
           ELSE
           IF QUE-CMND = QUE-DEL
              GO TO GNS-DEL-QUE.
           MOVE 'Comando invalido :' TO QUE-MEN1.
           MOVE QUE-CMND             TO QUE-MEN2.
      
      *>INI-PENTA TUXEDO ORACLE
      *>     EXEC CICS XCTL
      *>               PROGRAM("GNSPPABT")
      *>               COMMAREA(QUE-MENS)
      *>               LENGTH(+79)
      *>     END-EXEC.
      
           MOVE +79                  TO LEN.
           MOVE "CARRAY"             TO REC-TYPE.
           MOVE 'GNSPPABT'           TO SERVICE-NAME.
           CALL "TPFORWARD" USING TPSVCDEF-REC
                                  TPTYPE-REC
                                  QUE-MENS
                                  TPSTATUS-REC.
           GOBACK.
      *>FIN-PENTA TUXEDO ORACLE
      
       GNS-PUT-QUE.
           IF WSS-IND-QUE = '   '
      *>INI-PENTA TUXEDO ORACLE
      *>         EXEC CICS WRITEQ TS
      *>               QUEUE(QUE-COLA)
      *>               FROM(QUE-ITEM)
      *>               LENGTH(QUE-LITM)
      *>               AUXILIARY
      *>        END-EXEC
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE ZEROES   TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE QUE-ITEM TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDI'
      *>INI-PENTA TUXEDO ORACLE
      *>         EXEC CICS WRITEQ TS
      *>               QUEUE(QUE-COLA)
      *>               FROM(TDI-GLS-DESC-1)
      *>               LENGTH(QUE-LITM)
      *>               AUXILIARY
      *>        END-EXEC
              MOVE QUE-CMND       TO QUE-COM-SEND
              MOVE QUE-COLA       TO QUE-NAM-SEND
              MOVE ZEROES         TO QUE-NUM-SEND
              MOVE QUE-LITM       TO QUE-LAR-SEND
              MOVE SPACES         TO QUE-TRX-SEND
              MOVE TDI-GLS-DESC-1 TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>         EXEC CICS WRITEQ TS
      *>               QUEUE(QUE-COLA)
      *>               FROM(TDI-GLS-DESC-2)
      *>               LENGTH(QUE-LITM)
      *>               AUXILIARY
      *>        END-EXEC
              MOVE QUE-CMND       TO QUE-COM-SEND
              MOVE QUE-COLA       TO QUE-NAM-SEND
              MOVE ZEROES         TO QUE-NUM-SEND
              MOVE QUE-LITM       TO QUE-LAR-SEND
              MOVE SPACES         TO QUE-TRX-SEND
              MOVE TDI-GLS-DESC-2 TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDO'
      *>INI-PENTA TUXEDO ORACLE
      *>         EXEC CICS WRITEQ TS
      *>               QUEUE(QUE-COLA)
      *>               FROM(TDO-GLS-DESC-1)
      *>               LENGTH(QUE-LITM)
      *>               AUXILIARY
      *>        END-EXEC
              MOVE QUE-CMND       TO QUE-COM-SEND
              MOVE QUE-COLA       TO QUE-NAM-SEND
              MOVE ZEROES         TO QUE-NUM-SEND
              MOVE QUE-LITM       TO QUE-LAR-SEND
              MOVE SPACES         TO QUE-TRX-SEND
              MOVE TDO-GLS-DESC-1 TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>         EXEC CICS WRITEQ TS
      *>               QUEUE(QUE-COLA)
      *>               FROM(TDO-GLS-DESC-2)
      *>               LENGTH(QUE-LITM)
      *>               AUXILIARY
      *>        END-EXEC.
              MOVE QUE-CMND       TO QUE-COM-SEND
              MOVE QUE-COLA       TO QUE-NAM-SEND
              MOVE ZEROES         TO QUE-NUM-SEND
              MOVE QUE-LITM       TO QUE-LAR-SEND
              MOVE SPACES         TO QUE-TRX-SEND
              MOVE TDO-GLS-DESC-2 TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-GNS-PUT-QUE.
           GO TO FIN-GNS-PRO-QUE.
       GNS-GET-QUE.
           IF WSS-IND-QUE = '   '
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS READQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  INTO(QUE-ITEM)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE SPACES   TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDI'
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS READQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  INTO(TDI-GLS-DESC-1)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>        END-EXEC
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE SPACES   TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
              MOVE QUE-DAT-RECV TO TDI-GLS-DESC-1
      *>FIN-PENTA TUXEDO ORACLE
               ADD 1  TO  QUE-NITM
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS READQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  INTO(TDI-GLS-DESC-2)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE SPACES   TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
              MOVE QUE-DAT-RECV TO TDI-GLS-DESC-2
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDO'
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS READQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  INTO(TDO-GLS-DESC-1)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>        END-EXEC
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE SPACES   TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
              MOVE QUE-DAT-RECV TO TDO-GLS-DESC-1
      *>FIN-PENTA TUXEDO ORACLE
               ADD 1  TO  QUE-NITM
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS READQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  INTO(TDO-GLS-DESC-2)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE SPACES   TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
              MOVE QUE-DAT-RECV TO TDO-GLS-DESC-2.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-GNS-GET-QUE.
           GO TO FIN-GNS-PRO-QUE.
       GNS-MOD-QUE.
           IF WSS-IND-QUE = SPACES
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS WRITEQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  FROM(QUE-ITEM)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>                  REWRITE
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE QUE-ITEM TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDI'
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS WRITEQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  FROM(TDI-GLS-DESC)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>                  REWRITE
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE TDI-GLS-DESC TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE
      *>FIN-PENTA TUXEDO ORACLE
           ELSE
           IF WSS-IND-QUE = 'TDO'
      *>INI-PENTA TUXEDO ORACLE
      *>        EXEC CICS WRITEQ TS
      *>                  QUEUE(QUE-COLA)
      *>                  FROM(TDO-GLS-DESC)
      *>                  LENGTH(QUE-LITM)
      *>                  ITEM(QUE-NITM)
      *>                  REWRITE
      *>        END-EXEC.
              MOVE QUE-CMND TO QUE-COM-SEND
              MOVE QUE-COLA TO QUE-NAM-SEND
              MOVE QUE-NITM TO QUE-NUM-SEND
              MOVE QUE-LITM TO QUE-LAR-SEND
              MOVE SPACES   TO QUE-TRX-SEND
              MOVE TDO-GLS-DESC TO QUE-DAT-SEND
              PERFORM GNS-MSJ-QUE.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-GNS-MOD-QUE.
           GO TO FIN-GNS-PRO-QUE.
       GNS-DEL-QUE.
      *>INI-PENTA TUXEDO ORACLE
      *>     EXEC CICS DELETEQ TS
      *>               QUEUE(QUE-COLA)
      *>     END-EXEC.
      
           MOVE QUE-CMND TO QUE-COM-SEND.
           MOVE QUE-COLA TO QUE-NAM-SEND.
           MOVE ZEROES   TO QUE-NUM-SEND.
           MOVE ZEROES   TO QUE-LAR-SEND.
           MOVE SPACES   TO QUE-TRX-SEND.
           MOVE SPACES   TO QUE-DAT-SEND.
           PERFORM GNS-MSJ-QUE.
      *>FIN-PENTA TUXEDO ORACLE
       FIN-GNS-DEL-QUE.
           GO TO FIN-GNS-PRO-QUE.
       FIN-GNS-PRO-QUE.
           EXIT.
      *>INI-PENTA TUXEDO ORACLE
       GNS-MSJ-QUE SECTION.
       INI-GNS-MSJ-QUE.
      
           SET QUE-TPTRAN      TO TRUE.
      *>     SET QUE-TPNOTRAN      TO TRUE.
           SET QUE-TPBLOCK     TO TRUE.
           SET QUE-TPNOTIME    TO TRUE.
           SET QUE-TPSIGRSTRT  TO TRUE.
           SET QUE-TPCHANGE    TO TRUE.
      
      *>     MOVE "TEMPORAL STORAGE INICIO "  TO LOGMSG-TEXT.
      *>     MOVE "00"                TO LOGMSG-NUMB.
      *>     PERFORM DO-USERLOG.
      
           CALL "TPCALL" USING QUE-TPSVCDEF-REC
                QUE-TPTYPE-REC-SEND
                QUE-SEND
                QUE-TPTYPE-REC-RECV
                QUE-RECV
                TPSTATUS-REC.
      
           IF NOT TPOK
              MOVE QUE-STAT-NEX TO QUE-STAT
              MOVE TP-STATUS    TO QUE-NUM-STAT
              MOVE QUE-NUM-STAT TO QUE-GLS-STAT
              MOVE QUE-GLS-STAT TO LOGMSG-TEXT
              PERFORM DO-USERLOG
           ELSE
              IF QUE-STA-RECV = ZEROES
                 MOVE QUE-STAT-OKS TO QUE-STAT
                 MOVE QUE-DAT-RECV TO QUE-ITEM
              ELSE
                 MOVE QUE-STAT-NEX TO QUE-STAT.
      
      *>     MOVE "TEMPORAL STORAGE TERMINO"  TO LOGMSG-TEXT.
      *>     MOVE "01"             TO LOGMSG-NUMB.
      *>     PERFORM DO-USERLOG.
      
      
      
       FIN-GNS-MSJ-QUE.
           EXIT.
      *>FIN-PENTA TUXEDO ORACLE
      
       GET-TSK-TERM SECTION.                                            
       INI-GET-TSK-TERM.                                                
      
           IF TSK-TERM-ORIGEN = 'S'
              GO TO FIN-GET-TSK-TERM.                                   
      
           CALL "TPGETLEV" USING TPTRXLEV-REC
                                 TPSTATUS-REC. 
           IF NOT TPOK
              DISPLAY 'ERROR  TPGETLEV :' TP-STATUS
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'TPGETLEV TP-NOT-IN-TRAN:' TP-STATUS.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC
                                 TPSTATUS-REC.                          
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           
           CALL "TPRESUME" USING TPTRXDEF-REC
                                 TPSTATUS-REC.             
           IF NOT TPOK
              DISPLAY 'ERROR  TPSUSPEND :' TP-STATUS.
      
           MOVE TRANID(1) TO TSK-TRANID-1.
           MOVE TRANID(2) TO TSK-TRANID-2.
           MOVE TRANID(3) TO TSK-TRANID-3.
           MOVE TRANID(4) TO TSK-TRANID-4.
           MOVE TRANID(5) TO TSK-TRANID-5.
           MOVE TRANID(6) TO TSK-TRANID-6.
      
           MOVE SPACES         TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF TO TSK-TERM-TUX.
      
           MOVE TSK-TERM-TUX        TO TSK-TERM-TUX.                    
           MOVE 'GET'               TO QUE-COM-SEND.                    
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.      
           MOVE 1                   TO QUE-NUM-SEND.      
           MOVE 4                   TO QUE-LAR-SEND.      
           MOVE SPACES              TO QUE-TRX-SEND.      
           MOVE SPACES              TO QUE-DAT-SEND.                    
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              DISPLAY 'NO ENCONTRO COLA ASUME 1111111 :' TSK-TERM-TUX  
              MOVE 1111111          TO TSK-TERM-NUM-TUX
              MOVE TSK-TERM-NUM-TUX TO TSK-TERM-NUM
              MOVE TSK-TERM-NUM     TO EIBTASKN
              GO TO FIN-GET-TSK-TERM.                                   
           
           
           MOVE QUE-DAT-RECV        TO QUE-ITEM.           
           MOVE QUE-DATA            TO TSK-TERM-NUM-TUX-ALF.
           MOVE TSK-TERM-NUM-TUX    TO TSK-TERM-NUM.
           MOVE TSK-TERM-ALF        TO EIBTASKN.
           MOVE TSK-TERM-ALF        TO EIBTRMID.
           
      *>     DISPLAY "SI ENCONTRO COLA ASUME " TSK-TERM-NUM-TUX " :" 
      *>                                       TSK-TERM-TUX " :"
      *>                                       TSK-TERM-ALF " :"  
      *>                                       EIBTASKN.
      
       FIN-GET-TSK-TERM.                                                
           EXIT.                                                        
                     
      *>****************************************************
      *>  Issue a TPCALL
      *>****************************************************
       GNS-FIO-DTC SECTION.
       INI-GNS-FIO-DTC.
      
           MOVE ADR-REQA             TO FIO-ORACLE-RQA.
           MOVE FIO-DFLD             TO FIO-ORACLE-DFLD.
           MOVE FIO-MENS             TO FIO-ORACLE-MENS.
           MOVE FIO-VARI             TO FIO-ORACLE-VARI.
           MOVE ADR-TABL IN ADR-REQA TO FIO-ORACLE-PROG-TAB.
           MOVE ADR-DBID IN ADR-REQA TO FIO-ORACLE-PROG-NUM.
           MOVE FIO-ORACLE           TO SEND-STRING-FIO.
      
           IF FIO-CMND = 38
              MOVE ZEROES TO FIO-STAT
              PERFORM TUX-BACK-OUT
              GO TO FIN-GNS-FIO-DTC.
      
           MOVE 3000                 TO LEN.
           MOVE "CARRAY"             TO REC-TYPE.
           MOVE FIO-ORACLE-PROG      TO SERVICE-NAME.
      
      
           MOVE FIO-CMND             TO LOGMSG-TEXT-1.
           MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
           MOVE SPACES               TO LOGMSG-TEXT-3.
           MOVE '40'                 TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
      
           SET TPBLOCK    IN TPSVCDEF-REC TO TRUE.
           SET TPTRAN     IN TPSVCDEF-REC TO TRUE.
           SET TPNOTIME   IN TPSVCDEF-REC TO TRUE.
           SET TPSIGRSTRT IN TPSVCDEF-REC TO TRUE.
           SET TPCHANGE   IN TPSVCDEF-REC TO TRUE.
      
           CALL "TPCALL" USING TPSVCDEF-REC
                TPTYPE-REC
                SEND-STRING-FIO
                TPTYPE-REC
                RECV-STRING-FIO
                TPSTATUS-REC.
      
      
           IF NOT TPOK
                DISPLAY 'GNSBGDTC :' FIO-ORACLE-PROG ' ' TP-STATUS
                MOVE "TPCALL Failed" TO FIO-MENS
                PERFORM PRG-ABT.
      
      
           MOVE FIO-CMND             TO LOGMSG-TEXT-1.
           MOVE FIO-ORACLE-PROG      TO LOGMSG-TEXT-2.
           MOVE SPACES               TO LOGMSG-TEXT-3.
           MOVE '41'                 TO LOGMSG-NUMB.
           PERFORM DO-USERLOG.
      
      
      
           MOVE RECV-STRING-FIO     TO FIO-ORACLE.
           MOVE FIO-ORACLE-RQA      TO ADR-REQA.
           MOVE FIO-ORACLE-DFLD     TO FIO-DFLD.
           MOVE FIO-ORACLE-MENS     TO FIO-MENS.
           MOVE FIO-ORACLE-VARI     TO FIO-VARI.
      
       FIN-GNS-FIO-DTC.
           EXIT.
      
       TUX-BACK-OUT SECTION.
       INI-TUX-BACK-OUT.
      
           CALL "TPGETLEV" USING TPTRXLEV-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPGETLEV:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT
           ELSE
              IF TP-NOT-IN-TRAN
                 DISPLAY 'GNSBGDTC TUX-BACK-OUT TP-NOT-IN-TRAN:'
                                                TP-STATUS
                 GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPSUSPEND" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPSUSPEND:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           CALL "TPRESUME" USING TPTRXDEF-REC TPSTATUS-REC.
           IF NOT TPOK
              DISPLAY 'GNSBGDTC TUX-BACK-OUT TPRESUME:'
                                             TP-STATUS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE TRANID(1)           TO TSK-TRANID-1.
           MOVE TRANID(2)           TO TSK-TRANID-2.
           MOVE TRANID(3)           TO TSK-TRANID-3.
           MOVE TRANID(4)           TO TSK-TRANID-4.
           MOVE TRANID(5)           TO TSK-TRANID-5.
           MOVE TRANID(6)           TO TSK-TRANID-6.
           MOVE SPACES              TO TSK-TERM-TUX.
           MOVE TSK-TRANID-ALF      TO TSK-TERM-TUX.
      
           MOVE 'GET'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE SPACES              TO QUE-TRX-SEND.
           MOVE SPACES              TO QUE-DAT-SEND.
           PERFORM GNS-MSJ-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
              GO TO FIN-TUX-BACK-OUT.
      
           MOVE QUE-DAT-RECV        TO QUE-ITEM.
           MOVE QUE-DATA            TO TSK-INFO-TRAN.
           MOVE 1                   TO TSK-INFO-COMMIT.
      
           MOVE 'MOD'               TO QUE-COM-SEND.
           MOVE TSK-TERM-TUX        TO QUE-NAM-SEND.
           MOVE 1                   TO QUE-NUM-SEND.
           MOVE 4                   TO QUE-LAR-SEND.
           MOVE TSK-INFO-TRANID-ALF TO QUE-TRX-SEND.
      
           MOVE TSK-INFO-TRAN       TO QUE-DATA.
           MOVE QUE-ITEM            TO QUE-DAT-SEND.
      
           PERFORM GNS-MSJ-QUE.
      
       FIN-TUX-BACK-OUT.
           EXIT.
                     
       BUS-RCI-IDD SECTION.
       INI-BUS-RCI-IDD.
      
      
           MOVE RCI-COD-CNAL IN RCI-VARI TO RCI-COD-CNAL-BKP.
      
       FST-BUS-RCI-IDD.
           MOVE ZEROES  TO RCI-NUM-IND1 IN RCI-VARI.
      
           MOVE SPACES                   TO RCI.
           IF RCI-COD-CNAL IN RCI-VARI NOT > SPACES
                  MOVE 'S' TO RCI-DFL-RRCI.
      
           MOVE RCI-COD-CPTO IN RCI-VARI TO RCI-COD-CPTO IN RCI.
      *>    MOVE RCI-GLS-AMBT IN RCI-VARI TO RCI-GLS-AMBT IN RCI.
           MOVE RCI-COD-BNCO IN RCI-VARI TO RCI-COD-BNCO IN RCI.
           MOVE RCI-COD-MRCA IN RCI-VARI TO RCI-COD-MRCA IN RCI.
           MOVE RCI-COD-CART IN RCI-VARI TO RCI-COD-CART IN RCI.
           MOVE RCI-COD-LENG IN RCI-VARI TO RCI-COD-LENG IN RCI.
           MOVE RCI-COD-PAIS IN RCI-VARI TO RCI-COD-PAIS IN RCI.
           MOVE RCI-COD-VRNT IN RCI-VARI TO RCI-COD-VRNT IN RCI.
           MOVE RCI-COD-CNAL IN RCI-VARI TO RCI-COD-CNAL IN RCI.
           MOVE RCI-COD-UMUA IN RCI-VARI TO RCI-COD-USER IN RCI.
           MOVE RCI-COD-MODO IN RCI-VARI TO RCI-COD-MODO IN RCI.
           MOVE SPACES                   TO RCI-KEY-DISP IN RCI.
           DISPLAY 'RCI-COD-CNAL <' RCI-COD-CNAL IN RCI '>'.
      
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'S' TO RCI-FST-RRCI.
      
       CIC-BUS-RCI-IDD.
      
           PERFORM GNS-FIO-RCI.
              DISPLAY 'RCI 1 <' RCI-COD-CPTO IN RCI-VARI '>'.
              DISPLAY 'RCI 2 <' RCI-COD-CPTO IN RCI '>'.
              DISPLAY 'RCI 3 <' RCI-GLS-AMBT IN RCI-VARI '>'.
              DISPLAY 'RCI 4 <' RCI-GLS-AMBT IN RCI '>'.
      
           IF FIO-STAT-OKS AND
              RCI-COD-CPTO IN RCI-VARI = RCI-COD-CPTO IN RCI AND
              RCI-GLS-AMBT IN RCI-VARI = RCI-GLS-AMBT IN RCI
                 DISPLAY 'NO ENCONTRE RCI'
                 MOVE 'N' TO RCI-FST-RRCI
           ELSE
           IF RCI-FST-RRCI = 'N'
                 GO TO EXT-BUS-RCI-IDD
           ELSE
                 IF RCI-DFL-RRCI = 'N'
                     MOVE SPACES TO RCI-COD-CNAL IN RCI-VARI
                     MOVE '-D'  TO RCI-CNAD-RRCI
                     GO TO FST-BUS-RCI-IDD
                 ELSE
      *>RGD-INI PENTA 16-08-2012
                     PERFORM CARGA-DEFECTO
                     GO TO FIN-BUS-RCI-IDD.
      *>              MOVE RCI-COD-CNAL-BKP TO RCI-COD-CNAL IN RCI-VARI
      *>              MOVE "FALTA DEFINICION AMB : " TO RCI-MSG-ABT1
      *>              MOVE RCI-KEY-CPTO IN RCI-VARI  TO RCI-MSG-ABT2
      *>              MOVE RCI-MSG-ABT TO SYS-MENS
      *>              MOVE SYS-ABOR TO SYS-CMND
      *>              PERFORM GNS-PRO-SYS.
      *>RGD-FIN PENTA 16-08-2012
      
           MOVE RCI-COD-CIDD IN RCI TO IDD-COD-CIDD IN IDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IDD.
           IF NOT FIO-STAT-OKS
      *>RGD-INI PENTA 16-08-2012
                     PERFORM CARGA-DEFECTO
                     GO TO FIN-BUS-RCI-IDD.
      *>          MOVE "FALTA DEFINICION IDD : " TO RCI-MSG-ABT1
      *>          MOVE IDD-COD-CIDD IN IDD       TO RCI-MSG-ABT2
      *>          MOVE RCI-MSG-ABT TO SYS-MENS
      *>          MOVE SYS-ABOR TO SYS-CMND
      *>          PERFORM GNS-PRO-SYS.
      *>RGD-FIN PENTA 16-08-2012
      
           MOVE 1 TO RCI-NUM-IND2 IN RCI-VARI.
       LUP-PRO-IDD.
           PERFORM MOV-IDD.
           ADD 1 TO RCI-NUM-IND2 IN RCI-VARI.
           IF IDD-COD-SIST IN IDD(RCI-NUM-IND2) > SPACES
              GO TO LUP-PRO-IDD.
      
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-BUS-RCI-IDD.
      
       EXT-BUS-RCI-IDD.
           MOVE RCI-IDD TO IDD-REGI.
      *>    MOVE RCI-COD-CNAL-BKP TO RCI-COD-CNAL IN RCI-VARI.
           MOVE 'N' TO RCI-DFL-RRCI.
           MOVE 'S' TO RCI-FST-RRCI.
       FIN-BUS-RCI-IDD.
           EXIT.
      
       MOV-IDD SECTION.
       INI-MOV-IDD.
           ADD 1 TO RCI-NUM-IND1 IN RCI-VARI
            DISPLAY ' CORR ORIGEN ' RCI-NUM-IND2
                    ' CORR DESTIN ' RCI-NUM-IND1.
            DISPLAY 'IDD SIST ' IDD-COD-SIST IN IDD(RCI-NUM-IND2)
                    '+' IDD-COD-GRPO IN IDD(RCI-NUM-IND2)
                    '+' IDD-COD-RGST IN IDD(RCI-NUM-IND2)
                    '+' IDD-COD-TENT IN IDD(RCI-NUM-IND2)
                    '+' IDD-COD-IENT IN IDD(RCI-NUM-IND2).
           MOVE IDD-COD-SIST IN IDD(RCI-NUM-IND2) TO
                           RCI-COD-SIST IN RCI-VARI(RCI-NUM-IND1).
           MOVE IDD-COD-GRPO IN IDD(RCI-NUM-IND2) TO
                           RCI-COD-GRPO IN RCI-VARI(RCI-NUM-IND1).
           MOVE IDD-COD-RGST IN IDD(RCI-NUM-IND2) TO
                           RCI-COD-RGST IN RCI-VARI(RCI-NUM-IND1).
           MOVE IDD-COD-TENT IN IDD(RCI-NUM-IND2) TO
                           RCI-COD-TENT IN RCI-VARI(RCI-NUM-IND1).
           MOVE IDD-COD-IENT IN IDD(RCI-NUM-IND2) TO
                           RCI-COD-IENT IN RCI-VARI(RCI-NUM-IND1).
       FIN-MOV-IDD.
           EXIT.
      
      *>RGD-INI PENTA 16-08-2012
       CARGA-DEFECTO SECTION.
       INI-CARGA-DEFECTO.
      
           MOVE TSK-TERM-ALF         TO WSS-TIDD.
           MOVE SPACES               TO IDD-REGI.
           MOVE 'DEFAULT'            TO IDD-CIDD.
           MOVE 'GNS'                TO IDD-SIST(01).
           MOVE 'C'                  TO IDD-GRPO(01).
           MOVE 'D'                  TO IDD-TENT(01).
           MOVE '180'                TO IDD-IENT(01).
           MOVE 'TAB'                TO IDD-SIST(02).
           MOVE 'C'                  TO IDD-GRPO(02).
           MOVE 'D'                  TO IDD-TENT(02).
           MOVE '150'                TO IDD-IENT(02).
           MOVE 'GES'                TO IDD-SIST(03).
           MOVE 'M'                  TO IDD-GRPO(03).
           MOVE 'D'                  TO IDD-TENT(03).
           MOVE '360'                TO IDD-IENT(03).
           MOVE 'SGC'                TO IDD-SIST(04).
           MOVE 'M'                  TO IDD-GRPO(04).
           MOVE 'D'                  TO IDD-TENT(04).
           MOVE '100'                TO IDD-IENT(04).
           MOVE 'SGC'                TO IDD-SIST(05).
           MOVE 'C'                  TO IDD-GRPO(05).
           MOVE 'D'                  TO IDD-TENT(05).
           MOVE '190'                TO IDD-IENT(05).
           MOVE 'SGC'                TO IDD-SIST(06).
           MOVE 'T'                  TO IDD-GRPO(06).
           MOVE 'D'                  TO IDD-TENT(06).
           MOVE '100'                TO IDD-IENT(06).
           MOVE 'DEU'                TO IDD-SIST(07).
           MOVE 'M'                  TO IDD-GRPO(07).
           MOVE 'D'                  TO IDD-TENT(07).
           MOVE '140'                TO IDD-IENT(07).
           MOVE 'GNS'                TO IDD-SIST(08).
           MOVE 'M'                  TO IDD-GRPO(08).
           MOVE 'D'                  TO IDD-TENT(08).
           MOVE '180'                TO IDD-IENT(08).
           MOVE 'DEU'                TO IDD-SIST(09).
           MOVE 'C'                  TO IDD-GRPO(09).
           MOVE 'D'                  TO IDD-TENT(09).
           MOVE '200'                TO IDD-IENT(09).
           MOVE 'MC2'                TO IDD-SIST(10).
           MOVE 'C'                  TO IDD-GRPO(10).
           MOVE 'D'                  TO IDD-TENT(10).
           MOVE '501'                TO IDD-IENT(10).
           MOVE 'GES'                TO IDD-SIST(11).
           MOVE 'T'                  TO IDD-GRPO(11).
           MOVE 'D'                  TO IDD-TENT(11).
           MOVE '362'                TO IDD-IENT(11).
           MOVE 'GES'                TO IDD-SIST(12).
           MOVE 'C'                  TO IDD-GRPO(12).
           MOVE 'D'                  TO IDD-TENT(12).
           MOVE '354'                TO IDD-IENT(12).
           MOVE 'COL'                TO IDD-SIST(13).
           MOVE 'M'                  TO IDD-GRPO(13).
           MOVE 'D'                  TO IDD-TENT(13).
           MOVE '160'                TO IDD-IENT(13).
           MOVE 'COL'                TO IDD-SIST(14).
           MOVE 'T'                  TO IDD-GRPO(14).
           MOVE 'D'                  TO IDD-TENT(14).
           MOVE '170'                TO IDD-IENT(14).
           MOVE 'COL'                TO IDD-SIST(15).
           MOVE 'C'                  TO IDD-GRPO(15).
           MOVE 'D'                  TO IDD-TENT(15).
           MOVE '210'                TO IDD-IENT(15).
           MOVE 'BGL'                TO IDD-SIST(16).
           MOVE 'M'                  TO IDD-GRPO(16).
           MOVE 'D'                  TO IDD-TENT(16).
           MOVE '209'                TO IDD-IENT(16).
           MOVE 'MC2'                TO IDD-SIST(17).
           MOVE 'M'                  TO IDD-GRPO(17).
           MOVE 'D'                  TO IDD-TENT(17).
           MOVE '500'                TO IDD-IENT(17).
           MOVE 'DAP'                TO IDD-SIST(18).
           MOVE 'M'                  TO IDD-GRPO(18).
           MOVE 'D'                  TO IDD-TENT(18).
           MOVE '370'                TO IDD-IENT(18).
           MOVE 'SIN'                TO IDD-SIST(19).
           MOVE 'C'                  TO IDD-GRPO(19).
           MOVE 'D'                  TO IDD-TENT(19).
           MOVE '190'                TO IDD-IENT(19).
           MOVE 'SPA'                TO IDD-SIST(20).
           MOVE 'C'                  TO IDD-GRPO(20).
           MOVE 'D'                  TO IDD-TENT(20).
           MOVE '355'                TO IDD-IENT(20).
           MOVE 'SGC'                TO IDD-SIST(21).
           MOVE 'S'                  TO IDD-GRPO(21).
           MOVE 'D'                  TO IDD-TENT(21).
           MOVE '100'                TO IDD-IENT(21).
           MOVE 'SPA'                TO IDD-SIST(22).
           MOVE 'M'                  TO IDD-GRPO(22).
           MOVE 'D'                  TO IDD-TENT(22).
           MOVE '355'                TO IDD-IENT(22).
           MOVE 'GES'                TO IDD-SIST(23).
           MOVE 'C'                  TO IDD-GRPO(23).
           MOVE 'D'                  TO IDD-TENT(23).
           MOVE '354'                TO IDD-IENT(23).
           MOVE 'CCT'                TO IDD-SIST(24).
           MOVE 'C'                  TO IDD-GRPO(24).
           MOVE 'D'                  TO IDD-TENT(24).
           MOVE '381'                TO IDD-IENT(24).
           MOVE 'DAP'                TO IDD-SIST(25).
           MOVE 'C'                  TO IDD-GRPO(25).
           MOVE 'D'                  TO IDD-TENT(25).
           MOVE '371'                TO IDD-IENT(25).
           MOVE 'DAP'                TO IDD-SIST(26).
           MOVE 'T'                  TO IDD-GRPO(26).
           MOVE 'D'                  TO IDD-TENT(26).
           MOVE '372'                TO IDD-IENT(26).
           MOVE 'SEC'                TO IDD-SIST(27).
           MOVE 'C'                  TO IDD-GRPO(27).
           MOVE 'D'                  TO IDD-TENT(27).
           MOVE '341'                TO IDD-IENT(27).
           MOVE 'SUP'                TO IDD-SIST(28).
           MOVE 'M'                  TO IDD-GRPO(28).
           MOVE 'D'                  TO IDD-TENT(28).
           MOVE '230'                TO IDD-IENT(28).
           MOVE 'SUP'                TO IDD-SIST(29).
           MOVE 'C'                  TO IDD-GRPO(29).
           MOVE 'D'                  TO IDD-TENT(29).
           MOVE '230'                TO IDD-IENT(29).
           MOVE 'LDC'                TO IDD-SIST(30).
           MOVE 'M'                  TO IDD-GRPO(30).
           MOVE 'D'                  TO IDD-TENT(30).
           MOVE '260'                TO IDD-IENT(30).
           MOVE 'SEC'                TO IDD-SIST(31).
           MOVE 'M'                  TO IDD-GRPO(31).
           MOVE 'D'                  TO IDD-TENT(31).
           MOVE '341'                TO IDD-IENT(31).
           MOVE 'LDC'                TO IDD-SIST(32).
           MOVE 'C'                  TO IDD-GRPO(32).
           MOVE 'D'                  TO IDD-TENT(32).
           MOVE '261'                TO IDD-IENT(32).
           MOVE 'CCT'                TO IDD-SIST(33).
           MOVE 'M'                  TO IDD-GRPO(33).
           MOVE 'D'                  TO IDD-TENT(33).
           MOVE '380'                TO IDD-IENT(33).
           MOVE 'BGL'                TO IDD-SIST(34).
           MOVE 'C'                  TO IDD-GRPO(34).
           MOVE 'D'                  TO IDD-TENT(34).
           MOVE '211'                TO IDD-IENT(34).
      
       FIN-CARGA-DEFECTO.
           EXIT.
      *>RGD-FIN PENTA 16-08-2012
                     
      *> Modulo FIO para registro RCI en DATACOM, 18-MAR-2004 10:39:28.29
       GNS-FIO-RCI SECTION.                                             
       INI-GNS-FIO-RCI.                                                 
           MOVE ADR-RCI-REQA TO ADR-REQA.                               
           MOVE 'RCI' TO ADR-TABL IN ADR-REQA.                          
           MOVE 999   TO ADR-DBID IN ADR-REQA.                          
      *>                                                                 
      *>     MOVE "GNS"  TO IDD-SAUX.                                    
      *>     MOVE "C"    TO IDD-GAUX.                                    
      *>     MOVE SPACES TO IDD-RAUX.                                    
      *>     MOVE 1 TO IDD-IAUX.                                         
      *>     SET IDD-ITBL TO 1.                                          
      *>     SEARCH IDD-VSIS VARYING IDD-IAUX                            
      *>       AT END                                                    
      *>         GO TO GRP-GNS-FIO-RCI                                   
      *>       WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                      
      *>         MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA        
      *>         GO TO FSR-GNS-FIO-RCI.                                  
      *> GRP-GNS-FIO-RCI.                                                
      *>     MOVE SPACES TO IDD-GAUX.                                    
      *>     MOVE 1      TO IDD-IAUX.                                    
      *>     SET IDD-ITBL TO 1.                                          
      *>     SEARCH IDD-VSIS VARYING IDD-IAUX                            
      *>       AT END                                                    
      *>         MOVE "En GNS-FIO-RCI, NO existe en IDD:" TO FIO-MEN1    
      *>         MOVE IDD-DAUX                            TO FIO-MEN2    
      *>         PERFORM PRG-ABT                                         
      *>       WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                      
      *>         MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.       
       FSR-GNS-FIO-RCI.                                                 
      *>                                                                 
           MOVE 'RCI00' TO ADR-ELM1.                                    
           MOVE FIO-PROG TO ADR-PROG.                                   
           IF FIO-KDEF = FIO-KDEF-S                                     
               GO TO CON-GNS-FIO-RCI.                                   
           MOVE FIO-CMND TO FIO-IAKY.                                   
           IF NOT FIO-IAKY-CON AND                                      
              ( FIO-AKEY = 'RCI-KEY-IRCI' OR FIO-AKEY NOT > SPACES )    
               MOVE RCI-KEY-IRCI IN RCI TO ADR-VKEY IN ADR-REQA         
               MOVE 'RCI00' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
           IF FIO-AKEY = 'RCI-COD-CIDD'                                 
               MOVE RCI-COD-CIDD IN RCI TO ADR-VKEY IN ADR-REQA         
               MOVE 'RCI01' TO ADR-DKEY IN ADR-REQA                     
           ELSE                                                         
               MOVE 'En GNS-FIO-RCI, key' TO FIO-MENS                   
               MOVE FIO-AKEY   TO FIO-MENS-KEY                          
               MOVE 'Invalida' TO FIO-MENS-FIL                          
               PERFORM PRG-ABT.                                         
       CON-GNS-FIO-RCI.                                                 
           MOVE RCI TO FIO-DFLD.                                        
           PERFORM GNS-FIO-DTC.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-DFLD TO RCI                                     
           ELSE                                                         
               MOVE 'GNSRCI' TO FIO-MEN2                                
               IF FIO-STAT-FTL                                          
                   PERFORM PRG-ABT.                                     
           MOVE SPACES   TO FIO-AKEY.                                   
           MOVE FIO-KDEF-N TO FIO-KDEF.                                 
           MOVE ADR-REQA TO ADR-RCI-REQA.                               
       FIN-GNS-FIO-RCI.                                                 
           EXIT.                                                        
                     
      
       PRO-CCI SECTION.
       INI-PRO-CCI.
      
      *>RGD
      *>     PERFORM CARGA-IDD.
      *>     PERFORM GNS-PUT-IDD.
      *>     MOVE QUE-LITM TO WSS-QIDD-LEN.
      *>     GO TO FIN-PRO-CCI.
      *>RGD
            DISPLAY 'INI PRO-CCI'.
      *>     MOVE  WSS-TSC-BNCO TO  TSC-BNCO.
      *>     MOVE  WSS-TSC-MRCA TO  TSC-MRCA.
      *>     MOVE  WSS-TSC-CART TO  TSC-CART.
      *>     MOVE  WSS-TSC-LENG TO  TSC-LENG.
      *>     MOVE  WSS-TSC-PAIS TO  TSC-PAIS.
      *>     MOVE  WSS-TSC-VRNT TO  TSC-VRNT.
      
      *>  SETEA IDD PARA PROGRAMAS DE APLICACION
      
           MOVE TSC-BNCO     TO RCI-COD-BNCO IN RCI-VARI.
           MOVE TSC-MRCA     TO RCI-COD-MRCA IN RCI-VARI.
           MOVE TSC-CART     TO RCI-COD-CART IN RCI-VARI.
           MOVE TSC-LENG     TO RCI-COD-LENG IN RCI-VARI.
           MOVE TSC-PAIS     TO RCI-COD-PAIS IN RCI-VARI.
           MOVE TSC-VRNT     TO RCI-COD-VRNT IN RCI-VARI.
           MOVE TSC-CNAL     TO RCI-COD-CNAL IN RCI-VARI.
           MOVE TSC-UMUA     TO RCI-COD-UMUA IN RCI-VARI.
           MOVE TSC-MODO     TO RCI-COD-MODO IN RCI-VARI.
           MOVE 'DEFAULT'    TO RCI-COD-CPTO IN RCI-VARI.
           PERFORM BUS-RCI-IDD.
           PERFORM GNS-PUT-IDD.
           MOVE QUE-LITM TO WSS-QIDD-LEN.
      
      *>    MOVE TSC-BNCO     TO RCI-COD-BNCO IN RCI-VARI.
      *>    MOVE TSC-MRCA     TO RCI-COD-MRCA IN RCI-VARI.
      *>    MOVE TSC-CART     TO RCI-COD-CART IN RCI-VARI.
      *>    MOVE TSC-LENG     TO RCI-COD-LENG IN RCI-VARI.
      *>    MOVE TSC-PAIS     TO RCI-COD-PAIS IN RCI-VARI.
      *>    MOVE TSC-VRNT     TO RCI-COD-VRNT IN RCI-VARI.
      *>    MOVE "GNSPP081"   TO RCI-COD-CPTO IN RCI-VARI.
      
      
      *>    PERFORM BUS-RCI-IDD.
      
       FIN-PRO-CCI.
           EXIT.
      *>COPY GNSBCIDD.
      *>COPY GNSBBIDD.
      
       CARGA-IDD SECTION.
       INI-CARGA-IDD.
      
           MOVE TSK-TERM-ALF         TO WSS-TIDD.
           MOVE SPACES               TO IDD-REGI.
           MOVE 'DEFAULT'            TO IDD-CIDD.
           MOVE 'GNS'                TO IDD-SIST(01).
           MOVE 'C'                  TO IDD-GRPO(01).
           MOVE 'D'                  TO IDD-TENT(01).
           MOVE '180'                TO IDD-IENT(01).
           MOVE 'TAB'                TO IDD-SIST(02).
           MOVE 'C'                  TO IDD-GRPO(02).
           MOVE 'D'                  TO IDD-TENT(02).
           MOVE '150'                TO IDD-IENT(02).
           MOVE 'GES'                TO IDD-SIST(03).
           MOVE 'M'                  TO IDD-GRPO(03).
           MOVE 'D'                  TO IDD-TENT(03).
           MOVE '360'                TO IDD-IENT(03).
           MOVE 'SGC'                TO IDD-SIST(04).
           MOVE 'M'                  TO IDD-GRPO(04).
           MOVE 'D'                  TO IDD-TENT(04).
           MOVE '100'                TO IDD-IENT(04).
           MOVE 'SGC'                TO IDD-SIST(05).
           MOVE 'C'                  TO IDD-GRPO(05).
           MOVE 'D'                  TO IDD-TENT(05).
           MOVE '190'                TO IDD-IENT(05).
           MOVE 'SGC'                TO IDD-SIST(06).
           MOVE 'T'                  TO IDD-GRPO(06).
           MOVE 'D'                  TO IDD-TENT(06).
           MOVE '100'                TO IDD-IENT(06).
           MOVE 'DEU'                TO IDD-SIST(07).
           MOVE 'M'                  TO IDD-GRPO(07).
           MOVE 'D'                  TO IDD-TENT(07).
           MOVE '140'                TO IDD-IENT(07).
           MOVE 'GNS'                TO IDD-SIST(08).
           MOVE 'M'                  TO IDD-GRPO(08).
           MOVE 'D'                  TO IDD-TENT(08).
           MOVE '180'                TO IDD-IENT(08).
           MOVE 'DEU'                TO IDD-SIST(09).
           MOVE 'C'                  TO IDD-GRPO(09).
           MOVE 'D'                  TO IDD-TENT(09).
           MOVE '200'                TO IDD-IENT(09).
           MOVE 'MC2'                TO IDD-SIST(10).
           MOVE 'C'                  TO IDD-GRPO(10).
           MOVE 'D'                  TO IDD-TENT(10).
           MOVE '501'                TO IDD-IENT(10).
           MOVE 'GES'                TO IDD-SIST(11).
           MOVE 'T'                  TO IDD-GRPO(11).
           MOVE 'D'                  TO IDD-TENT(11).
           MOVE '362'                TO IDD-IENT(11).
           MOVE 'GES'                TO IDD-SIST(12).
           MOVE 'C'                  TO IDD-GRPO(12).
           MOVE 'D'                  TO IDD-TENT(12).
           MOVE '354'                TO IDD-IENT(12).
           MOVE 'COL'                TO IDD-SIST(13).
           MOVE 'M'                  TO IDD-GRPO(13).
           MOVE 'D'                  TO IDD-TENT(13).
           MOVE '160'                TO IDD-IENT(13).
           MOVE 'COL'                TO IDD-SIST(14).
           MOVE 'T'                  TO IDD-GRPO(14).
           MOVE 'D'                  TO IDD-TENT(14).
           MOVE '170'                TO IDD-IENT(14).
           MOVE 'COL'                TO IDD-SIST(15).
           MOVE 'C'                  TO IDD-GRPO(15).
           MOVE 'D'                  TO IDD-TENT(15).
           MOVE '210'                TO IDD-IENT(15).
           MOVE 'BGL'                TO IDD-SIST(16).
           MOVE 'M'                  TO IDD-GRPO(16).
           MOVE 'D'                  TO IDD-TENT(16).
           MOVE '209'                TO IDD-IENT(16).
           MOVE 'MC2'                TO IDD-SIST(17).
           MOVE 'M'                  TO IDD-GRPO(17).
           MOVE 'D'                  TO IDD-TENT(17).
           MOVE '500'                TO IDD-IENT(17).
           MOVE 'DAP'                TO IDD-SIST(18).
           MOVE 'M'                  TO IDD-GRPO(18).
           MOVE 'D'                  TO IDD-TENT(18).
           MOVE '370'                TO IDD-IENT(18).
           MOVE 'SIN'                TO IDD-SIST(19).
           MOVE 'C'                  TO IDD-GRPO(19).
           MOVE 'D'                  TO IDD-TENT(19).
           MOVE '190'                TO IDD-IENT(19).
           MOVE 'SPA'                TO IDD-SIST(20).
           MOVE 'C'                  TO IDD-GRPO(20).
           MOVE 'D'                  TO IDD-TENT(20).
           MOVE '355'                TO IDD-IENT(20).
           MOVE 'SGC'                TO IDD-SIST(21).
           MOVE 'S'                  TO IDD-GRPO(21).
           MOVE 'D'                  TO IDD-TENT(21).
           MOVE '100'                TO IDD-IENT(21).
           MOVE 'SPA'                TO IDD-SIST(22).
           MOVE 'M'                  TO IDD-GRPO(22).
           MOVE 'D'                  TO IDD-TENT(22).
           MOVE '355'                TO IDD-IENT(22).
           MOVE 'GES'                TO IDD-SIST(23).
           MOVE 'C'                  TO IDD-GRPO(23).
           MOVE 'D'                  TO IDD-TENT(23).
           MOVE '354'                TO IDD-IENT(23).
           MOVE 'CCT'                TO IDD-SIST(24).
           MOVE 'C'                  TO IDD-GRPO(24).
           MOVE 'D'                  TO IDD-TENT(24).
           MOVE '381'                TO IDD-IENT(24).
           MOVE 'DAP'                TO IDD-SIST(25).
           MOVE 'C'                  TO IDD-GRPO(25).
           MOVE 'D'                  TO IDD-TENT(25).
           MOVE '371'                TO IDD-IENT(25).
           MOVE 'DAP'                TO IDD-SIST(26).
           MOVE 'T'                  TO IDD-GRPO(26).
           MOVE 'D'                  TO IDD-TENT(26).
           MOVE '372'                TO IDD-IENT(26).
           MOVE 'SEC'                TO IDD-SIST(27).
           MOVE 'C'                  TO IDD-GRPO(27).
           MOVE 'D'                  TO IDD-TENT(27).
           MOVE '341'                TO IDD-IENT(27).
           MOVE 'SUP'                TO IDD-SIST(28).
           MOVE 'M'                  TO IDD-GRPO(28).
           MOVE 'D'                  TO IDD-TENT(28).
           MOVE '230'                TO IDD-IENT(28).
           MOVE 'SUP'                TO IDD-SIST(29).
           MOVE 'C'                  TO IDD-GRPO(29).
           MOVE 'D'                  TO IDD-TENT(29).
           MOVE '230'                TO IDD-IENT(29).
           MOVE 'LDC'                TO IDD-SIST(30).
           MOVE 'M'                  TO IDD-GRPO(30).
           MOVE 'D'                  TO IDD-TENT(30).
           MOVE '260'                TO IDD-IENT(30).
           MOVE 'SEC'                TO IDD-SIST(31).
           MOVE 'M'                  TO IDD-GRPO(31).
           MOVE 'D'                  TO IDD-TENT(31).
           MOVE '341'                TO IDD-IENT(31).
           MOVE 'LDC'                TO IDD-SIST(32).
           MOVE 'C'                  TO IDD-GRPO(32).
           MOVE 'D'                  TO IDD-TENT(32).
           MOVE '200'                TO IDD-IENT(32).
           MOVE 'EFC'                TO IDD-SIST(33).
           MOVE 'M'                  TO IDD-GRPO(33).
           MOVE 'D'                  TO IDD-TENT(33).
           MOVE '700'                TO IDD-IENT(33).
           MOVE 'EFC'                TO IDD-SIST(34).
           MOVE 'C'                  TO IDD-GRPO(34).
           MOVE 'D'                  TO IDD-TENT(34).
           MOVE '701'                TO IDD-IENT(34).
      
       FIN-CARGA-IDD.
           EXIT.
