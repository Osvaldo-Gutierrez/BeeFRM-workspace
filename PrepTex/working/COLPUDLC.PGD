       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   COLPUDLC.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 31-dic-20 03:43 PM.

      * NOMBRE PROGRAMA                   COLPUDLC
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      COLDLC
      * PANTALLA                          COLDLC
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: SOLUCIONAR SC07 EN EJECUCION DE PROCESO COLODMOR
      *FECHA   : 05/06/2012
      *AUTOR   : ALD
      *ETIQUETA:*AFRI-INI 06-06-2012 ERROR SC07 AL EJECUTAR PROCESO
      *          COLODMOR
      *----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: AGREGAR CAMPO HPER Y VALIDACION
      *PROYECTO: Calculo impuestos
      *FECHA   : 09/10/2013
      *AUTOR   : OGB
      *ETIQUETA:*OGB-INI 09-OCT-2013 CALCULO IMPUESTOS
      *----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: No dejar 00000000 en fecha ultimo pago de intereses
      *PROYECTO: Correccion Comando MCA en Pantalla DLC
      *FECHA   : 21/01/2016
      *AUTOR   : Paulina Venegas
      *ETIQUETA:*PVC-INI 21-OCT-2016 Ult Pago Total Intereses
      *----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: Se solicita eliminar, en comando CEB, la validacion de
      *          fecha de ultimo pago de interes sea una fecha habil.
      *          Dado que el pago del interes en un dia inhabil no
      *          deberia impedir la impresion de las boletas.
      *
      *PROYECTO: Cambio en Comando CEB Boleta de Garantia para que no
      *          valide FUPI
      *FECHA   : 21/01/2016
      *AUTOR   : Richard Romero
      *ETIQUETA:*RRM-INI MAYO-2018 Cambio en Comando CEB
      *----------------------------------------------------------------

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-COLPUDLC-INI PIC X(125) VALUE
           '<IDNPGM NOM=$COLPUDLC$ SKL=$08.07.21$ VSN=${vsnpu}$
      -    'GEN=$31-dic-20 03:43 PM$ FNC=${fncpu}$/>'.
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
      *ISP DEBE QUEDAR PRIMERO QUE EL OTRO LABEL FIN_SCR_VARI
       COPY COLWGENG.
      *>>>>
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA3==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MICG                         PIC X(01).
      *AFRI-INI 06-06-2012 ERROR SC07 AL EJECUTAR PROCESO COLODMOR
       COPY COLBRDLC REPLACING ==DLC== BY ==DLC-BKP==.
      *AFRI-FIN 06-06-2012 ERROR SC07 AL EJECUTAR PROCESO COLODMOR
      *>>>>
       COPY COLWIDLC.
       COPY COLBRDLC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

      *<<<< WSS
      *AFRI-INI/NOV2005
           03 WSS-I                              PIC 9(02).
           03 WSS-EXT-CNAL                       PIC X(02).
      *AFRI-FIN/NOV2005
      *AFRI-INI/SEP2005
       01  WSS-MENS VALUE SPACES.
           03 WSS-MSG-COD-SIST                   PIC X(03).
           03 WSS-MSG-COD-MENS                   PIC X(12).
           03 WSS-MSG-COD-FIL1                   PIC X(01).
           03 WSS-DBC-NUM-ICLI                   PIC 9(11).
           03 WSS-MSG-COD-FIL2                   PIC X(01).
           03 WSS-DBC-VRF-ICLI                   PIC X(01).
           03 WSS-MSG-COD-FIL3                   PIC X(01).
           03 WSS-MSG-GLS-DESC                   PIC X(40).
           03 WSS-MSG-GLS-DATA                   PIC X(45).
      *AFRI-FIN/SEP2005
       01  WSS-VARI.
      *INI-AFRI/14082006
           03 WSS-VEC-DATA.
              05 WSS-FEC-FPRO                    PIC X(08).
              05 WSS-GLS-FPRO                    PIC X(52).
      *FIN-AFRI/14082006
      *INI-AFRI/NOV2005
           03  WSS-GLS-DATA.
               05  WSS-VEC-CNAL OCCURS 20 TIMES.
                   07 WSS-COD-CNAL                     PIC X(03).
      *FIN-AFRI/NOV2005

      *DAD ini 22-MAR-1991
           03  WSS-VAL-PESO                            PIC 9(11).
      *DAD fin 22-MAR-1991
           03  WSS-COD-PLAZ                            PIC X(04).
      *PTC ini
           03  WSS-COD-AUXI                            PIC X(24).
      *** RBG/INI/17-ABR-1997
            03  WSS-NUM-ICLI        VALUE 50000000      PIC 9(08).
      *** RBG/FIN/17-ABR-1997
      *PTC fin
      *ALD
           03  WSS-PTA-STR.
               05  WSS-PRGM                            PIC X(03).
               05  FILLER                VALUE '/'     PIC X(01).
               05  WSS-RIES                            PIC X(04).
               05  FILLER                VALUE '/'     PIC X(01).
               05  WSS-TOOC                            PIC X(03).
           03  PGM-STAT-POC             VALUE '23'     PIC X(02).
                 88 PGM-STAT-POC-OKS    VALUE '00'.
                 88 PGM-STAT-POC-NUL    VALUE '  '.
           03  BUS-POR-KEYS             VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE             VALUE 'C'    PIC X(01).
           03  WSS-ICOR                 VALUE 0      PIC 9(01).
               88 NO-ASIGNE-CORRELATIVO VALUE 0.
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-CIC-IOPC                       PIC X(12).
           03  WSS-UBFD.
               05  WSS-TAB-UBFD                   PIC X(03).
               05  WSS-COD-UBFD                   PIC X(12).
           03  WSS-FRDC              VALUE 0      PIC 9(01).
               88  WSS-HAY-RDC-FRM   VALUE 1.
           03  WSS-RRDC              VALUE 0      PIC 9(01).
               88  WSS-HAY-RDC-REG   VALUE 1.
           03  WSS-SRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-HAY               VALUE 1      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  PGM-STAT-NTR          VALUE '23'   PIC X(02).
               88 PGM-STAT-NTR-OKS   VALUE '00'.
               88 PGM-STAT-NTR-NUL   VALUE '  '.
           03  WSS-NUM-ICAN                       PIC 9(03).
           03  WSS-COD-PLZA.
               05 WSS-IND-OFIC                    PIC X(01).
               05 WSS-COD-OFIC                    PIC X(03).
           03  WSS-COD-ESTP.
               05 WSS-IND-ESTA                    PIC X(03).
               05 WSS-IND-ETAP                    PIC X(03).
           03  WSS-COD-ESTP.
               05 WSS-IND-ESTA-DLC                PIC X(03).
               05 WSS-IND-ETAP-DLC                PIC X(03).
      *OGB-INI/VALIDACION IND HPER/SEP-2013
           03  WSS-COD-DATA.
               05 WSS-IND-ICUR                    PIC X(01).
               05 WSS-IND-IREN                    PIC X(01).
               05 WSS-IND-IPRO                    PIC X(01).
               05 FILLER                          PIC X(57).
           03  WSS-IND-RENO                       PIC X(03).
           03  WSS-GLS-CTES.
               05 WSS-IND-SCOL       VALUE 'COL'      PIC X(03).
               05 WSS-GLS-HPR        VALUE 'HPR'      PIC X(03).
               05 WSS-IND-N          VALUE 'N'        PIC X(01).
               05 WSS-IND-S          VALUE 'S'        PIC X(01).
               05 WSS-GLS-NCUR   VALUE 'HPERNOCURSE ' PIC X(12).
               05 WSS-GLS-NREN   VALUE 'HPERNORENOVA' PIC X(12).
               05 WSS-GLS-NPRO   VALUE 'HPERNOPRORRO' PIC X(12).
               05 WSS-COD-RENO   VALUE 'REN'          PIC X(03).
               05 WSS-COD-PROR   VALUE 'PRO'          PIC X(03).
      *OGB-FIN/VALIDACION IND HPER/SEP-2013
      *AFRI-INI 06-06-2012 ERROR SC07 AL EJECUTAR PROCESO COLODMOR
      *01  DLC-BKP                                PIC X(218).
      *AFRI-FIN 06-06-2012 ERROR SC07 AL EJECUTAR PROCESO COLODMOR
       COPY SGCBRDCP.
       COPY SGCBRDBC.
       COPY COLBROPC.
       COPY COLBRROV.
       COPY COLBRCAN.
       COPY COLBRRDC.
       COPY SGCBRRCD.
       COPY COLBRICG.
       COPY TABBRTIO.
       COPY TABBRCAM.
       COPY COLBRNTR.
      *AFRI-INI/JUN2008 (MAE)
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
       COPY COLBRCCB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCB-REQA==.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
       COPY COLWGMED.
      *AFRI-FIN/JUN2008 (MAE)
      * COPY GNSWGQUE.
      * COPY GNSWGHOY.
      * COPY GNSWGTSK.
      * COPY GNSWGFEC.

      *PTC ini
       COPY COLMXW05.
      *PTC fin
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY COLBRTOC.
      *INI-FPM-AFRI
      * COPY COLPPRDC.
       COPY COLWGRDC.
      *FIN-FPM-AFRI
      *ALD
       COPY COLBRPOC.
       COPY COLBRDCC.
      *>>>>
      *********************************************
      *           MODULO   USPC113                *
      *********************************************
      *       DEFINICION IDENTIFICACION TS        *
      *********************************************

       01  UIB.
           02  FILLER                  PIC X(32) VALUE 'USPR002'.
       01  USP-LARGO-TS                PIC S9(4) COMP VALUE +150.
       01  USP-IDENTIFICACION.
           05  USP-TERMINAL            PIC X(04).
           05  USP-OPID-USU            PIC X(03).
           05  FILLER                  PIC X(01)  VALUE ' '.
       01  USP-LLENA-VECTOR            PIC X(1)   VALUE ' '.
       01  USP-USA-VECTOR              PIC X(1)   VALUE ' '.

      *********************************************
      *       DEFINICION AREA DE TRASPASO         *
      *********************************************

       01  AREA-TRASPASO.
           05  USP-PERMISO             PIC X(01).
           05  USP-PTA-NUM             PIC 9(03)  VALUE 0.
           05  USP-PTA-STR             PIC X(12)  VALUE SPACES.
           05  USP-AREA-COMUN.
               10  USP-TIPO-USUARIO.
                   15  USP-IDENT-TU    PIC X(03).
      *                TIPO DE USUARIO

                   15  USP-MODO-OP     PIC X(01).
      *                MODO OPERACION (CONSULTA/ACTUALIZACION)

               10  USP-SISTEMA.
                   15  USP-IDENT-SIS   PIC X(03).
      *                IDENTIFICACION DEL SISTEMA QUE SE ESTA PROCE_
      *                SANDO SEGUN USUARIOS Y PRIVILEGIOS

                   15  USP-GRUPO       PIC X(03).
      *                IDENTIFICACION DEL GRUPO DE SISTEMA QUE SE ESTA
      *                PROCESANDO SEGUN USUARIOS Y PRIVILEGIOS
      *

               10  USP-INDIC-PROCESO   PIC X(01).
      *            INDICADOR DE SISTEMA USUARIO Y PRIVILEGIO  ACTIVO

               10  USP-COD-OFICINA     PIC X(03).
      *            CODIGO DE LA OFICINA DEL USUARIO

               10  USP-COD-DEPTO       PIC X(03).
      *            CODIGO DEL DEPTO DEL USUARIO

               10  USP-COD-USUARIO     PIC X(12).
      *            CODIGO USUARIO (TABLA USR)

               10  USP-COD-TERMINAL    PIC X(04).
      *            CODIGO DE TERMINAL

               10  USP-OPID            PIC X(03).
      *            OPID DE USUARIO

               10  USP-FECHA.
      *            FECHA
                   15  USP-ANO         PIC X(02).
                   15  USP-MES         PIC X(02).
                   15  USP-DIA         PIC X(02).

               10  USP-HORA            PIC X(06).
      *            HORA

               10  USP-PASSWORD        PIC X(08).
      *            PASSWORD DE USUARIO(SOLO PARA CONECCION VIA RUTINA)

               10  USP-INDICADORES.
                   15  USP-USU-CMN1    PIC X(01).
      *            1   */CON       CONSULTA
      *            2   */MAN       CONSULTA Y MANTENCION
      *            3   */*         TODO
      *
                   15  USP-USU-CMN2    PIC X(01).
      *            P   *           PERMISO AL MENU
      *
                   15  USP-USU-CMN3    PIC X(01).
      *            P   */OFI       OTRAS OFICINAS
      *
                   15  USP-USU-CMN4    PIC X(01).
                   15  USP-USU-CMN5    PIC X(01).
                   15  USP-USU-CMN6    PIC X(01).
                   15  USP-USU-CMN7    PIC X(01).
                   15  USP-USU-CMN8    PIC X(01).
                   15  USP-USU-CMN9    PIC X(01).
                   15  USP-USU-CMN10   PIC X(01).
                   15  USP-USU-CMN11   PIC X(01).
                   15  USP-USU-CMN12   PIC X(01).
                   15  USP-USU-CMN13   PIC X(01).
                   15  USP-USU-CMN14   PIC X(01).
                   15  USP-USU-CMN15   PIC X(01).
                   15  USP-USU-CMN16   PIC X(01).
               10  USP-INDICADORES-RED REDEFINES USP-INDICADORES.
                   15  USP-USU-CMN-ARR OCCURS 16 TIMES   PIC X(01).
      *
      *            INDICADORES QUE  INDICAN PRIVILEGIO DE USUARIOS
      *
               10  FILLER              PIC X(78).
      *            DISPONIBLE USO FUTURO
      *
      *********************************************
      *     AREAS PARA LECTURA DE TABLA "STR"     *
      *********************************************
      *
      *01  COPYDD USP-R-STR.USP-E-STR01(PROD).
       01  USP-E-STR01.
           02  USP-CLV-STR-1.
               03  USP-COD-GST     PICTURE X(3).
               03  USP-COD-STR     PICTURE X(12).
           02  USP-COD-PTA         PICTURE X(3).
      *
       01  REQ-AREA.
               05  COD-CMND            PIC X(005).
               05  NOM-TABL            PIC X(003).
               05  NOM-CLAV            PIC X(005).
               05  RET-CODI            PIC X(002).
               05  RET-INTE            PIC X(001).
               05  NUM-BASE            PIC S9(004) COMP VALUE +120.
               05  NOM-REGI            PIC X(007).
               05  FILLER              PIC X(025).
               05  MAX-CONT            PIC S9(004) COMP.
               05  NOM-CONT            PIC S9(004) COMP.
               05  FILLER              PIC X(022).
               05  VAL-CLAV.
                   10  FECHA           PIC 9(008).
                   10  HORA            PIC 9(006).
      *
       01  ELEM-LIST.
               05  NOM-ELEM            PIC X(011).
               05  SEC-CODI            PIC X(001).
               05  FILLER              PIC X(005) VALUE SPACES.
      *
       01  REQ-AREA-STR.
               05  COD-CMND-STR        PIC X(005).
               05  NOM-TABL-STR        PIC X(003).
               05  NOM-CLAV-STR        PIC X(005).
               05  RET-CODI-STR        PIC X(002).
               05  RET-INTE-STR        PIC X(001).
               05  NUM-BASE-STR        PIC S9(004) COMP VALUE +120.
               05  NOM-REGI-STR        PIC X(007).
               05  FILLER              PIC X(025).
               05  MAX-CONT-STR        PIC S9(004) COMP.
               05  NOM-CONT-STR        PIC S9(004) COMP.
               05  FILLER              PIC X(022).
               05  VAL-CLAV-STR.
                   10  USP-COD-GST     PIC X(003).
                   10  USP-COD-STR     PIC X(012).
      *
       01  ELEM-LIST-STR.
               05  NOM-ELEM-STR        PIC X(011).
               05  SEC-CODI-STR        PIC X(001).
               05  FILLER              PIC X(005) VALUE SPACES.
      *
      *********************************************
      *           FIN   MODULO   USPC113          *
      *********************************************

      *>>>>
      *<<<< WSS
       COPY COLWGPMP.
      *<<<< INI-AFRI-IMPP/DIC2005
       COPY COLBRCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
      *>>>> FIN-AFRI-IMPP/DIC2005
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-NTR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DLC.
                 88 PGM-STAT-DLC-NUL    VALUE '  '.
                 07 PGM-STT1-DLC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DLC-OKS VALUE '0'.
                 07 PGM-STT2-DLC        VALUE '3' PIC X(01).
              05 PGM-STAT-ICG.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
                 07 PGM-STT1-ICG        VALUE '2' PIC X(01).
                    88 PGM-STAT-ICG-OKS VALUE '0'.
                 07 PGM-STT2-ICG        VALUE '3' PIC X(01).
              05 PGM-STAT-RDC.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RDC-OKS VALUE '0'.
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO DLC-FLD.
           MOVE LOW-VALUES TO DLC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'COLPUDLC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
      *PTC ini
      *REL INI 30-11-2001
      *     MOVE SPACES TO SCR-KEY-IRDC.
      *REL FIN 30-11-2001
      *PTC fin
      *DAD ini  28-OCT-1992
           IF SCR-CMND NOT = 'MCA'
               GO TO CON-INI-FIO.
      **********************************
      *            MODULO  USPC143     *
      **********************************
       USP-CHEQUEO-TS.
           EXEC CICS HANDLE CONDITION
                              QIDERR(USP-IR-MENU-GENERAL)
           END-EXEC.
           EXEC CICS ASSIGN OPID(USP-OPID-USU)
           END-EXEC.
           MOVE EIBTRMID   TO USP-TERMINAL.
           EXEC CICS READQ TS QUEUE(USP-IDENTIFICACION)
                              INTO(USP-AREA-COMUN)
                              LENGTH(USP-LARGO-TS)
                              ITEM(+1)
           END-EXEC.
           GO TO USP-INICIO-PROGRAMA.
       USP-IR-MENU-GENERAL.
           EXEC CICS XCTL PROGRAM('USDP930')
           END-EXEC.
       USP-INICIO-PROGRAMA.
      ***************************************
      *            FIN  MODULO  USPC143     *
      ***************************************
      *
       CON-INI-FIO.
      *DAD fin  28-OCT-1992
       FIN-INI-FIO.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-DLC.
           PERFORM EDT-KEY-DLC.
           PERFORM EDT-FLD-DLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
      *<<<< PFS_SCR_MOD
      *>>>>
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-DLC
               PERFORM EDT-KEY-DLC
               PERFORM EDT-FLD-DLC
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-DLC
               PERFORM EDT-KEY-DLC
           ELSE
               PERFORM CLR-FLD-DLC
               PERFORM EDT-FLD-DLC.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO DLC-FLD.
           MOVE LOW-VALUES TO DLC-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
           IF SCR-CMND = 'CEB'
               PERFORM KEY-ALL-DLC
               PERFORM CMN-CEB
               GO TO FIN-CMN-MOD.
           PERFORM GET-UPD-RDC.
      *>>>>
      *<<<< INI_CMN_MOD
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
      *    MOVE SYS-TSTP TO DLC-STP-IINV IN DLC.
      *>>>>
           PERFORM KEY-ALL-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-STT-DLC.
           PERFORM RET-ALL-DLC.
           PERFORM RET-HDR-DLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< INI-AFRI-IMPP/DIC2005
            PERFORM MOD-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *>>>> FIN-AFRI-IMPP/DIC2005
           IF SCR-CMND = 'MCA'
               GO TO FIN-CMN-MOD.
           PERFORM MOD-ICG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *>>>>
           MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
      *PVG INI 25-AGO-2006
               IF SCR-CMND = 'MCL'
                  MOVE 'I'     TO OPC-MSC-STAT IN OPC
                  MOVE FIO-MOD TO FIO-CMND
                  PERFORM COL-FIO-OPC
               ELSE
      *PVG FIN 25-AGO-2006
      *>>>>
      *<<<< FIN_CMN_MOD
      *     MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC.
      *     MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC.
      *     MOVE FIO-GET-KEY-UPD TO FIO-CMND.
      *     PERFORM COL-FIO-OPC.
      *     IF FIO-STAT-OKS
      *ALD-BCI-INI/26.08.1999
      *         PERFORM GET-FHOY
      *         MOVE HOY-STP-ITRN TO OPC-STP-ITRN IN OPC
      *ALD-BCI-INI/26.08.1999
                MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO DLC.
      *<<<< INI_CMN_ING
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE ZEROES TO DLC-FEC-FTRN IN DLC.
           MOVE ZEROES TO DLC-HRA-HRTR IN DLC.
           MOVE ZEROES TO DLC-VAL-NDLC IN DLC.
           MOVE ZEROES TO DLC-VAL-SDLC IN DLC.
           MOVE ZEROES TO DLC-VAL-IMPU IN DLC.
           MOVE ZEROES TO DLC-VAL-GNOT IN DLC.
           MOVE ZEROES TO DLC-VAL-READ IN DLC.
           MOVE ZEROES TO DLC-VAL-INTD IN DLC.
           MOVE ZEROES TO DLC-FEC-FDEV IN DLC.
           MOVE ZEROES TO DLC-VAL-SINT IN DLC.
           MOVE ZEROES TO DLC-VAL-SCPA IN DLC.
           MOVE ZEROES TO DLC-FEC-FAMT IN DLC.
           MOVE ZEROES TO DLC-NUM-IDLO IN DLC.
           MOVE ZEROES TO DLC-VAL-IPEN IN DLC.
           MOVE ZEROES TO DLC-VAL-DPES IN DLC.
           MOVE ZEROES TO DLC-FEC-FMAV IN DLC.
           MOVE ZEROES TO DLC-NUM-VSCE IN DLC.
           MOVE ZEROES TO DLC-FEC-FSDE IN DLC.
           MOVE ZEROES TO DLC-VAL-PIMP IN DLC.
           MOVE ZEROES TO DLC-FEC-FSDM IN DLC.
      *AFRI-INI/NOV2008 (MAE)
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO DLC-STP-ITRN IN DLC.
      *AFRI-FIN/NOV2008 (MAE)
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
      *    MOVE SYS-TSTP TO DLC-STP-IINV IN DLC.
      *>>>>
           PERFORM RET-STT-DLC.
           PERFORM RET-ALL-DLC.
           PERFORM RET-HDR-DLC.
      *<<<< CMN_ING
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM VAL-VCAM.
           MOVE SPACES              TO DLC-GLS-FLAG IN DLC.
           MOVE ZEROES              TO DLC-VAL-SINT IN DLC.
           MOVE OPC-FEC-FCOL IN OPC TO DLC-FEC-FAMT IN DLC.
           MOVE DLC-VAL-SDLC IN DLC TO DLC-VAL-SCPA IN DLC.
      *    MOVE DLC-KEY-IDLC IN DLC TO DLC-KEY-IDLO IN DLC.
           MOVE SPACES              TO DLC-GLS-DISP IN DLC.
           MOVE DLC-IND-ETAP IN DLC-FLD  TO DLC-IND-ETAP IN DLC.
           MOVE DLC-IND-ESTA IN DLC-FLD  TO DLC-IND-ESTA IN DLC.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           PERFORM PUT-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.

           PERFORM PUT-ICG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.

      *>>>>
      *<<<< FIN_CMN_ING
      *<<<< INI-AFRI-IMPP/DIC2005
           PERFORM PUT-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
      *>>>> FIN-AFRI-IMPP/DIC2005

      * INI-FPM-AFRI ( 30-03-2004)
           PERFORM PUT-RDC-AVL.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
      * FIN-FPM-AFRI ( 30-03-2004)
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
               MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC
               MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   MOVE 'M' TO OPC-MSC-STAT IN OPC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-OPC.
      *>>>>
      *<<<< FIN_CMN_ING
      * ESTE PROGRAMA PUEDE SER UN PUNTO DE ENTRADA AL ENGANCHE
      * ADEMAS ENGANCHA SIEMPRE HACIA ADELANTE
           PERFORM SET-ENG.
           PERFORM EGR-FPEN-CIC.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-DLC.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< CMN_ELI
           PERFORM GET-UPD-RDC.
      *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-DLC.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           PERFORM DEL-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< INI-AFRI-IMPP/DIC2005
           PERFORM DEL-CXE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *>>>> FIN-AFRI-IMPP/DIC2005
      *DAD ini  08-JAN-1993
           MOVE DLC-CAI-IOPC IN DLC TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *DAD fin  08-JAN-1993
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-DLC.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE DLC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO DLC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF6 OR
                            FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-DLC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DLC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-DLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DLC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-DLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DLC
               PERFORM EDT-FLD-DLC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *<<<< SCR_GFLD_VAL_MKY
      * ESTE PROGRAMA PUEDE SER UN PUNTO DE ENTRADA AL ENGANCHE
           IF FRM-FFLD = FRM-FFLD-PF10 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
      *RRM-INI IGUALACION C. AD.
      **HPM ini
      *        IF FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
      *           FRM-IND-VSTR IN DLC-FLD = 'N'
      *            PERFORM EGR-FTER-CIC
      *        ELSE
      **HPM fin
      *RRM-FIN IGUALACION C. AD.
                   MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
                   MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   PERFORM SET-ENG
                   PERFORM EGR-FPEN-CIC.
      *>>>>
           PERFORM VAL-MKY-DLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
      *<<<< SCR_GFLD_VAL_FLD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
           PERFORM GET-FHOY.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *>>>>
           PERFORM VAL-FLD-DLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-DLC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-DLC.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-DLC.
           PERFORM EDT-FLD-DLC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S' AND
              SCR-IND-OOD = 'O'
               PERFORM EGR-FTER-CIC.
      *>>>>
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DLC-GLS-MEN2
               MOVE SCR-PRMT     TO DLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DLC-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DLC-GLS-MEN2
               MOVE SCR-PRMT     TO DLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DLC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO DLC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE DLC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DLC-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-DLC

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO DLC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO DLC-GLS-MENS.
           PERFORM PRO-FLD-DLC.
           PERFORM PRO-MKY-DLC.
           PERFORM UNP-IKY-DLC.
           PERFORM FST-KEY-DLC.
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-DLC.
      *>>>>
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE DLC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DLC-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO DLC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO DLC-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-DLC.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-DLC.
           PERFORM FST-KEY-DLC.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
      *<<<< INI_HBL_FLD
           PERFORM UNP-MKY-DLC.
           PERFORM UNP-FLD-DLC.
           PERFORM FST-FLD-DLC.
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'CEB'
               MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-TDOC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-UBFD-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-MSC-TIMP-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-IMPU-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-PLZA-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-NOTC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-GNOT-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-MSC-MIPL-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-SCRT-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-SCTB-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-SCBZ-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-PAGO-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-NDLC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-SDLC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-IPEN-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-READ-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-VAL-INTD-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-PLZO-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-MIPL-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-FEC-FDEV-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-PIMP-ATR IN DLC-FLD
               MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
               MOVE -1           TO DLC-IND-ESTA-LEN IN DLC-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO DLC-IND-ESTA-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-ETAP-ATR IN DLC-FLD.

      *JCT-INI 11-MAR-2010 COL: Seguros Vinculados ACA no Estructurados
           IF SCR-CMND = 'MCL'
              MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-COD-TDOC-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-COD-UBFD-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-MSC-TIMP-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-IMPU-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-COD-PLZA-ATR IN DLC-FLD
              MOVE FRM-CPIM-UBY TO DLC-COD-NOTC-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-GNOT-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-MSC-MIPL-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-SCRT-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-SCTB-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-SCBZ-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-COD-PAGO-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-NDLC-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-SDLC-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-IPEN-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-READ-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-VAL-INTD-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-COD-PLZO-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-GLS-MIPL-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-FEC-FDEV-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-NUM-PIMP-ATR IN DLC-FLD

              MOVE FRM-CPIM-AEY TO FRM-GLS-PAGO-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-IND-PIMP-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-GLS-PIMP-ATR IN DLC-FLD

              MOVE -1           TO DLC-COD-NOTC-LEN IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-ESTA-ATR IN DLC-FLD
              MOVE FRM-CPIM-AEY TO DLC-IND-ETAP-ATR IN DLC-FLD.
      *JCT-FIN 11-MAR-2010

           IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
           IF FRM-GLS-TINT IN DLC-FLD = 'M' AND
              SCR-IND-MICG NOT = SPACES
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC NOT = 'D'
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD.
      *ISP PROTEGE CAMPOS EN FORMA PARAMETRICA.
           MOVE SPACES TO TAB-IND-VIGE IN TAB.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    PCDLC' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
                  TAB-IND-VIGE IN TAB = 'N'
      *DAD ini  08-JAN-1993   (Memo.16-10-92)
               MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLC-FLD
      *DAD fin  08-JAN-1993
      *ISP  28-MAR-1991 DESPROTEGE CAMPO SOL. BCI DEL 27/03/1991
      *         MOVE FRM-CPIM-AEY TO DLC-COD-NOTC-ATR IN DLC-FLD
      *         MOVE FRM-CPIM-AEY TO DLC-VAL-GNOT-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-COD-UBFD-ATR IN DLC-FLD.
      *ALD
           IF SCR-CMND NOT = 'MCA'
      *INI-AFRI/PDM-JUL-2006
               IF OPC-IND-RENO IN OPC = 'PRO'
                   MOVE FRM-CPIM-AEY TO DLC-MSC-TIMP-ATR IN DLC-FLD
                   MOVE FRM-CPIM-AEY TO FRM-GLS-MIPL-ATR IN DLC-FLD
                   MOVE FRM-CPIM-AEY TO FRM-NUM-PIMP-ATR IN DLC-FLD
                   MOVE FRM-CPIM-AEY TO FRM-IND-PIMP-ATR IN DLC-FLD
                   GO TO CON-HBL-MCA
               ELSE
               GO TO CON-HBL-MCA.
      *FIN-AFRI/PDM-JUL-2006
           PERFORM PRO-FLD-DLC.
           PERFORM PRO-MKY-DLC.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCIANTHABDLC' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB = 'N'
               MOVE FRM-CPIM-UBY TO FRM-NUM-PIMP-ATR IN DLC-FLD
               MOVE FRM-CPIM-UBY TO DLC-VAL-IMPU-ATR IN DLC-FLD
               MOVE FRM-CPIM-UBY TO DLC-MSC-TIMP-ATR IN DLC-FLD
               MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
               MOVE -1           TO DLC-MSC-TIMP-LEN IN DLC-FLD
               GO TO CON-HBL-MCA.
      *
           MOVE FRM-CPIM-UBY TO FRM-NUM-PIMP-ATR IN DLC-FLD
           MOVE FRM-CPIM-UBY TO DLC-VAL-IMPU-ATR IN DLC-FLD.
           MOVE FRM-CPIM-UBY TO DLC-MSC-TIMP-ATR IN DLC-FLD
           MOVE FRM-CPIM-UBY TO DLC-IND-RIES-ATR IN DLC-FLD.
           MOVE FRM-CPIM-UBY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
           MOVE OPC-COD-TOOC IN OPC TO TIO-COD-TIOP IN TIO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-TIO.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO TIO-GLS-SIST IN TIO.
           MOVE 'DLC'               TO WSS-PRGM IN WSS-VARI.
           MOVE 'RIES'              TO WSS-RIES IN WSS-VARI.
           MOVE TIO-GLS-SIST IN TIO TO WSS-TOOC IN WSS-VARI.
           MOVE WSS-PTA-STR IN WSS-VARI TO USP-PTA-STR.
      ****************************************
      *             MODULO  USPC103          *
      ****************************************
           IF USP-PTA-STR = '*/*         ' THEN
            IF USP-USU-CMN-ARR(1) = '3' THEN
               MOVE 'P' TO USP-PERMISO
            ELSE
               MOVE 'N' TO USP-PERMISO
           ELSE
            IF USP-PTA-STR = '*/MAN       ' THEN
             IF USP-USU-CMN-ARR(1) NOT < '2' THEN
               MOVE 'P' TO USP-PERMISO
             ELSE
               MOVE 'N' TO USP-PERMISO
            ELSE
             IF USP-PTA-STR = '*/CON       ' THEN
              IF USP-USU-CMN-ARR(1) NOT < '1' THEN
                 MOVE 'P' TO USP-PERMISO
              ELSE
                 MOVE 'N' TO USP-PERMISO
             ELSE
              IF USP-PTA-STR = '*           ' THEN
                 MOVE USP-USU-CMN-ARR(2) TO USP-PERMISO
              ELSE
               IF USP-PTA-STR = '*/OFI       ' THEN
                 MOVE USP-USU-CMN-ARR(3) TO USP-PERMISO
               ELSE
                 MOVE 'S' TO USP-USA-VECTOR.
           IF USP-LLENA-VECTOR = 'S' OR USP-USA-VECTOR = 'S' THEN
            IF  USP-PTA-NUM = ZEROS
            THEN MOVE  USP-PTA-STR   TO   USP-COD-STR IN USP-E-STR01
             MOVE  USP-PTA-STR   TO   USP-COD-STR IN REQ-AREA-STR
             MOVE  USP-GRUPO     TO   USP-COD-GST IN USP-E-STR01
             MOVE  USP-GRUPO     TO   USP-COD-GST IN REQ-AREA-STR
             MOVE  'REDKY'       TO   COD-CMND-STR
             MOVE  'STR01'       TO   NOM-CLAV-STR  NOM-ELEM-STR
             MOVE  'STR'         TO   NOM-TABL-STR
             CALL 'DBNTRY' USING UIB REQ-AREA-STR USP-E-STR01
                                ELEM-LIST-STR
             IF RET-CODI-STR NOT = SPACES
                   MOVE  ' ' TO   USP-PERMISO
             ELSE
                   MOVE USP-COD-PTA IN USP-E-STR01 TO   USP-PTA-NUM
                   EXEC CICS LINK PROGRAM ('USDR100')
                                COMMAREA (AREA-TRASPASO)
                                LENGTH (166)
                   END-EXEC
            ELSE
                   EXEC CICS LINK PROGRAM ('USDR100')
                                  COMMAREA (AREA-TRASPASO)
                                  LENGTH (166)
                   END-EXEC.
           MOVE  ZEROS  TO  USP-PTA-NUM.
           MOVE  SPACES TO  USP-PTA-STR.
           MOVE  SPACES TO  USP-USA-VECTOR.
      *
      *
      ****************************************
      *          FIN   MODULO  USPC103       *
      ****************************************
           IF USP-PERMISO NOT = 'P'
               MOVE FRM-CPIM-AEY TO DLC-IND-RIES-ATR IN DLC-FLD
               IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD
               ELSE
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN DLC-FLD
           ELSE
               IF DBC-IND-ICLI IN DLC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD
               ELSE
                   MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN DLC-FLD.
       CON-HBL-MCA.
           IF ( SCR-CCPP = 'ING' ) OR
              ( SCR-CCPP = 'ACT' AND ( NOT PGM-STAT-DLC-OKS ) )
               NEXT SENTENCE
           ELSE
      *     IF SCR-CCPP NOT = 'ING'
               GO TO FIN-HBL-FLD.
           PERFORM PRO-DLC-ROV.
           IF NOT PGM-STAT-POC-OKS
               MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC
               MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   GO TO FIN-HBL-FLD
               ELSE
                   MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
                   MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
                   MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
                   MOVE ZEROES              TO POC-NUM-IPOC IN POC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-POC
                   IF NOT FIO-STAT-OKS
                       GO TO FIN-HBL-FLD.
           IF POC-COD-TDOC IN POC > SPACES
      *INI-AFRI/JULIO-2006
               MOVE POC-COD-TDOC IN POC TO DLC-COD-TDOC IN DLC-FLD.
      *        MOVE FRM-CPIM-AEY TO DLC-COD-TDOC-ATR IN DLC-FLD.
      *FIN-AFRI/JULIO-2006
           IF POC-MSC-MIPL IN POC > SPACES
               MOVE POC-MSC-MIPL IN POC TO DLC-MSC-MIPL IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-MSC-MIPL-ATR IN DLC-FLD.
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO DLC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-DLC.
           PERFORM PRO-FLD-DLC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DLC
               PERFORM EDT-FLD-DLC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DLC
               PERFORM EDT-FLD-DLC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-DLC.
           PERFORM EDT-FLD-DLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-DLC.
           PERFORM PRO-FLD-DLC.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-DLC
               PERFORM EDT-FLD-DLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DLC-GLS-MEN2
               MOVE SCR-CONF     TO DLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DLC-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-DLC
               PERFORM VAL-NUM-FLD-DLC
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-DLC
                   PERFORM VAL-NUM-FLD-DLC
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S' AND
              SCR-IND-OOD = 'O'
               PERFORM EGR-FTER-CIC.
      *>>>>
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       RET-STT-DLC SECTION.
       INI-RET-STT-DLC.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DLC-MSC-TACC IN DLC
               MOVE 'I' TO DLC-MSC-STAT IN DLC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DLC-MSC-TACC IN DLC
               MOVE 'M' TO DLC-MSC-STAT IN DLC.
       FIN-RET-STT-DLC.
           EXIT.

       RET-HDR-DLC SECTION.
       INI-RET-HDR-DLC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DLC-FEC-FTRN IN DLC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DLC-HRA-HRTR IN DLC.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO DLC-COD-OTRN IN DLC.
      *    Autor Transaccion
           MOVE SCR-USER TO DLC-COD-ATRN IN DLC.
      *>>>>
       FIN-RET-HDR-DLC.
           EXIT.

       COPY COLBUDLC.
       COPY GNSBVNUM.
       COPY COLBFDLC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       PRO-DLC-ROV SECTION.
       INI-PRO-DLC-ROV.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO DLC-CAI-IOCO IN DLC-FLD.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO DLC-IIC-IOCO IN DLC-FLD.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLO IN DLC-FLD.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES                  TO ROV-CAI-IOPV IN ROV.
           MOVE SPACES                  TO ROV-IIC-IOPV IN ROV.
           MOVE ZEROES                  TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
              ROV-CAI-IOPC IN ROV = DLC-CAI-IOPC IN DLC-FLD AND
              ROV-IIC-IOPC IN ROV = DLC-IIC-IOPC IN DLC-FLD )
               GO TO FIN-PRO-DLC-ROV.
           MOVE ROV-CAI-IOPV IN ROV TO CAN-CAI-IOPC IN CAN.
           MOVE ROV-IIC-IOPV IN ROV TO CAN-IIC-IOPC IN CAN.
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
           IF CAN-MSC-TCAN IN CAN NOT = 'P'
               GO TO FIN-PRO-DLC-ROV.
           MOVE ROV-CAI-IOPV IN ROV     TO DLC-CAI-IOPC IN DLC.
           MOVE ROV-IIC-IOPV IN ROV     TO DLC-IIC-IOPC IN DLC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
      *     MOVE DLC-CAI-IOCO IN DLC TO DLC-CAI-IOCO IN DLC-FLD.
      *     MOVE DLC-IIC-IOCO IN DLC TO DLC-IIC-IOCO IN DLC-FLD.
      *     MOVE DLC-NUM-IDLO IN DLC TO DLC-NUM-IDLO IN DLC-FLD.
           MOVE SPACES               TO DLC-CAI-IOCO IN DLC-FLD.
           MOVE SPACES               TO DLC-IIC-IOCO IN DLC-FLD.
           MOVE ZEROS                TO DLC-NUM-IDLO IN DLC-FLD.
      *
           MOVE DLC-MSC-TIMP IN DLC TO DLC-MSC-TIMP IN DLC-FLD.
           MOVE DLC-COD-NOTC IN DLC TO DLC-COD-NOTC IN DLC-FLD.
           MOVE DLC-VAL-GNOT IN DLC TO DLC-VAL-GNOT IN DLC-FLD.
           MOVE DLC-VAL-IPEN IN DLC TO DLC-VAL-IPEN IN DLC-FLD.
           MOVE DLC-COD-UBFD IN DLC TO DLC-COD-UBFD IN DLC-FLD.
           MOVE DLC-COD-PLZA IN DLC TO DLC-COD-PLZA IN DLC-FLD.

           MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *HPM ini Compatibilidad VSAM DATACOM
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *HPM fin
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
      *HPM ini
           IF NOT ( RDC-CAI-IOPC IN RDC = DLC-CAI-IOPC IN DLC AND
                    RDC-IIC-IOPC IN RDC = DLC-IIC-IOPC IN DLC AND
                    RDC-NUM-IDLC IN RDC = DLC-NUM-IDLC IN DLC )
               MOVE '23' TO FIO-STAT
               GO TO FIN-PRO-DLC-ROV.
      *HPM fin
      *PVG INI 23-09-2001
      *     IF NOT ( DLC-CAI-IOPC IN DLC = RDC-CAI-IOPC IN RDC AND
      *              DLC-IIC-IOPC IN DLC = RDC-IIC-IOPC IN RDC AND
      *              DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC )
      *         MOVE '23' TO FIO-STAT
      *         GO TO FIN-PRO-DLC-ROV.
      *PVG FIN 24-09-2001
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'DLC    MDIND' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE 'M'          TO DBC-IND-ICLI IN DLC-FLD
                MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
                GO TO AEY-PRO-DLC-ROV
           ELSE
               MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC
               MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC
               MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RDC.
           MOVE RDC-NUM-DIRE IN RDC TO RDC-NUM-DIRE IN DLC-FLD.
           MOVE RDC-CAI-ICLI IN RDC TO RDC-CAI-ICLI IN DLC-FLD.
           MOVE RDC-IIC-ICLI IN RDC TO RDC-IIC-ICLI IN DLC-FLD.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-DLC-ROV.
           MOVE '00' TO PGM-STAT-DBC.
           PERFORM PUT-DBC-DLC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD.
       AEY-PRO-DLC-ROV.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN DLC-FLD
           MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN DLC-FLD.
           MOVE  0           TO DBC-NUM-ICLI-LEN IN DLC-FLD.
           MOVE -1           TO DLC-IND-RIES-LEN IN DLC-FLD.
       FIN-PRO-DLC-ROV.
           EXIT.
       VAL-VCAM SECTION.
       INI-VAL-VCAM.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTVALCICNX' TO MSG-COD-MENS
               MOVE MSC-CIC-TABL   TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-VCAM.
      *Si es moneda extranjera ...
           IF OPC-MSC-TVOC IN OPC NOT = MSC-COD-CMSC IN MSC
               MOVE DLC-VAL-NDLC IN DLC-FLD TO DLC-VAL-DPES IN DLC
               GO TO FIN-VAL-VCAM.
      *Si es moneda nacional ...
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-COD-CTAB NOT = OPC-COD-VCOC IN OPC
                   PERFORM BUS-FVAL-CAM
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-VAL-VCAM
                   ELSE
                       MOVE OPC-COD-VCOC TO CAM-COD-VCAM IN CAM(1)
                       MOVE TAB-COD-CTAB TO CAM-COD-VCAM IN CAM(2)
                       MOVE FIO-GET-KEY  TO FIO-CMND
                       PERFORM TAB-FIO-CAM
                       IF NOT FIO-STAT-OKS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'CODVCAMNEX' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       ELSE
                       IF CAM-IND-VIGE IN CAM = 'N'
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'CODVCAMNVG' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       ELSE
                           MULTIPLY CAM-SGV-VCAM IN CAM
                           BY       DLC-VAL-NDLC IN DLC-FLD
                           GIVING   DLC-VAL-DPES IN DLC
               ELSE
                   MOVE DLC-VAL-NDLC IN DLC-FLD TO
                        DLC-VAL-DPES IN DLC
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
       FIN-VAL-VCAM.
           EXIT.

       BUS-FVAL-CAM SECTION.
       INI-BUS-FVAL-CAM.
           MOVE SPACES TO MSG-COD-MENS.
           IF OPC-IND-RENO NOT = 'PRO'
               MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(2)
               GO TO FIN-BUS-FVAL-CAM.
      *
           MOVE OPC-CIC-IOPC TO WSS-CIC-IOPC.
           MOVE SPACES       TO ROV-KEY-IROV IN ROV.
           MOVE OPC-CIC-IOPC TO ROV-CIC-IOPC IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC )
               MOVE 'ROVINEXOPC' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
      *Accesa documento que esta prorrogando ( antes respalda DLC )
           MOVE DLC TO DLC-BKP.
           MOVE ROV-CIC-IOPV IN ROV TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = ROV-CIC-IOPV IN ROV )
               MOVE 'DLC    NEX' TO MSG-COD-MENS
               MOVE ROV-CIC-IOPV IN ROV TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
      *El IOCO indica la operacion original ( si es que esta lleno )
           IF DLC-CIC-IOCO IN DLC > SPACES
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
           ELSE
               MOVE DLC-CIC-IOPC IN DLC TO OPC-CIC-IOPC IN OPC.
      *Se recuperan nuevamente los datos originales del DLC
           MOVE DLC-BKP TO DLC.
      *
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2
               GO TO MSG-BUS-FVAL-CAM.
           MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPC-FEC-FCOL TO CAM-FEC-FCAM IN CAM(2).
      *Restaura OPC
           MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               MOVE OPC-CIC-IOPC TO FRM-MEN2.
       MSG-BUS-FVAL-CAM.
           IF MSG-COD-MENS > SPACES
               MOVE 'SGV' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.
       FIN-BUS-FVAL-CAM.
           EXIT.

       HBL-KEY-DLC SECTION.
       INI-HBL-KEY-DLC.
           PERFORM SCR-CLRA-DLC.
           MOVE +4 TO DLC-CAI-IOPC-LEN IN DLC-FLD.
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC-FLD.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC-FLD.
      *ISP  7-FEB-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM HBL-FLD.
           MOVE SCR-INST-GFL TO SCR-INST.
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC-FLD.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC-FLD.
      *ISP SE REQUIEREN PARA BUS-COR-DLC
           MOVE SCR-CAI-IOPC IN SCR-VARI TO DLC-CAI-IOPC IN DLC.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO DLC-IIC-IOPC IN DLC.
           PERFORM BUS-COR-DLC.

           PERFORM GET-CUR-OPC.
           IF NOT PGM-STAT-OPC-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               PERFORM CLR-OPC-DLC
           ELSE
               PERFORM PUT-OPC-DLC
               PERFORM PRO-DLC-ROV.

           PERFORM GET-CUR-ICG.
           IF PGM-STAT-ICG-OKS
               PERFORM PUT-ICG-DLC.

           PERFORM EDT-KEY-DLC.
           PERFORM EDT-FLD-DLC.
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM STP-EXIT
           ELSE
               PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-HBL-KEY-DLC.
           EXIT.
      *>>>>
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-RQA3 > SPACES
               PERFORM LEE-NXT-PRV-DLC
           ELSE
           IF SCR-RQA2 > SPACES
               PERFORM LEE-NXT-PRV-RDC
           ELSE
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               MOVE SPACES TO SCR-KEY-IRDC
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-RDC SECTION.
       INI-LEE-NXT-PRV-RDC.
           MOVE SCR-RQA2 TO ADR-RDC-REQA.
           MOVE ADR-VKEY IN ADR-RDC-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC
               IF RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI IN WSS-VARI
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   IF RDC-NUM-IDLC IN RDC = ZEROES
                       GO TO INI-LEE-NXT-PRV-RDC
                   ELSE
                       MOVE '00' TO PGM-STAT-DBC
                       MOVE 'RDCSI' TO MSG-COD-MENS
                       GO TO FIN-LEE-NXT-PRV-RDC.
           MOVE 'RDCNO' TO MSG-COD-MENS.
           MOVE SPACES TO SCR-RQA2.
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-RDC.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-DLC SECTION.
       INI-LEE-NXT-PRV-DLC.
           MOVE SCR-RQA3 TO ADR-DLC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-DLC
               MOVE ADR-DLC-REQA TO SCR-RQA3.
       FIN-LEE-NXT-PRV-DLC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       BUS-DEU-IND SECTION.
       INI-BUS-DEU-IND.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-IND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-IND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-IND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-IND
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-IND.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       BUS-COR-DLC SECTION.
       INI-BUS-COR-DLC.
           MOVE 99 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC-FLD = DLC-CAI-IOPC IN DLC AND
                    DLC-IIC-IOPC IN DLC-FLD = DLC-IIC-IOPC IN DLC )
               PERFORM KEY-ALL-DLC
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO DLC-NUM-IDLC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO DLC-NUM-IDLC IN DLC-FLD
           ELSE
               MOVE DLC-NUM-IDLC IN DLC TO DLC-NUM-IDLC IN DLC-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-DLC.
           EXIT.

      * INIT
      * ====

       INI-REG-RDC SECTION.
       INI-INI-REG-RDC.
           MOVE SPACES TO RDC-GLS-FLAG IN RDC.
      *     MOVE SPACES TO RDC-COD-OINV IN RDC.
           MOVE SPACES TO RDC-GLS-DISP IN RDC.
       FIN-INI-REG-RDC.
           EXIT.

      * GET-UPD
      * =======

       GET-UPD-RDC SECTION.
       INI-GET-UPD-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-GET-UPD-RDC.
           IF RDC-CAI-ICLI IN DLC-FLD > SPACES OR
              RDC-IIC-ICLI IN DLC-FLD > ZEROES
               MOVE WSS-HAY TO WSS-FRDC.

           MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE WSS-HAY TO WSS-RRDC
               IF WSS-HAY-RDC-FRM AND
                  ( RDC-CAI-ICLI IN DLC-FLD NOT = RDC-CAI-ICLI IN RDC OR
                    RDC-IIC-ICLI IN DLC-FLD NOT = RDC-IIC-ICLI IN RDC )
                   MOVE WSS-OTRO TO WSS-SRDC.
       FIN-GET-UPD-RDC.
           EXIT.


      * MOD
      * ===

       MOD-ICG SECTION.
       INI-MOD-ICG.
           MOVE OPC-COD-TOOC IN DLC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC NOT = 'D'
               MOVE '00' TO FIO-STAT
               GO TO FIN-MOD-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC-FLD AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ICG
               MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-TINT IN ICG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-ICG
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-MOD-ICG
               ELSE
                   GO TO FIN-MOD-ICG.
           PERFORM PUT-ICG.
       FIN-MOD-ICG.
           EXIT.

       MOD-RDC SECTION.
       INI-MOD-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-MOD-RDC.
           IF NOT WSS-HAY-RDC-REG
               IF NOT WSS-HAY-RDC-FRM
                   GO TO FIN-MOD-RDC
               ELSE
                   PERFORM PUT-RDC
                   GO TO FIN-MOD-RDC.
      *PVG INI 24-09-2001
      *     IF SCR-KEY-IRDC = SPACES
      *        MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *PVG FIN 24-09-2001

      *ISP
           IF WSS-HAY-RDC-FRM AND
              WSS-MISMO-RDC
      *         MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
                MOVE FIO-MOD TO FIO-CMND
                PERFORM COL-FIO-RDC
                GO TO FIN-MOD-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-MOD-RDC.
           IF WSS-HAY-RDC-FRM
               PERFORM PUT-RDC.
       FIN-MOD-RDC.
           EXIT.
      *<<<< INI-AFRI-IMPP/DIC2005
        MOD-CXE SECTION.
        INI-MOD-CXE.
      *AFRI-INI/DIC2009
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'                    TO TAB-COD-TTAB IN TAB.
           MOVE 'GRBCXEPRG'              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE = 'S' )
               GO TO FIN-MOD-CXE.
      *AFRI-FIN/DIC2009
            MOVE LOW-VALUES TO CXE.
            MOVE SPACES                  TO CXE-GLS-FLAG IN CXE.
            MOVE DLC-CAI-IOPC IN DLC-FLD TO CXE-CAI-IOPC IN CXE.
            MOVE DLC-IIC-IOPC IN DLC-FLD TO CXE-IIC-IOPC IN CXE.
            MOVE ZEROES                  TO CXE-NUM-EVEN IN CXE.
            MOVE 'CUR'                   TO CXE-COD-EVEN IN CXE.
            MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.
            MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
            MOVE 'IMPPRG'                TO CXE-COD-CPTO IN CXE.
            MOVE FIO-GET-KEY-UPD         TO FIO-CMND.
            PERFORM COL-FIO-CXE.
            IF FIO-STAT-OKS
                MOVE FRM-NUM-PIMP IN DLC-FLD TO CXE-SGV-TINT IN CXE
                MOVE FIO-MOD                 TO FIO-CMND
                PERFORM COL-FIO-CXE
            ELSE
                MOVE FRM-NUM-PIMP IN DLC-FLD TO CXE-SGV-TINT IN CXE
                MOVE FIO-PUT                 TO FIO-CMND
                PERFORM COL-FIO-CXE.
        FIN-MOD-CXE.
            EXIT.
      *>>>> FIN-AFRI-IMPP/DIC2005
      * PUT
      * ===

       PUT-ICG SECTION.
       INI-PUT-ICG.
           MOVE OPC-COD-TOOC IN DLC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF MSC-CIC-CMSC IN MSC NOT = 'D'
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT (FIO-STAT-OKS AND
                   ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
                   ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
                   ICG-NUM-ICAN IN ICG = ZEROES       AND
                   ICG-CIC-IOPV IN ICG = SPACES       AND
                   ICG-NUM-IVCT IN ICG = ZEROES       AND
                   ICG-IND-TTAS IN ICG = 'INT' )
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           IF ICG-SGV-TINT IN ICG = ICG-SGV-TINT IN DLC-FLD
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-TINT IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE FIO-PUT TO FIO-CMND
           PERFORM COL-FIO-ICG
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-ICG.
           EXIT.
      * INI-FPM-AFRI ( 30-03-2004)
       PUT-RDC-AVL SECTION.
       INI-PUT-RDC-AVL.
           MOVE '00' TO FIO-STAT.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-PUT-RDC-AVL.
      *INI-AFRI/NOV2005
      *    IF NOT(OPC-IND-GARA IN OPC = '2  ' AND
      *       OPC-COD-TTRN IN OPC = '130')
           IF OPC-IND-GARA IN OPC  NOT = '2  '
               GO TO FIN-PUT-RDC-AVL.
           PERFORM BUS-CNAL.
           IF WSS-EXT-CNAL = 'NO'
               GO TO FIN-PUT-RDC-AVL.
      *FIN-AFRI/NOV2005
      *    MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC.
      *    MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC.
      *    MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC.
      *    MOVE DBC-IDC-ICLI IN DBC     TO RDC-RUT.
           MOVE OPC-CIC-IOPC IN OPC     TO RDC-NUOP.
           MOVE OPC-FEC-FCOL IN OPC     TO RDC-FECU.
           PERFORM COL-LNK-RDC.
           IF RDC-ESTA NOT = '00'
               MOVE RDC-MSJE     TO MSG-COD-MENS
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               MOVE '23' TO FIO-STAT.
       FIN-PUT-RDC-AVL.
           EXIT.
      * FIN-FPM-AFRI ( 30-03-2004)

       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-PUT-RDC.
           IF RDC-CAI-ICLI IN DLC-FLD > SPACES OR
              RDC-IIC-ICLI IN DLC-FLD > ZEROES
      *          MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
                PERFORM INI-REG-RDC
                MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CAI-IOPC IN RDC
                MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC
                MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC
                MOVE 100 TO RDC-VAL-LIMD IN RDC
                MOVE FIO-PUT TO FIO-CMND
                PERFORM COL-FIO-RDC
                IF NOT FIO-STAT-OKS
      *    Error inconsistencia en el ingreso : hacer LOGTB e informar
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

      *<<<< INI-AFRI-IMPP/DIC2005
       PUT-CXE SECTION.
       INI-PUT-CXE.
      *AFRI-INI/DIC2009
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'                    TO TAB-COD-TTAB IN TAB.
           MOVE 'GRBCXEPRG'              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE = 'S' )
               GO TO FIN-PUT-CXE.
      *AFRI-FIN/DIC2009
           MOVE LOW-VALUES TO CXE.
           MOVE SPACES                  TO CXE-GLS-FLAG IN CXE.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO CXE-CAI-IOPC IN CXE.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO CXE-IIC-IOPC IN CXE.
           MOVE ZEROES                  TO CXE-NUM-EVEN IN CXE.
           MOVE 'CUR'                   TO CXE-COD-EVEN IN CXE.
           MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
           MOVE 'IMPPRG'                TO CXE-COD-CPTO IN CXE.
           MOVE FRM-NUM-PIMP IN DLC-FLD TO CXE-SGV-TINT IN CXE.
           MOVE FIO-PUT                 TO FIO-CMND.
           PERFORM COL-FIO-CXE.
       FIN-PUT-CXE.
           EXIT.
      *>>>> FIN-AFRI-IMPP/DIC2005

      *DELETE
      *======

       DEL-RDC SECTION.
       INI-DEL-RDC.
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               GO TO FIN-DEL-RDC.
           IF NOT WSS-HAY-RDC-REG
               GO TO FIN-DEL-RDC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-DEL-RDC.
           EXIT.

      *<<<< INI-AFRI-IMPP/DIC2005
       DEL-CXE SECTION.
       INI-DEL-CXE.
      *AFRI-INI/DIC2009
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'                    TO TAB-COD-TTAB IN TAB.
           MOVE 'GRBCXEPRG'              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE = 'S' )
               GO TO FIN-DEL-CXE.
      *AFRI-FIN/DIC2009
           MOVE LOW-VALUES TO CXE.
           MOVE SPACES                  TO CXE-GLS-FLAG IN CXE.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO CXE-CAI-IOPC IN CXE.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO CXE-IIC-IOPC IN CXE.
           MOVE ZEROES                  TO CXE-NUM-EVEN IN CXE.
           MOVE 'CUR'                   TO CXE-COD-EVEN IN CXE.
           MOVE SPACES                  TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
           MOVE 'IMPPRG'                TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY-UPD         TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
              MOVE FRM-NUM-PIMP IN DLC-FLD TO CXE-SGV-TINT IN CXE
              MOVE FIO-DEL                 TO FIO-CMND
              PERFORM COL-FIO-CXE.
       FIN-DEL-CXE.
           EXIT.
      *>>>> FIN-AFRI-IMPP/DIC2005

       ANL-KEY-DLC SECTION.
       INI-ANL-KEY-DLC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-DLC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD
               PERFORM BUS-DEU-IND
               IF FIO-STAT-OKS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'RDC    NOOPC' TO MSG-COD-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                   ELSE
                       MOVE '00' TO PGM-STAT-OPC
                       MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                       MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
                       MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC
                                                     IN DLC-FLD
                       MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC
                                                     IN DLC-FLD
                       MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC
               ELSE
                   MOVE ZEROES TO RDC-NUM-DIRE IN RDC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NOIND' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-DLC.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN DLC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN DLC-FLD.
       FIN-PUT-DBC.
           EXIT.

       GET-CUR-OPC SECTION.
       INI-GET-CUR-OPC.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
       FIN-GET-CUR-OPC.
           EXIT.

       GET-CUR-ICG SECTION.
       INI-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC-FLD AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE '00' TO PGM-STAT-ICG
               GO TO FIN-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD AND
              ICG-NUM-ICAN IN ICG = ZEROES       AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               MOVE '00' TO PGM-STAT-ICG.
       FIN-GET-CUR-ICG.
           EXIT.

       GET-NXT-ICG SECTION.
       INI-GET-NXT-ICG.
           MOVE ICG-NUM-ICAN IN ICG TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC-FLD  AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC-FLD  AND
              ICG-NUM-ICAN IN ICG = WSS-NUM-ICAN IN WSS-VARI AND
              ICG-CIC-IOPV IN ICG = SPACES                   AND
              ICG-NUM-IVCT IN ICG = ZEROES                   AND
              ICG-IND-TTAS IN ICG = 'INT'
                MOVE 'M' TO SCR-IND-MICG
                MOVE 'COL'         TO MSG-COD-SIST
                MOVE 'OPC    MICG' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MICG
                PERFORM GET-CUR-ICG.
       FIN-GET-NXT-ICG.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *JSS COMPATIBILIDAD VSAM DATACOM
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-RDC.
      *JSS COMPATIBILIDAD VSAM DATACOM
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CAI-IOPC IN RDC = DLC-CAI-IOPC IN DLC-FLD AND
                    RDC-IIC-IOPC IN RDC = DLC-IIC-IOPC IN DLC-FLD AND
                    RDC-NUM-IDLC IN RDC = DLC-NUM-IDLC IN DLC-FLD )
               MOVE '23' TO FIO-STAT.
      *
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC.

      *PVG INI 24-09-2001
      *     IF NOT ( DLC-CAI-IOPC IN DLC-FLD = RDC-CAI-IOPC IN RDC AND
      *              DLC-IIC-IOPC IN DLC-FLD = RDC-IIC-IOPC IN RDC AND
      *              DLC-NUM-IDLC IN DLC-FLD = RDC-NUM-IDLC IN RDC )
      *        MOVE '23' TO FIO-STAT.
      *PVG FIN 24-09-2001
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC-FLD = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC-FLD = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC-FLD = RDC-NUM-IDLC IN RDC
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'DLC    MDIND' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
              MOVE SPACES TO SCR-IND-MRDC
              PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.

       BUS-POC SECTION.
       INI-BUS-POC.
      *ALD
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-POC.
      *
       FIN-BUS-POC.
           EXIT.

      *INI-FPM-AFRI
       COPY COLBKRDC.
       COPY SGCBFDCP.
      *FIN-FPM-AFRI
       COPY SGCBFDBC.
       COPY COLBFOPC.
       COPY COLBFROV.
       COPY COLBFCAN.
       COPY COLBFRDC.
       COPY COLBFICG.
       COPY SGCBFRCD.
      *PTC ini
      * COPY GNSBGQUE.
      *RRM-INI (RRM) 26-NOV-2002
      * COPY GNSBGTSK.
      *RRM-FIN (RRM) 26-NOV-2002
      *PTC fin
       COPY TABBFTIO.
       COPY TABBFCAM.
      *AFRI-INI/JUN2008 (MAE)
       COPY COLBGMED.
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
       COPY COLBFCCB.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES
      *AFRI-FIN/JUN2008 (MAE)
       COPY COLBFCXE.
       COPY COLBFNTR.
       COPY SGCBGCLI.
       COPY GNSBPFEC.
      * COPY GNSBGFEC.
      * COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBGDOM.
      * COPY GNSBGDTC.
       COPY GNSBGVSM.
       COPY COLBFTOC.
       COPY COLBFPOC.
       COPY COLBFDCC.
       COPY TABBVOFI.
      *>>>>
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM HBL-IKY.
      *PTC ini
           IF SCR-OFRM-SRV
               EXEC CICS
               RETURN
           END-EXEC.
      *PTC fin
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-DLC.
           MOVE SCR-MENS-EXT TO DLC-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.
       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.
       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      *PTC ini
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-IDLC TO SCR-IPRO
           ELSE
      *PTC fin
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE DLC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.
       SET-ENG SECTION.
       INI-SET-ENG.
           MOVE WSS-IDX-IDLC TO SCR-IPRO.
           MOVE DLC-CAI-IOPC IN DLC-FLD TO SCR-CAI-IOPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO SCR-IIC-IOPC.
           MOVE DLC-NUM-IDLC IN DLC-FLD TO SCR-NUM-IDOC.
      *ISP ENGANCHE INCONDICIONAL A (E)VC (O) (V)EN
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IEOV).
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IEOV).

      *ISP NO ES NECESARIO LEER OPC,PUES SE LEYO ANTE DE VAL-VCAM
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 'S' TO SCR-IND-EOV IN SCR-VARI
           ELSE
               MOVE 'N' TO SCR-IND-EOV IN SCR-VARI.

      * ISP SI TIENE MULTIPLES DEUDORES INDIRECTOS EL PROGRAMA RDC CARGA
      * TABLA CON LA CUAL SE DECIDE A QUE PROGRAMA AVANZAR EVC O VEN
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IIND)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IIND)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IIND)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IIND)
               IF SCR-IND-EOV IN SCR-VARI = 'S'
                   MOVE 'KQ13COLPQEVCCOLFEVCCOLAEVC' TO
                         WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                   MOVE 'KU13COLPUEVC'               TO
                         WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV)
               ELSE
                   MOVE 'KQ33COLPQVENCOLFVENCOLAVEN' TO
                         WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                   MOVE 'KU33COLPUVEN'               TO
                         WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV).
      *         IF SCR-IND-EOV IN SCR-VARI = 'S'
      *             MOVE 'KO13COLPAEVCCOLFEVCCOLAEVC' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
      *         ELSE
      *             MOVE 'KO33COLPAVENCOLFVENCOLAVEN' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV).
       FIN-SET-ENG.
           EXIT.
      *>>>>
      *<<<< EOF_PU
       PUT-DBC-DLC SECTION.
       INI-PUT-DBC-DLC.
      *<<<< INI_PUT_DBC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
      *>>>>

           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-DLC
               GO TO FIN-PUT-DBC-DLC.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN DLC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD.

      *<<<< FIN_PUT_DBC_DLC
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
      *>>>>
       FIN-PUT-DBC-DLC.
           EXIT.

       PUT-OPC-DLC SECTION.
       INI-PUT-OPC-DLC.

           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-DLC.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-DLC
               GO TO FIN-PUT-OPC-DLC.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN DLC-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN DLC-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN DLC-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN DLC-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN DLC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN DLC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN DLC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN DLC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN DLC-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN DLC-FLD > SPACES
               MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN DLC-FLD.

      *<<<< FIN_PUT_OPC_DLC
      *BUS-TAB busca glosa de codigo en tabla
      * NO EXISTE OPC-COD-VCOC IN DLC-FLD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN DLC-FLD.
      *>>>>
       FIN-PUT-OPC-DLC.
           EXIT.
       PUT-ICG-DLC SECTION.
       INI-PUT-ICG-DLC.

           IF PGM-STAT-ICG-NUL
               GO TO FIN-PUT-ICG-DLC.
           IF NOT PGM-STAT-ICG-OKS
               PERFORM CLR-ICG-DLC
               GO TO FIN-PUT-ICG-DLC.
           MOVE ICG-COD-TINT IN ICG TO ICG-COD-TINT IN DLC-FLD.
           MOVE ICG-SGV-TINT IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ICG-COD-TINT IN DLC-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'INT' TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN DLC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TINT IN DLC-FLD.

      *<<<< FIN_PUT_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *>>>>
       FIN-PUT-ICG-DLC.
           EXIT.
      *>>>>
      *PGM-EBR-ALL SECTION.
      *INI-PGM-EBR-ALL.
      *    MOVE FIO-EBR-ALL TO FIO-CMND.
      *    PERFORM COL-FIO-DLC.
      *FIN-PGM-EBR-ALL.
      *    EXIT.
      *INI-AFRI/NOV2005
       BUS-CNAL SECTION.
       INI-BUS-CNAL.
           MOVE 'NO'    TO WSS-EXT-CNAL.
           MOVE 'DEU'   TO TAB-COD-SIST FIO-SIST.
           MOVE 'EXP'   TO TAB-COD-TTAB IN TAB.
           MOVE 'COLEXCAVL' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S')
               GO TO FIN-BUS-CNAL.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.
           MOVE 1 TO WSS-I.
       LUP1-PUT-RDC-AVL.
           IF OPC-COD-TTRN IN OPC = WSS-COD-CNAL(WSS-I) AND
              OPC-COD-TTRN IN OPC > SPACES
               MOVE 'SI'    TO WSS-EXT-CNAL
               GO TO FIN-BUS-CNAL.
           ADD 1 TO WSS-I.
           IF WSS-I > 20
               GO TO FIN-BUS-CNAL
           ELSE
               GO TO LUP1-PUT-RDC-AVL.
       FIN-BUS-CNAL.
           EXIT.
      *AFRI-FIN/NOV2005
       CMN-CEB SECTION.
       INI-CMN-CEB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF  NOT FIO-STAT-OKS
                GO TO FIN-CMN-CEB.
           MOVE DLC-IND-ESTA IN DLC-FLD TO DLC-IND-ESTA IN DLC.
           MOVE DLC-IND-ETAP IN DLC-FLD TO DLC-IND-ETAP IN DLC.
           MOVE DLC-IND-ESTA IN DLC     TO WSS-IND-ESTA.
           MOVE DLC-IND-ETAP IN DLC     TO WSS-IND-ETAP.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF  NOT FIO-STAT-OKS
                GO TO FIN-CMN-CEB.
       FIN-CMN-CEB.
           EXIT.
      *>>>>
