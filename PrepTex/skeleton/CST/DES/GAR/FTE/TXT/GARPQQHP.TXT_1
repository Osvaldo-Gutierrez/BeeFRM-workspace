*%! Codigo adicional para archivo
*% FRM = "QHP"
*% IF NOT PGM_DB2
*% INCLUDE 'GARSRC:PFSALLF56.SRC'
*% END
*% PAD = 'GVT'
*% HIJ = 'GTP'
*%!  No limpie campos de registros, luego de PF's
*% NREG = 2
*% REG1 = 'GDG'
*% REG2 = 'GVT'
*% KEYHIJHIJ = 'GAR-CLV-GTP-1'
*% KEYPADHIJ = 'GAR-CLV-GVT-1'
*% KEYUNIHIJ = 'GAR-COD-ITM-TSN'
*% KEYUNIFLD = 'FRM-COD-ITM-TSN'
*% KEYPADPAD = 'GAR-CLV-GVT-1'
*% LENKEYPAD = '15'
*% LENKEYHIJ = '03'
*% SISPAD = 'GAR'
*% SISREG = 'GAR'
*% SISSRC = 'GAR'
*% IMAX = '9 '
*% ACUMULA = TRUE
*% NO_IBUS = TRUE
*% FIO_STA_OKS = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI

*% INCLUDE CMAVARI OF '{SISSRC}SRC:PGM1ANIDX.SRC'
              05  WSS-SUM-ITM            COMP-3       PIC S9(03).
              05  WSS-SUM-VAL            COMP-3       PIC S9(11)V9(4).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GARBRGDG.
       COPY {SISREG}BR{HIJ}.
       COPY GARBRTAG.

      * Define 01  WSS-VARI de PGM1ANIDX
*% INCLUDE WSSVARI OF '{SISSRC}SRC:PGM1ANIDX.SRC'

*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA AND PGM_IBM
           02 FILLER                    PIC X(350).
*% END
*% IF INI_FIO AND PGM_IBM
      *<<<< INI_FIO
           MOVE +350 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO

*% INCLUDE OPEHIJ OF '{SISSRC}SRC:PGM1ANIDX.SRC'

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-TAG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM {SISREG}-FIO-TAG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-GDG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM {SISREG}-FIO-GDG.

      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
*% INCLUDE INIFNDKEY OF '{SISSRC}SRC:PGM1ANIDX.SRC'

      *BUSCA ULTIMA GVT
           IF GVT-COD-TSN IN QHP-FLD NOT > ZEROES
               MOVE GAR-COD-TSN IN GDG TO GVT-COD-TSN IN QHP-FLD.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
*% INCLUDE FINFNDKEY OF '{SISSRC}SRC:PGM1ANIDX.SRC'

*% INCLUDE 'GARSRC:ERRFNDKEY.SRC'
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
*% INCLUDE PUTTAB OF '{SISSRC}SRC:PGM1ANIDX.SRC'

*% INCLUDE LIMRESLIN  OF '{SISSRC}SRC:PGM1ANIDX.SRC'

       COPY GARBFGDG.
       COPY {SISREG}BF{HIJ}.
       COPY GARBFTAG.
      *>>>>
*% END
