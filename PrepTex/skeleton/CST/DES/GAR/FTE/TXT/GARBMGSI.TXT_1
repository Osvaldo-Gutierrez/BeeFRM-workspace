*% FRM = 'GSI'
*% REG = 'GSI'
*% IF GSI_FEC_SIN
      *<<<< GSI_FEC_SIN

      *VALIDA CON FECHA CONSTITUCION GARANTIA.
           MOVE GSI-NUM-SIS IN GSI-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GSI-COD-CRR IN GSI-FLD TO GAR-COD-CRR IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

      *    MOVE '01011937' TO FEC-FEC1.
           MOVE GAR-FA-ESC-CNS IN GDG TO FEC-FANO IN FEC-VARI.
           MOVE GAR-FM-ESC-CNS IN GDG TO FEC-FMES IN FEC-VARI.
           MOVE GAR-FD-ESC-CNS IN GDG TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GSI-FA-SIN IN {FRM}-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GSI-FM-SIN IN {FRM}-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GSI-FD-SIN IN {FRM}-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE 'FEC   <MIN' TO MSG-COD-MENS
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               MOVE 'FEC<MIN' TO MSG-COD-MENS
      *>>>>
*% END
               GO TO ERR-VAL-GSI-FEC-SIN.

           GO TO FIN-VAL-GSI-FEC-SIN.
       ERR-VAL-GSI-FEC-SIN.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% LBL = ""
*% IF GSI_IND_RTS
      *<<<< GSI_IND_RTS
           IF NOT (GSI-IND-RTS = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GSI_IND_CUB_SEG
      *<<<< GSI_IND_CUB_SEG
           IF NOT (GSI-IND-CUB-SEG = 'S' OR 'N')
               MOVE 'DEBE SER S o N ' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GSI_VAL_PAG_SEG
      *<<<< GSI_VAL_PAG_SEG
           IF GSI-IND-CUB-SEG IN {FRM}-FLD NOT = 'S'
               MOVE 0 TO GSI-VAL-PAG-SEG IN {FRM}-FLD
               GO TO FIN-VAL-GSI-VAL-PAG-SEG.

           IF GSI-VAL-PAG-SEG IN {FRM}-FLD = ZEROES
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE 'GSIVALPAG=0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GSI_PCT_SIN
      *<<<< GSI_PCT_SIN
           IF NOT ( GSI-PCT-SIN IN GSI-FLD > ZEROES AND 
                    GSI-PCT-SIN IN GSI-FLD < 100,01 )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE '% MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
