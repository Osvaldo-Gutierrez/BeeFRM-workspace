*% FRM = "GAP"
*% NO_HDR_CST = TRUE
*%! Codigo adicional para Funcion GARPPVCG = PF5 desde GARPAGAP
*% INCLUDE 'GARSRC:PFALL5.SRC'
*%! Codigo adicional programa GARPAGAP
*% GRA_GMO = TRUE
*% REG = 'GAP'
*% HIJ = 'GDG'
*% CAIREG = 'GAR-NUM-SIS'
*% IICREG = 'GAR-COD-CRR'
*% CAIFLD = 'GAP-NUM-SIS'
*% IICFLD = 'GAP-COD-CRR'
*% SISREG = 'GAR'
*% IF PGM_ARG
*% LARGO_MI_COMMAREA = 15
*% ELSE
*% LARGO_MI_COMMAREA = 13
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
              05 {CAIREG}                  PIC X(04).
              05 {IICREG}                  PIC X(08).
              05 GAR-IND-CPL                   PIC X(01). 
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY {SISREG}BR{HIJ}.
       COPY {SISREG}BRTAG.
       COPY {SISREG}BRGMO.
*% IF NOT PGM_PQ
      *<<<< NOT PGM_PQ
       COPY GARBRGDD.
      *>>>>
*% END
       COPY SGCBRDBC.
*% IF NOT PGM_PU
      *<<<< NOT PGM_PU
       COPY GARWGVCG.
*% IF PGM_VMS
      *<<<< PGM_VMS
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
      *>>>>
*% END
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.

*% IF PGM_CHI AND PGM_PQ
      *<<<< PGM_CHI AND PGM_PQ
           COPY USPC113.
      *>>>>
*% END
       01  WSS-VARI.
           03 WSS-CPO.
*% IF PGM_ARG
      *<<<< PGM_ARG
              05 DBC-NUM-ICLI                  PIC 9(09).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
              05 DBC-NUM-ICLI                  PIC 9(08).
      *>>>>
*% END
              05 DBC-VRF-ICLI                  PIC X(01).
              05 DBC-IND-ICLI                  PIC X(01).
*% IF PGM_ARG
      *<<<< PGM_ARG
              05 DBC-GLS-ICLI                  PIC 9(02).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
              05 DBC-GLS-ICLI                  PIC X(03).
      *>>>>
*% END
           03 WSS-HOY-ANO.
              05 WSS-SHOY                      PIC 9(02).
              05 WSS-AHOY                      PIC 9(02).
           03 GAR-COD-GRA VALUE ZEROES         PIC 9(01).
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO AND PGM_VAX

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-TAG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-GDD.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-GDD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-GMO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-GMO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
*% FIN_BUS_HIJ = TRUE
*% INCLUDE 'GARSRC:INIFNDKE1.SRC'
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
*% INCLUDE 'GARSRC:FINFNDKE1.SRC'
      *>>>>
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
           IF SCR-CCPP = 'ING'
               MOVE GAR-COD-GRA IN GDG TO GAR-COD-GRA IN WSS-VARI
               IF GAR-COD-GRA IN WSS-VARI > ZEROES
                   IF NOT (
                      GAR-COD-GRA IN WSS-VARI -
                      GAP-COD-PRD-ACR IN GAP-FLD > ZEROES
                      )
                       MOVE 'GAR' TO MSG-COD-SIST
                       MOVE 'PRDGRAINV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
*% INCLUDE 'GARSRC:LIMFLD.SRC'
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
*% INCLUDE 'GARSRC:STDFLD.SRC'
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
*% INCLUDE 'GARSRC:CMNINGGMO.SRC'
*% INCLUDE 'GARSRC:FINCMNING.SRC'
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
*% INCLUDE 'GARSRC:CMNELIGMO.SRC'
*% INCLUDE 'GARSRC:CMNELIMUL.SRC'

      *>>>>
*% END
*% IF EOF AND ( PGM_PU OR PGM_VMS )
      *<<<< EOF AND ( PGM_PU OR PGM_VMS )
       ESC-GMO-GAP SECTION.
       INI-ESC-GMO-GAP.
           MOVE ZEROES TO GAR-CRR-MOV IN GMO.
           PERFORM INI-GMO.
           MOVE 'GAP001' TO GAR-COD-CPO IN GMO.
           MOVE 'N' TO GAR-IND-VAL IN GMO.
           MOVE 'N' TO GAR-IND-CLV IN GMO.
           MOVE DBC-NUM-ICLI IN GAP-FLD TO 
                DBC-NUM-ICLI IN WSS-CPO.
           MOVE DBC-VRF-ICLI IN GAP-FLD TO
                DBC-VRF-ICLI IN WSS-CPO.
           MOVE DBC-IND-ICLI IN GAP-FLD TO
                DBC-IND-ICLI IN WSS-CPO.
           MOVE DBC-GLS-ICLI IN GAP-FLD TO
                DBC-GLS-ICLI IN WSS-CPO.
           IF GAR-COD-MOV IN GMO = '1'
              MOVE WSS-CPO TO GAR-GLS-CPO-NVO IN GMO
           ELSE
           IF GAR-COD-MOV IN GMO = '3'
              MOVE WSS-CPO TO GAR-GLS-CPO-ANT IN GMO.
               
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE 'GMO    PUT' TO MSG-COD-MENS.
       FIN-ESC-GMO-GAP.
           EXIT.   
*% INCLUDE 'GARSRC:INIGMO.SRC'

       COPY {SISREG}BFGDD.
       COPY {SISREG}BFGMO.
       COPY GNSBGPES.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY {SISREG}BF{HIJ}.
       COPY {SISREG}BFTAG.

*% IF NOT PGM_PU
      *<<<< NOT PGM_PU
       COPY GARBGVCG.
       COPY GARBKVCG.
      *>>>>
*% END

       COPY SGCBFDBC.

       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGSTR.

*% IF PGM_PQ
      *<<<< PGM_PQ
       BUS-COR-GAP SECTION.
       INI-BUS-COR-GAP.
      *FLB CST  19-AUG-1994 CORRIGE ERROR EN POSICIONAMIENTO
           MOVE GAP-NUM-SIS IN GAP-FLD TO GAR-NUM-SIS     IN GAP.
           MOVE GAP-COD-CRR IN GAP-FLD TO GAR-COD-CRR     IN GAP.
           MOVE 99                     TO GAR-COD-PRD-ACR IN GAP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF NOT ( FIO-STAT-OKS AND
                    GAP-NUM-SIS  IN GAP-FLD = GAR-NUM-SIS  IN GAP AND
                    GAP-COD-CRR  IN GAP-FLD = GAR-COD-CRR  IN GAP )
               PERFORM KEY-GAP-GAP
               MOVE ZEROES TO GAR-COD-PRD-ACR IN GAP.

           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GAP.

           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO GAR-COD-PRD-ACR IN GAP 
               MOVE GAR-COD-PRD-ACR IN GAP TO
                    GAP-COD-PRD-ACR IN GAP-FLD.
       
       FIN-BUS-COR-GAP.
           EXIT.
      *>>>>
*% END
      *>>>>
*% END
