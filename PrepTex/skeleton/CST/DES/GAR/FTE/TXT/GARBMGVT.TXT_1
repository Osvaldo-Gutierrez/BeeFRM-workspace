*% FRM = 'GVT'
*% REG = 'GVT'
*% IF FIN_PUT_GVT_GVT
      *<<<< FIN_PUT_GVT_GVT
      *    PARA RECORDAR RAZON ENTRE VAL-CML Y VAL-LIQ
           MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO
                WSS-VAL-LIQ-TSN IN CMA-VARI.

           IF ( SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON OR
                SCR-CMND = 'ATA' ) AND

               GVT-VAL-LIQ-TSN IN GVT-FLD > ZEROES AND
               GVT-VAL-CML-TSN IN GVT-FLD > ZEROES

                COMPUTE WSS-LIQ-CML IN CMA-VARI ROUNDED =
                               GVT-VAL-LIQ-TSN IN GVT-FLD /
                               GVT-VAL-CML-TSN IN GVT-FLD

           ELSE
               MOVE ZEROES TO WSS-LIQ-CML IN CMA-VARI.

       OBT-VEN-TSN.
           PERFORM EXA-VEN-TSN.  

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GTP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GTP.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP.
           MOVE ZEROES                 TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GAR-NUM-SIS IN GTP = GVT-NUM-SIS IN GVT-FLD AND
              GAR-COD-CRR IN GTP = GVT-COD-CRR IN GVT-FLD AND
              GAR-COD-TSN IN GTP = GVT-COD-TSN IN GVT-FLD 
               MOVE 'S' TO FRM-IND-GTP IN GVT-FLD
           ELSE
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.
           IF FIO-STAT-OKS 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GTP.
      *>>>>
*% END
*% IF FIN_PUT_ALL_GVT
      *<<<< FIN_PUT_ALL_GVT
           PERFORM OBT-COD-MNAC.
           PERFORM OBT-VAL-CON.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_GVT
      *<<<< FIN_VAL_CON_IKY_GVT
           IF GVT-COD-TSN IN GVT-FLD < 1
               MOVE 1 TO GVT-COD-TSN IN GVT-FLD
           ELSE
           IF GVT-COD-TSN IN GVT-FLD > 1
      *        Comando Ingreso
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'GVTIKY>1' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_GVT
      *<<<< INI_VAL_CON_KEY_GVT
           IF FRM-FFLD = FRM-FFLD-PF5
               GO TO FIN-VAL-CON-KEY-GVT.

      *>>>>
*% END
*% IF FIN_FST_FLD_GVT
      *<<<< FIN_FST_FLD_GVT

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-IIV-TSD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-IIV-SVS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-CTR-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-TRR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-UMD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-CTR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD
               MOVE -1 TO GVT-IIV-TSD-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

           IF SCR-CMND = 'RVL'
               MOVE FRM-CPIM-AEY TO GVT-FEC-TSN-ATR IN GVT-FLD
               MOVE -1 TO GVT-FEC-RVL-LEN IN GVT-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               MOVE -1 TO GVT-FEC-TSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GDP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
      *>>>>
*% END
*% IF FRM_IND_GTP
      *<<<< FRM_IND_GTP
      *FLB CST  3-DEC-1993 
           IF FRM-IND-GTP IN GVT-FLD NOT > SPACES
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.
      *>>>>
*% END
*% IF INI_GVT_FEC_TSN
      *<<<< INI_GVT_FEC_TSN
           IF SCR-CMND = 'RVL'
               GO TO FIN-VAL-GVT-FEC-TSN.

           MOVE GVT-FEC-TSN IN GVT-FLD TO GVT-FEC-RVL IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_FEC_TSN
      *<<<< GVT_FEC_TSN

           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF WSS-FEC-TSN IN CMA-VARI > ZEROES
               MOVE WSS-FEC-TSN IN CMA-VARI TO FEC-FVLD IN FEC-VARI
           ELSE
               MOVE 1937 TO FEC-FANO IN FEC-VARI
               MOVE   01 TO FEC-FMES IN FEC-VARI
               MOVE   01 TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTTSNANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-TSN.

      *>>>>
*% END
*% LBL = ""
*% IF GVT_FEC_RVL
      *<<<< GVT_FEC_RVL

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-FA-RVL IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-RVL IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-RVL IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVLANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-RVL.

      *FLB CST  6-OCT-1993 
               IF GAR-PDO-VIG-TSN IN CMA-VARI NOT > ZEROES
                   GO TO FIN-VAL-VIG-RVL.
      *FLB CST  6-OCT-1993 FIN

      * Suma periodo de vigencia a Fecha Tasacion

           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-DVLD TO FEC-ITM1.

           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'A'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NANO
               MOVE FEC-SUM-ANO TO FEC-CMND
           ELSE
           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'M'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NMES
               MOVE FEC-SUM-MES TO FEC-CMND
           ELSE
           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'D'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NDIA
               MOVE FEC-SUM-DIA TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
*% IF PGM_VMS
      *<<<< PGM_VMS
           PERFORM PRO-FEC.
      *>>>>
*% ELSE
      *<<<< NOT PGM_VMS
           PERFORM CAL-FEC.
      *>>>>
*% END
           
      * Usa fecha resultante como Fecha Maxima de Revalorizacion
           MOVE FEC-ITM1 TO FEC-DEC1.
           MOVE FEC-ITM2 TO FEC-MEC1.
           MOVE FEC-ITM3 TO FEC-SEC1.
           MOVE FEC-ITM4 TO FEC-AEC1.

           MOVE GVT-FA-RVL IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-RVL IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-RVL IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVL>VIG'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-RVL.
      *FLB CST  6-OCT-1993 
       FIN-VAL-VIG-RVL.
      *FLB CST  6-OCT-1993 FIN

      *>>>>
*% END
*% LBL = ""
*% IF GVT_VAL_CML_TSN
      *<<<< GVT_VAL_CML_TSN

           PERFORM OBT-COD-MNAC.
           IF SCR-CCPP = 'ING' AND
              FRM-IND-GTP IN GVT-FLD = 'S'
               GO TO FIN-VAL-GVT-VAL-CML-TSN.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO WSS-VAL-CML-AUX
               MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GTP
               MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GTP
               MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP
               MOVE '00' TO FIO-STAT

      *        Suma las tasaciones parciales para llenar valores CML y LIQ
               PERFORM TOT-GTP VARYING GAR-COD-ITM-TSN IN WSS-VARI
                     FROM 1 BY 1 UNTIL NOT FIO-STAT-OKS
               MOVE WSS-VAL-CML-AUX TO GVT-VAL-CML-TSN IN GVT-FLD.

      * Obtiene valor sin decimales
           IF FIO-STAT-OKS AND GDG-VCB IN GVT-FLD = TAB-COD-CTAB IN TAB
               MOVE GVT-VAL-CML-TSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-CML-TSN IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_VAL_LIQ_TSN
      *<<<< GVT_VAL_LIQ_TSN

      *FLB CST  4-MAY-1994 ARREGLADO MEJOR QUE ARGENTINA
           IF FRM-IND-GTP IN GVT-FLD = 'S' AND
              WSS-LIQ-CML IN CMA-VARI > ZEROES AND
              WSS-VAL-LIQ-TSN IN CMA-VARI =
              GVT-VAL-LIQ-TSN IN GVT-FLD
               MULTIPLY WSS-LIQ-CML     IN CMA-VARI BY
                        GVT-VAL-CML-TSN IN GVT-FLD GIVING
                        GVT-VAL-LIQ-TSN IN GVT-FLD ROUNDED.


           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-LIQ-TSN IN GVT-FLD.

            IF NOT (
                    SCR-CCPP = 'ING' AND
                    FRM-IND-GTP IN GVT-FLD = 'S'
                   ) AND
               GVT-VAL-LIQ-TSN IN GVT-FLD NOT > ZEROES
      *        Solo puede ser 0 al Ingresar GVT con Tasaciones Parciales

                MOVE 'GAR'      TO MSG-COD-SIST
                MOVE 'GVTLIQ=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GVT-VAL-LIQ-TSN.

           IF GVT-VAL-LIQ-TSN IN GVT-FLD >
              GVT-VAL-CML-TSN IN GVT-FLD AND
              NOT (
                  SCR-CCPP = 'ING' AND FRM-IND-GTP IN GVT-FLD = 'S'
                  )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE 'GVTLIQ>CML' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-VAL-LIQ-TSN.

      *>>>>
*% END
*% IF GVT_PCT_PON
      *<<<< GVT_PCT_PON
           IF GVT-PCT-PON IN GVT-FLD = ZEROES
               MOVE GAR-PCT-PON IN CMA-VARI TO GVT-PCT-PON IN GVT-FLD
           ELSE
           IF GVT-PCT-PON IN GVT-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_VAL_PON
      *<<<< GVT_VAL_PON

           COMPUTE GVT-VAL-PON IN GVT-FLD ROUNDED =
                   GVT-VAL-LIQ-TSN IN GVT-FLD *
                   GVT-PCT-PON IN GVT-FLD / 100.

           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-VAL-PON  IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-PON  IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_PCT_AJT_SUP
      *<<<< GVT_PCT_AJT_SUP
           MOVE GAR-PCT-AJT-SUP IN CMA-VARI TO GVT-PCT-AJT-SUP
                                                   IN GVT-FLD.
      *>>>>
*% END
*% IF GVT_VAL_AJT_SUP
      *<<<< GVT_VAL_AJT_SUP

           COMPUTE   GVT-VAL-AJT-SUP IN GVT-FLD ROUNDED =
                     GVT-VAL-CML-TSN IN GVT-FLD -
                   ( GVT-VAL-CML-TSN IN GVT-FLD *
                     GAR-PCT-AJT-SUP     IN CMA-VARI / 100 ).

           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO 
                    PES-SGV-DECI    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE    IN PES-VARI TO
                    GVT-VAL-AJT-SUP IN GVT-FLD.

      * Se contabiliza por valor ajustado, luego debe ser > 0
      *    salvo en el ingreso con Tasaciones Parciales
           IF NOT (
                   SCR-CCPP = 'ING' AND 
                   FRM-IND-GTP IN GVT-FLD = 'S'
                  ) AND
                   GVT-VAL-AJT-SUP IN GVT-FLD NOT > ZEROES
                MOVE 'GAR'     TO MSG-COD-SIST
                MOVE 'GVTAJT=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.

           PERFORM OBT-VAL-CON.
      *>>>>
*% END
*% IF GVT_TIP_CTR
      *<<<< GVT_TIP_CTR
      *ALD-BNL
      * PARA GAR-IND-OBL-CEM = 'E' NO OBLIGA CAMPO GVT-TIP-CTR
           IF GAR-IND-OBL-CEM IN CMA-VARI = 'N' OR
              GAR-IND-OBL-CEM IN CMA-VARI = 'E'
               MOVE SPACES TO GVT-TIP-CTR     IN GVT-FLD
               MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD
               GO TO FIN-VAL-GVT-TIP-CTR.

           IF GVT-TIP-CTR IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPCTR BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_TIP_MAQ_EQP
      *<<<< GVT_TIP_MAQ_EQP
           IF GAR-IND-OBL-CEM IN CMA-VARI NOT = 'E'
               MOVE SPACES TO GVT-TIP-MAQ-EQP IN GVT-FLD
               MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD
               GO TO FIN-VAL-GVT-TIP-MAQ-EQP.

           IF GVT-TIP-MAQ-EQP IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPMEQ BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_M2_TRR
      *<<<< GVT_M2_TRR
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'T' OR 'A' )
               MOVE ZEROES TO GVT-M2-TRR IN GVT-FLD
               GO TO FIN-VAL-GVT-M2-TRR.

           IF GVT-M2-TRR IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2TRR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_M2_CTR
      *<<<< GVT_M2_CTR
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'C' OR 'A' )
               MOVE ZEROES TO GVT-M2-CTR IN GVT-FLD
               GO TO FIN-VAL-GVT-M2-CTR.

           IF GVT-M2-CTR IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2CTR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GVT_COD_UMD
      *<<<< GVT_COD_UMD
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'C' OR 'T' OR 'A' )
               MOVE SPACES TO GVT-COD-UMD IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-UMD.

           IF GVT-COD-UMD IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'CODUMD BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF_VAX OR EOF_BU
      *<<<< EOF_VAX OR EOF_BU
       TOT-GTP SECTION.   
       INI-TOT-GTP.
      *    Devuelve Sumatoria Tasaciones Parciales en WSS-VAL-CML-AUX

           MOVE GAR-COD-ITM-TSN IN WSS-VARI TO
                GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GAR-COD-EST-ITM IN GTP > '09' AND < '15'
                   COMPUTE WSS-VAL-CML-AUX = WSS-VAL-CML-AUX +
                   GAR-CTD-ITM-TSN IN GTP * GAR-VAL-UNT-ITM IN GTP.
       FIN-TOT-GTP.
           EXIT.

      *>>>>
*% END
*% IF EOF_VAX OR EOF_BQ OR EOF_BU
      *<<<< EOF_VAX OR EOF_BQ OR EOF_BU
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-VCB IN GVT-FLD TO GAR-VCB IN GDG.
           IF NOT (
              GAR-TIP-VCB IN GDG = '0' AND
              GDG-VCB IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD
               GO TO FIN-OBT-VAL-CON.

           MOVE GVT-FA-RVL   IN GVT-FLD  TO FEC-FANO.
           MOVE FEC-SVLD                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE FEC-AVLD                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE GVT-FM-RVL   IN GVT-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE GVT-FD-RVL   IN GVT-FLD  TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-VCB      IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-VAL-AJT-SUP IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

      *>>>>
*% END
