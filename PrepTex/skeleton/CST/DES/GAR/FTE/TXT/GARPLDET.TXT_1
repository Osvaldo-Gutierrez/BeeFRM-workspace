*%! Codigo adicional para archivo
*% REG = 'GDG'
*% RPT = 'DET'
*% IF RR
      *<<<< RR
      *
       COPY GARRRDT2 REPLACING ==01  SRT== BY ==02  SRT-GDG==.
       COPY GARRRDT3 REPLACING ==01  SRT== BY ==02  SRT-GDD==.
       COPY GARRRDT4 REPLACING ==01  SRT== BY ==02  SRT-GLE==.
       COPY GARRRDT5 REPLACING ==01  SRT== BY ==02  SRT-GSE==.
       COPY GARRRDT6 REPLACING ==01  SRT== BY ==02  SRT-GVT==.
       COPY GARRRDT7 REPLACING ==01  SRT== BY ==02  SRT-GTP==.
       COPY GARRRDT8 REPLACING ==01  SRT== BY ==02  SRT-GUB==.
       COPY GARRRDT9 REPLACING ==01  SRT== BY ==02  SRT-GAP==.
       COPY GARRRD10 REPLACING ==01  SRT== BY ==02  SRT-GDO==.
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY GARRWDT2.
       COPY GARRWDT3.
       COPY GARRWDT4.
       COPY GARRWDT5.
       COPY GARRWDT6.
       COPY GARRWDT7.
       COPY GARRWDT8.
       COPY GARRWDT9.
       COPY GARRWD10.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSWGCPT.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
      *Entidades de SGC
       COPY SGCBRDBC.
      *Entidades de GAR
       COPY GARBRGDG.
       COPY GARBRGLE.
       COPY GARBRGES.
       COPY GARBRGSE.
       COPY GARBRGDD.
       COPY GARBRGVT.
       COPY GARBRGMO.
       COPY GARBRGUB.
       COPY GARBRGTP.
       COPY GARBRGAP.
       COPY GARBRGDO.

       01  WSS-VARI.
           03 WSS-FEC-FPRO.
               05 WSS-FEC-APRO        VALUE ZEROES PIC 9(04).
               05 WSS-FEC-MPRO        VALUE ZEROES PIC 9(02).
               05 WSS-FEC-DPRO        VALUE ZEROES PIC 9(02).
      *
           03 WSS-FEC-RVL.
               05 WSS-FD-RVL          VALUE ZEROES PIC 9(02).
               05 WSS-FM-RVL          VALUE ZEROES PIC 9(02).
               05 WSS-FA-RVL          VALUE ZEROES PIC 9(04).
      *
           03 WSS-COD-OFIC            VALUE SPACES PIC X(03).
           03 WSS-LINEA1              VALUE SPACES PIC X(01).
           03 WSS-LINEA2              VALUE SPACES PIC X(01).
           03 WSS-LINEA3              VALUE SPACES PIC X(01).
           03 WSS-LINEA4              VALUE SPACES PIC X(01).
           03 WSS-LINEA5              VALUE SPACES PIC X(01).
           03 WSS-LINEA6              VALUE SPACES PIC X(01).
           03 WSS-LINEA7              VALUE SPACES PIC X(01).
           03 WSS-LINEA8              VALUE SPACES PIC X(01).
           03 WSS-LINEA9              VALUE SPACES PIC X(01).
           03 WSS-LINEA10             VALUE SPACES PIC X(01).
      *
           03 WSS-MUL-GES             VALUE SPACES PIC X(01).
           03 WSS-STAT-GES            VALUE ZEROES PIC 9(01).
           03 WSS-MUL-GTP             VALUE SPACES PIC X(01).
           03 WSS-STAT-GTP            VALUE ZEROES PIC 9(01).
           03 WSS-MUL-GAP             VALUE SPACES PIC X(01).
           03 WSS-STAT-GAP            VALUE ZEROES PIC 9(01).
      *
           03 WSS-GLS-DETA.
               05 WSS-GLS1-DETA       VALUE SPACES PIC X(30).
               05 WSS-GLS2-DETA       VALUE SPACES PIC X(31).
      *
           03 WSS-COD-PESO            VALUE SPACES PIC X(06).
           03 WSS-VAL-PESO            VALUE ZEROES PIC 99999999999V9999.
      *
           03 WSS-FEC-FANO.
               05 WSS-FEC-SVLD        VALUE ZEROES PIC 9(02).
               05 WSS-FEC-AVLD        VALUE ZEROES PIC 9(02).
      *
           03 WSS-COD-TIT             VALUE ZEROES PIC 9(02).
      *
      *Variables utilizadas para los totales de control
           03 WSS-REG-LCLV            VALUE ZEROES PIC 9(05).
           03 WSS-REG-LGDG            VALUE ZEROES PIC 9(05).
           03 WSS-REG-ISRT            VALUE ZEROES PIC 9(05).

      *FLB CST  25-NOV-1994 
           03 WSS-IIV-EMI.
              05 WSS-TIV-EMI                        PIC X(03).
              05 WSS-CIV-SIV.
                 07 WSS-CIV-EMI                     PIC X(03).
                 07 WSS-SIV-EMI                     PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *Entidades de GAR
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GTP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GAP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *Entidades de USR
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY GARRTDT2.
       COPY GARRTDT3.
       COPY GARRTDT4.
       COPY GARRTDT5.
       COPY GARRTDT6.
       COPY GARRTDT7.
       COPY GARRTDT8.
       COPY GARRTDT9.
       COPY GARRTD10.
      *>>>>
*% END
*% IF FIN_DEC AND PGM_VMS
      *<<<< PGM_VMS
      *<<<< END_DCL
       DEC-PH-DET SECTION.
           USE BEFORE REPORTING PH-DET.
       INI-DEC-PH-DET.
      *<<<< PH_DET

      * Mediante BUS-OFI Obtiene Nombre y Direccion Oficina de Tabla OFI
       PH-OFIC.
      *BUS-OFI Busca Codigo de Tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'OFI' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO OFI-GLS-DESC IN OFI.
           MOVE GDG-COD-OFI IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFI IN WSS-DET.
       FIN-DEC-PH-DET.

*% IF PGM_VMS
*% FLD = 'SALTO'
*% INCLUDE 'GARSRC:BUSTABVAX.SRC'
*% INCLUDE 'GARSRC:BUSOFIVAX.SRC'
*% END
       FIN-CF-{RPT}-{FLD}.
      *>>>>
*% END
*% IF PH_{RPT} AND ( PGM_DOS OR PGM_MVS )
      *<<<< PH_{RPT}
*% INCLUDE 'GARSRC:BUSOFILIS.SRC'
      *>>>>
*% END
*% IF INI
      *<<<< INI

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-CAM.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM TAB-FIO-CAM.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GVT.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GES.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GLE.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GLE.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GDD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GMO.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GMO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GSE.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GSE.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GAP.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GAP.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GTP.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GTP.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDO.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GDO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GUB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GAR-FIO-GUB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'SGC'   TO FIO-SIST.
           PERFORM SGC-FIO-DBC.

      *<<<<
           DISPLAY 'CODIGO DE GARANTIAS A LISTAR  : '.
           ACCEPT WSS-COD-TIT IN WSS-VARI.
           DISPLAY WSS-COD-TIT IN WSS-VARI.
      *BUS-TAB Busca Glosa de Titulo Para el Listado
           IF WSS-COD-TIT IN WSS-VARI > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'MSC' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TIT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                  MOVE TAB-GLS-DESC IN TAB TO 
                       WSS-GLS-TIT IN WSS-{RPT}
               ELSE
                  MOVE SPACES TO WSS-GLS-TIT IN WSS-{RPT}
           ELSE
               MOVE SPACES TO WSS-GLS-TIT IN WSS-{RPT}.

*% INCLUDE 'GARSRC:LEEFECPRO.SRC'
      *>>>>
*% END
*% IF FIN
      *<<<< FIN
           PERFORM CLO-FIL-VSAM.
           DISPLAY '  TOTALES DE CONTROL'
           DISPLAY '======================'
           DISPLAY 'REG. LEIDOS  CLV     : ' WSS-REG-LCLV.
           DISPLAY 'REG. LEIDOS  GDG     : ' WSS-REG-LGDG.
           DISPLAY 'REG. INGRES. AL SRT  : ' WSS-REG-ISRT.
           DISPLAY '======================'
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
      *Se salta la apertura del archivo base porque no permite
      *hacerle un FIO-ACC... a un archivo secuencial y tampoco
      *un FIO-GET-FST.
           GO TO FIN-FST-INP.
      *>>>>
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
       FIN-FST-INP.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-CLV.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-CLV.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           ADD 1 TO WSS-REG-LCLV.

      *Busca Llaves del GDG
           MOVE GAR-NUM-SIS IN CLV TO GAR-NUM-SIS IN GDG.
           MOVE GAR-COD-CRR IN CLV TO GAR-COD-CRR IN GDG.
           MOVE 'GAR' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS 
               GO TO FIN-INP-SRT
           ELSE
               ADD 1 TO WSS-REG-LGDG.

           ADD 1 TO WSS-REG-ISRT.

*% INCLUDE 'GARSRC:BUSGLELIS.SRC'
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-FEC-PFN IN GLE 
                              GAR-NUM-ICR IN GLE
                              GAR-ANO-ICR IN GLE
                              GAR-NUM-PHB IN GLE
                              GAR-ANO-PHB IN GLE.

*% INCLUDE 'GARSRC:BUSGSELIS.SRC'
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-FEC-VTO-SEG IN GSE
                              GAR-FEC-VIG-SEG IN GSE
                              GAR-VAL-SEG IN GSE.
*% GDG = TRUE
*% INCLUDE 'GARSRC:BUSGVTLIS.SRC'
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-VAL-AJT-SUP IN GVT
                              GAR-VAL-CML-TSN IN GVT
                              GAR-VAL-LIQ-TSN IN GVT
                              GAR-PCT-PON IN GVT
                              GAR-VAL-PON IN GVT
                              GAR-FEC-TSN IN GVT
                              GAR-FEC-RVL IN GVT
                              GAR-COD-TSN IN GVT.

*% INCLUDE 'GARSRC:BUSGUBLIS.SRC'      
*% INCLUDE 'GARSRC:BUSGDOLIS.SRC'
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-FD-CAP IN GDO.
      *JVM-BFA 03-03-93 AUN NO ESTA LEIDO GDD
            MOVE SPACES TO GDD.
            MOVE ZEROES TO GAR-VAL-LIM-DDR IN GDD
                           GAR-PCT-LIM-DDR IN GDD.
      *>>>>
*% END
*% IF RM
      *<<<< RM
       COPY GARRMDT2.
       COPY GARRMDT4.
       COPY GARRMDT5.
       COPY GARRMDT6.
       COPY GARRMDT8.
       COPY GARRMD10.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT

      *Busca Rut del Dueno
           IF GDG-IIC-ICLI IN SRT > ZEROES
               MOVE SPACES TO DBC
               MOVE GDG-CAI-ICLI IN SRT TO DBC-CAI-ICLI IN DBC
               MOVE GDG-IIC-ICLI IN SRT TO DBC-IIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLI IN WSS-DET
                   MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLI IN WSS-DET
                   MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLI IN WSS-DET
                   MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLI IN WSS-DET
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO WSS-GLS-NOMC IN WSS-DET
               ELSE
                   MOVE SPACES TO WSS-IND-ICLI IN WSS-DET
                                  WSS-GLS-ICLI IN WSS-DET
                   MOVE '0'    TO WSS-VRF-ICLI IN WSS-DET
                   MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DET
                   MOVE SPACES TO WSS-GLS-NOMC IN WSS-DET
           ELSE
               MOVE SPACES TO WSS-IND-ICLI IN WSS-DET
                              WSS-GLS-ICLI IN WSS-DET
               MOVE '0'    TO WSS-VRF-ICLI IN WSS-DET
               MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DET
               MOVE SPACES TO WSS-GLS-NOMC IN WSS-DET.

*% GDG = FALSE
*% INCLUDE 'GARSRC:BUSTIPLIS.SRC'
*% INCLUDE 'GARSRC:BUSSTPLIS.SRC'
*% INCLUDE 'GARSRC:BUSVLRLIS.SRC'
*% INCLUDE 'GARSRC:BUSLIMLIS.SRC'
*% LRG = 12
*% INCLUDE 'GARSRC:BUSALZLIS.SRC'

*% LRG = 12
*% RPT = 'DT4'
*% INCLUDE 'GARSRC:BUSABGLIS.SRC'
*% INCLUDE 'GARSRC:BUSNTRLIS.SRC'

      *Mueve Glosa a campo Instrumento
           IF GLE-IND-PUB-PRV IN SRT > SPACES
               IF GLE-IND-PUB-PRV IN SRT = 'U'
                   MOVE 'PUBLICO' TO WSS-GLS-PUB-PRV IN WSS-DT4
               ELSE 
                   IF GLE-IND-PUB-PRV IN SRT = 'V'
                       MOVE 'PRIVADO' TO WSS-GLS-PUB-PRV IN WSS-DT4
                   ELSE
                       MOVE SPACES TO WSS-GLS-PUB-PRV IN WSS-DT4
           ELSE
               MOVE SPACES TO WSS-GLS-PUB-PRV IN WSS-DT4.

*% RPT = 'DT5'
*% INCLUDE 'GARSRC:BUSCIALIS.SRC'
*% INCLUDE 'GARSRC:BUSRPBLIS.SRC'
*% INCLUDE 'GARSRC:BUSCRDLIS.SRC'

      *BUS-TAB Busca Glosa de Valor de Cambio del Seguro
           IF GSE-VCB-SEG IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               MOVE GSE-VCB-SEG IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DCOR IN TAB TO 
                         WSS-GLS-VCB-SEG IN WSS-DT5
               ELSE
                    MOVE SPACES TO WSS-GLS-VCB-SEG IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-VCB-SEG IN WSS-DT5.

      *BUS-TAB Busca Glosa de Cobertura de Seguro 1
           IF GSE-COD-COB-1 IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-1 IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO 
                        WSS-GLS-COB1 IN WSS-DT5
               ELSE
                   MOVE SPACES TO WSS-GLS-COB1 IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-COB1 IN WSS-DT5.

      *BUS-TAB Busca Glosa de Cobertura de Seguro 2
           IF GSE-COD-COB-2 IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-2 IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO 
                        WSS-GLS-COB2 IN WSS-DT5
               ELSE
                   MOVE SPACES TO WSS-GLS-COB2 IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-COB2 IN WSS-DT5.

      *BUS-TAB Busca Glosa de Cobertura de Seguro 3
           IF GSE-COD-COB-3 IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-3 IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO 
                        WSS-GLS-COB3 IN WSS-DT5
               ELSE
                   MOVE SPACES TO WSS-GLS-COB3 IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-COB3 IN WSS-DT5.

      *BUS-TAB Busca Glosa de Cobertura de Seguro 4
           IF GSE-COD-COB-4 IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-4 IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO 
                        WSS-GLS-COB4 IN WSS-DT5
               ELSE
                   MOVE SPACES TO WSS-GLS-COB4 IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-COB4 IN WSS-DT5.

      *BUS-TAB Busca Glosa de Cobertura de Seguro 5
           IF GSE-COD-COB-5 IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-5 IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO 
                        WSS-GLS-COB5 IN WSS-DT5
               ELSE
                   MOVE SPACES TO WSS-GLS-COB5 IN WSS-DT5
           ELSE
               MOVE SPACES TO WSS-GLS-COB5 IN WSS-DT5.

*% RPT = 'DT6'
      *BUS-TAB Busca Glosa de Tipo de Construccion
           IF GVT-TIP-CTR IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CTR' TO TAB-COD-TTAB IN TAB
               MOVE GVT-TIP-CTR IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES               
                    MOVE TAB-GLS-DESC IN TAB TO 
                         WSS-GLS-TCTR IN WSS-DT6
               ELSE
                    MOVE SPACES TO WSS-GLS-TCTR IN WSS-DT6
           ELSE
               MOVE SPACES TO WSS-GLS-TCTR IN WSS-DT6.

      * CALCULA VALOR ULTIMA CONTABILIZACION
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'TAB'          TO MSG-COD-SIST
      *         MOVE 'CIC0999  NEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

       INI-OBT-VAL-CON.
           MOVE GDG-VCB IN SRT TO GAR-VCB IN GDG.
           IF NOT (
              GAR-TIP-VCB IN GDG = '0' AND
              GDG-VCB IN SRT NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-VAL-AJT-SUP IN SRT TO
                    WSS-VAL-ULT-CON IN WSS-DT6
               GO TO FIN-OBT-VAL-CON.

           MOVE GVT-FA-RVL   IN SRT      TO WSS-FEC-FANO.
           MOVE WSS-FEC-SVLD             TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-FEC-AVLD             TO CAM-NUM-ACAM IN CAM(1).
           MOVE GVT-FM-RVL   IN SRT      TO CAM-NUM-MCAM IN CAM(1).
           MOVE GVT-FD-RVL   IN SRT      TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-VCB      IN SRT      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
                GO TO FIN-OBT-VAL-CON
      *         MOVE 'TAB'        TO MSG-COD-SIST
      *         MOVE 'CAM    NEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-VAL-AJT-SUP IN SRT
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO WSS-VAL-ULT-CON IN WSS-DT6.
       FIN-OBT-VAL-CON.

*% INCLUDE 'GARSRC:BUSSVSLIS.SRC'

*% INCLUDE 'GARSRC:BUSTSDLIS.SRC'

             
*% RPT = 'DT8'
*% INCLUDE 'GARSRC:BUSAGTLIS.SRC'

*% INCLUDE 'GARSRC:BUSCMNLIS.SRC'

*% INCLUDE 'GARSRC:BUSUBILIS.SRC'

*% LRG = 12
*% INCLUDE 'GARSRC:BUSALMLIS.SRC'

*% RPT = 'D10'
*% LRG = 40

      *BUS-TAB Busca Glosa de Tipo de Documento
           IF GDO-TIP-DOC IN SRT > SPACES
*% IF NOT PGM_CHI
      *<<<< NOT PGM_CHI
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'DOC' TO TAB-COD-TTAB IN TAB
      *>>>>
*% ELSE
      *<<<< PGM_CHI
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
      *>>>>
*% END
               MOVE GDO-TIP-DOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DCOR IN TAB TO 
                           WSS-GLS-TIP-DOC IN WSS-D10
               ELSE
                    MOVE SPACES TO WSS-GLS-TIP-DOC IN WSS-D10
           ELSE
               MOVE SPACES TO WSS-GLS-TIP-DOC IN WSS-D10.

*% INCLUDE 'GARSRC:BUSIEMLIS.SRC'
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *
      ***************** I M P R I M E   G D D *********************           

           GENERATE HDR-GDD.

           MOVE GDG-NUM-SIS IN SRT TO GAR-NUM-SIS IN GDD.
           MOVE GDG-COD-CRR IN SRT TO GAR-COD-CRR IN GDD.
           MOVE 'GAR-CLV-GDD-2' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GDD AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GDD
               PERFORM LUP-IMP-GDD
           ELSE
                PERFORM CLEAR-GDD
                MOVE 'NO TIENE DEUDORES ' TO WSS-MSG-DETA IN WSS-DT2
                GENERATE GDD-MSG.
           
      ***************** I M P R I M E  G E S *********************           

           GENERATE HDR-GES.

           MOVE GDG-NUM-SIS IN SRT TO GAR-NUM-SIS IN GES.
           MOVE GDG-COD-CRR IN SRT TO GAR-COD-CRR IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GES AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GES
               PERFORM LUP-IMP-GES
           ELSE
                PERFORM CLEAR-GES
                MOVE SPACES TO WSS-GLS-DETA IN WSS-VARI
                MOVE 'NO  EXISTEN  DATOS  DE  ESPECI' TO 
                     WSS-GLS1-DETA IN WSS-VARI
                MOVE 'FICACION  PARA  ESTA  GARANTIA'  TO
                     WSS-GLS2-DETA IN WSS-VARI
                MOVE WSS-GLS-DETA IN WSS-VARI TO 
                     WSS-MSG-DETA IN WSS-DT3
                GENERATE GES-MSG.
           
       LIS-RESTO-1.
           GENERATE DL-DT4.
           GENERATE DL-DT5.
           GENERATE DL-DT6.

      ***************** I M P R I M E  G T P *********************           

           GENERATE HDR-GTP.
           MOVE GDG-NUM-SIS IN SRT TO GAR-NUM-SIS IN GTP.
           MOVE GDG-COD-CRR IN SRT TO GAR-COD-CRR IN GTP.
           MOVE GDG-COD-TSN IN SRT TO GAR-COD-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GTP AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GTP
               PERFORM LUP-IMP-GTP
           ELSE
               PERFORM CLEAR-GTP
               MOVE SPACES TO WSS-GLS-DETA IN WSS-VARI
               MOVE 'NO  EXISTEN  TASACIONES  PARCI' TO 
                    WSS-GLS1-DETA IN WSS-VARI
               MOVE 'ALES  PARA  ESTA  GARANTIA'  TO
                    WSS-GLS2-DETA IN WSS-VARI
               MOVE WSS-GLS-DETA IN WSS-VARI TO 
                    WSS-MSG-DETA IN WSS-DT7
               GENERATE GTP-MSG.


       LIS-RESTO-2.
           GENERATE DL-DT8.

      ***************** I M P R I M E  G A P *********************           

           GENERATE HDR-GAP.
           MOVE GDG-NUM-SIS IN SRT TO GAR-NUM-SIS IN GAP.
           MOVE GDG-COD-CRR IN SRT TO GAR-COD-CRR IN GAP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GAP AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GAP
               PERFORM LUP-IMP-GAP
           ELSE
               PERFORM CLEAR-GAP
               MOVE SPACES TO WSS-GLS-DETA IN WSS-VARI
               MOVE 'NO  EXISTEN  ACREEDORES  PREFE' TO 
                    WSS-GLS1-DETA IN WSS-VARI
               MOVE 'RENCIALES  PARA  ESTA  GARANTIA'  TO
                    WSS-GLS2-DETA IN WSS-VARI
               MOVE WSS-GLS-DETA IN WSS-VARI TO
                    WSS-MSG-DETA IN WSS-DT9
               GENERATE GAP-MSG.

       LIS-RESTO-3.
           GENERATE DL-D10.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF

      ************************** G D D **************************
       LUP-IMP-GDD SECTION.
       INI-LUP-IMP-GDD.
      *   mueve datos
       COPY GARRMDT2.

      *Busca Rut y Nombre del Deudor
           IF GDD-IIC-ICLI IN SRT > ZEROES
               MOVE GDD-CAI-ICLI IN SRT TO DBC-CAI-ICLI IN DBC
               MOVE GDD-IIC-ICLI IN SRT TO DBC-IIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLI IN WSS-DT2
                   MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLI IN WSS-DT2
                   MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLI IN WSS-DT2
                   MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLI IN WSS-DT2
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO WSS-GLS-NOMC IN WSS-DT2
               ELSE
                   MOVE SPACES TO WSS-IND-ICLI IN WSS-DT2
                                  WSS-GLS-ICLI IN WSS-DT2
                   MOVE '0'    TO WSS-VRF-ICLI IN WSS-DT2
                   MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DT2
                   MOVE SPACES TO WSS-GLS-NOMC IN WSS-DT2
           ELSE
               MOVE SPACES TO WSS-IND-ICLI IN WSS-DT2
                              WSS-GLS-ICLI IN WSS-DT2
               MOVE '0'    TO WSS-VRF-ICLI IN WSS-DT2
               MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DT2
               MOVE SPACES TO WSS-GLS-NOMC IN WSS-DT2.

      * imprime linea con datos de GDD
           GENERATE DL-DT2.

      *   lee siguiente
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GDD AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GDD
               GO TO INI-LUP-IMP-GDD.
       FIN-LUP-IMP-GDD.
           EXIT.

       CLEAR-GDD SECTION.
       INI-CLEAR-GDD.
      *Limpia Registros del Reporte
           MOVE SPACES TO GDG-COD-EJE-ORI IN SRT.
           MOVE SPACES TO DBC-COD-EJEC IN SRT.
           MOVE ZEROES TO GDD-VAL-LIM-DDR IN SRT.
           MOVE ZEROES TO GDD-PCT-LIM-DDR IN SRT.
       FIN-CLEAR-GDD.
           EXIT.
      ************************** G E S **************************

       LUP-IMP-GES SECTION.
       INI-LUP-IMP-GES.

      *   mueve datos
       COPY GARRMDT3.

*% RPT = 'DT3'
*% INCLUDE 'GARSRC:BUSVCCLIS.SRC'

      * imprime linea con datos de ges
           GENERATE DL-DT3.

      *   lee siguiente
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GES AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GES
               GO TO INI-LUP-IMP-GES.
       FIN-LUP-IMP-GES.
           EXIT.

       CLEAR-GES SECTION.
       INI-CLEAR-GES.
      *Limpia Registros del Reporte
           MOVE SPACES TO GES-VCB-CDT IN SRT.
           MOVE ZEROES TO GES-COD-ESP IN SRT.
           MOVE SPACES TO GDG-COD-TIP-ESP IN SRT.
           MOVE SPACES TO GES-CIC-IOPC IN SRT.
           MOVE SPACES TO GES-COD-DST-CDT IN SRT.
           MOVE SPACES TO GES-COD-SIS-CDT IN SRT.
           MOVE ZEROES TO GES-FD-VTO-CDT IN SRT.
           MOVE ZEROES TO GES-FM-VTO-CDT IN SRT.
           MOVE ZEROES TO GES-FA-VTO-CDT IN SRT.
           MOVE ZEROES TO GES-VAL-LIM-CDT IN SRT.
           MOVE ZEROES TO GES-PCT-LIM-CDT IN SRT.
       FIN-CLEAR-GES.
           EXIT.

      ************************** G T P **************************

       LUP-IMP-GTP SECTION.
       INI-LUP-IMP-GTP.
      *   mueve datos
       COPY GARRMDT7.

      *BUS-TAB Busca Glosa de Estado de la Garantia
           IF GTP-COD-EST-ITM IN SRT > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GTP-COD-EST-ITM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES
                  MOVE TAB-GLS-DESC IN TAB TO 
                       WSS-GLS-EST-ITM IN WSS-DT7
               ELSE
                  MOVE SPACES TO WSS-GLS-EST-ITM IN WSS-DT7
           ELSE
               MOVE SPACES TO WSS-GLS-EST-ITM IN WSS-DT7.

      * imprime linea con datos de GTP
           GENERATE DL-DT7.

      *   lee siguiente
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GTP AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GTP
               GO TO INI-LUP-IMP-GTP.
       FIN-LUP-IMP-GTP.
           EXIT.

       CLEAR-GTP SECTION.
       INI-CLEAR-GTP.
      *Limpia Registros del Reporte
           MOVE SPACES TO GTP-COD-ITM-TSN IN SRT.
           MOVE SPACES TO GTP-IDN-ITM-TSN IN SRT.
           MOVE ZEROES TO GTP-CTD-ITM-TSN IN SRT.
           MOVE ZEROES TO GTP-VAL-UNT-ITM IN SRT.
           MOVE ZEROES TO GTP-FD-CMB-EST IN SRT.
           MOVE ZEROES TO GTP-FM-CMB-EST IN SRT.
           MOVE ZEROES TO GTP-FA-CMB-EST IN SRT.
           MOVE SPACES TO GTP-COD-EST-ITM IN SRT.
       FIN-CLEAR-GTP.
           EXIT.

      ************************** G A P **************************

       LUP-IMP-GAP SECTION.
       INI-LUP-IMP-GAP.
      *   mueve datos
       COPY GARRMDT9.

      *Busca Rut y Nombre del Acreedor Preferente
           IF GAP-IIC-ICLI IN SRT > ZEROES
               MOVE GAP-CAI-ICLI IN SRT TO DBC-CAI-ICLI IN DBC
               MOVE GAP-IIC-ICLI IN SRT TO DBC-IIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLI IN WSS-DT9
                   MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLI IN WSS-DT9
                   MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLI IN WSS-DT9
                   MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLI IN WSS-DT9
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO WSS-GLS-NOMC IN WSS-DT9
               ELSE
                   MOVE SPACES TO WSS-IND-ICLI IN WSS-DT9
                                  WSS-GLS-ICLI IN WSS-DT9
                   MOVE '0'    TO WSS-VRF-ICLI IN WSS-DT9
                   MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DT9
                   MOVE SPACES TO WSS-GLS-NOMC IN WSS-DT9
           ELSE
               MOVE SPACES TO WSS-IND-ICLI IN WSS-DT9
                              WSS-GLS-ICLI IN WSS-DT9
               MOVE '0'    TO WSS-VRF-ICLI IN WSS-DT9
               MOVE ZEROES TO WSS-NUM-ICLI IN WSS-DT9
               MOVE SPACES TO WSS-GLS-NOMC IN WSS-DT9.

      * imprime linea con datos de GAP
           GENERATE DL-DT9.

      *   lee siguiente
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF FIO-STAT-OKS AND
              GDG-NUM-SIS IN SRT = GAR-NUM-SIS IN GAP AND
              GDG-COD-CRR IN SRT = GAR-COD-CRR IN GAP
               GO TO INI-LUP-IMP-GAP.
       FIN-LUP-IMP-GAP.
           EXIT.

       CLEAR-GAP SECTION.
       INI-CLEAR-GAP.
      *Limpia Registros del Reporte
           MOVE SPACES TO GAP-CAI-ICLI IN SRT.
           MOVE SPACES TO GAP-IIC-ICLI IN SRT.
           MOVE SPACES TO GAP-COD-PRD-ACR IN SRT.
           MOVE SPACES TO GAP-FOJ-ICR-ACR IN SRT.
           MOVE ZEROES TO GAP-NUM-ICR-ACR IN SRT.
           MOVE ZEROES TO GAP-ANO-ICR-ACR IN SRT.
           MOVE ZEROES TO GAP-VAL-ACR-PRF IN SRT.
       FIN-CLEAR-GAP.
           EXIT.
      **************************************************

      *Entidades de SGC
       COPY SGCBFDBC.

      *Entidades de GAR
       COPY GARBFGDG.
       COPY GARBFGDD.
       COPY GARBFGVT.
       COPY GARBFGSE.
       COPY GARBFGES.
       COPY GARBFGLE.
       COPY GARBFGMO.
       COPY GARBFGUB.
       COPY GARBFGAP.
       COPY GARBFGDO.
       COPY GARBFGTP.

      *Entidades de TAB
*% IF NOT PGM_VMS
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
*% END
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBFCAM.

      *Entidades de GNS
*% IF NOT PGM_VMS
       COPY GNSBBTAB.
       COPY GNSBBMSG.
*% END
       COPY GNSBGCPT.
       CLO-FIL-VSAM SECTION
       INI-CLO-FIL-VSAM.
           MOVE FIO-CLO TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM TAB-FIO-OFI.

           PERFORM GNS-FIO-TAB.

           PERFORM TAB-FIO-CAM.

           MOVE 'GAR'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           PERFORM GAR-FIO-GVT.

           PERFORM GAR-FIO-GDG.

           PERFORM GAR-FIO-GES.

           PERFORM GAR-FIO-GLE.

           PERFORM GAR-FIO-GDD.

           PERFORM GAR-FIO-GMO.

           PERFORM GAR-FIO-GSE.

           PERFORM GAR-FIO-GAP.

           PERFORM GAR-FIO-GTP.

           PERFORM GAR-FIO-GDO.

           PERFORM GAR-FIO-GUB.

           MOVE 'SGC'   TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
       FIN-CLO-FIL-VSAM.
           EXIT.
      *>>>>
*% END
