*% NO_HDR_CST = TRUE
*% IF PGM_DTC AND PGM_UVS
*% INCLUDE 'GARSRC:GNSVSIDTC.SRC'
*% END
*%! HASTA AQUI PARA MANEJAR VSAM EN AMBIENTE DTC
*%! PARA MANEJAR DTC EN AMBIENTE VSAM
*%! IF WSS AND PGM_VSI
*%!       COPY GNSWGRQA.
*%!       COPY GNSWGUIB.
*%!       COPY GNSWGELS.
*%! END
*%! IF PGM_INIT AND PGM_VSI
*%!       COPY GNSBGEDB.
*%! END
*%! IF EOF AND PGM_VSI
*%!       COPY GNSBGDTC.
*%! END
*%! PARA MANEJAR DTC EN AMBIENTE VSAM
*% FRM = 'GLE'
*% REG = 'GLE'
*% HIJ = 'GDG'
*% CAIREG = 'GAR-NUM-SIS'
*% IICREG = 'GAR-COD-CRR'
*% CAIFLD = 'GLE-NUM-SIS'
*% IICFLD = 'GLE-COD-CRR'
*% SISREG = 'GAR'
*%! Codigo adicional para Funcion GARPPVCG = PF5
*% INCLUDE 'GARSRC:PFALL5.SRC'
*%! Codigo adicional para archivo
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
              05 {CAIREG}              PIC X(04).
              05 {IICREG}              PIC X(08).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GARBRGDG.
       COPY GARBRTAG.
       COPY GARWGVCG.
*% IF PGM_VAX
      *<<<< PGM_VAX
           03 WSS-REG                          PIC X(03).
      *>>>>
*% END
*% IF PGM_CHI AND PGM_PQ
      *<<<< PGM_CHI AND PGM_PQ
           COPY USPC113.
      *>>>>
*% END
       01  WSS-VARI.
           03 WSS-LOC-REG.
              05 WSS-COD-REG   VALUE SPACES             PIC X(02).
              05 WSS-COD-LOC   VALUE SPACES             PIC X(04).
*% IF PGM_PU
      *<<<< PGM_PU
           03 WSS-HOY-FHOY.
              05  WSS-SA-FHOY                       PIC 9(04).
              05  WSS-REST                          PIC 9(04).
      *>>>>
*% END
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
*% END
      *>>>>
*% END
*% IF PGM_ARG
*% LARGO_MI_COMMAREA = 15
*% ELSE
*% LARGO_MI_COMMAREA = 12
*% END
*% IF INI_FIO AND PGM_VAX
      *<<<< INI_FIO AND PGM-VAX

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-{HIJ}.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-{HIJ}.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE '{SISREG}'        TO FIO-SIST.
           PERFORM {SISREG}-FIO-TAG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-TAG.

      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
*% FIN_BUS_HIJ = TRUE
*% INCLUDE 'GARSRC:INIFNDKE1.SRC'
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
*% INCLUDE 'GARSRC:FINFNDKE1.SRC'
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
*% INCLUDE 'GARSRC:LIMFLD.SRC'
           MOVE SPACES TO {SISREG}-IIV-ABG IN {REG}.
           MOVE SPACES TO {SISREG}-IIV-NTR IN {REG}.
           MOVE SPACES TO {SISREG}-ROL-SII IN {REG}.
           MOVE SPACES TO {SISREG}-IND-PUB-PRV IN {REG}.
           MOVE ZEROES TO GAR-FEC-PFN IN {REG}.
           MOVE SPACES TO {SISREG}-FOJ-ICR IN {REG}.
           MOVE ZEROES TO GAR-NUM-ICR IN {REG}.
           MOVE ZEROES TO GAR-ANO-ICR IN {REG}.
           MOVE SPACES TO {SISREG}-FOJ-PHB IN {REG}.
           MOVE ZEROES TO GAR-NUM-PHB IN {REG}.
           MOVE ZEROES TO GAR-ANO-PHB IN {REG}.
           MOVE SPACES TO {SISREG}-COD-REG IN {REG}.
           MOVE SPACES TO {SISREG}-LOC-REG IN {REG}.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< INI_CMN_ING OR INI_CMN_MOD
*% INCLUDE 'GARSRC:STDFLD.SRC'
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : informar               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
*% INCLUDE 'GARSRC:FINCMNING.SRC'
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE {CAIREG} IN {REG} TO {CAIREG} IN {HIJ}.
           MOVE {IICREG} IN {REG} TO {IICREG} IN {HIJ}.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM {SISREG}-FIO-{HIJ}.
           IF FIO-STAT-OKS
               MOVE ' ' TO GAR-IND-EXI-{REG} IN {HIJ}
               MOVE FIO-MOD TO FIO-CMND
               PERFORM {SISREG}-FIO-{HIJ}.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY {SISREG}BF{HIJ}.
       COPY {SISREG}BFTAG.

       COPY GARBGVCG.
       COPY GARBKVCG.

      *>>>>
*% END

