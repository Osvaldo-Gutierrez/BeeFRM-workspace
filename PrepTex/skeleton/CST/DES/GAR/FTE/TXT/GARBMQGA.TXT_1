*% FRM = 'QGA'
*% REG = 'QGA'
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-IND-ICLI IN {FRM}-FLD = 'M'
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDGNOMDDIR'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN {FRM}-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN {FRM}-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN {FRM}-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN {FRM}-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN {FRM}-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN {FRM}-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        DBC-IIC-ICLI IN {FRM}-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN {FRM}-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_QGA
      *<<<< INI_VAL_CON_KEY_QGA
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-QGA.
      *>>>>
*% END
*% IF FIN_PUT_GDG_QGA
      *<<<< FIN_PUT_GDG_QGA
      *BUS-TAB BUSCA GLOSA DE CODIGO EN TABLA
           IF GDG-ES1 IN {FRM}-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES1 IN {FRM}-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN {FRM}-FLD.
*% VALIDA = FALSE
*% FINPARRAFO = 'FIN-PUT-GDG-QGA'
*% INCLUDE 'GARSRC:BUSSTP.SRC'
*% EXA_VEN_TSN = TRUE
*% INCLUDE 'GARSRC:BUSRAL.SRC'

      *BUS-FEC Obtiene fecha de vencto. del credito cuando corresponde
           MOVE GAR-CLV-GDG-1 IN GDG TO GAR-CLV-GES-1 IN GES
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF FIO-STAT-OKS AND
              GAR-ID IN GES = GAR-CLV-GDG-1 IN GDG AND
              GAR-COD-CRR-CDT IN GES > ZEROES
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES
               MOVE GAR-NUM-SIS-CDT IN GES TO DLC-CAI-IOPC IN DLC
               MOVE GAR-COD-CRR-CDT IN GES TO DLC-IIC-IOPC IN DLC
*% IF PGM_ARG
      *<<<< PGM_ARG
               MOVE GAR-NUM-DOC-CDT IN GES TO WSS-NUM-IDLC-903
               MOVE WSS-NUM-IDLC-903       TO DLC-NUM-IDLC IN DLC
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
               MOVE GAR-NUM-DOC-CDT IN GES TO DLC-NUM-IDLC IN DLC
      *>>>>
*% END
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF FIO-STAT-OKS
                   MOVE DLC-NUM-DMAV IN DLC TO FRM-NUM-DVEN
                   MOVE DLC-NUM-MMAV IN DLC TO FRM-NUM-MVEN
                   MOVE DLC-NUM-SMAV IN DLC TO FRM-NUM-SVEN
                   MOVE DLC-NUM-AMAV IN DLC TO FRM-NUM-AVEN
               ELSE
                   MOVE ZEROES TO FRM-NUM-DVEN
                   MOVE ZEROES TO FRM-NUM-MVEN
                   MOVE ZEROES TO FRM-NUM-SVEN
                   MOVE ZEROES TO FRM-NUM-AVEN
           ELSE
               MOVE ZEROES TO FRM-NUM-DVEN
               MOVE ZEROES TO FRM-NUM-MVEN
               MOVE ZEROES TO FRM-NUM-SVEN
               MOVE ZEROES TO FRM-NUM-AVEN
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM GAR-FIO-GES.

      *FLB CST  18-OCT-1993 SOLICITADO POR BCI
           IF GAR-IND-CPL IN GDG NOT = 'S' 
               MOVE 'N' TO GDG-IND-CPL IN QGA-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_{FRM}
      *<<<< FIN_PUT_DBC_{FRM}
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN {FRM}-FLD.

*% IF NOT PGM_BFA
      *<<<< NOT PGM_BFA
      * BUSCA FIANZA, ESTO NO ES GENERICO
*% LEE_HOY = TRUE
*% INCLUDE 'GARSRC:BUSFIA.SRC'
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_PUT_GVT_QGA
      *<<<< INI_PUT_GVT_QGA
           IF PGM-STAT-GDG-OKS AND 
              GAR-IND-EXI-GVT IN GDG = 'S'
               MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT
               MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT
               MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GVT
               MOVE FIO-STAT TO PGM-STAT-GVT
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'GVT    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GVT-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GVT.
      *>>>>
*% END
*% IF FIN_PUT_GVT_QGA
      *<<<< FIN_PUT_GVT_QGA
           IF NOT PGM-STAT-TAG-OKS
               GO TO FIN-PUT-GVT-QGA.

      * SE DETERMINA SI LA TASACION ESTA VENCIDA O NO

*% FIN_EXA_VTO_TAS = 'FIN-EXA-VEN-TSN'
*% FEC_FVTA = 'WSS-FEC-FVTA'
*% FEC_DVTA = 'WSS-FEC-DVTA'
*% FEC_MVTA = 'WSS-FEC-MVTA'
*% FEC_AVTA = 'WSS-FEC-AVTA'
*% FEC_SVTA = 'WSS-FEC-SVTA'
*% FEC_FCTA = 'HOY-FHOY'
*% LEE_HOY = FALSE
*%! CON LEE_HOY = FALSE NO LEE FECHA-HOY, PORQUE YA LO HIZO EN BUS-FIA
*% INCLUDE 'GARSRC:EXAVENTSN.SRC'
      *>>>>
*% END
*% IF INI_PUT_GDO_QGA
      *<<<< INI_PUT_GDO_QGA
           IF PGM-STAT-GDG-OKS AND 
              GAR-IND-EXI-GDO IN GDG = 'S'
               MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDO
               MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDO
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GDO
               MOVE FIO-STAT TO PGM-STAT-GDO
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'GDO    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GDO-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GDO.
      *>>>>
*% END
*% IF FIN_PUT_GDO_QGA
      *<<<< FIN_PUT_GDO_QGA
*% VALIDA = FALSE
*% INCLUDE 'GARSRC:BUSEMI.SRC'
*% IF NOT PGM_PER
      *<<<< NOT PGM_PER
      *    VALORIZA EL DEPOSITO A PLAZO, SI CORRESPONDE
           MOVE SPACES TO INT-TIPT.
           PERFORM VLR-DAP.
           IF INT-TIPT > SPACES
               MOVE GAR-VAL-CML-TSN IN GVT TO GVT-VAL-CML-TSN IN QGA-FLD
               MOVE GAR-VAL-LIQ-TSN IN GVT TO GVT-VAL-LIQ-TSN IN QGA-FLD
               MOVE GAR-VAL-PON     IN GVT TO GVT-VAL-PON 
                                                  IN QGA-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_PUT_GLE_QGA
      *<<<< INI_PUT_GLE_QGA
           IF PGM-STAT-GDG-OKS AND 
              GAR-IND-EXI-GLE IN GDG = 'S'
               MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GLE
               MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GLE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GLE
               MOVE FIO-STAT TO PGM-STAT-GLE
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'GLE    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GLE-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GLE.
      *>>>>
*% END
*% IF INI_PUT_GSE_QGA
      *<<<< INI_PUT_GSE_QGA
           IF PGM-STAT-GDG-OKS AND 
              GAR-IND-EXI-GSE IN GDG = 'S'
               MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSE
               MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GSE
               MOVE FIO-STAT TO PGM-STAT-GSE
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'GSE    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GSE-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GSE.
      *>>>>
*% END
*% IF FIN_PUT_GSE_QGA
      *<<<< FIN_PUT_GSE_QGA
      * SE DETERMINA SI EL SEGURO ESTA VENCIDO O NO

*% FIN_EXA_VTO_SEG = 'FIN-EXA-VEN-SEG'
*% FEC_FCSE = 'HOY-FHOY'
*% VLR_CRE  = TRUE
*% LEE_GSE  = FALSE
*% INCLUDE 'GARSRC:EXAVENSEG.SRC'
      *>>>>
*% END
*% IF INI_PUT_GUB_QGA
      *<<<< INI_PUT_GUB_QGA
           IF PGM-STAT-GDG-OKS AND 
              GAR-IND-EXI-GUB IN GDG = 'S'
               MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GUB
               MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GUB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GUB
               MOVE FIO-STAT TO PGM-STAT-GUB
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'GUB    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GUB-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GUB.
      *>>>>
*% END
*% IF FIN_PUT_ALL_QGA
      *<<<< FIN_PUT_ALL_QGA
           IF FRM-MENS = SPACES AND MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

      * LA VALORIZACION DE GARANTIAS ESPECIFICAS DEBE HACERSE AQUI, PUES DEBE 
      * HABERSE CALCULADO PREVIA Y EVENTUALMENTE EL VALOR DEL DEPOSITO A
      * PLAZO PROPIO EN GARANTIA, LO QUE SE HACE EN PUT-GDO

      * OBTIENE CIC DE CODIGO GARANTIA ESPECIFICA
           MOVE 'GAR'          TO FIO-SIST.
           MOVE 'LIM'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'E'            TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'CICESP  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

           IF GAR-COD-LIM IN GDG NOT = TAB-COD-CTAB IN TAB
               GO TO FIN-PUT-ALL-QGA.

      * GARANTIA ESPECIFICA, VALORIZA LOS CREDITOS CORRESPONDIENTES
           MOVE ZEROES TO GVT-VAL-CML-TSN IN QGA-FLD.
           MOVE ZEROES TO GVT-VAL-LIQ-TSN IN QGA-FLD.
           MOVE ZEROES TO GVT-VAL-PON     IN QGA-FLD.

           MOVE DBC-KEY-IDBC IN DBC TO DBC-KEY-IDBC IN VCR-VARI.
           MOVE GAR-NUM-SIS  IN GDG TO GAR-NUM-SIS  IN VCR-VARI.
           MOVE GAR-COD-CRR  IN GDG TO GAR-COD-CRR  IN VCR-VARI.
           MOVE GAR-VCB      IN GDG TO GAR-VCB      IN VCR-VARI.
*% IF PGM_MVS OR PGM_DOS
      *<<<< PGM_MVS OR PGM_DOS
      * OBTIENE CODIGO VALOR DE CAMBIO DE PESOS MEDIANTE CIC DE LA MONEDA '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.
           MOVE TAB-COD-CTAB IN TAB TO VCR-COD-PESO IN VCR-VARI.
      *>>>>
*% END
*% IF PGM_CHI
      *<<<< PGM_CHI
           PERFORM GAR-PRO-VCR.
      *>>>>
*% ELSE
      *<<<< NOT PGM_CHI
      *FLB CST  7-OCT-1993 INHIBIDO HASTA QUE ESTE COLOCACIONES
      *     PERFORM GAR-PRO-VCR.
      *>>>>
*% END
           IF FRM-MENS = SPACES AND MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

           MOVE GAR-VAL-CML-TSN IN GVT TO GVT-VAL-CML-TSN IN QGA-FLD.
           MOVE GAR-VAL-LIQ-TSN IN GVT TO GVT-VAL-LIQ-TSN IN QGA-FLD.
           MOVE GAR-VAL-PON     IN GVT TO GVT-VAL-PON     IN QGA-FLD.
      *>>>>
*% END
