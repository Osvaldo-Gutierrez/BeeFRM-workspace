*% FRM = 'TAG'
*% REG = 'TAG'
*% TAG_PGM = TRUE
*% IF TAG_STP_OPE
      *<<<< TAG_STP_OPE
*% VALIDA = TRUE
*% FINPARRAFO = 'FIN-VAL-TAG-STP-OPE'
*% INCLUDE 'GARSRC:BUSSTP.SRC'
      *>>>>
*% END
*% IF FIN_PUT_TAG_TAG
      *<<<< FIN_PUT_TAG_TAG
*% VALIDA = FALSE
*% INCLUDE 'GARSRC:BUSSTP.SRC'
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_TAG
      *<<<< INI_VAL_CON_KEY_TAG
           GO TO FIN-VAL-CON-KEY-TAG.
      *>>>>
*% END
*% IF FIN_FST_FLD_TAG
      *<<<< FIN_FST_FLD_TAG
           IF NOT ( SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON )
               MOVE 'S' TO TAG-IND-EXG-GDD IN TAG-FLD
               MOVE 'S' TO TAG-IND-EXG-GVT IN TAG-FLD
               MOVE FRM-CPIM-AEY TO TAG-IND-EXG-GDD-ATR IN TAG-FLD
               MOVE FRM-CPIM-AEY TO TAG-IND-EXG-GVT-ATR IN TAG-FLD.

      *>>>>
*% END
*% IF TAG_IND_OBL_UBI
      *<<<< TAG_IND_OBL_UBI
           IF NOT ( TAG-IND-OBL-UBI = 'U' OR 'N' )
               MOVE 'DEBE SER  U o N' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF TAG_UTP_VIG_TSN
      *<<<< TAG_UTP_VIG_TSN
           IF TAG-PDO-VIG-TSN = ZEROES
               MOVE SPACES TO TAG-UTP-VIG-TSN IN TAG-FLD
               GO TO FIN-VAL-TAG-UTP-VIG-TSN.

           IF NOT ( TAG-UTP-VIG-TSN = 'D' OR 'M' OR 'A' )
               MOVE 'DEBE SER   D o M o A' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF TAG_IND_TSN
      *<<<< TAG_IND_TSN
           IF NOT ( TAG-IND-TSN IN TAG-FLD = 'S' OR 'N' )
               MOVE 'SI o NO' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_TAG
      *<<<< VAL_CON_FLD_TAG
           IF SCR-CMND = 'COP'
               MOVE TAG-TIP-OPE IN TAG-FLD TO GAR-TIP-OPE IN TAG
               MOVE TAG-STP-OPE IN TAG-FLD TO GAR-STP-OPE IN TAG
               MOVE 'GAR'                  TO FIO-SIST
               MOVE FIO-GET-KEY            TO FIO-CMND
               PERFORM GAR-FIO-TAG
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'KEYPRIMDUPLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   PERFORM FST-KEY-TAG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           PERFORM VAL-IKY-TAG.
      *>>>>
*% END
*% IF EOF_BU 
      *<<<< EOF_BU
       VAL-IKY-TAG SECTION.
       INI-VAL-IKY-TAG.
           PERFORM VAL-TAG-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAG-TIP-OPE-LEN IN TAG-FLD
                GO TO FIN-VAL-IKY-TAG.
           PERFORM VAL-TAG-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAG-STP-OPE-LEN IN TAG-FLD
                GO TO FIN-VAL-IKY-TAG.
       FIN-VAL-IKY-TAG.
           EXIT.
       
       VAL-TAG-TIP-OPE SECTION.
       INI-VAL-TAG-TIP-OPE.
           IF TAG-TIP-OPE IN TAG-FLD NOT > SPACES
              MOVE SPACES TO TAG-TIP-OPE IN TAG-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-TIP-OPE IN TAG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-TIP-OPE IN TAG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE IN TAG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE IN TAG-FLD.
       FIN-VAL-TAG-TIP-OPE.
           EXIT.
       
       VAL-TAG-STP-OPE SECTION.
       INI-VAL-TAG-STP-OPE.
           IF TAG-STP-OPE IN TAG-FLD NOT > SPACES
              MOVE SPACES TO TAG-STP-OPE IN TAG-FLD.
      *<<<< TAG_STP_OPE

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-TIP-OPE IN TAG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE TAG-STP-OPE IN TAG-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN TAG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN TAG-FLD
               GO TO FIN-VAL-TAG-STP-OPE.
      *>>>>
       FIN-VAL-TAG-STP-OPE.
           EXIT.
       
      *>>>>
*% END
