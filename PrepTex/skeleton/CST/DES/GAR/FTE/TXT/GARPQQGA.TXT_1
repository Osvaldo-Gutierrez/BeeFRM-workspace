*%! IF PGM_DTC
*%! INCLUDE 'GARSRC:GNSVSIDTC.SRC'
*%! END
*%! CODIGO ADICIONAL PARA ARCHIVO
*% RA1 = "DBC"
*% RA2 = "GDG"
*% RA3 = "GDD"
*% NRA = 3
*% FRM = "QGA"
*% INCLUDE 'GARSRC:PFSALLALL.SRC'
*% PGM_HIJ = TRUE
*% PAD = 'DBC'
*% RPH = 'GDD'
*% HIJ = 'GDG'
*% REG = 'GDG'
*% KEYHIJ = 'GDG-COD-CRR'
*% IF PGM_CST OR PGM_CHI
*% PICPAD = 'ZEROES'
*% END
*% IF PGM_PER
*% PICPAD = 'SPACES'
*% END
*% PICHIJ = 'ZEROES'
*% CAIREG = 'GAR-NUM-SIS'
*% CAIFLD = 'GDG-NUM-SIS'
*% IICREG = 'GAR-COD-CRR'
*% IICFLD = 'GDG-COD-CRR'
*% KEYHIJHIJ = 'GAR-CLV-GDG-1'
*% KEYHIJRPH = 'GAR-CLV-GDD-2'
*% KEYRPHRPH = 'GAR-CLV-GDD-1'
*% KEYPADRPH = 'GDD-CIC-ICLI'
*% KEYPADPAD = 'DBC-KEY-IDBC'
*% ING_SBR_HIJ = FALSE
*% SISPAD = 'SGC'
*% SISHIJ = 'GAR'
*% SISREG = 'GAR'
*% KEYPAD = 'DBC-IDC-ICLI'
*% KEYPADALT = 'DBC-GLS-NOMC'
*% SCRKEYPAD = 'IDC'
*% SCRKEYALT = 'NOM'
*% MNECORPAD = 'CLI'
*% UNS_FLD = TRUE 
*% MUL_FLD = TRUE 
*% LEE_PAD_F56 = TRUE 
*% NO_CIC_PQ = TRUE
*% IF FIN_SCR_VARI
*% INCLUDE CMAVARI OF 'GARSRC:PGMMAN.SRC'
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GARBRTAG.
       COPY GARBRGVT.
       COPY GARBRGES.
       COPY GARBRGLE.
       COPY GARBRGSE.
       COPY GARBRGDO.
       COPY GARBRGUB.

*% IF NOT PGM_BFA
      *<<<< NOT PGM_BFA
       COPY DEUBRFIA.

      *>>>>
*% END
*% IF PGM_CHI
      *<<<< PGM_CHI
       COPY DAPBROPD.

      *>>>>
*% END
       COPY COLBRDLC.

       COPY TABBRCAM.

*% INCLUDE WSS OF 'GARSRC:PGMMAN.SRC'
       01  WSS-VARI.
       COPY GARWGEXV.
           03 WSS-NUM-IDLC-903                    PIC 9(03).
           03 PGM-STAT-ADIC.
              05 PGM-STAT-TAG        VALUE '23'   PIC X(02).
                 88 PGM-STAT-TAG-OKS VALUE '00'.
                 88 PGM-STAT-TAG-NUL VALUE '  '.
           03 WSS-CIV-SIV.
              05 WSS-CIV-EMI                      PIC X(03).
              05 WSS-SIV-EMI                      PIC X(03).

       COPY GARWGVCR.
*% IF PGM_CHI
      *<<<< PGM_CHI
       COPY GARWGDAP.
      *>>>>
*% END

       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY GNSWGINT.
      *
*% IF PGM_DTC
      *<<<< PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GLE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GSE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GUB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
*% END
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA AND ( PGM_MVS OR PGM_DOS )
           02 FILLER                       PIC X(500).
*% END
*% IF INI_FIO AND ( PGM_MVS OR PGM_DOS )
      *<<<< INI_FIO
           MOVE +500 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FIO AND PGM_VMS
      *<<<< INI_FIO

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-TAB.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDD.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GVT.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDO.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDO.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GES.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GLE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GLE.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GSE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GSE.

           MOVE FIO-ACCS-INP TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GUB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GUB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'DEU'        TO FIO-SIST.
           PERFORM DEU-FIO-FIA.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DEU-FIO-FIA.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'DAP'        TO FIO-SIST.
           PERFORM DAP-FIO-OPD.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-OPD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'COL'        TO FIO-SIST.
           PERFORM COL-FIO-DLC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DLC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-CAM.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.

      * OBTIENE CODIGO VALOR DE CAMBIO DE PESOS MEDIANTE CIC DE LA MONEDA '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               PERFORM PRG-ABT.
           MOVE TAB-COD-CTAB IN TAB TO VCR-COD-PESO IN VCR-VARI.
      *>>>> INI_FIO
*% END
*% IF INI_FND_KEY
*% INCLUDE BUSNXTPRV OF 'GARSRC:PGMMAN.SRC'
*% INCLUDE FNDIRECTO OF 'GARSRC:PGMMAN.SRC'
*% INCLUDE BUSPADHIJ OF 'GARSRC:PGMMAN.SRC'
*% END
*% IF FIN_FND_KEY
*% INCLUDE FINFNDKEY OF 'GARSRC:PGMMAN.SRC'
           GO TO FIN-FND-KEY.
*% INCLUDE ERRFNDKEY OF 'GARSRC:PGMMAN.SRC'
*% END
*% IF EOF
      *<<<< EOF
*% INCLUDE EOFPQ   OF 'GARSRC:PGMMAN.SRC'
*% INCLUDE EOFPQPU OF 'GARSRC:PGMMAN.SRC'
*% IF PGM_CHI
      *<<<< PGM_CHI
       COPY GARBGEDP.
*% PGM_QGA = TRUE
*% INCLUDE 'GARSRC:VLRDAPGAR.SRC'
*% INCLUDE 'GARSRC:BUSGDOOPD.SRC'

       COPY DAPBFOPD.
      *>>>>
*% END
       COPY GARBFTAG.
       COPY GARBFGVT.
       COPY GARBFGDO.
       COPY GARBFGES.
       COPY GARBFGLE.
       COPY GARBFGSE.
       COPY GARBFGUB.

*% IF NOT PGM_BFA
      *<<<< NOT PGM_BFA
       COPY DEUBFFIA.

      *>>>>
*% END
       COPY COLBFDLC.

*% IF PGM_VMS
      *<<<< PGM_VMS
       COPY SGCBFTAB.

      *>>>>
*% END
       COPY TABBFCAM.

       COPY GARBGVCR.
       COPY GARBKVCR.

       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGINT.
       COPY GNSBGPES.
      *>>>>
*% END
