*% FRM = 'GES'
*% REG = 'GES'
*% IF FIN_PUT_GES_GES
      *<<<< FIN_PUT_GES_GES
      *BUS-COL busca datos Documento Legal Credito en Colocaciones
           IF GES-COD-CRR-CDT IN GES-FLD > ZEROES
               PERFORM BUS-COL
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-PUT-GES-GES.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-VCB-LIM-CDT IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-VCB-LIM-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-LIM-CDT IN GES-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE GES-VCB-CDT IN GES-FLD TO GAR-VCB-CDT IN GES.
           IF GES-TIP-VCB-CDT IN GES-FLD > SPACES AND
              GAR-COD-VCB-CDT IN GES NOT > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE GES-TIP-VCB-CDT IN GES-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TIP-VCB-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO GES-TIP-VCB-CDT     IN GES-FLD
                              FRM-GLS-TIP-VCB-CDT IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-TIP-OPE-CDT IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE GES-TIP-OPE-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *FLB CST  8-NOV-1993 
               MOVE TAB TO TIO
      *FLB CST  8-NOV-1993 
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE-CDT IN GES-FLD.

      *FLB CST  8-NOV-1993 
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               GO TO FIN-BUS-AUX.

           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE.
           MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE.
           MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO
                FRM-GLS-STP-OPE-CDT IN GES-FLD.
       FIN-BUS-AUX.
      *FLB CST  8-NOV-1993 FIN
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-VCB-CDT IN GES-FLD > SPACES AND
              GAR-COD-VCB-CDT IN GES > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-VCB-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CDT IN GES-FLD.
      *>>>>
*% END
*% IF GES_COD_ESP
      *<<<< GES_COD_ESP
           IF GES-COD-ESP IN GES-FLD NOT > ZEROES AND
              SCR-CCPP NOT = 'ING'
               PERFORM KEY-GES-GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF FIO-STAT-OKS
                   GO TO FIN-VAL-GES-COD-ESP.

           IF GES-COD-ESP IN GES-FLD NOT > ZEROES
               PERFORM BUS-COR-GES.

           IF GES-COD-ESP IN GES-FLD = ZEROES
               PERFORM ERR-GLS
                GO TO FIN-VAL-GES-COD-ESP.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_GES
      *<<<< INI_VAL_CON_IKY_GES
           IF SCR-CCPP = 'ELI' 
               PERFORM KEY-GES-GES
               ADD 1 TO GAR-COD-ESP IN GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF FIO-STAT-OKS
                   MOVE 'GAR'       TO MSG-COD-SIST
                   MOVE 'IKYSIGEXI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
                   GO TO FIN-VAL-CON-IKY-GES.

           IF GES-COD-ESP IN GES-FLD > 1
               PERFORM KEY-GES-GES
               SUBTRACT 1 FROM GES-COD-ESP IN GES-FLD
                        GIVING GAR-COD-ESP IN GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'       TO MSG-COD-SIST
                   MOVE 'IKYANTNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
      *            Gtia a conjunto de creditos
                   IF GAR-COD-CRR-CDT IN GES NOT > ZEROES
                       MOVE 'GAR'         TO MSG-COD-SIST
                       MOVE 'GES SOLO 1'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-IKY-GES
                   ELSE

      *                Gtia a un credito individual
      *                Ingresa Item siguientes al primero
                       GO TO FIN-VAL-CON-IKY-GES.

      *>>>>
*% END
*% IF FIN_FST_FLD_GES
      *<<<< FIN_FST_FLD_GES
           IF GES-COD-CRR-CDT IN GES-FLD > ZEROES
               MOVE FRM-CPIM-AEY TO GES-FEC-VTO-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-VCB-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-STP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-VCB-CDT-ATR     IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-DST-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-DEU-ATR    IN GES-FLD.
      *>>>>
*% END
*% IF GES_NUM_SIS_CDT
      *<<<< GES_NUM_SIS_CDT
           IF GES-NUM-SIS-CDT NOT > SPACES
               MOVE SPACES TO GES-NUM-SIS-CDT IN GES-FLD 
               GO TO FIN-VAL-GES-NUM-SIS-CDT.
      *>>>>
*% END
*% IF GES_COD_CRR_CDT
      *<<<< GES_COD_CRR_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-COD-CRR-CDT IN GES-FLD.

           IF GES-COD-ESP IN GES-FLD > 1 AND
              GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GESIICCDTBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-COD-CRR-CDT.

      *>>>>
*% END
*% IF GES_NUM_DOC_CDT
      *<<<< GES_NUM_DOC_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-NUM-DOC-CDT IN GES-FLD
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

      *FLB CST  9-MAY-1994 DLC NO DEBE REPETIRSE
           PERFORM VAL-DLC-IGUA.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

           PERFORM BUS-COL.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

*% IF PGM_CHI
      *<<<< PGM_CHI
           PERFORM VAL-RDC-GDD.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_GES_FEC_VTO_CDT
      *<<<< INI_GES_FEC_VTO_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-FEC-VTO-CDT IN GES-FLD
               GO TO FIN-VAL-GES-FEC-VTO-CDT.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE GES-FA-VTO-CDT IN GES-FLD TO FEC-FANO.
           MOVE GES-FM-VTO-CDT IN GES-FLD TO FEC-FMES.
           MOVE GES-FD-VTO-CDT IN GES-FLD TO FEC-FDIA.
      *>>>>
*% END
*% IF GES_COD_SIS_CDT
      *<<<< GES_COD_SIS_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE SPACES TO GES-COD-SIS-CDT IN GES-FLD 
               GO TO FIN-VAL-GES-COD-SIS-CDT.
      *>>>>
*% END
*% LBL = ""
*% IF GES_PCT_LIM_CDT
      *<<<< GES_PCT_LIM_CDT
           IF GES-PCT-LIM-CDT IN GES-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GES_VCB_LIM_CDT
      *<<<< GES_VCB_LIM_CDT
           IF ( GES-VAL-LIM-CDT IN GES-FLD     > ZEROES AND
                GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES ) OR
              ( GES-VAL-LIM-CDT IN GES-FLD NOT > ZEROES AND
                GES-VCB-LIM-CDT IN GES-FLD     > SPACES )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GESVALVCBCDT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-VCB-LIM-CDT.

           IF GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-VCB-LIM-CDT     IN GES-FLD
               MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD
               GO TO FIN-VAL-GES-VCB-LIM-CDT.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GES-VCB-LIM-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-LIM-CDT IN GES-FLD.

*% IF NOT PGM_VMS
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
*% END
      *>>>>
*% END
*% IF GES_VAL_LIM_CDT
      *<<<< GES_VAL_LIM_CDT
           IF NOT ( GES-VAL-LIM-CDT IN GES-FLD > ZEROES OR
                     GES-PCT-LIM-CDT IN GES-FLD > ZEROES )
               MOVE 100 TO GES-PCT-LIM-CDT IN GES-FLD
           ELSE
           IF GES-VCB-LIM-CDT IN GES-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GES-VAL-LIM-CDT IN GES-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GES-VAL-LIM-CDT IN GES-FLD.
      *>>>>
*% END
*% IF GES_TIP_VCB_CDT
      *<<<< GES_TIP_VCB_CDT
           IF GES-TIP-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-TIP-VCB-CDT     IN GES-FLD
               MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD
               GO TO FIN-VAL-GES-TIP-VCB-CDT.

      *VAL-MSC Valida indicador ( miscelaneo ) de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TVAL' TO MSC-COD-TMSC IN MSC.
           MOVE GES-TIP-VCB-CDT IN GES-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              GES-TIP-VCB-CDT IN GES-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO 
                    FRM-GLS-TIP-VCB-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD.

      *>>>>
*% END
*% IF GES_TIP_OPE_CDT
      *<<<< GES_TIP_OPE_CDT
           IF GES-TIP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD
               GO TO FIN-VAL-GES-TIP-OPE-CDT.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-GES-TIP-OPE-CDT
               ELSE
                   MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-TIP-OPE-CDT
           ELSE
                MOVE TAB-GLS-DESC IN TAB TO
                     FRM-GLS-TIP-OPE-CDT IN GES-FLD.
      *>>>>
*% END
*% IF FIN_GES_TIP_OPE_CDT
      *<<<< FIN_GES_TIP_OPE_CDT
      *FLB CST  8-NOV-1993 
           MOVE TAB TO TIO.
      *>>>>
*% END
*% IF GES_STP_OPE_CDT
      *<<<< GES_STP_OPE_CDT
           IF GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
               GO TO FIN-VAL-GES-STP-OPE-CDT.

      *FLB CST  8-NOV-1993 
           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE
               MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE
               MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' OR
                  GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
                   MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-STP-OPE-CDT
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-STP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-STP-OPE-CDT.
      *FLB CST  8-NOV-1993 

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE.
           MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE.
           MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
               GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
            ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE-CDT IN GES-FLD.

      *>>>>
*% END
*% IF GES_VCB_CDT
      *<<<< GES_VCB_CDT
           IF GES-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-VCB-CDT     IN GES-FLD 
               MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD
               GO TO FIN-VAL-GES-VCB-CDT.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GES-VCB-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CDT IN GES-FLD.
      *>>>>
*% END
*% IF GES_COD_DST_CDT
      *<<<< GES_COD_DST_CDT
           IF GES-COD-DST-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-COD-DST-CDT IN GES-FLD
               MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD
               GO TO FIN-VAL-GES-COD-DST-CDT.

      *>>>>
*% END
*% IF GES_TIP_DEU
      *<<<< GES_TIP_DEU
           IF GES-TIP-DEU IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-TIP-DEU IN GES-FLD
               GO TO FIN-VAL-GES-TIP-DEU.

           IF NOT ( GES-TIP-DEU IN GES-FLD = 'D' OR 'I' )
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'TDEU    D/I' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_GES
      *<<<< VAL_CON_FLD_GES
           IF GES-COD-CRR-CDT IN GES-FLD = ZEROES AND
              GES-TIP-VCB-CDT IN GES-FLD = SPACES AND
              GES-VCB-CDT     IN GES-FLD = SPACES AND
              GES-TIP-OPE-CDT IN GES-FLD = SPACES AND
              GES-COD-DST-CDT IN GES-FLD = SPACES AND
              GES-TIP-DEU IN GES-FLD = SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GESVALFLDBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-GES.

      *>>>>
*% END
*% IF EOF
      *<<<< EOF BM
       BUS-COL SECTION.
       INI-BUS-COL.
      * LEE DOCUMENTO LEGAL DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           IF DLC-VAL-SDLC IN DLC NOT > ZEROES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC SDLC=0'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

      * LEE OPERACION DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'OPC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           MOVE DLC-FEC-FMAV   IN DLC TO GAR-FEC-VTO-CDT IN GES.
           MOVE GAR-FA-VTO-CDT IN GES TO GES-FA-VTO-CDT  IN GES-FLD.
           MOVE GAR-FM-VTO-CDT IN GES TO GES-FM-VTO-CDT  IN GES-FLD.
           MOVE GAR-FD-VTO-CDT IN GES TO GES-FD-VTO-CDT  IN GES-FLD.
           MOVE OPC-COD-TOOC   IN OPC TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-AOOC   IN OPC TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-VCOC   IN OPC TO GES-VCB-CDT     IN GES-FLD.
           MOVE OPC-COD-CDOC   IN OPC TO GES-COD-DST-CDT IN GES-FLD.
           GO TO FIN-BUS-COL.
       ERR-BUS-COL.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-BUS-COL.
           EXIT.
      *>>>>
*% END
*% IF EOF_BU
      *<<<< EOF_BU
       VAL-DLC-IGUA SECTION.
       INI-VAL-DLC-IGUA.
      * DLC no debe repetirse
           PERFORM KEY-GES-GES.
           MOVE ZEROES TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       LUP-VAL-DLC-IGUA.
           IF NOT ( FIO-STAT-OKS AND
              GAR-NUM-SIS IN GES = GES-NUM-SIS IN GES-FLD AND
              GAR-COD-CRR IN GES = GES-COD-CRR IN GES-FLD )
               GO TO BRW-VAL-DLC-IGUA.

           IF GAR-COD-ESP IN GES = GES-COD-ESP IN GES-FLD
               GO TO NXT-VAL-DLC-IGUA.

           IF GAR-NUM-SIS-CDT IN GES = GES-NUM-SIS-CDT IN GES-FLD AND
              GAR-COD-CRR-CDT IN GES = GES-COD-CRR-CDT IN GES-FLD AND
              GAR-NUM-DOC-CDT IN GES = GES-NUM-DOC-CDT IN GES-FLD
               MOVE 'DLCREPETIDO' TO MSG-COD-MENS
               GO TO BRW-VAL-DLC-IGUA.
       NXT-VAL-DLC-IGUA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           GO TO LUP-VAL-DLC-IGUA.
       BRW-VAL-DLC-IGUA.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES.
       FIN-VAL-DLC-IGUA.
           EXIT.

      *>>>>
*% END
*% IF EOF_BU AND PGM_CHI
      *<<<< EOF_BU AND PGM_CHI

       VAL-RDC-GDD SECTION.
       INI-VAL-RDC-GDD.
           MOVE 'GESDLCNORDC' TO MSG-COD-MENS.

           MOVE DLC-KEY-IDLC IN DLC TO RDC-KEY-IDLC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF NOT (
              FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                  )
      * DLC NO TIENE RDC DIRECTO

               GO TO BRW-VAL-RDC-GDD.
       LUP-VAL-RDC-GDD.
           MOVE RDC-CIC-ICLI IN RDC    TO GDD-CIC-ICLI  IN GDD.
           MOVE GES-NUM-SIS IN GES-FLD TO GAR-NUM-SIS   IN GDD.
           MOVE GES-COD-CRR IN GES-FLD TO GAR-COD-CRR   IN GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS
               MOVE SPACES TO MSG-COD-MENS
               GO TO BRW-VAL-RDC-GDD.
       NXT-VAL-RDC-GDD.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM COL-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-VAL-RDC-GDD.
       BRW-VAL-RDC-GDD.
           IF PGM-STAT-RDC-OKS
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-RDC.
       FIN-VAL-RDC-GDD.
           EXIT.
      *>>>>
*% END
