*% FRM = 'GXD'
*% REG = 'FRM'
*% IF FIN_PUT_DBC_GXD
      *<<<< FIN_PUT_DBC_GXD
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GXD-FLD.
           MOVE DBC-KEY-IDBC IN DBC TO DBC-KEY-IDBC IN CMA-VARI.
      *>>>>
*% END
*% IF DBC_GLS_ICLI AND PGM_BFA
      *<<<< DBC_GLS_ICLI AND PGM_BFA
           IF DBC-GLS-ICLI IN GXD-FLD NOT > ZEROES
               MOVE ZEROES TO DBC-GLS-ICLI IN GXD-FLD.          
      *>>>>
*% END
*% IF FRM_TIP_OPE
      *<<<< FRM_TIP_OPE
           IF FRM-TIP-OPE IN GXD-FLD = SPACES
               MOVE 0 TO WSS-IND-TIP-STP
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GXD-FLD
               GO TO FIN-VAL-FRM-TIP-OPE
           ELSE
      *BUS-TAB busca glosa de codigo en tabla
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE FRM-TIP-OPE IN GXD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = SPACES
                   MOVE TAB-GLS-DCOR IN TAB TO
                        FRM-GLS-TIP-OPE IN GXD-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TIP-OPE IN GXD-FLD
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-TIP-OPE.

      *    Busca Tipo Garantia en TAG
           MOVE FRM-TIP-OPE IN GXD-FLD TO GAR-TIP-OPE IN TAG.
           MOVE SPACES                 TO GAR-STP-OPE IN TAG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS OR 
              GAR-TIP-OPE IN TAG NOT = FRM-TIP-OPE IN GXD-FLD
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE 1 TO WSS-IND-TIP-STP.
      *>>>>
*% END
*% IF FRM_STP_OPE
      *<<<< FRM_STP_OPE
           IF FRM-TIP-OPE IN GXD-FLD = SPACES OR
              FRM-STP-OPE IN GXD-FLD = SPACES
               MOVE SPACES TO FRM-STP-OPE         IN GXD-FLD
               MOVE SPACES TO FRM-GLS-STP-OPE     IN GXD-FLD
               MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GXD-FLD
               GO TO FIN-VAL-FRM-STP-OPE.

*% VALIDA = TRUE
*% FINPARRAFO = 'FIN-VAL-FRM-STP-OPE'
*% PGM_GXD = TRUE
*% INCLUDE 'GARSRC:BUSSTP.SRC'
*% INCLUDE 'GARSRC:BUSRAL.SRC'

           IF MSG-COD-MENS = SPACES
               MOVE 2 TO WSS-IND-TIP-STP.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_GXD
      *<<<< INI_VAL_CON_KEY_GXD
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-GXD.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_GXD
      *<<<< FIN_VAL_CON_KEY_GXD

           IF NOT ( DBC-NUM-ICLI IN GXD-FLD NOT = ZEROES OR
                    DBC-GLS-NOMC IN GXD-FLD > SPACES )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-GXD.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_GXD
      *<<<< INI_VAL_CON_IKY_GXD
           IF DBC-NUM-ICLI IN GXD-FLD = ZEROES AND
              DBC-GLS-NOMC IN GXD-FLD NOT > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'IKYBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-GXD.
      *>>>>
*% END
