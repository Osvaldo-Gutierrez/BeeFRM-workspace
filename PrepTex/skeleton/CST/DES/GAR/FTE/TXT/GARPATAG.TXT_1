*% NO_HDR_CST = TRUE
*%! PARA MANEJAT DATACOM DESDE AMBIENTE VSAM INTERACTIVO
*%! INCLUDE 'GARSRC:GNSVSIDTC.SRC'
*% FRM = 'TAG'
*% REG = 'TAG'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 CMA-VARI.
              05 GAR-TIP-OPE                    PIC X(03).
              05 GAR-STP-OPE                    PIC X(03).
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA AND PGM_IBM
      *ALD-BNL
           02 FILLER                       PIC X(265).
*% END
*% IF INI_FIO AND PGM_IBM
      *<<<< INI_FIO
           MOVE +265 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

*% IF PGM_IBM
           IF SCR-DESDE-CMN
               MOVE SPACES TO GAR-TIP-OPE IN CMA-VARI
               MOVE SPACES TO GAR-STP-OPE IN CMA-VARI.
*% ELSE
           MOVE SPACES TO GAR-TIP-OPE IN CMA-VARI.
           MOVE SPACES TO GAR-STP-OPE IN CMA-VARI.
           MOVE ZEROES TO TAG-PDO-VIG-TSN IN TAG-FLD.
*% END
      *>>>>
*% END
*% IF PGM_VAX AND FIN_LUP_MAIN
      *<<<< FIN_LUP_MAIN
           IF SCR-INST = SCR-INST-HCM
               MOVE SPACES TO GAR-TIP-OPE IN CMA-VARI
               MOVE SPACES TO GAR-STP-OPE IN CMA-VARI.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-TAG
               PERFORM FST-KEY-TAG.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP NOT = 'ING' AND
               TAG-TIP-OPE IN TAG-FLD = SPACES AND
               TAG-STP-OPE IN TAG-FLD = SPACES
                MOVE GAR-TIP-OPE IN CMA-VARI TO GAR-TIP-OPE IN TAG
                MOVE GAR-STP-OPE IN CMA-VARI TO GAR-STP-OPE IN TAG.
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP NOT = 'ING' AND
               TAG-TIP-OPE IN TAG-FLD = SPACES AND
               TAG-STP-OPE IN TAG-FLD = SPACES
               IF FIO-STAT-OKS
      * FLB 14-AGO-92
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM GAR-FIO-TAG
      * FLB 14-AGO-92
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM GAR-FIO-TAG
                   MOVE FIO-STAT TO PGM-STAT-TAG
                   MOVE GAR-TIP-OPE IN TAG TO TAG-TIP-OPE IN TAG-FLD
                   MOVE GAR-STP-OPE IN TAG TO TAG-STP-OPE IN TAG-FLD
               ELSE
                   MOVE FIO-GET-FST TO FIO-CMND
                   PERFORM GAR-FIO-TAG
                   MOVE FIO-STAT TO PGM-STAT-TAG
                   MOVE GAR-TIP-OPE IN TAG TO TAG-TIP-OPE IN TAG-FLD
                   MOVE GAR-STP-OPE IN TAG TO TAG-STP-OPE IN TAG-FLD.

           MOVE GAR-TIP-OPE IN TAG TO GAR-TIP-OPE IN CMA-VARI.
           MOVE GAR-STP-OPE IN TAG TO GAR-STP-OPE IN CMA-VARI.

*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
