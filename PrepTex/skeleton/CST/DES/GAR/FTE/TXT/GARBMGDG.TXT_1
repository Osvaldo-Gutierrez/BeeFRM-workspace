*% FRM = 'GDG'
*% REG = 'GDG'
*% IF FIN_PUT_GDG_{FRM}
      *<<<< FIN_PUT_GDG_{FRM}
           MOVE GAR-ES1 IN GDG TO WSS-EST-ANT IN CMA-VARI.

      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES1 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT2 IN TAB(1) TO WSS-ES1-1 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(2) TO WSS-ES1-2 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(3) TO WSS-ES1-3 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(4) TO WSS-ES1-4 IN CMA-VARI
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF GDG-IIC-ICLI IN GDG > ZEROES
               MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
           IF FIO-STAT-OKS
               MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
               MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.

           MOVE GAR-IND-EXI-GAP IN GDG TO GAR-IND-EXI-GAP IN CMA-VARI.
           MOVE GAR-IND-CPL IN GDG TO GAR-IND-CPL IN CMA-VARI.

*% VALIDA = FALSE
*% INCLUDE 'GARSRC:BUSSTP.SRC'
*% INCLUDE 'GARSRC:BUSRAL.SRC'
*% IF PGM_CHI
      *<<<< PGM_CHI
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Es Dep Plazo Propio
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
               PERFORM BUS-GDO-OPD
               MOVE OPD-CAI-IOPD IN DAP-VARI TO FRM-CAI-IOPD IN GDG-FLD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
               MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD,
                          FRM-GLS-DEUD IN GDG-FLD.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_PUT_DBC_{FRM}
      *<<<< INI_PUT_DBC_{FRM}
           IF DBC-IIC-ICLI IN CMA-VARI > ZEROES
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
           ELSE
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.
      *>>>>
*% END
*% IF FIN_PUT_DBC_{FRM}
      *<<<< FIN_PUT_DBC_{FRM}
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
*% END
*% IF FIN_CLR_KEY_GDG
      *<<<< FIN_CLR_KEY_GDG
           MOVE 'GAR' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
               MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN GDG-FLD
               MOVE '0500' TO GDG-NUM-SIS IN GDG-FLD
               MOVE 0  TO GDG-NUM-SIS-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
           ELSE
      *        FLB: version 'C'onsist
               MOVE 'C' TO SCR-IND-V001.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_{FRM}
      *<<<< INI_VAL_CON_KEY_{FRM}
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 OR
              FRM-FFLD = FRM-FFLD-PF5 OR
              FRM-FFLD = FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-{FRM}.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_{FRM}
      *<<<< INI_VAL_CON_IKY_{FRM}
           PERFORM VAL-GDG-TIP-OPE.
           PERFORM VAL-GDG-STP-OPE.
 
           MOVE GAR-IND-VTO IN TAG TO GAR-IND-VTO IN CMA-VARI.
*% IF PGM_CHI 
      *<<<< PGM_CHI
           MOVE GAR-PCT-PON IN TAG TO GAR-PCT-PON IN CMA-VARI.
           MOVE GAR-PCT-AJT-SUP IN TAG TO 
                GAR-PCT-AJT-SUP IN CMA-VARI.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Ingresa Dep Plazo Propio 
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_FST_FLD_GDG
      *<<<< FIN_FST_FLD_GDG
*% IF PGM_FMS
      *<<<< PGM_FMS
           MOVE 0 TO DBC-VRF-ICLI-LEN IN GDG-FLD.
*% END
*% IF PGM_BMS AND NOT PGM_ARG
      *<<<< PGM_BMS AND NOT PGM_ARG
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      *>>>>
*% END
*% IF PGM_BMS AND PGM_ARG
      *<<<< PGM_BMS AND PGM_ARG
           MOVE 0 TO DBC-GLS-ICLI-LEN IN GDG-FLD.
      *>>>>
*% END
      *ALD-BNL Y FLB
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.             
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.         
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
      *ALD-BNL-FIN.
*% IF PGM_CHI
      *<<<< PGM_CHI
           IF NOT (
                   CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING'
              )
      *       No Es o No Ingresa Dep Plazo Propio 
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
      *>>>>
*% END

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
                   MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                   GO TO FIN-FST-FLD-GDG.

           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
               MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
                   MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
      * FIN
                   MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
               MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
           ELSE
           IF SCR-CMND = 'AGA'
               MOVE -1 TO {FRM}-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-FA-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FM-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FD-VTO IN GDG-FLD.

       FIN-ANL-HBL-FEC-VTO.
      *>>>>
*% END
*% IF GDG_COD_CRR
      *<<<< GDG_COD_CRR
           IF GDG-COD-CRR IN GDG-FLD NOT > ZEROES
               MOVE GDG-NUM-SIS IN GDG-FLD TO CIC-CAI-ICIC IN CIC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-CIC
               IF NOT FIO-STAT-OKS
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'CICSTAT' TO MSG-COD-TMSG
                   MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE 0  TO GDG-COD-CRR-LEN IN GDG-FLD
                   MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GDG_TIP_OPE
      *<<<< GDG_TIP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-TIP-OPE.
      *>>>>
*% END
*% IF GDG_STP_OPE
      *<<<< GDG_STP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-STP-OPE.
*% VALIDA = TRUE
*% FINPARRAFO = 'FIN-VAL-GDG-STP-OPE'
*% INCLUDE 'GARSRC:BUSSTP.SRC'
*% INCLUDE 'GARSRC:BUSRAL.SRC'
      *>>>>
*% END
*% IF FRM_IIC_IOPD AND PGM_CHI
      *<<<< FRM_IIC_IOPD AND PGM_CHI
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
      *    OR GDG-FEC-ING-SIS IN GDG NOT > '19950115'
      *FLB CST  20-JAN-1995 FIN
      *FLB CST  17-FEB-1995
           OR SCR-CMND = 'ALZ'
               GO TO FIN-VAL-FRM-IIC-IOPD.

           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
      *RVM-CST-INI 3-APR-1996
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'GAR'          TO MSG-COD-SIST
      *         MOVE 'OPD    NEX'   TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
           IF NOT FIO-STAT-OKS
               IF SCR-CMND = 'ALZ' AND WSS-ALZ-DAP IN WSS-VARI = 'S'
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE 'GAR'          TO MSG-COD-SIST
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RVM-CST-FIN 3-APR-1996
           ELSE
           IF OPD-COD-STAT IN OPD NOT = 'G'
      *RVM-CST-INI 3-APR-1996
               IF SCR-CMND = 'ALZ'              AND
                  WSS-ALZ-DAP IN WSS-VARI = 'S' AND
                  OPD-COD-STAT IN OPD = 'L'
                   MOVE 'OPD    YALIQ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
      *RVM-CST-FIN 3-APR-1996
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPD    NOVIG'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-GPOD IN OPD = 'N'
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPDNOPERMITI'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE 'N'                 TO GDG-IND-OBL-INS IN GDG-FLD
      *DAD ini  05-JAN-1995
               IF OPD-MSC-TVAL IN OPD = '1'
                   MOVE 'GAR'        TO FIO-SIST
                   MOVE 'VSN'        TO TAB-COD-TTAB IN TAB
                   MOVE 'GDGVCB DAP' TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   IF FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'S'
      *            Version 'BCI'
                       MOVE OPD-COD-VCAM IN OPD TO GAR-VCB     IN GDG
                       MOVE '01'                TO GAR-TIP-CMB IN GDG
                       MOVE GAR-VCB      IN GDG TO GDG-VCB  IN GDG-FLD
                   ELSE
      *            Version 'CST'
                       MOVE OPD-COD-VCAM IN OPD TO GDG-VCB IN GDG-FLD
               ELSE
      *DAD fin  05-JAN-1995
                   MOVE OPD-COD-VCAM IN OPD TO GDG-VCB IN GDG-FLD.
      *>>>>
*% END
*% LBL = ""
*% IF FRM_COD_DEUD AND PGM_CHI
      *<<<< FRM_COD_DEUD AND PGM_CHI
      *FLB CST  20-JAN-1995
           IF FRM-COD-DEUD IN GDG-FLD NOT > SPACES
               MOVE 'N' TO FRM-COD-DEUD IN GDG-FLD.
      *    IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
           IF NOT ( SCR-CCPP = 'ING' OR SCR-CMND = 'MOD' ) OR
              CMA-IND-DAP IN CMA-VARI NOT = 'S'
               GO TO FIN-VAL-FRM-COD-DEUD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'DAP' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-DEUD IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-DEUD IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-DEUD IN GDG-FLD.

           IF FRM-COD-DEUD IN GDG-FLD = 'S'
               PERFORM BUS-RCC
               MOVE RCC-CIC-ICLI IN RCC TO DBC-KEY-IDBC IN CMA-VARI
               PERFORM PUT-DBC-GDG
               GO TO FIN-VAL-FRM-COD-DEUD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-IND-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS
               PERFORM GET-MSG
      *FLB CST 21-09-1993
*% IF PGM_CHI
      *<<<< PGM_CHI
               MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *>>>>
*% END
               MOVE 0  TO DBC-VRF-ICLI-LEN IN GDG-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *FLB CST 21-09-1993
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        DBC-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
*% END
*% IF DBC_GLS_ICLI AND PGM_BFA
      *<<<< DBC_GLS_ICLI AND PGM_BFA
           IF DBC-GLS-ICLI IN GDG-FLD NOT > SPACES
               MOVE ZEROES TO DBC-GLS-ICLI IN GDG-FLD.
      *>>>>
*% END
*% IF FIN_GDG_COD_OFI AND PGM_CHI
      *<<<< FIN_GDG_COD_OFI AND PGM_CHI
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFI.

      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GDG-BU.
           PERFORM VAL-USR-OFI.
           IF USP-COD-OFICINA NOT = GDG-COD-OFI IN GDG-FLD
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFI.

       FIN-VAL-OFI-USP-GDG-BU.
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
      *>>>>
*% END
*% IF FIN_GDG_VCB
      *<<<< FIN_GDG_VCB
           IF MSG-COD-MENS = 'COD    NEX'
               GO TO FIN-VAL-GDG-VCB.
      * Busca Tabla TAG
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-VCB.
      * Busca Codigo Cuenta Contable en Tabla DCC de GAR
           MOVE 'GAR'                  TO TAB-COD-SIST.
           MOVE 'DCC'                  TO TAB-COD-TTAB IN TAB.
           MOVE GAR-CLA-OPE-SUP IN TAG TO WSS-CLA-OPE-SUP.
           MOVE GDG-VCB     IN GDG-FLD TO WSS-VCB.
           MOVE WSS-COD-CTA            TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'DCC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-VCB.
      *>>>>
*% END
*% IF GDG_ES1
      *<<<< GDG_ES1
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES1
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF SCR-CCPP = 'ING'  OR 
                  GAR-IND-CPL IN CMA-VARI NOT = 'S'

               IF GDG-ES1 IN GDG-FLD > '10'
                   MOVE 'GDGES1NOVIG' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1
               ELSE
                   GO TO FIN-VAL-GDG-ES1.

      * CAMBIOS DE ESTADO
           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               IF NOT (GDG-ES1 IN GDG-FLD = WSS-ES1-1 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-2 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-3 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-4 IN CMA-VARI)
                   MOVE 'ES1NVOANT' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

      * ALZAMIENTO
           IF SCR-CMND = 'ALZ' AND GDG-ES1 IN GDG-FLD < '20'
                   MOVE 'GDGALZES1' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

           GO TO FIN-VAL-GDG-ES1.

       ERR-VAL-GDG-ES1.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GDG_COD_EJE_ORI AND PGM_CHI
      *<<<< GDG_COD_EJE_ORI AND PGM_CHI
           IF GDG-COD-EJE-ORI IN GDG-FLD = SPACES AND
              CMA-IND-DAP IN CMA-VARI = 'S'
               MOVE OPD-COD-EJEC IN OPD TO GDG-COD-EJE-ORI IN GDG-FLD.
      *>>>>
*% END
*% IF GDG_COD_GRA
      *<<<< GDG_COD_GRA
      *FLB CST 22-SEP-1993
           IF GDG-COD-GRA IN GDG-FLD = ZEROES
               MOVE '1' TO GDG-COD-GRA IN GDG-FLD.
      *FLB CST 22-SEP-1993

           IF GDG-COD-GRA IN GDG-FLD = '1' AND 
              GAR-IND-EXI-GAP IN CMA-VARI = 'S'
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GRAEXIGAP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF GDG_ES2
      *<<<< GDG_ES2
           IF (SCR-CCPP = 'ING') OR (SCR-CMND NOT = 'EJE') AND
              (GDG-ES2 IN GDG-FLD NOT > SPACES)
                MOVE SPACES TO GDG-ES2 IN GDG-FLD
                MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
                GO TO FIN-VAL-GDG-ES2.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES2
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD.
      *>>>>
*% END
*% IF GDG_IIV_AUT_ES1
      *<<<< GDG_IIV_AUT_ES1
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-IIV-AUT-ES1.

           IF GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-IIV-AUT-ES1.
      *>>>>
*% END
*% IF INI_GDG_FEC_ALZ
      *<<<< INI_GDG_FEC_ALZ
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE 0 TO GDG-FA-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FM-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FD-ALZ IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ALZ.

      * ALZAMIENTO
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
*% END
*% IF GDG_FEC_ALZ
      *<<<< GDG_FEC_ALZ
           
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-GDG-FEC-ALZ.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ALZ IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ALZ IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ALZ IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ALZ<CNS' TO MSG-COD-MENS
               MOVE 'GAR'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_GDG_FEC_VTO
      *<<<< INI_GDG_FEC_VTO
           MOVE FEC-VHBL-N TO FEC-VHBL.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA.
           IF GAR-IND-VTO IN CMA-VARI = 'S'
               IF FEC-FVLD = '00000000' OR > '20201231' 
                   MOVE 'VTO=0' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-FEC-VTO
               ELSE
                   NEXT SENTENCE
           ELSE
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE 2099 TO GDG-FA-VTO IN GDG-FLD
               MOVE   12 TO GDG-FM-VTO IN GDG-FLD
               MOVE   31 TO GDG-FD-VTO IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-VTO.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF GDG_FEC_VTO
      *<<<< GDG_FEC_VTO
           
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=SOL' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-VTO.

           GO TO FIN-VAL-GDG-FEC-VTO.
       ERR-VAL-GDG-FEC-VTO.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FRM_VRF_ICLI
      *<<<< FRM_VRF_ICLI
           IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.
      *>>>>
*% END
*% IF FRM_GLS_ICLI AND PGM_BFA
      *<<<< DBC_GLS_ICLI AND PGM_BFA
           IF FRM-GLS-ICLI IN GDG-FLD NOT > SPACES
               MOVE ZEROES TO FRM-GLS-ICLI IN GDG-FLD.
      *>>>>
*% END
*% IF INI_GDG_FEC_SOL_CNS
      *<<<< INI_GDG_FEC_SOL_CNS
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
*% END
*% IF INI_GDG_FEC_ESC_CNS
      *<<<< INI_GDG_FEC_ESC_CNS
           IF GDG-ES1 IN GDG-FLD < '10'
               MOVE 0 TO GDG-FA-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FM-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FD-ESC-CNS IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           IF GDG-ES1 IN GDG-FLD > '19'
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
*% END
*% IF GDG_FEC_ESC_CNS
      *<<<< GDG_FEC_ESC_CNS

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ESC<SOL' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO FEC-SEC1.
           MOVE HOY-AHOY TO FEC-AEC1.
           MOVE HOY-MHOY TO FEC-MEC1.
           MOVE HOY-DHOY TO FEC-DEC1.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'ESC>HOY' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
*% END
*% LBL = ""
*% IF GDG_IND_OBL_INS
      *<<<< GDG_IND_OBL_INS
      *FLB CST  19-AUG-1994
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-IND-OBL-INS.

           IF GAR-IND-EXG-GIN IN TAG = 'N' OR
              GDG-IND-OBL-INS IN GDG-FLD NOT > SPACES
      *FLB CST  19-AUG-1994
               MOVE 'N' TO GDG-IND-OBL-INS IN GDG-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-OBL-INS IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% LBL = ""
*% IF GDG_IND_CPL
      *<<<< GDG_IND_CPL
      *FLB CST  22-NOV-1993
           IF GDG-IND-CPL IN GDG-FLD NOT > SPACES
              MOVE 'N' TO GDG-IND-CPL IN GDG-FLD.
      *>>>>
*% END
*% LBL = ""
*% IF FIN_RET_GDG_{FRM}
      *<<<< FIN_RET_GDG_{FRM}
           MOVE GDG-VCB IN GDG-FLD TO WSS-VCB.
           IF WSS-TIP-VCB = '1'
               MOVE GDG-VCB IN GDG-FLD TO GAR-VCB-CON IN GDG
           ELSE
      *    Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de Moneda '0999'
               MOVE 'TAB'          TO FIO-SIST
               MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB
               MOVE '0999  '       TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CIC0999  NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   MOVE SPACES              TO GAR-VCB-CON IN GDG
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO GAR-VCB-CON IN GDG.

           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               MOVE WSS-EST-ANT IN CMA-VARI TO GAR-EST-ANT IN GDG.

           IF FRM-NUM-ICLI IN GDG-FLD NOT > ZEROES
               MOVE SPACES TO GDG-CAI-ICLI IN GDG
               MOVE ZEROES TO GDG-IIC-ICLI IN GDG.
      *>>>>
*% END
*% IF PGM_CHI AND ( EOF_BQ OR EOF_BU OR EOF_VAX )
      *<<<< PGM_CHI AND ( EOF_BQ OR EOF_BU OR EOF_VAX )
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *>>>>
*% END
