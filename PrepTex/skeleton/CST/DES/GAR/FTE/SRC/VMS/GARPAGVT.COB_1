       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GARPAGVT.
       AUTHOR.     CONSIST.
       DATE-WRITTEN. 07-Jul-93 08:56 PM.

      * ACTUALIZA ARCHIVO GARGVT EN FORMA INTERACTIVA.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GARBRGVT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSCR.


           03 CMA-VARI.
              05 GAR-NUM-SIS                      PIC X(04).
              05 GAR-COD-CRR                      PIC X(08).
              05 GAR-IND-OBL-CEM                  PIC X(01).
              05 GAR-IND-OBL-MCT                  PIC X(01).
              05 GAR-PCT-PON     COMP-3           PIC 9(03)V9(2).
              05 GAR-PCT-AJT-SUP COMP-3           PIC 9(03)V9(2).
              05 GAR-PDO-VIG-TSN                  PIC 9(03).
              05 GAR-UTP-VIG-TSN                  PIC X(01).
              05 GAR-IND-CPL                      PIC X(01). 
              05 GAR-COD-TSN                      PIC 9(03). 
      *<<<< NOT PGM_ARG
              05 WSS-VAL-CML-TSN COMP-3           PIC S9(11)V9(4). 
              05 WSS-VAL-LIQ-TSN COMP-3           PIC S9(11)V9(4). 
              05 WSS-VAL-PON     COMP-3           PIC S9(11)V9(4). 
              05 WSS-VAL-AJT-SUP COMP-3           PIC S9(11)V9(4). 
      *>>>>
              05 WSS-FEC-RVL                      PIC X(08).
              05 WSS-FEC-TSN                      PIC X(08).
              05 WSS-LIQ-CML     COMP-3           PIC S9(1)V9(14). 
      *>>>>
       COPY GARWIGVT.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
       COPY TABBROFI.
       COPY GARBRGDG.
       COPY GARBRGDP.
      *<<<< PGM_VMS
           COPY GNSBRMSC.
      *>>>>
      *<<<< PGM_PQ
       COPY GARBRGES.
      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       COPY GARBRGDO.
       COPY DAPBROPD.
      *>>>>
      *>>>>
      *<<<< PGM_PU
       COPY GARBRGMO.
      *>>>>
       COPY GARBRGSE.
       COPY GARBRGTP.
       COPY GARBRTAG.

       COPY TABBRCAM.

      *
           03 WSS-REG                          PIC X(03).
      *
       01  WSS-VARI.
           03 WSS-COD-PESO.
              05 WSS-IND-TMON                  PIC X(01).
              05 WSS-COD-REST                  PIC X(05).
      *<<<< NOT PGM_ARG
           03 WSS-VAL-PESO                     PIC S9(11).
           03 WSS-VAL-CML-AUX COMP-3           PIC S9(11)V9(4). 
      *>>>>
           03 GAR-COD-ITM-TSN                  PIC 9(03).
           03 WSS-AUX         COMP-3           PIC S9(03)V9(12). 
           03 WSS-IMAL                         PIC 9(01).
      * Variables para determinar vigencia de Tasacion
      *    deben estar bajo WSS-VARI
       COPY GARWGEXV.

       COPY GARWGVCG.
      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       COPY GARWGDAP.
      *>>>>

       COPY GNSWGPES.
      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       COPY GNSWGINT.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-STAT.
              05 PGM-STAT-GVT.
                 88 PGM-STAT-GVT-NUL    VALUE '  '.
                 07 PGM-STT1-GVT        VALUE '2' PIC X(01).
                    88 PGM-STAT-GVT-OKS VALUE '0'.
                 07 PGM-STT2-GVT        VALUE '3' PIC X(01).
              05 PGM-STAT-GDG.
                 88 PGM-STAT-GDG-NUL    VALUE '  '.
                 07 PGM-STT1-GDG        VALUE '2' PIC X(01).
                    88 PGM-STAT-GDG-OKS VALUE '0'.
                 07 PGM-STT2-GDG        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-NCUR                  VALUE "[?25l" PIC X(06).
           03 PGM-SCUR                  VALUE "[?25h" PIC X(06).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
           MOVE 'GARPAGVT' TO SCR-PROG.
           CALL 'GNSPPHDR'.
           MOVE SCR-INST-HKY TO SCR-INST.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-MSG.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GNS'   TO FIO-SIST.
           PERFORM GNS-FIO-MSG.

           MOVE 'GAR'        TO FIO-SIST.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           PERFORM GNS-FIO-TAB.
           MOVE 'GAR'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *<<<< INI_FIO

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-CAM.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-TAG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDP.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GAR-FIO-GDP.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GES.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GMO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GMO.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GSE.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GSE.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GTP.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GTP.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-OPD.

           MOVE ZEROES TO WSS-FEC-TSN IN CMA-VARI, 
                          WSS-FEC-RVL IN CMA-VARI,
                          WSS-LIQ-CML IN CMA-VARI.
      *>>>> INI_FIO
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
      *    MOVE SCR-NLIB TO FRM-NLIB.
      *    MOVE SCR-NMAP TO FRM-NAME.
           MOVE 'GARFMS' TO FRM-NLIB.
           MOVE 'GVT' TO FRM-NAME.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       CMN-INI.
           MOVE SCR-INST-HCM TO SCR-INST.
           INITIALIZE GVT-DFLD.
           INITIALIZE GVT-DFLD-ATR.
           INITIALIZE GVT-DFLD-LEN.
           MOVE GVT-CFLD TO FRM-CFLD.
       FIN-INI.
           EXIT.

       SCR-COM SECTION.
       INI-SCR-COM.
      *     MOVE FRM-MSG TO FRM-CMND.
      *     MOVE GVT-GLS-MENS TO FRM-MENS.
      *     PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
      *     PERFORM SCR-CLRA-GVT.
           CALL 'GNSPPCMN'.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-MOD.
       TRL-SCR-MOD.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-MOD.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT.
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-MOD.
           PERFORM SCR-DMSG.

       SCR-ING SECTION.
       INI-SCR-ING.
           PERFORM SCR-RST.
           PERFORM HBL-IKY.
           PERFORM GET-IKY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ING.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS OR FIO-STAT = FIO-STAT-NEX
               MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGEXI    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ING
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ING.
           MOVE PGM-LIMPIAR-TODO TO PGM-ICLR.
       TRL-SCR-ING.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ING.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-ING.
           PERFORM SCR-DMSG.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ACC.
       TRL-SCR-ACC.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ACC.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
       FIN-SCR-ACC.
           PERFORM SCR-DMSG.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ELI.
       TRL-SCR-ELI.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-ELI.
           PERFORM SCR-DMSG.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM GET-KEY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ACT.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               MOVE SCR-ACTU-MOD TO SCR-ACTU
               PERFORM PUT-SCR
           ELSE
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR
           IF FIO-STAT-EOF
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
           ELSE
           IF FIO-STAT = FIO-STAT-NEX
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
           ELSE
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               MOVE SCR-ACTU-ING TO SCR-ACTU.
       TRL-SCR-ACT.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ACT.
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-GVT
               PERFORM VAL-NUM-FLD-GVT.
           IF FRM-FFLD = FRM-FFLD-PF5 
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           PERFORM GNS-CLR-RQA.
      *>>>>
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           PERFORM SCR-DMSG.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM GET-KEY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-PGM.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
       FIN-SCR-PGM.
           PERFORM SCR-DMSG.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               PERFORM SCR-DSP-MSSG
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               DISPLAY PGM-NCUR WITH NO ADVANCING
               PERFORM SCR-CLRA-GVT
               PERFORM SCR-DSP-MSSG
               DISPLAY PGM-SCUR WITH NO ADVANCING
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-GVT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
           ELSE
               PERFORM CLR-FLD-GVT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM SCR-MSSG
               GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
       ERR-SCR-KEY.
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
        FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           INITIALIZE           GVT-DFLD.
           MOVE PGM-SRNF TO PGM-STAT-GVT.
           MOVE PGM-SRNF TO PGM-STAT-GDG.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
      * Llama a Subrutina Validacion Consistencia Garantia
           IF FRM-FFLD = FRM-FFLD-PF5 
               MOVE 'GVT' TO WSS-REG
               PERFORM GAR-PRO-VCG
               GO TO FIN-FND-KEY.

       BUS-GDG.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GDG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-STAT TO PGM-STAT-GDG.
           IF NOT FIO-STAT-OKS
               MOVE 'GDG    NEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.
       FIN-BUS-GDG.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GVT-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GVT-FLD.

      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-OPE IN GVT-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GVT-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN GVT-FLD.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE GAR-IND-OBL-CEM IN TAG TO GAR-IND-OBL-CEM
                                                     IN CMA-VARI
               MOVE GAR-IND-OBL-MCT IN TAG TO GAR-IND-OBL-MCT
                                                     IN CMA-VARI
               MOVE GAR-PCT-PON     IN TAG TO GAR-PCT-PON
                                                     IN CMA-VARI
               MOVE GAR-PCT-AJT-SUP IN TAG TO GAR-PCT-AJT-SUP
                                                     IN CMA-VARI
               MOVE GAR-PDO-VIG-TSN IN TAG TO GAR-PDO-VIG-TSN
                                                     IN CMA-VARI
               MOVE GAR-UTP-VIG-TSN IN TAG TO GAR-UTP-VIG-TSN
                                                     IN CMA-VARI
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE GAR-TIP-REA-NRE IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TIP-REA-NRE IN GVT-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GVT-FLD.


      * No encontro TAG
           IF FRM-SUAR = FRM-SUAR-MAL
                GO TO ERR-FND-KEY.
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN CMA-VARI.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN CMA-VARI.
           MOVE GAR-IND-CPL IN GDG TO GAR-IND-CPL IN CMA-VARI.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN CMA-VARI.
           IF SCR-CMND = 'ING'
               PERFORM PUT-GDG-GVT.

      * Valida Este permitido esta Entidad para Tipo-Subtipo
           IF GAR-IND-EXG-GVT IN TAG = 'N'
               MOVE 'TAG    NOPGM' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * Busca ultima Tasacion
           IF SCR-CCPP NOT = 'ING'
               IF GVT-COD-TSN IN GVT-FLD < 1
                   MOVE GAR-COD-TSN IN CMA-VARI TO
                        GVT-COD-TSN IN GVT-FLD

      *            Busca ultimo Item
                   PERFORM BUS-ULT-GTP
               ELSE
                   PERFORM BUS-ULT-GTP.
      *>>>>
           PERFORM KEY-ALL-GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-STAT TO PGM-STAT-GVT.
      *<<<< FIN_FND_KEY
       EXA-COM-STAT.
      * EXAMINA RELACION COMANDO ESTADO DE GVT

      * COMANDO CONSULTA ERROR LO TRATA EL GENESIS
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
               GO TO FIN-FND-KEY.

      * GARANTIA ALZADA
           IF GAR-ES1 IN GDG > '19'
               MOVE 'GDGALZ' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * COMANDO INGRESO SE VALIDO EN FIN-VAL-CON-IKY
      * ERROR LO TRATA EL GENESIS
           IF SCR-CCPP = 'ING'
               GO TO FIN-FND-KEY.

      * COMANDOS NO INGRESO, NO ENCONTRO REGISTRO
      * ERROR LO TRATA EL GENESIS
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.

      * COMANDO MODIFICACION DATOS INFORMATIVOS ULTIMA TASACION
           IF SCR-CMND = 'MTA' AND
              GVT-COD-TSN IN GVT-FLD = GAR-COD-TSN IN GDG
               GO TO FIN-FND-KEY.

      *    NO PERMITE ACTUAR SOBRE TASACION ANTIGUA
           IF GVT-COD-TSN IN GVT-FLD < GAR-COD-TSN IN GDG
               MOVE 'TSNNOVIG' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *    SE INTENTA MODIFICAR, NO ACTIVAR
           IF SCR-CCPP = 'MOD' AND SCR-CMND = 'MOD'
               IF GAR-IND-CPL IN GDG NOT = 'S'
      *            SE PERMITE MODIFICAR GARANTIA NO ACTIVADA
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY.

           IF SCR-CMND = 'RTA' OR SCR-CMND = 'RVL'
      *        IMPIDE SI TASACION NO ESTA ACTIVADA
               IF GVT-MSC-STAT IN GVT NOT = 'A'
                   MOVE 'ATANO' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
               ELSE
      *        PERMITE RETASAR ULTIMA TASACION DE GARANTIA COMPLETA
      *        PERMITE REVALORIZAR ULTIMA TASACION DE GARANTIA COMPLETA

               IF GAR-IND-CPL IN GDG = 'S'
                   PERFORM SLV-VAL-ANT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'GDG    NOAGA' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY.

      * EXAMINA SI TIENE TASACIONES PARCIALES
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               GO TO EXA-SI-GTP.

      * NO TIENE TASACIONES PARCIALES YA INGRESADAS

      *    SE INTENTA ACTIVAR
           IF SCR-CMND = 'ATA'
      *        COMANDO SOLO PARA TASACIONES PARCIALES
               MOVE 'ATASINGTP' TO MSG-COD-MENS
               GO TO ERR-FND-KEY
           ELSE
      *    SE INTENTA ELIMINAR
           IF SCR-CMND = 'ELI'
               IF GAR-IND-CPL IN GDG NOT = 'S'
      *        SE PERMITE ELIMINAR, GARANTIA NO ACTIVADA
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'GDG    AGAYA' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
           ELSE
      *        COMANDO DESCONOCIDO
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      * SI TIENE TASACIONES PARCIALES
       EXA-SI-GTP.

      *    SE INTENTA ACTIVAR
           IF SCR-CMND = 'ATA'

      *        SE PERMITE ACTIVAR, TASACION NO ACTIVADA
               IF GVT-MSC-STAT IN GVT NOT = 'A'

      *            SI GARANTIA COMPLETA SE SALVA CAMPOS ANTERIORES
                   IF GAR-IND-CPL IN GDG = 'S'
                       PERFORM SLV-VAL-ANT
                       GO TO FIN-FND-KEY
                   ELSE
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE 'ATAYA' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
           ELSE
           IF SCR-CMND = 'ELI'
               IF GAR-IND-CPL IN GDG NOT = 'S'
      *            SE PERMITE ELIMINAR, GARANTIA NO ACTIVADA
                   GO TO FIN-FND-KEY
               ELSE
      *            NO PERMITE ELIMINAR POR GARANTIA Y TASACION ACTIVADAS
                   MOVE 'ATAYA' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY
           ELSE
      *        COMANDO DESCONOCIDO
               MOVE 'CMNOSITNEX' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

       ERR-CMN-STAT.   
           MOVE 'CMNOSITNEX' TO MSG-COD-MENS.
           GO TO ERR-FND-KEY.

       ERR-FND-KEY.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE SCR-STAT-ABT TO SCR-STAT.
           IF SCR-CCPP = 'ING'
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT.

      *>>>>
       FIN-FND-KEY.
           EXIT.

       PUT-SCR SECTION.
       INI-PUT-SCR.
           PERFORM PUT-ALL-GVT.
       FIN-PUT-SCR.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-GVT.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-GVT.
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GVT-FEC-ULT-ACT.
           MOVE HOY-HHOY TO GVT-HOR-ACT.
           MOVE HOY-FHOY TO GVT-FEC-ING-SIS IN GVT.
           IF SCR-CCPP = 'ING'
               MOVE 'I'      TO GVT-MSC-TACC    IN GVT

           ELSE
               MOVE 'M'      TO GVT-MSC-TACC    IN GVT.
      *>>>>
      *<<<< CMN_MOD

           IF SCR-CMND = 'ATA'
               MOVE 'A' TO GVT-MSC-STAT IN GVT
               IF GAR-IND-CPL IN CMA-VARI = 'S'
                   PERFORM ESC-MOD-GVT
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-CMN-MOD.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS                                                  
      *        ERROR INCONSISTENCIA EN LA MODIFICACION : INFORMAR               
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'ATA'
               MOVE GAR-NUM-SIS IN GVT TO GAR-NUM-SIS IN GDG
               MOVE GAR-COD-CRR IN GVT TO GAR-COD-CRR IN GDG
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GAR-FIO-GDG
               IF FIO-STAT-OKS
                   MOVE 'S' TO GAR-IND-EXI-GVT IN GDG
                   MOVE 'S' TO GAR-IND-EXI-GTP IN GDG
                   MOVE  GAR-COD-TSN IN GVT TO GAR-COD-TSN IN GDG
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM GAR-FIO-GDG.

      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           INITIALIZE GVT.
      *<<<< INI_CMN_ING
           MOVE SPACES TO GVT-GLS-FLAG IN GVT.
           MOVE SPACES TO GVT-MSC-TACC IN GVT.
           MOVE SPACES TO GVT-TML-ACT  IN GVT.
           MOVE SPACES TO GVT-IDN-USU-ING IN GVT.
           MOVE SPACES TO GVT-IDN-USU-ACT IN GVT.
           MOVE 'I'    TO GVT-MSC-STAT IN GVT.


      *>>>>
           PERFORM RET-ALL-GVT.
      *<<<< INI_CMN_ING OR INI_CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO GVT-FEC-ULT-ACT.
           MOVE HOY-HHOY TO GVT-HOR-ACT.
           MOVE HOY-FHOY TO GVT-FEC-ING-SIS IN GVT.
           IF SCR-CCPP = 'ING'
               MOVE 'I'      TO GVT-MSC-TACC    IN GVT

           ELSE
               MOVE 'M'      TO GVT-MSC-TACC    IN GVT.
      *>>>>
      *<<<< CMN_ING
           IF SCR-CCPP = 'ING'
               IF FRM-IND-GTP IN GVT-FLD = 'S'
                   MOVE 'I' TO GVT-MSC-STAT IN GVT
               ELSE
                   MOVE 'A' TO GVT-MSC-STAT IN GVT
           ELSE
      *    COMANDOS RVL Y RTA
               MOVE 'A' TO GVT-MSC-STAT IN GVT
               ADD 1    TO GVT-COD-TSN  IN GVT-FLD
               MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GVT
               PERFORM COP-GTP
               IF MSG-COD-MENS = SPACES
                   PERFORM ESC-MOD-GVT
                   IF MSG-COD-MENS > SPACES
                       GO TO FIN-CMN-ING
                   ELSE
                       NEXT SENTENCE
               ELSE
                   GO TO FIN-CMN-ING.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
      *<<<< FIN_CMN_ING

           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING. 

           MOVE GAR-NUM-SIS IN GVT TO GAR-NUM-SIS IN GDG.
           MOVE GAR-COD-CRR IN GVT TO GAR-COD-CRR IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF FIO-STAT-OKS
               MOVE GAR-COD-TSN IN GVT TO GAR-COD-TSN IN GDG
               IF FRM-IND-GTP IN GVT-FLD = 'S' AND
                  GAR-VAL-AJT-SUP IN GVT NOT > ZEROES
      * ALD
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM GAR-FIO-GDG
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE 'S' TO GAR-IND-EXI-GVT IN GDG
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GAR-FIO-GDG.

      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
      *<<<< ABT_CMN_ACC
               IF SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'RTARVL NO'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
           IF SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GAR'        TO MSG-COD-SIST
                   MOVE 'RTARVL SI'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
           ELSE
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'REG    ERCOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM RET-ALL-GVT.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-GVT.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               PERFORM ELI-GTP.

           MOVE GAR-NUM-SIS IN CMA-VARI TO GAR-NUM-SIS IN GDG.
           MOVE GAR-COD-CRR IN CMA-VARI TO GAR-COD-CRR IN GDG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      * Para saber si queda o no un hijo y grabar el Indicador en GDG
           MOVE SPACES TO GAR-CLV-GVT-1 IN GVT.
           MOVE GAR-NUM-SIS IN CMA-VARI TO GAR-NUM-SIS IN GVT.
           MOVE GAR-COD-CRR IN CMA-VARI TO GAR-COD-CRR IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'GAR-CLV-GVT-1' TO FIO-AKEY.
           PERFORM GAR-FIO-GVT.
           IF NOT (
                   FIO-STAT-OKS AND
                   GAR-NUM-SIS IN GVT = GAR-NUM-SIS IN CMA-VARI AND
                   GAR-COD-CRR IN GVT = GAR-COD-CRR IN CMA-VARI
                  )
      *        No quedo ningun hijo
               MOVE ' ' TO GAR-IND-EXI-GVT IN GDG.

           SUBTRACT 1 FROM GVT-COD-TSN IN GVT-FLD GIVING
                           GAR-COD-TSN IN GDG.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS.
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-GVT.
       FIN-CMN-PGM.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE SPACES TO FRM-MENS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           DISPLAY PGM-NCUR WITH NO ADVANCING.
           MOVE GVT-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE GVT-GLS-MENS TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           DISPLAY PGM-SCUR WITH NO ADVANCING.
       FIN-SCR-PUTA.
           EXIT.

       SCR-DSP-MSSG SECTION.
       INI-SCR-DSP-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO GVT-GLS-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-DSP-MSSG.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO GVT-GLS-MENS.
      *    MOVE FRM-MSG TO FRM-CMND.
      *    PERFORM GNS-PRO-FRM.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE GVT-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GKEY.
           MOVE GVT-DFLD-ATR   TO FRM-VATR.
           MOVE GVT-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GVT
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GKEY.
           MOVE FRM-DFLD TO GVT-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE GVT-DFLD-LEN.
           PERFORM VAL-NUM-KEY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
      *JSS
           PERFORM VAL-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-GVT
           ELSE
               GO TO FIN-SCR-GKEY.
       ERR-SCR-GKEY.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           GO TO LUP-SCR-GKEY.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE GVT-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GIKY.
           MOVE GVT-DFLD-ATR   TO FRM-VATR.
           MOVE GVT-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-GVT
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GIKY.
           MOVE FRM-DFLD TO GVT-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE GVT-DFLD-LEN.
           PERFORM VAL-NUM-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
      *JSS
           PERFORM VAL-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-GVT
           ELSE
               GO TO FIN-SCR-GIKY.
       ERR-SCR-GIKY.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           GO TO LUP-SCR-GIKY.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE GVT-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GFLD.
           MOVE GVT-DFLD-ATR   TO FRM-VATR.
           MOVE GVT-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-GVT
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GFLD.
           MOVE FRM-DFLD TO GVT-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE GVT-DFLD-LEN.
           PERFORM VAL-NUM-KEY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-NUM-FLD-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-MKY-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-GVT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-GVT.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           MOVE 1 TO FRM-IFLD.
           PERFORM FST-FLD-GVT.
       ERR-SCR-GFLD.
           PERFORM SCR-MSSG.
           PERFORM SCR-PUTA.
           GO TO LUP-SCR-GFLD.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
      *    MOVE FDV-WAIT TO FRM-CMND.
           MOVE 0 TO FRM-PLIN.
      *    MOVE FRM-MENS TO FRM-PRMT.
           MOVE GVT-GLS-MENS TO FRM-PRMT.
           MOVE FDV-GETDL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO GVT-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO GVT-GLS-MEN1
               MOVE GVT-GLS-MENS TO FRM-MENS
               GO TO INI-GET-ACC.
           MOVE FRM-VFLD TO SCR-VFLD.
           MOVE FRM-VFLD TO SCR-VFLD.
           IF FRM-FFLD = FRM-FFLD-RET
               IF SCR-VFLD = SCR-VFLD-NOT
                   MOVE FRM-FFLD-PF12 TO FRM-FFLD
               ELSE
                   PERFORM VAL-NUM-KEY-GVT
                   PERFORM VAL-NUM-FLD-GVT
           ELSE
               IF SCR-VFLD = SCR-VFLD-YES
                   MOVE FRM-FFLD-PF10 TO FRM-FFLD
                   PERFORM VAL-NUM-KEY-GVT
                   PERFORM VAL-NUM-FLD-GVT.
           DISPLAY '' LINE 24 COLUMN 1 WITH NO ADVANCING.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE FDV-WAIT TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO GVT-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO GVT-GLS-MEN1
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO INI-GET-CON.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO GVT-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           PERFORM PRO-FLD-GVT.
           PERFORM PRO-MKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM FST-KEY-GVT.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           PERFORM PRO-FLD-GVT.
           PERFORM UNP-KEY-GVT.
           PERFORM FST-KEY-GVT.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM UNP-MKY-GVT.
           PERFORM UNP-FLD-GVT.
           PERFORM FST-FLD-GVT.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO GVT-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-GVT.
           PERFORM PRO-FLD-GVT.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-GLS-PRMT( SCR-I ) TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-BSP
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL
               ELSE
                   MOVE FRM-MSG TO FRM-CMND
                   PERFORM GNS-PRO-FRM
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-BSP
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL
               ELSE
                   MOVE FRM-MSG TO FRM-CMND
                   PERFORM GNS-PRO-FRM
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           IF FRM-FFLD NOT = FRM-FFLD-BSP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT
           ELSE
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF
                  IF SCR-INST = SCR-INST-GCF
                      GO TO INI-DESSCRTRL.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
           IF FRM-MENS NOT > SPACES
               IF SCR-GLS-CONF( SCR-I ) NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MEN1.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-MSSG.
           PERFORM PRO-KEY-GVT.
           PERFORM PRO-FLD-GVT.
           PERFORM FST-MSG.
      *JSS PERFORM SCR-PUTA.
           DISPLAY PGM-NCUR WITH NO ADVANCING.
           MOVE GVT-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           DISPLAY PGM-SCUR WITH NO ADVANCING.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
      *    MOVE FDV-WAIT TO FRM-CMND.
           MOVE 0 TO FRM-PLIN.
           MOVE FRM-MENS  TO FRM-PRMT.
           MOVE FDV-GETDL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF4 OR
                               FRM-FFLD-BSP )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO GVT-GLS-MEN2
               MOVE SCR-GLS-CONF( SCR-I ) TO GVT-GLS-MEN1
               MOVE GVT-GLS-MENS TO FRM-MENS
               GO TO INI-SCR-GCNF.
           MOVE FRM-VFLD TO SCR-VFLD.
           IF NOT ( SCR-VFLD = SCR-VFLD-YES OR SCR-VFLD-NOT OR SPACES )
               MOVE 'CNF    INV' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               STRING MSG-GLS-DCOR SCR-GLS-CONF( SCR-I )
                      DELIMITED BY SIZE INTO GVT-GLS-MENS
               MOVE GVT-GLS-MENS TO FRM-MENS
               GO TO INI-SCR-GCNF.
           IF FRM-FFLD = FRM-FFLD-RET
               IF SCR-VFLD = SCR-VFLD-NOT
                   MOVE FRM-FFLD-PF12 TO FRM-FFLD
               ELSE
                   MOVE SCR-VFLD-YES TO SCR-VFLD
                   PERFORM VAL-NUM-KEY-GVT
                   PERFORM VAL-NUM-FLD-GVT
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF4
               IF SCR-VFLD = SCR-VFLD-YES
                   MOVE FRM-FFLD-PF10 TO FRM-FFLD
                   PERFORM VAL-NUM-KEY-GVT
                   PERFORM VAL-NUM-FLD-GVT
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT NOT = SCR-STAT-MOD
                   MOVE FRM-FFLD-RET TO FRM-FFLD
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           MOVE SPACES TO FRM-MENS.
           DISPLAY '' LINE 24 COLUMN 1 WITH NO ADVANCING.
       FIN-SCR-GCNF.
           EXIT.

       COPY GARBMGVT.
       COPY GARBFGVT.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.

      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF
      *<<<< PGM_PQ
       BUS-ULT-GTP SECTION.   
       INI-BUS-ULT-GTP.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GTP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GTP.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP.
           MOVE 'GAR-CLV-GTP-1' TO FIO-AKEY.
           MOVE '00' TO FIO-STAT.
           MOVE 0 TO GAR-COD-ITM-TSN IN GTP.
       LUP-BUS-ULT-GTP.
           ADD 1 TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS
               GO TO LUP-BUS-ULT-GTP.
           SUBTRACT 1 FROM GAR-COD-ITM-TSN IN GTP.
           MOVE GAR-COD-ITM-TSN IN GTP TO FRM-NUM-GTP IN GVT-FLD.
           IF GAR-COD-ITM-TSN IN GTP > ZEROES
               MOVE 'S'    TO FRM-IND-GTP IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
       FIN-BUS-ULT-GTP.
           EXIT.

       SLV-VAL-ANT SECTION.
       INI-SLV-VAL-ANT.
           MOVE GAR-VAL-LIQ-TSN IN GVT TO 
                                 WSS-VAL-LIQ-TSN IN CMA-VARI.
           MOVE GAR-VAL-CML-TSN IN GVT TO
                                 WSS-VAL-CML-TSN IN CMA-VARI.
           MOVE GAR-VAL-PON     IN GVT TO 
                                 WSS-VAL-PON     IN CMA-VARI.
           MOVE GAR-FEC-RVL     IN GVT TO
                                 WSS-FEC-RVL     IN CMA-VARI.
           MOVE GAR-VAL-AJT-SUP IN GVT TO
                                 WSS-VAL-AJT-SUP IN CMA-VARI.
           MOVE GAR-FEC-TSN     IN GVT TO 
                                 WSS-FEC-TSN     IN CMA-VARI.
       FIN-SLV-VAL-ANT.
           EXIT.

      *>>>>
      *<<<< PGM_PU
       ESC-MOD-GVT SECTION.
       INI-ESC-MOD-GVT.
      * SI LA GARANTIA ESTA INCOMPLETA SE ESCRIBE EN RUTINA QUE MARCA
      *    GARANTIA COMPLETA
      * SI ESTA COMPLETA, SE ESCRIBE GMO AQUI

      *          RELACION (LOGICA) CON CONTABILIZACION
      * INGRESO SE HACE EN RUTINA GARPPVCG
      * ING   COD-TSN = 1	COD-MOV = '1'
      *                         ESCRIBIR GMO
      *                         	FEC CALCULO = FEC-RVL
      *                         ESCRIBIR GVT
      *                         	FEC-RVL     = FEC-TSN
      *                         CONTABILIZAR
      *                         	VAL-CNT     = VAL-AJT

      * COMANDOS RTA RVL Y ATA SE EFECTUAN AQUI
      * RTA   COD-TSN > 1       COD-MOV = '2'
      * RVL                     ESCRIBIR GMO PARTE ANT
      * ATA                        	FEC-CNT     = FEC-RVL GVT ANT
      *                         	VAL-CNT     = VAL-AJT GVT ANT
      *                         ESCRIBIR GMO PARTE NVO
      *                         	FEC-CNT     = FEC-RVL GVT NVO
      *                         	VAL-CNT     = VAL-AJT GVT NVO
      *                         ESCRIBIR GVT
      *                         	FEC-RVL DE PANTALLA
      *                         CONTABILIZAR GMO PARTE ANT
      *                         	FEC-CNT     = FEC-RVL GVT ANT
      *                         	VAL-CNT     = VAL-AJT GVT ANT
      *                         CONTABILIZAR GMO PARTE NVO
      *                         	FEC-CNT     = FEC-RVL
      *                         	VAL-CNT     = VAL-AJT GVT NVO

           MOVE ZEROES TO GAR-CRR-MOV IN GMO.
           PERFORM INI-GMO.
           SUBTRACT 1 FROM GAR-COD-TSN IN GVT GIVING
                       GAR-COD-TSN IN GMO.
           MOVE '2' TO GAR-COD-MOV IN GMO.
           IF SCR-CMND = 'RTA'
               MOVE 'R' TO GAR-TIP-MOV IN GMO
           ELSE
           IF SCR-CMND = 'RVL'
               MOVE 'V' TO GAR-TIP-MOV IN GMO
           ELSE
           IF SCR-CMND = 'ATA'
               MOVE 'A' TO GAR-TIP-MOV IN GMO
           ELSE
               MOVE SPACES TO GAR-TIP-MOV IN GMO.

           MOVE FIO-PUT TO FIO-CMND.

           IF GAR-VAL-LIQ-TSN IN GVT NOT = WSS-VAL-LIQ-TSN
               MOVE 'GVT001'               TO GAR-COD-CPO     IN GMO
               MOVE WSS-VAL-LIQ-TSN        TO GAR-VAL-CPO-ANT IN GMO
               MOVE GAR-VAL-LIQ-TSN IN GVT TO GAR-VAL-CPO-NVO IN GMO
               PERFORM GAR-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GAR-VAL-CML-TSN IN GVT NOT = WSS-VAL-CML-TSN
               MOVE 'GVT002'               TO GAR-COD-CPO     IN GMO
               MOVE WSS-VAL-CML-TSN        TO GAR-VAL-CPO-ANT IN GMO
               MOVE GAR-VAL-CML-TSN IN GVT TO GAR-VAL-CPO-NVO IN GMO
               ADD 1                       TO GAR-CRR-MOV     IN GMO
               PERFORM GAR-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GAR-VAL-PON IN GVT NOT = WSS-VAL-PON
               MOVE 'GVT003'           TO GAR-COD-CPO     IN GMO
               MOVE WSS-VAL-PON        TO GAR-VAL-CPO-ANT IN GMO
               MOVE GAR-VAL-PON IN GVT TO GAR-VAL-CPO-NVO IN GMO
               ADD 1                   TO GAR-CRR-MOV     IN GMO
               PERFORM GAR-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

           IF GAR-FEC-TSN IN GVT NOT = WSS-FEC-TSN
               MOVE 'GVT004'           TO GAR-COD-CPO     IN GMO
               MOVE 'N'                TO GAR-IND-VAL     IN GMO
               MOVE ZEROES             TO GAR-VAL-CPO-ANT IN GMO
               MOVE ZEROES             TO GAR-VAL-CPO-NVO IN GMO
               MOVE WSS-FEC-RVL        TO GAR-GLS-CPO-ANT IN GMO
               MOVE GAR-FEC-RVL IN GVT TO GAR-GLS-CPO-NVO IN GMO
               ADD 1                   TO GAR-CRR-MOV     IN GMO
               PERFORM GAR-FIO-GMO
               IF NOT FIO-STAT-OKS
                   MOVE 'GMOMODGVT' TO MSG-COD-MENS
                   GO TO FIN-ESC-MOD-GVT.

      *    Se escribe siempre para reflejar contablemente la accion

           MOVE 'GVT005'               TO GAR-COD-CPO     IN GMO.
           MOVE 'S'                    TO GAR-IND-VAL     IN GMO.
           MOVE WSS-FEC-RVL            TO GAR-GLS-CPO-ANT IN GMO.
           MOVE GAR-FEC-RVL IN GVT     TO GAR-GLS-CPO-NVO IN GMO.
           MOVE WSS-VAL-AJT-SUP        TO GAR-VAL-CPO-ANT IN GMO.
           MOVE GAR-VAL-AJT-SUP IN GVT TO GAR-VAL-CPO-NVO IN GMO.
           ADD 1                       TO GAR-CRR-MOV     IN GMO.
           PERFORM GAR-FIO-GMO.
           IF NOT FIO-STAT-OKS
               MOVE 'GMOMODGVT' TO MSG-COD-MENS
               GO TO FIN-ESC-MOD-GVT.

       FIN-ESC-MOD-GVT.
           EXIT.

       INI-GMO SECTION.
       INI-INI-GMO.
               PERFORM GET-FHOY.
               MOVE HOY-FHOY TO GAR-FEC-MOV IN GMO.
               MOVE HOY-HHOY TO GAR-HOR-MOV IN GMO.
      * FALTA ESCRIBIR TERMINAL Y USUARIO
               MOVE SPACES TO GAR-TML-MOV IN GMO.
               MOVE SPACES TO GMO-IDN-USU-ING IN GMO.
               MOVE HOY-FHOY TO GMO-FEC-ING-SIS IN GMO.
               MOVE GAR-NUM-SIS IN GVT TO GAR-NUM-SIS IN GMO.
               MOVE GAR-COD-CRR IN GVT TO GAR-COD-CRR IN GMO.
               MOVE GDG-COD-OFI IN GVT-FLD TO GAR-COD-OFI-MOV IN GMO.
               ADD 1 TO GAR-CRR-MOV IN GMO.
               MOVE 'S' TO GAR-IND-VAL IN GMO.
               MOVE 'N' TO GAR-IND-CLV IN GMO.
               MOVE SPACES TO GAR-COD-CLV-ANT IN GMO.
               MOVE SPACES TO GAR-COD-CLV-NVO IN GMO.
               MOVE ZEROES TO GAR-VAL-CPO-ANT IN GMO.
               MOVE ZEROES TO GAR-VAL-CPO-NVO IN GMO.
               MOVE SPACES TO GAR-GLS-CPO-ANT IN GMO.
               MOVE SPACES TO GAR-GLS-CPO-NVO IN GMO.
       FIN-INI-GMO.
           EXIT.




       ELI-GTP SECTION.
       INI-ELI-GTP.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS     IN GTP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR     IN GTP.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN     IN GTP.
           MOVE 1                      TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ELI-GTP.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND 
              GVT-NUM-SIS IN GVT-FLD = GAR-NUM-SIS IN GTP AND
              GVT-COD-CRR IN GVT-FLD = GAR-COD-CRR IN GTP AND
              GVT-COD-TSN IN GVT-FLD = GAR-COD-TSN IN GTP
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GAR-FIO-GTP
               MOVE FIO-DEL TO FIO-CMND
               PERFORM GAR-FIO-GTP
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-ELI-GTP.               
       FIN-ELI-GTP.
           EXIT.

       COP-GTP SECTION.
       INI-COP-GTP.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-IND-GTP IN GVT-FLD NOT = 'S'
               GO TO FIN-COP-GTP.

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS     IN GTP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR     IN GTP.
           SUBTRACT 1 FROM GVT-COD-TSN IN GVT-FLD GIVING
                          GAR-COD-TSN     IN GTP.
           MOVE 1      TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-KEY TO FIO-CMND.
       LUP-COP-GTP.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GVT-NUM-SIS IN GVT-FLD = GAR-NUM-SIS IN GTP AND
              GVT-COD-CRR IN GVT-FLD = GAR-COD-CRR IN GTP AND
              ( GVT-COD-TSN IN GVT-FLD - 1 ) = GAR-COD-TSN IN GTP

               MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GAR-FIO-GTP
               IF NOT FIO-STAT-OKS
                   MOVE 'GTP    PUTNO' TO MSG-COD-MENS
                   MOVE FIO-MENS       TO FRM-MENS
               ELSE
                   SUBTRACT 1 FROM GVT-COD-TSN IN GVT-FLD GIVING
                            GAR-COD-TSN     IN GTP
                   ADD 1 TO GAR-COD-ITM-TSN IN GTP
                   MOVE FIO-GET-KEY TO FIO-CMND
                   GO TO LUP-COP-GTP.               
       FIN-COP-GTP.
           EXIT.

      *>>>>
       COPY GARBFGDG.
       COPY GARBFGDP.
      *<<<< PGM_PQ
       COPY GARBFGDO.
       COPY GARBFGES.
      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       COPY DAPBFOPD.
      *>>>>
      *>>>>
      *<<<< PGM_PU
       COPY GARBFGMO.
      *>>>>
       COPY GARBFGSE.
       COPY GARBFGTP.
       COPY GARBFTAG.

       COPY GARBGVCG.
       COPY GARBKVCG.

       COPY TABBFCAM.
       COPY GNSBGPES.
      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       COPY GNSBGINT.
      *>>>>
      *<<<< PGM_PQ
       EXA-VEN-TSN SECTION.
       INI-EXA-VEN-TSN.
  
      * Se determina si la tasacion esta vencida o no


           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efectiva
           IF GAR-PDO-VIG-TSN IN TAG NOT > ZEROES
               GO TO EXA-VEN-SEG.

      * Excluye los Creditos Hipotecarios
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.
           MOVE ZEROES             TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GAR-NUM-SIS IN GDG NOT = GAR-NUM-SIS IN GES OR
              GAR-COD-CRR IN GDG NOT = GAR-COD-CRR IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GAR-COD-CRR IN GES
                              GAR-FEC-VTO-CDT IN GES
                              GAR-COD-ESP IN GES
           ELSE 
               IF GAR-COD-SIS-CDT IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GAR-COD-SIS-CDT IN GES TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'
                       GO TO EXA-VEN-SEG.

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.
           IF GAR-UTP-VIG-TSN IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NDIA
           ELSE
           IF GAR-UTP-VIG-TSN IN TAG = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NMES
           ELSE
           IF GAR-UTP-VIG-TSN IN TAG = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NANO.

           MOVE GAR-FEC-TSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO EXA-VEN-SEG.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO EXA-VEN-SEG.

           MOVE 'TASACION VENCIDA' TO FRM-MEN1.

       EXA-VEN-SEG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSE.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-EXA-VEN-SEG.

      * Se determina si el seguro esta vencido o no


      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC 
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF GAR-FEC-VTO-SEG IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

           MOVE 'SEGURO VENCIDO' TO FRM-MEN2.

       FIN-EXA-VEN-SEG.
       FIN-EXA-VEN-TSN.
           EXIT.

      *<<<< PGM_VMS OR ( PGM_ AND PGM_DTC )
       VLR-DAP SECTION.
       INI-VLR-DAP.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GVT-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GVT-FLD
      *       Es Dep Plazo Propio
               PERFORM BUS-GDO-OPD
               IF MSG-COD-MENS = SPACES
      *Tasa Interes             : INT-TINT
      *Valor Tasa Informada     : INT-TINT
      *Valor de Cambio          : INT-VCAM
      *Fecha Inicial Periodo    : INT-FUNO
      *Fecha Final   Periodo    : INT-FDOS
      *Fecha Basa Tasa Variable : INT-FBTV ( opcional )
      *Fecha de Proceso         : INT-FPRO ( la rutina la obtiene)
                   MOVE OPD-COD-TINT IN OPD TO INT-TIPT
                   MOVE OPD-SGV-TINT IN OPD TO INT-TINT
                   MOVE OPD-COD-VCAM IN OPD TO INT-VCAM
                   MOVE OPD-NUM-DREA IN OPD TO INT-DUNO
                   MOVE OPD-NUM-MREA IN OPD TO INT-MUNO
                   MOVE OPD-NUM-SREA IN OPD TO INT-SUNO
                   MOVE OPD-NUM-AREA IN OPD TO INT-AUNO
                   PERFORM OBT-FDOS
                   PERFORM GNS-CAL-INT
                   IF INT-CMSG = SPACES
                       COMPUTE GAR-VAL-CML-TSN IN GVT ROUNDED = 
                               GAR-VAL-CML-TSN IN GVT +
                               OPD-VAL-SCAP IN OPD * INT-TIPE
                       MOVE GAR-VAL-CML-TSN IN GVT TO
                            GAR-VAL-LIQ-TSN IN GVT
                       MOVE GAR-VAL-CML-TSN IN GVT TO
                            GAR-VAL-PON     IN GVT
                   ELSE
                       GO TO ERR-VLR-DAP
               ELSE
                   GO TO ERR-VLR-DAP.
           GO TO FIN-VLR-DAP.
       ERR-VLR-DAP.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG TO MSG-COD-MENS
               MOVE INT-MENS TO FRM-MENS
           ELSE
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VLR-DAP.
           EXIT.

       OBT-FDOS SECTION.
       INI-OBT-FDOS.
           PERFORM GET-FHOY.
           IF HOY-FHOY NOT > OPD-FEC-FPVC IN OPD
               MOVE HOY-DHOY            TO INT-DDOS
               MOVE HOY-MHOY            TO INT-MDOS
               MOVE HOY-SHOY            TO INT-SDOS
               MOVE HOY-AHOY            TO INT-ADOS
           ELSE
               MOVE OPD-NUM-DPVC IN OPD TO INT-DDOS
               MOVE OPD-NUM-MPVC IN OPD TO INT-MDOS
               MOVE OPD-NUM-SPVC IN OPD TO INT-SDOS
               MOVE OPD-NUM-APVC IN OPD TO INT-ADOS.
       FIN-OBT-FDOS.
           EXIT.


       COPY GARBGEDP.
       BUS-GDO-OPD SECTION.
       INI-BUS-GDO-OPD.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GDO.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GDO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDO    NEX'   TO MSG-COD-MENS
           ELSE
               MOVE GAR-COD-DOC IN GDO TO OPD-CIC-IOPD IN DAP-VARI
               MOVE OPD-CAI-IOPD IN DAP-VARI TO OPD-CAI-IOPD IN OPD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO OPD-IIC-IOPD IN OPD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DAP-FIO-OPD
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'          TO MSG-COD-SIST
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS
               ELSE
               IF OPD-COD-STAT IN OPD NOT = 'G'
                   MOVE 'GAR'            TO MSG-COD-SIST
                   MOVE 'OPD    NOVIG'   TO MSG-COD-MENS.
       FIN-BUS-GDO-OPD.
           EXIT.

      *>>>>
      *>>>>
       COPY GNSBPFEC.
      *<<<< PGM_VMS
           COPY GNSBBMSC.
           COPY GNSBFMSC.
      *>>>>
      *>>>>
