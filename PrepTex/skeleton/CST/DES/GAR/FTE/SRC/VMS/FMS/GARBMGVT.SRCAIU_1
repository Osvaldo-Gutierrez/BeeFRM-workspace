      * 07-JUL-93 06:01 PM
       PUT-ALL-GVT SECTION.
       INI-PUT-ALL-GVT.
           PERFORM PUT-GVT-GVT.
           PERFORM PUT-GDG-GVT.
       FIN-PUT-ALL-GVT.
           EXIT.
       
       PUT-GVT-GVT SECTION.
       INI-PUT-GVT-GVT.
           IF PGM-STAT-GVT-NUL
               GO TO FIN-PUT-GVT-GVT.
           IF NOT PGM-STAT-GVT-OKS
               PERFORM CLR-GVT-GVT
               GO TO FIN-PUT-GVT-GVT.
           MOVE GAR-NUM-SIS IN GVT TO GVT-NUM-SIS IN GVT-FLD.
           MOVE GAR-COD-CRR IN GVT TO GVT-COD-CRR IN GVT-FLD.
           MOVE GAR-COD-TSN IN GVT TO GVT-COD-TSN IN GVT-FLD.
           MOVE GAR-FD-TSN IN GVT TO GVT-FD-TSN IN GVT-FLD.
           MOVE GAR-FM-TSN IN GVT TO GVT-FM-TSN IN GVT-FLD.
           MOVE GAR-FA-TSN IN GVT TO GVT-FA-TSN IN GVT-FLD.
           MOVE GAR-VAL-CML-TSN IN GVT TO GVT-VAL-CML-TSN IN GVT-FLD.
           MOVE GAR-VAL-LIQ-TSN IN GVT TO GVT-VAL-LIQ-TSN IN GVT-FLD.
           MOVE GAR-PCT-PON IN GVT TO GVT-PCT-PON IN GVT-FLD.
           MOVE GAR-VAL-PON IN GVT TO GVT-VAL-PON IN GVT-FLD.
           MOVE GAR-PCT-AJT-SUP IN GVT TO GVT-PCT-AJT-SUP IN GVT-FLD.
           MOVE GAR-VAL-AJT-SUP IN GVT TO GVT-VAL-AJT-SUP IN GVT-FLD.
           MOVE GAR-IIV-TSD IN GVT TO GVT-IIV-TSD IN GVT-FLD.
           MOVE GAR-IIV-SVS IN GVT TO GVT-IIV-SVS IN GVT-FLD.
           MOVE GVT-MSC-STAT IN GVT TO GVT-MSC-STAT IN GVT-FLD.
           MOVE GAR-TIP-CTR IN GVT TO GVT-TIP-CTR IN GVT-FLD.
           MOVE GAR-M2-TRR IN GVT TO GVT-M2-TRR IN GVT-FLD.
           MOVE GAR-COD-UMD IN GVT TO GVT-COD-UMD IN GVT-FLD.
           MOVE GAR-FD-RVL IN GVT TO GVT-FD-RVL IN GVT-FLD.
           MOVE GAR-FM-RVL IN GVT TO GVT-FM-RVL IN GVT-FLD.
           MOVE GAR-FA-RVL IN GVT TO GVT-FA-RVL IN GVT-FLD.
           MOVE GAR-M2-CTR IN GVT TO GVT-M2-CTR IN GVT-FLD.
           MOVE GAR-TIP-MAQ-EQP IN GVT TO GVT-TIP-MAQ-EQP IN GVT-FLD.
           MOVE GVT-FD-ING-SIS IN GVT TO GVT-FD-ING-SIS IN GVT-FLD.
           MOVE GVT-FM-ING-SIS IN GVT TO GVT-FM-ING-SIS IN GVT-FLD.
           MOVE GVT-FA-ING-SIS IN GVT TO GVT-FA-ING-SIS IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-IIV-TSD IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TAS' TO TAB-COD-TTAB IN TAB
               MOVE GVT-IIV-TSD IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-TSD IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-IIV-SVS IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TAS' TO TAB-COD-TTAB IN TAB
               MOVE GVT-IIV-SVS IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-SVS IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-TIP-CTR IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CTR' TO TAB-COD-TTAB IN TAB
               MOVE GVT-TIP-CTR IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-CTR IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-COD-UMD IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'UMD' TO TAB-COD-TTAB IN TAB
               MOVE GVT-COD-UMD IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-UMD IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-TIP-MAQ-EQP IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'MEQ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-TIP-MAQ-EQP IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-MAQ-EQP IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
      *<<<< FIN_PUT_GVT_GVT
      *    Para recordar razon entre VAL-CML y VAL-LIQ
           IF ( SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON OR
                SCR-CMND = 'ATA' AND GAR-IND-CPL IN CMA-VARI = 'S' ) AND

               GVT-VAL-LIQ-TSN IN GVT-FLD > ZEROES AND
               GVT-VAL-CML-TSN IN GVT-FLD > ZEROES

                COMPUTE WSS-LIQ-CML IN CMA-VARI ROUNDED = 
                               GVT-VAL-LIQ-TSN IN GVT-FLD /
                               GVT-VAL-CML-TSN IN GVT-FLD
           ELSE
               MOVE ZEROES TO WSS-LIQ-CML IN CMA-VARI.

       OBT-VEN-TSN.
           PERFORM EXA-VEN-TSN.  
      *>>>>
       FIN-PUT-GVT-GVT.
           EXIT.
       
       PUT-GDG-GVT SECTION.
       INI-PUT-GDG-GVT.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GVT.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GVT
               GO TO FIN-PUT-GDG-GVT.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GVT-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GVT-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GVT-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GVT-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GVT-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GVT-FLD.
           MOVE GAR-VCB-CON IN GDG TO GDG-VCB-CON IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GVT-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GVT-FLD > SPACES
               MOVE GDG-COD-OFI IN GVT-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB-CON IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB-CON IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CON IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB-CON IN GVT-FLD.
      *<<<< FIN_PUT_GDG_GVT
      *<<<< PGM_ OR PGM_VMS
      *    Estos parrafos deben ir aqui, no en PUT-GVT
           IF SCR-CCPP = 'ACC' AND SCR-STPP = SCR-STAT-CON
      *       Valoriza el Deposito a Plazo, si corresponde
               PERFORM VLR-DAP
               MOVE GAR-VAL-CML-TSN IN GVT TO GVT-VAL-CML-TSN IN GVT-FLD
               MOVE GAR-VAL-LIQ-TSN IN GVT TO GVT-VAL-LIQ-TSN IN GVT-FLD
               MOVE GAR-VAL-PON     IN GVT TO GVT-VAL-PON  
                                                            IN GVT-FLD.
      *>>>>
           PERFORM OBT-COD-MNAC.
           PERFORM OBT-VAL-CON.
      *>>>>
       FIN-PUT-GDG-GVT.
           EXIT.
       
       RET-ALL-GVT SECTION.
       INI-RET-ALL-GVT.
           PERFORM KEY-ALL-GVT.
           PERFORM RET-GVT-GVT.
           PERFORM RET-GDG-GVT.
       FIN-RET-ALL-GVT.
           EXIT.
       
       RET-GVT-GVT SECTION.
       INI-RET-GVT-GVT.
           MOVE GVT-FD-TSN IN GVT-FLD TO GAR-FD-TSN IN GVT.
           MOVE GVT-FM-TSN IN GVT-FLD TO GAR-FM-TSN IN GVT.
           MOVE GVT-FA-TSN IN GVT-FLD TO GAR-FA-TSN IN GVT.
           MOVE GVT-VAL-CML-TSN IN GVT-FLD TO GAR-VAL-CML-TSN IN GVT.
           MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO GAR-VAL-LIQ-TSN IN GVT.
           MOVE GVT-PCT-PON IN GVT-FLD TO GAR-PCT-PON IN GVT.
           MOVE GVT-VAL-PON IN GVT-FLD TO GAR-VAL-PON IN GVT.
           MOVE GVT-PCT-AJT-SUP IN GVT-FLD TO GAR-PCT-AJT-SUP IN GVT.
           MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO GAR-VAL-AJT-SUP IN GVT.
           MOVE GVT-IIV-TSD IN GVT-FLD TO GAR-IIV-TSD IN GVT.
           MOVE GVT-IIV-SVS IN GVT-FLD TO GAR-IIV-SVS IN GVT.
           MOVE GVT-MSC-STAT IN GVT-FLD TO GVT-MSC-STAT IN GVT.
           MOVE GVT-TIP-CTR IN GVT-FLD TO GAR-TIP-CTR IN GVT.
           MOVE GVT-M2-TRR IN GVT-FLD TO GAR-M2-TRR IN GVT.
           MOVE GVT-COD-UMD IN GVT-FLD TO GAR-COD-UMD IN GVT.
           MOVE GVT-FD-RVL IN GVT-FLD TO GAR-FD-RVL IN GVT.
           MOVE GVT-FM-RVL IN GVT-FLD TO GAR-FM-RVL IN GVT.
           MOVE GVT-FA-RVL IN GVT-FLD TO GAR-FA-RVL IN GVT.
           MOVE GVT-M2-CTR IN GVT-FLD TO GAR-M2-CTR IN GVT.
           MOVE GVT-TIP-MAQ-EQP IN GVT-FLD TO GAR-TIP-MAQ-EQP IN GVT.
           MOVE GVT-FD-ING-SIS IN GVT-FLD TO GVT-FD-ING-SIS IN GVT.
           MOVE GVT-FM-ING-SIS IN GVT-FLD TO GVT-FM-ING-SIS IN GVT.
           MOVE GVT-FA-ING-SIS IN GVT-FLD TO GVT-FA-ING-SIS IN GVT.
       FIN-RET-GVT-GVT.
           EXIT.
       
       RET-GDG-GVT SECTION.
       INI-RET-GDG-GVT.
           MOVE GDG-TIP-OPE IN GVT-FLD TO GAR-TIP-OPE IN GDG.
           MOVE GDG-STP-OPE IN GVT-FLD TO GAR-STP-OPE IN GDG.
           MOVE GDG-COD-OFI IN GVT-FLD TO GAR-COD-OFI IN GDG.
           MOVE GDG-VCB IN GVT-FLD TO GAR-VCB IN GDG.
           MOVE GDG-DES-1 IN GVT-FLD TO GAR-DES-1 IN GDG.
           MOVE GDG-DES-2 IN GVT-FLD TO GAR-DES-2 IN GDG.
           MOVE GDG-VCB-CON IN GVT-FLD TO GAR-VCB-CON IN GDG.
       FIN-RET-GDG-GVT.
           EXIT.
       
       KEY-ALL-GVT SECTION.
       INI-KEY-ALL-GVT.
           PERFORM KEY-GVT-GVT.
           PERFORM KEY-GDG-GVT.
       FIN-KEY-ALL-GVT.
           EXIT.
       
       KEY-GVT-GVT SECTION.
       INI-KEY-GVT-GVT.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GVT.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GVT.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GVT.
       FIN-KEY-GVT-GVT.
           EXIT.
       
       KEY-GDG-GVT SECTION.
       INI-KEY-GDG-GVT.
       FIN-KEY-GDG-GVT.
           EXIT.
       
       SCR-CLRA-GVT SECTION.
       INI-SCR-CLRA-GVT.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-CLRA-GVT.
           EXIT.
       
       CLR-KEY-GVT SECTION.
       INI-CLR-KEY-GVT.
           MOVE SPACES TO GVT-NUM-SIS IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-CRR IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-TSN IN GVT-FLD.
       FIN-CLR-KEY-GVT.
           EXIT.
       
       CLR-FLD-GVT SECTION.
       INI-CLR-FLD-GVT.
           MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCB-CON IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD.
           MOVE ZEROES TO FRM-VAL-ULT-CON IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
           PERFORM CLR-GVT-GVT.
           PERFORM CLR-GDG-GVT.
       FIN-CLR-FLD-GVT.
           EXIT.
       
       CLR-GVT-GVT SECTION.
       INI-CLR-GVT-GVT.
           MOVE SPACES TO GVT-FEC-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-CML-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-LIQ-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-PCT-PON IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-PON IN GVT-FLD.
           MOVE ZEROES TO GVT-PCT-AJT-SUP IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-AJT-SUP IN GVT-FLD.
           MOVE SPACES TO GVT-IIV-TSD IN GVT-FLD.
           MOVE SPACES TO GVT-IIV-SVS IN GVT-FLD.
           MOVE SPACES TO GVT-MSC-STAT IN GVT-FLD.
           MOVE SPACES TO GVT-TIP-CTR IN GVT-FLD.
           MOVE ZEROES TO GVT-M2-TRR IN GVT-FLD.
           MOVE SPACES TO GVT-COD-UMD IN GVT-FLD.
           MOVE SPACES TO GVT-FEC-RVL IN GVT-FLD.
           MOVE ZEROES TO GVT-M2-CTR IN GVT-FLD.
           MOVE SPACES TO GVT-TIP-MAQ-EQP IN GVT-FLD.
           MOVE SPACES TO GVT-FEC-ING-SIS IN GVT-FLD.
       FIN-CLR-GVT-GVT.
           EXIT.
       
       CLR-GDG-GVT SECTION.
       INI-CLR-GDG-GVT.
           MOVE SPACES TO GDG-TIP-OPE IN GVT-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GVT-FLD.
           MOVE SPACES TO GDG-COD-OFI IN GVT-FLD.
           MOVE SPACES TO GDG-VCB IN GVT-FLD.
           MOVE SPACES TO GDG-DES-1 IN GVT-FLD.
           MOVE SPACES TO GDG-DES-2 IN GVT-FLD.
           MOVE SPACES TO GDG-VCB-CON IN GVT-FLD.
       FIN-CLR-GDG-GVT.
           EXIT.
       
       FST-KEY-GVT SECTION.
       INI-FST-KEY-GVT.
           MOVE -1 TO GVT-NUM-SIS-LEN IN GVT-FLD.
       FIN-FST-KEY-GVT.
           EXIT.
       
       FST-FLD-GVT SECTION.
       INI-FST-FLD-GVT.
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.
      *<<<< FIN_FST_FLD_GVT

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-IIV-TSD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-IIV-SVS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-CTR-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-TRR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-UMD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-CTR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD
               MOVE -1 TO GVT-IIV-TSD-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

           IF SCR-CMND = 'RVL'
      *<<<< NOT PGM_ARG
               MOVE FRM-CPIM-AEY TO GVT-FEC-TSN-ATR IN GVT-FLD
      *>>>>
               MOVE -1 TO GVT-FEC-RVL-LEN IN GVT-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               MOVE -1 TO GVT-FEC-TSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GDP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
      *>>>>
       FIN-FST-FLD-GVT.
           EXIT.
       
       PRO-KEY-GVT SECTION.
       INI-PRO-KEY-GVT.
           PERFORM PRO-IKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM PRO-MKY-GVT.
       FIN-PRO-KEY-GVT.
           EXIT.
       
       PRO-IKY-GVT SECTION.
       INI-PRO-IKY-GVT.
           MOVE FRM-CPIM-AEY TO GVT-NUM-SIS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-CRR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-TSN-ATR IN GVT-FLD.
       FIN-PRO-IKY-GVT.
           EXIT.
       
       PRO-MKY-GVT SECTION.
       INI-PRO-MKY-GVT.
       FIN-PRO-MKY-GVT.
           EXIT.
       
       PRO-AKY-GVT SECTION.
       INI-PRO-AKY-GVT.
       FIN-PRO-AKY-GVT.
           EXIT.
       
       PRO-FLD-GVT SECTION.
       INI-PRO-FLD-GVT.
           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM PRO-GVT-GVT.
           PERFORM PRO-GDG-GVT.
       FIN-PRO-FLD-GVT.
           EXIT.
       
       PRO-GVT-GVT SECTION.
       INI-PRO-GVT-GVT.
           MOVE FRM-CPIM-AEY TO GVT-FEC-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-PCT-PON-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-PCT-AJT-SUP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-IIV-TSD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-IIV-SVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-TIP-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-M2-TRR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-UMD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-M2-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD.
       FIN-PRO-GVT-GVT.
           EXIT.
       
       PRO-GDG-GVT SECTION.
       INI-PRO-GDG-GVT.
       FIN-PRO-GDG-GVT.
           EXIT.
       
       UNP-KEY-GVT SECTION.
       INI-UNP-KEY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM UNP-AKY-GVT.
           PERFORM UNP-MKY-GVT.
       FIN-UNP-KEY-GVT.
           EXIT.
       
       UNP-IKY-GVT SECTION.
       INI-UNP-IKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-TSN-ATR.
       FIN-UNP-IKY-GVT.
           EXIT.
       
       UNP-MKY-GVT SECTION.
       INI-UNP-MKY-GVT.
       FIN-UNP-MKY-GVT.
           EXIT.
       
       UNP-AKY-GVT SECTION.
       INI-UNP-AKY-GVT.
       FIN-UNP-AKY-GVT.
           EXIT.
       
       UNP-FLD-GVT SECTION.
       INI-UNP-FLD-GVT.
           MOVE FRM-CPIM-UBY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM UNP-GVT-GVT.
           PERFORM UNP-GDG-GVT.
       FIN-UNP-FLD-GVT.
           EXIT.
       
       UNP-GVT-GVT SECTION.
       INI-UNP-GVT-GVT.
           MOVE FRM-CPIM-UBY TO GVT-FEC-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-PCT-PON-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-PCT-AJT-SUP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-IIV-TSD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-IIV-SVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-TIP-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-M2-TRR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-UMD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-FEC-RVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-M2-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD.
       FIN-UNP-GVT-GVT.
           EXIT.
       
       UNP-GDG-GVT SECTION.
       INI-UNP-GDG-GVT.
       FIN-UNP-GDG-GVT.
           EXIT.
       
       VAL-KEY-GVT SECTION.
       INI-VAL-KEY-GVT.
           PERFORM VAL-IKY-GVT.
           PERFORM VAL-MKY-GVT.
           PERFORM VAL-AKY-GVT.
       FIN-VAL-KEY-GVT.
           EXIT.
       
       VAL-IKY-GVT SECTION.
       INI-VAL-IKY-GVT.
           PERFORM VAL-GVT-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-NUM-SIS-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-COD-CRR-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-COD-TSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-COD-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
       FIN-VAL-IKY-GVT.
           EXIT.
       
       VAL-MKY-GVT SECTION.
       INI-VAL-MKY-GVT.
       FIN-VAL-MKY-GVT.
           EXIT.
       
       VAL-AKY-GVT SECTION.
       INI-VAL-AKY-GVT.
       FIN-VAL-AKY-GVT.
           EXIT.
       
       VAL-FLD-GVT SECTION.
       INI-VAL-FLD-GVT.
           PERFORM VAL-FRM-IND-GTP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-TIP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-TIP-OPE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-STP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-STP-OPE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-TIP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-OPE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-STP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STP-OPE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-COD-OFI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-OFI-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-OFI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFI-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-REA-NRE-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-VCB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-VCB-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-VCB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-DES-1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-1-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-DES-2.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-2-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-FEC-TSN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-FEC-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-VAL-CML-TSN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-VAL-CML-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-VAL-LIQ-TSN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-VAL-LIQ-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-PCT-PON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-PCT-PON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-VAL-PON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-VAL-PON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-PCT-AJT-SUP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-PCT-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-VAL-AJT-SUP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-VAL-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-IIV-TSD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-IIV-TSD-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-IIV-TSD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-IIV-TSD-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-NUM-GTP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-IIV-SVS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-IIV-SVS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-IIV-SVS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-IIV-SVS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-MSC-STAT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-MSC-STAT-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-TIP-CTR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-TIP-CTR-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-TIP-CTR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-CTR-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GDG-VCB-CON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-VCB-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-M2-TRR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-M2-TRR-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-VCB-CON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-COD-UMD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-COD-UMD-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-UMD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-UMD-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-FEC-RVL.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-FEC-RVL-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-M2-CTR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-M2-CTR-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-VAL-ULT-CON.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-TIP-MAQ-EQP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-TIP-MAQ-EQP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-FRM-GLS-TIP-MAQ-EQP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-MAQ-EQP-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
           PERFORM VAL-GVT-FEC-ING-SIS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-FEC-ING-SIS-LEN IN GVT-FLD
                GO TO FIN-VAL-FLD-GVT.
       FIN-VAL-FLD-GVT.
           EXIT.
       
       VAL-GVT-NUM-SIS SECTION.
       INI-VAL-GVT-NUM-SIS.
           IF GVT-NUM-SIS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-NUM-SIS IN GVT-FLD.
       FIN-VAL-GVT-NUM-SIS.
           EXIT.
       
       VAL-GVT-COD-CRR SECTION.
       INI-VAL-GVT-COD-CRR.
           IF GVT-COD-CRR IN GVT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GVT-COD-CRR.
       FIN-VAL-GVT-COD-CRR.
           EXIT.
       
       VAL-GVT-COD-TSN SECTION.
       INI-VAL-GVT-COD-TSN.
       FIN-VAL-GVT-COD-TSN.
           EXIT.
       
       VAL-FRM-IND-GTP SECTION.
       INI-VAL-FRM-IND-GTP.
           IF FRM-IND-GTP IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
       FIN-VAL-FRM-IND-GTP.
           EXIT.
       
       VAL-GDG-TIP-OPE SECTION.
       INI-VAL-GDG-TIP-OPE.
           IF GDG-TIP-OPE IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-OPE IN GVT-FLD.
       FIN-VAL-GDG-TIP-OPE.
           EXIT.
       
       VAL-GDG-STP-OPE SECTION.
       INI-VAL-GDG-STP-OPE.
           IF GDG-STP-OPE IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-OPE IN GVT-FLD.
       FIN-VAL-GDG-STP-OPE.
           EXIT.
       
       VAL-FRM-GLS-TIP-OPE SECTION.
       INI-VAL-FRM-GLS-TIP-OPE.
           IF FRM-GLS-TIP-OPE IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-OPE IN GVT-FLD.
       FIN-VAL-FRM-GLS-TIP-OPE.
           EXIT.
       
       VAL-FRM-GLS-STP-OPE SECTION.
       INI-VAL-FRM-GLS-STP-OPE.
           IF FRM-GLS-STP-OPE IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-STP-OPE IN GVT-FLD.
       FIN-VAL-FRM-GLS-STP-OPE.
           EXIT.
       
       VAL-GDG-COD-OFI SECTION.
       INI-VAL-GDG-COD-OFI.
           IF GDG-COD-OFI IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-OFI IN GVT-FLD.
       FIN-VAL-GDG-COD-OFI.
           EXIT.
       
       VAL-FRM-GLS-OFI SECTION.
       INI-VAL-FRM-GLS-OFI.
           IF FRM-GLS-OFI IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-OFI IN GVT-FLD.
       FIN-VAL-FRM-GLS-OFI.
           EXIT.
       
       VAL-FRM-GLS-TIP-REA-NRE SECTION.
       INI-VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-GLS-TIP-REA-NRE IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GVT-FLD.
       FIN-VAL-FRM-GLS-TIP-REA-NRE.
           EXIT.
       
       VAL-GDG-VCB SECTION.
       INI-VAL-GDG-VCB.
           IF GDG-VCB IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-VCB IN GVT-FLD.
       FIN-VAL-GDG-VCB.
           EXIT.
       
       VAL-FRM-GLS-VCB SECTION.
       INI-VAL-FRM-GLS-VCB.
           IF FRM-GLS-VCB IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCB IN GVT-FLD.
       FIN-VAL-FRM-GLS-VCB.
           EXIT.
       
       VAL-GDG-DES-1 SECTION.
       INI-VAL-GDG-DES-1.
           IF GDG-DES-1 IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-DES-1 IN GVT-FLD.
       FIN-VAL-GDG-DES-1.
           EXIT.
       
       VAL-GDG-DES-2 SECTION.
       INI-VAL-GDG-DES-2.
           IF GDG-DES-2 IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-DES-2 IN GVT-FLD.
       FIN-VAL-GDG-DES-2.
           EXIT.
       
       VAL-GVT-FEC-TSN SECTION.
       INI-VAL-GVT-FEC-TSN.
      *VAL-FEC Validar Fecha
           MOVE GVT-FEC-TSN IN GVT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GVT_FEC_TSN
           IF SCR-CMND = 'RVL'
               GO TO FIN-VAL-GVT-FEC-TSN.
      *<<<< NOT PGM_ARG
           MOVE GVT-FEC-TSN IN GVT-FLD TO GVT-FEC-RVL IN GVT-FLD.
      *>>>>
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GVT-FEC-TSN IN GVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GVT-FEC-TSN.
      *<<<< GVT_FEC_TSN

           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF WSS-FEC-TSN IN CMA-VARI > ZEROES
               MOVE WSS-FEC-TSN IN CMA-VARI TO FEC-FVLD IN FEC-VARI
           ELSE
               MOVE 1937 TO FEC-FANO IN FEC-VARI
               MOVE   01 TO FEC-FMES IN FEC-VARI
               MOVE   01 TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTTSNANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-TSN.

      *>>>>
       FIN-VAL-GVT-FEC-TSN.
           EXIT.
       
       VAL-GVT-VAL-CML-TSN SECTION.
       INI-VAL-GVT-VAL-CML-TSN.
      *<<<< GVT_VAL_CML_TSN

           PERFORM OBT-COD-MNAC.
           IF SCR-CCPP = 'ING' AND
              FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE ZEROES TO GVT-VAL-CML-TSN IN GVT-FLD
               GO TO FIN-VAL-GVT-VAL-CML-TSN.

           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO WSS-VAL-CML-AUX
               MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GTP
               MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GTP
               MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP
               MOVE 'GAR-CLV-GTP-1' TO FIO-AKEY
               MOVE '00' TO FIO-STAT

      *        Suma las tasaciones parciales para llenar valores CML y LIQ
               PERFORM TOT-GTP VARYING GAR-COD-ITM-TSN IN WSS-VARI
                     FROM 1 BY 1 UNTIL NOT FIO-STAT-OKS
               MOVE WSS-VAL-CML-AUX TO GVT-VAL-CML-TSN IN GVT-FLD.

      * Obtiene valor sin decimales
      *<<<< NOT PGM_ARG
           IF FIO-STAT-OKS AND GDG-VCB IN GVT-FLD = TAB-COD-CTAB IN TAB
      *>>>>
               MOVE GVT-VAL-CML-TSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-CML-TSN IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-VAL-CML-TSN.
           EXIT.
       
       VAL-GVT-VAL-LIQ-TSN SECTION.
       INI-VAL-GVT-VAL-LIQ-TSN.
      *<<<< GVT_VAL_LIQ_TSN

           IF GVT-VAL-LIQ-TSN = ZEROES AND
              WSS-LIQ-CML IN CMA-VARI > ZEROES
               MULTIPLY WSS-LIQ-CML     IN CMA-VARI BY
                        GVT-VAL-CML-TSN IN GVT-FLD GIVING
                        GVT-VAL-LIQ-TSN IN GVT-FLD ROUNDED.

      *<<<< NOT PGM_ARG
           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
      *>>>>
               MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-LIQ-TSN IN GVT-FLD.

            IF NOT (
                    SCR-CCPP = 'ING' AND
                    FRM-IND-GTP IN GVT-FLD = 'S'
                   ) AND
               GVT-VAL-LIQ-TSN IN GVT-FLD NOT > ZEROES
      *        Solo puede ser 0 al Ingresar GVT con Tasaciones Parciales

                MOVE 'GAR'      TO MSG-COD-SIST
                MOVE 'GVTLIQ=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-GVT-VAL-LIQ-TSN.

           IF GVT-VAL-LIQ-TSN IN GVT-FLD >
              GVT-VAL-CML-TSN IN GVT-FLD AND
              NOT (
                  SCR-CCPP = 'ING' AND FRM-IND-GTP IN GVT-FLD = 'S'
                  )
               MOVE 'GAR'     TO MSG-COD-SIST
               MOVE 'GVTLIQ>CML' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-VAL-LIQ-TSN.

      *>>>>
       FIN-VAL-GVT-VAL-LIQ-TSN.
           EXIT.
       
       VAL-GVT-PCT-PON SECTION.
       INI-VAL-GVT-PCT-PON.
      *<<<< GVT_PCT_PON
           IF GVT-PCT-PON IN GVT-FLD = ZEROES
               MOVE GAR-PCT-PON IN CMA-VARI TO GVT-PCT-PON IN GVT-FLD
           ELSE
           IF GVT-PCT-PON IN GVT-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GVT-PCT-PON.
           EXIT.
       
       VAL-GVT-VAL-PON SECTION.
       INI-VAL-GVT-VAL-PON.
      *<<<< GVT_VAL_PON

           COMPUTE GVT-VAL-PON IN GVT-FLD ROUNDED =
                   GVT-VAL-LIQ-TSN IN GVT-FLD *
                   GVT-PCT-PON IN GVT-FLD / 100.

      *<<<< NOT PGM_ARG
           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
      *>>>>
               MOVE GVT-VAL-PON  IN GVT-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GVT-VAL-PON  IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-VAL-PON.
           EXIT.
       
       VAL-GVT-PCT-AJT-SUP SECTION.
       INI-VAL-GVT-PCT-AJT-SUP.
      *<<<< GVT_PCT_AJT_SUP
           MOVE GAR-PCT-AJT-SUP IN CMA-VARI TO GVT-PCT-AJT-SUP
                                                   IN GVT-FLD.
      *>>>>
       FIN-VAL-GVT-PCT-AJT-SUP.
           EXIT.
       
       VAL-GVT-VAL-AJT-SUP SECTION.
       INI-VAL-GVT-VAL-AJT-SUP.
      *<<<< GVT_VAL_AJT_SUP

           COMPUTE   GVT-VAL-AJT-SUP IN GVT-FLD ROUNDED =
                     GVT-VAL-CML-TSN IN GVT-FLD -
                   ( GVT-VAL-CML-TSN IN GVT-FLD *
                     GAR-PCT-AJT-SUP     IN CMA-VARI / 100 ).

      *<<<< NOT PGM_ARG
           IF GDG-VCB IN GVT-FLD = WSS-COD-PESO IN WSS-VARI
      *>>>>
               MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO 
                    PES-SGV-DECI    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE    IN PES-VARI TO
                    GVT-VAL-AJT-SUP IN GVT-FLD.

      * Se contabiliza por valor ajustado, luego debe ser > 0
      *    salvo en el ingreso con Tasaciones Parciales
           IF NOT (
                   SCR-CCPP = 'ING' AND 
                   FRM-IND-GTP IN GVT-FLD = 'S'
                  ) AND
                   GVT-VAL-AJT-SUP IN GVT-FLD NOT > ZEROES
                MOVE 'GAR'     TO MSG-COD-SIST
                MOVE 'GVTAJT=0' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.

           PERFORM OBT-VAL-CON.
      *>>>>
       FIN-VAL-GVT-VAL-AJT-SUP.
           EXIT.
       
       VAL-GVT-IIV-TSD SECTION.
       INI-VAL-GVT-IIV-TSD.
           IF GVT-IIV-TSD IN GVT-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GVT-IIV-TSD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TAS' TO TAB-COD-TTAB IN TAB.
           MOVE GVT-IIV-TSD IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVT-IIV-TSD IN GVT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-TSD IN GVT-FLD.
       FIN-VAL-GVT-IIV-TSD.
           EXIT.
       
       VAL-FRM-GLS-IIV-TSD SECTION.
       INI-VAL-FRM-GLS-IIV-TSD.
           IF FRM-GLS-IIV-TSD IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD.
       FIN-VAL-FRM-GLS-IIV-TSD.
           EXIT.
       
       VAL-FRM-NUM-GTP SECTION.
       INI-VAL-FRM-NUM-GTP.
       FIN-VAL-FRM-NUM-GTP.
           EXIT.
       
       VAL-GVT-IIV-SVS SECTION.
       INI-VAL-GVT-IIV-SVS.
           IF GVT-IIV-SVS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-IIV-SVS IN GVT-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TAS' TO TAB-COD-TTAB IN TAB.
           MOVE GVT-IIV-SVS IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVT-IIV-SVS IN GVT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-SVS IN GVT-FLD.
       FIN-VAL-GVT-IIV-SVS.
           EXIT.
       
       VAL-FRM-GLS-IIV-SVS SECTION.
       INI-VAL-FRM-GLS-IIV-SVS.
           IF FRM-GLS-IIV-SVS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD.
       FIN-VAL-FRM-GLS-IIV-SVS.
           EXIT.
       
       VAL-GVT-MSC-STAT SECTION.
       INI-VAL-GVT-MSC-STAT.
           IF GVT-MSC-STAT IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-MSC-STAT IN GVT-FLD.
       FIN-VAL-GVT-MSC-STAT.
           EXIT.
       
       VAL-GVT-TIP-CTR SECTION.
       INI-VAL-GVT-TIP-CTR.
           IF GVT-TIP-CTR IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-TIP-CTR IN GVT-FLD.
      *<<<< GVT_TIP_CTR
      *ALD-BNL
      * PARA GAR-IND-OBL-CEM = 'E' NO OBLIGA CAMPO GVT-TIP-CTR
           IF GAR-IND-OBL-CEM IN CMA-VARI = 'N' OR
              GAR-IND-OBL-CEM IN CMA-VARI = 'E'
               MOVE SPACES TO GVT-TIP-CTR     IN GVT-FLD
               MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD
               GO TO FIN-VAL-GVT-TIP-CTR.

           IF GVT-TIP-CTR IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPCTR BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'CTR' TO TAB-COD-TTAB IN TAB.
           MOVE GVT-TIP-CTR IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVT-TIP-CTR IN GVT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-CTR IN GVT-FLD.
       FIN-VAL-GVT-TIP-CTR.
           EXIT.
       
       VAL-FRM-GLS-TIP-CTR SECTION.
       INI-VAL-FRM-GLS-TIP-CTR.
           IF FRM-GLS-TIP-CTR IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD.
       FIN-VAL-FRM-GLS-TIP-CTR.
           EXIT.
       
       VAL-GDG-VCB-CON SECTION.
       INI-VAL-GDG-VCB-CON.
           IF GDG-VCB-CON IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GDG-VCB-CON IN GVT-FLD.
       FIN-VAL-GDG-VCB-CON.
           EXIT.
       
       VAL-GVT-M2-TRR SECTION.
       INI-VAL-GVT-M2-TRR.
      *<<<< GVT_M2_TRR
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'T' OR 'A' )
               MOVE ZEROES TO GVT-M2-TRR IN GVT-FLD
               GO TO FIN-VAL-GVT-M2-TRR.

           IF GVT-M2-TRR IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2TRR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GVT-M2-TRR.
           EXIT.
       
       VAL-FRM-GLS-VCB-CON SECTION.
       INI-VAL-FRM-GLS-VCB-CON.
           IF FRM-GLS-VCB-CON IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCB-CON IN GVT-FLD.
       FIN-VAL-FRM-GLS-VCB-CON.
           EXIT.
       
       VAL-GVT-COD-UMD SECTION.
       INI-VAL-GVT-COD-UMD.
           IF GVT-COD-UMD IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-COD-UMD IN GVT-FLD.
      *<<<< GVT_COD_UMD
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'C' OR 'T' OR 'A' )
               MOVE SPACES TO GVT-COD-UMD IN GVT-FLD
               GO TO FIN-VAL-GVT-COD-UMD.

           IF GVT-COD-UMD IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'CODUMD BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'UMD' TO TAB-COD-TTAB IN TAB.
           MOVE GVT-COD-UMD IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVT-COD-UMD IN GVT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-UMD IN GVT-FLD.
       FIN-VAL-GVT-COD-UMD.
           EXIT.
       
       VAL-FRM-GLS-UMD SECTION.
       INI-VAL-FRM-GLS-UMD.
           IF FRM-GLS-UMD IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD.
       FIN-VAL-FRM-GLS-UMD.
           EXIT.
       
       VAL-GVT-FEC-RVL SECTION.
       INI-VAL-GVT-FEC-RVL.
      *VAL-FEC Validar Fecha
           MOVE GVT-FEC-RVL IN GVT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GVT-FEC-RVL IN GVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GVT-FEC-RVL.
      *<<<< GVT_FEC_RVL

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GVT-FA-RVL IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-RVL IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-RVL IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVLANTIGU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-RVL.

      * Suma periodo de vigencia a Fecha Tasacion

           MOVE GVT-FA-TSN IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-TSN IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-TSN IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-DVLD TO FEC-ITM1.

           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'A'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NANO
               MOVE FEC-SUM-ANO TO FEC-CMND
           ELSE
           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'M'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NMES
               MOVE FEC-SUM-MES TO FEC-CMND
           ELSE
           IF GAR-UTP-VIG-TSN IN CMA-VARI = 'D'
               MOVE GAR-PDO-VIG-TSN IN CMA-VARI TO FEC-NDIA
               MOVE FEC-SUM-DIA TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
      *<<<< PGM_VMS
           PERFORM PRO-FEC.
      *>>>>
           
      * Usa fecha resultante como Fecha Maxima de Revalorizacion
           MOVE FEC-ITM1 TO FEC-DEC1.
           MOVE FEC-ITM2 TO FEC-MEC1.
           MOVE FEC-ITM3 TO FEC-SEC1.
           MOVE FEC-ITM4 TO FEC-AEC1.

           MOVE GVT-FA-RVL IN GVT-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GVT-FM-RVL IN GVT-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GVT-FD-RVL IN GVT-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GVTRVL>VIG'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GVT-FEC-RVL.

      *>>>>
       FIN-VAL-GVT-FEC-RVL.
           EXIT.
       
       VAL-GVT-M2-CTR SECTION.
       INI-VAL-GVT-M2-CTR.
      *<<<< GVT_M2_CTR
           IF NOT ( GAR-IND-OBL-MCT IN CMA-VARI = 'C' OR 'A' )
               MOVE ZEROES TO GVT-M2-CTR IN GVT-FLD
               GO TO FIN-VAL-GVT-M2-CTR.

           IF GVT-M2-CTR IN GVT-FLD = ZEROES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'M2CTR BLK'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GVT-M2-CTR.
           EXIT.
       
       VAL-FRM-VAL-ULT-CON SECTION.
       INI-VAL-FRM-VAL-ULT-CON.
       FIN-VAL-FRM-VAL-ULT-CON.
           EXIT.
       
       VAL-GVT-TIP-MAQ-EQP SECTION.
       INI-VAL-GVT-TIP-MAQ-EQP.
           IF GVT-TIP-MAQ-EQP IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-TIP-MAQ-EQP IN GVT-FLD.
      *<<<< GVT_TIP_MAQ_EQP
           IF GAR-IND-OBL-CEM IN CMA-VARI NOT = 'E'
               MOVE SPACES TO GVT-TIP-MAQ-EQP IN GVT-FLD
               MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD
               GO TO FIN-VAL-GVT-TIP-MAQ-EQP.

           IF GVT-TIP-MAQ-EQP IN GVT-FLD = SPACES
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TIPMEQ BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'MEQ' TO TAB-COD-TTAB IN TAB.
           MOVE GVT-TIP-MAQ-EQP IN GVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GVT-TIP-MAQ-EQP IN GVT-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
       FIN-VAL-GVT-TIP-MAQ-EQP.
           EXIT.
       
       VAL-FRM-GLS-TIP-MAQ-EQP SECTION.
       INI-VAL-FRM-GLS-TIP-MAQ-EQP.
           IF FRM-GLS-TIP-MAQ-EQP IN GVT-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
       FIN-VAL-FRM-GLS-TIP-MAQ-EQP.
           EXIT.
       
       VAL-GVT-FEC-ING-SIS SECTION.
       INI-VAL-GVT-FEC-ING-SIS.
       FIN-VAL-GVT-FEC-ING-SIS.
           EXIT.
       
       VAL-CON-KEY-GVT SECTION.
       INI-VAL-CON-KEY-GVT.
      *<<<< INI_VAL_CON_KEY_GVT
           IF FRM-FFLD = FRM-FFLD-PF5
               GO TO FIN-VAL-CON-KEY-GVT.

      *>>>>
           IF     GVT-NUM-SIS IN GVT-FLD NOT > SPACES 
              AND GVT-COD-CRR IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TSN IN GVT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
       FIN-VAL-CON-KEY-GVT.
           EXIT.
       
       VAL-CON-IKY-GVT SECTION.
       INI-VAL-CON-IKY-GVT.
           IF     GVT-NUM-SIS IN GVT-FLD NOT > SPACES 
              AND GVT-COD-CRR IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TSN IN GVT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
      *<<<< FIN_VAL_CON_IKY_GVT
           IF GVT-COD-TSN IN GVT-FLD < 1
               MOVE 1 TO GVT-COD-TSN IN GVT-FLD
           ELSE
           IF GVT-COD-TSN IN GVT-FLD > 1
      *        Comando Ingreso
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'GVTIKY>1' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-IKY-GVT.
           EXIT.
       
       VAL-CON-FLD-GVT SECTION.
       INI-VAL-CON-FLD-GVT.
       FIN-VAL-CON-FLD-GVT.
           EXIT.
       
       VAL-CON-GVT SECTION.
       INI-VAL-CON-GVT.
       FIN-VAL-CON-GVT.
           EXIT.
       
       VAL-NUM-KEY-GVT SECTION.
       INI-VAL-NUM-KEY-GVT.
           PERFORM VAL-NUM-IKY-GVT.
           PERFORM VAL-NUM-MKY-GVT.
           PERFORM VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-KEY-GVT.
           EXIT.
       
       VAL-NUM-IKY-GVT SECTION.
       INI-VAL-NUM-IKY-GVT.
       FIN-VAL-NUM-IKY-GVT.
           EXIT.
       
       VAL-NUM-MKY-GVT SECTION.
       INI-VAL-NUM-MKY-GVT.
       FIN-VAL-NUM-MKY-GVT.
           EXIT.
       
       VAL-NUM-AKY-GVT SECTION.
       INI-VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-AKY-GVT.
           EXIT.
       
       VAL-NUM-FLD-GVT SECTION.
       INI-VAL-NUM-FLD-GVT.
       FIN-VAL-NUM-FLD-GVT.
           EXIT.
      *<<<< EOF_VAX OR EOF_BU
       TOT-GTP SECTION.   
       INI-TOT-GTP.
      *    Devuelve Sumatoria Tasaciones Parciales en WSS-VAL-CML-AUX

           MOVE GAR-COD-ITM-TSN IN WSS-VARI TO
                GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GAR-COD-EST-ITM IN GTP > '09' AND < '15'
                   COMPUTE WSS-VAL-CML-AUX = WSS-VAL-CML-AUX +
                   GAR-CTD-ITM-TSN IN GTP * GAR-VAL-UNT-ITM IN GTP.
       FIN-TOT-GTP.
           EXIT.

      *>>>>
      *<<<< EOF_VAX OR EOF_BQ OR EOF_BU
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-VCB IN GVT-FLD TO GAR-VCB IN GDG.
           IF NOT (
              GAR-TIP-VCB IN GDG = '0' AND
              GDG-VCB IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD
               GO TO FIN-OBT-VAL-CON.

           MOVE GVT-FA-RVL   IN GVT-FLD  TO FEC-FANO.
           MOVE FEC-SVLD                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE FEC-AVLD                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE GVT-FM-RVL   IN GVT-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE GVT-FD-RVL   IN GVT-FLD  TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-VCB      IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-VAL-AJT-SUP IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

      *>>>>
