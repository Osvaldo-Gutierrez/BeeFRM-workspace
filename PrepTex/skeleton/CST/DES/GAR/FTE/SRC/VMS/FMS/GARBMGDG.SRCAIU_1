      * 07-JUL-93 02:44 PM
       PUT-ALL-GDG SECTION.
       INI-PUT-ALL-GDG.
           PERFORM PUT-GDG-GDG.
           PERFORM PUT-DBC-GDG.
       FIN-PUT-ALL-GDG.
           EXIT.
       
       PUT-GDG-GDG SECTION.
       INI-PUT-GDG-GDG.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GDG.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GDG
               GO TO FIN-PUT-GDG-GDG.
           MOVE GAR-NUM-SIS IN GDG TO GDG-NUM-SIS IN GDG-FLD.
           MOVE GAR-COD-CRR IN GDG TO GDG-COD-CRR IN GDG-FLD.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GDG-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GDG-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GDG-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GDG-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GDG-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GDG-FLD.
           MOVE GAR-COD-LIM IN GDG TO GDG-COD-LIM IN GDG-FLD.
           MOVE GAR-COD-EJE-ORI IN GDG TO GDG-COD-EJE-ORI IN GDG-FLD.
           MOVE GAR-COD-GRA IN GDG TO GDG-COD-GRA IN GDG-FLD.
           MOVE GAR-ES1 IN GDG TO GDG-ES1 IN GDG-FLD.
           MOVE GAR-IIV-AUT-ES1 IN GDG TO GDG-IIV-AUT-ES1 IN GDG-FLD.
           MOVE GAR-ES2 IN GDG TO GDG-ES2 IN GDG-FLD.
           MOVE GAR-FD-ALZ IN GDG TO GDG-FD-ALZ IN GDG-FLD.
           MOVE GAR-FM-ALZ IN GDG TO GDG-FM-ALZ IN GDG-FLD.
           MOVE GAR-FA-ALZ IN GDG TO GDG-FA-ALZ IN GDG-FLD.
           MOVE GAR-FD-VTO IN GDG TO GDG-FD-VTO IN GDG-FLD.
           MOVE GAR-FM-VTO IN GDG TO GDG-FM-VTO IN GDG-FLD.
           MOVE GAR-FA-VTO IN GDG TO GDG-FA-VTO IN GDG-FLD.
           MOVE GDG-CAI-ICLI IN GDG TO GDG-CAI-ICLI IN GDG-FLD.
           MOVE GDG-IIC-ICLI IN GDG TO GDG-IIC-ICLI IN GDG-FLD.
           MOVE GAR-FD-SOL-CNS IN GDG TO GDG-FD-SOL-CNS IN GDG-FLD.
           MOVE GAR-FM-SOL-CNS IN GDG TO GDG-FM-SOL-CNS IN GDG-FLD.
           MOVE GAR-FA-SOL-CNS IN GDG TO GDG-FA-SOL-CNS IN GDG-FLD.
           MOVE GAR-FD-ESC-CNS IN GDG TO GDG-FD-ESC-CNS IN GDG-FLD.
           MOVE GAR-FM-ESC-CNS IN GDG TO GDG-FM-ESC-CNS IN GDG-FLD.
           MOVE GAR-FA-ESC-CNS IN GDG TO GDG-FA-ESC-CNS IN GDG-FLD.
           MOVE GAR-IND-OBL-INS IN GDG TO GDG-IND-OBL-INS IN GDG-FLD.
           MOVE GDG-FD-ING-SIS IN GDG TO GDG-FD-ING-SIS IN GDG-FLD.
           MOVE GDG-FM-ING-SIS IN GDG TO GDG-FM-ING-SIS IN GDG-FLD.
           MOVE GDG-FA-ING-SIS IN GDG TO GDG-FA-ING-SIS IN GDG-FLD.
           MOVE GAR-COD-TSN IN GDG TO GDG-COD-TSN IN GDG-FLD.
           MOVE GAR-IND-CPL IN GDG TO GDG-IND-CPL IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GDG-FLD > SPACES
               MOVE GDG-COD-OFI IN GDG-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-LIM IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'LIM' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-LIM IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LIM IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
      *BUS-USR busca usuario en tablas
           IF GDG-COD-EJE-ORI IN GDG-FLD > SPACES
               MOVE GDG-COD-EJE-ORI IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJE-ORI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES1 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE '' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IIV-AUT-ES1 IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ALZ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES2 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES2' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
      *<<<< FIN_PUT_GDG_GDG
           MOVE GAR-ES1 IN GDG TO WSS-EST-ANT IN CMA-VARI.

      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES1 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT2 IN TAB(1) TO WSS-ES1-1 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(2) TO WSS-ES1-2 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(3) TO WSS-ES1-3 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(4) TO WSS-ES1-4 IN CMA-VARI
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF GDG-IIC-ICLI IN GDG > ZEROES
               MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
           IF FIO-STAT-OKS
               MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
               MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.

           MOVE GAR-IND-EXI-GAP IN GDG TO GAR-IND-EXI-GAP IN CMA-VARI.
           MOVE GAR-IND-CPL IN GDG TO GAR-IND-CPL IN CMA-VARI.


      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE GAR-TIP-REA-NRE IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TIP-REA-NRE IN GDG-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.


      *<<<< PGM_VMS OR PGM_ 
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Es Dep Plazo Propio
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
               PERFORM BUS-GDO-OPD
               MOVE OPD-CAI-IOPD IN DAP-VARI TO FRM-CAI-IOPD IN GDG-FLD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
               MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD,
                          FRM-GLS-DEUD IN GDG-FLD.
      *>>>>
      *>>>>
       FIN-PUT-GDG-GDG.
           EXIT.
       
       PUT-DBC-GDG SECTION.
       INI-PUT-DBC-GDG.
      *<<<< INI_PUT_DBC_GDG
           IF DBC-IIC-ICLI IN CMA-VARI > ZEROES
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
           ELSE
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-GDG.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-GDG
               GO TO FIN-PUT-DBC-GDG.
           MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN GDG-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN GDG-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN GDG-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GDG-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GDG-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GDG-FLD.
      *<<<< FIN_PUT_DBC_GDG
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-PUT-DBC-GDG.
           EXIT.
       
       RET-ALL-GDG SECTION.
       INI-RET-ALL-GDG.
           PERFORM KEY-ALL-GDG.
           PERFORM RET-GDG-GDG.
           PERFORM RET-DBC-GDG.
       FIN-RET-ALL-GDG.
           EXIT.
       
       RET-GDG-GDG SECTION.
       INI-RET-GDG-GDG.
           MOVE GDG-COD-OFI IN GDG-FLD TO GAR-COD-OFI IN GDG.
           MOVE GDG-VCB IN GDG-FLD TO GAR-VCB IN GDG.
           MOVE GDG-DES-1 IN GDG-FLD TO GAR-DES-1 IN GDG.
           MOVE GDG-DES-2 IN GDG-FLD TO GAR-DES-2 IN GDG.
           MOVE GDG-COD-LIM IN GDG-FLD TO GAR-COD-LIM IN GDG.
           MOVE GDG-COD-EJE-ORI IN GDG-FLD TO GAR-COD-EJE-ORI IN GDG.
           MOVE GDG-COD-GRA IN GDG-FLD TO GAR-COD-GRA IN GDG.
           MOVE GDG-ES1 IN GDG-FLD TO GAR-ES1 IN GDG.
           MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO GAR-IIV-AUT-ES1 IN GDG.
           MOVE GDG-ES2 IN GDG-FLD TO GAR-ES2 IN GDG.
           MOVE GDG-FD-ALZ IN GDG-FLD TO GAR-FD-ALZ IN GDG.
           MOVE GDG-FM-ALZ IN GDG-FLD TO GAR-FM-ALZ IN GDG.
           MOVE GDG-FA-ALZ IN GDG-FLD TO GAR-FA-ALZ IN GDG.
           MOVE GDG-FD-VTO IN GDG-FLD TO GAR-FD-VTO IN GDG.
           MOVE GDG-FM-VTO IN GDG-FLD TO GAR-FM-VTO IN GDG.
           MOVE GDG-FA-VTO IN GDG-FLD TO GAR-FA-VTO IN GDG.
           MOVE GDG-CAI-ICLI IN GDG-FLD TO GDG-CAI-ICLI IN GDG.
           MOVE GDG-IIC-ICLI IN GDG-FLD TO GDG-IIC-ICLI IN GDG.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO GAR-FD-SOL-CNS IN GDG.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO GAR-FM-SOL-CNS IN GDG.
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO GAR-FA-SOL-CNS IN GDG.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO GAR-FD-ESC-CNS IN GDG.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO GAR-FM-ESC-CNS IN GDG.
           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO GAR-FA-ESC-CNS IN GDG.
           MOVE GDG-IND-OBL-INS IN GDG-FLD TO GAR-IND-OBL-INS IN GDG.
           MOVE GDG-FD-ING-SIS IN GDG-FLD TO GDG-FD-ING-SIS IN GDG.
           MOVE GDG-FM-ING-SIS IN GDG-FLD TO GDG-FM-ING-SIS IN GDG.
           MOVE GDG-FA-ING-SIS IN GDG-FLD TO GDG-FA-ING-SIS IN GDG.
           MOVE GDG-COD-TSN IN GDG-FLD TO GAR-COD-TSN IN GDG.
           MOVE GDG-IND-CPL IN GDG-FLD TO GAR-IND-CPL IN GDG.
      *<<<< FIN_RET_GDG_GDG
           MOVE GDG-VCB IN GDG-FLD TO WSS-VCB.
           IF WSS-TIP-VCB = '1'
               MOVE GDG-VCB IN GDG-FLD TO GAR-VCB-CON IN GDG
           ELSE
      *    Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de Moneda '0999'
               MOVE 'TAB'          TO FIO-SIST
               MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB
               MOVE '0999  '       TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CIC0999  NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   MOVE SPACES              TO GAR-VCB-CON IN GDG
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO GAR-VCB-CON IN GDG.

           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               MOVE WSS-EST-ANT IN CMA-VARI TO GAR-EST-ANT IN GDG.

           IF FRM-NUM-ICLI IN GDG-FLD NOT > ZEROES
               MOVE SPACES TO GDG-CAI-ICLI IN GDG
               MOVE ZEROES TO GDG-IIC-ICLI IN GDG.
      *>>>>
       FIN-RET-GDG-GDG.
           EXIT.
       
       RET-DBC-GDG SECTION.
       INI-RET-DBC-GDG.
           MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC.
       FIN-RET-DBC-GDG.
           EXIT.
       
       KEY-ALL-GDG SECTION.
       INI-KEY-ALL-GDG.
           PERFORM KEY-GDG-GDG.
           PERFORM KEY-DBC-GDG.
       FIN-KEY-ALL-GDG.
           EXIT.
       
       KEY-GDG-GDG SECTION.
       INI-KEY-GDG-GDG.
           MOVE GDG-NUM-SIS IN GDG-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GDG-COD-CRR IN GDG-FLD TO GAR-COD-CRR IN GDG.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN GDG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN GDG.
       FIN-KEY-GDG-GDG.
           EXIT.
       
       KEY-DBC-GDG SECTION.
       INI-KEY-DBC-GDG.
           MOVE DBC-CAI-ICLI IN GDG-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN GDG-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO DBC-VRF-ICLI IN DBC.
       FIN-KEY-DBC-GDG.
           EXIT.
       
       SCR-CLRA-GDG SECTION.
       INI-SCR-CLRA-GDG.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-CLRA-GDG.
           EXIT.
       
       CLR-KEY-GDG SECTION.
       INI-CLR-KEY-GDG.
           MOVE SPACES TO GDG-NUM-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-CRR IN GDG-FLD.
           MOVE SPACES TO DBC-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO DBC-IIC-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO GDG-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GDG-FLD.
       FIN-CLR-KEY-GDG.
           EXIT.
       
       CLR-FLD-GDG SECTION.
       INI-CLR-FLD-GDG.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
           MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD.
           MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.
           PERFORM CLR-GDG-GDG.
           PERFORM CLR-DBC-GDG.
       FIN-CLR-FLD-GDG.
           EXIT.
       
       CLR-GDG-GDG SECTION.
       INI-CLR-GDG-GDG.
           MOVE SPACES TO GDG-COD-OFI IN GDG-FLD.
           MOVE SPACES TO GDG-VCB IN GDG-FLD.
           MOVE SPACES TO GDG-DES-1 IN GDG-FLD.
           MOVE SPACES TO GDG-DES-2 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-LIM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-EJE-ORI IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-GRA IN GDG-FLD.
           MOVE SPACES TO GDG-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-ES2 IN GDG-FLD.
           MOVE SPACES TO GDG-FEC-ALZ IN GDG-FLD.
           MOVE SPACES TO GDG-FEC-VTO IN GDG-FLD.
           MOVE SPACES TO GDG-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO GDG-IIC-ICLI IN GDG-FLD.
           MOVE SPACES TO GDG-FEC-SOL-CNS IN GDG-FLD.
           MOVE SPACES TO GDG-FEC-ESC-CNS IN GDG-FLD.
           MOVE SPACES TO GDG-IND-OBL-INS IN GDG-FLD.
           MOVE SPACES TO GDG-FEC-ING-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-TSN IN GDG-FLD.
           MOVE SPACES TO GDG-IND-CPL IN GDG-FLD.
       FIN-CLR-GDG-GDG.
           EXIT.
       
       CLR-DBC-GDG SECTION.
       INI-CLR-DBC-GDG.
           MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-CLR-DBC-GDG.
           EXIT.
       
       FST-KEY-GDG SECTION.
       INI-FST-KEY-GDG.
           MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD.
       FIN-FST-KEY-GDG.
           EXIT.
       
       FST-FLD-GDG SECTION.
       INI-FST-FLD-GDG.
           MOVE -1 TO DBC-VRF-ICLI-LEN IN GDG-FLD.
      *<<<< FIN_FST_FLD_GDG
      *<<<< PGM_FMS
           MOVE 0 TO DBC-VRF-ICLI-LEN IN GDG-FLD.
      *ALD-BNL Y FLB
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.             
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.         
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
      *ALD-BNL-FIN.
      *<<<< PGM_VMS OR PGM_ 
           IF NOT (
                   CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING'
              )
      *       No Es o No Ingresa Dep Plazo Propio 
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
      *>>>>

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
      *        Siempre que IND este antes que NUM en Pantalla
               MOVE -1           TO DBC-IND-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
                   MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                   GO TO FIN-FST-FLD-GDG.

           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
               MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
                   MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
      * FIN
                   MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
               MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
           ELSE
           IF SCR-CMND = 'AGA'
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-FA-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FM-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FD-VTO IN GDG-FLD.

       FIN-ANL-HBL-FEC-VTO.
      *>>>>
       FIN-FST-FLD-GDG.
           EXIT.
       
       PRO-KEY-GDG SECTION.
       INI-PRO-KEY-GDG.
           PERFORM PRO-IKY-GDG.
           PERFORM PRO-AKY-GDG.
           PERFORM PRO-MKY-GDG.
       FIN-PRO-KEY-GDG.
           EXIT.
       
       PRO-IKY-GDG SECTION.
       INI-PRO-IKY-GDG.
           MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-CRR-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-TIP-OPE-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-STP-OPE-ATR IN GDG-FLD.
       FIN-PRO-IKY-GDG.
           EXIT.
       
       PRO-MKY-GDG SECTION.
       INI-PRO-MKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
       FIN-PRO-MKY-GDG.
           EXIT.
       
       PRO-AKY-GDG SECTION.
       INI-PRO-AKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       FIN-PRO-AKY-GDG.
           EXIT.
       
       PRO-FLD-GDG SECTION.
       INI-PRO-FLD-GDG.
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD.
           PERFORM PRO-GDG-GDG.
           PERFORM PRO-DBC-GDG.
       FIN-PRO-FLD-GDG.
           EXIT.
       
       PRO-GDG-GDG SECTION.
       INI-PRO-GDG-GDG.
           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
       FIN-PRO-GDG-GDG.
           EXIT.
       
       PRO-DBC-GDG SECTION.
       INI-PRO-DBC-GDG.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
       FIN-PRO-DBC-GDG.
           EXIT.
       
       UNP-KEY-GDG SECTION.
       INI-UNP-KEY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM UNP-AKY-GDG.
           PERFORM UNP-MKY-GDG.
       FIN-UNP-KEY-GDG.
           EXIT.
       
       UNP-IKY-GDG SECTION.
       INI-UNP-IKY-GDG.
           MOVE FRM-CPIM-UBY TO GDG-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GDG-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GDG-TIP-OPE-ATR.
           MOVE FRM-CPIM-UBY TO GDG-STP-OPE-ATR.
       FIN-UNP-IKY-GDG.
           EXIT.
       
       UNP-MKY-GDG SECTION.
       INI-UNP-MKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR.
       FIN-UNP-MKY-GDG.
           EXIT.
       
       UNP-AKY-GDG SECTION.
       INI-UNP-AKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-GDG.
           EXIT.
       
       UNP-FLD-GDG SECTION.
       INI-UNP-FLD-GDG.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN GDG-FLD.
           PERFORM UNP-GDG-GDG.
           PERFORM UNP-DBC-GDG.
       FIN-UNP-FLD-GDG.
           EXIT.
       
       UNP-GDG-GDG SECTION.
       INI-UNP-GDG-GDG.
           MOVE FRM-CPIM-UBY TO GDG-COD-OFI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-VCB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-LIM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-GRA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-VTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
       FIN-UNP-GDG-GDG.
           EXIT.
       
       UNP-DBC-GDG SECTION.
       INI-UNP-DBC-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
       FIN-UNP-DBC-GDG.
           EXIT.
       
       VAL-KEY-GDG SECTION.
       INI-VAL-KEY-GDG.
           PERFORM VAL-IKY-GDG.
           PERFORM VAL-MKY-GDG.
           PERFORM VAL-AKY-GDG.
       FIN-VAL-KEY-GDG.
           EXIT.
       
       VAL-IKY-GDG SECTION.
       INI-VAL-IKY-GDG.
           PERFORM VAL-GDG-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-TIP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-STP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
       FIN-VAL-IKY-GDG.
           EXIT.
       
       VAL-MKY-GDG SECTION.
       INI-VAL-MKY-GDG.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
       FIN-VAL-MKY-GDG.
           EXIT.
       
       VAL-AKY-GDG SECTION.
       INI-VAL-AKY-GDG.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-NOMC-LEN IN GDG-FLD
                GO TO FIN-VAL-AKY-GDG.
       FIN-VAL-AKY-GDG.
           EXIT.
       
       VAL-FLD-GDG SECTION.
       INI-VAL-FLD-GDG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-REA-NRE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TIP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-STP-OPE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-CAI-IOPD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-CAI-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-IIC-IOPD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-COD-DEUD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-DEUD.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-OFI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-OFI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-VCB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-VCB-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-VCB.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-DES-1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-DES-2.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-LIM.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-LIM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-LIM.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-LIM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-EJE-ORI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-EJE-ORI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-GRA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-EJE-ORI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-EJE-ORI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-ES1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ES1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IIV-AUT-ES1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IIV-AUT-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-IIV-AUT-ES1.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-IIV-AUT-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-ES2.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ES2.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ES2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ALZ.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ALZ-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-VTO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-VTO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-CAI-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-CAI-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IIC-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-SOL-CNS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-SOL-CNS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ESC-CNS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ESC-CNS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-NOMC-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-OBL-INS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IND-OBL-INS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ING-SIS.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ING-SIS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-TSN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-CPL.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IND-CPL-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
       FIN-VAL-FLD-GDG.
           EXIT.
       
       VAL-GDG-NUM-SIS SECTION.
       INI-VAL-GDG-NUM-SIS.
           IF GDG-NUM-SIS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-NUM-SIS IN GDG-FLD.
       FIN-VAL-GDG-NUM-SIS.
           EXIT.
       
       VAL-GDG-COD-CRR SECTION.
       INI-VAL-GDG-COD-CRR.
       FIN-VAL-GDG-COD-CRR.
           EXIT.
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
           IF DBC-CAI-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-CAI-ICLI IN GDG-FLD.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GDG-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
      *VAL-VRF Valida Verificador
           MOVE VRF-VAL TO VRF-CMND.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-ZERO-S TO VRF-ZERO.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO VRF-NUME.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           PERFORM PRO-VRF.
      *<<<< DBC_VRF_ICLI
      *<<<< PGM_VMS OR PGM_ 
           IF CMA-IND-DAP IN CMA-VARI = 'S' AND
              FRM-COD-DEUD IN GDG-FLD = 'S'
               PERFORM BUS-RCC
               MOVE RCC-CIC-ICLI IN RCC TO DBC-KEY-IDBC IN CMA-VARI
               PERFORM PUT-DBC-GDG
               GO TO FIN-VAL-DBC-VRF-ICLI.

      *>>>>
           IF DBC-IND-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD
      *<<<< NOT PGM_ARG
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDG    MDDIR' TO MSG-COD-MENS
      *>>>>
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN GDG-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

      *<<<< NOT PGM_ARG
           IF SCR-INST = SCR-INST-GKY
               MOVE IDC-ZERO-S TO IDC-ZERO
           ELSE
               MOVE IDC-ZERO-N TO IDC-ZERO.
      *>>>>
      *<<<< NOT PGM_ARG
           IF MSG-COD-MENS NOT > SPACES AND
              DBC-NUM-ICLI IN GDG-FLD > ZEROES
      *>>>>
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
      *<<<< NOT PGM_ARG
                   MOVE 'SGC'        TO MSG-COD-SIST
      *>>>>
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        DBC-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       
       VAL-FRM-GLS-TIP-REA-NRE SECTION.
       INI-VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-GLS-TIP-REA-NRE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.
       FIN-VAL-FRM-GLS-TIP-REA-NRE.
           EXIT.
       
       VAL-GDG-TIP-OPE SECTION.
       INI-VAL-GDG-TIP-OPE.
           IF GDG-TIP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-OPE IN GDG-FLD.
      *<<<< GDG_TIP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-TIP-OPE.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-TIP-OPE IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GDG-FLD.
       FIN-VAL-GDG-TIP-OPE.
           EXIT.
       
       VAL-GDG-STP-OPE SECTION.
       INI-VAL-GDG-STP-OPE.
           IF GDG-STP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-OPE IN GDG-FLD.
      *<<<< GDG_STP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-STP-OPE.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD
               GO TO FIN-VAL-GDG-STP-OPE.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE GAR-TIP-REA-NRE IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TIP-REA-NRE IN GDG-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.


      *>>>>
       FIN-VAL-GDG-STP-OPE.
           EXIT.
       
       VAL-FRM-GLS-TIP-OPE SECTION.
       INI-VAL-FRM-GLS-TIP-OPE.
           IF FRM-GLS-TIP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
       FIN-VAL-FRM-GLS-TIP-OPE.
           EXIT.
       
       VAL-FRM-GLS-STP-OPE SECTION.
       INI-VAL-FRM-GLS-STP-OPE.
           IF FRM-GLS-STP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
       FIN-VAL-FRM-GLS-STP-OPE.
           EXIT.
       
       VAL-FRM-CAI-IOPD SECTION.
       INI-VAL-FRM-CAI-IOPD.
           IF FRM-CAI-IOPD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
       FIN-VAL-FRM-CAI-IOPD.
           EXIT.
       
       VAL-FRM-IIC-IOPD SECTION.
       INI-VAL-FRM-IIC-IOPD.
      *<<<< FRM_IIC_IOPD AND ( PGM_ OR PGM_VMS )
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
               GO TO FIN-VAL-FRM-IIC-IOPD.

           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'OPD    NEX'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-STAT IN OPD NOT = 'G'
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPD    NOVIG'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-GPOD IN OPD = 'N'
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPDNOPERMITI'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE OPD-COD-VCAM IN OPD TO GDG-VCB         IN GDG-FLD
               MOVE 'N'                 TO GDG-IND-OBL-INS IN GDG-FLD
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB
               MOVE '001' TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS > SPACES
      *            FLB: version 'B'anco
                   MOVE 'B' TO SCR-IND-V001
                   MOVE SPACES TO MSG-COD-MENS
               ELSE
      *            FLB: version 'C'onsist
                   MOVE 'C' TO SCR-IND-V001.
      *>>>>
       FIN-VAL-FRM-IIC-IOPD.
           EXIT.
       
       VAL-FRM-COD-DEUD SECTION.
       INI-VAL-FRM-COD-DEUD.
           IF FRM-COD-DEUD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
      *<<<< FRM_COD_DEUD AND ( PGM_ OR PGM_VMS )
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
               GO TO FIN-VAL-FRM-COD-DEUD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'DAP' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-DEUD IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-DEUD IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-DEUD IN GDG-FLD.

      *>>>>
       FIN-VAL-FRM-COD-DEUD.
           EXIT.
       
       VAL-FRM-GLS-DEUD SECTION.
       INI-VAL-FRM-GLS-DEUD.
           IF FRM-GLS-DEUD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
       FIN-VAL-FRM-GLS-DEUD.
           EXIT.
       
       VAL-GDG-COD-OFI SECTION.
       INI-VAL-GDG-COD-OFI.
           IF GDG-COD-OFI IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-OFI.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE GDG-COD-OFI IN GDG-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GDG-FLD.
       FIN-VAL-GDG-COD-OFI.
           EXIT.
       
       VAL-FRM-GLS-OFI SECTION.
       INI-VAL-FRM-GLS-OFI.
           IF FRM-GLS-OFI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
       FIN-VAL-FRM-GLS-OFI.
           EXIT.
       
       VAL-GDG-VCB SECTION.
       INI-VAL-GDG-VCB.
           IF GDG-VCB IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-VCB.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-VCB IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-VCB IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GDG-FLD.
       FIN-VAL-GDG-VCB.
           EXIT.
       
       VAL-FRM-GLS-VCB SECTION.
       INI-VAL-FRM-GLS-VCB.
           IF FRM-GLS-VCB IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
       FIN-VAL-FRM-GLS-VCB.
           EXIT.
       
       VAL-GDG-DES-1 SECTION.
       INI-VAL-GDG-DES-1.
           IF GDG-DES-1 IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-DES-1.
       FIN-VAL-GDG-DES-1.
           EXIT.
       
       VAL-GDG-DES-2 SECTION.
       INI-VAL-GDG-DES-2.
           IF GDG-DES-2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-DES-2 IN GDG-FLD.
       FIN-VAL-GDG-DES-2.
           EXIT.
       
       VAL-GDG-COD-LIM SECTION.
       INI-VAL-GDG-COD-LIM.
           IF GDG-COD-LIM IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-LIM.
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'LIM' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-LIM IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-LIM IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LIM IN GDG-FLD.
       FIN-VAL-GDG-COD-LIM.
           EXIT.
       
       VAL-FRM-GLS-LIM SECTION.
       INI-VAL-FRM-GLS-LIM.
           IF FRM-GLS-LIM IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
       FIN-VAL-FRM-GLS-LIM.
           EXIT.
       
       VAL-GDG-COD-EJE-ORI SECTION.
       INI-VAL-GDG-COD-EJE-ORI.
           IF GDG-COD-EJE-ORI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-EJE-ORI IN GDG-FLD.
      *<<<< GDG_COD_EJE_ORI AND ( PGM_ OR PGM_VMS )
           IF GDG-COD-EJE-ORI IN GDG-FLD = SPACES AND
              CMA-IND-DAP IN CMA-VARI = 'S'
               MOVE OPD-COD-EJEC IN OPD TO GDG-COD-EJE-ORI IN GDG-FLD.
      *>>>>
      *VAL-USR Valida Usuario
           MOVE GDG-COD-EJE-ORI IN GDG-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJE-ORI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
       FIN-VAL-GDG-COD-EJE-ORI.
           EXIT.
       
       VAL-GDG-COD-GRA SECTION.
       INI-VAL-GDG-COD-GRA.
      *<<<< GDG_COD_GRA
           IF GDG-COD-GRA IN GDG-FLD = '1' AND (
              GAR-IND-EXI-GAP IN CMA-VARI = 'C' OR
              GAR-IND-EXI-GAP IN CMA-VARI = 'S')
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GRAEXIGAP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-COD-GRA.
           EXIT.
       
       VAL-FRM-GLS-EJE-ORI SECTION.
       INI-VAL-FRM-GLS-EJE-ORI.
           IF FRM-GLS-EJE-ORI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
       FIN-VAL-FRM-GLS-EJE-ORI.
           EXIT.
       
       VAL-GDG-ES1 SECTION.
       INI-VAL-GDG-ES1.
           IF GDG-ES1 IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-ES1.
      *<<<< GDG_ES1
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES1
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF SCR-CCPP = 'ING'  OR 
                  GAR-IND-CPL IN CMA-VARI NOT = 'S'

               IF GDG-ES1 IN GDG-FLD > '10'
                   MOVE 'GDGES1NOVIG' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1
               ELSE
                   GO TO FIN-VAL-GDG-ES1.

      * CAMBIOS DE ESTADO
           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               IF NOT (GDG-ES1 IN GDG-FLD = WSS-ES1-1 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-2 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-3 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-4 IN CMA-VARI)
                   MOVE 'ES1NVOANT' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

      * ALZAMIENTO
           IF SCR-CMND = 'ALZ' AND GDG-ES1 IN GDG-FLD < '20'
                   MOVE 'GDGALZES1' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

           GO TO FIN-VAL-GDG-ES1.

       ERR-VAL-GDG-ES1.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE '' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.
       FIN-VAL-GDG-ES1.
           EXIT.
       
       VAL-FRM-GLS-ES1 SECTION.
       INI-VAL-FRM-GLS-ES1.
           IF FRM-GLS-ES1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD.
       FIN-VAL-FRM-GLS-ES1.
           EXIT.
       
       VAL-GDG-IIV-AUT-ES1 SECTION.
       INI-VAL-GDG-IIV-AUT-ES1.
           IF GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD.
      *<<<< GDG_IIV_AUT_ES1
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-IIV-AUT-ES1.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ALZ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
       FIN-VAL-GDG-IIV-AUT-ES1.
           EXIT.
       
       VAL-FRM-GLS-IIV-AUT-ES1 SECTION.
       INI-VAL-FRM-GLS-IIV-AUT-ES1.
           IF FRM-GLS-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
       FIN-VAL-FRM-GLS-IIV-AUT-ES1.
           EXIT.
       
       VAL-GDG-ES2 SECTION.
       INI-VAL-GDG-ES2.
           IF GDG-ES2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-ES2 IN GDG-FLD.
      *<<<< GDG_ES2
           IF (SCR-CCPP = 'ING') OR (SCR-CMND NOT = 'EJE') AND
              (GDG-ES2 IN GDG-FLD NOT > SPACES)
                MOVE SPACES TO GDG-ES2 IN GDG-FLD
                MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
                GO TO FIN-VAL-GDG-ES2.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES2
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD.
       FIN-VAL-GDG-ES2.
           EXIT.
       
       VAL-FRM-GLS-ES2 SECTION.
       INI-VAL-FRM-GLS-ES2.
           IF FRM-GLS-ES2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
       FIN-VAL-FRM-GLS-ES2.
           EXIT.
       
       VAL-GDG-FEC-ALZ SECTION.
       INI-VAL-GDG-FEC-ALZ.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-ALZ IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ALZ
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE 0 TO GDG-FA-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FM-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FD-ALZ IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ALZ.

      * ALZAMIENTO
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-ALZ IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-ALZ.
      *<<<< GDG_FEC_ALZ
           
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-GDG-FEC-ALZ.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ALZ IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ALZ IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ALZ IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ALZ<CNS' TO MSG-COD-MENS
               MOVE 'GAR'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-FEC-ALZ.
           EXIT.
       
       VAL-GDG-FEC-VTO SECTION.
       INI-VAL-GDG-FEC-VTO.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-VTO IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_VTO
           MOVE FEC-VHBL-N TO FEC-VHBL.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA.
           IF GAR-IND-VTO IN CMA-VARI = 'S'
               IF FEC-FVLD = '00000000' OR > '20201231' 
                   MOVE 'VTO=0' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-FEC-VTO
               ELSE
                   NEXT SENTENCE
           ELSE
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE 2099 TO GDG-FA-VTO IN GDG-FLD
               MOVE   12 TO GDG-FM-VTO IN GDG-FLD
               MOVE   31 TO GDG-FD-VTO IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-VTO.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-VTO IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-VTO.
      *<<<< GDG_FEC_VTO
           
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=SOL' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-VTO.

           GO TO FIN-VAL-GDG-FEC-VTO.
       ERR-VAL-GDG-FEC-VTO.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-FEC-VTO.
           EXIT.
       
       VAL-GDG-CAI-ICLI SECTION.
       INI-VAL-GDG-CAI-ICLI.
           IF GDG-CAI-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-CAI-ICLI IN GDG-FLD.
       FIN-VAL-GDG-CAI-ICLI.
           EXIT.
       
       VAL-GDG-IIC-ICLI SECTION.
       INI-VAL-GDG-IIC-ICLI.
       FIN-VAL-GDG-IIC-ICLI.
           EXIT.
       
       VAL-GDG-FEC-SOL-CNS SECTION.
       INI-VAL-GDG-FEC-SOL-CNS.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-SOL-CNS IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_SOL_CNS
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-SOL-CNS IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-SOL-CNS.
       FIN-VAL-GDG-FEC-SOL-CNS.
           EXIT.
       
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
           IF FRM-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE FRM-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO FRM-IND-ICLI IN GDG-FLD.
       FIN-VAL-FRM-IND-ICLI.
           EXIT.
       
       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
           IF FRM-GLS-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN GDG-FLD.
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.
       
       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.
       
       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD.
      *VAL-VRF Valida Verificador
           MOVE VRF-VAL TO VRF-CMND.
           MOVE VRF-SVRF-K TO VRF-SVRF.
           MOVE VRF-ZERO-S TO VRF-ZERO.
           MOVE FRM-NUM-ICLI IN GDG-FLD TO VRF-NUME.
           MOVE FRM-VRF-ICLI IN GDG-FLD TO VRF-DVRF.
           MOVE 7 TO VRF-LMAX.
           PERFORM PRO-VRF.
      *<<<< FRM_VRF_ICLI
      *<<<< NOT PGM_ARG
           IF SCR-INST = SCR-INST-GKY
               MOVE IDC-ZERO-S TO IDC-ZERO
           ELSE
               MOVE IDC-ZERO-N TO IDC-ZERO.
      *>>>>
           IF FRM-NUM-ICLI IN GDG-FLD > ZEROES
               MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.
       
       VAL-GDG-FEC-ESC-CNS SECTION.
       INI-VAL-GDG-FEC-ESC-CNS.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-ESC-CNS IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ESC_CNS
           IF GDG-ES1 IN GDG-FLD < '10'
               MOVE 0 TO GDG-FA-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FM-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FD-ESC-CNS IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           IF GDG-ES1 IN GDG-FLD > '19'
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-ESC-CNS IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.
      *<<<< GDG_FEC_ESC_CNS

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ESC<SOL' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO FEC-SEC1.
           MOVE HOY-AHOY TO FEC-AEC1.
           MOVE HOY-MHOY TO FEC-MEC1.
           MOVE HOY-DHOY TO FEC-DEC1.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'ESC>HOY' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
       FIN-VAL-GDG-FEC-ESC-CNS.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
           IF FRM-GLS-NOMC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-GDG-IND-OBL-INS SECTION.
       INI-VAL-GDG-IND-OBL-INS.
           IF GDG-IND-OBL-INS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-OBL-INS IN GDG-FLD.
      *<<<< GDG_IND_OBL_INS
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-OBL-INS IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-GDG-IND-OBL-INS.
           EXIT.
       
       VAL-GDG-FEC-ING-SIS SECTION.
       INI-VAL-GDG-FEC-ING-SIS.
       FIN-VAL-GDG-FEC-ING-SIS.
           EXIT.
       
       VAL-GDG-COD-TSN SECTION.
       INI-VAL-GDG-COD-TSN.
       FIN-VAL-GDG-COD-TSN.
           EXIT.
       
       VAL-GDG-IND-CPL SECTION.
       INI-VAL-GDG-IND-CPL.
           IF GDG-IND-CPL IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-CPL IN GDG-FLD.
       FIN-VAL-GDG-IND-CPL.
           EXIT.
       
       VAL-CON-KEY-GDG SECTION.
       INI-VAL-CON-KEY-GDG.
      *<<<< INI_VAL_CON_KEY_GDG
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 OR
              FRM-FFLD = FRM-FFLD-PF5 OR
              FRM-FFLD = FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-GDG.
      *>>>>
           IF     GDG-NUM-SIS IN GDG-FLD NOT > SPACES 
              AND GDG-COD-CRR IN GDG-FLD NOT > ZEROES 
              AND DBC-CAI-ICLI IN GDG-FLD NOT > SPACES 
              AND DBC-IIC-ICLI IN GDG-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDG-FLD NOT > SPACES 
              AND DBC-IND-ICLI IN GDG-FLD NOT > SPACES 
              AND DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES 
              AND DBC-VRF-ICLI IN GDG-FLD NOT > SPACES 
              AND GDG-TIP-OPE IN GDG-FLD NOT > SPACES 
              AND GDG-STP-OPE IN GDG-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-KEY-GDG.
           EXIT.
       
       VAL-CON-IKY-GDG SECTION.
       INI-VAL-CON-IKY-GDG.
      *<<<< INI_VAL_CON_IKY_GDG
           PERFORM VAL-GDG-TIP-OPE.
           PERFORM VAL-GDG-STP-OPE.
 
           MOVE GAR-IND-VTO IN TAG TO GAR-IND-VTO IN CMA-VARI.
      *<<<< PGM_VMS OR PGM_ 
           MOVE GAR-PCT-PON IN TAG TO GAR-PCT-PON IN CMA-VARI.
           MOVE GAR-PCT-AJT-SUP IN TAG TO 
                GAR-PCT-AJT-SUP IN CMA-VARI.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Ingresa Dep Plazo Propio 
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.
      *>>>>
      *>>>>
           IF     GDG-NUM-SIS IN GDG-FLD NOT > SPACES 
              AND GDG-COD-CRR IN GDG-FLD NOT > ZEROES 
              AND GDG-TIP-OPE IN GDG-FLD NOT > SPACES 
              AND GDG-STP-OPE IN GDG-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-IKY-GDG.
           EXIT.
       
       VAL-CON-FLD-GDG SECTION.
       INI-VAL-CON-FLD-GDG.
       FIN-VAL-CON-FLD-GDG.
           EXIT.
       
       VAL-CON-GDG SECTION.
       INI-VAL-CON-GDG.
       FIN-VAL-CON-GDG.
           EXIT.
       
       VAL-NUM-KEY-GDG SECTION.
       INI-VAL-NUM-KEY-GDG.
           PERFORM VAL-NUM-IKY-GDG.
           PERFORM VAL-NUM-MKY-GDG.
           PERFORM VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-KEY-GDG.
           EXIT.
       
       VAL-NUM-IKY-GDG SECTION.
       INI-VAL-NUM-IKY-GDG.
       FIN-VAL-NUM-IKY-GDG.
           EXIT.
       
       VAL-NUM-MKY-GDG SECTION.
       INI-VAL-NUM-MKY-GDG.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GDG-FLD TO FRM-ANFL.
           MOVE 8 TO FRM-J.
           MOVE 8 TO FRM-K.
       LU1-VAL-NUM-DBC-NUM-ICLI-0.
           IF FRM-ANFL-CHR( FRM-J ) NOT > SPACES
               SUBTRACT 1 FROM FRM-J
               IF FRM-J > 0
                   GO TO LU1-VAL-NUM-DBC-NUM-ICLI-0.
       LU2-VAL-NUM-DBC-NUM-ICLI-0.
           IF ( FRM-J > 0 ) AND ( FRM-J NOT = 8 )
               MOVE FRM-ANFL-CHR( FRM-J ) TO FRM-ANFL-CHR( FRM-K )
               SUBTRACT 1 FROM FRM-J
               SUBTRACT 1 FROM FRM-K
               GO TO LU2-VAL-NUM-DBC-NUM-ICLI-0.
       LU3-VAL-NUM-DBC-NUM-ICLI-0.
           IF FRM-K > 0 AND FRM-K NOT = 8
               MOVE SPACES TO FRM-ANFL-CHR( FRM-K )
               SUBTRACT 1 FROM FRM-K
               GO TO LU3-VAL-NUM-DBC-NUM-ICLI-0.
           MOVE FRM-ANFL TO DBC-NUM-ICLI-ALF IN GDG-FLD.

           INSPECT DBC-NUM-ICLI-ALF IN GDG-FLD
                   REPLACING LEADING SPACES BY ZEROES.
           IF DBC-NUM-ICLI-ALF IN GDG-FLD IS NOT NUMERIC
               MOVE 'FORMATO NUMERICO INVALIDO' TO FRM-MENS
               MOVE -9 TO DBC-NUM-ICLI-LEN IN GDG-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR 
              FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-NUM-MKY-GDG.
       FIN-VAL-NUM-MKY-GDG.
           EXIT.
       
       VAL-NUM-AKY-GDG SECTION.
       INI-VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-AKY-GDG.
           EXIT.
       
       VAL-NUM-FLD-GDG SECTION.
       INI-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN GDG-FLD TO FRM-ANFL.
           MOVE 8 TO FRM-J.
           MOVE 8 TO FRM-K.
       LU1-VAL-NUM-FRM-NUM-ICLI-0.
           IF FRM-ANFL-CHR( FRM-J ) NOT > SPACES
               SUBTRACT 1 FROM FRM-J
               IF FRM-J > 0
                   GO TO LU1-VAL-NUM-FRM-NUM-ICLI-0.
       LU2-VAL-NUM-FRM-NUM-ICLI-0.
           IF ( FRM-J > 0 ) AND ( FRM-J NOT = 8 )
               MOVE FRM-ANFL-CHR( FRM-J ) TO FRM-ANFL-CHR( FRM-K )
               SUBTRACT 1 FROM FRM-J
               SUBTRACT 1 FROM FRM-K
               GO TO LU2-VAL-NUM-FRM-NUM-ICLI-0.
       LU3-VAL-NUM-FRM-NUM-ICLI-0.
           IF FRM-K > 0 AND FRM-K NOT = 8
               MOVE SPACES TO FRM-ANFL-CHR( FRM-K )
               SUBTRACT 1 FROM FRM-K
               GO TO LU3-VAL-NUM-FRM-NUM-ICLI-0.
           MOVE FRM-ANFL TO FRM-NUM-ICLI-ALF IN GDG-FLD.

           INSPECT FRM-NUM-ICLI-ALF IN GDG-FLD
                   REPLACING LEADING SPACES BY ZEROES.
           IF FRM-NUM-ICLI-ALF IN GDG-FLD IS NOT NUMERIC
               MOVE 'FORMATO NUMERICO INVALIDO' TO FRM-MENS
               MOVE -9 TO FRM-NUM-ICLI-LEN IN GDG-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR 
              FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-NUM-FLD-GDG.
       FIN-VAL-NUM-FLD-GDG.
           EXIT.
      *<<<< EOF_BU AND PGM_ OR EOF_VAX
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *>>>>
