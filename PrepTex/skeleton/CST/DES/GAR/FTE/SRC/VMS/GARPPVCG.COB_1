       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.     GARPPVCG.
       AUTHOR.          CONSIST.
       
      * Subrutina Pone Estado Garantia Completa
      * Este programa es invocado desde cualquier programa de actualizacion
      *   de garantias, y su funcion es chequear que la gtia tenga ingresadas
      *   las entidades (obligatorias y opcionales) que corresponde segun
      *   la tabla TAG. Si tiene entidades que no corresponde, ellas se 
      *   eliminan. Tambien graba registros GMO para cada entidad 
      *   ingresada. Si hay una entidad que falta, salta al programa que
      *   ingresa dicha entidad.
      *
      * SI HAY UN ERROR DEVUELVE MSG-COD-MENS CON EL CODIGO DEL MENSAJE ERROR
      * EL ERROR SE MANEJA EN PROGRAMA LLAMADOR
       
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       
       DATA DIVISION.
      *=============

       WORKING-STORAGE SECTION.
      *-----------------------
       01 WSS-VARI.
          03 WSS-IMAL                  VALUE 0           PIC 9(01).
       01 SCR-VARI.
          03 SCR-CMND                  VALUE 'ING'       PIC X(03).
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GARBRGDD.
       COPY GARBRGES.
       COPY GARBRGLE.
       COPY GARBRGDO.
       COPY GARBRGSE.
       COPY GARBRGVT.
       COPY GARBRGTP.
       COPY GARBRGUB.
       COPY GARBRGMO.
       COPY GARBRGAP.
       COPY GARBRGIN.
       COPY GARBRGSI.
       COPY GARBRGDP.
       COPY GNSWGHOY.
       COPY GNSWGSYS.


       LINKAGE SECTION.
      *---------------
       COPY GARBRGDG.
       COPY GARBRTAG.
       COPY GNSBRMSG.
       01 WSS-REG				PIC X(03).
       
       PROCEDURE DIVISION USING GDG TAG MSG MSG-VARI WSS-REG.
      *======================================================
       
       MAIN SECTION.
      *------------
       INI-MAIN.
      *<<<< INI_FIO
           MOVE 'GAR'        TO FIO-SIST.
           IF WSS-REG = 'GDD' OR 'GDG' GO TO OPE-GES.
       OPE-GDD.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
       OPE-GES.
           IF WSS-REG = 'GES' GO TO OPE-GIN.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       OPE-GIN.
           IF WSS-REG = 'GIN' GO TO OPE-GLE.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
       OPE-GLE.
           IF WSS-REG = 'GLE' GO TO OPE-GDO.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
       OPE-GDO.
           IF WSS-REG = 'GDO' GO TO OPE-GSE.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
       OPE-GSE.
           IF WSS-REG = 'GSE' GO TO OPE-GVT.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
       OPE-GVT.
           IF WSS-REG = 'GVT' OR 'GTP' OR 'GSE' OR 'GDP'
               GO TO OPE-GTP.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GVT.

       OPE-GTP.
           IF WSS-REG = 'GVT' OR 'GTP'
               GO TO OPE-GUB.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
       OPE-GUB.
           IF WSS-REG = 'GUB' GO TO OPE-GAP.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
       OPE-GAP.
       OPE-GMO.
           IF WSS-REG = 'GAP' OR 'GDG' OR 'GDD' OR 'GES' OR 'GVT'
               GO TO FIN-OPE.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
       FIN-OPE.
      *>>>>
       COPY GARBGVC1.

      * TERMINA NORMALMENTE EN EXT-MAIN.

       FIN-MAIN.
           STOP RUN.

       EXT-MAIN.
      *<<<< EXT_MAIN
           IF WSS-REG = 'GDD' OR 'GDG' GO TO CLO-GES.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDD.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
       CLO-GES.
           IF WSS-REG = 'GES' GO TO CLO-GIN.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GES.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       CLO-GIN.
           IF WSS-REG = 'GIN' GO TO CLO-GLE.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GIN.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
       CLO-GLE.
           IF WSS-REG = 'GLE' GO TO CLO-GDO.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GLE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
       CLO-GDO.
           IF WSS-REG = 'GDO' GO TO CLO-GSE.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDO.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
       CLO-GSE.
           IF WSS-REG = 'GSE' GO TO CLO-GVT.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GSE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
       CLO-GVT.
           IF WSS-REG = 'GVT' OR 'GTP' OR 'GSE' OR 'GDP'
               GO TO CLO-GTP.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
       CLO-GTP.
           IF WSS-REG = 'GVT' OR 'GTP'
               GO TO CLO-GUB.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GTP.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
       CLO-GUB.
           IF WSS-REG = 'GUB' GO TO CLO-GAP.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GUB.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
       CLO-GAP.
       CLO-GMO.
           IF WSS-REG = 'GAP' OR 'GDG' OR 'GDD' OR 'GES' OR 'GVT'
               GO TO FIN-CLO.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GMO.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GAR-FIO-GMO.
       FIN-CLO.
      *>>>>

           EXIT PROGRAM.

       COPY GARBGVC2.

       EOF SECTION.
       INI-EOF.
           COPY GARBFGDG.
           COPY GARBFGDD.
           COPY GARBFGES.
           COPY GARBFGLE.
           COPY GARBFGDO.
           COPY GARBFGSE.
           COPY GARBFGVT.
           COPY GARBFGTP.
           COPY GARBFGUB.
           COPY GARBFGMO.
           COPY GARBFGAP.
           COPY GARBFGIN.
           COPY GARBFGSI.
           COPY GARBFGDP.

       COPY GNSBGSYS.
       COPY GNSBGHOY.


