*% IF CMAVARI*% IF PGM_IBM           02 CMA-VARI.*% ELSE           03 CMA-VARI.*% END              05  WSS-POS-INI            COMP-3       PIC S9(5).              05  WSS-POS-ACT            COMP-3       PIC S9(5).              05  WSS-POS-FIN            COMP-3       PIC S9(5).              05  WSS-CLV-INI.                  07 {KEYPADPAD}-INI                 PIC X({LENKEYPAD}).              05  WSS-CLV-FIN.                  07 {KEYPADPAD}                     PIC X({LENKEYPAD}).      *>>>>*% END*% IF WSSVARI       01  WSS-VARI.           03  WSS-IMAX               VALUE {IMAX}     PIC 9(02).           03  WSS-IND-ACUMULA        VALUE 0      PIC 9(01).               88 DESPLIEGA           VALUE 0.               88 SOLO-ACUMULA        VALUE 1.               88 ACUMULA             VALUE 0 , 1.           03  WSS-DESPLIEGA          VALUE 0      PIC 9(01).           03  WSS-SOLO-ACUMULA       VALUE 1      PIC 9(01).*% IF ACUMULA           03  WSS-AUX                COMP-3       PIC S9(11)V9(4).*% END      *>>>>*% END*% IF INIFNDKEY      * WSS-POS-INI Contiene la posicion inicial del arreglo que se llena      *             esto es, 1, 1 + WSS-IMAX, 2*(1 + WSS-IMAX),      *             3*(1 + WSS-IMAX), etc      * WSS-POS-ACT Contiene la posicion actual, mientras avanza hasta      *             alcanzar WSS-POS-FIN  esto es, 1,2,3,4,...      *             Cuando retrocede y avanza, contiene      *             WSS-POS-INI + WSS-IMAX, con la restriccion que      *             WSS-POS-ACT NOT > WSS-POS-FIN      * WSS-POS-FIN Contiene el total de registros {PAD} encontrados           IF FRM-FFLD = FRM-FFLD-PF7               IF WSS-POS-INI < WSS-IMAX                   MOVE '{PAD}    NOPRV' TO MSG-COD-MENS                   GO TO ERR-FND-KEY               ELSE                   MOVE WSS-CLV-INI TO {KEYPADPAD} IN {PAD}                   MOVE FIO-GET-NLS TO FIO-CMND                   MOVE '{KEYPADPAD}' TO FIO-AKEY                   PERFORM {SISREG}-FIO-{PAD}                   MOVE FIO-STAT TO PGM-STAT-{PAD}                   IF NOT FIO-STAT-OKS                       MOVE 'PGM    ERR' TO MSG-COD-MENS                       GO TO ERR-FND-KEY                   ELSE                       MOVE FIO-GET-PRV TO FIO-CMND                       MOVE '{KEYPRVPAD}' TO FIO-AKEY                       GO TO LEE-{PAD}           ELSE           IF FRM-FFLD = FRM-FFLD-PF8               IF WSS-POS-FIN < WSS-POS-INI + WSS-IMAX - 1                   MOVE '{PAD}    NONXT' TO MSG-COD-MENS                   GO TO ERR-FND-KEY               ELSE                   MOVE WSS-CLV-FIN TO {KEYPADPAD} IN {PAD}                   MOVE FIO-GET-NLS TO FIO-CMND                   MOVE '{KEYPADPAD}' TO FIO-AKEY                   PERFORM {SISREG}-FIO-{PAD}                   MOVE FIO-STAT TO PGM-STAT-{PAD}                   MOVE FIO-GET-NXT TO FIO-CMND                   MOVE '{KEYALTPAD}' TO FIO-AKEY                   GO TO LEE-{PAD}.      * Inicializa posicion de puntero y llaves           SUBTRACT WSS-IMAX FROM 1 GIVING WSS-POS-INI.           MOVE ZEROES TO WSS-POS-ACT, WSS-POS-FIN.           MOVE SPACES TO WSS-CLV-INI, WSS-CLV-FIN.*% IF PGM_VAX           MOVE SPACES TO {PAD}.           MOVE ZEROES TO WSS-IND-ACUMULA.*% END           MOVE FRM-FFLD-PF8 TO FRM-FFLD.*% INCLUDE INIVAR OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'           PERFORM KEY-ALL-{FRM}.           MOVE '{KEYALTPAD}' TO FIO-AKEY.           MOVE FIO-GET-NLS TO FIO-CMND.       LEE-{PAD}.           PERFORM {SISREG}-FIO-{PAD}.           MOVE FIO-STAT TO PGM-STAT-{PAD}.           GO TO INI-FIN-FND-KEY.*% END*% IF FINFNDKEY       INI-FIN-FND-KEY.           IF NOT FIO-STAT-OKS               IF WSS-POS-ACT = ZEROES                   MOVE '{PAD}    NEX' TO MSG-COD-MENS                   GO TO ERR-FND-KEY               ELSE                   MOVE '{PAD}    NONXT' TO MSG-COD-MENS                   GO TO ERR-FND-KEY.           MOVE {KEYPADPAD} IN {PAD} TO {KEYPADPAD}                                         IN CMA-VARI.           MOVE {KEYPADPAD} IN {PAD} TO {KEYPADPAD}-INI                                        IN CMA-VARI.       CARGA-{PAD}.      *    Inicializa posicion del indice del grupo de ocurrencias           IF FRM-FFLD = FRM-FFLD-PF8               MOVE ZEROES TO FRM-IFLD           ELSE               ADD 1 , WSS-IMAX GIVING FRM-IFLD.           MOVE SPACES TO MSG-COD-MENS.           PERFORM PUT-TAB-{PAD}.           IF FRM-FFLD = FRM-FFLD-PF7               SUBTRACT WSS-IMAX FROM WSS-POS-INI               COMPUTE WSS-POS-ACT = WSS-POS-INI + WSS-IMAX - 1           ELSE               ADD 1 TO FRM-IFLD               PERFORM LIM-RES-LIN UNTIL FRM-IFLD > WSS-IMAX               ADD WSS-IMAX TO WSS-POS-INI               IF WSS-POS-FIN = ZEROES                   MOVE WSS-POS-ACT TO WSS-POS-FIN                   COMPUTE WSS-POS-ACT = WSS-POS-INI + WSS-IMAX - 1                ELSE                   COMPUTE WSS-POS-ACT = WSS-POS-INI + WSS-IMAX - 1                    IF WSS-POS-ACT > WSS-POS-FIN                                        MOVE WSS-POS-FIN TO WSS-POS-ACT.      * Mueve acumuladores a {FRM}-FLD*% INCLUDE TOTVAR OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'           IF MSG-COD-MENS > SPACES               MOVE '{SISREG}' TO FIO-SIST               MOVE SPACES TO FIO-AKEY               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS.           MOVE '00' TO FIO-STAT.           GO TO FIN-FND-KEY.*% END*% IF PUTTAB       PUT-TAB-{PAD} SECTION.       INI-PUT-TAB-{PAD}.*% INCLUDE SELECCION OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'           IF FRM-FFLD = FRM-FFLD-PF7               SUBTRACT 1 FROM FRM-IFLD           ELSE               IF WSS-POS-FIN = ZEROES                   ADD 1 TO WSS-POS-ACT*% IF ACUMULA                   IF WSS-POS-ACT > WSS-IMAX      *                Solo acumula, sin desplegar                       MOVE WSS-SOLO-ACUMULA TO WSS-IND-ACUMULA                       GO TO ACUMULA-{PAD}                   ELSE                       ADD 1 TO FRM-IFLD*% ELSE                   ADD 1 TO FRM-IFLD*% END               ELSE                   ADD 1 TO FRM-IFLD.*% INCLUDE MOVFLD OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'*% INCLUDE BUSTAB OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'       ACUMULA-{PAD}.*% INCLUDE SUMVAL OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'       NXT-PUT-TAB-{PAD}.           IF FRM-FFLD = FRM-FFLD-PF7                IF FRM-IFLD > 1                   MOVE FIO-GET-PRV TO FIO-CMND                   MOVE '{KEYPRVPAD}' TO FIO-AKEY               ELSE                   GO TO FIN-PUT-TAB-{PAD}           ELSE           IF WSS-POS-FIN = ZEROES               MOVE '{KEYALTPAD}' TO FIO-AKEY               MOVE FIO-GET-NXT TO FIO-CMND           ELSE               IF FRM-IFLD < WSS-IMAX                   MOVE '{KEYALTPAD}' TO FIO-AKEY                   MOVE FIO-GET-NXT TO FIO-CMND               ELSE                   GO TO FIN-PUT-TAB-{PAD}.           PERFORM {SISREG}-FIO-{PAD}.           IF FIO-STAT-OKS               GO TO INI-PUT-TAB-{PAD}.       FIN-PUT-TAB-{PAD}.           EXIT.*% END*% IF LIMRESLIN       LIM-RES-LIN SECTION.       INI-LIM-RES-LIN.*% INCLUDE LIMRESLIN OF '{SISREG}GEN:{SISREG}PQ{FRM}.GEN'           ADD 1 TO FRM-IFLD.       FIN-LIM-RES-LIN.           EXIT.*% END