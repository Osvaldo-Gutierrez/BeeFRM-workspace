      *Transforma valor de una moneda a otra
      *INPUT  : TVC-VALO, TVC-MON1, TVC-MON2, TVC-FCAM
      *OUTPUT : TVC-VALO, TVC-CMSG
       TAB-PRO-TVC SECTION.
       INI-TAB-PRO-TVC.
           MOVE SPACES TO TVC-CMSG.
           IF TVC-MON2 = TVC-MON1
               GO TO FIN-TAB-PRO-TVC.
           IF TVC-MNAC NOT > SPACES
               MOVE 'TAB'  TO FIO-SIST
               MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB
               MOVE '0999' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO TVC-MNAC
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC.

      *Convertir TVC-VALO de TVC-MON1 a TVC-MON2
      *a) Convertir monto en TVC-MON1 a Moneda Nacional
           IF TVC-MON1 = TVC-MNAC
               NEXT SENTENCE
           ELSE
               MOVE TVC-DCAM IN TVC-VARI   TO CAM-NUM-DCAM IN CAM(1)
               MOVE TVC-MCAM IN TVC-VARI   TO CAM-NUM-MCAM IN CAM(1)
               MOVE TVC-SCAM IN TVC-VARI   TO CAM-NUM-SCAM IN CAM(1)
               MOVE TVC-ACAM IN TVC-VARI   TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2)
               MOVE TVC-MON1 IN TVC-VARI   TO CAM-COD-VCAM IN CAM(1)
               MOVE TVC-MNAC IN TVC-VARI   TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' )
                   MOVE 'TVCCAMBNXNV' TO TVC-CMSG
                   GO TO FIN-TAB-PRO-TVC
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM BY TVC-VALO IN TVC-VARI
                            GIVING TVC-VALO IN TVC-VARI
                   MOVE TVC-VALO IN TVC-VARI TO PES-SGV-DECI
                   MOVE TVC-MNAC IN TVC-VARI TO PES-COD-VCAM
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE TO TVC-VALO IN TVC-VARI.
      *b) TVC-VALO en Moneda Nacional (TVC-MNAC) convertir a TVC-MON2
           IF TVC-MNAC = TVC-MON2
               NEXT SENTENCE
           ELSE
               MOVE TVC-DCAM IN TVC-VARI   TO CAM-NUM-DCAM IN CAM(1)
               MOVE TVC-MCAM IN TVC-VARI   TO CAM-NUM-MCAM IN CAM(1)
               MOVE TVC-SCAM IN TVC-VARI   TO CAM-NUM-SCAM IN CAM(1)
               MOVE TVC-ACAM IN TVC-VARI   TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2)
               MOVE TVC-MON2 IN TVC-VARI   TO CAM-COD-VCAM IN CAM(1)
               MOVE TVC-MNAC IN TVC-VARI   TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                        CAM-SGV-VCAM IN CAM > 0 )
                   MOVE 'TVCCAMBNXNV0' TO TVC-CMSG
                   GO TO FIN-TAB-PRO-TVC
               ELSE
                   DIVIDE TVC-VALO IN TVC-VARI BY CAM-SGV-VCAM IN CAM
                          GIVING TVC-VALO IN TVC-VARI
                   MOVE TVC-VALO IN TVC-VARI TO PES-SGV-DECI
                   MOVE TVC-MON2 IN TVC-VARI TO PES-COD-VCAM
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE TO TVC-VALO IN TVC-VARI.
       FIN-TAB-PRO-TVC.
           EXIT.
