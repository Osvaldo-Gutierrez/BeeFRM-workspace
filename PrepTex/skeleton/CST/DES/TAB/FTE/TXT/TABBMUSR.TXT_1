*%! Codigo adicional
*% IF FIN_PUT_ALL_USR
      *<<<< FIN_PUT_ALL_USR
      *BUS-TAB busca glosa de codigo en tabla
           IF USR-COD-TTAB IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'USR' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-TTAB IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TTAB IN USR-FLD.
           IF USR-COD-UBIC IN USR-FLD > SPACES
               MOVE USR-COD-UBIC IN USR-FLD TO USR-COD-UBIC IN USR
               IF USR-IND-UBIC IN USR = 'O'
                   MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN USR-FLD
               ELSE
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'UBI' TO TAB-COD-TTAB IN TAB
                   MOVE USR-COD-UBIC IN USR-FLD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN USR-FLD.
           IF USR-COD-CUSR IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'CUS' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-CUSR IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CUSR IN USR-FLD.
      *>>>>
*% END
*% IF USR_COD_TTAB
      *<<<< USR_COD_TTAB
      *VAL-COD Valida codigo de tabla
           IF USR-COD-TTAB IN USR-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'USR' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-TTAB IN USR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX' AND
                  USR-COD-TTAB IN USR-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TTAB IN USR-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TTAB IN USR-FLD.
      *>>>>
*% END
*% IF USR_COD_USER
      *<<<< USR_COD_USER
      * ALD
      *     IF USR-COD-USER IN USR-FLD NOT > SPACES
      *         PERFORM ERR-KEY.
      *>>>>
*% END
*% IF USR_GLS_IUSR
      *<<<< USR_GLS_IUSR
      *PGV IF SCR-INST = SCR-INST-GFL OR
           IF USR-IND-IUSR IN USR-FLD     > SPACES OR
              USR-NUM-IUSR IN USR-FLD NOT = ZEROES OR
              USR-VRF-IUSR IN USR-FLD     > SPACES OR
              USR-GLS-IUSR IN USR-FLD     > SPACES
               MOVE USR-GLS-IUSR IN USR-FLD TO IDC-GLS-RUTV
               PERFORM VAL-GLS.
      *>>>>
*% END
*% IF USR_VRF_IUSR
      *<<<< USR_VRF_IUSR
      *PGV IF SCR-INST = SCR-INST-GFL OR
           IF USR-IND-IUSR IN USR-FLD     > SPACES OR
              USR-NUM-IUSR IN USR-FLD NOT = ZEROES OR
              USR-VRF-IUSR IN USR-FLD     > SPACES OR
              USR-GLS-IUSR IN USR-FLD     > SPACES
               MOVE USR-NUM-IUSR IN USR-FLD TO IDC-NUM-RUTV
               MOVE USR-VRF-IUSR IN USR-FLD TO IDC-VRF-RUTV
               PERFORM VAL-RUT
               IF MSG-COD-MENS = SPACES
                   MOVE IDC-NUM-RUTV TO USR-NUM-IUSR IN USR-FLD.
      *>>>>
*% END
*% IF USR_GLS_DESC
      *<<<< USR_GLS_DESC
           IF USR-GLS-DESC IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_GLS_ABRV
      *<<<< USR_GLS_ABRV
           IF SCR-INST = SCR-INST-GFL AND
              USR-GLS-ABRV IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_GLS_DCOR
      *<<<< USR_GLS_DCOR
           IF USR-GLS-DCOR IN USR-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF USR_IND_VIGE
      *<<<< USR_IND_VIGE
           MOVE 'GNS'  TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE USR-IND-VIGE IN USR-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF USR_COD_UBIC
      *<<<< USR_COD_UBIC
           MOVE USR-COD-UBIC IN USR-FLD TO USR-COD-UBIC IN USR.
           IF USR-IND-UBIC IN USR = 'O'
               GO TO OFI-VAL-USR-COD-UBIC.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'UBI' TO TAB-COD-TTAB IN TAB.
           MOVE USR-COD-UBIC IN USR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
              USR-COD-UBIC IN USR-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBIC IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBIC IN USR-FLD.
           GO TO FIN-VAL-USR-COD-UBIC.
       OFI-VAL-USR-COD-UBIC.
           MOVE USR-COD-OFIC IN USR TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OFI-COD-OFIC IN OFI > SPACES
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-UBIC IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBIC IN USR-FLD.
      *>>>>
*% END
*% IF USR_COD_CUSR
      *<<<< USR_COD_CUSR
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CUS' TO TAB-COD-TTAB IN TAB.
           MOVE USR-COD-CUSR IN USR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
              USR-COD-CUSR IN USR-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CUSR IN USR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CUSR IN USR-FLD.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_USR
      *<<<< FIN_VAL_CON_KEY_USR
           IF USR-COD-TTAB IN USR-FLD     > SPACES AND
              USR-COD-USER IN USR-FLD NOT > SPACES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
