*% IF RR
      *<<<< RR
           05 WSS-SGV-VCAM                     PIC 9(05)V9(03).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS 
       COPY TABBRUSR.
       01  WSS-VARI.
           03 WSS-IND-LIMP   VALUE 0           PIC 9(01).
              88 LIMPIA-VARIABLES                     VALUE 0.
           03 WSS-IND-IPPH   VALUE 0           PIC 9(01).
              88 PRIMER-PAGE-HEADING                  VALUE 0.
           03 WSS-SGV-VCAM-ANT   VALUE ZEROES  PIC 9(05)V9(03).
           03 WSS-NUM-MCAM-ANT   VALUE ZEROES  PIC 9(02).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF CH_CAM_WSS_VAL_CAM1
      *<<<< INI_CH_CAM_WSS_VAL_CAM1
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB.
           MOVE WSS-VAL-CAM1 IN SRT TO TAB-COD-CTAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC TO WSS-GLS-CAM1 IN WSS-CAM.
      *>>>>
*% END
*% IF CH_CAM_WSS_VAL_CAM2
      *<<<< INI_CH_CAM_WSS_VAL_CAM2
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB.
           MOVE WSS-VAL-CAM2 IN SRT TO TAB-COD-CTAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC TO WSS-GLS-CAM2 IN WSS-CAM.
      *>>>>
*% END
*% IF CF_CAM_WSS_NUM_DCAM
      *<<<< INI_CF_CAM_WSS_NUM_DCAM
           MOVE 0 TO WSS-IND-LIMP.
      *>>>>
*% END
*% IF PH_CAM
      *<<<< INI_PH_CAM
           IF PRIMER-PAGE-HEADING
      *         MOVE 0 TO PAGE-COUNTER
      *         MOVE 1 TO PRINT-SWITCH
               MOVE 1 TO WSS-IND-IPPH.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB'  TO TAB-COD-SIST.
           MOVE 'CAM'  TO TAB-COD-TTAB.
           MOVE SPACES TO TAB-COD-CTAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC TO WSS-GLS-DTAB IN WSS-CAM.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.
           MOVE TAB-COD-ATRN TO USR-COD-USER.
           PERFORM BUS-USR.
*% IF NOT PGM_MCP
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM TAB-FIO-USR.
*% END
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           MOVE CAM-COD-VCAM IN CAM(1) TO WSS-VAL-CAM1 IN WSS-CAM.
           MOVE CAM-COD-VCAM IN CAM(2) TO WSS-VAL-CAM2 IN WSS-CAM.
           MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-NUM-SCAM IN WSS-CAM.
           MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-NUM-ACAM IN WSS-CAM.
           MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-NUM-MCAM IN WSS-CAM.
           MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-NUM-DCAM IN WSS-CAM.
           MOVE CAM-SGV-VCAM IN CAM    TO WSS-SGV-VCAM IN SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           PERFORM LYP-DCAM.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
           PERFORM LYP-DCAM.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY GNSBBTAB.
       COPY GNSBBMSG.

       LYP-DCAM SECTION.
       INI-LYP-DCAM.
           IF LIMPIA-VARIABLES
               MOVE 1 TO WSS-IND-LIMP
               MOVE ZEROES TO WSS-VAL-ENER IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-FEBR IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-MARZ IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-ABRI IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-MAYO IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-JUNI IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-JULI IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-AGOS IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-SEPT IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-OCTU IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-NOVI IN WSS-CAM
               MOVE ZEROES TO WSS-VAL-DICI IN WSS-CAM.

           IF WSS-NUM-MCAM-ANT = 1
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-ENER IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 2
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-FEBR IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 3
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-MARZ IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 4
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-ABRI IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 5
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-MAYO IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 6
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-JUNI IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 7
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-JULI IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 8
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-AGOS IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 9
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-SEPT IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 10
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-OCTU IN WSS-CAM
           ELSE
           IF WSS-NUM-MCAM-ANT = 11
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-NOVI IN WSS-CAM
           ELSE
               MOVE WSS-SGV-VCAM-ANT TO WSS-VAL-DICI IN WSS-CAM.

           MOVE WSS-NUM-MCAM IN SRT TO WSS-NUM-MCAM-ANT.
           MOVE WSS-SGV-VCAM IN SRT TO WSS-SGV-VCAM-ANT.
       FIN-LYP-DCAM.
           EXIT.
      *>>>>
*% END
