*%! Codigo adicional
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_PU
      *<<<< PGM_PU
       COPY TABWGVCT.
      *    Valor de Cambio auxiliar para conversion comp-3 -> comp
       01  WSS-SGV-VCAM                      PIC S9(18).
      *>>>>
*% END
       COPY TABBRUSR.
       COPY TABBRVLR.
       COPY GNSBRMSC.
       01  WSS-VARI.
           03 WSS-COD-CAMB.
              05 WSS-COD-VCAM OCCURS 2 TIMES.
                 07 WSS-MSC-TVAL         PIC X(01).
                 07 WSS-COD-CVAL         PIC X(03).
                 07 WSS-COD-TCAM         PIC X(02).
           03  WSS-FEC-FCAM OCCURS 2 TIMES.
               05 WSS-NUM-SCAM           PIC 9(02).
               05 WSS-NUM-ACAM           PIC 9(02).
               05 WSS-NUM-MCAM           PIC 9(02).
               05 WSS-NUM-DCAM           PIC 9(02).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-INST = SCR-INST-HKY
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'CAM' TO TAB-COD-TTAB IN TAB
              PERFORM ERR-TAB.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CCPP = 'ING' OR 'MOD' OR 'ACT'
               PERFORM PRO-IND-VIGE
               MOVE 'N' TO CAM-IND-VIGE IN CAM-FLD.
           IF SCR-CMND = 'VRF'
      *         PERFORM PRO-FLD-CAM
               MOVE FRM-CPIM-AEY TO CAM-SGV-VCAM-ATR IN CAM-FLD
               MOVE FRM-CPIM-UBY TO CAM-IND-VIGE-ATR IN CAM-FLD
               PERFORM FST-IND-VIGE.

           IF SCR-CMND = 'COP'
               MOVE FRM-CPIM-AEY TO CAM-SGV-VCAM-ATR IN CAM-FLD
               MOVE FRM-CPIM-AEY TO CAM-IND-VIGE-ATR IN CAM-FLD
               MOVE FRM-CPIM-UBY TO CAM-FEC-FCAM-ATR IN CAM-FLD(1)
               MOVE FRM-CPIM-UBY TO CAM-FEC-FCAM-ATR IN CAM-FLD(2)
               MOVE ZEROES       TO CAM-SGV-VCAM-LEN
               MOVE -1           TO CAM-FEC-FCAM-LEN IN CAM-FLD(1).
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO CAM-STP-ITRN IN CAM.
      *>>>>
*% END
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_VMS OR PGM_MVS
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF FIO-STAT-OKS
               PERFORM PUT-FLD-TDM.
      *>>>> END
*% END
      *>>>> END
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'VRF'
                   MOVE 'VIGENCIA NO MODIFICADA' TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE FRM-CPIM-UBY   TO CAM-FEC-FCAM-ATR IN CAM-FLD(1)
                   MOVE FRM-CPIM-UBY   TO CAM-FEC-FCAM-ATR IN CAM-FLD(2)
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           IF SCR-CMND = 'VRF'
              PERFORM GET-FHOY
              MOVE HOY-STP-ITRN TO CAM-STP-ITRN IN CAM
              MOVE FIO-MOD  TO FIO-CMND
              PERFORM TAB-FIO-CAM
*% IF PGM_VMS
      *<<<< PGM_VMS
              .
*% ELSE
              IF FIO-STAT-OKS AND
                 CAM-IND-VIGE IN CAM = 'S'
                  PERFORM PUT-FLD-TDM
                  IF WSS-TDM-MENS NOT > SPACES
                      MOVE 'VIG    ACT  ' TO MSG-COD-MENS
                      MOVE 'TAB' TO MSG-COD-SIST
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                      NEXT SENTENCE
              ELSE
                  MOVE 'FIOSTAT' TO MSG-COD-TMSG
                  MOVE FIO-STAT  TO MSG-COD-CMSG
                  MOVE 'GNS'     TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       VAL-KEY-CAM SECTION.
       INI-VAL-KEY-CAM.
           PERFORM VAL-IKY-CAM.
           PERFORM VAL-MKY-CAM.
           PERFORM VAL-AKY-CAM.
       FIN-VAL-KEY-CAM.
           EXIT.
       
       VAL-IKY-CAM SECTION.
       INI-VAL-IKY-CAM.
           PERFORM VAL-TAB-COD-CTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAB-COD-CTAB-LEN IN CAM-FLD
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-MSC-TVAL VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-MSC-TVAL-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-COD-CVAL VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-COD-CVAL-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-COD-TCAM VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-COD-TCAM-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-FEC-FCAM VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-FEC-FCAM-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
       FIN-VAL-IKY-CAM.
           EXIT.
       
       VAL-AKY-CAM SECTION.
       INI-VAL-AKY-CAM.
       FIN-VAL-AKY-CAM.
           EXIT.

       VAL-TAB-COD-CTAB SECTION.
       INI-VAL-TAB-COD-CTAB.
           IF TAB-COD-CTAB IN CAM-FLD NOT > SPACES
              MOVE SPACES TO TAB-COD-CTAB IN CAM-FLD.
      *<<<< TAB_COD_CTAB
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SVC' TO TAB-COD-TTAB IN TAB.
           MOVE TAB-COD-CTAB IN CAM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CAMB

               MOVE WSS-MSC-TVAL IN WSS-COD-VCAM(1) TO
                    CAM-MSC-TVAL IN CAM-FLD(1)
               MOVE WSS-COD-CVAL IN WSS-COD-VCAM(1) TO
                    CAM-COD-CVAL IN CAM-FLD(1)
               MOVE WSS-COD-TCAM IN WSS-COD-VCAM(1) TO
                    CAM-COD-TCAM IN CAM-FLD(1)

               MOVE WSS-MSC-TVAL IN WSS-COD-VCAM(2) TO
                    CAM-MSC-TVAL IN CAM-FLD(2)
               MOVE WSS-COD-CVAL IN WSS-COD-VCAM(2) TO
                    CAM-COD-CVAL IN CAM-FLD(2)
               MOVE WSS-COD-TCAM IN WSS-COD-VCAM(2) TO
                    CAM-COD-TCAM IN CAM-FLD(2)

               PERFORM VLD-CAM-MSC-TVAL VARYING FRM-IFLD
                       FROM 1 BY 1 UNTIL FRM-IFLD > 2.
      *>>>>
       FIN-VAL-TAB-COD-CTAB.
           EXIT.
       
       VAL-CAM-MSC-TVAL SECTION.
       INI-VAL-CAM-MSC-TVAL.
       FIN-VAL-CAM-MSC-TVAL.
           EXIT.
       
       VAL-CAM-COD-CVAL SECTION.
       INI-VAL-CAM-COD-CVAL.
       FIN-VAL-CAM-COD-CVAL.
           EXIT.
       
       VAL-CAM-COD-TCAM SECTION.
       INI-VAL-CAM-COD-TCAM.
       FIN-VAL-CAM-COD-TCAM.
           EXIT.
       
       VAL-CAM-FEC-FCAM SECTION.
       INI-VAL-CAM-FEC-FCAM.
      *VAL-FEC Validar Fecha
           MOVE CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD) TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *DAD
      *<<<< INI_CAM_FEC_FCAM
           MOVE CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD) TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           IF FRM-IFLD = 1
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD)
               IF FRM-IFLD = 2 AND FEC-STAT-BLK
                   MOVE CAM-FEC-FCAM IN CAM-FLD(1) TO
                        CAM-FEC-FCAM IN CAM-FLD(2)
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
           GO TO FIN-VAL-CAM-FEC-FCAM.
      *
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD)
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAM-FEC-FCAM.
      *<<<< CAM_FEC_FCAM
      *>>>>
       FIN-VAL-CAM-FEC-FCAM.
           EXIT.
      *>>>>
*% END 
*% IF EOF_PU
      *<<<< EOF_PU

       PUT-FLD-TDM SECTION.
       INI-PUT-FLD-TDM.

           MOVE SPACES TO WSS-TDM-MENS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'VSN'     TO TAB-COD-TTAB IN TAB.
           MOVE 'LINKTDM' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
                GO TO FIN-PUT-FLD-TDM.
           MOVE '00' TO FIO-STAT.

           MOVE CAM-FEC-FCAM IN CAM(1) TO WSS-TDM-FEC-FCAM.
           PERFORM FNC-FEC-TDM.
           MOVE WSS-FEC-T              TO VCB-FEC-1.

           MOVE CAM-FEC-FCAM IN CAM(2) TO WSS-TDM-FEC-FCAM.
           PERFORM FNC-FEC-TDM.
           MOVE WSS-FEC-T              TO VCB-FEC-2.

           MOVE CAM-FEC-FTRN IN CAM    TO WSS-TDM-FEC-FCAM.
           PERFORM FNC-FEC-TDM.
           MOVE WSS-FEC-T              TO VCB-FEC-TRN.

           MOVE CAM-COD-VCAM IN CAM(1) TO VCB-1.

           MOVE CAM-COD-VCAM IN CAM(2) TO VCB-2.

           MOVE CAM-HRA-HRTR           TO VCB-HRA-TRN.

           MOVE CAM-MSC-TACC IN CAM    TO VCB-TIP-ACC.

           MOVE CAM-IND-VIGE IN CAM    TO VCB-IND-VIG.

           MOVE CAM-MSC-TTRN IN CAM    TO VCB-IND-ORN-TRN.

           MOVE CAM-COD-TTRN IN CAM    TO VCB-TIP-ORN-TRN.

           MOVE CAM-COD-ATRN IN CAM    TO VCB-IDN-USU-TRN.

           MULTIPLY CAM-SGV-VCAM IN CAM BY 10000
               GIVING WSS-SGV-VCAM.

           MOVE WSS-SGV-VCAM           TO VCB-VAL.

           IF SCR-CMND = 'ING'
               MOVE 'I' TO VCB-OPC.

           IF SCR-CMND = 'MOD'
               MOVE 'M' TO VCB-OPC.

           IF SCR-CMND = 'ELI'
               MOVE 'E' TO VCB-OPC.

           MOVE SYS-LINK       TO SYS-CMND.
           MOVE 'HCICSS01'     TO SYS-PROG.
           MOVE HCOM-MAX-LAR   TO SYS-TCMA.
           MOVE HCOM-COMM-AREA TO SYS-CMMA.
           PERFORM GNS-PRO-SYS.
           MOVE DFHCOMMAREA TO HCOM-COMM-AREA.
           IF HCOM-COD-RET NOT = SPACES
               MOVE 'CODRET1'               TO MSG-COD-MENS
           ELSE
           IF HCOM-COD-RET-43 NOT = '000'
               MOVE 'CODRET2'               TO MSG-COD-MENS
           ELSE
           IF HCOM-MSG-VTA-CTROL-CERR NOT = '00'
               MOVE 'CODRET3'               TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE MSG-COD-MENS TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.

       FIN-PUT-FLD-TDM.
           EXIT.

       FNC-FEC-TDM SECTION.
       INI-FNC-FEC-TDM.
      * ISP:  18-MAR-1992 SE INHIBE ESTA FORMA DE PASAR PARAMETROS
      *       OPTANDOSE POR LA DE MAS ABAJO
      *     IF WSS-TDM-FEC-FCAM IS NOT NUMERIC OR
      *        WSS-TDM-FEC-FCAM = ZEROES
      *          MOVE ZEROES TO WSS-FEC-R-SS
      *          MOVE 1      TO WSS-FEC-R-AA
      *          MOVE 1      TO WSS-FEC-R-MM
      *          MOVE 1      TO WSS-FEC-R-DD
      *      ELSE
      *          MOVE CAM-NUM-SCAM IN CAM(1) TO WSS-FEC-R-SS
      *          MOVE CAM-NUM-ACAM IN CAM(1) TO WSS-FEC-R-AA
      *          MOVE CAM-NUM-MCAM IN CAM(1) TO WSS-FEC-R-MM
      *          MOVE CAM-NUM-DCAM IN CAM(1) TO WSS-FEC-R-DD.
      *     MOVE WSS-FEC-R-AAAA   TO WSS-FEC-T-AAAA.
      *     MOVE WSS-FEC-R-MM     TO WSS-CAMPO-COM.
      *     MOVE WSS-CAMPO-BIN-X1 TO WSS-FEC-T-MM.
      *     MOVE WSS-FEC-R-DD     TO WSS-CAMPO-COM.
      *     MOVE WSS-CAMPO-BIN-X1 TO WSS-FEC-T-DD.
           MOVE WSS-TDM-NUM-SCAM  TO WSS-NUM-ST.
           MOVE WSS-TDM-NUM-ACAM  TO WSS-NUM-AT.
           MOVE WSS-TDM-NUM-MCAM  TO WSS-NUM-MT.
           MOVE WSS-TDM-NUM-DCAM  TO WSS-NUM-DT.
       FIN-FNC-FEC-TDM.
           EXIT.

      *>>>>
*% END
*% IF EOF
      *<<<< EOF

       FST-IND-VIGE SECTION.
       INI-FST-IND-VIGE.
           MOVE ZEROES TO CAM-SGV-VCAM-LEN.
           MOVE -1 TO CAM-IND-VIGE-LEN.
       FIN-FST-IND-VIGE.
           EXIT.
       PRO-IND-VIGE SECTION.
       INI-PRO-IND-VIGE.
           MOVE FRM-CPIM-AEY TO CAM-IND-VIGE-ATR.
       FIN-PRO-IND-VIGE.
           EXIT.

       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIND.
       COPY GNSBETAB.
       COPY TABBFVLR.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
      *>>>>
*% END
