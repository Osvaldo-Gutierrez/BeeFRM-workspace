       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.       LDCPBHLC.
       AUTHOR.           CONSIST.
       DATE-WRITTEN.     16-APR-1996.

      * PROGRAMA BATCH QUE PERMITE TRASPASAR LAS CALIFICACIONES 
      * EN ESTADO CERRADAS Y RENOVADAS (ESTAS ULTIMAS DEBIDAMENTE
      * ACTIVADAS) A UN ARCHIVO HISTORICO.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *=====================
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.

       INPUT-OUTPUT SECTION.
      *====================
       FILE-CONTROL.
      *-------------

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY LDCBRRDC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFPB.
       COPY TABWGTVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.

       01  WSS-VARI.
           03  WSS-NUM-RBAD           VALUE 0        PIC 9(02).
           03  WSS-NUM-LCLF           VALUE 0        PIC 9(08). 
           03  WSS-REG-GCLF           VALUE 0        PIC 9(08). 
           03  WSS-REG-GLDC           VALUE 0        PIC 9(08). 
           03  WSS-REG-GARC           VALUE 0        PIC 9(08). 
           03  WSS-REG-GARG           VALUE 0        PIC 9(08). 
           03  WSS-REG-GRDC           VALUE 0        PIC 9(08). 
           03  WSS-REG-BCLF           VALUE 0        PIC 9(08). 
           03  WSS-REG-BLDC           VALUE 0        PIC 9(08). 
           03  WSS-REG-BARC           VALUE 0        PIC 9(08). 
           03  WSS-REG-BARG           VALUE 0        PIC 9(08). 
           03  WSS-REG-BRDC           VALUE 0        PIC 9(08). 
           03 WSS-FBEG.
              05 WSS-SBEG                            PIC 9(02).
              05 WSS-ABEG                            PIC 9(02).
              05 WSS-MBEG                            PIC 9(02).
              05 WSS-DBEG                            PIC 9(02).
           03 WSS-FPRO.
              05 WSS-DPRO                            PIC 9(02).
              05 WSS-MPRO                            PIC 9(02).
              05 WSS-SPRO                            PIC 9(02).
              05 WSS-APRO                            PIC 9(02).
           03 WSS-IDBM                VALUE ZEROES   PIC 9(03).
           03 WSS-IDBH                VALUE ZEROES   PIC 9(03).
           03 WSS-NUM-DBIN            VALUE ZEROES   PIC 9(03).
           03 WSS-NUM-DBOU            VALUE ZEROES   PIC 9(03).
           03 WSS-KEY-ICLF                           PIC X(12).
      *

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
      *------------
       INI-MAIN.
      *
       COPY GNSBGEDB.
      *EFECTUA APERTURA DE ARCHIVOS
           PERFORM INICIO-ELC.

      *LEE  LA PRIMERA CLF
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-CLF-INP.
           IF NOT FIO-STAT-OKS 
               DISPLAY 'ERROR: NO EXISTEN DATOS EN LDCCLF '
               DISPLAY 'PROCESO CANCELADO...'.

      *PROCESO PRINCIPAL
           PERFORM PROCESO-ELC UNTIL NOT FIO-STAT-OKS.

      *CIERRA ARCHIVOS
           PERFORM FINAL-ELC.

      *ESTADISTICA Y FIN DEL PGM.
           PERFORM ESTADISTICAS.

       FIN-MAIN.
           EXIT.

       INICIO-ELC SECTION.
      *-------------------
       INI-INICIO-ELC.
           MOVE 'LDCPBHLC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
           PERFORM OBT-NUM-BDATOS.

      *APERTURA DE ARCHIVOS
      *LDCCLF
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR  ARCHIVO LDCMCLF '
               DISPLAY 'FIO-INP  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR I/O ARCHIVO LDCHCLF '
               DISPLAY 'FIO-UPD  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

      *LDCLDC
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCMLDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCHLDC '
               DISPLAY 'FIO-UPD  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

      *LDCARC
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCMARC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCHARC '
               DISPLAY 'FIO-UPD  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

      *LDCARG
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCMARG '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCHARG '
               DISPLAY 'FIO-UPD  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

      *LDCRDC
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCMRDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCHRDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               PERFORM ESTADISTICAS.


       COPY GNSBGFPB.
           MOVE FPB-DPRO TO WSS-DPRO.
           MOVE FPB-MPRO TO WSS-MPRO.
           MOVE FPB-SPRO TO WSS-SPRO.
           MOVE FPB-APRO TO WSS-APRO.
      *    DISPLAY 'INGRESE FECHA DE PROCESO:'.
      *    ACCEPT WSS-FINI.
           DISPLAY "FECHA DE PROCESO : " WSS-FPRO.

      * Resta 60 dias a Fecha de Proceso
           MOVE WSS-DPRO IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-MPRO IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-SPRO IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-APRO IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC         TO FEC-FORM.
           MOVE FEC-RST-DIA          TO FEC-CMND.
           MOVE 30                   TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-DBEG IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-MBEG IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-SBEG IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-ABEG IN WSS-VARI.

       FIN-INICIO-ELC.
           EXIT.

       PROCESO-ELC SECTION.
      *--------------------
       INI-PROCESO-ELC.

           ADD 1 TO WSS-NUM-LCLF IN WSS-VARI. 

           MOVE CLF-KEY-ICLF IN CLF TO WSS-KEY-ICLF IN WSS-VARI
           IF ( WSS-FBEG NOT < CLF-FEC-FAPE IN CLF AND
                CLF-CIC-CREN IN CLF > SPACES  AND
                CLF-MSC-STAT IN CLF = 'R')  OR 
              ( WSS-FBEG NOT < CLF-FEC-FAPE IN CLF AND
                CLF-CIC-CREN IN CLF > SPACES  AND
                CLF-MSC-STAT IN CLF = 'A' )
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              MOVE CLF-CIC-CREN IN CLF TO CLF-CIC-ICLF IN CLF
              PERFORM LDC-FIO-CLF-INP
              IF NOT FIO-STAT-OKS 
                 DISPLAY 'ERROR AL GET-KEY ARCHIVO LDCMCLF '
                 DISPLAY 'GET-KEY '    FIO-STAT
                 GO TO NXT-PROCESO-ELC
              ELSE
                 PERFORM PROCESA-RDC
                 PERFORM PROCESA-LDC
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM LDC-FIO-CLF-OUT
                 IF FIO-STAT-OKS
                     ADD 1  TO WSS-REG-GCLF
                     MOVE FIO-DEL TO FIO-CMND
                     PERFORM LDC-FIO-CLF-INP
                     ADD 1  TO WSS-REG-BCLF
                     MOVE WSS-KEY-ICLF IN WSS-VARI TO
                                       CLF-KEY-ICLF IN CLF
                     MOVE FIO-GET-KEY  TO FIO-CMND
                     PERFORM LDC-FIO-CLF-INP
                     IF NOT FIO-STAT-OKS 
                        DISPLAY 'ERROR AL GET-KEY ARCHIVO LDCMCLF '
                       DISPLAY 'GET-KEY '    FIO-STAT
                       GO TO NXT-PROCESO-ELC
                     ELSE
                       GO TO NXT-PROCESO-ELC
                 ELSE
                     DISPLAY '%ERROR AL GRABAR CLF : '
                                             CLF-KEY-ICLF IN CLF
                     GO TO NXT-PROCESO-ELC
           ELSE
              IF WSS-FBEG NOT < CLF-FEC-FCIE IN CLF AND
                 CLF-MSC-STAT IN CLF = 'C'
                  PERFORM PROCESA-RDC
                  PERFORM PROCESA-LDC
                  MOVE FIO-PUT TO FIO-CMND
                  PERFORM LDC-FIO-CLF-OUT
                  IF FIO-STAT-OKS
                      ADD 1  TO WSS-REG-GCLF
                      MOVE FIO-GET-KEY-UPD TO FIO-CMND
                      PERFORM LDC-FIO-CLF-INP
                      IF NOT FIO-STAT-OKS 
                          DISPLAY '%ERROR AL GET-KEY-UPD ARCH. LDCCLF'
                      ELSE
                          MOVE FIO-DEL TO FIO-CMND
                          PERFORM LDC-FIO-CLF-INP
                          IF NOT FIO-STAT-OKS 
                              DISPLAY '%ERROR AL BORRAR CLF'
                                             CLF-KEY-ICLF IN CLF
                          ELSE
                              ADD 1  TO WSS-REG-BCLF
                  ELSE
                      DISPLAY '%ERROR AL GRABAR CLF : '
                                             CLF-KEY-ICLF IN CLF.

       NXT-PROCESO-ELC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-CLF-INP.

       FIN-PROCESO-ELC.
           EXIT.

       PROCESA-LDC SECTION.
      *--------------------
       INI-PROCESA-LDC.

           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROS               TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-PROCESA-LDC.
           PERFORM LDC-FIO-LDC-INP.
           IF NOT ( FIO-STAT-OKS AND
                    LDC-CIC-ICLF IN LDC = CLF-CIC-ICLF IN CLF )
               GO TO FIN-PROCESA-LDC.

           PERFORM PROCESA-ARC.
           PERFORM PROCESA-ARG.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LDC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY '%ERROR AL GRABAR LDC : '
                                        LDC-KEY-ILDC IN LDC
               GO TO FIN-PROCESA-LDC
           ELSE
               ADD 1  TO WSS-REG-GLDC.

      * Lee con control exclusivo para borrar LDC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC-INP.
           IF NOT FIO-STAT-OKS
              DISPLAY '%ERROR AL LEER CON UPD LDC : '
                                        LDC-KEY-ILDC IN LDC
              GO TO FIN-PROCESA-LDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LDC-INP.
           IF FIO-STAT-OKS
               ADD 1  TO WSS-REG-BLDC
           ELSE
               DISPLAY '%ERROR AL BORRAR LDC : '
                                         LDC-KEY-ILDC IN LDC
               GO TO FIN-PROCESA-LDC.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PROCESA-LDC.

       FIN-PROCESA-LDC.
           EXIT.

       PROCESA-RDC SECTION.
       INI-PROCESA-RDC.
      *--------------------
           MOVE CLF-KEY-ICLF IN CLF TO RDC-KEY-ICLF IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC-INP.

       LUP-PROCESA-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-KEY-ICLF IN RDC = CLF-KEY-ICLF IN CLF )
              GO TO FIN-PROCESA-RDC.                  

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RDC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY '%ERROR AL GRABAR RDC : '
                                        RDC-KEY-ICLF IN RDC
               GO TO FIN-PROCESA-RDC
           ELSE
               ADD  1   TO WSS-REG-GRDC.

      * Lee con control exclusivo para borrar RDC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC-INP.
           IF NOT FIO-STAT-OKS
              DISPLAY '%ERROR AL LEER CON UPD RDC : '
                                        RDC-KEY-ICLF IN RDC
              GO TO FIN-PROCESA-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-RDC-INP.
           IF FIO-STAT-OKS
               ADD 1  TO WSS-REG-BRDC
           ELSE
               DISPLAY '%ERROR AL BORRAR RDC : '
                                         RDC-KEY-ICLF IN RDC
               GO TO FIN-PROCESA-RDC.

           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC-INP.
           GO TO LUP-PROCESA-RDC.
				
       FIN-PROCESA-RDC.
           EXIT.

       PROCESA-ARC SECTION.
       INI-PROCESA-ARC.
      *--------------------
           MOVE LDC-KEY-ILDC IN LDC TO ARC-KEY-ILDC IN ARC.
           MOVE ZEROES              TO ARC-NUM-IARC IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARC-INP.

       LUP-PROCESA-ARC.
           IF NOT ( FIO-STAT-OKS AND
                    ARC-KEY-ILDC IN ARC = LDC-KEY-ILDC IN LDC )
              GO TO FIN-PROCESA-ARC.  

           MOVE FIO-PUT  TO FIO-CMND.
           PERFORM LDC-FIO-ARC-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY '%ERROR AL GRABAR ARC : '
                                        ARC-KEY-IARC IN ARC
               GO TO FIN-PROCESA-ARC
           ELSE
               ADD  1  TO  WSS-REG-GARC.

      * Lee con control exclusivo para borrar ARC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC-INP.
           IF NOT FIO-STAT-OKS
               DISPLAY '%ERROR AL LEER CON UPD ARC : '
                                        ARC-KEY-IARC IN ARC
               GO TO FIN-PROCESA-ARC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARC-INP
           IF FIO-STAT-OKS
               ADD 1  TO WSS-REG-BARC
           ELSE
               DISPLAY '%ERROR AL BORRAR ARC : '
                                        ARC-KEY-IARC IN ARC
               GO TO FIN-PROCESA-ARC.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-ARC-INP.
           GO TO LUP-PROCESA-ARC.

       FIN-PROCESA-ARC.
           EXIT.

       PROCESA-ARG SECTION.
       INI-PROCESA-ARG.
      *--------------------
           MOVE LDC-KEY-ILDC IN LDC TO ARG-KEY-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARG-INP.

       LUP-PROCESA-ARG.
           IF NOT ( FIO-STAT-OKS AND
                    ARG-KEY-ILDC IN ARG = LDC-KEY-ILDC IN LDC )
                 GO TO FIN-PROCESA-ARG.  

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ARG-OUT.
           IF NOT FIO-STAT-OKS
               DISPLAY '%ERROR AL GRABAR ARG : '
                                        ARG-KEY-IARG IN ARG
               GO TO FIN-PROCESA-ARG
           ELSE
               ADD 1  TO  WSS-REG-GARG.

      * Lee con control exclusivo para borrar ARG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG-INP
           IF NOT FIO-STAT-OKS
              DISPLAY '%ERROR AL LEER CON UPD ARG : '
                                        ARG-KEY-IARG IN ARG
              GO TO FIN-PROCESA-ARG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARG-INP
           IF FIO-STAT-OKS
               ADD 1  TO WSS-REG-BARG
           ELSE
               DISPLAY '%ERROR AL BORRAR ARG : '
                                         ARG-KEY-IARG IN ARG
               GO TO FIN-PROCESA-ARG.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-ARG-INP.
           GO TO LUP-PROCESA-ARG.
       FIN-PROCESA-ARG.
           EXIT.

       FINAL-ELC SECTION.
       INI-FINAL-ELC.
      *------------------
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-CLF-INP.
           PERFORM LDC-FIO-LDC-INP.
           PERFORM LDC-FIO-RDC-INP.
           PERFORM LDC-FIO-ARC-INP.
           PERFORM LDC-FIO-ARG-INP.
           PERFORM LDC-FIO-CLF-OUT.
           PERFORM LDC-FIO-LDC-OUT.
           PERFORM LDC-FIO-RDC-OUT.
           PERFORM LDC-FIO-ARC-OUT.
           PERFORM LDC-FIO-ARG-OUT.

       FIN-FINAL-ELC.
           EXIT.
      *
       OBT-NUM-BDATOS SECTION.
       INI-OBT-NUM-BDATOS.
      * Busca Numero Base Maestra de GAR
           MOVE 'LDC' TO IDD-SAUX.
           MOVE 'M' TO IDD-GAUX.
           PERFORM BUS-IND-BDATOS.
           MOVE IDD-IAUX TO WSS-IDBM.
           MOVE IDD-IENT(WSS-IDBM) TO WSS-NUM-DBIN.
      * Busca Numero Base Historica de GAR
           MOVE 'LDC' TO IDD-SAUX.
           MOVE 'H' TO IDD-GAUX.
           PERFORM BUS-IND-BDATOS.
           MOVE IDD-IAUX TO WSS-IDBH.
           MOVE IDD-IENT(WSS-IDBH) TO WSS-NUM-DBOU.
       FIN-OBT-NUM-BDATOS.
           EXIT.
       BUS-IND-BDATOS SECTION.
       INI-BUS-IND-BDATOS.
      *RECIBE COMO INPUT EL GRUPO DE BASE DE DATOS EN IDD-GAUX
           MOVE SPACES TO IDD-RAUX.
           MOVE 1 TO IDD-IAUX.
           SET IDD-ITBL TO 1.
           SEARCH IDD-VSIS VARYING IDD-IAUX
             AT END
               GO TO NEX-BUS-IND-BDATOS
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
               MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
               GO TO FIN-BUS-IND-BDATOS.
       NEX-BUS-IND-BDATOS.
           MOVE 'En BUS-IND-BDATOS, NO existe en IDD:' TO FIO-MEN1.
           MOVE IDD-DAUX                               TO FIO-MEN2.
           PERFORM PRG-ABT.
       FIN-BUS-IND-BDATOS.
           EXIT.

       LDC-FIO-CLF-INP SECTION.
       INI-LDC-FIO-CLF-INP.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-CLF.
       FIN-LDC-FIO-CLF-INP.
           EXIT.

       LDC-FIO-LDC-INP SECTION.
       INI-LDC-FIO-LDC-INP.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-LDC.
       FIN-LDC-FIO-LDC-INP.
           EXIT.

       LDC-FIO-ARC-INP SECTION.
       INI-LDC-FIO-ARC-INP.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-ARC.
       FIN-LDC-FIO-ARC-INP.
           EXIT.

       LDC-FIO-ARG-INP SECTION.
       INI-LDC-FIO-ARG-INP.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-ARG.
       FIN-LDC-FIO-ARG-INP.
           EXIT.

       LDC-FIO-RDC-INP SECTION.
       INI-LDC-FIO-RDC-INP.
           MOVE WSS-NUM-DBIN TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-RDC.
       FIN-LDC-FIO-RDC-INP.
           EXIT.

       LDC-FIO-CLF-OUT SECTION.
       INI-LDC-FIO-CLF-OUT.
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-CLF.
       FIN-LDC-FIO-CLF-OUT.
           EXIT.

       LDC-FIO-LDC-OUT SECTION.
       INI-LDC-FIO-LDC-OUT.
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-LDC.
       FIN-LDC-FIO-LDC-OUT.
           EXIT.

       LDC-FIO-ARC-OUT SECTION.
       INI-LDC-FIO-ARC-OUT.
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-ARC.
       FIN-LDC-FIO-ARC-OUT.
           EXIT.

       LDC-FIO-ARG-OUT SECTION.
       INI-LDC-FIO-ARG-OUT.
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-ARG.
       FIN-LDC-FIO-ARG-OUT.
           EXIT.

       LDC-FIO-RDC-OUT SECTION.
       INI-LDC-FIO-RDC-OUT.
           MOVE WSS-NUM-DBOU TO IDD-IENT(WSS-IDBM).
           PERFORM LDC-FIO-RDC.
       FIN-LDC-FIO-RDC-OUT.
           EXIT.
      *
       ESTADISTICAS SECTION.
      *---------------------
       INI-ESTADISTICAS.

           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS  LDCPBHLC'.
           DISPLAY '----------------------'.
           DISPLAY 'PROCESADOS CLF  : ' 
                   WSS-NUM-LCLF IN WSS-VARI.
           DISPLAY 'GRABADOS CLF  : ' 
                   WSS-REG-GCLF IN WSS-VARI.
           DISPLAY 'GRABADOS LDC  : ' 
                   WSS-REG-GLDC IN WSS-VARI.
           DISPLAY 'GRABADOS ARC  : ' 
                   WSS-REG-GARC IN WSS-VARI.
           DISPLAY 'GRABADOS ARG  : ' 
                   WSS-REG-GARG IN WSS-VARI.
           DISPLAY 'GRABADOS RDC  : ' 
                   WSS-REG-GRDC IN WSS-VARI.
           DISPLAY 'BORRADOS CLF  : '
                   WSS-REG-BCLF IN WSS-VARI.
           DISPLAY 'BORRADOS LDC  : '
                   WSS-REG-BLDC IN WSS-VARI.
           DISPLAY 'BORRADOS ARC  : '
                   WSS-REG-BARC IN WSS-VARI.
           DISPLAY 'BORRADOS ARG  : '
                   WSS-REG-BARG IN WSS-VARI.
           DISPLAY 'BORRADOS RDC  : '
                   WSS-REG-BRDC IN WSS-VARI.
      *
           IF WSS-NUM-RBAD IN WSS-VARI > ZEROES
               PERFORM PRG-ABT
           ELSE
               PERFORM INI-GNS-PRO-END.
       FIN-ESTADISTICAS.
           EXIT.

       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY LDCBFRDC.

       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGABT.
       COPY GNSBGEND.
       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBBMSG.
       COPY GNSBGHOY.
