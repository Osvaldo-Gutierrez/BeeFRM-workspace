      * 22-MAY-92 10:01 AM
       PUT-ALL-LDC SECTION.
       INI-PUT-ALL-LDC.
           PERFORM PUT-CLF-LDC.
           PERFORM PUT-LDC-LDC.
           PERFORM PUT-ARC-LDC.
           PERFORM PUT-ARG-LDC.
      *<<<< FIN_PUT_ALL_LDC
           IF NOT (LDC-IND-PVIG IN LDC-FLD > SPACES AND          
              LDC-NUM-PVIG IN LDC-FLD > ZEROES )                      
               GO TO FIN-PUT-ALL-LDC.                                 
      *     MOVE CLF-NUM-DAPE IN CLF     TO FEC-ITM1.                  
      *     MOVE CLF-NUM-MAPE IN CLF     TO FEC-ITM2.                  
      *     MOVE CLF-NUM-SAPE IN CLF     TO FEC-ITM3.                  
      *     MOVE CLF-NUM-AAPE IN CLF     TO FEC-ITM4.                  
      *     IF LDC-IND-PVIG IN LDC-FLD = 'D'                           
      *        MOVE FEC-SUM-DIA  TO FEC-CMND                           
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA                
      *     ELSE                                                       
      *     IF LDC-IND-PVIG IN LDC-FLD = 'M'                           
      *        MOVE FEC-SUM-MES TO FEC-CMND                            
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES                
      *     ELSE                                                       
      *     IF LDC-IND-PVIG IN LDC-FLD = 'A'                           
      *        MOVE FEC-SUM-ANO TO FEC-CMND                            
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO                
      *     MOVE FEC-FORM-FEC TO FEC-FORM.                             
      *     PERFORM CAL-FEC.                                           
      *     MOVE FEC-ITM1     TO LDC-NUM-DVEN IN LDC.                  
      *     MOVE FEC-ITM2     TO LDC-NUM-MVEN IN LDC.                  
      *     MOVE FEC-ITM3     TO LDC-NUM-SVEN IN LDC.                  
      *     MOVE FEC-ITM4     TO LDC-NUM-AVEN IN LDC.                  
      *>>>>
       FIN-PUT-ALL-LDC.
           EXIT.
       
       PUT-CLF-LDC SECTION.
       INI-PUT-CLF-LDC.
           IF PGM-STAT-CLF-NUL
               GO TO FIN-PUT-CLF-LDC.
           IF NOT PGM-STAT-CLF-OKS
               PERFORM CLR-CLF-LDC
               GO TO FIN-PUT-CLF-LDC.
           MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN LDC-FLD.
           MOVE CLF-COD-TOCF IN CLF TO CLF-COD-TOCF IN LDC-FLD.
           MOVE CLF-COD-AOCF IN CLF TO CLF-COD-AOCF IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCCF IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-TOCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOCF IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
      *<<<< FIN_PUT_CLF_LDC
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                                           FRM-GLS-CMAX IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CMAX IN LDC-FLD.

           IF CLF-COD-AOCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LDC-FLD TO 
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN LDC-FLD TO 
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN LDC-FLD.
      *>>>>
       FIN-PUT-CLF-LDC.
           EXIT.
       
       PUT-LDC-LDC SECTION.
       INI-PUT-LDC-LDC.
           IF PGM-STAT-LDC-NUL
               GO TO FIN-PUT-LDC-LDC.
           IF NOT PGM-STAT-LDC-OKS
               PERFORM CLR-LDC-LDC
               GO TO FIN-PUT-LDC-LDC.
           MOVE LDC-CAI-ICLF IN LDC TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE LDC-IIC-ICLF IN LDC TO LDC-IIC-ICLF IN LDC-FLD.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN LDC-FLD.
           MOVE LDC-GLS-DESC IN LDC TO LDC-GLS-DESC IN LDC-FLD.
           MOVE LDC-GLS-DCOR IN LDC TO LDC-GLS-DCOR IN LDC-FLD.
           MOVE LDC-VAL-CMAX IN LDC TO LDC-VAL-CMAX IN LDC-FLD.
           MOVE LDC-IND-MGAR IN LDC TO LDC-IND-MGAR IN LDC-FLD.
           MOVE LDC-NUM-PVIG IN LDC TO LDC-NUM-PVIG IN LDC-FLD.
           MOVE LDC-NUM-DVEN IN LDC TO LDC-NUM-DVEN IN LDC-FLD.
           MOVE LDC-NUM-MVEN IN LDC TO LDC-NUM-MVEN IN LDC-FLD.
           MOVE LDC-NUM-SVEN IN LDC TO LDC-NUM-SVEN IN LDC-FLD.
           MOVE LDC-NUM-AVEN IN LDC TO LDC-NUM-AVEN IN LDC-FLD.
           MOVE LDC-IND-PVIG IN LDC TO LDC-IND-PVIG IN LDC-FLD.
           MOVE LDC-IND-VIGE IN LDC TO LDC-IND-VIGE IN LDC-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF LDC-IND-PVIG IN LDC-FLD > SPACES
               MOVE 'LDC' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PVIG IN LDC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-PVIG IN LDC-FLD.
       FIN-PUT-LDC-LDC.
           EXIT.
       
       PUT-ARC-LDC SECTION.
       INI-PUT-ARC-LDC.
           IF PGM-STAT-ARC-NUL
               GO TO FIN-PUT-ARC-LDC.
           IF NOT PGM-STAT-ARC-OKS
               PERFORM CLR-ARC-LDC
               GO TO FIN-PUT-ARC-LDC.
           MOVE ARC-COD-VCOC IN ARC TO ARC-COD-VCOC IN LDC-FLD.
           MOVE ARC-COD-TOOC IN ARC TO ARC-COD-TOOC IN LDC-FLD.
           MOVE ARC-COD-AOOC IN ARC TO ARC-COD-AOOC IN LDC-FLD.
           MOVE ARC-CAI-IOPC IN ARC TO ARC-CAI-IOPC IN LDC-FLD.
           MOVE ARC-IIC-IOPC IN ARC TO ARC-IIC-IOPC IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-VCOC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-VCOC IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-TOOC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-TOOC IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
      *<<<< FIN_PUT_ARC_LDC
           IF ARC-COD-VCOC IN LDC-FLD = 'M     '
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.

           IF ARC-COD-AOOC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-TOOC IN LDC-FLD TO 
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE ARC-COD-AOOC IN LDC-FLD TO 
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
      *>>>>
       FIN-PUT-ARC-LDC.
           EXIT.
       
       PUT-ARG-LDC SECTION.
       INI-PUT-ARG-LDC.
           IF PGM-STAT-ARG-NUL
               GO TO FIN-PUT-ARG-LDC.
           IF NOT PGM-STAT-ARG-OKS
               PERFORM CLR-ARG-LDC
               GO TO FIN-PUT-ARG-LDC.
           MOVE ARG-COD-TOGA IN ARG TO ARG-COD-TOGA IN LDC-FLD.
           MOVE ARG-COD-AOGA IN ARG TO ARG-COD-AOGA IN LDC-FLD.
           MOVE ARG-NUM-PORG IN ARG TO ARG-NUM-PORG IN LDC-FLD.
           MOVE ARG-CAI-IGAR IN ARG TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE ARG-IIC-IGAR IN ARG TO ARG-IIC-IGAR IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARG-COD-TOGA IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-TOGA IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOGA IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
      *<<<< FIN_PUT_ARG_LDC
           IF ARG-COD-AOGA IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-TOGA IN LDC-FLD TO 
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE ARG-COD-AOGA IN LDC-FLD TO 
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOGA IN LDC-FLD.
      *>>>>
       FIN-PUT-ARG-LDC.
           EXIT.
       
       RET-ALL-LDC SECTION.
       INI-RET-ALL-LDC.
           PERFORM KEY-ALL-LDC.
           PERFORM RET-CLF-LDC.
           PERFORM RET-LDC-LDC.
           PERFORM RET-ARC-LDC.
           PERFORM RET-ARG-LDC.
       FIN-RET-ALL-LDC.
           EXIT.
       
       RET-CLF-LDC SECTION.
       INI-RET-CLF-LDC.
           MOVE CLF-COD-VCCF IN LDC-FLD TO CLF-COD-VCCF IN CLF.
           MOVE CLF-COD-TOCF IN LDC-FLD TO CLF-COD-TOCF IN CLF.
           MOVE CLF-COD-AOCF IN LDC-FLD TO CLF-COD-AOCF IN CLF.
       FIN-RET-CLF-LDC.
           EXIT.
       
       RET-LDC-LDC SECTION.
       INI-RET-LDC-LDC.
           MOVE LDC-GLS-DESC IN LDC-FLD TO LDC-GLS-DESC IN LDC.
           MOVE LDC-GLS-DCOR IN LDC-FLD TO LDC-GLS-DCOR IN LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD TO LDC-VAL-CMAX IN LDC.
           MOVE LDC-IND-MGAR IN LDC-FLD TO LDC-IND-MGAR IN LDC.
           MOVE LDC-NUM-PVIG IN LDC-FLD TO LDC-NUM-PVIG IN LDC.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO LDC-NUM-DVEN IN LDC.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO LDC-NUM-MVEN IN LDC.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO LDC-NUM-SVEN IN LDC.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO LDC-NUM-AVEN IN LDC.
           MOVE LDC-IND-PVIG IN LDC-FLD TO LDC-IND-PVIG IN LDC.
           MOVE LDC-IND-VIGE IN LDC-FLD TO LDC-IND-VIGE IN LDC.
       FIN-RET-LDC-LDC.
           EXIT.
       
       RET-ARC-LDC SECTION.
       INI-RET-ARC-LDC.
           MOVE ARC-COD-VCOC IN LDC-FLD TO ARC-COD-VCOC IN ARC.
           MOVE ARC-COD-TOOC IN LDC-FLD TO ARC-COD-TOOC IN ARC.
           MOVE ARC-COD-AOOC IN LDC-FLD TO ARC-COD-AOOC IN ARC.
           MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC IN ARC.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC IN ARC.
       FIN-RET-ARC-LDC.
           EXIT.
       
       RET-ARG-LDC SECTION.
       INI-RET-ARG-LDC.
           MOVE ARG-COD-TOGA IN LDC-FLD TO ARG-COD-TOGA IN ARG.
           MOVE ARG-COD-AOGA IN LDC-FLD TO ARG-COD-AOGA IN ARG.
           MOVE ARG-NUM-PORG IN LDC-FLD TO ARG-NUM-PORG IN ARG.
           MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR IN ARG.
           MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR IN ARG.
       FIN-RET-ARG-LDC.
           EXIT.
       
       KEY-ALL-LDC SECTION.
       INI-KEY-ALL-LDC.
           PERFORM KEY-CLF-LDC.
           PERFORM KEY-LDC-LDC.
           PERFORM KEY-ARC-LDC.
           PERFORM KEY-ARG-LDC.
       FIN-KEY-ALL-LDC.
           EXIT.
       
       KEY-CLF-LDC SECTION.
       INI-KEY-CLF-LDC.
       FIN-KEY-CLF-LDC.
           EXIT.
       
       KEY-LDC-LDC SECTION.
       INI-KEY-LDC-LDC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-LDC.
           EXIT.
       
       KEY-ARC-LDC SECTION.
       INI-KEY-ARC-LDC.
       FIN-KEY-ARC-LDC.
           EXIT.
       
       KEY-ARG-LDC SECTION.
       INI-KEY-ARG-LDC.
       FIN-KEY-ARG-LDC.
           EXIT.
       
       SCR-CLRA-LDC SECTION.
       INI-SCR-CLRA-LDC.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-CLRA-LDC.
           EXIT.
       
       CLR-KEY-LDC SECTION.
       INI-CLR-KEY-LDC.
           MOVE SPACES TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN LDC-FLD.
       FIN-CLR-KEY-LDC.
           EXIT.
       
       CLR-FLD-LDC SECTION.
       INI-CLR-FLD-LDC.
           MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-CMAX IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD.
           PERFORM CLR-CLF-LDC.
           PERFORM CLR-LDC-LDC.
           PERFORM CLR-ARC-LDC.
           PERFORM CLR-ARG-LDC.
       FIN-CLR-FLD-LDC.
           EXIT.
       
       CLR-CLF-LDC SECTION.
       INI-CLR-CLF-LDC.
           MOVE SPACES TO CLF-COD-VCCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN LDC-FLD.
       FIN-CLR-CLF-LDC.
           EXIT.
       
       CLR-LDC-LDC SECTION.
       INI-CLR-LDC-LDC.
           MOVE SPACES TO LDC-GLS-DESC IN LDC-FLD.
           MOVE SPACES TO LDC-GLS-DCOR IN LDC-FLD.
           MOVE ZEROES TO LDC-VAL-CMAX IN LDC-FLD.
           MOVE SPACES TO LDC-IND-MGAR IN LDC-FLD.
           MOVE ZEROES TO LDC-NUM-PVIG IN LDC-FLD.
           MOVE SPACES TO LDC-FEC-FVEN IN LDC-FLD.
           MOVE SPACES TO LDC-IND-PVIG IN LDC-FLD.
           MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD.
       FIN-CLR-LDC-LDC.
           EXIT.
       
       CLR-ARC-LDC SECTION.
       INI-CLR-ARC-LDC.
           MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD.
           MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD.
           MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD.
       FIN-CLR-ARC-LDC.
           EXIT.
       
       CLR-ARG-LDC SECTION.
       INI-CLR-ARG-LDC.
           MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD.
           MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD.
           MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD.
           MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-CLR-ARG-LDC.
           EXIT.
       
       FST-KEY-LDC SECTION.
       INI-FST-KEY-LDC.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN LDC-FLD.
       FIN-FST-KEY-LDC.
           EXIT.
       
       FST-FLD-LDC SECTION.
       INI-FST-FLD-LDC.
           MOVE -1 TO LDC-GLS-DESC-LEN IN LDC-FLD.
      *<<<< FIN_FST_FLD_LDC
       SIG-FST-FLD-LDC.
           IF SCR-CMND = 'ING'                                      
               MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD.    
      *>>>>
       FIN-FST-FLD-LDC.
           EXIT.
       
       PRO-KEY-LDC SECTION.
       INI-PRO-KEY-LDC.
           PERFORM PRO-IKY-LDC.
           PERFORM PRO-AKY-LDC.
           PERFORM PRO-MKY-LDC.
       FIN-PRO-KEY-LDC.
           EXIT.
       
       PRO-IKY-LDC SECTION.
       INI-PRO-IKY-LDC.
           MOVE FRM-CPIM-AEY TO LDC-CAI-ICLF-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IIC-ICLF-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN LDC-FLD.
       FIN-PRO-IKY-LDC.
           EXIT.
       
       PRO-MKY-LDC SECTION.
       INI-PRO-MKY-LDC.
       FIN-PRO-MKY-LDC.
           EXIT.
       
       PRO-AKY-LDC SECTION.
       INI-PRO-AKY-LDC.
       FIN-PRO-AKY-LDC.
           EXIT.
       
       PRO-FLD-LDC SECTION.
       INI-PRO-FLD-LDC.
           PERFORM PRO-CLF-LDC.
           PERFORM PRO-LDC-LDC.
           PERFORM PRO-ARC-LDC.
           PERFORM PRO-ARG-LDC.
       FIN-PRO-FLD-LDC.
           EXIT.
       
       PRO-CLF-LDC SECTION.
       INI-PRO-CLF-LDC.
       FIN-PRO-CLF-LDC.
           EXIT.
       
       PRO-LDC-LDC SECTION.
       INI-PRO-LDC-LDC.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-VAL-CMAX-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-MGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-FEC-FVEN-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD.
       FIN-PRO-LDC-LDC.
           EXIT.
       
       PRO-ARC-LDC SECTION.
       INI-PRO-ARC-LDC.
           MOVE FRM-CPIM-AEY TO ARC-COD-VCOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-COD-TOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-COD-AOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-CAI-IOPC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-IIC-IOPC-ATR IN LDC-FLD.
       FIN-PRO-ARC-LDC.
           EXIT.
       
       PRO-ARG-LDC SECTION.
       INI-PRO-ARG-LDC.
           MOVE FRM-CPIM-AEY TO ARG-COD-TOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-COD-AOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-NUM-PORG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-CAI-IGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-IIC-IGAR-ATR IN LDC-FLD.
       FIN-PRO-ARG-LDC.
           EXIT.
       
       UNP-KEY-LDC SECTION.
       INI-UNP-KEY-LDC.
           PERFORM UNP-IKY-LDC.
           PERFORM UNP-AKY-LDC.
           PERFORM UNP-MKY-LDC.
       FIN-UNP-KEY-LDC.
           EXIT.
       
       UNP-IKY-LDC SECTION.
       INI-UNP-IKY-LDC.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-LDC.
           EXIT.
       
       UNP-MKY-LDC SECTION.
       INI-UNP-MKY-LDC.
       FIN-UNP-MKY-LDC.
           EXIT.
       
       UNP-AKY-LDC SECTION.
       INI-UNP-AKY-LDC.
       FIN-UNP-AKY-LDC.
           EXIT.
       
       UNP-FLD-LDC SECTION.
       INI-UNP-FLD-LDC.
           PERFORM UNP-CLF-LDC.
           PERFORM UNP-LDC-LDC.
           PERFORM UNP-ARC-LDC.
           PERFORM UNP-ARG-LDC.
       FIN-UNP-FLD-LDC.
           EXIT.
       
       UNP-CLF-LDC SECTION.
       INI-UNP-CLF-LDC.
       FIN-UNP-CLF-LDC.
           EXIT.
       
       UNP-LDC-LDC SECTION.
       INI-UNP-LDC-LDC.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-VAL-CMAX-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-MGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-NUM-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FVEN-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-VIGE-ATR IN LDC-FLD.
       FIN-UNP-LDC-LDC.
           EXIT.
       
       UNP-ARC-LDC SECTION.
       INI-UNP-ARC-LDC.
           MOVE FRM-CPIM-UBY TO ARC-COD-VCOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-TOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-AOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-CAI-IOPC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-IIC-IOPC-ATR IN LDC-FLD.
       FIN-UNP-ARC-LDC.
           EXIT.
       
       UNP-ARG-LDC SECTION.
       INI-UNP-ARG-LDC.
           MOVE FRM-CPIM-UBY TO ARG-COD-TOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-COD-AOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-NUM-PORG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-CAI-IGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-IIC-IGAR-ATR IN LDC-FLD.
       FIN-UNP-ARG-LDC.
           EXIT.
       
       VAL-KEY-LDC SECTION.
       INI-VAL-KEY-LDC.
           PERFORM VAL-IKY-LDC.
           PERFORM VAL-MKY-LDC.
           PERFORM VAL-AKY-LDC.
       FIN-VAL-KEY-LDC.
           EXIT.
       
       VAL-IKY-LDC SECTION.
       INI-VAL-IKY-LDC.
           PERFORM VAL-LDC-CAI-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-CAI-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
           PERFORM VAL-LDC-IIC-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
           PERFORM VAL-LDC-NUM-ILDC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
       FIN-VAL-IKY-LDC.
           EXIT.
       
       VAL-MKY-LDC SECTION.
       INI-VAL-MKY-LDC.
       FIN-VAL-MKY-LDC.
           EXIT.
       
       VAL-AKY-LDC SECTION.
       INI-VAL-AKY-LDC.
       FIN-VAL-AKY-LDC.
           EXIT.
       
       VAL-FLD-LDC SECTION.
       INI-VAL-FLD-LDC.
           PERFORM VAL-CLF-COD-VCCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-VCCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-CLF-COD-TOCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-TOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-CLF-COD-AOCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-AOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-VCCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOCF.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-GLS-DESC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-GLS-DESC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-GLS-DCOR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-GLS-DCOR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-VCOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-VAL-CMAX.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-CMAX.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-CMAX-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-TOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARC-COD-TOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-AOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARC-COD-AOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-IND-MGAR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-IND-MGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-CAI-IOPC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARC-CAI-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-IIC-IOPC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-COD-TOGA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARG-COD-TOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-COD-AOGA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARG-COD-AOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOGA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOGA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-NUM-PORG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-CAI-IGAR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARG-CAI-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-IIC-IGAR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-NUM-PVIG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-FEC-FVEN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-FEC-FVEN-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-IND-PVIG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-IND-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-PVIG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-IND-VIGE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-IND-VIGE-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
       FIN-VAL-FLD-LDC.
           EXIT.
       
       VAL-CLF-COD-VCCF SECTION.
       INI-VAL-CLF-COD-VCCF.
           IF CLF-COD-VCCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-VCCF IN LDC-FLD.
       FIN-VAL-CLF-COD-VCCF.
           EXIT.
       
       VAL-CLF-COD-TOCF SECTION.
       INI-VAL-CLF-COD-TOCF.
           IF CLF-COD-TOCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-TOCF IN LDC-FLD.
       FIN-VAL-CLF-COD-TOCF.
           EXIT.
       
       VAL-CLF-COD-AOCF SECTION.
       INI-VAL-CLF-COD-AOCF.
           IF CLF-COD-AOCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-AOCF IN LDC-FLD.
       FIN-VAL-CLF-COD-AOCF.
           EXIT.
       
       VAL-LDC-CAI-ICLF SECTION.
       INI-VAL-LDC-CAI-ICLF.
           IF LDC-CAI-ICLF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-CAI-ICLF IN LDC-FLD.
       FIN-VAL-LDC-CAI-ICLF.
           EXIT.
       
       VAL-LDC-IIC-ICLF SECTION.
       INI-VAL-LDC-IIC-ICLF.
       FIN-VAL-LDC-IIC-ICLF.
           EXIT.
       
       VAL-FRM-GLS-VCCF SECTION.
       INI-VAL-FRM-GLS-VCCF.
           IF FRM-GLS-VCCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
       FIN-VAL-FRM-GLS-VCCF.
           EXIT.
       
       VAL-FRM-GLS-TOCF SECTION.
       INI-VAL-FRM-GLS-TOCF.
           IF FRM-GLS-TOCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
       FIN-VAL-FRM-GLS-TOCF.
           EXIT.
       
       VAL-FRM-GLS-AOCF SECTION.
       INI-VAL-FRM-GLS-AOCF.
           IF FRM-GLS-AOCF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-AOCF IN LDC-FLD.
       FIN-VAL-FRM-GLS-AOCF.
           EXIT.
       
       VAL-LDC-NUM-ILDC SECTION.
       INI-VAL-LDC-NUM-ILDC.
       FIN-VAL-LDC-NUM-ILDC.
           EXIT.
       
       VAL-LDC-GLS-DESC SECTION.
       INI-VAL-LDC-GLS-DESC.
           IF LDC-GLS-DESC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-GLS-DESC IN LDC-FLD.
       FIN-VAL-LDC-GLS-DESC.
           EXIT.
       
       VAL-LDC-GLS-DCOR SECTION.
       INI-VAL-LDC-GLS-DCOR.
           IF LDC-GLS-DCOR IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-GLS-DCOR IN LDC-FLD.
       FIN-VAL-LDC-GLS-DCOR.
           EXIT.
       
       VAL-ARC-COD-VCOC SECTION.
       INI-VAL-ARC-COD-VCOC.
           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD.
      *<<<< ARC_COD_VCOC
           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES OR
              ARC-COD-VCOC IN LDC-FLD = 'M'
              IF ARC-COD-VCOC IN LDC-FLD = 'M'
                 MOVE 'MULTIPLES' TO FRM-GLS-VCOC IN LDC-FLD
                 GO TO FIN-VAL-ARC-COD-VCOC
              ELSE
                 MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
                 GO TO FIN-VAL-ARC-COD-VCOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-VCOC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-VCOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN LDC-FLD.
       FIN-VAL-ARC-COD-VCOC.
           EXIT.
       
       VAL-LDC-VAL-CMAX SECTION.
       INI-VAL-LDC-VAL-CMAX.
      *<<<< LDC_VAL_CMAX
           IF LDC-VAL-CMAX IN LDC-FLD = ZEROES      
               PERFORM ERR-GLS.                     
      *>>>>
       FIN-VAL-LDC-VAL-CMAX.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
           IF FRM-GLS-VCOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-FRM-GLS-CMAX SECTION.
       INI-VAL-FRM-GLS-CMAX.
           IF FRM-GLS-CMAX IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-CMAX IN LDC-FLD.
       FIN-VAL-FRM-GLS-CMAX.
           EXIT.
       
       VAL-ARC-COD-TOOC SECTION.
       INI-VAL-ARC-COD-TOOC.
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD.
      *<<<< ARC_COD_TOOC
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES
              GO TO FIN-VAL-ARC-COD-TOOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN LDC-FLD.
       FIN-VAL-ARC-COD-TOOC.
           EXIT.
       
       VAL-ARC-COD-AOOC SECTION.
       INI-VAL-ARC-COD-AOOC.
           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD.
      *<<<< ARC_COD_AOOC
           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
              GO TO FIN-VAL-ARC-COD-AOOC.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO 
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARC-COD-AOOC IN LDC-FLD TO 
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
      *>>>>
       FIN-VAL-ARC-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
           IF FRM-GLS-TOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
           IF FRM-GLS-AOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
       
       VAL-LDC-IND-MGAR SECTION.
       INI-VAL-LDC-IND-MGAR.
           IF LDC-IND-MGAR IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-MGAR IN LDC-FLD.
       FIN-VAL-LDC-IND-MGAR.
           EXIT.
       
       VAL-ARC-CAI-IOPC SECTION.
       INI-VAL-ARC-CAI-IOPC.
           IF ARC-CAI-IOPC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD.
       FIN-VAL-ARC-CAI-IOPC.
           EXIT.
       
       VAL-ARC-IIC-IOPC SECTION.
       INI-VAL-ARC-IIC-IOPC.
       FIN-VAL-ARC-IIC-IOPC.
           EXIT.
       
       VAL-ARG-COD-TOGA SECTION.
       INI-VAL-ARG-COD-TOGA.
           IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD.
      *<<<< ARG_COD_TOGA
           IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES OR
              ARG-COD-TOGA IN LDC-FLD = 'AVL'      OR
              ARG-COD-TOGA IN LDC-FLD = 'FIA'      
              GO TO FIN-VAL-ARG-COD-TOGA.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE ARG-COD-TOGA IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOGA IN LDC-FLD.
       FIN-VAL-ARG-COD-TOGA.
           EXIT.
       
       VAL-ARG-COD-AOGA SECTION.
       INI-VAL-ARG-COD-AOGA.
           IF ARG-COD-AOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD.
      *<<<< ARG_COD_AOGA
           IF ARG-COD-AOGA IN LDC-FLD NOT > SPACES
              GO TO FIN-VAL-ARG-COD-AOGA.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARG-COD-TOGA IN LDC-FLD TO 
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARG-COD-AOGA IN LDC-FLD TO 
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARG-COD-AOGA IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOGA IN LDC-FLD.
      *>>>>
       FIN-VAL-ARG-COD-AOGA.
           EXIT.
       
       VAL-FRM-GLS-TOGA SECTION.
       INI-VAL-FRM-GLS-TOGA.
           IF FRM-GLS-TOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
       FIN-VAL-FRM-GLS-TOGA.
           EXIT.
       
       VAL-FRM-GLS-AOGA SECTION.
       INI-VAL-FRM-GLS-AOGA.
           IF FRM-GLS-AOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD.
       FIN-VAL-FRM-GLS-AOGA.
           EXIT.
       
       VAL-ARG-NUM-PORG SECTION.
       INI-VAL-ARG-NUM-PORG.
      *<<<< ARG_NUM_PORG
           IF ARG-COD-TOGA IN LDC-FLD > SPACES AND
              ARG-COD-AOGA IN LDC-FLD > SPACES 
              MOVE ARG-COD-TOGA IN LDC-FLD TO GAR-TIP-OPE IN TAG
              MOVE ARG-COD-AOGA IN LDC-FLD TO GAR-STP-OPE IN TAG
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GAR-FIO-TAG
              IF NOT FIO-STAT-OKS
                 MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
              ELSE
                 MOVE GAR-PCT-PON IN TAG TO ARG-NUM-PORG IN LDC-FLD.

           IF ARG-NUM-PORG IN LDC-FLD = ZEROES
              IF LDC-IND-MGAR IN LDC-FLD = 'E' OR ' '
                 MOVE 'DEU'       TO MSG-COD-SIST
                 MOVE 'PORGOBLIG' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-ARG-NUM-PORG.                          
      *>>>>
       FIN-VAL-ARG-NUM-PORG.
           EXIT.
       
       VAL-ARG-CAI-IGAR SECTION.
       INI-VAL-ARG-CAI-IGAR.
           IF ARG-CAI-IGAR IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD.
       FIN-VAL-ARG-CAI-IGAR.
           EXIT.
       
       VAL-ARG-IIC-IGAR SECTION.
       INI-VAL-ARG-IIC-IGAR.
       FIN-VAL-ARG-IIC-IGAR.
           EXIT.
       
       VAL-LDC-NUM-PVIG SECTION.
       INI-VAL-LDC-NUM-PVIG.
       FIN-VAL-LDC-NUM-PVIG.
           EXIT.
       
       VAL-LDC-FEC-FVEN SECTION.
       INI-VAL-LDC-FEC-FVEN.
      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FVEN IN LDC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LDC_FEC_FVEN
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FVEN IN LDC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FVEN.
       FIN-VAL-LDC-FEC-FVEN.
           EXIT.
       
       VAL-LDC-IND-PVIG SECTION.
       INI-VAL-LDC-IND-PVIG.
           IF LDC-IND-PVIG IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-PVIG IN LDC-FLD.
      *<<<< LDC_IND_PVIG
           IF LDC-IND-PVIG IN LDC-FLD NOT > SPACES
              GO TO FIN-VAL-LDC-IND-PVIG.
      *VAL-IND Valida miscelaneo de tabla                           
           MOVE 'DEU' TO MSC-COD-SIST.                              
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.                      
           MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC.     
           PERFORM VAL-IND.                                         
           IF MSG-COD-MENS = 'COD    NEX' OR                        
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES                  
               MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD               
           ELSE                                                     
               MOVE MSC-GLS-ABRV IN MSC TO                          
                    FRM-GLS-PVIG IN LDC-FLD.                        
      *     IF NOT (LDC-IND-PVIG IN LDC-FLD > SPACES AND             
      *        LDC-NUM-PVIG IN LDC-FLD > ZEROES )                    
      *         GO TO FIN-VAL-LDC-IND-PVIG.                          
      *     MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF.     
      *     MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF.     
      *     MOVE FIO-GET-KEY TO FIO-CMND.                            
      *     PERFORM LDC-FIO-CLF.                                     
      *     MOVE CLF-NUM-DAPE IN CLF     TO FEC-ITM1.                
      *     MOVE CLF-NUM-MAPE IN CLF     TO FEC-ITM2.                
      *     MOVE CLF-NUM-SAPE IN CLF     TO FEC-ITM3.                
      *     MOVE CLF-NUM-AAPE IN CLF     TO FEC-ITM4.                
      *     IF LDC-IND-PVIG IN LDC-FLD = 'D'                         
      *        MOVE FEC-SUM-DIA  TO FEC-CMND                         
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA              
      *     ELSE                                                     
      *     IF LDC-IND-PVIG IN LDC-FLD = 'M'                         
      *        MOVE FEC-SUM-MES TO FEC-CMND                          
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES              
      *     ELSE                                                     
      *     IF LDC-IND-PVIG IN LDC-FLD = 'A'                         
      *        MOVE FEC-SUM-ANO TO FEC-CMND                          
      *        MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.             
      *     MOVE FEC-FORM-FEC TO FEC-FORM.                           
      *     PERFORM CAL-FEC.                                         
      *     MOVE FEC-FECH     TO LDC-FEC-FVEN IN LDC-FLD.            
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'LDC' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PVIG IN LDC-FLD.
       FIN-VAL-LDC-IND-PVIG.
           EXIT.
       
       VAL-FRM-GLS-PVIG SECTION.
       INI-VAL-FRM-GLS-PVIG.
           IF FRM-GLS-PVIG IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD.
       FIN-VAL-FRM-GLS-PVIG.
           EXIT.
       
       VAL-LDC-IND-VIGE SECTION.
       INI-VAL-LDC-IND-VIGE.
           IF LDC-IND-VIGE IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD.
      *<<<< LDC_IND_VIGE
           IF SCR-CMND = 'ING'                                       
               MOVE 'S' TO LDC-IND-VIGE IN LDC-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-IND-VIGE IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           GO TO FIN-VAL-LDC-IND-VIGE.
      *>>>>
      *<<<< INI_LDC_FEC_FVEN
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'LDC' TO TAB-COD-SIST.
           MOVE 'VIG' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-IND-VIGE IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-LDC-IND-VIGE.
           EXIT.
       
       VAL-CON-KEY-LDC SECTION.
       INI-VAL-CON-KEY-LDC.
           IF     LDC-CAI-ICLF IN LDC-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN LDC-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN LDC-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LDC.
       FIN-VAL-CON-KEY-LDC.
           EXIT.
       
       VAL-CON-IKY-LDC SECTION.
       INI-VAL-CON-IKY-LDC.
           IF     LDC-CAI-ICLF IN LDC-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN LDC-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN LDC-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LDC.
       FIN-VAL-CON-IKY-LDC.
           EXIT.
       
       VAL-CON-FLD-LDC SECTION.
       INI-VAL-CON-FLD-LDC.
      *<<<< VAL_CON_FLD_LDC
           MOVE 'N' TO FRM-UCUR.
           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES
              MOVE FRM-GLS-VCCF IN LDC-FLD TO
                                          FRM-GLS-CMAX IN LDC-FLD
           ELSE
              MOVE FRM-GLS-VCOC IN LDC-FLD TO
                                          FRM-GLS-CMAX IN LDC-FLD.

           IF ARC-COD-VCOC IN LDC-FLD = 'M'
              GO TO VAL-ARG.
                 GO TO FIN-VAL-CON-FLD-LDC.

       VAL-ARC.
           PERFORM VAL-CON-ARC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
              GO TO FIN-VAL-CON-FLD-LDC.

       VAL-ARG.
           IF LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' 
              GO TO VAL-PVIG.

           IF LDC-IND-MGAR IN LDC-FLD = 'E'
              GO TO VAL-GARE.

           IF LDC-IND-MGAR IN LDC-FLD = 'S'
              IF ARG-COD-TOGA IN LDC-FLD = SPACES AND
                 ARG-COD-AOGA IN LDC-FLD = SPACES AND
                 ARG-CAI-IGAR IN LDC-FLD = SPACES AND
                 ARG-IIC-IGAR IN LDC-FLD = ZEROES
                 GO TO VAL-PVIG
              ELSE
                 MOVE 'DEU'       TO MSG-COD-SIST
                 MOVE 'ERRCONGAR' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1  TO LDC-IND-MGAR-LEN IN LDC-FLD 
                 MOVE 'S' TO FRM-UCUR
                 GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-IND-MGAR IN LDC-FLD = SPACES
              PERFORM VAL-CON-ARG 
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                 GO TO FIN-VAL-CON-FLD-LDC
              ELSE
                 GO TO VAL-PVIG.

       VAL-GARE.
           IF ARG-IIC-IGAR IN LDC-FLD = ZEROES
              IF ARG-COD-TOGA IN LDC-FLD = 'AVL'
                 PERFORM PRO-CIC-GDG
                 IF WSS-STAT-GDG = 1
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                   NEXT SENTENCE
              ELSE
              IF ARG-COD-TOGA IN LDC-FLD = 'FIA'
                 PERFORM PRO-CIC-FIA
                 IF WSS-STAT-FIA = 1
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                 ELSE
                    NEXT SENTENCE
              ELSE
                 MOVE 'DEU'       TO MSG-COD-SIST
                 MOVE 'VALTOGNEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1  TO ARG-COD-TOGA-LEN IN LDC-FLD 
                 MOVE 'S' TO FRM-UCUR
                 GO TO FIN-VAL-CON-FLD-LDC
           ELSE
              IF ARG-COD-TOGA IN LDC-FLD = 'AVL'
                 MOVE ARG-CAI-IGAR IN LDC-FLD TO GAR-NUM-SIS IN GDG
                 MOVE ARG-IIC-IGAR IN LDC-FLD TO GAR-COD-CRR IN GDG
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM GAR-FIO-GDG
                 IF FIO-STAT-OKS
                    MOVE 'DEU'       TO MSG-COD-SIST
                    MOVE 'CICGDGEXI' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    MOVE -1  TO ARG-IIC-IGAR-LEN IN LDC-FLD 
                    MOVE 'S' TO FRM-UCUR
                    GO TO FIN-VAL-CON-FLD-LDC
                 ELSE
                    NEXT SENTENCE
              ELSE
              IF ARG-COD-TOGA IN LDC-FLD = 'FIA'
                 MOVE ARG-CAI-IGAR IN LDC-FLD TO FIA-CAI-IESC IN FIA
                 MOVE ARG-IIC-IGAR IN LDC-FLD TO FIA-IIC-IESC IN FIA
                 MOVE 1                       TO FIA-NUM-IFIA IN FIA
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM DEU-FIO-FIA
                 IF FIO-STAT-OKS
                    MOVE 'DEU'       TO MSG-COD-SIST
                    MOVE 'CICFIAEXI' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    MOVE -1  TO ARG-IIC-IGAR-LEN IN LDC-FLD 
                    MOVE 'S' TO FRM-UCUR
                    GO TO FIN-VAL-CON-FLD-LDC
                 ELSE
                    NEXT SENTENCE
              ELSE
                 MOVE 'DEU'       TO MSG-COD-SIST
                 MOVE 'VALTOGNEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1  TO ARG-COD-TOGA-LEN IN LDC-FLD 
                 MOVE 'S' TO FRM-UCUR
                 GO TO FIN-VAL-CON-FLD-LDC.

       VAL-PVIG.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF.     
           MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF.     
           MOVE FIO-GET-KEY TO FIO-CMND.                            
           PERFORM LDC-FIO-CLF.                                     
           IF NOT FIO-STAT-OKS
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'CLFNEXVAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD = SPACES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGPVGFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO LDC-NUM-PVIG-LEN  IN LDC-FLD
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-FLD-LDC.
              
           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGPVGFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO LDC-IND-PVIG-LEN  IN LDC-FLD
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
              PERFORM OBT-FVEN
              IF WSS-FEC-FVEN IN WSS-VARI NOT = 
                                             LDC-FEC-FVEN IN LDC-FLD 
                 MOVE 'DEU' TO MSG-COD-SIST
                 MOVE 'ERRCONFLD' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1 TO LDC-FEC-FVEN-LEN  IN LDC-FLD
                 MOVE 'S' TO FRM-UCUR
                 GO TO FIN-VAL-CON-FLD-LDC
              ELSE
                MOVE WSS-NUM-DVEN IN WSS-VARI TO 
                                              LDC-NUM-DVEN IN LDC-FLD
                MOVE WSS-NUM-MVEN IN WSS-VARI TO 
                                              LDC-NUM-MVEN IN LDC-FLD
                MOVE WSS-NUM-SVEN IN WSS-VARI TO 
                                              LDC-NUM-SVEN IN LDC-FLD
                MOVE WSS-NUM-AVEN IN WSS-VARI TO 
                                              LDC-NUM-AVEN IN LDC-FLD
                GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD = SPACES AND
              LDC-FEC-FVEN IN LDC-FLD = ZEROES
              MOVE CLF-NUM-DVEN IN CLF TO LDC-NUM-DVEN IN LDC-FLD
              MOVE CLF-NUM-MVEN IN CLF TO LDC-NUM-MVEN IN LDC-FLD
              MOVE CLF-NUM-SVEN IN CLF TO LDC-NUM-SVEN IN LDC-FLD
              MOVE CLF-NUM-AVEN IN CLF TO LDC-NUM-AVEN IN LDC-FLD
              MOVE CLF-NUM-PVIG IN CLF TO LDC-NUM-PVIG IN LDC-FLD
              MOVE CLF-IND-PVIG IN CLF TO LDC-IND-PVIG IN LDC-FLD
              GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD = ZEROES 
              PERFORM OBT-FVEN
              MOVE WSS-NUM-DVEN IN WSS-VARI TO 
                                            LDC-NUM-DVEN IN LDC-FLD
              MOVE WSS-NUM-MVEN IN WSS-VARI TO 
                                            LDC-NUM-MVEN IN LDC-FLD
              MOVE WSS-NUM-SVEN IN WSS-VARI TO 
                                            LDC-NUM-SVEN IN LDC-FLD
              MOVE WSS-NUM-AVEN IN WSS-VARI TO 
                                            LDC-NUM-AVEN IN LDC-FLD
              GO TO FIN-VAL-CON-FLD-LDC.

           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD = SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
              PERFORM OBT-PVIG
              GO TO FIN-VAL-CON-FLD-LDC.
      *>>>>
       FIN-VAL-CON-FLD-LDC.
           EXIT.
       
       VAL-CON-LDC SECTION.
       INI-VAL-CON-LDC.
       FIN-VAL-CON-LDC.
           EXIT.
       
       VAL-NUM-KEY-LDC SECTION.
       INI-VAL-NUM-KEY-LDC.
           PERFORM VAL-NUM-IKY-LDC.
           PERFORM VAL-NUM-MKY-LDC.
           PERFORM VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-KEY-LDC.
           EXIT.
       
       VAL-NUM-IKY-LDC SECTION.
       INI-VAL-NUM-IKY-LDC.
       FIN-VAL-NUM-IKY-LDC.
           EXIT.
       
       VAL-NUM-MKY-LDC SECTION.
       INI-VAL-NUM-MKY-LDC.
       FIN-VAL-NUM-MKY-LDC.
           EXIT.
       
       VAL-NUM-AKY-LDC SECTION.
       INI-VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-AKY-LDC.
           EXIT.
       
       VAL-NUM-FLD-LDC SECTION.
       INI-VAL-NUM-FLD-LDC.
       FIN-VAL-NUM-FLD-LDC.
           EXIT.
      *<<<< EOF_BU OR ( EOF AND PGM_VMS )
       OBT-PVIG SECTION.
       INI-OBT-PVIG.
           MOVE CLF-NUM-DAPE IN CLF     TO FEC-DEC1.
           MOVE CLF-NUM-MAPE IN CLF     TO FEC-MEC1.
           MOVE CLF-NUM-SAPE IN CLF     TO FEC-SEC1.
           MOVE CLF-NUM-AAPE IN CLF     TO FEC-AEC1.
           MOVE LDC-FEC-FVEN IN LDC-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
              MOVE FEC-NDIA TO WSS-NDIA IN WSS-VARI
              MOVE WSS-NDIA IN WSS-VARI TO LDC-NUM-PVIG IN LDC-FLD
              MOVE 'D'                  TO LDC-IND-PVIG IN LDC-FLD 
              MOVE 'DEU' TO MSC-COD-SIST
              MOVE 'IPER' TO MSC-COD-TMSC IN MSC
              MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-ABRV IN MSC TO FRM-GLS-PVIG IN LDC-FLD
           ELSE
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FEC-MENS     TO FRM-MENS.
       FIN-OBT-PVIG.
           EXIT.

       OBT-FVEN SECTION.
       INI-OBT-FVEN.
           MOVE CLF-NUM-DAPE IN CLF     TO FEC-ITM1.                
           MOVE CLF-NUM-MAPE IN CLF     TO FEC-ITM2.                
           MOVE CLF-NUM-SAPE IN CLF     TO FEC-ITM3.                
           MOVE CLF-NUM-AAPE IN CLF     TO FEC-ITM4.                
           IF LDC-IND-PVIG IN LDC-FLD = 'D'                         
              MOVE FEC-SUM-DIA  TO FEC-CMND                         
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA              
           ELSE                                                     
           IF LDC-IND-PVIG IN LDC-FLD = 'M'                         
              MOVE FEC-SUM-MES TO FEC-CMND                          
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES              
           ELSE                                                     
           IF LDC-IND-PVIG IN LDC-FLD = 'A'                         
              MOVE FEC-SUM-ANO TO FEC-CMND                          
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.             
           MOVE FEC-FORM-FEC TO FEC-FORM.                           
           PERFORM CAL-FEC.                                         
           MOVE FEC-ITM1     TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SVEN IN WSS-VARI.                  
           MOVE FEC-ITM4     TO WSS-NUM-AVEN IN WSS-VARI.
       FIN-OBT-FVEN.
           EXIT.

       PRO-CIC-GDG SECTION.
       INI-PRO-CIC-GDG.
           MOVE 0 TO WSS-STAT-GDG. 
           MOVE SPACES  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE 1 TO WSS-STAT-GDG 
              GO TO FIN-PRO-CIC-GDG
           ELSE
              MOVE CIC-CAI-ICIC TO GAR-NUM-SIS IN GDG
              MOVE CIC-IIC-ICIC TO GAR-COD-CRR IN GDG
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GAR-FIO-GDG
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-GDG 
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-GDG.
           EXIT.

       PRO-CIC-FIA SECTION.
       INI-PRO-CIC-FIA.
           MOVE 0 TO WSS-STAT-FIA. 
           MOVE SPACES  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE 1 TO WSS-STAT-FIA 
              GO TO FIN-PRO-CIC-FIA
           ELSE
              MOVE CIC-CAI-ICIC TO FIA-CAI-IESC IN FIA
              MOVE CIC-IIC-ICIC TO FIA-IIC-IESC IN FIA
              MOVE 1            TO FIA-NUM-IFIA IN FIA
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM DEU-FIO-FIA
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-FIA 
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-FIA.
           EXIT.

       VAL-CON-ARC SECTION.
       INI-VAL-CON-ARC.
           IF ARC-COD-TOOC IN LDC-FLD > SPACES AND
              ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD > SPACES 
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGUNIFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD 
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-ARC.
           
           IF ARC-COD-AOOC IN LDC-FLD > SPACES AND
              ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD > SPACES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGUNIFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD 
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-ARC.

           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD = ZEROES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGIICFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARC-IIC-IOPC-LEN IN LDC-FLD 
              MOVE 'S' TO FRM-UCUR
           ELSE
           IF ARC-CAI-IOPC IN LDC-FLD NOT > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT = ZEROES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGCAIFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARC-CAI-IOPC-LEN IN LDC-FLD
              MOVE 'S' TO FRM-UCUR.
       FIN-VAL-CON-ARC.
           EXIT.

       VAL-CON-ARG SECTION.
       INI-VAL-CON-ARG.
           IF ARG-COD-TOGA IN LDC-FLD = SPACES AND
              ARG-COD-AOGA IN LDC-FLD = SPACES AND
              ARG-CAI-IGAR IN LDC-FLD = SPACES AND
              ARG-IIC-IGAR IN LDC-FLD = ZEROES
              MOVE 'DEU'       TO MSG-COD-SIST
              MOVE 'ERRCONARG' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARG-COD-TOGA-LEN IN LDC-FLD 
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-ARG.

           IF ARG-COD-TOGA IN LDC-FLD > SPACES AND
              ARG-CAI-IGAR IN LDC-FLD > SPACES AND
              ARG-IIC-IGAR IN LDC-FLD > SPACES AND
              NOT ( ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA' )
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'INGUNIFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO ARG-COD-TOGA-LEN IN LDC-FLD 
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CON-ARG.

           IF ARG-COD-AOGA IN LDC-FLD > SPACES AND
              ARG-CAI-IGAR IN LDC-FLD > SPACES AND
              ARG-IIC-IGAR IN LDC-FLD > SPACES
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'INGUNIFLD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1 TO ARG-COD-AOGA-LEN IN LDC-FLD
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CON-ARG.
           
           IF ARG-CAI-IGAR IN LDC-FLD NOT > SPACES AND
              ARG-IIC-IGAR IN LDC-FLD = ZEROES
              IF ARG-COD-TOGA IN LDC-FLD > SPACES AND
                 ARG-COD-AOGA IN LDC-FLD NOT > SPACES AND
                 ARG-NUM-PORG IN LDC-FLD = ZEROES
                 MOVE 'DEU' TO MSG-COD-SIST
                 MOVE 'INGPGAFLD' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1 TO ARG-NUM-PORG-LEN IN LDC-FLD 
                 MOVE 'S' TO FRM-UCUR
              ELSE
              IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES AND
                 ARG-COD-AOGA IN LDC-FLD > SPACES AND
                 ARG-NUM-PORG IN LDC-FLD = ZEROES
                 MOVE 'DEU' TO MSG-COD-SIST
                 MOVE 'INGPGAFLD' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1 TO ARG-NUM-PORG-LEN  IN LDC-FLD
                 MOVE 'S' TO FRM-UCUR.
       FIN-VAL-CON-ARG.
           EXIT.
      *>>>>
