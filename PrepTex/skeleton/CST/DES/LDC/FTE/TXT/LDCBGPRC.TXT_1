       DATO-GAR SECTION.
       INI-DATO-GAR.
           GENERATE DL-TITGAR.

      *GDD Relacion Garantia Deudor
231193     MOVE WSS-CIC-ICLI TO GDD-CIC-ICLI IN GDD.
999999*    DISPLAY 'WSS-CIC-ICLI ' WSS-CIC-ICLI.
           MOVE SPACES TO GAR-CLV-GDD-2 IN GDD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOPGDD.
           PERFORM GAR-FIO-GDD.
           IF NOT (FIO-STAT-OKS AND GDD-CIC-ICLI IN GDD =
231193             WSS-CIC-ICLI)
               GO TO FIN-DATO-GAR.

      *GDG Datos Generales de Garantias
999999*    DISPLAY 'GAR-CLV-GDD-2 ' GAR-CLV-GDD-2 IN GDD.
           MOVE 0 TO WSS-IND-GTIA.
           MOVE GAR-CLV-GDD-2 IN GDD TO GAR-CLV-GDG-1 IN GDG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOPGDG1.
           PERFORM GAR-FIO-GDG.
999999*    DISPLAY 'GAR-CLV-GDG-1 ' GAR-CLV-GDG-1 IN GDG.
           IF NOT (FIO-STAT-OKS AND
              GAR-CLV-GDD-2 IN GDD = GAR-CLV-GDG-1 IN GDG)
261193         GO TO NEXT-GDD
261193*        GO TO GDG-05
           ELSE
261193*        IF GAR-IND-CPL IN GDG = 'S' AND
261193         IF
                   GAR-ES1 IN GDG > '04' AND GAR-ES1 IN GDG < '20'
261193*            GAR-ES1 IN GDG > '09' AND GAR-ES1 IN GDG < '20'
                   MOVE 1 TO WSS-IND-GTIA
999999*            DISPLAY 'GDG-09-20 ' GAR-CLV-GDG-1 IN GDG
                   GO TO RUTI-DOS
               ELSE
999999*            DISPLAY 'GDG-NEXT-GDG ' GAR-CLV-GDG-1 IN GDG
261193             MOVE FIO-GET-NXT TO FIO-CMND
261193             GO TO LOOPGDG1.
261193*            GO TO NEXT-GDG.

       GDG-05.
      *GDG Datos Generales de Garantias
999999*    DISPLAY 'GDG-05 ' GAR-CLV-GDG-1 IN GDG ' '
999999*                      GAR-ES1 IN GDG.
           MOVE 0 TO WSS-IND-GTIA.
           MOVE GAR-CLV-GDD-2 IN GDD TO GAR-CLV-GDG-1 IN GDG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOPGDG5.
           PERFORM GAR-FIO-GDG.
999999*    DISPLAY 'GDG-05LOOP ' GAR-CLV-GDG-1 IN GDG ' '
999999*                          GAR-ES1 IN GDG.
           IF NOT (FIO-STAT-OKS AND
               GAR-CLV-GDD-2 IN GDD = GAR-CLV-GDG-1 IN GDG)
999999*        DISPLAY 'GDG-05STAT ' GAR-CLV-GDG-1 IN GDG ' '
999999*                          GAR-CLV-GDD-2 IN GDD ' ' FIO-STAT
               GO TO NEXT-GDD
           ELSE
261193         IF GAR-ES1 IN GDG EQUAL '05'
                   MOVE 2 TO WSS-IND-GTIA
999999*            DISPLAY 'GDG-ES05 ' GAR-CLV-GDG-1 IN GDG
                   GO TO RUTI-DOS
               ELSE
999999*            DISPLAY 'GDG-NO05 ' GAR-CLV-GDG-1 IN GDG
                   GO TO NEXT-GDG.

       RUTI-DOS.
      *GVT Valores y Tasaciones
999999*    DISPLAY 'GDG-05GVT ' GAR-CLV-GDG-1 IN GDG.
           MOVE GAR-CLV-GDG-1 IN GDG TO GAR-CLV-GVT-1 IN GVT.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           IF NOT FIO-STAT-OKS
               GO TO NEXT-GDD.
201293
201293*GLE DATOS LEGALES -CONTRATO-.
231293     MOVE SPACES TO GAR-IND-PUB-PRV IN GLE   WSS-IND-PUB-PRV.
201293     MOVE GAR-CLV-GDG-1 IN GDG TO GAR-CLV-GLE-1 IN GLE.
201293     MOVE FIO-GET-KEY TO FIO-CMND.
201293     PERFORM GAR-FIO-GLE.
201293     IF NOT FIO-STAT-OKS
201293         MOVE SPACES TO WSS-IND-PUB-PRV
201293     ELSE
201293         MOVE GAR-IND-PUB-PRV IN GLE TO WSS-IND-PUB-PRV.

081193
271193*BUS-TAB BUSCA GLOSA TIPO OPERACION DE TABLA
271193*    IF GAR-TIP-OPE IN GDG > SPACES  AND
271193*       GAR-STP-OPE IN GDG > SPACES
271193*        MOVE 'TAB'               TO TAB-COD-SIST
271193*        MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
271193*        MOVE GAR-TIP-OPE IN GDG  TO WSS-GAR-TIP-OPE
271193*        MOVE GAR-STP-OPE IN GDG  TO WSS-GAR-STP-OPE
271193*        MOVE WSS-GAR-TIPSTP-OPE  TO TAB-COD-CTAB IN TAB
271193*        PERFORM BUS-TAB
271193*        MOVE TAB-GLS-DESC IN TAB TO WSS-TIP-STP-OPE
271193*    ELSE
271193*        MOVE SPACES TO WSS-TIP-STP-OPE.

261193
261193*BUS-TAB Busca Glosa Tipo Operacion de Tabla
261193     IF GAR-TIP-OPE  IN GDG > SPACES
261193        MOVE 'TAB'               TO TAB-COD-SIST
261193        MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
261193        MOVE GAR-TIP-OPE  IN GDG TO TAB-COD-CTAB IN TAB
999999*       DISPLAY 'TIO-DATO-GAR ' GAR-TIP-OPE IN GDG
261193        PERFORM BUS-TAB
261193        MOVE TAB-GLS-DCOR IN TAB TO WSS-GAR-TOGA
261193     ELSE
261193         MOVE SPACES TO WSS-GAR-TOGA.
261193
261193*BUS-TAB busca glosa de codigo en tabla
261193     IF GAR-STP-OPE  IN GDG > SPACES
261193         MOVE 'TAB' TO TAB-COD-SIST
261193         MOVE 'AUX' TO TAB-COD-TTAB IN TAB
281193         MOVE GAR-CLA-OPE  IN GDG TO TAB-COD-CTAB IN TAB
999999*        DISPLAY 'AUX-DATO-GAR ' GAR-STP-OPE IN GDG
261193         PERFORM BUS-TAB
261193         MOVE TAB-GLS-DCOR IN TAB TO WSS-GAR-COGA
261193     ELSE
261193         MOVE SPACES TO WSS-GAR-COGA.
261193
261193     MOVE WSS-GAR-TIP-STP TO WSS-TIP-STP-OPE.
261193
      *BUS-TAB busca glosa de codigo en tabla
           IF GAR-ES1 IN GDG > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GAR-ES1 IN GDG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SITG.

      *BUS-TAB busca glosa de codigo en tabla
           IF GAR-VCB IN GDG > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GAR-VCB IN GDG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
081193         MOVE TAB TO VLR
081193         MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-VCGA.

           GENERATE DL-GAR.

       NEXT-GDG.
999999*    DISPLAY 'GDG-05NEXT ' GAR-CLV-GDG-1 IN GDG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF WSS-IND-GTIA = '1'
               GO TO LOOPGDG1
           ELSE
               IF WSS-IND-GTIA = '2'
                   GO TO LOOPGDG5.

       NEXT-GDD.
999999*    DISPLAY 'GDG-05NEXT1 ' GAR-CLV-GDG-1 IN GDG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOPGDD.
       FIN-DATO-GAR.
           EXIT.

       GENERAR-CLF SECTION.
       INI-GENERAR-CLF.
271193     MOVE 1           TO IND-GAR-PROP.
271193     MOVE HIGH-VALUES TO WSS-AUX-GAR.

      *BUS-TAB busca glosa de codigo en tabla
251093     IF CLF-COD-VCCF IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
251093         MOVE CLF-COD-VCCF IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
081193         MOVE TAB TO VLR
231193         MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-VCCF  WSS-GLS-MONE
231193                                     WSS-GLS-MON1  WSS-GLS-MON2
           ELSE
231193         MOVE SPACES TO WSS-GLS-VCCF  WSS-GLS-MONE  WSS-GLS-MON1
231193                                      WSS-GLS-MON2.

           GENERATE DL-CLF.
231193     GENERATE DL-TITLDC.

      *LDC Lineas de Credito
101193     MOVE ZEROES TO WSS-NUM-RPRT  WSS-NUM-RVIT  WSS-NUM-RVAT
101193                    WSS-NUM-RPR2  WSS-NUM-RVI2  WSS-NUM-RVA2
101193                    WSS-NUM-RPR1  WSS-NUM-RVI1  WSS-NUM-RVA1.
           MOVE CLF-CIC-ICLF IN SRT TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOPLDC.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND LDC-CIC-ICLF IN LDC =
                   CLF-CIC-ICLF IN SRT)
221193         PERFORM ACUM-ANT-RIESGO
               GO TO RESUMEN-RIESGO
           ELSE
101193         IF LDC-IND-CRSG IN LDC = '1'
101193             ADD LDC-VAL-CMAX IN LDC TO WSS-NUM-RPR1
101193         ELSE
101193             IF LDC-IND-CRSG IN LDC = '2'
101193                 ADD LDC-VAL-CMAX IN LDC TO WSS-NUM-RPR2.
101193
                   GENERATE DL-LDC.

           MOVE 2 TO WSS-IND-RARC.
           MOVE 2 TO WSS-IND-RARG.

           MOVE LDC-KEY-ILDC IN LDC TO ARC-KEY-ILDC IN ARC.
           MOVE ZEROES              TO ARC-NUM-IARC IN ARC.

           MOVE LDC-KEY-ILDC IN LDC TO ARG-KEY-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
       LOOPARC.
           IF WSS-IND-RARC = 0
               GO TO LOOPARG
           ELSE
           IF WSS-IND-RARC = 1
               MOVE FIO-GET-NXT TO FIO-CMND
           ELSE
               MOVE FIO-GET-NLS TO FIO-CMND.
      *ARC Ambito Linea de Credito respecto al Credito
           PERFORM LDC-FIO-ARC.
           IF NOT (FIO-STAT-OKS AND ARC-KEY-ILDC IN ARC =
                   LDC-KEY-ILDC IN LDC)
                  MOVE 0 TO WSS-IND-RARC
                  GO TO LOOPARG.
           MOVE 1 TO WSS-IND-RARC.
251093
251093*BUS-TAB Busca Glosa Tipo Operacion de Tabla
251093     IF ARC-COD-TOOC IN ARC > SPACES
251093        MOVE 'TAB'               TO TAB-COD-SIST
251093        MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
251093        MOVE ARC-COD-TOOC IN ARC TO TAB-COD-CTAB IN TAB
251093        PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-GLO-TOOC.

      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-AOOC IN ARC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-COOC IN ARC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
271093         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-COOC
           ELSE
               MOVE SPACES TO WSS-GLS-COOC.

251093        MOVE WSS-GLS-COOC  TO WSS-GLO-COOC.
251093        MOVE WSS-TOOC-COOC TO WSS-GLS-COOC.

      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-VCOC IN ARC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-VCOC IN ARC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
081193         MOVE TAB TO VLR
081193         MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-VCOC
            ELSE
               MOVE SPACES TO WSS-GLS-VCOC.

251093     IF ARC-IIC-IOPC IN ARC NOT GREATER ZEROES
251093         MOVE SPACES TO ARC-IIC-IOPC IN ARC.
051193
061193     MOVE SPACES TO WSS-GLS-COGA.
071193     MOVE SPACES TO WSS-GLO-TOGA.

      *ARG Ambito Linea Credito respecto a Garantias
       LOOPARG.
251193     MOVE SPACES TO WSS-GLS-COGA.
           IF WSS-IND-RARG = 0
               GO TO GEN-GENERAR-CLF
           ELSE
           IF WSS-IND-RARG = 1
               MOVE FIO-GET-NXT TO FIO-CMND
           ELSE
               MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT (FIO-STAT-OKS AND ARG-KEY-ILDC IN ARG =
                   LDC-KEY-ILDC IN LDC)
                   MOVE 0 TO WSS-IND-RARG
                   GO TO GEN-GENERAR-CLF.
           MOVE 1 TO WSS-IND-RARG.
251093
251093*BUS-TAB Busca Glosa Tipo Operacion de Tabla
251093     IF ARG-COD-TOGA IN ARG > SPACES
251093        MOVE 'TAB'               TO TAB-COD-SIST
251093        MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
251093        MOVE ARG-COD-TOGA IN ARG TO TAB-COD-CTAB IN TAB
999999*       DISPLAY 'ARG-TIO ' ARG-COD-TOGA IN ARG
251093        PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-GLO-TOGA
261193     ELSE
261193         MOVE SPACES TO WSS-GLO-TOGA.

      *BUS-TAB busca glosa de codigo en tabla
           IF ARG-COD-AOGA IN ARG > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-COGA IN ARG TO TAB-COD-CTAB IN TAB
999999*        DISPLAY 'ARG-TIO ' ARG-COD-COGA IN ARG
               PERFORM BUS-TAB
271093         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-COGA
           ELSE
               MOVE SPACES TO WSS-GLS-COGA.

251093     MOVE WSS-GLS-COGA  TO WSS-GLO-COGA.
251093     MOVE WSS-TOGA-COGA TO WSS-GLS-COGA.

261093     IF ARG-IIC-IGAR IN ARG NOT GREATER ZEROES
271193         PERFORM BUSCA-TIO-AUX
271193         IF IND-HAY-GAR = 'Y'
281193             MOVE 0 TO IND-GAR-PROP   IND-GUA-GARA
281193             PERFORM GUARDA-GTIAS UNTIL IND-GUA-GARA = 777
261093             MOVE SPACES TO ARG-IIC-IGAR IN ARG
261193             GO TO GEN-GENERAR-CLF
271193         ELSE
271193             MOVE SPACES TO ARG-IIC-IGAR IN ARG
271193             GO TO GEN-GENERAR-CLF.

261193     MOVE ARG-CIC-IGAR IN ARG TO GAR-CLV-GDG-1 IN GDG
261193     MOVE FIO-GET-KEY TO FIO-CMND
261193     PERFORM GAR-FIO-GDG
261193     IF NOT FIO-STAT-OKS
261193         GO TO GEN-GENERAR-CLF.
261193
261193*BUS-TAB Busca Glosa Tipo Operacion de Tabla
261193     IF GAR-TIP-OPE  IN GDG > SPACES
261193        MOVE 'TAB'               TO TAB-COD-SIST
261193        MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
261193        MOVE GAR-TIP-OPE  IN GDG TO TAB-COD-CTAB IN TAB
261193        PERFORM BUS-TAB
261193        MOVE TAB-GLS-DCOR IN TAB TO WSS-GLO-TOGA
261193     ELSE
261193         MOVE SPACES TO WSS-GLO-TOGA.
261193
261193*BUS-TAB busca glosa de codigo en tabla
261193     IF GAR-STP-OPE  IN GDG > SPACES
261193         MOVE 'TAB' TO TAB-COD-SIST
261193         MOVE 'AUX' TO TAB-COD-TTAB IN TAB
281193         MOVE GAR-CLA-OPE  IN GDG TO TAB-COD-CTAB IN TAB
261193         PERFORM BUS-TAB
261193         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-COGA
261193     ELSE
261193         MOVE SPACES TO WSS-GLS-COGA.
261193
261193     MOVE WSS-GLS-COGA  TO WSS-GLO-COGA.
261193     MOVE WSS-TOGA-COGA TO WSS-GLS-COGA.
261193
271193     MOVE GAR-CLV-GDG-1 IN GDG TO AUX-COD-GAR.
281193     MOVE 0 TO IND-GAR-PROP   IND-GUA-GARA.
281193     PERFORM GUARDA-GTIAS UNTIL IND-GUA-GARA = 777.
999999*    DISPLAY 'GAR. ESPEC. ' AUX-COD-GAR.
271193
271193
       GEN-GENERAR-CLF.
           IF WSS-IND-RARC = 0 AND WSS-IND-RARG = 1
               PERFORM LIMPIAR-ARC.
           IF WSS-IND-RARG = 0 AND WSS-IND-RARC = 1
               PERFORM LIMPIAR-ARG.
           IF WSS-IND-RARC = 1 OR WSS-IND-RARG = 1
               GENERATE DL-ARCARG
251193         MOVE SPACES TO ARG-CIC-IGAR IN ARG
261193         MOVE ZEROES TO ARG-NUM-PORG IN ARG
261193         MOVE SPACES TO LDC-IND-MGAR IN LDC
               GO TO LOOPARC.

241193     GENERATE DL-BLK.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOPLDC.

      *BUSCAR DATOS DE RESUMEN RIESGO
       RESUMEN-RIESGO.
101193     COMPUTE WSS-NUM-RVA1 = WSS-NUM-RPR1 - WSS-NUM-RVI1.
101193     COMPUTE WSS-NUM-RVA2 = WSS-NUM-RPR2 - WSS-NUM-RVI2.
101193     COMPUTE WSS-NUM-RPRT = WSS-NUM-RPR1 + WSS-NUM-RPR2.
101193     COMPUTE WSS-NUM-RVIT = WSS-NUM-RVI1 + WSS-NUM-RVI2.
101193     COMPUTE WSS-NUM-RVAT = WSS-NUM-RPRT - WSS-NUM-RVIT.

           GENERATE DL-RIE.

101193     MOVE ZEROES TO WSS-NUM-RPRT  WSS-NUM-RVIT  WSS-NUM-RVAT
101193                    WSS-NUM-RPR2  WSS-NUM-RVI2  WSS-NUM-RVA2
101193                    WSS-NUM-RPR1  WSS-NUM-RVI1  WSS-NUM-RVA1.
       FIN-GENERAR-CLF.
           EXIT.

       LIMPIAR-ARC SECTION.
       INI-LIMPIAR-ARC.
           MOVE SPACES TO WSS-GLS-VCOC  WSS-GLS-COOC.
           MOVE SPACES TO ARC-COD-TOOC  ARC-COD-AOOC  ARC-CAI-IOPC
                          ARC-IIC-IOPC  IN ARC.
           MOVE ZEROES TO ARC-NUM-IARC  IN ARC.
       FIN-LIMPIAR-ARC.
           EXIT.

       LIMPIAR-ARG SECTION.
       INI-LIMPIAR-ARG.
           MOVE SPACES TO WSS-GLS-COGA  WSS-TOGA-COGA.
           MOVE SPACES TO ARG-COD-TOGA  ARG-COD-AOGA  ARG-CAI-IGAR
                          ARG-IIC-IGAR  IN ARG.
           MOVE SPACES TO LDC-IND-MGAR  IN LDC.
           MOVE ZEROES TO ARG-NUM-IARG  ARG-NUM-PORG  IN ARG.
091193*    MOVE 'SIN GARANTIAS' TO WSS-GLS-COGA.
       FIN-LIMPIAR-ARG.
           EXIT.

101193 ACUM-ANT-RIESGO SECTION.
101193 INI-ACUM-ANT-RIESGO.
101193     IF CLF-IIC-CREN IN SRT > ZEROES
101193         MOVE CLF-CAI-CREN IN SRT TO CLF-CAI-ICLF IN CLF
101193         MOVE CLF-IIC-CREN IN SRT TO CLF-IIC-ICLF IN CLF
101193         MOVE FIO-GET-KEY TO FIO-CMND
101193         PERFORM LDC-FIO-CLF
101193         IF NOT FIO-STAT-OKS
101193             GO TO FIN-ACUM-ANT-RIESGO
161193         ELSE
161193             NEXT SENTENCE
161193     ELSE
161193         GO TO FIN-ACUM-ANT-RIESGO.
101193     IF CLF-FEC-FCIE IN CLF NOT > ZEROES
101193         GO TO FIN-ACUM-ANT-RIESGO.
101193
999999*    DISPLAY 'ACUM-ANT-RIESGO ' CLF-CAI-ICLF IN CLF
999999*                               CLF-IIC-ICLF IN CLF.
101193
161193     MOVE CLF-CAI-ICLF IN CLF TO CCU-CAI-ICLF.
161193     MOVE CLF-IIC-ICLF IN CLF TO CCU-IIC-ICLF.
161193     MOVE SPACES              TO CCU-CAI-IOPC(1).
161193     MOVE ZEROES              TO CCU-IIC-IOPC(1).
161193     MOVE SPACES              TO CCU-CAI-DCAN(1).
161193     MOVE ZEROES              TO CCU-IIC-DCAN(1).
161193     MOVE ZEROES              TO CCU-NUM-DCAN(1).
161193     MOVE SPACES              TO CCU-OPE-INDS.
161193     MOVE SPACES              TO CCU-CAI-ICLI.
161193     MOVE ZEROES              TO CCU-IIC-ICLI.
171193     MOVE 99                  TO CCU-NUM-MENS.
171193     MOVE 99                  TO CCU-NUM-MEN2.
171193     MOVE SPACES              TO CCU-COD-MENS
171193                                 CCU-COD-MEN2
171193                                 CCU-COD-SIST
171193                                 CCU-MSFL.
161193     CALL 'LDCSBCCU' USING       CCU-VARI.
999999*    DISPLAY 'ACUM-ANT-RIESGO1 ' CCU-CAI-ICLF
999999*                                CCU-IIC-ICLF.
181193     IF CCU-NUM-MENS < CCU-NUM-CALC AND
181193        CCU-NUM-MENS > ZEROES
161193*    IF CCU-COD-MENS > SPACES
161193         MOVE 'DEU'           TO MSG-COD-SIST
161193         MOVE CCU-COD-MENS    TO MSG-COD-MENS
161193         PERFORM GET-MSG
999999*        DISPLAY MSG-GLS-DESC
161193         GO TO FIN-ACUM-ANT-RIESGO.
161193
999999*    DISPLAY 'PREVIO LDC ' CLF-CIC-ICLF IN CLF.
221193
101193*LDC LINEAS DE CREDITO
101193     MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
101193     MOVE ZEROES TO LDC-NUM-ILDC IN LDC.
101193     MOVE FIO-GET-NLS TO FIO-CMND.
101193 LOOPANT.
101193     PERFORM LDC-FIO-LDC.
101193     IF NOT (FIO-STAT-OKS AND LDC-CIC-ICLF IN LDC =
221193             CLF-CIC-ICLF IN CLF)
101193         GO TO FIN-ACUM-ANT-RIESGO
101193     ELSE
101193         IF LDC-IND-CRSG IN LDC = '1'
101193             ADD LDC-VAL-CMAX IN LDC TO WSS-NUM-RVI1
101193         ELSE
101193             IF LDC-IND-CRSG IN LDC = '2'
101193                 ADD LDC-VAL-CMAX IN LDC TO WSS-NUM-RVI2.
101193
101193     MOVE FIO-GET-NXT TO FIO-CMND.
101193     GO TO LOOPANT.
101193 FIN-ACUM-ANT-RIESGO.
101193     EXIT.
271193
271193 BUSCA-TIO-AUX SECTION.
271193 INI-BUSCA-TIO-AUX.
271193*GDD Relacion Garantia Deudor
271193     MOVE 'N'          TO IND-HAY-GAR.
271193     MOVE WSS-CIC-ICLI TO GDD-CIC-ICLI IN GDD.
999999*    DISPLAY 'XSS-CIC-ICLI ' WSS-CIC-ICLI.
271193     MOVE SPACES TO GAR-CLV-GDD-2 IN GDD.
271193     MOVE FIO-GET-NLS TO FIO-CMND.
271193 LOOPGDDX.
271193     PERFORM GAR-FIO-GDD.
271193     IF NOT (FIO-STAT-OKS AND GDD-CIC-ICLI IN GDD =
271193             WSS-CIC-ICLI)
271193         GO TO FIN-BUSCA-TIO-AUX.
271193
271193*GDG Datos Generales de Garantias
999999*    DISPLAY 'XAR-CLV-GDD-2 ' GAR-CLV-GDD-2 IN GDD.
271193     MOVE GAR-CLV-GDD-2 IN GDD TO GAR-CLV-GDG-1 IN GDG.
271193     MOVE FIO-GET-NLS TO FIO-CMND.
271193 LOOPGDGX.
271193     PERFORM GAR-FIO-GDG.
999999*    DISPLAY 'XAR-CLV-GDG-1 ' GAR-CLV-GDG-1 IN GDG.
271193     IF NOT (FIO-STAT-OKS AND
271193        GAR-CLV-GDD-2 IN GDD = GAR-CLV-GDG-1 IN GDG)
271193         MOVE FIO-GET-NXT TO FIO-CMND
271193         GO TO LOOPGDDX
271193     ELSE
271193         IF (ARG-COD-TOGA IN ARG = GAR-TIP-OPE IN GDG) AND
271193            (ARG-COD-AOGA IN ARG = GAR-STP-OPE IN GDG)
999999*            DISPLAY 'XDG-09-20 ' GAR-CLV-GDG-1 IN GDG
271193             MOVE GAR-CLV-GDG-1 IN GDG TO AUX-COD-GAR
271193             MOVE 'Y'                  TO IND-HAY-GAR
271193             GO TO FIN-BUSCA-TIO-AUX
271193         ELSE
999999*            DISPLAY 'XDG-NEXT-GDG ' GAR-CLV-GDG-1 IN GDG
271193             MOVE FIO-GET-NXT TO FIO-CMND
271193             GO TO LOOPGDDX.
271193 FIN-BUSCA-TIO-AUX.
271193     EXIT.
271193
271193*GUARDA-GTIAS SECTION.
271193*INI-GUARDA-GTIAS.
271193*    MOVE AUX-COD-GAR TO GAR-PROP (IND-GAR-PROP).
271193*    ADD 1            TO IND-GAR-PROP.
271193*    DISPLAY 'GUARDA-GTIAS ' AUX-COD-GAR.
271193*    DISPLAY 'GUARDA-GTIAS ' IND-GAR-PROP.
271193*FIN-GUARDA-GTIAS.
271193*    EXIT.
281193
281193 GUARDA-GTIAS SECTION.
281193 INI-GUARDA-GTIAS.
281193     ADD 1            TO IND-GAR-PROP.
281193     IF AUX-COD-GAR = GAR-PROP (IND-GAR-PROP)
281193         MOVE 777 TO IND-GUA-GARA
281193     ELSE
281193         IF GAR-PROP (IND-GAR-PROP) = HIGH-VALUE
281193             MOVE AUX-COD-GAR TO GAR-PROP (IND-GAR-PROP)
281193             MOVE 777 TO IND-GUA-GARA.
999999*    DISPLAY 'GUARDA-GTIAS ' AUX-COD-GAR.
999999*    DISPLAY 'GUARDA-GTIAS ' IND-GAR-PROP ' ' IND-GUA-GARA.
281193 FIN-GUARDA-GTIAS.
281193     EXIT.
281193
271193
271193
       GENERAR-CLC SECTION.
       INI-GENERAR-CLC.
091193     PERFORM CLR-VEC-CLF.
231193
221193     GENERATE DL-TITSIT.

999999*    DISPLAY 'GENERAR-CLC ' CLF-CAI-CREN IN SRT
999999*                           CLF-IIC-CREN IN SRT.

           IF CLF-IIC-CREN IN SRT > ZEROES
151193         MOVE CLF-CAI-CREN IN SRT TO CLF-CAI-ICLF IN CLF
151193         MOVE CLF-IIC-CREN IN SRT TO CLF-IIC-ICLF IN CLF
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF
               IF NOT FIO-STAT-OKS
271093             PERFORM CLR-VEC-CLF
                   GO TO FIN-GENERAR-CLC
161193         ELSE
161193             NEXT SENTENCE
161193     ELSE
161193         GO TO FIN-GENERAR-CLC.

           IF CLF-FEC-FCIE IN CLF NOT > ZEROES
271093         PERFORM CLR-VEC-CLF
               GO TO FIN-GENERAR-CLC.

999999*    DISPLAY 'GENERAR-CLC1 ' CLF-FEC-FCIE IN CLF.

      *DIF-FEC obtiene la diferencia en dias entre dos fechas
           MOVE CLF-NUM-DCIE IN CLF TO FEC-DEC1.
           MOVE CLF-NUM-MCIE IN CLF TO FEC-MEC1.
           MOVE CLF-NUM-SCIE IN CLF TO FEC-SEC1.
           MOVE CLF-NUM-ACIE IN CLF TO FEC-AEC1.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FEC-DEC2.
           MOVE HOY-MHOY TO FEC-MEC2.
           MOVE HOY-SHOY TO FEC-SEC2.
           MOVE HOY-AHOY TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
999999*    DISPLAY 'GENERAR-CLC1A ' FEC-DEC1 ' ' FEC-MEC1 ' '
999999*                             FEC-SEC1 ' ' FEC-AEC1.
999999*    DISPLAY 'GENERAR-CLC1A ' FEC-DEC2 ' ' FEC-MEC2 ' '
999999*                             FEC-SEC2 ' ' FEC-AEC2.
           PERFORM CAL-FEC.
           IF FEC-NDIA > 90
999999*        DISPLAY 'GENERAR-CLC2 ' FEC-NDIA
999999*        DISPLAY 'GENERAR-CLC2A ' FEC-DEC1 ' ' FEC-MEC1 ' '
999999*                                 FEC-SEC1 ' ' FEC-AEC1
999999*        DISPLAY 'GENERAR-CLC2A ' FEC-DEC2 ' ' FEC-MEC2 ' '
999999*                                 FEC-SEC2 ' ' FEC-AEC2
               GO TO FIN-GENERAR-CLC.

999999*    DISPLAY 'GENERAR-CLC3 ' FEC-NDIA.

      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN CLF > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN CLF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
081193         MOVE TAB TO VLR
081193         MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-VCCE
                                           WSS-GLS-AVCE
231193                                     WSS-GLS-AVC1
           ELSE
               MOVE SPACES TO WSS-GLS-VCCE   WSS-GLS-AVCE
231193                                       WSS-GLS-AVC1.

231093*    PERFORM SALTO-PAGINA.


           PERFORM OBT-DAT-TS.
       FIN-GENERAR-CLC.
           EXIT.

       OBT-DAT-TS SECTION.
       INI-OBT-DAT-TS.
           PERFORM CLR-VEC-TS.
999999*    DISPLAY 'OBT-DAT-TS ' CLF-CAI-ICLF IN CLF
999999*                          CLF-IIC-ICLF IN CLF.
161193     MOVE CLF-CAI-ICLF IN CLF TO CCU-CAI-ICLF.
161193     MOVE CLF-IIC-ICLF IN CLF TO CCU-IIC-ICLF.
161193     MOVE SPACES              TO CCU-CAI-IOPC(1).
161193     MOVE ZEROES              TO CCU-IIC-IOPC(1).
161193     MOVE SPACES              TO CCU-CAI-DCAN(1).
161193     MOVE ZEROES              TO CCU-IIC-DCAN(1).
161193     MOVE ZEROES              TO CCU-NUM-DCAN(1).
161193     MOVE SPACES              TO CCU-OPE-INDS.
161193     MOVE SPACES              TO CCU-CAI-ICLI.
161193     MOVE ZEROES              TO CCU-IIC-ICLI.
171193     MOVE 99                  TO CCU-NUM-MENS.
171193     MOVE 99                  TO CCU-NUM-MEN2.
171193     MOVE SPACES              TO CCU-COD-MENS
171193                                 CCU-COD-MEN2
171193                                 CCU-COD-SIST
171193                                 CCU-MSFL.
161193     CALL 'LDCSBCCU' USING       CCU-VARI.
999999*    DISPLAY 'OBT-DAT-TS1 ' CCU-CAI-ICLF ' ' CCU-NUM-MENS ' '
999999*                           CCU-IIC-ICLF.
181193     IF CCU-NUM-MENS < CCU-NUM-CALC AND
181193        CCU-NUM-MENS > ZEROES
161193*    IF CCU-COD-MENS > SPACES
999999*        DISPLAY 'CCU-COD-MENS ' CCU-COD-MENS
161193         MOVE 'DEU'           TO MSG-COD-SIST
161193         MOVE CCU-COD-MENS    TO MSG-COD-MENS
161193         PERFORM GET-MSG
161193         DISPLAY MSG-GLS-DESC
161193         GO TO FIN-OBT-DAT-TS.
999999*    DISPLAY 'PREVIO LDC ' CLF-CIC-ICLF IN CLF.

221193     GENERATE DL-SIT0.
191193
           MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES              TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-LDC.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = LDC-CIC-ICLF IN LDC)
               GO TO FIN-OBT-DAT-TS.
           PERFORM MOV-DAT-LDC.
           MOVE LDC-KEY-ILDC IN LDC TO ARC-KEY-ILDC IN ARC.
           MOVE ZEROES              TO ARC-NUM-IARC IN ARC.
      *FLB 15/DIC/92 TRASLADADAS AQUI
           MOVE LDC-KEY-ILDC IN LDC TO ARG-KEY-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
      *FLB
           MOVE CLF-PRM-VEZ-ARC TO CLF-VEZ-ARC.
           MOVE CLF-PRM-VEZ-ARG TO CLF-VEZ-ARG.
           MOVE 'S' TO CLC-EXI-ARC IN CLC-VARI.
           MOVE 'S' TO CLC-EXI-ARG IN CLC-VARI.
      *JSS-INI 8-OCT-1993
           MOVE 'N' TO WSS-IND-ACAG.
      *JSS-FIN
       LUP-ARC-ARG.
           IF CLC-EXI-ARC = 'N'
               GO TO CHK-EXI-ARG.
           IF CLF-VEZ-ARC = CLF-PRM-VEZ-ARC
               MOVE FIO-GET-NLS TO FIO-CMND
               MOVE CLF-OTR-VEZ-ARC TO CLF-VEZ-ARC
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'S' TO CLC-EXI-ARC IN CLC-VARI.
           PERFORM LDC-FIO-ARC.
           IF NOT (FIO-STAT-OKS AND
              LDC-KEY-ILDC IN LDC = ARC-KEY-ILDC IN ARC )
               MOVE 'N' TO CLC-EXI-ARC IN CLC-VARI
           ELSE
               MOVE 'S' TO WSS-IND-ACAG.
      *JSS-FIN
       CHK-EXI-ARG.
           IF CLC-EXI-ARG = 'N'
               GO TO CHK-EXI-ARC-ARG.
           IF CLF-VEZ-ARG = CLF-PRM-VEZ-ARG
               MOVE FIO-GET-NLS TO FIO-CMND
               MOVE CLF-OTR-VEZ-ARG TO CLF-VEZ-ARG
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'S' TO CLC-EXI-ARG IN CLC-VARI.
           PERFORM LDC-FIO-ARG.
           IF NOT (FIO-STAT-OKS AND
              LDC-KEY-ILDC IN LDC = ARG-KEY-ILDC IN ARG )
               MOVE 'N' TO CLC-EXI-ARG IN CLC-VARI
           ELSE
               MOVE 'S' TO WSS-IND-ACAG.
      *JSS-FIN
       CHK-EXI-ARC-ARG.
           IF CLC-EXI-ARG = 'N' AND
              CLC-EXI-ARC = 'N'

      *JSS-INI 8-OCT-1993 INDICA QUE NO EXISTE NI ARC NI ARG PARA LDC
191193*OJO    IF WSS-IND-ACAG = 'N'
                  GENERATE DL-SIT
                  PERFORM CLR-VEC-TS
261093            PERFORM CLR-VEC-CLF
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-LEE-LDC.
           PERFORM MOV-ARC-ARG.
           GO TO LUP-ARC-ARG.
       FIN-OBT-DAT-TS.
           EXIT.

       MOV-DAT-LDC SECTION.
       INI-MOV-DAT-LDC.
           MOVE LDC-NUM-ILDC IN LDC TO WSS-NUM-ILDC.
           MOVE LDC-IND-VIGE IN LDC TO WSS-IND-VIGE.
           MOVE SPACES              TO WSS-COD-TOOC.
           MOVE SPACES              TO WSS-COD-AOOC.
           MOVE SPACES              TO WSS-COD-TOGA.
           MOVE SPACES              TO WSS-COD-AOGA.
           MOVE ZEROES              TO WSS-NUM-PORG.
           MOVE LDC-IND-MGAR IN LDC TO WSS-IND-MGAR.
           MOVE SPACES              TO WSS-COD-SGAR.

           IF LDC-FEC-FVEN IN LDC NOT > ZEROES
              MOVE CLF-NUM-DVEN IN CLF TO CLC-DVEN
              MOVE CLF-NUM-MVEN IN CLF TO CLC-MVEN
              MOVE CLF-NUM-SVEN IN CLF TO CLC-SVEN
              MOVE CLF-NUM-AVEN IN CLF TO CLC-AVEN
              MOVE CLC-FVEN            TO WSS-FEC-FVEN
           ELSE
              MOVE LDC-NUM-DVEN IN LDC TO CLC-DVEN
              MOVE LDC-NUM-MVEN IN LDC TO CLC-MVEN
              MOVE LDC-NUM-SVEN IN LDC TO CLC-SVEN
              MOVE LDC-NUM-AVEN IN LDC TO CLC-AVEN
              MOVE CLC-FVEN            TO WSS-FEC-FVEN.

999999*    DISPLAY 'MOV-DAT-LDC ' WSS-VAL-CMLC ' ' WSS-VAL-UDLC.

           MOVE CTOT-LCR IN CCU-VARI(LDC-NUM-ILDC IN LDC) TO
                         WSS-VAL-CMLC.
           SUBTRACT CDIS-LCR IN CCU-VARI(LDC-NUM-ILDC IN LDC) FROM
                    CTOT-LCR IN CCU-VARI(LDC-NUM-ILDC IN LDC)
                    GIVING WSS-VAL-UDLC.
           PERFORM CONTRAVALOR.
231193*    IF WSS-VAL-CMLC > 0
231193*        MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-AVC1
231193*    ELSE
231193*        MOVE SPACES              TO WSS-GLS-AVC1.
241193
241193*BUS-TAB busca glosa de codigo en tabla
241193     IF CLF-COD-VCCF IN CLF > SPACES
241193         MOVE 'TAB' TO TAB-COD-SIST
241193         MOVE 'VLR' TO TAB-COD-TTAB IN TAB
241193         MOVE CLF-COD-VCCF IN CLF TO TAB-COD-CTAB IN TAB
241193         PERFORM BUS-TAB
241193         MOVE TAB TO VLR
241193         MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-AVC1
241193     ELSE
241193         MOVE SPACES TO WSS-GLS-AVC1.
       FIN-MOV-DAT-LDC.
           EXIT.

       MOV-ARC-ARG SECTION.
       INI-MOV-ARC-ARG.
           IF CLC-EXI-ARC = 'N'
               MOVE SPACES              TO WSS-COD-TOOC
               MOVE SPACES              TO WSS-COD-AOOC
               MOVE SPACES              TO WSS-GLS-VCLC
241193         MOVE SPACES              TO WSS-GLS-AVC1
           ELSE
               PERFORM PUT-TAB-ARC.

           IF CLC-EXI-ARG = 'N'
               MOVE SPACES              TO WSS-COD-TOGA
               MOVE SPACES              TO WSS-COD-AOGA
               MOVE ZEROES              TO WSS-NUM-PORG
               MOVE SPACES              TO WSS-COD-SGAR
241193         MOVE SPACES              TO WSS-GLS-AVC1
           ELSE
               PERFORM PUT-TAB-ARG.

           GENERATE DL-SIT.

           PERFORM CLR-VEC-TS.
261093     PERFORM CLR-VEC-CLF.
       FIN-MOV-ARC-ARG.
           EXIT.

       PUT-TAB-ARC SECTION.
       INI-PUT-TAB-ARC.
           IF ARC-IIC-IOPC IN ARC > ZEROES
               MOVE ARC-CAI-IOPC IN ARC TO WSS-COD-TOOC
               MOVE ARC-IIC-IOPC IN ARC TO WSS-COD-AOOC
               GO TO FIN-PUT-TAB-ARC.

      *BUS-TAB Busca Glosa Moneda de Tabla
           IF ARC-COD-VCOC IN ARC > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'VLR' TO TAB-COD-TTAB IN TAB
              MOVE ARC-COD-VCOC IN ARC TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
081193        MOVE TAB TO VLR
081193        MOVE VLR-GLS-ABRV IN VLR TO WSS-GLS-VCLC.

      *BUS-TAB Busca Glosa Tipo Operacion de Tabla
           IF ARC-COD-TOOC IN ARC > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
              MOVE ARC-COD-TOOC IN ARC TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-TOOC.

      *BUS-TAB Busca Glosa Cod. Auxiliar de Tabla
           IF ARC-COD-AOOC IN ARC > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE ARC-COD-COOC IN ARC TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-AOOC.
       FIN-PUT-TAB-ARC.
           EXIT.

       PUT-TAB-ARG SECTION.
       INI-PUT-TAB-ARG.
           IF ARG-IIC-IGAR IN ARG > ZEROES
               MOVE ARG-CAI-IGAR IN ARG TO WSS-COD-TOGA
               MOVE ARG-IIC-IGAR IN ARG TO WSS-COD-AOGA
               MOVE ARG-NUM-PORG IN ARG TO WSS-NUM-PORG
               MOVE ARG-CIC-IGAR IN ARG TO GAR-CLV-GDG-1 IN GDG
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GDG
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO WSS-COD-SGAR
               ELSE
                   IF GAR-IND-CPL IN GDG = 'S' AND
                     (GAR-ES1 IN GDG > '09' AND
                      GAR-ES1 IN GDG < '20')
                       MOVE 'C' TO WSS-COD-SGAR
                   ELSE
                       IF GAR-ES1 IN GDG > '19'
                           MOVE 'L' TO WSS-COD-SGAR
                       ELSE
                           MOVE 'P' TO WSS-COD-SGAR.

           IF ARG-IIC-IGAR IN ARG > ZEROES
               GO TO FIN-PUT-TAB-ARG.

           MOVE ARG-NUM-PORG IN ARG TO WSS-NUM-PORG.

      *BUS-TAB Busca Glosa Moneda de Tabla
           IF ARG-COD-TOGA IN ARG > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
              MOVE ARG-COD-TOGA IN ARG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-TOGA.

      *BUS-TAB Busca Glosa Cod. Auxiliar de Tabla
           IF ARG-COD-AOGA IN ARG > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE ARG-COD-COGA IN ARG TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
271093        MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-AOGA.
           MOVE SPACES TO WSS-COD-SGAR.
       FIN-PUT-TAB-ARG.
           EXIT.


       CLR-VEC-TS SECTION.
       INI-CLR-VEC-TS.
           MOVE SPACES              TO WSS-NUM-ILDC.
           MOVE SPACES              TO WSS-IND-VIGE.
           MOVE SPACES              TO WSS-COD-TOOC.
           MOVE SPACES              TO WSS-COD-AOOC.
           MOVE SPACES              TO WSS-COD-TOGA.
           MOVE SPACES              TO WSS-COD-AOGA.
           MOVE SPACES              TO WSS-NUM-PORG.
           MOVE SPACES              TO WSS-IND-MGAR.
           MOVE SPACES              TO WSS-COD-SGAR.
           MOVE SPACES              TO WSS-GLS-VCLC.
           MOVE SPACES              TO WSS-FEC-FVEN.
           MOVE ZEROES              TO WSS-VAL-CMLC.
           MOVE ZEROES              TO WSS-VAL-UDLC.
           MOVE ZEROES              TO WSS-VAL-EQMN.
241193     MOVE SPACES              TO WSS-GLS-AVC1.
       FIN-CLR-VEC-TS.
           EXIT.

261093 CLR-VEC-CLF SECTION.
261093 INI-CLR-VEC-CLF.
261093     MOVE ZEROS              TO CLF-VAL-CMAX IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-DVEN IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-MVEN IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-SVEN IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-AVEN IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-DURV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-MURV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-SURV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-AURV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-DPRV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-MPRV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-SPRV IN CLF.
261093     MOVE ZEROS              TO CLF-NUM-APRV IN CLF.
261093 FIN-CLR-VEC-CLF.
261093     EXIT.

       CONTRAVALOR SECTION.
       INI-CONTRAVALOR.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-VCCF IN CLF TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 0 TO WSS-VAL-EQMN
               GO TO FIN-CONTRAVALOR.
           IF TAB-CIC-CTAB IN TAB = CAM-COD-MNAC
               MOVE WSS-VAL-UDLC TO WSS-VAL-EQMN
               GO TO FIN-CONTRAVALOR.
           MOVE CLF-COD-VCCF IN CLF TO CAM-COD-VCAM IN CAM (1).
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'VLR'               TO TAB-CIC-TTAB IN TAB.
           MOVE CAM-COD-MNAC        TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'      TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 0 TO WSS-VAL-EQMN
               GO TO FIN-CONTRAVALOR.
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM (2).
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO CAM-NUM-DCAM IN CAM (1).
           MOVE HOY-MHOY TO CAM-NUM-MCAM IN CAM (1).
           MOVE HOY-SHOY TO CAM-NUM-SCAM IN CAM (1).
           MOVE HOY-AHOY TO CAM-NUM-ACAM IN CAM (1).
           MOVE CAM-FEC-FCAM IN CAM (1) TO CAM-FEC-FCAM (2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF FIO-STAT-OKS
               MULTIPLY WSS-VAL-UDLC BY CAM-SGV-VCAM IN CAM
                   GIVING WSS-VAL-EQMN
           ELSE
               MOVE 0 TO WSS-VAL-EQMN.
       FIN-CONTRAVALOR.
           EXIT.


       GENERAR-CMT SECTION.
       INI-GENERAR-CMT.
221093*    PERFORM SALTO-PAGINA.

231093     GENERATE DL-TITCMT.

221093     MOVE 'N' TO WSS-PRI-CMT.

           MOVE 'LDC'            TO RCE-COD-SIST IN RCE.
           MOVE 'CEM'            TO RCE-COD-ENTI IN RCE.
           MOVE CLF-CIC-ICLF IN SRT TO  RCE-GLS-IENT IN RCE.
           MOVE 'RCE-KEY-IENT'   TO FIO-AKEY.
           MOVE FIO-GET-NLS      TO FIO-CMND.
       LUP-IMPRIMIR-COMENT.
      *Recorre Entidad RCE Por LLave Alternativa
           PERFORM GNS-FIO-RCE.
           IF NOT FIO-STAT-OKS
221093         GO TO FIN-GENERAR-CMT
           ELSE
               IF RCE-COD-SIST IN RCE = 'LDC' AND
                  RCE-COD-ENTI IN RCE = 'CEM' AND
                  RCE-GLS-IENT IN RCE =  CLF-CIC-ICLF IN SRT
                   MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT
                   MOVE ZEROES              TO CMT-FEC-FCMT IN CMT
                   MOVE 0                   TO CMT-NUM-GCMT IN CMT
                   MOVE 0                   TO CMT-NUM-CCMT IN CMT
                   MOVE FIO-GET-NLS         TO FIO-CMND
                   PERFORM GNS-FIO-CMT
                   PERFORM LEE-COMENT UNTIL CMT-CIC-IENT IN CMT
                           NOT EQUAL RCE-CIC-IENT IN RCE OR
                           NOT FIO-STAT-OKS
211293*            IF CMT-COD-AUTC IN CMT > SPACES
211293*                MOVE CMT-COD-AUTC IN CMT TO USR-COD-USER IN USR
211293*                PERFORM BUS-USR
211293*                MOVE USR-GLS-DESC IN USR TO WSS-GLS-AUTC
211293*            ELSE
211293*                MOVE SPACES TO WSS-GLS-AUTC
231093         ELSE
281293             MOVE 'N' TO WSS-PRI-CMT
231093             GO TO FIN-GENERAR-CMT.
211293*    GENERATE DL-CMT-AUTC.
           MOVE 'RCE-KEY-IENT'   TO FIO-AKEY.
271193*        MOVE SPACES TO WSS-TIP-STP-OPE.
           MOVE FIO-GET-NXT      TO FIO-CMND.
281293     MOVE 'N' TO WSS-PRI-CMT.
           GO TO LUP-IMPRIMIR-COMENT.

       FIN-GENERAR-CMT.

           EXIT.

       LEE-COMENT SECTION.
      *-------------------
       INI-LEE-COMENT.

999999*    DISPLAY 'LCS-1 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                     CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-LEE-COMENT.
281293     IF WSS-PRI-CMT = 'N'
281293         MOVE CMT-FEC-FCMT IN CMT TO WSS-FEC-FCMT
281293         MOVE CMT-COD-AUTC IN CMT TO WSS-COD-AUTC
999999*        DISPLAY 'LCS-2 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                         CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC
281293         MOVE 'Y' TO WSS-PRI-CMT.

           MOVE SPACES         TO WSS-AUX-CMTR.
           IF CMT-NUM-CCMT IN CMT = 1
231193         GENERATE DL-BLK
               MOVE 'REFERENCIA: '       TO WSS-CMTR1
               MOVE CMT-GLS-REFE         TO WSS-CMTR2
               MOVE WSS-AUX-CMTR         TO WSS-GLS-CMTR
301293         MOVE CMT-NUM-DCMT IN CMT  TO WSS-NUM-DCMT
301293         MOVE CMT-NUM-MCMT IN CMT  TO WSS-NUM-MCMT
301293         MOVE CMT-NUM-SCMT IN CMT  TO WSS-NUM-SCMT
301293         MOVE CMT-NUM-ACMT IN CMT  TO WSS-NUM-ACMT
               GENERATE DL-CMT
301293         MOVE SPACES               TO WSS-NUM-DCMT
301293         MOVE SPACES               TO WSS-NUM-MCMT
301293         MOVE SPACES               TO WSS-NUM-SCMT
301293         MOVE SPACES               TO WSS-NUM-ACMT
281093         MOVE CMT-GLS-FILL IN CMT  TO WSS-GLS-CMTR
               GENERATE DL-CMT
           ELSE
301293         MOVE SPACES               TO WSS-NUM-DCMT
301293         MOVE SPACES               TO WSS-NUM-MCMT
301293         MOVE SPACES               TO WSS-NUM-SCMT
301293         MOVE SPACES               TO WSS-NUM-ACMT
               MOVE CMT-GLS-CMTR IN CMT (1) TO WSS-GLS-CMTR
               GENERATE DL-CMT
               MOVE CMT-GLS-CMTR IN CMT (2) TO WSS-GLS-CMTR
               GENERATE DL-CMT.
           MOVE FIO-GET-NXT      TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
999999*    DISPLAY 'LCS-3 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                     CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC.
271293     IF ((CMT-FEC-FCMT IN CMT NOT = WSS-FEC-FCMT)  OR
271293        (CMT-COD-AUTC IN CMT  NOT = WSS-COD-AUTC))
271293         IF WSS-COD-AUTC  > SPACES
281293             MOVE WSS-COD-AUTC TO USR-COD-USER IN USR
271293             PERFORM BUS-USR
271293             MOVE USR-GLS-DESC IN USR TO WSS-GLS-AUTC
271293             GENERATE DL-CMT-AUTC
291293             MOVE 'N'                 TO WSS-PRI-CMT
999999*        DISPLAY 'LCS-4 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                         CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC
999999*                         USR-GLS-DESC IN USR ' ' WSS-GLS-AUTC
281293             MOVE CMT-FEC-FCMT IN CMT TO WSS-FEC-FCMT
281293             MOVE CMT-COD-AUTC IN CMT TO WSS-COD-AUTC.
999999*        DISPLAY 'LCS-5 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                         CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC.
999999*    DISPLAY 'LCS-6 ' CMT-CIC-IENT IN CMT ' ' WSS-PRI-CMT ' '
999999*                     CMT-COD-AUTC IN CMT ' ' WSS-COD-AUTC.
       FIN-LEE-COMENT.
           EXIT.

       SALTO-PAGINA SECTION.
       INI-SALTO-PAGINA.
      *     IF WSS-IND-NPAG = 'S'
      *         MOVE 'N' TO WSS-IND-NPAG
      *     ELSE
      *         MOVE 'S' TO WSS-IND-NPAG.
      *     GENERATE DL-PAG.
           MOVE 90 TO LINE-COUNTER.
       FIN-SALTO-PAGINA.
           EXIT.
      *>>>>
*% END

