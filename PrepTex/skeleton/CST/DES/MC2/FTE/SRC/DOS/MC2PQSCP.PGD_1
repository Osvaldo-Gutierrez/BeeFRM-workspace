       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   MC2PQSCP.
       AUTHOR.       BEE.
       DATE-WRITTEN. 13-May-19 03:42 PM.

      * NOMBRE PROGRAMA                   MC2PQSCP
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      MC2SGS
      * PANTALLA                          MC2SCP
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-MC2PQSCP-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$MC2PQSCP$ SKL=$19.04.15$ VSN=$06.01.03.1$        
      -    'GEN=$13-May-19 03:42 PM$ FNC=$MC2-PRECIOS$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *ISP DEBE QUEDAR PRIMERO QUE EL OTRO LABEL FIN_SCR_VARI 
           03  SCR-CIC-DIND.
               05  SCR-CAI-DIND                     PIC X(04).          
               05  SCR-IIC-DIND                     PIC X(08).          
           03  SCR-IND-SMDS                         PIC X(01).          
       COPY COLWGENG.
      *<<<<< FIN_SCR_VARI DESDE GNSSRC:PFSCONQUE
           03  SCR-NUM-PANT                         PIC 9(03).
           03  SCR-TOT-OCCU    VALUE 0              PIC 9(03).
      *>>>>> FIN_SCR_VARI DESDE GNSSRC:PFSCONQUE
      *     03 SCR-NUM-PANT               PIC 9(02).
           03 SCR-SCP-FLD                PIC X(1080).
      *PVG INI 15-MAY-2012
           03 SCR-COD-TCNL                         PIC X(03).
           03 SCR-COD-CNAL                         PIC X(03).
      *PVG FIN 15-MAY-2012
      *PVG INI 04-FEB-2015
           03 SCR-IND-OBEX                         PIC X(01).
      *PVG FIN 04-FEB-2015
       COPY MC2WISCP.

       COPY MC2BRSGS.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SGS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.

      *<<<<< WSS DESDE GNSSRC:PFSCONQUE
       COPY MC2WXSCP.
       01  WSS-VARI-PFS-QUE.
           03 WSS-HAY-ERRO     VALUE 'N'            PIC X(01).
           03 WSS-FRM-FFLD     VALUE SPACES         PIC X(01).
           03 WSS-MAX-PANT     VALUE 10 PIC 9(05).
           03 WSS-IND-PANT     VALUE 1              PIC 9(05).
           03 WSS-IND-HMAS     VALUE 'N'            PIC X(01).
      *>>>>> WSS DESDE GNSSRC:PFSCONQUE
      *<<<< WSS
       77  WSS-ISCP            VALUE ZEROES         PIC 9(05).
       77  WSS-ISCP-AUX        VALUE ZEROES         PIC 9(05).

       COPY COLMXW05.
       01 WSS-VARI.
           03 WSS-N                                PIC 9(02).
           03 WSS-N-MAX         VALUE 30           PIC 9(02).
           03 WSS-I                                PIC 9(02).
           03 WSS-IMAX          VALUE 50           PIC 9(02).
           03 WSS-S                                PIC 9(02).
           03 WSS-NUM-NMES      VALUE ZEROES       PIC 9(06).
           03 WSS-NUM-NDIA      VALUE ZEROES       PIC 9(06).
           03 WSS-VAL-MNTO      VALUE ZEROES       PIC 9(13).
           03 WSS-COD-MONE      VALUE SPACES       PIC X(06).
           03 WSS-NUM-IROC      VALUE ZEROES       PIC 9(03).
           03 WSS-COD-TCAR      VALUE SPACES       PIC X(03).
           03 WSS-FEC-FPVT.
               05 WSS-NUM-SPVT                     PIC 9(02).
               05 WSS-NUM-APVT                     PIC 9(02).
               05 WSS-NUM-MPVT                     PIC 9(02).
               05 WSS-NUM-DPVT                     PIC 9(02).
           03 WSS-SGV-FACT-SCP.
               05 WSS-SGV-FACT-ALF                 PIC X(03).
               05 WSS-SGV-FACT      REDEFINES
                  WSS-SGV-FACT-ALF                 PIC 9(03).
           03 WSS-COD-COMP.
               05 WSS-COD-COMP-1                   PIC X(01).
               05 WSS-COD-COMP-2                   PIC X(01).
               05 WSS-COD-COMP-3                    PIC X(01).
      *PVG INI 22-MAY-2012
           03 WSS-IND-PKTT VALUE 'N'                PIC X(01).
      *PVG FIN 22-MAY-2012
      *PVG INI 21-OCT-2013
           03  WSS-GLS-HKEY.
               05  WSS-IND-NUM-ICAN                 PIC X(01).
               05  WSS-IND-NUM-IVCT                 PIC X(01).
               05  WSS-IND-COD-CLAS                 PIC X(01).
               05  WSS-IND-COD-COMP                 PIC X(01).
               05  WSS-IND-SGV-FACT                 PIC X(01).
               05  WSS-IND-CIC-ICVN                 PIC X(01).
               05  WSS-IND-IDC-ICLI                 PIC X(01).
               05  WSS-IND-VAL-TINF                 PIC X(01).
      *PVG FIN 21-OCT-2013
      *MHM-INI 16-OCT-2017
           03 WSS-IND-CCMP    VALUE SPACES          PIC X(01).
      *MHM-FIN 16-OCT-2017
      *PVG INI 23-MAY-2014
           03  WSS-IT         VALUE ZEROES          PIC 9(02).
           03  WSS-P                                PIC 9(01).
           03  WSS-PMAX       VALUE 5               PIC 9(01).
           03  WSS-IND-PVEZ   VALUE 'S'             PIC X(01).
           03  WSS-BKP-CPTO                         PIC X(03).
           03  WSS-IND-ETRF   VALUE 'N'             PIC X(01).
           03  WSS-IND-EINT   VALUE 'N'             PIC X(01).
           03  WSS-COD-EINT   VALUE 'INT'           PIC X(03).
           03  WSS-GLS-PALL.
               05  WSS-IND-PALL VALUE 'N'           PIC X(01).
               05  WSS-GLS-DAT3.
                   07  WSS-COD-DAT3  OCCURS 10      PIC X(03).
           03  WSS-COD-COFI     VALUE '010'         PIC X(03).
           03  WSS-KEY-RROC.
               05  WSS-GLS-ROC1                     PIC X(03).
               05  WSS-GLS-ROC2                     PIC X(03).
               05  WSS-GLS-ROC3                     PIC X(03).
               05  WSS-GLS-ROC4                     PIC X(03).
               05  WSS-FIL-RROC                     PIC X(04).
           03  WSS-IROC                             PIC 9(02).
           03  WSS-IMAXROC  VALUE  50               PIC 9(02).
           03  WSS-VEC-RROC OCCURS 50.
               05  VEC-COD-CPTO                     PIC X(03).
               05  VEC-COD-SCPT                     PIC X(03).
      *PVG FIN 23-MAY-2014

      *PVG INI 11-FEB-2015
       COPY COLBRITR.
      *PVG FIN 11-FEB-2015
       COPY MC2BRROC.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRRDC.
       COPY COLBRVEN.
       COPY COLBRCAN.
      *PVG INI 22-MAY-2012
       COPY COLBRROV.
      *PVG FIN 22-MAY-2012
       COPY COLBREVC.
       COPY COLBRAUT.
       COPY SGCBRDBC.
       COPY COLWGUVD.
       COPY MC2WGSGS.
       COPY MC2WGQSP.
       COPY MC2WGRCC.
      *PVG INI 05-MAR-2012
       COPY TABWGCFN.
      *PVG INI 05-MAR-2012
      *PVG INI 09-JUN-2010
       COPY MC2WGCCM.                                                   
      *PVG FIN 09-JUN-2010
       COPY COLWGPMP.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *PVG INI 22-MAY-2012
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *PVG FIN 22-MAY-2012
      *PVG INI 11-FEB-2015
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
      *PVG FIN 11-FEB-2015
      *>>>>
       01 WSS-NUM-VALOR VALUE ZEROES PIC 9(03).
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
              05 PGM-STAT-CAN.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
                 07 PGM-STT1-CAN        VALUE '2' PIC X(01).
                    88 PGM-STAT-CAN-OKS VALUE '0'.
                 07 PGM-STT2-CAN        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
              05 PGM-STAT-SGS.
                 88 PGM-STAT-SGS-NUL    VALUE '  '.
                 07 PGM-STT1-SGS        VALUE '2' PIC X(01).
                    88 PGM-STAT-SGS-OKS VALUE '0'.
                 07 PGM-STT2-SGS        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
           03 PGM-CMMA.
              05 PGM-CMMA-CHR OCCURS 3000 PIC X(01).
      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 3000 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO SCP-FLD.
           MOVE LOW-VALUES TO SCP-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +3000 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'MC2PQSCP' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<<< INI_FIO DESDE GNSSRC:PFSCONQUE
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO SCP-COD-TERM
                MOVE TSK-TERM-ALF TO SCP-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO SCP-COD-TERM
                MOVE EIBTRMID     TO SCP-COD-TERM-MAS.
           IF FRM-FFLD = FRM-FFLD-PF5 AND
              SCR-INST = SCR-INST-GAB
                MOVE FRM-FFLD-PF5 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
                MOVE SCR-INST-GKY TO SCR-INST
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF6 AND
              SCR-INST = SCR-INST-GAB
                MOVE FRM-FFLD-PF6 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
                MOVE SCR-INST-GKY TO SCR-INST
           ELSE
                MOVE FRM-FFLD-RET TO WSS-FRM-FFLD.
      *>>>>> INI_FIO DESDE GNSSRC:PFSCONQUE
      *<<<< INI_FIO
      *PVG INI 21-OCT-2013
           MOVE 'N' TO WSS-IND-NUM-ICAN IN WSS-VARI.
           MOVE 'N' TO WSS-IND-NUM-IVCT IN WSS-VARI.
           MOVE 'N' TO WSS-IND-COD-CLAS IN WSS-VARI.
           MOVE 'N' TO WSS-IND-COD-COMP IN WSS-VARI.
           MOVE 'N' TO WSS-IND-SGV-FACT IN WSS-VARI.
           MOVE 'N' TO WSS-IND-CIC-ICVN IN WSS-VARI.
           MOVE 'N' TO WSS-IND-IDC-ICLI IN WSS-VARI.
           MOVE 'N' TO WSS-IND-VAL-TINF IN WSS-VARI.

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'HBLKEYMC2SCP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO CNT-INI-FIO.
           IF (TAB-COD-DAT1(1) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(1) TO WSS-IND-NUM-ICAN IN WSS-VARI.
           IF (TAB-COD-DAT1(2) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(2) TO WSS-IND-NUM-IVCT IN WSS-VARI.
           IF (TAB-COD-DAT1(3) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(3) TO WSS-IND-COD-CLAS IN WSS-VARI.
           IF (TAB-COD-DAT1(4) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(4) TO WSS-IND-COD-COMP IN WSS-VARI.
           IF (TAB-COD-DAT1(5) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(5) TO WSS-IND-SGV-FACT IN WSS-VARI.
           IF (TAB-COD-DAT1(6) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(6) TO WSS-IND-CIC-ICVN IN WSS-VARI.
           IF (TAB-COD-DAT1(7) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(7) TO WSS-IND-IDC-ICLI IN WSS-VARI.
           IF (TAB-COD-DAT1(8) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(8) TO WSS-IND-VAL-TINF IN WSS-VARI.
       CNT-INI-FIO.
      *PVG FIN 21-OCT-2013
      *PVG INI 09-JUN-2010
           MOVE 'N' TO SCR-IND-SMDS IN SCR-VARI.                        
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'SEGMULDEUSCP' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')              
               MOVE 'S' TO SCR-IND-SMDS IN SCR-VARI.                    
      *PVG FIN 09-JUN-2010
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO RCC-COD-TERM-SGS
                MOVE 'S'          TO RCC-OFRM-SRV
           ELSE
                MOVE EIBTRMID     TO RCC-COD-TERM-SGS
                MOVE 'N'          TO RCC-OFRM-SRV.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-VEC-ENG
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'FLDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
               PERFORM ING-FPEN-CIC.
       FIN-INI-FIO.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       GNS-BUS-VCA SECTION.
       INI-GNS-BUS-VCA.
           MOVE 0 TO FRM-IFLD.
       LUP-GNS-BUS-VCA.
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > EIBCALEN AND
              FRM-IFLD NOT > 3000
                MOVE DFH-CMMA(FRM-IFLD) TO PGM-CMMA-CHR(FRM-IFLD)
                GO TO LUP-GNS-BUS-VCA.
           MOVE PGM-CMMA TO SCR-VARI.
       FIN-GNS-BUS-VCA.
           EXIT.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
      *<<<<< INI_SCR_COM DESDE GNSSRC:PFSCONQUE
           PERFORM DEL-QUE-SCP.
      *>>>>> INI_SCR_COM DESDE GNSSRC:PFSCONQUE
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-SCP.
           PERFORM EDT-KEY-SCP.
           PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-SCP
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-SCP
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-SCP
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-SCP
               PERFORM EDT-KEY-SCP
           ELSE
               PERFORM CLR-FLD-SCP
               PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-SCP.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO SCP-FLD.
           MOVE LOW-VALUES TO SCP-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<<< INI_FND_KEY DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              MOVE '00' TO FIO-STAT
              GO TO FIN-FND-KEY.
           PERFORM DEL-QUE-SCP.
      *MHM-INI 16-OCT-2017
           MOVE 'N' TO WSS-IND-CCMP.
      *MHM-FIN 16-OCT-2017
      *PVG INI 23-MAY-2014
           IF WSS-IND-PALL IN WSS-VARI = 'S'
              PERFORM SCP-ANL-PALL
           ELSE
      *PVG FIN 23-MAY-2014
              PERFORM SCP-ANL-KEY.
           MOVE 1 TO SCR-NUM-PANT.
           GO TO FIN-FND-KEY.
           MOVE ZEROES TO SCR-TOT-OCCU.
      *>>>>> INI_FND_KEY DESDE GNSSRC:PFSCONQUE
           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-SGS.
           MOVE FIO-STAT TO PGM-STAT-SGS.
      *<<<< FIN_FND_KEY
      *>>>>
       FIN-FND-KEY.
           DISPLAY 'SCP*4FRM-FEC-PLAN : ' FRM-FEC-PLAN IN SCP-FLD.
           IF FIO-STAT = FIO-STAT-NEX
      *MHM-INI 16-OCT-2017
              IF FRM-COD-CPTO IN SCP-FLD = 'CCM' OR 'SGS' OR
                 WSS-IND-CCMP = 'S'
                  GO TO EXT-FND-KEY
              ELSE
      *MHM-FIN 16-OCT-2017
               MOVE 'S' TO SCR-IERR.
           GO TO EXT-FND-KEY
           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-SGS.
           MOVE FIO-STAT TO PGM-STAT-SGS.
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
      *<<<<< PUT_SCR DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              GO TO EXT-PUT-SCR.
           PERFORM SCP-PUT-SCR.
       EXT-PUT-SCR.
      *>>>>> PUT_SCR DESDE GNSSRC:PFSCONQUE
           PERFORM PUT-ALL-SCP.
      *<<<<< FIN_PUT_SCR DESDE GNSSRC:PFSCONQUE
      * AQUI MOVER LOS DATOS DE TS-SCP A PANTALLA
           MOVE SCR-TOT-OCCU TO SCP-MAS-NUM-TOCC.
           MOVE WSS-IND-HMAS TO SCP-MAS-IND-HMAS.
           IF WSS-FRM-FFLD = FRM-FFLD-RET
                 MOVE ZEROES TO QUE-NITM
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF6
                 COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT)
                 IF QUE-NITM NOT < SCR-TOT-OCCU
                     MOVE 'S' TO WSS-HAY-ERRO
                     MOVE 'MC2' TO MSG-COD-SIST
                     MOVE 'SCPPF6   NEX' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     COMPUTE QUE-NITM =
                       (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
                 ELSE
                     ADD 1 TO SCR-NUM-PANT
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5
                 COMPUTE QUE-NITM =
                    (SCR-NUM-PANT * WSS-MAX-PANT) -
                    (2 * WSS-MAX-PANT - 1)
                 IF QUE-NITM < 1
                    MOVE 'S' TO WSS-HAY-ERRO
                    MOVE 'MC2' TO MSG-COD-SIST
                    MOVE 'SCPPF5   NEX' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    COMPUTE QUE-NITM =
                     (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
                 ELSE
                    SUBTRACT 1 FROM QUE-NITM
                    SUBTRACT 1 FROM SCR-NUM-PANT.
           MOVE SCP-NOM-TSSCP TO QUE-COLA.
           MOVE SCP-LEN-TSSCP TO QUE-LITM.
       SCP-CIC-LEE-TS.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SCP-ITEM
               PERFORM SCP-MOV-TS-FRM
               GO TO SCP-CIC-LEE-TS
           ELSE
      *PVG INI 15-MAY-2012
           IF NOT SCR-OFRM-SRV
      *PVG FIN 15-MAY-2012
           IF QUE-NITM = 1
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'MC2' TO MSG-COD-SIST
               MOVE 'SCP    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>> FIN_PUT_SCR DESDE GNSSRC:PFSCONQUE
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE SCP-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO SCP-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
      *<<<<< PFS_SCR_GKEY_PREV DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
                 IF FRM-FFLD = FRM-FFLD-PF5
                     MOVE FRM-FFLD-RET TO FRM-FFLD
              ELSE
                 IF FRM-FFLD = FRM-FFLD-PF6
                     MOVE FRM-FFLD-RET TO FRM-FFLD.
      *>>>>> PFS_SCR_GKEY_PREV DESDE GNSSRC:PFSCONQUE
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-SCP
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-SCP.
      *PTC-INI:   12-NOV-1996 08:50:01
           IF SCR-OFRM-SRV
              MOVE PTC-OPC-TYPE TO QUE-TYPE
              MOVE SCP-COD-TERM TO QUE-TERM
              MOVE PTC-OPC-LENG TO QUE-LITM
              MOVE 1            TO  QUE-NITM
              MOVE QUE-GET      TO QUE-CMND
              PERFORM GNS-PRO-QUE
              IF QUE-STAT = QUE-STAT-OKS
                  MOVE QUE-ITEM TO PTC-OPC-ITEM
                  MOVE PTC-OPC-OPC-CAI-IOPC TO OPC-CAI-IOPC IN SCP-FLD
                  MOVE PTC-OPC-OPC-IIC-IOPC TO OPC-IIC-IOPC IN SCP-FLD.
      *PTC-FIN:   12-NOV-1996 08:50:01
           PERFORM VAL-IKY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-SCP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-SCP.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCP.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
      *<<<< FIN_SCR_GKEY OR FIN_SCR_GCNF OR FIN_SCR_GFLD                
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-SCP
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-SCP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-SCP.
           PERFORM VAL-IKY-SCP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-SCP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-SCP.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-SCP.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-FTER-CIC.
      *>>>>
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCP-GLS-MEN2
               MOVE SCR-PRMT     TO SCP-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO SCP-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO SCP-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCP-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCP-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-SCP

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCP-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCP-GLS-MENS.
           PERFORM PRO-MKY-SCP.
           PERFORM PRO-AKY-SCP.
           PERFORM UNP-IKY-SCP.
           PERFORM FST-KEY-SCP.
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-SCP.
      *>>>>
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE SCP-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO SCP-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO SCP-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO SCP-GLS-MENS.
           PERFORM UNP-KEY-SCP.
           PERFORM FST-KEY-SCP.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-SCP.
           PERFORM PRO-AKY-SCP.
           PERFORM UNP-MKY-SCP.
           PERFORM UNP-FLD-SCP.
           PERFORM FST-FLD-SCP.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO SCP-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-SCP.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-SCP
               PERFORM EDT-FLD-SCP
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-SCP.
           PERFORM EDT-FLD-SCP.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY MC2BQSCP.
       COPY GNSBVNUM.
       COPY MC2BFSGS.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<<< EOF DESDE GNSSRC:PFSCONQUE
       DEL-QUE-SCP SECTION.
       INI-DEL-QUE-SCP.
           MOVE SCP-NOM-TSSCP TO QUE-COLA.
      * MODIFICADO POR ISP EL  28-NOV-2006 17:24:06 PARA
      * IGUALAR CODIGO DAP-CVD
           MOVE 1 TO SCR-NUM-PANT.
           MOVE ZEROES TO SCR-TOT-OCCU.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-DEL-QUE-SCP.
           EXIT.
       SCP-MOV-TS-FRM SECTION.
       INI-SCP-MOV-TS-FRM.
           IF SCR-OFRM-SRV
               GO TO FIN-SCP-MOV-TS-FRM
           ELSE
               IF WSS-IND-PANT > WSS-MAX-PANT
                   GO TO FIN-SCP-MOV-TS-FRM.
           PERFORM SCP-MOV-TS-FRM-ELM.
      *     MOVE SCP-FLD01 TO
      *                FLD01 IN SCP-FLD(WSS-IND-PANT).
           ADD 1 TO WSS-IND-PANT.
       FIN-SCP-MOV-TS-FRM.
           EXIT.
      *>>>>> EOF DESDE GNSSRC:PFSCONQUE
      *<<<< PGM_DTC AND EOF
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
       PGM-EBR-ALL SECTION.
       INI-PGM-EBR-ALL.
           MOVE 'GNS' TO FIO-SIST.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
       FIN-PGM-EBR-ALL.
           EXIT.
      *>>>>
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.
           PERFORM HBL-IKY.
      *PTC ini
           IF SCR-OFRM-SRV
      *INI-PENTA TUXEDO ORACLE
      *     EXEC CICS RETURN END-EXEC.
       COPY GNSBHTER.
      *FIN-PENTA TUXEDO ORACLE
      *PTC fin
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE 'ING' TO SCR-CMND.
           MOVE 'ING' TO SCR-CCPP.
           MOVE 'M'   TO SCR-STPP.

           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      *PTC ini
           IF SCR-OFRM-SRV
                MOVE WSS-IDX-ISCP TO SCR-IPRO
           ELSE
                PERFORM GNS-PRO-SYS.
      *PTC fin
       FIN-EGR-FTER-CIC.
           EXIT.
       EGR-FPEN-CIC SECTION.                                            
       INI-EGR-FPEN-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           ADD 1 TO SCR-IPRO.                                           
           IF SCR-IPRO > WSS-TOT-IIDX                                   
                  PERFORM EGR-FTER-CIC                                  
                  GO TO FIN-EGR-FPEN-CIC.                               
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES             
               GO TO INI-EGR-FPEN-CIC.                                  
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *PTC ini                                                          
           IF SCR-OFRM-SRV                                              
                MOVE WSS-IDX-ISCP TO SCR-IPRO                           
           ELSE                                                         
                PERFORM GNS-PRO-SYS.                                    
      *PTC fin                                                          
       FIN-EGR-FPEN-CIC.                                                
           EXIT.                                                        
       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE SCP-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.
       PUT-TAB SECTION.                                                 
       INI-PUT-TAB.                                                   
       EXT-PUT-TAB.                                                     
           EXIT.                                                        
                                                                        
       SET-FRM-IFLD SECTION.                                            
       INI-SET-FRM-IFLD.                                                
           IF SCR-OFRM-SRV                                              
                MOVE 1 TO FRM-IFLD                                      
           ELSE                                                         
                ADD 1 TO FRM-IFLD.                                      
       FIN-SET-FRM-IFLD.                                                
           EXIT.                                                        
      * COPY LDCBKCCU.                                                  
       COPY GNSBBTAB.                                                   
      *>>>> EOF                                                         
      * DEL-QUE-SCP SECTION.
      * INI-DEL-QUE-SCP.
      *     MOVE SCP-NOM-TSSCP TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      * FIN-DEL-QUE-SCP.
      *     EXIT.
       SCP-PUT-SCR SECTION.
       INI-SCP-PUT-SCR.
       FIN-SCP-PUT-SCR.
           EXIT.
       SCP-MOD-TS SECTION.
       INI-SCP-MOD-TS.
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SCP-ITEM
               MOVE     FRM-IND-SELC IN SCP-FLD(WSS-ISCP) TO
                    SCP-FRM-IND-SELC
               MOVE     FRM-GLS-SELC IN SCP-FLD(WSS-ISCP) TO
                    SCP-FRM-GLS-SELC
      *PVG INI 09-JUN-2010                                              
               MOVE     FRM-VAL-MNTO IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-VAL-MNTO                                    
               MOVE     FRM-COD-VCOC IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-COD-VCOC                                    
      *PVG FIN 09-JUN-2010
               MOVE SCP-ITEM TO QUE-ITEM
               MOVE QUE-MOD TO QUE-CMND
               PERFORM GNS-PRO-QUE
               MOVE QUE-NITM TO WSS-ISCP-AUX
               ADD 1 TO QUE-NITM
           ELSE
               ADD 1 TO WSS-MAX-PANT GIVING WSS-ISCP.
       FIN-SCP-MOD-TS.
           EXIT.
       SCP-PROC-ITEM SECTION.
       INI-SCP-PROC-ITEM.
           COMPUTE QUE-NITM = ( SCR-NUM-PANT - 1 ) * WSS-MAX-PANT + 1.

           MOVE QUE-NITM TO WSS-ISCP.
           PERFORM SCP-MOD-TS VARYING WSS-ISCP FROM 1 BY 1
               UNTIL WSS-ISCP > WSS-MAX-PANT.
       FIN-SCP-PROC-ITEM.
           EXIT.

       SCP-ANL-KEY SECTION.
       INI-SCP-ANL-KEY.
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'OPC    NEX' TO MSG-COD-MENS                        
               GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND                       
              OPC-COD-SEGD IN OPC NOT = 'PRECIO   '                     
               MOVE 'MC2'          TO MSG-COD-SIST                      
               MOVE 'OPCPRECIONEX' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
      *PVG FIN 22-MAR-2010
      *PVG INI 04-FEB-2015
           IF OPC-COD-TOOC IN OPC = 'BEX'
              MOVE 'S' TO SCR-IND-OBEX IN SCR-VARI
           ELSE
              MOVE 'N' TO SCR-IND-OBEX IN SCR-VARI.
      *PVG FIN 04-FEB-2015
      *PVG INI 22-MAY-2012
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' AND
              OPC-IND-RENO IN OPC = 'PRO'
              PERFORM PRO-SCP-PKTT
              IF RCC-COD-MENS > SPACES
                 MOVE 'MC2'        TO MSG-COD-SIST
                 MOVE RCC-COD-MENS TO MSG-COD-MENS
                 GO TO MSG-SCP-ANL-KEY
              ELSE
                 IF WSS-IND-PKTT IN WSS-VARI = 'S'
                    GO TO KTT-SCP-ANL-KEY.
      *PVG FIN 22-MAY-2012
           MOVE OPC-CAI-IOPC IN SCP-FLD TO UVD-CAI-IOPC IN UVD.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO UVD-IIC-IOPC IN UVD.
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *    PERFORM BUS-UVD.                                             
      *    IF MSG-COD-MENS > SPACES                                     
      *        MOVE 'COL' TO MSG-COD-SIST                               
      *        GO TO MSG-SCP-ANL-KEY.                                   
           IF OPC-IND-VSTR IN OPC = 'N'
              PERFORM LEE-VEN-FMMV
           ELSE
              PERFORM BUS-UVD.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE 'COL' TO MSG-COD-SIST
              GO TO MSG-SCP-ANL-KEY.
      *PVG FIN 22-MAR-2010
      *PVG INI 25-AGO-2006                                              
           PERFORM BUS-HABIL.                                           
      *PVG FIN 25-AGO-2006                                              
           MOVE OPC-NUM-DCOL IN OPC    TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC    TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC    TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC    TO FEC-AEC1.
           MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-DEC2.
           MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-MEC2.
           MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-SEC2.
           MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'DIFDIA NOVLD' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
           MOVE FEC-NDIA TO WSS-NUM-NDIA IN WSS-VARI.                   

           MOVE OPC-CAI-IOPC IN SCP-FLD TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO AUT-IIC-IOPC IN AUT.
PNT        MOVE 'AUT'                   TO AUT-COD-EVEN IN AUT.
PNT        MOVE ZEROES                  TO AUT-NUM-ICAN IN AUT.
           MOVE 1                       TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE 'AUT' TO WSS-COD-TCAR IN WSS-VARI
           ELSE
PNT            MOVE 'PAT'  TO AUT-COD-EVEN IN AUT
PNT            MOVE ZEROES TO AUT-NUM-ICAN IN AUT
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-AUT
               IF FIO-STAT-OKS
                  MOVE 'PAT' TO WSS-COD-TCAR IN WSS-VARI
               ELSE
                  MOVE SPACES TO WSS-COD-TCAR IN WSS-VARI.

      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *    MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
      *    MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM COL-FIO-OPC.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'COL'        TO MSG-COD-SIST                        
      *        MOVE 'OPC    NEX' TO MSG-COD-MENS                        
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *                                                                 
      *    IF OPC-MSC-STAT IN OPC = 'A'                                 
      *        MOVE 'COL'          TO MSG-COD-SIST                      
      *        MOVE 'OPC    ACAYA' TO MSG-COD-MENS                      
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *                                                                 
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND                       
      *       OPC-COD-SEGD IN OPC NOT = 'PRECIO   '                     
      *        MOVE 'MC2'          TO MSG-COD-SIST                      
      *        MOVE 'OPCPRECIONEX' TO MSG-COD-MENS                      
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *PVG FIN 22-MAR-2010
      *PVG INI 09-JUN-2010                                              
           IF SCR-CIC-DIND IN SCR-VARI > SPACES                         
              MOVE FRM-NUM-ICLI IN SCP-FLD  TO DBC-NUM-ICLI IN DBC      
              MOVE FRM-VRF-ICLI IN SCP-FLD  TO DBC-VRF-ICLI IN DBC      
              MOVE FRM-IND-ICLI IN SCP-FLD  TO DBC-IND-ICLI IN DBC      
              MOVE FRM-GLS-ICLI IN SCP-FLD  TO DBC-GLS-ICLI IN DBC      
              GO TO CNT-SCP-ANL-KEY.                                    
      *PVG FIN 09-JUN-2010

           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.

           MOVE RDC-CAI-ICLI IN RDC TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI IN RDC TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'DBC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.

      *PVC-INI 20-MAY-2009                                              
       CNT-SCP-ANL-KEY.
      *PVG INI 04-FEB-2015
           IF (FRM-COD-CLAS IN SCP-FLD = 'ROC' AND
              (FRM-COD-CPTO IN SCP-FLD = 'SGS' OR 'CGN'))
              PERFORM PRO-LEC-RROC.
      *PVG FIN 04-FEB-2015
      *PVC-FIN 20-MAY-2009                                              
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *       PERFORM OBT-FEC-PVTO.
           IF OPC-IND-VSTR IN OPC = 'S'
              PERFORM OBT-FEC-PVTO
      *PVG FIN 22-MAR-2010
              IF MSG-COD-MENS > SPACES                                     
                 MOVE 'COL' TO MSG-COD-SIST                               
                 GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           MOVE OPC-CAI-IOPC IN SCP-FLD  TO RCC-CAI-IOPE IN RCC-VARI.
           MOVE OPC-IIC-IOPC IN SCP-FLD  TO RCC-IIC-IOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-EXT-IOPE IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'                           
              MOVE OPC-COD-RMOC IN OPC   TO RCC-CIC-IOPE IN RCC-VARI    
              MOVE 'EJC '                TO RCC-EXT-IOPE IN RCC-VARI.   
           MOVE DBC-NUM-ICLI IN DBC      TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE DBC-VRF-ICLI IN DBC      TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE DBC-IND-ICLI IN DBC      TO RCC-IND-ICLI IN RCC-VARI.
           MOVE DBC-GLS-ICLI IN DBC      TO RCC-GLS-ICLI IN RCC-VARI.
           MOVE FRM-COD-CLAS IN SCP-FLD  TO RCC-IND-RTBL IN RCC-VARI.
           MOVE FRM-COD-COMP IN SCP-FLD  TO RCC-IND-COMP IN RCC-VARI.
      *PVC-INI 20-MAY-2009                                              
           IF OPC-COD-OTRN IN OPC = SPACES
               MOVE '010'                TO RCC-COD-TCNL IN RCC-VARI
               MOVE OPC-COD-OFOC IN OPC  TO RCC-COD-CNAL IN RCC-VARI
           ELSE
               MOVE 'TAB'                TO TAB-COD-SIST FIO-SIST 
               MOVE 'CNL'                TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-OTRN IN OPC  TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-TAB
               MOVE FIO-GET-KEY TO FIO-CMND                                    
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N'
                   IF OPC-COD-OTRN IN OPC = '010' 
                       MOVE '010'        TO RCC-COD-TCNL IN RCC-VARI
                       MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI
                   ELSE
                       MOVE OPC-COD-OTRN IN OPC TO
                                            RCC-COD-TCNL IN RCC-VARI            
                       MOVE SPACES       TO RCC-COD-CNAL IN RCC-VARI            
               ELSE                                                             
                   MOVE '010'            TO RCC-COD-TCNL IN RCC-VARI            
                   MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI.        
      *PVC-FIN 20-MAY-2009                                              
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCOC IN RCC-VARI.
           MOVE OPC-COD-TOOC IN OPC      TO RCC-COD-TOOC IN RCC-VARI.
           MOVE OPC-COD-AOOC IN OPC      TO RCC-COD-AOOC IN RCC-VARI.
           MOVE OPC-VAL-CRED IN OPC      TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCMO IN RCC-VARI.
           MOVE OPC-FEC-FCOL IN OPC      TO RCC-FEC-FCOL IN RCC-VARI.   
           MOVE WSS-FEC-FPVT IN WSS-VARI TO RCC-FEC-FVEN IN RCC-VARI.   
           MOVE WSS-NUM-NDIA             TO RCC-NUM-PLZO IN RCC-VARI.   
           MOVE 'D'                      TO RCC-MSC-UTPZ IN RCC-VARI.   
           MOVE 'CUR'                    TO RCC-COD-EVEN IN RCC-VARI.   
           MOVE FRM-COD-CPTO IN SCP-FLD  TO RCC-COD-CPTO IN RCC-VARI.   
           MOVE WSS-COD-TCAR             TO RCC-COD-TCAR IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'                           
               MOVE ZEROES               TO RCC-VAL-SOPE IN RCC-VARI    
               MOVE SPACES               TO RCC-COD-VSOP IN RCC-VARI    
           ELSE                                                         
               MOVE OPC-VAL-CRED IN OPC  TO RCC-VAL-SOPE IN RCC-VARI    
               MOVE OPC-COD-VCOC IN OPC  TO RCC-COD-VSOP IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-FINA IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCFN IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-INTE IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCIN IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-VASG IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCVA IN RCC-VARI.   

      *PVG INI 09-JUN-2010                                              
           IF RCC-COD-CPTO IN RCC-VARI = 'SGS'                          
              DIVIDE 1 BY 2 GIVING RCC-VAL-INTE IN RCC-VARI             
              IF SCR-CIC-DIND IN SCR-VARI NOT > SPACES                  
                 PERFORM BUS-RDC-DIND.                                  
      *PVG FIN 09-JUN-2010
      *PVG INI 05-ENE-2012
           MOVE SPACES TO RCC-COD-ESTR IN RCC-VARI.
           MOVE SPACES TO RCC-COD-AMRT IN RCC-VARI.
           PERFORM ANL-EVC-VCFN.
           IF CFN-COD-MENS IN CFN-VARI > SPACES
              MOVE 'MC2'                    TO MSG-COD-SIST
              MOVE CFN-COD-MENS IN CFN-VARI TO MSG-COD-MENS
              MOVE CFN-EXT-MENS IN CFN-VARI TO RCC-COD-MEN2 IN RCC-VARI
              GO TO MSG-SCP-ANL-KEY.
      *PVG FIN 05-ENE-2012
      *PVG INI 15-MAY-2012
           MOVE RCC-COD-TCNL IN RCC-VARI TO SCR-COD-TCNL.
           MOVE RCC-COD-CNAL IN RCC-VARI TO SCR-COD-CNAL.
      *PVG FIN 15-MAY-2012
      *PVG INI 04-FEB-2014
           PERFORM PRO-COD-TCNL.
      *PVG FIN 04-FEB-2014
                                                                        
           PERFORM MC2-LNK-RCC.
           IF RCC-COD-MENS > SPACES
               MOVE 'MC2'        TO MSG-COD-SIST
               MOVE RCC-COD-MENS TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.

           PERFORM LEE-QUE-RCC.

      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
              PERFORM PRO-INT-INFO.
      *PVG FIN 21-OCT-2013

      *PVG INI 22-MAY-2012
       KTT-SCP-ANL-KEY.
      *PVG FIN 22-MAY-2012
           MOVE 1 TO WSS-S.
       LUP-SCP-ANL-KEY.
           IF QSP-VAL-MNTO(WSS-S) = ZEROES                              
      *PVG INI 09-JUN-2010
              AND QSP-COD-SEGU(WSS-S) NOT = 'INF'                       
      *PVG FIN 09-JUN-2010
               GO TO FIN-SCP-ANL-KEY.

           PERFORM SET-FRM-IFLD.
           PERFORM PUT-TS-SCP.
           
           ADD 1 TO WSS-S.
           GO TO LUP-SCP-ANL-KEY.

       MSG-SCP-ANL-KEY.
      *PVG INI 15-MAY-2012
           MOVE 'MC2' TO MSG-COD-SIST.
      *PVG FIN 15-MAY-2012
           PERFORM GET-MSG.
           IF RCC-COD-MEN2 > SPACES                                     
              MOVE MSG-GLS-DESC TO FRM-MEN1                             
              MOVE RCC-COD-MEN2 TO FRM-MEN2                             
           ELSE                                                         
              MOVE MSG-GLS-DESC TO FRM-MENS.

      *PVG INI 15-MAY-2012
           IF (SCR-OFRM-SRV AND
              (RCC-COD-MENS = 'CPTSEL   NEX' OR 'RCCCPT   NEX'))
      *MHM-INI 16-OCT-2017
              IF FRM-COD-CPTO IN SCP-FLD = 'CCM' OR 'SGS'
                  GO TO FIN-SCP-ANL-KEY
              ELSE
      *MHM-FIN 16-OCT-2017
      *MHM-INI 15-DIC-2016
              MOVE 'S' TO SCR-IERR
      *MHM-FIN
              GO TO FIN-SCP-ANL-KEY.
      *PVG FIN 15-MAY-2012
           MOVE FIO-STAT-NEX TO FIO-STAT.                               
           GO TO FIN-SCP-ANL-KEY.
       FIN-SCP-ANL-KEY.
           EXIT.

       LEE-QUE-RCC SECTION.
       INI-LEE-QUE-RCC.
           MOVE ZEROES TO RCC-R IN RCC-VARI.
       LUP-LEE-QUE-RCC.
           ADD 1 TO RCC-R.
           MOVE RCC-R              TO QUE-NITM.
           MOVE RCC-NOM-TSSGS      TO QUE-COLA.
           MOVE RCC-LEN-TSSGS      TO QUE-LITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF NOT (QUE-STAT = QUE-STAT-OKS)
              GO TO FIN-LEE-QUE-RCC.
           MOVE '00'     TO FIO-STAT.
           MOVE QUE-ITEM TO OSG-APL-VEC(RCC-R).
      *PVG INI 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE QUE-ITEM TO RCC-CCM-VEC(RCC-R).
      *PVG FIN 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM'
              IF NOT OSG-SGS-IND-SELE(RCC-R) = 'S'
                 GO TO LUP-LEE-QUE-RCC.
           MOVE 'S'                     TO QSP-IND-SELC(RCC-R).
      *PVG INI 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM' AND
              RCC-CCM-IND-SOBL(RCC-R) = 'N'
      *PVG INI 23-MAY-2012
              IF SCR-OFRM-SRV
      *PVG INI 26-MAR-2014 
                 OR  SCR-HDR-MRCA = 'PNT'
      *PVG FIN 26-MAR-2014
                 MOVE 'S'    TO QSP-IND-SELC(RCC-R)
              ELSE
      *PVG FIN 23-MAY-2012
                 MOVE SPACES TO QSP-IND-SELC(RCC-R).
PNT   *    IF FRM-COD-CPTO IN SCP-FLD = 'CCM' AND
PNT   *       RCC-DCM-COD-ECCM(RCC-R) = 'INF'
PNT   *       MOVE '0999  ' TO OSG-SGS-COD-MONE(RCC-R).
      *PVG FIN 09-JUN-2010
      *PVG INI 04-FEB-2015
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              IF OSG-SGS-IND-SELE(RCC-R) = 'S' OR 'P'
                 MOVE 'N' TO OSG-SGS-MSC-UTPR(RCC-R).

           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
              IF OSG-SGS-IND-SELE(RCC-R) = 'S' OR 'P'
                 MOVE 'N' TO OSG-SGS-MSC-UTPR(RCC-R).
      *PVG FIN 04-FEB-2015
      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              MOVE OSG-SGS-IND-SELE(RCC-R) TO QSP-IND-SELC(RCC-R)
              IF QSP-IND-SELC(RCC-R) = 'P'
                 MOVE 'S' TO QSP-IND-SELC(RCC-R).
      *PVG FIN 21-OCT-2013
      *PVG INI 23-MAY-2014
           MOVE FRM-COD-CPTO IN SCP-FLD TO QSP-COD-CPTO(RCC-R).
      *PVG FIN 23-MAY-2014
           PERFORM MV-COD-TSEG.
           MOVE OSG-SGS-COD-OCOB(RCC-R) TO QSP-COD-OCOB(RCC-R).
           MOVE OSG-SGS-COD-SEGU(RCC-R) TO QSP-COD-SEGU(RCC-R).
           MOVE OSG-SGS-VAL-MNTO(RCC-R) TO QSP-VAL-MNTO(RCC-R).
           MOVE OSG-SGS-VAL-MONE(RCC-R) TO QSP-COD-VCOC(RCC-R).
           MOVE OSG-OCI-VAL-PPRO(RCC-R) TO QSP-VAL-PPRO(RCC-R).
           MOVE OSG-SGS-SGV-TAMO(RCC-R) TO QSP-SGV-TAMO(RCC-R).
      *PVG INI 01-SEP-2011
           MOVE OSG-SGS-COD-VCOC(RCC-R) TO QSP-COD-TINF(RCC-R).
      *PVG FIN 01-SEP-2011

      *COSTO DE FONDO           (SOLO INT)
           MOVE OSG-SGS-SGV-CSTF(RCC-R) TO QSP-SGV-CSTF(RCC-R).
      *PVG INI 15-NOV-2011
           MOVE OSG-SGS-IND-DCTO(RCC-R) TO QSP-IND-CSTF-U(RCC-R).
           MOVE OSG-SGS-IND-CAAB(RCC-R) TO QSP-IND-CSTF-O(RCC-R).
      *PVG FIN 15-NOV-2011
      *TASA MAXIMA CONVENCIONAL (SOLO INT)
           MOVE OSG-SGS-SGV-TMAX(RCC-R) TO QSP-SGV-TMAX(RCC-R).
      *FACTOR DE RIESGO         (SOLO INT)
           MOVE OSG-SGS-VAL-FRIE(RCC-R) TO QSP-VAL-FRIE(RCC-R).
      *PVG INI 04-FEB-2015
           IF FRM-COD-CPTO IN SCP-FLD  = 'CCM' AND
              RCC-CCM-COD-TCOM(RCC-R)  = '002' AND
              SCR-IND-OBEX IN SCR-VARI = 'S'
              MOVE RCC-DCM-SGV-TAMO(RCC-R) TO QSP-VAL-MNTO(RCC-R)
              MOVE RCC-DCM-COD-VCOC(RCC-R) TO QSP-COD-VCOC(RCC-R)
              MOVE RCC-CCM-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R).
                                                                        
           IF FRM-COD-CLAS IN SCP-FLD = 'ROC'
              PERFORM PRO-INF-RROC.
      *PVG FIN 04-FEB-2015

              IF RCC-R = 1
                MOVE OSG-SGS-CAI-IRCC(RCC-R) TO FRM-CAI-IRCC IN SCP-FLD
                MOVE OSG-SGS-IIC-IRCC(RCC-R) TO FRM-IIC-IRCC IN SCP-FLD
                MOVE OSG-SGS-NUM-IRCC(RCC-R) TO FRM-NUM-IRCC IN SCP-FLD
                MOVE OSG-SGS-CAI-PLNT(RCC-R) TO FRM-CAI-PLAN IN SCP-FLD
                MOVE OSG-SGS-IIC-PLNT(RCC-R) TO FRM-IIC-PLAN IN SCP-FLD
                MOVE OSG-SGS-IND-TPLN(RCC-R) TO FRM-IND-TPLT IN SCP-FLD
      *MHM-INI 02-JUN-2017 
      *          MOVE OSG-SGS-FEC-PLNT(RCC-R) TO FRM-FEC-PLAN IN SCP-FLD
                MOVE OSG-SGS-NUM-SPLN(RCC-R) TO FRM-NUM-SLAN IN SCP-FLD
                MOVE OSG-SGS-NUM-APLN(RCC-R) TO FRM-NUM-ALAN IN SCP-FLD
                MOVE OSG-SGS-NUM-MPLN(RCC-R) TO FRM-NUM-MLAN IN SCP-FLD
                MOVE OSG-SGS-NUM-DPLN(RCC-R) TO FRM-NUM-DLAN IN SCP-FLD
      *MHM-FIN 02-JUN-2017 
                DISPLAY 'SCP*FRM-FEC-PLAN : ' FRM-FEC-PLAN IN SCP-FLD
                MOVE OSG-SGS-HRA-PLNT(RCC-R) TO FRM-HRA-PLAN IN SCP-FLD
                MOVE OSG-SGS-COD-SIST(RCC-R) TO FRM-COD-SIST IN SCP-FLD
                MOVE OSG-SGS-COD-EVEN(RCC-R) TO FRM-COD-EVEN IN SCP-FLD
                MOVE OSG-SGS-COD-MONE(RCC-R) TO FRM-COD-MONE IN SCP-FLD
                GO TO LUP-LEE-QUE-RCC
              ELSE
                GO TO LUP-LEE-QUE-RCC.

       FIN-LEE-QUE-RCC.
           EXIT.
       MV-COD-TSEG SECTION.
       INI-MV-COD-TSEG.
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM'
               MOVE OSG-SGS-COD-TSEG(RCC-R)    TO QSP-COD-TSEG(RCC-R)
               MOVE OSG-SGS-COD-MONE(RCC-R)    TO QSP-COD-MONE(RCC-R).
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' OR 'CGN' OR 'CCM'
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
      *PVG FIN 11-ENE-2007
               MOVE OSG-SGS-COD-TSEG(RCC-R) TO QSP-COD-TSEG(RCC-R)
      *PVG INI 04-FEB-2015
               MOVE OSG-SGS-CAI-IRCC(RCC-R) TO QSP-CAI-IRCC(RCC-R)
               MOVE OSG-SGS-IIC-IRCC(RCC-R) TO QSP-IIC-IRCC(RCC-R)
               MOVE OSG-SGS-NUM-IRCC(RCC-R) TO QSP-NUM-IRCC(RCC-R)
               MOVE OSG-SGS-CAI-PLNT(RCC-R) TO QSP-CAI-PLAN(RCC-R)
               MOVE OSG-SGS-IIC-PLNT(RCC-R) TO QSP-IIC-PLAN(RCC-R)
               MOVE OSG-SGS-FEC-PLNT(RCC-R) TO QSP-FEC-PLAN(RCC-R)
               MOVE OSG-SGS-HRA-PLNT(RCC-R) TO QSP-HRA-PLAN(RCC-R)
      *PVG FIN 04-FEB-2015
           ELSE
               MOVE OSG-SGS-IND-TPLN(RCC-R) TO QSP-COD-TSEG(RCC-R)
               MOVE OSG-SGS-CAI-IRCC(RCC-R) TO QSP-CAI-IRCC(RCC-R)
               MOVE OSG-SGS-IIC-IRCC(RCC-R) TO QSP-IIC-IRCC(RCC-R)
               MOVE OSG-SGS-NUM-IRCC(RCC-R) TO QSP-NUM-IRCC(RCC-R)
               MOVE OSG-SGS-COD-MONE(RCC-R) TO QSP-COD-MONE(RCC-R)
               MOVE OSG-SGS-CAI-PLNT(RCC-R) TO QSP-CAI-PLAN(RCC-R)
               MOVE OSG-SGS-IIC-PLNT(RCC-R) TO QSP-IIC-PLAN(RCC-R)
               MOVE OSG-SGS-FEC-PLNT(RCC-R) TO QSP-FEC-PLAN(RCC-R)
               MOVE OSG-SGS-HRA-PLNT(RCC-R) TO QSP-HRA-PLAN(RCC-R)
               IF OSG-SGS-IND-TPLN(RCC-R) = 'P'
                  MOVE OSG-SGS-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R)
               ELSE
                  MOVE SPACES                  TO QSP-COD-TINT(RCC-R).
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF ((FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM') AND
                OSG-SGS-IND-TPLN(RCC-R) = 'P')
                MOVE OSG-SGS-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R).
      *PVG FIN 11-ENE-2007
      *PVG INI 04-FEB-2015
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND
              OSG-SGS-MSC-UTPR(RCC-R) = 'N'
              MOVE OSG-SGS-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R).
      *PVG FIN 04-FEB-2015
       FIN-MV-COD-TSEG.
           EXIT.
       SCP-MOV-TS-FRM-ELM SECTION.
       INI-SCP-MOV-TS-FRM-ELM.
           MOVE SCP-FRM-IND-SELC TO
                    FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT).
           MOVE SCP-FRM-COD-TSEG TO
                    FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT).
           MOVE SCP-FRM-COD-OCOB TO
                    FRM-COD-OCOB IN SCP-FLD(WSS-IND-PANT).
           MOVE SCP-FRM-COD-SEGU TO
                    FRM-COD-SEGU IN SCP-FLD(WSS-IND-PANT).
      *PVG INI 23-MAY-2014
      *    IF FRM-COD-CPTO IN SCP-FLD NOT = 'PPC'
           IF SCP-FRM-COD-CPTO NOT = 'PPC'
      *PVG FIN 23-MAY-2014
           MOVE SCP-FRM-VAL-MNTO TO
                   FRM-VAL-MNTO IN SCP-FLD(WSS-IND-PANT)
           MOVE SCP-FRM-COD-VCOC TO
                    FRM-COD-VCOC IN SCP-FLD(WSS-IND-PANT).

           IF FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) > SPACES
      *PVG INI 23-MAY-2014
              MOVE SCP-FRM-COD-CPTO TO 
                               FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT).
      *        MOVE 'GNS' TO TAB-COD-SIST FIO-SIST
      *        MOVE 'SON' TO TAB-COD-TTAB IN TAB
      *        MOVE FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) TO
      *               TAB-COD-CTAB IN TAB
      *        PERFORM BUS-TAB
      *        MOVE TAB-GLS-ABRV IN TAB TO
      *                       FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT)
      *    ELSE
      *        MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT).
      *PVG FIN 23-MAY-2014

           IF FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) NOT > SPACES
               MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT)
               GO TO FIN-SCP-MOV-TS-FRM-ELM.
           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
      *PVG INI 23-MAY-2014
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS'                           
      *       MOVE 'TAB' TO TAB-COD-SIST FIO-SIST
      *       MOVE 'TSE' TO TAB-COD-TTAB IN TAB.
      *    IF FRM-COD-CPTO IN SCP-FLD = 'INT' OR 'PPC'                  
      *       MOVE 'TAB' TO TAB-COD-SIST FIO-SIST
      *       MOVE 'TDP' TO TAB-COD-TTAB IN TAB.                        
      *    IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
      *       MOVE 'DOC' TO TAB-COD-TTAB IN TAB.
      *    IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
      *       MOVE 'CMS' TO TAB-COD-TTAB IN TAB.
           IF SCP-FRM-COD-CPTO = 'SGS'
              MOVE 'MC2' TO TAB-COD-SIST FIO-SIST
              MOVE 'TSE' TO TAB-COD-TTAB IN TAB.
           IF SCP-FRM-COD-CPTO = 'INT' OR 'PPC'
              MOVE 'MC2' TO TAB-COD-SIST FIO-SIST
              MOVE 'TDP' TO TAB-COD-TTAB IN TAB.
           IF SCP-FRM-COD-CPTO = 'CGN'
              MOVE 'DOC' TO TAB-COD-TTAB IN TAB.
           IF SCP-FRM-COD-CPTO = 'CCM'
              MOVE 'CMS' TO TAB-COD-TTAB IN TAB.
      *PVG FIN 23-MAY-2014
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) TO
                TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO
                FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT).
       FIN-SCP-MOV-TS-FRM-ELM.
           EXIT.

       PUT-TS-SCP SECTION.                                              
       INI-PUT-TS-SCP.                                                  
           MOVE SPACES TO SCP-ITEM.                                     
           MOVE ZEROES TO SCP-FRM-VAL-MNTO.                             
           MOVE QSP-VAL-MNTO(WSS-S) TO SCP-FRM-VAL-MNTO.
                                                                        
      *PVG INI 23-MAY-2014
           MOVE QSP-COD-CPTO(WSS-S) TO SCP-FRM-COD-CPTO.
      *PVG FIN 23-MAY-2014
           MOVE 'S'                 TO SCP-FRM-IND-SELC.                

           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC
              IF SCP-FRM-IND-SELC = 'N'
                 MOVE SPACES TO SCP-FRM-IND-SELC.

      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013
      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013
      *PVG INI 04-FEB-2015
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 04-FEB-2015

           MOVE QSP-COD-TSEG(WSS-S) TO SCP-FRM-COD-TSEG.                
           MOVE QSP-COD-OCOB(WSS-S) TO SCP-FRM-COD-OCOB.                
           MOVE QSP-COD-SEGU(WSS-S) TO SCP-FRM-COD-SEGU.                
           MOVE QSP-COD-VCOC(WSS-S) TO SCP-FRM-COD-VCOC.                
           MOVE QSP-CIC-IRCC(WSS-S) TO SCP-FRM-CIC-IRCC.                
           MOVE QSP-NUM-IRCC(WSS-S) TO SCP-FRM-NUM-IRCC.                
           MOVE QSP-COD-MONE(WSS-S) TO SCP-FRM-COD-MONE.                
           MOVE QSP-CIC-PLAN(WSS-S) TO SCP-FRM-CIC-PLAN.                
           MOVE QSP-FEC-PLAN(WSS-S) TO SCP-FRM-FEC-PLAN.                
           MOVE QSP-HRA-PLAN(WSS-S) TO SCP-FRM-HRA-PLAN.                
           MOVE QSP-COD-TINT(WSS-S) TO SCP-FRM-COD-TINT.                
                                                                        
           MOVE QSP-VAL-PPRO(WSS-S) TO SCP-QSP-VAL-PPRO.                
                                                                        
           MOVE QSP-SGV-TAMO(WSS-S) TO SCP-QSP-SGV-TAMO.                
      *PVG INI 01-SEP-2011
           MOVE QSP-COD-TINF(WSS-S) TO SCP-QSP-COD-TINF.
      *PVG FIN 01-SEP-2011
           MOVE QSP-SGV-CSTF(WSS-S) TO SCP-QSP-SGV-CSTF.
      *PVG INI 15-NOV-2011
           MOVE QSP-IND-CSTF-U(WSS-S) TO SCP-QSP-IND-CSTF-U.
           MOVE QSP-IND-CSTF-O(WSS-S) TO SCP-QSP-IND-CSTF-O.
      *PVG FIN 15-NOV-2011
           MOVE QSP-SGV-TMAX(WSS-S) TO SCP-QSP-SGV-TMAX.
           MOVE QSP-VAL-FRIE(WSS-S) TO SCP-QSP-VAL-FRIE.
           IF SCP-FRM-IND-SELC > SPACES
      *PVG INI 23-MAY-2014
              MOVE SCP-FRM-COD-CPTO TO SCP-FRM-GLS-SELC.
      *       MOVE 'GNS' TO TAB-COD-SIST FIO-SIST
      *       MOVE 'SON' TO TAB-COD-TTAB IN TAB
      *       MOVE SCP-FRM-IND-SELC TO TAB-COD-CTAB IN TAB
      *       PERFORM BUS-TAB
      *       MOVE TAB-GLS-ABRV IN TAB TO SCP-FRM-GLS-SELC
      *   ELSE
      *       MOVE SPACES              TO SCP-FRM-GLS-SELC.
      *PVG FIN 23-MAY-2014

           MOVE SCP-NOM-TSSCP  TO QUE-COLA.
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.
           MOVE SCP-ITEM       TO QUE-ITEM.
           MOVE QUE-PUT        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           ADD 1 TO SCR-TOT-OCCU.
       FIN-PUT-TS-SCP.                                                  
           EXIT.                                                        

       CLR-PANT-SCP SECTION.
       INI-CLR-PANT-SCP.
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(10).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(1).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(2).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(3).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(4).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(5).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(6).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(7).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(8).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(9).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(10).
       FIN-CLR-PANT-SCP.
           EXIT.

       HBL-KEY-SCP SECTION.                                             
       INI-HBL-KEY-SCP.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE 'SEL' TO SCR-CMND.                                      
           MOVE 'ACC' TO SCR-CCPP.                                      
           MOVE 'M'   TO SCR-STPP.                                      
           MOVE '1' TO FRM-CPIM-AEY.                                    
           MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SCP-FLD.            
           MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SCP-FLD.            
                                                                        
                                                                        
           PERFORM SCR-CLRA-SCP.                                        
           MOVE +4 TO OPC-CAI-IOPC-LEN IN SCP-FLD.                      
           MOVE -1 TO FRM-COD-CPTO-LEN IN SCP-FLD.                      
           MOVE SCR-CAI-IOPC IN SCR-VARI TO OPC-CAI-IOPC IN SCP-FLD.    
           MOVE SCR-IIC-IOPC IN SCR-VARI TO OPC-IIC-IOPC IN SCP-FLD.    
      *ISP  7-FEB-1990 DEBE SER REEMPLAZADO POR VARIABLE                
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY                        
      *     MOVE '1' TO FRM-CPIM-AEY.                                   
      *     PERFORM HBL-FLD.                                            
                                                                        
           PERFORM EDT-KEY-SCP.                                         
           PERFORM EDT-FLD-SCP.                                         
                                                                        
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
               PERFORM SCR-PUTA.                                        
                                                                        
       FIN-HBL-KEY-SCP.                                                 
           EXIT.                                                        
       OBT-FEC-PVTO SECTION.
       INI-OBT-FEC-PVTO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-FEC-FPVT IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES                  TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-FEC-PVTO.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )
               GO TO FIN-OBT-FEC-PVTO.
      
           IF ( EVC-VAL-VENC IN EVC > ZEROES ) OR
              ( EVC-MSC-BCCR IN EVC NOT = 'I' )
               IF WSS-FEC-FPVT NOT > ZEROES OR
                  WSS-FEC-FPVT     > EVC-FEC-FPVC IN EVC
                   IF OPC-IND-AFER IN OPC = 'N'
                       MOVE EVC-FEC-FPVC IN EVC TO WSS-FEC-FPVT
                   ELSE
                       MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1
                       MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2
                       MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3
                       MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4
                       PERFORM ANL-FRDO
                       IF MSG-COD-MENS NOT > SPACES
                           MOVE FEC-ITM1 TO WSS-NUM-DPVT
                           MOVE FEC-ITM2 TO WSS-NUM-MPVT
                           MOVE FEC-ITM3 TO WSS-NUM-SPVT
                           MOVE FEC-ITM4 TO WSS-NUM-APVT
                       ELSE
                           GO TO FIN-OBT-FEC-PVTO.
      *PVG INI 09-JUN-2010
           IF WSS-FEC-FPVT IN WSS-VARI NOT > ZEROES                     
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-OBT-FEC-PVTO.                                   
      *PVG FIN 09-JUN-2010
       FIN-OBT-FEC-PVTO.
           EXIT.
      
       ANL-FRDO SECTION.
       INI-ANL-FRDO.
           MOVE SPACES TO MSG-COD-MENS.
      
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE 'ANLFRDOFVHBL' TO MSG-COD-MENS
               GO TO FIN-ANL-FRDO.
      
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'ANLFRDOFSHBL' TO MSG-COD-MENS
                   GO TO FIN-ANL-FRDO.
      
           MOVE SPACES TO MSG-COD-MENS.
       FIN-ANL-FRDO.
           EXIT.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBPFEC.

      *PVG INI 11-FEB-2015
       COPY COLBFITR.
      *PVG FIN 11-FEB-2015
       COPY MC2BFROC.
       COPY COLBFTOC.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFEVC.
       COPY COLBFAUT.
      *PVG INI 22-MAY-2012
       COPY COLBFROV.
      *PVG FIN 22-MAY-2012

       COPY SGCBFDBC.
       COPY COLBGUVD.
       COPY GNSBBMSC.
       COPY MC2BKRCC.
      *PVG INI 25-AGO-2006
       BUS-HABIL SECTION.
       INI-BUS-HABIL.
           IF NOT (OPC-IND-AFER IN OPC = 'S')
              GO TO FIN-BUS-HABIL.
           MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-ITM1.
           MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-ITM2.
           MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-ITM3.
           MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-ITM4.
           GO TO LUP-BUS-HABIL.
       SUM-BUS-HABIL.
           MOVE 1            TO FEC-NDIA.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO DLC-NUM-DVEN IN UVD(1).
           MOVE FEC-ITM2     TO DLC-NUM-MVEN IN UVD(1).
           MOVE FEC-ITM3     TO DLC-NUM-SVEN IN UVD(1).
           MOVE FEC-ITM4     TO DLC-NUM-AVEN IN UVD(1).
       LUP-BUS-HABIL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-ITM1
              MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-ITM2
              MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-ITM3
              MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-ITM4
              GO TO SUM-BUS-HABIL.
       FIN-BUS-HABIL.
           EXIT.
      *PVG FIN 25-AGO-2006
      *PVG INI 09-JUN-2010
       BUS-RDC-DIND SECTION.                                            
       INI-BUS-RDC-DIND.                                                
      *ASUME SIN AVAL                                                   
           DIVIDE 1 BY 2 GIVING RCC-VAL-INTE IN RCC-VARI.               
                                                                        
           MOVE OPC-CAI-IOPC IN SCP-FLD TO RDC-CAI-IOPC IN RDC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO RDC-IIC-IOPC IN RDC.         
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.         
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-BUS-RDC-DIND.                                                
           PERFORM COL-FIO-RDC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                   RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN SCP-FLD AND    
                   RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN SCP-FLD)       
              GO TO EXT-BUS-RDC-DIND.                                   
           IF RDC-NUM-IDLC IN RDC NOT > ZEROES                          
              GO TO NXT-BUS-RDC-DIND.                                   
           MOVE FIO-END-BRW TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
                                                                        
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
              MOVE DBC-NUM-ICLI IN DBC TO RCC-VAL-INTE IN RCC-VARI.     
                                                                        
           GO TO FIN-BUS-RDC-DIND.                                      
       NXT-BUS-RDC-DIND.                                                
           MOVE FIO-GET-NXT     TO FIO-CMND.                            
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.                            
           GO TO LUP-BUS-RDC-DIND.                                      
       EXT-BUS-RDC-DIND.                                                
           IF FIO-STAT-OKS                                              
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM COL-FIO-RDC.                                      
       FIN-BUS-RDC-DIND.                                                
           EXIT.                                                        
      *PVG FIN 09-JUN-2010
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
       LEE-VEN-FMMV SECTION.
       INI-LEE-VEN-FMMV.
           MOVE ZEROES   TO DLC-FEC-FVEN IN UVD(1).
           MOVE 99999999 TO WSS-FEC-FPVT IN WSS-VARI.
       
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.             
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-VEN.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
              MOVE 'OPC    NOVEN' TO MSG-COD-MENS IN MSG
              GO TO EXT-LEE-VEN-FMMV.
       LUP-LEE-VEN-FMMV.
           IF VEN-FEC-FVEN IN VEN > DLC-FEC-FVEN IN UVD(1)
              MOVE VEN-FEC-FVEN IN VEN TO DLC-FEC-FVEN IN UVD(1).
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FPVT IN WSS-VARI
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FPVT IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              GO TO FIN-LEE-VEN-FMMV.
           IF OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
              GO TO LUP-LEE-VEN-FMMV.
       EXT-LEE-VEN-FMMV.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM COL-FIO-VEN.
       FIN-LEE-VEN-FMMV.
           EXIT.
      *PVG FIN 22-MAR-2010
      *PVG INI 05-MAR-2012
       ANL-EVC-VCFN SECTION.                                            
       INI-ANL-EVC-VCFN.                                                
           MOVE SPACES TO MSG-COD-MENS.                                 
           MOVE SPACES TO RCC-COD-ESTR IN RCC-VARI.
           MOVE SPACES TO RCC-COD-AMRT IN RCC-VARI.
           MOVE ZEROES TO CFN-NUM-NVEN IN CFN-VARI.
           MOVE 'N'    TO CFN-MSC-TCVK IN CFN-VARI.
           MOVE 'N'    TO CFN-MSC-TCVI IN CFN-VARI.
           MOVE ZEROES TO CFN-NUM-SEVE IN CFN-VARI.
           MOVE SPACES TO CFN-IND-UTSV IN CFN-VARI.

           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.             
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.             
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-ANL-EVC-VCFN.                                                
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND                                    
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )         
               GO TO EXT-ANL-EVC-VCFN.

           IF EVC-NUM-IEVC IN EVC = 1
              MOVE EVC-NUM-SEVE IN EVC TO CFN-NUM-SEVE IN CFN-VARI 
              MOVE EVC-IND-UTSV IN EVC TO CFN-IND-UTSV IN CFN-VARI
              MOVE EVC-FEC-FPVC IN EVC TO CFN-FEC-FPVC IN CFN-VARI.
              
           ADD EVC-NUM-VIGU IN EVC TO CFN-NUM-NVEN IN CFN-VARI.
           IF EVC-MSC-TCVE IN EVC = 'CO' OR 'FO'
              MOVE 'S' TO CFN-MSC-TCVK IN CFN-VARI.
           IF EVC-MSC-TCVE IN EVC = 'IO' AND 
              EVC-VAL-VENC IN EVC NOT > ZEROES
              MOVE 'S' TO CFN-MSC-TCVI IN CFN-VARI.
       NXT-ANL-EVC-VCFN.
           MOVE FIO-GET-NXT TO FIO-CMND
           GO TO LUP-ANL-EVC-VCFN.
       EXT-ANL-EVC-VCFN.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM COL-FIO-EVC.
           
           MOVE SPACES TO RCC-COD-ESTR IN RCC-VARI.
           IF CFN-NUM-NVEN IN CFN-VARI = 1
              MOVE 'V' TO RCC-COD-ESTR IN RCC-VARI
           ELSE
              MOVE 'C' TO RCC-COD-ESTR IN RCC-VARI
              IF CFN-MSC-TCVI IN CFN-VARI = 'S'
                 MOVE 'B' TO RCC-COD-ESTR IN RCC-VARI.

           MOVE SPACES TO RCC-COD-AMRT IN RCC-VARI.
           MOVE ZEROES TO CFN-NUM-PZOA IN CFN-VARI.
           IF (RCC-COD-ESTR IN RCC-VARI = 'C' OR 'B')
              GO TO CNT-ANL-EVC-VCFN-CFT.
           MOVE OPC-NUM-DCOL IN OPC      TO FEC-DEC1.                     
           MOVE OPC-NUM-MCOL IN OPC      TO FEC-MEC1.                     
           MOVE OPC-NUM-SCOL IN OPC      TO FEC-SEC1.                     
           MOVE OPC-NUM-ACOL IN OPC      TO FEC-AEC1.                     
           MOVE CFN-NUM-DPVC IN CFN-VARI TO FEC-DEC2.                     
           MOVE CFN-NUM-MPVC IN CFN-VARI TO FEC-MEC2.                     
           MOVE CFN-NUM-SPVC IN CFN-VARI TO FEC-SEC2.                     
           MOVE CFN-NUM-APVC IN CFN-VARI TO FEC-AEC2.                     
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-DIF-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'DIFDIA NOVLD' TO MSG-COD-MENS                      
               GO TO FIN-ANL-EVC-VCFN.
           MOVE FEC-NDIA TO CFN-NUM-SEVE IN CFN-VARI.
           MOVE 'D'      TO CFN-IND-UTSV IN CFN-VARI.
       CNT-ANL-EVC-VCFN-CFT.
           IF CFN-IND-UTSV IN CFN-VARI = 'A'
              MULTIPLY CFN-NUM-SEVE IN CFN-VARI BY 360
                GIVING CFN-NUM-PZOA IN CFN-VARI
           ELSE
           IF CFN-IND-UTSV IN CFN-VARI = 'M'
              MULTIPLY CFN-NUM-SEVE IN CFN-VARI BY 30
                GIVING CFN-NUM-PZOA IN CFN-VARI
           ELSE
              ADD CFN-NUM-SEVE IN CFN-VARI TO 
                  CFN-NUM-PZOA IN CFN-VARI.

           MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'CFT'                    TO TAB-COD-TTAB IN TAB.
           MOVE CFN-COD-PZOA IN CFN-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS  TO FIO-CMND.
       LUP-ANL-EVC-VCFN-CFT.
           PERFORM GNS-FIO-TAB.
           IF (FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'CFT' AND
                   TAB-IND-VIGE IN TAB NOT = 'S')
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LUP-ANL-EVC-VCFN-CFT.
           IF NOT (FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'CFT')
              MOVE 'NEXCOD  TCFT'           TO CFN-COD-MENS IN CFN-VARI
              MOVE CFN-COD-PZOA IN CFN-VARI TO CFN-EXT-MENS IN CFN-VARI
              GO TO FIN-ANL-EVC-VCFN.
           IF TAB-EXT-CTAB IN TAB NOT > SPACES
              MOVE 'NEXEXT  TCFT'      TO CFN-COD-MENS IN CFN-VARI
              MOVE TAB-COD-CTAB IN TAB TO CFN-EXT-MENS IN CFN-VARI
              GO TO FIN-ANL-EVC-VCFN.
           MOVE TAB-EXT-CTAB IN TAB TO RCC-COD-AMRT IN RCC-VARI.
       FIN-ANL-EVC-VCFN.
           EXIT.                                                        
      *PVG FIN 05-MAR-2012

      *PVG INI 22-MAY-2012
       PRO-SCP-PKTT SECTION.
       INI-PRO-SCP-PKTT.
           MOVE 'N'                 TO WSS-IND-PKTT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-SCP-PKTT-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT (FIO-STAT-OKS AND
                   ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC)
              GO TO FIN-PRO-SCP-PKTT.
           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
              MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-CAN
           ELSE
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LUP-PRO-SCP-PKTT-ROV.
      *CAN
           IF NOT (FIO-STAT-OKS                AND
                  (CAN-MSC-STAT IN CAN = 'C' OR
                   CAN-MSC-STAT IN CAN = 'P')  AND
                   CAN-MSC-CANC IN CAN = 'KTT')
              GO TO FIN-PRO-SCP-PKTT.

           MOVE 'S' TO WSS-IND-PKTT IN WSS-VARI.

      *ROC
           MOVE CAN-CAI-IOPC IN CAN TO ROC-CAI-IOPC IN ROC.
           MOVE CAN-IIC-IOPC IN CAN TO ROC-IIC-IOPC IN ROC.
           MOVE ZEROES              TO ROC-EXT-IOPC IN ROC.
           MOVE 'CRE'               TO ROC-COD-SIST IN ROC.
           MOVE 'CUR'               TO ROC-COD-EVEN IN ROC.
           MOVE ZEROES              TO ROC-NUM-IROC IN ROC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-SCP-PKTT.
           PERFORM MC2-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND
                   ROC-CAI-IOPC IN ROC = CAN-CAI-IOPC IN CAN AND
                   ROC-IIC-IOPC IN ROC = CAN-IIC-IOPC IN CAN AND
                   ROC-EXT-IOPC IN ROC = ZEROES              AND
                   ROC-COD-SIST IN ROC = 'CRE'               AND
                   ROC-COD-EVEN IN ROC = 'CUR')
      *PVG INI 11-FEB-2015
      *       MOVE 'ROCOPCPRONEX' TO RCC-COD-MENS
      *       GO TO FIN-PRO-SCP-PKTT.
              GO TO ITR-PRO-SCP-PKTT.
      *PVG FIN 11-FEB-2015

           IF ROC-COD-CPTO IN ROC = 'INT' AND ROC-MSC-STAT IN ROC = 'S'
              MOVE '00' TO FIO-STAT
              MOVE 1    TO RCC-R IN RCC-VARI

              MOVE 'S'                 TO QSP-IND-SELC(RCC-R)
              MOVE ROC-IND-TPLT IN ROC TO QSP-COD-TSEG(RCC-R)
              MOVE ROC-COD-OCOB IN ROC TO QSP-COD-OCOB(RCC-R)
              MOVE ROC-COD-MODL IN ROC TO QSP-COD-SEGU(RCC-R)
              MOVE ROC-SGV-TCAL IN ROC TO QSP-VAL-MNTO(RCC-R)
              MOVE ROC-COD-TCAL IN ROC TO QSP-COD-VCOC(RCC-R)
              MOVE ROC-CIC-IRCC IN ROC TO QSP-CIC-IRCC(RCC-R)
              MOVE 1                   TO QSP-NUM-IRCC(RCC-R)
              MOVE ROC-COD-VCOC IN ROC TO QSP-COD-MONE(RCC-R)
              MOVE ROC-CIC-PLAN IN ROC TO QSP-CIC-PLAN(RCC-R)
              MOVE ROC-FEC-PLAN IN ROC TO QSP-FEC-PLAN(RCC-R)
              MOVE ROC-HRA-PLAN IN ROC TO QSP-HRA-PLAN(RCC-R)
              MOVE ROC-COD-TINT IN ROC TO QSP-COD-TINT(RCC-R)

              MOVE ROC-SGV-TCAL IN ROC TO QSP-VAL-PPRO(RCC-R)

              MOVE ROC-SGV-TINF IN ROC TO QSP-SGV-TAMO(RCC-R)
              MOVE ROC-COD-TINF IN ROC TO QSP-COD-TINF(RCC-R)
              MOVE ROC-SGV-CFON IN ROC TO QSP-SGV-CSTF(RCC-R)
              MOVE ROC-IND-CFUS IN ROC TO QSP-IND-CSTF-U(RCC-R)
              MOVE ROC-IND-CFOP IN ROC TO QSP-IND-CSTF-O(RCC-R)
              MOVE ROC-SGV-TCAL IN ROC TO QSP-SGV-TMAX(RCC-R)
              MOVE ZEROES              TO QSP-VAL-FRIE(RCC-R)

      *PVG INI 02-SEP-2014 REGULARIZACION CODIGO CONCEPTO
              MOVE ROC-COD-CPTO IN ROC TO QSP-COD-CPTO(RCC-R)
      *PVG FIN 02-SEP-2014 REGULARIZACION CODIGO CONCEPTO

              MOVE ROC-CAI-IRCC IN ROC TO FRM-CAI-IRCC IN SCP-FLD
              MOVE ROC-IIC-IRCC IN ROC TO FRM-IIC-IRCC IN SCP-FLD
              MOVE 1                   TO FRM-NUM-IRCC IN SCP-FLD
              MOVE ROC-CAI-PLAN IN ROC TO FRM-CAI-PLAN IN SCP-FLD
              MOVE ROC-IIC-PLAN IN ROC TO FRM-IIC-PLAN IN SCP-FLD
              MOVE ROC-IND-TPLT IN ROC TO FRM-IND-TPLT IN SCP-FLD
      *MHM-INI 02-JUN-2017 
      *        MOVE ROC-FEC-PLAN IN ROC TO FRM-FEC-PLAN IN SCP-FLD 
              MOVE ROC-NUM-DLAN IN ROC TO FRM-NUM-DLAN IN SCP-FLD 
              MOVE ROC-NUM-MLAN IN ROC TO FRM-NUM-MLAN IN SCP-FLD 
              MOVE ROC-NUM-SLAN IN ROC TO FRM-NUM-SLAN IN SCP-FLD 
              MOVE ROC-NUM-ALAN IN ROC TO FRM-NUM-ALAN IN SCP-FLD 
      *MHM-FIN 02-JUN-2017 
              MOVE ROC-HRA-PLAN IN ROC TO FRM-HRA-PLAN IN SCP-FLD
              MOVE ROC-COD-SIST IN ROC TO FRM-COD-SIST IN SCP-FLD
              MOVE ROC-COD-EVEN IN ROC TO FRM-COD-EVEN IN SCP-FLD
              MOVE ROC-COD-VCOC IN ROC TO FRM-COD-MONE IN SCP-FLD

              GO TO FIN-PRO-SCP-PKTT.
       NXT-PRO-SCP-PKTT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-SCP-PKTT.
      *PVG INI 11-FEB-2015
       ITR-PRO-SCP-PKTT.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
              MOVE 'ROCITR   NEX' TO RCC-COD-MENS
              GO TO FIN-PRO-SCP-PKTT.

           MOVE 1 TO RCC-R IN RCC-VARI.

           MOVE 'S'                    TO QSP-IND-SELC(RCC-R).
           MOVE 'INT'                  TO QSP-COD-CPTO(RCC-R).
           MOVE 'P'                    TO QSP-COD-TSEG(RCC-R).
           MOVE SPACES                 TO QSP-COD-OCOB(RCC-R).
           MOVE SPACES                 TO QSP-COD-SEGU(RCC-R).
           MOVE 1                      TO QSP-NUM-IRCC(RCC-R).
           MOVE OPC-COD-VCOC IN OPC    TO QSP-COD-MONE(RCC-R).
           MOVE OPC-COD-RMOC IN OPC    TO QSP-CIC-PLAN(RCC-R).
           MOVE OPC-FEC-FTRN IN OPC    TO QSP-FEC-PLAN(RCC-R).
           MOVE OPC-HRA-HRTR IN OPC    TO QSP-HRA-PLAN(RCC-R).

           MOVE ITR-COD-TINT IN ITR    TO QSP-COD-TINT(RCC-R).
           IF ITR-COD-CVTI IN ITR > SPACES
              MOVE ITR-SGV-SPRD IN ITR TO QSP-VAL-MNTO(RCC-R)
           ELSE
              MOVE ITR-SGV-TINT IN ITR TO QSP-VAL-MNTO(RCC-R).
           MOVE QSP-VAL-MNTO(RCC-R)    TO QSP-VAL-PPRO(RCC-R).
           MOVE QSP-VAL-MNTO(RCC-R)    TO QSP-SGV-TMAX(RCC-R).
           MOVE QSP-VAL-MNTO(RCC-R)    TO QSP-SGV-TAMO(RCC-R).
           MOVE ZEROES                 TO QSP-SGV-CSTF(RCC-R).
           MOVE ZEROES                 TO QSP-VAL-FRIE(RCC-R).

           MOVE 1                   TO FRM-NUM-IRCC IN SCP-FLD.
           MOVE QSP-CAI-PLAN(RCC-R) TO FRM-CAI-PLAN IN SCP-FLD.
           MOVE QSP-IIC-PLAN(RCC-R) TO FRM-IIC-PLAN IN SCP-FLD.
           MOVE 'P'                 TO FRM-IND-TPLT IN SCP-FLD.
           MOVE QSP-FEC-PLAN(RCC-R) TO FRM-FEC-PLAN IN SCP-FLD.
           MOVE QSP-HRA-PLAN(RCC-R) TO FRM-HRA-PLAN IN SCP-FLD.
           MOVE 'CRE'               TO FRM-COD-SIST IN SCP-FLD.
           MOVE 'CUR'               TO FRM-COD-EVEN IN SCP-FLD.
           MOVE QSP-COD-MONE(RCC-R) TO FRM-COD-MONE IN SCP-FLD.
      *PVG FIN 11-FEB-2015
       FIN-PRO-SCP-PKTT.
           EXIT.
      *PVG FIN 22-MAY-2012
      *PVG INI 11-FEB-2015
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE CAN-CAI-IOPC IN CAN TO ITR-CAI-IOPC IN ITR.
           MOVE CAN-IIC-IOPC IN CAN TO ITR-IIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CAI-IOPC IN ITR = CAN-CAI-IOPC IN CAN AND
                    ITR-IIC-IOPC IN ITR = CAN-IIC-IOPC IN CAN AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.
      *PVG FIN 11-FEB-2015
      *PVG INI 21-OCT-2013
       PRO-INT-INFO SECTION.
       INI-PRO-INT-INFO.
           IF FRM-VAL-TINF IN SCP-FLD NOT > ZEROES
              GO TO FIN-PRO-INT-INFO.
      *----------------------------------------------------------------*
           MOVE VEC-QSP-DET(1)          TO VEC-QSP-DET(RCC-R).
           MOVE SPACES                  TO QSP-CIC-IRCC(RCC-R).
           MOVE ZEROES                  TO QSP-NUM-IRCC(RCC-R).
           MOVE SCR-USER                TO QSP-CIC-PLAN(RCC-R).
           MOVE FRM-COD-TINF IN SCP-FLD TO QSP-COD-TINT(RCC-R).
           MOVE QSP-VAL-PPRO(RCC-R)     TO QSP-SGV-TAMO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO QSP-VAL-PPRO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO QSP-VAL-MNTO(RCC-R).

           MOVE FRM-VAL-CINF IN SCP-FLD TO QSP-SGV-CSTF(RCC-R).
           MOVE ZEROES                  TO QSP-VAL-FRIE(RCC-R).
           MOVE SPACES                  TO QSP-COD-MONE(RCC-R).
           MOVE 99999999                TO QSP-FEC-PLAN(RCC-R).
           MOVE 999999                  TO QSP-HRA-PLAN(RCC-R).
           MOVE SPACES                  TO QSP-CIC-IRCC(RCC-R).
      *----------------------------------------------------------------*
           MOVE OSG-APL-VEC(1)          TO OSG-APL-VEC(RCC-R).
           MOVE SCR-USER                TO OSG-SGS-CIC-PLNT(RCC-R).
           MOVE ZEROES                  TO OSG-SGS-NUM-IRCC(RCC-R).
           MOVE FRM-COD-TINF IN SCP-FLD TO OSG-SGS-COD-TINT(RCC-R).
           MOVE FRM-VAL-CINF IN SCP-FLD TO OSG-SGS-SGV-CSTF(RCC-R).
           MOVE ZEROES                  TO OSG-SGS-VAL-FRIE(RCC-R).
           MOVE OSG-OCI-VAL-PPRO(RCC-R) TO OSG-SGS-SGV-TAMO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PPRO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PMIN(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PMAX(RCC-R).
           MOVE SPACES                  TO OSG-SGS-COD-MONE(RCC-R).
           MOVE 99999999                TO OSG-SGS-FEC-PLNT(RCC-R).
           MOVE 99999                   TO OSG-SGS-HRA-PLNT(RCC-R).
           MOVE SPACES                  TO OSG-SGS-CIC-IRCC(RCC-R).
      *----------------------------------------------------------------*
       CNT-PRO-INT-INFO.
           SUBTRACT 1 FROM RCC-R.
           IF RCC-R > ZEROES
              MOVE 'N' TO QSP-IND-SELC(RCC-R)
              MOVE 'N' TO OSG-SGS-IND-SELE(RCC-R)
              GO TO CNT-PRO-INT-INFO.
       FIN-PRO-INT-INFO.
           EXIT.
      *PVG FIN 21-OCT-2013
      *PVG INI 23-MAY-2014
       SCP-ANL-PALL SECTION.
       INI-SCP-ANL-PALL.
           MOVE FRM-COD-CPTO IN SCP-FLD TO WSS-BKP-CPTO IN WSS-VARI.           
           MOVE 'S'    TO WSS-IND-PVEZ IN WSS-VARI.
           MOVE ZEROES TO WSS-P IN WSS-VARI.
       LUP-SCP-ANL-PMC2.
           ADD 1 TO WSS-P IN WSS-VARI.
           IF WSS-P > WSS-PMAX 
              IF WSS-IND-ETRF IN WSS-VARI = 'S'
                 MOVE '00' TO FIO-STAT
                 MOVE SPACES TO MSG-COD-MENS
                 MOVE SPACES TO RCC-COD-MENS
                 GO TO EXT-SCP-ANL-PALL
              ELSE
                 GO TO MSG-SCP-ANL-PALL.
           IF WSS-COD-DAT3(WSS-P) > SPACES
              MOVE WSS-COD-DAT3(WSS-P) TO FRM-COD-CPTO IN SCP-FLD
           ELSE
              IF WSS-IND-ETRF IN WSS-VARI = 'S'
                 MOVE '00' TO FIO-STAT
                 MOVE SPACES TO MSG-COD-MENS
                 MOVE SPACES TO RCC-COD-MENS
                 GO TO EXT-SCP-ANL-PALL
              ELSE
                 GO TO MSG-SCP-ANL-PALL.

           PERFORM CLR-VEC-QSP.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO RCC-COD-MENS.
           IF WSS-IND-PVEZ IN WSS-VARI = 'N'
              GO TO CNT-SCP-ANL-MC2.
      *----------------------------------------------------------------*
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
           ELSE
           IF OPC-MSC-STAT IN OPC = 'A'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-SCP-ANL-PALL.
           IF OPC-COD-TOOC IN OPC = 'BEX'
              MOVE 'S' TO SCR-IND-OBEX IN SCR-VARI
           ELSE
              MOVE 'N' TO SCR-IND-OBEX IN SCR-VARI.
      *----------------------------------------------------------------*
           MOVE OPC-CAI-IOPC IN SCP-FLD TO UVD-CAI-IOPC IN UVD.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO UVD-IIC-IOPC IN UVD.
           IF OPC-IND-VSTR IN OPC = 'N'
              PERFORM LEE-VEN-FMMV
           ELSE
              PERFORM BUS-UVD.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE 'COL' TO MSG-COD-SIST
              GO TO MSG-SCP-ANL-PALL.

           PERFORM BUS-HABIL.
           MOVE OPC-NUM-DCOL IN OPC    TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC    TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC    TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC    TO FEC-AEC1.
           MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-DEC2.
           MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-MEC2.
           MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-SEC2.
           MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'MC2' TO MSG-COD-SIST
               MOVE 'DIFDIA NOVLD' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-PALL.
           MOVE FEC-NDIA TO WSS-NUM-NDIA IN WSS-VARI.

           MOVE OPC-CAI-IOPC IN SCP-FLD TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO AUT-IIC-IOPC IN AUT.
PNT        MOVE 'AUT'                   TO AUT-COD-EVEN IN AUT.
PNT        MOVE ZEROES                  TO AUT-NUM-ICAN IN AUT.
           MOVE 1                       TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE 'AUT' TO WSS-COD-TCAR IN WSS-VARI
           ELSE
PNT            MOVE 'PAT'  TO AUT-COD-EVEN IN AUT
PNT            MOVE ZEROES TO AUT-NUM-ICAN IN AUT
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-AUT
               IF FIO-STAT-OKS
                  MOVE 'PAT' TO WSS-COD-TCAR IN WSS-VARI
               ELSE
                  MOVE SPACES TO WSS-COD-TCAR IN WSS-VARI.

           IF SCR-CIC-DIND IN SCR-VARI > SPACES
              MOVE FRM-NUM-ICLI IN SCP-FLD  TO DBC-NUM-ICLI IN DBC
              MOVE FRM-VRF-ICLI IN SCP-FLD  TO DBC-VRF-ICLI IN DBC
              MOVE FRM-IND-ICLI IN SCP-FLD  TO DBC-IND-ICLI IN DBC
              MOVE FRM-GLS-ICLI IN SCP-FLD  TO DBC-GLS-ICLI IN DBC
              GO TO CNT-SCP-ANL-PALL.

           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-PALL.

           MOVE RDC-CAI-ICLI IN RDC TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI IN RDC TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'DBC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-PALL.

       CNT-SCP-ANL-PALL.
           IF OPC-IND-VSTR IN OPC = 'S'
              PERFORM OBT-FEC-PVTO
              IF MSG-COD-MENS > SPACES
                 MOVE 'COL' TO MSG-COD-SIST
                 GO TO MSG-SCP-ANL-PALL.
      *----------------------------------------------------------------*
       CNT-SCP-ANL-MC2.
           IF FRM-COD-CLAS IN SCP-FLD = 'ROC' AND
              WSS-IND-PVEZ IN WSS-VARI = 'S'
              PERFORM PRO-LEC-RROC.
           MOVE 'N' TO WSS-IND-PVEZ IN WSS-VARI.

           IF FRM-COD-CPTO IN SCP-FLD = 'INT' AND
              OPC-IND-RENO IN OPC = 'PRO'
              PERFORM PRO-SCP-PKTT
              IF RCC-COD-MENS > SPACES
                 MOVE 'MC2'        TO MSG-COD-SIST
                 MOVE RCC-COD-MENS TO MSG-COD-MENS
                 GO TO MSG-SCP-ANL-PALL
              ELSE
                 IF WSS-IND-PKTT IN WSS-VARI = 'S'
                    GO TO KTT-SCP-ANL-PALL.
    
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND
              OPC-COD-SEGD IN OPC NOT = 'PRECIO   '
              GO TO LUP-SCP-ANL-PMC2.
      *----------------------------------------------------------------*

           MOVE OPC-CAI-IOPC IN SCP-FLD  TO RCC-CAI-IOPE IN RCC-VARI.
           MOVE OPC-IIC-IOPC IN SCP-FLD  TO RCC-IIC-IOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-EXT-IOPE IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
              MOVE OPC-COD-RMOC IN OPC   TO RCC-CIC-IOPE IN RCC-VARI
              MOVE 'EJC '                TO RCC-EXT-IOPE IN RCC-VARI.
           MOVE DBC-NUM-ICLI IN DBC      TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE DBC-VRF-ICLI IN DBC      TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE DBC-IND-ICLI IN DBC      TO RCC-IND-ICLI IN RCC-VARI.
           MOVE DBC-GLS-ICLI IN DBC      TO RCC-GLS-ICLI IN RCC-VARI.
           MOVE FRM-COD-CLAS IN SCP-FLD  TO RCC-IND-RTBL IN RCC-VARI.
           MOVE FRM-COD-COMP IN SCP-FLD  TO RCC-IND-COMP IN RCC-VARI.

           IF OPC-COD-OTRN IN OPC = SPACES
               MOVE '010'                TO RCC-COD-TCNL IN RCC-VARI
               MOVE OPC-COD-OFOC IN OPC  TO RCC-COD-CNAL IN RCC-VARI
           ELSE
               MOVE 'TAB'                TO TAB-COD-SIST FIO-SIST
               MOVE 'CNL'                TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-OTRN IN OPC  TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N'
                   IF OPC-COD-OTRN IN OPC = '010'
                       MOVE '010'        TO RCC-COD-TCNL IN RCC-VARI
                       MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI
                   ELSE
                       MOVE OPC-COD-OTRN IN OPC TO
                                            RCC-COD-TCNL IN RCC-VARI
                       MOVE SPACES       TO RCC-COD-CNAL IN RCC-VARI
               ELSE
                   MOVE '010'            TO RCC-COD-TCNL IN RCC-VARI
                   MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI.

           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCOC IN RCC-VARI.
           MOVE OPC-COD-TOOC IN OPC      TO RCC-COD-TOOC IN RCC-VARI.
           MOVE OPC-COD-AOOC IN OPC      TO RCC-COD-AOOC IN RCC-VARI.
           MOVE OPC-VAL-CRED IN OPC      TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCMO IN RCC-VARI.
           MOVE OPC-FEC-FCOL IN OPC      TO RCC-FEC-FCOL IN RCC-VARI.
           MOVE WSS-FEC-FPVT IN WSS-VARI TO RCC-FEC-FVEN IN RCC-VARI.
           MOVE WSS-NUM-NDIA             TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE 'CUR'                    TO RCC-COD-EVEN IN RCC-VARI.
           MOVE FRM-COD-CPTO IN SCP-FLD  TO RCC-COD-CPTO IN RCC-VARI.
           MOVE WSS-COD-TCAR             TO RCC-COD-TCAR IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
               MOVE ZEROES               TO RCC-VAL-SOPE IN RCC-VARI
               MOVE SPACES               TO RCC-COD-VSOP IN RCC-VARI
           ELSE
               MOVE OPC-VAL-CRED IN OPC  TO RCC-VAL-SOPE IN RCC-VARI
               MOVE OPC-COD-VCOC IN OPC  TO RCC-COD-VSOP IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-FINA IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-INTE IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-VASG IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCVA IN RCC-VARI.

           IF RCC-COD-CPTO IN RCC-VARI = 'SGS'
              DIVIDE 1 BY 2 GIVING RCC-VAL-INTE IN RCC-VARI
              IF SCR-CIC-DIND IN SCR-VARI NOT > SPACES
                 PERFORM BUS-RDC-DIND.
      *PVG INI 05-ENE-2012
           MOVE SPACES TO RCC-COD-ESTR IN RCC-VARI.
           MOVE SPACES TO RCC-COD-AMRT IN RCC-VARI.
           PERFORM ANL-EVC-VCFN.
           IF CFN-COD-MENS IN CFN-VARI > SPACES
              MOVE 'MC2'                    TO MSG-COD-SIST
              MOVE CFN-COD-MENS IN CFN-VARI TO MSG-COD-MENS
              MOVE CFN-EXT-MENS IN CFN-VARI TO RCC-COD-MEN2 IN RCC-VARI
              GO TO MSG-SCP-ANL-KEY.
      *PVG FIN 05-ENE-2012

           MOVE RCC-COD-TCNL IN RCC-VARI TO SCR-COD-TCNL.
           MOVE RCC-COD-CNAL IN RCC-VARI TO SCR-COD-CNAL.
           PERFORM PRO-COD-TCNL.

           PERFORM MC2-LNK-RCC.
           IF RCC-COD-MENS > SPACES
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE RCC-COD-MENS TO MSG-COD-MENS
      *MHM-INI 16-OCT-2017
      *        GO TO NXT-SCP-ANL-PALL.
              IF FRM-COD-CPTO IN SCP-FLD = 'CCM' OR 'SGS'
                 MOVE 'S' TO WSS-IND-CCMP
                 GO TO NXT-SCP-ANL-PALL
              ELSE
                 MOVE 'N' TO WSS-IND-CCMP
                 GO TO NXT-SCP-ANL-PALL.
      *MHM-FIN 16-OCT-2017
      *----------------------------------------------------------------*
           MOVE 'S' TO WSS-IND-ETRF IN WSS-VARI.

           PERFORM LEE-QUE-RCC.

           IF RCC-COD-CPTO IN RCC-VARI = 'INT'
              PERFORM PRO-INT-INFO.

           MOVE RCC-NOM-TSSGS      TO QUE-COLA.
           MOVE RCC-LEN-TSSGS      TO QUE-LITM.
           MOVE QUE-DEL            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           
       KTT-SCP-ANL-PALL.
           MOVE 1 TO WSS-S.
       LUP-SCP-ANL-PALL.
           IF QSP-VAL-MNTO(WSS-S) = ZEROES
              AND QSP-COD-SEGU(WSS-S) NOT = 'INF'
               GO TO NXT-SCP-ANL-PALL.

           IF WSS-IND-PVEZ IN WSS-VARI = 'S'
              PERFORM SET-FRM-IFLD.
           PERFORM PUT-TS-SCP.

           ADD 1 TO WSS-S.
           GO TO LUP-SCP-ANL-PALL.

       MSG-SCP-ANL-PALL.
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.
           MOVE SCP-ITEM       TO QUE-ITEM.
           MOVE QUE-DEL        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           IF RCC-COD-MEN2 > SPACES
              MOVE MSG-GLS-DESC TO FRM-MEN1
              MOVE RCC-COD-MEN2 TO FRM-MEN2
           ELSE
              MOVE MSG-GLS-DESC TO FRM-MENS.
           IF (SCR-OFRM-SRV AND
              (RCC-COD-MENS = 'CPTSEL   NEX' OR 'RCCCPT   NEX'))
              GO TO EXT-SCP-ANL-PALL.
           MOVE FIO-STAT-NEX TO FIO-STAT.
           GO TO EXT-SCP-ANL-PALL.
       NXT-SCP-ANL-PALL.
           MOVE WSS-BKP-CPTO IN WSS-VARI TO FRM-COD-CPTO IN SCP-FLD.
           GO TO LUP-SCP-ANL-PMC2.
       EXT-SCP-ANL-PALL.
           EXIT.

       CLR-VEC-QSP SECTION.
       INI-CLR-VEC-QSP.
           MOVE ZEROES TO WSS-S.
       LUP-CLR-VEC-QSP.
           ADD 1 TO WSS-S.
           IF WSS-S > WSS-IMAX
              GO TO FIN-CLR-VEC-QSP.
           MOVE SPACES TO QSP-IND-SELC(WSS-S).
           MOVE SPACES TO QSP-COD-TSEG(WSS-S).
           MOVE SPACES TO QSP-COD-OCOB(WSS-S).
           MOVE SPACES TO QSP-COD-SEGU(WSS-S).
           MOVE ZEROES TO QSP-VAL-MNTO(WSS-S).
           MOVE SPACES TO QSP-COD-VCOC(WSS-S).
           MOVE SPACES TO QSP-COD-TINT(WSS-S).
           GO TO LUP-CLR-VEC-QSP.
       FIN-CLR-VEC-QSP.
           EXIT.

       PRO-COD-TCNL SECTION.
       INI-PRO-COD-TCNL.
           IF RCC-COD-TCNL IN RCC-VARI = WSS-COD-COFI IN WSS-VARI
              GO TO FIN-PRO-COD-TCNL.
           MOVE 'MC2'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'CTR'                    TO TAB-COD-TTAB IN TAB.
           MOVE RCC-COD-TCNL IN RCC-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO FIN-PRO-COD-TCNL.
           IF TAB-CIC-CTAB IN TAB > SPACES
              MOVE TAB-CIC-CTAB IN TAB TO RCC-COD-TCNL IN RCC-VARI.
       FIN-PRO-COD-TCNL.
           EXIT.

       PRO-INF-RROC SECTION.
       INI-PRO-INF-RROC.
           IF QSP-COD-CPTO(RCC-R) = 'SGS'
              PERFORM BUS-SGS-CPTO
           ELSE
           IF QSP-COD-CPTO(RCC-R) = 'CGN'
              PERFORM BUS-CGN-CPTO.
       FIN-PRO-INF-RROC.
           EXIT.

       PRO-LEC-RROC SECTION.
       INI-PRO-LEC-RROC.
           MOVE ZEROES TO WSS-IROC     IN WSS-VARI.
           PERFORM CLR-VEC-RROC.
           MOVE ZEROES TO WSS-IROC     IN WSS-VARI.

           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.
           MOVE ZEROES                  TO ROC-EXT-IOPC IN ROC.
           MOVE 'CRE'                   TO ROC-COD-SIST IN ROC.
           MOVE 'CUR'                   TO ROC-COD-EVEN IN ROC.
           MOVE ZEROES                  TO ROC-NUM-IROC IN ROC.
           MOVE ROC-CIC-IOPC IN ROC     TO WSS-KEY-RROC IN WSS-VARI.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-LEC-RROC.
           PERFORM MC2-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND
                   ROC-CIC-IOPC IN ROC = WSS-KEY-RROC IN WSS-VARI AND
                   ROC-COD-SIST IN ROC = 'CRE' AND
                   ROC-COD-EVEN IN ROC = 'CUR')
              GO TO EXT-PRO-LEC-RROC.

           IF (ROC-MSC-STAT IN ROC = 'S' AND
              (ROC-COD-CPTO IN ROC = 'SGS' OR 'CGN'))
               ADD 1 TO WSS-IROC IN WSS-VARI
               MOVE ROC-COD-CPTO IN ROC TO VEC-COD-CPTO(WSS-IROC)
               MOVE ROC-COD-SCPT IN ROC TO VEC-COD-SCPT(WSS-IROC).
       NXT-PRO-LEC-RROC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-LEC-RROC.
       EXT-PRO-LEC-RROC.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-ROC.
       FIN-PRO-LEC-RROC.
           EXIT.
       CLR-VEC-RROC SECTION.
       INI-CLR-VEC-RROC.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-CLR-VEC-RROC.
           MOVE SPACES TO VEC-COD-CPTO(WSS-IROC)
           MOVE SPACES TO VEC-COD-SCPT(WSS-IROC)
           GO TO INI-CLR-VEC-RROC.
       FIN-CLR-VEC-RROC.
           EXIT.

       BUS-SGS-CPTO SECTION.
       INI-BUS-SGS-CPTO.
           MOVE 'N' TO QSP-IND-SELC(RCC-R).
           MOVE ZEROES TO WSS-IROC IN WSS-VARI.
       LUP-BUS-SGS-CPTO.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-BUS-SGS-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT > SPACES
              GO TO FIN-BUS-SGS-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT = 'SGS'
              GO TO NXT-BUS-SGS-CPTO.
           IF VEC-COD-SCPT(WSS-IROC) = QSP-COD-TSEG(RCC-R)
              MOVE 'S' TO QSP-IND-SELC(RCC-R)
              GO TO FIN-BUS-SGS-CPTO.
       NXT-BUS-SGS-CPTO.
           GO TO LUP-BUS-SGS-CPTO.
       FIN-BUS-SGS-CPTO.
           EXIT.

       BUS-CGN-CPTO SECTION.
       INI-BUS-CGN-CPTO.
           MOVE 'N' TO QSP-IND-SELC(RCC-R).
           MOVE ZEROES TO WSS-IROC IN WSS-VARI.
       LUP-BUS-CGN-CPTO.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-BUS-CGN-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT > SPACES
              GO TO FIN-BUS-CGN-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT = 'CGN'
              GO TO NXT-BUS-CGN-CPTO.
           IF VEC-COD-SCPT(WSS-IROC) = QSP-COD-TSEG(RCC-R)
              MOVE 'S' TO QSP-IND-SELC(RCC-R)
              GO TO FIN-BUS-CGN-CPTO.
       NXT-BUS-CGN-CPTO.
           GO TO LUP-BUS-CGN-CPTO.
       FIN-BUS-CGN-CPTO.
           EXIT.
      *PVG FIN 04-FEB-2015
      *INI-MFC TUXEDO ORACLE
       COPY MC2ZQSCP.
      *FIN-MFC TUXEDO ORACLE
