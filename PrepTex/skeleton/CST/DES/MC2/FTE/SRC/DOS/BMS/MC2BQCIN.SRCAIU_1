      *
      * MC2BQCIN
      * Version 3.0.1 Nov-2005
      * 13-May-19 10:49 AM
      *
       SET-TAG-MC2BQCIN SECTION.
       INI-SET-TAG-MC2BQCIN.
           MOVE
           '<IDNMOD NOM=$MC2BQCIN$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$13-May-19 10:49 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BQCIN.
           EXIT.
           
       PUT-ALL-CIN SECTION.
       INI-PUT-ALL-CIN.
           PERFORM PUT-CIN-CIN.
       FIN-PUT-ALL-CIN.
           EXIT.
       
       PUT-CIN-CIN SECTION.
       INI-PUT-CIN-CIN.
           IF PGM-STAT-CIN-NUL
               GO TO FIN-PUT-CIN-CIN.
           IF NOT PGM-STAT-CIN-OKS
               PERFORM CLR-CIN-CIN
               GO TO FIN-PUT-CIN-CIN.
           MOVE CIN-CAI-ICIN IN CIN TO CIN-CAI-ICIN IN CIN-FLD.
           MOVE CIN-IIC-ICIN IN CIN TO CIN-IIC-ICIN IN CIN-FLD.
           MOVE CIN-COD-SIST IN CIN TO CIN-COD-SIST IN CIN-FLD.
           MOVE CIN-COD-EVEN IN CIN TO CIN-COD-EVEN IN CIN-FLD.
           MOVE CIN-IND-TPLT IN CIN TO CIN-IND-TPLT IN CIN-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CIN-NUM-DINI IN CIN TO CIN-NUM-DINI IN CIN-FLD.
           MOVE CIN-NUM-MINI IN CIN TO CIN-NUM-MINI IN CIN-FLD.
           MOVE CIN-NUM-SINI IN CIN TO CIN-NUM-SINI IN CIN-FLD.
           MOVE CIN-NUM-AINI IN CIN TO CIN-NUM-AINI IN CIN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE CIN-HRA-HINI IN CIN TO CIN-HRA-HINI IN CIN-FLD.
           MOVE CIN-COD-VCOC IN CIN TO CIN-COD-VCOC IN CIN-FLD.
           MOVE CIN-IND-VIGE IN CIN TO CIN-IND-VIGE IN CIN-FLD.
           MOVE CIN-MSC-UTPT IN CIN TO CIN-MSC-UTPT IN CIN-FLD.
           MOVE CIN-CAI-IPTI IN CIN TO CIN-CAI-IPTI IN CIN-FLD.
           MOVE CIN-IIC-IPTI IN CIN TO CIN-IIC-IPTI IN CIN-FLD.
           MOVE CIN-MSC-BCTI IN CIN TO CIN-MSC-BCTI IN CIN-FLD.
           MOVE CIN-MSC-PBTI IN CIN TO CIN-MSC-PBTI IN CIN-FLD.
           MOVE CIN-MSC-BPBT IN CIN TO CIN-MSC-BPBT IN CIN-FLD.
           MOVE CIN-MSC-SPBT IN CIN TO CIN-MSC-SPBT IN CIN-FLD.
           MOVE CIN-COD-CVTI IN CIN TO CIN-COD-CVTI IN CIN-FLD.
           MOVE CIN-MSC-TFPR IN CIN TO CIN-MSC-TFPR IN CIN-FLD.
           MOVE CIN-NUM-PREP IN CIN TO CIN-NUM-PREP IN CIN-FLD.
           MOVE CIN-MSC-UTPR IN CIN TO CIN-MSC-UTPR IN CIN-FLD.
      *<<<< FIN_PUT_CIN_CIN                                             
           MOVE CIN-COD-CPTO(1)     TO FRM-COD-CPT1 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(2)     TO FRM-COD-CPT2 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(3)     TO FRM-COD-CPT3 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(4)     TO FRM-COD-CPT4 IN CIN-FLD.         
           MOVE CIN-COD-OPER(1)     TO FRM-COD-OPR1 IN CIN-FLD.         
           MOVE CIN-COD-OPER(2)     TO FRM-COD-OPR2 IN CIN-FLD.         
           MOVE CIN-COD-OPER(3)     TO FRM-COD-OPR3 IN CIN-FLD.         
           MOVE CIN-COD-OPER(4)     TO FRM-COD-OPR4 IN CIN-FLD.         

           MOVE CIN-COD-CPTO(5)     TO FRM-COD-CPT5 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(6)     TO FRM-COD-CPT6 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(7)     TO FRM-COD-CPT7 IN CIN-FLD.         
           MOVE CIN-COD-CPTO(8)     TO FRM-COD-CPT8 IN CIN-FLD.         
           MOVE CIN-COD-OPER(5)     TO FRM-COD-OPR5 IN CIN-FLD.         
           MOVE CIN-COD-OPER(6)     TO FRM-COD-OPR6 IN CIN-FLD.         
           MOVE CIN-COD-OPER(7)     TO FRM-COD-OPR7 IN CIN-FLD.         
           MOVE CIN-COD-OPER(8)     TO FRM-COD-OPR8 IN CIN-FLD.         

           IF CIN-COD-SIST IN CIN-FLD > SPACES                          
              MOVE 'TAB'                    TO TAB-COD-SIST             
              MOVE 'SIS'                    TO TAB-COD-TTAB IN TAB      
              MOVE CIN-COD-SIST IN CIN-FLD  TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                           
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN CIN-FLD  
           ELSE                                                         
              MOVE SPACES                   TO FRM-GLS-SIST IN CIN-FLD. 
           IF CIN-COD-EVEN IN CIN-FLD > SPACES                          
              MOVE 'MC2'                    TO TAB-COD-SIST             
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB      
              MOVE CIN-COD-SIST IN CIN-FLD  TO WSS-COD-SIST IN WSS-VARI 
              MOVE CIN-COD-EVEN IN CIN-FLD  TO WSS-COD-EVTO IN WSS-VARI 
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                           
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN CIN-FLD  
           ELSE                                                         
              MOVE SPACES                   TO FRM-GLS-EVEN IN CIN-FLD. 
           IF CIN-IND-VIGE IN CIN-FLD > SPACES                          
              MOVE 'GNS'                    TO TAB-COD-SIST             
              MOVE 'STT'                    TO TAB-COD-TTAB IN TAB      
              MOVE CIN-IND-VIGE IN CIN-FLD  TO TAB-COD-CTAB IN TAB      
              PERFORM BUS-TAB                                           
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-VIGE IN CIN-FLD  
           ELSE                                                         
              MOVE SPACES                   TO FRM-GLS-VIGE IN CIN-FLD. 
                                                                        
           IF CIN-MSC-BCTI IN CIN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-BCTI IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-BCTI IN CIN-FLD   
           ELSE                                                         
               MOVE SPACES                 TO FRM-GLS-BCTI IN CIN-FLD.  
                                                                        
           IF CIN-MSC-PBTI IN CIN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-PBTI IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-PBTI IN CIN-FLD   
           ELSE                                                         
              MOVE SPACES                  TO FRM-GLS-PBTI IN CIN-FLD.  
                                                                        
           IF CIN-MSC-BPBT IN CIN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-BPBT IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              MOVE MSC-GLS-DCOR IN MSC    TO FRM-GLS-BPBT IN CIN-FLD    
           ELSE                                                         
              MOVE SPACES                 TO FRM-GLS-BPBT IN CIN-FLD.   
                                                                        
           IF CIN-MSC-SPBT IN CIN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-SPBT IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-SPBT IN CIN-FLD   
           ELSE                                                         
              MOVE SPACES                 TO FRM-GLS-SPBT IN CIN-FLD.   
                                                                        
           IF CIN-MSC-UTPR IN CIN-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-UTPR IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPR IN CIN-FLD   
           ELSE                                                         
              MOVE SPACES                  TO FRM-GLS-UTPR IN CIN-FLD.  
                                                                        
           IF CIN-MSC-UTPT IN CIN-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE CIN-MSC-UTPT IN CIN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM BUS-MSC                                           
              IF MSG-COD-MENS IN MSG NOT > SPACES
                 MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPT IN CIN-FLD   
              ELSE                                                         
                 MOVE 'MC2'                    TO TAB-COD-SIST
                 MOVE 'CAA'                    TO TAB-COD-TTAB IN TAB
                 MOVE CIN-IND-TPLT IN CIN-FLD  TO WSS-COD-TCPT
                 MOVE CIN-MSC-UTPT IN CIN-FLD  TO WSS-COD-TSCP
                 MOVE WSS-GLS-OPRN IN WSS-VARI TO TAB-COD-CTAB IN TAB
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DCOR IN TAB  TO FRM-GLS-UTPT IN CIN-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTPT IN CIN-FLD.  
                                                                        
           MOVE 'MC2'               TO TAB-COD-SIST.                    
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE CIN-CIC-IPTI IN CIN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           IF MSG-COD-MENS > SPACES                                     
              MOVE CIN-CIC-IPTI IN CIN TO FRM-COD-CIN1 IN CIN-FLD       
           ELSE                                                         
              MOVE TAB-GLS-DESC IN TAB TO FRM-COD-CIN1 IN CIN-FLD       
              MOVE TAB-GLS-DATA IN TAB TO FRM-COD-CIN2 IN CIN-FLD.      
                                                                        
           MOVE ZEROES TO WSS-NUM-NCOL WSS-NUM-NFIL.                    
           MOVE ZEROES TO WSS-NUM-NCOL-X02                              
                          WSS-NUM-NCOL-X03                              
                          WSS-NUM-NCOL-X05                              
                          WSS-NUM-NCOL-X06                              
                          WSS-NUM-NFIL-X04                              
                          WSS-NUM-NFIL-X07.                             
           IF NOT SCR-OFRM-SRV                                          
              GO TO FIN-PUT-CIN-CIN.                                    
                                                                        
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               CIN-CAI-ICIN IN CIN = MCT-CAI-CINT IN MCT-VARI)          
              PERFORM OBT-COL-FIL-TRF                                   
              IF FIO-STAT-OKS                                           
                 GO TO FIN-PUT-CIN-CIN.                                 
      *PVG FIN 29-JUN-2007                                              
           PERFORM OBT-COL-FIL.                                         
           MOVE WSS-NUM-NCOL IN WSS-VARI TO FRM-NUM-NCOL IN CIN-FLD.    
           MOVE WSS-NUM-NFIL IN WSS-VARI TO FRM-NUM-NFIL IN CIN-FLD.    
      *>>>>                                                             
       FIN-PUT-CIN-CIN.
           EXIT.
       
       KEY-ALL-CIN SECTION.
       INI-KEY-ALL-CIN.
           PERFORM KEY-CIN-CIN.
       FIN-KEY-ALL-CIN.
           EXIT.
       
       KEY-CIN-CIN SECTION.
       INI-KEY-CIN-CIN.
           MOVE CIN-CAI-ICIN IN CIN-FLD TO CIN-CAI-ICIN IN CIN.
           MOVE CIN-IIC-ICIN IN CIN-FLD TO CIN-IIC-ICIN IN CIN.
           MOVE CIN-COD-SIST IN CIN-FLD TO CIN-COD-SIST IN CIN.
           MOVE CIN-COD-EVEN IN CIN-FLD TO CIN-COD-EVEN IN CIN.
           MOVE CIN-IND-TPLT IN CIN-FLD TO CIN-IND-TPLT IN CIN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIN-NUM-DINI IN CIN-FLD TO CIN-NUM-DINI IN CIN.
           MOVE CIN-NUM-MINI IN CIN-FLD TO CIN-NUM-MINI IN CIN.
           MOVE CIN-NUM-SINI IN CIN-FLD TO CIN-NUM-SINI IN CIN.
           MOVE CIN-NUM-AINI IN CIN-FLD TO CIN-NUM-AINI IN CIN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIN-HRA-HINI IN CIN-FLD TO CIN-HRA-HINI IN CIN.
           MOVE CIN-COD-VCOC IN CIN-FLD TO CIN-COD-VCOC IN CIN.
       FIN-KEY-CIN-CIN.
           EXIT.
       
       SCR-CLRA-CIN SECTION.
       INI-SCR-CLRA-CIN.
           PERFORM CLR-KEY-CIN.
           PERFORM CLR-FLD-CIN.
       FIN-SCR-CLRA-CIN.
           EXIT.
       
       CLR-KEY-CIN SECTION.
       INI-CLR-KEY-CIN.
           MOVE SPACES TO CIN-CAI-ICIN IN CIN-FLD.
           MOVE SPACES TO CIN-IIC-ICIN IN CIN-FLD.
           MOVE SPACES TO CIN-COD-SIST IN CIN-FLD.
           MOVE SPACES TO CIN-COD-EVEN IN CIN-FLD.
           MOVE SPACES TO CIN-IND-TPLT IN CIN-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIN-FEC-FINI IN CIN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO CIN-HRA-HINI IN CIN-FLD.
           MOVE SPACES TO CIN-COD-VCOC IN CIN-FLD.
           MOVE ZEROES TO CIN-HRA-HINI IN CIN-FLD.                      
       FIN-CLR-KEY-CIN.
           EXIT.
       
       CLR-FLD-CIN SECTION.
       INI-CLR-FLD-CIN.
           MOVE SPACES TO FRM-GLS-SIST IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-EVEN IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CIN1 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CIN2 IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-VIGE IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-UTPT IN CIN-FLD.
           MOVE ZEROES TO FRM-NUM-NCOL IN CIN-FLD.
           MOVE ZEROES TO FRM-NUM-NFIL IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-BCTI IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-PBTI IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-BPBT IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-SPBT IN CIN-FLD.
           MOVE SPACES TO FRM-GLS-UTPR IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT1 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT2 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT3 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT4 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR1 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR2 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR3 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR4 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT5 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT6 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT7 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-CPT8 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR5 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR6 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR7 IN CIN-FLD.
           MOVE SPACES TO FRM-COD-OPR8 IN CIN-FLD.
           PERFORM CLR-CIN-CIN.
       FIN-CLR-FLD-CIN.
           EXIT.
       
       CLR-CIN-CIN SECTION.
       INI-CLR-CIN-CIN.
           MOVE SPACES TO CIN-IND-VIGE IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-UTPT IN CIN-FLD.
           MOVE SPACES TO CIN-CAI-IPTI IN CIN-FLD.
           MOVE SPACES TO CIN-IIC-IPTI IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-BCTI IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-PBTI IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-BPBT IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-SPBT IN CIN-FLD.
           MOVE SPACES TO CIN-COD-CVTI IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-TFPR IN CIN-FLD.
           MOVE ZEROES TO CIN-NUM-PREP IN CIN-FLD.
           MOVE SPACES TO CIN-MSC-UTPR IN CIN-FLD.
       FIN-CLR-CIN-CIN.
           EXIT.
       
       FST-KEY-CIN SECTION.
       INI-FST-KEY-CIN.
           MOVE -1 TO CIN-CAI-ICIN-LEN IN CIN-FLD.
       FIN-FST-KEY-CIN.
           EXIT.
       
       FST-FLD-CIN SECTION.
       INI-FST-FLD-CIN.
           MOVE -1 TO FRM-COD-CIN1-LEN IN CIN-FLD.
       FIN-FST-FLD-CIN.
           EXIT.
       
       PRO-KEY-CIN SECTION.
       INI-PRO-KEY-CIN.
           PERFORM PRO-IKY-CIN.
           PERFORM PRO-AKY-CIN.
           PERFORM PRO-MKY-CIN.
       FIN-PRO-KEY-CIN.
           EXIT.
       
       PRO-IKY-CIN SECTION.
       INI-PRO-IKY-CIN.
           MOVE FRM-CPIM-AEY TO CIN-CAI-ICIN-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-IIC-ICIN-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-COD-SIST-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-COD-EVEN-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-IND-TPLT-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-FEC-FINI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-HRA-HINI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-AEY TO CIN-COD-VCOC-ATR IN CIN-FLD.
       FIN-PRO-IKY-CIN.
           EXIT.
       
       PRO-MKY-CIN SECTION.
       INI-PRO-MKY-CIN.
       FIN-PRO-MKY-CIN.
           EXIT.
       
       PRO-AKY-CIN SECTION.
       INI-PRO-AKY-CIN.
       FIN-PRO-AKY-CIN.
           EXIT.
       
       UNP-KEY-CIN SECTION.
       INI-UNP-KEY-CIN.
           PERFORM UNP-IKY-CIN.
           PERFORM UNP-AKY-CIN.
           PERFORM UNP-MKY-CIN.
       FIN-UNP-KEY-CIN.
           EXIT.
       
       UNP-IKY-CIN SECTION.
       INI-UNP-IKY-CIN.
           MOVE FRM-CPIM-UBY TO CIN-CAI-ICIN-ATR.
           MOVE FRM-CPIM-UBY TO CIN-IIC-ICIN-ATR.
           MOVE FRM-CPIM-UBY TO CIN-COD-SIST-ATR.
           MOVE FRM-CPIM-UBY TO CIN-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO CIN-IND-TPLT-ATR.
           MOVE FRM-CPIM-UBY TO CIN-FEC-FINI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-HRA-HINI-ATR.
           MOVE FRM-CPIM-UBY TO CIN-COD-VCOC-ATR.
       FIN-UNP-IKY-CIN.
           EXIT.
       
       UNP-MKY-CIN SECTION.
       INI-UNP-MKY-CIN.
       FIN-UNP-MKY-CIN.
           EXIT.
       
       UNP-AKY-CIN SECTION.
       INI-UNP-AKY-CIN.
       FIN-UNP-AKY-CIN.
           EXIT.
       
       UNP-FLD-CIN SECTION.
       INI-UNP-FLD-CIN.
      *<<<< INI_UNP_FLD_CIN
           MOVE FRM-CPIM-UBY TO FRM-COD-CIN1-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CIN2-ATR IN CIN-FLD.
           IF (CIN-IND-TPLT IN CIN-FLD = 'P')
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT1-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT2-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT3-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT4-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR1-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR2-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR3-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR4-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT5-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT6-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT7-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT8-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR5-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR6-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR7-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR8-ATR IN CIN-FLD.
      *PVG INI 23-ENE-2012
           IF (CIN-IND-TPLT IN CIN-FLD = '%' OR 'M' OR 'X' OR 'Y')
              MOVE FRM-CPIM-UBY TO FRM-COD-CPT3-ATR IN CIN-FLD
              MOVE FRM-CPIM-UBY TO FRM-COD-OPR3-ATR IN CIN-FLD.
      *PVG FIN 23-ENE-2012
           PERFORM UNP-CIN-CIN.
           GO TO FIN-UNP-FLD-CIN.
      *>>>>
           MOVE FRM-CPIM-UBY TO FRM-COD-CIN1-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CIN2-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT1-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT2-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT3-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT4-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR1-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR2-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR3-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR4-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT5-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT6-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT7-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPT8-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR5-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR6-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR7-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPR8-ATR IN CIN-FLD.
           PERFORM UNP-CIN-CIN.
       FIN-UNP-FLD-CIN.
           EXIT.
       
       UNP-CIN-CIN SECTION.
       INI-UNP-CIN-CIN.
      *<<<< INI_UNP_CIN_CIN
           MOVE FRM-CPIM-UBY TO CIN-MSC-UTPT-ATR IN CIN-FLD.
           IF NOT (CIN-IND-TPLT IN CIN-FLD = 'P' OR 'T' OR 'Z')
              GO TO FIN-UNP-CIN-CIN.
           MOVE FRM-CPIM-UBY TO CIN-MSC-BCTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-PBTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-BPBT-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-SPBT-ATR IN CIN-FLD.
           IF (CIN-IND-TPLT IN CIN-FLD NOT = 'P')
              GO TO FIN-UNP-CIN-CIN.
           MOVE FRM-CPIM-UBY TO CIN-COD-CVTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-TFPR-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-NUM-PREP-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-UTPR-ATR IN CIN-FLD.
           GO TO FIN-UNP-CIN-CIN.
      *>>>>
           MOVE FRM-CPIM-UBY TO CIN-MSC-UTPT-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-BCTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-PBTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-BPBT-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-SPBT-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-COD-CVTI-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-TFPR-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-NUM-PREP-ATR IN CIN-FLD.
           MOVE FRM-CPIM-UBY TO CIN-MSC-UTPR-ATR IN CIN-FLD.
       FIN-UNP-CIN-CIN.
           EXIT.
       
       VAL-KEY-CIN SECTION.
       INI-VAL-KEY-CIN.
           PERFORM VAL-IKY-CIN.
           PERFORM VAL-MKY-CIN.
           PERFORM VAL-AKY-CIN.
       FIN-VAL-KEY-CIN.
           EXIT.
       
       VAL-IKY-CIN SECTION.
       INI-VAL-IKY-CIN.
           PERFORM VAL-CIN-CAI-ICIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-CAI-ICIN-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
           PERFORM VAL-CIN-IIC-ICIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-IIC-ICIN-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
           PERFORM VAL-CIN-COD-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-COD-SIST-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
           PERFORM VAL-CIN-COD-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-COD-EVEN-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
           PERFORM VAL-CIN-IND-TPLT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-IND-TPLT-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIN-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CIN-FEC-FINI-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIN-HRA-HINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-HRA-HINI-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
           PERFORM VAL-CIN-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIN-COD-VCOC-LEN IN CIN-FLD
                GO TO FIN-VAL-IKY-CIN.
       FIN-VAL-IKY-CIN.
           EXIT.
       
       VAL-MKY-CIN SECTION.
       INI-VAL-MKY-CIN.
       FIN-VAL-MKY-CIN.
           EXIT.
       
       VAL-AKY-CIN SECTION.
       INI-VAL-AKY-CIN.
       FIN-VAL-AKY-CIN.
           EXIT.
       
       VAL-CIN-CAI-ICIN SECTION.
       INI-VAL-CIN-CAI-ICIN.
           IF CIN-CAI-ICIN IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-CAI-ICIN.
       FIN-VAL-CIN-CAI-ICIN.
           EXIT.
       
       VAL-CIN-IIC-ICIN SECTION.
       INI-VAL-CIN-IIC-ICIN.
           IF CIN-IIC-ICIN IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-IIC-ICIN.
       FIN-VAL-CIN-IIC-ICIN.
           EXIT.
       
       VAL-CIN-COD-SIST SECTION.
       INI-VAL-CIN-COD-SIST.
           IF CIN-COD-SIST IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-COD-SIST.
      *<<<< CIN_COD_SIST                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CIN-COD-SIST IN CIN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE SPACES       TO FRM-GLS-SIST IN CIN-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN CIN-FLD.      
      *>>>>                                                             
       FIN-VAL-CIN-COD-SIST.
           EXIT.
       
       VAL-CIN-COD-EVEN SECTION.
       INI-VAL-CIN-COD-EVEN.
           IF CIN-COD-EVEN IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-COD-EVEN.
      *<<<<
      *VAL-COD Valida codigo de tabla                                   
           IF CIN-COD-EVEN IN CIN-FLD > SPACES                          
              MOVE 'MC2'                   TO TAB-COD-SIST              
              MOVE 'EVT'                   TO TAB-COD-TTAB IN TAB       
              MOVE CIN-COD-SIST IN CIN-FLD  TO WSS-COD-SIST IN WSS-VARI 
              MOVE CIN-COD-EVEN IN CIN-FLD  TO WSS-COD-EVTO IN WSS-VARI 
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB      
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'            
                 MOVE SPACES       TO FRM-GLS-EVEN IN CIN-FLD           
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN CIN-FLD.   
      *>>>>                                                             
       FIN-VAL-CIN-COD-EVEN.
           EXIT.
       
       VAL-CIN-IND-TPLT SECTION.
       INI-VAL-CIN-IND-TPLT.
      *<<<< INI_CIN_IND_TPLT                                            
           IF CIN-IND-TPLT IN CIN-FLD NOT > SPACES                      
              MOVE 'P'    TO CIN-IND-TPLT IN CIN-FLD.                   
      *>>>>                                                             
           IF CIN-IND-TPLT IN CIN-FLD NOT > SPACES
              MOVE SPACES TO CIN-IND-TPLT IN CIN-FLD.
      *<<<< FIN_CIN_IND_TPLT                                            
           IF CIN-IND-TPLT IN CIN-FLD NOT > SPACES                      
              MOVE 'P'    TO CIN-IND-TPLT IN CIN-FLD.                   
                                                                        
           MOVE 'MC2'                    TO TAB-COD-SIST.               
           MOVE 'TDP'                    TO TAB-COD-TTAB IN TAB.        
           MOVE CIN-IND-TPLT IN CIN-FLD  TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-TAB.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
      *PVG INI 23-ENE-2012
              OR CIN-IND-TPLT IN CIN-FLD = 'U'
      *PVG FIN 23-ENE-2012
              MOVE 'GNS'        TO MSG-COD-SIST                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'ERR    TDP' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1                      
              MOVE FRM-SUAR-MAL TO FRM-SUAR.                            
      *>>>>                                                             
       FIN-VAL-CIN-IND-TPLT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CIN-FEC-FINI SECTION.
       INI-VAL-CIN-FEC-FINI.
           IF CIN-FEC-FINI IN CIN-FLD  NOT > ZEROES
              MOVE ZEROES TO CIN-FEC-FINI IN CIN-FLD.
      *VAL-FEC Validar Fecha
           MOVE CIN-FEC-FINI IN CIN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CIN_FEC_FINI                                            
           MOVE FEC-CHOY-N  TO FEC-CHOY.                                
           IF SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA'               
              MOVE FEC-CHOY-GE TO FEC-CHOY.                             
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
           IF CIN-FEC-FINI IN CIN-FLD NOT > ZEROES                      
              PERFORM GET-FHOY                                          
              MOVE HOY-DHOY IN HOY-VARI TO CIN-NUM-DINI IN CIN-FLD      
              MOVE HOY-MHOY IN HOY-VARI TO CIN-NUM-MINI IN CIN-FLD      
              MOVE HOY-SHOY IN HOY-VARI TO CIN-NUM-SINI IN CIN-FLD      
              MOVE HOY-AHOY IN HOY-VARI TO CIN-NUM-AINI IN CIN-FLD      
              IF CIN-HRA-HINI IN CIN-FLD NOT > ZEROES                   
                 MOVE HOY-HHOY IN HOY-VARI TO CIN-HRA-HINI IN CIN-FLD   
                 GO TO FIN-VAL-CIN-FEC-FINI                             
              ELSE                                                      
                 GO TO FIN-VAL-CIN-FEC-FINI.                            
      *>>>>                                                             
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIN-FEC-FINI IN CIN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CIN-FEC-FINI.
       FIN-VAL-CIN-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CIN-HRA-HINI SECTION.
       INI-VAL-CIN-HRA-HINI.
           IF CIN-HRA-HINI IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-HRA-HINI.
      *<<<< INI_CIN_HRA_HINI                                            
      *OGB-INI 17-MAY-2018 GESTOR PRECIOS DAP 
           IF CIN-HRA-HINI IN CIN-FLD IS NOT NUMERIC
               MOVE 'MC2'         TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CIN-HRA-HINI.
      *OGB-FIN 17-MAY-2018 GESTOR PRECIOS DAP 

           IF CIN-HRA-HINI IN CIN-FLD NOT > ZEROES                      
              PERFORM GET-FHOY                                          
              MOVE HOY-HHOY IN HOY-VARI TO CIN-HRA-HINI IN CIN-FLD      
              GO TO FIN-VAL-CIN-HRA-HINI.                               
                                                                        
           MOVE CIN-HRA-HINI IN CIN-FLD TO CIN-HRA-HINI IN CIN.         
           IF CIN-NUM-HHIN IN CIN < ZEROES OR                           
              CIN-NUM-HHIN IN CIN > 23                                  
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CIN-HRA-HINI.                              
           IF CIN-NUM-MMIN IN CIN < ZEROES OR                           
              CIN-NUM-MMIN IN CIN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CIN-HRA-HINI.                              
           IF CIN-NUM-SSIN IN CIN < ZEROES OR                           
              CIN-NUM-SSIN IN CIN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CIN-HRA-HINI.                              
      *>>>>                                                             
       FIN-VAL-CIN-HRA-HINI.
           EXIT.
       
       VAL-CIN-COD-VCOC SECTION.
       INI-VAL-CIN-COD-VCOC.
           IF CIN-COD-VCOC IN CIN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIN-COD-VCOC.
      *<<<< CIN_COD_VCOC                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CIN-COD-VCOC IN CIN-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE SPACES       TO FRM-GLS-VCOC IN CIN-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN CIN-FLD.      
      *>>>>                                                             
       FIN-VAL-CIN-COD-VCOC.
           EXIT.
       
       VAL-CON-KEY-CIN SECTION.
       INI-VAL-CON-KEY-CIN.
           IF     CIN-CAI-ICIN IN CIN-FLD NOT > SPACES 
              AND CIN-IIC-ICIN IN CIN-FLD NOT > SPACES 
              AND CIN-COD-SIST IN CIN-FLD NOT > SPACES 
              AND CIN-COD-EVEN IN CIN-FLD NOT > SPACES 
              AND CIN-IND-TPLT IN CIN-FLD NOT > SPACES 
              AND CIN-FEC-FINI IN CIN-FLD NOT > ZEROES
              AND CIN-HRA-HINI IN CIN-FLD NOT > SPACES 
              AND CIN-COD-VCOC IN CIN-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CIN.
       FIN-VAL-CON-KEY-CIN.
           EXIT.
       
       VAL-CON-IKY-CIN SECTION.
       INI-VAL-CON-IKY-CIN.
           IF     CIN-CAI-ICIN IN CIN-FLD NOT > SPACES 
              AND CIN-IIC-ICIN IN CIN-FLD NOT > SPACES 
              AND CIN-COD-SIST IN CIN-FLD NOT > SPACES 
              AND CIN-COD-EVEN IN CIN-FLD NOT > SPACES 
              AND CIN-IND-TPLT IN CIN-FLD NOT > SPACES 
              AND CIN-FEC-FINI IN CIN-FLD NOT > ZEROES
              AND CIN-HRA-HINI IN CIN-FLD NOT > SPACES 
              AND CIN-COD-VCOC IN CIN-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CIN.
       FIN-VAL-CON-IKY-CIN.
           EXIT.
       
       VAL-NUM-KEY-CIN SECTION.
       INI-VAL-NUM-KEY-CIN.
           PERFORM VAL-NUM-IKY-CIN.
           PERFORM VAL-NUM-MKY-CIN.
           PERFORM VAL-NUM-AKY-CIN.
       FIN-VAL-NUM-KEY-CIN.
           EXIT.
       
       VAL-NUM-IKY-CIN SECTION.
       INI-VAL-NUM-IKY-CIN.
       FIN-VAL-NUM-IKY-CIN.
           EXIT.
       
       VAL-NUM-MKY-CIN SECTION.
       INI-VAL-NUM-MKY-CIN.
       FIN-VAL-NUM-MKY-CIN.
           EXIT.
       
       VAL-NUM-AKY-CIN SECTION.
       INI-VAL-NUM-AKY-CIN.
       FIN-VAL-NUM-AKY-CIN.
           EXIT.
       
       VAL-NUM-FLD-CIN SECTION.
       INI-VAL-NUM-FLD-CIN.
       VAL-NUM-FRM-NUM-NCOL.
           MOVE FRM-NUM-NCOL-ALF IN CIN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-NCOL IN CIN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-NCOL-LEN IN CIN-FLD
                GO TO FIN-VAL-NUM-FLD-CIN.
       VAL-NUM-FRM-NUM-NFIL.
           MOVE FRM-NUM-NFIL-ALF IN CIN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-NFIL IN CIN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-NFIL-LEN IN CIN-FLD
                GO TO FIN-VAL-NUM-FLD-CIN.
       VAL-NUM-CIN-NUM-PREP.
           MOVE CIN-NUM-PREP-ALF IN CIN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIN-NUM-PREP IN CIN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIN-NUM-PREP-LEN IN CIN-FLD
                GO TO FIN-VAL-NUM-FLD-CIN.
       FIN-VAL-NUM-FLD-CIN.
           EXIT.
       
       EDT-KEY-CIN SECTION.
       INI-EDT-KEY-CIN.
           PERFORM EDT-IKY-CIN.
           PERFORM EDT-MKY-CIN.
           PERFORM EDT-AKY-CIN.
       FIN-EDT-KEY-CIN.
           EXIT.
       
       EDT-IKY-CIN SECTION.
       INI-EDT-IKY-CIN.
       FIN-EDT-IKY-CIN.
           EXIT.
       
       EDT-MKY-CIN SECTION.
       INI-EDT-MKY-CIN.
       FIN-EDT-MKY-CIN.
           EXIT.
       
       EDT-AKY-CIN SECTION.
       INI-EDT-AKY-CIN.
       FIN-EDT-AKY-CIN.
           EXIT.
       
       EDT-FLD-CIN SECTION.
       INI-EDT-FLD-CIN.
           IF FRM-NUM-NCOL-LEN IN CIN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NCOL-LEN IN CIN-FLD
                GO TO FIN-EDT-FLD-CIN.
           MOVE FRM-NUM-NCOL IN CIN-FLD TO FRM-NUM-NCOL-EDT IN CIN-EDT.
           MOVE FRM-NUM-NCOL-EDT IN CIN-EDT TO 
                FRM-NUM-NCOL-ALF IN CIN-FLD.
           IF FRM-NUM-NFIL-LEN IN CIN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NFIL-LEN IN CIN-FLD
                GO TO FIN-EDT-FLD-CIN.
           MOVE FRM-NUM-NFIL IN CIN-FLD TO FRM-NUM-NFIL-EDT IN CIN-EDT.
           MOVE FRM-NUM-NFIL-EDT IN CIN-EDT TO 
                FRM-NUM-NFIL-ALF IN CIN-FLD.
           IF CIN-NUM-PREP-LEN IN CIN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIN-NUM-PREP-LEN IN CIN-FLD
                GO TO FIN-EDT-FLD-CIN.
           MOVE CIN-NUM-PREP IN CIN-FLD TO CIN-NUM-PREP-EDT IN CIN-EDT.
           MOVE CIN-NUM-PREP-EDT IN CIN-EDT TO 
                CIN-NUM-PREP-ALF IN CIN-FLD.
       FIN-EDT-FLD-CIN.
           EXIT.
      *<<<<                                                             
       OBT-COL-FIL SECTION.                                             
       INI-OBT-COL-FIL.                                                 
           MOVE CIN-CIC-IPTI IN CIN TO PTI-CIC-IPTI IN PTI.             
           MOVE 'X01'               TO PTI-COD-TVAL IN PTI.             
           MOVE ZEROES              TO PTI-VAL-MNTO IN PTI.             
           MOVE ZEROES              TO PTI-NUM-PLZO IN PTI.             
           MOVE FIO-GET-NLS         TO FIO-CMND.                        
       LUP-OBT-COL-FIL.                                                 
           PERFORM MC2-FIO-PTI.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              PTI-CIC-IPTI IN PTI = CIN-CIC-IPTI IN CIN )               
              GO TO FIN-OBT-COL-FIL.                                    
           IF PTI-COD-TVAL IN PTI = 'X01'                               
              PERFORM CRG-VAL-MTPZ                                      
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X02'                               
              MOVE 1 TO WSS-NUM-NCOL-X02                                
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X03'                               
              MOVE 1 TO WSS-NUM-NCOL-X03                                
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X04'                               
              MOVE 1 TO WSS-NUM-NFIL-X04                                
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X05'                               
              MOVE 1 TO WSS-NUM-NCOL-X05                                
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X06'                               
              MOVE 1 TO WSS-NUM-NCOL-X06                                
           ELSE                                                         
           IF PTI-COD-TVAL IN PTI = 'X07'                               
              MOVE 1 TO WSS-NUM-NFIL-X07.                               
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-OBT-COL-FIL.                                       
       FIN-OBT-COL-FIL.                                                 
           COMPUTE WSS-NUM-NCOL = (WSS-NUM-NCOL     +                   
                                   WSS-NUM-NCOL-X02 +                   
                                   WSS-NUM-NCOL-X03 +                   
                                   WSS-NUM-NCOL-X05 +                   
                                   WSS-NUM-NCOL-X06).                   
                                                                        
           COMPUTE WSS-NUM-NFIL = (WSS-NUM-NFIL     +                   
                                   WSS-NUM-NFIL-X04 +                   
                                   WSS-NUM-NFIL-X07).                   
       EXT-OBT-COL-FIL.                                                 
           EXIT.                                                        
                                                                        
       CRG-VAL-MTPZ SECTION.                                            
       INI-CRG-VAL-MTPZ.                                                
           MOVE ZEROES TO WSS-MNTO.                                     
       LUP-CRG-VAL-MNTO.                                                
           ADD 1 TO WSS-MNTO.                                           
           IF WSS-CIN-MNTO(WSS-MNTO) NOT > ZEROES                       
              MOVE PTI-VAL-MNTO IN PTI TO WSS-CIN-MNTO(WSS-MNTO)        
              ADD 1                    TO WSS-NUM-NCOL IN WSS-VARI      
              GO TO CNT-CRG-VAL-MTPZ.                                   
           IF WSS-CIN-MNTO(WSS-MNTO) = PTI-VAL-MNTO IN PTI              
              GO TO CNT-CRG-VAL-MTPZ.                                   
           GO TO LUP-CRG-VAL-MNTO.                                      
       CNT-CRG-VAL-MTPZ.                                                
           MOVE ZEROES TO WSS-PLZO.                                     
       LUP-CRG-VAL-PLZO.                                                
           ADD 1 TO WSS-PLZO.                                           
           IF WSS-CIN-PLZO(WSS-PLZO) NOT > ZEROES                       
              MOVE PTI-NUM-PLZO IN PTI TO WSS-CIN-PLZO(WSS-PLZO)        
              ADD 1                    TO WSS-NUM-NFIL IN WSS-VARI      
              GO TO FIN-CRG-VAL-MTPZ.                                   
           IF WSS-CIN-PLZO(WSS-PLZO) = PTI-NUM-PLZO IN PTI              
              GO TO FIN-CRG-VAL-MTPZ.                                   
           GO TO LUP-CRG-VAL-PLZO.                                      
       FIN-CRG-VAL-MTPZ.                                                
           EXIT.                                                        
      *PVG INI 29-JUN-2007 TRF                                          
       OBT-COL-FIL-TRF SECTION.                                         
       INI-OBT-COL-FIL-TRF.                                             
           MOVE CIN-IIC-ICIN  IN CIN      TO QUE-COLA.                  
           MOVE MCT-LEN-TSMCT IN MCT-VARI TO QUE-LITM.                  
           MOVE +2                        TO QUE-NITM.                  
           MOVE QUE-GET                   TO QUE-CMND.                  
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE '00'     TO FIO-STAT                                 
              MOVE QUE-ITEM TO MCT-DAT-I IN MCT-VARI                    
              PERFORM CRG-TRF-CIN                                       
              GO TO CNT-OBT-COL-FIL-TRF                                 
           ELSE                                                         
              MOVE '23' TO FIO-STAT                                     
              GO TO EXT-OBT-COL-FIL-TRF.                                
                                                                        
       CNT-OBT-COL-FIL-TRF.                                             
           MOVE ZEROES TO MCT-P IN MCT-VARI.                            
       LUP-OBT-COL-FIL-TRF.                                             
           ADD 1 TO MCT-P IN MCT-VARI.                                  
           IF MCT-P IN MCT-VARI > MCT-PMAX IN MCT-VARI                  
              GO TO FIN-OBT-COL-FIL-TRF.                                
           IF MCT-VAL-MNTO-I(MCT-P IN MCT-VARI) NOT > ZEROES            
              GO TO FIN-OBT-COL-FIL-TRF.                                
                                                                        
           MOVE MCT-VAL-MNTO-I(MCT-P IN MCT-VARI) TO                    
                PTI-VAL-MNTO IN PTI.                                    
           MOVE MCT-NUM-PLZO-I(MCT-P IN MCT-VARI) TO                    
                PTI-NUM-PLZO IN PTI.                                    
           PERFORM CRG-VAL-MTPZ.                                        
           GO TO LUP-OBT-COL-FIL-TRF.                                   
       FIN-OBT-COL-FIL-TRF.                                             
           COMPUTE WSS-NUM-NCOL = (WSS-NUM-NCOL     +                   
                                   WSS-NUM-NCOL-X02 +                   
                                   WSS-NUM-NCOL-X03 +                   
                                   WSS-NUM-NCOL-X05 +                   
                                   WSS-NUM-NCOL-X06).                   
                                                                        
           COMPUTE WSS-NUM-NFIL = (WSS-NUM-NFIL     +                   
                                   WSS-NUM-NFIL-X04 +                   
                                   WSS-NUM-NFIL-X07).                   
           MOVE WSS-NUM-NCOL IN WSS-VARI TO FRM-NUM-NCOL IN CIN-FLD.    
           MOVE WSS-NUM-NFIL IN WSS-VARI TO FRM-NUM-NFIL IN CIN-FLD.    
       EXT-OBT-COL-FIL-TRF.                                             
           EXIT.                                                        
      *PVG FIN 29-JUN-2007                                              
      *>>>>                                                             
