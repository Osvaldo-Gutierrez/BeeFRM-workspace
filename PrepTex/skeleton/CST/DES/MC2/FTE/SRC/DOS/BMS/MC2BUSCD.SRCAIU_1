      *
      * MC2BUSCD
      * Version 3.0.1 Nov-2005
      * 13-May-19 03:30 PM
      *
       SET-TAG-MC2BUSCD SECTION.
       INI-SET-TAG-MC2BUSCD.
           MOVE
           '<IDNMOD NOM=$MC2BUSCD$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$13-May-19 03:30 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BUSCD.
           EXIT.
           
       RET-ALL-SCD SECTION.
       INI-RET-ALL-SCD.
           PERFORM KEY-ALL-SCD.
           PERFORM RET-SCD-SCD.
           PERFORM RET-OPC-SCD.
           PERFORM RET-DBC-SCD.
       FIN-RET-ALL-SCD.
           EXIT.
       
       RET-SCD-SCD SECTION.
       INI-RET-SCD-SCD.
           MOVE SCD-COD-TOOC IN SCD-FLD TO SCD-COD-TOOC IN SCD.
           MOVE SCD-COD-AOOC IN SCD-FLD TO SCD-COD-AOOC IN SCD.
           MOVE SCD-MSC-STAT IN SCD-FLD TO SCD-MSC-STAT IN SCD.
           MOVE SCD-COD-CLSE IN SCD-FLD TO SCD-COD-CLSE IN SCD.
           MOVE SCD-COD-ICCS IN SCD-FLD TO SCD-COD-ICCS IN SCD.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SCD-NUM-DCTO IN SCD-FLD TO SCD-NUM-DCTO IN SCD.
           MOVE SCD-NUM-MCTO IN SCD-FLD TO SCD-NUM-MCTO IN SCD.
           MOVE SCD-NUM-SCTO IN SCD-FLD TO SCD-NUM-SCTO IN SCD.
           MOVE SCD-NUM-ACTO IN SCD-FLD TO SCD-NUM-ACTO IN SCD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SCD-NUM-DINI IN SCD-FLD TO SCD-NUM-DINI IN SCD.
           MOVE SCD-NUM-MINI IN SCD-FLD TO SCD-NUM-MINI IN SCD.
           MOVE SCD-NUM-SINI IN SCD-FLD TO SCD-NUM-SINI IN SCD.
           MOVE SCD-NUM-AINI IN SCD-FLD TO SCD-NUM-AINI IN SCD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SCD-NUM-DFIN IN SCD-FLD TO SCD-NUM-DFIN IN SCD.
           MOVE SCD-NUM-MFIN IN SCD-FLD TO SCD-NUM-MFIN IN SCD.
           MOVE SCD-NUM-SFIN IN SCD-FLD TO SCD-NUM-SFIN IN SCD.
           MOVE SCD-NUM-AFIN IN SCD-FLD TO SCD-NUM-AFIN IN SCD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SCD-COD-VCOC IN SCD-FLD TO SCD-COD-VCOC IN SCD.
           MOVE SCD-SGV-MNTO IN SCD-FLD TO SCD-SGV-MNTO IN SCD.
           MOVE SCD-SGV-VCUO IN SCD-FLD TO SCD-SGV-VCUO IN SCD.
      *<<<<<< FIN_RET_SCD_SCD
           MOVE SCR-CIC-ICLI IN SCR-VARI TO SCD-CIC-ICLI IN SCD.
      *>>>>>>
       FIN-RET-SCD-SCD.
           EXIT.
       
       RET-OPC-SCD SECTION.
       INI-RET-OPC-SCD.
           MOVE OPC-COD-TOOC IN SCD-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-AOOC IN SCD-FLD TO OPC-COD-AOOC IN OPC.
       FIN-RET-OPC-SCD.
           EXIT.
       
       RET-DBC-SCD SECTION.
       INI-RET-DBC-SCD.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN SCD-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SCD-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SCD-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SCD-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-GLS-NOMC IN SCD-FLD TO DBC-GLS-NOMC IN DBC.
       FIN-RET-DBC-SCD.
           EXIT.
       
       KEY-ALL-SCD SECTION.
       INI-KEY-ALL-SCD.
           PERFORM KEY-SCD-SCD.
           PERFORM KEY-OPC-SCD.
           PERFORM KEY-DBC-SCD.
       FIN-KEY-ALL-SCD.
           EXIT.
       
       KEY-SCD-SCD SECTION.
       INI-KEY-SCD-SCD.
           MOVE SCD-CAI-IOPC IN SCD-FLD TO SCD-CAI-IOPC IN SCD.
           MOVE SCD-IIC-IOPC IN SCD-FLD TO SCD-IIC-IOPC IN SCD.
           MOVE SCD-NUM-SEGU IN SCD-FLD TO SCD-NUM-SEGU IN SCD.
       FIN-KEY-SCD-SCD.
           EXIT.
       
       KEY-OPC-SCD SECTION.
       INI-KEY-OPC-SCD.
       FIN-KEY-OPC-SCD.
           EXIT.
       
       KEY-DBC-SCD SECTION.
       INI-KEY-DBC-SCD.
       FIN-KEY-DBC-SCD.
           EXIT.
       
       SCR-CLRA-SCD SECTION.
       INI-SCR-CLRA-SCD.
           PERFORM CLR-KEY-SCD.
           PERFORM CLR-FLD-SCD.
       FIN-SCR-CLRA-SCD.
           EXIT.
       
       CLR-KEY-SCD SECTION.
       INI-CLR-KEY-SCD.
           MOVE SPACES TO SCD-CAI-IOPC IN SCD-FLD.
           MOVE ZEROES TO SCD-IIC-IOPC IN SCD-FLD.
           MOVE ZEROES TO SCD-NUM-SEGU IN SCD-FLD.
       FIN-CLR-KEY-SCD.
           EXIT.
       
       CLR-FLD-SCD SECTION.
       INI-CLR-FLD-SCD.
           MOVE SPACES TO FRM-GLS-TOOC IN SCD-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN SCD-FLD.
           MOVE SPACES TO FRM-GLS-TOOS IN SCD-FLD.
           MOVE SPACES TO FRM-GLS-AOOS IN SCD-FLD.
           MOVE SPACES TO FRM-COD-TDEU IN SCD-FLD.
           MOVE SPACES TO FRM-GLS-ICIA IN SCD-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN SCD-FLD.
           PERFORM CLR-SCD-SCD.
           PERFORM CLR-OPC-SCD.
           PERFORM CLR-DBC-SCD.
       FIN-CLR-FLD-SCD.
           EXIT.
       
       CLR-SCD-SCD SECTION.
       INI-CLR-SCD-SCD.
           MOVE SPACES TO SCD-COD-TOOC IN SCD-FLD.
           MOVE SPACES TO SCD-COD-AOOC IN SCD-FLD.
           MOVE SPACES TO SCD-MSC-STAT IN SCD-FLD.
           MOVE SPACES TO SCD-COD-CLSE IN SCD-FLD.
           MOVE SPACES TO SCD-COD-ICCS IN SCD-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SCD-FEC-FCTO IN SCD-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SCD-FEC-FINI IN SCD-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SCD-FEC-FFIN IN SCD-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO SCD-COD-VCOC IN SCD-FLD.
           MOVE ZEROES TO SCD-SGV-MNTO IN SCD-FLD.
           MOVE ZEROES TO SCD-SGV-VCUO IN SCD-FLD.
       FIN-CLR-SCD-SCD.
           EXIT.
       
       CLR-OPC-SCD SECTION.
       INI-CLR-OPC-SCD.
           MOVE SPACES TO OPC-COD-TOOC IN SCD-FLD.
           MOVE SPACES TO OPC-COD-AOOC IN SCD-FLD.
       FIN-CLR-OPC-SCD.
           EXIT.
       
       CLR-DBC-SCD SECTION.
       INI-CLR-DBC-SCD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN SCD-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN SCD-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN SCD-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN SCD-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DBC-GLS-NOMC IN SCD-FLD.
       FIN-CLR-DBC-SCD.
           EXIT.
       
       FST-KEY-SCD SECTION.
       INI-FST-KEY-SCD.
           MOVE -1 TO SCD-CAI-IOPC-LEN IN SCD-FLD.
       FIN-FST-KEY-SCD.
           EXIT.
       
       FST-FLD-SCD SECTION.
       INI-FST-FLD-SCD.
           MOVE -1 TO SCD-COD-TOOC-LEN IN SCD-FLD.
       FIN-FST-FLD-SCD.
           EXIT.
       
       PRO-KEY-SCD SECTION.
       INI-PRO-KEY-SCD.
           PERFORM PRO-MKY-SCD.
       FIN-PRO-KEY-SCD.
           EXIT.
       
       PRO-MKY-SCD SECTION.
       INI-PRO-MKY-SCD.
       FIN-PRO-MKY-SCD.
           EXIT.
       
       PRO-FLD-SCD SECTION.
       INI-PRO-FLD-SCD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-VCOC-ATR IN SCD-FLD.
           PERFORM PRO-SCD-SCD.
           PERFORM PRO-OPC-SCD.
           PERFORM PRO-DBC-SCD.
       FIN-PRO-FLD-SCD.
           EXIT.
       
       PRO-SCD-SCD SECTION.
       INI-PRO-SCD-SCD.
           MOVE FRM-CPIM-AEY TO SCD-COD-TOOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-COD-AOOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-COD-CLSE-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-COD-ICCS-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-FEC-FCTO-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-FEC-FINI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-FEC-FFIN-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-COD-VCOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-SGV-MNTO-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO SCD-SGV-VCUO-ATR IN SCD-FLD.
       FIN-PRO-SCD-SCD.
           EXIT.
       
       PRO-OPC-SCD SECTION.
       INI-PRO-OPC-SCD.
       FIN-PRO-OPC-SCD.
           EXIT.
       
       PRO-DBC-SCD SECTION.
       INI-PRO-DBC-SCD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SCD-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-DBC-SCD.
           EXIT.
       
       UNP-KEY-SCD SECTION.
       INI-UNP-KEY-SCD.
           PERFORM UNP-IKY-SCD.
           PERFORM UNP-AKY-SCD.
           PERFORM UNP-MKY-SCD.
       FIN-UNP-KEY-SCD.
           EXIT.
       
       UNP-IKY-SCD SECTION.
       INI-UNP-IKY-SCD.
           MOVE FRM-CPIM-UBY TO SCD-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO SCD-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO SCD-NUM-SEGU-ATR.
       FIN-UNP-IKY-SCD.
           EXIT.
       
       UNP-MKY-SCD SECTION.
       INI-UNP-MKY-SCD.
       FIN-UNP-MKY-SCD.
           EXIT.
       
       UNP-AKY-SCD SECTION.
       INI-UNP-AKY-SCD.
       FIN-UNP-AKY-SCD.
           EXIT.
       
       UNP-FLD-SCD SECTION.
       INI-UNP-FLD-SCD.
           PERFORM UNP-SCD-SCD.
           PERFORM UNP-OPC-SCD.
           PERFORM UNP-DBC-SCD.
       FIN-UNP-FLD-SCD.
           EXIT.
       
       UNP-SCD-SCD SECTION.
       INI-UNP-SCD-SCD.
           MOVE FRM-CPIM-UBY TO SCD-COD-TOOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-COD-AOOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-COD-CLSE-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-COD-ICCS-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-FEC-FCTO-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-FEC-FINI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-FEC-FFIN-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-COD-VCOC-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-SGV-MNTO-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO SCD-SGV-VCUO-ATR IN SCD-FLD.
       FIN-UNP-SCD-SCD.
           EXIT.
       
       UNP-OPC-SCD SECTION.
       INI-UNP-OPC-SCD.
       FIN-UNP-OPC-SCD.
           EXIT.
       
       UNP-DBC-SCD SECTION.
       INI-UNP-DBC-SCD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SCD-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SCD-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-DBC-SCD.
           EXIT.
       
       VAL-MKY-SCD SECTION.
       INI-VAL-MKY-SCD.
       FIN-VAL-MKY-SCD.
           EXIT.
       
       VAL-FLD-SCD SECTION.
       INI-VAL-FLD-SCD.
           PERFORM VAL-OPC-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-TOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-OPC-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-COD-AOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-COD-TOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-COD-AOOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-TOOS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOS-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-AOOS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOS-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SCD-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-MSC-STAT-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-COD-TDEU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-TDEU-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-COD-CLSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-COD-CLSE-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-COD-ICCS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-COD-ICCS-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-ICIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ICIA-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SCD-FEC-FCTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                SCD-FEC-FCTO-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SCD-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                SCD-FEC-FINI-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SCD-FEC-FFIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                SCD-FEC-FFIN-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SCD-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-COD-VCOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-SGV-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-SGV-MNTO-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
           PERFORM VAL-SCD-SGV-VCUO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SCD-SGV-VCUO-LEN IN SCD-FLD
                GO TO FIN-VAL-FLD-SCD.
      *<<<<< FIN_VAL_FLD_SCD
           PERFORM VALIDA-OTROS.
      *     IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
      *          MOVE FRM-IND-ERRO TO SCD-SGV-MNTO-LEN IN SCD-FLD
      *          GO TO FIN-VAL-FLD-SCD.
       FIN-VAL-FLD-SCD.
           EXIT.
       
       VAL-OPC-COD-TOOC SECTION.
       INI-VAL-OPC-COD-TOOC.
       FIN-VAL-OPC-COD-TOOC.
           EXIT.
       
       VAL-OPC-COD-AOOC SECTION.
       INI-VAL-OPC-COD-AOOC.
       FIN-VAL-OPC-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
       
       VAL-SCD-COD-TOOC SECTION.
       INI-VAL-SCD-COD-TOOC.
           IF SCD-COD-TOOC IN SCD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-COD-TOOC.
      *>>>>>FIN_SCD_COD_TOOC
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'TSG'                    TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-TOOC IN SCD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.

           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TOOS IN SCD-FLD
               MOVE TAB-CIC-CTAB IN TAB TO WSS-IND-CFAM
           ELSE
               MOVE SPACES TO FRM-GLS-TOOS IN SCD-FLD
               MOVE SPACES TO WSS-IND-CFAM.

      *>>>>> 
       FIN-VAL-SCD-COD-TOOC.
           EXIT.
       
       VAL-SCD-COD-AOOC SECTION.
       INI-VAL-SCD-COD-AOOC.
           IF SCD-COD-AOOC IN SCD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-COD-AOOC.
      *>>>>>FIN_SCD_COD_AOOC
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'TSE'                    TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-AOOC IN SCD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOS IN SCD-FLD
               MOVE TAB-COD-DAT1 IN TAB(4) TO WSS-IND-OBLI
               MOVE TAB-COD-DAT1 IN TAB(1) TO WSS-IND-SEGU
               MOVE TAB-COD-DAT1 IN TAB(2) TO WSS-IND-DIIN
           ELSE
               MOVE SPACES TO FRM-GLS-AOOS IN SCD-FLD
               MOVE SPACES  TO WSS-IND-SEGU
               MOVE SPACES  TO WSS-IND-DIIN
               MOVE SPACES TO WSS-IND-OBLI.

           IF SCR-CMND = 'REN' AND MSG-COD-MENS NOT = 'COD    NEX'
                AND WSS-IND-OBLI = WSS-O
              PERFORM BUSCA-SEGURO-ANT.
      *>>>>> 
       FIN-VAL-SCD-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-TOOS SECTION.
       INI-VAL-FRM-GLS-TOOS.
       FIN-VAL-FRM-GLS-TOOS.
           EXIT.
       
       VAL-FRM-GLS-AOOS SECTION.
       INI-VAL-FRM-GLS-AOOS.
       FIN-VAL-FRM-GLS-AOOS.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN SCD-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN SCD-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN SCD-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN SCD-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<<< FIN_DBC_VRF_ICLI
           MOVE SPACES                  TO FRM-COD-TDEU IN SCD-FLD.

           IF MSG-COD-MENS = SPACES AND                                 
              DBC-NUM-ICLI IN SCD-FLD > ZEROES      
               MOVE DBC-NUM-ICLI IN SCD-FLD
                                 TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN SCD-FLD
                                 TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN SCD-FLD
                                 TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'SGC'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO DBC-GLS-NOMC IN SCD-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-DBC-VRF-ICLI                           
               ELSE                                                     
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN            TO 
                               DBC-GLS-NOMC IN SCD-FLD.
                   MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.

           IF MSG-COD-MENS NOT = SPACES OR
              DBC-NUM-ICLI IN SCD-FLD = ZEROES      
                GO TO FIN-VAL-DBC-VRF-ICLI.

                MOVE WSS-999                 TO SCR-NUM-IDLC.
                MOVE SCR-CIC-ICLI            TO RDC-CIC-ICLI IN RDC.
                MOVE SCD-CAI-IOPC IN SCD-FLD TO RDC-CAI-IOPC IN RDC.
                MOVE SCD-IIC-IOPC IN SCD-FLD TO RDC-IIC-IOPC IN RDC.
                MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
                MOVE FIO-GET-KEY             TO FIO-CMND.
       LUP-VAL-DBC-VRF-ICLI.
                PERFORM COL-FIO-RDC.
                IF FIO-STAT-OKS                                         
                   IF RDC-CAI-IOPC IN RDC = SCD-CAI-IOPC IN SCD-FLD AND
                      RDC-IIC-IOPC IN RDC = SCD-IIC-IOPC IN SCD-FLD 
                       IF RDC-CIC-ICLI IN RDC = SCR-CIC-ICLI
                          MOVE RDC-NUM-IDLC IN RDC TO SCR-NUM-IDLC
                       ELSE
                          MOVE FIO-GET-NXT TO FIO-CMND
                          GO TO LUP-VAL-DBC-VRF-ICLI.
                   
                IF SCR-NUM-IDLC = WSS-999
                    MOVE 'COL'        TO MSG-COD-SIST              
                    MOVE 'RDC   INEX' TO MSG-COD-MENS             
                    PERFORM GET-MSG                                
                    MOVE SPACES       TO DBC-GLS-NOMC IN SCD-FLD   
                    MOVE MSG-GLS-DESC TO FRM-MENS                  
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                ELSE
                   IF SCR-NUM-IDLC = ZEROES
                       MOVE WSS-D TO FRM-COD-TDEU IN SCD-FLD
                   ELSE
                       MOVE WSS-I TO FRM-COD-TDEU IN SCD-FLD.
      *>>>>> 
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN SCD-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN SCD-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN SCD-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN SCD-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN SCD-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SCD-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN SCD-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN SCD-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-SCD-MSC-STAT SECTION.
       INI-VAL-SCD-MSC-STAT.
       FIN-VAL-SCD-MSC-STAT.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-FRM-COD-TDEU SECTION.
       INI-VAL-FRM-COD-TDEU.
       FIN-VAL-FRM-COD-TDEU.
           EXIT.
       
       VAL-SCD-COD-CLSE SECTION.
       INI-VAL-SCD-COD-CLSE.
           IF SCD-COD-CLSE IN SCD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-COD-CLSE.
      *>>>>>FIN_SCD_COD_CLSE
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'CSG'                    TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-CLSE IN SCD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           
      *>>>>> 
       FIN-VAL-SCD-COD-CLSE.
           EXIT.
       
       VAL-SCD-COD-ICCS SECTION.
       INI-VAL-SCD-COD-ICCS.
           IF SCD-COD-ICCS IN SCD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-COD-ICCS.
      *>>>>>FIN_SCD_COD_ICCS
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'CSE'                    TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-ICCS IN SCD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ICIA IN SCD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ICIA IN SCD-FLD.
      *>>>>> 
       FIN-VAL-SCD-COD-ICCS.
           EXIT.
       
       VAL-FRM-GLS-ICIA SECTION.
       INI-VAL-FRM-GLS-ICIA.
       FIN-VAL-FRM-GLS-ICIA.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-SCD-FEC-FCTO SECTION.
       INI-VAL-SCD-FEC-FCTO.
           IF SCD-FEC-FCTO IN SCD-FLD  NOT > ZEROES
              MOVE ZEROES TO SCD-FEC-FCTO IN SCD-FLD.
      *VAL-FEC Validar Fecha
           MOVE SCD-FEC-FCTO IN SCD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>>INI_SCD_FEC_FCTO
           IF SCD-FEC-FCTO IN SCD-FLD  NOT > ZEROES
              PERFORM GET-FHOY                                            
              MOVE HOY-DHOY TO SCD-NUM-DCTO IN SCD-FLD
              MOVE HOY-MHOY TO SCD-NUM-MCTO IN SCD-FLD
              MOVE HOY-SHOY TO SCD-NUM-SCTO IN SCD-FLD
              MOVE HOY-AHOY TO SCD-NUM-ACTO IN SCD-FLD.
      *<<<<<
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO SCD-FEC-FCTO IN SCD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-SCD-FEC-FCTO.
       FIN-VAL-SCD-FEC-FCTO.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-SCD-FEC-FINI SECTION.
       INI-VAL-SCD-FEC-FINI.
           IF SCD-FEC-FINI IN SCD-FLD  NOT > ZEROES
              MOVE ZEROES TO SCD-FEC-FINI IN SCD-FLD.
      *VAL-FEC Validar Fecha
           MOVE SCD-FEC-FINI IN SCD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>>INI_SCD_FEC_FINI
           IF SCD-FEC-FINI IN SCD-FLD  NOT > ZEROES
              PERFORM GET-FHOY                                            
              MOVE HOY-DHOY TO SCD-NUM-DINI IN SCD-FLD
              MOVE HOY-MHOY TO SCD-NUM-MINI IN SCD-FLD
              MOVE HOY-SHOY TO SCD-NUM-SINI IN SCD-FLD
              MOVE HOY-AHOY TO SCD-NUM-AINI IN SCD-FLD.
      *<<<<<
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO SCD-FEC-FINI IN SCD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-SCD-FEC-FINI.
       FIN-VAL-SCD-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-SCD-FEC-FFIN SECTION.
       INI-VAL-SCD-FEC-FFIN.
           IF SCD-FEC-FFIN IN SCD-FLD  NOT > ZEROES
              MOVE ZEROES TO SCD-FEC-FFIN IN SCD-FLD.
      *VAL-FEC Validar Fecha
           MOVE SCD-FEC-FFIN IN SCD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>>INI_SCD_FEC_FFIN
           MOVE FEC-CHOY-GE TO FEC-CHOY.
      *>>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO SCD-FEC-FFIN IN SCD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-SCD-FEC-FFIN.
       FIN-VAL-SCD-FEC-FFIN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-SCD-COD-VCOC SECTION.
       INI-VAL-SCD-COD-VCOC.
           IF SCD-COD-VCOC IN SCD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-COD-VCOC.
      *>>>>>FIN_SCD_COD_VCOC
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'VLR'                    TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-VCOC IN SCD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN SCD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN SCD-FLD.
      *>>>>> 


       FIN-VAL-SCD-COD-VCOC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-SCD-SGV-MNTO SECTION.
       INI-VAL-SCD-SGV-MNTO.
           IF SCD-SGV-MNTO IN SCD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SCD-SGV-MNTO.
       FIN-VAL-SCD-SGV-MNTO.
           EXIT.
       
       VAL-SCD-SGV-VCUO SECTION.
       INI-VAL-SCD-SGV-VCUO.
       FIN-VAL-SCD-SGV-VCUO.
           EXIT.
       
       VAL-CON-FLD-SCD SECTION.
       INI-VAL-CON-FLD-SCD.
       FIN-VAL-CON-FLD-SCD.
           EXIT.
       
       VAL-CON-SCD SECTION.
       INI-VAL-CON-SCD.
       FIN-VAL-CON-SCD.
           EXIT.
       
       VAL-NUM-KEY-SCD SECTION.
       INI-VAL-NUM-KEY-SCD.
           PERFORM VAL-NUM-IKY-SCD.
           PERFORM VAL-NUM-MKY-SCD.
           PERFORM VAL-NUM-AKY-SCD.
       FIN-VAL-NUM-KEY-SCD.
           EXIT.
       
       VAL-NUM-IKY-SCD SECTION.
       INI-VAL-NUM-IKY-SCD.
       VAL-NUM-SCD-IIC-IOPC.
           MOVE SCD-IIC-IOPC-ALF IN SCD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO SCD-IIC-IOPC IN SCD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SCD-IIC-IOPC-LEN IN SCD-FLD
                GO TO FIN-VAL-NUM-IKY-SCD.
       VAL-NUM-SCD-NUM-SEGU.
           MOVE SCD-NUM-SEGU-ALF IN SCD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO SCD-NUM-SEGU IN SCD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SCD-NUM-SEGU-LEN IN SCD-FLD
                GO TO FIN-VAL-NUM-IKY-SCD.
       FIN-VAL-NUM-IKY-SCD.
           EXIT.
       
       VAL-NUM-MKY-SCD SECTION.
       INI-VAL-NUM-MKY-SCD.
       FIN-VAL-NUM-MKY-SCD.
           EXIT.
       
       VAL-NUM-AKY-SCD SECTION.
       INI-VAL-NUM-AKY-SCD.
       FIN-VAL-NUM-AKY-SCD.
           EXIT.
       
       VAL-NUM-FLD-SCD SECTION.
       INI-VAL-NUM-FLD-SCD.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN SCD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN SCD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN SCD-FLD
                GO TO FIN-VAL-NUM-FLD-SCD.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-SCD-SGV-MNTO.
           MOVE SCD-SGV-MNTO-ALF IN SCD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO SCD-SGV-MNTO IN SCD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SCD-SGV-MNTO-LEN IN SCD-FLD
                GO TO FIN-VAL-NUM-FLD-SCD.
       VAL-NUM-SCD-SGV-VCUO.
           MOVE SCD-SGV-VCUO-ALF IN SCD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO SCD-SGV-VCUO IN SCD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SCD-SGV-VCUO-LEN IN SCD-FLD
                GO TO FIN-VAL-NUM-FLD-SCD.
       FIN-VAL-NUM-FLD-SCD.
           EXIT.
       
       EDT-KEY-SCD SECTION.
       INI-EDT-KEY-SCD.
           PERFORM EDT-IKY-SCD.
           PERFORM EDT-MKY-SCD.
           PERFORM EDT-AKY-SCD.
       FIN-EDT-KEY-SCD.
           EXIT.
       
       EDT-IKY-SCD SECTION.
       INI-EDT-IKY-SCD.
           IF SCD-IIC-IOPC-LEN IN SCD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SCD-IIC-IOPC-LEN IN SCD-FLD
                GO TO FIN-EDT-IKY-SCD.
           MOVE SCD-IIC-IOPC IN SCD-FLD TO SCD-IIC-IOPC-EDT IN SCD-EDT.
           MOVE SCD-IIC-IOPC-EDT IN SCD-EDT TO 
                SCD-IIC-IOPC-ALF IN SCD-FLD.
           IF SCD-NUM-SEGU-LEN IN SCD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SCD-NUM-SEGU-LEN IN SCD-FLD
                GO TO FIN-EDT-IKY-SCD.
           MOVE SCD-NUM-SEGU IN SCD-FLD TO SCD-NUM-SEGU-EDT IN SCD-EDT.
           MOVE SCD-NUM-SEGU-EDT IN SCD-EDT TO 
                SCD-NUM-SEGU-ALF IN SCD-FLD.
       FIN-EDT-IKY-SCD.
           EXIT.
       
       EDT-MKY-SCD SECTION.
       INI-EDT-MKY-SCD.
       FIN-EDT-MKY-SCD.
           EXIT.
       
       EDT-AKY-SCD SECTION.
       INI-EDT-AKY-SCD.
       FIN-EDT-AKY-SCD.
           EXIT.
       
       EDT-FLD-SCD SECTION.
       INI-EDT-FLD-SCD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN SCD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN SCD-FLD
                GO TO FIN-EDT-FLD-SCD.
           MOVE DBC-NUM-ICLI IN SCD-FLD TO
                DBC-NUM-ICLI-EDT IN SCD-EDT.
           MOVE DBC-NUM-ICLI-EDT IN SCD-EDT TO
                DBC-NUM-ICLI-ALF IN SCD-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF SCD-SGV-MNTO-LEN IN SCD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SCD-SGV-MNTO-LEN IN SCD-FLD
                GO TO FIN-EDT-FLD-SCD.
           MOVE SCD-SGV-MNTO IN SCD-FLD TO SCD-SGV-MNTO-EDT IN SCD-EDT.
           MOVE SCD-SGV-MNTO-EDT IN SCD-EDT TO 
                SCD-SGV-MNTO-ALF IN SCD-FLD.
           IF SCD-SGV-VCUO-LEN IN SCD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SCD-SGV-VCUO-LEN IN SCD-FLD
                GO TO FIN-EDT-FLD-SCD.
           MOVE SCD-SGV-VCUO IN SCD-FLD TO SCD-SGV-VCUO-EDT IN SCD-EDT.
           MOVE SCD-SGV-VCUO-EDT IN SCD-EDT TO 
                SCD-SGV-VCUO-ALF IN SCD-FLD.
       FIN-EDT-FLD-SCD.
           EXIT.
      *<<<<< EOF_BU
       VALIDA-OTROS SECTION.
       INI-VALIDA-OTROS.
           IF SCD-SGV-MNTO IN SCD-FLD NOT >
               SCD-SGV-VCUO IN SCD-FLD 
                 MOVE 'COL'         TO MSG-COD-SIST FIO-SIST
                 MOVE 'PRIMA>CUOTA ' TO MSG-COD-MENS             
                 PERFORM GET-MSG                                
                 MOVE MSG-GLS-DESC TO FRM-MENS                  
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-IND-ERRO TO SCD-SGV-MNTO-LEN IN SCD-FLD
                 GO TO FIN-VALIDA-OTROS.

           IF SCD-COD-CLSE IN SCD-FLD = WSS-EXT AND
               SCD-SGV-VCUO IN SCD-FLD > ZEROES
                 MOVE 'COL'         TO MSG-COD-SIST FIO-SIST
                 MOVE 'SEGEXTCUOTA ' TO MSG-COD-MENS             
                 PERFORM GET-MSG                                
                 MOVE MSG-GLS-DESC TO FRM-MENS                  
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-IND-ERRO TO SCD-SGV-VCUO-LEN IN SCD-FLD
                 GO TO FIN-VALIDA-OTROS.

           IF SCD-COD-CLSE IN SCD-FLD = WSS-INT AND
               SCD-SGV-VCUO IN SCD-FLD = ZEROES
                 MOVE 'COL'         TO MSG-COD-SIST FIO-SIST
                 MOVE 'SEGINTCUOTA ' TO MSG-COD-MENS             
                 PERFORM GET-MSG                                
                 MOVE MSG-GLS-DESC TO FRM-MENS                  
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-IND-ERRO TO SCD-SGV-VCUO-LEN IN SCD-FLD
                 GO TO FIN-VALIDA-OTROS.

           IF SCR-CMND = WSS-REN AND
                WSS-IND-OBLI = WSS-IND-OBLA AND
                WSS-IND-CFAM = WSS-IND-CFAA
                
              PERFORM VALIDA-FECHAS.

           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
              GO TO FIN-VALIDA-OTROS.

           IF WSS-IND-CFAM = WSS-IND-CFAA
              PERFORM VALIDA-SEGURO-ANT.

           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
              GO TO FIN-VALIDA-OTROS.


           IF WSS-IND-SEGU = WSS-P AND 
                 DBC-NUM-ICLI IN SCD-FLD NOT > ZEROES
              MOVE 'COL'          TO MSG-COD-SIST FIO-SIST
              MOVE 'SCDREQRUT   ' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-COD-AOOC-LEN IN SCD-FLD
              GO TO FIN-VALIDA-OTROS.

           IF WSS-IND-SEGU NOT = WSS-P AND 
                 DBC-NUM-ICLI IN SCD-FLD > ZEROES
              MOVE 'COL'          TO MSG-COD-SIST FIO-SIST
              MOVE 'SCDNREQRUT  ' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-COD-AOOC-LEN IN SCD-FLD
              GO TO FIN-VALIDA-OTROS.

           IF WSS-IND-SEGU = WSS-P AND 
                 DBC-NUM-ICLI IN SCD-FLD > ZEROES AND
                 WSS-IND-DIIN NOT = FRM-COD-TDEU IN SCD-FLD
              MOVE 'COL'          TO MSG-COD-SIST FIO-SIST
              MOVE 'SCDINVRUT   ' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-COD-AOOC-LEN IN SCD-FLD
              GO TO FIN-VALIDA-OTROS.

       FIN-VALIDA-OTROS.
           EXIT.
  
       BUSCA-SEGURO-ANT SECTION.
       INI-BUSCA-SEGURO-ANT.
           MOVE SCD-CAI-IOPC IN SCD-FLD TO SCD-CAI-IOPC IN SCD.
           MOVE SCD-IIC-IOPC IN SCD-FLD TO SCD-IIC-IOPC IN SCD.
           MOVE WSS-999                 TO SCD-NUM-SEGU IN SCD.
           MOVE FIO-GET-LEQ             TO FIO-CMND.
       LUP-BUSCA-SEGURO-ANT.
           PERFORM MC2-FIO-SCD.
           
           IF NOT (FIO-STAT-OKS AND            
                   SCD-CAI-IOPC IN SCD-FLD = SCD-CAI-IOPC IN SCD AND
                   SCD-IIC-IOPC IN SCD-FLD = SCD-IIC-IOPC IN SCD)
              GO TO FIN-BUSCA-SEGURO-ANT.
           
           MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'TSG         '           TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-TOOC IN SCD      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-IND-CFAA
           ELSE
               MOVE SPACES              TO WSS-IND-CFAA.

           IF WSS-IND-CFAM NOT = WSS-IND-CFAA
              GO TO LUP-BUSCA-SEGURO-ANT.
              
           MOVE 'TAB'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'TSE         '           TO TAB-COD-TTAB IN TAB.
           MOVE SCD-COD-AOOC IN SCD      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-COD-DAT1 IN TAB(4) TO WSS-IND-OBLA
           ELSE
               MOVE SPACES TO WSS-IND-OBLA.

           IF WSS-IND-OBLI NOT = WSS-IND-OBLA
              GO TO LUP-BUSCA-SEGURO-ANT.
      
           MOVE SCD-NUM-DFIN IN SCD TO FEC-ITM1.
           MOVE SCD-NUM-MFIN IN SCD TO FEC-ITM2.
           MOVE SCD-NUM-SFIN IN SCD TO FEC-ITM3.
           MOVE SCD-NUM-AFIN IN SCD TO FEC-ITM4.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-SUM-DIA         TO FEC-CMND.
           MOVE WSS-1               TO FEC-NDIA.
           PERFORM CAL-FEC.
      *     MOVE FEC-FECH            TO SCD-FEC-FINI IN SCD-FLD.
           MOVE FEC-FECH            TO AUX-FEC-FINI.

           MOVE SCD-NUM-DFIN IN SCD TO FEC-ITM1.
           MOVE SCD-NUM-MFIN IN SCD TO FEC-ITM2.
           MOVE SCD-NUM-SFIN IN SCD TO FEC-ITM3.
           MOVE SCD-NUM-AFIN IN SCD TO FEC-ITM4.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-SUM-ANO         TO FEC-CMND.
           MOVE WSS-1               TO FEC-NANO.
           PERFORM CAL-FEC.
      *     MOVE FEC-FECH            TO SCD-FEC-FFIN IN SCD-FLD.

       FIN-BUSCA-SEGURO-ANT.
           EXIT.

       VALIDA-FECHAS SECTION.
       INI-VALIDA-FECHAS.
              
           IF SCD-FEC-FINI IN SCD-FLD NOT = AUX-FEC-FINI
              MOVE 'COL'          TO MSG-COD-SIST FIO-SIST
              MOVE 'FECINISEGERR' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-FEC-FINI-LEN IN SCD-FLD
              GO TO FIN-VALIDA-FECHAS.

           MOVE SCD-NUM-DINI IN SCD-FLD TO WSS-NUM-SINI.
           MOVE SCD-NUM-MINI IN SCD-FLD TO WSS-NUM-AINI.
           MOVE SCD-NUM-SINI IN SCD-FLD TO WSS-NUM-MINI.
           MOVE SCD-NUM-AINI IN SCD-FLD TO WSS-NUM-DINI.

           IF WSS-FEC-FINI > AUX-FEC-FINI 
              MOVE 'COL'          TO MSG-COD-SIST FIO-SIST
              MOVE 'FECINISEGERR' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-FEC-FINI-LEN IN SCD-FLD
              GO TO FIN-VALIDA-FECHAS.

           MOVE SCD-NUM-DFIN IN SCD-FLD TO WSS-NUM-SFIN.
           MOVE SCD-NUM-MFIN IN SCD-FLD TO WSS-NUM-AFIN.
           MOVE SCD-NUM-SFIN IN SCD-FLD TO WSS-NUM-MFIN.
           MOVE SCD-NUM-AFIN IN SCD-FLD TO WSS-NUM-DFIN.

           IF WSS-FEC-FFIN NOT > WSS-FEC-FINI
              MOVE 'COL'         TO MSG-COD-SIST FIO-SIST
              MOVE 'SEGEXTCUOTA ' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-FEC-FFIN-LEN IN SCD-FLD
              GO TO FIN-VALIDA-FECHAS.

       FIN-VALIDA-FECHAS.
           EXIT.

       VALIDA-SEGURO-ANT SECTION.
       INI-VALIDA-SEGURO-ANT.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           IF SCD-CIC-ICLI IN SCD > SPACES
               MOVE SCD-CIC-ICLI IN SCD TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC.
               
           IF DBC-NUM-ICLI IN DBC = DBC-NUM-ICLI IN SCD-FLD AND
              (SCD-MSC-STAT IN SCD = WSS-I OR 
               SCD-MSC-STAT IN SCD = WSS-M OR
               SCD-MSC-STAT IN SCD = WSS-V)
              MOVE 'COL'         TO MSG-COD-SIST FIO-SIST
              MOVE 'SEGMASUNOFAM' TO MSG-COD-MENS             
              PERFORM GET-MSG                                
              MOVE MSG-GLS-DESC TO FRM-MENS                  
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-IND-ERRO TO SCD-FEC-FFIN-LEN IN SCD-FLD.
       FIN-VALIDA-SEGURO-ANT.
           EXIT.
      *>>>>>
