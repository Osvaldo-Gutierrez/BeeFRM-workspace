       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   MC2PQTRF.
       AUTHOR.       BEE.
       DATE-WRITTEN. 13-May-19 04:18 PM.

      * NOMBRE PROGRAMA                   MC2PQTRF
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      MC2RCC
      * PANTALLA                          MC2TRF
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-MC2PQTRF-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$MC2PQTRF$ SKL=$19.04.15$ VSN=${vsnpq}$        
      -    'GEN=$13-May-19 04:18 PM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0002).
           03 SCR-TRF-FLD                PIC X(1250).
      *>>>>
       COPY MC2WITRF.

       COPY MC2BRRCC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.

      *<<<< WSS
       COPY DEUBRCRI.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.                
       COPY GNSBRCIC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.                
       COPY GNSWGCIC.                                                           
                                                                                
       COPY SGCBRDBC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY SGCBRDCP.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.        
       COPY SGCBRAEP.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.        
       COPY SGCBRDCE.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.        
       COPY SGCBRRCO.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.                
       COPY SGCBROPE.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.                
       COPY SGCBRDCC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.                
       COPY SGCBRREC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.                
       COPY TABBROFI.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.        
       COPY MC2BRPLN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PLN-REQA==.                
       COPY MC2BRPRD.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PRD-REQA==.                
       COPY MC2BRAGD.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AGD-REQA==.                
       COPY TABBRCAM.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.                
       COPY MC2BRCIN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIN-REQA==.                
       COPY MC2BRPTI.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTI-REQA==.                
       COPY MC2BRSGS.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SGS-REQA==.                
       COPY MC2BRCGN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CGN-REQA==.                
       COPY MC2BRDGN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DGN-REQA==.                
       COPY MC2BRCCM.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCM-REQA==.                
       COPY MC2BRDCM.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCM-REQA==.                
       COPY TABBRTXC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TXC-REQA==.                
       COPY MC2BRCVN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CVN-REQA==.                
       COPY MC2BRDEC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DEC-REQA==.                
       COPY MC2BRDPC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DPC-REQA==.                
       COPY COLBRRDC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.                
       COPY COLBREVC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.                
       COPY COLBRVEN.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.                
       COPY COLBROPC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.                
       COPY COLBRDLC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.                
       COPY COLBRTOC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.                
      *PVG INI 02-OCT-2009 USO LEM                                              
       COPY COLBRPOC.                                                           
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.                
      *PVG FIN 02-OCT-2009                                                      

       COPY MC2WXTRF.
       COPY MC2WXMCT.                                                           
AIX   *COPY MC2WGRCC.
       COPY MC2WGRCC.                                                           
       COPY MC2WGCIN.                                                           
       COPY MC2WGSPR.                                                           
       COPY GNSWGPES.                                                           

       01  WSS-TRF-PASO.
           03 WSS-NUM-CCUR.                                                 
              05 WSS-NUM-ICUR-EDT  PIC  ZZ9.                               
              05 WSS-NUM-ICUR-ALF       PIC X(03).                         
              05 WSS-NUM-ICUR      REDEFINES                               
                 WSS-NUM-ICUR-ALF       PIC 9(03).                         
              05 WSS-HRA-HINI-TRF-EDT  PIC  999999.                        
           03 WSS-IND-TCON                          PIC X(03).                  
           03 WSS-IND-TICL                          PIC X(01).                  
           03 WSS-GLS-FTRO.                                                     
              05 WSS-CIC-FTRO                       PIC X(12).                  
              05 WSS-IND-FILL VALUE ' - '           PIC X(03).                  
              05 WSS-IND-FTRO                       PIC X(05).                  
                                                                                
                                                                                
           03 WSS-GLS-IRCC-L.                                                   
              05 WSS-CIC-IRCC-L                     PIC X(12).                  
              05 WSS-IND-FILL VALUE '-'             PIC X(01).                  
              05 WSS-COD-DESC-L                     PIC X(05).                  
                                                                                
       COPY GNSWGCPT.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
      *<<<<
              05 PGM-STAT-RCC.                                                  
                 88 PGM-STAT-RCC-NUL    VALUE '  '.                             
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-RCC-OKS VALUE '0'.                              
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).                    
              05 PGM-STAT-PLN.                                                  
                 88 PGM-STAT-PLN-NUL    VALUE '  '.                             
                 07 PGM-STT1-PLN        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-PLN-OKS VALUE '0'.                              
                 07 PGM-STT2-PLN        VALUE '3' PIC X(01).                    
              05 PGM-STAT-PRD.                                                  
                 88 PGM-STAT-PRD-NUL    VALUE '  '.                             
                 07 PGM-STT1-PRD        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-PRD-OKS VALUE '0'.                              
                 07 PGM-STT2-PRD        VALUE '3' PIC X(01).                    
              05 PGM-STAT-DCP.                                                  
                 88 PGM-STAT-DCP-NUL    VALUE '  '.                             
                 07 PGM-STT1-DCP        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-DCP-OKS VALUE '0'.                              
                 07 PGM-STT2-DCP        VALUE '3' PIC X(01).                    
              05 PGM-STAT-DCE.                                                  
                 88 PGM-STAT-DCE-NUL    VALUE '  '.                             
                 07 PGM-STT1-DCE        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-DCE-OKS VALUE '0'.                              
                 07 PGM-STT2-DCE        VALUE '3' PIC X(01).                    
              05 PGM-STAT-AGD.                                                  
                 88 PGM-STAT-AGD-NUL    VALUE '  '.                             
                 07 PGM-STT1-AGD        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-AGD-OKS VALUE '0'.                              
                 07 PGM-STT2-AGD        VALUE '3' PIC X(01).                    
              05 PGM-STAT-OPE.                                                  
                 88 PGM-STAT-OPE-NUL    VALUE '  '.                             
                 07 PGM-STT1-OPE        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-OPE-OKS VALUE '0'.                              
                 07 PGM-STT2-OPE        VALUE '3' PIC X(01).                    
              05 PGM-STAT-RCO.                                                  
                 88 PGM-STAT-RCO-NUL    VALUE '  '.                             
                 07 PGM-STT1-RCO        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-RCO-OKS VALUE '0'.                              
                 07 PGM-STT2-RCO        VALUE '3' PIC X(01).                    
                                                                                
              05 PGM-STAT-DCC.                                                  
                 88 PGM-STAT-DCC-NUL    VALUE '  '.                             
                 07 PGM-STT1-DCC        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-DCC-OKS VALUE '0'.                              
                 07 PGM-STT2-DCC        VALUE '3' PIC X(01).                    
              05 PGM-STAT-REC.                                                  
                 88 PGM-STAT-REC-NUL    VALUE '  '.                             
                 07 PGM-STT1-REC        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-REC-OKS VALUE '0'.                              
                 07 PGM-STT2-REC        VALUE '3' PIC X(01).                    
              05 PGM-STAT-RDC.                                                  
                 88 PGM-STAT-RDC-NUL    VALUE '  '.                             
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-RDC-OKS VALUE '0'.                              
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).                    
                                                                                
              05 PGM-STAT-CIN.                                                  
                 88 PGM-STAT-CIN-NUL    VALUE '  '.                             
                 07 PGM-STT1-CIN        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-CIN-OKS VALUE '0'.                              
                 07 PGM-STT2-CIN        VALUE '3' PIC X(01).                    
              05 PGM-STAT-PTI.                                                  
                 88 PGM-STAT-PTI-NUL    VALUE '  '.                             
                 07 PGM-STT1-PTI        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-PTI-OKS VALUE '0'.                              
                 07 PGM-STT2-PTI        VALUE '3' PIC X(01).                    
              05 PGM-STAT-SGS.                                                  
                 88 PGM-STAT-SGS-NUL    VALUE '  '.                             
                 07 PGM-STT1-SGS        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-SGS-OKS VALUE '0'.                              
                 07 PGM-STT2-SGS        VALUE '3' PIC X(01).                    
              05 PGM-STAT-CGN.                                                  
                 88 PGM-STAT-CGN-NUL    VALUE '  '.                             
                 07 PGM-STT1-CGN        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-CGN-OKS VALUE '0'.                              
                 07 PGM-STT2-CGN        VALUE '3' PIC X(01).                    
              05 PGM-STAT-DGN.                                                  
                 88 PGM-STAT-DGN-NUL    VALUE '  '.                             
                 07 PGM-STT1-DGN        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-DGN-OKS VALUE '0'.                              
                 07 PGM-STT2-DGN        VALUE '3' PIC X(01).                    
              05 PGM-STAT-CCM.                                                  
                 88 PGM-STAT-CCM-NUL    VALUE '  '.                             
                 07 PGM-STT1-CCM        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-CCM-OKS VALUE '0'.                              
                 07 PGM-STT2-CCM        VALUE '3' PIC X(01).                    
              05 PGM-STAT-DCM.                                                  
                 88 PGM-STAT-DCM-NUL    VALUE '  '.                             
                 07 PGM-STT1-DCM        VALUE '2' PIC X(01).                    
                    88 PGM-STAT-DCM-OKS VALUE '0'.                              
                 07 PGM-STT2-DCM        VALUE '3' PIC X(01).                    
 
      *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
           03 PGM-CMMA.
              05 PGM-CMMA-CHR OCCURS 3000 PIC X(01).
      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 3000 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO TRF-FLD.
           MOVE LOW-VALUES TO TRF-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +3000 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'MC2PQTRF' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO TRF-COD-TERM                       
                MOVE TSK-TERM-ALF TO TRF-COD-TERM-MAS                   
                MOVE 'S'          TO RCC-OFRM-SRV                               
           ELSE                                                         
                MOVE EIBTRMID     TO TRF-COD-TERM                       
                MOVE EIBTRMID     TO TRF-COD-TERM-MAS                  
                MOVE 'N'          TO RCC-OFRM-SRV.                              
                                                                        
           MOVE +3859 TO SCR-TCMA.                                      
           PERFORM GNS-ERR-QUE.                                         
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )      
               MOVE SCR-TRF-FLD TO TRF-FLD                              
               GO TO FIN-INI.                                           
                                                                        
           IF ( FRM-FFLD = FRM-FFLD-PF6 )                               
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM        
               ADD 1              TO QUE-NITM                           
               MOVE TRF-NOM-TSTRF TO QUE-COLA                           
               MOVE TRF-LEN-TSTRF TO QUE-LITM                           
               MOVE QUE-GET       TO QUE-CMND                           
               PERFORM GNS-PRO-QUE                                      
               IF QUE-STAT NOT = QUE-STAT-OKS                           
                  MOVE SCR-TRF-FLD TO TRF-FLD                           
                  GO TO FIN-INI.                                        
                                                                                
           MOVE 'N'            TO TRF-IND-DETR IN TRF-IRCC.                     
           MOVE 'MC2'          TO TAB-COD-SIST FIO-SIST.                        
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                          
           MOVE 'DETRSPMC2TRF' TO TAB-COD-CTAB IN TAB.                          
           MOVE FIO-GET-KEY    TO FIO-CMND.                                     
           PERFORM GNS-FIO-TAB.                                                 
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'                        
              MOVE TAB-IND-VIGE IN TAB TO TRF-IND-DETR IN TRF-IRCC.             
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       GNS-BUS-VCA SECTION.
       INI-GNS-BUS-VCA.
           MOVE 0 TO FRM-IFLD.
       LUP-GNS-BUS-VCA.
           ADD 1 TO FRM-IFLD.
           IF FRM-IFLD NOT > EIBCALEN AND
              FRM-IFLD NOT > 3000
                MOVE DFH-CMMA(FRM-IFLD) TO PGM-CMMA-CHR(FRM-IFLD)
                GO TO LUP-GNS-BUS-VCA.
           MOVE PGM-CMMA TO SCR-VARI.
       FIN-GNS-BUS-VCA.
           EXIT.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
      *<<<< INI_SCR_COM                                                 
           MOVE TRF-NOM-TSTRF TO QUE-COLA.                              
           MOVE TRF-LEN-TSTRF TO QUE-LITM.                              
           MOVE QUE-DEL       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE TRF-NOM-TSTRF-MAS TO QUE-COLA.                          
           MOVE TRF-LEN-TSTRF-MAS TO QUE-LITM.                          
           MOVE QUE-DEL           TO QUE-CMND.                          
           PERFORM GNS-PRO-QUE.                                         
      *>>>>                                                             
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-TRF.
           PERFORM EDT-KEY-TRF.
           PERFORM EDT-FLD-TRF.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.



       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6                   
               PERFORM VAL-NUM-KEY-TRF                                  
               PERFORM VAL-NUM-FLD-TRF                                  
               PERFORM SCRL-TAB-TRF                                     
               PERFORM SCR-TRL.                                         
      *>>>>                                                             
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.




       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-TRF
               PERFORM EDT-KEY-TRF
               PERFORM EDT-FLD-TRF
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-TRF
               PERFORM EDT-KEY-TRF
           ELSE
               PERFORM CLR-FLD-TRF
               PERFORM EDT-FLD-TRF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-TRF.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO TRF-FLD.
           MOVE LOW-VALUES TO TRF-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           GO TO CON-FND-KEY.                                           
      *>>>>
           PERFORM KEY-ALL-TRF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-RCC.
           MOVE FIO-STAT TO PGM-STAT-RCC.
      *<<<< FIN_FND_KEY
       CON-FND-KEY.                                                     
           PERFORM ANL-TRF-TCON.                                                
           IF MSG-COD-MENS > SPACES                                             
              GO TO MSG-FND-KEY.                                                
           IF SCR-CMND = 'SIM'                                                  
              PERFORM PRO-TRF-TSIM                                              
              PERFORM PUT-TAB                                                   
              IF MCT-COD-MENS IN MCT-VARI > SPACES                              
                 MOVE MCT-COD-MENS IN MCT-VARI TO MSG-COD-MENS                  
                 MOVE MCT-COD-MENS IN MCT-VARI TO FRM-MEN2                      
                 GO TO MSG-FND-KEY.                                             
           MOVE '00'         TO FIO-STAT.                                       
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
       MSG-FND-KEY.                                                     
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE '00' TO FIO-STAT.                                       
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           PERFORM PUT-ALL-TRF.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE TRF-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO TRF-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-TRF
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRF-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-TRF.
           PERFORM VAL-IKY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-TRF.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-TRF.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-TRF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-TRF
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRF-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-TRF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-TRF.
           PERFORM VAL-IKY-TRF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-TRF.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-TRF.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-TRF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>                                                             
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO TRF-GLS-MEN2
               MOVE SCR-PRMT     TO TRF-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO TRF-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO TRF-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE TRF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO TRF-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-TRF

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO TRF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO TRF-GLS-MENS.
           PERFORM PRO-MKY-TRF.
           PERFORM PRO-AKY-TRF.
           PERFORM UNP-IKY-TRF.
           PERFORM FST-KEY-TRF.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE TRF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO TRF-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO TRF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO TRF-GLS-MENS.
           PERFORM UNP-KEY-TRF.
           PERFORM FST-KEY-TRF.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-TRF.
           PERFORM PRO-AKY-TRF.
           PERFORM UNP-MKY-TRF.
           PERFORM UNP-FLD-TRF.
           PERFORM FST-FLD-TRF.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO TRF-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-TRF.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRF
               PERFORM EDT-FLD-TRF
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-TRF
               PERFORM EDT-FLD-TRF
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-TRF.
           PERFORM EDT-FLD-TRF.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY MC2BQTRF.
       COPY GNSBVNUM.
       COPY MC2BFRCC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       PGM-EBR-ALL SECTION.                                                     
       INI-PGM-EBR-ALL.                                                         
           MOVE 'GNS' TO FIO-SIST.                                              
           MOVE FIO-EBR-ALL TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
       FIN-PGM-EBR-ALL.                                                         
           EXIT.                                                                

       COPY GNSBPFEC.                                                           

       PUT-TAB SECTION.                                                 
       INI-PUT-TAB.                                                     
           MOVE TRF-NOM-TSTRF TO QUE-COLA.                              
           MOVE TRF-LEN-TSTRF TO QUE-LITM.                              
           MOVE QUE-DEL       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE 1 TO SCR-NUM-PANT.                                      
           MOVE LOW-VALUES TO WSS-GLS-RTRF-IDX-MTI.                     
           MOVE LOW-VALUES TO WSS-GLS-RTRF-IDX-3270.                    
      *                                                                 
           MOVE 1      TO FRM-IFLD.                                          
           MOVE ZEROES TO WSS-NITM IN WSS-VARI.                        
                                                                        
           MOVE 1      TO WSS-F IN WSS-VARI.                                 
       LUP-PUT-TAB.                                                     
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI                  
              GO TO FIN-PUT-TAB.                                        
           IF WSS-CAI-CPTO-F(WSS-F) > SPACES                                    
              PERFORM PUT-TAB-TRF                                       
              PERFORM PUT-TRF-QUE                                       
              PERFORM SET-FRM-IFLD                                      
           ELSE                                                         
           IF FRM-IFLD = 1 AND WSS-F = 1                                
              GO TO MSG-PUT-TAB                                         
           ELSE                                                         
              MOVE '00' TO FIO-STAT                                     
              GO TO FIN-PUT-TAB.                                        
       CNT-PUT-TAB.                                                             
           ADD 1 TO WSS-F IN WSS-VARI.                                  
           GO TO LUP-PUT-TAB.                                           
       MSG-PUT-TAB.                                                     
              MOVE 'TAB'        TO MSG-COD-SIST.
              MOVE 'TRFACT NEX' TO MSG-COD-MENS.
              PERFORM GET-MSG.                                          
              MOVE MSG-GLS-DESC TO FRM-MENS.                            
              MOVE '00' TO FIO-STAT.                                    
      *       MOVE 'S' TO SCR-IERR.                                     
                                                                        
       FIN-PUT-TAB.                                                     
           MOVE 1                  TO QUE-NITM.                         
           MOVE TRF-LEN-TSTRF-MAS  TO QUE-LITM.                         
           MOVE TRF-NOM-TSTRF-MAS  TO QUE-COLA.                         
                                                                        
           IF WSS-NITM > WSS-NITMMAX                                    
              MOVE 'S'           TO TRF-MAS-IND-HMAS                    
           ELSE                                                         
              MOVE 'N'           TO TRF-MAS-IND-HMAS.                   
                                                                        
           MOVE WSS-NITM         TO WSS-NUM-ICUR.                       
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.                   
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.                   
           MOVE WSS-NUM-ICUR-ALF TO TRF-MAS-NUM-TOCC.                   
           MOVE TRF-MAS-ITEM     TO QUE-ITEM.                           
           MOVE QUE-PUT          TO QUE-CMND.                           
           PERFORM GNS-PRO-QUE.                                         
           IF WSS-NITM > WSS-IMAX                                       
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'TRF   DMAS' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN2.                           
       EXT-PUT-TAB.                                                     
           EXIT.                                                        
                                                                        
       SET-FRM-IFLD SECTION.                                            
       INI-SET-FRM-IFLD.                                                
           IF (TRF-IND-DETR IN TRF-IRCC = 'N' AND                               
               WSS-IND-TPLT-F(WSS-F) NOT = 'P')                                 
               GO TO FIN-SET-FRM-IFLD.                                          
                                                                                
           IF SCR-OFRM-SRV                                              
                MOVE 1 TO FRM-IFLD                                      
           ELSE                                                         
                ADD 1 TO FRM-IFLD.                                      
       FIN-SET-FRM-IFLD.                                                
           EXIT.                                                        

       SCRL-TAB-TRF SECTION.                                            
       INI-SCRL-TAB-TRF.                                                
           MOVE SPACES TO MSG-COD-MENS.                                 
                                                                        
           IF FRM-FFLD = FRM-FFLD-PF6                                   
               PERFORM PUT-TAB-ASC                                      
           ELSE                                                         
               PERFORM PUT-TAB-DSC.                                     
           IF MSG-COD-MENS > SPACES                                     
               MOVE 'DEU' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN2.                           
       FIN-SCRL-TAB-TRF.                                                
           EXIT.                                                        
                                                                        
       PUT-TAB-TRF SECTION.                                             
       INI-PUT-TAB-TRF.                                                 
           IF (TRF-IND-DETR IN TRF-IRCC = 'N' AND                               
               WSS-IND-TPLT-F(WSS-F) NOT = 'P')                                 
               GO TO FIN-PUT-TAB-TRF.                                           
                                                                                
           PERFORM CLR-WSS.                                             
           MOVE WSS-COD-CTPO-F(WSS-F) TO WSS-COD-CTPO-TRF IN WSS-VARI.
           MOVE WSS-COD-TOOC-F(WSS-F) TO WSS-COD-TOOC-TRF IN WSS-VARI.
           MOVE WSS-COD-AOOC-F(WSS-F) TO WSS-COD-AOOC-TRF IN WSS-VARI.
           MOVE WSS-COD-TCNL-F(WSS-F) TO WSS-COD-TCNL-TRF IN WSS-VARI.
           MOVE WSS-COD-CNAL-F(WSS-F) TO WSS-COD-CNAL-TRF IN WSS-VARI.
           MOVE WSS-COD-EVEN-F(WSS-F) TO WSS-COD-EVEN-TRF IN WSS-VARI.
           MOVE WSS-COD-VCOC-F(WSS-F) TO WSS-COD-VCOC-TRF IN WSS-VARI.
           MOVE WSS-VAL-MNTO-F(WSS-F) TO WSS-VAL-MNTO-TRF IN WSS-VARI.
           MOVE WSS-NUM-PLZO-F(WSS-F) TO WSS-NUM-PLZO-TRF IN WSS-VARI.
           MOVE WSS-MSC-UTPZ-F(WSS-F) TO WSS-MSC-UTPZ-TRF IN WSS-VARI.
           MOVE WSS-VAL-BASE-F(WSS-F) TO WSS-VAL-BASE-TRF IN WSS-VARI.
           MOVE WSS-VAL-PFIL-F(WSS-F) TO WSS-VAL-PFIL-TRF IN WSS-VARI.
           MOVE WSS-COD-VCVL-F(WSS-F) TO WSS-COD-VCVL-TRF IN WSS-VARI.
           MOVE WSS-MSC-BCTI-F(WSS-F) TO WSS-MSC-BCTI-TRF IN WSS-VARI.
           MOVE WSS-MSC-PBTI-F(WSS-F) TO WSS-MSC-PBTI-TRF IN WSS-VARI.
           MOVE WSS-MSC-BPBT-F(WSS-F) TO WSS-MSC-BPBT-TRF IN WSS-VARI.
           MOVE WSS-MSC-SPBT-F(WSS-F) TO WSS-MSC-SPBT-TRF IN WSS-VARI.
           MOVE WSS-COD-CVTI-F(WSS-F) TO WSS-COD-CVTI-TRF IN WSS-VARI.
           MOVE WSS-MSC-TFPR-F(WSS-F) TO WSS-MSC-TFPR-TRF IN WSS-VARI.
           MOVE WSS-NUM-PREP-F(WSS-F) TO WSS-NUM-PREP-TRF IN WSS-VARI.
           MOVE WSS-MSC-UTPR-F(WSS-F) TO WSS-MSC-UTPR-TRF IN WSS-VARI.
           MOVE WSS-CAI-CPTO-F(WSS-F) TO WSS-CAI-CPTO-TRF IN WSS-VARI.
           MOVE WSS-IIC-CPTO-F(WSS-F) TO WSS-IIC-CPTO-TRF IN WSS-VARI.
           MOVE WSS-COD-SIST-F(WSS-F) TO WSS-COD-SIST-TRF IN WSS-VARI.
           MOVE WSS-COD-EVET-F(WSS-F) TO WSS-COD-EVET-TRF IN WSS-VARI.
           MOVE WSS-IND-TPLT-F(WSS-F) TO WSS-IND-TPLT-TRF IN WSS-VARI.
           MOVE WSS-COD-VCPL-F(WSS-F) TO WSS-COD-VCPL-TRF IN WSS-VARI.
           MOVE WSS-FEC-FINI-F(WSS-F) TO WSS-FEC-FINI-TRF IN WSS-VARI.
           MOVE WSS-HRA-HINI-F(WSS-F) TO WSS-HRA-HINI-TRF IN WSS-VARI.
           MOVE WSS-COD-LREC-F(WSS-F) TO WSS-COD-LREC-TRF IN WSS-VARI.
           MOVE WSS-NUM-IREL-F(WSS-F) TO WSS-NUM-IREL-TRF IN WSS-VARI.
           MOVE WSS-VRF-IREL-F(WSS-F) TO WSS-VRF-IREL-TRF IN WSS-VARI.
           MOVE WSS-IND-IREL-F(WSS-F) TO WSS-IND-IREL-TRF IN WSS-VARI.
           MOVE WSS-GLS-IREL-F(WSS-F) TO WSS-GLS-IREL-TRF IN WSS-VARI.
           MOVE WSS-CAI-IRCC-F(WSS-F) TO WSS-CAI-IRCC-TRF IN WSS-VARI.
           MOVE WSS-IIC-IRCC-F(WSS-F) TO WSS-IIC-IRCC-TRF IN WSS-VARI.
           MOVE WSS-SGV-CFND-F(WSS-F) TO WSS-SGV-CFND-TRF IN WSS-VARI.
           MOVE WSS-COD-FRGO-F(WSS-F) TO WSS-COD-FRGO-TRF IN WSS-VARI.
           MOVE WSS-VAL-TDCT-F(WSS-F) TO WSS-VAL-TDCT-TRF IN WSS-VARI.
           MOVE WSS-VAL-TRCG-F(WSS-F) TO WSS-VAL-TRCG-TRF IN WSS-VARI.

           MOVE WSS-COD-CTPO-TRF      TO WSS-COD-CTPO-QUE IN WSS-VARI.
           MOVE WSS-COD-TOOC-TRF      TO WSS-COD-TOOC-QUE IN WSS-VARI.
           MOVE WSS-COD-AOOC-TRF      TO WSS-COD-AOOC-QUE IN WSS-VARI.
           MOVE WSS-COD-TCNL-TRF      TO WSS-COD-TCNL-QUE IN WSS-VARI.
           MOVE WSS-COD-CNAL-TRF      TO WSS-COD-CNAL-QUE IN WSS-VARI.
           MOVE WSS-COD-EVEN-TRF      TO WSS-COD-EVEN-QUE IN WSS-VARI.
           MOVE WSS-COD-VCOC-TRF      TO WSS-COD-VCOC-QUE IN WSS-VARI.
           MOVE WSS-VAL-MNTO-TRF      TO WSS-VAL-MNTO-QUE IN WSS-VARI.
           MOVE WSS-NUM-PLZO-TRF      TO WSS-NUM-PLZO-QUE IN WSS-VARI.
           MOVE WSS-MSC-UTPZ-TRF      TO WSS-MSC-UTPZ-QUE IN WSS-VARI.
           MOVE WSS-VAL-BASE-TRF      TO WSS-VAL-BASE-QUE IN WSS-VARI.
           MOVE WSS-VAL-PFIL-TRF      TO WSS-VAL-PFIL-QUE IN WSS-VARI.
           MOVE WSS-COD-VCVL-TRF      TO WSS-COD-VCVL-QUE IN WSS-VARI.
           MOVE WSS-MSC-BCTI-TRF      TO WSS-MSC-BCTI-QUE IN WSS-VARI.
           MOVE WSS-MSC-PBTI-TRF      TO WSS-MSC-PBTI-QUE IN WSS-VARI.
           MOVE WSS-MSC-BPBT-TRF      TO WSS-MSC-BPBT-QUE IN WSS-VARI.
           MOVE WSS-MSC-SPBT-TRF      TO WSS-MSC-SPBT-QUE IN WSS-VARI.
           MOVE WSS-COD-CVTI-TRF      TO WSS-COD-CVTI-QUE IN WSS-VARI.
           MOVE WSS-MSC-TFPR-TRF      TO WSS-MSC-TFPR-QUE IN WSS-VARI.
           MOVE WSS-NUM-PREP-TRF      TO WSS-NUM-PREP-QUE IN WSS-VARI.
           MOVE WSS-MSC-UTPR-TRF      TO WSS-MSC-UTPR-QUE IN WSS-VARI.
           MOVE WSS-CAI-CPTO-TRF      TO WSS-CAI-CPTO-QUE IN WSS-VARI.
           MOVE WSS-IIC-CPTO-TRF      TO WSS-IIC-CPTO-QUE IN WSS-VARI.
           MOVE WSS-COD-SIST-TRF      TO WSS-COD-SIST-QUE IN WSS-VARI.
           MOVE WSS-COD-EVET-TRF      TO WSS-COD-EVET-QUE IN WSS-VARI.
           MOVE WSS-IND-TPLT-TRF      TO WSS-IND-TPLT-QUE IN WSS-VARI.
           MOVE WSS-COD-VCPL-TRF      TO WSS-COD-VCPL-QUE IN WSS-VARI.
           MOVE WSS-FEC-FINI-TRF      TO WSS-FEC-FINI-QUE IN WSS-VARI.
           MOVE WSS-HRA-HINI-TRF      TO WSS-HRA-HINI-QUE IN WSS-VARI.
           MOVE WSS-COD-LREC-TRF      TO WSS-COD-LREC-QUE IN WSS-VARI.
           MOVE WSS-NUM-IREL-TRF      TO WSS-NUM-IREL-QUE IN WSS-VARI.
           MOVE WSS-VRF-IREL-TRF      TO WSS-VRF-IREL-QUE IN WSS-VARI.
           MOVE WSS-IND-IREL-TRF      TO WSS-IND-IREL-QUE IN WSS-VARI.
           MOVE WSS-GLS-IREL-TRF      TO WSS-GLS-IREL-QUE IN WSS-VARI.
           MOVE WSS-CAI-IRCC-TRF      TO WSS-CAI-IRCC-QUE IN WSS-VARI.
           MOVE WSS-IIC-IRCC-TRF      TO WSS-IIC-IRCC-QUE IN WSS-VARI.
           MOVE WSS-SGV-CFND-TRF      TO WSS-SGV-CFND-QUE IN WSS-VARI.
           MOVE WSS-COD-FRGO-TRF      TO WSS-COD-FRGO-QUE IN WSS-VARI.
           MOVE WSS-VAL-TDCT-TRF      TO WSS-VAL-TDCT-QUE IN WSS-VARI.
           MOVE WSS-VAL-TRCG-TRF      TO WSS-VAL-TRCG-QUE IN WSS-VARI.

           IF FRM-IFLD > WSS-IMAX                                       
              GO TO FIN-PUT-TAB-TRF.                                    
                                                                        
           MOVE WSS-COD-CTPO-TRF IN WSS-VARI TO 
                FRM-COD-CTPO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-TOOC-TRF IN WSS-VARI TO 
                FRM-COD-TOOC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-AOOC-TRF IN WSS-VARI TO 
                FRM-COD-AOOC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-TCNL-TRF IN WSS-VARI TO 
                FRM-COD-TCNL-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-CNAL-TRF IN WSS-VARI TO 
                FRM-COD-CNAL-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-EVEN-TRF IN WSS-VARI TO 
                FRM-COD-EVEN-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-VCOC-TRF IN WSS-VARI TO 
                FRM-COD-VCOC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VAL-MNTO-TRF IN WSS-VARI TO 
                FRM-VAL-MNTO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-NUM-PLZO-TRF IN WSS-VARI TO 
                FRM-NUM-PLZO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-UTPZ-TRF IN WSS-VARI TO 
                FRM-MSC-UTPZ-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VAL-BASE-TRF IN WSS-VARI TO 
                FRM-VAL-BASE-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VAL-PFIL-TRF IN WSS-VARI TO 
                FRM-VAL-PFIL-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-VCVL-TRF IN WSS-VARI TO 
                FRM-COD-VCVL-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-BCTI-TRF IN WSS-VARI TO 
                FRM-MSC-BCTI-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-PBTI-TRF IN WSS-VARI TO 
                FRM-MSC-PBTI-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-BPBT-TRF IN WSS-VARI TO 
                FRM-MSC-BPBT-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-SPBT-TRF IN WSS-VARI TO 
                FRM-MSC-SPBT-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-CVTI-TRF IN WSS-VARI TO 
                FRM-COD-CVTI-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-TFPR-TRF IN WSS-VARI TO 
                FRM-MSC-TFPR-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-NUM-PREP-TRF IN WSS-VARI TO 
                FRM-NUM-PREP-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-MSC-UTPR-TRF IN WSS-VARI TO 
                FRM-MSC-UTPR-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-CAI-CPTO-TRF IN WSS-VARI TO 
                FRM-CAI-CPTO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-IIC-CPTO-TRF IN WSS-VARI TO 
                FRM-IIC-CPTO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-SIST-TRF IN WSS-VARI TO 
                FRM-COD-SIST-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-EVET-TRF IN WSS-VARI TO 
                FRM-COD-EVET-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-IND-TPLT-TRF IN WSS-VARI TO 
                FRM-IND-TPLT-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-VCPL-TRF IN WSS-VARI TO 
                FRM-COD-VCPL-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-FEC-FINI-TRF IN WSS-VARI TO 
                FRM-FEC-FINI-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-HRA-HINI-TRF IN WSS-VARI TO 
                FRM-HRA-HINI-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-LREC-TRF IN WSS-VARI TO 
                FRM-COD-LREC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-NUM-IREL-TRF IN WSS-VARI TO 
                FRM-NUM-IREL   IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VRF-IREL-TRF IN WSS-VARI TO 
                FRM-VRF-IREL   IN TRF-FLD(FRM-IFLD).
           MOVE WSS-IND-IREL-TRF IN WSS-VARI TO 
                FRM-IND-IREL   IN TRF-FLD(FRM-IFLD).
           MOVE WSS-GLS-IREL-TRF IN WSS-VARI TO 
                FRM-GLS-IREL   IN TRF-FLD(FRM-IFLD).
           MOVE WSS-CAI-IRCC-TRF IN WSS-VARI TO 
                FRM-CAI-IRCC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-IIC-IRCC-TRF IN WSS-VARI TO 
                FRM-IIC-IRCC-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-SGV-CFND-TRF IN WSS-VARI TO
                FRM-SGV-CFND-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-COD-FRGO-TRF IN WSS-VARI TO
                FRM-COD-FRGO-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VAL-TDCT-TRF IN WSS-VARI TO
                FRM-VAL-TDCT-R IN TRF-FLD(FRM-IFLD).
           MOVE WSS-VAL-TRCG-TRF IN WSS-VARI TO
                FRM-VAL-TRCG-R IN TRF-FLD(FRM-IFLD).
       FIN-PUT-TAB-TRF.                                                 
           EXIT.                                                        

       PUT-TRF-QUE SECTION.                                             
       INI-PUT-TRF-QUE.                                                 
           IF (TRF-IND-DETR IN TRF-IRCC = 'N' AND                               
               WSS-IND-TPLT-F(WSS-F) NOT = 'P')                                 
               GO TO FIN-PUT-TRF-QUE.                                           
                                                                                
           IF SCR-OFRM-SRV                                                      
              PERFORM EDT-VAL-TRF.                                              
           PERFORM PRO-FLD-QUE.                                         
           ADD 1 TO WSS-NITM.                                           
           IF (SCR-OFRM-SRV AND WSS-NITM > WSS-NITMMAX)                 
              GO TO FIN-PUT-TRF-QUE.                                    
           IF ((NOT SCR-OFRM-SRV) AND WSS-NITM > WSS-JMAX)              
              GO TO FIN-PUT-TRF-QUE.                                    
                                                                        
           MOVE TRF-NOM-TSTRF            TO QUE-COLA.                   
           MOVE TRF-LEN-TSTRF            TO QUE-LITM.                   
           MOVE WSS-NITM                 TO QUE-NITM.                   
           MOVE SPACES                   TO QUE-ITEM.                   
           IF SCR-OFRM-SRV                                              
              MOVE WSS-GLS-RTRF-IDX-MTI  TO QUE-ITEM                    
           ELSE                                                         
              MOVE WSS-GLS-RTRF-IDX-3270 TO QUE-ITEM.                   
           MOVE QUE-PUT  TO QUE-CMND.                                   
           PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-TRF-QUE.                                                 
           EXIT.                                                        

       PUT-TAB-ASC SECTION.                                             
       INI-PUT-TAB-ASC.                                                 
           MOVE SPACES TO MSG-COD-MENS IN MSG.                                 
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.           
           MOVE 0 TO FRM-IFLD.                                          
       LUP-PUT-TAB-ASC.                                                 
           ADD 1              TO QUE-NITM.                              
           MOVE TRF-NOM-TSTRF TO QUE-COLA.                              
           MOVE TRF-LEN-TSTRF TO QUE-LITM.                              
           MOVE QUE-GET       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
               IF FRM-IFLD = 0                                          
                   MOVE 'TRF   NONXT' TO MSG-COD-MENS                   
                   GO TO FIN-PUT-TAB-ASC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-ASC.                               
           ADD 1 TO FRM-IFLD.                                           
           MOVE QUE-ITEM TO FRM-COD-CTPO-R-IDX(FRM-IFLD).             
           IF FRM-IFLD < WSS-IMAX                                       
               GO TO LUP-PUT-TAB-ASC.                                   
       FIN-PUT-TAB-ASC.                                                 
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX                      
               ADD 1 FRM-IFLD GIVING WSS-I                              
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1            
                                 UNTIL WSS-I > WSS-IMAX.                
           IF FRM-IFLD > 0                                              
               ADD 1 TO SCR-NUM-PANT.                                   
           IF FRM-IFLD = WSS-IMAX                                       
               ADD 1              TO QUE-NITM                           
               MOVE TRF-NOM-TSTRF TO QUE-COLA                           
               MOVE TRF-LEN-TSTRF TO QUE-LITM                           
               MOVE QUE-GET       TO QUE-CMND                           
               PERFORM GNS-PRO-QUE                                      
               IF QUE-STAT = QUE-STAT-OKS                               
                   MOVE 'TAB'        TO MSG-COD-SIST                    
                   MOVE 'TRF   DMAS' TO MSG-COD-MENS.                   
       EXT-PUT-TAB-ASC.                                                 
           EXIT.                                                        
                                                                        
       PUT-TAB-DSC SECTION.                                             
       INI-PUT-TAB-DSC.                                                 
           MOVE SPACES TO MSG-COD-MENS IN MSG.                                 
           IF SCR-NUM-PANT = 1                                          
               MOVE 'TRF   NOPRV' TO MSG-COD-MENS                       
               GO TO EXT-PUT-TAB-DSC.                                   
                                                                        
           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.                
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.               
           ADD 1 TO QUE-NITM.                                           
           ADD 1 WSS-IMAX GIVING FRM-IFLD.                              
       LUP-PUT-TAB-DSC.                                                 
           SUBTRACT  1 FROM QUE-NITM.                                   
           MOVE TRF-NOM-TSTRF TO QUE-COLA                               
           MOVE TRF-LEN-TSTRF TO QUE-LITM                               
           MOVE QUE-GET       TO QUE-CMND.                              
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT NOT = QUE-STAT-OKS                               
               IF FRM-IFLD > WSS-IMAX                                   
                   MOVE 'TRF   NOPRV' TO MSG-COD-MENS                   
                   GO TO FIN-PUT-TAB-DSC                                
               ELSE                                                     
                   GO TO FIN-PUT-TAB-DSC.                               
           SUBTRACT 1 FROM FRM-IFLD.                                    
           MOVE QUE-ITEM TO FRM-COD-CTPO-R-IDX(FRM-IFLD).             
           IF FRM-IFLD > 1                                              
               GO TO LUP-PUT-TAB-DSC.                                   
       FIN-PUT-TAB-DSC.                                                 
           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1                  
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I                    
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1           
                                 UNTIL WSS-I < 1.                       
           IF FRM-IFLD NOT > WSS-IMAX                                   
               SUBTRACT 1 FROM SCR-NUM-PANT                             
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE 'TRF   DMAS' TO MSG-COD-MENS.                       
       EXT-PUT-TAB-DSC.                                                 
           EXIT.                                                        

       CLR-FRM SECTION.                                                 
       INI-CLR-FRM.                                                     
           MOVE SPACES TO FRM-COD-CTPO-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-TOOC-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-AOOC-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-TCNL-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CNAL-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EVEN-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCOC-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-MNTO-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-PLZO-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-UTPZ-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-BASE-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-PFIL-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCVL-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-BCTI-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-PBTI-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-BPBT-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-SPBT-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CVTI-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-TFPR-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-PREP-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-UTPR-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-CPTO-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-IIC-CPTO-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-SIST-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EVET-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-TPLT-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCPL-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FINI-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-HRA-HINI-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-LREC-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-IREL   IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-VRF-IREL   IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-IREL   IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-GLS-IREL   IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-IRCC-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-IIC-IRCC-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-CFND-R IN TRF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-FRGO-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-TDCT-R IN TRF-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-TRCG-R IN TRF-FLD(WSS-I).
       FIN-CLR-FRM.                                                     
           EXIT.                                                        
                                                                        
       CLR-WSS SECTION.                                                 
       INI-CLR-WSS.                                                     
           MOVE SPACES TO WSS-COD-CTPO-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-TOOC-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-AOOC-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-TCNL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-CNAL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-EVEN-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-VCOC-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-MNTO-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PLZO-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-UTPZ-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-BASE-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-PFIL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-VCVL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-BCTI-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-PBTI-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-BPBT-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-SPBT-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-CVTI-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-TFPR-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PREP-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-UTPR-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-CAI-CPTO-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-IIC-CPTO-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-SIST-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-EVET-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-IND-TPLT-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-VCPL-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FINI-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-HRA-HINI-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-LREC-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-IREL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-VRF-IREL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-IND-IREL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-IREL-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-CAI-IRCC-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-IIC-IRCC-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-CFND-TRF IN WSS-VARI.
           MOVE SPACES TO WSS-COD-FRGO-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-TDCT-TRF IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-TRCG-TRF IN WSS-VARI.
           IF SCR-OFRM-SRV                                              
               PERFORM CLR-FRM-MTX.                                     
       FIN-CLR-WSS.                                                     
           EXIT.                                                        
                                                                        
       CLR-FRM-MTX SECTION.                                             
       INI-CLR-FRM-MTX.                                                 
           MOVE SPACES TO FRM-COD-CTPO-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-TOOC-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-AOOC-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-TCNL-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-CNAL-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-EVEN-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-VAL-MNTO-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-NUM-PLZO-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-UTPZ-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-VAL-BASE-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-VAL-PFIL-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-VCVL-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-BCTI-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-PBTI-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-BPBT-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-SPBT-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-CVTI-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-TFPR-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-NUM-PREP-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-MSC-UTPR-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-CAI-CPTO-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-IIC-CPTO-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-SIST-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-EVET-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-IND-TPLT-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-VCPL-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-FEC-FINI-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-HRA-HINI-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-LREC-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-NUM-IREL   IN TRF-FLD(1).
           MOVE SPACES TO FRM-VRF-IREL   IN TRF-FLD(1).
           MOVE SPACES TO FRM-IND-IREL   IN TRF-FLD(1).
           MOVE SPACES TO FRM-GLS-IREL   IN TRF-FLD(1).
           MOVE SPACES TO FRM-CAI-IRCC-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-IIC-IRCC-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-SGV-CFND-R IN TRF-FLD(1).
           MOVE SPACES TO FRM-COD-FRGO-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-VAL-TDCT-R IN TRF-FLD(1).
           MOVE ZEROES TO FRM-VAL-TRCG-R IN TRF-FLD(1).
       FIN-CLR-FRM-MTX.                                                 
           EXIT.                                                        

       CLR-TRF-VEC SECTION.                                             
       INI-CLR-TRF-VEC.  
           ADD 1 TO WSS-J IN WSS-VARI.                                  
           IF WSS-J IN WSS-VARI > WSS-JMAX IN WSS-VARI                  
               GO TO FIN-CLR-TRF-VEC.                                   
           MOVE SPACES TO WSS-COD-TCNL-V(WSS-J).                                
           MOVE SPACES TO WSS-COD-CNAL-V(WSS-J).                                
           MOVE SPACES TO WSS-COD-CTPO-V(WSS-J).
           MOVE SPACES TO WSS-CAI-CPTO-V(WSS-J).                                
           MOVE SPACES TO WSS-IIC-CPTO-V(WSS-J).                                
           MOVE SPACES TO WSS-IND-TPLT-V(WSS-J).                                
           MOVE ZEROES TO WSS-FEC-RINI-V(WSS-J).                                
           MOVE ZEROES TO WSS-HRA-RINI-V(WSS-J).                                
           MOVE SPACES TO WSS-COD-TOOC-V(WSS-J).
           MOVE SPACES TO WSS-COD-AOOC-V(WSS-J).
           MOVE SPACES TO WSS-COD-EVEN-V(WSS-J).
           MOVE SPACES TO WSS-COD-VCOC-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-MNTO-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-PLZO-V(WSS-J).
           MOVE SPACES TO WSS-MSC-UTPZ-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-BASE-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-PFIL-V(WSS-J).
           MOVE SPACES TO WSS-COD-VCVL-V(WSS-J).
           MOVE SPACES TO WSS-MSC-BCTI-V(WSS-J).
           MOVE SPACES TO WSS-MSC-PBTI-V(WSS-J).
           MOVE SPACES TO WSS-MSC-BPBT-V(WSS-J).
           MOVE SPACES TO WSS-MSC-SPBT-V(WSS-J).
           MOVE SPACES TO WSS-COD-CVTI-V(WSS-J).
           MOVE SPACES TO WSS-MSC-TFPR-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-PREP-V(WSS-J).
           MOVE SPACES TO WSS-MSC-UTPR-V(WSS-J).
           MOVE SPACES TO WSS-COD-SIST-V(WSS-J).
           MOVE SPACES TO WSS-COD-EVET-V(WSS-J).
           MOVE SPACES TO WSS-COD-VCPL-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-DINI-V(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-MINI-V(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-SINI-V(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-AINI-V(WSS-J).                                
           MOVE ZEROES TO WSS-HRA-HINI-V(WSS-J).
           MOVE SPACES TO WSS-COD-LREC-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-IREL-V(WSS-J).
           MOVE SPACES TO WSS-VRF-IREL-V(WSS-J).
           MOVE SPACES TO WSS-IND-IREL-V(WSS-J).
           MOVE SPACES TO WSS-GLS-IREL-V(WSS-J).
           MOVE SPACES TO WSS-CAI-IRCC-V(WSS-J).
           MOVE ZEROES TO WSS-IIC-IRCC-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-CFND-V(WSS-J).
           MOVE SPACES TO WSS-COD-FRGO-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-TDCT-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-TRCG-V(WSS-J).
           MOVE ZEROES TO WSS-VAL-TMIN-V(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-TMAX-V(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-VTMC-V(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-CFND-V(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-RORA-V(WSS-J).                                
           MOVE SPACES TO WSS-CIC-PLTP-V(WSS-J).                                
                                                                                
           MOVE ZEROES TO TRF-ID(WSS-J).                                        
           MOVE ZEROES TO TRF-IDC(WSS-J).                                       
           MOVE ZEROES TO TRF-IDC-REC(WSS-J).                                   
           MOVE ZEROES TO TRF-NUM-C(WSS-J).                                     
           MOVE ZEROES TO TRF-BANC(WSS-J).                                      
           MOVE ZEROES TO TRF-RTBL(WSS-J).                                      
           MOVE ZEROES TO TRF-COMP(WSS-J).                                      
           MOVE ZEROES TO TRF-NUM-A(WSS-J).                                     
           MOVE ZEROES TO TRF-AGD-CNV(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-SEG(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-PLN(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-RIE(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-NED(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-SEX(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-TCL(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-ICL(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-EDAD(WSS-J).                                  
           MOVE ZEROES TO TRF-AGD-RUF(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D01(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D02(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D03(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D04(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D05(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D06(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D07(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D08(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D09(WSS-J).                                   
      *    MOVE ZEROES TO TRF-AGD-D10(WSS-J).                                   
           MOVE ZEROES TO TRF-TCNL(WSS-J).                                      
           MOVE ZEROES TO TRF-CNAL(WSS-J).                                      
           MOVE ZEROES TO TRF-TIO(WSS-J).                                       
           MOVE ZEROES TO TRF-AUX(WSS-J).                                       
           MOVE ZEROES TO TRF-VCOC(WSS-J).                                      
           MOVE ZEROES TO TRF-GRPO(WSS-J).                                      
           MOVE ZEROES TO TRF-AGD-PAC(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-DXC(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-EJC(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-PCG(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-TEN(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-APR(WSS-J).                                   
           MOVE ZEROES TO TRF-AGD-CEV(WSS-J).                                   
           GO TO INI-CLR-TRF-VEC.                                       
       FIN-CLR-TRF-VEC.                                                 
           EXIT.                                                        
                                                                        
       PRO-FLD-QUE SECTION.                                             
       INI-PRO-FLD-QUE.                                                 
           MOVE 'P' TO WSS-CAI-CPTO-TRF-ATR.
           MOVE 'P' TO WSS-MSC-UTPZ-TRF-ATR.
           MOVE 'P' TO WSS-IIC-CPTO-TRF-ATR.
           MOVE 'P' TO WSS-MSC-UTPR-TRF-ATR.
           MOVE 'P' TO WSS-COD-SIST-TRF-ATR.
           MOVE 'P' TO WSS-NUM-PREP-TRF-ATR.
           MOVE 'P' TO WSS-COD-EVET-TRF-ATR.
           MOVE 'P' TO WSS-NUM-PLZO-TRF-ATR.
           MOVE 'P' TO WSS-IND-TPLT-TRF-ATR.
           MOVE 'P' TO WSS-MSC-TFPR-TRF-ATR.
           MOVE 'P' TO WSS-COD-VCPL-TRF-ATR.
           MOVE 'P' TO WSS-VAL-PFIL-TRF-ATR.
           MOVE 'P' TO WSS-FEC-FINI-TRF-ATR.
           MOVE 'P' TO WSS-COD-CVTI-TRF-ATR.
           MOVE 'P' TO WSS-VAL-MNTO-TRF-ATR.
           MOVE 'P' TO WSS-MSC-SPBT-TRF-ATR.
           MOVE 'P' TO WSS-IIC-IRCC-TRF-ATR.
           MOVE 'P' TO WSS-COD-VCOC-TRF-ATR.
           MOVE 'P' TO WSS-HRA-HINI-TRF-ATR.
           MOVE 'P' TO WSS-MSC-BPBT-TRF-ATR.
           MOVE 'P' TO WSS-COD-EVEN-TRF-ATR.
           MOVE 'P' TO WSS-COD-VCVL-TRF-ATR.
           MOVE 'P' TO WSS-COD-LREC-TRF-ATR.
           MOVE 'P' TO WSS-COD-CNAL-TRF-ATR.
           MOVE 'P' TO WSS-NUM-IREL-TRF-ATR.
           MOVE 'P' TO WSS-MSC-PBTI-TRF-ATR.
           MOVE 'P' TO WSS-COD-TCNL-TRF-ATR.
           MOVE 'P' TO WSS-VAL-BASE-TRF-ATR.
           MOVE 'P' TO WSS-VRF-IREL-TRF-ATR.
           MOVE 'P' TO WSS-COD-AOOC-TRF-ATR.
           MOVE 'P' TO WSS-IND-IREL-TRF-ATR.
           MOVE 'P' TO WSS-COD-TOOC-TRF-ATR.
           MOVE 'P' TO WSS-GLS-IREL-TRF-ATR.
           MOVE 'P' TO WSS-MSC-BCTI-TRF-ATR.
           MOVE 'P' TO WSS-CAI-IRCC-TRF-ATR.
           MOVE 'P' TO WSS-COD-CTPO-TRF-ATR.
           MOVE 'P' TO WSS-SGV-CFND-TRF-ATR.
           MOVE 'P' TO WSS-COD-FRGO-TRF-ATR.
           MOVE 'P' TO WSS-VAL-TDCT-TRF-ATR.
           MOVE 'P' TO WSS-VAL-TRCG-TRF-ATR.
       FIN-PRO-FLD-QUE.                                                 
           EXIT.                                                        

       CLR-ALL-VTRF SECTION.                                                    
       INI-CLR-ALL-VTRF.                                                        
           ADD 1 TO WSS-J IN WSS-VARI.                                          
           IF WSS-J IN WSS-VARI > WSS-JMAX IN WSS-VARI                          
               GO TO FIN-CLR-ALL-VTRF.                                          
           MOVE SPACES TO WSS-COD-TCNL-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-CNAL-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-CTPO-F(WSS-J).                                
           MOVE SPACES TO WSS-CAI-CPTO-F(WSS-J).                                
           MOVE SPACES TO WSS-IIC-CPTO-F(WSS-J).                                
           MOVE SPACES TO WSS-IND-TPLT-F(WSS-J).                                
           MOVE ZEROES TO WSS-FEC-RINI-F(WSS-J).                                
           MOVE ZEROES TO WSS-HRA-RINI-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-TOOC-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-AOOC-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-EVEN-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-VCOC-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-MNTO-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-PLZO-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-UTPZ-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-BASE-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-PFIL-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-VCVL-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-BCTI-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-PBTI-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-BPBT-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-SPBT-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-CVTI-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-TFPR-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-PREP-F(WSS-J).                                
           MOVE SPACES TO WSS-MSC-UTPR-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-SIST-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-EVET-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-VCPL-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-DINI-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-MINI-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-SINI-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-AINI-F(WSS-J).                                
           MOVE ZEROES TO WSS-HRA-HINI-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-LREC-F(WSS-J).                                
           MOVE ZEROES TO WSS-NUM-IREL-F(WSS-J).                                
           MOVE SPACES TO WSS-VRF-IREL-F(WSS-J).                                
           MOVE SPACES TO WSS-IND-IREL-F(WSS-J).                                
           MOVE SPACES TO WSS-GLS-IREL-F(WSS-J).                                
           MOVE SPACES TO WSS-CAI-IRCC-F(WSS-J).                                
           MOVE ZEROES TO WSS-IIC-IRCC-F(WSS-J).                                
           MOVE ZEROES TO WSS-SGV-CFND-F(WSS-J).                                
           MOVE SPACES TO WSS-COD-FRGO-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-TDCT-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-TRCG-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-TMIN-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-TMAX-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-VTMC-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-CFND-F(WSS-J).                                
           MOVE ZEROES TO WSS-VAL-RORA-F(WSS-J).                                
           MOVE SPACES TO WSS-CIC-PLTP-F(WSS-J).                                
           GO TO INI-CLR-ALL-VTRF.                                              
       FIN-CLR-ALL-VTRF.                                                        
           EXIT.                                                                
                                                                                
       EDT-VAL-TRF SECTION.                                                     
       INI-EDT-VAL-TRF.                                                         
           MOVE WSS-VAL-MNTO-TRF   TO FRM-VAL-MNTO-R-EDT.                       
           MOVE WSS-NUM-PLZO-TRF   TO FRM-NUM-PLZO-R-EDT.                       
           MOVE WSS-VAL-BASE-TRF   TO FRM-VAL-BASE-R-EDT.                       
           MOVE WSS-VAL-PFIL-TRF   TO FRM-VAL-PFIL-R-EDT.                       
           MOVE WSS-NUM-PREP-TRF   TO FRM-NUM-PREP-R-EDT.                       
           MOVE WSS-HRA-HINI-TRF   TO FRM-HRA-HINI-R-EDT.                       
           MOVE WSS-NUM-IREL-TRF   TO FRM-NUM-IREL-EDT.                         
           MOVE WSS-IIC-IRCC-TRF   TO FRM-IIC-IRCC-R-EDT.                       
           MOVE WSS-SGV-CFND-TRF   TO FRM-SGV-CFND-R-EDT.                       
           MOVE WSS-VAL-TDCT-TRF   TO FRM-VAL-TDCT-R-EDT.                       
           MOVE WSS-VAL-TRCG-TRF   TO FRM-VAL-TRCG-R-EDT.                       
                                                                                
           MOVE FRM-VAL-MNTO-R-EDT TO WSS-VAL-MNTO-TRF-ALF.                     
           MOVE FRM-NUM-PLZO-R-EDT TO WSS-NUM-PLZO-TRF-ALF.                     
           MOVE FRM-VAL-BASE-R-EDT TO WSS-VAL-BASE-TRF-ALF.                     
           MOVE FRM-VAL-PFIL-R-EDT TO WSS-VAL-PFIL-TRF-ALF.                     
           MOVE FRM-NUM-PREP-R-EDT TO WSS-NUM-PREP-TRF-ALF.                     
           MOVE FRM-HRA-HINI-R-EDT TO WSS-HRA-HINI-TRF-ALF.                     
           MOVE FRM-NUM-IREL-EDT   TO WSS-NUM-IREL-TRF-ALF.                     
           MOVE FRM-IIC-IRCC-R-EDT TO WSS-IIC-IRCC-TRF-ALF.                     
           MOVE FRM-SGV-CFND-R-EDT TO WSS-SGV-CFND-TRF-ALF.                     
           MOVE FRM-VAL-TDCT-R-EDT TO WSS-VAL-TDCT-TRF-ALF.                     
           MOVE FRM-VAL-TRCG-R-EDT TO WSS-VAL-TRCG-TRF-ALF.                     
       FIN-EDT-VAL-TRF.                                                         
           EXIT.                                                                
                                                                                
       COPY MC2BGTRF.
       COPY MC2BGMCT.                                                           
       COPY GNSBGCIC.                                                           
       COPY GNSBFCIC.                                                           
                                                                                
       COPY SGCBGCLI.
       COPY GNSBEGLS.                                                   
       COPY GNSBVCOD.                                                          
       COPY TABBVOFI.                                                   

       COPY DEUBFCRI.                                                           
                                                                                
       COPY SGCBFDBC.                                                   
       COPY SGCBFDCP.                                                   
       COPY SGCBFAEP.
       COPY SGCBFDCE.
       COPY SGCBFRCO.                                                           
       COPY SGCBFOPE.                                                           
       COPY SGCBFDCC.                                                           
       COPY SGCBFREC.                                                           
                                                                                
       COPY TABBFOFI.                                                   
       COPY MC2BFPLN.                                                           
       COPY MC2BFPRD.                                                           
       COPY MC2BFAGD.                                                           
       COPY TABBFCAM.                                                           
       COPY MC2BFCIN.                                                           
       COPY MC2BFPTI.                                                           
       COPY MC2BFSGS.                                                           
                                                                                
       COPY MC2BFCGN.                                                           
       COPY MC2BFDGN.                                                           
       COPY MC2BFCCM.                                                           
       COPY MC2BFDCM.                                                           
                                                                                
       COPY TABBFTXC.                                                           
                                                                                
       COPY MC2BFCVN.                                                           
       COPY MC2BFDEC.                                                           
       COPY MC2BFDPC.                                                           
       COPY TABBGOCI.                                                           
                                                                                
       COPY COLBFRDC.                                                           
       COPY COLBFEVC.                                                           
       COPY COLBFDLC.                                                           
       COPY COLBFVEN.                                                           
       COPY COLBFOPC.                                                           
       COPY COLBFTOC.                                                           
      *PVG INI 02-OCT-2009 USO LEM                                              
      *COPY COLBFPOC.                                                           
      *PVG FIN 02-OCT-2009                                                      
                                                                                
       COPY GNSBVTAB.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBGPES.                                                           
      *>>>>
      *INI-MFC TUXEDO ORACLE
       COPY MC2ZQTRF.
      *FIN-MFC TUXEDO ORACLE
