       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   MC2PUPDM.
       AUTHOR.       BEE.
       DATE-WRITTEN. 13-May-19 11:40 AM.

      * NOMBRE PROGRAMA                   MC2PUPDM
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      MC2PDM
      * PANTALLA                          MC2PDM
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-MC2PUPDM-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$MC2PUPDM$ SKL=$08.07.21$ VSN=${vsnpu}$        
      -    'GEN=$13-May-19 11:40 AM$ FNC=${fncpu}$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
           03  SCR-VARI-PFS.
               05  SCR-DPD-KEY-IDPD.
                   07 SCR-DPD-CIC-IDPD              PIC X(12).
                   07 SCR-DPD-NUM-IDPD              PIC 9(03).
           03  SCR-UMOD-PDM            VALUE SPACES PIC X(14).
      *>>>>
       COPY MC2WIPDM.
       COPY MC2BRPDM.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PDM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGSYS.

      *<<<< WSS
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGCIC.
       COPY MC2BRDPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DPD-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY MC2WGDPD.
       COPY MC2WXDPD.
       01  WSS-VARI.
           03 WSS-COD-MENY        VALUE SPACES          PIC X(12).
           03 WSS-COD-MENN        VALUE SPACES          PIC X(12).
           03 WSS-K               VALUE ZEROES          PIC 9(03).
           03 WSS-R               VALUE ZEROES          PIC 9(03).
           03 WSS-L               VALUE ZEROES          PIC 9(03).
           03 WSS-RDPD            VALUE ZEROES          PIC 9(03).

      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-PDM.
                 88 PGM-STAT-PDM-NUL    VALUE '  '.
                 07 PGM-STT1-PDM        VALUE '2' PIC X(01).
                    88 PGM-STAT-PDM-OKS VALUE '0'.
                 07 PGM-STT2-PDM        VALUE '3' PIC X(01).
              05 PGM-STAT-DPD.
                 88 PGM-STAT-DPD-NUL    VALUE '  '.
                 07 PGM-STT1-DPD        VALUE '2' PIC X(01).
                    88 PGM-STAT-DPD-OKS VALUE '0'.
                 07 PGM-STT2-DPD        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 DFH-CMMA OCCURS 3000 PIC X(01).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO PDM-FLD.
           MOVE LOW-VALUES TO PDM-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +3000 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'MC2PUPDM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO DPD-COD-TERM
                MOVE TSK-TERM-ALF TO DPD-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO DPD-COD-TERM
                MOVE EIBTRMID     TO DPD-COD-TERM-MAS.
      *    CARGA VALORES POR DEFECTO DESDE TABLA PDM BASE
           MOVE 'N'   TO VRF-PDM-PLBR IN PDM-VARI.
           MOVE 'N'   TO VRF-PDM-PDCC IN PDM-VARI.
           MOVE 'N'   TO VRF-PDM-PDCG IN PDM-VARI.

           MOVE 100   TO VRF-PDM-IMAX IN PDM-VARI.
           MOVE 'LBR' TO VRF-PDM-ILBR IN PDM-VARI.
           MOVE 'CLT' TO VRF-PDM-IDCC IN PDM-VARI.
           MOVE 'GRP' TO VRF-PDM-IDCG IN PDM-VARI.

           MOVE 'MC2'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'PDM'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INI.
           IF (TAB-COD-DAT3 IN TAB(1) > SPACES   AND
               TAB-COD-DAT3 IN TAB(1) IS NUMERIC AND
               TAB-COD-DAT3 IN TAB(1) NOT > 100)
              MOVE TAB-COD-DAT3 IN TAB(1) TO VRF-PDM-IMAX IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(2) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(2) TO VRF-PDM-ILBR IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(3) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(3) TO VRF-PDM-IDCC IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(4) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(4) TO VRF-PDM-IDCG IN PDM-VARI.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-PDM.
           PERFORM EDT-KEY-PDM.
           PERFORM EDT-FLD-PDM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-PDM
               PERFORM EDT-KEY-PDM
               PERFORM EDT-FLD-PDM
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-PDM
               PERFORM EDT-KEY-PDM
           ELSE
               PERFORM CLR-FLD-PDM
               PERFORM EDT-FLD-PDM.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO PDM-FLD.
           MOVE LOW-VALUES TO PDM-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-STT-PDM.
           PERFORM RET-ALL-PDM.
           PERFORM RET-HDR-PDM.
      *<<<< CMN_MOD
           MOVE 'M' TO PDM-MSC-STAT IN PDM.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-MOD.
           MOVE PDM-CIC-IPDM IN PDM     TO DPD-CIC-IDPD IN DPD.
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'ERRUPD   DPD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           PERFORM RET-STT-DPD.
           PERFORM RET-DPD-PDM.
           PERFORM RET-HDR-DPD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           MOVE 'MC2'               TO FIO-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           MOVE FRM-GLS-DES1 IN PDM-FLD TO TAB-GLS-DESC IN TAB.
           MOVE FRM-GLS-DES2 IN PDM-FLD TO TAB-GLS-DATA IN TAB.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.
      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO PDM.
      *<<<< INI_CMN_ING
           IF DPD-NUM-IDPD IN PDM-FLD > 1
              MOVE '00' TO FIO-STAT
              GO TO CNT-CMN-ING.
           PERFORM OBT-CIC-PDM.
           IF CIC-STAT NOT = CIC-STAT-OKS
              GO TO FIN-CMN-ING.
           MOVE CIC-CAI-ICIC IN CIC TO PDM-CAI-IPDM IN PDM.
           MOVE CIC-IIC-ICIC IN CIC TO PDM-IIC-IPDM IN PDM.
           MOVE CIC-CIC-ICIC IN CIC TO PDM-CIC-IPDM IN PDM-FLD.
      *>>>>
           PERFORM RET-STT-PDM.
           PERFORM RET-ALL-PDM.
           PERFORM RET-HDR-PDM.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *<<<< FIN_CMN_ING
       CNT-CMN-ING.
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ING.
           PERFORM RET-STT-DPD.
           PERFORM KEY-DPD-PDM.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           PERFORM RET-DPD-PDM.
           PERFORM RET-HDR-DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-STAT TO PGM-STAT-PDM PGM-STAT-DPD
              GO TO FIN-CMN-ING.

           IF DPD-NUM-IDPD IN PDM-FLD = 1
              MOVE 'MC2'                   TO FIO-SIST
              MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB
              MOVE DPD-CIC-IDPD IN DPD     TO TAB-COD-CTAB IN TAB
              MOVE FRM-GLS-DES1 IN PDM-FLD TO TAB-GLS-DESC IN TAB
              MOVE FRM-GLS-DES2 IN PDM-FLD TO TAB-GLS-DATA IN TAB
              MOVE 'I'                     TO TAB-MSC-TACC IN TAB
              MOVE 'I'                     TO TAB-MSC-STAT IN TAB
              MOVE 'S'                     TO TAB-IND-VIGE IN TAB
              MOVE SPACES                  TO TAB-COD-OTRN IN TAB
              MOVE 'MC2PUPDM'              TO TAB-COD-ATRN IN TAB
              MOVE DPD-CAI-IDPD IN DPD     TO TAB-GLS-DCOR IN TAB
              MOVE DPD-IIC-IDPD IN DPD     TO TAB-GLS-ABRV IN TAB
              PERFORM GET-FHOY
              MOVE HOY-FHOY                TO TAB-FEC-FTRN IN TAB
              MOVE HOY-HHOY                TO TAB-HRA-HRTR IN TAB
              MOVE SCR-OTRN                TO TAB-COD-OTRN IN TAB
              MOVE SCR-USER                TO TAB-COD-ATRN IN TAB
              MOVE FIO-PUT TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 MOVE 'MC2'                TO MSG-COD-SIST
                 MOVE 'DPL    NOGRB'       TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC         TO FRM-MENS
                 GO TO FIN-CMN-ING.

      *MODIFICA ESTADO PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-CMN-ING.
           PERFORM RET-STT-PDM.
           PERFORM RET-HDR-PDM.
           PERFORM RET-ALL-PDM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'VRF'
               PERFORM PRO-CMN-VRF
               IF MSG-COD-MENS IN MSG > SPACES
                  GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
      *    PERFORM RET-ALL-PDM.
      *<<<< CMN_ACC
           IF SCR-CMND = 'VRF'
               MOVE 'V'          TO PDM-IND-VIGE IN PDM
               MOVE 'VRFYES    ' TO WSS-COD-MENY
               MOVE 'VRFNOT    ' TO WSS-COD-MENN
           ELSE
           IF SCR-CMND = 'ACA'
               MOVE 'A'          TO PDM-IND-VIGE IN PDM
               MOVE 'ACAYES    ' TO WSS-COD-MENY
               MOVE 'ACANOT    ' TO WSS-COD-MENN
           ELSE
           IF SCR-CMND = 'ANL'
               MOVE 'D'          TO PDM-IND-VIGE IN PDM
               MOVE 'ANLYES    ' TO WSS-COD-MENY
               MOVE 'ANLNOT    ' TO WSS-COD-MENN.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
               MOVE 'S' TO SCR-IERR
               MOVE 'MC2' TO MSG-COD-SIST
               MOVE WSS-COD-MENN TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE WSS-COD-MENY  TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.

           IF SCR-CMND NOT = 'ANL'
              GO TO FIN-CMN-ACC.
           MOVE 'MC2' TO FIO-SIST.
           MOVE 'DPL' TO TAB-COD-TTAB IN TAB.
           MOVE PDM-CIC-IPDM IN PDM TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS
                 PERFORM GET-FHOY
                 MOVE HOY-FHOY TO TAB-FEC-FTRN IN TAB
                 MOVE HOY-HHOY TO TAB-HRA-HRTR IN TAB
                 MOVE SCR-OTRN TO TAB-COD-OTRN IN TAB
                 MOVE SCR-USER TO TAB-COD-ATRN IN TAB
                 MOVE 'N'      TO TAB-IND-VIGE IN TAB
                 MOVE FIO-MOD  TO FIO-CMND
                 PERFORM GNS-FIO-TAB
                 IF NOT FIO-STAT-OKS
                    MOVE 'ERROR UPD DPL' TO FRM-MEN2
                 ELSE
                    NEXT SENTENCE
              ELSE
                 MOVE 'ERROR UPD DPL' TO FRM-MEN2
           ELSE
              MOVE 'ERROR UPD DPL' TO FRM-MEN2.
           GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-PDM.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-PDM.
           GO TO CNT-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *<<<< FIN_CMN_ELI
           MOVE FIO-STAT TO PGM-STAT-PDM.
       CNT-CMN-ELI.
           IF FRM-IND-SGTE IN PDM-FLD = 'S'
              PERFORM ELI-ALL-PDM
              GO TO FIN-CMN-ELI.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF FIO-STAT-OKS AND
              DPD-STP-ITRN IN DPD NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ELI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-ELI.

           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF (FIO-STAT-OKS AND
               DPD-CIC-IDPD IN DPD = PDM-CIC-IPDM IN PDM-FLD)
              MOVE PGM-STAT-DPD TO FIO-STAT
              PERFORM MOD-STAT-PDM
              GO TO FIN-CMN-ELI.

           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-ELI.
           MOVE 'MC2'               TO FIO-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-CMN-ELI.
           GO TO FIN-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-PDM.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE PDM-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO PDM-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-PDM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO PDM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-PDM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-PDM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-PDM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-PDM
               PERFORM EDT-FLD-PDM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-PDM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-PDM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-PDM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-PDM.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-PDM.
           PERFORM EDT-FLD-PDM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO PDM-GLS-MEN2
               MOVE SCR-PRMT     TO PDM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO PDM-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-PDM
               PERFORM VAL-NUM-FLD-PDM.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                               FRM-FFLD-PF7 OR FRM-FFLD-PF8)           
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO PDM-GLS-MEN2
               MOVE SCR-PRMT     TO PDM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO PDM-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO PDM-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE PDM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO PDM-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-PDM

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO PDM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO PDM-GLS-MENS.
           PERFORM PRO-FLD-PDM.
           PERFORM PRO-MKY-PDM.
           PERFORM UNP-IKY-PDM.
           PERFORM FST-KEY-PDM.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE PDM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO PDM-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO PDM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO PDM-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-PDM.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-PDM.
           PERFORM FST-KEY-PDM.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-PDM.
           PERFORM UNP-FLD-PDM.
           PERFORM FST-FLD-PDM.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO PDM-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-PDM.
           PERFORM PRO-FLD-PDM.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-PDM
               PERFORM EDT-FLD-PDM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-PDM
               PERFORM EDT-FLD-PDM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-PDM.
           PERFORM EDT-FLD-PDM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-PDM.
           PERFORM PRO-FLD-PDM.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-PDM
               PERFORM EDT-FLD-PDM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO PDM-GLS-MEN2
               MOVE SCR-CONF     TO PDM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO PDM-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-PDM
               PERFORM VAL-NUM-FLD-PDM
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-PDM
                   PERFORM VAL-NUM-FLD-PDM
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       RET-STT-PDM SECTION.
       INI-RET-STT-PDM.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO PDM-MSC-TACC IN PDM
               MOVE 'I' TO PDM-MSC-STAT IN PDM
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO PDM-MSC-TACC IN PDM
               MOVE 'M' TO PDM-MSC-STAT IN PDM.
       FIN-RET-STT-PDM.
           EXIT.

       RET-HDR-PDM SECTION.
       INI-RET-HDR-PDM.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO PDM-FEC-FTRN IN PDM.
      *    Hora Transaccion
           MOVE HOY-HHOY TO PDM-HRA-HRTR IN PDM.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO PDM-COD-OTRN IN PDM.
      *    Autor Transaccion
           MOVE SCR-USER TO PDM-COD-ATRN IN PDM.
      *>>>>
       FIN-RET-HDR-PDM.
           EXIT.

       COPY MC2BUPDM.
       COPY GNSBVNUM.
       COPY MC2BFPDM.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        

       COPY MC2BFDPD.
       COPY GNSBGVSM.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBTAB.
       COPY GNSBVMSC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBFMSC.                                                   
      *<<<< EOF_PU
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBVIND.

       OBT-CIC-PDM SECTION.
       INI-OBT-CIC-PDM.
           MOVE 'PPDM'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS     TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-OBT-CIC-PDM.
           EXIT.

       RET-STT-DPD SECTION.
       INI-RET-STT-DPD.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DPD-MSC-TACC IN DPD
               MOVE 'I' TO DPD-MSC-STAT IN DPD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DPD-MSC-TACC IN DPD
               MOVE 'M' TO DPD-MSC-STAT IN DPD.
       FIN-RET-STT-DPD.
           EXIT.

       RET-HDR-DPD SECTION.
       INI-RET-HDR-DPD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DPD-FEC-FTRN IN DPD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DPD-HRA-HRTR IN DPD.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO DPD-COD-OTRN IN DPD.
      *    Autor Transaccion
           MOVE SCR-USER TO DPD-COD-ATRN IN DPD.
      *>>>>
       FIN-RET-HDR-DPD.
           EXIT.

       MOD-STAT-PDM SECTION.
       INI-MOD-STAT-PDM.
      *MODIFICA ESTADO PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-MOD-STAT-PDM.
           MOVE 'M' TO PDM-IND-VIGE IN PDM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-MOD-STAT-PDM.
      *    ACTUALIZA CORRELATIVO POST ELI UNITARIA
      *    PERFORM PRO-ACT-NCOR.
       FIN-MOD-STAT-PDM.
           EXIT.

       ELI-ALL-DPD SECTION.
       INI-ELI-ALL-DPD.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
              GO TO FIN-ELI-ALL-DPD.

           MOVE DPD-GLS-FLAG IN DPD TO VEC-DPD-GLS-FLAG(01).
           MOVE DPD-CIC-IDPD IN DPD TO VEC-DPD-CIC-IDPD(01).
           MOVE DPD-NUM-IDPD IN DPD TO VEC-DPD-NUM-IDPD(01).
           MOVE DPD-FEC-FTRN IN DPD TO VEC-DPD-FEC-FTRN(01).
           MOVE DPD-HRA-HRTR IN DPD TO VEC-DPD-HRA-HRTR(01).
           MOVE DPD-MSC-TACC IN DPD TO VEC-DPD-MSC-TACC(01).
           MOVE DPD-MSC-STAT IN DPD TO VEC-DPD-MSC-STAT(01).
           MOVE DPD-COD-OTRN IN DPD TO VEC-DPD-COD-OTRN(01).
           MOVE DPD-COD-ATRN IN DPD TO VEC-DPD-COD-ATRN(01).
           MOVE DPD-NUM-PRIO IN DPD TO VEC-DPD-NUM-PRIO(01).
           MOVE DPD-COD-PRIO IN DPD TO VEC-DPD-COD-PRIO(01).
           MOVE DPD-GLS-DISP IN DPD TO VEC-DPD-GLS-DISP(01).

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DPDVRF NOUPD' TO MSG-COD-MENS
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              GO TO FIN-ELI-ALL-DPD.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DPDVRF NODEL' TO MSG-COD-MENS
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              GO TO FIN-ELI-ALL-DPD.
           GO TO INI-ELI-ALL-DPD.
       FIN-ELI-ALL-DPD.
           EXIT.

       PUT-NEW-DPD SECTION.
       INI-PUT-NEW-DPD.
           MOVE ZEROES TO WSS-R.
           MOVE ZEROES TO WSS-RDPD.                                     
           MOVE WSS-K  TO WSS-L.
       LUP-PUT-NEW-DPD.
           IF WSS-L NOT > ZEROES
               GO TO FIN-PUT-NEW-DPD.
           ADD 1 TO WSS-R.
           PERFORM CRG-VEC-DPD.
           IF VEC-DPD-GLS-FLAG(WSS-R) = 'E'                             
              GO TO CNT-PUT-NEW-DPD.                                    
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF1NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-NEW-DPD.
       CNT-PUT-NEW-DPD.                                                 
           SUBTRACT 1 FROM WSS-L.
           GO TO LUP-PUT-NEW-DPD.
       FIN-PUT-NEW-DPD.
           EXIT.

       CRG-DPD-VEC SECTION.
       INI-CRG-DPD-VEC.
           MOVE DPD-GLS-FLAG IN DPD TO VEC-DPD-GLS-FLAG(WSS-K).
           MOVE DPD-CIC-IDPD IN DPD TO VEC-DPD-CIC-IDPD(WSS-K).
           MOVE DPD-NUM-IDPD IN DPD TO VEC-DPD-NUM-IDPD(WSS-K).
           MOVE DPD-FEC-FTRN IN DPD TO VEC-DPD-FEC-FTRN(WSS-K).
           MOVE DPD-HRA-HRTR IN DPD TO VEC-DPD-HRA-HRTR(WSS-K).
           MOVE DPD-MSC-TACC IN DPD TO VEC-DPD-MSC-TACC(WSS-K).
           MOVE DPD-MSC-STAT IN DPD TO VEC-DPD-MSC-STAT(WSS-K).
           MOVE DPD-COD-OTRN IN DPD TO VEC-DPD-COD-OTRN(WSS-K).
           MOVE DPD-COD-ATRN IN DPD TO VEC-DPD-COD-ATRN(WSS-K).
           MOVE DPD-NUM-PRIO IN DPD TO VEC-DPD-NUM-PRIO(WSS-K).
           MOVE DPD-COD-PRIO IN DPD TO VEC-DPD-COD-PRIO(WSS-K).
           MOVE DPD-GLS-DISP IN DPD TO VEC-DPD-GLS-DISP(WSS-K).
       FIN-CRG-DPD-VEC.
           EXIT.

       CRG-VEC-DPD SECTION.
       INI-CRG-VEC-DPD.
           IF VEC-DPD-GLS-FLAG(WSS-R) = 'E'                             
              GO TO FIN-CRG-VEC-DPD.                                    
           ADD 1 TO WSS-RDPD.

           MOVE VEC-DPD-GLS-FLAG(WSS-R) TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(WSS-R) TO DPD-CIC-IDPD IN DPD.
           MOVE WSS-RDPD                TO DPD-NUM-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(WSS-R) TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(WSS-R) TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(WSS-R) TO DPD-MSC-TACC IN DPD.
           MOVE 'V'                     TO DPD-MSC-STAT IN DPD.
           MOVE VEC-DPD-COD-OTRN(WSS-R) TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(WSS-R) TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-NUM-PRIO(WSS-R) TO DPD-NUM-PRIO IN DPD.
           MOVE VEC-DPD-COD-PRIO(WSS-R) TO DPD-COD-PRIO IN DPD.
           MOVE VEC-DPD-GLS-DISP(WSS-R) TO DPD-GLS-DISP IN DPD.
       FIN-CRG-VEC-DPD.
           EXIT.

       ELI-ALL-PDM SECTION.
       INI-ELI-ALL-PDM.
           PERFORM ELI-ALL-DPD.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-ELI-ALL-PDM.
      *ELIMINA PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ELI-ALL-PDM.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ELI-ALL-PDM.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-ELI-ALL-PDM.

      *ELIMINA DPL
           MOVE 'MC2'                   TO FIO-SIST.
           MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-ELI-ALL-PDM.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-ELI-ALL-PDM.
           GO TO FIN-ELI-ALL-PDM.
       MSG-ELI-ALL-PDM.
           IF MSG-COD-SIST NOT > SPACES
              MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE 'S' TO SCR-IERR.
       FIN-ELI-ALL-PDM.
           EXIT.
                                                                        
      *PRO-ACT-NCOR SECTION.
      *INI-PRO-ACT-NCOR.
      *    PERFORM CLR-VEC-VRF.
      *    MOVE SPACES TO MSG-COD-MENS.
      *    MOVE ZEROES TO WSS-K.
      *    MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
      *    MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
      *    MOVE FIO-GET-NLS TO FIO-CMND.
      *LUP-PRO-ACT-NCOR.
      *    PERFORM MC2-FIO-DPD.
      *    IF NOT FIO-STAT-OKS
      *       GO TO CNT-PRO-ACT-NCOR.
      *    IF NOT (PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
      *       MOVE FIO-END-BRW TO FIO-CMND
      *       PERFORM MC2-FIO-DPD
      *       GO TO CNT-PRO-ACT-NCOR.
      *
      *    ADD 1 TO WSS-K.
      *    PERFORM CRG-DPD-VEC.
      *    MOVE FIO-GET-NXT TO FIO-CMND.
      *    GO TO LUP-PRO-ACT-NCOR.
      *CNT-PRO-ACT-NCOR.
      *    PERFORM ELI-ALL-DPD.
      *    IF MSG-COD-MENS > SPACES
      *       GO TO MSG-PRO-ACT-NCOR.
      *
      *    PERFORM PUT-NEW-DPD.
      *    IF MSG-COD-MENS > SPACES
      *        GO TO MSG-PRO-ACT-NCOR.
      *    GO TO FIN-PRO-ACT-NCOR.
      *MSG-PRO-ACT-NCOR.
      *    IF MSG-COD-SIST NOT > SPACES
      *       MOVE 'TAB' TO MSG-COD-SIST.
      *    PERFORM GET-MSG.
      *    MOVE MSG-GLS-DESC TO FRM-MEN1.
      *    MOVE 'S'  TO SCR-IERR.
      *    MOVE '00' TO FIO-STAT.
      *    MOVE SCR-STAT-CON TO SCR-STAT.
      *    GO TO FIN-PRO-ACT-NCOR.
      *FIN-PRO-ACT-NCOR.
      *    EXIT.

       PRO-CMN-VRF SECTION.
       INI-PRO-CMN-VRF.
           MOVE 'N'    TO VRF-PDM-PLBR IN PDM-VARI.
           MOVE 'N'    TO VRF-PDM-PDCC IN PDM-VARI.
           MOVE 'N'    TO VRF-PDM-PDCG IN PDM-VARI.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE SPACES TO VRF-GLS-MEN2 IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-E    IN PDM-VARI.

           PERFORM CLR-VEC-VRF.

           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-CMN-VRF.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
              GO TO CNT-PRO-CMN-VRF.

           IF VRF-COD-INFO(DPD-NUM-PRIO IN DPD) NOT > SPACES
              MOVE DPD-COD-PRIO IN DPD TO 
                   VRF-COD-INFO(DPD-NUM-PRIO IN DPD)
              MOVE DPD-NUM-PRIO IN DPD TO 
                   VRF-NUM-INFO(DPD-NUM-PRIO IN DPD)
           ELSE
              MOVE 'PRDDUPL  DPD' TO MSG-COD-MENS IN MSG
              ADD 1 TO VRF-PDM-E IN PDM-VARI
              IF VRF-PDM-E IN PDM-VARI NOT > VRF-PDM-EMAX IN PDM-VARI
                 MOVE DPD-NUM-PRIO IN DPD TO 
                      VRF-GLS-DET(VRF-PDM-E IN PDM-VARI)
                 MOVE '-' TO      
                      VRF-IND-DET(VRF-PDM-E IN PDM-VARI).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-CMN-VRF.
       CNT-PRO-CMN-VRF.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.

      * VERIFICACION PRIORIDAD DUPLICADAS
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.
      
      * VERIFICACION CONCEPTOS DUPLICADOS
           PERFORM VAL-CPT-DUPL.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

      * 
           PERFORM OBT-PDM-DFLT.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

      * 
           PERFORM OBT-NEW-VPDM.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

           PERFORM ELI-ALL-DPD.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-PRO-CMN-VRF.

           PERFORM PUT-VRF-RDPD.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-PRO-CMN-VRF.
           GO TO FIN-PRO-CMN-VRF.
       MSG-PRO-CMN-VRF.
           IF MSG-COD-SIST NOT > SPACES
              MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           IF VRF-GLS-MEN2 IN PDM-VARI > SPACES
              MOVE VRF-GLS-MEN2 IN PDM-VARI TO FRM-MEN2
           ELSE
           IF VRF-GLS-MEN3 IN PDM-VARI > SPACES
              MOVE VRF-GLS-MEN3 IN PDM-VARI TO FRM-MEN2.
           MOVE 'S' TO SCR-IERR.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-PRO-CMN-VRF.
           EXIT.

       CLR-VEC-VRF SECTION.
       INI-CLR-VEC-VRF.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
       LUP-CLR-VEC-VRF.
           ADD 1 TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-CLR-VEC-VRF.
           MOVE SPACES TO VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI).
           MOVE SPACES TO VRF-COD-INFO(VRF-PDM-D IN PDM-VARI).
           MOVE ZEROES TO VRF-NUM-INFO(VRF-PDM-D IN PDM-VARI).
           GO TO LUP-CLR-VEC-VRF.
       FIN-CLR-VEC-VRF.
           EXIT.

       OBT-PDM-DFLT SECTION.
       INI-OBT-PDM-DFLT.
           IF (PDM-CAI-PRIO IN PDM-FLD = 'PDM ' AND
               PDM-IIC-PRIO IN PDM-FLD = 'DEFAULT ')
               PERFORM PRO-CRG-PDFL
               GO TO FIN-OBT-PDM-DFLT.
           MOVE PDM-KEY-IPDM IN PDM TO VRF-KEY-IPDM IN PDM-VARI.
           MOVE DPD-KEY-IDPD IN DPD TO VRF-KEY-IDPD IN PDM-VARI.

           MOVE 'MC2'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'PDMDEFAULT  ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              MOVE 'VSNPDMDF NEX' TO MSG-COD-MENS IN MSG
              GO TO FIN-OBT-PDM-DFLT.

           MOVE TAB-GLS-DATA IN TAB TO PDM-KEY-IPDM IN PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT (FIO-STAT-OKS AND PDM-MSC-STAT IN PDM = 'A')
              MOVE 'REGPDMDF NEX' TO MSG-COD-MENS IN MSG
              GO TO FIN-OBT-PDM-DFLT.

           MOVE PDM-CIC-IPDM IN PDM TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES              TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-PDM-DFLT.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM = DPD-CIC-IDPD IN DPD)
              GO TO CNT-OBT-PDM-DFLT.

           MOVE DPD-COD-PRIO IN DPD TO
                VRF-COD-DFLT(DPD-NUM-PRIO IN DPD).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-OBT-PDM-DFLT.
       CNT-OBT-PDM-DFLT.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.
       FIN-OBT-PDM-DFLT.
           MOVE VRF-KEY-IPDM IN PDM-VARI TO PDM-KEY-IPDM IN PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE VRF-KEY-IDPD IN PDM-VARI TO DPD-KEY-IDPD IN DPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
       EXT-OBT-PDM-DFLT.
           EXIT.

       OBT-NEW-VPDM SECTION.
       INI-OBT-NEW-VPDM.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
       LUP-OBT-NEW-VPDM.
           ADD 1       TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-OBT-NEW-VPDM.
           IF VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) NOT > SPACES
              GO TO FIN-OBT-NEW-VPDM.
           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-L IN PDM-VARI.
       LUP-OBT-NEW-VPDM-I.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              MOVE ZEROES TO VRF-PDM-I IN PDM-VARI
              GO TO CNT-OBT-NEW-VPDM-I.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) NOT > SPACES AND
               VRF-PDM-L IN PDM-VARI NOT > ZEROES)
              MOVE VRF-PDM-I IN PDM-VARI TO VRF-PDM-L IN PDM-VARI.
           IF (VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) =
               VRF-COD-INFO(VRF-PDM-I IN PDM-VARI))
              GO TO NXT-OBT-NEW-VPDM.
       NXT-OBT-NEW-VPDM-I.
           GO TO LUP-OBT-NEW-VPDM-I.
       CNT-OBT-NEW-VPDM-I.
           MOVE VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) TO
                VRF-COD-INFO(VRF-PDM-L IN PDM-VARI).
       NXT-OBT-NEW-VPDM.
           GO TO LUP-OBT-NEW-VPDM.
       FIN-OBT-NEW-VPDM.
           EXIT.

       PUT-VRF-RDPD SECTION.
       INI-PUT-VRF-RDPD.
           MOVE 1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-ILBR IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF2NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PLBR IN PDM-VARI.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-IDCC IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF3NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PDCC IN PDM-VARI.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-IDCG IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF4NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PDCG IN PDM-VARI.

           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
       LUP-PUT-VRF-RDPD.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-PUT-VRF-RDPD.
           IF VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) NOT > SPACES
              GO TO FIN-PUT-VRF-RDPD.

           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-ILBR IN PDM-VARI AND 
               VRF-PDM-PLBR IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-IDCC IN PDM-VARI AND 
               VRF-PDM-PDCC IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-IDCG IN PDM-VARI AND 
               VRF-PDM-PDCG IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) TO
                                            DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF5NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
       NXT-PUT-VRF-RDPD.
           GO TO LUP-PUT-VRF-RDPD.
       FIN-PUT-VRF-RDPD.
           EXIT.

       VAL-CPT-DUPL SECTION.
       INI-VAL-CPT-DUPL.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
           MOVE SPACES TO VRF-GLS-MEN3 IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-F    IN PDM-VARI.
       LUP-VAL-CPT-DUPL.
           ADD 1 TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-VAL-CPT-DUPL.
           IF VRF-COD-INFO(VRF-PDM-D IN PDM-VARI) NOT > SPACES
              GO TO NXT-VAL-CPT-DUPL.
           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
       LUP-VAL-CPT-DUPL-I.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO NXT-VAL-CPT-DUPL.
           IF VRF-PDM-I IN PDM-VARI = VRF-PDM-D IN PDM-VARI
              GO TO NXT-VAL-CPT-DUPL-I.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-COD-INFO(VRF-PDM-D IN PDM-VARI))
               MOVE 'CPTDUPL  DPD' TO MSG-COD-MENS IN MSG
               ADD 1 TO VRF-PDM-F IN PDM-VARI
               IF VRF-PDM-F IN PDM-VARI NOT > VRF-PDM-FMAX IN PDM-VARI
                  MOVE VRF-COD-INFO(VRF-PDM-D IN PDM-VARI) TO
                       VRF-GLS-DET3(VRF-PDM-F IN PDM-VARI)
                  MOVE '-' TO      
                       VRF-IND-DET3(VRF-PDM-F IN PDM-VARI)
                  GO TO NXT-VAL-CPT-DUPL
               ELSE
                  GO TO NXT-VAL-CPT-DUPL.
       NXT-VAL-CPT-DUPL-I.
           GO TO LUP-VAL-CPT-DUPL-I.
       NXT-VAL-CPT-DUPL.
           GO TO LUP-VAL-CPT-DUPL.
       FIN-VAL-CPT-DUPL.
           EXIT.

       PRO-CRG-PDFL SECTION.
       INI-PRO-CRG-PDFL.
           MOVE 'LBR         ' TO VRF-COD-DFLT(01).
           MOVE 'CLT         ' TO VRF-COD-DFLT(02).
           MOVE 'GRP         ' TO VRF-COD-DFLT(03).
           MOVE 'AGRB        ' TO VRF-COD-DFLT(04).
           MOVE 'BANC        ' TO VRF-COD-DFLT(05).
           MOVE 'RTBL        ' TO VRF-COD-DFLT(06).
           MOVE 'COMP        ' TO VRF-COD-DFLT(07).
           MOVE 'AGRC        ' TO VRF-COD-DFLT(08).
           MOVE 'CCNV        ' TO VRF-COD-DFLT(09).
           MOVE 'CSEG        ' TO VRF-COD-DFLT(10).
           MOVE 'CPLN        ' TO VRF-COD-DFLT(11).
           MOVE 'CRIE        ' TO VRF-COD-DFLT(12).
           MOVE 'CNED        ' TO VRF-COD-DFLT(13).
           MOVE 'CSEX        ' TO VRF-COD-DFLT(14).
           MOVE 'CTCL        ' TO VRF-COD-DFLT(15).
           MOVE 'CICL        ' TO VRF-COD-DFLT(16).
           MOVE 'EDAD        ' TO VRF-COD-DFLT(17).
           MOVE 'CRUF        ' TO VRF-COD-DFLT(18).
           MOVE 'OFOC        ' TO VRF-COD-DFLT(19).
           MOVE 'CSEC        ' TO VRF-COD-DFLT(20).
           MOVE 'TCNL        ' TO VRF-COD-DFLT(21).
           MOVE 'CNAL        ' TO VRF-COD-DFLT(22).
           MOVE 'CTIO        ' TO VRF-COD-DFLT(23).
           MOVE 'CAUX        ' TO VRF-COD-DFLT(24).
           MOVE 'VCOC        ' TO VRF-COD-DFLT(25).
           MOVE 'GRPO        ' TO VRF-COD-DFLT(26).
           MOVE 'CPAC        ' TO VRF-COD-DFLT(27).
           MOVE 'CEJC        ' TO VRF-COD-DFLT(28).
           MOVE 'CPCG        ' TO VRF-COD-DFLT(29).
           MOVE 'CTEN        ' TO VRF-COD-DFLT(30).
           MOVE 'CAPR        ' TO VRF-COD-DFLT(31).
           MOVE 'CTBC        ' TO VRF-COD-DFLT(32).
           MOVE 'CCHQ        ' TO VRF-COD-DFLT(33).
           MOVE 'CATM        ' TO VRF-COD-DFLT(34).
           MOVE 'CTEF        ' TO VRF-COD-DFLT(35).
           MOVE 'CSNP        ' TO VRF-COD-DFLT(36).
           MOVE 'CCVP        ' TO VRF-COD-DFLT(37).
           MOVE 'CREM        ' TO VRF-COD-DFLT(38).
           MOVE 'CPCT        ' TO VRF-COD-DFLT(39).
           MOVE 'CPAT        ' TO VRF-COD-DFLT(40).
           MOVE 'CSLD        ' TO VRF-COD-DFLT(41).
           MOVE 'ULEM        ' TO VRF-COD-DFLT(42).
       FIN-PRO-CRG-PDFL.
           EXIT.
       COPY GNSBPVRF.
      *>>>>
      *INI-MFC TUXEDO ORACLE
       COPY MC2ZUPDM.
      *FIN-MFC TUXEDO ORACLE
