      *
      * MC2BQCGN
      * Version 3.0.1 Nov-2005
      * 13-May-19 10:51 AM
      *
       SET-TAG-MC2BQCGN SECTION.
       INI-SET-TAG-MC2BQCGN.
           MOVE
           '<IDNMOD NOM=$MC2BQCGN$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$13-May-19 10:51 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BQCGN.
           EXIT.
           
       PUT-ALL-CGN SECTION.
       INI-PUT-ALL-CGN.
           PERFORM PUT-CGN-CGN.
           PERFORM PUT-DGN-CGN.
       FIN-PUT-ALL-CGN.
           EXIT.
       
       PUT-CGN-CGN SECTION.
       INI-PUT-CGN-CGN.
           IF PGM-STAT-CGN-NUL
               GO TO FIN-PUT-CGN-CGN.
           IF NOT PGM-STAT-CGN-OKS
               PERFORM CLR-CGN-CGN
               GO TO FIN-PUT-CGN-CGN.
           MOVE CGN-CAI-GNOT IN CGN TO CGN-CAI-GNOT IN CGN-FLD.
           MOVE CGN-IIC-GNOT IN CGN TO CGN-IIC-GNOT IN CGN-FLD.
           MOVE CGN-COD-SIST IN CGN TO CGN-COD-SIST IN CGN-FLD.
           MOVE CGN-COD-EVEN IN CGN TO CGN-COD-EVEN IN CGN-FLD.
           MOVE CGN-IND-TPLT IN CGN TO CGN-IND-TPLT IN CGN-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CGN-NUM-DINI IN CGN TO CGN-NUM-DINI IN CGN-FLD.
           MOVE CGN-NUM-MINI IN CGN TO CGN-NUM-MINI IN CGN-FLD.
           MOVE CGN-NUM-SINI IN CGN TO CGN-NUM-SINI IN CGN-FLD.
           MOVE CGN-NUM-AINI IN CGN TO CGN-NUM-AINI IN CGN-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE CGN-HRA-HINI IN CGN TO CGN-HRA-HINI IN CGN-FLD.
           MOVE CGN-CIC-ICGN IN CGN TO CGN-CIC-ICGN IN CGN-FLD.
           MOVE CGN-IND-VIGE IN CGN TO CGN-IND-VIGE IN CGN-FLD.
           MOVE CGN-IND-DSCT IN CGN TO CGN-IND-DSCT IN CGN-FLD.
           MOVE CGN-IND-CAAB IN CGN TO CGN-IND-CAAB IN CGN-FLD.
           MOVE CGN-COD-CTAN IN CGN TO CGN-COD-CTAN IN CGN-FLD.
           MOVE CGN-EXT-CTAN IN CGN TO CGN-EXT-CTAN IN CGN-FLD.
           MOVE CGN-IND-RBHB IN CGN TO CGN-IND-RBHB IN CGN-FLD.
      *<<<< FIN_PUT_CGN_CGN
           IF CGN-COD-SIST IN CGN-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'SIS'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-SIST IN CGN-FLD.
           IF CGN-COD-EVEN IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CGN-COD-EVEN IN CGN-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EVEN IN CGN-FLD.
                                                                        
           MOVE 'MC2'               TO TAB-COD-SIST.                    
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE CGN-CIC-ICGN IN CGN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CGN-FLD.         
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN CGN-FLD.         
      *>>>>
       FIN-PUT-CGN-CGN.
           EXIT.
       
       PUT-DGN-CGN SECTION.
       INI-PUT-DGN-CGN.
           IF PGM-STAT-DGN-NUL
               GO TO FIN-PUT-DGN-CGN.
           IF NOT PGM-STAT-DGN-OKS
               PERFORM CLR-DGN-CGN
               GO TO FIN-PUT-DGN-CGN.
           MOVE DGN-NUM-IDGN IN DGN TO DGN-NUM-IDGN IN CGN-FLD.
           MOVE DGN-COD-TDOC IN DGN TO DGN-COD-TDOC IN CGN-FLD.
           MOVE DGN-COD-EDOC IN DGN TO DGN-COD-EDOC IN CGN-FLD.
           MOVE DGN-COD-OCOB IN DGN TO DGN-COD-OCOB IN CGN-FLD.
           MOVE DGN-IND-COBL IN DGN TO DGN-IND-COBL IN CGN-FLD.
           MOVE DGN-IND-MIVA IN DGN TO DGN-IND-MIVA IN CGN-FLD.
           MOVE DGN-SGV-TMBA IN DGN TO DGN-SGV-TMBA IN CGN-FLD.
           MOVE DGN-COD-VCBA IN DGN TO DGN-COD-VCBA IN CGN-FLD.
           MOVE DGN-COD-CPBA IN DGN TO DGN-COD-CPBA IN CGN-FLD.
           MOVE DGN-SGV-TMNO IN DGN TO DGN-SGV-TMNO IN CGN-FLD.
           MOVE DGN-COD-VCNO IN DGN TO DGN-COD-VCNO IN CGN-FLD.
           MOVE DGN-COD-CPNO IN DGN TO DGN-COD-CPNO IN CGN-FLD.
           MOVE DGN-MSC-BCTI IN DGN TO DGN-MSC-BCTI IN CGN-FLD.
           MOVE DGN-MSC-PBTI IN DGN TO DGN-MSC-PBTI IN CGN-FLD.
           MOVE DGN-MSC-BPBT IN DGN TO DGN-MSC-BPBT IN CGN-FLD.
           MOVE DGN-MSC-SPBT IN DGN TO DGN-MSC-SPBT IN CGN-FLD.
           MOVE DGN-COD-CVTI IN DGN TO DGN-COD-CVTI IN CGN-FLD.
           MOVE DGN-MSC-TFPR IN DGN TO DGN-MSC-TFPR IN CGN-FLD.
           MOVE DGN-NUM-PREP IN DGN TO DGN-NUM-PREP IN CGN-FLD.
           MOVE DGN-MSC-UTPR IN DGN TO DGN-MSC-UTPR IN CGN-FLD.
           MOVE DGN-NUM-UCOB IN DGN TO DGN-NUM-UCOB IN CGN-FLD.
           MOVE DGN-NUM-NDOC IN DGN TO DGN-NUM-NDOC IN CGN-FLD.
           MOVE DGN-VAL-MTOP IN DGN TO DGN-VAL-MTOP IN CGN-FLD.
           MOVE DGN-COD-VCMT IN DGN TO DGN-COD-VCMT IN CGN-FLD.
           MOVE DGN-COD-CPMT IN DGN TO DGN-COD-CPMT IN CGN-FLD.
           MOVE DGN-NUM-PTOP IN DGN TO DGN-NUM-PTOP IN CGN-FLD.
           MOVE DGN-IND-UTPT IN DGN TO DGN-IND-UTPT IN CGN-FLD.
           MOVE DGN-VAL-VMIN IN DGN TO DGN-VAL-VMIN IN CGN-FLD.
           MOVE DGN-VAL-VMAX IN DGN TO DGN-VAL-VMAX IN CGN-FLD.
           MOVE DGN-COD-VMYM IN DGN TO DGN-COD-VMYM IN CGN-FLD.
           MOVE DGN-NUM-VIGD IN DGN TO DGN-NUM-VIGD IN CGN-FLD.
           MOVE DGN-MSC-UTVD IN DGN TO DGN-MSC-UTVD IN CGN-FLD.
           MOVE DGN-IND-ACAL IN DGN TO DGN-IND-ACAL IN CGN-FLD.
      *<<<< FIN_PUT_DGN_CGN
           IF DGN-COD-TDOC IN CGN-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'DOC'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-TDOC IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-TDOC IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-TDOC IN CGN-FLD.
           IF DGN-COD-EDOC IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'FCA'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-EDOC IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EDOC IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EDOC IN CGN-FLD.
           IF DGN-COD-OCOB IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'OCS'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-OCOB IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-OCOB IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-OCOB IN CGN-FLD.
           IF DGN-IND-UTPT IN CGN-FLD > SPACES
              MOVE 'TAB'                   TO MSC-COD-SIST
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC
              MOVE DGN-IND-UTPT IN CGN-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPT IN CGN-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTPT IN CGN-FLD.
      *>>>>
       FIN-PUT-DGN-CGN.
           EXIT.
       
       KEY-ALL-CGN SECTION.
       INI-KEY-ALL-CGN.
           PERFORM KEY-CGN-CGN.
           PERFORM KEY-DGN-CGN.
       FIN-KEY-ALL-CGN.
           EXIT.
       
       KEY-CGN-CGN SECTION.
       INI-KEY-CGN-CGN.
           MOVE CGN-CAI-GNOT IN CGN-FLD TO CGN-CAI-GNOT IN CGN.
           MOVE CGN-IIC-GNOT IN CGN-FLD TO CGN-IIC-GNOT IN CGN.
           MOVE CGN-COD-SIST IN CGN-FLD TO CGN-COD-SIST IN CGN.
           MOVE CGN-COD-EVEN IN CGN-FLD TO CGN-COD-EVEN IN CGN.
           MOVE CGN-IND-TPLT IN CGN-FLD TO CGN-IND-TPLT IN CGN.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CGN-NUM-DINI IN CGN-FLD TO CGN-NUM-DINI IN CGN.
           MOVE CGN-NUM-MINI IN CGN-FLD TO CGN-NUM-MINI IN CGN.
           MOVE CGN-NUM-SINI IN CGN-FLD TO CGN-NUM-SINI IN CGN.
           MOVE CGN-NUM-AINI IN CGN-FLD TO CGN-NUM-AINI IN CGN.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CGN-HRA-HINI IN CGN-FLD TO CGN-HRA-HINI IN CGN.
           MOVE CGN-CIC-ICGN IN CGN-FLD TO CGN-CIC-ICGN IN CGN.
       FIN-KEY-CGN-CGN.
           EXIT.
       
       KEY-DGN-CGN SECTION.
       INI-KEY-DGN-CGN.
           MOVE DGN-NUM-IDGN IN CGN-FLD TO DGN-NUM-IDGN IN DGN.
       FIN-KEY-DGN-CGN.
           EXIT.
       
       SCR-CLRA-CGN SECTION.
       INI-SCR-CLRA-CGN.
           PERFORM CLR-KEY-CGN.
           PERFORM CLR-FLD-CGN.
       FIN-SCR-CLRA-CGN.
           EXIT.
       
       CLR-KEY-CGN SECTION.
       INI-CLR-KEY-CGN.
           MOVE SPACES TO CGN-CAI-GNOT IN CGN-FLD.
           MOVE SPACES TO CGN-IIC-GNOT IN CGN-FLD.
           MOVE SPACES TO CGN-COD-SIST IN CGN-FLD.
           MOVE SPACES TO CGN-COD-EVEN IN CGN-FLD.
           MOVE SPACES TO CGN-IND-TPLT IN CGN-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CGN-FEC-FINI IN CGN-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO CGN-HRA-HINI IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-IDGN IN CGN-FLD.
           MOVE SPACES TO FRM-IND-SGTE IN CGN-FLD.
           MOVE SPACES TO CGN-CIC-ICGN IN CGN-FLD.
      *>>>>
           MOVE ZEROES TO CGN-HRA-HINI IN CGN-FLD.                      
      *<<<<
       FIN-CLR-KEY-CGN.
           EXIT.
       
       CLR-FLD-CGN SECTION.
       INI-CLR-FLD-CGN.
           MOVE SPACES TO FRM-GLS-SIST IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-EVEN IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-DES1 IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-DES2 IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-TDOC IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-EDOC IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-OCOB IN CGN-FLD.
           MOVE SPACES TO FRM-GLS-UTPT IN CGN-FLD.
           PERFORM CLR-CGN-CGN.
           PERFORM CLR-DGN-CGN.
       FIN-CLR-FLD-CGN.
           EXIT.
       
       CLR-CGN-CGN SECTION.
       INI-CLR-CGN-CGN.
           MOVE SPACES TO CGN-IND-VIGE IN CGN-FLD.
           MOVE SPACES TO CGN-IND-DSCT IN CGN-FLD.
           MOVE SPACES TO CGN-IND-CAAB IN CGN-FLD.
           MOVE SPACES TO CGN-COD-CTAN IN CGN-FLD.
           MOVE SPACES TO CGN-EXT-CTAN IN CGN-FLD.
           MOVE SPACES TO CGN-IND-RBHB IN CGN-FLD.
       FIN-CLR-CGN-CGN.
           EXIT.
       
       CLR-DGN-CGN SECTION.
       INI-CLR-DGN-CGN.
           MOVE SPACES TO DGN-COD-TDOC IN CGN-FLD.
           MOVE SPACES TO DGN-COD-EDOC IN CGN-FLD.
           MOVE SPACES TO DGN-COD-OCOB IN CGN-FLD.
           MOVE SPACES TO DGN-IND-COBL IN CGN-FLD.
           MOVE SPACES TO DGN-IND-MIVA IN CGN-FLD.
           MOVE ZEROES TO DGN-SGV-TMBA IN CGN-FLD.
           MOVE SPACES TO DGN-COD-VCBA IN CGN-FLD.
           MOVE SPACES TO DGN-COD-CPBA IN CGN-FLD.
           MOVE ZEROES TO DGN-SGV-TMNO IN CGN-FLD.
           MOVE SPACES TO DGN-COD-VCNO IN CGN-FLD.
           MOVE SPACES TO DGN-COD-CPNO IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-BCTI IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-PBTI IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-BPBT IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-SPBT IN CGN-FLD.
           MOVE SPACES TO DGN-COD-CVTI IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-TFPR IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-PREP IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-UTPR IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-UCOB IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-NDOC IN CGN-FLD.
           MOVE ZEROES TO DGN-VAL-MTOP IN CGN-FLD.
           MOVE SPACES TO DGN-COD-VCMT IN CGN-FLD.
           MOVE SPACES TO DGN-COD-CPMT IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-PTOP IN CGN-FLD.
           MOVE SPACES TO DGN-IND-UTPT IN CGN-FLD.
           MOVE ZEROES TO DGN-VAL-VMIN IN CGN-FLD.
           MOVE ZEROES TO DGN-VAL-VMAX IN CGN-FLD.
           MOVE SPACES TO DGN-COD-VMYM IN CGN-FLD.
           MOVE ZEROES TO DGN-NUM-VIGD IN CGN-FLD.
           MOVE SPACES TO DGN-MSC-UTVD IN CGN-FLD.
           MOVE SPACES TO DGN-IND-ACAL IN CGN-FLD.
       FIN-CLR-DGN-CGN.
           EXIT.
       
       FST-KEY-CGN SECTION.
       INI-FST-KEY-CGN.
           MOVE -1 TO CGN-CAI-GNOT-LEN IN CGN-FLD.
       FIN-FST-KEY-CGN.
           EXIT.
       
       FST-FLD-CGN SECTION.
       INI-FST-FLD-CGN.
      *>>>>
           IF SCR-CMND NOT = 'ING'                                      
              MOVE -1           TO FRM-GLS-DES1-LEN IN CGN-FLD          
              GO TO FIN-FST-FLD-CGN.                                    
           IF FRM-GLS-DES1 IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES1-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES2-ATR IN CGN-FLD          
           ELSE                                                         
      *<<<<
           MOVE -1 TO FRM-GLS-DES1-LEN IN CGN-FLD.
      *>>>>
           IF CGN-IND-DSCT IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-DSCT-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-DSCT-LEN IN CGN-FLD.         
           IF CGN-IND-CAAB IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-CAAB-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-CAAB-LEN IN CGN-FLD.         
           IF CGN-COD-CTAN IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-COD-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-EXT-CTAN-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-COD-CTAN-LEN IN CGN-FLD.         
           IF CGN-IND-RBHB IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-RBHB-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-RBHB-LEN IN CGN-FLD.         
           IF FRM-GLS-DES1 IN CGN-FLD > SPACES AND                      
              CGN-IND-DSCT IN CGN-FLD > SPACES AND                      
              CGN-IND-CAAB IN CGN-FLD > SPACES AND                      
              CGN-COD-CTAN IN CGN-FLD > SPACES AND                      
              CGN-IND-RBHB IN CGN-FLD > SPACES                          
              MOVE -1           TO DGN-COD-TDOC-LEN IN CGN-FLD.         
      *<<<<
       FIN-FST-FLD-CGN.
           EXIT.
       
       PRO-KEY-CGN SECTION.
       INI-PRO-KEY-CGN.
           MOVE FRM-CPIM-AEY TO FRM-IND-SGTE-ATR IN CGN-FLD.
           PERFORM PRO-IKY-CGN.
           PERFORM PRO-AKY-CGN.
           PERFORM PRO-MKY-CGN.
       FIN-PRO-KEY-CGN.
           EXIT.
       
       PRO-IKY-CGN SECTION.
       INI-PRO-IKY-CGN.
           MOVE FRM-CPIM-AEY TO CGN-CAI-GNOT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-IIC-GNOT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-COD-SIST-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-COD-EVEN-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-IND-TPLT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-FEC-FINI-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-HRA-HINI-ATR IN CGN-FLD.
       FIN-PRO-IKY-CGN.
           EXIT.
       
       PRO-MKY-CGN SECTION.
       INI-PRO-MKY-CGN.
       FIN-PRO-MKY-CGN.
           EXIT.
       
       PRO-AKY-CGN SECTION.
       INI-PRO-AKY-CGN.
           MOVE FRM-CPIM-AEY TO DGN-NUM-IDGN-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-SGTE-ATR IN CGN-FLD.
           MOVE FRM-CPIM-AEY TO CGN-CIC-ICGN-ATR IN CGN-FLD.
       FIN-PRO-AKY-CGN.
           EXIT.
       
       UNP-KEY-CGN SECTION.
       INI-UNP-KEY-CGN.
           MOVE FRM-CPIM-UBY TO FRM-IND-SGTE-ATR IN CGN-FLD.
           PERFORM UNP-IKY-CGN.
           PERFORM UNP-AKY-CGN.
           PERFORM UNP-MKY-CGN.
       FIN-UNP-KEY-CGN.
           EXIT.
       
       UNP-IKY-CGN SECTION.
       INI-UNP-IKY-CGN.
           MOVE FRM-CPIM-UBY TO CGN-CAI-GNOT-ATR.
           MOVE FRM-CPIM-UBY TO CGN-IIC-GNOT-ATR.
           MOVE FRM-CPIM-UBY TO CGN-COD-SIST-ATR.
           MOVE FRM-CPIM-UBY TO CGN-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO CGN-IND-TPLT-ATR.
           MOVE FRM-CPIM-UBY TO CGN-FEC-FINI-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO CGN-HRA-HINI-ATR.
       FIN-UNP-IKY-CGN.
           EXIT.
       
       UNP-MKY-CGN SECTION.
       INI-UNP-MKY-CGN.
       FIN-UNP-MKY-CGN.
           EXIT.
       
       UNP-AKY-CGN SECTION.
       INI-UNP-AKY-CGN.
           MOVE FRM-CPIM-UBY TO DGN-NUM-IDGN-ATR.
           MOVE FRM-CPIM-UBY TO FRM-IND-SGTE-ATR.
           MOVE FRM-CPIM-UBY TO CGN-CIC-ICGN-ATR.
       FIN-UNP-AKY-CGN.
           EXIT.
       
       UNP-FLD-CGN SECTION.
       INI-UNP-FLD-CGN.
           MOVE FRM-CPIM-UBY TO FRM-GLS-DES1-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-DES2-ATR IN CGN-FLD.
           PERFORM UNP-CGN-CGN.
           PERFORM UNP-DGN-CGN.
       FIN-UNP-FLD-CGN.
           EXIT.
       
       UNP-CGN-CGN SECTION.
       INI-UNP-CGN-CGN.
           MOVE FRM-CPIM-UBY TO CGN-IND-DSCT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO CGN-IND-CAAB-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO CGN-COD-CTAN-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO CGN-EXT-CTAN-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO CGN-IND-RBHB-ATR IN CGN-FLD.
      *<<<<
           IF CGN-IND-TPLT IN CGN-FLD NOT = 'P'                         
              MOVE FRM-CPIM-AEY TO CGN-COD-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-EXT-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-IND-RBHB-ATR IN CGN-FLD.         
      *>>>>
       FIN-UNP-CGN-CGN.
           EXIT.
       
       UNP-DGN-CGN SECTION.
       INI-UNP-DGN-CGN.
           MOVE FRM-CPIM-UBY TO DGN-COD-TDOC-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-EDOC-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-OCOB-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-IND-COBL-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-IND-MIVA-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-SGV-TMBA-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-VCBA-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-CPBA-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-SGV-TMNO-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-VCNO-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-CPNO-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-BCTI-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-PBTI-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-BPBT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-SPBT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-CVTI-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-TFPR-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-NUM-PREP-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-UTPR-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-NUM-UCOB-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-NUM-NDOC-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-VAL-MTOP-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-VCMT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-CPMT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-NUM-PTOP-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-IND-UTPT-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-VAL-VMIN-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-VAL-VMAX-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-COD-VMYM-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-NUM-VIGD-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-MSC-UTVD-ATR IN CGN-FLD.
           MOVE FRM-CPIM-UBY TO DGN-IND-ACAL-ATR IN CGN-FLD.
      *<<<<
           IF CGN-IND-TPLT IN CGN-FLD NOT = 'P'                         
              MOVE FRM-CPIM-AEY TO DGN-COD-EDOC-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-OCOB-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-COBL-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-MIVA-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPBA-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPNO-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-BCTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-PBTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-BPBT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-SPBT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CVTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-TFPR-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-PREP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-UTPR-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-UCOB-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-NDOC-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-MTOP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-VCMT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPMT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-PTOP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-UTPT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-VMIN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-VMAX-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-VMYM-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-ACAL-ATR IN CGN-FLD.         
      *>>>>                                                             
       FIN-UNP-DGN-CGN.
           EXIT.
       
       VAL-KEY-CGN SECTION.
       INI-VAL-KEY-CGN.
           PERFORM VAL-IKY-CGN.
           PERFORM VAL-MKY-CGN.
           PERFORM VAL-AKY-CGN.
       FIN-VAL-KEY-CGN.
           EXIT.
       
       VAL-IKY-CGN SECTION.
       INI-VAL-IKY-CGN.
           PERFORM VAL-CGN-CAI-GNOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-CAI-GNOT-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
           PERFORM VAL-CGN-IIC-GNOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-IIC-GNOT-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
           PERFORM VAL-CGN-COD-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-COD-SIST-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
           PERFORM VAL-CGN-COD-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-COD-EVEN-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
           PERFORM VAL-CGN-IND-TPLT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-IND-TPLT-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CGN-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CGN-FEC-FINI-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CGN-HRA-HINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-HRA-HINI-LEN IN CGN-FLD
                GO TO FIN-VAL-IKY-CGN.
       FIN-VAL-IKY-CGN.
           EXIT.
       
       VAL-MKY-CGN SECTION.
       INI-VAL-MKY-CGN.
       FIN-VAL-MKY-CGN.
           EXIT.
       
       VAL-AKY-CGN SECTION.
       INI-VAL-AKY-CGN.
           PERFORM VAL-DGN-NUM-IDGN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DGN-NUM-IDGN-LEN IN CGN-FLD
                GO TO FIN-VAL-AKY-CGN.
           PERFORM VAL-FRM-IND-SGTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-SGTE-LEN IN CGN-FLD
                GO TO FIN-VAL-AKY-CGN.
           PERFORM VAL-CGN-CIC-ICGN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CGN-CIC-ICGN-LEN IN CGN-FLD
                GO TO FIN-VAL-AKY-CGN.
       FIN-VAL-AKY-CGN.
           EXIT.
       
       VAL-CGN-CAI-GNOT SECTION.
       INI-VAL-CGN-CAI-GNOT.
           IF CGN-CAI-GNOT IN CGN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CGN-CAI-GNOT.
       FIN-VAL-CGN-CAI-GNOT.
           EXIT.
       
       VAL-CGN-IIC-GNOT SECTION.
       INI-VAL-CGN-IIC-GNOT.
      *<<<<
           IF CGN-IIC-GNOT IN CGN-FLD NOT > SPACES                      
              MOVE SPACES TO CGN-IIC-GNOT IN CGN-FLD.                   
      *PVG INI 29-DIC-2005                                              
           MOVE 'TAB'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'NOT'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CGN-CAI-GNOT IN CGN-FLD TO CGN-CAI-GNOT IN CGN.         
           MOVE CGN-IIC-GNOT IN CGN-FLD TO CGN-IIC-GNOT IN CGN.         
           MOVE CGN-CIC-GNOT IN CGN     TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CGN-FLD       
              MOVE SPACES              TO FRM-GLS-DES2 IN CGN-FLD.      
      *PVG FIN 29-DIC-2005                                              
           GO TO FIN-VAL-CGN-IIC-GNOT.
      *>>>>
           IF CGN-IIC-GNOT IN CGN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CGN-IIC-GNOT.
       FIN-VAL-CGN-IIC-GNOT.
           EXIT.
       
       VAL-CGN-COD-SIST SECTION.
       INI-VAL-CGN-COD-SIST.
           IF CGN-COD-SIST IN CGN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CGN-COD-SIST.
      *<<<< CGN_COD_SIST
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE CGN-COD-SIST IN CGN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE SPACES       TO FRM-GLS-SIST IN CGN-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN CGN-FLD.
      *>>>>
       FIN-VAL-CGN-COD-SIST.
           EXIT.
       
       VAL-CGN-COD-EVEN SECTION.
       INI-VAL-CGN-COD-EVEN.
           IF CGN-COD-EVEN IN CGN-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CGN-COD-EVEN.
      *<<<< CGN_COD_EVEN
      *VAL-COD Valida codigo de tabla
           IF CGN-COD-EVEN IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CGN-COD-EVEN IN CGN-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
                 MOVE SPACES       TO FRM-GLS-EVEN IN CGN-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN CGN-FLD.
      *>>>>
       FIN-VAL-CGN-COD-EVEN.
           EXIT.
       
       VAL-CGN-IND-TPLT SECTION.
       INI-VAL-CGN-IND-TPLT.
           IF CGN-IND-TPLT IN CGN-FLD NOT > SPACES
              MOVE SPACES TO CGN-IND-TPLT IN CGN-FLD.
      *<<<< CGN_IND_TPLT
           IF CGN-IND-TPLT IN CGN-FLD NOT > SPACES
              MOVE 'P'    TO CGN-IND-TPLT IN CGN-FLD
              GO TO FIN-VAL-CGN-IND-TPLT.
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.
           MOVE CGN-IND-TPLT IN CGN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE 'GNS'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE 'ERR    TDP' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CGN-IND-TPLT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CGN-FEC-FINI SECTION.
       INI-VAL-CGN-FEC-FINI.
           IF CGN-FEC-FINI IN CGN-FLD  NOT > ZEROES
              MOVE ZEROES TO CGN-FEC-FINI IN CGN-FLD.
      *VAL-FEC Validar Fecha
           MOVE CGN-FEC-FINI IN CGN-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CGN_FEC_FINI
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA')
              MOVE FEC-CHOY-GE TO FEC-CHOY.
             IF CGN-FEC-FINI IN CGN-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO CGN-NUM-DINI IN CGN-FLD
              MOVE HOY-MHOY IN HOY-VARI TO CGN-NUM-MINI IN CGN-FLD
              MOVE HOY-SHOY IN HOY-VARI TO CGN-NUM-SINI IN CGN-FLD
              MOVE HOY-AHOY IN HOY-VARI TO CGN-NUM-AINI IN CGN-FLD
              IF CGN-HRA-HINI IN CGN-FLD NOT > ZEROES
                 MOVE HOY-HHOY IN HOY-VARI TO CGN-HRA-HINI IN CGN-FLD
                 GO TO FIN-VAL-CGN-FEC-FINI
              ELSE
                 GO TO FIN-VAL-CGN-FEC-FINI.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CGN-FEC-FINI IN CGN-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CGN-FEC-FINI.
       FIN-VAL-CGN-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CGN-HRA-HINI SECTION.
       INI-VAL-CGN-HRA-HINI.
           IF CGN-HRA-HINI IN CGN-FLD NOT > SPACES
              MOVE SPACES TO CGN-HRA-HINI IN CGN-FLD.
      *<<<< CGN_HRA_HINI
           IF CGN-HRA-HINI IN CGN-FLD NOT > SPACES
MAN           MOVE ZEROES TO CGN-HRA-HINI IN CGN-FLD.                   
      *INI-PENTA
           IF CGN-HRA-HINI IN CGN-FLD IS NOT NUMERIC
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
              GO TO FIN-VAL-CGN-HRA-HINI.                               
      *FIN-PENTA
           IF CGN-HRA-HINI IN CGN-FLD NOT > ZEROES                      
              PERFORM GET-FHOY                                          
              MOVE HOY-HHOY IN HOY-VARI TO CGN-HRA-HINI IN CGN-FLD      
              GO TO FIN-VAL-CGN-HRA-HINI.                               
           MOVE CGN-HRA-HINI IN CGN-FLD TO CGN-HRA-HINI IN CGN.         
           IF CGN-NUM-HHIN IN CGN < ZEROES OR                           
              CGN-NUM-HHIN IN CGN > 23                                  
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
           IF CGN-NUM-MMIN IN CGN < ZEROES OR                           
              CGN-NUM-MMIN IN CGN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
           IF CGN-NUM-SSIN IN CGN < ZEROES OR                           
              CGN-NUM-SSIN IN CGN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
      *>>>>
       FIN-VAL-CGN-HRA-HINI.
           EXIT.
       
       VAL-DGN-NUM-IDGN SECTION.
       INI-VAL-DGN-NUM-IDGN.
      *<<<< DGN_NUM_IDGN
           IF SCR-CMND = 'MOD'
              IF DGN-NUM-IDGN IN CGN-FLD NOT > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'NUMCGN   OBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DGN-NUM-IDGN.

           MOVE 'N' TO SCR-IND-ELI IN SCR-VARI.
           IF SCR-CMND = 'ELI' AND DGN-NUM-IDGN IN CGN-FLD = 999
              MOVE ZEROES TO DGN-NUM-IDGN IN CGN-FLD
              MOVE 'S'    TO SCR-IND-ELI IN SCR-VARI.
      *>>>>
       FIN-VAL-DGN-NUM-IDGN.
           EXIT.
       
       VAL-FRM-IND-SGTE SECTION.
       INI-VAL-FRM-IND-SGTE.
           IF FRM-IND-SGTE IN CGN-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-SGTE IN CGN-FLD.
       FIN-VAL-FRM-IND-SGTE.
           EXIT.
       
       VAL-CGN-CIC-ICGN SECTION.
       INI-VAL-CGN-CIC-ICGN.
           IF CGN-CIC-ICGN IN CGN-FLD NOT > SPACES
              MOVE SPACES TO CGN-CIC-ICGN IN CGN-FLD.
       FIN-VAL-CGN-CIC-ICGN.
           EXIT.
       
       VAL-CON-KEY-CGN SECTION.
       INI-VAL-CON-KEY-CGN.
           IF     CGN-CAI-GNOT IN CGN-FLD NOT > SPACES 
              AND CGN-IIC-GNOT IN CGN-FLD NOT > SPACES 
              AND CGN-COD-SIST IN CGN-FLD NOT > SPACES 
              AND CGN-COD-EVEN IN CGN-FLD NOT > SPACES 
              AND CGN-IND-TPLT IN CGN-FLD NOT > SPACES 
              AND CGN-FEC-FINI IN CGN-FLD NOT > ZEROES
              AND CGN-HRA-HINI IN CGN-FLD NOT > SPACES 
              AND DGN-NUM-IDGN IN CGN-FLD NOT > ZEROES 
              AND FRM-IND-SGTE IN CGN-FLD NOT > SPACES 
              AND CGN-CIC-ICGN IN CGN-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CGN.
       FIN-VAL-CON-KEY-CGN.
           EXIT.
       
       VAL-CON-IKY-CGN SECTION.
       INI-VAL-CON-IKY-CGN.
           IF     CGN-CAI-GNOT IN CGN-FLD NOT > SPACES 
              AND CGN-IIC-GNOT IN CGN-FLD NOT > SPACES 
              AND CGN-COD-SIST IN CGN-FLD NOT > SPACES 
              AND CGN-COD-EVEN IN CGN-FLD NOT > SPACES 
              AND CGN-IND-TPLT IN CGN-FLD NOT > SPACES 
              AND CGN-FEC-FINI IN CGN-FLD NOT > ZEROES
              AND CGN-HRA-HINI IN CGN-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CGN.
       FIN-VAL-CON-IKY-CGN.
           EXIT.
       
       VAL-NUM-KEY-CGN SECTION.
       INI-VAL-NUM-KEY-CGN.
           PERFORM VAL-NUM-IKY-CGN.
           PERFORM VAL-NUM-MKY-CGN.
           PERFORM VAL-NUM-AKY-CGN.
       FIN-VAL-NUM-KEY-CGN.
           EXIT.
       
       VAL-NUM-IKY-CGN SECTION.
       INI-VAL-NUM-IKY-CGN.
       FIN-VAL-NUM-IKY-CGN.
           EXIT.
       
       VAL-NUM-MKY-CGN SECTION.
       INI-VAL-NUM-MKY-CGN.
       FIN-VAL-NUM-MKY-CGN.
           EXIT.
       
       VAL-NUM-AKY-CGN SECTION.
       INI-VAL-NUM-AKY-CGN.
       VAL-NUM-DGN-NUM-IDGN.
           MOVE DGN-NUM-IDGN-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-IDGN IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-IDGN-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-AKY-CGN.
       FIN-VAL-NUM-AKY-CGN.
           EXIT.
       
       VAL-NUM-FLD-CGN SECTION.
       INI-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-SGV-TMBA.
           MOVE DGN-SGV-TMBA-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO DGN-SGV-TMBA IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-SGV-TMBA-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-SGV-TMNO.
           MOVE DGN-SGV-TMNO-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO DGN-SGV-TMNO IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-SGV-TMNO-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-NUM-PREP.
           MOVE DGN-NUM-PREP-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-PREP IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-PREP-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-NUM-UCOB.
           MOVE DGN-NUM-UCOB-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-UCOB IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-UCOB-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-NUM-NDOC.
           MOVE DGN-NUM-NDOC-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-NDOC IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-NDOC-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-VAL-MTOP.
           MOVE DGN-VAL-MTOP-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-VAL-MTOP IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-VAL-MTOP-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-NUM-PTOP.
           MOVE DGN-NUM-PTOP-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-PTOP IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-PTOP-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-VAL-VMIN.
           MOVE DGN-VAL-VMIN-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO DGN-VAL-VMIN IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-VAL-VMIN-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-VAL-VMAX.
           MOVE DGN-VAL-VMAX-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO DGN-VAL-VMAX IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-VAL-VMAX-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       VAL-NUM-DGN-NUM-VIGD.
           MOVE DGN-NUM-VIGD-ALF IN CGN-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DGN-NUM-VIGD IN CGN-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DGN-NUM-VIGD-LEN IN CGN-FLD
                GO TO FIN-VAL-NUM-FLD-CGN.
       FIN-VAL-NUM-FLD-CGN.
           EXIT.
       
       EDT-KEY-CGN SECTION.
       INI-EDT-KEY-CGN.
           PERFORM EDT-IKY-CGN.
           PERFORM EDT-MKY-CGN.
           PERFORM EDT-AKY-CGN.
       FIN-EDT-KEY-CGN.
           EXIT.
       
       EDT-IKY-CGN SECTION.
       INI-EDT-IKY-CGN.
       FIN-EDT-IKY-CGN.
           EXIT.
       
       EDT-MKY-CGN SECTION.
       INI-EDT-MKY-CGN.
       FIN-EDT-MKY-CGN.
           EXIT.
       
       EDT-AKY-CGN SECTION.
       INI-EDT-AKY-CGN.
           IF DGN-NUM-IDGN-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-IDGN-LEN IN CGN-FLD
                GO TO FIN-EDT-AKY-CGN.
           MOVE DGN-NUM-IDGN IN CGN-FLD TO DGN-NUM-IDGN-EDT IN CGN-EDT.
           MOVE DGN-NUM-IDGN-EDT IN CGN-EDT TO 
                DGN-NUM-IDGN-ALF IN CGN-FLD.
       FIN-EDT-AKY-CGN.
           EXIT.
       
       EDT-FLD-CGN SECTION.
       INI-EDT-FLD-CGN.
           IF DGN-SGV-TMBA-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-SGV-TMBA-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-SGV-TMBA IN CGN-FLD TO DGN-SGV-TMBA-EDT IN CGN-EDT.
           MOVE DGN-SGV-TMBA-EDT IN CGN-EDT TO 
                DGN-SGV-TMBA-ALF IN CGN-FLD.
           IF DGN-SGV-TMNO-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-SGV-TMNO-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-SGV-TMNO IN CGN-FLD TO DGN-SGV-TMNO-EDT IN CGN-EDT.
           MOVE DGN-SGV-TMNO-EDT IN CGN-EDT TO 
                DGN-SGV-TMNO-ALF IN CGN-FLD.
           IF DGN-NUM-PREP-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-PREP-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-NUM-PREP IN CGN-FLD TO DGN-NUM-PREP-EDT IN CGN-EDT.
           MOVE DGN-NUM-PREP-EDT IN CGN-EDT TO 
                DGN-NUM-PREP-ALF IN CGN-FLD.
           IF DGN-NUM-UCOB-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-UCOB-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-NUM-UCOB IN CGN-FLD TO DGN-NUM-UCOB-EDT IN CGN-EDT.
           MOVE DGN-NUM-UCOB-EDT IN CGN-EDT TO 
                DGN-NUM-UCOB-ALF IN CGN-FLD.
           IF DGN-NUM-NDOC-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-NDOC-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-NUM-NDOC IN CGN-FLD TO DGN-NUM-NDOC-EDT IN CGN-EDT.
           MOVE DGN-NUM-NDOC-EDT IN CGN-EDT TO 
                DGN-NUM-NDOC-ALF IN CGN-FLD.
           IF DGN-VAL-MTOP-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-VAL-MTOP-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-VAL-MTOP IN CGN-FLD TO DGN-VAL-MTOP-EDT IN CGN-EDT.
           MOVE DGN-VAL-MTOP-EDT IN CGN-EDT TO 
                DGN-VAL-MTOP-ALF IN CGN-FLD.
           IF DGN-NUM-PTOP-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-PTOP-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-NUM-PTOP IN CGN-FLD TO DGN-NUM-PTOP-EDT IN CGN-EDT.
           MOVE DGN-NUM-PTOP-EDT IN CGN-EDT TO 
                DGN-NUM-PTOP-ALF IN CGN-FLD.
           IF DGN-VAL-VMIN-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-VAL-VMIN-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-VAL-VMIN IN CGN-FLD TO DGN-VAL-VMIN-EDT IN CGN-EDT.
           MOVE DGN-VAL-VMIN-EDT IN CGN-EDT TO 
                DGN-VAL-VMIN-ALF IN CGN-FLD.
           IF DGN-VAL-VMAX-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-VAL-VMAX-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-VAL-VMAX IN CGN-FLD TO DGN-VAL-VMAX-EDT IN CGN-EDT.
           MOVE DGN-VAL-VMAX-EDT IN CGN-EDT TO 
                DGN-VAL-VMAX-ALF IN CGN-FLD.
           IF DGN-NUM-VIGD-LEN IN CGN-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DGN-NUM-VIGD-LEN IN CGN-FLD
                GO TO FIN-EDT-FLD-CGN.
           MOVE DGN-NUM-VIGD IN CGN-FLD TO DGN-NUM-VIGD-EDT IN CGN-EDT.
           MOVE DGN-NUM-VIGD-EDT IN CGN-EDT TO 
                DGN-NUM-VIGD-ALF IN CGN-FLD.
       FIN-EDT-FLD-CGN.
           EXIT.
