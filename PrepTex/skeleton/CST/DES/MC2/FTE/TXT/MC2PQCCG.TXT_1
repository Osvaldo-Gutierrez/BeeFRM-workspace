*% PGM_PTC = TRUE
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "MC2ZQCCG"
*% END
*% LARGO_TOTAL_COMMAREA = 3000
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI                                                
           03 SCR-NUM-PANT               PIC 9(0003).                   
           03 SCR-CCG-FLD                PIC X(1010).                   
      *>>>>                                                             
*% END
*% IF INI_FIO
      *<<<< INI_FIO                                                     
           IF SCR-OFRM-SRV
               MOVE TSK-TERM-ALF TO RCC-COD-TERM-SGS
               MOVE TSK-TERM-ALF TO CCG-COD-TERM
               MOVE TSK-TERM-ALF TO CCG-COD-TERM-MAS
               MOVE TSK-TERM-ALF TO CCG-COD-TERM-MTZ
               MOVE 'S'          TO RCC-OFRM-SRV
           ELSE
               MOVE EIBTRMID     TO RCC-COD-TERM-SGS
               MOVE EIBTRMID     TO CCG-COD-TERM
               MOVE EIBTRMID     TO CCG-COD-TERM-MAS
               MOVE EIBTRMID     TO CCG-COD-TERM-MTZ
               MOVE 'N'          TO RCC-OFRM-SRV.
                                                                        
           MOVE TSK-TERM-ALF TO QUE-TERM.                               
           MOVE 'ICOL'       TO QUE-TYPE.                               
           MOVE +9999        TO QUE-LITM.                               
           MOVE 1            TO QUE-NITM.                               
           MOVE QUE-GET      TO QUE-CMND                                
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE 'S' TO WSS-IND-CORP IN WSS-VARI                      
           ELSE                                                         
              MOVE 'N' TO WSS-IND-CORP IN WSS-VARI.                     

           MOVE +3859 TO SCR-TCMA.                                      
           PERFORM GNS-ERR-QUE.                                         
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )      
               MOVE SCR-CCG-FLD TO CCG-FLD                              
               GO TO FIN-INI.                                           
                                                                        
           IF ( FRM-FFLD = FRM-FFLD-PF6 )                               
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM        
               ADD 1              TO QUE-NITM                           
               MOVE CCG-NOM-TSCCG TO QUE-COLA                           
               MOVE CCG-LEN-TSCCG TO QUE-LITM                           
               MOVE QUE-GET       TO QUE-CMND                           
               PERFORM GNS-PRO-QUE                                      
               IF QUE-STAT NOT = QUE-STAT-OKS                           
                  MOVE SCR-CCG-FLD TO CCG-FLD                           
                  GO TO FIN-INI.                                        
      *----------------------------------------------------------------*
           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.
           
           PERFORM GET-FHOY.
      *----------------------------------------------------------------*
      *>>>>                                                             
*% END
*% IF WSS
      *<<<< WSS_DTC                                                     
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY SGCBRDBC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
                                                                        
      *PVG INI 27-ENE-2017
      *COPY TABBRSGS.
       COPY MC2BRSGS.
      *PVG FIN 27-ENE-2017
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SGS-REQA==.
       COPY MC2BRCGN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CGN-REQA==.
       COPY MC2BRDGN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DGN-REQA==.

      *PVG INI 04-FEB-2015
      *PVG INI 27-ENE-2017
      *COPY TABBRROC.
       COPY MC2BRROC.
      *PVG FIN 27-ENE-2017
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.
      *PVG FIN 04-FEB-2015

       01  WSS-VARI.                                                    
           03  WSS-GLS-DAT1.                                             
               05 WSS-COD-SIST                         PIC X(03).        
               05 WSS-GLS-FILL                         PIC X(07).        
           03  WSS-COD-VCOC.
               05  WSS-MSC-TVOC                        PIC X(01).
               05  WSS-COD-CVOC                        PIC X(03).
               05  WSS-COD-TCOC                        PIC X(02).
           03  WSS-FEC-FNAC.
               05  WSS-NUM-SNAC                        PIC 9(02).
               05  WSS-NUM-ANAC                        PIC 9(02).
               05  WSS-NUM-MNAC                        PIC 9(02).
               05  WSS-NUM-DNAC                        PIC 9(02).
           03  WSS-FEC-FCUR.                                              
               05 WSS-NUM-SCUR                         PIC 9(02).        
               05 WSS-NUM-ACUR                         PIC 9(02).        
               05 WSS-NUM-MCUR                         PIC 9(02).        
               05 WSS-NUM-DCUR                         PIC 9(02).        
           03  WSS-FEC-FVEN.                                             
               05 WSS-NUM-SVEN                         PIC 9(02).        
               05 WSS-NUM-AVEN                         PIC 9(02).        
               05 WSS-NUM-MVEN                         PIC 9(02).        
               05 WSS-NUM-DVEN                         PIC 9(02).        
           03  WSS-FEC-FMVT.                                             
               05 WSS-NUM-SMVT                         PIC 9(02).        
               05 WSS-NUM-AMVT                         PIC 9(02).        
               05 WSS-NUM-MMVT                         PIC 9(02).        
               05 WSS-NUM-DMVT                         PIC 9(02).        
           03  WSS-IND-CORP           VALUE 'N'        PIC X(01).        

      *PVG INI 04-FEB-2015
           03  WSS-COD-MIMP.
               05  WSS-MSC-TVIM                        PIC X(01).
               05  WSS-COD-CVIM                        PIC X(03).
               05  WSS-COD-TCIM                        PIC X(02).
      *PVG FIN 04-FEB-2015

      *----------------------------------------------------------------*
           03  WSS-GLS-PGDM.
               05  WSS-IND-MINT                        PIC X(01).
               05  WSS-IND-VUCO                        PIC X(01).
               05  WSS-IND-CCAE                        PIC X(01).
               05  WSS-IND-MCTC                        PIC X(01).
      *PVG INI 04-FEB-2015
      *        05  WSS-FL1-PGDM                        PIC X(06).
               05  WSS-IND-PCUO                        PIC X(01).
               05  WSS-IND-NSGS                        PIC X(01).
               05  WSS-IND-NCGN                        PIC X(01).
               05  WSS-FL1-PGDM                        PIC X(03).
      *PVG FIN 04-FEB-2015
               05  WSS-GLS-NFIL                        PIC X(02).
               05  WSS-NUM-NFIL REDEFINES WSS-GLS-NFIL PIC 9(02).
               05  WSS-GLS-NCOL                        PIC X(02).
               05  WSS-NUM-NCOL REDEFINES WSS-GLS-NCOL PIC 9(02).
               05  WSS-FL2-PGDM                        PIC X(16).
               05  WSS-GLS-LMTE                        PIC X(03).
               05  WSS-NUM-LMTE REDEFINES WSS-GLS-LMTE PIC 9(03).
               05  WSS-GLS-PINF                        PIC X(03).
               05  WSS-NUM-PINF REDEFINES WSS-GLS-PINF PIC 9(03).
               05  WSS-GLS-PSUP                        PIC X(03).
               05  WSS-NUM-PSUP REDEFINES WSS-GLS-PSUP PIC 9(03).
      *PVG INI 04-FEB-2015
      *        05  WSS-FL2-PGDM                        PIC X(12).
               05  WSS-FL2-PGDM                        PIC X(09).
               05  WSS-IND-PROC                        PIC X(03).
      *PVG FIN 04-FEB-2015
               05  WSS-VSN-ESGS.
                   07  WSS-IND-EST1                    PIC X(01).
                   07  WSS-IND-EST2                    PIC X(01).
                   07  WSS-IND-EST3                    PIC X(01).
               05  WSS-VSN-ECGN.
                   07  WSS-IND-EGT1                    PIC X(01).
                   07  WSS-IND-EGT2                    PIC X(01).
                   07  WSS-IND-EGT3                    PIC X(01).
               05  WSS-GLS-FCTM                        PIC X(03).
               05  WSS-NUM-FCTM REDEFINES WSS-GLS-FCTM PIC 9(03).
           03  WSS-SGV-FCTM                            PIC 9(03)V9(04).
           03  WSS-NUM-BCTA                            PIC 9(03).
           03  WSS-NUM-NCTA                            PIC 9(03).
           03  WSS-NUM-FCTA                            PIC 9(03).
           03  WSS-VAL-MOPE                            PIC 9(11)V9(04).
           03  WSS-VAL-MMIL                            PIC 9(11).
           03  WSS-VAL-MCPO                            PIC 9(11)V9(04).
           03  WSS-COD-PESO                            PIC X(06).
           03  WSS-COD-UEFE                            PIC X(06).
           03  WSS-SGV-VCAM                            PIC 9(11)V9(04).
      *PVG INI 04-FEB-2015
           03  WSS-KEY-RROC.
      *MHM-INI 30-ABR-2018
      *         05  WSS-GLS-ROC1                        PIC X(03).
      *         05  WSS-GLS-ROC2                        PIC X(03).
      *         05  WSS-GLS-ROC3                        PIC X(03).
      *         05  WSS-GLS-ROC4                        PIC X(03).
               05  WSS-CAI-IROC                        PIC X(04).
               05  WSS-IIC-IROC                        PIC 9(08).
      *MHM-FIN 30-ABR-2018
               05  WSS-FIL-RROC                        PIC X(04).
           03 WSS-IND-SGIN            VALUE SPACES     PIC X(01).
           03  WSS-INF-RROC                            PIC X(01).
           03  WSS-EXI-RROC                            PIC X(01).
           03  WSS-IROC                                PIC 9(02).
           03  WSS-IMAXROC  VALUE  50                  PIC 9(02).
           03  WSS-VEC-RROC OCCURS 50.
               05  VEC-COD-CPTO                        PIC X(03).
               05  VEC-COD-SCPT                        PIC X(03).
           03  WSS-CCG-TIMP                            PIC X(01).
      *PVG FIN 04-FEB-2015
      *----------------------------------------------------------------*
           03  WSS-NUM-PFIL               VALUE ZEROES PIC 9(02).
           03  WSS-NUM-PCOL               VALUE ZEROES PIC 9(02).
           03  WSS-NUM-MFIL               VALUE 7      PIC 9(02).
           03  WSS-NUM-MCOL               VALUE 7      PIC 9(02).
           03  WSS-GLS-MTRZ.
               05  VEC-GLS-FILA OCCURS 7.
                   07  VEC-GLS-COLU OCCURS 7.
                       09  VEC-SGV-CRED               PIC  9(11)V9(04).
                       09  VEC-NUM-NVEN               PIC  9(03).
      *----------------------------------------------------------------*
           03  WSS-NUM-MMC2           VALUE 50        PIC  9(03).
           03  WSS-NUM-PMC2           VALUE ZEROES    PIC  9(03).
           03  WSS-GLS-PMC2.
               05  VEC-GLS-PMC2 OCCURS 50.
                   09  WSS-SGV-CRED                    PIC 9(11)V9(04).
                   09  WSS-SGV-MLIQ                    PIC 9(11)V9(04).
                   09  WSS-NUM-NVEN                    PIC 9(03).
                   09  WSS-SGV-MVEN                    PIC 9(11)V9(04).
                   09  WSS-SGV-MIMP                    PIC 9(11)V9(04).
                   09  WSS-SGV-MSEG                    PIC 9(11)V9(04).
                   09  WSS-SGV-MCOM                    PIC 9(11)V9(04).
                   09  WSS-SGV-MGAS                    PIC 9(11)V9(04).
                   09 WSS-FEC-FPVT.
                      11 WSS-NUM-DPVT                  PIC 9(02).
                      11 WSS-NUM-MPVT                  PIC 9(02).
                      11 WSS-NUM-SPVT                  PIC 9(02).
                      11 WSS-NUM-APVT                  PIC 9(02).
                   09  WSS-SGV-MCAE                    PIC 9(03)V9(04).
                   09  WSS-SGV-MCTC                    PIC 9(11)V9(04).
                   09  WSS-SGV-TASA                    PIC 9(03)V9(04).
                   09  WSS-COD-TINT.
                       11  WSS-MSC-BCTI                PIC X(01).
                       11  WSS-MSC-PBTI                PIC X(01).
                       11  WSS-MSC-BPBT                PIC X(01).
                       11  WSS-MSC-SPBT                PIC X(01).
                       11  WSS-COD-CVTI                PIC X(03).
                       11  WSS-MSC-TFPR                PIC X(01).
                       11  WSS-NUM-PREP                PIC 9(03).
                       11  WSS-MSC-UTPR                PIC X(01).
                   09 WSS-FEC-FUVT.
                      11 WSS-NUM-DUVT                  PIC 9(02).
                      11 WSS-NUM-MUVT                  PIC 9(02).
                      11 WSS-NUM-SUVT                  PIC 9(02).
                      11 WSS-NUM-AUVT                  PIC 9(02).
                   09  WSS-MSC-CPTO                    PIC X(03).
                   09  WSS-COD-SCPT                    PIC X(03).
                   09  WSS-NUM-PZOD                    PIC 9(05).
                   09  WSS-NUM-PZOM                    PIC 9(05).
                   09  WSS-NUM-PZOA                    PIC 9(05).
                   09  WSS-NUM-EDAD                    PIC 9(05).
                   09  WSS-SGV-TFCT                    PIC 9(03)V9(12).
                   09  WSS-SGV-TMFJ                    PIC 9(11)V9(04).
                   09  WSS-VAL-MCAE                    PIC 9(11)V9(04).
      *----------------------------------------------------------------*
           03  WSS-IND-TICL                            PIC X(01).
           03  WSS-NUM-SEVE                           PIC  9(03).
           03  WSS-IND-AFER                           PIC  X(01).
           03  WSS-COD-TDOC                           PIC  X(03).
           03  WSS-MSC-TIMP              VALUE SPACES PIC  X(01).
           03  WSS-COD-CTAB.
               05  WSS-FEC-CTAB                       PIC X(08).
               05  WSS-GLS-DOCU                       PIC X(03).
               05  WSS-GLS-TIPO                       PIC X(01).
           03  WSS-COD-CTIM.
               05  WSS-FEC-CTIM                       PIC X(08).
               05  WSS-GLS-DTIM                       PIC X(03).
               05  WSS-GLS-TTIM                       PIC X(01).
           03  WSS-GLS-DIMP.
               05  WSS-GLS-IMPP                        PIC X(15).
               05  WSS-VAL-IMPP REDEFINES WSS-GLS-IMPP PIC 9(15).
               05  WSS-GLS-IMPM                        PIC X(15).
               05  WSS-VAL-IMPM REDEFINES WSS-GLS-IMPM PIC 9(15).
               05  WSS-GLS-IMPD                        PIC X(15).
               05  WSS-VAL-IMPD REDEFINES WSS-GLS-IMPD PIC 9(15).
               05  WSS-FI1-DTIM                        PIC X(15).
           03  WSS-SGV-IMPP                            PIC 9(03)V9(12).
           03  WSS-SGV-IMPM                            PIC 9(03)V9(12).
           03  WSS-SGV-IMPD                            PIC 9(03)V9(12).
           03  WSS-NUM-PZIM   VALUE 12                 PIC 9(02).
           03  WSS-VAL-IMPU                            PIC 9(11)V9(04).
           03  WSS-IND-SELE                            PIC X(01).
           03  WSS-COD-TSEGA                           PIC X(03).
           03  BKP-WSS-SGV-TFCT                        PIC 9(03)V9(12).
           03  BKP-WSS-SGV-TMFJ                        PIC 9(11)V9(04).
           03  BKP-WSS-SGV-MLIQ                        PIC 9(11)V9(04).
           03  BKP-WSS-SGV-MLIQ-ANT                    PIC 9(11)V9(04).
           03  WSS-VAL-DIFE                            PIC 9(11)V9(04).
           03  WSS-NUM-RECA                            PIC 9(02).
      *----------------------------------------------------------------*
           03  WSS-IND-PSGS   VALUE 'N'                PIC X(01).
           03  WSS-SGS-KEY-ISGS.
               05  WSS-SGS-CIC-PLAN.
                   07  WSS-SGS-CAI-PLAN.
                       09  WSS-SGS-COD-TPLA            PIC X(01).
                       09  WSS-SGS-COD-CPLA            PIC X(03).
                   07  WSS-SGS-IIC-PLAN                PIC X(08).
               05  WSS-SGS-COD-SIST                    PIC X(03).
               05  WSS-SGS-COD-EVEN                    PIC X(03).
               05  WSS-SGS-IND-TPLT                    PIC X(01).
               05  WSS-SGS-FEC-PLAN.
                   07  WSS-SGS-NUM-SLAN                PIC 9(02).
                   07  WSS-SGS-NUM-ALAN                PIC 9(02).
                   07  WSS-SGS-NUM-MLAN                PIC 9(02).
                   07  WSS-SGS-NUM-DLAN                PIC 9(02).
               05  WSS-SGS-HRA-PLAN.
                   07  WSS-SGS-NUM-HHPL                PIC 9(02).
                   07  WSS-SGS-NUM-MMPL                PIC 9(02).
                   07  WSS-SGS-NUM-SSPL                PIC 9(02).
               05  WSS-SGS-NUM-ISGS                    PIC 9(03).
      *----------------------------------------------------------------*
           03  WSS-IND-PCGN   VALUE 'N'                PIC X(01).
           03  WSS-CGN-KEY-ICGN.
               05  WSS-CGN-CIC-GNOT.
                   07  WSS-CGN-CAI-GNOT.
                       09  WSS-CGN-COD-TGNO            PIC X(01).
                       09  WSS-CGN-COD-CGNO            PIC X(03).
                   07  WSS-CGN-IIC-GNOT                PIC X(08).
               05  WSS-CGN-COD-SIST                    PIC X(03).
               05  WSS-CGN-COD-EVEN                    PIC X(03).
               05  WSS-CGN-IND-TPLT                    PIC X(01).
               05  WSS-CGN-STP-FINI.
                   07  WSS-CGN-FEC-FINI.
                       09  WSS-CGN-NUM-SINI            PIC 9(02).
                       09  WSS-CGN-NUM-AINI            PIC 9(02).
                       09  WSS-CGN-NUM-MINI            PIC 9(02).
                       09  WSS-CGN-NUM-DINI            PIC 9(02).
                   07  WSS-CGN-HRA-HINI.
                       09  WSS-CGN-NUM-HHIN            PIC 9(02).
                       09  WSS-CGN-NUM-MMIN            PIC 9(02).
                       09  WSS-CGN-NUM-SSIN            PIC 9(02).
      *----------------------------------------------------------------*
           03  WSS-SGS                                 PIC 9(03).
           03  WSS-ASGS                                PIC 9(03).
           03  WSS-MSGS               VALUE 100        PIC 9(03).
           03  WSS-SGV-NCRE                            PIC 9(11)V9(04).
           03  WSS-SGV-TMIN                            PIC 9(11)V9(04).
           03  WSS-SGV-VMIN                            PIC 9(11)V9(04).
           03  WSS-SGV-TMAX                            PIC 9(11)V9(04).
           03  WSS-SGV-VMAX                            PIC 9(11)V9(04).
           03  WSS-VAL-SGS-MNTO                        PIC 9(11)V9(04).
           03  WSS-SGV-FCTC                            PIC 9(03)V9(12).
           03  WSS-IND-SGSC                            PIC X(03).
      *----------------------------------------------------------------*
           03  CCG-VEC-PSGS OCCURS 100.
               05  CCG-SGS-COD-TSEG                    PIC X(03).
               05  CCG-SGS-NUM-PLZO                    PIC 9(03).
               05  CCG-SGS-IND-UTPZ                    PIC X(01).
               05  CCG-SGS-NUM-EDAT                    PIC 9(03).
               05  CCG-SGS-IND-EDRA                    PIC X(01).
               05  CCG-SGS-VAL-TOPE                    PIC 9(11)V9(04).
               05  CCG-SGS-COD-VTOP.
                   07  CCG-SGS-MSC-TTPE                PIC X(01).
                   07  CCG-SGS-COD-CTPE                PIC X(03).
                   07  CCG-SGS-COD-TTPE                PIC X(02).
               05  CCG-SGS-COD-CPTT                    PIC X(03).
               05  CCG-SGS-DAT-PSGS.
                   07  CCG-SGS-COD-SEGU                PIC X(03).
                   07  CCG-SGS-SGV-TAMO                PIC 9(11)V9(04).
                   07  CCG-SGS-COD-VCOC.
                       09  CCG-SGS-MSC-TVOC            PIC X(01).
                       09  CCG-SGS-COD-CVOC            PIC X(03).
                       09  CCG-SGS-COD-TCOC            PIC X(02).
                   07  CCG-SGS-COD-CPTO                PIC X(03).
      *----------------------------------------------------------------*
           03  WSS-CGN                                 PIC 9(03).
           03  WSS-ACGN                                PIC 9(03).
           03  WSS-MCGN               VALUE 050        PIC 9(03).
           03  WSS-IND-CGNC                            PIC X(03).
           03  WSS-VAL-MIVA-ALF    VALUE SPACES        PIC X(10).
           03  WSS-VAL-MIVA        REDEFINES
               WSS-VAL-MIVA-ALF                        PIC 9(06)V9(04).
           03  WSS-VAL-CGN-MNTO                        PIC 9(11)V9(04).
      *----------------------------------------------------------------*
           03  CCG-VEC-PDGN OCCURS 050.
               05  CCG-DGN-COD-TDOC                    PIC X(03).
               05  CCG-DGN-NUM-PTOP                    PIC 9(03).
               05  CCG-DGN-IND-UTPT                    PIC X(01).
               05  CCG-DGN-VAL-MTOP                    PIC 9(11)V9(04).
               05  CCG-DGN-COD-VCMT.
                   07  CCG-DGN-MSC-TVMT                PIC X(01).
                   07  CCG-DGN-COD-CVMT                PIC X(03).
                   07  CCG-DGN-COD-TCMT                PIC X(02).
               05  CCG-DGN-COD-CPMT                    PIC X(03).
               05  CCG-DGN-DAT-PDGN.
                   07  CCG-DGN-COD-EDOC                PIC X(03).
                   07  CCG-DGN-SGV-TMBA                PIC 9(11)V9(04).
                   07  CCG-DGN-COD-VCBA.
                       09  CCG-DGN-MSC-TVBA            PIC X(01).
                       09  CCG-DGN-COD-CVBA            PIC X(03).
                       09  CCG-DGN-COD-TCBA            PIC X(02).
                   07  CCG-DGN-COD-CPBA                PIC X(03).
                   07  CCG-DGN-IND-MIVA                PIC X(01).
      *----------------------------------------------------------------*
      *PVG INI 04-FEB-2015
           03 WSS-COD-COFI           VALUE '010'       PIC X(03).
           03 WSS-COD-TCNL           VALUE SPACES      PIC X(03).
      *----------------------------------------------------------------*
      *PVG FIN 04-FEB-2015
           03  WSS-COD-COOC.
               05  WSS-COD-TOOC                        PIC X(03).
               05  WSS-COD-AOOC                        PIC X(03).
       COPY MC2WGRCC.                                                   
       COPY MC2WGSGS.                                                   
       COPY MC2WXCCG.                                                   
       COPY GNSWGPES.
      *----------------------------------------------------------------*
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLBREVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY COLWGMIC.
      *----------------------------------------------------------------*
      *>>>>                                                           
*% END
*% IF FIN_PGM_STAT
      *<<<<
              05 PGM-STAT-RCC.                                          
                 88 PGM-STAT-RCC-NUL    VALUE '  '.                     
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).            
                    88 PGM-STAT-RCC-OKS VALUE '0'.                      
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).            
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6                   
               PERFORM VAL-NUM-KEY-CCG                                  
               PERFORM VAL-NUM-FLD-CCG                                  
               PERFORM SCRL-TAB-CCG                                     
               PERFORM SCR-TRL.                                         
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY                                                 
           GO TO CON-FND-KEY.                                           
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
       CON-FND-KEY.                                                     
      *--------------------------------------------------------------*  
           PERFORM PRO-CAL-COND.                                             
           IF CCG-COD-MENS IN CCG-VARI NOT > SPACES                     
              PERFORM PUT-TAB                                           
              MOVE '00'         TO FIO-STAT                             
              MOVE SCR-STAT-CON TO SCR-STAT                             
           ELSE                                                         
              MOVE 'S'          TO SCR-IERR                             
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE CCG-COD-MENS TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE '00'         TO FIO-STAT                             
              IF CCG-COD-MEN2 > SPACES                                  
                 MOVE MSG-GLS-DESC TO FRM-MEN1                          
                 MOVE CCG-COD-MEN2 TO FRM-MEN2                          
              ELSE                                                      
                 MOVE MSG-GLS-DESC TO FRM-MENS.                         
      *>>>>                                                             
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )           
      *>>>>                                                             
*% END
*% IF EOF
      *<<<< EOF                                                         
       PGM-EBR-ALL SECTION.
       INI-PGM-EBR-ALL.
           MOVE 'GNS' TO FIO-SIST.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
       FIN-PGM-EBR-ALL.
           EXIT.

      *--------------------------------------------------------------*

       PRO-CAL-COND SECTION.
       INI-PRO-CAL-COND.
           PERFORM PRO-OBT-UEFE-IVA.
      *    Obtiene Parametros para Generar Matriz
           PERFORM PRO-OBT-PGDM.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Calcula Nro Cuotas de Matriz
           PERFORM PRO-OBT-CTAS.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Calcula Nro Montos de Matriz
           PERFORM PRO-OBT-MNTO.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Genera Vector Principal
           PERFORM PRO-GEN-VMC2.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Calcula Plazos Totales
           PERFORM PRO-CAL-PZOT.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Obtiene Impuestos
           PERFORM PRO-OBT-TIMP.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Busca Tarifas SGS-CGN MC2
           PERFORM PRO-BUS-TMC2.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Procesa Plantillas SGS-CGN
           PERFORM PRO-PLT-TMC2.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Procesa Calculo IMP-SGS-CGN
           PERFORM PRO-CAL-PMC2.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Procesa Calculo INT
           PERFORM PRO-CAL-TASA.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.

      *    Procesa Calculo Valor Cuota Tasa CAE Monto CTC
           PERFORM PRO-CAL-MVEN.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-COND.
       FIN-PRO-CAL-COND.
           EXIT.
      *----------------------------------------------------------------*
       LEE-RCC-CPTO SECTION.
       INI-LEE-RCC-CPTO.
           MOVE ZEROES TO RCC-R IN RCC-VARI.
       LUP-LEE-RCC-CPTO.
           ADD 1 TO RCC-R.
           MOVE RCC-R              TO QUE-NITM.
           MOVE RCC-NOM-TSSGS      TO QUE-COLA.
           MOVE RCC-LEN-TSSGS      TO QUE-LITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE '00'     TO FIO-STAT
              MOVE QUE-ITEM TO OSG-APL-VEC(RCC-R).
           MOVE RCC-NOM-TSSGS     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *----------------------------------------------------------------*
       FIN-LEE-RCC-CPTO.
           EXIT.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE CCG-NOM-TSCCG     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE CCG-NOM-TSCCG-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1          TO SCR-NUM-PANT.
           MOVE LOW-VALUES TO CCG-SGV-CRED-IDX.
      *
           MOVE 1          TO FRM-IFLD.
           MOVE ZEROES     TO WSS-NITM.
      *----------------------------------------------------------------*
           MOVE ZEROES TO WSS-NUM-PFIL IN WSS-VARI.
           MOVE 1      TO WSS-NUM-PCOL IN WSS-VARI.
      *----------------------------------------------------------------*
           MOVE 1 TO WSS-F.
       LUP-PUT-TAB.
           IF WSS-F > WSS-FMAX
              GO TO FIN-PUT-TAB.
           IF WSS-NUM-NVEN(WSS-F) > ZEROES
              PERFORM PUT-TAB-CCG
              PERFORM PUT-CCG-QUE
              PERFORM SET-FRM-IFLD
           ELSE
           IF FRM-IFLD = 1 AND WSS-F = 1
              GO TO MSG-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F.
           GO TO LUP-PUT-TAB.
       MSG-PUT-TAB.
           MOVE 'TAB'          TO MSG-COD-SIST.
           MOVE 'RCCCPT   NEX' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
      *    MOVE 'S' TO SCR-IERR.
       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE CCG-LEN-TSCCG-MAS  TO QUE-LITM.
           MOVE CCG-NOM-TSCCG-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO CCG-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO CCG-MAS-IND-HMAS.

           MOVE WSS-NITM         TO WSS-NUM-ICUR.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO CCG-MAS-NUM-TOCC.
           MOVE CCG-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-NITMMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCG   DMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       PUT-TAB-CCG SECTION.
       INI-PUT-TAB-CCG.
           PERFORM CLR-WSS-CCG.

      *----------------------------------------------------------------*
           MOVE WSS-SGV-CRED(WSS-F) TO CCG-SGV-CRED IN CCG-VARI.
           MOVE WSS-SGV-MLIQ(WSS-F) TO CCG-SGV-MLIQ IN CCG-VARI.
           MOVE WSS-NUM-NVEN(WSS-F) TO CCG-NUM-NVEN IN CCG-VARI.

           MOVE WSS-SGV-MVEN(WSS-F) TO CCG-SGV-MVEN IN CCG-VARI.

           MOVE WSS-SGV-MIMP(WSS-F) TO CCG-SGV-MIMP IN CCG-VARI.
           MOVE WSS-SGV-MSEG(WSS-F) TO CCG-SGV-MSEG IN CCG-VARI.
           MOVE WSS-SGV-MCOM(WSS-F) TO CCG-SGV-MCOM IN CCG-VARI.
           MOVE WSS-SGV-MGAS(WSS-F) TO CCG-SGV-MGAS IN CCG-VARI.
           MOVE WSS-FEC-FPVT(WSS-F) TO CCG-FEC-FPVT IN CCG-VARI.
           MOVE WSS-SGV-MCAE(WSS-F) TO CCG-SGV-MCAE IN CCG-VARI.
           MOVE WSS-SGV-MCTC(WSS-F) TO CCG-SGV-MCTC IN CCG-VARI.
           MOVE WSS-SGV-TASA(WSS-F) TO CCG-SGV-TASA IN CCG-VARI.
           MOVE WSS-MSC-BCTI(WSS-F) TO CCG-MSC-BCTI IN CCG-VARI.
           MOVE WSS-MSC-PBTI(WSS-F) TO CCG-MSC-PBTI IN CCG-VARI.
           MOVE WSS-MSC-BPBT(WSS-F) TO CCG-MSC-BPBT IN CCG-VARI.
           MOVE WSS-MSC-SPBT(WSS-F) TO CCG-MSC-SPBT IN CCG-VARI.
           MOVE WSS-COD-CVTI(WSS-F) TO CCG-COD-CVTI IN CCG-VARI.
           MOVE WSS-MSC-TFPR(WSS-F) TO CCG-MSC-TFPR IN CCG-VARI.
           MOVE WSS-NUM-PREP(WSS-F) TO CCG-NUM-PREP IN CCG-VARI.
           MOVE WSS-MSC-UTPR(WSS-F) TO CCG-MSC-UTPR IN CCG-VARI.

           MOVE WSS-FEC-FUVT(WSS-F) TO CCG-FEC-FUVT IN CCG-VARI.
           MOVE WSS-MSC-CPTO(WSS-F) TO CCG-COD-CPTO IN CCG-VARI.
           MOVE WSS-COD-SCPT(WSS-F) TO CCG-COD-SCPT IN CCG-VARI.
      *----------------------------------------------------------------*

           IF FRM-IFLD > WSS-NITMMAX
              GO TO FIN-PUT-TAB-CCG.

           MOVE CCG-SGV-CRED TO FRM-SGV-CRED IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MLIQ TO FRM-SGV-MLIQ IN CCG-FLD(FRM-IFLD).
           MOVE CCG-NUM-NVEN TO FRM-NUM-NVEN IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MVEN TO FRM-SGV-MVEN IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MIMP TO FRM-SGV-MIMP IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MSEG TO FRM-SGV-MSEG IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MCOM TO FRM-SGV-MCOM IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MGAS TO FRM-SGV-MGAS IN CCG-FLD(FRM-IFLD).
           MOVE CCG-FEC-FPVT TO FRM-FEC-FPVT IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MCAE TO FRM-SGV-MCAE IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-MCTC TO FRM-SGV-MCTC IN CCG-FLD(FRM-IFLD).
           MOVE CCG-SGV-TASA TO FRM-SGV-TASA IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-BCTI TO FRM-MSC-BCTI IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-PBTI TO FRM-MSC-PBTI IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-BPBT TO FRM-MSC-BPBT IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-SPBT TO FRM-MSC-SPBT IN CCG-FLD(FRM-IFLD).
           MOVE CCG-COD-CVTI TO FRM-COD-CVTI IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-TFPR TO FRM-MSC-TFPR IN CCG-FLD(FRM-IFLD).
           MOVE CCG-NUM-PREP TO FRM-NUM-PREP IN CCG-FLD(FRM-IFLD).
           MOVE CCG-MSC-UTPR TO FRM-MSC-UTPR IN CCG-FLD(FRM-IFLD).
           MOVE CCG-FEC-FUVT TO FRM-FEC-FUVT IN CCG-FLD(FRM-IFLD).
           MOVE CCG-COD-CPTO TO FRM-COD-CPTO IN CCG-FLD(FRM-IFLD).
           MOVE CCG-COD-SCPT TO FRM-COD-SCPT IN CCG-FLD(FRM-IFLD).
       FIN-PUT-TAB-CCG.
           EXIT.
      *----------------------------------------------------
       PUT-CCG-QUE SECTION.
       INI-PUT-CCG-QUE.
           IF SCR-OFRM-SRV
              IF WSS-IND-CORP IN WSS-VARI = 'N'
                 PERFORM EDT-VAL-CCG.

           ADD 1                   TO WSS-NITM.
           MOVE CCG-NOM-TSCCG      TO QUE-COLA.
           MOVE CCG-LEN-TSCCG      TO QUE-LITM.
           MOVE WSS-NITM           TO QUE-NITM.
           MOVE SPACES             TO QUE-ITEM.
           MOVE CCG-SGV-CRED-IDX   TO QUE-ITEM.
           MOVE QUE-PUT            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-CCG-QUE.
           EXIT.

       EDT-VAL-CCG SECTION.
       INI-EDT-VAL-CCG.
           MOVE CCG-SGV-CRED     TO FRM-SGV-CRED-EDT.
           MOVE CCG-SGV-MLIQ     TO FRM-SGV-MLIQ-EDT.
           MOVE CCG-NUM-NVEN     TO FRM-NUM-NVEN-EDT.
           MOVE CCG-SGV-MVEN     TO FRM-SGV-MVEN-EDT.
           MOVE CCG-SGV-MIMP     TO FRM-SGV-MIMP-EDT.
           MOVE CCG-SGV-MSEG     TO FRM-SGV-MSEG-EDT.
           MOVE CCG-SGV-MCOM     TO FRM-SGV-MCOM-EDT.
           MOVE CCG-SGV-MGAS     TO FRM-SGV-MGAS-EDT.
           MOVE CCG-SGV-MCAE     TO FRM-SGV-MCAE-EDT.
           MOVE CCG-SGV-MCTC     TO FRM-SGV-MCTC-EDT.
           MOVE CCG-SGV-TASA     TO FRM-SGV-TASA-EDT.
           MOVE CCG-NUM-PREP     TO FRM-NUM-PREP-EDT.

           MOVE FRM-SGV-CRED-EDT TO CCG-SGV-CRED-ALF.
           MOVE FRM-SGV-MLIQ-EDT TO CCG-SGV-MLIQ-ALF.
           MOVE FRM-NUM-NVEN-EDT TO CCG-NUM-NVEN-ALF.
           MOVE FRM-SGV-MVEN-EDT TO CCG-SGV-MVEN-ALF.
           MOVE FRM-SGV-MIMP-EDT TO CCG-SGV-MIMP-ALF.
           MOVE FRM-SGV-MSEG-EDT TO CCG-SGV-MSEG-ALF.
           MOVE FRM-SGV-MCOM-EDT TO CCG-SGV-MCOM-ALF.
           MOVE FRM-SGV-MGAS-EDT TO CCG-SGV-MGAS-ALF.
           MOVE FRM-SGV-MCAE-EDT TO CCG-SGV-MCAE-ALF.
           MOVE FRM-SGV-MCTC-EDT TO CCG-SGV-MCTC-ALF.
           MOVE FRM-SGV-TASA-EDT TO CCG-SGV-TASA-ALF.
           MOVE FRM-NUM-PREP-EDT TO CCG-NUM-PREP-ALF.
       FIN-EDT-VAL-CCG.
           EXIT.

       CLR-WSS-CCG SECTION.
       INI-CLR-WSS-CCG.
           MOVE 'P'    TO CCG-SGV-CRED-ATR.
           MOVE 'P'    TO CCG-SGV-MLIQ-ATR.
           MOVE 'P'    TO CCG-NUM-NVEN-ATR.
           MOVE 'P'    TO CCG-SGV-MVEN-ATR.
           MOVE 'P'    TO CCG-SGV-MIMP-ATR.
           MOVE 'P'    TO CCG-SGV-MSEG-ATR.
           MOVE 'P'    TO CCG-SGV-MCOM-ATR.
           MOVE 'P'    TO CCG-SGV-MGAS-ATR.
           MOVE 'P'    TO CCG-FEC-FPVT-ATR.
           MOVE 'P'    TO CCG-SGV-MCAE-ATR.
           MOVE 'P'    TO CCG-SGV-MCTC-ATR.
           MOVE 'P'    TO CCG-SGV-TASA-ATR.
           MOVE 'P'    TO CCG-MSC-BCTI-ATR.
           MOVE 'P'    TO CCG-MSC-PBTI-ATR.
           MOVE 'P'    TO CCG-MSC-BPBT-ATR.
           MOVE 'P'    TO CCG-MSC-SPBT-ATR.
           MOVE 'P'    TO CCG-COD-CVTI-ATR.
           MOVE 'P'    TO CCG-MSC-TFPR-ATR.
           MOVE 'P'    TO CCG-NUM-PREP-ATR.
           MOVE 'P'    TO CCG-MSC-UTPR-ATR.
           MOVE 'P'    TO CCG-FEC-FUVT-ATR.
           MOVE 'P'    TO CCG-COD-CPTO-ATR.
           MOVE 'P'    TO CCG-COD-SCPT-ATR.

           MOVE ZEROES TO CCG-SGV-CRED.
           MOVE ZEROES TO CCG-SGV-MLIQ.
           MOVE ZEROES TO CCG-NUM-NVEN.
           MOVE ZEROES TO CCG-SGV-MVEN.
           MOVE ZEROES TO CCG-SGV-MIMP.
           MOVE ZEROES TO CCG-SGV-MSEG.
           MOVE ZEROES TO CCG-SGV-MCOM.
           MOVE ZEROES TO CCG-SGV-MGAS.
           MOVE ZEROES TO CCG-FEC-FPVT.
           MOVE ZEROES TO CCG-SGV-MCAE.
           MOVE ZEROES TO CCG-SGV-MCTC.
           MOVE ZEROES TO CCG-SGV-TASA.
           MOVE SPACES TO CCG-MSC-BCTI.
           MOVE SPACES TO CCG-MSC-PBTI.
           MOVE SPACES TO CCG-MSC-BPBT.
           MOVE SPACES TO CCG-MSC-SPBT.
           MOVE SPACES TO CCG-COD-CVTI.
           MOVE SPACES TO CCG-MSC-TFPR.
           MOVE ZEROES TO CCG-NUM-PREP.
           MOVE SPACES TO CCG-MSC-UTPR.
           MOVE ZEROES TO CCG-FEC-FUVT.
           MOVE SPACES TO CCG-COD-CPTO.
           MOVE SPACES TO CCG-COD-SCPT.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.
       FIN-CLR-WSS-CCG.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.
           MOVE 'P'    TO FRM-SGV-CRED-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MLIQ-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-NUM-NVEN-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MVEN-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MIMP-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MSEG-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MCOM-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MGAS-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-FEC-FPVT-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MCAE-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-MCTC-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-SGV-TASA-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-BCTI-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-PBTI-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-BPBT-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-SPBT-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-COD-CVTI-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-TFPR-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-NUM-PREP-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-MSC-UTPR-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-FEC-FUVT-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-COD-CPTO-ATR IN CCG-FLD(1).
           MOVE 'P'    TO FRM-COD-SCPT-ATR IN CCG-FLD(1).

           MOVE ZEROES TO FRM-SGV-CRED     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MLIQ     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-NUM-NVEN     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MVEN     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MIMP     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MSEG     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MCOM     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MGAS     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-FEC-FPVT     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MCAE     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-MCTC     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-SGV-TASA     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-BCTI     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-PBTI     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-BPBT     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-SPBT     IN CCG-FLD(1).
           MOVE SPACES TO FRM-COD-CVTI     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-TFPR     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-NUM-PREP     IN CCG-FLD(1).
           MOVE SPACES TO FRM-MSC-UTPR     IN CCG-FLD(1).
           MOVE ZEROES TO FRM-FEC-FUVT     IN CCG-FLD(1).
           MOVE SPACES TO FRM-COD-CPTO     IN CCG-FLD(1).
           MOVE SPACES TO FRM-COD-SCPT     IN CCG-FLD(1).
       FIN-CLR-FRM-MTX.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE CCG-NOM-TSCCG TO QUE-COLA.
           MOVE CCG-LEN-TSCCG TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'CCG   NONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-SGV-CRED-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE CCG-NOM-TSCCG TO QUE-COLA
               MOVE CCG-LEN-TSCCG TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CCG   DMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'CCG   NOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE CCG-NOM-TSCCG TO QUE-COLA
           MOVE CCG-LEN-TSCCG TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'CCG   NOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-SGV-CRED-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CCG   DMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

      *------------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE ZEROES TO FRM-SGV-CRED IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MLIQ IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-NVEN IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MVEN IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MIMP IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MSEG IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MCOM IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MGAS IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FPVT IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MCAE IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MCTC IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TASA IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-BCTI IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-PBTI IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-BPBT IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-SPBT IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CVTI IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-TFPR IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-PREP IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-UTPR IN CCG-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FUVT IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPTO IN CCG-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-SCPT IN CCG-FLD(WSS-I).
       FIN-CLR-FRM.
           EXIT.

       SCRL-TAB-CCG SECTION.
       INI-SCRL-TAB-CCG.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CCG.
           EXIT.

       COPY TABBFCAM.
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY COLBFPOC.

      *PVG INI 27-ENE-2017
      *COPY TABBFSGS.
       COPY MC2BFSGS.
      *PVG FIN 27-ENE-2017
       COPY MC2BFCGN.
       COPY MC2BFDGN.
      *PVG INI 04-FEB-2015
      *PVG INI 27-ENE-2017
      *COPY TABBFROC.
       COPY MC2BFROC.
      *PVG FIN 27-ENE-2017
      *PVG FIN 04-FEB-2015

      *COPY GNSBVCOD.
      *COPY GNSBVTAB.
       COPY GNSBPFEC.

      *COPY TABBKRCC.
       COPY MC2BKRCC.

       COPY GNSBGPES.
      *----------------------------------------------------------------*
      *----------------------------------------------------------------*
       COPY COLBGMIC.
      *----------------------------------------------------------------*

       PRO-OBT-PGDM SECTION.
       INI-PRO-OBT-PGDM.
           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.
           MOVE 'GDM'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-MGDM IN CCG-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              MOVE 'ERRPARTABGDM' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-OBT-PGDM.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-PGDM IN WSS-VARI.

           IF (WSS-NUM-NFIL IN WSS-VARI NOT NUMERIC OR
               WSS-NUM-NCOL IN WSS-VARI NOT NUMERIC OR
               WSS-NUM-LMTE IN WSS-VARI NOT NUMERIC OR
               WSS-NUM-PINF IN WSS-VARI NOT NUMERIC OR
               WSS-NUM-PSUP IN WSS-VARI NOT NUMERIC OR
               WSS-NUM-FCTM IN WSS-VARI NOT NUMERIC)
              MOVE 'ERRVALTABGDM' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-OBT-PGDM.

           IF WSS-VSN-ESGS IN WSS-VARI NOT > SPACES
              MOVE 'SNP' TO WSS-VSN-ESGS IN WSS-VARI.
           IF WSS-VSN-ECGN IN WSS-VARI NOT > SPACES
              MOVE 'SNP' TO WSS-VSN-ECGN IN WSS-VARI.
           IF WSS-IND-MINT IN WSS-VARI NOT > SPACES
              MOVE 'L' TO WSS-IND-MINT IN WSS-VARI.

           IF NOT (WSS-IND-VUCO IN WSS-VARI = 'S' OR 'N')
              MOVE 'S' TO WSS-IND-VUCO IN WSS-VARI.
           IF NOT (WSS-IND-CCAE IN WSS-VARI = 'S' OR 'N')
              MOVE 'S' TO WSS-IND-CCAE IN WSS-VARI.
           IF NOT (WSS-IND-MCTC IN WSS-VARI = 'S' OR 'N')
              MOVE 'S' TO WSS-IND-MCTC IN WSS-VARI.

           IF WSS-NUM-NFIL IN WSS-VARI > WSS-NUM-MFIL IN WSS-VARI
              MOVE WSS-NUM-MFIL IN WSS-VARI TO WSS-NUM-NFIL IN WSS-VARI.
           IF WSS-NUM-NFIL IN WSS-VARI < WSS-NUM-MFIL IN WSS-VARI
              MOVE WSS-NUM-NFIL IN WSS-VARI TO WSS-NUM-MFIL IN WSS-VARI.

           IF WSS-NUM-NCOL IN WSS-VARI > WSS-NUM-MCOL IN WSS-VARI
              MOVE WSS-NUM-MCOL IN WSS-VARI TO WSS-NUM-NCOL IN WSS-VARI.
           IF WSS-NUM-NCOL IN WSS-VARI < WSS-NUM-MCOL IN WSS-VARI
              MOVE WSS-NUM-NCOL IN WSS-VARI TO WSS-NUM-MCOL IN WSS-VARI.

           PERFORM PRO-CLR-MTRZ.
           PERFORM PRO-CLR-PMC2.
      *PVG INI 04-FEB-2015
           MOVE 'N'    TO WSS-INF-RROC IN WSS-VARI.
           IF WSS-IND-PROC IN WSS-VARI = 'ROC'
      *MHM-INI 30-ABR-2018
      *        MOVE FRM-COD-ADC1 IN CDC-FLD TO WSS-GLS-ROC1 IN WSS-VARI
      *        MOVE FRM-COD-ADC2 IN CDC-FLD TO WSS-GLS-ROC2 IN WSS-VARI
      *        MOVE FRM-COD-ADC3 IN CDC-FLD TO WSS-GLS-ROC3 IN WSS-VARI
      *        MOVE FRM-COD-ADC4 IN CDC-FLD TO WSS-GLS-ROC4 IN WSS-VARI
              MOVE FRM-CAI-IROC IN CCG-FLD TO WSS-CAI-IROC IN WSS-VARI
              MOVE FRM-IIC-IROC IN CCG-FLD TO WSS-IIC-IROC IN WSS-VARI
      *MHM-FIN 30-ABR-2018
              MOVE SPACES                  TO WSS-FIL-RROC IN WSS-VARI
              IF WSS-KEY-RROC IN WSS-VARI > SPACES
                 MOVE '0000'               TO WSS-FIL-RROC IN WSS-VARI
                 PERFORM PRO-LEC-RROC.
      *PVG FIN 04-FEB-2015
       FIN-PRO-OBT-PGDM.
           EXIT.

       PRO-OBT-CTAS SECTION.
       INI-PRO-OBT-CTAS.
           IF FRM-NUM-VIGU IN CCG-FLD < WSS-NUM-LMTE IN WSS-VARI
              MOVE WSS-NUM-PINF IN WSS-VARI TO WSS-NUM-BCTA IN WSS-VARI
           ELSE
              MOVE WSS-NUM-PSUP IN WSS-VARI TO WSS-NUM-BCTA IN WSS-VARI.
           DIVIDE FRM-NUM-VIGU IN CCG-FLD BY WSS-NUM-BCTA IN WSS-VARI
           GIVING WSS-NUM-FCTA IN WSS-VARI.
           MOVE FRM-NUM-VIGU IN CCG-FLD TO WSS-NUM-NCTA IN WSS-VARI.
       LUP-PRO-OBT-CTAS.
           ADD 1 TO WSS-NUM-PFIL IN WSS-VARI.
           IF WSS-NUM-PFIL IN WSS-VARI > WSS-NUM-MFIL IN WSS-VARI
              GO TO FIN-PRO-OBT-CTAS.

           IF WSS-NUM-NCTA IN WSS-VARI > WSS-POC-NUM-VMAX
              MOVE WSS-NUM-PFIL IN WSS-VARI TO WSS-NUM-MFIL IN WSS-VARI
              SUBTRACT 1 FROM WSS-NUM-MFIL IN WSS-VARI
              GO TO FIN-PRO-OBT-CTAS.

           IF WSS-NUM-NCTA IN WSS-VARI = WSS-POC-NUM-VMAX
              MOVE WSS-POC-NUM-VMAX         TO WSS-NUM-NCTA IN WSS-VARI
              MOVE WSS-NUM-PFIL IN WSS-VARI TO WSS-NUM-MFIL IN WSS-VARI.

           MOVE WSS-NUM-NCTA IN WSS-VARI TO
                VEC-NUM-NVEN(WSS-NUM-PFIL , 1).
           SUBTRACT 1 FROM WSS-NUM-NFIL IN WSS-VARI.
           IF WSS-NUM-NFIL IN WSS-VARI NOT > ZEROES
              GO TO FIN-PRO-OBT-CTAS.
           ADD 1 TO WSS-NUM-FCTA IN WSS-VARI.
           MULTIPLY WSS-NUM-BCTA IN WSS-VARI BY WSS-NUM-FCTA IN WSS-VARI
             GIVING WSS-NUM-NCTA IN WSS-VARI.
           GO TO LUP-PRO-OBT-CTAS.
       FIN-PRO-OBT-CTAS.
           EXIT.

       PRO-OBT-MNTO SECTION.
       INI-PRO-OBT-MNTO.
           PERFORM PRO-CAL-CPOI.
           IF CCG-COD-MENS IN CCG-VARI > SPACES GO TO FIN-PRO-OBT-MNTO.

           DIVIDE WSS-NUM-FCTM IN WSS-VARI BY 100
           GIVING WSS-SGV-FCTM IN WSS-VARI.
           ADD 1 TO WSS-SGV-FCTM IN WSS-VARI.
           MOVE FRM-VAL-MOPE IN CCG-FLD TO WSS-VAL-MOPE IN WSS-VARI.
       LUP-PRO-OBT-MNTO.
           ADD 1 TO WSS-NUM-PCOL IN WSS-VARI.
           IF WSS-NUM-PCOL IN WSS-VARI > WSS-NUM-MCOL IN WSS-VARI
              GO TO FIN-PRO-OBT-MNTO.

           MOVE ZEROES TO WSS-NUM-PFIL IN WSS-VARI.
       LUP-PRO-OBT-MNTO-PFIL.
           ADD 1 TO WSS-NUM-PFIL IN WSS-VARI.
           IF WSS-NUM-PFIL IN WSS-VARI > WSS-NUM-MFIL IN WSS-VARI
              GO TO CNT-PRO-OBT-MNTO.

           IF WSS-VAL-MOPE IN WSS-VARI > WSS-POC-VAL-CMAX
              MOVE WSS-NUM-PCOL IN WSS-VARI TO WSS-NUM-MCOL IN WSS-VARI
              SUBTRACT 1 FROM WSS-NUM-MCOL IN WSS-VARI
              GO TO FIN-PRO-OBT-MNTO.

           IF WSS-VAL-MOPE IN WSS-VARI = WSS-POC-VAL-CMAX
              MOVE WSS-POC-VAL-CMAX         TO WSS-VAL-MOPE IN WSS-VARI
              MOVE WSS-NUM-PCOL IN WSS-VARI TO WSS-NUM-MCOL IN WSS-VARI.

           MOVE WSS-VAL-MOPE IN WSS-VARI TO
                       VEC-SGV-CRED(WSS-NUM-PFIL, WSS-NUM-PCOL).
           MOVE VEC-NUM-NVEN(WSS-NUM-PFIL , 1) TO
                       VEC-NUM-NVEN(WSS-NUM-PFIL, WSS-NUM-PCOL).
           GO TO LUP-PRO-OBT-MNTO-PFIL.

       CNT-PRO-OBT-MNTO.
           SUBTRACT 1 FROM WSS-NUM-NCOL IN WSS-VARI.
           IF WSS-NUM-NCOL IN WSS-VARI NOT > ZEROES
              GO TO FIN-PRO-OBT-MNTO.
           MULTIPLY WSS-VAL-MOPE IN WSS-VARI BY WSS-SGV-FCTM IN WSS-VARI
             GIVING WSS-VAL-MOPE IN WSS-VARI.

      *----------------------------------------------------------------*
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              COMPUTE WSS-VAL-MMIL IN WSS-VARI ROUNDED =
                     (WSS-VAL-MOPE IN WSS-VARI / 1000)
              COMPUTE WSS-VAL-MOPE IN WSS-VARI ROUNDED =
                     (WSS-VAL-MMIL IN WSS-VARI * 1000)
           ELSE
              COMPUTE WSS-VAL-MMIL IN WSS-VARI ROUNDED =
                     (WSS-VAL-MOPE IN WSS-VARI * 1)
              MOVE    WSS-VAL-MMIL IN WSS-VARI TO
                      WSS-VAL-MOPE IN WSS-VARI.
      *----------------------------------------------------------------*
           GO TO LUP-PRO-OBT-MNTO.
       FIN-PRO-OBT-MNTO.
           EXIT.

       PRO-CLR-MTRZ SECTION.
       INI-PRO-CLR-MTRZ.
           MOVE ZEROES TO WSS-NUM-PFIL IN WSS-VARI.
       LUP-PRO-CLR-PFIL.
           ADD 1 TO WSS-NUM-PFIL IN WSS-VARI.
           IF WSS-NUM-PFIL IN WSS-VARI > WSS-NUM-MFIL IN WSS-VARI
              GO TO EXT-PRO-CLR-MTRZ.
           MOVE ZEROES TO WSS-NUM-PCOL IN WSS-VARI.
       LUP-PRO-CLR-PCOL.
           ADD 1 TO WSS-NUM-PCOL IN WSS-VARI.
           IF WSS-NUM-PCOL IN WSS-VARI > WSS-NUM-MCOL IN WSS-VARI
              GO TO LUP-PRO-CLR-PFIL.

           MOVE ZEROES TO VEC-SGV-CRED(WSS-NUM-PFIL , WSS-NUM-PCOL).
           MOVE ZEROES TO VEC-NUM-NVEN(WSS-NUM-PFIL , WSS-NUM-PCOL).

           GO TO LUP-PRO-CLR-PCOL.
       EXT-PRO-CLR-MTRZ.
           MOVE ZEROES TO WSS-NUM-PFIL IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PCOL IN WSS-VARI.
       FIN-PRO-CLR-MTRZ.
           EXIT.

       PRO-CLR-PMC2 SECTION.
       INI-PRO-CLR-PMC2.
           MOVE ZEROES TO WSS-NUM-PMC2 IN WSS-VARI.
       LUP-PRO-CLR-PMC2.
           ADD 1 TO WSS-NUM-PMC2 IN WSS-VARI.
           IF WSS-NUM-PMC2 IN WSS-VARI > WSS-NUM-MMC2 IN WSS-VARI
              GO TO FIN-PRO-CLR-PMC2.
           MOVE ZEROES TO WSS-SGV-CRED(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MLIQ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-NVEN(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MVEN(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MIMP(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MCOM(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-FEC-FPVT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MCAE(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-MCTC(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-TASA(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-BCTI(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-PBTI(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-BPBT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-SPBT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-COD-CVTI(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-TFPR(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-PREP(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-UTPR(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-FEC-FUVT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-MSC-CPTO(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE SPACES TO WSS-COD-SCPT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-PZOD(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-PZOM(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-PZOA(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-NUM-EDAD(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-TFCT(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-SGV-TMFJ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO WSS-VAL-MCAE(WSS-NUM-PMC2 IN WSS-VARI).

           MOVE ZEROES TO CCG-SGV-CRED-MTZ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO CCG-NUM-NVEN-MTZ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO CCG-NUM-PZOD-MTZ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO CCG-NUM-PZOM-MTZ(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE ZEROES TO CCG-NUM-PZOA-MTZ(WSS-NUM-PMC2 IN WSS-VARI).

           GO TO LUP-PRO-CLR-PMC2.
       FIN-PRO-CLR-PMC2.
           EXIT.

       PRO-CAL-CPOI SECTION.
       INI-PRO-CAL-CPOI.
           IF FRM-VAL-CPOI IN CCG-FLD NOT > ZEROES
              GO TO FIN-PRO-CAL-CPOI.
           MOVE FRM-VAL-CPOI IN CCG-FLD TO WSS-VAL-MCPO IN WSS-VARI.
           IF FRM-COD-MCPO IN CCG-FLD = FRM-COD-VCOC IN CCG-FLD
              GO TO EXT-PRO-CAL-CPOI.

           IF WSS-SGV-VCAM IN WSS-VARI > ZEROES
              GO TO CNT-PRO-CAL-CPOI.

           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FCUR IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF ( NOT FIO-STAT-OKS ) OR
              ( CAM-MSC-STAT IN CAM NOT = 'S' )
               MOVE 'CAM    NEX'        TO CCG-COD-MENS IN CCG-VARI
               GO TO FIN-PRO-CAL-CPOI.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM IN WSS-VARI.
       CNT-PRO-CAL-CPOI.

           IF FRM-COD-MCPO IN CCG-FLD = WSS-COD-PESO IN WSS-VARI
              COMPUTE WSS-VAL-MCPO IN WSS-VARI ROUNDED =
                  (FRM-VAL-CPOI IN CCG-FLD / WSS-SGV-VCAM IN WSS-VARI)
           ELSE
              COMPUTE WSS-VAL-MCPO IN WSS-VARI ROUNDED =
                  (FRM-VAL-CPOI IN CCG-FLD * WSS-SGV-VCAM IN WSS-VARI).
       EXT-PRO-CAL-CPOI.
           IF WSS-VAL-MCPO IN WSS-VARI > WSS-POC-VAL-CMAX
              MOVE WSS-POC-VAL-CMAX TO WSS-VAL-MCPO IN WSS-VARI.
           IF WSS-VAL-MCPO IN WSS-VARI < WSS-POC-VAL-CMAX
              MOVE WSS-VAL-MCPO IN WSS-VARI TO  WSS-POC-VAL-CMAX.

           IF ((FRM-IND-MNTO IN CCG-FLD = 'B' AND
               FRM-VAL-MOPE IN CCG-FLD > WSS-VAL-MCPO IN WSS-VARI) OR
              (FRM-IND-MNTO IN CCG-FLD = 'L' AND
               FRM-VAL-MOPE IN CCG-FLD > WSS-VAL-MCPO IN WSS-VARI ))
               MOVE 'MOPE INVMCPO' TO CCG-COD-MENS IN CCG-VARI.
       FIN-PRO-CAL-CPOI.
           EXIT.

       PRO-GEN-VMC2 SECTION.
       INI-PRO-GEN-VMC2.
           MOVE ZEROES TO WSS-NUM-PFIL IN WSS-VARI.
           MOVE 1      TO WSS-NUM-PCOL IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PMC2 IN WSS-VARI.

       LUP-PRO-GEN-VMC2-PFIL.
           ADD 1 TO WSS-NUM-PFIL IN WSS-VARI.
           IF WSS-NUM-PFIL IN WSS-VARI > WSS-NUM-MFIL IN WSS-VARI
              MOVE 1 TO WSS-NUM-PFIL IN WSS-VARI
              ADD  1 TO WSS-NUM-PCOL IN WSS-VARI
              IF WSS-NUM-PCOL IN WSS-VARI > WSS-NUM-MCOL IN WSS-VARI
                 GO TO FIN-PRO-GEN-VMC2.

           ADD 1 TO WSS-NUM-PMC2 IN WSS-VARI.
           IF WSS-NUM-PMC2 IN WSS-VARI > WSS-NUM-MMC2 IN WSS-VARI
              GO TO FIN-PRO-GEN-VMC2.

           MOVE VEC-NUM-NVEN(WSS-NUM-PFIL , WSS-NUM-PCOL) TO
                WSS-NUM-NVEN(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE VEC-SGV-CRED(WSS-NUM-PFIL , WSS-NUM-PCOL) TO
                WSS-SGV-CRED(WSS-NUM-PMC2 IN WSS-VARI).
           MOVE VEC-SGV-CRED(WSS-NUM-PFIL , WSS-NUM-PCOL) TO
                WSS-SGV-MLIQ(WSS-NUM-PMC2 IN WSS-VARI).

           GO TO LUP-PRO-GEN-VMC2-PFIL.
       FIN-PRO-GEN-VMC2.
           EXIT.

       PRO-CAL-PZOT SECTION.
       INI-PRO-CAL-PZOT.
           MOVE ZEROES TO WSS-NUM-PMC2 IN WSS-VARI.
       LUP-PRO-CAL-PZOT.
           ADD 1 TO WSS-NUM-PMC2 IN WSS-VARI.
           IF WSS-NUM-PMC2 IN WSS-VARI > WSS-NUM-MMC2 IN WSS-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF NOT (WSS-SGV-CRED(WSS-NUM-PMC2 IN WSS-VARI) > ZEROES)
              GO TO FIN-PRO-CAL-PZOT.

           IF (FRM-NUM-MNP1 IN CCG-FLD > ZEROES OR
               FRM-NUM-MNP2 IN CCG-FLD > ZEROES OR
               FRM-NUM-MNP3 IN CCG-FLD > ZEROES OR
               FRM-NUM-MNP4 IN CCG-FLD > ZEROES)
               GO TO CNT-PRO-CAL-PZOT-NP.

           IF WSS-NUM-PZOD(WSS-NUM-PMC2 IN WSS-VARI) > ZEROES
              GO TO NXT-PRO-CAL-PZOT.

           COMPUTE WSS-NUM-SEVE IN WSS-VARI ROUNDED =
                  (FRM-NUM-SEVE IN CCG-FLD *
                  (WSS-NUM-NVEN(WSS-NUM-PMC2) - 1)).

           MOVE WSS-NUM-DVEN IN WSS-VARI    TO FEC-ITM1.
           MOVE WSS-NUM-MVEN IN WSS-VARI    TO FEC-ITM2.
           MOVE WSS-NUM-SVEN IN WSS-VARI    TO FEC-ITM3.
           MOVE WSS-NUM-AVEN IN WSS-VARI    TO FEC-ITM4.
           IF FRM-IND-UTSV IN CCG-FLD = 'D'
              MOVE WSS-NUM-SEVE IN WSS-VARI TO FEC-NDIA
              MOVE FEC-SUM-DIA              TO FEC-CMND
           ELSE
           IF FRM-IND-UTSV IN CCG-FLD = 'M'
              MOVE WSS-NUM-SEVE IN WSS-VARI TO FEC-NMES
              MOVE FEC-SUM-MES              TO FEC-CMND
           ELSE
              MOVE WSS-NUM-SEVE IN WSS-VARI TO FEC-NANO
              MOVE FEC-SUM-ANO              TO FEC-CMND.
           MOVE FEC-FORM-FEC                TO FEC-FORM.
           PERFORM CAL-FEC.

           IF WSS-IND-AFER IN WSS-VARI = 'S'
              MOVE FEC-FBLK-N      TO FEC-FBLK
              MOVE FEC-CHOY-N      TO FEC-CHOY
              MOVE FEC-VHBL-S      TO FEC-VHBL
              MOVE FEC-VAL-FEC     TO FEC-CMND
              MOVE FEC-FORM-FEC    TO FEC-FORM
              PERFORM PRO-FEC
              IF FEC-STAT-FER
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-SIG-HBL  TO FEC-CMND
                 PERFORM CAL-FEC.
      *Plazo Dias
           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE FEC-ITM1                 TO FEC-DEC2.
           MOVE FEC-ITM2                 TO FEC-MEC2.
           MOVE FEC-ITM3                 TO FEC-SEC2.
           MOVE FEC-ITM4                 TO FEC-AEC2.
           MOVE FEC-DEC2                 TO WSS-NUM-DMVT IN WSS-VARI.
           MOVE FEC-MEC2                 TO WSS-NUM-MMVT IN WSS-VARI.
           MOVE FEC-SEC2                 TO WSS-NUM-SMVT IN WSS-VARI.
           MOVE FEC-AEC2                 TO WSS-NUM-AMVT IN WSS-VARI.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-DIF-DIA              TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'DIFDIA NOVLD' TO CCG-COD-MENS IN CCG-VARI
               GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           MOVE FEC-NDIA TO WSS-NUM-PZOD(WSS-NUM-PMC2).

      *Plazo Meses
           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFMES NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NMES.
           MOVE FEC-NMES TO WSS-NUM-PZOM(WSS-NUM-PMC2).

      *Plazo Agnos
           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFANO NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NANO.
           MOVE FEC-NANO TO WSS-NUM-PZOA(WSS-NUM-PMC2).

      *Edad Agnos Fecha Maximo Vencimiento
           MOVE WSS-NUM-DNAC IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MNAC IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SNAC IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ANAC IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFANO NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NANO.
           MOVE FEC-NANO TO WSS-NUM-EDAD(WSS-NUM-PMC2).

           MOVE WSS-NUM-PMC2 IN WSS-VARI TO WSS-P.
           PERFORM PRO-CRG-PZOI.
           GO TO NXT-PRO-CAL-PZOT.

       CNT-PRO-CAL-PZOT-NP.

           IF WSS-NUM-PZOD(WSS-NUM-PMC2 IN WSS-VARI) > ZEROES
              GO TO NXT-PRO-CAL-PZOT.

           COMPUTE WSS-NUM-SEVE IN WSS-VARI ROUNDED =
                  (WSS-NUM-NVEN(WSS-NUM-PMC2) - 1).

           MOVE WSS-NUM-DVEN IN WSS-VARI    TO FEC-ITM1.
           MOVE WSS-NUM-MVEN IN WSS-VARI    TO FEC-ITM2.
           MOVE WSS-NUM-SVEN IN WSS-VARI    TO FEC-ITM3.
           MOVE WSS-NUM-AVEN IN WSS-VARI    TO FEC-ITM4.
       LUP-PRO-CAL-PZOT-NP.
           IF FRM-IND-UTSV IN CCG-FLD = 'D'
              MOVE FRM-NUM-SEVE IN CCG-FLD  TO FEC-NDIA
              MOVE FEC-SUM-DIA              TO FEC-CMND
           ELSE
           IF FRM-IND-UTSV IN CCG-FLD = 'M'
              MOVE FRM-NUM-SEVE IN CCG-FLD  TO FEC-NMES
              MOVE FEC-SUM-MES              TO FEC-CMND
           ELSE
              MOVE FRM-NUM-SEVE IN CCG-FLD  TO FEC-NANO
              MOVE FEC-SUM-ANO              TO FEC-CMND.
           MOVE FEC-FORM-FEC                TO FEC-FORM.
           PERFORM CAL-FEC.
           IF (FEC-ITM2 = FRM-NUM-MNP1 IN CCG-FLD OR
               FEC-ITM2 = FRM-NUM-MNP2 IN CCG-FLD OR
               FEC-ITM2 = FRM-NUM-MNP3 IN CCG-FLD OR
               FEC-ITM2 = FRM-NUM-MNP4 IN CCG-FLD )
               GO TO LUP-PRO-CAL-PZOT-NP.

           SUBTRACT 1 FROM WSS-NUM-SEVE IN WSS-VARI.
           IF WSS-NUM-SEVE IN WSS-VARI > ZEROES
              GO TO LUP-PRO-CAL-PZOT-NP.

           IF WSS-IND-AFER IN WSS-VARI = 'S'
              MOVE FEC-FBLK-N      TO FEC-FBLK
              MOVE FEC-CHOY-N      TO FEC-CHOY
              MOVE FEC-VHBL-S      TO FEC-VHBL
              MOVE FEC-VAL-FEC     TO FEC-CMND
              MOVE FEC-FORM-FEC    TO FEC-FORM
              PERFORM PRO-FEC
              IF FEC-STAT-FER
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-SIG-HBL  TO FEC-CMND
                 PERFORM CAL-FEC.

           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE FEC-ITM1                 TO FEC-DEC2.
           MOVE FEC-ITM2                 TO FEC-MEC2.
           MOVE FEC-ITM3                 TO FEC-SEC2.
           MOVE FEC-ITM4                 TO FEC-AEC2.
           MOVE FEC-DEC2                 TO WSS-NUM-DMVT IN WSS-VARI.
           MOVE FEC-MEC2                 TO WSS-NUM-MMVT IN WSS-VARI.
           MOVE FEC-SEC2                 TO WSS-NUM-SMVT IN WSS-VARI.
           MOVE FEC-AEC2                 TO WSS-NUM-AMVT IN WSS-VARI.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FEC-DIF-DIA              TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'DIFDIA NOVLD' TO CCG-COD-MENS IN CCG-VARI
               GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           MOVE FEC-NDIA TO WSS-NUM-PZOD(WSS-NUM-PMC2).

           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFMES NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NMES.
           MOVE FEC-NMES TO WSS-NUM-PZOM(WSS-NUM-PMC2).

           MOVE WSS-NUM-DCUR IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFMES NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NANO.
           MOVE FEC-NANO TO WSS-NUM-PZOA(WSS-NUM-PMC2).

           MOVE WSS-NUM-DNAC IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MNAC IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SNAC IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-ANAC IN WSS-VARI TO FEC-AEC1.
           MOVE WSS-NUM-DMVT IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMVT IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMVT IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMVT IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'DIFANO NOVLD' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-CAL-PZOT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
              COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
           IF FEC-NDIA > 0
              ADD 1 TO FEC-NANO.
           MOVE FEC-NANO TO WSS-NUM-EDAD(WSS-NUM-PMC2).

           MOVE WSS-NUM-PMC2 IN WSS-VARI TO WSS-P.
           PERFORM PRO-CRG-PZOI.

       NXT-PRO-CAL-PZOT.
           GO TO LUP-PRO-CAL-PZOT.
       FIN-PRO-CAL-PZOT.
           EXIT.

       PRO-CRG-PZOI SECTION.
       INI-PRO-CRG-PZOI.
           ADD 1 TO WSS-P.
           IF WSS-P > WSS-NUM-MMC2 IN WSS-VARI
              GO TO FIN-PRO-CRG-PZOI.
           IF NOT (WSS-SGV-CRED(WSS-P) > ZEROES)
              GO TO FIN-PRO-CRG-PZOI.
           IF WSS-NUM-NVEN(WSS-P) = WSS-NUM-NVEN(WSS-NUM-PMC2)
              MOVE WSS-NUM-PZOD(WSS-NUM-PMC2) TO WSS-NUM-PZOD(WSS-P)
              MOVE WSS-NUM-PZOM(WSS-NUM-PMC2) TO WSS-NUM-PZOM(WSS-P)
              MOVE WSS-NUM-PZOA(WSS-NUM-PMC2) TO WSS-NUM-PZOA(WSS-P)
              MOVE WSS-NUM-EDAD(WSS-NUM-PMC2) TO WSS-NUM-EDAD(WSS-P).
           GO TO INI-PRO-CRG-PZOI.
       FIN-PRO-CRG-PZOI.
           EXIT.

      *----------------------------------------------------------------*
       PRO-OBT-TIMP SECTION.
       INI-PRO-OBT-TIMP.
           MOVE ZEROES TO WSS-SGV-IMPP IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-IMPM IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-IMPD IN WSS-VARI.

      *PVG INI 04-FEB-2015
           IF WSS-CCG-TIMP IN WSS-VARI = 'E' OR 'I'
              GO TO FIN-PRO-OBT-TIMP.
      *PVG FIN 04-FEB-2015
           MOVE WSS-FEC-FCUR IN WSS-VARI TO WSS-FEC-CTAB IN WSS-VARI.
           MOVE WSS-COD-TDOC IN WSS-VARI TO WSS-GLS-DOCU IN WSS-VARI.
           MOVE WSS-MSC-TIMP IN WSS-VARI TO WSS-GLS-TIPO IN WSS-VARI.

           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'TIM'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-PRO-OBT-TIMP.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'TIM')
              GO TO FIN-PRO-OBT-TIMP.
           IF TAB-IND-VIGE IN TAB NOT = 'S'
              GO TO NXT-PRO-OBT-TIMP.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTIM IN WSS-VARI.
           IF (WSS-GLS-DOCU IN WSS-VARI NOT = WSS-GLS-DTIM IN WSS-VARI
               OR
               WSS-GLS-TIPO IN WSS-VARI NOT = WSS-GLS-TTIM IN WSS-VARI)
               GO TO NXT-PRO-OBT-TIMP.

           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DIMP IN WSS-VARI.

           IF WSS-VAL-IMPP IN WSS-VARI NOT NUMERIC
              MOVE 'PRDOTIM  INV' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-OBT-TIMP.
           COMPUTE WSS-SGV-IMPP IN WSS-VARI =
                 ( WSS-VAL-IMPP IN WSS-VARI / 1000000000000 ).

           IF WSS-VAL-IMPM IN WSS-VARI NOT NUMERIC
              MOVE 'IMPMTIM  INV' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-OBT-TIMP.
           COMPUTE WSS-SGV-IMPM IN WSS-VARI =
                 ( WSS-VAL-IMPM IN WSS-VARI / 1000000000000 ).

           IF WSS-VAL-IMPD IN WSS-VARI NOT NUMERIC
              MOVE 'IMPDTIM  INV' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-OBT-TIMP.
           COMPUTE WSS-SGV-IMPD IN WSS-VARI =
                 ( WSS-VAL-IMPD IN WSS-VARI / 1000000000000 ).
           IF WSS-SGV-IMPD IN WSS-VARI > ZEROES
           COMPUTE WSS-SGV-IMPD IN WSS-VARI =
                 ( 1 - ( WSS-SGV-IMPD IN WSS-VARI / 100 ))
           ELSE
              MOVE 1 TO WSS-SGV-IMPD IN WSS-VARI.

           GO TO FIN-PRO-OBT-TIMP.
       NXT-PRO-OBT-TIMP.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-OBT-TIMP.
       FIN-PRO-OBT-TIMP.
           EXIT.


       PRO-CAL-IMPU SECTION.
       INI-PRO-CAL-IMPU.
      *PVG INI 04-FEB-2015
           IF WSS-CCG-TIMP IN WSS-VARI = 'I'
              PERFORM PRO-CNV-IMPU
              GO TO CNT-PRO-CAL-IMPU.
      *PVG FIN 04-FEB-2015
           IF WSS-NUM-PZOM(WSS-NUM-PMC2) < WSS-NUM-PZIM IN WSS-VARI
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                   (((WSS-SGV-IMPP / 100) * WSS-SGV-IMPD ) *
                      WSS-NUM-PZOM(WSS-NUM-PMC2))
              COMPUTE WSS-VAL-IMPU IN WSS-VARI ROUNDED =
            (((WSS-SGV-CRED(WSS-NUM-PMC2) * WSS-SGV-IMPP / 100) *
                                            WSS-SGV-IMPD ) *
                                            WSS-NUM-PZOM(WSS-NUM-PMC2))
           ELSE
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                    ((WSS-SGV-IMPM / 100) * WSS-SGV-IMPD )
             COMPUTE WSS-VAL-IMPU IN WSS-VARI ROUNDED =
            ((WSS-SGV-CRED(WSS-NUM-PMC2) * WSS-SGV-IMPM / 100) *
                                           WSS-SGV-IMPD ).

           IF (WSS-MSC-TVOC IN WSS-VARI = '1')
              MOVE WSS-COD-VCOC IN WSS-VARI TO PES-CIC-VCAM IN PES-VARI
              MOVE WSS-VAL-IMPU IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-IMPU IN WSS-VARI.
           IF (WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI OR
               WSS-MSC-TVOC IN WSS-VARI = '0')
      *PVG INI 04-FEB-2015
              MOVE WSS-COD-VCOC IN WSS-VARI TO PES-CIC-VCAM IN PES-VARI
      *PVG FIN 04-FEB-2015
              MOVE WSS-VAL-IMPU IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-IMPU IN WSS-VARI.

      *PVG INI 04-FEB-2015
       CNT-PRO-CAL-IMPU.
      *PVG FIN 04-FEB-2015
           MOVE WSS-VAL-IMPU IN WSS-VARI TO
                WSS-SGV-MIMP(WSS-NUM-PMC2 IN WSS-VARI).
           ADD  WSS-SGV-FCTC IN WSS-VARI TO
                WSS-SGV-TFCT(WSS-NUM-PMC2 IN WSS-VARI).
       FIN-PRO-CAL-IMPU.
           EXIT.

      *PVG INI 04-FEB-2015
       PRO-CNV-IMPU SECTION.
       INI-PRO-CNV-IMPU.
      *VALOR DEL IMPUESTO INFORMADO SIEMPRE SERA EN PESOS
           MOVE FRM-COD-MIMP IN CCG-FLD TO WSS-COD-MIMP IN WSS-VARI.
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              MOVE FRM-VAL-IMPI IN CCG-FLD TO WSS-VAL-IMPU IN WSS-VARI
              GO TO CNT-PRO-CNV-IMPU.
      *ASUME MONEDA UF (VERSION BCI)
           COMPUTE WSS-VAL-IMPU IN WSS-VARI ROUNDED =
                  (FRM-VAL-IMPI IN CCG-FLD / WSS-SGV-VCAM IN WSS-VARI).

           MOVE WSS-VAL-IMPU IN WSS-VARI  TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI  TO WSS-VAL-IMPU IN WSS-VARI.
       CNT-PRO-CNV-IMPU.
           COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                 ((WSS-VAL-IMPU IN WSS-VARI /
                   WSS-SGV-CRED(WSS-NUM-PMC2)) * 1).
       FIN-PRO-CNV-IMPU.
           EXIT.
      *PVG FIN 04-FEB-2015

       PRO-BUS-TMC2 SECTION.
       INI-PRO-BUS-TMC2.
      *PVG INI 04-FEB-2015
           IF WSS-IND-NSGS IN WSS-VARI = 'N'
              GO TO CNT-PRO-BUS-TMC2.
      *PVG FIN 04-FEB-2015
      *----------------------------------------------------------------*
           MOVE 'SGS'                    TO RCC-COD-CPTO IN RCC-VARI.
           MOVE WSS-NUM-PZOD(1)          TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WSS-SGV-CRED(1)          TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE WSS-SGV-CRED(1)          TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-COD-TCAR IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-FINA IN RCC-VARI.
           PERFORM PRO-OBT-TRFA.
           IF CCG-COD-MENS IN CCG-VARI NOT > SPACES
              PERFORM LEE-RCC-CPTO.
           IF FIO-STAT-OKS
              MOVE 'S'                      TO WSS-IND-PSGS
              MOVE OSG-SGS-CIC-PLNT(1)      TO WSS-SGS-CIC-PLAN
              MOVE WSS-COD-SIST IN WSS-VARI TO WSS-SGS-COD-SIST
              MOVE 'CUR'                    TO WSS-SGS-COD-EVEN
              MOVE OSG-SGS-IND-TPLN(1)      TO WSS-SGS-IND-TPLT
              MOVE OSG-SGS-FEC-PLNT(1)      TO WSS-SGS-FEC-PLAN
              MOVE OSG-SGS-HRA-PLNT(1)      TO WSS-SGS-HRA-PLAN
              MOVE ZEROES                   TO WSS-SGS-NUM-ISGS.

      *----------------------------------------------------------------*
      *PVG INI 04-FEB-2015
       CNT-PRO-BUS-TMC2.
           IF WSS-IND-NCGN IN WSS-VARI = 'N'
              GO TO FIN-PRO-BUS-TMC2.
      *PVG FIN 04-FEB-2015

           MOVE 'CGN'                    TO RCC-COD-CPTO IN RCC-VARI.
           MOVE WSS-NUM-PZOD(1)          TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WSS-SGV-CRED(1)          TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE WSS-SGV-CRED(1)          TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-COD-TCAR IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-FINA IN RCC-VARI.
           PERFORM PRO-OBT-TRFA.
           IF CCG-COD-MENS IN CCG-VARI NOT > SPACES
              PERFORM LEE-RCC-CPTO.
           IF FIO-STAT-OKS
              MOVE 'S'                      TO WSS-IND-PCGN
              MOVE OSG-SGS-CIC-PLNT(1)      TO WSS-CGN-CIC-GNOT
              MOVE WSS-COD-SIST IN WSS-VARI TO WSS-CGN-COD-SIST
              MOVE 'CUR'                    TO WSS-CGN-COD-EVEN
              MOVE OSG-SGS-IND-TPLN(1)      TO WSS-CGN-IND-TPLT
              MOVE OSG-SGS-FEC-PLNT(1)      TO WSS-CGN-FEC-FINI
              MOVE OSG-SGS-HRA-PLNT(1)      TO WSS-CGN-HRA-HINI.
      *----------------------------------------------------------------*
       FIN-PRO-BUS-TMC2.
           EXIT.

       PRO-OBT-TRFA SECTION.
       INI-PRO-OBT-TRFA.
           MOVE 'CUR'                    TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WSS-NUM-DCUR IN WSS-VARI TO RCC-NUM-DCOL IN RCC-VARI.
           MOVE WSS-NUM-MCUR IN WSS-VARI TO RCC-NUM-MCOL IN RCC-VARI.
           MOVE WSS-NUM-SCUR IN WSS-VARI TO RCC-NUM-SCOL IN RCC-VARI.
           MOVE WSS-NUM-ACUR IN WSS-VARI TO RCC-NUM-ACOL IN RCC-VARI.
           MOVE 'CDC'                    TO RCC-COD-TCON IN RCC-VARI.

           MOVE SPACES                   TO RCC-CAI-IOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-IIC-IOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-EXT-IOPE IN RCC-VARI.

           MOVE DBC-NUM-ICLI IN CCG-FLD  TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE DBC-VRF-ICLI IN CCG-FLD  TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE DBC-IND-ICLI IN CCG-FLD  TO RCC-IND-ICLI IN RCC-VARI.
           MOVE DBC-GLS-ICLI IN CCG-FLD  TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE FRM-COD-TCNL IN CCG-FLD  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE FRM-COD-CNAL IN CCG-FLD  TO RCC-COD-CNAL IN RCC-VARI.

           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VCOC IN RCC-VARI.
           MOVE FRM-COD-TOOC IN CCG-FLD  TO RCC-COD-TOOC IN RCC-VARI.
           MOVE FRM-COD-AOOC IN CCG-FLD  TO RCC-COD-AOOC IN RCC-VARI.

           MOVE FRM-NUM-DVEN IN CCG-FLD  TO RCC-NUM-DVEN IN RCC-VARI.
           MOVE FRM-NUM-MVEN IN CCG-FLD  TO RCC-NUM-MVEN IN RCC-VARI.
           MOVE FRM-NUM-SVEN IN CCG-FLD  TO RCC-NUM-SVEN IN RCC-VARI.
           MOVE FRM-NUM-AVEN IN CCG-FLD  TO RCC-NUM-AVEN IN RCC-VARI.

           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VCMO IN RCC-VARI.
           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VSOP IN RCC-VARI.

           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VCFN IN RCC-VARI.
      *PVG INI 04-FEB-2015
      *    MOVE ZEROES                   TO RCC-VAL-INTE IN RCC-VARI.
      *MHM-INI 30-ABR-2018
      *    MOVE FRM-VAL-BALI IN CDC-FLD  TO RCC-VAL-INTE IN RCC-VARI.
           MOVE FRM-NUM-AVL1 IN CCG-FLD  TO RCC-VAL-INTE IN RCC-VARI.
      *MHM-FIN 30-ABR-2018
      *PVG FIN 04-FEB-2015
           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                   TO RCC-VAL-VASG IN RCC-VARI.
           MOVE FRM-COD-VCOC IN CCG-FLD  TO RCC-COD-VCVA IN RCC-VARI.

           MOVE SPACES                   TO RCC-IND-RTBL IN RCC-VARI.
           MOVE '000'                    TO RCC-IND-COMP IN RCC-VARI.
           MOVE SPACES                   TO RCC-COD-ESTR IN RCC-VARI.
           MOVE SPACES                   TO RCC-COD-AMRT IN RCC-VARI.

      *PVG INI 04-FEB-2015
           IF WSS-COD-TCNL IN WSS-VARI > SPACES
              MOVE WSS-COD-TCNL IN WSS-VARI TO RCC-COD-TCNL IN RCC-VARI.
      *PVG FIN 04-FEB-2015
      *     PERFORM TAB-LNK-RCC.
           PERFORM MC2-LNK-RCC.
           MOVE RCC-COD-MENS IN RCC-VARI TO CCG-COD-MENS.
           MOVE RCC-COD-MEN2 IN RCC-VARI TO CCG-COD-MEN2.
       FIN-PRO-OBT-TRFA.
           EXIT.

       PRO-PLT-TMC2 SECTION.
       INI-PRO-PLT-TMC2.
      *MHM-INI 03-MAY-2018 
      *VALIDA SEGUROS SELECCIONADOS INDIVIDUALES
           MOVE SPACES              TO WSS-IND-SGIN IN WSS-VARI.
           MOVE 'MC2'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'SGI'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-MGDM IN CCG-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
              MOVE 'S' TO WSS-IND-SGIN IN WSS-VARI.
      *MHM-FIN 03-MAY-2018
      *WSS-SGS-KEY-ISGS IN WSS-VARI
           MOVE SPACES TO WSS-COD-TSEGA IN WSS-VARI.
           MOVE ZEROES TO WSS-SGS IN WSS-VARI.

      *PVG INI 04-FEB-2015
           IF WSS-IND-PSGS IN WSS-VARI = 'N'
              GO TO FIN-PRO-PLT-TMC2-SGS.
      *PVG FIN 04-FEB-2015
           MOVE WSS-SGS-KEY-ISGS IN WSS-VARI TO SGS-KEY-ISGS IN SGS.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-PLT-TMC2-SGS.
      *PVG INI 27-ENE-2017
      *    PERFORM TAB-FIO-SGS.
           PERFORM MC2-FIO-SGS.
      *PVG FIN 27-ENE-2017
           IF NOT ( FIO-STAT-OKS AND
              SGS-CIC-PLAN IN SGS = WSS-SGS-CIC-PLAN IN WSS-VARI AND
              SGS-COD-SIST IN SGS = WSS-SGS-COD-SIST IN WSS-VARI AND
              SGS-COD-EVEN IN SGS = WSS-SGS-COD-EVEN IN WSS-VARI AND
              SGS-IND-TPLT IN SGS = WSS-SGS-IND-TPLT IN WSS-VARI AND
              SGS-FEC-PLAN IN SGS = WSS-SGS-FEC-PLAN IN WSS-VARI AND
              SGS-HRA-PLAN IN SGS = WSS-SGS-HRA-PLAN IN WSS-VARI )
              GO TO FIN-PRO-PLT-TMC2-SGS.

           IF SGS-COD-OCOB IN SGS NOT = 'FLT'
              GO TO NXT-PRO-PLT-TMC2-SGS.

      *PVG INI 04-FEB-2015
           IF WSS-INF-RROC IN WSS-VARI = 'S'
              PERFORM BUS-SGS-CPTO
              IF WSS-EXI-RROC IN WSS-VARI = 'N'
                 GO TO NXT-PRO-PLT-TMC2-SGS
              ELSE
                 GO TO CNT-PRO-PLT-TMC2-SGS.
      *PVG INI 04-FEB-2015
      *MHM-INI 03-MAY-2018 
           IF WSS-IND-SGIN IN WSS-VARI NOT = 'S'
               GO TO CN1-PRO-PLT-TMC2-SGS.

           IF SGS-COD-TSEG IN SGS = FRM-COD-SG01 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG02 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG03 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG04 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG05 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG06 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG07 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG08 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG09 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG10 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG11 IN CCG-FLD OR
              SGS-COD-TSEG IN SGS = FRM-COD-SG12 IN CCG-FLD
               GO TO CNT-PRO-PLT-TMC2-SGS
           ELSE
               GO TO NXT-PRO-PLT-TMC2-SGS.
       CN1-PRO-PLT-TMC2-SGS.
      *MHM-FIN 03-MAY-2018
           IF (WSS-IND-EST1 IN WSS-VARI > SPACES AND
               SGS-IND-SOBL IN SGS = WSS-IND-EST1 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-SGS.
           IF (WSS-IND-EST2 IN WSS-VARI > SPACES AND
               SGS-IND-SOBL IN SGS = WSS-IND-EST2 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-SGS.
           IF (WSS-IND-EST3 IN WSS-VARI > SPACES AND
               SGS-IND-SOBL IN SGS = WSS-IND-EST3 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-SGS.
           GO TO NXT-PRO-PLT-TMC2-SGS.
       CNT-PRO-PLT-TMC2-SGS.
           PERFORM PRO-LEE-TTSE.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-PLT-TMC2-SGS.
           IF WSS-IND-SELE IN WSS-VARI = 'N'
              GO TO NXT-PRO-PLT-TMC2-SGS.

           ADD 1 TO WSS-SGS.
           IF WSS-SGS IN WSS-VARI > WSS-MSGS IN WSS-VARI
              GO TO FIN-PRO-PLT-TMC2-SGS.
           MOVE SGS-COD-TSEG IN SGS TO CCG-SGS-COD-TSEG(WSS-SGS).

           MOVE SGS-NUM-PLZO IN SGS TO CCG-SGS-NUM-PLZO(WSS-SGS).
           MOVE SGS-IND-UTPZ IN SGS TO CCG-SGS-IND-UTPZ(WSS-SGS).
           IF CCG-SGS-NUM-PLZO(WSS-SGS) NOT > ZEROES
              MOVE 999              TO CCG-SGS-NUM-PLZO(WSS-SGS)
              MOVE 'M'              TO CCG-SGS-IND-UTPZ(WSS-SGS).

           MOVE SGS-NUM-EDAT IN SGS TO CCG-SGS-NUM-EDAT(WSS-SGS).
           MOVE SGS-IND-EDRA IN SGS TO CCG-SGS-IND-EDRA(WSS-SGS).
           IF CCG-SGS-NUM-EDAT(WSS-SGS) NOT > ZEROES
              MOVE 999              TO CCG-SGS-NUM-EDAT(WSS-SGS)
              MOVE 'T'              TO CCG-SGS-IND-EDRA(WSS-SGS).

           MOVE SGS-VAL-TOPE IN SGS TO CCG-SGS-VAL-TOPE(WSS-SGS).
           MOVE SGS-COD-VTOP IN SGS TO CCG-SGS-COD-VTOP(WSS-SGS).
           MOVE SGS-COD-CPTT IN SGS TO CCG-SGS-COD-CPTT(WSS-SGS).
           IF CCG-SGS-VAL-TOPE(WSS-SGS) NOT > ZEROES
              MOVE 99999999999      TO CCG-SGS-VAL-TOPE(WSS-SGS)
              MOVE WSS-COD-VCOC     TO CCG-SGS-COD-VTOP(WSS-SGS)
              MOVE 'CAP'            TO CCG-SGS-COD-CPTT(WSS-SGS)
           ELSE
           IF CCG-SGS-COD-VTOP(WSS-SGS) NOT = WSS-COD-VCOC IN WSS-VARI
              IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
                 COMPUTE CCG-SGS-VAL-TOPE(WSS-SGS) ROUNDED =
                 (CCG-SGS-VAL-TOPE(WSS-SGS) * WSS-SGV-VCAM IN WSS-VARI)
                 MOVE CCG-SGS-VAL-TOPE(WSS-SGS) TO
                                              PES-SGV-DECI IN PES-VARI
                 PERFORM PRO-AJS-MNTO
                 MOVE PES-SGV-ENTE IN PES-VARI TO
                                              CCG-SGS-VAL-TOPE(WSS-SGS)
              ELSE
                 COMPUTE CCG-SGS-VAL-TOPE(WSS-SGS) ROUNDED =
                 (CCG-SGS-VAL-TOPE(WSS-SGS) / WSS-SGV-VCAM IN WSS-VARI)
                 MOVE CCG-SGS-VAL-TOPE(WSS-SGS) TO
                                              PES-SGV-DECI IN PES-VARI
                 PERFORM PRO-AJS-MNTO
                 MOVE PES-SGV-ENTE IN PES-VARI TO
                                              CCG-SGS-VAL-TOPE(WSS-SGS).
      *----------------------------------------------------------------*
           MOVE SGS-COD-SEGU IN SGS TO CCG-SGS-COD-SEGU(WSS-SGS).
           MOVE SGS-SGV-TAMO IN SGS TO CCG-SGS-SGV-TAMO(WSS-SGS).
           MOVE SGS-COD-VCOC IN SGS TO CCG-SGS-COD-VCOC(WSS-SGS).
           MOVE SGS-COD-CPTO IN SGS TO CCG-SGS-COD-CPTO(WSS-SGS).
      *----------------------------------------------------------------*
       CNT-PRO-PLT-TMC2-SGS-MIN.
           IF SGS-VAL-VMIN IN SGS NOT > ZEROES
              GO TO CNT-PRO-PLT-TMC2-SGS-MAX.
           IF SGS-COD-VMYM IN SGS = WSS-COD-VCOC IN WSS-VARI
              MOVE SGS-VAL-VMIN IN SGS TO WSS-SGV-TMIN IN WSS-VARI
           ELSE
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              COMPUTE WSS-SGV-TMIN IN WSS-VARI ROUNDED =
                    ( SGS-VAL-VMIN IN SGS * WSS-SGV-VCAM IN WSS-VARI)
              MOVE WSS-SGV-TMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PRO-AJS-MNTO
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMIN IN WSS-VARI
           ELSE
              COMPUTE WSS-SGV-TMIN IN WSS-VARI ROUNDED =
                    ( SGS-VAL-VMIN IN SGS / WSS-SGV-VCAM IN WSS-VARI)
              MOVE WSS-SGV-TMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PRO-AJS-MNTO
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMIN IN WSS-VARI.

           IF CCG-SGS-MSC-TVOC(WSS-SGS) = 'P'
              COMPUTE WSS-SGV-VMIN IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMIN IN WSS-VARI /
                                   CCG-SGS-SGV-TAMO(WSS-SGS) * 100)
           ELSE
              COMPUTE WSS-SGV-VMIN IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMIN IN WSS-VARI /
                                   CCG-SGS-SGV-TAMO(WSS-SGS) * 1000).
           MOVE WSS-SGV-VMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-VMIN IN WSS-VARI.

           IF CCG-SGS-VAL-TOPE(WSS-SGS) > WSS-SGV-VMIN IN WSS-VARI
             MOVE WSS-SGS TO WSS-ASGS
             ADD 1        TO WSS-SGS
             MOVE CCG-VEC-PSGS(WSS-ASGS)   TO CCG-VEC-PSGS(WSS-SGS)

             MOVE WSS-SGV-VMIN IN WSS-VARI TO CCG-SGS-VAL-TOPE(WSS-ASGS)
             MOVE 'MFS'                    TO CCG-SGS-COD-SEGU(WSS-ASGS)
             MOVE WSS-SGV-TMIN IN WSS-VARI TO CCG-SGS-SGV-TAMO(WSS-ASGS)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-SGS-COD-VCOC(WSS-ASGS)
             MOVE SPACES                   TO CCG-SGS-COD-CPTO(WSS-ASGS)
           ELSE
           IF CCG-SGS-VAL-TOPE(WSS-SGS) < WSS-SGV-VMIN IN WSS-VARI
             MOVE 'MFS'                    TO CCG-SGS-COD-SEGU(WSS-SGS)
             MOVE WSS-SGV-TMIN IN WSS-VARI TO CCG-SGS-SGV-TAMO(WSS-SGS)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-SGS-COD-VCOC(WSS-SGS)
             MOVE SPACES                   TO CCG-SGS-COD-CPTO(WSS-SGS).
       CNT-PRO-PLT-TMC2-SGS-MAX.
           IF SGS-VAL-VMAX IN SGS NOT > ZEROES
              GO TO NXT-PRO-PLT-TMC2-SGS.

           IF SGS-COD-VMYM IN SGS = WSS-COD-VCOC IN WSS-VARI
              MOVE SGS-VAL-VMAX IN SGS TO WSS-SGV-TMAX IN WSS-VARI
           ELSE
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
             COMPUTE WSS-SGV-TMAX IN WSS-VARI ROUNDED =
                   ( SGS-VAL-VMAX IN SGS * WSS-SGV-VCAM IN WSS-VARI)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
             PERFORM PRO-AJS-MNTO
             MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMAX IN WSS-VARI
           ELSE
             COMPUTE WSS-SGV-TMAX IN WSS-VARI ROUNDED =
                   ( SGS-VAL-VMAX IN SGS / WSS-SGV-VCAM IN WSS-VARI)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
             PERFORM PRO-AJS-MNTO
             MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMAX IN WSS-VARI.

           IF CCG-SGS-MSC-TVOC(WSS-SGS) = 'P'
              COMPUTE WSS-SGV-VMAX IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMAX IN WSS-VARI /
                                   CCG-SGS-SGV-TAMO(WSS-SGS) * 100)
           ELSE
              COMPUTE WSS-SGV-VMAX IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMAX IN WSS-VARI /
                                   CCG-SGS-SGV-TAMO(WSS-SGS) * 1000).

           MOVE WSS-SGV-VMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-VMAX IN WSS-VARI.

           IF CCG-SGS-VAL-TOPE(WSS-SGS) > WSS-SGV-VMAX IN WSS-VARI
             MOVE WSS-SGS TO WSS-ASGS
             ADD 1        TO WSS-SGS
             MOVE CCG-VEC-PSGS(WSS-ASGS)   TO CCG-VEC-PSGS(WSS-SGS)

             MOVE WSS-SGV-VMAX IN WSS-VARI TO CCG-SGS-VAL-TOPE(WSS-ASGS)
             MOVE 'MFS'                    TO CCG-SGS-COD-SEGU(WSS-SGS)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO CCG-SGS-SGV-TAMO(WSS-SGS)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-SGS-COD-VCOC(WSS-SGS)
             MOVE SPACES                   TO CCG-SGS-COD-CPTO(WSS-SGS)
           ELSE
           IF CCG-SGS-VAL-TOPE(WSS-SGS) < WSS-SGV-VMAX IN WSS-VARI
             MOVE WSS-SGS TO WSS-ASGS
             ADD 1        TO WSS-SGS
             MOVE CCG-VEC-PSGS(WSS-ASGS)   TO CCG-VEC-PSGS(WSS-SGS)
             MOVE WSS-SGV-VMAX IN WSS-VARI TO CCG-SGS-VAL-TOPE(WSS-SGS).
       NXT-PRO-PLT-TMC2-SGS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-PLT-TMC2-SGS.
       FIN-PRO-PLT-TMC2-SGS.
           MOVE ZEROES TO WSS-CGN IN WSS-VARI.

      *PVG INI 04-FEB-2015
           IF WSS-IND-PCGN IN WSS-VARI = 'N'
              GO TO FIN-PRO-PLT-TMC2-CGN.
      *PVG FIN 04-FEB-2015
           MOVE WSS-CGN-KEY-ICGN IN WSS-VARI TO CGN-KEY-ICGN IN CGN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-CGN.
           IF NOT (FIO-STAT-OKS AND
                   CGN-KEY-ICGN IN CGN = WSS-CGN-KEY-ICGN IN WSS-VARI)
              GO TO FIN-PRO-PLT-TMC2-CGN.

           MOVE CGN-CIC-ICGN IN CGN TO DGN-CIC-IDGN IN DGN.
           MOVE ZEROES           TO DGN-NUM-IDGN IN DGN
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-PLT-TMC2-CGN.
           PERFORM MC2-FIO-DGN.
           IF NOT (FIO-STAT-OKS AND
                   DGN-CIC-IDGN IN DGN = CGN-CIC-ICGN IN CGN)
              GO TO FIN-PRO-PLT-TMC2-CGN.

           IF DGN-COD-OCOB IN DGN NOT = 'FLT'
              GO TO NXT-PRO-PLT-TMC2-CGN.

      *PVG INI 04-FEB-2015
           IF WSS-INF-RROC IN WSS-VARI = 'S'
              PERFORM BUS-CGN-CPTO
              IF WSS-EXI-RROC IN WSS-VARI = 'N'
                 GO TO NXT-PRO-PLT-TMC2-CGN
              ELSE
                 GO TO CNT-PRO-PLT-TMC2-CGN.
      *PVG INI 04-FEB-2015
           IF (WSS-IND-EGT1 IN WSS-VARI > SPACES AND
               DGN-IND-COBL IN DGN = WSS-IND-EGT1 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-CGN.
           IF (WSS-IND-EGT2 IN WSS-VARI > SPACES AND
               DGN-IND-COBL IN DGN = WSS-IND-EGT2 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-CGN.
           IF (WSS-IND-EGT3 IN WSS-VARI > SPACES AND
               DGN-IND-COBL IN DGN = WSS-IND-EGT3 IN WSS-VARI)
               GO TO CNT-PRO-PLT-TMC2-CGN.

           GO TO NXT-PRO-PLT-TMC2-CGN.
       CNT-PRO-PLT-TMC2-CGN.
           ADD 1 TO WSS-CGN.
           IF WSS-CGN IN WSS-VARI > WSS-MCGN IN WSS-VARI
              GO TO FIN-PRO-PLT-TMC2-CGN.
           MOVE DGN-COD-TDOC IN DGN TO CCG-DGN-COD-TDOC(WSS-CGN).

           MOVE DGN-NUM-PTOP IN DGN TO CCG-DGN-NUM-PTOP(WSS-CGN).
           MOVE DGN-IND-UTPT IN DGN TO CCG-DGN-IND-UTPT(WSS-CGN).
           IF CCG-DGN-NUM-PTOP(WSS-CGN) NOT > ZEROES
              MOVE 999              TO CCG-DGN-NUM-PTOP(WSS-CGN)
              MOVE 'M'              TO CCG-DGN-IND-UTPT(WSS-CGN).

           MOVE DGN-VAL-MTOP IN DGN TO CCG-DGN-VAL-MTOP(WSS-CGN).
           MOVE DGN-COD-VCMT IN DGN TO CCG-DGN-COD-VCMT(WSS-CGN).
           MOVE DGN-COD-CPMT IN DGN TO CCG-DGN-COD-CPMT(WSS-CGN).
           IF CCG-DGN-VAL-MTOP(WSS-CGN) NOT > ZEROES
              MOVE 99999999999      TO CCG-DGN-VAL-MTOP(WSS-CGN)
              MOVE WSS-COD-VCOC     TO CCG-DGN-COD-VCMT(WSS-CGN)
              MOVE 'CAP'            TO CCG-DGN-COD-CPMT(WSS-CGN)
           ELSE
           IF CCG-DGN-COD-VCMT(WSS-CGN) NOT = WSS-COD-VCOC IN WSS-VARI
              IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
                 COMPUTE CCG-DGN-VAL-MTOP(WSS-CGN) ROUNDED =
                 (CCG-DGN-VAL-MTOP(WSS-CGN) * WSS-SGV-VCAM IN WSS-VARI)
                 MOVE CCG-DGN-VAL-MTOP(WSS-CGN) TO
                                              PES-SGV-DECI IN PES-VARI
                 PERFORM PRO-AJS-MNTO
                 MOVE PES-SGV-ENTE IN PES-VARI TO
                                              CCG-DGN-VAL-MTOP(WSS-CGN)
              ELSE
                 COMPUTE CCG-DGN-VAL-MTOP(WSS-CGN) ROUNDED =
                 (CCG-DGN-VAL-MTOP(WSS-CGN) / WSS-SGV-VCAM IN WSS-VARI)
                 MOVE CCG-DGN-VAL-MTOP(WSS-CGN) TO
                                              PES-SGV-DECI IN PES-VARI
                 PERFORM PRO-AJS-MNTO
                 MOVE PES-SGV-ENTE IN PES-VARI TO
                                              CCG-DGN-VAL-MTOP(WSS-CGN).
      *----------------------------------------------------------------*
           MOVE DGN-COD-EDOC IN DGN TO CCG-DGN-COD-EDOC(WSS-CGN).
           MOVE DGN-SGV-TMBA IN DGN TO CCG-DGN-SGV-TMBA(WSS-CGN).
           MOVE DGN-COD-VCBA IN DGN TO CCG-DGN-COD-VCBA(WSS-CGN).
           MOVE DGN-COD-CPBA IN DGN TO CCG-DGN-COD-CPBA(WSS-CGN).
           MOVE DGN-IND-MIVA IN DGN TO CCG-DGN-IND-MIVA(WSS-CGN).
      *----------------------------------------------------------------*
       CNT-PRO-PLT-TMC2-CGN-MIN.
           IF DGN-VAL-VMIN IN DGN NOT > ZEROES
              GO TO CNT-PRO-PLT-TMC2-CGN-MAX.
           IF DGN-COD-VMYM IN DGN = WSS-COD-VCOC IN WSS-VARI
              MOVE DGN-VAL-VMIN IN DGN TO WSS-SGV-TMIN IN WSS-VARI
           ELSE
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
              COMPUTE WSS-SGV-TMIN IN WSS-VARI ROUNDED =
                    ( DGN-VAL-VMIN IN DGN * WSS-SGV-VCAM IN WSS-VARI)
              MOVE WSS-SGV-TMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PRO-AJS-MNTO
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMIN IN WSS-VARI
           ELSE
              COMPUTE WSS-SGV-TMIN IN WSS-VARI ROUNDED =
                    ( DGN-VAL-VMIN IN DGN / WSS-SGV-VCAM IN WSS-VARI)
              MOVE WSS-SGV-TMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
              PERFORM PRO-AJS-MNTO
              MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMIN IN WSS-VARI.

           IF CCG-DGN-MSC-TVBA(WSS-CGN) = 'P'
              COMPUTE WSS-SGV-VMIN IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMIN IN WSS-VARI /
                                   CCG-DGN-SGV-TMBA(WSS-CGN) * 100)
           ELSE
              COMPUTE WSS-SGV-VMIN IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMIN IN WSS-VARI /
                                   CCG-DGN-SGV-TMBA(WSS-CGN) * 1000).
           MOVE WSS-SGV-VMIN IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-VMIN IN WSS-VARI.

           IF CCG-DGN-VAL-MTOP(WSS-CGN) > WSS-SGV-VMIN IN WSS-VARI
             MOVE WSS-CGN TO WSS-ACGN
             ADD 1        TO WSS-CGN
             MOVE CCG-VEC-PDGN(WSS-ACGN)   TO CCG-VEC-PDGN(WSS-CGN)

             MOVE WSS-SGV-VMIN IN WSS-VARI TO CCG-DGN-VAL-MTOP(WSS-ACGN)
             MOVE 'MFI'                    TO CCG-DGN-COD-EDOC(WSS-ACGN)
             MOVE WSS-SGV-TMIN IN WSS-VARI TO CCG-DGN-SGV-TMBA(WSS-ACGN)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-DGN-COD-VCBA(WSS-ACGN)
             MOVE SPACES                   TO CCG-DGN-COD-CPBA(WSS-ACGN)
           ELSE
           IF CCG-DGN-VAL-MTOP(WSS-CGN) < WSS-SGV-VMIN IN WSS-VARI
             MOVE 'MFI'                    TO CCG-DGN-COD-EDOC(WSS-CGN)
             MOVE WSS-SGV-TMIN IN WSS-VARI TO CCG-DGN-SGV-TMBA(WSS-CGN)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-DGN-COD-VCBA(WSS-CGN)
             MOVE SPACES                   TO CCG-DGN-COD-CPBA(WSS-CGN).

       CNT-PRO-PLT-TMC2-CGN-MAX.
           IF DGN-VAL-VMAX IN DGN NOT > ZEROES
              GO TO NXT-PRO-PLT-TMC2-CGN.

           IF DGN-COD-VMYM IN DGN = WSS-COD-VCOC IN WSS-VARI
              MOVE DGN-VAL-VMAX IN DGN TO WSS-SGV-TMAX IN WSS-VARI
           ELSE
           IF WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI
             COMPUTE WSS-SGV-TMAX IN WSS-VARI ROUNDED =
                   ( DGN-VAL-VMAX IN DGN * WSS-SGV-VCAM IN WSS-VARI)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
             PERFORM PRO-AJS-MNTO
             MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMAX IN WSS-VARI
           ELSE
             COMPUTE WSS-SGV-TMAX IN WSS-VARI ROUNDED =
                   ( DGN-VAL-VMAX IN DGN / WSS-SGV-VCAM IN WSS-VARI)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
             PERFORM PRO-AJS-MNTO
             MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TMAX IN WSS-VARI.

           IF CCG-DGN-MSC-TVBA(WSS-CGN) = 'P'
              COMPUTE WSS-SGV-VMAX IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMAX IN WSS-VARI /
                                   CCG-DGN-SGV-TMBA(WSS-CGN) * 100)
           ELSE
              COMPUTE WSS-SGV-VMAX IN WSS-VARI ROUNDED =
                    ( WSS-SGV-TMAX IN WSS-VARI /
                                   CCG-DGN-SGV-TMBA(WSS-CGN) * 1000).

           MOVE WSS-SGV-VMAX IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-VMAX IN WSS-VARI.

           IF CCG-DGN-VAL-MTOP(WSS-CGN) > WSS-SGV-VMAX IN WSS-VARI
             MOVE WSS-CGN TO WSS-ACGN
             ADD 1        TO WSS-CGN
             MOVE CCG-VEC-PDGN(WSS-ACGN)   TO CCG-VEC-PDGN(WSS-CGN)

             MOVE WSS-SGV-VMAX IN WSS-VARI TO CCG-DGN-VAL-MTOP(WSS-ACGN)
             MOVE 'MFI'                    TO CCG-DGN-COD-EDOC(WSS-CGN)
             MOVE WSS-SGV-TMAX IN WSS-VARI TO CCG-DGN-SGV-TMBA(WSS-CGN)
             MOVE WSS-COD-VCOC IN WSS-VARI TO CCG-DGN-COD-VCBA(WSS-CGN)
             MOVE SPACES                   TO CCG-DGN-COD-CPBA(WSS-CGN)
           ELSE
           IF CCG-DGN-VAL-MTOP(WSS-CGN) < WSS-SGV-VMAX IN WSS-VARI
             MOVE WSS-CGN TO WSS-ACGN
             ADD 1        TO WSS-CGN
             MOVE CCG-VEC-PDGN(WSS-ACGN)   TO CCG-VEC-PDGN(WSS-CGN)
             MOVE WSS-SGV-VMAX IN WSS-VARI TO CCG-DGN-VAL-MTOP(WSS-CGN).
       NXT-PRO-PLT-TMC2-CGN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-PLT-TMC2-CGN.
       FIN-PRO-PLT-TMC2-CGN.
           EXIT.

       PRO-CAL-PMC2 SECTION.
       INI-PRO-CAL-PMC2.
           MOVE ZEROES TO WSS-NUM-PMC2.
       LUP-PRO-CAL-PMC2.
           ADD 1 TO WSS-NUM-PMC2.
           IF WSS-NUM-PMC2 > WSS-NUM-MMC2
              GO TO FIN-PRO-CAL-PMC2.
           IF WSS-SGV-CRED(WSS-NUM-PMC2) NOT > ZEROES
              GO TO FIN-PRO-CAL-PMC2.

       CNT-PRO-CAL-PMC2-RCAL.
      *----------------------------------------------------------------*
      *    Impuestos
           PERFORM PRO-CAL-IMPU.
      *----------------------------------------------------------------*
      *    Seguros
           PERFORM PRO-VAL-PSGS.
      *----------------------------------------------------------------*
      *    Gastos
           PERFORM PRO-VAL-PCGN.
      *----------------------------------------------------------------*
      *    Valores Finales
           PERFORM PRO-VAL-PCRE.
      *----------------------------------------------------------------*
       NXT-PRO-CAL-PMC2.
           GO TO LUP-PRO-CAL-PMC2.
       FIN-PRO-CAL-PMC2.
           EXIT.

       PRO-AJS-MNTO SECTION.
       INI-PRO-AJS-MNTO.
           IF (WSS-MSC-TVOC IN WSS-VARI = '1')
              MOVE WSS-COD-VCOC IN WSS-VARI TO PES-CIC-VCAM IN PES-VARI
              PERFORM PES-SCTV.
           IF (WSS-COD-VCOC IN WSS-VARI = WSS-COD-PESO IN WSS-VARI OR
               WSS-MSC-TVOC IN WSS-VARI = '0')
      *PVG INI 04-FEB-2015
              MOVE WSS-COD-VCOC IN WSS-VARI TO PES-CIC-VCAM IN PES-VARI
      *PVG FIN 04-FEB-2015
              PERFORM PES-SCTV.
       FIN-PRO-AJS-MNTO.
           EXIT.

       PRO-OBT-UEFE-IVA SECTION.
       INI-PRO-OBT-UEFE-IVA.
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE WSS-FEC-FCUR IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
                                            CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF ( NOT FIO-STAT-OKS ) OR
              ( CAM-MSC-STAT IN CAM NOT = 'S' )
               MOVE 'CAM    NEX'        TO CCG-COD-MENS IN CCG-VARI
               GO TO EXT-PRO-OBT-UEFE-IVA.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM IN WSS-VARI.
       EXT-PRO-OBT-UEFE-IVA.
            MOVE ZEROES              TO WSS-VAL-MIVA.
            MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.
            MOVE 'IVA'               TO TAB-COD-TTAB IN TAB.
            MOVE SPACES              TO TAB-COD-CTAB IN TAB.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
              MOVE TAB-GLS-DAT1 IN TAB TO WSS-VAL-MIVA-ALF IN WSS-VARI
            ELSE
              MOVE ZEROES              TO WSS-VAL-MIVA     IN WSS-VARI.

       FIN-PRO-OBT-UEFE-IVA.
           EXIT.

      *----------------------------------------------------------------*
      *>>>>

       PRO-VAL-PSGS SECTION.
       INI-PRO-VAL-PSGS.
           MOVE SPACES TO WSS-IND-SGSC IN WSS-VARI.
           MOVE ZEROES TO WSS-SGS.
       LUP-PRO-VAL-PSGS.
           ADD 1 TO WSS-SGS.
           IF WSS-SGS > WSS-MSGS
              GO TO FIN-PRO-VAL-PSGS.
           IF CCG-SGS-COD-TSEG(WSS-SGS) NOT > SPACES
              GO TO FIN-PRO-VAL-PSGS.

           IF CCG-SGS-COD-TSEG(WSS-SGS) = WSS-IND-SGSC
              GO TO NXT-PRO-VAL-PSGS.

           IF CCG-SGS-IND-UTPZ(WSS-SGS) = 'M'
              IF WSS-NUM-PZOM(WSS-NUM-PMC2) > CCG-SGS-NUM-PLZO(WSS-SGS)
                 GO TO NXT-PRO-VAL-PSGS.
           IF CCG-SGS-IND-UTPZ(WSS-SGS) = 'D'
              IF WSS-NUM-PZOD(WSS-NUM-PMC2) > CCG-SGS-NUM-PLZO(WSS-SGS)
                 GO TO NXT-PRO-VAL-PSGS.
           IF CCG-SGS-IND-UTPZ(WSS-SGS) = 'A'
              IF WSS-NUM-PZOA(WSS-NUM-PMC2) > CCG-SGS-NUM-PLZO(WSS-SGS)
                 GO TO NXT-PRO-VAL-PSGS.

           IF CCG-SGS-IND-EDRA(WSS-SGS) = 'T'
              IF WSS-NUM-EDAD(WSS-NUM-PMC2) > CCG-SGS-NUM-EDAT(WSS-SGS)
                 GO TO NXT-PRO-VAL-PSGS.

           IF WSS-SGV-CRED(WSS-NUM-PMC2) > CCG-SGS-VAL-TOPE(WSS-SGS)
              GO TO NXT-PRO-VAL-PSGS.

      *----------------------------------------------------------------*
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'CSP'
              PERFORM CCG-CAL-MNTO-CSP
           ELSE
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'MFS'
              IF CCG-SGS-COD-VCOC(WSS-SGS) NOT = WSS-COD-VCOC
                 IF WSS-COD-VCOC = WSS-COD-PESO IN WSS-VARI
                    MULTIPLY CCG-SGS-SGV-TAMO(WSS-SGS)
                          BY WSS-SGV-VCAM IN WSS-VARI
                      GIVING WSS-VAL-SGS-MNTO IN WSS-VARI

                    ADD  WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                            WSS-SGV-TMFJ(WSS-NUM-PMC2)
                    MOVE WSS-VAL-SGS-MNTO IN WSS-VARI TO
                             PES-SGV-DECI IN PES-VARI
                    PERFORM PRO-AJS-MNTO
                    MOVE PES-SGV-ENTE IN PES-VARI  TO
                     WSS-VAL-SGS-MNTO IN WSS-VARI

                    ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                            WSS-SGV-MSEG(WSS-NUM-PMC2)
                 ELSE
                    DIVIDE CCG-SGS-SGV-TAMO(WSS-SGS)
                        BY WSS-SGV-VCAM IN WSS-VARI
                    GIVING WSS-VAL-SGS-MNTO IN WSS-VARI

                    ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                            WSS-SGV-TMFJ(WSS-NUM-PMC2)
                    MOVE WSS-VAL-SGS-MNTO IN WSS-VARI TO
                             PES-SGV-DECI IN PES-VARI
                    PERFORM PRO-AJS-MNTO
                    MOVE PES-SGV-ENTE IN PES-VARI  TO
                     WSS-VAL-SGS-MNTO IN WSS-VARI

                    ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                            WSS-SGV-MSEG(WSS-NUM-PMC2)
              ELSE
                  MOVE CCG-SGS-SGV-TAMO(WSS-SGS) TO
                                          WSS-VAL-SGS-MNTO IN WSS-VARI
                  ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                          WSS-SGV-TMFJ(WSS-NUM-PMC2)
                  ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                          WSS-SGV-MSEG(WSS-NUM-PMC2)
           ELSE
           IF (CCG-SGS-COD-SEGU(WSS-SGS) = 'FXM' OR 'FXA' OR 'FXD')
              PERFORM CCG-CAL-MNTO-FXP
           ELSE
           IF (CCG-SGS-COD-SEGU(WSS-SGS) = 'MXM' OR 'MXA' OR 'MXD')
              PERFORM CCG-CAL-MNTO-MXP
           ELSE
               MOVE ZEROES TO WSS-VAL-SGS-MNTO IN WSS-VARI.

           MOVE CCG-SGS-COD-TSEG(WSS-SGS) TO WSS-IND-SGSC IN WSS-VARI.
      *----------------------------------------------------------------*
       NXT-PRO-VAL-PSGS.
           GO TO LUP-PRO-VAL-PSGS.
       FIN-PRO-VAL-PSGS.
           EXIT.

       CCG-CAL-MNTO-CSP SECTION.
       INI-CCG-CAL-MNTO-CSP.
           IF CCG-SGS-MSC-TVOC(WSS-SGS) = 'P'
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (CCG-SGS-SGV-TAMO(WSS-SGS) / 100)
              COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                  CCG-SGS-SGV-TAMO(WSS-SGS) / 100
           ELSE
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (CCG-SGS-SGV-TAMO(WSS-SGS) / 1000)
              COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                      CCG-SGS-SGV-TAMO(WSS-SGS) / 1000.
           MOVE WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                           PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO.
           MOVE PES-SGV-ENTE IN PES-VARI  TO
                                       WSS-VAL-SGS-MNTO IN WSS-VARI.

           ADD WSS-SGV-FCTC IN WSS-VARI     TO
               WSS-SGV-TFCT(WSS-NUM-PMC2).

           ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                   WSS-SGV-MSEG(WSS-NUM-PMC2).
       FIN-CCG-CAL-MNTO-CSP.
           EXIT.

       CCG-CAL-MNTO-FXP SECTION.
       INI-CCG-CAL-MNTO-FXP.
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'FXD'
             COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOD(WSS-NUM-PMC2)
           ELSE
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'FXM'
             COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOM(WSS-NUM-PMC2)
           ELSE
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'FXA'
             COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOA(WSS-NUM-PMC2).

           IF CCG-SGS-MSC-TVOC(WSS-SGS) = 'P'
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (WSS-SGV-FCTC IN WSS-VARI / 100)
              COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                  WSS-SGV-FCTC IN WSS-VARI
           ELSE
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (WSS-SGV-FCTC IN WSS-VARI / 1000)
              COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                  WSS-SGV-FCTC IN WSS-VARI.

           MOVE WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                           PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO.
           MOVE PES-SGV-ENTE IN PES-VARI  TO
                                       WSS-VAL-SGS-MNTO IN WSS-VARI.

           ADD WSS-SGV-FCTC IN WSS-VARI     TO
               WSS-SGV-TFCT(WSS-NUM-PMC2).
           ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
               WSS-SGV-MSEG(WSS-NUM-PMC2).
       FIN-CCG-CAL-MNTO-FXP.
           EXIT.

       CCG-CAL-MNTO-MXP SECTION.
       INI-CCG-CAL-MNTO-MXP.
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'MXD'
             COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOD(WSS-NUM-PMC2)
           ELSE
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'MXM'
             COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOM(WSS-NUM-PMC2)
           ELSE
           IF CCG-SGS-COD-SEGU(WSS-SGS) = 'MXA'
             COMPUTE WSS-VAL-SGS-MNTO IN WSS-VARI ROUNDED =
                     CCG-SGS-SGV-TAMO(WSS-SGS) *
                         WSS-NUM-PZOA(WSS-NUM-PMC2).

           IF CCG-SGS-COD-VCOC(WSS-SGS) NOT = WSS-COD-VCOC
              IF WSS-COD-VCOC = WSS-COD-PESO IN WSS-VARI
                 MULTIPLY WSS-VAL-SGS-MNTO IN WSS-VARI
                       BY WSS-SGV-VCAM IN WSS-VARI
                   GIVING WSS-VAL-SGS-MNTO IN WSS-VARI
              ELSE
                 DIVIDE WSS-VAL-SGS-MNTO IN WSS-VARI
                     BY WSS-SGV-VCAM IN WSS-VARI
                 GIVING WSS-VAL-SGS-MNTO IN WSS-VARI.

           ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
                                            WSS-SGV-TMFJ(WSS-NUM-PMC2).
           MOVE WSS-VAL-SGS-MNTO IN WSS-VARI TO
                    PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO.
           MOVE PES-SGV-ENTE IN PES-VARI  TO
            WSS-VAL-SGS-MNTO IN WSS-VARI.

           ADD WSS-VAL-SGS-MNTO IN WSS-VARI TO
               WSS-SGV-MSEG(WSS-NUM-PMC2).
       FIN-CCG-CAL-MNTO-MXP.
           EXIT.


       PRO-LEE-TTSE SECTION.
       INI-PRO-LEE-TTSE.
           IF SGS-COD-TSEG IN SGS = WSS-COD-TSEGA IN WSS-VARI
              GO TO FIN-PRO-LEE-TTSE.

           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'TSE'               TO TAB-COD-TTAB IN TAB.
           MOVE SGS-COD-TSEG IN SGS TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              MOVE 'ERRPARTABTSE' TO CCG-COD-MENS IN CCG-VARI
              GO TO FIN-PRO-LEE-TTSE.

           MOVE 'N'                 TO WSS-IND-SELE IN WSS-VARI.
           MOVE SGS-COD-TSEG IN SGS TO WSS-COD-TSEGA IN WSS-VARI.


      *PVG INI 04-FEB-2015
           IF FRM-VAL-BALI IN CCG-FLD NOT > ZEROES
               GO TO CNT-PRO-LEE-TTSE.
           IF ((TAB-COD-DAT1 IN TAB(1) = SPACES OR
               (TAB-COD-DAT1 IN TAB(1) = WSS-IND-TICL IN WSS-VARI)) AND
               (TAB-COD-DAT1 IN TAB(2) = SPACES OR
                TAB-COD-DAT1 IN TAB(2) = 'D' OR 'I'))
               MOVE 'S' TO WSS-IND-SELE IN WSS-VARI.
           GO TO FIN-PRO-LEE-TTSE.
       CNT-PRO-LEE-TTSE.
      *PVG FIN 04-FEB-2015
           IF ((TAB-COD-DAT1 IN TAB(1) = SPACES OR
               (TAB-COD-DAT1 IN TAB(1) = WSS-IND-TICL IN WSS-VARI)) AND
               (TAB-COD-DAT1 IN TAB(2) = SPACES OR
                TAB-COD-DAT1 IN TAB(2) = 'D'))
               MOVE 'S' TO WSS-IND-SELE IN WSS-VARI.
       FIN-PRO-LEE-TTSE.
           EXIT.

       PRO-VAL-PCGN SECTION.
       INI-PRO-VAL-PCGN.
           MOVE SPACES TO WSS-IND-CGNC IN WSS-VARI.
           MOVE ZEROES TO WSS-CGN.
       LUP-PRO-VAL-PCGN.
           ADD 1 TO WSS-CGN.
           IF WSS-CGN > WSS-MCGN
              GO TO FIN-PRO-VAL-PCGN.

           IF CCG-DGN-COD-TDOC(WSS-CGN) NOT > SPACES
              GO TO FIN-PRO-VAL-PCGN.

           IF CCG-DGN-COD-TDOC(WSS-CGN) = WSS-IND-CGNC
              GO TO NXT-PRO-VAL-PCGN.

           IF CCG-DGN-IND-UTPT(WSS-CGN) = 'M'
              IF WSS-NUM-PZOM(WSS-NUM-PMC2) > CCG-DGN-NUM-PTOP(WSS-CGN)
                 GO TO NXT-PRO-VAL-PCGN.
           IF CCG-DGN-IND-UTPT(WSS-CGN) = 'D'
              IF WSS-NUM-PZOD(WSS-NUM-PMC2) > CCG-DGN-NUM-PTOP(WSS-CGN)
                 GO TO NXT-PRO-VAL-PCGN.
           IF CCG-DGN-IND-UTPT(WSS-CGN) = 'A'
              IF WSS-NUM-PZOA(WSS-NUM-PMC2) > CCG-DGN-NUM-PTOP(WSS-CGN)
                 GO TO NXT-PRO-VAL-PCGN.

           IF WSS-SGV-CRED(WSS-NUM-PMC2) > CCG-DGN-VAL-MTOP(WSS-CGN)
              GO TO NXT-PRO-VAL-PCGN.

      *----------------------------------------------------------------*
           IF CCG-DGN-COD-EDOC(WSS-CGN) = 'INF'
              MOVE ZEROES TO WSS-VAL-CGN-MNTO
           ELSE
           IF CCG-DGN-COD-EDOC(WSS-CGN) = 'FAC'
              PERFORM CCG-CAL-MNTO-FAC
           ELSE
           IF CCG-DGN-COD-EDOC(WSS-CGN) = 'MFI'
              IF CCG-DGN-COD-VCBA(WSS-CGN) NOT = WSS-COD-VCOC
                 IF WSS-COD-VCOC = WSS-COD-PESO IN WSS-VARI
                    MULTIPLY CCG-DGN-SGV-TMBA(WSS-CGN)
                          BY WSS-SGV-VCAM IN WSS-VARI
                      GIVING WSS-VAL-CGN-MNTO IN WSS-VARI

                    PERFORM PRO-SUM-MIVA
                    ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                            WSS-SGV-TMFJ(WSS-NUM-PMC2)
                    MOVE WSS-VAL-CGN-MNTO IN WSS-VARI TO
                             PES-SGV-DECI IN PES-VARI
                    PERFORM PRO-AJS-MNTO
                    MOVE PES-SGV-ENTE IN PES-VARI  TO
                     WSS-VAL-CGN-MNTO IN WSS-VARI

                    ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                            WSS-SGV-MGAS(WSS-NUM-PMC2)
                 ELSE
                    DIVIDE CCG-DGN-SGV-TMBA(WSS-CGN)
                        BY WSS-SGV-VCAM IN WSS-VARI
                    GIVING WSS-VAL-CGN-MNTO IN WSS-VARI

                    PERFORM PRO-SUM-MIVA
                    ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                            WSS-SGV-TMFJ(WSS-NUM-PMC2)
                    MOVE WSS-VAL-CGN-MNTO IN WSS-VARI TO
                             PES-SGV-DECI IN PES-VARI
                    PERFORM PRO-AJS-MNTO
                    MOVE PES-SGV-ENTE IN PES-VARI  TO
                     WSS-VAL-CGN-MNTO IN WSS-VARI

                    ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                            WSS-SGV-MGAS(WSS-NUM-PMC2)
              ELSE
                  MOVE CCG-DGN-SGV-TMBA(WSS-CGN) TO
                                          WSS-VAL-CGN-MNTO IN WSS-VARI
                  PERFORM PRO-SUM-MIVA
                  ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                          WSS-SGV-TMFJ(WSS-NUM-PMC2)
                  ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                                          WSS-SGV-MGAS(WSS-NUM-PMC2)
           ELSE
              MOVE ZEROES TO WSS-VAL-CGN-MNTO IN WSS-VARI.

           MOVE CCG-DGN-COD-TDOC(WSS-CGN) TO WSS-IND-SGSC IN WSS-VARI.
       NXT-PRO-VAL-PCGN.
           GO TO LUP-PRO-VAL-PCGN.
       FIN-PRO-VAL-PCGN.
           EXIT.


       CCG-CAL-MNTO-FAC SECTION.
       INI-CCG-CAL-MNTO-FAC.
           IF CCG-DGN-COD-VCBA(WSS-CGN) = 'P'
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (CCG-DGN-SGV-TMBA(WSS-CGN) / 100)
              COMPUTE WSS-VAL-CGN-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                  CCG-DGN-SGV-TMBA(WSS-CGN) / 100
           ELSE
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                                (CCG-DGN-SGV-TMBA(WSS-CGN) / 1000)
              COMPUTE WSS-VAL-CGN-MNTO IN WSS-VARI ROUNDED =
                      WSS-SGV-CRED(WSS-NUM-PMC2) *
                      CCG-DGN-SGV-TMBA(WSS-CGN) / 1000.

           IF CCG-DGN-IND-MIVA(WSS-CGN) = 'S'
              COMPUTE WSS-VAL-CGN-MNTO IN WSS-VARI ROUNDED =
                    ( WSS-VAL-CGN-MNTO IN WSS-VARI +
                    ((WSS-VAL-CGN-MNTO IN WSS-VARI *
                          WSS-VAL-MIVA IN WSS-VARI) / 100))
              COMPUTE WSS-SGV-FCTC IN WSS-VARI ROUNDED =
                    ( WSS-SGV-FCTC IN WSS-VARI     +
                    ((WSS-SGV-FCTC IN WSS-VARI *
                      WSS-VAL-MIVA IN WSS-VARI) / 100)).

           MOVE WSS-VAL-CGN-MNTO IN WSS-VARI TO
                    PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO.
           MOVE PES-SGV-ENTE IN PES-VARI  TO
            WSS-VAL-CGN-MNTO IN WSS-VARI.

           ADD WSS-SGV-FCTC IN WSS-VARI     TO
               WSS-SGV-TFCT(WSS-NUM-PMC2).
           ADD WSS-VAL-CGN-MNTO IN WSS-VARI TO
                   WSS-SGV-MGAS(WSS-NUM-PMC2).
       FIN-CCG-CAL-MNTO-FAC.
           EXIT.

       PRO-SUM-MIVA SECTION.
       INI-PRO-SUM-MIVA.
           IF CCG-DGN-IND-MIVA(WSS-CGN) = 'S'
              COMPUTE WSS-VAL-CGN-MNTO IN WSS-VARI ROUNDED =
                    ( WSS-VAL-CGN-MNTO IN WSS-VARI +
                    ((WSS-VAL-CGN-MNTO IN WSS-VARI *
                          WSS-VAL-MIVA IN WSS-VARI) / 100)).
       FIN-PRO-SUM-MIVA.
           EXIT.

       PRO-VAL-PCRE SECTION.
       INI-PRO-VAL-PCRE.
           IF FRM-IND-MNTO IN CCG-FLD = 'B'
              GO TO CNT-PRO-VAL-PCRE-AJS.

           MOVE ZEROES                     TO WSS-NUM-RECA IN WSS-VARI.
           MOVE WSS-SGV-CRED(WSS-NUM-PMC2) TO BKP-WSS-SGV-MLIQ.
       LUP-PRO-VAL-PCRE.
           COMPUTE WSS-SGV-NCRE IN WSS-VARI ROUNDED =
           ((WSS-SGV-CRED(WSS-NUM-PMC2) + WSS-SGV-TMFJ(WSS-NUM-PMC2))
                        / ( 1 - WSS-SGV-TFCT(WSS-NUM-PMC2))).

           MOVE WSS-SGV-NCRE IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PRO-AJS-MNTO
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-NCRE IN WSS-VARI.

           MOVE WSS-SGV-NCRE IN WSS-VARI TO WSS-SGV-CRED(WSS-NUM-PMC2).

           MOVE WSS-SGV-TFCT(WSS-NUM-PMC2) TO BKP-WSS-SGV-TFCT.
           MOVE WSS-SGV-TMFJ(WSS-NUM-PMC2) TO BKP-WSS-SGV-TMFJ.

           MOVE ZEROES TO WSS-SGV-TFCT(WSS-NUM-PMC2).
           MOVE ZEROES TO WSS-SGV-TMFJ(WSS-NUM-PMC2).
       CNT-PRO-VAL-PCRE-AJS.
      *----------------------------------------------------------------*
      *    ReCalcula Seguros
           PERFORM PRO-CAL-IMPU.
      *----------------------------------------------------------------*
      *    ReCalcula Seguros
           MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2).
           PERFORM PRO-VAL-PSGS.
      *----------------------------------------------------------------*
      *    ReCalcula Gastos
           MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2).
           PERFORM PRO-VAL-PCGN.
      *----------------------------------------------------------------*
           IF FRM-IND-MNTO IN CCG-FLD = 'B'
              GO TO CNT-PRO-VAL-PCRE.

           IF (WSS-SGV-TFCT(WSS-NUM-PMC2) = BKP-WSS-SGV-TFCT AND
               WSS-SGV-TMFJ(WSS-NUM-PMC2) = BKP-WSS-SGV-TMFJ)
               GO TO CNT-PRO-VAL-PCRE.
           IF WSS-NUM-RECA IN WSS-VARI = ZEROES
              ADD 1 TO WSS-NUM-RECA IN WSS-VARI
              MOVE BKP-WSS-SGV-MLIQ TO WSS-SGV-CRED(WSS-NUM-PMC2)
              GO TO LUP-PRO-VAL-PCRE.

       CNT-PRO-VAL-PCRE.
      *----------------------------------------------------------------*
      *    Monto Liquido Directo
      *----------------------------------------------------------------*
           COMPUTE WSS-SGV-MLIQ(WSS-NUM-PMC2) ROUNDED =
                 ( WSS-SGV-CRED(WSS-NUM-PMC2)
                                       - WSS-SGV-MIMP(WSS-NUM-PMC2)
                                       - WSS-SGV-MSEG(WSS-NUM-PMC2)
                                       - WSS-SGV-MCOM(WSS-NUM-PMC2)
                                       - WSS-SGV-MGAS(WSS-NUM-PMC2)).

           IF FRM-IND-MNTO IN CCG-FLD = 'B'
              GO TO CAE-PRO-VAL-PCRE.

      *----------------------------------------------------------------*
      *    Ajuste Manual Monto Liquido Directo
      *----------------------------------------------------------------*
           IF WSS-SGV-MLIQ(WSS-NUM-PMC2) < BKP-WSS-SGV-MLIQ
              COMPUTE WSS-SGV-CRED(WSS-NUM-PMC2) ROUNDED =
                     (WSS-SGV-CRED(WSS-NUM-PMC2) +
                     (BKP-WSS-SGV-MLIQ - WSS-SGV-MLIQ(WSS-NUM-PMC2)))
              PERFORM PRO-CAL-IMPU
              MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2)
              PERFORM PRO-VAL-PSGS
              MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2)
              PERFORM PRO-VAL-PCGN
              MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO BKP-WSS-SGV-MLIQ-ANT
              COMPUTE WSS-SGV-MLIQ(WSS-NUM-PMC2) ROUNDED =
                    ( WSS-SGV-CRED(WSS-NUM-PMC2)
                                       - WSS-SGV-MIMP(WSS-NUM-PMC2)
                                       - WSS-SGV-MSEG(WSS-NUM-PMC2)
                                       - WSS-SGV-MCOM(WSS-NUM-PMC2)
                                       - WSS-SGV-MGAS(WSS-NUM-PMC2))
              IF WSS-SGV-MLIQ(WSS-NUM-PMC2) < BKP-WSS-SGV-MLIQ AND
                 WSS-SGV-MLIQ(WSS-NUM-PMC2) = BKP-WSS-SGV-MLIQ-ANT
                 ADD 1 TO WSS-SGV-CRED(WSS-NUM-PMC2)
                 PERFORM PRO-CAL-IMPU
                 MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2)
                 PERFORM PRO-VAL-PSGS
                 MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2)
                 PERFORM PRO-VAL-PCGN
                 COMPUTE WSS-SGV-MLIQ(WSS-NUM-PMC2) ROUNDED =
                       ( WSS-SGV-CRED(WSS-NUM-PMC2)
                                       - WSS-SGV-MIMP(WSS-NUM-PMC2)
                                       - WSS-SGV-MSEG(WSS-NUM-PMC2)
                                       - WSS-SGV-MCOM(WSS-NUM-PMC2)
                                       - WSS-SGV-MGAS(WSS-NUM-PMC2))
              ELSE
                 NEXT SENTENCE
           ELSE
           IF WSS-SGV-MLIQ(WSS-NUM-PMC2) > BKP-WSS-SGV-MLIQ
              COMPUTE WSS-SGV-CRED(WSS-NUM-PMC2) ROUNDED =
                     (WSS-SGV-CRED(WSS-NUM-PMC2) -
                     (WSS-SGV-MLIQ(WSS-NUM-PMC2) - BKP-WSS-SGV-MLIQ))
              PERFORM PRO-CAL-IMPU
              MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2)
              PERFORM PRO-VAL-PSGS
              MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2)
              PERFORM PRO-VAL-PCGN
              MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO BKP-WSS-SGV-MLIQ-ANT
              COMPUTE WSS-SGV-MLIQ(WSS-NUM-PMC2) ROUNDED =
                    ( WSS-SGV-CRED(WSS-NUM-PMC2)
                                       - WSS-SGV-MIMP(WSS-NUM-PMC2)
                                       - WSS-SGV-MSEG(WSS-NUM-PMC2)
                                       - WSS-SGV-MCOM(WSS-NUM-PMC2)
                                       - WSS-SGV-MGAS(WSS-NUM-PMC2))
              IF WSS-SGV-MLIQ(WSS-NUM-PMC2) > BKP-WSS-SGV-MLIQ AND
                 WSS-SGV-MLIQ(WSS-NUM-PMC2) = BKP-WSS-SGV-MLIQ-ANT
                 SUBTRACT 1 FROM WSS-SGV-CRED(WSS-NUM-PMC2)
                 PERFORM PRO-CAL-IMPU
                 MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2)
                 PERFORM PRO-VAL-PSGS
                 MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2)
                 PERFORM PRO-VAL-PCGN
                 COMPUTE WSS-SGV-MLIQ(WSS-NUM-PMC2) ROUNDED =
                       ( WSS-SGV-CRED(WSS-NUM-PMC2)
                                       - WSS-SGV-MIMP(WSS-NUM-PMC2)
                                       - WSS-SGV-MSEG(WSS-NUM-PMC2)
                                       - WSS-SGV-MCOM(WSS-NUM-PMC2)
                                       - WSS-SGV-MGAS(WSS-NUM-PMC2)).
       CAE-PRO-VAL-PCRE.
      *----------------------------------------------------------------*
      *    Monto CAE Manual
      *----------------------------------------------------------------*
           MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO
                WSS-VAL-MCAE(WSS-NUM-PMC2).

       FIN-PRO-VAL-PCRE.
           EXIT.

       PRO-CAL-TASA SECTION.
       INI-PRO-CAL-TASA.
           MOVE CCG-NOM-TSMTZ      TO QUE-COLA.
           MOVE CCG-LEN-TSMTZ      TO QUE-LITM.
           MOVE QUE-DEL            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE ZEROES TO WSS-MTZ.
           MOVE 1      TO WSS-NUM-PMC2.

           MOVE 'INT'                      TO RCC-COD-CPTO IN RCC-VARI.
           MOVE WSS-NUM-PZOM(WSS-NUM-PMC2) TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'M'                        TO RCC-MSC-UTPZ IN RCC-VARI.
           IF WSS-IND-MINT IN WSS-VARI = 'L'
           MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO RCC-VAL-MOPE IN RCC-VARI
           MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO RCC-VAL-SOPE IN RCC-VARI
           ELSE
           MOVE WSS-SGV-CRED(WSS-NUM-PMC2) TO RCC-VAL-MOPE IN RCC-VARI
           MOVE WSS-SGV-CRED(WSS-NUM-PMC2) TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE WSS-NUM-NVEN(WSS-NUM-PMC2) TO RCC-VAL-FINA IN RCC-VARI.
           MOVE FRM-COD-ADC1 IN CCG-FLD    TO RCC-COD-TCAR IN RCC-VARI.

       LUP-PRO-CAL-TASA.
           ADD 1 TO WSS-NUM-PMC2.
           ADD 1 TO WSS-MTZ.
           IF WSS-NUM-PMC2 > WSS-NUM-MMC2
              GO TO EXT-PRO-CAL-TASA.
           IF WSS-SGV-CRED(WSS-NUM-PMC2) NOT > ZEROES
              GO TO EXT-PRO-CAL-TASA.

           IF WSS-IND-MINT IN WSS-VARI = 'L'
           MOVE WSS-SGV-MLIQ(WSS-NUM-PMC2) TO CCG-SGV-CRED-MTZ(WSS-MTZ)
           ELSE
           MOVE WSS-SGV-CRED(WSS-NUM-PMC2) TO CCG-SGV-CRED-MTZ(WSS-MTZ).

           MOVE WSS-NUM-NVEN(WSS-NUM-PMC2) TO CCG-NUM-NVEN-MTZ(WSS-MTZ).
           MOVE WSS-NUM-PZOD(WSS-NUM-PMC2) TO CCG-NUM-PZOD-MTZ(WSS-MTZ).
           MOVE WSS-NUM-PZOM(WSS-NUM-PMC2) TO CCG-NUM-PZOM-MTZ(WSS-MTZ).
           MOVE WSS-NUM-PZOA(WSS-NUM-PMC2) TO CCG-NUM-PZOA-MTZ(WSS-MTZ).

       NXT-PRO-CAL-TASA.
           GO TO LUP-PRO-CAL-TASA.
       EXT-PRO-CAL-TASA.

           MOVE 1                  TO QUE-NITM.
           MOVE CCG-NOM-TSMTZ      TO QUE-COLA.
           MOVE CCG-LEN-TSMTZ      TO QUE-LITM.
           MOVE SPACES             TO QUE-ITEM.
           MOVE CCG-GLS-DMTZ       TO QUE-ITEM.
           MOVE QUE-PUT            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF NOT (QUE-STAT = QUE-STAT-OKS)
              MOVE 'ERRPUTQUEMTZ' TO CCG-COD-MENS
              GO TO FIN-PRO-CAL-TASA.

           MOVE CCG-NOM-TSMTZ TO RCC-NOM-TSMTZ IN RCC-VARI.
           PERFORM PRO-OBT-TRFA.
           IF CCG-COD-MENS IN CCG-VARI > SPACES
              GO TO FIN-PRO-CAL-TASA.
           MOVE ZEROES TO RCC-R IN RCC-VARI.
       LUP-PRO-CAL-TASA-QUE.
           ADD 1 TO RCC-R.

           MOVE RCC-R          TO QUE-NITM.
           MOVE RCC-NOM-TSSGS  TO QUE-COLA.
           MOVE RCC-LEN-TSSGS  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE '00'     TO FIO-STAT
              MOVE QUE-ITEM TO OSG-APL-VEC(1)

              MOVE OSG-OCI-VAL-PPRO(1) TO WSS-SGV-TASA(RCC-R)
              MOVE OSG-SGS-MSC-BCTI(1) TO WSS-MSC-BCTI(RCC-R)
              MOVE OSG-SGS-MSC-PBTI(1) TO WSS-MSC-PBTI(RCC-R)
              MOVE OSG-SGS-MSC-BPBT(1) TO WSS-MSC-BPBT(RCC-R)
              MOVE OSG-SGS-MSC-SPBT(1) TO WSS-MSC-SPBT(RCC-R)
              MOVE OSG-SGS-COD-CVTI(1) TO WSS-COD-CVTI(RCC-R)
              MOVE OSG-SGS-MSC-TFPR(1) TO WSS-MSC-TFPR(RCC-R)
              MOVE OSG-SGS-NUM-PREP(1) TO WSS-NUM-PREP(RCC-R)
              MOVE OSG-SGS-MSC-UTPR(1) TO WSS-MSC-UTPR(RCC-R)
              GO TO LUP-PRO-CAL-TASA-QUE.

       EXT-PRO-CAL-TASA-QUE.
           MOVE RCC-NOM-TSSGS     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PRO-CAL-TASA.
           EXIT.

       PRO-CAL-MVEN SECTION.
       INI-PRO-CAL-MVEN.
      *PVG INI 04-FEB-2015
           IF WSS-IND-PCUO IN WSS-VARI = 'N'
              GO TO FIN-PRO-CAL-MVEN.
      *PVG FIN 04-FEB-2015
           MOVE WSS-NUM-MMC2 TO WSS-NUM-PMC2.
       LUP-PRO-CAL-MVEN.
           SUBTRACT 1 FROM WSS-NUM-PMC2.
           IF WSS-NUM-PMC2 NOT > ZEROES
              GO TO EXT-PRO-CAL-MVEN.
           IF WSS-SGV-CRED(WSS-NUM-PMC2) NOT > ZEROES
              GO TO LUP-PRO-CAL-MVEN.

           MOVE WSS-SGV-CRED(WSS-NUM-PMC2) TO MIC-SGV-MBRT IN MIC-ENTR.
           MOVE WSS-VAL-MCAE(WSS-NUM-PMC2) TO MIC-SGV-MCAE IN MIC-ENTR.
           MOVE WSS-COD-VCOC IN WSS-VARI   TO MIC-COD-VCOC IN MIC-ENTR.
           MOVE FRM-NUM-SEVE IN CCG-FLD    TO MIC-NUM-PEVE IN MIC-ENTR.
           MOVE FRM-IND-UTSV IN CCG-FLD    TO MIC-IND-UTSV IN MIC-ENTR.
           MOVE WSS-NUM-DVEN IN WSS-VARI   TO MIC-NUM-DPVE IN MIC-ENTR.
           MOVE WSS-NUM-MVEN IN WSS-VARI   TO MIC-NUM-MPVE IN MIC-ENTR.
           MOVE WSS-NUM-SVEN IN WSS-VARI   TO MIC-NUM-SPVE IN MIC-ENTR.
           MOVE WSS-NUM-AVEN IN WSS-VARI   TO MIC-NUM-APVE IN MIC-ENTR.
           MOVE WSS-NUM-NVEN(WSS-NUM-PMC2) TO MIC-NUM-CUOT IN MIC-ENTR.
           MOVE WSS-SGV-TASA(WSS-NUM-PMC2) TO MIC-SGV-TASA IN MIC-ENTR.
           MOVE WSS-COD-TINT(WSS-NUM-PMC2) TO MIC-TIP-TASA IN MIC-ENTR.
           MOVE FRM-NUM-MNP1 IN CCG-FLD    TO MIC-NPA-MES1 IN MIC-ENTR.
           MOVE FRM-NUM-MNP2 IN CCG-FLD    TO MIC-NPA-MES2 IN MIC-ENTR.
           MOVE FRM-NUM-MNP3 IN CCG-FLD    TO MIC-NPA-MES3 IN MIC-ENTR.
           MOVE FRM-NUM-MNP4 IN CCG-FLD    TO MIC-NPA-MES4 IN MIC-ENTR.
           MOVE FRM-COD-TOOC IN CCG-FLD    TO MIC-COD-TOOC IN MIC-ENTR.
           MOVE FRM-COD-AOOC IN CCG-FLD    TO MIC-COD-AOOC IN MIC-ENTR.
           MOVE WSS-NUM-DCUR IN WSS-VARI   TO MIC-NUM-DCOL IN MIC-ENTR.
           MOVE WSS-NUM-MCUR IN WSS-VARI   TO MIC-NUM-MCOL IN MIC-ENTR.
           MOVE WSS-NUM-SCUR IN WSS-VARI   TO MIC-NUM-SCOL IN MIC-ENTR.
           MOVE WSS-NUM-ACUR IN WSS-VARI   TO MIC-NUM-ACOL IN MIC-ENTR.
           MOVE WSS-IND-AFER IN WSS-VARI   TO MIC-IND-AFER IN MIC-ENTR.

           MOVE WSS-IND-VUCO IN WSS-VARI   TO MIC-IND-VUCO IN MIC-ENTR.
           MOVE WSS-IND-CCAE IN WSS-VARI   TO MIC-IND-CCAE IN MIC-ENTR.
           MOVE WSS-IND-MCTC IN WSS-VARI   TO MIC-IND-MCTC IN MIC-ENTR.
           MOVE 'S'                        TO MIC-IND-GCPS IN MIC-ENTR.
           
           MOVE SPACES                     TO MIC-GLS-MENN.

           IF WSS-SGV-TASA(WSS-NUM-PMC2) NOT > ZEROES
              MOVE ZEROES TO WSS-SGV-MVEN(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MIMP(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MSEG(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MCOM(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MGAS(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MCAE(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-MCTC(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-SGV-TASA(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-BCTI(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-PBTI(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-BPBT(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-SPBT(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-COD-CVTI(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-TFPR(WSS-NUM-PMC2)
              MOVE ZEROES TO WSS-NUM-PREP(WSS-NUM-PMC2)
              MOVE SPACES TO WSS-MSC-UTPR(WSS-NUM-PMC2)
           ELSE
              PERFORM CMN-ING-MIC
              IF MIC-GLS-MENN > SPACES
                 MOVE MIC-GLS-MENN       TO CCG-COD-MENS IN CCG-VARI
                 MOVE ZEROES             TO WSS-SGV-MVEN(WSS-NUM-PMC2)
                 MOVE ZEROES             TO WSS-SGV-MCAE(WSS-NUM-PMC2)
                 MOVE ZEROES             TO WSS-SGV-MCTC(WSS-NUM-PMC2)
              ELSE
      *MHM-INI 03-MAY-2018
                 PERFORM OBT-VENS
      *MHM-FIN 03-MAY-2018
                 MOVE MIC-SGV-VFIN IN MIC-SALI TO 
                                            WSS-SGV-MVEN(WSS-NUM-PMC2)
                 MOVE MIC-MON-CCAE IN MIC-SALI TO
                                            WSS-SGV-MCAE(WSS-NUM-PMC2)
                 MOVE MIC-SGV-MCTC IN MIC-SALI TO
                                            WSS-SGV-MCTC(WSS-NUM-PMC2).
       NXT-PRO-CAL-MVEN.
           GO TO LUP-PRO-CAL-MVEN.
       EXT-PRO-CAL-MVEN.
           IF MIC-NOM-TSTAB IN MIC-SALI > SPACES
              MOVE MIC-NOM-TSTAB IN MIC-SALI TO QUE-COLA
              MOVE QUE-DEL TO QUE-CMND
              PERFORM GNS-PRO-QUE.
       FIN-PRO-CAL-MVEN.
           EXIT.
      *PVG INI 04-FEB-2015
       PRO-LEC-RROC SECTION.
       INI-PRO-LEC-RROC.
           MOVE ZEROES TO WSS-IROC     IN WSS-VARI.
           PERFORM CLR-VEC-RROC.
           MOVE ZEROES TO WSS-IROC     IN WSS-VARI.

           MOVE WSS-KEY-RROC IN WSS-VARI TO ROC-CIC-IOPC IN ROC.
           MOVE 'CRE'                    TO ROC-COD-SIST IN ROC.
           MOVE 'CUR'                    TO ROC-COD-EVEN IN ROC.
           MOVE ZEROES                   TO ROC-NUM-IROC IN ROC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-LEC-RROC.
      *PVG INI 27-ENE-2017
      *    PERFORM TAB-FIO-ROC.
           PERFORM MC2-FIO-ROC.
      *PVG FIN 27-ENE-2017
           IF NOT (FIO-STAT-OKS AND
                   ROC-CIC-IOPC IN ROC = WSS-KEY-RROC IN WSS-VARI AND
                   ROC-COD-SIST IN ROC = 'CRE' AND
                   ROC-COD-EVEN IN ROC = 'CUR')
              GO TO EXT-PRO-LEC-RROC.
           MOVE 'S' TO WSS-INF-RROC IN WSS-VARI.
           IF (ROC-MSC-STAT IN ROC = 'S' AND
              (ROC-COD-CPTO IN ROC = 'SGS' OR 'CGN'))
               ADD 1 TO WSS-IROC IN WSS-VARI
               MOVE ROC-COD-CPTO IN ROC TO VEC-COD-CPTO(WSS-IROC)
               MOVE ROC-COD-SCPT IN ROC TO VEC-COD-SCPT(WSS-IROC).
       NXT-PRO-LEC-RROC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-LEC-RROC.
       EXT-PRO-LEC-RROC.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
      *PVG INI 27-ENE-2017
      *       PERFORM TAB-FIO-ROC.
              PERFORM MC2-FIO-ROC.
      *PVG FIN 27-ENE-2017
           IF WSS-INF-RROC IN WSS-VARI = 'N'
              MOVE 'CDCROCINFNEX' TO CCG-COD-MENS IN CCG-VARI.
       FIN-PRO-LEC-RROC.
           EXIT.
       CLR-VEC-RROC SECTION.
       INI-CLR-VEC-RROC.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-CLR-VEC-RROC.
           MOVE SPACES TO VEC-COD-CPTO(WSS-IROC)
           MOVE SPACES TO VEC-COD-SCPT(WSS-IROC)
           GO TO INI-CLR-VEC-RROC.
       FIN-CLR-VEC-RROC.
           EXIT.

       BUS-SGS-CPTO SECTION.
       INI-BUS-SGS-CPTO.
           MOVE 'N' TO WSS-EXI-RROC IN WSS-VARI.
           MOVE ZEROES TO WSS-IROC IN WSS-VARI.
       LUP-BUS-SGS-CPTO.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-BUS-SGS-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT > SPACES
              GO TO FIN-BUS-SGS-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT = 'SGS'
              GO TO NXT-BUS-SGS-CPTO.
           IF VEC-COD-SCPT(WSS-IROC) = SGS-COD-TSEG IN SGS
              MOVE 'S' TO WSS-EXI-RROC IN WSS-VARI
              GO TO FIN-BUS-SGS-CPTO.
       NXT-BUS-SGS-CPTO.
           GO TO LUP-BUS-SGS-CPTO.
       FIN-BUS-SGS-CPTO.
           EXIT.

       BUS-CGN-CPTO SECTION.
       INI-BUS-CGN-CPTO.
           MOVE 'N' TO WSS-EXI-RROC IN WSS-VARI.
           MOVE ZEROES TO WSS-IROC IN WSS-VARI.
       LUP-BUS-CGN-CPTO.
           ADD 1 TO WSS-IROC IN WSS-VARI.
           IF WSS-IROC IN WSS-VARI > WSS-IMAXROC IN WSS-VARI
              GO TO FIN-BUS-CGN-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT > SPACES
              GO TO FIN-BUS-CGN-CPTO.
           IF VEC-COD-CPTO(WSS-IROC) NOT = 'CGN'
              GO TO NXT-BUS-CGN-CPTO.
           IF VEC-COD-SCPT(WSS-IROC) = DGN-COD-TDOC IN DGN
              MOVE 'S' TO WSS-EXI-RROC IN WSS-VARI
              GO TO FIN-BUS-CGN-CPTO.
       NXT-BUS-CGN-CPTO.
           GO TO LUP-BUS-CGN-CPTO.
       FIN-BUS-CGN-CPTO.
           EXIT.
      *PVG FIN 04-FEB-2015      

      *MHM-INI 03-MAY-2018
       OBT-VENS SECTION.
       INI-OBT-VENS.
           MOVE 1          TO QUE-NITM.
           MOVE MIC-TSMIC-TSS  TO QUE-COLA.
           MOVE MIC-LEN-TSMIC  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO VEN
              MOVE VEN-NUM-SVEN TO WSS-NUM-SPVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-AVEN TO WSS-NUM-APVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-MVEN TO WSS-NUM-MPVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-DVEN TO WSS-NUM-DPVT(WSS-NUM-PMC2)
           ELSE
              MOVE ZEROES TO WSS-FEC-FPVT(WSS-NUM-PMC2).
              
              
           MOVE WSS-NUM-NVEN(WSS-NUM-PMC2) TO QUE-NITM.
           MOVE MIC-TSMIC-TSS  TO QUE-COLA.
           MOVE MIC-LEN-TSMIC  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO VEN
              MOVE VEN-NUM-SVEN TO WSS-NUM-SUVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-AVEN TO WSS-NUM-AUVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-MVEN TO WSS-NUM-MUVT(WSS-NUM-PMC2)
              MOVE VEN-NUM-DVEN TO WSS-NUM-DUVT(WSS-NUM-PMC2)
           ELSE
              MOVE ZEROES TO WSS-FEC-FUVT(WSS-NUM-PMC2).
       FIN-OBT-VENS.
           EXIT.
      *MHM-FIN 03-MAY-2018
      *>>>>                                                             
*% END	
