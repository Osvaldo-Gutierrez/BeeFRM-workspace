*% IF INI_FST_KEY_TRF                                             
      *<<<< INI_FST_KEY_TRF                                             
           IF SCR-CMND = 'CON'                                          
              MOVE -1 TO DBC-NUM-ICLI-LEN IN TRF-FLD                    
              GO TO FIN-FST-KEY-TRF.                                    
      *>>>>                                                             
*% END
*% IF FIN_UNP_KEY_TRF                                             
      *<<<< FIN_UNP_KEY_TRF                                             
           IF SCR-CMND = 'CON'                                          
              PERFORM PRO-KEY-TRF                                       
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN TRF-FLD.         
      *>>>>                                                             
*% END
*% IF FIN_UNP_IKY_TRF                                             
      *<<<< FIN_UNP_IKY_TRF                                             
           IF SCR-CMND = 'CON'                                          
              PERFORM PRO-KEY-TRF                                       
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN TRF-FLD          
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN TRF-FLD.         
      *>>>>                                                             
*% END
*% IF INI_PUT_ALL_TRF
      *<<<< INI_PUT_ALL_TRF
           GO TO FIN-PUT-ALL-TRF.
      *>>>>
*% END
*% IF FRM_COD_TREC
      *<<<< FRM_COD_TREC
           IF (SCR-CMND = 'SIM' AND                                             
               FRM-NUM-IGRP IN TRF-FLD NOT = ZEROES AND                         
               FRM-COD-TREC IN TRF-FLD NOT > SPACES)                            
               PERFORM ERR-GLS                                                  
               GO TO FIN-VAL-FRM-COD-TREC.                                      
           IF FRM-COD-TREC IN TRF-FLD > SPACES
              MOVE 'SGC'                   TO TAB-COD-SIST
              MOVE 'REC '                  TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TREC IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-TREC.
      *>>>>
*% END
*% IF FRM_COD_CPTO
      *<<<< FRM_COD_CPTO
           IF FRM-COD-CPTO IN TRF-FLD NOT > SPACES AND SCR-CMND = 'SIM'         
              PERFORM ERR-GLS                                                   
              GO TO FIN-VAL-FRM-COD-CPTO.                                       
                                                                                
           IF FRM-COD-CPTO IN TRF-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'TCP'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-CPTO IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-CPTO.
      *>>>>
*% END
*% IF FRM_COD_TBAN
      *<<<< FRM_COD_TBAN
           IF FRM-COD-TBAN IN TRF-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'BAN'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TBAN IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-TBAN.
      *>>>>
*% END
*% IF FRM_IND_RTBL
      *<<<< FRM_IND_RTBL
           IF FRM-IND-RTBL IN TRF-FLD > SPACES
              MOVE 'SGC'                   TO TAB-COD-SIST
              MOVE 'RTB'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-IND-RTBL IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-IND-RTBL.
      *>>>>
*% END
*% IF FRM_IND_NEDU
      *<<<< FRM_IND_NEDU
           IF FRM-IND-NEDU IN TRF-FLD > SPACES
              MOVE 'SGC'                   TO MSC-COD-SIST       
              MOVE 'NEDU'                  TO MSC-COD-TMSC IN MSC
              MOVE FRM-IND-NEDU IN TRF-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-MSC                                    
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'     
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS                   
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR                   
                 GO TO FIN-VAL-FRM-IND-NEDU.
      *>>>>
*% END
*% IF FRM_IND_CASA
      *<<<< FRM_IND_CASA
           IF FRM-IND-CASA IN TRF-FLD > SPACES
              MOVE 'SGC'                   TO MSC-COD-SIST       
              MOVE 'CASA'                  TO MSC-COD-TMSC IN MSC
              MOVE FRM-IND-CASA IN TRF-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-MSC                                    
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'     
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS                   
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR                   
                 GO TO FIN-VAL-FRM-IND-CASA.
      *>>>>
*% END
*% IF FRM_IND_SLAB
      *<<<< FRM_IND_SLAB
           IF FRM-IND-SLAB IN TRF-FLD > SPACES
              MOVE 'SGC'                   TO MSC-COD-SIST       
              MOVE 'SLAB'                  TO MSC-COD-TMSC IN MSC
              MOVE FRM-IND-SLAB IN TRF-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-MSC                                    
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'     
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS                   
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR                   
                 GO TO FIN-VAL-FRM-IND-SLAB.
      *>>>>
*% END
*% IF FRM_COD_TOOC
      *<<<< FRM_COD_TOOC
           IF SCR-CMND = 'SIM' AND FRM-COD-TOOC IN TRF-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-COD-TOOC.

           IF FRM-COD-TOOC IN TRF-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-TOOC.

TRF***     IF FRM-COD-TOOC IN TRF-FLD > SPACES AND                              
TRF***        TAB-GLS-DAT1 IN TAB NOT > SPACES                                  
TRF***        MOVE 'SISTIO   NEX'       TO MSG-COD-MENS                         
TRF***        MOVE FRM-SUAR-MAL         TO FRM-SUAR                             
TRF***     ELSE                                                                 
TRF***        MOVE TAB-GLS-DAT1 IN TAB  TO TRF-GLS-DAT1 IN TRF-IRCC             
TRF****       SOLO BCI                                                          
TRF***        IF TRF-COD-SIST IN TRF-IRCC = 'COL'                               
TRF***           MOVE 'CRE'             TO TRF-COD-SIST IN TRF-IRCC.            
      *>>>>
*% END
*% IF FRM_COD_EVEN
      *<<<< FRM_COD_EVEN
           IF FRM-COD-EVEN IN TRF-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-EVEN IN TRF-FLD  TO TRF-COD-EVEN IN TRF-IRCC         
              MOVE TRF-GLS-EVEN IN TRF-IRCC TO TAB-COD-CTAB IN TAB              
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-EVEN.
      *>>>>
*% END
*% IF FRM_COD_TCNL
      *<<<< FRM_COD_TCNL
           IF FRM-COD-TCNL IN TRF-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'CNL'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TCNL IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-TCNL.
      *>>>>
*% END
*% IF FRM_COD_CNAL
      *<<<< FRM_COD_CNAL
           IF FRM-COD-CNAL IN TRF-FLD > SPACES               
              IF FRM-COD-TCNL IN TRF-FLD NOT = '010'                
                 MOVE 'TAB'                   TO TAB-COD-SIST       
                 MOVE FRM-COD-TCNL IN TRF-FLD TO TAB-COD-TTAB IN TAB
                 MOVE FRM-COD-CNAL IN TRF-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-COD                                    
              ELSE                                                  
                 MOVE FRM-COD-CNAL IN TRF-FLD TO OFI-COD-OFIC IN OFI
                 PERFORM VAL-OFI                                    
                 IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'     
                    MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS                   
                    MOVE FRM-SUAR-MAL         TO FRM-SUAR                   
                    GO TO FIN-VAL-FRM-COD-CNAL.
      *>>>>
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC
           IF FRM-COD-VCOC IN TRF-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-VCOC IN TRF-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS IN MSG > SPACES
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-VCOC.
      *>>>>
*% END
*% IF FRM_MSC_UTPZ
      *<<<< FRM_MSC_UTPZ
           IF FRM-MSC-UTPZ IN TRF-FLD > SPACES AND
              FRM-NUM-PLZO IN TRF-FLD NOT > ZEROES
              MOVE 'MC2'               TO MSG-COD-SIST
              MOVE 'UTPR    INV'       TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
              MOVE FRM-SUAR-MAL        TO FRM-SUAR
              GO TO FIN-VAL-FRM-MSC-UTPZ.

           IF FRM-MSC-UTPZ IN TRF-FLD > SPACES
              MOVE 'TAB'                   TO MSC-COD-SIST       
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC
              MOVE FRM-MSC-UTPZ IN TRF-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-MSC
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'     
                 MOVE MSG-GLS-DESC IN MSG  TO FRM-MENS                   
                 MOVE FRM-SUAR-MAL         TO FRM-SUAR                   
                 GO TO FIN-VAL-FRM-MSC-UTPZ.
      *>>>>
*% END
*% IF INI_FRM_FEC_FNAC
      *<<<<
           MOVE FEC-VHBL-N TO FEC-VHBL.                                         
      *>>>>
*% END 
