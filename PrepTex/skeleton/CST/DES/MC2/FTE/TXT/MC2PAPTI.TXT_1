*%! Codigo adicional
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "MC2ZQPTI"
*% ELSE
*% CLRMFC = "MC2ZUPTI"
*% END
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03  SCR-IND-VNEG                         PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS             
       COPY GNSWGHOY.                                                   
       COPY MC2BRCIN.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIN-REQA==.        
       COPY GNSBRMSC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
       COPY MC2WXPTI.                                                   

*% IF PGM_PQ
           03 WSS-GLS-OPRN.
              05  WSS-COD-TCPT                          PIC X(01).
              05  WSS-COD-TSCP                          PIC X(01).
              05  WSS-GLS-FIL1    VALUE SPACES          PIC X(10).
*% END
      *PVG INI 29-JUN-2007 TRF                                          
       COPY MC2WXMCT.                                                   
      *PVG FIN 29-JUN-2007
       77  WSS-DSP-TASK         VALUE ZEROES    PIC 9(10).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO                                                     
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO PTI-COD-TERM                       
                MOVE TSK-TERM-ALF TO PTI-COD-TERM-MAS                   
           ELSE                                                         
                MOVE EIBTRMID     TO PTI-COD-TERM                       
                MOVE EIBTRMID     TO PTI-COD-TERM-MAS.                  
      *>>>>                                                             
*% END
*% IF POST_SCR_PUTA
           MOVE EIBTASKN TO WSS-DSP-TASK.
*% END
*% IF FND_KEY
      *<<<< FND_KEY                                                     
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
               MOVE '00'     TO FIO-STAT                                
               MOVE FIO-STAT TO PGM-STAT-PTI                            
               PERFORM CRG-PTI-QUE                                      
               GO TO FIN-FND-KEY.                                       
      *PVG FIN 29-JUN-2007                                              
           IF SCR-CMND NOT = 'CON'                                      
               GO TO FND-KEY-DIR.                                       
                                                                        
           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'TVA'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PTI-COD-TVAL IN PTI-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-CIC-CTAB IN TAB     TO WSS-COD-TIVA IN WSS-VARI.    
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               PTI-CAI-IPTI IN PTI = PTI-CAI-IPTI IN PTI-FLD AND        
               PTI-IIC-IPTI IN PTI = PTI-IIC-IPTI IN PTI-FLD AND        
               PTI-COD-TVAL IN PTI = WSS-COD-TIVA IN WSS-VARI)          
               MOVE '23' TO PGM-STAT-PTI                                
           ELSE                                                         
               MOVE PTI-STP-ITRN IN PTI TO SCR-UMOD                     
               MOVE '00' TO PGM-STAT-PTI.                               
           GO TO CNT-FND-KEY.                                           
                                                                        
       FND-KEY-DIR.                                                     
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
            IF NOT FIO-STAT-OKS                                         
                MOVE '23' TO PGM-STAT-PTI                               
            ELSE                                                        
                MOVE '00' TO PGM-STAT-PTI.                              
       CNT-FND-KEY.                                                     
           MOVE PTI-CIC-IPTI IN PTI TO CIN-CIC-IPTI IN CIN.             
           MOVE 'CIN-CIC-IPTI'      TO FIO-AKEY.                        
           MOVE FIO-GET-KEY         TO FIO-CMND.                        
           PERFORM MC2-FIO-CIN.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'MC2'           TO MSG-COD-SIST                     
               MOVE 'PTI    NOCIN'  TO MSG-COD-MENS                     
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC    TO FRM-MENS                         
               MOVE '23'            TO FIO-STAT                         
               MOVE SCR-STAT-CON    TO SCR-STAT                         
               GO TO FIN-FND-KEY.                                       
      *PVG INI 02-NOV-2010
           MOVE 'MC2'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'TDP'               TO TAB-COD-TTAB IN TAB.
           MOVE CIN-IND-TPLT IN CIN TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-COD-DAT1 IN TAB(1) TO SCR-IND-VNEG IN SCR-VARI.
           IF SCR-IND-VNEG IN SCR-VARI NOT > SPACES
              MOVE 'N' TO SCR-IND-VNEG IN SCR-VARI.
      *PVG FIN 02-NOV-2010
                                                                        
      *PVG INI 29-JUN-2007                                          
           IF SCR-OFRM-SRV                                              
              GO TO CNT-FND-KEY-SRV.                                    
      *PVG FIN 29-JUN-2007                                              
           MOVE 'MC2'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE CIN-CIC-IPTI IN CIN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO FRM-COD-CIN1 IN PTI-FLD.         
           MOVE TAB-GLS-DATA IN TAB TO FRM-COD-CIN2 IN PTI-FLD.         
                                                                        
           MOVE CIN-MSC-STAT IN CIN TO PTI-IND-VIGE IN PTI-FLD.         
           MOVE 'GNS'               TO TAB-COD-SIST FIO-SIST.       
           MOVE 'STT'               TO TAB-COD-TTAB IN TAB.             
           MOVE CIN-MSC-STAT IN CIN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB                                              
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VIGE IN PTI-FLD.         
                                                                        
           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.             
           MOVE CIN-COD-VCOC IN CIN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MNTO IN PTI-FLD.         
                                                                        
           MOVE 'TAB'               TO MSC-COD-SIST.                    
           MOVE 'IPER'              TO MSC-COD-TMSC IN MSC.             
           MOVE CIN-MSC-UTPT IN CIN TO MSC-COD-CMSC IN MSC.             
           PERFORM BUS-MSC.                                             
           IF MSG-COD-MENS IN MSG NOT > SPACES
              MOVE MSC-GLS-DCOR IN MSC  TO FRM-GLS-UTPT IN PTI-FLD
           ELSE
              MOVE 'MC2'                TO TAB-COD-SIST FIO-SIST
              MOVE 'CAA'                TO TAB-COD-TTAB IN TAB
              MOVE CIN-IND-TPLT IN CIN  TO WSS-COD-TCPT
              MOVE CIN-MSC-UTPT IN CIN  TO WSS-COD-TSCP
              MOVE WSS-GLS-OPRN         TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB  TO FRM-GLS-UTPT IN PTI-FLD.

           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.
           MOVE 'TVA'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PTI-COD-TVAL IN PTI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TVAL IN PTI-FLD.         
                                                                        
      *PVG INI 29-JUN-2007                                          
       CNT-FND-KEY-SRV.                                                 
      *PVG FIN 29-JUN-2007                                              
           MOVE PGM-STAT-PTI TO FIO-STAT.                               
           IF SCR-CMND = 'CON'                                          
              IF SCR-OFRM-SRV                                           
                 PERFORM CRG-PTI-QUE                                    
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 GO TO FIN-FND-KEY                                      
           ELSE                                                         
              IF CIN-MSC-STAT = 'V'                                     
                 MOVE 'CIN    VRFYA' TO MSG-COD-MENS                    
              ELSE                                                      
              IF CIN-MSC-STAT = 'A'                                     
                 MOVE 'CIN    ACTYA' TO MSG-COD-MENS                    
              ELSE                                                      
              IF CIN-MSC-STAT = 'D'                                     
                 MOVE 'CIN    ANLYA' TO MSG-COD-MENS                    
              ELSE                                                      
                 GO TO FIN-FND-KEY.                                     
       SIG-FND-KEY.                                                     
           MOVE 'MC2'        TO MSG-COD-SIST.                           
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS                                
           MOVE '00'         TO FIO-STAT.                               
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           MOVE 'S' TO SCR-IERR.                                        
           GO TO FIN-FND-KEY.                                           
      *>>>>                                                             
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           IF SCR-OFRM-SRV AND
              FRM-IND-TELI IN PTI-FLD = 'M'
               PERFORM ELI-ALL-PTI
               MOVE PGM-STAT-PTI TO FIO-STAT
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY MC2BFCIN.

       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBMSC.
       COPY GNSBFMSC.

       CRG-PTI-QUE SECTION.                                             
       INI-CRG-PTI-QUE.                                                 
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              PERFORM LEE-TRF-PTI.                                      
      *PVG FIN 29-JUN-2007                                              
           MOVE PGM-STAT-PTI TO FIO-STAT.                               
           IF NOT FIO-STAT-OKS                                          
              MOVE '00' TO FIO-STAT                                     
              GO TO FIN-CRG-PTI-QUE.                                    
                                                                        
           MOVE PTI-NOM-TSPTI     TO QUE-COLA.                          
           MOVE QUE-DEL           TO QUE-CMND.                          
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE PTI-NOM-TSPTI-MAS TO QUE-COLA.                          
           MOVE QUE-DEL           TO QUE-CMND.                          
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           PERFORM CLR-PTI-ITEM.                                        
           MOVE ZEROES TO WSS-NUM-FILA WSS-NUM-COLA.                    
           MOVE ZEROES TO WSS-V WSS-T WSS-NITM.                         
                                                                        
           MOVE PTI-CAI-IPTI IN PTI-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE PTI-IIC-IPTI IN PTI-FLD TO PTI-IIC-IPTI IN PTI.         
           IF FRM-IND-TELI IN PTI-FLD = 'S'                             
               MOVE 'S' TO WSS-IND-LPRI                                 
               MOVE PTI-COD-TVAL IN PTI-FLD TO PTI-COD-TVAL IN PTI      
               MOVE PTI-VAL-MNTO IN PTI-FLD TO PTI-VAL-MNTO IN PTI      
               MOVE PTI-NUM-PLZO IN PTI-FLD TO PTI-NUM-PLZO IN PTI      
           ELSE                                                         
               MOVE SPACES                  TO PTI-COD-TVAL IN PTI      
               MOVE ZEROES                  TO PTI-VAL-MNTO IN PTI      
               MOVE ZEROES                  TO PTI-NUM-PLZO IN PTI.     
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              MOVE ZEROES TO MCT-P IN MCT-VARI.                         
      *PVG FIN 29-JUN-2007                                              
       LUP-CRG-PTI-QUE.                                                 
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              ADD 1 TO MCT-P IN MCT-VARI                                
              IF MCT-P IN MCT-VARI > MCT-PMAX IN MCT-VARI               
                 MOVE '23'     TO FIO-STAT                              
                 MOVE FIO-STAT TO PGM-STAT-PTI                          
                 GO TO CNT-CRG-PTI-QUE                                  
              ELSE                                                      
                 IF MCT-VAL-MNTO(MCT-P IN MCT-VARI) > ZEROES            
                    GO TO CNT-CRG-PTI-TRF                               
                 ELSE                                                   
                    MOVE '23'     TO FIO-STAT                           
                    MOVE FIO-STAT TO PGM-STAT-PTI                       
                    GO TO CNT-CRG-PTI-QUE.                              
      *PVG FIN 29-JUN-2007                                              
           PERFORM MC2-FIO-PTI.                                         
           MOVE FIO-STAT TO PGM-STAT-PTI.                               
           IF NOT ( FIO-STAT-OKS AND                                    
                    PTI-CAI-IPTI IN PTI = PTI-CAI-IPTI IN PTI-FLD AND   
                    PTI-IIC-IPTI IN PTI = PTI-IIC-IPTI IN PTI-FLD )     
              GO TO CNT-CRG-PTI-QUE.                                    
                                                                        
           IF FRM-IND-TELI IN PTI-FLD = 'S' AND WSS-IND-LPRI = 'S'      
              MOVE SPACES TO WSS-IND-LPRI                               
              GO TO LEE-NXT-PTI-QUE.                                    
                                                                        
      *PVG INI 29-JUN-2007 TRF                                          
       CNT-CRG-PTI-TRF.                                                 
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              PERFORM PUT-TRF-PTI.                                      
      *PVG FIN 29-JUN-2007                                              
           ADD 1 TO WSS-V.                                              
           ADD 1 TO WSS-T.                                              
           IF WSS-V = WSS-VMAX                                          
              PERFORM CRG-VEC-PTI                                       
              PERFORM PUT-PTI-QUE                                       
              PERFORM CLR-PTI-ITEM                                      
           ELSE                                                         
              PERFORM CRG-VEC-PTI.                                      
       LEE-NXT-PTI-QUE.                                                 
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-CRG-PTI-QUE.                                       
                                                                        
       CNT-CRG-PTI-QUE.                                                 
           IF WSS-V > ZEROES                                            
              PERFORM PUT-PTI-QUE.                                      
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              GO TO FIN-CRG-PTI-QUE.                                    
      *PVG FIN 29-JUN-2007                                              
                                                                        
           MOVE PGM-STAT-PTI TO FIO-STAT.                               
           IF FIO-STAT-OKS                                              
               MOVE FIO-END-BRW TO FIO-CMND                             
               PERFORM MC2-FIO-PTI.                                     
       FIN-CRG-PTI-QUE.                                                 
           IF WSS-NITM > ZEROES                                         
                MOVE '00' TO FIO-STAT.                                  
           IF WSS-T > WSS-TMAX                                          
               MOVE 'S'           TO PTI-MAS-IND-HMAS                   
           ELSE                                                         
               MOVE 'N'           TO PTI-MAS-IND-HMAS.                  
           MOVE 1                 TO QUE-NITM.                          
           MOVE PTI-LEN-TSPTI-MAS TO QUE-LITM.                          
           MOVE PTI-NOM-TSPTI-MAS TO QUE-COLA.                          
           MOVE WSS-T             TO WSS-NUM-ICUR.                      
           MOVE WSS-NUM-ICUR      TO WSS-NUM-ICUR-EDT.                  
           MOVE WSS-NUM-ICUR-EDT  TO WSS-NUM-ICUR-ALF.                  
           MOVE WSS-NUM-ICUR-ALF  TO PTI-MAS-NUM-TOCC.                  
           MOVE PTI-MAS-ITEM      TO QUE-ITEM.                          
           MOVE QUE-PUT           TO QUE-CMND.                          
           PERFORM GNS-PRO-QUE.                                         
                                                                        
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               PTI-CAI-IPTI IN PTI = MCT-CAI-CINT IN MCT-VARI)          
              MOVE '00' TO FIO-STAT                                     
              GO TO EXT-CRG-PTI-QUE.                                    
      *PVG FIN 29-JUN-2007                                              
           PERFORM KEY-ALL-PTI.                                         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
       EXT-CRG-PTI-QUE.                                                 
           EXIT.                                                        
                                                                        
       CRG-VEC-PTI SECTION.                                             
       INI-CRG-VEC-PTI.                                                 
           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'TVA'                   TO TAB-CIC-TTAB IN TAB.         
           MOVE PTI-COD-TVAL IN PTI     TO TAB-CIC-CTAB IN TAB.         
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           MOVE 'TAB-CIC-TABL'          TO FIO-AKEY.                    
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB     TO WSS-COD-TVAL(WSS-V).         
                                                                        
           MOVE PTI-VAL-MNTO IN PTI TO WSS-VAL-MNTO-NUM(WSS-V).         
           MOVE PTI-NUM-PLZO IN PTI TO WSS-NUM-PLZO-NUM(WSS-V).         
           MOVE PTI-SGV-VPTI IN PTI TO PTI-SGV-VPTI-EDT.                
           MOVE PTI-SGV-VPTI-EDT    TO WSS-SGV-VPTI-ALF(WSS-V).         
                                                                        
           IF PTI-VAL-MNTO IN PTI NOT = WSS-VAL-MNTO-ANT                
              MOVE PTI-VAL-MNTO IN PTI TO WSS-VAL-MNTO-ANT              
              ADD 1                    TO WSS-NUM-COLA.                 
           IF PTI-NUM-PLZO IN PTI NOT = WSS-NUM-PLZO-ANT                
              MOVE PTI-NUM-PLZO IN PTI TO WSS-NUM-PLZO-ANT              
              ADD 1                    TO WSS-NUM-FILA.                 
           MOVE WSS-NUM-FILA TO WSS-NUM-FIL(WSS-V).                     
           MOVE WSS-NUM-COLA TO WSS-NUM-COL(WSS-V).                     
       FIN-CRG-VEC-PTI.                                                 
           EXIT.                                                        
                                                                        
       PUT-PTI-QUE SECTION.                                             
       INI-PUT-PTI-QUE.                                                 
           ADD 1              TO WSS-NITM.                              
           MOVE PTI-NOM-TSPTI TO QUE-COLA.                              
           MOVE PTI-LEN-TSPTI TO QUE-LITM.                              
           MOVE WSS-NITM      TO QUE-NITM.                              
           MOVE SPACES        TO QUE-ITEM.                              
           MOVE PTI-ITEM      TO QUE-ITEM.                              
           MOVE QUE-PUT  TO QUE-CMND.                                   
           PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-PTI-QUE.                                                 
           EXIT.                                                        
                                                                        
       CLR-PTI-ITEM SECTION.                                            
       INI-CLR-PTI-ITEM.                                                
           MOVE ZEROES TO WSS-V.                                        
       LUP-CLR-PTI-ITEM.                                                
           ADD 1 TO WSS-V.                                              
           IF WSS-V > WSS-VMAX                                          
              GO TO FIN-CLR-PTI-ITEM.                                   
           MOVE SPACES TO WSS-COD-TVAL(WSS-V).                          
           MOVE ZEROES TO WSS-VAL-MNTO-NUM(WSS-V),                      
                          WSS-NUM-PLZO-NUM(WSS-V),                      
                          WSS-SGV-VPTI-NUM(WSS-V)                       
                          WSS-NUM-FIL(WSS-V),                           
                          WSS-NUM-COL(WSS-V).                           
           GO TO LUP-CLR-PTI-ITEM.                                      
       FIN-CLR-PTI-ITEM.                                                
           MOVE ZEROES TO WSS-V.                                        
       EXT-CLR-PTI-ITEM.                                                
           EXIT.                                                        
                                                                        
      *PVG INI 29-JUN-2007 TRF                                          
       LEE-TRF-PTI SECTION.                                             
       INI-LEE-TRF-PTI.                                                 
           MOVE PTI-IIC-IPTI  IN PTI      TO QUE-COLA.                  
           MOVE MCT-LEN-TSMCT IN MCT-VARI TO QUE-LITM.                  
           MOVE +2                        TO QUE-NITM.                  
           MOVE QUE-GET                   TO QUE-CMND.                  
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE '00'     TO FIO-STAT                                 
              MOVE FIO-STAT TO PGM-STAT-PTI                             
              MOVE QUE-ITEM TO MCT-DAT-I IN MCT-VARI                    
           ELSE                                                         
              MOVE '23'     TO FIO-STAT                                 
              MOVE FIO-STAT TO PGM-STAT-PTI                             
              GO TO EXT-LEE-TRF-PTI.                                    
                                                                        
           MOVE ZEROES TO MCT-TM IN MCT-VARI.                           
           MOVE ZEROES TO MCT-P  IN MCT-VARI.                           
           PERFORM LEE-VAL-I VARYING MCT-P IN MCT-VARI FROM 1 BY 1      
             UNTIL ((MCT-P IN MCT-VARI > MCT-PMAX IN MCT-VARI) OR       
                    (MCT-VAL-MNTO-I(MCT-P IN MCT-VARI) NOT > ZEROES)).  
       EXT-LEE-TRF-PTI.                                                 
           MOVE PTI-IIC-IPTI IN PTI TO QUE-COLA.                        
           MOVE QUE-DEL             TO QUE-CMND.                        
           PERFORM GNS-PRO-QUE.                                         
       FIN-LEE-TRF-PTI.                                                 
           EXIT.                                                        
       LEE-VAL-I SECTION.                                               
       INI-LEE-VAL-I.                                                   
           ADD 1       TO MCT-TM IN MCT-VARI.                           
           MOVE ZEROES TO MCT-SGV-TFIN(MCT-TM IN MCT-VARI).             
           MOVE MCT-VAL-MNTO-I(MCT-P IN MCT-VARI) TO                    
                MCT-VAL-MNTO(MCT-TM IN MCT-VARI).                       
           MOVE MCT-NUM-PLZO-I(MCT-P IN MCT-VARI) TO                    
                MCT-NUM-PLZO(MCT-TM IN MCT-VARI).                       
           ADD MCT-SGV-TASA-I(MCT-P IN MCT-VARI) TO                     
                MCT-SGV-TFIN(MCT-TM IN MCT-VARI).                       
       FIN-LEE-VAL-IA.                                                  
           EXIT.                                                        
       CLR-VEC-IA SECTION.                                              
       INI-CLR-VEC-IA.                                                  
           MOVE ZEROES TO MCT-VAL-MNTO-I(MCT-P IN MCT-VARI).            
           MOVE ZEROES TO MCT-NUM-PLZO-I(MCT-P IN MCT-VARI).            
           MOVE ZEROES TO MCT-SGV-TASA-I(MCT-P IN MCT-VARI).            
       FIN-CLR-VEC-IA.                                                  
           EXIT.                                                        
       PUT-TRF-PTI SECTION.                                             
       INI-PUT-TRF-PTI.                                                 
           MOVE PTI-CAI-IPTI IN PTI-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE PTI-IIC-IPTI IN PTI-FLD TO PTI-IIC-IPTI IN PTI.         
                                                                        
           MOVE MCT-VAL-MNTO(MCT-P IN MCT-VARI) TO PTI-VAL-MNTO IN PTI. 
           MOVE MCT-NUM-PLZO(MCT-P IN MCT-VARI) TO PTI-NUM-PLZO IN PTI. 
           MOVE ZEROES                          TO PTI-SGV-VPTI IN PTI. 
           ADD  MCT-SGV-TFIN(MCT-P IN MCT-VARI) TO PTI-SGV-VPTI IN PTI. 
                                                                        
           MOVE 'X01'  TO PTI-COD-TVAL IN PTI.                          
           MOVE ZEROES TO PTI-STP-ITRN IN PTI.                          
           MOVE 'I'    TO PTI-MSC-TACC IN PTI.                          
           MOVE 'A'    TO PTI-MSC-STAT IN PTI.                          
           MOVE SPACES TO PTI-COD-OTRN IN PTI.                          
           MOVE SPACES TO PTI-COD-ATRN IN PTI.                          
           MOVE SPACES TO PTI-GLS-FLAG IN PTI.                          
           MOVE SPACES TO PTI-GLS-DISP IN PTI.                          
                                                                        
           MOVE '00'     TO FIO-STAT.                                   
           MOVE FIO-STAT TO PGM-STAT-PTI.                               
       FIN-PUT-TRF-PTI.                                                 
           EXIT.                                                        
      *PVG FIN 29-JUN-2007                                              
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY GNSBGHOY.
                                                                        
       ELI-ALL-PTI SECTION.                                             
       INI-ELI-ALL-PTI.                                                 
           MOVE PTI-CAI-IPTI IN PTI-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE PTI-IIC-IPTI IN PTI-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE SPACES                  TO PTI-COD-TVAL IN PTI.         
           MOVE ZEROES                  TO PTI-VAL-MNTO IN PTI.         
           MOVE ZEROES                  TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-NLS             TO FIO-CMND.                    
           PERFORM MC2-FIO-PTI.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              PTI-CAI-IPTI IN PTI-FLD = PTI-CAI-IPTI IN PTI AND         
              PTI-IIC-IPTI IN PTI-FLD = PTI-IIC-IPTI IN PTI)            
              GO TO FIN-ELI-ALL-PTI.                                    
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM MC2-FIO-PTI.                                         
           IF FIO-STAT-OKS                                              
              MOVE FIO-DEL TO FIO-CMND                                  
              PERFORM MC2-FIO-PTI                                       
              IF NOT FIO-STAT-OKS                                       
                 GO TO FIN-ELI-ALL-PTI                                  
              ELSE                                                      
                 MOVE FIO-STAT TO PGM-STAT-PTI.                         
                                                                        
           GO TO INI-ELI-ALL-PTI.                                       
       FIN-ELI-ALL-PTI.                                                 
           EXIT.                                                        
      *>>>>
*% END
