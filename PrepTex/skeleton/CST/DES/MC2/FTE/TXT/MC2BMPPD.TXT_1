*%! Codigo adicional para archivo
*% IF FIN_PUT_PPD_PPD
      *<<<< FIN_PUT_PPD_PPD
           IF PPD-COD-SIST IN PPD-FLD > SPACES
              MOVE WSS-TAB                  TO TAB-COD-SIST
              MOVE WSS-SIS                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-SIST IN PPD-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-SIST IN PPD-FLD.
           IF PPD-COD-EVEN IN PPD-FLD > SPACES
              MOVE WSS-TAB                  TO TAB-COD-SIST
              MOVE WSS-EVT                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-SIST IN PPD-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE PPD-COD-EVEN IN PPD-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EVEN IN PPD-FLD.
           IF PPD-IND-VIGE IN PPD-FLD > SPACES
              MOVE WSS-GNS                  TO TAB-COD-SIST
              MOVE WSS-STT                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-IND-VIGE IN PPD-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-VIGE IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-VIGE IN PPD-FLD.
           IF PPD-COD-VCOC IN PPD-FLD > SPACES
              MOVE WSS-TAB                 TO TAB-COD-SIST
              MOVE WSS-VLR                 TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-VCOC IN PPD-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN PPD-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-VCOC IN PPD-FLD.
           MOVE WSS-TAB             TO TAB-COD-SIST.
           MOVE WSS-DPL             TO TAB-COD-TTAB IN TAB.
           MOVE PPD-CIC-ICIC IN PPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-COD-PPD1 IN PPD-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-COD-PPD2 IN PPD-FLD.
      *>>>>
*% END
*% IF FIN_CLR_KEY_PPD
      *<<<< FIN_CLR_KEY_PPD
           MOVE ZEROES TO PPD-HRA-HINI IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_SIST
      *<<<< PPD_COD_SIST
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB                 TO TAB-COD-SIST.
           MOVE WSS-SIS                 TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-SIST IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE SPACES       TO FRM-GLS-SIST IN PPD-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN PPD-FLD.
      *>>>> 
*% END
*% IF FIN_PPD_IND_TPLT
      *<<<< FIN_PPD_IND_TPLT
           IF PPD-IND-TPLT IN PPD-FLD NOT > SPACES
              MOVE WSS-P TO PPD-IND-TPLT IN PPD-FLD
              GO TO FIN-VAL-PPD-IND-TPLT.
           MOVE WSS-TAB                  TO TAB-COD-SIST.
           MOVE WSS-TDP                  TO TAB-COD-TTAB IN TAB.
           MOVE PPD-IND-TPLT IN PPD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE WSS-GNS      TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN2
              MOVE WSS-TAB      TO MSG-COD-SIST
              MOVE WSS-ERRTDP   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF PPD-IND-TPLT IN PPD-FLD NOT = WSS-P
              MOVE WSS-TAB      TO MSG-COD-SIST
              MOVE WSS-ERRTDP   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_PPD_FEC_FINI
      *<<<< INI_PPD_FEC_FINI                                         
           MOVE FEC-VHBL-N TO FEC-VHBL.                              
           MOVE FEC-CHOY-N TO FEC-CHOY.                              
           IF SCR-CMND = WSS-ING OR WSS-MOD OR WSS-VRF OR WSS-ACA           
              MOVE FEC-CHOY-GE TO FEC-CHOY.                          
                                                                     
           IF PPD-FEC-FINI IN PPD-FLD NOT > ZEROES                   
              PERFORM GET-FHOY                                       
              MOVE HOY-DHOY IN HOY-VARI TO PPD-NUM-DINI IN PPD-FLD   
              MOVE HOY-MHOY IN HOY-VARI TO PPD-NUM-MINI IN PPD-FLD   
              MOVE HOY-SHOY IN HOY-VARI TO PPD-NUM-SINI IN PPD-FLD   
              MOVE HOY-AHOY IN HOY-VARI TO PPD-NUM-AINI IN PPD-FLD   
              IF PPD-HRA-HINI IN PPD-FLD NOT > ZEROES                
                 MOVE HOY-HHOY IN HOY-VARI TO PPD-HRA-HINI IN PPD-FLD
                 GO TO FIN-VAL-PPD-FEC-FINI                          
              ELSE                                                   
                 GO TO FIN-VAL-PPD-FEC-FINI.                         
      *>>>>
*% END
*% IF PPD_HRA_HINI
      *<<<< PPD_HRA_HINI                                      
           IF PPD-HRA-HINI IN PPD-FLD NOT > ZEROES                
              PERFORM GET-FHOY
              MOVE HOY-HHOY IN HOY-VARI TO PPD-HRA-HINI IN PPD-FLD
              GO TO FIN-VAL-PPD-HRA-HINI.
                                                                  
           MOVE PPD-HRA-HINI IN PPD-FLD TO PPD-HRA-HINI IN PPD.   
           IF PPD-NUM-HHIN IN PPD < ZEROES OR      
              PPD-NUM-HHIN IN PPD > WSS-23             
               MOVE WSS-TAB         TO MSG-COD-SIST  
               MOVE WSS-NUMHHTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
           IF PPD-NUM-MMIN IN PPD < ZEROES OR      
              PPD-NUM-MMIN IN PPD > WSS-59             
               MOVE WSS-TAB         TO MSG-COD-SIST          
               MOVE WSS-NUMMMTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
           IF PPD-NUM-SSIN IN PPD < ZEROES OR      
              PPD-NUM-SSIN IN PPD > WSS-59             
               MOVE WSS-TAB         TO MSG-COD-SIST          
               MOVE WSS-NUMSSTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
      *>>>> 
*% END
*% IF PPD_COD_VCOC
      *<<<< PPD_COD_VCOC
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB                 TO TAB-COD-SIST.
           MOVE WSS-VLR                 TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-VCOC IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE SPACES       TO FRM-GLS-VCOC IN PPD-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN PPD-FLD.
      *>>>>
*% END
*% IF FRM_COD_PPD1
      *<<<< FRM_COD_PPD1
           IF FRM-COD-PPD1 IN PPD-FLD NOT > SPACES
               MOVE WSS-TAB        TO MSG-COD-SIST
               MOVE WSS-GLSDES1OBL TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-PPD1.
      *>>>>
*% END
*% IF PPD_COD_RENO
      *<<<< PPD_COD_RENO
      *VAL-COD Valida codigo de tabla
           MOVE WSS-GNS TO TAB-COD-SIST.
           MOVE WSS-SON TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-RENO IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-RENO IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RENO IN PPD-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-RENO IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_ENDO
      *<<<< PPD_COD_ENDO
      *VAL-COD Valida codigo de tabla
           MOVE WSS-GNS TO TAB-COD-SIST.
           MOVE WSS-SON TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-ENDO IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-ENDO IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ENDO IN PPD-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-ENDO IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_VAL_CMAX
      *<<<< PPD_VAL_CMAX
           IF PPD-VAL-CMAX IN PPD-FLD < PPD-VAL-CMIN IN PPD-FLD
      *        captacion maxima >= captacion minima
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-CMAXCMIN TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF PPD_COD_BCTI
      *<<<< PPD_COD_BCTI
           MOVE WSS-V TO PPD-COD-BCTI IN PPD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB TO TAB-COD-SIST.
           MOVE WSS-BCT TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-BCTI IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-BCTI IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-BCTI IN PPD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-BCTI IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_IND_PMIN
      *<<<< PPD_IND_PMIN
           IF ( PPD-NUM-PMIN IN PPD-FLD > ZEROES AND
              PPD-IND-PMIN IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-PMIN IN PPD-FLD NOT > ZEROES AND
              PPD-IND-PMIN IN PPD-FLD > SPACES )
      *        plazo minimo inconsistente
               MOVE WSS-DAP      TO MSG-COD-SIST
               MOVE WSS-PMINMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB  TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-PMIN IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-IND-PMIN IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PMIN IN PPD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PMIN IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_PBTI
      *<<<< PPD_COD_PBTI
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB TO TAB-COD-SIST.
           MOVE WSS-PBT TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-PBTI IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-PBTI IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PBTI IN PPD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-PBTI IN PPD-FLD.           
      *>>>>
*% END
*% IF PPD_IND_PMAX
      *<<<< PPD_IND_PMAX
           MOVE SPACES TO MSG-COD-MENS.
           IF ( PPD-NUM-PMAX IN PPD-FLD > ZEROES AND
              PPD-IND-PMAX IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-PMAX IN PPD-FLD NOT > ZEROES AND
              PPD-IND-PMAX IN PPD-FLD > SPACES )
      *        plazo maximo inconsistente
               MOVE WSS-PMAXMALO TO MSG-COD-MENS
               GO TO ERR-PPD-IND-PMAX.

           IF ( PPD-NUM-PMIN IN PPD-FLD > ZEROES AND
                PPD-NUM-PMAX IN PPD-FLD > ZEROES )
               PERFORM VAL-PMIN-PMAX.

       ERR-PPD-IND-PMAX.
           IF MSG-COD-MENS > SPACES
               MOVE WSS-DAP TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-PMAX IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-IND-PMAX IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PMAX IN PPD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PMAX IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_SPBT
      *<<<< PPD_COD_SPBT
           MOVE WSS-S TO PPD-COD-SPBT IN PPD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB TO TAB-COD-SIST.
           MOVE WSS-MCT TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-SPBT IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-SPBT IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SPBT IN PPD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-SPBT IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_NUM_VMAX
      *<<<< PPD_NUM_VMAX
           IF PPD-NUM-VMAX IN PPD-FLD < PPD-NUM-VMIN IN PPD-FLD
      *        vmax debe ser >= vmin
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-VMAXVMIN TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF PPD_COD_CVTI
      *<<<< PPD_COD_CVTI
           IF PPD-COD-CVTI IN PPD-FLD > SPACES
               MOVE WSS-I                   TO WSS-GLS-CVTI IN WSS-VARI
               MOVE PPD-COD-CVTI IN PPD-FLD TO WSS-CDG-CVTI IN WSS-VARI
               MOVE PPD-COD-PBTI IN PPD-FLD TO WSS-COD-PBTI IN WSS-VARI
               MOVE WSS-CVTI IN WSS-VARI    TO TAB-COD-CTAB IN TAB
               MOVE WSS-TAB TO TAB-COD-SIST
               MOVE WSS-VLR TO TAB-COD-TTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = WSS-CODNEX
      *        CVTI inexistente
                   MOVE WSS-DAP     TO MSG-COD-SIST
                   MOVE WSS-CVTINEX TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF PPD_IND_SMNV
      *<<<< PPD_IND_SMNV
           IF ( PPD-NUM-SMNV IN PPD-FLD > ZEROES AND
              PPD-IND-SMNV IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-SMNV IN PPD-FLD NOT > ZEROES AND
              PPD-IND-SMNV IN PPD-FLD > SPACES )
      *        separacion minima inconsistente
               MOVE WSS-DAP      TO MSG-COD-SIST
               MOVE WSS-SMNVMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-SMNV.

           IF PPD-NUM-VMAX IN PPD-FLD = WSS-1 AND
              ( PPD-NUM-SMNV IN PPD-FLD > ZEROES  OR
                PPD-IND-SMNV IN PPD-FLD > SPACES )
               MOVE WSS-DAP TO MSG-COD-SIST
      *        separacion minima vctos debe estar en blanco
               MOVE WSS-SMNVBLKOBL TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB  TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-SMNV IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-IND-SMNV IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SMNV IN PPD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SMNV IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_TFPR
      *<<<< PPD_COD_TFPR
           IF PPD-COD-CVTI IN PPD-FLD NOT > SPACES AND
              PPD-COD-TFPR IN PPD-FLD > SPACES
      *       TFPR inconsistente con CVTI
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-TFPRBLKOBL TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-COD-TFPR.

           IF PPD-COD-CVTI IN PPD-FLD > SPACES AND
              PPD-COD-TFPR IN PPD-FLD NOT > SPACES
      *       tfpr debe tener valor
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-TFPRCVTIINC TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-COD-TFPR.

           IF PPD-COD-CVTI IN PPD-FLD > SPACES
                MOVE WSS-TAB TO TAB-COD-SIST
                MOVE WSS-TPR TO TAB-CIC-TTAB IN TAB
                MOVE WSS-F   TO TAB-CIC-CTAB IN TAB
                MOVE WSS-TABCICTABL TO FIO-AKEY
                PERFORM BUS-TAB
                IF TAB-COD-CTAB IN TAB NOT = PPD-COD-TFPR IN PPD-FLD
      *       tfpr debe ser 'F' para tasa variable
                   MOVE WSS-DAP      TO MSG-COD-SIST
                   MOVE WSS-TFPRFOBL TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-PPD-COD-TFPR.

           IF PPD-COD-CVTI IN PPD-FLD > SPACES AND
              PPD-NUM-VMAX IN PPD-FLD > WSS-1  AND
              PPD-COD-TFPR IN PPD-FLD = WSS-C
      *       tfpr debe ser 'F' para > 1 y cvti > spaces
              MOVE WSS-DAP      TO MSG-COD-SIST
              MOVE WSS-TFPRFOBL TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-COD-TFPR.

      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB TO TAB-COD-SIST.
           MOVE WSS-TPR TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-TFPR IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PPD_IND_SMXV
      *<<<< PPD_IND_SMXV
           IF ( PPD-NUM-SMXV IN PPD-FLD > ZEROES AND
              PPD-IND-SMXV IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-SMXV IN PPD-FLD NOT > ZEROES AND
              PPD-IND-SMXV IN PPD-FLD > SPACES )
      *        separacion maxima inconsistente
               MOVE WSS-DAP      TO MSG-COD-SIST
               MOVE WSS-SMXVMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-SMXV.

           IF PPD-NUM-VMAX IN PPD-FLD = WSS-1 AND
              ( PPD-NUM-SMXV IN PPD-FLD > ZEROES OR
                PPD-IND-SMXV IN PPD-FLD > SPACES )
      *        separacion maxima vctos debe estar en blanco
               MOVE WSS-DAP        TO MSG-COD-SIST
               MOVE WSS-SMXVBLKOBL TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB  TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-SMXV IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-IND-SMXV IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SMXV IN PPD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SMXV IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_IND_PREP
           IF ( PPD-NUM-PREP IN PPD-FLD > ZEROES AND
              PPD-IND-PREP IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-PREP IN PPD-FLD NOT > ZEROES AND
              PPD-IND-PREP IN PPD-FLD > SPACES )
      *        periodo repacto inconsistente
               MOVE WSS-DAP      TO MSG-COD-SIST
               MOVE WSS-PREPMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PREP.

           IF PPD-COD-CVTI IN PPD-FLD NOT > SPACES AND
              ( PPD-NUM-PREP IN PPD-FLD > ZEROES OR
              PPD-IND-PREP IN PPD-FLD > SPACES )
      *        PREP inconsistente con CVTI
               MOVE WSS-DAP         TO MSG-COD-SIST
               MOVE WSS-PREPCVTIINC TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PREP.

           IF PPD-COD-TFPR IN PPD-FLD = WSS-F AND
              ( PPD-NUM-PREP IN PPD-FLD > ZEROES OR
              PPD-IND-PREP IN PPD-FLD > SPACES )
      *        PREP inconsistente con TFPR
               MOVE WSS-DAP         TO MSG-COD-SIST
               MOVE WSS-PREPTFPRINC TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PREP.

           IF PPD-COD-TFPR IN PPD-FLD = WSS-C AND
              ( PPD-NUM-PREP IN PPD-FLD NOT > ZEROES OR
              PPD-IND-PREP IN PPD-FLD NOT > SPACES )
      *       periodo repacto debe estar con valores
              MOVE WSS-DAP         TO MSG-COD-SIST
              MOVE WSS-TFPRPREPINC TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB  TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-PREP IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
*% END
*% IF PPD_COD_MORE
           IF PPD-COD-RENO IN PPD-FLD = WSS-S AND
              PPD-COD-MORE IN PPD-FLD NOT = WSS-N
      *        modalidad de retiro, debe ser 'N' para doc. renovable
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-MORENOBLRENO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-COD-MORE.

           IF PPD-NUM-VMAX IN PPD-FLD = WSS-1 AND
              PPD-COD-MORE IN PPD-FLD NOT = WSS-N
      *        sin modalidad de retiro, debe ser 'N'
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-MOREMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-COD-MORE.

           IF PPD-NUM-VMAX IN PPD-FLD > WSS-1 AND
              PPD-COD-MORE IN PPD-FLD = WSS-N
      *       dap con retiros,debe ser distinto de 'N'
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-MOREVMAXMALO TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-COD-MORE.

      *VAL-COD Valida codigo de tabla
           MOVE WSS-DAP TO TAB-COD-SIST.
           MOVE WSS-MDR TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-MORE IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
*% END
*% IF PPD_COD_TCDP
      *<<<< PPD_COD_TCDP
      *VAL-COD Valida codigo de tabla
           MOVE WSS-DAP TO TAB-COD-SIST.
           MOVE WSS-TCD TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-TCDP IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PPD_COD_PLPA
      *<<<< PPD_COD_PLPA

           IF PPD-COD-RESC IN PPD-FLD NOT = WSS-N AND
              PPD-COD-PLPA IN PPD-FLD = SPACES
      *       si hay rescate,se debe indicar
      *       hasta cuando se calcula interes
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-PLPARESCINC TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-COD Valida codigo de tabla
           MOVE WSS-DAP TO TAB-COD-SIST.
           MOVE WSS-PPR TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-PLPA IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR
              PPD-COD-PLPA IN PPD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLPA IN PPD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-PLPA IN PPD-FLD.
      *>>>>
*% END
*% IF PPD_COD_RESC
      *<<<< PPD_COD_RESC
      *VAL-COD Valida codigo de tabla
           MOVE WSS-DAP TO TAB-COD-SIST.
           MOVE WSS-CDR TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-RESC IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PPD_IND_VIGC
      *<<<< PPD_IND_VIGC
      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-GNS  TO MSC-COD-SIST.
           MOVE WSS-VIGE TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-VIGC IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF PPD_IND_PLRE
      *<<<< PPD_IND_PLRE
           IF ( PPD-NUM-PLRE IN PPD-FLD > ZEROES AND
              PPD-IND-PLRE IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-PLRE IN PPD-FLD NOT > ZEROES AND
              PPD-IND-PLRE IN PPD-FLD > SPACES )
      *        plazo rescate inconsistente
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-PLREMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PLRE.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-PLRE IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF PPD_COD_GARA
      *<<<< PPD_COD_GARA
      *VAL-COD Valida codigo de tabla
           MOVE WSS-DAP TO TAB-COD-SIST.
           MOVE WSS-GAR TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-GARA IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PPD_IND_PNTE
      *<<<< PPD_IND_PNTE
           IF ( PPD-NUM-PNTE IN PPD-FLD     > ZEROES AND
                PPD-IND-PNTE IN PPD-FLD NOT > SPACES ) OR
              ( PPD-NUM-PNTE IN PPD-FLD NOT > ZEROES AND
                PPD-IND-PNTE IN PPD-FLD     > SPACES )
      *        periodo negociacion tasa especial inconsistente
               MOVE WSS-DAP TO MSG-COD-SIST
               MOVE WSS-PNTEMALO TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PNTE.

           IF PPD-COD-RENO IN PPD-FLD = WSS-N AND
              ( PPD-NUM-PNTE IN PPD-FLD > ZEROES OR
                PPD-IND-PNTE IN PPD-FLD > SPACES )
               MOVE WSS-DAP TO MSG-COD-SIST
      *        periodo neg tasa especial debe estar en blanco
               MOVE WSS-PNTEBLKOBL TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PPD-IND-PNTE.

           IF PPD-COD-RENO IN PPD-FLD = WSS-S AND
              PPD-NUM-PNTE IN PPD-FLD = ZEROES
      *       si es renovable,se debe indicar pnte
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-PNTERENOINC TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-IND-PNTE.

           IF PPD-COD-RENO IN PPD-FLD = WSS-S AND
              PPD-IND-PNTE IN PPD-FLD = SPACES
      *       si es renovable,se debe indicar pnte
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-PNTERENOINC TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-IND-PNTE.

           IF PPD-COD-RENO IN PPD-FLD = WSS-S AND
              PPD-IND-PNTE IN PPD-FLD NOT = WSS-D
      *       si es renovable,se debe indicar pnte en dias
              MOVE WSS-DAP TO MSG-COD-SIST
              MOVE WSS-PNTERENODOBL TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PPD-IND-PNTE.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-TAB  TO MSC-COD-SIST.
           MOVE WSS-IPER TO MSC-COD-TMSC IN MSC.
           MOVE PPD-IND-PNTE IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
*% END
*% IF PPD_COD_AFER
      *<<<< PPD_COD_AFER
      *VAL-COD Valida codigo de tabla
           MOVE WSS-GNS TO TAB-COD-SIST.
           MOVE WSS-SON TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-AFER IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PPD_COD_AACC
      *<<<< PPD_COD_AACC
      *VAL-COD Valida codigo de tabla
           MOVE WSS-GNS TO TAB-COD-SIST.
           MOVE WSS-SON TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-AACC IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF VAL_CON_FLD_PPD
      *<<<< VAL_CON_FLD_PPD
               MOVE WSS-TAB TO TAB-COD-SIST.
               MOVE WSS-INT TO TAB-COD-TTAB IN TAB.
               MOVE PPD-COD-BCTI IN PPD-FLD TO
                                  WSS-INT-COD-BCTI IN WSS-VARI.
               MOVE PPD-COD-PBTI IN PPD-FLD TO
                                  WSS-INT-COD-PBTI IN WSS-VARI
               MOVE WSS-S TO
                                  WSS-INT-COD-BPBT IN WSS-VARI.
               MOVE PPD-COD-SPBT IN PPD-FLD TO
                                  WSS-INT-COD-SPBT IN WSS-VARI.
               MOVE PPD-COD-CVTI IN PPD-FLD TO
                                  WSS-INT-COD-CVTI IN WSS-VARI.
               MOVE PPD-COD-TFPR IN PPD-FLD TO
                                  WSS-INT-COD-TFPR IN WSS-VARI.
               MOVE PPD-NUM-PREP IN PPD-FLD TO
                                  WSS-INT-NUM-PREP IN WSS-VARI.
               MOVE PPD-IND-PREP IN PPD-FLD TO
                                  WSS-INT-IND-PREP IN WSS-VARI.
               MOVE WSS-INTE  IN WSS-VARI    TO TAB-COD-CTAB IN TAB.
               PERFORM VAL-COD.
               IF MSG-COD-MENS = WSS-CODNEX
                   MOVE WSS-DAP TO MSG-COD-SIST
                   MOVE WSS-TINTNEX TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-COD-MENS = WSS-CODNVG
                   MOVE WSS-DAP TO MSG-COD-SIST
                   MOVE WSS-TINTNVG TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF_BU
      *<<<< EOF_BU
      * VALIDACION: PLAZO MINIMO DEBE SER <= PLAZO MAXIMO
       VAL-PMIN-PMAX SECTION.
       INI-VAL-PMIN-PMAX.
      * ICU : 01011991 + PLAZO MIN EN PPD-FLD
           MOVE PPD-IND-PMIN IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE WSS-01011991 TO FEC-FECH.
           MOVE PPD-NUM-PMIN IN PPD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.
           
           MOVE PPD-IND-PMAX IN PPD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE WSS-01011991 TO FEC-FECH.
           MOVE PPD-NUM-PMAX IN PPD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DDOS.
           MOVE FEC-ITM2 TO WSS-NUM-MDOS.
           MOVE FEC-ITM3 TO WSS-NUM-SDOS.
           MOVE FEC-ITM4 TO WSS-NUM-ADOS.

           IF WSS-FEC-FUNO > WSS-FEC-FDOS
      *         DEBE SER: PLAZO MINIMO <= PLAZO MAXIMO
                MOVE WSS-PMINPMAX TO MSG-COD-MENS
                GO TO FIN-VAL-PMIN-PMAX.
       FIN-VAL-PMIN-PMAX.
           EXIT.
      *--------------------------------------------------------
       OBT-CIC-PER SECTION.
       INI-OBT-CIC-PER.
      * OBTIENE CIC DE UN CODIGO DE PERIODO CARGADO EN MSC-COD-CMSC
      * Y LO ENTREGA EN WSS-CIC-PER
           MOVE WSS-TAB                   TO MSC-COD-SIST.
           MOVE WSS-IPER                  TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-CIC-CMSC IN MSC     TO WSS-CIC-PER.
       FIN-OBT-CIC-PER.
           EXIT.
      *--------------------------------------------------------
       SEL-PER SECTION.
       INI-SEL-PER.
      * OBTIENE EN FEC-FECH LA SUMA DE UNA FECHA CARGADA EN FEC-FEC
      * + UN PERIODO ( WSS-CIC-PER Y WSS-NUM-PER )
           IF WSS-CIC-PER = WSS-D
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NDIA
           ELSE
           IF WSS-CIC-PER = WSS-M
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NMES
           ELSE
           IF WSS-CIC-PER = WSS-A
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
       FIN-SEL-PER.
           EXIT.
      *>>>>
*% END
