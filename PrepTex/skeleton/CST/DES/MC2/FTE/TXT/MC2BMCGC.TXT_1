*% IF FIN_FST_KEY_CGC
      *<<<<
           MOVE -1 TO FRM-CAI-PLAT-LEN IN CGC-FLD.                      
      *>>>>
*% END
*% IF FRM_COD_SIST
      *<<<< FRM_COD_SIST                                                
      *VAL-COD Valida codigo de tabla                                   
           IF FRM-COD-SIST IN CGC-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB       
              MOVE FRM-COD-SIST IN CGC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'            
                 MOVE SPACES       TO FRM-GLS-SIST IN CGC-FLD           
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN CGC-FLD.   
      *>>>>                                                             
*% END
*% IF FRM_COD_EVEN
      *<<<< FRM_COD_EVEN                                                
      *VAL-COD Valida codigo de tabla                                   
           IF FRM-COD-EVEN IN CGC-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'EVT'                   TO TAB-COD-TTAB IN TAB       
              MOVE FRM-COD-SIST IN CGC-FLD TO WSS-COD-SITM IN WSS-VARI  
              MOVE FRM-COD-EVEN IN CGC-FLD TO WSS-COD-ENTO IN WSS-VARI  
              MOVE WSS-COD-EVTO IN WSS-VARI TO TAB-COD-CTAB IN TAB      
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'            
                 MOVE SPACES       TO FRM-GLS-EVEN IN CGC-FLD           
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN CGC-FLD.   
      *>>>>                                                             
*% END
*% IF INI_FRM_IND_TPLA
      *<<<<
           IF FRM-IND-TPLA IN CGC-FLD NOT > SPACES                      
              MOVE SPACES TO FRM-IND-TPLA IN CGC-FLD                    
              GO TO FIN-VAL-FRM-IND-TPLA.
      *>>>>                               
      *<<<< SGS_IND_TPLA                                                
      *PVG INI 16-JUN-2009 REFUNDE CONSULTA DE PLANES                   
           IF (FRM-COD-CONC IN CGC-FLD = 'PLN' AND                      
               FRM-IND-TPLA IN CGC-FLD = 'R')                           
               MOVE 'RESUMEN PLN ' TO FRM-GLS-TPLA IN CGC-FLD           
               GO TO FIN-VAL-FRM-IND-TPLA.                              
      *PVG FIN 16-JUN-2009                                              
           MOVE 'TAB'                    TO TAB-COD-SIST.               
           MOVE 'TDP'                    TO TAB-COD-TTAB IN TAB.        
           MOVE FRM-IND-TPLA IN CGC-FLD  TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-TAB.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE 'GNS'        TO MSG-COD-SIST                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC IN MSG TO FRM-MENS                      
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TPLA IN CGC-FLD.      
      *>>>>                                                             
*% END
*% IF FRM_COD_CONC
      *<<<< FRM_COD_CONC                                                
           IF FRM-COD-CONC IN CGC-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-FRM-COD-CONC.                               
           IF FRM-COD-CONC IN CGC-FLD > SPACES                          
              MOVE 'TAB'                    TO TAB-COD-SIST             
              MOVE 'TCP'                    TO TAB-COD-TTAB IN TAB      
              MOVE FRM-COD-CONC IN CGC-FLD  TO TAB-COD-CTAB IN TAB      
              PERFORM VAL-COD                                           
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'            
                  MOVE SPACES       TO FRM-GLS-CONC IN CGC-FLD          
                  MOVE 'TAB'          TO MSG-COD-SIST                   
                  MOVE 'CGCCONCNOIMP' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC IN MSG TO FRM-MENS                  
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
              ELSE                                                      
                  MOVE TAB-GLS-DCOR IN TAB                              
                                   TO FRM-GLS-CONC IN CGC-FLD           
           ELSE                                                         
              MOVE SPACES          TO FRM-GLS-CONC IN CGC-FLD.          
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_PLFN
      *<<<< INI_FRM_FEC_PLFN                                            
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           IF FRM-FEC-PLFN IN CGC-FLD NOT > ZEROES                      
               MOVE '31122099' TO FEC-FECH.                             
                                                                        
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_PLIN
      *<<<< INI_FRM_FEC_PLIN                                            
           MOVE FEC-CHOY-N  TO FEC-CHOY.                                
           IF FRM-FEC-PLIN IN CGC-FLD NOT > ZEROES                      
               MOVE '01011950' TO FEC-FECH.                             
                                                                        
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *>>>>                                                             
*% END
*% IF INI_FRM_COD_ESTA
      *<<<<
           IF FRM-COD-ESTA IN CGC-FLD NOT > SPACES                      
              MOVE SPACES TO FRM-COD-ESTA IN CGC-FLD                    
              GO TO FIN-VAL-FRM-COD-ESTA.  
      *>>>>                             
      *<<<< FRM_COD_ESTA                                                
           MOVE 'GNS'                    TO TAB-COD-SIST.               
           MOVE 'STT'                    TO TAB-COD-TTAB IN TAB.        
           MOVE FRM-COD-ESTA IN CGC-FLD  TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-TAB.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE 'GNS'        TO MSG-COD-SIST                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1                      
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-ESTA IN CGC-FLD.      
      *>>>>                                                             
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC                                                
           IF FRM-COD-VCOC IN CGC-FLD NOT > SPACES                      
              GO TO FIN-VAL-FRM-COD-VCOC.                               
                                                                        
           IF FRM-COD-VCOC IN CGC-FLD > SPACES                          
      *PVG INI 16-JUN-2009                                              
      *      IF NOT (FRM-COD-CONC IN CGC-FLD = 'INT' OR 'PPC')          
             IF NOT (FRM-COD-CONC IN CGC-FLD = 'INT' OR 'PPC' OR 'CCM') 
      *PVG FIN 16-JUN-2009                                              
                 MOVE SPACES         TO FRM-GLS-VCOC IN CGC-FLD         
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'CGCVCOCNOVAL' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR                        
                 GO TO FIN-VAL-FRM-COD-VCOC.                            
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'VLR '                  TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-VCOC IN CGC-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
              MOVE SPACES       TO FRM-GLS-VCOC IN CGC-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN CGC-FLD.     
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_FPLT
      *<<<<
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
                                                                        
           MOVE FEC-CHOY-N  TO FEC-CHOY.                                
                                                                        
      *>>>>
*% END
