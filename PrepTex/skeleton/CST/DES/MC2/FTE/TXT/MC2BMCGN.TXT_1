*%! Codigo adicional para archivo
*% IF FIN_PUT_CGN_CGN
      *<<<< FIN_PUT_CGN_CGN
           IF CGN-COD-SIST IN CGN-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'SIS'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-SIST IN CGN-FLD.
           IF CGN-COD-EVEN IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CGN-COD-EVEN IN CGN-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EVEN IN CGN-FLD.
                                                                        
           MOVE 'MC2'               TO TAB-COD-SIST.                    
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE CGN-CIC-ICGN IN CGN TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CGN-FLD.         
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN CGN-FLD.         
      *>>>>
*% END
*% IF FIN_PUT_DGN_CGN
      *<<<< FIN_PUT_DGN_CGN
           IF DGN-COD-TDOC IN CGN-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'DOC'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-TDOC IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-TDOC IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-TDOC IN CGN-FLD.
           IF DGN-COD-EDOC IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'FCA'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-EDOC IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EDOC IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EDOC IN CGN-FLD.
           IF DGN-COD-OCOB IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'OCS'                    TO TAB-COD-TTAB IN TAB
              MOVE DGN-COD-OCOB IN CGN-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-OCOB IN CGN-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-OCOB IN CGN-FLD.
           IF DGN-IND-UTPT IN CGN-FLD > SPACES
              MOVE 'TAB'                   TO MSC-COD-SIST
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC
              MOVE DGN-IND-UTPT IN CGN-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPT IN CGN-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTPT IN CGN-FLD.
      *>>>>
*% END
*% IF CGN_COD_SIST
      *<<<< CGN_COD_SIST
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE CGN-COD-SIST IN CGN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE SPACES       TO FRM-GLS-SIST IN CGN-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN CGN-FLD.
      *>>>>
*% END
*% IF CGN_COD_EVEN
      *<<<< CGN_COD_EVEN
      *VAL-COD Valida codigo de tabla
           IF CGN-COD-EVEN IN CGN-FLD > SPACES
              MOVE 'MC2'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CGN-COD-SIST IN CGN-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CGN-COD-EVEN IN CGN-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
                 MOVE SPACES       TO FRM-GLS-EVEN IN CGN-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN CGN-FLD.
      *>>>>
*% END
*% IF CGN_IND_TPLT
      *<<<< CGN_IND_TPLT
           IF CGN-IND-TPLT IN CGN-FLD NOT > SPACES
              MOVE 'P'    TO CGN-IND-TPLT IN CGN-FLD
              GO TO FIN-VAL-CGN-IND-TPLT.
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.
           MOVE CGN-IND-TPLT IN CGN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE 'GNS'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE 'ERR    TDP' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_CGN_FEC_FINI
      *<<<< INI_CGN_FEC_FINI
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA')
              MOVE FEC-CHOY-GE TO FEC-CHOY.
             IF CGN-FEC-FINI IN CGN-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO CGN-NUM-DINI IN CGN-FLD
              MOVE HOY-MHOY IN HOY-VARI TO CGN-NUM-MINI IN CGN-FLD
              MOVE HOY-SHOY IN HOY-VARI TO CGN-NUM-SINI IN CGN-FLD
              MOVE HOY-AHOY IN HOY-VARI TO CGN-NUM-AINI IN CGN-FLD
              IF CGN-HRA-HINI IN CGN-FLD NOT > ZEROES
                 MOVE HOY-HHOY IN HOY-VARI TO CGN-HRA-HINI IN CGN-FLD
                 GO TO FIN-VAL-CGN-FEC-FINI
              ELSE
                 GO TO FIN-VAL-CGN-FEC-FINI.
      *>>>>
*% END
*% IF CGN_HRA_HINI
      *<<<< CGN_HRA_HINI
           IF CGN-HRA-HINI IN CGN-FLD NOT > SPACES
MAN           MOVE ZEROES TO CGN-HRA-HINI IN CGN-FLD.                   
      *INI-PENTA
           IF CGN-HRA-HINI IN CGN-FLD IS NOT NUMERIC
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
              GO TO FIN-VAL-CGN-HRA-HINI.                               
      *FIN-PENTA
           IF CGN-HRA-HINI IN CGN-FLD NOT > ZEROES                      
              PERFORM GET-FHOY                                          
              MOVE HOY-HHOY IN HOY-VARI TO CGN-HRA-HINI IN CGN-FLD      
              GO TO FIN-VAL-CGN-HRA-HINI.                               
           MOVE CGN-HRA-HINI IN CGN-FLD TO CGN-HRA-HINI IN CGN.         
           IF CGN-NUM-HHIN IN CGN < ZEROES OR                           
              CGN-NUM-HHIN IN CGN > 23                                  
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
           IF CGN-NUM-MMIN IN CGN < ZEROES OR                           
              CGN-NUM-MMIN IN CGN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
           IF CGN-NUM-SSIN IN CGN < ZEROES OR                           
              CGN-NUM-SSIN IN CGN > 59                                  
               MOVE 'MC2' TO MSG-COD-SIST                               
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CGN-HRA-HINI.                              
      *>>>>
*% END
*% IF DGN_NUM_IDGN
      *<<<< DGN_NUM_IDGN
           IF SCR-CMND = 'MOD'
              IF DGN-NUM-IDGN IN CGN-FLD NOT > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'NUMCGN   OBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DGN-NUM-IDGN.

           MOVE 'N' TO SCR-IND-ELI IN SCR-VARI.
           IF SCR-CMND = 'ELI' AND DGN-NUM-IDGN IN CGN-FLD = 999
              MOVE ZEROES TO DGN-NUM-IDGN IN CGN-FLD
              MOVE 'S'    TO SCR-IND-ELI IN SCR-VARI.
      *>>>>
*% END
*% IF CGN_IND_DSCT
      *<<<< CGN_IND_DSCT
      *VAL-COD Valida codigo de tabla
            MOVE 'GNS'                   TO TAB-COD-SIST.
            MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.
            MOVE CGN-IND-DSCT IN CGN-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
      *>>>>
*% END
*% IF CGN_IND_CAAB
      *<<<< CGN_IND_CAAB
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'MOV'                   TO TAB-COD-TTAB IN TAB.
            MOVE CGN-IND-CAAB IN CGN-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
      *>>>>
*% END
*% IF DGN_COD_TDOC
      *<<<< DGN_COD_TDOC
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'DOC'                   TO TAB-COD-TTAB IN TAB.
            MOVE DGN-COD-TDOC IN CGN-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TDOC IN CGN-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-TDOC IN CGN-FLD.
      *>>>>
*% END
*% IF DGN_COD_EDOC
      *<<<< DGN_COD_EDOC
      *VAL-COD Valida codigo de tabla
            MOVE 'MC2'                   TO TAB-COD-SIST.
            MOVE 'FCA'                   TO TAB-COD-TTAB IN TAB.
            MOVE DGN-COD-EDOC IN CGN-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EDOC IN CGN-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-EDOC IN CGN-FLD.
      *>>>>
*% END
*% IF DGN_COD_OCOB
      *<<<< DGN_COD_OCOB
      *VAL-COD Valida codigo de tabla
            MOVE 'MC2'                   TO TAB-COD-SIST.
            MOVE 'OCS'                   TO TAB-COD-TTAB IN TAB.
            MOVE DGN-COD-OCOB IN CGN-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-OCOB IN CGN-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-OCOB IN CGN-FLD.
      *>>>>
*% END
*% IF DGN_IND_COBL
      *<<<< DGN_IND_COBL
      *VAL-COD Valida codigo de tabla
           IF DGN-IND-COBL IN CGN-FLD > SPACES
              MOVE 'GNS'                   TO TAB-COD-SIST
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
              MOVE DGN-IND-COBL IN CGN-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
           ELSE
              MOVE 'S' TO DGN-IND-COBL IN CGN-FLD.
      *>>>>
*% END
*% IF DGN_SGV_TMBA
      *<<<< DGN_SGV_TMBA
           IF DGN-SGV-TMBA IN CGN-FLD > ZEROES AND                      
              DGN-COD-EDOC IN CGN-FLD = 'INF'                           
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'SGVTMBAINV' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-SGV-TMBA.                               
                                                                        
      *PVG INI 19-ABR-2012
           IF SCR-HDR-MRCA = 'PNT'
              GO TO FIN-VAL-DGN-SGV-TMBA.
      *PVG FIN 19-ABR-2012
           IF DGN-SGV-TMBA IN CGN-FLD NOT > ZEROES                      
              IF (DGN-COD-EDOC IN CGN-FLD = 'FAC' OR 'TAS') OR          
                 (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')  
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'SGVTMBAOBL' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-SGV-TMBA.                            
      *>>>>
*% END
*% IF DGN_COD_VCBA
      *<<<< DGN_COD_VCBA                                                
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'X')                   
              IF (DGN-COD-VCBA IN CGN-FLD > SPACES)                     
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-VCBA                             
              ELSE                                                      
                 GO TO FIN-VAL-DGN-COD-VCBA.                            
                                                                        
           IF (CGN-IND-TPLT IN CGN-FLD = 'M' OR 'Y')                    
              IF (DGN-COD-VCBA IN CGN-FLD = 'P' OR 'M')                 
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-VCBA.                            
                                                                        
           IF DGN-SGV-TMBA IN CGN-FLD > ZEROES AND                      
              DGN-COD-VCBA IN CGN-FLD NOT > SPACES                      
               MOVE 'MC2'       TO MSG-COD-SIST                         
              MOVE 'CODVCOCOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-VCBA.                               
                                                                        
           IF DGN-COD-EDOC IN CGN-FLD = 'INF' AND                       
              DGN-COD-VCBA IN CGN-FLD > SPACES                          
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MON    INV' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCBA.                              
                                                                        
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND                       
              (DGN-COD-VCBA IN CGN-FLD = 'P' OR                         
               DGN-COD-VCBA IN CGN-FLD = 'M')                           
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'MON    NOP' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCBA.                              
                                                                        
           IF (DGN-COD-EDOC IN CGN-FLD = 'TAS' OR 'FAC')                
              IF DGN-COD-VCBA IN CGN-FLD NOT = 'P' AND                  
                 DGN-COD-VCBA IN CGN-FLD NOT = 'M'                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MON    DBP' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-VCBA.                               
                                                                        
           IF DGN-COD-VCBA IN CGN-FLD > SPACES                          
              MOVE 'TAB' TO TAB-COD-SIST                                
              MOVE 'VLR' TO TAB-COD-TTAB IN TAB                         
              MOVE DGN-COD-VCBA IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF DGN_COD_CPBA
      *<<<< DGN_COD_CPBA                                                
           IF DGN-COD-CPBA IN CGN-FLD > SPACES                          
              IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')  
                 MOVE 'MC2'         TO MSG-COD-SIST                     
                 MOVE 'CPTO    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC  TO FRM-MENS                         
                 MOVE FRM-SUAR-MAL  TO FRM-SUAR                         
                 GO TO FIN-VAL-DGN-COD-CPBA.                            
                                                                        
           IF (DGN-COD-EDOC IN CGN-FLD = 'TAS' OR 'FAC')                
              IF DGN-COD-CPBA IN CGN-FLD NOT > SPACES                   
                 MOVE 'MC2'         TO MSG-COD-SIST                     
                 MOVE 'CODCPTOOBL' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-CPBA.                            
                                                                        
           IF (DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'INF')                
              IF DGN-COD-CPBA IN CGN-FLD > SPACES                       
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'CPTO    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-CPBA.                            
                                                                        
           IF DGN-COD-CPBA IN CGN-FLD > SPACES                          
              MOVE 'MC2'                   TO TAB-COD-SIST              
              MOVE 'CTO'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-COD-CPBA IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF DGN_SGV_TMNO
      *<<<< DGN_SGV_TMNO                                                
           IF DGN-SGV-TMNO IN CGN-FLD > ZEROES AND                      
              DGN-COD-EDOC IN CGN-FLD = 'INF'                           
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'SGVTMNOINV' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-SGV-TMNO.                               
                                                                        
      *PVG INI 19-ABR-2012
           IF SCR-HDR-MRCA = 'PNT'
              GO TO FIN-VAL-DGN-SGV-TMNO.
      *PVG FIN 19-ABR-2012
           IF DGN-SGV-TMNO IN CGN-FLD NOT > ZEROES                      
              IF (DGN-COD-EDOC IN CGN-FLD = 'FAC' OR 'TAS')             
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'SGVTMNOOBL' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-SGV-TMNO.                            
      *>>>>                                                             
*% END
*% IF DGN_COD_VCNO
      *<<<< DGN_COD_VCNO                                                
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'X')                   
              IF (DGN-COD-VCNO IN CGN-FLD > SPACES)                     
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-VCNO                             
              ELSE                                                      
                 GO TO FIN-VAL-DGN-COD-VCNO.                            
                                                                        
           IF (CGN-IND-TPLT IN CGN-FLD = 'M' OR 'Y')                    
              IF (DGN-COD-VCNO IN CGN-FLD = 'P' OR 'M')                 
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-VCNO.                            
                                                                        
           IF DGN-SGV-TMNO IN CGN-FLD > ZEROES AND                      
              DGN-COD-VCNO IN CGN-FLD NOT > SPACES                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'CODVCOCOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-VCNO.                               
                                                                        
           IF DGN-SGV-TMNO IN CGN-FLD > ZEROES AND                      
              DGN-COD-VCNO IN CGN-FLD NOT > SPACES                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'CODVCOCOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-VCNO.                               
                                                                        
           IF DGN-COD-EDOC IN CGN-FLD = 'INF' AND                       
              DGN-COD-VCNO IN CGN-FLD > SPACES                          
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MON    INV' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCNO.                              
                                                                        
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND                       
              (DGN-COD-VCNO IN CGN-FLD = 'P' OR                         
               DGN-COD-VCNO IN CGN-FLD = 'M')                           
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'MON    NOP' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCNO.                              
                                                                        
      *PVG INI 19-ABR-2012
           IF SCR-HDR-MRCA NOT = 'PNT'
      *PVG FIN 19-ABR-2012
           IF (DGN-COD-EDOC IN CGN-FLD = 'TAS' OR 'FAC')                
              IF DGN-COD-VCNO IN CGN-FLD NOT = 'P' AND                  
                 DGN-COD-VCNO IN CGN-FLD NOT = 'M'                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MON    DBP' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-VCNO.                               
                                                                        
      *PVG INI 19-ABR-2012
           IF SCR-HDR-MRCA NOT = 'PNT'
      *PVG FIN 19-ABR-2012
           IF DGN-COD-VCNO IN CGN-FLD > SPACES                          
              MOVE 'TAB' TO TAB-COD-SIST                                
              MOVE 'VLR' TO TAB-COD-TTAB IN TAB                         
              MOVE DGN-COD-VCNO IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
*% END
*% IF DGN_COD_CPNO
      *<<<< DGN_COD_CPNO                                                
      *PVG INI 19-ABR-2012
           IF SCR-HDR-MRCA NOT = 'PNT'
      *PVG FIN 19-ABR-2012
           IF (DGN-COD-EDOC IN CGN-FLD = 'TAS' OR 'FAC')                
              IF DGN-COD-CPNO IN CGN-FLD NOT > SPACES                   
                 MOVE 'MC2'         TO MSG-COD-SIST                     
                 MOVE 'CODCPTOOBL' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-CPNO.                            
                                                                        
           IF (DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'INF')                
              IF DGN-COD-CPNO IN CGN-FLD > SPACES                       
                 MOVE 'MC2'        TO MSG-COD-SIST                      
                 MOVE 'CPTO    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-COD-CPNO.                            
                                                                        
           IF DGN-COD-CPNO IN CGN-FLD > SPACES                          
              MOVE 'MC2'                   TO TAB-COD-SIST              
              MOVE 'CTO'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-COD-CPNO IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF DGN_COD_VCMT
      *<<<< DGN_COD_VCMT                                                
           IF (DGN-COD-VCMT IN CGN-FLD = 'P' OR 'M')                    
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'MON    NOP' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCMT.                              
                                                                        
           IF DGN-VAL-MTOP IN CGN-FLD > ZEROES AND                      
              DGN-COD-VCMT IN CGN-FLD NOT > SPACES                      
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'CODVTOPOBL' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCMT.                              
                                                                        
           IF DGN-VAL-MTOP IN CGN-FLD NOT > ZEROES AND                  
              DGN-COD-VCMT IN CGN-FLD > SPACES                          
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'CODVTOPNVL' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-COD-VCMT.                              
                                                                        
           IF DGN-COD-VCMT IN CGN-FLD > SPACES                          
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-COD-VCMT IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF DGN_COD_CPMT
      *<<<< DGN_COD_CPMT                                                
           IF DGN-VAL-MTOP IN CGN-FLD > ZEROES AND                      
              DGN-COD-CPMT IN CGN-FLD NOT > SPACES                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'CODCPTTOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-CPMT.                               
                                                                        
           IF DGN-VAL-MTOP IN CGN-FLD NOT > ZEROES AND                  
              DGN-COD-CPMT IN CGN-FLD > SPACES                          
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'CODCPTTNVL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-CPMT.                               
                                                                        
           IF DGN-COD-CPMT IN CGN-FLD > SPACES                          
              MOVE 'MC2'                    TO TAB-COD-SIST             
              MOVE 'CTO'                    TO TAB-COD-TTAB IN TAB      
              MOVE DGN-COD-CPMT IN CGN-FLD  TO TAB-COD-CTAB IN TAB      
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF DGN_IND_UTPT
      *<<<< DGN_IND_UTPT
           IF DGN-NUM-PTOP IN CGN-FLD > ZEROES AND
              DGN-IND-UTPT IN CGN-FLD NOT > SPACES
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE 'INDUTPZOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DGN-IND-UTPT.

           IF DGN-NUM-PTOP IN CGN-FLD NOT > ZEROES AND
              DGN-IND-UTPT IN CGN-FLD > SPACES
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE 'INDUTPZNVL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DGN-IND-UTPT.

           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE DGN-IND-UTPT IN CGN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF DGN_VAL_VMIN
      *<<<< DGN_VAL_VMIN
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND
              DGN-VAL-VMIN IN CGN-FLD > ZEROES
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'VMIN    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DGN-VAL-VMIN.

           IF ((DGN-COD-VMYM IN CGN-FLD = 'P' OR 'M') AND
            ( DGN-VAL-VMIN IN CGN-FLD < ZEROES OR
              DGN-VAL-VMIN IN CGN-FLD > 100 ))
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'MNTO PORC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DGN-VAL-VMIN.
      *>>>>
*% END
*% IF DGN_VAL_VMAX
      *<<<< DGN_VAL_VMAX                                                
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND                       
              DGN-VAL-VMAX IN CGN-FLD > ZEROES                          
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'VMAX    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-VAL-VMAX.                               
                                                                        
           IF ((DGN-COD-VMYM IN CGN-FLD = 'P' OR 'M') AND               
            ( DGN-VAL-VMAX IN CGN-FLD < ZEROES OR                       
              DGN-VAL-VMAX IN CGN-FLD > 100 ))                          
              MOVE 'MC2'       TO MSG-COD-SIST                          
              MOVE 'MNTO PORC' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-VAL-VMAX.                               
                                                                        
           IF DGN-VAL-VMAX IN CGN-FLD < DGN-VAL-VMIN IN CGN-FLD         
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'MNTOMAX<MIN' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-VAL-VMAX.                               
      *>>>>                                                             
*% END
*% IF DGN_COD_VMYM
      *<<<< DGN_COD_VMYM
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND
              DGN-COD-VMYM IN CGN-FLD > SPACES
              MOVE 'MC2'         TO MSG-COD-SIST
              MOVE 'VMYM    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DGN-COD-VMYM.

           IF ( DGN-VAL-VMIN IN CGN-FLD > ZEROES OR
                DGN-VAL-VMAX IN CGN-FLD > ZEROES ) AND
                DGN-COD-VMYM IN CGN-FLD NOT > SPACES
               MOVE 'MC2'        TO MSG-COD-SIST
               MOVE 'CODVMYMOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DGN-COD-VMYM.

           IF DGN-COD-VMYM IN CGN-FLD NOT > SPACES
               GO TO FIN-VAL-DGN-COD-VMYM.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE DGN-COD-VMYM IN CGN-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_CLR_KEY_CGN
      *>>>>
           MOVE ZEROES TO CGN-HRA-HINI IN CGN-FLD.                      
      *<<<<
*% END
*% IF INI_FST_FLD_CGN
      *>>>>
           IF SCR-CMND NOT = 'ING'                                      
              MOVE -1           TO FRM-GLS-DES1-LEN IN CGN-FLD          
              GO TO FIN-FST-FLD-CGN.                                    
           IF FRM-GLS-DES1 IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES1-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES2-ATR IN CGN-FLD          
           ELSE                                                         
      *<<<<
*% END
*% IF FIN_FST_FLD_CGN
      *>>>>
           IF CGN-IND-DSCT IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-DSCT-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-DSCT-LEN IN CGN-FLD.         
           IF CGN-IND-CAAB IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-CAAB-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-CAAB-LEN IN CGN-FLD.         
           IF CGN-COD-CTAN IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-COD-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-EXT-CTAN-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-COD-CTAN-LEN IN CGN-FLD.         
           IF CGN-IND-RBHB IN CGN-FLD > SPACES                          
              MOVE FRM-CPIM-AEY TO CGN-IND-RBHB-ATR IN CGN-FLD          
           ELSE                                                         
              MOVE -1           TO CGN-IND-RBHB-LEN IN CGN-FLD.         
           IF FRM-GLS-DES1 IN CGN-FLD > SPACES AND                      
              CGN-IND-DSCT IN CGN-FLD > SPACES AND                      
              CGN-IND-CAAB IN CGN-FLD > SPACES AND                      
              CGN-COD-CTAN IN CGN-FLD > SPACES AND                      
              CGN-IND-RBHB IN CGN-FLD > SPACES                          
              MOVE -1           TO DGN-COD-TDOC-LEN IN CGN-FLD.         
      *<<<<
*% END
*% IF FIN_UNP_CGN_CGN
      *<<<<
           IF CGN-IND-TPLT IN CGN-FLD NOT = 'P'                         
              MOVE FRM-CPIM-AEY TO CGN-COD-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-EXT-CTAN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO CGN-IND-RBHB-ATR IN CGN-FLD.         
      *>>>>
*% END
*% IF FIN_UNP_DGN_CGN
      *<<<<
           IF CGN-IND-TPLT IN CGN-FLD NOT = 'P'                         
              MOVE FRM-CPIM-AEY TO DGN-COD-EDOC-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-OCOB-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-COBL-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-MIVA-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPBA-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPNO-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-BCTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-PBTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-BPBT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-SPBT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CVTI-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-TFPR-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-PREP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-MSC-UTPR-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-UCOB-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-NDOC-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-MTOP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-VCMT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-CPMT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-NUM-PTOP-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-UTPT-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-VMIN-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-VAL-VMAX-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-COD-VMYM-ATR IN CGN-FLD          
              MOVE FRM-CPIM-AEY TO DGN-IND-ACAL-ATR IN CGN-FLD.         
      *>>>>                                                             
*% END
*% IF INI_CGN_IIC_GNOT
      *<<<<
           IF CGN-IIC-GNOT IN CGN-FLD NOT > SPACES                      
              MOVE SPACES TO CGN-IIC-GNOT IN CGN-FLD.                   
      *PVG INI 29-DIC-2005                                              
           MOVE 'TAB'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'NOT'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CGN-CAI-GNOT IN CGN-FLD TO CGN-CAI-GNOT IN CGN.         
           MOVE CGN-IIC-GNOT IN CGN-FLD TO CGN-IIC-GNOT IN CGN.         
           MOVE CGN-CIC-GNOT IN CGN     TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CGN-FLD       
              MOVE SPACES              TO FRM-GLS-DES2 IN CGN-FLD.      
      *PVG FIN 29-DIC-2005                                              
           GO TO FIN-VAL-CGN-IIC-GNOT.
      *>>>>
*% END
*% IF INI_FRM_GLS_SIST
      *<<<<
           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.       
           MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CGN-IND-TPLT IN CGN-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'                
              MOVE TAB-CIC-CTAB IN TAB     TO WSS-GLS-TPLT IN WSS-VARI  
           ELSE                                                         
              MOVE CGN-IND-TPLT IN CGN-FLD TO WSS-CIC-TPLT IN WSS-VARI. 
      *>>>>
*% END
*% IF CGN_IND_RBHB
      *<<<< CGN_IND_RBHB                                                
      *VAL-COD Valida codigo de tabla                                   
           IF CGN-IND-RBHB IN CGN-FLD > SPACES                          
              MOVE 'GNS'                   TO TAB-COD-SIST              
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB       
              MOVE CGN-IND-RBHB IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
*% IF INI_DGN_COD_EDOC
      *<<<< INI_DGN_COD_EDOC                                            
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
              IF DGN-COD-EDOC IN CGN-FLD > SPACES                       
                 MOVE 'MC2'          TO MSG-COD-SIST                    
                 MOVE 'EDOC     INV' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR                        
                 GO TO FIN-VAL-DGN-COD-EDOC                             
              ELSE                                                      
                 GO TO FIN-VAL-DGN-COD-EDOC.                            
      *>>>>                                                             
*% END
*% IF INI_DGN_COD_OCOB
      *<<<< INI_DGN_COD_OCOB                                            
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
              IF DGN-COD-OCOB IN CGN-FLD > SPACES                       
                 MOVE 'MC2'          TO MSG-COD-SIST                    
                 MOVE 'OCOB     INV' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR                        
                 GO TO FIN-VAL-DGN-COD-OCOB                             
              ELSE                                                      
                 GO TO FIN-VAL-DGN-COD-OCOB.                            
      *>>>>                                                             
*% END
*% IF DGN_IND_MIVA
      *<<<< DGN_IND_MIVA                                                
      *VAL-COD Valida codigo de tabla                                   
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
              IF DGN-IND-MIVA IN CGN-FLD > SPACES                       
                 MOVE 'MC2'         TO MSG-COD-SIST                     
                 MOVE 'MIVA    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DGN-IND-MIVA                             
              ELSE                                                      
                 GO TO FIN-VAL-DGN-IND-MIVA                             
           ELSE                                                         
           IF DGN-IND-MIVA IN CGN-FLD > SPACES                          
              MOVE 'GNS'                   TO TAB-COD-SIST              
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-IND-MIVA IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD                                           
           ELSE                                                         
              MOVE 'N' TO DGN-IND-MIVA IN CGN-FLD.                      
      *>>>>                                                             
*% END
*% IF DGN_MSC_BCTI
      *<<<< DGN_MSC_BCTI                                                
           IF DGN-MSC-BCTI IN CGN-FLD NOT > SPACES AND                  
              DGN-MSC-PBTI IN CGN-FLD NOT > SPACES AND                  
              DGN-MSC-BPBT IN CGN-FLD NOT > SPACES AND                  
              DGN-MSC-SPBT IN CGN-FLD NOT > SPACES AND                  
              DGN-COD-EDOC IN CGN-FLD = 'TAS'                           
              MOVE 'MC2'                   TO TAB-COD-SIST              
              MOVE 'OCS'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-COD-OCOB IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF TAB-CIC-CTAB IN TAB NOT = 'FLT'                        
      *ASUME VENCIDA-MENSUAL-SIMPLE-SIMPLE                              
                 MOVE 'V' TO DGN-MSC-BCTI IN CGN-FLD                    
                 MOVE 'M' TO DGN-MSC-PBTI IN CGN-FLD                    
                 MOVE 'S' TO DGN-MSC-BPBT IN CGN-FLD                    
                 MOVE 'S' TO DGN-MSC-SPBT IN CGN-FLD.                   
                                                                        
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF') AND  
                DGN-MSC-BCTI IN CGN-FLD > SPACES)                       
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'BCTI    INV' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               GO TO FIN-VAL-DGN-MSC-BCTI.                              
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-BCTI IN CGN-FLD > SPACES)                       
               MOVE 'MC2'         TO MSG-COD-SIST                       
               MOVE 'BCTI    INV' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               GO TO FIN-VAL-DGN-MSC-BCTI.                              
                                                                        
           IF DGN-MSC-BCTI IN CGN-FLD NOT > SPACES AND                  
              DGN-COD-EDOC IN CGN-FLD = 'TAS'                           
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MSCBCTIOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-BCTI.                               
                                                                        
      *VAL-IND Valida miscelaneo de tabla                               
           IF DGN-MSC-BCTI IN CGN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-BCTI IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_MSC_PBTI
      *<<<< DGN_MSC_PBTI                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-MSC-PBTI IN CGN-FLD > SPACES)                   
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'PBTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-PBTI.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-PBTI IN CGN-FLD > SPACES)                       
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'PBTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-PBTI.                               
                                                                        
           IF DGN-MSC-PBTI IN CGN-FLD NOT > SPACES AND                  
              DGN-COD-EDOC IN CGN-FLD = 'TAS'                           
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MSCPBTIOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-PBTI.                               
                                                                        
      *VAL-IND Valida miscelaneo de tabla                               
           IF DGN-MSC-PBTI IN CGN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-PBTI IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_MSC_BPBT
      *<<<< DGN_MSC_BPBT                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-MSC-BPBT IN CGN-FLD > SPACES )                  
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'BPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-BPBT.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-BPBT IN CGN-FLD > SPACES)                       
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'BPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-BPBT.                               
                                                                        
           IF DGN-MSC-BPBT IN CGN-FLD NOT > SPACES AND                  
              DGN-COD-EDOC IN CGN-FLD = 'TAS'                           
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MSCBPBTOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-BPBT.                               
                                                                        
      *VAL-IND Valida miscelaneo de tabla                               
           IF DGN-MSC-BPBT IN CGN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-BPBT IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_MSC_SPBT
      *<<<< DGN_MSC_SPBT                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-MSC-SPBT IN CGN-FLD > SPACES)                   
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'SPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-SPBT.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-SPBT IN CGN-FLD > SPACES)                       
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'SPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-SPBT.                               
                                                                        
           IF DGN-MSC-SPBT IN CGN-FLD NOT > SPACES AND                  
              DGN-COD-EDOC IN CGN-FLD = 'TAS'                           
               MOVE 'MC2'        TO MSG-COD-SIST                        
               MOVE 'MSCSPBTOBL' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DGN-MSC-SPBT.                              
                                                                        
      *VAL-IND Valida miscelaneo de tabla                               
           IF DGN-MSC-SPBT IN CGN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-SPBT IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_COD_CVTI
      *<<<< DGN_COD_CVTI                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-COD-CVTI IN CGN-FLD > SPACES)                   
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'CVTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-CVTI.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-COD-CVTI IN CGN-FLD > SPACES)                       
              MOVE 'MC2' TO MSG-COD-SIST                                
              MOVE 'CVTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-COD-CVTI.                               
                                                                        
           IF DGN-COD-CVTI IN CGN-FLD NOT > SPACES                      
               GO TO FIN-VAL-DGN-COD-CVTI.                              
                                                                        
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.         
           MOVE 'I'                     TO WSS-COD-TVTI.                
           MOVE DGN-COD-CVTI IN CGN-FLD TO WSS-COD-CVTI.                
           MOVE DGN-MSC-PBTI IN CGN-FLD TO WSS-COD-TCTI.                
           MOVE WSS-COD-VCAM            TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF DGN_MSC_TFPR
      *<<<< DGN_MSC_TFPR                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-MSC-TFPR IN CGN-FLD > SPACES)                   
              MOVE 'MC2' TO MSG-COD-SIST                                
              MOVE 'TFPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-TFPR.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-TFPR IN CGN-FLD > SPACES)                       
              MOVE 'MC2' TO MSG-COD-SIST                                
              MOVE 'TFPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-TFPR.                               
                                                                        
      *VAL-IND Valida miscelaneo de tabla                               
           IF DGN-MSC-TFPR IN CGN-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'TFPR'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-TFPR IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_NUM_PREP
      *<<<< DGN_NUM_PREP                                                
           IF DGN-COD-EDOC IN CGN-FLD = 'MFI' AND                       
              DGN-NUM-PREP IN CGN-FLD > ZEROES                          
              MOVE 'MC2' TO MSG-COD-SIST                                
              MOVE 'PREP    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-NUM-PREP.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-NUM-PREP IN CGN-FLD > ZEROES)                       
              MOVE 'MC2' TO MSG-COD-SIST                                
              MOVE 'PREP    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-NUM-PREP.                               
      *>>>>                                                             
*% END
*% IF DGN_MSC_UTPR
      *<<<< DGN_MSC_UTPR                                                
           IF ((DGN-COD-EDOC IN CGN-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DGN-MSC-UTPR IN CGN-FLD > SPACES)                   
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'UTPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTPR.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DGN-MSC-UTPR IN CGN-FLD > SPACES)                       
              MOVE 'MC2'         TO MSG-COD-SIST                        
              MOVE 'UTPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTPR.                               
                                                                        
           IF DGN-NUM-PREP IN CGN-FLD > ZEROES AND                      
              DGN-MSC-UTPR IN CGN-FLD NOT > SPACES                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MSCUTPROBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTPR.                               
                                                                        
           IF DGN-NUM-PREP IN CGN-FLD NOT > ZEROES AND                  
              DGN-MSC-UTPR IN CGN-FLD > SPACES                          
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'MSCUTPROBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTPR.                               
           IF DGN-MSC-UTPR IN CGN-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-UTPR IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_MSC_UTVD
      *<<<< DGN_MSC_UTVD                                                
           IF DGN-NUM-VIGD IN CGN-FLD > ZEROES AND                      
              DGN-MSC-UTVD IN CGN-FLD NOT > SPACES                      
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'INDUTPZOBL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTVD.                               
                                                                        
           IF DGN-NUM-VIGD IN CGN-FLD NOT > ZEROES AND                  
              DGN-MSC-UTVD IN CGN-FLD > SPACES                          
              MOVE 'MC2'        TO MSG-COD-SIST                         
              MOVE 'INDUTPZNVL' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DGN-MSC-UTVD.                               
                                                                        
           IF DGN-MSC-UTVD IN CGN-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE DGN-MSC-UTVD IN CGN-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND.                                          
      *>>>>                                                             
*% END
*% IF DGN_IND_ACAL
      *<<<< DGN_IND_ACAL                                                
      *VAL-COD Valida codigo de tabla                                   
           IF DGN-IND-ACAL IN CGN-FLD NOT > SPACES                      
              MOVE 'GNS'                   TO TAB-COD-SIST              
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB       
              MOVE DGN-IND-ACAL IN CGN-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.                                          
      *>>>>                                                             
*% END
