*%! Codigo adicional para archivo
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "MC2ZQPDM"
*% ELSE
*% CLRMFC = "MC2ZUPDM"
*% END
*% PGM_PTC = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03  SCR-VARI-PFS.
               05  SCR-DPD-KEY-IDPD.
                   07 SCR-DPD-CIC-IDPD              PIC X(12).
                   07 SCR-DPD-NUM-IDPD              PIC 9(03).
           03  SCR-UMOD-PDM            VALUE SPACES PIC X(14).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGCIC.
       COPY MC2BRDPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DPD-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
*% IF PGM_PQ
       COPY TABBROFI.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.        
       COPY MC2BRPLN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PLN-REQA==.
*% END 
       COPY MC2WGDPD.
       COPY MC2WXDPD.
       01  WSS-VARI.
           03 WSS-COD-MENY        VALUE SPACES          PIC X(12).
           03 WSS-COD-MENN        VALUE SPACES          PIC X(12).
           03 WSS-K               VALUE ZEROES          PIC 9(03).
           03 WSS-R               VALUE ZEROES          PIC 9(03).
           03 WSS-L               VALUE ZEROES          PIC 9(03).
           03 WSS-RDPD            VALUE ZEROES          PIC 9(03).

*% IF PGM_PQ
           03 WSS-COD-CAUX.
              05 WSS-COD-TOOC                           PIC X(03).
              05 WSS-COD-AOOC                           PIC X(03).
*% END 
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO DPD-COD-TERM
                MOVE TSK-TERM-ALF TO DPD-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO DPD-COD-TERM
                MOVE EIBTRMID     TO DPD-COD-TERM-MAS.
*% IF PGM_PU
      *    CARGA VALORES POR DEFECTO DESDE TABLA PDM BASE
           MOVE 'N'   TO VRF-PDM-PLBR IN PDM-VARI.
           MOVE 'N'   TO VRF-PDM-PDCC IN PDM-VARI.
           MOVE 'N'   TO VRF-PDM-PDCG IN PDM-VARI.

           MOVE 100   TO VRF-PDM-IMAX IN PDM-VARI.
           MOVE 'LBR' TO VRF-PDM-ILBR IN PDM-VARI.
           MOVE 'CLT' TO VRF-PDM-IDCC IN PDM-VARI.
           MOVE 'GRP' TO VRF-PDM-IDCG IN PDM-VARI.

           MOVE 'MC2'       TO TAB-COD-SIST FIO-SIST.
           MOVE 'PDM'       TO TAB-COD-TTAB IN TAB.
           MOVE SPACES      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INI.
           IF (TAB-COD-DAT3 IN TAB(1) > SPACES   AND
               TAB-COD-DAT3 IN TAB(1) IS NUMERIC AND
               TAB-COD-DAT3 IN TAB(1) NOT > 100)
              MOVE TAB-COD-DAT3 IN TAB(1) TO VRF-PDM-IMAX IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(2) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(2) TO VRF-PDM-ILBR IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(3) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(3) TO VRF-PDM-IDCC IN PDM-VARI.
           IF TAB-COD-DAT3 IN TAB(4) > SPACES
              MOVE TAB-COD-DAT3 IN TAB(4) TO VRF-PDM-IDCG IN PDM-VARI.
*% END
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
              MOVE 'I' TO PDM-IND-VIGE IN PDM-FLD.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           MOVE PDM-STP-ITRN IN PDM TO SCR-UMOD-PDM.
           IF NOT FIO-STAT-OKS
              GO TO DPD-FND-KEY.
           IF SCR-CMND = 'CON'
              GO TO DPD-FND-KEY.
      *
           IF (PDM-MSC-STAT IN PDM = 'D' AND SCR-CMND NOT = 'CON')
               MOVE 'S' TO SCR-IERR
               MOVE 'PDM    ANLYA' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.
           IF (PDM-MSC-STAT IN PDM = 'A' AND SCR-CMND NOT = 'ANL')
               MOVE 'S' TO SCR-IERR
               MOVE 'PDM    ACAYA' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.
           IF (PDM-MSC-STAT IN PDM = 'V' AND SCR-CMND = 'ANL')
               MOVE 'S' TO SCR-IERR
               MOVE 'PDM    ACANO' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.
           IF SCR-CMND = 'VRF'
              IF (PDM-MSC-STAT IN PDM = 'I' OR 'M')
                  GO TO DPD-FND-KEY
              ELSE
                  MOVE 'S' TO SCR-IERR
                  MOVE 'CMN      INV' TO MSG-COD-MENS
                  GO TO MSG-FND-KEY.
           IF SCR-CMND = 'ACA'
              IF PDM-MSC-STAT IN PDM = 'V'
                 GO TO DPD-FND-KEY
              ELSE
                 MOVE 'S' TO SCR-IERR
                 MOVE 'CMN      INV' TO MSG-COD-MENS
                 GO TO MSG-FND-KEY.
           IF SCR-CMND = 'ANL'
              IF PDM-MSC-STAT IN PDM = 'A'
                 GO TO DPD-FND-KEY
              ELSE
                 MOVE 'S' TO SCR-IERR
                 MOVE 'CMN      INV' TO MSG-COD-MENS
                 GO TO MSG-FND-KEY.
           IF SCR-CMND = 'ELI'
              IF (PDM-MSC-STAT IN PDM = 'I' OR 'M' OR 'V')
                  GO TO DPD-FND-KEY
              ELSE
                  MOVE 'S' TO SCR-IERR
                  MOVE 'CMN      INV' TO MSG-COD-MENS
                  GO TO MSG-FND-KEY.
           GO TO DPD-FND-KEY.
       MSG-FND-KEY.
           MOVE 'MC2'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
       DPD-FND-KEY.
           IF ((NOT FIO-STAT-OKS) AND (SCR-CCPP NOT = 'ING'))
              GO TO FIN-FND-KEY.
           IF SCR-CCPP = 'ING'
              PERFORM BUS-COR-DPD
              GO TO CON-FND-KEY.

           IF SCR-CMND = 'CON'
              MOVE PGM-STAT-PDM TO PGM-STAT-DPD
              GO TO CNT-FND-KEY.

           IF DPD-NUM-IDPD IN PDM-FLD NOT > ZEROES
              PERFORM BUS-COR-DPD
              GO TO CNT-FND-KEY.

           MOVE PDM-CIC-IPDM IN PDM     TO DPD-CIC-IDPD IN DPD.
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           IF FIO-STAT-OKS AND SCR-CMND = 'ELI'
              MOVE DPD-STP-ITRN IN DPD TO SCR-UMOD.
       CNT-FND-KEY.
           IF PGM-STAT-DPD-OKS AND SCR-CMND = 'CON'
              IF SCR-OFRM-SRV
                 PERFORM CRG-MTI-DPD
              ELSE
                 PERFORM CRG-FRM-DPD.
            MOVE PGM-STAT-DPD TO FIO-STAT.
       CON-FND-KEY.
           IF MSG-COD-MENS > SPACES
              MOVE '23' TO FIO-STAT
              GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF PGM-STAT-PDM-OKS
              MOVE DPD-KEY-IDPD IN DPD TO SCR-DPD-KEY-IDPD
              IF SCR-CMND = 'ELI'
               MOVE DPD-STP-ITRN IN DPD TO SCR-UMOD.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           MOVE 'M' TO PDM-MSC-STAT IN PDM.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-MOD.
           MOVE PDM-CIC-IPDM IN PDM     TO DPD-CIC-IDPD IN DPD.
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'ERRUPD   DPD' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           PERFORM RET-STT-DPD.
           PERFORM RET-DPD-PDM.
           PERFORM RET-HDR-DPD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           MOVE 'MC2'               TO FIO-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.

           MOVE FRM-GLS-DES1 IN PDM-FLD TO TAB-GLS-DESC IN TAB.
           MOVE FRM-GLS-DES2 IN PDM-FLD TO TAB-GLS-DATA IN TAB.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           IF DPD-NUM-IDPD IN PDM-FLD > 1
              MOVE '00' TO FIO-STAT
              GO TO CNT-CMN-ING.
           PERFORM OBT-CIC-PDM.
           IF CIC-STAT NOT = CIC-STAT-OKS
              GO TO FIN-CMN-ING.
           MOVE CIC-CAI-ICIC IN CIC TO PDM-CAI-IPDM IN PDM.
           MOVE CIC-IIC-ICIC IN CIC TO PDM-IIC-IPDM IN PDM.
           MOVE CIC-CIC-ICIC IN CIC TO PDM-CIC-IPDM IN PDM-FLD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
       CNT-CMN-ING.
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ING.
           PERFORM RET-STT-DPD.
           PERFORM KEY-DPD-PDM.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           PERFORM RET-DPD-PDM.
           PERFORM RET-HDR-DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-STAT TO PGM-STAT-PDM PGM-STAT-DPD
              GO TO FIN-CMN-ING.

           IF DPD-NUM-IDPD IN PDM-FLD = 1
              MOVE 'MC2'                   TO FIO-SIST
              MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB
              MOVE DPD-CIC-IDPD IN DPD     TO TAB-COD-CTAB IN TAB
              MOVE FRM-GLS-DES1 IN PDM-FLD TO TAB-GLS-DESC IN TAB
              MOVE FRM-GLS-DES2 IN PDM-FLD TO TAB-GLS-DATA IN TAB
              MOVE 'I'                     TO TAB-MSC-TACC IN TAB
              MOVE 'I'                     TO TAB-MSC-STAT IN TAB
              MOVE 'S'                     TO TAB-IND-VIGE IN TAB
              MOVE SPACES                  TO TAB-COD-OTRN IN TAB
              MOVE 'MC2PUPDM'              TO TAB-COD-ATRN IN TAB
              MOVE DPD-CAI-IDPD IN DPD     TO TAB-GLS-DCOR IN TAB
              MOVE DPD-IIC-IDPD IN DPD     TO TAB-GLS-ABRV IN TAB
              PERFORM GET-FHOY
              MOVE HOY-FHOY                TO TAB-FEC-FTRN IN TAB
              MOVE HOY-HHOY                TO TAB-HRA-HRTR IN TAB
              MOVE SCR-OTRN                TO TAB-COD-OTRN IN TAB
              MOVE SCR-USER                TO TAB-COD-ATRN IN TAB
              MOVE FIO-PUT TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 MOVE 'MC2'                TO MSG-COD-SIST
                 MOVE 'DPL    NOGRB'       TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC         TO FRM-MENS
                 GO TO FIN-CMN-ING.

      *MODIFICA ESTADO PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-CMN-ING.
           PERFORM RET-STT-PDM.
           PERFORM RET-HDR-PDM.
           PERFORM RET-ALL-PDM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'VRF'
               PERFORM PRO-CMN-VRF
               IF MSG-COD-MENS IN MSG > SPACES
                  GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
      *    PERFORM RET-ALL-PDM.
      *<<<< CMN_ACC
           IF SCR-CMND = 'VRF'
               MOVE 'V'          TO PDM-IND-VIGE IN PDM
               MOVE 'VRFYES    ' TO WSS-COD-MENY
               MOVE 'VRFNOT    ' TO WSS-COD-MENN
           ELSE
           IF SCR-CMND = 'ACA'
               MOVE 'A'          TO PDM-IND-VIGE IN PDM
               MOVE 'ACAYES    ' TO WSS-COD-MENY
               MOVE 'ACANOT    ' TO WSS-COD-MENN
           ELSE
           IF SCR-CMND = 'ANL'
               MOVE 'D'          TO PDM-IND-VIGE IN PDM
               MOVE 'ANLYES    ' TO WSS-COD-MENY
               MOVE 'ANLNOT    ' TO WSS-COD-MENN.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
               MOVE 'S' TO SCR-IERR
               MOVE 'MC2' TO MSG-COD-SIST
               MOVE WSS-COD-MENN TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE WSS-COD-MENY  TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.

           IF SCR-CMND NOT = 'ANL'
              GO TO FIN-CMN-ACC.
           MOVE 'MC2' TO FIO-SIST.
           MOVE 'DPL' TO TAB-COD-TTAB IN TAB.
           MOVE PDM-CIC-IPDM IN PDM TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS
                 PERFORM GET-FHOY
                 MOVE HOY-FHOY TO TAB-FEC-FTRN IN TAB
                 MOVE HOY-HHOY TO TAB-HRA-HRTR IN TAB
                 MOVE SCR-OTRN TO TAB-COD-OTRN IN TAB
                 MOVE SCR-USER TO TAB-COD-ATRN IN TAB
                 MOVE 'N'      TO TAB-IND-VIGE IN TAB
                 MOVE FIO-MOD  TO FIO-CMND
                 PERFORM GNS-FIO-TAB
                 IF NOT FIO-STAT-OKS
                    MOVE 'ERROR UPD DPL' TO FRM-MEN2
                 ELSE
                    NEXT SENTENCE
              ELSE
                 MOVE 'ERROR UPD DPL' TO FRM-MEN2
           ELSE
              MOVE 'ERROR UPD DPL' TO FRM-MEN2.
           GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-PDM.
           GO TO CNT-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
      *<<<< FIN_CMN_ELI
           MOVE FIO-STAT TO PGM-STAT-PDM.
       CNT-CMN-ELI.
           IF FRM-IND-SGTE IN PDM-FLD = 'S'
              PERFORM ELI-ALL-PDM
              GO TO FIN-CMN-ELI.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF FIO-STAT-OKS AND
              DPD-STP-ITRN IN DPD NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ELI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-ELI.

           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF (FIO-STAT-OKS AND
               DPD-CIC-IDPD IN DPD = PDM-CIC-IPDM IN PDM-FLD)
              MOVE PGM-STAT-DPD TO FIO-STAT
              PERFORM MOD-STAT-PDM
              GO TO FIN-CMN-ELI.

           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-CMN-ELI.
           MOVE 'MC2'               TO FIO-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-CMN-ELI.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF FIN_CMN_ELI
*% END
*% IF EOF
      *<<<< EOF
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        

       COPY MC2BFDPD.
       COPY GNSBGVSM.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBTAB.
       COPY GNSBVMSC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBFMSC.                                                   
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ

       COPY TABBFOFI.
       COPY TABBVOFI.
       COPY MC2BFPLN.

       BUS-COR-DPD SECTION.
       INI-BUS-COR-DPD.
           MOVE PDM-CIC-IPDM IN PDM TO PDM-CIC-IPDM IN PDM-FLD.
           MOVE PDM-CIC-IPDM IN PDM TO DPD-CIC-IDPD IN DPD.
           MOVE 999                 TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           IF NOT ( FIO-STAT-OKS AND
               PDM-CIC-IPDM IN PDM = DPD-CIC-IDPD IN DPD )
               PERFORM KEY-ALL-PDM
               MOVE ZEROES TO DPD-NUM-IDPD IN DPD
           ELSE
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM MC2-FIO-DPD
               IF SCR-CMND = 'ELI' AND DPD-NUM-IDPD IN PDM-FLD > ZEROES
                  MOVE DPD-STP-ITRN IN DPD TO SCR-UMOD.

           IF SCR-CCPP = 'ING'
              ADD 1                    TO DPD-NUM-IDPD IN DPD
              MOVE DPD-NUM-IDPD IN DPD TO DPD-NUM-IDPD IN PDM-FLD
              MOVE '23' TO FIO-STAT
              IF DPD-NUM-IDPD IN PDM-FLD > 1
                 MOVE 'MC2'               TO TAB-COD-SIST
                 MOVE 'DPL'               TO TAB-COD-TTAB IN TAB
                 MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN PDM-FLD
                 MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN PDM-FLD
                 MOVE '23' TO FIO-STAT.
       FIN-BUS-COR-DPD.
           EXIT.

       SCRL-TAB-PDM SECTION.
       INI-SCRL-TAB-PDM.
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM SCRL-TAB-PDM-PF5
               GO TO FIN-SCRL-TAB-PDM.
           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM SCRL-TAB-PDM-PF6
               GO TO FIN-SCRL-TAB-PDM.
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM SCRL-TAB-PDM-PF7
               GO TO FIN-SCRL-TAB-PDM.
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM SCRL-TAB-PDM-PF8
               GO TO FIN-SCRL-TAB-PDM.
       FIN-SCRL-TAB-PDM.
           EXIT.



       SCRL-TAB-PDM-PF5 SECTION.
       INI-SCRL-TAB-PDM-PF5.
      *<<<<
           IF FRM-NUM-IDPD IN PDM-FLD(01) NOT > 1
              MOVE 'TAB    NOPRV' TO MSG-COD-MENS
              GO TO MSG-SCRL-TAB-PDM-PF5.
           MOVE 8 TO DPD-J.
           MOVE SCR-DPD-CIC-IDPD            TO DPD-CIC-IDPD IN DPD.
           MOVE FRM-NUM-IDPD IN PDM-FLD(01) TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD)
              MOVE 'TABCURRNEX' TO MSG-COD-MENS
              GO TO MSG-SCRL-TAB-PDM-PF5.
       LUP-SCRL-TAB-PDM-PF5.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND 
                   DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD)
              IF DPD-J NOT > ZEROES
                 MOVE 'TAB    NOPRV' TO MSG-COD-MENS
                 GO TO MSG-SCRL-TAB-PDM-PF5
              ELSE 
                 GO TO FIN-SCRL-TAB-PDM-PF5.
           IF DPD-J = 8
              PERFORM CLR-FRM-DPD.
           SUBTRACT 1 FROM DPD-J.
           IF DPD-J NOT > ZEROES
              GO TO FIN-SCRL-TAB-PDM-PF5.
           MOVE DPD-NUM-IDPD IN DPD TO FRM-NUM-IDPD IN PDM-FLD(DPD-J).
           MOVE DPD-NUM-PRIO IN DPD TO FRM-NUM-PRIO IN PDM-FLD(DPD-J).
           MOVE DPD-COD-PRIO IN DPD TO FRM-COD-PRIO IN PDM-FLD(DPD-J).
           IF FRM-COD-PRIO IN PDM-FLD(DPD-J) > SPACES
              MOVE 'MC2' TO TAB-COD-SIST
              MOVE 'PDM' TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-PRIO IN PDM-FLD(DPD-J) TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DPRI IN PDM-FLD(DPD-J)
           ELSE
              MOVE SPACES             TO FRM-GLS-DPRI IN PDM-FLD(DPD-J).
       NXT-SCRL-TAB-PDM-PF5.
           GO TO LUP-SCRL-TAB-PDM-PF5.
       MSG-SCRL-TAB-PDM-PF5.
           MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
      *>>>>
       FIN-SCRL-TAB-PDM-PF5.
           EXIT.

       SCRL-TAB-PDM-PF6 SECTION.
       INI-SCRL-TAB-PDM-PF6.
      *<<<<
           IF FRM-NUM-IDPD IN PDM-FLD(07) NOT > ZEROES
              MOVE 'TAB    NONXT' TO MSG-COD-MENS
              GO TO MSG-SCRL-TAB-PDM-PF6.
           MOVE ZEROES TO DPD-J.
           MOVE SCR-DPD-CIC-IDPD            TO DPD-CIC-IDPD IN DPD.
           MOVE FRM-NUM-IDPD IN PDM-FLD(07) TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD)
              MOVE 'TABCURRNEX' TO MSG-COD-MENS
              GO TO MSG-SCRL-TAB-PDM-PF6.
       LUP-SCRL-TAB-PDM-PF6.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND 
                   DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD)
              IF DPD-J NOT > ZEROES
                 MOVE 'TAB    NONXT' TO MSG-COD-MENS
                 GO TO MSG-SCRL-TAB-PDM-PF6
              ELSE 
                 GO TO FIN-SCRL-TAB-PDM-PF6.
           IF DPD-J = 0
              PERFORM CLR-FRM-DPD.
           ADD 1 TO DPD-J.
           IF DPD-J > DPD-JMAX
              GO TO FIN-SCRL-TAB-PDM-PF6.
           MOVE DPD-NUM-IDPD IN DPD TO FRM-NUM-IDPD IN PDM-FLD(DPD-J).
           MOVE DPD-NUM-PRIO IN DPD TO FRM-NUM-PRIO IN PDM-FLD(DPD-J).
           MOVE DPD-COD-PRIO IN DPD TO FRM-COD-PRIO IN PDM-FLD(DPD-J).
           IF FRM-COD-PRIO IN PDM-FLD(DPD-J) > SPACES
              MOVE 'MC2' TO TAB-COD-SIST
              MOVE 'PDM' TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-PRIO IN PDM-FLD(DPD-J) TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DPRI IN PDM-FLD(DPD-J)
           ELSE
              MOVE SPACES             TO FRM-GLS-DPRI IN PDM-FLD(DPD-J).
       NXT-SCRL-TAB-PDM-PF6.
           GO TO LUP-SCRL-TAB-PDM-PF6.
       MSG-SCRL-TAB-PDM-PF6.
           MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
      *>>>>
       FIN-SCRL-TAB-PDM-PF6.
           EXIT.

       SCRL-TAB-PDM-PF7 SECTION.
       INI-SCRL-TAB-PDM-PF7.
           MOVE SCR-DPD-KEY-IDPD TO DPD-KEY-IDPD IN DPD.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT ( FIO-STAT-OKS AND
                    DPD-KEY-IDPD IN DPD = SCR-DPD-KEY-IDPD)
               MOVE 'TABCURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-PDM-PF7.
       PRV-SCRL-TAB-PDM-PF7.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT ( FIO-STAT-OKS AND
                    DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD )
               MOVE 'TAB    NOPRV' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-PDM-PF7.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           PERFORM KEY-PDM-PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.

           MOVE SPACES TO PDM-CAI-PRIO IN PDM-FLD.
           MOVE SPACES TO PDM-IIC-PRIO IN PDM-FLD.
           MOVE SPACES TO PDM-COD-CPTO IN PDM-FLD.
           MOVE SPACES TO PDM-IND-TPLT IN PDM-FLD.
           MOVE SPACES TO PDM-COD-TCNL IN PDM-FLD.
           MOVE SPACES TO PDM-COD-CNAL IN PDM-FLD.
           MOVE SPACES TO PDM-COD-VCOC IN PDM-FLD.
           MOVE SPACES TO PDM-COD-TOOC IN PDM-FLD.
           MOVE SPACES TO PDM-COD-AOOC IN PDM-FLD.
           MOVE SPACES TO FRM-COD-GRPO IN PDM-FLD.
           MOVE ZEROES TO PDM-FEC-FINI IN PDM-FLD.
           MOVE ZEROES TO PDM-HRA-HINI IN PDM-FLD.
           MOVE ZEROES TO DPD-NUM-IDPD IN PDM-FLD.
           MOVE SPACES TO PDM-CIC-IPDM IN PDM-FLD.
           MOVE SPACES TO FRM-IND-SGTE IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-DES1 IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-DES2 IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-PRIO IN PDM-FLD.
           PERFORM PUT-SCR.
           GO TO FIN-SCRL-TAB-PDM-PF7.
       MSG-SCRL-TAB-PDM-PF7.
           MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-PDM-PF7.
           EXIT.

       SCRL-TAB-PDM-PF8 SECTION.
       INI-SCRL-TAB-PDM-PF8.
           MOVE SCR-DPD-KEY-IDPD TO DPD-KEY-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT ( FIO-STAT-OKS AND
                    DPD-KEY-IDPD IN DPD = SCR-DPD-KEY-IDPD)
               MOVE 'TABCURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-PDM-PF8.
       NXT-SCRL-TAB-PDM-PF8.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT ( FIO-STAT-OKS AND
                    DPD-CIC-IDPD IN DPD = SCR-DPD-CIC-IDPD )
               MOVE 'TAB    NONXT' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-PDM-PF8.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           PERFORM KEY-PDM-PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.

           MOVE SPACES TO PDM-CAI-PRIO IN PDM-FLD.
           MOVE SPACES TO PDM-IIC-PRIO IN PDM-FLD.
           MOVE SPACES TO PDM-COD-CPTO IN PDM-FLD.
           MOVE SPACES TO PDM-IND-TPLT IN PDM-FLD.
           MOVE SPACES TO PDM-COD-TCNL IN PDM-FLD.
           MOVE SPACES TO PDM-COD-CNAL IN PDM-FLD.
           MOVE SPACES TO PDM-COD-VCOC IN PDM-FLD.
           MOVE SPACES TO PDM-COD-TOOC IN PDM-FLD.
           MOVE SPACES TO PDM-COD-AOOC IN PDM-FLD.
           MOVE SPACES TO FRM-COD-GRPO IN PDM-FLD.
           MOVE ZEROES TO PDM-FEC-FINI IN PDM-FLD.
           MOVE ZEROES TO PDM-HRA-HINI IN PDM-FLD.
           MOVE ZEROES TO DPD-NUM-IDPD IN PDM-FLD.
           MOVE SPACES TO PDM-CIC-IPDM IN PDM-FLD.
           MOVE SPACES TO FRM-IND-SGTE IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-DES1 IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-DES2 IN PDM-FLD.
           MOVE SPACES TO FRM-GLS-PRIO IN PDM-FLD.

           PERFORM PUT-SCR.
           GO TO FIN-SCRL-TAB-PDM-PF8.
       MSG-SCRL-TAB-PDM-PF8.
           MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-PDM-PF8.
           EXIT.
           
       CRG-MTI-DPD SECTION.
       INI-CRG-MTI-DPD.
           MOVE DPD-NOM-TSDPD TO QUE-COLA.
           MOVE QUE-DEL       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE DPD-NOM-TSDPD-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE ZEROES TO DPD-NITM.
           MOVE ZEROES TO DPD-J.
           IF FRM-IND-SGTE IN PDM-FLD = 'S'
              MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD
              ADD 1                        TO DPD-NUM-IDPD IN DPD.
                                                                        
           MOVE PDM-CIC-IPDM IN PDM TO DPD-CIC-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CRG-MTI-DPD.
           PERFORM MC2-FIO-DPD.
           MOVE FIO-STAT TO PGM-STAT-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM = DPD-CIC-IDPD IN DPD)
              GO TO EXT-CRG-MTI-DPD.

           ADD 1 TO DPD-NITM.
           IF DPD-NITM > DPD-NITM-MAX
              GO TO EXT-CRG-MTI-DPD.

           MOVE ZEROES              TO WSS-MTI-NUM-IDPD.
           MOVE ZEROES              TO WSS-MTI-NUM-PRIO.
           MOVE SPACES              TO WSS-MTI-COD-PRIO.
           MOVE SPACES              TO WSS-MTI-GLS-DPRI.

           MOVE DPD-NUM-IDPD IN DPD TO WSS-MTI-NUM-IDPD.
           MOVE DPD-NUM-PRIO IN DPD TO WSS-MTI-NUM-PRIO.
           MOVE DPD-COD-PRIO IN DPD TO WSS-MTI-COD-PRIO.
           IF WSS-MTI-COD-PRIO > SPACES
              MOVE 'MC2'               TO TAB-COD-SIST
              MOVE 'PDM'               TO TAB-COD-TTAB IN TAB
              MOVE WSS-MTI-COD-PRIO    TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-MTI-GLS-DPRI
           ELSE
              MOVE SPACES              TO WSS-MTI-GLS-DPRI.

           PERFORM PUT-DPD-QUE.

       NXT-CRG-MTI-DPD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CRG-MTI-DPD.
       EXT-CRG-MTI-DPD.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.

      *    LECTURA CONSULTADO INICIAL                   
           MOVE PDM-CIC-IPDM IN PDM     TO DPD-CIC-IDPD IN DPD.         
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.         
           IF DPD-NUM-IDPD IN DPD NOT > ZEROES                          
              MOVE 1 TO DPD-NUM-IDPD IN DPD.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-DPD.                                         
           MOVE FIO-STAT TO PGM-STAT-DPD.

           MOVE 1                  TO QUE-NITM.
           MOVE DPD-LEN-TSDPD-MAS  TO QUE-LITM.
           MOVE DPD-NOM-TSDPD-MAS  TO QUE-COLA.
           IF DPD-NITM > DPD-NITM-MAX
              MOVE 'S'           TO DPD-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO DPD-MAS-IND-HMAS.
           MOVE DPD-J            TO DPD-NUM-ICUR.
           MOVE DPD-NUM-ICUR     TO DPD-NUM-ICUR-EDT.
           MOVE DPD-NUM-ICUR-EDT TO DPD-NUM-ICUR-ALF.
           MOVE DPD-NUM-ICUR-ALF TO DPD-MAS-NUM-TOCC.
           MOVE 'P'              TO DPD-MAS-IND-HMAS-ATR.
           MOVE 'P'              TO DPD-MAS-NUM-TOCC-ATR.
           MOVE DPD-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF DPD-NITM NOT > ZEROES
              MOVE '23' TO PGM-STAT-DPD
           ELSE
              MOVE '00' TO PGM-STAT-DPD FIO-STAT.
       FIN-CRG-MTI-DPD.
           EXIT.

       PUT-DPD-QUE SECTION.
       INI-PUT-DPD-QUE.
           MOVE 'P'  TO WSS-MTI-NUM-IDPD-ATR.
           MOVE 'P'  TO WSS-MTI-NUM-PRIO-ATR.
           MOVE 'P'  TO WSS-MTI-COD-PRIO-ATR.
           MOVE 'P'  TO WSS-MTI-GLS-DPRI-ATR.

           MOVE DPD-NOM-TSDPD    TO QUE-COLA.
           MOVE DPD-LEN-TSDPD    TO QUE-LITM.
           MOVE DPD-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           MOVE WSS-DPD-DATA-IDX TO QUE-ITEM.
           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           ADD 1 TO DPD-J.
       FIN-PUT-DPD-QUE.
           EXIT.

       CRG-FRM-DPD SECTION.
       INI-CRG-FRM-DPD.
           PERFORM CLR-FRM-DPD.
           MOVE ZEROES TO DPD-J.
           IF DPD-NUM-IDPD IN PDM-FLD NOT > ZEROES
              MOVE 1 TO DPD-NUM-IDPD IN DPD.
           IF FRM-IND-SGTE IN PDM-FLD = 'S'
              ADD 1  TO DPD-NUM-IDPD IN DPD.
           MOVE PDM-CIC-IPDM IN PDM TO DPD-CIC-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CRG-FRM-DPD.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM = DPD-CIC-IDPD IN DPD)
              GO TO EXT-CRG-FRM-DPD.
           IF DPD-J = 0 AND DPD-NUM-IDPD IN PDM-FLD NOT > ZEROES
              MOVE DPD-NUM-IDPD IN DPD TO DPD-NUM-IDPD IN PDM-FLD.
           ADD 1 TO DPD-J.
           IF DPD-J > DPD-JMAX
              GO TO EXT-CRG-FRM-DPD.
           MOVE DPD-NUM-IDPD IN DPD TO FRM-NUM-IDPD IN PDM-FLD(DPD-J).
           MOVE DPD-NUM-PRIO IN DPD TO FRM-NUM-PRIO IN PDM-FLD(DPD-J).
           MOVE DPD-COD-PRIO IN DPD TO FRM-COD-PRIO IN PDM-FLD(DPD-J).
           IF FRM-COD-PRIO IN PDM-FLD(DPD-J) > SPACES
              MOVE 'MC2' TO TAB-COD-SIST
              MOVE 'PDM' TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-PRIO IN PDM-FLD(DPD-J) TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DPRI IN PDM-FLD(DPD-J)
           ELSE
              MOVE SPACES             TO FRM-GLS-DPRI IN PDM-FLD(DPD-J).
       NXT-CRG-FRM-DPD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CRG-FRM-DPD.
       EXT-CRG-FRM-DPD.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.
      *    LECTURA CONSULTADO INICIAL                   
           MOVE PDM-CIC-IPDM IN PDM     TO DPD-CIC-IDPD IN DPD.         
           MOVE DPD-NUM-IDPD IN PDM-FLD TO DPD-NUM-IDPD IN DPD.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-DPD.                                         
           MOVE FIO-STAT TO PGM-STAT-DPD.
       FIN-CRG-FRM-DPD.
           EXIT.

       CLR-FRM-DPD SECTION.
       INI-CLR-FRM-DPD.
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(1).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(2).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(3).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(4).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(5).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(6).
           MOVE ZEROES TO FRM-NUM-IDPD IN PDM-FLD(7).

           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(1).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(2).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(3).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(4).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(5).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(6).
           MOVE ZEROES TO FRM-NUM-PRIO IN PDM-FLD(7).

           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(1).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(2).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(3).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(4).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(5).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(6).
           MOVE SPACES TO FRM-COD-PRIO IN PDM-FLD(7).

           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(1).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(2).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(3).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(4).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(5).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(6).
           MOVE SPACES TO FRM-GLS-DPRI IN PDM-FLD(7).
       FIN-CLR-FRM-DPD.
           EXIT.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBVIND.

       OBT-CIC-PDM SECTION.
       INI-OBT-CIC-PDM.
           MOVE 'PPDM'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS     TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-OBT-CIC-PDM.
           EXIT.

       RET-STT-DPD SECTION.
       INI-RET-STT-DPD.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DPD-MSC-TACC IN DPD
               MOVE 'I' TO DPD-MSC-STAT IN DPD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DPD-MSC-TACC IN DPD
               MOVE 'M' TO DPD-MSC-STAT IN DPD.
       FIN-RET-STT-DPD.
           EXIT.

       RET-HDR-DPD SECTION.
       INI-RET-HDR-DPD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DPD-FEC-FTRN IN DPD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DPD-HRA-HRTR IN DPD.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO DPD-COD-OTRN IN DPD.
      *    Autor Transaccion
           MOVE SCR-USER TO DPD-COD-ATRN IN DPD.
      *>>>>
       FIN-RET-HDR-DPD.
           EXIT.

       MOD-STAT-PDM SECTION.
       INI-MOD-STAT-PDM.
      *MODIFICA ESTADO PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-MOD-STAT-PDM.
           MOVE 'M' TO PDM-IND-VIGE IN PDM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'ERRUPDSTAPDM' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-MOD-STAT-PDM.
      *    ACTUALIZA CORRELATIVO POST ELI UNITARIA
      *    PERFORM PRO-ACT-NCOR.
       FIN-MOD-STAT-PDM.
           EXIT.

       ELI-ALL-DPD SECTION.
       INI-ELI-ALL-DPD.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
              GO TO FIN-ELI-ALL-DPD.

           MOVE DPD-GLS-FLAG IN DPD TO VEC-DPD-GLS-FLAG(01).
           MOVE DPD-CIC-IDPD IN DPD TO VEC-DPD-CIC-IDPD(01).
           MOVE DPD-NUM-IDPD IN DPD TO VEC-DPD-NUM-IDPD(01).
           MOVE DPD-FEC-FTRN IN DPD TO VEC-DPD-FEC-FTRN(01).
           MOVE DPD-HRA-HRTR IN DPD TO VEC-DPD-HRA-HRTR(01).
           MOVE DPD-MSC-TACC IN DPD TO VEC-DPD-MSC-TACC(01).
           MOVE DPD-MSC-STAT IN DPD TO VEC-DPD-MSC-STAT(01).
           MOVE DPD-COD-OTRN IN DPD TO VEC-DPD-COD-OTRN(01).
           MOVE DPD-COD-ATRN IN DPD TO VEC-DPD-COD-ATRN(01).
           MOVE DPD-NUM-PRIO IN DPD TO VEC-DPD-NUM-PRIO(01).
           MOVE DPD-COD-PRIO IN DPD TO VEC-DPD-COD-PRIO(01).
           MOVE DPD-GLS-DISP IN DPD TO VEC-DPD-GLS-DISP(01).

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DPDVRF NOUPD' TO MSG-COD-MENS
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              GO TO FIN-ELI-ALL-DPD.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DPDVRF NODEL' TO MSG-COD-MENS
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              GO TO FIN-ELI-ALL-DPD.
           GO TO INI-ELI-ALL-DPD.
       FIN-ELI-ALL-DPD.
           EXIT.

       PUT-NEW-DPD SECTION.
       INI-PUT-NEW-DPD.
           MOVE ZEROES TO WSS-R.
           MOVE ZEROES TO WSS-RDPD.                                     
           MOVE WSS-K  TO WSS-L.
       LUP-PUT-NEW-DPD.
           IF WSS-L NOT > ZEROES
               GO TO FIN-PUT-NEW-DPD.
           ADD 1 TO WSS-R.
           PERFORM CRG-VEC-DPD.
           IF VEC-DPD-GLS-FLAG(WSS-R) = 'E'                             
              GO TO CNT-PUT-NEW-DPD.                                    
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF1NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-NEW-DPD.
       CNT-PUT-NEW-DPD.                                                 
           SUBTRACT 1 FROM WSS-L.
           GO TO LUP-PUT-NEW-DPD.
       FIN-PUT-NEW-DPD.
           EXIT.

       CRG-DPD-VEC SECTION.
       INI-CRG-DPD-VEC.
           MOVE DPD-GLS-FLAG IN DPD TO VEC-DPD-GLS-FLAG(WSS-K).
           MOVE DPD-CIC-IDPD IN DPD TO VEC-DPD-CIC-IDPD(WSS-K).
           MOVE DPD-NUM-IDPD IN DPD TO VEC-DPD-NUM-IDPD(WSS-K).
           MOVE DPD-FEC-FTRN IN DPD TO VEC-DPD-FEC-FTRN(WSS-K).
           MOVE DPD-HRA-HRTR IN DPD TO VEC-DPD-HRA-HRTR(WSS-K).
           MOVE DPD-MSC-TACC IN DPD TO VEC-DPD-MSC-TACC(WSS-K).
           MOVE DPD-MSC-STAT IN DPD TO VEC-DPD-MSC-STAT(WSS-K).
           MOVE DPD-COD-OTRN IN DPD TO VEC-DPD-COD-OTRN(WSS-K).
           MOVE DPD-COD-ATRN IN DPD TO VEC-DPD-COD-ATRN(WSS-K).
           MOVE DPD-NUM-PRIO IN DPD TO VEC-DPD-NUM-PRIO(WSS-K).
           MOVE DPD-COD-PRIO IN DPD TO VEC-DPD-COD-PRIO(WSS-K).
           MOVE DPD-GLS-DISP IN DPD TO VEC-DPD-GLS-DISP(WSS-K).
       FIN-CRG-DPD-VEC.
           EXIT.

       CRG-VEC-DPD SECTION.
       INI-CRG-VEC-DPD.
           IF VEC-DPD-GLS-FLAG(WSS-R) = 'E'                             
              GO TO FIN-CRG-VEC-DPD.                                    
           ADD 1 TO WSS-RDPD.

           MOVE VEC-DPD-GLS-FLAG(WSS-R) TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(WSS-R) TO DPD-CIC-IDPD IN DPD.
           MOVE WSS-RDPD                TO DPD-NUM-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(WSS-R) TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(WSS-R) TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(WSS-R) TO DPD-MSC-TACC IN DPD.
           MOVE 'V'                     TO DPD-MSC-STAT IN DPD.
           MOVE VEC-DPD-COD-OTRN(WSS-R) TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(WSS-R) TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-NUM-PRIO(WSS-R) TO DPD-NUM-PRIO IN DPD.
           MOVE VEC-DPD-COD-PRIO(WSS-R) TO DPD-COD-PRIO IN DPD.
           MOVE VEC-DPD-GLS-DISP(WSS-R) TO DPD-GLS-DISP IN DPD.
       FIN-CRG-VEC-DPD.
           EXIT.

       ELI-ALL-PDM SECTION.
       INI-ELI-ALL-PDM.
           PERFORM ELI-ALL-DPD.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-ELI-ALL-PDM.
      *ELIMINA PDM
           PERFORM KEY-ALL-PDM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF FIO-STAT-OKS AND
              PDM-STP-ITRN IN PDM NOT = SCR-UMOD-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-PDM
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ELI-ALL-PDM.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ELI-ALL-PDM.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE FIO-STAT TO PGM-STAT-PDM.
           IF NOT FIO-STAT-OKS
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-DPD
              MOVE FIO-ULK-REC TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE FIO-BCK-OUT TO FIO-CMND
              PERFORM MC2-FIO-PDM
              MOVE '23' TO FIO-STAT PGM-STAT-DPD PGM-STAT-DPD
              GO TO FIN-ELI-ALL-PDM.

      *ELIMINA DPL
           MOVE 'MC2'                   TO FIO-SIST.
           MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB.
           MOVE PDM-CIC-IPDM IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-ELI-ALL-PDM.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE PGM-STAT-DPD TO FIO-STAT
              GO TO FIN-ELI-ALL-PDM.
           GO TO FIN-ELI-ALL-PDM.
       MSG-ELI-ALL-PDM.
           IF MSG-COD-SIST NOT > SPACES
              MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE 'S' TO SCR-IERR.
       FIN-ELI-ALL-PDM.
           EXIT.
                                                                        
      *PRO-ACT-NCOR SECTION.
      *INI-PRO-ACT-NCOR.
      *    PERFORM CLR-VEC-VRF.
      *    MOVE SPACES TO MSG-COD-MENS.
      *    MOVE ZEROES TO WSS-K.
      *    MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
      *    MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
      *    MOVE FIO-GET-NLS TO FIO-CMND.
      *LUP-PRO-ACT-NCOR.
      *    PERFORM MC2-FIO-DPD.
      *    IF NOT FIO-STAT-OKS
      *       GO TO CNT-PRO-ACT-NCOR.
      *    IF NOT (PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
      *       MOVE FIO-END-BRW TO FIO-CMND
      *       PERFORM MC2-FIO-DPD
      *       GO TO CNT-PRO-ACT-NCOR.
      *
      *    ADD 1 TO WSS-K.
      *    PERFORM CRG-DPD-VEC.
      *    MOVE FIO-GET-NXT TO FIO-CMND.
      *    GO TO LUP-PRO-ACT-NCOR.
      *CNT-PRO-ACT-NCOR.
      *    PERFORM ELI-ALL-DPD.
      *    IF MSG-COD-MENS > SPACES
      *       GO TO MSG-PRO-ACT-NCOR.
      *
      *    PERFORM PUT-NEW-DPD.
      *    IF MSG-COD-MENS > SPACES
      *        GO TO MSG-PRO-ACT-NCOR.
      *    GO TO FIN-PRO-ACT-NCOR.
      *MSG-PRO-ACT-NCOR.
      *    IF MSG-COD-SIST NOT > SPACES
      *       MOVE 'TAB' TO MSG-COD-SIST.
      *    PERFORM GET-MSG.
      *    MOVE MSG-GLS-DESC TO FRM-MEN1.
      *    MOVE 'S'  TO SCR-IERR.
      *    MOVE '00' TO FIO-STAT.
      *    MOVE SCR-STAT-CON TO SCR-STAT.
      *    GO TO FIN-PRO-ACT-NCOR.
      *FIN-PRO-ACT-NCOR.
      *    EXIT.

       PRO-CMN-VRF SECTION.
       INI-PRO-CMN-VRF.
           MOVE 'N'    TO VRF-PDM-PLBR IN PDM-VARI.
           MOVE 'N'    TO VRF-PDM-PDCC IN PDM-VARI.
           MOVE 'N'    TO VRF-PDM-PDCG IN PDM-VARI.
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           MOVE SPACES TO VRF-GLS-MEN2 IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-E    IN PDM-VARI.

           PERFORM CLR-VEC-VRF.

           MOVE PDM-CIC-IPDM IN PDM-FLD TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES                  TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-CMN-VRF.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM-FLD = DPD-CIC-IDPD IN DPD)
              GO TO CNT-PRO-CMN-VRF.

           IF VRF-COD-INFO(DPD-NUM-PRIO IN DPD) NOT > SPACES
              MOVE DPD-COD-PRIO IN DPD TO 
                   VRF-COD-INFO(DPD-NUM-PRIO IN DPD)
              MOVE DPD-NUM-PRIO IN DPD TO 
                   VRF-NUM-INFO(DPD-NUM-PRIO IN DPD)
           ELSE
              MOVE 'PRDDUPL  DPD' TO MSG-COD-MENS IN MSG
              ADD 1 TO VRF-PDM-E IN PDM-VARI
              IF VRF-PDM-E IN PDM-VARI NOT > VRF-PDM-EMAX IN PDM-VARI
                 MOVE DPD-NUM-PRIO IN DPD TO 
                      VRF-GLS-DET(VRF-PDM-E IN PDM-VARI)
                 MOVE '-' TO      
                      VRF-IND-DET(VRF-PDM-E IN PDM-VARI).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-CMN-VRF.
       CNT-PRO-CMN-VRF.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.

      * VERIFICACION PRIORIDAD DUPLICADAS
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.
      
      * VERIFICACION CONCEPTOS DUPLICADOS
           PERFORM VAL-CPT-DUPL.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

      * 
           PERFORM OBT-PDM-DFLT.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

      * 
           PERFORM OBT-NEW-VPDM.
           IF MSG-COD-MENS IN MSG > SPACES
              GO TO MSG-PRO-CMN-VRF.

           PERFORM ELI-ALL-DPD.
           IF MSG-COD-MENS > SPACES
              GO TO MSG-PRO-CMN-VRF.

           PERFORM PUT-VRF-RDPD.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-PRO-CMN-VRF.
           GO TO FIN-PRO-CMN-VRF.
       MSG-PRO-CMN-VRF.
           IF MSG-COD-SIST NOT > SPACES
              MOVE 'MC2' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           IF VRF-GLS-MEN2 IN PDM-VARI > SPACES
              MOVE VRF-GLS-MEN2 IN PDM-VARI TO FRM-MEN2
           ELSE
           IF VRF-GLS-MEN3 IN PDM-VARI > SPACES
              MOVE VRF-GLS-MEN3 IN PDM-VARI TO FRM-MEN2.
           MOVE 'S' TO SCR-IERR.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-PRO-CMN-VRF.
           EXIT.

       CLR-VEC-VRF SECTION.
       INI-CLR-VEC-VRF.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
       LUP-CLR-VEC-VRF.
           ADD 1 TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-CLR-VEC-VRF.
           MOVE SPACES TO VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI).
           MOVE SPACES TO VRF-COD-INFO(VRF-PDM-D IN PDM-VARI).
           MOVE ZEROES TO VRF-NUM-INFO(VRF-PDM-D IN PDM-VARI).
           GO TO LUP-CLR-VEC-VRF.
       FIN-CLR-VEC-VRF.
           EXIT.

       OBT-PDM-DFLT SECTION.
       INI-OBT-PDM-DFLT.
           IF (PDM-CAI-PRIO IN PDM-FLD = 'PDM ' AND
               PDM-IIC-PRIO IN PDM-FLD = 'DEFAULT ')
               PERFORM PRO-CRG-PDFL
               GO TO FIN-OBT-PDM-DFLT.
           MOVE PDM-KEY-IPDM IN PDM TO VRF-KEY-IPDM IN PDM-VARI.
           MOVE DPD-KEY-IDPD IN DPD TO VRF-KEY-IDPD IN PDM-VARI.

           MOVE 'MC2'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'PDMDEFAULT  ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              MOVE 'VSNPDMDF NEX' TO MSG-COD-MENS IN MSG
              GO TO FIN-OBT-PDM-DFLT.

           MOVE TAB-GLS-DATA IN TAB TO PDM-KEY-IPDM IN PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           IF NOT (FIO-STAT-OKS AND PDM-MSC-STAT IN PDM = 'A')
              MOVE 'REGPDMDF NEX' TO MSG-COD-MENS IN MSG
              GO TO FIN-OBT-PDM-DFLT.

           MOVE PDM-CIC-IPDM IN PDM TO DPD-CIC-IDPD IN DPD.
           MOVE ZEROES              TO DPD-NUM-IDPD IN DPD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-PDM-DFLT.
           PERFORM MC2-FIO-DPD.
           IF NOT (FIO-STAT-OKS AND
                   PDM-CIC-IPDM IN PDM = DPD-CIC-IDPD IN DPD)
              GO TO CNT-OBT-PDM-DFLT.

           MOVE DPD-COD-PRIO IN DPD TO
                VRF-COD-DFLT(DPD-NUM-PRIO IN DPD).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-OBT-PDM-DFLT.
       CNT-OBT-PDM-DFLT.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM MC2-FIO-DPD.
       FIN-OBT-PDM-DFLT.
           MOVE VRF-KEY-IPDM IN PDM-VARI TO PDM-KEY-IPDM IN PDM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-PDM.
           MOVE VRF-KEY-IDPD IN PDM-VARI TO DPD-KEY-IDPD IN DPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
       EXT-OBT-PDM-DFLT.
           EXIT.

       OBT-NEW-VPDM SECTION.
       INI-OBT-NEW-VPDM.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
       LUP-OBT-NEW-VPDM.
           ADD 1       TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-OBT-NEW-VPDM.
           IF VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) NOT > SPACES
              GO TO FIN-OBT-NEW-VPDM.
           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-L IN PDM-VARI.
       LUP-OBT-NEW-VPDM-I.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              MOVE ZEROES TO VRF-PDM-I IN PDM-VARI
              GO TO CNT-OBT-NEW-VPDM-I.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) NOT > SPACES AND
               VRF-PDM-L IN PDM-VARI NOT > ZEROES)
              MOVE VRF-PDM-I IN PDM-VARI TO VRF-PDM-L IN PDM-VARI.
           IF (VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) =
               VRF-COD-INFO(VRF-PDM-I IN PDM-VARI))
              GO TO NXT-OBT-NEW-VPDM.
       NXT-OBT-NEW-VPDM-I.
           GO TO LUP-OBT-NEW-VPDM-I.
       CNT-OBT-NEW-VPDM-I.
           MOVE VRF-COD-DFLT(VRF-PDM-D IN PDM-VARI) TO
                VRF-COD-INFO(VRF-PDM-L IN PDM-VARI).
       NXT-OBT-NEW-VPDM.
           GO TO LUP-OBT-NEW-VPDM.
       FIN-OBT-NEW-VPDM.
           EXIT.

       PUT-VRF-RDPD SECTION.
       INI-PUT-VRF-RDPD.
           MOVE 1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-ILBR IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF2NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PLBR IN PDM-VARI.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-IDCC IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF3NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PDCC IN PDM-VARI.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-PDM-IDCG IN PDM-VARI TO DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF4NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
           MOVE 'S' TO VRF-PDM-PDCG IN PDM-VARI.

           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
       LUP-PUT-VRF-RDPD.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-PUT-VRF-RDPD.
           IF VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) NOT > SPACES
              GO TO FIN-PUT-VRF-RDPD.

           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-ILBR IN PDM-VARI AND 
               VRF-PDM-PLBR IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-IDCC IN PDM-VARI AND 
               VRF-PDM-PDCC IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-PDM-IDCG IN PDM-VARI AND 
               VRF-PDM-PDCG IN PDM-VARI = 'S')
               GO TO NXT-PUT-VRF-RDPD.

           ADD  1 TO VRF-PDM-D IN PDM-VARI.
           MOVE VEC-DPD-GLS-FLAG(01)     TO DPD-GLS-FLAG IN DPD.
           MOVE VEC-DPD-CIC-IDPD(01)     TO DPD-CIC-IDPD IN DPD.
           MOVE VEC-DPD-FEC-FTRN(01)     TO DPD-FEC-FTRN IN DPD.
           MOVE VEC-DPD-HRA-HRTR(01)     TO DPD-HRA-HRTR IN DPD.
           MOVE VEC-DPD-MSC-TACC(01)     TO DPD-MSC-TACC IN DPD.
           MOVE VEC-DPD-COD-OTRN(01)     TO DPD-COD-OTRN IN DPD.
           MOVE VEC-DPD-COD-ATRN(01)     TO DPD-COD-ATRN IN DPD.
           MOVE VEC-DPD-GLS-DISP(01)     TO DPD-GLS-DISP IN DPD.

           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-IDPD IN DPD.
           MOVE 'V'                      TO DPD-MSC-STAT IN DPD.
           MOVE VRF-PDM-D IN PDM-VARI    TO DPD-NUM-PRIO IN DPD.
           MOVE VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) TO
                                            DPD-COD-PRIO IN DPD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM MC2-FIO-DPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM MC2-FIO-DPD
               MOVE 'DPDVRF5NOPUT' TO MSG-COD-MENS IN MSG
               GO TO FIN-PUT-VRF-RDPD.
       NXT-PUT-VRF-RDPD.
           GO TO LUP-PUT-VRF-RDPD.
       FIN-PUT-VRF-RDPD.
           EXIT.

       VAL-CPT-DUPL SECTION.
       INI-VAL-CPT-DUPL.
           MOVE ZEROES TO VRF-PDM-D IN PDM-VARI.
           MOVE SPACES TO VRF-GLS-MEN3 IN PDM-VARI.
           MOVE ZEROES TO VRF-PDM-F    IN PDM-VARI.
       LUP-VAL-CPT-DUPL.
           ADD 1 TO VRF-PDM-D IN PDM-VARI.
           IF VRF-PDM-D IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO FIN-VAL-CPT-DUPL.
           IF VRF-COD-INFO(VRF-PDM-D IN PDM-VARI) NOT > SPACES
              GO TO NXT-VAL-CPT-DUPL.
           MOVE ZEROES TO VRF-PDM-I IN PDM-VARI.
       LUP-VAL-CPT-DUPL-I.
           ADD 1 TO VRF-PDM-I IN PDM-VARI.
           IF VRF-PDM-I IN PDM-VARI > VRF-PDM-IMAX IN PDM-VARI
              GO TO NXT-VAL-CPT-DUPL.
           IF VRF-PDM-I IN PDM-VARI = VRF-PDM-D IN PDM-VARI
              GO TO NXT-VAL-CPT-DUPL-I.
           IF (VRF-COD-INFO(VRF-PDM-I IN PDM-VARI) = 
               VRF-COD-INFO(VRF-PDM-D IN PDM-VARI))
               MOVE 'CPTDUPL  DPD' TO MSG-COD-MENS IN MSG
               ADD 1 TO VRF-PDM-F IN PDM-VARI
               IF VRF-PDM-F IN PDM-VARI NOT > VRF-PDM-FMAX IN PDM-VARI
                  MOVE VRF-COD-INFO(VRF-PDM-D IN PDM-VARI) TO
                       VRF-GLS-DET3(VRF-PDM-F IN PDM-VARI)
                  MOVE '-' TO      
                       VRF-IND-DET3(VRF-PDM-F IN PDM-VARI)
                  GO TO NXT-VAL-CPT-DUPL
               ELSE
                  GO TO NXT-VAL-CPT-DUPL.
       NXT-VAL-CPT-DUPL-I.
           GO TO LUP-VAL-CPT-DUPL-I.
       NXT-VAL-CPT-DUPL.
           GO TO LUP-VAL-CPT-DUPL.
       FIN-VAL-CPT-DUPL.
           EXIT.

       PRO-CRG-PDFL SECTION.
       INI-PRO-CRG-PDFL.
           MOVE 'LBR         ' TO VRF-COD-DFLT(01).
           MOVE 'CLT         ' TO VRF-COD-DFLT(02).
           MOVE 'GRP         ' TO VRF-COD-DFLT(03).
           MOVE 'AGRB        ' TO VRF-COD-DFLT(04).
           MOVE 'BANC        ' TO VRF-COD-DFLT(05).
           MOVE 'RTBL        ' TO VRF-COD-DFLT(06).
           MOVE 'COMP        ' TO VRF-COD-DFLT(07).
           MOVE 'AGRC        ' TO VRF-COD-DFLT(08).
           MOVE 'CCNV        ' TO VRF-COD-DFLT(09).
           MOVE 'CSEG        ' TO VRF-COD-DFLT(10).
           MOVE 'CPLN        ' TO VRF-COD-DFLT(11).
           MOVE 'CRIE        ' TO VRF-COD-DFLT(12).
           MOVE 'CNED        ' TO VRF-COD-DFLT(13).
           MOVE 'CSEX        ' TO VRF-COD-DFLT(14).
           MOVE 'CTCL        ' TO VRF-COD-DFLT(15).
           MOVE 'CICL        ' TO VRF-COD-DFLT(16).
           MOVE 'EDAD        ' TO VRF-COD-DFLT(17).
           MOVE 'CRUF        ' TO VRF-COD-DFLT(18).
           MOVE 'OFOC        ' TO VRF-COD-DFLT(19).
           MOVE 'CSEC        ' TO VRF-COD-DFLT(20).
           MOVE 'TCNL        ' TO VRF-COD-DFLT(21).
           MOVE 'CNAL        ' TO VRF-COD-DFLT(22).
           MOVE 'CTIO        ' TO VRF-COD-DFLT(23).
           MOVE 'CAUX        ' TO VRF-COD-DFLT(24).
           MOVE 'VCOC        ' TO VRF-COD-DFLT(25).
           MOVE 'GRPO        ' TO VRF-COD-DFLT(26).
           MOVE 'CPAC        ' TO VRF-COD-DFLT(27).
           MOVE 'CEJC        ' TO VRF-COD-DFLT(28).
           MOVE 'CPCG        ' TO VRF-COD-DFLT(29).
           MOVE 'CTEN        ' TO VRF-COD-DFLT(30).
           MOVE 'CAPR        ' TO VRF-COD-DFLT(31).
           MOVE 'CTBC        ' TO VRF-COD-DFLT(32).
           MOVE 'CCHQ        ' TO VRF-COD-DFLT(33).
           MOVE 'CATM        ' TO VRF-COD-DFLT(34).
           MOVE 'CTEF        ' TO VRF-COD-DFLT(35).
           MOVE 'CSNP        ' TO VRF-COD-DFLT(36).
           MOVE 'CCVP        ' TO VRF-COD-DFLT(37).
           MOVE 'CREM        ' TO VRF-COD-DFLT(38).
           MOVE 'CPCT        ' TO VRF-COD-DFLT(39).
           MOVE 'CPAT        ' TO VRF-COD-DFLT(40).
           MOVE 'CSLD        ' TO VRF-COD-DFLT(41).
           MOVE 'ULEM        ' TO VRF-COD-DFLT(42).
       FIN-PRO-CRG-PDFL.
           EXIT.
       COPY GNSBPVRF.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-PDM
               PERFORM VAL-NUM-FLD-PDM
               PERFORM SCRL-TAB-PDM
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF PFS_GET_CON                                                 
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                               FRM-FFLD-PF7 OR FRM-FFLD-PF8)           
      *>>>>
*% END
