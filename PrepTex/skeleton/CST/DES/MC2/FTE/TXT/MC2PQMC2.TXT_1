*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_RCC = TRUE
*% PGM_STAT_SGS = TRUE
*% PGM_STAT_CIN = TRUE
*% PGM_STAT_PTI = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0002).
           03 SCR-MC2-FLD                PIC X(1250).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.

       01  WSS-VARI.
           03 WSS-GLS-DAT1.
              05 WSS-COD-SIST                           PIC X(03).
              05 WSS-GLS-FILL                           PIC X(07).
           03 WSS-GLS-EVEN.
              05 WSS-COD-SYST                           PIC X(03).
              05 WSS-COD-EVEN                           PIC X(03).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-MC2O                           PIC 9(02).
              05 WSS-NUM-APRO                           PIC 9(02).
              05 WSS-NUM-MPRO                           PIC 9(02).
              05 WSS-NUM-DPRO                           PIC 9(02).
           03 WSS-FEC-FADI.
              05 WSS-NUM-SADI                           PIC 9(02).
              05 WSS-NUM-AADI                           PIC 9(02).
              05 WSS-NUM-MADI                           PIC 9(02).
              05 WSS-NUM-DADI                           PIC 9(02).
           03 WSS-IND-CORP           VALUE 'N'          PIC X(01).

       COPY TABWGRCC.
       COPY TABWGSGS.
       COPY TABWXMC2.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
               MOVE TSK-TERM-ALF TO RCC-COD-TERM-SGS
               MOVE TSK-TERM-ALF TO RCC-COD-TERM-MC2
               MOVE TSK-TERM-ALF TO RCC-COD-TERM-MAS-MC2
               MOVE 'S'          TO RCC-OFRM-SRV
           ELSE
               MOVE EIBTRMID     TO RCC-COD-TERM-SGS
               MOVE EIBTRMID     TO RCC-COD-TERM-MC2
               MOVE EIBTRMID     TO RCC-COD-TERM-MAS-MC2
               MOVE 'N'          TO RCC-OFRM-SRV.

      *PVG INI 23-NOV-2004
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'ICOL'       TO QUE-TYPE.
           MOVE +9999        TO QUE-LITM.
           MOVE 1            TO QUE-NITM.
           MOVE QUE-GET      TO QUE-CMND
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE 'S' TO WSS-IND-CORP IN WSS-VARI
           ELSE
              MOVE 'N' TO WSS-IND-CORP IN WSS-VARI.
      *PVG FIN-23-NOV-2004
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-MC2-FLD TO MC2-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE RCC-NOM-TSMC2 TO QUE-COLA
               MOVE RCC-LEN-TSMC2 TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-MC2-FLD TO MC2-FLD
                  GO TO FIN-INI.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-MC2
               PERFORM VAL-NUM-FLD-MC2
               PERFORM SCRL-TAB-MC2
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
      *--------------------------------------------------------------*
           PERFORM LEE-RCC.
           IF RCC-COD-MENS IN RCC-VARI NOT > SPACES
              PERFORM PUT-TAB
              MOVE '00'         TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
           ELSE
              MOVE 'S'          TO SCR-IERR
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE RCC-COD-MENS TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE '00'         TO FIO-STAT
              IF RCC-COD-MEN2 > SPACES
                 MOVE MSG-GLS-DESC TO FRM-MEN1
                 MOVE RCC-COD-MEN2 TO FRM-MEN2
              ELSE
                 MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *--------------------------------------------------------------*
       LEE-RCC SECTION.
       INI-LEE-RCC.
           MOVE FRM-COD-EVEN IN MC2-FLD TO RCC-COD-EVEN IN RCC-VARI.
           MOVE FRM-COD-CPTO IN MC2-FLD TO RCC-COD-CPTO IN RCC-VARI.
           MOVE FRM-NUM-DOPE IN MC2-FLD TO RCC-NUM-DCOL IN RCC-VARI.
           MOVE FRM-NUM-MOPE IN MC2-FLD TO RCC-NUM-MCOL IN RCC-VARI.
           MOVE FRM-NUM-SOPE IN MC2-FLD TO RCC-NUM-SCOL IN RCC-VARI.
           MOVE FRM-NUM-AOPE IN MC2-FLD TO RCC-NUM-ACOL IN RCC-VARI.
           MOVE FRM-COD-TCON IN MC2-FLD TO RCC-COD-TCON IN RCC-VARI.

           MOVE FRM-CAI-IOPE IN MC2-FLD TO RCC-CAI-IOPE IN RCC-VARI.
           MOVE FRM-IIC-IOPE IN MC2-FLD TO RCC-IIC-IOPE IN RCC-VARI.
           MOVE FRM-EXT-IOPE IN MC2-FLD TO RCC-EXT-IOPE IN RCC-VARI.

           MOVE DBC-NUM-ICLI IN MC2-FLD TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE DBC-VRF-ICLI IN MC2-FLD TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE DBC-IND-ICLI IN MC2-FLD TO RCC-IND-ICLI IN RCC-VARI.
           MOVE DBC-GLS-ICLI IN MC2-FLD TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE FRM-COD-TCNL IN MC2-FLD TO RCC-COD-TCNL IN RCC-VARI.
           MOVE FRM-COD-CNAL IN MC2-FLD TO RCC-COD-CNAL IN RCC-VARI.

           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VCOC IN RCC-VARI.
           MOVE FRM-COD-TOOC IN MC2-FLD TO RCC-COD-TOOC IN RCC-VARI.
           MOVE FRM-COD-AOOC IN MC2-FLD TO RCC-COD-AOOC IN RCC-VARI.

           MOVE FRM-NUM-PLZO IN MC2-FLD TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE FRM-MSC-UTPZ IN MC2-FLD TO RCC-MSC-UTPZ IN RCC-VARI.

           MOVE FRM-NUM-DVEN IN MC2-FLD TO RCC-NUM-DVEN IN RCC-VARI.
           MOVE FRM-NUM-MVEN IN MC2-FLD TO RCC-NUM-MVEN IN RCC-VARI.
           MOVE FRM-NUM-SVEN IN MC2-FLD TO RCC-NUM-SVEN IN RCC-VARI.
           MOVE FRM-NUM-AVEN IN MC2-FLD TO RCC-NUM-AVEN IN RCC-VARI.

           MOVE FRM-VAL-MOPE IN MC2-FLD TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VCMO IN RCC-VARI.
           MOVE FRM-VAL-SOPE IN MC2-FLD TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VSOP IN RCC-VARI.
           IF RCC-VAL-SOPE IN RCC-VARI NOT > ZEROES
              MOVE RCC-VAL-MOPE IN RCC-VARI TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE FRM-VAL-FINA IN MC2-FLD TO RCC-VAL-FINA IN RCC-VARI.
           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VCFN IN RCC-VARI.
           MOVE FRM-VAL-INTE IN MC2-FLD TO RCC-VAL-INTE IN RCC-VARI.
           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VCIN IN RCC-VARI.
           MOVE FRM-VAL-VASG IN MC2-FLD TO RCC-VAL-VASG IN RCC-VARI.
           MOVE FRM-COD-VCOC IN MC2-FLD TO RCC-COD-VCVA IN RCC-VARI.

           MOVE FRM-IND-RTBL IN MC2-FLD TO RCC-IND-RTBL IN RCC-VARI.
           MOVE FRM-IND-COMP IN MC2-FLD TO RCC-IND-COMP IN RCC-VARI.
           MOVE FRM-COD-TCAR IN MC2-FLD TO RCC-COD-TCAR IN RCC-VARI.

           PERFORM TAB-LNK-RCC.
           IF RCC-COD-MENS IN RCC-VARI NOT > SPACES
              PERFORM PUT-RCC-CPTO.
       FIN-LEE-RCC.
           EXIT.
      *--------------------------------------------------------------*

       PUT-RCC-CPTO SECTION.
       INI-PUT-RCC-CPTO.
           MOVE ZEROES TO RCC-R IN RCC-VARI.
       LUP-PUT-RCC-CPTO.
           ADD 1 TO RCC-R.
           MOVE RCC-R              TO QUE-NITM.
           MOVE RCC-NOM-TSSGS      TO QUE-COLA.
           MOVE RCC-LEN-TSSGS      TO QUE-LITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE '00' TO FIO-STAT
              MOVE QUE-ITEM TO OSG-APL-VEC(RCC-R)
              GO TO LUP-PUT-RCC-CPTO.
       FIN-PUT-RCC-CPTO.
           EXIT.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE RCC-NOM-TSMC2     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE RCC-NOM-TSMC2-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1          TO SCR-NUM-PANT.
           MOVE LOW-VALUES TO MC2-IND-OPCL-R-IDX.
      *
           MOVE 1          TO FRM-IFLD.
           MOVE ZEROES     TO WSS-NITM.

           MOVE 1 TO WSS-F.
       LUP-PUT-TAB.
           IF WSS-F > WSS-FMAX
              GO TO FIN-PUT-TAB.
           IF OSG-SGS-COD-TSEG(WSS-F) > SPACES
              PERFORM PUT-TAB-MC2
              PERFORM PUT-MC2-QUE
              PERFORM SET-FRM-IFLD
           ELSE
           IF FRM-IFLD = 1 AND WSS-F = 1
              GO TO MSG-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F.
           GO TO LUP-PUT-TAB.
       MSG-PUT-TAB.
           MOVE 'TAB'          TO MSG-COD-SIST.
           MOVE 'RCCCPT   NEX' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
      *    MOVE 'S' TO SCR-IERR.
       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE RCC-LEN-TSMC2-MAS  TO QUE-LITM.
           MOVE RCC-NOM-TSMC2-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO MC2-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO MC2-MAS-IND-HMAS.

           MOVE WSS-NITM         TO WSS-NUM-ICUR.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO MC2-MAS-NUM-TOCC.
           MOVE MC2-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-NITMMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'MC2   DMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       PUT-TAB-MC2 SECTION.
       INI-PUT-TAB-MC2.
           PERFORM CLR-WSS.

           MOVE OSG-SGS-CIC-IRCC(WSS-F)   TO RCC-CIC-IRCC IN RCC.
           MOVE 'RCC-CIC-IRCC'            TO FIO-AKEY.
           MOVE FIO-GET-KEY               TO FIO-CMND.
           PERFORM TAB-FIO-RCC.
           MOVE OSG-SGS-NUM-IRCC(WSS-F)   TO RCC-NUM-IRCC IN RCC.
           MOVE FIO-GET-KEY               TO FIO-CMND.
           PERFORM TAB-FIO-RCC.

           MOVE RCC-IND-OPCL IN RCC       TO MC2-IND-OPCL-R.
           IF RCC-IND-OPCL IN RCC = 'O'
              MOVE RCC-CAI-IOPE IN RCC    TO MC2-CAI-IOPE-R
              MOVE RCC-IIC-IOPE IN RCC    TO MC2-IIC-IOPE-R
           ELSE
           IF RCC-IND-OPCL IN RCC = 'C'
              MOVE RCC-CAI-ICLI IN RCC    TO DBC-CAI-ICLI IN DBC
              MOVE RCC-IIC-ICLI IN RCC    TO DBC-IIC-ICLI IN DBC
              MOVE FIO-GET-KEY            TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF FIO-STAT-OKS
                 MOVE DBC-NUM-ICLI IN DBC TO MC2-NUM-ICLI
                 MOVE DBC-VRF-ICLI IN DBC TO MC2-VRF-ICLI
                 MOVE DBC-IND-ICLI IN DBC TO MC2-IND-ICLI
                 MOVE DBC-GLS-ICLI IN DBC TO MC2-GLS-ICLI
              ELSE
                 MOVE ZEROES              TO MC2-NUM-ICLI
                 MOVE SPACES              TO MC2-VRF-ICLI
                 MOVE SPACES              TO MC2-IND-ICLI
                 MOVE SPACES              TO MC2-GLS-ICLI
           ELSE
              MOVE ZEROES                 TO MC2-NUM-ICLI
              MOVE SPACES                 TO MC2-VRF-ICLI
              MOVE SPACES                 TO MC2-IND-ICLI
              MOVE SPACES                 TO MC2-GLS-ICLI.

           MOVE RCC-COD-TREC IN RCC     TO MC2-COD-TREC-R.
           MOVE RCC-COD-BANC IN RCC     TO MC2-COD-BANC-R.
           MOVE RCC-IND-RTBL IN RCC     TO MC2-IND-RTBL-R.
           MOVE RCC-IND-COMP IN RCC     TO MC2-IND-COMP-R.
           MOVE RCC-IND-PRGR IN RCC     TO MC2-IND-PRGP-R.
           MOVE RCC-COD-VCOC IN RCC     TO MC2-COD-VCOC-R.
           MOVE RCC-COD-TOOC IN RCC     TO MC2-COD-TOOC-R.
           MOVE RCC-COD-AOOC IN RCC     TO MC2-COD-AOOC-R.
           MOVE RCC-COD-TCNL IN RCC     TO MC2-COD-TCNL-R.
           MOVE RCC-COD-CNAL IN RCC     TO MC2-COD-CNAL-R.
           MOVE RCC-NUM-DINI IN RCC     TO MC2-NUM-DINI-R.
           MOVE RCC-NUM-MINI IN RCC     TO MC2-NUM-MINI-R.
           MOVE RCC-NUM-SINI IN RCC     TO MC2-NUM-SINI-R.
           MOVE RCC-NUM-AINI IN RCC     TO MC2-NUM-AINI-R.
           MOVE RCC-HRA-HINI IN RCC     TO MC2-HRA-HINI-R.

           MOVE RCC-NUM-DTER IN RCC     TO MC2-NUM-DTER-R.
           MOVE RCC-NUM-MTER IN RCC     TO MC2-NUM-MTER-R.
           MOVE RCC-NUM-STER IN RCC     TO MC2-NUM-STER-R.
           MOVE RCC-NUM-ATER IN RCC     TO MC2-NUM-ATER-R.

           MOVE RCC-HRA-HTER IN RCC     TO MC2-HRA-HTER-R.
           MOVE RCC-NUM-IRCC IN RCC     TO MC2-NUM-IRCC-R.
           MOVE RCC-CAI-IRCC IN RCC     TO MC2-CAI-IRCC-R.
           MOVE RCC-IIC-IRCC IN RCC     TO MC2-IIC-IRCC-R.
           MOVE RCC-CAI-PLAN IN RCC     TO MC2-CAI-CPTO-C.
           MOVE RCC-IIC-PLAN IN RCC     TO MC2-IIC-CPTO-C.
           MOVE OSG-SGS-COD-SIST(WSS-F) TO MC2-COD-SIST-C.
           MOVE OSG-SGS-COD-EVEN(WSS-F) TO MC2-COD-EVEN-C.
           MOVE RCC-IND-TPLT IN RCC     TO MC2-IND-TPLT-C.
           MOVE OSG-SGS-COD-MONE(WSS-F) TO MC2-COD-VCOC-C.
           MOVE OSG-SGS-NUM-DPLN(WSS-F) TO MC2-NUM-DINI-C.
           MOVE OSG-SGS-NUM-MPLN(WSS-F) TO MC2-NUM-MINI-C.
           MOVE OSG-SGS-NUM-SPLN(WSS-F) TO MC2-NUM-SINI-C.
           MOVE OSG-SGS-NUM-APLN(WSS-F) TO MC2-NUM-AINI-C.

           MOVE OSG-SGS-HRA-PLNT(WSS-F) TO MC2-HRA-HINI-C.
           MOVE ZEROES                  TO MC2-NUM-CPTO-C.
           MOVE RCC-COD-CPTO IN RCC     TO MC2-COD-CPTO-C.
           MOVE OSG-SGS-COD-TSEG(WSS-F) TO MC2-COD-CPT1-C.
           MOVE OSG-SGS-COD-SEGU(WSS-F) TO MC2-COD-CPT2-C.
           MOVE OSG-SGS-COD-OCOB(WSS-F) TO MC2-COD-CPT3-C.
           MOVE ZEROES                  TO MC2-SGV-TINF-V.
           MOVE ZEROES                  TO MC2-SGV-TMIN-V.
           MOVE ZEROES                  TO MC2-SGV-TCAL-V.
           MOVE OSG-SGS-IND-SELE(WSS-F) TO MC2-IND-SELC-V.
           MOVE OSG-SGS-VAL-MNTO(WSS-F) TO MC2-VAL-MNTO-V.
           MOVE OSG-SGS-VAL-MONE(WSS-F) TO MC2-COD-VCOC-V.
           MOVE OSG-SGS-SGV-TAMO(WSS-F) TO MC2-SGV-TAMO-V.
           MOVE OSG-SGS-COD-VCOC(WSS-F) TO MC2-COD-VCTM-V.
           MOVE OSG-SGS-COD-CPTO(WSS-F) TO MC2-COD-CPTO-V.

           MOVE OSG-SGS-MSC-BCTI(WSS-F) TO MC2-MSC-BCTI-V.
           MOVE OSG-SGS-MSC-PBTI(WSS-F) TO MC2-MSC-PBTI-V.
           MOVE OSG-SGS-MSC-BPBT(WSS-F) TO MC2-MSC-BPBT-V.
           MOVE OSG-SGS-MSC-SPBT(WSS-F) TO MC2-MSC-SPBT-V.

           MOVE OSG-SGS-COD-CVTI(WSS-F) TO MC2-COD-CVTI-V.
           MOVE OSG-SGS-MSC-TFPR(WSS-F) TO MC2-MSC-TFPR-V.
           MOVE OSG-SGS-NUM-PREP(WSS-F) TO MC2-NUM-PREP-V.
           MOVE OSG-SGS-MSC-UTPR(WSS-F) TO MC2-MSC-UTPR-V.

           MOVE OSG-SGS-SGV-CSTF(WSS-F) TO MC2-SGV-CSTF-V.
           MOVE OSG-SGS-SGV-TMAX(WSS-F) TO MC2-SGV-TMAX-V.
           MOVE OSG-SGS-VAL-FRIE(WSS-F) TO MC2-VAL-FRIE-V.

           MOVE OSG-OCI-VAL-PMAX(WSS-F) TO MC2-SGV-TINF-V.
           MOVE OSG-OCI-VAL-PMIN(WSS-F) TO MC2-SGV-TMIN-V.
           MOVE OSG-OCI-VAL-PPRO(WSS-F) TO MC2-SGV-TCAL-V.

           IF FRM-IFLD > WSS-NITMMAX
              GO TO FIN-PUT-TAB-MC2.

           MOVE MC2-IND-OPCL-R TO FRM-IND-OPCL-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-CAI-IOPE-R TO FRM-CAI-IOPE-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IIC-IOPE-R TO FRM-IIC-IOPE-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-ICLI   TO FRM-NUM-ICLI   IN MC2-FLD(FRM-IFLD).
           MOVE MC2-VRF-ICLI   TO FRM-VRF-ICLI   IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-ICLI   TO FRM-IND-ICLI   IN MC2-FLD(FRM-IFLD).
           MOVE MC2-GLS-ICLI   TO FRM-GLS-ICLI   IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-TREC-R TO FRM-COD-TREC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-BANC-R TO FRM-COD-BANC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-RTBL-R TO FRM-IND-RTBL-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-COMP-R TO FRM-IND-COMP-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-PRGP-R TO FRM-IND-PRGP-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-VCOC-R TO FRM-COD-VCOC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-TOOC-R TO FRM-COD-TOOC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-AOOC-R TO FRM-COD-AOOC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-TCNL-R TO FRM-COD-TCNL-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CNAL-R TO FRM-COD-CNAL-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-DINI-R TO FRM-NUM-DINI-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-MINI-R TO FRM-NUM-MINI-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-SINI-R TO FRM-NUM-SINI-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-AINI-R TO FRM-NUM-AINI-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-HRA-HINI-R TO FRM-HRA-HINI-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-DTER-R TO FRM-NUM-DTER-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-MTER-R TO FRM-NUM-MTER-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-STER-R TO FRM-NUM-STER-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-ATER-R TO FRM-NUM-ATER-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-HRA-HTER-R TO FRM-HRA-HTER-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-IRCC-R TO FRM-NUM-IRCC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-CAI-IRCC-R TO FRM-CAI-IRCC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IIC-IRCC-R TO FRM-IIC-IRCC-R IN MC2-FLD(FRM-IFLD).
           MOVE MC2-CAI-CPTO-C TO FRM-CAI-CPTO-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IIC-CPTO-C TO FRM-IIC-CPTO-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-SIST-C TO FRM-COD-SIST-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-EVEN-C TO FRM-COD-EVEN-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-TPLT-C TO FRM-IND-TPLT-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-VCOC-C TO FRM-COD-VCOC-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-DINI-C TO FRM-NUM-DINI-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-MINI-C TO FRM-NUM-MINI-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-SINI-C TO FRM-NUM-SINI-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-AINI-C TO FRM-NUM-AINI-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-HRA-HINI-C TO FRM-HRA-HINI-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-CPTO-C TO FRM-NUM-CPTO-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CPTO-C TO FRM-COD-CPTO-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CPT1-C TO FRM-COD-CPT1-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CPT2-C TO FRM-COD-CPT2-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CPT3-C TO FRM-COD-CPT3-C IN MC2-FLD(FRM-IFLD).
           MOVE MC2-IND-SELC-V TO FRM-IND-SELC-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-VAL-MNTO-V TO FRM-VAL-MNTO-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-VCOC-V TO FRM-COD-VCOC-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-SGV-TAMO-V TO FRM-SGV-TAMO-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-VCTM-V TO FRM-COD-VCTM-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CPTO-V TO FRM-COD-CPTO-V IN MC2-FLD(FRM-IFLD).

           MOVE MC2-MSC-BCTI-V TO FRM-MSC-BCTI-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-MSC-PBTI-V TO FRM-MSC-PBTI-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-MSC-BPBT-V TO FRM-MSC-BPBT-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-MSC-SPBT-V TO FRM-MSC-SPBT-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-COD-CVTI-V TO FRM-COD-CVTI-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-MSC-TFPR-V TO FRM-MSC-TFPR-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-NUM-PREP-V TO FRM-NUM-PREP-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-MSC-UTPR-V TO FRM-MSC-UTPR-V IN MC2-FLD(FRM-IFLD).

           MOVE MC2-SGV-CSTF-V TO FRM-SGV-CSTF-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-SGV-TMAX-V TO FRM-SGV-TMAX-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-VAL-FRIE-V TO FRM-VAL-FRIE-V IN MC2-FLD(FRM-IFLD).

           MOVE MC2-SGV-TINF-V TO FRM-SGV-TINF-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-SGV-TMIN-V TO FRM-SGV-TMIN-V IN MC2-FLD(FRM-IFLD).
           MOVE MC2-SGV-TCAL-V TO FRM-SGV-TCAL-V IN MC2-FLD(FRM-IFLD).
       FIN-PUT-TAB-MC2.
           EXIT.
      *----------------------------------------------------
       PUT-MC2-QUE SECTION.
       INI-PUT-MC2-QUE.
      *PVG INI 23-NOV-2004 EDICION DE CAMPOS NUMERICOS
           IF WSS-IND-CORP IN WSS-VARI = 'N'
              PERFORM EDT-VAL-MC2.
      *PVG FIN 23-NOV-2004

           ADD 1                   TO WSS-NITM.
           MOVE RCC-NOM-TSMC2      TO QUE-COLA.
           MOVE RCC-LEN-TSMC2      TO QUE-LITM.
           MOVE WSS-NITM           TO QUE-NITM.
           MOVE SPACES             TO QUE-ITEM.
           MOVE MC2-IND-OPCL-R-IDX TO QUE-ITEM.
           MOVE QUE-PUT            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-MC2-QUE.
           EXIT.

      *PVG INI 23-NOV-2004 EDICION DE CAMPOS NUMERICOS
       EDT-VAL-MC2 SECTION.
       INI-EDT-VAL-MC2.
           MOVE MC2-VAL-MNTO-V     TO FRM-VAL-MNTO-V-EDT.
           MOVE FRM-VAL-MNTO-V-EDT TO MC2-VAL-MNTO-V-ALF.

           MOVE MC2-SGV-TAMO-V     TO FRM-SGV-TAMO-V-EDT.
           MOVE FRM-SGV-TAMO-V-EDT TO MC2-SGV-TAMO-V-ALF.

           MOVE MC2-SGV-CSTF-V     TO FRM-SGV-CSTF-V-EDT.
           MOVE FRM-SGV-CSTF-V-EDT TO MC2-SGV-CSTF-V-ALF.

           MOVE MC2-SGV-TMAX-V     TO FRM-SGV-TMAX-V-EDT.
           MOVE FRM-SGV-TMAX-V-EDT TO MC2-SGV-TMAX-V-ALF.

           MOVE MC2-VAL-FRIE-V     TO FRM-VAL-FRIE-V-EDT.
           MOVE FRM-VAL-FRIE-V-EDT TO MC2-VAL-FRIE-V-ALF.

           MOVE MC2-SGV-TINF-V     TO FRM-SGV-TINF-V-EDT.
           MOVE FRM-SGV-TINF-V-EDT TO MC2-SGV-TINF-V-ALF.

           MOVE MC2-SGV-TMIN-V     TO FRM-SGV-TMIN-V-EDT.
           MOVE FRM-SGV-TMIN-V-EDT TO MC2-SGV-TMIN-V-ALF.

           MOVE MC2-SGV-TCAL-V     TO FRM-SGV-TCAL-V-EDT.
           MOVE FRM-SGV-TCAL-V-EDT TO MC2-SGV-TCAL-V-ALF.
       FIN-EDT-VAL-MC2.
           EXIT.
      *PVG FIN 23-NOV-2004

       CLR-WSS SECTION.
       INI-CLR-WSS.
           MOVE 'P'    TO MC2-IND-OPCL-R-ATR.
           MOVE 'P'    TO MC2-CAI-IOPE-R-ATR.
           MOVE 'P'    TO MC2-IIC-IOPE-R-ATR.
           MOVE 'P'    TO MC2-NUM-ICLI-ATR.
           MOVE 'P'    TO MC2-VRF-ICLI-ATR.
           MOVE 'P'    TO MC2-IND-ICLI-ATR.
           MOVE 'P'    TO MC2-GLS-ICLI-ATR
           MOVE 'P'    TO MC2-COD-TREC-R-ATR.
           MOVE 'P'    TO MC2-COD-BANC-R-ATR.
           MOVE 'P'    TO MC2-IND-RTBL-R-ATR.
           MOVE 'P'    TO MC2-IND-COMP-R-ATR.
           MOVE 'P'    TO MC2-IND-PRGP-R-ATR.
           MOVE 'P'    TO MC2-COD-VCOC-R-ATR.
           MOVE 'P'    TO MC2-COD-TOOC-R-ATR.
           MOVE 'P'    TO MC2-COD-AOOC-R-ATR.
           MOVE 'P'    TO MC2-COD-TCNL-R-ATR.
           MOVE 'P'    TO MC2-COD-CNAL-R-ATR.
           MOVE 'P'    TO MC2-FEC-FINI-R-ATR.
           MOVE 'P'    TO MC2-HRA-HINI-R-ATR.
           MOVE 'P'    TO MC2-FEC-FTER-R-ATR.
           MOVE 'P'    TO MC2-HRA-HTER-R-ATR.
           MOVE 'P'    TO MC2-NUM-IRCC-R-ATR.
           MOVE 'P'    TO MC2-CAI-IRCC-R-ATR.
           MOVE 'P'    TO MC2-IIC-IRCC-R-ATR.
           MOVE 'P'    TO MC2-CAI-CPTO-C-ATR.
           MOVE 'P'    TO MC2-IIC-CPTO-C-ATR.
           MOVE 'P'    TO MC2-COD-SIST-C-ATR.
           MOVE 'P'    TO MC2-COD-EVEN-C-ATR.
           MOVE 'P'    TO MC2-IND-TPLT-C-ATR.
           MOVE 'P'    TO MC2-COD-VCOC-C-ATR.
           MOVE 'P'    TO MC2-FEC-FINI-C-ATR.
           MOVE 'P'    TO MC2-HRA-HINI-C-ATR.
           MOVE 'P'    TO MC2-NUM-CPTO-C-ATR.
           MOVE 'P'    TO MC2-COD-CPTO-C-ATR.
           MOVE 'P'    TO MC2-COD-CPT1-C-ATR.
           MOVE 'P'    TO MC2-COD-CPT2-C-ATR.
           MOVE 'P'    TO MC2-COD-CPT3-C-ATR.
           MOVE 'P'    TO MC2-SGV-TINF-V-ATR.
           MOVE 'P'    TO MC2-SGV-TMIN-V-ATR.
           MOVE 'P'    TO MC2-SGV-TCAL-V-ATR.
           MOVE 'P'    TO MC2-IND-SELC-V-ATR.
           MOVE 'P'    TO MC2-VAL-MNTO-V-ATR.
           MOVE 'P'    TO MC2-COD-VCOC-V-ATR.
           MOVE 'P'    TO MC2-SGV-TAMO-V-ATR.
           MOVE 'P'    TO MC2-COD-VCTM-V-ATR.
           MOVE 'P'    TO MC2-COD-CPTO-V-ATR.

           MOVE 'P'    TO MC2-MSC-BCTI-V-ATR
           MOVE 'P'    TO MC2-MSC-PBTI-V-ATR
           MOVE 'P'    TO MC2-MSC-BPBT-V-ATR
           MOVE 'P'    TO MC2-MSC-SPBT-V-ATR
           MOVE 'P'    TO MC2-COD-CVTI-V-ATR
           MOVE 'P'    TO MC2-MSC-TFPR-V-ATR
           MOVE 'P'    TO MC2-NUM-PREP-V-ATR
           MOVE 'P'    TO MC2-MSC-UTPR-V-ATR
           MOVE 'P'    TO MC2-SGV-CSTF-V-ATR
           MOVE 'P'    TO MC2-SGV-TMAX-V-ATR
           MOVE 'P'    TO MC2-VAL-FRIE-V-ATR

           MOVE SPACES TO MC2-IND-OPCL-R.
           MOVE SPACES TO MC2-CAI-IOPE-R.
           MOVE ZEROES TO MC2-IIC-IOPE-R.
           MOVE ZEROES TO MC2-NUM-ICLI.
           MOVE SPACES TO MC2-VRF-ICLI.
           MOVE SPACES TO MC2-IND-ICLI.
           MOVE SPACES TO MC2-GLS-ICLI.
           MOVE SPACES TO MC2-COD-TREC-R.
           MOVE SPACES TO MC2-COD-BANC-R.
           MOVE SPACES TO MC2-IND-RTBL-R.
           MOVE SPACES TO MC2-IND-COMP-R.
           MOVE SPACES TO MC2-IND-PRGP-R.
           MOVE SPACES TO MC2-COD-VCOC-R.
           MOVE SPACES TO MC2-COD-TOOC-R.
           MOVE SPACES TO MC2-COD-AOOC-R.
           MOVE SPACES TO MC2-COD-TCNL-R.
           MOVE SPACES TO MC2-COD-CNAL-R.
           MOVE ZEROES TO MC2-FEC-FINI-R.
           MOVE ZEROES TO MC2-HRA-HINI-R.
           MOVE ZEROES TO MC2-FEC-FTER-R.
           MOVE ZEROES TO MC2-HRA-HTER-R.
           MOVE ZEROES TO MC2-NUM-IRCC-R.
           MOVE SPACES TO MC2-CAI-IRCC-R.
           MOVE SPACES TO MC2-IIC-IRCC-R.
           MOVE SPACES TO MC2-CAI-CPTO-C.
           MOVE SPACES TO MC2-IIC-CPTO-C.
           MOVE SPACES TO MC2-COD-SIST-C.
           MOVE SPACES TO MC2-COD-EVEN-C.
           MOVE SPACES TO MC2-IND-TPLT-C.
           MOVE SPACES TO MC2-COD-VCOC-C.
           MOVE ZEROES TO MC2-FEC-FINI-C.
           MOVE ZEROES TO MC2-HRA-HINI-C.
           MOVE ZEROES TO MC2-NUM-CPTO-C.
           MOVE SPACES TO MC2-COD-CPTO-C.
           MOVE SPACES TO MC2-COD-CPT1-C.
           MOVE SPACES TO MC2-COD-CPT2-C.
           MOVE SPACES TO MC2-COD-CPT3-C.
           MOVE ZEROES TO MC2-SGV-TINF-V.
           MOVE ZEROES TO MC2-SGV-TMIN-V.
           MOVE ZEROES TO MC2-SGV-TCAL-V.
           MOVE 'S'    TO MC2-IND-SELC-V.
           MOVE ZEROES TO MC2-VAL-MNTO-V.
           MOVE SPACES TO MC2-COD-VCOC-V.
           MOVE ZEROES TO MC2-SGV-TAMO-V.
           MOVE SPACES TO MC2-COD-VCTM-V.
           MOVE SPACES TO MC2-COD-CPTO-V.

           MOVE SPACES TO MC2-MSC-BCTI-V.
           MOVE SPACES TO MC2-MSC-PBTI-V.
           MOVE SPACES TO MC2-MSC-BPBT-V.
           MOVE SPACES TO MC2-MSC-SPBT-V.
           MOVE SPACES TO MC2-COD-CVTI-V.
           MOVE SPACES TO MC2-MSC-TFPR-V.
           MOVE ZEROES TO MC2-NUM-PREP-V.
           MOVE SPACES TO MC2-MSC-UTPR-V.
           MOVE ZEROES TO MC2-SGV-CSTF-V.
           MOVE ZEROES TO MC2-SGV-TMAX-V.
           MOVE ZEROES TO MC2-VAL-FRIE-V.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.
       FIN-CLR-WSS.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.
           MOVE 'P'    TO FRM-IND-OPCL-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-CAI-IOPE-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IIC-IOPE-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-NUM-ICLI-ATR   IN MC2-FLD(1).
           MOVE 'P'    TO FRM-VRF-ICLI-ATR   IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-ICLI-ATR   IN MC2-FLD(1).
           MOVE 'P'    TO FRM-GLS-ICLI-ATR   IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-TREC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-BANC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-RTBL-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-COMP-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-PRGP-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-VCOC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-TOOC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-AOOC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-TCNL-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CNAL-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-FEC-FINI-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-HRA-HINI-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-FEC-FTER-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-HRA-HTER-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-NUM-IRCC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-CAI-IRCC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IIC-IRCC-R-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-CAI-CPTO-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IIC-CPTO-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-SIST-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-EVEN-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-TPLT-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-VCOC-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-FEC-FINI-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-HRA-HINI-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-NUM-CPTO-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CPTO-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CPT1-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CPT2-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CPT3-C-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-TINF-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-TMIN-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-TCAL-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-IND-SELC-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-VAL-MNTO-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-VCOC-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-TAMO-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-VCTM-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CPTO-V-ATR IN MC2-FLD(1).

           MOVE 'P'    TO FRM-MSC-BCTI-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-MSC-PBTI-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-MSC-BPBT-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-MSC-SPBT-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-COD-CVTI-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-MSC-TFPR-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-NUM-PREP-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-MSC-UTPR-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-CSTF-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-SGV-TMAX-V-ATR IN MC2-FLD(1).
           MOVE 'P'    TO FRM-VAL-FRIE-V-ATR IN MC2-FLD(1).

           MOVE SPACES TO FRM-IND-OPCL-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPE-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-IIC-IOPE-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-NUM-ICLI   IN MC2-FLD(1).
           MOVE SPACES TO FRM-VRF-ICLI   IN MC2-FLD(1).
           MOVE SPACES TO FRM-IND-ICLI   IN MC2-FLD(1).
           MOVE SPACES TO FRM-GLS-ICLI   IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-TREC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-BANC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-IND-RTBL-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-IND-COMP-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-IND-PRGP-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-TOOC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-AOOC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-TCNL-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CNAL-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-FEC-FINI-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-HRA-HINI-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-FEC-FTER-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-HRA-HTER-R IN MC2-FLD(1).
           MOVE ZEROES TO FRM-NUM-IRCC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-CAI-IRCC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-IIC-IRCC-R IN MC2-FLD(1).
           MOVE SPACES TO FRM-CAI-CPTO-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-IIC-CPTO-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-SIST-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-EVEN-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-IND-TPLT-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC-C IN MC2-FLD(1).
           MOVE ZEROES TO FRM-FEC-FINI-C IN MC2-FLD(1).
           MOVE ZEROES TO FRM-HRA-HINI-C IN MC2-FLD(1).
           MOVE ZEROES TO FRM-NUM-CPTO-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CPTO-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CPT1-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CPT2-C IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CPT3-C IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-TINF-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-TMIN-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-TCAL-V IN MC2-FLD(1).
           MOVE 'S'    TO FRM-IND-SELC-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-VAL-MNTO-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-TAMO-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-VCTM-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CPTO-V IN MC2-FLD(1).

           MOVE SPACES TO FRM-MSC-BCTI-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-MSC-PBTI-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-MSC-BPBT-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-MSC-SPBT-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-COD-CVTI-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-MSC-TFPR-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-NUM-PREP-V IN MC2-FLD(1).
           MOVE SPACES TO FRM-MSC-UTPR-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-CSTF-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-SGV-TMAX-V IN MC2-FLD(1).
           MOVE ZEROES TO FRM-VAL-FRIE-V IN MC2-FLD(1).
       FIN-CLR-FRM-MTX.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE RCC-NOM-TSMC2 TO QUE-COLA.
           MOVE RCC-LEN-TSMC2 TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'MC2   NONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-IND-OPCL-R-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE RCC-NOM-TSMC2 TO QUE-COLA
               MOVE RCC-LEN-TSMC2 TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'MC2   DMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'MC2   NOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE RCC-NOM-TSMC2 TO QUE-COLA
           MOVE RCC-LEN-TSMC2 TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'MC2   NOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-IND-OPCL-R-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MC2   DMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

      *------------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE SPACES TO FRM-IND-OPCL-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-IOPE-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IIC-IOPE-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-ICLI IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-VRF-ICLI IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-ICLI IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-GLS-ICLI IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-TREC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-BANC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-RTBL-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-COMP-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-PRGP-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCOC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-TOOC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-AOOC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-TCNL-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CNAL-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FINI-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-HRA-HINI-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FTER-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-HRA-HTER-R IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-IRCC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-IRCC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IIC-IRCC-R IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-CPTO-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IIC-CPTO-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-SIST-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EVEN-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-TPLT-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCOC-C IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FINI-C IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-HRA-HINI-C IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-CPTO-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPTO-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPT1-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPT2-C IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPT3-C IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TINF-V IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TMIN-V IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TCAL-V IN MC2-FLD(WSS-I).
           MOVE 'S'    TO FRM-IND-SELC-V IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-MNTO-V IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCOC-V IN MC2-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TAMO-V IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-VCTM-V IN MC2-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPTO-V IN MC2-FLD(WSS-I).
       FIN-CLR-FRM.
           EXIT.

       SCRL-TAB-MC2 SECTION.
       INI-SCRL-TAB-MC2.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-MC2.
           EXIT.

       COPY SGCBFDBC.
       COPY TABBKRCC.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
      *>>>>
*% END
