      *
      * BGLBQQGA
      * Version 3.0.1 Nov-2005
      * 16-Nov-10 02:20 PM
      *
       SET-TAG-BGLBQQGA SECTION.
       INI-SET-TAG-BGLBQQGA.
           MOVE
           '<IDNMOD NOM=$BGLBQQGA$ VSN=$06.06.29$ VGM=$3.0.1$
      -    'GEN=$16-Nov-10 02:20 PM$ FNC=$OWFBGL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-BGLBQQGA.
           EXIT.

       PUT-ALL-QGA SECTION.
       INI-PUT-ALL-QGA.
           PERFORM PUT-GDG-QGA.
           PERFORM PUT-DBC-QGA.
           PERFORM PUT-GVT-QGA.
           PERFORM PUT-GSE-QGA.
      *<<<< FIN_PUT_ALL_QGA
      *MHM-INI 2-OCT-2003
           PERFORM PUT-GLE-QGA.
           IF FRM-MENS = SPACES AND MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.
      *MHM-FIN 2-OCT-2003

           PERFORM PUT-GDO-QGA.
           IF FRM-MENS = SPACES AND MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

      * La valorizacion de garantias especificas debe hacerse aqui, pues
      * Haberse calculado previa y eventualmente el valor del deposito a
      * Plazo propio en garantia, lo que se hace en put-gdo

      * OBTIENE CIC DE CODIGO GARANTIA ESPECIFICA
           MOVE 'BGL'          TO FIO-SIST.
           MOVE 'LIM'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'E'            TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'CICESP  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

           IF GDG-COD-LGTA IN GDG NOT = TAB-COD-CTAB IN TAB
               GO TO FIN-PUT-ALL-QGA.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA
           ELSE
           MOVE TAB-COD-CTAB IN TAB TO VCR-COD-PESO IN VCR-VARI.

      * Garantia especifica, valoriza los creditos correspondientes
           MOVE ZEROES TO GVT-SGV-VCTS IN QGA-FLD.
           MOVE ZEROES TO GVT-SGV-LTSN IN QGA-FLD.
           MOVE ZEROES TO GVT-SGV-VPND IN QGA-FLD.

           MOVE DBC-KEY-IDBC IN DBC TO DBC-KEY-IDBC IN VCR-VARI.
           MOVE GDG-CAI-GTIA IN GDG TO VCR-CAI-GTIA IN VCR-VARI.
           MOVE GDG-IIC-GTIA IN GDG TO VCR-IIC-GTIA IN VCR-VARI.
           MOVE GDG-COD-VCAM IN GDG TO VCR-COD-VCAM IN VCR-VARI.
      *<<<< PGM_MVS OR PGM_DOS
      * Obtiene codigo valor de cambio de pesos mediante cic de la moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.
           MOVE TAB-COD-CTAB IN TAB TO VCR-COD-PESO IN VCR-VARI.
      *>>>>
           PERFORM GAR-PRO-VCR.
      *MHM-INI 2-OCT-2003
           IF VCR-COD-MENS > SPACES
               MOVE VCR-COD-MENS TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.
      *MHM-FIN 2-OCT-2003

           IF FRM-MENS = SPACES AND MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PUT-ALL-QGA.

           MOVE GVT-SGV-VCTS IN GVT TO GVT-SGV-VCTS IN QGA-FLD.
           MOVE GVT-SGV-LTSN IN GVT TO GVT-SGV-LTSN IN QGA-FLD.
           MOVE GVT-SGV-VPND IN GVT TO GVT-SGV-VPND IN QGA-FLD.
      *MVG-INI 19-JUN-2018 CORRECCION VALORES CGD - 53926
           MOVE GVT-SGV-VGAS IN GVT TO GVT-SGV-VGAS IN QGA-FLD.
      *MVG-FIN 19-JUN-2018 CORRECCION VALORES CGD - 53926
      *>>>>
       FIN-PUT-ALL-QGA.
           EXIT.

       PUT-GDG-QGA SECTION.
       INI-PUT-GDG-QGA.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-QGA.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-QGA
               GO TO FIN-PUT-GDG-QGA.
           MOVE GDG-CAI-GTIA IN GDG TO GDG-CAI-GTIA IN QGA-FLD.
           MOVE GDG-IIC-GTIA IN GDG TO GDG-IIC-GTIA IN QGA-FLD.
      * IDG-INI --> BMCHIBCI001210.SRCAIU
           MOVE GDG-TIP-CGTA IN GDG TO GDG-TIP-CGTA IN QGA-FLD.
           MOVE GDG-STP-CGTA IN GDG TO GDG-STP-CGTA IN QGA-FLD.
      * IDG-FIN --> BMCHIBCI001210.SRCAIU
      * OFI-INI --> BMCHIBCI001210.SRCAIU
           MOVE GDG-COD-OFIC IN GDG TO GDG-COD-OFIC IN QGA-FLD.
      * OFI-FIN --> BMCHIBCI001210.SRCAIU
           MOVE GDG-COD-VCAM IN GDG TO GDG-COD-VCAM IN QGA-FLD.
           MOVE GDG-GLS-DGTA IN GDG TO GDG-GLS-DGTA IN QGA-FLD.
           MOVE GDG-GLS-DGT1 IN GDG TO GDG-GLS-DGT1 IN QGA-FLD.
           MOVE GDG-COD-GGTA IN GDG TO GDG-COD-GGTA IN QGA-FLD.
           MOVE GDG-IND-GTAC IN GDG TO GDG-IND-GTAC IN QGA-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GDG-NUM-DING IN GDG TO GDG-NUM-DING IN QGA-FLD.
           MOVE GDG-NUM-MING IN GDG TO GDG-NUM-MING IN QGA-FLD.
           MOVE GDG-NUM-SING IN GDG TO GDG-NUM-SING IN QGA-FLD.
           MOVE GDG-NUM-AING IN GDG TO GDG-NUM-AING IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GDG-NUM-DEST IN GDG TO GDG-NUM-DEST IN QGA-FLD.
           MOVE GDG-NUM-MEST IN GDG TO GDG-NUM-MEST IN QGA-FLD.
           MOVE GDG-NUM-SEST IN GDG TO GDG-NUM-SEST IN QGA-FLD.
           MOVE GDG-NUM-AEST IN GDG TO GDG-NUM-AEST IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GDG-NUM-DVTO IN GDG TO GDG-NUM-DVTO IN QGA-FLD.
           MOVE GDG-NUM-MVTO IN GDG TO GDG-NUM-MVTO IN QGA-FLD.
           MOVE GDG-NUM-SVTO IN GDG TO GDG-NUM-SVTO IN QGA-FLD.
           MOVE GDG-NUM-AVTO IN GDG TO GDG-NUM-AVTO IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFIC IN QGA-FLD > SPACES
               MOVE GDG-COD-OFIC IN QGA-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN QGA-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-VCAM IN QGA-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-VCAM IN QGA-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN QGA-FLD.
      *<<<< FIN_PUT_GDG_QGA
           MOVE GDG-IND-EST1 IN GDG    TO CNE-GDG-IND-EST1.
           MOVE GDG-CIC-EJOR IN GDG    TO CNE-GDG-CIC-EJOR.
           MOVE GDG-COD-LGTA IN GDG    TO CNE-GDG-COD-LGTA.

      *BUS-USR busca usuario en tablas
           IF CNE-GDG-CIC-EJOR > SPACES
               MOVE CNE-GDG-CIC-EJOR TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOR IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJOR IN QGA-FLD.

      *BUS-TAB BUSCA GLOSA DE CODIGO EN TABLA
           IF CNE-GDG-IND-EST1  > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE CNE-GDG-IND-EST1 TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-EST1 IN QGA-FLD.
      *CGL-INI  23-SEP-2003 15:12:31
      *BUS-TAB busca glosa de codigo en tabla
           IF CNE-GDG-COD-LGTA > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'LIM ' TO TAB-COD-TTAB IN TAB
               MOVE CNE-GDG-COD-LGTA TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LGTA IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LGTA IN QGA-FLD.
      *CGL-FIN  23-SEP-2003 15:12:54
      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.

      *<<<< FMT_CHI
           MOVE GDG-TIP-CGTA IN QGA-FLD TO TAG-TIP-AGTA IN TAG.
           MOVE GDG-STP-CGTA IN QGA-FLD TO TAG-STP-AGTA IN TAG.
      *>>>>
           MOVE TAG-COD-AGTA IN TAG     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
      *MHM-INI 23-OCT-2003
      *         MOVE TAB-GLS-DESC IN TAB TO
      *              FRM-GLS-CGTA IN QGA-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-CGTA IN QGA-FLD.
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-SOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-SOPE IN WSS-VARI.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-CGTA IN QGA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB     TO WSS-GLS-TOPE IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TOPE IN WSS-VARI.

           MOVE WSS-GLS-CGTA TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-CGTA IN QGA-FLD.
      *MHM-FIN 23-OCT-2003

      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           MOVE FIO-STAT TO PGM-STAT-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'BGL' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'BGL' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE TAG-IND-TREA IN TAG TO
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO
                         FRM-GLS-TREA IN QGA-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TREA IN QGA-FLD.

      *BUS-FEC Obtiene fecha de vencto. del credito cuando corresponde

           MOVE 'Z'  TO WSS-COD-PACR-N IN WSS-VARI.

           MOVE ZEROES TO WSS-FEC-FTER IN WSS-VARI.

           MOVE GDG-CIC-GTIA IN GDG TO GES-CIC-GTIA IN GES
           MOVE ZEROES              TO GES-NUM-IGES IN GES
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           IF NOT ( FIO-STAT-OKS  AND
                    GES-CIC-GTIA IN GES = GDG-CIC-GTIA IN GDG)
              MOVE '00'   TO FIO-STAT
              MOVE ZEROES TO FRM-NUM-DVEN IN QGA-FLD
              MOVE ZEROES TO FRM-NUM-MVEN IN QGA-FLD
              MOVE ZEROES TO FRM-NUM-SVEN IN QGA-FLD
              MOVE ZEROES TO FRM-NUM-AVEN IN QGA-FLD
              GO TO LUP-MENSAJE.

       LUP-GES.
           IF NOT ( FIO-STAT-OKS  AND
                    GES-CIC-GTIA IN GES = GDG-CIC-GTIA IN GDG)
              MOVE '00'   TO FIO-STAT
              MOVE WSS-NUM-DTER IN WSS-VARI TO FRM-NUM-DVEN IN QGA-FLD
              MOVE WSS-NUM-MTER IN WSS-VARI TO FRM-NUM-MVEN IN QGA-FLD
              MOVE WSS-NUM-STER IN WSS-VARI TO FRM-NUM-SVEN IN QGA-FLD
              MOVE WSS-NUM-ATER IN WSS-VARI TO FRM-NUM-AVEN IN QGA-FLD
              GO TO LUP-MENSAJE.

           IF GES-FEC-FVCR IN GES > WSS-FEC-FTER IN WSS-VARI AND
              GES-IND-SCRE IN GES = 'S'
              MOVE GES-FEC-FVCR IN GES TO WSS-FEC-FTER IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           GO TO LUP-GES.

       LUP-MENSAJE.
           PERFORM GET-FHOY.
           IF GDG-FEC-FVTO IN GDG > HOY-FHOY
              GO TO FIN-PUT-GDG-QGA.

           MOVE 'BGL'        TO MSG-COD-SIST.
           MOVE 'FECVTO<HOY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
      *>>>>
       FIN-PUT-GDG-QGA.
           EXIT.

       PUT-DBC-QGA SECTION.
       INI-PUT-DBC-QGA.
      *<<<< INI_PUT_DBC_QGA
      *XON-INI 15-NOV-2010   CLAUSULA DE COBERTURA
           IF  GDG-MSC-STAT = 'A'  AND  GDG-IND-EST1 NOT < '10'
               PERFORM OBT-CLA-COBT.
      *XON-FIN 15-NOV-2010
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-QGA.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-QGA
               GO TO FIN-PUT-DBC-QGA.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN QGA-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN QGA-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN QGA-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN QGA-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN QGA-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU
      *<<<< FIN_PUT_DBC_QGA
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN QGA-FLD.

      *<<<< NOT PGM_BFA
      * BUSCA FIANZA, ESTO NO ES GENERICO
           PERFORM GET-FHOY.
           MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICLI IN FIA.
           MOVE SPACES              TO FIA-CIC-ICFS IN FIA.
           MOVE 'FIA-GLS-ICYF'      TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF NOT ( FIO-STAT-OKS AND
                    FIA-CIC-ICLI IN FIA = DBC-CIC-ICLI IN DBC )
               GO TO FIN-BUS-FIA.

       LUP-BUS-FIA.
           IF FIA-MSC-STAT IN FIA NOT = 'S'
               GO TO NXT-BUS-FIA.

           IF FIA-FEC-FALZ IN FIA > ZEROES AND
              FRM-GLS-EFIA IN QGA-FLD NOT > SPACES
               MOVE 'FIANZA ALZADA' TO FRM-GLS-EFIA IN QGA-FLD
               GO TO NXT-BUS-FIA.

           IF FIA-FEC-FVEN IN FIA > HOY-FHOY OR
              FIA-FEC-FVEN IN FIA NOT > ZEROES
               MOVE 'EXISTE FIANZA' TO FRM-GLS-EFIA IN QGA-FLD
               GO TO FIN-BUS-FIA.

           MOVE 'FIANZA VENCIDA' TO FRM-GLS-EFIA IN QGA-FLD.

      *Lee la siguiente fianza
       NXT-BUS-FIA.
           MOVE 'FIA-GLS-ICYF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
              FIA-CIC-ICLI IN FIA = DBC-CIC-ICLI IN DBC
               IF FIA-FEC-FALZ IN FIA > ZEROES
                   GO TO NXT-BUS-FIA
               ELSE
                   GO TO LUP-BUS-FIA.
       FIN-BUS-FIA.
      *>>>>
      *>>>>
       FIN-PUT-DBC-QGA.
           EXIT.

       PUT-GVT-QGA SECTION.
       INI-PUT-GVT-QGA.
      *<<<< INI_PUT_GVT_QGA
           IF PGM-STAT-GDG-OKS AND
              GDG-IND-EGVT IN GDG = 'S'
               MOVE GDG-CAI-GTIA IN GDG TO GVT-CAI-GTIA IN GVT
               MOVE GDG-IIC-GTIA IN GDG TO GVT-IIC-GTIA IN GVT
               MOVE GDG-COD-TSCN IN GDG TO GVT-COD-TASN IN GVT
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GVT
               MOVE FIO-STAT TO PGM-STAT-GVT
               IF NOT FIO-STAT-OKS
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'GVT    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GVT-QGA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO PGM-STAT-GVT.

      *>>>>
           IF PGM-STAT-GVT-NUL
               GO TO FIN-PUT-GVT-QGA.
           IF NOT PGM-STAT-GVT-OKS
               PERFORM CLR-GVT-QGA
               GO TO FIN-PUT-GVT-QGA.
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GVT-NUM-DTSN IN GVT TO GVT-NUM-DTSN IN QGA-FLD.
           MOVE GVT-NUM-MTSN IN GVT TO GVT-NUM-MTSN IN QGA-FLD.
           MOVE GVT-NUM-STSN IN GVT TO GVT-NUM-STSN IN QGA-FLD.
           MOVE GVT-NUM-ATSN IN GVT TO GVT-NUM-ATSN IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GVT-NUM-DRVL IN GVT TO GVT-NUM-DRVL IN QGA-FLD.
           MOVE GVT-NUM-MRVL IN GVT TO GVT-NUM-MRVL IN QGA-FLD.
           MOVE GVT-NUM-SRVL IN GVT TO GVT-NUM-SRVL IN QGA-FLD.
           MOVE GVT-NUM-ARVL IN GVT TO GVT-NUM-ARVL IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
           MOVE GVT-SGV-VCTS IN GVT TO GVT-SGV-VCTS IN QGA-FLD.
           MOVE GVT-SGV-LTSN IN GVT TO GVT-SGV-LTSN IN QGA-FLD.
           MOVE GVT-SGV-VPND IN GVT TO GVT-SGV-VPND IN QGA-FLD.
           MOVE GVT-SGV-VGAS IN GVT TO GVT-SGV-VGAS IN QGA-FLD.
      *<<<< FIN_PUT_GVT_QGA
      *     MOVE ZEROES TO GVT-SGV-VGAS IN GVT
      *                    GVT-SGV-VGAS IN QGA-FLD.

           IF NOT PGM-STAT-TAG-OKS
               GO TO FIN-PUT-GVT-QGA.

      * SE DETERMINA SI LA TASACION ESTA VENCIDA O NO


           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efect
           IF TAG-NUM-PVTS IN TAG NOT > ZEROES
               GO TO FIN-EXA-VEN-TSN.

      * iNCLUIRcluye los Creditos Hipotecarios.

           MOVE GDG-CAI-GTIA IN GDG TO GES-CAI-GTIA IN GES.
           MOVE GDG-IIC-GTIA IN GDG TO GES-IIC-GTIA IN GES.
            MOVE ZEROES              TO GES-NUM-IGES IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GDG-CAI-GTIA IN GDG NOT = GES-CAI-GTIA IN GES OR
              GDG-IIC-GTIA IN GDG NOT = GES-IIC-GTIA IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GES-IIC-GTIA IN GES
                              GES-FEC-FVCR IN GES
                              GES-NUM-IGES IN GES
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM BGL-FIO-GES
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM BGL-FIO-GES
               IF GES-COD-SIST IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GES-COD-SIST IN GES TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'
                       GO TO FIN-EXA-VEN-TSN.
      * FIN-MODIFICACION BANAMEX

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.
           IF TAG-COD-TPVT IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NDIA
           ELSE
           IF TAG-COD-TPVT IN TAG = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NMES
           ELSE
           IF TAG-COD-TPVT IN TAG = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE TAG-NUM-PVTS IN TAG TO FEC-NANO.

           MOVE GVT-FEC-FTSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.

           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO FIN-EXA-VEN-TSN.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO FIN-EXA-VEN-TSN.

           MOVE 'BGL'        TO MSG-COD-SIST.
           MOVE 'FECTSN<HOY' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
       FIN-EXA-VEN-TSN.

      *>>>>
       FIN-PUT-GVT-QGA.
           EXIT.

       PUT-GSE-QGA SECTION.
       INI-PUT-GSE-QGA.
      *<<<< INI_PUT_GSE_QGA

           IF NOT (PGM-STAT-GDG-OKS AND GDG-IND-EGSE IN GDG = 'S')
              MOVE '23' TO PGM-STAT-GSE
              GO TO FIN-GSE-QGA.


           MOVE 99999999      TO WSS-FEC-FINI IN WSS-VARI.
           MOVE ZEROES        TO WSS-FEC-FTER IN WSS-VARI.

           MOVE GDG-CAI-GTIA IN GDG TO GSE-CAI-GTIA IN GSE.
           MOVE GDG-IIC-GTIA IN GDG TO GSE-IIC-GTIA IN GSE.
           MOVE ZEROES              TO GSE-NUM-IGSE IN GSE.
           MOVE FIO-GET-NLS TO FIO-CMND
           PERFORM BGL-FIO-GSE
           MOVE FIO-STAT TO PGM-STAT-GSE
           IF NOT ( FIO-STAT-OKS                              AND
                    GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                    GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
              MOVE 'BGL'        TO MSG-COD-SIST
              MOVE 'GSE    NEX' TO MSG-COD-MENS
              GO TO FIN-PUT-GSE-QGA.
       LUP-GSE-QGA.
           IF NOT ( FIO-STAT-OKS                              AND
                    GDG-CAI-GTIA IN GDG = GSE-CAI-GTIA IN GSE AND
                    GDG-IIC-GTIA IN GDG = GSE-IIC-GTIA IN GSE    )
              MOVE WSS-FEC-FINI IN WSS-VARI TO GSE-FEC-FVSG IN GSE
              MOVE WSS-FEC-FTER IN WSS-VARI TO GSE-FEC-FVTS IN GSE
              MOVE '00'  TO FIO-STAT
              GO TO FIN-GSE-QGA.

           IF GSE-FEC-FVSG IN GSE < WSS-FEC-FINI IN WSS-VARI
              MOVE GSE-FEC-FVSG IN GSE TO WSS-FEC-FINI IN WSS-VARI.

           IF GSE-FEC-FVTS IN GSE > WSS-FEC-FTER IN WSS-VARI
              MOVE GSE-FEC-FVTS IN GSE TO WSS-FEC-FTER IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM BGL-FIO-GSE.
           GO TO LUP-GSE-QGA.

       FIN-GSE-QGA.
      *>>>>
           IF PGM-STAT-GSE-NUL
               GO TO FIN-PUT-GSE-QGA.
           IF NOT PGM-STAT-GSE-OKS
               PERFORM CLR-GSE-QGA
               GO TO FIN-PUT-GSE-QGA.
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GSE-NUM-DVSG IN GSE TO GSE-NUM-DVSG IN QGA-FLD.
           MOVE GSE-NUM-MVSG IN GSE TO GSE-NUM-MVSG IN QGA-FLD.
           MOVE GSE-NUM-SVSG IN GSE TO GSE-NUM-SVSG IN QGA-FLD.
           MOVE GSE-NUM-AVSG IN GSE TO GSE-NUM-AVSG IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      * FEC-INI --> BMCHIBCI001210.SRCAIU
           MOVE GSE-NUM-DVTS IN GSE TO GSE-NUM-DVTS IN QGA-FLD.
           MOVE GSE-NUM-MVTS IN GSE TO GSE-NUM-MVTS IN QGA-FLD.
           MOVE GSE-NUM-SVTS IN GSE TO GSE-NUM-SVTS IN QGA-FLD.
           MOVE GSE-NUM-AVTS IN GSE TO GSE-NUM-AVTS IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU
      *<<<< FIN_PUT_GSE_QGA
      * SE DETERMINA SI EL SEGURO ESTA VENCIDO O NO


      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF GSE-FEC-FVTS IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

           MOVE 'SEGURO VENCIDO' TO FRM-MEN2.

       FIN-EXA-VEN-SEG.
      *>>>>
       FIN-PUT-GSE-QGA.
           EXIT.

       KEY-ALL-QGA SECTION.
       INI-KEY-ALL-QGA.
           PERFORM KEY-GDG-QGA.
           PERFORM KEY-DBC-QGA.
           PERFORM KEY-GVT-QGA.
           PERFORM KEY-GSE-QGA.
       FIN-KEY-ALL-QGA.
           EXIT.

       KEY-GDG-QGA SECTION.
       INI-KEY-GDG-QGA.
           MOVE GDG-CAI-GTIA IN QGA-FLD TO GDG-CAI-GTIA IN GDG.
           MOVE GDG-IIC-GTIA IN QGA-FLD TO GDG-IIC-GTIA IN GDG.
       FIN-KEY-GDG-QGA.
           EXIT.

       KEY-DBC-QGA SECTION.
       INI-KEY-DBC-QGA.
           MOVE DBC-GLS-NOMC IN QGA-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN QGA-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN QGA-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN QGA-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN QGA-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-QGA.
           EXIT.

       KEY-GVT-QGA SECTION.
       INI-KEY-GVT-QGA.
       FIN-KEY-GVT-QGA.
           EXIT.

       KEY-GSE-QGA SECTION.
       INI-KEY-GSE-QGA.
       FIN-KEY-GSE-QGA.
           EXIT.

       SCR-CLRA-QGA SECTION.
       INI-SCR-CLRA-QGA.
           PERFORM CLR-KEY-QGA.
           PERFORM CLR-FLD-QGA.
       FIN-SCR-CLRA-QGA.
           EXIT.

       CLR-KEY-QGA SECTION.
       INI-CLR-KEY-QGA.
           MOVE SPACES TO GDG-CAI-GTIA IN QGA-FLD.
           MOVE ZEROES TO GDG-IIC-GTIA IN QGA-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN QGA-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN QGA-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN QGA-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN QGA-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN QGA-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-QGA.
           EXIT.

       CLR-FLD-QGA SECTION.
       INI-CLR-FLD-QGA.
           MOVE SPACES TO FRM-GLS-TREA IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-MULT IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-CGTA IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-VCAM IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-LGTA IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-EFIA IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-EST1 IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-EJOR IN QGA-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FVEN IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-REGI IN QGA-FLD.
           MOVE SPACES TO FRM-GLS-IEMI IN QGA-FLD.
           MOVE ZEROES TO FRM-CLA-COBT IN QGA-FLD.
           PERFORM CLR-GDG-QGA.
           PERFORM CLR-DBC-QGA.
           PERFORM CLR-GVT-QGA.
           PERFORM CLR-GSE-QGA.
       FIN-CLR-FLD-QGA.
           EXIT.

       CLR-GDG-QGA SECTION.
       INI-CLR-GDG-QGA.
      * IDG-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-TIP-CGTA IN QGA-FLD.
           MOVE SPACES TO GDG-STP-CGTA IN QGA-FLD.
      * IDG-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * OFI-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-OFIC IN QGA-FLD.
      * OFI-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO GDG-COD-VCAM IN QGA-FLD.
           MOVE SPACES TO GDG-GLS-DGTA IN QGA-FLD.
           MOVE SPACES TO GDG-GLS-DGT1 IN QGA-FLD.
           MOVE SPACES TO GDG-COD-GGTA IN QGA-FLD.
           MOVE SPACES TO GDG-IND-GTAC IN QGA-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FING IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FEST IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GDG-FEC-FVTO IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-GDG-QGA.
           EXIT.

       CLR-DBC-QGA SECTION.
       INI-CLR-DBC-QGA.
       FIN-CLR-DBC-QGA.
           EXIT.

       CLR-GVT-QGA SECTION.
       INI-CLR-GVT-QGA.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FTSN IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-FEC-FRVL IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GVT-SGV-VCTS IN QGA-FLD.
           MOVE ZEROES TO GVT-SGV-LTSN IN QGA-FLD.
           MOVE ZEROES TO GVT-SGV-VPND IN QGA-FLD.
           MOVE ZEROES TO GVT-SGV-VGAS IN QGA-FLD.
       FIN-CLR-GVT-QGA.
           EXIT.

       CLR-GSE-QGA SECTION.
       INI-CLR-GSE-QGA.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSE-FEC-FVSG IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO GSE-FEC-FVTS IN QGA-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-GSE-QGA.
           EXIT.

       FST-KEY-QGA SECTION.
       INI-FST-KEY-QGA.
           MOVE -1 TO GDG-CAI-GTIA-LEN IN QGA-FLD.
       FIN-FST-KEY-QGA.
           EXIT.

       FST-FLD-QGA SECTION.
       INI-FST-FLD-QGA.
       FIN-FST-FLD-QGA.
           EXIT.

       PRO-KEY-QGA SECTION.
       INI-PRO-KEY-QGA.
           PERFORM PRO-IKY-QGA.
           PERFORM PRO-AKY-QGA.
           PERFORM PRO-MKY-QGA.
       FIN-PRO-KEY-QGA.
           EXIT.

       PRO-IKY-QGA SECTION.
       INI-PRO-IKY-QGA.
           MOVE FRM-CPIM-AEY TO GDG-CAI-GTIA-ATR IN QGA-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IIC-GTIA-ATR IN QGA-FLD.
       FIN-PRO-IKY-QGA.
           EXIT.

       PRO-MKY-QGA SECTION.
       INI-PRO-MKY-QGA.
       FIN-PRO-MKY-QGA.
           EXIT.

       PRO-AKY-QGA SECTION.
       INI-PRO-AKY-QGA.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN QGA-FLD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN QGA-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-AKY-QGA.
           EXIT.

       UNP-KEY-QGA SECTION.
       INI-UNP-KEY-QGA.
           PERFORM UNP-IKY-QGA.
           PERFORM UNP-AKY-QGA.
           PERFORM UNP-MKY-QGA.
       FIN-UNP-KEY-QGA.
           EXIT.

       UNP-IKY-QGA SECTION.
       INI-UNP-IKY-QGA.
           MOVE FRM-CPIM-UBY TO GDG-CAI-GTIA-ATR.
           MOVE FRM-CPIM-UBY TO GDG-IIC-GTIA-ATR.
       FIN-UNP-IKY-QGA.
           EXIT.

       UNP-MKY-QGA SECTION.
       INI-UNP-MKY-QGA.
       FIN-UNP-MKY-QGA.
           EXIT.

       UNP-AKY-QGA SECTION.
       INI-UNP-AKY-QGA.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN QGA-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN QGA-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-AKY-QGA.
           EXIT.

       UNP-FLD-QGA SECTION.
       INI-UNP-FLD-QGA.
           PERFORM UNP-GDG-QGA.
           PERFORM UNP-DBC-QGA.
           PERFORM UNP-GVT-QGA.
           PERFORM UNP-GSE-QGA.
       FIN-UNP-FLD-QGA.
           EXIT.

       UNP-GDG-QGA SECTION.
       INI-UNP-GDG-QGA.
       FIN-UNP-GDG-QGA.
           EXIT.

       UNP-DBC-QGA SECTION.
       INI-UNP-DBC-QGA.
       FIN-UNP-DBC-QGA.
           EXIT.

       UNP-GVT-QGA SECTION.
       INI-UNP-GVT-QGA.
       FIN-UNP-GVT-QGA.
           EXIT.

       UNP-GSE-QGA SECTION.
       INI-UNP-GSE-QGA.
       FIN-UNP-GSE-QGA.
           EXIT.

       VAL-KEY-QGA SECTION.
       INI-VAL-KEY-QGA.
           PERFORM VAL-IKY-QGA.
           PERFORM VAL-MKY-QGA.
           PERFORM VAL-AKY-QGA.
       FIN-VAL-KEY-QGA.
           EXIT.

       VAL-IKY-QGA SECTION.
       INI-VAL-IKY-QGA.
           PERFORM VAL-GDG-CAI-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-CAI-GTIA-LEN IN QGA-FLD
                GO TO FIN-VAL-IKY-QGA.
           PERFORM VAL-GDG-IIC-GTIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN QGA-FLD
                GO TO FIN-VAL-IKY-QGA.
       FIN-VAL-IKY-QGA.
           EXIT.

       VAL-MKY-QGA SECTION.
       INI-VAL-MKY-QGA.
       FIN-VAL-MKY-QGA.
           EXIT.

       VAL-AKY-QGA SECTION.
       INI-VAL-AKY-QGA.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN QGA-FLD
                GO TO FIN-VAL-AKY-QGA.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN QGA-FLD
                GO TO FIN-VAL-AKY-QGA.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN QGA-FLD
                GO TO FIN-VAL-AKY-QGA.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN QGA-FLD
                GO TO FIN-VAL-AKY-QGA.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN QGA-FLD
                GO TO FIN-VAL-AKY-QGA.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-AKY-QGA.
           EXIT.

       VAL-GDG-CAI-GTIA SECTION.
       INI-VAL-GDG-CAI-GTIA.
           IF GDG-CAI-GTIA IN QGA-FLD NOT > SPACES
              MOVE SPACES TO GDG-CAI-GTIA IN QGA-FLD.
       FIN-VAL-GDG-CAI-GTIA.
           EXIT.

       VAL-GDG-IIC-GTIA SECTION.
       INI-VAL-GDG-IIC-GTIA.
       FIN-VAL-GDG-IIC-GTIA.
           EXIT.

       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN QGA-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN QGA-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN QGA-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN QGA-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN QGA-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN QGA-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-IND-ICLI IN QGA-FLD = 'M'
               MOVE 'BGL'          TO MSG-COD-SIST
               MOVE 'GDGNOMDDIR'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN QGA-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN QGA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN QGA-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN QGA-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN QGA-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        CNE-DBC-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO
                        CNE-DBC-IIC-ICLI
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN QGA-FLD.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN QGA-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN QGA-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN QGA-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN QGA-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN QGA-FLD NOT > IDC-INIC-GLS
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN QGA-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN QGA-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN QGA-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-CON-KEY-QGA SECTION.
       INI-VAL-CON-KEY-QGA.
      *<<<< INI_VAL_CON_KEY_QGA
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-QGA.
      *>>>>
           IF     GDG-CAI-GTIA IN QGA-FLD NOT > SPACES
              AND GDG-IIC-GTIA IN QGA-FLD NOT > ZEROES
              AND DBC-GLS-NOMC IN QGA-FLD NOT > SPACES
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN QGA-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN QGA-FLD NOT > SPACES
              AND DBC-IND-ICLI IN QGA-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN QGA-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-QGA.
       FIN-VAL-CON-KEY-QGA.
           EXIT.

       VAL-CON-IKY-QGA SECTION.
       INI-VAL-CON-IKY-QGA.
           IF     GDG-CAI-GTIA IN QGA-FLD NOT > SPACES
              AND GDG-IIC-GTIA IN QGA-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-QGA.
       FIN-VAL-CON-IKY-QGA.
           EXIT.

       VAL-NUM-KEY-QGA SECTION.
       INI-VAL-NUM-KEY-QGA.
           PERFORM VAL-NUM-IKY-QGA.
           PERFORM VAL-NUM-MKY-QGA.
           PERFORM VAL-NUM-AKY-QGA.
       FIN-VAL-NUM-KEY-QGA.
           EXIT.

       VAL-NUM-IKY-QGA SECTION.
       INI-VAL-NUM-IKY-QGA.
       VAL-NUM-GDG-IIC-GTIA.
           MOVE GDG-IIC-GTIA-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-IIC-GTIA IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-IIC-GTIA-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-IKY-QGA.
       FIN-VAL-NUM-IKY-QGA.
           EXIT.

       VAL-NUM-MKY-QGA SECTION.
       INI-VAL-NUM-MKY-QGA.
       FIN-VAL-NUM-MKY-QGA.
           EXIT.

       VAL-NUM-AKY-QGA SECTION.
       INI-VAL-NUM-AKY-QGA.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-AKY-QGA.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-AKY-QGA.
           EXIT.

       VAL-NUM-FLD-QGA SECTION.
       INI-VAL-NUM-FLD-QGA.
       VAL-NUM-GVT-SGV-VCTS.
           MOVE GVT-SGV-VCTS-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-SGV-VCTS IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-SGV-VCTS-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-FLD-QGA.
       VAL-NUM-GVT-SGV-LTSN.
           MOVE GVT-SGV-LTSN-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-SGV-LTSN IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-SGV-LTSN-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-FLD-QGA.
       VAL-NUM-GVT-SGV-VPND.
           MOVE GVT-SGV-VPND-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-SGV-VPND IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-SGV-VPND-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-FLD-QGA.
       VAL-NUM-GVT-SGV-VGAS.
           MOVE GVT-SGV-VGAS-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-SGV-VGAS IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-SGV-VGAS-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-FLD-QGA.
       VAL-NUM-FRM-CLA-COBT.
           MOVE FRM-CLA-COBT-ALF IN QGA-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-CLA-COBT IN QGA-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-CLA-COBT-LEN IN QGA-FLD
                GO TO FIN-VAL-NUM-FLD-QGA.
       FIN-VAL-NUM-FLD-QGA.
           EXIT.

       EDT-KEY-QGA SECTION.
       INI-EDT-KEY-QGA.
           PERFORM EDT-IKY-QGA.
           PERFORM EDT-MKY-QGA.
           PERFORM EDT-AKY-QGA.
       FIN-EDT-KEY-QGA.
           EXIT.

       EDT-IKY-QGA SECTION.
       INI-EDT-IKY-QGA.
           IF GDG-IIC-GTIA-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GDG-IIC-GTIA-LEN IN QGA-FLD
                GO TO FIN-EDT-IKY-QGA.
           MOVE GDG-IIC-GTIA IN QGA-FLD TO GDG-IIC-GTIA-EDT IN QGA-EDT.
           MOVE GDG-IIC-GTIA-EDT IN QGA-EDT TO
                GDG-IIC-GTIA-ALF IN QGA-FLD.
       FIN-EDT-IKY-QGA.
           EXIT.

       EDT-MKY-QGA SECTION.
       INI-EDT-MKY-QGA.
       FIN-EDT-MKY-QGA.
           EXIT.

       EDT-AKY-QGA SECTION.
       INI-EDT-AKY-QGA.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN QGA-FLD
                GO TO FIN-EDT-AKY-QGA.
           MOVE DBC-NUM-ICLI IN QGA-FLD TO
                DBC-NUM-ICLI-EDT IN QGA-EDT.
           MOVE DBC-NUM-ICLI-EDT IN QGA-EDT TO
                DBC-NUM-ICLI-ALF IN QGA-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-AKY-QGA.
           EXIT.

       EDT-FLD-QGA SECTION.
       INI-EDT-FLD-QGA.
           IF GVT-SGV-VCTS-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VCTS-LEN IN QGA-FLD
                GO TO FIN-EDT-FLD-QGA.
           MOVE GVT-SGV-VCTS IN QGA-FLD TO GVT-SGV-VCTS-EDT IN QGA-EDT.
           MOVE GVT-SGV-VCTS-EDT IN QGA-EDT TO
                GVT-SGV-VCTS-ALF IN QGA-FLD.
           IF GVT-SGV-LTSN-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-LTSN-LEN IN QGA-FLD
                GO TO FIN-EDT-FLD-QGA.
           MOVE GVT-SGV-LTSN IN QGA-FLD TO GVT-SGV-LTSN-EDT IN QGA-EDT.
           MOVE GVT-SGV-LTSN-EDT IN QGA-EDT TO
                GVT-SGV-LTSN-ALF IN QGA-FLD.
           IF GVT-SGV-VPND-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VPND-LEN IN QGA-FLD
                GO TO FIN-EDT-FLD-QGA.
           MOVE GVT-SGV-VPND IN QGA-FLD TO GVT-SGV-VPND-EDT IN QGA-EDT.
           MOVE GVT-SGV-VPND-EDT IN QGA-EDT TO
                GVT-SGV-VPND-ALF IN QGA-FLD.
           IF GVT-SGV-VGAS-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO GVT-SGV-VGAS-LEN IN QGA-FLD
                GO TO FIN-EDT-FLD-QGA.
           MOVE GVT-SGV-VGAS IN QGA-FLD TO GVT-SGV-VGAS-EDT IN QGA-EDT.
           MOVE GVT-SGV-VGAS-EDT IN QGA-EDT TO
                GVT-SGV-VGAS-ALF IN QGA-FLD.
           IF FRM-CLA-COBT-LEN IN QGA-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-CLA-COBT-LEN IN QGA-FLD
                GO TO FIN-EDT-FLD-QGA.
           MOVE FRM-CLA-COBT IN QGA-FLD TO FRM-CLA-COBT-EDT IN QGA-EDT.
           MOVE FRM-CLA-COBT-EDT IN QGA-EDT TO
                FRM-CLA-COBT-ALF IN QGA-FLD.
       FIN-EDT-FLD-QGA.
           EXIT.
      *<<<< EOF
      *MHM-INI 2-OCT-2003
       PUT-GLE-QGA SECTION.
       INI-PUT-GLE-QGA.
           IF PGM-STAT-GDG-OKS AND
              GDG-IND-EGLE IN GDG = 'S'
               MOVE GDG-CAI-GTIA IN GDG TO GLE-CAI-GTIA IN GLE
               MOVE GDG-IIC-GTIA IN GDG TO GLE-IIC-GTIA IN GLE
               MOVE GDG-COD-GGTA IN GDG TO GLE-COD-PACR IN GLE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GLE
               MOVE FIO-STAT TO PGM-STAT-GLE
               IF NOT FIO-STAT-OKS
                   MOVE '23'         TO PGM-STAT-GLE
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'GLE    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GLE-QGA
               ELSE
                   MOVE '00' TO PGM-STAT-GLE
           ELSE
               MOVE '23' TO PGM-STAT-GLE.

           IF PGM-STAT-GLE-NUL
               GO TO FIN-PUT-GLE-QGA.

           IF NOT PGM-STAT-GLE-OKS
               PERFORM CLR-GLE-QGA
               GO TO FIN-PUT-GLE-QGA.

      *BUS-TAB busca glosa de codigo en tabla
           IF GLE-COD-REGI IN GLE > SPACES
               MOVE 'BGL' TO TAB-COD-SIST
               MOVE 'REG ' TO TAB-COD-TTAB IN TAB
               MOVE GLE-COD-REGI IN GLE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-REGI IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-REGI IN QGA-FLD.

       FIN-PUT-GLE-QGA.
           EXIT.

       CLR-GLE-QGA SECTION.
       INI-CLR-GLE-QGA.
           MOVE SPACES TO FRM-GLS-REGI IN QGA-FLD.
       FIN-CLR-GLE-QGA.
           EXIT.

      *MHM-FIN 2-OCT-2003
      *PVG INI 9-JUL-1996
       PUT-GDO-QGA SECTION.
       INI-PUT-GDO-QGA.
           IF PGM-STAT-GDG-OKS AND
              GDG-IND-EGDO IN GDG = 'S'
               MOVE GDG-CAI-GTIA IN GDG TO GDO-CAI-GTIA IN GDO
               MOVE GDG-IIC-GTIA IN GDG TO GDO-IIC-GTIA IN GDO
               MOVE ZEROES              TO GDO-NUM-IGDO IN GDO
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM BGL-FIO-GDO
               MOVE FIO-STAT TO PGM-STAT-GDO
               IF NOT ( FIO-STAT-OKS AND
                       GDG-CAI-GTIA IN GDG = GDO-CAI-GTIA IN GDO AND
                       GDG-IIC-GTIA IN GDG = GDO-IIC-GTIA IN GDO    )
                   MOVE '23'         TO PGM-STAT-GDO
                   MOVE 'BGL'        TO MSG-COD-SIST
                   MOVE 'GDO    NEX' TO MSG-COD-MENS
                   GO TO FIN-PUT-GDO-QGA
               ELSE
                   MOVE '00' TO PGM-STAT-GDO
           ELSE
               MOVE '23' TO PGM-STAT-GDO.

           IF PGM-STAT-GDO-NUL
               GO TO FIN-PUT-GDO-QGA.

           IF NOT PGM-STAT-GDO-OKS
               PERFORM CLR-GDO-QGA
               GO TO FIN-PUT-GDO-QGA.

           MOVE GDO-COD-TIEM IN GDO TO CNE-GDO-COD-TIEM.
           MOVE GDO-COD-INEM IN GDO TO CNE-GDO-COD-INEM.
           MOVE GDO-COD-SIEM IN GDO TO CNE-GDO-COD-SIEM.


      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE CNE-GDO-COD-TIEM TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE CNE-GDO-COD-INEM TO WSS-CIV-EMI.
           MOVE CNE-GDO-COD-SIEM TO WSS-SIV-EMI.
           MOVE WSS-CIV-SIV TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IEMI IN QGA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IEMI IN QGA-FLD.

      * Valoriza documentos desde otro sistema
           MOVE SPACES TO INT-TIPT.
           PERFORM VLR-DAP.
           IF INT-TIPT > SPACES
            MOVE GVT-SGV-VCTS IN GVT TO GVT-SGV-VCTS IN QGA-FLD
            MOVE GVT-SGV-LTSN IN GVT TO GVT-SGV-LTSN IN QGA-FLD
            MOVE GVT-SGV-VPND IN GVT TO GVT-SGV-VPND IN QGA-FLD.

       FIN-PUT-GDO-QGA.
           EXIT.

       CLR-GDO-QGA SECTION.
       INI-CLR-GDO-QGA.
           MOVE SPACES TO CNE-GDO-COD-TIEM.
           MOVE SPACES TO CNE-GDO-COD-INEM.
           MOVE SPACES TO CNE-GDO-COD-SIEM.
       FIN-CLR-GDO-QGA.
           EXIT.
      *XON-INI 15-NOV-2010   CLAUSULA DE COBERTURA
       OBT-CLA-COBT  SECTION.
      *----------------------
       INI-OBT-CLA-COBT.
           MOVE    ZEROES       TO  D17-CLA-COBT IN D17.
      *    valida clausula de cobertura
           PERFORM SUBTIPO.

      *    valida por tabla de version
           MOVE   '2'           TO  D17-COD-PART IN D17.
           MOVE   'BGL'         TO  FIO-SIST.
           MOVE   'VSN'         TO  TAB-COD-TTAB IN TAB.
           MOVE   'D17DIGTO14'  TO  TAB-COD-CTAB IN TAB.
           MOVE    FIO-GET-KEY  TO  FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND
                   TAB-IND-VIGE IN TAB = 'S' )
                    PERFORM BUS-REG-GDD.

      *    valida gap
           PERFORM VAL-REG-GAP.
           MOVE    D17-CLA-COBT IN D17  TO  FRM-CLA-COBT IN QGA-FLD.
       FIN-OBT-CLA-COBT.
           EXIT.
      *
       SUBTIPO  SECTION.
      *-----------------
       INI-SUBTIPO.
      *Especifica - General
           IF GDG-COD-LGTA IN GDG = 'A'
              MOVE '3'    TO   D17-COD-CARA  IN D17
              MOVE '2'    TO   D17-COD-LIMI  IN D17
           ELSE
           IF GDG-COD-LGTA IN GDG = 'G'
              MOVE '1'    TO   D17-COD-CARA  IN D17
              MOVE '2'    TO   D17-COD-LIMI  IN D17
           ELSE
              MOVE '2'    TO   D17-COD-CARA  IN D17
              MOVE '1'    TO   D17-COD-LIMI  IN D17.

       FIN-SUBTIPO.
           EXIT.
      *
       BUS-REG-GDD  SECTION.
      *---------------------
       INI-BUS-REG-GDD.
           MOVE       0              TO WSS-NUM-RDC.
           MOVE  GDG-CIC-GTIA IN GDG TO GDD-CIC-GTIA IN GDD
           MOVE 'GDD-KEY-AGDD'       TO FIO-AKEY.
           MOVE  FIO-GET-NLS         TO FIO-CMND.
       LUP-BUS-REG-GDD.
           PERFORM BGL-FIO-GDD.
           IF FIO-STAT-OKS AND
              GDG-CIC-GTIA IN GDG = GDD-CIC-GTIA IN GDD
               ADD          1        TO WSS-NUM-RDC
               PERFORM VAL-COD-LIMI
               MOVE   'GDD-KEY-AGDD' TO FIO-AKEY
               MOVE    FIO-GET-NXT   TO FIO-CMND
               GO TO   LUP-BUS-REG-GDD.

           IF  WSS-NUM-RDC  NOT > 1
               MOVE    '2'           TO D17-COD-PART IN D17
           ELSE
               MOVE    '1'           TO D17-COD-PART IN D17.
       FIN-BUS-REG-GDD.
           EXIT.
      *
       VAL-COD-LIMI  SECTION.
      *----------------------
       INI-VAL-COMI-LIMI.
           MOVE   'N'      TO WSS-IND-CARA.
           IF WSS-IND-CARA = 'S'
               GO TO FIN-VAL-COMI-LIMI.
           IF GDG-COD-LGTA IN GDG NOT = 'G'
               GO TO FIN-VAL-COMI-LIMI.
           IF GDD-SGV-VLIM IN GDD > ZEROES
               MOVE '1'    TO   D17-COD-LIMI  IN D17
               MOVE 'S'    TO   WSS-IND-CARA
               GO TO FIN-VAL-COMI-LIMI.
           IF GDD-SGV-PLIM IN GDD < 100
               MOVE '1'    TO   D17-COD-LIMI  IN D17
               MOVE 'S'    TO   WSS-IND-CARA
               GO TO FIN-VAL-COMI-LIMI.

       FIN-VAL-COMI-LIMI.
           EXIT.
      *
       VAL-REG-GAP  SECTION.
      *---------------------
       INI-VAL-REG-GAP.
           IF GDG-COD-LGTA IN GDG = 'A'
               MOVE     '2'            TO D17-COD-GPRE IN D17
               GO TO FIN-VAL-REG-GAP.
           IF GDG-COD-LGTA IN GDG = 'G'
               MOVE     '1'            TO D17-COD-GPRE IN D17
               GO TO FIN-VAL-REG-GAP.

           MOVE    ZEROES              TO WSS-NUM-IGAP.
           MOVE    '9'                 TO D17-COD-GPRE IN D17.
           MOVE    GDG-CAI-GTIA IN GDG TO GAP-CAI-GTIA IN GAP.
           MOVE    GDG-IIC-GTIA IN GDG TO GAP-IIC-GTIA IN GAP.
           MOVE    ZEROES              TO GAP-COD-PACR IN GAP.
           MOVE    FIO-GET-NLS         TO FIO-CMND.
           PERFORM BGL-FIO-GAP.
       LUP-VAL-REG-GAP.
            IF NOT ( FIO-STAT-OKS AND
                    GDG-CIC-GTIA IN GDG = GAP-COD-CGTA IN GAP )
                    GO TO CON-VAL-REG-GAP.

            ADD 1 TO WSS-NUM-IGAP.
       NXT-VAL-REG-GAP.
           MOVE    FIO-GET-NXT TO FIO-CMND.
           PERFORM BGL-FIO-GAP.
           IF FIO-STAT-OKS
              GO TO LUP-VAL-REG-GAP.
       CON-VAL-REG-GAP.
           IF WSS-NUM-IGAP = ZEROES
               MOVE  '1' TO D17-COD-GPRE IN D17
               GO TO FIN-VAL-REG-GAP.
           IF WSS-NUM-IGAP = 1
               MOVE  '1' TO D17-COD-GPRE IN D17
           ELSE
               MOVE  '2' TO D17-COD-GPRE IN D17.
       FIN-VAL-REG-GAP.
           EXIT.
      *XON-FIN 15-NOV-2010
      *>>>>
