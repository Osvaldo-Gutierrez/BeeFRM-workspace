       DEL-COM-IMP-GAS SECTION.
       INI-DEL-COM-IMP-GAS.
           MOVE 'COM   ' TO WSS-IND-TTAS.
           PERFORM DEL-ALL-COM-IMP-GAS.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-DEL-COM-IMP-GAS.
           MOVE 'IMP   ' TO WSS-IND-TTAS.
           PERFORM DEL-ALL-COM-IMP-GAS.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-DEL-COM-IMP-GAS.
           MOVE 'GAS   ' TO WSS-IND-TTAS.
           PERFORM DEL-ALL-COM-IMP-GAS.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-DEL-COM-IMP-GAS.
           MOVE 'RDT   ' TO WSS-IND-TTAS.
           PERFORM DEL-ALL-COM-IMP-GAS.
       FIN-DEL-COM-IMP-GAS.
           EXIT.

       DEL-ALL-COM-IMP-GAS SECTION.
           MOVE SPACES TO CCO-STAT CCO-MENS CCO-CIC-COMI CCO-COM-ANT.
       INI-DEL-ALL-COM-IMP-GAS.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO COZ-CAI-IOPC IN COZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO COZ-IIC-IOPC IN COZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO COZ-NUM-ICAN IN COZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO COZ-CAI-IOPV IN COZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO COZ-IIC-IOPV IN COZ.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE ZEROES TO WSS-COM-NUM-IVCT
           ELSE
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT.
           MOVE WSS-COM-NUM-IVCT    TO COZ-NUM-IVCT IN COZ.
           MOVE WSS-IND-TTAS        TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-DEL-ALL-COM-IMP-GAS.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
               CAZ-CAI-IOPC IN CAZ-FLD = COZ-CAI-IOPC IN COZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = COZ-IIC-IOPC IN COZ AND
               CAZ-NUM-ICAN IN CAZ-FLD = COZ-NUM-ICAN IN COZ AND
               CAZ-CAI-IOPC IN CAZ-FLD = COZ-CAI-IOPV IN COZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = COZ-IIC-IOPV IN COZ AND
               WSS-COM-NUM-IVCT        = COZ-NUM-IVCT IN COZ AND
               WSS-GLS-NTAS            = COZ-GLS-NTAS IN COZ )
               GO TO FIN-DEL-ALL-COM-IMP-GAS.
           IF (COZ-IND-TTAS IN COZ = 'COM   ' OR 'IMP   ' OR 'GAS   '
                                     OR 'COM000')
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-DEL-ALL-COM-IMP-GAS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'    TO MSG-COD-SIST
               MOVE 'COZKEYUNEX'        TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MENS
               MOVE COZ-KEY-IICG IN COZ TO FRM-MEN2
               GO TO FIN-DEL-ALL-COM-IMP-GAS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'               TO MSG-COD-SIST
               MOVE 'COZDEL NEX'        TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MENS
               MOVE COZ-KEY-IICG IN COZ TO FRM-MEN2
               GO TO FIN-DEL-ALL-COM-IMP-GAS.
       NXT-DEL-ALL-COM-IMP-GAS.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           GO TO LUP-DEL-ALL-COM-IMP-GAS.
       FIN-DEL-ALL-COM-IMP-GAS.
           EXIT.

       OBT-PLAN-COMI SECTION.
       INI-OBT-PLAN-COMI.
           IF CCO-COD-EVEN = SPACES
              MOVE 'CAN' TO CCO-COD-EVEN.
           MOVE SPACES TO CCO-STAT CCO-MENS CCO-CIC-COMI CCO-COM-ANT.
           IF OPZ-COD-PLCO IN OPZ NOT > SPACES
               MOVE SPACES TO PCZ
               GO TO FIN-OBT-PLAN-COMI.
       LUP-OBT-PLAN-COMI.
           MOVE OPZ-COD-OFOC IN OPZ TO PCZ-COD-OFIC IN PCZ.
           PERFORM LEE-PCP-GEN.
           IF PCZ NOT = SPACES
              GO TO FIN-OBT-PLAN-COMI.
           MOVE '*  ' TO PCZ-COD-OFIC IN PCZ.
           PERFORM LEE-PCP-GEN.
           IF PCZ NOT = SPACES
              GO TO FIN-OBT-PLAN-COMI.
           IF CCO-CIC-ICLI = '    00000000' 
              GO TO FIN-OBT-PLAN-COMI.
           MOVE '    00000000' TO CCO-CIC-ICLI
           GO TO LUP-OBT-PLAN-COMI.
       FIN-OBT-PLAN-COMI.
           EXIT.
       LEE-PCP-GEN SECTION.
       INI-LEE-PCP-GEN.
           MOVE CCO-CIC-ICLI TO PCZ-CIC-ICLI IN PCZ.
           MOVE OPZ-COD-PLCO IN OPZ TO PCZ-COD-PLAN IN PCZ.
           MOVE CCO-COD-EVEN        TO PCZ-COD-EVEN IN PCZ.
           MOVE OPZ-NUM-SCOL IN OPZ TO PCZ-NUM-SPLA IN PCZ.
           MOVE OPZ-NUM-ACOL IN OPZ TO PCZ-NUM-APLA IN PCZ.
           MOVE OPZ-NUM-MCOL IN OPZ TO PCZ-NUM-MPLA IN PCZ.
           MOVE OPZ-NUM-DCOL IN OPZ TO PCZ-NUM-DPLA IN PCZ.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
       LUP-LEE-PCP-GEN.
           PERFORM CBZ-FIO-PCZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-COD-PLCO IN OPZ = PCZ-COD-PLAN IN PCZ AND
                    CCO-COD-EVEN        = PCZ-COD-EVEN IN PCZ AND
                    CCO-CIC-ICLI        = PCZ-CIC-ICLI IN PCZ )
              MOVE SPACES TO PCZ
              GO TO FIN-LEE-PCP-GEN.
           IF PCZ-IND-VIGE IN PCZ = 'N' OR
              PCZ-FEC-FPLA IN PCZ > OPZ-FEC-FCOL IN OPZ
              MOVE FIO-GET-PRV TO FIO-CMND
              GO TO LUP-LEE-PCP-GEN.
       FIN-LEE-PCP-GEN.
           EXIT.
       OBT-PLAN-IMPU SECTION.
       INI-OBT-PLAN-IMPU.
           MOVE SPACES              TO CIM-STAT CIM-MENS.
           IF  OPZ-COD-PLIM IN OPZ NOT > SPACES
               MOVE SPACES          TO PIZ
               GO TO FIN-OBT-PLAN-IMPU.
           MOVE OPZ-COD-PLIM IN OPZ TO PIZ-COD-PLAN IN PIZ.
           MOVE 'CAN'               TO PIZ-COD-EVEN IN PIZ.
           MOVE OPZ-COD-OFOC IN OPZ TO PIZ-COD-OFIC IN PIZ.
           MOVE OPZ-NUM-SCOL IN OPZ TO PIZ-NUM-SPLA IN PIZ.
           MOVE OPZ-NUM-ACOL IN OPZ TO PIZ-NUM-APLA IN PIZ.
           MOVE OPZ-NUM-MCOL IN OPZ TO PIZ-NUM-MPLA IN PIZ.
           MOVE OPZ-NUM-DCOL IN OPZ TO PIZ-NUM-DPLA IN PIZ.
           MOVE FIO-GET-LEQ         TO FIO-CMND.
       LUP-OBT-PLAN-IMPU.
           PERFORM CBZ-FIO-PIZ.
           IF NOT (FIO-STAT-OKS AND
                   OPZ-COD-PLIM IN OPZ = PIZ-COD-PLAN IN PIZ)
              MOVE SPACES TO PIZ
              GO TO FIN-OBT-PLAN-IMPU.
           IF NOT (PIZ-COD-EVEN IN PIZ = 'CAN')
              MOVE SPACES TO PIZ
              GO TO FIN-OBT-PLAN-IMPU.
           IF NOT (OPZ-COD-OFOC IN OPZ = PIZ-COD-OFIC IN PIZ OR
                   PIZ-COD-OFIC IN PIZ = '*  ')
              MOVE OPZ-COD-OFOC IN OPZ TO PIZ-COD-OFIC IN PIZ
              MOVE OPZ-NUM-SCOL IN OPZ TO PIZ-NUM-SPLA IN PIZ
              MOVE OPZ-NUM-ACOL IN OPZ TO PIZ-NUM-APLA IN PIZ
              MOVE OPZ-NUM-MCOL IN OPZ TO PIZ-NUM-MPLA IN PIZ
              MOVE OPZ-NUM-DCOL IN OPZ TO PIZ-NUM-DPLA IN PIZ
              MOVE '*  ' TO PIZ-COD-OFIC IN PIZ
              GO TO LUP-OBT-PLAN-IMPU.
           IF PIZ-IND-VIGE IN PIZ = 'N' OR
              PIZ-FEC-FPLA IN PIZ > OPZ-FEC-FCOL IN OPZ
              MOVE FIO-GET-PRV TO FIO-CMND
              GO TO LUP-OBT-PLAN-IMPU.
       FIN-OBT-PLAN-IMPU.
           EXIT.

       ADD-GAS-VEC SECTION.
       INI-ADD-GAS-VEC.
           MOVE SPACES          TO INT-TIPT.
           IF CAZ-SGV-GAST IN CAZ-FLD  > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'GAS'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'GEN'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-SGV-GAST IN CAZ-FLD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT     TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
           IF FRM-VAL-PORT IN CAZ-FLD > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'GAS'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'PCA'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE FRM-VAL-PORT IN CAZ-FLD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT     TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
           IF WSS-SGV-GPRO IN WSS-VARI > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'COM'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'PRO'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE WSS-SGV-GPRO IN WSS-VARI
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT     TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
       FIN-ADD-GAS-VEC.
           EXIT.

       ADD-IMP-VEN-VEC SECTION.
       INI-ADD-IMP-VEN-VEC.
           MOVE SPACES          TO INT-TIPT.
           IF VEZ-VAL-IMPU IN VEZ  > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'IMP'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'VEN'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT     TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
               IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
                  MULTIPLY VEZ-VAL-IMPU IN VEZ  BY SCR-SGV-VCAM
                     GIVING VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE) ROUNDED
               ELSE
                 MOVE VEZ-VAL-IMPU IN VEZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE).
       FIN-ADD-IMP-VEN-VEC.
           EXIT.
       PUT-COM-IMP-GAS SECTION.
       INI-PUT-COM-IMP-GAS.
           SET CCO-J  TO 1.
       LUP-PUT-COM-IMP-GAS.
           IF  CCO-J  > VEC-TOPE
               GO TO FIN-PUT-COM-IMP-GAS.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO COZ-CAI-IOPC IN COZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO COZ-IIC-IOPC IN COZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO COZ-NUM-ICAN IN COZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO COZ-CAI-IOPV IN COZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO COZ-IIC-IOPV IN COZ.
           MOVE WSS-COM-NUM-IVCT        TO COZ-NUM-IVCT IN COZ.
           MOVE VEC-COD-CNDC IN VEC-ICG (CCO-J)
                                        TO COZ-GLS-NTAS IN COZ.
           MOVE VEC-COD-TCDC IN VEC-ICG (CCO-J)
                                        TO COZ-GLS-STAS IN COZ.
           MOVE VEC-FEC-FACT IN VEC-ICG (CCO-J)
                                        TO COZ-FEC-FINI IN COZ.
           MOVE VEC-VAL-MCAL IN VEC-ICG (CCO-J)
                                        TO COZ-SGV-MCAL IN COZ.
           MOVE VEC-VAL-TIMP IN VEC-ICG (CCO-J)
                                        TO COZ-SGV-TINT IN COZ.
           MOVE VEC-SGV-LIQU IN VEC-ICG (CCO-J)
                                        TO COZ-SGV-MNTO IN COZ.
           MOVE VEC-INT-TIPT IN VEC-ICG (CCO-J)
                                        TO COZ-COD-TIPT IN COZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'COZPUT ERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PUT-COM-IMP-GAS.
           SET   CCO-J  UP BY 1.
           GO TO LUP-PUT-COM-IMP-GAS.
       FIN-PUT-COM-IMP-GAS.
           EXIT.

       CAL-COM SECTION.
       INI-CAL-COM.
           IF PCZ-COD-PLAN IN PCZ NOT > SPACES
               GO TO FIN-CAL-COM.
           MOVE SPACES TO  CCO-COM-ANT.
           PERFORM REC-PCZ VARYING CCO-I FROM 1 BY 1
                           UNTIL ( CCO-I > CCO-MAX
                           OR PCZ-COD-COMI IN PCZ (CCO-I) NOT > SPACES
                           OR CCO-STAT > SPACES ).
           IF CCO-STAT > SPACES
               MOVE 'CBZ'    TO MSG-COD-SIST
               MOVE CCO-STAT TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               IF VEZ-FEC-FVEN IN VEZ < CAZ-FEC-FCAN IN CAZ
                  MOVE VEZ-NUM-DVEN IN VEZ TO CCO-NUM-DANT IN CCO-VARI
                  MOVE VEZ-NUM-MVEN IN VEZ TO CCO-NUM-MANT IN CCO-VARI
                  MOVE VEZ-NUM-SVEN IN VEZ TO CCO-NUM-SANT IN CCO-VARI
                  MOVE VEZ-NUM-AVEN IN VEZ TO CCO-NUM-AANT IN CCO-VARI
               ELSE
                  MOVE CAZ-NUM-DCAN IN CAZ TO CCO-NUM-DANT IN CCO-VARI
                  MOVE CAZ-NUM-MCAN IN CAZ TO CCO-NUM-MANT IN CCO-VARI
                  MOVE CAZ-NUM-SCAN IN CAZ TO CCO-NUM-SANT IN CCO-VARI
                  MOVE CAZ-NUM-ACAN IN CAZ TO CCO-NUM-AANT IN CCO-VARI.
       FIN-CAL-COM.
           EXIT.
       BUS-PCZ-FLV SECTION.
       INI-BUS-PCZ-FLV.
           PERFORM OBT-CIC-PCZ.
       FIN-BUS-PCZ-FLV.
           EXIT.
       REC-PCZ SECTION.
       INI-REC-PCZ.
           PERFORM OBT-CIC-PCZ.
           IF NOT (CCO-CIC-COMI IN CCO-VARI > SPACES)
               GO TO FIN-REC-PCZ.
           IF NOT (CCO-CIC-COMI IN CCO-VARI = CCO-COM-ANT)
                 MOVE 0 TO WSS-CAL-COM-SDO
                 MOVE 0 TO WSS-CAL-COM-DVN
                 MOVE 0 TO WSS-CAL-COM-CAP
                 MOVE 0 TO WSS-CAL-COM-GAS
                 MOVE 0 TO WSS-CAL-COM-DOC
                 MOVE 0 TO WSS-CAL-COM-FLV
                 MOVE CCO-CIC-COMI IN CCO-VARI TO CCO-COM-ANT.
           IF (CCO-CIC-COMI IN CCO-VARI = 'FLV' AND
               NOT CAL-COM-FLV)
              PERFORM COZ-VAL-FLV-CAN
           ELSE
           IF (CCO-CIC-CONC IN CCO-VARI = 'DVN' AND
               NOT CAL-COM-DVN)
              PERFORM COZ-VAL-DVN-CAN
           ELSE
           IF (CCO-CIC-CONC IN CCO-VARI = 'CVE' AND
               NOT CAL-COM-CAP)
              PERFORM COZ-VAL-CAP-CAN
           ELSE
           IF (CCO-CIC-CONC IN CCO-VARI = 'CAP' AND
               NOT CAL-COM-SDO)
              PERFORM COZ-VAL-SDO-CAN
           ELSE
           IF (CCO-CIC-CONC IN CCO-VARI = 'DOC' AND
               NOT CAL-COM-DOC)
              PERFORM COZ-VAL-DOC-CAN
           ELSE
           IF (CCO-CIC-CONC IN CCO-VARI = 'GAS' AND
               NOT CAL-COM-GAS)
              PERFORM COZ-VAL-GAS-CAN.
       FIN-REC-PCZ.
           EXIT.

       OBT-CIC-PCZ SECTION.
       INI-OBT-CIC-PCZ.
           MOVE 'CBZ'                       TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS'                       TO TAB-COD-TTAB IN TAB.
           MOVE PCZ-COD-COMI IN PCZ (CCO-I) TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY                 TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CCO-STAT
                   GO TO FIN-OBT-CIC-PCZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CCO-CIC-COMI
           ELSE
               MOVE 'COD    NEX'            TO CCO-STAT
               GO TO FIN-OBT-CIC-PCZ.
           MOVE 'CBZ'                       TO MSC-COD-SIST FIO-SIST.
           MOVE 'SCTB'                      TO MSC-COD-TMSC IN MSC.
           MOVE PCZ-IND-SCTB IN PCZ (CCO-I) TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY                 TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CCO-STAT
                   GO TO FIN-OBT-CIC-PCZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CCO-CIC-SCTB
           ELSE
               MOVE 'COD    NEX'            TO CCO-STAT
               GO TO FIN-OBT-CIC-PCZ.
           MOVE 'CBZ'                       TO TAB-COD-SIST FIO-SIST.
           MOVE 'CPT'                       TO TAB-COD-TTAB IN TAB.
           MOVE PCZ-COD-CONC IN PCZ (CCO-I) TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY                 TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CCO-STAT
                   GO TO FIN-OBT-CIC-PCZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CCO-CIC-CONC
           ELSE
               MOVE 'COD    NEX'            TO CCO-STAT
               GO TO FIN-OBT-CIC-PCZ.
       FIN-OBT-CIC-PCZ.
           EXIT.
       COZ-VAL-DVN-CAN SECTION.
       INI-COM-VAL-DVN-CAN.
           MOVE DLZ-VAL-NDLC IN DLZ TO CCO-VAL-CALC IN CCO-VARI.
           PERFORM COZ-VAL-ALL.
           IF WSS-COM-CAL > 0
              MOVE 1 TO WSS-CAL-COM-DVN.
       FIN-COM-VAL-DVN-CAN.
           EXIT.
       COZ-VAL-CAP-CAN SECTION.
       INI-COM-VAL-CAP-CAN.
           MOVE VEZ-VAL-SCAP IN VEZ TO CCO-VAL-CALC IN CCO-VARI.
           PERFORM COZ-VAL-ALL.
           IF WSS-COM-CAL > 0
              MOVE 1 TO WSS-CAL-COM-CAP.
       FIN-COM-VAL-CAP-CAN.
           EXIT.
       COZ-VAL-SDO-CAN SECTION.
       INI-COM-VAL-SDO-CAN.
           MOVE OPZ-VAL-SCRE IN OPZ TO CCO-VAL-CALC IN CCO-VARI.
           PERFORM COZ-VAL-ALL.
           IF WSS-COM-CAL > 0
              MOVE 1 TO WSS-CAL-COM-SDO.
       FIN-COM-VAL-CAP-CAN.
           EXIT.
       COZ-VAL-DOC-CAN SECTION.
       INI-COM-VAL-DOC-CAN.
           MOVE DLZ-VAL-SDLC IN DLZ TO CCO-VAL-CALC IN CCO-VARI.
           PERFORM COZ-VAL-ALL.
           IF WSS-COM-CAL > 0
              MOVE 1 TO WSS-CAL-COM-DOC.
       FIN-COM-VAL-DOC-CAN.
           EXIT.
       COZ-VAL-GAS-CAN SECTION.
       INI-COM-VAL-GAS-CAN.
           MOVE CAZ-SGV-GAST IN CAZ-FLD TO CCO-VAL-CALC IN CCO-VARI.
           IF WSS-CIC-VCAM NOT = '0999'
            AND WSS-CIC-TVAL = '0'
               DIVIDE  CCO-VAL-CALC IN CCO-VARI BY WSS-VAL-VCAM
                            GIVING CCO-VAL-CALC IN CCO-VARI ROUNDED.
           PERFORM COZ-VAL-ALL.
           IF WSS-COM-CAL > 0
              MOVE 1 TO WSS-CAL-COM-GAS.
       FIN-COM-VAL-GAS-CAN.
           EXIT.
       COZ-VAL-FLV-CAN SECTION.
       INI-COM-VAL-FLV-CAN.
              IF PCZ-COD-CONC IN PCZ (CCO-I) = 'CAP'
                 MOVE FRM-SGV-COMI IN CAZ-FLD
                                   TO PCZ-SGV-TIMP IN PCZ (CCO-I)
                 MOVE OPZ-VAL-SCRE IN OPZ TO CCO-VAL-CALC IN CCO-VARI
                 PERFORM COZ-VAL-ALL
                 IF WSS-COM-CAL  > 0
                    MOVE  1               TO WSS-CAL-COM-FLV
                 ELSE
                    NEXT SENTENCE
              ELSE
              IF PCZ-COD-CONC IN PCZ (CCO-I) = 'CVE'
                 MOVE FRM-SGV-COMI IN CAZ-FLD
                                   TO PCZ-SGV-TIMP IN PCZ (CCO-I)
                 MOVE VEZ-VAL-SCAP IN VEZ
                                      TO CCO-VAL-CALC IN CCO-VARI
                 PERFORM COZ-VAL-ALL
                 IF WSS-COM-CAL  > 0
                    MOVE  1               TO WSS-CAL-COM-FLV.
       FIN-COM-VAL-FLV-CAN.
           EXIT.
       COZ-VAL-ALL SECTION.
       INI-COM-VAL-ALL.
           IF ( PCZ-IND-SCTB IN PCZ (CCO-I) = SPACES OR 'VIG' )
              NEXT SENTENCE
           ELSE
           IF PCZ-IND-SCTB IN PCZ (CCO-I) NOT = VEZ-IND-SCTB IN CAZ-FLD
              GO TO FIN-COM-VAL-ALL.
           MOVE 0 TO WSS-COM-CAL.
           MOVE CCO-VAL-CALC IN CCO-VARI TO CCO-VAL-MCAL IN CCO-VARI.
           IF ( PCZ-VAL-MTOP IN PCZ (CCO-I) < CCO-VAL-CALC IN CCO-VARI
            AND PCZ-VAL-MTOP IN PCZ (CCO-I) NOT = ZEROES )
               GO TO FIN-COM-VAL-ALL.
           IF PCZ-SGV-TIMP IN PCZ (CCO-I) = ZEROES
               MOVE PCZ-VAL-COMI IN PCZ (CCO-I)
                                         TO CCO-VAL-CALC IN CCO-VARI
               GO TO CON-COM-VAL-ALL.
           IF PCZ-COD-TITA IN PCZ (CCO-I) = SPACES
               IF NOT ( VEZ-VAL-CAPI IN VEZ = VEZ-VAL-SCAP IN VEZ AND
                        VEZ-VAL-FINA IN VEZ = VEZ-VAL-SFIN IN VEZ )
                   GO TO FIN-COM-VAL-ALL
               ELSE
               COMPUTE  CCO-VAL-CALC IN CCO-VARI ROUNDED =
                        CCO-VAL-CALC IN CCO-VARI *
                        PCZ-SGV-TIMP IN PCZ (CCO-I) / 100
               MOVE     SPACES TO INT-TIPT
               GO TO CON-COM-VAL-ALL.

           MOVE PCZ-COD-TITA IN PCZ (CCO-I) TO WSS-COD-TITA.
           MOVE PCZ-SGV-TIMP IN PCZ (CCO-I) TO INT-TINT.
           MOVE WSS-COD-TIPT                TO INT-TIPT.
               MOVE CCO-NUM-DANT IN CCO-VARI TO FEC-DEC1
               MOVE CCO-NUM-MANT IN CCO-VARI TO FEC-MEC1
               MOVE CCO-NUM-SANT IN CCO-VARI TO FEC-SEC1
               MOVE CCO-NUM-AANT IN CCO-VARI TO FEC-AEC1
               IF VEZ-FEC-FVEN IN VEZ < CAZ-FEC-FCAN IN CAZ
                  MOVE VEZ-NUM-DVEN IN VEZ TO FEC-DEC2
                  MOVE VEZ-NUM-MVEN IN VEZ TO FEC-MEC2
                  MOVE VEZ-NUM-SVEN IN VEZ TO FEC-SEC2
                  MOVE VEZ-NUM-AVEN IN VEZ TO FEC-AEC2
               ELSE
                  MOVE CAZ-NUM-DCAN IN CAZ TO FEC-DEC2
                  MOVE CAZ-NUM-MCAN IN CAZ TO FEC-MEC2
                  MOVE CAZ-NUM-SCAN IN CAZ TO FEC-SEC2
                  MOVE CAZ-NUM-ACAN IN CAZ TO FEC-AEC2.
           IF FEC-FEC1 = FEC-FEC2
               GO TO FIN-COM-VAL-ALL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE SPACES TO MSG-COD-MENS IN MSG
               GO TO FIN-COM-VAL-ALL.
           MOVE FEC-NDIA TO INT-SEPD.
           PERFORM  GNS-CAL-TPE.
           COMPUTE  CCO-VAL-CALC IN CCO-VARI ROUNDED =
                    CCO-VAL-CALC IN CCO-VARI * INT-TIPE.

       CON-COM-VAL-ALL.
           IF PCZ-VAL-COMI IN PCZ (CCO-I) > CCO-VAL-CALC IN CCO-VARI AND
              PCZ-VAL-COMI IN PCZ (CCO-I) NOT = 0
               MOVE PCZ-VAL-COMI IN PCZ (CCO-I)
                                         TO CCO-VAL-CALC IN CCO-VARI
           ELSE
           IF PCZ-VAL-COMA IN PCZ (CCO-I) < CCO-VAL-CALC IN CCO-VARI AND
              PCZ-VAL-COMA IN PCZ (CCO-I) NOT = 0
               MOVE PCZ-VAL-COMA IN PCZ (CCO-I)
                                         TO CCO-VAL-CALC IN CCO-VARI.
           IF WSS-CIC-VCAM NOT = '0999'
            AND WSS-CIC-TVAL = '0'
               MULTIPLY CCO-VAL-CALC IN CCO-VARI BY WSS-VAL-VCAM
                            GIVING CCO-VAL-CALC IN CCO-VARI ROUNDED.

           MOVE CCO-VAL-CALC IN CCO-VARI TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ      TO PES-COD-VCAM.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE             TO CCO-VAL-CALC IN CCO-VARI.
     
           SET  CCO-J                    TO 1.
           SEARCH VEC-ICG  AT END
                  PERFORM GRA-VEC-PCZ
           WHEN
              ( VEC-COD-CNDC IN VEC-ICG (CCO-J) = 'COM' AND
                VEC-COD-TCDC IN VEC-ICG (CCO-J) =
                                         PCZ-COD-COMI IN PCZ (CCO-I))
                  PERFORM ACT-VEC-PCZ.

           MOVE 1                         TO WSS-COM-CAL.
           ADD CCO-VAL-CALC IN CCO-VARI   TO CAZ-VAL-COMI IN CAZ-FLD.
       FIN-COM-VAL-ALL.
           EXIT.

       ACT-VEC-PCZ SECTION.
       INI-ACT-VEC-PCZ.
           ADD CCO-VAL-MCAL IN CCO-VARI
                                TO VEC-VAL-MCAL IN VEC-ICG (CCO-J).
           ADD CCO-VAL-CALC IN CCO-VARI
                                TO VEC-SGV-LIQU IN VEC-ICG (CCO-J).
       FIN-ACT-VEC-PCZ.
           EXIT.

       GRA-VEC-PCZ SECTION.
       INI-GRA-VEC-PCZ.
           ADD  1                        TO VEC-TOPE.
           MOVE CCO-VAL-CALC IN CCO-VARI
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE).
           MOVE PCZ-SGV-TIMP IN PCZ (CCO-I)
                                TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE).
           MOVE 'COM'           TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE).
           MOVE PCZ-COD-COMI IN PCZ (CCO-I)
                                TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE).
           MOVE CCO-VAL-MCAL IN CCO-VARI
                                TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE).
           MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE).
           MOVE INT-TIPT        TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
       FIN-GRA-VEC-PCZ.
           EXIT.

       CAL-IMP SECTION.
       INI-CAL-IMP.
           IF PIZ-COD-PLAN IN PIZ NOT > SPACES
              GO TO FIN-CAL-IMP.
           PERFORM REC-PIZ VARYING CIM-I FROM 1 BY 1
                               UNTIL ( CIM-I > CIM-MAX
                               OR  PIZ-COD-IMPU IN PIZ (CIM-I)
                                                   NOT > SPACES
                               OR  CIM-STAT > SPACES).
           IF CIM-STAT  >  SPACES
               MOVE 'CBZ'    TO MSG-COD-SIST
               MOVE CIM-STAT TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-CAL-IMP.
           EXIT.

       REC-PIZ SECTION.
       INI-REC-PIZ.
           PERFORM OBT-CIC-PIZ.
           IF NOT (CIM-CIC-IMPU IN CIM-VARI > SPACES)
              GO TO FIN-REC-PIZ.
           IF (CIM-CIC-CONC IN CIM-VARI = 'COM' OR 'GAS')
              PERFORM IMP-VAL-VEC-CAN
           ELSE
           IF (CIM-CIC-CONC IN CIM-VARI = 'CVE')
              PERFORM IMP-VAL-CAP-CAN
           ELSE
           IF (CIM-CIC-CONC IN CIM-VARI = 'SEG')
              PERFORM IMP-VAL-SEG-CAN
           ELSE
           IF (CIM-CIC-CONC IN CIM-VARI = 'ICO')
              PERFORM IMP-VAL-ICO-CAN
           ELSE
           IF (CIM-CIC-CONC IN CIM-VARI = 'ICM')
              PERFORM IMP-VAL-ICM-CAN
           ELSE
           IF (CIM-CIC-CONC IN CIM-VARI = 'CAP')
              PERFORM IMP-VAL-SDO-CAN.
       FIN-REC-PIZ.
           EXIT.

       IMP-VAL-VEC-CAN SECTION.
       INI-IMP-VAL-VEC-CAN.
           SET   CIM-J                    TO 1.
           SEARCH VEC-ICG  AT END
                GO TO FIN-IMP-VAL-VEC-CAN
           WHEN
              ( PIZ-COD-CONC IN PIZ (CIM-I) =
                                     VEC-COD-CNDC IN VEC-ICG (CIM-J) AND
                PIZ-COD-SUBC IN PIZ (CIM-I) =
                                     VEC-COD-TCDC IN VEC-ICG (CIM-J))
                PERFORM CAL-IMP-PIZ-CAN.
       FIN-IMP-VAL-VEC-CAN.
           EXIT.

       CAL-IMP-PIZ-CAN SECTION.
       INI-CAL-IMP-PIZ-CAN.
           MOVE VEC-SGV-LIQU IN VEC-ICG (CIM-J)
                             TO CIM-VAL-MCAL IN CIM-VARI.
           IF PIZ-IND-INCL IN PIZ (CIM-I) = 'S'
               COMPUTE CIM-VAL-CALC IN CIM-VARI ROUNDED =
                                       VEC-SGV-LIQU IN VEC-ICG (CIM-J) -
                                       VEC-SGV-LIQU IN VEC-ICG (CIM-J) /
                                      ( 1 + PIZ-SGV-TIMP IN PIZ (CIM-I)
                                       / 100)
               MOVE CIM-VAL-CALC IN CIM-VARI TO PES-SGV-DECI
               MOVE OPZ-COD-VCOC IN CAZ-FLD  TO PES-COD-VCAM
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE             TO CIM-VAL-CALC IN CIM-VARI
               SUBTRACT CIM-VAL-CALC FROM
                        VEC-SGV-LIQU IN VEC-ICG (CIM-J)
           ELSE
               COMPUTE CIM-VAL-CALC IN CIM-VARI ROUNDED =
                                       VEC-SGV-LIQU IN VEC-ICG (CIM-J) *
                                       PIZ-SGV-TIMP IN PIZ (CIM-I) / 100
               MOVE CIM-VAL-CALC IN CIM-VARI TO PES-SGV-DECI
               MOVE OPZ-COD-VCOC IN CAZ-FLD  TO PES-COD-VCAM
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE TO CIM-VAL-CALC IN CIM-VARI.

           SET   CIM-J TO 1.
           SEARCH VEC-ICG  AT END
                  PERFORM GRA-VEC-PIZ
           WHEN
              ( VEC-COD-CNDC IN VEC-ICG (CIM-J) = 'IMP' AND
                VEC-COD-TCDC IN VEC-ICG (CIM-J) =
                                         PIZ-COD-IMPU IN PIZ (CIM-I))
                  PERFORM ACT-VEC-PIZ.
           ADD CIM-VAL-CALC  IN CIM-VARI   TO VEZ-VAL-IMPU IN CAZ-FLD.
       FIN-CAL-IMP-PIZ-CAN.
           EXIT.

       IMP-VAL-SEG-CAN SECTION.
       INI-IMP-VAL-SEG-CAN.
           MOVE ZEROES TO CIM-VAL-CALC IN CIM-VARI.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-SEG-CAN.
           EXIT.

       IMP-VAL-INT-CAN SECTION.
       INI-IMP-VAL-INT-CAN.
           MOVE SCR-SGV-IPFC TO CIM-VAL-CALC IN CIM-VARI.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-INT-CAN.
           EXIT.
       IMP-VAL-ICO-CAN SECTION.
       INI-IMP-VAL-ICO-CAN.
           MOVE CAZ-SGV-IPUN IN CAZ-FLD TO CIM-VAL-CALC IN CIM-VARI.
           IF WSS-CIC-VCAM NOT = '0999'
            AND WSS-CIC-TVAL = '0'
               DIVIDE CCO-VAL-CALC IN CCO-VARI BY WSS-VAL-VCAM
                            GIVING CCO-VAL-CALC IN CCO-VARI ROUNDED.
           COMPUTE  CIM-VAL-CALC IN CIM-VARI ROUNDED =
                    SCR-SGV-IPFC - CIM-VAL-CALC IN CIM-VARI.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-ICO-CAN.
           EXIT.
       IMP-VAL-ICM-CAN SECTION.
       INI-IMP-VAL-ICM-CAN.
           MOVE CAZ-SGV-IPUN IN CAZ-FLD TO CIM-VAL-CALC IN CIM-VARI.
           IF WSS-CIC-VCAM NOT = '0999'
            AND WSS-CIC-TVAL = '0'
               DIVIDE CCO-VAL-CALC IN CCO-VARI BY WSS-VAL-VCAM
                            GIVING CCO-VAL-CALC IN CCO-VARI ROUNDED.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-ICM-CAN.
           EXIT.
       IMP-VAL-CAP-CAN SECTION.
       INI-IMP-VAL-CAP-CAN.
           MOVE VEZ-VAL-SCAP IN CAZ-FLD TO CIM-VAL-CALC IN CIM-VARI.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-CAP-CAN.
           EXIT.

       IMP-VAL-SDO-CAN SECTION.
       INI-IMP-VAL-SDO-CAN.
           MOVE OPZ-VAL-SCRE IN CAZ-FLD TO CIM-VAL-CALC IN CIM-VARI.
           PERFORM IMP-VAL-ALL-CAN.
       FIN-IMP-VAL-SDO-CAN.
           EXIT.

       IMP-VAL-ALL-CAN SECTION.
       INI-IMP-VAL-ALL-CAN.
           MOVE CIM-VAL-CALC IN CIM-VARI TO CIM-VAL-MCAL IN CIM-VARI.
           COMPUTE  CIM-VAL-CALC IN CIM-VARI ROUNDED =
                    CIM-VAL-CALC IN CIM-VARI *
                    PIZ-SGV-TIMP IN PIZ (CIM-I) / 100.
           IF WSS-CIC-VCAM NOT = '0999'
            AND WSS-CIC-TVAL = '0'
               MULTIPLY CIM-VAL-CALC IN CIM-VARI BY WSS-VAL-VCAM
                            GIVING CIM-VAL-CALC IN CIM-VARI ROUNDED.
           MOVE CIM-VAL-CALC IN CIM-VARI    TO PES-SGV-DECI
           MOVE OPZ-COD-VCOC IN CAZ-FLD     TO PES-COD-VCAM
           PERFORM PES-SCTV
           MOVE PES-SGV-ENTE                TO CIM-VAL-CALC IN CIM-VARI.
           SET  CIM-J                       TO 1.
           SEARCH VEC-ICG  AT END
                  PERFORM GRA-VEC-PIZ
           WHEN
              ( VEC-COD-CNDC IN VEC-ICG (CIM-J) = 'IMP' AND
                VEC-COD-TCDC IN VEC-ICG (CIM-J) =
                                         PIZ-COD-IMPU IN PIZ (CIM-I))
                  PERFORM ACT-VEC-PIZ.
           ADD CIM-VAL-CALC  IN CIM-VARI   TO VEZ-VAL-IMPU IN CAZ-FLD.
       FIN-IMP-VAL-ALL-CAN.
           EXIT.

       ACT-VEC-PIZ SECTION.
       INI-ACT-VEC-PIZ.
           ADD CIM-VAL-MCAL IN CIM-VARI
                                TO VEC-VAL-MCAL IN VEC-ICG (CIM-J).
           ADD CIM-VAL-CALC IN CIM-VARI
                               TO VEC-SGV-LIQU IN VEC-ICG (CIM-J).
       FIN-ACT-VEC-PIZ.
           EXIT.

       GRA-VEC-PIZ SECTION.
       INI-GRA-VEC-PIZ.
           ADD  1                        TO VEC-TOPE.
           MOVE CIM-VAL-CALC IN CIM-VARI
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE).
           MOVE PIZ-SGV-TIMP IN PIZ (CIM-I)
                                TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE).
           MOVE 'IMP'           TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE).
           MOVE PIZ-COD-IMPU IN PIZ (CIM-I)
                                TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE).
           MOVE CIM-VAL-MCAL IN CIM-VARI
                                TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE).
           MOVE PIZ-FEC-FPLA IN PIZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE).
           MOVE SPACES          TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
       FIN-GRA-VEC-PIZ.
           EXIT.

       OBT-CIC-PIZ SECTION.
       INI-OBT-CIC-PIZ.
           MOVE 'CBZ'                       TO TAB-COD-SIST FIO-SIST.
           MOVE 'IPT'                       TO TAB-COD-TTAB IN TAB.
           MOVE PIZ-COD-IMPU IN PIZ (CIM-I) TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CIM-STAT
                   GO TO FIN-OBT-CIC-PIZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CIM-CIC-IMPU
           ELSE
               MOVE 'COD    NEX'            TO CIM-STAT
               GO TO FIN-OBT-CIC-PIZ.
           MOVE 'CBZ'                       TO TAB-COD-SIST FIO-SIST.
           MOVE 'CPT'                       TO TAB-COD-TTAB IN TAB.
           MOVE PIZ-COD-CONC IN PIZ (CIM-I) TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CIM-STAT
                   GO TO FIN-OBT-CIC-PIZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CIM-CIC-CONC
           ELSE
               MOVE 'COD    NEX'            TO CIM-STAT
               GO TO FIN-OBT-CIC-PIZ.
           MOVE 'CBZ'                       TO TAB-COD-SIST FIO-SIST.
           MOVE 'DCP'                       TO TAB-COD-TTAB IN TAB.
           MOVE PIZ-COD-SUBC IN PIZ (CIM-I) TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG'        TO CIM-STAT
                   GO TO FIN-OBT-CIC-PIZ
               ELSE
                   MOVE TAB-CIC-CTAB IN TAB TO CIM-CIC-SUBC
           ELSE
               MOVE 'COD    NEX'            TO CIM-STAT
               GO TO FIN-OBT-CIC-PIZ.
       FIN-OBT-CIC-PIZ.
           EXIT.
       LIM-VEC-ICG SECTION.
       INI-LIM-VEC-ICG.
           MOVE ZEROES TO VEC-TOPE.
           MOVE SPACES TO CCO-STAT
                          CCO-MENS
                          CCO-COM-ANT
                          CCO-CIC-CONC
                          CCO-CIC-COMI
                          CCO-CAI-ICLI
                          CCO-CAI-ICLI
                          CCO-CIC-EVEN
                          CCO-CIC-SCTB.
           MOVE ZEROES TO CCO-STAT
                          CCO-VAL-CALC
                          CCO-VAL-MCAL
                          CCO-IIC-ICLI.
           MOVE SPACES TO CIM-STAT
                          CIM-MENS
                          CIM-CAI-ICLI
                          CIM-CIC-IMPU
                          CIM-CIC-CONC
                          CIM-CIC-SUBC.
           MOVE ZEROES TO CCO-STAT
                          CIM-VAL-CALC
                          CIM-VAL-LIQU
                          CIM-VAL-IMPU
                          CIM-IIC-ICLI.
           SET CCO-J TO 1.
      *HZF-FIN 11-DEC-1996 
       LUP-LIM-VEC-ICG.
           IF CCO-J > 30
              GO TO FIN-LIM-VEC-ICG.
           MOVE SPACES TO VEC-COD-CNDC IN VEC-ICG (CCO-J)
                          VEC-COD-TCDC IN VEC-ICG (CCO-J)
                          VEC-FEC-FACT IN VEC-ICG (CCO-J)
                          VEC-INT-TIPT IN VEC-ICG (CCO-J).
           MOVE ZEROES TO VEC-SGV-LIQU IN VEC-ICG (CCO-J)
                          VEC-VAL-TIMP IN VEC-ICG (CCO-J)
                          VEC-VAL-MCAL IN VEC-ICG (CCO-J).
           SET CCO-J UP BY 1.
           GO TO LUP-LIM-VEC-ICG.
       FIN-LIM-VEC-ICG.
           EXIT.
       OBT-MONTO-PAG-VCD SECTION.
       INI-OBT-MONTO-PAG-VCD.
           PERFORM BUS-IDLC-DEVEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-OBT-MONTO-PAG-VCD.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE VEZ-NUM-IDLC IN VEZ     TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF DLZ-IND-SCTB IN DLZ = SPACES
              GO TO FIN-OBT-MONTO-PAG-VCD.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RTZ-CAI-IOPC IN RTZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RTZ-IIC-IOPC IN RTZ.
           MOVE VEZ-NUM-IDLC IN VEZ     TO RTZ-NUM-IDLC IN RTZ.
           MOVE DLZ-IND-SCTB IN DLZ     TO RTZ-IND-SCTB IN RTZ.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF NOT FIO-STAT-OKS
              GO TO FIN-OBT-MONTO-PAG-VCD.
           MOVE SPACES          TO INT-TIPT.
           MOVE RCZ-SGV-FINA IN CAZ-FLD TO WSS-VAL-PAG-JUD.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE WSS-VAL-PAG-JUD TO WSS-SGV-CAPI
              MULTIPLY WSS-VAL-PAG-JUD BY SCR-SGV-VCAM
                                   GIVING WSS-VAL-PAG-JUD ROUNDED
              PERFORM CAL-REAJ
              SUBTRACT RCZ-SGV-REAJ FROM WSS-VAL-PAG-JUD.
           IF WSS-VAL-PAG-JUD > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'RDT'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'CAP'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
              IF WSS-VAL-PAG-JUD > RTZ-VAL-SRDT IN RTZ OR
                 ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'T' ) OR
                 ( VEZ-NUM-IVCT IN VEZ = OPZ-NUM-VCOR IN OPZ )
                  MOVE RTZ-VAL-SRDT IN RTZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
              ELSE
                  MOVE WSS-VAL-PAG-JUD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE).

           IF SCR-VAL-SEGV > 0
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'RDT'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'COM'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
              MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
              IF SCR-VAL-SEGV > RTZ-VAL-SCOT IN RTZ OR
                 ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'T' ) OR
                 ( VEZ-NUM-IVCT IN VEZ = OPZ-NUM-VCOR IN OPZ )
                  MOVE RTZ-VAL-SCOT IN RTZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
              ELSE
                  MOVE SCR-VAL-SEGV 
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE).
       FIN-OBT-MONTO-PAG-VCD.
           EXIT.
       OBT-MONTO-PAG-JUD SECTION.
       INI-OBT-MONTO-PAG-JUD.
           GO TO FIN-OBT-MONTO-PAG-JUD.
           PERFORM BUS-IDLC-DEVEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-OBT-MONTO-PAG-JUD.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE VEZ-NUM-IDLC IN VEZ     TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND DLZ-IND-SCTB IN DLZ = 'JUD' )
               IF VEZ-IND-SCTB IN CAZ-FLD NOT = 'JUD'
                   GO TO FIN-OBT-MONTO-PAG-JUD.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RTZ-CAI-IOPC IN RTZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RTZ-IIC-IOPC IN RTZ.
           MOVE VEZ-NUM-IDLC IN VEZ     TO RTZ-NUM-IDLC IN RTZ.
           MOVE 'JUD'                   TO RTZ-IND-SCTB IN RTZ.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF NOT FIO-STAT-OKS
              GO TO FIN-OBT-MONTO-PAG-JUD.
           MOVE RCZ-SGV-FINA IN CAZ-FLD TO WSS-VAL-PAG-JUD.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MULTIPLY WSS-VAL-PAG-JUD BY SCR-SGV-VCAM
                                   GIVING WSS-VAL-PAG-JUD ROUNDED.
           PERFORM ADD-RDT-A-VEC.
       FIN-OBT-MONTO-PAG-JUD.
           EXIT.
       ADD-RDT-A-VEC SECTION.
       INI-ADD-RDT-A-VEC.
           MOVE SPACES          TO INT-TIPT.
           IF WSS-VAL-PAG-JUD > ZEROES AND
              RTZ-VAL-SRDT IN RTZ > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'RDT'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'CAP'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              IF WSS-VAL-PAG-JUD NOT > RTZ-VAL-SRDT IN RTZ
                 MOVE WSS-VAL-PAG-JUD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
              ELSE
                 MOVE RTZ-VAL-SRDT IN RTZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
           IF RTZ-VAL-SINT IN RTZ > ZEROES AND
              WSS-VAL-PAG-JUD > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'RDT'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'INT'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              IF RTZ-VAL-SINT IN RTZ NOT > WSS-VAL-PAG-JUD
                 MOVE RTZ-VAL-SINT IN RTZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 SUBTRACT RTZ-VAL-SINT IN RTZ FROM WSS-VAL-PAG-JUD
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
              ELSE
                 MOVE WSS-VAL-PAG-JUD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 MOVE ZEROES    TO WSS-VAL-PAG-JUD
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
           IF RTZ-VAL-SCOT IN RTZ > ZEROES AND
              WSS-VAL-PAG-JUD > ZEROES
              ADD  1            TO VEC-TOPE
              MOVE ZEROES       TO VEC-VAL-MCAL IN VEC-ICG (VEC-TOPE)
              MOVE ZEROES       TO VEC-VAL-TIMP IN VEC-ICG (VEC-TOPE)
              MOVE 'RDT'        TO VEC-COD-CNDC IN VEC-ICG (VEC-TOPE)
              MOVE 'COM'        TO VEC-COD-TCDC IN VEC-ICG (VEC-TOPE)
              IF RTZ-VAL-SCOT IN RTZ NOT > WSS-VAL-PAG-JUD
                 MOVE RTZ-VAL-SCOT IN RTZ
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 SUBTRACT RTZ-VAL-SCOT IN RTZ FROM WSS-VAL-PAG-JUD
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE)
              ELSE
                 MOVE WSS-VAL-PAG-JUD
                                TO VEC-SGV-LIQU IN VEC-ICG (VEC-TOPE)
                 MOVE ZEROES    TO WSS-VAL-PAG-JUD
                 MOVE CAZ-FEC-FCAN IN CAZ
                                TO VEC-FEC-FACT IN VEC-ICG (VEC-TOPE)
                 MOVE INT-TIPT  TO VEC-INT-TIPT IN VEC-ICG (VEC-TOPE).
       FIN-ADD-RDT-A-VEC.
           EXIT.
       BUS-IDLC-DEVEN SECTION.
       INI-BUS-IDLC-DEVEN.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO OPZ-CAI-IOPC IN OPZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-IDLC-DEVEN.
           MOVE OPZ-CIC-IOPC IN OPZ TO VEZ-CIC-IOPC IN VEZ.
           IF OPZ-IND-VSTR IN OPZ = 'S'
               MOVE 1 TO VEZ-NUM-IVEN IN VEZ
           ELSE
              MOVE VEZ-NUM-IVCT IN CAZ-FLD TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
       FIN-BUS-IDLC-DEVEN.
           EXIT.
       OBT-CIC-ICLI SECTION.
       INI-OBT-CIC-ICLI.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RDZ-CAI-IOPC IN RDZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RDZ-IIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              RDZ-CAI-IOPC IN RDZ = OPZ-CAI-IOPC IN OPZ AND
              RDZ-IIC-IOPC IN RDZ = OPZ-IIC-IOPC IN OPZ AND
              RDZ-NUM-IDLC IN RDZ = ZEROS
               NEXT SENTENCE
           ELSE
               MOVE ZEROES TO RDZ-CIC-ICLI IN RDZ. 
       FIN-OBT-CIC-ICLI.
           EXIT.
