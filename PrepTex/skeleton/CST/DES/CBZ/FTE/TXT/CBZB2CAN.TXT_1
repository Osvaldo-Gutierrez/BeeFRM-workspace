      * Accesa COL-VSN para ver si corresponde Interfase con Caja
           MOVE 'CBZ'       TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'INTCAJA'   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-INT-CAJA
           ELSE
               MOVE 'N' TO WSS-VSN-INT-CAJA.
           IF PGM-STAT-CAZ-OKS
      *BUS-TAB busca glosa de codigo en tabla
               MOVE 'CBZ'               TO TAB-COD-SIST
               MOVE 'CNC'               TO TAB-COD-TTAB IN TAB
               MOVE CAZ-MSC-CANC IN CAZ TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CCNC
               MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC
           ELSE
               IF NOT (( SCR-CCPP = 'ACT' AND
                  SCR-ACTU = SCR-ACTU-ING ) OR
                  ( SCR-CCPP = 'ING' ))
                   GO TO FIN-FND-KEY.
      * Solo para verificar condiciones para Interfase con Caja
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-OPZ-DLZ.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-FND-KEY.
           IF SCR-MSC-TCAN = 'C'
               GO TO NOT-FND-ROZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
	   MOVE FIO-GET-NLS    TO FIO-CMND.
	   PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
                    ROZ-CIC-IOPV IN ROZ = CAZ-CIC-IOPC IN CAZ AND
                    ROZ-NUM-IVCT IN ROZ = CAZ-NUM-ICAN IN CAZ )
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-ROZ.
           IF PGM-STAT-ROZ-OKS
                MOVE ROZ-CAI-IOPC IN ROZ TO SCR-ROV-CAI-IOPC
                MOVE ROZ-IIC-IOPC IN ROZ TO SCR-ROV-IIC-IOPC
           ELSE
               GO TO NOT-FND-ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = ROZ-CIC-IOPV IN ROZ AND
              CAZ-NUM-ICAN IN CAZ = ROZ-NUM-IVCT IN ROZ
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'EXMULOPZXCAZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           MOVE FIO-STAT TO PGM-STAT-ROZ.
           IF PGM-STAT-ROZ-OKS
                MOVE ROZ-CAI-IOPC IN ROZ TO SCR-ROV-CAI-IOPC
                MOVE ROZ-IIC-IOPC IN ROZ TO SCR-ROV-IIC-IOPC.
       NOT-FND-ROZ.
           IF SCR-CCPP = 'ACT' AND NO-ASIGNE-CORRELATIVO AND 
              NOT PGM-STAT-CAZ-OKS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF PGM-STAT-CAZ-OKS
               IF NOT PGM-STAT-RCZ-OKS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY.
           IF NOT PGM-STAT-CAZ-OKS AND
              ( SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING' )
               PERFORM PUT-OPZ-CAZ
               PERFORM PUT-DBC-CAZ
               PERFORM PUT-VEZ-CAZ
               PERFORM PUT-ROZ-CAZ
               PERFORM PUT-CYZ-CAZ
               PERFORM PUT-RCZ-CAZ.
       FND-RST-STAT.
           MOVE PGM-STAT-CAZ TO FIO-STAT.
           IF ( OPZ-NUM-VCVG IN OPZ NOT > ZEROES OR
                OPZ-VAL-SCRE IN OPZ NOT > ZEROES ) AND
              SCR-CMND NOT = 'REV'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    YACAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE SPACES TO MSG-COD-MENS.

           IF PGM-STAT-CAZ-OKS
               IF ( CAZ-MSC-STAT IN CAZ = 'R' OR 'X' ) OR
                  ( ( CAZ-MSC-STAT IN CAZ = 'S' OR 'C' OR 'W' OR
                      'G' OR 'H' OR 'P' ) AND SCR-CMND NOT = 'REV' )
                   IF CAZ-MSC-STAT IN CAZ = 'R'
                      MOVE 'CAZ    REVYA' TO MSG-COD-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'X'
                      MOVE 'CAZ    NCCYA' TO MSG-COD-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'S'
                      IF ( WSS-VSN-INT-CAJA    = 'S' ) AND
                         ( OPZ-IND-PVEN IN OPZ = 'S' ) AND
                         ( WSS-CIC-TDOC    NOT = 'LTR' )
                          MOVE 'VPC' TO WSS-CMND
                          PERFORM VER-INT-CAJA
                          IF CAJ-COD-MENS IN CAJ-CMMA = 'CAJ    YAPAG'
                              NEXT SENTENCE
                          ELSE
                          IF CAJ-COD-MENS IN CAJ-CMMA = 'CAJ    NOPAG'
                              MOVE 'CAZ    SAFYA' TO MSG-COD-MENS
                          ELSE
                              MOVE CAJ-COD-MENS IN CAJ-CMMA
                                                TO MSG-COD-MENS
                      ELSE
                      MOVE 'CAZ    SAFYA' TO MSG-COD-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'G' OR 'H'
                      MOVE 'CAZ    CCTYA' TO MSG-COD-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'C'
                      IF CAZ-MSC-TCAN IN CAZ = 'N'
                          MOVE 'CAZ    NOVYA' TO MSG-COD-MENS
                      ELSE
                          IF CAZ-MSC-TCAN IN CAZ = 'R'
                              MOVE 'CAZ    RENYA' TO MSG-COD-MENS
                          ELSE
                              MOVE 'CAZ    PROYA' TO MSG-COD-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'W' OR 'P'
                      IF ( WSS-VSN-INT-CAJA    = 'S' ) AND
                         ( OPZ-IND-PVEN IN OPZ = 'S' ) AND
                         ( WSS-CIC-TDOC    NOT = 'LTR' )
                          MOVE 'VPC' TO WSS-CMND
                          PERFORM VER-INT-CAJA
                          IF CAJ-COD-MENS IN CAJ-CMMA = 'CAJ    YAPAG'
                              NEXT SENTENCE
                          ELSE
                          IF CAJ-COD-MENS IN CAJ-CMMA = 'CAJ    NOPAG'
                              MOVE 'CAZ    ALLYA' TO MSG-COD-MENS
                          ELSE
                              MOVE CAJ-COD-MENS IN CAJ-CMMA
                                                TO MSG-COD-MENS
                      ELSE
                      MOVE 'CAZ    ALLYA' TO MSG-COD-MENS.

           IF MSG-COD-MENS > SPACES
              GO TO VRF-STAT-CAZC.

           IF ( SCR-CCPP = 'ING' OR 'MOD' OR 'ACT' OR 'ELI' ) OR
              ( SCR-CMND = 'CON' )
              IF PGM-STAT-CAZ-OKS
                 IF CAZ-MSC-STAT IN CAZ = 'A'
                     MOVE 'CAZ    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'E'
                     MOVE 'CAZ    ACAOB' TO MSG-COD-MENS
                 ELSE
                 IF NOT ( CAZ-MSC-STAT IN CAZ = 'I' OR 'M' OR 'V' )
                     MOVE 'CAZ    STTNN' TO MSG-COD-MENS.
           
           IF SCR-CMND = 'VRF'
              IF PGM-STAT-CAZ-OKS
                 IF CAZ-MSC-STAT IN CAZ = 'V'
                     MOVE 'CAZ    VRFYA' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'L'
                     MOVE 'CAZ    LIQYA' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'A'
                     MOVE 'CAZ    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'E'
                     MOVE 'CAZ    ACAOB' TO MSG-COD-MENS.

           IF SCR-CMND = 'REV'
              IF PGM-STAT-CAZ-OKS
                 IF CAZ-MSC-STAT IN CAZ = 'A' AND
                    SCR-CYA-IND-CCTE = 'S'
                     NEXT SENTENCE
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'E'
                     MOVE 'CAZ    ACAOB' TO MSG-COD-MENS
                 ELSE
                 IF NOT ( CAZ-MSC-STAT IN CAZ = 'A' OR 'S' OR
                                         'C' OR 'W'        OR 'P' )
                     MOVE 'CAZ    ACANO' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-SGV-TPAG IN CAZ < ZEROES OR
                    CAZ-SGV-TREN IN CAZ < ZEROES
                     MOVE 'CBZ'          TO TAB-COD-SIST
                     MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
                     MOVE 'BCI    REVER' TO TAB-COD-CTAB IN TAB
                     PERFORM VAL-COD
                     IF MSG-COD-MENS > SPACES
                         MOVE 'CAZ    REVER' TO MSG-COD-MENS.

           IF SCR-CMND = 'CAN' OR 'CVC'
              IF PGM-STAT-CAZ-OKS
                 IF CAZ-MSC-STAT IN CAZ = 'A'
                     MOVE 'CAZ    ACAYA' TO MSG-COD-MENS
                 ELSE
                 IF CAZ-MSC-STAT IN CAZ = 'M' OR 'I'
                     MOVE 'CAZ    VRFNO' TO MSG-COD-MENS.
       VRF-STAT-CAZC.
           IF MSG-COD-MENS > SPACES
                MOVE 'CBZ' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MEN1
                MOVE '00' TO FIO-STAT
                MOVE SCR-STAT-CON TO SCR-STAT
                GO TO FIN-FND-KEY.
