      *Recibe CEO-CIC-IOPC-PRO, CEO-CIC-IOPC-PSO donde CEO-CIC-IOPC-PRO
      *es prorroga
       CAM-ENT-OPZ SECTION.
       INI-CAM-ENT-OPZ.
           MOVE SPACES TO CEO-CMSG.
           MOVE SPACES TO CEO-STAT.
           MOVE CEO-CAI-IOPC-PRO TO ROZ-CAI-IOPC IN ROZ.
           MOVE CEO-IIC-IOPC-PRO TO ROZ-IIC-IOPC IN ROZ.
           MOVE SPACES           TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS      TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
                    CEO-CAI-IOPC-PRO = ROZ-CAI-IOPC IN ROZ AND
                    CEO-IIC-IOPC-PRO = ROZ-IIC-IOPC IN ROZ )
               MOVE 'ROZ    NEX'        TO CEO-CMSG
               MOVE ROZ-CIC-IOPC IN ROZ TO CEO-MEN2
               GO TO FIN-CAM-ENT-OPZ.
           MOVE ROZ-CIC-IOPV IN ROZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NEX'        TO CEO-CMSG
               MOVE OPZ-CIC-IOPC IN OPZ- TO CEO-MEN2
               GO TO FIN-CAM-ENT-OPZ.
           IF ( NOT FIO-STAT-OKS ) OR ( OPZ-VAL-SCRE IN OPZ- > ZEROS )
               GO TO FIN-CAM-ENT-OPZ.
           MOVE OPZ-CAI-IOPC IN OPZ- TO CEO-CAI-IOPC-ORI.
           MOVE OPZ-IIC-IOPC IN OPZ- TO CEO-IIC-IOPC-ORI.
           PERFORM CAM-KEY-OPZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-ROZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-VEZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-CAZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-CCZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           PERFORM CAN-KEY-CTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-CUZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-CYZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-DLZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           PERFORM CAM-KEY-ICZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-RZE.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-RCZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-RDZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           PERFORM CAM-KEY-RTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-ENT-OPZ.
           MOVE 'S' TO CEO-STAT.
       FIN-CAM-ENT-OPZ.
           EXIT.

       CAM-KEY-OPZ SECTION.
       INI-CAM-KEY-OPZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-OPZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-OPZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-OPZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-OPZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-OPZ.
       FIN-CAM-KEY-OPZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-OPZ SECTION.
       INI-CRE-NEW-KEY-OPZ.
      *Lee registro con llave original
           MOVE CEO-CAI-IOPC-OLD TO OPZ-CAI-IOPC IN OPZ.
           MOVE CEO-IIC-IOPC-OLD TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CRE-NEW-KEY-OPZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO OPZ-CAI-IOPC IN OPZ.
           MOVE CEO-IIC-IOPC-NEW TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOPUT'      TO CEO-CMSG
               MOVE OPZ-KEY-IOPC IN OPZ- TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-OPZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO OPZ-CAI-IOPC IN OPZ.
           MOVE CEO-IIC-IOPC-OLD TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NEX'        TO CEO-CMSG
               MOVE OPZ-KEY-IOPC IN OPZ- TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-OPZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NODEL'      TO CEO-CMSG
               MOVE OPZ-KEY-IOPC IN OPZ- TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-OPZ.
       FIN-CRE-NEW-KEY-OPZ.
           EXIT.

       CAM-KEY-ROZ SECTION.
       INI-CAM-KEY-ROZ.
      * Da vueltas llaves en ROZ
           MOVE CEO-CAI-IOPC-PRO TO ROZ-CAI-IOPC IN ROZ.
           MOVE CEO-IIC-IOPC-PRO TO ROZ-IIC-IOPC IN ROZ.
           MOVE SPACES           TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS      TO FIO-CMND.
       LUP-CAM-KEY-ROZ.
           PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
                    CEO-CAI-IOPC-PRO = ROZ-CAI-IOPC IN ROZ AND
                    CEO-IIC-IOPC-PRO = ROZ-IIC-IOPC IN ROZ )
               GO TO FIN-CAM-KEY-ROZ.

           MOVE ROZ-CIC-IOPC IN ROZ TO CEO-CIC-AUXI.
           MOVE ROZ-CIC-IOPV IN ROZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE CEO-CIC-AUXI        TO ROZ-CIC-IOPV IN ROZ.
           MOVE FIO-PUT             TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ROZ    NOPUT'      TO CEO-CMSG
               MOVE ROZ-KEY-IROV IN ROZ TO CEO-MEN2
               GO TO FIN-CAM-KEY-ROZ.
           MOVE ROZ-CIC-IOPC IN ROZ TO CEO-CIC-AUXI.
           MOVE ROZ-CIC-IOPV IN ROZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE CEO-CIC-AUXI        TO ROZ-CIC-IOPV IN ROZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ROZ    NEX'        TO CEO-CMSG
               MOVE ROZ-KEY-IROV IN ROZ TO CEO-MEN2
               GO TO FIN-CAM-KEY-ROZ.
           MOVE FIO-DEL             TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ROZ    NODEL'      TO CEO-CMSG
               MOVE ROZ-KEY-IROV IN ROZ TO CEO-MEN2
               GO TO FIN-CAM-KEY-ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CAM-KEY-ROZ.
       FIN-CAM-KEY-ROZ.
           EXIT.

       CAM-KEY-VEZ SECTION.
       INI-CAM-KEY-VEZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-VEZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-VEZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-VEZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-VEZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-VEZ.
       FIN-CAM-KEY-VEZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-VEZ SECTION.
       INI-CRE-NEW-KEY-VEZ.
           MOVE SPACES           TO VEZ-KEY-IVEN IN VEZ.
           MOVE CEO-CAI-IOPC-OLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CEO-IIC-IOPC-OLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-VEZ.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    VEZ-CAI-IOPC IN VEZ = CEO-CAI-IOPC-OLD AND
                    VEZ-IIC-IOPC IN VEZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-VEZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO VEZ-CAI-IOPC IN VEZ.
           MOVE CEO-IIC-IOPC-NEW TO VEZ-IIC-IOPC IN VEZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZ    NOPUT'      TO CEO-CMSG
               MOVE VEZ-KEY-IVEN IN VEZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-VEZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CEO-IIC-IOPC-OLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZ    NEX'        TO CEO-CMSG
               MOVE VEZ-KEY-IVEN IN VEZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-VEZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZ    NODEL'      TO CEO-CMSG
               MOVE VEZ-KEY-IVEN IN VEZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-VEZ.
       FIN-CRE-NEW-KEY-VEZ.
           EXIT.

       CAM-KEY-CAZ SECTION.
       INI-CAM-KEY-CAZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CAZ.
       FIN-CAM-KEY-CAZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-CAZ SECTION.
       INI-CRE-NEW-KEY-CAZ.
           MOVE SPACES           TO CAZ-KEY-ICAN IN CAZ.
           MOVE CEO-CAI-IOPC-OLD TO CAZ-CAI-IOPC IN CAZ.
           MOVE CEO-IIC-IOPC-OLD TO CAZ-IIC-IOPC IN CAZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-CAZ.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    CAZ-CAI-IOPC IN CAZ = CEO-CAI-IOPC-OLD AND
                    CAZ-IIC-IOPC IN CAZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-CAZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO CAZ-CAI-IOPC IN CAZ.
           MOVE CEO-IIC-IOPC-NEW TO CAZ-IIC-IOPC IN CAZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CAZ    NOPUT'      TO CEO-CMSG
               MOVE CAZ-KEY-ICAN IN CAZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CAZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO CAZ-CAI-IOPC IN CAZ.
           MOVE CEO-IIC-IOPC-OLD TO CAZ-IIC-IOPC IN CAZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CAZ    NEX'        TO CEO-CMSG
               MOVE CAZ-KEY-ICAN IN CAZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CAZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CAZ    NODEL'      TO CEO-CMSG
               MOVE CAZ-KEY-ICAN IN CAZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CAZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-CAZ.
       FIN-CRE-NEW-KEY-CAZ.
           EXIT.

       CAM-KEY-CCZ SECTION.
       INI-CAM-KEY-CCZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CCZ.
       FIN-CAM-KEY-CCZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-CCZ SECTION.
       INI-CRE-NEW-KEY-CCZ.
           MOVE SPACES           TO CCZ-KEY-ICCB IN CCZ.
           MOVE CEO-CAI-IOPC-OLD TO CCZ-CAI-IOPC IN CCZ.
           MOVE CEO-IIC-IOPC-OLD TO CCZ-IIC-IOPC IN CCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-CCZ.
           PERFORM CBZ-FIO-CCZ.
           IF NOT ( FIO-STAT-OKS AND
                    CCZ-CAI-IOPC IN CCZ = CEO-CAI-IOPC-OLD AND
                    CCZ-IIC-IOPC IN CCZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-CCZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO CCZ-CAI-IOPC IN CCZ.
           MOVE CEO-IIC-IOPC-NEW TO CCZ-IIC-IOPC IN CCZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CCZ    NOPUT'      TO CEO-CMSG
               MOVE CCZ-KEY-ICCB IN CCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CCZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO CCZ-CAI-IOPC IN CCZ.
           MOVE CEO-IIC-IOPC-OLD TO CCZ-IIC-IOPC IN CCZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CCZ    NEX'        TO CEO-CMSG
               MOVE CCZ-KEY-ICCB IN CCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CCZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CCZ    NODEL'      TO CEO-CMSG
               MOVE CCZ-KEY-ICCB IN CCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-CCZ.
       FIN-CRE-NEW-KEY-CCZ.
           EXIT.

       CAN-KEY-CTZ SECTION.
       INI-CAN-KEY-CTZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAN-KEY-CTZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAN-KEY-CTZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CTZ.
       FIN-CAN-KEY-CTZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-CTZ SECTION.
       INI-CRE-NEW-KEY-CTZ.
           MOVE SPACES           TO CTZ-KEY-ICCT IN CTZ.
           MOVE CEO-CAI-IOPC-OLD TO CTZ-CAI-IOPC IN CTZ.
           MOVE CEO-IIC-IOPC-OLD TO CTZ-IIC-IOPC IN CTZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-CTZ.
           PERFORM CBZ-FIO-CTZ.
           IF NOT ( FIO-STAT-OKS AND
                    CTZ-CAI-IOPC IN CTZ = CEO-CAI-IOPC-OLD AND
                    CTZ-IIC-IOPC IN CTZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-CTZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO CTZ-CAI-IOPC IN CTZ.
           MOVE CEO-IIC-IOPC-NEW TO CTZ-IIC-IOPC IN CTZ.
           MOVE CEO-CAI-IOPC-NEW TO CTZ-CAI-IOPV IN CTZ.
           MOVE CEO-IIC-IOPC-NEW TO CTZ-IIC-IOPV IN CTZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CTZ    NOPUT'      TO CEO-CMSG
               MOVE CTZ-KEY-ICCT IN CTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CTZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO CTZ-CAI-IOPC IN CTZ.
           MOVE CEO-IIC-IOPC-OLD TO CTZ-IIC-IOPC IN CTZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CTZ    NEX'        TO CEO-CMSG
               MOVE CTZ-KEY-ICCT IN CTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CTZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CTZ    NODEL'      TO CEO-CMSG
               MOVE CTZ-KEY-ICCT IN CTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CTZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-CTZ.
       FIN-CRE-NEW-KEY-CTZ.
           EXIT.

       CAM-KEY-CUZ SECTION.
       INI-CAM-KEY-CUZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CUZ.
       FIN-CAM-KEY-CUZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-CUZ SECTION.
       INI-CRE-NEW-KEY-CUZ.
           MOVE SPACES           TO CUZ-KEY-ICUF IN CUZ.
           MOVE CEO-CAI-IOPC-OLD TO CUZ-CAI-IOPC IN CUZ.
           MOVE CEO-IIC-IOPC-OLD TO CUZ-IIC-IOPC IN CUZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-CUZ.
           PERFORM CBZ-FIO-CUZ.
           IF NOT ( FIO-STAT-OKS AND
                    CUZ-CAI-IOPC IN CUZ = CEO-CAI-IOPC-OLD AND
                    CUZ-IIC-IOPC IN CUZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-CUZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO CUZ-CAI-IOPC IN CUZ.
           MOVE CEO-IIC-IOPC-NEW TO CUZ-IIC-IOPC IN CUZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CUZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CUZ    NOPUT'      TO CEO-CMSG
               MOVE CUZ-KEY-ICUF IN CUZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CUZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO CUZ-CAI-IOPC IN CUZ.
           MOVE CEO-IIC-IOPC-OLD TO CUZ-IIC-IOPC IN CUZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CUZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CUZ    NEX'        TO CEO-CMSG
               MOVE CUZ-KEY-ICUF IN CUZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CUZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CUZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CUZ    NODEL'      TO CEO-CMSG
               MOVE CUZ-KEY-ICUF IN CUZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CUZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-CUZ.
       FIN-CRE-NEW-KEY-CUZ.
           EXIT.

       CAM-KEY-CYZ SECTION.
       INI-CAM-KEY-CYZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CYZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-CYZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CYZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-CYZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-CYZ.
       FIN-CAM-KEY-CYZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-CYZ SECTION.
       INI-CRE-NEW-KEY-CYZ.
           MOVE SPACES           TO CYZ-KEY-ICYA IN CYZ.
           MOVE CEO-CAI-IOPC-OLD TO CYZ-CAI-IOPC IN CYZ.
           MOVE CEO-IIC-IOPC-OLD TO CYZ-IIC-IOPC IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-CYZ.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS AND
                    CYZ-CAI-IOPC IN CYZ = CEO-CAI-IOPC-OLD AND
                    CYZ-IIC-IOPC IN CYZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-CYZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO CYZ-CAI-IOPC IN CYZ.
           MOVE CEO-IIC-IOPC-NEW TO CYZ-IIC-IOPC IN CYZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NOPUT'      TO CEO-CMSG
               MOVE CYZ-KEY-ICYA IN CYZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CYZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO CYZ-CAI-IOPC IN CYZ.
           MOVE CEO-IIC-IOPC-OLD TO CYZ-IIC-IOPC IN CYZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NEX'        TO CEO-CMSG
               MOVE CYZ-KEY-ICYA IN CYZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CYZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NODEL'      TO CEO-CMSG
               MOVE CYZ-KEY-ICYA IN CYZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-CYZ.
       FIN-CRE-NEW-KEY-CYZ.
           EXIT.

       CAM-KEY-DLZ SECTION.
       INI-CAM-KEY-DLZ.
           MOVE SPACES TO CEO-KEY-IDLO.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-DLZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-DLZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-DLZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-DLZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-DLZ.
       FIN-CAM-KEY-DLZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-DLZ SECTION.
       INI-CRE-NEW-KEY-DLZ.
           MOVE SPACES           TO DLZ-KEY-IDLC IN DLZ.
           MOVE CEO-CAI-IOPC-OLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE CEO-IIC-IOPC-OLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-DLZ.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
                    DLZ-CAI-IOPC IN DLZ = CEO-CAI-IOPC-OLD AND
                    DLZ-IIC-IOPC IN DLZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-DLZ.
      *Si se carga un IDLO lo usa para grabarlo
           IF CEO-KEY-IDLO > SPACES
               MOVE CEO-KEY-IDLO TO DLZ-KEY-IDLO IN DLZ
               MOVE SPACES       TO CEO-KEY-IDLO
           ELSE
      *Si el IDLO esta vacio guarda el DOCUMENTO original
           IF DLZ-CIC-IOCO IN DLZ NOT > SPACES
               MOVE CEO-CIC-IOPC-OLD    TO DLZ-CIC-IOCO IN DLZ
               MOVE DLZ-NUM-IDLC IN DLZ TO DLZ-NUM-IDLO IN DLZ
           ELSE
      *Si el IDLO no es igual al DOCUMENTO original guarda el IDLO
           IF DLZ-CIC-IOPC IN DLZ NOT = DLZ-CIC-IOCO IN DLZ
               MOVE DLZ-KEY-IDLO IN DLZ TO CEO-KEY-IDLO
           ELSE
               MOVE SPACES              TO CEO-KEY-IDLO.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO DLZ-CAI-IOPC IN DLZ.
           MOVE CEO-IIC-IOPC-NEW TO DLZ-IIC-IOPC IN DLZ.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'DLZ    NOPUT'      TO CEO-CMSG
               MOVE DLZ-KEY-IDLC IN DLZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-DLZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE CEO-IIC-IOPC-OLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'DLZ    NEX'        TO CEO-CMSG
               MOVE DLZ-KEY-IDLC IN DLZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-DLZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'DLZ    NODEL'      TO CEO-CMSG
               MOVE DLZ-KEY-IDLC IN DLZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-DLZ.
       FIN-CRE-NEW-KEY-DLZ.
           EXIT.

       CAM-KEY-ICZ SECTION.
       INI-CAM-KEY-ICZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-ICZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-ICZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-ICZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-ICZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-ICZ.
       FIN-CAM-KEY-ICZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-ICZ SECTION.
       INI-CRE-NEW-KEY-ICZ.
           MOVE SPACES           TO ICZ-KEY-IICG IN ICZ.
           MOVE CEO-CAI-IOPC-OLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CEO-IIC-IOPC-OLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-ICZ.
           PERFORM CBZ-FIO-ICZ.
           IF NOT ( FIO-STAT-OKS AND
                    ICZ-CAI-IOPC IN ICZ = CEO-CAI-IOPC-OLD AND
                    ICZ-IIC-IOPC IN ICZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-ICZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW    TO ICZ-CAI-IOPC IN ICZ.
           MOVE CEO-IIC-IOPC-NEW    TO ICZ-IIC-IOPC IN ICZ.
           MOVE ICZ-CIC-IOPV IN ICZ TO CEO-CIC-AUXI.
           IF ICZ-CIC-IOPV IN ICZ = CEO-CIC-IOPC-OLD
               MOVE CEO-CAI-IOPC-NEW TO ICZ-CAI-IOPV IN ICZ
               MOVE CEO-IIC-IOPC-NEW TO ICZ-IIC-IOPV IN ICZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ICZ    NOPUT'      TO CEO-CMSG
               MOVE ICZ-KEY-IICG IN ICZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-ICZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CEO-IIC-IOPC-OLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE CEO-CIC-AUXI TO ICZ-CIC-IOPV IN ICZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ICZ    NEX'        TO CEO-CMSG
               MOVE ICZ-KEY-IICG IN ICZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-ICZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT FIO-STAT-OKS
               MOVE 'ICZ    NODEL'      TO CEO-CMSG
               MOVE ICZ-KEY-IICG IN ICZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-ICZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-ICZ.
       FIN-CRE-NEW-KEY-ICZ.
           EXIT.

       CAM-KEY-RZE SECTION.
       INI-CAM-KEY-RZE.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RZE.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RZE.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RZE.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RZE.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RZE.
       FIN-CAM-KEY-RZE.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-RZE SECTION.
       INI-CRE-NEW-KEY-RZE.
           MOVE SPACES           TO RZE-KEY-IRCE IN RZE.
           MOVE CEO-CAI-IOPC-OLD TO RZE-CAI-IOPC IN RZE.
           MOVE CEO-IIC-IOPC-OLD TO RZE-IIC-IOPC IN RZE.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-RZE.
           PERFORM CBZ-FIO-RZE.
           IF NOT ( FIO-STAT-OKS AND
                    RZE-CAI-IOPC IN RZE = CEO-CAI-IOPC-OLD AND
                    RZE-IIC-IOPC IN RZE = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-RZE.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO RZE-CAI-IOPC IN RZE.
           MOVE CEO-IIC-IOPC-NEW TO RZE-IIC-IOPC IN RZE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RZE.
           IF NOT FIO-STAT-OKS
               MOVE 'RZE    NOPUT'      TO CEO-CMSG
               MOVE RZE-KEY-IRCE IN RZE TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RZE.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO RZE-CAI-IOPC IN RZE.
           MOVE CEO-IIC-IOPC-OLD TO RZE-IIC-IOPC IN RZE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RZE.
           IF NOT FIO-STAT-OKS
               MOVE 'RZE    NEX'        TO CEO-CMSG
               MOVE RZE-KEY-IRCE IN RZE TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RZE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-RZE.
           IF NOT FIO-STAT-OKS
               MOVE 'RZE    NODEL'      TO CEO-CMSG
               MOVE RZE-KEY-IRCE IN RZE TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RZE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-RZE.
       FIN-CRE-NEW-KEY-RZE.
           EXIT.

       CAM-KEY-RCZ SECTION.
       INI-CAM-KEY-RCZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RCZ.
       FIN-CAM-KEY-RCZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-RCZ SECTION.
       INI-CRE-NEW-KEY-RCZ.
           MOVE SPACES           TO RCZ-KEY-IRCV IN RCZ.
           MOVE CEO-CAI-IOPC-OLD TO RCZ-CAI-IOPC IN RCZ.
           MOVE CEO-IIC-IOPC-OLD TO RCZ-IIC-IOPC IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-RCZ.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    RCZ-CAI-IOPC IN RCZ = CEO-CAI-IOPC-OLD AND
                    RCZ-IIC-IOPC IN RCZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-RCZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW    TO RCZ-CAI-IOPC IN RCZ.
           MOVE CEO-IIC-IOPC-NEW    TO RCZ-IIC-IOPC IN RCZ.
           MOVE RCZ-CIC-IOPV IN RCZ TO CEO-CIC-AUXI.
           IF RCZ-CIC-IOPV IN RCZ = CEO-CIC-IOPC-OLD
               MOVE CEO-CAI-IOPC-NEW TO RCZ-CAI-IOPV IN RCZ
               MOVE CEO-IIC-IOPC-NEW TO RCZ-IIC-IOPV IN RCZ.
           IF RCZ-CIC-IOPD IN RCZ = CEO-CIC-IOPC-OLD
               MOVE CEO-CAI-IOPC-NEW TO RCZ-CAI-IOPD IN RCZ
               MOVE CEO-IIC-IOPC-NEW TO RCZ-IIC-IOPD IN RCZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RCZ    NOPUT'      TO CEO-CMSG
               MOVE RCZ-KEY-IRCV IN RCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RCZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO RCZ-CAI-IOPC IN RCZ.
           MOVE CEO-IIC-IOPC-OLD TO RCZ-IIC-IOPC IN RCZ.
           MOVE CEO-CIC-AUXI TO RCZ-CIC-IOPV IN RCZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RCZ    NEX'        TO CEO-CMSG
               MOVE RCZ-KEY-IRCV IN RCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RCZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RCZ    NODEL'      TO CEO-CMSG
               MOVE RCZ-KEY-IRCV IN RCZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-RCZ.
       FIN-CRE-NEW-KEY-RCZ.
           EXIT.

       CAM-KEY-RDZ SECTION.
       INI-CAM-KEY-RDZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RDZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RDZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RDZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RDZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RDZ.
       FIN-CAM-KEY-RDZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-RDZ SECTION.
       INI-CRE-NEW-KEY-RDZ.
           MOVE SPACES           TO RDZ-KEY-IDLC IN RDZ.
           MOVE CEO-CAI-IOPC-OLD TO RDZ-CAI-IOPC IN RDZ.
           MOVE CEO-IIC-IOPC-OLD TO RDZ-IIC-IOPC IN RDZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    RDZ-CAI-IOPC IN RDZ = CEO-CAI-IOPC-OLD AND
                    RDZ-IIC-IOPC IN RDZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-RDZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO RDZ-CAI-IOPC IN RDZ.
           MOVE CEO-IIC-IOPC-NEW TO RDZ-IIC-IOPC IN RDZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RDZ    NOPUT'      TO CEO-CMSG
               MOVE RDZ-KEY-IRDC IN RDZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RDZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO RDZ-CAI-IOPC IN RDZ.
           MOVE CEO-IIC-IOPC-OLD TO RDZ-IIC-IOPC IN RDZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RDZ    NEX'        TO CEO-CMSG
               MOVE RDZ-KEY-IRDC IN RDZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RDZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RDZ    NODEL'      TO CEO-CMSG
               MOVE RDZ-KEY-IRDC IN RDZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RDZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-RDZ.
       FIN-CRE-NEW-KEY-RDZ.
           EXIT.

       CAM-KEY-RTZ SECTION.
       INI-CAM-KEY-RTZ.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RTZ.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-ORI TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RTZ.
           IF CEO-CMSG > SPACES
               GO TO FIN-CAM-KEY-RTZ.
           MOVE CEO-CIC-IOPC-PSO TO CEO-CIC-IOPC-OLD.
           MOVE CEO-CIC-IOPC-PRO TO CEO-CIC-IOPC-NEW.
           PERFORM CRE-NEW-KEY-RTZ.
       FIN-CAM-KEY-RTZ.
           EXIT.

      *Crea registros nuevos con llave CEO-CIC-IOPC-NEW a partir
      *de CEO-CIC-IOPC-OLD ( borra registros con CEO-CIC-IOPC-OLD )
       CRE-NEW-KEY-RTZ SECTION.
       INI-CRE-NEW-KEY-RTZ.
           MOVE SPACES           TO RTZ-KEY-IRDT IN RTZ.
           MOVE CEO-CAI-IOPC-OLD TO RTZ-CAI-IOPC IN RTZ.
           MOVE CEO-IIC-IOPC-OLD TO RTZ-IIC-IOPC IN RTZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee registros con llave original
       LUP-CRE-NEW-KEY-RTZ.
           PERFORM CBZ-FIO-RTZ.
           IF NOT ( FIO-STAT-OKS AND
                    RTZ-CAI-IOPC IN RTZ = CEO-CAI-IOPC-OLD AND
                    RTZ-IIC-IOPC IN RTZ = CEO-IIC-IOPC-OLD )
               GO TO FIN-CRE-NEW-KEY-RTZ.
      *Graba registro con nueva llave
           MOVE CEO-CAI-IOPC-NEW TO RTZ-CAI-IOPC IN RTZ.
           MOVE CEO-IIC-IOPC-NEW TO RTZ-IIC-IOPC IN RTZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RTZ    NOPUT'      TO CEO-CMSG
               MOVE RTZ-KEY-IRDT IN RTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RTZ.
      *Borrado registro original, ahora graba el nuevo registro
           MOVE CEO-CAI-IOPC-OLD TO RTZ-CAI-IOPC IN RTZ.
           MOVE CEO-IIC-IOPC-OLD TO RTZ-IIC-IOPC IN RTZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RTZ    NEX'        TO CEO-CMSG
               MOVE RTZ-KEY-IRDT IN RTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RTZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RTZ    NODEL'      TO CEO-CMSG
               MOVE RTZ-KEY-IRDT IN RTZ TO CEO-MEN2
               GO TO FIN-CRE-NEW-KEY-RTZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-CRE-NEW-KEY-RTZ.
       FIN-CRE-NEW-KEY-RTZ.
           EXIT.

