*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*%! INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% IF PGM_CHI AND PGM_BCI
*%     PGM_PTC = TRUE
*% END
*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
       COPY CBZWGENG.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-IND-ACAN                         PIC X(03).
           02 SCR-MSC-TCAN                         PIC X(01).
           02 SCR-OPC-STAT                         PIC X(01).
           02 SCR-CIC-OPEC                         PIC X(01).
           02 SCR-CIC-TCOL                         PIC X(03).
           02 SCR-CIC-TDOC                         PIC X(03).
           02 SCR-IND-OPEE                         PIC X(01).
           02 SCR-OLD-IEST                         PIC X(12).
           02 SCR-NEW-IEST                         PIC X(12).
           02 SCR-IND-PORC                         PIC X(01).
           02 SCR-COD-TINT                         PIC X(12).
           02 SCR-GLS-TIAO                         PIC X(01).
           02 SCR-GLS-CIAO                         PIC X(03).
      *>>>>
*% END
*% LARGO_MI_COMMAREA = 2750
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF WSS
      *<<<< WSS
       COPY GNSWGPES.
       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY SGCBRDBC.
       COPY SGCBRREC.

       COPY CBZBRRDZ.
       COPY CBZBRITZ.
       COPY CBZBRCOZ.
       COPY CBZBRCYZ.
       COPY CBZBRDLZ.
       COPY CBZBRVEZ.
       COPY CBZWGCAJ.
       COPY TABWGTVC.
       COPY CBZBRPOZ.
       COPY CBZBRCCZ.
       COPY CBZBRCTZ.
       COPY CBZBRCUZ.
       COPY CBZBRICZ.
       COPY CBZBRRZE.
       COPY CBZBRRCZ.

       COPY CBZBRRTZ.
       COPY CBZWGSTO.
       COPY CBZBRROZ.
       COPY CBZBRAUZ.
       COPY CBZBRCAZ.
       COPY CBZBRTOZ.
       COPY CBZWGMVO.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.
       COPY CBZBRICC.
       COPY TABBRCAM.
       COPY TABBRAHO.
       COPY CBZWGCEO.
       COPY CBZBRPIZ.
       COPY CBZBRPCZ.
       01  WSS-VARI.
      *HZF-INI 11-DEC-1996 
           03 CCO-CIC-ICLI.
              05 CCO-CAI-ICLI     VALUE SPACES    PIC X(04).
              05 CCO-IIC-ICLI     VALUE ZEROES    PIC 9(08).
           03 CIM-CIC-ICLI.
              05 CIM-CAI-ICLI     VALUE SPACES    PIC X(04).
              05 CIM-IIC-ICLI     VALUE ZEROES    PIC 9(08).
      *HZF-FIN 11-DEC-1996 
           03 WSS-NUM-REFE.
              05 WSS-NUM-CARGO                         PIC X(03).
              05 WSS-NUM-ABONO                         PIC X(03).
              05 FILLER                                PIC X(54).
           03 WSS-IND-CRUZ                             PIC X(01).
           03 WSS-CIC-OFOC                        PIC  X(03).
           03 WSS-CAI.
              05 FILLER                           PIC  X(01).
              05 WSS-CAI-OFI                      PIC  X(03).
           03 WSS-NUM-NICG                             PIC 9(03).
           03 WSS-NUM-IVEN                             PIC 9(03).
           03  WSS-KEY-RENO.
               05  WSS-IND-RENO                   PIC X(03).
               05  WSS-GLS-RENO                   PIC X(06).
               05  WSS-TIO-RENO                   PIC X(03).
           03  WSS-VSN-INT-CAJA                   PIC X(01).
           03  WSS-CMND                           PIC X(03).
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-SGV-RENO-CNV COMP-3            PIC S9(11)V9(04).
           03  WSS-COD-VCOC-CNV                   PIC X(06).
           03  WSS-COD-UF                         PIC X(06).
           03  WSS-VAL-UF       VALUE ZEROES      PIC S9(11)V9(04).
           03  WSS-SGV-CAPI          COMP-3       PIC S9(11)V9(4).
           03  WSS-SGV-IMPU          COMP-3       PIC S9(11)V9(4).
           03  WSS-FHOY.
               05 WSS-SHOY                             PIC 9(02).
               05 WSS-AHOY                             PIC 9(02).
               05 WSS-MHOY                             PIC 9(02).
               05 WSS-DHOY                             PIC 9(02).
           03  WSS-STAT                                PIC X(02).
               88 WSS-STAT-OKS    VALUE 'SI'.
           03  WSS-NUM-VCOR                            PIC 9(03).
           03 WSS-CAI-ICTA.
              05 WSS-CAI-ICTA-NUM                      PIC 9(03).
              05 FILLER                                PIC X(01).
           03 WSS-IIC-ICTA.
              05 FILLER                                PIC X(01).
              05 WSS-IIC-ICTA-NUM                      PIC 9(07).
           03 WSS-CTA-AHO.
              05 WSS-SUC-CTA-AHO                       PIC 9(03).
              05 WSS-COD-CTA-AHO                       PIC 9(07).
           03  BUS-POR-KEYS       VALUE SPACES         PIC X(01).
           03  BUS-POR-CLTE       VALUE 'C'            PIC X(01).
           03  WSS-GLS-DAT1       VALUE SPACES         PIC X(01).
           03  WSS-CIC-TCYA       VALUE SPACES         PIC X(02).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                        PIC X(03).
               05  WSS-COD-AOOC                        PIC X(03).
           03  WSS-OPC-LNBT                            PIC X(01).
           03  WSS-VLR.
               05  WSS-CIC-VCAM.
                   07  WSS-CIC-TVAL                     PIC X(01).
                   07  WSS-CIC-CVAL                     PIC X(03).
                   07  WSS-CIC-TCAM                     PIC X(08).
           03  WSS-PCAN                             PIC X(08).
           03  WSS-FEC-FCTB.
               05  WSS-NUM-SCTB                       PIC 9(02).
               05  WSS-NUM-ACTB                       PIC 9(02).
               05  WSS-NUM-MCTB                       PIC 9(02).
               05  WSS-NUM-DCTB                       PIC 9(02).
           03  WSS-FEC-FAUX.
               05  WSS-NUM-SAUX                       PIC 9(02).
               05  WSS-NUM-AAUX                       PIC 9(02).
               05  WSS-NUM-MAUX                       PIC 9(02).
               05  WSS-NUM-DAUX                       PIC 9(02).
           03  WSS-VAL-PESO                            PIC 9(11).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  PGM-STAT-POZ          VALUE '23'   PIC X(02).
               88 PGM-STAT-POZ-OKS   VALUE '00'.
               88 PGM-STAT-POZ-NUL   VALUE '  '.
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-SGV-VAL1-EDT  PIC --------------,---.
               05  WSS-GLS-GUI1                    PIC X(01).
               05  WSS-SGV-VAL2-EDT  PIC --------------,---.
           03  NOV-SGV-DIFE          COMP-3        PIC S9(11)V9(4).
           03  NOV-SGV-SNOV          COMP-3        PIC S9(11)V9(4).
           03  WSS-VAL-SVEN          COMP-3        PIC S9(11)V9(4).
       COPY CBZWUOPZ.
           03  WSS-VAL-SRDT          VALUE 0      PIC S9(11)V9(04).
           03  WSS-VAL-SINT          VALUE 0      PIC S9(11)V9(04).
           03  WSS-VAL-SCOT          VALUE 0      PIC S9(11)V9(04).
           03  WSS-I                              PIC 9(02).
           03  WSS-J                              PIC 9(02).
           03  WSS-K                              PIC 9(02).
           03  WSS-L                              PIC 9(02).
       COPY CBZWGADO.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CTZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CUZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RZE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RTZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AHO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PIZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *>>>>
*% END
*% BLLCELLS_USR = TRUE
*% IF BLLCELLS
      *<<<< BLLCELLS
       COPY CBZLGCCT.
      *>>>>
*% END
*% IF INI_STP_EXIT
      *<<<< INI_STP_EXIT
           MOVE 'CBZPQOPZ' TO SCR-PROV.
           MOVE 'ZO40'     TO SCR-NTRV.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-DESDE-CMN
                MOVE SPACES TO SCR-KEY-IRDC
                MOVE SPACES TO SCR-IND-MRDC
                MOVE SPACES TO SCR-IND-MITR
                MOVE SPACES TO SCR-IND-MCOM
                MOVE SPACES TO SCR-IND-MCYA
                MOVE SPACES TO SCR-IND-ACAN
                MOVE SPACES TO SCR-MSC-TCAN.
           MOVE 'CBZ'    TO FIO-SIST.
           MOVE 'VSN'    TO TAB-COD-TTAB IN TAB.
           MOVE 'PGMCAZ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND ( TAB-MSC-STAT IN TAB = 'S' )
               MOVE TAB-GLS-DCOR IN TAB TO WSS-PCAN
           ELSE
               MOVE 'CBZPOCAZ'          TO WSS-PCAN.
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
           MOVE SPACES TO SCR-OPC-STAT.
           MOVE SPACES TO SCR-CIC-OPEC.
           MOVE SPACES TO SCR-CIC-TCOL.
           MOVE SPACES TO SCR-CIC-TDOC.
           MOVE SPACES TO SCR-IND-OPEE.
           MOVE SPACES TO SCR-OLD-IEST.
           MOVE SPACES TO SCR-NEW-IEST.
           MOVE SPACES TO SCR-IND-PORC.
           MOVE SPACES TO SCR-GLS-TIAO.
           MOVE SPACES TO SCR-GLS-CIAO.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF NOT ( SCR-CMND = 'ACA' OR
                    SCR-CMND = 'ACO' OR
                    SCR-CMND = 'ASC' OR
                    SCR-CMND = 'ASO' )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CMDINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.

           IF SCR-MSC-TCAN = 'N'
               PERFORM GET-CAZ-FRM.
           GO TO NOV-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET
       NOV-CMN-ACC.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE 0                       TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-COD-PESO.
           IF MSG-COD-MENS > SPACES
                GO TO MSG-CMN-ACC.
           PERFORM BUS-COD-UF.
           IF MSG-COD-MENS > SPACES
                GO TO MSG-CMN-ACC.
       NO-VAL-CCU.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM KEY-ALL-OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           IF OPZ-COD-VCOC IN OPZ = WSS-COD-UF IN WSS-VARI
              PERFORM LEER-UF.
           PERFORM BUS-TCYA-LOB.
           MOVE ZEROES TO WSS-VAL-SRDT IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-SINT IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-SCOT IN WSS-VARI.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-CMN-ACC.
           IF SCR-IND-ACAN = 'NOV'
                MOVE 'O' TO ADO-IND-ORIG
                PERFORM PRO-NOV-OPZ
                MOVE ADO-MSC-MOPC TO ADO-MSC-TCAN
                MOVE CAZ-KEY-ICAN IN CAZ TO ADO-KEY-ICAN
                MOVE IDD-FSIS IN IDD-VARI TO ADO-FIDD
                MOVE FIO-MSFL TO ADO-MSFL
                MOVE ADO-CMMA TO SYS-CMMA
                MOVE SYS-LINK TO SYS-CMND
                MOVE WSS-PCAN TO SYS-PROG
                MOVE ADO-TCMA TO SYS-TCMA
                PERFORM GNS-PRO-SYS
                MOVE SYS-CMMA TO ADO-CMMA
                MOVE ADO-MSFL TO FIO-MSFL
                IF ADO-GLS-MENS > SPACES
                    MOVE ADO-GLS-MENS TO MSG-GLS-DESC FRM-MENS
                    GO TO FIN-CMN-ACC
                ELSE
                    NEXT SENTENCE
           ELSE
           IF SCR-IND-ACAN = 'REN' OR 'PRO'
                PERFORM LEE-RTZ-VCD
                MOVE 'O' TO ADO-IND-ORIG
                MOVE CAZ-KEY-ICAN IN CAZ TO ADO-KEY-ICAN
                MOVE OPZ-CIC-IOPC IN OPZ TO ADO-KEY-IOPC
                MOVE ADO-MSC-MCAN TO ADO-MSC-TCAN
                MOVE IDD-FSIS IN IDD-VARI TO ADO-FIDD
                MOVE FIO-MSFL TO ADO-MSFL
                MOVE ADO-CMMA TO SYS-CMMA
                MOVE SYS-LINK TO SYS-CMND
                MOVE WSS-PCAN TO SYS-PROG
                MOVE ADO-TCMA TO SYS-TCMA
                PERFORM GNS-PRO-SYS
                MOVE SYS-CMMA TO ADO-CMMA
                MOVE ADO-MSFL TO FIO-MSFL
                IF ADO-GLS-MENS > SPACES
                    MOVE ADO-GLS-MENS TO MSG-GLS-DESC FRM-MENS
                    GO TO FIN-CMN-ACC.

           IF SCR-MSC-TCAN = 'N'
               PERFORM ACT-OPZ-ROZ
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-ACC.
           GO TO CON-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
       CON-CMN-ACC.
           PERFORM KEY-ALL-OPZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF FIO-STAT-OKS AND
              OPZ-STP-ITRN IN OPZ NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               GO TO FIN-CMN-ACC.
           MOVE OPZ-NUM-DINP IN OPZ-FLD TO OPZ-NUM-DINP IN OPZ.
           MOVE OPZ-NUM-MINP IN OPZ-FLD TO OPZ-NUM-MINP IN OPZ.
           MOVE OPZ-NUM-SINP IN OPZ-FLD TO OPZ-NUM-SINP IN OPZ.
           MOVE OPZ-NUM-AINP IN OPZ-FLD TO OPZ-NUM-AINP IN OPZ.
           PERFORM VAL-DAT-PREV-ACA.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               PERFORM BCK-OUT
               GO TO FIN-CMN-ACC.
           IF SCR-IND-ACAN = 'NOV' OR 'REN' OR  'PRO'
               IF WSS-OPC-LNBT = 'S'
                   PERFORM SET-PARAMETROS
                   PERFORM GEN-CAR-ABN
                   IF MVO-CMSG NOT > SPACES
                       MOVE STO-ACTIVADA IN STO-VARI
                                         TO OPZ-MSC-STAT IN OPZ
                   ELSE
                       PERFORM BCK-OUT
                       MOVE MVO-CMSG TO MSG-COD-MENS
                       GO TO MSG-CMN-ACC
               ELSE
                   MOVE STO-ACTIVADA IN STO-VARI
                                     TO OPZ-MSC-STAT IN OPZ
           ELSE
               IF SCR-MSC-TCAN = 'N'
                   MOVE STO-SUSPENDIDA IN STO-VARI
                                       TO OPZ-MSC-STAT IN OPZ
               ELSE
                   IF WSS-OPC-LNBT = 'S'
                       PERFORM SET-PARAMETROS
                       PERFORM GEN-CAR-ABN
                       IF MVO-CMSG NOT > SPACES
                           MOVE STO-ACTIVADA IN STO-VARI
                                             TO OPZ-MSC-STAT IN OPZ
                       ELSE
                           PERFORM BCK-OUT
                           MOVE MVO-CMSG TO MSG-COD-MENS
                           GO TO MSG-CMN-ACC
                   ELSE
                       MOVE STO-ACTIVADA IN STO-VARI
                                         TO OPZ-MSC-STAT IN OPZ.

           IF MSG-COD-MENS > SPACES
               PERFORM BCK-OUT
               GO TO  MSG-CMN-ACC.


      *     IF SCR-CIC-TDOC        = 'LTR' AND
      *        OPZ-IND-VSTR IN OPZ = 'N'
               MOVE 'SI' TO WSS-STAT
               PERFORM PRO-DLZ-VEZ
               IF WSS-STAT-OKS
                   MOVE WSS-NUM-VCOR TO OPZ-NUM-VCOR IN OPZ
                   MOVE WSS-NUM-VCOR TO OPZ-NUM-VCVG IN OPZ
               ELSE
                   PERFORM BCK-OUT
                   GO TO FIN-CMN-ACC.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO OPZ-STP-ITRN IN OPZ.
           MOVE SCR-OTRN     TO OPZ-COD-OTRN IN OPZ.
           MOVE SCR-USER     TO OPZ-COD-ATRN IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ACC.

           IF NOT OPZ-ACTIVADA
               GO TO NOT-ING-CAJ.
           MOVE 'CBZ'       TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'INTCAJA'   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-INT-CAJA
           ELSE
               MOVE 'N' TO WSS-VSN-INT-CAJA.
           IF ( WSS-VSN-INT-CAJA    = 'S' ) AND
              ( OPZ-IND-PVEN IN OPZ = 'S' ) AND
              ( SCR-CIC-TDOC    NOT = 'LTR' )
               MOVE 'ING' TO WSS-CMND
               PERFORM VER-INT-CAJA
               IF CAJ-COD-MENS IN CAJ-CMMA > SPACES
                   PERFORM BCK-OUT
                   MOVE 'CBZ'                    TO MSG-COD-SIST
                   MOVE CAJ-COD-MENS IN CAJ-CMMA TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG      TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
               IF CAJ-GLS-MENS IN CAJ-CMMA > SPACES
                   PERFORM BCK-OUT
                   MOVE CAJ-GLS-MENS IN CAJ-CMMA TO FRM-MENS
                   GO TO FIN-CMN-ACC.
       NOT-ING-CAJ.
           IF OPZ-SUSPENDIDA
               MOVE 'OPZ    SUSOK' TO MSG-COD-MENS
           ELSE
           IF OPZ-ACTIVADA
               PERFORM UPD-DBR-COPE
               IF FIO-STAT-OKS
                   IF SCR-IND-ACAN = 'NOV'
                       MOVE 'OPZ    NOVOK' TO MSG-COD-MENS
                   ELSE
                   IF SCR-IND-ACAN = 'REN'
                       MOVE 'OPZ    RENOK' TO MSG-COD-MENS
                   ELSE
                   IF SCR-IND-ACAN = 'PRO'
                       MOVE 'OPZ    PROOK' TO MSG-COD-MENS
                   ELSE
                       MOVE 'OPZ    ACAOK' TO MSG-COD-MENS
               ELSE
                   GO TO FIN-CMN-ACC
           ELSE
               MOVE 'OPZSTT'            TO MSG-COD-TMSG
               MOVE OPZ-MSC-STAT IN OPZ TO MSG-COD-CMSG.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE ZEROES TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
              OPZ-CAI-IOPC IN OPZ-FLD = DLZ-CAI-IOPC IN DLZ AND
              OPZ-IIC-IOPC IN OPZ-FLD = DLZ-IIC-IOPC IN DLZ )
              MOVE 'DLZ    NEX' TO MSG-COD-MENS
              MOVE SPACES       TO FRM-MEN2
              GO TO MSG-CMN-ACC.
           IF ( DLZ-IND-SCTB IN DLZ NOT = SPACES ) AND
              ( OPZ-ACTIVADA )
               PERFORM GRA-REG-CTZ
               IF NOT (FIO-STAT-OKS)
                   MOVE 'CTZPUT ERR' TO MSG-COD-MENS
                   MOVE SPACES       TO FRM-MEN2
                   GO TO MSG-CMN-ACC
               ELSE
                   PERFORM GRA-REG-RTZ
                   IF NOT (FIO-STAT-OKS)
                      MOVE 'RTZPUT ERR' TO MSG-COD-MENS
                      MOVE SPACES       TO FRM-MEN2
                      GO TO MSG-CMN-ACC
                   ELSE
                       PERFORM ACT-REG-VEZ
                       IF NOT (FIO-STAT-OKS)
                           MOVE 'VEZMOD ERR' TO MSG-COD-MENS
                           MOVE SPACES       TO FRM-MEN2
                           GO TO MSG-CMN-ACC.
           IF ( OPZ-IND-RENO IN OPZ-FLD = 'PRO' ) AND
              ( OPZ-ACTIVADA )
               MOVE OPZ-CAI-IOPC IN OPZ-FLD TO CEO-CAI-IOPC-PRO
               MOVE OPZ-IIC-IOPC IN OPZ-FLD TO CEO-IIC-IOPC-PRO
               MOVE EIBTRMID                TO CEO-CAI-IOPC-PSO
               MOVE OPZ-IIC-IOPC IN OPZ-FLD TO CEO-IIC-IOPC-PSO
               PERFORM CAM-ENT-OPZ
               IF CEO-CMSG > SPACES
                   PERFORM BCK-OUT
                   MOVE CEO-CMSG TO MSG-COD-MENS
                   MOVE CEO-MEN2 TO FRM-MEN2
                   GO TO MSG-CMN-ACC.
           IF ( WSS-VSN-INT-CAJA        = 'S' ) AND
              ( OPZ-IND-PVEN IN OPZ     = 'S' ) AND
              ( SCR-CIC-TDOC        NOT = 'LTR' ) AND
              ( CEO-STAT-OKS )
               MOVE 'CAM' TO WSS-CMND
               PERFORM VER-INT-CAJA
               IF CAJ-COD-MENS IN CAJ-CMMA > SPACES
                   PERFORM BCK-OUT
                   MOVE CAJ-COD-MENS IN CAJ-CMMA TO MSG-COD-MENS
                   MOVE CAJ-GLS-MENS IN CAJ-CMMA TO FRM-MEN2
                   GO TO MSG-CMN-ACC.
       MSG-CMN-ACC.
           MOVE 'CBZ' TO MSG-COD-SIST.
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MEN1.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VER-INT-CAJA SECTION.
       INI-VER-INT-CAJA.
           IF WSS-CMND = 'CAM'
               MOVE WSS-CMND     TO CAJ-CMND     IN CAJ-CMMA(1)
               MOVE SPACES       TO CAJ-CIC-IOPC IN CAJ-CMMA(1)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(1)
               MOVE SPACES       TO CAJ-CMND     IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-CIC-IOPC IN CAJ-CMMA(2)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(2)

               MOVE CEO-CIC-IOPC-ORI TO CAJ-CIC-IOPC-ORI IN CAJ-CMMA
               MOVE CEO-CIC-IOPC-PRO TO CAJ-CIC-IOPC-PRO IN CAJ-CMMA
               MOVE CEO-CIC-IOPC-PSO TO CAJ-CIC-IOPC-PSO IN CAJ-CMMA
               GO TO CON-VER-INT-CAJA.
      *Datos Comando 1
           MOVE WSS-CMND                TO CAJ-CMND     IN CAJ-CMMA(1).
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO CAJ-CAI-IOPC IN CAJ-CMMA(1).
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO CAJ-IIC-IOPC IN CAJ-CMMA(1).
           MOVE ZEROES                  TO CAJ-NUM-IVCT IN CAJ-CMMA(1).
      *Datos Comando 2
           MOVE SPACES                  TO CAJ-CMND     IN CAJ-CMMA(2).
           MOVE SPACES                  TO CAJ-CAI-IOPC IN CAJ-CMMA(2).
           MOVE SPACES                  TO CAJ-IIC-IOPC IN CAJ-CMMA(2).
           MOVE ZEROES                  TO CAJ-NUM-IVCT IN CAJ-CMMA(2).
      *Datos Fecha de Proceso
           PERFORM GET-FHOY.
           MOVE HOY-DHOY                TO CAJ-NUM-DPRO IN CAJ-CMMA.
           MOVE HOY-MHOY                TO CAJ-NUM-MPRO IN CAJ-CMMA.
           MOVE HOY-SHOY                TO CAJ-NUM-SPRO IN CAJ-CMMA.
           MOVE HOY-AHOY                TO CAJ-NUM-APRO IN CAJ-CMMA.
      *Datos Cliente
           MOVE DBC-NUM-ICLI IN OPZ-FLD TO CAJ-NUM-ICLI IN CAJ-CMMA.
           MOVE DBC-IND-ICLI IN OPZ-FLD TO CAJ-IND-ICLI IN CAJ-CMMA.
           MOVE DBC-GLS-ICLI IN OPZ-FLD TO CAJ-GLS-ICLI IN CAJ-CMMA.
           MOVE DBC-VRF-ICLI IN OPZ-FLD TO CAJ-VRF-ICLI IN CAJ-CMMA.
           MOVE DBC-GLS-NOMC IN OPZ-FLD TO CAJ-GLS-NOMC IN CAJ-CMMA.
      *Datos Negociacion
       CON-VER-INT-CAJA.
           MOVE SPACES                  TO CAJ-IND-NEGO IN CAJ-CMMA.
           MOVE ZEROES                  TO CAJ-SGV-VNEG IN CAJ-CMMA.
           MOVE SPACES                  TO CAJ-MSC-CANC IN CAJ-CMMA.
           MOVE SPACES                  TO CAJ-CIC-TCYA IN CAJ-CMMA.
      *Datos FIO-MSFL
           MOVE FIO-MSFL                TO CAJ-MSFL     IN CAJ-CMMA.
      *Datos Retorno
           MOVE SPACES                  TO CAJ-MENS     IN CAJ-CMMA.
      *Espacio Disponible
           MOVE SPACES                  TO CAJ-COD-VCOC IN CAJ-CMMA.
           MOVE ZEROES                  TO CAJ-FEC-FVEN IN CAJ-CMMA.
           MOVE SPACES                  TO CAJ-GLS-DISP IN CAJ-CMMA.
      * Link a CBZPPCAJ, programa que actua sobre Archivo CAJA en linea
           MOVE CAJ-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
           MOVE 'CBZPPCAJ' TO SYS-PROG.
           MOVE CAJ-TCMA   TO SYS-TCMA.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA   TO CAJ-CMMA.
      *Recupera Datos FIO-MSFL
           MOVE CAJ-MSFL IN CAJ-CMMA TO FIO-MSFL.
       FIN-VER-INT-CAJA.
           EXIT.
       SET-PARAMETROS SECTION.
       INI-SET-PARAMETROS.
           MOVE 'O'                 TO MVO-COD-ORIG.
           MOVE OPZ-CAI-IOPC IN OPZ TO MVO-CAI-IOPC.
           MOVE OPZ-IIC-IOPC IN OPZ TO MVO-IIC-IOPC.
           MOVE ZEROES              TO MVO-NUM-ICAN.
           MOVE SPACES              TO MVO-ACCI.
           MOVE OPZ-COD-VCOC IN OPZ TO MVO-COD-VCOC.
           MOVE OPZ-FEC-FCOL IN OPZ TO MVO-FEC-FMOV.
           MOVE SCR-CIC-OPEC            TO MVO-OPEC.
           MOVE SPACE                   TO WSS-IND-CRUZ.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO WSS-CAI.
           IF WSS-CAI-OFI = OPZ-COD-OFOP IN OPZ-FLD
               GO TO FIN-SET-PARAMETROS
           ELSE
               MOVE OPZ-COD-OFOP IN OPZ-FLD TO OFI-COD-OFIC IN OFI
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-OFI
               IF OFI-CIC-OFIC IN OFI = WSS-CAI-OFI
                   GO TO FIN-SET-PARAMETROS
               ELSE
                   MOVE OFI-CIC-OFIC IN OFI     TO WSS-CIC-OFOC
                   MOVE WSS-CAI-OFI             TO OFI-COD-OFIC IN OFI
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-OFI
                   IF OFI-CIC-OFIC IN OFI = WSS-CIC-OFOC
                       GO TO FIN-SET-PARAMETROS
                   ELSE
                       IF OFI-CIC-OFIC IN OFI = OPZ-COD-OFOP IN OPZ-FLD
                           GO TO FIN-SET-PARAMETROS
                       ELSE
                           MOVE 'S'   TO WSS-IND-CRUZ.
       FIN-SET-PARAMETROS.
           EXIT.

       GET-CAZ-FRM SECTION.
       INI-GET-CAZ-FRM.
           MOVE CAZ-CAI-IOPC IN OPZ-FLD TO CAZ-CAI-IOPC IN CAZ.
           MOVE CAZ-IIC-IOPC IN OPZ-FLD TO CAZ-IIC-IOPC IN CAZ.
           MOVE CAZ-NUM-ICAN IN OPZ-FLD TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
       FIN-GET-CAZ-FRM.
           EXIT.

       PRO-NOV-OPZ SECTION.
       INI-PRO-NOV-OPZ.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ-CAI-IOPC IN OPZ-FLD TO ROZ-CAI-IOPV IN ROZ.
           MOVE CAZ-IIC-IOPC IN OPZ-FLD TO ROZ-IIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN OPZ-FLD TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-PRO-NOV-OPZ.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              CAZ-CAI-IOPC IN OPZ-FLD = ROZ-CAI-IOPV IN ROZ AND
              CAZ-IIC-IOPC IN OPZ-FLD = ROZ-IIC-IOPV IN ROZ
                PERFORM PRO-OPZ-ROZ
                IF MSG-COD-MENS NOT > SPACES
                      MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                      MOVE FIO-GET-NXT TO FIO-CMND
                      GO TO CIC-PRO-NOV-OPZ.
           MOVE 'CBZ' TO MSG-COD-SIST.
           MOVE 'OPZ    NOVOK' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-PRO-NOV-OPZ.
           EXIT.

       PRO-OPZ-ROZ SECTION.
       INI-PRO-OPZ-ROZ.
           IF ROZ-MSC-STAT IN ROZ NOT = 'S'
                GO TO FIN-PRO-OPZ-ROZ.
           MOVE ROZ-CIC-IOPC IN ROZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF OPZ-SUSPENDIDA
               PERFORM MOD-ROZ.
           PERFORM ACT-OPZ-OPZ.
           PERFORM UPD-DBR-COPE.
       FIN-PRO-OPZ-ROZ.
           EXIT.

       ACT-OPZ-ROZ SECTION.
       INI-ACT-OPZ-ROZ.
           PERFORM KEY-ALL-OPZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE CAZ-KEY-ICAN IN CAZ TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'ROZ    NOUPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE ROZ-KEY-IROV IN ROZ TO FRM-MEN2
               GO TO FIN-ACT-OPZ-ROZ.
           IF SCR-IND-ACAN = 'NOV'
               MOVE 'A' TO ROZ-MSC-STAT
           ELSE
               MOVE 'S' TO ROZ-MSC-STAT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
       FIN-ACT-OPZ-ROZ.
           EXIT.

       PRO-DLZ-VEZ SECTION.
       INI-PRO-DLZ-VEZ.
           MOVE ZEROES TO WSS-NUM-VCOR.
           MOVE OPZ-CAI-IOPC IN OPZ TO DLZ-CAI-IOPC IN DLZ.
           MOVE OPZ-IIC-IOPC IN OPZ TO DLZ-IIC-IOPC IN DLZ.
           MOVE ZEROES              TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-PRO-DLZ-VEZ.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
                    DLZ-CIC-IOPC IN DLZ = OPZ-CIC-IOPC IN OPZ )
               GO TO FIN-PRO-DLZ-VEZ.
           IF NOT ( DLZ-MSC-STAT IN DLZ = 'R' OR 'C' )
               ADD 1 TO WSS-NUM-VCOR
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-PRO-DLZ-VEZ.
           MOVE DLZ-CAI-IOPC IN DLZ TO VEZ-CAI-IOPC IN VEZ.
           MOVE DLZ-IIC-IOPC IN DLZ TO VEZ-IIC-IOPC IN VEZ.
           MOVE DLZ-NUM-IDLC IN DLZ TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'               TO MSG-COD-SIST
               MOVE 'VEZ    NEX  '      TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
               MOVE VEZ-KEY-IVEN IN VEZ TO FRM-MEN2
               MOVE 'NO' TO WSS-STAT
               GO TO FIN-PRO-DLZ-VEZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE 'NO' TO WSS-STAT
               GO TO FIN-PRO-DLZ-VEZ.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           GO TO LUP-PRO-DLZ-VEZ.
       FIN-PRO-DLZ-VEZ.
           EXIT.

       MOD-ROZ SECTION.
       INI-MOD-ROZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF SCR-IND-ACAN = 'NOV'
               MOVE 'A' TO ROZ-MSC-STAT
           ELSE
               MOVE 'S' TO ROZ-MSC-STAT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
       FIN-MOD-ROZ.
           EXIT.

       ACT-OPZ-OPZ SECTION.
       INI-ACT-OPZ-OPZ.
           MOVE OPZ-NUM-DINP IN OPZ-FLD TO OPZ-NUM-DINP IN OPZ.
           MOVE OPZ-NUM-MINP IN OPZ-FLD TO OPZ-NUM-MINP IN OPZ.
           MOVE OPZ-NUM-SINP IN OPZ-FLD TO OPZ-NUM-SINP IN OPZ.
           MOVE OPZ-NUM-AINP IN OPZ-FLD TO OPZ-NUM-AINP IN OPZ.
           IF WSS-OPC-LNBT = 'S'
               MOVE STO-ESPERA-ENVIO-ABONO IN STO-VARI
                                           TO OPZ-MSC-STAT IN OPZ
           ELSE
           MOVE STO-ACTIVADA IN STO-VARI TO OPZ-MSC-STAT IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
       FIN-ACT-OPZ-OPZ.
           EXIT.

       UPD-DBR-COPE SECTION.
       INI-UPD-DBR-COPE.
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.

           MOVE 'CBZ' TO TAB-COD-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    ARCO' TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT > SPACES
              PERFORM GET-UPD-RCO
              IF NOT FIO-STAT-OKS
                  GO TO FIN-UPD-DBR-COPE
              ELSE
                  NEXT SENTENCE
            ELSE
                MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CBZ' TO TAB-COD-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    AOPE' TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT > SPACES
               PERFORM GET-UPD-OPE
               IF FIO-STAT-OKS
                   PERFORM BCK-OUT
                   MOVE 'CBZ' TO MSG-COD-SIST
                   MOVE 'OPE    YAEXI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-UPD-DBR-COPE
               ELSE
                   PERFORM PUT-OPE
           ELSE
               MOVE SPACES TO MSG-COD-MENS.
       FIN-UPD-DBR-COPE.
           EXIT.

       GET-UPD-RCO SECTION.
       INI-GET-UPD-RCO.
           MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = RDZ-CIC-IOPC IN RDZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-RCO.
       LUP-GET-UPD-RCO.
           MOVE RDZ-CIC-ICLI IN RDZ TO RCO-CIC-ICLI IN RCO.
           MOVE OPZ-CAI-IOPC IN OPZ TO RCO-CAI-IOPE IN RCO.
           MOVE OPZ-IIC-IOPC IN OPZ TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               GO TO NXT-GET-RDZ-RCO.
           PERFORM PUT-RCO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-UPD-RCO.
       NXT-GET-RDZ-RCO.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = RDZ-CIC-IOPC IN RDZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-RCO.
           GO TO LUP-GET-UPD-RCO.
       FIN-GET-UPD-RCO.
           EXIT.

       GET-UPD-OPE SECTION.
       INI-GET-UPD-OPE.
           MOVE OPZ-CAI-IOPC IN OPZ TO OPE-CAI-IOPE IN OPE.
           MOVE OPZ-IIC-IOPC IN OPZ TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
       FIN-GET-UPD-OPE.
           EXIT.

       PUT-RCO SECTION.
       INI-PUT-RCO.
           MOVE SYS-TSTP TO RCO-STP-ITRN IN RCO.
           PERFORM INI-REG-RCO.
           MOVE RDZ-CIC-ICLI IN RDZ TO RCO-CIC-ICLI IN RCO.
           MOVE OPZ-CAI-IOPC IN OPZ TO RCO-CAI-IOPE IN RCO.
           MOVE OPZ-IIC-IOPC IN OPZ TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-RCO.
           EXIT.

       PUT-OPE SECTION.
       INI-PUT-OPE.
           MOVE SYS-TSTP TO OPE-STP-ITRN IN OPE.
           PERFORM INI-REG-OPE.
           MOVE OPZ-CAI-IOPC IN OPZ TO OPE-CAI-IOPE IN OPE.
           MOVE OPZ-IIC-IOPC IN OPZ TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-OPE.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       INI-REG-RCO SECTION.
       INI-INI-REG-RCO.
           MOVE SPACES                     TO RCO-GLS-FLAG IN RCO.
           MOVE SPACES                     TO RCO-MSC-TACC IN RCO.
           MOVE SPACES                     TO RCO-MSC-STAT IN RCO.
           MOVE SPACES                     TO RCO-COD-OTRN IN RCO.
           MOVE SPACES                     TO RCO-COD-ATRN IN RCO.
           MOVE SPACES                     TO RCO-COD-STAT IN RCO.
           MOVE 'TAB'                      TO FIO-SIST.
           MOVE 'RCO'                      TO TAB-CIC-TTAB IN TAB.
           IF RDZ-NUM-IDLC IN RDZ NOT > ZEROES
               MOVE 'DIR' TO TAB-CIC-CTAB IN TAB
           ELSE
               MOVE 'IND' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB IN TAB TO RCO-COD-RCOP IN RCO.
           MOVE RDZ-NUM-DIRE IN RDZ TO RCO-NUM-DIRE IN RCO.
           MOVE RDZ-VAL-LIMD IN RDZ TO RCO-VAL-PRCO IN RCO.
           MOVE OPZ-COD-COOC IN OPZ TO RCO-COD-COPR IN RCO.
           MOVE SPACES              TO RCO-GLS-DISP IN RCO.
       FIN-INI-REG-RCO.
           EXIT.

       INI-REG-OPE SECTION.
       INI-INI-REG-OPE.
           MOVE SPACES                     TO OPE-GLS-FLAG IN OPE.
           MOVE SPACES                     TO OPE-MSC-TACC IN OPE.
           MOVE SPACES                     TO OPE-MSC-STAT IN OPE.
           MOVE SPACES                     TO OPE-COD-OTRN IN OPE.
           MOVE SPACES                     TO OPE-COD-ATRN IN OPE.
           MOVE SPACES                     TO OPE-COD-STAT IN OPE.
           MOVE OPZ-COD-VCOC IN OPZ        TO OPE-COD-VCOP IN OPE.
           MOVE OPZ-COD-COOC IN OPZ        TO OPE-COD-COPR IN OPE.
           MOVE OPZ-COD-OFOC IN OPZ        TO OPE-COD-OFOP IN OPE.
           MOVE OPZ-COD-RMOC IN OPZ        TO OPE-COD-EJOP IN OPE.
           MOVE OPZ-FEC-FCOL IN OPZ        TO OPE-FEC-FIOP IN OPE.
           MOVE ZEROES                     TO OPE-FEC-FTOP IN OPE.
           MOVE SPACES                     TO OPE-COD-MOTT IN OPE.
           MOVE ZEROES                     TO OPE-FEC-FROP IN OPE.
           MOVE SPACES                     TO OPE-IND-MCLI IN OPE.
       FIN-INI-REG-OPE.
           EXIT.
       BUS-TCYA-LOB SECTION.
       INI-BUS-TCYA-LOB.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-OPC-LNBT IN WSS-VARI.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE 1                   TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NEX'        TO MSG-COD-MENS
               MOVE CYZ-KEY-ICYA IN CYZ TO FRM-MEN2
               GO TO FIN-BUS-TCYA-LOB.
           IF CYZ-IND-TCYA IN CYZ > SPACES
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC
               MOVE 'TAB'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS
                   IF MSC-CIC-CMSC IN MSC = 'CC' OR 'AH'
                       IF MSC-COD-DAT1(2) = 'S' OR 'M'
                           MOVE MSC-COD-DAT1(2)     TO WSS-OPC-LNBT
                       ELSE
                           MOVE 'MSCTCYACCLB?'      TO MSG-COD-MENS
                           MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'MSC    NEX'        TO MSG-COD-MENS
                   MOVE MSC-COD-TABL IN MSC TO FRM-MEN2.
       FIN-BUS-TCYA-LOB.
           EXIT.
       GRA-REG-CTZ SECTION.
       INI-GRA-REG-CTZ.
           PERFORM KEY-CAZ-OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO CTZ-CIC-IOPC IN CTZ.
           MOVE DLZ-NUM-IDLC IN DLZ TO CTZ-NUM-IDLC IN CTZ.
           MOVE 99                  TO CTZ-NUM-ICCT IN CTZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-CTZ.
           IF FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = CTZ-CIC-IOPC IN CTZ AND
              DLZ-NUM-IDLC IN DLZ = CTZ-NUM-IDLC IN CTZ
              MOVE CTZ-IND-SCTB IN CTZ TO CTZ-IND-SCTA IN CTZ
           ELSE
              MOVE SPACES TO CTZ-IND-SCTA IN CTZ.
           MOVE SPACES              TO CTZ-GLS-FLAG IN CTZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO CTZ-CIC-IOPC IN CTZ.
           MOVE DLZ-NUM-IDLC IN DLZ TO CTZ-NUM-IDLC IN CTZ
           MOVE 1                   TO CTZ-NUM-ICCT IN CTZ.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO CTZ-STP-ITRN IN CTZ.
           MOVE 'I'          TO CTZ-MSC-TACC IN CTZ
           MOVE 'I'          TO CTZ-MSC-STAT IN CTZ
           MOVE SCR-OTRN     TO CTZ-COD-OTRN IN CTZ.
           MOVE SCR-USER     TO CTZ-COD-ATRN IN CTZ.
           MOVE SCR-USER     TO CTZ-COD-RCCT IN CTZ.
           MOVE OPZ-NUM-DCOL IN OPZ TO CTZ-NUM-DCCT IN CTZ.
           MOVE OPZ-NUM-MCOL IN OPZ TO CTZ-NUM-MCCT IN CTZ.
           MOVE OPZ-NUM-SCOL IN OPZ TO CTZ-NUM-SCCT IN CTZ.
           MOVE OPZ-NUM-ACOL IN OPZ TO CTZ-NUM-ACCT IN CTZ.
           MOVE HOY-FHOY            TO CTZ-FEC-FINP IN CTZ.
           MOVE DLZ-IND-SCTB IN DLZ TO CTZ-IND-SCTB IN CTZ.
           MOVE ZEROES              TO CTZ-SGV-GAST IN CTZ.
           MOVE CTZ-KEY-IDLC IN CTZ TO CTZ-KEY-IVCT IN CTZ.
           MOVE 'S'                 TO CTZ-IND-ACEL IN CTZ.
           MOVE 'N'                 TO CTZ-IND-PROC IN CTZ.
           MOVE WSS-VAL-SRDT IN WSS-VARI TO CTZ-SGV-CAPI IN CTZ.
           MOVE WSS-VAL-SINT IN WSS-VARI TO CTZ-SGV-INTE IN CTZ.
           MOVE WSS-VAL-SCOT IN WSS-VARI TO CTZ-SGV-COMI IN CTZ.
           MOVE SPACES              TO CTZ-GLS-DISP IN CTZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CTZ.
       FIN-GRA-REG-CTZ.
           EXIT.
       GRA-REG-RTZ SECTION.
       INI-GRA-REG-RTZ.
           PERFORM KEY-CAZ-OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ     TO RTZ-CIC-IOPC IN RTZ.
           MOVE DLZ-NUM-IDLC IN DLZ     TO RTZ-NUM-IDLC IN RTZ.
           MOVE CTZ-IND-SCTA IN CTZ     TO RTZ-IND-SCTB IN RTZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF FIO-STAT-OKS
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM CBZ-FIO-RTZ
              MOVE FIO-DEL TO FIO-CMND
              PERFORM CBZ-FIO-RTZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO RTZ-CIC-IOPC IN RTZ.
           MOVE DLZ-NUM-IDLC IN DLZ TO RTZ-NUM-IDLC IN RTZ.
           MOVE CTZ-IND-SCTB IN CTZ TO RTZ-IND-SCTB IN RTZ.
           IF OPZ-COD-VCOC IN OPZ = WSS-COD-UF IN WSS-VARI
              MULTIPLY OPZ-VAL-SCRE IN OPZ BY WSS-VAL-UF
              GIVING   RTZ-VAL-MRDT IN RTZ ROUNDED
              MOVE RTZ-VAL-MRDT IN RTZ TO RTZ-VAL-SRDT IN RTZ
           ELSE
              MOVE OPZ-VAL-SCRE IN OPZ TO RTZ-VAL-MRDT IN RTZ
                                          RTZ-VAL-SRDT IN RTZ.
           MOVE ZEROES              TO RTZ-VAL-MINT IN RTZ.
           MOVE ZEROES              TO RTZ-VAL-SINT IN RTZ.
           MOVE ZEROES              TO RTZ-VAL-MCOT IN RTZ.
           MOVE ZEROES              TO RTZ-VAL-SCOT IN RTZ.
           IF NOT CTZ-IND-SCTB IN CTZ = 'JUD'
              GO TO CON-GRA-REG-RTZ.
           PERFORM LEE-RCZ.
           IF NOT (FIO-STAT-OKS)
               MOVE 'RCZ    NEX'        TO MSG-COD-MENS
               MOVE RCZ-KEY-ICAN IN RCZ TO FRM-MEN2
               GO TO FIN-GRA-REG-RTZ.
           PERFORM LEE-CAZ.
           IF NOT (FIO-STAT-OKS)
               MOVE 'CAZ    NEX'        TO MSG-COD-MENS
               MOVE CAZ-KEY-ICAN IN CAZ TO FRM-MEN2
               GO TO FIN-GRA-REG-RTZ.
           MOVE RCZ-KEY-IRCV IN RCZ     TO ICZ-KEY-IICG IN ICZ.
           MOVE 'GASPCA'                TO ICZ-IND-TTAS IN ICZ.
           MOVE CAZ-NUM-SCAN IN CAZ     TO ICZ-NUM-SINI IN ICZ.
           MOVE CAZ-NUM-ACAN IN CAZ     TO ICZ-NUM-AINI IN ICZ.
           MOVE CAZ-NUM-MCAN IN CAZ     TO ICZ-NUM-MINI IN ICZ.
           MOVE CAZ-NUM-DCAN IN CAZ     TO ICZ-NUM-DINI IN ICZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT (FIO-STAT-OKS)
               MOVE ZEROES TO ICZ-SGV-MNTO IN ICZ.
           IF OPZ-COD-VCOC IN OPZ = WSS-COD-UF IN WSS-VARI
              MULTIPLY RCZ-VAL-SEGC IN RCZ BY WSS-VAL-UF
              GIVING   RTZ-VAL-MCOT IN RTZ ROUNDED
              MULTIPLY RCZ-SGV-CAPI IN RCZ  BY WSS-VAL-UF
              GIVING   WSS-SGV-CAPI IN WSS-VARI ROUNDED
              MULTIPLY RCZ-VAL-IMPU IN RCZ  BY WSS-VAL-UF
              GIVING   WSS-SGV-IMPU IN WSS-VARI ROUNDED
              COMPUTE RTZ-VAL-MINT IN RTZ ROUNDED =
                      RTZ-VAL-SRDT IN RTZ - RTZ-VAL-MCOT IN RTZ -
                      WSS-SGV-CAPI IN WSS-VARI -
                      WSS-SGV-IMPU IN WSS-VARI -
                      CAZ-VAL-COMI IN CAZ - CAZ-SGV-GAST IN CAZ -
                      ICZ-SGV-MNTO IN ICZ
           ELSE
              MOVE RCZ-VAL-SEGC IN RCZ TO RTZ-VAL-MCOT IN RTZ
              COMPUTE RTZ-VAL-MINT IN RTZ ROUNDED =
                      RTZ-VAL-SRDT IN RTZ - RTZ-VAL-MCOT IN RTZ -
                      RCZ-SGV-CAPI IN RCZ - RCZ-VAL-IMPU IN RCZ -
                      CAZ-VAL-COMI IN CAZ - CAZ-SGV-GAST IN CAZ -
                      ICZ-SGV-MNTO IN ICZ.
           MOVE RTZ-VAL-MCOT IN RTZ TO RTZ-VAL-SCOT IN RTZ.
           MOVE RTZ-VAL-MINT IN RTZ TO RTZ-VAL-SINT IN RTZ.
       CON-GRA-REG-RTZ.
           MOVE SPACES       TO RTZ-GLS-FLAG IN RTZ.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO RTZ-STP-ITRN IN RTZ.
           MOVE SCR-USER     TO RTZ-COD-ATRN IN RTZ.
           MOVE SCR-OTRN     TO RTZ-COD-OTRN IN RTZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
       FIN-GRA-REG-RTZ.
           EXIT.
       ACT-REG-VEZ SECTION.
       INI-ACT-REG-VEZ.
           MOVE '00' TO FIO-STAT.
           IF DLZ-IND-SCTB IN DLZ NOT = 'JUD'
               GO TO FIN-ACT-REG-VEZ.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE 1                       TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-REG-VEZ.
           MOVE 'JUD' TO VEZ-IND-SCTB IN VEZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
       FIN-ACT-REG-VEZ.
           EXIT.
       LEE-RCZ SECTION.
       INI-LEE-RCZ.
           MOVE SPACES                  TO RCZ-KEY-IVCT IN RCZ.
           MOVE CAZ-KEY-ICAN IN CAZ     TO RCZ-KEY-ICAN IN RCZ.
           MOVE FIO-GET-NLS             TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
       FIN-LEE-RCZ.
           EXIT.
       LEE-CAZ SECTION.
       INI-LEE-CAZ.
           MOVE CAZ-KEY-ICAN IN CAZ     TO CAZ-KEY-ICAN IN CAZ.
           MOVE FIO-GET-NLS             TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
       FIN-LEE-CAZ.
           EXIT.
       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.
       LEE-RTZ-VCD SECTION.
       INI-LEE-RTZ-VCD.
           PERFORM KEY-CAZ-OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ     TO RTZ-CIC-IOPC IN RTZ.
           MOVE 1                       TO RTZ-NUM-IDLC IN RTZ.
           MOVE 'VCD'                   TO RTZ-IND-SCTB IN RTZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
           IF FIO-STAT-OKS
              MOVE RTZ-VAL-SRDT IN RTZ TO WSS-VAL-SRDT IN WSS-VARI
              MOVE RTZ-VAL-SINT IN RTZ TO WSS-VAL-SINT IN WSS-VARI
              MOVE RTZ-VAL-SCOT IN RTZ TO WSS-VAL-SCOT IN WSS-VARI.
       FIN-LEE-RTZ-VCD.
           EXIT.
       BUS-COD-UF SECTION.
       INI-BUS-COD-UF.
           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI
           ELSE
               MOVE 'CICUF    NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
       FIN-BUS-COD-UF.
           EXIT.
       LEER-UF SECTION.
       INI-LEER-UF.
           MOVE OPZ-COD-VCOC IN OPZ     TO TAB-COD-CTAB IN TAB
           MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
           MOVE OPZ-NUM-DCOL IN OPZ     TO TAB-NUM-DTRN IN TAB
           MOVE OPZ-NUM-MCOL IN OPZ     TO TAB-NUM-MTRN IN TAB
           MOVE OPZ-NUM-SCOL IN OPZ     TO TAB-NUM-STRN IN TAB
           MOVE OPZ-NUM-ACOL IN OPZ     TO TAB-NUM-ATRN IN TAB
           PERFORM GET-VCAM
           IF MSG-COD-MENS IN MSG  > SPACES
              MOVE 'UFFEC    NEX' TO MSG-COD-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE 1 TO WSS-VAL-UF IN WSS-VARI
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF IN WSS-VARI.
       FIN-LEER-UF.
           EXIT.
       COPY GNSBBMSC.
       COPY GNSBFCIC.
       COPY GNSBGCIC.
       COPY TABBBCVG.
       COPY CBZBFDLZ.
       COPY CBZBFVEZ.
       COPY CBZBFPOZ.
       COPY CBZBFCCZ.
       COPY CBZBFCTZ.
       COPY CBZBFCUZ.
       COPY CBZBFICZ.
       COPY CBZBFRZE.
       COPY CBZBFRCZ.
       COPY CBZBFRTZ.
       COPY CBZBFRDZ.
       COPY SGCBFDBC.
       COPY SGCBFREC.
       COPY CBZBFCYZ.
       COPY CBZBFROZ.
       COPY CBZBFCAZ.
       COPY CBZBFTOZ.
       COPY CBZBGMVO.
       COPY GNSBPFEC.
       COPY CBZBGVDA.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
       COPY GNSBGPES.
       COPY GNSBGCAM.
       COPY TABBFCAM.
       COPY TABBFAHO.
       COPY CBZBGTCT.
       COPY CBZBGCEO.
       COPY CBZBFPIZ.
       COPY CBZBFPCZ.
       COPY TABBGTVC.
      *>>>>
*% END
