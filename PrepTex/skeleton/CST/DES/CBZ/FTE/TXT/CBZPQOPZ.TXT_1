*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*%! INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% IF PGM_CHI AND PGM_BCI
*%     PRV_BCI = TRUE
*% END
*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
       COPY CBZWGENG.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-IND-ACAN                         PIC X(03).
           02 SCR-MSC-TCAN                         PIC X(01).
           02 SCR-OPC-STAT                         PIC X(01).
           02 SCR-CIC-OPEC                         PIC X(01).
           02 SCR-CIC-TCOL                         PIC X(03).
           02 SCR-CIC-TDOC                         PIC X(03).
           02 SCR-IND-OPEE                         PIC X(01).
           02 SCR-OLD-IEST                         PIC X(12).
           02 SCR-NEW-IEST                         PIC X(12).
           02 SCR-IND-PORC                         PIC X(01).
           02 SCR-COD-TINT                         PIC X(12).
           02 SCR-GLS-TIAO                         PIC X(01).
           02 SCR-GLS-CIAO                         PIC X(03).
	   
      *>>>> 
*% END
*%! LARGO_MI_COMMAREA = 2750
*% LARGO_TOTAL_COMMAREA = 937
*% IF WSS
      *<<<< WSS
       COPY CBZWGRNO.
       COPY CBZBRTOZ.
       COPY CBZBRPIZ.
       COPY CBZBRPCZ.
       01  WSS-VARI.
           03  WSS-SGV-TCOM                       PIC 9(03)V9(02).
           03  WSS-FIO-STAT-FLV  VALUE SPACES     PIC X(02).
           03  WSS-COD-CTAB-EAO.
               05 WSS-COD-CTAB-ENT                PIC X(03).
               05 WSS-COD-CTAB-TIO                PIC X(03).
               05 WSS-COD-CTAB-AUX                PIC X(03).
               05 WSS-COD-CTAB-FIL                PIC X(03).
           03  WSS-TAB-GLS-DATA-EAO.
               05 WSS-TAB-GLS-DATA-EAO-1          PIC X(01).
               05 WSS-TAB-GLS-DATA-EAO-2          PIC X(03).
           03 WSS-CAI-ICIC.
              05 WSS-COD-TCIC                     PIC X(01).
              05 WSS-COD-CCIC                     PIC X(03).
           03  WSS-MSC-TCAN                       PIC X(01).
           03  WSS-CIC-IOPV                       PIC X(12).
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                   PIC X(40).
               05  WSS-CPT-IOPV                   PIC X(12).
               05  WSS-CPT-DATA                   PIC X(40).
           03  WSS-CPT-NOMB-R REDEFINES WSS-CPT-NOMB PIC X(92).
           03  WSS-KEY-CRP1.
               05  WSS-TIO-ANT1                   PIC X(03).
               05  WSS-AUX-ANT1                   PIC X(01).
               05  WSS-TIO-NUE1                   PIC X(03).
               05  WSS-AUX-NUE1                   PIC X(01).
               05  WSS-FILLER                     PIC X(04).
           03  WSS-KEY-CRP2 REDEFINES WSS-KEY-CRP1.
               05  WSS-TIO-ANT2                   PIC X(03).
               05  WSS-AUX-ANT2                   PIC X(03).
               05  WSS-TIO-NUE2                   PIC X(03).
               05  WSS-AUX-NUE2                   PIC X(03).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-SGV-RENO   COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-SGV-RENO-CNV COMP-3            PIC S9(11)V9(04).
           03  WSS-COD-VCOC-CNV                   PIC X(06).
           03  RCAN-CAN-KEY-ICAN                  PIC X(15).
           03  WSS-TOT-RCAN   VALUE ZEROES        PIC 9(04).
           03  WSS-TOT-PTTS   VALUE ZEROES        PIC 9(04).
           03  WSS-CIC-IOPC                       PIC X(12).
           03  WSS-KEY-IVCT                       PIC X(15).
           03  WSS-IND-PAUT       VALUE 'N'       PIC X(01).
           03  WSS-MENS.
               05  WSS-DCOR                       PIC X(12).
               05  EDT-CAN-SGV-TREN PIC  --.---.---.--9,99999.
               05  WSS-ABRV                       PIC X(05).
               05  EDT-WSS-SGV-RENO PIC  --.---.---.--9,99999.
               05  WSS-DESC                       PIC X(40).
           03  WSS-SGV-RENO-PES COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-ROV-SGV-RENO COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-ROV-COD-VCVR                     PIC X(06).
           03  WSS-SGV-TREN     COMP-3            PIC S9(11)V9(4).

       COPY TABBRCAM.
       COPY SGCBRDBC.
       COPY SGCBRDBC REPLACING ==01  DBC== BY ==01  DBC-RESP==.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY CBZBRPOZ.
       COPY CBZBRRDZ.
       COPY CBZBRCOZ.
       COPY CBZBRCYZ.
       COPY CBZBRAUZ.
       COPY CBZBRCAZ.
       COPY CBZBRROZ.

       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY CBZWGPMP.
*% IF PRV_BCI
           COPY USPC113.
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PIZ-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2
               MOVE 'O'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF INI_STP_EXIT
      *<<<< INI_STP_EXIT
           IF SCR-CMND = 'DES'
               MOVE 'CBZPDOPZ' TO SCR-PROV
               MOVE 'ZO53'     TO SCR-NTRV
           ELSE
           IF SCR-CMND = 'ACA' OR 'ACO' OR 'ASC' OR 'ASO'
               MOVE 'CBZPOOPZ' TO SCR-PROV
               MOVE 'ZO45'     TO SCR-NTRV
           ELSE
               MOVE 'CBZPUOPZ' TO SCR-PROV
               MOVE 'ZO42'     TO SCR-NTRV.
      *>>>>
*% END 
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPZ
               PERFORM VAL-NUM-FLD-OPZ.

           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPZ
               PERFORM VAL-NUM-FLD-OPZ
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPZ
               PERFORM VAL-NUM-FLD-OPZ
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPZ
               PERFORM VAL-NUM-FLD-OPZ.
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               GO TO CON-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   IF MSG-COD-MENS = 'RDZSI'
                       PERFORM SCR-CLRA-OPZ
                       PERFORM PUT-DBC
                       MOVE RDZ-CIC-IOPC IN RDZ TO OPZ-CIC-IOPC IN OPZ
                       MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                       GO TO CON-FND-KEY
                   ELSE
                       IF SCR-KEY-IRDC = 'IDLC'
                           PERFORM CLR-FLD-OPZ
                           IF FRM-FFLD = FRM-FFLD-PF5
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDZ    NOPRV' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDZ    NONXT' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                       ELSE
                           PERFORM SCR-CLRA-OPZ
                           PERFORM PUT-DBC
                           PERFORM BUS-DEU-DIR
                           IF NOT FIO-STAT-OKS
                               MOVE 'CBZ' TO MSG-COD-SIST
                               MOVE 'CLI    NODIR' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MEN2
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                               MOVE RDZ-CIC-IOPC IN RDZ TO OPZ-CIC-IOPC
                                                                 IN OPZ
                               GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   PERFORM CLR-FLD-OPZ
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
           ELSE
           IF OPZ-IIC-IOPC IN OPZ-FLD > ZEROES
               GO TO CON-FND-KEY
           ELSE
           IF DBC-NUM-ICLI IN OPZ-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN OPZ-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPZ-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPZ-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-OPZ
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN OPZ-FLD > SPACES

               MOVE DBC-GLS-NOMC IN OPZ-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM ANL-KEY-OPZ
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-OPZ.
           IF SCR-CCPP NOT = 'ING'
               PERFORM PUT-OPZ-OPZ.
           PERFORM BUS-GLS-TEAO.
           MOVE OPZ-MSC-STAT IN OPZ TO SCR-OPC-STAT.
           MOVE SPACES              TO SCR-IND-OPEE.
           MOVE OPZ-IND-PORC IN OPZ TO SCR-IND-PORC.
           IF SCR-CCPP = 'ING'
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ
               MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ
           ELSE
               MOVE OPZ-COD-VCOC IN OPZ     TO POZ-COD-VCOC IN POZ
               MOVE OPZ-COD-TOOC IN OPZ     TO POZ-COD-TOOC IN POZ
               MOVE OPZ-COD-AOOC IN OPZ     TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                      TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'POZ    NEX  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE SCR-STAT-CON   TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE POZ-COD-TDOC IN POZ TO SCR-CIC-TDOC.
           PERFORM BUS-CIC-TDOC
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           PERFORM BUS-CIC-RENO
           IF OPZ-IND-RENO IN OPZ = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROZ-CAZ
               PERFORM BUS-CNC.

           IF (OPZ-IND-RENO IN OPZ = RNO-CIC-REN IN RNO-VARI) OR
              (OPZ-IND-RENO IN OPZ = RNO-CIC-PRO IN RNO-VARI)
               PERFORM GET-ROZ-REN
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE WSS-SGV-RENO TO ROZ-SGV-RENO IN ROZ.

           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               GO TO OPZ-FND-KEY.
           PERFORM GET-NXT-RDZ.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO ANL-CLI.
       OPZ-FND-KEY.
           PERFORM GET-CUR-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    NORDZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00'         TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE '00'   TO PGM-STAT-RDZ.
           MOVE 'IDLC' TO SCR-KEY-IRDC.
           MOVE ADR-RDZ-REQA TO SCR-RQA2.
           PERFORM GET-NXT-RDZ.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN OPZ-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO ANL-CLI.
           MOVE RDZ-CIC-ICLI IN RDZ TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'RDZ    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
            MOVE '00' TO PGM-STAT-DBC.
            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
            PERFORM CPT-BLKS.
            MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPZ-FLD.
            MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPZ-FLD.
            MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPZ-FLD.
            MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPZ-FLD.
            MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPZ-FLD.
       ANL-CLI.
            PERFORM ANL-KEY-ALL.
            IF MSG-COD-MENS NOT = SPACES
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE SCR-STAT-CON TO SCR-STAT
                GO TO FIN-FND-KEY.
       REC-OPZ-STAT.
           MOVE PGM-STAT-OPZ TO FIO-STAT.

           IF OPZ-ESPERA-ABONO
               MOVE 'CBZ'               TO MSG-COD-SIST
               MOVE 'OPZSTT'            TO MSG-COD-TMSG
               MOVE OPZ-MSC-STAT IN OPZ TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00' TO FIO-STAT
           ELSE
           IF OPZ-SUSPENDIDA
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'OPZ    SUSYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF FIO-STAT-OKS
               IF OPZ-ACTIVADA
                   IF SCR-CMND = 'MCA' OR 'DES'
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'CBZ' TO MSG-COD-SIST
                       MOVE 'OPZ    ACAYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
               ELSE
                   IF OPZ-DESACTIVADA
                       MOVE 'CBZ' TO MSG-COD-SIST
                       MOVE 'OPZ    DESYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       IF SCR-CMND = 'MCA' OR 'DES'
                           MOVE 'CBZ' TO MSG-COD-SIST
                           MOVE 'OPZ    NOACA' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
           MOVE SPACES TO SCR-OPC-STAT.
           MOVE SPACES TO SCR-CIC-OPEC.
           MOVE SPACES TO SCR-CIC-TCOL.
           MOVE SPACES TO SCR-CIC-TDOC.
           MOVE SPACES TO SCR-IND-OPEE.
           MOVE SPACES TO SCR-OLD-IEST.
           MOVE SPACES TO SCR-NEW-IEST.
           MOVE SPACES TO SCR-IND-PORC.
           MOVE SPACES TO SCR-GLS-TIAO.
           MOVE SPACES TO SCR-GLS-CIAO.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'MCA'
               MOVE FRM-CPIM-AEY TO CAZ-CAI-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-IIC-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-NUM-ICAN-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           PERFORM PRO-FLD-BCI.

           MOVE FRM-CPIM-AEY TO OPZ-COD-TOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-VCOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
           MOVE 0            TO OPZ-COD-VCOC-LEN IN OPZ-FLD.
           MOVE -1           TO DBC-NUM-ICLI-LEN IN OPZ-FLD.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                  TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.
           IF NOT ( SCR-CIC-TDOC = 'LTR' OR 'PAG' )
               MOVE FRM-CPIM-AEY TO OPZ-NUM-NPLA-ATR IN OPZ-FLD.
           IF NOT ( SCR-CIC-TDOC            = 'LTR' AND
                    OPZ-IND-VSTR IN OPZ-FLD = 'N' )
               MOVE FRM-CPIM-AEY TO OPZ-NUM-VCOR-ATR IN OPZ-FLD.
           IF POZ-COD-COTO IN POZ = 'LAC'
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO AUZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO AUZ-IIC-ICYA-ATR IN OPZ-FLD.

           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-OPZ
               PERFORM PRO-MKY-OPZ
               MOVE FRM-CPIM-UBY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
               MOVE FRM-CPIM-UBY TO OPZ-COD-RMOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD
               IF POZ-COD-COTO IN POZ NOT = 'LAC'
                   MOVE FRM-CPIM-UBY TO AUZ-CAI-ICYA-ATR IN OPZ-FLD
                   MOVE FRM-CPIM-UBY TO AUZ-IIC-ICYA-ATR IN OPZ-FLD.
           IF SCR-CMND = 'MCA'
               IF DBC-IND-ICLI IN OPZ-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
                   MOVE 0            TO OPZ-COD-OFOC-LEN IN OPZ-FLD
                   MOVE -1           TO OPZ-COD-RMOC-LEN IN OPZ-FLD
                   GO TO FIN-HBL-FLD
               ELSE
                   MOVE 0            TO OPZ-COD-OFOC-LEN IN OPZ-FLD
                   MOVE -1           TO RDZ-NUM-DIRE-LEN IN OPZ-FLD
                   GO TO FIN-HBL-FLD.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD.
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M' AND
              SCR-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYZ-IND-TCYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD.

           PERFORM BUS-CIC-RENO
           IF OPZ-IND-RENO IN OPZ-FLD > SPACES
               MOVE           +3 TO OPZ-COD-OFOC-LEN IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-OFOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-FEC-FCOL-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO ROZ-SGV-RENO-ATR IN OPZ-FLD.

           IF (OPZ-IND-RENO IN OPZ = RNO-CIC-REN IN RNO-VARI) OR
              (OPZ-IND-RENO IN OPZ = RNO-CIC-PRO IN RNO-VARI) OR
              (DBC-IND-ICLI IN OPZ-FLD = 'M')
                 MOVE -1 TO OPZ-VAL-CRED-LEN IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
           ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPZ-FLD.
           IF OPZ-IND-RENO IN OPZ-FLD > SPACES
               MOVE           +3 TO OPZ-COD-OFOC-LEN IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-OFOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-FEC-FCOL-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO ROZ-SGV-RENO-ATR IN OPZ-FLD.

           IF (OPZ-IND-RENO IN OPZ = RNO-CIC-REN IN RNO-VARI) OR
              (OPZ-IND-RENO IN OPZ = RNO-CIC-PRO IN RNO-VARI)
                 MOVE -1 TO OPZ-VAL-CRED-LEN IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPZ-FLD
                 MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
           ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPZ-FLD.
           MOVE SCR-OPC-STAT TO OPZ-MSC-STAT IN OPZ
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-CIC-TDOC SECTION.
       INI-BUS-CIC-TDOC.
           MOVE 'TAB'         TO FIO-SIST.
           MOVE 'DOC'         TO TAB-COD-TTAB IN TAB.
           MOVE SCR-CIC-TDOC  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY   TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICTDOCNEX  '  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-COD-MENS    TO FRM-MEN1
               MOVE SCR-CIC-TDOC    TO FRM-MEN2
               MOVE SCR-STAT-CON    TO SCR-STAT
               GO TO FIN-BUS-CIC-TDOC.
           MOVE TAB-CIC-CTAB IN TAB TO SCR-CIC-TDOC.
       FIN-BUS-CIC-TDOC.
           EXIT.
       GET-ROZ-CAZ SECTION.
       INI-GET-ROZ-CAZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE SPACES              TO ROZ-CIC-IOPV IN ROZ.
           MOVE ZEROES              TO ROZ-NUM-IVCT IN ROZ.
           MOVE '23' TO PGM-STAT-CAZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROZ.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-ROZ
               GO TO FIN-GET-ROZ-CAZ.

           IF OPZ-CIC-IOPC IN OPZ NOT = ROZ-CIC-IOPC IN ROZ
               GO TO FIN-GET-ROZ-CAZ.

           IF ROZ-IIC-IOPV IN ROZ > ZEROES AND
              ROZ-NUM-IVCT IN ROZ > ZEROES
                MOVE FIO-STAT TO PGM-STAT-ROZ
                MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM CBZ-FIO-CAZ
                MOVE FIO-STAT TO PGM-STAT-CAZ
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROZ.
       FIN-GET-ROZ-CAZ.
           EXIT.

       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-RQA2 > SPACES
               PERFORM LEE-NXT-PRV-RDZ
           ELSE
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               MOVE SPACES TO SCR-KEY-IRDC
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-RDZ SECTION.
       INI-LEE-NXT-PRV-RDZ.
           MOVE SCR-RQA2 TO ADR-RDZ-REQA.
           IF SCR-KEY-IRDC = 'IRDZ'
               MOVE ADR-VKEY IN ADR-RDZ-REQA TO WSS-CIC-ICLI IN
                                                       WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDZ
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE ADR-RDZ-REQA TO SCR-RQA2
                   IF RDZ-NUM-IDLC IN RDZ NOT = ZEROES
                       GO TO INI-LEE-NXT-PRV-RDZ
                   ELSE
                       MOVE 'RDZSI' TO MSG-COD-MENS
                       MOVE RDZ-CIC-ICLI IN RDZ TO DBC-CIC-ICLI IN DBC
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DBC
                       MOVE '00' TO PGM-STAT-DBC
               ELSE
                   IF RDZ-CIC-ICLI IN RDZ = WSS-CIC-ICLI IN WSS-VARI
                       MOVE ADR-RDZ-REQA TO SCR-RQA2
                       IF RDZ-NUM-IDLC IN RDZ NOT = ZEROES
                           GO TO INI-LEE-NXT-PRV-RDZ
                       ELSE
                           MOVE 'RDZSI' TO MSG-COD-MENS
                   ELSE
                       MOVE 'RDZNO' TO MSG-COD-MENS
                       MOVE SPACES TO SCR-RQA2
                       IF SCR-RQA1 > SPACES
                           PERFORM LEE-NXT-PRV-DBC
                       ELSE
                           PERFORM LEE-NXT-PRV-NOM
           ELSE
               MOVE 'RDZNO' TO MSG-COD-MENS
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   IF SCR-RQA1 > SPACES
                       PERFORM LEE-NXT-PRV-DBC
                   ELSE
                       PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-RDZ.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES

               MOVE DBC-GLS-NOMC IN OPZ-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-LEQ TO FIO-CMND
           ELSE
               MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-RQA1
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE 'DBC    NOPRV' TO MSG-COD-MENS
               ELSE
                   MOVE 'DBC    NONXT' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       ANL-KEY-OPZ SECTION.
       INI-ANL-KEY-OPZ.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPZ-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-OPZ
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPZ-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPZ-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPZ-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPZ-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPZ-FLD
               PERFORM BUS-DEU-DIR
               IF FIO-STAT-OKS
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE RDZ-CIC-IOPC IN RDZ TO OPZ-CIC-IOPC IN OPZ
               ELSE
                   MOVE 'CBZ' TO MSG-COD-SIST
                   MOVE 'CLI    NODIR' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-OPZ.
           EXIT.

       ANL-KEY-ALL SECTION.
       INI-ANL-KEY-ALL.
           PERFORM GET-CUR-COZ.
           IF FIO-STAT-OKS OR
              WSS-FIO-STAT-FLV = '00'
                IF FIO-STAT-OKS
                   MOVE '00' TO PGM-STAT-COZ
                   PERFORM GET-NXT-COZ
                   PERFORM PUT-COZ-OPZ
                ELSE
                   PERFORM PUT-COZ-OPZ
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO COZ-SGV-TINT IN OPZ-FLD.
           PERFORM BUS-AUZ-CYZ.
           PERFORM GET-CUR-CYZ.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-CYZ
                PERFORM GET-NXT-CYZ
                IF SCR-IND-MCYA = 'M'
                    MOVE 'M'          TO CYZ-IND-TCYA IN OPZ-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-CYZ-OPZ
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE SPACES TO CYZ-IND-TCYA IN OPZ-FLD
                MOVE SPACES TO CYZ-CAI-ICYA IN OPZ-FLD
                MOVE ZEROES TO CYZ-IIC-ICYA IN OPZ-FLD.
           MOVE OPZ-CIC-IOPC IN OPZ TO AUZ-CIC-IOPC IN AUZ.
           MOVE 'AUT'               TO AUZ-NUM-ICAN IN AUZ.
           MOVE 1                   TO AUZ-NUM-ICYA IN AUZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-AUZ.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-AUZ
               PERFORM PUT-AUZ-OPZ
           ELSE
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO AUZ-IIC-ICYA IN OPZ-FLD
               MOVE SPACES TO AUZ-CAI-ICYA IN OPZ-FLD.
       FIN-ANL-KEY-ALL.
           EXIT.

       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE SPACES              TO RDZ-KEY-IRDC IN RDZ.
           MOVE DBC-CAI-ICLI IN DBC TO RDZ-CAI-ICLI IN RDZ.
           MOVE DBC-IIC-ICLI IN DBC TO RDZ-IIC-ICLI IN RDZ.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE '999999999999' TO RDZ-KEY-IDLC IN RDZ
               MOVE 999 TO RDZ-NUM-IDLC IN RDZ
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-DIR.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              RDZ-CIC-ICLI IN RDZ = DBC-CIC-ICLI IN DBC
               IF RDZ-NUM-IDLC IN RDZ = ZEROES
                   MOVE '00' TO PGM-STAT-RDZ
                   MOVE ADR-RDZ-REQA TO SCR-RQA2
                   MOVE 'IRDZ' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-DIR
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIR.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN OPZ-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPZ-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPZ-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPZ-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPZ-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDZ-CAI-ICLI IN OPZ-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDZ-IIC-ICLI IN OPZ-FLD.
       FIN-PUT-DBC.
           EXIT.

       GET-CUR-RDZ SECTION.
       INI-GET-CUR-RDZ.
           MOVE OPZ-CAI-IOPC IN OPZ TO RDZ-CAI-IOPC IN RDZ.
           MOVE OPZ-IIC-IOPC IN OPZ TO RDZ-IIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              RDZ-CAI-IOPC IN RDZ = OPZ-CAI-IOPC IN OPZ AND
              RDZ-IIC-IOPC IN RDZ = OPZ-IIC-IOPC IN OPZ AND
              RDZ-NUM-IDLC IN RDZ = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-RDZ.
           EXIT.

       GET-NXT-RDZ SECTION.
       INI-GET-NXT-RDZ.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              OPZ-CAI-IOPC IN OPZ = RDZ-CAI-IOPC IN RDZ AND
              OPZ-IIC-IOPC IN OPZ = RDZ-IIC-IOPC IN RDZ AND
              RDZ-NUM-IDLC IN RDZ = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'OPZ    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDZ.
       FIN-GET-NXT-RDZ.
           EXIT.

       GET-CUR-COZ SECTION.
       INI-GET-CUR-COZ.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ.
           MOVE ZEROES              TO COZ-NUM-ICAN IN COZ.
           MOVE SPACES              TO COZ-CIC-IOPV IN COZ.
           MOVE ZEROES              TO COZ-NUM-IVCT IN COZ.
           MOVE 'COM000'            TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
                    COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
                    COZ-NUM-ICAN IN COZ = ZEROES              AND
                    COZ-CIC-IOPV IN COZ = SPACES              AND
                    COZ-NUM-IVCT IN COZ = ZEROES              AND
                    COZ-IND-TTAS IN COZ = 'COM000' )
               MOVE '23' TO WSS-FIO-STAT-FLV
               MOVE ZEROES TO WSS-SGV-TCOM
           ELSE
               MOVE '00' TO WSS-FIO-STAT-FLV
               MOVE COZ-SGV-TINT IN COZ TO WSS-SGV-TCOM.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ.
           MOVE ZEROES              TO COZ-NUM-ICAN IN COZ.
           MOVE SPACES              TO COZ-CIC-IOPV IN COZ.
           MOVE ZEROES              TO COZ-NUM-IVCT IN COZ.
           MOVE 'COM   '            TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
                    COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
                    COZ-NUM-ICAN IN COZ = ZEROES              AND
                    COZ-CIC-IOPV IN COZ = SPACES              AND
                    COZ-NUM-IVCT IN COZ = ZEROES              AND
                    COZ-IND-TTAS IN COZ = 'COM   ' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COZ.
           EXIT.

       GET-NXT-COZ SECTION.
       INI-GET-NXT-COZ.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF FIO-STAT-OKS                              AND
              COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
              COZ-NUM-ICAN IN COZ = ZEROES              AND
              COZ-CIC-IOPV IN COZ = SPACES              AND
              COZ-NUM-IVCT IN COZ = ZEROES              AND
              COZ-IND-TTAS IN COZ = 'COM'
                MOVE 'M' TO SCR-IND-MCOM
           ELSE
                MOVE SPACES TO SCR-IND-MCOM
                PERFORM GET-CUR-COZ.
       FIN-GET-NXT-COZ.
           EXIT.

       BUS-AUZ-CYZ SECTION.
       INI-BUS-AUZ-CYZ.
           MOVE 'N' TO WSS-IND-PAUT IN WSS-VARI.
           MOVE 'CYZ-KEY-ICYA' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE 1                   TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-AUZ-CYZ.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                        AND
              OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
              CYZ-NUM-ICAN IN CYZ = ZEROES )
               GO TO FIN-BUS-AUZ-CYZ.
           IF CYZ-IND-TCYA IN CYZ > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               IF MSC-COD-DAT1(2) = 'S'
                   MOVE 'S' TO WSS-IND-PAUT IN WSS-VARI
                   GO TO FIN-BUS-AUZ-CYZ.
           MOVE 'CYZ-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-AUZ-CYZ.
       FIN-BUS-AUZ-CYZ.
           EXIT.

       GET-CUR-CYZ SECTION.
       INI-GET-CUR-CYZ.
           MOVE 'CYZ-KEY-ICYA' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE 1                   TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF FIO-STAT-OKS AND
              CYZ-CIC-IOPC IN CYZ = OPZ-CIC-IOPC IN OPZ AND
              CYZ-NUM-ICAN IN CYZ = ZEROES AND
              CYZ-NUM-ICYA IN CYZ = 1
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-CYZ.
           EXIT.

       GET-NXT-CYZ SECTION.
       INI-GET-NXT-CYZ.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYZ-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF FIO-STAT-OKS                              AND
              OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
              CYZ-NUM-ICAN IN CYZ = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'CBZ'         TO MSG-COD-SIST
               MOVE 'OPZ    MCYZ' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYZ.
       FIN-GET-NXT-CYZ.
           EXIT.

       GET-CUR-ROZ SECTION.
       INI-GET-CUR-ROZ.
           MOVE 'ROZ-KEY-IROV' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE SPACES              TO ROZ-CIC-IOPV IN ROZ.
           MOVE ZEROES              TO ROZ-NUM-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              ROZ-CIC-IOPC IN ROZ = OPZ-CIC-IOPC IN OPZ AND
              ROZ-CIC-IOPV IN ROZ = SPACES AND
              ROZ-NUM-IVCT IN ROZ = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ROZ.
           EXIT.
       GET-ROZ-REN SECTION.
       INI-GET-ROZ-REN.
           MOVE OPZ-COD-VCOC IN OPZ TO OPZ-COD-VCOC IN OPZ-FLD.
           PERFORM BUS-COD-PESO.
           MOVE ZEROES TO WSS-TOT-RCAN.
           MOVE ZEROES TO WSS-TOT-PTTS IN WSS-VARI.
           IF OPZ-VAL-SCRE IN OPZ NOT > ZEROES
               PERFORM CHK-ROZ-PTTS
               IF WSS-TOT-PTTS IN WSS-VARI > ZEROES
                   GO TO VRF-RCAN.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE LOW-VALUES          TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE '23' TO PGM-STAT-ROZ.
       CIC-GET-ROZ-REN.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS OR
              OPZ-CIC-IOPC IN OPZ NOT = ROZ-CIC-IOPC IN ROZ
               GO TO VRF-RCAN.

           IF NOT ( ROZ-IIC-IOPV IN ROZ > ZEROES AND
                    ROZ-NUM-IVCT IN ROZ > ZEROES )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-ROZ-REN
           ELSE       
               MOVE FIO-STAT TO PGM-STAT-ROZ
               MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               IF FIO-STAT-OKS AND
                   ( CAZ-MSC-STAT IN CAZ = 'C' OR 
                     CAZ-MSC-STAT IN CAZ = 'W' OR 'P' ) OR
                   ( OPZ-ACTIVADA              AND
                     CAZ-MSC-STAT IN CAZ = 'A' )
                       MOVE CAZ-KEY-ICAN TO RCAN-CAN-KEY-ICAN
                       IF OPZ-ACTIVADA              AND
                          CAZ-MSC-STAT IN CAZ = 'A' AND
                          CAZ-MSC-CANC IN CAZ = 'PTT'
                           MOVE  1  TO WSS-TOT-PTTS IN WSS-VARI
                           MOVE ROZ-COD-VCVR IN ROZ TO WSS-COD-VCOC-CNV
                           MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV
                           PERFORM CONVIERTE-VALOR
                           IF MSG-COD-MENS > SPACES
                               MOVE 'CBZ'        TO MSG-COD-SIST
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-GET-ROZ-REN
                           ELSE
                               MOVE WSS-SGV-RENO-CNV TO WSS-SGV-RENO
                               MOVE FIO-GET-NXT TO FIO-CMND
                               GO TO CIC-GET-ROZ-REN
                       ELSE
                           ADD 1                   TO WSS-TOT-RCAN
                           MOVE ROZ-COD-VCVR IN ROZ TO WSS-COD-VCOC-CNV
                           MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV
                           PERFORM CONVIERTE-VALOR
                           IF MSG-COD-MENS > SPACES
                               MOVE 'CBZ'        TO MSG-COD-SIST
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-GET-ROZ-REN
                           ELSE
                               ADD WSS-SGV-RENO-CNV TO WSS-SGV-RENO
                               MOVE FIO-GET-NXT TO FIO-CMND
                               GO TO CIC-GET-ROZ-REN.
       VRF-RCAN.
           IF WSS-TOT-RCAN = ZEROES             AND
              WSS-TOT-PTTS IN WSS-VARI = ZEROES
               GO TO FIN-GET-ROZ-REN.

           MOVE RCAN-CAN-KEY-ICAN TO CAZ-KEY-ICAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
       FIN-GET-ROZ-REN.
           EXIT.
       CHK-ROZ-PTTS SECTION.
       INI-CHK-ROZ-PTTS.
           MOVE '23' TO PGM-STAT-ROZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE ZEROES              TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = ROZ-CIC-IOPV IN ROZ )
               GO TO FIN-CHK-ROZ-PTTS.
           MOVE ROZ-CIC-IOPC IN ROZ TO WSS-CIC-IOPC IN WSS-VARI.
       CAZ-CHK-ROZ-PTTS.
           MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-ACTIVADA              AND
                    CAZ-MSC-STAT IN CAZ = 'A' AND
                    CAZ-MSC-CANC IN CAZ = 'PTT' )
               GO TO FIN-CHK-ROZ-PTTS.
           MOVE LOW-VALUES TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CHK-ROZ-PTTS.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              ROZ-CIC-IOPC IN ROZ = WSS-CIC-IOPC IN WSS-VARI
               MOVE FIO-STAT TO PGM-STAT-ROZ
               IF ROZ-CIC-IOPV IN ROZ NOT = OPZ-CIC-IOPC IN OPZ
                   MOVE ROZ-KEY-IVCT IN ROZ TO WSS-KEY-IVCT IN WSS-VARI
                   ADD 1 TO WSS-TOT-PTTS IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-CHK-ROZ-PTTS
               ELSE
                   MOVE WSS-KEY-IVCT IN WSS-VARI TO RCAN-CAN-KEY-ICAN
                                                          IN WSS-VARI.
       FIN-CHK-ROZ-PTTS.
           EXIT.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY CBZBFPOZ.
       COPY CBZBFRDZ.
       COPY CBZBFROZ.
       COPY CBZBFCYZ.
       COPY CBZBFAUZ.
       COPY CBZBFCAZ.
       COPY CBZBFCOZ.
       COPY CBZBFTOZ.
       COPY CBZBFPIZ.
       COPY CBZBFPCZ.
       COPY GNSBBMSC.
       COPY GNSBGPES.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY TABBFCAM.
       PRO-FLD-BCI SECTION.
       INI-PRO-FLD-BCI.
           MOVE 'CBZ' TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    PCOPZ' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF ( NOT FIO-STAT-OKS) OR
              TAB-IND-VIGE IN TAB = 'N' 
               MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-VAL-GAST-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-SGV-LIQU-ATR IN OPZ-FLD.
       FIN-PRO-FLD-BCI.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-OPZ.
           PERFORM EDT-KEY-OPZ.
           PERFORM EDT-FLD-OPZ.
           MOVE SCR-MENS-EXT TO OPZ-GLS-MENS.
           MOVE SPACES TO SCR-CIC-IOPC
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-IND-EOV
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE OPZ-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.

       CRG-TBL-ENG SECTION.
       INI-CRG-TBL-ENG.
           IF SCR-IND-OOD = 'C'
               MOVE 'ZO07CBZPACAZCBZFCAZCBZACAZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'ZO16CBZPACYZCBZFCYZCBZACYZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 2 TO WSS-TOT-IIDX
           ELSE
               MOVE 'ZO40CBZPQOPZCBZFOPZCBZAOPZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'ZO29CBZPARDZCBZFRDZCBZARDZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 'ZO26CBZPAICZCBZFICZCBZAICZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(3)
               MOVE 'ZO16CBZPACYZCBZFCYZCBZACYZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(4)
               MOVE 'ZO12CBZPADLZCBZFDLZCBZADLZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(5)
               MOVE 'ZO29CBZPARDZCBZFRDZCBZARDZ' TO
                       WSS-VEC-PPRO IN WSS-PPRO(6)
               MOVE 7 TO WSS-TOT-IIDX.
       FIN-CRG-TBL-ENG.
           EXIT.
       COPY CBZBGRNO.

       GET-FEC-FACO SECTION.
       INI-GET-FEC-FACO.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO OPZ-NUM-DINP IN OPZ.
           MOVE HOY-MHOY TO OPZ-NUM-MINP IN OPZ.
           MOVE HOY-SHOY TO OPZ-NUM-SINP IN OPZ.
           MOVE HOY-AHOY TO OPZ-NUM-AINP IN OPZ.
       FIN-GET-FEC-FACO.
           EXIT.

       MSG-ABT-KEY SECTION.
       INI-MSG-ABT-KEY.
           MOVE 'CBZ' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-MSG-ABT-KEY.
           EXIT.

       GET-ROZ-NOV SECTION.
       INI-GET-ROZ-NOV.
           MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ.
           MOVE SPACES              TO ROZ-CIC-IOPV IN ROZ.
           MOVE ZEROES              TO ROZ-NUM-IVCT IN ROZ.
           MOVE '23' TO PGM-STAT-CAZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROZ-NOV.
           PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = ROZ-CIC-IOPC IN ROZ )
               MOVE FIO-STAT TO PGM-STAT-ROZ
               GO TO FIN-GET-ROZ-NOV.

           IF OPZ-CIC-IOPC IN OPZ NOT = ROZ-CIC-IOPC IN ROZ
               GO TO FIN-GET-ROZ-NOV.

           IF ROZ-IIC-IOPV IN ROZ > ZEROES AND
              ROZ-NUM-IVCT IN ROZ > ZEROES
       
                MOVE ROZ-SGV-RENO IN ROZ TO WSS-SGV-RENO
                                            WSS-ROV-SGV-RENO
                MOVE ROZ-COD-VCVR IN ROZ TO WSS-ROV-COD-VCVR 
                MOVE FIO-STAT TO PGM-STAT-ROZ
                MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM CBZ-FIO-CAZ
                MOVE FIO-STAT TO PGM-STAT-CAZ
                PERFORM BUS-CAMB-TREN
                IF MSG-COD-MENS > SPACES
                    GO TO FIN-GET-ROZ-NOV
                ELSE
                    NEXT SENTENCE
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROZ-NOV.
           PERFORM OBT-VAL-CAMB.
           IF MSG-COD-MENS NOT > SPACES
               MOVE WSS-SGV-RENO-PES TO WSS-SGV-RENO.
       FIN-GET-ROZ-NOV.
           EXIT.

       VRF-ROZ-NOV SECTION.
       INI-VRF-ROZ-NOV.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ-KEY-ICAN IN CAZ TO ROZ-KEY-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-VRF-ROZ-NOV.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = ROZ-CIC-IOPV IN ROZ

                IF ROZ-MSC-STAT IN ROZ = 'S'
                    PERFORM OBT-VAL-CAMB
                    ADD WSS-SGV-RENO-PES TO WSS-SGV-RENO
                    MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO CIC-VRF-ROZ-NOV
                ELSE
                    MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO CIC-VRF-ROZ-NOV.
       FIN-VRF-ROZ-NOV.
           EXIT.

       OBT-VAL-CAMB SECTION.
       INI-OBT-VAL-CAMB.
           MOVE SPACES TO MSG-COD-MENS.
           IF OPZ-COD-VCOC IN OPZ-FLD = ROZ-COD-VCVR IN ROZ 
               MOVE ROZ-SGV-RENO IN ROZ TO WSS-SGV-RENO-PES
               GO TO FIN-OBT-VAL-CAMB.
           PERFORM BUS-COD-PESO.
           IF WSS-COD-PESO = ROZ-COD-VCVR IN ROZ 
               MOVE ROZ-SGV-RENO IN ROZ TO WSS-SGV-RENO-PES
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE ROZ-COD-VCVR IN ROZ TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF FIO-STAT-OKS
                   MULTIPLY ROZ-SGV-RENO IN ROZ BY CAM-SGV-VCAM IN CAM
                            GIVING WSS-SGV-RENO-PES ROUNDED
                   MOVE WSS-COD-PESO      TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-RENO-PES  TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-PES
               ELSE
                   MOVE 'CAM    NEX'        TO MSG-COD-MENS
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   GO TO FIN-OBT-VAL-CAMB.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ-FLD
               NEXT SENTENCE
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF FIO-STAT-OKS
                   DIVIDE WSS-SGV-RENO-PES BY CAM-SGV-VCAM IN CAM
                          GIVING WSS-SGV-RENO-PES ROUNDED
                   MOVE OPZ-COD-VCOC IN OPZ-FLD
                                            TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-RENO-PES    TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-PES
               ELSE
                   MOVE 'CAM    NEX'        TO MSG-COD-MENS
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   GO TO FIN-OBT-VAL-CAMB.
       FIN-OBT-VAL-CAMB.
           EXIT.

       BUS-CAMB-TREN SECTION.
       INI-BUS-CAMB-TREN.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE OPZ-CIC-IOPC IN OPZ TO WSS-CIC-IOPC.

           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NEX'        TO MSG-COD-MENS
               MOVE OPZ-CIC-IOPC IN OPZ TO FRM-MEN2
               GO TO FIN-BUS-CAMB-TREN.

           PERFORM BUS-COD-PESO.

           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-VCOC IN OPZ TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO TAB-GLS-DAT1 IN TAB
               IF TAB-COD-DAT1 IN TAB(1) = '0'
                   MOVE WSS-COD-PESO TO OPZ-COD-VCOC IN OPZ.

           IF OPZ-COD-VCOC IN OPZ = OPZ-COD-VCOC IN OPZ-FLD
               MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-TREN
               GO TO FIN-BUS-CAMB-TREN.

           IF OPZ-COD-VCOC IN OPZ = WSS-COD-PESO
               MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-TREN
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF FIO-STAT-OKS
                   MULTIPLY CAZ-SGV-TREN IN CAZ BY CAM-SGV-VCAM IN CAM
                            GIVING WSS-SGV-TREN ROUNDED
                   MOVE WSS-COD-PESO TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-TREN TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TREN
               ELSE
                   MOVE 'CAM    NEX'        TO MSG-COD-MENS
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   GO TO FIN-BUS-CAMB-TREN.

           IF OPZ-COD-VCOC IN OPZ-FLD = WSS-COD-PESO
               NEXT SENTENCE
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF FIO-STAT-OKS
                   DIVIDE WSS-SGV-TREN BY CAM-SGV-VCAM IN CAM
                          GIVING WSS-SGV-TREN ROUNDED
                   MOVE OPZ-COD-VCOC IN OPZ-FLD
                                     TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-TREN TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-TREN
               ELSE
                   MOVE 'CAM    NEX'        TO MSG-COD-MENS
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2.
       FIN-BUS-CAMB-TREN.
           MOVE WSS-CIC-IOPC TO OPZ-CIC-IOPC IN OPZ
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM CBZ-FIO-OPZ
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NEX'        TO MSG-COD-MENS
               MOVE OPZ-CIC-IOPC IN OPZ TO FRM-MEN2.
       EXT-BUS-CAMB-TREN.
           EXIT.

      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'DES'
               MOVE FRM-CPIM-AEY TO CAZ-CAI-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-IIC-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-NUM-ICAN-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF SCR-CMND = 'APR' AND ( NOT OPZ-ACTIVADA )
               PERFORM VAL-COND-APR.
           IF ( SCR-CMND = 'ACA' OR 'ACO' OR 'ASC' OR 'ASO' ) AND
              ( SCR-STAT NOT = SCR-STAT-CON )
               PERFORM VAL-COND-ACA.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-COND-APR SECTION.
       INI-VAL-COND-APR.
           IF OPZ-APROBADA
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    APRYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
           ELSE
           IF NOT OPZ-LIQUIDADA
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    LIQNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-VAL-COND-APR.
           EXIT.
       VAL-COND-ACA SECTION.
       INI-VAL-COND-ACA.
           IF NOT OPZ-APROBADA
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    APRNO' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           PERFORM GET-FEC-FACO.
           IF ( SCR-CMND = 'ACA' OR 'ASC' ) AND
              ( OPZ-FEC-FINP IN OPZ NOT = OPZ-FEC-FCOL IN OPZ )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'FECFINPFCOLD' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF ( SCR-CMND = 'ACO' OR 'ASO' ) AND
              ( OPZ-FEC-FINP IN OPZ = OPZ-FEC-FCOL IN OPZ )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'FECFINPFCOL=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF ( SCR-CMND = 'ACO' OR 'ASO' ) AND
              ( OPZ-FEC-FINP IN OPZ NOT = OPZ-FEC-FCOL IN OPZ ) AND
              ( WSS-IND-PAUT IN WSS-VARI = 'S' )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TCYAAUTNOACA' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               GO TO UPD-VAL-COND-ACA.
           MOVE RDZ-CIC-ICLI IN RDZ TO RCO-CIC-ICLI IN RCO.
           MOVE OPZ-CAI-IOPC IN OPZ TO RCO-CAI-IOPE IN RCO.
           MOVE OPZ-IIC-IOPC IN OPZ TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'RCO    YAEXI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
       UPD-VAL-COND-ACA.
           MOVE OPZ-CAI-IOPC IN OPZ TO OPE-CAI-IOPE IN OPE.
           MOVE OPZ-IIC-IOPC IN OPZ TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPE    YAEXI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF OPZ-IND-RENO IN OPZ NOT > SPACES
                GO TO FIN-VAL-COND-ACA.
           MOVE ZEROES TO WSS-SGV-RENO.
           PERFORM BUS-CIC-RENO
           IF OPZ-IND-RENO IN OPZ = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROZ-NOV
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-VAL-COND-ACA
               ELSE
               IF ( SCR-CMND = 'ACA' OR 'ACO' OR 'ASC' OR 'ASO' ) AND
                    PGM-STAT-CAZ-OKS
                     IF NOT ( CAZ-MSC-STAT IN CAZ = 'C' OR 'W' OR 'P' )
                         MOVE 'NOVSTAT INV' TO MSG-COD-MENS
                         PERFORM MSG-ABT-KEY
                         GO TO FIN-VAL-COND-ACA
                     ELSE
                         PERFORM BUS-CNC
                         IF WSS-MSC-TCAN = 'N'
                             PERFORM VRF-ROZ-NOV
                             IF WSS-SGV-TREN        > WSS-SGV-RENO
                                 MOVE 'CBZ'         TO MSG-COD-SIST
                                 MOVE 'TOTOPZ NOV<' TO MSG-COD-MENS
                                 PERFORM GET-MSG

                                 MOVE MSG-GLS-DCOR TO WSS-DCOR
                                 MOVE WSS-SGV-TREN TO
                                      EDT-CAN-SGV-TREN
                                 MOVE MSG-GLS-ABRV TO WSS-ABRV
                                 MOVE WSS-SGV-RENO TO
                                      EDT-WSS-SGV-RENO
                                 MOVE MSG-GLS-DESC TO WSS-DESC
                                 MOVE WSS-MENS     TO CPT-STRN
                                 PERFORM CPT-BLKS
                                 MOVE CPT-STRN     TO FRM-MENS
                                 MOVE WSS-ROV-SGV-RENO TO
                                      ROZ-SGV-RENO IN ROZ
                                 MOVE WSS-ROV-COD-VCVR TO
                                      ROZ-COD-VCVR IN ROZ
                             ELSE
                                 MOVE 'CBZ'        TO MSG-COD-SIST
                                 MOVE 'ACAOPZ NOV' TO MSG-COD-MENS
                                 PERFORM GET-MSG

                                 MOVE MSG-GLS-DESC TO CPT-STR1
                                 MOVE MSG-GLS-DATA TO CPT-STR2
                                 PERFORM CPT-BLKS
                                 MOVE CPT-STRN     TO FRM-MENS
                                 MOVE 'NOV' TO SCR-IND-ACAN
                                 MOVE WSS-ROV-COD-VCVR TO
                                      ROZ-COD-VCVR IN ROZ
                                 MOVE WSS-ROV-SGV-RENO TO
                                      ROZ-SGV-RENO IN ROZ.

           PERFORM BUS-CIC-RENO
           IF (OPZ-IND-RENO IN OPZ = RNO-CIC-REN IN RNO-VARI) OR
              (OPZ-IND-RENO IN OPZ = RNO-CIC-PRO IN RNO-VARI)
               PERFORM GET-ROZ-REN
               IF MSG-COD-MENS > SPACES
                  GO TO FIN-VAL-COND-ACA
               ELSE
                        IF OPZ-IND-RENO IN OPZ = RNO-CIC-REN IN RNO-VARI
                            MOVE 'CBZ'        TO MSG-COD-SIST
                            MOVE 'ACAOPZ REN' TO MSG-COD-MENS
                            MOVE 'REN' TO SCR-IND-ACAN
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO CPT-STR1
                            MOVE MSG-GLS-DATA TO CPT-STR2
                            PERFORM CPT-BLKS
                            MOVE CPT-STRN     TO FRM-MENS
                            COMPUTE ROZ-SGV-RENO IN ROZ =
                                  OPZ-VAL-CRED IN OPZ -
                                ( OPZ-VAL-CRED IN OPZ - WSS-SGV-RENO )
                        ELSE
                            IF OPZ-IND-RENO IN OPZ = RNO-CIC-PRO
                                                     IN RNO-VARI
                                MOVE 'CBZ'        TO MSG-COD-SIST
                                MOVE 'ACAOPZ PRO' TO MSG-COD-MENS
                                MOVE 'PRO'        TO SCR-IND-ACAN
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO CPT-STR1
                                MOVE MSG-GLS-DATA TO CPT-STR2
                                PERFORM CPT-BLKS
                                MOVE CPT-STRN     TO FRM-MENS
                                COMPUTE ROZ-SGV-RENO IN ROZ =
                                      OPZ-VAL-CRED IN OPZ -
                                ( OPZ-VAL-CRED IN OPZ - WSS-SGV-RENO ).

           IF CAZ-MSC-STAT IN CAZ NOT = 'C'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZ    IOPNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
*% IF PRV_BCI
           MOVE 'CBZ'        TO FIO-SIST.
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP ACA' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = 'S'
               PERFORM VAL-OFI-USP.
*% END
       FIN-VAL-COND-ACA.
           EXIT.
*% IF PRV_BCI
       VAL-OFI-USP SECTION.
       INI-VAL-OFI-USP.
           COPY USPC143.
           IF USP-COD-OFICINA NOT = OPZ-COD-OFOC IN OPZ
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OFIUSP NOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC    TO FRM-MEN1
               MOVE USP-COD-OFICINA TO FRM-MEN2
               MOVE SCR-STAT-CON    TO SCR-STAT.
       FIN-VAL-OFI-USP.
           EXIT.
            COPY USPC113.
*% END
       BUS-GLS-TEAO SECTION.
       INI-BUS-GLS-TEAO.
           MOVE 'CBZ'                   TO FIO-SIST.
           MOVE 'EAO'                   TO TAB-COD-TTAB IN TAB.
           MOVE 'OPZ'                   TO WSS-COD-CTAB-ENT IN WSS-VARI.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-COD-CTAB-TIO IN WSS-VARI.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO WSS-COD-CTAB-AUX IN WSS-VARI.
           MOVE SPACES                  TO WSS-COD-CTAB-FIL IN WSS-VARI.
       LUP-BUS-GLS-TEAO.
           MOVE WSS-COD-CTAB-EAO     TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               IF NOT WSS-COD-CTAB-AUX IN WSS-VARI = '*'
                   MOVE '*'      TO WSS-COD-CTAB-AUX IN WSS-VARI
                   GO TO LUP-BUS-GLS-TEAO
               ELSE 
                   GO TO FIN-BUS-GLS-TEAO.
           IF TAB-IND-VIGE IN TAB = 'N'
               GO TO FIN-BUS-GLS-TEAO.
           MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-GLS-DATA-EAO IN WSS-VARI.
           MOVE WSS-TAB-GLS-DATA-EAO-1 IN WSS-VARI TO SCR-GLS-TIAO.
           MOVE WSS-TAB-GLS-DATA-EAO-2 IN WSS-VARI TO SCR-GLS-CIAO.
       FIN-BUS-GLS-TEAO.
           EXIT.
      *>>>>
*% END
