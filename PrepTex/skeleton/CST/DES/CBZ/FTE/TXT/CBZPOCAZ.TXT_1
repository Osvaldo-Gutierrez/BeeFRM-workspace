*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% LARGO_TOTAL_COMMAREA=879
*% NO_HDR_CST = TRUE
*% MANEJO_MAPA_USR = TRUE
*% IF MANEJO_MAPA 
       COPY CBZBOCAZ.
*% END
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY CBZWGENG.
       COPY CBZW1CAN.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY
                               ==02  SCR-CAZ-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY CBZBRCYZ.
       COPY CBZBRICZ.
       COPY CBZBRPIZ.
       COPY CBZBRITZ.
       COPY CBZBROPZ.
       COPY CBZBRCTZ.
       COPY CBZBRDLZ.
       COPY CBZBRRCZ.
       COPY CBZBRROZ.
       COPY CBZBRRTZ.
       COPY CBZBRVEZ.
       COPY CBZBRVEZ REPLACING ==VEZ== BY ==VEZ-BKP==.
       COPY CBZBRCAZ REPLACING ==CAZ== BY ==CAZ-BKP==.
       COPY CBZBRRDZ.
       COPY CBZBRTOZ.
       COPY SGCBRDBC.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY GNSWGCPT.
       COPY GNSWGCIC.
       COPY GNSBRCIC.
       COPY TABBRCAM.
       COPY TABBRVLR.
       COPY TABWGTVC.
       COPY CBZBRICC.
       COPY CBZBRRZE.
       COPY GNSWGBCD.
       COPY CBZWGCAJ.
       COPY CBZWGINT.
       COPY GNSWGCVI.

       COPY CBZBRMVO.
       COPY CBZWGMVO.

       COPY GNSBRERR.
       COPY GNSWGPES.
       COPY CBZWGADO.
       COPY CBZW2CAN.
           03  WSS-COM-NUM-IVCT                     PIC 9(03).
           03  WSS-IND-TTAS.
               05 WSS-GLS-NTAS                      PIC X(03).
               05 WSS-GLS-STAS                      PIC X(03).
           03  WSS-GLS-DATI.
               05  FILLER                           PIC X(06).
               05  WSS-IND-CSAF                     PIC X(01).
               05  FILLER                           PIC X(03).
           03  WSS-CMND                             PIC X(03).
           03  WSS-SDLC.
               05 WSS-VAL-SDLC OCCURS 500          PIC S9(11)V9(04).
           03  WSS-VAL-OCRE                        PIC S9(11)V9(04).
           03  WSS-IND-RNOV                        PIC X(01).
           03  WSS-IND-SAFE                        PIC X(01).
           03  WSS-IND-CTCT                        PIC X(01).
           03  WSS-SGV-LIQU     COMP-3             PIC S9(11)V9(4).
           03  WSS-CAN-MSC-STAT                    PIC X(01).
           03  WSS-MAXV                            PIC 9(03).
           03  WSS-MINV                            PIC 9(03).
           03  WSS-MAXD                            PIC 9(03).
           03  WSS-MIND                            PIC 9(03).
           03  WSS-NUM-IDLC                        PIC 9(04).
           03  WSS-IDLC.
               05  WSS-VEC-IDLC OCCURS 500.
                   07  WSS-SGV-CAPD   COMP-3       PIC S9(11)V9(04).
                   07  WSS-SGV-FINA   COMP-3       PIC S9(11)V9(04).
           03  WSS-SGV-CAPT           COMP-3       PIC S9(11)V9(04).
           03  WSS-SGV-FINL           COMP-3       PIC S9(11)V9(04).
           03  WSS-SGV-SEGC           COMP-3       PIC S9(11)V9(04).
           03  WSS-NUM-VCVG                        PIC S9(03).
           03  WSS-NUM-VCCM                        PIC S9(03).
           03  WSS-NUM-VCCO                        PIC S9(03).
           03  WSS-NUM-VCCV                        PIC S9(03).
           03  WSS-I            VALUE ZEROES       PIC 9(03).
           03  WSS-IMAX         VALUE 50           PIC 9(03).
           03  WSS-IND-ALG      VALUE SPACES       PIC X(01).
           03 REV-MSG.
              05 REV-MSG-MSG                       PIC X(40).
              05 REV-MSG-CAN                       PIC X(15).
           03 WSS-NUM-IEVC                         PIC 9(03).
           03  WSS-VAL-VENC             COMP-3     PIC 9(11)V9(04).
           03  WSS-FEC-FAMT.
               05  WSS-NUM-SAMT                    PIC 9(02).
               05  WSS-NUM-AAMT                    PIC 9(02).
               05  WSS-NUM-MAMT                    PIC 9(02).
               05  WSS-NUM-DAMT                    PIC 9(02).
           03  WSS-IND-ADO      VALUE 'N'          PIC X(01).
           03  WSS-AUX-IVEN                        PIC 9(03).
           03  WSS-IND-SCTB                        PIC X(03).
           03  WSS-IND-SCBZ                        PIC X(05).
           03  WSS-IND-EXIS            VALUE 'N'   PIC X(01).
           03  WSS-VAL-CAPI-GENE       COMP-3      PIC 9(11)V9(04).
           03 CAZ-SGV-TPAG-EDT1               PIC  ---.---.---.--9,9999.
           03 ICZ-SGV-TINT-EDT1               PIC  ---9,9999.
           03 WSS-IND-CRUZ                        PIC  X(01).
           03 WSS-CIC-OFIC                        PIC  X(03).
           03 WSS-CAI.
              05 FILLER                           PIC  X(01).
              05 WSS-CAI-OFI                      PIC  X(03).
           03 WSS-SCR-QIDD.
              05 WSS-GIDD                         PIC  X(04).
              05 WSS-EIBTRMID                     PIC  X(04).
           03 WSS-AUX                COMP         PIC 9(02).
           03 WSS-AUX-DLIM.
              05  WSS-AUX-DLI1                    PIC X(01).
              05  WSS-AUX-DLI2                    PIC X(01).
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-UFES                        PIC X(06).
           03  WSS-GLS-DAT3.
               05 FILLER                          PIC X(12).
               05 WSS-IND-TCRE                    PIC X(02).
               05 FILLER                          PIC X(16).
           03  WSS-IND-FUTU          VALUE SPACES PIC X(01).
           03 WSS-NUM-IVAC                        PIC 9(03).
           03 WSS-KEY-IICG                        PIC X(41).
       COPY CBZWGMUF.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CTZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RTZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RZE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PIZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MVO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ERR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% BLLCELLS_USR = TRUE
*% IF BLLCELLS
      *<<<< BLLCELLS
       COPY CBZLGCCT.
      *>>>>
*% END
*% IF PGM_INI
      *<<<< PGM_INI
           IF EIBCALEN = ADO-TCMA
               MOVE 'GIDD'       TO WSS-GIDD
               MOVE EIBTRMID     TO WSS-EIBTRMID
               MOVE WSS-SCR-QIDD TO SCR-QIDD
               MOVE +490         TO SCR-LIDD.
      *>>>>
*% END
*% IF PGM_POS_EDB
      *<<<< PGM_POS_EDB
           IF EIBCALEN = ADO-TCMA
               MOVE 'CBZPOCAZ' TO FIO-PROG
               PERFORM GNS-BUS-IDD
               GO TO CON-INI.
      *>>>>
*% END
*% IF INI_FIO_IBM
      *<<<< INI_FIO_IBM
       CON-INI.
           IF EIBCALEN = ADO-TCMA
               MOVE DFHCOMMAREA TO ADO-CMMA
               MOVE ADO-MSFL TO FIO-MSFL
               PERFORM GET-STAT-ADO
               PERFORM ADO-CAZ
               MOVE FIO-MSFL TO ADO-MSFL
               MOVE ADO-CMMA TO DFHCOMMAREA
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-COD-TICG
                              SCR-COD-TITR
                              SCR-COD-VCOC
                              SCR-CYA-IND-MCYA
                              SCR-CYA-IND-PAUT
                              SCR-CYA-IND-CAJA
                              SCR-CYA-IND-CCTE.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           MOVE 'CBZ'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB. 
           MOVE 'OFIUSPCAZACA' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = 'S'
               PERFORM VAL-OFI-USP.

           PERFORM VAL-DAT-PREV-ACA.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
       COPY CBZB1CAN.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       COPY CBZB2CAN.
           IF SCR-CMND = 'REV'
               GO TO FND-KEY-REV.
           PERFORM GET-FEC-FCVC.
           IF PGM-STAT-CAZ-OKS
               IF SCR-CMND = 'CAN' AND
                  CAZ-FEC-FOUT IN CAZ NOT = CAZ-FEC-FCAN IN CAZ
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'FECFCANNFOUT' TO MSG-COD-MENS
                   PERFORM GET-MSG


                   MOVE MSG-GLS-DESC TO CPT-STR1
                   MOVE MSG-GLS-DATA TO CPT-STR2
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN     TO FRM-MENS

                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
               IF SCR-CMND = 'CVC'
                   IF SCR-CYA-IND-PAUT = 'S'
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'TCYAAUTNOCVC' TO MSG-COD-MENS
                       PERFORM GET-MSG


                       MOVE MSG-GLS-DESC TO CPT-STR1
                       MOVE MSG-GLS-DATA TO CPT-STR2
                       PERFORM CPT-BLKS
                       MOVE CPT-STRN     TO FRM-MENS

                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
           IF CAZ-MSC-STAT IN CAZ = 'S' OR 'W'
               NEXT SENTENCE
           ELSE
           IF ( WSS-VSN-INT-CAJA    = 'S' ) AND
              ( OPZ-IND-PVEN IN OPZ = 'S' ) AND
              ( WSS-CIC-TDOC    NOT = 'LTR' ) AND
              ( SCR-CMND            = 'CAN' OR 'CVC' )
               MOVE 'VRF' TO WSS-CMND
               PERFORM VER-INT-CAJA
               IF ( CAJ-COD-MENS IN CAJ-CMMA     > SPACES       ) AND
                  ( CAJ-COD-MENS IN CAJ-CMMA NOT = 'CAJ    NEX' )
                       MOVE 'CBZ'                    TO MSG-COD-SIST
                       MOVE CAJ-COD-MENS IN CAJ-CMMA TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC IN MSG      TO FRM-MENS
                       MOVE '00'                     TO FIO-STAT
                       MOVE SCR-STAT-CON             TO SCR-STAT
                       GO TO FIN-FND-KEY.
       FND-KEY-REV.
           MOVE PGM-STAT-CAZ TO FIO-STAT.
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
           MOVE SPACES TO SCR-COD-TICG
                          SCR-COD-TITR
                          SCR-COD-VCOC
                          SCR-CYA-IND-MCYA
                          SCR-CYA-IND-PAUT
                          SCR-CYA-IND-CAJA
                          SCR-CYA-IND-CCTE.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'REV'
               MOVE FRM-CPIM-AEY TO CAZ-NUM-ICAN-ATR IN CAZ-FLD.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND NOT = 'CAN' AND
              SCR-CMND NOT = 'CVC' AND
              SCR-CMND NOT = 'REV'
               MOVE 'GNS'    TO MSG-COD-SIST
               MOVE 'CMDINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           MOVE SPACES TO REV-MSG.
      *>>>>
*% END
*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET
           PERFORM GET-FHOY.
           MOVE 'N' TO WSS-IND-RNOA.
           IF SCR-CMND = 'REV'
               MOVE CAZ-NUM-ICAN IN CAZ-FLD TO WSS-CAN-NUM-ICAN
               MOVE 'S' TO WSS-IND-RNOA
               PERFORM BUS-IND-SFCR
               IF MSG-COD-MENS > SPACES
                   IF MSG-COD-MENS = 'CAZ    REVOK'
                       MOVE SPACES TO MVO-CMSG
                       PERFORM VRF-REV-CRG-AUT
                       IF MVO-CMSG > SPACES
                           MOVE MVO-CMSG TO MSG-COD-MENS
                           GO TO BCK-CMN-ACC
                       ELSE
                       PERFORM ACU-RTZ
                       PERFORM INT-CAJA-CAZ-REV
                       IF CAJ-COD-MENS IN CAJ-CMMA > SPACES
                           GO TO FIN-CMN-ACC
                       ELSE
                       PERFORM SET-STTR-RCZ
                       GO TO FIN-CMN-ACC
                   ELSE
                   GO TO FIN-CMN-ACC.
           PERFORM GET-OPZ.
           IF WSS-IND-ADO = 'S'
               PERFORM FND-KEY-CYZ.
           IF SCR-MSC-TCAN = 'C'
               IF SCR-CYA-IND-CCTE = 'S'
                   IF SCR-CYA-IND-PAUT = 'S'
                       PERFORM SET-PARAMETROS
                       PERFORM GEN-CAR-ABN
                       IF MVO-CMSG NOT > SPACES
                          MOVE SPACES TO MSG-COD-MENS
                          MOVE 'A'    TO WSS-CAN-MSC-STAT
                       ELSE
                           MOVE MVO-CMSG TO MSG-COD-MENS
                           GO TO BCK-CMN-ACC
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF SCR-CYA-IND-CAJA = 'S' AND
                  ADO-IND-ORIG NOT = 'S'
                   IF WSS-IND-ADO = 'N' AND
                      CAZ-MSC-STAT IN CAZ-FLD = 'S' AND
                      SCR-CMND NOT = 'REV'
                       MOVE 'A' TO WSS-CAN-MSC-STAT
                   ELSE
                   MOVE 'S' TO WSS-CAN-MSC-STAT
               ELSE
                   MOVE 'A' TO WSS-CAN-MSC-STAT
           ELSE
               IF WSS-IND-ADO = 'S'
                   IF CAZ-MSC-STAT IN CAZ = 'W'
                       IF ADO-IND-ORIG = 'S'
                            MOVE 'C' TO WSS-CAN-MSC-STAT
                       ELSE
                            MOVE 'S' TO WSS-CAN-MSC-STAT
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'P'
                       MOVE 'G' TO WSS-CAN-MSC-STAT
                   ELSE
                       MOVE 'A' TO WSS-CAN-MSC-STAT
               ELSE
                    IF CAZ-MSC-STAT IN CAZ-FLD = 'W'
                        MOVE 'C' TO WSS-CAN-MSC-STAT
                    ELSE
                    IF CAZ-MSC-STAT IN CAZ-FLD = 'S'
                        MOVE 'A' TO WSS-CAN-MSC-STAT
                    ELSE
                   MOVE 'C' TO WSS-CAN-MSC-STAT
                   IF SCR-CYA-IND-CCTE = 'S'
                       MOVE 'P' TO WSS-CAN-MSC-STAT
                   ELSE
                   IF SCR-CYA-IND-CAJA = 'S'
                       MOVE 'W' TO WSS-CAN-MSC-STAT.
           IF ADO-IND-ORIG = 'S'
                PERFORM CRG-AUTO
           ELSE
           IF ADO-IND-ORIG = SPACES AND
              ( WSS-CAN-MSC-STAT = 'C' OR 'A' )
                PERFORM CRG-AUTO.
           MOVE CAZ-NUM-SOUT IN CAZ-FLD TO CAZ-NUM-SOUT IN CAZ.
           MOVE CAZ-NUM-AOUT IN CAZ-FLD TO CAZ-NUM-AOUT IN CAZ.
           MOVE CAZ-NUM-MOUT IN CAZ-FLD TO CAZ-NUM-MOUT IN CAZ.
           MOVE CAZ-NUM-DOUT IN CAZ-FLD TO CAZ-NUM-DOUT IN CAZ.
           GO TO NOT-RET-ALL.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
       NOT-RET-ALL.
           IF NOT ( SCR-MSC-TCAN = 'C' OR
                    WSS-IND-ADO  = 'S' )
               GO TO CON-ACA.
           PERFORM INI-CAZ.
           IF WSS-CAN-MSC-STAT = 'A'
               IF ( CAZ-MSC-FCAN IN CAZ = 'T' AND
                    CAZ-MSC-ECAN IN CAZ = 'T' ) OR
                  ( CAZ-MSC-FCAN IN CAZ = 'T' AND
                    CAZ-MSC-ECAN IN CAZ = 'E' AND
                    OPZ-NUM-VCOR IN OPZ = 1 )
                  PERFORM TOT-CUO
               ELSE
                  PERFORM PRO-RCZ.
       BCK-CMN-ACC.
           IF MSG-COD-MENS > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               PERFORM BCK-OUT
               GO TO FIN-CMN-ACC.
       CON-ACA.
           PERFORM SET-STTR-RCZ.
           MOVE WSS-CAN-MSC-STAT TO CAZ-MSC-STAT IN CAZ.
           IF WSS-IND-RNOA = 'S'
               MOVE 'A' TO CAZ-MSC-STAT IN CAZ.
           PERFORM PUT-FHOY.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
           PERFORM INT-CAJA-CAZ-REV.
           IF CAJ-COD-MENS IN CAJ-CMMA > SPACES
               GO TO FIN-CMN-ACC.
           IF REV-MSG > SPACES
               PERFORM ACU-RTZ
               MOVE REV-MSG TO FRM-MENS
           ELSE
               IF MVO-ABNO > SPACES
                   PERFORM EMI-MSG
               ELSE
               IF PGM-STAT-CAZ-OKS
                   IF CAZ-MSC-STAT IN CAZ = 'S'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    SAFOK' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'G' OR 'H'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    CCTOK' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'C'
                       IF CAZ-MSC-TCAN IN CAZ = 'N'
                           MOVE 'CBZ'          TO MSG-COD-SIST
                           MOVE 'CAZ    NOVYA' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                       ELSE
                           IF CAZ-MSC-TCAN IN CAZ = 'R'
                               MOVE 'CBZ'          TO MSG-COD-SIST
                               MOVE 'CAZ    RENYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                           ELSE
                               MOVE 'CBZ'          TO MSG-COD-SIST
                               MOVE 'CAZ    PROYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'W' OR 'P'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    ALLYA' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                      PERFORM REV-RTZ
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    ACAOK' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CAZ    ACANO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-OFI-USP SECTION.
       INI-VAL-OFI-USP.
           MOVE 'USR-COD-USER' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE SCR-USER TO USR-COD-USER IN USR.
           PERFORM TAB-FIO-USR.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'USRACA NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE SCR-USER     TO FRM-MEN2
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-OFI-USP.
           IF USR-COD-OFUS NOT = CAZ-COD-OFCA IN CAZ
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OFIUSP NOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE USR-COD-OFUS IN USR TO FRM-MEN2
               MOVE SCR-STAT-CON        TO SCR-STAT.
       FIN-VAL-OFI-USP.
           EXIT.

       INT-CAJA-CAZ-REV SECTION.
       INI-INT-CAJA-CAZ-REV.
           MOVE SPACES TO CAJ-COD-MENS IN CAJ-CMMA.
           MOVE 'CBZ'       TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'INTCAJA'   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-INT-CAJA-CAZ-REV.
           PERFORM BUS-OPZ-DLZ.
           IF NOT ( ( OPZ-IND-PVEN IN OPZ = 'S' ) AND
                    ( WSS-CIC-TDOC    NOT = 'LTR' ) )
               GO TO FIN-INT-CAJA-CAZ-REV.
           IF  ( SCR-CMND = 'REV' )
               MOVE 'REV' TO WSS-CMND
           ELSE
               MOVE 'CAN' TO WSS-CMND.
           PERFORM VER-INT-CAJA.
           IF CAJ-COD-MENS IN CAJ-CMMA > SPACES
               PERFORM BCK-OUT
               MOVE 'CBZ'                    TO MSG-COD-SIST
               MOVE CAJ-COD-MENS IN CAJ-CMMA TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG      TO FRM-MENS
               MOVE '00'                     TO FIO-STAT
               MOVE SCR-STAT-CON             TO SCR-STAT.
       FIN-INT-CAJA-CAZ-REV.
           EXIT.
       VER-INT-CAJA SECTION.
       INI-VER-INT-CAJA.
           IF WSS-CMND = 'VPC' OR 'VRF'
               MOVE WSS-CMND     TO CAJ-CMND     IN CAJ-CMMA(1)
               MOVE CAZ-CAI-IOPC IN CAZ-FLD
                                 TO CAJ-CAI-IOPC IN CAJ-CMMA(1)
               MOVE CAZ-IIC-IOPC IN CAZ-FLD
                                 TO CAJ-IIC-IOPC IN CAJ-CMMA(1)
               MOVE VEZ-NUM-IVCT IN VEZ
                                 TO CAJ-NUM-IVCT IN CAJ-CMMA(1)
               MOVE SPACES       TO CAJ-CMND     IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-CAI-IOPC IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-IIC-IOPC IN CAJ-CMMA(2)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(2)
               GO TO CON-VER-INT-CAJA.
           IF WSS-CMND = 'REV'
               MOVE WSS-CMND     TO CAJ-CMND     IN CAJ-CMMA(1)
               MOVE CAZ-CAI-IOPC IN CAZ-FLD
                                 TO CAJ-CAI-IOPC IN CAJ-CMMA(1)
               MOVE CAZ-IIC-IOPC IN CAZ-FLD
                                 TO CAJ-IIC-IOPC IN CAJ-CMMA(1)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(1)
               MOVE SPACES       TO CAJ-CMND     IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-CAI-IOPC IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-IIC-IOPC IN CAJ-CMMA(2)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(2)
               GO TO CON-VER-INT-CAJA.
           PERFORM BUS-CIC-TCYA.
           IF WSS-CMND = 'CAN'
               MOVE 'CAN'        TO CAJ-CMND     IN CAJ-CMMA(1)
               MOVE CAZ-CAI-IOPC IN CAZ-FLD
                                 TO CAJ-CAI-IOPC IN CAJ-CMMA(1)
               MOVE CAZ-IIC-IOPC IN CAZ-FLD
                                 TO CAJ-IIC-IOPC IN CAJ-CMMA(1)
               MOVE VEZ-NUM-IVCT IN CAZ-FLD
                                 TO CAJ-NUM-IVCT IN CAJ-CMMA(1)
               MOVE SPACES       TO CAJ-CMND     IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-CAI-IOPC IN CAJ-CMMA(2)
               MOVE SPACES       TO CAJ-IIC-IOPC IN CAJ-CMMA(2)
               MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(2)
               MOVE CAZ-MSC-CANC IN CAZ-FLD TO CAJ-MSC-CANC IN CAJ-CMMA
               IF ( CAZ-MSC-STAT IN CAZ      NOT = 'A' ) OR
                  ( RCZ-MSC-MCAN IN CAZ-FLD      = 'V' ) OR
                  ( CAJ-MSC-FCAN IN CAJ-CMMA NOT = 'T' )
                   NEXT SENTENCE
               ELSE
                   MOVE 'ING'        TO CAJ-CMND     IN CAJ-CMMA(2)
                   MOVE CAZ-CAI-IOPC IN CAZ-FLD
                                     TO CAJ-CAI-IOPC IN CAJ-CMMA(2)
                   MOVE CAZ-IIC-IOPC IN CAZ-FLD
                                     TO CAJ-IIC-IOPC IN CAJ-CMMA(2)
                   MOVE ZEROES       TO CAJ-NUM-IVCT IN CAJ-CMMA(2).
           MOVE DBC-NUM-ICLI IN CAZ-FLD TO CAJ-NUM-ICLI IN CAJ-CMMA.
           MOVE DBC-IND-ICLI IN CAZ-FLD TO CAJ-IND-ICLI IN CAJ-CMMA.
           MOVE DBC-GLS-ICLI IN CAZ-FLD TO CAJ-GLS-ICLI IN CAJ-CMMA.
           MOVE DBC-VRF-ICLI IN CAZ-FLD TO CAJ-VRF-ICLI IN CAJ-CMMA.
           MOVE DBC-GLS-NOMC IN CAZ-FLD TO CAJ-GLS-NOMC IN CAJ-CMMA.
       CON-VER-INT-CAJA.
           IF WSS-CMND = 'CAN'
               MOVE 'N'                     TO CAJ-IND-NEGO IN CAJ-CMMA
               MOVE CAZ-SGV-TPAG IN CAZ-FLD TO CAJ-SGV-VNEG IN CAJ-CMMA
               MOVE CAZ-MSC-CANC IN CAZ-FLD TO CAJ-MSC-CANC IN CAJ-CMMA
               MOVE MSC-CIC-CMSC IN MSC     TO CAJ-CIC-TCYA IN CAJ-CMMA
           ELSE
           IF WSS-CMND = 'VPC'
               MOVE SPACES                  TO CAJ-IND-NEGO IN CAJ-CMMA
               MOVE CAZ-SGV-TPAG IN CAZ     TO CAJ-SGV-VNEG IN CAJ-CMMA
               MOVE SPACES                  TO CAJ-MSC-CANC IN CAJ-CMMA
               MOVE SPACES                  TO CAJ-CIC-TCYA IN CAJ-CMMA
           ELSE
               MOVE SPACES                  TO CAJ-IND-NEGO IN CAJ-CMMA
               MOVE ZEROES                  TO CAJ-SGV-VNEG IN CAJ-CMMA
               MOVE SPACES                  TO CAJ-MSC-CANC IN CAJ-CMMA
               MOVE SPACES                  TO CAJ-CIC-TCYA IN CAJ-CMMA.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY                TO CAJ-NUM-DPRO IN CAJ-CMMA.
           MOVE HOY-MHOY                TO CAJ-NUM-MPRO IN CAJ-CMMA.
           MOVE HOY-SHOY                TO CAJ-NUM-SPRO IN CAJ-CMMA.
           MOVE HOY-AHOY                TO CAJ-NUM-APRO IN CAJ-CMMA.
           MOVE FIO-MSFL                TO CAJ-MSFL     IN CAJ-CMMA.
           MOVE SPACES                  TO CAJ-MENS     IN CAJ-CMMA.
           IF WSS-CMND = 'CAN'
               MOVE OPZ-COD-VCOC IN CAZ-FLD TO CAJ-COD-VCOC IN CAJ-CMMA
               MOVE VEZ-NUM-SVEN IN CAZ-FLD TO CAJ-NUM-SVEN IN CAJ-CMMA
               MOVE VEZ-NUM-AVEN IN CAZ-FLD TO CAJ-NUM-AVEN IN CAJ-CMMA
               MOVE VEZ-NUM-MVEN IN CAZ-FLD TO CAJ-NUM-MVEN IN CAJ-CMMA
               MOVE VEZ-NUM-DVEN IN CAZ-FLD TO CAJ-NUM-DVEN IN CAJ-CMMA
           ELSE
               MOVE SPACES                  TO CAJ-COD-VCOC IN CAJ-CMMA
               MOVE ZEROES                  TO CAJ-FEC-FVEN IN CAJ-CMMA.
           MOVE SPACES                  TO CAJ-GLS-DISP IN CAJ-CMMA.
           MOVE CAJ-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
           MOVE 'CBZPPCAJ' TO SYS-PROG.
           MOVE CAJ-TCMA   TO SYS-TCMA.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA   TO CAJ-CMMA.
           MOVE CAJ-MSFL IN CAJ-CMMA TO FIO-MSFL.
       FIN-VER-INT-CAJA.
           EXIT.

       BUS-CIC-TCYA SECTION.
       INI-BUS-CIC-TCYA.
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC.
           MOVE CYZ-IND-TCYA IN CAZ-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
       FIN-BUS-CIC-TCYA.
           EXIT.

       VRF-REV-CRG-AUT SECTION.
       INI-VRF-REV-CRG-AUT.
           IF SCR-MSC-TCAN     = 'C' AND
              SCR-CYA-IND-CCTE = 'S' AND
              SCR-CYA-IND-PAUT = 'S'
               PERFORM SET-PARAMETROS
               PERFORM GEN-CAR-ABN.
       FIN-VRF-REV-CRG-AUT.
           EXIT.

       COPY CBZBGMUF.

       SET-STTR-RCZ SECTION.
       INI-SET-STTR-RCZ.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-CMND = 'REV'
               MOVE CAZ-CAI-IOPC IN CAZ-BKP TO RCZ-CAI-IOPC IN RCZ
               MOVE CAZ-IIC-IOPC IN CAZ-BKP TO RCZ-IIC-IOPC IN RCZ
               MOVE CAZ-NUM-ICAN IN CAZ-BKP TO RCZ-NUM-ICAN IN RCZ
               MOVE CAZ-CAI-IOPC IN CAZ-BKP TO RCZ-CAI-IOPV IN RCZ
               MOVE CAZ-IIC-IOPC IN CAZ-BKP TO RCZ-IIC-IOPV IN RCZ
               MOVE VEZ-NUM-IVCT IN CAZ-FLD TO RCZ-NUM-IVCT IN RCZ
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM CBZ-FIO-RCZ
               IF FIO-STAT-OKS
                   MOVE 'R' TO RCZ-MSC-STAT IN RCZ
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM CBZ-FIO-RCZ.
       FIN-SET-STTR-RCZ.
           EXIT.
       ACT-VEZ-SHFT-REV-TT SECTION.
       INI-ACT-VEZ-SHFT-REV-TT.
           MOVE OPZ-CIC-IOPC IN OPZ TO VEZ-CIC-IOPC IN VEZ.
           MOVE 2                   TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    VEZ-CIC-IOPC IN VEZ = OPZ-CIC-IOPC IN OPZ AND
                    VEZ-NUM-IVEN IN VEZ = 2 )
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-VEZ-SHFT-REV-TT.
       LUP-ACT-VEZ-SHFT-REV-TT.
           IF NOT ( ( VEZ-VAL-CAPI IN VEZ     > ZEROES AND
                      VEZ-VAL-SCAP IN VEZ NOT > ZEROES ) OR
                    ( VEZ-VAL-FINA IN VEZ     > ZEROES AND
                      VEZ-VAL-SFIN IN VEZ NOT > ZEROES ) )
               GO TO NXT-ACT-VEZ-SHFT-REV-TT.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZSHFTNOUPD' TO MSG-COD-MENS
               GO TO FIN-ACT-VEZ-SHFT-REV-TT.

           IF ( VEZ-VAL-CAPI IN VEZ     > ZEROES AND
                VEZ-VAL-SCAP IN VEZ NOT > ZEROES )
               MOVE VEZ-VAL-CAPI IN VEZ TO VEZ-VAL-SCAP IN VEZ.
           IF ( VEZ-VAL-FINA IN VEZ     > ZEROES AND
                VEZ-VAL-SFIN IN VEZ NOT > ZEROES )
               MOVE VEZ-VAL-FINA IN VEZ TO VEZ-VAL-SFIN IN VEZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZSHFTNOMOD' TO MSG-COD-MENS
               GO TO FIN-ACT-VEZ-SHFT-REV-TT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-VEZ-SHFT-REV-TT.
       NXT-ACT-VEZ-SHFT-REV-TT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = VEZ-CIC-IOPC IN VEZ )
               GO TO FIN-ACT-VEZ-SHFT-REV-TT.
           GO TO LUP-ACT-VEZ-SHFT-REV-TT.
       FIN-ACT-VEZ-SHFT-REV-TT.
           EXIT.

       ADO-CAZ SECTION.
       INI-ADO-CAZ.
           MOVE SPACES TO ADO-GLS-MENS.
           IF ADO-IND-ORIG = 'S'
               PERFORM ADO-SAFE
               IF ADO-GLS-MENS > SPACES
                   MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ
                   MOVE RCZ-NUM-ICAN IN RCZ TO CAZ-NUM-ICAN IN CAZ
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM CBZ-FIO-CAZ
                   PERFORM GET-FHOY
                   MOVE HOY-DHOY IN HOY-VARI TO SYS-DHOY IN SYS-VARI
                   MOVE HOY-MHOY IN HOY-VARI TO SYS-MHOY IN SYS-VARI
                   MOVE HOY-AHOY IN HOY-VARI TO SYS-AHOY IN SYS-VARI
                   MOVE HOY-SHOY IN HOY-VARI TO SYS-SHOY IN SYS-VARI
                   MOVE HOY-HHOY IN HOY-VARI TO SYS-HHOY IN SYS-VARI
                   PERFORM BUS-COR-ERR
                   MOVE MSG-COD-MENS TO ERR-COD-MENS IN ERR
                   MOVE 'CBZPOCAZ'   TO ERR-COD-ATRN IN ERR
                   MOVE ERR-SVRT-FAT TO ERR-IND-SVRT IN ERR
                   MOVE ERR-TERR-VLD TO ERR-COD-TERR IN ERR
                   MOVE ADR-CAZ-REQA TO ADR-REQA
                   MOVE FRM-MEN2     TO ERR-GLS-ANEX IN ERR
                   PERFORM PRO-IER
               ELSE
                   NEXT SENTENCE
           ELSE
           IF ADO-MSC-TCAN = ADO-MSC-MOPC
               MOVE ADO-KEY-ICAN TO CAZ-KEY-ICAN IN CAZ
               PERFORM CAZ-ROZ-CAZ
           ELSE
           IF ADO-MSC-TCAN = ADO-MSC-MCAN
               PERFORM ADO-CAZ-MCAN.
       FIN-ADO-CAZ.
           EXIT.

       PUT-STAT-CAZ SECTION.
       INI-PUT-STAT-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
           MOVE 'CBZ'               TO TAB-COD-SIST.
           MOVE 'CNC'               TO TAB-COD-TTAB IN TAB.
           MOVE CAZ-MSC-CANC IN CAZ TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CCNC.
           MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC.
           MOVE CAZ-STP-ITRN IN CAZ TO SCR-UMOD.
           PERFORM CMN-ACC.
           IF CAZ-MSC-STAT IN CAZ = 'A' OR
              ( CAZ-MSC-STAT IN CAZ = 'S' AND ADO-IND-ORIG = 'O' ) OR
              ( CAZ-MSC-STAT IN CAZ = 'C' AND ADO-IND-ORIG = 'S' ) OR
              ( CAZ-MSC-STAT IN CAZ = 'G' AND ADO-IND-ORIG = 'O' )
               MOVE SPACES TO ADO-GLS-MENS
           ELSE
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS.
       FIN-PUT-STAT-CAZ.
           EXIT.
       CAZ-ROZ-CAZ SECTION.
       INI-CAZ-ROZ-CAZ.
           MOVE ZEROES TO VEZ-NUM-IVEN IN VEZ VEZ-NUM-IVCT IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
           PERFORM PUT-CAZ-CAZ.
           PERFORM BUS-VEZ-ADO.
           IF ADO-GLS-MENS > SPACES
               GO TO FIN-CAZ-ROZ-CAZ.
           PERFORM PUT-STAT-CAZ.
       FIN-CAZ-ROZ-CAZ.
           EXIT.
       ADO-CAZ-MCAN SECTION.
       INI-ADO-CAZ-MCAN.
           MOVE ADO-KEY-IOPC TO ROZ-CIC-IOPC IN ROZ.
           MOVE LOW-VALUES TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-ADO-CAZ-MCAN.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              ADO-KEY-IOPC = ROZ-CIC-IOPC IN ROZ
                MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ
                PERFORM CAZ-ROZ-CAZ
                IF ADO-GLS-MENS > SPACES
                    GO TO FIN-ADO-CAZ-MCAN
                ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-ADO-CAZ-MCAN.
       FIN-ADO-CAZ-MCAN.
           EXIT.
       BUS-VEZ-ADO SECTION.
       INI-BUS-VEZ-ADO.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO VEZ-CIC-IOPC IN VEZ
           MOVE OPZ-NUM-IVEN IN OPZ TO VEZ-NUM-IVEN IN VEZ
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM CBZ-FIO-VEZ.
           IF FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-VEZ
               PERFORM PUT-VEZ-CAZ
               MOVE OPZ-NUM-IVEN IN OPZ TO VEZ-NUM-IVCT IN CAZ-FLD
           ELSE
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZIVEZNEX  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS
               GO TO FIN-BUS-VEZ-ADO.
           MOVE VEZ-NUM-IVEN IN VEZ TO SCR-VEN-NUM-IVEN.
       FIN-BUS-VEZ-ADO.
           EXIT.

       BUS-VEZ-ADO-SAFE SECTION.
       INI-BUS-VEZ-ADO-SAFE.
           MOVE WSS-ADO-NUM-IVCT TO VEZ-NUM-IVEN IN VEZ.
           MOVE WSS-ADO-NUM-IVCT TO VEZ-NUM-IVEN IN CAZ-FLD.
           MOVE VEZ-NUM-IVEN IN VEZ TO SCR-VEN-NUM-IVEN.
       FIN-BUS-VEZ-ADO-SAFE.
           EXIT.

       ADO-SAFE SECTION.
       INI-ADO-SAFE.
           IF SCR-CMND = 'REV'
               PERFORM ADO-SAFE-REV
           ELSE
               PERFORM ADO-SAFE-CAZ.
       FIN-ADO-SAFE.
           EXIT.

       ADO-SAFE-CAZ SECTION.
       INI-ADO-SAFE-CAZ.
           PERFORM OBT-MON-CAZ.
           IF ADO-GLS-MENS > SPACES
               GO TO FIN-ADO-SAFE-CAZ.
           IF WSS-ADO-NUM-IVCT = ZEROES
               MOVE 1 TO WSS-ADO-NUM-IVCT.
       LUP-ADO-SAFE-CAZ.
           MOVE ADO-KEY-IOPC TO RCZ-CIC-IOPV IN RCZ.
           MOVE WSS-ADO-NUM-IVCT TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       ADO-SAFE-NXT-RCZ.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           PERFORM CBZ-FIO-RCZ.
           IF FIO-STAT-OKS AND
              ADO-KEY-IOPC = RCZ-CIC-IOPV IN RCZ AND
              WSS-ADO-NUM-IVCT = RCZ-NUM-IVCT IN RCZ
               MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ
               MOVE RCZ-NUM-ICAN IN RCZ TO CAZ-NUM-ICAN IN CAZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               IF FIO-STAT-OKS
                   IF CAZ-MSC-STAT IN CAZ = 'S' OR 'W'
                       MOVE FIO-STAT TO PGM-STAT-CAZ
                       PERFORM PUT-CAZ-CAZ
                       PERFORM BUS-VEZ-ADO-SAFE
                       PERFORM PUT-CYZ-SAF
                       PERFORM PUT-STAT-CAZ
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO ADO-SAFE-NXT-RCZ
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CAZSAFECAZNF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO ADO-GLS-MENS
                   GO TO FIN-ADO-SAFE-CAZ
           ELSE
               MOVE ADO-KEY-IOPC TO RCZ-CIC-IOPV IN RCZ
               MOVE ZEROES       TO RCZ-NUM-IVCT IN RCZ
               MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM CBZ-FIO-RCZ
               IF FIO-STAT-OKS
                   MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ
                   MOVE RCZ-NUM-ICAN IN RCZ TO CAZ-NUM-ICAN IN CAZ
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM CBZ-FIO-CAZ
                   IF FIO-STAT-OKS AND
                      CAZ-MSC-STAT IN CAZ = 'S' OR 'W'
                       MOVE FIO-STAT TO PGM-STAT-CAZ
                       PERFORM PUT-CAZ-CAZ
                       PERFORM BUS-VEZ-ADO
                       IF WSS-ADO-NUM-IVCT NOT = VEZ-NUM-IVEN IN VEZ
                           MOVE 'CBZ'          TO MSG-COD-SIST
                           MOVE 'CAZSAFERCZNF' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO ADO-GLS-MENS
                           GO TO FIN-ADO-SAFE-CAZ
                       ELSE
                           PERFORM PUT-CYZ-SAF
                           PERFORM PUT-STAT-CAZ
                           GO TO FIN-ADO-SAFE-CAZ
                   ELSE
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'CAZSAFECAZNF' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO ADO-GLS-MENS
                       GO TO FIN-ADO-SAFE-CAZ
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CAZSAFERCZNF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO ADO-GLS-MENS
                   GO TO FIN-ADO-SAFE-CAZ.
           IF WSS-ADO-NUM-ICAN > 1
               ADD 1 TO WSS-ADO-NUM-IVCT
               IF WSS-ADO-NUM-IVCT NOT > ADO-NUM-IVCT
                   GO TO LUP-ADO-SAFE-CAZ.
       FIN-ADO-SAFE-CAZ.
           EXIT.

       OBT-MON-CAZ SECTION.
       INI-OBT-MON-CAZ.
           MOVE ZEROES       TO WSS-ADO-MAX-IVCT IN WSS-VARI.
           MOVE ZEROES       TO WSS-ADO-NUM-ICAN IN WSS-VARI.
           MOVE ZEROES       TO WSS-ADO-SGV-TPAG IN WSS-VARI.
           IF ADO-NUM-IVCT = ZEROES
               MOVE 1 TO ADO-NUM-IVCT.
           MOVE ADO-NUM-IVCT TO WSS-ADO-NUM-IVCT IN WSS-VARI.
       LUP-OBT-MON-CAZ.
           MOVE ADO-KEY-IOPC                 TO RCZ-CIC-IOPV IN RCZ.
           MOVE WSS-ADO-NUM-IVCT IN WSS-VARI TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-OBT-RCZ-CAZ.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           PERFORM CBZ-FIO-RCZ.
           IF FIO-STAT-OKS AND
              ADO-KEY-IOPC = RCZ-CIC-IOPV IN RCZ AND
              WSS-ADO-NUM-IVCT IN WSS-VARI = RCZ-NUM-IVCT IN RCZ
               MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ
               MOVE RCZ-NUM-ICAN IN RCZ TO CAZ-NUM-ICAN IN CAZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               IF FIO-STAT-OKS 
                   IF CAZ-MSC-STAT IN CAZ = 'S' OR 'W'
                     ADD CAZ-SGV-TPAG IN CAZ TO WSS-ADO-SGV-TPAG
                                                   IN WSS-VARI
                     ADD 1 TO WSS-ADO-NUM-ICAN IN WSS-VARI
                     MOVE WSS-ADO-NUM-IVCT TO WSS-ADO-MAX-IVCT
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO NXT-OBT-RCZ-CAZ
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO NXT-OBT-RCZ-CAZ
           ELSE
               MOVE ADO-KEY-IOPC TO RCZ-CIC-IOPV IN RCZ
               MOVE ZEROES       TO RCZ-NUM-IVCT IN RCZ
               MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM CBZ-FIO-RCZ
               IF FIO-STAT-OKS
                   MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ
                   MOVE RCZ-NUM-ICAN IN RCZ TO CAZ-NUM-ICAN IN CAZ
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM CBZ-FIO-CAZ
                   IF FIO-STAT-OKS AND
                      CAZ-MSC-STAT IN CAZ = 'S' OR 'W'
                       ADD CAZ-SGV-TPAG IN CAZ TO WSS-ADO-SGV-TPAG
                                                       IN WSS-VARI
                       ADD 1 TO WSS-ADO-NUM-ICAN IN WSS-VARI
                       MOVE WSS-ADO-NUM-IVCT TO WSS-ADO-MAX-IVCT
                       GO TO NXT-OBT-MON-CAZ
                   ELSE
                       GO TO NXT-OBT-MON-CAZ
               ELSE
                   GO TO NXT-OBT-MON-CAZ.
           SUBTRACT 1 FROM WSS-ADO-NUM-IVCT IN WSS-VARI.
           GO TO LUP-OBT-MON-CAZ.
       NXT-OBT-MON-CAZ.
           IF ADO-VAL-TPAG NOT = WSS-ADO-SGV-TPAG IN WSS-VARI AND
              WSS-ADO-NUM-ICAN IN WSS-VARI > 1
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZMONSAF>CN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS.
           IF WSS-ADO-NUM-ICAN IN WSS-VARI NOT > ZEROES
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZNEXSAFCAZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS.
           MOVE WSS-ADO-MAX-IVCT TO WSS-ADO-NUM-IVCT .
       FIN-OBT-MON-CAZ.
           EXIT.

       ADO-SAFE-REV SECTION.
       INI-ADO-SAFE-REV.
           PERFORM OBT-MON-REV.
           IF ADO-GLS-MENS > SPACES
               GO TO FIN-ADO-SAFE-REV.
           MOVE ZEROES       TO WSS-ADO-SGV-TPAG IN WSS-VARI.
           MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ.
           MOVE 999 TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-ADO-SAFE-REV.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    ADO-KEY-IOPC  = CAZ-CIC-IOPC IN CAZ )
               GO TO FIN-ADO-SAFE-REV.
           MOVE ADR-CAZ-REQA TO ADR-AUX-REQA.
           IF CAZ-MSC-STAT IN CAZ NOT = 'R' AND
              CAZ-SGV-TPAG IN CAZ NOT < ZEROES AND
              CAZ-SGV-TREN IN CAZ NOT < ZEROES
               IF CAZ-MSC-STAT IN CAZ NOT = 'A'
                   GO TO FIN-ADO-SAFE-REV
               ELSE
                   PERFORM OBT-CIC-CAJA
                   IF FIO-STAT-OKS
                       ADD CAZ-SGV-TPAG IN CAZ TO WSS-ADO-SGV-TPAG
                                                       IN WSS-VARI
                       IF ADO-VAL-TPAG NOT < WSS-ADO-SGV-TPAG
                                                       IN WSS-VARI
                           PERFORM OBT-RCZ-VEZ
                           MOVE '00' TO PGM-STAT-CAZ
                           PERFORM PUT-CAZ-CAZ
                           PERFORM BUS-VEZ-ADO-SAFE
                           PERFORM PUT-STAT-CAZ
                       ELSE
                           GO TO FIN-ADO-SAFE-REV.     
           MOVE ADR-AUX-REQA TO ADR-CAZ-REQA.
           MOVE FIO-KDEF-S  TO FIO-KDEF.
           MOVE FIO-GET-PRV TO FIO-CMND.
           GO TO LUP-ADO-SAFE-REV.
       FIN-ADO-SAFE-REV.
           EXIT.

       OBT-MON-REV SECTION.
       INI-OBT-MON-REV.
           MOVE ZEROES       TO WSS-ADO-NUM-ICAN IN WSS-VARI.
           MOVE ZEROES       TO WSS-ADO-SGV-TPAG IN WSS-VARI.
           MOVE ADO-KEY-IOPC        TO CAZ-CIC-IOPC IN CAZ.
           MOVE 999 TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-OBT-MON-REV.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    ADO-KEY-IOPC  = CAZ-CIC-IOPC IN CAZ )
               GO TO NXT-OBT-MON-REV.
           IF CAZ-MSC-STAT IN CAZ NOT = 'R' AND
              CAZ-SGV-TPAG IN CAZ NOT < ZEROES AND
              CAZ-SGV-TREN IN CAZ NOT < ZEROES
               IF CAZ-MSC-STAT IN CAZ NOT = 'A'
                   GO TO NXT-OBT-MON-REV
               ELSE
                   PERFORM OBT-CIC-CAJA
                   IF FIO-STAT-OKS
                       ADD CAZ-SGV-TPAG IN CAZ TO WSS-ADO-SGV-TPAG
                                                       IN WSS-VARI
                       ADD 1 TO WSS-ADO-NUM-ICAN IN WSS-VARI
                       IF ADO-VAL-TPAG = WSS-ADO-SGV-TPAG IN WSS-VARI
                           GO TO FIN-OBT-MON-REV
                       ELSE
                       IF ADO-VAL-TPAG < WSS-ADO-SGV-TPAG IN WSS-VARI
                           GO TO NXT-OBT-MON-REV.
           MOVE FIO-GET-PRV TO FIO-CMND.
           GO TO LUP-OBT-MON-REV.
       NXT-OBT-MON-REV.
           IF ADO-VAL-TPAG NOT = WSS-ADO-SGV-TPAG IN WSS-VARI AND
              WSS-ADO-NUM-ICAN IN WSS-VARI > 1
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZMONSAF>RV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS.
           IF WSS-ADO-NUM-ICAN IN WSS-VARI NOT > ZEROES
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZNEXSAFREV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ADO-GLS-MENS.
       FIN-OBT-MON-REV.
           EXIT.

       OBT-CIC-CAJA SECTION.
       INI-OBT-CIC-CAJA.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           PERFORM FST-CYZ-CAZ.
       LUP-OBT-CYZ-CAJA.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                               AND
                    CAZ-CIC-IOPC IN CAZ = CYZ-CIC-IOPC IN CYZ  AND
                    CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-OBT-CIC-CAJA.
           MOVE 'TCYA'    TO MSC-CIC-TMSC IN MSC.
           MOVE 'CAJA'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-CIC-CAJA.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-MSC.
           IF NOT (FIO-STAT-OKS AND
              MSC-CIC-CMSC IN MSC = 'CAJA' AND
              MSC-CIC-TMSC IN MSC = 'TCYA' )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-OBT-CIC-CAJA
           ELSE
               IF MSC-COD-CMSC IN MSC = CYZ-IND-TCYA IN CYZ 
                   GO TO FIN-OBT-CIC-CAJA
               ELSE
                   MOVE 'MSC-CIC-TABL' TO FIO-AKEY
                   MOVE FIO-GET-NXT    TO FIO-CMND
                   GO TO LUP-OBT-CIC-CAJA.
           MOVE FIO-GET-NXT TO FIO-CMND.          
           GO TO LUP-OBT-CYZ-CAJA.
       FIN-OBT-CIC-CAJA.
           EXIT.

       OBT-RCZ-VEZ SECTION.
       INI-OBT-RCZ-VEZ.
           MOVE SPACES TO RCZ-KEY-IRCV IN RCZ.
           MOVE CAZ-KEY-ICAN IN CAZ TO RCZ-KEY-ICAN IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    CAZ-KEY-ICAN IN CAZ = RCZ-KEY-ICAN IN RCZ )
               GO TO FIN-OBT-RCZ-VEZ.
           MOVE RCZ-NUM-IVCT IN RCZ TO VEZ-NUM-IVCT IN CAZ-FLD.
           IF RCZ-NUM-IVCT IN RCZ > ZEROES
               MOVE RCZ-NUM-IVCT IN RCZ TO WSS-ADO-NUM-IVCT IN WSS-VARI
               GO TO FIN-OBT-RCZ-VEZ.
           PERFORM BUS-VEZ-ADO.
           MOVE VEZ-NUM-IVEN IN VEZ TO WSS-ADO-NUM-IVCT IN WSS-VARI.
       FIN-OBT-RCZ-VEZ.
           EXIT.

       GET-STAT-ADO SECTION.
       INI-GET-STAT-ADO.
               MOVE 'S' TO WSS-IND-ADO
               IF ADO-CMND = 'REV'
                   MOVE ADO-CMND TO SCR-CMND
               ELSE
                   MOVE 'CAN' TO SCR-CMND.
               MOVE 'CBZ'        TO SCR-SIST
               MOVE 'CBZPMCAN'   TO SCR-PROG
               MOVE FRM-FFLD-RET TO FRM-FFLD
               MOVE FRM-FFLD-RET TO SCR-FFLD
               MOVE ADO-FIDD TO IDD-FSIS IN IDD-VARI
               MOVE SCR-STAT-SON TO SCR-STAT
               MOVE SCR-VFLD-YES TO SCR-VFLD.
       FIN-GET-STAT-ADO.
           EXIT.
       CRG-AUTO SECTION.
       INI-CRG-AUTO.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM FST-CYZ-CAZ.
       CIC-CRG-AUTO.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                                  AND
                    OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
                    CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
                      GO TO FIN-CRG-AUTO.
           IF CYZ-IND-MAUT IN CYZ NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-CRG-AUTO.
           IF CYZ-SGV-LIQU IN CYZ > ZEROES
               MOVE '0670'          TO ICC-COD-TRAN IN ICC
           ELSE
               MOVE '0770'          TO ICC-COD-TRAN IN ICC.
           MOVE '01'                TO ICC-IND-INDI IN ICC.
           MOVE CYZ-CIC-ICYA IN CYZ TO ICC-COD-CCTE IN ICC.
           IF CYZ-SGV-LIQU IN CYZ > ZEROES
               MOVE  '000000000072' TO ICC-COD-SERI IN ICC
           ELSE
               MOVE  '000000000052' TO ICC-COD-SERI IN ICC.
           MOVE ZEROES              TO ICC-SGV-VPE2 IN ICC.
           MOVE CYZ-SGV-LIQU IN CYZ TO ICC-SGV-VPE2 IN ICC.
           MOVE '0'                 TO ICC-IND-TCAM IN ICC.
           MOVE 1                   TO ICC-SGV-VCON IN ICC.
           MOVE OPZ-COD-OFOC IN OPZ TO ICC-COD-OFOC IN ICC.
           MOVE SPACES              TO ICC-COD-UBIC IN ICC.
           MOVE SPACES              TO ICC-COD-ITRE IN ICC.
           MOVE SPACES              TO ICC-GLS-DISP IN ICC.
           MOVE FIO-PUT TO FIO-CMND.
           MOVE 'CBZVSAF' TO FIO-VOID.
           MOVE ICC TO FIO-DFLD.
           MOVE 100 TO FIO-RLEN.
           MOVE '00' TO FIO-STAT.
           IF FIO-STAT-OKS
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-CRG-AUTO
           ELSE
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'SAFECRGERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
        FIN-CRG-AUTO.
           EXIT.
       VRF-CAJA SECTION.
       INI-VRF-CAJA.
           PERFORM FST-CYZ-CAZ.
       CIC-VRF-CAJA.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                                  AND
                    OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
                    CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
                      GO TO FIN-VRF-CAJA.
           MOVE 'TAB'               TO MSC-COD-SIST.
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               IF MSC-CIC-CMSC IN MSC = 'CAJA'
                   GO TO FIN-VRF-CAJA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-VRF-CAJA.
       FIN-VRF-CAJA.
           EXIT.
       INI-CAZ SECTION.
       INI-INI-CAZ.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-SGV-CAPT IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-FINL IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-SEGC IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCVG IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCM IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCO IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-VCCV IN WSS-VARI.
           PERFORM RST-DLZ VARYING WSS-NUM-IDLC FROM 1 BY 1
                             UNTIL WSS-NUM-IDLC > 500.
       FIN-INI-CAZ.
           EXIT.
       RST-DLZ SECTION.
       INI-RST-DLZ.
           MOVE ZEROES TO WSS-SGV-CAPD(WSS-NUM-IDLC)
                          WSS-SGV-FINA(WSS-NUM-IDLC).
       FIN-RST-DLZ.
           EXIT.
       PRO-REV SECTION.
       INI-PRO-REV.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ TO CAZ-BKP.
           MOVE 'R' TO CAZ-MSC-STAT IN CAZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CAZ    REVKO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PRO-REV.
           PERFORM PRO-REV-DLZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO WSS-NUM-ICAN-OLD.
           PERFORM BUS-NEW-CAZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO WSS-NUM-ICAN-NEW.
           MOVE CAZ-BKP TO CAZ.
           SUBTRACT CAZ-SGV-GAST IN CAZ FROM 0 GIVING
                    CAZ-SGV-GAST IN CAZ.
           SUBTRACT CAZ-SGV-TPAG IN CAZ FROM 0 GIVING
                    CAZ-SGV-TPAG IN CAZ.
           SUBTRACT CAZ-SGV-TREN IN CAZ FROM 0 GIVING
                    CAZ-SGV-TREN IN CAZ.
           SUBTRACT CAZ-NUM-TVCC IN CAZ FROM 0 GIVING
                    CAZ-NUM-TVCC IN CAZ.
           SUBTRACT CAZ-SGV-DIFE IN CAZ FROM 0 GIVING
                    CAZ-SGV-DIFE IN CAZ.
           PERFORM PRO-REV-CYZ.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-PRO-REV.
               PERFORM PRO-REV-RCZ.
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-PRO-REV.
           PERFORM PRO-REV-ITZ.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-PRO-REV.
           MOVE 'V' TO CAZ-MSC-STAT IN CAZ.
           MOVE WSS-NUM-ICAN-NEW TO CAZ-NUM-ICAN IN CAZ.
           PERFORM PUT-FHOY.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZNEW REVKO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG
               GO TO FIN-PRO-REV.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZ    REVOK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG-MSG
               MOVE CAZ-KEY-ICAN IN CAZ TO REV-MSG-CAN
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZNEW REVNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG.
       FIN-PRO-REV.
           EXIT.
       PRO-REV-DLZ SECTION.
       INI-PRO-REV-DLZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE ZEROES              TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT (FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = DLZ-CIC-IOPC IN DLZ)
               GO TO FIN-PRO-REV-DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF CAZ-FEC-FDVA IN CAZ > ZEROES
               MOVE CAZ-FEC-FDVA IN CAZ TO DLZ-FEC-FDEV IN DLZ.
           MOVE CAZ-VAL-SINA IN CAZ TO DLZ-VAL-SINT IN DLZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
       FIN-PRO-REV-DLZ.
           EXIT.

       PRO-REV-CYZ SECTION.
       INI-PRO-REV-CYZ.
           MOVE 1                   TO CYZ-NUM-ICYA IN CYZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO CYZ-CIC-IOPC IN CYZ.
       CIC-PRO-REV-CYZ.
           MOVE WSS-NUM-ICAN-OLD    TO CYZ-NUM-ICAN IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = CYZ-CIC-IOPC IN CYZ AND
              WSS-NUM-ICAN-OLD    = CYZ-NUM-ICAN IN CYZ
                 SUBTRACT CYZ-SGV-LIQU IN CYZ FROM 0 GIVING
                          CYZ-SGV-LIQU IN CYZ
                 MOVE WSS-NUM-ICAN-NEW TO CYZ-NUM-ICAN IN CYZ
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM CBZ-FIO-CYZ
                 IF FIO-STAT-OKS
                     ADD 1 TO CYZ-NUM-ICYA IN CYZ
                     GO TO CIC-PRO-REV-CYZ
                 ELSE
                     MOVE 'CBZ' TO MSG-COD-SIST
                     MOVE 'CYZ    REVKO' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-PRO-REV-CYZ.
           EXIT.
       PRO-REV-RCZ SECTION.
       INI-PRO-REV-RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPC IN RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPV IN RCZ.
           IF CAZ-MSC-FCAN IN CAZ = 'T' AND
              CAZ-MSC-ECAN IN CAZ = 'T'
               MOVE ZEROES TO RCZ-NUM-IVCT IN RCZ
           ELSE
               MOVE VEZ-NUM-IVEN IN CAZ-FLD TO RCZ-NUM-IVCT IN RCZ.
           MOVE WSS-NUM-ICAN-OLD TO RCZ-NUM-ICAN IN RCZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-REV-RCZ.
           MOVE WSS-NUM-ICAN-NEW TO RCZ-NUM-ICAN IN RCZ.
               SUBTRACT RCZ-SGV-CAPI IN RCZ FROM 0 GIVING
                        RCZ-SGV-CAPI IN RCZ.
               SUBTRACT RCZ-SGV-FINA IN RCZ FROM 0 GIVING
                        RCZ-SGV-FINA IN RCZ.
               SUBTRACT RCZ-SGV-REAJ IN RCZ FROM 0 GIVING
                        RCZ-SGV-REAJ IN RCZ.
               SUBTRACT RCZ-VAL-SEGC IN RCZ FROM 0 GIVING
                        RCZ-VAL-SEGC IN RCZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'RCZ    REVKO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-PRO-REV-RCZ.
           EXIT.
       PRO-REV-ITZ SECTION.
       INI-PRO-REV-ITZ.
           MOVE 'ITZ-KEY-IICG' TO FIO-AKEY.
           MOVE CAZ-CIC-IOPC IN CAZ     TO ITZ-CIC-IOPC IN ITZ.
           MOVE WSS-NUM-ICAN-OLD        TO ITZ-NUM-ICAN IN ITZ.
           MOVE CAZ-CIC-IOPC IN CAZ     TO ITZ-CIC-IOPV IN ITZ.
           MOVE ZEROES                  TO ITZ-NUM-IVCT IN ITZ.
           MOVE 'INT'                   TO ITZ-IND-TTAS IN ITZ.
           MOVE ZEROES                  TO ITZ-FEC-FINI IN ITZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ITZ.
           IF FIO-STAT-OKS
                MOVE WSS-NUM-ICAN-NEW TO
                     ITZ-NUM-ICAN IN ITZ
                MOVE FIO-PUT TO FIO-CMND
                PERFORM CBZ-FIO-ITZ
                IF NOT FIO-STAT-OKS
                     MOVE 'CBZ' TO MSG-COD-SIST
                     MOVE 'ITZ    REVKO' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-PRO-REV-ITZ.
           EXIT.
       BUS-NEW-CAZ SECTION.
       INI-BUS-NEW-CAZ.
           MOVE 999 TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           ADD 1 TO CAZ-NUM-ICAN IN CAZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO CAZ-NUM-ICAN IN CAZ-FLD.
       FIN-BUS-NEW-CAZ.
           EXIT.
       PUT-FHOY SECTION.
       INI-PUT-FHOY.
           MOVE HOY-DHOY TO CAZ-NUM-DOUT IN CAZ.
           MOVE HOY-MHOY TO CAZ-NUM-MOUT IN CAZ.
           MOVE HOY-SHOY TO CAZ-NUM-SOUT IN CAZ.
           MOVE HOY-AHOY TO CAZ-NUM-AOUT IN CAZ.
           MOVE HOY-STP-ITRN TO CAZ-STP-ITRN IN CAZ.
       FIN-PUT-FHOY.
           EXIT.
       COPY GNSBGCAM.
       COPY CBZBFCYZ.
       COPY CBZBFICZ.
       COPY CBZBFITZ.
       COPY CBZBFOPZ.
       COPY CBZBFCTZ.
       COPY CBZBFDLZ.
       COPY CBZBFRCZ.
       COPY CBZBFROZ.
       COPY CBZBFRTZ.
       COPY CBZBFVEZ.
       COPY CBZBFRDZ.
       COPY CBZBFTOZ.
       COPY SGCBFDBC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY GNSBGCPT.
       COPY TABBVUSR.
       COPY TABBBCVG.
       COPY CBZBGCLI.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY CBZBFRZE.
       COPY CBZBGINT.
       COPY GNSBGCVI.
       COPY CBZBFPIZ.
       COPY CBZBGMVO.
       COPY CBZBGTCT.
       COPY CBZBGVDA.
       COPY GNSBGPES.
       COPY CBZB3CAN.
       COPY CBZB4CAN.
       COPY CBZB5CAN.
       COPY GNSBGIER.
       COPY GNSBFERR.
       COPY GNSBPFEC.
       ANL-KEY-ROZ SECTION.
       INI-ANL-KEY-ROZ.
           IF NOT ( SCR-MSC-TCAN = 'N' OR 'P' OR 'R' )
               GO TO FIN-ANL-KEY-ROZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ANL-KEY-ROZ.
           MOVE ROZ-CIC-IOPC IN ROZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'ROZIOPZELI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-ROZ.
       FIN-ANL-KEY-ROZ.
           EXIT.
       ALG-C1 SECTION.
       INI-ALG-C1.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-REV
               GO TO FIN-ALG-C1.
           MOVE ROZ-CIC-IOPC IN ROZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'ROZIOPZELI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ALG-C1.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           PERFORM PRO-REV.
       FIN-ALG-C1.
           EXIT.
       ALG-A1 SECTION.
       INI-ALG-A1.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE 'A' TO WSS-IND-ALG IN WSS-VARI.
           MOVE CAZ-CIC-IOPC IN CAZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE ZEROES              TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           MOVE CAZ-CAI-IOPC IN CAZ TO RZE-CAI-IOPC IN RZE.
           MOVE CAZ-IIC-IOPC IN CAZ TO RZE-IIC-IOPC IN RZE.
           MOVE DLZ-NUM-IDLC IN DLZ TO RZE-NUM-IDLC IN RZE.
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM CBZ-FIO-RZE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ALG-A1
           ELSE
               MOVE RZE-KEY-SAFE IN RZE TO BCD-DAT6-EBCD IN BCD-VARI.
       FIN-ALG-A1.
           EXIT.
       ALG-M1 SECTION.
       INI-ALG-M1.
           IF ADO-IND-ORIG = 'S' AND
              ADO-CMND = 'REV'
               PERFORM PRO-REV
           ELSE
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'REVSOLODSAFE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-ALG-M1.
           EXIT.
       ALG-M2 SECTION.
       INI-ALG-M2.
           MOVE 'CBZ' TO MSG-COD-SIST.
           MOVE 'ANUOPZCREOPZ' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-ALG-M2.
           EXIT.
       ALG-C2 SECTION.
       INI-ALG-C2.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               PERFORM PRO-REV
               GO TO FIN-ALG-C2.
           MOVE ROZ-CIC-IOPC IN ROZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'ROZIOPZELI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ALG-C2.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           PERFORM PRO-REV.
       FIN-ALG-C2.
           EXIT.
       ALG-A1-C1 SECTION.
       INI-ALG-A1-C1.
           PERFORM ALG-A1.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-ALG-A1-C1.
           PERFORM ALG-C1.
       FIN-ALG-A1-C1.
           EXIT.
       PRO-REV-1 SECTION.
       INI-PRO-REV-1.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ TO CAZ-BKP.
           MOVE 'R' TO CAZ-MSC-STAT IN CAZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZ    REVKO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PRO-REV-1.
           MOVE CAZ-NUM-ICAN IN CAZ TO WSS-NUM-ICAN-OLD.
           PERFORM BUS-NEW-CAZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO WSS-NUM-ICAN-NEW.
           MOVE CAZ-BKP TO CAZ.
           MOVE 'V' TO CAZ-MSC-STAT IN CAZ.
           MOVE 'CIE' TO CAZ-MSC-CANC IN CAZ.
           MOVE WSS-NUM-ICAN-NEW TO CAZ-NUM-ICAN IN CAZ.
           PERFORM PUT-FHOY.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZNEW REVKO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG
               GO TO FIN-PRO-REV-1.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZ    REVOK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG-MSG
               MOVE CAZ-KEY-ICAN IN CAZ TO REV-MSG-CAN
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZNEW REVNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG.
       FIN-PRO-REV-1.
           EXIT.
       BUS-IND-SFCR SECTION.
       INI-BUS-IND-SFCR.
           IF CAZ-FEC-FOUT IN CAZ NOT = HOY-FHOY
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZFOUTRVINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-BUS-IND-SFCR.
           PERFORM GET-OPZ.
           MOVE 'N' TO WSS-IND-RNOV IN WSS-VARI.
           MOVE 'N' TO WSS-IND-SAFE IN WSS-VARI.
           MOVE 'N' TO WSS-IND-CTCT IN WSS-VARI.
           MOVE CAZ-CIC-IOPC IN CAZ TO ROZ-CIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ROZ-NUM-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS
               MOVE 'S' TO WSS-IND-RNOV IN WSS-VARI.
           PERFORM VRF-CAJA-CC.
           PERFORM PRO-REV-CAZ.
       FIN-BUS-IND-SFCR.
            EXIT.
       VRF-CAJA-CC SECTION.
       INI-VRF-CAJA-CC.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           PERFORM FST-CYZ-CAZ.
       CIC-VRF-CAJA-CC.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                                  AND
                     OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
                     CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
                      GO TO FIN-VRF-CAJA-CC.
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               IF MSC-CIC-CMSC IN MSC = 'CAJA' AND
                  WSS-IND-SAFE IN WSS-VARI = 'N'
                   MOVE 'S' TO WSS-IND-SAFE
               ELSE
                   IF MSC-CIC-CMSC IN MSC = 'CC' AND
                      WSS-IND-CTCT IN WSS-VARI = 'N'
                       MOVE 'S' TO WSS-IND-CTCT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-VRF-CAJA-CC.
       FIN-VRF-CAJA-CC.
           EXIT.
       PRO-REV-CAZ SECTION.
       INI-PRO-REV-CAZ.
           IF CAZ-MSC-STAT IN CAZ = 'A' AND
              (( CAZ-MSC-FCAN IN CAZ = 'T' AND
                 CAZ-MSC-ECAN IN CAZ = 'T' ) OR
               ( CAZ-MSC-FCAN IN CAZ = 'T' AND
                 CAZ-MSC-ECAN IN CAZ = 'E' AND
                 OPZ-NUM-VCOR IN OPZ = 1 ))
               PERFORM ANL-KEY-ROZ
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-PRO-REV-CAZ
               ELSE
                   PERFORM REV-RCZ-REG
                   GO TO FIN-PRO-REV-CAZ.
           IF WSS-IND-SAFE = 'S' AND
              WSS-IND-RNOV = 'N' AND
              WSS-IND-CTCT = 'N'
               IF CAZ-MSC-STAT IN CAZ = 'S'
                   PERFORM ALG-A1
                   IF MSG-COD-MENS NOT > SPACES
                       PERFORM PRO-REV
                   ELSE
                       NEXT SENTENCE
               ELSE
                   PERFORM ALG-M1
           ELSE
           IF WSS-IND-SAFE = 'N' AND
              WSS-IND-RNOV = 'N' AND
              WSS-IND-CTCT = 'S'
               PERFORM PRO-REV
           ELSE
           IF WSS-IND-SAFE = 'N' AND
              WSS-IND-RNOV = 'S' AND
              WSS-IND-CTCT = 'N'
               IF CAZ-MSC-STAT IN CAZ = 'C'
                   PERFORM ALG-C1
               ELSE
                   PERFORM ALG-M2
           ELSE
           IF WSS-IND-SAFE = 'S' AND
              WSS-IND-RNOV = 'N' AND
              WSS-IND-CTCT = 'S'
               IF CAZ-MSC-STAT IN CAZ = 'S'
                   PERFORM ALG-A1
                   IF MSG-COD-MENS NOT > SPACES
                       PERFORM PRO-REV
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'A'
                   PERFORM ALG-M1
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-IND-SAFE = 'S' AND
              WSS-IND-RNOV = 'S' AND
              WSS-IND-CTCT = 'N'
               IF CAZ-MSC-STAT IN CAZ = 'W'
                   PERFORM ALG-A1-C1
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'A' OR
                  CAZ-MSC-STAT IN CAZ = 'S'
                   PERFORM ALG-M2
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'C'
                   PERFORM ALG-M1
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-IND-SAFE = 'S' AND
              WSS-IND-RNOV = 'S' AND
              WSS-IND-CTCT = 'S'
               IF CAZ-MSC-STAT IN CAZ = 'W'
                   PERFORM ALG-A1-C1
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'A' OR
                  CAZ-MSC-STAT IN CAZ = 'S'
                   PERFORM ALG-M2
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'C'
                   PERFORM ALG-C2
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-IND-SAFE = 'N' AND
              WSS-IND-RNOV = 'S' AND
              WSS-IND-CTCT = 'S'
               IF CAZ-MSC-STAT IN CAZ = 'C'
                   PERFORM ALG-C1
               ELSE
               IF CAZ-MSC-STAT IN CAZ = 'A'
                   PERFORM ALG-M2
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM PRO-REV.
       FIN-PRO-REV-CAZ.
           EXIT.
       REV-RCZ-REG SECTION.
       INI-REV-RCZ-REG.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE OPZ-COD-TOOC IN OPZ TO TOZ-COD-TOCR IN TOZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-TOZ.
           MOVE OPZ-VAL-SCRE IN OPZ TO WSS-VAL-OCRE IN WSS-VARI.
           MOVE OPZ-NUM-VCVG IN OPZ TO WSS-NUM-VCVG IN WSS-VARI.
           PERFORM INI-DLZ-TT VARYING WSS-NUM-IDLC FROM 1 BY 1
                             UNTIL WSS-NUM-IDLC > 499.
           PERFORM ANL-KEY-RCZ.
           MOVE OPZ-NUM-IVEN IN OPZ TO VEZ-NUM-IVEN IN VEZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO VEZ-CIC-IOPC IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
       LUP-REV-RCZ-REG.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
               CAZ-CIC-IOPC IN CAZ = VEZ-CIC-IOPC IN VEZ)
               GO TO OUT-REV-RCZ-REG.
           IF OPZ-NUM-IVEN IN OPZ NOT = VEZ-NUM-IVEN IN VEZ
               MOVE ZEROES TO WSS-SGV-CAPT IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-FINL IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-SEGC IN WSS-VARI.
           ADD 1 TO WSS-NUM-VCVG IN WSS-VARI.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO RCZ-NUM-ICAN IN RCZ.
           MOVE VEZ-CIC-IOPC IN VEZ TO RCZ-CIC-IOPV IN RCZ.
           MOVE VEZ-NUM-IVEN IN VEZ TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           MOVE FIO-STAT TO PGM-STAT-RCZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF PGM-STAT-RCZ-OKS
               MOVE RCZ-SGV-CAPI IN RCZ TO VEZ-VAL-SCAP IN VEZ
               MOVE RCZ-SGV-FINA IN RCZ TO VEZ-VAL-SFIN IN VEZ
               MOVE RCZ-VAL-SEGC IN RCZ TO VEZ-VAL-SSEG IN VEZ
           ELSE
               MOVE VEZ-VAL-CAPI IN VEZ TO VEZ-VAL-SCAP IN VEZ
               MOVE VEZ-VAL-FINA IN VEZ TO VEZ-VAL-SFIN IN VEZ
               MOVE VEZ-VAL-SEGC IN VEZ TO VEZ-VAL-SSEG IN VEZ
               SUBTRACT WSS-SGV-CAPT IN WSS-VARI FROM
                                           VEZ-VAL-SCAP IN VEZ
               SUBTRACT WSS-SGV-FINL IN WSS-VARI FROM
                                           VEZ-VAL-SFIN IN VEZ
               SUBTRACT WSS-SGV-SEGC IN WSS-VARI FROM
                                           VEZ-VAL-SSEG IN VEZ.
           ADD VEZ-VAL-SFIN IN VEZ TO WSS-VAL-SDLC IN
                                 WSS-VARI(VEZ-NUM-IDLC IN VEZ).
           ADD VEZ-VAL-SFIN IN VEZ TO WSS-VAL-OCRE.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-REV-RCZ-REG.
       OUT-REV-RCZ-REG.
           PERFORM REV-OPZ-TT.
           PERFORM REV-DLZ-TT VARYING WSS-NUM-IDLC FROM 1 BY 1 UNTIL
                             WSS-NUM-IDLC > 499.
           PERFORM PRO-REV.
           MOVE 'A' TO CAZ-MSC-STAT IN CAZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZ    REVOK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG-MSG
               MOVE CAZ-KEY-ICAN IN CAZ TO REV-MSG-CAN
               MOVE REV-MSG TO FRM-MENS
           ELSE
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CAZNEW REVNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO REV-MSG
               MOVE REV-MSG TO FRM-MENS.
       FIN-REV-RCZ-REG.
           EXIT.

       OBT-RCZ-ZNRE SECTION.
       INI-OBT-RCZ-ZNRE.
           MOVE CAZ TO CAZ-BKP.
           MOVE VEZ-CIC-IOPC IN VEZ TO RCZ-CIC-IOPV IN RCZ.
           MOVE ZEROES              TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-RCZ-ZNRE.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    RCZ-CIC-IOPV IN RCZ = VEZ-CIC-IOPC IN VEZ AND
                    RCZ-NUM-IVCT IN RCZ = ZEROES )
               MOVE '23' TO FIO-STAT
               MOVE CAZ-BKP TO CAZ
               GO TO FIN-OBT-RCZ-ZNRE.
           MOVE RCZ-KEY-ICAN TO CAZ-KEY-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF CAZ-MSC-STAT IN CAZ NOT = 'R' AND
              CAZ-SGV-TPAG IN CAZ NOT < ZEROES AND
              CAZ-SGV-TREN IN CAZ NOT < ZEROES
               MOVE CAZ-CAI-IOPC IN CAZ-FLD TO CAZ-CAI-IOPC IN CAZ
               MOVE CAZ-IIC-IOPC IN CAZ-FLD TO CAZ-IIC-IOPC IN CAZ
               MOVE CAZ-NUM-ICAN IN CAZ-FLD TO CAZ-NUM-ICAN IN CAZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               GO TO FIN-OBT-RCZ-ZNRE.
           MOVE FIO-GET-NXT TO FIO-CMND
           GO TO LUP-OBT-RCZ-ZNRE.
       FIN-OBT-RCZ-ZNRE.
           EXIT.

       INI-DLZ-TT SECTION.
       INI-INI-DLZ-TT.
           MOVE ZEROES TO WSS-VAL-SDLC(WSS-NUM-IDLC).
       FIN-INI-DLZ-TT.
           EXIT.
       REV-OPZ-TT SECTION.
       INI-REV-OPZ-TT.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE WSS-NUM-VCVG IN WSS-VARI TO OPZ-NUM-VCVG IN OPZ.
           MOVE WSS-VAL-OCRE TO OPZ-VAL-SCRE IN OPZ.
           IF OPZ-NUM-TVCC IN OPZ > ZEROES
               SUBTRACT CAZ-NUM-TVCC IN CAZ FROM OPZ-NUM-TVCC IN OPZ
           ELSE
               SUBTRACT CAZ-NUM-TVCC IN CAZ FROM OPZ-NUM-VCCO IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
       FIN-REV-OPZ-TT.
           EXIT.
       REV-DLZ-TT SECTION.
       INI-REV-DLZ-TT.
           MOVE CAZ-CIC-IOPC IN CAZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE WSS-NUM-IDLC        TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC
               GO TO FIN-REV-DLZ-TT.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           MOVE WSS-VAL-SDLC(WSS-NUM-IDLC) TO DLZ-VAL-SDLC IN DLZ.
           IF CAZ-FEC-FDVA IN CAZ > ZEROES
               MOVE CAZ-FEC-FDVA IN CAZ TO DLZ-FEC-FDEV IN DLZ.
           MOVE CAZ-VAL-SINA IN CAZ TO DLZ-VAL-SINT IN DLZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
       FIN-REV-DLZ-TT.
           EXIT.

       BUS-COR-ERR SECTION.
       INI-BUS-COR-ERR.
           MOVE 'CBZPOCAZ'           TO ERR-COD-PRGM IN ERR.
           MOVE SYS-SHOY IN SYS-VARI TO ERR-NUM-SEJE IN ERR.
           MOVE SYS-AHOY IN SYS-VARI TO ERR-NUM-AEJE IN ERR.
           MOVE SYS-MHOY IN SYS-VARI TO ERR-NUM-MEJE IN ERR.
           MOVE SYS-DHOY IN SYS-VARI TO ERR-NUM-DEJE IN ERR.
           MOVE 99                   TO ERR-NUM-CEJE IN ERR.
           MOVE 9999                 TO ERR-NUM-CERR IN ERR.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GNS-FIO-ERR.
           IF NOT ( FIO-STAT-OKS                                AND
                    ERR-COD-PRGM IN ERR  = 'CBZPOCAZ'           AND
                    SYS-SHOY IN SYS-VARI =  ERR-NUM-SEJE IN ERR AND
                    SYS-AHOY IN SYS-VARI =  ERR-NUM-AEJE IN ERR AND
                    SYS-MHOY IN SYS-VARI =  ERR-NUM-MEJE IN ERR AND
                    SYS-DHOY IN SYS-VARI =  ERR-NUM-DEJE IN ERR )
               MOVE SYS-SHOY IN SYS-VARI TO ERR-NUM-SEJE IN ERR
               MOVE SYS-AHOY IN SYS-VARI TO ERR-NUM-AEJE IN ERR
               MOVE SYS-MHOY IN SYS-VARI TO ERR-NUM-MEJE IN ERR
               MOVE SYS-DHOY IN SYS-VARI TO ERR-NUM-DEJE IN ERR
               MOVE 1                    TO ERR-NUM-CEJE IN ERR
               MOVE 1                    TO ERR-NUM-CERR IN ERR
               MOVE 'CBZPOCAZ'           TO ERR-COD-PRGM IN ERR
               GO TO FIN-BUS-COR-ERR.
           ADD 1 TO ERR-NUM-CERR IN ERR.
       FIN-BUS-COR-ERR.
           EXIT.


       SET-PRM-VSN SECTION.
       INI-SET-PRM-VSN.
           MOVE ADO-FIDD TO IDD-FSIS IN IDD-VARI.
       FIN-SET-PRM-VSN.
           EXIT.

       ANL-KEY-RCZ SECTION.
       INI-ANL-KEY-RCZ.
           MOVE ZEROES TO WSS-SGV-CAPT IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-FINL IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-SEGC IN WSS-VARI.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPV IN RCZ.
           MOVE OPZ-NUM-IVEN IN OPZ TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ANL-KEY-RCZ.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           PERFORM CBZ-FIO-RCZ.
           IF NOT (FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = RCZ-CIC-IOPV IN RCZ AND
              RCZ-NUM-IVCT IN RCZ = OPZ-NUM-IVEN IN OPZ )
               GO TO FIN-ANL-KEY-RCZ.
           IF CAZ-NUM-ICAN IN CAZ NOT = RCZ-NUM-ICAN IN RCZ
               ADD RCZ-SGV-CAPI IN RCZ TO WSS-SGV-CAPT IN WSS-VARI
               ADD RCZ-SGV-FINA IN RCZ TO WSS-SGV-FINL IN WSS-VARI
               ADD RCZ-VAL-SEGC IN RCZ TO WSS-SGV-SEGC IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ANL-KEY-RCZ.
       FIN-ANL-KEY-RCZ.
           EXIT.

       PUT-CYZ-SAF SECTION.
       INI-PUT-CYZ-SAF.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           PERFORM FST-CYZ-CAZ.
       LUP-PUT-CYZ-SAF.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS                              AND
                    CAZ-CIC-IOPC IN CAZ = CYZ-CIC-IOPC IN CYZ AND
                    CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
                      GO TO FIN-PUT-CYZ-SAF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           MOVE 'TCYA'    TO MSC-CIC-TMSC IN MSC.
           MOVE 'CAJA'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-CAJA.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-MSC.
           IF NOT ( FIO-STAT-OKS AND
                    MSC-CIC-CMSC IN MSC = 'CAJA' AND
                    MSC-CIC-TMSC IN MSC = 'TCYA' )
               GO TO FIN-PUT-CYZ-SAF
           ELSE
               MOVE MSC-GLS-DAT1 IN MSC TO WSS-GLS-DATI IN WSS-VARI
               IF WSS-IND-CSAF IN WSS-VARI = ADO-ET21 AND
                  ADO-ET21 > SPACES
                   MOVE MSC-COD-CMSC IN MSC TO CYZ-IND-TCYA IN CYZ 
               ELSE
                   MOVE 'MSC-CIC-TABL' TO FIO-AKEY
                   MOVE FIO-GET-NXT    TO FIO-CMND
                   GO TO LUP-BUS-CAJA.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           MOVE FIO-GET-NXT TO FIO-CMND.          
           GO TO LUP-PUT-CYZ-SAF.
       FIN-PUT-CYZ-SAF.
           EXIT.
       SET-PARAMETROS SECTION.
       INI-SET-PARAMETROS.
           MOVE 'C'                     TO MVO-COD-ORIG.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO MVO-CAI-IOPC.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO MVO-IIC-IOPC.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO MVO-NUM-ICAN.
           IF SCR-CMND = 'REV'
               MOVE WSS-CAN-NUM-ICAN TO MVO-NUM-ICAN
               MOVE 'EXT' TO MVO-ACCI
           ELSE
               MOVE SPACES TO MVO-ACCI.
           MOVE OPZ-COD-VCOC IN CAZ-FLD TO MVO-COD-VCOC.       
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO MVO-NUM-DMOV.       
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO MVO-NUM-MMOV.       
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO MVO-NUM-SMOV.       
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO MVO-NUM-AMOV.       
           MOVE SPACES                  TO MVO-OPEC.       
           MOVE SPACE                   TO WSS-IND-CRUZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO WSS-CAI.
           IF WSS-CAI-OFI = CAZ-COD-OFCA IN CAZ-FLD
               GO TO FIN-SET-PARAMETROS
           ELSE
               MOVE CAZ-COD-OFCA IN CAZ-FLD TO OFI-COD-OFIC IN OFI
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-OFI
               IF OFI-CIC-OFIC IN OFI = WSS-CAI-OFI
                   GO TO FIN-SET-PARAMETROS
               ELSE
                   MOVE OFI-CIC-OFIC IN OFI     TO WSS-CIC-OFIC
                   MOVE WSS-CAI-OFI             TO OFI-COD-OFIC IN OFI
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-OFI
                   IF OFI-CIC-OFIC IN OFI = WSS-CIC-OFIC
                       GO TO FIN-SET-PARAMETROS
                   ELSE
                       IF OFI-CIC-OFIC IN OFI = CAZ-COD-OFCA IN CAZ-FLD
                           GO TO FIN-SET-PARAMETROS
                       ELSE
                           MOVE 'S'   TO WSS-IND-CRUZ.
       FIN-SET-PARAMETROS.
           EXIT.
       EMI-MSG SECTION.
       INI-EMI-MSG.
           IF PGM-STAT-CAZ-OKS
               MOVE 'CBZ'            TO MSG-COD-SIST
               MOVE MVO-ABNO         TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
               IF CAZ-MSC-STAT IN CAZ = 'S'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CAZ    SAFOK' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
               ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'G' OR 'H'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    CCTOK' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'C'
                       IF CAZ-MSC-TCAN IN CAZ = 'N'
                           MOVE 'CBZ'          TO MSG-COD-SIST
                           MOVE 'CAZ    NOVYA' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MEN1
                       ELSE
                           IF CAZ-MSC-TCAN IN CAZ = 'R'
                               MOVE 'CBZ'          TO MSG-COD-SIST
                               MOVE 'CAZ    RENYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MEN1
                           ELSE
                               MOVE 'CBZ'          TO MSG-COD-SIST
                               MOVE 'CAZ    PROYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                   IF CAZ-MSC-STAT IN CAZ = 'W' OR 'P'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    ALLYA' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                      PERFORM REV-RTZ
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'CAZ    ACAOK' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MEN1
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CAZ    ACANO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1.
       FIN-EMI-MSG.
           EXIT.
      *>>>>
*% END
