*%! Codigo adicional para archivo
*% IF FIN_RET_RCZ_CAZ
      *<<<< FIN_RET_RCZ_CAZ
           MOVE VEZ-VAL-IMPU IN CAZ-FLD TO RCZ-VAL-IMPU IN RCZ.
      *>>>>
*% END
*% IF FIN_PUT_ALL_CAZ
      *<<<< FIN_PUT_ALL_CAZ
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO ICZ-NUM-ICAN IN ICZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPV IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPV IN ICZ.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
              MOVE ZEROES                  TO ICZ-NUM-IVCT IN ICZ
           ELSE
              MOVE VEZ-NUM-IVEN IN CAZ-FLD TO ICZ-NUM-IVCT IN ICZ.
           MOVE 'GASPCA'                TO ICZ-IND-TTAS IN ICZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO ICZ-NUM-SINI IN ICZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO ICZ-NUM-AINI IN ICZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO ICZ-NUM-MINI IN ICZ.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO ICZ-NUM-DINI IN ICZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF FIO-STAT-OKS
               MOVE 'S' TO  FRM-IND-PORT IN CAZ-FLD
               MOVE ICZ-SGV-MNTO IN ICZ TO FRM-VAL-PORT IN CAZ-FLD.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO ICZ-NUM-ICAN IN ICZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPV IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPV IN ICZ.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
              MOVE ZEROES                  TO ICZ-NUM-IVCT IN ICZ
           ELSE
              MOVE VEZ-NUM-IVEN IN CAZ-FLD TO ICZ-NUM-IVCT IN ICZ.
           MOVE 'COMFLV'                TO ICZ-IND-TTAS IN ICZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO ICZ-NUM-SINI IN ICZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO ICZ-NUM-AINI IN ICZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO ICZ-NUM-MINI IN ICZ.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO ICZ-NUM-DINI IN ICZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF FIO-STAT-OKS
               MOVE ICZ-SGV-TINT IN ICZ TO FRM-SGV-COMI IN CAZ-FLD
           ELSE
              PERFORM LEE-COZ-CAZ-CUR
              IF FIO-STAT-OKS
                 MOVE ICZ-SGV-TINT IN ICZ TO FRM-SGV-COMI IN CAZ-FLD
              ELSE
                 MOVE ZEROES TO FRM-SGV-COMI IN CAZ-FLD.
      *>>>>
*% END
*% IF FIN_PUT_OPZ_CAZ
      *<<<< FIN_PUT_OPZ_CAZ
           IF OPZ-COD-AOOC IN CAZ-FLD > SPACES
               MOVE 'CBZ'                    TO TAB-COD-SIST
               MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
               MOVE OPZ-COD-TOOC IN CAZ-FLD  TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPZ-COD-AOOC IN CAZ-FLD  TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOOC IN CAZ-FLD.
           MOVE OPZ-COD-VCOC IN OPZ TO SCR-COD-VCOC.
      *>>>>
*% END
*% IF FIN_PUT_CAZ_CAZ
      *<<<< FIN_PUT_CAZ_CAZ
           IF CAZ-MSC-STAT IN CAZ-FLD > SPACES
               MOVE 'GNS'                   TO TAB-COD-SIST
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB
               MOVE CAZ-MSC-STAT IN CAZ-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-STAT IN CAZ-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_CAZ
      *<<<< FIN_PUT_DBC_CAZ
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CAZ-FLD.
      *>>>>
*% END
*% IF FIN_PUT_ROZ_CAZ
      *<<<< FIN_PUT_ROZ_CAZ
           MOVE ROZ-CAI-IOPC IN ROZ TO SCR-ROV-CAI-IOPC.
           MOVE ROZ-IIC-IOPC IN ROZ TO SCR-ROV-IIC-IOPC.
      *>>>>
*% END
*% IF FIN_PUT_ICZ_CAZ
      *<<<< FIN_PUT_ICZ_CAZ
           MOVE 'N' TO WSS-IBLK-TINT IN WSS-VARI.
      *>>>>
*% END
*% IF INI_PUT_CYZ_CAZ
      *<<<< INI_PUT_CYZ_CAZ
           IF SCR-CYA-IND-MCYA = 'M'
               MOVE 'M'         TO CYZ-IND-TCYA IN CAZ-FLD
               MOVE SPACES      TO CYZ-CAI-ICYA IN CAZ-FLD
               MOVE ZEROES      TO CYZ-IIC-ICYA IN CAZ-FLD
               MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAZ-FLD
               GO TO FIN-PUT-CYZ-CAZ.
      *>>>>
*% END
*% IF VEZ_NUM_IVCT
      *<<<< VEZ_NUM_IVCT
           MOVE VEZ-NUM-IVCT IN CAZ-FLD TO VEZ-NUM-IVEN IN CAZ-FLD.
      *>>>>
*% END
*% IF FIN_CAZ_MSC_CANC
      *<<<< FIN_CAZ_MSC_CANC
           MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CAZ-MSC-CANC IN CAZ-FLD NOT > SPACES
               MOVE SPACES       TO CCO-COD-EVEN
               MOVE SPACES TO WSS-IND-TNEG IN WSS-VARI
           ELSE
               MOVE TAB-COD-DAT1 (10) TO WSS-IND-TNEG IN WSS-VARI
               MOVE TAB-GLS-DATA TO CCO-COD-EVEN.
           MOVE 'CBZ' TO FIO-SIST.
           MOVE 'VTC' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           MOVE '*'                     TO WSS-MSC-CANC IN WSS-VARI.
           MOVE OPZ-COD-COOC IN OPZ     TO WSS-COD-COOC IN WSS-VARI.
           MOVE WSS-COD-TABL IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF WSS-IND-TNEG IN WSS-VARI = SPACES
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'CAZCMNDNOPER' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
              ELSE
                 NEXT SENTENCE
           ELSE
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 GO TO FIN-VAL-CAZ-MSC-CANC.
           MOVE 'CBZ' TO FIO-SIST.
           MOVE 'VTC' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           MOVE '*'                     TO WSS-MSC-CANC IN WSS-VARI.
           MOVE OPZ-COD-TOOC IN OPZ     TO WSS-COD-COOC IN WSS-VARI.
           MOVE WSS-COD-TABL IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF WSS-IND-TNEG IN WSS-VARI = SPACES
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'CAZCMNDNOPER' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
              ELSE
                 NEXT SENTENCE
           ELSE
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 GO TO FIN-VAL-CAZ-MSC-CANC.
           MOVE 'CBZ' TO FIO-SIST.
           MOVE 'VTC' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           MOVE CAZ-MSC-CANC IN CAZ-FLD TO WSS-MSC-CANC IN WSS-VARI.
           MOVE OPZ-COD-COOC IN OPZ     TO WSS-COD-COOC IN WSS-VARI.
           MOVE WSS-COD-TABL IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF WSS-IND-TNEG IN WSS-VARI = SPACES
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'CAZCMNDNOPER' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
              ELSE
                 NEXT SENTENCE
           ELSE
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 GO TO FIN-VAL-CAZ-MSC-CANC.
           MOVE 'CBZ' TO FIO-SIST.
           MOVE 'VTC' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           MOVE CAZ-MSC-CANC IN CAZ-FLD TO WSS-MSC-CANC IN WSS-VARI.
           MOVE OPZ-COD-TOOC IN OPZ     TO WSS-COD-COOC IN WSS-VARI.
           MOVE WSS-COD-TABL IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF WSS-IND-TNEG IN WSS-VARI = SPACES
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'CAZCMNDNOPER' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
              ELSE
                 NEXT SENTENCE
           ELSE
              IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                 GO TO FIN-VAL-CAZ-MSC-CANC
              ELSE
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'CAZCMNDNOPER' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF CAZ_COD_RCAN
      *<<<< CAZ_COD_RCAN
           IF  CAZ-COD-RCAN IN CAZ-FLD NOT > SPACES
                MOVE OPZ-COD-RMOC IN OPZ TO CAZ-COD-RCAN IN CAZ-FLD.
      *>>>>
*% END
*% IF ROZ_CAI_IOPC
      *<<<< ROZ_CAI_IOPC
      *>>>>
*% END
*% IF ROZ_IIC_IOPC
      *<<<< ROZ_IIC_IOPC
           IF ROZ-CAI-IOPC IN CAZ-FLD     > SPACES AND
              ROZ-IIC-IOPC IN CAZ-FLD NOT > ZEROES
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CICIOPCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF CAZ_FEC_FOUT
      *<<<< CAZ_FEC_FOUT
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO CAZ-NUM-DOUT IN CAZ-FLD.
           MOVE HOY-MHOY TO CAZ-NUM-MOUT IN CAZ-FLD.
           MOVE HOY-SHOY TO CAZ-NUM-SOUT IN CAZ-FLD.
           MOVE HOY-AHOY TO CAZ-NUM-AOUT IN CAZ-FLD.
           MOVE HOY-DHOY TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ACTB IN WSS-VARI.
       BUS-DIA-HBL-PRV.
           MOVE WSS-NUM-DCTB IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCTB IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCTB IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACTB IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAZ-FEC-FOUT.
           MOVE FEC-ITM1 TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ACTB IN WSS-VARI.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
                GO TO BUS-DIA-HBL-PRV.
      *>>>>
*% END
*% IF INI_CAZ_FEC_FCAN
      *<<<< INI_CAZ_FEC_FCAN
           MOVE ZEROES TO CCO-FEC-FANT IN CCO-VARI.
           IF CAZ-FEC-FCAN IN CAZ-FLD NOT > ZEROES
               MOVE CAZ-FEC-FOUT IN CAZ-FLD TO CAZ-FEC-FCAN IN CAZ-FLD
                                               FEC-FECH.
           IF SCR-USER = 'COLPGCIE'
              MOVE FEC-CHOY-N TO FEC-CHOY
              MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF CAZ_FEC_FCAN
      *<<<< CAZ_FEC_FCAN
      *>>>>
*% END
*% IF ICZ_SGV_TINT
      *<<<< ICZ_SGV_TINT
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
      *>>>>
*% END
*% IF FRM_SGV_TINT
      *<<<< FRM_SGV_TINT
      *>>>>
*% END
*% IF CAZ_COD_OFCA
      *<<<< CAZ_COD_OFCA
           IF OPZ-COD-OFOC IN CAZ-FLD = CAZ-COD-OFCA IN CAZ-FLD AND
              SCR-CMND = 'COF'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CODOFOCOFCA=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAZ-COD-OFCA.
      *>>>>
*% END
*% IF FIN_CAZ_COD_OFCA
      *<<<< FIN_CAZ_COD_OFCA
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CAZ-COD-OFCA.
           MOVE 'CBZ' TO TAB-COD-SIST.
           MOVE 'CNC' TO TAB-COD-TTAB IN TAB.
           MOVE CAZ-MSC-CANC IN CAZ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT ( TAB-CIC-CTAB IN TAB = 'RTT' OR 'RTE' OR 'PTE' OR
                                          'NTT' OR 'NTE' )
               GO TO FIN-VAL-CAZ-COD-OFCA.
           IF CAZ-COD-OFCA IN CAZ-FLD NOT = OPZ-COD-OFOC IN CAZ-FLD AND
              OFI-CIC-OFIC IN OFI     NOT = OPZ-COD-OFOC IN CAZ-FLD
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CODOFOCOFCAX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAZ-COD-OFCA.
      *>>>>
*% END
*% IF CAZ_SGV_TREN
      *<<<< CAZ_SGV_TREN
           IF CAZ-SGV-TREN IN CAZ-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF CAZ-SGV-TREN IN CAZ-FLD > ZEROES
               MOVE CAZ-SGV-TREN IN CAZ-FLD TO WSS-SGV-TREN.
      *>>>>
*% END
*% IF CAZ_SGV_TPAG
      *<<<< CAZ_SGV_TPAG
           IF CAZ-SGV-TPAG IN CAZ-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAZ-SGV-TPAG.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-TPAG IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-TPAG
                                                   IN CAZ-FLD.
      *>>>>
*% END
*% IF CAZ_SGV_GAST
      *<<<< CAZ_SGV_GAST
           IF CAZ-SGV-GAST IN CAZ-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-GAST IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-GAST
                                                   IN CAZ-FLD.
      *>>>>
*% END
*% IF CYZ_IND_TCYA
      *<<<< CYZ_IND_TCYA
           IF CYZ-IND-TCYA IN CAZ-FLD NOT > SPACES
               MOVE SPACES TO CYZ-IND-TCYA IN CAZ-FLD
               MOVE SPACES TO FRM-GLS-TCYA IN CAZ-FLD
               GO TO FIN-VAL-CYZ-IND-TCYA.
           IF CYZ-IND-TCYA IN CAZ-FLD = 'M'
               MOVE 'CBZ'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MCYAC' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE SPACES TO CYZ-CAI-ICYA IN CAZ-FLD
                   MOVE ZEROES TO CYZ-IIC-ICYA IN CAZ-FLD
                   MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAZ-FLD
                   GO TO FIN-VAL-CYZ-IND-TCYA
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'BCI    MCYAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CYZ-IND-TCYA.
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC.
           MOVE CYZ-IND-TCYA IN CAZ-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CYZ-IND-TCYA.

           IF WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(8) = 'N'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TCYANONORCAZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYZ-IND-TCYA.

           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(9) = 'N'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TCYANORETCAZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYZ-IND-TCYA.
      *>>>>
*% END
*% IF FRM_GLS_TCYA
      *<<<< FRM_GLS_TCYA
           MOVE MSC-COD-DAT1 IN MSC(3) TO WSS-GLS-DAT1.
      *>>>>
*% END
*% IF FRM_IND_PORT
      *<<<< FRM_IND_PORT
           IF OPZ-IND-PORC IN OPZ  > SPACES
              IF FRM-IND-PORT IN CAZ-FLD NOT EQUAL OPZ-IND-PORC IN OPZ
                 MOVE 'CBZ'          TO MSG-COD-SIST
                 MOVE 'INDPORTNOOPC' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-FRM-IND-PORT
              ELSE
                 NEXT SENTENCE
           ELSE
               IF ( FRM-IND-PORT IN CAZ-FLD = 'S' OR 'N' OR ' ')
                   NEXT SENTENCE
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'INDPORTNOVAL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IND-PORT.
           IF FRM-IND-PORT IN CAZ-FLD = 'S'
              MOVE CAZ-NUM-SCAN IN CAZ TO CAM-SVCA
              MOVE CAZ-NUM-ACAN IN CAZ TO CAM-AVCA
              MOVE CAZ-NUM-MCAN IN CAZ TO CAM-MVCA
              MOVE CAZ-NUM-DCAN IN CAZ TO CAM-DVCA
              MOVE 'MPORTE'            TO CAM-CVCA IN CAM-VARI(1)
              MOVE OPZ-COD-VCOC IN OPZ TO CAM-CVCA IN CAM-VARI(2)
              PERFORM TAB-BUS-CVG
              IF MSG-COD-MENS > SPACES
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'CAMPORTENEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IND-PORT
              ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO
                   FRM-VAL-PORT IN CAZ-FLD.
      *>>>>
*% END
*% IF FRM_VAL_PORT
      *<<<< FRM_VAL_PORT
           IF FRM-IND-PORT IN CAZ-FLD = 'N' OR ' '
            AND  FRM-VAL-PORT IN CAZ-FLD > ZEROES
              MOVE ZEROES TO FRM-VAL-PORT IN CAZ-FLD
              GO TO FIN-VAL-FRM-VAL-PORT.
      *>>>>
*% END
*% IF FRM_SGV_COMI
      *<<<< FRM_SGV_COMI
           PERFORM OBT-CIC-ICLI.
           MOVE RDZ-CIC-ICLI IN RDZ TO CCO-CIC-ICLI.
           PERFORM OBT-PLAN-COMI.
           IF MSG-COD-MENS > SPACES
              MOVE 'CBZ'         TO MSG-COD-SIST
              MOVE 'CANPCPERROR' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-SGV-COMI.
           PERFORM BUS-PCZ-FLV VARYING CCO-I FROM 1 BY 1
                                UNTIL ( CCO-I > CCO-MAX
                                OR CCO-CIC-COMI IN CCO-VARI = 'FLV').
           SUBTRACT 1 FROM CCO-I.
           IF FRM-SGV-COMI IN CAZ-FLD > 0
              IF ( CCO-CIC-COMI IN CCO-VARI NOT = 'FLV' OR
                   CCO-I > CCO-MAX )
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'CANPCPFLVNO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-SGV-COMI
              ELSE
              IF  FRM-SGV-COMI IN CAZ-FLD > PCZ-SGV-TIMP IN PCZ (CCO-I)
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'CANPCPCOMI>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-SGV-COMI.
              IF  FRM-SGV-COMI IN CAZ-FLD = ZEROES AND
                  CCO-CIC-COMI IN CCO-VARI = 'FLV' AND
                  WSS-IBLK-COMI NOT = 'N'
                     MOVE 'N' TO WSS-IBLK-COMI
                     MOVE PCZ-SGV-TIMP IN PCZ (CCO-I)
                              TO FRM-SGV-COMI IN CAZ-FLD.
      *>>>>
*% END
*% IF CYZ_CAI_ICYA
      *<<<< CYZ_CAI_ICYA
           IF CYZ-CAI-ICYA IN CAZ-FLD NOT > SPACES
               MOVE SPACES TO CYZ-CAI-ICYA IN CAZ-FLD.
           IF CYZ-IND-TCYA IN CAZ-FLD = 'M'
               MOVE SPACES TO CYZ-CAI-ICYA IN CAZ-FLD
               MOVE ZEROES TO CYZ-IIC-ICYA IN CAZ-FLD
               GO TO FIN-VAL-CYZ-CAI-ICYA.
      *>>>>
*% END
*% IF RCZ_SGV_CAPI
      *<<<< RCZ_SGV_CAPI
           IF RCZ-SGV-CAPI IN CAZ-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF RCZ_SGV_FINA
      *<<<< RCZ_SGV_FINA
           IF RCZ-SGV-FINA IN CAZ-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CAZ
      *<<<< INI_VAL_CON_KEY_CAZ
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CAZ.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CAZ
      *<<<< FIN_VAL_CON_KEY_CAZ
           IF CAZ-IIC-IOPC IN CAZ-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_CAZ
      *<<<< FIN_VAL_CON_IKY_CAZ
           IF CAZ-IIC-IOPC IN CAZ-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_CAZ
      *<<<< VAL_CON_FLD_CAZ
           MOVE SPACES TO SCR-RCV-STAT.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO OPZ-CAI-IOPC IN OPZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE SPACES TO MSG-COD-MENS.
           IF CAZ-MSC-CANC IN CAZ-FLD = 'ATT'
               IF OPZ-IND-RENO IN OPZ > SPACES
                   MOVE 'CANATT RENO' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAZ-MSC-CANC IN CAZ-FLD = 'QTT'
               IF OPZ-IND-RENO IN OPZ NOT = 'PRO'
                   MOVE 'CANQTT PRO<>' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAZ-MSC-CANC IN CAZ-FLD = 'STT'
               IF OPZ-IND-RENO IN OPZ NOT = 'REN'
                   MOVE 'CANQTT REN<>' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAZ-MSC-CANC IN CAZ-FLD = 'OTT'
               IF OPZ-IND-RENO IN OPZ NOT = 'NOV'
                   MOVE 'CANQTT NOV<>' TO MSG-COD-MENS.

           IF MSG-COD-MENS > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAZ.

           IF SCR-CMND = 'COF'
               GO TO FIN-VAL-CON-FLD-CAZ.

      * BUSCA DATO 'COMO OPERA=WSS-OPEC'
           MOVE OPZ-COD-TOOC IN OPZ TO TOZ-COD-TOCR IN TOZ.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM CBZ-FIO-TOZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE TOZ-COD-TOCR IN TOZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAZ.
      *     MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.

      *     IF ( SCR-MSC-FCAN = 'I' OR 'P' OR 'C' ) AND WSS-OPEC = 'B'
      *         MOVE 'CBZ'          TO MSG-COD-SIST
      *         MOVE 'MSCFCANIPCBG' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-CAZ.

           IF SCR-MSC-TCAN = 'C' AND
              ( ROZ-CAI-IOPC IN CAZ-FLD > SPACES OR
                ROZ-IIC-IOPC IN CAZ-FLD > ZEROES )
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'ROZCANCINV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.

           IF SCR-MSC-TCAN = 'N' AND
              SCR-CMND = 'ING' AND
              ( ROZ-CAI-IOPC IN CAZ-FLD > SPACES OR
                ROZ-IIC-IOPC IN CAZ-FLD > ZEROES )
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'ROZIOPCNOV0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.

           IF SCR-MSC-TCAN = 'P' AND
              SCR-CMND = 'ING' AND
              ( ROZ-CAI-IOPC IN CAZ-FLD > SPACES OR
                ROZ-IIC-IOPC IN CAZ-FLD > ZEROES )
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'ROZIOPCPRG0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.

           IF ( SCR-MSC-TCAN = 'R' OR 'P' ) AND
                ROZ-IIC-IOPC IN CAZ-FLD > ZEROES
                 MOVE ROZ-CAI-IOPC IN CAZ-FLD TO OPZ-CAI-IOPC IN OPZ
                 MOVE ROZ-IIC-IOPC IN CAZ-FLD TO OPZ-IIC-IOPC IN OPZ
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM CBZ-FIO-OPZ
                 IF FIO-STAT-OKS AND
                    OPZ-MSC-STAT IN OPZ = 'A'
                      MOVE 'CBZ'          TO MSG-COD-SIST
                      MOVE 'OPZSTAT INVA' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO END-VAL-CON-FLD-CAZ
                 ELSE
                     MOVE CAZ-CAI-IOPC IN CAZ-FLD TO OPZ-CAI-IOPC IN OPZ
                     MOVE CAZ-IIC-IOPC IN CAZ-FLD TO OPZ-IIC-IOPC IN OPZ
                     MOVE FIO-GET-KEY TO FIO-CMND
                     PERFORM CBZ-FIO-OPZ
                     IF NOT FIO-STAT-OKS
                         MOVE 'CBZ'        TO MSG-COD-SIST
                         MOVE 'OPZ    NEX' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC TO FRM-MENS
                         MOVE FRM-SUAR-MAL TO FRM-SUAR
                         GO TO END-VAL-CON-FLD-CAZ
                     ELSE
                      MOVE ROZ-CAI-IOPC IN CAZ-FLD TO
                           ROZ-CAI-IOPC IN ROZ
                      MOVE ROZ-IIC-IOPC IN CAZ-FLD TO
                           ROZ-IIC-IOPC IN ROZ
                      MOVE LOW-VALUES TO ROZ-KEY-IVCT IN ROZ
                      MOVE FIO-GET-NLS TO FIO-CMND
                      PERFORM CBZ-FIO-ROZ
                      IF NOT ( FIO-STAT-OKS               AND
                               ROZ-CAI-IOPC IN CAZ-FLD =
                               ROZ-CAI-IOPC IN ROZ        AND
                               ROZ-IIC-IOPC IN CAZ-FLD =
                               ROZ-IIC-IOPC IN ROZ )
                                MOVE 'CBZ'          TO MSG-COD-SIST
                                MOVE 'REN    NOROV' TO MSG-COD-MENS
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                MOVE FRM-SUAR-MAL TO FRM-SUAR
                                GO TO END-VAL-CON-FLD-CAZ.

           IF SCR-MSC-TCAN = 'C'
                SUBTRACT CAZ-SGV-GAST IN CAZ-FLD FROM
                         CAZ-SGV-TPAG IN CAZ-FLD
                IF CAZ-SGV-TPAG IN CAZ-FLD < ZEROES
                     MOVE ZEROES TO CAZ-SGV-TPAG IN CAZ-FLD.

           IF SCR-MSC-TCAN NOT = 'C'
                SUBTRACT CAZ-SGV-GAST IN CAZ-FLD FROM
                         CAZ-SGV-TREN IN CAZ-FLD
                IF CAZ-SGV-TREN IN CAZ-FLD < ZEROES
                     MOVE ZEROES TO CAZ-SGV-TREN IN CAZ-FLD.

           IF SCR-MSC-TCAN = 'C'
               MOVE ZEROES TO CAZ-SGV-TREN IN CAZ-FLD.

           MOVE ZEROES TO CAZ-SGV-DIFE IN CAZ-FLD.

           PERFORM GET-SLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAZ.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO WSS-NUM-DCAN IN WSS-VARI.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO WSS-NUM-MCAN IN WSS-VARI.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO WSS-NUM-SCAN IN WSS-VARI.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO WSS-NUM-ACAN IN WSS-VARI.

           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO WSS-NUM-AIMV IN WSS-VARI.
           IF WSS-CMP-FCAN IN WSS-VARI < WSS-CMP-FIMV IN WSS-VARI
               MOVE 'A' TO RCZ-MSC-MCAN IN CAZ-FLD
           ELSE
           IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI
               MOVE 'V' TO RCZ-MSC-MCAN IN CAZ-FLD
           ELSE
               MOVE 'F' TO RCZ-MSC-MCAN IN CAZ-FLD.
           PERFORM LEE-REG-TCAN.

           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF WSS-CMP-FCAN < WSS-CMP-FIMV
               MOVE ZEROES TO ICZ-SGV-TINT IN CAZ-FLD
               MOVE SPACES TO FRM-GLS-TINT IN CAZ-FLD.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           IF NOT ( CAZ-FEC-FCAN IN CAZ > VEZ-FEC-FVEN IN VEZ ) AND
              WSS-IBLK-TINT NOT = 'S'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TMORERR'      TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAZ.

           IF WSS-IBLK-TINT NOT = 'S'
               IF WSS-CIC-TVAL = '1'
                   MOVE 'EFE ANUA'   TO FRM-GLS-TINT IN CAZ-FLD
               ELSE
                   MOVE 'EFE MENS'   TO FRM-GLS-TINT IN CAZ-FLD.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO WSS-NUM-AIMV IN WSS-VARI.
           IF WSS-CMP-FCAN = WSS-CMP-FIMV AND
              ( SCR-MSC-ECAN  NOT = 'T'  OR
                OPZ-NUM-VCOR IN OPZ = 1 )
                MOVE ZEROES TO ICZ-SGV-TINT IN CAZ-FLD.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO WSS-NUM-AIMV IN WSS-VARI.

           PERFORM DEL-COM-IMP-GAS.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO PRO-MSG-MAL.
           PERFORM OBT-CIC-ICLI.
           MOVE RDZ-CIC-ICLI IN RDZ TO CIM-CIC-ICLI.
           PERFORM OBT-PLAN-IMPU.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO PRO-MSG-MAL.
           MOVE ZEROES TO WSS-SGV-GPRO IN WSS-VARI.
           PERFORM ADD-GAS-VEC.
           MOVE ZEROES TO CAZ-SGV-ICOM IN CAZ-FLD
                          CAZ-SGV-IPUN IN CAZ-FLD
                          CAZ-VAL-COMI IN CAZ-FLD
                          VEZ-VAL-IMPU IN CAZ-FLD.
           IF WSS-SGV-GPRO IN WSS-VARI > ZEROES
              MOVE WSS-SGV-GPRO IN WSS-VARI TO CAZ-VAL-COMI IN CAZ-FLD.
           MOVE 0 TO SCR-SGV-IPFC.
           IF CCO-FEC-FANT IN CCO-VARI NOT > ZEROES
               MOVE DLZ-FEC-FDEV IN DLZ TO CCO-FEC-FANT IN CCO-VARI.
           MOVE OPZ-VAL-SCRE IN OPZ TO WSS-VAL-SCRE IN WSS-VARI.
           IF WSS-OPEC = 'B'
             IF WSS-CMP-FCAN IN WSS-VARI > VEZ-FEC-FVEN IN VEZ
                MOVE 'N' TO WSS-IBLK-TINT
                MOVE ZEROES TO ICZ-SGV-TINT IN CAZ-FLD.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CTE.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               PERFORM PRO-TCAN-CTT.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'I' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CIE.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'P' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CPE.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CCE.
       PRO-MSG-MAL.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'CBZ' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               GO TO END-VAL-CON-FLD-CAZ.

           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM
                             GIVING SCR-SGV-IPFC ROUNDED.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE SCR-SGV-IPFC TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-IPFC.
       CON-VLD-FLD-SEC.
           IF SCR-CCPP = 'MOD' OR
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )

               IF SCR-MSC-TCAN = 'C' AND
                  SCR-MSC-TCNC = 'C'
                    GO TO CHG-CAZ
               ELSE
               IF SCR-MSC-CANC NOT = SCR-MSC-CCNC
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'MSCCANCNOMOD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.
       CHG-CAZ.
           IF CAZ-FEC-FOUT IN CAZ-FLD = CAZ-FEC-FCAN IN CAZ-FLD
               MOVE CAZ-FEC-FOUT IN CAZ-FLD TO CAZ-FEC-FEGR IN CAZ-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI = WSS-FEC-FAUX IN WSS-VARI
               MOVE CAZ-FEC-FOUT IN CAZ-FLD TO CAZ-FEC-FEGR IN CAZ-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI > WSS-FEC-FAUX IN WSS-VARI
               MOVE CAZ-FEC-FCAN IN CAZ-FLD TO CAZ-FEC-FEGR IN CAZ-FLD.

           IF ( SCR-MSC-TCAN = 'R' OR '1' )
               PERFORM VAL-CON-ROZ
               PERFORM RET-CAZ-CAZ
               PERFORM RET-ROZ-CAZ.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAZ.


           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T' AND
              CAZ-SGV-TPAG IN CAZ-FLD NOT > ZEROES AND
              WSS-IBLK-TPAG  = 'S'
                IF SCR-MSC-ECAN = 'T'
                       MOVE WSS-VAL-SVEN TO CAZ-SGV-TPAG IN CAZ-FLD
                ELSE
                IF SCR-MSC-ECAN = 'E'
                       MOVE WSS-VAL-SVEN TO CAZ-SGV-TPAG IN CAZ-FLD.

           PERFORM ABS-TPAG.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T'
                   IF SCR-MSC-ECAN = 'T' OR 'E'
                       SUBTRACT WSS-VAL-SVEN FROM WSS-SGV-TPAG GIVING
                                              CAZ-SGV-DIFE IN CAZ-FLD.

           IF ( CAZ-SGV-DIFE IN CAZ-FLD NOT = ZEROS ) AND
              ( SCR-CMND NOT = 'IVP' ) AND ( SCR-CMND NOT = 'MVP' )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'NODEBEIRTPAG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAZ.

           IF WSS-VAL-SVEN < WSS-VAL-SCAP AND
              WSS-OPEC NOT = 'B'
               IF NOT ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CANTIPEDESC>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ
               ELSE
                   IF ( SCR-MSC-TCAN = 'C' ) AND
                      ( SCR-MSC-FCAN = 'T' ) AND
                      ( SCR-MSC-ECAN = 'T' OR 'E' )
                       SUBTRACT WSS-VAL-SVEN FROM WSS-VAL-SCAP
                                      GIVING CAZ-SGV-DIFE IN CAZ-FLD.

           IF SCR-MSC-TCAN = 'C' AND
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C' ) AND
                CAZ-SGV-TPAG IN CAZ-FLD NOT > ZEROES AND
                WSS-IBLK-TPAG = 'S'
                  MOVE 'CBZ'          TO MSG-COD-SIST
                  MOVE 'MSCFCANTPAGP' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO END-VAL-CON-FLD-CAZ.

           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
                SCR-MSC-FCAN = 'T'
                 IF CAZ-SGV-TPAG IN CAZ-FLD > ZEROES
                     IF SCR-MSC-ECAN = 'T'
                         IF (CAZ-MSC-CANC IN CAZ-FLD = 'QTT' OR 'STT'
                                                   OR   'OTT') AND
                            (CAZ-FEC-FCAN IN CAZ = OPZ-FEC-FCOL IN OPZ)
                            IF CAZ-SGV-TPAG IN CAZ-FLD <
                               OPZ-VAL-SCRE IN OPZ
                                 SUBTRACT CAZ-SGV-TPAG IN CAZ-FLD FROM
                                 OPZ-VAL-SCRE IN OPZ GIVING
                                 CAZ-SGV-TREN IN CAZ-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                        ELSE
                            IF CAZ-SGV-TPAG IN CAZ-FLD < WSS-VAL-SVEN
                                 SUBTRACT CAZ-SGV-TPAG IN CAZ-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAZ-SGV-TREN IN CAZ-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                            IF CAZ-SGV-TPAG IN CAZ-FLD = WSS-VAL-SVEN
                               AND WSS-OPEC = 'B'
                                 MOVE ZEROES TO CAZ-SGV-TREN IN CAZ-FLD
                                 GO TO CON-VAL-CON-FLD-CAZ
                            ELSE
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                     ELSE
                     IF SCR-MSC-ECAN = 'E'
                            IF CAZ-SGV-TPAG IN CAZ-FLD < WSS-VAL-SVEN
                                 SUBTRACT CAZ-SGV-TPAG IN CAZ-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAZ-SGV-TREN IN CAZ-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSVEN>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                     ELSE
                            NEXT SENTENCE
                 ELSE
                 IF CAZ-SGV-TREN IN CAZ-FLD > ZEROES
                     IF SCR-MSC-ECAN = 'T'
                         IF (CAZ-MSC-CANC IN CAZ-FLD = 'QTT' OR 'STT'
                                                   OR   'OTT') AND
                            (CAZ-FEC-FCAN IN CAZ = OPZ-FEC-FCOL IN OPZ)
                            IF CAZ-SGV-TREN IN CAZ-FLD >
                               OPZ-VAL-SCRE IN OPZ
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENLIQU>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                            ELSE
                                 SUBTRACT CAZ-SGV-TREN IN CAZ-FLD FROM
                                 OPZ-VAL-SCRE IN OPZ GIVING
                                 CAZ-SGV-TPAG IN CAZ-FLD
                         ELSE
                            IF CAZ-SGV-TREN IN CAZ-FLD > WSS-VAL-SVEN
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                            ELSE
                                 SUBTRACT CAZ-SGV-TREN IN CAZ-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAZ-SGV-TPAG IN CAZ-FLD
                     ELSE
                     IF SCR-MSC-ECAN = 'E'
                            IF CAZ-SGV-TREN IN CAZ-FLD > WSS-VAL-SVEN
                                 MOVE 'CBZ'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENSVEN>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAZ
                            ELSE
                                 SUBTRACT CAZ-SGV-TREN IN CAZ-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAZ-SGV-TPAG IN CAZ-FLD.

           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
              SCR-MSC-FCAN = 'T' AND
              CAZ-SGV-TREN IN CAZ-FLD = ZEROES
                MOVE ZEROES TO CAZ-SGV-TPAG IN CAZ-FLD
                IF SCR-MSC-ECAN = 'T'
                    IF ( CAZ-MSC-CANC IN CAZ-FLD = 'QTT' OR 'STT' OR
                                                            'OTT' ) AND
                       ( CAZ-FEC-FCAN IN CAZ = OPZ-FEC-FCOL IN OPZ )
                       MOVE OPZ-VAL-SCRE IN OPZ TO CAZ-SGV-TREN
                                                IN CAZ-FLD
                    ELSE
                       MOVE WSS-VAL-SVEN TO CAZ-SGV-TREN IN CAZ-FLD
                ELSE
                IF SCR-MSC-ECAN = 'E'
                       MOVE WSS-VAL-SVEN TO CAZ-SGV-TREN IN CAZ-FLD.

       CON-VAL-CON-FLD-CAZ.

           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C') AND
                CAZ-SGV-TREN IN CAZ-FLD = ZEROES
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'MSCFCANTRENP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.

           IF CAZ-SGV-TPAG IN CAZ-FLD > ZEROES OR
              ( CAZ-SGV-TPAG IN CAZ-FLD = ZEROES AND
                WSS-IBLK-TPAG = 'N' )
              IF CYZ-IND-TCYA IN CAZ-FLD NOT > SPACES
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'INDTCYAOBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ
               ELSE
                   MOVE CAZ-NUM-DOUT IN CAZ-FLD TO CAZ-NUM-DOUT IN CAZ
                   MOVE CAZ-NUM-MOUT IN CAZ-FLD TO CAZ-NUM-MOUT IN CAZ
                   MOVE CAZ-NUM-SOUT IN CAZ-FLD TO CAZ-NUM-SOUT IN CAZ
                   MOVE CAZ-NUM-AOUT IN CAZ-FLD TO CAZ-NUM-AOUT IN CAZ
                   MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ
                   MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ
                   MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ
                   MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ
                   MOVE 'TAB'                   TO MSC-COD-SIST
                   MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC
                   MOVE CYZ-IND-TCYA IN CAZ-FLD TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   IF MSC-CIC-CMSC IN MSC = 'CAJA' AND
                      CAZ-FEC-FOUT IN CAZ NOT = CAZ-FEC-FCAN IN CAZ
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'CANOUTCANCJI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE 'S' TO FRM-UCUR
                       MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
                       GO TO END-VAL-CON-FLD-CAZ
                   ELSE
                   IF ( MSC-CIC-CMSC IN MSC = 'CC' OR 'AH' ) AND
                      ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' )
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE 'S' TO FRM-UCUR
                       MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
                       GO TO END-VAL-CON-FLD-CAZ
                   ELSE
                       NEXT SENTENCE
           ELSE
               IF CYZ-IND-TCYA IN CAZ-FLD > SPACES
                  AND ( FIO-PROG NOT = 'COLPGCAN' )
                 MOVE 'CBZ'        TO MSG-COD-SIST
                 MOVE 'INDTCYABLK' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE 'S' TO FRM-UCUR
                 MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
                 GO TO END-VAL-CON-FLD-CAZ.

           IF ( CYZ-IND-TCYA IN CAZ-FLD NOT > SPACES AND
                 ( CYZ-CAI-ICYA IN CAZ-FLD > SPACES OR
                   CYZ-IIC-ICYA IN CAZ-FLD > ZEROES ) )

                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'INDTCYAICYA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ.

           IF CYZ-IND-TCYA IN CAZ-FLD NOT > SPACES
               GO TO FIN-VAL-ICYA.

           IF WSS-GLS-DAT1 NOT > SPACES
               MOVE SPACES TO CYZ-CAI-ICYA IN CAZ-FLD
               MOVE ZEROES TO CYZ-IIC-ICYA IN CAZ-FLD
               GO TO FIN-VAL-ICYA.

           IF CYZ-IIC-ICYA IN CAZ-FLD NOT > ZEROES
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'IICICYACCOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
               GO TO END-VAL-CON-FLD-CAZ.

           MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ.
           MOVE DLZ-NUM-IDLC IN DLZ TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'NOEXICLIDLZ'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
               GO TO END-VAL-CON-FLD-CAZ.
           MOVE RDZ-CIC-ICLI IN RDZ TO RCO-CIC-ICLI IN RCO.
           MOVE CYZ-CAI-ICYA IN CAZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYZ-IIC-ICYA IN CAZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ
               ELSE
               IF WSS-GLS-DAT1 NOT = 'M'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYACSCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ
               ELSE
                   GO TO CER-VAL-CYZ-CAI-ICYA.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE CYZ-CAI-ICYA IN CAZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYZ-IIC-ICYA IN CAZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CICICYACCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
               GO TO END-VAL-CON-FLD-CAZ
           ELSE
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ
               ELSE
               IF WSS-GLS-DAT1 = 'M'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYACNCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN CAZ-FLD
                   GO TO END-VAL-CON-FLD-CAZ.
       CER-VAL-CYZ-CAI-ICYA.
           MOVE 'TAB'                   TO FIO-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE RCO-COD-TOPR            TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF ( (TAB-CIC-CTAB IN TAB = 'CTE' AND
               MSC-CIC-CMSC IN MSC NOT = 'CC') OR
              (TAB-CIC-CTAB IN TAB = 'AHO' AND
               MSC-CIC-CMSC IN MSC NOT = 'AH') ) AND
              ( FIO-PROG NOT = 'COLPGCAN' )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CICICYACTAIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-IND-TCYA-LEN IN CAZ-FLD
               GO TO END-VAL-CON-FLD-CAZ.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'           TO MSG-COD-SIST
               MOVE 'CIC0999  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAZ.
           IF WSS-OPEC = 'B'
                   NEXT SENTENCE
           ELSE
           MOVE OPZ-COD-VCOC IN CAZ-FLD TO OPZ-COD-VCOC IN OPZ
           IF NOT ( OPE-COD-VCOP IN OPE = OPZ-COD-VCOC IN CAZ-FLD OR
                  ( OPE-COD-VCOP IN OPE = TAB-COD-CTAB IN TAB AND
                    OPZ-MSC-TVOC = '0'))
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'AUTVCOP<>OPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAZ.
           IF OPE-FEC-FTOP IN OPE > ZEROES
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAZ.
       FIN-VAL-ICYA.

       END-VAL-CON-FLD-CAZ.

           IF SCR-MSC-TCAN = 'C'
                ADD CAZ-SGV-GAST IN CAZ-FLD TO CAZ-SGV-TPAG IN CAZ-FLD
           ELSE
                ADD CAZ-SGV-GAST IN CAZ-FLD TO CAZ-SGV-TREN IN CAZ-FLD.

           IF SCR-MSC-TCAN = 'N' OR
              SCR-MSC-TCAN = 'R'
                MOVE ZEROES TO CAZ-SGV-DIFE IN CAZ-FLD.

           IF ( CAZ-MSC-CANC IN CAZ-FLD = 'ATT' ) AND
              ( CAZ-FEC-FCAN IN CAZ = OPZ-FEC-FCOL IN OPZ )
               MOVE ZEROES TO CAZ-SGV-GAST IN CAZ-FLD
               MOVE ZEROES TO CAZ-SGV-TREN IN CAZ-FLD
               MOVE ZEROES TO CAZ-SGV-DIFE IN CAZ-FLD
               MOVE OPZ-SGV-LIQU IN OPZ TO CAZ-SGV-TPAG IN CAZ-FLD.

           MOVE SCR-COD-VCOC TO PES-COD-VCAM.

           MOVE CAZ-SGV-DIFE IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-DIFE
                                                   IN CAZ-FLD.
           MOVE CAZ-SGV-TPAG IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-TPAG
                                                   IN CAZ-FLD.
           MOVE CAZ-SGV-TREN IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-TREN
                                                   IN CAZ-FLD.

           MOVE RCZ-SGV-CAPI IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCZ-SGV-CAPI
                                                   IN CAZ-FLD.

           MOVE RCZ-SGV-FINA IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCZ-SGV-FINA
                                                   IN CAZ-FLD.

           MOVE VEZ-VAL-SCAP IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO VEZ-VAL-SCAP
                                                   IN CAZ-FLD.

           MOVE VEZ-VAL-SFIN IN CAZ-FLD  TO PES-SGV-DECI
                                                   IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO VEZ-VAL-SFIN
                                                   IN CAZ-FLD.

           IF FRM-SUAR NOT = FRM-SUAR-MAL
               PERFORM OBT-MONTO-PAG-VCD
               PERFORM OBT-MONTO-PAG-JUD
               PERFORM PUT-COM-IMP-GAS
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-VAL-CON-FLD-CAZ.


           IF FRM-SUAR = FRM-SUAR-MAL
               PERFORM BASE-TASA-INI.

           IF NOT ( MSG-COD-MENS > SPACES OR
                    FRM-SUAR = FRM-SUAR-MAL )
               PERFORM VAL-DAT-PREV-ING
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF CAZ-SGV-TPAG IN CAZ-FLD > ZEROES
               COMPUTE FRM-VAL-IABO IN CAZ-FLD = 
                       CAZ-SGV-TPAG IN CAZ-FLD -
                       FRM-SGV-COMI IN CAZ-FLD
           ELSE
               MOVE ZEROES TO FRM-VAL-IABO IN CAZ-FLD.
      *>>>>
*% END
*% IF INI_VAL_NUM_FLD_CAZ
      *<<<< INI_VAL_NUM_FLD_CAZ
           IF CAZ-SGV-TPAG-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TPAG
           ELSE
               MOVE 'N' TO WSS-IBLK-TPAG.
           IF ICZ-SGV-TINT-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TINT
           ELSE
               MOVE 'N' TO WSS-IBLK-TINT.
           IF FRM-SGV-COMI-ALF > SPACES
               MOVE 'N' TO WSS-IBLK-COMI
           ELSE
               MOVE SPACES TO WSS-IBLK-COMI.
           IF ICZ-SGV-TINT-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TINT
           ELSE
               MOVE 'N' TO WSS-IBLK-TINT.
      *>>>>
*% END
*% IF FIN_EDT_FLD_CAZ
      *<<<< FIN_EDT_FLD_CAZ
           IF WSS-IBLK-TPAG = 'N' AND CAZ-SGV-TPAG-ALF NOT > SPACES
               MOVE 0 TO CAZ-SGV-TPAG-EDT1 IN WSS-VARI
               MOVE CAZ-SGV-TPAG-EDT1 IN WSS-VARI TO
                CAZ-SGV-TPAG-ALF IN CAZ-FLD.
           IF WSS-IBLK-TINT = 'N' AND ICZ-SGV-TINT-ALF NOT > SPACES
               MOVE 0 TO ICZ-SGV-TINT-EDT1 IN WSS-VARI
               MOVE ICZ-SGV-TINT-EDT1 IN WSS-VARI TO
                ICZ-SGV-TINT-ALF IN CAZ-FLD.
           IF WSS-IBLK-TINT = 'N' AND ICZ-SGV-TINT-ALF NOT > SPACES
	       MOVE 0 TO ICZ-SGV-TINT-EDT1 IN WSS-VARI
	       MOVE ICZ-SGV-TINT-EDT1 IN WSS-VARI TO
                     	       ICZ-SGV-TINT-ALF IN CAZ-FLD.
      *>>>>
*% END
