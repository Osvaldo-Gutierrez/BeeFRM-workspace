       PRO-RCZ SECTION.
       INI-PRO-RCZ.
           MOVE ZEROES TO WSS-VAL-SMO1.
           MOVE ZEROES TO WSS-VAL-SMO2.
           MOVE CAZ-CAI-IOPC IN CAZ TO RCZ-CAI-IOPC IN RCZ.
           MOVE CAZ-IIC-IOPC IN CAZ TO RCZ-IIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO RCZ-NUM-ICAN IN RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPV IN RCZ.
           MOVE VEZ-NUM-IVEN IN VEZ TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF RCZ-NUM-IVCT IN RCZ > ZEROES
               MOVE RCZ-KEY-IVCT IN RCZ TO VEZ-KEY-IVEN IN VEZ
               PERFORM PRO-VEZ
               MOVE VEZ-NUM-IDLC IN VEZ TO WSS-NUM-IDLC
               ADD  RCZ-SGV-CAPI IN RCZ TO WSS-SGV-CAPD(WSS-NUM-IDLC)
               ADD  RCZ-SGV-FINA IN RCZ TO WSS-SGV-FINA(WSS-NUM-IDLC)
               IF SCR-CMND = 'REV' AND
                  ( CAZ-MSC-FCAN IN CAZ NOT = 'I' AND
                    CAZ-MSC-FCAN IN CAZ NOT = 'C' AND
                    CAZ-MSC-FCAN IN CAZ NOT = 'P' )
                   SUBTRACT 1 FROM WSS-NUM-VCVG IN WSS-VARI
                   IF RCZ-IND-SCTB = 'VCD'
                       SUBTRACT 1 FROM WSS-NUM-VCCV IN WSS-VARI
                   ELSE
                       IF RCZ-MSC-MCAN IN RCZ = 'V'
                           SUBTRACT 1 FROM WSS-NUM-VCCM IN WSS-VARI
                       ELSE
                           SUBTRACT 1 FROM WSS-NUM-VCCO IN WSS-VARI
               ELSE
               IF VEZ-VAL-SFIN IN VEZ NOT > ZEROES
                   ADD 1 TO WSS-NUM-VCVG IN WSS-VARI
                   IF RCZ-IND-SCTB = 'VCD'
                       ADD 1 TO WSS-NUM-VCCV IN WSS-VARI
                   ELSE
                       IF RCZ-MSC-MCAN IN RCZ = 'V'
                           ADD 1 TO WSS-NUM-VCCM IN WSS-VARI
                       ELSE
                           ADD 1 TO WSS-NUM-VCCO IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE ZEROES TO WSS-NUM-IDLC.
           ADD  RCZ-SGV-CAPI IN RCZ TO WSS-SGV-CAPD(500).
           ADD  RCZ-SGV-FINA IN RCZ TO WSS-SGV-FINA(500).
           PERFORM PRO-OPE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-RCZ.
           IF WSS-NUM-IDLC > ZEROES
               MOVE CAZ-CIC-IOPC IN CAZ TO DLZ-CIC-IOPC IN DLZ
               PERFORM PRO-DOC VARYING WSS-NUM-IDLC FROM 1 BY 1
                               UNTIL   WSS-NUM-IDLC > 499.
               IF ( VEZ-VAL-SFIN IN VEZ NOT > ZEROES ) AND
                  ( VEZ-VAL-SCAP IN VEZ NOT > ZEROES ) AND
                  ( OPZ-VAL-SCRE IN OPZ > ZEROES )     AND
                  ( SCR-CMND NOT = 'REV' )
                     PERFORM GEN-SIG-VEZ-VEZ.
       FIN-PRO-RCZ.
           EXIT.

       PRO-VEZ SECTION.
       INI-PRO-VEZ.
           PERFORM PRO-VEZ-NSTR.
       FIN-PRO-VEZ.
           EXIT.
       PRO-VEZ-NSTR SECTION.
       INI-PRO-VEZ-NSTR.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZ    NEX' TO MSG-COD-MENS
               GO TO FIN-PRO-VEZ-NSTR.
           MOVE VEZ-FEC-FVEN IN VEZ TO WSS-FEC-FAMT.
           IF SCR-CMND = 'REV'
               MOVE RCZ-SGV-CAPI IN RCZ TO WSS-VAL-SMO1
               MOVE RCZ-SGV-FINA IN RCZ TO WSS-VAL-SMO2
           ELSE
               MOVE RCZ-SGV-CAPI IN RCZ TO WSS-VAL-SMO1
               MOVE RCZ-SGV-FINA IN RCZ TO WSS-VAL-SMO2.
           PERFORM ACT-SFIN-SCAP-VEZ.
       FIN-PRO-VEZ-NSTR.
           EXIT.
       ACT-SFIN-SCAP-VEZ SECTION.
       INI-ACT-SFIN-SCAP-VEZ.
           IF RCZ-SGV-CAPI IN RCZ > VEZ-VAL-SCAP IN VEZ
               MOVE ZEROES TO VEZ-VAL-SCAP IN VEZ
           ELSE
               SUBTRACT RCZ-SGV-CAPI IN RCZ FROM VEZ-VAL-SCAP IN VEZ.
           IF RCZ-SGV-FINA IN RCZ > VEZ-VAL-SFIN IN VEZ
               MOVE ZEROES TO VEZ-VAL-SFIN IN VEZ
           ELSE
               SUBTRACT RCZ-SGV-FINA IN RCZ FROM VEZ-VAL-SFIN IN VEZ.
           IF SCR-CMND NOT = 'REV'
               IF (( RCZ-MSC-STAT IN RCZ = 'C' OR 'F' ) AND
                   CAZ-MSC-FCAN IN CAZ = 'T' )
                   MOVE ZEROES TO VEZ-VAL-SCAP IN VEZ
                   MOVE ZEROES TO VEZ-VAL-SFIN IN VEZ
               ELSE
                   NEXT SENTENCE
           ELSE
               IF RCZ-MSC-STAT IN RCZ = 'C'
                   MOVE ZEROES TO VEZ-VAL-SCAP IN VEZ
               ELSE
               IF RCZ-MSC-STAT IN RCZ = 'F'
                   MOVE ZEROES TO VEZ-VAL-SFIN IN VEZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'VEZ    BCK' TO MSG-COD-MENS.
       FIN-ACT-SFIN-SCAP-VEZ.
           EXIT.
       PUT-VEZ-IND-SCTB SECTION.
       INI-PUT-VEZ-IND-SCTB.
           IF WSS-IND-SCTB > SPACES
               MOVE WSS-IND-SCTB TO VEZ-IND-SCTB IN VEZ.
           IF WSS-IND-SCBZ > SPACES
               MOVE WSS-IND-SCBZ TO VEZ-IND-SCBZ IN VEZ.
       FIN-PUT-VEZ-IND-SCTB.
           EXIT.

       GEN-SIG-VEZ-VEZ SECTION.
       INI-GEN-SIG-VEZ-VEZ.
           MOVE SPACES TO MSG-COD-MENS.
           IF RCZ-NUM-IVCT IN RCZ NOT > ZEROES
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE RCZ-KEY-IVCT IN RCZ TO VEZ-KEY-IVEN IN VEZ.
           ADD 1 TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF FIO-STAT-OKS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO ICZ-CIC-IOPC IN ICZ.
           MOVE ZEROES              TO ICZ-NUM-ICAN IN ICZ.
           MOVE SPACES              TO ICZ-CIC-IOPV IN ICZ.
           MOVE ZEROES              TO ICZ-NUM-IVCT IN ICZ.
           MOVE 'INT'               TO ICZ-IND-TTAS IN ICZ.
           MOVE ZEROES              TO ICZ-FEC-FINI IN ICZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT ( FIO-STAT-OKS AND
                    ICZ-CAI-IOPC IN ICZ = OPZ-CAI-IOPC IN OPZ AND
                    ICZ-IIC-IOPC IN ICZ = OPZ-IIC-IOPC IN OPZ AND
                    ICZ-NUM-ICAN IN ICZ = ZEROES AND
                    ICZ-CIC-IOPV IN ICZ = SPACES AND
                    ICZ-NUM-IVCT IN ICZ = ZEROES AND
                    ICZ-IND-TTAS IN ICZ = 'INT' )
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           IF ICZ-COD-CVTI IN ICZ NOT > SPACES
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE RCZ-KEY-IVCT IN RCZ TO VEZ-KEY-IVEN IN VEZ.
           IF VEZ-NUM-IVEN IN VEZ > 1
               SUBTRACT 1 FROM VEZ-NUM-IVEN IN VEZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-VEZ
               IF FIO-STAT-OKS
                   MOVE VEZ-NUM-DVEN IN VEZ TO FEC-DEC1
                   MOVE VEZ-NUM-MVEN IN VEZ TO FEC-MEC1
                   MOVE VEZ-NUM-SVEN IN VEZ TO FEC-SEC1
                   MOVE VEZ-NUM-AVEN IN VEZ TO FEC-AEC1
               ELSE
                   MOVE RCZ-KEY-IVCT IN RCZ TO VEZ-KEY-IVEN IN VEZ
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM CBZ-FIO-VEZ
                   IF FIO-STAT-OKS
                       MOVE 30 TO FEC-NDIA
                       GO TO CON-GEN-SIG-VEZ-VEZ
                   ELSE
                       MOVE 'GENSVEZNORCZ' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEZ-VEZ
           ELSE
               MOVE OPZ-NUM-DCOL IN OPZ TO FEC-DEC1
               MOVE OPZ-NUM-MCOL IN OPZ TO FEC-MEC1
               MOVE OPZ-NUM-SCOL IN OPZ TO FEC-SEC1
               MOVE OPZ-NUM-ACOL IN OPZ TO FEC-AEC1.
           MOVE RCZ-KEY-IVCT IN RCZ TO VEZ-KEY-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'GENSVEZNORCZ' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE VEZ-NUM-DVEN IN VEZ TO FEC-DEC2.
           MOVE VEZ-NUM-MVEN IN VEZ TO FEC-MEC2.
           MOVE VEZ-NUM-SVEN IN VEZ TO FEC-SEC2.
           MOVE VEZ-NUM-AVEN IN VEZ TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'GENSVEZ-DIA' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
       CON-GEN-SIG-VEZ-VEZ.
           MOVE VEZ-NUM-DVEN IN VEZ TO FEC-ITM1.
           MOVE VEZ-NUM-MVEN IN VEZ TO FEC-ITM2.
           MOVE VEZ-NUM-SVEN IN VEZ TO FEC-ITM3.
           MOVE VEZ-NUM-AVEN IN VEZ TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'GENSVEZ+DIA' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           IF OPZ-IND-AFER IN OPZ = 'S'
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-FBLK-N   TO FEC-FBLK
               MOVE FEC-CHOY-N   TO FEC-CHOY
               MOVE FEC-VHBL-S   TO FEC-VHBL
               MOVE FEC-VAL-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-FER
                   MOVE FEC-SIG-HBL  TO FEC-CMND
                   PERFORM CAL-FEC
                   IF FEC-STAT-OKS
                       NEXT SENTENCE
                   ELSE
                       MOVE 'GENSVEZSHBL' TO MSG-COD-MENS
                       GO TO FIN-GEN-SIG-VEZ-VEZ
               ELSE
               IF NOT FEC-STAT-OKS
                   MOVE 'GENSVEZVHBL' TO MSG-COD-MENS
                   GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE FEC-ITM1 TO VEZ-NUM-DVEN IN VEZ.
           MOVE FEC-ITM2 TO VEZ-NUM-MVEN IN VEZ.
           MOVE FEC-ITM3 TO VEZ-NUM-SVEN IN VEZ.
           MOVE FEC-ITM4 TO VEZ-NUM-AVEN IN VEZ.
           MOVE VEZ-FEC-FVEN IN VEZ TO VEZ-FEC-FIMV IN VEZ.
           IF VEZ-VAL-CAPI IN VEZ > OPZ-VAL-SCRE IN OPZ
               MOVE OPZ-VAL-SCRE IN OPZ TO VEZ-VAL-CAPI IN VEZ
               MOVE 0                   TO VEZ-VAL-FINA IN VEZ
               MOVE 'N'                 TO VEZ-IND-CALC IN VEZ.
           ADD 1                    TO VEZ-NUM-IVEN IN VEZ.
           MOVE VEZ-VAL-CAPI IN VEZ TO VEZ-VAL-SCAP IN VEZ.
           MOVE VEZ-VAL-FINA IN VEZ TO VEZ-VAL-SFIN IN VEZ.
           MOVE ZEROES              TO VEZ-VAL-IDNI IN VEZ.
           MOVE SPACES              TO VEZ-MSC-TACC IN VEZ.
           MOVE SPACES              TO VEZ-MSC-STAT IN VEZ.
           MOVE SPACES              TO VEZ-COD-OTRN IN VEZ.
           MOVE SPACES              TO VEZ-COD-ATRN IN VEZ.
           MOVE SPACES              TO VEZ-IND-SCTB IN VEZ.
           MOVE VEZ-NUM-IVEN IN VEZ TO VEZ-NUM-IVCT IN VEZ.
           MOVE SPACES              TO VEZ-IND-SCBZ IN VEZ.
           MOVE ZEROES              TO VEZ-VAL-MTSC IN VEZ.
           MOVE SPACES              TO VEZ-IND-MTSC IN VEZ.
           MOVE SPACES              TO VEZ-GLS-DISP IN VEZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'GENSVEZNOPUT' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NOGKU' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           ADD 1 TO OPZ-NUM-VCVG IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NOMOD' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE VEZ-NUM-IDLC IN VEZ TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'DLZ    NOGKU' TO MSG-COD-MENS
               GO TO FIN-GEN-SIG-VEZ-VEZ.
           MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FMAV IN DLZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NOMOD' TO MSG-COD-MENS.
       FIN-GEN-SIG-VEZ-VEZ.
           EXIT.
       PRO-OPE SECTION.
       INI-PRO-OPE.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-OPE.

           SUBTRACT CAZ-NUM-TVCC IN CAZ FROM OPZ-NUM-VCVG IN OPZ.
           IF OPZ-NUM-TVCC IN OPZ > ZEROES
               ADD CAZ-NUM-TVCC IN CAZ TO OPZ-NUM-TVCC IN OPZ
           ELSE
               ADD WSS-NUM-VCCM IN WSS-VARI TO OPZ-NUM-VCCM IN OPZ
               ADD WSS-NUM-VCCV IN WSS-VARI TO OPZ-NUM-VCCV IN OPZ
               ADD WSS-NUM-VCCO IN WSS-VARI TO OPZ-NUM-VCCO IN OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO VEZ-CIC-IOPC IN VEZ.
           IF NOT ( CAZ-MSC-FCAN IN CAZ = 'T' AND
                    CAZ-MSC-ECAN IN CAZ = 'T' )
              ADD CAZ-NUM-TVCC IN CAZ TO OPZ-NUM-IVEN IN OPZ
              IF OPZ-NUM-IVEN IN OPZ = ZEROES
                  MOVE 1 TO OPZ-NUM-IVEN IN OPZ.
           IF WSS-SGV-FINA(500) > OPZ-VAL-SCRE IN OPZ
               MOVE ZEROES TO OPZ-VAL-SCRE IN OPZ
           ELSE
               SUBTRACT WSS-SGV-FINA(500) FROM OPZ-VAL-SCRE IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    BCK' TO MSG-COD-MENS.
       FIN-PRO-OPE.
           EXIT.
       PRO-DOC SECTION.
       INI-PRO-DOC.
           IF WSS-SGV-CAPD(WSS-NUM-IDLC) = ZEROES
               PERFORM PRO-DVEG-DLZ
               GO TO FIN-PRO-DOC.
           MOVE WSS-NUM-IDLC TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC
               GO TO FIN-PRO-DOC.
           IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLZ-VAL-SDLC IN DLZ
               MOVE ZEROES TO DLZ-VAL-SDLC IN DLZ
           ELSE
               SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC)
                       FROM DLZ-VAL-SDLC IN DLZ.

           IF WSS-SGV-FINA(WSS-NUM-IDLC) > DLZ-VAL-SCPA IN DLZ
               MOVE ZEROES TO DLZ-VAL-SCPA IN DLZ
           ELSE
               SUBTRACT WSS-SGV-FINA(WSS-NUM-IDLC)
                   FROM DLZ-VAL-SCPA IN DLZ.
           MOVE WSS-FEC-FAMT TO DLZ-FEC-FAMT IN DLZ.
       SIG-PRO-DOC.
           IF SCR-CMND = 'REV'
               IF ( CAZ-MSC-FCAN IN CAZ = 'T' ) AND
                  ( CAZ-MSC-ECAN IN CAZ = 'E' ) AND
                  ( VEZ-IND-SCTB IN VEZ = 'MOR' )
                   PERFORM PRO-REV-RTZ-DLZ
               ELSE
                   NEXT SENTENCE
           ELSE
           IF ( SCR-CMND = 'CAN' OR SCR-CMND = 'CVC' ) AND
              ( VEZ-IND-SCTB IN VEZ = 'MOR' )
               PERFORM PRO-RTZ-DLZ.
           IF NOT ( SCR-CMND = 'CAN' OR
                    SCR-CMND = 'CVC')
               GO TO CON-PRO-DOC.
           MOVE DLZ-FEC-FDEV IN DLZ TO CAZ-FEC-FDVA IN CAZ.
           MOVE DLZ-VAL-SINT IN DLZ TO CAZ-VAL-SINA IN CAZ.
           MOVE VEZ-VAL-IDNI IN VEZ TO DLZ-VAL-SINT IN DLZ.
           IF CAZ-MSC-CANC IN CAZ = 'CTT'
               MOVE DLZ-FEC-FMAV IN DLZ TO DLZ-FEC-FDEV IN DLZ
           ELSE
           IF ( CAZ-MSC-FCAN IN CAZ = 'T' OR
                CAZ-MSC-FCAN IN CAZ = 'I' ) AND
                OPZ-NUM-VCOR IN OPZ = 1
               IF CAZ-FEC-FCAN IN CAZ < VEZ-FEC-FVEN IN VEZ
                   MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FDEV IN DLZ
               ELSE
               IF CAZ-FEC-FCAN IN CAZ NOT > DLZ-FEC-FDEV IN DLZ
                   NEXT SENTENCE
               ELSE
               MOVE CAZ-FEC-FCAN IN CAZ TO DLZ-FEC-FDEV IN DLZ
           ELSE
           IF CAZ-MSC-FCAN IN CAZ = 'T' OR
              CAZ-MSC-FCAN IN CAZ = 'I'
               MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FDEV IN DLZ.
       CON-PRO-DOC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC.
       FIN-PRO-DOC.
           EXIT.
       PRO-DVEG-DLZ SECTION.
       INI-PRO-DVEG-DLZ.
           MOVE WSS-NUM-IDLC TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 500 TO WSS-NUM-IDLC
               GO TO FIN-PRO-DVEG-DLZ.
           IF NOT ( SCR-CMND = 'CAN' OR
                    SCR-CMND = 'CVC')
               GO TO CON-PRO-DVEG-DLZ.
           MOVE DLZ-FEC-FDEV IN DLZ TO CAZ-FEC-FDVA IN CAZ.
           MOVE DLZ-VAL-SINT IN DLZ TO CAZ-VAL-SINA IN CAZ.
           MOVE VEZ-VAL-IDNI IN VEZ TO DLZ-VAL-SINT IN DLZ.
           IF CAZ-MSC-CANC IN CAZ = 'CTT'
               MOVE DLZ-FEC-FMAV IN DLZ TO DLZ-FEC-FDEV IN DLZ
           ELSE
           IF ( CAZ-MSC-FCAN IN CAZ = 'T' OR
                CAZ-MSC-FCAN IN CAZ = 'I' ) AND
                OPZ-NUM-VCOR IN OPZ = 1
               IF CAZ-FEC-FCAN IN CAZ < VEZ-FEC-FVEN IN VEZ
                   MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FDEV IN DLZ
               ELSE
               IF CAZ-FEC-FCAN IN CAZ NOT > DLZ-FEC-FDEV IN DLZ
                   NEXT SENTENCE
               ELSE
               MOVE CAZ-FEC-FCAN IN CAZ TO DLZ-FEC-FDEV IN DLZ
           ELSE
           IF CAZ-MSC-FCAN IN CAZ = 'T' OR
              CAZ-MSC-FCAN IN CAZ = 'I'
               MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FDEV IN DLZ.
       CON-PRO-DVEG-DLZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
       FIN-PRO-DVEG-DLZ.
           EXIT.
       PRO-RTZ-DLZ SECTION.
       INI-PRO-RTZ-DLZ.
       FIN-PRO-RTZ-DLZ.
           EXIT.
       PRO-REV-RTZ-DLZ SECTION.
       INI-PRO-REV-RTZ-DLZ.
       FIN-PRO-REV-RTZ-DLZ.
           EXIT.
       ACU-RTZ SECTION.
       INI-ACU-RTZ.
           MOVE SPACES                  TO RCZ-KEY-IRCV IN RCZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RCZ-CAI-IOPC IN RCZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RCZ-IIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO RCZ-NUM-ICAN IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    RCZ-CAI-IOPC IN RCZ = CAZ-CAI-IOPC IN CAZ-FLD AND
                    RCZ-IIC-IOPC IN RCZ = CAZ-IIC-IOPC IN CAZ-FLD AND
                    RCZ-NUM-ICAN IN RCZ = CAZ-NUM-ICAN IN CAZ-FLD )
               GO TO FIN-ACU-RTZ.
           MOVE RCZ-CIC-IOPC IN RCZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE RCZ-NUM-IDLC IN RCZ TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACU-RTZ.
           PERFORM LEE-RTZ-UPD.
           IF NOT FIO-STAT-OKS
              IF NOT (DLZ-IND-SCTB IN DLZ = SPACES)
                 GO TO FIN-ACU-RTZ
              ELSE
                 MOVE ZEROES TO RTZ-VAL-SRDT IN RTZ
                                RTZ-VAL-SINT IN RTZ
                                RTZ-VAL-SCOT IN RTZ.
           MOVE 'RDT   ' TO WSS-IND-TTAS.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE WSS-CAN-NUM-ICAN        TO ICZ-NUM-ICAN IN ICZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPV IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPV IN ICZ.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE ZEROES TO WSS-COM-NUM-IVCT
           ELSE
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT.
           MOVE WSS-COM-NUM-IVCT    TO ICZ-NUM-IVCT IN ICZ.
           MOVE WSS-IND-TTAS        TO ICZ-IND-TTAS IN ICZ.
           MOVE ZEROES              TO ICZ-FEC-FINI IN ICZ.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-ACU-RTZ.
           PERFORM CBZ-FIO-ICZ.
           IF NOT ( FIO-STAT-OKS AND
               CAZ-CAI-IOPC IN CAZ-FLD = ICZ-CAI-IOPC IN ICZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = ICZ-IIC-IOPC IN ICZ AND
               WSS-CAN-NUM-ICAN        = ICZ-NUM-ICAN IN ICZ AND
               CAZ-CAI-IOPC IN CAZ-FLD = ICZ-CAI-IOPV IN ICZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = ICZ-IIC-IOPV IN ICZ AND
               WSS-COM-NUM-IVCT        = ICZ-NUM-IVCT IN ICZ AND
               WSS-GLS-NTAS            = ICZ-GLS-NTAS IN ICZ )
               GO TO ACT-ACU-RTZ.
           IF ICZ-IND-TTAS IN ICZ = 'RDTCAP'
              ADD ICZ-SGV-MNTO IN ICZ TO RTZ-VAL-SRDT IN RTZ
           ELSE
           IF ICZ-IND-TTAS IN ICZ = 'RDTINT'
              ADD ICZ-SGV-MNTO IN ICZ TO RTZ-VAL-SINT IN RTZ
           ELSE
           IF ICZ-IND-TTAS IN ICZ = 'RDTCOM'
              ADD ICZ-SGV-MNTO IN ICZ TO RTZ-VAL-SCOT IN RTZ.
       NXT-ACU-RTZ.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           GO TO LUP-ACU-RTZ.
       ACT-ACU-RTZ.
           IF DLZ-IND-SCTB IN DLZ = SPACES
              IF RTZ-VAL-SRDT IN RTZ > ZEROES
                 MOVE RTZ-VAL-SRDT IN RTZ TO RTZ-VAL-MRDT IN RTZ
                 MOVE RTZ-VAL-SINT IN RTZ TO RTZ-VAL-MINT IN RTZ
                 MOVE RTZ-VAL-SCOT IN RTZ TO RTZ-VAL-MCOT IN RTZ
                 MOVE RCZ-CIC-IOPC IN RCZ TO RTZ-CIC-IOPC IN RTZ
                 MOVE RCZ-NUM-IDLC IN RCZ TO RTZ-NUM-IDLC IN RTZ
                 MOVE 'MOR'               TO RTZ-IND-SCTB IN RTZ
                 PERFORM GET-FHOY
                 MOVE HOY-STP-ITRN TO RTZ-STP-ITRN IN RTZ
                 MOVE FIO-GET-KEY-UPD TO FIO-CMND
                 PERFORM CBZ-FIO-DLZ
                 MOVE 'MOR'       TO DLZ-IND-SCTB IN DLZ
                 MOVE FIO-MOD     TO FIO-CMND
                 PERFORM CBZ-FIO-DLZ
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM CBZ-FIO-RTZ
              ELSE
                 GO TO FIN-ACU-RTZ
           ELSE
              MOVE FIO-MOD TO FIO-CMND
              PERFORM CBZ-FIO-RTZ.
       FIN-ACU-RTZ.
           EXIT.
       REV-RTZ SECTION.
       INI-REV-RTZ.
           MOVE SPACES                  TO RCZ-KEY-IRCV IN RCZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RCZ-CAI-IOPC IN RCZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RCZ-IIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO RCZ-NUM-ICAN IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    RCZ-CAI-IOPC IN RCZ = CAZ-CAI-IOPC IN CAZ-FLD AND
                    RCZ-IIC-IOPC IN RCZ = CAZ-IIC-IOPC IN CAZ-FLD AND
                    RCZ-NUM-ICAN IN RCZ = CAZ-NUM-ICAN IN CAZ-FLD )
               GO TO FIN-REV-RTZ.
           MOVE RCZ-CIC-IOPC IN RCZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE RCZ-NUM-IDLC IN RCZ TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-REV-RTZ.
           IF DLZ-IND-SCTB IN DLZ = SPACES
              GO TO FIN-REV-RTZ.
           PERFORM LEE-RTZ-UPD.
           IF NOT FIO-STAT-OKS
              GO TO FIN-REV-RTZ.
           MOVE 'RDT   ' TO WSS-IND-TTAS.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPC IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPC IN ICZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO ICZ-NUM-ICAN IN ICZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ICZ-CAI-IOPV IN ICZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ICZ-IIC-IOPV IN ICZ.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE ZEROES TO WSS-COM-NUM-IVCT
           ELSE
                MOVE VEZ-NUM-IVEN IN CAZ-FLD TO WSS-COM-NUM-IVCT.
           MOVE WSS-COM-NUM-IVCT    TO ICZ-NUM-IVCT IN ICZ.
           MOVE WSS-IND-TTAS        TO ICZ-IND-TTAS IN ICZ.
           MOVE ZEROES              TO ICZ-FEC-FINI IN ICZ.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-REV-RTZ.
           PERFORM CBZ-FIO-ICZ.
           IF NOT ( FIO-STAT-OKS AND
               CAZ-CAI-IOPC IN CAZ-FLD = ICZ-CAI-IOPC IN ICZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = ICZ-IIC-IOPC IN ICZ AND
               CAZ-NUM-ICAN IN CAZ-FLD = ICZ-NUM-ICAN IN ICZ AND
               CAZ-CAI-IOPC IN CAZ-FLD = ICZ-CAI-IOPV IN ICZ AND
               CAZ-IIC-IOPC IN CAZ-FLD = ICZ-IIC-IOPV IN ICZ AND
               WSS-COM-NUM-IVCT        = ICZ-NUM-IVCT IN ICZ AND
               WSS-GLS-NTAS            = ICZ-GLS-NTAS IN ICZ )
               GO TO ACT-REV-RTZ.
           IF ICZ-IND-TTAS IN ICZ = 'RDTCAP'
              SUBTRACT ICZ-SGV-MNTO IN ICZ FROM RTZ-VAL-SRDT IN RTZ
           ELSE
           IF ICZ-IND-TTAS IN ICZ = 'RDTINT'
              SUBTRACT ICZ-SGV-MNTO IN ICZ FROM RTZ-VAL-SINT IN RTZ
           ELSE
           IF ICZ-IND-TTAS IN ICZ = 'RDTCOM'
              SUBTRACT ICZ-SGV-MNTO IN ICZ FROM RTZ-VAL-SCOT IN RTZ.
       NXT-REV-RTZ.
           MOVE FIO-GET-NXT  TO FIO-CMND.
           GO TO LUP-REV-RTZ.
       ACT-REV-RTZ.
           IF DLZ-IND-SCTB IN DLZ = 'MOR' AND
              RTZ-VAL-SRDT IN RTZ = ZEROES
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM CBZ-FIO-DLZ
              MOVE SPACES TO DLZ-IND-SCTB IN DLZ
              MOVE FIO-MOD TO FIO-CMND
              PERFORM CBZ-FIO-DLZ
              MOVE FIO-DEL TO FIO-CMND
           ELSE
              MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
       FIN-REV-RTZ.
           EXIT.
       LEE-RTZ-UPD SECTION.
       INI-LEE-RTZ-UPD.
           MOVE RCZ-CIC-IOPC IN RCZ TO RTZ-CIC-IOPC IN RTZ.
           MOVE RCZ-NUM-IDLC IN RCZ TO RTZ-NUM-IDLC IN RTZ.
           MOVE DLZ-IND-SCTB IN DLZ TO RTZ-IND-SCTB IN RTZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RTZ.
       FIN-LEE-RTZ-UPD.
           EXIT
