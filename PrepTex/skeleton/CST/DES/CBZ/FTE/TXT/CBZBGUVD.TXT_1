       BUS-UVD SECTION.
       INI-BUS-UVD.
           MOVE 0 TO UVD-NVEM.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO UVD-SIND IN UVD.
           MOVE ZEROES TO DLZ-TAB-IVEN IN UVD.
           MOVE ZEROES TO UVD-FEC-FVEN IN UVD.
           MOVE UVD-CAI-IOPC IN UVD TO OPZ-CAI-IOPC IN OPZ.
           MOVE UVD-IIC-IOPC IN UVD TO OPZ-IIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'UVD    NOOPZ' TO MSG-COD-MENS
               GO TO FIN-BUS-UVD.
           PERFORM GET-DLZ.
           IF NOT FIO-STAT-OKS
               MOVE 'UVD    NODLZ' TO MSG-COD-MENS
               GO TO FIN-BUS-UVD.
           IF DLZ-NUM-IDLC IN DLZ > 100
               MOVE 'NUMIDLZIMAX>' TO MSG-COD-MENS
               GO TO FIN-BUS-UVD.
           MOVE DLZ-NUM-IDLC IN DLZ TO UVD-IMAX IN UVD.
           PERFORM BUS-VEZ-FEVD.
       FIN-BUS-UVD.
           EXIT.

       BUS-VEZ-FEVD SECTION.
       INI-BUS-VEZ-FEVD.
           PERFORM GET-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE 'UVD    NOVEZ' TO MSG-COD-MENS
               GO TO FIN-BUS-VEZ-FEVD.
           MOVE VEZ-NUM-IVEN IN VEZ TO UVD-JMAX IN UVD.
           IF UVD-IMAX IN UVD = 1 AND UVD-JMAX IN UVD NOT < 1
               MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FVEN IN UVD(1)
               GO TO FIN-BUS-VEZ-FEVD.
           IF UVD-IMAX IN UVD > 1 AND UVD-JMAX IN UVD = 1
               PERFORM MOV-VEZ-FEVD VARYING UVD-I FROM 1 BY 1 UNTIL
                       UVD-I IN UVD > UVD-IMAX
               GO TO FIN-BUS-VEZ-FEVD.
           IF VEZ-NUM-IDLC IN VEZ = ZEROES
               MOVE VEZ-NUM-IVCT IN VEZ TO VEZ-NUM-IDLC IN VEZ.
       NXT-BUS-VEZ-FEVD.
           MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FVEN IN
                               UVD(VEZ-NUM-IDLC IN VEZ).
           ADD 1 TO UVD-K IN UVD.
           IF UVD-K IN UVD = UVD-IMAX IN UVD
               GO TO FIN-BUS-VEZ-FEVD.
       LUP-BUS-VEZ-FEVD.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    UVD-CAI-IOPC IN UVD = VEZ-CAI-IOPC IN VEZ AND
                    UVD-IIC-IOPC IN UVD = VEZ-IIC-IOPC IN VEZ )
               GO TO FIN-BUS-VEZ-FEVD.
           IF VEZ-NUM-IDLC IN VEZ = ZEROES
               MOVE VEZ-NUM-IVCT IN VEZ TO VEZ-NUM-IDLC IN VEZ.
           IF DLZ-FEC-FVEN IN UVD(VEZ-NUM-IDLC) > ZEROES
               GO TO LUP-BUS-VEZ-FEVD
           ELSE
               GO TO NXT-BUS-VEZ-FEVD.
       FIN-BUS-VEZ-FEVD.
           EXIT.

       GET-DLZ SECTION.
       INI-GET-DLZ.
           MOVE UVD-CAI-IOPC IN UVD TO DLZ-CAI-IOPC IN DLZ.
           MOVE UVD-IIC-IOPC IN UVD TO DLZ-IIC-IOPC IN DLZ.
           MOVE 999            TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
                    UVD-CAI-IOPC IN UVD = DLZ-CAI-IOPC IN DLZ AND
                    UVD-IIC-IOPC IN UVD = DLZ-IIC-IOPC IN DLZ )
               MOVE '23' TO FIO-STAT.
       FIN-GET-DLZ.
           EXIT.

       GET-VEZ SECTION.
       INI-GET-VEZ.
           MOVE UVD-CAI-IOPC IN UVD TO VEZ-CAI-IOPC IN VEZ.
           MOVE UVD-IIC-IOPC IN UVD TO VEZ-IIC-IOPC IN VEZ.
           MOVE 999                 TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    UVD-CAI-IOPC IN UVD = VEZ-CAI-IOPC IN VEZ AND
                    UVD-IIC-IOPC IN UVD = VEZ-IIC-IOPC IN VEZ )
               MOVE '23' TO FIO-STAT.
       FIN-GET-VEZ.
           EXIT.


       MOV-VEZ-FEVD SECTION.
       INI-MOV-VEZ-FEVD.
           MOVE VEZ-FEC-FVEN IN VEZ TO DLZ-FEC-FVEN IN UVD(UVD-I).
       FIN-MOV-VEZ-FEVD.
           EXIT.
