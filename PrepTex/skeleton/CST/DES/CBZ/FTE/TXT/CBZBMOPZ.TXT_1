*%! Codigo adicional para archivo
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                      ORIENTADO AL INGRESO
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*% IF INI_VAL_NUM_FLD_OPZ
      *<<<< INI_VAL_NUM_FLD_OPZ
           IF COZ-SGV-TINT-ALF > SPACES
               MOVE 'N' TO FRM-IND-PVEZ-OPZ
           ELSE
               MOVE SPACES TO FRM-IND-PVEZ-OPZ.
           IF FRM-SGV-TFLV-ALF > SPACES
               MOVE 'N' TO FRM-IND-PVEZ-CAZ
           ELSE
               MOVE SPACES TO FRM-IND-PVEZ-CAZ.
      *>>>>
*% END
*% IF FIN_KEY_OPZ_OPZ
      *<<<< FIN_KEY_OPZ_OPZ
           IF SCR-CCPP = 'ING'
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO OPZ-COD-TOOC IN OPZ
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ
               MOVE OPZ-COD-AOOC IN OPZ-FLD TO OPZ-COD-AOOC IN OPZ.
      *>>>>
*% END
*% IF FIN_CLR_KEY_OPZ
      *<<<< FIN_CLR_KEY_OPZ
           IF SCR-CCPP = 'ING'
               MOVE SPACES TO OPZ-COD-TOOC IN OPZ-FLD
               MOVE SPACES TO OPZ-COD-VCOC IN OPZ-FLD
               MOVE SPACES TO OPZ-COD-AOOC IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_CLR_OPZ_OPZ
      *<<<< INI_CLR_OPZ_OPZ
           IF SCR-CCPP = 'ING'
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO OPZ-COD-TOOC IN OPZ
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ
               MOVE OPZ-COD-AOOC IN OPZ-FLD TO OPZ-COD-AOOC IN OPZ.
      *>>>>
*% END
*% IF FIN_CLR_OPZ_OPZ
      *<<<< FIN_CLR_OPZ_OPZ
           IF SCR-CCPP = 'ING'
               MOVE OPZ-COD-TOOC IN OPZ TO OPZ-COD-TOOC IN OPZ-FLD
               MOVE OPZ-COD-VCOC IN OPZ TO OPZ-COD-VCOC IN OPZ-FLD
               MOVE OPZ-COD-AOOC IN OPZ TO OPZ-COD-AOOC IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_CLR_DBC_OPZ
      *<<<< INI_CLR_DBC_OPZ
           IF SCR-CCPP = 'ING'
               MOVE SPACES TO DBC-GLS-NOMC IN OPZ-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_FST_KEY_OPZ
      *<<<< INI_FST_KEY_OPZ
           IF SCR-CCPP = 'ING'
               MOVE -1 TO OPZ-COD-VCOC-LEN IN OPZ-FLD
               MOVE  0 TO OPZ-CAI-IOPC-LEN IN OPZ-FLD
               GO TO FIN-FST-KEY-OPZ.
      *>>>>
*% END
*% IF INI_FST_FLD_OPZ
      *<<<< INI_FST_FLD_OPZ
           IF SCR-CCPP = 'ING'
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPZ-FLD
               MOVE  0 TO OPZ-COD-VCOC-LEN IN OPZ-FLD
               GO TO FIN-FST-FLD-OPZ.
      *>>>>
*% END
*% IF INI_PRO_IKY_OPZ
      *<<<< INI_PRO_IKY_OPZ
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO OPZ-COD-TOOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-VCOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_UNP_IKY_OPZ
      *<<<< INI_UNP_IKY_OPZ
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-UBY TO OPZ-COD-TOOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-UBY TO OPZ-COD-VCOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-UBY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF FIN_UNP_FLD_OPZ
      *<<<< FIN_UNP_FLD_OPZ
      *>>>>
*% END
*% IF FIN_UNP_OPZ_OPZ
      *<<<< FIN_UNP_OPZ_OPZ
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO OPZ-COD-TOOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-VCOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_VAL_IKY_OPZ
      *<<<< INI_VAL_IKY_OPZ
           IF SCR-CCPP NOT = 'ING'
               GO TO CON-VAL-IKY-OPZ.
           PERFORM VAL-OPZ-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-COD-TOOC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-OPZ-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-CAI-IOPC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-OPZ-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-IIC-IOPC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-CAZ-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAZ-CAI-IOPC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-CAZ-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAZ-IIC-IOPC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-OPZ-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-COD-VCOC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           PERFORM VAL-OPZ-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-COD-AOOC-LEN IN OPZ-FLD
                GO TO FIN-VAL-IKY-OPZ.
           GO TO FIN-VAL-IKY-OPZ.
       CON-VAL-IKY-OPZ.
      *>>>>
*% END
*% IF OPZ_IIC_IOPC
      *<<<< OPZ_IIC_IOPC
           IF SCR-CCPP = 'ING' AND OPZ-IIC-IOPC IN OPZ-FLD > ZEROES
               MOVE OPZ-CAI-IOPC IN OPZ-FLD TO WSS-CAI-ICIC IN WSS-VARI
               IF WSS-COD-TCIC IN WSS-VARI NOT = 'Z'
                   MOVE 'CBZ' TO MSG-COD-SIST
                   MOVE 'OPZCAIINV' TO MSG-COD-MENS            
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-OPZ-IIC-IOPC.
      *>>>>
*% END
*% IF EOF AND PGM_BQ
      *<<<< EOF AND PGM_BQ
       VAL-OPZ-COD-TOOC SECTION.
       INI-VAL-OPZ-COD-TOOC.
           IF OPZ-COD-TOOC IN OPZ-FLD NOT > SPACES
              MOVE SPACES TO OPZ-COD-TOOC IN OPZ-FLD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OPZ-COD-TOOC IN OPZ-FLD > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TOOC IN OPZ-FLD
           ELSE
               PERFORM CLR-FLD-OPZ
               PERFORM EDT-FLD-OPZ
               MOVE SPACES TO FRM-GLS-TOOC IN OPZ-FLD.
       FIN-VAL-OPZ-COD-TOOC.
           EXIT.

       VAL-OPZ-COD-VCOC SECTION.
       INI-VAL-OPZ-COD-VCOC.
           IF OPZ-COD-VCOC IN OPZ-FLD NOT > SPACES
              MOVE SPACES TO OPZ-COD-VCOC IN OPZ-FLD.
      *<<<< OPZ_COD_VCOC
           IF OPZ-COD-VCOC IN OPZ-FLD NOT > SPACES
               PERFORM CLR-FLD-OPZ
               PERFORM EDT-FLD-OPZ
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CODVCOCBLK' TO MSG-COD-MENS            
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-COD-VCOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OPZ-COD-VCOC IN OPZ-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN OPZ-FLD
           ELSE
               PERFORM CLR-FLD-OPZ
               PERFORM EDT-FLD-OPZ
               MOVE SPACES TO FRM-GLS-VCOC IN OPZ-FLD.
       FIN-VAL-OPZ-COD-VCOC.
           EXIT.

       VAL-OPZ-COD-AOOC SECTION.
       INI-VAL-OPZ-COD-AOOC.
           IF OPZ-COD-AOOC IN OPZ-FLD NOT > SPACES
              MOVE SPACES TO OPZ-COD-AOOC IN OPZ-FLD.
      *<<<< OPZ_COD_AOOC
      *VAL-COD Valida codigo de tabla
           MOVE 'CBZ'                    TO TAB-COD-SIST.
           MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-TOOC IN OPZ-FLD  TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPZ-COD-AOOC IN OPZ-FLD  TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OPZ-COD-AOOC IN OPZ-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN OPZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN OPZ-FLD.
      *<<<<
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-OPZ-COD-AOOC.

           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                  TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'POC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-OPZ
               GO TO END-VAL-OPZ-COD-AOOC.
           IF POZ-MSC-STAT IN POZ = 'N'
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'POC    NVG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM EDT-FLD-OPZ
               GO TO END-VAL-OPZ-COD-AOOC.
           MOVE SPACES              TO SCR-IND-OPEE.
           MOVE POZ-IND-VSTR IN POZ TO OPZ-IND-VSTR IN OPZ-FLD.
           MOVE POZ-IND-PORC IN POZ TO SCR-IND-PORC.
           MOVE POZ-IND-TCBZ IN POZ TO OPZ-IND-TCBZ IN OPZ-FLD.
           MOVE POZ-IND-AFER IN POZ TO OPZ-IND-AFER IN OPZ-FLD.
           IF POZ-IND-RENO IN POZ > SPACES
               MOVE POZ-IND-RENO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S          TO NUM-ZERO
               MOVE NUM-SGNO-N          TO NUM-SGNO
               MOVE 3                   TO NUM-NENT
               MOVE 0                   TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NOT NUM-STAT-OKS
                   MOVE POZ-IND-RENO IN POZ TO OPZ-IND-RENO IN OPZ-FLD.


           MOVE POZ-COD-PLCO IN POZ TO OPZ-COD-PLCO IN OPZ-FLD.
           MOVE POZ-COD-PLIM IN POZ TO OPZ-COD-PLIM IN OPZ-FLD.
           IF POZ-IND-TABO IN POZ > SPACES
               MOVE POZ-IND-TABO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S          TO NUM-ZERO
               MOVE NUM-SGNO-N          TO NUM-SGNO
               MOVE 5                   TO NUM-NENT
               MOVE 0                   TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NOT NUM-STAT-OKS
                   MOVE POZ-IND-TABO IN POZ TO CYZ-IND-TCYA IN OPZ-FLD.


           MOVE SPACES TO WSS-MSC-TCAN.

           IF SCR-CCPP NOT = 'ING'
               GO TO NOT-PRO-ROV.
           IF OPZ-IIC-IOPC IN OPZ-FLD  > ZEROES
               MOVE OPZ-CAI-IOPC IN OPZ-FLD TO OPZ-CAI-IOPC IN OPZ
               MOVE OPZ-IIC-IOPC IN OPZ-FLD TO OPZ-IIC-IOPC IN OPZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               IF FIO-STAT-OKS
                   MOVE 'GNS'        TO MSG-COD-SIST
                   MOVE 'REGEXI'     TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC.
      
           IF CAZ-IIC-IOPC IN OPZ-FLD > ZEROES
               MOVE CAZ-CAI-IOPC IN OPZ-FLD TO CAZ-CAI-IOPC IN CAZ
               MOVE CAZ-IIC-IOPC IN OPZ-FLD TO CAZ-IIC-IOPC IN CAZ
               MOVE CAZ-NUM-ICAN IN OPZ-FLD TO CAZ-NUM-ICAN IN CAZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               MOVE FIO-STAT TO PGM-STAT-CAZ
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'NOV    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
               ELSE
               IF NOT ( CAZ-MSC-STAT IN CAZ = 'C' OR 'W' OR 'P' )
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'NOVSTATINV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
                ELSE
                  IF ( CAZ-MSC-CANC IN CAZ = 'JTT' AND
                       POZ-IND-SCTB IN POZ NOT = 'JUD')
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'CANJUDNOPOC=' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-OPZ-COD-AOOC
                  ELSE
                   MOVE ZEROES               TO WSS-SGV-RENO
                   PERFORM BUS-CNC
                    IF WSS-MSC-TCAN = 'R'
                       NEXT SENTENCE
                   ELSE
                    GO TO ING-NOV.

           IF OPZ-IIC-IOPC IN OPZ-FLD NOT > ZEROES
               GO TO NOT-PRO-ROV.

           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO ROZ-CAI-IOPC IN ROZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO ROZ-IIC-IOPC IN ROZ.
           MOVE LOW-VALUES              TO ROZ-KEY-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CAI-IOPC IN OPZ-FLD = ROZ-CAI-IOPC IN ROZ AND
                    OPZ-IIC-IOPC IN OPZ-FLD = ROZ-IIC-IOPC IN ROZ )
                      GO TO NOT-PRO-ROV.

           MOVE ZEROES TO WSS-TOT-RCAN.

           MOVE ZEROES TO WSS-SGV-RENO.

           PERFORM BUS-COD-PESO.

       CIC-RCAN.
           MOVE ROZ-KEY-IVCT IN ROZ TO CAZ-KEY-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF FIO-STAT-OKS AND
              ( CAZ-MSC-STAT IN CAZ = 'C' OR 'W' OR 'P' )
               MOVE CAZ-KEY-ICAN TO RCAN-CAN-KEY-ICAN
               ADD 1 TO WSS-TOT-RCAN
               MOVE ROZ-COD-VCVR IN ROZ TO WSS-COD-VCOC-CNV
               MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV
               PERFORM CONVIERTE-VALOR
               IF MSG-COD-MENS > SPACES
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
               ELSE
                   ADD WSS-SGV-RENO-CNV TO WSS-SGV-RENO.
           IF ( CAZ-MSC-CANC IN CAZ = 'JTT' AND
                POZ-IND-SCTB IN POZ NOT = 'JUD')
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'CANJUDNOPOC=' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO END-VAL-OPZ-COD-AOOC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              OPZ-CAI-IOPC IN OPZ-FLD = ROZ-CAI-IOPC IN ROZ AND
              OPZ-IIC-IOPC IN OPZ-FLD = ROZ-IIC-IOPC IN ROZ
                GO TO CIC-RCAN.

           IF WSS-TOT-RCAN = ZEROES
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CANREN NEX' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC   TO WSS-CPT-DESC
               MOVE WSS-CIC-IOPV   TO WSS-CPT-IOPV
               MOVE MSG-GLS-DATA   TO WSS-CPT-DATA
               MOVE WSS-CPT-NOMB-R TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN       TO FRM-MENS


               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.

      *    RECUPERA ULTIMA CANCELACION CON STATUS 'C' O 'W'
           MOVE RCAN-CAN-KEY-ICAN TO CAZ-KEY-ICAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.

           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           MOVE FIO-STAT TO PGM-STAT-OPZ.

           IF WSS-TOT-RCAN > 1
               MOVE 'MULT' TO CAZ-CAI-IOPC IN OPZ-FLD
               MOVE ZEROES TO CAZ-IIC-IOPC IN OPZ-FLD
               MOVE ZEROES TO CAZ-NUM-ICAN IN OPZ-FLD
           ELSE
               MOVE CAZ-CAI-IOPC IN CAZ TO CAZ-CAI-IOPC IN OPZ-FLD
               MOVE CAZ-IIC-IOPC IN CAZ TO CAZ-IIC-IOPC IN OPZ-FLD
               MOVE CAZ-NUM-ICAN IN CAZ TO CAZ-NUM-ICAN IN OPZ-FLD.

       ING-NOV.
           MOVE CAZ-COD-OFCA IN CAZ TO OPZ-COD-OFOC IN OPZ-FLD.
      *BUS-OFI busca oficina en tablas
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN OPZ-FLD.

           MOVE CAZ-NUM-SCAN IN CAZ TO OPZ-NUM-SCOL IN OPZ-FLD.
           MOVE CAZ-NUM-ACAN IN CAZ TO OPZ-NUM-ACOL IN OPZ-FLD.
           MOVE CAZ-NUM-MCAN IN CAZ TO OPZ-NUM-MCOL IN OPZ-FLD.
           MOVE CAZ-NUM-DCAN IN CAZ TO OPZ-NUM-DCOL IN OPZ-FLD.
           MOVE WSS-SGV-RENO        TO ROZ-SGV-RENO IN OPZ-FLD.
           IF WSS-MSC-TCAN NOT > SPACES
               PERFORM BUS-CNC.
           IF NOT (WSS-MSC-TCAN = 'N' OR WSS-MSC-TCAN = 'R' OR
                   WSS-MSC-TCAN = 'P')
               GO TO NO-RPN.

           IF   POZ-COD-COTO IN POZ = 'LAC' AND
              ( OPZ-IND-RENO IN OPZ-FLD = 'REN' OR 'NOV' )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'LDARENYNOVNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.

      * Leo la OPZ del credito a novar, renovar o prorrogar
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'OPZ    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPZ-CIC-IOPC IN OPZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.

      * Solo si se trata de una Prorroga Valido que la Moneda sea igual
      * en el Nuevo credito y en el credito Prorrogado
      * Ademas, se valida que este permitida la prorroga en base a TIO-AUX
      * de ambos creditos, el nuevo y el prorrogado
           IF NOT ( CAZ-MSC-TCAN IN CAZ = 'P' OR 'J' )
               GO TO FIN-VAL-PRO-VCOC-COOC.
      * Valido del la Moneda sea igual en ambos creditos
           IF OPZ-COD-VCOC IN OPZ NOT = OPZ-COD-VCOC IN OPZ-FLD
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'PROVCOC  NEQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPZ-COD-VCOC IN OPZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.

           IF OPZ-COD-TOOC IN OPZ-FLD = OPZ-COD-TOOC IN OPZ AND
              OPZ-COD-AOOC IN OPZ-FLD = OPZ-COD-AOOC IN OPZ
               GO TO FIN-VAL-PRO-VCOC-COOC.

      * Accesa tabla para verificar si la prorroga esta autorizada.
      * La primera vez, accesa con AUX genericos.

           MOVE SPACES TO WSS-KEY-CRP1.

           MOVE OPZ-COD-TOOC IN OPZ     TO WSS-TIO-ANT1.
           MOVE '*'                     TO WSS-AUX-ANT1.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-TIO-NUE1.
           MOVE '*'                     TO WSS-AUX-NUE1.

           MOVE 'CBZ'        TO FIO-SIST.
           MOVE 'CRP'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-KEY-CRP1 TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND ( TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-PRO-VCOC-COOC.

      * Accesa tabla para verificar si la prorroga esta autorizada.
      * La segunda vez, accesa con AUX especificos.

           MOVE OPZ-COD-TOOC IN OPZ     TO WSS-TIO-ANT2.
           MOVE OPZ-COD-AOOC IN OPZ     TO WSS-AUX-ANT2.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-TIO-NUE2.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO WSS-AUX-NUE2.

           MOVE 'CBZ'        TO FIO-SIST.
           MOVE 'CRP'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-KEY-CRP2 TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND ( TAB-MSC-STAT IN TAB = 'S' ) )
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'PROCOOC  NEQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPZ-COD-COOC IN OPZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.
       FIN-VAL-PRO-VCOC-COOC.
           IF WSS-MSC-TCAN = 'N'
               MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV
           ELSE
               MOVE WSS-SGV-RENO        TO WSS-SGV-RENO-CNV
               GO TO FIN-CNV.

           PERFORM BUS-COD-PESO.

      *Determina si es moneda nacional, si es asi el monto en la
      *entidad CAN esta expresado en aquella moneda nacional
      *cuyo cic es 0999.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-VCOC IN OPZ TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO TAB-GLS-DAT1 IN TAB
               IF TAB-COD-DAT1 IN TAB(1) = '0'
                   MOVE WSS-COD-PESO TO OPZ-COD-VCOC IN OPZ.

           IF OPZ-COD-VCOC IN OPZ = OPZ-COD-VCOC IN OPZ-FLD
               GO TO FIN-CNV.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ 
               NEXT SENTENCE
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
               ELSE
                   MULTIPLY WSS-SGV-RENO-CNV BY CAM-SGV-VCAM IN CAM
                            GIVING WSS-SGV-RENO-CNV ROUNDED
                   MOVE WSS-COD-PESO      TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-RENO-CNV  TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-CNV.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ-FLD
               GO TO FIN-CNV.

           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(1)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(1)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(1)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(2)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(2)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(2)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(2)
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY  TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CAM    NVG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC
           ELSE
               DIVIDE WSS-SGV-RENO-CNV BY CAM-SGV-VCAM IN CAM
                      GIVING WSS-SGV-RENO-CNV ROUNDED
               MOVE OPZ-COD-VCOC IN OPZ-FLD
                                        TO PES-COD-VCAM IN PES-VARI
               MOVE WSS-SGV-RENO-CNV    TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-CNV.
       FIN-CNV.
           MOVE WSS-SGV-RENO-CNV TO OPZ-VAL-CRED IN OPZ-FLD.

       NO-RPN.
           IF NOT (( WSS-MSC-TCAN = 'R' AND 
                     CAZ-MSC-TCAN IN CAZ NOT = '1') OR
                     WSS-MSC-TCAN = 'P')
               GO TO NOT-PRO-ROV.
           PERFORM GET-CUR-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'RDZ    INCKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-OPZ-COD-AOOC.
           PERFORM GET-NXT-RDZ.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M' TO DBC-IND-ICLI IN OPZ-FLD
               PERFORM PUT-RDZ-OPZ
               PERFORM PUT-DBC-OPZ
           ELSE
               PERFORM PUT-RDZ-OPZ
               MOVE RDZ-CIC-ICLI IN RDZ TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'RDZ    NOCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-OPZ-COD-AOOC
               ELSE
                   PERFORM PUT-DBC-OPZ.
       NOT-PRO-ROV.
       END-VAL-OPZ-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL
               PERFORM CLR-FLD-OPZ
               PERFORM EDT-FLD-OPZ.
      *>>>>
       FIN-VAL-OPZ-COD-AOOC.
           EXIT.
       BUS-CNC SECTION.
       INI-BUS-CNC.
           MOVE SPACES              TO TAB WSS-MSC-TCAN SCR-MSC-TCAN.
           MOVE 'CBZ'               TO TAB-COD-SIST.
           MOVE 'CNC'               TO TAB-COD-TTAB IN TAB.
           MOVE CAZ-MSC-CANC IN CAZ TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-ABRV IN TAB TO OPZ-IND-RENO IN OPZ-FLD.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-MSC-TCAN SCR-MSC-TCAN.
       FIN-BUS-CNC.
           EXIT.

*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                           IMPORTANTE
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%! La siguiente seccion ( PRO-FLD-OPZ ) y sus secciones asociadas se 
*%! extraen directamente del modulo CBZBUOPZ.SRCAIU, por lo tanto dicho 
*%! codigo debe actualizarse cada vez que se agrega o se elimina un 
*%! campo de la pantalla OPZ.
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

       
       PRO-FLD-OPZ SECTION.
       INI-PRO-FLD-OPZ.
           MOVE FRM-CPIM-AEY TO FRM-SGV-TFLV-ATR IN OPZ-FLD.
           PERFORM PRO-OPZ-OPZ.
           PERFORM PRO-CAZ-OPZ.
           PERFORM PRO-DBC-OPZ.
           PERFORM PRO-RDZ-OPZ.
           PERFORM PRO-ROZ-OPZ.
           PERFORM PRO-COZ-OPZ.
           PERFORM PRO-CYZ-OPZ.
           PERFORM PRO-AUZ-OPZ.
       FIN-PRO-FLD-OPZ.
           EXIT.
       
       PRO-OPZ-OPZ SECTION.
       INI-PRO-OPZ-OPZ.
           MOVE FRM-CPIM-AEY TO OPZ-COD-VCOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-TOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-RMOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-VAL-CRED-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-OFOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-OFOP-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-NUM-NPLA-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-NUM-VCOR-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-VAL-GAST-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-FEC-FCOL-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-FEC-FING-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-PLCO-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-SGV-VCOM-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-PLIM-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-IND-TCBZ-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-IND-AFER-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-SGV-LIQU-ATR IN OPZ-FLD.
       FIN-PRO-OPZ-OPZ.
           EXIT.
       
       PRO-CAZ-OPZ SECTION.
       INI-PRO-CAZ-OPZ.
       FIN-PRO-CAZ-OPZ.
           EXIT.
       
       PRO-DBC-OPZ SECTION.
       INI-PRO-DBC-OPZ.
       FIN-PRO-DBC-OPZ.
           EXIT.
       
       PRO-RDZ-OPZ SECTION.
       INI-PRO-RDZ-OPZ.
           MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD.
       FIN-PRO-RDZ-OPZ.
           EXIT.
       
       PRO-ROZ-OPZ SECTION.
       INI-PRO-ROZ-OPZ.
           MOVE FRM-CPIM-AEY TO ROZ-SGV-RENO-ATR IN OPZ-FLD.
       FIN-PRO-ROZ-OPZ.
           EXIT.
       
       PRO-COZ-OPZ SECTION.
       INI-PRO-COZ-OPZ.
           MOVE FRM-CPIM-AEY TO COZ-SGV-TINT-ATR IN OPZ-FLD.
       FIN-PRO-COZ-OPZ.
           EXIT.
       
       PRO-CYZ-OPZ SECTION.
       INI-PRO-CYZ-OPZ.
           MOVE FRM-CPIM-AEY TO CYZ-IND-TCYA-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD.
       FIN-PRO-CYZ-OPZ.
           EXIT.
       
       PRO-AUZ-OPZ SECTION.
       INI-PRO-AUZ-OPZ.
           MOVE FRM-CPIM-AEY TO AUZ-CAI-ICYA-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO AUZ-IIC-ICYA-ATR IN OPZ-FLD.
       FIN-PRO-AUZ-OPZ.
           EXIT.
      *>>>>
*% END
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                           LABELS COMUNES
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*% IF INI_DBC_VRF_ICLI
      *<<<< INI_DBC_VRF_ICLI
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               MOVE 'CBZ' TO TAB-COD-SIST
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDDIR' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES

                   MOVE ZEROES TO DBC-NUM-ICLI IN OPZ-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN OPZ-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN OPZ-FLD
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'OPZ    MDDIR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN OPZ-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'BCI    MDDIR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-INST = SCR-INST-GKY
               MOVE IDC-ZERO-S TO IDC-ZERO
           ELSE
               MOVE IDC-ZERO-N TO IDC-ZERO.
      *>>>>
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN OPZ-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN OPZ-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPZ-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPZ-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN OPZ-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPZ-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDZ-CAI-ICLI IN OPZ-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDZ-IIC-ICLI IN OPZ-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPZ-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPZ-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPZ-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPZ-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-COD-PESO SECTION.
       INI-BUS-COD-PESO.
           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO
           ELSE
               MOVE 'CICPESO  NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
       FIN-BUS-COD-PESO.
           EXIT.
       CONVIERTE-VALOR SECTION.
       INI-CONVIERTE-VALOR.
           MOVE SPACES TO MSG-COD-MENS.
      *Determina si es moneda nacional, si es asi el monto en la
      *entidad CAN esta expresado en aquella moneda nacional
      *cuyo cic es 0999.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-VCOC-CNV    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO TAB-GLS-DAT1 IN TAB.
               
      *     IF  WSS-COD-PESO  NOT = WSS-COD-VCOC-CNV AND
            IF  NOT (TAB-COD-DAT1 IN TAB(1) = '0')
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE WSS-COD-VCOC-CNV    TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   GO TO FIN-CONVIERTE-VALOR
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'CAM    NVG' TO MSG-COD-MENS
                   GO TO FIN-CONVIERTE-VALOR
               ELSE
                   MULTIPLY WSS-SGV-RENO-CNV BY CAM-SGV-VCAM IN CAM
                     GIVING WSS-SGV-RENO-CNV ROUNDED
                   MOVE WSS-COD-PESO      TO PES-COD-VCAM IN PES-VARI
                   MOVE WSS-SGV-RENO-CNV  TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-CNV.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ-FLD
               GO TO FIN-CONVIERTE-VALOR.

           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(1)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(1)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(1)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(2)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(2)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(2)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(2)
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY  TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               GO TO FIN-CONVIERTE-VALOR
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               MOVE 'CAM    NVG' TO MSG-COD-MENS
               GO TO FIN-CONVIERTE-VALOR
           ELSE
               DIVIDE WSS-SGV-RENO-CNV BY CAM-SGV-VCAM IN CAM
                                GIVING WSS-SGV-RENO-CNV ROUNDED
               MOVE OPZ-COD-VCOC IN OPZ-FLD
                                        TO PES-COD-VCAM IN PES-VARI
               MOVE WSS-SGV-RENO-CNV    TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-CNV.
       FIN-CONVIERTE-VALOR.
           EXIT.
      *>>>>
*% END
*% IF PGM_BQ
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                      LABELS PARA MODULO BQ
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*% IF FIN_PUT_OPZ_OPZ
      *<<<< FIN_PUT_OPZ_OPZ
      *BUS-TAB busca glosa de codigo en tabla
           IF OPZ-COD-AOOC IN OPZ-FLD > SPACES
               MOVE 'CBZ' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPZ-COD-AOOC IN OPZ-FLD TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOOC IN OPZ-FLD.
           IF OPZ-MSC-STAT IN OPZ > SPACES
               MOVE 'GNS' TO TAB-COD-SIST
               MOVE 'STT' TO TAB-COD-TTAB IN TAB
               MOVE OPZ-MSC-STAT IN OPZ TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-STAT IN OPZ-FLD.
           IF SCR-CMND = 'ACA' OR 'ACO' OR 'ASC' OR 'ASO'
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO OPZ-NUM-DINP IN OPZ-FLD
               MOVE HOY-MHOY TO OPZ-NUM-MINP IN OPZ-FLD
               MOVE HOY-SHOY TO OPZ-NUM-SINP IN OPZ-FLD
               MOVE HOY-AHOY TO OPZ-NUM-AINP IN OPZ-FLD.
*% END
*% IF INI_PUT_DBC_OPZ
      *<<<< INI_PUT_DBC_OPZ
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               MOVE ZEROES TO RDZ-NUM-DIRE IN OPZ-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPZ-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPZ-FLD
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    MDDIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN OPZ-FLD
               GO TO FIN-PUT-DBC-OPZ.
      *>>>>
*% END
*% IF FIN_PUT_DBC_OPZ
      *<<<< FIN_PUT_DBC_OPZ
           IF DBC-IND-ICLI IN OPZ-FLD NOT = 'M'
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN OPZ-FLD.
      *>>>>
*% END
*% IF FIN_PUT_ROZ_OPZ
      *<<<< FIN_PUT_ROZ_OPZ
           MOVE 'CBZ'          TO FIO-SIST.
           MOVE 'RENO'         TO MSC-CIC-TMSC IN MSC.
           MOVE 'NOV'          TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'NOV' TO MSC-COD-CMSC IN MSC.
           IF OPZ-IND-RENO IN OPZ-FLD NOT = MSC-COD-CMSC IN MSC
               GO TO FIN-PUT-ROZ-OPZ.
           PERFORM BUS-COD-PESO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PUT-ROZ-OPZ.

           IF OPZ-COD-VCOC IN OPZ-FLD = ROZ-COD-VCVR IN ROZ
               GO TO END-PUT-ROZ-OPZ.
           IF WSS-COD-PESO = ROZ-COD-VCVR IN ROZ 
               NEXT SENTENCE
           ELSE
               MOVE OPZ-NUM-DCOL IN OPZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPZ-NUM-MCOL IN OPZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPZ-NUM-SCOL IN OPZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPZ-NUM-ACOL IN OPZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE OPZ-NUM-DCOL IN OPZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE OPZ-NUM-MCOL IN OPZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE OPZ-NUM-SCOL IN OPZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE OPZ-NUM-ACOL IN OPZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE ROZ-COD-VCVR IN ROZ TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-PUT-ROZ-OPZ
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-PUT-ROZ-OPZ
               ELSE
                   MULTIPLY ROZ-SGV-RENO IN ROZ BY CAM-SGV-VCAM IN CAM
                            GIVING ROZ-SGV-RENO IN OPZ-FLD ROUNDED
                   MOVE WSS-COD-PESO       TO PES-COD-VCAM IN PES-VARI
                   MOVE ROZ-SGV-RENO IN OPZ-FLD
                                           TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI
                                           TO ROZ-SGV-RENO IN OPZ-FLD.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ-FLD
               NEXT SENTENCE
           ELSE
               MOVE OPZ-NUM-DCOL IN OPZ     TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPZ-NUM-MCOL IN OPZ     TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPZ-NUM-SCOL IN OPZ     TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPZ-NUM-ACOL IN OPZ     TO CAM-NUM-ACAM IN CAM(1)
               MOVE OPZ-NUM-DCOL IN OPZ     TO CAM-NUM-DCAM IN CAM(2)
               MOVE OPZ-NUM-MCOL IN OPZ     TO CAM-NUM-MCAM IN CAM(2)
               MOVE OPZ-NUM-SCOL IN OPZ     TO CAM-NUM-SCAM IN CAM(2)
               MOVE OPZ-NUM-ACOL IN OPZ     TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-PUT-ROZ-OPZ
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAM    NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   GO TO END-PUT-ROZ-OPZ
               ELSE
                   DIVIDE ROZ-SGV-RENO IN OPZ-FLD BY CAM-SGV-VCAM IN CAM
                          GIVING ROZ-SGV-RENO IN OPZ-FLD ROUNDED
                   MOVE OPZ-COD-VCOC IN OPZ-FLD
                                            TO PES-COD-VCAM IN PES-VARI
                   MOVE ROZ-SGV-RENO IN OPZ-FLD
                                            TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI
                                            TO ROZ-SGV-RENO IN OPZ-FLD.
       END-PUT-ROZ-OPZ.
      *>>>>
*% END
*% IF INI_PUT_COZ_OPZ
      *<<<< INI_PUT_COZ_OPZ
           IF WSS-FIO-STAT-FLV = '00'
              MOVE WSS-SGV-TCOM TO FRM-SGV-TFLV IN OPZ-FLD
           ELSE
              MOVE ZEROES TO FRM-SGV-TFLV IN OPZ-FLD.
           IF NOT PGM-STAT-COZ-OKS
               PERFORM CLR-COZ-OPZ
               GO TO FIN-PUT-COZ-OPZ. 
      *>>>>
*% END
*% IF FIN_PUT_COZ_OPZ
      *<<<< FIN_PUT_COZ_OPZ
      *>>>>
*% END
*% IF INI_PUT_CYZ_OPZ
      *<<<< INI_PUT_CYZ_OPZ
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M'
               MOVE SPACES TO CYZ-CAI-ICYA IN OPZ-FLD
               MOVE ZEROES TO CYZ-IIC-ICYA IN OPZ-FLD
               GO TO FIN-PUT-CYZ-OPZ.
           IF NOT PGM-STAT-CYZ-OKS
               PERFORM CLR-CYZ-OPZ
               GO TO FIN-PUT-CYZ-OPZ.
      *>>>>
*% END
*% IF FIN_PUT_CAZ_OPZ
      *<<<< FIN_PUT_CAZ_OPZ
           IF WSS-TOT-RCAN > 1
               MOVE 'MULT' TO CAZ-CAI-IOPC IN OPZ-FLD
               MOVE ZEROES TO CAZ-IIC-IOPC IN OPZ-FLD
               MOVE ZEROES TO CAZ-NUM-ICAN IN OPZ-FLD
               GO TO FIN-PUT-CAZ-OPZ.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_OPZ
      *<<<< INI_VAL_CON_KEY_OPZ
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-OPZ.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_OPZ
      *<<<< INI_VAL_CON_IKY_OPZ
           IF SCR-CCPP = 'ING'
               IF     OPZ-COD-TOOC IN OPZ-FLD NOT > SPACES 
                  AND OPZ-CAI-IOPC IN OPZ-FLD NOT > SPACES 
                  AND OPZ-IIC-IOPC IN OPZ-FLD NOT > ZEROES 
                  AND OPZ-COD-VCOC IN OPZ-FLD NOT > SPACES 
                  AND OPZ-COD-AOOC IN OPZ-FLD NOT > SPACES 
                   PERFORM ERR-KEY
                   PERFORM FST-KEY-OPZ
                   GO TO FIN-VAL-CON-IKY-OPZ
               ELSE
                   GO TO FIN-VAL-CON-IKY-OPZ.
      *>>>>
*% END
*% END
*% IF PGM_BU
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                       LABELS PARA MODULO BU
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*% IF FIN_RET_CYZ_OPZ
      *<<<< FIN_RET_CYZ_OPZ
           MOVE SPACES TO CYZ-IND-MAUT IN CYZ.
           IF CYZ-IND-TCYA IN CYZ > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-COD-DAT1(2) TO CYZ-IND-MAUT IN CYZ.
      *>>>>
*% END
*% IF FIN_RET_ROZ_OPZ
      *<<<< FIN_RET_ROZ_OPZ
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO ROZ-COD-VCVR IN ROZ.
      *>>>>
*% END
*% IF INI_VAL_FLD_OPZ
      *<<<< INI_VAL_FLD_OPZ
           PERFORM BUS-COD-PESO.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'CBZ' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-VAL-FLD-OPZ.
           IF SCR-CMND NOT = 'MCA'
               GO TO NXT-VAL-FLD-OPZ.
           PERFORM VAL-RDZ-NUM-DIRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO RDZ-NUM-DIRE-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           PERFORM VAL-OPZ-COD-RMOC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO OPZ-COD-RMOC-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           PERFORM VAL-CYZ-CAI-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CYZ-CAI-ICYA-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           PERFORM VAL-CYZ-IIC-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CYZ-IIC-ICYA-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           PERFORM VAL-AUZ-CAI-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO AUZ-CAI-ICYA-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           PERFORM VAL-AUZ-IIC-ICYA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO AUZ-IIC-ICYA-LEN IN OPZ-FLD
                GO TO FIN-VAL-FLD-OPZ.
           GO TO FIN-VAL-FLD-OPZ.
       NXT-VAL-FLD-OPZ.
      *>>>>
*% END
*% IF FIN_OPZ_COD_OFOC
      *<<<< FIN_OPZ_COD_OFOC
           IF MSG-COD-MENS = 'COD    NEX'
               GO TO FIN-VAL-OPZ-COD-OFOC.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO CIC-CAI-ICIC
           IF OPZ-COD-OFOC IN OPZ-FLD NOT = CIC-COD-CCIC IN CIC AND
              OPZ-IIC-IOPC IN OPZ-FLD  > ZEROES
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CODOFOCAIINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-COD-OFOC.
      * Si la POC asi lo indica, verifica que la Oficina de la operacion
      * sea igual a la oficina del cliente, o bien a la oficina matriz
      * que corresponda.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               NEXT SENTENCE
           ELSE
           IF POZ-IND-AOTC IN POZ = 'S'
               IF OPZ-COD-OFOC IN OPZ-FLD NOT = DBC-COD-OFIC IN DBC
                   MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI
                   PERFORM VAL-OFI
                   IF MSG-COD-MENS NOT = SPACES
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-OPZ-COD-OFOC
                   ELSE
                   IF OPZ-COD-OFOC IN OPZ-FLD NOT = OFI-COD-OFCO IN OFI
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'OPZICLIOFI<>' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC        TO FRM-MEN1
                       MOVE DBC-COD-OFIC IN DBC TO FRM-MEN2
                       MOVE FRM-SUAR-MAL        TO FRM-SUAR
                       GO TO FIN-VAL-OPZ-COD-OFOC.
      *>>>>
*% END
*% IF OPZ_COD_TOOC
      *<<<< OPZ_COD_TOOC
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                  TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           MOVE FIO-STAT TO PGM-STAT-POZ.
           IF SCR-CMND = 'MCA'
               MOVE '23' TO PGM-STAT-POZ.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
           IF DBC-IND-ICLI IN OPZ-FLD = 'M' AND
              DBC-NUM-ICLI IN OPZ-FLD NOT = ZEROES
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'INDNUMICLII' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI
           IF OPZ-IND-RENO IN OPZ-FLD = 'NOV'
               MOVE 'CBZ'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSN'       TO TAB-COD-TTAB IN TAB
               MOVE 'NOVDEUD='  TO TAB-COD-CTAB IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB NOT = 'N'
                   NEXT SENTENCE
               ELSE
                MOVE CAZ-CAI-IOPC IN OPZ-FLD TO RDZ-CAI-IOPC IN RDZ
                MOVE CAZ-IIC-IOPC IN OPZ-FLD TO RDZ-IIC-IOPC IN RDZ
                MOVE ZEROES                  TO RDZ-NUM-IDLC IN RDZ
                MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY
                PERFORM CBZ-FIO-RDZ
                IF FIO-STAT-OKS
                    IF RDZ-CAI-ICLI IN RDZ =
                       RDZ-CAI-ICLI IN OPZ-FLD AND
                       RDZ-IIC-ICLI IN RDZ =
                       RDZ-IIC-ICLI IN OPZ-FLD
                         MOVE 'CBZ'        TO MSG-COD-SIST
                         MOVE 'DDIR=  DNOV' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE SPACES       TO DBC-GLS-NOMC IN OPZ-FLD
                         MOVE MSG-GLS-DESC TO FRM-MENS
                         MOVE FRM-SUAR-MAL TO FRM-SUAR
                         GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
*% END
*% IF RDZ_NUM_DIRE
      *<<<< RDZ_NUM_DIRE
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               MOVE ZEROES TO RDZ-NUM-DIRE IN OPZ-FLD
               GO TO FIN-VAL-RDZ-NUM-DIRE.

       CHK-RDZ-NUM-DIRE.

           IF RDZ-NUM-DIRE IN OPZ-FLD > ZEROES
               MOVE DBC-CIC-ICLI IN DBC     TO RCD-CIC-ICLI IN RCD
               MOVE RDZ-NUM-DIRE IN OPZ-FLD TO RCD-NUM-DIRE IN RCD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'DIR    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RDZ-NUM-DIRE
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM BUS-DBC-DCOR
               IF MSG-COD-MENS NOT > SPACES
                   GO TO CHK-RDZ-NUM-DIRE
               ELSE
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RDZ-NUM-DIRE.
      *>>>>
*% END
*% IF OPZ_COD_VCOC
      *<<<< OPZ_COD_VCOC
           IF OPZ-COD-VCOC IN OPZ-FLD NOT > SPACES
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CODVCOCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-COD-VCOC.
      *>>>>
*% END
*% IF OPZ_COD_AOOC
      *<<<< OPZ_COD_AOOC
      *VAL-COD Valida codigo de tabla
           MOVE 'CBZ' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              OPZ-COD-AOOC IN OPZ-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN OPZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN OPZ-FLD.
      *>>>>
*% END
*% IF OPZ_VAL_CRED
      *<<<< OPZ_VAL_CRED
           MOVE SCR-OPC-STAT TO OPZ-MSC-STAT IN OPZ
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM IN PES-VARI.
           MOVE OPZ-VAL-CRED IN OPZ-FLD TO PES-SGV-DECI IN PES-VARI
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO OPZ-VAL-CRED IN OPZ-FLD.
           IF NOT PGM-STAT-POZ-OKS
               GO TO FIN-VAL-OPZ-VAL-CRED.
           IF NOT ( (POZ-VAL-CMIN IN POZ = ZEROES OR
              POZ-VAL-CMIN IN POZ NOT > OPZ-VAL-CRED IN OPZ-FLD ) AND
              ( POZ-VAL-CMAX IN POZ = ZEROES OR
              POZ-VAL-CMAX IN POZ NOT < OPZ-VAL-CRED IN OPZ-FLD ) )
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'VALCREDNORNG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POZ-VAL-CMIN IN POZ TO WSS-SGV-VAL1-EDT IN WSS-VARI
               MOVE '/'                 TO WSS-GLS-GUI1     IN WSS-VARI
               MOVE POZ-VAL-CMAX IN POZ TO WSS-SGV-VAL2-EDT IN WSS-VARI
               MOVE WSS-MEN2 IN WSS-VARI TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF OPZ_VAL_SCRE
      *<<<< OPZ_VAL_SCRE
           MOVE SCR-OPC-STAT TO OPZ-MSC-STAT IN OPZ
           IF NOT OPZ-ESPERA-OPZ
               MOVE OPZ-VAL-CRED IN OPZ-FLD TO OPZ-VAL-SCRE IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_OPZ_COD_OFOP
      *<<<< INI_OPZ_COD_OFOP
           IF OPZ-COD-OFOP IN OPZ-FLD = '"'
               MOVE OPZ-COD-OFOC IN OPZ-FLD TO OPZ-COD-OFOP IN OPZ-FLD.
      *>>>>
*% END
*% IF INI_OPZ_NUM_NPLA
      *<<<< INI_OPZ_NUM_NPLA
           IF NOT ( SCR-CIC-TDOC = 'LTR' OR 'PAG' )
               GO TO FIN-VAL-OPZ-NUM-NPLA.
           IF OPZ-NUM-NPLA IN OPZ-FLD NOT > ZEROES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF INI_OPZ_NUM_VCOR
      *<<<< INI_OPZ_NUM_VCOR
           IF NOT ( SCR-CIC-TDOC = 'LTR' AND
                    OPZ-IND-VSTR IN OPZ-FLD = 'N' )
               GO TO FIN-VAL-OPZ-NUM-VCOR.
           IF OPZ-NUM-VCOR IN OPZ-FLD NOT > ZEROES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF OPZ_NUM_VCVG
      *<<<< OPZ_NUM_VCVG
           IF SCR-CCPP = 'ING'
               MOVE ZEROES TO OPZ-NUM-VCVG IN OPZ-FLD.
      *>>>>
*% END
*% IF OPZ_IND_RENO
      *<<<< OPZ_IND_RENO
           MOVE SPACES TO WSS-COD-DIGT.
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-OPZ-IND-RENO.
           IF POZ-IND-RENO IN POZ > SPACES
               MOVE POZ-IND-RENO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE NUM-NN9N TO WSS-NUM-DIGT
                   MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
               ELSE
                   IF POZ-IND-RENO IN POZ NOT = OPZ-IND-RENO IN OPZ-FLD
                       MOVE 'CBZ' TO MSG-COD-SIST
                       MOVE 'INDRENONOPLT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                       MOVE POZ-IND-RENO IN POZ TO FRM-MEN2
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-OPZ-IND-RENO.
       CON-VAL-OPZ-IND-RENO.
      *>>>>
*% END
*% IF FIN_OPZ_IND_RENO
      *<<<< FIN_OPZ_IND_RENO
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-OPZ-IND-RENO.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-OPZ-IND-RENO.
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = MSC-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'INDRENONEFAM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-IND-RENO.
      *>>>>
*% END
*% IF ROZ_VAL_RENO
      *<<<< ROZ_VAL_RENO
      *>>>>
*% END
*% IF OPZ_FEC_FINP
      *<<<< OPZ_FEC_FINP
           IF SCR-CMND = 'MCA'
               GO TO FIN-VAL-OPZ-FEC-FINP.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO OPZ-NUM-DINP IN OPZ-FLD.
           MOVE HOY-MHOY TO OPZ-NUM-MINP IN OPZ-FLD.
           MOVE HOY-SHOY TO OPZ-NUM-SINP IN OPZ-FLD.
           MOVE HOY-AHOY TO OPZ-NUM-AINP IN OPZ-FLD.
           MOVE HOY-DHOY TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ACTB IN WSS-VARI.
       BUS-DIA-HBL-PRV.
           MOVE WSS-NUM-DCTB IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCTB IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCTB IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACTB IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-OPZ-FEC-FINP.
           MOVE FEC-ITM1 TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ACTB IN WSS-VARI.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
                GO TO BUS-DIA-HBL-PRV.
      *>>>>
*% END
*% IF OPZ_FEC_FCOL
      *<<<< OPZ_FEC_FCOL
           IF OPZ-FEC-FCOL IN OPZ-FLD NOT > ZEROES
               MOVE OPZ-FEC-FINP IN OPZ-FLD TO OPZ-FEC-FCOL IN OPZ-FLD.
           IF NOT PGM-STAT-POZ-OKS
               GO TO FIN-VAL-OPZ-FEC-FCOL.
           IF POZ-NUM-DCMI IN POZ NOT > ZEROES
               MOVE ZEROES TO POZ-NUM-DCMI IN POZ.
           IF POZ-NUM-DCMA IN POZ NOT > ZEROES
               MOVE ZEROES TO POZ-NUM-DCMA IN POZ.
           IF POZ-NUM-MCMI IN POZ NOT > ZEROES
               MOVE ZEROES TO POZ-NUM-MCMI IN POZ.
           IF POZ-NUM-MCMA IN POZ NOT > ZEROES
               MOVE ZEROES TO POZ-NUM-MCMA IN POZ.
           IF NOT (( POZ-NUM-DCMI IN POZ NOT > ZEROES OR 
              POZ-NUM-DCMI IN POZ NOT > OPZ-NUM-DCOL IN OPZ-FLD ) AND
              ( POZ-NUM-DCMA IN POZ NOT > ZEROES OR
              POZ-NUM-DCMA IN POZ NOT < OPZ-NUM-DCOL IN OPZ-FLD ) AND
              ( POZ-NUM-MCMI IN POZ NOT > ZEROES OR
              POZ-NUM-MCMI IN POZ NOT > OPZ-NUM-MCOL IN OPZ-FLD ) AND
              ( POZ-NUM-MCMA IN POZ NOT > ZEROES OR
              POZ-NUM-MCMA IN POZ NOT < OPZ-NUM-MCOL IN OPZ-FLD ) )
               MOVE 'CBZ'         TO MSG-COD-SIST
               MOVE 'FECFCOLNCUR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1

               MOVE POZ-GLS-PCMI IN POZ TO CPT-STR1
               MOVE POZ-GLS-PCMA IN POZ TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-MEN2


               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-FEC-FCOL.
           MOVE OPZ-NUM-DCOL IN OPZ-FLD TO WSS-NUM-DAUX IN WSS-VARI.
           MOVE OPZ-NUM-MCOL IN OPZ-FLD TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE OPZ-NUM-SCOL IN OPZ-FLD TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE OPZ-NUM-ACOL IN OPZ-FLD TO WSS-NUM-AAUX IN WSS-VARI.
      *>>>
*% END
*% IF FRM_SGV_TFLV
      *<<<< FRM_SGV_TFLV
      *HZF-INI-09111993
           IF NOT PGM-STAT-POZ-OKS 
               GO TO CON-VAL-FRM-SGV-TFLV.
           IF NOT PGM-STAT-POZ-OKS
              GO TO CON-VAL-FRM-SGV-TFLV.
           IF WSS-ES-COM-FLV
              IF  FRM-SGV-TFLV IN OPZ-FLD = ZEROES
              AND FRM-IND-PVEZ-CAZ NOT = 'N'
                  MOVE 'N' TO FRM-IND-PVEZ-CAZ 
                  MOVE WSS-SGV-TCOM-CAN TO FRM-SGV-TFLV IN OPZ-FLD 
                  GO TO FIN-VAL-FRM-SGV-TFLV
              ELSE
                  IF WSS-SGV-TCOM-CAN < FRM-SGV-TFLV IN OPZ-FLD 
                     MOVE 'CBZ' TO MSG-COD-SIST
                     MOVE 'COMTINT>PLT ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MEN1
                     MOVE POZ-COD-TCOM IN POZ TO FRM-MEN2
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-FRM-SGV-TFLV
                  ELSE
                     NEXT SENTENCE
           ELSE
               IF FRM-SGV-TFLV IN OPZ-FLD NOT = ZEROES
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMTINT>ZERO' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MEN1
                  MOVE POZ-COD-TCOM IN POZ TO FRM-MEN2
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-TFLV.
           IF WSS-ES-COM-FLV
              IF FRM-SGV-TFLV IN OPZ-FLD = ZEROES AND
                  POZ-IND-TCCE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMCODEQZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-TFLV
              ELSE
              IF FRM-SGV-TFLV IN OPZ-FLD < ZEROES AND
                  POZ-IND-TCNE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMCODMEZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-SGV-TFLV.
       CON-VAL-FRM-SGV-TFLV.
      *>>>>
*% END
*% IF COZ_SGV_TINT
      *<<<< COZ_SGV_TINT
           IF NOT PGM-STAT-POZ-OKS 
               GO TO CON-VAL-COZ-SGV-TINT.
           IF NOT PGM-STAT-POZ-OKS
              GO TO CON-VAL-COZ-SGV-TINT.
           IF WSS-ES-COM-FLA
              IF  COZ-SGV-TINT IN OPZ-FLD = ZEROES
              AND FRM-IND-PVEZ-OPZ NOT = 'N'
                  MOVE 'N' TO FRM-IND-PVEZ-OPZ 
                  MOVE WSS-SGV-TCOM-OPC TO COZ-SGV-TINT IN OPZ-FLD 
                  GO TO FIN-VAL-COZ-SGV-TINT
              ELSE
                  IF WSS-SGV-TCOM-OPC < COZ-SGV-TINT IN OPZ-FLD 
                     MOVE 'CBZ' TO MSG-COD-SIST
                     MOVE 'COMTINT>PLT ' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MEN1
                     MOVE POZ-COD-TCOM IN POZ TO FRM-MEN2
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-COZ-SGV-TINT
                  ELSE
                     NEXT SENTENCE
           ELSE
               IF COZ-SGV-TINT IN OPZ-FLD NOT = ZEROES
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMTINT>ZERO' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MEN1
                  MOVE POZ-COD-TCOM IN POZ TO FRM-MEN2
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-COZ-SGV-TINT.
           IF WSS-ES-COM-FLA
              IF COZ-SGV-TINT IN OPZ-FLD = ZEROES AND
                  POZ-IND-TCCE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMCODEQZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-COZ-SGV-TINT
              ELSE
              IF COZ-SGV-TINT IN OPZ-FLD < ZEROES AND
                  POZ-IND-TCNE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMCODMEZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-COZ-SGV-TINT.
       CON-VAL-COZ-SGV-TINT.
      *>>>>
*% END
*% IF OPZ_COD_PLCO
      *<<<< OPZ_COD_PLCO
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-OPZ-COD-PLCO.
           IF POZ-COD-PLCO IN POZ NOT = OPZ-COD-PLCO IN OPZ-FLD AND
              POZ-COD-PLCO IN POZ > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'COMPLCONOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POZ-COD-PLCO IN POZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLCO.
           IF OPZ-COD-PLCO IN OPZ-FLD  NOT > SPACES
               MOVE 1      TO WSS-COM-TIP-INF IN WSS-VARI
               MOVE 1      TO WSS-COM-TIP-FLA IN WSS-VARI
               MOVE 1      TO WSS-COM-TIP-FLV IN WSS-VARI
               MOVE SPACES TO OPZ-COD-PLCO IN OPZ-FLD
               GO TO CON-VAL-OPZ-COD-PLCO.

      *Validacion para ver si existe plantilla
           MOVE SPACES TO PCZ.
      *     MOVE OPZ-COD-PLCO IN OPZ-FLD TO PCZ-COD-PLAN IN PCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-OPZ-COD-PLCO.
           PERFORM CBZ-FIO-PCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'PCPCOMIPLANX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC            TO FRM-MEN1
               MOVE OPZ-COD-PLCO IN OPZ-FLD TO FRM-MEN2
               MOVE FRM-SUAR-MAL            TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLCO.

           IF OPZ-COD-PLCO IN OPZ-FLD NOT = PCZ-COD-PLAN IN PCZ 
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-VAL-OPZ-COD-PLCO.

           IF OPZ-IND-RENO IN OPZ-FLD NOT = SPACES
              MOVE 'NEG'          TO WSS-TIP-PROC IN WSS-VARI
           ELSE
              MOVE 'CUR'          TO WSS-TIP-PROC IN WSS-VARI.
           PERFORM BUS-EVE-PCP.
           MOVE 'CBZ'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'FLA'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COD-TIP-FLA IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE 'FLA EN CMS' TO FRM-MEN2 
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLCO.

           MOVE 'CBZ'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'INF'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COD-TIP-INF IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE 'INF EN CMS' TO FRM-MEN2 
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLCO.
            MOVE 1 TO WSS-COM-TIP-INF IN WSS-VARI
            MOVE 1 TO WSS-COM-TIP-FLA IN WSS-VARI
            MOVE 1 TO DCO-I.
       LU1-VAL-OPZ-COD-PLCO.
           IF  DCO-I > 13
               GO TO FLV-VAL-OPZ-COD-PLCO.
           IF  PCZ-COD-COMI IN PCZ (DCO-I) = WSS-COD-TIP-INF IN WSS-VARI
               MOVE 0             TO WSS-COM-TIP-INF IN WSS-VARI
           ELSE
           IF PCZ-COD-COMI IN PCZ (DCO-I) = WSS-COD-TIP-FLA IN WSS-VARI
              IF OPZ-VAL-CRED IN OPZ-FLD NOT >
                                         PCZ-VAL-MTOP IN PCZ (DCO-I)
              OR PCZ-VAL-MTOP IN PCZ (DCO-I) = ZEROES
                  MOVE 0             TO WSS-COM-TIP-FLA IN WSS-VARI
                  MOVE PCZ-SGV-TIMP IN PCZ (DCO-I)
                                     TO WSS-SGV-TCOM-OPC
                  MOVE 14            TO DCO-I.
           ADD 1 TO DCO-I.
           GO TO LU1-VAL-OPZ-COD-PLCO.
       FLV-VAL-OPZ-COD-PLCO.
           MOVE 'CAN'          TO WSS-TIP-PROC IN WSS-VARI.
           PERFORM BUS-EVE-PCP.
           IF PCZ-COD-EVEN IN PCZ NOT = 'CAN'
              GO TO CON-VAL-OPZ-COD-PLCO.
           MOVE 'CBZ'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'FLV'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COD-TIP-FLV IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE 'FLV EN CMS' TO FRM-MEN2 
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLCO.
           MOVE 1 TO WSS-COM-TIP-FLV IN WSS-VARI
           MOVE 1 TO DCO-I.
       LU2-VAL-OPZ-COD-PLCO.
           IF  DCO-I > 13
               GO TO CON-VAL-OPZ-COD-PLCO.
           IF PCZ-COD-COMI IN PCZ (DCO-I) = WSS-COD-TIP-FLV IN WSS-VARI
                  MOVE 0             TO WSS-COM-TIP-FLV IN WSS-VARI
                  MOVE PCZ-SGV-TIMP IN PCZ (DCO-I)
                                     TO WSS-SGV-TCOM-CAN
                  MOVE 14            TO DCO-I.
           ADD 1 TO DCO-I.
           GO TO LU2-VAL-OPZ-COD-PLCO.
       CON-VAL-OPZ-COD-PLCO.
      *>>>>
*% END
*% IF OPZ_COD_PLIM
      *<<<< OPZ_COD_PLIM
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-OPZ-COD-PLIM.
           IF POZ-COD-PLIM IN POZ NOT = OPZ-COD-PLIM IN OPZ-FLD AND
              POZ-COD-PLIM IN POZ > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'COMPLIMNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POZ-COD-PLIM IN POZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO CON-VAL-OPZ-COD-PLIM.
           IF OPZ-COD-PLIM IN OPZ-FLD  NOT > SPACES
               MOVE SPACES TO OPZ-COD-PLIM IN OPZ-FLD
               GO TO CON-VAL-OPZ-COD-PLIM.
           MOVE OPZ-COD-PLIM IN OPZ-FLD  TO PIZ-COD-PLAN IN PIZ.
           MOVE 'CUR'                    TO PIZ-COD-EVEN IN PIZ.
           MOVE OPZ-COD-OFOC IN OPZ-FLD  TO PIZ-COD-OFIC IN PIZ.
           MOVE OPZ-NUM-DCOL IN OPZ-FLD  TO PIZ-NUM-DPLA IN PIZ
                                            OPZ-NUM-DCOL IN OPZ.
           MOVE OPZ-NUM-MCOL IN OPZ-FLD  TO PIZ-NUM-MPLA IN PIZ
                                            OPZ-NUM-MCOL IN OPZ.
           MOVE OPZ-NUM-SCOL IN OPZ-FLD  TO PIZ-NUM-SPLA IN PIZ
                                            OPZ-NUM-SCOL IN OPZ.
           MOVE OPZ-NUM-ACOL IN OPZ-FLD  TO PIZ-NUM-APLA IN PIZ
                                            OPZ-NUM-ACOL IN OPZ.
           MOVE FIO-GET-LEQ              TO FIO-CMND.
       LUP-VAL-OPZ-COD-PLIM.
           PERFORM CBZ-FIO-PIZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-COD-PLIM IN OPZ-FLD = PIZ-COD-PLAN IN PIZ )
                    MOVE SPACES TO PIZ
                    MOVE OPZ-COD-PLIM IN OPZ-FLD 
                                     TO PIZ-COD-PLAN IN PIZ
                    MOVE FIO-GET-NLS TO FIO-CMND
                    PERFORM CBZ-FIO-PIZ
                    IF NOT ( FIO-STAT-OKS AND
                       OPZ-COD-PLIM IN OPZ-FLD = PIZ-COD-PLAN IN PIZ )
                       MOVE 'CBZ' TO MSG-COD-SIST
                       MOVE 'PIZIMPUPLANX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                       MOVE OPZ-COD-PLIM IN OPZ-FLD TO FRM-MEN2
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO CON-VAL-OPZ-COD-PLIM.
           IF NOT  PIZ-COD-EVEN IN PIZ = 'CUR'
                    MOVE SPACES                TO PIZ
                    GO TO CON-VAL-OPZ-COD-PLIM.
           IF NOT ( OPZ-COD-OFOC IN OPZ-FLD = PIZ-COD-OFIC IN PIZ OR
                    PIZ-COD-OFIC IN PIZ     = '*  ')
              MOVE OPZ-COD-OFOC IN OPZ-FLD TO PIZ-COD-OFIC IN PIZ
              MOVE OPZ-NUM-DCOL IN OPZ-FLD TO PIZ-NUM-DPLA IN PIZ
              MOVE OPZ-NUM-MCOL IN OPZ-FLD TO PIZ-NUM-MPLA IN PIZ
              MOVE OPZ-NUM-SCOL IN OPZ-FLD TO PIZ-NUM-SPLA IN PIZ
              MOVE OPZ-NUM-ACOL IN OPZ-FLD TO PIZ-NUM-APLA IN PIZ
              MOVE '*  '              TO   PIZ-COD-OFIC IN PIZ
              GO TO LUP-VAL-OPZ-COD-PLIM.
           IF PIZ-IND-VIGE IN PIZ = 'N' OR
              PIZ-FEC-FPLA IN PIZ > OPZ-FEC-FCOL IN OPZ
              MOVE FIO-GET-PRV              TO FIO-CMND
              GO TO LUP-VAL-OPZ-COD-PLIM.
       CON-VAL-OPZ-COD-PLIM.
      *>>>>
*% END
*% IF OPZ_IND_VSTR
      *<<<< OPZ_IND_VSTR
      *>>>>
*% END

*% IF OPZ_IND_AFER
      *<<<< OPZ_IND_AFER
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-OPZ-IND-AFER.
           IF POZ-IND-AFER IN POZ NOT = OPZ-IND-AFER IN OPZ-FLD AND
              POZ-IND-AFER IN POZ > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'INDAFERNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POZ-IND-AFER IN POZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-IND-AFER.
       CON-VAL-OPZ-IND-AFER.
      *>>>>
*% END
*% IF OPZ_IND_TCBZ
      *<<<< OPZ_IND_TCBZ
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-OPZ-IND-TCBZ.
           IF POZ-IND-TCBZ IN POZ NOT = OPZ-IND-TCBZ IN OPZ-FLD AND
              POZ-IND-TCBZ IN POZ > SPACES
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'INDTCBZNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POZ-IND-TCBZ IN POZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPZ-IND-TCBZ.
       CON-VAL-OPZ-IND-TCBZ.
      *>>>>
*% END
*% IF OPZ_SGV_VCOM
      *<<<< OPZ_SGV_VCOM
           IF  WSS-ES-COM-INF
               IF OPZ-SGV-VCOM IN OPZ-FLD = ZEROES  AND
                  POZ-IND-TCCE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMVALEQZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-OPZ-SGV-VCOM
               ELSE
               IF OPZ-SGV-VCOM IN OPZ-FLD < ZEROES  AND
                  POZ-IND-TCNE IN POZ NOT = 'S'
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'COMVALMEZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-OPZ-SGV-VCOM.
           IF  NOT WSS-ES-COM-INF 
               IF OPZ-SGV-VCOM IN OPZ-FLD > ZEROES 
                  MOVE 'CBZ' TO MSG-COD-SIST
                  MOVE 'VALCOMIMZER' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-OPZ-SGV-VCOM.
      *>>>>
*% END
*% IF OPZ_VAL_GAST
      *<<<< OPZ_VAL_GAST
           IF OPZ-VAL-GAST IN OPZ-FLD > OPZ-VAL-CRED IN OPZ-FLD
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'VALGASTCRED>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF OPZ_SGV_LIQU
      *<<<< OPZ_SGV_LIQU
      *>>>>
*% END
*% IF OPZ_COD_RMOC
      *<<<< OPZ_COD_RMOC
           IF NOT ( OPZ-COD-RMOC IN OPZ-FLD > SPACES OR
                    DBC-IND-ICLI IN OPZ-FLD = 'M' )
               MOVE DBC-COD-EJEC IN DBC TO OPZ-COD-RMOC IN OPZ-FLD.
           IF OPZ-COD-RMOC IN OPZ-FLD NOT > SPACES AND
              DBC-IND-ICLI IN OPZ-FLD NOT = 'M'
               PERFORM ERR-GLS
               GO TO FIN-VAL-OPZ-COD-RMOC.
      *>>>>
*% END
*% IF CYZ_IND_TCYA
      *<<<< CYZ_IND_TCYA
           MOVE SPACES TO WSS-COD-DIGT.
           IF NOT PGM-STAT-POZ-OKS
               GO TO CON-VAL-CYZ-IND-TCYA.
           IF POZ-IND-TABO IN POZ > SPACES
               MOVE POZ-IND-TABO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 5 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE NUM-NN9N TO WSS-NUM-DIGT
                   MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
               ELSE
                   IF POZ-IND-TABO IN POZ NOT = CYZ-IND-TCYA IN OPZ-FLD
                       MOVE 'CBZ' TO MSG-COD-SIST
                       MOVE 'INDTCYANOPLT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                       MOVE POZ-IND-TABO IN POZ TO FRM-MEN2
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CYZ-IND-TCYA.
       CON-VAL-CYZ-IND-TCYA.
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M'
               MOVE SPACES TO CYZ-CAI-ICYA IN OPZ-FLD
               MOVE ZEROES TO CYZ-IIC-ICYA IN OPZ-FLD
               GO TO FIN-VAL-CYZ-IND-TCYA.
      *>>>>
*% END
*% IF FIN_CYZ_IND_TCYA
      *<<<< FIN_CYZ_IND_TCYA
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CYZ-IND-TCYA.
           IF CYZ-IND-TCYA IN OPZ-FLD NOT > SPACES
               GO TO FIN-VAL-CYZ-IND-TCYA.

           IF WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(5) = 'N'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TCYANONOROPZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYZ-IND-TCYA.

           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(6) = 'N'
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'TCYANORETOPZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYZ-IND-TCYA.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-CYZ-IND-TCYA.
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = MSC-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'INDTCYANEFAM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYZ-IND-TCYA.
      *>>>>
*% END
*% IF CYZ_CAI_ICYA
      *<<<< CYZ_CAI_ICYA
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M'
               MOVE 'CBZ' TO TAB-COD-SIST
               MOVE 'VSN' TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MCYA' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE SPACES TO CYZ-CAI-ICYA IN OPZ-FLD
                   MOVE ZEROES TO CYZ-IIC-ICYA IN OPZ-FLD
                   GO TO FIN-VAL-CYZ-CAI-ICYA
               ELSE
                   MOVE 'CBZ'         TO MSG-COD-SIST
                   MOVE 'BCI    MCYA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CYZ-CAI-ICYA.

           MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-TCYA.
           MOVE MSC-COD-DAT1(3)     TO WSS-GLS-DAT1.
      *>>>>
*% END
*% IF CYZ_IIC_ICYA
      *<<<< CYZ_IIC_ICYA
           IF ( CYZ-CAI-ICYA IN OPZ-FLD > SPACES ) OR
              ( CYZ-IIC-ICYA IN OPZ-FLD > ZEROES )
               GO TO FIN-VAL-CYZ-IIC-ICYA.
      *>>>>
*% END
*% IF AUZ_CAI_ICYA
      *<<<< AUZ_CAI_ICYA
           IF PGM-STAT-POZ-OKS
               IF AUZ-CAI-ICYA IN OPZ-FLD NOT > SPACES AND
                  AUZ-IIC-ICYA IN OPZ-FLD NOT > ZEROES
                   IF POZ-IND-CAUT IN POZ = 'S' OR 'C' OR 'A' OR 'F'
                                                OR 'E'
                      MOVE 'CBZ' TO MSG-COD-SIST
                      MOVE 'AUTICYANBLKS' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO FIN-VAL-AUZ-CAI-ICYA
                   ELSE
                      GO TO FIN-VAL-AUZ-CAI-ICYA
               ELSE
                   IF POZ-IND-CAUT IN POZ = 'N' OR 'V'
                       MOVE SPACES TO AUZ-CAI-ICYA IN OPZ-FLD
                       MOVE ZEROES TO AUZ-IIC-ICYA IN OPZ-FLD
                       GO TO FIN-VAL-AUZ-CAI-ICYA
                   ELSE
                       NEXT SENTENCE
           ELSE
               IF AUZ-CAI-ICYA IN OPZ-FLD NOT > SPACES AND
                  AUZ-IIC-ICYA IN OPZ-FLD NOT > ZEROES
                   GO TO FIN-VAL-AUZ-CAI-ICYA.
           IF AUZ-CAI-ICYA IN OPZ-FLD = '"'
               MOVE CYZ-CAI-ICYA IN OPZ-FLD TO AUZ-CAI-ICYA IN OPZ-FLD
               MOVE CYZ-IIC-ICYA IN OPZ-FLD TO AUZ-IIC-ICYA IN OPZ-FLD.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               GO TO FIN-VAL-AUZ-CAI-ICYA.
           MOVE RDZ-CAI-ICLI IN OPZ-FLD TO RCO-CAI-ICLI IN RCO.
           MOVE RDZ-IIC-ICLI IN OPZ-FLD TO RCO-IIC-ICLI IN RCO.
           MOVE AUZ-CAI-ICYA IN OPZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE AUZ-IIC-ICYA IN OPZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF POZ-IND-CAUT IN POZ = 'E'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'IICICYADECLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA
               ELSE
               IF PGM-STAT-POZ-OKS
                   GO TO CON-VAL-AUZ-CAI-ICYA
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
                   MOVE RCO-COD-TOPR IN RCO TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   GO TO CER-VAL-AUZ-CAI-ICYA.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE AUZ-CAI-ICYA IN OPZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE AUZ-IIC-ICYA IN OPZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CICIAUTNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-AUZ-CAI-ICYA
           ELSE
               IF POZ-IND-CAUT IN POZ NOT = 'E'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'IICICYADCNEQ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA.
       CON-VAL-AUZ-CAI-ICYA.
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE RCO-COD-TOPR IN RCO TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF POZ-IND-CAUT IN POZ = 'C' OR 'F'
                                        OR 'E'
               IF TAB-CIC-CTAB IN TAB = 'CTE'           
                   NEXT SENTENCE
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICIAUTNOCTE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA
           ELSE
           IF POZ-IND-CAUT IN POZ = 'A'
               IF TAB-CIC-CTAB IN TAB = 'AHO'           
                   NEXT SENTENCE
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICIAUTNOAHO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA
           ELSE
           IF POZ-IND-CAUT IN POZ = 'S'
               IF TAB-CIC-CTAB IN TAB = 'CTE' OR 'AHO'           
                   NEXT SENTENCE
               ELSE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICIAUTNOCTA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA.
       CER-VAL-AUZ-CAI-ICYA.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF TAB-CIC-CTAB IN TAB = 'AHO' AND
              OPE-COD-VCOP IN OPE = WSS-COD-PESO
               MOVE AUZ-CAI-ICYA IN OPZ-FLD TO WSS-CAI-ICTA
               MOVE AUZ-IIC-ICYA IN OPZ-FLD TO WSS-IIC-ICTA
               PERFORM VAL-CARATULA
               IF MSG-COD-MENS > SPACES
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-AUZ-CAI-ICYA.
      * Si el producto opera como 'B', la moneda de la cuenta de cargo
      * debe ser moneda nacional. En caso contrario, la moneda de
      * la cuenta debe ser igual a la moneda de la operacion.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ
           IF NOT ( OPE-COD-VCOP IN OPE = OPZ-COD-VCOC IN OPZ-FLD OR
                   ( OPE-COD-VCOP IN OPE = WSS-COD-PESO AND
                     OPZ-MSC-TVOC = '0'))
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'AUTVCOP<>OPZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-AUZ-CAI-ICYA.
           IF OPE-FEC-FTOP IN OPE > ZEROES AND
              OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'FECFTOPZCCER' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_RET_COZ_OPZ
      *<<<< FIN_RET_COZ_OPZ
           MOVE FRM-SGV-TFLV IN OPZ-FLD TO WSS-SGV-TCOM.
      *>>>>
*% END
*% IF VAL_CON_FLD_OPZ
      *<<<< VAL_CON_FLD_OPZ
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
           IF SCR-CCPP = 'ING' AND
              ( OFI-CIC-OFIC IN OFI = '000' OR '111' )
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TPP'                   TO TAB-COD-TTAB IN TAB
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-COD-TOOC
               MOVE OPZ-COD-AOOC IN OPZ-FLD TO WSS-COD-AOOC
               MOVE WSS-COD-CAUX            TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-COD-TOOC
                   MOVE SPACES                  TO WSS-COD-AOOC
                   MOVE WSS-COD-CAUX            TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = 'COD    NEX'
                       NEXT SENTENCE
                   ELSE
                       MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DTPP
                       IF OFI-CIC-OFIC IN OFI NOT = WSS-CIC-OFIC
                           MOVE 'CBZ'          TO MSG-COD-SIST
                           MOVE 'OFOC<>OFITPP' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-CON-FLD-OPZ
                       ELSE
                           NEXT SENTENCE
               ELSE
                   MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DTPP
                   IF OFI-CIC-OFIC IN OFI NOT = WSS-CIC-OFIC
                       MOVE 'CBZ'          TO MSG-COD-SIST
                       MOVE 'OFOC<>OFITPP' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-FLD-OPZ
                   ELSE
                       NEXT SENTENCE.
           IF NOT ( SCR-CCPP = 'ING' AND
                    OPZ-CAI-IOPC IN OPZ-FLD NOT > SPACES AND
                    OPZ-IIC-IOPC IN OPZ-FLD NOT > ZEROES )
               GO TO SIG-VAL-CON-FLD-OPZ.
           MOVE 'Z'                     TO CIC-COD-TCIC IN CIC.
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO CIC-COD-CCIC IN CIC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CICSTAT'    TO MSG-COD-TMSG
               MOVE CIC-STAT-NEX TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
           IF CIC-IND-VIGE = 'N'
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CICSTAT'    TO MSG-COD-TMSG
               MOVE CIC-STAT-NVG TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
       LUP-VAL-CON-FLD-OPZ.
           ADD 1 TO CIC-NUM-ICIC.
           MOVE CIC-CIC-ICIC IN CIC TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               GO TO SIG-VAL-CON-FLD-OPZ.
      *En este caso ya existe una operacion con el numero a asignar
      *Llamo a rutina PRO-CIC para aumentar el correlativo
           MOVE 'Z'                     TO CIC-COD-TCIC IN CIC.
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ
           ELSE
               GO TO LUP-VAL-CON-FLD-OPZ.
       SIG-VAL-CON-FLD-OPZ.
           IF SCR-CMND = 'MCA'
               GO TO FIN-VAL-CON-FLD-OPZ.
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-VAL-CON-FLD-OPZ.

           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
           MOVE 1 TO CAM-SGV-VCAM IN CAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               GO TO VRF-MON-NAC.

           MOVE '0999  '                TO TAB-CIC-CTAB IN TAB.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO TAB-COD-CTAB IN TAB.
           MOVE OPZ-NUM-DCOL IN OPZ-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE OPZ-NUM-MCOL IN OPZ-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE OPZ-NUM-SCOL IN OPZ-FLD TO TAB-NUM-STRN IN TAB.
           MOVE OPZ-NUM-ACOL IN OPZ-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS NOT = SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
       VRF-MON-NAC.
           MULTIPLY OPZ-VAL-SCRE IN OPZ-FLD BY CAM-SGV-VCAM IN CAM
                                            GIVING WSS-VAL-SVEN.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.

           IF OPZ-IND-RENO IN OPZ-FLD = 'NOV'
               PERFORM ROZ-NOV-RENO
               IF MSG-COD-MENS > SPACES
                   MOVE 'CBZ' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-OPZ
               ELSE
                   NEXT SENTENCE
           ELSE
           IF (OPZ-IND-RENO IN OPZ-FLD = 'REN' OR 'PRO') AND
              ROZ-SGV-RENO IN OPZ-FLD > WSS-VAL-SVEN
      * Valida si se permite que TIO pueda ser renovado o prorrogado
      * por un monto menor
               MOVE OPZ-IND-RENO IN OPZ-FLD TO WSS-IND-RENO
               MOVE 'MONTO<'                TO WSS-GLS-RENO
               MOVE OPZ-COD-TOOC IN OPZ-FLD TO WSS-TIO-RENO
      *
               MOVE 'CBZ'        TO FIO-SIST
               MOVE 'VSN'        TO TAB-COD-TTAB IN TAB
               MOVE WSS-KEY-RENO TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   NEXT SENTENCE
               ELSE
               IF OPZ-IND-RENO IN OPZ-FLD = 'REN'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'VALRENO>CRED' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-OPZ
               ELSE
               IF OPZ-IND-RENO IN OPZ-FLD = 'PRO'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'VALPROR>CRED' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-OPZ.

           IF OPZ-IND-RENO IN OPZ-FLD NOT > SPACES AND
              ROZ-SGV-RENO IN OPZ-FLD NOT = ZEROES
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'VALRENONRENO' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-OPZ
           ELSE
           IF OPZ-IND-RENO IN OPZ-FLD > SPACES AND
              ROZ-SGV-RENO IN OPZ-FLD = ZEROES
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'VALRENOSRENO' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-OPZ.

      * Valida que cuando sea Pesos la moneda no acepte valores con decimales
       INI-VAL-PES-DECI.
           PERFORM BUS-COD-PESO.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ
           ELSE
               IF OPZ-COD-VCOC IN OPZ-FLD NOT = WSS-COD-PESO
                   GO TO FIN-VAL-PES-DECI.

           MOVE OPZ-VAL-CRED IN OPZ-FLD TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM
           PERFORM PES-SCTV
           IF OPZ-VAL-CRED IN OPZ-FLD NOT = PES-SGV-ENTE
               GO TO MSG-VAL-PES-DECI.

           MOVE ROZ-SGV-RENO IN OPZ-FLD TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM
           PERFORM PES-SCTV
           IF ROZ-SGV-RENO IN OPZ-FLD NOT = PES-SGV-ENTE
               GO TO MSG-VAL-PES-DECI.

           MOVE OPZ-SGV-VCOM IN OPZ-FLD TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM
           PERFORM PES-SCTV
           IF OPZ-SGV-VCOM IN OPZ-FLD NOT = PES-SGV-ENTE
               GO TO MSG-VAL-PES-DECI.

           MOVE OPZ-VAL-GAST IN OPZ-FLD TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM
           PERFORM PES-SCTV
           IF OPZ-VAL-GAST IN OPZ-FLD NOT = PES-SGV-ENTE
               GO TO MSG-VAL-PES-DECI.

           MOVE OPZ-SGV-LIQU IN OPZ-FLD TO PES-SGV-DECI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO PES-COD-VCAM
           PERFORM PES-SCTV
           IF OPZ-SGV-LIQU IN OPZ-FLD NOT = PES-SGV-ENTE
               GO TO MSG-VAL-PES-DECI.

           GO TO FIN-VAL-PES-DECI.
       MSG-VAL-PES-DECI.
           MOVE 'CBZ'       TO MSG-COD-SIST.
           MOVE 'VALNODECI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-FLD-OPZ.
       FIN-VAL-PES-DECI.
           IF OPZ-FEC-FINP IN OPZ-FLD = OPZ-FEC-FCOL IN OPZ-FLD
               MOVE OPZ-FEC-FINP IN OPZ-FLD TO OPZ-FEC-FING IN OPZ-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI = WSS-FEC-FAUX IN WSS-VARI
               MOVE OPZ-FEC-FINP IN OPZ-FLD TO OPZ-FEC-FING IN OPZ-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI > WSS-FEC-FAUX IN WSS-VARI
               MOVE OPZ-FEC-FCOL IN OPZ-FLD TO OPZ-FEC-FING IN OPZ-FLD.

           IF DBC-IND-ICLI IN OPZ-FLD NOT = 'M' AND
              DBC-NUM-ICLI IN OPZ-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN OPZ-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPZ-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPZ-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               PERFORM VAL-ACTI
               IF MSG-COD-MENS > SPACES
                   MOVE 'CBZ' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE POZ-COD-ACTI IN POZ TO FRM-MEN2
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-OPZ.
       CON-VAL-CON-FLD-OPZ.
           IF WSS-ES-COM-FLA AND WSS-ES-COM-INF
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'PCPCOMIINC  ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
           GO TO CON-COZ-SGV-TINT.

       CON-COZ-SGV-TINT.
           MOVE SPACES TO MSG-COD-MENS
           PERFORM VAL-CTE-AHO
           IF MSG-COD-MENS > SPACES
               MOVE 'CBZ'          TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MEN1
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-CAI-ICYA-LEN IN OPZ-FLD
               GO TO FIN-VAL-CON-FLD-OPZ.
           IF CYZ-IIC-ICYA IN OPZ-FLD NOT > ZEROES
               GO TO NOT-VAL-CYZ.

       VAL-CLI-CYZ.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               GO TO NOT-VAL-CYZ.

           MOVE RDZ-CAI-ICLI IN OPZ-FLD TO RCO-CAI-ICLI IN RCO.
           MOVE RDZ-IIC-ICLI IN OPZ-FLD TO RCO-IIC-ICLI IN RCO.
           MOVE CYZ-CAI-ICYA IN OPZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYZ-IIC-ICYA IN OPZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF WSS-GLS-DAT1 = 'O'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYASICLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN OPZ-FLD
                   GO TO FIN-VAL-CON-FLD-OPZ
               ELSE
                   GO TO CER-VAL-CYZ-CAI-ICYA.

           MOVE CYZ-CAI-ICYA IN OPZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYZ-IIC-ICYA IN OPZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'        TO MSG-COD-SIST
               MOVE 'CICICYANEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1  TO CYZ-CAI-ICYA-LEN IN OPZ-FLD
               GO TO FIN-VAL-CON-FLD-OPZ
           ELSE
               IF WSS-GLS-DAT1 = 'M'
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'CICICYANICLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1  TO CYZ-CAI-ICYA-LEN IN OPZ-FLD
                   GO TO FIN-VAL-CON-FLD-OPZ.
       CER-VAL-CYZ-CAI-ICYA.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ
           IF NOT ( OPE-COD-VCOP IN OPE = OPZ-COD-VCOC IN OPZ-FLD OR
                   ( OPE-COD-VCOP IN OPE = WSS-COD-PESO AND
                     OPZ-MSC-TVOC = '0'))
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'CYAVCOP<>OPZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-OPZ.
           IF OPE-FEC-FTOP IN OPE > ZEROES
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
                   MOVE 'CBZ'          TO MSG-COD-SIST
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
       NOT-VAL-CYZ.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-CTE-AHO SECTION.
       INI-VAL-CTE-AHO.
           IF WSS-CIC-TCYA = 'CC' OR 'AH'
               IF CYZ-IIC-ICYA IN OPZ-FLD NOT > ZEROES
                   MOVE 'IICICYACAOBL' TO MSG-COD-MENS
                   GO TO FIN-VAL-CTE-AHO
               ELSE
                   NEXT SENTENCE
           ELSE
               IF CYZ-IIC-ICYA IN OPZ-FLD > ZEROES
                   MOVE 'IICICYABLKS ' TO MSG-COD-MENS
                   GO TO FIN-VAL-CTE-AHO
               ELSE
                   MOVE SPACES TO CYZ-CAI-ICYA IN OPZ-FLD
                   MOVE ZEROES TO CYZ-IIC-ICYA IN OPZ-FLD
                   GO TO FIN-VAL-CTE-AHO.

           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE CYZ-CAI-ICYA IN OPZ-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYZ-IIC-ICYA IN OPZ-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'CICICYANEX' TO MSG-COD-MENS
               GO TO FIN-VAL-CTE-AHO.
           MOVE 'TAB'               TO TAB-COD-SIST
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
           MOVE RCO-COD-TOPR IN RCO TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           IF WSS-CIC-TCYA = 'CC'
               IF TAB-CIC-CTAB IN TAB = 'CTE'
                   NEXT SENTENCE
               ELSE
                   MOVE 'CICICYANOCTE' TO MSG-COD-MENS
                   GO TO FIN-VAL-CTE-AHO
           ELSE
           IF WSS-CIC-TCYA = 'AH'
               IF TAB-CIC-CTAB IN TAB = 'AHO'           
                   NEXT SENTENCE
               ELSE
                   MOVE 'CICICYANOAHO' TO MSG-COD-MENS
                   GO TO FIN-VAL-CTE-AHO.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF TAB-CIC-CTAB IN TAB = 'AHO' AND
              OPE-COD-VCOP IN OPE = WSS-COD-PESO
               MOVE CYZ-CAI-ICYA IN OPZ-FLD TO WSS-CAI-ICTA
               MOVE CYZ-IIC-ICYA IN OPZ-FLD TO WSS-IIC-ICTA
               PERFORM VAL-CARATULA
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-VAL-CTE-AHO.
       FIN-VAL-CTE-AHO.
           EXIT.

       VAL-CARATULA SECTION.
       INI-VAL-CARATULA.
           IF WSS-CAI-ICTA-NUM < 200
               MOVE 000 TO WSS-SUC-CTA-AHO
           ELSE
               MOVE WSS-CAI-ICTA-NUM TO WSS-SUC-CTA-AHO.
           MOVE WSS-IIC-ICTA-NUM TO WSS-COD-CTA-AHO.

           MOVE WSS-CTA-AHO TO AHO-COD-ICTA IN AHO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-AHO.
           IF NOT FIO-STAT-OKS
               MOVE 'AHOICTANEX  ' TO MSG-COD-MENS
               MOVE WSS-CTA-AHO    TO FRM-MEN2
               GO TO FIN-VAL-CARATULA.
           IF AHO-COD-CRTL NOT = 'C'
               MOVE 'AHOICTANOCAR' TO MSG-COD-MENS
               MOVE WSS-CTA-AHO    TO FRM-MEN2
               GO TO FIN-VAL-CARATULA.
       FIN-VAL-CARATULA.
           EXIT.

       VAL-ACTI SECTION.
       INI-VAL-ACTI.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-COD-DIGT.
           IF POZ-COD-ACTI IN POZ > SPACES
               MOVE POZ-COD-ACTI IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 9 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'ACT' TO TAB-COD-TTAB IN TAB
                   MOVE POZ-COD-ACTI IN POZ TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE NUM-NN9N TO WSS-NUM-DIGT
                       MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
                   ELSE
                   IF POZ-COD-ACTI IN POZ NOT = DBC-COD-ACTI IN DBC 
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF POZ-COD-ACTI IN POZ NOT = DBC-COD-ACTI IN DBC 
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-ACTI.
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB
           MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = TAB-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CODACTINEFAM' TO MSG-COD-MENS
               GO TO FIN-VAL-ACTI.
       FIN-VAL-ACTI.
           EXIT.
       ROZ-NOV-RENO SECTION.
       INI-ROZ-NOV-RENO.
           PERFORM BUS-COD-PESO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ROZ-NOV-RENO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ-CAI-IOPC IN OPZ-FLD TO CAZ-CAI-IOPC IN CAZ.
           MOVE CAZ-IIC-IOPC IN OPZ-FLD TO CAZ-IIC-IOPC IN CAZ.
           MOVE CAZ-NUM-ICAN IN OPZ-FLD TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT FIO-STAT-OKS
               MOVE OPZ-VAL-CRED IN OPZ-FLD TO ROZ-SGV-RENO IN OPZ-FLD
               GO TO FIN-ROZ-NOV-RENO.
           MOVE CAZ-KEY-ICAN IN CAZ TO ROZ-KEY-IVCT IN ROZ.
           MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE ZEROES TO NOV-SGV-SNOV IN WSS-VARI.
       NXT-ROZ-NOV-RENO.
           PERFORM CBZ-FIO-ROZ.
           IF FIO-STAT-OKS AND
              CAZ-KEY-ICAN IN CAZ = ROZ-KEY-IVCT IN ROZ 
                IF ROZ-MSC-STAT IN ROZ NOT > SPACES OR
                   ROZ-MSC-STAT IN ROZ = 'S'
                    PERFORM OBT-VAL-CAMB
                    IF MSG-COD-MENS > SPACES
                        GO TO FIN-ROZ-NOV-RENO
                    ELSE
                    IF SCR-CCPP = 'ING' 
                        ADD NOV-SGV-DIFE IN WSS-VARI TO NOV-SGV-SNOV 
                        MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                        MOVE FIO-GET-NXT TO FIO-CMND
                        GO TO NXT-ROZ-NOV-RENO
                    ELSE
                    IF ROZ-CAI-IOPC IN ROZ = OPZ-CAI-IOPC 
                                           IN OPZ-FLD AND
                       ROZ-IIC-IOPC IN ROZ = OPZ-IIC-IOPC
                                               IN OPZ-FLD
                        MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                        MOVE FIO-GET-NXT TO FIO-CMND
                        GO TO NXT-ROZ-NOV-RENO
                    ELSE
                        ADD NOV-SGV-DIFE IN WSS-VARI TO NOV-SGV-SNOV 
                        MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                        MOVE FIO-GET-NXT TO FIO-CMND
                        GO TO NXT-ROZ-NOV-RENO
                ELSE
                    MOVE 'ROZ-KEY-IVCT' TO FIO-AKEY
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO NXT-ROZ-NOV-RENO.
      *
      * Leo la OPZ del credito a novar para obtener el codigo de moneda
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZ    NEX' TO MSG-COD-MENS
               GO TO FIN-ROZ-NOV-RENO.
           MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV.
           IF OPZ-COD-VCOC IN OPZ NOT = OPZ-COD-VCOC IN OPZ-FLD
               MOVE OPZ-COD-VCOC IN OPZ TO WSS-COD-VCOC-CNV
               MOVE CAZ-SGV-TREN IN CAZ TO WSS-SGV-RENO-CNV
               PERFORM CONVIERTE-VALOR
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-ROZ-NOV-RENO.
           SUBTRACT NOV-SGV-SNOV IN WSS-VARI FROM WSS-SGV-RENO-CNV
                    GIVING NOV-SGV-DIFE IN WSS-VARI.
           IF NOV-SGV-DIFE IN WSS-VARI < ZEROES
               MOVE 'OPZRENONOING' TO MSG-COD-MENS
               GO TO FIN-ROZ-NOV-RENO.
           IF SCR-CCPP = 'ING' AND
              NOV-SGV-DIFE IN WSS-VARI = ZEROES
               MOVE 'OPZRENONOING' TO MSG-COD-MENS
               GO TO FIN-ROZ-NOV-RENO.
           PERFORM OBT-VAL-CAMB-OPZ.
           MULTIPLY OPZ-VAL-CRED IN OPZ-FLD BY CAM-SGV-VCAM IN CAM
                    GIVING NOV-SGV-SNOV IN WSS-VARI ROUNDED.
           MOVE NOV-SGV-SNOV IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD  TO PES-COD-VCAM IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO NOV-SGV-SNOV IN WSS-VARI.
           IF ROZ-SGV-RENO IN OPZ-FLD NOT > ZEROES
               IF NOV-SGV-SNOV > NOV-SGV-DIFE IN WSS-VARI
                   MOVE NOV-SGV-DIFE IN WSS-VARI TO 
                                             ROZ-SGV-RENO IN OPZ-FLD
               ELSE
                   MOVE NOV-SGV-SNOV IN WSS-VARI TO 
                                             ROZ-SGV-RENO IN OPZ-FLD
           ELSE
               IF (ROZ-SGV-RENO IN OPZ-FLD > NOV-SGV-DIFE IN WSS-VARI 
                   AND NOV-SGV-DIFE IN WSS-VARI > ZEROES )         OR
                  ROZ-SGV-RENO IN OPZ-FLD > NOV-SGV-SNOV IN WSS-VARI 
                    MOVE 'OPZVALRENOINV' TO MSG-COD-MENS.
       FIN-ROZ-NOV-RENO.
           EXIT.

       OBT-VAL-CAMB SECTION.
       INI-OBT-VAL-CAMB.
           IF ROZ-COD-VCVR IN ROZ = OPZ-COD-VCOC IN OPZ-FLD
               MOVE ROZ-SGV-RENO IN ROZ TO NOV-SGV-DIFE IN WSS-VARI
               GO TO FIN-OBT-VAL-CAMB.

           IF WSS-COD-PESO = ROZ-COD-VCVR IN ROZ
               MOVE ROZ-SGV-RENO IN ROZ TO NOV-SGV-DIFE IN WSS-VARI
           ELSE
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE ROZ-COD-VCVR IN ROZ TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   GO TO FIN-OBT-VAL-CAMB
               ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'CAM    NVG' TO MSG-COD-MENS
                   GO TO FIN-OBT-VAL-CAMB
               ELSE
                   MULTIPLY ROZ-SGV-RENO IN ROZ BY CAM-SGV-VCAM IN CAM
                            GIVING NOV-SGV-DIFE IN WSS-VARI ROUNDED
                   MOVE WSS-COD-PESO       TO PES-COD-VCAM IN PES-VARI
                   MOVE NOV-SGV-DIFE IN WSS-VARI
                                           TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI
                                           TO NOV-SGV-DIFE IN WSS-VARI.

           IF WSS-COD-PESO = OPZ-COD-VCOC IN OPZ-FLD
               GO TO FIN-OBT-VAL-CAMB.

           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(1)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(1)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(1)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(1)
           MOVE CAZ-NUM-DCAN IN CAZ     TO CAM-NUM-DCAM IN CAM(2)
           MOVE CAZ-NUM-MCAN IN CAZ     TO CAM-NUM-MCAM IN CAM(2)
           MOVE CAZ-NUM-SCAN IN CAZ     TO CAM-NUM-SCAM IN CAM(2)
           MOVE CAZ-NUM-ACAN IN CAZ     TO CAM-NUM-ACAM IN CAM(2)
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO            TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY  TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               GO TO FIN-OBT-VAL-CAMB
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
               MOVE 'CAM    NVG' TO MSG-COD-MENS
               GO TO FIN-OBT-VAL-CAMB
           ELSE
               DIVIDE NOV-SGV-DIFE IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                      GIVING NOV-SGV-DIFE IN WSS-VARI ROUNDED
               MOVE OPZ-COD-VCOC IN OPZ-FLD
                                        TO PES-COD-VCAM IN PES-VARI
               MOVE NOV-SGV-DIFE IN WSS-VARI
                                        TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI
                                        TO NOV-SGV-DIFE IN WSS-VARI.
       FIN-OBT-VAL-CAMB.
           EXIT.

       OBT-VAL-CAMB-OPZ SECTION.
       INI-OBT-VAL-CAMB-OPZ.
           MOVE 1 TO CAM-SGV-VCAM IN CAM.
           IF WSS-COD-PESO NOT = OPZ-COD-VCOC IN OPZ-FLD
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAZ-NUM-DCAN IN CAZ TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAZ-NUM-MCAN IN CAZ TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAZ-NUM-SCAN IN CAZ TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAZ-NUM-ACAN IN CAZ TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPZ-COD-VCOC IN OPZ-FLD TO 
                                           CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO        TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   GO TO FIN-OBT-VAL-CAMB-OPZ
               ELSE
                   IF CAM-IND-VIGE IN CAM NOT = 'S'
                       MOVE 'CAM    NVG' TO MSG-COD-MENS
                       GO TO FIN-OBT-VAL-CAMB-OPZ.
       FIN-OBT-VAL-CAMB-OPZ.
           EXIT.

       BUS-EVE-PCP SECTION.
       INI-BUS-EVE-PCP.
      *HZF-INI 12-DEC-1996
           PERFORM OBT-CIC-ICLI.
           MOVE RDZ-CIC-ICLI IN RDZ TO CCO-CIC-ICLI.
      *HZF-FIN 12-DEC-1996
       SIG-BUS-EVE-PCP.
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO WSS-TIP-OFIC IN WSS-VARI.
           PERFORM BUS-REG-PCP.
           IF PCZ-KEY-IPCP IN PCZ NOT > SPACES
               MOVE '*' TO WSS-TIP-OFIC IN WSS-VARI
               PERFORM BUS-REG-PCP.
           IF PCZ-KEY-IPCP IN PCZ NOT > SPACES AND WSS-TIP-PROC = 'NEG'
               MOVE 'CUR' TO WSS-TIP-PROC
               GO TO INI-BUS-EVE-PCP.

      *HZF-INI 12-DEC-1996
           IF PCZ-KEY-IPCP IN PCZ NOT > SPACES AND
              CCO-IIC-ICLI NOT = ZEROES AND
              WSS-TIP-PROC NOT = 'CAN'
              MOVE SPACES TO CCO-CAI-ICLI
              MOVE ZEROES TO CCO-IIC-ICLI
              IF OPZ-IND-RENO IN OPZ-FLD NOT = SPACES
                  MOVE 'NEG' TO WSS-TIP-PROC
                  GO TO SIG-BUS-EVE-PCP 
              ELSE
                  GO TO SIG-BUS-EVE-PCP.
      *HZF-FIN 12-DEC-1996
       FIN-BUS-EVE-PCP.
           EXIT.

      *HZF-INI 12-DEC-1996
       OBT-CIC-ICLI SECTION.
       INI-OBT-CIC-ICLI.
           MOVE OPZ-CAI-IOPC IN OPZ TO RDZ-CAI-IOPC IN RDZ.
           MOVE OPZ-IIC-IOPC IN OPZ TO RDZ-IIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              RDZ-CAI-IOPC IN RDZ = OPZ-CAI-IOPC IN OPZ AND
              RDZ-IIC-IOPC IN RDZ = OPZ-IIC-IOPC IN OPZ AND
              RDZ-NUM-IDLC IN RDZ = ZEROS
               NEXT SENTENCE
           ELSE
               MOVE SPACES TO RDZ-CIC-ICLI IN RDZ
               MOVE ZEROES TO RDZ-CIC-ICLI IN RDZ. 
      *
       FIN-OBT-CIC-ICLI.
           EXIT.
      *HZF-FIN 12-DEC-1996

       BUS-REG-PCP SECTION.
       INI-BUS-REG-PCP.
           MOVE OPZ-COD-PLCO IN OPZ-FLD  TO PCZ-COD-PLAN IN PCZ.
      *HZF-INI 12-DEC-1996
           MOVE CCO-CIC-ICLI             TO PCZ-CIC-ICLI IN PCZ.
      *HZF-FIN 12-DEC-1996
           MOVE WSS-TIP-PROC IN WSS-VARI TO PCZ-COD-EVEN IN PCZ.
           MOVE WSS-TIP-OFIC IN WSS-VARI TO PCZ-COD-OFIC IN PCZ.
           MOVE OPZ-NUM-DCOL IN OPZ-FLD  TO PCZ-NUM-DPLA IN PCZ
                                            OPZ-NUM-DCOL IN OPZ.
           MOVE OPZ-NUM-MCOL IN OPZ-FLD  TO PCZ-NUM-MPLA IN PCZ
                                            OPZ-NUM-MCOL IN OPZ.
           MOVE OPZ-NUM-SCOL IN OPZ-FLD  TO PCZ-NUM-SPLA IN PCZ
                                            OPZ-NUM-SCOL IN OPZ.
           MOVE OPZ-NUM-ACOL IN OPZ-FLD  TO PCZ-NUM-APLA IN PCZ
                                            OPZ-NUM-ACOL IN OPZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-REG-PCP.
           PERFORM CBZ-FIO-PCZ.
           IF FIO-STAT-OKS AND
              PCZ-COD-PLAN IN PCZ = OPZ-COD-PLCO IN OPZ-FLD AND
              PCZ-COD-EVEN IN PCZ = WSS-TIP-PROC IN WSS-VARI AND
      *HZF-INI 12-DEC-1996
              PCZ-CIC-ICLI IN PCZ = CCO-CIC-ICLI AND
      *HZF-FIN 12-DEC-1996
              PCZ-COD-OFIC IN PCZ = WSS-TIP-OFIC IN WSS-VARI
               IF PCZ-IND-VIGE IN PCZ = 'N'
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-BUS-REG-PCP
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SPACES TO PCZ.
       FIN-BUS-REG-PCP.
           EXIT.
       BUS-DBC-DCOR SECTION.
       INI-BUS-DBC-DCOR.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               IF DBC-NUM-DCOR IN DBC NOT > ZEROES
                   MOVE 'DIR    NEX' TO MSG-COD-MENS
               ELSE
                   MOVE DBC-NUM-DCOR IN DBC TO
                        RDZ-NUM-DIRE IN OPZ-FLD
           ELSE
               MOVE 'DIR    NEX' TO MSG-COD-MENS.
       FIN-BUS-DBC-DCOR.
           EXIT.
      *>>>>
*% END
*% END
