       GET-OPZ SECTION.
       INI-GET-OPZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
       FIN-GET-OPZ.
           EXIT.

       GET-MON SECTION.
       INI-GET-MON.
           MOVE SPACES TO WSS-CIC-VCAM.
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
       FIN-GET-MON.
           EXIT.

       INI-REG-CYZ SECTION.
       INI-INI-REG-CYZ.
           MOVE SPACES TO CYZ-GLS-FLAG IN CYZ.
           MOVE SPACES TO CYZ-VRF-ICYA IN CYZ.
           MOVE ZEROES TO CYZ-SGV-LIQU IN CYZ.
           MOVE SPACES TO CYZ-GLS-DISP IN CYZ.
       FIN-INI-REG-CYZ.
           EXIT.

       ACT-CYZ SECTION.
       INI-ACT-CYZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF ( FIO-STAT-OKS AND
                CAZ-CIC-IOPC IN CAZ = CYZ-CIC-IOPC IN CYZ AND
                CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM CBZ-FIO-CYZ
               PERFORM RET-CYZ-CAZ
               IF CAZ-SGV-TPAG IN CAZ > ZEROES
                   PERFORM BUS-TCYA
                   MOVE CAZ-SGV-TPAG IN CAZ TO CYZ-SGV-LIQU IN CYZ
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM CBZ-FIO-CYZ
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM CBZ-FIO-CYZ
           ELSE
               IF CAZ-SGV-TPAG IN CAZ > ZEROES
                   PERFORM INI-REG-CYZ
                   MOVE CAZ-CIC-IOPC IN CAZ TO CYZ-CIC-IOPC IN CYZ
                   MOVE CAZ-NUM-ICAN IN CAZ TO CYZ-NUM-ICAN IN CYZ
                   PERFORM RET-CYZ-CAZ
                   MOVE 1                   TO CYZ-NUM-ICYA IN CYZ
                   MOVE CAZ-SGV-TPAG IN CAZ TO CYZ-SGV-LIQU IN CYZ
                   PERFORM BUS-TCYA
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM CBZ-FIO-CYZ.

           PERFORM ACT-CYZ-IABO.

       FIN-ACT-CYZ.
           EXIT.


       ACT-CYZ-IABO SECTION.
       INI-ACT-CYZ-IABO.
           MOVE CAZ-CIC-IOPC IN CAZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ACT-CYZ-IABO.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS AND
                CAZ-CIC-IOPC IN CAZ = CYZ-CIC-IOPC IN CYZ AND
                CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
                 GO TO ING-ACT-CYZ-IABO.
                
           IF CYZ-NUM-ICYA IN CYZ NOT > 1
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-ACT-CYZ-IABO.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           PERFORM RET-CYZ-CAZ.
           IF FRM-VAL-IABO IN CAZ-FLD > ZEROES
               MULTIPLY FRM-VAL-IABO IN CAZ-FLD BY -1 GIVING
                                         CYZ-SGV-LIQU IN CYZ
               MOVE FIO-MOD TO FIO-CMND
               PERFORM CBZ-FIO-CYZ
           ELSE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM CBZ-FIO-CYZ.

           GO TO FIN-ACT-CYZ-IABO.

       ING-ACT-CYZ-IABO.
           IF FRM-VAL-IABO IN CAZ-FLD > ZEROES
               PERFORM INI-REG-CYZ
               MOVE CAZ-CIC-IOPC IN CAZ     TO CYZ-CIC-IOPC IN CYZ
               MOVE CAZ-NUM-ICAN IN CAZ     TO CYZ-NUM-ICAN IN CYZ
               MOVE 'CMCA'                  TO CYZ-IND-TCYA IN CYZ
               MOVE FRM-CAI-IABO IN CAZ-FLD TO CYZ-CAI-ICYA IN CYZ
               MOVE FRM-IIC-IABO IN CAZ-FLD TO CYZ-IIC-ICYA IN CYZ
               MOVE 2                       TO CYZ-NUM-ICYA IN CYZ
               MULTIPLY FRM-VAL-IABO IN CAZ-FLD BY -1 GIVING
                                               CYZ-SGV-LIQU IN CYZ
               MOVE FIO-PUT TO FIO-CMND
               PERFORM CBZ-FIO-CYZ.
       FIN-ACT-CYZ-IABO.
           EXIT.

       BUS-TCYA SECTION.
       INI-BUS-TCYA.
           MOVE SPACES TO CYZ-IND-MAUT IN CYZ.
           IF CYZ-IND-TCYA IN CYZ > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-COD-DAT1(2) TO CYZ-IND-MAUT IN CYZ.
       FIN-BUS-TCYA.
           EXIT.

       ACT-ROZ SECTION.
       INI-ACT-ROZ.
           PERFORM UPD-MOD-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-ROZ.

           IF ROZ-IIC-IOPC IN CAZ-FLD > ZEROES AND

              ROZ-CAI-IOPC IN CAZ-FLD = SCR-ROV-CAI-IOPC AND
              ROZ-IIC-IOPC IN CAZ-FLD = SCR-ROV-IIC-IOPC
              DIVIDE CAZ-SGV-TREN IN CAZ-FLD BY
                     SCR-SGV-VCAM GIVING ROZ-SGV-RENO IN ROZ
                     MOVE FIO-MOD TO FIO-CMND
                     PERFORM CBZ-FIO-ROZ
           ELSE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM CBZ-FIO-ROZ
               PERFORM ASS-OPZ-ROZ.
       FIN-ACT-ROZ.
           EXIT.

       ASS-OPZ-ROZ SECTION.
       INI-ASS-OPZ-ROZ.
           IF ROZ-IIC-IOPC IN CAZ-FLD > ZEROES
               MOVE ROZ-CAI-IOPC IN CAZ-FLD TO CIC-CAI-ICIC
               MOVE ROZ-IIC-IOPC IN CAZ-FLD TO CIC-IIC-ICIC
           ELSE
               PERFORM BUS-NUM-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS     TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-ASS-OPZ-ROZ
               ELSE
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'OPZASIGROZ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1

                   MOVE SPACES TO WSS-MEN2
                   MOVE CIC-CIC-ICIC TO WSS-MEN2-A
                   MOVE MSG-GLS-DATA TO WSS-MEN2-B
                   MOVE WSS-MEN2     TO FRM-MEN2
                   MOVE SPACES TO WSS-MEN2

                   MOVE FRM-MENS TO SCR-MENS-EXT.
           PERFORM INI-ROZ.

           MOVE CIC-CAI-ICIC            TO ROZ-CAI-IOPC IN ROZ.
           MOVE CIC-IIC-ICIC            TO ROZ-IIC-IOPC IN ROZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ROZ-CAI-IOPV IN ROZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ROZ-IIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO ROZ-NUM-IVCT IN ROZ.
           DIVIDE CAZ-SGV-TREN IN CAZ-FLD BY
                  SCR-SGV-VCAM GIVING ROZ-SGV-RENO IN ROZ.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
       FIN-ASS-OPZ-ROZ.
           EXIT.

       BUS-NUM-CIC SECTION.
       INI-BUS-NUM-CIC.
           MOVE 'D'                     TO CIC-COD-TCIC IN CIC
           MOVE CAZ-COD-OFCA IN CAZ-FLD TO CIC-COD-CCIC IN CIC
           MOVE CIC-GET                 TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
               GO TO FIN-BUS-NUM-CIC
           ELSE
               MOVE ADR-OPZ-REQA TO ADR-AUX-REQA
               MOVE CIC-CIC-ICIC IN CIC TO OPZ-CIC-IOPC IN OPZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               IF FIO-STAT-OKS
                   GO TO INI-BUS-NUM-CIC
               ELSE
                   MOVE ADR-AUX-REQA TO ADR-OPZ-REQA
                   MOVE FIO-KDEF-S   TO FIO-KDEF
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM CBZ-FIO-OPZ.
       FIN-BUS-NUM-CIC.
           EXIT.

       UPD-MOD-ROZ SECTION.
       INI-UPD-MOD-ROZ.
           MOVE SCR-ROV-CAI-IOPC TO ROZ-CAI-IOPC IN ROZ.
           MOVE SCR-ROV-IIC-IOPC TO ROZ-IIC-IOPC IN ROZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO ROZ-CAI-IOPV IN ROZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO ROZ-IIC-IOPV IN ROZ.
           MOVE CAZ-NUM-ICAN IN CAZ-FLD TO ROZ-NUM-IVCT IN ROZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-ROZ.
       FIN-UPD-MOD-ROZ.
           EXIT.

       ACT-RCZ SECTION.
       INI-ACT-RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO RCZ-NUM-ICAN IN RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPV IN RCZ.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEZ-NUM-IVEN IN VEZ TO RCZ-NUM-IVCT IN RCZ
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE ZEROES TO RCZ-NUM-IVCT IN RCZ
           ELSE
                MOVE VEZ-NUM-IVEN IN VEZ TO RCZ-NUM-IVCT IN RCZ.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF FIO-STAT-OKS
               PERFORM RET-RCZ-CAZ
               PERFORM CAL-RCZ
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               PERFORM INI-RCZ
               PERFORM INI-KDLZ
               PERFORM RET-RCZ-CAZ
               PERFORM INI-KDLZ
               PERFORM CAL-RCZ
               MOVE FIO-PUT TO FIO-CMND.
           MOVE SCR-RCV-STAT TO RCZ-MSC-STAT IN RCZ.
           MOVE VEZ-IND-SCTB IN VEZ TO RCZ-IND-SCTB IN RCZ.
           MOVE VEZ-IND-SCBZ IN VEZ TO RCZ-IND-SCBZ IN RCZ.
           PERFORM CBZ-FIO-RCZ.
       FIN-ACT-RCZ.
           EXIT.

       CAL-RCZ SECTION.
       INI-CAL-RCZ.
           PERFORM GET-MON.
           IF  WSS-CIC-TVAL = '0' AND
               WSS-CIC-VCAM NOT = '0999'
                IF SCR-MSC-ECAN = 'T'
                    PERFORM CAL-CAPI-REAJ
                    PERFORM CAL-REAJ
                ELSE
                    PERFORM CAL-CAPI-REAJ
                    PERFORM CAL-REAJ.
       FIN-CAL-RCZ.
           EXIT.

       CAL-CAPI-REAJ SECTION.
       INI-CAL-CAPI-REAJ.
           IF RCZ-SGV-CAPI IN RCZ NOT > ZEROES
               MOVE 0 TO WSS-SGV-CAPI
               GO TO FIN-CAL-CAPI-REAJ.
           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAZ-FEC-FCAN IN CAZ TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES AND CAM-SGV-VCAM IN CAM > ZEROES
               DIVIDE CAZ-SGV-TPAG IN CAZ BY CAM-SGV-VCAM IN CAM GIVING
                      WSS-VAL-INTE ROUNDED
               MOVE WSS-VAL-INTE TO WSS-SGV-TPAG
               DIVIDE SCR-SGV-IPFC BY CAM-SGV-VCAM IN CAM GIVING
                      WSS-VAL-INTE ROUNDED
           ELSE
               MOVE ZEROES TO WSS-SGV-TPAG
               MOVE ZEROES TO WSS-VAL-INTE.
           IF WSS-SGV-TPAG NOT > WSS-VAL-INTE
               MOVE ZEROES TO WSS-SGV-CAPI
           ELSE
               SUBTRACT WSS-VAL-INTE FROM WSS-SGV-TPAG
                        GIVING WSS-SGV-CAPI.
           IF WSS-SGV-CAPI > RCZ-SGV-CAPI IN RCZ
               MOVE RCZ-SGV-CAPI IN RCZ TO WSS-SGV-CAPI.
       FIN-CAL-CAPI-REAJ.
           EXIT.

       CAL-REAJ SECTION.
       INI-CAL-REAJ.
           MOVE ZEROES TO WSS-SGV-RAFC.
           MOVE ZEROES TO WSS-SGV-RAFO.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAZ-FEC-FCAN IN CAZ TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MULTIPLY WSS-SGV-CAPI BY
                      CAM-SGV-VCAM IN CAM GIVING
                    WSS-SGV-RAFC.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           IF OPZ-IND-RENO IN OPZ = 'PRO'
               MOVE OPZ-CIC-IOPC IN OPZ TO WSS-CIC-IOPC
               MOVE OPZ-CIC-IOPC IN OPZ TO DLZ-CIC-IOPC IN DLZ
               MOVE RCZ-NUM-IDLC IN RCZ TO DLZ-NUM-IDLC IN DLZ
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CBZ-FIO-DLZ
               IF FIO-STAT-OKS AND DLZ-CIC-IOCO IN DLZ > SPACES
                   MOVE DLZ-CIC-IOCO IN DLZ TO OPZ-CIC-IOPC IN OPZ
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM CBZ-FIO-OPZ
                   IF FIO-STAT-OKS
                       MOVE OPZ-FEC-FCOL IN OPZ TO TAB-FEC-FTRN IN TAB
                       MOVE WSS-CIC-IOPC TO OPZ-CIC-IOPC IN OPZ
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM CBZ-FIO-OPZ
                   ELSE
                       MOVE WSS-CIC-IOPC TO OPZ-CIC-IOPC IN OPZ
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM CBZ-FIO-OPZ
                       MOVE OPZ-FEC-FCOL IN OPZ TO TAB-FEC-FTRN IN TAB
               ELSE
                   MOVE OPZ-FEC-FCOL IN OPZ TO TAB-FEC-FTRN IN TAB
           ELSE
               MOVE OPZ-FEC-FCOL IN OPZ TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MULTIPLY WSS-SGV-CAPI BY
                      CAM-SGV-VCAM IN CAM GIVING
                    WSS-SGV-RAFO.
           SUBTRACT WSS-SGV-RAFO FROM WSS-SGV-RAFC GIVING
                    RCZ-SGV-REAJ IN RCZ.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE RCZ-SGV-REAJ IN RCZ TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCZ-SGV-REAJ IN RCZ.
       FIN-CAL-REAJ.
           EXIT.

       CAL-INTE SECTION.
       INI-CAL-INTE.
           SUBTRACT VEZ-VAL-SCAP IN CAZ-FLD FROM
                    VEZ-VAL-SFIN IN CAZ-FLD GIVING
                    RCZ-SGV-INTE IN RCZ.
       FIN-CAL-INTE.
           EXIT.

       SET-MSG-CLTE SECTION.
       INI-SET-MSG-CLTE.
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DBC.
       FIN-SET-MSG-CLTE.
           EXIT.

       BUS-COR-CAZ SECTION.
       INI-BUS-COR-CAZ.
           MOVE 999 TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    CAZ-CAI-IOPC IN CAZ-FLD = CAZ-CAI-IOPC IN CAZ AND
                    CAZ-IIC-IOPC IN CAZ-FLD = CAZ-IIC-IOPC IN CAZ )

               IF SCR-CMND = 'CAN' OR 'CVC'
                   MOVE 'CBZ'        TO MSG-COD-SIST
                   MOVE 'CAZ    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-BUS-COR-CAZ
               ELSE
                   PERFORM KEY-ALL-CAZ
                   MOVE ZEROES TO CAZ-NUM-ICAN IN CAZ.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CAZ-NUM-ICAN IN CAZ
               MOVE CAZ-NUM-ICAN IN CAZ TO CAZ-NUM-ICAN IN CAZ-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CAZ.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF FIO-STAT-OKS
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       INI-ROZ SECTION.
       INI-INI-ROZ.
           MOVE ZEROES TO ROZ-SGV-RENO IN ROZ.
           MOVE SCR-COD-VCOC TO ROZ-COD-VCVR IN ROZ.
           MOVE SPACES TO ROZ-GLS-DISP IN ROZ.
       FIN-INI-ROZ.
           EXIT.


       INI-RCZ SECTION.
       INI-INI-RCZ.
           MOVE SPACES TO RCZ-KEY-IDLC IN RCZ.
           MOVE ZEROES TO RCZ-NUM-IEVC IN RCZ.
           MOVE SPACES TO RCZ-MSC-MCAN IN RCZ.
           MOVE ZEROES TO RCZ-SGV-INTE IN RCZ.
           MOVE SPACES TO RCZ-IND-SCTB IN RCZ.
           MOVE ZEROES TO RCZ-FEC-FCAN IN RCZ.
           MOVE ZEROES TO RCZ-FEC-FOUT IN RCZ.
           MOVE ZEROES TO RCZ-SGV-REAJ IN RCZ.
           MOVE SPACES TO RCZ-GLS-DISP IN RCZ.
       FIN-INI-RCZ.
           EXIT.

        INI-KDLZ SECTION.
        INI-INI-KDLZ.
            MOVE CAZ-CAI-IOPC IN CAZ-FLD TO VEZ-CAI-IOPC IN VEZ.
            MOVE CAZ-IIC-IOPC IN CAZ-FLD TO VEZ-IIC-IOPC IN VEZ.
            MOVE VEZ-NUM-IVEN IN CAZ-FLD TO VEZ-NUM-IVEN IN VEZ.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM CBZ-FIO-VEZ.
            IF FIO-STAT-OKS
                MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RCZ-CAI-IOPD IN RCZ
                MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RCZ-IIC-IOPD IN RCZ
                MOVE VEZ-NUM-IDLC IN VEZ     TO RCZ-NUM-IDLC IN RCZ.
        FIN-INI-KDLZ.
            EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-CAZ-REQA > SPACES
               PERFORM LEE-NXT-PRV-CAZ
           ELSE
               PERFORM LEE-NXT-PRV-CIC.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-CAZ SECTION.
       INI-LEE-NXT-PRV-CAZ.
           MOVE SCR-CAZ-REQA TO ADR-CAZ-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
           IF FIO-STAT-OKS
               MOVE ADR-CAZ-REQA TO SCR-CAZ-REQA.
       FIN-LEE-NXT-PRV-CAZ.
           EXIT.

       LEE-NXT-PRV-CIC SECTION.
       INI-LEE-NXT-PRV-CIC.
           IF CAZ-IIC-IOPC IN CAZ > ZEROES
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM CBZ-FIO-CAZ
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           MOVE FIO-STAT TO PGM-STAT-CAZ.
           IF FIO-STAT-OKS
               MOVE ADR-CAZ-REQA TO SCR-CAZ-REQA.
       FIN-LEE-NXT-PRV-CIC.
           EXIT.

       LEE-NXT-PRV-RCZ SECTION.
       INI-LEE-NXT-PRV-RCZ.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAZ-CAI-IOPC IN CAZ TO RCZ-CAI-IOPC IN RCZ.
           MOVE CAZ-IIC-IOPC IN CAZ TO RCZ-IIC-IOPC IN RCZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO RCZ-NUM-ICAN IN RCZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO RCZ-CIC-IOPV IN RCZ.
           MOVE VEZ-NUM-IVEN IN VEZ TO RCZ-NUM-IVCT IN RCZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT FIO-STAT-OKS
               MOVE 'RCVNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-RCZ.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF FIO-STAT-OKS AND
              CAZ-CIC-IOPC IN CAZ = RCZ-CIC-IOPC IN RCZ AND
              CAZ-CIC-IOPC IN CAZ = RCZ-CIC-IOPV IN RCZ AND
              CAZ-NUM-ICAN IN CAZ = RCZ-NUM-ICAN IN RCZ
               MOVE RCZ-NUM-IVCT IN RCZ TO VEZ-NUM-IVEN IN VEZ
               MOVE 'RCVSI' TO MSG-COD-MENS
               MOVE '00' TO PGM-STAT-RCZ
           ELSE
               MOVE 'RCVNO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-RCZ.
           EXIT.

       GET-FEC-FCVC SECTION.
       INI-GET-FEC-FCVC.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO CAZ-NUM-DOUT IN CAZ.
           MOVE HOY-MHOY TO CAZ-NUM-MOUT IN CAZ.
           MOVE HOY-SHOY TO CAZ-NUM-SOUT IN CAZ.
           MOVE HOY-AHOY TO CAZ-NUM-AOUT IN CAZ.
       FIN-GET-FEC-FCVC.
           EXIT.

       FST-CYZ-CAZ SECTION.
       INI-FST-CYZ-CAZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       FIN-FST-CYZ-CAZ.
           EXIT.



       FST-CYZ-IABO SECTION.
       INI-FST-CYZ-IABO.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
                    CYZ-NUM-ICAN IN CYZ = ZEROES )
               MOVE SPACES TO FRM-CAI-IABO IN CAZ-FLD
               MOVE ZEROES TO FRM-IIC-IABO IN CAZ-FLD
               MOVE ZEROES TO FRM-VAL-IABO IN CAZ-FLD
           ELSE
               MOVE CYZ-CAI-ICYA IN CYZ TO FRM-CAI-IABO IN CAZ-FLD
               MOVE CYZ-IIC-ICYA IN CYZ TO FRM-IIC-IABO IN CAZ-FLD.
       FIN-FST-CYZ-IABO.
           EXIT.

       FND-KEY-CYZ SECTION.
       INI-FND-KEY-CYZ.


           PERFORM FST-CYZ-CAZ.
           PERFORM CBZ-FIO-CYZ.

           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
                    CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ )
               PERFORM FST-CYZ-IABO
               MOVE '23' TO FIO-STAT
               GO TO END-FND-KEY-CYZ.

       CIC-FND-KEY-CYZ.
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CYZ-IND-TCYA IN CYZ TO MSC-COD-CMSC IN MSC.
           MOVE 'TAB'       TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               IF (MSC-CIC-CMSC IN MSC = 'CC' OR 'AH')
                  AND ( MSC-COD-DAT1(2) NOT = 'M' )
                   MOVE 'S' TO SCR-CYA-IND-CCTE
               ELSE
                   MOVE 'N' TO SCR-CYA-IND-CCTE
           ELSE
               MOVE SPACES TO MSC-CIC-CMSC IN MSC.
           IF CYZ-IND-MAUT IN CYZ = 'S'
                MOVE 'S' TO SCR-CYA-IND-PAUT
           ELSE
               IF SCR-CYA-IND-CCTE = 'S'
                   MOVE 'C' TO SCR-CYA-IND-PAUT.

           IF SCR-CYA-IND-CAJA NOT = 'S'
                    IF MSC-CIC-CMSC IN MSC = 'CAJA'
                         MOVE 'S' TO SCR-CYA-IND-CAJA.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ AND
              CAZ-NUM-ICAN IN CAZ = CYZ-NUM-ICAN IN CYZ
      *
               MOVE CYZ-CAI-ICYA IN CYZ TO FRM-CAI-IABO IN CAZ-FLD
               MOVE CYZ-IIC-ICYA IN CYZ TO FRM-IIC-IABO IN CAZ-FLD
               MOVE CYZ-SGV-LIQU IN CYZ TO FRM-VAL-IABO IN CAZ-FLD.

      *           MOVE 'M' TO SCR-CYA-IND-MCYA
      *           GO TO CIC-FND-KEY-CYZ.

           IF SCR-CYA-IND-MCYA NOT = 'M'
               PERFORM FST-CYZ-CAZ
               PERFORM CBZ-FIO-CYZ
               MOVE CYZ-IND-TCYA IN CYZ TO CYZ-IND-TCYA IN CAZ-FLD
               MOVE CYZ-CAI-ICYA IN CYZ TO CYZ-CAI-ICYA IN CAZ-FLD
               MOVE CYZ-IIC-ICYA IN CYZ TO CYZ-IIC-ICYA IN CAZ-FLD.

       END-FND-KEY-CYZ.
           MOVE FIO-STAT TO PGM-STAT-CYZ.
       FIN-FND-KEY-CYZ.
           EXIT.

       BUS-COR-CAZ-REV SECTION.
       INI-BUS-COR-CAZ-REV.
           MOVE 999 TO CAZ-NUM-ICAN IN CAZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-COR-CAZ-REV.
           PERFORM CBZ-FIO-CAZ.
           IF NOT ( FIO-STAT-OKS AND
                    CAZ-CAI-IOPC IN CAZ-FLD = CAZ-CAI-IOPC IN CAZ AND
                    CAZ-IIC-IOPC IN CAZ-FLD = CAZ-IIC-IOPC IN CAZ )
               IF SCR-CMND = 'REV'
                   MOVE 'CAZ    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-BUS-COR-CAZ-REV
               ELSE
                   PERFORM KEY-ALL-CAZ
                   MOVE ZEROES TO CAZ-NUM-ICAN IN CAZ
               GO TO FIN-BUS-COR-CAZ-REV.
           IF CAZ-MSC-STAT IN CAZ NOT = 'R' AND
              CAZ-SGV-TPAG IN CAZ NOT < ZEROES AND
              CAZ-SGV-TREN IN CAZ NOT < ZEROES
               MOVE CAZ-NUM-ICAN IN CAZ TO CAZ-NUM-ICAN IN CAZ-FLD
               GO TO FIN-BUS-COR-CAZ-REV
           ELSE
               MOVE FIO-GET-PRV TO FIO-CMND
               GO TO LUP-BUS-COR-CAZ-REV.
       FIN-BUS-COR-CAZ-REV.
           EXIT.

       ULT-RCZ-IVCT SECTION.
       INI-ULT-RCZ-IVCT.
           MOVE RCZ-NUM-IVCT IN RCZ TO WSS-NUM-IVCT.
           IF OPZ-NUM-VCOR IN OPZ NOT > 1
               MOVE ZEROES TO RCZ-NUM-IVCT IN RCZ.
           MOVE RCZ-KEY-IRCV IN RCZ TO WSS-RCV-KEY-IRCV.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT ( FIO-STAT-OKS AND
                    RCZ-CIC-IOPC IN RCZ = WSS-RCV-CIC-IOPC )
                    GO TO LUP-ULT-RCZ-IVCT.
           MOVE RCZ-KEY-IRCV IN RCZ TO WSS-RCV-KEY-IRCV.
       LUP-ULT-RCZ-IVCT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           PERFORM CBZ-FIO-RCZ.
           IF FIO-STAT-OKS AND
              RCZ-CIC-IOPC IN RCZ = WSS-RCV-CIC-IOPC AND
             ( RCZ-NUM-IVCT IN RCZ = WSS-NUM-IVCT OR
               RCZ-NUM-IVCT IN RCZ = ZEROES )
               IF RCZ-NUM-ICAN IN RCZ > WSS-RCV-NUM-ICAN
                   MOVE RCZ-KEY-IRCV IN RCZ TO WSS-RCV-KEY-IRCV
                   GO TO LUP-ULT-RCZ-IVCT
               ELSE
                   GO TO LUP-ULT-RCZ-IVCT.
           MOVE WSS-RCV-KEY-IRCV TO RCZ-KEY-IRCV IN RCZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           ADD 1 RCZ-NUM-IVCT IN RCZ GIVING WSS-NUM-IVCT.
       FIN-ULT-RCZ-IVCT.
           EXIT.
       BUS-OPZ-DLZ SECTION.
       INI-BUS-OPZ-DLZ.
           PERFORM GET-OPZ.
           MOVE SPACES TO WSS-CIC-TDOC.
           MOVE OPZ-CIC-IOPC IN OPZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE ZEROES              TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
                    DLZ-CIC-IOPC IN DLZ = OPZ-CIC-IOPC IN OPZ )
               GO TO FIN-BUS-OPZ-DLZ.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'DOC'               TO TAB-COD-TTAB IN TAB.
           MOVE DLZ-COD-TDOC IN DLZ TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TDOC.
       FIN-BUS-OPZ-DLZ.
           EXIT.
       LEE-COZ-CAZ-CUR SECTION.
       INI-LEE-COZ-CAZ-CUR.
           MOVE 'ICZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO ICZ-CIC-IOPC IN ICZ.
           MOVE ZEROES              TO ICZ-NUM-ICAN IN ICZ.
           MOVE SPACES              TO ICZ-CIC-IOPV IN ICZ.
           MOVE ZEROES              TO ICZ-NUM-IVCT IN ICZ.
           MOVE 'COM000'            TO ICZ-IND-TTAS IN ICZ.
           MOVE ZEROES              TO ICZ-FEC-FINI IN ICZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF NOT ( FIO-STAT-OKS AND
                    ICZ-CIC-IOPC IN ICZ = OPZ-CIC-IOPC IN OPZ AND
                    ICZ-NUM-ICAN IN ICZ = ZEROES              AND
                    ICZ-CIC-IOPV IN ICZ = SPACES              AND
                    ICZ-NUM-IVCT IN ICZ = ZEROES              AND
                    ICZ-IND-TTAS IN ICZ = 'COM000' )
               MOVE ZEROES TO ICZ-SGV-TINT IN ICZ.
       FIN-LEE-COZ-CAZ-CUR.
           EXIT.
       ACT-ICZ-MOR SECTION.
       INI-ACT-ICZ-MOR.
           PERFORM GET-CUR-ICZ-MOR.
           IF PGM-STAT-ICZ-OKS
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM CBZ-FIO-ICZ
               IF ICZ-SGV-TINT IN CAZ-FLD > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
               IF WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF ICZ-SGV-TINT IN CAZ-FLD > ZEROES OR
                  WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
                   PERFORM INI-ICZ-MOR
                   MOVE FIO-PUT TO FIO-CMND
               ELSE
                   MOVE '00' TO PGM-STAT-ICZ
                   GO TO FIN-ACT-ICZ-MOR.

           MOVE ICZ-SGV-TINT IN CAZ-FLD TO ICZ-SGV-TINT IN ICZ.
           PERFORM CBZ-FIO-ICZ.
           MOVE FIO-STAT TO PGM-STAT-ICZ.
       FIN-ACT-ICZ-MOR.
           EXIT.

       GET-CUR-ICZ-MOR SECTION.
       INI-GET-CUR-ICZ-MOR.
           MOVE CAZ-CIC-IOPC IN CAZ TO ICZ-CIC-IOPC IN ICZ.
           MOVE CAZ-NUM-ICAN IN CAZ TO ICZ-NUM-ICAN IN ICZ.
           MOVE CAZ-CIC-IOPC IN CAZ TO ICZ-CIC-IOPV IN ICZ
           MOVE ZEROES              TO ICZ-NUM-IVCT IN ICZ
           MOVE 'INTMOR'            TO ICZ-IND-TTAS IN ICZ.
           MOVE ZEROES              TO ICZ-FEC-FINI IN ICZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-ICZ.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-ICZ
           ELSE
               MOVE '23' TO PGM-STAT-ICZ.
       FIN-GET-CUR-ICZ-MOR.
           EXIT.

       INI-ICZ-MOR SECTION.
       INI-INI-ICZ-MOR.
           MOVE ZEROES TO ICZ-FEC-FTER IN ICZ.
           MOVE ZEROES TO ICZ-SGV-SPRD IN ICZ.
           MOVE ZEROES TO ICZ-SGV-MNTO IN ICZ.
           MOVE SPACES TO ICZ-GLS-DISP IN ICZ.
       FIN-INI-ICZ-MOR.
           EXIT.
