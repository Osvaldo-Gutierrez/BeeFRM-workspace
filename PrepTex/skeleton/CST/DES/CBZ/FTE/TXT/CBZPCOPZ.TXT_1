*%! Codigo adicional
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*%! INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% IF PGM_CHI AND PGM_BCI
*%     PGM_PTC = TRUE
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-IND-ACAN                         PIC X(03).
           02 SCR-MSC-TCAN                         PIC X(01).
           02 SCR-OPC-STAT                         PIC X(01).
           02 SCR-CIC-OPEC                         PIC X(01).
           02 SCR-CIC-TCOL                         PIC X(03).
           02 SCR-CIC-TDOC                         PIC X(03).
           02 SCR-IND-OPEE                         PIC X(01).
           02 SCR-OLD-IEST                         PIC X(12).
           02 SCR-NEW-IEST                         PIC X(12).
           02 SCR-IND-PORC                         PIC X(01).
           02 SCR-COD-TINT                         PIC X(12).
           02 SCR-GLS-TIAO                         PIC X(01).
           02 SCR-GLS-CIAO                         PIC X(03).
           02 SCR-COD-PLZO                         PIC X(06).
              88 SCR-COD-PLZO-B90 VALUE 'C1' 'C2' 'USAB90'.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-CIC-IOPV                       PIC X(12).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03 WSS-CAI-ICIC.
              05 WSS-COD-TCIC                     PIC X(01).
              05 WSS-COD-CCIC                     PIC X(03).
           03  WSS-SGV-RENO-CNV COMP-3            PIC S9(11)V9(04).
           03  WSS-COD-VCOC-CNV                   PIC X(06).
           03  WSS-KEY-CRP1.
               05  WSS-TIO-ANT1                   PIC X(03).
               05  WSS-AUX-ANT1                   PIC X(01).
               05  WSS-TIO-NUE1                   PIC X(03).
               05  WSS-AUX-NUE1                   PIC X(01).
               05  WSS-FILLER                     PIC X(04).
           03  WSS-KEY-CRP2 REDEFINES WSS-KEY-CRP1.
               05  WSS-TIO-ANT2                   PIC X(03).
               05  WSS-AUX-ANT2                   PIC X(03).
               05  WSS-TIO-NUE2                   PIC X(03).
               05  WSS-AUX-NUE2                   PIC X(03).
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                   PIC X(40).
               05  WSS-CPT-IOPV                   PIC X(12).
               05  WSS-CPT-DATA                   PIC X(40).
           03  WSS-CPT-NOMB-R REDEFINES WSS-CPT-NOMB PIC X(92).
           03  RCAN-CAN-KEY-ICAN                  PIC X(15).
           03  WSS-SGV-RENO       COMP-3          PIC S9(11)V9(04).
           03  WSS-MSC-TCAN                       PIC X(01).
           03  WSS-SGV-TCOM                       PIC 9(03)V9(02).
           03  WSS-FIO-STAT-FLV  VALUE SPACES     PIC X(02).
           03  WSS-TOT-RCAN   VALUE ZEROES        PIC 9(04).
           03  WSS-MIPL                           PIC X(12).
           03  WSS-MIPL-P                         PIC X(12).
           03  WSS-VAL-TEVC             COMP-3    PIC 9(11)V9(05).
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-NTRN              VALUE SPACES PIC X(04).
           03  WSS-CMSG.
               05 WSS-CMS1                        PIC X(03).
               05 WSS-CMS2                        PIC X(04).
               05 WSS-CMS3                        PIC X(05).
           03  WSS-MEN1.
               05  WSS-MEN1-1                     PIC X(16).
               05  WSS-MEN1-2                     PIC X(24).
           03 WSS-VAL-VIFI              COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-CAPI             COMP-3    PIC 9(11)V9(04).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL1-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA1                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-GLS-GUI2                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL2-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA2                      PIC X(01).
           03  PGM-STAT-POC          VALUE '23'   PIC X(02).
               88  PGM-STAT-POC-OKS  VALUE '00'.
               88  PGM-STAT-POC-NUL  VALUE '  '.
           03  WSS-VAL-SCYA             COMP-3    PIC 9(11)V9(05).
           03  WSS-IND-TMON          VALUE SPACES PIC X(01).
           03  WSS-IND-TMMN          VALUE 'N'    PIC X(01).
           03  WSS-IND-TMMX          VALUE 'E'    PIC X(01).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-SGV-LIQU          VALUE +0     PIC S9(13)V9(05).
           03  WSS-SGV-LIQU-ALF                   PIC X(24).
           03  WSS-SGV-LIQU-EDT REDEFINES WSS-SGV-LIQU-ALF
                                     PIC --.---.---.---.---,-----.
           03  WSS-NUM-TABN          VALUE 0      PIC 9(03).
           03  WSS-NUM-TABZ          VALUE 0      PIC 9(03).
           03  WSS-KEY-ICYA.
               05  WSS-CIC-IOPC                   PIC X(12).
               05  WSS-NUM-ICAN                   PIC X(03).
               05  WSS-NUM-ICYA                   PIC 9(01).
           03  WSS-PESO                 VALUE ' ' PIC X(01).
               88 WSS-PESO-SI           VALUE 'S'.
               88 WSS-PESO-NO           VALUE 'N'.
      *HZF-INI 11-DEC-1996 
           03 CIM-CIC-ICLI.
              05 CIM-CAI-ICLI     VALUE SPACES    PIC X(04).
              05 CIM-IIC-ICLI     VALUE ZEROES    PIC 9(08).
      *HZF-FIN 11-DEC-1996 
       01  SCR-INST-BRW              VALUE 'BRW'  PIC X(03).
       COPY GNSWGQUE.
       COPY GNSBRTAB.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY CBZBRRDZ.
       COPY CBZBRCOZ.
       COPY CBZBRAUZ.
       COPY CBZBRCYZ.
       COPY CBZBRDLZ.
       COPY CBZBRVEZ.
       COPY CBZBRPOZ.
       COPY CBZBRCAZ.
       COPY CBZBRROZ.

       COPY CBZWGSTO.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGIDC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGCVI.
       COPY GNSWGPES.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUZ-REQA==.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2.
      *>>>>
*% END
*% IF FIN_PRO_CONF
      *<<<< FIN_PRO_CONF
           MOVE 'ZO74' TO WSS-NTRN.
      *>>>>
*% END
*% IF SCR_EXIT
      *<<<< SCR_EXIT
           IF WSS-NTRN > SPACES
               MOVE WSS-NTRN TO SYS-NTRN.
      *>>>>
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'OPZ    NOLIQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE  MSG-GLS-DESC TO FRM-MENS
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
           MOVE SPACES TO SCR-CIC-OPEC.
           MOVE SPACES TO SCR-CIC-TCOL.
           MOVE SPACES TO SCR-CIC-TDOC.
           MOVE SPACES TO SCR-IND-OPEE.
           MOVE SPACES TO SCR-IND-PORC.
           MOVE SPACES TO SCR-GLS-TIAO.
           MOVE SPACES TO SCR-GLS-CIAO.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           MOVE 0  TO WSS-VAL-TEVC
                      WSS-VAL-SCYA
                      WSS-VAL-VIFI.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPZTVALCICNX' TO MSG-COD-MENS
               MOVE MSC-CIC-TABL   TO FRM-MEN2
               GO TO MSG-CMN-ACC.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ
           IF OPZ-MSC-TVOC IN OPZ = MSC-COD-CMSC IN MSC
              MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
           ELSE
              MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               MOVE 'VLRCICN0999' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO.
           IF OPZ-COD-VCOC IN OPZ-FLD = TAB-COD-CTAB IN TAB
               MOVE 'S' TO WSS-PESO
           ELSE
               MOVE 'N' TO WSS-PESO.

           MOVE SPACES TO MSG-COD-MENS.
           PERFORM KEY-OPZ-OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               GO TO FIN-CMN-ACC.
           PERFORM RET-OPZ-OPZ.
           PERFORM PRO-ACT-VEZ.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-CMN-ACC.
           PERFORM PRO-ACT-CYZ.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-CMN-ACC.
       OPZ-CMN-ACC.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM KEY-OPZ-OPZ.
       CON-CMN-ACC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               GO TO FIN-CMN-ACC.

           PERFORM RET-OPZ-OPZ.
           MOVE STO-LIQUIDADA-LIQ IN STO-VARI
                                      TO OPZ-MSC-STAT IN OPZ.

           MOVE OPZ-NUM-VCVG IN OPZ TO OPZ-NUM-VCOR IN OPZ.

           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO OPZ-STP-ITRN IN OPZ.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-OPZ
               GO TO FIN-CMN-ACC.
       MSG-CMN-ACC.
*% IF PGM_PTC
           IF MSG-COD-MENS NOT > SPACES
               MOVE 'OPZ    SILIQ' TO MSG-COD-MENS
      *PTC ini
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PTC fin
*% ELSE
           IF MSG-COD-MENS NOT > SPACES
               MOVE 'OPZ    SILIQ' TO MSG-COD-MENS.
*% END
           MOVE 'CBZ' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           IF MSG-COD-MENS NOT = 'OPZ    SILIQ'
               MOVE MSG-GLS-DESC TO FRM-MEN1
*% IF PGM_PTC
      *PTC ini
               MOVE 'S' TO SCR-IERR
      *PTC fin
*% END
               GO TO FIN-CMN-ACC.

           MOVE MSG-GLS-DESC            TO WSS-MEN1-1.
           MOVE OPZ-SGV-LIQU IN OPZ-FLD TO WSS-SGV-LIQU.
           MOVE WSS-SGV-LIQU            TO WSS-SGV-LIQU-EDT.
           MOVE WSS-SGV-LIQU-ALF        TO WSS-MEN1-2.
           MOVE WSS-MEN1                TO FRM-MEN1.
           PERFORM PRO-OPZ.
           GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC
           MOVE SPACES TO SCR-COD-PLZO.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PRO-ACT-VEZ SECTION.
       INI-PRO-ACT-VEZ.
           MOVE OPZ-CAI-IOPC IN OPZ TO VEZ-CAI-IOPC IN VEZ.
           MOVE OPZ-IIC-IOPC IN OPZ TO VEZ-IIC-IOPC IN VEZ.
           MOVE ZEROES              TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-ACT-VEZ.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    VEZ-CAI-IOPC IN VEZ = OPZ-CAI-IOPC IN OPZ AND
                    VEZ-IIC-IOPC IN VEZ = OPZ-IIC-IOPC IN OPZ )
               GO TO SIG-PRO-ACT-VEZ.
           MOVE VEZ-CIC-IOPC IN VEZ TO DLZ-CIC-IOPC IN DLZ
           MOVE VEZ-NUM-IDLC IN VEZ TO DLZ-NUM-IDLC IN DLZ
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM CBZ-FIO-DLZ
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-DLZ
               MOVE 'DLZIDLZNEX  ' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-VEZ.
           IF DLZ-MSC-STAT IN DLZ = 'R' OR 'C'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-PRO-ACT-VEZ.
           MOVE VEZ-VAL-FINA IN VEZ TO WSS-VAL-CAPI IN WSS-VARI.
           MOVE OPZ-COD-VCOC IN OPZ-FLD  TO PES-COD-VCAM IN PES-VARI.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-CAPI IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-VIFI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND
           PERFORM CBZ-FIO-VEZ
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-VEZ
               MOVE 'VEZIVEZNEX  ' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-VEZ.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEZ-VAL-CAPI IN VEZ.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEZ-VAL-SCAP IN VEZ.
           MOVE ZEROES                   TO VEZ-VAL-IMPU IN VEZ.
           MOVE ZEROES                   TO VEZ-VAL-SEGC IN VEZ
                                            VEZ-VAL-SSEG IN VEZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM CBZ-FIO-VEZ
               MOVE 'VEZIVEZNOMOD' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-VEZ.
           ADD 1 TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-PRO-ACT-VEZ.
       SIG-PRO-ACT-VEZ.
           SUBTRACT WSS-VAL-VIFI FROM OPZ-SGV-LIQU IN OPZ-FLD.
        FIN-PRO-ACT-VEZ.
           EXIT.

       PRO-ACT-CYZ SECTION.
       INI-PRO-ACT-CYZ.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-NUM-TABN.
           MOVE 0 TO WSS-NUM-TABZ.
           MOVE 0 TO WSS-SGV-LIQU.

           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO CYZ-CAI-IOPC IN CYZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO CYZ-IIC-IOPC IN CYZ.
           MOVE ZEROES                  TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES                  TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-ACT-CYZ.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS AND
               CYZ-CAI-IOPC IN CYZ = OPZ-CAI-IOPC IN OPZ-FLD AND
               CYZ-IIC-IOPC IN CYZ = OPZ-IIC-IOPC IN OPZ-FLD AND
               CYZ-NUM-ICAN IN CYZ = ZEROES )
               GO TO ACT-PRO-ACT-CYZ.
           ADD 1 TO WSS-NUM-TABN.
           IF CYZ-SGV-LIQU IN CYZ NOT > ZEROES OR
              CYZ-IND-FREE IN CYZ = 'S'
               MOVE CYZ-KEY-ICYA IN CYZ TO WSS-KEY-ICYA IN WSS-VARI
               ADD 1 TO WSS-NUM-TABZ
           ELSE
               ADD CYZ-SGV-LIQU IN CYZ TO WSS-SGV-LIQU IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-ACT-CYZ.
       ACT-PRO-ACT-CYZ.
           IF WSS-NUM-TABN = ZEROES
               MOVE 'CYZ    NOABN' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-CYZ.
           IF WSS-NUM-TABZ NOT = 1
               MOVE 'CYZ    ABNN1' TO MSG-COD-MENS
               MOVE WSS-NUM-TABZ   TO FRM-MEN2
               GO TO FIN-PRO-ACT-CYZ.
           MOVE WSS-KEY-ICYA IN WSS-VARI TO CYZ-KEY-ICYA IN CYZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NGKUP' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-CYZ.

           SUBTRACT WSS-SGV-LIQU IN WSS-VARI FROM
                    OPZ-SGV-LIQU IN OPZ-FLD  GIVING CYZ-SGV-LIQU IN CYZ.

           MOVE 'S' TO CYZ-IND-FREE IN CYZ.

           PERFORM GET-FHOY.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               MOVE 'CYZ    NGKUP' TO MSG-COD-MENS
               GO TO FIN-PRO-ACT-CYZ.
       FIN-PRO-ACT-CYZ.
           EXIT.

*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%!                           IMPORTANTE
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%! El siguiente codigo ( RET-OPZ-OPZ se extrae directamente desde el
*%! modulo CBZBUOPZ.SRCAIU, por lo tanto dicho codigo debe actualizarse
*%! cada vez que se agrega o se elimina un campo de la pantalla OPZ.
*%! En cualquier caso, se debe respetar lo que se encuentra bajo
*%! *<<<< FIN_RET_OPZ_OPZ.
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       
       RET-OPZ-OPZ SECTION.
       INI-RET-OPZ-OPZ.

           MOVE OPZ-COD-VCOC IN OPZ-FLD TO OPZ-COD-VCOC IN OPZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO OPZ-COD-TOOC IN OPZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO OPZ-COD-AOOC IN OPZ.
           MOVE OPZ-IND-VSTR IN OPZ-FLD TO OPZ-IND-VSTR IN OPZ.
           MOVE OPZ-COD-RMOC IN OPZ-FLD TO OPZ-COD-RMOC IN OPZ.
           MOVE OPZ-VAL-CRED IN OPZ-FLD TO OPZ-VAL-CRED IN OPZ.
           MOVE OPZ-COD-OFOC IN OPZ-FLD TO OPZ-COD-OFOC IN OPZ.
           MOVE OPZ-VAL-SCRE IN OPZ-FLD TO OPZ-VAL-SCRE IN OPZ.
           MOVE OPZ-COD-OFOP IN OPZ-FLD TO OPZ-COD-OFOP IN OPZ.
           MOVE OPZ-NUM-NPLA IN OPZ-FLD TO OPZ-NUM-NPLA IN OPZ.
           MOVE OPZ-NUM-VCVG IN OPZ-FLD TO OPZ-NUM-VCVG IN OPZ.
           MOVE OPZ-IND-RENO IN OPZ-FLD TO OPZ-IND-RENO IN OPZ.
           MOVE OPZ-NUM-VCOR IN OPZ-FLD TO OPZ-NUM-VCOR IN OPZ.
           MOVE OPZ-NUM-DMAV IN OPZ-FLD TO OPZ-NUM-DMAV IN OPZ.
           MOVE OPZ-NUM-MMAV IN OPZ-FLD TO OPZ-NUM-MMAV IN OPZ.
           MOVE OPZ-NUM-SMAV IN OPZ-FLD TO OPZ-NUM-SMAV IN OPZ.
           MOVE OPZ-NUM-AMAV IN OPZ-FLD TO OPZ-NUM-AMAV IN OPZ.
           MOVE OPZ-VAL-GAST IN OPZ-FLD TO OPZ-VAL-GAST IN OPZ.
           MOVE OPZ-NUM-DINP IN OPZ-FLD TO OPZ-NUM-DINP IN OPZ.
           MOVE OPZ-NUM-MINP IN OPZ-FLD TO OPZ-NUM-MINP IN OPZ.
           MOVE OPZ-NUM-SINP IN OPZ-FLD TO OPZ-NUM-SINP IN OPZ.
           MOVE OPZ-NUM-AINP IN OPZ-FLD TO OPZ-NUM-AINP IN OPZ.
           MOVE OPZ-NUM-DCOL IN OPZ-FLD TO OPZ-NUM-DCOL IN OPZ.
           MOVE OPZ-NUM-MCOL IN OPZ-FLD TO OPZ-NUM-MCOL IN OPZ.
           MOVE OPZ-NUM-SCOL IN OPZ-FLD TO OPZ-NUM-SCOL IN OPZ.
           MOVE OPZ-NUM-ACOL IN OPZ-FLD TO OPZ-NUM-ACOL IN OPZ.
           MOVE OPZ-NUM-DING IN OPZ-FLD TO OPZ-NUM-DING IN OPZ.
           MOVE OPZ-NUM-MING IN OPZ-FLD TO OPZ-NUM-MING IN OPZ.
           MOVE OPZ-NUM-SING IN OPZ-FLD TO OPZ-NUM-SING IN OPZ.
           MOVE OPZ-NUM-AING IN OPZ-FLD TO OPZ-NUM-AING IN OPZ.
           MOVE OPZ-COD-PLCO IN OPZ-FLD TO OPZ-COD-PLCO IN OPZ.
           MOVE OPZ-SGV-VCOM IN OPZ-FLD TO OPZ-SGV-VCOM IN OPZ.
           MOVE OPZ-COD-PLIM IN OPZ-FLD TO OPZ-COD-PLIM IN OPZ.
           MOVE OPZ-IND-TCBZ IN OPZ-FLD TO OPZ-IND-TCBZ IN OPZ.
           MOVE OPZ-IND-AFER IN OPZ-FLD TO OPZ-IND-AFER IN OPZ.
           MOVE OPZ-SGV-LIQU IN OPZ-FLD TO OPZ-SGV-LIQU IN OPZ.
      *<<<< FIN_RET_OPZ_OPZ
           MOVE OPZ-NUM-VCVG IN OPZ-FLD TO OPZ-NUM-VCOR IN OPZ.
      *>>>>
       FIN-RET-OPZ-OPZ.
           EXIT.
       PRO-OPZ SECTION.
       INI-PRO-OPZ.
           IF FRM-SUAR = FRM-SUAR-WRN
               GO TO FIN-PRO-OPZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    RDZ-CIC-IOPC IN RDZ = OPZ-CIC-IOPC IN OPZ AND
                    RDZ-NUM-IDLC IN RDZ = ZEROES )
               GO TO FIN-PRO-OPZ.
       LUP-INP-OPZ.
           MOVE ADR-RDZ-REQA TO ADR-AUX-REQA.
           MOVE RDZ-CIC-ICLI IN RDZ TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE SPACES TO RDZ-CIC-IOPC IN RDZ.
           MOVE ZEROES TO RDZ-NUM-IDLC IN RDZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-NXT-RDZ.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO LUP-NXT-OPZ.
           IF WSS-CIC-ICLI IN WSS-VARI NOT = RDZ-CIC-ICLI IN RDZ
               GO TO LUP-NXT-OPZ.
           IF RDZ-NUM-IDLC IN RDZ > ZEROES OR
              WSS-CIC-IOPC IN WSS-VARI = RDZ-CIC-IOPC IN RDZ
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-NXT-RDZ.
           MOVE RDZ-CIC-IOPC IN RDZ TO OPZ-CIC-IOPC IN OPZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ
           IF FIO-STAT-OKS AND
              ( OPZ-ACTUALIZADA OR
                OPZ-MSC-STAT NOT > SPACES )
               MOVE 'CBZ' TO MSG-COD-SIST
               MOVE 'CLI    NOVRF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DCOR TO CPT-STR1
               MOVE OPZ-CIC-IOPC TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-MEN2
               GO TO FIN-PRO-OPZ.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-NXT-RDZ.
       LUP-NXT-OPZ.
           MOVE ADR-AUX-REQA TO ADR-RDZ-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              RDZ-CIC-IOPC IN RDZ = WSS-CIC-IOPC IN WSS-VARI AND
              RDZ-NUM-IDLC IN RDZ = ZEROES
               GO TO LUP-INP-OPZ.
       FIN-PRO-OPZ.
           EXIT.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY CBZBFRDZ.
       COPY CBZBFCYZ.
       COPY CBZBFDLZ.
       COPY CBZBFVEZ.
       COPY CBZBFPOZ.
       COPY CBZBFCAZ.
       COPY CBZBFROZ.
       COPY CBZBFCOZ.
       COPY CBZBFAUZ.
       COPY CBZBGCLI.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVNUM.
       COPY TABBBOFI.
       COPY TABBBCVG.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBFCAM.
       COPY TABBVTDU.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY SGCBGDOM.
       COPY SGCBFRCD.
       COPY GNSBGQUE.
       GET-CUR-RDZ SECTION.
       INI-GET-CUR-RDZ.
           MOVE OPZ-CAI-IOPC IN OPZ TO RDZ-CAI-IOPC IN RDZ.
           MOVE OPZ-IIC-IOPC IN OPZ TO RDZ-IIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    RDZ-CAI-IOPC IN RDZ = OPZ-CAI-IOPC IN OPZ AND
                    RDZ-IIC-IOPC IN RDZ = OPZ-IIC-IOPC IN OPZ AND
                    RDZ-NUM-IDLC IN RDZ = ZEROES )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-RDZ.
           EXIT.

       GET-NXT-RDZ SECTION.
       INI-GET-NXT-RDZ.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              OPZ-CAI-IOPC IN OPZ = RDZ-CAI-IOPC IN RDZ AND
              OPZ-IIC-IOPC IN OPZ = RDZ-IIC-IOPC IN RDZ AND
              RDZ-NUM-IDLC IN RDZ = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDZ.
       FIN-GET-NXT-RDZ.
           EXIT.
      *>>>>
*% END
