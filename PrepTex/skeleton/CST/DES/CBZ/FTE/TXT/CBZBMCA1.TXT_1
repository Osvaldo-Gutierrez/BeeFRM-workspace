       BASE-TASA-INI SECTION.
       INI-BASE-TASA-INI.
           MOVE ZEROES                  TO ICZ-SGV-TINT IN CAZ-FLD.
           MOVE SPACES                  TO FRM-IND-TIPE IN CAZ-FLD
                                           WSS-IBLK-TINT.
           MOVE SPACES                  TO FRM-GLS-TINT IN CAZ-FLD.
       FIN-BASE-TASA-INI.
           EXIT.

       VAL-CON-ROZ SECTION.
       INI-VAL-CON-ROZ.
           MOVE ROZ-CAI-IOPC IN CAZ-FLD TO ROZ-CAI-IOPC IN ROZ.
           MOVE ROZ-IIC-IOPC IN CAZ-FLD TO ROZ-IIC-IOPC IN ROZ.
           MOVE SPACES                  TO ROZ-CIC-IOPV IN ROZ.
           MOVE ZEROS                   TO ROZ-NUM-IVCT IN ROZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-CON-ROZ.
           PERFORM CBZ-FIO-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-VAL-CON-ROZ.
           IF ROZ-CAI-IOPC IN CAZ-FLD NOT = ROZ-CAI-IOPC IN ROZ OR
              ROZ-IIC-IOPC IN CAZ-FLD NOT = ROZ-IIC-IOPC IN ROZ
               GO TO FIN-VAL-CON-ROZ.

           MOVE ROZ-CAI-IOPV IN ROZ TO CAZ-CAI-IOPC IN CAZ
           MOVE ROZ-IIC-IOPV IN ROZ TO CAZ-IIC-IOPC IN CAZ
           MOVE ROZ-NUM-IVCT IN ROZ TO CAZ-NUM-ICAN IN CAZ
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM CBZ-FIO-CAZ
           IF NOT FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'EXIROVSINCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-ROZ.

           IF CAZ-CAI-IOPC IN CAZ-FLD = CAZ-CAI-IOPC IN CAZ AND
              CAZ-IIC-IOPC IN CAZ-FLD = CAZ-IIC-IOPC IN CAZ AND
              CAZ-NUM-ICAN IN CAZ-FLD = CAZ-NUM-ICAN IN CAZ
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-VAL-CON-ROZ.


           IF (CAZ-NUM-DCAN IN CAZ-FLD NOT = CAZ-NUM-DCAN IN CAZ) OR
              (CAZ-NUM-MCAN IN CAZ-FLD NOT = CAZ-NUM-MCAN IN CAZ) OR
              (CAZ-NUM-ACAN IN CAZ-FLD NOT = CAZ-NUM-ACAN IN CAZ) OR
              (CAZ-NUM-SCAN IN CAZ-FLD NOT = CAZ-NUM-SCAN IN CAZ)
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'FECFCANDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROZ.

           IF (CAZ-NUM-DEGR IN CAZ-FLD NOT = CAZ-NUM-DEGR IN CAZ) OR
              (CAZ-NUM-MEGR IN CAZ-FLD NOT = CAZ-NUM-MEGR IN CAZ) OR
              (CAZ-NUM-AEGR IN CAZ-FLD NOT = CAZ-NUM-AEGR IN CAZ) OR
              (CAZ-NUM-SEGR IN CAZ-FLD NOT = CAZ-NUM-SEGR IN CAZ)
                MOVE 'CBZ'          TO MSG-COD-SIST
                MOVE 'FECFCONDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROZ.

           IF CAZ-COD-OFCA IN CAZ-FLD NOT = CAZ-COD-OFCA IN CAZ
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OFICANDOFIIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
        FIN-VAL-CON-ROZ.
           EXIT.

       GET-SLD SECTION.
       INI-GET-SLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF SCR-MSC-ECAN = 'T' AND
              OPZ-NUM-VCOR IN OPZ > 1
               MOVE OPZ-VAL-SCRE IN CAZ-FLD TO WSS-VAL-SCAP
               ADD VEZ-VAL-SFIN IN CAZ-FLD OPZ-VAL-SCRE IN CAZ-FLD
                   GIVING WSS-VAL-SVEN
               SUBTRACT VEZ-VAL-SCAP IN CAZ-FLD FROM WSS-VAL-SVEN
           ELSE
               MOVE VEZ-VAL-SCAP IN CAZ-FLD TO WSS-VAL-SCAP
               MOVE VEZ-VAL-SFIN IN CAZ-FLD TO WSS-VAL-SVEN.

           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.

           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEZ-VAL-SCAP IN CAZ-FLD TO
                     RCZ-SGV-CAPI IN CAZ-FLD
                MOVE VEZ-VAL-SFIN IN CAZ-FLD TO
                     RCZ-SGV-FINA IN CAZ-FLD
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               IF OPZ-NUM-VCOR IN OPZ = 1
                   MOVE VEZ-VAL-SCAP IN CAZ-FLD TO
                        RCZ-SGV-CAPI IN CAZ-FLD
                   MOVE VEZ-VAL-SFIN IN CAZ-FLD TO
                     RCZ-SGV-FINA IN CAZ-FLD
               ELSE
                   MOVE OPZ-VAL-SCRE IN CAZ-FLD TO
                        RCZ-SGV-CAPI IN CAZ-FLD
                   MOVE WSS-VAL-SVEN TO
                        RCZ-SGV-FINA IN CAZ-FLD.

           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-GET-SLD.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.


           MOVE 1 TO SCR-SGV-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               GO TO VRF-MON-NAC.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO TAB-NUM-STRN IN TAB.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO SCR-SGV-VCAM

               MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SVEN ROUNDED

               MULTIPLY WSS-VAL-SCAP BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SCAP ROUNDED
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       VRF-MON-NAC.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.

           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
           MOVE WSS-VAL-SCAP TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SCAP.
           MOVE SCR-SGV-VCAM TO WSS-VAL-VCAM IN WSS-VARI.
       FIN-GET-SLD.
           EXIT.

       ABS-TPAG SECTION.
       INI-ABS-TPAG.
           MOVE CAZ-SGV-TPAG IN CAZ-FLD TO WSS-SGV-TPAG.
           IF WSS-SGV-TPAG < ZEROES
               SUBTRACT WSS-SGV-TPAG FROM 0 GIVING WSS-SGV-TPAG.
       FIN-ABS-TPAG.
           EXIT.

       LEE-REG-TCAN SECTION.
       INI-LEE-REG-TCAN.
           IF VEZ-NUM-IVEN IN CAZ-FLD = 1
               MOVE OPZ-NUM-DCOL IN OPZ TO WSS-NUM-DVEN IN WSS-VARI
               MOVE OPZ-NUM-MCOL IN OPZ TO WSS-NUM-MVEN IN WSS-VARI
               MOVE OPZ-NUM-SCOL IN OPZ TO WSS-NUM-SVEN IN WSS-VARI
               MOVE OPZ-NUM-ACOL IN OPZ TO WSS-NUM-AVEN IN WSS-VARI
               GO TO CON-LEE-REG-TCAN.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO VEZ-IIC-IOPC IN VEZ.
           SUBTRACT 1 FROM VEZ-NUM-IVEN IN CAZ-FLD GIVING
                                           VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.

           PERFORM CBZ-FIO-VEZ.
           IF FIO-STAT-OKS
               MOVE VEZ-NUM-DVEN IN VEZ TO WSS-NUM-DVEN IN WSS-VARI
               MOVE VEZ-NUM-MVEN IN VEZ TO WSS-NUM-MVEN IN WSS-VARI
               MOVE VEZ-NUM-SVEN IN VEZ TO WSS-NUM-SVEN IN WSS-VARI
               MOVE VEZ-NUM-AVEN IN VEZ TO WSS-NUM-AVEN IN WSS-VARI
           ELSE
               MOVE OPZ-NUM-DCOL IN OPZ TO WSS-NUM-DVEN IN WSS-VARI
               MOVE OPZ-NUM-MCOL IN OPZ TO WSS-NUM-MVEN IN WSS-VARI
               MOVE OPZ-NUM-SCOL IN OPZ TO WSS-NUM-SVEN IN WSS-VARI
               MOVE OPZ-NUM-ACOL IN OPZ TO WSS-NUM-AVEN IN WSS-VARI.
       CON-LEE-REG-TCAN.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE VEZ-NUM-IVEN IN CAZ-FLD TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO DLZ-CAI-IOPC IN DLZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO DLZ-IIC-IOPC IN DLZ.
           MOVE VEZ-NUM-IDLC IN VEZ     TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.

       FIN-LEE-REG-TCAN.
           EXIT.

       PRO-TCAN-CTE SECTION.
       INI-PRO-TCAN-CTE.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           IF CAZ-FEC-FCAN IN CAZ > VEZ-FEC-FVEN IN VEZ
              PERFORM CAL-INT-FVEN
              PERFORM PRO-MORA-CTE
           ELSE
           IF CAZ-FEC-FCAN IN CAZ NOT > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-DESC-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-PRO-TCAN-CTE.
            PERFORM PRO-COM-IMP-CTE.
       FIN-PRO-TCAN-CTE.
           EXIT.

       PRO-COM-IMP-CTE SECTION.
       INI-PRO-COM-IMP-CTE.
           PERFORM CAL-COM.
           IF MSG-COD-MENS > SPACES
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-PRO-COM-IMP-CTE.
           PERFORM CAL-IMP.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-COM-IMP-CTE.
           MOVE 0                        TO WSS-VAL-SMO7
           ADD  VEZ-VAL-IMPU IN CAZ-FLD  TO WSS-VAL-SMO7.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE ZEROES TO WSS-VAL-SMO8
              ADD WSS-VAL-SMO8 TO WSS-VAL-SMO7
           ELSE
              ADD  ZEROES TO WSS-VAL-SMO7.
           ADD  CAZ-VAL-COMI IN CAZ-FLD  TO WSS-VAL-SMO7
           ADD  FRM-VAL-PORT IN CAZ-FLD  TO WSS-VAL-SMO7
           ADD  WSS-VAL-SMO7 TO WSS-VAL-SVEN.
       FIN-PRO-COM-IMP-CTE.
           EXIT.
       PRO-MORA-CTE SECTION.
       INI-PRO-MORA-CTE.
           IF VEZ-IND-CALC IN VEZ = 'N'
               MOVE 'VENCALCMORAN' TO MSG-COD-MENS
               MOVE VEZ-NUM-IVEN IN VEZ TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTE.
           MOVE VEZ-VAL-SFIN IN VEZ TO WSS-VAL-SMON.
           PERFORM PRO-FUPM.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO FEC-DEC2.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO FEC-MEC2.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO FEC-SEC2.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTE.
           IF ICZ-SGV-TINT IN CAZ-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE WSS-VAL-ICOM
               GO TO CON-PRO-CTE-TIPE.
       CON-PRO-CTE-TIPE.
           MOVE WSS-VAL-SMON TO WSS-VAL-SCRE.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * OPZ-VAL-SCRE IN OPZ
           ELSE
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * WSS-VAL-SCRE.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * OPZ-VAL-SCRE IN OPZ
           ELSE
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * VEZ-VAL-SCAP IN VEZ.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-INT-TIPE TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-INT-TIPE.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-ICOM TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-ICOM.
           MOVE WSS-VAL-ICOM TO CAZ-SGV-ICOM IN CAZ-FLD
           MOVE WSS-INT-TIPE TO CAZ-SGV-IPUN IN CAZ-FLD
           MOVE WSS-VAL-ICOM TO WSS-VAL-SVEN.
           ADD WSS-INT-TIPE TO WSS-VAL-SVEN.
           ADD WSS-VAL-SCRE  TO WSS-VAL-SVEN.
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           SUBTRACT VEZ-VAL-SCAP IN VEZ FROM SCR-SGV-IPFC.
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-IPUN IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           MULTIPLY PES-SGV-DECI IN PES-VARI BY SCR-SGV-VCAM
                             GIVING PES-SGV-DECI IN PES-VARI ROUNDED.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-IPUN IN CAZ-FLD.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-ICOM IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           MULTIPLY PES-SGV-DECI IN PES-VARI BY SCR-SGV-VCAM
                             GIVING PES-SGV-DECI IN PES-VARI ROUNDED.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-ICOM IN CAZ-FLD.
       FIN-PRO-MORA-CTE.
           EXIT.

      *<<<< PGM_PER
       PRO-MORA-TMC SECTION.
       INI-PRO-MORA-TMC.
           IF WSS-CIC-TVAL = '1'
               GO TO USD-PRO-MORA-TMC.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'           TO MSG-COD-SIST
               MOVE 'CIC0999  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY               TO CAM-FVCA.
           MOVE 'PMOR'                 TO CAM-CVCA IN CAM-VARI(1).
           MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2).
           PERFORM TAB-BUS-CVG.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'PMOR   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-COD-MENS TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-PORC.
           IF WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
               MOVE ICZ-SGV-TINT IN CAZ-FLD TO CAM-SGV-VCAM IN CAM
           ELSE
               PERFORM GET-FHOY
               MOVE HOY-FHOY               TO CAM-FVCA
               MOVE 'TMOR'                 TO CAM-CVCA IN CAM-VARI(1)
               MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2)
               PERFORM TAB-BUS-CVG
               IF MSG-COD-MENS > SPACES
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'TMOR   NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-COD-MENS TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-PRO-MORA-TMC.
           MOVE 'VMSS'              TO ITZ-COD-TINT IN ITZ.
           MOVE CAM-SGV-VCAM IN CAM TO ICZ-SGV-TINT IN CAZ-FLD.
           MOVE 'EFE MENS'   TO FRM-GLS-TINT IN CAZ-FLD.
           COMPUTE WSS-INT-TIPE ROUNDED = CAM-SGV-VCAM IN CAM *
                                          WSS-VAL-PORC / 100.
           COMPUTE WSS-INT-TIPE ROUNDED =
                               ((( 1 + WSS-INT-TIPE / 100 ) **
                                 ( WSS-DIAM / 30 )) - 1).
           PERFORM GET-FHOY.
           MOVE HOY-FHOY               TO CAM-FVCA.
           MOVE 'TCMP'                 TO CAM-CVCA IN CAM-VARI(1).
           MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2).
           PERFORM TAB-BUS-CVG.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'TCMP   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-COD-MENS TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           COMPUTE WSS-VAL-ICOM ROUNDED =
                   ((( 1 + CAM-SGV-VCAM IN CAM / 100 ) **
                   ( WSS-DIAM / 30 )) - 1).
           GO TO CON-PRO-MORA-TMC.
       USD-PRO-MORA-TMC.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '1013'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'           TO MSG-COD-SIST
               MOVE 'CIC1013  NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY               TO CAM-FVCA.
           MOVE 'PMOR'                 TO CAM-CVCA IN CAM-VARI(1).
           MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2).
           PERFORM TAB-BUS-CVG.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'PMOR   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-COD-MENS TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-PORC.
           IF WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
               MOVE ICZ-SGV-TINT IN CAZ-FLD TO CAM-SGV-VCAM IN CAM
           ELSE
               PERFORM GET-FHOY
               MOVE HOY-FHOY               TO CAM-FVCA
               MOVE 'TMOR'                 TO CAM-CVCA IN CAM-VARI(1)
               MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2)
               PERFORM TAB-BUS-CVG
               IF MSG-COD-MENS > SPACES
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'TMOR   NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-COD-MENS TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-PRO-MORA-TMC.

           MOVE 'VASS'              TO ITZ-COD-TINT IN ITZ.
           MOVE CAM-SGV-VCAM IN CAM TO ICZ-SGV-TINT IN CAZ-FLD.
           MOVE 'EFE ANUA'   TO FRM-GLS-TINT IN CAZ-FLD.
           COMPUTE WSS-INT-TIPE ROUNDED = CAM-SGV-VCAM IN CAM *
                                          WSS-VAL-PORC / 100.
           COMPUTE WSS-INT-TIPE ROUNDED =
                               ((( 1 + WSS-INT-TIPE / 100 ) **
                                 ( WSS-DIAM / 360 )) - 1).
           PERFORM GET-FHOY.

           MOVE HOY-FHOY               TO CAM-FVCA.
           MOVE 'TCMP'                 TO CAM-CVCA IN CAM-VARI(1).
           MOVE TAB-COD-CTAB IN TAB    TO CAM-CVCA IN CAM-VARI(2).
           PERFORM TAB-BUS-CVG.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'TCMP   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-COD-MENS TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           COMPUTE WSS-VAL-ICOM ROUNDED =
                               ((( 1 + CAM-SGV-VCAM IN CAM / 100 ) **
                                 ( WSS-DIAM / 360 )) - 1)
       CON-PRO-MORA-TMC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAZ-FLD
               MULTIPLY WSS-VAL-ICOM BY 100 GIVING ICZ-SGV-TINT
                                                   IN CAZ-FLD
               ADD WSS-VAL-ICOM, WSS-INT-TIPE GIVING INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TMC.
           IF FRM-IND-TIPE IN CAZ-FLD > SPACES
               DIVIDE ICZ-SGV-TINT IN CAZ-FLD BY 100 GIVING
                      WSS-VAL-ICOM
               MOVE 'S' TO WSS-IBLK-TINT
               IF WSS-VAL-ICOM = ZEROES
                  MOVE ZEROES TO WSS-INT-TIPE
                  ADD WSS-VAL-ICOM, WSS-INT-TIPE GIVING INT-TIPE
                  PERFORM GLS-INT-TIPE
                  GO TO FIN-PRO-MORA-TMC
               ELSE
                  ADD WSS-VAL-ICOM, WSS-INT-TIPE GIVING INT-TIPE
                  PERFORM GLS-INT-TIPE
                  GO TO FIN-PRO-MORA-TMC.
           MOVE SPACES                  TO FRM-IND-TIPE IN CAZ-FLD.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITZ-COD-TINT IN ITZ     TO INT-TIPT.
           MOVE ICZ-SGV-TINT IN CAZ-FLD TO INT-TINT.
           MOVE SPACES TO INT-CVTI.
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPZ-COD-VCOC IN OPZ     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           ADD INT-TIPE 0 GIVING WSS-VAL-ICOM ROUNDED.
           IF WSS-VAL-ICOM = ZEROES
              MOVE ZEROES TO WSS-INT-TIPE
              ADD WSS-VAL-ICOM, WSS-INT-TIPE GIVING INT-TIPE
              GO TO FIN-PRO-MORA-TMC
            ELSE
              ADD WSS-VAL-ICOM, WSS-INT-TIPE GIVING INT-TIPE
              GO TO FIN-PRO-MORA-TMC.
       FIN-PRO-MORA-TMC.
           EXIT.
      *>>>>
       PRO-DESC-CTE SECTION.
       INI-PRO-DESC-CTE.

           MOVE VEZ-VAL-SFIN IN VEZ TO WSS-VAL-SVEN

           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.

           SUBTRACT VEZ-VAL-SCAP IN VEZ FROM SCR-SGV-IPFC.

           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.

           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.

           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.

       FIN-PRO-DESC-CTE.
           EXIT.

       PRO-TCAN-CTT SECTION.
       INI-PRO-TCAN-CTT.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           IF CAZ-FEC-FCAN IN CAZ > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-MORA-CTT
           ELSE
           IF CAZ-FEC-FCAN IN CAZ NOT > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-DESC-CTT.
       FIN-PRO-TCAN-CTT.
           EXIT.

       PRO-MORA-CTT SECTION.
       INI-MORA-CTT.
           PERFORM LEE-REG-TCAN.
           MOVE ZEROES TO WSS-TOT-SVEN IN WSS-VARI.
           MOVE ZEROES TO WSS-TOT-IPUN IN WSS-VARI.
           MOVE ZEROES TO WSS-TOT-ICOM IN WSS-VARI.
           MOVE ZEROES TO RCZ-SGV-FINA IN CAZ-FLD.
           MOVE 0                        TO WSS-VAL-SMO7
           ADD  FRM-VAL-PORT IN CAZ-FLD  TO WSS-VAL-SMO7
           MOVE OPZ-VAL-SCRE IN OPZ TO WSS-VAL-SCRE-PASO.
       LUP-PRO-MORA-CTT.
           MOVE 0      TO WSS-CAL-COM-CAP.
           MOVE 0      TO WSS-CAL-COM-DVN.
           MOVE 0      TO WSS-CAL-COM-SDO.
           MOVE 0      TO WSS-CAL-COM-FLV.
           IF VEZ-FEC-FVEN IN VEZ NOT < CAZ-FEC-FCAN IN CAZ
              GO TO COR-PRO-MORA-CTT.
           PERFORM CAL-INT-FVEN
           PERFORM PRO-MORA-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTT.
           ADD WSS-INT-TIPE TO WSS-TOT-IPUN IN WSS-VARI.
           ADD WSS-VAL-ICOM TO WSS-TOT-ICOM IN WSS-VARI.
           PERFORM CAL-COM.
           IF MSG-COD-MENS > SPACES
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-PRO-MORA-CTT.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE ZEROES TO WSS-VAL-SMO8 
              ADD WSS-VAL-SMO8 TO WSS-VAL-SMO7
           ELSE
              ADD  ZEROES TO WSS-VAL-SMO7.
           ADD VEZ-VAL-SFIN IN VEZ TO RCZ-SGV-FINA IN CAZ-FLD.
           ADD WSS-VAL-SMON IN WSS-VARI TO WSS-TOT-SVEN IN WSS-VARI.
           ADD 1 TO VEZ-NUM-IVEN IN VEZ.
           SUBTRACT VEZ-VAL-SCAP IN VEZ FROM OPZ-VAL-SCRE IN OPZ.
           IF VEZ-NUM-IVEN IN VEZ NOT > ZEROES
               GO TO NXT-PRO-MORA-CTT.
           MOVE VEZ-NUM-DVEN IN VEZ TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE VEZ-NUM-MVEN IN VEZ TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE VEZ-NUM-SVEN IN VEZ TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE VEZ-NUM-AVEN IN VEZ TO WSS-NUM-AVEN IN WSS-VARI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-MORA-CTT.
           GO TO LUP-PRO-MORA-CTT.
       COR-PRO-MORA-CTT.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO FEC-DEC1.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO FEC-MEC1.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO FEC-SEC1.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO FEC-AEC1.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO FEC-DEC2.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO FEC-MEC2.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO FEC-SEC2.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTT.
           COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * OPZ-VAL-SCRE IN OPZ.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-ICOM TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-ICOM.
           MOVE OPZ-VAL-SCRE IN OPZ TO WSS-VAL-SMON IN WSS-VARI.
           ADD WSS-VAL-ICOM TO WSS-VAL-SMON IN WSS-VARI
                               SCR-SGV-IPFC.
           ADD WSS-VAL-SMON IN WSS-VARI TO RCZ-SGV-FINA IN CAZ-FLD.
           ADD WSS-VAL-SMON IN WSS-VARI TO WSS-TOT-SVEN IN WSS-VARI.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE ZEROES TO WSS-VAL-SMO8
              ADD WSS-VAL-SMO8 TO WSS-VAL-SMO7
           ELSE
              ADD  ZEROES TO  WSS-VAL-SMO7.
           PERFORM CAL-COM.
           IF MSG-COD-MENS > SPACES
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-PRO-MORA-CTT.
       NXT-PRO-MORA-CTT.
           MOVE WSS-VAL-SCRE-PASO TO OPZ-VAL-SCRE IN OPZ.
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           MULTIPLY WSS-TOT-IPUN IN WSS-VARI BY SCR-SGV-VCAM
                             GIVING CAZ-SGV-IPUN IN CAZ-FLD ROUNDED.
           MULTIPLY WSS-TOT-ICOM IN WSS-VARI BY SCR-SGV-VCAM
                             GIVING CAZ-SGV-ICOM IN CAZ-FLD ROUNDED.
           PERFORM CAL-IMP.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTT.
           ADD  CAZ-VAL-COMI IN CAZ-FLD  TO WSS-VAL-SMO7.
           ADD  VEZ-VAL-IMPU IN CAZ-FLD  TO WSS-VAL-SMO7.
           ADD  WSS-VAL-SMO7 TO WSS-VAL-SVEN.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-MORA-CTT.
           EXIT.

       PRO-DESC-CTT SECTION.
       INI-PRO-DESC-CTT.
           PERFORM PRO-DESC-CTT-TADI.
           MOVE WSS-VAL-CAPI IN WSS-VARI TO VEZ-VAL-CAPI IN VEZ.
           MOVE WSS-VAL-FINA IN WSS-VARI TO VEZ-VAL-FINA IN VEZ.
           MOVE VEZ-VAL-SCAP IN CAZ-FLD  TO VEZ-VAL-SCAP IN VEZ.
           MOVE VEZ-VAL-SFIN IN CAZ-FLD  TO VEZ-VAL-SFIN IN VEZ.
           PERFORM PRO-COM-IMP-CTE.
       FIN-PRO-DESC-CTT.
           EXIT.

       PRO-DESC-CTT-TADI SECTION.
       INI-PRO-DESC-CTT-TADI.
           PERFORM LEE-REG-TCAN.
           MOVE OPZ-VAL-SCRE IN OPZ TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-PRO-DESC-CTT-TADI.
           PERFORM PRO-DESC-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-DESC-CTT-TADI.
           IF WSS-IVEZ = 0
               MOVE VEZ-VAL-CAPI IN VEZ TO WSS-VAL-CAPI IN WSS-VARI
               MOVE VEZ-VAL-FINA IN VEZ TO WSS-VAL-FINA IN WSS-VARI
               MOVE VEZ-VAL-SCAP IN VEZ TO VEZ-VAL-SCAP IN CAZ-FLD
               MOVE VEZ-VAL-SFIN IN VEZ TO VEZ-VAL-SFIN IN CAZ-FLD
               MOVE VEZ-VAL-SCAP IN VEZ TO RCZ-SGV-CAPI IN CAZ-FLD
               MOVE VEZ-VAL-SFIN IN VEZ TO RCZ-SGV-FINA IN CAZ-FLD
               MOVE WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI
               MOVE 1 TO WSS-IVEZ
               IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
                   MOVE ZEROES TO WSS-VAL-SMO8
                   ADD WSS-VAL-SMO8 TO WSS-VAL-SMO7
               ELSE
                  ADD  ZEROES TO WSS-VAL-SMO7
           ELSE
               ADD  VEZ-VAL-SCAP IN VEZ TO RCZ-SGV-CAPI IN CAZ-FLD
               ADD  VEZ-VAL-SFIN IN VEZ TO RCZ-SGV-FINA IN CAZ-FLD
               ADD  WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI.
           SUBTRACT RCZ-SGV-CAPI IN CAZ-FLD FROM OPZ-VAL-SCRE IN OPZ
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
           IF MSG-COD-MENS > SPACES
             MOVE FRM-SUAR-MAL   TO FRM-SUAR
             GO TO FIN-PRO-DESC-CTT-TADI.
           ADD 1 TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO NXT-PRO-DESC-CTT-TADI.
           GO TO LUP-PRO-DESC-CTT-TADI.
       NXT-PRO-DESC-CTT-TADI.

           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.

       FIN-PRO-DESC-CTT-TADI.
           EXIT.

       PRO-TCAN-CIE SECTION.
       INI-PRO-TCAN-CIE.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           IF DLZ-IND-SCTB IN DLZ = 'JUD' AND
              CAZ-SGV-TREN IN CAZ-FLD = 0 AND
              CAZ-SGV-GAST IN CAZ-FLD > 0
               IF ( CAZ-SGV-TPAG IN CAZ-FLD = 0 OR
                    CAZ-SGV-TPAG IN CAZ-FLD = CAZ-SGV-GAST IN CAZ-FLD )
                    MOVE ZEROES TO SCR-SGV-IPFC RCZ-SGV-CAPI IN CAZ-FLD
                                   RCZ-SGV-FINA IN CAZ-FLD
                                   CAZ-SGV-TPAG IN CAZ-FLD
                                   ICZ-SGV-TINT IN CAZ-FLD
                    MOVE SPACES TO FRM-GLS-TINT IN CAZ-FLD
                    MOVE 'S' TO WSS-IBLK-TINT
                    MOVE 'S' TO WSS-IBLK-TINT
                    GO TO FIN-PRO-TCAN-CIE.
           IF CAZ-FEC-FCAN IN CAZ > VEZ-FEC-FVEN IN VEZ
              PERFORM CAL-INT-FVEN
              PERFORM PRO-MORA-CIE
           ELSE
           IF CAZ-FEC-FCAN IN CAZ NOT > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-DESC-CIE.
       FIN-PRO-TCAN-CIE.
           EXIT.

       PRO-MORA-CIE SECTION.
       INI-PRO-MORA-CIE.
           PERFORM PRO-FUPM.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO FEC-DEC2.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO FEC-MEC2.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO FEC-SEC2.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CIE.
           IF ICZ-SGV-TINT IN CAZ-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE WSS-VAL-ICOM
               GO TO CON-PRO-CIE-TIPE.
       CON-PRO-CIE-TIPE.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * OPZ-VAL-SCRE IN OPZ
           ELSE
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * VEZ-VAL-SFIN IN CAZ-FLD.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * OPZ-VAL-SCRE IN OPZ
           ELSE
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * VEZ-VAL-SCAP IN VEZ.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-INT-TIPE TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-INT-TIPE.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-ICOM TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-ICOM.
           ADD WSS-VAL-ICOM TO CAZ-SGV-ICOM IN CAZ-FLD.
           ADD WSS-INT-TIPE TO CAZ-SGV-IPUN IN CAZ-FLD.
           MOVE WSS-VAL-ICOM TO WSS-VAL-SMO1.
           ADD  WSS-INT-TIPE TO WSS-VAL-SMO1.

           IF WSS-CIC-VCAM = '0999'
               MOVE SCR-COD-VCOC TO PES-COD-VCAM
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
           ELSE
               IF WSS-CIC-TVAL = '0'

                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM
                                     GIVING WSS-VAL-SMO1
                   MOVE SCR-COD-VCOC TO PES-COD-VCAM
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1.
           PERFORM CAL-COM.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           MOVE ZEROES TO SCR-SGV-IPFC.
           ADD WSS-VAL-ICOM TO SCR-SGV-IPFC.
           ADD WSS-INT-TIPE TO SCR-SGV-IPFC.
           PERFORM CAL-IMP.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           MOVE 0                       TO WSS-VAL-SMO7
           ADD  VEZ-VAL-IMPU IN CAZ-FLD  TO WSS-VAL-SMO7
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE ZEROES TO WSS-VAL-SMO8
              ADD WSS-VAL-SMO8 TO WSS-VAL-SMO7
           ELSE
              ADD  ZEROES TO WSS-VAL-SMO7.
           ADD CAZ-VAL-COMI IN CAZ-FLD  TO WSS-VAL-SMO7
           ADD FRM-VAL-PORT IN CAZ-FLD  TO WSS-VAL-SMO7
           ADD WSS-VAL-SMO7 TO WSS-VAL-SMO1
           DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM
                               GIVING WSS-VAL-SMO1 ROUNDED.

           ADD WSS-VAL-SMO1 VEZ-VAL-SFIN IN CAZ-FLD GIVING
                                        WSS-VAL-SMO2  ROUNDED.
           IF CAZ-SGV-TPAG IN CAZ-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM
                      GIVING CAZ-SGV-TPAG IN CAZ-FLD
               MOVE SCR-COD-VCOC TO PES-COD-VCAM
               MOVE CAZ-SGV-TPAG IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-TPAG IN CAZ-FLD
           ELSE
               MOVE CAZ-SGV-TPAG IN CAZ-FLD TO WSS-VAL-CMP2 IN WSS-VARI
               DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM
                                       GIVING WSS-VAL-SMO4
                  MOVE 'CANCIEDESCNO' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-PRO-MORA-CIE.

           IF WSS-VAL-SMO4 < WSS-VAL-SMO1
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING
                    RCZ-SGV-FINA IN CAZ-FLD.
           MOVE RCZ-SGV-FINA IN CAZ-FLD TO RCZ-SGV-CAPI IN CAZ-FLD.
              IF RCZ-SGV-CAPI IN CAZ-FLD > VEZ-VAL-SCAP IN CAZ-FLD
                 MOVE VEZ-VAL-SCAP IN CAZ-FLD
                                             TO RCZ-SGV-CAPI IN CAZ-FLD
                 GO TO FIN-PRO-MORA-CIE
              ELSE
                 GO TO FIN-PRO-MORA-CIE.
           ADD VEZ-VAL-SFIN IN CAZ-FLD TO RCZ-SGV-FINA IN CAZ-FLD
           SUBTRACT VEZ-VAL-SCAP IN CAZ-FLD FROM RCZ-SGV-FINA IN CAZ-FLD
           SUBTRACT VEZ-VAL-SCAP IN CAZ-FLD FROM VEZ-VAL-SFIN IN CAZ-FLD
                                            GIVING WSS-VAL-SMO2.
           SUBTRACT WSS-VAL-SMO2 FROM RCZ-SGV-FINA IN CAZ-FLD GIVING
                    RCZ-SGV-CAPI IN CAZ-FLD.
           IF RCZ-SGV-CAPI IN CAZ-FLD < ZEROES
               MOVE ZEROES TO RCZ-SGV-CAPI IN CAZ-FLD.
           SUBTRACT RCZ-SGV-CAPI IN CAZ-FLD FROM SCR-SGV-IPFC.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-IPUN IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           MULTIPLY PES-SGV-DECI IN PES-VARI BY SCR-SGV-VCAM
                             GIVING PES-SGV-DECI IN PES-VARI ROUNDED.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-IPUN IN CAZ-FLD.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-ICOM IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           MULTIPLY PES-SGV-DECI IN PES-VARI BY SCR-SGV-VCAM
                             GIVING PES-SGV-DECI IN PES-VARI ROUNDED.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-ICOM IN CAZ-FLD.
       FIN-PRO-MORA-CIE.
           EXIT.

       PRO-DESC-CIE SECTION.
       INI-PRO-DESC-CIE.
           MOVE 'CANCIEDESCNO' TO MSG-COD-MENS
           MOVE FRM-SUAR-MAL   TO FRM-SUAR
           GO TO FIN-PRO-DESC-CIE.
       FIN-PRO-DESC-CIE.
           EXIT.

       PRO-TCAN-CPE SECTION.
       INI-PRO-TCAN-CPE.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           IF CAZ-FEC-FCAN IN CAZ > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-MORA-CPE
           ELSE
           IF CAZ-FEC-FCAN IN CAZ NOT > VEZ-FEC-FVEN IN VEZ
               PERFORM PRO-DESC-CPE.
       FIN-PRO-TCAN-CPE.
           EXIT.

       PRO-MORA-CPE SECTION.
       INI-MORA-CPE.
           IF CAZ-SGV-TPAG IN CAZ-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.

           PERFORM PRO-FUPM.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO FEC-DEC2.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO FEC-MEC2.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO FEC-SEC2.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CPE.
           IF ICZ-SGV-TINT IN CAZ-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE WSS-VAL-ICOM
               GO TO CON-PRO-CPE-TIPE.
       CON-PRO-CPE-TIPE.
           ADD 1 TO INT-TIPE.
           MULTIPLY VEZ-VAL-SFIN IN CAZ-FLD BY INT-TIPE GIVING
                    WSS-VAL-SMO1 ROUNDED.
           DIVIDE CAZ-SGV-TPAG IN CAZ-FLD BY SCR-SGV-VCAM
                        GIVING WSS-VAL-SMO4 ROUNDED.
           DIVIDE WSS-VAL-SMO4 BY WSS-VAL-SMO1 GIVING
                        WSS-VAL-SMO1 ROUNDED.
           MULTIPLY VEZ-VAL-SFIN IN CAZ-FLD BY WSS-VAL-SMO1 GIVING
                    RCZ-SGV-FINA IN CAZ-FLD ROUNDED.
           SUBTRACT RCZ-SGV-FINA IN CAZ-FLD FROM VEZ-VAL-SFIN IN CAZ-FLD
                    GIVING WSS-VAL-SMO2.
           IF WSS-VAL-SMO2 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.
           MULTIPLY VEZ-VAL-SCAP IN CAZ-FLD BY WSS-VAL-SMO1 GIVING
                    RCZ-SGV-CAPI IN CAZ-FLD ROUNDED.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * RCZ-SGV-CAPI IN CAZ-FLD
           ELSE
              COMPUTE WSS-VAL-ICOM =
                   WSS-VAL-ICOM * RCZ-SGV-FINA IN CAZ-FLD.
           IF OPZ-NUM-VCOR IN OPZ = 1
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * RCZ-SGV-CAPI IN CAZ-FLD
           ELSE
              COMPUTE WSS-INT-TIPE =
                   WSS-INT-TIPE * RCZ-SGV-CAPI IN CAZ-FLD.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-INT-TIPE TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-INT-TIPE.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE WSS-VAL-ICOM TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-ICOM.
           ADD WSS-VAL-ICOM TO CAZ-SGV-ICOM IN CAZ-FLD.
           ADD WSS-INT-TIPE TO CAZ-SGV-IPUN IN CAZ-FLD.
           MOVE WSS-VAL-ICOM TO WSS-VAL-SMO1.
           ADD  WSS-INT-TIPE TO WSS-VAL-SMO1.
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           SUBTRACT RCZ-SGV-CAPI IN CAZ-FLD FROM SCR-SGV-IPFC.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-IPUN IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-IPUN IN CAZ-FLD.
           MOVE SCR-COD-VCOC TO PES-COD-VCAM.
           MOVE CAZ-SGV-ICOM IN CAZ-FLD TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAZ-SGV-ICOM IN CAZ-FLD.
       FIN-PRO-MORA-CPE.
           EXIT.

       PRO-DESC-CPE SECTION.
       INI-PRO-DESC-CPE.
       FIN-PRO-DESC-CPE.
           EXIT.

       PRO-TCAN-CCE SECTION.
       INI-PRO-TCAN-CCE.
           MOVE CAZ-NUM-DCAN IN CAZ-FLD TO CAZ-NUM-DCAN IN CAZ.
           MOVE CAZ-NUM-MCAN IN CAZ-FLD TO CAZ-NUM-MCAN IN CAZ.
           MOVE CAZ-NUM-SCAN IN CAZ-FLD TO CAZ-NUM-SCAN IN CAZ.
           MOVE CAZ-NUM-ACAN IN CAZ-FLD TO CAZ-NUM-ACAN IN CAZ.
           MOVE VEZ-NUM-DIMV IN CAZ-FLD TO VEZ-NUM-DIMV IN VEZ.
           MOVE VEZ-NUM-MIMV IN CAZ-FLD TO VEZ-NUM-MIMV IN VEZ.
           MOVE VEZ-NUM-SIMV IN CAZ-FLD TO VEZ-NUM-SIMV IN VEZ.
           MOVE VEZ-NUM-AIMV IN CAZ-FLD TO VEZ-NUM-AIMV IN VEZ.
           MOVE VEZ-NUM-DVEN IN CAZ-FLD TO VEZ-NUM-DVEN IN VEZ.
           MOVE VEZ-NUM-MVEN IN CAZ-FLD TO VEZ-NUM-MVEN IN VEZ.
           MOVE VEZ-NUM-SVEN IN CAZ-FLD TO VEZ-NUM-SVEN IN VEZ.
           MOVE VEZ-NUM-AVEN IN CAZ-FLD TO VEZ-NUM-AVEN IN VEZ.
           PERFORM PRO-DESC-CCE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-TCAN-CCE.
       FIN-PRO-TCAN-CCE.
           EXIT.
       PRO-DESC-CCE SECTION.
       INI-PRO-DESC-CCE.
           MOVE CAZ-SGV-TPAG IN CAZ-FLD TO RCZ-SGV-CAPI IN RCZ
                                           RCZ-SGV-CAPI IN CAZ-FLD.
           MOVE CAZ-SGV-TPAG IN CAZ-FLD TO RCZ-SGV-FINA IN RCZ
                                           RCZ-SGV-FINA IN CAZ-FLD.
       FIN-PRO-DESC-CCE.
           EXIT.
       PRO-FUPM SECTION.
       INI-PRO-FUPM.
           MOVE VEZ-NUM-DVEN IN VEZ     TO FEC-DEC1 WSS-NUM-DUPM.
           MOVE VEZ-NUM-MVEN IN VEZ     TO FEC-MEC1 WSS-NUM-MUPM.
           MOVE VEZ-NUM-SVEN IN VEZ     TO FEC-SEC1 WSS-NUM-SUPM.
           MOVE VEZ-NUM-AVEN IN VEZ     TO FEC-AEC1 WSS-NUM-AUPM.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO RCZ-CAI-IOPV IN RCZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO RCZ-IIC-IOPV IN RCZ.
           MOVE VEZ-NUM-IVCT IN VEZ     TO RCZ-NUM-IVCT IN RCZ.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT (FIO-STAT-OKS AND
              CAZ-CAI-IOPC IN CAZ-FLD = RCZ-CAI-IOPV IN RCZ AND
              CAZ-IIC-IOPC IN CAZ-FLD = RCZ-IIC-IOPV IN RCZ AND
              VEZ-NUM-IVCT IN VEZ     = RCZ-NUM-IVCT IN RCZ )
               GO TO EXT-PRO-FUPM.
           MOVE 1 TO WSS-NUM-ICAN IN WSS-VARI.
       LUP-PRO-FUPM.
           MOVE RCZ-KEY-ICAN TO CAZ-KEY-ICAN IN CAZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-CAZ.
           IF CAZ-MSC-FCAN IN CAZ = 'P'
               GO TO NXT-PRO-FUPM.
           IF CAZ-MSC-STAT IN CAZ NOT = 'R' AND
              CAZ-SGV-TPAG IN CAZ NOT < ZEROES AND
              CAZ-SGV-TREN IN CAZ NOT < ZEROES AND
              CAZ-FEC-FCAN IN CAZ >     VEZ-FEC-FVEN IN VEZ      AND
              CAZ-FEC-FCAN IN CAZ >     WSS-FEC-FUPM IN WSS-VARI AND
              CAZ-NUM-ICAN IN CAZ NOT = CAZ-NUM-ICAN IN CAZ-FLD  AND
              CAZ-SGV-TPAG IN CAZ NOT = CAZ-SGV-GAST IN CAZ
               MOVE CAZ-NUM-DCAN IN CAZ TO FEC-DEC1 WSS-NUM-DUPM
               MOVE CAZ-NUM-MCAN IN CAZ TO FEC-MEC1 WSS-NUM-MUPM
               MOVE CAZ-NUM-SCAN IN CAZ TO FEC-SEC1 WSS-NUM-SUPM
               MOVE CAZ-NUM-ACAN IN CAZ TO FEC-AEC1 WSS-NUM-AUPM.
       NXT-PRO-FUPM.
           MOVE 'RCZ-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM CBZ-FIO-RCZ.
           IF NOT (FIO-STAT-OKS AND
              CAZ-CAI-IOPC IN CAZ-FLD = RCZ-CAI-IOPV IN RCZ AND
              CAZ-IIC-IOPC IN CAZ-FLD = RCZ-IIC-IOPV IN RCZ AND
              VEZ-NUM-IVCT IN VEZ     = RCZ-NUM-IVCT IN RCZ )
               GO TO EXT-PRO-FUPM.
           GO TO LUP-PRO-FUPM.
       EXT-PRO-FUPM.
           PERFORM RET-CAZ-CAZ.
       FIN-PRO-FUPM.
           EXIT.

       BUS-SIG-VEN SECTION.
       INI-BUS-SIG-VEN.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE VEZ-NUM-IVEN IN CAZ-FLD TO VEZ-NUM-IVEN IN VEZ.
       LUP-BUS-SIG-VEN.
           ADD 1 TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-SIG-VEN.
           IF VEZ-FEC-FVEN IN VEZ > CAZ-FEC-FCAN IN CAZ
               MOVE ZEROES TO RCZ-SGV-FINA IN CAZ-FLD
               MOVE ZEROES TO RCZ-SGV-CAPI IN CAZ-FLD
               MOVE 'EXTVENSGNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-SIG-VEN.
           GO TO LUP-BUS-SIG-VEN.
       FIN-BUS-SIG-VEN.
           EXIT.

       BUS-ANT-VEN SECTION.
       INI-BUS-ANT-VEN.
           MOVE CAZ-CAI-IOPC IN CAZ-FLD TO VEZ-CAI-IOPC IN VEZ.
           MOVE CAZ-IIC-IOPC IN CAZ-FLD TO VEZ-IIC-IOPC IN VEZ.
           MOVE VEZ-NUM-IVEN IN CAZ-FLD TO VEZ-NUM-IVEN IN VEZ.
       LUP-BUS-ANT-VEN.
           SUBTRACT 1 FROM VEZ-NUM-IVEN IN VEZ.
           IF VEZ-NUM-IVEN IN VEZ NOT > ZEROES
               GO TO FIN-BUS-ANT-VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-ANT-VEN.
           IF VEZ-VAL-SFIN IN VEZ > ZEROES
               MOVE ZEROES TO RCZ-SGV-FINA IN CAZ-FLD
               MOVE ZEROES TO RCZ-SGV-CAPI IN CAZ-FLD
               MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-ANT-VEN.
           GO TO LUP-BUS-ANT-VEN.
       FIN-BUS-ANT-VEN.
           EXIT.

       PRO-UVCT-DVEG SECTION.
       INI-PRO-UVCT-DVEG.
           MOVE DLZ-NUM-DDEV IN DLZ TO FEC-DEC1.
           MOVE DLZ-NUM-MDEV IN DLZ TO FEC-MEC1.
           MOVE DLZ-NUM-SDEV IN DLZ TO FEC-SEC1.
           MOVE DLZ-NUM-ADEV IN DLZ TO FEC-AEC1.
       FIN-PRO-UVCT-DVEG.
           EXIT.


       GLS-INT-TIPE SECTION.
       INI-GLS-INT-TIPE.
           MOVE 'TIPE'              TO ITZ-COD-TINT IN ITZ.
           MOVE 'TIPE'              TO SCR-COD-TICG.
           MOVE 'CBZ'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITZ-COD-TINT IN ITZ TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ITZ-COD-TINT IN ITZ NOT > SPACES
               MOVE 'TASA PERIODO' TO FRM-GLS-TINT IN CAZ-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAZ-FLD.
       FIN-GLS-INT-TIPE.
           EXIT.

       LEE-CCB SECTION.
       INI-LEE-CCB.
           MOVE CAZ-CIC-IOPC IN CAZ TO CCZ-CIC-IOPC IN CCZ.
           MOVE VEZ-NUM-IDLC IN VEZ TO CCZ-NUM-IDLC IN CCZ.
           MOVE 99                  TO CCZ-NUM-ICCB IN CCZ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM CBZ-FIO-CCZ.
           IF NOT ( FIO-STAT-OKS AND
                    CAZ-CIC-IOPC IN CAZ = CCZ-CIC-IOPC IN CCZ AND
                    VEZ-NUM-IDLC IN VEZ = CCZ-NUM-IDLC IN CCZ )
              GO TO FIN-LEE-CCB.
           MOVE CCZ-SGV-GAST IN CCZ TO WSS-SGV-GPRO IN WSS-VARI.
       FIN-LEE-CCB.
           EXIT.
       LEE-MIN-COM-BOL SECTION.
       INI-LEE-MIN-COM-BOL.
           MOVE '19000101'              TO CAM-FEC-FCAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)  TO CAM-FEC-FCAM IN CAM(2)
           MOVE 'MCMC  '                TO CAM-COD-VCAM IN CAM(1)
           MOVE OPZ-COD-VCOC IN OPZ     TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
              MOVE ZEROES TO CAM-SGV-VCAM IN CAM
           ELSE
              IF CAM-IND-VIGE IN CAM NOT = 'S'
                 MOVE ZEROES TO CAM-SGV-VCAM IN CAM.
       FIN-LEE-MIN-COM-BOL.
           EXIT.
       CAL-INT-FVEN SECTION.
       INI-CAL-INT-FVEN.
           IF (VEZ-IND-SCTB IN VEZ = 'VIG' OR SPACES)
              GO TO FIN-CAL-INT-FVEN.
           SUBTRACT VEZ-VAL-SCAP IN VEZ FROM VEZ-VAL-SFIN IN VEZ
                                    GIVING WSS-VAL-SMO8.
           IF WSS-CIC-TVAL = '0' AND NOT WSS-CIC-VCAM = '0999'
              MOVE '0999  '     TO TAB-CIC-CTAB IN TAB
              MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB
              MOVE VEZ-NUM-DVEN IN VEZ TO TAB-NUM-DTRN IN TAB
              MOVE VEZ-NUM-MVEN IN VEZ TO TAB-NUM-MTRN IN TAB
              MOVE VEZ-NUM-SVEN IN VEZ TO TAB-NUM-STRN IN TAB
              MOVE VEZ-NUM-AVEN IN VEZ TO TAB-NUM-ATRN IN TAB
              PERFORM GET-VCAM
              IF MSG-COD-MENS = SPACES
                 MULTIPLY WSS-VAL-SMO8 BY CAM-SGV-VCAM IN CAM
                 GIVING WSS-VAL-SMO8  ROUNDED
                 ADD WSS-VAL-SMO8 TO SCR-VAL-INTV
                 MOVE ZEROES TO WSS-VAL-SMO8
                 ADD WSS-VAL-SMO8 TO SCR-VAL-SEGV
              ELSE
                 ADD WSS-VAL-SMO8 TO SCR-VAL-INTV
                 ADD ZEROES TO SCR-VAL-SEGV
           ELSE
              ADD ZEROES TO  SCR-VAL-SEGV
              ADD WSS-VAL-SMO8 TO SCR-VAL-INTV.
       FIN-CAL-INT-FVEN.
           EXIT.
      *>>>>
