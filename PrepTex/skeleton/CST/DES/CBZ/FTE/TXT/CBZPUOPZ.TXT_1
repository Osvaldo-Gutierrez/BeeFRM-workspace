
*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*%! INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*%! IF ( PGM_CHI AND PGM_BCI ) OR PGM_PER
*% IF PGM_CHI AND PGM_BCI
*%     PGM_PTC = TRUE
*% END
*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
       COPY CBZWGENG.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-IND-ACAN                         PIC X(03).
           02 SCR-MSC-TCAN                         PIC X(01).
           02 SCR-OPC-STAT                         PIC X(01).
           02 SCR-CIC-OPEC                         PIC X(01).
           02 SCR-CIC-TCOL                         PIC X(03).
           02 SCR-CIC-TDOC                         PIC X(03).
           02 SCR-IND-OPEE                         PIC X(01).
           02 SCR-OLD-IEST                         PIC X(12).
           02 SCR-NEW-IEST                         PIC X(12).
           02 SCR-IND-PORC                         PIC X(01).
           02 SCR-COD-TINT                         PIC X(12).
           02 SCR-GLS-TIAO                         PIC X(01).
           02 SCR-GLS-CIAO                         PIC X(03). 
      *>>>>
*% END
*% LARGO_MI_COMMAREA = 2750
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF WSS
      *<<<< WSS
*% IF WSS
      *<<<< WSS
      *PTC-INI:   12-NOV-1996 08:50:01 
      * COPY COLMXW05.
      * COPY GNSWGTSK.
      *PTC-FIN:   12-NOV-1996 08:50:01 
      *>>>>
*% END
       COPY CBZBRPOZ.
       COPY CBZWGRNO.
       COPY CBZBRPIZ.
       COPY CBZBRPCZ.

       COPY CBZWGSTO.
       01  WSS-VARI.
      *HZF-INI 11-DEC-1996 
           03 CCO-CIC-ICLI.
              05 CCO-CAI-ICLI     VALUE SPACES    PIC X(04).
              05 CCO-IIC-ICLI     VALUE ZEROES    PIC 9(08).
           03 CIM-CIC-ICLI.
              05 CIM-CAI-ICLI     VALUE SPACES    PIC X(04).
              05 CIM-IIC-ICLI     VALUE ZEROES    PIC 9(08).
      *HZF-FIN 11-DEC-1996 
           03  WSS-FHOY.
               05 WSS-SHOY                            PIC 9(02).
               05 WSS-AHOY                            PIC 9(02).
               05 WSS-MHOY                            PIC 9(02).
               05 WSS-DHOY                            PIC 9(02).
           03  WSS-FEC-FCTB.
               05  WSS-NUM-SCTB                       PIC 9(02).
               05  WSS-NUM-ACTB                       PIC 9(02).
               05  WSS-NUM-MCTB                       PIC 9(02).
               05  WSS-NUM-DCTB                       PIC 9(02).
           03  WSS-FEC-FAUX.
               05  WSS-NUM-SAUX                       PIC 9(02).
               05  WSS-NUM-AAUX                       PIC 9(02).
               05  WSS-NUM-MAUX                       PIC 9(02).
               05  WSS-NUM-DAUX                       PIC 9(02).
           03  WSS-VAL-PESO                            PIC 9(11).
           03  WSS-KEY-RENO.
               05  WSS-IND-RENO                   PIC X(03).
               05  WSS-GLS-RENO                   PIC X(06).
               05  WSS-TIO-RENO                   PIC X(03).
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-SGV-RENO-CNV COMP-3            PIC S9(11)V9(04).
           03  WSS-COD-VCOC-CNV                   PIC X(06).
           03  WSS-MSC-STAT                            PIC X(01).
           03 WSS-CAI-ICTA.
              05 WSS-CAI-ICTA-NUM                      PIC 9(03).
              05 FILLER                                PIC X(01).
           03 WSS-IIC-ICTA.
              05 FILLER                                PIC X(01).
              05 WSS-IIC-ICTA-NUM                      PIC 9(07).
           03 WSS-CTA-AHO.
              05 WSS-SUC-CTA-AHO                       PIC 9(03).
              05 WSS-COD-CTA-AHO                       PIC 9(07).
           03  WSS-VLR.    
               05  WSS-CIC-VCAM.
                   07  WSS-CIC-TVAL               PIC X(01).
                   07  WSS-CIC-CVAL               PIC X(03).
                   07  WSS-CIC-TCAM               PIC X(08).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  WSS-I                              PIC 9(02).
           03  WSS-COD-TINT                       PIC X(12).
           03  PGM-STAT-POZ          VALUE '23'   PIC X(02).
               88 PGM-STAT-POZ-OKS   VALUE '00'.
               88 PGM-STAT-POZ-NUL   VALUE '  '.
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  WSS-CIC-TCYA          VALUE SPACES PIC X(02).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-SGV-VAL1-EDT  PIC --------------,---.
               05  WSS-GLS-GUI1                    PIC X(01).
               05  WSS-SGV-VAL2-EDT  PIC --------------,---.
           03  NOV-SGV-DIFE          COMP-3        PIC S9(11)V9(4).
           03  NOV-SGV-SNOV          COMP-3        PIC S9(11)V9(4).
           03  WSS-VAL-SVEN          COMP-3        PIC S9(11)V9(4).

           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                    PIC X(40).
               05  WSS-CPT-CAI                     PIC X(04).
               05  WSS-CPT-IIC                     PIC X(08).
               05  WSS-GLS-DATA                    PIC X(40).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(92).
       COPY CBZWUOPZ.
       COPY GNSBRCIC.
       COPY TABBRCAM.
       COPY TABBRAHO.
       COPY SGCBRDBC.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.

       COPY CBZBRRDZ.
       COPY CBZBRCOZ.
       COPY CBZBRDLZ.
       COPY CBZBRVEZ.
       COPY CBZBRCYZ.
       COPY CBZBRAUZ.
       COPY CBZBRCAZ.
       COPY CBZBRROZ.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY GNSWGCIC.
       COPY CBZWGPMP.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PIZ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCZ-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *PTC-INI:   12-NOV-1996 08:50:01 
      *     PERFORM GET-TSK-TERM.
      *PTC-FIN:   12-NOV-1996 08:50:01 
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2
               MOVE 'O'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-TSTP TO OPZ-STP-ITRN IN OPZ.
           IF SCR-CMND = 'MCA'
               GO TO AUZ-FND-KEY.
           MOVE 1 TO OPZ-NUM-IVEN IN OPZ.
           PERFORM GET-UPD-COZ.
           PERFORM GET-UPD-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
       AUZ-FND-KEY.
           PERFORM GET-UPD-CYZ.
           PERFORM GET-UPD-AUZ.
           PERFORM GET-UPD-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           MOVE OPZ-MSC-STAT IN OPZ TO WSS-MSC-STAT.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           MOVE WSS-MSC-STAT TO OPZ-MSC-STAT IN OPZ.
           IF ( SCR-CMND = 'MCA' )
               NEXT SENTENCE
           ELSE
               MOVE STO-MODIFICADA   IN STO-VARI
                                         TO OPZ-MSC-STAT IN OPZ.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           IF SCR-CMND = 'MCA'
               GO TO MOD-AUT-FND-KEY.
           PERFORM MOD-COZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
       MOD-AUT-FND-KEY.
           IF PGM-STAT-CYZ-OKS
               PERFORM MOD-CYZ
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-MOD.
           PERFORM MOD-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-AUZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                  TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE SPACES       TO OPZ-GLS-FLAG IN OPZ.
           MOVE STO-INGRESADA IN STO-VARI TO OPZ-MSC-STAT IN OPZ.
           MOVE SPACES       TO OPZ-MSC-TACC IN OPZ.
           MOVE SPACES       TO OPZ-COD-OTRN IN OPZ.
           MOVE SPACES       TO OPZ-COD-ATRN IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-VCOR IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-VCVG IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-VCCO IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-VCCM IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-VCCV IN OPZ.
           MOVE ZEROES       TO OPZ-NUM-TVCC IN OPZ.
           MOVE SCR-IND-PORC TO OPZ-IND-PORC IN OPZ.
           MOVE ZEROES       TO OPZ-FEC-FMAV IN OPZ.
           IF POZ-IND-CAUT IN POZ = 'V'
               MOVE 'S'      TO OPZ-IND-PVEN IN OPZ
           ELSE
               MOVE 'N'      TO OPZ-IND-PVEN IN OPZ.
           MOVE SPACES       TO OPZ-GLS-DISP IN OPZ.
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-TSTP     TO OPZ-STP-ITRN IN OPZ.
           MOVE 1 TO OPZ-NUM-IVEN IN OPZ.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           IF OPZ-IIC-IOPC IN OPZ-FLD NOT > ZEROES
               PERFORM SET-TCIC
               PERFORM SET-CCIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CIC-ICIC TO OPZ-CIC-IOPC IN OPZ
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'MSGKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE CIC-CAI-ICIC TO OPZ-CAI-IOPC     IN OPZ-FLD
                   MOVE CIC-IIC-ICIC TO OPZ-IIC-IOPC-EDT IN OPZ-EDT
                   MOVE OPZ-IIC-IOPC-EDT IN OPZ-EDT TO 
                        OPZ-IIC-IOPC-ALF IN OPZ-FLD

                   MOVE MSG-GLS-DESC            TO WSS-CPT-DESC
                   MOVE OPZ-CAI-IOPC IN OPZ-FLD TO WSS-CPT-CAI
                   MOVE OPZ-IIC-IOPC IN OPZ-FLD TO WSS-CPT-IIC
                   MOVE MSG-GLS-DATA            TO WSS-GLS-DATA
                   MOVE WSS-CPT-NOMB-R          TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN                TO FRM-MENS

                   MOVE FRM-MENS TO SCR-MENS-EXT
           ELSE
               MOVE OPZ-CAI-IOPC IN OPZ-FLD TO CIC-CAI-ICIC
               MOVE OPZ-IIC-IOPC IN OPZ-FLD TO CIC-IIC-ICIC.

      *PTC-INI:   12-NOV-1996 08:50:01 
      *     MOVE PTC-OPC-TYPE TO QUE-TYPE.
      *     MOVE TSK-TERM-ALF TO QUE-TERM.
      *     MOVE PTC-OPC-LENG TO QUE-LITM.
      *     MOVE QUE-PUT      TO QUE-CMND.
      *     MOVE CIC-CAI-ICIC TO PTC-OPC-OPC-CAI-IOPC.
      *     MOVE CIC-IIC-ICIC TO PTC-OPC-OPC-IIC-IOPC.
      *     MOVE PTC-OPC-ITEM TO QUE-ITEM.
      *     PERFORM GNS-PRO-QUE.
      *PTC-FIN:   12-NOV-1996 08:50:01 
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           PERFORM PUT-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-COZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-COZ-FLV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-CYZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-AUZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-ROZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           MOVE CIC-CAI-ICIC TO SCR-CAI-IOPC.
           MOVE CIC-IIC-ICIC TO SCR-IIC-IOPC.
           MOVE  ZEROES      TO SCR-NUM-IDOC.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDIR)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDIR)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDIR)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDIR).
           MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IICG).
           MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IICG).
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ICYA)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ICYA)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ICYA)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ICYA).
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDLC).
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDLC).
           PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           PERFORM DEL-DLZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-CYZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-RDZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-VEZ.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *>>>>
*% END

*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET
           IF SCR-CMND NOT = 'APR'
               GO TO FIN-CMN-ACC.
           PERFORM RET-HDR-OPZ.
           MOVE STO-APROBADA TO OPZ-MSC-STAT IN OPZ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CBZ-FIO-OPZ.
           IF FIO-STAT-OKS
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    APROK' TO MSG-COD-MENS
           ELSE
               MOVE 'CBZ'          TO MSG-COD-SIST
               MOVE 'OPZ    APRER' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF INI_STP_EXIT
      *<<<< INI_STP_EXIT
           IF SCR-CCPP = 'ING'
               MOVE 'CBZPIOPZ' TO SCR-PROV
               MOVE 'ZO43'     TO SCR-NTRV
           ELSE
               MOVE 'CBZPQOPZ' TO SCR-PROV
               MOVE 'ZO40'     TO SCR-NTRV.
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF6 OR
                            FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           MOVE FRM-CPIM-UBY TO OPZ-COD-TOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-UBY TO OPZ-COD-VCOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-UBY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-UBY TO CAZ-CAI-IOPC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-UBY TO CAZ-IIC-IOPC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-UBY TO CAZ-NUM-ICAN-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'MCA'
               MOVE FRM-CPIM-AEY TO CAZ-CAI-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-IIC-IOPC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CAZ-NUM-ICAN-ATR IN OPZ-FLD.
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
           MOVE SPACES TO SCR-OPC-STAT.
           MOVE SPACES TO SCR-CIC-OPEC.
           MOVE SPACES TO SCR-CIC-TCOL.
           MOVE SPACES TO SCR-CIC-TDOC.
           MOVE SPACES TO SCR-IND-OPEE.
           MOVE SPACES TO SCR-OLD-IEST.
           MOVE SPACES TO SCR-NEW-IEST.
           MOVE SPACES TO SCR-IND-PORC.
           MOVE SPACES TO SCR-GLS-TIAO.
           MOVE SPACES TO SCR-GLS-CIAO.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           PERFORM PRO-FLD-BCI.

           MOVE FRM-CPIM-AEY TO OPZ-COD-TOOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-VCOC-ATR IN OPZ-FLD.
           MOVE FRM-CPIM-AEY TO OPZ-COD-AOOC-ATR IN OPZ-FLD.
           MOVE 0            TO OPZ-COD-VCOC-LEN IN OPZ-FLD.
           MOVE -1           TO DBC-NUM-ICLI-LEN IN OPZ-FLD.
           MOVE OPZ-COD-VCOC IN OPZ-FLD TO POZ-COD-VCOC IN POZ.
           MOVE OPZ-COD-TOOC IN OPZ-FLD TO POZ-COD-TOOC IN POZ.
           MOVE OPZ-COD-AOOC IN OPZ-FLD TO POZ-COD-AOOC IN POZ.
           MOVE ZEROES                  TO POZ-NUM-IPOC IN POZ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CBZ-FIO-POZ.
           IF NOT FIO-STAT-OKS
               GO TO CON-HBL-FLD.
           IF NOT ( SCR-CIC-TDOC = 'LTR' OR 'PAG' )
               MOVE FRM-CPIM-AEY TO OPZ-NUM-NPLA-ATR IN OPZ-FLD.
           IF NOT ( SCR-CIC-TDOC = 'LTR' AND
                    OPZ-IND-VSTR IN OPZ-FLD = 'N' )
               MOVE FRM-CPIM-AEY TO OPZ-NUM-VCOR-ATR IN OPZ-FLD.
           IF POZ-COD-COTO IN POZ = 'LAC'
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO AUZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO AUZ-IIC-ICYA-ATR IN OPZ-FLD.

           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-OPZ
               PERFORM PRO-MKY-OPZ
               MOVE FRM-CPIM-UBY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
               MOVE FRM-CPIM-UBY TO OPZ-COD-RMOC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD
               IF POZ-COD-COTO IN POZ NOT = 'LAC'
                   MOVE FRM-CPIM-UBY TO AUZ-CAI-ICYA-ATR IN OPZ-FLD
                   MOVE FRM-CPIM-UBY TO AUZ-IIC-ICYA-ATR IN OPZ-FLD.
           IF SCR-CMND = 'MCA'
               IF DBC-IND-ICLI IN OPZ-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD
                   MOVE 0            TO OPZ-COD-OFOC-LEN IN OPZ-FLD
                   MOVE -1           TO RDZ-NUM-DIRE-LEN IN OPZ-FLD
               ELSE
                   MOVE 0            TO OPZ-COD-OFOC-LEN IN OPZ-FLD
                   MOVE -1           TO RDZ-NUM-DIRE-LEN IN OPZ-FLD.

           IF SCR-CCPP NOT = 'ING'
               GO TO CON-HBL-FLD.
           IF POZ-IND-TCBZ IN POZ > SPACES
               MOVE FRM-CPIM-AEY TO OPZ-IND-TCBZ-ATR IN OPZ-FLD.
           IF POZ-IND-AFER IN POZ > SPACES
               MOVE FRM-CPIM-AEY TO OPZ-IND-AFER-ATR IN OPZ-FLD.
           IF POZ-IND-RENO IN POZ > SPACES
               MOVE POZ-IND-RENO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NOT NUM-STAT-OKS
                  MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD.
           IF POZ-COD-PLCO IN POZ > SPACES
               MOVE FRM-CPIM-AEY TO OPZ-COD-PLCO-ATR IN OPZ-FLD.
           IF POZ-COD-PLIM IN POZ > SPACES
               MOVE FRM-CPIM-AEY TO OPZ-COD-PLIM-ATR IN OPZ-FLD.
           IF POZ-IND-TABO IN POZ > SPACES
               MOVE POZ-IND-TABO IN POZ TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 5          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NOT NUM-STAT-OKS
                   MOVE FRM-CPIM-AEY TO CYZ-IND-TCYA-ATR IN OPZ-FLD.
       CON-HBL-FLD.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO RDZ-NUM-DIRE-ATR IN OPZ-FLD.
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M' AND
              SCR-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYZ-IND-TCYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-CAI-ICYA-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO CYZ-IIC-ICYA-ATR IN OPZ-FLD.
           MOVE SCR-OPC-STAT TO OPZ-MSC-STAT IN OPZ
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       SET-TCIC SECTION.
       INI-SET-TCIC.
           MOVE 'Z'  TO CIC-COD-TCIC IN CIC.
      *     MOVE PTC-OPC-TYPE-SIMU TO QUE-TYPE.
      *     MOVE TSK-TERM-ALF TO QUE-TERM.
      *     MOVE PTC-OPC-LENG TO QUE-LITM.
      *     MOVE 1            TO  QUE-NITM.
      *     MOVE QUE-GET        TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *     IF QUE-STAT = QUE-STAT-OKS
      *          MOVE 'S'  TO CIC-COD-TCIC IN CIC
      *          MOVE QUE-DEL        TO QUE-CMND
      *          PERFORM GNS-PRO-QUE.
       FIN-SET-TCIC.
           EXIT.

       SET-CCIC SECTION.
       INI-SET-CCIC.
           IF CIC-COD-TCIC IN CIC = 'Z'
               MOVE OPZ-COD-OFOC IN OPZ-FLD TO CIC-COD-CCIC IN CIC
           ELSE
               MOVE 'OPC' TO CIC-COD-CCIC IN CIC.
       FIN-SET-CCIC.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

      * INIT
      * ====

       INI-REG-RDZ SECTION.
       INI-INI-REG-RDZ.
           MOVE SPACES   TO RDZ-GLS-FLAG IN RDZ.
           MOVE SPACES   TO RDZ-GLS-DISP IN RDZ.
       FIN-INI-REG-RDZ.
           EXIT.

       INI-REG-COZ SECTION.
       INI-INI-REG-COZ.
           MOVE SPACES   TO COZ-GLS-FLAG IN COZ.
           MOVE ZEROES   TO COZ-FEC-FTER IN COZ.
           MOVE ZEROES   TO COZ-SGV-SPRD IN COZ.
           MOVE ZEROES   TO COZ-SGV-MNTO IN COZ.
           MOVE SPACES   TO COZ-GLS-DISP IN COZ.
       FIN-INI-REG-COZ.
           EXIT.

       INI-REG-CYZ SECTION.
       INI-INI-REG-CYZ.
           MOVE SPACES TO CYZ-GLS-FLAG IN CYZ.
           MOVE SPACES TO CYZ-VRF-ICYA IN CYZ.
           MOVE ZEROES TO CYZ-SGV-LIQU IN CYZ.
           MOVE ZEROES TO CYZ-NUM-OPER IN CYZ.
           MOVE SPACES TO CYZ-GLS-DISP IN CYZ.
       FIN-INI-REG-CYZ.
           EXIT.

       INI-REG-AUZ SECTION.
       INI-INI-REG-AUZ.
           MOVE SPACES TO AUZ-GLS-FLAG IN AUZ.
           MOVE SPACES TO AUZ-VRF-ICYA IN AUZ.
           MOVE ZEROES TO AUZ-SGV-LIQU IN AUZ.
           MOVE ZEROES TO AUZ-NUM-OPER IN AUZ.
           MOVE SPACES TO AUZ-GLS-DISP IN AUZ.
           MOVE SPACES TO AUZ-IND-TCYA IN AUZ.
           MOVE SPACES TO AUZ-COD-OFIC IN AUZ.
           MOVE 'TCYA' TO MSC-CIC-TMSC IN MSC.
           MOVE 'CCTE' TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO AUZ-IND-TCYA IN AUZ.
           MOVE SPACES TO AUZ-COD-OFIC IN AUZ.
           MOVE AUZ-CAI-ICYA IN OPZ-FLD TO OPE-CAI-IOPE IN OPE.
           MOVE AUZ-IIC-ICYA IN OPZ-FLD TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               MOVE OPE-COD-OFOP IN OPE TO AUZ-COD-OFIC IN AUZ.
       FIN-INI-REG-AUZ.
           EXIT.

       INI-REG-ROZ SECTION.
       INI-INI-REG-ROZ.
           MOVE SPACES   TO ROZ-GLS-FLAG IN ROZ.
           MOVE SPACES   TO ROZ-COD-VCVR IN ROZ.
           MOVE SPACES   TO ROZ-GLS-DISP IN ROZ.
       FIN-INI-REG-ROZ.
           EXIT.

      * GET-UPD
      * =======

       GET-UPD-RDZ SECTION.
       INI-GET-UPD-RDZ.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-RDZ.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO RDZ-CIC-IOPC IN RDZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO RDZ-IIC-IOPC IN RDZ.
           MOVE ZEROES                  TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-GET-UPD-RDZ.
           IF RDZ-CAI-ICLI IN OPZ-FLD = RDZ-CAI-ICLI IN RDZ AND
              RDZ-IIC-ICLI IN OPZ-FLD = RDZ-IIC-ICLI IN RDZ
               MOVE WSS-MISMO TO WSS-MRDC
           ELSE
               MOVE WSS-OTRO  TO WSS-MRDC.
       FIN-GET-UPD-RDZ.
           EXIT.

       GET-UPD-COZ SECTION.
       INI-GET-UPD-COZ.
           PERFORM GET-CUR-COZ.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-COZ
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM CBZ-FIO-COZ
               IF NOT FIO-STAT-OKS
                   MOVE '23' TO PGM-STAT-COZ
               ELSE
                    MOVE '00' TO PGM-STAT-COZ.
       FIN-GET-UPD-COZ.
           EXIT.

       GET-UPD-CYZ SECTION.
       INI-GET-UPD-CYZ.
           IF CYZ-IND-TCYA IN OPZ-FLD = 'M'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-CYZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE 1                   TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
                 MOVE '23' TO PGM-STAT-CYZ
           ELSE
                MOVE '00' TO PGM-STAT-CYZ.
       FIN-GET-UPD-CYZ.
           EXIT.

       GET-UPD-AUZ SECTION.
       INI-GET-UPD-AUZ.
           MOVE OPZ-CAI-IOPC IN OPZ-FLD TO AUZ-CAI-IOPC IN AUZ.
           MOVE OPZ-IIC-IOPC IN OPZ-FLD TO AUZ-IIC-IOPC IN AUZ.
           MOVE 'AUT'                   TO AUZ-NUM-ICAN IN AUZ.
           MOVE 1                       TO AUZ-NUM-ICYA IN AUZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-AUZ.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-AUZ
           ELSE
               MOVE '00' TO PGM-STAT-AUZ.
           MOVE '00' TO FIO-STAT.
       FIN-GET-UPD-AUZ.
           EXIT.

       GET-UPD-ROZ SECTION.
       INI-GET-UPD-ROZ.
           MOVE '00' TO FIO-STAT.
           MOVE '23' TO PGM-STAT-ROZ.
           IF CAZ-IIC-IOPC IN OPZ-FLD > ZEROES
               MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ
               MOVE CAZ-CAI-IOPC IN OPZ-FLD TO ROZ-CAI-IOPV IN ROZ
               MOVE CAZ-IIC-IOPC IN OPZ-FLD TO ROZ-IIC-IOPV IN ROZ
               MOVE CAZ-NUM-ICAN IN OPZ-FLD TO ROZ-NUM-IVCT IN ROZ
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM CBZ-FIO-ROZ
               IF FIO-STAT-OKS
                   MOVE FIO-STAT TO PGM-STAT-ROZ
               ELSE
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-GET-UPD-ROZ.
           EXIT.

      * PUT
      * ===
       PUT-RDZ SECTION.
       INI-PUT-RDZ.
           IF DBC-IND-ICLI IN OPZ-FLD NOT = 'M'
               PERFORM INI-REG-RDZ
               MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ
               MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ
               MOVE 100 TO RDZ-VAL-LIMD IN RDZ
               MOVE FIO-PUT TO FIO-CMND
               PERFORM CBZ-FIO-RDZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-RDZ.
           EXIT.
       PUT-COZ SECTION.
       INI-PUT-COZ.
               IF COZ-SGV-TINT IN OPZ-FLD > ZEROES
                   PERFORM INI-REG-COZ
                   MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ
                   MOVE ZEROES              TO COZ-NUM-ICAN IN COZ
                   MOVE SPACES              TO COZ-CIC-IOPV IN COZ
                   MOVE ZEROES              TO COZ-NUM-IVCT IN COZ
                   MOVE 'COM   '            TO COZ-IND-TTAS IN COZ
                   MOVE ZEROES              TO COZ-FEC-FINI IN COZ
                   MOVE ZEROES              TO COZ-SGV-MCAL IN COZ
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM CBZ-FIO-COZ
                   IF NOT FIO-STAT-OKS
                       MOVE FIO-MENS TO FRM-MENS
                       PERFORM BCK-OUT.
       FIN-PUT-COZ.
           EXIT.
       PUT-COZ-FLV SECTION.
       INI-PUT-COZ-FLV.
           IF FRM-SGV-TFLV IN OPZ-FLD > ZEROES
              PERFORM INI-REG-COZ
              MOVE WSS-SGV-TCOM        TO COZ-SGV-TINT IN COZ 
              MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ
              MOVE ZEROES              TO COZ-NUM-ICAN IN COZ
              MOVE SPACES              TO COZ-CIC-IOPV IN COZ
              MOVE ZEROES              TO COZ-NUM-IVCT IN COZ
              MOVE 'COM000'            TO COZ-IND-TTAS IN COZ
              MOVE ZEROES              TO COZ-FEC-FINI IN COZ
              MOVE ZEROES              TO COZ-SGV-MCAL IN COZ
              MOVE FIO-PUT TO FIO-CMND
              PERFORM CBZ-FIO-COZ
              IF NOT FIO-STAT-OKS
                 MOVE FIO-MENS TO FRM-MENS
                 PERFORM BCK-OUT.
       FIN-PUT-COZ-FLV.
           EXIT.
       LEE-COZ-FLV SECTION.
       INI-LEE-COZ-FLV.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ.
           MOVE ZEROES              TO COZ-NUM-ICAN IN COZ.
           MOVE SPACES              TO COZ-CIC-IOPV IN COZ.
           MOVE ZEROES              TO COZ-NUM-IVCT IN COZ.
           MOVE 'COM000'            TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
                    COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
                    COZ-NUM-ICAN IN COZ = ZEROES              AND
                    COZ-CIC-IOPV IN COZ = SPACES              AND
                    COZ-NUM-IVCT IN COZ = ZEROES              AND
                    COZ-IND-TTAS IN COZ = 'COM000' )
              MOVE '23' TO WSS-FIO-STAT-FLV
              GO TO FIN-LEE-COZ-FLV.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS 
              MOVE '23' TO WSS-FIO-STAT-FLV
              GO TO FIN-LEE-COZ-FLV.
           MOVE '00' TO WSS-FIO-STAT-FLV.
       FIN-LEE-COZ-FLV.
           EXIT.

       PUT-CYZ SECTION.
       INI-PUT-CYZ.
           IF CYZ-IND-TCYA IN OPZ-FLD NOT = 'M'
               PERFORM INI-REG-CYZ
               MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ
               MOVE ZEROES              TO CYZ-NUM-ICAN IN CYZ
               MOVE 1                   TO CYZ-NUM-ICYA IN CYZ
               MOVE OPZ-SGV-LIQU IN OPZ-FLD TO CYZ-SGV-LIQU IN CYZ
               MOVE FIO-PUT TO FIO-CMND
               PERFORM CBZ-FIO-CYZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-CYZ.
           EXIT.

       PUT-AUZ SECTION.
       INI-PUT-AUZ.
           IF AUZ-IIC-ICYA IN OPZ-FLD > ZEROES
               IF AUZ-CAI-ICYA IN OPZ-FLD > SPACES OR
                  AUZ-IIC-ICYA IN OPZ-FLD > ZEROES
               PERFORM INI-REG-AUZ
               MOVE OPZ-CIC-IOPC IN OPZ TO AUZ-CIC-IOPC IN AUZ
               MOVE 'AUT'               TO AUZ-NUM-ICAN IN AUZ
               MOVE 1                   TO AUZ-NUM-ICYA IN AUZ
               MOVE FIO-PUT TO FIO-CMND
               PERFORM CBZ-FIO-AUZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-AUZ.
           EXIT.

       PUT-ROZ SECTION.
       INI-PUT-ROZ.
           PERFORM BUS-CIC-RENO
           IF OPZ-IND-RENO IN OPZ = RNO-CIC-NOV IN RNO-VARI
               PERFORM INI-REG-ROZ
               MOVE OPZ-CIC-IOPC IN OPZ TO ROZ-CIC-IOPC IN ROZ
               MOVE CAZ-CAI-IOPC IN OPZ-FLD TO ROZ-CAI-IOPV IN ROZ
               MOVE CAZ-IIC-IOPC IN OPZ-FLD TO ROZ-IIC-IOPV IN ROZ
               MOVE CAZ-NUM-ICAN IN OPZ-FLD TO ROZ-NUM-IVCT IN ROZ
               PERFORM RET-ROZ-OPZ
               MOVE FIO-PUT TO FIO-CMND
               PERFORM CBZ-FIO-ROZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-ROZ.
           EXIT.

       MOD-RDZ SECTION.
       INI-MOD-RDZ.
           IF DBC-IND-ICLI IN OPZ-FLD = 'M'
               GO TO FIN-MOD-RDZ.
           IF WSS-MISMO-RDC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM CBZ-FIO-RDZ
           ELSE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM CBZ-FIO-RDZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-MOD-RDZ
               ELSE
                   PERFORM PUT-RDZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-MOD-RDZ.
       FIN-MOD-RDZ.
           EXIT.

       MOD-COZ SECTION.
       INI-MOD-COZ.
           IF PGM-STAT-COZ-OKS
               IF COZ-SGV-TINT IN OPZ-FLD > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF COZ-SGV-TINT IN OPZ-FLD > ZEROES
                   PERFORM PUT-COZ
                   GO TO CON-MOD-COZ
               ELSE
                   GO TO CON-MOD-COZ.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       CON-MOD-COZ.
           IF WSS-FIO-STAT-FLV = '00'
               PERFORM LEE-COZ-FLV.
           IF WSS-FIO-STAT-FLV = '00'
               IF FRM-SGV-TFLV IN OPZ-FLD > ZEROES
                   MOVE WSS-SGV-TCOM TO COZ-SGV-TINT IN COZ 
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF FRM-SGV-TFLV IN OPZ-FLD > ZEROES
                   PERFORM PUT-COZ-FLV
                   GO TO FIN-MOD-COZ
               ELSE
                   GO TO FIN-MOD-COZ.
           PERFORM CBZ-FIO-COZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-COZ.
           EXIT.

       MOD-CYZ SECTION.
       INI-MOD-CYZ.
           IF CYZ-IND-TCYA IN OPZ-FLD NOT = 'M'
               MOVE FIO-MOD TO FIO-CMND
               PERFORM CBZ-FIO-CYZ
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-MOD-CYZ.
           EXIT.

       MOD-AUZ SECTION.
       INI-MOD-AUZ.
           IF PGM-STAT-AUZ-OKS
               IF AUZ-CAI-ICYA IN OPZ-FLD > SPACES OR
                  AUZ-IIC-ICYA IN OPZ-FLD > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF AUZ-CAI-ICYA IN OPZ-FLD > SPACES OR
                  AUZ-IIC-ICYA IN OPZ-FLD > ZEROES
                   PERFORM PUT-AUZ
                   GO TO FIN-MOD-AUZ
               ELSE
                   GO TO FIN-MOD-AUZ.
           PERFORM CBZ-FIO-AUZ.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-AUZ.
           EXIT.

       MOD-ROZ SECTION.
       INI-MOD-ROZ.
           PERFORM BUS-CIC-RENO.
           IF OPZ-IND-RENO IN OPZ NOT = RNO-CIC-NOV IN RNO-VARI
               GO TO FIN-MOD-ROZ.
           IF PGM-STAT-ROZ-OKS
                PERFORM RET-ROZ-OPZ
                MOVE FIO-MOD TO FIO-CMND
                PERFORM CBZ-FIO-ROZ
                IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-MOD-ROZ.
           EXIT.

      *DELETE
      *======
       DEL-DLZ SECTION.
       INI-DEL-DLZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO DLZ-CIC-IOPC IN DLZ.
           MOVE ZEROES              TO DLZ-NUM-IDLC IN DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = DLZ-CIC-IOPC IN DLZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-DLZ.
       LUP-DEL-DLZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-DLZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-DLZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-DLZ.
           IF FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = DLZ-CIC-IOPC IN DLZ
               GO TO LUP-DEL-DLZ.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-DLZ.
           EXIT.

       DEL-VEZ SECTION.
       INI-DEL-VEZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO VEZ-CIC-IOPC IN VEZ.
           MOVE ZEROES              TO VEZ-NUM-IVEN IN VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT ( FIO-STAT-OKS AND
                    OPZ-CIC-IOPC IN OPZ = VEZ-CIC-IOPC IN VEZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-VEZ.
       LUP-DEL-VEZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-VEZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-VEZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-VEZ.
           IF FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = VEZ-CIC-IOPC IN VEZ
               GO TO LUP-DEL-VEZ.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-VEZ.
           EXIT.

       DEL-RDZ SECTION.
       INI-DEL-RDZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT ( FIO-STAT-OKS AND
                    RDZ-CIC-IOPC IN RDZ = OPZ-CIC-IOPC IN OPZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-RDZ.
       LUP-DEL-RDZ.
           MOVE 'RDZ-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-DEL        TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RDZ.
           MOVE 'RDZ-KEY-IDLC' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO RDZ-CIC-IOPC IN RDZ.
           MOVE ZEROES              TO RDZ-NUM-IDLC IN RDZ.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM CBZ-FIO-RDZ.
           IF FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = RDZ-CIC-IOPC IN RDZ
               GO TO LUP-DEL-RDZ.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-RDZ.
           EXIT.

       DEL-CYZ SECTION.
       INI-DEL-CYZ.
           MOVE OPZ-CIC-IOPC IN OPZ TO CYZ-CIC-IOPC IN CYZ.
           MOVE SPACES              TO CYZ-NUM-ICAN IN CYZ.
           MOVE ZEROES              TO CYZ-NUM-ICYA IN CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT ( FIO-STAT-OKS AND
                    CYZ-CIC-IOPC IN CYZ = OPZ-CIC-IOPC IN OPZ )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-CYZ.
       LUP-DEL-CYZ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-CYZ.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-CYZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-CYZ.
           IF FIO-STAT-OKS AND
              OPZ-CIC-IOPC IN OPZ = CYZ-CIC-IOPC IN CYZ
               GO TO LUP-DEL-CYZ.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-CYZ.
           EXIT.

       GET-CUR-COZ SECTION.
       INI-GET-CUR-COZ.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ.
           MOVE ZEROES              TO COZ-NUM-ICAN IN COZ.
           MOVE SPACES              TO COZ-CIC-IOPV IN COZ.
           MOVE ZEROES              TO COZ-NUM-IVCT IN COZ.
           MOVE 'COM000'            TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
                    COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
                    COZ-NUM-ICAN IN COZ = ZEROES              AND
                    COZ-CIC-IOPV IN COZ = SPACES              AND
                    COZ-NUM-IVCT IN COZ = ZEROES              AND
                    COZ-IND-TTAS IN COZ = 'COM000' )
               MOVE '23' TO WSS-FIO-STAT-FLV
               MOVE ZEROES TO WSS-SGV-TCOM
           ELSE
               MOVE '00' TO WSS-FIO-STAT-FLV
               MOVE COZ-SGV-TINT IN COZ TO WSS-SGV-TCOM.
           MOVE 'COZ-KEY-IICG' TO FIO-AKEY.
           MOVE OPZ-CIC-IOPC IN OPZ TO COZ-CIC-IOPC IN COZ.
           MOVE ZEROES              TO COZ-NUM-ICAN IN COZ.
           MOVE SPACES              TO COZ-CIC-IOPV IN COZ.
           MOVE ZEROES              TO COZ-NUM-IVCT IN COZ.
           MOVE 'COM   '            TO COZ-IND-TTAS IN COZ.
           MOVE ZEROES              TO COZ-FEC-FINI IN COZ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CBZ-FIO-COZ.
           IF NOT ( FIO-STAT-OKS AND
                    COZ-CIC-IOPC IN COZ = OPZ-CIC-IOPC IN OPZ AND
                    COZ-NUM-ICAN IN COZ = ZEROES              AND
                    COZ-CIC-IOPV IN COZ = SPACES              AND
                    COZ-NUM-IVCT IN COZ = ZEROES              AND
                    COZ-IND-TTAS IN COZ = 'COM   ' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COZ.
           EXIT.

      *PTC-INI:   12-NOV-1996 08:50:01 
      * COPY GNSBGTSK.
      *PTC-FIN:   12-NOV-1996 08:50:01 

       COPY CBZBFRDZ.
       COPY CBZBFROZ.
       COPY CBZBFPIZ.
       COPY CBZBFPCZ.
       COPY CBZBFCYZ.
       COPY CBZBFAUZ.
       COPY CBZBFCAZ.
       COPY CBZBFCOZ.
       COPY CBZBFDLZ.
       COPY CBZBFVEZ.
       COPY CBZBFPOZ.
       COPY GNSBBMSC.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBGPES.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBGCAM.
       COPY TABBVUSR.
       COPY TABBFCAM.
       COPY TABBFAHO.
       COPY SGCBFDBC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
       PRO-FLD-BCI SECTION.
       INI-PRO-FLD-BCI.
           MOVE 'CBZ' TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    PCOPC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF ( NOT FIO-STAT-OKS) OR
              TAB-IND-VIGE IN TAB = 'N' 
               MOVE FRM-CPIM-AEY TO OPZ-IND-RENO-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-VAL-GAST-ATR IN OPZ-FLD
               MOVE FRM-CPIM-AEY TO OPZ-SGV-LIQU-ATR IN OPZ-FLD.
       FIN-PRO-FLD-BCI.
           EXIT.

       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_PTC
           IF NOT SCR-OFRM-SRV
*% END
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       COPY CBZBGMPT.
       COPY CBZBGRNO.
      *>>>>
*% END
