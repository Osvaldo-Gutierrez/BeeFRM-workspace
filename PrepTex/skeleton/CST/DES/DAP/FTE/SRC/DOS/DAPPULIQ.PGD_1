       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DAPPULIQ.
       AUTHOR.       BEE.
       DATE-WRITTEN. 08-May-19 03:41 PM.

      * NOMBRE PROGRAMA                   DAPPULIQ
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      DAPLIQ
      * PANTALLA                          DAPLIQ
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<< CMT_ID
      * ===================================================
      *  MODIFICACIONES:
      *----------------------------------------------------
      *  AUTOR      : CIMA-ISP
      *  FECHA      : 2014-02-11
      *  ETIQUETA   : ISP-INI 11-FEB-2013 1311_08
      *  PROYECTO   : TOWER
      *  CAMBIOS    : CORRIGE REVERSA CON IMPACTO EN L-VIG
      *----------------------------------------------------
      * OBJETIVO: AGREGAR LOG DE NEGOCIO A COMANDO ELI
      * PROYECTO: CORRECCION DE INCIDENTES DAP GRUPO 1 HITO 2
      * FECHA   : OCTUBRE DE 2014
      * AUTOR   : CIMA-OGB
      * ETIQUETA:
      *     *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
      *-----------------------------------------------------------------
      *>>>> CMT_ID

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DAPPULIQ-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DAPPULIQ$ SKL=$08.07.21$ VSN=$01-14$        
      -    'GEN=$08-May-19 03:41 PM$ FNC=$190305$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
      *JVM se agrega signo a campos de monto (31/03/92)
           02 SCR-CIC-CLI1              PIC X(12).
           02 SCR-CIC-CLI2              PIC X(12).
           02 SCR-SGV-VCAM              PIC 9(11)V9(04).
           02 SCR-IND-MCLI              PIC X(01).
           02 SCR-IND-MCAD              PIC X(01).
           02 SCR-CIC-VCAM.
              04 SCR-CIC-TVAL           PIC X(01).
              04 SCR-CIC-CVAL           PIC X(03).
              04 SCR-CIC-TCAM           PIC X(08).
           02 SCR-SGV-CAPI              PIC S9(11)V9(05).
           02 SCR-SGV-REAJ              PIC S9(11)V9(05).
           02 SCR-SON-S                 PIC X(01).
           02 SCR-SON-N                 PIC X(01).
           02 SCR-COD-GARA-N            PIC X(01).
           02 SCR-COD-CUST-E            PIC X(01).
           02 SCR-COD-OFIC              PIC X(03).
           02 SCR-SGV-MCAS              PIC S9(11)V9(05).

      * ISP-INI 11-feb-2013 1311_08
       COPY DAPBRLND.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LND-REQA==.
      * ISP-FIN 11-feb-2013 1311_08
      *>>>>
       COPY DAPWILIQ.
       COPY DAPBRLIQ.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIQ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSX.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS

       COPY USPC117.
       77  WSS-FRM-GLS-CAPI        PIC X(09).
       77  WSS-FRM-GLS-INTE        PIC X(09).
       77  WSS-FRM-GLS-SCAP        PIC X(17).
       77  WSS-FRM-GLS-SFIN        PIC X(17).
       77  WSS-FRM-GLS-KNEW        PIC X(16).
       77  WSS-FRM-GLS-IPAG-GA     PIC X(09).
       77  WSS-FRM-GLS-IPAG-PE     PIC X(09).
       77  WSS-FRM-GLS-FNEW        PIC X(16).
       77  WSS-FRM-GLS-INTD        PIC X(14).
       77  WSS-FRM-GLS-ACED-MD     PIC X(34).
       77  WSS-FRM-GLS-ACED-OF     PIC X(34).
       77  WSS-FRM-GLS-PEGA-PE     PIC X(13).
       77  WSS-FRM-GLS-PEGA-VP     PIC X(13).
       77  WSS-FRM-GLS-PEGA-GA     PIC X(13).

       77  WSS-TASA-CERO  VALUE 'N'      PIC X(01).
       77  WSS-VF-LVP-LRP VALUE  SPACES  PIC X(03).
       77  WSS-CAL-REAJ   VALUE SPACES   PIC X(03).

       01  WSS-GLS-FUNGI VALUE SPACES.
           03 WSS-GLS-FUNGI-VHBL         PIC X(01).
           03 WSS-GLS-FUNGI-CHOY         PIC X(01).
           03 WSS-GLS-FUNGI-FBLK         PIC X(01).

      *<<<< WSS
      *>>>>Registro MSG
      *
      *    Registro Generico de Mensajes
      *    -----------------------------
      *
      *    Nombre Registro : MSG
      *    Clave(s)        : MSG-COD-TABL(UU), MSG-STP-ITRN(UU),
      *                      MSG-CIC-TABL(UU), MSG-EXT-TABL(UU)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  MSG.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  MSG-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  MSG-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  MSG-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  MSG-COD-TTAB                     PIC X(03).
      *
      *            Codigo Mensaje
                   07  MSG-COD-MENS.
      *                Tipo Mensaje
                       09  MSG-COD-TMSG                 PIC X(07).
      *
      *                Codigo Mensaje
                       09  MSG-COD-CMSG                 PIC X(05).
      *
      *        Time Stamp Transaccion
               05  MSG-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  MSG-FEC-FTRN.
                       09  MSG-NUM-STRN                 PIC 9(02).
                       09  MSG-NUM-ATRN                 PIC 9(02).
                       09  MSG-NUM-MTRN                 PIC 9(02).
                       09  MSG-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  MSG-HRA-HRTR.
                       09  MSG-NUM-HHTR                 PIC 9(02).
                       09  MSG-NUM-MMTR                 PIC 9(02).
                       09  MSG-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  MSG-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  MSG-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  MSG-IND-VIGE  REDEFINES  MSG-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  MSG-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  MSG-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  MSG-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  MSG-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  MSG-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  MSG-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Mensaje
               05  MSG-CIC-MENS.
      *
      *            Tipo Mensaje
                   07  MSG-CIC-TMSG                     PIC X(07).
      *
      *            Codigo Mensaje
                   07  MSG-CIC-CMSG                     PIC X(05).
      *
      *    Codigo Externo
           03  MSG-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  MSG-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  MSG-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  MSG-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  MSG-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  MSG-GLS-DESC.
               05  MSG-GLS-DES1                         PIC X(20).
               05  MSG-GLS-DES2                         PIC X(20).
      *
      *    Datos Anexos
           03  MSG-GLS-DATA.
      *
      *        Glosa Mensaje
               05  MSG-GLS-MENS                         PIC X(40).
      *
      *        Disponible
               05  MSG-GLS-DISP                         PIC X(20).
      *
      *    Clave Soundex
           03  MSG-SNX-TABL.
               05  MSG-SNX-TTAB                         PIC X(03).
               05  MSG-SNX-MENS                         PIC X(03).
      *
      *    Variables de Mensajes
       01  MSG-VARI.
      *
      *    Nombre de Programa FIO para Mensajes
           03  MSG-GLS-FMSG.
      *
      *        Codigo Sistema
               05  MSG-COD-SIST                         PIC X(03).
      *
      *        Nombre 'fijo' de FIO Mensajes
               05  MSG-COD-FMSG           VALUE 'PFTAB' PIC X(05).
      *
      *    VARIABLES DE MENSAJES POR CANAL
       01  MSG-CNAL.
      *
           03  MSG-GLS-DACN.
      *
               05  MSG-COD-DAC1                         PIC X(57).
      *
               05  MSG-COD-DAC2                         PIC X(03).
      *
           03  MSG-GLS-CNAL.
      *
      *            FIJO CN
               05  MSG-COD-INDC                         PIC X(02).
      *            CI= CODIGO INEX   NI = NUMERO INVALIDO
      *            NV= CODIGO NOVIG  SPACES = SIN CLASIFICAR
               05  MSG-COD-SIDC                         PIC X(02).
      *
               05  MSG-COD-DEST                         PIC X(03).
      *
               05  MSG-COD-SISC                         PIC X(03).
      *
               05  MSG-COD-CODC                         PIC X(12).
               05  MSG-COD-CODC-RED REDEFINES MSG-COD-CODC.
                   07  MSG-COD-CODC-01                  PIC X(01).
                   07  MSG-COD-CODC-02                  PIC X(01).
                   07  MSG-COD-CODC-03                  PIC X(01).
                   07  MSG-COD-CODC-04                  PIC X(01).
                   07  MSG-COD-CODC-05                  PIC X(01).
                   07  MSG-COD-CODC-06                  PIC X(01).
                   07  MSG-COD-CODC-07                  PIC X(01).
                   07  MSG-COD-CODC-08                  PIC X(01).
                   07  MSG-COD-CODC-09                  PIC X(01).
                   07  MSG-COD-CODC-10                  PIC X(01).
                   07  MSG-COD-CODC-11                  PIC X(01).
                   07  MSG-COD-CODC-12                  PIC X(01).
      *
               05  MSG-GLS-CICF.
                   07 MSG-GLS-CICF-DESC.
                       09  MSG-GLS-CI01                 PIC X(03).
                       09  MSG-GLS-CI02                 PIC X(12).
                       09  MSG-GLS-CI03                 PIC X(03).
                       09  MSG-GLS-CI04                 PIC X(22).
      *
      *
               05  MSG-GLS-NVCF REDEFINES MSG-GLS-CICF.
                   07  MSG-GLS-NV01                     PIC X(03).
                   07  MSG-GLS-NV02                     PIC X(12).
                   07  MSG-GLS-NV03                     PIC X(03).
                   07  MSG-GLS-NV04                     PIC X(22).
      *
               05  MSG-GLS-NICF REDEFINES MSG-GLS-CICF.
                   07  MSG-GLS-NI04                     PIC X(40).

               05  MSG-GLS-CICF-DATA                    PIC X(60).
      *
           03  MSG-CNAL-RED REDEFINES MSG-GLS-CNAL.
               05 MSG-CNAL-RED-DESC                     PIC X(40).
               05 MSG-CNAL-RED-DATA                     PIC X(40).


      *Entidades de SGC
       COPY DAPWG006.
       COPY DAPWGVEN.
       COPY SGCBRDBC.
       COPY SGCBROPE.
       COPY SGCBRRCO.

      *Entidades de TAB
       COPY TABBRCAM.
       COPY TABBRVLR.

      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRDCL.
       COPY DAPBRTOD.
       COPY DAPBRCAD.
       COPY DAPBRVEN.
       COPY DAPBRRCC.
      * DAPR0021-INI(ISP)  1-FEB-2000
        COPY DAPWGCCL.
        COPY DAPBRCCL.
      * DAPR0021-FIN(ISP)  1-FEB-2000
       COPY DAPBRLIC.
       COPY DAPBRJNL.

      *Entidades de GNS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY GNSWGINT.
       COPY GNSWGTDQ.

       01  WSS-MSG VALUE SPACES.
           03 WSS-MSG-DESC                           PIC X(40).
           03 WSS-MSG-DATA                           PIC X(40).
      * MENSAJE LRP
       01  WSS-LRP-MSG VALUE SPACES.
           03  WSS-LRP-MSG-M01        PIC   -.---.---.--9,9999.
           03  WSS-LRP-MSG-M02        PIC X(10).
           03  WSS-LRP-MSG-M03        PIC   -.---.---.--9,9999.
           03  WSS-LRP-MSG-M04        PIC X(11).
           03  WSS-LRP-MSG-M05        PIC   -.---.---.--9,9999.
           03  WSS-LRP-MSG-M06        PIC X(04).

      * FUNCIONALIDAD LVP
       77  WSS-IND-TOD VALUE 'N'    PIC X(001).
       77  WSS-BKP-TOD VALUE SPACES PIC X(200).


       77  WSS-LVP-EDIT        PIC  -.--9,9999999999999.
      * PLAZO RESIDUAL
       77  WSS-NUM-PRES   VALUE ZEROES  COMP-3  PIC S9(03)V9(15).
      * PLAZO TOTAL
       77  WSS-NUM-PTOT VALUE ZEROES  COMP-3  PIC S9(04)V9(14).
      *
      * Valor pagado pesos movido desde informado en TPAG para LRP
       77  LRP-SGV-PESO  VALUE  ZEROES   PIC S9(11)V9(05).
      *
      * Valor pagado pesos movido desde informado en TPAG para LVP
       77  LVP-SGV-PESO  VALUE  ZEROES   PIC S9(11)V9(05).
      *
      * Valor pagado calculado para LRP
       77  LRP-SGV-TPAG       PIC S9(11)V9(05).
      *
      * Valor pagado calculado para LVP
       77  LVP-SGV-TPAG       PIC S9(11)V9(05).
      *
      * Diferencia de valores pagados (calculado/digitado) para LRP,LVP
       77  WSS-SGV-DIFE PIC S9(11)V9(05).
      *
      * Variable auxiliar para calculo intereses LVP
       77  WSS-FRM-SGV-INTE              PIC S9(11)V9(05).
      *
      * Tasa descuento para valor presente ( TIR )
      *
       77  WSS-SGV-TTDE   VALUE ZEROES  COMP-3  PIC S9(03)V9(15).
       77  WSS-SGV-TTDE-TEMP VALUE ZEROES COMP-3  PIC S9(03)V9(15).
      * BASE DE LA TASA ( 30, 360 )
       77  WSS-NUM-PBTI   VALUE ZEROES  COMP-3  PIC S9(03)V9(15).

       77  WSS-CAL-SLA-GMSG VALUE 'S'           PIC X(01).
       01  WSS-LVP-MSG.
           03  WSS-LVP-CSVC   VALUE SPACES PIC X(05).
           03  WSS-LVP-CCAM   VALUE SPACES PIC X(29).
           03  WSS-LVP-MENS   VALUE SPACES PIC X(45).

       01  WSS-VARI.
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
           03 WSS-OPD-CIC                            PIC X(12).
           03 WSS-RCC-MSC-STAT          VALUE   ' '        PIC X(01).
           03 WSS-CONSTANTES.
              05 WSS-CT-CAN       VALUE 'CAN'        PIC X(03).
              05 WSS-CT-S         VALUE   'S'        PIC X(01).
              05 WSS-CT-N         VALUE   'N'        PIC X(01).
              05 WSS-IND-GRCC     VALUE   'N'        PIC X(01).
              05 WSS-RCC-MSC-STAT-VIG   VALUE   ' '        PIC X(01).
              05 WSS-RCC-MSC-STAT-CAN   VALUE   'X'        PIC X(01).
      *BEE-FIN-NGA-12-AGO-2013 TRANSACCIONES LENTAS
           03 WSS-NUM-IVEN        VALUE ZEROES       PIC 9(03).
           03 WSS-OPD-CAI-ISER                       PIC 9(04).
           03 PGM-STAT-RCC           VALUE '23'      PIC X(02).
              88 PGM-STAT-RCC-OKS    VALUE '00'.
              88 PGM-STAT-RCC-NUL    VALUE '  '.
           03 PGM-STAT-LIC           VALUE '23'      PIC X(02).
              88 PGM-STAT-LIC-OKS    VALUE '00'.
              88 PGM-STAT-LIC-NUL    VALUE '  '.
      *    cantidad de operaciones vigentes de un cliente
           03 WSS-OPDV                            PIC 9(04).
           03 WSS-IND-CTA                         PIC X(01).
      *       ind cta mismo u otro cliente
           03 WSS-IND-MUOC                        PIC X(01).
      * GRUPO AL QUE PERTENECE TIPO DE CARGO ABONO
      * CAJA, AUTOMATICO O MANUAL.
           03 WSS-IND-GCAD                        PIC X(01).

      *    VAR-VRF-CAD
           03 WSS-TOT-CAJA  VALUE ZEROES          PIC 9(02).
           03 WSS-TOT-AUTO  VALUE ZEROES          PIC 9(02).
           03 WSS-TOT-MANU  VALUE ZEROES          PIC 9(02).
           03 WSS-VAL-CAPT                        PIC 9(11)V9(04).
           03 WSS-VAL-CAJA                        PIC 9(11)V9(04).
           03 WSS-VAL-CCTE                        PIC 9(11)V9(04).
           03 WSS-CIC-ICAD                        PIC X(12).
           03 WSS-IND-TCTA                        PIC X(03).
      *       ind validacion de cliente
           03 WSS-IND-VCLI                        PIC X(01).

      *       numero de dias de liquidacion anticipada
           03 WSS-NUM-NDSLA                       PIC 9(05).
      *       CIC DEL CODIGO DE RESCATE
      * OFICINA PARA LNK-DDT
           03 WSS-NUM-OFIC                        PIC 9(03).
           03 WSS-OPD-CIC-RESC                    PIC X(12).
           03 WSS-OPD-CIC-PLPA                    PIC X(12).
           03 WSS-SGV-RESC                        PIC S9(11)V9(05).
           03 WSS-SGV-INTE                        PIC S9(11)V9(05).
           03 WSS-SGV-FINA-CVP                    PIC S9(11)V9(05).
           03 WSS-SGV-INTE-CVP                    PIC S9(11)V9(05).

      *JVM: 22/09/92 variable de control en SLA-INTE
           03 WSS-CON-INTE                        PIC 9(01).
      *JVM: 22/09/92
           03 WSS-SGV-INTE-PESO                   PIC S9(11)V9(05).
           03 WSS-SGV-CAPI                        PIC S9(11)V9(05).
           03 WSS-SGV-CAPI-PESO                   PIC S9(11)V9(05).
           03 WSS-SGV-REAJ                        PIC S9(11)V9(05).
           03 WSS-SGV-REAJ-1                      PIC S9(11)V9(05).
           03 WSS-SGV-REAJ-2                      PIC S9(11)V9(05).
           03 WSS-SGV-TPAG-PESO                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA CAPTACION ( COMANDO LIQ)
           03 WSS-SGV-VCAM-CAP                    PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA LIQUIDACION ( COMANDO LIQ)
           03 WSS-SGV-VCAM-LIQ                    PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA SOLICITUD ANTICIPADA
           03 WSS-SGV-VCAM-FSLA                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA CAPTACION
           03 WSS-SGV-VCAM-FCAP                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA VENCIMIENTO
           03 WSS-SGV-VCAM-FVEN                   PIC S9(11)V9(05).
      * ISP: INDICADOR FECHA SLA: ANTES O A PARTIR DE FCAP + PERIODO
      * PLAZO PAGO
           03 WSS-IND-FEC-RESC  VALUE SPACES      PIC X(01).
              88 ANTES-FECHA-RESCATE              VALUE 'S'.
           03 WSS-FEC-FUNO.
              05 WSS-NUM-SUNO                     PIC 9(02).
              05 WSS-NUM-AUNO                     PIC 9(02).
              05 WSS-NUM-MUNO                     PIC 9(02).
              05 WSS-NUM-DUNO                     PIC 9(02).

           03 WSS-FEC-FDOS.
              05 WSS-NUM-SDOS                     PIC 9(02).
              05 WSS-NUM-ADOS                     PIC 9(02).
              05 WSS-NUM-MDOS                     PIC 9(02).
              05 WSS-NUM-DDOS                     PIC 9(02).

           03 WSS-CIC-PER                         PIC X(01).
           03 WSS-NUM-PER                         PIC 9(05).

           03 WSS-ENT-UBFD.
              05  WSS-TBL-UBFD                     PIC X(03).
              05  WSS-COD-UBFD                     PIC X(06).

      * TOTAL DIAS NO HABILES
           03  WSS-NUM-TDNH         VALUE ZEROES     PIC 9(03).
      * TOTAL DIAS HABILES
           03  WSS-NUM-TDH          VALUE ZEROES     PIC 9(03).
      *       numero de dias de renovacion automatica
           03 WSS-NUM-NDREA                          PIC 9(05).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FHOY.
               05  WSS-NUM-SHOY                      PIC 9(02).
               05  WSS-NUM-AHOY                      PIC 9(02).
               05  WSS-NUM-MHOY                      PIC 9(02).
               05  WSS-NUM-DHOY                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-CPT-NOMB VALUE SPACES.
               05  WSS-CPT-DESC                    PIC X(40).
               05  WSS-CPT-CAI                     PIC X(04).
               05  WSS-CPT-IIC                     PIC X(08).
               05  WSS-GLS-DATA                    PIC X(28).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(80).
           03  WSS-LIC-SGV-TPAG COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-LIQ-SGV-FINA COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-LIQ-NUM-TLIQ COMP-3 VALUE ZEROES PIC S9(03).
           03  WSS-PF12             VALUE 'S'       PIC  X(01).
      *JVM: 22/09/92
           03 WSS-NUM-PNTE                  PIC 9(05).
      *JVM:
      *ADA-INI 05-JUL-2002
           03 WSS-LIQ-STAT                  PIC X(01).
      *ADA-FIN 05-JUL-2002
      *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
           03 WSS-CT-LIQ      VALUE 'LIQ'           PIC X(03). 
           03 WSS-CT-KIOP     VALUE 'RCC-KEY-IOPD'  PIC X(12).
           03 WSS-CT-L23      VALUE '23'            PIC X(02).
      *CIMA-FIN/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
      * DAPR0021-INI(ISP)  1-FEB-2000
       01  WSS-NUM-TERM                            PIC 9(04).
      * DAPR0021-FIN(ISP)  1-FEB-2000
      *>>>> WSS
        77  WSS-VAL-EDITT     PIC ZZZ.ZZZ.ZZZ.ZZ9,9999.
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-JNL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIC-REQA==.
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPD.
                 88 PGM-STAT-OPD-NUL    VALUE '  '.
                 07 PGM-STT1-OPD        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPD-OKS VALUE '0'.
                 07 PGM-STT2-OPD        VALUE '3' PIC X(01).
              05 PGM-STAT-LIQ.
                 88 PGM-STAT-LIQ-NUL    VALUE '  '.
                 07 PGM-STT1-LIQ        VALUE '2' PIC X(01).
                    88 PGM-STAT-LIQ-OKS VALUE '0'.
                 07 PGM-STT2-LIQ        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-CAD.
                 88 PGM-STAT-CAD-NUL    VALUE '  '.
                 07 PGM-STT1-CAD        VALUE '2' PIC X(01).
                    88 PGM-STAT-CAD-OKS VALUE '0'.
                 07 PGM-STT2-CAD        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
              05 PGM-STAT-DCL.
                 88 PGM-STAT-DCL-NUL    VALUE '  '.
                 07 PGM-STT1-DCL        VALUE '2' PIC X(01).
                    88 PGM-STAT-DCL-OKS VALUE '0'.
                 07 PGM-STT2-DCL        VALUE '3' PIC X(01).
   *<<<<FIN_PGM_STAT
   *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(750).
      * DAPR0021-INI(ISP)  1-FEB-2000
      *<<<< BLLCELLS
       COPY DAPLGCCL.
      *>>>> BLLCELLS
      * DAPR0021-FIN(ISP)  1-FEB-2000

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO LIQ-FLD.
           MOVE LOW-VALUES TO LIQ-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +750 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DAPPULIQ' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<<<INI_FIO AND NOT PGM_VSI
       PERFORM GNS-HDL-VSM.
      *<<<< INI_FIO
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      * DAPR0021-INI(ISP)  1-FEB-2000                                   
           MOVE SPACES TO MSG.
      * DAPR0021-FIN(ISP)  1-FEB-2000
           PERFORM CLR-REG-CAD.
           PERFORM CLR-REG-JNL.
           PERFORM CLR-REG-LIC.
           PERFORM CLR-REG-LIQ.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
            IF SCR-DESDE-CMN OR
              FRM-FFLD = FRM-FFLD-PF12

                MOVE 1 TO SCR-SGV-VCAM
                MOVE ZEROES TO SCR-SGV-CAPI
                               SCR-SGV-REAJ.
           MOVE 'DAP' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'FUNGI' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-FUNGI.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSCAPI' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-CAPI.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSINTE' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-INTE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSSCAP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-SCAP.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSSFIN' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-SFIN.


           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSKNEW' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-KNEW.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSIPAG+' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-IPAG-GA.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSIPAG-' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-IPAG-PE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSFNEW' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-FNEW.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSINTD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-INTD.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSACEDMD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-ACED-MD.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSACEDOF' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-ACED-OF.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA-' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-PE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA0' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-VP.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA+' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-GA.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-LIQ.
           PERFORM EDT-KEY-LIQ.
           PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-LIQ
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-LIQ
               PERFORM EDT-KEY-LIQ
           ELSE
               PERFORM CLR-FLD-LIQ
               PERFORM EDT-FLD-LIQ.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO LIQ-FLD.
           MOVE LOW-VALUES TO LIQ-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
      *ADA-INI 03-JUL-2002
           IF SCR-CMND = 'MCA'
               MOVE LIQ-CAI-IOPD IN LIQ-FLD TO CAD-CAI-IOPD IN CAD
               MOVE LIQ-IIC-IOPD IN LIQ-FLD TO CAD-IIC-IOPD IN CAD
               MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO CAD-NUM-ILIQ IN CAD
               MOVE 1                       TO CAD-NUM-ICAD IN CAD
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM DAP-FIO-CAD
               IF FIO-STAT-OKS
                   MOVE CAD-IND-TCAD IN LIQ-FLD TO CAD-IND-TCAD IN CAD
                   MOVE CAD-CAI-ICAD IN LIQ-FLD TO CAD-CAI-ICAD IN CAD
                   MOVE CAD-IIC-ICAD IN LIQ-FLD TO CAD-IIC-ICAD IN CAD
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM DAP-FIO-CAD
                   IF NOT FIO-STAT-OKS
                       MOVE FIO-MENS TO FRM-MENS
                       PERFORM BCK-OUT
                       GO TO FIN-CMN-MOD
                   ELSE
                       PERFORM VER-PRO-LIC
                       IF MSG-COD-MENS > SPACES
                           PERFORM BCK-OUT
                           MOVE 'DAP' TO MSG-COD-SIST
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           GO TO FIN-CMN-MOD
                       ELSE
                           MOVE 'DAP' TO MSG-COD-SIST
                           MOVE 'LIQMCA OK' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           GO TO FIN-CMN-MOD
               ELSE
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LIQNOGKUPD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE LIQ-KEY-ILIQ IN LIQ TO FRM-MEN2
                   GO TO FIN-CMN-MOD.
      *ADA-FIN 03-JUL-2002
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.

           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO LIQ-CAI-IOPD IN LIQ.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO LIQ-IIC-IOPD IN LIQ.
           MOVE ZEROES TO LIQ-NUM-ILIQ IN LIQ.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-CMN-MOD.
           PERFORM DAP-FIO-LIQ.
           IF NOT ( FIO-STAT-OKS AND
                    LIQ-CIC-IOPD IN LIQ = OPD-CIC-IOPD IN OPD )
                     MOVE 'DAP' TO MSG-COD-SIST
                     MOVE 'LIQPAG OKS' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE '00' TO FIO-STAT
                     GO TO FIN-CMN-MOD.

           IF LIQ-COD-STAT IN LIQ NOT = 'T'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-CMN-MOD.

           MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
           MOVE SPACES              TO CAD-NUM-ICAD IN CAD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT ( FIO-STAT-OKS AND
                    CAD-CIC-IOPD IN CAD = LIQ-CIC-IOPD IN LIQ )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-CMN-MOD.
           MOVE 'TAB'  TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CAD-IND-TCAD IN CAD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.

           IF ( SCR-CIC-TVAL = PDB-CIC-MNAC AND
                SCR-CIC-VCAM NOT = PDB-CIC-0999 ) AND
                  LIQ-SGV-PESO IN LIQ = ZEROES
                  PERFORM VCAM-LIQ
                  IF MSG-COD-MENS > SPACES
                     MOVE 'DAP' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE '00' TO FIO-STAT
                     GO TO FIN-CMN-MOD
                  ELSE
                     MULTIPLY WSS-SGV-VCAM-LIQ BY LIQ-SGV-TPAG IN LIQ
                       GIVING LIQ-SGV-PESO IN LIQ ROUNDED
                       MOVE   LIQ-SGV-PESO IN LIQ TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO LIQ-SGV-PESO IN LIQ
                       PERFORM VCAM-CAP
                        IF MSG-COD-MENS > SPACES
                            MOVE 'DAP' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            MOVE '00' TO FIO-STAT
                            GO TO FIN-CMN-MOD
                        ELSE
                            SUBTRACT WSS-SGV-VCAM-CAP FROM
                                     WSS-SGV-VCAM-LIQ GIVING
                                     WSS-SGV-REAJ-1

                            MULTIPLY WSS-SGV-REAJ-1 BY
                               LIQ-SGV-TPAG IN LIQ
                               GIVING LIQ-SGV-REAJ IN LIQ ROUNDED
                            IF OPD-COD-VCAM IN OPD = '0993  '
                                MOVE ZEROES TO LIQ-SGV-REAJ IN LIQ
                            END-IF

                            MOVE LIQ-SGV-REAJ IN LIQ TO PES-SGV-DECI
                            PERFORM PES-SCTV
                            MOVE PES-SGV-ENTE TO LIQ-SGV-REAJ IN LIQ.

           IF MSC-CIC-MSCL IN MSC = 'TCYACAJA'
               MOVE 'S' TO LIQ-COD-STAT IN LIQ
           ELSE
               MOVE 'A' TO LIQ-COD-STAT IN LIQ.

      *ADA-INI 03-JUL-2002
           IF MSC-CIC-MSCL = 'TCYACTBL'
               PERFORM GET-ENT
               PERFORM FND-KEY-CAD
               IF WSS-TOT-MANU = 1 AND
                  SCR-IND-MCAD NOT = 'M'
                   PERFORM PRO-SLD
                   IF MSG-COD-MENS > SPACES
                       MOVE 'DAP' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       PERFORM BCK-OUT
                       GO TO FIN-CMN-MOD
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LIQCTBLUNO>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-CMN-MOD
           ELSE
      *ADA-FIN 03-JUL-2002

           IF MSC-CIC-MSCL IN MSC = 'TCYACAJA'
               PERFORM PRO-LIC-LIQ
           ELSE
               PERFORM GET-ENT
               PERFORM FND-KEY-CAD
      * DAPR0021-INI(ISP)  1-FEB-2000
               PERFORM LNK-CCL
               MOVE TWA-COD-RETR TO LIQ-GLS-DISP IN LIQ
               IF TWA-COD-RETR NOT = '00'
                    MOVE 'CCTE   '    TO CCL-COD-TMSG
                    MOVE TWA-COD-RETR TO CCL-COD-CMSG
                    MOVE CCL-COD-MENS TO MSG-COD-MENS IN MSG
                    MOVE 'DAP' TO MSG-COD-SIST
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    GO TO FIN-CMN-MOD
               ELSE
                   PERFORM PRO-SLD.
      * DAPR0021-FIN(ISP)  1-FEB-2000

      *ADA-INI JSS 04-JUL-2002
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO LIQ-STP-ITRN.
           MOVE SCR-USER     TO LIQ-COD-ATRN.
      *ADA-FIN JSS 04-JUL-2002
      *ADA-INI JSS 11-JUN-2004
           IF NOT SCR-OFRM-SRV
               IF SCR-CMND = 'LSI' OR 'MCA'
                   MOVE 'T' TO LIQ-COD-CNAL IN LIQ
               ELSE
                   MOVE 'C' TO LIQ-COD-CNAL IN LIQ
           ELSE
               MOVE 'S' TO LIQ-COD-CNAL IN LIQ.
      *ADA-FIN JSS 11-JUN-2004

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-CMN-MOD.
      *>>>>
           PERFORM KEY-ALL-LIQ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS AND
              LIQ-STP-ITRN IN LIQ NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< CMN_MOD_RET
      *     PERFORM FND-KEY-CAD.
      *     PERFORM GET-UPD-CAD.
      *     IF PGM-STAT-CAD-OKS
      *         PERFORM RET-CAD-LIQ
      *         PERFORM MOD-CAD
      *         IF NOT FIO-STAT-OKS
      *             GO TO FIN-CMN-MOD.
      *>>>>
           PERFORM RET-ALL-LIQ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO LIQ.
      *<<<< INI_CMN_ING
           PERFORM CLR-REG-LIQ.
           MOVE 0 TO LIQ-SGV-MCAS
                     LIQ-SGV-TLVP IN LIQ.
           IF SCR-CMND = 'CVP' OR 'CRP'
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CVP    OKS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-CMN-ING.
      *>>>> INI_CMN_ING
           PERFORM RET-ALL-LIQ.
      *<<<< CMN_ING

           PERFORM GET-ENT.

           MOVE 1 TO LIQ-NUM-TLIQ IN LIQ.
           MOVE SCR-SGV-CAPI TO LIQ-SGV-CAPI IN LIQ.
           MOVE SCR-SGV-REAJ TO LIQ-SGV-REAJ IN LIQ.

           MOVE 'CAPI' TO QUE-COLA.
           MOVE SCR-SGV-CAPI TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE +20 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'REAJ' TO QUE-COLA.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE +20 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF OPD-COD-VCAM IN OPD = '0993  '
                 MOVE ZEROES TO LIQ-SGV-REAJ IN LIQ.

           MOVE SCR-SGV-MCAS TO LIQ-SGV-MCAS IN LIQ.

           PERFORM PUT-CAD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.

           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'

               PERFORM GET-FHOY
               MOVE HOY-FHOY TO LIQ-FEC-FTRN IN LIQ
               MOVE HOY-HHOY TO LIQ-HRA-HRTR IN LIQ
               MOVE 'RC' TO LIQ-COD-LIQU IN LIQ
               IF SCR-CMND = 'LRP'
                    MOVE 'RP' TO LIQ-COD-LIQU IN LIQ
               END-IF
               IF LIQ-FEC-FCMP IN LIQ NOT = LIQ-FEC-FREA IN LIQ AND
                  WSS-GLS-FUNGI NOT > SPACES

                   MOVE 'FECFCMP' TO QUE-COLA
                   MOVE LIQ-FEC-FCMP IN LIQ TO QUE-ITEM
                   MOVE QUE-PUT TO QUE-CMND
                   MOVE +12 TO QUE-LITM
      *            PERFORM GNX-PRO-QUE

                   MOVE 'FECFREA' TO QUE-COLA
                   MOVE LIQ-FEC-FREA IN LIQ TO QUE-ITEM
                   MOVE QUE-PUT TO QUE-CMND
                   MOVE +12 TO QUE-LITM
      *            PERFORM GNX-PRO-QUE

                   MOVE LIQ-FEC-FREA IN LIQ TO LIQ-FEC-FCMP IN LIQ
      *             MOVE VEN-NUM-DVEN IN LIQ-FLD TO LIQ-NUM-DCTB IN LIQ
      *             MOVE VEN-NUM-MVEN IN LIQ-FLD TO LIQ-NUM-MCTB IN LIQ
      *             MOVE VEN-NUM-SVEN IN LIQ-FLD TO LIQ-NUM-SCTB IN LIQ
      *             MOVE VEN-NUM-AVEN IN LIQ-FLD TO LIQ-NUM-ACTB IN LIQ
                   MOVE 'P' TO LIQ-COD-STAT IN LIQ
               ELSE
                   PERFORM FND-KEY-CAD
                   PERFORM PRO-LIQ
                   IF MSG-COD-MENS > SPACES
      *ADA-INI 24-JUL-2002
                       MOVE 'DAP' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
      *ADA-FIN 24-JUL-2002
                       PERFORM BCK-OUT
                       GO TO FIN-CMN-ING.
           MOVE SPACES TO DCL.
           PERFORM RET-DCL-LIQ.
           MOVE HOY-FHOY TO DCL-FEC-FTRN IN DCL.
           MOVE HOY-HHOY TO DCL-HRA-HRTR IN DCL.
           MOVE LIQ-CIC-IOPD IN LIQ TO DCL-CIC-IOPD IN DCL.
           MOVE LIQ-NUM-ILIQ IN LIQ TO DCL-NUM-ILIQ IN DCL.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-DCL.


           IF SCR-CMND = 'SLA'
               MOVE 'S'  TO LIQ-COD-CMND IN LIQ
           ELSE
           IF SCR-CMND = 'LVP' OR 'LRP'
               MOVE 'L'  TO LIQ-COD-CMND IN LIQ.

      *ADA-INI JSS 03-JUL-2002
      **    IF SCR-CMND = 'LIQ'
      *     IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 03-JUL-2002
      *         MOVE 'LT' TO LIQ-COD-LIQU IN LIQ
      *         PERFORM FND-KEY-CAD
      *         PERFORM PRO-LIQ
      *         IF MSG-COD-MENS > SPACES
      *            GO TO FIN-CMN-ING.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      * ISP-INI 11-feb-2013 1311_08
           PERFORM PRO-LND.
      * ISP-FIN 11-feb-2013 1311_08
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-LIQ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS AND
              LIQ-STP-ITRN IN LIQ NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-LIQ.
      *<<<< CMN_ACC
      *ADA-INI JSS 03-JUL-2002
      *    IF SCR-CMND = 'LIQ'
           IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 03-JUL-2002

               MOVE 'A' TO LIQ-COD-STAT IN LIQ.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS
               MOVE 'ACLIQOK' TO MSG-COD-TMSG
               MOVE LIQ-COD-STAT IN LIQ TO MSG-COD-CMSG
           ELSE
               MOVE 'ACLIQER' TO MSG-COD-TMSG
               MOVE LIQ-COD-STAT IN LIQ TO MSG-COD-CMSG.

           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-LIQ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS AND
              LIQ-STP-ITRN IN LIQ NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-LIQ
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< CMN_ELI

           PERFORM GET-ENT.

           PERFORM FND-KEY-CAD.
           PERFORM GET-UPD-CAD.

           PERFORM GET-UPD-DCL.

           IF SCR-CMND = 'REV'
              IF WSS-TOT-CAJA = 1
                   PERFORM PRO-LIC
                   IF MSG-COD-MENS NOT > SPACES
                       PERFORM PRO-SLD
                   ELSE
                       GO TO FIN-CMN-ELI
              ELSE
              IF WSS-TOT-MANU = 1
                   PERFORM PRO-SLD.
          *ADA-INI 04-JUL-2002
           IF ( SCR-CMND = 'REV' AND
                OPD-COD-CUST IN OPD     = SCR-COD-CUST-E AND
                CAD-IND-TCAD IN LIQ-FLD = 'CTBL' AND
                LIQ-COD-STAT IN LIQ-FLD = 'A'
               )
                         AND
               LIQ-COD-LIQU IN LIQ NOT = 'RP'
                 MOVE 'T' TO LIQ-COD-STAT IN LIQ
                 MOVE FIO-MOD TO FIO-CMND
                 PERFORM DAP-FIO-LIQ
                 IF FIO-STAT-OKS
                     MOVE 'DAP'        TO MSG-COD-SIST
                     MOVE 'LIQREV OKS' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     GO TO FIN-CMN-ELI
                 ELSE
                     MOVE 'DAP'        TO MSG-COD-SIST
                     MOVE 'LIQREV ERR' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MEN1
                     MOVE FIO-MENS     TO FRM-MEN2
                     PERFORM BCK-OUT
                     GO TO FIN-CMN-ELI.
      *ADA-FIN 04-JUL-2002

          *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF PGM-STAT-CAD-OKS
               PERFORM DEL-CAD
               IF NOT FIO-STAT-OKS
                  GO TO FIN-CMN-ELI.
           IF PGM-STAT-DCL-OKS
               PERFORM DEL-DCL
               IF NOT FIO-STAT-OKS
                  GO TO FIN-CMN-ELI.

           IF FIO-STAT-OKS
               PERFORM PRO-JNL.

      * ISP-INI 11-feb-2013 1311_08
           PERFORM PRO-LND.
      * ISP-FIN 11-feb-2013 1311_08

      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-LIQ.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
   *<<<<INI_SCR_EXIT
           MOVE 'REAJEXIT' TO QUE-COLA.
           MOVE SCR-SGV-REAJ TO WSS-VAL-EDIT.
           MOVE WSS-VAL-EDIT TO QUE-ITEM.
           MOVE +20 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
   *>>>>
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *<<<< INI_SCR_PUTA
           IF SCR-NEMO = 'DAPACTLIR' OR
              SCR-OFRM-SRV
                MOVE WSS-FRM-GLS-CAPI TO FRM-GLS-CAPI
                MOVE WSS-FRM-GLS-INTE TO FRM-GLS-INTE
                MOVE WSS-FRM-GLS-SCAP TO FRM-GLS-SCAP
                MOVE WSS-FRM-GLS-SFIN TO FRM-GLS-SFIN
                MOVE WSS-FRM-GLS-KNEW TO FRM-GLS-KNEW
                MOVE WSS-FRM-GLS-FNEW TO FRM-GLS-FNEW
                MOVE WSS-FRM-GLS-INTD TO FRM-GLS-INTD
                MOVE WSS-FRM-GLS-ACED-MD TO FRM-GLS-ACED
           ELSE
                MOVE SPACES TO FRM-GLS-CAPI IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-INTE IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-SCAP IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-SFIN IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-KNEW IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-FNEW IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-INTD IN LIQ-FLD
                MOVE SPACES TO LIQ-SGV-CAPI-ALF
                MOVE SPACES TO FRM-SGV-INTE-ALF
                MOVE SPACES TO OPD-VAL-SCAP-ALF
                MOVE SPACES TO VEN-VAL-SFIN-ALF
                MOVE SPACES TO DCL-SGV-KNEW-ALF
                MOVE SPACES TO FRM-SGV-IPAG-ALF
                MOVE SPACES TO DCL-SGV-FNEW-ALF
                MOVE SPACES TO DCL-SGV-INTD-ALF
                MOVE SPACES TO DCL-SGV-PEGA-ALF
                MOVE WSS-FRM-GLS-ACED-OF TO FRM-GLS-ACED.
      *>>>> INI_SCR_PUTA
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE LIQ-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO LIQ-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-LIQ
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
      *<<<< SCR_GFLD_VAL_FLD
      * OBTIENE FECHA DEL DIA PARA VALIDACIONES
           PERFORM GET-FHOY.
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
            MOVE LIQ-CAI-IOPD IN LIQ-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.

      *ISP ES NECESARIO TENER LOS DATOS DEL VENCIMIENTO
      *    PARA LA VALIDACION DE CAMPOS
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO VEN-CAI-IOPD IN VEN.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO VEN-IIC-IOPD IN VEN.
           MOVE 1                       TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.

           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *>>>>
           PERFORM VAL-FLD-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-LIQ.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-LIQ.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LIQ.
           PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LIQ-GLS-MEN2
               MOVE SCR-PRMT     TO LIQ-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-LIQ
               PERFORM VAL-NUM-FLD-LIQ.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LIQ-GLS-MEN2
               MOVE SCR-PRMT     TO LIQ-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO LIQ-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LIQ-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LIQ-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-LIQ

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LIQ-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LIQ-GLS-MENS.
           PERFORM PRO-FLD-LIQ.
           PERFORM PRO-MKY-LIQ.
           PERFORM UNP-IKY-LIQ.
           PERFORM FST-KEY-LIQ.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LIQ-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LIQ-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LIQ-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LIQ-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-LIQ.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-LIQ.
           PERFORM FST-KEY-LIQ.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-LIQ.
           PERFORM UNP-FLD-LIQ.
           PERFORM FST-FLD-LIQ.
      *<<<< FIN_HBL_FLD
           MOVE FRM-CPIM-AEY TO LIQ-COD-OFIC-ATR IN LIQ-FLD.
           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-LIQ
               PERFORM UNP-CAD-LIQ.
      *>>>> FIN_HBL_FLD
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO LIQ-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-LIQ.
           PERFORM PRO-FLD-LIQ.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
      *<<<< FIN_SCR_TRL
           PERFORM GET-FHOY.
      * JVM: Inicio 24/06/92
      *     IF MSG-COD-MENS > SPACES
      *        GO TO ERR-SCR-TRL.
      * JVM: Fin
           MOVE SPACES TO MSG-COD-MENS.

           IF PGM-STAT-OPD-OKS
           IF OPD-COD-IONP IN OPD = 'S' AND
              WSS-PF12 = 'N'
      *        opd con onp
               MOVE 'OPD    ONP' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

           IF PGM-STAT-OPD-OKS
           IF OPD-COD-GARA IN OPD NOT = SCR-COD-GARA-N AND
              WSS-PF12 = 'N'
      *        opd con garantia
               MOVE 'OPD    GAR' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.
      *
           IF PGM-STAT-OPD-OKS
           IF OPD-COD-CUST IN OPD = SCR-COD-CUST-E AND
              WSS-PF12 = 'N'
      *        opd con custodia electronica
      *ADA-INI JSS 03-JUL-2002
      *Permite liquidar en custodia electronica con comando LSI
               IF SCR-CMND = 'LSI'
                   NEXT SENTENCE
               ELSE
               IF SCR-CMND = 'CVP' OR
                             'CRP'
                  NEXT SENTENCE
               ELSE
      *Permite modificar liquidaciones en custodia electronica en
      *estado T con comando MCA
               IF SCR-CMND = 'MCA'  AND LIQ-COD-STAT IN LIQ = 'T'
                   NEXT SENTENCE
               ELSE
      *Permite reversar en custodia electronica a las
      *liquidaciones contables, en estado A y de DAP fijos
               IF SCR-CMND = 'REV' AND
                  CAD-IND-TCAD IN LIQ-FLD = 'CTBL' AND
                  LIQ-COD-STAT IN LIQ     = 'A'    AND
                  OPD-COD-RENO IN OPD NOT = 'S'
                   NEXT SENTENCE
               ELSE
      *ADA-FIN JSS 03-JUL-2002
               IF SCR-CNAL NOT = '110' AND
                  SCR-CNAL NOT = '100'

               MOVE 'LIQSLAERRCUE' TO MSG-COD-MENS
               PERFORM VRF-PRV-CUST-E
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-SCR-TRL.

      *ADA-INI JSS 03-JUL-2002
      *Valida que comando LSI solo sea ocupado para custodia electronica
      *para liquidaciones en estado 'T', operaciones fijas,
      *en estado L, situacion contable VCD y liq con abono Contable
           IF WSS-PF12 = 'N'
           IF SCR-CMND = 'LSI' AND
              ( OPD-COD-CUST IN OPD     NOT = SCR-COD-CUST-E OR
                LIQ-COD-STAT IN LIQ-FLD NOT = 'T'            OR
                OPD-COD-RENO IN OPD         = 'S'            OR
                OPD-COD-STAT IN OPD     NOT = 'L'            OR
                OPD-COD-SCTB IN OPD     NOT = 'VCD'          OR
                CAD-IND-TCAD IN LIQ-FLD NOT = 'CTBL' )
                MOVE 'LSIETFLVCDCB' TO MSG-COD-MENS


               GO TO ERR-SCR-TRL.
      *Valida que comando MCA solo sea ocupado en custodia electronica
      *para liquidaciones en estado 'T', operaciones fijas,
      *en estado L y situacion contable VCD
           IF WSS-PF12 = 'N'
           IF SCR-CMND = 'MCA' AND
              ( OPD-COD-CUST IN OPD     NOT = SCR-COD-CUST-E OR
                LIQ-COD-STAT IN LIQ-FLD NOT = 'T'            OR
                OPD-COD-RENO IN OPD         = 'S'            OR
                OPD-COD-STAT IN OPD     NOT = 'L'            OR
                OPD-COD-SCTB IN OPD     NOT = 'VCD' )
               MOVE 'MCAETFLVCD  ' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.
      *ADA-FIN JSS 03-JUL-2002

      *
      *JUS-INI 6-NOV-1995
      *ISI-INI  27-MAY-1996 17:00:32
      *     IF PGM-STAT-OPD-OKS
      *     IF OPD-COD-CUST IN OPD = 'S' AND
      *        WSS-PF12 = 'N'
      **        opd con custodia
      *         MOVE 'OPD   CUST' TO MSG-COD-MENS
      *         GO TO ERR-SCR-TRL.
      *JUS-FIN

      *     IF NOT ( OPD-COD-STAT IN OPD = 'G' OR 'A' )
      *        OPD CON STATUS INVALIDO
      *         MOVE 'OPD    NE' TO MSG-COD-MENS
      *         GO TO ERR-SCR-TRL.

           IF NOT PGM-STAT-LIQ-OKS
               GO TO END-SCR-TRL.

           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
               IF NOT ( HOY-SHOY = LIQ-NUM-STRN IN LIQ AND
                        HOY-AHOY = LIQ-NUM-ATRN IN LIQ AND
                        HOY-MHOY = LIQ-NUM-MTRN IN LIQ AND
                        HOY-DHOY = LIQ-NUM-DTRN IN LIQ )
      *  'REV'ERSA NO ES DEL DIA
                       MOVE 'REVNOHOY' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.

           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
                  IF WSS-TOT-AUTO = 1
      *               LIQ con cargo automatico
                       MOVE 'LIQREV AUTO' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL
                  ELSE
                  IF WSS-TOT-CAJA = 1 AND
                     LIQ-COD-STAT IN LIQ NOT = 'S'
      *                LIQ no 'S'
                       MOVE 'LIQ    NS' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.

           IF SCR-CMND = 'ELI' AND
              WSS-PF12 = 'N' AND
              LIQ-COD-STAT IN LIQ NOT = 'P'
      *        LIQ no 'P'
               MOVE 'LIQ    NP' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

      *ADA-INI JSS 03-JUL-2002
      *    IF SCR-CMND = 'LIQ' AND
           IF ( SCR-CMND = 'LIQ' OR 'LSI' ) AND
      *ADA-FIN JSS 03-JUL-2002
              WSS-PF12 = 'N' AND
              LIQ-COD-STAT IN LIQ NOT = 'T'
      *        LIQ no 'T'
               MOVE 'LIQ    NT' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

       ERR-SCR-TRL.
           IF MSG-COD-MENS > SPACES
      *IMV-INI 24-OCT-2013 PENTA              
               MOVE 'S' TO SCR-IERR
      *IMV-FIN 24-OCT-2013 PENTA 
           
      *GET-MSG Busca mensaje en tabla
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.

       END-SCR-TRL.
      *>>>>
      *>>>>
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LIQ.
           PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-LIQ.
           PERFORM PRO-FLD-LIQ.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LIQ-GLS-MEN2
               MOVE SCR-CONF     TO LIQ-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-LIQ
               PERFORM VAL-NUM-FLD-LIQ
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-LIQ
                   PERFORM VAL-NUM-FLD-LIQ
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY DAPBULIQ.
       COPY GNSBVNUM.
       COPY DAPBFLIQ.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSX.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
        COPY TABBVOFI.
        COPY TABBVUSR.

        VRF-PRV-CUST-E SECTION.
       INI-VRF-PRV-CUST-E.
           IF SCR-OFRM-SRV
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               MOVE 'DAPPULIQ/CUE'    TO USP-STRING
               MOVE WSS-IDN-SIST      TO USP-SISTEMA
               MOVE SPACES            TO USP-PERMISO
               MOVE 'DAP'             TO USP-GRUPO
               MOVE SCR-USER          TO USP-USUARIO
               PERFORM USPC107
               IF USP-PERMISO = 'P'
                   MOVE SPACES TO MSG-COD-MENS.
       FIN-VRF-PRV-CUST-E.
           EXIT.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
      *     PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
       COPY DAPBCCAD.
       COPY DAPBCJNL.
       COPY DAPBCLIC.
       COPY DAPBCLIQ.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFDCL.
       COPY DAPBFTOD.
       COPY DAPBFCAD.
       COPY DAPBFVEN.
       COPY DAPBFRCC.
       COPY DAPBFLIC.
       COPY DAPBFJNL.

      *Entidades de GNS
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBGINT.
      *<<<< PGM_PU
      * DAPR0021-INI(ISP)  1-FEB-2000
      * Link al Disparador de Transacciones
      * GRABAR TD PARA Disparador de Transacciones
       LNK-CCL SECTION.
       INI-LNK-CCL.

      *INI-PENTA TUXEDO ORACLE
      *    EXEC CICS ADDRESS
      *          TWA(ADDRESS OF TWA-CCL)
      *    END-EXEC.
           MOVE '00' TO TWA-COD-RETR.
           MOVE SPACES TO CCL.

           MOVE SPACES TO MSG-COD-MENS.


           MOVE 'DAP' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'LNKCCLOPD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               IF TAB-GLS-ABRV IN TAB = 'DESAR'
                MOVE '00' TO TWA-COD-RETR
                GO TO FIN-LNK-CCL.

           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               IF TAB-GLS-ABRV IN TAB = 'CCOLD'
                MOVE '00' TO TWA-COD-RETR
                GO TO SIG-LNK-CCL.


            IF SCR-OFRM-SRV AND
                ( SCR-CNAL = '100' OR
                  SCR-CNAL = '110' )
                MOVE '00' TO TWA-COD-RETR
                GO TO FIN-LNK-CCL.

       SIG-LNK-CCL.

      *     MOVE '00' TO TWA-COD-RETR.
      *     GO TO FIN-LNK-CCL.



      *    Codigo De Transaccion De Cargo
      *                                     MVO-COD-TRN-CAR(MVO-BCI)
           MOVE SPACES                   TO CCL-COD-TRCR IN CCL.

      *    Indicador Orden Proceso Movimiento
      *                                     MVO-IND-ORD-PRC(MVO-BCI)
           MOVE '4'                      TO CCL-IND-OPMV IN CCL.

           MOVE OPD-COD-OFIC IN OPD TO WSS-NUM-OFIC.
           ADD 1100 WSS-NUM-OFIC GIVING WSS-NUM-TERM.
      *    Identificacion Terminal Fisico
      *                         MVO-TML(MVO-BCI)
           MOVE WSS-NUM-TERM TO CCL-COD-TERM IN CCL.
      * ASI LO HACE EL SISTEMA COL
      *     MOVE OPD-COD-OFIC IN OPD TO CCL-OFIC.
      *     CALL 'RCTU2120' USING DFHEIBLK DFHCOMMAREA CCL-LINK.
      *     MOVE CCL-TERM            TO CCL-COD-TERM IN CCL.

      *    Indicador Llave Supervisor Transaccion de Cargo
      *                MVO-IND-SVS-CAR(MVO-BCI)
           MOVE 'N' TO CCL-IND-KESC IN CCL.

      *    Indicador Modo tarde
      *                 MVO-IND-MOD-TDE(MVO-BCI)
      *DAD INI 21-08-02 SE LIMPIA INDICADOR MODO TARDE
      *     MOVE '1' TO CCL-IND-MTRD IN CCL.
            MOVE SPACE TO CCL-IND-MTRD IN CCL.
      *DAD FIN 21-08-02

      *    Codigo Operacion de Cargo
      *                         MVO-COP-CAR(MVO-BCI)
           MOVE SPACES TO CCL-CIC-OPCR IN CCL.

      *    Serial Documento de Cargo
      *                    MVO-SRL-CAR(MVO-BCI)
            MOVE SPACES TO CCL-COD-SDCR IN CCL.
      *                    MVO-GLS-CAR-1(MVO-BCI)
            MOVE SPACES TO CCL-GLS-TCR1 IN CCL.

      *    Valor del Movimiento
      *                         MVO-VAL(MVO-BCI)
      *ADA-INI JSS 03-JUL-2002
      *    IF SCR-CMND = 'LIQ'
           IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 03-JUL-2002
               IF LIQ-SGV-PESO IN LIQ > ZEROES
                   MOVE LIQ-SGV-PESO IN LIQ TO CCL-SGV-VCCL IN CCL
               ELSE
                   MOVE LIQ-SGV-TPAG IN LIQ TO CCL-SGV-VCCL IN CCL
           ELSE
               IF LIQ-SGV-PESO IN LIQ-FLD > ZEROES
                   MOVE LIQ-SGV-PESO IN LIQ-FLD TO CCL-SGV-VCCL IN CCL
               ELSE
                   MOVE LIQ-SGV-TPAG IN LIQ-FLD TO CCL-SGV-VCCL IN CCL.

      *    Codigo de Transaccion de Abono
      *                    MVO-COD-TRN-ABO(MVO-BCI)
           MOVE '0770 ' TO CCL-COD-TRAB IN CCL.

      *    Indicador Llave Supervisor Transaccion Abono
      *                MVO-IND-SVS-ABO(MVO-BCI)
           MOVE 'N' TO CCL-IND-KESA IN CCL.

      *    Codigo Operacion de Abono
      *                         MVO-COP-ABO(MVO-BCI)
           MOVE WSS-CIC-ICAD TO CCL-CIC-OPAB IN CCL.

      *    Serial Documento Abono
      *                                MVO-SRL-ABO(MVO-BCI)
      *RVM-ADA-INI 26.11.2001
      *    MOVE OPD-CIC-IOPD IN OPD TO CCL-COD-SDAB IN CCL.
           MOVE '00000000005E' TO CCL-COD-SDAB IN CCL.
      *RVM-ADA-FIN 26.11.2001

      *    Glosa uno Transaccion Abono
      *                   MVO-GLS-ABO-1(MVO-BCI)
           MOVE SPACES TO CCL-GLS-TAB1 IN CCL.

      *    Numero Unico Operacion
      *                   MVO-NUO(MVO-BCI)
           MOVE SPACES TO CCL-CIC-NUOP IN CCL.

      *    Tipo Usuario Autorizador Movimiento
      *                   MVO-COD-TUS(MVO-BCI)
           MOVE SPACES TO CCL-COD-TAUT IN CCL.

      * no se requieren mas datos, fecha de proceso, mvo-orig ??

           MOVE CCL                 TO TWA-CCL.

      *    Indicador Orden Proceso Movimiento
           MOVE CCL-IND-OPMV IN CCL TO TWA-IND-OPMV.
           MOVE SPACES   TO SYS-CMMA.
           MOVE +0       TO SYS-TCMA.
           MOVE CCL-PROG TO SYS-PROG.
           MOVE SYS-LINK TO SYS-CMND.
      * PTC-INI-AUT
      *    IF NOT SCR-OFRM-SRV
      * PTC-FIN-AUT
           PERFORM GNS-PRO-SYS.
       FIN-LNK-CCL.
           EXIT.
      * DAPR0021-FIN(ISP)  1-FEB-2000

      * COPY GNSBGTDQ.
      *Modulo Generico Manejo de Transient Data
      * Le falta el accesar transient datas de otros CICS
      *GNS-CHK-TDQ SECTION.
      *INI-GNS-CHK-TDQ.
      *    MOVE TDQ-GET TO TDQ-CMND.
      *    PERFORM GNS-PRO-TDQ.
      *FIN-GNS-CHK-TDQ.
      *    EXIT.

      **************************************************************

      *GNS-ERR-TDQ SECTION.
      *INI-GNS-ERR-TDQ.
      *    EXEC CICS HANDLE CONDITION
      *              IOERR     (GNS-TDQ-IOE)
      *              LENGERR   (GNS-TDQ-LEN)
      *              NOSPACE   (GNS-TDQ-NOS)
      *              NOTOPEN   (GNS-TDQ-NOT)
      *              QIDERR    (GNS-TDQ-QID)
      *              QZERO     (GNS-TDQ-QZE)
      *    END-EXEC.
      *FIN-GNS-ERR-TDQ.
      *    EXIT.

      *GNS-TDQ-IOE.
      *    MOVE 'IOERR EN TRANSIENT DATA ' TO FRM-MEN1.
      *    MOVE TDQ-COLA TO FRM-MEN2.
      *    GO TO TDQ-ERR-ABT.

      *GNS-TDQ-LEN.
      *    MOVE 'ERROR DE LARGO EN TRANSIENT DATA ' TO FRM-MEN1.
      *    MOVE TDQ-COLA TO FRM-MEN2.
      *    GO TO TDQ-ERR-ABT.

      *GNS-TDQ-NOS.
      *    MOVE 'ERROR DE ESPACIO EN TRANSIENT DATA ' TO FRM-MEN1.
      *    MOVE TDQ-COLA TO FRM-MEN2.
      *    GO TO TDQ-ERR-ABT.

      *GNS-TDQ-NOT.
      *    MOVE 'ERROR : TRANSIENT DATA NO ABIERTA ' TO FRM-MEN1.
      *    MOVE TDQ-COLA TO FRM-MEN2.
      *    GO TO TDQ-ERR-ABT.

      *GNS-TDQ-QID.
      *    MOVE 'NO EXISTE TRANSIENT DATA ' TO FRM-MEN1.
      *    MOVE TDQ-COLA TO FRM-MEN2.
      *    GO TO TDQ-ERR-ABT.

      *GNS-TDQ-QZE.
      *    MOVE TDQ-STAT-QZE TO TDQ-STAT.
      *    GO TO FIN-GNS-PRO-TDQ.

      *TDQ-ERR-ABT.
      *    MOVE 'GNSPPABT' TO SYS-PROG.
      *    MOVE +79        TO SYS-TCMA.
      *    MOVE FRM-MENS   TO SYS-CMMA.
      *    EXEC CICS XCTL
      *              PROGRAM(SYS-PROG)
      *              COMMAREA(SYS-MENS)
      *              LENGTH(SYS-TCMA)
      *    END-EXEC.

      *GNS-PRO-TDQ SECTION.
      *INI-GNS-PRO-TDQ.
      *    MOVE TDQ-STAT-OKS TO TDQ-STAT.
      *    IF TDQ-CMND = TDQ-PUT
      *        GO TO GNS-PUT-TDQ
      *    ELSE
      *    IF TDQ-CMND = TDQ-GET
      *        GO TO GNS-GET-TDQ
      *    ELSE
      *    IF TDQ-CMND = TDQ-DEL
      *        GO TO GNS-DEL-TDQ.
      *    MOVE 'Comando invalido :' TO TDQ-MEN1.
      *    MOVE TDQ-CMND             TO TDQ-MEN2.
      *    EXEC CICS XCTL
      *              PROGRAM('GNSPPABT')
      *              COMMAREA(TDQ-MENS)
      *              LENGTH(+79)
      *    END-EXEC.

      *GNS-PUT-TDQ.
      *    EXEC CICS WRITEQ TD
      *              QUEUE(TDQ-COLA)
      *              FROM(TDQ-ITEM)
      *              LENGTH(TDQ-LITM)
      *    END-EXEC.
      *       MOVE QUE-CMND TO QUE-COM-SEND
      *       MOVE SPACES   TO QUE-NAM-SEND
      *       MOVE QUE-COLA TO QUE-NAM-SEND
      *       MOVE ZEROES   TO QUE-NUM-SEND
      *       MOVE QUE-LITM TO QUE-LAR-SEND
      *       MOVE SPACES   TO QUE-TRX-SEND
      *       MOVE QUE-ITEM TO QUE-DAT-SEND
      *       PERFORM GNS-MSJ-QUE
      *FIN-GNS-PUT-TDQ.
      *    GO TO FIN-GNS-PRO-TDQ.

      *GNS-GET-TDQ.
      *    EXEC CICS READQ TD
      *              QUEUE(TDQ-COLA)
      *              INTO(TDQ-ITEM)
      *              LENGTH(TDQ-LITM)
      *    END-EXEC.
      *FIN-GNS-GET-TDQ.
      *    GO TO FIN-GNS-PRO-TDQ.

      *GNS-DEL-TDQ.
      *    EXEC CICS DELETEQ TD
      *              QUEUE(TDQ-COLA)
      *    END-EXEC.
      *FIN-GNS-DEL-TDQ.
      *    GO TO FIN-GNS-PRO-TDQ.

      *FIN-GNS-PRO-TDQ.
      *    EXIT.
      *FIN-PENTA TUXEDO ORACLE

       COPY GNSBVCOD.
       COPY GNSBVTAB.

      *Entidades de TAB
       COPY TABBFCAM.

      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       CAL-SGV-TPAG SECTION.
       INI-CAL-SGV-TPAG.
      * VALOR DE LIC EN PESOS
      *     MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
      *     MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
      *     MOVE VEN-NUM-DVEN IN VEN TO TAB-NUM-DTRN IN TAB.
      *     MOVE VEN-NUM-MVEN IN VEN TO TAB-NUM-MTRN IN TAB.
      *     MOVE VEN-NUM-SVEN IN VEN TO TAB-NUM-STRN IN TAB.
      *     MOVE VEN-NUM-AVEN IN VEN TO TAB-NUM-ATRN IN TAB.
      *     PERFORM GET-VCAM.
      *     IF MSG-COD-MENS NOT = SPACES
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         GO TO FIN-CAL-SGV-TPAG.

       FIN-CAL-SGV-TPAG.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'DAP' TO FIO-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       GET-SER-OPD SECTION.
       INI-GET-SER-OPD.
      * ISP: FND-KEY YA PUSO LAS LLAVES DEL SERIAL EN OPD
      * ISP: ASUME OPERACION NO ENCONTRADA
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'OPD-CIC-ISER' TO FIO-AKEY.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'OPD    NEX' TO MSG-COD-MENS
           ELSE
              IF SCR-CMND = 'SLA' OR
                 SCR-CMND = 'LVP' OR
                 SCR-CMND = 'CVP' OR
                 SCR-CMND = 'LRP' OR
                 SCR-CMND = 'CRP'
                  IF OPD-COD-STAT IN OPD = 'G'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ
                  ELSE
                      IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                          MOVE 'OPDYALIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
              IF SCR-CMND = 'REV'
                  IF OPD-COD-STAT IN OPD = 'L'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ
                  ELSE
                      IF OPD-VAL-SCAP IN OPD > ZEROES
                         MOVE 'OPDNOLIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
      * ISP : OPD EXISTENTE PARA EL RESTO DE LOS COMANDOS
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ.
       FIN-GET-SER-OPD.
           EXIT.

       GET-FRM-OPD SECTION.
       INI-GET-FRM-OPD.
      * ISP: OBTIENE OPD DESDE LA PANTALLA
           MOVE SPACES TO MSG-COD-MENS.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO OPD-IIC-IOPD IN OPD.
           PERFORM GET-OPD.
           IF FIO-STAT-OKS
              IF SCR-CMND = 'SLA' OR
                 SCR-CMND = 'LVP' OR
                 SCR-CMND = 'CVP' OR
                 SCR-CMND = 'LRP' OR
                 SCR-CMND = 'CRP'
                  IF OPD-COD-STAT IN OPD = 'G'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE SPACES TO MSG-COD-MENS
                  ELSE
                      IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                          MOVE 'OPDYALIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
              IF SCR-CMND = 'REV'
                  IF OPD-COD-STAT IN OPD = 'L'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE SPACES TO MSG-COD-MENS
                  ELSE
                      IF OPD-VAL-SCAP IN OPD > ZEROES
                         MOVE 'OPDNOLIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'E'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
      * ISP : OPD EXISTENTE PARA EL RESTO DE LOS COMANDOS
                      MOVE SPACES TO MSG-COD-MENS
           ELSE
              IF SCR-CMND = 'REV'
                  MOVE 'LIQ    NEX' TO MSG-COD-MENS.
       FIN-GET-FRM-OPD.
           EXIT.

       GET-OPD SECTION.
       INI-GET-OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
                 MOVE 'OPD    NEX' TO MSG-COD-MENS.
           MOVE FIO-STAT TO PGM-STAT-OPD.
       FIN-GET-OPD.
           EXIT.

       GET-CUR-CAD SECTION.
       INI-GET-CUR-CAD.
           MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
           MOVE 1                   TO CAD-NUM-ICAD IN CAD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           MOVE FIO-STAT TO PGM-STAT-CAD.
       FIN-GET-CUR-CAD.
           EXIT.

       GET-UPD-CAD SECTION.
       INI-GET-UPD-CAD.
      *     IF CAD-IND-TCAD IN LIQ-FLD = 'M'
      *         GO TO FIN-GET-UPD-CAD.
      *     MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
      *     MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
      *     MOVE 1                   TO CAD-NUM-ICAD IN CAD.
      * LEE DE UPDATE REGISTRO CAD YA SELECCIONADO POR FND-KEY-CAD
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-CAD
      *    como la transaccion Termina no es necesario hacer UNLOCK de
      *    CAD
      *    comunicar que no se pudo actualizar con mensaje pertinente
           ELSE
               MOVE '00' TO PGM-STAT-CAD.
       FIN-GET-UPD-CAD.
           EXIT.

       GET-UPD-DCL SECTION.
       INI-GET-UPD-DCL.
           MOVE LIQ-KEY-ILIQ IN LIQ TO DCL-KEY-ILIQ IN DCL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-DCL.
           MOVE FIO-STAT TO PGM-STAT-DCL.
       FIN-GET-UPD-DCL.
           EXIT.
           
       GET-FEC-FTER SECTION.
       INI-GET-FEC-FTER.
      * OBTIENE FECHA DE TERMINO COM OPD-FEC-FTER + EL TOTAL DE DIAS
      * HABILES PARA LIQUIDAR (PARAMETRO = NDREA)

           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'DAP'   TO TAB-COD-SIST.
           MOVE 'REA'   TO TAB-COD-TTAB IN TAB.
           MOVE 'NDREA' TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
              MOVE 'NDREANEX' TO MSG-COD-MENS
              GO TO FIN-GET-FEC-FTER
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO NUM-NUME
              MOVE NUM-ZERO-N TO NUM-ZERO
              MOVE NUM-SGNO-N TO NUM-SGNO
              MOVE 5 TO NUM-NENT
              MOVE 0 TO NUM-NDCM
              PERFORM VAL-NUM
              IF NUM-STAT-OKS
                 MOVE NUM-NN9N TO WSS-NUM-NDREA
              ELSE
                 MOVE 'NDREANONUM' TO MSG-COD-MENS
                 GO TO FIN-GET-FEC-FTER.

           MOVE OPD-NUM-DTER IN OPD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE OPD-NUM-MTER IN OPD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE OPD-NUM-STER IN OPD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE OPD-NUM-ATER IN OPD TO WSS-NUM-AINI IN WSS-VARI.

      * BUS-PRIMER-DIA-HABIL
           MOVE 0 TO WSS-NUM-TDH.
           MOVE 0 TO WSS-NUM-TDNH.
           MOVE WSS-FEC-FINI TO FEC-FECH.
       BUS-PDH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           ADD 1 TO WSS-NUM-TDNH.
           IF FEC-STAT-HBL
              ADD 1 TO WSS-NUM-TDH
              IF WSS-NUM-TDH = WSS-NUM-NDREA
                 GO TO NOT-BUS-PDH.
           GO TO BUS-PDH.

       NOT-BUS-PDH.
           IF WSS-NUM-TDH > ZEROES
               MOVE WSS-FEC-FINI        TO FEC-FECH
               MOVE FEC-FORM-FEC        TO FEC-FORM
               MOVE FEC-SUM-DIA         TO FEC-CMND
               MOVE WSS-NUM-TDNH        TO FEC-NDIA
               PERFORM CAL-FEC
               MOVE FEC-FECH TO WSS-FEC-FINI.
       FIN-GET-FEC-FTER.
           EXIT.

       FND-KEY-CAD SECTION.
       INI-FND-KEY-CAD.
           MOVE ZEROES TO WSS-TOT-MANU.
           MOVE ZEROES TO WSS-TOT-CAJA.
           MOVE ZEROES TO WSS-TOT-AUTO.
           MOVE ZEROES TO WSS-VAL-CAPT.
           MOVE ZEROES TO WSS-VAL-CAJA.
           MOVE ZEROES TO WSS-VAL-CCTE.
           MOVE SPACES TO WSS-CIC-ICAD.
           MOVE SPACES TO WSS-IND-TCTA.

           PERFORM FST-CAD-CAD.
           PERFORM DAP-FIO-CAD.
           IF NOT ( FIO-STAT-OKS AND
              LIQ-CAI-IOPD IN LIQ-FLD = CAD-CAI-IOPD IN CAD AND
              LIQ-IIC-IOPD IN LIQ-FLD = CAD-IIC-IOPD IN CAD AND
              LIQ-NUM-ILIQ IN LIQ-FLD = CAD-NUM-ILIQ IN CAD )
               MOVE FIO-STAT TO PGM-STAT-CAD
               GO TO FIN-FND-KEY-CAD.

       LUP-FND-KEY-CAD.
      *    sumatoria de montos cargos  ( para vrf )
           ADD  CAD-SGV-LIQU IN CAD TO WSS-VAL-CAPT.

      *BUS-MSC busca miscelaneo en tabla
           MOVE 'TAB'  TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CAD-IND-TCAD IN CAD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-COD-DAT2 IN MSC(5) TO WSS-IND-GCAD.
           IF WSS-IND-GCAD = 'M'
      *        incrementa contador cargos 'manuales' (maximo 1)
               ADD 1 TO WSS-TOT-MANU.
           IF WSS-IND-GCAD = 'A'
      *        incrementa contador cargos 'automaticos' (maximo 1)
               ADD 1 TO WSS-TOT-AUTO
      *        monto de cargo automatico
               MOVE CAD-SGV-LIQU IN CAD TO WSS-VAL-CCTE.

           IF MSC-CIC-MSCL IN MSC = 'TCYACAJA'
      *        incrementa contador cargos 'caja' (maximo 1)
               ADD 1 TO WSS-TOT-CAJA
      *        monto a enterar en 'caja'
      *         MOVE CAD-SGV-LIQU IN CAD TO WSS-VAL-CAJA
           ELSE
           IF ( MSC-CIC-MSCL IN MSC = 'TCYACC'  OR
                MSC-CIC-MSCL IN MSC = 'TCYACA' ) AND
              WSS-IND-GCAD = 'A'
      *        cuenta cte de cargo
               MOVE CAD-CIC-ICAD IN CAD TO WSS-CIC-ICAD
               IF MSC-CIC-MSCL IN MSC = 'TCYACC'
      *           informa que es cta cte
                  MOVE 'CCT' TO WSS-IND-TCTA
               ELSE
      *           informa que es cta aho
                  MOVE 'AHO' TO WSS-IND-TCTA.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF FIO-STAT-OKS AND
              ( LIQ-CAI-IOPD IN LIQ-FLD = CAD-CAI-IOPD IN CAD AND
                LIQ-IIC-IOPD IN LIQ-FLD = CAD-IIC-IOPD IN CAD AND
                LIQ-NUM-ILIQ IN LIQ-FLD = CAD-NUM-ILIQ IN CAD )
               MOVE 'M' TO SCR-IND-MCAD
               GO TO LUP-FND-KEY-CAD.
       FIN-LUP-FND-KEY-CAD.

           IF SCR-IND-MCAD NOT = 'M'
               PERFORM FST-CAD-CAD
               PERFORM DAP-FIO-CAD.

           MOVE FIO-STAT TO PGM-STAT-CAD.
       FIN-FND-KEY-CAD.
           EXIT.

       FST-CAD-CAD SECTION.
       INI-FST-CAD-CAD.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO CAD-CAI-IOPD IN CAD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO CAD-IIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO CAD-NUM-ILIQ IN CAD.
           MOVE SPACES                  TO CAD-NUM-ICAD IN CAD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       FIN-FST-CAD-CAD.
           EXIT.
       USPC107 SECTION.
       INI-USPC107.
      *    COPY USPC107.

      *********************************************
      *           MODULO   USPC107                *
      *********************************************
      *     PARRAFO DE LLAMADA RUTINA USDR107     *
      *********************************************
      *INI-PENTA 19-07-2013
      *
      *    EXEC CICS LINK PROGRAM('USDR107')
      *                   COMMAREA (USP-VARIABLES)
      *                   LENGTH(31)
      *    END-EXEC.
      *FIN-PENTA
      *
      *********************************************
      *           FIN   MODULO   USPC107          *
      *********************************************

       FIN-USPC107.
           EXIT.
      *>>>>
      *<<<< EOF_PU

       SET-SCTB SECTION.
       INI-SET-SCTB.
           IF LIQ-FEC-FCMP IN LIQ-FLD = LIQ-FEC-FREA IN LIQ-FLD
      *                         AND
      *        OPD-COD-RENO IN OPD = 'S'
               IF WSS-TOT-AUTO = 1 OR
                  WSS-TOT-MANU = 1
                    MOVE 'CAN' TO OPD-COD-SCTB IN OPD
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
                    MOVE WSS-RCC-MSC-STAT-CAN TO WSS-RCC-MSC-STAT
                    MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
               ELSE
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
                    MOVE WSS-RCC-MSC-STAT-VIG TO WSS-RCC-MSC-STAT
                    MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS

                    MOVE 'VCD' TO OPD-COD-SCTB IN OPD.
       FIN-SET-SCTB.
           EXIT.

       VCAM-LIQ SECTION.
       INI-VCAM-LIQ.
      * VALOR DE CAMBIO A LA FECHA DE LIQUIDACION
           MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE LIQ-NUM-DREA IN LIQ TO TAB-NUM-DTRN IN TAB.
           MOVE LIQ-NUM-MREA IN LIQ TO TAB-NUM-MTRN IN TAB.
           MOVE LIQ-NUM-SREA IN LIQ TO TAB-NUM-STRN IN TAB.
           MOVE LIQ-NUM-AREA IN LIQ TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-LIQ
           ELSE
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-VCAM-LIQ.
           EXIT.

       VCAM-CAP SECTION.
       INI-VCAM-CAP.
      * VALOR DE CAMBIO A LA FECHA DE LIQUIDACION
           MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE OPD-NUM-DREA IN OPD TO TAB-NUM-DTRN IN TAB.
           MOVE OPD-NUM-MREA IN OPD TO TAB-NUM-MTRN IN TAB.
           MOVE OPD-NUM-SREA IN OPD TO TAB-NUM-STRN IN TAB.
           MOVE OPD-NUM-AREA IN OPD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-CAP
           ELSE
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-VCAM-CAP.
           EXIT.

       GET-ENT SECTION.
       INI-GET-ENT.
           MOVE LIQ-CIC-IOPD IN LIQ TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPDSELENEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-GET-ENT.

           MOVE LIQ-CIC-IOPD IN LIQ TO VEN-CIC-IOPD IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
                MOVE 'DAP' TO MSG-COD-SIST
                MOVE 'VENSELENEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-GET-ENT.
       FIN-GET-ENT.
           EXIT.

       PRO-LIC SECTION.
       INI-PRO-LIC.
           MOVE LIQ-SGV-TPAG IN LIQ TO WSS-LIC-SGV-TPAG.
           MOVE OPD-CIC-ISER IN OPD TO LIC-CIC-ISER IN LIC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIC.
           MOVE FIO-STAT TO PGM-STAT-LIC.
           IF SCR-CMND = 'REV'
               IF NOT PGM-STAT-LIC-OKS
      *        Error NO EXISTE LIC A REVERSAR
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LIC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-PRO-LIC
               ELSE
      *        Error LIC CON ESTADO INVALIDO
               IF LIC-COD-STAT NOT = 'S'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LICSTATERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-PRO-LIC.
      *          ELSE
      *             MOVE FIO-DEL TO FIO-CMND
      *             PERFORM DAP-FIO-LIC
      *             IF NOT FIO-STAT-OKS
      ** Error inconsistencia en el ingreso : hacer LOGTB e informar
      *                MOVE FIO-MENS TO FRM-MENS
      *                PERFORM BCK-OUT
      *                GO TO FIN-PRO-LIC
      *             ELSE
      *                GO TO FIN-PRO-LIC.

      *           PERFORM CAL-SGV-TPAG.

           IF SCR-CIC-TVAL = PDB-CIC-MNAC
               MOVE LIQ-SGV-PESO IN LIQ-FLD TO WSS-LIC-SGV-TPAG
           ELSE
               MOVE LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LIC-SGV-TPAG.

           IF SCR-CMND = 'REV'
               SUBTRACT WSS-LIC-SGV-TPAG FROM ZEROES
                        GIVING WSS-LIC-SGV-TPAG.

           IF NOT PGM-STAT-LIC-OKS
              MOVE WSS-LIC-SGV-TPAG        TO LIC-SGV-TPAG IN LIC

              MOVE SPACES                  TO LIC-GLS-FLAG IN LIC
              MOVE ZEROES                  TO LIC-FEC-FLIQ IN LIC
              MOVE 'S'                     TO LIC-COD-STAT IN LIC
              MOVE LIQ-COD-OFIC IN LIQ-FLD TO LIC-COD-OFIC IN LIC
              MOVE OPD-CIC-IOPD IN OPD     TO LIC-CIC-IOPD IN LIC
              MOVE OPD-COD-VCAM IN OPD     TO LIC-COD-VCAM IN LIC
              MOVE SPACES                  TO LIC-GLS-DISP IN LIC
              MOVE FIO-PUT TO FIO-CMND
           ELSE
              IF LIC-COD-STAT IN LIC NOT = 'S'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LICSTATERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-PRO-LIC
              ELSE
                   ADD WSS-LIC-SGV-TPAG TO LIC-SGV-TPAG IN LIC
                   IF LIC-SGV-TPAG IN LIC = ZEROES
                      MOVE FIO-DEL TO FIO-CMND
                   ELSE
                      MOVE FIO-MOD TO FIO-CMND.

           PERFORM DAP-FIO-LIC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PRO-LIC.
           EXIT.

       PRO-LIC-LIQ SECTION.
       INI-PRO-LIC-LIQ.
           MOVE LIQ-SGV-TPAG IN LIQ TO WSS-LIC-SGV-TPAG.
           MOVE OPD-CIC-ISER IN OPD TO LIC-CIC-ISER IN LIC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIC.
           MOVE FIO-STAT TO PGM-STAT-LIC.
           IF SCR-CIC-TVAL = PDB-CIC-MNAC
               MOVE LIQ-SGV-PESO IN LIQ TO WSS-LIC-SGV-TPAG
           ELSE
               MOVE LIQ-SGV-TPAG IN LIQ TO WSS-LIC-SGV-TPAG.

           IF NOT PGM-STAT-LIC-OKS
              MOVE WSS-LIC-SGV-TPAG    TO LIC-SGV-TPAG IN LIC

              MOVE SPACES              TO LIC-GLS-FLAG IN LIC
              MOVE ZEROES              TO LIC-FEC-FLIQ IN LIC
              MOVE 'S'                 TO LIC-COD-STAT IN LIC
              MOVE LIQ-COD-OFIC IN LIQ TO LIC-COD-OFIC IN LIC
              MOVE OPD-CIC-IOPD IN OPD TO LIC-CIC-IOPD IN LIC
              MOVE OPD-COD-VCAM IN OPD TO LIC-COD-VCAM IN LIC
              MOVE SPACES              TO LIC-GLS-DISP IN LIC
              MOVE FIO-PUT TO FIO-CMND
           ELSE
              IF LIC-COD-STAT IN LIC NOT = 'S'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'LICSTATERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-PRO-LIC-LIQ
              ELSE
                   ADD WSS-LIC-SGV-TPAG TO LIC-SGV-TPAG IN LIC
                   MOVE FIO-MOD TO FIO-CMND.

           PERFORM DAP-FIO-LIC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PRO-LIC-LIQ.
           EXIT.

       PUT-CAD SECTION.
       INI-PUT-CAD.
      *     IF CAD-IND-TCAD IN LIQ-FLD = 'M'
      *         GO TO FIN-PUT-CAD.
           MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
           MOVE 1                   TO CAD-NUM-ICAD IN CAD.
           IF LIQ-SGV-PESO IN LIQ-FLD > ZEROES
               MOVE LIQ-SGV-PESO IN LIQ-FLD TO CAD-SGV-LIQU IN CAD
           ELSE
               MOVE LIQ-SGV-TPAG IN LIQ     TO CAD-SGV-LIQU IN CAD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-CAD.
           EXIT.

       MOD-CAD SECTION.
       INI-MOD-CAD.
      *     IF CAD-IND-TCAD IN LIQ-FLD = 'M'
      *         GO TO FIN-MOD-CAD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-CAD.
           EXIT.

       DEL-CAD SECTION.
       INI-DEL-CAD.
      *     IF CAD-IND-TCAD IN LIQ-FLD = 'M'
      *         GO TO FIN-DEL-CAD.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-DEL-CAD.
           EXIT.

       DEL-DCL SECTION.
       INI-DEL-DCL.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DAP-FIO-DCL.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e in
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-DEL-DCL.
           EXIT.
       PRO-LIQ SECTION.
       INI-PRO-LIQ.
           IF WSS-TOT-AUTO = 1
              MOVE 'A' TO LIQ-COD-STAT IN LIQ
      * DAPR0021-INI(ISP)  1-FEB-2000
              PERFORM LNK-CCL
              MOVE TWA-COD-RETR TO LIQ-GLS-DISP IN LIQ
              IF TWA-COD-RETR NOT = '00'
                    MOVE 'CCTE   '    TO CCL-COD-TMSG
                    MOVE TWA-COD-RETR TO CCL-COD-CMSG
                    MOVE CCL-COD-MENS TO MSG-COD-MENS IN MSG
                    MOVE 'DAP' TO MSG-COD-SIST
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    GO TO FIN-PRO-LIQ
              ELSE
                  PERFORM PRO-SLD
      * DAPR0021-FIN(ISP)  1-FEB-2000
           ELSE
           IF WSS-TOT-CAJA = 1
              MOVE 'S' TO LIQ-COD-STAT IN LIQ
              PERFORM PRO-LIC
              IF MSG-COD-MENS NOT > SPACES
                 PERFORM PRO-SLD
              ELSE
                 NEXT SENTENCE
           ELSE
           IF WSS-TOT-MANU = 1
              MOVE 'A' TO LIQ-COD-STAT IN LIQ
              PERFORM PRO-SLD.
       FIN-PRO-LIQ.
           EXIT.

       PRO-SLD SECTION.
       INI-PRO-SLD.
      *ADA-INI 04-JUL-2002
           IF SCR-CMND         = 'LSI'      AND
              MSC-CIC-MSCL     = 'TCYACTBL' AND
              WSS-TOT-MANU     = 1          AND
              SCR-IND-MCAD NOT = 'M'
               PERFORM LIQ-CTBL
               GO TO FIN-PRO-SLD.
      *ADA-FIN 04-JUL-2002

      * ISP: ACTUALIZA VEN Y OPD, CUYOS REGISTROS YA FUERON LEIDOS(UPD)

           IF SCR-CMND = 'REV'

               ADD LIQ-SGV-CAPI IN LIQ
                        OPD-VAL-SCAP IN OPD
                               GIVING OPD-VAL-SCAP IN OPD

               MOVE 'G' TO OPD-COD-STAT IN OPD
               MOVE 'VIG' TO OPD-COD-SCTB IN OPD
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
               MOVE WSS-RCC-MSC-STAT-VIG TO WSS-RCC-MSC-STAT
               MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS

               IF PGM-STAT-DCL-OKS
                  ADD DCL-SGV-RESC IN DCL TO VEN-VAL-SFIN IN VEN
                          GIVING       VEN-VAL-SFIN IN VEN
               ELSE
                   ADD LIQ-SGV-TPAG IN LIQ VEN-VAL-SFIN IN VEN
                          GIVING       VEN-VAL-SFIN IN VEN
               END-IF

               ADD LIQ-SGV-CAPI IN LIQ VEN-VAL-SCAP IN VEN
                          GIVING       VEN-VAL-SCAP IN VEN
           ELSE
               SUBTRACT LIQ-SGV-CAPI IN LIQ FROM
                        OPD-VAL-SCAP IN OPD
                               GIVING OPD-VAL-SCAP IN OPD
      *ADA-INI 31-MAY-2004
      *        IF OPD-VAL-SCAP IN OPD = ZEROES
               IF OPD-VAL-SCAP IN OPD NOT > ZEROES OR
                  OPD-COD-MORE IN OPD = 'PI' OR
                  SCR-CMND = 'LRP'
                   IF SCR-CMND NOT = 'LRP'
                      MOVE 0 TO OPD-VAL-SCAP IN  OPD
                   END-IF
      *ADA-FIN 31-MAY-2004
                   PERFORM SET-SCTB
                   IF SCR-CMND = 'LRP'
                       SUBTRACT LIQ-SGV-CAPI IN LIQ-FLD FROM
                               VEN-VAL-SCAP IN VEN
                               GIVING VEN-VAL-SCAP IN VEN
                       SUBTRACT DCL-SGV-RESC IN LIQ-FLD FROM
                               VEN-VAL-SFIN IN VEN
                               GIVING VEN-VAL-SFIN IN VEN
                       IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                             MOVE 'L' TO OPD-COD-STAT IN OPD
                       ELSE
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
                             MOVE WSS-RCC-MSC-STAT-VIG TO
                                    WSS-RCC-MSC-STAT
                             MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS

                             MOVE 'VIG' TO OPD-COD-SCTB IN OPD
                       END-IF
                   ELSE
                       MOVE 'L' TO OPD-COD-STAT IN OPD
                       MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                                      VEN-VAL-SFIN IN VEN.

ISP*       IF ( SCR-CMND = 'LRP' OR SCR-CMND = 'CRP' ) AND
                VEN-VAL-SCAP IN VEN = ZEROES
                  SUBTRACT 1 FROM OPD-NUM-VNLQ IN OPD
                       ADD 1 TO   OPD-NUM-VSLQ IN OPD
           ELSE
      *ADA-INI 03-JUL-2002
      *    IF SCR-CMND = 'SLA'
ISP*       IF SCR-CMND = 'SLA' OR 'LSI' OR 'LVP' OR 'CVP'
ISP****                                 OR 'LRP' OR 'CRP'

      *ADA-FIN 03-JUL-2002
               MOVE LIQ-NUM-TLIQ IN LIQ TO WSS-LIQ-NUM-TLIQ
      *         MOVE WSS-LIQ-NUM-TLIQ TO LIQ-NUM-TLIQ IN LIQ
           ELSE
           IF SCR-CMND = 'REV'
               SUBTRACT LIQ-NUM-TLIQ IN LIQ FROM ZEROES GIVING
                    WSS-LIQ-NUM-TLIQ.

           SUBTRACT WSS-LIQ-NUM-TLIQ FROM OPD-NUM-VNLQ IN OPD.
           ADD WSS-LIQ-NUM-TLIQ      TO   OPD-NUM-VSLQ IN OPD.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VENUPDERRO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PRO-SLD.

      *RVM-ADA-INI 16-OCT-2000
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO OPD-FEC-FTRN IN OPD.
           MOVE HOY-HHOY TO OPD-HRA-HRTR IN OPD.
      *RVM-ADA-FIN 16-OCT-2000

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPDSELENEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-PRO-SLD.
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
           IF WSS-IND-GRCC = WSS-CT-S
              PERFORM LIQ-RCC
              MOVE WSS-CT-N TO WSS-IND-GRCC.
      *BEE-FIN-NGA-12-AGO-2013 TRANSACCIONES LENTAS
       FIN-PRO-SLD.
           EXIT.
       *ADA-INI 04-JUL-2002

      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
       LIQ-RCC SECTION.                                                 
       INI-LIQ-RCC.                                                     
           MOVE SPACES                         TO RCC-CIC-ICLI IN RCC.
           MOVE OPD-CIC-IOPD IN OPD            TO RCC-CIC-IOPD IN RCC.
           MOVE FIO-GET-NLS                    TO FIO-CMND.
           MOVE 'RCC-KEY-IOPD'                 TO FIO-AKEY.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-LIQ-RCC.

       LUP-LIQ-RCC.
           IF   OPD-CIC-IOPD IN OPD     NOT =  RCC-CIC-IOPD IN RCC
                GO TO FIN-LIQ-RCC.
           MOVE FIO-GET-KEY-UPD            TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
      *         DISPLAY ' ERROR AL LEER  RRC UPD' OPD-CIC-IOPD IN OPD
               GO TO FIN-LIQ-RCC.

           MOVE HOY-FHOY TO RCC-FEC-FTRN IN RCC.
           MOVE HOY-HHOY TO RCC-HRA-HRTR IN RCC.

           MOVE  FIO-MOD TO FIO-CMND.
           MOVE WSS-RCC-MSC-STAT  TO RCC-MSC-STAT IN RCC.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM DAP-FIO-RCC
                GO TO  NXT-RCC
           ELSE
                MOVE FIO-ULK-REC TO FIO-CMND
                PERFORM DAP-FIO-RCC
      *          DISPLAY ' ERROR AL GRB RRC ' OPD-CIC-IOPD IN OPD
                GO TO FIN-LIQ-RCC.
       NXT-RCC.
           MOVE 'RCC-KEY-IOPD'                 TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM DAP-FIO-RCC.
           GO TO LUP-LIQ-RCC.
       FIN-LIQ-RCC.                                                     
           EXIT.                                                        
      *BEE-FIN-NGA-12-AGO-2013 TRANSACCIONES LENTAS

       LIQ-CTBL SECTION.
       INI-LIQ-CTBL.
           MOVE SPACES TO MSG-COD-MENS.
      *    MOVE LIQ-CIC-IOPD IN LIQ TO OPD-CIC-IOPD IN OPD.
      *    MOVE FIO-GET-KEY-UPD TO FIO-CMND.
      *    PERFORM DAP-FIO-OPD.
      *    IF NOT FIO-STAT-OKS
      *        MOVE 'OPDSELENEX' TO MSG-COD-MENS
      *        GO TO FIN-LIQ-CTBL.
           IF OPD-VAL-SCAP IN OPD NOT = 0
               MOVE 'LIQSCAP<>0' TO MSG-COD-MENS
               GO TO FIN-LIQ-CTBL.
           IF SCR-CMND = 'REV'
               IF OPD-COD-RENO IN OPD = 'S'
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
                    MOVE WSS-RCC-MSC-STAT-VIG TO WSS-RCC-MSC-STAT
                    MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS

                   MOVE 'VIG' TO OPD-COD-SCTB IN OPD
               ELSE
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
                    MOVE WSS-RCC-MSC-STAT-VIG TO WSS-RCC-MSC-STAT
                    MOVE WSS-CT-S TO WSS-IND-GRCC
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS

                   MOVE 'VCD' TO OPD-COD-SCTB IN OPD
           ELSE
               MOVE 'CAN' TO OPD-COD-SCTB IN OPD
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
               MOVE WSS-RCC-MSC-STAT-CAN TO WSS-RCC-MSC-STAT
               MOVE WSS-CT-S  TO WSS-IND-GRCC.
      *BEE-FIN-NGA-12-AGO-2013 TRANSACCIONES LENTAS
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO OPD-FEC-FTRN IN OPD.
           MOVE HOY-HHOY TO OPD-HRA-HRTR IN OPD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
      *BEE-INI-NGA-12-AGO-2013 TRANSACCIONES LENTAS
      *        MOVE 'OPDSELENEX' TO MSG-COD-MENS.                       
               MOVE 'OPDSELENEX' TO MSG-COD-MENS                        
           ELSE
               IF WSS-IND-GRCC = WSS-CT-S
                  PERFORM LIQ-RCC
                  MOVE WSS-CT-N TO WSS-IND-GRCC.
      *BEE-FIN-NGA-12-AGO-2013 TRANSACCIONES LENTAS
       FIN-LIQ-CTBL.
           EXIT.

       VER-PRO-LIC SECTION.
       INI-VER-PRO-LIC.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'LIQPLICOPDNX' TO MSG-COD-MENS
               GO TO FIN-VER-PRO-LIC.
           MOVE 'TAB'               TO MSC-COD-SIST.
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CAD-IND-TCAD IN CAD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
      *Cuando no sea CAJA o
      *Cuando el DAP es fijo, se elimina la LIC y el registro
      *LIQ queda en estado = 'T'
           IF MSC-CIC-MSCL IN MSC NOT  = 'TCYACAJA' OR
              OPD-COD-RENO IN OPD NOT = 'S'
               MOVE OPD-CIC-ISER IN OPD TO LIC-CIC-ISER IN LIC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM DAP-FIO-LIC
               IF FIO-STAT-OKS
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM DAP-FIO-LIC
                   IF NOT FIO-STAT-OKS
                       MOVE 'LIQPLICLICDX' TO MSG-COD-MENS
                   END-IF
                   MOVE 'T' TO WSS-LIQ-STAT
                   GO TO UPD-VER-PRO-LIC
               ELSE
                   GO TO FIN-VER-PRO-LIC.
      *Aqui procesar CAJA
           MOVE OPD-CIC-ISER IN OPD TO LIC-CIC-ISER IN LIC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-MOD TO FIO-CMND.
           IF SCR-CIC-TVAL = PDB-CIC-MNAC
               MOVE LIQ-SGV-PESO IN LIQ-FLD TO WSS-LIC-SGV-TPAG
           ELSE
               MOVE LIQ-SGV-TPAG IN LIQ-FLD TO WSS-LIC-SGV-TPAG.
           MOVE WSS-LIC-SGV-TPAG        TO LIC-SGV-TPAG IN LIC.
           MOVE SPACES                  TO LIC-GLS-FLAG IN LIC.
           MOVE ZEROES                  TO LIC-FEC-FLIQ IN LIC.
           MOVE 'S'                     TO LIC-COD-STAT IN LIC.
           MOVE LIQ-COD-OFIC IN LIQ-FLD TO LIC-COD-OFIC IN LIC.
           MOVE OPD-CIC-IOPD IN OPD     TO LIC-CIC-IOPD IN LIC.
           MOVE OPD-COD-VCAM IN OPD     TO LIC-COD-VCAM IN LIC.
           MOVE SPACES                  TO LIC-GLS-DISP IN LIC.
           PERFORM DAP-FIO-LIC.
           IF NOT FIO-STAT-OKS
               MOVE 'LIQPLICLICUX' TO MSG-COD-MENS
               GO TO FIN-VER-PRO-LIC.
           MOVE 'S' TO WSS-LIQ-STAT.
       UPD-VER-PRO-LIC.
           PERFORM KEY-LIQ-LIQ.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS
               MOVE 'LIQPLICLIQNX' TO MSG-COD-MENS
               GO TO FIN-VER-PRO-LIC.
           MOVE WSS-LIQ-STAT TO LIQ-COD-STAT IN LIQ.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS
               MOVE 'LIQPLICLIQUX' TO MSG-COD-MENS.
       FIN-VER-PRO-LIC.
           EXIT.
      *ADA-FIN 04-JUL-2002

      * proceso journal
       PRO-JNL SECTION.
       INI-PRO-JNL.
      * ISP: LEE OPD PARA COMPLEMENTAR DATOS DE JOURNAL
           MOVE LIQ-CIC-IOPD IN LIQ TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.

           MOVE SPACES TO JNL.
           MOVE ZEROES TO JNL-FEC-CTB
                          JNL-VAL-1
                          JNL-VAL-2
                          JNL-FEC-EMI
                          JNL-FEC-LIQ
                          JNL-TAS-INT
                          JNL-NUM-LIQ
                          JNL-FEC-VTO.

      * DATOS CONSTANTES

      *    TIPO DE REGISTRO (E/S)
           MOVE 'S' TO JNL-TIP-REG.

      *    CANT. DE REGISTROS POR REG. LOGICO
           MOVE '0' TO JNL-CTD-REG.

      *    CODIGO DE SECUENCIA DEL REG. (0)
           MOVE '0' TO JNL-COD-SEC-REG.

      *    FECHA DE PROCESO
           MOVE HOY-FHOY TO JNL-FEC-PRC.

      *    HORA DE PROCESO
           MOVE HOY-HHOY TO JNL-HOR-PRC.

      *    NUMERO DE SEGUIMIENTO
      *     MOVE '1800' TO CIC-CAI-ICIC IN CIC.
      *     MOVE CIC-GET TO CIC-CMND.
      *     PERFORM PRO-CIC.
      *     IF CIC-STAT NOT = CIC-STAT-OKS
      *         MOVE CIC-MENS TO FRM-MENS
      *         MOVE FIO-STAT-NEX TO FIO-STAT
      *         GO TO FIN-PRO-JNL
      *     ELSE
      *        CENTRO DE ASIGNACION SEGUIM.
      *         MOVE CIC-CAI-ICIC TO JNL-CAI-SGM
      *        NUMERO SECUENCIAL DENTRO CEN. ASG.
      *         MOVE CIC-IIC-ICIC TO JNL-IIC-SGM.
           MOVE SPACES TO JNL-CAI-SGM.
           MOVE ZEROES TO JNL-IIC-SGM.

      *    CODIGO DE SISTEMA DE LA TRN
           MOVE 'DAP' TO JNL-COD-SIS-TRN.

      *    CODIGO DE TRANSACCION
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'EVT' TO TAB-COD-TTAB IN TAB.
           MOVE SCR-CMND TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO JNL-COD-TRN.

      *    CODIGO DE TRANSACCION
           MOVE SPACES TO JNL-COD-AUX-TRN.

      *    AMBIENTE GENERACION (SAFE,CICS,ETC)
           MOVE 'I' TO JNL-COD-AMB.

      *    MODALIDAD (LINEA,FUERA DE LINEA)
           MOVE 'L' TO JNL-COD-MOD.

      *    IDENTIFICACION OPERADOR
      *    OBTENER DESDE USUARIOS Y PRIVILEGIOS, MIENTRAS TANTO : SPACES
           MOVE SPACES TO JNL-IDN-USU-OPR.

      *    CODIGO DE TERMINAL
      *    OBTENER DESDE USUARIOS Y PRIVILEGIOS, MIENTRAS TANTO : SPACES
           MOVE SPACES TO JNL-TML.

      *    TIPO DE USUARIO DEL AUTORIZADOR TRN
      *    OBTENER DESDE USUARIOS Y PRIVILEGIOS, MIENTRAS TANTO : SPACES
           MOVE SPACES TO JNL-COD-TUS-AUT.

      *    OBTENER DESDE USUARIOS Y PRIVILEGIOS, MIENTRAS TANTO : SPACES
           MOVE SPACES TO JNL-IDN-USU-AUT.

      *    CODIGO DE PRODUCTO
      *    OPD-COD-COPD -> TO JNL-COD-PDT

      *    CODIGO DE ESTADO DE PROCESAMIENTO
           MOVE 'P' TO JNL-COD-EST-PRC.

      *    TIPO ORIGEN PARA CUADRAT. (OFI/INT)
           MOVE SPACES TO JNL-TIP-ORN-CUA.

      *    CODIGO DE CUADRATURA
           MOVE SPACES TO JNL-COD-CUA.

      *    FECHA CONTABLE
           MOVE HOY-FHOY TO JNL-FEC-CTB.

      * DATOS VARIABLES

      *    CODIGO OFICINA ORIGEN
      *    CODIGO OFICINA DESTINO
           MOVE OPD-COD-OFIC IN OPD TO JNL-COD-OFI-ORN
                                       JNL-COD-OFI-DST.

      *    TIME-STAMP (NOTA 4)
           MOVE LIQ-STP-ITRN IN LIQ TO JNL-STP-ITRN.

      *    CODIGO OPERACION
      *    MOVE OPD-CIC-IOPD IN OPD TO JNL-COP.
           MOVE OPD-CAI-IOPD IN OPD TO JNL-NUM-SIS.
      * ISP-INI 11-feb-2013 1311_08
      *    MOVE OPD-CAI-IOPD IN OPD TO JNL-COD-CRR.
           MOVE OPD-IIC-IOPD IN OPD TO JNL-COD-CRR.
      * ISP-FIN 11-feb-2013 1311_08

      *    CLASE DE OPERACION
      *    MOVE OPD-COD-COPD IN OPD TO JNL-CLA-OPE.
           MOVE OPD-COD-TOPD IN OPD TO JNL-TIP-OPE.
           MOVE OPD-COD-AOPD IN OPD TO JNL-STP-OPE.

      *    CIC DEL CLIENTE
      *    RCC-CIC-ICLI -> JNL-CIC-CLI.

      *    VALOR DE CAMBIO OPERACION
           MOVE OPD-COD-VCAM IN OPD TO JNL-VCB-OPE.

      *    MONTO 1
           MOVE OPD-VAL-CAPT IN OPD TO JNL-VAL-1.

      *    MONTO 2
      *    LIQ-SGV-TPAG -> JNL-VAL-2

      *    EJECUTIVO QUE ATIENDE AL CLIENTE.
           MOVE OPD-COD-EJEC IN OPD TO JNL-COD-EJE.

      *    FECHA EMISION
           MOVE OPD-FEC-FREA IN OPD TO JNL-FEC-EMI.

      *    FECHA LIQUIDACION
      *    LIQ-FEC-FREA -> JNL-FEC-LIQ.

      *    TIPO TASA DE INTERES.
           MOVE OPD-COD-TINT IN OPD TO JNL-TIP-TAS-INT.

      *    TASA DE INTERES
           MOVE OPD-SGV-TINT IN OPD TO JNL-TAS-INT.

      *    NUMERO DE LIQUIDACION
      *    LIQ-NUM-ILIQ -> JNL-NUM-LIQ

      *    FECHA VENCIMIENTO
           MOVE OPD-FEC-FTER IN OPD TO JNL-FEC-VTO.

      *    CODIGO OPERACION ABONO.
           MOVE CAD-CIC-ICAD IN CAD TO JNL-COP-ABO.

      *    EJECUTIVO LIQUIDACION.
      *    LIQ-COD-EJEC -> JNL-COD-EJE-LIQ

      *    SERIAL DOCUMENTO.
           MOVE OPD-CIC-ISER IN OPD TO JNL-SRL-DOC.

      *    MOTIVO ONP.
      *    ONP-COD-MONP -> JNL-COD-MOT-ONP

      *    INDICADOR MULTIPLES CLIENTES.
           MOVE DBC-IND-ICLI IN DBC TO JNL-IND-MUL-CLI.

       PUT-JNL.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-JNL.
           IF NOT FIO-STAT-OKS
      *        Error al grabar el journal
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'JNL    ERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PRO-JNL.
           EXIT.

      *>>>> EOF_PU
      * COPY GNSBGVSM.
       COPY DAPBGVEN.
      * ISP-INI 11-feb-2013 1311_08
       PRO-LND SECTION.
       INI-PRO-LND.
           PERFORM GET-FHOY.
           MOVE SPACES TO LND.
      *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
      *    MOVE SCR-CMND TO LND-COD-EVEN IN LND.
           MOVE WSS-CT-LIQ    TO LND-COD-EVEN IN LND.
      *CIMA-FIN/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
           MOVE 'I'      TO LND-COD-TACC IN LND
                            LND-COD-STAT IN LND.
           MOVE 'N/A'    TO LND-COD-INST IN LND.
           MOVE 1 TO LND-NUM-CLND IN LND
                     LND-NUM-COPD IN LND
                     LND-NUM-CCLI IN LND
                     LND-NUM-CAUT IN LND.
           PERFORM PUT-LND.
       FIN-PRO-LND.
            EXIT.
      *
       PUT-LND SECTION.
       INI-PUT-LND.
           MOVE '1.0' TO LND-COD-VERS IN LND.
           MOVE 'OPD' TO LND-COD-ENTF IN LND
                         LND-COD-ENTO IN LND
                         LND-COD-ENTC IN LND
                         LND-COD-ENTA IN LND
                         LND-COD-ENTI IN LND.
           MOVE HOY-FHOY TO LND-FEC-FTRN IN LND
                            LND-FEC-FLND IN LND
                            LND-FEC-FOPD IN LND
                            LND-FEC-FCLI IN LND
                            LND-FEC-FAUT IN LND.
           MOVE HOY-HHOY TO LND-HRA-HRTR IN LND
                            LND-HRA-HHND IN LND
                            LND-HRA-HOPD IN LND
                            LND-HRA-HCLI IN LND
                            LND-HRA-HAUT IN LND.
           MOVE LIQ-CIC-IOPD IN LIQ TO LND-CIC-IOPD IN LND.
           MOVE EIBTRMID            TO LND-COD-OTRN IN LND.
           MOVE SCR-USER            TO LND-COD-ATRN IN LND
                                       LND-COD-AUTO IN LND.
           MOVE EIBTRNID            TO LND-COD-TCIC IN LND.
           MOVE SCR-CMND            TO LND-COD-CMND IN LND.
           PERFORM SET-LND-REG.
      *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
           PERFORM GET-CUR-RCC.
      *CIMA-FIN/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
              MOVE RCC-CIC-ICLI IN RCC TO LND-CIC-ICLI IN LND.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-LND.
       FIN-PUT-LND.
           EXIT.

       SET-LND-REG SECTION.
       INI-SET-LND-REG.
           MOVE LIQ-NUM-ILIQ IN LIQ TO LND-COD-LN01 IN LND.
           MOVE LIQ-COD-STAT IN LIQ TO LND-COD-LN02 IN LND.
           MOVE LIQ-COD-OFIC IN LIQ TO LND-COD-LN03 IN LND.
           MOVE LIQ-COD-EJEC IN LIQ TO LND-COD-LN04 IN LND.
           MOVE LIQ-FEC-FREA IN LIQ TO LND-COD-LN05 IN LND.


           MOVE WSS-TOT-CAJA        TO LND-COD-LN06 IN LND.

           MOVE WSS-TOT-MANU        TO LND-COD-LN07 IN LND.

           MOVE WSS-TOT-AUTO        TO LND-COD-LN08 IN LND.

           MOVE WSS-CIC-ICAD        TO LND-COD-LN09 IN LND.

      *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
      *    MOVE LIQ-SGV-CAPI IN LIQ TO WSS-LVP-EDIT.
      *    MOVE WSS-LVP-EDIT        TO LND-COD-LN10 IN LND.

      *    MOVE LIQ-SGV-TPAG IN LIQ TO WSS-LVP-EDIT.
      *    MOVE WSS-LVP-EDIT        TO LND-COD-LN11 IN LND.

           MOVE LIQ-SGV-CAPI IN LIQ TO WSS-VAL-EDITT.
           MOVE WSS-VAL-EDITT        TO LND-COD-LN10 IN LND.
           MOVE LIQ-SGV-TPAG IN LIQ TO WSS-VAL-EDITT.
           MOVE WSS-VAL-EDITT        TO LND-COD-LN11 IN LND.
      *CIMA-FIN/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
       FIN-SET-LND-REG.
           EXIT.


       COPY DAPBFLND.
      * ISP-FIN 11-feb-2013 1311_08
      *CIMA-INI/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
       GET-CUR-RCC SECTION.
      *--------------------
       INI-GET-CUR-RCC.
           MOVE OPD-CIC-IOPD IN OPD TO RCC-CIC-IOPD IN RCC.
           MOVE WSS-CT-KIOP         TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                   OPD-CIC-IOPD IN OPD = RCC-CIC-IOPD IN RCC)
                   MOVE WSS-CT-L23 TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.
      *CIMA-FIN/CORRECCION INCIDENTES DAP GRUPO 1 HITO 2/OCT-2014
      *>>>> EOF_PU
      *INI-MFC TUXEDO ORACLE
       COPY DAPZULIQ.
      *FIN-MFC TUXEDO ORACLE
