      * 24-May-96 10:57 AM
       PUT-ALL-CRT SECTION.
       INI-PUT-ALL-CRT.
           PERFORM PUT-CRT-CRT.
       FIN-PUT-ALL-CRT.
           EXIT.
       
       PUT-CRT-CRT SECTION.
       INI-PUT-CRT-CRT.
           IF PGM-STAT-CRT-NUL
               GO TO FIN-PUT-CRT-CRT.
           IF NOT PGM-STAT-CRT-OKS
               PERFORM CLR-CRT-CRT
               GO TO FIN-PUT-CRT-CRT.
           MOVE CRT-COD-TMOV IN CRT TO CRT-COD-TMOV IN CRT-FLD.
           MOVE CRT-NUM-DCRT IN CRT TO CRT-NUM-DCRT IN CRT-FLD.
           MOVE CRT-NUM-MCRT IN CRT TO CRT-NUM-MCRT IN CRT-FLD.
           MOVE CRT-NUM-SCRT IN CRT TO CRT-NUM-SCRT IN CRT-FLD.
           MOVE CRT-NUM-ACRT IN CRT TO CRT-NUM-ACRT IN CRT-FLD.
           MOVE CRT-VAL-TSAL IN CRT TO CRT-VAL-TSAL IN CRT-FLD.
           MOVE CRT-VAL-INTE IN CRT TO CRT-VAL-INTE IN CRT-FLD.
           MOVE CRT-NUM-TDOC IN CRT TO CRT-NUM-TDOC IN CRT-FLD.
           MOVE CRT-GLS-FLAG IN CRT TO CRT-GLS-FLAG IN CRT-FLD.
           MOVE CRT-GLS-DISP IN CRT TO CRT-GLS-DISP IN CRT-FLD.
       FIN-PUT-CRT-CRT.
           EXIT.
       
       KEY-ALL-CRT SECTION.
       INI-KEY-ALL-CRT.
           PERFORM KEY-CRT-CRT.
       FIN-KEY-ALL-CRT.
           EXIT.
       
       KEY-CRT-CRT SECTION.
       INI-KEY-CRT-CRT.
           MOVE CRT-COD-TMOV IN CRT-FLD TO CRT-COD-TMOV IN CRT.
           MOVE CRT-NUM-DCRT IN CRT-FLD TO CRT-NUM-DCRT IN CRT.
           MOVE CRT-NUM-MCRT IN CRT-FLD TO CRT-NUM-MCRT IN CRT.
           MOVE CRT-NUM-SCRT IN CRT-FLD TO CRT-NUM-SCRT IN CRT.
           MOVE CRT-NUM-ACRT IN CRT-FLD TO CRT-NUM-ACRT IN CRT.
       FIN-KEY-CRT-CRT.
           EXIT.
       
       SCR-CLRA-CRT SECTION.
       INI-SCR-CLRA-CRT.
           PERFORM CLR-KEY-CRT.
           PERFORM CLR-FLD-CRT.
       FIN-SCR-CLRA-CRT.
           EXIT.
       
       CLR-KEY-CRT SECTION.
       INI-CLR-KEY-CRT.
           MOVE SPACES TO CRT-COD-TMOV IN CRT-FLD.
           MOVE ZEROES TO CRT-FEC-FCRT IN CRT-FLD.
       FIN-CLR-KEY-CRT.
           EXIT.
       
       CLR-FLD-CRT SECTION.
       INI-CLR-FLD-CRT.
           PERFORM CLR-CRT-CRT.
       FIN-CLR-FLD-CRT.
           EXIT.
       
       CLR-CRT-CRT SECTION.
       INI-CLR-CRT-CRT.
           MOVE ZEROES TO CRT-VAL-TSAL IN CRT-FLD.
           MOVE ZEROES TO CRT-VAL-INTE IN CRT-FLD.
           MOVE ZEROES TO CRT-NUM-TDOC IN CRT-FLD.
           MOVE SPACES TO CRT-GLS-FLAG IN CRT-FLD.
           MOVE SPACES TO CRT-GLS-DISP IN CRT-FLD.
       FIN-CLR-CRT-CRT.
           EXIT.
       
       FST-KEY-CRT SECTION.
       INI-FST-KEY-CRT.
           MOVE -1 TO CRT-COD-TMOV-LEN IN CRT-FLD.
       FIN-FST-KEY-CRT.
           EXIT.
       
       FST-FLD-CRT SECTION.
       INI-FST-FLD-CRT.
           MOVE -1 TO CRT-VAL-TSAL-LEN IN CRT-FLD.
       FIN-FST-FLD-CRT.
           EXIT.
       
       PRO-KEY-CRT SECTION.
       INI-PRO-KEY-CRT.
           PERFORM PRO-IKY-CRT.
           PERFORM PRO-AKY-CRT.
           PERFORM PRO-MKY-CRT.
       FIN-PRO-KEY-CRT.
           EXIT.
       
       PRO-IKY-CRT SECTION.
       INI-PRO-IKY-CRT.
           MOVE FRM-CPIM-AEY TO CRT-COD-TMOV-ATR IN CRT-FLD.
           MOVE FRM-CPIM-AEY TO CRT-FEC-FCRT-ATR IN CRT-FLD.
       FIN-PRO-IKY-CRT.
           EXIT.
       
       PRO-MKY-CRT SECTION.
       INI-PRO-MKY-CRT.
       FIN-PRO-MKY-CRT.
           EXIT.
       
       PRO-AKY-CRT SECTION.
       INI-PRO-AKY-CRT.
       FIN-PRO-AKY-CRT.
           EXIT.
       
       UNP-KEY-CRT SECTION.
       INI-UNP-KEY-CRT.
           PERFORM UNP-IKY-CRT.
           PERFORM UNP-AKY-CRT.
           PERFORM UNP-MKY-CRT.
       FIN-UNP-KEY-CRT.
           EXIT.
       
       UNP-IKY-CRT SECTION.
       INI-UNP-IKY-CRT.
           MOVE FRM-CPIM-UBY TO CRT-COD-TMOV-ATR.
           MOVE FRM-CPIM-UBY TO CRT-FEC-FCRT-ATR.
       FIN-UNP-IKY-CRT.
           EXIT.
       
       UNP-MKY-CRT SECTION.
       INI-UNP-MKY-CRT.
       FIN-UNP-MKY-CRT.
           EXIT.
       
       UNP-AKY-CRT SECTION.
       INI-UNP-AKY-CRT.
       FIN-UNP-AKY-CRT.
           EXIT.
       
       UNP-FLD-CRT SECTION.
       INI-UNP-FLD-CRT.
           PERFORM UNP-CRT-CRT.
       FIN-UNP-FLD-CRT.
           EXIT.
       
       UNP-CRT-CRT SECTION.
       INI-UNP-CRT-CRT.
           MOVE FRM-CPIM-UBY TO CRT-VAL-TSAL-ATR IN CRT-FLD.
           MOVE FRM-CPIM-UBY TO CRT-VAL-INTE-ATR IN CRT-FLD.
           MOVE FRM-CPIM-UBY TO CRT-NUM-TDOC-ATR IN CRT-FLD.
           MOVE FRM-CPIM-UBY TO CRT-GLS-FLAG-ATR IN CRT-FLD.
           MOVE FRM-CPIM-UBY TO CRT-GLS-DISP-ATR IN CRT-FLD.
       FIN-UNP-CRT-CRT.
           EXIT.
       
       VAL-KEY-CRT SECTION.
       INI-VAL-KEY-CRT.
           PERFORM VAL-IKY-CRT.
           PERFORM VAL-MKY-CRT.
           PERFORM VAL-AKY-CRT.
       FIN-VAL-KEY-CRT.
           EXIT.
       
       VAL-IKY-CRT SECTION.
       INI-VAL-IKY-CRT.
           PERFORM VAL-CRT-COD-TMOV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CRT-COD-TMOV-LEN IN CRT-FLD
                GO TO FIN-VAL-IKY-CRT.
           PERFORM VAL-CRT-FEC-FCRT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CRT-FEC-FCRT-LEN IN CRT-FLD
                GO TO FIN-VAL-IKY-CRT.
       FIN-VAL-IKY-CRT.
           EXIT.
       
       VAL-MKY-CRT SECTION.
       INI-VAL-MKY-CRT.
       FIN-VAL-MKY-CRT.
           EXIT.
       
       VAL-AKY-CRT SECTION.
       INI-VAL-AKY-CRT.
       FIN-VAL-AKY-CRT.
           EXIT.
       
       VAL-CRT-COD-TMOV SECTION.
       INI-VAL-CRT-COD-TMOV.
           IF CRT-COD-TMOV IN CRT-FLD NOT > SPACES
              MOVE SPACES TO CRT-COD-TMOV IN CRT-FLD.
       FIN-VAL-CRT-COD-TMOV.
           EXIT.
       
       VAL-CRT-FEC-FCRT SECTION.
       INI-VAL-CRT-FEC-FCRT.
      *VAL-FEC Validar Fecha
           MOVE CRT-FEC-FCRT IN CRT-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CRT-FEC-FCRT IN CRT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CRT-FEC-FCRT.
       FIN-VAL-CRT-FEC-FCRT.
           EXIT.
       
       VAL-CON-KEY-CRT SECTION.
       INI-VAL-CON-KEY-CRT.
           IF     CRT-COD-TMOV IN CRT-FLD NOT > SPACES 
              AND CRT-FEC-FCRT IN CRT-FLD NOT > SPACES 
              AND CRT-NUM-DCRT IN CRT-FLD NOT > SPACES 
              AND CRT-NUM-MCRT IN CRT-FLD NOT > SPACES 
              AND CRT-NUM-SCRT IN CRT-FLD NOT > SPACES 
              AND CRT-NUM-ACRT IN CRT-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CRT.
       FIN-VAL-CON-KEY-CRT.
           EXIT.
       
       VAL-CON-IKY-CRT SECTION.
       INI-VAL-CON-IKY-CRT.
           IF     CRT-COD-TMOV IN CRT-FLD NOT > SPACES 
              AND CRT-FEC-FCRT IN CRT-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CRT.
       FIN-VAL-CON-IKY-CRT.
           EXIT.
       
       VAL-NUM-KEY-CRT SECTION.
       INI-VAL-NUM-KEY-CRT.
           PERFORM VAL-NUM-IKY-CRT.
           PERFORM VAL-NUM-MKY-CRT.
           PERFORM VAL-NUM-AKY-CRT.
       FIN-VAL-NUM-KEY-CRT.
           EXIT.
       
       VAL-NUM-IKY-CRT SECTION.
       INI-VAL-NUM-IKY-CRT.
       FIN-VAL-NUM-IKY-CRT.
           EXIT.
       
       VAL-NUM-MKY-CRT SECTION.
       INI-VAL-NUM-MKY-CRT.
       FIN-VAL-NUM-MKY-CRT.
           EXIT.
       
       VAL-NUM-AKY-CRT SECTION.
       INI-VAL-NUM-AKY-CRT.
       FIN-VAL-NUM-AKY-CRT.
           EXIT.
       
       VAL-NUM-FLD-CRT SECTION.
       INI-VAL-NUM-FLD-CRT.
       VAL-NUM-CRT-VAL-TSAL.
           MOVE CRT-VAL-TSAL-ALF IN CRT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CRT-VAL-TSAL IN CRT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CRT-VAL-TSAL-LEN IN CRT-FLD
                GO TO FIN-VAL-NUM-FLD-CRT.
       VAL-NUM-CRT-VAL-INTE.
           MOVE CRT-VAL-INTE-ALF IN CRT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CRT-VAL-INTE IN CRT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CRT-VAL-INTE-LEN IN CRT-FLD
                GO TO FIN-VAL-NUM-FLD-CRT.
       VAL-NUM-CRT-NUM-TDOC.
           MOVE CRT-NUM-TDOC-ALF IN CRT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO CRT-NUM-TDOC IN CRT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CRT-NUM-TDOC-LEN IN CRT-FLD
                GO TO FIN-VAL-NUM-FLD-CRT.
       FIN-VAL-NUM-FLD-CRT.
           EXIT.
       
       EDT-KEY-CRT SECTION.
       INI-EDT-KEY-CRT.
           PERFORM EDT-IKY-CRT.
           PERFORM EDT-MKY-CRT.
           PERFORM EDT-AKY-CRT.
       FIN-EDT-KEY-CRT.
           EXIT.
       
       EDT-IKY-CRT SECTION.
       INI-EDT-IKY-CRT.
       FIN-EDT-IKY-CRT.
           EXIT.
       
       EDT-MKY-CRT SECTION.
       INI-EDT-MKY-CRT.
       FIN-EDT-MKY-CRT.
           EXIT.
       
       EDT-AKY-CRT SECTION.
       INI-EDT-AKY-CRT.
       FIN-EDT-AKY-CRT.
           EXIT.
       
       EDT-FLD-CRT SECTION.
       INI-EDT-FLD-CRT.
           IF CRT-VAL-TSAL-LEN IN CRT-FLD = -9
                MOVE -1 TO CRT-VAL-TSAL-LEN IN CRT-FLD
                GO TO FIN-EDT-FLD-CRT.
           MOVE CRT-VAL-TSAL IN CRT-FLD TO CRT-VAL-TSAL-EDT IN CRT-EDT.
           MOVE CRT-VAL-TSAL-EDT IN CRT-EDT TO 
                CRT-VAL-TSAL-ALF IN CRT-FLD.
           IF CRT-VAL-INTE-LEN IN CRT-FLD = -9
                MOVE -1 TO CRT-VAL-INTE-LEN IN CRT-FLD
                GO TO FIN-EDT-FLD-CRT.
           MOVE CRT-VAL-INTE IN CRT-FLD TO CRT-VAL-INTE-EDT IN CRT-EDT.
           MOVE CRT-VAL-INTE-EDT IN CRT-EDT TO 
                CRT-VAL-INTE-ALF IN CRT-FLD.
           IF CRT-NUM-TDOC-LEN IN CRT-FLD = -9
                MOVE -1 TO CRT-NUM-TDOC-LEN IN CRT-FLD
                GO TO FIN-EDT-FLD-CRT.
           MOVE CRT-NUM-TDOC IN CRT-FLD TO CRT-NUM-TDOC-EDT IN CRT-EDT.
           MOVE CRT-NUM-TDOC-EDT IN CRT-EDT TO 
                CRT-NUM-TDOC-ALF IN CRT-FLD.
       FIN-EDT-FLD-CRT.
           EXIT.
