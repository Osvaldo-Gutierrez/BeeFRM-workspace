       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DAPPQLIQ.
       AUTHOR.       BEE.
       DATE-WRITTEN. 08-May-19 03:41 PM.

      * NOMBRE PROGRAMA                   DAPPQLIQ
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      DAPLIQ
      * PANTALLA                          DAPLIQ
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<< CMT_ID
      * ===================================================
      *  MODIFICACIONES:
      *----------------------------------------------------
      *  AUTOR      : CIMA-ISP
      *  FECHA      : 2014-02-11
      *  ETIQUETA   : ISP-INI 11-FEB-2013 1311_08
      *  PROYECTO   : TOWER
      *  CAMBIOS    : CORRIGE REVERSA CON IMPACTO EN L-VIG
      *----------------------------------------------------
      *>>>> CMT_ID

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DAPPQLIQ-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DAPPQLIQ$ SKL=$19.04.15$ VSN=$01-14$        
      -    'GEN=$08-May-19 03:41 PM$ FNC=$190305$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
      *JVM se agrega signo a campos de monto (31/03/92)
           02 SCR-CIC-CLI1              PIC X(12).
           02 SCR-CIC-CLI2              PIC X(12).
           02 SCR-SGV-VCAM              PIC 9(11)V9(04).
           02 SCR-IND-MCLI              PIC X(01).
           02 SCR-IND-MCAD              PIC X(01).
           02 SCR-CIC-VCAM.
              04 SCR-CIC-TVAL           PIC X(01).
              04 SCR-CIC-CVAL           PIC X(03).
              04 SCR-CIC-TCAM           PIC X(08).
           02 SCR-SGV-CAPI              PIC S9(11)V9(05).
           02 SCR-SGV-REAJ              PIC S9(11)V9(05).
           02 SCR-SON-S                 PIC X(01).
           02 SCR-SON-N                 PIC X(01).
           02 SCR-COD-GARA-N            PIC X(01).
           02 SCR-COD-CUST-E            PIC X(01).
           02 SCR-COD-OFIC              PIC X(03).
           02 SCR-SGV-MCAS              PIC S9(11)V9(05).

      *>>>>
       COPY DAPWILIQ.

       COPY DAPBRLIQ.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIQ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSX.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS

       COPY USPC117.
       77  WSS-FRM-GLS-CAPI        PIC X(09).
       77  WSS-FRM-GLS-INTE        PIC X(09).
       77  WSS-FRM-GLS-SCAP        PIC X(17).
       77  WSS-FRM-GLS-SFIN        PIC X(17).
       77  WSS-FRM-GLS-KNEW        PIC X(16).
       77  WSS-FRM-GLS-IPAG-GA     PIC X(09).
       77  WSS-FRM-GLS-IPAG-PE     PIC X(09).
       77  WSS-FRM-GLS-FNEW        PIC X(16).
       77  WSS-FRM-GLS-INTD        PIC X(14).
       77  WSS-FRM-GLS-ACED-MD     PIC X(34).
       77  WSS-FRM-GLS-ACED-OF     PIC X(34).
       77  WSS-FRM-GLS-PEGA-PE     PIC X(13).
       77  WSS-FRM-GLS-PEGA-VP     PIC X(13).
       77  WSS-FRM-GLS-PEGA-GA     PIC X(13).

       77  WSS-TASA-CERO  VALUE 'N'      PIC X(01).
       77  WSS-VF-LVP-LRP VALUE  SPACES  PIC X(03).

       01  WSS-GLS-FUNGI VALUE SPACES.
           03 WSS-GLS-FUNGI-VHBL         PIC X(01).
           03 WSS-GLS-FUNGI-CHOY         PIC X(01).
           03 WSS-GLS-FUNGI-FBLK         PIC X(01).

      *<<<< WSS
      *>>>>Registro MSG
      *
      *    Registro Generico de Mensajes
      *    -----------------------------
      *
      *    Nombre Registro : MSG
      *    Clave(s)        : MSG-COD-TABL(UU), MSG-STP-ITRN(UU),
      *                      MSG-CIC-TABL(UU), MSG-EXT-TABL(UU)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  MSG.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  MSG-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  MSG-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  MSG-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  MSG-COD-TTAB                     PIC X(03).
      *
      *            Codigo Mensaje
                   07  MSG-COD-MENS.
      *                Tipo Mensaje
                       09  MSG-COD-TMSG                 PIC X(07).
      *
      *                Codigo Mensaje
                       09  MSG-COD-CMSG                 PIC X(05).
      *
      *        Time Stamp Transaccion
               05  MSG-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  MSG-FEC-FTRN.
                       09  MSG-NUM-STRN                 PIC 9(02).
                       09  MSG-NUM-ATRN                 PIC 9(02).
                       09  MSG-NUM-MTRN                 PIC 9(02).
                       09  MSG-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  MSG-HRA-HRTR.
                       09  MSG-NUM-HHTR                 PIC 9(02).
                       09  MSG-NUM-MMTR                 PIC 9(02).
                       09  MSG-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  MSG-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  MSG-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  MSG-IND-VIGE  REDEFINES  MSG-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  MSG-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  MSG-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  MSG-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  MSG-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  MSG-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  MSG-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Mensaje
               05  MSG-CIC-MENS.
      *
      *            Tipo Mensaje
                   07  MSG-CIC-TMSG                     PIC X(07).
      *
      *            Codigo Mensaje
                   07  MSG-CIC-CMSG                     PIC X(05).
      *
      *    Codigo Externo
           03  MSG-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  MSG-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  MSG-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  MSG-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  MSG-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  MSG-GLS-DESC.
               05  MSG-GLS-DES1                         PIC X(20).
               05  MSG-GLS-DES2                         PIC X(20).
      *
      *    Datos Anexos
           03  MSG-GLS-DATA.
      *
      *        Glosa Mensaje
               05  MSG-GLS-MENS                         PIC X(40).
      *
      *        Disponible
               05  MSG-GLS-DISP                         PIC X(20).
      *
      *    Clave Soundex
           03  MSG-SNX-TABL.
               05  MSG-SNX-TTAB                         PIC X(03).
               05  MSG-SNX-MENS                         PIC X(03).
      *
      *    Variables de Mensajes
       01  MSG-VARI.
      *
      *    Nombre de Programa FIO para Mensajes
           03  MSG-GLS-FMSG.
      *
      *        Codigo Sistema
               05  MSG-COD-SIST                         PIC X(03).
      *
      *        Nombre 'fijo' de FIO Mensajes
               05  MSG-COD-FMSG           VALUE 'PFTAB' PIC X(05).
      *
      *    VARIABLES DE MENSAJES POR CANAL
       01  MSG-CNAL.
      *
           03  MSG-GLS-DACN.
      *
               05  MSG-COD-DAC1                         PIC X(57).
      *
               05  MSG-COD-DAC2                         PIC X(03).
      *
           03  MSG-GLS-CNAL.
      *
      *            FIJO CN
               05  MSG-COD-INDC                         PIC X(02).
      *            CI= CODIGO INEX   NI = NUMERO INVALIDO
      *            NV= CODIGO NOVIG  SPACES = SIN CLASIFICAR
               05  MSG-COD-SIDC                         PIC X(02).
      *
               05  MSG-COD-DEST                         PIC X(03).
      *
               05  MSG-COD-SISC                         PIC X(03).
      *
               05  MSG-COD-CODC                         PIC X(12).
               05  MSG-COD-CODC-RED REDEFINES MSG-COD-CODC.
                   07  MSG-COD-CODC-01                  PIC X(01).
                   07  MSG-COD-CODC-02                  PIC X(01).
                   07  MSG-COD-CODC-03                  PIC X(01).
                   07  MSG-COD-CODC-04                  PIC X(01).
                   07  MSG-COD-CODC-05                  PIC X(01).
                   07  MSG-COD-CODC-06                  PIC X(01).
                   07  MSG-COD-CODC-07                  PIC X(01).
                   07  MSG-COD-CODC-08                  PIC X(01).
                   07  MSG-COD-CODC-09                  PIC X(01).
                   07  MSG-COD-CODC-10                  PIC X(01).
                   07  MSG-COD-CODC-11                  PIC X(01).
                   07  MSG-COD-CODC-12                  PIC X(01).
      *
               05  MSG-GLS-CICF.
                   07 MSG-GLS-CICF-DESC.
                       09  MSG-GLS-CI01                 PIC X(03).
                       09  MSG-GLS-CI02                 PIC X(12).
                       09  MSG-GLS-CI03                 PIC X(03).
                       09  MSG-GLS-CI04                 PIC X(22).
      *
      *
               05  MSG-GLS-NVCF REDEFINES MSG-GLS-CICF.
                   07  MSG-GLS-NV01                     PIC X(03).
                   07  MSG-GLS-NV02                     PIC X(12).
                   07  MSG-GLS-NV03                     PIC X(03).
                   07  MSG-GLS-NV04                     PIC X(22).
      *
               05  MSG-GLS-NICF REDEFINES MSG-GLS-CICF.
                   07  MSG-GLS-NI04                     PIC X(40).

               05  MSG-GLS-CICF-DATA                    PIC X(60).
      *
           03  MSG-CNAL-RED REDEFINES MSG-GLS-CNAL.
               05 MSG-CNAL-RED-DESC                     PIC X(40).
               05 MSG-CNAL-RED-DATA                     PIC X(40).


      *Entidades de SGC
       COPY DAPWG006.
       COPY SGCBRDBC.
       COPY SGCBROPE.
       COPY SGCBRRCO.

      *Entidades de TAB
       COPY TABBRCAM.
       COPY TABBRVLR.

      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRDCL.
       COPY DAPBRTOD.
       COPY DAPBRCAD.
       COPY DAPBRVEN.
       COPY DAPBRRCC.
       COPY DAPBRLIC.
       COPY DAPBRJNL.

      *Entidades de GNS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY GNSWGINT.
       COPY GNSWGTDQ.

       01  WSS-MSG VALUE SPACES.
           03 WSS-MSG-DESC                           PIC X(40).
           03 WSS-MSG-DATA                           PIC X(40).

       01  WSS-VARI.
           03 WSS-OPD-CAI-ISER                       PIC 9(04).
           03 PGM-STAT-RCC           VALUE '23'      PIC X(02).
              88 PGM-STAT-RCC-OKS    VALUE '00'.
              88 PGM-STAT-RCC-NUL    VALUE '  '.
           03 PGM-STAT-LIC           VALUE '23'      PIC X(02).
              88 PGM-STAT-LIC-OKS    VALUE '00'.
              88 PGM-STAT-LIC-NUL    VALUE '  '.
      *    cantidad de operaciones vigentes de un cliente
           03 WSS-OPDV                            PIC 9(04).
           03 WSS-IND-CTA                         PIC X(01).
      *       ind cta mismo u otro cliente
           03 WSS-IND-MUOC                        PIC X(01).
      * GRUPO AL QUE PERTENECE TIPO DE CARGO ABONO
      * CAJA, AUTOMATICO O MANUAL.
           03 WSS-IND-GCAD                        PIC X(01).

      *    VAR-VRF-CAD
           03 WSS-TOT-CAJA  VALUE ZEROES          PIC 9(02).
           03 WSS-TOT-AUTO  VALUE ZEROES          PIC 9(02).
           03 WSS-TOT-MANU  VALUE ZEROES          PIC 9(02).
           03 WSS-VAL-CAPT                        PIC 9(11)V9(04).
           03 WSS-VAL-CAJA                        PIC 9(11)V9(04).
           03 WSS-VAL-CCTE                        PIC 9(11)V9(04).
           03 WSS-CIC-ICAD                        PIC X(12).
           03 WSS-IND-TCTA                        PIC X(03).
      *       ind validacion de cliente
           03 WSS-IND-VCLI                        PIC X(01).

      *       numero de dias de liquidacion anticipada
           03 WSS-NUM-NDSLA                       PIC 9(05).
      *       CIC DEL CODIGO DE RESCATE
      * OFICINA PARA LNK-DDT
           03 WSS-NUM-OFIC                        PIC 9(03).
           03 WSS-OPD-CIC-RESC                    PIC X(12).
           03 WSS-OPD-CIC-PLPA                    PIC X(12).
           03 WSS-SGV-RESC                        PIC S9(11)V9(05).
           03 WSS-SGV-INTE                        PIC S9(11)V9(05).
           03 WSS-SGV-FINA-CVP                    PIC S9(11)V9(05).
           03 WSS-SGV-INTE-CVP                    PIC S9(11)V9(05).

      *JVM: 22/09/92 variable de control en SLA-INTE
           03 WSS-CON-INTE                        PIC 9(01).
      *JVM: 22/09/92
           03 WSS-SGV-INTE-PESO                   PIC S9(11)V9(05).
           03 WSS-SGV-CAPI                        PIC S9(11)V9(05).
           03 WSS-SGV-CAPI-PESO                   PIC S9(11)V9(05).
           03 WSS-SGV-REAJ                        PIC S9(11)V9(05).
           03 WSS-SGV-REAJ-1                      PIC S9(11)V9(05).
           03 WSS-SGV-REAJ-2                      PIC S9(11)V9(05).
           03 WSS-SGV-TPAG-PESO                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA CAPTACION ( COMANDO LIQ)
           03 WSS-SGV-VCAM-CAP                    PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA LIQUIDACION ( COMANDO LIQ)
           03 WSS-SGV-VCAM-LIQ                    PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA SOLICITUD ANTICIPADA
           03 WSS-SGV-VCAM-FSLA                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA CAPTACION
           03 WSS-SGV-VCAM-FCAP                   PIC S9(11)V9(05).
      * ISP: VALOR DE CAMBIO FECHA VENCIMIENTO
           03 WSS-SGV-VCAM-FVEN                   PIC S9(11)V9(05).
      * ISP: INDICADOR FECHA SLA: ANTES O A PARTIR DE FCAP + PERIODO
      * PLAZO PAGO
           03 WSS-IND-FEC-RESC  VALUE SPACES      PIC X(01).
              88 ANTES-FECHA-RESCATE              VALUE 'S'.
           03 WSS-FEC-FUNO.
              05 WSS-NUM-SUNO                     PIC 9(02).
              05 WSS-NUM-AUNO                     PIC 9(02).
              05 WSS-NUM-MUNO                     PIC 9(02).
              05 WSS-NUM-DUNO                     PIC 9(02).

           03 WSS-FEC-FDOS.
              05 WSS-NUM-SDOS                     PIC 9(02).
              05 WSS-NUM-ADOS                     PIC 9(02).
              05 WSS-NUM-MDOS                     PIC 9(02).
              05 WSS-NUM-DDOS                     PIC 9(02).

           03 WSS-CIC-PER                         PIC X(01).
           03 WSS-NUM-PER                         PIC 9(05).

           03 WSS-ENT-UBFD.
              05  WSS-TBL-UBFD                     PIC X(03).
              05  WSS-COD-UBFD                     PIC X(06).

      * TOTAL DIAS NO HABILES
           03  WSS-NUM-TDNH         VALUE ZEROES     PIC 9(03).
      * TOTAL DIAS HABILES
           03  WSS-NUM-TDH          VALUE ZEROES     PIC 9(03).
      *       numero de dias de renovacion automatica
           03 WSS-NUM-NDREA                          PIC 9(05).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FHOY.
               05  WSS-NUM-SHOY                      PIC 9(02).
               05  WSS-NUM-AHOY                      PIC 9(02).
               05  WSS-NUM-MHOY                      PIC 9(02).
               05  WSS-NUM-DHOY                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-CPT-NOMB VALUE SPACES.
               05  WSS-CPT-DESC                    PIC X(40).
               05  WSS-CPT-CAI                     PIC X(04).
               05  WSS-CPT-IIC                     PIC X(08).
               05  WSS-GLS-DATA                    PIC X(28).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(80).
           03  WSS-LIC-SGV-TPAG COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-LIQ-SGV-FINA COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-LIQ-NUM-TLIQ COMP-3 VALUE ZEROES PIC S9(03).
           03  WSS-PF12             VALUE 'S'       PIC  X(01).
      *JVM: 22/09/92
           03 WSS-NUM-PNTE                  PIC 9(05).
      *JVM:
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-JNL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIC-REQA==.
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPD.
                 88 PGM-STAT-OPD-NUL    VALUE '  '.
                 07 PGM-STT1-OPD        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPD-OKS VALUE '0'.
                 07 PGM-STT2-OPD        VALUE '3' PIC X(01).
              05 PGM-STAT-LIQ.
                 88 PGM-STAT-LIQ-NUL    VALUE '  '.
                 07 PGM-STT1-LIQ        VALUE '2' PIC X(01).
                    88 PGM-STAT-LIQ-OKS VALUE '0'.
                 07 PGM-STT2-LIQ        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-CAD.
                 88 PGM-STAT-CAD-NUL    VALUE '  '.
                 07 PGM-STT1-CAD        VALUE '2' PIC X(01).
                    88 PGM-STAT-CAD-OKS VALUE '0'.
                 07 PGM-STT2-CAD        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
              05 PGM-STAT-DCL.
                 88 PGM-STAT-DCL-NUL    VALUE '  '.
                 07 PGM-STT1-DCL        VALUE '2' PIC X(01).
                    88 PGM-STAT-DCL-OKS VALUE '0'.
                 07 PGM-STT2-DCL        VALUE '3' PIC X(01).
   *<<<<FIN_PGM_STAT
   *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(750).
      * DAPR0021-INI(ISP)  1-FEB-2000
      *<<<< BLLCELLS
       COPY DAPLGCCL.
      *>>>> BLLCELLS
      * DAPR0021-FIN(ISP)  1-FEB-2000

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO LIQ-FLD.
           MOVE LOW-VALUES TO LIQ-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +750 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DAPPQLIQ' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<<<INI_FIO AND NOT PGM_VSI
       PERFORM GNS-HDL-VSM.
      *<<<< INI_FIO
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      * DAPR0021-INI(ISP)  1-FEB-2000                                   
           MOVE SPACES TO MSG.
      * DAPR0021-FIN(ISP)  1-FEB-2000
           PERFORM CLR-REG-CAD.
           PERFORM CLR-REG-JNL.
           PERFORM CLR-REG-LIC.
           PERFORM CLR-REG-LIQ.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      *<<<< PGM_PQ
           IF SCR-DESDE-CMN
                MOVE SPACES TO SCR-CIC-CLI1
                               SCR-CIC-CLI2
               PERFORM BUS-OFI-CSSN
               PERFORM GET-SON
               PERFORM GET-GARA-N
               PERFORM GET-CUST-E.

      *>>>> PGM_PQ
           IF SCR-DESDE-CMN OR
              FRM-FFLD = FRM-FFLD-PF12

                MOVE 1 TO SCR-SGV-VCAM
                MOVE ZEROES TO SCR-SGV-CAPI
                               SCR-SGV-REAJ
                               SCR-SGV-MCAS.
           MOVE 'DAP' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'FUNGI' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-FUNGI.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSCAPI' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-CAPI.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSINTE' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-INTE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSSCAP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-SCAP.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSSFIN' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-SFIN.


           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSKNEW' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-KNEW.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSIPAG+' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-IPAG-GA.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSIPAG-' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-IPAG-PE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSFNEW' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-FNEW.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSINTD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-INTD.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSACEDMD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-ACED-MD.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSACEDOF' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-ACED-OF.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA-' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-PE.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA0' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-VP.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 'FRMGLSPEGA+' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DESC IN TAB TO WSS-FRM-GLS-PEGA-GA.

      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-LIQ.
           PERFORM EDT-KEY-LIQ.
           PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-LIQ
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-LIQ
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-LIQ
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-LIQ
               PERFORM EDT-KEY-LIQ
           ELSE
               PERFORM CLR-FLD-LIQ
               PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-LIQ.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO LIQ-FLD.
           MOVE LOW-VALUES TO LIQ-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
           PERFORM KEY-ALL-LIQ.
      *<<<<FND_KEY
           IF SCR-CMND NOT = 'CON'
           IF NOT SCR-OFRM-SRV OR
                  SCR-CNAL = '150'
                 MOVE 'DAP'         TO FIO-SIST
                 MOVE 'VDS'         TO TAB-COD-TTAB IN TAB
                 MOVE 'PPTPG150038' TO TAB-COD-CTAB IN TAB
                 MOVE FIO-GET-KEY  TO FIO-CMND
                 PERFORM GNS-FIO-TAB
                 IF ( FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'N' )
                         MOVE 'S' TO SCR-IERR
                         MOVE 'DAP' TO MSG-COD-SIST
                         MOVE 'LIQ3270NODIS'  TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC TO FRM-MENS
                         MOVE '00'         TO FIO-STAT
                         MOVE SCR-STAT-CON TO SCR-STAT
                         GO TO FIN-FND-KEY.

           MOVE 'N' TO WSS-PF12.
           IF LIQ-CAI-IOPD IN LIQ-FLD > SPACES OR
              LIQ-IIC-IOPD IN LIQ-FLD > ZEROES
               PERFORM GET-FRM-OPD
           ELSE
               PERFORM GET-SER-OPD.

           IF MSG-COD-MENS > SPACES
               MOVE '23'     TO FIO-STAT
               MOVE FIO-STAT TO PGM-STAT-OPD
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY
           ELSE
               MOVE '00'     TO FIO-STAT
               MOVE FIO-STAT TO PGM-STAT-OPD.



      *RVM-ADA-INI 22.02.2002
           IF SCR-CMND = 'SLA' OR
              SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               MOVE SPACES TO TAB
               MOVE 'DAP'  TO TAB-COD-SIST
               MOVE 'XLA'  TO TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = SPACES     AND
                  TAB-IND-VIGE IN TAB = 'S' AND
                ( TAB-GLS-DATA IN TAB(01:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(07:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(13:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(19:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(25:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(31:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(37:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(43:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(49:06) = OPD-COD-COPD IN OPD OR
                  TAB-GLS-DATA IN TAB(55:06) = OPD-COD-COPD IN OPD )
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'OPDNOLIQXXLA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
      *RVM-ADA-FIN 22.02.2002

      *    OBTIENE VALOR VALOR DE CAMBIO PARA MONEDA REAJUSTABLE,
      *    ES DECIR, CHILENA Y NO PESOS
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *SE DEBE VERIFICAR QUE BUSQUEDA DE CODIGO DE MONEDA SEA EXITOSO
      *EXISTENTE Y VIGENTE
           MOVE TAB-CIC-CTAB IN TAB TO SCR-CIC-VCAM.

      *        IF OPD-VAL-SCAP IN OPD NOT > ZEROES
      *           MOVE 'OPDYALIQ' TO MSG-COD-MENS
      *           GO TO END-FND-KEY
      *        ELSE
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DHOY.
           MOVE HOY-MHOY TO WSS-NUM-MHOY.
           MOVE HOY-SHOY TO WSS-NUM-SHOY.
           MOVE HOY-AHOY TO WSS-NUM-AHOY.

      *ADA-INI JSS 03-JUL-2002
      **    IF SCR-CMND = 'LIQ'
      *         IF OPD-COD-RENO NOT = 'S'
      *             MOVE 'OPDYAREN    ' TO MSG-COD-MENS
      *             GO TO END-FND-KEY.

      *ADA-INI JSS 03-JUL-2002
      **    IF SCR-CMND = 'LIQ'
      *     IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 03-JUL-2002
      *         IF WSS-FEC-FHOY < OPD-FEC-FTER IN OPD
      *             MOVE 'OPDFTER>FLIQ' TO MSG-COD-MENS
      *             GO TO END-FND-KEY.

      *ADA-INI JSS 03-JUL-2002
      **    IF SCR-CMND = 'LIQ'
      *     IF SCR-CMND = 'LIQ' OR 'LSI'
      *ADA-FIN JSS 03-JUL-2002
      *        PERFORM GET-FEC-FTER
      *        IF MSG-COD-MENS > SPACES
      *           GO TO END-FND-KEY
      *        ELSE
      *           MOVE WSS-NUM-DINI TO WSS-NUM-DTER
      *           MOVE WSS-NUM-MINI TO WSS-NUM-MTER
      *           MOVE WSS-NUM-SINI TO WSS-NUM-STER
      *           MOVE WSS-NUM-AINI TO WSS-NUM-ATER
      *           PERFORM GET-FHOY
      *           MOVE HOY-DHOY TO WSS-NUM-DHOY
      *           MOVE HOY-MHOY TO WSS-NUM-MHOY
      *           MOVE HOY-SHOY TO WSS-NUM-SHOY
      *           MOVE HOY-AHOY TO WSS-NUM-AHOY
      *           IF WSS-FEC-FHOY > WSS-FEC-FTER
      *              MOVE 'DAP' TO MSG-COD-SIST
      *              MOVE 'OPDYAREN' TO MSG-COD-MENS
      *              PERFORM GET-MSG
      *              MOVE MSG-GLS-DESC TO FRM-MENS
      *              MOVE '00'         TO FIO-STAT
      *              MOVE SCR-STAT-CON TO SCR-STAT
      *              GO TO FIN-FND-KEY.

      *JVM: 22/09/92
      *ADA-INI JSS 03-JUL-2002
      *    IF SCR-CMND = 'LIQ' OR 'SLA'
           IF SCR-CMND = 'LIQ' OR 'SLA' OR 'LVP' OR 'CVP' OR 'LSI' OR
                                           'LRP' OR 'CRP' OR 'REV'
      *ADA-FIN JSS 03-JUL-2002
              IF OPD-COD-RENO IN OPD = 'S' AND
                 OPD-FEC-FREA IN OPD NOT = OPD-FEC-FPCO IN OPD
      *ADA-INI JSS-05-JUL-2002
      *          PERFORM VAL-PER-REN
                 IF SCR-CMND = 'LSI'
                     PERFORM VAL-PER-LSI
                 ELSE
      *              MOVE 'VAL1' TO QUE-COLA
      *              MOVE +12 TO QUE-LITM
      *              MOVE SPACES TO QUE-ITEM
      *              MOVE QUE-PUT TO QUE-CMND
      *              PERFORM GNS-PRO-QUE
      *
                     PERFORM VAL-PER-REN
                 END-IF
      *ADA-FIN JSS-05-JUL-2002
                 IF MSG-COD-MENS > SPACES
                    GO TO END-FND-KEY.

      *JVM:

           IF SCR-CCPP = 'ING'
               MOVE SCR-COD-OFIC TO LIQ-COD-OFIC IN LIQ-FLD
      *        IF SCR-OFRM-SRV
      *            MOVE OPD-COD-OFIC IN OPD TO LIQ-COD-OFIC IN LIQ-FLD
      *            MOVE OPD-COD-EJEC IN OPD TO LIQ-COD-EJEC IN LIQ-FLD
      *        END-IF
               PERFORM PUT-OPD-LIQ.

           PERFORM GET-CUR-RCC.
           IF NOT FIO-STAT-OKS
      *        OPD no tiene cliente asociado
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPD    NORCC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
      *        cliente inexistente
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-CLI1.

           PERFORM GET-NXT-RCC.
           IF SCR-CCPP = 'ING'
               PERFORM PUT-DBC-LIQ.

           MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           MOVE FIO-STAT TO PGM-STAT-VEN.
           IF NOT FIO-STAT-OKS
      *        vencimiento inexistente
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF SCR-CCPP = 'ING'
               PERFORM PUT-VEN-LIQ.

           MOVE SPACES TO MSG-COD-MENS.

       END-FND-KEY.

           IF MSG-COD-MENS > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF LIQ-NUM-ILIQ IN LIQ-FLD NOT > ZEROES
                PERFORM BUS-COR-LIQ.

           MOVE LIQ-KEY-ILIQ IN LIQ TO DCL-KEY-ILIQ IN DCL.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM DAP-FIO-DCL.
           MOVE FIO-STAT TO PGM-STAT-DCL.
      *>>>>
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS
               MOVE LIQ-STP-ITRN IN LIQ TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-LIQ.
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.

           MOVE '00' TO PGM-STAT-LIQ.

           IF SCR-CCPP = 'ING'
               GO TO REC-LIQ-STAT.

           PERFORM FND-KEY-CAD.

       REC-LIQ-STAT.
           MOVE PGM-STAT-LIQ TO FIO-STAT.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-LIQ-OKS
               MOVE LIQ-STP-ITRN IN LIQ TO SCR-UMOD.
           PERFORM PUT-ALL-LIQ.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *<<<< INI_SCR_PUTA
           IF SCR-NEMO = 'DAPACTLIR' OR
              SCR-OFRM-SRV
                MOVE WSS-FRM-GLS-CAPI TO FRM-GLS-CAPI
                MOVE WSS-FRM-GLS-INTE TO FRM-GLS-INTE
                MOVE WSS-FRM-GLS-SCAP TO FRM-GLS-SCAP
                MOVE WSS-FRM-GLS-SFIN TO FRM-GLS-SFIN
                MOVE WSS-FRM-GLS-KNEW TO FRM-GLS-KNEW
                MOVE WSS-FRM-GLS-FNEW TO FRM-GLS-FNEW
                MOVE WSS-FRM-GLS-INTD TO FRM-GLS-INTD
                MOVE WSS-FRM-GLS-ACED-MD TO FRM-GLS-ACED
           ELSE
                MOVE SPACES TO FRM-GLS-CAPI IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-INTE IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-SCAP IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-SFIN IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-KNEW IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-FNEW IN LIQ-FLD
                MOVE SPACES TO FRM-GLS-INTD IN LIQ-FLD
                MOVE SPACES TO LIQ-SGV-CAPI-ALF
                MOVE SPACES TO FRM-SGV-INTE-ALF
                MOVE SPACES TO OPD-VAL-SCAP-ALF
                MOVE SPACES TO VEN-VAL-SFIN-ALF
                MOVE SPACES TO DCL-SGV-KNEW-ALF
                MOVE SPACES TO FRM-SGV-IPAG-ALF
                MOVE SPACES TO DCL-SGV-FNEW-ALF
                MOVE SPACES TO DCL-SGV-INTD-ALF
                MOVE SPACES TO DCL-SGV-PEGA-ALF
                MOVE WSS-FRM-GLS-ACED-OF TO FRM-GLS-ACED.
      *>>>> INI_SCR_PUTA
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE LIQ-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO LIQ-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-LIQ
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-LIQ.
           PERFORM VAL-IKY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-LIQ.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-LIQ.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LIQ.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-LIQ
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-LIQ
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-LIQ.
           PERFORM VAL-IKY-LIQ.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-LIQ.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-LIQ.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-LIQ.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LIQ-GLS-MEN2
               MOVE SCR-PRMT     TO LIQ-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LIQ-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO LIQ-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LIQ-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LIQ-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-LIQ

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LIQ-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LIQ-GLS-MENS.
           PERFORM PRO-MKY-LIQ.
           PERFORM PRO-AKY-LIQ.
           PERFORM UNP-IKY-LIQ.
           PERFORM FST-KEY-LIQ.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LIQ-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LIQ-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LIQ-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LIQ-GLS-MENS.
           PERFORM UNP-KEY-LIQ.
           PERFORM FST-KEY-LIQ.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-LIQ.
           PERFORM PRO-AKY-LIQ.
           PERFORM UNP-MKY-LIQ.
           PERFORM UNP-FLD-LIQ.
           PERFORM FST-FLD-LIQ.
      *<<<< FIN_HBL_FLD
           MOVE FRM-CPIM-AEY TO LIQ-COD-OFIC-ATR IN LIQ-FLD.
           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-LIQ
               PERFORM UNP-CAD-LIQ.
      *>>>> FIN_HBL_FLD
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO LIQ-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-LIQ.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
      *<<<< FIN_SCR_TRL
           PERFORM GET-FHOY.
      * JVM: Inicio 24/06/92
      *     IF MSG-COD-MENS > SPACES
      *        GO TO ERR-SCR-TRL.
      * JVM: Fin
           MOVE SPACES TO MSG-COD-MENS.
           GO TO NOT-PROC-SLA.
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'DAP' TO FIO-SIST.
           MOVE 'SLA' TO TAB-COD-TTAB IN TAB.
           MOVE 'USER' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SLANOTAB' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

           IF TAB-IND-VIGE IN TAB = 'N'
               MOVE 'SLANOVIG' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

           IF TAB-GLS-DCOR IN TAB NOT = SCR-USER OR
              TAB-GLS-DCOR IN TAB = SPACES
               MOVE 'SLANOUSER' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

       NOT-PROC-SLA.

           IF PGM-STAT-OPD-OKS
           IF OPD-COD-IONP IN OPD = 'S' AND
              WSS-PF12 = 'N'
      *        opd con onp
               MOVE 'OPD    ONP' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

           IF PGM-STAT-OPD-OKS
           IF OPD-COD-GARA IN OPD NOT = SCR-COD-GARA-N AND
              WSS-PF12 = 'N'
      *        opd con garantia
               MOVE 'OPD    GAR' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.
      *
           IF PGM-STAT-OPD-OKS
           IF OPD-COD-CUST IN OPD = SCR-COD-CUST-E AND
              WSS-PF12 = 'N'
      *        opd con custodia electronica
      *ADA-INI JSS 03-JUL-2002
      *Permite liquidar en custodia electronica con comando LSI
               IF SCR-CMND = 'LSI'
                   NEXT SENTENCE
               ELSE
      *Permite modificar liquidaciones en custodia electronica en
      *estado T con comando MCA
               IF SCR-CMND = 'MCA'
                   NEXT SENTENCE
               ELSE
      *Permite reversar en custodia electronica a las
      *liquidaciones contables, en estado A y de DAP fijos
               IF SCR-CMND = 'REV' AND
      *ADA-INI 04-MAY-2004
      *           CAD-IND-TCAD IN LIQ-FLD = 'CTBL' AND
                ( CAD-IND-TCAD IN LIQ-FLD = 'CTBL' OR
                  CAD-IND-TCAD IN LIQ-FLD = 'CCMA' ) AND
      *ADA-FIN 04-MAY-2004
                  LIQ-COD-STAT IN LIQ     = 'A'
                   NEXT SENTENCE
               ELSE
      *ADA-FIN JSS 03-JUL-2002
               IF NOT ( SCR-CMND = 'CON' OR 'CVP' OR 'CRP' )
                IF SCR-CNAL NOT = '100' AND
                   SCR-CNAL NOT = '110' AND
                   SCR-CNAL NOT = '150'

               MOVE 'LIQSLAERRCUE' TO MSG-COD-MENS
               PERFORM VRF-PRV-CUST-E
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-SCR-TRL.

      *ADA-INI JSS 03-JUL-2002
      *Valida que comando LSI solo sea ocupado para custodia electronica
      *para liquidaciones en estado 'T', operaciones fijas,
      *en estado L, situacion contable VCD y liq con abono Contable
           IF PGM-STAT-OPD-OKS
           IF WSS-PF12 = 'N'
           IF SCR-CMND = 'LSI' AND NOT
              ( OPD-COD-CUST IN OPD     = SCR-COD-CUST-E AND
                LIQ-COD-STAT IN LIQ-FLD = 'T'            AND
                ( OPD-COD-STAT IN OPD = 'L' OR
                  LIQ-COD-LIQU IN LIQ = 'LR' )          AND
                ( OPD-COD-SCTB IN OPD = 'VCD' OR
                  OPD-COD-SCTB IN OPD = 'VIG' )          AND
      *ADA-INI 04-MAY-2004
      *         CAD-IND-TCAD IN LIQ-FLD = 'CTBL' )
               (  CAD-IND-TCAD IN LIQ-FLD = 'CTBL' OR
                  CAD-IND-TCAD IN LIQ-FLD = 'CCMA'  ) )
      *ADA-FIN 04-MAY-2004
               MOVE 'LSIETLVVCTBL' TO MSG-COD-MENS

               GO TO ERR-SCR-TRL.
      *Valida que comando MCA solo sea ocupado en custodia electronica
      *para liquidaciones en estado 'T', operaciones fijas,
      *en estado L y situacion contable VCD
           IF PGM-STAT-OPD-OKS
           IF WSS-PF12 = 'N'
           IF SCR-CMND = 'MCA' AND NOT
              ( OPD-COD-CUST IN OPD      = SCR-COD-CUST-E AND
                ( LIQ-COD-STAT IN LIQ-FLD = 'T'   OR
                  LIQ-COD-STAT IN LIQ-FLD = 'S' )         AND
                OPD-COD-STAT IN OPD       = 'L'           AND
                ( OPD-COD-SCTB IN OPD     = 'VCD' OR
                  OPD-COD-SCTB IN OPD     = 'VIG' ) )
               MOVE 'MCAETSLVDVI' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.
      *ADA-FIN JSS 03-JUL-2002

      *
      *JUS-INI 6-NOV-1995
      *ISI-INI  27-MAY-1996 17:00:32
      *     IF PGM-STAT-OPD-OKS
      *     IF OPD-COD-CUST IN OPD = 'S' AND
      *        WSS-PF12 = 'N'
      **        opd con custodia
      *         MOVE 'OPD   CUST' TO MSG-COD-MENS
      *         GO TO ERR-SCR-TRL.
      *JUS-FIN

      *     IF NOT ( OPD-COD-STAT IN OPD = 'G' OR 'A' )
      *        OPD CON STATUS INVALIDO
      *         MOVE 'OPD    NE' TO MSG-COD-MENS
      *         GO TO ERR-SCR-TRL.

           IF NOT PGM-STAT-LIQ-OKS
               GO TO END-SCR-TRL.

           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
              IF LIQ-COD-CMND IN LIQ NOT = 'S' AND
                  LIQ-COD-CMND IN LIQ NOT = 'L'
      *  'REV'ERSA SOLO PARA RESCATES
                       MOVE 'REVSOLORSC' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.


           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
               IF NOT ( HOY-SHOY = LIQ-NUM-STRN IN LIQ AND
                        HOY-AHOY = LIQ-NUM-ATRN IN LIQ AND
                        HOY-MHOY = LIQ-NUM-MTRN IN LIQ AND
                        HOY-DHOY = LIQ-NUM-DTRN IN LIQ )
      *  'REV'ERSA NO ES DEL DIA
                       MOVE 'REVNOHOY' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.
           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
               IF OPD-VAL-SCAP IN OPD > ZEROES AND
                  LIQ-COD-LIQU NOT = 'RP'
                     MOVE 'OPDNOLIQ' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.

           IF SCR-CMND = 'REV' AND
              WSS-PF12 = 'N'
                  IF WSS-TOT-AUTO = 1
      *               LIQ con cargo automatico
                       MOVE 'LIQREV AUTO' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL
                  ELSE
                  IF WSS-TOT-CAJA = 1 AND
                     LIQ-COD-STAT IN LIQ NOT = 'S'
      *                LIQ no 'S'
                       MOVE 'LIQ    NS' TO MSG-COD-MENS
                       GO TO ERR-SCR-TRL.

           IF SCR-CMND = 'ELI' AND
              WSS-PF12 = 'N' AND
              LIQ-COD-STAT IN LIQ NOT = 'P'
      *        LIQ no 'P'
               MOVE 'LIQ    NP' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

      *ADA-INI JSS 03-JUL-2002
      *    IF SCR-CMND = 'LIQ' AND
           IF ( SCR-CMND = 'LIQ' OR 'LSI' ) AND
      *ADA-FIN JSS 03-JUL-2002
              WSS-PF12 = 'N' AND
              LIQ-COD-STAT IN LIQ NOT = 'T'
      *        LIQ no 'T'
               MOVE 'LIQ    NT' TO MSG-COD-MENS
               GO TO ERR-SCR-TRL.

       ERR-SCR-TRL.
           IF MSG-COD-MENS > SPACES
      * PTC-INI ( RRM )
               MOVE 'S' TO SCR-IERR
      * PTC-FIN ( RRM )
      *GET-MSG Busca mensaje en tabla
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO WSS-MSG-DESC
               MOVE MSG-GLS-DATA TO WSS-MSG-DATA
               MOVE WSS-MSG TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.

       END-SCR-TRL.
      *>>>>
      *>>>>
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LIQ
               PERFORM EDT-FLD-LIQ
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LIQ.
           PERFORM EDT-FLD-LIQ.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY DAPBQLIQ.
       COPY GNSBVNUM.
       COPY DAPBFLIQ.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSX.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
        COPY TABBVOFI.
        COPY TABBVUSR.

        VRF-PRV-CUST-E SECTION.
       INI-VRF-PRV-CUST-E.
           IF SCR-OFRM-SRV
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               MOVE 'DAPPULIQ/CUE'    TO USP-STRING
               MOVE WSS-IDN-SIST      TO USP-SISTEMA
               MOVE SPACES            TO USP-PERMISO
               MOVE 'DAP'             TO USP-GRUPO
               MOVE SCR-USER          TO USP-USUARIO
               PERFORM USPC107
               IF USP-PERMISO = 'P'
                   MOVE SPACES TO MSG-COD-MENS.
       FIN-VRF-PRV-CUST-E.
           EXIT.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
      *     PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
       COPY DAPBCCAD.
       COPY DAPBCJNL.
       COPY DAPBCLIC.
       COPY DAPBCLIQ.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFDCL.
       COPY DAPBFTOD.
       COPY DAPBFCAD.
       COPY DAPBFVEN.
       COPY DAPBFRCC.
       COPY DAPBFLIC.
       COPY DAPBFJNL.

      *Entidades de GNS
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBGINT.
       COPY GNSBVCOD.
       COPY GNSBVTAB.

      *Entidades de TAB
       COPY TABBFCAM.

      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       CAL-SGV-TPAG SECTION.
       INI-CAL-SGV-TPAG.
      * VALOR DE LIC EN PESOS
      *     MOVE PDB-CIC-0999        TO TAB-CIC-CTAB IN TAB.
      *     MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
      *     MOVE VEN-NUM-DVEN IN VEN TO TAB-NUM-DTRN IN TAB.
      *     MOVE VEN-NUM-MVEN IN VEN TO TAB-NUM-MTRN IN TAB.
      *     MOVE VEN-NUM-SVEN IN VEN TO TAB-NUM-STRN IN TAB.
      *     MOVE VEN-NUM-AVEN IN VEN TO TAB-NUM-ATRN IN TAB.
      *     PERFORM GET-VCAM.
      *     IF MSG-COD-MENS NOT = SPACES
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         GO TO FIN-CAL-SGV-TPAG.

       FIN-CAL-SGV-TPAG.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'DAP' TO FIO-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       GET-SER-OPD SECTION.
       INI-GET-SER-OPD.
      * ISP: FND-KEY YA PUSO LAS LLAVES DEL SERIAL EN OPD
      * ISP: ASUME OPERACION NO ENCONTRADA
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'OPD-CIC-ISER' TO FIO-AKEY.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'OPD    NEX' TO MSG-COD-MENS
           ELSE
              IF SCR-CMND = 'SLA' OR
                 SCR-CMND = 'LVP' OR
                 SCR-CMND = 'CVP' OR
                 SCR-CMND = 'LRP' OR
                 SCR-CMND = 'CRP'
                  IF OPD-COD-STAT IN OPD = 'G'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ
                  ELSE
                      IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                          MOVE 'OPDYALIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
              IF SCR-CMND = 'REV'
                  IF OPD-COD-STAT IN OPD = 'L'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ
                  ELSE
                      IF OPD-VAL-SCAP IN OPD > ZEROES
                         NEXT SENTENCE
      *                  MOVE 'OPDNOLIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
      * ISP : OPD EXISTENTE PARA EL RESTO DE LOS COMANDOS
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ-FLD
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ-FLD
                      MOVE OPD-CAI-IOPD IN OPD TO
                           LIQ-CAI-IOPD IN LIQ
                      MOVE OPD-IIC-IOPD IN OPD TO
                           LIQ-IIC-IOPD IN LIQ.
       FIN-GET-SER-OPD.
           EXIT.

       GET-FRM-OPD SECTION.
       INI-GET-FRM-OPD.
      * ISP: OBTIENE OPD DESDE LA PANTALLA
           MOVE SPACES TO MSG-COD-MENS.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO OPD-IIC-IOPD IN OPD.
           PERFORM GET-OPD.
           IF FIO-STAT-OKS
              IF SCR-CMND = 'SLA' OR
                 SCR-CMND = 'LVP' OR
                 SCR-CMND = 'CVP' OR
                 SCR-CMND = 'LRP' OR
                 SCR-CMND = 'CRP'
                  IF OPD-COD-STAT IN OPD = 'G'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE SPACES TO MSG-COD-MENS
                  ELSE
                      IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                          MOVE 'OPDYALIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'G'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
              IF SCR-CMND = 'REV'
                  IF OPD-COD-STAT IN OPD = 'L'
      * ISP : OPD EXISTENTE Y EMITIDA
                      MOVE SPACES TO MSG-COD-MENS
                  ELSE
                      IF OPD-VAL-SCAP IN OPD > ZEROES
                         NEXT SENTENCE
      *                  MOVE 'OPDNOLIQ' TO MSG-COD-MENS
                      ELSE
      * ISP : OPD PERTENECE A SERIAL NO LIQ, PERO CON ESTADO <> 'E'
                          MOVE 'OPDSTATERR' TO MSG-COD-MENS
              ELSE
      * ISP : OPD EXISTENTE PARA EL RESTO DE LOS COMANDOS
                      MOVE SPACES TO MSG-COD-MENS
           ELSE
              IF SCR-CMND = 'REV'
                  MOVE 'LIQ    NEX' TO MSG-COD-MENS.
       FIN-GET-FRM-OPD.
           EXIT.

       GET-OPD SECTION.
       INI-GET-OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
                 MOVE 'OPD    NEX' TO MSG-COD-MENS.
           MOVE FIO-STAT TO PGM-STAT-OPD.
       FIN-GET-OPD.
           EXIT.

       GET-CUR-CAD SECTION.
       INI-GET-CUR-CAD.
           MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
           MOVE 1                   TO CAD-NUM-ICAD IN CAD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           MOVE FIO-STAT TO PGM-STAT-CAD.
       FIN-GET-CUR-CAD.
           EXIT.

       GET-UPD-CAD SECTION.
       INI-GET-UPD-CAD.
      *     IF CAD-IND-TCAD IN LIQ-FLD = 'M'
      *         GO TO FIN-GET-UPD-CAD.
      *     MOVE LIQ-CIC-IOPD IN LIQ TO CAD-CIC-IOPD IN CAD.
      *     MOVE LIQ-NUM-ILIQ IN LIQ TO CAD-NUM-ILIQ IN CAD.
      *     MOVE 1                   TO CAD-NUM-ICAD IN CAD.
      * LEE DE UPDATE REGISTRO CAD YA SELECCIONADO POR FND-KEY-CAD
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-CAD
      *    como la transaccion Termina no es necesario hacer UNLOCK de
      *    CAD
      *    comunicar que no se pudo actualizar con mensaje pertinente
           ELSE
               MOVE '00' TO PGM-STAT-CAD.
       FIN-GET-UPD-CAD.
           EXIT.

       GET-UPD-DCL SECTION.
       INI-GET-UPD-DCL.
           MOVE LIQ-KEY-ILIQ IN LIQ TO DCL-KEY-ILIQ IN DCL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-DCL.
           MOVE FIO-STAT TO PGM-STAT-DCL.
       FIN-GET-UPD-DCL.
           EXIT.
           
       GET-FEC-FTER SECTION.
       INI-GET-FEC-FTER.
      * OBTIENE FECHA DE TERMINO COM OPD-FEC-FTER + EL TOTAL DE DIAS
      * HABILES PARA LIQUIDAR (PARAMETRO = NDREA)

           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'DAP'   TO TAB-COD-SIST.
           MOVE 'REA'   TO TAB-COD-TTAB IN TAB.
           MOVE 'NDREA' TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
              MOVE 'NDREANEX' TO MSG-COD-MENS
              GO TO FIN-GET-FEC-FTER
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO NUM-NUME
              MOVE NUM-ZERO-N TO NUM-ZERO
              MOVE NUM-SGNO-N TO NUM-SGNO
              MOVE 5 TO NUM-NENT
              MOVE 0 TO NUM-NDCM
              PERFORM VAL-NUM
              IF NUM-STAT-OKS
                 MOVE NUM-NN9N TO WSS-NUM-NDREA
              ELSE
                 MOVE 'NDREANONUM' TO MSG-COD-MENS
                 GO TO FIN-GET-FEC-FTER.

           MOVE OPD-NUM-DTER IN OPD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE OPD-NUM-MTER IN OPD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE OPD-NUM-STER IN OPD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE OPD-NUM-ATER IN OPD TO WSS-NUM-AINI IN WSS-VARI.

      * BUS-PRIMER-DIA-HABIL
           MOVE 0 TO WSS-NUM-TDH.
           MOVE 0 TO WSS-NUM-TDNH.
           MOVE WSS-FEC-FINI TO FEC-FECH.
       BUS-PDH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           ADD 1 TO WSS-NUM-TDNH.
           IF FEC-STAT-HBL
              ADD 1 TO WSS-NUM-TDH
              IF WSS-NUM-TDH = WSS-NUM-NDREA
                 GO TO NOT-BUS-PDH.
           GO TO BUS-PDH.

       NOT-BUS-PDH.
           IF WSS-NUM-TDH > ZEROES
               MOVE WSS-FEC-FINI        TO FEC-FECH
               MOVE FEC-FORM-FEC        TO FEC-FORM
               MOVE FEC-SUM-DIA         TO FEC-CMND
               MOVE WSS-NUM-TDNH        TO FEC-NDIA
               PERFORM CAL-FEC
               MOVE FEC-FECH TO WSS-FEC-FINI.
       FIN-GET-FEC-FTER.
           EXIT.

       FND-KEY-CAD SECTION.
       INI-FND-KEY-CAD.
           MOVE ZEROES TO WSS-TOT-MANU.
           MOVE ZEROES TO WSS-TOT-CAJA.
           MOVE ZEROES TO WSS-TOT-AUTO.
           MOVE ZEROES TO WSS-VAL-CAPT.
           MOVE ZEROES TO WSS-VAL-CAJA.
           MOVE ZEROES TO WSS-VAL-CCTE.
           MOVE SPACES TO WSS-CIC-ICAD.
           MOVE SPACES TO WSS-IND-TCTA.

           PERFORM FST-CAD-CAD.
           PERFORM DAP-FIO-CAD.
           IF NOT ( FIO-STAT-OKS AND
              LIQ-CAI-IOPD IN LIQ-FLD = CAD-CAI-IOPD IN CAD AND
              LIQ-IIC-IOPD IN LIQ-FLD = CAD-IIC-IOPD IN CAD AND
              LIQ-NUM-ILIQ IN LIQ-FLD = CAD-NUM-ILIQ IN CAD )
               MOVE FIO-STAT TO PGM-STAT-CAD
               GO TO FIN-FND-KEY-CAD.

       LUP-FND-KEY-CAD.
      *    sumatoria de montos cargos  ( para vrf )
           ADD  CAD-SGV-LIQU IN CAD TO WSS-VAL-CAPT.

      *BUS-MSC busca miscelaneo en tabla
           MOVE 'TAB'  TO MSC-COD-SIST.
           MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
           MOVE CAD-IND-TCAD IN CAD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-COD-DAT2 IN MSC(5) TO WSS-IND-GCAD.
           IF WSS-IND-GCAD = 'M'
      *        incrementa contador cargos 'manuales' (maximo 1)
               ADD 1 TO WSS-TOT-MANU.
           IF WSS-IND-GCAD = 'A'
      *        incrementa contador cargos 'automaticos' (maximo 1)
               ADD 1 TO WSS-TOT-AUTO
      *        monto de cargo automatico
               MOVE CAD-SGV-LIQU IN CAD TO WSS-VAL-CCTE.

           IF MSC-CIC-MSCL IN MSC = 'TCYACAJA'
      *        incrementa contador cargos 'caja' (maximo 1)
               ADD 1 TO WSS-TOT-CAJA
      *        monto a enterar en 'caja'
      *         MOVE CAD-SGV-LIQU IN CAD TO WSS-VAL-CAJA
           ELSE
           IF ( MSC-CIC-MSCL IN MSC = 'TCYACC'  OR
                MSC-CIC-MSCL IN MSC = 'TCYACA' ) AND
              WSS-IND-GCAD = 'A'
      *        cuenta cte de cargo
               MOVE CAD-CIC-ICAD IN CAD TO WSS-CIC-ICAD
               IF MSC-CIC-MSCL IN MSC = 'TCYACC'
      *           informa que es cta cte
                  MOVE 'CCT' TO WSS-IND-TCTA
               ELSE
      *           informa que es cta aho
                  MOVE 'AHO' TO WSS-IND-TCTA.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
           IF FIO-STAT-OKS AND
              ( LIQ-CAI-IOPD IN LIQ-FLD = CAD-CAI-IOPD IN CAD AND
                LIQ-IIC-IOPD IN LIQ-FLD = CAD-IIC-IOPD IN CAD AND
                LIQ-NUM-ILIQ IN LIQ-FLD = CAD-NUM-ILIQ IN CAD )
               MOVE 'M' TO SCR-IND-MCAD
               GO TO LUP-FND-KEY-CAD.
       FIN-LUP-FND-KEY-CAD.

           IF SCR-IND-MCAD NOT = 'M'
               PERFORM FST-CAD-CAD
               PERFORM DAP-FIO-CAD.

           MOVE FIO-STAT TO PGM-STAT-CAD.
       FIN-FND-KEY-CAD.
           EXIT.

       FST-CAD-CAD SECTION.
       INI-FST-CAD-CAD.
           MOVE LIQ-CAI-IOPD IN LIQ-FLD TO CAD-CAI-IOPD IN CAD.
           MOVE LIQ-IIC-IOPD IN LIQ-FLD TO CAD-IIC-IOPD IN CAD.
           MOVE LIQ-NUM-ILIQ IN LIQ-FLD TO CAD-NUM-ILIQ IN CAD.
           MOVE SPACES                  TO CAD-NUM-ICAD IN CAD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       FIN-FST-CAD-CAD.
           EXIT.
       USPC107 SECTION.
       INI-USPC107.
      *    COPY USPC107.

      *********************************************
      *           MODULO   USPC107                *
      *********************************************
      *     PARRAFO DE LLAMADA RUTINA USDR107     *
      *********************************************
      *INI-PENTA 19-07-2013
      *
      *    EXEC CICS LINK PROGRAM('USDR107')
      *                   COMMAREA (USP-VARIABLES)
      *                   LENGTH(31)
      *    END-EXEC.
      *FIN-PENTA
      *
      *********************************************
      *           FIN   MODULO   USPC107          *
      *********************************************

       FIN-USPC107.
           EXIT.
      *>>>>
      *<<<< EOF_PQ
       PRO-FLD-LIQ SECTION.
       INI-PRO-FLD-LIQ.
           PERFORM PRO-OPD-LIQ.
           PERFORM PRO-LIQ-LIQ.
           PERFORM PRO-DBC-LIQ.
           PERFORM PRO-VEN-LIQ.
           PERFORM PRO-CAD-LIQ.
       FIN-PRO-FLD-LIQ.
           EXIT.
       PRO-OPD-LIQ SECTION.
       INI-PRO-OPD-LIQ.
       FIN-PRO-OPD-LIQ.
           EXIT.

       PRO-LIQ-LIQ SECTION.
       INI-PRO-LIQ-LIQ.
           MOVE FRM-CPIM-AEY TO LIQ-COD-OFIC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-COD-EJEC-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-FEC-FREA-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO LIQ-FEC-FCTB-ATR IN LIQ-FLD.
      *    MOVE FRM-CPIM-AEY TO LIQ-SGV-GAST-ATR IN LIQ-FLD.
       FIN-PRO-LIQ-LIQ.
           EXIT.

       PRO-DBC-LIQ SECTION.
       INI-PRO-DBC-LIQ.
       FIN-PRO-DBC-LIQ.
           EXIT.

       PRO-VEN-LIQ SECTION.
       INI-PRO-VEN-LIQ.
       FIN-PRO-VEN-LIQ.
           EXIT.

       PRO-OPD-LIQ SECTION.
       INI-PRO-OPD-LIQ.
       FIN-PRO-OPD-LIQ.
           EXIT.

       PRO-CAD-LIQ SECTION.
       INI-PRO-CAD-LIQ.
           MOVE FRM-CPIM-AEY TO CAD-IND-TCAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO CAD-CAI-ICAD-ATR IN LIQ-FLD.
           MOVE FRM-CPIM-AEY TO CAD-IIC-ICAD-ATR IN LIQ-FLD.
       FIN-PRO-CAD-LIQ.
           EXIT.

       BUS-OFI-CSSN SECTION.
       INI-BUS-OFI-CSSN.
      *    IF SCR-OFRM-SRV
      *        GO TO FIN-BUS-OFI-CSSN.
           MOVE 'TRNID' TO QUE-COLA.
           MOVE EIBTRNID TO QUE-ITEM.
           MOVE +12 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.

           IF SCR-OFRM-SRV AND SCR-USER NOT > SPACES AND
              ( SCR-CNAL = '110' OR
                SCR-CNAL = '100' )
                MOVE 'WEBBCI' TO SCR-USER.
       COPY DAPBG005.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE 'USRCSSNNEX' TO MSG-COD-MENS
               MOVE 'S' TO SCR-IERR
               PERFORM GOTO-CMN
           ELSE
               MOVE USR-COD-OFUS IN USR TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               IF MSG-COD-MENS > SPACES
                   MOVE 'S' TO SCR-IERR
                   MOVE 'OFICSSNNEX' TO MSG-COD-MENS
                   PERFORM GOTO-CMN
               ELSE
                   MOVE USR-COD-OFUS IN USR TO SCR-COD-OFIC.
       FIN-BUS-OFI-CSSN.
           EXIT.

       GET-SON SECTION.
       INI-GET-SON.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-CIC-TTAB IN TAB.
           MOVE 'S'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'GNSSONSNEX' TO MSG-COD-MENS
               PERFORM GOTO-CMN
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO SCR-SON-S.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-CIC-TTAB IN TAB.
           MOVE 'N'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'GNSSONNNEX' TO MSG-COD-MENS
               PERFORM GOTO-CMN
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO SCR-SON-N.
       FIN-GET-SON.
           EXIT.

       GET-GARA-N SECTION.
       INI-GET-GARA-N.
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'GAR' TO TAB-CIC-TTAB IN TAB.
           MOVE 'N'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAPGARN' TO MSG-COD-MENS
               PERFORM GOTO-CMN
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO SCR-COD-GARA-N.
       FIN-GET-GARA-N.
           EXIT.

       GET-CUST-E SECTION.
       INI-GET-CUST-E.
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'CUS' TO TAB-CIC-TTAB IN TAB.
           MOVE 'E'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'CICCUSENEX' TO MSG-COD-MENS
               PERFORM GOTO-CMN
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO SCR-COD-CUST-E.
       FIN-GET-CUST-E.
           EXIT.

       GOTO-CMN SECTION.
       INI-GOTO-CMN.
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-INST-HCM TO SCR-INST.
           PERFORM SCR-COM.
       FIN-GOTO-CMN.
           EXIT.

       BUS-FEC-FLRE SECTION.
       INI-BUS-FEC-FLRE.
           MOVE OPD-IND-PLRE IN OPD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

      *RVM-CST-INI 20-NOV-1996
      *PARA DAP RENOVABLES EN UF, SE CALCULA CON FECHA DE RENOVACION
      *     MOVE OPD-NUM-DPCO IN OPD TO FEC-ITM1.
      *     MOVE OPD-NUM-MPCO IN OPD TO FEC-ITM2.
      *     MOVE OPD-NUM-SPCO IN OPD TO FEC-ITM3.
      *     MOVE OPD-NUM-APCO IN OPD TO FEC-ITM4.
           MOVE OPD-NUM-DREA IN OPD TO FEC-ITM1.
           MOVE OPD-NUM-MREA IN OPD TO FEC-ITM2.
           MOVE OPD-NUM-SREA IN OPD TO FEC-ITM3.
           MOVE OPD-NUM-AREA IN OPD TO FEC-ITM4.
      *RVM-CST-FIN 20-NOV-1996
           MOVE OPD-NUM-PLRE IN OPD TO WSS-NUM-PER.
           PERFORM SEL-PER.
           MOVE FEC-FECH TO FRM-FEC-FLRE IN LIQ-FLD.
           IF SCR-CMND = 'LVP' OR
              SCR-CMND = 'CVP' OR
              SCR-CMND = 'LRP' OR
              SCR-CMND = 'CRP'
               MOVE ZEROES TO FRM-FEC-FLRE IN LIQ-FLD.

       FIN-BUS-FEC-FLRE.
           EXIT.

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE OPD-CIC-IOPD IN OPD TO RCC-CIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
      *RFU     MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                   OPD-CIC-IOPD IN OPD = RCC-CIC-IOPD IN RCC)
              MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CIC-IOPD IN OPD = RCC-CIC-IOPD IN RCC
                MOVE RCC-CIC-IOPD IN RCC TO SCR-CIC-CLI2
                MOVE 'M' TO SCR-IND-MCLI
                MOVE 'DAP'          TO MSG-COD-SIST
                MOVE 'OPD    MCLI' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MCLI
                PERFORM GET-CUR-RCC.
       FIN-GET-NXT-RCC.
           EXIT.

       BUS-COR-LIQ SECTION.
       INI-BUS-COR-LIQ.
           MOVE 999 TO LIQ-NUM-ILIQ IN LIQ.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF FIO-STAT-OKS AND
              LIQ-CAI-IOPD IN LIQ-FLD = LIQ-CAI-IOPD IN LIQ AND
              LIQ-IIC-IOPD IN LIQ-FLD = LIQ-IIC-IOPD IN LIQ AND
              SCR-CCPP = 'ING' AND
              LIQ-COD-LIQU IN LIQ = 'RC'
                 MOVE LIQ-NUM-ILIQ IN LIQ TO LIQ-NUM-ILIQ IN LIQ-FLD
              GO TO FIN-BUS-COR-LIQ.

           IF NOT ( FIO-STAT-OKS AND
                    LIQ-CAI-IOPD IN LIQ-FLD = LIQ-CAI-IOPD IN LIQ AND
                    LIQ-IIC-IOPD IN LIQ-FLD = LIQ-IIC-IOPD IN LIQ )
               PERFORM KEY-ALL-LIQ
               MOVE ZEROES TO LIQ-NUM-ILIQ IN LIQ.
           IF SCR-CCPP = 'ING'
               ADD 1 TO LIQ-NUM-ILIQ IN LIQ.
           MOVE LIQ-NUM-ILIQ IN LIQ TO LIQ-NUM-ILIQ IN LIQ-FLD.
      *    MOVE 1 TO LIQ-NUM-ILIQ IN LIQ-FLD.
      *    MOVE 1 TO LIQ-NUM-ILIQ IN LIQ.
       FIN-BUS-COR-LIQ.
           EXIT.

      *<<<< PGM_PQ
      *JVM: 22/09/92
       VAL-PER-REN SECTION.
       INI-VAL-PER-REN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-NUM-PNTE.
           MOVE OPD-NUM-DREA IN OPD TO FEC-ITM1.
           MOVE OPD-NUM-MREA IN OPD TO FEC-ITM2.
           MOVE OPD-NUM-SREA IN OPD TO FEC-ITM3.
           MOVE OPD-NUM-AREA IN OPD TO FEC-ITM4.

       BUS-INI-PER-REN.
      * ISP: SE POSICIONA EN PRIMERA FECHA HABIL A PARTIR DE
      *      FECHA DE CAPTACION ( INCLUSIVE )
      *      LA DEJA CARGADA EN FEC-FECH

           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-SUM-DIA            TO FEC-CMND
               MOVE 1                      TO FEC-NDIA
               MOVE FEC-FORM-FEC TO FEC-FORM
               PERFORM CAL-FEC
               GO TO BUS-INI-PER-REN.

       CIC-VAL-PER-REN.
           MOVE FEC-SUM-DIA            TO FEC-CMND.
           MOVE 1                      TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.

      *VAL-FEC Validar Fecha
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF FEC-STAT-HBL
               ADD 1 TO WSS-NUM-PNTE.
           IF WSS-NUM-PNTE < OPD-NUM-PNTE IN OPD
                GO TO CIC-VAL-PER-REN.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.
           PERFORM GET-FHOY.
           IF HOY-FHOY NOT > WSS-FEC-FUNO
               MOVE 'LIQPERRENO' TO MSG-COD-MENS
               IF SCR-CMND = 'REV'
                   MOVE 'REVUSERDL' TO MSG-COD-MENS.

      *         MOVE 'PRENHOY' TO QUE-COLA.
      *         MOVE +12 TO QUE-LITM.
      *         MOVE HOY-FHOY TO  QUE-ITEM.
      *         MOVE QUE-PUT TO QUE-CMND.
      *         PERFORM GNS-PRO-QUE.
      *
      *
      *         MOVE 'PRENUNO' TO QUE-COLA.
      *         MOVE +12 TO QUE-LITM.
      *         MOVE WSS-FEC-FUNO TO  QUE-ITEM.
      *         MOVE QUE-PUT TO QUE-CMND.
      *         PERFORM GNS-PRO-QUE.
      *
       FIN-VAL-PER-REN.
           EXIT.
      *JVM:
      *ADA-INI 05-JUL-2002
       VAL-PER-LSI SECTION.
       INI-VAL-PER-LSI.
      *    PERFORM GET-FHOY.
      *    IF OPD-FEC-FREA IN OPD NOT = HOY-FHOY
      *        MOVE 'LSISOLOFVEN' TO MSG-COD-MENS.
           MOVE SPACES TO MSG-COD-MENS.
       FIN-VAL-PER-LSI.
           EXIT.
      *JVM:
      *>>>> EOF_PQ
      *>>>>
      *INI-MFC TUXEDO ORACLE
       COPY DAPZQLIQ.
      *FIN-MFC TUXEDO ORACLE
