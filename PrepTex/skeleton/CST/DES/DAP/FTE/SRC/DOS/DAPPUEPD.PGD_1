       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DAPPUEPD.
       AUTHOR.       BEE.
       DATE-WRITTEN. 20-Jun-19 10:33 AM.

      * NOMBRE PROGRAMA                   DAPPUEPD
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      DAPEPD
      * PANTALLA                          DAPEPD
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<< CMT_ID
      * ISP-INI 05/12/2011 POR PROYECTO
      * Proyecto     : 05/12/2011 1004_18 BCI DPM Diferencia
      *                           Cartera LIQ-RP en FVEN nub 3568
      * Modificacion : 05/12/2011 Ivan Silva P.
      * Objetivos    : No permitir programar liquidacion
      *                renovables con VEN-STAT="N"
      * Etiqueta de  : ISP-INI 05-12-2011 1004_18 BCI
      *                DPM, No IN1 con VEN-STAT="N"
      * ISP-FIN
      *----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 20-10-2017
      *  NUB       : 53722
      *  Proyecto  : DPM Correccion Liquidacion DPI a Cuenta Corriente
      *  ID        : MPB-INI  20-OCT-2017 Correccion Liquidacion DPI
      *  Cambios   : Valida Ing de EPD para OPD con ONP o Cond de Gtia
      *----------------------------------------------------------------
      *  Autor     : BEE-MPB
      *  Fecha     : 22-02-2018
      *  NUB       : 53747
      *  Proyecto  : 1710_07 BCI DPM  PY 53747 No Renovar DAP a
      *              Clientes Fallecidos
      *  ID        : MPB-INI 22-FEB-2018 NO RENOVAR DAP A CLI FALLECIDO
      *  Cambios   : NO PERMITIR RENOV DE DAP FIJO A CLIENTES FALLECIDOS
      *              NO PERMITIR ING DE EPD A CLIENTES FALLECIDOS
      *----------------------------------------------------------------
      *>>>> CMT_ID

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DAPPUEPD-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DAPPUEPD$ SKL=$08.07.21$ VSN=$11.12.05$        
      -    'GEN=$20-Jun-19 10:33 AM$ FNC=$100418$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
           03  SCR-IND-MCLI              PIC X(01).
           03  SCR-CIC-CLI1              PIC X(12).
           03  SCR-CIC-CLI2              PIC X(12).
           03  SCR-CIC-CTAB-IEPD         PIC X(03).           
      *>>>>
       COPY DAPWIEPD.
       COPY DAPBREPD.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

      *<<<< WSS
       01  WSS-MSG-EPD-REV VALUE SPACES.                                
           03 WSS-MSG-EPD-REV-M1                 PIC X(40).             
           03 WSS-MSG-EPD-REV-M2                 PIC X(39).             
       77  WSS-EPD-COD-SEPD         VALUE 'X' PIC X(01).                
                                                                        
      *Entidades de sgc                                                 
       COPY SGCBRDBC.                                                   
       COPY SGCBROPE.                                                   
       COPY SGCBRRCO.                                                   
                                                                        
      *MPB-INI 22-FEB-2018 NO RENOVAR DAP A CLI FALLECIDOS
       COPY SGCBRCAC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAC-REQA==.
       77  WSS-CIC-DEFUNCION VALUE 'DEFUNCION   ' PIC X(12).
       77  WSS-COD-DEFUNCION VALUE SPACES         PIC X(12).
       77  WSS-CTE-ING       VALUE 'ING'          PIC X(03).
       77  WSS-CTE-CDT       VALUE 'CDT'          PIC X(03).
       77  WSS-CTE-CTD       VALUE 'CTD'          PIC X(03).
       77  WSS-CTE-LQF       VALUE 'LQF'          PIC X(03).
       77  WSS-CTE-RDF       VALUE 'RDF'          PIC X(03).
       77  WSS-CTE-SLA       VALUE 'SLA'          PIC X(03).
       77  WSS-CTE-GUI       VALUE '-'            PIC X(01).
       77  WSS-CTE-1         VALUE 1              PIC 9(03).
       77  WSS-CTE-2         VALUE 2              PIC 9(03).
       77  WSS-IDX-FALL      VALUE ZEROES         PIC 9(03).
       77  WSS-NUM-FALL      VALUE ZEROES         PIC 9(03).
       77  WSS-TOT-FALL      VALUE 1              PIC 9(05).
       77  WSS-REAL-FALL     VALUE ZEROES         PIC 9(03).
       77  WSS-CTE-0         VALUE ZEROES         PIC 9(03).
       77  WSS-FAL-1         VALUE '00001'        PIC X(05).
       77  WSS-FAL-2         VALUE '00002'        PIC X(05).

       01  WSS-FALL-TBL.
           03 WSS-FALL-OCC OCCURS 5 TIMES.
              05 WSS-FALL-ELM                     PIC X(12).

       01  WSS-ICLI-TBL.
           03  WSS-ICLI OCCURS 2 TIMES.
              05 WSS-NUM-ICLI VALUE SPACES    PIC X(08).
              05 WSS-GUI     VALUE ' '        PIC X(01).
              05 WSS-VRF-ICLI                 PIC X(01).


      *MPB-FIN 22-FEB-2018

      *Entidades de TAB                                                 
       COPY TABBRCAM.                                                   
                                                                        
      *Entidades de DAP                                                 
       COPY DAPBROPD.                                                   
       COPY DAPBRCAD.                                                   
       COPY DAPBRVEN.                                                   
       COPY DAPBRRCC.                                                   
                                                                        
      *Entidades de GNS                                                 
       COPY GNSWGCPT.                                                   
       COPY GNSWGSTR.                                                   
       COPY GNSWGPES.                                                   
       COPY GNSWGINT.                                                   
                                                                        
       01  WSS-VARI.                                                    
           03 PGM-STAT-RCC           VALUE '23'      PIC X(02).         
              88 PGM-STAT-RCC-OKS    VALUE '00'.                        
              88 PGM-STAT-RCC-NUL    VALUE '  '.                        
      *    03 WSS-CIC-EPD-COD-IEPD   VALUE SPACES    PIC X(03).         
      *MPB-INI  20-OCT-2017 Correccion Liquidacion DPI
           03 WSS-CTE-DAP  VALUE 'DAP'           PIC X(03).
           03 WSS-CTE-IN1  VALUE 'IN1'           PIC X(03).
           03 WSS-CTE-S    VALUE 'S'             PIC X(01).
           03 WSS-CTE-N    VALUE 'N'             PIC X(01).
           03 WSS-CTE-OPDOG VALUE 'OPDONPCNDG'   PIC X(10).

      *MPB-FIN
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPD.
                 88 PGM-STAT-OPD-NUL    VALUE '  '.
                 07 PGM-STT1-OPD        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPD-OKS VALUE '0'.
                 07 PGM-STT2-OPD        VALUE '3' PIC X(01).
              05 PGM-STAT-EPD.
                 88 PGM-STAT-EPD-NUL    VALUE '  '.
                 07 PGM-STT1-EPD        VALUE '2' PIC X(01).
                    88 PGM-STAT-EPD-OKS VALUE '0'.
                 07 PGM-STT2-EPD        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-VEN.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
                 07 PGM-STT1-VEN        VALUE '2' PIC X(01).
                    88 PGM-STAT-VEN-OKS VALUE '0'.
                 07 PGM-STT2-VEN        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

      *INI-MFC TUXEDO ORACLE
      * LINKAGE SECTION.
       COPY GNSWHLKG.
      *FIN-MFC TUXEDO ORACLE
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(278).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
      *INI-MFC TUXEDO ORACLE
           PERFORM GNS-PRO-LIMPIAR-VARIABLES.
      *FIN-MFC TUXEDO ORACLE
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO EPD-FLD.
           MOVE LOW-VALUES TO EPD-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +278 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DAPPUEPD' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< ( INI_FIO ) AND ( NOT PGM_VSI )
           PERFORM GNS-HDL-VSM.
      *>>>>
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>> INI_FIO
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-EPD.
           PERFORM EDT-KEY-EPD.
           PERFORM EDT-FLD-EPD.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-EPD
               PERFORM EDT-KEY-EPD
               PERFORM EDT-FLD-EPD
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-EPD
               PERFORM EDT-KEY-EPD
           ELSE
               PERFORM CLR-FLD-EPD
               PERFORM EDT-FLD-EPD.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO EPD-FLD.
           MOVE LOW-VALUES TO EPD-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
      *>>>> INI_CMN_MOD
           PERFORM KEY-ALL-EPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
           IF FIO-STAT-OKS AND
              EPD-STP-ITRN IN EPD NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< CMN_MOD_RET
      *>>>> CMN_MOD_RET
           PERFORM RET-ALL-EPD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO EPD.
           PERFORM RET-ALL-EPD.
      *<<<< CMN_ING
           PERFORM PUT-FTRN.
           IF SCR-CMND = 'ING' AND                                      
              EPD-COD-IEPD IN EPD-FLD = 'LQF'                           
               PERFORM SET-CAD-EPD-ING                                  
           ELSE                                                         
           IF SCR-CMND = 'ING' AND                                      
              EPD-COD-IEPD IN EPD-FLD = 'IN1'                           
               PERFORM SET-CAD-EPD-ING.                                 
                                                                        
      *>>>> CMN_ING
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
      *<<<< FIN_CMN_ING
           IF SCR-CMND = 'REV' AND                                      
              ( EPD-COD-IEPD IN EPD-FLD = 'LQF' OR                      
                EPD-COD-IEPD IN EPD-FLD = 'IN1' )                       
               PERFORM GET-PRV-EPD                                      
                                                                        
               PERFORM SET-CAD-EPD-REV                                  
           ELSE                                                         
           IF SCR-CMND = 'REV'                                          
               MOVE 'EPDREVOKS    ' TO MSG-COD-MENS                     
               MOVE 'DAP' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
      *>>>> FIN_CMN_ING
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-EPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
           IF FIO-STAT-OKS AND
              EPD-STP-ITRN IN EPD NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-EPD.
      *<<<< CMN_ACC
      *>>>> CMN_ACC
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-EPD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
           IF FIO-STAT-OKS AND
              EPD-STP-ITRN IN EPD NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DAP-FIO-EPD
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< CMN_ELI
      *>>>> CMN_ELI
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DAP-FIO-EPD.
      *<<<< FIN_CMN_ELI
      *>>>> FIN_CMN_ELI
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-EPD.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE EPD-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO EPD-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-EPD
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO EPD-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-EPD.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-EPD
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-EPD.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-EPD
               PERFORM EDT-FLD-EPD
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-EPD.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
      *<<<< SCR_GFLD_VAL_FLD

           PERFORM GET-OPD.                                             
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO SCR-IERR
               GO TO ERR-SCR-GFLD.

      *MPB-INI 20-OCT-2017 Correccion Liquidacion DPI
           IF EPD-COD-IEPD IN EPD-FLD = WSS-CTE-IN1 AND
              (OPD-COD-IONP IN OPD = WSS-CTE-S OR
              OPD-COD-GARA IN OPD = WSS-CTE-S)
                MOVE WSS-CTE-OPDOG TO MSG-COD-MENS
                MOVE WSS-CTE-DAP TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                                     EPD-GLS-MENS

                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE WSS-CTE-S TO SCR-IERR
                PERFORM FST-MSG
                GO TO ERR-SCR-GFLD.
      *MPB-FIN
           PERFORM GET-OPD-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO SCR-IERR
               GO TO ERR-SCR-GFLD.

      * ISP-INI 05-12-2011 1004_18 BCI DPM, No IN1 con VEN-STAT="N"
           IF VEN-COD-STAT IN VEN = 'N'
                MOVE 'NOIN1-VEN=N' TO MSG-COD-MENS
                MOVE 'DAP' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                                     EPD-GLS-MENS

                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'S' TO SCR-IERR
                PERFORM FST-MSG
                GO TO ERR-SCR-GFLD.
      * ISP-FIN 05-12-2011 1004_18 BCI DPM, No IN1 con VEN-STAT="N"

           PERFORM PUT-FTRN.
           IF SCR-CMND NOT = 'REV'
               IF EPD-COD-IEPD IN EPD-FLD = 'RDF'
                   PERFORM PUT-FIJ-RDF
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'LQF'
                   PERFORM PUT-FIJ-LQF
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'IN1'
                    PERFORM PUT-FIJ-IN1
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'SLA'
                    PERFORM PUT-FIJ-SLA.
      *>>>>
           PERFORM VAL-FLD-EPD.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-EPD.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-EPD.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-EPD.
           PERFORM EDT-FLD-EPD.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO EPD-GLS-MEN2
               MOVE SCR-PRMT     TO EPD-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO EPD-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-EPD
               PERFORM VAL-NUM-FLD-EPD.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO EPD-GLS-MEN2
               MOVE SCR-PRMT     TO EPD-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO EPD-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO EPD-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE EPD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO EPD-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-EPD

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO EPD-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO EPD-GLS-MENS.
           PERFORM PRO-FLD-EPD.
           PERFORM PRO-MKY-EPD.
           PERFORM UNP-IKY-EPD.
           PERFORM FST-KEY-EPD.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE EPD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO EPD-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO EPD-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO EPD-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-EPD.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-EPD.
           PERFORM FST-KEY-EPD.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-EPD.
           PERFORM UNP-FLD-EPD.
           PERFORM FST-FLD-EPD.
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO EPD-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-EPD.
           PERFORM PRO-FLD-EPD.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-EPD
               PERFORM EDT-FLD-EPD
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-EPD
               PERFORM EDT-FLD-EPD
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-EPD.
           PERFORM EDT-FLD-EPD.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-EPD.
           PERFORM PRO-FLD-EPD.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-EPD
               PERFORM EDT-FLD-EPD.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO EPD-GLS-MEN2
               MOVE SCR-CONF     TO EPD-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO EPD-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-EPD
               PERFORM VAL-NUM-FLD-EPD
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-EPD
                   PERFORM VAL-NUM-FLD-EPD
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY DAPBUEPD.
       COPY GNSBVNUM.
       COPY DAPBFEPD.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBFOFI.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFCAD.
       COPY DAPBFVEN.
       COPY DAPBFRCC.

      *Entidades de GNS
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBGINT.
       COPY GNSBEGLS.

      *Entidades de TAB
       COPY TABBFCAM.

      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
      *MPB-INI 22-FEB-2018 NO RENOVAR DAP A CLI FALLECIDOS
       COPY SGCBFCAC.
      *MPB-FIN 22-FEB-2018

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'DAP' TO FIO-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.


       GET-OPD SECTION.
       INI-GET-OPD.
           MOVE EPD-CAI-IOPD IN EPD-FLD TO OPD-CAI-IOPD IN OPD.         
           MOVE EPD-IIC-IOPD IN EPD-FLD TO OPD-IIC-IOPD IN OPD.         
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
                 MOVE 'OPD    NEX' TO MSG-COD-MENS.
           MOVE FIO-STAT TO PGM-STAT-OPD.
       FIN-GET-OPD.
           EXIT.

       GET-OPD-VEN SECTION.
       INI-GET-OPD-VEN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.
      *    MOVE OPD-NUM-IVEN IN OPD TO VEN-NUM-IVEN IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           MOVE FIO-STAT TO PGM-STAT-VEN.
           IF NOT FIO-STAT-OKS
                MOVE 'VENNEXEPD' TO MSG-COD-MENS.
       INI-GET-OPD-VEN.
           EXIT.


           
           
       GET-FRM-OPD SECTION.
       INI-GET-FRM-OPD.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM GET-OPD.
           IF FIO-STAT-OKS
               IF OPD-COD-STAT IN OPD NOT = 'G'
                   MOVE 'OPD    NAE' TO MSG-COD-MENS
               ELSE
               IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                   MOVE 'OPDYAEPD' TO MSG-COD-MENS
               ELSE
               IF OPD-COD-RENO IN OPD = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'RDF'
                   MOVE 'RDFNOFIJA' TO MSG-COD-MENS
               ELSE
               IF OPD-COD-RENO IN OPD NOT = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'IN1'
                   MOVE 'IN1NORENO' TO MSG-COD-MENS
               ELSE
               IF SCR-CMND = 'REV' AND
                  WSS-EPD-COD-SEPD NOT = 'I'
                   MOVE 'EPDREVINV' TO MSG-COD-MENS
               ELSE
               IF SCR-CMND = 'ING' AND
                  WSS-EPD-COD-SEPD = 'I'
                   MOVE 'EPDYARPROG' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
       FIN-GET-FRM-OPD.
           EXIT.

       PUT-FTRN SECTION.
       INI-PUT-FTRN.
           MOVE HOY-DHOY TO EPD-NUM-DTRN IN EPD.
           MOVE HOY-MHOY TO EPD-NUM-MTRN IN EPD.
           MOVE HOY-SHOY TO EPD-NUM-STRN IN EPD.
           MOVE HOY-AHOY TO EPD-NUM-ATRN IN EPD.

           MOVE HOY-DHOY TO EPD-NUM-DTRN IN EPD-FLD.
           MOVE HOY-MHOY TO EPD-NUM-MTRN IN EPD-FLD.
           MOVE HOY-SHOY TO EPD-NUM-STRN IN EPD-FLD.
           MOVE HOY-AHOY TO EPD-NUM-ATRN IN EPD-FLD.

           MOVE HOY-HHOY TO EPD-HRA-HRTR IN EPD-FLD.
           MOVE HOY-HHOY TO EPD-HRA-HRTR IN EPD.

       FIN-PUT-FTRN.
           EXIT.


       PUT-FIJ-RDF SECTION.
       INI-PUT-FIJ-RDF.

           PERFORM PUT-FVEN.

           PERFORM BUS-CIC-I-SEPD.

           MOVE SPACES TO EPD-CAI-ICAD IN EPD-FLD.
           MOVE ZEROES TO EPD-IIC-ICAD IN EPD-FLD.
       FIN-PUT-FIJ-RDF.
           EXIT.

       PUT-FIJ-LQF SECTION.                                             
       INI-PUT-FIJ-LQF.                                                 
                                                                        
           PERFORM PUT-FVEN.                                            
                                                                        
           PERFORM BUS-CIC-I-SEPD.                                      
                                                                        
       FIN-PUT-FIJ-LQF.                                                 
           EXIT.                                                        
                                                                        
       PUT-FIJ-IN1 SECTION.                                             
       INI-PUT-FIJ-IN1.                                                 
                                                                        
           PERFORM PUT-FVEN.                                            
                                                                        
           PERFORM BUS-CIC-I-SEPD.                                      
                                                                        
       FIN-PUT-FIJ-IN1.                                                 
           EXIT.                                                        
                                                                        
       PUT-FIJ-SLA SECTION.                                             
       INI-PUT-FIJ-SLA.                                                 
                                                                        
           PERFORM PUT-FVEN.                                            
                                                                        
           PERFORM BUS-CIC-I-SEPD.                                      
                                                                        
       FIN-PUT-FIJ-SLA.                                                 
           EXIT.                                                        
                                                                        
       PUT-FVEN SECTION.                                                
       INI-PUT-FVEN.                                                    
           MOVE VEN-NUM-DVEN IN VEN TO EPD-NUM-DEPD IN EPD-FLD.         
           MOVE VEN-NUM-MVEN IN VEN TO EPD-NUM-MEPD IN EPD-FLD.         
           MOVE VEN-NUM-SVEN IN VEN TO EPD-NUM-SEPD IN EPD-FLD.         
           MOVE VEN-NUM-AVEN IN VEN TO EPD-NUM-AEPD IN EPD-FLD.         
       FIN-PUT-FVEN.                                                    
           EXIT.                                                        
                                                                        
       BUS-CIC-I-SEPD SECTION.                                          
       INI-BUS-CIC-I-SEPD.                                              
           MOVE 'DAP' TO TAB-COD-SIST.                                  
           MOVE 'DAP' TO FIO-SIST.                                      
           MOVE 'SEP ' TO TAB-COD-TTAB IN TAB.                          
           MOVE 'I' TO TAB-CIC-CTAB IN TAB.                             
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
               MOVE TAB-COD-CTAB IN TAB TO EPD-COD-SEPD IN EPD-FLD.     
       FIN-BUS-CIC-I-SEPD.                                              
           EXIT.                                                        
      *<<<< EOF_PU
       SET-CAD-EPD-REV SECTION.                                         
       INI-SET-CAD-EPD-REV.                                             
      *MPB-INI  20-OCT-2017 Correccion Liquidacion DPI
           PERFORM GET-OPD.
      *MPB-FIN
           PERFORM GET-CUR-AUT.                                         
                                                                        
           IF FIO-STAT-OKS                                              
                IF EPD-CAI-IOLD IN EPD NOT > SPACES OR
      *MPB-INI  20-OCT-2017 Correccion Liquidacion DPI
                   OPD-COD-RENO = WSS-CTE-S
      *MPB-FIN
                    MOVE FIO-DEL TO FIO-CMND                            
                    PERFORM DAP-FIO-CAD                                 
                ELSE                                                    
                    MOVE EPD-COD-IOLD IN EPD TO CAD-IND-TCAD IN CAD     
                    MOVE EPD-CIC-IOLD IN EPD TO CAD-CIC-ICAD IN CAD     
                    MOVE FIO-MOD TO FIO-CMND                            
                    PERFORM DAP-FIO-CAD.                                
                                                                        
       FIN-SET-CAD-EPD-REV.                                             
           EXIT.                                                        
                                                                        
       SET-CAD-EPD-ING SECTION.                                         
       INI-SET-CAD-EPD-ING.                                             
           PERFORM GET-CUR-AUT.                                         
                                                                        
           IF FIO-STAT-OKS                                              
                                                                        
                MOVE CAD-IND-TCAD IN CAD     TO EPD-COD-IOLD IN EPD     
                MOVE CAD-CIC-ICAD IN CAD     TO EPD-CIC-IOLD IN EPD     
                                                                        
                MOVE 'DAPPUEPD'              TO CAD-COD-ATRN IN CAD     
                MOVE EPD-CAI-ICAD IN EPD-FLD TO CAD-CAI-ICAD IN CAD     
                MOVE EPD-IIC-ICAD IN EPD-FLD TO CAD-IIC-ICAD IN CAD     
                MOVE FIO-MOD TO FIO-CMND                                
                PERFORM DAP-FIO-CAD                                     
           ELSE                                                         
                MOVE SPACES TO CAD                                      
                MOVE EPD-CAI-IOPD IN EPD-FLD TO CAD-CAI-IOPD IN CAD     
                MOVE EPD-IIC-IOPD IN EPD-FLD TO CAD-IIC-IOPD IN CAD     
                MOVE 'AUT'                   TO CAD-NUM-ILIQ IN CAD     
                MOVE 1                       TO CAD-NUM-ICAD IN CAD     
                MOVE HOY-FHOY                TO CAD-FEC-FTRN IN CAD     
                MOVE HOY-HHOY                TO CAD-HRA-HRTR IN CAD     
                MOVE 'I'                     TO CAD-COD-TACC IN CAD     
                MOVE 'DAPPUEPD'              TO CAD-COD-ATRN IN CAD     
                MOVE ZEROES                  TO CAD-SGV-LIQU IN CAD     
                                                                        
                MOVE EPD-CAI-ICAD IN EPD-FLD TO CAD-CAI-ICAD IN CAD     
                MOVE EPD-IIC-ICAD IN EPD-FLD TO CAD-IIC-ICAD IN CAD     
                                                                        
                MOVE FIO-PUT TO FIO-CMND                                
                PERFORM DAP-FIO-CAD.                                    
       FIN-SET-CAD-EPD-ING.                                             
           EXIT.                                                        
                                                                        
       GET-CUR-AUT SECTION.                                             
       INI-GET-CUR-AUT.                                                 
           MOVE EPD-CAI-IOPD IN EPD-FLD TO CAD-CAI-IOPD IN CAD.         
           MOVE EPD-IIC-IOPD IN EPD-FLD TO CAD-IIC-IOPD IN CAD.         
           MOVE 'AUT'                   TO CAD-NUM-ILIQ IN CAD.         
           MOVE 1                       TO CAD-NUM-ICAD IN CAD.         
           MOVE 'CAD-KEY-ICAD' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM DAP-FIO-CAD.                                         
       FIN-GET-CUR-AUT.                                                 
           EXIT.                                                        
                                                                        
       GET-PRV-EPD SECTION.                                             
       INI-GET-PRV-EPD.                                                 
           SUBTRACT 1 FROM EPD-NUM-IEPD IN EPD.                         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-EPD.                                         
       FIN-GET-PRV-EPD.                                                 
           EXIT.

      *>>>> EOF_PU
      *INI-MFC TUXEDO ORACLE
       COPY DAPZUEPD.
      *FIN-MFC TUXEDO ORACLE
