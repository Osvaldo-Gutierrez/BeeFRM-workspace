       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DAPPLBID.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    10-Jul-96 10:39 AM.

      * Programa Listador de Reporte BID con Sort.

      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTBID         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTBID         ASSIGN TO        UT-S-RPTBID.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTBID         ASSIGN TO        UT-S-RPTBID.
      *<<<< IOS
      *DOS SELECT RPTRID         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTRID         ASSIGN TO        UT-S-RPTRID.
           SELECT RPTRID         ASSIGN TO        UT-S-RPTRID.
      *>>>>
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY DAPRRBID.
      *<<<< RR
           03 CPP-COD-VCAM            PIC X(06).
           03 CPP-COD-TOPD            PIC X(03).
           03 CPP-COD-AOPD            PIC X(03).
           03 CPP-COD-PLZO            PIC X(02).
      *     03 WSS-VAL-DEBE            PIC S9(13)V9(04).
      *     03 WSS-VAL-HABE            PIC S9(13)V9(04).
      *>>>>
      *>>>>
       FD  RPTBID LABEL RECORDS OMITTED
           REPORT IS RPT-BID
      *>>>>
           .
      *<<<< FLS
       FD  RPTRID LABEL RECORDS OMITTED
           REPORT IS RPT-RID.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CID-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY DAPBRCID.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY DAPRWBID.
      *>>>>
      *<<<< RW
       COPY DAPRWRID.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *>>>>
      *<<<< WSS
      *Entidades  de GNS
       COPY GNSWGPES.
       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSBRMSC.
       COPY GNSWGCPT.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
      *Entidades  de TAB
       COPY TABBROFI.
      *Entidades  de SGC
       COPY SGCBRDBC.
      *Entidades de DAP
       COPY DAPBRRCC.
       COPY DAPBRDCC.
       COPY DAPBRCPP.
       COPY DAPBROPD.
       COPY DAPBRCTI.

      *HEADER INTERFAZ
       COPY DAPBRMCH.

       COPY DAPBRCT1.
       COPY DAPBRCT2.
       COPY DAPBRMC1.
       COPY DAPBRMC2.
       COPY DAPBRMC3.

       01  WSS-VARI.
      *ISP: CODIGOS USUARIOS DE MONEDAS
           03 WSS-COD-0999        VALUE SPACES    PIC X(06).
           03 WSS-COD-0998        VALUE SPACES    PIC X(06).
           03 WSS-COD-0013        VALUE SPACES    PIC X(06).
           03 WSS-COD-1013        VALUE SPACES    PIC X(06).
           03 WSS-COD-RPP         VALUE SPACES    PIC X(06).
           03 WSS-COD-RPA         VALUE SPACES    PIC X(06).
           03 WSS-COD-IPP         VALUE SPACES    PIC X(06).
           03 WSS-COD-IPA         VALUE SPACES    PIC X(06).

           03 WSS-IND-GITF        VALUE SPACES    PIC X(01).
      *DAD ini  23-JUN-1992
           03 WSS-NUM-TCDE        VALUE ZEROES    PIC 9(04).
           03 WSS-NUM-TCHA        VALUE ZEROES    PIC 9(04).
           03 WSS-VAL-SALD        VALUE ZEROES    PIC S9(11)V9(04).

           03 WSS-VAL-LTN1-DEBE   VALUE ZEROES    PIC S9(13)V9(04).
           03 WSS-VAL-LTN1-HABE   VALUE ZEROES    PIC S9(13)V9(04).
           03 WSS-VAL-LTX1-DEBE   VALUE ZEROES    PIC S9(13)V9(04).
           03 WSS-VAL-LTX1-HABE   VALUE ZEROES    PIC S9(13)V9(04).

           03 WSS-IND-LOTE        VALUE ZEROES    PIC 9(01).
           03 WSS-COD-COFI                        PIC X(03).
           03 WSS-CIC-CCTB                        PIC X(12).
           03 WSS-CIC-IOPD                        PIC X(12).
           03 WSS-CIC-ISER                        PIC X(12).
      *DAD fin  23-JUN-1992
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-DTER                     PIC 9(02).
           03 WSS-FEC-FFIN.
              05 WSS-NUM-DFIN                     PIC 9(02).
              05 WSS-NUM-MFIN                     PIC 9(02).
              05 WSS-NUM-SFIN                     PIC 9(02).
              05 WSS-NUM-AFIN                     PIC 9(02).
           03 WSS-CIC-CCSB.
              05 WSS-CAI-CCSB                     PIC X(04).
              05 WSS-IIC-CCSB                     PIC 9(08).
           03 WSS-I               VALUE ZEROES    PIC 9(02).
           03 WSS-COD-OFIC                        PIC X(03). 
           03 WSS-STAT-RCC        VALUE ZEROES    PIC 9(01). 
           03 WSS-IND-DBHB        VALUE SPACES    PIC X(01). 
           03 WSS-IND-MCLI        VALUE SPACES    PIC X(01). 
           03 WSS-IND-RID         VALUE ZEROES    PIC 9(01). 
           03 WSS-IND-CTI         VALUE ZEROES    PIC 9(01). 
           03 WSS-IND-NEXT        VALUE ZEROES    PIC 9(01). 
           03 WSS-GRA-SRT         VALUE ZEROES    PIC 9(06).
           03 WSS-GRA-CT1         VALUE ZEROES    PIC 9(06).
           03 WSS-GRA-CT2         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-OPD         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-CID         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-CTI         VALUE ZEROES    PIC 9(06).
           03 WSS-VAL-MONT        VALUE ZEROES    PIC S9(11)V9(04).
           03 WSS-TOT-CAPT        VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-TOT-READ        VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-TOT-INTD        VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-TOT-CAPT-1      VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-TOT-READ-1      VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-TOT-INTD-1      VALUE ZEROES    PIC S9(12)V9(04).
           03 WSS-COD-VCAM.
              05 WSS-COD-TVAL                     PIC X(01).
              05 WSS-COD-CVAL                     PIC X(03).
              05 WSS-COD-TCAM                     PIC X(02).
           03 WSS-NUM-ITEM                        PIC 9(08).
           03 WSS-NUM-ITEM-R REDEFINES WSS-NUM-ITEM.
              05 WSS-COD-ITEM                     PIC 9(04).
              05 WSS-IND-ITEM                     PIC 9(04).
           03 WSS-GLS-MC1.
              05 WSS-GLS-MC11                     PIC X(72).
              05 WSS-GLS-FIL1                     PIC X(08).
           03 WSS-GLS-MC2.
              05 WSS-GLS-MC21                     PIC X(71).
              05 WSS-GLS-FIL2                     PIC X(09).
           03 WSS-GLS-MC3.
              05 WSS-GLS-MC31                     PIC X(49).
              05 WSS-GLS-FIL3                     PIC X(31).
           03 WSS-COD-CCO1.
      * JVM: 22/09/92
              05 WSS-COD-OFI0                     PIC X(01).
      * OFICINA
              05 WSS-COD-OFI1                     PIC X(03).
              05 WSS-GLS-RES1                     PIC X(08).
      * JVM
           03 WSS-COD-CCO2.
      * MONEDA SEGUN SUPER "013"
              05 WSS-COD-MONE                     PIC X(03).
      * OFICINA CABECERA
              05 WSS-COD-OFI2                     PIC X(03).
      * CEROS
              05 WSS-GLS-RES2                     PIC X(03).
      * OFICINA SATELITE
              05 WSS-COD-OFI3                     PIC X(03).
      * JVM
           03 WSS-KEY-ANT.
              05 WSS-VCAM-ANT                     PIC X(06).
              05 WSS-TOPD-ANT                     PIC X(03).
              05 WSS-AOPD-ANT                     PIC X(03).
              05 WSS-PLZO-ANT                     PIC X(02).
           03 WSS-KEY-CPP.
              05 WSS-VCAM-CPP                     PIC X(06).
              05 WSS-TOPD-CPP                     PIC X(03).
              05 WSS-AOPD-CPP                     PIC X(03).
              05 WSS-PLZO-CPP                     PIC X(02).
      * JVM/BCI 28-05-93
           03 WSS-GLS-CTBL.
              05 WSS-GLS-CCTA.
                 07 WSS-GLS-CCT1                  PIC X(30).
                 07 WSS-GLS-CCT2                  PIC X(12).
              05 WSS-GLS-FECH.
                 07 WSS-GLS-BLAN                  PIC X(01).
                 07 WSS-FEC-FCTB.
                    09 WSS-NUM-MCTB               PIC 9(02).
                    09 WSS-NUM-ACTB               PIC 9(02).
                 07 WSS-GLS-REST                  PIC X(05).

          03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-FEC-FAMD.
              05 WSS-NUM-SAMD                     PIC 9(02).
              05 WSS-NUM-AAMD                     PIC 9(02).
              05 WSS-NUM-MAMD                     PIC 9(02).
              05 WSS-NUM-DAMD                     PIC 9(02).
      * JVM/BCI
      *>>>> WSS
      *>>>>
      *<<<< WSS_DTC
      *Entidades  de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
      *Entidades  de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==. 
      *Entidades  de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *Entidades  de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPP-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY DAPRFBID.
      *>>>>
           .
       COPY DAPRTBID.
      *>>>>
      *<<<< RT
       COPY DAPRFRID.
           .
       COPY DAPRTRID.
      *>>>>

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-BID-OPD-COD-OFIC SECTION.
           USE BEFORE REPORTING CF-BID-OPD-COD-OFIC.
       INI-CF-BID-OPD-COD-OFIC.
      *>>>>
       FIN-CF-BID-OPD-COD-OFIC.
           EXIT.
       DEC-CF-BID-OPD-COD-VCAM SECTION.
           USE BEFORE REPORTING CF-BID-OPD-COD-VCAM.
       INI-CF-BID-OPD-COD-VCAM.
      *>>>>
       FIN-CF-BID-OPD-COD-VCAM.
           EXIT.
       DEC-CH-BID-SRT-CIC-CCSB SECTION.
           USE BEFORE REPORTING CH-BID-SRT-CIC-CCSB.
       INI-CH-BID-SRT-CIC-CCSB.
      *>>>>
      *<<<< CH_BID_SRT_CIC_CCSB
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB      TO WSS-GLS-CCSB IN WSS-BID
               MOVE TAB-COD-CTAB IN TAB      TO WSS-CIC-CCSB IN WSS-VARI
               MOVE WSS-CAI-CCSB IN WSS-VARI TO WSS-CAI-CCSB IN WSS-BID
               MOVE WSS-IIC-CCSB IN WSS-VARI TO WSS-IIC-CCSB IN WSS-BID
           ELSE
               MOVE SPACES TO WSS-GLS-CCSB IN WSS-BID
                              WSS-CAI-CCSB IN WSS-BID
               MOVE ZEROES TO WSS-IIC-CCSB IN WSS-BID.
      *>>>>
       FIN-CH-BID-SRT-CIC-CCSB.
           EXIT.
       DEC-CF-BID-SRT-CIC-CCSB SECTION.
           USE BEFORE REPORTING CF-BID-SRT-CIC-CCSB.
       INI-CF-BID-SRT-CIC-CCSB.
      *>>>>
       FIN-CF-BID-SRT-CIC-CCSB.
           EXIT.
       DEC-PH-BID SECTION.
           USE BEFORE REPORTING PH-BID.
       INI-PH-BID.
      *>>>>
      *<<<< PH_BID
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPD-COD-OFIC IN SRT > SPACES
               MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-BID
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-BID.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPD-COD-VCAM IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCAM IN WSS-BID
           ELSE
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-BID.
      *>>>>
       FIN-PH-BID.
           EXIT.
      *>>>>
      *<<<< FIN_DEC
       DEC-CF-RID-OPD-COD-OFIC SECTION.
           USE BEFORE REPORTING CF-RID-OPD-COD-OFIC.
       INI-CF-RID-OPD-COD-OFIC.
       FIN-CF-RID-OPD-COD-OFIC.
           EXIT.

       DEC-CF-RID-OPD-COD-VCAM SECTION.
           USE BEFORE REPORTING CF-RID-OPD-COD-VCAM.
       INI-CF-RID-OPD-COD-VCAM.
       FIN-CF-RID-OPD-COD-VCAM.
           EXIT.

       DEC-CF-RID-SRT-CIC-CCSB SECTION.
           USE BEFORE REPORTING CF-RID-SRT-CIC-CCSB.
       INI-CF-RID-SRT-CIC-CCSB.
      *<<<< CF_RID_SRT_CIC_CCSB
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB      TO WSS-GLS-CCSB IN WSS-RID
               MOVE TAB-COD-CTAB IN TAB      TO WSS-CIC-CCSB IN WSS-VARI
               MOVE WSS-CAI-CCSB IN WSS-VARI TO WSS-CAI-CCSB IN WSS-RID
               MOVE WSS-IIC-CCSB IN WSS-VARI TO WSS-IIC-CCSB IN WSS-RID
           ELSE
               MOVE SPACES TO WSS-CAI-CCSB IN WSS-RID
               MOVE ZEROES TO WSS-IIC-CCSB IN WSS-RID.

           MOVE WSS-TOT-CAPT IN WSS-VARI TO WSS-TOT-CAPT IN WSS-RID.
           MOVE WSS-TOT-READ IN WSS-VARI TO WSS-TOT-READ IN WSS-RID
                                            WSS-TOT-REA1 IN WSS-RID.
           MOVE WSS-TOT-INTD IN WSS-VARI TO WSS-TOT-INTD IN WSS-RID
                                            WSS-TOT-INT1 IN WSS-RID.

           MOVE WSS-TOT-CAPT-1 IN WSS-VARI TO WSS-TOT-CAPT-1 IN WSS-RID.
           MOVE WSS-TOT-READ-1 IN WSS-VARI TO WSS-TOT-READ-1 IN WSS-RID
                                              WSS-TOT-REA1-1 IN WSS-RID.
           MOVE WSS-TOT-INTD-1 IN WSS-VARI TO WSS-TOT-INTD-1 IN WSS-RID
                                              WSS-TOT-INT1-1 IN WSS-RID.

      * Genera Interfaz Contable 
           PERFORM PRO-CPP.

           MOVE ZEROES TO WSS-TOT-CAPT IN WSS-VARI
                          WSS-TOT-READ IN WSS-VARI
                          WSS-TOT-INTD IN WSS-VARI.

           MOVE ZEROES TO WSS-TOT-CAPT-1 IN WSS-VARI
                          WSS-TOT-READ-1 IN WSS-VARI
                          WSS-TOT-INTD-1 IN WSS-VARI.
      *>>>>
       FIN-CF-RID-SRT-CIC-CCSB.
           EXIT.

       DEC-PH-RID SECTION.
           USE BEFORE REPORTING PH-RID.
       INI-PH-RID.
      *<<<< PH_RID
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPD-COD-OFIC IN SRT > SPACES
               MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-RID
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-RID.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPD-COD-VCAM IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCAM IN WSS-RID
           ELSE
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-RID.
       FIN-PH-RID.
           EXIT.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'DAPPLBID' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *>>>>
      *<<<< INI
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0999   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0999 IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0998   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0998 IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0013 IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$ Mediante CIC de la Moneda '1013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-1013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC1013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-1013 IN WSS-VARI.

      * Obtiene Codigo Reajustes Por Pagar
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'TCC'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'RPP'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CICRPP   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-RPP IN WSS-VARI.

      * Obtiene Codigo Reajustes Pagados
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'TCC'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'RPA'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CICRPA   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-RPA IN WSS-VARI.

      * Obtiene Codigo Intereses Por Pagar
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'TCC'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'IPP'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CICIPP   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-IPP IN WSS-VARI.

      * Obtiene Codigo Intereses Pagados
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'TCC'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'IPA'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CICIPA   NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-IPA IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      * Captura codigo de oficina
           DISPLAY 'INGRESE COD. OFICINA (XXX/*)  : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      * Captura codigo de moneda
           DISPLAY 'INGRESE COD. MONEDA (X(06)/*) : '.
           ACCEPT  WSS-COD-VCAM IN WSS-VARI.
           DISPLAY WSS-COD-VCAM IN WSS-VARI.

      *Captura genera interfaz
           DISPLAY 'GENERA INTERFAZ ( S/N ): '.
           ACCEPT  WSS-IND-GITF IN WSS-VARI.
           DISPLAY WSS-IND-GITF IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE PROCESO: '
                         WSS-FEC-FPRO '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.
 
      *VAL-OFI Valida Codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              DISPLAY WSS-COD-OFIC IN WSS-VARI
              MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
              IF MSG-GLS-MENS = 'COD    NEX'
                 DISPLAY ' ' 
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ERROR VALIDACION OFICINA: '
                         WSS-COD-OFIC '  ' MSG-GLS-MENS
                 PERFORM GNS-PRO-ABT.

      *VAL-TAB Valida Codigo de moneda
           IF WSS-COD-VCAM IN WSS-VARI > SPACES AND
              WSS-COD-VCAM IN WSS-VARI NOT = '*'
              DISPLAY WSS-COD-VCAM IN WSS-VARI
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
              MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-GLS-MENS = 'COD    NEX'
                 DISPLAY ' ' 
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ERROR VALIDACION MONEDA: '
                         WSS-COD-VCAM '  ' MSG-GLS-MENS
                 PERFORM GNS-PRO-ABT.

      *Calcular el ultimo dia del mes
           MOVE 01           TO WSS-NUM-DFIN IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MFIN IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SFIN IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AFIN IN WSS-VARI.
           ADD 1 TO WSS-NUM-MFIN IN WSS-VARI.
           IF WSS-NUM-MFIN = 13
              MOVE 01 TO WSS-NUM-MFIN IN WSS-VARI.
           PERFORM BUS-ULT-HAB.
           IF MSG-COD-MENS > SPACES 
              DISPLAY ' ' 
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN RUTINA ULTIMO DIA DEL MES'
                                MSG-COD-MENS  ' ' FIO-STAT
              PERFORM GNS-PRO-ABT.

      *Se genera fecha ultimo dia del mes en en wss-fec-fter
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DPRO IN WSS-BID
                                            WSS-NUM-DPRO IN WSS-RID.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MPRO IN WSS-BID
                                            WSS-NUM-MPRO IN WSS-RID.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-SPRO IN WSS-BID
                                            WSS-NUM-SPRO IN WSS-RID.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-APRO IN WSS-BID
                                            WSS-NUM-APRO IN WSS-RID.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.

           IF NOT ( WSS-IND-GITF = 'S' OR WSS-IND-GITF = 'N' )
              DISPLAY ' ' 
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' PARAMETRO DE GENERACION INTERFAZ: '
                                           WSS-IND-GITF 
              PERFORM GNS-PRO-ABT.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
           DISPLAY ' '.
      *>>>>
           SORT GNSSRT
       COPY DAPRSBID.
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *>>>>
      *<<<< FIN
      *JVM ini  11-AGO-1992
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE           
               PERFORM GNS-PRO-END.
      *JVM ini  11-AGO-1992
      *>>>>
      *<<<< FIN
           DISPLAY 'TOTALES DE CONTROL DAPPLBID'.
           DISPLAY '---------------------------'.
           DISPLAY '    '.
           DISPLAY 'REG. GRABADOS SORT...: ' WSS-GRA-SRT.
           DISPLAY 'REG. LEIDOS CID......: ' WSS-LEI-CID.
           DISPLAY 'REG. LEIDOS CTI......: ' WSS-LEI-CTI.
           DISPLAY 'REG. LEIDOS OPD......: ' WSS-LEI-OPD.
           DISPLAY 'REG. GRABADOS CT1....: ' WSS-GRA-CT1.
           DISPLAY 'REG. GRABADOS CT2....: ' WSS-GRA-CT2.
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-CID.
       FST-INP-SRT.
      *>>>>
      *<<<< INI_FST_INP
      *Proceso normal de generacion de Sort.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-CTI.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR EN OPEN ARCHIVO CTI : ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *JVM
           IF WSS-IND-GITF = 'S'
      *CST     MOVE FIO-UPD TO FIO-CMND
      *BCI     MOVE FIO-OUT TO FIO-CMND
               MOVE FIO-OUT TO FIO-CMND
               PERFORM DAP-FIO-CT1
               IF NOT FIO-STAT-OKS
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR EN OPEN ARCHIVO CT1 : ' FIO-STAT
      *JVM ini  11-AGO-1992
                  MOVE PGM-SMAL TO PGM-STAT-SRT
                  GO TO FIN-INP-SRT
      *JVM
               ELSE
      *CST        MOVE FIO-UPD TO FIO-CMND
      *BCI        MOVE FIO-OUT TO FIO-CMND
                  MOVE FIO-OUT TO FIO-CMND
                  PERFORM DAP-FIO-CT2
                  IF NOT FIO-STAT-OKS
                     DISPLAY ' '
                     DISPLAY ' PROCESO CANCELADO '
                     DISPLAY ' ERROR EN OPEN ARCHIVO CT2 : ' FIO-STAT
      *JVM ini  11-AGO-1992
                     MOVE PGM-SMAL TO PGM-STAT-SRT
                     GO TO FIN-INP-SRT.
      *JVM
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DAP-FIO-CID.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *>>>>
      *<<<< LUP_INP
           ADD 1 TO WSS-LEI-CID IN WSS-VARI.
           MOVE CID-CIC-IOPD IN CID TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN ACCESO A OPD ' FIO-STAT
                       'CIC ' OPD-CIC-IOPD IN OPD
               GO TO NXT-INP-SRT.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-INP-SRT.

           ADD 1 TO WSS-LEI-OPD IN WSS-VARI.
           MOVE ZEROES TO WSS-IND-CTI IN WSS-VARI.
           PERFORM BUS-SRT-REG.
           GO TO NXT-INP-SRT.  
      *>>>>
       MOV-INP-SRT.
       COPY DAPRMBID.
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *>>>>
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-CID.
      *>>>>
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *>>>>
      *<<<< FIN_INP
           IF PGM-STAT-SRT-OKS
              PERFORM PRO-CTI.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-CTI.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-CID.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *>>>>
      *<<<< INI_OUT
      * Abre Reporte RPTRID
           OPEN OUTPUT RPTRID.
           INITIATE RPT-RID.
           MOVE 1 TO WSS-IND-RID IN WSS-VARI.
      *>>>>
           OPEN OUTPUT RPTBID.
      *     MOVE 'DAPPLBID' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-BID.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
      *>>>>
      *<<<< FST_OUT
      *DAD ini  23-JUN-1992
      * Llena Datos Fijos de HEADER
           MOVE 'BH'                     TO MCH-COD-IREG IN MCH.
           MOVE 'DP'                     TO MCH-COD-ISIS IN MCH.
           MOVE '03'                     TO MCH-COD-ILOT IN MCH.
           MOVE  2                       TO MCH-IND-FIL1 IN MCH.
           MOVE  0                       TO MCH-IND-TAJU IN MCH.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO MCH-NUM-DMOV IN MCH.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO MCH-NUM-MMOV IN MCH.
           MOVE WSS-NUM-APRO IN WSS-VARI TO MCH-NUM-AMOV IN MCH.
           MOVE SPACES                   TO MCH-GLS-DISP IN MCH.

      *DAD fin  23-JUN-1992
      *>>>>
       LUP-OUT-SRT.
      *>>>>
      *<<<< LUP_OUT
      *     DISPLAY 'SRT ' SRT.
           IF WSS-IND-RID IN WSS-VARI = 1
              MOVE 0 TO WSS-IND-RID IN WSS-VARI
              MOVE CPP-COD-VCAM IN SRT TO WSS-VCAM-ANT IN WSS-VARI
              MOVE CPP-COD-TOPD IN SRT TO WSS-TOPD-ANT IN WSS-VARI
              MOVE CPP-COD-AOPD IN SRT TO WSS-AOPD-ANT IN WSS-VARI
              MOVE CPP-COD-PLZO IN SRT TO WSS-PLZO-ANT IN WSS-VARI.

           MOVE CPP-COD-VCAM IN SRT TO WSS-VCAM-CPP IN WSS-VARI.
           MOVE CPP-COD-TOPD IN SRT TO WSS-TOPD-CPP IN WSS-VARI.
           MOVE CPP-COD-AOPD IN SRT TO WSS-AOPD-CPP IN WSS-VARI.
           MOVE CPP-COD-PLZO IN SRT TO WSS-PLZO-CPP IN WSS-VARI.

      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RCC
           PERFORM BUS-REG-CLI.
           GO TO GEN-DET-BID.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-BID.
      *>>>>
      *<<<< FIN_GEN_OUT
       GEN-DET-BID.
           IF SRT-IND-ORDE IN SRT = '1' 
              GENERATE DL-BID.
           GENERATE DL-RID.
           IF SRT-IND-ORDE IN SRT = '1' 
              ADD SRT-VAL-SCAP IN SRT TO WSS-TOT-CAPT-1 IN WSS-VARI
              ADD SRT-VAL-READ IN SRT TO WSS-TOT-READ-1 IN WSS-VARI
              ADD SRT-VAL-INTD IN SRT TO WSS-TOT-INTD-1 IN WSS-VARI.   
           IF SRT-IND-ORDE IN SRT = '2' 
              ADD SRT-VAL-SCAP IN SRT TO WSS-TOT-CAPT IN WSS-VARI
              ADD SRT-VAL-READ IN SRT TO WSS-TOT-READ IN WSS-VARI
              ADD SRT-VAL-INTD IN SRT TO WSS-TOT-INTD IN WSS-VARI.   

           IF WSS-KEY-ANT IN WSS-VARI NOT = WSS-KEY-CPP IN WSS-VARI
              MOVE CPP-COD-VCAM IN SRT TO WSS-VCAM-ANT IN WSS-VARI
              MOVE CPP-COD-TOPD IN SRT TO WSS-TOPD-ANT IN WSS-VARI
              MOVE CPP-COD-AOPD IN SRT TO WSS-AOPD-ANT IN WSS-VARI
              MOVE CPP-COD-PLZO IN SRT TO WSS-PLZO-ANT IN WSS-VARI.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *>>>>
           TERMINATE RPT-BID.
      *>>>>
      *<<<< FIN_TMT
      *JVM ini  20-OCT-1992
      * Completa Datos Variables de HEADER y Graba registros CT1 y CT2
           TERMINATE RPT-RID.
           CLOSE RPTRID.

           PERFORM SET-MLOT-N1.
           PERFORM GEN-HDR-CT1.
               
           PERFORM SET-MLOT-X1.
           PERFORM GEN-HDR-CT2.
      *JVM      20-OCT-1992

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
      *>>>>
           CLOSE RPTBID.
       EXT-OUT-SRT.
      *>>>>
           EXIT.
       COPY DAPBFCID.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *>>>>
      *<<<< EOF
      *DAD ini  23-JUN-1992
       SET-MLOT-N1 SECTION.
       INI-SET-MLOT-N1.
           IF WSS-VAL-LTN1-DEBE IN WSS-VARI > WSS-VAL-LTN1-HABE
               MOVE WSS-VAL-LTN1-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTN1-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-N1.
           EXIT.

       SET-MLOT-X1 SECTION.
       INI-SET-MLOT-X1.
           IF WSS-VAL-LTX1-DEBE IN WSS-VARI > WSS-VAL-LTX1-HABE
               MOVE WSS-VAL-LTX1-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTX1-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-X1.
           EXIT.

       GEN-HDR-CT1 SECTION.
       INI-GEN-HDR-CT1.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF NOT = 'S'
               GO TO FIN-GEN-HDR-CT1.

           MOVE 'BCI ' TO MCH-COD-IBCO IN MCH.
           MOVE MCH TO CT1.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'FS-MCH ' FIO-STAT
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'MCT    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO HEADER CT1 : ' MCH
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
           DISPLAY 'HDR-CT1 GENERADO ' MCH-VAL-MLOT IN MCH.
      *JVM
       FIN-GEN-HDR-CT1.
           EXIT.

       GEN-HDR-CT2 SECTION.
       INI-GEN-HDR-CT2.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF NOT = 'S'
               GO TO FIN-GEN-HDR-CT2.

           MOVE 'BCIX' TO MCH-COD-IBCO IN MCH.
           MOVE MCH TO CT2.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'FS-MCH ' FIO-STAT
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'MCT    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO HEADER CT2 : ' MCH
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM
           DISPLAY 'HDR-CT2 GENERADO ' MCH-VAL-MLOT IN MCH.
       FIN-GEN-HDR-CT2.
           EXIT.
      *DAD fin  23-JUN-1992
      **************************************************************************
      *DAD ini  23-JUN-1992       ESTA SECTION NO SE UTILIZA   SE BORRA ?

       PRO-CTI SECTION.
       INI-PRO-CTI.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DAP-FIO-CTI.

       LUP-PRO-CTI.
           IF NOT FIO-STAT-OKS
              GO TO FIN-PRO-CTI.

           ADD 1 TO WSS-LEI-CTI IN WSS-VARI.
           MOVE CTI-CIC-IOPD IN CTI TO OPD-CIC-IOPD IN OPD.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM DAP-FIO-OPD.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'ERROR EN ACCESO A OPD ' FIO-STAT
      *                 'CIC ' OPD-CIC-IOPD IN OPD
      *         GO TO NXT-PRO-CTI.

           MOVE CTI-COD-VCAM IN CTI TO OPD-COD-VCAM IN OPD.
           MOVE CTI-COD-COPD IN CTI TO OPD-COD-COPD IN OPD.
           MOVE CTI-COD-OFIC IN CTI TO OPD-COD-OFIC IN OPD.
           MOVE CTI-COD-SCTB IN CTI TO OPD-COD-SCTB IN OPD.
           MOVE CTI-COD-PLZO IN CTI TO OPD-COD-PLZO IN OPD.


           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-PRO-CTI.
   
           ADD 1  TO WSS-LEI-OPD IN WSS-VARI.
           MOVE 1 TO WSS-IND-CTI IN WSS-VARI.
           PERFORM BUS-SRT-REG.

       NXT-PRO-CTI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-CTI.
           GO TO LUP-PRO-CTI.
       FIN-PRO-CTI.
           EXIT.

       BUS-SRT-REG SECTION.
       INI-BUS-SRT-REG.
      * Obtiene Cuenta Contable al Leer DCC por Llave COD-CCTB Formada
      * ACCESO A DCC
           IF OPD-COD-SCTB IN OPD NOT > SPACES
              MOVE SPACES TO OPD-COD-SCTB IN OPD.
      * INI-JVM 02/09/92
           MOVE SPACES TO OPD-COD-SCTB IN OPD.
      * FIN-JVM 02/09/92
           MOVE 'DCC'                      TO DCC-COD-TTAB IN DCC.
           MOVE 'CAP'                      TO DCC-COD-TCCT IN DCC.
           MOVE OPD-COD-VCAM IN OPD        TO DCC-COD-VCAM IN DCC.
           MOVE OPD-COD-COPD IN OPD        TO DCC-COD-COPD IN DCC.
           MOVE OPD-COD-PLZO IN OPD        TO DCC-COD-PLZO IN DCC.
           MOVE OPD-COD-SCTB IN OPD        TO DCC-COD-SCTB IN DCC.
           MOVE OPD-COD-VCAM IN OPD TO CPP-COD-VCAM IN SRT.
           MOVE OPD-COD-TOPD IN OPD TO CPP-COD-TOPD IN SRT.
           MOVE OPD-COD-AOPD IN OPD TO CPP-COD-AOPD IN SRT.
           MOVE OPD-COD-PLZO IN OPD TO CPP-COD-PLZO IN SRT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-DCC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'DCC INEXISTENTE PARA : '
                       ' TTAB=' DCC-COD-TTAB IN DCC
                       ' TCCT=' DCC-COD-TCCT IN DCC
                       ' VCAM=' DCC-COD-VCAM IN DCC
                       ' COPD=' DCC-COD-COPD IN DCC
                       ' PLZO=' DCC-COD-PLZO IN DCC
                       ' SCTB=' DCC-COD-SCTB IN DCC
               GO TO FIN-BUS-SRT-REG
           ELSE
              MOVE DCC-GLS-CCSB IN DCC TO SRT-CIC-CCSB IN SRT.

           IF WSS-IND-CTI IN WSS-VARI = 1
              MOVE '2'                 TO SRT-IND-ORDE IN SRT
              MOVE CTI-NUM-DIAS IN CTI TO SRT-NUM-DIAS IN SRT
              MOVE CTI-SGV-TINT IN CTI TO SRT-SGV-TINT IN SRT
              MOVE CTI-SGV-TINP IN CTI TO SRT-SGV-TPER IN SRT
              MOVE CTI-VAL-SCAP IN CTI TO SRT-VAL-SCAP IN SRT
              MOVE CTI-VAL-INTD IN CTI TO SRT-VAL-INTD IN SRT
              MOVE CTI-VAL-READ IN CTI TO SRT-VAL-READ IN SRT
              MOVE CTI-SGV-VCAM IN CTI TO SRT-SGV-VCAM IN SRT
           ELSE
              MOVE '1'                 TO SRT-IND-ORDE IN SRT
              MOVE CID-NUM-DIAS IN CID TO SRT-NUM-DIAS IN SRT
              MOVE CID-SGV-TINT IN CID TO SRT-SGV-TINT IN SRT
              MOVE CID-SGV-TINP IN CID TO SRT-SGV-TPER IN SRT
              MOVE CID-VAL-SCAP IN CID TO SRT-VAL-SCAP IN SRT
              MOVE CID-VAL-INTD IN CID TO SRT-VAL-INTD IN SRT
              MOVE CID-VAL-READ IN CID TO SRT-VAL-READ IN SRT
              MOVE CID-SGV-VCAM IN CID TO SRT-SGV-VCAM IN SRT.

      * Completa Llenado de Campos y Genera el Registro SRT
           COPY DAPRMBID.

           RELEASE SRT.
           ADD 1 TO WSS-GRA-SRT IN WSS-VARI.
       FIN-BUS-SRT-REG.
           EXIT.

       PRO-CPP SECTION.
       INI-PRO-CPP.
           MOVE 'DEV'                    TO CPP-COD-MVTO IN CPP.
           MOVE WSS-VCAM-ANT IN WSS-VARI TO CPP-COD-VCAM IN CPP.
           MOVE WSS-TOPD-ANT IN WSS-VARI TO CPP-COD-TOPD IN CPP.
           MOVE WSS-AOPD-ANT IN WSS-VARI TO CPP-COD-AOPD IN CPP.
           MOVE SPACES                   TO CPP-COD-SCTB IN CPP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CPP.
           IF NOT FIO-STAT-OKS
              MOVE 'DEV'    TO CPP-COD-MVTO IN CPP
              MOVE '*     ' TO CPP-COD-VCAM IN CPP
              MOVE '*  '    TO CPP-COD-TOPD IN CPP
              MOVE '*  '    TO CPP-COD-AOPD IN CPP
              MOVE SPACES   TO CPP-COD-SCTB IN CPP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM DAP-FIO-CPP
              IF NOT FIO-STAT-OKS
                 DISPLAY 'CPP INEXISTENTE PARA'
                            ' MVTO=' CPP-COD-MVTO IN CPP
                            ' VCAM=' CPP-COD-VCAM IN CPP
                            ' TOPD=' CPP-COD-TOPD IN CPP
                            ' AOPD=' CPP-COD-AOPD IN CPP
                            ' SCTB=' CPP-COD-SCTB IN CPP
                GO TO FIN-PRO-CPP.

           PERFORM PRO-TRIO-CPP VARYING WSS-I
                           FROM 1 BY 1 UNTIL WSS-I > 20.
       FIN-PRO-CPP.
           EXIT.

       PRO-TRIO-CPP SECTION.
       INI-PRO-TRIO-CPP.
      * BUSCA DCC DE REAJUSTES SOLO PARA MONEDA REAJUSTABLES
           IF CPP-COD-TCCT IN CPP(WSS-I) NOT > SPACES OR
              CPP-COD-DBHB IN CPP(WSS-I) NOT > SPACES OR
              CPP-COD-TALG IN CPP(WSS-I) NOT > SPACES
              GO TO FIN-PRO-TRIO-CPP.

           IF ( CPP-COD-TCCT IN CPP(WSS-I) = WSS-COD-RPA OR
                                             WSS-COD-RPP )
                        AND
              ( WSS-VCAM-ANT IN WSS-VARI   = WSS-COD-0999 OR
                                             WSS-COD-1013 )
                        GO TO FIN-PRO-TRIO-CPP.

      * ACCESO A DCC
           MOVE 'DCC'                      TO DCC-COD-TTAB IN DCC.
           MOVE CPP-COD-TCCT IN CPP(WSS-I) TO DCC-COD-TCCT IN DCC.
           MOVE WSS-VCAM-ANT IN WSS-VARI   TO DCC-COD-VCAM IN DCC.
           MOVE WSS-TOPD-ANT IN WSS-VARI   TO DCC-COD-TOPD IN DCC.
           MOVE WSS-AOPD-ANT IN WSS-VARI   TO DCC-COD-AOPD IN DCC.
           MOVE WSS-PLZO-ANT IN WSS-VARI   TO DCC-COD-PLZO IN DCC.
           MOVE CPP-COD-SCTB IN CPP        TO DCC-COD-SCTB IN DCC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-DCC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'DCC INEXISTENTE PARA : '
                       'TCCT=' DCC-COD-TCCT IN DCC
                       'VCAM=' DCC-COD-VCAM IN DCC
                       'COPD=' DCC-COD-COPD IN DCC
                       'PLZO=' DCC-COD-PLZO IN DCC
                       'SCTB=' DCC-COD-SCTB IN DCC
                        GO TO FIN-PRO-TRIO-CPP.

      *       Intereses Pagados o Por Pagar
           IF CPP-COD-TALG IN CPP(WSS-I) = 'I'
      *       Intereses Pagados
               IF DCC-COD-TCCT IN DCC = WSS-COD-IPA
                   MOVE DCC-GLS-CCSB IN DCC TO WSS-CIC-CIPA
               ELSE
      *       Intereses Por Pagar
               IF DCC-COD-TCCT IN DCC = WSS-COD-IPP
                   MOVE DCC-GLS-CCSB IN DCC TO WSS-CIC-CIPP.

      *       Reajustes Pagados o Por Pagar
           IF CPP-COD-TALG IN CPP(WSS-I) = 'K'
      *       Reajustes Pagados
               IF DCC-COD-TCCT IN DCC = WSS-COD-RPA
                   MOVE DCC-GLS-CCSB IN DCC TO WSS-CIC-CRPA
               ELSE
      *       Reajustes Por Pagar
               IF DCC-COD-TCCT IN DCC = WSS-COD-RPP
                   MOVE DCC-GLS-CCSB IN DCC TO WSS-CIC-CRPP.

           PERFORM GEN-REG-CTB-CTI.
           PERFORM GEN-REG-CTB-CID.
       FIN-PRO-TRIO-CPP.
           EXIT.

       GEN-REG-CTB-CTI SECTION.
       INI-GEN-REG-CTB-CTI.
           DISPLAY 'CTI ' WSS-TOT-INTD IN WSS-RID ' '
                          WSS-TOT-READ IN WSS-RID ' ' 
                          CPP-COD-TCCT IN CPP(WSS-I) ' ' 
                          CPP-COD-DBHB IN CPP(WSS-I) ' ' 
                          CPP-COD-TALG IN CPP(WSS-I). 

      *    Monto Debe/Haber
           MOVE ZEROES TO WSS-VAL-MONT IN WSS-VARI.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'I' 
      *       Intereses Pagados o Por Pagar
              MOVE WSS-TOT-INTD IN WSS-RID TO 
                                     WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-CTB-CTI
              ELSE
                 GO TO NXT-GEN-REG-CTB-CTI.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'K' 
      *       Reajustes Pagados o Por Pagar
              MOVE WSS-TOT-READ IN WSS-RID TO 
                                    WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-CTB-CTI
              ELSE
                 GO TO NXT-GEN-REG-CTB-CTI.

       NXT-GEN-REG-CTB-CTI.
      *JVM ini  20-OCT-1992
           MOVE SPACES TO WSS-IND-DBHB IN WSS-VARI.
      *     MOVE ZEROES TO WSS-VAL-DEBE IN SRT
      *                    WSS-VAL-HABE IN SRT.
      *    Indicador Debe Haber
           IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
      *        HABER
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI
      *         MOVE WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-HABE IN SRT
      *         MOVE ZEROES                   TO WSS-VAL-DEBE IN SRT
           ELSE
      *        DEBE
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI.
      *         MOVE WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-DEBE IN SRT
      *         MOVE ZEROES                   TO WSS-VAL-HABE IN SRT.

           MOVE DCC-COD-VCAM IN DCC TO WSS-COD-VCAM IN WSS-VARI.

      *JVM ini  20-OCT-1992
      *     IF WSS-COD-TVAL IN WSS-VARI = '0'
      *         ADD      WSS-VAL-DEBE IN SRT TO
      *                  WSS-VAL-LTN1-DEBE IN WSS-VARI
      *         ADD      WSS-VAL-HABE IN SRT TO
      *                  WSS-VAL-LTN1-HABE IN WSS-VARI
      *     ELSE
      *     IF WSS-COD-TVAL IN WSS-VARI = '1'
      *         ADD      WSS-VAL-DEBE IN SRT TO
      *                  WSS-VAL-LTX1-DEBE IN WSS-VARI
      *         ADD      WSS-VAL-HABE IN SRT TO
      *                  WSS-VAL-LTX1-HABE IN WSS-VARI.
      *     ADD WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-LOT1 IN WSS-VARI.
      *JVM fin  20-OCT-1992

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF = 'S'

           IF WSS-COD-TVAL IN WSS-VARI = '1'
      *Genera registro CT2 Interfaz Contable Moneda Extranjera
              PERFORM GEN-REG-CT2
           ELSE
      *Genera registro CT1 Interfaz Contable Moneda Chilena
              PERFORM GEN-REG-CT1.
       FIN-GEN-REG-CTB-CTI.
           EXIT.

       GEN-REG-CTB-CID SECTION.
       INI-GEN-REG-CTB-CID.
           DISPLAY ' '.
           DISPLAY 'CID ' WSS-TOT-INTD-1 IN WSS-RID ' '
                          WSS-TOT-READ-1 IN WSS-RID ' ' 
                          CPP-COD-TCCT IN CPP(WSS-I) ' ' 
                          CPP-COD-DBHB IN CPP(WSS-I) ' ' 
                          CPP-COD-TALG IN CPP(WSS-I). 

      *    Monto Debe/Haber
           MOVE ZEROES TO WSS-VAL-MONT IN WSS-VARI.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'I'
      *       Intereses Pagados  y/o Por Pagar
              MOVE WSS-TOT-INTD-1 IN WSS-RID TO 
                                    WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-CTB-CID
              ELSE
                 GO TO NXT-GEN-REG-CTB-CID.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'K'
      *       Reajustes Pagados y/o Por Pagar
              MOVE WSS-TOT-READ-1 IN WSS-RID TO 
                                    WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-CTB-CID
              ELSE
                 GO TO NXT-GEN-REG-CTB-CID.

       NXT-GEN-REG-CTB-CID.
      *JVM ini  20-OCT-1992
           MOVE SPACES TO WSS-IND-DBHB IN WSS-VARI.
      *     MOVE ZEROES TO WSS-VAL-DEBE IN SRT
      *                    WSS-VAL-HABE IN SRT.
      *    Indicador Debe Haber
           IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
      *        DEBE
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI
      *         MOVE WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-DEBE IN SRT
      *         MOVE ZEROES                   TO WSS-VAL-HABE IN SRT
           ELSE
      *        HABER
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI.
      *         MOVE WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-HABE IN SRT
      *         MOVE ZEROES                   TO WSS-VAL-DEBE IN SRT.

           MOVE DCC-COD-VCAM IN DCC TO WSS-COD-VCAM IN WSS-VARI.

      *     IF WSS-COD-TVAL IN WSS-VARI = '0'
      *         ADD      WSS-VAL-DEBE IN SRT TO
      *                  WSS-VAL-LTN1-DEBE IN WSS-VARI
      *         ADD      WSS-VAL-HABE IN SRT TO
      *                  WSS-VAL-LTN1-HABE IN WSS-VARI
      *     ELSE
      *     IF WSS-COD-TVAL IN WSS-VARI = '1'
      *         ADD      WSS-VAL-DEBE IN SRT TO
      *                  WSS-VAL-LTX1-DEBE IN WSS-VARI
      *         ADD      WSS-VAL-HABE IN SRT TO
      *                  WSS-VAL-LTX1-HABE IN WSS-VARI.
      *     ADD WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-LOT1 IN WSS-VARI.
      *JVM fin  20-OCT-1992

           IF WSS-IND-GITF = 'S'

           IF WSS-COD-TVAL IN WSS-VARI = '1'
      *Genera registro CT2 Interfaz Contable Moneda Extranjera
              PERFORM GEN-REG-CT2
           ELSE
      *Genera registro CT1 Interfaz Contable Moneda Chilena
              PERFORM GEN-REG-CT1.
       FIN-GEN-REG-CTB-CID.
           EXIT.

      * Formacion y Generacion del Registro CT1 al Procesar Varios Reg.
       GEN-REG-CT1 SECTION.
       INI-GEN-REG-CT1.
      * Obtencion de CIC para registro Contable CT1 / CT2
           MOVE 'C710'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                       CIC-CIC-ICIC IN CIC
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
           MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-ITEM IN WSS-VARI.

      * Formacion del Registro MC1
           MOVE 'PT'                     TO MC1-COD-IDAR IN MC1.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC1-NUM-ITEM IN MC1.
           MOVE 1                        TO MC1-COD-IDRE IN MC1.
           MOVE 'BCI ' TO MC1-IND-MONE IN MC1.

           IF WSS-IND-DBHB IN WSS-VARI = 'H'
              MOVE 60 TO MC1-IND-DBHB IN MC1
           ELSE
              MOVE 10 TO MC1-IND-DBHB IN MC1.

           MOVE WSS-VAL-MONT IN WSS-VARI TO MC1-VAL-MONT IN MC1.

           IF WSS-IND-DBHB IN WSS-VARI = 'D'
                   ADD WSS-VAL-MONT IN WSS-VARI TO
                       WSS-VAL-LTN1-DEBE IN WSS-VARI
           ELSE
                   ADD WSS-VAL-MONT IN WSS-VARI TO
                       WSS-VAL-LTN1-HABE IN WSS-VARI.
           DISPLAY 'SUBTOTAL MNAC '.
           DISPLAY 'MONTO ' WSS-VAL-MONT IN WSS-VARI .
           DISPLAY 'DEBE  ' WSS-VAL-LTN1-DEBE IN WSS-VARI.
           DISPLAY 'HABER ' WSS-VAL-LTN1-HABE IN WSS-VARI.

           MOVE DCC-GLS-CCSB IN DCC TO MC1-NUM-CCTB IN MC1.
      *JVM 22/09/92
           MOVE '0'                 TO WSS-COD-OFI0 IN WSS-VARI.
           MOVE OPD-COD-OFIC IN SRT TO WSS-COD-OFI1 IN WSS-VARI.
           MOVE SPACES              TO WSS-GLS-RES1 IN WSS-VARI.
           MOVE WSS-COD-CCO1 IN WSS-VARI TO MC1-COD-CCOS IN MC1.
      *JVM 
           MOVE 'DPZ' TO MC1-COD-SIST IN MC1.

      *JVM 27/05/93
           MOVE WSS-FEC-FTER IN WSS-VARI TO WSS-FEC-FREG IN WSS-VARI.
           PERFORM BUS-SIG-HBL.           
           MOVE WSS-NUM-DREG IN WSS-VARI TO MC1-NUM-DMOV IN MC1.
           MOVE WSS-NUM-MREG IN WSS-VARI TO MC1-NUM-MMOV IN MC1.
           MOVE WSS-NUM-AREG IN WSS-VARI TO MC1-NUM-AMOV IN MC1.
      *JVM 
           MOVE MC1    TO WSS-GLS-MC11 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL1 IN WSS-VARI.
           MOVE WSS-GLS-MC1 TO CT1.

      * Genera el Registro del Archivo CT1(MC1).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC1
                       ' FS: ' FIO-STAT
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.

      * Formacion del Registro MC2
           MOVE SPACES TO MC2.
           MOVE 'PT' TO MC2-COD-IDAR IN MC2.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC2-NUM-ITEM IN MC2.
           MOVE 2    TO MC2-COD-IDRE IN MC2.

      *JVM 22/09/92
           MOVE SPACES TO MC2-CIC-IOPD IN MC2.
           MOVE SPACES TO MC2-CIC-ISER IN MC2.
           MOVE SPACES TO MC2-COD-VCAM IN MC2.
           MOVE SPACES TO MC2-COD-COPD IN MC2.
           MOVE SPACES TO MC2-COD-PROY IN MC2.
           MOVE SRT-SGV-TINT IN SRT TO MC2-SGV-TINT IN MC2.
           MOVE SPACES TO MC2-GLS-DISP IN MC2.
      *JVM 
      *JVM 28/05/93
           MOVE SPACES TO WSS-GLS-CTBL IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'PCC'               TO TAB-COD-TTAB IN TAB.
           MOVE DCC-GLS-CCSB IN DCC TO TAB-COD-CTAB IN TAB.
      *     MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CCTA IN WSS-VARI.
           MOVE '/'                 TO WSS-GLS-BLAN IN WSS-VARI.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-ACTB IN WSS-VARI.
           MOVE SPACES                   TO WSS-GLS-REST IN WSS-VARI.
           MOVE WSS-GLS-CTBL IN WSS-VARI TO MC2-GLS-DESC IN MC2.
      *JVM 
           MOVE MC2    TO WSS-GLS-MC21 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL2 IN WSS-VARI.
           MOVE WSS-GLS-MC2 TO CT1.

      * Genera el Registro del Archivo CT1(MC2).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC2
                       ' FS: ' FIO-STAT
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.

      * Formacion del Registro MC3
           MOVE 'PT' TO MC3-COD-IDAR IN MC3.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC3-NUM-ITEM IN MC3.
           MOVE 3    TO MC3-COD-IDRE IN MC3.

      *     MOVE WSS-VAL-MONT IN WSS-VARI TO MC3-VAL-MEST IN MC3.
           MOVE ZEROES TO MC3-VAL-MEST IN MC3.

           MOVE ZEROES TO MC3-COD-MONE IN MC3.
           MOVE ZEROES TO MC3-VAL-MCON IN MC3.
           MOVE ZEROES TO MC3-VAL-VCAM IN MC3.
           MOVE MC3    TO WSS-GLS-MC31 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL3 IN WSS-VARI.
           MOVE WSS-GLS-MC3 TO CT1.

      * Genera el Registro del Archivo CT1(MC3).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC3
                       ' FS: ' FIO-STAT
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.
       FIN-GEN-REG-CT1.
           EXIT.

       GEN-REG-CT2 SECTION.
       INI-GEN-REG-CT2.
      * Formacion del Registro MC1
           MOVE 'C710'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                       CIC-CIC-ICIC IN CIC
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin
           MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-ITEM IN WSS-VARI.

      * Formacion del Registro MC1
           MOVE 'PT'                     TO MC1-COD-IDAR IN MC1.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC1-NUM-ITEM IN MC1.
           MOVE 1                        TO MC1-COD-IDRE IN MC1.

           IF WSS-IND-DBHB IN WSS-VARI = 'H'
              MOVE 60 TO MC1-IND-DBHB IN MC1
           ELSE
              MOVE 10 TO MC1-IND-DBHB IN MC1.

           MOVE WSS-VAL-MONT IN WSS-VARI TO MC1-VAL-MONT IN MC1.
           IF WSS-IND-DBHB IN WSS-VARI = 'D'
                   ADD WSS-VAL-MONT IN WSS-VARI TO
                       WSS-VAL-LTX1-DEBE IN WSS-VARI
           ELSE
                   ADD WSS-VAL-MONT IN WSS-VARI TO
                       WSS-VAL-LTX1-HABE IN WSS-VARI.
           DISPLAY 'SUBTOTAL MEXT '.
           DISPLAY 'MONTO ' WSS-VAL-MONT IN WSS-VARI .
           DISPLAY 'DEBE  ' WSS-VAL-LTX1-DEBE IN WSS-VARI.
           DISPLAY 'HABER ' WSS-VAL-LTX1-HABE IN WSS-VARI.

           MOVE 'BCIX'                   TO MC1-IND-MONE IN MC1.
           MOVE DCC-GLS-CCSB IN DCC      TO MC1-NUM-CCTB IN MC1.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-EXT-CTAB IN TAB TO WSS-COD-MONE IN WSS-VARI.
           MOVE '000'               TO WSS-GLS-RES2 IN WSS-VARI.
           MOVE OPD-COD-OFIC IN SRT TO WSS-COD-OFI2 IN WSS-VARI
                                       WSS-COD-OFI3 IN WSS-VARI
                                       OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           IF MSG-COD-MENS  NOT > SPACES
              MOVE OFI-COD-OFCO IN OFI TO WSS-COD-OFI2 IN WSS-VARI.

           MOVE WSS-COD-CCO2 IN WSS-VARI TO MC1-COD-CCOS IN MC1.
           MOVE 'DPZ' TO MC1-COD-SIST IN MC1.

      *JVM 27/05/93
           MOVE WSS-FEC-FTER IN WSS-VARI TO WSS-FEC-FREG IN WSS-VARI.
           PERFORM BUS-SIG-HBL.           
           MOVE WSS-NUM-DREG IN WSS-VARI TO MC1-NUM-DMOV IN MC1.
           MOVE WSS-NUM-MREG IN WSS-VARI TO MC1-NUM-MMOV IN MC1.
           MOVE WSS-NUM-AREG IN WSS-VARI TO MC1-NUM-AMOV IN MC1.
      *JVM 
           MOVE MC1    TO WSS-GLS-MC11 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL1 IN WSS-VARI.
           MOVE WSS-GLS-MC1 TO CT2.

      * Genera el Registro del Archivo CT2(MC1).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT2: ' MC1
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.

      * Formacion del Registro MC2
           MOVE SPACES TO MC2.
           MOVE 'PT' TO MC2-COD-IDAR IN MC2.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC2-NUM-ITEM IN MC2.
           MOVE 2    TO MC2-COD-IDRE IN MC2.

      *JVM 22/09/92
           MOVE SPACES TO MC2-CIC-IOPD IN MC2.
           MOVE SPACES TO MC2-CIC-ISER IN MC2.
           MOVE SPACES TO MC2-COD-VCAM IN MC2.
           MOVE SPACES TO MC2-COD-COPD IN MC2.
           MOVE SPACES TO MC2-COD-PROY IN MC2.
           MOVE SRT-SGV-TINT IN SRT TO MC2-SGV-TINT IN MC2.
           MOVE SPACES TO MC2-GLS-DISP IN MC2.
      *JVM 
      *JVM 28/05/93
           MOVE SPACES TO WSS-GLS-CTBL IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST
           MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
           MOVE DCC-GLS-CCSB IN DCC TO TAB-COD-CTAB IN TAB.
      *     MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CCTA IN WSS-VARI
           MOVE '/'                 TO WSS-GLS-BLAN IN WSS-VARI
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-ACTB IN WSS-VARI.
           MOVE SPACES                   TO WSS-GLS-REST IN WSS-VARI.
           MOVE WSS-GLS-CTBL IN WSS-VARI TO MC2-GLS-DESC IN MC2.
      *JVM 
           MOVE MC2    TO WSS-GLS-MC21 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL2 IN WSS-VARI.
           MOVE WSS-GLS-MC2 TO CT2.

      * Genera el Registro del Archivo CT1(MC2).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC2
                       ' FS: ' FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.

      * Formacion del Registro MC3
           MOVE 'PT' TO MC3-COD-IDAR IN MC3.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC3-NUM-ITEM IN MC3.
           MOVE 3    TO MC3-COD-IDRE IN MC3.

      *     MOVE WSS-VAL-MONT IN WSS-VARI TO MC3-VAL-MEST IN MC3.
           MOVE ZEROES TO MC3-VAL-MEST IN MC3.

           MOVE ZEROES TO MC3-COD-MONE IN MC3.
           MOVE ZEROES TO MC3-VAL-MCON IN MC3.
           MOVE ZEROES TO MC3-VAL-VCAM IN MC3.
           MOVE MC3    TO WSS-GLS-MC31 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL3 IN WSS-VARI.
           MOVE WSS-GLS-MC3 TO CT2.

      * Genera el Registro del Archivo CT2(MC3).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC3
                       ' FS: ' FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.
       FIN-GEN-REG-CT2.
           EXIT.

       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
           PERFORM GET-CUR-RCC.
           IF WSS-STAT-RCC IN WSS-VARI = 0
               PERFORM GET-NXT-RCC
               IF WSS-IND-MCLI IN WSS-VARI = 'M'
                   MOVE ZEROES TO DBC-NUM-ICLI IN DBC
                   MOVE SPACES TO DBC-VRF-ICLI IN DBC
                   MOVE SPACES TO DBC-GLS-ICLI IN DBC
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'OPD    MCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE 'M' TO DBC-IND-ICLI IN DBC
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               ELSE
                   PERFORM GET-CUR-RCC
                   PERFORM GET-RCC-DBC
           ELSE
              PERFORM RST-DBC.
       FIN-BUS-REG-CLI.
           EXIT.

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE 0  TO WSS-STAT-RCC IN WSS-VARI.
           MOVE OPD-CAI-IOPD IN SRT TO RCC-CAI-IOPD IN RCC.
           MOVE OPD-IIC-IOPD IN SRT TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-RCC IN WSS-VARI.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CAI-IOPD IN SRT = RCC-CAI-IOPD IN RCC AND
              OPD-IIC-IOPD IN SRT = RCC-IIC-IOPD IN RCC
                MOVE 'M'    TO WSS-IND-MCLI IN WSS-VARI
           ELSE
                MOVE SPACES TO WSS-IND-MCLI IN WSS-VARI.
       FIN-GET-NXT-RCC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RCC-DBC SECTION.
       INI-GET-RCC-DBC.
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
              MOVE '-' TO WSS-GLS-RAYA IN WSS-BID
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
              IF DBC-GLS-ICLI IN DBC NOT > SPACES
                 MOVE SPACES TO WSS-GLS-AUXI IN WSS-BID
              ELSE
                 MOVE '-' TO WSS-GLS-AUXI IN WSS-BID.
       FIN-GET-RCC-DBC.
           EXIT.

      * Limpia datos cliente
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE SPACES TO WSS-GLS-AUXI IN WSS-BID.
           MOVE SPACES TO WSS-GLS-RAYA IN WSS-BID.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

       BUS-ULT-HAB SECTION.
       INI-BUS-ULT-HAB.
      * BUS-ULTIMO-DIA-HABIL
           MOVE WSS-FEC-FFIN TO FEC-FECH.
       LUP-BUS-ULT-HAB.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
              GO TO LUP-BUS-ULT-HAB.

       NOT-BUS-ULT-HAB.
           MOVE FEC-FECH TO WSS-FEC-FFIN.
           DISPLAY 'FECHA DE PROCESO        : ' WSS-FEC-FPRO.
           DISPLAY 'FECHA ULT. DIA HABIL MES: ' WSS-FEC-FFIN.
       FIN-BUS-ULT-HAB.
           EXIT.

      *JVM fin  27-05-93
       BUS-SIG-HBL SECTION.
       INI-BUS-SIG-HBL.
           MOVE WSS-FEC-FREG IN WSS-VARI TO WSS-FEC-FAMD.
           MOVE WSS-NUM-DAMD TO FEC-ITM1.
           MOVE WSS-NUM-MAMD TO FEC-ITM2.
           MOVE WSS-NUM-SAMD TO FEC-ITM3.
           MOVE WSS-NUM-AAMD TO FEC-ITM4.
       LUP-NXT-HBL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE 1 TO FEC-NDIA
               PERFORM CAL-FEC
               GO TO LUP-NXT-HBL.
           MOVE FEC-ITM1 TO WSS-NUM-DAMD.
           MOVE FEC-ITM2 TO WSS-NUM-MAMD.
           MOVE FEC-ITM3 TO WSS-NUM-SAMD.
           MOVE FEC-ITM4 TO WSS-NUM-AAMD.
           MOVE WSS-FEC-FAMD TO WSS-FEC-FREG IN WSS-VARI.
       FIN-BUS-SIG-HBL.
           EXIT.
      *JVM fin  27-05-93

      *Entidades  de GNS
       COPY GNSBFCIC.
       COPY GNSBGCIC.
       COPY GNSBFMSC.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
      *Entidades  de SGC
       COPY SGCBFDBC.
      *Entidades  de DAP
       COPY DAPBFRCC.
       COPY DAPBFDCC.
       COPY DAPBFCPP.
       COPY DAPBFCTI.
       COPY DAPBFOPD.
      *CST 
      *COPY DAPBFCT1.
      *COPY DAPBFCT2.
      *BCI 
       COPY DAPBSCT1.
       COPY DAPBSCT2.
      *Entidades  de TAB
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
      *>>>>
