      *
      * DAPBQM2I
      * Version 3.0.1 Nov-2005
      * 07-Nov-11 07:12 PM
      *
       SET-TAG-DAPBQM2I SECTION.
       INI-SET-TAG-DAPBQM2I.
           MOVE
           '<IDNMOD NOM=$DAPBQM2I$ VSN=$11.11.07$ VGM=$3.0.1$
      -    'GEN=$07-Nov-11 07:12 PM$ FNC=$110334$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBQM2I.
           EXIT.
           
       PUT-ALL-M2I SECTION.
       INI-PUT-ALL-M2I.
           PERFORM PUT-OPD-M2I.
       FIN-PUT-ALL-M2I.
           EXIT.
       
       PUT-OPD-M2I SECTION.
       INI-PUT-OPD-M2I.
           IF PGM-STAT-OPD-NUL
               GO TO FIN-PUT-OPD-M2I.
           IF NOT PGM-STAT-OPD-OKS
               PERFORM CLR-OPD-M2I
               GO TO FIN-PUT-OPD-M2I.
           MOVE OPD-CAI-IOPD IN OPD TO OPD-CAI-IOPD IN M2I-FLD.
           MOVE OPD-IIC-IOPD IN OPD TO OPD-IIC-IOPD IN M2I-FLD.
       FIN-PUT-OPD-M2I.
           EXIT.
       
       KEY-ALL-M2I SECTION.
       INI-KEY-ALL-M2I.
           PERFORM KEY-OPD-M2I.
       FIN-KEY-ALL-M2I.
           EXIT.
       
       KEY-OPD-M2I SECTION.
       INI-KEY-OPD-M2I.
       FIN-KEY-OPD-M2I.
           EXIT.
       
       SCR-CLRA-M2I SECTION.
       INI-SCR-CLRA-M2I.
           PERFORM CLR-KEY-M2I.
           PERFORM CLR-FLD-M2I.
       FIN-SCR-CLRA-M2I.
           EXIT.
       
       CLR-KEY-M2I SECTION.
       INI-CLR-KEY-M2I.
           MOVE SPACES TO FRM-COD-COLA IN M2I-FLD.
           MOVE ZEROES TO FRM-NUM-NITM IN M2I-FLD.
           MOVE ZEROES TO FRM-NUM-LITM IN M2I-FLD.
       FIN-CLR-KEY-M2I.
           EXIT.
       
       CLR-FLD-M2I SECTION.
       INI-CLR-FLD-M2I.
           MOVE SPACES TO FRM-COD-EVEN IN M2I-FLD.
           MOVE SPACES TO FRM-COD-CPTO IN M2I-FLD.
           MOVE SPACES TO FRM-COD-TCON IN M2I-FLD.
           MOVE SPACES TO FRM-CIC-IOPE IN M2I-FLD.
           MOVE SPACES TO FRM-CIC-ICLI IN M2I-FLD.
           MOVE SPACES TO FRM-COD-RTBL IN M2I-FLD.
           MOVE SPACES TO FRM-COD-COMP IN M2I-FLD.
           MOVE SPACES TO FRM-COD-TCNL IN M2I-FLD.
           MOVE SPACES TO FRM-COD-CNAL IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VCOC IN M2I-FLD.
           MOVE SPACES TO FRM-COD-COOC IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-MOPE IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VCMO IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-SOPE IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VSOP IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-FINA IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VCFN IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-INTE IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VCIN IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-VASG IN M2I-FLD.
           MOVE SPACES TO FRM-COD-VCVA IN M2I-FLD.
           MOVE ZEROES TO FRM-VAL-PLZO IN M2I-FLD.
           MOVE SPACES TO FRM-COD-UTPZ IN M2I-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FCON IN M2I-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FUNO IN M2I-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           PERFORM CLR-OPD-M2I.
       FIN-CLR-FLD-M2I.
           EXIT.
       
       CLR-OPD-M2I SECTION.
       INI-CLR-OPD-M2I.
           MOVE SPACES TO OPD-CAI-IOPD IN M2I-FLD.
           MOVE ZEROES TO OPD-IIC-IOPD IN M2I-FLD.
       FIN-CLR-OPD-M2I.
           EXIT.
       
       FST-KEY-M2I SECTION.
       INI-FST-KEY-M2I.
           MOVE -1 TO FRM-COD-COLA-LEN IN M2I-FLD.
       FIN-FST-KEY-M2I.
           EXIT.
       
       FST-FLD-M2I SECTION.
       INI-FST-FLD-M2I.
           MOVE -1 TO FRM-COD-COMP-LEN IN M2I-FLD.
       FIN-FST-FLD-M2I.
           EXIT.
       
       PRO-KEY-M2I SECTION.
       INI-PRO-KEY-M2I.
           MOVE FRM-CPIM-AEY TO FRM-COD-COLA-ATR IN M2I-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-NITM-ATR IN M2I-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-LITM-ATR IN M2I-FLD.
           PERFORM PRO-IKY-M2I.
           PERFORM PRO-AKY-M2I.
           PERFORM PRO-MKY-M2I.
       FIN-PRO-KEY-M2I.
           EXIT.
       
       PRO-IKY-M2I SECTION.
       INI-PRO-IKY-M2I.
       FIN-PRO-IKY-M2I.
           EXIT.
       
       PRO-MKY-M2I SECTION.
       INI-PRO-MKY-M2I.
       FIN-PRO-MKY-M2I.
           EXIT.
       
       PRO-AKY-M2I SECTION.
       INI-PRO-AKY-M2I.
       FIN-PRO-AKY-M2I.
           EXIT.
       
       UNP-KEY-M2I SECTION.
       INI-UNP-KEY-M2I.
           MOVE FRM-CPIM-UBY TO FRM-COD-COLA-ATR IN M2I-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-NITM-ATR IN M2I-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-LITM-ATR IN M2I-FLD.
           PERFORM UNP-IKY-M2I.
           PERFORM UNP-AKY-M2I.
           PERFORM UNP-MKY-M2I.
       FIN-UNP-KEY-M2I.
           EXIT.
       
       UNP-IKY-M2I SECTION.
       INI-UNP-IKY-M2I.
           MOVE FRM-CPIM-UBY TO FRM-COD-COLA-ATR.
           MOVE FRM-CPIM-UBY TO FRM-NUM-NITM-ATR.
           MOVE FRM-CPIM-UBY TO FRM-NUM-LITM-ATR.
       FIN-UNP-IKY-M2I.
           EXIT.
       
       UNP-MKY-M2I SECTION.
       INI-UNP-MKY-M2I.
       FIN-UNP-MKY-M2I.
           EXIT.
       
       UNP-AKY-M2I SECTION.
       INI-UNP-AKY-M2I.
       FIN-UNP-AKY-M2I.
           EXIT.
       
       UNP-FLD-M2I SECTION.
       INI-UNP-FLD-M2I.
           MOVE FRM-CPIM-UBY TO FRM-COD-COMP-ATR IN M2I-FLD.
           PERFORM UNP-OPD-M2I.
       FIN-UNP-FLD-M2I.
           EXIT.
       
       UNP-OPD-M2I SECTION.
       INI-UNP-OPD-M2I.
       FIN-UNP-OPD-M2I.
           EXIT.
       
       VAL-KEY-M2I SECTION.
       INI-VAL-KEY-M2I.
           PERFORM VAL-IKY-M2I.
           PERFORM VAL-MKY-M2I.
           PERFORM VAL-AKY-M2I.
       FIN-VAL-KEY-M2I.
           EXIT.
       
       VAL-IKY-M2I SECTION.
       INI-VAL-IKY-M2I.
           PERFORM VAL-FRM-COD-COLA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-COLA-LEN IN M2I-FLD
                GO TO FIN-VAL-IKY-M2I.
           PERFORM VAL-FRM-NUM-NITM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-NITM-LEN IN M2I-FLD
                GO TO FIN-VAL-IKY-M2I.
           PERFORM VAL-FRM-NUM-LITM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-LITM-LEN IN M2I-FLD
                GO TO FIN-VAL-IKY-M2I.
       FIN-VAL-IKY-M2I.
           EXIT.
       
       VAL-MKY-M2I SECTION.
       INI-VAL-MKY-M2I.
       FIN-VAL-MKY-M2I.
           EXIT.
       
       VAL-AKY-M2I SECTION.
       INI-VAL-AKY-M2I.
       FIN-VAL-AKY-M2I.
           EXIT.
       
       VAL-FRM-COD-COLA SECTION.
       INI-VAL-FRM-COD-COLA.
           IF FRM-COD-COLA IN M2I-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-COLA IN M2I-FLD.
       FIN-VAL-FRM-COD-COLA.
           EXIT.
       
       VAL-FRM-NUM-NITM SECTION.
       INI-VAL-FRM-NUM-NITM.
       FIN-VAL-FRM-NUM-NITM.
           EXIT.
       
       VAL-FRM-NUM-LITM SECTION.
       INI-VAL-FRM-NUM-LITM.
       FIN-VAL-FRM-NUM-LITM.
           EXIT.
       
       VAL-CON-KEY-M2I SECTION.
       INI-VAL-CON-KEY-M2I.
           IF     FRM-COD-COLA IN M2I-FLD NOT > SPACES 
              AND FRM-NUM-NITM IN M2I-FLD NOT > ZEROES 
              AND FRM-NUM-LITM IN M2I-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-M2I.
       FIN-VAL-CON-KEY-M2I.
           EXIT.
       
       VAL-CON-IKY-M2I SECTION.
       INI-VAL-CON-IKY-M2I.
           IF     FRM-COD-COLA IN M2I-FLD NOT > SPACES 
              AND FRM-NUM-NITM IN M2I-FLD NOT > ZEROES 
              AND FRM-NUM-LITM IN M2I-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-M2I.
       FIN-VAL-CON-IKY-M2I.
           EXIT.
       
       VAL-NUM-KEY-M2I SECTION.
       INI-VAL-NUM-KEY-M2I.
           PERFORM VAL-NUM-IKY-M2I.
           PERFORM VAL-NUM-MKY-M2I.
           PERFORM VAL-NUM-AKY-M2I.
       FIN-VAL-NUM-KEY-M2I.
           EXIT.
       
       VAL-NUM-IKY-M2I SECTION.
       INI-VAL-NUM-IKY-M2I.
       VAL-NUM-FRM-NUM-NITM.
           MOVE FRM-NUM-NITM-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-NITM IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-NITM-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-IKY-M2I.
       VAL-NUM-FRM-NUM-LITM.
           MOVE FRM-NUM-LITM-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-LITM IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-LITM-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-IKY-M2I.
       FIN-VAL-NUM-IKY-M2I.
           EXIT.
       
       VAL-NUM-MKY-M2I SECTION.
       INI-VAL-NUM-MKY-M2I.
       FIN-VAL-NUM-MKY-M2I.
           EXIT.
       
       VAL-NUM-AKY-M2I SECTION.
       INI-VAL-NUM-AKY-M2I.
       FIN-VAL-NUM-AKY-M2I.
           EXIT.
       
       VAL-NUM-FLD-M2I SECTION.
       INI-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-MOPE.
           MOVE FRM-VAL-MOPE-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-MOPE IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-MOPE-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-SOPE.
           MOVE FRM-VAL-SOPE-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-SOPE IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-SOPE-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-FINA.
           MOVE FRM-VAL-FINA-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-FINA IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-FINA-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-INTE.
           MOVE FRM-VAL-INTE-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-INTE IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-INTE-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-VASG.
           MOVE FRM-VAL-VASG-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-VASG IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-VASG-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-FRM-VAL-PLZO.
           MOVE FRM-VAL-PLZO-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-VAL-PLZO IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-PLZO-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       VAL-NUM-OPD-IIC-IOPD.
           MOVE OPD-IIC-IOPD-ALF IN M2I-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OPD-IIC-IOPD IN M2I-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OPD-IIC-IOPD-LEN IN M2I-FLD
                GO TO FIN-VAL-NUM-FLD-M2I.
       FIN-VAL-NUM-FLD-M2I.
           EXIT.
       
       EDT-KEY-M2I SECTION.
       INI-EDT-KEY-M2I.
           PERFORM EDT-IKY-M2I.
           PERFORM EDT-MKY-M2I.
           PERFORM EDT-AKY-M2I.
       FIN-EDT-KEY-M2I.
           EXIT.
       
       EDT-IKY-M2I SECTION.
       INI-EDT-IKY-M2I.
           IF FRM-NUM-NITM-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-NITM-LEN IN M2I-FLD
                GO TO FIN-EDT-IKY-M2I.
           MOVE FRM-NUM-NITM IN M2I-FLD TO FRM-NUM-NITM-EDT IN M2I-EDT.
           MOVE FRM-NUM-NITM-EDT IN M2I-EDT TO 
                FRM-NUM-NITM-ALF IN M2I-FLD.
           IF FRM-NUM-LITM-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-LITM-LEN IN M2I-FLD
                GO TO FIN-EDT-IKY-M2I.
           MOVE FRM-NUM-LITM IN M2I-FLD TO FRM-NUM-LITM-EDT IN M2I-EDT.
           MOVE FRM-NUM-LITM-EDT IN M2I-EDT TO 
                FRM-NUM-LITM-ALF IN M2I-FLD.
       FIN-EDT-IKY-M2I.
           EXIT.
       
       EDT-MKY-M2I SECTION.
       INI-EDT-MKY-M2I.
       FIN-EDT-MKY-M2I.
           EXIT.
       
       EDT-AKY-M2I SECTION.
       INI-EDT-AKY-M2I.
       FIN-EDT-AKY-M2I.
           EXIT.
       
       EDT-FLD-M2I SECTION.
       INI-EDT-FLD-M2I.
           IF FRM-VAL-MOPE-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MOPE-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-MOPE IN M2I-FLD TO FRM-VAL-MOPE-EDT IN M2I-EDT.
           MOVE FRM-VAL-MOPE-EDT IN M2I-EDT TO 
                FRM-VAL-MOPE-ALF IN M2I-FLD.
           IF FRM-VAL-SOPE-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-SOPE-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-SOPE IN M2I-FLD TO FRM-VAL-SOPE-EDT IN M2I-EDT.
           MOVE FRM-VAL-SOPE-EDT IN M2I-EDT TO 
                FRM-VAL-SOPE-ALF IN M2I-FLD.
           IF FRM-VAL-FINA-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-FINA-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-FINA IN M2I-FLD TO FRM-VAL-FINA-EDT IN M2I-EDT.
           MOVE FRM-VAL-FINA-EDT IN M2I-EDT TO 
                FRM-VAL-FINA-ALF IN M2I-FLD.
           IF FRM-VAL-INTE-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-INTE-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-INTE IN M2I-FLD TO FRM-VAL-INTE-EDT IN M2I-EDT.
           MOVE FRM-VAL-INTE-EDT IN M2I-EDT TO 
                FRM-VAL-INTE-ALF IN M2I-FLD.
           IF FRM-VAL-VASG-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-VASG-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-VASG IN M2I-FLD TO FRM-VAL-VASG-EDT IN M2I-EDT.
           MOVE FRM-VAL-VASG-EDT IN M2I-EDT TO 
                FRM-VAL-VASG-ALF IN M2I-FLD.
           IF FRM-VAL-PLZO-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-PLZO-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE FRM-VAL-PLZO IN M2I-FLD TO FRM-VAL-PLZO-EDT IN M2I-EDT.
           MOVE FRM-VAL-PLZO-EDT IN M2I-EDT TO 
                FRM-VAL-PLZO-ALF IN M2I-FLD.
           IF OPD-IIC-IOPD-LEN IN M2I-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPD-IIC-IOPD-LEN IN M2I-FLD
                GO TO FIN-EDT-FLD-M2I.
           MOVE OPD-IIC-IOPD IN M2I-FLD TO OPD-IIC-IOPD-EDT IN M2I-EDT.
           MOVE OPD-IIC-IOPD-EDT IN M2I-EDT TO 
                OPD-IIC-IOPD-ALF IN M2I-FLD.
       FIN-EDT-FLD-M2I.
           EXIT.
