       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DAPPPPOD.
       AUTHOR.       BEE.
       DATE-WRITTEN. 29-MAY-2003
      
      * Consulta masiva Plantillas de Operaciones de Deposito a Plazo
      
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
      
       DATA DIVISION.
      *==============
      
       WORKING-STORAGE SECTION.
      *------------------------
       01  WSS-INI-DBG   VALUE 'INICIO-DBG'       PIC X(12).
       01  WSS-COD-DBG   VALUE SPACES             PIC X(05).
       01  WSS-MSG-DBG   VALUE SPACES             PIC X(15).
       01  WSS-FIN-DBG   VALUE 'FINAL -DBG'       PIC X(12).
       01  WSS-AUXI                               PIC X(500).
       COPY GNSWGQUE.
       COPY GNSWGTSK.
       COPY GNSWVSCR.
      *AMB01  SCR-VARI.
      *AMB     05 SCR-SIST     VALUE 'SGC'    PIC X(03).
      
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFRM.
      
       COPY DAPWGPOD.
      
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POD-REQA==.
       COPY DAPBRPOD.
      
      
       01  WSS-VARI.
           03 WSS-I                                   PIC 9(02).
           03 WSS-IMAX            VALUE 30            PIC 9(02).
           03 WSS-IND-ERR                             PIC X(01).
      * Auxiliar para validacion de POD-COD-CVTI
           03 WSS-CVTI.
              05 WSS-GLS-CVTI                         PIC X(01).
              05 WSS-COD-CVTI                         PIC X(03).
              05 WSS-COD-PBTI                         PIC X(01).
      
           03  WSS-TYPE-R         COMP-3              PIC S9(07).
           03  WSS-TYPE   REDEFINES WSS-TYPE-R        PIC  X(04).
      
      
      
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           03 FILLER                            PIC X(3500).
       COPY GNSLGFIO.
      
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
      
           PERFORM LEE-ALL-POD.
       MSG-MAIN.
           IF CMMA-POD-COD-MENS > SPACES
               MOVE 'DAP'             TO MSG-COD-SIST
               MOVE CMMA-POD-COD-MENS TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC      TO CMMA-POD-GLS-MENS.
      
           MOVE CMMA-POD    TO DFHCOMMAREA.
       FIN-MAIN.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           EXEC CICS
                  RETURN
           END-EXEC.
      
       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
      
           MOVE DFHCOMMAREA TO CMMA-POD.
           IF CMMA-POD-GLS-COLA NOT > SPACES
              MOVE 'CPOD'   TO CMMA-POD-GLS-COLA-TERM
              MOVE EIBTASKN TO WSS-TYPE-R
              MOVE WSS-TYPE TO CMMA-POD-GLS-COLA-TYPE.
      
           MOVE 'DAP' TO SCR-SIST.
      
      *MULTI     PERFORM GNS-CRG-IDD.
      *MULTI     PERFORM GNS-CRG-IDD.
      
      *AMB     MOVE 'DAPPPPOD'  TO IDD-PROG FIO-PROG.
      *AMB     MOVE IDD-VARI    TO SYS-CMMA.
      *AMB     MOVE +507        TO SYS-TCMA.
      *AMB     MOVE 'GNSPPIDD'  TO SYS-PROG.
      *AMB     MOVE SYS-LINK    TO SYS-CMND.
      *AMB     PERFORM GNS-PRO-SYS.
      *AMB     MOVE SYS-CMMA TO IDD-VARI.
      
           MOVE 'DAPPPPOD'  TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI    TO SYS-CMMA.
           MOVE +507        TO SYS-TCMA.
           MOVE 'GNSPPIDD'  TO SYS-PROG.
           MOVE SYS-LINK    TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA    TO IDD-VARI.
      
           PERFORM ELIM-QUE.
           MOVE SPACES      TO CMMA-POD-COD-MENS CMMA-POD-GLS-MENS.
           MOVE 'N'         TO CMMA-POD-COD-HMAS.
      
       FIN-INI.
           EXIT.
      
      
       LEE-ALL-POD SECTION.
       INI-LEE-ALL-POD.
           MOVE ZEROES      TO WSS-I IN WSS-VARI.
           MOVE 'S'         TO WSS-IND-ERR IN WSS-VARI.
      
           MOVE SPACES      TO POD-KEY-IPOD IN POD.
           IF CMMA-POD-COD-VCAM  > SPACES
               PERFORM SEK-POD.
      
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-POD.
           PERFORM DAP-FIO-POD.
           IF NOT FIO-STAT-OKS
                GO TO EXT-LEE-ALL-POD.
           IF POD-IND-VIGE IN POD NOT = 'S'
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LUP-LEE-POD.
      
           MOVE POD-COD-VCAM IN POD TO TS-POD-COD-VCAM IN TS-POD-ITEM.
           IF POD-COD-VCAM IN POD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR '              TO TAB-COD-TTAB IN TAB
              MOVE POD-COD-VCAM IN POD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO
                                       TS-FRM-GLS-VCAM IN TS-POD-ITEM
           ELSE
              MOVE SPACES TO           TS-FRM-GLS-VCAM IN TS-POD-ITEM.
      
           MOVE POD-COD-TOPD IN POD TO TS-POD-COD-TOPD IN TS-POD-ITEM.
           IF POD-COD-TOPD IN POD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'TIO '              TO TAB-COD-TTAB IN TAB
              MOVE POD-COD-TOPD IN POD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO
                                       TS-FRM-GLS-TOPD IN TS-POD-ITEM
           ELSE
              MOVE SPACES TO           TS-FRM-GLS-TOPD IN TS-POD-ITEM.
      
           MOVE POD-COD-AOPD IN POD TO TS-POD-COD-AOPD IN TS-POD-ITEM.
           IF POD-COD-COPD IN POD > SPACES
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE POD-COD-COPD IN POD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO
                                       TS-FRM-GLS-AOPD IN TS-POD-ITEM
           ELSE
              MOVE SPACES TO           TS-FRM-GLS-AOPD IN TS-POD-ITEM.
      
           MOVE POD-NUM-IPOD IN POD TO TS-POD-NUM-IPOD-EDT.
           MOVE TS-POD-NUM-IPOD-EDT TO
                                    TS-POD-NUM-IPOD-ALF IN TS-POD-ITEM.
      
           MOVE POD-COD-RENO IN POD TO TS-POD-COD-RENO IN TS-POD-ITEM.
           IF POD-COD-RENO IN POD > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'SON '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-RENO IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                                        TS-FRM-GLS-RENO IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-RENO IN TS-POD-ITEM.
      
           MOVE POD-VAL-CMIN IN POD TO TS-POD-VAL-CMIN-EDT.
           MOVE TS-POD-VAL-CMIN-EDT TO
                                    TS-POD-VAL-CMIN-ALF IN TS-POD-ITEM.
      
           MOVE POD-COD-ENDO IN POD TO TS-POD-COD-ENDO IN TS-POD-ITEM.
           IF POD-COD-ENDO IN POD > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'SON '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-ENDO IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                                        TS-FRM-GLS-ENDO IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-ENDO IN TS-POD-ITEM.
      
           MOVE POD-VAL-CMAX IN POD TO TS-POD-VAL-CMAX-EDT.
           MOVE TS-POD-VAL-CMAX-EDT TO
                                    TS-POD-VAL-CMAX-ALF IN TS-POD-ITEM.
      
           MOVE POD-COD-BCTI IN POD TO TS-POD-COD-BCTI IN TS-POD-ITEM.
           IF POD-COD-BCTI IN POD > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'BCT '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-BCTI IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-BCTI IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-BCTI IN TS-POD-ITEM.
      
           MOVE POD-NUM-PMIN IN POD TO TS-POD-NUM-PMIN-EDT.
           MOVE TS-POD-NUM-PMIN-EDT TO
                                    TS-POD-NUM-PMIN-ALF IN TS-POD-ITEM.
      
           MOVE POD-IND-PMIN IN POD TO TS-POD-IND-PMIN IN TS-POD-ITEM.
           IF POD-IND-PMIN IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-PMIN IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-PMIN IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PMIN IN TS-POD-ITEM.
      
      
           MOVE POD-COD-PBTI IN POD TO TS-POD-COD-PBTI IN TS-POD-ITEM.
           IF POD-COD-PBTI IN POD > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PBT '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-PBTI IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-PBTI IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PBTI IN TS-POD-ITEM.
      
           MOVE POD-NUM-PMAX IN POD TO TS-POD-NUM-PMAX-EDT.
           MOVE TS-POD-NUM-PMAX-EDT TO
                                    TS-POD-NUM-PMAX-ALF IN TS-POD-ITEM.
      
           MOVE POD-IND-PMAX IN POD TO TS-POD-IND-PMAX IN TS-POD-ITEM.
           IF POD-IND-PMAX IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-PMAX IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-PMAX IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PMAX IN TS-POD-ITEM.
      
           MOVE POD-COD-SPBT IN POD TO TS-POD-COD-SPBT IN TS-POD-ITEM.
           IF POD-COD-SPBT IN POD > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'MCT '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-SPBT IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-SPBT IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-SPBT IN TS-POD-ITEM.
      
           MOVE POD-NUM-VMIN IN POD TO TS-POD-NUM-VMIN-EDT.
           MOVE TS-POD-NUM-VMIN-EDT TO
                                    TS-POD-NUM-VMIN-ALF IN TS-POD-ITEM.
      
           MOVE POD-NUM-VMAX IN POD TO TS-POD-NUM-VMAX-EDT.
           MOVE TS-POD-NUM-VMAX-EDT TO
                                    TS-POD-NUM-VMAX-ALF IN TS-POD-ITEM.
      
      
           MOVE POD-COD-CVTI IN POD TO TS-POD-COD-CVTI IN TS-POD-ITEM.
           IF POD-COD-CVTI IN POD > SPACES
               MOVE 'I'                  TO WSS-GLS-CVTI IN WSS-VARI
               MOVE POD-COD-CVTI IN POD  TO WSS-COD-CVTI IN WSS-VARI
               MOVE POD-COD-PBTI IN POD  TO WSS-COD-PBTI IN WSS-VARI
               MOVE WSS-CVTI IN WSS-VARI TO TAB-COD-CTAB IN TAB
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                                        TS-FRM-GLS-CVTI IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-CVTI IN TS-POD-ITEM.
      
           MOVE POD-NUM-SMNV IN POD TO TS-POD-NUM-SMNV-EDT.
           MOVE TS-POD-NUM-SMNV-EDT TO
                                    TS-POD-NUM-SMNV-ALF IN TS-POD-ITEM.
      
           MOVE POD-IND-SMNV IN POD TO TS-POD-IND-SMNV IN TS-POD-ITEM.
           IF POD-IND-SMNV IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-SMNV IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-SMNV IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-SMNV IN TS-POD-ITEM.
      
           MOVE POD-NUM-SMXV IN POD TO TS-POD-NUM-SMXV-EDT.
           MOVE TS-POD-NUM-SMXV-EDT TO
                                    TS-POD-NUM-SMXV-ALF IN TS-POD-ITEM.
      
           MOVE POD-IND-SMXV IN POD TO TS-POD-IND-SMXV IN TS-POD-ITEM.
           IF POD-IND-SMXV IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-SMXV IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-SMXV IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-SMXV IN TS-POD-ITEM.
      
           MOVE POD-COD-TFPR IN POD TO TS-POD-COD-TFPR IN TS-POD-ITEM.
           IF POD-COD-TFPR IN POD > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TPR '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-TFPR IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                                        TS-FRM-GLS-TFPR IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-TFPR IN TS-POD-ITEM.
      
           MOVE POD-COD-MORE IN POD TO TS-POD-COD-MORE IN TS-POD-ITEM.
           IF POD-COD-MORE IN POD > SPACES
               MOVE 'DAP'               TO TAB-COD-SIST
               MOVE 'MDR '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-MORE IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                                        TS-FRM-GLS-MORE IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-MORE IN TS-POD-ITEM.
      
           MOVE POD-NUM-PREP IN POD TO TS-POD-NUM-PREP-EDT.
           MOVE TS-POD-NUM-PREP-EDT TO
                                    TS-POD-NUM-PREP-ALF IN TS-POD-ITEM.
      
           MOVE POD-COD-RESC IN POD TO TS-POD-COD-RESC IN TS-POD-ITEM.
           IF POD-COD-RESC IN POD > SPACES
               MOVE 'DAP'               TO TAB-COD-SIST
               MOVE 'CDR '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-RESC IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-RESC IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-RESC IN TS-POD-ITEM.
      
           MOVE POD-IND-PREP IN POD TO TS-POD-IND-PREP IN TS-POD-ITEM.
           IF POD-IND-PREP IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-PREP IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-PREP IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PREP IN TS-POD-ITEM.
      
           MOVE POD-COD-PLPA IN POD TO TS-POD-COD-PLPA IN TS-POD-ITEM.
           IF POD-COD-PLPA IN POD > SPACES
               MOVE 'DAP'               TO TAB-COD-SIST
               MOVE 'PPR '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-PLPA IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-PLPA IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PLPA IN TS-POD-ITEM.
      
           MOVE POD-IND-VIGE IN POD TO TS-POD-IND-VIGE IN TS-POD-ITEM.
      
           MOVE POD-NUM-PLRE IN POD TO TS-POD-NUM-PLRE-EDT.
           MOVE TS-POD-NUM-PLRE-EDT TO
                                    TS-POD-NUM-PLRE-ALF IN TS-POD-ITEM.
      
           MOVE POD-IND-PLRE IN POD TO TS-POD-IND-PLRE IN TS-POD-ITEM.
           IF POD-IND-PLRE IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-PLRE IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-PLRE IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PLRE IN TS-POD-ITEM.
      
           MOVE POD-NUM-PNTE IN POD TO TS-POD-NUM-PNTE-EDT.
           MOVE TS-POD-NUM-PNTE-EDT TO
                                    TS-POD-NUM-PNTE-ALF IN TS-POD-ITEM.
      
           MOVE POD-COD-NAPR IN POD TO TS-POD-COD-NAPR IN TS-POD-ITEM.
      
           MOVE SPACES              TO TS-FRM-GLS-NAPR IN TS-POD-ITEM.
      
           MOVE POD-IND-PNTE IN POD TO TS-POD-IND-PNTE IN TS-POD-ITEM.
           IF POD-IND-PNTE IN POD > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE POD-IND-PNTE IN POD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                                        TS-FRM-GLS-PNTE IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-PNTE IN TS-POD-ITEM.
      
           MOVE POD-COD-GARA IN POD TO TS-POD-COD-GARA IN TS-POD-ITEM.
      
           MOVE POD-COD-TCDP IN POD TO TS-POD-COD-TCDP IN TS-POD-ITEM.
           IF POD-COD-TCDP IN POD > SPACES
               MOVE 'DAP'               TO TAB-COD-SIST
               MOVE 'TCD '              TO TAB-COD-TTAB IN TAB
               MOVE POD-COD-TCDP IN POD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                                        TS-FRM-GLS-TCDP IN TS-POD-ITEM
           ELSE
               MOVE SPACES TO           TS-FRM-GLS-TCDP IN TS-POD-ITEM.
      
           MOVE POD-COD-AFER IN POD  TO TS-POD-COD-AFER IN TS-POD-ITEM.
           MOVE POD-COD-AACC IN POD  TO TS-POD-COD-AACC IN TS-POD-ITEM.
      
           ADD 1             TO WSS-I IN WSS-VARI.
           MOVE 'N'          TO WSS-IND-ERR IN WSS-VARI.
           MOVE 'PODPOD'     TO TS-POD-NOMB.
           MOVE  TS-POD-ITEM TO WSS-AUXI.
           MOVE  WSS-AUXI    TO TS-POD-DATA.
           PERFORM WRIT-QUE.
      
           IF WSS-I IN WSS-VARI = WSS-IMAX IN WSS-VARI
              PERFORM VRF-NXT-POD
              GO TO EXT-LEE-ALL-POD
           ELSE
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LUP-LEE-POD.
      
       EXT-LEE-ALL-POD.
           IF WSS-IND-ERR IN WSS-VARI = 'S'
              MOVE 'PPPOD  NEX'   TO CMMA-POD-COD-MENS.
       FIN-LEE-ALL-POD.
           EXIT.
      
       VRF-NXT-POD SECTION.
       INI-VRF-NXT-POD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           IF FIO-STAT-OKS
               IF POD-IND-VIGE IN POD = 'S'
                    MOVE 'S' TO CMMA-POD-COD-HMAS
               ELSE
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO INI-VRF-NXT-POD.
       FIN-VRF-NXT-POD.
           EXIT.
      
       SEK-POD SECTION.
       INI-SEK-POD.
           MOVE CMMA-POD-COD-VCAM  TO POD-COD-VCAM IN POD.
           MOVE CMMA-POD-COD-TOPD  TO POD-COD-TOPD IN POD.
           MOVE CMMA-POD-COD-AOPD  TO POD-COD-AOPD IN POD.
           MOVE '9'                TO POD-NUM-IPOD IN POD.
       FIN-SEK-POD.
           EXIT.
      
       WRIT-QUE SECTION.
       INI-WRIT-QUE.
           MOVE CMMA-POD-GLS-COLA TO QUE-COLA.
           MOVE TS-LEN-TS-POD     TO QUE-LITM.
           MOVE TS-POD-DATA       TO QUE-ITEM.
           MOVE QUE-PUT           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-WRIT-QUE.
           EXIT.
      
       ELIM-QUE SECTION.
       INI-ELIM-QUE.
           PERFORM GNS-ERR-QUE.
           MOVE CMMA-POD-GLS-COLA TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-ELIM-QUE.
           EXIT.
      
       COPY GNSBGSYS.
       COPY GNSBGMSG.
       COPY GNSBIABT.
      
       COPY GNSBFTAB.
       COPY GNSBBTAB.
      
       COPY GNSBFMSG.
      
       COPY DAPBFPOD.
      
       COPY GNSBFMSC.
       COPY GNSBBMSC.
      
      * COPY GNSBGVSM.
       COPY GNSBGDTC.
      
      *MULTI COPY GNSBCIDD.
      *MULTI COPY GNSBCIDD.
       COPY GNSBBIDD.
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      
