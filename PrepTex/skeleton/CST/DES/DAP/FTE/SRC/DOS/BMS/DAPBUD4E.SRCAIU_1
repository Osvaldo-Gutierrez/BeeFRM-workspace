      *
      * DAPBUD4E
      * Version 3.0.1 Nov-2005
      * 30-Dec-09 05:01 PM
      *
       SET-TAG-DAPBUD4E SECTION.
       INI-SET-TAG-DAPBUD4E.
           MOVE
           '<IDNMOD NOM=$DAPBUD4E$ VSN=$09.12.28$ VGM=$3.0.1$
      -    'GEN=$30-Dec-09 05:01 PM$ FNC=$091110$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBUD4E.
           EXIT.
           
       RET-ALL-D4E SECTION.
       INI-RET-ALL-D4E.
           PERFORM KEY-ALL-D4E.
           PERFORM RET-D4E-D4E.
       FIN-RET-ALL-D4E.
           EXIT.
       
       RET-D4E-D4E SECTION.
       INI-RET-D4E-D4E.
           MOVE D4E-NUM-TCAP IN D4E-FLD TO D4E-NUM-TCAP IN D4E.
           MOVE D4E-NUM-MCAP IN D4E-FLD TO D4E-NUM-MCAP IN D4E.
           MOVE D4E-COD-RCLI IN D4E-FLD TO D4E-COD-RCLI IN D4E.
           MOVE D4E-COD-VCLI IN D4E-FLD TO D4E-COD-VCLI IN D4E.
           MOVE D4E-GLS-NOMC IN D4E-FLD TO D4E-GLS-NOMC IN D4E.
           MOVE D4E-COD-LOCA IN D4E-FLD TO D4E-COD-LOCA IN D4E.
           MOVE D4E-VAL-CAPT IN D4E-FLD TO D4E-VAL-CAPT IN D4E.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE D4E-NUM-DREA IN D4E-FLD TO D4E-NUM-DREA IN D4E.
           MOVE D4E-NUM-MREA IN D4E-FLD TO D4E-NUM-MREA IN D4E.
           MOVE D4E-NUM-SREA IN D4E-FLD TO D4E-NUM-SREA IN D4E.
           MOVE D4E-NUM-AREA IN D4E-FLD TO D4E-NUM-AREA IN D4E.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE D4E-NUM-DOPE IN D4E-FLD TO D4E-NUM-DOPE IN D4E.
           MOVE D4E-NUM-MOPE IN D4E-FLD TO D4E-NUM-MOPE IN D4E.
           MOVE D4E-NUM-SOPE IN D4E-FLD TO D4E-NUM-SOPE IN D4E.
           MOVE D4E-NUM-AOPE IN D4E-FLD TO D4E-NUM-AOPE IN D4E.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE D4E-VAL-SALD IN D4E-FLD TO D4E-VAL-SALD IN D4E.
           MOVE D4E-COD-TASA IN D4E-FLD TO D4E-COD-TASA IN D4E.
           MOVE D4E-SGV-TASA IN D4E-FLD TO D4E-SGV-TASA IN D4E.
           MOVE D4E-VAL-INTE IN D4E-FLD TO D4E-VAL-INTE IN D4E.
           MOVE D4E-VAL-REAJ IN D4E-FLD TO D4E-VAL-REAJ IN D4E.
           MOVE D4E-GLS-DISP IN D4E-FLD TO D4E-GLS-DISP IN D4E.
           MOVE D4E-CTA-SDIN IN D4E-FLD TO D4E-CTA-SDIN IN D4E.
           MOVE D4E-CTA-INTE IN D4E-FLD TO D4E-CTA-INTE IN D4E.
           MOVE D4E-CTA-REAJ IN D4E-FLD TO D4E-CTA-REAJ IN D4E.
           MOVE D4E-CIC-IOPD IN D4E-FLD TO D4E-CIC-IOPD IN D4E.
           MOVE D4E-GLS-DSXT IN D4E-FLD TO D4E-GLS-DSXT IN D4E.
       FIN-RET-D4E-D4E.
           EXIT.
       
       KEY-ALL-D4E SECTION.
       INI-KEY-ALL-D4E.
           PERFORM KEY-D4E-D4E.
       FIN-KEY-ALL-D4E.
           EXIT.
       
       KEY-D4E-D4E SECTION.
       INI-KEY-D4E-D4E.
           MOVE D4E-COD-OPER IN D4E-FLD TO D4E-COD-OPER IN D4E.
       FIN-KEY-D4E-D4E.
           EXIT.
       
       SCR-CLRA-D4E SECTION.
       INI-SCR-CLRA-D4E.
           PERFORM CLR-KEY-D4E.
           PERFORM CLR-FLD-D4E.
       FIN-SCR-CLRA-D4E.
           EXIT.
       
       CLR-KEY-D4E SECTION.
       INI-CLR-KEY-D4E.
           MOVE SPACES TO D4E-COD-OPER IN D4E-FLD.
       FIN-CLR-KEY-D4E.
           EXIT.
       
       CLR-FLD-D4E SECTION.
       INI-CLR-FLD-D4E.
           PERFORM CLR-D4E-D4E.
       FIN-CLR-FLD-D4E.
           EXIT.
       
       CLR-D4E-D4E SECTION.
       INI-CLR-D4E-D4E.
           MOVE ZEROES TO D4E-NUM-TCAP IN D4E-FLD.
           MOVE ZEROES TO D4E-NUM-MCAP IN D4E-FLD.
           MOVE SPACES TO D4E-COD-RCLI IN D4E-FLD.
           MOVE SPACES TO D4E-COD-VCLI IN D4E-FLD.
           MOVE SPACES TO D4E-GLS-NOMC IN D4E-FLD.
           MOVE SPACES TO D4E-COD-LOCA IN D4E-FLD.
           MOVE ZEROES TO D4E-VAL-CAPT IN D4E-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D4E-FEC-FREA IN D4E-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D4E-FEC-FOPE IN D4E-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D4E-VAL-SALD IN D4E-FLD.
           MOVE SPACES TO D4E-COD-TASA IN D4E-FLD.
           MOVE ZEROES TO D4E-SGV-TASA IN D4E-FLD.
           MOVE ZEROES TO D4E-VAL-INTE IN D4E-FLD.
           MOVE ZEROES TO D4E-VAL-REAJ IN D4E-FLD.
           MOVE SPACES TO D4E-GLS-DISP IN D4E-FLD.
           MOVE SPACES TO D4E-CTA-SDIN IN D4E-FLD.
           MOVE SPACES TO D4E-CTA-INTE IN D4E-FLD.
           MOVE SPACES TO D4E-CTA-REAJ IN D4E-FLD.
           MOVE SPACES TO D4E-CIC-IOPD IN D4E-FLD.
           MOVE SPACES TO D4E-GLS-DSXT IN D4E-FLD.
       FIN-CLR-D4E-D4E.
           EXIT.
       
       FST-KEY-D4E SECTION.
       INI-FST-KEY-D4E.
           MOVE -1 TO D4E-COD-OPER-LEN IN D4E-FLD.
       FIN-FST-KEY-D4E.
           EXIT.
       
       FST-FLD-D4E SECTION.
       INI-FST-FLD-D4E.
           MOVE -1 TO D4E-NUM-TCAP-LEN IN D4E-FLD.
       FIN-FST-FLD-D4E.
           EXIT.
       
       PRO-KEY-D4E SECTION.
       INI-PRO-KEY-D4E.
           PERFORM PRO-MKY-D4E.
       FIN-PRO-KEY-D4E.
           EXIT.
       
       PRO-MKY-D4E SECTION.
       INI-PRO-MKY-D4E.
       FIN-PRO-MKY-D4E.
           EXIT.
       
       PRO-FLD-D4E SECTION.
       INI-PRO-FLD-D4E.
           PERFORM PRO-D4E-D4E.
       FIN-PRO-FLD-D4E.
           EXIT.
       
       PRO-D4E-D4E SECTION.
       INI-PRO-D4E-D4E.
           MOVE FRM-CPIM-AEY TO D4E-NUM-TCAP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-NUM-MCAP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-COD-RCLI-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-COD-VCLI-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-GLS-NOMC-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-COD-LOCA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-VAL-CAPT-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-FEC-FREA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-FEC-FOPE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-VAL-SALD-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-COD-TASA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-SGV-TASA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-VAL-INTE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-VAL-REAJ-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-GLS-DISP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-CTA-SDIN-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-CTA-INTE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-CTA-REAJ-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-CIC-IOPD-ATR IN D4E-FLD.
           MOVE FRM-CPIM-AEY TO D4E-GLS-DSXT-ATR IN D4E-FLD.
       FIN-PRO-D4E-D4E.
           EXIT.
       
       UNP-KEY-D4E SECTION.
       INI-UNP-KEY-D4E.
           PERFORM UNP-IKY-D4E.
           PERFORM UNP-AKY-D4E.
           PERFORM UNP-MKY-D4E.
       FIN-UNP-KEY-D4E.
           EXIT.
       
       UNP-IKY-D4E SECTION.
       INI-UNP-IKY-D4E.
           MOVE FRM-CPIM-UBY TO D4E-COD-OPER-ATR.
       FIN-UNP-IKY-D4E.
           EXIT.
       
       UNP-MKY-D4E SECTION.
       INI-UNP-MKY-D4E.
       FIN-UNP-MKY-D4E.
           EXIT.
       
       UNP-AKY-D4E SECTION.
       INI-UNP-AKY-D4E.
       FIN-UNP-AKY-D4E.
           EXIT.
       
       UNP-FLD-D4E SECTION.
       INI-UNP-FLD-D4E.
           PERFORM UNP-D4E-D4E.
       FIN-UNP-FLD-D4E.
           EXIT.
       
       UNP-D4E-D4E SECTION.
       INI-UNP-D4E-D4E.
           MOVE FRM-CPIM-UBY TO D4E-NUM-TCAP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-NUM-MCAP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-COD-RCLI-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-COD-VCLI-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-GLS-NOMC-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-COD-LOCA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-VAL-CAPT-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-FEC-FREA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-FEC-FOPE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-VAL-SALD-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-COD-TASA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-SGV-TASA-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-VAL-INTE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-VAL-REAJ-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-GLS-DISP-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-CTA-SDIN-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-CTA-INTE-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-CTA-REAJ-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-CIC-IOPD-ATR IN D4E-FLD.
           MOVE FRM-CPIM-UBY TO D4E-GLS-DSXT-ATR IN D4E-FLD.
       FIN-UNP-D4E-D4E.
           EXIT.
       
       VAL-MKY-D4E SECTION.
       INI-VAL-MKY-D4E.
       FIN-VAL-MKY-D4E.
           EXIT.
       
       VAL-FLD-D4E SECTION.
       INI-VAL-FLD-D4E.
           PERFORM VAL-D4E-NUM-TCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-NUM-TCAP-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-NUM-MCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-NUM-MCAP-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-COD-RCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-COD-RCLI-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-COD-VCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-COD-VCLI-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-GLS-NOMC-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-COD-LOCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-COD-LOCA-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-VAL-CAPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-VAL-CAPT-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-D4E-FEC-FREA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                D4E-FEC-FREA-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-D4E-FEC-FOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                D4E-FEC-FOPE-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-D4E-VAL-SALD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-VAL-SALD-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-COD-TASA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-COD-TASA-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-SGV-TASA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-SGV-TASA-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-VAL-INTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-VAL-INTE-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-VAL-REAJ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-VAL-REAJ-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-GLS-DISP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-GLS-DISP-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-CTA-SDIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-CTA-SDIN-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-CTA-INTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-CTA-INTE-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-CTA-REAJ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-CTA-REAJ-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-CIC-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-CIC-IOPD-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
           PERFORM VAL-D4E-GLS-DSXT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D4E-GLS-DSXT-LEN IN D4E-FLD
                GO TO FIN-VAL-FLD-D4E.
       FIN-VAL-FLD-D4E.
           EXIT.
       
       VAL-D4E-NUM-TCAP SECTION.
       INI-VAL-D4E-NUM-TCAP.
       FIN-VAL-D4E-NUM-TCAP.
           EXIT.
       
       VAL-D4E-NUM-MCAP SECTION.
       INI-VAL-D4E-NUM-MCAP.
       FIN-VAL-D4E-NUM-MCAP.
           EXIT.
       
       VAL-D4E-COD-RCLI SECTION.
       INI-VAL-D4E-COD-RCLI.
           IF D4E-COD-RCLI IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-COD-RCLI IN D4E-FLD.
       FIN-VAL-D4E-COD-RCLI.
           EXIT.
       
       VAL-D4E-COD-VCLI SECTION.
       INI-VAL-D4E-COD-VCLI.
           IF D4E-COD-VCLI IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-COD-VCLI IN D4E-FLD.
       FIN-VAL-D4E-COD-VCLI.
           EXIT.
       
       VAL-D4E-GLS-NOMC SECTION.
       INI-VAL-D4E-GLS-NOMC.
           IF D4E-GLS-NOMC IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-GLS-NOMC IN D4E-FLD.
       FIN-VAL-D4E-GLS-NOMC.
           EXIT.
       
       VAL-D4E-COD-LOCA SECTION.
       INI-VAL-D4E-COD-LOCA.
           IF D4E-COD-LOCA IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-COD-LOCA IN D4E-FLD.
       FIN-VAL-D4E-COD-LOCA.
           EXIT.
       
       VAL-D4E-VAL-CAPT SECTION.
       INI-VAL-D4E-VAL-CAPT.
       FIN-VAL-D4E-VAL-CAPT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-D4E-FEC-FREA SECTION.
       INI-VAL-D4E-FEC-FREA.
           IF D4E-FEC-FREA IN D4E-FLD  NOT > ZEROES
              MOVE ZEROES TO D4E-FEC-FREA IN D4E-FLD.
      *VAL-FEC Validar Fecha
           MOVE D4E-FEC-FREA IN D4E-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D4E-FEC-FREA IN D4E-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D4E-FEC-FREA.
       FIN-VAL-D4E-FEC-FREA.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-D4E-FEC-FOPE SECTION.
       INI-VAL-D4E-FEC-FOPE.
           IF D4E-FEC-FOPE IN D4E-FLD  NOT > ZEROES
              MOVE ZEROES TO D4E-FEC-FOPE IN D4E-FLD.
      *VAL-FEC Validar Fecha
           MOVE D4E-FEC-FOPE IN D4E-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D4E-FEC-FOPE IN D4E-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D4E-FEC-FOPE.
       FIN-VAL-D4E-FEC-FOPE.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-D4E-VAL-SALD SECTION.
       INI-VAL-D4E-VAL-SALD.
       FIN-VAL-D4E-VAL-SALD.
           EXIT.
       
       VAL-D4E-COD-TASA SECTION.
       INI-VAL-D4E-COD-TASA.
           IF D4E-COD-TASA IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-COD-TASA IN D4E-FLD.
       FIN-VAL-D4E-COD-TASA.
           EXIT.
       
       VAL-D4E-SGV-TASA SECTION.
       INI-VAL-D4E-SGV-TASA.
       FIN-VAL-D4E-SGV-TASA.
           EXIT.
       
       VAL-D4E-VAL-INTE SECTION.
       INI-VAL-D4E-VAL-INTE.
       FIN-VAL-D4E-VAL-INTE.
           EXIT.
       
       VAL-D4E-VAL-REAJ SECTION.
       INI-VAL-D4E-VAL-REAJ.
       FIN-VAL-D4E-VAL-REAJ.
           EXIT.
       
       VAL-D4E-GLS-DISP SECTION.
       INI-VAL-D4E-GLS-DISP.
           IF D4E-GLS-DISP IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-GLS-DISP IN D4E-FLD.
       FIN-VAL-D4E-GLS-DISP.
           EXIT.
       
       VAL-D4E-CTA-SDIN SECTION.
       INI-VAL-D4E-CTA-SDIN.
           IF D4E-CTA-SDIN IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-CTA-SDIN IN D4E-FLD.
       FIN-VAL-D4E-CTA-SDIN.
           EXIT.
       
       VAL-D4E-CTA-INTE SECTION.
       INI-VAL-D4E-CTA-INTE.
           IF D4E-CTA-INTE IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-CTA-INTE IN D4E-FLD.
       FIN-VAL-D4E-CTA-INTE.
           EXIT.
       
       VAL-D4E-CTA-REAJ SECTION.
       INI-VAL-D4E-CTA-REAJ.
           IF D4E-CTA-REAJ IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-CTA-REAJ IN D4E-FLD.
       FIN-VAL-D4E-CTA-REAJ.
           EXIT.
       
       VAL-D4E-CIC-IOPD SECTION.
       INI-VAL-D4E-CIC-IOPD.
           IF D4E-CIC-IOPD IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-CIC-IOPD IN D4E-FLD.
       FIN-VAL-D4E-CIC-IOPD.
           EXIT.
       
       VAL-D4E-GLS-DSXT SECTION.
       INI-VAL-D4E-GLS-DSXT.
           IF D4E-GLS-DSXT IN D4E-FLD NOT > SPACES
              MOVE SPACES TO D4E-GLS-DSXT IN D4E-FLD.
       FIN-VAL-D4E-GLS-DSXT.
           EXIT.
       
       VAL-CON-FLD-D4E SECTION.
       INI-VAL-CON-FLD-D4E.
       FIN-VAL-CON-FLD-D4E.
           EXIT.
       
       VAL-CON-D4E SECTION.
       INI-VAL-CON-D4E.
       FIN-VAL-CON-D4E.
           EXIT.
       
       VAL-NUM-KEY-D4E SECTION.
       INI-VAL-NUM-KEY-D4E.
           PERFORM VAL-NUM-IKY-D4E.
           PERFORM VAL-NUM-MKY-D4E.
           PERFORM VAL-NUM-AKY-D4E.
       FIN-VAL-NUM-KEY-D4E.
           EXIT.
       
       VAL-NUM-IKY-D4E SECTION.
       INI-VAL-NUM-IKY-D4E.
       FIN-VAL-NUM-IKY-D4E.
           EXIT.
       
       VAL-NUM-MKY-D4E SECTION.
       INI-VAL-NUM-MKY-D4E.
       FIN-VAL-NUM-MKY-D4E.
           EXIT.
       
       VAL-NUM-AKY-D4E SECTION.
       INI-VAL-NUM-AKY-D4E.
       FIN-VAL-NUM-AKY-D4E.
           EXIT.
       
       VAL-NUM-FLD-D4E SECTION.
       INI-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-NUM-TCAP.
           MOVE D4E-NUM-TCAP-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-NUM-TCAP IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-NUM-TCAP-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-NUM-MCAP.
           MOVE D4E-NUM-MCAP-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-NUM-MCAP IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-NUM-MCAP-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-VAL-CAPT.
           MOVE D4E-VAL-CAPT-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-VAL-CAPT IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-VAL-CAPT-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-VAL-SALD.
           MOVE D4E-VAL-SALD-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-VAL-SALD IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-VAL-SALD-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-SGV-TASA.
           MOVE D4E-SGV-TASA-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO D4E-SGV-TASA IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-SGV-TASA-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-VAL-INTE.
           MOVE D4E-VAL-INTE-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-VAL-INTE IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-VAL-INTE-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       VAL-NUM-D4E-VAL-REAJ.
           MOVE D4E-VAL-REAJ-ALF IN D4E-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D4E-VAL-REAJ IN D4E-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D4E-VAL-REAJ-LEN IN D4E-FLD
                GO TO FIN-VAL-NUM-FLD-D4E.
       FIN-VAL-NUM-FLD-D4E.
           EXIT.
       
       EDT-KEY-D4E SECTION.
       INI-EDT-KEY-D4E.
           PERFORM EDT-IKY-D4E.
           PERFORM EDT-MKY-D4E.
           PERFORM EDT-AKY-D4E.
       FIN-EDT-KEY-D4E.
           EXIT.
       
       EDT-IKY-D4E SECTION.
       INI-EDT-IKY-D4E.
       FIN-EDT-IKY-D4E.
           EXIT.
       
       EDT-MKY-D4E SECTION.
       INI-EDT-MKY-D4E.
       FIN-EDT-MKY-D4E.
           EXIT.
       
       EDT-AKY-D4E SECTION.
       INI-EDT-AKY-D4E.
       FIN-EDT-AKY-D4E.
           EXIT.
       
       EDT-FLD-D4E SECTION.
       INI-EDT-FLD-D4E.
           IF D4E-NUM-TCAP-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-NUM-TCAP-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-NUM-TCAP IN D4E-FLD TO D4E-NUM-TCAP-EDT IN D4E-EDT.
           MOVE D4E-NUM-TCAP-EDT IN D4E-EDT TO 
                D4E-NUM-TCAP-ALF IN D4E-FLD.
           IF D4E-NUM-MCAP-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-NUM-MCAP-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-NUM-MCAP IN D4E-FLD TO D4E-NUM-MCAP-EDT IN D4E-EDT.
           MOVE D4E-NUM-MCAP-EDT IN D4E-EDT TO 
                D4E-NUM-MCAP-ALF IN D4E-FLD.
           IF D4E-VAL-CAPT-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-VAL-CAPT-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-VAL-CAPT IN D4E-FLD TO D4E-VAL-CAPT-EDT IN D4E-EDT.
           MOVE D4E-VAL-CAPT-EDT IN D4E-EDT TO 
                D4E-VAL-CAPT-ALF IN D4E-FLD.
           IF D4E-VAL-SALD-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-VAL-SALD-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-VAL-SALD IN D4E-FLD TO D4E-VAL-SALD-EDT IN D4E-EDT.
           MOVE D4E-VAL-SALD-EDT IN D4E-EDT TO 
                D4E-VAL-SALD-ALF IN D4E-FLD.
           IF D4E-SGV-TASA-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-SGV-TASA-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-SGV-TASA IN D4E-FLD TO D4E-SGV-TASA-EDT IN D4E-EDT.
           MOVE D4E-SGV-TASA-EDT IN D4E-EDT TO 
                D4E-SGV-TASA-ALF IN D4E-FLD.
           IF D4E-VAL-INTE-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-VAL-INTE-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-VAL-INTE IN D4E-FLD TO D4E-VAL-INTE-EDT IN D4E-EDT.
           MOVE D4E-VAL-INTE-EDT IN D4E-EDT TO 
                D4E-VAL-INTE-ALF IN D4E-FLD.
           IF D4E-VAL-REAJ-LEN IN D4E-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D4E-VAL-REAJ-LEN IN D4E-FLD
                GO TO FIN-EDT-FLD-D4E.
           MOVE D4E-VAL-REAJ IN D4E-FLD TO D4E-VAL-REAJ-EDT IN D4E-EDT.
           MOVE D4E-VAL-REAJ-EDT IN D4E-EDT TO 
                D4E-VAL-REAJ-ALF IN D4E-FLD.
       FIN-EDT-FLD-D4E.
           EXIT.
