       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DAPPLSUB.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    10-Jun-96 09:55 AM.

      * Programa Listador de Reporte SUB con Sort.

      *<<<< CMT_ID
      *  20-APR-1993 17:44:55
      *  RESTAURACION DEL PROGRAMA EN SU ORDENAMIENTO ORIGINAL
      *  PARA CORRECTA GRABACION DE INTERFAZ CONTABLE EN PRODUCCION
      *  20-APR-1993 21:58:05
      *  SE RECUPERA CODIGO PARA LIQUIDACION TOTAL DE RENOVABLES
      *  'LRE' PARA LIQ-COD-LIQU 'LT'
      *  21-APR-1993 00:26:10 CAMBIO DE POSICION CODIGO PARA GRABAR
      *  CORRECTAMENTE INTERFAZ  CONTABLE
      *  DESAPARECE VERSION CST FIO-UPD, BFCT1, BFCT2
      *  23-APR-1993 21:25:15 NO ABORTA AL NO ENCONTRAR REGISTROS CRT
      *  BUSCA REGISTROS CRT SOLO PARA FECHAS HABILES
      *  30-APR-1993 08:48:48 PARA LSUB PROCESA OPERACIONES INGRESADAS
      *     CON EXC DE DISTINTO DIA
      *  3-MAY-1993 12:50:52 RECUPERA SALDOS DE ARCHIVO CMX PARA
      *  MONEDA EXTRANJERA DESDE OFICINA CABECERA, AL NO ENCONTRAR
      *  SALDOS, LO INFORMA, PERO NO ABORTA.
      *  18-MAY-1993 14:41:14 MODIFICACIONES SOLICITADAS POR BCI
      *  CORTE DE CONTROL CTA CONTABLE
      * ==>> 30-JUL-1993 JVM: SE ELIMINAN DISPLAY INFORMATIVOS

      * ==>>  10-AUG-1993 18:57:59 ISP : AL DETECTAR UNA LIQ PARA FIJO
      *       CON FCMP > FVEN GENERA VENCIMIENTO DE FIJO


      * NOTA --> ANTES DE GENERAR JOB RENOMBRAR MODULOS DAPR*SUB
      *
      * MANTANCION: BCI CECILIA PIZARRO.
      *            -SE CORRIGE LA FECHA INICIO DE BUSQUEDA, DEJANDOLA
      *             DESDE EL PRIMER DIA INGRESADO POR PARAMETRO.
      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTSUB         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTSUB         ASSIGN TO        UT-S-RPTSUB.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTSUB         ASSIGN TO        UT-S-RPTSUB.
      *<<<< IOS
      *DOS SELECT RPTMCT         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTMCT         ASSIGN TO        UT-S-RPTMCT.
           SELECT RPTMCT         ASSIGN TO        UT-S-RPTMCT.
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY DAPRRSUB.
      *<<<< RR
      *JUS-INI 23-OCT-1995
           03 OPD-IND-MCLI PIC X.
      *JUS-FIN
           03 CPP-COD-VCAM            PIC X(06).
           03 CPP-COD-TOPD            PIC X(03).
           03 CPP-COD-AOPD            PIC X(03).
           03 CPP-COD-MVTO            PIC X(03).
           03 CPP-COD-TCCT            PIC X(03).
           03 CPP-COD-DBHB            PIC X(01).
           03 CPP-COD-TALG            PIC X(01).
      *JVM 22/09/92
           03 OPD-SGV-TINT            PIC 9(03)V9(04).
      *JVM
      *>>>>
       FD  RPTSUB LABEL RECORDS OMITTED
           REPORT IS RPT-SUB
           .
      *<<<< FLS
       FD  RPTMCT LABEL RECORDS OMITTED
           REPORT IS RPT-MCT.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY DAPBROPD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY DAPRWSUB.
      *<<<< RW
       COPY DAPRWMCT.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRCIC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGCIC.
       COPY GNSWGPES.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRMSC.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
      *Entidades de DAP
       COPY DAPBRVEN.
       COPY DAPBRLIQ.
       COPY DAPBRRCC.
       COPY DAPBRCPP.
       COPY DAPBRDCC.
       COPY DAPBRCRT.
       COPY DAPBRCT1.
       COPY DAPBRCT2.
       COPY DAPBRMC1.
       COPY DAPBRMC2.
       COPY DAPBRMC3.
      *SALDOS MONEDA CHILENA
       COPY DAPBRCTA.
      *SALDOS MONEDA EXTRANJERA
       COPY DAPBRCMX.

      *HEADER INTERFAZ
       COPY DAPBRMCH.

      *Entidades de SGC
       COPY SGCBRRCD.
       COPY SGCBRDBC.
       01  WSS-VARI.
           03 BUS-MEM-ISER     VALUE 'N'          PIC X(01).
           03 WSS-VAL-SINT     COMP-3 VALUES ZEROES PIC S9(13)V9(4).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FFIN.
              05 WSS-NUM-DFIN                     PIC 9(02).
              05 WSS-NUM-MFIN                     PIC 9(02).
              05 WSS-NUM-SFIN                     PIC 9(02).
              05 WSS-NUM-AFIN                     PIC 9(02).
           03 WSS-FEC-FPRI.
              05 WSS-NUM-SPRI                     PIC 9(02).
              05 WSS-NUM-APRI                     PIC 9(02).
              05 WSS-NUM-MPRI                     PIC 9(02).
              05 WSS-NUM-DPRI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-DTER                     PIC 9(02).
           03 WSS-FEC-FTRA.
              05 WSS-NUM-STRA                     PIC 9(02).
              05 WSS-NUM-ATRA                     PIC 9(02).
              05 WSS-NUM-MTRA                     PIC 9(02).
              05 WSS-NUM-DTRA                     PIC 9(02).
           03 WSS-FEC-FMOV.
              05 WSS-NUM-SMOV                     PIC 9(02).
              05 WSS-NUM-AMOV                     PIC 9(02).
              05 WSS-NUM-MMOV                     PIC 9(02).
              05 WSS-NUM-DMOV                     PIC 9(02).
      * FECHA A LA CUAL SE GENERA EL MOVIMIENTO CONTABLE
      * OPD-FEC-FCMP, LIQ-FEC-FCTB, VEN-FEC-FVEN
           03 WSS-FEC-FSRT.
              05 WSS-NUM-SSRT                     PIC 9(02).
              05 WSS-NUM-ASRT                     PIC 9(02).
              05 WSS-NUM-MSRT                     PIC 9(02).
              05 WSS-NUM-DSRT                     PIC 9(02).
           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-FEC-FANT.
              05 WSS-NUM-DANT                     PIC 9(02).
              05 WSS-NUM-MANT                     PIC 9(02).
              05 WSS-NUM-SANT                     PIC 9(02).
              05 WSS-NUM-AANT                     PIC 9(02).
           03 WSS-FEC-FAMD.
              05 WSS-NUM-SAMD                     PIC 9(02).
              05 WSS-NUM-AAMD                     PIC 9(02).
              05 WSS-NUM-MAMD                     PIC 9(02).
              05 WSS-NUM-DAMD                     PIC 9(02).
           03 WSS-FEC-FACT.
              05 WSS-NUM-DACT                     PIC 9(02).
              05 WSS-NUM-MACT                     PIC 9(02).
              05 WSS-NUM-SACT                     PIC 9(02).
              05 WSS-NUM-AACT                     PIC 9(02).
           03 WSS-FEC-FREV.
              05 WSS-NUM-DREV                     PIC 9(02).
              05 WSS-NUM-MREV                     PIC 9(02).
              05 WSS-NUM-SREV                     PIC 9(02).
              05 WSS-NUM-AREV                     PIC 9(02).
           03 WSS-COD-VCAM.
              05 WSS-COD-TVAL                     PIC X(01).
              05 WSS-COD-CVAL                     PIC X(03).
              05 WSS-COD-TCAM                     PIC X(02).
           03 WSS-CIC-VCAM.
              05 WSS-CIC-TVAL                     PIC X(01).
              05 WSS-CIC-CVAL                     PIC X(03).
              05 WSS-CIC-TCAM                     PIC X(02).
           03 WSS-KEY-ICRT        VALUE ZEROES    PIC X(09).
           03 WSS-STAT-RCC        VALUE ZEROES    PIC 9(01).
           03 WSS-IND-GITF        VALUE SPACES    PIC X(01).
           03 WSS-IND-TRPT        VALUE SPACES    PIC X(04).
           03 WSS-IND-MCLI        VALUE SPACES    PIC X(01).
           03 WSS-COD-OFIC                        PIC X(03).
           03 WSS-COD-CMR         VALUE ZEROES    PIC 9(01).
           03 WSS-IND-MNRJ        VALUE ZEROES    PIC 9(01).
           03 WSS-IND-CALC        VALUE ZEROES    PIC 9(01).
           03 WSS-IND-FEC         VALUE ZEROES    PIC 9(01).
           03 WSS-IND-CPP         VALUE ZEROES    PIC 9(01).
           03 WSS-IND-NEXT        VALUE ZEROES    PIC 9(01).
           03 WSS-I               VALUE ZEROES    PIC 9(02).
           03 WSS-IND-FORM                        PIC X(01).
           03 WSS-VAL-SANT        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-SACT        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-REAJ        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-MONT        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-DOLL        VALUE ZEROES    PIC S9(11)V9(04).
           03 WSS-NUM-TDEB        VALUE ZEROES    PIC 9(03).
           03 WSS-NUM-THAB        VALUE ZEROES    PIC 9(03).
      *DAD ini  16-OCT-1992
           03 WSS-VAL-ADEB        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-AHAB        VALUE ZEROES    PIC S9(15)V9(02).
      *DAD fin  16-OCT-1992
      *DAD ini  23-JUN-1992
           03 WSS-NUM-TCDE        VALUE ZEROES    PIC 9(04).
           03 WSS-NUM-TCHA        VALUE ZEROES    PIC 9(04).
           03 WSS-VAL-SALD        VALUE ZEROES    PIC S9(15)V9(02).

           03 WSS-VAL-LTN1-DEBE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTN1-HABE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTX1-DEBE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTX1-HABE   VALUE ZEROES    PIC S9(15)V9(02).

           03 WSS-VAL-LTN2-DEBE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTN2-HABE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTX2-DEBE   VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-LTX2-HABE   VALUE ZEROES    PIC S9(15)V9(02).

           03 WSS-IND-LOTE        VALUE ZEROES    PIC 9(01).
           03 WSS-COD-COFI                        PIC X(03).
           03 WSS-CIC-CCTB                        PIC X(12).
      *  30-OCT-1992 18:12:23  ISP NO TIENEN SENTIDO ESTAS VERIABLES
           03 WSS-CIC-IOPD                        PIC X(12).
      *     03 WSS-CIC-ISER                        PIC X(12).

      *DAD fin  23-JUN-1992
      * JVM
           03 WSS-VAL-TDEB        VALUE ZEROES    PIC S9(15)V9(02).
           03 WSS-VAL-THAB        VALUE ZEROES    PIC S9(15)V9(02).
      * JVM
           03 WSS-NUM-ICPP        VALUE ZEROES    PIC 9(02).
           03 WSS-GRA-SRT         VALUE ZEROES    PIC 9(06).
           03 WSS-GRA-CT1         VALUE ZEROES    PIC 9(06).
           03 WSS-GRA-CT2         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-OPD         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-LIQ         VALUE ZEROES    PIC 9(06).
           03 WSS-LEI-VEN         VALUE ZEROES    PIC 9(06).
           03 WSS-GLS-CCTB.
              05 WSS-GLS-DESC                     PIC X(40).
              05 WSS-GLS-DATA.
                 07 FILLER                        PIC X(59).
                 07 WSS-GLS-DVRF                  PIC X(01).
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-RDOL                        PIC X(06).
           03 WSS-COD-DOLL                        PIC X(06).
           03 WSS-COD-UEFE                        PIC X(06).
           03 WSS-SGV-FOUF        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FORD        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FODO        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FCUF        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FCRD        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FCDO        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FVUF        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FVRD        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-SGV-FVDO        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-NUM-ITEM                        PIC 9(08).
           03 WSS-NUM-ITEM-R REDEFINES WSS-NUM-ITEM.
              05 WSS-COD-ITEM                     PIC 9(04).
              05 WSS-IND-ITEM                     PIC 9(04).
      * JVM
           03 WSS-GLS-MC1.
              05 WSS-GLS-MC11                     PIC X(72).
              05 WSS-GLS-FIL1                     PIC X(08).
           03 WSS-GLS-MC2.
              05 WSS-GLS-MC21                     PIC X(71).
              05 WSS-GLS-FIL2                     PIC X(09).
           03 WSS-GLS-MC3.
              05 WSS-GLS-MC31                     PIC X(49).
              05 WSS-GLS-FIL3                     PIC X(31).
           03 WSS-COD-CCO1.
      * JVM: 22/09/92
              05 WSS-COD-OFI0                     PIC X(01).
      * OFICINA
              05 WSS-COD-OFI1                     PIC X(03).
              05 WSS-GLS-RES1                     PIC X(08).
      * JVM
           03 WSS-COD-CCO2.
      * MONEDA SEGUN SUPER "013"
              05 WSS-COD-MONE                     PIC X(03).
      * OFICINA CABECERA
              05 WSS-COD-OFI2                     PIC X(03).
      * CEROS
              05 WSS-GLS-RES2                     PIC X(03).
      * OFICINA SATELITE
              05 WSS-COD-OFI3                     PIC X(03).
      * JVM
           03 WSS-GLS-NOMB.
              05 WSS-GLS-NOM1                     PIC X(28).
              05 WSS-NUM-DNO1                     PIC 9(02).
              05 WSS-GLS-SLA1                     PIC X(01).
              05 WSS-NUM-MNO1                     PIC 9(02).
              05 WSS-GLS-SLA2                     PIC X(01).
              05 WSS-NUM-SNO1                     PIC 9(02).
              05 WSS-NUM-ANO1                     PIC 9(02).

      * JVM/BCI 28-05-93
           03 WSS-GLS-CTBL.
              05 WSS-GLS-CCTA.
                 07 WSS-GLS-CCT1                  PIC X(30).
                 07 WSS-GLS-CCT2                  PIC X(12).
              05 WSS-GLS-FECH.
                 07 WSS-GLS-BLAN                  PIC X(01).
                 07 WSS-FEC-FCTB.
                    09 WSS-NUM-MCTB               PIC 9(02).
                    09 WSS-NUM-ACTB               PIC 9(02).
                 07 WSS-GLS-REST                  PIC X(05).
      * JVM/BCI
      *>>>>
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LIQ-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY DAPRFSUB.
           .
       COPY DAPRTSUB.
      *<<<< RT
       COPY DAPRFMCT.
           .
       COPY DAPRTMCT.
      *>>>>

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-SUB-SRT-COD-OFIC SECTION.
           USE BEFORE REPORTING CF-SUB-SRT-COD-OFIC.
       INI-CF-SUB-SRT-COD-OFIC.
      *<<<< CF_SUB_SRT_COD_OFIC
           MOVE ZEROES TO PAGE-COUNTER IN RPT-SUB.
      *>>>>
       FIN-CF-SUB-SRT-COD-OFIC.
           EXIT.
       DEC-CF-SUB-SRT-CIC-CCTB SECTION.
           USE BEFORE REPORTING CF-SUB-SRT-CIC-CCTB.
       INI-CF-SUB-SRT-CIC-CCTB.
      *<<<< CF_SUB_SRT_CIC_CCTB
      *DAD ini  23-JUN-1992
      *     MOVE WSS-NUM-TCDE IN WSS-VARI TO WSS-NUM-TCDE IN WSS-SUB.
      *     MOVE WSS-NUM-TCHA IN WSS-VARI TO WSS-NUM-TCHA IN WSS-SUB.
           MOVE ZEROES TO WSS-NUM-TCDE IN WSS-VARI
                          WSS-NUM-TCHA IN WSS-VARI.

      *DAD ini  16-OCT-1992
           ADD WSS-VAL-ADEB IN WSS-VARI
      *DAD fin  16-OCT-1992
               SUM-VAL-TCDE            GIVING WSS-VAL-NDEB IN WSS-SUB.
      *DAD ini  16-OCT-1992
           ADD WSS-VAL-AHAB IN WSS-VARI
      *DAD fin  16-OCT-1992
               SUM-VAL-TCHA            GIVING WSS-VAL-NHAB IN WSS-SUB.
           SUBTRACT WSS-VAL-NDEB IN WSS-SUB FROM
                    WSS-VAL-NHAB IN WSS-SUB GIVING
                    WSS-VAL-NSAL IN WSS-SUB.
      *    Codigo se cambio a la Declarativa : SRT-FEC-FMOV
      * JVM
           MOVE OPD-COD-VCAM IN SRT TO WSS-COD-VCAM IN WSS-VARI.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF = 'S'

           IF WSS-COD-TVAL IN WSS-VARI = '1'
      *Genera registro CT2 Interfaz Contable Moneda Extranjera
               PERFORM GEN-REG-CT2
           ELSE
      *Genera registro CT1 Interfaz Contable Moneda Chilena
               PERFORM GEN-REG-CT1.

           MOVE ZEROES TO WSS-VAL-TDEB IN WSS-VARI
                          WSS-VAL-THAB IN WSS-VARI.
      * JVM
      * FIN   Codigo cambiado a esta Declarativa : SRT-FEC-FMOV

      *DAD fin  23-JUN-1992
      *>>>>
       FIN-CF-SUB-SRT-CIC-CCTB.
           EXIT.
       DEC-CH-SUB-SRT-CIC-CCTB SECTION.
           USE BEFORE REPORTING CH-SUB-SRT-CIC-CCTB.
       INI-CH-SUB-SRT-CIC-CCTB.
       FIN-CH-SUB-SRT-CIC-CCTB.
           EXIT.
       DEC-CF-SUB-SRT-GLS-BLK2 SECTION.
           USE BEFORE REPORTING CF-SUB-SRT-GLS-BLK2.
       INI-CF-SUB-SRT-GLS-BLK2.
       FIN-CF-SUB-SRT-GLS-BLK2.
           EXIT.
       DEC-CF-SUB-OPD-COD-VCAM SECTION.
           USE BEFORE REPORTING CF-SUB-OPD-COD-VCAM.
       INI-CF-SUB-OPD-COD-VCAM.
      *<<<< CF_SUB_OPD_COD_VCAM
      *>>>>
       FIN-CF-SUB-OPD-COD-VCAM.
           EXIT.
       DEC-CF-SUB-SRT-FEC-FMOV SECTION.
           USE BEFORE REPORTING CF-SUB-SRT-FEC-FMOV.
       INI-CF-SUB-SRT-FEC-FMOV.
      *<<<< CF_SUB_SRT_FEC_FMOV
      *DAD ini  23-JUN-1992
      * INI   Codigo cambiado a esta Declarativa : SRT-FEC-FMOV
           MOVE WSS-NUM-TDEB IN WSS-VARI TO WSS-NUM-TDEB IN WSS-SUB.
           MOVE WSS-NUM-THAB IN WSS-VARI TO WSS-NUM-THAB IN WSS-SUB.
           MOVE ZEROES TO WSS-NUM-TDEB IN WSS-VARI
                          WSS-NUM-THAB IN WSS-VARI.
           ADD WSS-NUM-TDEB IN WSS-VARI TO WSS-NUM-TCDE IN WSS-VARI.
           ADD WSS-NUM-THAB IN WSS-VARI TO WSS-NUM-TCHA IN WSS-VARI.
           SUBTRACT SUM-VAL-TDEB FROM
                    SUM-VAL-THAB GIVING
                    WSS-VAL-SALD IN WSS-VARI.
           ADD WSS-VAL-SALD IN WSS-VARI TO WSS-VAL-TSAL IN WSS-SUB.
      *DAD fin  23-JUN-1992
      *>>>>
       FIN-CF-SUB-SRT-FEC-FMOV.
           EXIT.
       DEC-PH-SUB SECTION.
           USE BEFORE REPORTING PH-SUB.
       INI-PH-SUB.
      *<<<< PH_SUB
      * Mediante BUS-OFI Obtiene Nombre y Direccion Oficina de Tabla OFI
           IF SRT-COD-OFIC IN SRT > SPACES
               MOVE SRT-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.

           MOVE ZEROES TO WSS-NUM-FOLO IN WSS-SUB.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
      *CIC-GET Obtener CIC
           IF WSS-IND-FORM IN WSS-VARI = 'S'
               MOVE 'F'                 TO CIC-COD-TCIC IN CIC
               MOVE SRT-COD-OFIC IN SRT TO CIC-COD-CCIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
                   DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                           CIC-CIC-ICIC IN CIC
      *DAD ini  23-JUN-1992
                   GO TO FIN-PH-SUB
               ELSE
      *DAD fin  23-JUN-1992
                   MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-FOLO IN WSS-SUB.

      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCTB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCTB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI
               MOVE WSS-GLS-CCTB IN WSS-VARI TO WSS-GLS-CCTB IN WSS-SUB
      *         MOVE WSS-GLS-DVRF IN WSS-VARI TO WSS-GLS-DVRF IN WSS-SUB
           ELSE
               MOVE SPACES TO WSS-GLS-CCTB IN WSS-SUB.
      *         MOVE SPACES TO WSS-GLS-DVRF IN WSS-SUB.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPD-COD-VCAM IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCAM IN WSS-SUB
           ELSE
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-SUB.
      *>>>>
       FIN-PH-SUB.
           EXIT.
      *<<<< FIN_DEC
       DEC-CF-MCT-SRT-COD-OFIC SECTION.
           USE BEFORE REPORTING CF-MCT-SRT-COD-OFIC.
       INI-CF-MCT-SRT-COD-OFIC.
      *<<<< CF_MCT_SRT_COD_OFIC
           MOVE ZEROES TO PAGE-COUNTER IN RPT-MCT.
      *>>>>
       FIN-CF-MCT-SRT-COD-OFIC.
           EXIT.

       DEC-CF-MCT-SRT-CIC-CCTB SECTION.
           USE BEFORE REPORTING CF-MCT-SRT-CIC-CCTB.
       INI-CF-MCT-SRT-CIC-CCTB.
      *<<<< CF_MCT_SRT_CIC_CCTB
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCTB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCTB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI
               MOVE WSS-GLS-CCTB IN WSS-VARI TO WSS-GLS-CCTB IN WSS-MCT
      *         MOVE WSS-GLS-DVRF IN WSS-VARI TO WSS-GLS-DVRF IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-CCTB IN WSS-MCT.
      *         MOVE SPACES TO WSS-GLS-DVRF IN WSS-MCT.
      *>>>>
       FIN-CF-MCT-SRT-CIC-CCTB.
           EXIT.

       DEC-CF-MCT-SRT-FEC-FMOV SECTION.
           USE BEFORE REPORTING CF-MCT-SRT-FEC-FMOV.
       INI-CF-MCT-SRT-FEC-FMOV.
      *<<<< CF_MCT_SRT_FEC_FMOV
           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-MCT.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-MCT.
           MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-MCT.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-MCT.
      *>>>>
       FIN-CF-MCT-SRT-FEC-FMOV.
           EXIT.
      *DAD ini  23-JUN-1992
      *    Codigo se cambio a la Declarativa : OPD-COD-VCAM
      * DEC-CF-MCT-OPD-COD-VCAM SECTION.
      *     USE BEFORE REPORTING CF-MCT-OPD-COD-VCAM.
      * INI-CF-MCT-OPD-COD-VCAM.
      **<<<< CF_MCT_SRT_FEC_FMOV
      *     MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
      *     MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-MCT.
      *     MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-MCT.
      *     MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-MCT.
      *     MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-MCT.
      **>>>>
      * FIN-CF-MCT-OPD-COD-VCAM.
      *     EXIT.
      *DAD fin  23-JUN-1992

       DEC-PH-MCT SECTION.
           USE BEFORE REPORTING PH-MCT.
       INI-PH-MCT.
      *<<<< PH_MCT
      * Mediante BUS-OFI Obtiene Nombre y Direccion Oficina de Tabla OFI
           IF SRT-COD-OFIC IN SRT > SPACES
               MOVE SRT-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-MCT.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPD-COD-VCAM IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCAM IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-MCT.
      *>>>>
       FIN-PH-MCT.
           EXIT.

      *>>>>
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'DAPPLSUB' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
           ACCEPT  WSS-IND-TRPT IN WSS-VARI.
           DISPLAY 'REPORTE : ' WSS-IND-TRPT IN WSS-VARI.

      *#      ACEPTA COMO PARAMETRO LA FECHA DE PROCESO,
      *#      DETERMINA EL RANGO DE BUSQUEDA COMO :
      *#
      *# FECHA INICIO PARA LSUB Y LLMD
      *#
      *#      SI DIA ANTERIOR A FPRO ES HABIL:
      *#         F. INICIO  = F. PROCESO
      *#      ELSE
      *#         F. INICIO  = DIA HABIL ANTERIOR A F. PROCESO + 1
      *#
      *# FECHA TERMINO PARA LLMD
      *#
      *#         F. TERMINO = F. PROCESO
      *#
      *# FECHA TERMINO PARA LSUB
      *#
      *#         F. TERMINO = F. TERMINO ( PARAMETRO ADICIONAL )
      *#
           IF WSS-IND-TRPT = 'LLMD'
      **Captura Fecha de Proceso
              DISPLAY 'FECHA DE PROCESO  ( DDMMAAAA ) : '
           ELSE
      **Captura Fecha de Inicio
              DISPLAY 'FECHA DE INICIO  ( DDMMAAAA ) : '.

           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
     *     PERFORM ACC-FPRO.
     **** BCI CPZ 17.04.94
           MOVE WSS-NUM-DPRO TO WSS-NUM-DINI IN WSS-VARI.
           MOVE WSS-NUM-MPRO TO WSS-NUM-MINI IN WSS-VARI.
           MOVE WSS-NUM-SPRO TO WSS-NUM-SINI IN WSS-VARI.
           MOVE WSS-NUM-APRO TO WSS-NUM-AINI IN WSS-VARI.


           IF WSS-IND-TRPT = 'LSUB'
      *Captura Fecha de Termino
               DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
               ACCEPT  WSS-FEC-FPRO IN WSS-VARI
               DISPLAY WSS-FEC-FPRO IN WSS-VARI.

           MOVE WSS-NUM-DPRO TO WSS-NUM-DFIN IN WSS-VARI.
           MOVE WSS-NUM-MPRO TO WSS-NUM-MFIN IN WSS-VARI.
           MOVE WSS-NUM-SPRO TO WSS-NUM-SFIN IN WSS-VARI.
           MOVE WSS-NUM-APRO TO WSS-NUM-AFIN IN WSS-VARI.

      *DAD fin  23-JUN-1992
      *Captura Codigo de Oficina
           DISPLAY 'CODIGO DE OFICINA   ( */XXX )  : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           IF WSS-IND-TRPT = 'LSUB'
      *Captura Indicador Papel Foliado
               DISPLAY 'INDICADOR PAPEL FOLIADO ( S/N ): '
               ACCEPT  WSS-IND-FORM IN WSS-VARI
               DISPLAY WSS-IND-FORM IN WSS-VARI
               MOVE 'N' TO WSS-IND-GITF IN WSS-VARI
           ELSE
      *Captura genera interfaz
               DISPLAY 'GENERA INTERFAZ ( S/N ): '
               ACCEPT  WSS-IND-GITF IN WSS-VARI
               DISPLAY WSS-IND-GITF IN WSS-VARI
               MOVE 'N' TO WSS-IND-FORM IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *DAD ini  23-JUN-1992
      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE INICIO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FFIN IN WSS-VARI.
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE TERMINO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' FECHA INICIO > FECHA TERMINO: '
                         WSS-FEC-FINI ' > ' WSS-FEC-FFIN
               PERFORM GNS-PRO-ABT.

           DISPLAY 'FECHA INICIO  DE SELECCION : ' WSS-FEC-FINI.
           DISPLAY 'FECHA TERMINO DE SELECCION : ' WSS-FEC-FFIN.
      *DAD fin  23-JUN-1992

      *VAL-OFI Valida Codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION OFICINA: ' WSS-COD-OFIC
                  PERFORM GNS-PRO-ABT.

      *Valida Indicador formulario foliado (S/N)
           IF WSS-IND-FORM IN WSS-VARI = 'S' OR 'N'
               NEXT SENTENCE
           ELSE
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'INDICADOR FORMULARIO ERRONEO: '
                                   WSS-IND-FORM IN WSS-VARI
               PERFORM GNS-PRO-ABT.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0999   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0998   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-RDOL IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$ Mediante CIC de la Moneda
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-1013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC1013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLL IN WSS-VARI.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DPRI IN WSS-VARI
                                            WSS-NUM-DINI IN WSS-MCT
                                            WSS-NUM-DINI IN WSS-SUB.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MPRI IN WSS-VARI
                                            WSS-NUM-MINI IN WSS-MCT
                                            WSS-NUM-MINI IN WSS-SUB.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SPRI IN WSS-VARI
                                            WSS-NUM-SINI IN WSS-MCT
                                            WSS-NUM-SINI IN WSS-SUB.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-APRI IN WSS-VARI
                                            WSS-NUM-AINI IN WSS-MCT
                                            WSS-NUM-AINI IN WSS-SUB.
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI
                                            WSS-NUM-DTER IN WSS-MCT
                                            WSS-NUM-DFIN IN WSS-SUB.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI
                                            WSS-NUM-MTER IN WSS-MCT
                                            WSS-NUM-MFIN IN WSS-SUB.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI
                                            WSS-NUM-STER IN WSS-MCT
                                            WSS-NUM-SFIN IN WSS-SUB.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI
                                            WSS-NUM-ATER IN WSS-MCT
                                            WSS-NUM-AFIN IN WSS-SUB.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

           IF WSS-IND-TRPT = 'LSUB'
      *          DISPLAY 'ORDENAMIENTO ASOCIADO A SUBSIDIARIO '
                SORT GNSSRT
      *    02-APR-93 09:03 AM
                  ON ASCENDING KEY SRT-GLS-BLK2 IN SRT
                  ON ASCENDING KEY SRT-COD-OFIC IN SRT
                  ON ASCENDING KEY OPD-COD-VCAM IN SRT
                  ON ASCENDING KEY SRT-CIC-CCTB IN SRT
                  ON ASCENDING KEY SRT-FEC-FMOV IN SRT
                  ON ASCENDING KEY OPD-CAI-ISER IN SRT
                  ON ASCENDING KEY OPD-IIC-ISER IN SRT
                  ON ASCENDING KEY SRT-IND-DBHB IN SRT
                  INPUT  PROCEDURE IS INP-SRT
                  OUTPUT PROCEDURE IS OUT-SRT
                  GO TO FIN-MAIN.
      *     DISPLAY 'ORDENAMIENTO ASOCIADO A LIBRO MAYOR'
      *>>>>
           SORT GNSSRT
       COPY DAPRSSUB.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-CRT.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR EN OPEN ARCHIVO CTI : ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *JVM


      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF = 'S'
               MOVE FIO-OUT TO FIO-CMND
               PERFORM DAP-FIO-CT1
               IF NOT FIO-STAT-OKS
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR EN OPEN ARCHIVO CT1 : ' FIO-STAT
      *JVM ini  11-AGO-1992
                  MOVE PGM-SMAL TO PGM-STAT-SRT
                  GO TO FIN-INP-SRT
      *JVM
               ELSE
                  MOVE FIO-OUT TO FIO-CMND
                  PERFORM DAP-FIO-CT2
                  IF NOT FIO-STAT-OKS
                     DISPLAY ' '
                     DISPLAY ' PROCESO CANCELADO '
                     DISPLAY ' ERROR EN OPEN ARCHIVO CT2 : ' FIO-STAT
      *JVM ini  11-AGO-1992
                     MOVE PGM-SMAL TO PGM-STAT-SRT
                     GO TO FIN-INP-SRT.
      *JVM

           IF WSS-IND-TRPT = 'LSUB'
               MOVE FIO-INP TO FIO-CMND
               PERFORM DAP-FIO-CTA
               IF NOT FIO-STAT-OKS
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR EN OPEN ARCHIVO CTA : ' FIO-STAT
      *JVM ini  11-AGO-1992
                  MOVE PGM-SMAL TO PGM-STAT-SRT
                  GO TO FIN-INP-SRT
      *JVM
               ELSE
                  MOVE FIO-INP TO FIO-CMND
                  PERFORM DAP-FIO-CMX
                  IF NOT FIO-STAT-OKS
                     DISPLAY ' '
                     DISPLAY ' PROCESO CANCELADO '
                     DISPLAY ' ERROR EN OPEN ARCHIVO CMX : ' FIO-STAT
      *JVM ini  11-AGO-1992
                     MOVE PGM-SMAL TO PGM-STAT-SRT
                     GO TO FIN-INP-SRT.
      *JVM

      * Proceso de seleccion
           MOVE WSS-FEC-FPRI IN WSS-VARI TO OPD-FEC-FCMP IN OPD.
           MOVE 'OPD-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR OPD POR OPD-FEC-FCMP : '
                                                     FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF OPD-FEC-FCMP IN OPD > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS OPD EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.


           PERFORM BUS-OFI-CBC.

      * Proceso de Seleccion y Clasificacion a Partir del Registro LIQ
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-INP-SRT.

           IF NOT ( ( OPD-COD-STAT IN OPD = 'G'
                    )
                    OR
                    ( OPD-COD-STAT IN OPD = 'L' AND
                      OPD-FEC-FREA IN OPD = OPD-FEC-FPCO IN OPD
                    )
                  )
              GO TO NXT-INP-SRT.

           IF OPD-FEC-FCMP IN OPD NOT = OPD-FEC-FCTB IN OPD AND
              WSS-IND-TRPT = 'LLMD'
              GO TO NXT-INP-SRT.

           IF OPD-COD-RENO IN OPD = 'S'
              IF OPD-FEC-FREA IN OPD NOT = OPD-FEC-FPCO IN OPD
                 GO TO NXT-INP-SRT.

           IF OPD-FEC-FREA IN OPD < WSS-FEC-FPRI IN WSS-VARI OR
              OPD-FEC-FREA IN OPD > WSS-FEC-FTER IN WSS-VARI
                 GO TO NXT-INP-SRT.

           ADD 1 TO WSS-LEI-OPD IN WSS-VARI.

           MOVE 'ING' TO CPP-COD-MVTO IN CPP.
           IF OPD-COD-RENO IN OPD = 'S' AND
              OPD-FEC-FREA IN OPD = OPD-FEC-FPCO IN OPD AND
              OPD-CIC-IOPD IN OPD NOT = OPD-CIC-ORIG IN OPD
                  MOVE 'S' TO BUS-MEM-ISER.
      *            MOVE OPD-CIC-ORIG IN OPD TO OPD-CIC-IOPD IN OPD.
           MOVE OPD-FEC-FREA IN OPD TO WSS-FEC-FSRT IN WSS-VARI.
           PERFORM PRO-CPP.
           GO TO NXT-INP-SRT.
      *>>>>
       MOV-INP-SRT.
       COPY DAPRMSUB.
      *<<<< RM
           DISPLAY 'OPD-MCLI ' OPD-CIC-IOPD IN OPD ' '
                               OPD-IND-MCLI IN OPD ' '
                               OPD-IND-MCLI IN SRT.
           MOVE SRT-FEC-FMOV IN SRT TO WSS-FEC-FAMD.
           MOVE WSS-NUM-DAMD TO FEC-ITM1.
           MOVE WSS-NUM-MAMD TO FEC-ITM2.
           MOVE WSS-NUM-SAMD TO FEC-ITM3.
           MOVE WSS-NUM-AAMD TO FEC-ITM4.
       CIC-NXT-HBL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE 1 TO FEC-NDIA
               PERFORM CAL-FEC
               GO TO CIC-NXT-HBL.
           MOVE FEC-ITM1 TO WSS-NUM-DAMD.
           MOVE FEC-ITM2 TO WSS-NUM-MAMD.
           MOVE FEC-ITM3 TO WSS-NUM-SAMD.
           MOVE FEC-ITM4 TO WSS-NUM-AAMD.
           MOVE WSS-FEC-FAMD TO SRT-FEC-FMOV IN SRT.

      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
           MOVE 'OPD-FEC-FCMP' TO FIO-AKEY.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
      *<<<< FIN_NXT_INP
      * PARA PROCESO RETROACTIVO OPERACIONES INGRESADAS FUERA DEL RANGO,
      * CON FREA DENTRO DEL RANGO
      *     IF OPD-FEC-FCMP IN OPD > WSS-FEC-FTER IN WSS-VARI
      *         GO TO FIN-INP-SRT.
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
           IF PGM-STAT-SRT-OKS
              PERFORM PRO-LIQ.
           IF PGM-STAT-SRT-OKS
              PERFORM PRO-VEN-DPF.
           IF PGM-STAT-SRT-OKS
              PERFORM PRO-VEN.
           IF PGM-STAT-SRT-OKS
              PERFORM PRO-CRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-CRT.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM DAP-FIO-OPD.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      * Abre Reporte RPTMCT
           OPEN OUTPUT RPTMCT.
           INITIATE RPT-MCT.
      *>>>>
           OPEN OUTPUT RPTSUB.
      *     MOVE 'DAPPLSUB' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-SUB.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
      *<<<< FST_OUT
      *DAD ini  16-OCT-1992
           MOVE '   RUT  : 97006000 - 6' TO WSS-GLS-RUTI IN WSS-SUB.
      *DAD fin  16-OCT-1992
      *DAD ini  23-JUN-1992
      * Guarda Codigo Oficina y Numero Cuenta Contable para Leer Archivo
      * e Imprimir el Saldo Anterior de la Cuenta Contable
           MOVE SRT-COD-OFIC IN SRT TO WSS-COD-COFI IN WSS-VARI.
           MOVE SRT-CIC-CCTB IN SRT TO WSS-CIC-CCTB IN WSS-VARI.
           PERFORM PRO-LEE-CTA.
      *JVM ini  11-AGO-1992
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY ' '
      *         DISPLAY ' PROCESO CANCELADO '
      *         DISPLAY ' ERROR AL ACCESAR CTA : ' CTA-KEY-IREG
      *                 ' STAT : ' FIO-STAT
      *         MOVE PGM-SMAL TO PGM-STAT-SRT
      *        GO TO EXT-OUT-SRT.
      *JVM
           SUBTRACT WSS-VAL-ADEB IN WSS-SUB FROM
                    WSS-VAL-AHAB IN WSS-SUB GIVING
                    WSS-VAL-ASAL IN WSS-SUB.
           MOVE WSS-VAL-ASAL IN WSS-SUB TO WSS-VAL-TSAL IN WSS-SUB.
      *DAD ini  16-OCT-1992
           MOVE WSS-VAL-ADEB IN WSS-SUB TO WSS-VAL-ADEB IN WSS-VARI.
           MOVE WSS-VAL-AHAB IN WSS-SUB TO WSS-VAL-AHAB IN WSS-VARI.
      *DAD fin  16-OCT-1992
           GENERATE DL-SAL.

      * Llena Datos Fijos de HEADER
           MOVE 'BH'                     TO MCH-COD-IREG IN MCH.
           MOVE 'DP'                     TO MCH-COD-ISIS IN MCH.
           MOVE  2                       TO MCH-IND-FIL1 IN MCH.
           MOVE  0                       TO MCH-IND-TAJU IN MCH.
           MOVE WSS-NUM-DTER IN WSS-VARI TO MCH-NUM-DMOV IN MCH.
           MOVE WSS-NUM-MTER IN WSS-VARI TO MCH-NUM-MMOV IN MCH.
           MOVE WSS-NUM-ATER IN WSS-VARI TO MCH-NUM-AMOV IN MCH.
           MOVE SPACES                   TO MCH-GLS-DISP IN MCH.

      * Completa Datos Variables de HEADER y Graba registros CT1 y CT2
           IF SRT-GLS-BLK2 IN SRT = '01'
               MOVE SRT-GLS-BLK2 IN SRT      TO MCH-COD-ILOT IN MCH
               PERFORM SET-MLOT-N1
               PERFORM GEN-HDR-CT1

               PERFORM SET-MLOT-X1
               PERFORM GEN-HDR-CT2

               MOVE 2 TO WSS-IND-LOTE IN WSS-VARI
           ELSE
           IF SRT-GLS-BLK2 IN SRT = '02'
               MOVE SRT-GLS-BLK2 IN SRT      TO MCH-COD-ILOT IN MCH
               PERFORM SET-MLOT-N2
               PERFORM GEN-HDR-CT1

               PERFORM SET-MLOT-X2
               PERFORM GEN-HDR-CT2
               MOVE 3 TO WSS-IND-LOTE IN WSS-VARI.
      *DAD fin  23-JUN-1992
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
      *     DISPLAY 'SRT ' SRT.
      * Proceso de emision de lineas de detalle
           IF OPD-CAI-IOPD IN SRT = 'CMR1' OR 'CMR2'
              PERFORM BUS-GLS-CMR
           ELSE
              PERFORM GET-CUR-RCC
              IF WSS-STAT-RCC IN WSS-VARI = 0
                  PERFORM GET-RCC-DBC
              ELSE
                 PERFORM RST-DBC.

      *DAD ini  23-JUN-1992
      * Cuando Codigo Oficina o Numero Cuenta Contable distinta de anter
      * Lee Archivo CTA e Imprimir el Saldo Anterior de la Cuenta Contab
      * guarda nuevo Codigo Oficina y Numero Cuenta Contable
           IF NOT ( SRT-COD-OFIC IN SRT = WSS-COD-COFI IN WSS-VARI AND
                    SRT-CIC-CCTB IN SRT = WSS-CIC-CCTB IN WSS-VARI )
               PERFORM PRO-LEE-CTA
      *JVM ini  11-AGO-1992
      *         IF NOT FIO-STAT-OKS
      *            DISPLAY ' '
      *            DISPLAY ' PROCESO CANCELADO '
      *            DISPLAY ' ERROR AL ACCESAR CTA : ' CTA-KEY-IREG
      *                    ' STAT : ' FIO-STAT
      *            MOVE PGM-SMAL TO PGM-STAT-SRT
      *            GO TO EXT-OUT-SRT
      *         ELSE
      *JVM
               MOVE SRT-COD-OFIC IN SRT TO WSS-COD-COFI IN WSS-VARI
               MOVE SRT-CIC-CCTB IN SRT TO WSS-CIC-CCTB IN WSS-VARI
               SUBTRACT WSS-VAL-ADEB IN WSS-SUB FROM
                        WSS-VAL-AHAB IN WSS-SUB GIVING
                        WSS-VAL-ASAL IN WSS-SUB
               GENERATE DL-SAL
      *DAD ini  16-OCT-1992
               MOVE WSS-VAL-ADEB IN WSS-SUB TO WSS-VAL-ADEB IN WSS-VARI
               MOVE WSS-VAL-AHAB IN WSS-SUB TO WSS-VAL-AHAB IN WSS-VARI
      *DAD fin  16-OCT-1992
               MOVE WSS-VAL-ASAL IN WSS-SUB TO WSS-VAL-TSAL IN WSS-SUB.

      * Completa Datos Variables de HEADER y Graba registros CT1 y CT2
           IF SRT-GLS-BLK2 IN SRT = '02' AND
              WSS-IND-LOTE IN WSS-VARI = 2
               MOVE SRT-GLS-BLK2 IN SRT      TO MCH-COD-ILOT IN MCH
               PERFORM SET-MLOT-N2
               PERFORM GEN-HDR-CT1

               PERFORM SET-MLOT-X2
               PERFORM GEN-HDR-CT2
               MOVE 3 TO WSS-IND-LOTE IN WSS-VARI.
      *DAD fin  23-JUN-1992
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-SUB.
      *<<<< FIN_GEN_OUT
      *     DISPLAY ' '.
      *     DISPLAY '========>'.

      *     DISPLAY 'PAG = ' PAGE-COUNTER IN RPT-SUB ' '
      *             'LIN = ' LINE-COUNTER IN RPT-SUB ' '
      *             'OPD = ' OPD-CAI-IOPD IN SRT '-'
      *                      OPD-IIC-IOPD IN SRT.

      *     DISPLAY 'CPP = ' CPP-COD-VCAM IN SRT ' '
      *                      CPP-COD-TOPD IN SRT ' '
      *                      CPP-COD-AOPD IN SRT ' '
      *                      CPP-COD-MVTO IN SRT.

      *     DISPLAY 'DCC = ' CPP-COD-TCCT IN SRT ' '
      *                      CPP-COD-DBHB IN SRT ' '
      *                      CPP-COD-TALG IN SRT.

           MOVE SRT-FEC-FMOV IN SRT     TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-SUB.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-SUB.
           MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-SUB.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-SUB.
      * JVM
           IF SRT-VAL-DEBE IN SRT NOT = 0
              ADD SRT-VAL-DEBE IN SRT TO WSS-VAL-TDEB IN WSS-VARI
              ADD 1  TO WSS-NUM-TDEB IN WSS-VARI.
           IF SRT-VAL-HABE IN SRT NOT = 0
              ADD SRT-VAL-HABE IN SRT TO WSS-VAL-THAB IN WSS-VARI
              ADD 1  TO WSS-NUM-THAB IN WSS-VARI.
           DISPLAY '*OPD-MCLI ' OPD-CAI-IOPD IN SRT
                  ' ' OPD-IIC-IOPD IN SRT ' '
                      OPD-IND-MCLI IN SRT.
           IF NOT ( OPD-CAI-IOPD IN SRT = 'CMR1' OR 'CMR2' )
               IF OPD-IND-MCLI IN SRT = 'S'
                   PERFORM GET-NXT-RCC.
      * JVM
           GENERATE DL-MCT.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           DISPLAY 'TOTALES DE CONTROL DAPPLSUB'.
           DISPLAY '---------------------------'.
           DISPLAY '    '.
           DISPLAY 'REG. GRABADOS SORT...: ' WSS-GRA-SRT.
           DISPLAY 'REG. LEIDOS OPD......: ' WSS-LEI-OPD.
           DISPLAY 'REG. LEIDOS LIQ......: ' WSS-LEI-LIQ.
           DISPLAY 'REG. LEIDOS VEN......: ' WSS-LEI-VEN.
           IF WSS-IND-GITF = 'S'
               DISPLAY 'REG. GRABADOS CT1....: ' WSS-GRA-CT1
               DISPLAY 'REG. GRABADOS CT2....: ' WSS-GRA-CT2.
      *>>>>
           TERMINATE RPT-SUB.
      *<<<< FIN_TMT
           TERMINATE RPT-MCT.
           CLOSE RPTMCT.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF NOT = 'S'

              MOVE FIO-CLO TO FIO-CMND
              PERFORM DAP-FIO-CT1
              MOVE FIO-CLO TO FIO-CMND
              PERFORM DAP-FIO-CT2.

           IF WSS-IND-TRPT = 'LSUB'
               MOVE FIO-CLO TO FIO-CMND
               PERFORM DAP-FIO-CTA
               MOVE FIO-CLO TO FIO-CMND
               PERFORM DAP-FIO-CMX.

      *>>>>
           CLOSE RPTSUB.
       EXT-OUT-SRT.
           EXIT.
       COPY DAPBFOPD.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
       SET-MLOT-N1 SECTION.
       INI-SET-MLOT-N1.
           IF WSS-VAL-LTN1-DEBE IN WSS-VARI > WSS-VAL-LTN1-HABE
               MOVE WSS-VAL-LTN1-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTN1-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-N1.
           EXIT.

       SET-MLOT-X1 SECTION.
       INI-SET-MLOT-X1.
           IF WSS-VAL-LTX1-DEBE IN WSS-VARI > WSS-VAL-LTX1-HABE
               MOVE WSS-VAL-LTX1-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTX1-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-X1.
           EXIT.

       SET-MLOT-N2 SECTION.
       INI-SET-MLOT-N2.
           IF WSS-VAL-LTN2-DEBE IN WSS-VARI > WSS-VAL-LTN2-HABE
               MOVE WSS-VAL-LTN2-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTN2-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-N2.
           EXIT.

       SET-MLOT-X2 SECTION.
       INI-SET-MLOT-X2.
           IF WSS-VAL-LTX2-DEBE IN WSS-VARI > WSS-VAL-LTX2-HABE
               MOVE WSS-VAL-LTX2-DEBE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH
           ELSE
               MOVE WSS-VAL-LTX2-HABE IN WSS-VARI TO
                    MCH-VAL-MLOT IN MCH.
       FIN-SET-MLOT-X2.
           EXIT.

       PRO-LIQ SECTION.
       INI-PRO-LIQ.
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.
      * RECORRER LIQ POR FECHA LIQUIDACION COMPUTACIONAL
           MOVE WSS-FEC-FPRI IN WSS-VARI TO LIQ-FEC-FCMP IN LIQ.
           MOVE 'LIQ-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'ERROR AL ACCESAR LIQ POR LIQ-FEC-FCMP : '
                                                     FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-LIQ.
           IF LIQ-FEC-FCMP IN LIQ > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS LIQ EN RANGO DE FECHAS : '
      *DAD ini  23-JUN-1992
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
                       WSS-FEC-FFIN IN WSS-VARI
      *DAD fin  23-JUN-1992
               GO TO FIN-PRO-LIQ.

       LUP-PRO-LIQ.
           ADD 1 TO WSS-LEI-LIQ IN WSS-VARI.
           MOVE 0 TO WSS-IND-FEC IN WSS-VARI.

           IF LIQ-FEC-FREA IN LIQ = LIQ-FEC-FCMP IN LIQ AND
              LIQ-FEC-FREA IN LIQ = LIQ-FEC-FCTB IN LIQ
              MOVE 1 TO WSS-IND-FEC IN WSS-VARI.

      * LEER OPD PARA DISPONER DE TODOS LOS DATOS
           MOVE LIQ-CIC-IOPD IN LIQ TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' OPD INEXISTENTE PARA LIQ : CIC='
                         LIQ-CIC-IOPD IN LIQ
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-LIQ.

      * LEER VEN PARA DISPONER DE TODOS LOS DATOS
           MOVE LIQ-CIC-IOPD IN LIQ TO VEN-CIC-IOPD IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.

           PERFORM BUS-OFI-CBC.

      * Proceso de Seleccion por oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-PRO-LIQ.

           MOVE 0 TO WSS-IND-CPP IN WSS-VARI.
           MOVE LIQ-FEC-FCMP IN LIQ TO WSS-FEC-FSRT IN WSS-VARI.

           IF LIQ-COD-LIQU IN LIQ = 'RC'
              IF LIQ-COD-STAT IN LIQ = 'A'
                 MOVE 'LAN' TO CPP-COD-MVTO IN CPP
                 PERFORM PRO-CPP
                 GO TO NXT-PRO-LIQ.

           IF LIQ-COD-LIQU IN LIQ NOT = 'RC' AND
                 OPD-COD-RENO IN OPD NOT = 'S'
                      IF LIQ-COD-STAT IN LIQ = 'A' AND
                         LIQ-FEC-FCMP IN LIQ > LIQ-FEC-FCTB IN LIQ
                           MOVE LIQ-FEC-FCMP IN LIQ TO
                               WSS-FEC-FSRT IN WSS-VARI
                           MOVE 'LAT' TO CPP-COD-MVTO IN CPP
                            PERFORM PRO-CPP.

           IF OPD-COD-RENO IN OPD = 'S'
              IF ( LIQ-COD-LIQU IN LIQ = 'LP' ) AND
                 ( LIQ-COD-STAT IN LIQ = 'A' )
                   MOVE 'S' TO BUS-MEM-ISER
      *             PERFORM MEM-ISER
                    MOVE OPD-CIC-ORIG IN OPD TO
                         LIQ-CIC-IOPD IN LIQ
      *             MOVE OPD-CIC-IOPD IN OPD TO
      *                  LIQ-CIC-IOPD IN LIQ

      *             MOVE OPD-FEC-FTER IN OPD TO
      *                                   OPD-FEC-FREA IN OPD
                   MOVE 'LRE' TO CPP-COD-MVTO IN CPP
                   PERFORM PRO-CPP
                   GO TO NXT-PRO-LIQ.

           IF OPD-COD-RENO IN OPD = 'S'
              IF ( LIQ-COD-LIQU IN LIQ = 'LT' ) AND
                 ( LIQ-COD-STAT IN LIQ = 'A' )
      *             PERFORM MEM-ISER
      *             MOVE OPD-CIC-IOPD IN OPD TO
      *                  LIQ-CIC-IOPD IN LIQ

      *             MOVE OPD-FEC-FTER IN OPD TO
      *                                   OPD-FEC-FREA IN OPD
                   MOVE 'LRE' TO CPP-COD-MVTO IN CPP
                   PERFORM PRO-CPP
                   GO TO NXT-PRO-LIQ.

       NXT-PRO-LIQ.
           MOVE 'LIQ-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS OR
              LIQ-FEC-FCMP IN LIQ > WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-PRO-LIQ.
           GO TO LUP-PRO-LIQ.
       FIN-PRO-LIQ.
           EXIT.

       PRO-VEN-DPF SECTION.
       INI-PRO-VEN-DPF.
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.
      * RECORRER VEN POR FECHA VENCIMIENTO
           MOVE WSS-FEC-FPRI IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR VEN POR VEN-FEC-FVEN : '
                                                      FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-VEN-DPF.

           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS VEN EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
               GO TO FIN-PRO-VEN-DPF.

       LUP-PRO-VEN-DPF.

      * LEER OPD PARA DISPONER DE TODOS LOS DATOS
           MOVE VEN-CIC-IOPD IN VEN TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' OPD INEXISTENTE PARA LIQ : CIC='
                         LIQ-CIC-IOPD IN LIQ
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-VEN-DPF.

           IF OPD-COD-RENO IN OPD = 'S'
               GO TO NXT-PRO-VEN-DPF.

           PERFORM BUS-OFI-CBC.

      * Proceso de Seleccion por oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
               GO TO NXT-PRO-VEN-DPF.

      *    ACCESO A LIQ PARA VER SI EXISTE UNA LIQ PARA EL VEN
           MOVE VEN-CIC-IOPD IN VEN TO LIQ-CIC-IOPD IN LIQ.
           MOVE ZEROES              TO LIQ-NUM-ILIQ IN LIQ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS OR
               VEN-CIC-IOPD IN VEN NOT = LIQ-CIC-IOPD IN LIQ
      *        DISPLAY 'EXISTE LIQ PARA VEN CON COD-LIQU= RC CIC='
      *        VEN-CIC-IOPD IN VEN ' ' VEN-NUM-IVEN IN VEN
               GO TO NXT-PRO-VEN-DPF.

       LUP-PRO-VEN-LIQ.
           IF LIQ-COD-LIQU IN LIQ NOT = 'LT'
              GO TO NXT-PRO-VEN-DPF.

           MOVE 0 TO WSS-IND-CPP IN WSS-VARI.
           MOVE LIQ-FEC-FCTB IN LIQ TO WSS-FEC-FSRT IN WSS-VARI.

           MOVE 'VEF' TO CPP-COD-MVTO IN CPP.
           PERFORM PRO-CPP.
           IF LIQ-COD-STAT IN LIQ = 'S' OR 'R' OR 'T'
                              OR
              LIQ-FEC-FCMP IN LIQ > LIQ-FEC-FCTB IN LIQ
                    MOVE LIQ-FEC-FCTB IN LIQ TO
                          WSS-FEC-FSRT IN WSS-VARI
                    MOVE 'TVF' TO CPP-COD-MVTO IN CPP
                    PERFORM PRO-CPP.

       NXT-PRO-VEN-DPF.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTER
              GO TO FIN-PRO-VEN-DPF.
           GO TO LUP-PRO-VEN-DPF.
       FIN-PRO-VEN-DPF.
           EXIT.

       PRO-VEN SECTION.
       INI-PRO-VEN.
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.
      * RECORRER VEN POR FECHA VENCIMIENTO
           MOVE WSS-FEC-FPRI IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR VEN POR VEN-FEC-FVEN : '
                                                      FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-VEN.
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS VEN EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
               GO TO FIN-PRO-VEN.

       LUP-PRO-VEN.
           IF VEN-COD-STAT IN VEN = 'N'
              GO TO NXT-PRO-VEN.

      *    ACCESO A LIQ PARA VER SI EXISTE UNA LIQ PARA EL VEN
           MOVE VEN-CIC-IOPD IN VEN TO LIQ-CIC-IOPD IN LIQ.
           MOVE ZEROES              TO LIQ-NUM-ILIQ IN LIQ.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CIC-IOPD IN VEN = LIQ-CIC-IOPD IN LIQ )
      *        DISPLAY 'EXISTE LIQ PARA VEN CON COD-LIQU= RC CIC='
      *        VEN-CIC-IOPD IN VEN ' ' VEN-NUM-IVEN IN VEN
              GO TO LUP-PRO-VEN-OPD.

       LUP-PRO-VEN-LIQ.
           IF LIQ-COD-LIQU IN LIQ = 'RC'
              GO TO NXT-PRO-VEN.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF ( FIO-STAT-OKS AND
                VEN-CIC-IOPD IN VEN = LIQ-CIC-IOPD IN LIQ )
                GO TO LUP-PRO-VEN-LIQ.

       LUP-PRO-VEN-OPD.
      * LEER OPD PARA DISPONER DE TODOS LOS DATOS
           MOVE VEN-CIC-IOPD IN VEN TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' OPD INEXISTENTE PARA VEN : CIC='
                         VEN-CIC-IOPD IN VEN
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-PRO-VEN.

           IF OPD-COD-RENO IN OPD NOT = 'S'
              GO TO NXT-PRO-VEN.

           PERFORM BUS-OFI-CBC.

      * Proceso de Seleccion por oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-PRO-VEN.

           MOVE 'VER' TO CPP-COD-MVTO IN CPP.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FSRT IN WSS-VARI.


           MOVE 'S' TO BUS-MEM-ISER
      *    PERFORM MEM-ISER
      *     MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.
           MOVE OPD-CIC-ORIG IN OPD TO VEN-CIC-IOPD IN VEN.
           PERFORM PRO-CPP.

           ADD 1 TO WSS-LEI-VEN IN WSS-VARI.

       NXT-PRO-VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FTER
              GO TO FIN-PRO-VEN.
           GO TO LUP-PRO-VEN.
       FIN-PRO-VEN.
           EXIT.

       BUS-OFI-CBC SECTION.
       INI-BUS-OFI-CBC.
      *CPZ.F300493. BUSCA OFICINA CABECERA PARA MONEX
      *    Codigo oficina
           IF OPD-MSC-TVAL = '1'  AND  OPD-COD-CVAL = '013'
              MOVE OPD-COD-OFIC TO     OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              IF MSG-COD-MENS  NOT > SPACES
                MOVE OFI-COD-OFCO IN OFI TO OPD-COD-OFIC IN OPD
              ELSE
                DISPLAY 'ERROR: BCI1 NO ENCONTRO OFICINA CABECERA'.
       FIN-BUS-OFI-CBC.
           EXIT.

       MEM-ISER SECTION.
       INI-MEM-ISER.
           MOVE OPD-CIC-IOPD IN OPD TO WSS-CIC-IOPD.
           MOVE OPD-VAL-SINT IN OPD TO WSS-VAL-SINT.
           MOVE OPD-CIC-ORIG IN OPD TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY 'OPERACION NO RECUPERABLE PARA OPD '
                                     OPD-CIC-IOPD IN OPD
               MOVE WSS-CIC-IOPD TO OPD-CIC-IOPD IN OPD
               GO TO FIN-MEM-ISER.

           IF OPD-SGV-TINT IN OPD = ZEROES
               MOVE WSS-VAL-SINT TO OPD-VAL-SINT IN OPD.
       FIN-MEM-ISER.
           EXIT.

       PRO-CRT SECTION.
       INI-PRO-CRT.
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.
      * RECORRE CRT POR LLAVE PRIMARIA PARA EL RANGO DE MOVIMIENTOS
           MOVE WSS-FEC-FTRA IN WSS-VARI TO CRT-FEC-FCRT IN CRT.

           MOVE 'M'                      TO CRT-COD-TMOV IN CRT.

      *     DISPLAY ' CANDIDATO PRIMER ACCESO A CRT CON LLAVE '
      *         CRT-KEY-ICRT.
           MOVE CRT-NUM-DCRT IN CRT TO FEC-ITM1.
           MOVE CRT-NUM-MCRT IN CRT TO FEC-ITM2.
           MOVE CRT-NUM-SCRT IN CRT TO FEC-ITM3.
           MOVE CRT-NUM-ACRT IN CRT TO FEC-ITM4.
       CIC-NXT-HBL-CRT.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE 1 TO FEC-NDIA
               PERFORM CAL-FEC
               GO TO CIC-NXT-HBL-CRT.
           MOVE FEC-ITM1 TO CRT-NUM-DCRT IN CRT.
           MOVE FEC-ITM2 TO CRT-NUM-MCRT IN CRT.
           MOVE FEC-ITM3 TO CRT-NUM-SCRT IN CRT.
           MOVE FEC-ITM4 TO CRT-NUM-ACRT IN CRT.

      *     DISPLAY ' PRIMER ACCESO REAL(HABIL) A CRT CON LLAVE '
      *        CRT-KEY-ICRT.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-CRT.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' ERROR : CRT (M) NO ENCONTRADO ' FIO-STAT
               GO TO FIN-PRO-CRT.
           IF CRT-FEC-FCRT IN CRT NOT = WSS-FEC-FTRA IN WSS-VARI OR
              CRT-COD-TMOV IN CRT NOT = 'M'
               DISPLAY 'NO HAY REGISTROS CRT PARA FECHA : '
                        WSS-NUM-DTRA
                        WSS-NUM-MTRA
                        WSS-NUM-STRA
                        WSS-NUM-ATRA
      *         DISPLAY 'REGISTRO CRT RECUPERADO : '
      *                  CRT-COD-TMOV IN CRT
      *                  CRT-NUM-DCRT IN CRT
      *                  CRT-NUM-MCRT IN CRT
      *                  CRT-NUM-SCRT IN CRT
      *                  CRT-NUM-ACRT IN CRT
               GO TO FIN-PRO-CRT.
      * Movimiento Reserva Tecnica
       LUP-PRO-CRT.
           MOVE CRT-VAL-TSAL IN CRT TO WSS-VAL-SACT IN WSS-VARI.

      * LEE EL REVERSO PARA LA FECHA DE REGISTRO DE MOVIMIENTO 'M'
           MOVE 'R' TO CRT-COD-TMOV IN CRT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CRT.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' ERROR AL LEER CRT(R): ' CRT-KEY-ICRT IN CRT
                      ' FS: ' FIO-STAT
               GO TO FIN-PRO-CRT.
      * Reversa Reserva Tecnica
           MOVE CRT-VAL-TSAL IN CRT TO WSS-VAL-SANT IN WSS-VARI.

      * Genera campos CRT movimiento del dia
           MOVE CRT-KEY-ICRT IN CRT TO WSS-KEY-ICRT IN WSS-VARI.
           MOVE 'CMR'  TO CPP-COD-MVTO IN CPP.
           MOVE '*'    TO OPD-COD-VCAM IN OPD.
           MOVE '*'    TO OPD-COD-TOPD IN OPD.
           MOVE '*'    TO OPD-COD-AOPD IN OPD.
           MOVE '*'    TO OPD-COD-PLZO IN OPD.
           MOVE SPACES TO OPD-COD-SCTB IN OPD.

           MOVE CRT-NUM-DCRT IN CRT TO WSS-NUM-DACT IN WSS-VARI.
           MOVE CRT-NUM-MCRT IN CRT TO WSS-NUM-MACT IN WSS-VARI.
           MOVE CRT-NUM-SCRT IN CRT TO WSS-NUM-SACT IN WSS-VARI.
           MOVE CRT-NUM-ACRT IN CRT TO WSS-NUM-AACT IN WSS-VARI.

      * Genera llave fecha para CRT Reversa (R)
      *     MOVE CRT-NUM-DCRT IN CRT TO FEC-ITM1.
      *     MOVE CRT-NUM-MCRT IN CRT TO FEC-ITM2.
      *     MOVE CRT-NUM-SCRT IN CRT TO FEC-ITM3.
      *     MOVE CRT-NUM-ACRT IN CRT TO FEC-ITM4.
      * CIC-FEC-ANT.
      *     MOVE FEC-RST-DIA  TO FEC-CMND.
      *     MOVE 1            TO FEC-NDIA.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     PERFORM CAL-FEC.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-FBLK-N   TO FEC-FBLK.
      *     MOVE FEC-CHOY-N   TO FEC-CHOY.
      *     MOVE FEC-VHBL-S   TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-HBL
      *         GO TO CIC-FEC-ANT.

      *     MOVE FEC-ITM1 TO WSS-NUM-DANT IN WSS-VARI.
      *     MOVE FEC-ITM2 TO WSS-NUM-MANT IN WSS-VARI.
      *     MOVE FEC-ITM3 TO WSS-NUM-SANT IN WSS-VARI.
      *     MOVE FEC-ITM4 TO WSS-NUM-AANT IN WSS-VARI.
      *     DISPLAY 'FCTR-1: ' FEC-FECH.

      *     MOVE WSS-NUM-DPRI IN WSS-VARI TO WSS-NUM-DREV.
      *     MOVE WSS-NUM-MPRI IN WSS-VARI TO WSS-NUM-MREV.
      *     MOVE WSS-NUM-SPRI IN WSS-VARI TO WSS-NUM-SREV.
      *     MOVE WSS-NUM-APRI IN WSS-VARI TO WSS-NUM-AREV.
      *     MOVE FEC-ITM1 TO WSS-NUM-DREV IN WSS-VARI.
      *     MOVE FEC-ITM2 TO WSS-NUM-MREV IN WSS-VARI.
      *     MOVE FEC-ITM3 TO WSS-NUM-SREV IN WSS-VARI.
      *     MOVE FEC-ITM4 TO WSS-NUM-AREV IN WSS-VARI.

           MOVE 1 TO WSS-COD-CMR IN WSS-VARI.
           PERFORM PRO-CPP.
           MOVE 0 TO WSS-COD-CMR IN WSS-VARI.

       NXT-PRO-CRT.
      * SE POSICIONA NUEVAMENTE EN REGISTRO 'M' DE PROCESO
           MOVE 'M' TO CRT-COD-TMOV IN CRT.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-CRT.

      * OBTIENE EL SIGUIENTE REGISTRO 'M', EL CUAL NO ES INHABIL,
      * PUES ESTOS NO SE GRABAN EN PROCESO GCMR
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-CRT.
           IF ( FIO-STAT-OKS AND
                CRT-FEC-FCRT IN CRT NOT > WSS-FEC-FTER AND
                CRT-COD-TMOV IN CRT  = 'M' )
               GO TO LUP-PRO-CRT.
       FIN-PRO-CRT.
           EXIT.

       PRO-CPP SECTION.
       INI-PRO-CPP.
           IF OPD-COD-SCTB IN OPD NOT > SPACES
              MOVE SPACES TO OPD-COD-SCTB IN OPD.
      * INI-JVM 02/09/92
           MOVE SPACES TO OPD-COD-SCTB IN OPD.
      * FIN-JVM 02/09/92
           MOVE OPD-COD-VCAM IN OPD TO CPP-COD-VCAM IN CPP.
           MOVE OPD-COD-TOPD IN OPD TO CPP-COD-TOPD IN CPP.
           MOVE OPD-COD-AOPD IN OPD TO CPP-COD-AOPD IN CPP.
           MOVE OPD-COD-SCTB IN OPD TO CPP-COD-SCTB IN CPP.
           MOVE CPP-COD-VCAM IN CPP TO CPP-COD-VCAM IN SRT.
           MOVE CPP-COD-TOPD IN CPP TO CPP-COD-TOPD IN SRT.
           MOVE CPP-COD-AOPD IN CPP TO CPP-COD-AOPD IN SRT.
           MOVE CPP-COD-MVTO IN CPP TO CPP-COD-MVTO IN SRT.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CPP.
           IF NOT FIO-STAT-OKS
                 DISPLAY 'CPP INEXISTENTE PARA'
                            ' MVTO=' CPP-COD-MVTO IN CPP
                            '/VCAM=' CPP-COD-VCAM IN CPP
                            '/TOPD=' CPP-COD-TOPD IN CPP
                            '/AOPD=' CPP-COD-AOPD IN CPP
                            '/SCTB=' CPP-COD-SCTB IN CPP
                 DISPLAY 'PARA OPD ' OPD-CIC-IOPD IN OPD
                GO TO FIN-PRO-CPP.

           PERFORM PRO-TRIO-CPP VARYING WSS-I
                           FROM 1 BY 1 UNTIL WSS-I > 20.
           MOVE 'N' TO BUS-MEM-ISER.
       FIN-PRO-CPP.
           EXIT.

       PRO-TRIO-CPP SECTION.
       INI-PRO-TRIO-CPP.
           IF CPP-COD-TCCT IN CPP(WSS-I) NOT > SPACES OR
              CPP-COD-DBHB IN CPP(WSS-I) NOT > SPACES OR
              CPP-COD-TALG IN CPP(WSS-I) NOT > SPACES
              GO TO FIN-PRO-TRIO-CPP.
      * ACCESO A DCC
           MOVE 'DCC'                      TO DCC-COD-TTAB IN DCC.
           MOVE CPP-COD-TCCT IN CPP(WSS-I) TO DCC-COD-TCCT IN DCC.
           MOVE CPP-COD-VCAM IN CPP        TO DCC-COD-VCAM IN DCC.
           MOVE CPP-COD-COPD IN CPP        TO DCC-COD-COPD IN DCC.
      *     MOVE OPD-COD-VCAM IN OPD        TO DCC-COD-VCAM IN DCC.
      *     MOVE OPD-COD-COPD IN OPD        TO DCC-COD-COPD IN DCC.
           MOVE OPD-COD-PLZO IN OPD        TO DCC-COD-PLZO IN DCC.
           MOVE CPP-COD-SCTB IN CPP        TO DCC-COD-SCTB IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-DCC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'DCC INEXISTENTE PARA : '
                       'TCCT=' CPP-COD-TCCT IN CPP(WSS-I)
                       '/VCAM=' OPD-COD-VCAM IN OPD
                       '/COPD=' OPD-COD-COPD IN OPD
                       '/PLZO=' OPD-COD-PLZO IN OPD
                       '/SCTB=' CPP-COD-SCTB IN CPP
              DISPLAY 'PARA OPD ' OPD-CIC-IOPD IN OPD
                        GO TO FIN-PRO-TRIO-CPP.

           IF WSS-COD-CMR IN WSS-VARI = 1
              PERFORM GEN-REG-SRT1
           ELSE
              PERFORM GEN-REG-SRT.
       FIN-PRO-TRIO-CPP.
           EXIT.

       GEN-REG-SRT SECTION.
       INI-GEN-REG-SRT.
           MOVE CPP-COD-TCCT IN CPP(WSS-I) TO CPP-COD-TCCT IN SRT.
           MOVE CPP-COD-DBHB IN CPP(WSS-I) TO CPP-COD-DBHB IN SRT.
           MOVE CPP-COD-TALG IN CPP(WSS-I) TO CPP-COD-TALG IN SRT.
      *    DAPRMSUB
           MOVE OPD-COD-VCAM IN OPD TO OPD-COD-VCAM IN SRT.

      *    Codigo oficina
           MOVE OPD-COD-OFIC IN OPD TO SRT-COD-OFIC IN SRT.

      *    Numero Cuenta Contable
           MOVE DCC-GLS-CCSB IN DCC TO SRT-CIC-CCTB IN SRT.

      *DAD ini  23-JUN-1992
      *    Numero de Vencimiento
      *     MOVE VEN-NUM-IVEN IN VEN TO SRT-NUM-IVEN IN SRT.
      *    Tasa del Periodo
           MOVE OPD-VAL-SINT IN OPD TO OPD-VAL-SINT IN SRT.
      *DAD fin  23-JUN-1992
      *JVM: 22/09/92
      *    Tasa de Interes
           MOVE OPD-SGV-TINT IN OPD TO OPD-SGV-TINT IN SRT.
      *JVM

           MOVE  0  TO WSS-IND-CALC IN WSS-VARI.
           MOVE  0  TO WSS-IND-MNRJ IN WSS-VARI.

           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM
           ELSE
               DISPLAY 'NO EXISTE MONEDA EN SISTEMA TAB '
                       TAB-COD-CTAB.

           IF WSS-CIC-TVAL = PDB-CIC-MNAC AND
              TAB-CIC-CTAB NOT = PDB-CIC-0999
              MOVE  1  TO WSS-IND-MNRJ IN WSS-VARI.

      *    Monto Debe/Haber
           MOVE ZEROES TO WSS-VAL-MONT IN WSS-VARI.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'A'
      *       Capital de la Operacion
              MOVE OPD-VAL-CAPT IN OPD TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-FPCO
                    GO TO NXT-GEN-REG-SRT
                 ELSE
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'B'
      *       Capital Liquidacion
              MOVE LIQ-SGV-CAPI IN LIQ TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-LRE
                    GO TO NXT-GEN-REG-SRT
                 ELSE
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'C'
      *       Intereses
              COMPUTE WSS-VAL-MONT IN WSS-VARI =
                  LIQ-SGV-TPAG IN LIQ - LIQ-SGV-CAPI IN LIQ
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-LAN
                    GO TO NXT-GEN-REG-SRT
                 ELSE
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'D'
      *       Reajustes
              MOVE LIQ-SGV-REAJ IN LIQ TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'E'
      *       Total Liquidado
              MOVE LIQ-SGV-TPAG IN LIQ TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-FCTB
                    GO TO NXT-GEN-REG-SRT
                 ELSE
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'F'
      *       Reajustes Vencimiento
              MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    MOVE 1 TO WSS-IND-CALC IN WSS-VARI
                    PERFORM OBT-VCAM-FVEN
                    PERFORM OBT-VCAM-FPCO
                    PERFORM OBT-VAL-REAJ
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'G'
      *       Intereses Vencimiento
              COMPUTE WSS-VAL-MONT IN WSS-VARI =
                   VEN-VAL-FINA IN VEN - VEN-VAL-CAPI IN VEN
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-FVEN
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'H'
      *       Aumento Capital en Renovacion
              MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-FPCO
                    GO TO NXT-GEN-REG-SRT.

           IF CPP-COD-TALG IN CPP(WSS-I) = 'O'
      *       Nuevo Capital de la Renovacion
              MOVE VEN-VAL-FINA IN VEN TO WSS-VAL-MONT IN WSS-VARI
              IF WSS-VAL-MONT IN WSS-VARI = ZEROS
                 GO TO FIN-GEN-REG-SRT
              ELSE
                 IF WSS-IND-MNRJ IN WSS-VARI = 1
                    PERFORM OBT-VCAM-FVEN
                    GO TO NXT-GEN-REG-SRT
                 ELSE
                    GO TO NXT-GEN-REG-SRT.
       NXT-GEN-REG-SRT.
      *    Fecha Movimiento
           MOVE WSS-FEC-FSRT IN WSS-VARI TO SRT-FEC-FMOV IN SRT.

      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      *        MULTIPLY WSS-VAL-MONT IN WSS-VARI BY 1
      *          GIVING WSS-VAL-DOLL IN WSS-VARI ROUNDED
      *        MOVE WSS-VAL-DOLL IN WSS-VARI TO
      *                                 WSS-VAL-MONT IN WSS-VARI.

           IF WSS-VAL-MONT IN WSS-VARI < ZEROS
              IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
                 MOVE 'H' TO CPP-COD-DBHB IN CPP(WSS-I)
              ELSE
                 IF CPP-COD-DBHB IN CPP(WSS-I) = 'H'
                    MOVE 'D' TO CPP-COD-DBHB IN CPP(WSS-I).

      *    Indicador Debe Haber
           IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
      *        DEBE
               MOVE 'D'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-MONT IN WSS-VARI TO SRT-VAL-DEBE IN SRT
               MOVE ZEROES                   TO SRT-VAL-HABE IN SRT
           ELSE
      *        HABER
               MOVE 'H'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-MONT IN WSS-VARI TO SRT-VAL-HABE IN SRT
               MOVE ZEROES                   TO SRT-VAL-DEBE IN SRT.

           MOVE '01' TO SRT-GLS-BLK2 IN SRT.
      *DAD ini  23-JUN-1992
           MOVE OPD-COD-VCAM IN SRT TO WSS-COD-VCAM IN WSS-VARI.
           IF WSS-COD-TVAL IN WSS-VARI = '0'
               ADD      SRT-VAL-DEBE IN SRT TO
                        WSS-VAL-LTN1-DEBE IN WSS-VARI
               ADD      SRT-VAL-HABE IN SRT TO
                        WSS-VAL-LTN1-HABE IN WSS-VARI
           ELSE
           IF WSS-COD-TVAL IN WSS-VARI = '1'
               ADD      SRT-VAL-DEBE IN SRT TO
                        WSS-VAL-LTX1-DEBE IN WSS-VARI
               ADD      SRT-VAL-HABE IN SRT TO
                        WSS-VAL-LTX1-HABE IN WSS-VARI.
      *     ADD WSS-VAL-MONT IN WSS-VARI TO WSS-VAL-LOT1 IN WSS-VARI.
      *DAD fin  23-JUN-1992
      *Graba registro Sort
           IF BUS-MEM-ISER = 'S'
               PERFORM MEM-ISER.
           MOVE OPD-CAI-IOPD IN OPD TO OPD-CAI-IOPD IN SRT.
           MOVE OPD-IIC-IOPD IN OPD TO OPD-IIC-IOPD IN SRT.
           MOVE OPD-CAI-ISER IN OPD TO OPD-CAI-ISER IN SRT.
           MOVE OPD-IIC-ISER IN OPD TO OPD-IIC-ISER IN SRT.
           MOVE OPD-IND-MCLI IN OPD TO OPD-IND-MCLI IN SRT.
           DISPLAY '+OPD-MCLI ' OPD-CIC-IOPD IN OPD ' '
                               OPD-IND-MCLI IN OPD ' '
                               OPD-IND-MCLI IN SRT.
           ADD 1 TO WSS-GRA-SRT IN WSS-VARI.

           RELEASE SRT.

      * RESTAURA NUMERO DE OPERACION '1711'
           IF BUS-MEM-ISER = 'S'
               MOVE WSS-CIC-IOPD TO OPD-CIC-IOPD IN OPD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DAP-FIO-OPD
      * ESTO ES INEFICIENTE, PERO DE ESTA FOMA RESTAURA LA OFICINA
      * CABECERA
               PERFORM BUS-OFI-CBC.
       FIN-GEN-REG-SRT.
           EXIT.

       GEN-REG-SRT1 SECTION.
       INI-GEN-REG-SRT1.
           MOVE 'CMR1'              TO OPD-CAI-IOPD IN SRT.
           MOVE ZEROES              TO OPD-IIC-IOPD IN SRT.
           MOVE SPACES              TO OPD-IIC-ISER IN SRT.
           MOVE SPACES              TO OPD-CAI-ISER IN SRT.
           MOVE PDB-CIC-0999        TO OPD-COD-VCAM IN SRT.

      *    Codigo oficina
           MOVE '090'               TO SRT-COD-OFIC IN SRT.

      *    Numero Cuenta Contable
           MOVE DCC-GLS-CCSB IN DCC TO SRT-CIC-CCTB IN SRT.

      *DAD ini  23-JUN-1992
      *    Numero de Vencimiento
      *     MOVE ZEROES              TO SRT-NUM-IVEN IN SRT.
      *    Tasa del Periodo
           MOVE ZEROES TO OPD-VAL-SINT IN SRT.
      *DAD fin  23-JUN-1992
      *JVM: 22/09/92
      *    Tasa de Interes
           MOVE ZEROES TO OPD-SGV-TINT IN SRT.
      *JVM

      *    Fecha Movimiento
           MOVE CRT-NUM-DCRT IN CRT TO WSS-NUM-DMOV IN WSS-VARI.
           MOVE CRT-NUM-MCRT IN CRT TO WSS-NUM-MMOV IN WSS-VARI.
           MOVE CRT-NUM-SCRT IN CRT TO WSS-NUM-SMOV IN WSS-VARI.
           MOVE CRT-NUM-ACRT IN CRT TO WSS-NUM-AMOV IN WSS-VARI.
           MOVE WSS-FEC-FMOV IN WSS-VARI TO SRT-FEC-FMOV IN SRT.

      *Acceso a CRT para recuperar fecha y saldo anterior (REVERSA)
      *     MOVE WSS-NUM-DREV IN WSS-VARI TO CRT-NUM-DCRT IN CRT.
      *     MOVE WSS-NUM-MREV IN WSS-VARI TO CRT-NUM-MCRT IN CRT.
      *     MOVE WSS-NUM-SREV IN WSS-VARI TO CRT-NUM-SCRT IN CRT.
      *     MOVE WSS-NUM-AREV IN WSS-VARI TO CRT-NUM-ACRT IN CRT.
      *     MOVE CRT-NUM-DCRT IN CRT TO WSS-NUM-DANT IN WSS-VARI.
      *     MOVE CRT-NUM-MCRT IN CRT TO WSS-NUM-MANT IN WSS-VARI.
      *     MOVE CRT-NUM-SCRT IN CRT TO WSS-NUM-SANT IN WSS-VARI.
      *     MOVE CRT-NUM-ACRT IN CRT TO WSS-NUM-AANT IN WSS-VARI.

      *Graba registro Sort Contabilizacion Reverso dia anterior CMR
      *    Indicador Debe Haber
           IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
      *        HABER
               MOVE 'H'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-SANT IN WSS-VARI TO SRT-VAL-HABE IN SRT
               MOVE ZEROES                   TO SRT-VAL-DEBE IN SRT
           ELSE
      *        DEBE
               MOVE 'D'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-SANT IN WSS-VARI TO SRT-VAL-DEBE IN SRT
               MOVE ZEROES                   TO SRT-VAL-HABE IN SRT.

           MOVE '02' TO SRT-GLS-BLK2 IN SRT.
      *DAD ini  23-JUN-1992
           MOVE OPD-COD-VCAM IN SRT TO WSS-COD-VCAM IN WSS-VARI.
      * PRUEBA JOFE
      *     DISPLAY 'REGISTRO NUMERO : ' WSS-GRA-SRT IN WSS-VARI.
      *     DISPLAY 'DEBE  DEL VARI  : ' WSS-VAL-LTN2-DEBE IN WSS-VARI.
      *     DISPLAY 'HABER DEL VARI  : ' WSS-VAL-LTN2-HABE IN WSS-VARI.
      *     DISPLAY 'ANTES DE GRABAR : ' SRT.
      *     DISPLAY 'REGISTRO VARI   : ' WSS-VARI.
      * FIN PRUEBA JOFE
           IF WSS-COD-TVAL IN WSS-VARI = '0'
               ADD SRT-VAL-DEBE IN SRT TO
                   WSS-VAL-LTN2-DEBE IN WSS-VARI
               ADD SRT-VAL-HABE IN SRT TO
                   WSS-VAL-LTN2-HABE IN WSS-VARI
           ELSE
           IF WSS-COD-TVAL IN WSS-VARI = '1'
               ADD      SRT-VAL-DEBE IN SRT TO
                        WSS-VAL-LTX2-DEBE IN WSS-VARI
               ADD      SRT-VAL-HABE IN SRT TO
                        WSS-VAL-LTX2-HABE IN WSS-VARI.
      *     ADD WSS-VAL-SANT IN WSS-VARI TO WSS-VAL-LOT2 IN WSS-VARI.
      *DAD fin  23-JUN-1992
      *     DISPLAY 'SRT1 ' SRT.
      *Graba registro Sort
           ADD 1 TO WSS-GRA-SRT IN WSS-VARI.
      * PRUEBA JOFE
      *     DISPLAY 'REGISTRO NUMERO   : ' WSS-GRA-SRT IN WSS-VARI.
      *     DISPLAY 'ANTES DE GRABAR   : ' SRT.
           RELEASE SRT.
      *     DISPLAY 'DESPUES DE GRABAR : ' SRT.
      * FIN PRUEBA JOFE

      *Graba registro Sort Contabilizacion Hoy CMR
           MOVE 'CMR2'              TO OPD-CAI-IOPD IN SRT.
      *    Indicador Debe Haber
           IF CPP-COD-DBHB IN CPP(WSS-I) = 'D'
      *        DEBE
               MOVE 'D'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-SACT IN WSS-VARI TO SRT-VAL-DEBE IN SRT
               MOVE ZEROES                   TO SRT-VAL-HABE IN SRT
           ELSE
      *        HABER
               MOVE 'H'                      TO SRT-IND-DBHB IN SRT
               MOVE WSS-VAL-SACT IN WSS-VARI TO SRT-VAL-HABE IN SRT
               MOVE ZEROES                   TO SRT-VAL-DEBE IN SRT.

           MOVE '02' TO SRT-GLS-BLK2 IN SRT.
      *DAD ini  23-JUN-1992
           MOVE OPD-COD-VCAM IN SRT TO WSS-COD-VCAM IN WSS-VARI.
           IF WSS-COD-TVAL IN WSS-VARI = '0'
               ADD      SRT-VAL-DEBE IN SRT TO
                        WSS-VAL-LTN2-DEBE IN WSS-VARI
               ADD      SRT-VAL-HABE IN SRT TO
                        WSS-VAL-LTN2-HABE IN WSS-VARI
           ELSE
           IF WSS-COD-TVAL IN WSS-VARI = '1'
               ADD      SRT-VAL-DEBE IN SRT TO
                        WSS-VAL-LTX2-DEBE IN WSS-VARI
               ADD      SRT-VAL-HABE IN SRT TO
                        WSS-VAL-LTX2-HABE IN WSS-VARI.
      *     ADD WSS-VAL-SACT IN WSS-VARI TO WSS-VAL-LOT2 IN WSS-VARI.
      *     DISPLAY 'SRT1 ' SRT.
      *Graba registro Sort
           ADD 1 TO WSS-GRA-SRT IN WSS-VARI.
           RELEASE SRT.
       FIN-GEN-REG-SRT1.
           EXIT.

      * Formacion y Generacion del Registro CT1 al Procesar Varios Regis
       GEN-REG-CT1 SECTION.
       INI-GEN-REG-CT1.
           MOVE ZEROS TO WSS-VAL-MONT IN WSS-VARI.
           IF WSS-VAL-THAB IN WSS-VARI > ZEROES
              MOVE 60 TO MC1-IND-DBHB IN MC1
              MOVE WSS-VAL-THAB IN WSS-VARI TO MC1-VAL-MONT IN MC1
                                          WSS-VAL-MONT IN WSS-VARI
              PERFORM GEN-REG-CTB1.

           IF WSS-VAL-TDEB IN WSS-VARI > ZEROES
              MOVE 10 TO MC1-IND-DBHB IN MC1
              MOVE WSS-VAL-TDEB IN WSS-VARI TO MC1-VAL-MONT IN MC1
                                          WSS-VAL-MONT IN WSS-VARI
              PERFORM GEN-REG-CTB1.
       FIN-GEN-REG-CT1.
           EXIT.

       GEN-REG-CTB1 SECTION.
       INI-GEN-REG-CTB1.
      * Obtencion de CIC para registro Contable CT1 / CT2
           MOVE 'C710'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                       CIC-CIC-ICIC IN CIC
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin

      *         GO TO FIN-GEN-REG-CT1.
           MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-ITEM IN WSS-VARI.

      * Formacion del Registro MC1
           MOVE 'PT'                     TO MC1-COD-IDAR IN MC1.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC1-NUM-ITEM IN MC1.
           MOVE 1                        TO MC1-COD-IDRE IN MC1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI
              MOVE 'BCIX' TO MC1-IND-MONE IN MC1
           ELSE
              MOVE 'BCI ' TO MC1-IND-MONE IN MC1.

           MOVE SRT-CIC-CCTB IN SRT TO MC1-NUM-CCTB IN MC1.
      *JVM 22/09/92
           MOVE '0'                 TO WSS-COD-OFI0 IN WSS-VARI.
           MOVE SRT-COD-OFIC IN SRT TO WSS-COD-OFI1 IN WSS-VARI.
           MOVE SPACES              TO WSS-GLS-RES1 IN WSS-VARI.
           MOVE WSS-COD-CCO1 IN WSS-VARI TO MC1-COD-CCOS IN MC1.
      *JVM
           MOVE 'DPZ' TO MC1-COD-SIST IN MC1.

           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO MC1-NUM-DMOV IN MC1.
           MOVE WSS-NUM-MREG IN WSS-VARI TO MC1-NUM-MMOV IN MC1.
           MOVE WSS-NUM-AREG IN WSS-VARI TO MC1-NUM-AMOV IN MC1.

           MOVE MC1    TO WSS-GLS-MC11 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL1 IN WSS-VARI.
           MOVE WSS-GLS-MC1 TO CT1.

      * Genera el Registro del Archivo CT1(MC1).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC1
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.

      * Formacion del Registro MC2
           MOVE 'PT' TO MC2-COD-IDAR IN MC2.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC2-NUM-ITEM IN MC2.
           MOVE 2    TO MC2-COD-IDRE IN MC2.

      *JVM 22/09/92
           MOVE SPACES TO MC2-CIC-IOPD IN MC2.
           MOVE SPACES TO MC2-CIC-ISER IN MC2.
           MOVE SPACES TO MC2-COD-VCAM IN MC2.
           MOVE SPACES TO MC2-COD-COPD IN MC2.
           MOVE SPACES TO MC2-COD-PROY IN MC2.
           MOVE OPD-SGV-TINT IN SRT TO MC2-SGV-TINT IN MC2.
           MOVE SPACES TO MC2-GLS-DISP IN MC2.
      *JVM
      *JVM 28/05/93
           MOVE SPACES TO WSS-GLS-CTBL IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST
           MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
           MOVE SRT-CIC-CCTB IN SRT TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CCTA IN WSS-VARI
           MOVE '/'                 TO WSS-GLS-BLAN IN WSS-VARI
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-ACTB IN WSS-VARI.
           MOVE SPACES                   TO WSS-GLS-REST IN WSS-VARI.
           MOVE WSS-GLS-CTBL IN WSS-VARI TO MC2-GLS-DESC IN MC2.
      *JVM
           MOVE MC2    TO WSS-GLS-MC21 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL2 IN WSS-VARI.
           MOVE WSS-GLS-MC2 TO CT1.

      * Genera el Registro del Archivo CT1(MC2).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC2
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.

      * Formacion del Registro MC3
           MOVE 'PT' TO MC3-COD-IDAR IN MC3.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC3-NUM-ITEM IN MC3.
           MOVE 3    TO MC3-COD-IDRE IN MC3.

      *     MOVE WSS-VAL-MONT IN WSS-VARI TO MC3-VAL-MEST IN MC3.
           MOVE ZEROES TO MC3-VAL-MEST IN MC3.

           MOVE ZEROES TO MC3-COD-MONE IN MC3.
           MOVE ZEROES TO MC3-VAL-MCON IN MC3.
           MOVE ZEROES TO MC3-VAL-VCAM IN MC3.
           MOVE MC3    TO WSS-GLS-MC31 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL3 IN WSS-VARI.
           MOVE WSS-GLS-MC3 TO CT1.

      * Genera el Registro del Archivo CT1(MC3).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC3
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT1 IN WSS-VARI.
       FIN-GEN-REG-CTB1.
           EXIT.

      * Formacion y Generacion del Registro CT2 al Procesar Varios Regis
       GEN-REG-CT2 SECTION.
       INI-GEN-REG-CT2.
           MOVE ZEROS TO WSS-VAL-MONT IN WSS-VARI.
           IF WSS-VAL-THAB IN WSS-VARI > ZEROES
              MOVE 60 TO MC1-IND-DBHB IN MC1
              MOVE WSS-VAL-THAB IN WSS-VARI TO MC1-VAL-MONT IN MC1
                                          WSS-VAL-MONT IN WSS-VARI
              PERFORM GEN-REG-CTB2.

           IF WSS-VAL-TDEB IN WSS-VARI > ZEROES
              MOVE 10 TO MC1-IND-DBHB IN MC1
              MOVE WSS-VAL-TDEB IN WSS-VARI TO MC1-VAL-MONT IN MC1
                                          WSS-VAL-MONT IN WSS-VARI
              PERFORM GEN-REG-CTB2.
       FIN-GEN-REG-CT2.
           EXIT.

       GEN-REG-CTB2 SECTION.
       INI-GEN-REG-CTB2.
      * Formacion del Registro MC1
           MOVE 'C710'  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                       CIC-CIC-ICIC IN CIC
      *JVM ini  11-AGO-1992
              MOVE PGM-SMAL TO PGM-STAT-SRT
              GO TO EXT-OUT-SRT.
      *JVM fin
      *         GO TO FIN-GEN-REG-CT2.
           MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-ITEM IN WSS-VARI.

      * Formacion del Registro MC1
           MOVE 'PT'                     TO MC1-COD-IDAR IN MC1.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC1-NUM-ITEM IN MC1.
           MOVE 1                        TO MC1-COD-IDRE IN MC1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI
              MOVE 'BCIX' TO MC1-IND-MONE IN MC1
           ELSE
              MOVE 'BCI ' TO MC1-IND-MONE IN MC1.

           MOVE SRT-CIC-CCTB IN SRT TO MC1-NUM-CCTB IN MC1.
      *JVM 22/09/92
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-EXT-CTAB IN TAB TO WSS-COD-MONE IN WSS-VARI.
           MOVE '000'               TO WSS-GLS-RES2 IN WSS-VARI.
           MOVE SRT-COD-OFIC IN SRT TO WSS-COD-OFI2 IN WSS-VARI
                                       WSS-COD-OFI3 IN WSS-VARI
                                       OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           IF MSG-COD-MENS  NOT > SPACES
              MOVE OFI-COD-OFCO IN OFI TO WSS-COD-OFI2 IN WSS-VARI.

           MOVE WSS-COD-CCO2 IN WSS-VARI TO MC1-COD-CCOS IN MC1.
      *JVM
           MOVE 'DPZ' TO MC1-COD-SIST IN MC1.

           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO MC1-NUM-DMOV IN MC1.
           MOVE WSS-NUM-MREG IN WSS-VARI TO MC1-NUM-MMOV IN MC1.
           MOVE WSS-NUM-AREG IN WSS-VARI TO MC1-NUM-AMOV IN MC1.

           MOVE MC1    TO WSS-GLS-MC11 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL1 IN WSS-VARI.
           MOVE WSS-GLS-MC1 TO CT2.

      * Genera el Registro del Archivo CT2(MC1).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT2: ' MC1
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.

      * Formacion del Registro MC2
           MOVE 'PT' TO MC2-COD-IDAR IN MC2.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC2-NUM-ITEM IN MC2.
           MOVE 2    TO MC2-COD-IDRE IN MC2.

      *JVM 22/09/92
           MOVE SPACES TO MC2-CIC-IOPD IN MC2.
           MOVE SPACES TO MC2-CIC-ISER IN MC2.
           MOVE SPACES TO MC2-COD-VCAM IN MC2.
           MOVE SPACES TO MC2-COD-COPD IN MC2.
           MOVE SPACES TO MC2-COD-PROY IN MC2.
           MOVE OPD-SGV-TINT IN SRT TO MC2-SGV-TINT IN MC2.
           MOVE SPACES TO MC2-GLS-DISP IN MC2.
      *JVM
      *JVM 28/05/93
           MOVE SPACES TO WSS-GLS-CTBL IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST
           MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
           MOVE SRT-CIC-CCTB IN SRT TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CCTA IN WSS-VARI
           MOVE '/'                 TO WSS-GLS-BLAN IN WSS-VARI
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-ACTB IN WSS-VARI.
           MOVE SPACES                   TO WSS-GLS-REST IN WSS-VARI.
           MOVE WSS-GLS-CTBL IN WSS-VARI TO MC2-GLS-DESC IN MC2.
      *JVM
           MOVE MC2    TO WSS-GLS-MC21 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL2 IN WSS-VARI.
           MOVE WSS-GLS-MC2 TO CT2.

      * Genera el Registro del Archivo CT1(MC2).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC2
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.

      * Formacion del Registro MC3
           MOVE 'PT' TO MC3-COD-IDAR IN MC3.
           MOVE WSS-IND-ITEM IN WSS-VARI TO MC3-NUM-ITEM IN MC3.
           MOVE 3    TO MC3-COD-IDRE IN MC3.

      *     MOVE WSS-VAL-MONT IN WSS-VARI TO MC3-VAL-MEST IN MC3.
           MOVE ZEROES TO MC3-VAL-MEST IN MC3.

           MOVE ZEROES TO MC3-COD-MONE IN MC3.
           MOVE ZEROES TO MC3-VAL-MCON IN MC3.
           MOVE ZEROES TO MC3-VAL-VCAM IN MC3.
           MOVE MC3    TO WSS-GLS-MC31 IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-FIL3 IN WSS-VARI.
           MOVE WSS-GLS-MC3 TO CT2.

      * Genera el Registro del Archivo CT2(MC3).
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL GENERAR CT1: ' MC3
                       ' FS: ' FIO-STAT
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM fin
           ADD 1 TO WSS-GRA-CT2 IN WSS-VARI.
       FIN-GEN-REG-CTB2.
           EXIT.
      * JVM
      ******************************************************************

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE 0  TO WSS-STAT-RCC IN WSS-VARI.
           MOVE OPD-CAI-IOPD IN SRT TO RCC-CAI-IOPD IN RCC.
           MOVE OPD-IIC-IOPD IN SRT TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-RCC IN WSS-VARI.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           DISPLAY ' EN GET-NXT-RCC ' OPD-CAI-IOPD IN SRT ' '
                                      OPD-IIC-IOPD IN SRT.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           DISPLAY 'GET-NXT-RCC ' FIO-STAT
                                    RCC-CAI-IOPD IN RCC ' '
                                    RCC-IIC-IOPD IN RCC.
           IF FIO-STAT-OKS AND
              OPD-CAI-IOPD IN SRT = RCC-CAI-IOPD IN RCC AND
              OPD-IIC-IOPD IN SRT = RCC-IIC-IOPD IN RCC
              PERFORM GET-RCC-DBC
              GENERATE DL-MUL.
       FIN-GET-NXT-RCC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RCC-DBC SECTION.
       INI-GET-RCC-DBC.
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
                     MOVE '-' TO WSS-GLS-RAYA IN WSS-SUB
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
              IF DBC-GLS-ICLI IN DBC NOT > SPACES
                 MOVE SPACES TO WSS-GLS-AUXI IN WSS-SUB
              ELSE
                 MOVE '-' TO WSS-GLS-AUXI IN WSS-SUB.
       FIN-GET-RCC-DBC.
           EXIT.

      * Limpia datos cliente
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE SPACES TO WSS-GLS-AUXI IN WSS-SUB
           MOVE SPACES TO WSS-GLS-RAYA IN WSS-SUB
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro
       BUS-GLS-CMR SECTION.
       INI-BUS-GLS-CMR.
           MOVE SPACES TO OPD-IIC-IOPD IN SRT.
           MOVE SPACES TO WSS-GLS-AUXI IN WSS-SUB.
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO WSS-GLS-RAYA IN WSS-SUB.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           IF OPD-CAI-IOPD IN SRT = 'CMR1'
              MOVE SPACES TO OPD-CAI-IOPD IN SRT
              MOVE 'REVERSO DIA ANTERIOR '
                                         TO WSS-GLS-NOM1 IN WSS-VARI
              MOVE WSS-NUM-DANT IN WSS-VARI
                                         TO WSS-NUM-DNO1 IN WSS-VARI
              MOVE WSS-NUM-MANT IN WSS-VARI
                                         TO WSS-NUM-MNO1 IN WSS-VARI
              MOVE WSS-NUM-SANT IN WSS-VARI
                                         TO WSS-NUM-SNO1 IN WSS-VARI
              MOVE WSS-NUM-AANT IN WSS-VARI
                                         TO WSS-NUM-ANO1 IN WSS-VARI
              MOVE '/' TO WSS-GLS-SLA1 IN WSS-VARI
                          WSS-GLS-SLA2 IN WSS-VARI
              MOVE WSS-GLS-NOMB IN WSS-VARI TO DBC-GLS-NOMC IN DBC.

           IF OPD-CAI-IOPD IN SRT = 'CMR2'
              MOVE SPACES TO OPD-CAI-IOPD IN SRT
              MOVE 'CONTABILIZACION DEL DIA '
                                         TO WSS-GLS-NOM1 IN WSS-VARI
              MOVE WSS-NUM-DACT IN WSS-VARI
                                         TO WSS-NUM-DNO1 IN WSS-VARI
              MOVE WSS-NUM-MACT IN WSS-VARI
                                         TO WSS-NUM-MNO1 IN WSS-VARI
              MOVE WSS-NUM-SACT IN WSS-VARI
                                         TO WSS-NUM-SNO1 IN WSS-VARI
              MOVE WSS-NUM-AACT IN WSS-VARI
                                         TO WSS-NUM-ANO1 IN WSS-VARI
              MOVE '/' TO WSS-GLS-SLA1 IN WSS-VARI
                          WSS-GLS-SLA2 IN WSS-VARI
              MOVE WSS-GLS-NOMB IN WSS-VARI TO DBC-GLS-NOMC IN DBC.
       FIN-BUS-GLS-CMR.
           EXIT.

       OBT-VCAM-LRE SECTION.
       INI-OBT-VCAM-LRE.
           IF CPP-COD-MVTO IN CPP = 'LRE'
                PERFORM OBT-VCAM-FCTB
           ELSE
                PERFORM OBT-VCAM-FPCO.
       FIN-OBT-VCAM-LRE.
           EXIT.

       OBT-VCAM-LAN SECTION.
       INI-OBT-VCAM-LAN.
           IF CPP-COD-MVTO IN CPP = 'LAN'
                PERFORM OBT-VCAM-FPCO
           ELSE
                PERFORM OBT-VCAM-FCTB.
       FIN-OBT-VCAM-LAN.
           EXIT.

       OBT-VCAM-FPCO SECTION.
       INI-OBT-VCAM-FPCO.
           MOVE ZEROS TO WSS-SGV-FOUF IN WSS-VARI
                         WSS-SGV-FORD IN WSS-VARI
                         WSS-SGV-FODO IN WSS-VARI.
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
      * Obtiene Valor de Cambio de la UF a Fecha de Captacion.
              MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(1)
              MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          OPD-FEC-FREA IN OPD ' PARA LA UF.'
                 GO TO FIN-OBT-VCAM-FPCO
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FOUF IN WSS-VARI
           ELSE
           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
      * Obtiene Valor de Cambio de la US$REAJ a Fecha de Captacion.
              MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(1)
              MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          OPD-FEC-FREA IN OPD ' PARA US$REAJ '
                 GO TO FIN-OBT-VCAM-FPCO
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FORD IN WSS-VARI.
      *     ELSE
      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      * Obtiene Valor de Cambio de US$ a Fecha de Captacion Original.
      *        MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(1)
      *        MOVE OPD-FEC-FREA IN OPD      TO CAM-FEC-FCAM IN CAM(2)
      *        MOVE WSS-COD-DOLL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
      *        MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM TAB-FIO-CAM
      *        IF NOT FIO-STAT-OKS
      *           DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
      *                    OPD-FEC-FREA IN OPD ' PARA US$ '
      *           GO TO FIN-OBT-VCAM-FPCO
      *        ELSE
      *           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FODO IN WSS-VARI.

           IF WSS-IND-CALC IN WSS-VARI = 1
              GO TO FIN-OBT-VCAM-FPCO.

      * Calcula Capital para Moneda Reajustable
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FOUF IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FORD IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      *        MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
      *                 WSS-SGV-FODO IN WSS-VARI GIVING
      *                 WSS-VAL-MONT IN WSS-VARI ROUNDED.

      * Redondea Capital , Reajustes e Intereses
           MOVE WSS-VAL-MONT IN WSS-VARI TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-MONT IN WSS-VARI.
       FIN-OBT-VCAM-FPCO.
           EXIT.

       OBT-VCAM-FVEN SECTION.
       INI-OBT-VCAM-FVEN.
           MOVE ZEROS TO WSS-SGV-FVUF IN WSS-VARI
                         WSS-SGV-FVRD IN WSS-VARI
                         WSS-SGV-FVDO IN WSS-VARI.
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
      * Obtiene Valor de Cambio de la UF a Fecha de Captacion.
              MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
              MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          VEN-FEC-FVEN IN VEN ' PARA LA UF.'
                 GO TO FIN-OBT-VCAM-FVEN
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVUF IN WSS-VARI
           ELSE
           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
      * Obtiene Valor de Cambio de la US$REAJ a Fecha de Captacion.
              MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
              MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          VEN-FEC-FVEN IN VEN ' PARA US$REAJ '
                 GO TO FIN-OBT-VCAM-FVEN
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVRD IN WSS-VARI.
      *     ELSE
      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      * Obtiene Valor de Cambio de US$ a Fecha de Captacion Original.
      *        MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
      *        MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(2)
      *        MOVE WSS-COD-DOLL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
      *        MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM TAB-FIO-CAM
      *        IF NOT FIO-STAT-OKS
      *           DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
      *                    VEN-FEC-FVEN IN VEN ' PARA US$ '
      *           GO TO FIN-OBT-VCAM-FVEN
      *        ELSE
      *           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVDO IN WSS-VARI.

           IF WSS-IND-CALC IN WSS-VARI = 1
              GO TO FIN-OBT-VCAM-FVEN.

      * Calcula Capital para Moneda Reajustable
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FVUF IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FVRD IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      *        MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
      *                 WSS-SGV-FVDO IN WSS-VARI GIVING
      *                 WSS-VAL-MONT IN WSS-VARI ROUNDED.

      * Redondea Capital , Reajustes e Intereses
           MOVE WSS-VAL-MONT IN WSS-VARI TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-MONT IN WSS-VARI.
       FIN-OBT-VCAM-FVEN.
           EXIT.

       OBT-VCAM-FCTB SECTION.
       INI-OBT-VCAM-FCTB.
           MOVE ZEROS TO WSS-SGV-FCUF IN WSS-VARI
                         WSS-SGV-FCRD IN WSS-VARI
                         WSS-SGV-FCDO IN WSS-VARI.
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
      * Obtiene Valor de Cambio de la UF a Fecha de Captacion.
              MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(1)
              MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          LIQ-FEC-FCTB IN LIQ ' PARA LA UF.'
                 GO TO FIN-OBT-VCAM-FCTB
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCUF IN WSS-VARI
           ELSE
           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
      * Obtiene Valor de Cambio de la US$REAJ a Fecha de Captacion.
              MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(1)
              MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(2)
              MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
              MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM TAB-FIO-CAM
              IF NOT FIO-STAT-OKS
                 DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                          LIQ-FEC-FCTB IN LIQ ' PARA US$REAJ '
                 GO TO FIN-OBT-VCAM-FCTB
              ELSE
                 MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCRD IN WSS-VARI.
      *     ELSE
      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      * Obtiene Valor de Cambio de US$ a Fecha de Captacion Original.
      *        MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(1)
      *        MOVE LIQ-FEC-FCTB IN LIQ      TO CAM-FEC-FCAM IN CAM(2)
      *        MOVE WSS-COD-DOLL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
      *        MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM TAB-FIO-CAM
      *        IF NOT FIO-STAT-OKS
      *           DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
      *                    LIQ-FEC-FCTB IN LIQ ' PARA US$ '
      *           GO TO FIN-OBT-VCAM-FCTB
      *        ELSE
      *           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCDO IN WSS-VARI.

      * Calcula Capital para Moneda Reajustable
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FCUF IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
              MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
                       WSS-SGV-FCRD IN WSS-VARI GIVING
                       WSS-VAL-MONT IN WSS-VARI ROUNDED.

      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      *        MULTIPLY WSS-VAL-MONT IN WSS-VARI BY
      *                 WSS-SGV-FCDO IN WSS-VARI GIVING
      *                 WSS-VAL-MONT IN WSS-VARI ROUNDED.

      * Redondea Capital , Reajustes e Intereses
           MOVE WSS-VAL-MONT IN WSS-VARI TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-MONT IN WSS-VARI.
       FIN-OBT-VCAM-FCTB.
           EXIT.

       OBT-VAL-REAJ SECTION.
       INI-OBT-VAL-REAJ.
      * Calcula Valor Reajuste para Vencimiento Renovable
           IF OPD-COD-VCAM IN OPD = WSS-COD-UEFE IN WSS-VARI
              COMPUTE WSS-VAL-REAJ IN WSS-VARI ROUNDED =
              (WSS-SGV-FVUF IN WSS-VARI - WSS-SGV-FOUF IN WSS-VARI)
                * WSS-VAL-MONT IN WSS-VARI.

           IF OPD-COD-VCAM IN OPD = WSS-COD-RDOL IN WSS-VARI
              COMPUTE WSS-VAL-REAJ IN WSS-VARI ROUNDED =
               (WSS-SGV-FVRD IN WSS-VARI - WSS-SGV-FORD IN WSS-VARI)
                * WSS-VAL-MONT IN WSS-VARI.

      *     IF OPD-COD-VCAM IN OPD = WSS-COD-DOLL IN WSS-VARI
      *        COMPUTE WSS-VAL-REAJ IN WSS-VARI ROUNDED =
      *         (WSS-SGV-FVDO IN WSS-VARI - WSS-SGV-FODO IN WSS-VARI)
      *          * WSS-VAL-MONT IN WSS-VARI.

           MOVE WSS-VAL-REAJ IN WSS-VARI TO WSS-VAL-MONT IN WSS-VARI.
      * Redondea Reajustes
           MOVE WSS-VAL-MONT IN WSS-VARI TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-MONT IN WSS-VARI.
       FIN-OBT-VAL-REAJ.
           EXIT.
      ******************************************************************
      *DAD ini  23-JUN-1992
      * Lee Archivos de Saldos para Obtener Saldos de Ctas Contable x Of
       PRO-LEE-CTA SECTION.
       INI-PRO-LEE-CTA.
           MOVE ZEROES TO WSS-VAL-ADEB IN WSS-SUB.
           MOVE ZEROES TO WSS-VAL-AHAB IN WSS-SUB.

           IF WSS-IND-TRPT NOT = 'LSUB'
               MOVE 0 TO FIO-STAT
               GO TO FIN-PRO-LEE-CTA.

           MOVE OPD-COD-VCAM IN SRT TO WSS-COD-VCAM IN WSS-VARI.
           IF WSS-COD-TVAL IN WSS-VARI = '0'
               GO TO INI-PRO-LEE-CTA-SNAC
           ELSE
           IF WSS-COD-TVAL IN WSS-VARI = '1'
               GO TO INI-PRO-LEE-CTA-SEXT.

       INI-PRO-LEE-CTA-SNAC.
      * Lee CMX para Obtener Saldos de Moneda Nacional
           MOVE '00'                TO CTA-COD-MONE IN CTA.
           MOVE SRT-COD-OFIC IN SRT TO CTA-COD-OFIC IN CTA.
           MOVE SRT-CIC-CCTB IN SRT TO CTA-NUM-CCTB IN CTA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CTA.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY 'ERROR: CTA NO ENCONTRADA : ' CTA-KEY-IREG
                       ' STAT : ' FIO-STAT
               MOVE ZEROES TO CTA-VAL-DBQU IN CTA
               MOVE ZEROES TO CTA-VAL-HBQU IN CTA.

      * Saldo arrastre del Debe
           MOVE CTA-VAL-DBQU IN CTA TO WSS-VAL-ADEB IN WSS-SUB.
      * Saldo arrastre del Haber
           MOVE CTA-VAL-HBQU IN CTA TO WSS-VAL-AHAB IN WSS-SUB.
           GO TO FIN-PRO-LEE-CTA.

       INI-PRO-LEE-CTA-SEXT.
      * Lee CMX para Obtener Saldos de Moneda Extranjera
           MOVE 'BCIX'              TO CMX-COD-MONE IN CMX.
           MOVE SRT-CIC-CCTB IN SRT TO CMX-COD-CCTB IN CMX.
           MOVE SPACES              TO CMX-GLS-FIL1 IN CMX.
           MOVE '013'               TO CMX-COD-MONS IN CMX.
           MOVE SRT-COD-OFIC IN SRT TO CMX-COD-OFIC IN CMX.
           MOVE SPACES              TO CMX-COD-ANAL IN CMX.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-CMX.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY 'ERROR: AL ACCESAR CMX : ' CMX-KEY-IREG
                       ' STAT : ' FIO-STAT
               MOVE ZEROES TO CMX-VAL-DBEJ IN CMX
               MOVE ZEROES TO CMX-VAL-HBEJ IN CMX.

      * Saldo arrastre del Debe
           MOVE CMX-VAL-DBEJ IN CMX TO WSS-VAL-ADEB IN WSS-SUB.
      * Saldo arrastre del Haber
           MOVE CMX-VAL-HBEJ IN CMX TO WSS-VAL-AHAB IN WSS-SUB.
       FIN-PRO-LEE-CTA.
           EXIT.
      *DAD fin  23-JUN-1992
      ******************************************************************
      *DAD ini  23-JUN-1992
       GEN-HDR-CT1 SECTION.
       INI-GEN-HDR-CT1.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF NOT = 'S'
               GO TO FIN-GEN-HDR-CT1.

           MOVE 'BCI ' TO MCH-COD-IBCO IN MCH.
      *JVM 22/09/92
           MOVE MCH TO CT1.
      *JVM
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT1.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'FS-MCH ' FIO-STAT
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'MCT    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO HEADER CT1 : ' MCH
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM
       FIN-GEN-HDR-CT1.
           EXIT.

       GEN-HDR-CT2 SECTION.
       INI-GEN-HDR-CT2.

      * PROCESA INTERFAZ SEGUN PARAMETRO
      * ================================

           IF WSS-IND-GITF NOT = 'S'
               GO TO FIN-GEN-HDR-CT2.

           MOVE 'BCIX' TO MCH-COD-IBCO IN MCH.
      *JVM 22/09/92
           MOVE MCH TO CT2.
      *JVM
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-CT2.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY 'FS-MCH ' FIO-STAT
               MOVE 'DAP'          TO MSG-COD-SIST
               MOVE 'MCT    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO HEADER CT2 : ' MCH
      *JVM ini  11-AGO-1992
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO EXT-OUT-SRT.
      *JVM
       FIN-GEN-HDR-CT2.
           EXIT.
      *DAD fin  23-JUN-1992
      ******************************************************************
      *DAD ini  23-JUN-1992       ESTA SECTION NO SE UTILIZA   SE BORRA
       ACC-FPRO SECTION.
       INI-ACC-FPRO.

      *VAL-FEC Valida Fecha de proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' VALIDACION EN FECHA DE PROCESO '
                    WSS-FEC-FPRO ' ' FEC-MENS
               PERFORM GNS-PRO-ABT
           ELSE
               MOVE WSS-NUM-DPRO TO WSS-NUM-DTRA
               MOVE WSS-NUM-MPRO TO WSS-NUM-MTRA
               MOVE WSS-NUM-SPRO TO WSS-NUM-STRA
               MOVE WSS-NUM-APRO TO WSS-NUM-ATRA
      * ISP: OBTIENE FECHA DE AYER ( YA ESTA CARGADO FEC-FECH )
               MOVE FEC-RST-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               MOVE FEC-FORM-FEC TO FEC-FORM
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' EN OBTENCION FECHA AYER '
                            FEC-FECH ' ' FEC-MENS
                  PERFORM GNS-PRO-ABT
               ELSE
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-FBLK-N  TO FEC-FBLK
                   MOVE FEC-CHOY-N  TO FEC-CHOY
                   MOVE FEC-VHBL-S  TO FEC-VHBL
                   MOVE FEC-VAL-FEC TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-HBL
                      MOVE WSS-NUM-DPRO TO WSS-NUM-DFIN IN WSS-VARI
                      MOVE WSS-NUM-DPRO TO WSS-NUM-DINI IN WSS-VARI
                      MOVE WSS-NUM-MPRO TO WSS-NUM-MFIN IN WSS-VARI
                      MOVE WSS-NUM-MPRO TO WSS-NUM-MINI IN WSS-VARI
                      MOVE WSS-NUM-SPRO TO WSS-NUM-SFIN IN WSS-VARI
                      MOVE WSS-NUM-SPRO TO WSS-NUM-SINI IN WSS-VARI
                      MOVE WSS-NUM-APRO TO WSS-NUM-AFIN IN WSS-VARI
                      MOVE WSS-NUM-APRO TO WSS-NUM-AINI IN WSS-VARI
                      GO TO FIN-CIC-ACC-FPRO.
       CIC-ACC-FPRO.
      * ISP: YA ESTA CARGADO FEC-FECH
                    MOVE FEC-FORM-FEC TO FEC-FORM
                    MOVE FEC-FBLK-N  TO FEC-FBLK
                    MOVE FEC-CHOY-N  TO FEC-CHOY
                    MOVE FEC-VHBL-S  TO FEC-VHBL
                    MOVE FEC-VAL-FEC TO FEC-CMND
                    PERFORM PRO-FEC
                    IF NOT FEC-STAT-HBL
                        MOVE FEC-RST-DIA  TO FEC-CMND
                        MOVE 1            TO FEC-NDIA
                        MOVE FEC-FORM-FEC TO FEC-FORM
                        PERFORM CAL-FEC
                        IF NOT FEC-STAT-OKS
                           DISPLAY ' '
                           DISPLAY ' PROCESO CANCELADO '
                           DISPLAY ' EN OBTENCION FECHA AYER '
                                     FEC-FECH ' ' FEC-MENS
                           PERFORM GNS-PRO-ABT
                        ELSE
                           GO TO CIC-ACC-FPRO
                    ELSE
                        MOVE FEC-SUM-DIA  TO FEC-CMND
                        MOVE 1            TO FEC-NDIA
                        MOVE FEC-FORM-FEC TO FEC-FORM
                        PERFORM CAL-FEC
                        IF FEC-STAT-OKS
                           MOVE FEC-ITM1 TO WSS-NUM-DINI IN WSS-VARI
                           MOVE FEC-ITM2 TO WSS-NUM-MINI IN WSS-VARI
                           MOVE FEC-ITM3 TO WSS-NUM-SINI IN WSS-VARI
                           MOVE FEC-ITM4 TO WSS-NUM-AINI IN WSS-VARI
                        ELSE
                           DISPLAY ' '
                           DISPLAY ' PROCESO CANCELADO '
                           DISPLAY ' EN OBTENCION FECHA AYER '
                                     FEC-FECH ' ' FEC-MENS
                           PERFORM GNS-PRO-ABT.

       FIN-CIC-ACC-FPRO.
       FIN-ACC-FPRO.
           EXIT.
      *DAD fin  23-JUN-1992
      ******************************************************************

      *Entidades de GNS
       COPY GNSBFCIC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGCIC.
       COPY GNSBGPES.
       COPY GNSBFMSC.
      *Entidades de TAB
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFCAM.
       COPY TABBBOFI.
       COPY TABBVOFI.
      *Entidades de DAP
       COPY DAPBFRCC.
       COPY DAPBFLIQ.
       COPY DAPBFVEN.
       COPY DAPBFCPP.
       COPY DAPBFDCC.
       COPY DAPBFCRT.
      *DAD ini  23-JUN-1992
       COPY DAPBSCT1.
       COPY DAPBSCT2.
      *DAD fin  23-JUN-1992
       COPY DAPBFCTA.
       COPY DAPBFCMX.
      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>
