      *
      * DAPBQD04
      * Version 3.0.1 Nov-2005
      * 17-Sep-08 03:20 PM
      *
       SET-TAG-DAPBQD04 SECTION.
       INI-SET-TAG-DAPBQD04.
           MOVE
           '<IDNMOD NOM=$DAPBQD04$ VSN=$08.09.17$ VGM=$3.0.1$
      -    'GEN=$17-Sep-08 03:20 PM$ FNC=$080311$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBQD04.
           EXIT.
           
       PUT-ALL-D04 SECTION.
       INI-PUT-ALL-D04.
           PERFORM PUT-D04-D04.
           PERFORM PUT-COD-D04.
       FIN-PUT-ALL-D04.
           EXIT.
       
       PUT-D04-D04 SECTION.
       INI-PUT-D04-D04.
           IF PGM-STAT-D04-NUL
               GO TO FIN-PUT-D04-D04.
           IF NOT PGM-STAT-D04-OKS
               PERFORM CLR-D04-D04
               GO TO FIN-PUT-D04-D04.
           MOVE D04-NUM-TCAP IN D04 TO D04-NUM-TCAP IN D04-FLD.
           MOVE D04-NUM-MCAP IN D04 TO D04-NUM-MCAP IN D04-FLD.
           MOVE D04-COD-RCLI IN D04 TO D04-COD-RCLI IN D04-FLD.
           MOVE D04-COD-VCLI IN D04 TO D04-COD-VCLI IN D04-FLD.
           MOVE D04-GLS-NOMC IN D04 TO D04-GLS-NOMC IN D04-FLD.
           MOVE D04-COD-OPER IN D04 TO D04-COD-OPER IN D04-FLD.
           MOVE D04-COD-LOCA IN D04 TO D04-COD-LOCA IN D04-FLD.
           MOVE D04-VAL-CAPT IN D04 TO D04-VAL-CAPT IN D04-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE D04-NUM-DREA IN D04 TO D04-NUM-DREA IN D04-FLD.
           MOVE D04-NUM-MREA IN D04 TO D04-NUM-MREA IN D04-FLD.
           MOVE D04-NUM-SREA IN D04 TO D04-NUM-SREA IN D04-FLD.
           MOVE D04-NUM-AREA IN D04 TO D04-NUM-AREA IN D04-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE D04-NUM-DOPE IN D04 TO D04-NUM-DOPE IN D04-FLD.
           MOVE D04-NUM-MOPE IN D04 TO D04-NUM-MOPE IN D04-FLD.
           MOVE D04-NUM-SOPE IN D04 TO D04-NUM-SOPE IN D04-FLD.
           MOVE D04-NUM-AOPE IN D04 TO D04-NUM-AOPE IN D04-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE D04-VAL-SALD IN D04 TO D04-VAL-SALD IN D04-FLD.
           MOVE D04-SGV-TASA IN D04 TO D04-SGV-TASA IN D04-FLD.
           MOVE D04-VAL-INTE IN D04 TO D04-VAL-INTE IN D04-FLD.
           MOVE D04-VAL-REAJ IN D04 TO D04-VAL-REAJ IN D04-FLD.
           MOVE D04-GLS-DISP IN D04 TO D04-GLS-DISP IN D04-FLD.
      *<<<< FIN_PUT_D04_D04
      *>>>> FIN_PUT_D04_D04
       FIN-PUT-D04-D04.
           EXIT.
       
       PUT-COD-D04 SECTION.
       INI-PUT-COD-D04.
           IF PGM-STAT-COD-NUL
               GO TO FIN-PUT-COD-D04.
           IF NOT PGM-STAT-COD-OKS
               PERFORM CLR-COD-D04
               GO TO FIN-PUT-COD-D04.
           MOVE COD-COD-TASA IN COD TO COD-COD-TASA IN D04-FLD.
       FIN-PUT-COD-D04.
           EXIT.
       
       KEY-ALL-D04 SECTION.
       INI-KEY-ALL-D04.
           PERFORM KEY-D04-D04.
           PERFORM KEY-COD-D04.
       FIN-KEY-ALL-D04.
           EXIT.
       
       KEY-D04-D04 SECTION.
       INI-KEY-D04-D04.
           MOVE D04-COD-RCLI IN D04-FLD TO D04-COD-RCLI IN D04.
       FIN-KEY-D04-D04.
           EXIT.
       
       KEY-COD-D04 SECTION.
       INI-KEY-COD-D04.
       FIN-KEY-COD-D04.
           EXIT.
       
       SCR-CLRA-D04 SECTION.
       INI-SCR-CLRA-D04.
           PERFORM CLR-KEY-D04.
           PERFORM CLR-FLD-D04.
       FIN-SCR-CLRA-D04.
           EXIT.
       
       CLR-KEY-D04 SECTION.
       INI-CLR-KEY-D04.
           MOVE SPACES TO D04-COD-RCLI IN D04-FLD.
       FIN-CLR-KEY-D04.
           EXIT.
       
       CLR-FLD-D04 SECTION.
       INI-CLR-FLD-D04.
           PERFORM CLR-D04-D04.
           PERFORM CLR-COD-D04.
       FIN-CLR-FLD-D04.
           EXIT.
       
       CLR-D04-D04 SECTION.
       INI-CLR-D04-D04.
           MOVE ZEROES TO D04-NUM-TCAP IN D04-FLD.
           MOVE ZEROES TO D04-NUM-MCAP IN D04-FLD.
           MOVE SPACES TO D04-COD-VCLI IN D04-FLD.
           MOVE SPACES TO D04-GLS-NOMC IN D04-FLD.
           MOVE SPACES TO D04-COD-OPER IN D04-FLD.
           MOVE SPACES TO D04-COD-LOCA IN D04-FLD.
           MOVE ZEROES TO D04-VAL-CAPT IN D04-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D04-FEC-FREA IN D04-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D04-FEC-FOPE IN D04-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO D04-VAL-SALD IN D04-FLD.
           MOVE ZEROES TO D04-SGV-TASA IN D04-FLD.
           MOVE ZEROES TO D04-VAL-INTE IN D04-FLD.
           MOVE ZEROES TO D04-VAL-REAJ IN D04-FLD.
           MOVE SPACES TO D04-GLS-DISP IN D04-FLD.
       FIN-CLR-D04-D04.
           EXIT.
       
       CLR-COD-D04 SECTION.
       INI-CLR-COD-D04.
           MOVE SPACES TO COD-COD-TASA IN D04-FLD.
       FIN-CLR-COD-D04.
           EXIT.
       
       FST-KEY-D04 SECTION.
       INI-FST-KEY-D04.
           MOVE -1 TO D04-COD-RCLI-LEN IN D04-FLD.
       FIN-FST-KEY-D04.
           EXIT.
       
       FST-FLD-D04 SECTION.
       INI-FST-FLD-D04.
           MOVE -1 TO D04-NUM-TCAP-LEN IN D04-FLD.
       FIN-FST-FLD-D04.
           EXIT.
       
       PRO-KEY-D04 SECTION.
       INI-PRO-KEY-D04.
           PERFORM PRO-IKY-D04.
           PERFORM PRO-AKY-D04.
           PERFORM PRO-MKY-D04.
       FIN-PRO-KEY-D04.
           EXIT.
       
       PRO-IKY-D04 SECTION.
       INI-PRO-IKY-D04.
           MOVE FRM-CPIM-AEY TO D04-COD-RCLI-ATR IN D04-FLD.
       FIN-PRO-IKY-D04.
           EXIT.
       
       PRO-MKY-D04 SECTION.
       INI-PRO-MKY-D04.
       FIN-PRO-MKY-D04.
           EXIT.
       
       PRO-AKY-D04 SECTION.
       INI-PRO-AKY-D04.
       FIN-PRO-AKY-D04.
           EXIT.
       
       UNP-KEY-D04 SECTION.
       INI-UNP-KEY-D04.
           PERFORM UNP-IKY-D04.
           PERFORM UNP-AKY-D04.
           PERFORM UNP-MKY-D04.
       FIN-UNP-KEY-D04.
           EXIT.
       
       UNP-IKY-D04 SECTION.
       INI-UNP-IKY-D04.
           MOVE FRM-CPIM-UBY TO D04-COD-RCLI-ATR.
       FIN-UNP-IKY-D04.
           EXIT.
       
       UNP-MKY-D04 SECTION.
       INI-UNP-MKY-D04.
       FIN-UNP-MKY-D04.
           EXIT.
       
       UNP-AKY-D04 SECTION.
       INI-UNP-AKY-D04.
       FIN-UNP-AKY-D04.
           EXIT.
       
       UNP-FLD-D04 SECTION.
       INI-UNP-FLD-D04.
           PERFORM UNP-D04-D04.
           PERFORM UNP-COD-D04.
       FIN-UNP-FLD-D04.
           EXIT.
       
       UNP-D04-D04 SECTION.
       INI-UNP-D04-D04.
           MOVE FRM-CPIM-UBY TO D04-NUM-TCAP-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-NUM-MCAP-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-COD-VCLI-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-GLS-NOMC-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-COD-OPER-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-COD-LOCA-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-VAL-CAPT-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-FEC-FREA-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-FEC-FOPE-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-VAL-SALD-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-SGV-TASA-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-VAL-INTE-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-VAL-REAJ-ATR IN D04-FLD.
           MOVE FRM-CPIM-UBY TO D04-GLS-DISP-ATR IN D04-FLD.
       FIN-UNP-D04-D04.
           EXIT.
       
       UNP-COD-D04 SECTION.
       INI-UNP-COD-D04.
           MOVE FRM-CPIM-UBY TO COD-COD-TASA-ATR IN D04-FLD.
       FIN-UNP-COD-D04.
           EXIT.
       
       VAL-KEY-D04 SECTION.
       INI-VAL-KEY-D04.
           PERFORM VAL-IKY-D04.
           PERFORM VAL-MKY-D04.
           PERFORM VAL-AKY-D04.
       FIN-VAL-KEY-D04.
           EXIT.
       
       VAL-IKY-D04 SECTION.
       INI-VAL-IKY-D04.
           PERFORM VAL-D04-COD-RCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO D04-COD-RCLI-LEN IN D04-FLD
                GO TO FIN-VAL-IKY-D04.
       FIN-VAL-IKY-D04.
           EXIT.
       
       VAL-MKY-D04 SECTION.
       INI-VAL-MKY-D04.
       FIN-VAL-MKY-D04.
           EXIT.
       
       VAL-AKY-D04 SECTION.
       INI-VAL-AKY-D04.
       FIN-VAL-AKY-D04.
           EXIT.
       
       VAL-D04-COD-RCLI SECTION.
       INI-VAL-D04-COD-RCLI.
           IF D04-COD-RCLI IN D04-FLD NOT > SPACES
              MOVE SPACES TO D04-COD-RCLI IN D04-FLD.
       FIN-VAL-D04-COD-RCLI.
           EXIT.
       
       VAL-CON-KEY-D04 SECTION.
       INI-VAL-CON-KEY-D04.
           IF     D04-COD-RCLI IN D04-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-D04.
       FIN-VAL-CON-KEY-D04.
           EXIT.
       
       VAL-CON-IKY-D04 SECTION.
       INI-VAL-CON-IKY-D04.
           IF     D04-COD-RCLI IN D04-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-D04.
       FIN-VAL-CON-IKY-D04.
           EXIT.
       
       VAL-NUM-KEY-D04 SECTION.
       INI-VAL-NUM-KEY-D04.
           PERFORM VAL-NUM-IKY-D04.
           PERFORM VAL-NUM-MKY-D04.
           PERFORM VAL-NUM-AKY-D04.
       FIN-VAL-NUM-KEY-D04.
           EXIT.
       
       VAL-NUM-IKY-D04 SECTION.
       INI-VAL-NUM-IKY-D04.
       FIN-VAL-NUM-IKY-D04.
           EXIT.
       
       VAL-NUM-MKY-D04 SECTION.
       INI-VAL-NUM-MKY-D04.
       FIN-VAL-NUM-MKY-D04.
           EXIT.
       
       VAL-NUM-AKY-D04 SECTION.
       INI-VAL-NUM-AKY-D04.
       FIN-VAL-NUM-AKY-D04.
           EXIT.
       
       VAL-NUM-FLD-D04 SECTION.
       INI-VAL-NUM-FLD-D04.
       VAL-NUM-D04-NUM-TCAP.
           MOVE D04-NUM-TCAP-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-NUM-TCAP IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-NUM-TCAP-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-NUM-MCAP.
           MOVE D04-NUM-MCAP-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-NUM-MCAP IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-NUM-MCAP-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-VAL-CAPT.
           MOVE D04-VAL-CAPT-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-VAL-CAPT IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-VAL-CAPT-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-VAL-SALD.
           MOVE D04-VAL-SALD-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-VAL-SALD IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-VAL-SALD-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-SGV-TASA.
           MOVE D04-SGV-TASA-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO D04-SGV-TASA IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-SGV-TASA-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-VAL-INTE.
           MOVE D04-VAL-INTE-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-VAL-INTE IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-VAL-INTE-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       VAL-NUM-D04-VAL-REAJ.
           MOVE D04-VAL-REAJ-ALF IN D04-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D04-VAL-REAJ IN D04-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D04-VAL-REAJ-LEN IN D04-FLD
                GO TO FIN-VAL-NUM-FLD-D04.
       FIN-VAL-NUM-FLD-D04.
           EXIT.
       
       EDT-KEY-D04 SECTION.
       INI-EDT-KEY-D04.
           PERFORM EDT-IKY-D04.
           PERFORM EDT-MKY-D04.
           PERFORM EDT-AKY-D04.
       FIN-EDT-KEY-D04.
           EXIT.
       
       EDT-IKY-D04 SECTION.
       INI-EDT-IKY-D04.
       FIN-EDT-IKY-D04.
           EXIT.
       
       EDT-MKY-D04 SECTION.
       INI-EDT-MKY-D04.
       FIN-EDT-MKY-D04.
           EXIT.
       
       EDT-AKY-D04 SECTION.
       INI-EDT-AKY-D04.
       FIN-EDT-AKY-D04.
           EXIT.
       
       EDT-FLD-D04 SECTION.
       INI-EDT-FLD-D04.
           IF D04-NUM-TCAP-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-NUM-TCAP-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-NUM-TCAP IN D04-FLD TO D04-NUM-TCAP-EDT IN D04-EDT.
           MOVE D04-NUM-TCAP-EDT IN D04-EDT TO 
                D04-NUM-TCAP-ALF IN D04-FLD.
           IF D04-NUM-MCAP-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-NUM-MCAP-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-NUM-MCAP IN D04-FLD TO D04-NUM-MCAP-EDT IN D04-EDT.
           MOVE D04-NUM-MCAP-EDT IN D04-EDT TO 
                D04-NUM-MCAP-ALF IN D04-FLD.
           IF D04-VAL-CAPT-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-VAL-CAPT-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-VAL-CAPT IN D04-FLD TO D04-VAL-CAPT-EDT IN D04-EDT.
           MOVE D04-VAL-CAPT-EDT IN D04-EDT TO 
                D04-VAL-CAPT-ALF IN D04-FLD.
           IF D04-VAL-SALD-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-VAL-SALD-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-VAL-SALD IN D04-FLD TO D04-VAL-SALD-EDT IN D04-EDT.
           MOVE D04-VAL-SALD-EDT IN D04-EDT TO 
                D04-VAL-SALD-ALF IN D04-FLD.
           IF D04-SGV-TASA-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-SGV-TASA-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-SGV-TASA IN D04-FLD TO D04-SGV-TASA-EDT IN D04-EDT.
           MOVE D04-SGV-TASA-EDT IN D04-EDT TO 
                D04-SGV-TASA-ALF IN D04-FLD.
           IF D04-VAL-INTE-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-VAL-INTE-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-VAL-INTE IN D04-FLD TO D04-VAL-INTE-EDT IN D04-EDT.
           MOVE D04-VAL-INTE-EDT IN D04-EDT TO 
                D04-VAL-INTE-ALF IN D04-FLD.
           IF D04-VAL-REAJ-LEN IN D04-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO D04-VAL-REAJ-LEN IN D04-FLD
                GO TO FIN-EDT-FLD-D04.
           MOVE D04-VAL-REAJ IN D04-FLD TO D04-VAL-REAJ-EDT IN D04-EDT.
           MOVE D04-VAL-REAJ-EDT IN D04-EDT TO 
                D04-VAL-REAJ-ALF IN D04-FLD.
       FIN-EDT-FLD-D04.
           EXIT.
