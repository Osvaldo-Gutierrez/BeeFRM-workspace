      *
      * DAPBUPOD
      * Version 3.0.1 Nov-2005
      * 10-May-19 11:53 AM
      *
       SET-TAG-DAPBUPOD SECTION.
       INI-SET-TAG-DAPBUPOD.
           MOVE
           '<IDNMOD NOM=$DAPBUPOD$ VSN=$08.01.10$ VGM=$3.0.1$
      -    'GEN=$10-May-19 11:53 AM$ FNC=$MK2MT1$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DAPBUPOD.
           EXIT.
           
       RET-ALL-POD SECTION.
       INI-RET-ALL-POD.
           PERFORM KEY-ALL-POD.
           PERFORM RET-POD-POD.
      *<<<< FIN_RET_ALL_POD
           MOVE 'S' TO POD-COD-BPBT IN POD.
      *>>>>
       FIN-RET-ALL-POD.
           EXIT.
       
       RET-POD-POD SECTION.
       INI-RET-POD-POD.
           MOVE POD-COD-RENO IN POD-FLD TO POD-COD-RENO IN POD.
           MOVE POD-VAL-CMIN IN POD-FLD TO POD-VAL-CMIN IN POD.
           MOVE POD-COD-ENDO IN POD-FLD TO POD-COD-ENDO IN POD.
           MOVE POD-VAL-CMAX IN POD-FLD TO POD-VAL-CMAX IN POD.
           MOVE POD-COD-BCTI IN POD-FLD TO POD-COD-BCTI IN POD.
           MOVE POD-NUM-PMIN IN POD-FLD TO POD-NUM-PMIN IN POD.
           MOVE POD-IND-PMIN IN POD-FLD TO POD-IND-PMIN IN POD.
           MOVE POD-COD-PBTI IN POD-FLD TO POD-COD-PBTI IN POD.
           MOVE POD-NUM-PMAX IN POD-FLD TO POD-NUM-PMAX IN POD.
           MOVE POD-IND-PMAX IN POD-FLD TO POD-IND-PMAX IN POD.
           MOVE POD-COD-SPBT IN POD-FLD TO POD-COD-SPBT IN POD.
           MOVE POD-NUM-VMIN IN POD-FLD TO POD-NUM-VMIN IN POD.
           MOVE POD-NUM-VMAX IN POD-FLD TO POD-NUM-VMAX IN POD.
           MOVE POD-COD-CVTI IN POD-FLD TO POD-COD-CVTI IN POD.
           MOVE POD-NUM-SMNV IN POD-FLD TO POD-NUM-SMNV IN POD.
           MOVE POD-IND-SMNV IN POD-FLD TO POD-IND-SMNV IN POD.
           MOVE POD-NUM-SMXV IN POD-FLD TO POD-NUM-SMXV IN POD.
           MOVE POD-IND-SMXV IN POD-FLD TO POD-IND-SMXV IN POD.
           MOVE POD-COD-TFPR IN POD-FLD TO POD-COD-TFPR IN POD.
           MOVE POD-COD-MORE IN POD-FLD TO POD-COD-MORE IN POD.
           MOVE POD-NUM-PREP IN POD-FLD TO POD-NUM-PREP IN POD.
           MOVE POD-COD-RESC IN POD-FLD TO POD-COD-RESC IN POD.
           MOVE POD-IND-PREP IN POD-FLD TO POD-IND-PREP IN POD.
           MOVE POD-COD-PLPA IN POD-FLD TO POD-COD-PLPA IN POD.
           MOVE POD-IND-VIGE IN POD-FLD TO POD-IND-VIGE IN POD.
           MOVE POD-NUM-PLRE IN POD-FLD TO POD-NUM-PLRE IN POD.
           MOVE POD-IND-PLRE IN POD-FLD TO POD-IND-PLRE IN POD.
           MOVE POD-NUM-PNTE IN POD-FLD TO POD-NUM-PNTE IN POD.
           MOVE POD-NUM-PRES IN POD-FLD TO POD-NUM-PRES IN POD.
           MOVE POD-IND-PNTE IN POD-FLD TO POD-IND-PNTE IN POD.
           MOVE POD-COD-TCDP IN POD-FLD TO POD-COD-TCDP IN POD.
           MOVE POD-COD-GARA IN POD-FLD TO POD-COD-GARA IN POD.
           MOVE POD-COD-AACC IN POD-FLD TO POD-COD-AACC IN POD.
           MOVE POD-COD-AFER IN POD-FLD TO POD-COD-AFER IN POD.
           MOVE POD-COD-NAPR IN POD-FLD TO POD-COD-NAPR IN POD.
       FIN-RET-POD-POD.
           EXIT.
       
       KEY-ALL-POD SECTION.
       INI-KEY-ALL-POD.
           PERFORM KEY-POD-POD.
       FIN-KEY-ALL-POD.
           EXIT.
       
       KEY-POD-POD SECTION.
       INI-KEY-POD-POD.
           MOVE POD-COD-VCAM IN POD-FLD TO POD-COD-VCAM IN POD.
           MOVE POD-COD-TOPD IN POD-FLD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD-FLD TO POD-COD-AOPD IN POD.
           MOVE POD-NUM-IPOD IN POD-FLD TO POD-NUM-IPOD IN POD.
       FIN-KEY-POD-POD.
           EXIT.
       
       SCR-CLRA-POD SECTION.
       INI-SCR-CLRA-POD.
           PERFORM CLR-KEY-POD.
           PERFORM CLR-FLD-POD.
       FIN-SCR-CLRA-POD.
           EXIT.
       
       CLR-KEY-POD SECTION.
       INI-CLR-KEY-POD.
           MOVE SPACES TO POD-COD-VCAM IN POD-FLD.
           MOVE SPACES TO POD-COD-TOPD IN POD-FLD.
           MOVE SPACES TO POD-COD-AOPD IN POD-FLD.
           MOVE ZEROES TO POD-NUM-IPOD IN POD-FLD.
       FIN-CLR-KEY-POD.
           EXIT.
       
       CLR-FLD-POD SECTION.
       INI-CLR-FLD-POD.
           MOVE SPACES TO FRM-GLS-VCAM IN POD-FLD.
           MOVE SPACES TO FRM-GLS-TOPD IN POD-FLD.
           MOVE SPACES TO FRM-GLS-AOPD IN POD-FLD.
           MOVE SPACES TO FRM-GLS-RENO IN POD-FLD.
           MOVE SPACES TO FRM-GLS-ENDO IN POD-FLD.
           MOVE SPACES TO FRM-GLS-BCTI IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PMIN IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PBTI IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PMAX IN POD-FLD.
           MOVE SPACES TO FRM-GLS-SPBT IN POD-FLD.
           MOVE SPACES TO FRM-GLS-SMNV IN POD-FLD.
           MOVE SPACES TO FRM-GLS-CVTI IN POD-FLD.
           MOVE SPACES TO FRM-GLS-SMXV IN POD-FLD.
           MOVE SPACES TO FRM-GLS-TFPR IN POD-FLD.
           MOVE SPACES TO FRM-GLS-MORE IN POD-FLD.
           MOVE SPACES TO FRM-GLS-RESC IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PREP IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PLPA IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PLRE IN POD-FLD.
           MOVE SPACES TO FRM-GLS-PNTE IN POD-FLD.
           MOVE SPACES TO FRM-GLS-TCDP IN POD-FLD.
           MOVE SPACES TO FRM-GLS-NAPR IN POD-FLD.
           PERFORM CLR-POD-POD.
       FIN-CLR-FLD-POD.
           EXIT.
       
       CLR-POD-POD SECTION.
       INI-CLR-POD-POD.
           MOVE SPACES TO POD-COD-RENO IN POD-FLD.
           MOVE ZEROES TO POD-VAL-CMIN IN POD-FLD.
           MOVE SPACES TO POD-COD-ENDO IN POD-FLD.
           MOVE ZEROES TO POD-VAL-CMAX IN POD-FLD.
           MOVE SPACES TO POD-COD-BCTI IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PMIN IN POD-FLD.
           MOVE SPACES TO POD-IND-PMIN IN POD-FLD.
           MOVE SPACES TO POD-COD-PBTI IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PMAX IN POD-FLD.
           MOVE SPACES TO POD-IND-PMAX IN POD-FLD.
           MOVE SPACES TO POD-COD-SPBT IN POD-FLD.
           MOVE ZEROES TO POD-NUM-VMIN IN POD-FLD.
           MOVE ZEROES TO POD-NUM-VMAX IN POD-FLD.
           MOVE SPACES TO POD-COD-CVTI IN POD-FLD.
           MOVE ZEROES TO POD-NUM-SMNV IN POD-FLD.
           MOVE SPACES TO POD-IND-SMNV IN POD-FLD.
           MOVE ZEROES TO POD-NUM-SMXV IN POD-FLD.
           MOVE SPACES TO POD-IND-SMXV IN POD-FLD.
           MOVE SPACES TO POD-COD-TFPR IN POD-FLD.
           MOVE SPACES TO POD-COD-MORE IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PREP IN POD-FLD.
           MOVE SPACES TO POD-COD-RESC IN POD-FLD.
           MOVE SPACES TO POD-IND-PREP IN POD-FLD.
           MOVE SPACES TO POD-COD-PLPA IN POD-FLD.
           MOVE SPACES TO POD-IND-VIGE IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PLRE IN POD-FLD.
           MOVE SPACES TO POD-IND-PLRE IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PNTE IN POD-FLD.
           MOVE ZEROES TO POD-NUM-PRES IN POD-FLD.
           MOVE SPACES TO POD-IND-PNTE IN POD-FLD.
           MOVE SPACES TO POD-COD-TCDP IN POD-FLD.
           MOVE SPACES TO POD-COD-GARA IN POD-FLD.
           MOVE SPACES TO POD-COD-AACC IN POD-FLD.
           MOVE SPACES TO POD-COD-AFER IN POD-FLD.
           MOVE SPACES TO POD-COD-NAPR IN POD-FLD.
       FIN-CLR-POD-POD.
           EXIT.
       
       FST-KEY-POD SECTION.
       INI-FST-KEY-POD.
           MOVE -1 TO POD-COD-VCAM-LEN IN POD-FLD.
       FIN-FST-KEY-POD.
           EXIT.
       
       FST-FLD-POD SECTION.
       INI-FST-FLD-POD.
           MOVE -1 TO POD-COD-RENO-LEN IN POD-FLD.
       FIN-FST-FLD-POD.
           EXIT.
       
       PRO-KEY-POD SECTION.
       INI-PRO-KEY-POD.
           PERFORM PRO-MKY-POD.
       FIN-PRO-KEY-POD.
           EXIT.
       
       PRO-MKY-POD SECTION.
       INI-PRO-MKY-POD.
       FIN-PRO-MKY-POD.
           EXIT.
       
       PRO-FLD-POD SECTION.
       INI-PRO-FLD-POD.
           PERFORM PRO-POD-POD.
       FIN-PRO-FLD-POD.
           EXIT.
       
       PRO-POD-POD SECTION.
       INI-PRO-POD-POD.
           MOVE FRM-CPIM-AEY TO POD-COD-RENO-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-VAL-CMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-ENDO-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-VAL-CMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-BCTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-PBTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-SPBT-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-VMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-VMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-CVTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-SMNV-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-SMNV-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-SMXV-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-SMXV-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-TFPR-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-MORE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-RESC-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-PLPA-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-VIGE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PLRE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PLRE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PNTE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PRES-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PNTE-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-TCDP-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-GARA-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-AACC-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-AFER-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-NAPR-ATR IN POD-FLD.
       FIN-PRO-POD-POD.
           EXIT.
       
       UNP-KEY-POD SECTION.
       INI-UNP-KEY-POD.
           PERFORM UNP-IKY-POD.
           PERFORM UNP-AKY-POD.
           PERFORM UNP-MKY-POD.
       FIN-UNP-KEY-POD.
           EXIT.
       
       UNP-IKY-POD SECTION.
       INI-UNP-IKY-POD.
           MOVE FRM-CPIM-UBY TO POD-COD-VCAM-ATR.
           MOVE FRM-CPIM-UBY TO POD-COD-TOPD-ATR.
           MOVE FRM-CPIM-UBY TO POD-COD-AOPD-ATR.
           MOVE FRM-CPIM-UBY TO POD-NUM-IPOD-ATR.
      *<<<< FIN_UNP_IKY_POD
           MOVE FRM-CPIM-AEY TO POD-NUM-IPOD-ATR IN POD-FLD.
      *>>>>
       FIN-UNP-IKY-POD.
           EXIT.
       
       UNP-MKY-POD SECTION.
       INI-UNP-MKY-POD.
       FIN-UNP-MKY-POD.
           EXIT.
       
       UNP-AKY-POD SECTION.
       INI-UNP-AKY-POD.
       FIN-UNP-AKY-POD.
           EXIT.
       
       UNP-FLD-POD SECTION.
       INI-UNP-FLD-POD.
           PERFORM UNP-POD-POD.
       FIN-UNP-FLD-POD.
           EXIT.
       
       UNP-POD-POD SECTION.
       INI-UNP-POD-POD.
           MOVE FRM-CPIM-UBY TO POD-COD-RENO-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-VAL-CMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-ENDO-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-VAL-CMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-BCTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-PMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-PBTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-PMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-SPBT-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-VMIN-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-VMAX-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-CVTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-SMNV-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-SMNV-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-SMXV-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-SMXV-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-TFPR-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-MORE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-RESC-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-PLPA-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-VIGE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PLRE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-PLRE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PNTE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-NUM-PRES-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-IND-PNTE-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-TCDP-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-GARA-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-AACC-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-AFER-ATR IN POD-FLD.
           MOVE FRM-CPIM-UBY TO POD-COD-NAPR-ATR IN POD-FLD.
      *<<<< FIN_UNP_POD_POD
           MOVE FRM-CPIM-AEY TO POD-COD-BCTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-NAPR-ATR IN POD-FLD.
      *JVM  23-SEP-1991 MANTENCION
           MOVE FRM-CPIM-AEY TO POD-COD-SPBT-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PREP-ATR IN POD-FLD.
      *
      *JVM  02-SEP-1991 PROTEGE CAMPOS POD PARA CONSIST
      *     MOVE 'DAP' TO TAB-COD-SIST.
      *     MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
      *     MOVE 'BCI    PCPOD' TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS > SPACES
      *        MOVE FRM-CPIM-AEY TO POD-COD-SPBT-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-CVTI-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-TFPR-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-PREP-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-PREP-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-VMIN-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-VMAX-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-SMNV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-SMNV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-SMXV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-SMXV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-MORE-ATR IN POD-FLD.
      *>>>>
       FIN-UNP-POD-POD.
           EXIT.
       
       VAL-MKY-POD SECTION.
       INI-VAL-MKY-POD.
       FIN-VAL-MKY-POD.
           EXIT.
       
       VAL-FLD-POD SECTION.
       INI-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCAM-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOPD-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOPD-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-RENO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-RENO-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-RENO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RENO-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-VAL-CMIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-VAL-CMIN-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-ENDO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-ENDO-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-ENDO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ENDO-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-VAL-CMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-VAL-CMAX-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-BCTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-BCTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-BCTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-BCTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PMIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PMIN-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-PMIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-PMIN-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PMIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PMIN-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-PBTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-PBTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PBTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PBTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PMAX-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-PMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-PMAX-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PMAX-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-SPBT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-SPBT-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-SPBT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SPBT-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-VMIN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-VMIN-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-VMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-VMAX-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-CVTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-CVTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-SMNV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-SMNV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-SMNV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-SMNV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-SMNV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SMNV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-CVTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CVTI-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-SMXV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-SMXV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-SMXV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-SMXV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-SMXV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SMXV-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-TFPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-TFPR-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-MORE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-MORE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-TFPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TFPR-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-MORE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-MORE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PREP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PREP-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-RESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-RESC-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-RESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RESC-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-PREP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-PREP-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PREP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PREP-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-PLPA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-PLPA-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PLPA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PLPA-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-VIGE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PLRE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-PLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-PLRE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PLRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PLRE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PNTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PNTE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-NUM-PRES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-NUM-PRES-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-IND-PNTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-IND-PNTE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-PNTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PNTE-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-TCDP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-TCDP-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-TCDP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TCDP-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-GARA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-GARA-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-AACC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-AACC-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-AFER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-AFER-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-POD-COD-NAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO POD-COD-NAPR-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
           PERFORM VAL-FRM-GLS-NAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NAPR-LEN IN POD-FLD
                GO TO FIN-VAL-FLD-POD.
       FIN-VAL-FLD-POD.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-FRM-GLS-TOPD SECTION.
       INI-VAL-FRM-GLS-TOPD.
       FIN-VAL-FRM-GLS-TOPD.
           EXIT.
       
       VAL-FRM-GLS-AOPD SECTION.
       INI-VAL-FRM-GLS-AOPD.
       FIN-VAL-FRM-GLS-AOPD.
           EXIT.
       
       VAL-POD-COD-RENO SECTION.
       INI-VAL-POD-COD-RENO.
           IF POD-COD-RENO IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-RENO.
      *<<<< POD_COD_RENO
           IF SCR-CMND = 'COP'
               PERFORM VAL-KEY-POD
               PERFORM KEY-ALL-POD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL
               IF FRM-SUAR = FRM-SUAR-MAL
                  GO TO FIN-VAL-POD-COD-RENO.

      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RENO IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RENO IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RENO IN POD-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-RENO IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-RENO.
           EXIT.
       
       VAL-FRM-GLS-RENO SECTION.
       INI-VAL-FRM-GLS-RENO.
       FIN-VAL-FRM-GLS-RENO.
           EXIT.
       
       VAL-POD-VAL-CMIN SECTION.
       INI-VAL-POD-VAL-CMIN.
           IF POD-VAL-CMIN IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-VAL-CMIN.
       FIN-VAL-POD-VAL-CMIN.
           EXIT.
       
       VAL-POD-COD-ENDO SECTION.
       INI-VAL-POD-COD-ENDO.
           IF POD-COD-ENDO IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-ENDO.
      *<<<< FIN_POD_COD_ENDO
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-ENDO IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-ENDO IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ENDO IN POD-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-ENDO IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-ENDO.
           EXIT.
       
       VAL-FRM-GLS-ENDO SECTION.
       INI-VAL-FRM-GLS-ENDO.
       FIN-VAL-FRM-GLS-ENDO.
           EXIT.
       
       VAL-POD-VAL-CMAX SECTION.
       INI-VAL-POD-VAL-CMAX.
           IF POD-VAL-CMAX IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-VAL-CMAX.
      *<<<< POD_VAL_CMAX             
           IF POD-VAL-CMAX IN POD-FLD < POD-VAL-CMIN IN POD-FLD
      *        captacion maxima >= captacion minima 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CMAX>=CMIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-POD-VAL-CMAX.
           EXIT.
       
       VAL-POD-COD-BCTI SECTION.
       INI-VAL-POD-COD-BCTI.
           IF POD-COD-BCTI IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-BCTI.
      *<<<< POD_COD_BCTI
           MOVE 'V' TO POD-COD-BCTI IN POD-FLD.
           
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'BCT ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-BCTI IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-BCTI IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-BCTI IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-BCTI IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-BCTI.
           EXIT.
       
       VAL-FRM-GLS-BCTI SECTION.
       INI-VAL-FRM-GLS-BCTI.
       FIN-VAL-FRM-GLS-BCTI.
           EXIT.
       
       VAL-POD-NUM-PMIN SECTION.
       INI-VAL-POD-NUM-PMIN.
           IF POD-NUM-PMIN IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-NUM-PMIN.
       FIN-VAL-POD-NUM-PMIN.
           EXIT.
       
       VAL-POD-IND-PMIN SECTION.
       INI-VAL-POD-IND-PMIN.
           IF POD-IND-PMIN IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-PMIN IN POD-FLD.
      *<<<< POD_IND_PMIN
           IF ( POD-NUM-PMIN IN POD-FLD > ZEROES AND
              POD-IND-PMIN IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMIN IN POD-FLD NOT > ZEROES AND
              POD-IND-PMIN IN POD-FLD > SPACES )
      *        plazo minimo inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PMIN    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
               
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMIN IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMIN IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PMIN IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PMIN IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-PMIN.
           EXIT.
       
       VAL-FRM-GLS-PMIN SECTION.
       INI-VAL-FRM-GLS-PMIN.
       FIN-VAL-FRM-GLS-PMIN.
           EXIT.
       
       VAL-POD-COD-PBTI SECTION.
       INI-VAL-POD-COD-PBTI.
           IF POD-COD-PBTI IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-PBTI.
      *<<<< FIN_POD_COD_PBTI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PBT ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PBTI IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PBTI IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PBTI IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-PBTI IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-PBTI.
           EXIT.
       
       VAL-FRM-GLS-PBTI SECTION.
       INI-VAL-FRM-GLS-PBTI.
       FIN-VAL-FRM-GLS-PBTI.
           EXIT.
       
       VAL-POD-NUM-PMAX SECTION.
       INI-VAL-POD-NUM-PMAX.
           IF POD-NUM-PMAX IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-NUM-PMAX.
       FIN-VAL-POD-NUM-PMAX.
           EXIT.
       
       VAL-POD-IND-PMAX SECTION.
       INI-VAL-POD-IND-PMAX.
           IF POD-IND-PMAX IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-PMAX IN POD-FLD.
      *<<<< POD_IND_PMAX
           MOVE SPACES TO MSG-COD-MENS.
           IF ( POD-NUM-PMAX IN POD-FLD > ZEROES AND
              POD-IND-PMAX IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMAX IN POD-FLD NOT > ZEROES AND
              POD-IND-PMAX IN POD-FLD > SPACES )
      *        plazo maximo inconsistente 
               MOVE 'PMAX    MALO' TO MSG-COD-MENS
               GO TO ERR-POD-IND-PMAX.

           IF ( POD-NUM-PMIN IN POD-FLD > ZEROES AND
                POD-NUM-PMAX IN POD-FLD > ZEROES )
               PERFORM VAL-PMIN-PMAX.

       ERR-POD-IND-PMAX.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMAX IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMAX IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PMAX IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PMAX IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-PMAX.
           EXIT.
       
       VAL-FRM-GLS-PMAX SECTION.
       INI-VAL-FRM-GLS-PMAX.
       FIN-VAL-FRM-GLS-PMAX.
           EXIT.
       
       VAL-POD-COD-SPBT SECTION.
       INI-VAL-POD-COD-SPBT.
           IF POD-COD-SPBT IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-SPBT.
      *<<<< POD_COD_SPTB
           MOVE 'S' TO POD-COD-SPBT IN POD-FLD.
           
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MCT ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-SPBT IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-SPBT IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SPBT IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-SPBT IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-SPBT.
           EXIT.
       
       VAL-FRM-GLS-SPBT SECTION.
       INI-VAL-FRM-GLS-SPBT.
       FIN-VAL-FRM-GLS-SPBT.
           EXIT.
       
       VAL-POD-NUM-VMIN SECTION.
       INI-VAL-POD-NUM-VMIN.
           IF POD-NUM-VMIN IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-NUM-VMIN.
      *<<<< POD_NUM_VMIN
      *     MOVE 1 TO POD-NUM-VMIN IN POD-FLD.
      *>>>>
       FIN-VAL-POD-NUM-VMIN.
           EXIT.
       
       VAL-POD-NUM-VMAX SECTION.
       INI-VAL-POD-NUM-VMAX.
           IF POD-NUM-VMAX IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-NUM-VMAX.
      *<<<< POD_NUM_VMAX
      *     MOVE 1 TO POD-NUM-VMAX IN POD-FLD.
           IF POD-NUM-VMAX IN POD-FLD < POD-NUM-VMIN IN POD-FLD
      *        vmax debe ser >= vmin
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VMAX>VMIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-POD-NUM-VMAX.
           EXIT.
       
       VAL-POD-COD-CVTI SECTION.
       INI-VAL-POD-COD-CVTI.
           IF POD-COD-CVTI IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-CVTI IN POD-FLD.
      *<<<< POD_COD_CVTI
           IF POD-COD-CVTI IN POD-FLD > SPACES
               MOVE 'I'                     TO WSS-GLS-CVTI IN WSS-VARI
               MOVE POD-COD-CVTI IN POD-FLD TO WSS-COD-CVTI IN WSS-VARI
               MOVE POD-COD-PBTI IN POD-FLD TO WSS-COD-PBTI IN WSS-VARI
               MOVE WSS-CVTI IN WSS-VARI    TO TAB-COD-CTAB IN TAB
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX'
      *        CVTI inexistente
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'CVTI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-CVTI IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-CVTI.
           EXIT.
       
       VAL-POD-NUM-SMNV SECTION.
       INI-VAL-POD-NUM-SMNV.
       FIN-VAL-POD-NUM-SMNV.
           EXIT.
       
       VAL-POD-IND-SMNV SECTION.
       INI-VAL-POD-IND-SMNV.
           IF POD-IND-SMNV IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-SMNV IN POD-FLD.
      *<<<< POD_IND_SMNV
           IF ( POD-NUM-SMNV IN POD-FLD > ZEROES AND
              POD-IND-SMNV IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-SMNV IN POD-FLD NOT > ZEROES AND
              POD-IND-SMNV IN POD-FLD > SPACES )
      *        separacion minima inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMNV    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-SMNV.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              ( POD-NUM-SMNV IN POD-FLD > ZEROES  OR 
                POD-IND-SMNV IN POD-FLD > SPACES )
               MOVE 'DAP' TO MSG-COD-SIST
      *        separacion minima vctos debe estar en blanco
               MOVE 'SMNVBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
               
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMNV IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMNV IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SMNV IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SMNV IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-SMNV.
           EXIT.
       
       VAL-FRM-GLS-SMNV SECTION.
       INI-VAL-FRM-GLS-SMNV.
       FIN-VAL-FRM-GLS-SMNV.
           EXIT.
       
       VAL-FRM-GLS-CVTI SECTION.
       INI-VAL-FRM-GLS-CVTI.
       FIN-VAL-FRM-GLS-CVTI.
           EXIT.
       
       VAL-POD-NUM-SMXV SECTION.
       INI-VAL-POD-NUM-SMXV.
       FIN-VAL-POD-NUM-SMXV.
           EXIT.
       
       VAL-POD-IND-SMXV SECTION.
       INI-VAL-POD-IND-SMXV.
           IF POD-IND-SMXV IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-SMXV IN POD-FLD.
      *<<<< POD_IND_SMXV
           IF ( POD-NUM-SMXV IN POD-FLD > ZEROES AND
              POD-IND-SMXV IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-SMXV IN POD-FLD NOT > ZEROES AND
              POD-IND-SMXV IN POD-FLD > SPACES )
      *        separacion maxima inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMXV    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-SMXV.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              ( POD-NUM-SMXV IN POD-FLD > ZEROES OR
                POD-IND-SMXV IN POD-FLD > SPACES )
      *        separacion maxima vctos debe estar en blanco
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMXVBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
               
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMXV IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMXV IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SMXV IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SMXV IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-SMXV.
           EXIT.
       
       VAL-FRM-GLS-SMXV SECTION.
       INI-VAL-FRM-GLS-SMXV.
       FIN-VAL-FRM-GLS-SMXV.
           EXIT.
       
       VAL-POD-COD-TFPR SECTION.
       INI-VAL-POD-COD-TFPR.
           IF POD-COD-TFPR IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-TFPR IN POD-FLD.
      *<<<< POD_COD_TFPR
           IF POD-COD-CVTI IN POD-FLD NOT > SPACES AND
              POD-COD-TFPR IN POD-FLD > SPACES
      *       TFPR inconsistente con CVTI
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRBLKOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

           IF POD-COD-CVTI IN POD-FLD > SPACES AND
              POD-COD-TFPR IN POD-FLD NOT > SPACES
      *       tfpr debe tener valor
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRCVTI INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

      * ISP: OBTIENE CIC DE CODIGO
           IF POD-COD-CVTI IN POD-FLD > SPACES
                MOVE 'TAB' TO TAB-COD-SIST
                MOVE 'TPR' TO TAB-CIC-TTAB IN TAB
                MOVE 'F'   TO TAB-CIC-CTAB IN TAB
                MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                PERFORM BUS-TAB
                IF TAB-COD-CTAB IN TAB NOT = POD-COD-TFPR IN POD-FLD
      *       tfpr debe ser 'F' para tasa variable
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TFPRFOBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-POD-COD-TFPR.

           IF POD-COD-CVTI IN POD-FLD > SPACES AND
              POD-NUM-VMAX IN POD-FLD > 1      AND
              POD-COD-TFPR IN POD-FLD = 'C'
      *       tfpr debe ser 'F' para > 1 y cvti > spaces
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRFOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

      *JVM  23-SEP-1991 MANTENCION
      *     IF POD-COD-CVTI IN POD-FLD > SPACES AND
      *        POD-NUM-VMAX IN POD-FLD = 1      AND
      *        POD-COD-TFPR IN POD-FLD = 'F'
      **       tfpr debe ser 'C' para = 1 y cvti > spaces
      *        MOVE 'DAP' TO MSG-COD-SIST
      *        MOVE 'TFPRCOBL' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-POD-COD-TFPR.
      
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TPR ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TFPR IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TFPR IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TFPR IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TFPR IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-TFPR.
           EXIT.
       
       VAL-POD-COD-MORE SECTION.
       INI-VAL-POD-COD-MORE.
           IF POD-COD-MORE IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-MORE IN POD-FLD.
      *<<<< POD_COD_MORE 
      *     MOVE 'N' TO POD-COD-MORE IN POD-FLD.
      *JVM  23-SEP-1991 MANTENCION
           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-COD-MORE IN POD-FLD NOT = 'N'
      *        modalidad de retiro, debe ser 'N' para doc. renovable
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'MORENOBLRENO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-COD-MORE.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              POD-COD-MORE IN POD-FLD NOT = 'N'
      *        sin modalidad de retiro, debe ser 'N'
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'MORE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-COD-MORE.

           IF POD-NUM-VMAX IN POD-FLD > 1 AND
              POD-COD-MORE IN POD-FLD = 'N'
      *       dap con retiros,debe ser distinto de 'N'
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'MOREVMAXMALO' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-MORE.

      * REVISAR ICU
      *     IF POD-COD-CVTI IN POD-FLD > SPACES  AND
      *        POD-COD-MORE IN POD-FLD NOT = 'N' AND
      *        POD-COD-SPBT IN POD-FLD = 'S'
      *        NEXT SENTENCE
      *     ELSE
      *       spbt debe ser 's' para more not = 'n'
      *       y cvti > spaces
      *        MOVE 'DAP' TO MSG-COD-SIST
      *        MOVE 'SPBTSOBLMRNN' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-POD-COD-MORE.

      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'MDR ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-MORE IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-MORE IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MORE IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MORE IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-MORE.
           EXIT.
       
       VAL-FRM-GLS-TFPR SECTION.
       INI-VAL-FRM-GLS-TFPR.
       FIN-VAL-FRM-GLS-TFPR.
           EXIT.
       
       VAL-FRM-GLS-MORE SECTION.
       INI-VAL-FRM-GLS-MORE.
       FIN-VAL-FRM-GLS-MORE.
           EXIT.
       
       VAL-POD-NUM-PREP SECTION.
       INI-VAL-POD-NUM-PREP.
       FIN-VAL-POD-NUM-PREP.
           EXIT.
       
       VAL-POD-COD-RESC SECTION.
       INI-VAL-POD-COD-RESC.
           IF POD-COD-RESC IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-RESC.
      *<<<< FIN_POD_COD_RESC
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'CDR ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RESC IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RESC IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RESC IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-RESC IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-RESC.
           EXIT.
       
       VAL-FRM-GLS-RESC SECTION.
       INI-VAL-FRM-GLS-RESC.
       FIN-VAL-FRM-GLS-RESC.
           EXIT.
       
       VAL-POD-IND-PREP SECTION.
       INI-VAL-POD-IND-PREP.
           IF POD-IND-PREP IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-PREP IN POD-FLD.
      *<<<< POD_IND_PREP
           IF ( POD-NUM-PREP IN POD-FLD > ZEROES AND
              POD-IND-PREP IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PREP IN POD-FLD NOT > ZEROES AND
              POD-IND-PREP IN POD-FLD > SPACES )
      *        periodo repacto inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREP    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-CVTI IN POD-FLD NOT > SPACES AND
              ( POD-NUM-PREP IN POD-FLD > ZEROES OR 
              POD-IND-PREP IN POD-FLD > SPACES )
      *        PREP inconsistente con CVTI
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREPCVTI INC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-TFPR IN POD-FLD = 'F' AND
              ( POD-NUM-PREP IN POD-FLD > ZEROES OR 
              POD-IND-PREP IN POD-FLD > SPACES )
      *        PREP inconsistente con TFPR
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREPTFPR INC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-TFPR IN POD-FLD = 'C' AND
              ( POD-NUM-PREP IN POD-FLD NOT > ZEROES OR
              POD-IND-PREP IN POD-FLD NOT > SPACES )
      *       periodo repacto debe estar con valores
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRPREP INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
              
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PREP IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PREP IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PREP IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PREP IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-PREP.
           EXIT.
       
       VAL-FRM-GLS-PREP SECTION.
       INI-VAL-FRM-GLS-PREP.
       FIN-VAL-FRM-GLS-PREP.
           EXIT.
       
       VAL-POD-COD-PLPA SECTION.
       INI-VAL-POD-COD-PLPA.
           IF POD-COD-PLPA IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-PLPA.
      *<<<< POD_COD_PLPA                             
      *     IF POD-COD-RESC IN POD-FLD = 'N' AND
      *        POD-COD-PLPA IN POD-FLD > SPACES
      *        PLPA inconsistente con RESC
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         MOVE 'PLPABLKOBL' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-POD-COD-PLPA.
              
           IF POD-COD-RESC IN POD-FLD NOT = 'N' AND
              POD-COD-PLPA IN POD-FLD = SPACES
      *       si hay rescate,se debe indicar 
      *       hasta cuando se calcula interes
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PLPARESC INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
              
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'PPR ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PLPA IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PLPA IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLPA IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-PLPA IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-PLPA.
           EXIT.
       
       VAL-FRM-GLS-PLPA SECTION.
       INI-VAL-FRM-GLS-PLPA.
       FIN-VAL-FRM-GLS-PLPA.
           EXIT.
       
       VAL-POD-IND-VIGE SECTION.
       INI-VAL-POD-IND-VIGE.
           IF POD-IND-VIGE IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-IND-VIGE.
      *<<<< FIN_POD_IND_VIGE
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-VIGE IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-POD-IND-VIGE.
           EXIT.
       
       VAL-POD-NUM-PLRE SECTION.
       INI-VAL-POD-NUM-PLRE.
           IF POD-NUM-PLRE IN POD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-NUM-PLRE.
       FIN-VAL-POD-NUM-PLRE.
           EXIT.
       
       VAL-POD-IND-PLRE SECTION.
       INI-VAL-POD-IND-PLRE.
           IF POD-IND-PLRE IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-IND-PLRE.
      *<<<< POD_IND_PLRE
           IF ( POD-NUM-PLRE IN POD-FLD > ZEROES AND
              POD-IND-PLRE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PLRE IN POD-FLD NOT > ZEROES AND
              POD-IND-PLRE IN POD-FLD > SPACES )
      *        plazo rescate inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PLRE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PLRE.
               
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PLRE IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PLRE IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLRE IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PLRE IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-PLRE.
           EXIT.
       
       VAL-FRM-GLS-PLRE SECTION.
       INI-VAL-FRM-GLS-PLRE.
       FIN-VAL-FRM-GLS-PLRE.
           EXIT.
       
       VAL-POD-NUM-PNTE SECTION.
       INI-VAL-POD-NUM-PNTE.
       FIN-VAL-POD-NUM-PNTE.
           EXIT.
       
       VAL-POD-NUM-PRES SECTION.
       INI-VAL-POD-NUM-PRES.
       FIN-VAL-POD-NUM-PRES.
           EXIT.
       
       VAL-POD-IND-PNTE SECTION.
       INI-VAL-POD-IND-PNTE.
           IF POD-IND-PNTE IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-IND-PNTE IN POD-FLD.
      *<<<< POD_IND_PNTE
           IF ( POD-NUM-PNTE IN POD-FLD     > ZEROES AND
                POD-IND-PNTE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PNTE IN POD-FLD NOT > ZEROES AND
                POD-IND-PNTE IN POD-FLD     > SPACES )
      *        periodo negociacion tasa especial inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PNTE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'N' AND 
              ( POD-NUM-PNTE IN POD-FLD > ZEROES OR
                POD-IND-PNTE IN POD-FLD > SPACES )
               MOVE 'DAP' TO MSG-COD-SIST
      *        periodo neg tasa especial debe estar en blanco
               MOVE 'PNTEBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-NUM-PNTE IN POD-FLD = ZEROES
      *       si es renovable,se debe indicar pnte
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENO INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-IND-PNTE IN POD-FLD = SPACES 
      *       si es renovable,se debe indicar pnte
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENO INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.

      *JVM  23-SEP-1991 MANTENCION
           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-IND-PNTE IN POD-FLD NOT = 'D'
      *       si es renovable,se debe indicar pnte en dias 
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENODOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.
              
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PNTE IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PNTE IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PNTE IN POD-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PNTE IN POD-FLD.
      *>>>>
       FIN-VAL-POD-IND-PNTE.
           EXIT.
       
       VAL-FRM-GLS-PNTE SECTION.
       INI-VAL-FRM-GLS-PNTE.
       FIN-VAL-FRM-GLS-PNTE.
           EXIT.
       
       VAL-POD-COD-TCDP SECTION.
       INI-VAL-POD-COD-TCDP.
           IF POD-COD-TCDP IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-TCDP IN POD-FLD.
      *<<<< FIN_POD_COD_TCDP
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TCD ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TCDP IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TCDP IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCDP IN POD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TCDP IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-TCDP.
           EXIT.
       
       VAL-FRM-GLS-TCDP SECTION.
       INI-VAL-FRM-GLS-TCDP.
       FIN-VAL-FRM-GLS-TCDP.
           EXIT.
       
       VAL-POD-COD-GARA SECTION.
       INI-VAL-POD-COD-GARA.
           IF POD-COD-GARA IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-GARA IN POD-FLD.
      *<<<< FIN_POD_COD_GARA
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'GAR ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-GARA IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-POD-COD-GARA.
           EXIT.
       
       VAL-POD-COD-AACC SECTION.
       INI-VAL-POD-COD-AACC.
           IF POD-COD-AACC IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-AACC.
      *<<<< FIN_POD_COD_AACC
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-AACC IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-POD-COD-AACC.
           EXIT.
       
       VAL-POD-COD-AFER SECTION.
       INI-VAL-POD-COD-AFER.
           IF POD-COD-AFER IN POD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-POD-COD-AFER.
      *<<<< FIN_POD_COD_AFER
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-AFER IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-POD-COD-AFER.
           EXIT.
       
       VAL-POD-COD-NAPR SECTION.
       INI-VAL-POD-COD-NAPR.
           IF POD-COD-NAPR IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-NAPR IN POD-FLD.
       FIN-VAL-POD-COD-NAPR.
           EXIT.
       
       VAL-FRM-GLS-NAPR SECTION.
       INI-VAL-FRM-GLS-NAPR.
       FIN-VAL-FRM-GLS-NAPR.
           EXIT.
       
       VAL-CON-FLD-POD SECTION.
       INI-VAL-CON-FLD-POD.
      *<<<< VAL_CON_FLD_POD
               MOVE 'TAB' TO TAB-COD-SIST.
               MOVE 'INT' TO TAB-COD-TTAB IN TAB.
               MOVE POD-COD-BCTI IN POD-FLD TO
                                  WSS-INT-COD-BCTI IN WSS-VARI.
               MOVE POD-COD-PBTI IN POD-FLD TO
                                  WSS-INT-COD-PBTI IN WSS-VARI
               MOVE 'S' TO
                                  WSS-INT-COD-BPBT IN WSS-VARI.
               MOVE POD-COD-SPBT IN POD-FLD TO
                                  WSS-INT-COD-SPBT IN WSS-VARI.
               MOVE POD-COD-CVTI IN POD-FLD TO 
                                  WSS-INT-COD-CVTI IN WSS-VARI.
               MOVE POD-COD-TFPR IN POD-FLD TO
                                  WSS-INT-COD-TFPR IN WSS-VARI.
               MOVE POD-NUM-PREP IN POD-FLD TO
                                  WSS-INT-NUM-PREP IN WSS-VARI.
               MOVE POD-IND-PREP IN POD-FLD TO
                                  WSS-INT-IND-PREP IN WSS-VARI.
               MOVE WSS-INTE  IN WSS-VARI    TO TAB-COD-CTAB IN TAB.
               PERFORM VAL-COD.
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-COD-MENS = 'COD    NVG'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-FLD-POD.
           EXIT.
       
       VAL-CON-POD SECTION.
       INI-VAL-CON-POD.
       FIN-VAL-CON-POD.
           EXIT.
       
       VAL-NUM-KEY-POD SECTION.
       INI-VAL-NUM-KEY-POD.
           PERFORM VAL-NUM-IKY-POD.
           PERFORM VAL-NUM-MKY-POD.
           PERFORM VAL-NUM-AKY-POD.
       FIN-VAL-NUM-KEY-POD.
           EXIT.
       
       VAL-NUM-IKY-POD SECTION.
       INI-VAL-NUM-IKY-POD.
       VAL-NUM-POD-NUM-IPOD.
           MOVE POD-NUM-IPOD-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-IPOD IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-IPOD-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-IKY-POD.
       FIN-VAL-NUM-IKY-POD.
           EXIT.
       
       VAL-NUM-MKY-POD SECTION.
       INI-VAL-NUM-MKY-POD.
       FIN-VAL-NUM-MKY-POD.
           EXIT.
       
       VAL-NUM-AKY-POD SECTION.
       INI-VAL-NUM-AKY-POD.
       FIN-VAL-NUM-AKY-POD.
           EXIT.
       
       VAL-NUM-FLD-POD SECTION.
       INI-VAL-NUM-FLD-POD.
       VAL-NUM-POD-VAL-CMIN.
           MOVE POD-VAL-CMIN-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO POD-VAL-CMIN IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-VAL-CMIN-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-VAL-CMAX.
           MOVE POD-VAL-CMAX-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO POD-VAL-CMAX IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-VAL-CMAX-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PMIN.
           MOVE POD-NUM-PMIN-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PMIN IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PMIN-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PMAX.
           MOVE POD-NUM-PMAX-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PMAX IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PMAX-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-VMIN.
           MOVE POD-NUM-VMIN-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-VMIN IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-VMIN-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-VMAX.
           MOVE POD-NUM-VMAX-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-VMAX IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-VMAX-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-SMNV.
           MOVE POD-NUM-SMNV-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-SMNV IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-SMNV-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-SMXV.
           MOVE POD-NUM-SMXV-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-SMXV IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-SMXV-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PREP.
           MOVE POD-NUM-PREP-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PREP IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PREP-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PLRE.
           MOVE POD-NUM-PLRE-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PLRE IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PLRE-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PNTE.
           MOVE POD-NUM-PNTE-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PNTE IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PNTE-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       VAL-NUM-POD-NUM-PRES.
           MOVE POD-NUM-PRES-ALF IN POD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO POD-NUM-PRES IN POD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO POD-NUM-PRES-LEN IN POD-FLD
                GO TO FIN-VAL-NUM-FLD-POD.
       FIN-VAL-NUM-FLD-POD.
           EXIT.
       
       EDT-KEY-POD SECTION.
       INI-EDT-KEY-POD.
           PERFORM EDT-IKY-POD.
           PERFORM EDT-MKY-POD.
           PERFORM EDT-AKY-POD.
       FIN-EDT-KEY-POD.
           EXIT.
       
       EDT-IKY-POD SECTION.
       INI-EDT-IKY-POD.
           IF POD-NUM-IPOD-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-IPOD-LEN IN POD-FLD
                GO TO FIN-EDT-IKY-POD.
           MOVE POD-NUM-IPOD IN POD-FLD TO POD-NUM-IPOD-EDT IN POD-EDT.
           MOVE POD-NUM-IPOD-EDT IN POD-EDT TO 
                POD-NUM-IPOD-ALF IN POD-FLD.
       FIN-EDT-IKY-POD.
           EXIT.
       
       EDT-MKY-POD SECTION.
       INI-EDT-MKY-POD.
       FIN-EDT-MKY-POD.
           EXIT.
       
       EDT-AKY-POD SECTION.
       INI-EDT-AKY-POD.
       FIN-EDT-AKY-POD.
           EXIT.
       
       EDT-FLD-POD SECTION.
       INI-EDT-FLD-POD.
           IF POD-VAL-CMIN-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-VAL-CMIN-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-VAL-CMIN IN POD-FLD TO POD-VAL-CMIN-EDT IN POD-EDT.
           MOVE POD-VAL-CMIN-EDT IN POD-EDT TO 
                POD-VAL-CMIN-ALF IN POD-FLD.
           IF POD-VAL-CMAX-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-VAL-CMAX-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-VAL-CMAX IN POD-FLD TO POD-VAL-CMAX-EDT IN POD-EDT.
           MOVE POD-VAL-CMAX-EDT IN POD-EDT TO 
                POD-VAL-CMAX-ALF IN POD-FLD.
           IF POD-NUM-PMIN-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PMIN-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PMIN IN POD-FLD TO POD-NUM-PMIN-EDT IN POD-EDT.
           MOVE POD-NUM-PMIN-EDT IN POD-EDT TO 
                POD-NUM-PMIN-ALF IN POD-FLD.
           IF POD-NUM-PMAX-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PMAX-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PMAX IN POD-FLD TO POD-NUM-PMAX-EDT IN POD-EDT.
           MOVE POD-NUM-PMAX-EDT IN POD-EDT TO 
                POD-NUM-PMAX-ALF IN POD-FLD.
           IF POD-NUM-VMIN-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-VMIN-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-VMIN IN POD-FLD TO POD-NUM-VMIN-EDT IN POD-EDT.
           MOVE POD-NUM-VMIN-EDT IN POD-EDT TO 
                POD-NUM-VMIN-ALF IN POD-FLD.
           IF POD-NUM-VMAX-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-VMAX-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-VMAX IN POD-FLD TO POD-NUM-VMAX-EDT IN POD-EDT.
           MOVE POD-NUM-VMAX-EDT IN POD-EDT TO 
                POD-NUM-VMAX-ALF IN POD-FLD.
           IF POD-NUM-SMNV-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-SMNV-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-SMNV IN POD-FLD TO POD-NUM-SMNV-EDT IN POD-EDT.
           MOVE POD-NUM-SMNV-EDT IN POD-EDT TO 
                POD-NUM-SMNV-ALF IN POD-FLD.
           IF POD-NUM-SMXV-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-SMXV-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-SMXV IN POD-FLD TO POD-NUM-SMXV-EDT IN POD-EDT.
           MOVE POD-NUM-SMXV-EDT IN POD-EDT TO 
                POD-NUM-SMXV-ALF IN POD-FLD.
           IF POD-NUM-PREP-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PREP-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PREP IN POD-FLD TO POD-NUM-PREP-EDT IN POD-EDT.
           MOVE POD-NUM-PREP-EDT IN POD-EDT TO 
                POD-NUM-PREP-ALF IN POD-FLD.
           IF POD-NUM-PLRE-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PLRE-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PLRE IN POD-FLD TO POD-NUM-PLRE-EDT IN POD-EDT.
           MOVE POD-NUM-PLRE-EDT IN POD-EDT TO 
                POD-NUM-PLRE-ALF IN POD-FLD.
           IF POD-NUM-PNTE-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PNTE-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PNTE IN POD-FLD TO POD-NUM-PNTE-EDT IN POD-EDT.
           MOVE POD-NUM-PNTE-EDT IN POD-EDT TO 
                POD-NUM-PNTE-ALF IN POD-FLD.
           IF POD-NUM-PRES-LEN IN POD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO POD-NUM-PRES-LEN IN POD-FLD
                GO TO FIN-EDT-FLD-POD.
           MOVE POD-NUM-PRES IN POD-FLD TO POD-NUM-PRES-EDT IN POD-EDT.
           MOVE POD-NUM-PRES-EDT IN POD-EDT TO 
                POD-NUM-PRES-ALF IN POD-FLD.
       FIN-EDT-FLD-POD.
           EXIT.
      *<<<< EOF_BU

      * VALIDACION: PLAZO MINIMO DEBE SER <= PLAZO MAXIMO
       VAL-PMIN-PMAX SECTION.
       INI-VAL-PMIN-PMAX.
      * ICU : 01011991 + PLAZO MIN EN POD-FLD 
           MOVE POD-IND-PMIN IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE '01011991' TO FEC-FECH.
           MOVE POD-NUM-PMIN IN POD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.

      *LRH ini 7-SEP-1994
      *     IF POD-NUM-PMNE > ZEROES
      *         MOVE POD-IND-PMNE IN POD-FLD TO MSC-COD-CMSC IN MSC
      *         PERFORM OBT-CIC-PER

      *         MOVE WSS-FEC-FUNO TO FEC-FECH
      *         MOVE POD-NUM-PMNE IN POD-FLD TO WSS-NUM-PER
      *         PERFORM SEL-PER
      *         MOVE FEC-ITM1 TO WSS-NUM-DUNO
      *         MOVE FEC-ITM2 TO WSS-NUM-MUNO
      *         MOVE FEC-ITM3 TO WSS-NUM-SUNO
      *         MOVE FEC-ITM4 TO WSS-NUM-AUNO.
      *LRH fin 7-SEP-1994

      * ICU : 01011991 + PLAZO MAX EN POD-FLD 

           MOVE POD-IND-PMAX IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE '01011991' TO FEC-FECH.
           MOVE POD-NUM-PMAX IN POD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DDOS.
           MOVE FEC-ITM2 TO WSS-NUM-MDOS.
           MOVE FEC-ITM3 TO WSS-NUM-SDOS.
           MOVE FEC-ITM4 TO WSS-NUM-ADOS.

      *LRH ini 7-SEP-1994
      *     IF POD-NUM-PMXE > ZEROES
      *         MOVE POD-IND-PMXE IN POD-FLD TO MSC-COD-CMSC IN MSC
      *         PERFORM OBT-CIC-PER

      *         MOVE WSS-FEC-FDOS TO FEC-FECH
      *         MOVE POD-NUM-PMXE IN POD-FLD TO WSS-NUM-PER
      *         PERFORM SEL-PER
      *         MOVE FEC-ITM1 TO WSS-NUM-DDOS
      *         MOVE FEC-ITM2 TO WSS-NUM-MDOS
      *         MOVE FEC-ITM3 TO WSS-NUM-SDOS
      *         MOVE FEC-ITM4 TO WSS-NUM-ADOS.
      *LRH fin 7-SEP-1994

           IF WSS-FEC-FUNO > WSS-FEC-FDOS
      *         DEBE SER: PLAZO MINIMO <= PLAZO MAXIMO
                MOVE 'PMIN<=PMAX' TO MSG-COD-MENS
                GO TO FIN-VAL-PMIN-PMAX.
       FIN-VAL-PMIN-PMAX.
           EXIT.

       OBT-CIC-PER SECTION.
       INI-OBT-CIC-PER.
      * ISP: OBTIENE CIC DE UN CODIGO DE PERIODO CARGADO EN MSC-COD-CMSC
      *      Y LO ENTREGA EN WSS-CIC-PER
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-CIC-CMSC IN MSC     TO WSS-CIC-PER.
       FIN-OBT-CIC-PER.
           EXIT.

       SEL-PER SECTION.
       INI-SEL-PER.
      * ISP: OBTIENE EN FEC-FECH LA SUMA DE UNA FECHA CARGADA EN FEC-FEC
      *      + UN PERIODO ( WSS-CIC-PER Y WSS-NUM-PER )
           IF WSS-CIC-PER = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NDIA
           ELSE
           IF WSS-CIC-PER = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NMES
           ELSE
           IF WSS-CIC-PER = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
       FIN-SEL-PER.
           EXIT.

       CHK-DUPL SECTION.
       INI-CHK-DUPL.
           PERFORM DAP-FIO-POD.
           IF FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'KEY    DUPLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.


      * JVM:
      * VALIDACION DE LLAVES PARA COMANDO 'COP'
      * NO REQUIERE MKY 
       VAL-KEY-POD SECTION.
       INI-VAL-KEY-POD.
           PERFORM VAL-IKY-POD.
      *     PERFORM VAL-MKY-POD.
           PERFORM VAL-AKY-POD.
       FIN-VAL-KEY-POD.
           EXIT.
       
       VAL-IKY-POD SECTION.
       INI-VAL-IKY-POD.
           PERFORM VAL-POD-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-VCAM-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-TOPD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-AOPD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-NUM-IPOD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-NUM-IPOD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
       FIN-VAL-IKY-POD.
           EXIT.
       
      * VAL-MKY-POD SECTION.
      * INI-VAL-MKY-POD.
      * FIN-VAL-MKY-POD.
      *     EXIT.
       
       VAL-AKY-POD SECTION.
       INI-VAL-AKY-POD.
       FIN-VAL-AKY-POD.
           EXIT.
       
       VAL-POD-COD-VCAM SECTION.
       INI-VAL-POD-COD-VCAM.
           IF POD-COD-VCAM IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-VCAM IN POD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-VCAM IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-VCAM IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN POD-FLD.
       FIN-VAL-POD-COD-VCAM.
           EXIT.
       
       VAL-POD-COD-TOPD SECTION.
       INI-VAL-POD-COD-TOPD.
           IF POD-COD-TOPD IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-TOPD IN POD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TOPD IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TOPD IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPD IN POD-FLD.
       FIN-VAL-POD-COD-TOPD.
           EXIT.
       
       VAL-POD-COD-AOPD SECTION.
       INI-VAL-POD-COD-AOPD.
           IF POD-COD-AOPD IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-AOPD IN POD-FLD.
      *<<<< POD_COD_AOPD
           MOVE POD-COD-TOPD IN POD-FLD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD-FLD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD     TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-AOPD IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOPD IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOPD IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-AOPD.
           EXIT.
       
       VAL-POD-NUM-IPOD SECTION.
       INI-VAL-POD-NUM-IPOD.
       FIN-VAL-POD-NUM-IPOD.
           EXIT.
       
      *>>>> END
