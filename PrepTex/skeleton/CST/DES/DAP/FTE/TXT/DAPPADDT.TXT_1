*% NO_HDR_CST = TRUE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF WSS
      *<<<< WSS
       COPY DAPWGDDT.
       COPY GNSWGTDQ.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      * COPY GNSBGTDQ.
      *Modulo Generico Manejo de Transient Data
      * Le falta el accesar transient datas de otros CICS
       GNS-CHK-TDQ SECTION.
       INI-GNS-CHK-TDQ.
           MOVE TDQ-GET TO TDQ-CMND.
           PERFORM GNS-PRO-TDQ.
       FIN-GNS-CHK-TDQ.
           EXIT.

      **************************************************************

       GNS-ERR-TDQ SECTION.
       INI-GNS-ERR-TDQ.
           EXEC CICS HANDLE CONDITION
                     IOERR     (GNS-TDQ-IOE)
                     LENGERR   (GNS-TDQ-LEN)
                     NOSPACE   (GNS-TDQ-NOS)
                     NOTOPEN   (GNS-TDQ-NOT)
                     QIDERR    (GNS-TDQ-QID)
                     QZERO     (GNS-TDQ-QZE)
           END-EXEC.
       FIN-GNS-ERR-TDQ.
           EXIT.

       GNS-TDQ-IOE.
           MOVE 'IOERR EN TRANSIENT DATA ' TO FRM-MEN1.
           MOVE TDQ-COLA TO FRM-MEN2.
           GO TO TDQ-ERR-ABT.

       GNS-TDQ-LEN.
           MOVE 'ERROR DE LARGO EN TRANSIENT DATA ' TO FRM-MEN1.
           MOVE TDQ-COLA TO FRM-MEN2.
           GO TO TDQ-ERR-ABT.

       GNS-TDQ-NOS.
           MOVE 'ERROR DE ESPACIO EN TRANSIENT DATA ' TO FRM-MEN1.
           MOVE TDQ-COLA TO FRM-MEN2.
           GO TO TDQ-ERR-ABT.

       GNS-TDQ-NOT.
           MOVE 'ERROR : TRANSIENT DATA NO ABIERTA ' TO FRM-MEN1.
           MOVE TDQ-COLA TO FRM-MEN2.
           GO TO TDQ-ERR-ABT.

       GNS-TDQ-QID.
           MOVE 'NO EXISTE TRANSIENT DATA ' TO FRM-MEN1.
           MOVE TDQ-COLA TO FRM-MEN2.
           GO TO TDQ-ERR-ABT.

       GNS-TDQ-QZE.
           MOVE TDQ-STAT-QZE TO TDQ-STAT.
           GO TO FIN-GNS-PRO-TDQ.

       TDQ-ERR-ABT.
           MOVE 'GNSPPABT' TO SYS-PROG.
           MOVE +79        TO SYS-TCMA.
      *    MOVE FRM-MENS   TO SYS-CMMA.
           EXEC CICS XCTL
                     PROGRAM(SYS-PROG)
                     COMMAREA(SYS-MENS)
                     LENGTH(SYS-TCMA)
           END-EXEC.

       GNS-PRO-TDQ SECTION.
       INI-GNS-PRO-TDQ.
           MOVE TDQ-STAT-OKS TO TDQ-STAT.
           IF TDQ-CMND = TDQ-PUT
               GO TO GNS-PUT-TDQ
           ELSE
           IF TDQ-CMND = TDQ-GET
               GO TO GNS-GET-TDQ
           ELSE
           IF TDQ-CMND = TDQ-DEL
               GO TO GNS-DEL-TDQ.
           MOVE 'Comando invalido :' TO TDQ-MEN1.
           MOVE TDQ-CMND             TO TDQ-MEN2.
           EXEC CICS XCTL
                     PROGRAM('GNSPPABT')
                     COMMAREA(TDQ-MENS)
                     LENGTH(+79)
           END-EXEC.

       GNS-PUT-TDQ.
           EXEC CICS WRITEQ TD
                     QUEUE(TDQ-COLA)
                     FROM(TDQ-ITEM)
                     LENGTH(TDQ-LITM)
           END-EXEC.
       FIN-GNS-PUT-TDQ.
           GO TO FIN-GNS-PRO-TDQ.

       GNS-GET-TDQ.
           EXEC CICS READQ TD
                     QUEUE(TDQ-COLA)
                     INTO(TDQ-ITEM)
                     LENGTH(TDQ-LITM)
           END-EXEC.
       FIN-GNS-GET-TDQ.
           GO TO FIN-GNS-PRO-TDQ.

       GNS-DEL-TDQ.
           EXEC CICS DELETEQ TD
                     QUEUE(TDQ-COLA)
           END-EXEC.
       FIN-GNS-DEL-TDQ.
           GO TO FIN-GNS-PRO-TDQ.

       FIN-GNS-PRO-TDQ.
           EXIT.

      *>>>>
*% END
