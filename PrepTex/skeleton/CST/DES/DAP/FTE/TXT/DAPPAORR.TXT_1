*%! Codigo adicional para DAPPAORR
*% PGM_MSX = TRUE
*% IF SETTAG
*% FNCPQ = "080311"
*% VSNPQ = "08.09.03"
*% FNCPU = "080311"
*% VSNPU = "08.09.03"
*% END
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF WSS 
      *<<<< WSS 
*% IF  PGM_PTC
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
*% END
       COPY DAPWXORR.
       77  WSS-ORR-NUM-OFIC  VALUE ZEROES        PIC  9999.
       77  WSS-ORR-NUM-OFIC-L3 VALUE ZEROES        PIC  999.
       77  WSS-ORR-GLS-OFIC    VALUE SPACES        PIC  X(21).
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
      *>>>> WSS 
*% END
*% IF FIN_PGM_STAT
   *<<<<<FIN_PGM_STAT
           03 PGM-STAT.
              05 PGM-STAT-ORR.
                 88 PGM-STAT-ORR-NUL    VALUE '  '.
                 07 PGM-STT1-ORR        VALUE '2' PIC X(01).
                    88 PGM-STAT-ORR-OKS VALUE '0'.
                 07 PGM-STT2-ORR        VALUE '3' PIC X(01).
   *>>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE TSK-TERM-ALF    TO ORY-COD-TERM.
      *>>>> INI_FIO
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR

           IF SCR-CMND NOT = 'CON'
                GO TO FIN-PUT-SCR.

           PERFORM MOV-ORR VARYING FRM-IFLD FROM 1 BY 1
                 UNTIL FRM-IFLD > ORY-TOT-OCC-ORY.
               
           MOVE ORY-TSORD TO QUE-COLA.
           MOVE ORY-LEN-TSORY  TO QUE-LITM.
           MOVE ORY-MTI-VARI   TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF NOT SCR-OFRM-SRV
              MOVE QUE-DEL TO QUE-CMND
              PERFORM GNS-PRO-QUE.
                                   
      *>>>> FIN_PUT_SCR
*% END
*% IF FIOSTAT
      *<<<< FIOSTAT
                   IF MSG-COD-MENS = 'FIOSTAT23'
                       MOVE 'DAP' TO MSG-COD-SIST
                       MOVE 'CLIORRNEX' TO MSG-COD-MENS
                   END-IF
      *>>>> FIOSTAT
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM CLR-ORR VARYING FRM-IFLD FROM 1 BY 1 UNTIL
              FRM-IFLD > ORY-TOT-OCC-ORY.
      *>>>> CMN_ING
*% END
*% IF EOF
      *<<<< EOF
       MOV-ORR SECTION.
       INI-MOV-ORR.
           MOVE ORR-NUM-MESE IN ORR(FRM-IFLD) TO 
                ORY-NUM-MESE-EDT.
           MOVE ORY-NUM-MESE-EDT TO
                ORY-NUM-MESE IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-POSD IN ORR(FRM-IFLD) TO 
                ORY-VAL-POSD-EDT.
           MOVE ORY-VAL-POSD-EDT TO
                ORY-VAL-POSD IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-NEGD IN ORR(FRM-IFLD) TO 
                ORY-VAL-NEGD-EDT.
           MOVE ORY-VAL-NEGD-EDT TO
                ORY-VAL-NEGD IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-POSM IN ORR(FRM-IFLD) TO 
                ORY-VAL-POSM-EDT.
           MOVE ORY-VAL-POSM-EDT TO
                ORY-VAL-POSM IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-NEGM IN ORR(FRM-IFLD) TO 
                ORY-VAL-NEGM-EDT.
           MOVE ORY-VAL-NEGM-EDT TO
                ORY-VAL-NEGM IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-POSO IN ORR(FRM-IFLD) TO 
                ORY-VAL-POSO-EDT.
           MOVE ORY-VAL-POSO-EDT TO
                ORY-VAL-POSO IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-NEGO IN ORR(FRM-IFLD) TO 
                ORY-VAL-NEGO-EDT.
           MOVE ORY-VAL-NEGO-EDT TO
                ORY-VAL-NEGO IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-VAL-FACT IN ORR(FRM-IFLD) TO 
                ORY-VAL-FACT-EDT.
           MOVE ORY-VAL-FACT-EDT TO
                ORY-VAL-FACT IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-POSD IN ORR(FRM-IFLD) TO 
                ORY-SGV-POSD-EDT.
           MOVE ORY-SGV-POSD-EDT TO
                ORY-SGV-POSD IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-NEGD IN ORR(FRM-IFLD) TO 
                ORY-SGV-NEGD-EDT.
           MOVE ORY-SGV-NEGD-EDT TO
                ORY-SGV-NEGD IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-POSM IN ORR(FRM-IFLD) TO 
                ORY-SGV-POSM-EDT.
           MOVE ORY-SGV-POSM-EDT TO
                ORY-SGV-POSM IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-NEGM IN ORR(FRM-IFLD) TO 
                ORY-SGV-NEGM-EDT.
           MOVE ORY-SGV-NEGM-EDT TO
                ORY-SGV-NEGM IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-POSO IN ORR(FRM-IFLD) TO 
                ORY-SGV-POSO-EDT.
           MOVE ORY-SGV-POSO-EDT TO
                ORY-SGV-POSO IN ORY-MTI-VARI(FRM-IFLD).

           MOVE ORR-SGV-NEGO IN ORR(FRM-IFLD) TO 
                ORY-SGV-NEGO-EDT.
           MOVE ORY-SGV-NEGO-EDT TO
                ORY-SGV-NEGO IN ORY-MTI-VARI(FRM-IFLD).

       FIN-MOV-ORR.
           EXIT.

       CLR-ORR SECTION.
       INI-CLR-ORR.
           MOVE FRM-IFLD TO ORR-NUM-MESE IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-POSD IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-NEGD IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-POSM IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-NEGM IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-POSO IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-NEGO IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-VAL-FACT IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-POSD IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-NEGD IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-POSM IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-NEGM IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-POSO IN ORR(FRM-IFLD).
           MOVE ZEROES TO ORR-SGV-NEGO IN ORR(FRM-IFLD).
       FIN-CLR-ORR.
           EXIT.
       COPY GNSBVIND.
       COPY GNSBVNUM.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
      *>>>> EOF
*% END
