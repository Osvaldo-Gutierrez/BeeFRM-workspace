      * MODULO: DAPBGRVI
      * ----------------
      *
        BUS-RVI SECTION.
        INI-BUS-RVI.
           MOVE RVI-STAT-NOT TO RVI-COD-STAT IN RVI-VARI.
           MOVE 'DAP'   TO FIO-SIST.
           MOVE 'DAP'   TO TAB-COD-SIST.
           MOVE 'RVI'   TO TAB-COD-TTAB IN TAB.
           MOVE 'RVI'   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = 'S'
              GO TO FIN-BUS-RVI
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO RVI-GLS-DESC IN RVI-VARI
      *       Inicio de validacion de las fechas obtenidas de la tabla
              MOVE RVI-FEC-FINT IN RVI-VARI TO FEC-FECH
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-FBLK-N   TO FEC-FBLK
              MOVE FEC-CHOY-N   TO FEC-CHOY
              MOVE FEC-VHBL-N   TO FEC-VHBL
              MOVE FEC-VAL-FEC  TO FEC-CMND
              PERFORM PRO-FEC
              IF NOT FEC-STAT-OKS
                 GO TO FIN-BUS-RVI
              ELSE
                 MOVE RVI-FEC-FFIT IN RVI-VARI TO FEC-FECH
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-FBLK-N   TO FEC-FBLK
                 MOVE FEC-CHOY-N   TO FEC-CHOY
                 MOVE FEC-VHBL-N   TO FEC-VHBL
                 MOVE FEC-VAL-FEC  TO FEC-CMND
                 PERFORM PRO-FEC
                 IF NOT FEC-STAT-OKS
                    GO TO FIN-BUS-RVI
                 ELSE
                    MOVE RVI-FEC-FOKT IN RVI-VARI TO FEC-FECH
                    MOVE FEC-FORM-FEC TO FEC-FORM
                    MOVE FEC-FBLK-N   TO FEC-FBLK
                    MOVE FEC-CHOY-N   TO FEC-CHOY
                    MOVE FEC-VHBL-N   TO FEC-VHBL
                    MOVE FEC-VAL-FEC  TO FEC-CMND
                    PERFORM PRO-FEC
                    IF NOT FEC-STAT-OKS
                       GO TO FIN-BUS-RVI
                    ELSE
                       MOVE RVI-STAT-OKS TO RVI-COD-STAT IN RVI-VARI.

      * SE HACEN EL CAMBIO DE DDMMSSAA --> SSAAMMDD
           MOVE RVI-NUM-SINT IN RVI-VARI TO RVI-NUM-SINR IN RVI-VARI.
           MOVE RVI-NUM-AINT IN RVI-VARI TO RVI-NUM-AINR IN RVI-VARI.
           MOVE RVI-NUM-MINT IN RVI-VARI TO RVI-NUM-MINR IN RVI-VARI.
           MOVE RVI-NUM-DINT IN RVI-VARI TO RVI-NUM-DINR IN RVI-VARI.
      *
           MOVE RVI-NUM-SFIT IN RVI-VARI TO RVI-NUM-SFIR IN RVI-VARI.
           MOVE RVI-NUM-AFIT IN RVI-VARI TO RVI-NUM-AFIR IN RVI-VARI.
           MOVE RVI-NUM-MFIT IN RVI-VARI TO RVI-NUM-MFIR IN RVI-VARI.
           MOVE RVI-NUM-DFIT IN RVI-VARI TO RVI-NUM-DFIR IN RVI-VARI.
      *
           MOVE RVI-NUM-SOKT IN RVI-VARI TO RVI-NUM-SOKR IN RVI-VARI.
           MOVE RVI-NUM-AOKT IN RVI-VARI TO RVI-NUM-AOKR IN RVI-VARI.
           MOVE RVI-NUM-MOKT IN RVI-VARI TO RVI-NUM-MOKR IN RVI-VARI.
           MOVE RVI-NUM-DOKT IN RVI-VARI TO RVI-NUM-DOKR IN RVI-VARI.

        FIN-BUS-RVI.
           EXIT.
