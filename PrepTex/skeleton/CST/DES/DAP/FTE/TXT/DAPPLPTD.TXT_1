*%! Codigo adicional para archivo PTD
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.

      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.

      *Entidades de DAP
       COPY DAPBRPOD.
       COPY DAPWG004.

       01  WSS-VARI.
           03  WSS-FEC-FPRI.
               05  WSS-NUM-SPRI                      PIC 9(02).
               05  WSS-NUM-APRI                      PIC 9(02).
               05  WSS-NUM-MPRI                      PIC 9(02).
               05  WSS-NUM-DPRI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-I                  VALUE 0        PIC 9(03).
           03  WSS-STP-OLD                           PIC 9(14).
           03  WSS-COD-OFIC                          PIC X(03).
           03  WSS-COD-COPD.
               05  WSS-COD-TOPD                      PIC X(03).
               05  WSS-COD-AOPD                      PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POD-REQA==.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
      * Captura codigo de oficina y fechas parametro
      *>>>>
*% END
*% IF PH_PTD
      *<<<< IF PH_PTD
      *Recupera glosa oficina
           IF PTD-COD-OFIC IN PTD = '*' 
              MOVE 'TODAS' TO WSS-GLS-OFIC IN WSS-PTD
           ELSE
              MOVE PTD-COD-OFIC IN PTD TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-PTD.
      *Recupera glosa de moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-PTD.
      *Recupera glosa tipo operacion
           IF PTD-COD-TOPD IN PTD = '*' 
              MOVE 'TODAS' TO WSS-GLS-TOPD IN WSS-PTD
           ELSE
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TIO' TO TAB-COD-TTAB IN TAB
              MOVE PTD-COD-TOPD IN PTD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOPD IN WSS-PTD.
      *Recupera glosa cod. auxiliar
           IF PTD-COD-AOPD IN PTD = '*'
              MOVE 'TODAS' TO WSS-GLS-AOPD IN WSS-PTD
           ELSE
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'AUX' TO TAB-COD-TTAB IN TAB
              MOVE PTD-COD-TOPD IN PTD TO WSS-COD-TOPD IN WSS-VARI
              MOVE PTD-COD-AOPD IN PTD TO WSS-COD-AOPD IN WSS-VARI
              MOVE WSS-COD-COPD IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AOPD IN WSS-PTD.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *JVM: Abre otros archivos VSAM
           MOVE FIO-INP TO FIO-CMND.
           PERFORM DAP-FIO-POD.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * ISP: DAPBG004
           MOVE PTD-STP-IPTD IN PTD TO WSS-STP-OLD IN WSS-VARI.

           PERFORM CMP-FEC-PTD.

           MOVE PTD-NUM-DPTD IN PTD TO WSS-NUM-DPTD IN WSS-PTD.
           MOVE PTD-NUM-MPTD IN PTD TO WSS-NUM-MPTD IN WSS-PTD.
           MOVE PTD-NUM-SPTD IN PTD TO WSS-NUM-SPTD IN WSS-PTD.
           MOVE PTD-NUM-APTD IN PTD TO WSS-NUM-APTD IN WSS-PTD.
           MOVE PTD-HRA-HRPT IN PTD TO WSS-HRA-HRPT IN WSS-PTD.

           MOVE WSS-STP-OLD IN WSS-VARI TO PTD-STP-IPTD IN PTD.

      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
      *Ubica registro en OPD por fecha
      *     MOVE 'OPD-FEC-FREA' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
      *Controla ingreso de registros por fecha termino
      *     IF OPD-FEC-FREA IN OPD > WSS-FEC-FTER IN WSS-VARI
      *        GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *JVM: Limpia FIO-AKEY 
           MOVE SPACES TO FIO-AKEY.

      *JVM: Recupera tipo de tasa de POD.
           MOVE PTD-COD-VCAM IN PTD TO POD-COD-VCAM IN POD.
           MOVE PTD-COD-TOPD IN PTD TO POD-COD-TOPD IN POD.
           MOVE PTD-COD-AOPD IN PTD TO POD-COD-AOPD IN POD.
           MOVE ZEROES              TO POD-NUM-IPOD IN POD.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           IF NOT FIO-STAT-OKS
               MOVE 'POD    NEX' TO MSG-COD-MENS.
           IF POD-COD-STAT IN POD = 'N'
               MOVE 'POD    NVG' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
              MOVE 'DAP'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO WSS-GLS-TINT IN WSS-PTD
           ELSE
              MOVE 'TAB'        TO TAB-COD-SIST
              MOVE 'INT'        TO TAB-COD-TTAB IN TAB            
              MOVE POD-COD-TINT IN POD TO TAB-COD-CTAB IN TAB            
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TINT IN WSS-PTD.

      *    busca cic de la moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-CIC-CTAB IN TAB = '0999  '
               MOVE 'PTDMTO =$'  TO MSG-COD-MENS
           ELSE
               MOVE 'PTDMTO <>$' TO MSG-COD-MENS.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO WSS-GLS-DESC IN WSS-PTD.

      *Recupera montos.
           IF MSG-COD-MENS = 'PTDMTO =$' 
              PERFORM GEN-PESOS
           ELSE
              PERFORM GEN-NO-PESOS.     

      *Recupera tasa de pizarra.
           MOVE PTD-SGV-TMN1 IN PTD(1) TO WSS-SGV-TMN1 IN WSS-PTD.
           MOVE PTD-SGV-TMN2 IN PTD(1) TO WSS-SGV-TMN2 IN WSS-PTD.
           MOVE PTD-SGV-TMN3 IN PTD(1) TO WSS-SGV-TMN3 IN WSS-PTD.
           MOVE PTD-SGV-TMN4 IN PTD(1) TO WSS-SGV-TMN4 IN WSS-PTD.
           MOVE PTD-SGV-TMN5 IN PTD(1) TO WSS-SGV-TMN5 IN WSS-PTD.
           MOVE PTD-SGV-TMN6 IN PTD(1) TO WSS-SGV-TMN6 IN WSS-PTD.
           MOVE PTD-SGV-TMN7 IN PTD(1) TO WSS-SGV-TMN7 IN WSS-PTD.
           MOVE PTD-SGV-TMN8 IN PTD(1) TO WSS-SGV-TMN8 IN WSS-PTD.
           MOVE PTD-SGV-TMN9 IN PTD(1) TO WSS-SGV-TMN9 IN WSS-PTD.
           MOVE PTD-SGV-TMN0 IN PTD(1) TO WSS-SGV-TMN0 IN WSS-PTD.

      *Recupera tasas maximas y spread adicional.
           PERFORM REC-TMAX.
           PERFORM REC-SPRD.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *JVM: Limpia FIO-AKEY 
           MOVE SPACES TO FIO-AKEY.
      *>>>> FIN_GEN_OUT
*% END
*% IF EOF
      *<<<< EOF
       GEN-PESOS SECTION.
       INI-GEN-PESOS.
           IF PTD-VAL-MNTO IN PTD(1) NOT > ZEROES
              MOVE PTD-VAL-MNTO IN PTD(1) TO
                                    WSS-VAL-MNT1 IN WSS-PTD
           ELSE
              DIVIDE PTD-VAL-MNTO IN PTD(1) BY 1000 
                                  GIVING WSS-VAL-MNT1 IN WSS-PTD.
           IF PTD-VAL-MNTO IN PTD(2) NOT > ZEROES
              MOVE PTD-VAL-MNTO IN PTD(2) TO
                                    WSS-VAL-MNT2 IN WSS-PTD
           ELSE
              DIVIDE PTD-VAL-MNTO IN PTD(2) BY 1000 
                                  GIVING WSS-VAL-MNT2 IN WSS-PTD.
           IF PTD-VAL-MNTO IN PTD(3) NOT > ZEROES
              MOVE PTD-VAL-MNTO IN PTD(3) TO
                                    WSS-VAL-MNT3 IN WSS-PTD
           ELSE
              DIVIDE PTD-VAL-MNTO IN PTD(3) BY 1000 
                                  GIVING WSS-VAL-MNT3 IN WSS-PTD.
           IF PTD-VAL-MNTO IN PTD(4) NOT > ZEROES
              MOVE PTD-VAL-MNTO IN PTD(4) TO
                                    WSS-VAL-MNT4 IN WSS-PTD
           ELSE
              DIVIDE PTD-VAL-MNTO IN PTD(4) BY 1000 
                                  GIVING WSS-VAL-MNT4 IN WSS-PTD.
           IF PTD-VAL-MNTO IN PTD(5) NOT > ZEROES
              MOVE PTD-VAL-MNTO IN PTD(5) TO
                                    WSS-VAL-MNT5 IN WSS-PTD
           ELSE
              DIVIDE PTD-VAL-MNTO IN PTD(5) BY 1000 
                                  GIVING WSS-VAL-MNT5 IN WSS-PTD.
       FIN-GEN-PESOS.
           EXIT.

       GEN-NO-PESOS SECTION.
       INI-GEN-NO-PESOS.
              MOVE PTD-VAL-MNTO IN PTD(1) TO
                                    WSS-VAL-MNT1 IN WSS-PTD.
              MOVE PTD-VAL-MNTO IN PTD(2) TO
                                    WSS-VAL-MNT2 IN WSS-PTD.
              MOVE PTD-VAL-MNTO IN PTD(3) TO
                                    WSS-VAL-MNT3 IN WSS-PTD.
              MOVE PTD-VAL-MNTO IN PTD(4) TO
                                    WSS-VAL-MNT4 IN WSS-PTD.
              MOVE PTD-VAL-MNTO IN PTD(5) TO
                                    WSS-VAL-MNT5 IN WSS-PTD.
       FIN-GEN-PESOS.
           EXIT.

       REC-TMAX SECTION.
       INI-REC-TMAX.
      *Recupera tasa de pizarra.
           MOVE PTD-SGV-TMX1 IN PTD(1) TO WSS-SGV-TM11 IN WSS-PTD.
           MOVE PTD-SGV-TMX1 IN PTD(2) TO WSS-SGV-TM12 IN WSS-PTD.
           MOVE PTD-SGV-TMX1 IN PTD(3) TO WSS-SGV-TM13 IN WSS-PTD.
           MOVE PTD-SGV-TMX1 IN PTD(4) TO WSS-SGV-TM14 IN WSS-PTD.
           MOVE PTD-SGV-TMX1 IN PTD(5) TO WSS-SGV-TM15 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX2 IN PTD(1) TO WSS-SGV-TM21 IN WSS-PTD.
           MOVE PTD-SGV-TMX2 IN PTD(2) TO WSS-SGV-TM22 IN WSS-PTD.
           MOVE PTD-SGV-TMX2 IN PTD(3) TO WSS-SGV-TM23 IN WSS-PTD.
           MOVE PTD-SGV-TMX2 IN PTD(4) TO WSS-SGV-TM24 IN WSS-PTD.
           MOVE PTD-SGV-TMX2 IN PTD(5) TO WSS-SGV-TM25 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX3 IN PTD(1) TO WSS-SGV-TM31 IN WSS-PTD.
           MOVE PTD-SGV-TMX3 IN PTD(2) TO WSS-SGV-TM32 IN WSS-PTD.
           MOVE PTD-SGV-TMX3 IN PTD(3) TO WSS-SGV-TM33 IN WSS-PTD.
           MOVE PTD-SGV-TMX3 IN PTD(4) TO WSS-SGV-TM34 IN WSS-PTD.
           MOVE PTD-SGV-TMX3 IN PTD(5) TO WSS-SGV-TM35 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX4 IN PTD(1) TO WSS-SGV-TM41 IN WSS-PTD.
           MOVE PTD-SGV-TMX4 IN PTD(2) TO WSS-SGV-TM42 IN WSS-PTD.
           MOVE PTD-SGV-TMX4 IN PTD(3) TO WSS-SGV-TM43 IN WSS-PTD.
           MOVE PTD-SGV-TMX4 IN PTD(4) TO WSS-SGV-TM44 IN WSS-PTD.
           MOVE PTD-SGV-TMX4 IN PTD(5) TO WSS-SGV-TM45 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX5 IN PTD(1) TO WSS-SGV-TM51 IN WSS-PTD.
           MOVE PTD-SGV-TMX5 IN PTD(2) TO WSS-SGV-TM52 IN WSS-PTD.
           MOVE PTD-SGV-TMX5 IN PTD(3) TO WSS-SGV-TM53 IN WSS-PTD.
           MOVE PTD-SGV-TMX5 IN PTD(4) TO WSS-SGV-TM54 IN WSS-PTD.
           MOVE PTD-SGV-TMX5 IN PTD(5) TO WSS-SGV-TM55 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX6 IN PTD(1) TO WSS-SGV-TM61 IN WSS-PTD.
           MOVE PTD-SGV-TMX6 IN PTD(2) TO WSS-SGV-TM62 IN WSS-PTD.
           MOVE PTD-SGV-TMX6 IN PTD(3) TO WSS-SGV-TM63 IN WSS-PTD.
           MOVE PTD-SGV-TMX6 IN PTD(4) TO WSS-SGV-TM64 IN WSS-PTD.
           MOVE PTD-SGV-TMX6 IN PTD(5) TO WSS-SGV-TM65 IN WSS-PTD.

      *
           MOVE PTD-SGV-TMX7 IN PTD(1) TO WSS-SGV-TM71 IN WSS-PTD.
           MOVE PTD-SGV-TMX7 IN PTD(2) TO WSS-SGV-TM72 IN WSS-PTD.
           MOVE PTD-SGV-TMX7 IN PTD(3) TO WSS-SGV-TM73 IN WSS-PTD.
           MOVE PTD-SGV-TMX7 IN PTD(4) TO WSS-SGV-TM74 IN WSS-PTD.
           MOVE PTD-SGV-TMX7 IN PTD(5) TO WSS-SGV-TM75 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX8 IN PTD(1) TO WSS-SGV-TM81 IN WSS-PTD.
           MOVE PTD-SGV-TMX8 IN PTD(2) TO WSS-SGV-TM82 IN WSS-PTD.
           MOVE PTD-SGV-TMX8 IN PTD(3) TO WSS-SGV-TM83 IN WSS-PTD.
           MOVE PTD-SGV-TMX8 IN PTD(4) TO WSS-SGV-TM84 IN WSS-PTD.
           MOVE PTD-SGV-TMX8 IN PTD(5) TO WSS-SGV-TM85 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX9 IN PTD(1) TO WSS-SGV-TM91 IN WSS-PTD.
           MOVE PTD-SGV-TMX9 IN PTD(2) TO WSS-SGV-TM92 IN WSS-PTD.
           MOVE PTD-SGV-TMX9 IN PTD(3) TO WSS-SGV-TM93 IN WSS-PTD.
           MOVE PTD-SGV-TMX9 IN PTD(4) TO WSS-SGV-TM94 IN WSS-PTD.
           MOVE PTD-SGV-TMX9 IN PTD(5) TO WSS-SGV-TM95 IN WSS-PTD.
      *
           MOVE PTD-SGV-TMX0 IN PTD(1) TO WSS-SGV-TM01 IN WSS-PTD.
           MOVE PTD-SGV-TMX0 IN PTD(2) TO WSS-SGV-TM02 IN WSS-PTD.
           MOVE PTD-SGV-TMX0 IN PTD(3) TO WSS-SGV-TM03 IN WSS-PTD.
           MOVE PTD-SGV-TMX0 IN PTD(4) TO WSS-SGV-TM04 IN WSS-PTD.
           MOVE PTD-SGV-TMX0 IN PTD(5) TO WSS-SGV-TM05 IN WSS-PTD.
       FIN-REC-TMAX.
           EXIT.

       REC-SPRD SECTION.
       INI-REC-SPRD.
      *Recupera spread adicional.
           MOVE PTD-SGV-TADC IN PTD(1) TO WSS-SGV-TAD1 IN WSS-PTD.
           MOVE PTD-SGV-TADC IN PTD(2) TO WSS-SGV-TAD2 IN WSS-PTD.
           MOVE PTD-SGV-TADC IN PTD(3) TO WSS-SGV-TAD3 IN WSS-PTD.
           MOVE PTD-SGV-TADC IN PTD(4) TO WSS-SGV-TAD4 IN WSS-PTD.
           MOVE PTD-SGV-TADC IN PTD(5) TO WSS-SGV-TAD5 IN WSS-PTD.
       FIN-REC-SPRD.
           EXIT.


      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.

      *Entidades  de TAB
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVUSR.

      *Entidades  de DAP
       COPY DAPBG004.
       COPY DAPBFPOD.
      *>>>>
*% END
