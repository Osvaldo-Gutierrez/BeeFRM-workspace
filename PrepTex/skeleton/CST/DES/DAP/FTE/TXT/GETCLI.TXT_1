Codigo adicional para busqueda y validacion de cliente cuando este es parte de las llaves

Codigo adicional en programa

*% IF WSS
      *<<<< WSS
      *Entidades de SGC
       COPY SGCBRDBC.

       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *>>>> WSS
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>> WSS_DTC
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF DBC-NUM-ICLI IN {frm}-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN {frm}-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN {frm}-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN {frm}-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN {frm}-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO {cai} IN {frm}-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO {iic} IN {frm}-FLD
           ELSE
           IF DBC-GLS-NOMC IN {frm}-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE SPACES TO DBC-GLS-NOMC IN DBC

               MOVE DBC-GLS-NOMC IN {frm}-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN {frm}-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN {frm}-FLD
                   MOVE SPACES TO DBC-IND-ICLI IN {frm}-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN {frm}-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN {frm}-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN {frm}-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN {frm}-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN {frm}-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN {frm}-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO {cai} IN {frm}-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO {iic} IN {frm}-FLD.
      *>>>> FND_KEY
*% END
*% IF EOF
      *<<<< EOF

      *Entidades de SGC
       COPY SGCBFDBC.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
      *>>>> EOF
*% END
