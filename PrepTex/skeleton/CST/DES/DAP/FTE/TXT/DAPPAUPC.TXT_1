*%! Codigo adicional para programa UPC
*% IF SETTAG
*% FNCPQ = "130810"
*% VSNPQ = "13.08.10"
*% FNCPU = "130810"
*% VSNPU = "13.08.10"
*% END
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*%
*% IF WSS
      *<<<< WSS
       77  WSS-IDX-I    VALUE ZEROES PIC 9(03).
       COPY DAPWGUPC.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *>>>>
*% END
*% IF INI_FIO_IBM
      *<<<< INI_FIO
      *>>>> INI_FIO_IBM
*% END
*% IF FND_KEY_CMND
      *<<<< FND_KEY_CMND
           GO TO FND-KEY-UPC.
      *>>>> FND_KEY_CMND
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      *>>>> FND_KEY
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      
       FND-KEY-UPC.
       
           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-OPD.

           MOVE OPD-NUM-DREA IN UPC-FLD TO UPC-NUM-DREA.
           MOVE OPD-NUM-MREA IN UPC-FLD TO UPC-NUM-MREA.
           MOVE OPD-NUM-SREA IN UPC-FLD TO UPC-NUM-SREA.
           MOVE OPD-NUM-AREA IN UPC-FLD TO UPC-NUM-AREA.

           MOVE OPD-NUM-DTER IN UPC-FLD TO UPC-NUM-DTER.
           MOVE OPD-NUM-MTER IN UPC-FLD TO UPC-NUM-MTER.
           MOVE OPD-NUM-STER IN UPC-FLD TO UPC-NUM-STER.
           MOVE OPD-NUM-ATER IN UPC-FLD TO UPC-NUM-ATER.

           MOVE OPD-NUM-PVEN IN UPC-FLD TO UPC-NUM-PVEN.
           MOVE OPD-IND-PVEN IN UPC-FLD TO UPC-IND-PVEN.

           MOVE FRM-COD-MODA IN UPC-FLD TO UPC-COD-MODA .

           PERFORM PRO-UPC.

      * SETEA FIO-STAT-OKS NUEVAMENTE, PARA NO CONSIDERAR ERRORES
      * DE FIO-STAT GENERADO EN PRO-FEC INVOCADO POR PRO-UPC
      
           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-OPD.

           MOVE UPC-COD-STAT TO FRM-COD-STAT IN UPC-FLD.
           
           MOVE UPC-GLS-STAT TO FRM-GLS-STAT IN UPC-FLD.

           MOVE UPC-COD-PLZO TO OPD-COD-PLZO IN OPD.

           IF UPC-COD-TALG = UPC-CTE-TALG-TPZ
               MOVE UPC-COD-TALG TO FRM-COD-TTPZ IN UPC-FLD
           ELSE
           IF UPC-COD-TALG = UPC-CTE-TALG-CFB
               MOVE UPC-COD-TALG TO FRM-COD-TCFB IN UPC-FLD
           ELSE
           IF UPC-COD-TALG = UPC-CTE-TALG-ADD
               MOVE UPC-COD-TALG TO FRM-COD-AADD IN UPC-FLD.

           MOVE UPC-COD-BISI TO FRM-COD-BISI IN UPC-FLD.

           MOVE UPC-NUM-DBIS TO FRM-NUM-DBIS IN UPC-FLD.
           MOVE UPC-NUM-MBIS TO FRM-NUM-MBIS IN UPC-FLD.
           MOVE UPC-NUM-SBIS TO FRM-NUM-SBIS IN UPC-FLD.
           MOVE UPC-NUM-ABIS TO FRM-NUM-ABIS IN UPC-FLD.

           MOVE UPC-TOT-PLZO TO FRM-NUM-TPZO IN UPC-FLD.

           PERFORM PUT-CODS VARYING WSS-IDX-I FROM 1 BY 1 UNTIL
               WSS-IDX-I > UPC-TOT-PLZO.


      *>>>> FIN_FND_KEY
*% END
*% IF FIN_SCR_ACC
      *<<<< FIN_SCR_ACC
      *>>>> FIN_SCR_ACC
*% END
*% IF INI_SCR_DMSG
*% IF PGM_PQ
      *<<<< INI_SCR_DMSG
      *>>>> INI_SCR_DMSG
*% END
*% END
*% IF FIN_PUT_SCR
      *<<<< PUT_SCR
      *>>>> PUT_SCR
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR
      *>>>> FIN_PUT_SCR
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
*% END
*% IF POST_SCR_PUTA
      *<<<< POST_SCR_PUTA
      *>>>> POST_SCR_PUTA
*% END
*% IF EOF
      *<<<< EOF

       COPY DAPBGUPC.
       COPY GNSBPFEC.

       PUT-CODS SECTION.
       INI-PUT-CODS.
           MOVE UPC-IND-PLZO IN UPC-VEC-PLZO(WSS-IDX-I) TO
                FRM-COD-PLZO IN UPC-FLD(WSS-IDX-I).
       FIN-PUT-CODS.
           EXIT.
      *>>>> EOF
*% END
