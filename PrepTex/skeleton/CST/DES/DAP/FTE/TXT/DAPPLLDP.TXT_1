*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *RAEL INI 15-09-1995
           SELECT RPTNDP         ASSIGN TO        UT-S-RPTNDP.
      *RAEL FIN 15-09-1995
      *>>>>
*% END
*% IF RR
      *<<<< RR
      *JVM: Tasa interes de la renovacion
           03 OPD-SGV-TINR            PIC S9(03)V9(04).
           03 OPD-VAL-SINT            PIC S9(11)V9(04).
           03 CAD-CAI-IOPD            PIC X(04).
           03 CAD-IIC-IOPD            PIC X(08).
      *>>>>
*% END
*% IF FD_RPT
      *<<<< FD_RPT
      * RAEL INI  21-SEP-1995
       FD  RPTNDP LABEL RECORDS OMITTED
           REPORT IS RPT-NDP
      * RAEL FIN  21-SEP-1995
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY DAPRWLD1.
      *LRH ini 16-NOV-1994
       01  WSS-LD2.
           03 WSS-GLS-MSG4            PIC X(70).
           03 WSS-GLS-MSG5            PIC X(70).
           03 WSS-GLS-MSG6            PIC X(70).
           03 WSS-GLS-MSG7            PIC X(70).
      *LRH fin 16-NOV-1994


      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGPES.
       COPY GNSWGINT.
       COPY GNSWGCVI.
      *RVM-BEE-INI 25-JUN-1997
       COPY GNSWGBAR.
      *RVM-BEE-FIN 25-JUN-1997
      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRRCC.
       COPY DAPBRVEN.
       COPY DAPBRCAD.
      *Entidades de SGC
       COPY SGCBRDBC.
       COPY SGCBRRCD.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
      *Entidades de DAP
       COPY DAPBROPD REPLACING ==OPD== BY ==BKPOPD==.

       01  WSS-VARI.
           03  WSS-CON-MANO   VALUE ZEROES           PIC 9(05).
           03  WSS-CON-CORR   VALUE ZEROES           PIC 9(05).
           03  WSS-COD-PESO                          PIC X(06).
           03  WSS-COD-RDOL                          PIC X(06).
           03  WSS-COD-UEFE                          PIC X(06).
           03  WSS-COD-DOLL                          PIC X(06).
           03  WSS-SGV-FREA           VALUE ZEROS    PIC S9(11)V9999.
           03  WSS-SGV-FLIQ           VALUE ZEROS    PIC S9(11)V9999.
           03  WSS-SGV-FVEN           VALUE ZEROS    PIC S9(11)V9999.
           03  WSS-COD-VCAM.
               05  WSS-MSC-TVAL                      PIC X(01).
               05  WSS-COD-CVAL                      PIC X(03).
               05  WSS-COD-TCAM                      PIC X(02).
           03  WSS-COD-TINT.
               05  WSS-COD-BCTI                      PIC X(01).
               05  WSS-COD-PBTI                      PIC X(01).
               05  WSS-COD-MCTI                      PIC X(02).
               05 WSS-IND-MCTI REDEFINES WSS-COD-MCTI.
                  07 WSS-COD-BPBT                    PIC X(01).
                  07 WSS-COD-SPBT                    PIC X(01).
               05  WSS-COD-CVTI                      PIC X(03).
               05  WSS-COD-TFPR                      PIC X(01).
               05  WSS-NUM-PREP                      PIC 9(03).
               05  WSS-MSC-PREP                      PIC X(01).
           03  WSS-IND-CVTI.
               05  WSS-GLS-TVTI                      PIC X(01).
               05  WSS-GLS-CVTI                      PIC X(03).
               05  WSS-IND-PBTI                      PIC X(01).
           03  WSS-FEC-FPRO.
               05  WSS-NUM-DPRO                      PIC 9(02).
               05  WSS-NUM-MPRO                      PIC 9(02).
               05  WSS-NUM-SPRO                      PIC 9(02).
               05  WSS-NUM-APRO                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-FEC-FCZO.
               05  WSS-NUM-SCZO                      PIC 9(02).
               05  WSS-NUM-ACZO                      PIC 9(02).
               05  WSS-NUM-MCZO                      PIC 9(02).
               05  WSS-NUM-DCZO                      PIC 9(02).
           03  WSS-FEC-FUNO.
               05  WSS-NUM-SUNO                      PIC 9(02).
               05  WSS-NUM-AUNO                      PIC 9(02).
               05  WSS-NUM-MUNO                      PIC 9(02).
               05  WSS-NUM-DUNO                      PIC 9(02).
           03  WSS-FEC-FPAS.
               05  WSS-NUM-SPAS                      PIC 9(02).
               05  WSS-NUM-APAS                      PIC 9(02).
               05  WSS-NUM-MPAS                      PIC 9(02).
               05  WSS-NUM-DPAS                      PIC 9(02).
           03  WSS-GLS-ABRV             VALUE SPACES PIC X(05).
           03  WSS-GLS-DCOR             VALUE SPACES PIC X(12).
           03  WSS-IND-MCLI             VALUE SPACES PIC X(01).
           03  WSS-STAT-RCC             VALUE ZEROES PIC 9(01).
           03  WSS-COD-OFIC             VALUE SPACES PIC X(03).
           03  WSS-CIC-IOPD.
               05  WSS-CAI-IOPD         VALUE SPACES PIC X(04).
               05  WSS-IIC-IOPD         VALUE SPACES PIC X(08).
           03  WSS-COD-LUGA.
               05 WSS-COD-COMU                       PIC X(04).
               05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07 WSS-IND-PAIS                    PIC X(01).
                  07 WSS-COD-PAIS                    PIC X(03).
           03  WSS-GLS-DEST.
               05  WSS-GLS-DES1                      PIC X(20).
               05  WSS-GLS-DES2                      PIC X(24).
           03  WSS-GLS-MSG1.
               05  WSS-GLS-MSG11                     PIC X(36).
               05  WSS-GLS-MSG12                     PIC X(35).
           03  WSS-GLS-MSG2.
               05  WSS-GLS-MSG21                     PIC X(35).
               05  WSS-GLS-MSG22                     PIC X(10).
               05  WSS-NUM-TASA                      PIC ZZ9.
               05  WSS-GLS-TASA                      PIC X(01).
               05  WSS-DEC-TASA                      PIC 9(02).
               05  WSS-GLS-MSG23.
                   07  WSS-GLS-FIL1                  PIC X(02).
                   07  WSS-GLS-BCTI                  PIC X(04).
                   07  WSS-GLS-FIL2                  PIC X(01).
                   07  WSS-GLS-PBTI                  PIC X(07).
                   07  WSS-GLS-FIL3                  PIC X(01).
                   07  WSS-GLS-MCTI                  PIC X(04).
           03  WSS-SGV-TASA                          PIC 9(03)V99.
           03  WSS-SGV-TASA-RED REDEFINES WSS-SGV-TASA.
               05  WSS-NUM-TAS                       PIC 9(03).
               05  WSS-DEC-TAS                       PIC 9(02).
           03  WSS-LEI-OPD              VALUE ZEROES PIC 9(06).
           03  WSS-GRA-OPD              VALUE ZEROES PIC 9(06).
           03  WSS-NUM-DREA             VALUE ZEROES PIC 9(05).
           03  WSS-NUM-PNTE             VALUE ZEROES PIC 9(05).
           03  WSS-NUM-DBUS             VALUE ZEROES PIC 9(01).
      *DAD ini  21-OCT-1994    (Memo.06-10-94)
           03 WSS-IND                                PIC 9(02).
           03 WSS-GLS-MAIL.
              05 WSS-GLS-MAI1.
                 07 WSS-IND-MAI1     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI2.
                 07 WSS-IND-MAI2     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI3.
                 07 WSS-IND-MAI3     OCCURS 40       PIC X(01).
      *DAD fin  21-OCT-1994
      *RVM-BEE-INI 25-JUN-1997
              05 WSS-GLS-MAI4.
                 07 WSS-IND-MAI4     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI5.
                 07 WSS-IND-MAI5     OCCURS 40       PIC X(01).

      *PARA CONCATENAR NOMBRE Y SUCURSAL
           03 WSS-GLS-NOMSUC.
              05 WSS-GLS-NOMC                        PIC X(37).
              05 WSS-GLS-SUCU                        PIC X(03).
      *RVM-BEE-FIN 25-JUN-1997

      *RAEL INI 14-SEP-1995
      * Variable que permite buscar en estructura
           03   TDD-DAUX              PIC X(01).
           03   TDD-IAUX              PIC 9(03).
           03   TDD-IDX               PIC 9(01).
           03   TDD-VAR-AUX           PIC X(01).
           03   TDD-VAR-AUX2          PIC X(01).
      * Estrucura tipo_direccion/tipo_entrega
           03  TDD-DIRE OCCURS 20 INDEXED BY TDD-INTB.
               05  TDD-REL.
                   07  TDD-TDIR                   PIC X(01).
                   07  TDD-ENTR                   PIC X(01).
      *RAEL FIN 14-SEP-1995



      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AUX-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
*% END
*% IF RF
      *<<<< RF
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY DAPRTLD1.
      *LRH ini 16-NOV-1994      (Memo.08-11-94)
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG4 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG5 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG6 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG7 IN WSS-LD2.
      *LRH fin 16-NOV-1994
           02 LINE PLUS 1.
              03 COLUMN 1
      *DAD ini  21-OCT-1994    (Memo.06-10-94)
                 PIC X(63)
                 VALUE '1INFORMESE SOBRE EL LIMITE DE GARANTIA ESTATAL A
      -    ' LOS DEPOSITOS.'.
      *DAD fin  21-OCT-1994

      *RAEL INI 21-SEP-1995
       COPY DAPRFNDP.
           .
       COPY DAPRTNDP.

       COPY DAPRTND1.
      *RAEL FIN 21-SEP-1995

      *LRH ini 16-NOV-1994      (Memo.08-11-94)
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG4 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG5 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG6 IN WSS-LD2.
           02 LINE PLUS 1.
              03 COLUMN 1
                 PIC X(1)
                 VALUE ALL '1'.
              03 COLUMN 2
                 PIC X(70)
                 SOURCE WSS-GLS-MSG7 IN WSS-LD2.
      *LRH fin 16-NOV-1994
           02 LINE PLUS 1.
              03 COLUMN 1
      *DAD ini  21-OCT-1994    (Memo.06-10-94)
                 PIC X(63)
                 VALUE '1INFORMESE SOBRE EL LIMITE DE GARANTIA ESTATAL A
      -    ' LOS DEPOSITOS.'.
      *DAD fin  21-OCT-1994
      *>>>>
*% END
*% IF FIN_DEC
      *<<<<
      * RAEL INI  21-SEP-1995
       DEC-CF-NDP-LIQ-CAI-IOPD SECTION.
           USE BEFORE REPORTING CF-NDP-LIQ-CAI-IOPD.
       INI-CF-NDP-LIQ-CAI-IOPD.
       FIN-CF-NDP-LIQ-CAI-IOPD.
           EXIT.
       DEC-CF-NDP-LIQ-IIC-IOPD SECTION.
           USE BEFORE REPORTING CF-NDP-LIQ-IIC-IOPD.
       INI-CF-NDP-LIQ-IIC-IOPD.
       FIN-CF-NDP-LIQ-IIC-IOPD.
           EXIT.
       DEC-CF-NDP-OPD-COD-OFIC SECTION.
           USE BEFORE REPORTING CF-NDP-OPD-COD-OFIC.
       INI-CF-NDP-OPD-COD-OFIC.
       FIN-CF-NDP-OPD-COD-OFIC.
           EXIT.
       DEC-CF-NDP-OPD-COD-EJEC SECTION.
           USE BEFORE REPORTING CF-NDP-OPD-COD-EJEC.
       INI-CF-NDP-OPD-COD-EJEC.
       FIN-CF-NDP-OPD-COD-EJEC.
           EXIT.
       DEC-CF-NDP-LIQ-FEC-FREA SECTION.
           USE BEFORE REPORTING CF-NDP-LIQ-FEC-FREA.
       INI-CF-NDP-LIQ-FEC-FREA.
       FIN-CF-NDP-LIQ-FEC-FREA.
           EXIT.
       DEC-CF-NDP-LIQ-COD-STAT SECTION.
           USE BEFORE REPORTING CF-NDP-LIQ-COD-STAT.
       INI-CF-NDP-LIQ-COD-STAT.
       FIN-CF-NDP-LIQ-COD-STAT.
           EXIT.
      *RAEL FIN  21-SEP-1995
      *>>>>
*% END
*% IF INI
      *<<<< INI
           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA       ( XXX/* )    : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'FIN  CAPTURA DE PARAMETROS'.
           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           DISPLAY ' '.

      *VAL-FEC Valida Fecha de Inicio
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE INICIO: '
                         WSS-FEC-FPRO '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.


      **VAL-FEC Valida Fecha de Termino
      *     MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-FBLK-N   TO FEC-FBLK.
      *     MOVE FEC-CHOY-N   TO FEC-CHOY.
      *     MOVE FEC-VHBL-N   TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-OKS
      *         DISPLAY ' '
      *         DISPLAY ' PROCESO CANCELADO '
      *         DISPLAY ' ERROR VALIDACION EN FECHA DE TERMINO: '
      *                   WSS-FEC-FINI '  ' FEC-MENS
      *         PERFORM GNS-PRO-ABT.

      **CMP-FEC Compara Fecha de Inicio con Fecha de Termino
      *     MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
      *     MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FEC2.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-CMP-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF FEC-STAT-GRT
      *         DISPLAY ' '
      *         DISPLAY ' PROCESO CANCELADO '
      *         DISPLAY ' FECHA INICIO > FECHA TERMINO: '
      *                   WSS-FEC-FINI ' > ' WSS-FEC-FPRO
      *         PERFORM GNS-PRO-ABT.

      *VAL-OFI Valida Oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION OFICINA: ' WSS-COD-OFIC
                  PERFORM GNS-PRO-ABT.

      * Obtiene Rango de Busqueda
      * FBEG = FPRO - NREA (dia habiles de renovacion)
           PERFORM OBT-RNG-FEC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0999   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0998   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$REAJ Mediante CIC de Moneda
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-RDOL IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$ Mediante CIC de Moneda '10
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-1013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC1013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLL IN WSS-VARI.
           DISPLAY ' '.

      *RAEL INI-14-SEP-1995
      * Lectura de relacion de tipo de direccion con tipo de entrega
           MOVE 'SGC' TO MSC-COD-SIST.
           MOVE 'SGC' TO FIO-SIST.
           MOVE 'TDIR' TO MSC-COD-TMSC IN MSC.
           MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE ZEROES TO TDD-IDX.
           IF MSC-COD-CMSC IN MSC NOT > SPACES
               MOVE FIO-GET-NXT TO FIO-CMND.
       CIC-GET-TDD.
      *     DISPLAY 'EN CICLO BUSQUEDA TDIR'.
           PERFORM GNS-FIO-MSC.
      *     DISPLAY 'FIO-STAT ' FIO-STAT.
      *     DISPLAY ' TMSC ' MSC-COD-TMSC IN MSC.
           IF FIO-STAT-OKS AND MSC-COD-TMSC IN MSC = 'TDIR'
                 ADD 1 TO TDD-IDX
                 MOVE MSC-COD-CMSC IN MSC TO TDD-TDIR(TDD-IDX)
      *           DISPLAY 'TDD-TDIR  ' TDD-TDIR(TDD-IDX)
                 MOVE MSC-GLS-DATA TO TDD-VAR-AUX
                 MOVE TDD-VAR-AUX  TO TDD-ENTR(TDD-IDX)
      *           DISPLAY 'TDD-ENTR  ' TDD-ENTR(TDD-IDX)
                 MOVE FIO-GET-NXT  TO FIO-CMND
                 GO TO CIC-GET-TDD.
      *RAEL FIN-14-SEP-1995
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
           DISPLAY ' '.
      *>>>>
*% END
*% IF FIN
      *<<<< FIN
           DISPLAY '     '.
           DISPLAY 'TOTALES DE CONTROL DAPPLLDP '.
           DISPLAY '--------------------------- '.
           DISPLAY '     '.
           DISPLAY 'TOTAL OPERACIONES LEIDAS           : ' WSS-LEI-OPD.
           DISPLAY 'TOTAL AVISOS DE RENOVACION EMITIDOS: ' WSS-GRA-OPD.
           DISPLAY '     '.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           GO TO FIN-INP-SRT.
           MOVE WSS-FEC-FCZO IN WSS-VARI TO LIQ-FEC-FCMP IN LIQ.
           MOVE 'LIQ-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR LIQ POR LIQ-FEC-FCMP : '
                                                     FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           IF LIQ-FEC-FCMP IN LIQ > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS LIQ EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FCZO IN WSS-VARI
                       ' A    ' WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = LIQ-COD-OFIC IN LIQ
                   GO TO NXT-INP-SRT.

      * JVM: se retiro efectivamente el monto liquidado
           IF LIQ-COD-STAT IN LIQ NOT = 'A'
              GO TO NXT-INP-SRT.

      * JVM: excluye las SLA futuras
           IF LIQ-FEC-FREA IN LIQ > LIQ-FEC-FCMP IN LIQ
              GO TO NXT-INP-SRT.

      * MOR: se excluyen las liquidaciones totales , para fijos
      * con y sin retiros y renovables
           IF LIQ-COD-LIQU IN LIQ NOT = 'LP'
              GO TO NXT-INP-SRT.

           MOVE LIQ-CIC-IOPD IN LIQ TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE OPERACION : ' OPD-CIC-IOPD IN OPD
               GO TO NXT-INP-SRT.

           IF OPD-VAL-SCAP IN OPD NOT > ZEROES AND
              OPD-COD-STAT IN OPD = 'L'
              GO TO NXT-INP-SRT.

           IF OPD-COD-MORE IN OPD NOT = 'N'
              GO TO NXT-INP-SRT.

           IF OPD-COD-RENO IN OPD = 'S' AND
      * MOR INI : SOLO SE EMITE LDP PARA LIQ PARCIAL DE DPI
      *        LIQ-COD-LIQU IN LIQ NOT = 'RC'
              LIQ-COD-LIQU IN LIQ NOT = 'LP'
               GO TO NXT-INP-SRT.

           MOVE 'N' TO WSS-GEN-REN IN WSS-LDP.
           MOVE 'S' TO WSS-GEN-LIQ IN WSS-LDP.

      * Lee y Genera Valores desde VEN
           IF OPD-VAL-SCAP IN OPD NOT > ZEROES
              GO TO NXT-INP-SRT.
           MOVE OPD-CAI-IOPD IN OPD TO VEN-CAI-IOPD IN VEN.
           MOVE OPD-IIC-IOPD IN OPD TO VEN-IIC-IOPD IN VEN.
           MOVE '001'               TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VENCIMIENTO ' VEN-KEY-IVEN
              GO TO NXT-INP-SRT.

      *>>>>
*% END
*% IF RM
      *<<<< RM
           MOVE OPD-COD-OFIC IN SRT TO SRT-COD-OFIC IN SRT.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'LIQ-FEC-FCMP' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF LIQ-FEC-FCMP IN LIQ > WSS-FEC-FTER IN WSS-VARI
              GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
           PERFORM PRO-OPD.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           OPEN OUTPUT RPTNDP.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
           INITIATE RPT-NDP.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           ADD 1 TO WSS-GRA-OPD IN WSS-VARI.
      * Obtiene glosas para DETALLE del Reporte LDP a partir de registro
           MOVE SPACES TO WSS-GLS-TLIQ IN WSS-LDP.
           IF LIQ-COD-LIQU IN SRT = 'RC'
              MOVE 'ANTICIPADA' TO WSS-GLS-TLIQ IN WSS-LDP.

      *Recupera glosa oficina
           MOVE SPACES TO WSS-GLS-OFIC IN WSS-LDP.
           IF OPD-COD-OFIC IN SRT > SPACES
              MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-LDP.
      *Recupera glosa clase operacion
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES1 IN WSS-VARI.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES2 IN WSS-VARI.
           MOVE WSS-GLS-DEST IN WSS-VARI TO
                                        WSS-GLS-COPD IN WSS-LDP.
      *Recupera glosa de moneda
           IF OPD-COD-VCAM IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-LDP
               MOVE TAB-GLS-DCOR IN TAB TO
                                      WSS-GLS-DCOR IN WSS-VARI
               MOVE TAB-GLS-ABRV IN TAB TO
                                      WSS-GLS-ABRV IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-DCOR IN WSS-VARI
               MOVE SPACES TO WSS-GLS-ABRV IN WSS-VARI
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-LDP.
      * Obtiene Datos desde RCC y RCD para datos clientes en LDP
           PERFORM GET-CUR-RCC.
           IF WSS-STAT-RCC IN WSS-VARI = 1
              PERFORM RST-DBC
              PERFORM RST-RCD
              MOVE SPACES TO WSS-GLS-LUGA IN WSS-LDP
           ELSE
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD.
           GO TO CIC-RCC.

      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *RAEL INI 14-SEP-1995

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-LDP
           ELSE
              GENERATE DL-NDP.

      *RAEL FIN 14-SEP-1995

      * Obtiene Datos desde OPD y LIQ para 2da. parte de LDP
       CIC-RCC.
           MOVE   RCD-MSC-TDIR   TO   TDD-DAUX.
           PERFORM BUSCA.
           IF TDD-VAR-AUX2 = 'M'
              ADD 1 TO WSS-CON-MANO
           ELSE
              IF TDD-VAR-AUX2 NOT = SPACES
                 ADD 1 TO WSS-CON-CORR.
           MOVE SPACES TO WSS-GLS-EJEC IN WSS-LDP.
           IF OPD-COD-EJEC IN SRT > SPACES
               MOVE OPD-COD-EJEC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-LDP.

           PERFORM BUS-GLS-TAS.
      *DAD ini  21-OCT-1994    (Memo.06-10-94)
      * Proceso que Llena e Imprime Verticalmente lineas de Detalle(MAIL
      *RVM-BEE-INI 25-JUN-1997
      *    MOVE DBC-GLS-NOMC IN DBC     TO WSS-GLS-MAI1 IN WSS-VARI.
           MOVE DBC-GLS-NOMC IN DBC     TO WSS-GLS-NOMC IN WSS-VARI.
           MOVE OPD-COD-OFIC IN SRT     TO WSS-GLS-SUCU IN WSS-VARI.
           MOVE WSS-GLS-NOMSUC IN WSS-VARI TO WSS-GLS-MAI1 IN WSS-VARI.
      *RVM-BEE-FIN 25-JUN-1997
           MOVE RCD-GLS-DIRE IN RCD     TO WSS-GLS-MAI2 IN WSS-VARI.
           MOVE WSS-GLS-LUGA IN WSS-LDP TO WSS-GLS-MAI3 IN WSS-VARI.
      *RVM-BEE-INI 25-JUN-1997
           MOVE OPD-CAI-ISER IN SRT TO BAR-CAI-OPER IN BAR-VARI.
           MOVE OPD-IIC-ISER IN SRT TO BAR-IIC-OPER IN BAR-VARI.
           MOVE 'DAP'               TO BAR-COD-SIST IN BAR-VARI.
           MOVE 15                  TO BAR-NUM-LRGO IN BAR-VARI.
           PERFORM CAL-BAR.
           MOVE BAR-GLS-BARRA IN BAR-VARI TO WSS-GLS-MAI4 IN WSS-VARI.
           MOVE BAR-COD-BARRA IN BAR-VARI TO WSS-GLS-MAI5 IN WSS-VARI.
      *RVM-BEE-FIN 25-JUN-1997
           PERFORM IMP-DET-MAIL VARYING WSS-IND FROM 40 BY -1 UNTIL
                                        WSS-IND < 1.
      *RVM-BEE-INI 25-JUN-1997
           IF TDD-VAR-AUX2 = 'M'
               MOVE 77 TO LINE-COUNTER IN RPT-LDP
           ELSE
               MOVE 77 TO LINE-COUNTER IN RPT-NDP.
           PERFORM IMP-COD-BAR VARYING WSS-IND FROM 40 BY -1 UNTIL
                                        WSS-IND < 1.
      *RVM-BEE-FIN 25-JUN-1997

           IF TDD-VAR-AUX2 = 'M'
              MOVE 77 TO LINE-COUNTER IN RPT-LDP
           ELSE
              MOVE 77 TO LINE-COUNTER IN RPT-NDP.
      *DAD fin  21-OCT-1994

      *RAEL INI 14-SEP-1995

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-LDP
           ELSE
              GENERATE DL-NDP.

      *RAEL FIN 14-SEP-1995


      *     GENERATE DL-D1.

      * Obtiene Datos desde OPD y LIQ para 2da. parte de LDP
      *     MOVE SPACES TO WSS-GLS-EJEC IN WSS-LDP.
      *     IF OPD-COD-EJEC IN SRT > SPACES
      *         MOVE OPD-COD-EJEC IN SRT TO USR-COD-USER IN USR
      *         PERFORM BUS-USR
      *         MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-LDP.

      *     PERFORM BUS-GLS-TAS.
      *     GENERATE DL-D2.

      * Obtiene Datos desde VEN y LIQ para LD2
           PERFORM PUT-VEN-LD1.
           PERFORM PUT-LIQ-LD1.
      *LRH ini 16-NOV-1994     (Memo.08-11-94)
           IF OPD-COD-RENO IN SRT = 'S' AND
             (OPD-COD-VCAM IN SRT = PDB-CIC-0999 OR
              OPD-COD-VCAM IN SRT = PDB-CIC-1013)
               MOVE 'NOTA IMPORTANTE:  DE ACUERDO A  MODIFICACION EFECTU
      -             'ADA POR LA SUPERIN-' TO WSS-GLS-MSG4 IN WSS-LD2
               MOVE 'TENDENCIA DE BANCOS EN CIRCULAR 2.755 DEL 18.08.93,
      -             ' EN CADA VENCIMIEN-' TO WSS-GLS-MSG5 IN WSS-LD2
               MOVE 'TO DE ESTE DAP RENOVABLE,  USTED DISPONDRA DE 3 DIA
      -             'S HABILES BANCARIOS' TO WSS-GLS-MSG6 IN WSS-LD2
               MOVE 'PARA RESCATARLO, INCLUIDO EL DIA DEL VENCIMIENTO.'
                                          TO WSS-GLS-MSG7 IN WSS-LD2
           ELSE
               MOVE SPACES TO WSS-GLS-MSG4 IN WSS-LD2
                              WSS-GLS-MSG5 IN WSS-LD2
                              WSS-GLS-MSG6 IN WSS-LD2
                              WSS-GLS-MSG7 IN WSS-LD2.
      *LRH fin 16-NOV-1994


      *RAEL INI 14-SEP-1995

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-LD1
           ELSE
              GENERATE DL-ND1.

      *RAEL FIN 14-SEP-1995




      *DAD ini  21-OCT-1994    (Memo.06-10-94)
      *RAEL INI 14-SEP-1995

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-NUL
           ELSE
              GENERATE DL-NNUL.


      *    MOVE   RCD-MSC-TDIR   TO   TDD-DAUX.
      *    PERFORM BUSCA.
           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-NUL
           ELSE
              GENERATE DL-NNUL.



      *    MOVE   RCD-MSC-TDIR   TO   TDD-DAUX.
      *    PERFORM BUSCA.
           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-DET
           ELSE
              GENERATE DL-NDET.

      *RAEL FIN 14-SEP-1995





      *DAD fin  21-OCT-1994
           IF WSS-GEN-REN IN SRT = 'S'
              PERFORM PUT-REN-LD1


      *RAEL INI 14-SEP-1995

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-REN
           ELSE
              GENERATE DL-NEN.

      *RAEL FIN 14-SEP-1995


      *DAD ini  21-OCT-1994    (Memo.06-10-94)
      *     MOVE '73' TO LINE-COUNTER.
           IF TDD-VAR-AUX2 = 'M'
              MOVE 77 TO LINE-COUNTER  IN RPT-LDP
           ELSE
              MOVE 77 TO LINE-COUNTER  IN RPT-NDP.

      *DAD fin  21-OCT-1994
           PERFORM GET-NXT-RCC
           IF WSS-IND-MCLI IN WSS-VARI = 'M'
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD
              GO TO CIC-RCC.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
           DISPLAY ' TOTAL DE INFORMES A ENTREGAR POR MANO   : '
                     WSS-CON-MANO.
           DISPLAY ' TOTAL DE INFORMES A ENTREGAR POR CORREO : '
                     WSS-CON-CORR.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *RAEL INI 14-SEP-1995

       BUSCA SECTION.
       INI-BUSCA.
      *     DISPLAY 'BUSCANDO STRING ' TDD-DAUX.
      *     DISPLAY TDD-DIRE(1).
      *     DISPLAY TDD-DIRE(2).
      *     DISPLAY TDD-DIRE(3).
      *     DISPLAY TDD-DIRE(4).
      *     DISPLAY TDD-DIRE(5).
      *     DISPLAY TDD-DIRE(6).
      *     DISPLAY TDD-DIRE(7).
           MOVE  SPACES TO   TDD-VAR-AUX2.
           MOVE    1    TO   TDD-IAUX.
      *     MOVE   'Z'  TO   TDD-DAUX.
           SET TDD-INTB TO 1.
           SEARCH  TDD-DIRE VARYING TDD-IAUX
             AT END
               DISPLAY 'NO SE ENCONTRO FORMA DE ENTREGA RELACIONADA'
               GO TO FIN-BUSCA
           WHEN  TDD-TDIR(TDD-INTB) = TDD-DAUX
           MOVE  TDD-ENTR ( TDD-INTB ) TO TDD-VAR-AUX2
      *     DISPLAY 'FORMA DE ENTREGA ES :' TDD-ENTR ( TDD-INTB )
               GO TO FIN-BUSCA.
       FIN-BUSCA.

      *RAEL FIN 14-SEP-1995




      ******************************************************************
      *DAD ini  21-OCT-1994    (Memo.06-10-94)
      * Proceso que Imprime Verticalmente lineas de Detalle(MAIL)
       IMP-DET-MAIL SECTION.
       INI-IMP-DET-MAIL.
           MOVE WSS-IND-MAI1 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI1 IN WSS-LDP.
           MOVE WSS-IND-MAI2 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI2 IN WSS-LDP.
           MOVE WSS-IND-MAI3 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI3 IN WSS-LDP.

      *RAEL INI 14-SEP-1995

      *RVM-BEE-INI 25-JUN-1997
           MOVE WSS-IND-MAI4 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI4 IN WSS-LDP.
      *RVM-BEE-FIN 25-JUN-1997

           IF TDD-VAR-AUX2 = 'M'
              GENERATE DL-HDR
           ELSE
              GENERATE DL-NDR.

      *RAEL FIN 14-SEP-1995

       FIN-IMP-DET-MAIL.
      *DAD fin  21-OCT-1994

      *RVM-BEE-INI 25-JUN-1997
           EXIT.
       IMP-COD-BAR SECTION.
       INI-IMP-COD-BAR.
           MOVE WSS-IND-MAI5 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI5 IN WSS-LDP.

           IF TDD-VAR-AUX2 = 'M'
               GENERATE DL-HDR2
           ELSE
               GENERATE DL-NDR2.
       FIN-IMP-COD-BAR.
           EXIT.
      *RVM-BEE-FIN 25-JUN-1997
      ******************************************************************
       PRO-OPD SECTION.
       INI-PRO-OPD.
           MOVE WSS-FEC-FCZO IN WSS-VARI TO OPD-FEC-FCMP IN OPD.
           MOVE 'OPD-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-OPD.
           IF OPD-FEC-FCMP IN OPD > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO EXISTEN OPD A FECHA DE PROCESO '
                                    WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-PRO-OPD.

       LUP-PRO-OPD.
           ADD 1 TO WSS-LEI-OPD IN WSS-VARI.
           MOVE OPD TO BKPOPD.
           MOVE ADR-OPD-REQA TO AUX-OPD-REQA.

           IF OPD-FEC-FREA IN OPD = OPD-FEC-FPCO IN OPD
              GO TO NXT-PRO-OPD.

           IF OPD-VAL-SCAP IN OPD NOT > ZEROES AND
              OPD-COD-STAT IN OPD = 'L'
               GO TO NXT-PRO-OPD.

      *JVM: Verifica si OPD esta al final del Periodo de Renovacion
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM VRF-PREN.
           IF MSG-COD-MENS > SPACES
               GO TO NXT-PRO-OPD.

           MOVE 'S' TO WSS-GEN-REN IN WSS-LDP.
           MOVE OPD-CAI-GREN IN OPD TO OPD-CAI-IOPD IN OPD.
           MOVE OPD-IIC-GREN IN OPD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE OPD QUE RENUEVA '
                       OPD-CIC-IOPD IN OPD ' ' FIO-STAT
              GO TO NXT-PRO-OPD.

           MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.
           MOVE '001'               TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VEN PARA OPD '
                       OPD-CIC-IOPD IN OPD ' ' FIO-STAT
              GO TO NXT-PRO-OPD.

           MOVE OPD-CAI-IOPD IN BKPOPD TO OPD-CAI-IOPD IN OPD.
           MOVE OPD-IIC-IOPD IN BKPOPD TO OPD-IIC-IOPD IN OPD.
           PERFORM GEN-REN-SRT.
           MOVE BKPOPD TO OPD.
           MOVE OPD-SGV-TINT IN OPD TO OPD-SGV-TINR IN SRT.
           MOVE OPD-FEC-FPVC IN OPD TO OPD-FEC-FPVC IN SRT.
           MOVE OPD-VAL-CAPT IN OPD TO OPD-VAL-CAPT IN SRT.

           RELEASE SRT.

       NXT-PRO-OPD.
           MOVE AUX-OPD-REQA   TO ADR-OPD-REQA.
           MOVE FIO-KDEF-S     TO FIO-KDEF.
           MOVE 'OPD-FEC-FCMP' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF ( FIO-STAT-OKS AND
               OPD-FEC-FCMP IN OPD NOT > WSS-FEC-FTER IN WSS-VARI )
               GO TO LUP-PRO-OPD.
       FIN-PRO-OPD.
           EXIT.

       VRF-PREN SECTION.
       INI-VRF-PREN.
      *     MOVE ZEROES TO WSS-NUM-PNTE.
      *     MOVE OPD-NUM-DREA IN OPD TO FEC-ITM1.
      *     MOVE OPD-NUM-MREA IN OPD TO FEC-ITM2.
      *     MOVE OPD-NUM-SREA IN OPD TO FEC-ITM3.
      *     MOVE OPD-NUM-AREA IN OPD TO FEC-ITM4.

       BUS-VRF-PREN.
      ** ISP: SE POSICIONA EN PRIMERA FECHA HABIL A PARTIR DE
      **      FECHA DE CAPTACION ( INCLUSIVE )
      **      LA DEJA CARGADA EN FEC-FECH

      *     MOVE FEC-FBLK-S TO FEC-FBLK.
      *     MOVE FEC-CHOY-N TO FEC-CHOY.
      *     MOVE FEC-VHBL-S TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC TO FEC-CMND.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-HBL
      *         MOVE FEC-SUM-DIA            TO FEC-CMND
      *         MOVE 1                      TO FEC-NDIA
      *         MOVE FEC-FORM-FEC TO FEC-FORM
      *         PERFORM CAL-FEC
      *         GO TO BUS-VRF-PREN.

      * LUP-VRF-PREN.
      *     MOVE FEC-SUM-DIA            TO FEC-CMND.
      *     MOVE 1                      TO FEC-NDIA.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     PERFORM CAL-FEC.

      **VAL-FEC Validar Fecha
      *     MOVE FEC-FBLK-S TO FEC-FBLK.
      *     MOVE FEC-CHOY-N TO FEC-CHOY.
      *     MOVE FEC-VHBL-S TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC TO FEC-CMND.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     PERFORM PRO-FEC.
      *     IF FEC-STAT-HBL
      *         ADD 1 TO WSS-NUM-PNTE.
      *     IF WSS-NUM-PNTE < OPD-NUM-PNTE IN OPD
      *          GO TO LUP-VRF-PREN.
      *     MOVE FEC-ITM1 TO WSS-NUM-DUNO.
      *     MOVE FEC-ITM2 TO WSS-NUM-MUNO.
      *     MOVE FEC-ITM3 TO WSS-NUM-SUNO.
      *     MOVE FEC-ITM4 TO WSS-NUM-AUNO.
      *     IF WSS-FEC-FUNO > WSS-FEC-FTER
      *         MOVE 'PERRENOINV' TO MSG-COD-MENS.
       FIN-VRF-PREN.
           EXIT.

       GEN-REN-SRT SECTION.
       INI-GEN-REN-SRT.
           MOVE 'S'                    TO WSS-GEN-LIQ IN SRT.
           MOVE OPD-CIC-GREN IN BKPOPD TO LIQ-CIC-IOPD IN LIQ.
           MOVE 1                      TO LIQ-NUM-ILIQ IN LIQ.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-LIQ.
           IF NOT FIO-STAT-OKS
              MOVE 'N'    TO WSS-GEN-LIQ IN SRT
              MOVE SPACES TO LIQ-COD-OFIC IN LIQ
              MOVE SPACES TO LIQ-COD-EJEC IN LIQ
              MOVE ZEROES TO LIQ-SGV-CAPI IN LIQ
              MOVE SPACES TO LIQ-COD-STAT IN LIQ
              MOVE SPACES TO LIQ-COD-LIQU IN LIQ
              MOVE SPACES TO LIQ-FEC-FREA IN LIQ
              MOVE ZEROES TO LIQ-SGV-GAST IN LIQ
              MOVE ZEROES TO LIQ-SGV-REAJ IN LIQ
              MOVE ZEROES TO LIQ-SGV-PESO IN LIQ
              MOVE ZEROES TO LIQ-SGV-CAPI IN LIQ
              MOVE ZEROES TO LIQ-SGV-TPAG IN LIQ.

           MOVE WSS-GEN-REN IN WSS-LDP TO WSS-GEN-REN IN SRT.
           MOVE OPD-CAI-ISER IN BKPOPD TO OPD-CAI-ISER IN SRT.
           MOVE OPD-IIC-ISER IN BKPOPD TO OPD-IIC-ISER IN SRT.
           MOVE OPD-COD-OFIC IN OPD TO OPD-COD-OFIC IN SRT.
           MOVE OPD-COD-EJEC IN OPD TO OPD-COD-EJEC IN SRT.
           MOVE OPD-FEC-FREA IN OPD TO OPD-FEC-FREA IN SRT.
           MOVE OPD-COD-VCAM IN OPD TO OPD-COD-VCAM IN SRT.
           MOVE OPD-COD-TINT IN OPD TO OPD-COD-TINT IN SRT.
           MOVE OPD-SGV-TINT IN OPD TO OPD-SGV-TINT IN SRT.
           MOVE OPD-COD-TOPD IN OPD TO OPD-COD-TOPD IN SRT.
           MOVE OPD-COD-AOPD IN OPD TO OPD-COD-AOPD IN SRT.
           MOVE OPD-COD-COPD IN OPD TO OPD-COD-COPD IN SRT.
           MOVE OPD-CAI-IOPD IN OPD TO OPD-CAI-IOPD IN SRT.
           MOVE OPD-IIC-IOPD IN OPD TO OPD-IIC-IOPD IN SRT.
           MOVE OPD-COD-RENO IN OPD TO OPD-COD-RENO IN SRT.
           MOVE OPD-VAL-SCAP IN OPD TO OPD-VAL-SCAP IN SRT.
           MOVE OPD-VAL-SINT IN OPD TO OPD-VAL-SINT IN SRT.
           MOVE OPD-SGV-SPRD IN OPD TO OPD-SGV-SPRD IN SRT.
           MOVE OPD-COD-RESC IN OPD TO OPD-COD-RESC IN SRT.
           MOVE OPD-FEC-FTER IN OPD TO OPD-FEC-FTER IN SRT.
      *JVM: DEBE MOSTRAR CIC OPD NUEVA
      *     MOVE LIQ-CAI-IOPD IN LIQ TO LIQ-CAI-IOPD IN SRT.
      *     MOVE LIQ-IIC-IOPD IN LIQ TO LIQ-IIC-IOPD IN SRT.
           MOVE OPD-CAI-IOPD IN OPD TO LIQ-CAI-IOPD IN SRT.
           MOVE OPD-IIC-IOPD IN OPD TO LIQ-IIC-IOPD IN SRT.
      *JVM: DEBE GUUARDAR CIC OPD ANTIGUA EN CAD
           MOVE OPD-CAI-GREN IN BKPOPD TO CAD-CAI-IOPD IN SRT.
           MOVE OPD-IIC-GREN IN BKPOPD TO CAD-IIC-IOPD IN SRT.
      *JVM:
           MOVE LIQ-COD-STAT IN LIQ TO LIQ-COD-STAT IN SRT.
           MOVE LIQ-COD-OFIC IN LIQ TO LIQ-COD-OFIC IN SRT.
           MOVE LIQ-COD-EJEC IN LIQ TO LIQ-COD-EJEC IN SRT.
           MOVE LIQ-SGV-CAPI IN LIQ TO LIQ-SGV-CAPI IN SRT.
           MOVE LIQ-FEC-FREA IN LIQ TO LIQ-FEC-FREA IN SRT.
           MOVE LIQ-SGV-GAST IN LIQ TO LIQ-SGV-GAST IN SRT.
           MOVE LIQ-SGV-TPAG IN LIQ TO LIQ-SGV-TPAG IN SRT.
           MOVE LIQ-SGV-REAJ IN LIQ TO LIQ-SGV-REAJ IN SRT.
           MOVE LIQ-COD-LIQU IN LIQ TO LIQ-COD-LIQU IN SRT.
           MOVE LIQ-SGV-PESO IN LIQ TO LIQ-SGV-PESO IN SRT.
           MOVE VEN-VAL-FINA IN VEN TO VEN-VAL-FINA IN SRT.
           MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN SRT.
           MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN SRT.
           MOVE VEN-VAL-CAPI IN VEN TO VEN-VAL-CAPI IN SRT.
           MOVE VEN-FEC-FVEN IN VEN TO VEN-FEC-FVEN IN SRT.
       FIN-GEN-REN-SRT.
           EXIT.

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE 0  TO WSS-STAT-RCC IN WSS-VARI.
           MOVE OPD-CAI-IOPD IN SRT TO RCC-CAI-IOPD IN RCC.
           MOVE OPD-IIC-IOPD IN SRT TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-RCC IN WSS-VARI.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CAI-IOPD IN SRT = RCC-CAI-IOPD IN RCC AND
              OPD-IIC-IOPD IN SRT = RCC-IIC-IOPD IN RCC
                MOVE 'M'    TO WSS-IND-MCLI IN WSS-VARI
           ELSE
                MOVE SPACES TO WSS-IND-MCLI IN WSS-VARI.
       FIN-GET-NXT-RCC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RCC-DBC SECTION.
       INI-GET-RCC-DBC.
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
              MOVE '-' TO WSS-GLS-AUXI IN WSS-LDP
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
              IF DBC-IND-ICLI IN DBC = SPACES
                 MOVE SPACES TO WSS-GLS-AUXI IN WSS-LDP.
       FIN-GET-RCC-DBC.
           EXIT.

      * Lee con CIC CLIENTE archivo RCD
       GET-RCC-RCD SECTION.
       INI-GET-RCC-RCD.
           MOVE RCC-CIC-ICLI IN RCC TO RCD-CIC-ICLI IN RCD.
           MOVE RCC-NUM-DIRE IN RCC TO RCD-NUM-DIRE IN RCD.
           MOVE 'RCD-KEY-IRCD' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              PERFORM RST-RCD
           ELSE
              PERFORM VAL-LUGA.
       FIN-GET-RCC-RCD.
           EXIT.

       VAL-LUGA SECTION.
       INI-VAL-LUGA.
           MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA IN WSS-VARI.
           IF WSS-IND-PAIS IN WSS-VARI = 'P'
               MOVE 'PAI' TO TAB-COD-TTAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
               MOVE 'COM' TO TAB-COD-TTAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              RCD-COD-LUGA IN RCD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-LUGA IN WSS-LDP
           ELSE
               MOVE SPACES TO WSS-GLS-LUGA IN WSS-LDP.
       FIN-VAL-LUGA.
           EXIT.

       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'SGC'        TO MSG-COD-SIST.
           MOVE 'CLI    NEX' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO WSS-GLS-AUXI IN WSS-LDP.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

      * Limpia datos cliente desde RCD
       RST-RCD SECTION.
       INI-RST-RCD.
           MOVE '000'  TO RCD-NUM-DIRE IN RCD.
           MOVE SPACES TO RCD-GLS-DIRE IN RCD.
           MOVE SPACES TO RCD-GLS-FONO IN RCD.
       FIN-RST-RCD.
           EXIT.
      ******************************************************************
      * Obtiene Antecedentes de la Tasa de Captacion
      * Obtiene glosas relativas a la Tasa de Captacion que forman parte
       BUS-GLS-TAS SECTION.
       INI-BUS-GLS-TAS.
           MOVE OPD-COD-TINT IN SRT TO WSS-COD-TINT IN WSS-VARI.
           IF WSS-COD-CVTI IN WSS-VARI > SPACES
               MOVE OPD-SGV-SPRD IN SRT TO OPD-SGV-TINT IN OPD
               MOVE 'SPREAD' TO WSS-GLS-TINT IN WSS-LDP
           ELSE
               MOVE 'TASA INTERES' TO WSS-GLS-TINT IN WSS-LDP.

           IF WSS-COD-BCTI IN WSS-VARI > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'BCT'               TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-BCTI IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-BCTI IN WSS-LDP
           ELSE
               MOVE SPACES TO WSS-GLS-BCTI IN WSS-LDP.

           IF WSS-COD-PBTI IN WSS-VARI > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PBT'               TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-PBTI IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-PBTI IN WSS-LDP
           ELSE
               MOVE SPACES TO WSS-GLS-PBTI IN WSS-LDP.

           IF WSS-COD-SPBT IN WSS-VARI > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'MCT'               TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-SPBT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MCTI IN WSS-LDP
           ELSE
               MOVE SPACES TO WSS-GLS-MCTI IN WSS-LDP.

           IF WSS-COD-CVTI IN WSS-VARI > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE 'I'                 TO WSS-GLS-TVTI IN WSS-VARI
               MOVE WSS-COD-CVTI IN WSS-VARI TO WSS-GLS-CVTI IN WSS-VARI
               MOVE WSS-COD-PBTI IN WSS-VARI TO WSS-IND-PBTI IN WSS-VARI
               MOVE WSS-IND-CVTI IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-CVTI IN WSS-LDP
           ELSE
               MOVE SPACES TO WSS-GLS-CVTI IN WSS-LDP.

      *     IF WSS-COD-TFPR IN WSS-VARI > SPACES
      *         MOVE 'TAB'               TO TAB-COD-SIST
      *         MOVE 'TPR'               TO TAB-COD-TTAB IN TAB
      *         MOVE WSS-COD-TFPR IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-TFPR IN WSS-LDP
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-TFPR IN WSS-LDP.

      *     IF WSS-MSC-PREP IN WSS-VARI > SPACES
      *         MOVE 'TAB'               TO TAB-COD-SIST
      *         MOVE 'IPER'              TO TAB-COD-TTAB IN TAB
      *         MOVE WSS-MSC-PREP IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-PREP IN WSS-LDP
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-PREP IN WSS-LDP.
       FIN-BUS-GLS-TAS.
           EXIT.

       PUT-VEN-LD1 SECTION.
       INI-PUT-VEN-LD1.
      * Mueve datos a informe LD1 - VEN
      * Genera Datos Moneda PESOS para Detalle Vencimiento de LD1
           MOVE WSS-GLS-DCOR IN WSS-VARI TO
                                       WSS-GLS-VEXP IN WSS-LD1.
           MOVE OPD-FEC-FREA IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO WSS-NUM-DREA IN WSS-LD1.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO WSS-NUM-MREA IN WSS-LD1.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO WSS-NUM-SREA IN WSS-LD1.
           MOVE WSS-NUM-APAS IN WSS-VARI TO WSS-NUM-AREA IN WSS-LD1.

           PERFORM OBT-DAT-PER.
      * Se mueve directamente la Tasa del Periodo desde OPD
           MOVE OPD-VAL-SINT IN SRT TO WSS-SGV-TPER IN WSS-LD1.

           MOVE VEN-FEC-FVEN IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO WSS-NUM-DVEN IN WSS-LD1.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO WSS-NUM-MVEN IN WSS-LD1.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO WSS-NUM-SVEN IN WSS-LD1.
           MOVE WSS-NUM-APAS IN WSS-VARI TO WSS-NUM-AVEN IN WSS-LD1.
           MOVE VEN-VAL-FINA IN SRT TO WSS-MON-SFIN IN WSS-LD1.
           MOVE VEN-VAL-CAPI IN SRT TO WSS-MON-SCAP IN WSS-LD1.
           SUBTRACT VEN-VAL-CAPI IN SRT FROM VEN-VAL-FINA IN SRT
                             GIVING WSS-VAL-INTE IN WSS-LD1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-PESO IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = '1013  '
              MOVE SPACES TO WSS-GLS-EQFC IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCFC IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-SCAP IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCCA IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCFL IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-VCFC IN WSS-LD1
              MOVE SPACES TO WSS-GLS-EQFV IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCFV IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-SFIN IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCVC IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-VCFV IN WSS-LD1
              GO TO FIN-PUT-VEN-LD1.

           MOVE 'EQUIVALENTE'     TO WSS-GLS-EQFC IN WSS-LD1.
           MOVE 'VALOR DE CAMBIO' TO WSS-GLS-VCFC IN WSS-LD1.

           MOVE SPACES            TO WSS-GLS-EQFV IN WSS-LD1.
           MOVE SPACES            TO WSS-GLS-VCFV IN WSS-LD1.
           MOVE SPACES            TO WSS-GLS-VCVC IN WSS-LD1.
           MOVE ZEROES            TO WSS-VAL-VCFV IN WSS-LD1.
           MOVE ZEROES            TO WSS-VAL-SFIN IN WSS-LD1.

      * Genera Datos Moneda Reajustable U.F. para Detalle Vencimiento de
           IF OPD-COD-VCAM IN SRT = WSS-COD-UEFE IN WSS-VARI
              PERFORM OBT-VCA-UEF
              MOVE 'U.F./$'                 TO WSS-GLS-VCCA IN WSS-LD1
                                               WSS-GLS-VCFL IN WSS-LD1
              MOVE WSS-SGV-FREA IN WSS-VARI TO WSS-VAL-VCFC IN WSS-LD1.

      * Genera Datos Moneda US$REAJ para Detalle Vencimiento de LD1
           IF OPD-COD-VCAM IN SRT = WSS-COD-RDOL IN WSS-VARI
              PERFORM OBT-VCA-RDO
              MOVE 'US$R/$'                 TO WSS-GLS-VCCA IN WSS-LD1
                                               WSS-GLS-VCFL IN WSS-LD1
              MOVE WSS-SGV-FREA IN WSS-VARI TO WSS-VAL-VCFC IN WSS-LD1.

      * Calcula Reajustes, Intereses y Capitales en Pesos para Moneda Re
           MULTIPLY VEN-VAL-CAPI IN SRT BY
                       WSS-SGV-FREA IN WSS-VARI  GIVING
                       WSS-VAL-SCAP IN WSS-LD1 ROUNDED.
       FIN-PUT-VEN-LD1.
           EXIT.

       OBT-VCA-UEF SECTION.
       INI-OBT-VCA-UEF.
      * Obtiene Valor de Cambio de la UF a F. Captacion, F. Liquidacion
      * y F. Vencimiento
           MOVE 1 TO WSS-SGV-FREA IN WSS-VARI
                     WSS-SGV-FLIQ IN WSS-VARI
                     WSS-SGV-FVEN IN WSS-VARI.
           MOVE OPD-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPD-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       OPD-FEC-FREA IN SRT ' PARA LA UF.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       OPD-FEC-FREA IN SRT ' PARA LA UF.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FREA IN WSS-VARI.

           MOVE LIQ-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE LIQ-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       LIQ-FEC-FREA IN SRT ' PARA LA UF.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       LIQ-FEC-FREA IN SRT ' PARA LA UF.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FLIQ IN WSS-VARI.

           MOVE VEN-FEC-FVEN IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE VEN-FEC-FVEN IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       VEN-FEC-FVEN IN SRT ' PARA LA UF.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       VEN-FEC-FVEN IN SRT ' PARA LA UF.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVEN IN WSS-VARI.
       FIN-OBT-VCA-UEF.
           EXIT.

       OBT-VCA-RDO SECTION.
       INI-OBT-VCA-RDO.
      * Obtiene Valor de Cambio de la US$REAJ a F. Captacion, F. Liquida
      * y F. Vencimiento
           MOVE 1 TO WSS-SGV-FREA IN WSS-VARI
                     WSS-SGV-FLIQ IN WSS-VARI.
           MOVE OPD-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPD-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       OPD-FEC-FREA IN SRT ' PARA US$REAJ.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       OPD-FEC-FREA IN SRT ' PARA US$REAJ.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FREA IN WSS-VARI.

           MOVE LIQ-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE LIQ-FEC-FREA IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       LIQ-FEC-FREA IN SRT ' PARA US$REAJ.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       LIQ-FEC-FREA IN SRT ' PARA US$REAJ.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FLIQ IN WSS-VARI.

           MOVE VEN-FEC-FVEN IN SRT TO CAM-FEC-FCAM IN CAM(1).
           MOVE VEN-FEC-FVEN IN SRT TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-RDOL IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                       VEN-FEC-FVEN IN SRT ' PARA US$REAJ.'
           ELSE
           IF CAM-IND-VIGE NOT = 'S'
              DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                       VEN-FEC-FVEN IN SRT ' PARA US$REAJ.'
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVEN IN WSS-VARI.
       FIN-OBT-VCA-RDO.
           EXIT.

       OBT-DAT-PER SECTION.
       INI-OBT-DAT-PER.
           MOVE ZEROES TO FEC-NDIA  INT-TIPE.
      *Genera Tasa del Periodo y Nro. de Dias
           MOVE OPD-FEC-FREA IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO FEC-DEC1 IN FEC-VARI.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO FEC-MEC1 IN FEC-VARI.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO FEC-SEC1 IN FEC-VARI.
           MOVE WSS-NUM-APAS IN WSS-VARI TO FEC-AEC1 IN FEC-VARI.
           MOVE VEN-FEC-FVEN IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO FEC-DEC2 IN FEC-VARI.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO FEC-MEC2 IN FEC-VARI.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO FEC-SEC2 IN FEC-VARI.
           MOVE WSS-NUM-APAS IN WSS-VARI TO FEC-AEC2 IN FEC-VARI.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR EN DIF. DIAS CON ' FEC-MENS
               ' F1 ' OPD-FEC-FREA IN SRT
               ' F2 ' VEN-FEC-FVEN IN SRT.
           MOVE FEC-NDIA TO WSS-NUM-DIAS IN WSS-LD1.
      *     DISPLAY 'DIAS ' FEC-NDIA.

      * Obtiene Tasa de Interes
           MOVE OPD-FEC-FREA IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO INT-DUNO
                                            INT-DCOL
                                            INT-DBTV.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO INT-MUNO
                                            INT-MCOL
                                            INT-MBTV.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO INT-SUNO
                                            INT-SCOL
                                            INT-SBTV.
           MOVE WSS-NUM-APAS IN WSS-VARI TO INT-AUNO
                                            INT-ACOL
                                            INT-ABTV.

           MOVE OPD-COD-TINT IN SRT TO INT-TIPT.
           MOVE VEN-FEC-FVEN IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO INT-DDOS.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO INT-MDOS.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO INT-SDOS.
           MOVE WSS-NUM-APAS IN WSS-VARI TO INT-ADOS.
           MOVE OPD-COD-VCAM IN SRT TO INT-VCAM.
           MOVE OPD-COD-TINT IN SRT TO INT-TIPT.
           IF INT-CVTI > SPACES
               MOVE OPD-SGV-SPRD IN SRT TO INT-TINT
           ELSE
               MOVE OPD-SGV-TINT IN SRT TO INT-TINT.
      * Calcula Tasa de Interes del Periodo
           PERFORM GNS-CAL-INT.
           IF INT-CMSG > SPACES
              DISPLAY 'ERROR EN CAL-INT ' INT-TIPE ' '
                       INT-CMSG ' ' INT-MEN2
              GO TO FIN-OBT-DAT-PER.
           MULTIPLY INT-TIPE BY 100 GIVING
                               WSS-SGV-TPER IN WSS-LD1 ROUNDED.
      *     DISPLAY 'TASA PER ' INT-TIPE.
       FIN-OBT-DAT-PER.
           EXIT.

       PUT-LIQ-LD1 SECTION.
       INI-PUT-LIQ-LD1.
           MOVE SPACES TO WSS-GLS-VCC1 IN WSS-LD1.
           MOVE ZEROES TO WSS-VAL-VCC1 IN WSS-LD1.
           MOVE SPACES TO WSS-GLS-VCC2 IN WSS-LD1.
           MOVE ZEROES TO WSS-VAL-VCC2 IN WSS-LD1.
           MOVE SPACES TO WSS-GLS-VCC3 IN WSS-LD1.
           MOVE ZEROES TO WSS-VAL-VCC3 IN WSS-LD1.
           MOVE SPACES TO WSS-GLS-VCC4 IN WSS-LD1.
           MOVE ZEROES TO WSS-VAL-VCC4 IN WSS-LD1.
      * JVM : VERIFICA CARGA DE LIQ PARA RENOVABLES
           IF WSS-GEN-LIQ IN SRT = 'N'
              MOVE ZEROES TO WSS-VAL-CAPI IN WSS-LD1
                             WSS-VAL-READ IN WSS-LD1
                             WSS-VAL-INTD IN WSS-LD1
                             WSS-VAL-GAST IN WSS-LD1
                             WSS-SGV-MLIQ IN WSS-LD1
                             WSS-VAL-VCFP IN WSS-LD1
              MOVE SPACES TO WSS-GLS-EJEL IN WSS-LD1
      *DAD ini  21-OCT-1994
      *                       WSS-GLS-FPAG IN WSS-LD1
      *                       WSS-GLS-FORP IN WSS-LD1
      *DAD fin  21-OCT-1994
                             WSS-GLS-OFIL IN WSS-LD1
                             WSS-GLS-VCFP IN WSS-LD1
                             WSS-GLS-VCFL IN WSS-LD1
                             WSS-NUM-DLIQ IN WSS-LD1
                             WSS-GLS-RAY1 IN WSS-LD1
                             WSS-NUM-MLIQ IN WSS-LD1
                             WSS-GLS-RAY2 IN WSS-LD1
                             WSS-NUM-SLIQ IN WSS-LD1
                             WSS-NUM-ALIQ IN WSS-LD1
              GO TO FIN-PUT-LIQ-LD1.

           MOVE LIQ-FEC-FREA IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO WSS-NUM-DLIQ IN WSS-LD1.
           MOVE '-'                      TO WSS-GLS-RAY1 IN WSS-LD1
                                            WSS-GLS-RAY2 IN WSS-LD1.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO WSS-NUM-MLIQ IN WSS-LD1.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO WSS-NUM-SLIQ IN WSS-LD1.
           MOVE WSS-NUM-APAS IN WSS-VARI TO WSS-NUM-ALIQ IN WSS-LD1.

           MOVE SPACES TO WSS-GLS-EJEL IN WSS-LD1.
           IF LIQ-COD-EJEC IN SRT > SPACES
               MOVE LIQ-COD-EJEC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEL IN WSS-LD1.

           MOVE SPACES TO WSS-GLS-OFIL IN WSS-LD1.
           IF LIQ-COD-OFIC IN SRT > SPACES
              MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
              PERFORM BUS-OFI
              MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIL IN WSS-LD1.

           MOVE CAD-CAI-IOPD IN SRT TO CAD-CAI-IOPD IN CAD.
           MOVE CAD-IIC-IOPD IN SRT TO CAD-IIC-IOPD IN CAD.
           MOVE '001'               TO CAD-NUM-ILIQ IN CAD.
           MOVE '1'                 TO CAD-NUM-ICAD IN CAD.
           PERFORM DAP-FIO-CAD.
           IF NOT ( FIO-STAT-OKS )
              DISPLAY 'NO EXISTE CAD PARA LIQ ' FIO-STAT
                       ' ' CAD-KEY-ICAD IN CAD.

      *DAD ini  21-OCT-1994
      *BUS-MSC busca miscelaneo en tabla
      *     MOVE SPACES TO WSS-GLS-FPAG IN WSS-LD1
      *                    WSS-GLS-FORP IN WSS-LD1.
      *     MOVE 'TAB'  TO MSC-COD-SIST.
      *     MOVE 'TCYA' TO MSC-COD-TMSC IN MSC.
      *     MOVE CAD-IND-TCAD IN CAD TO MSC-COD-CMSC IN MSC.
      *     PERFORM BUS-MSC.
      *     IF MSC-GLS-DESC IN MSC > SPACES
      *        MOVE 'FORMA DE PAGO' TO WSS-GLS-FORP IN WSS-LD1
      *        MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-FPAG IN WSS-LD1.
      *DAD fin  21-OCT-1994

      *JVM:24/09/92 Este reporte solo genera aviso de renovacion
            PERFORM PRO-REN-LD1.

      *Diferencia entre LIQ Normal y LIQ Anticipada
      *     IF LIQ-COD-LIQU IN SRT = 'RC'
      *        PERFORM PRO-SLA-LD1
      *     ELSE
      *        PERFORM PRO-LIQ-LD1.
       FIN-PUT-LIQ-LD1.
           EXIT.

       PRO-REN-LD1 SECTION.
       INI-PRO-REN-LD1.
           MOVE ZEROES                TO WSS-VAL-CAPI IN WSS-LD1.
           MOVE ZEROES                TO WSS-VAL-READ IN WSS-LD1.
      * JVM : Para liquid de renovables no hay capital ni reajuste
           MOVE LIQ-SGV-TPAG IN SRT   TO WSS-VAL-INTD IN WSS-LD1.
           MOVE LIQ-SGV-PESO IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1.

      * JVM : Para DPI solo hay intereses en LIQ
           MOVE LIQ-SGV-GAST IN SRT   TO WSS-VAL-GAST IN WSS-LD1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-PESO IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = '1013  '
              MOVE LIQ-SGV-TPAG IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1
              MOVE SPACES TO WSS-GLS-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-READ IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-GAST IN WSS-LD1
              GO TO FIN-PRO-REN-LD1.

      * Genera Datos Moneda Reajustable U.F. , US$REAJ para Detalle
      * Vencimiento de LD1
           MOVE 'VALOR DE CAMBIO F. VEN' TO WSS-GLS-VCFP IN WSS-LD1.
           MOVE WSS-SGV-FVEN IN WSS-VARI TO WSS-VAL-VCFP IN WSS-LD1.
       FIN-PRO-REN-LD1.
           EXIT.

       PRO-LIQ-LD1 SECTION.
       INI-PRO-LIQ-LD1.
           MOVE VEN-VAL-CAPI IN SRT   TO WSS-VAL-CAPI IN WSS-LD1.
           MOVE LIQ-SGV-REAJ IN SRT   TO WSS-VAL-READ IN WSS-LD1.
           SUBTRACT VEN-VAL-CAPI IN SRT FROM VEN-VAL-FINA IN SRT
                                  GIVING WSS-VAL-INTD IN WSS-LD1.
           MOVE LIQ-SGV-GAST IN SRT   TO WSS-VAL-GAST IN WSS-LD1.
           MOVE LIQ-SGV-PESO IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-PESO IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = '1013  '
              MOVE SPACES TO WSS-GLS-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-READ IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-GAST IN WSS-LD1
              GO TO FIN-PRO-LIQ-LD1.

      * Genera Datos Moneda Reajustable U.F. , US$REAJ para Detalle
      * Vencimiento de LD1
           MOVE WSS-SGV-FLIQ IN WSS-VARI TO WSS-VAL-VCFP IN WSS-LD1.

      * Calcula Reajustes, Intereses y Capitales en Pesos para Moneda Re
           MULTIPLY VEN-VAL-CAPI IN SRT BY
                       WSS-SGV-FREA IN WSS-VARI  GIVING
                       WSS-VAL-CAPI IN WSS-LD1 ROUNDED.
           MOVE WSS-VAL-CAPI IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-CAPI IN WSS-LD1.

           IF LIQ-FEC-FREA IN SRT NOT < VEN-FEC-FVEN IN SRT
              MOVE 'VALOR DE CAMBIO F. VEN' TO
                                    WSS-GLS-VCFP IN WSS-LD1
              MOVE WSS-SGV-FVEN IN WSS-VARI TO
                                   WSS-SGV-FLIQ IN WSS-VARI.

           MULTIPLY WSS-VAL-INTD IN WSS-LD1 BY
                       WSS-SGV-FLIQ IN WSS-VARI  GIVING
                       WSS-VAL-INTD IN WSS-LD1 ROUNDED.
           MOVE WSS-VAL-INTD IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-INTD IN WSS-LD1.

       OBT-MLIQ.
           MOVE LIQ-SGV-TPAG IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1.

           MULTIPLY LIQ-SGV-TPAG IN SRT BY
                    WSS-SGV-FLIQ IN WSS-VARI  GIVING
                    WSS-SGV-MLIQ IN WSS-LD1 ROUNDED.
           MOVE WSS-SGV-MLIQ IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-MLIQ IN WSS-LD1.
       FIN-PRO-LIQ-LD1.
           EXIT.

       PRO-SLA-LD1 SECTION.
       INI-PRO-SLA-LD1.
      *     DISPLAY 'LIQ-CAPI ' LIQ-SGV-CAPI IN SRT.
           MOVE LIQ-SGV-CAPI IN SRT   TO WSS-VAL-CAPI IN WSS-LD1.
           MOVE LIQ-SGV-REAJ IN SRT   TO WSS-VAL-READ IN WSS-LD1.
           SUBTRACT LIQ-SGV-CAPI IN SRT FROM LIQ-SGV-TPAG IN SRT
                                  GIVING WSS-VAL-INTD IN WSS-LD1.
           MOVE LIQ-SGV-GAST IN SRT   TO WSS-VAL-GAST IN WSS-LD1.
           MOVE LIQ-SGV-PESO IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1.

           IF OPD-COD-VCAM IN SRT = WSS-COD-PESO IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = WSS-COD-DOLL IN WSS-VARI OR
              OPD-COD-VCAM IN SRT = '1013  '
              MOVE SPACES TO WSS-GLS-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-VCFP IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-READ IN WSS-LD1
              MOVE ZEROES TO WSS-VAL-GAST IN WSS-LD1
              GO TO FIN-PRO-SLA-LD1.

      * Genera Datos Moneda Reajustable U.F. , US$REAJ para Detalle
      * Vencimiento de LD1
           MOVE WSS-SGV-FLIQ IN WSS-VARI TO WSS-VAL-VCFP IN WSS-LD1.
           MOVE 'VALOR DE CAMBIO F. LIQ' TO WSS-GLS-VCFP IN WSS-LD1.

      * Calcula Reajustes, Intereses y Capitales en Pesos para Moneda Re
           MULTIPLY LIQ-SGV-CAPI IN SRT BY
                       WSS-SGV-FREA IN WSS-VARI  GIVING
                       WSS-VAL-CAPI IN WSS-LD1 ROUNDED.
           MOVE WSS-VAL-CAPI IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-CAPI IN WSS-LD1.

           MULTIPLY WSS-VAL-INTD IN WSS-LD1 BY
                       WSS-SGV-FLIQ IN WSS-VARI  GIVING
                       WSS-VAL-INTD IN WSS-LD1 ROUNDED.
           MOVE WSS-VAL-INTD IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-VAL-INTD IN WSS-LD1.

       OBT-MLIQ-SLA.
           MOVE LIQ-SGV-TPAG IN SRT   TO WSS-SGV-MLIQ IN WSS-LD1.

           MULTIPLY LIQ-SGV-TPAG IN SRT BY
                    WSS-SGV-FLIQ IN WSS-VARI  GIVING
                    WSS-SGV-MLIQ IN WSS-LD1 ROUNDED.
           MOVE WSS-SGV-MLIQ IN WSS-LD1 TO PES-SGV-DECI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE TO WSS-SGV-MLIQ IN WSS-LD1.

      *     IF OPD-COD-RESC IN SRT = 'I'
      *        ADD WSS-VAL-CAPI IN WSS-LD1
      *            WSS-VAL-INTD IN WSS-LD1 TO
      *            WSS-SGV-MLIQ IN WSS-LD1
      *     ELSE
      *     IF OPD-COD-RESC IN SRT = 'N'
      *        MULTIPLY LIQ-SGV-TPAG IN SRT BY
      *                 WSS-SGV-FREA IN WSS-VARI  GIVING
      *                 WSS-SGV-MLIQ IN WSS-LD1 ROUNDED
      *     ELSE
      *     IF OPD-COD-RESC IN SRT = 'R'
      *        MULTIPLY LIQ-SGV-CAPI IN SRT BY
      *                 WSS-SGV-FLIQ IN WSS-VARI  GIVING
      *                 WSS-SGV-MLIQ IN WSS-LD1 ROUNDED
      *     ELSE
      *     IF OPD-COD-RESC IN SRT = 'A'
      *        MULTIPLY LIQ-SGV-TPAG IN SRT BY
      *                 WSS-SGV-FLIQ IN WSS-VARI  GIVING
      *                 WSS-SGV-MLIQ IN WSS-LD1 ROUNDED.
      *
      *     MOVE WSS-SGV-MLIQ IN WSS-LD1 TO PES-SGV-DECI.
      *     PERFORM PES-SCTV.
      *     MOVE PES-SGV-ENTE TO WSS-SGV-MLIQ IN WSS-LD1.
       FIN-PRO-SLA-LD1.
           EXIT.

       PUT-REN-LD1 SECTION.
       INI-PUT-REN-LD1.

           MOVE OPD-FEC-FPVC IN SRT TO WSS-FEC-FPAS IN WSS-VARI.
           MOVE WSS-NUM-DPAS IN WSS-VARI TO WSS-NUM-DPVC IN WSS-LD1.
           MOVE WSS-NUM-MPAS IN WSS-VARI TO WSS-NUM-MPVC IN WSS-LD1.
           MOVE WSS-NUM-SPAS IN WSS-VARI TO WSS-NUM-SPVC IN WSS-LD1.
           MOVE WSS-NUM-APAS IN WSS-VARI TO WSS-NUM-APVC IN WSS-LD1.
           MOVE OPD-VAL-CAPT IN SRT TO WSS-VAL-CAPR IN WSS-LD1.

           MOVE 'NO HABIENDOSE RECIBIDO EL AVISO PREV' TO
                               WSS-GLS-MSG11 IN WSS-VARI.
           MOVE 'IO DE RETIRO, ESTE  DEPOSITO QUEDA' TO
                               WSS-GLS-MSG12 IN WSS-VARI.
           MOVE WSS-GLS-MSG1 IN WSS-VARI TO
                                 WSS-GLS-MSG1 IN WSS-LD1.
           MOVE 'RENOVADO POR UN NUEVO PERIODO  A LA' TO
                               WSS-GLS-MSG21 IN WSS-VARI.
           MOVE ' TASA DEL ' TO
                               WSS-GLS-MSG22 IN WSS-VARI.
           MOVE OPD-SGV-TINR IN SRT TO
                               WSS-SGV-TASA IN WSS-VARI.
           MOVE WSS-NUM-TAS IN WSS-VARI TO
                               WSS-NUM-TASA IN WSS-VARI.
           MOVE ',' TO WSS-GLS-TASA IN WSS-VARI.
           MOVE WSS-DEC-TAS IN WSS-VARI TO
                               WSS-DEC-TASA IN WSS-VARI.
           MOVE '% '         TO WSS-GLS-FIL1 IN WSS-VARI
           MOVE SPACES       TO WSS-GLS-FIL2 IN WSS-VARI
                                WSS-GLS-FIL3 IN WSS-VARI.
           MOVE WSS-GLS-BCTI IN WSS-LDP TO
                                WSS-GLS-BCTI IN WSS-VARI.
           MOVE WSS-GLS-PBTI IN WSS-LDP TO
                                WSS-GLS-PBTI IN WSS-VARI.
           MOVE WSS-GLS-MCTI IN WSS-LDP TO
                                WSS-GLS-MCTI IN WSS-VARI.
           MOVE WSS-GLS-MSG2 IN WSS-VARI TO
                                 WSS-GLS-MSG2 IN WSS-LD1.
           MOVE 'PERMANECIENDO INVARIABLES LAS DEMAS ' TO
                               WSS-GLS-MSG11 IN WSS-VARI.
           MOVE 'CONDICIONES ESTIPULADAS.           ' TO
                               WSS-GLS-MSG12 IN WSS-VARI.
           MOVE WSS-GLS-MSG1 IN WSS-VARI TO
                                 WSS-GLS-MSG3 IN WSS-LD1.
       FIN-PUT-REN-LD1.
           EXIT.

      * Limpia datos vencimiento desde VEN
       RST-VEN SECTION.
       INI-RST-VEN.
           MOVE ZEROES TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES TO VEN-NUM-DVEN IN VEN.
           MOVE ZEROES TO VEN-NUM-MVEN IN VEN.
           MOVE ZEROES TO VEN-NUM-SVEN IN VEN.
           MOVE ZEROES TO VEN-NUM-AVEN IN VEN.
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
           MOVE ZEROES TO VEN-VAL-CAPI IN VEN.
       FIN-RST-VEN.
           EXIT.

       OBT-RNG-FEC SECTION.
       INI-OBT-RNG-FEC.

      * JVM: OBTIENE NRO. DIAS DE RENOVACION
           MOVE 'DAP'   TO FIO-SIST.
           MOVE 'REA'   TO TAB-COD-TTAB IN TAB.
           MOVE 'NDREA' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE 'DAP'       TO MSG-COD-SIST
              MOVE 'NDREANEX'  TO MSG-COD-MENS
              PERFORM GET-MSG
              DISPLAY ' '
              DISPLAY 'PROCESO CANCELADO ' MSG-GLS-DESC
              PERFORM GNS-PRO-ABT
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO NUM-NUME
              MOVE NUM-ZERO-N TO NUM-ZERO
              MOVE NUM-SGNO-N TO NUM-SGNO
              MOVE 5 TO NUM-NENT
              MOVE 0 TO NUM-NDCM
              CALL 'GNSPVNUM' USING NUM-VARI
              IF NUM-STAT-OKS
                 MOVE NUM-NN9N TO WSS-NUM-DREA IN WSS-VARI
              ELSE
                 MOVE 'NDREANONUM' TO MSG-COD-MENS
                 MOVE 'DAP'         TO MSG-COD-SIST
                 PERFORM GET-MSG
                 DISPLAY ' '
                 DISPLAY 'PROCESO CANCELADO ' MSG-GLS-DESC
                 PERFORM GNS-PRO-ABT.

      * JVM: OBTIENE FECHA DE TERMINO DE SELECCION
           MOVE 0 TO WSS-NUM-DBUS IN WSS-VARI.
           MOVE WSS-FEC-FPRO TO FEC-FECH.

       LUP-OBT-RNG-FEC.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' EN OBTENCION FECHA AYER '
                            FEC-FECH ' ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      * JVM: YA ESTA CARGADO FEC-FECH
           MOVE FEC-FORM-FEC TO FEC-FORM
           MOVE FEC-FBLK-N  TO FEC-FBLK
           MOVE FEC-CHOY-N  TO FEC-CHOY
           MOVE FEC-VHBL-S  TO FEC-VHBL
           MOVE FEC-VAL-FEC TO FEC-CMND
           PERFORM PRO-FEC
           IF FEC-STAT-HBL
               ADD 1 TO WSS-NUM-DBUS
               IF WSS-NUM-DBUS = WSS-NUM-DREA IN WSS-VARI
                   MOVE FEC-ITM1 TO WSS-NUM-DTER IN WSS-VARI
                   MOVE FEC-ITM2 TO WSS-NUM-MTER IN WSS-VARI
                   MOVE FEC-ITM3 TO WSS-NUM-STER IN WSS-VARI
                   MOVE FEC-ITM4 TO WSS-NUM-ATER IN WSS-VARI
               ELSE
                   GO TO LUP-OBT-RNG-FEC
           ELSE
               GO TO LUP-OBT-RNG-FEC.

           MOVE WSS-FEC-FTER IN WSS-VARI TO WSS-FEC-FCZO IN WSS-VARI.

           MOVE WSS-NUM-DCZO IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCZO IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCZO IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACZO IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' EN OBTENCION FECHA COMIENZO '
                      FEC-FECH ' ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      * JVM: YA ESTA CARGADO FEC-FECH
       LUP-GET-CZO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-ITM1 TO WSS-NUM-DCZO IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-NUM-MCZO IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-NUM-SCZO IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-NUM-ACZO IN WSS-VARI
               MOVE FEC-RST-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               MOVE FEC-FORM-FEC TO FEC-FORM
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   DISPLAY ' '
                   DISPLAY ' PROCESO CANCELADO '
                   DISPLAY ' EN OBTENCION FECHA COMIENZO '
                        FEC-FECH ' ' FEC-MENS
                   PERFORM GNS-PRO-ABT
               ELSE
                   GO TO LUP-GET-CZO.
           DISPLAY ' '.
           DISPLAY 'FECHA DE INICIO  DE SELECCION '
                         WSS-NUM-DCZO
                         WSS-NUM-MCZO
                         WSS-NUM-SCZO
                         WSS-NUM-ACZO.
           DISPLAY 'FECHA DE TERMINO DE SELECCION '
                         WSS-NUM-DTER
                         WSS-NUM-MTER
                         WSS-NUM-STER
                         WSS-NUM-ATER.
           DISPLAY ' '.

       FIN-OBT-RNG-FEC.
           EXIT.

      *Entidades de GNS
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBBMSG.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGPES.
       COPY GNSBGINT.
      *RVM-BEE-INI 25-JUN-1997
       COPY GNSBGBAR.
      *RVM-BEE-FIN 25-JUN-1997
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFRCC.
       COPY DAPBFVEN.
       COPY DAPBFCAD.
      *Entidades de TAB
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFCAM.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBVOFI.
       COPY TABBVUSR.
      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>
*% END
