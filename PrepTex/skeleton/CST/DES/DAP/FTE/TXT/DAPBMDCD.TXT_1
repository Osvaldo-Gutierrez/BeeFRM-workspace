*%! codigo adicional DAPBMDCD
*% IF SETTAG
*% FNCBQ = "DAPNVA"
*% VSNBQ = "07.11.22"
*% FNCBU = "DAPNVA"
*% VSNBU = "07.11.22"
*% END
*% IF INI_PUT_DBC_DCD
      *<<<< INI_PUT_DBC_DCD
      *>>>>
*% END
*% IF FIN_PUT_DBC_DCD
      *<<<< FIN_PUT_DBC_DCD
      *>>>>
*% END
*% IF FIN_PUT_OPD_DCD
      *<<<< FIN_PUT_OPD_DCD

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN DCD-FLD.

      *BUS-OFI busca oficina en tablas
           MOVE OPD-COD-OFIC IN DCD-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DCD-FLD.

      *>>>> FIN_PUT_OPD_DCD
*% END
*% IF INI_FST_FLD_DCD
      *<<<< INI_FST_FLD_DCD
           IF SCR-CMND = 'A57' OR
              SCR-CCPP = 'ING'
               MOVE FRM-POS-CURS TO 
                    DCD-COD-A57B-LEN IN DCD-FLD
               GO TO FIN-FST-FLD-DCD.
           IF SCR-CMND = 'DDE'
               PERFORM FST-MSG    
               GO TO FIN-FST-FLD-DCD.
      *>>>> INI_FST_KEY_OPD 
*% END
*% IF FIN_PUT_DCD_DCD
      *BUS-TAB busca glosa de codigo en tabla
           IF DCD-COD-A57B IN DCD-FLD > SPACES
               MOVE 'DAP' TO TAB-COD-SIST
               MOVE 'A57 ' TO TAB-COD-TTAB IN TAB
               MOVE DCD-COD-A57B IN DCD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-A57B IN DCD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-A57B IN DCD-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF DCD-COD-DOEF IN DCD-FLD > SPACES
               MOVE 'DAP' TO TAB-COD-SIST
               MOVE 'DOE ' TO TAB-COD-TTAB IN TAB
               MOVE DCD-COD-DOEF IN DCD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DOEF IN DCD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-DOEF IN DCD-FLD.
*% END
*% IF FIN_DCD_COD_A57B
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'A57 ' TO TAB-COD-TTAB IN TAB.
           MOVE DCD-COD-A57B IN DCD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCD-COD-A57B IN DCD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-A57B IN DCD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-A57B IN DCD-FLD.
*% END
*% IF FIN_DCD_COD_DOEF
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'DOE ' TO TAB-COD-TTAB IN TAB.
           MOVE DCD-COD-DOEF IN DCD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCD-COD-DOEF IN DCD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DOEF IN DCD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DOEF IN DCD-FLD.
*% END
