*%! Codigo adicional
*% PGM_PTC = FALSE
*% GNSTCA = 290 
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.                                                   
       COPY GNSWGCPT.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.        
       COPY TABBROFI.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.        
       COPY TABBRUSR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
       COPY GNSBRMSC.                                                   
       COPY GNSWVNUM.                                                   
       COPY GNSWCNUM.                                                   
       COPY GNSWGFEC.                                                   
       COPY GNSWGHOY.                                                   
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
       COPY GNSWGIDC.                                                   
       COPY SGCBRDBC.                                                   
       COPY GNSWGCPT.                                                   
      *>>>>                                                             
*% END
*% IF FIN_PGM_STAT
           03 PGM-STAT.                                                 
              05 PGM-STAT-STA.                                          
                 88 PGM-STAT-STA-NUL    VALUE '  '.                     
                 07 PGM-STT1-STA        VALUE '2' PIC X(01).            
                    88 PGM-STAT-STA-OKS VALUE '0'.                      
                 07 PGM-STT2-STA        VALUE '3' PIC X(01).            
              05 PGM-STAT-USR.                                          
                 88 PGM-STAT-USR-NUL    VALUE '  '.                     
                 07 PGM-STT1-USR        VALUE '2' PIC X(01).            
                    88 PGM-STAT-USR-OKS VALUE '0'.                      
                 07 PGM-STT2-USR        VALUE '3' PIC X(01).            
              05 PGM-STAT-DBC.                                          
                 88 PGM-STAT-DBC-NUL    VALUE '  '.                     
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).            
                    88 PGM-STAT-DBC-OKS VALUE '0'.                      
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).            
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC                                                     
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
      *>>>>                                                             
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI                                                
           03  SCR-VARI-PFS.                                            
               05  SCR-KEY-ISTA-ACTU      PIC X(40).                    
      *>>>>                                                             
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC                                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-STA                                  
               PERFORM VAL-NUM-FLD-STA                                  
               PERFORM SCRL-TAB-STA                                     
               PERFORM SCR-TRL.                                         
      *>>>>                                                             
*% END
*% IF FND_KEY 
     *<<<<<FND_KEY
           IF SCR-CMND = 'ING'                                          
              PERFORM BUS-COR-ING                                       
              PERFORM KEY-ALL-STA.                                      
           IF SCR-CMND = 'CON'                                          
              PERFORM LEE-REG-CON                                       
              IF FIO-STAT = 23                                          
                 GO TO FIN-FND-KEY.                                     
     *>>>>
*% END
*% IF FIN_FND_KEY 
     *<<<<<FIN_FND_KEY
           IF ( SCR-CMND = 'MOD' OR 'ELI' ) AND FIO-STAT-OKS            
              PERFORM VAL-CMN-MOD.                                      
     *>>>>>
*% END
*% IF PUT_SCR 
      *<<<< PUT_SCR                                                     
           IF PGM-STAT-STA-OKS                                          
               MOVE STA-KEY-ISTA IN STA TO SCR-KEY-ISTA-ACTU.           
      *>>>>                                                             
*% END
*% IF PFS_GET_CON AND PGM_PQ
      *<<<< PFS_GET_CON                                                 
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )                           
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )                           
      *>>>>                                                             
*% END
*% IF EOF
      *<<<< EOF                                                   
       SCRL-TAB-STA SECTION.                                            
       INI-SCRL-TAB-STA.                                                
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF5                   
               PERFORM SCRL-TAB-STA-PF7                                 
               GO TO FIN-SCRL-TAB-STA.                                  
           IF FRM-FFLD = FRM-FFLD-PF8  OR FRM-FFLD-PF6                  
               PERFORM SCRL-TAB-STA-PF8                                 
               GO TO FIN-SCRL-TAB-STA.                                  
       FIN-SCRL-TAB-STA.                                                
           EXIT.                                                        
                                                                        
       SCRL-TAB-STA-PF7 SECTION.                                        
       INI-SCRL-TAB-STA-PF7.                                            
           MOVE SCR-KEY-ISTA-ACTU TO STA-KEY-ISTA IN STA.               
           MOVE 'STA-KEY-ISTA' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'STACURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-STA-PF7.                              
       PRV-SCRL-TAB-STA-PF8.                                            
           MOVE 'STA-KEY-ISTA' TO FIO-AKEY.                             
           MOVE FIO-GET-PRV TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'STA    NOPRV' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-STA-PF7.                              
           MOVE FIO-STAT TO PGM-STAT-STA.                               
           PERFORM SCR-CLRA-STA.                                        
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-STA-PF7.                                  
       MSG-SCRL-TAB-STA-PF7.                                            
           MOVE 'DAP' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-STA-PF7.                                            
           EXIT.                                                        
                                                                        
       SCRL-TAB-STA-PF8 SECTION.                                        
       INI-SCRL-TAB-STA-PF8.                                            
           MOVE SCR-KEY-ISTA-ACTU TO STA-KEY-ISTA IN STA.               
           MOVE 'STA-KEY-ISTA' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'STACURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-STA-PF8.                              
       NXT-SCRL-TAB-STA-PF8.                                            
           MOVE 'STA-KEY-ISTA' TO FIO-AKEY.                             
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'STA    NONXT' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-STA-PF8.                              
           MOVE FIO-STAT TO PGM-STAT-STA.                               
           PERFORM SCR-CLRA-STA.                                        
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-STA-PF8.                                  
       MSG-SCRL-TAB-STA-PF8.                                            
           MOVE 'DAP' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-STA-PF8.                                            
           EXIT.                                                        
      *>>>>                                                             
      *<<<< EOF                                                         
       COPY GNSBVNUM.                                                   
       COPY GNSBGHOY.
       COPY GNSBGFEC.                                                   
       COPY TABBBOFI.                                                   
       COPY TABBFOFI.                                                   
       COPY TABBBUSR.                                                   
       COPY TABBVUSR.                                                   
       COPY TABBFUSR.                                                   
       COPY GNSBEGLS.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBVIND.                                                   
       COPY GNSBVMSC.                                                   
       COPY GNSBFMSC.                                                   
       COPY GNSBVIDC.                                                   
       COPY GNSBPVRF.                                                   
       BUS-COR-ING SECTION.                                             
       INI-BUS-COR-ING.                                                 
           MOVE 99 TO STA-NUM-ICOR IN STA.                              
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    STA-COD-USER IN STA = STA-COD-USER IN STA-FLD AND   
                    STA-CAI-ICLI IN STA = DBC-CAI-ICLI IN STA-FLD AND   
                    STA-IIC-ICLI IN STA = DBC-IIC-ICLI IN STA-FLD AND   
                    STA-NUM-DSTA IN STA = STA-NUM-DSTA IN STA-FLD AND   
                    STA-NUM-MSTA IN STA = STA-NUM-MSTA IN STA-FLD AND   
                    STA-NUM-SSTA IN STA = STA-NUM-SSTA IN STA-FLD AND   
                    STA-NUM-ASTA IN STA = STA-NUM-ASTA IN STA-FLD AND   
                    STA-COD-VCAM IN STA = STA-COD-VCAM IN STA-FLD )     
              MOVE 1 TO STA-NUM-ICOR IN STA-FLD STA-NUM-ICOR IN STA     
           ELSE                                                         
              ADD 1 STA-NUM-ICOR IN STA GIVING STA-NUM-ICOR IN STA-FLD  
                                               STA-NUM-ICOR IN STA.     
       FIN-BUS-COR-ING.                                                 
           EXIT.                                                        
       LEE-REG-CON SECTION.                                             
       INI-LEE-REG-CON.                                                 
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM DAP-FIO-STA.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO ERR-LEE-REG-CON.                                    
           IF STA-COD-USER IN STA NOT = STA-COD-USER IN STA-FLD         
              GO TO ERR-LEE-REG-CON.                                    
           IF DBC-CAI-ICLI IN STA-FLD  > SPACES OR                      
              DBC-IIC-ICLI IN STA-FLD  > ZEROES                         
              IF STA-CAI-ICLI IN STA NOT = DBC-CAI-ICLI IN STA-FLD OR   
                 STA-IIC-ICLI IN STA NOT = DBC-IIC-ICLI IN STA-FLD      
                 GO TO ERR-LEE-REG-CON.                                 
           IF STA-FEC-FSTA IN STA-FLD > SPACES                          
              IF STA-NUM-DSTA IN STA NOT = STA-NUM-DSTA IN STA-FLD OR   
                 STA-NUM-MSTA IN STA NOT = STA-NUM-MSTA IN STA-FLD OR   
                 STA-NUM-SSTA IN STA NOT = STA-NUM-SSTA IN STA-FLD OR   
                 STA-NUM-ASTA IN STA NOT = STA-NUM-ASTA IN STA-FLD      
                 GO TO ERR-LEE-REG-CON.                                 
           IF STA-COD-VCAM IN STA-FLD > SPACES                          
              IF STA-COD-VCAM IN STA NOT = STA-COD-VCAM IN STA-FLD      
                 GO TO ERR-LEE-REG-CON.                                 
           IF STA-COD-VCAM IN STA-FLD NOT  > SPACES                     
              PERFORM SETEA-MONE.                                       
           IF DBC-CAI-ICLI IN STA-FLD  NOT > SPACES OR                  
              DBC-IIC-ICLI IN STA-FLD  NOT > ZEROES                     
              PERFORM SETEA-CLIE.                                       
           GO TO FIN-LEE-REG-CON.                                       
       ERR-LEE-REG-CON.                                                 
           MOVE 'DAP'          TO MSG-COD-SIST                          
           MOVE 'REG    INEX ' TO MSG-COD-MENS                          
           PERFORM GET-MSG                                              
           MOVE MSG-GLS-DESC TO FRM-MENS                                
           MOVE FRM-SUAR-MAL TO FRM-SUAR                                
           MOVE 23 TO FIO-STAT.                                         
       FIN-LEE-REG-CON.                                                 
           EXIT.                                                        
       VAL-CMN-MOD SECTION.                                             
       INI-VAL-CMN-MOD.                                                 
           IF STA-CAI-IOPD IN STA > SPACES OR                           
              STA-IIC-IOPD IN STA > SPACES                              
              MOVE 'DAP'          TO MSG-COD-SIST                       
              MOVE 'REG   USADO ' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE SCR-STAT-CON TO SCR-STAT.                            
       FIN-VAL-CMN-MOD.                                                 
           EXIT.                                                        
       SETEA-CLIE SECTION.                                              
       INI-SETEA-CLIE.                                                  
              MOVE STA-CAI-ICLI IN STA TO DBC-CAI-ICLI IN DBC           
                   DBC-CAI-ICLI IN STA-FLD.                             
              MOVE STA-IIC-ICLI IN STA TO DBC-IIC-ICLI IN DBC           
                   DBC-IIC-ICLI IN STA-FLD.                             
       FIN-SETEA-CLIE.                                                  
           EXIT.                                                        
       LEE-DBC SECTION.                                                 
       INI-LEE-DBC.                                                     
              MOVE FIO-GET-KEY TO FIO-CMND.                             
              PERFORM SGC-FIO-DBC.                                      
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'DAP'          TO MSG-COD-SIST                    
                 MOVE 'IDC    NOCLI' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
              ELSE                                                      
                 MOVE '00' TO PGM-STAT-DBC                              
                 MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN STA-FLD    
                 MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN STA-FLD    
                 MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN STA-FLD    
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC                   
                                  DBC-GLS-NOMC IN STA-FLD.              
       FIN-LEE-DBC.                                                     
           EXIT.                                                        
       SETEA-MONE SECTION.                                              
       INI-SETEA-MONE.                                                  
           MOVE STA-COD-VCAM IN STA TO TAB-COD-CTAB IN TAB              
                                       STA-COD-VCAM IN STA-FLD.         
       FIN-SETEA-MONE.                                                  
           EXIT.                                                        
       COPY SGCBFDBC.                                                   
       COPY GNSBGCPT.                                                   
      *>>>>                                                             
*% END
