*% IF INI_VAL_NUM_IKY_FDO AND PGM_BU
    *<<<<<INI_VAL_NUM_IKY_FDO
       VAL-NUM-OPD-IIC-IOPD.                                            
           MOVE OPD-IIC-IOPD-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-IIC-IOPD IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-IIC-IOPD-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-IKY-FDO.                              
           GO TO FIN-VAL-NUM-IKY-FDO.
    *>>>>>
*% END
*% IF EDT_IKY_FDO AND PGM_BU
    *<<<<EDT_IKY_FDO
           IF OPD-IIC-IOPD-LEN IN FDO-FLD = -9                          
                MOVE -1 TO OPD-IIC-IOPD-LEN IN FDO-FLD                  
                GO TO FIN-EDT-IKY-FDO.                                  
           MOVE OPD-IIC-IOPD IN FDO-FLD TO OPD-IIC-IOPD-EDT IN FDO-EDT. 
           MOVE OPD-IIC-IOPD-EDT IN FDO-EDT TO                          
                OPD-IIC-IOPD-ALF IN FDO-FLD.                            
           GO TO FIN-EDT-IKY-FDO.
    *>>>>
*% END
*% IF INI_VAL_IKY_FDO AND PGM_BQ
    *<<<<INI_VAL_IKY_FDO
           PERFORM VAL-OPD-CAI-IOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-CAI-IOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-IKY-FDO.                                  
           PERFORM VAL-OPD-IIC-IOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-IIC-IOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-IKY-FDO.                                  
           GO TO FIN-VAL-IKY-FDO.
    *>>>>
*% END
*% IF INI_VAL_NUM_IKY_FDO AND PGM_BQ  
   *<<<<INI_VAL_NUM_IKY_FDO
       VAL-NUM-OPD-IIC-IOPD.                                            
           MOVE OPD-IIC-IOPD-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-IIC-IOPD IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-IIC-IOPD-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-IKY-FDO.                              
           GO TO FIN-VAL-NUM-IKY-FDO
   *>>>>
*% END
*% IF INI_VAL_CON_IKY_FDO AND PGM_BQ
    *<<<<<INI_VAL_CON_IKY_FDO
           IF     OPD-CAI-IOPD IN FDO-FLD NOT > SPACES                  
              AND OPD-IIC-IOPD IN FDO-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-FDO.                                    
           GO TO FIN-VAL-CON-IKY-FDO.
    *>>>>>
*% END
*% IF INI_VAL_CON_KEY_FDO AND PGM_BQ
    *<<<<<INI_VAL_CON_KEY_FDO
           IF     OPD-CAI-IOPD IN FDO-FLD NOT > SPACES                  
              AND OPD-IIC-IOPD IN FDO-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-FDO.                                    
           GO TO FIN-VAL-CON-KEY-FDO.
    *>>>>>
*% END
*% IF EDT_IKY_FDO
    *<<<<EDT_IKY_FDO
           IF OPD-IIC-IOPD-LEN IN FDO-FLD = -9                          
                MOVE -1 TO OPD-IIC-IOPD-LEN IN FDO-FLD                  
                GO TO FIN-EDT-IKY-FDO.                                  
           MOVE OPD-IIC-IOPD IN FDO-FLD TO OPD-IIC-IOPD-EDT IN FDO-EDT. 
           MOVE OPD-IIC-IOPD-EDT IN FDO-EDT TO                          
                OPD-IIC-IOPD-ALF IN FDO-FLD.                            
           GO TO FIN-EDT-IKY-FDO.
    *>>>>
*% END
*% IF INI_VAL_NUM_IKY_FDO
    *<<<<<INI_VAL_NUM_IKY_FDO
       VAL-NUM-OPD-IIC-IOPD.                                            
           MOVE OPD-IIC-IOPD-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-IIC-IOPD IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-IIC-IOPD-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-IKY-FDO.                              
           GO TO FIN-VAL-NUM-IKY-FDO.
    *>>>>>
*% END
*% IF INI_RET_OPD_FDO
    *<<<<INI_RET_OPD_FDO
           MOVE OPD-CAI-ISER IN FDO-FLD TO OPD-CAI-ISER IN OPD.         
           MOVE OPD-IIC-ISER IN FDO-FLD TO OPD-IIC-ISER IN OPD.         
    *>>>>
*% END 
*% IF INI_RET_DBC_FDO
   *<<<<
           MOVE DBC-NUM-ICLI IN FDO-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-VRF-ICLI IN FDO-FLD TO DBC-VRF-ICLI IN DBC.         
           MOVE DBC-IND-ICLI IN FDO-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE DBC-GLS-ICLI IN FDO-FLD TO DBC-GLS-ICLI IN DBC.         
   *>>>>
*% END 
*% IF INI_VAL_FLD_FDO
   *<<<<INI_VAL_FLD_FDO
           PERFORM VAL-OPD-CAI-ISER.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-CAI-ISER-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-IIC-ISER.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-IIC-ISER-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-VCAM.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-VCAM-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-TOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-TOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-AOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-AOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-OFIC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-OFIC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-VCAM.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-VCAM-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-TOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-TOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-AOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-AOPD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-OFIC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-OFIC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-DBC-GLS-NOMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-GLS-NOMC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-DBC-IND-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-IND-ICLI-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-DBC-GLS-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-GLS-ICLI-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-DBC-NUM-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-NUM-ICLI-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-DBC-VRF-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-VRF-ICLI-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-EJEC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-EJEC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-EJEC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-EJEC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-IMP-VAL-VPES.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IMP-VAL-VPES-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-IMP-VAL-CAPT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IMP-VAL-CAPT-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-SGV-TINT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-SGV-TINT-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-IMP-VAL-VFIN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IMP-VAL-VFIN-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-TINT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-TINT-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-NUM-PVEN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-NUM-PVEN-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-IND-PVEN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-IND-PVEN-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-FRM-GLS-PVEN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-PVEN-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-FEC-FPVC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-FEC-FPVC-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-FEC-FCMP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-FEC-FCMP-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-FEC-FREA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-FEC-FREA-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-FEC-FCTB.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-FEC-FCTB-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-CUST.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-CUST-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-CAD-IND-TCAD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO CAD-IND-TCAD-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-OPD-COD-STAT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO OPD-COD-STAT-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           PERFORM VAL-ODF-NUM-NDAP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO ODF-NUM-NDAP-LEN IN FDO-FLD                  
                GO TO FIN-VAL-FLD-FDO.                                  
           GO TO FIN-VAL-FLD-FDO.
   *>>>> 
*% END
*% IF EDT_FLD_FDO
   *<<<<EDT_FLD_FDO
               IF OPD-IIC-ISER-LEN IN FDO-FLD = -9                          
                MOVE -1 TO OPD-IIC-ISER-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE OPD-IIC-ISER IN FDO-FLD TO OPD-IIC-ISER-EDT IN FDO-EDT. 
           MOVE OPD-IIC-ISER-EDT IN FDO-EDT TO                          
                OPD-IIC-ISER-ALF IN FDO-FLD.                            
           IF DBC-NUM-ICLI-LEN IN FDO-FLD = -9                          
                MOVE -1 TO DBC-NUM-ICLI-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE DBC-NUM-ICLI IN FDO-FLD TO DBC-NUM-ICLI-EDT IN FDO-EDT. 
           MOVE DBC-NUM-ICLI-EDT IN FDO-EDT TO                          
                DBC-NUM-ICLI-ALF IN FDO-FLD.                            
           IF IMP-VAL-VPES-LEN IN FDO-FLD = -9                          
                MOVE -1 TO IMP-VAL-VPES-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE IMP-VAL-VPES IN FDO-FLD TO IMP-VAL-VPES-EDT IN FDO-EDT. 
           MOVE IMP-VAL-VPES-EDT IN FDO-EDT TO                          
                IMP-VAL-VPES-ALF IN FDO-FLD.                            
           IF IMP-VAL-CAPT-LEN IN FDO-FLD = -9                          
                MOVE -1 TO IMP-VAL-CAPT-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE IMP-VAL-CAPT IN FDO-FLD TO IMP-VAL-CAPT-EDT IN FDO-EDT. 
           MOVE IMP-VAL-CAPT-EDT IN FDO-EDT TO                          
                IMP-VAL-CAPT-ALF IN FDO-FLD.                            
           IF OPD-SGV-TINT-LEN IN FDO-FLD = -9                          
                MOVE -1 TO OPD-SGV-TINT-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE OPD-SGV-TINT IN FDO-FLD TO OPD-SGV-TINT-EDT IN FDO-EDT. 
           MOVE OPD-SGV-TINT-EDT IN FDO-EDT TO                          
                OPD-SGV-TINT-ALF IN FDO-FLD.                            
           IF IMP-VAL-VFIN-LEN IN FDO-FLD = -9                          
                MOVE -1 TO IMP-VAL-VFIN-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE IMP-VAL-VFIN IN FDO-FLD TO IMP-VAL-VFIN-EDT IN FDO-EDT. 
           MOVE IMP-VAL-VFIN-EDT IN FDO-EDT TO                          
                IMP-VAL-VFIN-ALF IN FDO-FLD.                            
           IF OPD-NUM-PVEN-LEN IN FDO-FLD = -9                          
                MOVE -1 TO OPD-NUM-PVEN-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE OPD-NUM-PVEN IN FDO-FLD TO OPD-NUM-PVEN-EDT IN FDO-EDT. 
           MOVE OPD-NUM-PVEN-EDT IN FDO-EDT TO                          
                OPD-NUM-PVEN-ALF IN FDO-FLD.                            
           IF ODF-NUM-NDAP-LEN IN FDO-FLD = -9                          
                MOVE -1 TO ODF-NUM-NDAP-LEN IN FDO-FLD                  
                GO TO FIN-EDT-FLD-FDO.                                  
           MOVE ODF-NUM-NDAP IN FDO-FLD TO ODF-NUM-NDAP-EDT IN FDO-EDT. 
           MOVE ODF-NUM-NDAP-EDT IN FDO-EDT TO                          
                ODF-NUM-NDAP-ALF IN FDO-FLD. 
           GO TO FIN-EDT-FLD-FDO.                           
   *>>>>
*% END 
*% IF INI_VAL_NUM_FLD_FDO
   *<<<<
       VAL-NUM-OPD-IIC-ISER.                                            
           MOVE OPD-IIC-ISER-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-IIC-ISER IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-IIC-ISER-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-DBC-NUM-ICLI.                                            
           MOVE DBC-NUM-ICLI-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO DBC-NUM-ICLI-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-IMP-VAL-VPES.                                            
           MOVE IMP-VAL-VPES-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IMP-VAL-VPES IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IMP-VAL-VPES-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-IMP-VAL-CAPT.                                            
           MOVE IMP-VAL-CAPT-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9V TO IMP-VAL-CAPT IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IMP-VAL-CAPT-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-OPD-SGV-TINT.                                            
           MOVE OPD-SGV-TINT-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
           MOVE 2 TO NUM-NENT.                                          
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NS9V TO OPD-SGV-TINT IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-SGV-TINT-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-IMP-VAL-VFIN.                                            
           MOVE IMP-VAL-VFIN-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 11 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9V TO IMP-VAL-VFIN IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IMP-VAL-VFIN-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-OPD-NUM-PVEN.                                            
           MOVE OPD-NUM-PVEN-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 4 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO OPD-NUM-PVEN IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO OPD-NUM-PVEN-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
       VAL-NUM-ODF-NUM-NDAP.                                            
           MOVE ODF-NUM-NDAP-ALF IN FDO-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO ODF-NUM-NDAP IN FDO-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO ODF-NUM-NDAP-LEN IN FDO-FLD                   
                GO TO FIN-VAL-NUM-FLD-FDO.                              
            GO TO FIN-VAL-NUM-FLD-FDO.
  *>>>>
*% END
*% IF INI_CLR_DBC_FDO
    *<<<<
           MOVE ZEROES TO DBC-NUM-ICLI IN FDO-FLD.                      
           MOVE SPACES TO DBC-VRF-ICLI IN FDO-FLD.                      
           MOVE SPACES TO DBC-IND-ICLI IN FDO-FLD.                      
           MOVE SPACES TO DBC-GLS-ICLI IN FDO-FLD.                      
    *>>>>
*% END 
*% IF INI_CLR_OPD_FDO
   *<<<<
           MOVE SPACES TO OPD-CAI-ISER IN FDO-FLD.                      
           MOVE ZEROES TO OPD-IIC-ISER IN FDO-FLD.                      
   *>>>>
*% END 
*% IF FIN_PUT_OPD_FDO
    *<<<<FIN_PUT_OPD_FDO
      *BUS-MSC busca glosa de miscelaneo en tabla                       
           IF OPD-IND-PVEN IN FDO-FLD > SPACES                          
               MOVE 'TAB' TO MSC-COD-SIST                               
               MOVE 'TPER' TO MSC-COD-TMSC IN MSC                       
               MOVE OPD-IND-PVEN IN FDO-FLD TO MSC-COD-CMSC IN MSC      
               PERFORM BUS-MSC                                          
               MOVE MSC-GLS-DCOR IN MSC TO                              
                    FRM-GLS-PVEN IN FDO-FLD                             
           ELSE                                                         
               MOVE SPACES TO                                           
                    FRM-GLS-PVEN IN FDO-FLD.                            
      *<<<< FIN_PUT_OPD_FDO                                             
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.                           
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN FDO-FLD.         
                                                                        
      * busqueda glosa tasa interes asociada a la plantilla             
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'INT' TO TAB-COD-TTAB IN TAB.                           
           MOVE OPD-COD-TINT IN OPD TO TAB-COD-CTAB IN TAB.             
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TINT IN FDO-FLD.         
      *>>>>                                                             
*% END 
*% IF INI_ODF_NUM_NDAP
   *<<<<<INI_ODF_NUM_NDAP
           IF ODF-NUM-NDAP IN FDO-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-ODF-NUM-NDAP.                             
      *<<<< ODF_NUM_NDAP                                                
      *RVM-ADA-INI 20.03.2003                                           
      *    IF ODF-NUM-NDAP IN FDO-FLD < 2                               
           IF ODF-NUM-NDAP IN FDO-FLD < 1                               
      *RVM-ADA-FIN 20.03.2003                                           
               MOVE 'DAP'       TO MSG-COD-SIST                         
      *RVM-ADA-INI 20.03.2003                                           
      *        MOVE 'FDONDAP<2' TO MSG-COD-MENS                         
               MOVE 'FDONDAP<1' TO MSG-COD-MENS                         
      *RVM-ADA-FIN 20.03.2003                                           
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-ODF-NUM-NDAP.                              
            MOVE 50 TO WSS-NDAP.                                        
            MOVE 'DAP' TO FIO-SIST.                                     
            MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                 
            MOVE 'DAPFRAGMAXIM' TO TAB-COD-CTAB IN TAB.                 
            MOVE FIO-GET-KEY TO FIO-CMND.                               
            PERFORM GNS-FIO-TAB.                                        
            IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'               
                IF TAB-GLS-ABRV IN TAB IS NUMERIC                       
                    MOVE TAB-GLS-ABRV TO WSS-NDAP-ALF.                  
            IF ODF-NUM-NDAP IN FDO-FLD > WSS-NDAP                       
               MOVE 'DAP'       TO MSG-COD-SIST                         
               MOVE 'FDONDAP>MAXI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN1                            
               MOVE WSS-NDAP     TO FRM-MEN2                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-ODF-NUM-NDAP.                              
      *>>>>                                                             
*% END 
*% IF EOF_BU
   *<<<<EOF_BU
       VAL-DBC-VRF-ICLI SECTION.                                        
       INI-VAL-DBC-VRF-ICLI.                                            
      *VAL-RUT Valida Rut para campo IDC                                
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE DBC-NUM-ICLI IN FDO-FLD TO IDC-NUM-RUTV.                
           MOVE DBC-VRF-ICLI IN FDO-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
       FIN-VAL-DBC-VRF-ICLI.                                            
           EXIT.                                                        
                                                                        
       VAL-DBC-IND-ICLI SECTION.                                        
       INI-VAL-DBC-IND-ICLI.                                            
      *VAL-IDC Valida identificador                                     
           MOVE DBC-IND-ICLI IN FDO-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN FDO-FLD.                
       FIN-VAL-DBC-IND-ICLI.                                            
           EXIT.                                                        
                                                                        
       VAL-DBC-GLS-ICLI SECTION.                                        
       INI-VAL-DBC-GLS-ICLI.                                            
      *VAL-GLS para IDC valida glosa ( extension ) de identificador     
           MOVE DBC-GLS-ICLI IN FDO-FLD TO IDC-GLS-RUTV.                
           PERFORM VAL-GLS.                                             
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN FDO-FLD.                
       FIN-VAL-DBC-GLS-ICLI.                                            
           EXIT.                                                        
   *>>>>
*% END
