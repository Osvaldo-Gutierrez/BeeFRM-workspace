*% IF FIN_PUT_STA_STA
   *<<<<<FIN_PUT_STA_STA
      *BUS-USR busca usuario en tablas                                  
           IF STA-COD-USER IN STA-FLD > SPACES                          
               MOVE STA-COD-USER IN STA-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN STA-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-USER IN STA-FLD.                  
      *BUS-TAB busca glosa de codigo en tabla                           
           IF STA-COD-VCAM IN STA-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB                       
               MOVE STA-COD-VCAM IN STA-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-VCAM IN STA-FLD                             
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-VCAM IN STA-FLD.                  
   *>>>>>
*% END 
*% IF INI_PUT_USR_STA
      *<<<< INI_PUT_USR_STA                                             
           IF FRM-GLS-USER IN STA-FLD > SPACES                          
              MOVE '00' TO PGM-STAT-USR.                                
      *>>>>                                                             
*% END
*% IF FIN_PUT_USR_STA
      *BUS-OFI busca oficina en tablas                                  
           IF USR-COD-OFUS IN STA-FLD > SPACES                          
               MOVE USR-COD-OFUS IN STA-FLD TO OFI-COD-OFIC IN OFI      
               PERFORM BUS-OFI                                          
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFUS IN STA-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-OFUS IN STA-FLD.                  
*% END 
*% IF INI_PUT_DBC_STA
      *<<<< INI_PUT_DBC_STA                                             
           MOVE STA-CIC-ICLI IN STA TO DBC-CIC-ICLI IN DBC.             
           PERFORM LEE-DBC.                                             
      *>>>>         
*% END 
*% IF FIN_KEY_STA_STA
      *<<<< FIN_KEY_STA_STA                                             
           MOVE DBC-CAI-ICLI IN STA-FLD TO STA-CAI-ICLI IN STA.         
           MOVE DBC-IIC-ICLI IN STA-FLD TO STA-IIC-ICLI IN STA.         
      *>>>>          
*% END                                                    
*% IF INI_KEY_USR_STA
    *<<<<INI_KEY_USR_STA                                                 
           MOVE USR-COD-OFUS IN STA-FLD TO USR-COD-OFUS IN USR.         
    *>>>>
*% END 
*% IF FIN_KEY_DBC_STA
   *<<<<
           MOVE DBC-CAI-ICLI IN STA-FLD TO DBC-CAI-ICLI IN DBC.         
           MOVE DBC-IIC-ICLI IN STA-FLD TO DBC-IIC-ICLI IN DBC.         
           MOVE DBC-GLS-NOMC IN STA-FLD TO DBC-GLS-NOMC IN DBC.         
   *>>>>
*% END 
*% IF FIN_CLR_KEY_STA
   *<<<<<FIN_CLR_KEY_STA
           MOVE SPACES TO DBC-CAI-ICLI IN STA-FLD.                      
           MOVE SPACES TO DBC-IIC-ICLI IN STA-FLD.                      
           MOVE SPACES TO DBC-GLS-NOMC IN STA-FLD.                      
           MOVE ZEROES TO STA-FEC-FSTA IN STA-FLD.                      
           MOVE SPACES TO STA-COD-VCAM IN STA-FLD.                      
           MOVE ZEROES TO STA-NUM-ICOR IN STA-FLD.                      
      *<<<< FIN_CLR_KEY_STA                                          
           MOVE SPACES TO USR-COD-OFUS IN STA-FLD.                      
           MOVE SPACES TO STA-FEC-FSTA IN STA-FLD.                      
           MOVE SPACES TO FRM-GLS-USER IN STA-FLD.                      
           MOVE SPACES TO FRM-GLS-OFUS IN STA-FLD.                      
           MOVE SPACES TO FRM-GLS-VCAM IN STA-FLD.                      
      *>>>>                                                             
   *>>>>>
*% END
*% IF INI_CLR_FLD_STA  
      *<<<< INI_CLR_FLD_STA                                             
           GO TO CON-CLR-FLD-STA.                                       
      *>>>>                                                             
*% END 
*% IF FIN_CLR_FLD_STA
      *<<<< FIN_CLR_FLD_STA                                             
       CON-CLR-FLD-STA.                                                 
           PERFORM CLR-STA-STA.                                         
           PERFORM CLR-USR-STA.                                         
           PERFORM CLR-DBC-STA.                                         
      *>>>>                                                             
*% END 
*% IF FIN_UNP_IKY_STA
      *<<<< FIN_UNP_IKY_STA                                             
           IF ( SCR-CMND = 'CON' OR 'ING' )                             
              MOVE FRM-CPIM-AEY TO STA-NUM-ICOR-ATR.                    
      *>>>>                                                             
*% END
*% IF INI_VAL_IKY_STA 
   *<<<<
           PERFORM VAL-STA-COD-USER.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO STA-COD-USER-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-USR-COD-OFUS.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO USR-COD-OFUS-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-IND-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-IND-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-GLS-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-GLS-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-NUM-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-NUM-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-VRF-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-VRF-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-CAI-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-CAI-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-DBC-IIC-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-IIC-ICLI-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-STA-FEC-FSTA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO STA-FEC-FSTA-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-STA-COD-VCAM.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO STA-COD-VCAM-LEN IN STA-FLD                  
                GO TO FIN-VAL-IKY-STA.                                  
           PERFORM VAL-STA-NUM-ICOR.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO STA-NUM-ICOR-LEN IN STA-FLD.                  
           GO TO FIN-VAL-IKY-STA.                                  
   *>>>>
*% END 
*% IF INI_VAL_AKY_STA
   *<<<<INI_VAL_AKY_STA
           PERFORM VAL-DBC-GLS-NOMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO DBC-GLS-NOMC-LEN IN STA-FLD                  
                GO TO FIN-VAL-AKY-STA.                                  
   *>>>>
*% END 
*% IF INI_STA_COD_USER
    *<<<<<<INI_STA_COD_USER
           IF STA-COD-USER IN STA-FLD NOT > SPACES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-STA-COD-USER.                             
      *VAL-USR Valida Usuario                                           
           MOVE STA-COD-USER IN STA-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-USR.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
           IF MSG-COD-MENS NOT = 'COD    NEX'                           
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-USER IN STA-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-USER IN STA-FLD.                  
           GO TO FIN-VAL-STA-COD-USER.
      *>>>>>
*% END
*% IF INI_USR_COD_OFUS
      *<<<< INI_USR_COD_OFUS                                            
           PERFORM PUT-USR-STA.                                         
      *>>>>                                                             
*% END 
*% IF INI_VAL_DBC_NUM_ICLI
	    *<<<<
           IF DBC-NUM-ICLI IN STA-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-DBC-NUM-ICLI.
    *>>>>                         
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI                                           
           IF SCR-CMND = 'CON'                                          
              IF DBC-VRF-ICLI IN STA-FLD NOT > SPACES AND               
                 DBC-NUM-ICLI IN STA-FLD NOT > ZEROES                   
                 GO TO FIN-VAL-DBC-VRF-ICLI.                            
      *>>>>                                                             
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI                                            
            IF FRM-SUAR NOT = FRM-SUAR-MAL                              
               MOVE DBC-NUM-ICLI IN STA-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN STA-FLD TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN STA-FLD TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY                 
               MOVE FIO-GET-KEY             TO FIO-CMND                 
               PERFORM SGC-FIO-DBC                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE 'DAP'          TO MSG-COD-SIST                   
                  MOVE 'IDC    NOCLI' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
               ELSE                                                     
                  MOVE '00' TO PGM-STAT-DBC                             
                  MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN STA-FLD   
                                              STA-CAI-ICLI IN STA       
                  MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN STA-FLD   
                                              STA-IIC-ICLI IN STA       
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
                  PERFORM CPT-BLKS                                      
                  MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC       
                                              DBC-GLS-NOMC IN STA-FLD.  
      *>>>>                                                             
*% END
*% IF INI_STA_FEC_FSTA
      *<<<< INI_STA_FEC_FSTA                                            
           IF SCR-CMND = 'CON'                                          
              IF STA-FEC-FSTA IN STA-FLD NOT > ZEROES                   
                 GO TO FIN-VAL-STA-FEC-FSTA.                            
           MOVE STA-FEC-FSTA IN STA-FLD TO FEC-FECH.                    
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
           MOVE FEC-CHOY-LE TO FEC-CHOY.                                
           MOVE FEC-VHBL-S TO FEC-VHBL.                                 
                                                                        
      *>>>>                                                             
*% END
*% IF INI_STA_COD_VCAM 
      *<<<< INI_STA_COD_VCAM                                            
           IF STA-COD-VCAM IN STA-FLD NOT > SPACES                      
              MOVE SPACES TO STA-COD-VCAM IN STA-FLD.                   
      *<<<< INI_STA_COD_VCAM                                            
           IF SCR-CMND = 'CON'                                          
              IF STA-COD-VCAM IN STA-FLD NOT > SPACES                   
                 GO TO FIN-VAL-STA-COD-VCAM.                            
      *>>>>                                                             
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.                          
           MOVE STA-COD-VCAM IN STA-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              STA-COD-VCAM IN STA-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-VCAM IN STA-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO                              
                    FRM-GLS-VCAM IN STA-FLD.                            
           GO TO FIN-VAL-STA-COD-VCAM. 
      *>>>>                                                             
*% END
*% IF INI_VAL_CON_KEY_STA
      *<<<< NI_VAL_CON_KEY_STA                                             
           IF     STA-COD-USER IN STA-FLD NOT > SPACES                  
              AND USR-COD-OFUS IN STA-FLD NOT > SPACES                  
              AND DBC-NUM-ICLI IN STA-FLD NOT > ZEROES                  
              AND DBC-VRF-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-IND-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-GLS-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-CAI-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-IIC-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-GLS-NOMC IN STA-FLD NOT > SPACES                  
              AND STA-FEC-FSTA IN STA-FLD NOT > SPACES                  
              AND STA-NUM-DSTA IN STA-FLD NOT > SPACES                  
              AND STA-NUM-MSTA IN STA-FLD NOT > SPACES                  
              AND STA-NUM-SSTA IN STA-FLD NOT > SPACES                  
              AND STA-NUM-ASTA IN STA-FLD NOT > SPACES                  
              AND STA-COD-VCAM IN STA-FLD NOT > SPACES                  
              AND STA-NUM-ICOR IN STA-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-STA.                                    
      *<<<< VAL_CON_FLD_STA                                             
           IF SCR-CMND = 'CON'                                          
              IF STA-COD-VCAM IN STA-FLD > SPACES                       
                 IF STA-COD-USER IN STA-FLD NOT > SPACES OR             
                    DBC-NUM-ICLI IN STA-FLD NOT > ZEROES OR             
                    DBC-VRF-ICLI IN STA-FLD NOT > SPACES OR             
                    STA-FEC-FSTA IN STA-FLD NOT > SPACES                
                    PERFORM ERR-KEY                                     
                    PERFORM FST-KEY-STA.                                
           IF SCR-CMND = 'CON'                                          
              IF STA-FEC-FSTA IN STA-FLD > SPACES                       
                 IF STA-COD-USER IN STA-FLD NOT > SPACES OR             
                    DBC-NUM-ICLI IN STA-FLD NOT > ZEROES OR             
                    DBC-VRF-ICLI IN STA-FLD NOT > SPACES                
                    PERFORM ERR-KEY                                     
                    PERFORM FST-KEY-STA.                                
           IF SCR-CMND = 'CON'                                          
              IF DBC-NUM-ICLI IN STA-FLD > ZEROES  OR                   
                 DBC-VRF-ICLI IN STA-FLD > SPACES                       
                 IF STA-COD-USER IN STA-FLD NOT > SPACES                
                    PERFORM ERR-KEY                                     
                    PERFORM FST-KEY-STA.                                
           GO TO FIN-VAL-CON-KEY-STA.
      *>>>>                                                             
*% END
*% IF INI_VAL_CON_IKY_STA 
      *<<<<
           IF     STA-COD-USER IN STA-FLD NOT > SPACES                  
              AND USR-COD-OFUS IN STA-FLD NOT > SPACES                  
              AND DBC-NUM-ICLI IN STA-FLD NOT > ZEROES                  
              AND DBC-VRF-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-IND-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-GLS-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-CAI-ICLI IN STA-FLD NOT > SPACES                  
              AND DBC-IIC-ICLI IN STA-FLD NOT > SPACES                  
              AND STA-FEC-FSTA IN STA-FLD NOT > SPACES                  
              AND STA-COD-VCAM IN STA-FLD NOT > SPACES                  
              AND STA-NUM-ICOR IN STA-FLD NOT > ZEROES                  
                PERFORM ERR-KEY                                         
                PERFORM FST-KEY-STA.                                    
              GO TO FIN-VAL-CON-IKY-STA.
      *>>>>                                                             
*% END
*% IF INI_VAL_NUM_IKY_STA
   *<<<<INI_VAL_NUM_IKY_STA
       VAL-NUM-DBC-NUM-ICLI.                                            
           MOVE DBC-NUM-ICLI-ALF IN STA-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 8 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN STA-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO DBC-NUM-ICLI-LEN IN STA-FLD                   
                GO TO FIN-VAL-NUM-IKY-STA.                              
       VAL-NUM-STA-NUM-ICOR.                                            
           MOVE STA-NUM-ICOR-ALF IN STA-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 2 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO STA-NUM-ICOR IN STA-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO STA-NUM-ICOR-LEN IN STA-FLD                   
                GO TO FIN-VAL-NUM-IKY-STA.                              
            GO TO FIN-VAL-NUM-IKY-STA.
   *>>>>
*% END 
*% IF EDT_IKY_STA
     *<<<<EDT_IKY_STA
           IF DBC-NUM-ICLI-LEN IN STA-FLD = -9                          
                MOVE -1 TO DBC-NUM-ICLI-LEN IN STA-FLD                  
                GO TO FIN-EDT-IKY-STA.                                  
           MOVE DBC-NUM-ICLI IN STA-FLD TO DBC-NUM-ICLI-EDT IN STA-EDT. 
           MOVE DBC-NUM-ICLI-EDT IN STA-EDT TO                          
                DBC-NUM-ICLI-ALF IN STA-FLD.                            
           IF STA-NUM-ICOR-LEN IN STA-FLD = -9                          
                MOVE -1 TO STA-NUM-ICOR-LEN IN STA-FLD                  
                GO TO FIN-EDT-IKY-STA.                                  
           MOVE STA-NUM-ICOR IN STA-FLD TO STA-NUM-ICOR-EDT IN STA-EDT. 
           MOVE STA-NUM-ICOR-EDT IN STA-EDT TO                          
                STA-NUM-ICOR-ALF IN STA-FLD.                            
           GO TO FIN-EDT-IKY-STA.  
     *>>>>
*% END
*% IF INI_DBC_NUM_ICLI
   *<<<<INI_DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN STA-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-DBC-NUM-ICLI.                             
   *>>>>
*% END
*% IF EOF_BQ
   *<<<< EOF_BQ
       VAL-USR-COD-OFUS SECTION.                                        
       INI-VAL-USR-COD-OFUS.                                            
      *<<<< INI_USR_COD_OFUS                                            
           PERFORM PUT-USR-STA.                                         
      *>>>>                                                             
       FIN-VAL-USR-COD-OFUS.                                            
           EXIT.                                                        
   *>>>>
*% END
*% IF VAL_CON_FLD_STA
   *<<<<VAL_CON_FLD_STA
            IF STA-VAL-PSTM IN STA-FLD  > 0 AND                         
               STA-VAL-STAA IN STA-FLD > 0                              
                  MOVE 'DAP'          TO MSG-COD-SIST                   
                  MOVE 'TASAPTOS>0  ' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
            IF STA-VAL-PSTM IN STA-FLD NOT > 0 AND                      
               STA-VAL-STAA IN STA-FLD NOT > 0                          
                  MOVE 'DAP'          TO MSG-COD-SIST                   
                  MOVE 'TASAPTOS=0  ' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
   *>>>>
*% END 
