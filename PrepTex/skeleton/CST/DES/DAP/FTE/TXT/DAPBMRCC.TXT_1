*% IF FIN_PUT_OPD_RCC
      *<<<< FIN_PUT_OPD_RCC
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN RCC-FLD.
      *>>>>
*% END
*% IF INI_PUT_ALL_RCC
      *<<<< INI_PUT_ALL_RCC
           IF FRM-FFLD NOT = FRM-FFLD-PF5 AND
              FRM-FFLD NOT = FRM-FFLD-PF6
           IF RCC-NUM-DIRE IN RCC > ZEROES
               PERFORM BUS-RCD.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_RCC OR FIN_VAL_CON_KEY_RCC 
      *<<<< FIN_VAL_CON_IKY_RCC OR FIN_VAL_CON_KEY_RCC 
           MOVE RCC-CAI-IOPD IN RCC-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE RCC-IIC-IOPD IN RCC-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           MOVE FIO-STAT TO PGM-STAT-OPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DAP'        TO MSG-COD-SIST
              MOVE 'OPD    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              IF SCR-CCPP = 'ING'
                  PERFORM PUT-OPD-RCC.

      *>>>> END
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-CCPP = 'ING'
               IF NOT ( FRM-FFLD = FRM-FFLD-PF10 AND
                        SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S' )
                IF DBC-NUM-ICLI IN RCC-FLD NOT > ZEROES
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLI    OBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN RCC-FLD > ZEROES
               PERFORM KEY-DBC-RCC
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT PGM-STAT-DBC-OKS
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-CAI-ICLI IN DBC TO RCC-CAI-ICLI IN RCC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RCC-IIC-ICLI IN RCC-FLD
                   IF SCR-CCPP = 'ING'
                       PERFORM PUT-DBC-RCC.
      *>>>> END
*% END
*% IF RCC_NUM_DIRE
      *<<<< RCC_NUM_DIRE
       CNT-NUM-DIRE.
           IF RCC-NUM-DIRE IN RCC-FLD > ZEROES
               MOVE RCC-CAI-ICLI IN RCC-FLD TO RCD-CAI-ICLI IN RCD
               MOVE RCC-IIC-ICLI IN RCC-FLD TO RCD-IIC-ICLI IN RCD
               MOVE RCC-NUM-DIRE IN RCC-FLD TO RCD-NUM-DIRE IN RCD
               MOVE 'RCD-KEY-IRCD' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DIR    NEX' TO MSG-COD-MENS            
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RCC-NUM-DIRE
               ELSE
                   MOVE '00' TO PGM-STAT-RCD
                   PERFORM PUT-RCD-RCC
                   PERFORM VAL-LUGA
           ELSE
               MOVE RCC-CAI-ICLI IN RCC-FLD TO DBC-CAI-ICLI IN DBC
               MOVE RCC-IIC-ICLI IN RCC-FLD TO DBC-IIC-ICLI IN DBC
               PERFORM BUS-DOM
               IF RCD-GLS-DIRE IN RCD > SPACES
                   MOVE RCD-NUM-DIRE IN RCD TO RCC-NUM-DIRE IN RCC-FLD
                   MOVE '00' TO PGM-STAT-RCD
                   PERFORM PUT-RCD-RCC
                   PERFORM VAL-LUGA.
      *>>>>
*% END
*% IF INI_RCC_NUM_DIRE
      *<<<< INI_RCC_NUM_DIRE
           GO TO CNT-NUM-DIRE.
      *>>>>
*% END
*% IF INI_FST_KEY_RCC
      *<<<< INI_FST_KEY_RCC
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               MOVE -1 TO DBC-NUM-ICLI-LEN IN RCC-FLD
               GO TO FIN-FST-KEY-RCC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF

       VAL-LUGA SECTION.
       INI-VAL-LUGA.
           MOVE RCD-COD-LUGA IN RCC-FLD TO WSS-COD-LUGA IN WSS-VARI.
           IF WSS-IND-LUGA IN WSS-VARI = 'P'
               MOVE 'PAI' TO TAB-COD-TTAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
               MOVE 'COM' TO TAB-COD-TTAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              RCD-COD-LUGA IN RCC-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN RCC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LUGA IN RCC-FLD.
       FIN-VAL-LUGA.
           EXIT.
      *>>>>
*% END
