*%! Codigo adicional modulo DAPBMDCO
*% IF FIN_PUT_OPD_DCO
      *<<<< FIN_PUT_OPD_DCO
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN DCO-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DCO_DCO
      *<<<< FIN_PUT_DCO_DCO
           MOVE DCO-FEC-FTRN IN DCO TO WSS-FEC-FAMD.
           MOVE WSS-NUM-DAMD TO DCO-NUM-DTRN IN DCO-FLD.
           MOVE WSS-NUM-MAMD TO DCO-NUM-MTRN IN DCO-FLD.
           MOVE WSS-NUM-SAMD TO DCO-NUM-STRN IN DCO-FLD.
           MOVE WSS-NUM-AAMD TO DCO-NUM-ATRN IN DCO-FLD.
      *>>>> FIN_PUT_DCO_DCO
*% END
*% IF FIN_PUT_DBC_DCO
      *<<<< FIN_PUT_DBC_DCO
      *>>>> FIN_PUT_DBC_DCO
*% END
*% IF INI_PUT_ALL_DCO
      *<<<< INI_PUT_ALL_DCO
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_DCO OR FIN_VAL_CON_KEY_DCO 
      *<<<< FIN_VAL_CON_IKY_DCO OR FIN_VAL_CON_KEY_DCO 
           MOVE DCO-CAI-IOPD IN DCO-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE DCO-IIC-IOPD IN DCO-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           MOVE FIO-STAT TO PGM-STAT-OPD.
           IF NOT FIO-STAT-OKS
              MOVE 'DAP'        TO MSG-COD-SIST
              MOVE 'OPD    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              IF SCR-CCPP = 'ING'
                  PERFORM PUT-OPD-DCO.

      *>>>> END
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-VAL-DBC-VRF-ICLI.

           IF SCR-CCPP = 'ING'
               IF NOT ( FRM-FFLD = FRM-FFLD-PF10 )
                IF DBC-NUM-ICLI IN DCO-FLD NOT > ZEROES
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLI    OBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN DCO-FLD > ZEROES
               PERFORM KEY-DBC-DCO
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT PGM-STAT-DBC-OKS
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLI DBCNEX  ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-CAI-ICLI IN DBC TO DCO-CAI-ICLI IN DCO-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCO-IIC-ICLI IN DCO-FLD
                   IF SCR-CCPP = 'ING'
                       PERFORM PUT-DBC-DCO.

           IF (SCR-CCPP = 'ING') 
              AND DBC-NUM-ICLI IN DCO-FLD > ZEROES
               PERFORM BUS-RCC-CON-OPD
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
               
      *>>>> END
*% END
*% IF INI_DCO_NUM_NREN
      *<<<< INI_DCO_NUM_NREN
           IF DCO-NUM-NREN IN DCO-FLD NOT > ZEROES
              MOVE ZEROES TO DCO-NUM-NREN IN DCO-FLD.
      *>>>>
*% END
*% IF INI_FST_KEY_DCO
      *<<<< INI_FST_KEY_DCO
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *>>>>
*% END
