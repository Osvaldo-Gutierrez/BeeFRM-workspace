*%! Codigo adicional DAPBMCPP aceptando '*' en campos llaves
*% IF SETTAG
*% FNCBQ = "1804_07"
*% VSNBQ = "01-01"
*% FNCBU = "1804_07"
*% VSNBU = "01-01"
*% END
*% IF FIN_UNP_IKY_CPP
      *<<<< FIN_UNP_IKY_CPP
      *     MOVE FRM-CPIM-AEY TO CPP-COD-SCTB-ATR IN CPP-FLD.
      *>>>> END
*% END
*% IF FIN_PUT_ALL_CPP
      *<<<< FIN_PUT_ALL_CPP
           IF CPP-COD-VCAM IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-VCAM IN CPP-FLD.
           IF CPP-COD-TOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN CPP-FLD.
           IF CPP-COD-AOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN CPP-FLD.
      *>>>> 
*% END
*% IF FIN_PUT_CPP_CPP
      *<<<< FIN_PUT_CPP_CPP
           MOVE CPP-COD-COPD IN CPP TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN CPP-FLD.
      *>>>> END
*% END
*% IF CPP_COD_VCAM
      *<<<< CPP_COD_VCAM
           IF CPP-COD-VCAM IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-VCAM IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-VCAM.
      *>>>> END
*% END
*% IF CPP_COD_TOPD 
      *<<<< CPP_COD_TOPD 
           IF CPP-COD-TOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-TOPD.
      *>>>> END
*% END
*% IF CPP_COD_AOPD
      *<<<< CPP_COD_AOPD
           IF CPP-COD-AOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-AOPD.
      *>>>> END
*% END
*% IF CPP_COD_AOPD_NO
      *<<<< POD_COD_AOPD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-TOPD IN CPP-FLD TO CPP-COD-TOPD IN CPP.
           MOVE CPP-COD-AOPD IN CPP-FLD TO CPP-COD-AOPD IN CPP.
           MOVE CPP-COD-COPD IN CPP     TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-AOPD IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOPD IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOPD IN CPP-FLD.
      *>>>> END
*% END
*% IF FIN_VAL_CON_IKY_CPP OR FIN_VAL_CON_KEY_CPP 
      *<<<< FIN_VAL_CON_IKY_CPP OR FIN_VAL_CON_KEY_CPP 
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           IF NOT ( CPP-COD-VCAM IN CPP-FLD = '*'   OR
                    CPP-COD-TOPD IN CPP-FLD = '*  ' OR
                    CPP-COD-AOPD IN CPP-FLD = '*  ' )
      * ISP: PRODUCTO ESPECIFICO
               PERFORM VAL-AUX
               IF MSG-COD-MENS NOT > SPACES
                   PERFORM VAL-POD.
      *>>>> END
*% END
*% IF FIN_VAL_CON_IKY_CPP_NO OR FIN_VAL_CON_KEY_CPP_NO 
      *<<<< FIN_VAL_CON_IKY_CPP OR FIN_VAL_CON_KEY_CPP 
      * ISP:
      * VALIDA EXISTENCIA DE PLANTILLA POD
           MOVE CPP-COD-VCAM IN CPP-FLD TO POD-COD-VCAM IN POD.
           MOVE CPP-COD-TOPD IN CPP-FLD TO POD-COD-TOPD IN POD.
           MOVE CPP-COD-AOPD IN CPP-FLD TO POD-COD-AOPD IN POD.
           MOVE ZEROES                  TO POD-NUM-IPOD IN POD.
      * ISP: DAPBG001
           PERFORM GET-POD.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> END
*% END
*% IF CPP_COD_TCCT
      *<<<< CPP_COD_TCCT
      * ISP:
      * DEBE GENERAR UN NUEVO REGISTRO EN COMANDO 'COP'
           IF SCR-CMND = 'COP' AND FRM-IFLD = 1
              PERFORM VAL-KEY-CPP
              PERFORM KEY-ALL-CPP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM CHK-DUPL
              IF FRM-SUAR = FRM-SUAR-MAL 
                  GO TO FIN-VAL-CPP-COD-TCCT.

      * ISP:
      * TODOS LLENOS O TODOS VACIOS ( TIPO CTA CTBLE,IND D/H, TIPO ALG )
           IF ( CPP-COD-TCCT IN CPP-FLD(FRM-IFLD) > SPACES AND
                CPP-COD-DBHB IN CPP-FLD(FRM-IFLD) > SPACES AND
                CPP-COD-TALG IN CPP-FLD(FRM-IFLD) > SPACES )
                  GO TO END-VAL-CPP-COD-TCCT.

           IF ( CPP-COD-TCCT IN CPP-FLD(FRM-IFLD) NOT > SPACES AND
                CPP-COD-DBHB IN CPP-FLD(FRM-IFLD) NOT > SPACES AND
                CPP-COD-TALG IN CPP-FLD(FRM-IFLD) NOT > SPACES )
                  GO TO END-VAL-CPP-COD-TCCT.

              MOVE 'DAP' TO MSG-COD-SIST.
              MOVE 'ALLFULLORCLR' TO MSG-COD-MENS.
              PERFORM GET-MSG.
              MOVE MSG-GLS-DESC TO FRM-MENS.
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
              GO TO FIN-VAL-CPP-COD-TCCT.
       END-VAL-CPP-COD-TCCT.
      *>>>> END
*% END
*% IF EOF_BU
      *<<<< EOF_BU

       CHK-DUPL SECTION.
       INI-CHK-DUPL.
      *     PERFORM DAP-FIO-CPP.
      *     IF FIO-STAT-OKS
      *        MOVE 'DAP' TO MSG-COD-SIST
      *        MOVE 'KEY    DUPLI' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.

      * ISP:
      * VALIDACION DE LLAVES PARA COMADO COP
      * NO REQUIERE MKY
       VAL-KEY-CPP SECTION.
       INI-VAL-KEY-CPP.
           PERFORM VAL-IKY-CPP.
      *     PERFORM VAL-MKY-CPP.
           PERFORM VAL-AKY-CPP.
       FIN-VAL-KEY-CPP.
           EXIT.
       
       VAL-IKY-CPP SECTION.
       INI-VAL-IKY-CPP.
           PERFORM VAL-CPP-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CPP-COD-VCAM-LEN IN CPP-FLD
                GO TO FIN-VAL-IKY-CPP.
           PERFORM VAL-CPP-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CPP-COD-TOPD-LEN IN CPP-FLD
                GO TO FIN-VAL-IKY-CPP.
           PERFORM VAL-CPP-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CPP-COD-AOPD-LEN IN CPP-FLD
                GO TO FIN-VAL-IKY-CPP.
           PERFORM VAL-CPP-COD-MVTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CPP-COD-MVTO-LEN IN CPP-FLD
                GO TO FIN-VAL-IKY-CPP.
           PERFORM VAL-CPP-COD-SCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CPP-COD-SCTB-LEN IN CPP-FLD
                GO TO FIN-VAL-IKY-CPP.
       FIN-VAL-IKY-CPP.
           EXIT.
       
      * VAL-MKY-CPP SECTION.
      * INI-VAL-MKY-CPP.
      * FIN-VAL-MKY-CPP.
      *     EXIT.
       
       VAL-AKY-CPP SECTION.
       INI-VAL-AKY-CPP.
       FIN-VAL-AKY-CPP.
           EXIT.
       
       VAL-CPP-COD-VCAM SECTION.
       INI-VAL-CPP-COD-VCAM.
           IF CPP-COD-VCAM IN CPP-FLD NOT > SPACES
              MOVE SPACES TO CPP-COD-VCAM IN CPP-FLD.
      *<<<< CPP_COD_VCAM 
           IF CPP-COD-VCAM IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-VCAM IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-VCAM.
      *>>>> END
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-VCAM IN CPP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-VCAM IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN CPP-FLD.
       FIN-VAL-CPP-COD-VCAM.
           EXIT.
       
       VAL-CPP-COD-TOPD SECTION.
       INI-VAL-CPP-COD-TOPD.
           IF CPP-COD-TOPD IN CPP-FLD NOT > SPACES
              MOVE SPACES TO CPP-COD-TOPD IN CPP-FLD.
      *<<<< PTD_COD_TOPD 
           IF CPP-COD-TOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-TOPD.
      *>>>> END
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-TOPD IN CPP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-TOPD IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPD IN CPP-FLD.
       FIN-VAL-CPP-COD-TOPD.
           EXIT.
       
       VAL-CPP-COD-AOPD SECTION.
       INI-VAL-CPP-COD-AOPD.
           IF CPP-COD-AOPD IN CPP-FLD NOT > SPACES
              MOVE SPACES TO CPP-COD-AOPD IN CPP-FLD.
      *<<<< PTD_COD_AOPD 
           IF CPP-COD-AOPD IN CPP-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN CPP-FLD
               GO TO FIN-VAL-CPP-COD-AOPD.
      *>>>> END
      *<<<< POD_COD_AOPD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-TOPD IN CPP-FLD TO CPP-COD-TOPD IN CPP.
           MOVE CPP-COD-AOPD IN CPP-FLD TO CPP-COD-AOPD IN CPP.
           MOVE CPP-COD-COPD IN CPP     TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-AOPD IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOPD IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOPD IN CPP-FLD.
      *>>>> END
       FIN-VAL-CPP-COD-AOPD.
           EXIT.
       
       VAL-CPP-COD-MVTO SECTION.
       INI-VAL-CPP-COD-MVTO.
           IF CPP-COD-MVTO IN CPP-FLD NOT > SPACES
              MOVE SPACES TO CPP-COD-MVTO IN CPP-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'MVT' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-MVTO IN CPP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-MVTO IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-MVTO IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-MVTO IN CPP-FLD.
       FIN-VAL-CPP-COD-MVTO.
           EXIT.
       
       VAL-CPP-COD-SCTB SECTION.
       INI-VAL-CPP-COD-SCTB.
           IF CPP-COD-SCTB IN CPP-FLD NOT > SPACES
              MOVE SPACES TO CPP-COD-SCTB IN CPP-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CTB' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-SCTB IN CPP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CPP-COD-SCTB IN CPP-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SCTB IN CPP-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SCTB IN CPP-FLD.
       FIN-VAL-CPP-COD-SCTB.
           EXIT.
      *>>>> EOF_BU
*% END
*% IF EOF
      *<<<< EOF
 
       GET-TODAS SECTION.
       INI-GET-TODAS.
           MOVE 'DAP' TO MSG-COD-SIST.
           MOVE 'TODAS' TO MSG-COD-MENS.
           PERFORM GET-MSG.
       FIN-GET-TODAS.
           EXIT.

       VAL-AUX SECTION.
       INI-VAL-AUX.
           MOVE CPP-COD-TOPD IN CPP-FLD TO CPP-COD-TOPD IN CPP.
           MOVE CPP-COD-AOPD IN CPP-FLD TO CPP-COD-AOPD IN CPP.
           MOVE CPP-COD-COPD IN CPP     TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-COD.
          
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE 'CODAUX NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
           IF MSG-COD-MENS = 'COD    NVG'
               MOVE 'CODAUX NVG' TO MSG-COD-MENS
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = 'CODAUX NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN CPP-FLD.
       FIN-VAL-AUX.

       VAL-POD SECTION.
       INI-VAL-POD.
           MOVE CPP-COD-VCAM IN CPP-FLD TO POD-COD-VCAM IN POD.
           MOVE CPP-COD-TOPD IN CPP-FLD TO POD-COD-TOPD IN POD.
           MOVE CPP-COD-AOPD IN CPP-FLD TO POD-COD-AOPD IN POD.
           MOVE ZEROES                  TO POD-NUM-IPOD IN POD.
      *ISP: DAPBG001
           PERFORM GET-POD.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-POD.
           EXIT.

      *>>>> EOF
*% END
