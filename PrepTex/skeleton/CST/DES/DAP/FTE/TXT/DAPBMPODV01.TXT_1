*%! Codigo adicional DAPBMPOD
*% IF SETTAG
*% FNCBQ = "DAPEQP"
*% VSNBQ = "07.04.23"
*% FNCBU = "DAPEQP"
*% VSNBU = "07.04.23"
*% END
*% IF INI_PUT_POD_POD
      *<<<< INI_PUT_POD_POD
           IF POD-NUM-PRES IN POD NOT NUMERIC
                MOVE ZEROES TO POD-NUM-PRES IN POD.
      *>>>> INI_PUT_POD_POD
*% END
*% IF FIN_UNP_IKY_POD
      *<<<< FIN_UNP_IKY_POD
           MOVE FRM-CPIM-AEY TO POD-NUM-IPOD-ATR IN POD-FLD.
      *>>>>
*% END
*% IF FIN_RET_ALL_POD
      *<<<< FIN_RET_ALL_POD
           MOVE 'S' TO POD-COD-BPBT IN POD.
      *>>>>
*% END
*% IF FIN_UNP_POD_POD
      *<<<< FIN_UNP_POD_POD
           MOVE FRM-CPIM-AEY TO POD-COD-BCTI-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-COD-NAPR-ATR IN POD-FLD.
      *JVM  23-SEP-1991 MANTENCION
           MOVE FRM-CPIM-AEY TO POD-COD-SPBT-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-NUM-PREP-ATR IN POD-FLD.
           MOVE FRM-CPIM-AEY TO POD-IND-PREP-ATR IN POD-FLD.
      *
      *JVM  02-SEP-1991 PROTEGE CAMPOS POD PARA CONSIST
      *     MOVE 'DAP' TO TAB-COD-SIST.
      *     MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
      *     MOVE 'BCI    PCPOD' TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS > SPACES
      *        MOVE FRM-CPIM-AEY TO POD-COD-SPBT-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-CVTI-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-TFPR-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-PREP-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-PREP-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-VMIN-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-VMAX-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-SMNV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-SMNV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-NUM-SMXV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-IND-SMXV-ATR IN POD-FLD
      *        MOVE FRM-CPIM-AEY TO POD-COD-MORE-ATR IN POD-FLD.
      *>>>>
*% END
*% IF POD_COD_BCTI
      *<<<< POD_COD_BCTI
           MOVE 'V' TO POD-COD-BCTI IN POD-FLD.
      *>>>>
*% END
*% IF POD_COD_SPBT
      *<<<< POD_COD_SPTB
           MOVE 'S' TO POD-COD-SPBT IN POD-FLD.
      *>>>>
*% END
*% IF POD_COD_AOPD
      *<<<< POD_COD_AOPD
           MOVE POD-COD-TOPD IN POD-FLD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD-FLD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD     TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-AOPD IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOPD IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOPD IN POD-FLD.
      *>>>>
*% END
*% IF POD_COD_RENO
      *<<<< POD_COD_RENO
           IF SCR-CMND = 'COP'
               PERFORM VAL-KEY-POD
               PERFORM KEY-ALL-POD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL
               IF FRM-SUAR = FRM-SUAR-MAL
                  GO TO FIN-VAL-POD-COD-RENO.
      *>>>>
*% END
*% IF POD_NUM_IPOD_OLD
      *<<<< POD_NUM_IPOD
           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = 'COP'
               PERFORM KEY-ALL-POD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL.
      *>>>>
*% END
*% IF POD_VAL_CMAX             
      *<<<< POD_VAL_CMAX             
           IF POD-VAL-CMAX IN POD-FLD < POD-VAL-CMIN IN POD-FLD
      *        captacion maxima >= captacion minima 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CMAX>=CMIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_IND_PMIN
      *<<<< POD_IND_PMIN
           IF ( POD-NUM-PMIN IN POD-FLD > ZEROES AND
              POD-IND-PMIN IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMIN IN POD-FLD NOT > ZEROES AND
              POD-IND-PMIN IN POD-FLD > SPACES )
      *        plazo minimo inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PMIN    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_IND_PMNE
      *<<<< POD_IND_PMNE
      *LRH ini 7-SEP-1994
           IF ( POD-NUM-PMNE IN POD-FLD > ZEROES AND
              POD-IND-PMNE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMNE IN POD-FLD NOT > ZEROES AND
              POD-IND-PMNE IN POD-FLD > SPACES )
      *        plazo minimo inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PMIN    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *LRH fin 7-SEP-1994
      *>>>>
*% END
*% IF POD_IND_PMAX
      *<<<< POD_IND_PMAX
           MOVE SPACES TO MSG-COD-MENS.
           IF ( POD-NUM-PMAX IN POD-FLD > ZEROES AND
              POD-IND-PMAX IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMAX IN POD-FLD NOT > ZEROES AND
              POD-IND-PMAX IN POD-FLD > SPACES )
      *        plazo maximo inconsistente 
               MOVE 'PMAX    MALO' TO MSG-COD-MENS
               GO TO ERR-POD-IND-PMAX.

           IF ( POD-NUM-PMIN IN POD-FLD > ZEROES AND
                POD-NUM-PMAX IN POD-FLD > ZEROES )
               PERFORM VAL-PMIN-PMAX.

       ERR-POD-IND-PMAX.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_IND_PMXE
      *<<<< POD_IND_PMXE
      *LRH ini 7-SEP-1994
           MOVE SPACES TO MSG-COD-MENS.
           IF ( POD-NUM-PMXE IN POD-FLD > ZEROES AND
              POD-IND-PMXE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PMXE IN POD-FLD NOT > ZEROES AND
              POD-IND-PMXE IN POD-FLD > SPACES )
      *        plazo maximo inconsistente 
               MOVE 'PMAX    MALO' TO MSG-COD-MENS
               GO TO ERR-POD-IND-PMXE.

                       POD-NUM-PMAX IN POD-FLD > ZEROES )
               PERFORM VAL-PMIN-PMAX.

       ERR-POD-IND-PMXE.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *LRH fin 7-SEP-1994
      *>>>>
*% END
*% IF POD_NUM_VMIN
      *<<<< POD_NUM_VMIN
      *     MOVE 1 TO POD-NUM-VMIN IN POD-FLD.
      *>>>>
*% END
*% IF POD_NUM_VMAX 
      *<<<< POD_NUM_VMAX
      *     MOVE 1 TO POD-NUM-VMAX IN POD-FLD.
           IF POD-NUM-VMAX IN POD-FLD < POD-NUM-VMIN IN POD-FLD
      *        vmax debe ser >= vmin
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VMAX>VMIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_IND_SMNV
      *<<<< POD_IND_SMNV
           IF ( POD-NUM-SMNV IN POD-FLD > ZEROES AND
              POD-IND-SMNV IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-SMNV IN POD-FLD NOT > ZEROES AND
              POD-IND-SMNV IN POD-FLD > SPACES )
      *        separacion minima inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMNV    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-SMNV.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              ( POD-NUM-SMNV IN POD-FLD > ZEROES  OR 
                POD-IND-SMNV IN POD-FLD > SPACES )
               MOVE 'DAP' TO MSG-COD-SIST
      *        separacion minima vctos debe estar en blanco
               MOVE 'SMNVBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_COD_CVTI 
      *<<<< POD_COD_CVTI
           IF POD-COD-CVTI IN POD-FLD > SPACES
               MOVE 'I'                     TO WSS-GLS-CVTI IN WSS-VARI
               MOVE POD-COD-CVTI IN POD-FLD TO WSS-COD-CVTI IN WSS-VARI
               MOVE POD-COD-PBTI IN POD-FLD TO WSS-COD-PBTI IN WSS-VARI
               MOVE WSS-CVTI IN WSS-VARI    TO TAB-COD-CTAB IN TAB
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX'
      *        CVTI inexistente
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'CVTI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-CVTI IN POD-FLD.
      *>>>>
*% END
*% IF POD_IND_SMXV
      *<<<< POD_IND_SMXV
           IF ( POD-NUM-SMXV IN POD-FLD > ZEROES AND
              POD-IND-SMXV IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-SMXV IN POD-FLD NOT > ZEROES AND
              POD-IND-SMXV IN POD-FLD > SPACES )
      *        separacion maxima inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMXV    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-SMXV.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              ( POD-NUM-SMXV IN POD-FLD > ZEROES OR
                POD-IND-SMXV IN POD-FLD > SPACES )
      *        separacion maxima vctos debe estar en blanco
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'SMXVBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_COD_MORE 
      *<<<< POD_COD_MORE 
      *     MOVE 'N' TO POD-COD-MORE IN POD-FLD.
      *JVM  23-SEP-1991 MANTENCION
           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-COD-MORE IN POD-FLD NOT = 'N'
      *        modalidad de retiro, debe ser 'N' para doc. renovable
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'MORENOBLRENO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-COD-MORE.

           IF POD-NUM-VMAX IN POD-FLD = 1 AND
              POD-COD-MORE IN POD-FLD NOT = 'N'
      *        sin modalidad de retiro, debe ser 'N'
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'MORE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-COD-MORE.

           IF POD-NUM-VMAX IN POD-FLD > 1 AND
              POD-COD-MORE IN POD-FLD = 'N'
      *       dap con retiros,debe ser distinto de 'N'
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'MOREVMAXMALO' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-MORE.

      * REVISAR ICU
      *     IF POD-COD-CVTI IN POD-FLD > SPACES  AND
      *        POD-COD-MORE IN POD-FLD NOT = 'N' AND
      *        POD-COD-SPBT IN POD-FLD = 'S'
      *        NEXT SENTENCE
      *     ELSE
      *       spbt debe ser 's' para more not = 'n'
      *       y cvti > spaces
      *        MOVE 'DAP' TO MSG-COD-SIST
      *        MOVE 'SPBTSOBLMRNN' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-POD-COD-MORE.
      *>>>>
*% END
*% IF POD_COD_TFPR
      *<<<< POD_COD_TFPR
           IF POD-COD-CVTI IN POD-FLD NOT > SPACES AND
              POD-COD-TFPR IN POD-FLD > SPACES
      *       TFPR inconsistente con CVTI
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRBLKOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

           IF POD-COD-CVTI IN POD-FLD > SPACES AND
              POD-COD-TFPR IN POD-FLD NOT > SPACES
      *       tfpr debe tener valor
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRCVTI INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

      * ISP: OBTIENE CIC DE CODIGO
           IF POD-COD-CVTI IN POD-FLD > SPACES
                MOVE 'TAB' TO TAB-COD-SIST
                MOVE 'TPR' TO TAB-CIC-TTAB IN TAB
                MOVE 'F'   TO TAB-CIC-CTAB IN TAB
                MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                PERFORM BUS-TAB
                IF TAB-COD-CTAB IN TAB NOT = POD-COD-TFPR IN POD-FLD
      *       tfpr debe ser 'F' para tasa variable
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TFPRFOBL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-POD-COD-TFPR.

           IF POD-COD-CVTI IN POD-FLD > SPACES AND
              POD-NUM-VMAX IN POD-FLD > 1      AND
              POD-COD-TFPR IN POD-FLD = 'C'
      *       tfpr debe ser 'F' para > 1 y cvti > spaces
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRFOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-COD-TFPR.

      *JVM  23-SEP-1991 MANTENCION
      *     IF POD-COD-CVTI IN POD-FLD > SPACES AND
      *        POD-NUM-VMAX IN POD-FLD = 1      AND
      *        POD-COD-TFPR IN POD-FLD = 'F'
      **       tfpr debe ser 'C' para = 1 y cvti > spaces
      *        MOVE 'DAP' TO MSG-COD-SIST
      *        MOVE 'TFPRCOBL' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-POD-COD-TFPR.
      *>>>>
*% END
*% IF POD_IND_PREP                     
      *<<<< POD_IND_PREP
           IF ( POD-NUM-PREP IN POD-FLD > ZEROES AND
              POD-IND-PREP IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PREP IN POD-FLD NOT > ZEROES AND
              POD-IND-PREP IN POD-FLD > SPACES )
      *        periodo repacto inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREP    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-CVTI IN POD-FLD NOT > SPACES AND
              ( POD-NUM-PREP IN POD-FLD > ZEROES OR 
              POD-IND-PREP IN POD-FLD > SPACES )
      *        PREP inconsistente con CVTI
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREPCVTI INC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-TFPR IN POD-FLD = 'F' AND
              ( POD-NUM-PREP IN POD-FLD > ZEROES OR 
              POD-IND-PREP IN POD-FLD > SPACES )
      *        PREP inconsistente con TFPR
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PREPTFPR INC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PREP.

           IF POD-COD-TFPR IN POD-FLD = 'C' AND
              ( POD-NUM-PREP IN POD-FLD NOT > ZEROES OR
              POD-IND-PREP IN POD-FLD NOT > SPACES )
      *       periodo repacto debe estar con valores
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'TFPRPREP INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_COD_PLPA                             
      *<<<< POD_COD_PLPA                             
      *     IF POD-COD-RESC IN POD-FLD = 'N' AND
      *        POD-COD-PLPA IN POD-FLD > SPACES
      *        PLPA inconsistente con RESC
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         MOVE 'PLPABLKOBL' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-POD-COD-PLPA.
              
           IF POD-COD-RESC IN POD-FLD NOT = 'N' AND
              POD-COD-PLPA IN POD-FLD = SPACES
      *       si hay rescate,se debe indicar 
      *       hasta cuando se calcula interes
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PLPARESC INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF POD_IND_PLRE                             
      *<<<< POD_IND_PLRE
           IF ( POD-NUM-PLRE IN POD-FLD > ZEROES AND
              POD-IND-PLRE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PLRE IN POD-FLD NOT > ZEROES AND
              POD-IND-PLRE IN POD-FLD > SPACES )
      *        plazo rescate inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PLRE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PLRE.
      *>>>>
*% END
*% IF POD_IND_PNTE 
      *<<<< POD_IND_PNTE
           IF ( POD-NUM-PNTE IN POD-FLD     > ZEROES AND
                POD-IND-PNTE IN POD-FLD NOT > SPACES ) OR
              ( POD-NUM-PNTE IN POD-FLD NOT > ZEROES AND
                POD-IND-PNTE IN POD-FLD     > SPACES )
      *        periodo negociacion tasa especial inconsistente 
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'PNTE    MALO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'N' AND 
              ( POD-NUM-PNTE IN POD-FLD > ZEROES OR
                POD-IND-PNTE IN POD-FLD > SPACES )
               MOVE 'DAP' TO MSG-COD-SIST
      *        periodo neg tasa especial debe estar en blanco
               MOVE 'PNTEBLKOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-NUM-PNTE IN POD-FLD = ZEROES
      *       si es renovable,se debe indicar pnte
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENO INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.

           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-IND-PNTE IN POD-FLD = SPACES 
      *       si es renovable,se debe indicar pnte
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENO INC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.

      *JVM  23-SEP-1991 MANTENCION
           IF POD-COD-RENO IN POD-FLD = 'S' AND
              POD-IND-PNTE IN POD-FLD NOT = 'D'
      *       si es renovable,se debe indicar pnte en dias 
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'PNTERENODOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-POD-IND-PNTE.
      *>>>>
*% END
*% IF POD_IND_TMDA
      *LRH ini 7-SEP-1994
      *        IF POD-IND-TMDA IN OPD-FLD NOT = '1' AND
      *           POD-IND-TMDA IN OPD-FLD NOT = '2'
      *            MOVE 'DAP' TO MSG-COD-SIST
      *            MOVE 'INDTIPOMONMA' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            GO TO FIN-VAL-POD-IND-TMDA.
      *LRH fin 7-SEP-1994
*% END
*% IF PGM_BU
*% IF POD_COD_CEQP
      *<<<< POD_COD_CEQP
           MOVE POD-COD-CEQP IN POD-FLD TO POD-COD-CEQP IN POD.
           MOVE 'POD-COD-CEQP' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-POD.
           IF FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CODCEQPDUPLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-POD-COD-CEQP.

      *>>>>
*% END
*% END
*% IF VAL_CON_FLD_POD
      *<<<< VAL_CON_FLD_POD
               MOVE 'TAB' TO TAB-COD-SIST.
               MOVE 'INT' TO TAB-COD-TTAB IN TAB.
               MOVE POD-COD-BCTI IN POD-FLD TO
                                  WSS-INT-COD-BCTI IN WSS-VARI.
               MOVE POD-COD-PBTI IN POD-FLD TO
                                  WSS-INT-COD-PBTI IN WSS-VARI
               MOVE 'S' TO
                                  WSS-INT-COD-BPBT IN WSS-VARI.
               MOVE POD-COD-SPBT IN POD-FLD TO
                                  WSS-INT-COD-SPBT IN WSS-VARI.
               MOVE POD-COD-CVTI IN POD-FLD TO 
                                  WSS-INT-COD-CVTI IN WSS-VARI.
               MOVE POD-COD-TFPR IN POD-FLD TO
                                  WSS-INT-COD-TFPR IN WSS-VARI.
               MOVE POD-NUM-PREP IN POD-FLD TO
                                  WSS-INT-NUM-PREP IN WSS-VARI.
               MOVE POD-IND-PREP IN POD-FLD TO
                                  WSS-INT-IND-PREP IN WSS-VARI.
               MOVE WSS-INTE  IN WSS-VARI    TO TAB-COD-CTAB IN TAB.
               PERFORM VAL-COD.
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-COD-MENS = 'COD    NVG'
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'TINT   NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF_BU
      *<<<< EOF_BU

      * VALIDACION: PLAZO MINIMO DEBE SER <= PLAZO MAXIMO
       VAL-PMIN-PMAX SECTION.
       INI-VAL-PMIN-PMAX.
      * ICU : 01011991 + PLAZO MIN EN POD-FLD 
           MOVE POD-IND-PMIN IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE '01011991' TO FEC-FECH.
           MOVE POD-NUM-PMIN IN POD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DUNO.
           MOVE FEC-ITM2 TO WSS-NUM-MUNO.
           MOVE FEC-ITM3 TO WSS-NUM-SUNO.
           MOVE FEC-ITM4 TO WSS-NUM-AUNO.

      *LRH ini 7-SEP-1994
      *     IF POD-NUM-PMNE > ZEROES
      *         MOVE POD-IND-PMNE IN POD-FLD TO MSC-COD-CMSC IN MSC
      *         PERFORM OBT-CIC-PER

      *         MOVE WSS-FEC-FUNO TO FEC-FECH
      *         MOVE POD-NUM-PMNE IN POD-FLD TO WSS-NUM-PER
      *         PERFORM SEL-PER
      *         MOVE FEC-ITM1 TO WSS-NUM-DUNO
      *         MOVE FEC-ITM2 TO WSS-NUM-MUNO
      *         MOVE FEC-ITM3 TO WSS-NUM-SUNO
      *         MOVE FEC-ITM4 TO WSS-NUM-AUNO.
      *LRH fin 7-SEP-1994

      * ICU : 01011991 + PLAZO MAX EN POD-FLD 

           MOVE POD-IND-PMAX IN POD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM OBT-CIC-PER.

           MOVE '01011991' TO FEC-FECH.
           MOVE POD-NUM-PMAX IN POD-FLD TO WSS-NUM-PER
           PERFORM SEL-PER.
           MOVE FEC-ITM1 TO WSS-NUM-DDOS.
           MOVE FEC-ITM2 TO WSS-NUM-MDOS.
           MOVE FEC-ITM3 TO WSS-NUM-SDOS.
           MOVE FEC-ITM4 TO WSS-NUM-ADOS.

      *LRH ini 7-SEP-1994
      *     IF POD-NUM-PMXE > ZEROES
      *         MOVE POD-IND-PMXE IN POD-FLD TO MSC-COD-CMSC IN MSC
      *         PERFORM OBT-CIC-PER

      *         MOVE WSS-FEC-FDOS TO FEC-FECH
      *         MOVE POD-NUM-PMXE IN POD-FLD TO WSS-NUM-PER
      *         PERFORM SEL-PER
      *         MOVE FEC-ITM1 TO WSS-NUM-DDOS
      *         MOVE FEC-ITM2 TO WSS-NUM-MDOS
      *         MOVE FEC-ITM3 TO WSS-NUM-SDOS
      *         MOVE FEC-ITM4 TO WSS-NUM-ADOS.
      *LRH fin 7-SEP-1994

           IF WSS-FEC-FUNO > WSS-FEC-FDOS
      *         DEBE SER: PLAZO MINIMO <= PLAZO MAXIMO
                MOVE 'PMIN<=PMAX' TO MSG-COD-MENS
                GO TO FIN-VAL-PMIN-PMAX.
       FIN-VAL-PMIN-PMAX.
           EXIT.

       OBT-CIC-PER SECTION.
       INI-OBT-CIC-PER.
      * ISP: OBTIENE CIC DE UN CODIGO DE PERIODO CARGADO EN MSC-COD-CMSC
      *      Y LO ENTREGA EN WSS-CIC-PER
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-CIC-CMSC IN MSC     TO WSS-CIC-PER.
       FIN-OBT-CIC-PER.
           EXIT.

       SEL-PER SECTION.
       INI-SEL-PER.
      * ISP: OBTIENE EN FEC-FECH LA SUMA DE UNA FECHA CARGADA EN FEC-FECH
      *      + UN PERIODO ( WSS-CIC-PER Y WSS-NUM-PER )
           IF WSS-CIC-PER = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NDIA
           ELSE
           IF WSS-CIC-PER = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NMES
           ELSE
           IF WSS-CIC-PER = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE WSS-NUM-PER TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
       FIN-SEL-PER.
           EXIT.

       CHK-DUPL SECTION.
       INI-CHK-DUPL.
           PERFORM DAP-FIO-POD.
           IF FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'KEY    DUPLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.


      * JVM:
      * VALIDACION DE LLAVES PARA COMANDO 'COP'
      * NO REQUIERE MKY 
       VAL-KEY-POD SECTION.
       INI-VAL-KEY-POD.
           PERFORM VAL-IKY-POD.
      *     PERFORM VAL-MKY-POD.
           PERFORM VAL-AKY-POD.
       FIN-VAL-KEY-POD.
           EXIT.
       
       VAL-IKY-POD SECTION.
       INI-VAL-IKY-POD.
           PERFORM VAL-POD-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-VCAM-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-TOPD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-COD-AOPD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
           PERFORM VAL-POD-NUM-IPOD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO POD-NUM-IPOD-LEN IN POD-FLD
                GO TO FIN-VAL-IKY-POD.
       FIN-VAL-IKY-POD.
           EXIT.
       
      * VAL-MKY-POD SECTION.
      * INI-VAL-MKY-POD.
      * FIN-VAL-MKY-POD.
      *     EXIT.
       
       VAL-AKY-POD SECTION.
       INI-VAL-AKY-POD.
       FIN-VAL-AKY-POD.
           EXIT.
       
       VAL-POD-COD-VCAM SECTION.
       INI-VAL-POD-COD-VCAM.
           IF POD-COD-VCAM IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-VCAM IN POD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-VCAM IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-VCAM IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN POD-FLD.
       FIN-VAL-POD-COD-VCAM.
           EXIT.
       
       VAL-POD-COD-TOPD SECTION.
       INI-VAL-POD-COD-TOPD.
           IF POD-COD-TOPD IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-TOPD IN POD-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TOPD IN POD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TOPD IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOPD IN POD-FLD.
       FIN-VAL-POD-COD-TOPD.
           EXIT.
       
       VAL-POD-COD-AOPD SECTION.
       INI-VAL-POD-COD-AOPD.
           IF POD-COD-AOPD IN POD-FLD NOT > SPACES
              MOVE SPACES TO POD-COD-AOPD IN POD-FLD.
      *<<<< POD_COD_AOPD
           MOVE POD-COD-TOPD IN POD-FLD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD-FLD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD     TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-AOPD IN POD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOPD IN POD-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOPD IN POD-FLD.
      *>>>>
       FIN-VAL-POD-COD-AOPD.
           EXIT.
       
       VAL-POD-NUM-IPOD SECTION.
       INI-VAL-POD-NUM-IPOD.
       FIN-VAL-POD-NUM-IPOD.
           EXIT.
       
      *>>>> END
*% END
