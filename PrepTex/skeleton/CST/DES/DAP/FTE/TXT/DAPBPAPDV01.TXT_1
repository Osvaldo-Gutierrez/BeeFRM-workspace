*%! Codigo adicional para DAPPAEPD
*% IF SETTAG
*% FNCPQ = "DAP-EVENTOS"
*% VSNPQ = "06.06.08"
*% FNCPU = "DAP-EVENTOS"
*% VSNPU = "06.06.08"
*% END
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>> INI_FIO
*% END INI_FIO
*% LARGO_MI_COMMAREA = 28
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03  SCR-IND-MCLI              PIC X(01).
           03  SCR-CIC-CLI1              PIC X(12).
           03  SCR-CIC-CLI2              PIC X(12).
           03  SCR-CIC-CTAB-IEPD         PIC X(03).           
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-MSG-EPD-REV VALUE SPACES.
           03 WSS-MSG-EPD-REV-M1                 PIC X(40).
           03 WSS-MSG-EPD-REV-M2                 PIC X(39).
       77  WSS-EPD-COD-SEPD         VALUE 'X' PIC X(01).                

      *Entidades de sgc
       COPY SGCBRDBC.
       COPY SGCBROPE.
       COPY SGCBRRCO.

      *Entidades de TAB
       COPY TABBRCAM.

      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRCAD.
       COPY DAPBRVEN.
       COPY DAPBRRCC.

      *Entidades de GNS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY GNSWGINT.

       01  WSS-VARI.
           03 PGM-STAT-RCC           VALUE '23'      PIC X(02).
              88 PGM-STAT-RCC-OKS    VALUE '00'.
              88 PGM-STAT-RCC-NUL    VALUE '  '.
      *    03 WSS-CIC-EPD-COD-IEPD   VALUE SPACES    PIC X(03).
      *>>>> WSS
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY

      *     MOVE SPACES TO EPD-COD-SEPD IN EPD-FLD.
      *     MOVE ZEROES TO EPD-FEC-FEPD IN EPD-FLD.

           IF SCR-CMND = 'ING'                                          
               PERFORM PUT-OPD-EPD                                      
               PERFORM PUT-DBC-EPD                                      
               PERFORM PUT-VEN-EPD                                      
               MOVE 'I' TO EPD-COD-SEPD IN EPD-FLD.                     
                                                                        
           IF SCR-CMND = 'REV'                                          
               PERFORM PUT-ALL-EPD.                                     

           MOVE SPACES TO MSG-COD-MENS.

       END-FND-KEY.

           IF MSG-COD-MENS > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

      *    PERFORM BUS-COR-EPD.
           IF SCR-CMND = 'REV'
               IF NOT PGM-STAT-EPD-OKS                                  
                   MOVE 'DAP' TO MSG-COD-SIST
                   MOVE 'EPDREVNADA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE EPD-COD-IEPD IN EPD TO
                        EPD-COD-IEPD IN EPD-FLD
                   IF EPD-COD-IEPD IN EPD NOT =
                      EPD-COD-IEPD IN EPD-FLD
                       MOVE 'DAP' TO MSG-COD-SIST
                       MOVE 'EPDREVINV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE EPD-NUM-DEPD IN EPD TO 
                            EPD-NUM-DEPD IN EPD-FLD
                       MOVE EPD-NUM-MEPD IN EPD TO 
                            EPD-NUM-MEPD IN EPD-FLD
                       MOVE EPD-NUM-SEPD IN EPD TO 
                            EPD-NUM-SEPD IN EPD-FLD
                       MOVE EPD-NUM-AEPD IN EPD TO 
                            EPD-NUM-AEPD IN EPD-FLD
                       MOVE EPD-COD-SEPD IN EPD TO
                            EPD-COD-SEPD IN EPD-FLD.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      *>>>> FIN_FND_KEY
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD

           PERFORM GET-OPD.                                             
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO SCR-IERR
               GO TO ERR-SCR-GFLD.

           PERFORM GET-OPD-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO SCR-IERR
               GO TO ERR-SCR-GFLD.

           PERFORM PUT-FTRN.
           IF SCR-CMND NOT = 'REV'
               IF EPD-COD-IEPD IN EPD-FLD = 'RDF'
                   PERFORM PUT-FIJ-RDF
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'LQF'
                   PERFORM PUT-FIJ-LQF
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'IN1'
                    PERFORM PUT-FIJ-IN1
               ELSE
               IF EPD-COD-IEPD IN EPD-FLD = 'SLA'
                    PERFORM PUT-FIJ-SLA.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM PUT-FTRN.
      *>>>> CMN_ING
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF SCR-CMND = 'REV' AND
              EPD-COD-IEPD IN EPD-FLD = 'LQF'
               PERFORM CAD-LQF-REV
           ELSE
           IF SCR-CMND = 'ING' AND
              EPD-COD-IEPD IN EPD-FLD = 'LQF'
               PERFORM CAD-LQF-ING.
           IF SCR-CMND = 'REV'                                          
               MOVE 'EPDREVOKS    ' TO MSG-COD-MENS                     
               MOVE 'DAP' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
      *>>>> FIN_CMN_ING
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      *>>>> CMN_MOD_RET
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
      *>>>> INI_CMN_MOD
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *>>>> CMN_ELI
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
      *>>>> FIN_CMN_ELI
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
      *>>>> CMN_ACC
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ

       BUS-COR-EPD SECTION.                                             
       INI-BUS-COR-EPD.                                                 
      *     IF SCR-CMND = 'REV'                                         
      *         MOVE ZEROES TO EPD-NUM-IEPD IN EPD-FLD.                 
      *     IF SCR-CMND = 'ING'                                         
      *         MOVE ZEROES TO EPD-NUM-IEPD IN EPD-FLD.                 
           IF EPD-NUM-IEPD IN EPD-FLD > ZEROES                          
      *    IF EPD-NUM-IEPD IN EPD-FLD > ZEROES AND                      
      *       SCR-CMND NOT = 'ING' AND                                  
      *       SCR-CMND NOT = 'REV'                                      
               MOVE EPD-NUM-IEPD IN EPD-FLD TO                          
                    EPD-NUM-IEPD IN EPD                                 
           ELSE                                                         
               MOVE 999 TO EPD-NUM-IEPD IN EPD.                         
                                                                        
           IF EPD-NUM-IVEN IN EPD-FLD > ZEROES AND                      
              SCR-CMND NOT = 'ING' AND                                  
              SCR-CMND NOT = 'REV'                                      
               MOVE EPD-NUM-IVEN IN EPD-FLD TO                          
                    EPD-NUM-IVEN IN EPD                                 
           ELSE                                                         
               MOVE 999 TO EPD-NUM-IVEN IN EPD.                         
                                                                        
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
                                                                        
           PERFORM DAP-FIO-EPD.                                         
                                                                        
           IF NOT ( FIO-STAT-OKS AND                                    
                    EPD-CAI-IOPD IN EPD-FLD = EPD-CAI-IOPD IN EPD AND   
                    EPD-IIC-IOPD IN EPD-FLD = EPD-IIC-IOPD IN EPD )     
              MOVE '23' TO PGM-STAT-EPD                                 
              MOVE EPD-COD-SEPD IN EPD TO WSS-EPD-COD-SEPD              
                                                                        
               PERFORM KEY-ALL-EPD                                      
               MOVE ZEROES TO EPD-NUM-IEPD IN EPD                       
               IF SCR-CMND = 'ING'                                      
                    ADD 1 TO EPD-NUM-IEPD IN EPD                        
               ELSE                                                     
                    NEXT SENTENCE                                       
           ELSE                                                         
               MOVE '00' TO PGM-STAT-EPD                                
               MOVE EPD-COD-SEPD IN EPD TO WSS-EPD-COD-SEPD             
                                                                        
               IF SCR-CMND = 'ING' OR                                   
                  SCR-CMND = 'REV'                                      
                    ADD 1 TO EPD-NUM-IEPD IN EPD                        
                    PERFORM SET-EPD-COD-IEPD                            
               ELSE                                                     
                    PERFORM SET-EPD-COD-IEPD.                           
                                                                        
           MOVE EPD-NUM-IEPD IN EPD TO EPD-NUM-IEPD IN EPD-FLD.         
       FIN-BUS-COR-EPD.                                                 
           EXIT.                                                        

       SET-EPD-COD-IEPD SECTION.                                        
       INI-SET-EPD-COD-IEPD.                                            
           IF SCR-CMND = 'REV' OR                                       
              SCR-CMND = 'CON'                                          
               MOVE 'DAP' TO TAB-COD-SIST                               
               MOVE 'CEP ' TO TAB-COD-TTAB IN TAB                       
               MOVE EPD-COD-IEPD IN EPD TO TAB-COD-CTAB IN TAB          
               MOVE EPD-COD-IEPD IN EPD TO EPD-COD-IEPD IN EPD-FLD      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-IEPD IN EPD-FLD                             
               MOVE TAB-CIC-CTAB IN TAB TO SCR-CIC-CTAB-IEPD.           
       FIN-SET-EPD-COD-IEPD.                                            
           EXIT.                                                        

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE OPD-CIC-IOPD IN OPD TO RCC-CIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
      *RFU     MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                   OPD-CIC-IOPD IN OPD = RCC-CIC-IOPD IN RCC)
              MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CIC-IOPD IN OPD = RCC-CIC-IOPD IN RCC
                MOVE RCC-CIC-IOPD IN RCC TO SCR-CIC-CLI2
                MOVE 'DAP'          TO MSG-COD-SIST
                MOVE 'OPD    MCLI' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                PERFORM GET-CUR-RCC.
       FIN-GET-NXT-RCC.
           EXIT.
      *>>>> EOF_PQ
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       CAD-LQF-REV SECTION.
       INI-CAD-LQF-REV.
           PERFORM GET-CUR-AUT.
           IF FIO-STAT-OKS
                MOVE FIO-DEL TO FIO-CMND
                PERFORM DAP-FIO-CAD.
       FIN-CAD-LQF-REV.
           EXIT.

       CAD-LQF-ING SECTION.
       INI-CAD-LQF-ING.
           PERFORM GET-CUR-AUT.
           IF FIO-STAT-OKS
                MOVE 'DAPPUEPD'              TO CAD-COD-ATRN IN CAD
                MOVE EPD-CAI-ICAD IN EPD-FLD TO CAD-CAI-ICAD IN CAD
                MOVE EPD-IIC-ICAD IN EPD-FLD TO CAD-IIC-ICAD IN CAD
                MOVE FIO-MOD TO FIO-CMND
                PERFORM DAP-FIO-CAD
           ELSE
                MOVE SPACES TO CAD
                MOVE EPD-CAI-IOPD IN EPD-FLD TO CAD-CAI-IOPD IN CAD
                MOVE EPD-IIC-IOPD IN EPD-FLD TO CAD-IIC-IOPD IN CAD
                MOVE 'AUT'                   TO CAD-NUM-ILIQ IN CAD
                MOVE 1                       TO CAD-NUM-ICAD IN CAD
                MOVE HOY-FHOY                TO CAD-FEC-FTRN IN CAD
                MOVE HOY-HHOY                TO CAD-HRA-HRTR IN CAD
                MOVE 'I'                     TO CAD-COD-TACC IN CAD
                MOVE 'DAPPUEPD'              TO CAD-COD-ATRN IN CAD
                MOVE ZEROES                  TO CAD-SGV-LIQU IN CAD

                MOVE EPD-CAI-ICAD IN EPD-FLD TO CAD-CAI-ICAD IN CAD
                MOVE EPD-IIC-ICAD IN EPD-FLD TO CAD-IIC-ICAD IN CAD

                MOVE FIO-PUT TO FIO-CMND
                PERFORM DAP-FIO-CAD.
       FIN-CAD-LQF-ING.
           EXIT.

       GET-CUR-AUT SECTION.
       INI-GET-CUR-AUT.
           MOVE EPD-CAI-IOPD IN EPD-FLD TO CAD-CAI-IOPD IN CAD.
           MOVE EPD-IIC-IOPD IN EPD-FLD TO CAD-IIC-IOPD IN CAD.
           MOVE 'AUT'                   TO CAD-NUM-ILIQ IN CAD.
           MOVE 1                       TO CAD-NUM-ICAD IN CAD.
           MOVE 'CAD-KEY-ICAD' TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DAP-FIO-CAD.
       FIN-GET-CUR-AUT.
           EXIT.

      *>>>> EOF_PU
*% END
*% IF EOF
      *<<<< EOF
      *Entidades de DAP
       COPY DAPBFOPD.
       COPY DAPBFCAD.
       COPY DAPBFVEN.
       COPY DAPBFRCC.

      *Entidades de GNS
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBPFEC.
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBGINT.
       COPY GNSBEGLS.

      *Entidades de TAB
       COPY TABBFCAM.

      *Entidades de SGC
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE 'DAP' TO FIO-SIST.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.


       GET-OPD SECTION.
       INI-GET-OPD.
           MOVE EPD-CAI-IOPD IN EPD-FLD TO OPD-CAI-IOPD IN OPD.         
           MOVE EPD-IIC-IOPD IN EPD-FLD TO OPD-IIC-IOPD IN OPD.         
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
                 MOVE 'OPD    NEX' TO MSG-COD-MENS.
           MOVE FIO-STAT TO PGM-STAT-OPD.
       FIN-GET-OPD.
           EXIT.

       GET-OPD-VEN SECTION.
       INI-GET-OPD-VEN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPD-CIC-IOPD IN OPD TO VEN-CIC-IOPD IN VEN.
      *    MOVE OPD-NUM-IVEN IN OPD TO VEN-NUM-IVEN IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           MOVE FIO-STAT TO PGM-STAT-VEN.
           IF NOT FIO-STAT-OKS
                MOVE 'VENNEXEPD' TO MSG-COD-MENS.
       INI-GET-OPD-VEN.
           EXIT.

*% IF PGM_PQ
       GET-FRM-OPD SECTION.
       INI-GET-FRM-OPD.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE EPD-CAI-IOPD IN EPD-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE EPD-IIC-IOPD IN EPD-FLD TO OPD-IIC-IOPD IN OPD.
           PERFORM GET-OPD.
      
      
           IF PGM-STAT-OPD-OKS
                PERFORM GET-CPL.
      
           IF PGM-STAT-OPD-OKS
               IF OPD-COD-STAT IN OPD NOT = 'G'
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE 'OPD    NAE' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE 'OPDYAEPD' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF OPD-COD-RENO IN OPD = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'RDF'
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE 'OPDYAEPD' TO MSG-COD-MENS
                   MOVE 'RDFNOFIJA' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF OPD-COD-RENO IN OPD NOT = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'IN1'
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE 'IN1NORENO' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF SCR-CMND = 'REV' AND
                  WSS-EPD-COD-SEPD = 'R'
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE 'EPDREVINV' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF SCR-CMND = 'ING' AND
                  WSS-EPD-COD-SEPD = 'I'
                   PERFORM PUT-OPD-EPD
                   PERFORM PUT-DBC-EPD
                   PERFORM PUT-VEN-EPD
      
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'EPDYAPROG' TO MSG-COD-MENS.
       FIN-GET-FRM-OPD.
           EXIT.
      
       GET-CPL SECTION.
       INI-GET-CPL.
      *    OBTIENE VALOR VALOR DE CAMBIO PARA MONEDA REAJUSTABLE,
      *    ES DECIR, CHILENA Y NO PESOS
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      
           PERFORM GET-CUR-RCC.
           IF NOT FIO-STAT-OKS
      *        OPD no tiene cliente asociado
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPD    NORCC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-GET-CPL.
      
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
      *        cliente inexistente
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-GET-CPL.
      
           PERFORM GET-NXT-RCC.
      
           PERFORM GET-OPD-VEN.
           IF NOT FIO-STAT-OKS
      *        vencimiento inexistente
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VEN    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-GET-CPL.
      
       FIN-GET-CPL.
           EXIT.
      
*% ELSE
       GET-FRM-OPD SECTION.
       INI-GET-FRM-OPD.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM GET-OPD.
           IF FIO-STAT-OKS
               IF OPD-COD-STAT IN OPD NOT = 'G'
                   MOVE 'OPD    NAE' TO MSG-COD-MENS
               ELSE
               IF OPD-VAL-SCAP IN OPD NOT > ZEROES
                   MOVE 'OPDYAEPD' TO MSG-COD-MENS
               ELSE
               IF OPD-COD-RENO IN OPD = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'RDF'
                   MOVE 'RDFNOFIJA' TO MSG-COD-MENS
               ELSE
               IF OPD-COD-RENO IN OPD NOT = 'S' AND
                  SCR-CMND = 'ING' AND
                   EPD-COD-IEPD IN EPD-FLD = 'IN1'
                   MOVE 'IN1NORENO' TO MSG-COD-MENS
               ELSE
               IF SCR-CMND = 'REV' AND
                  WSS-EPD-COD-SEPD NOT = 'I'
                   MOVE 'EPDREVINV' TO MSG-COD-MENS
               ELSE
               IF SCR-CMND = 'ING' AND
                  WSS-EPD-COD-SEPD = 'I'
                   MOVE 'EPDYARPROG' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
       FIN-GET-FRM-OPD.
           EXIT.
*% END IF

       PUT-FTRN SECTION.
       INI-PUT-FTRN.
           MOVE HOY-DHOY TO EPD-NUM-DTRN IN EPD.
           MOVE HOY-MHOY TO EPD-NUM-MTRN IN EPD.
           MOVE HOY-SHOY TO EPD-NUM-STRN IN EPD.
           MOVE HOY-AHOY TO EPD-NUM-ATRN IN EPD.

           MOVE HOY-DHOY TO EPD-NUM-DTRN IN EPD-FLD.
           MOVE HOY-MHOY TO EPD-NUM-MTRN IN EPD-FLD.
           MOVE HOY-SHOY TO EPD-NUM-STRN IN EPD-FLD.
           MOVE HOY-AHOY TO EPD-NUM-ATRN IN EPD-FLD.

           MOVE HOY-HHOY TO EPD-HRA-HRTR IN EPD-FLD.
           MOVE HOY-HHOY TO EPD-HRA-HRTR IN EPD.

       FIN-PUT-FTRN.
           EXIT.


       PUT-FIJ-RDF SECTION.
       INI-PUT-FIJ-RDF.

           PERFORM PUT-FVEN.

           PERFORM BUS-CIC-I-SEPD.

           MOVE SPACES TO EPD-CAI-ICAD IN EPD-FLD.
           MOVE ZEROES TO EPD-IIC-ICAD IN EPD-FLD.
       FIN-PUT-FIJ-RDF.
           EXIT.

       PUT-FIJ-LQF SECTION.
       INI-PUT-FIJ-LQF.

           PERFORM PUT-FVEN.

           PERFORM BUS-CIC-I-SEPD.

       FIN-PUT-FIJ-LQF.
           EXIT.

       PUT-FIJ-IN1 SECTION.
       INI-PUT-FIJ-IN1.

           PERFORM PUT-FVEN.

           PERFORM BUS-CIC-I-SEPD.

       FIN-PUT-FIJ-IN1.
           EXIT.

       PUT-FIJ-SLA SECTION.
       INI-PUT-FIJ-SLA.

           PERFORM PUT-FVEN.

           PERFORM BUS-CIC-I-SEPD.

       FIN-PUT-FIJ-SLA.
           EXIT.

       PUT-FVEN SECTION.
       INI-PUT-FVEN.
           MOVE VEN-NUM-DVEN IN VEN TO EPD-NUM-DEPD IN EPD-FLD.
           MOVE VEN-NUM-MVEN IN VEN TO EPD-NUM-MEPD IN EPD-FLD.
           MOVE VEN-NUM-SVEN IN VEN TO EPD-NUM-SEPD IN EPD-FLD.
           MOVE VEN-NUM-AVEN IN VEN TO EPD-NUM-AEPD IN EPD-FLD.
       FIN-PUT-FVEN.
           EXIT.
 
       BUS-CIC-I-SEPD SECTION.
       INI-BUS-CIC-I-SEPD.
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'DAP' TO FIO-SIST.
           MOVE 'SEP ' TO TAB-COD-TTAB IN TAB.
           MOVE 'I' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.           
           IF FIO-STAT-OKS
               MOVE TAB-COD-CTAB IN TAB TO EPD-COD-SEPD IN EPD-FLD.
       FIN-BUS-CIC-I-SEPD.
           EXIT.
      *>>>>
*% END
