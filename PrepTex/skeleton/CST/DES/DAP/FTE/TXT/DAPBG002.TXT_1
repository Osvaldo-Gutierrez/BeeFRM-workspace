      * ISP:
      * PROTEGE AQUELLOS CAMPOS DE CODIGOS PARA LOS CUALES EXISTE UN
      * VALOR ESPECIFICO EN LA PLANTILLA, PARA QUE EL USUARIO PUEDA
      * 'TOCAR' ESTOS CAMPOS DEBEN ESTAR VACIOS EN LA PLANTILLA
      
       PRO-OPD-POD SECTION.
       INI-PRO-OPD-POD.
           IF SCR-CMND NOT = 'RDL' AND
              SCR-CMND NOT = 'RDB' AND
              POD-COD-MORE IN POD = 'N'
                MOVE FRM-CPIM-AEY TO OPD-SGV-MPRE-ATR IN OPD-FLD.
      
           MOVE FRM-CPIM-AEY TO OPD-COD-GARA-ATR IN OPD-FLD.
      * HZF-INI 17-05-2002 JVM:21/09/92
      *     IF SCR-CMND = 'MDA'
      *         MOVE FRM-CPIM-UBY TO OPD-COD-GARA-ATR IN OPD-FLD.
      * HZF-FIN 17-05-2002 JVM:
      
           IF POD-COD-MORE IN POD = 'PI'
               MOVE FRM-CPIM-AEY TO OPD-COD-MORE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-SGV-MPRE-ATR IN OPD-FLD
               PERFORM SET-PRM-PI.
      
      
           IF POD-COD-MORE IN POD = 'N'
               MOVE FRM-CPIM-AEY TO OPD-COD-MORE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-NUM-DURV-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-IND-DURV-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-TVEN-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-NUM-SEVE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-IND-SEVE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-FEC-FTER-ATR IN OPD-FLD.
           IF POD-COD-AFER IN POD = 'S' OR
              POD-COD-AFER IN POD = 'N'
               MOVE FRM-CPIM-AEY TO OPD-COD-AFER-ATR IN OPD-FLD.
       FIN-PRO-OPD-POD.
           EXIT.
      
       SET-PRM-PI SECTION.
       INI-SET-PRM-PI.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN OPD-FLD TO POD-COD-TOPD IN POD.
           MOVE OPD-COD-AOPD IN OPD-FLD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD     TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-SET-PRM-PI.
      
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB-AUX.
      
           IF POD-NUM-VMIN IN POD = POD-NUM-VMAX IN POD
               MOVE FRM-CPIM-AEY TO FRM-NUM-TVEN-ATR IN OPD-FLD
               MOVE POD-NUM-VMIN IN POD TO FRM-NUM-TVEN IN OPD-FLD.
      
      
           IF POD-NUM-SMNV IN POD = POD-NUM-SMXV IN POD AND
              POD-IND-SMNV IN POD = POD-IND-SMXV IN POD
               MOVE FRM-CPIM-AEY TO OPD-NUM-DURV-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-IND-DURV-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-NUM-SEVE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-IND-SEVE-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-FEC-FTER-ATR IN OPD-FLD
               MOVE POD-NUM-SMNV IN POD TO OPD-NUM-SEVE IN OPD-FLD
               MOVE POD-IND-SMNV IN POD TO OPD-IND-SEVE IN OPD-FLD
      
               MOVE FRM-CPIM-AEY TO OPD-NUM-PVEN-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-IND-PVEN-ATR IN OPD-FLD
               MOVE FRM-CPIM-AEY TO OPD-FEC-FPVC-ATR IN OPD-FLD
               MOVE POD-NUM-SMNV IN POD TO OPD-NUM-PVEN IN OPD-FLD
               MOVE POD-IND-SMNV IN POD TO OPD-IND-PVEN IN OPD-FLD
      
               IF WSS-CIC-CTAB-AUX = 'DPFFRS' OR
                  WSS-CIC-CTAB-AUX = 'DPFNRS'
                   MOVE 100 TO OPD-SGV-MPRE IN OPD-FLD
               ELSE
                   MOVE ZEROES TO OPD-SGV-MPRE IN OPD-FLD.
      
       FIN-SET-PRM-PI.
           EXIT.
