*%! CODIGO ADICIONAL DAPBMPTD
*% IF SETTAG
*% FNCBQ = "080706"
*% VSNBQ = "08.12.26"
*% FNCBU = "080706"
*% VSNBU = "08.12.26"
*% END
*% IF INI_PUT_ALL_PTD
      *<<<< INI_PUT_ALL_PTD
      *    busca cic de la moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
           IF WSS-CIC-VCAM = PDB-CIC-0999
               PERFORM PUT-MNTO VARYING FRM-IFLD FROM 1 BY 1
                   UNTIL FRM-IFLD > 5.

      * ISP: DAPBG004
           PERFORM CMP-FEC-PTD.
           IF SCR-CMND = 'CON'
               PERFORM GET-FHOY
               IF NOT ( HOY-SHOY = PTD-NUM-SPTD IN PTD AND
                        HOY-AHOY = PTD-NUM-APTD IN PTD AND
                        HOY-MHOY = PTD-NUM-MPTD IN PTD AND
                        HOY-DHOY = PTD-NUM-DPTD IN PTD )
                          MOVE 'DAP' TO MSG-COD-SIST
                          MOVE 'PTDNODELDIA' TO MSG-COD-MENS
                          PERFORM GET-MSG
                          MOVE MSG-GLS-DESC TO FRM-MENS.

      *>>>> 
*% END
*% IF FIN_UNP_IKY_PTD
      *<<<< FIN_UNP_IKY_PTD
           MOVE FRM-CPIM-AEY TO PTD-FEC-FPTD-ATR IN PTD-FLD.
           MOVE FRM-CPIM-AEY TO PTD-HRA-HRPT-ATR IN PTD-FLD.
      *>>>> FIN_UNP_IKY_PTD
*% END
*% IF INI_VAL_CON_KEY_PTD
      *<<<< INI_VAL_CON_KEY_PTD
           IF     PTD-FEC-FPTD IN PTD-FLD NOT > SPACES                  
              AND PTD-NUM-DPTD IN PTD-FLD NOT > SPACES                  
              AND PTD-NUM-MPTD IN PTD-FLD NOT > SPACES                  
              AND PTD-NUM-SPTD IN PTD-FLD NOT > SPACES                  
              AND PTD-NUM-APTD IN PTD-FLD NOT > SPACES  
      *>>>> INI_VAL_CON_KEY_PTD
*% END
*% IF INI_VAL_CON_IKY_PTD
      *<<<< INI_VAL_CON_IKY_PTD
           IF     PTD-FEC-FPTD IN PTD-FLD NOT > SPACES
      *>>>> INI_VAL_CON_IKY_PTD
*% END
*% IF FIN_PUT_ALL_PTD
      *<<<< FIN_PUT_ALL_PTD
           PERFORM PUT-TMIN.

           IF SCR-CMND = 'CON' 
               MOVE SPACES                  TO USP-PERMISO
               MOVE 'DAP'                   TO USP-GRUPO
               MOVE WSS-IDN-SIST            TO USP-SISTEMA
               MOVE SCR-USER                TO USP-USUARIO
               MOVE 'DAPPQPTD/MDD'          TO USP-STRING
               PERFORM USPC107
               IF USP-PERMISO NOT = 'P'
                   MOVE SPACES TO PTD-COD-TACO IN PTD-FLD
                   MOVE SPACES TO PTD-COD-TAFI IN PTD-FLD
                   PERFORM PUT-ZER-TACO VARYING FRM-IFLD FROM
                          1 BY 1 UNTIL FRM-IFLD > 5
                   PERFORM PUT-ZER-TAFI.

           IF PTD-COD-OFIC IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-OFIC IN PTD-FLD.
           IF PTD-COD-TOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN PTD-FLD.
           IF PTD-COD-AOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN PTD-FLD.
      *>>>> 
*% END
*% IF FIN_KEY_PTD_PTD 
      *<<<< FIN_KEY_PTD_PTD 

      * ISP: DAPBG004
           PERFORM CMP-FEC-PTD.
      *>>>> 
*% END
*% IF FIN_RET_PTD_PTD 
      *<<<< FIN_RET_PTD_PTD 
           PERFORM RET-TMIN VARYING FRM-IFLD FROM 1 BY 1
               UNTIL FRM-IFLD > 5.

      *    busca cic de la moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.

           IF TAB-CIC-CTAB IN TAB = PDB-CIC-0999
               PERFORM RET-MNTO VARYING FRM-IFLD FROM 1 BY 1
                   UNTIL FRM-IFLD > 5.
      *>>>> 
*% END
*% IF INI_FST_KEY_PTD 
      *<<<< INI_FST_KEY_PTD 
           MOVE -1 TO PTD-COD-OFIC-LEN IN PTD-FLD.
           GO TO FIN-FST-KEY-PTD.
      *>>>> 
*% END
*% IF INI_FST_FLD_PTD 
      *<<<< FIN_FST_FLD_PTD 
           MOVE -1 TO PTD-VAL-MNTO-LEN IN PTD-FLD(1).
           GO TO FIN-FST-FLD-PTD.
      *>>>> 
*% END
*% IF INI_PTD_FEC_FPTD
      *<<<< INI_PTD_FEC_FPTD
           IF SCR-CMND = 'CON'
               MOVE FEC-CHOY-N TO FEC-CHOY
           ELSE
               MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>> 
*% END
*% IF PTD_FEC_FPTD 
      *<<<< PTD_FEC_FPTD 
           IF SCR-CCPP NOT = 'ING'
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO PTD-NUM-SPTD IN PTD-FLD
               MOVE HOY-AHOY TO PTD-NUM-APTD IN PTD-FLD
               MOVE HOY-MHOY TO PTD-NUM-MPTD IN PTD-FLD
               MOVE HOY-DHOY TO PTD-NUM-DPTD IN PTD-FLD.
      *>>>> 
*% END
*% IF PTD_HRA_HRPT 
      *<<<< PTD_HRA_HRPT 
           IF SCR-CCPP NOT = 'ING'
               MOVE HOY-HHOY TO PTD-HRA-HRPT IN PTD-FLD.
      *           MOVE SPACES TO MSG-COD-MENS.
      *     PERFORM VAL-HORA.
      *     IF MSG-COD-MENS > SPACES
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> 
*% END
*% IF PTD_COD_STAT 
      *<<<< PTD_COD_STAT 
           IF SCR-CMND = 'COP' OR 'CVS'
              PERFORM VAL-KEY-PTD
              IF FRM-SUAR NOT = FRM-SUAR-MAL
                  PERFORM VAL-CON-IKY-PTD
                  IF FRM-SUAR = FRM-SUAR-MAL
                      MOVE -1 TO PTD-COD-TOPD-LEN
                      MOVE 'S' TO FRM-UCUR
                      GO TO FIN-VAL-PTD-COD-STAT
                  ELSE
                      PERFORM KEY-ALL-PTD
                      MOVE FIO-GET-KEY TO FIO-CMND
                      PERFORM CHK-DUPL
                      IF FRM-SUAR = FRM-SUAR-MAL
                          MOVE -1 TO PTD-COD-OFIC-LEN
                          MOVE 'S' TO FRM-UCUR
                          GO TO FIN-VAL-PTD-COD-STAT.
                          
                    
      *>>>> 
*% END
*% END
*% IF PTD_COD_OFIC
      *<<<< PTD_COD_OFIC
           IF PTD-COD-OFIC IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-OFIC IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-OFIC.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE PTD-COD-OFIC IN PTD-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN PTD-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN PTD-FLD.
      *>>>> END
*% END
*% IF PTD_COD_VCAM 
      *<<<< PTD_COD_VCAM 
      *    busca cic de la moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
      * ISP:
      *    MENSAJE PTD Monto De Moneda
           MOVE 'PTDMDM'            TO WSS-MSG1.
           MOVE TAB-COD-CTAB IN TAB TO WSS-MSG2.
           MOVE WSS-MSG TO MSG-COD-MENS.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-GLS-DESC IN PTD-FLD.
           
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTD-COD-VCAM IN PTD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN PTD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCAM IN PTD-FLD.

      *>>>> END
*% END
*% IF PTD_COD_TOPD 
      *<<<< PTD_COD_TOPD 
           IF PTD-COD-TOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-TOPD.
               
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-TOPD IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTD-COD-TOPD IN PTD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN PTD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOPD IN PTD-FLD.
      *>>>> END
*% END
*% IF PTD_COD_AOPD
      *<<<< PTD_COD_AOPD
           IF PTD-COD-AOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-AOPD.
      *>>>> END
*% END
*% IF FIN_PUT_PTD_PTD
      *<<<< FIN_PUT_PTD_PTD
      *BUS-OFI busca oficina en tablas
           IF PTD-COD-OFIC IN PTD-FLD > SPACES
               MOVE PTD-COD-OFIC IN PTD-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN PTD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN PTD-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTD-COD-VCAM IN PTD-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCAM IN PTD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN PTD-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTD-COD-TOPD IN PTD-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE PTD-COD-TOPD IN PTD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOPD IN PTD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPD IN PTD-FLD.
      *BUS-USR busca usuario en tablas
           IF PTD-COD-EJEC IN PTD-FLD > SPACES
               MOVE PTD-COD-EJEC IN PTD-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN PTD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN PTD-FLD.
               
           MOVE PTD-COD-COPD IN PTD TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN PTD-FLD.
      *     PERFORM BUS-GLS-TINT.
      *>>>> END
*% END
*% IF FIN_PTD_COD_TAFI
      *<<<< FIN_PTD_COD_TAFI
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TAD ' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-TAFI IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> END
*% END
*% IF FIN_PTD_COD_TACO
      *<<<< FIN_PTD_COD_TACO
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TAD ' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-TACO IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> END
*% END
*% IF FIN_PTD_COD_EJEC
      *<<<< FIN_PTD_COD_EJEC
      *VAL-USR Valida Usuario
           MOVE PTD-COD-EJEC IN PTD-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN PTD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN PTD-FLD.
      *>>>> END
*% END
*% IF FIN_VAL_CON_IKY_PTD OR FIN_VAL_CON_KEY_PTD 
      *<<<< FIN_VAL_CON_IKY_PTD OR FIN_VAL_CON_KEY_PTD
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           IF NOT ( PTD-COD-TOPD IN PTD-FLD = '*  ' OR
                    PTD-COD-AOPD IN PTD-FLD = '*  ' )
      * ISP: PRODUCTO ESPECIFICO
               PERFORM VAL-AUX
               IF MSG-COD-MENS NOT > SPACES
                   PERFORM VAL-POD
               ELSE
                   NEXT SENTENCE
           ELSE
      * ISP: PRODUCTO GENERICO
               PERFORM MCH-POD.

           IF MSG-COD-MENS NOT > SPACES
               PERFORM BUS-GLS-TINT.
      *>>>> END
*% END
*% IF VAL_CON_FLD_PTD 
      *<<<< VAL_CON_FLD_PTD 
           PERFORM RET-PTD-PTD.
           MOVE SPACES TO MSG-COD-MENS.

           PERFORM PUT-VEC-TPIZ.

           PERFORM VAL-DIA-TPIZ VARYING WSS-I FROM 1 BY 1
               UNTIL WSS-I > 10 OR
                     MSG-COD-MENS > SPACES.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-VAL-CON-FLD-PTD.

           IF PTD-COD-TAFI IN PTD-FLD > SPACES AND
              PTD-COD-TACO IN PTD-FLD > SPACES
               MOVE 'PTDFICOLLENO' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-PTD.

           PERFORM VAL-VEC-TACO VARYING WSS-I FROM 1 BY 1 UNTIL
                   WSS-I > 5.
           IF PTD-COD-TACO IN PTD-FLD > SPACES
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-VAL-CON-FLD-PTD.

           PERFORM PUT-VEC-TAFI.

           PERFORM VAL-VEC-TAFI VARYING WSS-I FROM 1 BY 1 UNTIL
                   WSS-I > 10.
           IF PTD-COD-TAFI IN PTD-FLD > SPACES
               MOVE SPACES TO MSG-COD-MENS
           ELSE
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-VAL-CON-FLD-PTD.

           PERFORM VAL-ASC-MNTO VARYING FRM-IFLD FROM 2 BY 1
               UNTIL FRM-IFLD > 5 OR 
                     MSG-COD-MENS > SPACES.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-VAL-CON-FLD-PTD.

           PERFORM VAL-ASC-DIAS VARYING FRM-IFLD FROM 2 BY 1
               UNTIL FRM-IFLD > 10 OR 
                     MSG-COD-MENS > SPACES.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-VAL-CON-FLD-PTD.

           PERFORM VAL-DIMO-FILA
               VARYING WSS-I FROM 1 BY 1 
                   UNTIL WSS-I > 10 OR MSG-COD-MENS > SPACES.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-VAL-CON-FLD-PTD
           ELSE
               MOVE '00' TO PGM-STAT-PTD
               PERFORM REG-TO-FRM.

           GO TO FIN-VAL-CON-FLD-PTD.
       ERR-VAL-CON-FLD-PTD.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
      * 'PTDFICOLLENO'
           IF MSG-COD-MENS = 'PTDFICOLLENO'
               MOVE MSG-GLS-DESC TO WSS-COD-MENS
           ELSE
      * VAL-DIA-TPIZ 
           IF MSG-COD-MENS = 'PTDDIAPIZ' 
               MOVE MSG-GLS-DESC TO WSS-COD-MEN1
               SUBTRACT 1 FROM WSS-I
               MOVE WSS-I        TO WSS-COD-MEN2
               MOVE SPACES       TO WSS-COD-MEN3
               MOVE SPACES       TO WSS-COD-MEN4
           ELSE
      * VAL-ASC-MNTO OR VAL-ASC-DIAS
           IF MSG-COD-MENS = 'MNTO    DICT' OR 'MNTO    ACDT' OR
                             'DIAS    DICT' OR 'DIAS    ACDT' 
               MOVE MSG-GLS-DESC TO WSS-COD-MENS
           ELSE
      * VAL-DIMO-FILA
           IF MSG-COD-MENS = 'TMAX<TPIZ'
               MOVE MSG-GLS-DESC TO WSS-COD-MEN1
               SUBTRACT 1 FROM WSS-I
               MOVE WSS-I        TO WSS-COD-MEN2
               MOVE MSG-GLS-DCOR TO WSS-COD-MEN3
               SUBTRACT 1 FROM WSS-J
               MOVE WSS-J        TO WSS-COD-MEN4
           ELSE
      * VAL-DIMO-FILA
           IF MSG-COD-MENS = 'INCFICODIMO'
               MOVE MSG-GLS-DESC TO WSS-COD-MEN1
               SUBTRACT 1 FROM WSS-I
               MOVE WSS-I        TO WSS-COD-MEN2
               MOVE MSG-GLS-DCOR TO WSS-COD-MEN3
               SUBTRACT 1 FROM WSS-J
               MOVE WSS-J        TO WSS-COD-MEN4
           ELSE
      * 'PTDTAFIINC'
           IF MSG-COD-MENS = 'PTDTAFIINC'
               MOVE MSG-GLS-DESC TO WSS-COD-MEN1
               MOVE WSS-J        TO WSS-COD-MEN2
           ELSE
      * 'PTDTACOINC'
           IF MSG-COD-MENS = 'PTDTACOINC'
               MOVE MSG-GLS-DESC TO WSS-COD-MEN1
               MOVE WSS-J        TO WSS-COD-MEN2.

           MOVE WSS-COD-MENS TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> 
*% END
*% IF EOF_BU
      *<<<< EOF_BU

       PUT-VEC-TPIZ SECTION.
       INI-PUT-VEC-TPIZ.
           MOVE FRM-SGV-TMN1 IN PTD-FLD TO WSS-SGV-TPIZ(1).
           MOVE FRM-SGV-TMN2 IN PTD-FLD TO WSS-SGV-TPIZ(2).
           MOVE FRM-SGV-TMN3 IN PTD-FLD TO WSS-SGV-TPIZ(3).
           MOVE FRM-SGV-TMN4 IN PTD-FLD TO WSS-SGV-TPIZ(4).
           MOVE FRM-SGV-TMN5 IN PTD-FLD TO WSS-SGV-TPIZ(5).
           MOVE FRM-SGV-TMN6 IN PTD-FLD TO WSS-SGV-TPIZ(6).
           MOVE FRM-SGV-TMN7 IN PTD-FLD TO WSS-SGV-TPIZ(7).
           MOVE FRM-SGV-TMN8 IN PTD-FLD TO WSS-SGV-TPIZ(8).
           MOVE FRM-SGV-TMN9 IN PTD-FLD TO WSS-SGV-TPIZ(9).
           MOVE FRM-SGV-TMN0 IN PTD-FLD TO WSS-SGV-TPIZ(10).
       FIN-PUT-VEC-TPIZ.
           EXIT.

       PUT-VEC-TAFI SECTION.
       INI-PUT-VEC-TAFI.
           MOVE PTD-SGV-TAF1 IN PTD-FLD TO WSS-SGV-TAFI(1).
           MOVE PTD-SGV-TAF2 IN PTD-FLD TO WSS-SGV-TAFI(2).
           MOVE PTD-SGV-TAF3 IN PTD-FLD TO WSS-SGV-TAFI(3).
           MOVE PTD-SGV-TAF4 IN PTD-FLD TO WSS-SGV-TAFI(4).
           MOVE PTD-SGV-TAF5 IN PTD-FLD TO WSS-SGV-TAFI(5).
           MOVE PTD-SGV-TAF6 IN PTD-FLD TO WSS-SGV-TAFI(6).
           MOVE PTD-SGV-TAF7 IN PTD-FLD TO WSS-SGV-TAFI(7).
           MOVE PTD-SGV-TAF8 IN PTD-FLD TO WSS-SGV-TAFI(8).
           MOVE PTD-SGV-TAF9 IN PTD-FLD TO WSS-SGV-TAFI(9).
           MOVE PTD-SGV-TAF0 IN PTD-FLD TO WSS-SGV-TAFI(10).
       FIN-PUT-VEC-TAFI.
           EXIT.

       VAL-VEC-TACO SECTION.
       INI-VAL-VEC-TACO.
           IF PTD-SGV-TADC IN PTD-FLD(WSS-I) > ZEROES
                MOVE WSS-I TO WSS-J
                MOVE 'PTDTACOINC' TO MSG-COD-MENS
                MOVE 6 TO WSS-I.
       FIN-VAL-VEC-TACO.
           EXIT.

       VAL-VEC-TAFI SECTION.
       INI-VAL-VEC-TAFI.
           IF WSS-SGV-TAFI(WSS-I) > ZEROES
                MOVE WSS-I TO WSS-J
                MOVE 'PTDTAFIINC' TO MSG-COD-MENS
                MOVE 11 TO WSS-I.
       FIN-VAL-VEC-TAFI.
           EXIT.

       VAL-DIMO-FILA SECTION.
       INI-VAL-DIMO-FILA.
           PERFORM VAL-DIMO-COLU 
               VARYING WSS-J FROM 1 BY 1 
                   UNTIL WSS-J > 5  OR MSG-COD-MENS > SPACES.
       FIN-VAL-DIMO-FILA.
           EXIT.

       VAL-DIMO-COLU SECTION.
       INI-VAL-DIMO-COLU.
           MULTIPLY WSS-I BY 5 GIVING WSS-K.
           SUBTRACT 5 FROM WSS-K.
           ADD WSS-J TO WSS-K.

      *ADA-INI 24-SEP-2001
      **SI DIA(I) > 0 Y MONTO(J) > 0 Y TASAMAX(K) = 0 => TASAMAX(K)=TPIZ
      *     IF PTD-NUM-DIAS IN PTD(WSS-I) > ZEROES AND
      *        PTD-VAL-MNTO IN PTD(WSS-J) > ZEROES AND
      *        PTD-SGV-TMAX IN PTD(WSS-K) NOT > ZEROES
      *         MOVE WSS-SGV-TPIZ(WSS-I) TO PTD-SGV-TMAX IN PTD(WSS-K).
      *ADA-FIN 24-SEP-2001

      * SI TASAMAX(K) > 0 => DIA(I) > 0 Y MONTO(J) > 0
      * INConsistencia FIla-COlumna ( tmax ) v/s DIa-MOnto
      *ADA-INI 21-SEP-2001
      *    IF PTD-SGV-TMAX IN PTD(WSS-K) > ZEROES
           IF PTD-SGV-TMAX IN PTD(WSS-K) NOT = ZEROES
      *ADA-FIN 21-SEP-2001
               IF NOT ( PTD-NUM-DIAS IN PTD(WSS-I) > ZEROES AND
                   PTD-VAL-MNTO IN PTD(WSS-J) > ZEROES )
                      MOVE 'INCFICODIMO' TO MSG-COD-MENS
                      GO TO FIN-VAL-DIMO-COLU.

      * TMAX(K) DEBE SER >= TPIZARRA(I)
           IF PTD-NUM-DIAS IN PTD(WSS-I) > ZEROES AND
              PTD-VAL-MNTO IN PTD(WSS-J) > ZEROES
               IF PTD-SGV-TMAX IN PTD(WSS-K) <
                  PTD-SGV-TMIN IN PTD(WSS-K)
                   MOVE 'TMAX<TPIZ' TO MSG-COD-MENS.
       FIN-VAL-DIMO-COLU.
           EXIT.

       VAL-ASC-DIAS SECTION.
       INI-VAL-ASC-DIAS.
           SUBTRACT 1 FROM FRM-IFLD GIVING WSS-IFLD.
           IF PTD-NUM-DIAS IN PTD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-ASC-DIAS.
           IF PTD-NUM-DIAS IN PTD(WSS-IFLD) NOT > ZEROES AND
              PTD-NUM-DIAS IN PTD(FRM-IFLD)     > ZEROES 
      *            serie de dias discontinua
                   MOVE 'DIAS    DICT' TO MSG-COD-MENS
                   GO TO FIN-VAL-ASC-DIAS.
           IF ( PTD-NUM-DIAS IN PTD(FRM-IFLD) NOT >
                PTD-NUM-DIAS IN PTD(WSS-IFLD) )
      *        dias deben ser ascendentes
                   MOVE 'DIAS    ACDT' TO MSG-COD-MENS.
       FIN-VAL-ASC-DIAS.
           EXIT.

       VAL-ASC-MNTO SECTION.
       INI-VAL-ASC-MNTO.
           SUBTRACT 1 FROM FRM-IFLD GIVING WSS-IFLD.
           IF WSS-IFLD NOT = 1
               IF PTD-VAL-MNTO IN PTD-FLD(WSS-IFLD) NOT > ZEROES AND
                  PTD-VAL-MNTO IN PTD-FLD(FRM-IFLD)     > ZEROES
      *            serie de montos discontinua
                   MOVE 'MNTO    DICT' TO MSG-COD-MENS
                   GO TO FIN-VAL-ASC-MNTO.

           IF PTD-VAL-MNTO IN PTD-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-ASC-MNTO.
           IF ( PTD-VAL-MNTO IN PTD-FLD(FRM-IFLD) NOT >
                PTD-VAL-MNTO IN PTD-FLD(WSS-IFLD) )
      *        montos deben ser ascendentes
               MOVE 'MNTO    ACDT' TO MSG-COD-MENS.
       FIN-VAL-ASC-MNTO.
           EXIT.

       VAL-DIA-TPIZ SECTION.
       INI-VAL-DIA-TPIZ.
      *ADA-INI 21-SEP-2001
      *     IF ( PTD-NUM-DIAS IN PTD(WSS-I) > ZEROES AND
      *          WSS-SGV-TPIZ(WSS-I)        > ZEROES ) OR
      *        ( PTD-NUM-DIAS IN PTD(WSS-I) NOT > ZEROES AND
      *          WSS-SGV-TPIZ(WSS-I)        NOT > ZEROES )
      *         NEXT SENTENCE
      *     ELSE
      *         MOVE 'PTDDIAPIZ' TO MSG-COD-MENS.
           IF ( PTD-NUM-DIAS IN PTD(WSS-I) NOT > ZEROES AND
                WSS-SGV-TPIZ(WSS-I)        NOT = ZEROES )
               MOVE 'PTDDIAPIZ' TO MSG-COD-MENS.
      *ADA-FIN 21-SEP-2001
       FIN-VAL-DIA-TPIZ.
           EXIT.

       RET-TMIN SECTION.
       INI-RET-TMIN.
           MOVE FRM-SGV-TMN1 IN PTD-FLD TO 
                PTD-SGV-TMN1 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN2 IN PTD-FLD TO 
                PTD-SGV-TMN2 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN3 IN PTD-FLD TO 
                PTD-SGV-TMN3 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN4 IN PTD-FLD TO 
                PTD-SGV-TMN4 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN5 IN PTD-FLD TO 
                PTD-SGV-TMN5 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN6 IN PTD-FLD TO 
                PTD-SGV-TMN6 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN7 IN PTD-FLD TO 
                PTD-SGV-TMN7 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN8 IN PTD-FLD TO 
                PTD-SGV-TMN8 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN9 IN PTD-FLD TO 
                PTD-SGV-TMN9 IN PTD(FRM-IFLD).
           MOVE FRM-SGV-TMN0 IN PTD-FLD TO 
                PTD-SGV-TMN0 IN PTD(FRM-IFLD).
       FIN-RET-TMIN.
           EXIT.

       VAL-KEY-PTD SECTION.
       INI-VAL-KEY-PTD.
           PERFORM VAL-IKY-PTD.
           PERFORM VAL-MKY-PTD.
           PERFORM VAL-AKY-PTD.
       FIN-VAL-KEY-PTD.
           EXIT.
       
       VAL-IKY-PTD SECTION.
       INI-VAL-IKY-PTD.
           PERFORM VAL-PTD-FEC-FPTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-FEC-FPTD-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
           PERFORM VAL-PTD-HRA-HRPT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-HRA-HRPT-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
           PERFORM VAL-PTD-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-COD-OFIC-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
           PERFORM VAL-PTD-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-COD-VCAM-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
           PERFORM VAL-PTD-COD-TOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-COD-TOPD-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
           PERFORM VAL-PTD-COD-AOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTD-COD-AOPD-LEN IN PTD-FLD
                GO TO FIN-VAL-IKY-PTD.
       FIN-VAL-IKY-PTD.
           EXIT.
       
       VAL-AKY-PTD SECTION.
       INI-VAL-AKY-PTD.
       FIN-VAL-AKY-PTD.
           EXIT.
       
       VAL-PTD-FEC-FPTD SECTION.
       INI-VAL-PTD-FEC-FPTD.
      *<<<< PTD_FEC_FPTD 
           IF SCR-CCPP NOT = 'ING'
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO PTD-NUM-SPTD IN PTD-FLD
               MOVE HOY-AHOY TO PTD-NUM-APTD IN PTD-FLD
               MOVE HOY-MHOY TO PTD-NUM-MPTD IN PTD-FLD
               MOVE HOY-DHOY TO PTD-NUM-DPTD IN PTD-FLD.
      *>>>> 
       FIN-VAL-PTD-FEC-FPTD.
           EXIT.
       
       VAL-PTD-HRA-HRPT SECTION.
       INI-VAL-PTD-HRA-HRPT.
      *<<<< PTD_HRA_HRPT 
           IF SCR-CCPP NOT = 'ING'
               MOVE HOY-HHOY TO PTD-HRA-HRPT IN PTD-FLD.
      *           MOVE SPACES TO MSG-COD-MENS.
      *     PERFORM VAL-HORA.
      *     IF MSG-COD-MENS > SPACES
      *         MOVE 'DAP' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> 
       FIN-VAL-PTD-HRA-HRPT.
           EXIT.
       
       VAL-PTD-COD-OFIC SECTION.
       INI-VAL-PTD-COD-OFIC.
           IF PTD-COD-OFIC IN PTD-FLD NOT > SPACES
              MOVE SPACES TO PTD-COD-OFIC IN PTD-FLD.
      *<<<< PTD_COD_OFIC
           IF PTD-COD-OFIC IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-OFIC IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-OFIC.
      *>>>> END
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE PTD-COD-OFIC IN PTD-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN PTD-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN PTD-FLD.
       FIN-VAL-PTD-COD-OFIC.
           EXIT.
       
       VAL-PTD-COD-VCAM SECTION.
       INI-VAL-PTD-COD-VCAM.
           IF PTD-COD-VCAM IN PTD-FLD NOT > SPACES
              MOVE SPACES TO PTD-COD-VCAM IN PTD-FLD.
      *<<<< PTD_COD_VCAM 
      *    busca cic de la moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-CIC-CTAB IN TAB = PDB-CIC-0999
               MOVE 'PTDMTO =$'  TO MSG-COD-MENS
           ELSE
               MOVE 'PTDMTO <>$' TO MSG-COD-MENS.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DAP' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-GLS-DESC IN PTD-FLD.
      *>>>> END
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-VCAM IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTD-COD-VCAM IN PTD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN PTD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCAM IN PTD-FLD.
       FIN-VAL-PTD-COD-VCAM.
           EXIT.
       
       VAL-PTD-COD-TOPD SECTION.
       INI-VAL-PTD-COD-TOPD.
           IF PTD-COD-TOPD IN PTD-FLD NOT > SPACES
              MOVE SPACES TO PTD-COD-TOPD IN PTD-FLD.
      *<<<< PTD_COD_TOPD 
           IF PTD-COD-TOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-TOPD IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-TOPD.
      *>>>> END
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE PTD-COD-TOPD IN PTD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTD-COD-TOPD IN PTD-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOPD IN PTD-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOPD IN PTD-FLD.
       FIN-VAL-PTD-COD-TOPD.
           EXIT.
       
       VAL-PTD-COD-AOPD SECTION.
       INI-VAL-PTD-COD-AOPD.
           IF PTD-COD-AOPD IN PTD-FLD NOT > SPACES
              MOVE SPACES TO PTD-COD-AOPD IN PTD-FLD.
      *<<<< PTD_COD_AOPD
           IF PTD-COD-AOPD IN PTD-FLD = '*'
               PERFORM GET-TODAS
               MOVE MSG-GLS-DESC TO FRM-GLS-AOPD IN PTD-FLD
               GO TO FIN-VAL-PTD-COD-AOPD.
      *>>>> END
       FIN-VAL-PTD-COD-AOPD.
           EXIT.
       
       CHK-DUPL SECTION.
       INI-CHK-DUPL.
           PERFORM DAP-FIO-PTD.
           IF FIO-STAT-OKS
              MOVE 'DAP' TO MSG-COD-SIST
              MOVE 'KEY    DUPLI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.

       VAL-CON-IKY-PTD SECTION.
       INI-VAL-CON-IKY-PTD.

           IF     PTD-FEC-FPTD IN PTD-FLD NOT > SPACES 
              AND PTD-HRA-HRPT IN PTD-FLD NOT > ZEROES 
              AND PTD-COD-OFIC IN PTD-FLD NOT > SPACES 
              AND PTD-COD-VCAM IN PTD-FLD NOT > SPACES 
              AND PTD-COD-TOPD IN PTD-FLD NOT > SPACES 
              AND PTD-COD-AOPD IN PTD-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PTD.
      *<<<< FIN_VAL_CON_IKY_PTD OR FIN_VAL_CON_KEY_PTD
           MOVE SPACES TO MSG-COD-MENS IN MSG.
           IF NOT ( PTD-COD-TOPD IN PTD-FLD = '*  ' OR
                    PTD-COD-AOPD IN PTD-FLD = '*  ' )
      * ISP: PRODUCTO ESPECIFICO
               PERFORM VAL-AUX
               IF MSG-COD-MENS NOT > SPACES
                   PERFORM VAL-POD
               ELSE
                   NEXT SENTENCE
           ELSE
      * ISP: PRODUCTO GENERICO
               PERFORM MCH-POD.

           IF MSG-COD-MENS NOT > SPACES
               PERFORM BUS-GLS-TINT.
      *>>>> END

       FIN-VAL-CON-IKY-PTD.
           EXIT.

      *>>>> EOF_BU
*% END
*% IF EOF
      *<<<< EOF
       GET-TODAS SECTION.
       INI-GET-TODAS.
           MOVE 'DAP' TO MSG-COD-SIST.
           MOVE 'TODAS' TO MSG-COD-MENS.
           PERFORM GET-MSG.
       FIN-GET-TODAS.
           EXIT.

       VAL-AUX SECTION.
       INI-VAL-AUX.
           MOVE PTD-COD-TOPD IN PTD-FLD TO PTD-COD-TOPD IN PTD.
           MOVE PTD-COD-AOPD IN PTD-FLD TO PTD-COD-AOPD IN PTD.
           MOVE PTD-COD-COPD IN PTD     TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-COD.
          
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE 'CODAUX NEX' TO MSG-COD-MENS
           ELSE
           IF MSG-COD-MENS = 'COD    NVG'
               MOVE 'CODAUX NVG' TO MSG-COD-MENS.
           PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = 'CODAUX NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOPD IN PTD-FLD.
       FIN-VAL-AUX.
           EXIT.

       VAL-POD SECTION.
       INI-VAL-POD.
           MOVE PTD-COD-VCAM IN PTD-FLD TO POD-COD-VCAM IN POD.
           MOVE PTD-COD-TOPD IN PTD-FLD TO POD-COD-TOPD IN POD.
           MOVE PTD-COD-AOPD IN PTD-FLD TO POD-COD-AOPD IN POD.
           MOVE ZEROES                  TO POD-NUM-IPOD IN POD.
      *ISP: DAPBG001
           PERFORM GET-POD.
           IF MSG-COD-MENS > SPACES
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-POD.
           EXIT.

       MCH-POD SECTION.
       INI-MCH-POD.
           MOVE PTD-COD-VCAM IN PTD-FLD TO POD-COD-VCAM IN POD.
           MOVE SPACES TO POD-COD-TOPD IN POD.
           MOVE SPACES TO POD-COD-AOPD IN POD.
           MOVE ZEROES TO POD-NUM-IPOD IN POD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-MCH-POD.
           PERFORM DAP-FIO-POD.
           IF NOT ( FIO-STAT-OKS AND 
                    PTD-COD-VCAM IN PTD-FLD = POD-COD-VCAM IN POD )
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'NOMTCH POD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-MCH-POD.

           IF POD-IND-VIGE IN POD NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-MCH-POD.

           IF PTD-COD-TOPD IN PTD-FLD = '*  ' AND
              PTD-COD-AOPD IN PTD-FLD = '*  '
               GO TO FIN-MCH-POD.

           IF PTD-COD-TOPD IN PTD-FLD = '*  ' AND
              PTD-COD-AOPD IN PTD-FLD = POD-COD-AOPD IN POD
               GO TO FIN-MCH-POD.

           IF PTD-COD-TOPD IN PTD-FLD = POD-COD-TOPD IN POD AND
              PTD-COD-AOPD IN PTD-FLD = '*  '
               GO TO FIN-MCH-POD.

           IF PTD-COD-TOPD IN PTD-FLD = POD-COD-TOPD IN POD AND
              PTD-COD-AOPD IN PTD-FLD = POD-COD-AOPD IN POD
               GO TO FIN-MCH-POD.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-MCH-POD.
       FIN-MCH-POD.
           EXIT.

      * VAL-HORA SECTION.
      * INI-VAL-HORA.
      *     MOVE PTD-HRA-HRPT IN PTD-FLD TO HOY-HHOY-RED IN HOY-VARI.
      *     IF HOY-HHHY > 24
      *         MOVE 'HRA    INV' TO MSG-COD-MENS
      *     ELSE
      *     IF HOY-MMHY > 59 
      *         MOVE 'MIN    INV' TO MSG-COD-MENS
      *     ELSE
      *     IF HOY-SSHY > 59
      *         MOVE 'SEG    INV' TO MSG-COD-MENS.
      * FIN-VAL-HORA.
      *     EXIT.

       PUT-TMIN SECTION.
       INI-PUT-TMIN.
           MOVE PTD-SGV-TMN1 IN PTD(1) TO FRM-SGV-TMN1 IN PTD-FLD.
           MOVE PTD-SGV-TMN2 IN PTD(1) TO FRM-SGV-TMN2 IN PTD-FLD.
           MOVE PTD-SGV-TMN3 IN PTD(1) TO FRM-SGV-TMN3 IN PTD-FLD.
           MOVE PTD-SGV-TMN4 IN PTD(1) TO FRM-SGV-TMN4 IN PTD-FLD.
           MOVE PTD-SGV-TMN5 IN PTD(1) TO FRM-SGV-TMN5 IN PTD-FLD.
           MOVE PTD-SGV-TMN6 IN PTD(1) TO FRM-SGV-TMN6 IN PTD-FLD.
           MOVE PTD-SGV-TMN7 IN PTD(1) TO FRM-SGV-TMN7 IN PTD-FLD.
           MOVE PTD-SGV-TMN8 IN PTD(1) TO FRM-SGV-TMN8 IN PTD-FLD.
           MOVE PTD-SGV-TMN9 IN PTD(1) TO FRM-SGV-TMN9 IN PTD-FLD.
           MOVE PTD-SGV-TMN0 IN PTD(1) TO FRM-SGV-TMN0 IN PTD-FLD. 
       FIN-PUT-TMIN.
           EXIT.

       BUS-GLS-TINT SECTION.
       INI-BUS-GLS-TINT.
           MOVE 'DAP' TO MSG-COD-SIST.
           IF POD-COD-CVTI IN POD > SPACES
               MOVE 'PTDITOSSPR' TO MSG-COD-MENS
           ELSE
               MOVE 'PTDITOSTAS' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-GLS-ITOS IN PTD-FLD.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'INT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TINT IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TINT IN PTD-FLD.
       FIN-BUS-GLS-TINT.
           EXIT.

       PUT-MNTO SECTION.
       INI-PUT-MNTO.
           DIVIDE PTD-VAL-MNTO IN PTD(FRM-IFLD) BY 1000
                   GIVING PTD-VAL-MNTO IN PTD(FRM-IFLD).
       FIN-PUT-MNTO.
           EXIT.

       RET-MNTO SECTION.
       INI-RET-MNTO.
           MULTIPLY PTD-VAL-MNTO IN PTD(FRM-IFLD) BY 1000
                   GIVING PTD-VAL-MNTO IN PTD(FRM-IFLD).
       FIN-RET-MNTO.
           EXIT.

       PUT-ZER-TACO SECTION.
       INI-PUT-ZER-TACO.
      *NO MUESTRA TASAS ADICIONALES, EXCEPTO PARA DOLARES
*% IF PGM_BQ
           IF SCR-OFRM-SRV
               GO TO FIN-PUT-ZER-TACO.
*% END
           MOVE ZEROES TO PTD-SGV-TADC IN PTD-FLD(FRM-IFLD).
       FIN-PUT-ZER-TACO.
           EXIT.

       PUT-ZER-TAFI SECTION.
       INI-PUT-ZER-TAFI.
      *NO MUESTRA TASAS ADICIONALES, EXCEPTO PARA DOLARES
*% IF PGM_BQ      
           IF SCR-OFRM-SRV
             GO TO FIN-PUT-ZER-TAFI.
*% END
           MOVE ZEROES TO PTD-SGV-TAF1 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF2 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF3 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF4 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF5 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF6 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF7 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF8 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF9 IN PTD-FLD.
           MOVE ZEROES TO PTD-SGV-TAF0 IN PTD-FLD.
       FIN-PUT-ZER-TAFI.
           EXIT.

       REG-TO-FRM SECTION.
       INI-REG-TO-FRM.
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX1
           MOVE PTD-SGV-TMX1 IN PTD(1) TO PTD-SGV-TMX1 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX1 IN PTD(2) TO PTD-SGV-TMX1 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX1 IN PTD(3) TO PTD-SGV-TMX1 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX1 IN PTD(4) TO PTD-SGV-TMX1 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX1 IN PTD(5) TO PTD-SGV-TMX1 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX2
           MOVE PTD-SGV-TMX2 IN PTD(1) TO PTD-SGV-TMX2 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX2 IN PTD(2) TO PTD-SGV-TMX2 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX2 IN PTD(3) TO PTD-SGV-TMX2 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX2 IN PTD(4) TO PTD-SGV-TMX2 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX2 IN PTD(5) TO PTD-SGV-TMX2 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX3
           MOVE PTD-SGV-TMX3 IN PTD(1) TO PTD-SGV-TMX3 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX3 IN PTD(2) TO PTD-SGV-TMX3 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX3 IN PTD(3) TO PTD-SGV-TMX3 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX3 IN PTD(4) TO PTD-SGV-TMX3 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX3 IN PTD(5) TO PTD-SGV-TMX3 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX4
           MOVE PTD-SGV-TMX4 IN PTD(1) TO PTD-SGV-TMX4 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX4 IN PTD(2) TO PTD-SGV-TMX4 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX4 IN PTD(3) TO PTD-SGV-TMX4 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX4 IN PTD(4) TO PTD-SGV-TMX4 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX4 IN PTD(5) TO PTD-SGV-TMX4 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX5
           MOVE PTD-SGV-TMX5 IN PTD(1) TO PTD-SGV-TMX5 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX5 IN PTD(2) TO PTD-SGV-TMX5 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX5 IN PTD(3) TO PTD-SGV-TMX5 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX5 IN PTD(4) TO PTD-SGV-TMX5 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX5 IN PTD(5) TO PTD-SGV-TMX5 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX6
           MOVE PTD-SGV-TMX6 IN PTD(1) TO PTD-SGV-TMX6 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX6 IN PTD(2) TO PTD-SGV-TMX6 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX6 IN PTD(3) TO PTD-SGV-TMX6 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX6 IN PTD(4) TO PTD-SGV-TMX6 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX6 IN PTD(5) TO PTD-SGV-TMX6 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX7
           MOVE PTD-SGV-TMX7 IN PTD(1) TO PTD-SGV-TMX7 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX7 IN PTD(2) TO PTD-SGV-TMX7 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX7 IN PTD(3) TO PTD-SGV-TMX7 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX7 IN PTD(4) TO PTD-SGV-TMX7 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX7 IN PTD(5) TO PTD-SGV-TMX7 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX8
           MOVE PTD-SGV-TMX8 IN PTD(1) TO PTD-SGV-TMX8 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX8 IN PTD(2) TO PTD-SGV-TMX8 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX8 IN PTD(3) TO PTD-SGV-TMX8 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX8 IN PTD(4) TO PTD-SGV-TMX8 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX8 IN PTD(5) TO PTD-SGV-TMX8 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX9
           MOVE PTD-SGV-TMX9 IN PTD(1) TO PTD-SGV-TMX9 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX9 IN PTD(2) TO PTD-SGV-TMX9 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX9 IN PTD(3) TO PTD-SGV-TMX9 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX9 IN PTD(4) TO PTD-SGV-TMX9 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX9 IN PTD(5) TO PTD-SGV-TMX9 IN PTD-FLD(5).
      *
      *    CAMPO INDEXADO   PTD-SGV-TMX0
           MOVE PTD-SGV-TMX0 IN PTD(1) TO PTD-SGV-TMX0 IN PTD-FLD(1).
           MOVE PTD-SGV-TMX0 IN PTD(2) TO PTD-SGV-TMX0 IN PTD-FLD(2).
           MOVE PTD-SGV-TMX0 IN PTD(3) TO PTD-SGV-TMX0 IN PTD-FLD(3).
           MOVE PTD-SGV-TMX0 IN PTD(4) TO PTD-SGV-TMX0 IN PTD-FLD(4).
           MOVE PTD-SGV-TMX0 IN PTD(5) TO PTD-SGV-TMX0 IN PTD-FLD(5).
      *
       FIN-REG-TO-FRM.
           EXIT.

       MSG-TMIN-TMAX SECTION.
       INI-MSG-TMIN-TMAX.
       FIN-MSG-TMIN-TMAX.
           EXIT.

      *>>>> EOF
*% END
