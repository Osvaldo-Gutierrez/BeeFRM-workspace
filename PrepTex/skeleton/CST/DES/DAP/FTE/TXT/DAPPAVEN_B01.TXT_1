*%! Codigo adicional para programa VEN
*% IF SETTAG
*% VSNPQ = "09.08.11"
*% FNCPQ = "090204"
*% VSNPU = "09.08.11"
*% FNCPU = "090204"
*% END
*% NO_HDR_CST = TRUE
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-FEC-FTRN                             PIC 9(08).
           03  WSS-FEC-FTRN-R REDEFINES WSS-FEC-FTRN.
               05 WSS-NUM-STRN                          PIC 9(02).
               05 WSS-NUM-ATRN                          PIC 9(02).
               05 WSS-NUM-MTRN                          PIC 9(02).
               05 WSS-NUM-DTRN                          PIC 9(02).

       COPY DAPBROPD.
       COPY DAPBRLAD.
       COPY DAPBRRCC.
      *>>>> WSS
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *>>>> WSS_DTC
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
              05 PGM-STAT-RCC.
                 88 PGM-STAT-RCC-NUL    VALUE '  '.
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCC-OKS VALUE '0'.
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).
      *>>>> FIN_PGM_STAT
*% END
*% IF INI_FIO_IBM
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>> INI_FIO
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING LAD ODC XON-INI
            PERFORM PRO-ING-REG-LAD.
      *>>>> FIN_CMN_ING LAD ODC XON-FIN
*% END
*% IF FIN_CMN_ELI 
      *<<<< FIN_CMN_ELI LAD ODC XON-INI
            PERFORM PRO-ELI-REG-LAD.
      *>>>> FIN_CMN_ELI LAD ODC XON-FIN
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET LAD ODC XON-INI
            PERFORM PRO-MOD-ANT-REG-LAD.
      *>>>> CMN_MOD_RET LAD ODC XON-FIN
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD LAD ODC XON-INI
            PERFORM PRO-MOD-DES-REG-LAD.
      *>>>> FIN_CMN_MOD LAD ODC XON-FIN
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE VEN-CIC-IOPD IN VEN TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-OPD
               PERFORM PUT-OPD-VEN
           ELSE
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'VEN    NOOPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
           MOVE VEN-CAI-IOPD IN VEN-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE VEN-IIC-IOPD IN VEN-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'OPD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SPACES TO VEN-GLS-FLAG IN VEN.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY DAPBFOPD.
       COPY GNSBEGLS.                                                   
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY DAPBFLAD.
       COPY DAPBFRCC.
       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE VEN-CIC-IOPD IN VEN TO RCC-CIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                  VEN-CIC-IOPD IN VEN = RCC-CIC-IOPD IN RCC)          
                  MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT ( FIO-STAT-OKS AND
                     VEN-CIC-IOPD IN VEN = RCC-CIC-IOPD IN RCC  )
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-NXT-RCC.
           EXIT.
       
*% IF PGM_PU
       PRO-MOD-ANT-REG-LAD  SECTION.
       INI-MOD-ANT-REG-LAD.
      *-----------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'MOD'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'M'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'ANT'                   TO  LAD-COD-INST IN LAD.
           MOVE     1                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.
           PERFORM PRO-GRABA-REG-LAD.
       FIN-MOD-ANT-REG-LAD.
            EXIT.
       
       PRO-MOD-DES-REG-LAD  SECTION.
       INI-MOD-DES-REG-LAD.
      *-----------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'MOD'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'M'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'DES'                   TO  LAD-COD-INST IN LAD.
           MOVE     2                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.
           PERFORM PRO-GRABA-REG-LAD.
       FIN-MOD-DES-REG-LAD.
           EXIT.
      *
       PRO-ING-REG-LAD  SECTION.                                                
       INI-ING-REG-LAD.                                                         
      *-------------------------                                                
           MOVE   SPACES                  TO  LAD.                              
           MOVE   'ING'                   TO  LAD-COD-EVEN IN LAD.              
           MOVE   'I'                     TO  LAD-COD-TACC IN LAD               
                                              LAD-COD-STAT IN LAD.              
           MOVE   'N/A'                   TO  LAD-COD-INST IN LAD.              
                                                                                
           MOVE     1                     TO  LAD-NUM-CLAD IN LAD               
                                              LAD-NUM-COPD IN LAD               
                                              LAD-NUM-CCLI IN LAD               
                                              LAD-NUM-CAUT IN LAD.              
                                                                                
           PERFORM PRO-GRABA-REG-LAD.                                           
       FIN-ING-REG-LAD.                                                         
           EXIT.                                                                
      *                                                                         
       PRO-ELI-REG-LAD  SECTION.                                                
       INI-ELI-REG-LAD.                                                         
      *-------------------------                                                
           MOVE   SPACES                  TO  LAD.                              
           MOVE   'ELI'                   TO  LAD-COD-EVEN IN LAD.              
           MOVE   'E'                     TO  LAD-COD-TACC IN LAD               
                                              LAD-COD-STAT IN LAD.              
           MOVE   'N/A'                   TO  LAD-COD-INST IN LAD.              
                                                                                
           MOVE     1                     TO  LAD-NUM-CLAD IN LAD               
                                              LAD-NUM-COPD IN LAD               
                                              LAD-NUM-CCLI IN LAD               
                                              LAD-NUM-CAUT IN LAD.              
           PERFORM PRO-GRABA-REG-LAD.                                           
       FIN-ELI-REG-LAD.                                                         
           EXIT.       
      *
       PRO-GRABA-REG-LAD  SECTION.
      *---------------------------
       INI-GRABA-REG-LAD.
           MOVE   '1.0'                   TO  LAD-COD-VERS IN LAD.
           MOVE   'VEN'                   TO  LAD-COD-ENTF IN LAD
                                              LAD-COD-ENTO IN LAD
                                              LAD-COD-ENTC IN LAD
                                              LAD-COD-ENTA IN LAD
                                              LAD-COD-ENTI IN LAD.

           MOVE    HOY-FHOY               TO  LAD-FEC-FTRN IN LAD
                                              LAD-FEC-FLAD IN LAD
                                              LAD-FEC-FOPD IN LAD
                                              LAD-FEC-FCLI IN LAD
                                              LAD-FEC-FAUT IN LAD.

           MOVE    HOY-HHOY               TO  LAD-HRA-HRTR IN LAD
                                              LAD-HRA-HLAD IN LAD
                                              LAD-HRA-HOPD IN LAD
                                              LAD-HRA-HCLI IN LAD
                                              LAD-HRA-HAUT IN LAD.

           MOVE  VEN-CIC-IOPD IN VEN      TO  LAD-CIC-IOPD IN LAD.

           MOVE  EIBTRMID                 TO  LAD-COD-OTRN IN LAD.
           MOVE  SCR-USER                 TO  LAD-COD-ATRN IN LAD
                                              LAD-COD-AUTO IN LAD.
           MOVE  EIBTRNID                 TO  LAD-COD-TCIC IN LAD.
           MOVE  SCR-CMND                 TO  LAD-COD-CMND IN LAD.
           MOVE  LAD-COD-COME IN VEN-FLD  TO  LAD-COD-COME IN LAD.

           MOVE  VEN                      TO  LAD-COD-CONT IN LAD.

           PERFORM GET-CUR-RCC.
           IF PGM-STAT-RCC-OKS
                MOVE    RCC-CIC-ICLI IN RCC    TO  LAD-CIC-ICLI IN LAD.
           MOVE    FIO-PUT                TO  FIO-CMND.
           PERFORM DAP-FIO-LAD.

           IF PGM-STAT-RCC-OKS
               PERFORM GET-NXT-RCC
               IF PGM-STAT-RCC-OKS
                   ADD          1    TO    LAD-NUM-CLAD IN LAD
                                           LAD-NUM-COPD IN LAD
                                           LAD-NUM-CCLI IN LAD
                                           LAD-NUM-CAUT IN LAD
                    MOVE    RCC-CIC-ICLI IN RCC TO
                                           LAD-CIC-ICLI IN LAD
                    MOVE    FIO-PUT   TO    FIO-CMND
                    PERFORM DAP-FIO-LAD.
           IF NOT PGM-STAT-RCC-OKS
               MOVE   SPACES  TO  FIO-STAT.
       FIN-GRABA-REG-LAD.
           EXIT.  
*% END
      *>>>>
*% END
