*%! codigo adicional DAPBMVD2
*% IF SETTAG
*% FNCBQ = "080804"
*% VSNBQ = "08.11.24"
*% FNCBU = "080804"
*% VSNBU = "08.11.24"
*% END
*% IF INI_VAL_IKY_VD2
      *<<<< INI_VAL_IKY_VD2
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO FRM-NUM-DCAM IN VD2-FLD.
           MOVE HOY-MHOY TO FRM-NUM-MCAM IN VD2-FLD.
           MOVE HOY-SHOY TO FRM-NUM-SCAM IN VD2-FLD.
           MOVE HOY-AHOY TO FRM-NUM-ACAM IN VD2-FLD.
      *>>>> INI_VAL_IKY_VD2
*% END
*% IF INI_FRM_FEC_FINI
      *<<<< INI_FRM_FEC_FINI
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>> INI_FRM_FEC_FINI
*% END
*% IF FRM_FEC_FINI
      *<<<< FRM_FEC_FINI
           MOVE FRM-NUM-DINI IN VD2-FLD TO WSS-FRM-NUM-DINI.
           MOVE FRM-NUM-MINI IN VD2-FLD TO WSS-FRM-NUM-MINI.
           MOVE FRM-NUM-SINI IN VD2-FLD TO WSS-FRM-NUM-SINI.
           MOVE FRM-NUM-AINI IN VD2-FLD TO WSS-FRM-NUM-AINI.
      *>>>> FRM_FEC_FINI
*% END
*% IF FRM_FEC_FINI
      *<<<< FRM_FEC_FINI
           MOVE FRM-NUM-DINI IN VD2-FLD TO WSS-FRM-NUM-DINI.
           MOVE FRM-NUM-MINI IN VD2-FLD TO WSS-FRM-NUM-MINI.
           MOVE FRM-NUM-SINI IN VD2-FLD TO WSS-FRM-NUM-SINI.
           MOVE FRM-NUM-AINI IN VD2-FLD TO WSS-FRM-NUM-AINI.
      *>>>> FRM_FEC_FINI
*% END
*% IF INI_FRM_FEC_FTER
      *<<<< INI_FRM_FEC_FTER
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>> INI_FRM_FEC_FTER
*% END
*% IF FRM_FEC_FTER
      *<<<< FRM_FEC_FTER
           MOVE FRM-NUM-DTER IN VD2-FLD TO WSS-FRM-NUM-DTER.
           MOVE FRM-NUM-MTER IN VD2-FLD TO WSS-FRM-NUM-MTER.
           MOVE FRM-NUM-STER IN VD2-FLD TO WSS-FRM-NUM-STER.
           MOVE FRM-NUM-ATER IN VD2-FLD TO WSS-FRM-NUM-ATER.
      *>>>> FRM_FEC_FTER
*% END
*% IF INI_VAL_CON_KEY_VD2
      *<<<< INI_VAL_CON_KEY_VD2
           IF WSS-FRM-FEC-FINI > WSS-FRM-FEC-FINI 
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'FINI>FTER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-KEY-VD2.
      *>>>> INI_VAL_CON_KEY_VD2
*% END
*% IF INI_PUT_DBC_VD2
      *<<<< INI_PUT_DBC_VD2
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.
      *>>>> INI_PUT_DBC_VD2
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF FRM-SUAR = FRM-SUAR-MAL
                 GO TO FIN-VAL-DBC-VRF-ICLI.   
           IF DBC-NUM-ICLI IN VD2-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN VD2-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN VD2-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN VD2-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT         TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLIVD2 NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE SPACES TO MSG-COD-MENS
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.

           IF FRM-SUAR = FRM-SUAR-MAL
                 GO TO FIN-VAL-DBC-VRF-ICLI.   

*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN VD2-FLD NOT > ZEROES
           IF DBC-GLS-NOMC IN VD2-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE DBC-GLS-NOMC IN VD2-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'DAP'        TO MSG-COD-SIST
                   MOVE 'CLIVD2 NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                   MOVE ZEROES       TO DBC-NUM-ICLI IN VD2-FLD
                   MOVE SPACES       TO DBC-VRF-ICLI IN VD2-FLD
                   MOVE SPACES       TO DBC-IND-ICLI IN VD2-FLD
                   MOVE SPACES       TO DBC-GLS-ICLI IN VD2-FLD
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN VD2-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN VD2-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN VD2-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN VD2-FLD

                   MOVE SPACES TO MSG-COD-MENS
                   MOVE '00'         TO PGM-STAT-DBC
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.

           IF FRM-SUAR = FRM-SUAR-MAL
                 GO TO FIN-VAL-DBC-GLS-ICLI.   

*% END
