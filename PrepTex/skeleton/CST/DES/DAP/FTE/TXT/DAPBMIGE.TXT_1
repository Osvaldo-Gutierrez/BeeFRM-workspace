*% IF INI_VAL_IKY_IGE
   *<<<<<INI_VAL_IKY_IGE
           PERFORM VAL-IGE-CIC-IOPD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-CIC-IOPD-LEN IN IGE-FLD                  
                GO TO FIN-VAL-IKY-IGE.                                  
           GO TO FIN-VAL-IKY-IGE.
   *>>>>>
*% END
*% IF FRM_MSA_FPIN
      *<<<< FRM_MSA_FPIN                                                
      *Valida periodo ingresado.                                        
           PERFORM GET-FHOY.                                            
           IF NOT ( HOY-MHOY = FRM-NUM-MPIN IN IGE-FLD AND              
                    HOY-SHOY = FRM-NUM-SPIN IN IGE-FLD AND              
                    HOY-AHOY = FRM-NUM-APIN IN IGE-FLD )                
                MOVE 'DAP' TO MSG-COD-SIST                              
                MOVE 'MSAFPINWRN' TO MSG-COD-MENS                       
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-GLS-FPIN IN IGE-FLD.           
                                                                        
      *Busca ultimo dia calendario.                                     
           PERFORM BUS-ULT-CLD.                                         
      *>>>>                                                             
*% END
*% IF INI_FRM_MSA_FPIN
      *<<<< INI_FRM_MSA_FPIN                                            
           MOVE FEC-FBLK-N TO FEC-FBLK.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
      *>>>> INI_FRM_MSA_FPIN                                            
*% END 
*% IF INI_VAL_FLD_IGE
   *<<<<
           PERFORM VAL-FRM-MSA-FPIN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-MSA-FPIN-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-FRM-FEC-FCLD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-FEC-FCLD-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-FRM-GLS-FPIN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-FPIN-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-COD-VCAM.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-COD-VCAM-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-FRM-GLS-VCOC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-VCOC-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-GLS-NOMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-GLS-NOMC-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-NUM-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-NUM-ICLI-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VRF-ICLI.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VRF-ICLI-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-FRM-GLS-NOMC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-NOMC-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-COD-OFIC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-COD-OFIC-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-FRM-GLS-OFIC.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO FRM-GLS-OFIC-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-COD-LOCA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-COD-LOCA-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VAL-CAPT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VAL-CAPT-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VAL-PESO.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VAL-PESO-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-FEC-FREA.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-FEC-FREA-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-FEC-FVEN.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-FEC-FVEN-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VAL-SCAP.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VAL-SCAP-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-COD-TINT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-COD-TINT-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-SGV-TINT.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-SGV-TINT-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VAL-INTE.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VAL-INTE-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.                                  
           PERFORM VAL-IGE-VAL-REAJ.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE -1 TO IGE-VAL-REAJ-LEN IN IGE-FLD                  
                GO TO FIN-VAL-FLD-IGE.    
           GO TO FIN-VAL-FLD-IGE.
   *>>>>
*% END 
*% IF INI_PRO_IGE_IGE
   *<<<<
           MOVE FRM-CPIM-AEY TO IGE-COD-VCAM-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-AEY TO IGE-NUM-ICLI-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-AEY TO IGE-VRF-ICLI-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-AEY TO IGE-COD-OFIC-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-AEY TO IGE-VAL-CAPT-ATR IN IGE-FLD.            
   *>>>>
*% END 
*% IF INI_CLR_IGE_IGE
   *<<<<
           MOVE ZEROES TO IGE-COD-VCAM IN IGE-FLD.                      
   *>>>>
*% END 
*% IF INI_RET_IGE_IGE
   *<<<<<INI_RET_IGE_IGE
           MOVE IGE-COD-VCAM IN IGE-FLD TO IGE-COD-VCAM IN IGE.         
           MOVE IGE-NUM-ICLI IN IGE-FLD TO IGE-NUM-ICLI IN IGE.         
           MOVE IGE-VRF-ICLI IN IGE-FLD TO IGE-VRF-ICLI IN IGE.         
           MOVE IGE-COD-OFIC IN IGE-FLD TO IGE-COD-OFIC IN IGE.         
           MOVE IGE-COD-LOCA IN IGE-FLD TO IGE-COD-LOCA IN IGE.         
   *>>>>>
*% END 
*% IF INI_CLR_IGE_IGE 
    <<<<*
           MOVE ZEROES TO IGE-NUM-ICLI IN IGE-FLD.                      
           MOVE SPACES TO IGE-VRF-ICLI IN IGE-FLD.                      
           MOVE ZEROES TO IGE-COD-OFIC IN IGE-FLD.                      
           MOVE ZEROES TO IGE-COD-LOCA IN IGE-FLD.                      
           MOVE ZEROES TO IGE-COD-VCAM IN IGE-FLD.                      
           MOVE SPACES TO IGE-GLS-NOMC IN IGE-FLD.                      
    *>>>>
*% END
*% IF INI_FST_FLD_IGE
      *<<<< INI_FST_FLD_IGE                                             
           MOVE -1 TO FRM-MSA-FPIN-LEN IN IGE-FLD.                      
           GO TO FIN-FST-FLD-IGE.                                       
      *>>>>                                                             
*% END 
*% IF INI_UNP_IGE_IGE
   *<<<<
           MOVE FRM-CPIM-UBY TO IGE-NUM-ICLI-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-UBY TO IGE-VRF-ICLI-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-UBY TO IGE-COD-OFIC-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-UBY TO IGE-VAL-CAPT-ATR IN IGE-FLD.            
           MOVE FRM-CPIM-UBY TO IGE-COD-VCAM-ATR IN IGE-FLD.            

   *>>>>
*% END 
*% IF EDT_FLD_IGE              
    *<<<<EDT_FLD_IGE
           IF IGE-COD-VCAM-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-COD-VCAM-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-COD-VCAM IN IGE-FLD TO IGE-COD-VCAM-EDT IN IGE-EDT. 
           MOVE IGE-COD-VCAM-EDT IN IGE-EDT TO                          
                IGE-COD-VCAM-ALF IN IGE-FLD.                            
           IF IGE-NUM-ICLI-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-NUM-ICLI-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-NUM-ICLI IN IGE-FLD TO IGE-NUM-ICLI-EDT IN IGE-EDT. 
           MOVE IGE-NUM-ICLI-EDT IN IGE-EDT TO                          
                IGE-NUM-ICLI-ALF IN IGE-FLD.                            
           IF IGE-COD-OFIC-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-COD-OFIC-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-COD-OFIC IN IGE-FLD TO IGE-COD-OFIC-EDT IN IGE-EDT. 
           MOVE IGE-COD-OFIC-EDT IN IGE-EDT TO                          
                IGE-COD-OFIC-ALF IN IGE-FLD.                            
           IF IGE-COD-LOCA-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-COD-LOCA-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-COD-LOCA IN IGE-FLD TO IGE-COD-LOCA-EDT IN IGE-EDT. 
           MOVE IGE-COD-LOCA-EDT IN IGE-EDT TO                          
                IGE-COD-LOCA-ALF IN IGE-FLD.                            
           IF IGE-VAL-CAPT-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-VAL-CAPT-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-VAL-CAPT IN IGE-FLD TO IGE-VAL-CAPT-EDT IN IGE-EDT. 
           MOVE IGE-VAL-CAPT-EDT IN IGE-EDT TO                          
                IGE-VAL-CAPT-ALF IN IGE-FLD.                            
           IF IGE-VAL-PESO-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-VAL-PESO-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-VAL-PESO IN IGE-FLD TO IGE-VAL-PESO-EDT IN IGE-EDT. 
           MOVE IGE-VAL-PESO-EDT IN IGE-EDT TO                          
                IGE-VAL-PESO-ALF IN IGE-FLD.                            
           IF IGE-VAL-SCAP-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-VAL-SCAP-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-VAL-SCAP IN IGE-FLD TO IGE-VAL-SCAP-EDT IN IGE-EDT. 
           MOVE IGE-VAL-SCAP-EDT IN IGE-EDT TO                          
                IGE-VAL-SCAP-ALF IN IGE-FLD.                            
           IF IGE-COD-TINT-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-COD-TINT-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-COD-TINT IN IGE-FLD TO IGE-COD-TINT-EDT IN IGE-EDT. 
           MOVE IGE-COD-TINT-EDT IN IGE-EDT TO                          
                IGE-COD-TINT-ALF IN IGE-FLD.                            
           IF IGE-SGV-TINT-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-SGV-TINT-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-SGV-TINT IN IGE-FLD TO IGE-SGV-TINT-EDT IN IGE-EDT. 
           MOVE IGE-SGV-TINT-EDT IN IGE-EDT TO                          
                IGE-SGV-TINT-ALF IN IGE-FLD.                            
           IF IGE-VAL-INTE-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-VAL-INTE-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-VAL-INTE IN IGE-FLD TO IGE-VAL-INTE-EDT IN IGE-EDT. 
           MOVE IGE-VAL-INTE-EDT IN IGE-EDT TO                          
                IGE-VAL-INTE-ALF IN IGE-FLD.                            
           IF IGE-VAL-REAJ-LEN IN IGE-FLD = -9                          
                MOVE -1 TO IGE-VAL-REAJ-LEN IN IGE-FLD                  
                GO TO FIN-EDT-FLD-IGE.                                  
           MOVE IGE-VAL-REAJ IN IGE-FLD TO IGE-VAL-REAJ-EDT IN IGE-EDT. 
           MOVE IGE-VAL-REAJ-EDT IN IGE-EDT TO                          
                IGE-VAL-REAJ-ALF IN IGE-FLD.                            
           GO TO FIN-EDT-FLD-IGE.
    *>>>>
*% END
*% IF  INI_VAL_NUM_FLD_IGE
    *<<<<  INI_VAL_NUM_FLD_IGE
       VAL-NUM-IGE-COD-VCAM.                                            
           MOVE IGE-COD-VCAM-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-COD-VCAM IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-COD-VCAM-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-NUM-ICLI.                                            
           MOVE IGE-NUM-ICLI-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 9 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-NUM-ICLI IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-NUM-ICLI-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-COD-OFIC.                                            
           MOVE IGE-COD-OFIC-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 4 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-COD-OFIC IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-COD-OFIC-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-COD-LOCA.                                            
           MOVE IGE-COD-LOCA-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 6 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-COD-LOCA IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-COD-LOCA-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-VAL-CAPT.                                            
           MOVE IGE-VAL-CAPT-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
      *ALD-ADA-INI/05032002                                             
           MOVE 10 TO NUM-NENT.                                         
           MOVE 4 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9V TO IGE-VAL-CAPT IN IGE-FLD                 
      *ALD-ADA-FIN/05032002                                             
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-VAL-CAPT-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-VAL-PESO.                                            
           MOVE IGE-VAL-PESO-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 13 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-VAL-PESO IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-VAL-PESO-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-VAL-SCAP.                                            
           MOVE IGE-VAL-SCAP-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 13 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-VAL-SCAP IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-VAL-SCAP-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-COD-TINT.                                            
           MOVE IGE-COD-TINT-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-COD-TINT IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-COD-TINT-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-SGV-TINT.                                            
           MOVE IGE-SGV-TINT-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 3 TO NUM-NENT.                                          
           MOVE 2 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9V TO IGE-SGV-TINT IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-SGV-TINT-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-VAL-INTE.                                            
           MOVE IGE-VAL-INTE-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
           MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE 13 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
               MOVE NUM-NN9N TO IGE-VAL-INTE IN IGE-FLD                 
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-VAL-INTE-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
       VAL-NUM-IGE-VAL-REAJ.                                            
           MOVE IGE-VAL-REAJ-ALF IN IGE-FLD TO NUM-NUME.                
           MOVE NUM-ZERO-S TO NUM-ZERO.                                 
      *ALD-ADA-INI/08032002                                             
      *    MOVE NUM-SGNO-N TO NUM-SGNO.                                 
           MOVE NUM-SGNO-S TO NUM-SGNO.                                 
      *ALD-ADA-FIN/08032002                                             
           MOVE 13 TO NUM-NENT.                                         
           MOVE 0 TO NUM-NDCM.                                          
           PERFORM VAL-NUM.                                             
           IF NUM-STAT-OKS                                              
      *ALD-ADA-INI/08032002                                             
      *        MOVE NUM-NN9N TO IGE-VAL-REAJ IN IGE-FLD                 
               MOVE NUM-NS9N TO IGE-VAL-REAJ IN IGE-FLD                 
      *ALD-ADA-FIN/08032002                                             
           ELSE                                                         
               MOVE NUM-MENS     TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE -9 TO IGE-VAL-REAJ-LEN IN IGE-FLD                   
                GO TO FIN-VAL-NUM-FLD-IGE.                              
           GO TO FIN-VAL-NUM-FLD-IGE.
    *>>>>
*% END
*% IF INI_IGE_COD_OFIC
    *<<<<
      *VAL-OFI Valida codigo de Oficina en TABLAS                       
           MOVE IGE-COD-OFIC IN IGE-FLD  TO WSS-COD-OFIC IN WSS-VARI.   
           MOVE WSS-COD-OFI3 IN WSS-VARI TO OFI-COD-OFIC IN OFI.        
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE SPACES TO FRM-GLS-OFIC IN IGE-FLD                   
           ELSE                                                         
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN IGE-FLD.     
    *>>>>
*% END 
*% IF  INI_IGE_COD_LOCA
   *<<<<
      *LOCALIDAD                                                        
            MOVE 'TAB' TO TAB-COD-SIST.                                 
            MOVE 'COM' TO TAB-COD-TTAB IN TAB.                          
            MOVE OFI-COD-COMU IN OFI TO TAB-COD-CTAB IN TAB.            
            PERFORM BUS-TAB.                                            
            MOVE TAB TO COM.                                            
            MOVE COM-COD-REGI IN COM TO WSS-COD-REGI.                   
            MOVE COM-EXT-CTAB IN COM TO WSS-COD-LUGA.                   
            MOVE WSS-COD-LOCA        TO IGE-COD-LOCA IN IGE-FLD.        
   *>>>>
*% END
*%  IF INI_IGE_VAL_CAPT 
     *<<<< INI_IGE_VAL_CAPT
           IF IGE-VAL-CAPT IN IGE-FLD NOT > ZEROES                      
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-IGE-VAL-CAPT.                               
      *ALD-ADA-INI/08032002                                             
           IF IGE-COD-VCAM IN IGE-FLD = 999                             
               MOVE IGE-VAL-CAPT IN IGE-FLD TO IGE-VAL-PESO IN IGE-FLD  
               COMPUTE  PES-SGV-DECI = IGE-VAL-CAPT IN IGE-FLD -        
                                       IGE-VAL-PESO IN IGE-FLD          
               IF PES-SGV-DECI NOT = ZEROES                             
                   MOVE 'DAP' TO MSG-COD-SIST                           
                   MOVE 'CAPTSINDEC' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-IGE-VAL-CAPT.                          
      *ALD-ADA-FIN/08032002                                             
     *>>>>
*% END
*% IF INI_IGE_FEC_FREA
      *<<<< INI_IGE_FEC_FREA                                            
           MOVE FEC-FBLK-N TO FEC-FBLK.                                 
      *>>>> INI_IGE_FEC_FTER                                            
*% END
*% IF INI_IGE_FEC_FVEN
      *<<<< INI_IGE_FEC_FVEN                                            
           MOVE FEC-FBLK-N TO FEC-FBLK.                                 
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *>>>> INI_IGE_FEC_FTER                                            
*% END 
*% IF INI_IGE_COD_TINT                                            
      *<<<<INI_VAL_IGE_COD_TINT
                  MOVE 100 TO IGE-COD-TINT IN IGE-FLD.                         
      *>>>>                                                             
*% END 
*% IF INI_IGE_SGV_TINT                                            
      *<<<<INI_VAL_IGE_SGV_TINT
           MOVE ZEROES TO IGE-SGV-TINT IN IGE-FLD.                      
      *>>>>                                                             
*% END
*% IF INI_IGE_VAL_INTE                                            
      *<<<<                                                             
           MOVE ZEROES TO IGE-VAL-INTE IN IGE-FLD.                      
      *>>>>                                                             
*% END
*% IF VAL_CON_FLD_IGE
      *<<<< VAL_CON_FLD_IGE                                             
           PERFORM LEE-VCAM.                                            
           IF MSG-COD-MENS > SPACES                                     
                GO TO FIN-VAL-CON-FLD-IGE.                              
                                                                        
           IF IGE-GLS-NOMC IN IGE-FLD NOT > SPACES                      
      * ESTA VARIABLE NO ESTA DEFINIDA AUN EN BCI                       
      *         MOVE FRM-POS-CURS TO OPD-COD-CUST-LEN IN OPD-FLD        
                MOVE -1           TO IGE-GLS-NOMC-LEN IN IGE-FLD        
                MOVE 'S' TO FRM-UCUR                                    
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-CON-FLD-IGE.                              
                                                                        
           IF IGE-VAL-CAPT IN IGE-FLD NOT > ZEROES AND                  
              IGE-VAL-PESO IN IGE-FLD NOT > ZEROES                      
      *        valor inicial pesos y valor inicial moneda original      
      *        no pueden ser cero ambos                                 
               MOVE 'IPESCAPT  NZ' TO MSG-COD-MENS                      
               GO TO ERR-VAL-CAPT.                                      
            MULTIPLY IGE-VAL-CAPT IN IGE-FLD BY                         
               CAM-SGV-VCAM IN CAM GIVING                               
               WSS-VAL-IPES IN WSS-VARI ROUNDED.                        
      * ISP: REDONDEA PESOS Y QUITA DECIMALES                           
           MOVE WSS-VAL-IPES IN WSS-VARI TO PES-SGV-DECI.               
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO WSS-VAL-IPES IN WSS-VARI.               
                                                                        
           IF IGE-VAL-CAPT IN IGE-FLD NOT > ZEROES                      
               DIVIDE IGE-VAL-PESO IN IGE-FLD BY                        
                  CAM-SGV-VCAM IN CAM GIVING                            
                  IGE-VAL-CAPT IN IGE-FLD ROUNDED.                      
                                                                        
      *    IF IGE-VAL-PESO IN IGE-FLD NOT > ZEROES                      
              MOVE WSS-VAL-IPES IN WSS-VARI TO IGE-VAL-PESO IN IGE-FLD. 
                                                                        
           IF WSS-VAL-IPES IN WSS-VARI NOT > ZEROES                     
               MOVE IGE-VAL-PESO IN IGE-FLD TO WSS-VAL-IPES IN WSS-VARI.
                                                                        
           IF WSS-VAL-IPES IN WSS-VARI NOT = IGE-VAL-PESO IN IGE-FLD    
      *        valor captacion inconsistente                            
               MOVE 'VALCAPT  INC' TO MSG-COD-MENS                      
               GO TO ERR-VAL-CAPT.                                      
                                                                        
                                                                        
       CALC-REAJ-SALDO.                                                 
      *Valor de cambio a fecha ultimo dia calendario mes procesado:     
           PERFORM OBT-VCAM-FCLD.                                       
                                                                        
           IF MSG-COD-MENS > SPACES                                     
                GO TO FIN-VAL-CON-FLD-IGE.                              
           MULTIPLY IGE-VAL-CAPT IN IGE-FLD BY                          
               CAM-SGV-VCAM IN CAM GIVING                               
               WSS-VAL-PUDC IN WSS-VARI ROUNDED.                        
                                                                        
      *REDONDEA PESOS Y QUITA DECIMALES                                 
           MOVE WSS-VAL-PUDC IN WSS-VARI TO PES-SGV-DECI.               
           PERFORM PES-SCTV.                                            
           MOVE PES-SGV-ENTE TO WSS-VAL-PUDC IN WSS-VARI.               
                                                                        
      *SALDO OPERACION:                                                 
           MOVE WSS-VAL-PUDC IN WSS-VARI TO IGE-VAL-SCAP IN IGE-FLD.    
                                                                        
      *REAJUSTES:                                                       
           SUBTRACT IGE-VAL-PESO IN IGE-FLD  FROM                       
                    WSS-VAL-PUDC IN WSS-VARI GIVING                     
                    IGE-VAL-REAJ IN IGE-FLD.                            
                                                                        
           GO TO FIN-VAL-CON-FLD-IGE.                                   
                                                                        
       ERR-VAL-CAPT.                                                    
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
           MOVE 'DAP' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
      *>>>>                                                             
*% END
*% IF EOF_BU
      *<<<< EOF_BU                                                      
       LEE-VCAM SECTION.                                                
       INI-LEE-VCAM.                                                    
      *    moneda reajustable, chilena y no pesos ; convertir a pesos   
           MOVE SPACES TO MSG-COD-MENS.                                 
           IF IGE-COD-VCAM IN IGE-FLD = 999                             
               MOVE 1 TO CAM-SGV-VCAM IN CAM                            
               GO TO FIN-LEE-VCAM.                                      
           MOVE PDB-CIC-0999            TO TAB-CIC-CTAB IN TAB.         
                                                                        
           MOVE IGE-COD-VCAM IN IGE-FLD  TO WSS-COD-VCA3 IN WSS-VARI.   
           MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
                                                                        
           MOVE IGE-NUM-DREA IN IGE-FLD  TO TAB-NUM-DTRN IN TAB.        
           MOVE IGE-NUM-MREA IN IGE-FLD  TO TAB-NUM-MTRN IN TAB.        
           MOVE IGE-NUM-SREA IN IGE-FLD  TO TAB-NUM-STRN IN TAB.        
           MOVE IGE-NUM-AREA IN IGE-FLD  TO TAB-NUM-ATRN IN TAB.        
           PERFORM GET-VCAM.                                            
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
       FIN-LEE-VCAM.                                                    
           EXIT.                                                        
                                                                        
       OBT-VCAM-FCLD SECTION.                                           
       INI-LEE-VCAM-FCLD.                                               
      *    moneda reajustable, chilena y no pesos ; convertir a pesos   
           IF IGE-COD-VCAM IN IGE-FLD = 999                             
               MOVE 1 TO CAM-SGV-VCAM IN CAM                            
               GO TO FIN-LEE-VCAM-FCLD.                                 
           MOVE PDB-CIC-0999             TO TAB-CIC-CTAB IN TAB.        
                                                                        
           MOVE IGE-COD-VCAM IN IGE-FLD  TO WSS-COD-VCA3 IN WSS-VARI.   
           MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
                                                                        
           MOVE FRM-NUM-DCLD IN IGE-FLD  TO TAB-NUM-DTRN IN TAB.        
           MOVE FRM-NUM-MCLD IN IGE-FLD  TO TAB-NUM-MTRN IN TAB.        
           MOVE FRM-NUM-SCLD IN IGE-FLD  TO TAB-NUM-STRN IN TAB.        
           MOVE FRM-NUM-ACLD IN IGE-FLD  TO TAB-NUM-ATRN IN TAB.        
           PERFORM GET-VCAM.                                            
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS.                           
       FIN-LEE-VCAM-FCLD.                                               
           EXIT.                                                        
                                                                        
       PUT-DBC-IGE SECTION.                                             
       INI-PUT-DBC-IGE.                                                 
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.                        
           IF PGM-STAT-DBC-NUL                                          
              GO TO FIN-PUT-DBC-IGE.                                    
           MOVE DBC-GLS-NOMC IN DBC TO IGE-GLS-NOMC IN IGE-FLD.         
           MOVE DBC-NUM-ICLI IN DBC TO IGE-NUM-ICLI IN IGE-FLD.         
       FIN-PUT-DBC-IGE.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       BUS-ULT-CLD SECTION.                                             
       INI-BUS-ULT-CLD.                                                 
      * BUSCA ULTIMO DIA CALENDARIO                                     
           MOVE 31                      TO FEC-ITM1.                    
           MOVE FRM-NUM-MPIN IN IGE-FLD TO FEC-ITM2.                    
           MOVE FRM-NUM-SPIN IN IGE-FLD TO FEC-ITM3.                    
           MOVE FRM-NUM-APIN IN IGE-FLD TO FEC-ITM4.                    
                                                                        
       CIC-BUS-ULT-CLD.                                                 
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-N   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               SUBTRACT 1 FROM FEC-ITM1                                 
               GO TO CIC-BUS-ULT-CLD                                    
           ELSE                                                         
               MOVE FEC-FECH TO FRM-FEC-FCLD IN IGE-FLD.                
       FIN-BUS-ULT-CLD.                                                 
           EXIT.                                                        
       VAL-IGE-COD-VCAM SECTION.                                        
       INI-VAL-IGE-COD-VCAM.                                            
      *<<<<                                                             
      *VAL-OFI Valida codigo de moneda en TABLAS                        
           IF NOT ( IGE-COD-VCAM IN IGE-FLD = 998 OR                    
                    IGE-COD-VCAM IN IGE-FLD = 999 )                     
                MOVE 'GNS' TO MSG-COD-SIST                              
                MOVE 'COD    NEX' TO MSG-COD-MENS                       
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC TO FRM-MENS                           
                MOVE FRM-SUAR-MAL TO FRM-SUAR                           
                GO TO FIN-VAL-IGE-COD-VCAM.                             
                                                                        
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.                           
           MOVE IGE-COD-VCAM IN IGE-FLD  TO WSS-COD-VCA3 IN WSS-VARI.   
           MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE SPACES TO FRM-GLS-VCOC IN IGE-FLD                   
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
           ELSE                                                         
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN IGE-FLD.     
                                                                        
                                                                        
      *Si U.F. verifica si tiene valor de cambio a ultimo dia calendario
           IF IGE-COD-VCAM IN IGE-FLD = 998                             
               PERFORM OBT-VCAM-FCLD.                                   
      *>>>>                                                             
       FIN-VAL-IGE-COD-VCAM.                                            
           EXIT.                                                        
                                                                        
       VAL-FRM-GLS-VCOC SECTION.                                        
       INI-VAL-FRM-GLS-VCOC.                                            
       FIN-VAL-FRM-GLS-VCOC.                                            
           EXIT.                                                        
                                                                        
       VAL-IGE-GLS-NOMC SECTION.                                        
       INI-VAL-IGE-GLS-NOMC.                                            
           IF IGE-GLS-NOMC IN IGE-FLD NOT > SPACES                      
              MOVE SPACES TO IGE-GLS-NOMC IN IGE-FLD.                   
       FIN-VAL-IGE-GLS-NOMC.                                            
           EXIT.                                                        
                                                                        
       VAL-IGE-NUM-ICLI SECTION.                                        
       INI-VAL-IGE-NUM-ICLI.                                            
           IF IGE-NUM-ICLI IN IGE-FLD = ZEROES                          
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-IGE-NUM-ICLI.                             
       FIN-VAL-IGE-NUM-ICLI.                                            
           EXIT.                                                        
                                                                        
       VAL-IGE-VRF-ICLI SECTION.                                        
       INI-VAL-IGE-VRF-ICLI.                                            
           IF IGE-VRF-ICLI IN IGE-FLD NOT > SPACES                      
              MOVE SPACES TO IGE-VRF-ICLI IN IGE-FLD.                   
      *VAL-VRF Valida Verificador                                       
           MOVE VRF-VAL TO VRF-CMND.                                    
           MOVE VRF-SVRF-K TO VRF-SVRF.                                 
           MOVE VRF-ZERO-S TO VRF-ZERO.                                 
           MOVE IGE-NUM-ICLI IN IGE-FLD TO VRF-NUME.                    
           MOVE IGE-VRF-ICLI IN IGE-FLD TO VRF-DVRF.                    
           MOVE 7 TO VRF-LMAX.                                          
           PERFORM PRO-VRF.                                             
      *<<<< FIN_IGE_VRF_ICLI                                            
                                                                        
           IF FRM-SUAR NOT = FRM-SUAR-OKS                               
               GO TO FIN-VAL-IGE-VRF-ICLI.                              
                                                                        
           MOVE IGE-NUM-ICLI IN IGE-FLD  TO WSS-NUM-ICL9 IN WSS-VARI.   
           MOVE WSS-NUM-ICL8 IN WSS-VARI TO DBC-NUM-ICLI IN DBC.        
           MOVE IGE-VRF-ICLI IN IGE-FLD  TO DBC-VRF-ICLI IN DBC.        
           MOVE SPACES                   TO DBC-IND-ICLI IN DBC.        
           MOVE SPACES                   TO DBC-GLS-ICLI IN DBC.        
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           MOVE FIO-STAT TO PGM-STAT-DBC.                               
           IF NOT FIO-STAT-OKS                                          
      *        cliente inexistente                                      
               MOVE 'CLICCC NEX' TO MSG-COD-MENS                        
               MOVE 'SGC' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-GLS-NOMC IN IGE-FLD             
            ELSE                                                        
               MOVE SPACES TO FRM-GLS-NOMC IN IGE-FLD                   
               IF IGE-GLS-NOMC IN IGE-FLD = SPACES                      
                  PERFORM PUT-DBC-IGE.                                  
      *>>>>                                                             
       FIN-VAL-IGE-VRF-ICLI.                                            
           EXIT.                                                        
                                                                        
       VAL-FRM-GLS-NOMC SECTION.                                        
       INI-VAL-FRM-GLS-NOMC.                                            
       FIN-VAL-FRM-GLS-NOMC.                                            
           EXIT.                                                        
                                                                        
       VAL-IGE-COD-OFIC SECTION.                                        
       INI-VAL-IGE-COD-OFIC.                                            
      *<<<<                                                             
      *VAL-OFI Valida codigo de Oficina en TABLAS                       
           MOVE IGE-COD-OFIC IN IGE-FLD  TO WSS-COD-OFIC IN WSS-VARI.   
           MOVE WSS-COD-OFI3 IN WSS-VARI TO OFI-COD-OFIC IN OFI.        
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE SPACES TO FRM-GLS-OFIC IN IGE-FLD                   
           ELSE                                                         
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN IGE-FLD.     
      *>>>>                                                             
       FIN-VAL-IGE-COD-OFIC.                                            
           EXIT.                                                        
      *>>>>                                                             
       VAL-IGE-COD-LOCA SECTION.                                        
       INI-VAL-IGE-COD-LOCA.                                            
      *<<<<                                                             
      *LOCALIDAD                                                        
            MOVE 'TAB' TO TAB-COD-SIST.                                 
            MOVE 'COM' TO TAB-COD-TTAB IN TAB.                          
            MOVE OFI-COD-COMU IN OFI TO TAB-COD-CTAB IN TAB.            
            PERFORM BUS-TAB.                                            
            MOVE TAB TO COM.                                            
            MOVE COM-COD-REGI IN COM TO WSS-COD-REGI.                   
            MOVE COM-EXT-CTAB IN COM TO WSS-COD-LUGA.                   
            MOVE WSS-COD-LOCA        TO IGE-COD-LOCA IN IGE-FLD.        
      *>>>>                                                             
       FIN-VAL-IGE-COD-LOCA.                                            
           EXIT.                                                        
*% END

