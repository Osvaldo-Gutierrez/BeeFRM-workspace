      * Modulo de ingreso y validacion parametros PGM. DAPPGM6A
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN M6-WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN M6-WSS-VARI.

      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN M6-WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
      *Calcular el ultimo dia del mes
           MOVE 01           TO WSS-NUM-DFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-MPRO TO WSS-NUM-MFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-SPRO TO WSS-NUM-SFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-APRO TO WSS-NUM-AFIN IN M6-WSS-VARI.
           ADD 1 TO WSS-NUM-MFIN IN M6-WSS-VARI.
           IF WSS-NUM-MFIN = 13
              MOVE 01 TO WSS-NUM-MFIN IN M6-WSS-VARI
              ADD 1   TO WSS-NUM-AFIN IN M6-WSS-VARI.
           PERFORM BUS-ULT-MES.
           IF MSG-COD-MENS > SPACES 
              DISPLAY 'ERROR EN RUTINA ULTIMO DIA DEL MES'
                                                       FIO-STAT
              DISPLAY MSG-COD-MENS
              PERFORM GNS-PRO-END.
           
           IF WSS-FEC-FULD IN M6-WSS-VARI NOT = 
                                    WSS-FEC-FPRO IN M6-WSS-VARI
              DISPLAY 'F. PROCESO NO ES F. ULTIMO DIA DEL MES '
                                    WSS-FEC-FPRO IN M6-WSS-VARI
              DISPLAY 'ABORTO'
              PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DULD IN M6-WSS-VARI TO
                                    WSS-NUM-DUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-MULD IN M6-WSS-VARI TO 
                                    WSS-NUM-MUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-SULD IN M6-WSS-VARI TO 
                                    WSS-NUM-SUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-AULD IN M6-WSS-VARI TO 
                                    WSS-NUM-AUDM IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0999   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0998   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-RDOL IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$ Mediante CIC de la Moneda '1013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-1013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC1013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLL IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la UF a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA LA UF.'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA LA UF.'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FUEF IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la US$REAJ a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-RDOL IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA REAJ. DOLAR'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA REAJ. DOLAR'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FRDO IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la US$ a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-DOLL IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA DOLAR'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA DOLAR'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FDOL IN M6-WSS-VARI.
