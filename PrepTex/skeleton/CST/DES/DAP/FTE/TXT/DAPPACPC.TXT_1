*%! Codigo adicional programa DAPPAPOD
*% PGM_PTC = TRUE
*% IF SETTAG
*% FNCPQ = "090616"
*% VSNPQ = "09.10.21"
*% FNCPU = "090616"
*% VSNPU = "09.10.21"
*% END
*% NO_HDR_CST = TRUE
*% IF WSS
      *<<<< WSS
       COPY DAPWGPOD.
       COPY GNSWGAMT.
       COPY GNSWGAMB.
       COPY DAPMXWS1.
       COPY DAPMXWS2.
       COPY DAPMXWS3.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY DAPBRJPO.

       01  WSS-049-TOT-OCC      PIC 9(03) VALUE 50.      
       01  WSS-VARI.
      *       var para validacion de plazos min/max
           03 WSS-CIC-PER                         PIC X(01).
           03 WSS-NUM-PER                         PIC 9(05).
           03 WSS-FEC-FUNO.
              05 WSS-NUM-SUNO                     PIC 9(02).
              05 WSS-NUM-AUNO                     PIC 9(02).
              05 WSS-NUM-MUNO                     PIC 9(02).
              05 WSS-NUM-DUNO                     PIC 9(02).
      
           03 WSS-FEC-FDOS.
              05 WSS-NUM-SDOS                     PIC 9(02).
              05 WSS-NUM-ADOS                     PIC 9(02).
              05 WSS-NUM-MDOS                     PIC 9(02).
              05 WSS-NUM-DDOS                     PIC 9(02).
      
      *       auxiliar para validacion de POD-COD-CVTI
           03 WSS-CVTI.
              05 WSS-GLS-CVTI              PIC X(01).
              05 WSS-COD-CVTI              PIC X(03).
              05 WSS-COD-PBTI              PIC X(01).
      *       auxiliar para validacion sobre TAB-INT
           03 WSS-INTE.
              05 WSS-INT-COD-BCTI          PIC X(01).
              05 WSS-INT-COD-PBTI          PIC X(01).
              05 WSS-INT-COD-BPBT          PIC X(01).
              05 WSS-INT-COD-SPBT          PIC X(01).
              05 WSS-INT-COD-CVTI          PIC X(03).
              05 WSS-INT-COD-TFPR          PIC X(01).
              05 WSS-INT-NUM-PREP          PIC 9(03).
              05 WSS-INT-IND-PREP          PIC X(01).
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           PERFORM PRO-REQ-052.
           GO TO FIN-FND-KEY.
      *>>>> FND_KEY
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGHOY.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
      
       PRO-REQ-052 SECTION.
       INI-PRO-REQ-052.
      * POD-CON
           MOVE SPACES TO CMMA-POD-COD-VCAM.
           MOVE SPACES TO CMMA-POD-COD-TOPD.
           MOVE SPACES TO CMMA-POD-COD-AOPD.
           MOVE SPACES TO CMMA-POD-NUM-IPOD.
           MOVE SPACES TO CMMA-POD-COD-VIGE.
           MOVE SPACES TO CMMA-POD-COD-MENS.
           MOVE SPACES TO CMMA-POD-GLS-MENS.
           MOVE SPACES TO CMMA-POD-COD-HMAS.
           MOVE SPACES TO CMMA-POD-GLS-HDR.
      
      *    PERFORM EDT-NUM-PT-REQ-052.
           MOVE TSK-TERM-ALF TO CMMA-POD-GLS-COLA-TERM.
      
      
      
      *     MOVE 'CPODTASK' TO CMMA-POD-GLS-COLA.
      
      
      
           MOVE CMMA-POD-GLS-COLA TO QUE-COLA.
      *    MOVE SPACES TO CMMA-POD.
      
      *    MOVE PT-052-01-POD-COD-VCAM TO CMMA-POD-COD-VCAM.
      *    MOVE PT-052-01-POD-COD-TOPD TO CMMA-POD-COD-TOPD.
      *    MOVE PT-052-01-POD-COD-AOPD TO CMMA-POD-COD-AOPD.
      
           MOVE POD-COD-VCAM IN CPC-FLD TO CMMA-POD-COD-VCAM.
           MOVE POD-COD-TOPD IN CPC-FLD TO CMMA-POD-COD-TOPD.
           MOVE POD-COD-AOPD IN CPC-FLD TO CMMA-POD-COD-AOPD.
      
           MOVE FRM-COD-CNAL IN CPC-FLD TO WSS-HDR-CNAL.
           MOVE WSS-HDR TO CMMA-POD-GLS-HDR.
      
           MOVE CMMA-POD               TO SYS-CMMA.
      
      *     MOVE 'R052CMA1' TO QUE-COLA.
      *     MOVE +500 TO QUE-LITM.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE SYS-CMMA TO QUE-ITEM.
      *     PERFORM GNS-PRO-QUE.
      
           MOVE CMMA-POD-TCMA          TO SYS-TCMA.
           MOVE 'DAPPPPOD'             TO SYS-PROG.
           MOVE SYS-LINK               TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO CMMA-POD.
           IF CMMA-POD-COD-MENS > SPACES
                 MOVE '23' TO FIO-STAT
      *          MOVE '1' TO WSS-SND-STAT
      *         MOVE CMMA-POD-GLS-MENS TO WSS-SND-MENS
                MOVE CMMA-POD-GLS-MENS TO FRM-GLS-MENS
                MOVE CMMA-POD-GLS-MENS TO CPC-GLS-MENS IN CPC-FLD
                GO TO FIN-PRO-REQ-052.
      
      *     MOVE CMMA-POD-COD-HMAS TO TP-052-01-FRM-IND-HMAS.
           MOVE CMMA-POD-COD-HMAS TO FRM-IND-HMAS IN CPC-FLD.
      
      *     MOVE '0' TO WSS-SND-STAT.
           MOVE ZEROES TO QUE-NITM.
           MOVE ZEROES TO TPG-I.
       CIC-REQ-052.
           MOVE CMMA-POD-GLS-COLA TO QUE-COLA.
           MOVE TS-LEN-TS-PODU TO QUE-LITM.
           ADD 1 TO TPG-I.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
      *        MOVE TPG-I TO TP-052-01-FRM-NUM-TOCC-NUM
               MOVE TPG-I TO FRM-NUM-TOCC IN CPC-FLD
               MOVE QUE-ITEM TO TS-PODU-DATA
      
               MOVE TS-PODU-DATA TO TP-052-DMSG-IDX-1-02(TPG-I)

               IF TP-052-02-POD-COD-VCAM IN TP-052-DMSG-IDX-1-02(TPG-I)
                          = FRM-COD-VCAM IN CPC-FLD
                             AND
                  TP-052-02-POD-COD-TOPD IN TP-052-DMSG-IDX-1-02(TPG-I)
                          = FRM-COD-TOPD IN CPC-FLD
                             AND
                  TP-052-02-POD-COD-AOPD IN TP-052-DMSG-IDX-1-02(TPG-I)
                          = FRM-COD-AOPD IN CPC-FLD
                     MOVE TPG-I TO TPG-J
               END-IF
               IF TPG-I NOT > 30
                   GO TO CIC-REQ-052.
           PERFORM VAL-NUM-TP-REQ-052.
           IF TPG-J = ZEROES
                MOVE '23' TO FIO-STAT
                GO TO FIN-PRO-REQ-052.
      
           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-POD.
      
           MOVE  TP-052-02-POD-COD-VCAM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-VCAM  IN POD.
      
           MOVE  TP-052-02-POD-COD-TOPD
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-TOPD IN POD.
      
           MOVE  TP-052-02-POD-COD-AOPD
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-AOPD IN POD.
      
           MOVE  TP-052-02-FRM-GLS-VCAM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-VCAM IN CPC-FLD.
      
           MOVE  TP-052-02-FRM-GLS-TOPD
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-TOPD IN CPC-FLD.
      
           MOVE  TP-052-02-FRM-GLS-AOPD
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-AOPD IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-RENO
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-RENO IN POD.
      
           MOVE  TP-052-02-FRM-GLS-RENO
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-RENO IN CPC-FLD.
      
           MOVE  TP-052-02-POD-VAL-CMIN-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-VAL-CMIN IN POD.
      
           MOVE  TP-052-02-POD-COD-ENDO
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-ENDO IN POD.
      
           MOVE  TP-052-02-FRM-GLS-ENDO
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-ENDO IN CPC-FLD.
      
           MOVE  TP-052-02-POD-VAL-CMAX-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-VAL-CMAX IN POD.
      
           MOVE  TP-052-02-POD-COD-BCTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-BCTI IN POD.
      
           MOVE  TP-052-02-FRM-GLS-BCTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-BCTI IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-PMIN-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PMIN IN POD.
      
           MOVE  TP-052-02-POD-IND-PMIN
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-PMIN IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PMIN
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PMIN IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-PBTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-PBTI IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PBTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PBTI IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-PMAX-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PMAX IN POD.
      
           MOVE  TP-052-02-POD-IND-PMAX
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-PMAX IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PMAX
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PMAX IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-SPBT
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-SPBT IN POD.
      
           MOVE  TP-052-02-FRM-GLS-SPBT
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-SPBT IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-VMIN-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-VMIN IN POD.
      
           MOVE  TP-052-02-POD-NUM-VMAX-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-VMAX IN POD.
      
           MOVE  TP-052-02-POD-COD-CVTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-CVTI IN POD.
      
           MOVE  TP-052-02-POD-NUM-SMNV-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-SMNV IN POD.
      
           MOVE  TP-052-02-POD-IND-SMNV
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-SMNV IN POD.
      
           MOVE  TP-052-02-FRM-GLS-SMNV
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-SMNV IN CPC-FLD.
      
           MOVE  TP-052-02-FRM-GLS-CVTI
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-CVTI IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-SMXV-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-SMXV IN POD.
      
           MOVE  TP-052-02-POD-IND-SMXV
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-SMXV IN POD.
      
           MOVE  TP-052-02-FRM-GLS-SMXV
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-SMXV IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-TFPR
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-TFPR IN POD.
      
           MOVE  TP-052-02-POD-COD-MORE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-MORE IN POD.
      
           MOVE  TP-052-02-FRM-GLS-TFPR
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-TFPR IN CPC-FLD.
      
           MOVE  TP-052-02-FRM-GLS-MORE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-MORE IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-PREP-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PREP IN POD.
      
           MOVE  TP-052-02-POD-COD-RESC
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-RESC IN POD.
      
           MOVE  TP-052-02-FRM-GLS-RESC
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-RESC IN CPC-FLD.
      
           MOVE  TP-052-02-POD-IND-PREP
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-PREP IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PREP
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PREP IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-PLPA
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-PLPA IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PLPA
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PLPA IN CPC-FLD.
      
           MOVE  TP-052-02-POD-IND-VIGE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-VIGE IN POD.
      
           MOVE  TP-052-02-POD-NUM-PLRE-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PLRE IN POD.
      
           MOVE  TP-052-02-POD-IND-PLRE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-PLRE IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PLRE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PLRE IN CPC-FLD.
      
           MOVE  TP-052-02-POD-NUM-PNTE-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PNTE IN POD.
      
           MOVE  TP-052-02-POD-NUM-PRES-NUM
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-NUM-PRES IN POD.
      
           MOVE  TP-052-02-POD-IND-PNTE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-IND-PNTE IN POD.
      
           MOVE  TP-052-02-FRM-GLS-PNTE
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PNTE IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-TCDP
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-TCDP IN POD.
      
           MOVE  TP-052-02-FRM-GLS-TCDP
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-TCDP IN CPC-FLD.
      
           MOVE  TP-052-02-POD-COD-GARA
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-GARA IN POD.
      
           MOVE  TP-052-02-POD-COD-AACC
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-AACC IN POD.
      
           MOVE  TP-052-02-POD-COD-AFER
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-AFER IN POD.
      
           MOVE  TP-052-02-POD-COD-NAPR
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           POD-COD-NAPR IN POD.
      
           MOVE  TP-052-02-FRM-GLS-NAPR
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-NAPR IN CPC-FLD.

           MOVE  TP-052-03-FRM-GLS-PROD
                      IN TP-052-DMSG-IDX-1-02(TPG-J) TO
                           FRM-GLS-PROD IN CPC-FLD.
      
      *      PERFORM CLR-NUM-052-L VARYING TPG-L
      *           FROM 1 BY 1 UNTIL TPG-L > 30.
       FIN-PRO-REQ-052.
           EXIT.
       COPY DAPMXPD4.
      
      *>>>> EOF
*% END
