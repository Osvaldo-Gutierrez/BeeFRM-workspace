       PUT-LPD SECTION.
       INI-PUT-LPD.
      *ELI     IF OPD-FEC-FCMP IN OPD > ZEROES AND
      *ELI        VEN-VAL-FINA IN VEN > ZEROES AND
      *ELI        VEN-VAL-SFIN IN VEN > ZEROES
      *ELI           GO TO FIN-PUT-LPD.

           MOVE 'DAP'    TO FIO-SIST.
           MOVE 'VSN'    TO TAB-COD-TTAB IN TAB.
           MOVE 'PUTLPD' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-IND-VIGE = 'S')
                 GO TO FIN-PUT-LPD.

           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE 9999999999 TO LPD-NUM-CORR IN LPD-VARI.
           MOVE LPD-KEY TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
                MOVE 1 TO LPD-NUM-CORR IN LPD-VARI
                GO TO SIG-PUT-LPD.
           IF TAB-COD-TTAB IN TAB NOT = 'MSG'
                MOVE 1 TO LPD-NUM-CORR IN LPD-VARI
                GO TO SIG-PUT-LPD.
           MOVE TAB-COD-CTAB IN TAB TO LPD-KEY.
           IF LPD-GLS-IDEN NOT = '*/'
                MOVE '*/' TO LPD-GLS-IDEN IN LPD-VARI
                MOVE 1 TO LPD-NUM-CORR IN LPD-VARI
           ELSE
                IF LPD-NUM-CORR IS NOT NUMERIC
                    MOVE 1 TO LPD-NUM-CORR IN LPD-VARI
                ELSE
                    ADD 1 TO LPD-NUM-CORR IN LPD-VARI.

       SIG-PUT-LPD.
           MOVE 'DAP' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE LPD-KEY TO TAB-COD-CTAB IN TAB.
           MOVE OPD-CAI-IOPD IN OPD TO LPD-CAI-IOPD.
           MOVE OPD-IIC-IOPD IN OPD TO LPD-IIC-IOPD.

           IF OPD-FEC-FCMP-ATR IN OPD-FLD = FRM-CPIM-AEY
               MOVE 'AEY' TO LPD-CPIM-FCMP
           ELSE
           IF OPD-FEC-FCMP-ATR IN OPD-FLD = FRM-CPIM-UBY
               MOVE 'UBY' TO LPD-CPIM-FCMP
           ELSE
           IF OPD-FEC-FCMP-ATR IN OPD-FLD = FRM-CPIM-ANY
               MOVE 'ANY' TO LPD-CPIM-FCMP
           ELSE
           IF OPD-FEC-FCMP-ATR IN OPD-FLD = FRM-CPIM-UNY
               MOVE 'UNY' TO LPD-CPIM-FCMP
           ELSE
           IF OPD-FEC-FCMP-ATR IN OPD-FLD = FRM-CPSF-AEY
               MOVE 'NFS' TO LPD-CPIM-FCMP
           ELSE
           IF OPD-FEC-FCMP-ATR IN OPD-FLD = LOW-VALUES
               MOVE 'LOW' TO LPD-CPIM-FCMP
           ELSE
               MOVE '???' TO LPD-CPIM-FCMP.

      *     IF OPD-FEC-FCMP-LEN IN OPD-FLD IS NOT NUMERIC
      *         MOVE 'NN' TO LPD-LEN-FCMP
      *     ELSE
      *     IF OPD-FEC-FCMP-LEN IN OPD-FLD = -1
      *         MOVE '-1' TO LPD-LEN-FCMP
      *     ELSE
      *     IF OPD-FEC-FCMP-LEN IN OPD-FLD = -9
      *         MOVE '-9' TO LPD-LEN-FCMP
      *     ELSE
      *     IF OPD-FEC-FCMP-LEN IN OPD-FLD = 0
      *         MOVE '00' TO LPD-LEN-FCMP.

           IF FRM-VAL-FORI-ATR IN OPD-FLD = FRM-CPIM-AEY
               MOVE 'AEY' TO LPD-CPIM-FORI
           ELSE
           IF FRM-VAL-FORI-ATR IN OPD-FLD = FRM-CPIM-UBY
               MOVE 'UBY' TO LPD-CPIM-FORI
           ELSE
           IF FRM-VAL-FORI-ATR IN OPD-FLD = FRM-CPIM-ANY
               MOVE 'ANY' TO LPD-CPIM-FORI
           ELSE
           IF FRM-VAL-FORI-ATR IN OPD-FLD = FRM-CPIM-UNY
               MOVE 'UNY' TO LPD-CPIM-FORI
           ELSE
           IF FRM-VAL-FORI-ATR IN OPD-FLD = FRM-CPSF-AEY
               MOVE 'NFS' TO LPD-CPIM-FORI
           ELSE
           IF FRM-VAL-FORI-ATR IN OPD-FLD = LOW-VALUES
               MOVE 'LOW' TO LPD-CPIM-FORI
           ELSE
               MOVE '???' TO LPD-CPIM-FORI.

      *     IF FRM-VAL-FORI-LEN IN OPD-FLD IS NOT NUMERIC
      *         MOVE 'NN' TO LPD-LEN-FORI
      *     ELSE
      *     IF FRM-VAL-FORI-LEN IN OPD-FLD = -1
      *         MOVE '-1' TO LPD-LEN-FORI
      *     ELSE
      *     IF FRM-VAL-FORI-LEN IN OPD-FLD = -9
      *         MOVE '-9' TO LPD-LEN-FORI
      *     ELSE
      *     IF FRM-VAL-FORI-LEN IN OPD-FLD = 0
      *         MOVE '00' TO LPD-LEN-FORI.

           MOVE HOY-STP-ITRN TO LPD-FEC-FTRN.

           MOVE EIBTRMID TO LPD-COD-TERM.

           MOVE LPD-GLS-FMT1-RED1 TO TAB-GLS-DESC.

           MOVE LPD-GLS-FMT1-RED2 TO TAB-GLS-DATA.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

       FIN-PUT-LPD.
           EXIT.
