*%! Codigo adicional para DAPPAPTD
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "DAPZQPTD"
*% ELSE
*% CLRMFC = "DAPZUPTD"
*% END
*% IF SETTAG
*% FNCPQ = "080706"
*% VSNPQ = "08.12.26"
*% FNCPU = "080706"
*% VSNPU = "08.12.06"
*% END
*% PGM_PTC = TRUE
*% NO_HDR_CST = TRUE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF CMT_ID
      *-----------------------------------------------------------------
      *  MODIFICACIONES:
      *  ---------------
      *-----------------------------------------------------------------
      * PROYECTO     : BALANCE OPTIMO DAP
      * MODIFICACION : ENVIAR INFORMACION A MC2 PARA ACTUALIZACION DE
      *                PPD
      * FECHA        : ENERO 2017
      * ETIQUETA     : *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
      *-----------------------------------------------------------------
*% END      
*% IF WSS
*%! INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
      *<<<< WSS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.
       
*% IF PGM_PU
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
       COPY DAPWWJPT.
       COPY DAPWWPTD.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
*% END
      *Entidades de DAP
       COPY DAPBRPOD.
       COPY DAPWG004.
*% IF PGM_PQ
       COPY DAPWG006.      
*% END
       COPY DAPBRJPT.
      *CST
      *COPY GNSWGPDB.
       COPY GNSWGPES.

*% IF PGM_PU
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPWGPPD.
       COPY MC2BRPPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PPD-REQA==.
       COPY TABWGRCC.

       COPY DAPWG006.
       COPY DAPBRCPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPD-REQA==.
       COPY USPC117.
       COPY DAPWGPOD.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END
*% IF PGM_PQ
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPWGPPD.
       COPY MC2BRPPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PPD-REQA==.
       COPY TABWGRCC.

       COPY DAPBRCPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPD-REQA==.
       COPY DAPWGPOD.

       01  WSS-RUP.
           03 WSS-RUP-PROG                            PIC X(09).
           03 WSS-RUP-PROD                            PIC X(02).
           03 WSS-RUP-FAMI                            PIC X(01).
       01  WSS-IND-BATCH  VALUE 'N'                   PIC X(01).
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END
*% IF PGM_PU
*% END
       
       01  WSS-VARI.
*% IF PGM_PU
*% END       
           03 WSS-MSG.
              05 WSS-MSG1                         PIC X(06).
              05 WSS-MSG2                         PIC X(06).
           03 WSS-STP-IPTD                        PIC 9(14).
           03 WSS-IFLD                            PIC 9(02).
           03 WSS-I                               PIC 9(02).
           03 WSS-J                               PIC 9(02).
           03 WSS-K                               PIC 9(02).
      *ADA-INI 21-SEP-2001
      *    03 WSS-SGV-TPIZ OCCURS 10              PIC 999V9999.
      *    03 WSS-SGV-TAFI OCCURS 10              PIC 999V9999.
           03 WSS-SGV-TPIZ OCCURS 10              PIC S9(03)V9(04).
           03 WSS-SGV-TAFI OCCURS 10              PIC S9(03)V9(04).
      *ADA-INI 21-SEP-2001
           03 WSS-COD-MENS.
              05 WSS-COD-MEN1                     PIC X(33).
              05 WSS-COD-MEN2                     PIC X(03).
              05 WSS-COD-MEN3                     PIC X(10).
              05 WSS-COD-MEN4                     PIC X(03).
           03 WSS-CIC-VCAM                        PIC X(06).
           03 WSS-GLS-MEN1.
              05 WSS-GLS-DES1 VALUE 'PLANTILLA GRABADA EL '
                                                  PIC X(21).
              05 WSS-GLS-M1FD                     PIC X(02).
              05 FILLER  VALUE '-'                PIC X(01).
              05 WSS-GLS-M1FM                     PIC X(02).
              05 FILLER  VALUE '-'                PIC X(01).
              05 WSS-GLS-M1FS                     PIC X(02).
              05 WSS-GLS-M1FA                     PIC X(02).
              05 FILLER  VALUE ' '                PIC X(01).
              05 WSS-GLS-M1HH                     PIC X(02).
              05 FILLER  VALUE ':'                PIC X(01).
              05 WSS-GLS-M1HM                     PIC X(02).
              05 FILLER  VALUE ':'                PIC X(01).
              05 WSS-GLS-M1HS                     PIC X(02).

*% IF PGM_PU
      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       01  WSS-RUP.
           03 WSS-RUP-PROG                            PIC X(09).
           03 WSS-RUP-PROD                            PIC X(02).
           03 WSS-RUP-FAMI                            PIC X(01).
       01  WSS-IND-BATCH  VALUE 'N'                   PIC X(01).
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
*% END
      *>>>> WSS
*% IF PGM_PQ
      *<<<< PGM_PQ
       COPY USPC117.
      *>>>> PGM_PQ
*% END
*% IF PGM_PU
       01  WSS-COD-TAB                 PIC X(12) VALUE SPACES.
       01  WSS-COD-TAB-VCADI REDEFINES WSS-COD-TAB.
           03 WSS-COD-TAB-MND          PIC X(06).
           03 WSS-COD-TAB-DIA          PIC X(04).

       01  WSS-NUM-DIA                 PIC X(05) VALUE SPACES.
       01  WSS-NUM-DIA-DIAS  REDEFINES WSS-NUM-DIA.
           03 WSS-NUM-DIA-DI1          PIC X(01).
           03 WSS-NUM-DIA-DI4          PIC X(04).

       01  WSS-TAB-COD-CMP             PIC X(12) VALUE SPACES.
       01  WSS-COD-TAB-VCADI REDEFINES WSS-TAB-COD-CMP.
           03 WSS-TAB-COD-CMP-MON      PIC X(06).
           03 WSS-TAB-COD-CMP-DIA      PIC X(04).

       01  WSS-TAB-GLS-DESC            PIC X(38) VALUE SPACES.
       01  WSS-TAB-GLS-DESC-CMP REDEFINES WSS-TAB-GLS-DESC.
           03 WSS-TAB-GLS-DESC-TSA     PIC X(25).
           03 WSS-TAB-GLS-DESC-PUF     PIC X(03).
           03 WSS-TAB-GLS-DESC-DI1     PIC X(05).
           03 WSS-TAB-GLS-DESC-DI2     PIC X(05).

       01  WSS-SGV-TAF.
           03 WSS-SGV-TAF-EDT         PIC  999,9999.

       77  WSS-GLS-ABRV               PIC X(05).
       77  WSS-GLS-DCOR               PIC X(12).
       77  WSS-MONEDA                  PIC X(06).

*% END
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-JPT-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
*% IF PGM_PU
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
           PERFORM CLR-REG-JPT.
           PERFORM CLR-REG-PTD.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
      *>>>> END
*% END
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      *ALD-ADA-INI/05032002
      *     IF SCR-CMND = 'CON' OR 'COP' OR 'CVS'
           IF SCR-CMND = 'CON'
      *ALD-ADA-FIN/05032002
               PERFORM BUS-KEY-CON
               MOVE FIO-STAT TO PGM-STAT-PTD
               GO TO FIN-FND-KEY.

      *ALD-ADA-INI/05032002
           IF SCR-CMND = 'COP' OR 'CVS'
               PERFORM BUS-KEY-COP
               MOVE FIO-STAT TO PGM-STAT-PTD
               GO TO FIN-FND-KEY.
      *ALD-ADA-FIN/05032002

           IF SCR-CCPP = 'MOD' OR
              SCR-CCPP = 'ELI' OR
              SCR-CMND = 'VRF'
               PERFORM BUS-KEY-MOD
               MOVE FIO-STAT TO PGM-STAT-PTD
               GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
           MOVE SPACES TO MSG-COD-MENS.

           IF SCR-CCPP = 'ING'
               GO TO END-SCR-TRL.

           IF SCR-CMND = 'VRF' AND
              PTD-COD-STAT IN PTD-FLD = 'S'
      *        PTD no 'S'
               MOVE 'PTD    SV' TO MSG-COD-MENS
               GO TO END-SCR-TRL.

           IF ( SCR-CMND = 'MOD' OR SCR-CMND = 'ACT' ) AND
              PTD-COD-STAT IN PTD-FLD = 'S'
      *        PTD 'S'
               MOVE 'PTD    SV' TO MSG-COD-MENS
               GO TO END-SCR-TRL.

       END-SCR-TRL.

           IF MSG-COD-MENS > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.

           IF SCR-CMND = 'IVS'
                 MOVE 'S' TO PTD-COD-STAT IN PTD-FLD
           ELSE
           IF SCR-CMND = 'ING'
                 MOVE 'N' TO PTD-COD-STAT IN PTD-FLD.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD

           MOVE FRM-CPIM-AEY TO PTD-COD-STAT-ATR IN PTD-FLD.

           IF SCR-CMND = 'COP' OR 'CVS'
               PERFORM UNP-IKY-PTD
               PERFORM FST-KEY-PTD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           IF SCR-CMND = 'VRF' OR 'CVS'
                 MOVE 'S' TO PTD-COD-STAT IN PTD-FLD
           ELSE
           IF SCR-CMND = 'COP'
                 MOVE 'N' TO PTD-COD-STAT IN PTD-FLD.
           PERFORM GET-FHOY.
           PERFORM MOD-KEY-FRM.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM RET-HDR.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *MGC
           IF PTD-COD-STAT IN PTD-FLD = 'S'    AND
              PTD-COD-OFIC IN PTD-FLD = '*'    AND
              PTD-COD-TOPD IN PTD-FLD = '*'    AND
              PTD-COD-AOPD IN PTD-FLD = '*'    AND
              PTD-COD-TAFI IN PTD-FLD = 'T'    AND
              (
              PTD-COD-VCAM IN PTD-FLD = '0999' OR
              PTD-COD-VCAM IN PTD-FLD = '0998'
              )
              PERFORM CRG-TBL-TED.

           IF PTD-COD-STAT IN PTD = 'S'
                PERFORM PRO-JPT.
           PERFORM PUT-MEN1.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           PERFORM EEI-PTD.
           GO TO FIN-CMN-MOD.               
      *>>>> 
*% END 
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP' OR 'CVS'
               PERFORM CMN-ING
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           IF SCR-CMND = 'VRF'
              PERFORM EEI-PTD
              GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF INI_SCR_TRL_PQ
      *<<<< INI_SCR_TRL_PQ
      *NOTA, ESTA ETIQUETA REEMPLAZA A LA GENERADA (PTC-INI)
      * PTC-INI-AUT
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN-AUT
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.

       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.

       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM DAP-FIO-PTD.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        
*% IF PGM_PU           
      * ISP-INI 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
       COPY DAPBCJPT.
       COPY DAPBCPTD.
      * ISP-FIN 31-07-1998 INICIALIZA CAMPOS DE REGISTROS
*% END
      *Entidades de DAP
       COPY DAPBG001.
       COPY DAPBG004.
       COPY DAPBFPOD.
       COPY DAPBFJPT.

       BUS-KEY-CON SECTION.
       INI-BUS-KEY-CON.
           MOVE SPACES TO PTD-COD-TOPD IN PTD.
           MOVE SPACES TO PTD-COD-AOPD IN PTD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-BUS-KEY-CON.
           PERFORM DAP-FIO-PTD.
           IF NOT ( FIO-STAT-OKS AND
              PTD-COD-VCAM IN PTD-FLD = PTD-COD-VCAM IN PTD )
               MOVE '23' TO FIO-STAT
               GO TO FIN-BUS-KEY-CON.

           IF PTD-COD-STAT IN PTD = 'S' AND
              ( PTD-COD-TOPD IN PTD = '*' OR
                PTD-COD-TOPD IN PTD = PTD-COD-TOPD IN PTD-FLD ) AND
              ( PTD-COD-AOPD IN PTD = '*' OR
                PTD-COD-AOPD IN PTD = PTD-COD-AOPD IN PTD-FLD ) AND
              ( PTD-COD-OFIC IN PTD = '*' OR
                PTD-COD-OFIC IN PTD = PTD-COD-OFIC IN PTD-FLD )
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-KEY-CON.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-BUS-KEY-CON.
       FIN-BUS-KEY-CON.
           EXIT.

*% IF PGM_PQ
      *ALD-ADA-INI/05032002
       BUS-KEY-COP SECTION.
       INI-BUS-KEY-COP.
           MOVE SPACES TO PTD-COD-TOPD IN PTD.
           MOVE SPACES TO PTD-COD-AOPD IN PTD.
           MOVE FIO-GET-NLS TO FIO-CMND.

       CIC-BUS-KEY-COP.

           PERFORM DAP-FIO-PTD.
           IF NOT ( FIO-STAT-OKS AND
              PTD-COD-VCAM IN PTD-FLD = PTD-COD-VCAM IN PTD )
               MOVE '23' TO FIO-STAT
               GO TO NXT-BUS-KEY-COP.

           IF PTD-COD-STAT IN PTD = 'S' AND
              PTD-COD-TOPD IN PTD = PTD-COD-TOPD IN PTD-FLD AND
              PTD-COD-AOPD IN PTD = PTD-COD-AOPD IN PTD-FLD AND
              PTD-COD-OFIC IN PTD = PTD-COD-OFIC IN PTD-FLD
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-KEY-COP.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-BUS-KEY-COP.

       NXT-BUS-KEY-COP.

           PERFORM KEY-ALL-PTD.
           MOVE SPACES TO PTD-COD-TOPD IN PTD.
           MOVE SPACES TO PTD-COD-AOPD IN PTD.
           MOVE SPACES TO PTD-COD-OFIC IN PTD.
           PERFORM BUS-KEY-CON.

       FIN-BUS-KEY-COP.
           EXIT.
      *ALD-ADA-FIN/05032002
*% END

       BUS-KEY-MOD SECTION.
       INI-BUS-KEY-MOD.
           MOVE SPACES TO PTD-COD-TOPD IN PTD.
           MOVE SPACES TO PTD-COD-AOPD IN PTD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-BUS-KEY-MOD.
           PERFORM DAP-FIO-PTD.
           IF NOT ( FIO-STAT-OKS AND
              PTD-COD-VCAM IN PTD-FLD = PTD-COD-VCAM IN PTD )
               MOVE '23' TO FIO-STAT
               GO TO FIN-BUS-KEY-MOD.
           
           IF PTD-COD-TOPD IN PTD-FLD = PTD-COD-TOPD IN PTD AND
              PTD-COD-AOPD IN PTD-FLD = PTD-COD-AOPD IN PTD AND
              PTD-COD-OFIC IN PTD-FLD = PTD-COD-OFIC IN PTD AND
              PTD-COD-STAT IN PTD = 'N'
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-KEY-MOD.
           
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-BUS-KEY-MOD.
       FIN-BUS-KEY-MOD.
           EXIT.

      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ

       USPC107 SECTION.
       INI-USPC107.
      *    COPY USPC107.
           COPY USPC107.
       FIN-USPC107.
           EXIT.

      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPBGPPD.
       COPY TABBKRCC.
       COPY MC2BFPPD.

       COPY DAPBFCPD.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
      *>>>> EOF_PQ
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       CRG-TBL-TED SECTION.
       INI-CRG-TBL-TED.
           MOVE PTD-COD-VCAM IN PTD-FLD TO WSS-MONEDA.

       CIC-ELI-TBL-TED.
           MOVE 'DAP'      TO FIO-SIST.
           MOVE 'TED'      TO TAB-COD-TTAB IN TAB.
           MOVE WSS-MONEDA TO TAB-COD-CTAB IN TAB.

           MOVE FIO-GET-NLS     TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           IF NOT FIO-STAT-OKS
               GO TO GRB-TED.

           IF TAB-COD-TTAB IN TAB NOT = 'TED'
               GO TO GRB-TED.

           MOVE TAB-COD-CTAB IN TAB  TO WSS-TAB-COD-CMP
           IF WSS-MONEDA NOT = WSS-TAB-COD-CMP-MON
               GO TO GRB-TED.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-DEL         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.


           GO TO CIC-ELI-TBL-TED.


       GRB-TED.

           MOVE SPACES          TO WSS-TAB-GLS-DESC.
           MOVE 'S'             TO TAB-IND-VIGE.
           MOVE HOY-FHOY        TO TAB-FEC-FTRN.
           IF PTD-COD-VCAM IN PTD-FLD = '0999'
              MOVE '$  '        TO WSS-TAB-GLS-DESC-PUF
              MOVE 'TED$ '      TO WSS-GLS-ABRV
              MOVE 'TED $'      TO WSS-GLS-DCOR

           ELSE
              MOVE 'UF '        TO WSS-TAB-GLS-DESC-PUF
              MOVE 'TEDUF'      TO WSS-GLS-ABRV
              MOVE 'TED U.F.'   TO WSS-GLS-DCOR

           END-IF.

           IF PTD-NUM-DIA1 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA1 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA

              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA1 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF1 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB
              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA2 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA2 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA

              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA2 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF2 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA3 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA3 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA

              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA3 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF3 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA4 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA4 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA

              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA4 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF4 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA5 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA5 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA

              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA5 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF5 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA6 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA6 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA
              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA6 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF6 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA7 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA7 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA
              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA7 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF7 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA8 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA8 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA
              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA8 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF8 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA9 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA9 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA
              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA9 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF9 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF

           IF PTD-NUM-DIA0 IN PTD-FLD > ZEROES
              MOVE 'DAP'               TO FIO-SIST
              MOVE 'TED'               TO TAB-COD-TTAB IN TAB

              MOVE PTD-COD-VCAM IN PTD-FLD
                                       TO WSS-COD-TAB-MND
              MOVE PTD-NUM-DIA0 IN PTD-FLD
                                       TO WSS-NUM-DIA
              MOVE WSS-NUM-DIA-DI4     TO WSS-COD-TAB-DIA
              MOVE WSS-COD-TAB         TO TAB-COD-CTAB IN TAB

              MOVE 'TED'               TO TAB-CIC-TTAB IN TAB
              MOVE WSS-COD-TAB         TO TAB-CIC-CTAB IN TAB

              MOVE 'TASA EQUILIBRIO DAP PARA '
                                       TO WSS-TAB-GLS-DESC-TSA
              MOVE PTD-NUM-DIA0 IN PTD-FLD
                                       TO WSS-TAB-GLS-DESC-DI1
              MOVE ' DIAS'             TO WSS-TAB-GLS-DESC-DI2
              MOVE WSS-TAB-GLS-DESC    TO TAB-GLS-DESC IN TAB

              MOVE WSS-GLS-ABRV        TO TAB-GLS-ABRV IN TAB
              MOVE WSS-GLS-DCOR        TO TAB-GLS-DCOR IN TAB

              MOVE PTD-SGV-TAF0 IN PTD-FLD
                                       TO WSS-SGV-TAF-EDT
              MOVE WSS-SGV-TAF         TO TAB-GLS-DATA IN TAB

              MOVE FIO-PUT             TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT FIO-STAT-OKS
                 GO TO FIN-CRG-TBL-TED
              END-IF
           END-IF.

       FIN-CRG-TBL-TED.
           EXIT.

       RET-HDR SECTION.
       INI-RET-HDR.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO PTD-FEC-FTRN IN PTD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO PTD-HRA-HRTR IN PTD.
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO PTD-COD-OTRN IN PTD.
      *    Autor Transaccion
           MOVE SCR-USER TO PTD-COD-ATRN IN PTD.
           IF SCR-CMND = 'ING'
               MOVE 'I' TO PTD-COD-TACC IN PTD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO PTD-COD-TACC IN PTD
           ELSE
           IF SCR-CMND = 'VRF'
               MOVE 'V' TO PTD-COD-TACC IN PTD
           ELSE
           IF SCR-CMND = 'IVS'
               MOVE 'I' TO PTD-COD-TACC IN PTD
           ELSE
           IF SCR-CMND = 'CVS'
               MOVE 'C' TO PTD-COD-TACC IN PTD.
       FIN-RET-HDR.
           EXIT.

      * proceso journal PTD
       PRO-JPT SECTION.
       INI-PRO-JPT.
           MOVE PTD TO JPT.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DAP-FIO-JPT.
           IF NOT FIO-STAT-OKS
      *        Error al grabar el journal
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'JPT    ERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-MENS TO FRM-MENS.
       FIN-PRO-JPT.
           EXIT.

       MOD-KEY-FRM SECTION.
       INI-MOD-KEY-FRM.
           MOVE HOY-SHOY TO PTD-NUM-SPTD IN PTD-FLD.
           MOVE HOY-AHOY TO PTD-NUM-APTD IN PTD-FLD.
           MOVE HOY-MHOY TO PTD-NUM-MPTD IN PTD-FLD.
           MOVE HOY-DHOY TO PTD-NUM-DPTD IN PTD-FLD.
           MOVE HOY-HHOY TO PTD-HRA-HRPT IN PTD-FLD.
       FIN-MOD-KEY-FRM.
           EXIT.

      * Elimina e Ingresa PTD
       EEI-PTD SECTION.
       INI-EEI-PTD.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DAP-FIO-PTD.
           IF NOT FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'ELI    NOOK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               PERFORM CMN-ING
               IF NOT FIO-STAT-OKS
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-EEI-PTD.
           EXIT.

       PUT-MEN1 SECTION.
       INI-PUT-MEN1.
           MOVE HOY-SHOY TO WSS-GLS-M1FS.
           MOVE HOY-AHOY TO WSS-GLS-M1FA.
           MOVE HOY-MHOY TO WSS-GLS-M1FM.
           MOVE HOY-DHOY TO WSS-GLS-M1FD.
           MOVE HOY-HHHY TO WSS-GLS-M1HH.
           MOVE HOY-MMHY TO WSS-GLS-M1HM.
           MOVE HOY-SSHY TO WSS-GLS-M1HS.
           MOVE WSS-GLS-MEN1 TO FRM-MENS.
       FIN-PUT-MEN1.
           EXIT.

      *OGB-INI 13-ENE-2017 BALANCE OPTIMO DAP
       COPY DAPBGPPD.
       COPY TABBKRCC.
       COPY MC2BFPPD.

       COPY DAPBFCPD.

       USPC107 SECTION.
       INI-USPC107.
       FIN-USPC107.
           EXIT.
      *OGB-FIN 13-ENE-2017 BALANCE OPTIMO DAP
      *>>>> EOF_PU
*% END
