*%! Codigo adicional para DAPPAVD2
*% IF SETTAG
*% FNCPQ = "080804"
*% VSNPQ = "08.11.24"
*% FNCPU = "080804"
*% VSNPU = "08.11.24"
*% END
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF WSS
      *<<<< WSS
       01  PGM-STAT-PGM.
              05 PGM-STAT-RCC.
                 88 PGM-STAT-RCC-NUL    VALUE '  '.
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCC-OKS VALUE '0'.
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY DAPWXVD2.
       COPY DAPBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY DAPBROPD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY DAPBRRCC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.

       77  WSS-SGV-VCAM-0993  VALUE ZEROES COMP-3    PIC S9(11)V9(4).
       77  WSS-SGV-VCAM-0998  VALUE ZEROES COMP-3    PIC S9(11)V9(4).
       77  WSS-SGV-VCAM-1013  VALUE ZEROES COMP-3    PIC S9(11)V9(4).
       77  WSS-SGV-VCAM-1082  VALUE ZEROES COMP-3    PIC S9(11)V9(4).
       77  WSS-SGV-VCAM-1142  VALUE ZEROES COMP-3    PIC S9(11)V9(4).

       77  WSS-CTE-IXG-0999            VALUE  1 PIC 9(02).
       77  WSS-CTE-IXV-0999-0999       VALUE  1 PIC 9(02).

       77  WSS-CTE-IXG-0998            VALUE  2 PIC 9(02).
       77  WSS-CTE-IXV-0998-0998       VALUE  3 PIC 9(02).
       77  WSS-CTE-IXV-0998-0999       VALUE  4 PIC 9(02).

       77  WSS-CTE-IXG-0993            VALUE  3 PIC 9(02).
       77  WSS-CTE-IXV-0993-0993       VALUE  5 PIC 9(02).
       77  WSS-CTE-IXV-0993-0999       VALUE  6 PIC 9(02).

       77  WSS-CTE-IXG-1013            VALUE  4 PIC 9(02).
       77  WSS-CTE-IXV-1013-1013       VALUE  7 PIC 9(02).
       77  WSS-CTE-IXV-1013-0999       VALUE  8 PIC 9(02).

       77  WSS-CTE-IXG-1142            VALUE  5 PIC 9(02).
       77  WSS-CTE-IXV-1142-1142       VALUE  9 PIC 9(02).
       77  WSS-CTE-IXV-1142-0999       VALUE 10 PIC 9(02).

       77  WSS-CTE-IXG-1082            VALUE  6 PIC 9(02).
       77  WSS-CTE-IXV-1082-1082       VALUE 11 PIC 9(02).
       77  WSS-CTE-IXV-1082-0999       VALUE 12 PIC 9(02).

       77  WSS-CTE-MAX-MTR-MON        VALUE   12  PIC 9(03).
       01  WSS-MTR-MON.
           03  WSS-VEC-MON.
               05 WSS-VEC-MON-ELM      OCCURS 12 TIMES.
                  07 WSS-MTR-GCAM      PIC X(12).
                  07 WSS-MTR-VCAM      PIC X(06).
                  07 WSS-MTR-MONE      PIC X(06).
                  07 WSS-MTR-TOTO      PIC 9(05).
                  07 WSS-MTR-TOTM      PIC 9999999999999V9999.
                  07 WSS-MTR-TOTP      PIC 9999999999999V9999.

       77  WSS-VD2-NUM-CORR VALUE ZEROES PIC 9(05).
       77  WSS-AKEY  VALUE 'KEY-NUL'        PIC X(32).
       77  WSS-OFIO  VALUE SPACES           PIC X(03).
       77  WSS-FST-LEC VALUE 'N'            PIC X(01).
      * FECHA DESDE HATTA DE PANTALLA PARA COMPARAR
       01  WSS-FEC-FRM.
           05 WSS-FRM-FEC-FINI.
              07 WSS-FRM-NUM-SINI           PIC 9(02).
              07 WSS-FRM-NUM-AINI           PIC 9(02).
              07 WSS-FRM-NUM-MINI           PIC 9(02).
              07 WSS-FRM-NUM-DINI           PIC 9(02).

           05 WSS-FRM-FEC-FTER.
              07 WSS-FRM-NUM-STER           PIC 9(02).
              07 WSS-FRM-NUM-ATER           PIC 9(02).
              07 WSS-FRM-NUM-MTER           PIC 9(02).
              07 WSS-FRM-NUM-DTER           PIC 9(02).
      *>>>> WSS
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *>>>> WSS_DTC
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF    TO VX2-COD-TERM
           ELSE
                MOVE EIBTRMID        TO VX2-COD-TERM.

      *>>>> INI_FIO
*% END
*% IF SCR_GKEY_VAL_IKY OR SCR_GIKY_VAL_IKY OR FIN_GET_CON OR SCR_GFLD_VAL_MKY OR FIN_GET_ACC OR FIN_GET_CON OR FIN_SCR_GCNF
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE '0999  ' TO 
                 WSS-MTR-VCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0999 ).
           MOVE '$     ' TO
                 WSS-MTR-MONE  IN WSS-MTR-MON ( WSS-CTE-IXG-0999 ).
           MOVE 'TAB' TO FIO-SIST TAB-COD-SIST.
           MOVE 'VLR'    TO TAB-COD-TTAB IN TAB.
           MOVE '0999  ' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO 
                 WSS-MTR-GCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0999 ).

           MOVE '0998  ' TO
                 WSS-MTR-VCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0998 ).
           MOVE 'UF    ' TO
                 WSS-MTR-MONE  IN WSS-MTR-MON ( WSS-CTE-IXG-0998 ).
           MOVE 'TAB' TO FIO-SIST TAB-COD-SIST.
           MOVE 'VLR'    TO TAB-COD-TTAB IN TAB.
           MOVE '0998  ' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO 
                 WSS-MTR-GCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0998 ).

           MOVE '0993  ' TO
                 WSS-MTR-VCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0993 ).
           MOVE 'ICP   ' TO
                 WSS-MTR-MONE  IN WSS-MTR-MON ( WSS-CTE-IXG-0993 ).
           MOVE 'TAB' TO FIO-SIST TAB-COD-SIST.
           MOVE 'VLR'    TO TAB-COD-TTAB IN TAB.
           MOVE '0993  ' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO 
                 WSS-MTR-GCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-0993 ).

           MOVE '1013  ' TO
                 WSS-MTR-VCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-1013 ).
           MOVE 'US$   ' TO
                 WSS-MTR-MONE  IN WSS-MTR-MON ( WSS-CTE-IXG-1013 ).
           MOVE 'TAB' TO FIO-SIST TAB-COD-SIST.
           MOVE 'VLR'    TO TAB-COD-TTAB IN TAB.
           MOVE '1013  ' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO 
                 WSS-MTR-GCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-1013 ).

           MOVE '1142  ' TO
                 WSS-MTR-VCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-1142 ).
           MOVE 'E     ' TO
                 WSS-MTR-MONE  IN WSS-MTR-MON ( WSS-CTE-IXG-1142 ).
           MOVE 'TAB' TO FIO-SIST TAB-COD-SIST.
           MOVE 'VLR'    TO TAB-COD-TTAB IN TAB.
           MOVE '1142  ' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO 
                 WSS-MTR-GCAM  IN WSS-MTR-MON ( WSS-CTE-IXG-1142 ).

           PERFORM CLR-TOT VARYING FRM-IFLD FROM 1 BY 1 UNTIL 
                                   FRM-IFLD > WSS-CTE-MAX-MTR-MON.

           MOVE VX2-NOM-TSVD2 TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE FRM-NUM-DCAM IN VD2-FLD TO CAM-NUM-DCAM IN CAM(01).
           MOVE FRM-NUM-MCAM IN VD2-FLD TO CAM-NUM-MCAM IN CAM(01).
           MOVE FRM-NUM-SCAM IN VD2-FLD TO CAM-NUM-SCAM IN CAM(01).
           MOVE FRM-NUM-ACAM IN VD2-FLD TO CAM-NUM-ACAM IN CAM(01).

           MOVE FRM-NUM-DCAM IN VD2-FLD TO CAM-NUM-DCAM IN CAM(02).
           MOVE FRM-NUM-MCAM IN VD2-FLD TO CAM-NUM-MCAM IN CAM(02).
           MOVE FRM-NUM-SCAM IN VD2-FLD TO CAM-NUM-SCAM IN CAM(02).
           MOVE FRM-NUM-ACAM IN VD2-FLD TO CAM-NUM-ACAM IN CAM(02).

           MOVE '0998'       TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999'       TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND
                    CAM-IND-VIGE = 'S' )
              MOVE ZEROES TO WSS-SGV-VCAM-0998
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-0998.

           MOVE '0993'       TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999'       TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND
                    CAM-IND-VIGE = 'S' )
              MOVE ZEROES TO WSS-SGV-VCAM-0993
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-0993.

           MOVE '101301'     TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999'       TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND
                    CAM-IND-VIGE = 'S' )
              MOVE ZEROES TO WSS-SGV-VCAM-1013
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-1013.

           MOVE '108201'     TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999'       TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND
                    CAM-IND-VIGE NOT = 'S' )
              MOVE ZEROES TO WSS-SGV-VCAM-1082
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-1082.

           MOVE '114101'     TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999'       TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND
                    CAM-IND-VIGE = 'S' )
              MOVE ZEROES TO WSS-SGV-VCAM-1142
           ELSE
              MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-1142.
      
           MOVE SPACES TO RCC.
           MOVE DBC-CIC-ICLI IN DBC TO RCC-CIC-ICLI IN RCC.

           MOVE 'OPD-INI' TO QUE-COLA.
           MOVE 1 TO QUE-NITM.
           MOVE +12 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO RCC-CIC-IOPD IN RCC.

           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'S' TO WSS-FST-LEC.
      
       CIC-RCC.
           PERFORM DAP-FIO-RCC.

           MOVE 'CIC-RCC' TO QUE-COLA.
           MOVE +24 TO QUE-LITM.
           MOVE RCC-KEY-IRCC TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF NOT FIO-STAT-OKS AND
              WSS-FST-LEC = 'S'
               MOVE '23' TO FIO-STAT
               MOVE FIO-STAT TO PGM-STAT-RCC
               GO TO FIN-FND-KEY.

           IF RCC-CIC-ICLI IN RCC NOT = DBC-CIC-ICLI IN DBC AND
              WSS-FST-LEC = 'S'
                 MOVE '23' TO FIO-STAT
                 MOVE FIO-STAT TO PGM-STAT-RCC
      *           MOVE 'DAP' TO MSG-COD-SIST
      *           MOVE 'VD2RCCNONXT' TO MSG-COD-MENS
      *           PERFORM GET-MSG
      *           MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO FIN-FND-KEY.

           IF RCC-CIC-ICLI IN RCC NOT = DBC-CIC-ICLI IN DBC
                 MOVE '00' TO FIO-STAT
                 MOVE FIO-STAT TO PGM-STAT-RCC
      *           MOVE 'DAP' TO MSG-COD-SIST
      *           MOVE 'VD2RCCNONXT' TO MSG-COD-MENS
      *           PERFORM GET-MSG
      *           MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO NOT-FND-KEY.

           MOVE RCC-CIC-IOPD IN RCC TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF OPD-COD-STAT IN OPD NOT = 'G'
                 MOVE 'OPDNOG' TO QUE-COLA
                 MOVE +24 TO QUE-LITM
                 MOVE OPD-CIC-IOPD TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNX-PRO-QUE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-RCC.

           MOVE RCC-CIC-IOPD IN RCC TO VEN-CIC-IOPD IN VEN.
           MOVE 1                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
                 MOVE 'VENNEX' TO QUE-COLA
                 MOVE +24 TO QUE-LITM
                 MOVE OPD-CIC-IOPD TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNX-PRO-QUE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-RCC.

           IF VEN-FEC-FVEN IN VEN < WSS-FRM-FEC-FINI OR
              VEN-FEC-FVEN IN VEN > WSS-FRM-FEC-FTER
                 MOVE 'VENFECRG' TO QUE-COLA
                 MOVE +24 TO QUE-LITM
                 MOVE OPD-CIC-IOPD TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNX-PRO-QUE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-RCC.

           PERFORM PRO-OPD-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND
           GO TO CIC-RCC.

       NOT-FND-KEY.
      
      
      *>>>> FND_KEY
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      *>>>> FIN_FND_KEY
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR

           IF SCR-CMND NOT = 'CON'
                GO TO END-PUT-SCR.

           MOVE 'TMON0999' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-0999 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 ).

           MOVE 'TMON0993' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-0993 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MULTIPLY 
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          BY
                                    WSS-SGV-VCAM-0993
                          GIVING
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )

                      MOVE WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO  WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 ).

           MOVE 'TMON0998' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-0998 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MULTIPLY 
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          BY
                                    WSS-SGV-VCAM-0998
                          GIVING
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )

                      MOVE WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO  WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 ).


           MOVE 'TMOM1013' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-1013 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE ZEROES
                          TO
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 ).

           MOVE 'TMON1082' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-1082 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE ZEROES
                          TO
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 ).

           MOVE 'TMON1142' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE WSS-CTE-IXG-1142 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE ZEROES
                          TO
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 ).


           MOVE 'TOTO0999' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-0999 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-0999 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-0999 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-0999 ).


           MOVE 'TOTO0993' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-0993 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-0993 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-0993 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-0993 ).


           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-0998 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-0998 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-0998 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-0998 ).


           MOVE 'TOTO1013' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                          TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-1013 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-1013 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-1013 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-1013 ).



           MOVE 'TOTO1082' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                          TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-1082 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-1082 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-1082 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-1082 ).



           MOVE 'TOTO1142' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                          TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE
                      WSS-MTR-TOTO IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                          TO
                      FRM-NUM-TOTO IN 
                      VD2-FLD     ( WSS-CTE-IXG-1142 ).
           MOVE
                      WSS-MTR-GCAM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                          TO
                      FRM-GLS-TOTA IN 
                      VD2-FLD     ( WSS-CTE-IXG-1142 ).

           MOVE
                      WSS-MTR-TOTM IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                          TO
                      FRM-VAL-MONE IN 
                      VD2-FLD     ( WSS-CTE-IXG-1142 ).

           MOVE
                      WSS-MTR-TOTP IN 
                      WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                          TO
                      FRM-VAL-0999 IN 
                      VD2-FLD     ( WSS-CTE-IXG-1142 ).


       EXT-PUT-SCR.

           IF VX2-PUT-QUE = 'S'
               PERFORM PUT-TS-VX2.

       END-PUT-SCR.

      *>>>> FIN_PUT_SCR
*% END
*% IF FIO
      *<<<< FIO
      *COPY DAPBFVD2.
      *COPY DAPIOVD2.
      *>>>> FIO
*% END
*% IF EOF
      *<<<< EOF
      *>>>> EOF
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBGPES.
       COPY DAPBFVEN.
       COPY DAPBFOPD.
       COPY DAPBFRCC.
       COPY TABBFCAM.
       COPY GNSBBTAB.

       PRO-OPD-VEN SECTION.
       INI-PRO-OPD-VEN.
           MOVE 'N' TO WSS-FST-LEC.
           MOVE 'OPDVEN' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE OPD-CIC-IOPD IN OPD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           ADD 1 TO VX2-IDX-VX2-OCC.

           MOVE 'IDXVD2_1' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VX2-IDX-VX2-OCC TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE OPD-NUM-DREA IN OPD TO VX2-NUM-DCAP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-NUM-MREA IN OPD TO VX2-NUM-MCAP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-NUM-SREA IN OPD TO VX2-NUM-SCAP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-NUM-AREA IN OPD TO VX2-NUM-ACAP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_2' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE OPD-FEC-FREA IN OPD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE VEN-NUM-DVEN IN VEN TO VX2-NUM-DVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE VEN-NUM-MVEN IN VEN TO VX2-NUM-MVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE VEN-NUM-SVEN IN VEN TO VX2-NUM-SVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE VEN-NUM-AVEN IN VEN TO VX2-NUM-AVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_3' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VEN-FEC-FVEN IN VEN TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
           ELSE
           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
           ELSE
           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
           ELSE
           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
           ELSE
           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
           ELSE
           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                 MOVE WSS-MTR-GCAM IN WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                 TO VX2-GLS-MONE
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_4' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE OPD-COD-VCAM IN OPD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE OPD-NUM-PVEN IN OPD TO VX2-NUM-PVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-IND-PVEN IN OPD TO VX2-IND-PVEN
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE OPD-SGV-TINT IN OPD TO VX2-SGV-TINT
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_5' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE OPD-SGV-TINT IN OPD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE OPD-COD-GARA IN OPD TO VX2-COD-GARA
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-COD-CUST IN OPD TO VX2-COD-CUST
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-CAI-IOPD IN OPD TO VX2-CAI-IOPD
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-IIC-IOPD IN OPD TO VX2-IIC-IOPD
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-CAI-ISER IN OPD TO VX2-CAI-ISER
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).
           MOVE OPD-IIC-ISER IN OPD TO VX2-IIC-ISER
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_6' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE OPD-CIC-IOPD IN OPD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE VEN-VAL-FINA IN VEN TO VX2-VAL-FINA
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           MOVE 'IDXVD2_7' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VEN-VAL-FINA IN VEN TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE ZEROES TO VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).

           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                MOVE VX2-VAL-FINA IN
                     VX2-MTI-VARI(VX2-IDX-VX2-OCC)
                  TO VX2-VAL-FINP IN
                     VX2-MTI-VARI(VX2-IDX-VX2-OCC).


           MOVE 'IDXVD2_8' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VEN-VAL-FINA IN VEN TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0998 )
           MULTIPLY 
                      VEN-VAL-FINA IN VEN
                          BY
                                    WSS-SGV-VCAM-0998
                          GIVING
                                    VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)

                              MOVE VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
                          TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO  
                              VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).


           MOVE 'IDXVD2_9' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VEN-VAL-FINA IN VEN TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF OPD-COD-VCAM IN OPD = 
              WSS-MTR-VCAM IN WSS-MTR-MON ( WSS-CTE-IXG-0993 )
           MULTIPLY 
                      VX2-VAL-FINA IN
                      VX2-MTI-VARI(VX2-IDX-VX2-OCC)
                          BY
                                    WSS-SGV-VCAM-0993
                          GIVING
                                    VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
                              MOVE VX2-VAL-FINP

                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC)
                          TO PES-SGV-DECI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE TO  
                              VX2-VAL-FINP
                 IN VX2-MTI-VARI(VX2-IDX-VX2-OCC).


           MOVE 'IDXVD2_A' TO QUE-COLA.
           MOVE +12 TO QUE-LITM.
           MOVE VEN-VAL-FINA IN VEN TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'S' TO VX2-PUT-QUE.

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0999 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0999 ).

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0993 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0993 ).

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0998 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-0998 ).

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1013 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1013 ).

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1082 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1082 ).

           IF OPD-COD-VCAM IN OPD = WSS-MTR-VCAM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                  ADD 1 TO          WSS-MTR-TOTO IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1142 )
                  ADD VEN-VAL-FINA IN VEN TO 
                                    WSS-MTR-TOTM IN 
                                    WSS-MTR-MON ( WSS-CTE-IXG-1142 ).

           IF VX2-IDX-VX2-OCC = VX2-TOT-VX2-OCC
                MOVE ZEROES TO VX2-IDX-VX2-OCC
                 PERFORM PUT-TS-VX2.

       FIN-PRO-OPD-VEN.
           EXIT.


       CLR-TOT SECTION.
       INI-CLR-TOT.
           MOVE ZEROES TO 
                  WSS-MTR-TOTO IN WSS-MTR-MON ( FRM-IFLD )
                  WSS-MTR-TOTM IN WSS-MTR-MON ( FRM-IFLD )
                  WSS-MTR-TOTP IN WSS-MTR-MON ( FRM-IFLD ).
       FIN-CLR-TOT.
           EXIT.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
      *    PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.


       PUT-TS-VX2 SECTION.
       INI-PUT-TS-VX2.
            MOVE DBC-NUM-ICLI IN VD2-FLD TO VX2-MTI-NUM-ICLI.
            MOVE DBC-IND-ICLI IN VD2-FLD TO VX2-MTI-IND-ICLI.
            MOVE DBC-GLS-ICLI IN VD2-FLD TO VX2-MTI-GLS-ICLI.

            MOVE VX2-TSVD2 TO QUE-COLA.
            MOVE VX2-LEN-TSVX2  TO QUE-LITM.
            MOVE VX2-MTI-VARI   TO QUE-ITEM.
            MOVE QUE-PUT TO QUE-CMND.
            PERFORM GNS-PRO-QUE.
            MOVE SPACES TO VX2-MTI-VARI.
            MOVE 'N' TO VX2-PUT-QUE.
       FIN-PUT-TS-VX2.
           EXIT.

      *>>>> EOF_PQ
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
      *>>>> CMN_MOD
*% END
