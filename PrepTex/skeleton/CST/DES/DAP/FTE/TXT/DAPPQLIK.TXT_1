*% IF PGM_PQ
*% IF EOF
      *<<<< EOF
       COPY DAPBFLAD.
       COPY DAPBFRCC.
       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE LIQ-CIC-IOPD IN LIQ TO RCC-CIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                  LIQ-CIC-IOPD IN LIQ = RCC-CIC-IOPD IN RCC)
                  MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT ( FIO-STAT-OKS AND
                     LIQ-CIC-IOPD IN LIQ = RCC-CIC-IOPD IN RCC  )
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-NXT-RCC.
           EXIT.

      *>>>>
*% END
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>> INI_FIO
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
              05 PGM-STAT-RCC.
                 88 PGM-STAT-RCC-NUL    VALUE '  '.
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCC-OKS VALUE '0'.
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).
      *>>>> FIN_PGM_STAT
*% END
*% IF WSS
      *<<<< WSS                                                         
       77  WSS-COD-ENTI         VALUE 'LIQ'     PIC X(03).
       COPY  DAPBRLAD.
       COPY  DAPBRRCC.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *>>>>                                                             
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET LAD ODC XON-INI
            PERFORM PRO-MOD-ANT-REG-LAD.
      *>>>> CMN_MOD_RET LAD ODC XON-FIN
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD LAD ODC XON-INI
            PERFORM PRO-MOD-DES-REG-LAD.
      *>>>> FIN_CMN_MOD LAD ODC XON-FIN
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING LAD ODC XON-INI
            PERFORM PRO-ING-REG-LAD.
      *>>>> FIN_CMN_ING LAD ODC XON-FIN
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI LAD ODC XON-INI
            PERFORM PRO-ELI-REG-LAD.
      *>>>> FIN_CMN_ELI LAD ODC XON-FIN
*% END
*% IF PGM_PU
*% IF EOF
      *<<<< EOF
       COPY DAPBFLAD.
       COPY DAPBFRCC.
       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE LIQ-CIC-IOPD IN LIQ TO RCC-CIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (FIO-STAT-OKS AND
                  LIQ-CIC-IOPD IN LIQ = RCC-CIC-IOPD IN RCC)
                  MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT ( FIO-STAT-OKS AND
                     LIQ-CIC-IOPD IN LIQ = RCC-CIC-IOPD IN RCC  )
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-RCC.
       FIN-GET-NXT-RCC.
           EXIT.

       PRO-MOD-ANT-REG-LAD  SECTION.
       INI-MOD-ANT-REG-LAD.
      *-----------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'MOD'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'M'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'ANT'                   TO  LAD-COD-INST IN LAD.
           MOVE     1                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.
           PERFORM PRO-GRABA-REG-LAD.       
       FIN-MOD-ANT-REG-LAD.
            EXIT.

       PRO-MOD-DES-REG-LAD  SECTION.
       INI-MOD-DES-REG-LAD.
      *-----------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'MOD'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'M'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'DES'                   TO  LAD-COD-INST IN LAD.
           MOVE     2                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.
           PERFORM PRO-GRABA-REG-LAD.
       FIN-MOD-DES-REG-LAD.
           EXIT.
      *
       PRO-ING-REG-LAD  SECTION.
       INI-ING-REG-LAD.
      *-------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'ING'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'I'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'N/A'                   TO  LAD-COD-INST IN LAD.

           MOVE     1                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.

           PERFORM PRO-GRABA-REG-LAD.
       FIN-ING-REG-LAD.
           EXIT.
      *
       PRO-ELI-REG-LAD  SECTION.
       INI-ELI-REG-LAD.
      *-------------------------
           MOVE   SPACES                  TO  LAD.
           MOVE   'ELI'                   TO  LAD-COD-EVEN IN LAD.
           MOVE   'E'                     TO  LAD-COD-TACC IN LAD
                                              LAD-COD-STAT IN LAD.
           MOVE   'N/A'                   TO  LAD-COD-INST IN LAD.

           MOVE     1                     TO  LAD-NUM-CLAD IN LAD
                                              LAD-NUM-COPD IN LAD
                                              LAD-NUM-CCLI IN LAD
                                              LAD-NUM-CAUT IN LAD.
           PERFORM PRO-GRABA-REG-LAD.
       FIN-ELI-REG-LAD.
           EXIT.
      *
       PRO-GRABA-REG-LAD  SECTION.
      *---------------------------
       INI-GRABA-REG-LAD.
           MOVE   '1.0'                   TO  LAD-COD-VERS IN LAD.
           MOVE   'LIQ'                   TO  LAD-COD-ENTF IN LAD
                                              LAD-COD-ENTO IN LAD
                                              LAD-COD-ENTC IN LAD
                                              LAD-COD-ENTA IN LAD
                                              LAD-COD-ENTI IN LAD.

           MOVE    HOY-FHOY               TO  LAD-FEC-FTRN IN LAD
                                              LAD-FEC-FLAD IN LAD
                                              LAD-FEC-FOPD IN LAD
                                              LAD-FEC-FCLI IN LAD
                                              LAD-FEC-FAUT IN LAD.

           MOVE    HOY-HHOY               TO  LAD-HRA-HRTR IN LAD
                                              LAD-HRA-HLAD IN LAD
                                              LAD-HRA-HOPD IN LAD
                                              LAD-HRA-HCLI IN LAD
                                              LAD-HRA-HAUT IN LAD.
             
           MOVE  LIQ-CIC-IOPD IN LIQ      TO  LAD-CIC-IOPD IN LAD.

           MOVE  EIBTRMID                 TO  LAD-COD-OTRN IN LAD.
           MOVE  SCR-USER                 TO  LAD-COD-ATRN IN LAD
                                              LAD-COD-AUTO IN LAD.
           MOVE  EIBTRNID                 TO  LAD-COD-TCIC IN LAD.
           MOVE  SCR-CMND                 TO  LAD-COD-CMND IN LAD.
           MOVE  LAD-COD-COME IN LIK-FLD  TO  LAD-COD-COME IN LAD.

           IF LIQ-SGV-MCAS IN LIQ IS NOT NUMERIC
              MOVE ZEROES TO LIQ-SGV-MCAS IN LIQ.
           MOVE  LIQ                      TO  LAD-COD-CONT IN LAD.

           PERFORM GET-CUR-RCC.
           IF PGM-STAT-RCC-OKS
                MOVE    RCC-CIC-ICLI IN RCC    TO  LAD-CIC-ICLI IN LAD.
           MOVE    FIO-PUT                TO  FIO-CMND.
           PERFORM DAP-FIO-LAD.

           IF PGM-STAT-RCC-OKS
               PERFORM GET-NXT-RCC
               IF PGM-STAT-RCC-OKS
                   ADD          1    TO    LAD-NUM-CLAD IN LAD
                                           LAD-NUM-COPD IN LAD
                                           LAD-NUM-CCLI IN LAD
                                           LAD-NUM-CAUT IN LAD
                    MOVE    RCC-CIC-ICLI IN RCC TO
                                           LAD-CIC-ICLI IN LAD
                    MOVE    FIO-PUT   TO    FIO-CMND
                    PERFORM DAP-FIO-LAD.
           IF NOT PGM-STAT-RCC-OKS
               MOVE   SPACES  TO  FIO-STAT.
       FIN-GRABA-REG-LAD.
           EXIT.
      *>>>>
*% END
*% END
