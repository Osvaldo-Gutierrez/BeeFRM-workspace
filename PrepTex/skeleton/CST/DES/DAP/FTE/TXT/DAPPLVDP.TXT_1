*%! Codigo adicional para archivo VDP
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.

      *Entidades de TAB
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.

      *Entidades de DAP
       COPY DAPBROPD.
       COPY DAPBRRCC.

      *Entidades de SGC
       COPY SGCBRDBC.
       COPY SGCBRRCD.

       01  WSS-VARI.
             03  WSS-GLS-DEST.
               05  WSS-GLS-DES1                      PIC X(20).
               05  WSS-GLS-DES2                      PIC X(20).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FFIN.
               05  WSS-NUM-DFIN                      PIC 9(02).
               05  WSS-NUM-MFIN                      PIC 9(02).
               05  WSS-NUM-SFIN                      PIC 9(02).
               05  WSS-NUM-AFIN                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-DTER                      PIC 9(02).
           03  WSS-FEC-FVEN.
               05  WSS-NUM-SVEN                      PIC 9(02).
               05  WSS-NUM-AVEN                      PIC 9(02).
               05  WSS-NUM-MVEN                      PIC 9(02).
               05  WSS-NUM-DVEN                      PIC 9(02).
           03  WSS-IND-TOPE                          PIC X(01).
           03  WSS-COD-EJEC                          PIC X(12).
           03  WSS-COD-OFIC                          PIC X(03).
           03  WSS-COD-VCAM                          PIC X(06).
           03  WSS-NUM-TOTO          VALUE ZEROES    PIC 9(05).
           03  WSS-NUM-TOTM          VALUE ZEROES    PIC 9(05).
           03  WSS-NUM-TOTF          VALUE ZEROES    PIC 9(05).
           03  WSS-STAT-OPD          VALUE ZEROES    PIC 9(01).
           03  WSS-STAT-RCC          VALUE ZEROES    PIC 9(01).
           03  WSS-IND-MCLI          VALUE SPACES    PIC X(01).
           03  WSS-COD-0999           VALUE '0999  '  PIC X(06).
           03  WSS-COD-0998           VALUE '0998  '  PIC X(06).
           03  WSS-VALOR-PESOS                        PIC 9(13).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *Entidades de DAP
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCC-REQA==.
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF INI
      *<<<< INI
      * Captura parametros
           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA PARAMETROS '.
           DISPLAY ' '.
           DISPLAY 'INGRESE TOPE S/N ? : '.
           ACCEPT WSS-IND-TOPE IN WSS-VARI.
           DISPLAY WSS-IND-TOPE IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA INICIAL (DDMMSSAA) : '.
           ACCEPT WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.

           DISPLAY 'INGRESE FECHA FINAL   (DDMMSSAA) : '.
           ACCEPT WSS-FEC-FFIN IN WSS-VARI.
           DISPLAY WSS-FEC-FFIN IN WSS-VARI.
           DISPLAY 'FIN CAPTURA PARAMETROS '.

           DISPLAY 'INGRESE COD. EJECUTIVO (X(12)/*) : '.
           ACCEPT  WSS-COD-EJEC IN WSS-VARI.
           DISPLAY WSS-COD-EJEC IN WSS-VARI.

           DISPLAY 'INGRESE COD. DE OFICINA  (XXX/*) : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           DISPLAY 'INGRESE COD. DE MONEDA (X(06)/*) : '.
           ACCEPT  WSS-COD-VCAM IN WSS-VARI.
           DISPLAY WSS-COD-VCAM IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION PARAMETROS '.
           DISPLAY ' '.

      *VAL-FEC Valida Fecha de Inicio
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE INICIO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.
 
      *VAL-FEC Valida Fecha de Termino
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR VALIDACION EN FECHA DE TERMINO: '
                         WSS-FEC-FINI '  ' FEC-MENS
               PERFORM GNS-PRO-ABT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FFIN IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' FECHA INICIO > FECHA TERMINO: '
                         WSS-FEC-FINI ' > ' WSS-FEC-FFIN
               PERFORM GNS-PRO-ABT.

      *Valida glosa ejecutivo
           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-EJEC IN WSS-VARI TO USR-COD-USER IN USR
              PERFORM VAL-USR
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION EJECUTIVO: ' WSS-COD-EJEC
                  PERFORM GNS-PRO-ABT.

      *VAL-OFI Valida Codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION OFICINA: ' WSS-COD-OFIC
                  PERFORM GNS-PRO-ABT.

      *VAL-TAB Valida Codigo de moneda
           IF WSS-COD-VCAM IN WSS-VARI > SPACES AND
              WSS-COD-VCAM IN WSS-VARI NOT = '*'
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
              MOVE WSS-COD-VCAM IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
               IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' ERROR VALIDACION COD. MONEDA: ' WSS-COD-VCAM
                  PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-VDP.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-VDP.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-VDP.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-VDP.
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DFIN IN WSS-VDP.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MFIN IN WSS-VDP.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-SFIN IN WSS-VDP.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-AFIN IN WSS-VDP. 
           DISPLAY ' '.
           DISPLAY 'FIN VALIDACION PARAMETROS '.
           DISPLAY ' '.
      *>>>>
*% END
*% IF CF_VDP_OPD_COD_COPD
      *<<<< CF_VDP_OPD_COD_COPD
      *Recupera glosa de moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-VCAM IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-VDP.

           MOVE OPD-COD-COPD IN SRT TO OPD-COD-COPD IN OPD.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-TOPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES1 IN WSS-VARI.
      *
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE OPD-COD-COPD IN OPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DES2 IN WSS-VARI.
           MOVE WSS-GLS-DEST TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-DEST.
           MOVE WSS-GLS-DEST IN WSS-VARI TO
                                        WSS-GLS-COPD IN WSS-VDP.
       
           MOVE VEN-FEC-FVEN IN SRT TO WSS-FEC-FVEN IN WSS-VARI.  	
           MOVE WSS-NUM-DVEN IN WSS-VARI TO WSS-NUM-DVEN IN WSS-VDP.	
           MOVE WSS-NUM-MVEN IN WSS-VARI TO WSS-NUM-MVEN IN WSS-VDP.	
           MOVE WSS-NUM-SVEN IN WSS-VARI TO WSS-NUM-SVEN IN WSS-VDP.	
           MOVE WSS-NUM-AVEN IN WSS-VARI TO WSS-NUM-AVEN IN WSS-VDP.
      *>>>>
*% END
*% IF PH_VDP
      *<<<< IF PH_VDP
      *Recupera glosa de oficina
           MOVE OPD-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.

      *Recupera glosa ejecutivo
      *     MOVE SPACES TO WSS-GLS-EJEC IN WSS-VDP.
      *     IF OPD-COD-EJEC IN SRT > SPACES
      *        MOVE OPD-COD-EJEC IN SRT TO USR-COD-USER IN USR
      *        PERFORM BUS-USR
      *        MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-VDP.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *OBT-FEC-HOY Obtiene Fecha Hoy
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DPRO IN WSS-VDP.
           MOVE HOY-MHOY TO WSS-NUM-MPRO IN WSS-VDP.
           MOVE HOY-SHOY TO WSS-NUM-SPRO IN WSS-VDP.
           MOVE HOY-AHOY TO WSS-NUM-APRO IN WSS-VDP.

           MOVE WSS-NUM-DINI IN WSS-VARI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MINI IN WSS-VARI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SINI IN WSS-VARI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-AINI IN WSS-VARI TO VEN-NUM-AVEN IN VEN.
           MOVE WSS-NUM-DFIN IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MFIN IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SFIN IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-AFIN IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY ' PROCESO CANCELADO '
               DISPLAY ' ERROR AL ACCESAR VEN POR VEN-FEC-FVEN : '
                         VEN-FEC-FVEN IN VEN ' FS: ' FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS VEN EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI 
                       ' A    ' WSS-FEC-FFIN IN WSS-VARI
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF VEN-VAL-SFIN IN VEN = ZEROES 
              GO TO NXT-INP-SRT.

           PERFORM GET-OPD-VEN.
           IF WSS-STAT-OPD IN WSS-VARI = 1
              DISPLAY ' ' 
              DISPLAY 'NO EXISTE OPD PARA VEN ' VEN-CIC-IOPD IN VEN
              GO TO NXT-INP-SRT.

           IF OPD-VAL-SCAP IN OPD = ZEROES 
              GO TO NXT-INP-SRT.
 
           IF OPD-COD-STAT IN OPD NOT = 'G'
              GO TO NXT-INP-SRT.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OPD-COD-OFIC IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*'
              IF WSS-COD-EJEC IN WSS-VARI NOT = OPD-COD-EJEC IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-COD-VCAM IN WSS-VARI > SPACES AND
              WSS-COD-VCAM IN WSS-VARI NOT = '*'
              IF WSS-COD-VCAM IN WSS-VARI NOT = OPD-COD-VCAM IN OPD
                 GO TO NXT-INP-SRT.

           IF WSS-IND-TOPE = 'S'
               IF OPD-COD-VCAM IN OPD = '0999  '
      **#             IF VEN-VAL-SCAP IN VEN < 30000000
                   IF VEN-VAL-CAPI IN VEN < 30000000
                        GO TO NXT-INP-SRT
                   ELSE
                        NEXT SENTENCE
               ELSE
               IF OPD-COD-VCAM IN OPD = '0998  '
      **#             IF VEN-VAL-SCAP IN VEN < 2000
                   IF VEN-VAL-CAPI IN VEN < 2000
                        GO TO NXT-INP-SRT
                   ELSE
                        NEXT SENTENCE
               ELSE
      **#         IF OPD-COD-VCAM IN OPD = '1013  '
                   IF VEN-VAL-CAPI IN VEN < 30000
                        GO TO NXT-INP-SRT.

           SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                    GIVING SRT-VAL-INTE IN SRT.
           IF OPD-COD-VCAM IN OPD = '1013  '
                MOVE SRT-VAL-INTE IN SRT TO SRT-VAL-SUMI IN SRT
           ELSE
                MOVE ZEROES TO SRT-VAL-SUMI IN SRT.
           MOVE 1 TO SRT-NUM-NOPD IN SRT.
      *>>>>
*% END
*% IF RM 
      *<<<< RM
           MOVE OPD-CAI-ORIG IN OPD TO OPD-CAI-IOPD IN SRT
                                       VEN-CAI-IOPD IN SRT.
           MOVE OPD-IIC-ORIG IN OPD TO OPD-IIC-IOPD IN SRT
                                       VEN-IIC-IOPD IN SRT.
           MOVE OPD-CIC-ORIG IN OPD TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           MOVE OPD-CAI-ISER IN OPD TO OPD-CAI-ISER IN SRT.
           MOVE OPD-IIC-ISER IN OPD TO OPD-IIC-ISER IN SRT.
      **********************************
      *CPZ 16.08.93 CONVIERTE UF A PESOS
      **********************************
      * OBTIENE VALOR DE CAMBIO DE LA UF A FECHA VENCIMIENTO
           IF OPD-COD-VCAM  IN SRT = '0998  '
              PERFORM TRANSFORM-PESOS.
      **********************************
      *>>>> 
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
      *Ubica registro en VEN por fecha
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
      *Controla ingreso de registros por fecha termino
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FTER IN WSS-VARI
              GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
       TRANSFORM-PESOS.
      *----------------
           MOVE VEN-FEC-FVEN IN SRT      TO CAM-FEC-FCAM IN CAM(1)
           MOVE VEN-FEC-FVEN IN SRT      TO CAM-FEC-FCAM IN CAM(2)
           MOVE WSS-COD-0998             TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-0999             TO CAM-COD-VCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF NOT FIO-STAT-OKS
               DISPLAY ' '
               DISPLAY 'PROCESO CANCELADO ' FIO-STAT
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        VEN-FEC-FVEN IN SRT      ' PARA LA UF.'
               PERFORM GNS-PRO-ABT
           ELSE
              IF CAM-IND-VIGE NOT = 'S'
               DISPLAY ' '
               DISPLAY 'PROCESO CANCELADO ' FIO-STAT
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        VEN-FEC-FVEN IN SRT      ' PARA LA UF.'
               PERFORM GNS-PRO-ABT
               ELSE
                COMPUTE WSS-VALOR-PESOS    =
                CAM-SGV-VCAM  IN CAM *  SRT-VAL-INTE IN SRT
                MOVE WSS-VALOR-PESOS  TO SRT-VAL-INTE IN SRT
                COMPUTE WSS-VALOR-PESOS    =
                CAM-SGV-VCAM  IN CAM *  VEN-VAL-FINA IN SRT
                MOVE WSS-VALOR-PESOS  TO VEN-VAL-FINA IN SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
      *Limpia FIO-AKEY para acceso a otras FIO
           MOVE SPACES TO FIO-AKEY. 
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      * Obtiene Datos desde RCC y RCD para datos clientes en VDP
           PERFORM GET-CUR-RCC.
           IF WSS-STAT-RCC IN WSS-VARI = 1
              PERFORM RST-DBC
              PERFORM RST-RCD
              GENERATE DL-VD1
              GO TO GEN-TOT
           ELSE
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD
              GENERATE DL-VD1.
           
       CIC-RCC.
           PERFORM GET-NXT-RCC
           IF WSS-IND-MCLI IN WSS-VARI = 'M'
              PERFORM GET-RCC-DBC
              PERFORM GET-RCC-RCD
              GENERATE DL-VD1
              GO TO CIC-RCC.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
       GEN-TOT.
      * Acumula numero de operaciones y totales.
           ADD SRT-NUM-NOPD IN SRT TO WSS-NUM-TOTF IN WSS-VARI.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       GET-OPD-VEN SECTION.
       INI-GET-OPD-VEN.
           MOVE 0 TO WSS-STAT-OPD IN WSS-VARI.
           MOVE VEN-CIC-IOPD IN VEN TO OPD-CIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-OPD IN WSS-VARI.
       FIN-GET-OPD-VEN.
           EXIT.

       GET-CUR-RCC SECTION.
       INI-GET-CUR-RCC.
           MOVE 0  TO WSS-STAT-RCC IN WSS-VARI.
           MOVE OPD-CAI-IOPD IN SRT TO RCC-CAI-IOPD IN RCC.
           MOVE OPD-IIC-IOPD IN SRT TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT FIO-STAT-OKS
              MOVE 1 TO WSS-STAT-RCC IN WSS-VARI.
       FIN-GET-CUR-RCC.
           EXIT.

       GET-NXT-RCC SECTION.
       INI-GET-NXT-RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF FIO-STAT-OKS AND
              OPD-CAI-IOPD IN SRT = RCC-CAI-IOPD IN RCC AND
              OPD-IIC-IOPD IN SRT = RCC-IIC-IOPD IN RCC
                MOVE 'M'    TO WSS-IND-MCLI IN WSS-VARI
           ELSE
                MOVE SPACES TO WSS-IND-MCLI IN WSS-VARI.
       FIN-GET-NXT-RCC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RCC-DBC SECTION.
       INI-GET-RCC-DBC.
           MOVE RCC-CIC-ICLI IN RCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC. 
       FIN-GET-RCC-DBC.
           EXIT.

      * Limpia datos cliente desde DBC
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

      * Lee con CIC CLIENTE archivo RCD
       GET-RCC-RCD SECTION.
       INI-GET-RCC-RCD.
           MOVE RCC-CIC-ICLI IN RCC TO RCD-CIC-ICLI IN RCD.
           MOVE RCC-NUM-DIRE IN RCC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              PERFORM RST-RCD.
       FIN-GET-RCC-RCD.
           EXIT.

      * Limpia datos cliente desde RDC
       RST-RCD SECTION.
       INI-RST-RCD.
           MOVE 'FONO INEXIS' TO RCD-GLS-FONO IN RCD.
           MOVE 'DIRECCION INEXISTENTE' TO RCD-GLS-DIRE IN RCD.
       FIN-RST-RCD.
           EXIT.

      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGCPT.

      *Entidades  de TAB
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVUSR.

      *Entidades  de DAP
       COPY DAPBFRCC.
       COPY DAPBFOPD.

      *Entidades  de SGC
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>
*% END
