*%! Codigo adicional para archivo ADM
*%  IF CMT_ID
      * ==>>  13-APR-1993 13:21:22 
      *       EMISION SOLO PARA OFICINAS DE TAB-OFI
*% END
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY GNSWVVRF.
       COPY GNSWCVRF.

       01  WSS-VARI.
           03  WSS-COD-OFIC              PIC X(03).
           03  WSS-NUM-OPER              PIC 9(04).
           03  WSS-COD-OPER              PIC X(12).
           03  WSS-I        VALUE ZEROES PIC 9(04).
           03  WSS-SW-MAL   VALUE ZEROES PIC 9(02).
           03  WSS-COD-OPEM.
               05  WSS-COD-TCIC VALUE SPACES PIC X(01).
               05  WSS-COD-CCIC VALUE ZEROES PIC 9(03).
               05  WSS-COD-ICIC VALUE ZEROES PIC 9(08).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *>>>>
*% END
*% IF PH_ADM
      *<<<< IF PH_ADM
      *Recupera glosa de oficina
           MOVE OFI-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-ADM.
      *>>>>
*% END
*% IF INI
      *<<<< INI
           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA PARAMETROS'.
           DISPLAY ' '.
      * Captura codigo de oficina
           DISPLAY 'INGRESE COD. OFICINA (*/XXX) : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           IF WSS-COD-OFIC IN WSS-VARI NOT > SPACES
                 MOVE '*  ' TO WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

      * Captura nro. operaciones a generar
           DISPLAY 'INGRESE TOTAL OPERACIONES (9999) : '.
           ACCEPT  WSS-NUM-OPER IN WSS-VARI.
           DISPLAY WSS-NUM-OPER IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION PARAMETROS'.
           DISPLAY ' '.

      *VAL-OFI Valida Codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
                MOVE 'TAB' TO TAB-COD-SIST
                MOVE 'OFI'                    TO TAB-COD-TTAB IN TAB
                MOVE WSS-COD-OFIC IN WSS-VARI TO TAB-COD-CTAB IN TAB
                PERFORM VAL-TAB
                IF MSG-COD-MENS > SPACES
                    DISPLAY ' '
                    DISPLAY ' PROCESO CANCELADO '
                    DISPLAY WSS-COD-OFIC IN WSS-VARI '  '
                            MSG-GLS-DESC
                    PERFORM GNS-PRO-ABT.

      *Valida Nro. operaciones ingresadas
           IF WSS-NUM-OPER IN WSS-VARI < SPACES OR
              WSS-NUM-OPER IN WSS-VARI NOT NUMERIC
              IF MSG-GLS-MENS = 'COD    NEX'
                  DISPLAY ' '
                  DISPLAY ' PROCESO CANCELADO '
                  DISPLAY ' NRO. OPERACIONES INGRESADA ERRONEA: '
                                      WSS-NUM-OPER IN WSS-VARI
                  PERFORM GNS-PRO-ABT.
           DISPLAY ' '.
           DISPLAY 'FIN VALIDACION PARAMETROS'.
           DISPLAY ' '.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
              IF WSS-COD-OFIC IN WSS-VARI NOT = OFI-COD-OFIC IN OFI
                 GO TO NXT-INP-SRT.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE OFI-COD-OFIC IN OFI TO TAB-COD-CTAB IN TAB.
           MOVE 'OFI'               TO TAB-COD-TTAB IN TAB.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS > SPACES
                DISPLAY ' '
                DISPLAY ' OFICINA : ' OFI-COD-OFIC IN OFI
                        ' RECHAZADA ' MSG-GLS-DESC
                GO TO NXT-INP-SRT.

      *Genera archivo SORT
           MOVE 0 TO WSS-SW-MAL.
           PERFORM GEN-REG-SRT VARYING WSS-I IN WSS-VARI FROM 1 BY 1
                   UNTIL WSS-I IN WSS-VARI > WSS-NUM-OPER IN WSS-VARI.
           IF WSS-SW-MAL = 1
              GO TO FIN-INP-SRT
           ELSE    
              GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           MOVE SRT-COD-OPER IN SRT TO WSS-COD-OPER IN WSS-ADM.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *Genera registro SORT
       GEN-REG-SRT SECTION.
       INI-GEN-REG-SRT.
           MOVE OFI-COD-OFIC IN OFI TO OFI-COD-OFIC IN SRT.
           MOVE '0'                 TO CIC-COD-TCIC IN CIC.
           MOVE 711                 TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET             TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION DE CIC: ' 
                        CIC-CIC-ICIC ' FS: ' CIC-STAT
              MOVE PGM-SMAL TO PGM-STAT-SRT
              MOVE 1 TO WSS-SW-MAL
              MOVE 9000 TO WSS-I
           ELSE
              MOVE CIC-COD-TCIC IN CIC TO WSS-COD-TCIC IN WSS-VARI
              MOVE CIC-COD-CCIC IN CIC TO WSS-COD-CCIC IN WSS-VARI
              MOVE CIC-IIC-ICIC IN CIC TO WSS-COD-ICIC IN WSS-VARI
              MOVE WSS-COD-OPEM IN WSS-VARI TO SRT-COD-OPER IN SRT
              RELEASE SRT.
       FIN-GEN-REG-SRT.
           EXIT.

      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBFCIC.
       COPY GNSBGCIC.
       COPY GNSBVTAB.

      *Entidades  de TAB
       COPY TABBBOFI.
       COPY TABBVOFI.
      *>>>>
*% END
