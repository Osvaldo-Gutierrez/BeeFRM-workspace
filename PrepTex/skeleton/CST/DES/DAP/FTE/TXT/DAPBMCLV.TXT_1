*%! Codigo adicional para archivo CLV
*% IF SETTAG
*% VSNBQ = "09.02.13"
*% FNCBQ = "09.02.01"
*% VSNBU = "09.02.13"
*% FNCBU = "09.02.01"
*% END
*% IF FIN_PUT_VEN_CLV 
      *<<<< FIN_PUT_VEN_CLV 
      *RGD-INI 02/02/2018 (RRM) CORRECION NAVEGABILIDAD
           IF VEN-VAL-FFLE IN VEN IS NOT NUMERIC
               MOVE ZEROES TO VEN-VAL-FFLE IN CLV-FLD.
      *RGD-INI 02/02/2018 (RRM)
           MOVE VEN-FEC-FTRN IN VEN TO WSS-FEC-FAMD.
           MOVE WSS-NUM-DAMD TO FRM-NUM-DTRN IN CLV-FLD.
           MOVE WSS-NUM-MAMD TO FRM-NUM-MTRN IN CLV-FLD.
           MOVE WSS-NUM-SAMD TO FRM-NUM-STRN IN CLV-FLD.
           MOVE WSS-NUM-AAMD TO FRM-NUM-ATRN IN CLV-FLD.
      *>>>> FIN_PUT_VEN_CLV 
*% END
*% IF FIN_PUT_LAD_CLV
      *<<<< FIN_PUT_LAD_CLV
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'ILA' TO TAB-COD-TTAB IN TAB.
           MOVE LAD-COD-INST IN LAD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-INST IN CLV-FLD.
      *>>>> FIN_PUT_LAD_CLV
*% END
*% IF FIN_KEY_LAD_CLV
      *<<<< FIN_KEY_LAD_CLV
           MOVE LAD-NUM-DLAD IN CLV-FLD TO LAD-NUM-DOPD IN LAD                  
                                           LAD-NUM-DCLI IN LAD                  
                                           LAD-NUM-DAUT IN LAD.                 
           MOVE LAD-NUM-MLAD IN CLV-FLD TO LAD-NUM-MOPD IN LAD                  
                                           LAD-NUM-MCLI IN LAD                  
                                           LAD-NUM-MAUT IN LAD.                 
           MOVE LAD-NUM-SLAD IN CLV-FLD TO LAD-NUM-SOPD IN LAD                  
                                           LAD-NUM-SCLI IN LAD                  
                                           LAD-NUM-SAUT IN LAD.                 
           MOVE LAD-NUM-ALAD IN CLV-FLD TO LAD-NUM-AOPD IN LAD                  
                                           LAD-NUM-ACLI IN LAD                  
                                           LAD-NUM-AAUT IN LAD.                 
           MOVE LAD-HRA-HLAD IN CLV-FLD TO LAD-HRA-HOPD IN LAD                  
                                           LAD-HRA-HCLI IN LAD                  
                                           LAD-HRA-HAUT IN LAD.

           MOVE LAD-NUM-CLAD IN CLV-FLD TO LAD-NUM-COPD IN LAD
                                           LAD-NUM-CCLI IN LAD
                                           LAD-NUM-CAUT IN LAD.
      *>>>> FIN_KEY_LAD_CLV
*% END
*% IF FIN_UNP_KEY_CLV
      *<<<< FIN_UNP_KEY_CLV
           MOVE FRM-CPIM-AEY TO FRM-IND-NEXT-ATR IN CLV-FLD.
      *>>>> FIN_UNP_KEY_CLV
*% END
*% IF INI_LAD_FEC_FLAD
      *<<<< INI_LAD_FEC_FLAD
      *RGD-INI 02/02/2018 (RRM) CORRECION NAVEGABILIDAD
      *Campo obligatorio si Criterio Busqueda = 'FEC'
           IF FRM-COD-CREB IN CLV-FLD = WSS-FEC AND
              LAD-FEC-FLAD IN CLV-FLD  NOT > ZEROES
               MOVE 'CL NOINGRFEC' TO MSG-COD-MENS
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LAD-FEC-FLAD.
      *RGD-FIN 02/02/2018 (RRM)
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CLV
      *<<<< INI_VAL_CON_KEY_CLV
           MOVE WSS-COD-ENTI TO  LAD-COD-ENTF IN LAD
                                 LAD-COD-ENTO IN LAD
                                 LAD-COD-ENTC IN LAD
                                 LAD-COD-ENTA IN LAD.
      *>>>> INI_VAL_CON_KEY_CLV
*% END
*% IF FRM_COD_CREB
      *<<<< FRM_COD_CREB
      *VAL-COD Valida codigo de tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'BLA ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-CREB IN CLV-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> FRM_COD_CREB
*% END
*% IF LAD_CAI_IOPD
      *<<<< LAD_CAI_IOPD
      *RGD-INI 02/02/2018 (RRM) CORRECION NAVEGABILIDAD
      *Campo obligatorio si Criterio Busqueda = 'OPE'
           IF FRM-COD-CREB IN CLV-FLD = WSS-OPE AND
              LAD-CAI-IOPD IN CLV-FLD NOT > SPACES
               MOVE 'CL NOINGROPE' TO MSG-COD-MENS
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LAD-CAI-IOPD.
      *RGD-FIN 02/02/2018 (RRM)
      *>>>> LAD_CAI_IOPD
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
      *RGD-INI 02/02/2018 (RRM) CORRECION NAVEGABILIDAD
      *Campo obligatorio si Criterio Busqueda = 'CLI'
           IF FRM-COD-CREB IN CLV-FLD = WSS-CLI AND
              DBC-NUM-ICLI IN CLV-FLD NOT > ZEROES
               MOVE 'CL NOINGRCLI' TO MSG-COD-MENS
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DBC-NUM-ICLI.
      *RGD-FIN 02/02/2018 (RRM)
      *>>>> DBC_NUM_ICLI
*% END
*% IF LAD_COD_AUTO
      *<<<< LAD_COD_AUTO
      *RGD-INI 02/02/2018 (RRM) CORRECION NAVEGABILIDAD
      *Campo obligatorio si Criterio Busqueda = 'AUT'
           IF FRM-COD-CREB IN CLV-FLD = WSS-AUT AND
              LAD-COD-AUTO IN CLV-FLD NOT > SPACES
               MOVE 'CL NOINGRAUT' TO MSG-COD-MENS
               MOVE 'DAP' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LAD-COD-AUTO.
      *RGD-FIN 02/02/2018 (RRM)
      *>>>> LAD_COD_AUTO
*% END
