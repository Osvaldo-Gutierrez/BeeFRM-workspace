*%! Codigo adicional para archivo POD
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSBRMSC.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.

       01  WSS-VARI.
             03  WSS-COD-OFIC                        PIC X(03).
             03  WSS-COD-COPD                        PIC X(06).
             03  WSS-COD-VCAM                        PIC X(06).
             03  WSS-COD-VIGE                        PIC X(03).
             03  WSS-NUM-NOPD        VALUE ZEROES    PIC 9(03).
             03  WSS-GLS-DEST.
               05  WSS-GLS-DES1                      PIC X(20).
               05  WSS-GLS-DES2                      PIC X(20).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
      * Captura Parametros
      *>>>>
*% END
*% IF PH_POD
      *<<<< IF PH_POD
      *Recupera glosa de moneda
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-VCAM IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCAM IN WSS-POD.

      *Recupera glosa de operacion
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TOPD IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' 
              MOVE SPACES TO WSS-GLS-TOPD IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO
                                   WSS-GLS-TOPD IN WSS-POD.

           MOVE POD-COD-TOPD IN POD TO POD-COD-TOPD IN POD.
           MOVE POD-COD-AOPD IN POD TO POD-COD-AOPD IN POD.
           MOVE POD-COD-COPD IN POD TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE SPACES TO WSS-GLS-AOPD IN WSS-POD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO
                                      WSS-GLS-AOPD IN WSS-POD.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *Limpia FIO-AKEY para lectura de otros archivos
           MOVE SPACES TO FIO-AKEY.

      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RENO IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RENO IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TOPD IN WSS-POD 
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-RENO IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-ENDO IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-ENDO IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-ENDO IN WSS-POD 
           ELSE
              MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-ENDO IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'BCT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-BCTI IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-BCTI IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-BCTI IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-BCTI IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMIN IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMIN IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PMIN IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PMIN IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PBT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PBTI IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PBTI IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PBTI IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-PBTI IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PMAX IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PMAX IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PMAX IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PMAX IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MCT' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-SPBT IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-SPBT IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SPBT IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-SPBT IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMNV IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMNV IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SMNV IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SMNV IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-SMXV IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-SMXV IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-SMXV IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SMXV IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TPR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TFPR IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TFPR IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TFPR IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TFPR IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'MDR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-MORE IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-MORE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-MORE IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-MORE IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'CDR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-RESC IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-RESC IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-RESC IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-RESC IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PREP IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PREP IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PREP IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PREP IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'PPR' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-PLPA IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-PLPA IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PLPA IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-PLPA IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PLRE IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PLRE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PLRE IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PLRE IN WSS-POD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE POD-IND-PNTE IN POD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-IND-PNTE IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-PNTE IN WSS-POD 
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PNTE IN WSS-POD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'DAP' TO TAB-COD-SIST.
           MOVE 'TCD' TO TAB-COD-TTAB IN TAB.
           MOVE POD-COD-TCDP IN POD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              POD-COD-TCDP IN POD NOT > SPACES
              MOVE SPACES TO WSS-GLS-TCDP IN WSS-POD 
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TCDP IN WSS-POD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *Entidades  de GNS
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGCPT.

      *Entidades  de TAB
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVUSR.
      *>>>>
*% END
