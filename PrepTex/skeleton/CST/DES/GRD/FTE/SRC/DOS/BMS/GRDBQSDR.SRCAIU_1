      *
      * GRDBQSDR
      * Version 3.0.1 Nov-2005
      * 12-Dec-06 12:22 AM
      *

       SET-TAG-GRDBQSDR SECTION.
       INI-SET-TAG-GRDBQSDR.
           MOVE
           '<IDNMOD NOM=$GRDBQSDR$ VSN=$06.10.25.1$ VGM=$3.0.1$
      -    'GEN=$12-Dec-06 12:22 AM$ FNC=$COBRJUDICIAL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-GRDBQSDR.
           EXIT.
           
       PUT-ALL-SDR SECTION.
       INI-PUT-ALL-SDR.

           PERFORM PUT-SDR-SDR.

       FIN-PUT-ALL-SDR.
           EXIT.
       
       PUT-SDR-SDR SECTION.
       INI-PUT-SDR-SDR.

           IF PGM-STAT-SDR-NUL
               GO TO FIN-PUT-SDR-SDR.
           IF NOT PGM-STAT-SDR-OKS
               PERFORM CLR-SDR-SDR
               GO TO FIN-PUT-SDR-SDR.
           MOVE SDR-CAI-IREC IN SDR TO SDR-CAI-IREC IN SDR-FLD.
           MOVE SDR-IIC-IREC IN SDR TO SDR-IIC-IREC IN SDR-FLD.
           MOVE SDR-NUM-ISDR IN SDR TO SDR-NUM-ISDR IN SDR-FLD.
           MOVE SDR-COD-ESTA IN SDR TO SDR-COD-ESTA IN SDR-FLD.
           MOVE SDR-COD-ROLS IN SDR TO SDR-COD-ROLS IN SDR-FLD.
           MOVE SDR-COD-USRS IN SDR TO SDR-COD-USRS IN SDR-FLD.
           MOVE SDR-COD-ESTS IN SDR TO SDR-COD-ESTS IN SDR-FLD.
           MOVE SDR-COD-ROLR IN SDR TO SDR-COD-ROLR IN SDR-FLD.
           MOVE SDR-COD-USRR IN SDR TO SDR-COD-USRR IN SDR-FLD.
           MOVE SDR-COD-ESTR IN SDR TO SDR-COD-ESTR IN SDR-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE SDR-NUM-DINI IN SDR TO SDR-NUM-DINI IN SDR-FLD.
           MOVE SDR-NUM-MINI IN SDR TO SDR-NUM-MINI IN SDR-FLD.
           MOVE SDR-NUM-SINI IN SDR TO SDR-NUM-SINI IN SDR-FLD.
           MOVE SDR-NUM-AINI IN SDR TO SDR-NUM-AINI IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE SDR-NUM-DTER IN SDR TO SDR-NUM-DTER IN SDR-FLD.
           MOVE SDR-NUM-MTER IN SDR TO SDR-NUM-MTER IN SDR-FLD.
           MOVE SDR-NUM-STER IN SDR TO SDR-NUM-STER IN SDR-FLD.
           MOVE SDR-NUM-ATER IN SDR TO SDR-NUM-ATER IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE SDR-NUM-DDEV IN SDR TO SDR-NUM-DDEV IN SDR-FLD.
           MOVE SDR-NUM-MDEV IN SDR TO SDR-NUM-MDEV IN SDR-FLD.
           MOVE SDR-NUM-SDEV IN SDR TO SDR-NUM-SDEV IN SDR-FLD.
           MOVE SDR-NUM-ADEV IN SDR TO SDR-NUM-ADEV IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE SDR-GLS-SOL1 IN SDR TO SDR-GLS-SOL1 IN SDR-FLD.
           MOVE SDR-GLS-SOL2 IN SDR TO SDR-GLS-SOL2 IN SDR-FLD.
           MOVE SDR-GLS-SOL3 IN SDR TO SDR-GLS-SOL3 IN SDR-FLD.
           MOVE SDR-GLS-SOL4 IN SDR TO SDR-GLS-SOL4 IN SDR-FLD.

       FIN-PUT-SDR-SDR.
           EXIT.
       
       KEY-ALL-SDR SECTION.
       INI-KEY-ALL-SDR.

           PERFORM KEY-SDR-SDR.

       FIN-KEY-ALL-SDR.
           EXIT.
       
       KEY-SDR-SDR SECTION.
       INI-KEY-SDR-SDR.

      *<<<< INI_KEY_SDR_SDR
      *>>>>
           MOVE SDR-CAI-IREC IN SDR-FLD TO SDR-CAI-IREC IN SDR.
           MOVE SDR-IIC-IREC IN SDR-FLD TO SDR-IIC-IREC IN SDR.
           MOVE SDR-NUM-ISDR IN SDR-FLD TO SDR-NUM-ISDR IN SDR.

       FIN-KEY-SDR-SDR.
           EXIT.
       
       SCR-CLRA-SDR SECTION.
       INI-SCR-CLRA-SDR.

           PERFORM CLR-KEY-SDR.
           PERFORM CLR-FLD-SDR.

       FIN-SCR-CLRA-SDR.
           EXIT.
       
       CLR-KEY-SDR SECTION.
       INI-CLR-KEY-SDR.

           MOVE SPACES TO SDR-CAI-IREC IN SDR-FLD.
           MOVE ZEROES TO SDR-IIC-IREC IN SDR-FLD.
           MOVE ZEROES TO SDR-NUM-ISDR IN SDR-FLD.

       FIN-CLR-KEY-SDR.
           EXIT.
       
       CLR-FLD-SDR SECTION.
       INI-CLR-FLD-SDR.

           MOVE SPACES TO FRM-GLS-ESTA IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-ROLS IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-USRS IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-ESTS IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-ROLR IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-USRR IN SDR-FLD.
           MOVE SPACES TO FRM-GLS-ESTR IN SDR-FLD.
           PERFORM CLR-SDR-SDR.

       FIN-CLR-FLD-SDR.
           EXIT.
       
       CLR-SDR-SDR SECTION.
       INI-CLR-SDR-SDR.

           MOVE SPACES TO SDR-COD-ESTA IN SDR-FLD.
           MOVE SPACES TO SDR-COD-ROLS IN SDR-FLD.
           MOVE SPACES TO SDR-COD-USRS IN SDR-FLD.
           MOVE SPACES TO SDR-COD-ESTS IN SDR-FLD.
           MOVE SPACES TO SDR-COD-ROLR IN SDR-FLD.
           MOVE SPACES TO SDR-COD-USRR IN SDR-FLD.
           MOVE SPACES TO SDR-COD-ESTR IN SDR-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SDR-FEC-FINI IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SDR-FEC-FTER IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SDR-FEC-FDEV IN SDR-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO SDR-GLS-SOL1 IN SDR-FLD.
           MOVE SPACES TO SDR-GLS-SOL2 IN SDR-FLD.
           MOVE SPACES TO SDR-GLS-SOL3 IN SDR-FLD.
           MOVE SPACES TO SDR-GLS-SOL4 IN SDR-FLD.

       FIN-CLR-SDR-SDR.
           EXIT.
       
       FST-KEY-SDR SECTION.
       INI-FST-KEY-SDR.

           MOVE -1 TO SDR-CAI-IREC-LEN IN SDR-FLD.

       FIN-FST-KEY-SDR.
           EXIT.
       
       FST-FLD-SDR SECTION.
       INI-FST-FLD-SDR.

           MOVE -1 TO SDR-COD-ESTA-LEN IN SDR-FLD.

       FIN-FST-FLD-SDR.
           EXIT.
       
       PRO-KEY-SDR SECTION.
       INI-PRO-KEY-SDR.

           PERFORM PRO-IKY-SDR.
           PERFORM PRO-AKY-SDR.
           PERFORM PRO-MKY-SDR.

       FIN-PRO-KEY-SDR.
           EXIT.
       
       PRO-IKY-SDR SECTION.
       INI-PRO-IKY-SDR.

           MOVE FRM-CPIM-AEY TO SDR-CAI-IREC-ATR IN SDR-FLD.
           MOVE FRM-CPIM-AEY TO SDR-IIC-IREC-ATR IN SDR-FLD.
           MOVE FRM-CPIM-AEY TO SDR-NUM-ISDR-ATR IN SDR-FLD.

       FIN-PRO-IKY-SDR.
           EXIT.
       
       PRO-MKY-SDR SECTION.
       INI-PRO-MKY-SDR.


       FIN-PRO-MKY-SDR.
           EXIT.
       
       PRO-AKY-SDR SECTION.
       INI-PRO-AKY-SDR.


       FIN-PRO-AKY-SDR.
           EXIT.
       
       UNP-KEY-SDR SECTION.
       INI-UNP-KEY-SDR.

           PERFORM UNP-IKY-SDR.
           PERFORM UNP-AKY-SDR.
           PERFORM UNP-MKY-SDR.

       FIN-UNP-KEY-SDR.
           EXIT.
       
       UNP-IKY-SDR SECTION.
       INI-UNP-IKY-SDR.

           MOVE FRM-CPIM-UBY TO SDR-CAI-IREC-ATR.
           MOVE FRM-CPIM-UBY TO SDR-IIC-IREC-ATR.
           MOVE FRM-CPIM-UBY TO SDR-NUM-ISDR-ATR.

       FIN-UNP-IKY-SDR.
           EXIT.
       
       UNP-MKY-SDR SECTION.
       INI-UNP-MKY-SDR.


       FIN-UNP-MKY-SDR.
           EXIT.
       
       UNP-AKY-SDR SECTION.
       INI-UNP-AKY-SDR.


       FIN-UNP-AKY-SDR.
           EXIT.
       
       UNP-FLD-SDR SECTION.
       INI-UNP-FLD-SDR.

           PERFORM UNP-SDR-SDR.

       FIN-UNP-FLD-SDR.
           EXIT.
       
       UNP-SDR-SDR SECTION.
       INI-UNP-SDR-SDR.

           MOVE FRM-CPIM-UBY TO SDR-COD-ESTA-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-ROLS-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-USRS-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-ESTS-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-ROLR-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-USRR-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-COD-ESTR-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-GLS-SOL1-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-GLS-SOL2-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-GLS-SOL3-ATR IN SDR-FLD.
           MOVE FRM-CPIM-UBY TO SDR-GLS-SOL4-ATR IN SDR-FLD.

       FIN-UNP-SDR-SDR.
           EXIT.
       
       VAL-KEY-SDR SECTION.
       INI-VAL-KEY-SDR.
           PERFORM VAL-IKY-SDR.
           PERFORM VAL-MKY-SDR.
           PERFORM VAL-AKY-SDR.
       FIN-VAL-KEY-SDR.
           EXIT.
       
       VAL-IKY-SDR SECTION.
       INI-VAL-IKY-SDR.

           PERFORM VAL-SDR-CAI-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SDR-CAI-IREC-LEN IN SDR-FLD
                GO TO FIN-VAL-IKY-SDR.
           PERFORM VAL-SDR-IIC-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SDR-IIC-IREC-LEN IN SDR-FLD
                GO TO FIN-VAL-IKY-SDR.
           PERFORM VAL-SDR-NUM-ISDR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SDR-NUM-ISDR-LEN IN SDR-FLD
                GO TO FIN-VAL-IKY-SDR.

       FIN-VAL-IKY-SDR.
           EXIT.
       
       VAL-MKY-SDR SECTION.
       INI-VAL-MKY-SDR.


       FIN-VAL-MKY-SDR.
           EXIT.
       
       VAL-AKY-SDR SECTION.
       INI-VAL-AKY-SDR.


       FIN-VAL-AKY-SDR.
           EXIT.
       
       VAL-SDR-CAI-IREC SECTION.
       INI-VAL-SDR-CAI-IREC.

           IF SDR-CAI-IREC IN SDR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SDR-CAI-IREC.


       FIN-VAL-SDR-CAI-IREC.
           EXIT.
       
       VAL-SDR-IIC-IREC SECTION.
       INI-VAL-SDR-IIC-IREC.

           IF SDR-IIC-IREC IN SDR-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SDR-IIC-IREC.


       FIN-VAL-SDR-IIC-IREC.
           EXIT.
       
       VAL-SDR-NUM-ISDR SECTION.
       INI-VAL-SDR-NUM-ISDR.



       FIN-VAL-SDR-NUM-ISDR.
           EXIT.
       
       VAL-CON-KEY-SDR SECTION.
       INI-VAL-CON-KEY-SDR.

           IF     SDR-CAI-IREC IN SDR-FLD NOT > SPACES 
              AND SDR-IIC-IREC IN SDR-FLD NOT > ZEROES 
              AND SDR-NUM-ISDR IN SDR-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-SDR.

       FIN-VAL-CON-KEY-SDR.
           EXIT.
       
       VAL-CON-IKY-SDR SECTION.
       INI-VAL-CON-IKY-SDR.

           IF     SDR-CAI-IREC IN SDR-FLD NOT > SPACES 
              AND SDR-IIC-IREC IN SDR-FLD NOT > ZEROES 
              AND SDR-NUM-ISDR IN SDR-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-SDR.

       FIN-VAL-CON-IKY-SDR.
           EXIT.
       
       VAL-NUM-KEY-SDR SECTION.
       INI-VAL-NUM-KEY-SDR.
           PERFORM VAL-NUM-IKY-SDR.
           PERFORM VAL-NUM-MKY-SDR.
           PERFORM VAL-NUM-AKY-SDR.
       FIN-VAL-NUM-KEY-SDR.
           EXIT.
       
       VAL-NUM-IKY-SDR SECTION.
       INI-VAL-NUM-IKY-SDR.

       VAL-NUM-SDR-IIC-IREC.
           MOVE SDR-IIC-IREC-ALF IN SDR-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO SDR-IIC-IREC IN SDR-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO SDR-IIC-IREC-LEN IN SDR-FLD
                GO TO FIN-VAL-NUM-IKY-SDR.
       VAL-NUM-SDR-NUM-ISDR.
           MOVE SDR-NUM-ISDR-ALF IN SDR-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO SDR-NUM-ISDR IN SDR-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO SDR-NUM-ISDR-LEN IN SDR-FLD
                GO TO FIN-VAL-NUM-IKY-SDR.

       FIN-VAL-NUM-IKY-SDR.
           EXIT.
       
       VAL-NUM-MKY-SDR SECTION.
       INI-VAL-NUM-MKY-SDR.


       FIN-VAL-NUM-MKY-SDR.
           EXIT.
       
       VAL-NUM-AKY-SDR SECTION.
       INI-VAL-NUM-AKY-SDR.


       FIN-VAL-NUM-AKY-SDR.
           EXIT.
       
       VAL-NUM-FLD-SDR SECTION.
       INI-VAL-NUM-FLD-SDR.


       FIN-VAL-NUM-FLD-SDR.
           EXIT.
       
       EDT-KEY-SDR SECTION.
       INI-EDT-KEY-SDR.
           PERFORM EDT-IKY-SDR.
           PERFORM EDT-MKY-SDR.
           PERFORM EDT-AKY-SDR.

       FIN-EDT-KEY-SDR.
           EXIT.
       
       EDT-IKY-SDR SECTION.
       INI-EDT-IKY-SDR.

           IF SDR-IIC-IREC-LEN IN SDR-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SDR-IIC-IREC-LEN IN SDR-FLD
                GO TO FIN-EDT-IKY-SDR.
           MOVE SDR-IIC-IREC IN SDR-FLD TO SDR-IIC-IREC-EDT IN SDR-EDT.
           MOVE SDR-IIC-IREC-EDT IN SDR-EDT TO 
                SDR-IIC-IREC-ALF IN SDR-FLD.
           IF SDR-NUM-ISDR-LEN IN SDR-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SDR-NUM-ISDR-LEN IN SDR-FLD
                GO TO FIN-EDT-IKY-SDR.
           MOVE SDR-NUM-ISDR IN SDR-FLD TO SDR-NUM-ISDR-EDT IN SDR-EDT.
           MOVE SDR-NUM-ISDR-EDT IN SDR-EDT TO 
                SDR-NUM-ISDR-ALF IN SDR-FLD.

       FIN-EDT-IKY-SDR.
           EXIT.
       
       EDT-MKY-SDR SECTION.
       INI-EDT-MKY-SDR.


       FIN-EDT-MKY-SDR.
           EXIT.
       
       EDT-AKY-SDR SECTION.
       INI-EDT-AKY-SDR.


       FIN-EDT-AKY-SDR.
           EXIT.
       
       EDT-FLD-SDR SECTION.
       INI-EDT-FLD-SDR.


       FIN-EDT-FLD-SDR.
           EXIT.



