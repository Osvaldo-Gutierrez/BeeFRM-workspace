      *
      * GRDBQOSD
      * Version 3.0.1 Nov-2005
      * 09-Mar-09 09:46 AM
      *

       SET-TAG-GRDBQOSD SECTION.
       INI-SET-TAG-GRDBQOSD.
           MOVE
           '<IDNMOD NOM=$GRDBQOSD$ VSN=$05.11.28.1$ VGM=$3.0.1$
      -    'GEN=$09-Mar-09 09:46 AM$ FNC=$COBRJUDICIAL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-GRDBQOSD.
           EXIT.
           
       PUT-ALL-OSD SECTION.
       INI-PUT-ALL-OSD.

           PERFORM PUT-OSD-OSD.

       FIN-PUT-ALL-OSD.
           EXIT.
       
       PUT-OSD-OSD SECTION.
       INI-PUT-OSD-OSD.

           IF PGM-STAT-OSD-NUL
               GO TO FIN-PUT-OSD-OSD.
           IF NOT PGM-STAT-OSD-OKS
               PERFORM CLR-OSD-OSD
               GO TO FIN-PUT-OSD-OSD.
           MOVE OSD-CAI-IREC IN OSD TO OSD-CAI-IREC IN OSD-FLD.
           MOVE OSD-CAI-IOPC IN OSD TO OSD-CAI-IOPC IN OSD-FLD.
           MOVE OSD-NUM-IDLC IN OSD TO OSD-NUM-IDLC IN OSD-FLD.
           MOVE OSD-NUM-IROS IN OSD TO OSD-NUM-IROS IN OSD-FLD.
           MOVE OSD-NUM-IOSD IN OSD TO OSD-NUM-IOSD IN OSD-FLD.
           MOVE OSD-COD-TIPO IN OSD TO OSD-COD-TIPO IN OSD-FLD.
           MOVE OSD-COD-ESTA IN OSD TO OSD-COD-ESTA IN OSD-FLD.
           MOVE OSD-COD-MOTI IN OSD TO OSD-COD-MOTI IN OSD-FLD.
           MOVE OSD-IIC-IREC IN OSD TO OSD-IIC-IREC IN OSD-FLD.
           MOVE OSD-IIC-IOPC IN OSD TO OSD-IIC-IOPC IN OSD-FLD.

       FIN-PUT-OSD-OSD.
           EXIT.
       
       KEY-ALL-OSD SECTION.
       INI-KEY-ALL-OSD.

           PERFORM KEY-OSD-OSD.

       FIN-KEY-ALL-OSD.
           EXIT.
       
       KEY-OSD-OSD SECTION.
       INI-KEY-OSD-OSD.

      *<<<< INI_KEY_OSD_OSD
      *>>>>
           MOVE OSD-CAI-IREC IN OSD-FLD TO OSD-CAI-IREC IN OSD.
           MOVE OSD-CAI-IOPC IN OSD-FLD TO OSD-CAI-IOPC IN OSD.
           MOVE OSD-NUM-IDLC IN OSD-FLD TO OSD-NUM-IDLC IN OSD.
           MOVE OSD-IIC-IREC IN OSD-FLD TO OSD-IIC-IREC IN OSD.
           MOVE OSD-IIC-IOPC IN OSD-FLD TO OSD-IIC-IOPC IN OSD.

       FIN-KEY-OSD-OSD.
           EXIT.
       
       SCR-CLRA-OSD SECTION.
       INI-SCR-CLRA-OSD.

           PERFORM CLR-KEY-OSD.
           PERFORM CLR-FLD-OSD.

       FIN-SCR-CLRA-OSD.
           EXIT.
       
       CLR-KEY-OSD SECTION.
       INI-CLR-KEY-OSD.

           MOVE SPACES TO OSD-CAI-IREC IN OSD-FLD.
           MOVE SPACES TO OSD-CAI-IOPC IN OSD-FLD.
           MOVE ZEROES TO OSD-NUM-IDLC IN OSD-FLD.
           MOVE ZEROES TO OSD-IIC-IREC IN OSD-FLD.
           MOVE ZEROES TO OSD-IIC-IOPC IN OSD-FLD.

       FIN-CLR-KEY-OSD.
           EXIT.
       
       CLR-FLD-OSD SECTION.
       INI-CLR-FLD-OSD.

           PERFORM CLR-OSD-OSD.

       FIN-CLR-FLD-OSD.
           EXIT.
       
       CLR-OSD-OSD SECTION.
       INI-CLR-OSD-OSD.

           MOVE ZEROES TO OSD-NUM-IROS IN OSD-FLD.
           MOVE ZEROES TO OSD-NUM-IOSD IN OSD-FLD.
           MOVE SPACES TO OSD-COD-TIPO IN OSD-FLD.
           MOVE SPACES TO OSD-COD-ESTA IN OSD-FLD.
           MOVE SPACES TO OSD-COD-MOTI IN OSD-FLD.

       FIN-CLR-OSD-OSD.
           EXIT.
       
       FST-KEY-OSD SECTION.
       INI-FST-KEY-OSD.

           MOVE -1 TO OSD-CAI-IREC-LEN IN OSD-FLD.

       FIN-FST-KEY-OSD.
           EXIT.
       
       FST-FLD-OSD SECTION.
       INI-FST-FLD-OSD.

           MOVE -1 TO OSD-NUM-IROS-LEN IN OSD-FLD.

       FIN-FST-FLD-OSD.
           EXIT.
       
       PRO-KEY-OSD SECTION.
       INI-PRO-KEY-OSD.

           PERFORM PRO-IKY-OSD.
           PERFORM PRO-AKY-OSD.
           PERFORM PRO-MKY-OSD.

       FIN-PRO-KEY-OSD.
           EXIT.
       
       PRO-IKY-OSD SECTION.
       INI-PRO-IKY-OSD.

           MOVE FRM-CPIM-AEY TO OSD-CAI-IREC-ATR IN OSD-FLD.
           MOVE FRM-CPIM-AEY TO OSD-CAI-IOPC-ATR IN OSD-FLD.
           MOVE FRM-CPIM-AEY TO OSD-NUM-IDLC-ATR IN OSD-FLD.
           MOVE FRM-CPIM-AEY TO OSD-IIC-IREC-ATR IN OSD-FLD.
           MOVE FRM-CPIM-AEY TO OSD-IIC-IOPC-ATR IN OSD-FLD.

       FIN-PRO-IKY-OSD.
           EXIT.
       
       PRO-MKY-OSD SECTION.
       INI-PRO-MKY-OSD.


       FIN-PRO-MKY-OSD.
           EXIT.
       
       PRO-AKY-OSD SECTION.
       INI-PRO-AKY-OSD.


       FIN-PRO-AKY-OSD.
           EXIT.
       
       UNP-KEY-OSD SECTION.
       INI-UNP-KEY-OSD.

           PERFORM UNP-IKY-OSD.
           PERFORM UNP-AKY-OSD.
           PERFORM UNP-MKY-OSD.

       FIN-UNP-KEY-OSD.
           EXIT.
       
       UNP-IKY-OSD SECTION.
       INI-UNP-IKY-OSD.

           MOVE FRM-CPIM-UBY TO OSD-CAI-IREC-ATR.
           MOVE FRM-CPIM-UBY TO OSD-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO OSD-NUM-IDLC-ATR.
           MOVE FRM-CPIM-UBY TO OSD-IIC-IREC-ATR.
           MOVE FRM-CPIM-UBY TO OSD-IIC-IOPC-ATR.

       FIN-UNP-IKY-OSD.
           EXIT.
       
       UNP-MKY-OSD SECTION.
       INI-UNP-MKY-OSD.


       FIN-UNP-MKY-OSD.
           EXIT.
       
       UNP-AKY-OSD SECTION.
       INI-UNP-AKY-OSD.


       FIN-UNP-AKY-OSD.
           EXIT.
       
       UNP-FLD-OSD SECTION.
       INI-UNP-FLD-OSD.

           PERFORM UNP-OSD-OSD.

       FIN-UNP-FLD-OSD.
           EXIT.
       
       UNP-OSD-OSD SECTION.
       INI-UNP-OSD-OSD.

           MOVE FRM-CPIM-UBY TO OSD-NUM-IROS-ATR IN OSD-FLD.
           MOVE FRM-CPIM-UBY TO OSD-NUM-IOSD-ATR IN OSD-FLD.
           MOVE FRM-CPIM-UBY TO OSD-COD-TIPO-ATR IN OSD-FLD.
           MOVE FRM-CPIM-UBY TO OSD-COD-ESTA-ATR IN OSD-FLD.
           MOVE FRM-CPIM-UBY TO OSD-COD-MOTI-ATR IN OSD-FLD.

       FIN-UNP-OSD-OSD.
           EXIT.
       
       VAL-KEY-OSD SECTION.
       INI-VAL-KEY-OSD.
           PERFORM VAL-IKY-OSD.
           PERFORM VAL-MKY-OSD.
           PERFORM VAL-AKY-OSD.
       FIN-VAL-KEY-OSD.
           EXIT.
       
       VAL-IKY-OSD SECTION.
       INI-VAL-IKY-OSD.

           PERFORM VAL-OSD-CAI-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OSD-CAI-IREC-LEN IN OSD-FLD
                GO TO FIN-VAL-IKY-OSD.
           PERFORM VAL-OSD-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OSD-CAI-IOPC-LEN IN OSD-FLD
                GO TO FIN-VAL-IKY-OSD.
           PERFORM VAL-OSD-NUM-IDLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OSD-NUM-IDLC-LEN IN OSD-FLD
                GO TO FIN-VAL-IKY-OSD.
           PERFORM VAL-OSD-IIC-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OSD-IIC-IREC-LEN IN OSD-FLD
                GO TO FIN-VAL-IKY-OSD.
           PERFORM VAL-OSD-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OSD-IIC-IOPC-LEN IN OSD-FLD
                GO TO FIN-VAL-IKY-OSD.

       FIN-VAL-IKY-OSD.
           EXIT.
       
       VAL-MKY-OSD SECTION.
       INI-VAL-MKY-OSD.


       FIN-VAL-MKY-OSD.
           EXIT.
       
       VAL-AKY-OSD SECTION.
       INI-VAL-AKY-OSD.


       FIN-VAL-AKY-OSD.
           EXIT.
       
       VAL-OSD-CAI-IREC SECTION.
       INI-VAL-OSD-CAI-IREC.

           IF OSD-CAI-IREC IN OSD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OSD-CAI-IREC.


       FIN-VAL-OSD-CAI-IREC.
           EXIT.
       
       VAL-OSD-CAI-IOPC SECTION.
       INI-VAL-OSD-CAI-IOPC.

           IF OSD-CAI-IOPC IN OSD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OSD-CAI-IOPC.


       FIN-VAL-OSD-CAI-IOPC.
           EXIT.
       
       VAL-OSD-NUM-IDLC SECTION.
       INI-VAL-OSD-NUM-IDLC.

           IF OSD-NUM-IDLC IN OSD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OSD-NUM-IDLC.


       FIN-VAL-OSD-NUM-IDLC.
           EXIT.
       
       VAL-OSD-IIC-IREC SECTION.
       INI-VAL-OSD-IIC-IREC.

           IF OSD-IIC-IREC IN OSD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OSD-IIC-IREC.


       FIN-VAL-OSD-IIC-IREC.
           EXIT.
       
       VAL-OSD-IIC-IOPC SECTION.
       INI-VAL-OSD-IIC-IOPC.

           IF OSD-IIC-IOPC IN OSD-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OSD-IIC-IOPC.


       FIN-VAL-OSD-IIC-IOPC.
           EXIT.
       
       VAL-CON-KEY-OSD SECTION.
       INI-VAL-CON-KEY-OSD.

           IF     OSD-CAI-IREC IN OSD-FLD NOT > SPACES 
              AND OSD-CAI-IOPC IN OSD-FLD NOT > SPACES 
              AND OSD-NUM-IDLC IN OSD-FLD NOT > ZEROES 
              AND OSD-IIC-IREC IN OSD-FLD NOT > ZEROES 
              AND OSD-IIC-IOPC IN OSD-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-OSD.

       FIN-VAL-CON-KEY-OSD.
           EXIT.
       
       VAL-CON-IKY-OSD SECTION.
       INI-VAL-CON-IKY-OSD.

           IF     OSD-CAI-IREC IN OSD-FLD NOT > SPACES 
              AND OSD-CAI-IOPC IN OSD-FLD NOT > SPACES 
              AND OSD-NUM-IDLC IN OSD-FLD NOT > ZEROES 
              AND OSD-IIC-IREC IN OSD-FLD NOT > ZEROES 
              AND OSD-IIC-IOPC IN OSD-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-OSD.

       FIN-VAL-CON-IKY-OSD.
           EXIT.
       
       VAL-NUM-KEY-OSD SECTION.
       INI-VAL-NUM-KEY-OSD.
           PERFORM VAL-NUM-IKY-OSD.
           PERFORM VAL-NUM-MKY-OSD.
           PERFORM VAL-NUM-AKY-OSD.
       FIN-VAL-NUM-KEY-OSD.
           EXIT.
       
       VAL-NUM-IKY-OSD SECTION.
       INI-VAL-NUM-IKY-OSD.

       VAL-NUM-OSD-NUM-IDLC.
           MOVE OSD-NUM-IDLC-ALF IN OSD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OSD-NUM-IDLC IN OSD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OSD-NUM-IDLC-LEN IN OSD-FLD
                GO TO FIN-VAL-NUM-IKY-OSD.
       VAL-NUM-OSD-IIC-IREC.
           MOVE OSD-IIC-IREC-ALF IN OSD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OSD-IIC-IREC IN OSD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OSD-IIC-IREC-LEN IN OSD-FLD
                GO TO FIN-VAL-NUM-IKY-OSD.
       VAL-NUM-OSD-IIC-IOPC.
           MOVE OSD-IIC-IOPC-ALF IN OSD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OSD-IIC-IOPC IN OSD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OSD-IIC-IOPC-LEN IN OSD-FLD
                GO TO FIN-VAL-NUM-IKY-OSD.

       FIN-VAL-NUM-IKY-OSD.
           EXIT.
       
       VAL-NUM-MKY-OSD SECTION.
       INI-VAL-NUM-MKY-OSD.


       FIN-VAL-NUM-MKY-OSD.
           EXIT.
       
       VAL-NUM-AKY-OSD SECTION.
       INI-VAL-NUM-AKY-OSD.


       FIN-VAL-NUM-AKY-OSD.
           EXIT.
       
       VAL-NUM-FLD-OSD SECTION.
       INI-VAL-NUM-FLD-OSD.

       VAL-NUM-OSD-NUM-IROS.
           MOVE OSD-NUM-IROS-ALF IN OSD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OSD-NUM-IROS IN OSD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OSD-NUM-IROS-LEN IN OSD-FLD
                GO TO FIN-VAL-NUM-FLD-OSD.
       VAL-NUM-OSD-NUM-IOSD.
           MOVE OSD-NUM-IOSD-ALF IN OSD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO OSD-NUM-IOSD IN OSD-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO OSD-NUM-IOSD-LEN IN OSD-FLD
                GO TO FIN-VAL-NUM-FLD-OSD.

       FIN-VAL-NUM-FLD-OSD.
           EXIT.
       
       EDT-KEY-OSD SECTION.
       INI-EDT-KEY-OSD.
           PERFORM EDT-IKY-OSD.
           PERFORM EDT-MKY-OSD.
           PERFORM EDT-AKY-OSD.

       FIN-EDT-KEY-OSD.
           EXIT.
       
       EDT-IKY-OSD SECTION.
       INI-EDT-IKY-OSD.

           IF OSD-NUM-IDLC-LEN IN OSD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OSD-NUM-IDLC-LEN IN OSD-FLD
                GO TO FIN-EDT-IKY-OSD.
           MOVE OSD-NUM-IDLC IN OSD-FLD TO OSD-NUM-IDLC-EDT IN OSD-EDT.
           MOVE OSD-NUM-IDLC-EDT IN OSD-EDT TO 
                OSD-NUM-IDLC-ALF IN OSD-FLD.
           IF OSD-IIC-IREC-LEN IN OSD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OSD-IIC-IREC-LEN IN OSD-FLD
                GO TO FIN-EDT-IKY-OSD.
           MOVE OSD-IIC-IREC IN OSD-FLD TO OSD-IIC-IREC-EDT IN OSD-EDT.
           MOVE OSD-IIC-IREC-EDT IN OSD-EDT TO 
                OSD-IIC-IREC-ALF IN OSD-FLD.
           IF OSD-IIC-IOPC-LEN IN OSD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OSD-IIC-IOPC-LEN IN OSD-FLD
                GO TO FIN-EDT-IKY-OSD.
           MOVE OSD-IIC-IOPC IN OSD-FLD TO OSD-IIC-IOPC-EDT IN OSD-EDT.
           MOVE OSD-IIC-IOPC-EDT IN OSD-EDT TO 
                OSD-IIC-IOPC-ALF IN OSD-FLD.

       FIN-EDT-IKY-OSD.
           EXIT.
       
       EDT-MKY-OSD SECTION.
       INI-EDT-MKY-OSD.


       FIN-EDT-MKY-OSD.
           EXIT.
       
       EDT-AKY-OSD SECTION.
       INI-EDT-AKY-OSD.


       FIN-EDT-AKY-OSD.
           EXIT.
       
       EDT-FLD-OSD SECTION.
       INI-EDT-FLD-OSD.

           IF OSD-NUM-IROS-LEN IN OSD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OSD-NUM-IROS-LEN IN OSD-FLD
                GO TO FIN-EDT-FLD-OSD.
           MOVE OSD-NUM-IROS IN OSD-FLD TO OSD-NUM-IROS-EDT IN OSD-EDT.
           MOVE OSD-NUM-IROS-EDT IN OSD-EDT TO 
                OSD-NUM-IROS-ALF IN OSD-FLD.
           IF OSD-NUM-IOSD-LEN IN OSD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OSD-NUM-IOSD-LEN IN OSD-FLD
                GO TO FIN-EDT-FLD-OSD.
           MOVE OSD-NUM-IOSD IN OSD-FLD TO OSD-NUM-IOSD-EDT IN OSD-EDT.
           MOVE OSD-NUM-IOSD-EDT IN OSD-EDT TO 
                OSD-NUM-IOSD-ALF IN OSD-FLD.

       FIN-EDT-FLD-OSD.
           EXIT.



