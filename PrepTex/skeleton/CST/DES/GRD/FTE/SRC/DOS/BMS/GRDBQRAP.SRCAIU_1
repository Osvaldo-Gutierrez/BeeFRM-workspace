      *
      * GRDBQRAP
      * Version 3.0.1 Nov-2005
      * 29-Jan-06 06:29 PM
      *

       SET-TAG-GRDBQRAP SECTION.
       INI-SET-TAG-GRDBQRAP.
           MOVE
           '<IDNMOD NOM=$GRDBQRAP$ VSN=$05.11.28.1$ VGM=$3.0.1$
      -    'GEN=$29-Jan-06 06:29 PM$ FNC=$COBRJUDICIAL$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-GRDBQRAP.
           EXIT.
           
       PUT-ALL-RAP SECTION.
       INI-PUT-ALL-RAP.

           PERFORM PUT-RAP-RAP.

       FIN-PUT-ALL-RAP.
           EXIT.
       
       PUT-RAP-RAP SECTION.
       INI-PUT-RAP-RAP.

           IF PGM-STAT-RAP-NUL
               GO TO FIN-PUT-RAP-RAP.
           IF NOT PGM-STAT-RAP-OKS
               PERFORM CLR-RAP-RAP
               GO TO FIN-PUT-RAP-RAP.
           MOVE RAP-CAI-IREC IN RAP TO RAP-CAI-IREC IN RAP-FLD.
           MOVE RAP-IIC-IREC IN RAP TO RAP-IIC-IREC IN RAP-FLD.
           MOVE RAP-NUM-IRAP IN RAP TO RAP-NUM-IRAP IN RAP-FLD.
           MOVE RAP-COD-ESTA IN RAP TO RAP-COD-ESTA IN RAP-FLD.
           MOVE RAP-COD-TIPO IN RAP TO RAP-COD-TIPO IN RAP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE RAP-NUM-DINI IN RAP TO RAP-NUM-DINI IN RAP-FLD.
           MOVE RAP-NUM-MINI IN RAP TO RAP-NUM-MINI IN RAP-FLD.
           MOVE RAP-NUM-SINI IN RAP TO RAP-NUM-SINI IN RAP-FLD.
           MOVE RAP-NUM-AINI IN RAP TO RAP-NUM-AINI IN RAP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE RAP-NUM-DTER IN RAP TO RAP-NUM-DTER IN RAP-FLD.
           MOVE RAP-NUM-MTER IN RAP TO RAP-NUM-MTER IN RAP-FLD.
           MOVE RAP-NUM-STER IN RAP TO RAP-NUM-STER IN RAP-FLD.
           MOVE RAP-NUM-ATER IN RAP TO RAP-NUM-ATER IN RAP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE RAP-IND-IN01 IN RAP TO RAP-IND-IN01 IN RAP-FLD.
           MOVE RAP-IND-IN02 IN RAP TO RAP-IND-IN02 IN RAP-FLD.
           MOVE RAP-IND-IN03 IN RAP TO RAP-IND-IN03 IN RAP-FLD.
           MOVE RAP-IND-IN04 IN RAP TO RAP-IND-IN04 IN RAP-FLD.
           MOVE RAP-IND-IN05 IN RAP TO RAP-IND-IN05 IN RAP-FLD.
           MOVE RAP-IND-IN06 IN RAP TO RAP-IND-IN06 IN RAP-FLD.
           MOVE RAP-IND-IN07 IN RAP TO RAP-IND-IN07 IN RAP-FLD.
           MOVE RAP-IND-IN08 IN RAP TO RAP-IND-IN08 IN RAP-FLD.
           MOVE RAP-IND-IN09 IN RAP TO RAP-IND-IN09 IN RAP-FLD.
           MOVE RAP-IND-IN10 IN RAP TO RAP-IND-IN10 IN RAP-FLD.
           MOVE RAP-CAI-IOPC IN RAP TO RAP-CAI-IOPC IN RAP-FLD.
           MOVE RAP-IIC-IOPC IN RAP TO RAP-IIC-IOPC IN RAP-FLD.

       FIN-PUT-RAP-RAP.
           EXIT.
       
       KEY-ALL-RAP SECTION.
       INI-KEY-ALL-RAP.

           PERFORM KEY-RAP-RAP.

       FIN-KEY-ALL-RAP.
           EXIT.
       
       KEY-RAP-RAP SECTION.
       INI-KEY-RAP-RAP.

      *<<<< INI_KEY_RAP_RAP
      *>>>>
           MOVE RAP-CAI-IREC IN RAP-FLD TO RAP-CAI-IREC IN RAP.
           MOVE RAP-IIC-IREC IN RAP-FLD TO RAP-IIC-IREC IN RAP.
           MOVE RAP-NUM-IRAP IN RAP-FLD TO RAP-NUM-IRAP IN RAP.

       FIN-KEY-RAP-RAP.
           EXIT.
       
       SCR-CLRA-RAP SECTION.
       INI-SCR-CLRA-RAP.

           PERFORM CLR-KEY-RAP.
           PERFORM CLR-FLD-RAP.

       FIN-SCR-CLRA-RAP.
           EXIT.
       
       CLR-KEY-RAP SECTION.
       INI-CLR-KEY-RAP.

           MOVE SPACES TO RAP-CAI-IREC IN RAP-FLD.
           MOVE ZEROES TO RAP-IIC-IREC IN RAP-FLD.
           MOVE ZEROES TO RAP-NUM-IRAP IN RAP-FLD.

       FIN-CLR-KEY-RAP.
           EXIT.
       
       CLR-FLD-RAP SECTION.
       INI-CLR-FLD-RAP.

           MOVE SPACES TO FRM-GLS-IN01 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN02 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN03 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN04 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN05 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN06 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN07 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN08 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN09 IN RAP-FLD.
           MOVE SPACES TO FRM-GLS-IN10 IN RAP-FLD.
           PERFORM CLR-RAP-RAP.

       FIN-CLR-FLD-RAP.
           EXIT.
       
       CLR-RAP-RAP SECTION.
       INI-CLR-RAP-RAP.

           MOVE SPACES TO RAP-COD-ESTA IN RAP-FLD.
           MOVE SPACES TO RAP-COD-TIPO IN RAP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO RAP-FEC-FINI IN RAP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO RAP-FEC-FTER IN RAP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO RAP-IND-IN01 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN02 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN03 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN04 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN05 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN06 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN07 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN08 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN09 IN RAP-FLD.
           MOVE SPACES TO RAP-IND-IN10 IN RAP-FLD.
           MOVE SPACES TO RAP-CAI-IOPC IN RAP-FLD.
           MOVE SPACES TO RAP-IIC-IOPC IN RAP-FLD.

       FIN-CLR-RAP-RAP.
           EXIT.
       
       FST-KEY-RAP SECTION.
       INI-FST-KEY-RAP.

           MOVE -1 TO RAP-CAI-IREC-LEN IN RAP-FLD.

       FIN-FST-KEY-RAP.
           EXIT.
       
       FST-FLD-RAP SECTION.
       INI-FST-FLD-RAP.

           MOVE -1 TO RAP-COD-ESTA-LEN IN RAP-FLD.

       FIN-FST-FLD-RAP.
           EXIT.
       
       PRO-KEY-RAP SECTION.
       INI-PRO-KEY-RAP.

           PERFORM PRO-IKY-RAP.
           PERFORM PRO-AKY-RAP.
           PERFORM PRO-MKY-RAP.

       FIN-PRO-KEY-RAP.
           EXIT.
       
       PRO-IKY-RAP SECTION.
       INI-PRO-IKY-RAP.

           MOVE FRM-CPIM-AEY TO RAP-CAI-IREC-ATR IN RAP-FLD.
           MOVE FRM-CPIM-AEY TO RAP-IIC-IREC-ATR IN RAP-FLD.
           MOVE FRM-CPIM-AEY TO RAP-NUM-IRAP-ATR IN RAP-FLD.

       FIN-PRO-IKY-RAP.
           EXIT.
       
       PRO-MKY-RAP SECTION.
       INI-PRO-MKY-RAP.


       FIN-PRO-MKY-RAP.
           EXIT.
       
       PRO-AKY-RAP SECTION.
       INI-PRO-AKY-RAP.


       FIN-PRO-AKY-RAP.
           EXIT.
       
       UNP-KEY-RAP SECTION.
       INI-UNP-KEY-RAP.

           PERFORM UNP-IKY-RAP.
           PERFORM UNP-AKY-RAP.
           PERFORM UNP-MKY-RAP.

       FIN-UNP-KEY-RAP.
           EXIT.
       
       UNP-IKY-RAP SECTION.
       INI-UNP-IKY-RAP.

           MOVE FRM-CPIM-UBY TO RAP-CAI-IREC-ATR.
           MOVE FRM-CPIM-UBY TO RAP-IIC-IREC-ATR.
           MOVE FRM-CPIM-UBY TO RAP-NUM-IRAP-ATR.

       FIN-UNP-IKY-RAP.
           EXIT.
       
       UNP-MKY-RAP SECTION.
       INI-UNP-MKY-RAP.


       FIN-UNP-MKY-RAP.
           EXIT.
       
       UNP-AKY-RAP SECTION.
       INI-UNP-AKY-RAP.


       FIN-UNP-AKY-RAP.
           EXIT.
       
       UNP-FLD-RAP SECTION.
       INI-UNP-FLD-RAP.

           PERFORM UNP-RAP-RAP.

       FIN-UNP-FLD-RAP.
           EXIT.
       
       UNP-RAP-RAP SECTION.
       INI-UNP-RAP-RAP.

           MOVE FRM-CPIM-UBY TO RAP-COD-ESTA-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-COD-TIPO-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-FEC-FINI-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-FEC-FTER-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN01-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN02-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN03-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN04-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN05-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN06-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN07-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN08-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN09-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IND-IN10-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-CAI-IOPC-ATR IN RAP-FLD.
           MOVE FRM-CPIM-UBY TO RAP-IIC-IOPC-ATR IN RAP-FLD.

       FIN-UNP-RAP-RAP.
           EXIT.
       
       VAL-KEY-RAP SECTION.
       INI-VAL-KEY-RAP.
           PERFORM VAL-IKY-RAP.
           PERFORM VAL-MKY-RAP.
           PERFORM VAL-AKY-RAP.
       FIN-VAL-KEY-RAP.
           EXIT.
       
       VAL-IKY-RAP SECTION.
       INI-VAL-IKY-RAP.

           PERFORM VAL-RAP-CAI-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RAP-CAI-IREC-LEN IN RAP-FLD
                GO TO FIN-VAL-IKY-RAP.
           PERFORM VAL-RAP-IIC-IREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RAP-IIC-IREC-LEN IN RAP-FLD
                GO TO FIN-VAL-IKY-RAP.
           PERFORM VAL-RAP-NUM-IRAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RAP-NUM-IRAP-LEN IN RAP-FLD
                GO TO FIN-VAL-IKY-RAP.

       FIN-VAL-IKY-RAP.
           EXIT.
       
       VAL-MKY-RAP SECTION.
       INI-VAL-MKY-RAP.


       FIN-VAL-MKY-RAP.
           EXIT.
       
       VAL-AKY-RAP SECTION.
       INI-VAL-AKY-RAP.


       FIN-VAL-AKY-RAP.
           EXIT.
       
       VAL-RAP-CAI-IREC SECTION.
       INI-VAL-RAP-CAI-IREC.

           IF RAP-CAI-IREC IN RAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RAP-CAI-IREC.


       FIN-VAL-RAP-CAI-IREC.
           EXIT.
       
       VAL-RAP-IIC-IREC SECTION.
       INI-VAL-RAP-IIC-IREC.

           IF RAP-IIC-IREC IN RAP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RAP-IIC-IREC.


       FIN-VAL-RAP-IIC-IREC.
           EXIT.
       
       VAL-RAP-NUM-IRAP SECTION.
       INI-VAL-RAP-NUM-IRAP.



       FIN-VAL-RAP-NUM-IRAP.
           EXIT.
       
       VAL-CON-KEY-RAP SECTION.
       INI-VAL-CON-KEY-RAP.

           IF     RAP-CAI-IREC IN RAP-FLD NOT > SPACES 
              AND RAP-IIC-IREC IN RAP-FLD NOT > ZEROES 
              AND RAP-NUM-IRAP IN RAP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-RAP.

       FIN-VAL-CON-KEY-RAP.
           EXIT.
       
       VAL-CON-IKY-RAP SECTION.
       INI-VAL-CON-IKY-RAP.

           IF     RAP-CAI-IREC IN RAP-FLD NOT > SPACES 
              AND RAP-IIC-IREC IN RAP-FLD NOT > ZEROES 
              AND RAP-NUM-IRAP IN RAP-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-RAP.

       FIN-VAL-CON-IKY-RAP.
           EXIT.
       
       VAL-NUM-KEY-RAP SECTION.
       INI-VAL-NUM-KEY-RAP.
           PERFORM VAL-NUM-IKY-RAP.
           PERFORM VAL-NUM-MKY-RAP.
           PERFORM VAL-NUM-AKY-RAP.
       FIN-VAL-NUM-KEY-RAP.
           EXIT.
       
       VAL-NUM-IKY-RAP SECTION.
       INI-VAL-NUM-IKY-RAP.

       VAL-NUM-RAP-IIC-IREC.
           MOVE RAP-IIC-IREC-ALF IN RAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO RAP-IIC-IREC IN RAP-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO RAP-IIC-IREC-LEN IN RAP-FLD
                GO TO FIN-VAL-NUM-IKY-RAP.
       VAL-NUM-RAP-NUM-IRAP.
           MOVE RAP-NUM-IRAP-ALF IN RAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO RAP-NUM-IRAP IN RAP-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO RAP-NUM-IRAP-LEN IN RAP-FLD
                GO TO FIN-VAL-NUM-IKY-RAP.

       FIN-VAL-NUM-IKY-RAP.
           EXIT.
       
       VAL-NUM-MKY-RAP SECTION.
       INI-VAL-NUM-MKY-RAP.


       FIN-VAL-NUM-MKY-RAP.
           EXIT.
       
       VAL-NUM-AKY-RAP SECTION.
       INI-VAL-NUM-AKY-RAP.


       FIN-VAL-NUM-AKY-RAP.
           EXIT.
       
       VAL-NUM-FLD-RAP SECTION.
       INI-VAL-NUM-FLD-RAP.


       FIN-VAL-NUM-FLD-RAP.
           EXIT.
       
       EDT-KEY-RAP SECTION.
       INI-EDT-KEY-RAP.
           PERFORM EDT-IKY-RAP.
           PERFORM EDT-MKY-RAP.
           PERFORM EDT-AKY-RAP.

       FIN-EDT-KEY-RAP.
           EXIT.
       
       EDT-IKY-RAP SECTION.
       INI-EDT-IKY-RAP.

           IF RAP-IIC-IREC-LEN IN RAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RAP-IIC-IREC-LEN IN RAP-FLD
                GO TO FIN-EDT-IKY-RAP.
           MOVE RAP-IIC-IREC IN RAP-FLD TO RAP-IIC-IREC-EDT IN RAP-EDT.
           MOVE RAP-IIC-IREC-EDT IN RAP-EDT TO 
                RAP-IIC-IREC-ALF IN RAP-FLD.
           IF RAP-NUM-IRAP-LEN IN RAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RAP-NUM-IRAP-LEN IN RAP-FLD
                GO TO FIN-EDT-IKY-RAP.
           MOVE RAP-NUM-IRAP IN RAP-FLD TO RAP-NUM-IRAP-EDT IN RAP-EDT.
           MOVE RAP-NUM-IRAP-EDT IN RAP-EDT TO 
                RAP-NUM-IRAP-ALF IN RAP-FLD.

       FIN-EDT-IKY-RAP.
           EXIT.
       
       EDT-MKY-RAP SECTION.
       INI-EDT-MKY-RAP.


       FIN-EDT-MKY-RAP.
           EXIT.
       
       EDT-AKY-RAP SECTION.
       INI-EDT-AKY-RAP.


       FIN-EDT-AKY-RAP.
           EXIT.
       
       EDT-FLD-RAP SECTION.
       INI-EDT-FLD-RAP.


       FIN-EDT-FLD-RAP.
           EXIT.



