      *
      * GRDBQQMO
      * Version 3.0.1 Nov-2005
      * 05-Jul-06 03:05 PM
      *
       SET-TAG-GRDBQQMO SECTION.
       INI-SET-TAG-GRDBQQMO.
           MOVE
           '<IDNMOD NOM=$GRDBQQMO$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$05-Jul-06 03:05 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-GRDBQQMO.
           EXIT.
           
       PUT-ALL-QMO SECTION.
       INI-PUT-ALL-QMO.
           PERFORM PUT-MOG-QMO.
       FIN-PUT-ALL-QMO.
           EXIT.
       
       PUT-MOG-QMO SECTION.
       INI-PUT-MOG-QMO.
           IF PGM-STAT-MOG-NUL
               GO TO FIN-PUT-MOG-QMO.
           IF NOT PGM-STAT-MOG-OKS
               PERFORM CLR-MOG-QMO
               GO TO FIN-PUT-MOG-QMO.
           MOVE MOG-COD-FASE IN MOG TO MOG-COD-FASE IN QMO-FLD.
           MOVE MOG-COD-ETAP IN MOG TO MOG-COD-ETAP IN QMO-FLD.
           MOVE MOG-COD-TARE IN MOG TO MOG-COD-TARE IN QMO-FLD.
           MOVE MOG-COD-ESTA IN MOG TO MOG-COD-ESTA IN QMO-FLD.
           MOVE MOG-COD-GEST IN MOG TO MOG-COD-GEST IN QMO-FLD.
           MOVE MOG-COD-CONT IN MOG TO MOG-COD-CONT IN QMO-FLD.
           MOVE MOG-COD-RESP IN MOG TO MOG-COD-RESP IN QMO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF MOG-COD-FASE IN QMO-FLD > SPACES
               MOVE 'GRD' TO TAB-COD-SIST
               MOVE 'FAS ' TO TAB-COD-TTAB IN TAB
               MOVE MOG-COD-FASE IN QMO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-FASE IN QMO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-FASE IN QMO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF MOG-COD-ETAP IN QMO-FLD > SPACES
               MOVE 'GRD' TO TAB-COD-SIST
               MOVE 'ETA ' TO TAB-COD-TTAB IN TAB
               MOVE MOG-COD-ETAP IN QMO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ETAP IN QMO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ETAP IN QMO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF MOG-COD-TARE IN QMO-FLD > SPACES
               MOVE 'GRD' TO TAB-COD-SIST
               MOVE 'TAR ' TO TAB-COD-TTAB IN TAB
               MOVE MOG-COD-TARE IN QMO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TARE IN QMO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TARE IN QMO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF MOG-COD-ESTA IN QMO-FLD > SPACES
               MOVE 'GRD' TO TAB-COD-SIST
               MOVE 'EST ' TO TAB-COD-TTAB IN TAB
               MOVE MOG-COD-ESTA IN QMO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN QMO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTA IN QMO-FLD.
       FIN-PUT-MOG-QMO.
           EXIT.
       
       KEY-ALL-QMO SECTION.
       INI-KEY-ALL-QMO.
           PERFORM KEY-MOG-QMO.
       FIN-KEY-ALL-QMO.
           EXIT.
       
       KEY-MOG-QMO SECTION.
       INI-KEY-MOG-QMO.
           MOVE MOG-COD-FASE IN QMO-FLD TO MOG-COD-FASE IN MOG.
           MOVE MOG-COD-ETAP IN QMO-FLD TO MOG-COD-ETAP IN MOG.
           MOVE MOG-COD-TARE IN QMO-FLD TO MOG-COD-TARE IN MOG.
           MOVE MOG-COD-ESTA IN QMO-FLD TO MOG-COD-ESTA IN MOG.
           MOVE MOG-COD-GEST IN QMO-FLD TO MOG-COD-GEST IN MOG.
           MOVE MOG-COD-CONT IN QMO-FLD TO MOG-COD-CONT IN MOG.
           MOVE MOG-COD-RESP IN QMO-FLD TO MOG-COD-RESP IN MOG.
       FIN-KEY-MOG-QMO.
           EXIT.
       
       SCR-CLRA-QMO SECTION.
       INI-SCR-CLRA-QMO.
           PERFORM CLR-KEY-QMO.
           PERFORM CLR-FLD-QMO.
       FIN-SCR-CLRA-QMO.
           EXIT.
       
       CLR-KEY-QMO SECTION.
       INI-CLR-KEY-QMO.
           MOVE SPACES TO MOG-COD-FASE IN QMO-FLD.
           MOVE SPACES TO MOG-COD-ETAP IN QMO-FLD.
           MOVE SPACES TO MOG-COD-TARE IN QMO-FLD.
           MOVE SPACES TO MOG-COD-ESTA IN QMO-FLD.
           MOVE SPACES TO MOG-COD-GEST IN QMO-FLD.
           MOVE SPACES TO MOG-COD-CONT IN QMO-FLD.
           MOVE SPACES TO MOG-COD-RESP IN QMO-FLD.
       FIN-CLR-KEY-QMO.
           EXIT.
       
       CLR-FLD-QMO SECTION.
       INI-CLR-FLD-QMO.
           MOVE SPACES TO FRM-GLS-FASE IN QMO-FLD.
           MOVE SPACES TO FRM-GLS-ETAP IN QMO-FLD.
           MOVE SPACES TO FRM-GLS-TARE IN QMO-FLD.
           MOVE SPACES TO FRM-GLS-ESTA IN QMO-FLD.
           MOVE SPACES TO FRM-COD-CGES IN QMO-FLD(1).
           MOVE SPACES TO FRM-COD-CGES IN QMO-FLD(2).
           MOVE SPACES TO FRM-COD-CGES IN QMO-FLD(3).
           MOVE SPACES TO FRM-COD-CGES IN QMO-FLD(4).
           MOVE SPACES TO FRM-GLS-CGES IN QMO-FLD(1).
           MOVE SPACES TO FRM-GLS-CGES IN QMO-FLD(2).
           MOVE SPACES TO FRM-GLS-CGES IN QMO-FLD(3).
           MOVE SPACES TO FRM-GLS-CGES IN QMO-FLD(4).
           MOVE SPACES TO FRM-COD-CCON IN QMO-FLD(1).
           MOVE SPACES TO FRM-COD-CCON IN QMO-FLD(2).
           MOVE SPACES TO FRM-COD-CCON IN QMO-FLD(3).
           MOVE SPACES TO FRM-COD-CCON IN QMO-FLD(4).
           MOVE SPACES TO FRM-GLS-CCON IN QMO-FLD(1).
           MOVE SPACES TO FRM-GLS-CCON IN QMO-FLD(2).
           MOVE SPACES TO FRM-GLS-CCON IN QMO-FLD(3).
           MOVE SPACES TO FRM-GLS-CCON IN QMO-FLD(4).
           MOVE SPACES TO FRM-COD-CRES IN QMO-FLD(1).
           MOVE SPACES TO FRM-COD-CRES IN QMO-FLD(2).
           MOVE SPACES TO FRM-COD-CRES IN QMO-FLD(3).
           MOVE SPACES TO FRM-COD-CRES IN QMO-FLD(4).
           MOVE SPACES TO FRM-GLS-CRES IN QMO-FLD(1).
           MOVE SPACES TO FRM-GLS-CRES IN QMO-FLD(2).
           MOVE SPACES TO FRM-GLS-CRES IN QMO-FLD(3).
           MOVE SPACES TO FRM-GLS-CRES IN QMO-FLD(4).
           PERFORM CLR-MOG-QMO.
       FIN-CLR-FLD-QMO.
           EXIT.
       
       CLR-MOG-QMO SECTION.
       INI-CLR-MOG-QMO.
       FIN-CLR-MOG-QMO.
           EXIT.
       
       FST-KEY-QMO SECTION.
       INI-FST-KEY-QMO.
           MOVE -1 TO MOG-COD-FASE-LEN IN QMO-FLD.
       FIN-FST-KEY-QMO.
           EXIT.
       
       FST-FLD-QMO SECTION.
       INI-FST-FLD-QMO.
       FIN-FST-FLD-QMO.
           EXIT.
       
       PRO-KEY-QMO SECTION.
       INI-PRO-KEY-QMO.
           PERFORM PRO-IKY-QMO.
           PERFORM PRO-AKY-QMO.
           PERFORM PRO-MKY-QMO.
       FIN-PRO-KEY-QMO.
           EXIT.
       
       PRO-IKY-QMO SECTION.
       INI-PRO-IKY-QMO.
           MOVE FRM-CPIM-AEY TO MOG-COD-FASE-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-ETAP-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-TARE-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-ESTA-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-GEST-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-CONT-ATR IN QMO-FLD.
           MOVE FRM-CPIM-AEY TO MOG-COD-RESP-ATR IN QMO-FLD.
       FIN-PRO-IKY-QMO.
           EXIT.
       
       PRO-MKY-QMO SECTION.
       INI-PRO-MKY-QMO.
       FIN-PRO-MKY-QMO.
           EXIT.
       
       PRO-AKY-QMO SECTION.
       INI-PRO-AKY-QMO.
       FIN-PRO-AKY-QMO.
           EXIT.
       
       UNP-KEY-QMO SECTION.
       INI-UNP-KEY-QMO.
           PERFORM UNP-IKY-QMO.
           PERFORM UNP-AKY-QMO.
           PERFORM UNP-MKY-QMO.
       FIN-UNP-KEY-QMO.
           EXIT.
       
       UNP-IKY-QMO SECTION.
       INI-UNP-IKY-QMO.
           MOVE FRM-CPIM-UBY TO MOG-COD-FASE-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-ETAP-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-TARE-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-ESTA-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-GEST-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-CONT-ATR.
           MOVE FRM-CPIM-UBY TO MOG-COD-RESP-ATR.
       FIN-UNP-IKY-QMO.
           EXIT.
       
       UNP-MKY-QMO SECTION.
       INI-UNP-MKY-QMO.
       FIN-UNP-MKY-QMO.
           EXIT.
       
       UNP-AKY-QMO SECTION.
       INI-UNP-AKY-QMO.
       FIN-UNP-AKY-QMO.
           EXIT.
       
       UNP-FLD-QMO SECTION.
       INI-UNP-FLD-QMO.
           PERFORM UNP-MOG-QMO.
       FIN-UNP-FLD-QMO.
           EXIT.
       
       UNP-MOG-QMO SECTION.
       INI-UNP-MOG-QMO.
       FIN-UNP-MOG-QMO.
           EXIT.
       
       VAL-KEY-QMO SECTION.
       INI-VAL-KEY-QMO.
           PERFORM VAL-IKY-QMO.
           PERFORM VAL-MKY-QMO.
           PERFORM VAL-AKY-QMO.
       FIN-VAL-KEY-QMO.
           EXIT.
       
       VAL-IKY-QMO SECTION.
       INI-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-FASE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-FASE-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-ETAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-ETAP-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-TARE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-TARE-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-ESTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-ESTA-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-GEST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-GEST-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-CONT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-CONT-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
           PERFORM VAL-MOG-COD-RESP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO MOG-COD-RESP-LEN IN QMO-FLD
                GO TO FIN-VAL-IKY-QMO.
       FIN-VAL-IKY-QMO.
           EXIT.
       
       VAL-MKY-QMO SECTION.
       INI-VAL-MKY-QMO.
       FIN-VAL-MKY-QMO.
           EXIT.
       
       VAL-AKY-QMO SECTION.
       INI-VAL-AKY-QMO.
       FIN-VAL-AKY-QMO.
           EXIT.
       
       VAL-MOG-COD-FASE SECTION.
       INI-VAL-MOG-COD-FASE.
           IF MOG-COD-FASE IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-FASE IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'FAS ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-FASE IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              MOG-COD-FASE IN QMO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-FASE IN QMO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-FASE IN QMO-FLD.
       FIN-VAL-MOG-COD-FASE.
           EXIT.
       
       VAL-MOG-COD-ETAP SECTION.
       INI-VAL-MOG-COD-ETAP.
           IF MOG-COD-ETAP IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-ETAP IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'ETA ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-ETAP IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              MOG-COD-ETAP IN QMO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ETAP IN QMO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ETAP IN QMO-FLD.
       FIN-VAL-MOG-COD-ETAP.
           EXIT.
       
       VAL-MOG-COD-TARE SECTION.
       INI-VAL-MOG-COD-TARE.
           IF MOG-COD-TARE IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-TARE IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'TAR ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-TARE IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              MOG-COD-TARE IN QMO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TARE IN QMO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TARE IN QMO-FLD.
       FIN-VAL-MOG-COD-TARE.
           EXIT.
       
       VAL-MOG-COD-ESTA SECTION.
       INI-VAL-MOG-COD-ESTA.
           IF MOG-COD-ESTA IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-ESTA IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'EST ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-ESTA IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              MOG-COD-ESTA IN QMO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ESTA IN QMO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN QMO-FLD.
       FIN-VAL-MOG-COD-ESTA.
           EXIT.
       
       VAL-MOG-COD-GEST SECTION.
       INI-VAL-MOG-COD-GEST.
           IF MOG-COD-GEST IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-GEST IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'GES ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-GEST IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-MOG-COD-GEST.
           EXIT.
       
       VAL-MOG-COD-CONT SECTION.
       INI-VAL-MOG-COD-CONT.
           IF MOG-COD-CONT IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-CONT IN QMO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GRD' TO TAB-COD-SIST.
           MOVE 'CON ' TO TAB-COD-TTAB IN TAB.
           MOVE MOG-COD-CONT IN QMO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-MOG-COD-CONT.
           EXIT.
       
       VAL-MOG-COD-RESP SECTION.
       INI-VAL-MOG-COD-RESP.
           IF MOG-COD-RESP IN QMO-FLD NOT > SPACES
              MOVE SPACES TO MOG-COD-RESP IN QMO-FLD.
       FIN-VAL-MOG-COD-RESP.
           EXIT.
       
       VAL-CON-KEY-QMO SECTION.
       INI-VAL-CON-KEY-QMO.
           IF     MOG-COD-FASE IN QMO-FLD NOT > SPACES 
              AND MOG-COD-ETAP IN QMO-FLD NOT > SPACES 
              AND MOG-COD-TARE IN QMO-FLD NOT > SPACES 
              AND MOG-COD-ESTA IN QMO-FLD NOT > SPACES 
              AND MOG-COD-GEST IN QMO-FLD NOT > SPACES 
              AND MOG-COD-CONT IN QMO-FLD NOT > SPACES 
              AND MOG-COD-RESP IN QMO-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-QMO.
       FIN-VAL-CON-KEY-QMO.
           EXIT.
       
       VAL-CON-IKY-QMO SECTION.
       INI-VAL-CON-IKY-QMO.
           IF     MOG-COD-FASE IN QMO-FLD NOT > SPACES 
              AND MOG-COD-ETAP IN QMO-FLD NOT > SPACES 
              AND MOG-COD-TARE IN QMO-FLD NOT > SPACES 
              AND MOG-COD-ESTA IN QMO-FLD NOT > SPACES 
              AND MOG-COD-GEST IN QMO-FLD NOT > SPACES 
              AND MOG-COD-CONT IN QMO-FLD NOT > SPACES 
              AND MOG-COD-RESP IN QMO-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-QMO.
       FIN-VAL-CON-IKY-QMO.
           EXIT.
       
       VAL-NUM-KEY-QMO SECTION.
       INI-VAL-NUM-KEY-QMO.
           PERFORM VAL-NUM-IKY-QMO.
           PERFORM VAL-NUM-MKY-QMO.
           PERFORM VAL-NUM-AKY-QMO.
       FIN-VAL-NUM-KEY-QMO.
           EXIT.
       
       VAL-NUM-IKY-QMO SECTION.
       INI-VAL-NUM-IKY-QMO.
       FIN-VAL-NUM-IKY-QMO.
           EXIT.
       
       VAL-NUM-MKY-QMO SECTION.
       INI-VAL-NUM-MKY-QMO.
       FIN-VAL-NUM-MKY-QMO.
           EXIT.
       
       VAL-NUM-AKY-QMO SECTION.
       INI-VAL-NUM-AKY-QMO.
       FIN-VAL-NUM-AKY-QMO.
           EXIT.
       
       VAL-NUM-FLD-QMO SECTION.
       INI-VAL-NUM-FLD-QMO.
       FIN-VAL-NUM-FLD-QMO.
           EXIT.
       
       EDT-KEY-QMO SECTION.
       INI-EDT-KEY-QMO.
           PERFORM EDT-IKY-QMO.
           PERFORM EDT-MKY-QMO.
           PERFORM EDT-AKY-QMO.
       FIN-EDT-KEY-QMO.
           EXIT.
       
       EDT-IKY-QMO SECTION.
       INI-EDT-IKY-QMO.
       FIN-EDT-IKY-QMO.
           EXIT.
       
       EDT-MKY-QMO SECTION.
       INI-EDT-MKY-QMO.
       FIN-EDT-MKY-QMO.
           EXIT.
       
       EDT-AKY-QMO SECTION.
       INI-EDT-AKY-QMO.
       FIN-EDT-AKY-QMO.
           EXIT.
       
       EDT-FLD-QMO SECTION.
       INI-EDT-FLD-QMO.
       FIN-EDT-FLD-QMO.
           EXIT.
