			LIBRO MAYOR OPERACIONES DE CREDITO
			----------------------------------


PROGRAMA     :  COLPLLMC lista reporte segun formato anexo ( 132 columnas ).


ARCHIVO BASE :  OPC (Operacion Credito) en DATACOM.
			(se recorre por llave Fecha de Curse Contable)   
		CAN (Cancelaciones)     en DATACOM.
			(se recorre por llave Fecha de Cancelacion Contable)   


TABLAS       :  - Tablas y Parametros Bancarios.

		  Descripcion de la Oficina         en tabla OFI.
		  Direccion de la Oficina           en tabla OFI.

		  Descripcion de la Cuenta Contable en tabla PCC.
		  Descripcion de la Moneda          en tabla VLR.

		- Colocaciones.

		  Indicador de Participacion en Contabilidad en tabla AUX.

		  Cuenta Contable                            en tabla DCC.


PARAMETROS   :  - Fecha de Inicio  (DDMMSSAA) : Rango Inicial para Seleccion
						de registros que intervienen
						en el reporte.

		- Fecha de Termino (DDMMSSAA) : Rango Final   para Seleccion
						de registros que intervienen
						en el reporte.


ORDENAMIENTO :  Oficina, Moneda, Cuenta Contable, Fecha Contable,
		Tipo Movimiento y CIC de Operacion.


VALIDACION DE PARMETROS :

		Se validan las fechas ingresadas como parametros.
			- fecha blanco = no
 			- no se comparan con hoy
 			- no se validan como fecha habil.

		Se valida la consistencia de las fechas ingresadas como
		parametros.

			- fecha de inicio debe ser menor o igual que fecha de
			  termino.



ALGORITMO    :  - Proceso :

		Mover 1 a switch indicador proceso para identificar los Cargos.

		Se realiza PROCESO OPC mientras Fecha Curse Contable de los
		registros esten entre fecha de inicio y fecha de termino y
		Estado del Credito Activado.

		Mover 2 a switch indicador proceso para identificar los Abonos.

		Se realiza PROCESO CAN mientras Fecha Cancelacion Contable de
		registros esten entre fecha de inicio y fecha de termino y
		Estado de la Cancelacion Activada.

		Los registros seleccionados de proceso OPC y CAN se ordenan
		para su proceso de acuerdo al criterio de ordenamiento del
		reporte.

			Oficina, Moneda, Cuenta Contable, Fecha Contable,
			Tipo Movimiento y CIC de Operacion.

		Se despliegan los contadores del Proceso Selectivo.

		A partir del registro OPC o CAN seleccionado se procesan :

			RDC : Relacion Deudor Credito.

			DBC : Datos Basicos del Cliente.

		Para cada registro seleccionado se extraen las glosas, mediante
		los codigos, en las tablas respectivas.

		Se llena con ceros el campo Numero Folio.

		Con el CIC de la Operacion del registro seleccionado se obtiene
		el CIC del Deudor Directo en RDC.

		Con el CIC del Cliente en RDC se obtienen los Datos del Cliente
		en DBC.

		Las cantidades de Cargos y Abonos y los montos de Debe y Haber
		se acumulan, y se imprimen al producirse un cambio en la Fecha
		de Movimiento (Fecha Contable).

		Al producirse un cambio de Oficina, Moneda o Cuenta Contable
		se efectua un corte cambiando de pagina en el reporte.



		- Proceso OPC :

		A partir del registro OPC seleccionado se procesan :

			DLC : Documento Legal Credito.

			DCC : Diccionario Cuentas Contables.

			MCT : Movimientos Contabilidad.

		Se incrementa contador de Registros OPC Leidos por cada lectura
		de OPC exitosa.

		Mover Fecha Curse Contable a Fecha Movimientos en registro Sort.

		Con el CIC de la Operacion en OPC se obtienen los Datos de los
		Documentos de Credito asociados a la operacion en DLC.

		Se incrementa contador de Registros Procesados por cada lectura
		de DLC exitosa.

		Mediante Campos en OPC y DLC, ademas de Indicador Participacion
		en Contabilidad en tabla AUX, se forma llave COD-CCTB y se
		extrae la Cuenta Contable en DCC.

		Se incrementa contador de Registros Rechazados si lectura de DCC
		no es exitosa.

		Se mueve el Valor Nominal Documento Legal al Debe.

		Realizar Proceso Generico.



		- Proceso CAN :

		A partir del registro CAN seleccionado se procesan :

			RCV : Relacion Cancelacion Vencimientos.

			OPC : Operacion Credito.

			DLC : Documento Legal Credito.

			DCC : Diccionario Cuentas Contables.

			MCT : Movimientos Contabilidad.

		Se incrementa contador de Registros CAN Leidos por cada lectura
		de CAN exitosa.

		Mover Fecha Cancelacion Contable a Fecha Movimientos en
		registro Sort.

		Con la Identificacion de la Cancelacion en CAN se obtienen los
		Datos de los Vencimientos Asociados en RCV.

		Con el CIC de la Operacion de Credito de la Identificacion de
		Vencimiento en RCV se obtienen los Datos de la Operacion de
		Credito en OPC.

		Con la Identificacion del Documento Asociado en RCV se obtienen
		los Datos del Documento Legal de Credito en DLC.

		Se incrementa contador de Registros Procesados por cada lectura
		de RCV, OPC y DLC exitosa.

		Mediante Campos en OPC, DLC y RCV, ademas de Indicador de
		Participacion en Contabilidad en tabla AUX, se forma llave
		COD-CCTB y se extrae la Cuenta Contable en DCC.

		Se incrementa contador de Registros Rechazados si lectura de DCC
		no es exitosa.

		Se mueve Numero Identificacion Vencimiento, y segun el signo el
		Valor Capital Cancelado al Haber o Debe.

		Realizar Proceso Generico.


		- Proceso Generico :

		Se llenan campos y se graba registro de archivo MCT tipo SAM,
		segun documento adjunto (registro).

		Se incrementa contador de Registros MCT Grabados si grabacion
		de MCT es exitosa, en caso contrario se incrementa contador de
		Registros No Grabados.




      *    Movimientos Contabilidad
      *    ------------------------
      *    Nombre Registro : MCT
      *    Largo           : 080
      *    Bloqueo         : 12 ( Bloque = 960 )
      *
       01  MCT. 
      *
      *    ( 1 = DEBE, 2 = HABER )
      *    Tipo Documento
           03  MCT-IND-TDOC                             PIC X(01).
      *
      *    ( OPC-COD-OFOC o CAN-COD-OFCA )
      *    Oficina
           03  MCT-COD-OFIC                             PIC X(03).
      *
      *    ( DCC-GLS-CCSB )
      *    Cuenta Contable
           03  MCT-GLS-ICTA                             PIC X(09).
      *
      *    ( 00 MCH )
      *    Codigo Moneda
           03  MCT-COD-MONE                             PIC X(02).
      *
      *    ( SPACES )
      *    Filler
           03  MCT-GLS-FILL                             PIC X(01).
      *
      *    ( DLC-VAL-NDLC o RCV-SGV-CAPI )
      *    Valor Movimiento
           03  MCT-VAL-MOVI                             PIC 9(13)V9(02).
      *
      *    ( SPACES )
      *    Identificacion Documento
           03  MCT-GLS-IDOC                             PIC X(06).
      *
      *    ( SPACES )
      *    Glosa Movimiento
           03  MCT-GLS-MOVI                             PIC X(30).
      *
      *    ( SPACES )
      *    Glosa Disponible
           03  MCT-GLS-DISP                             PIC X(13).
