       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    COLPGLMY.
       AUTHOR.        CONSIST.

      *Empaqueta archivo COLLMZ en COLLMC

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY COLBRLMZ.
       COPY COLBRLMC.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM OPEN-FILE.
           PERFORM PROCESO.
           PERFORM CLOSE-FILE.
       FIN-MAIN.
           STOP RUN.

       OPEN-FILE SECTION.
       INI-OPEN-FILE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-LMZ.
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-LMC.
       FIN-OPEN-FILE.
           EXIT.

       PROCESO SECTION.
       INI-PROCESO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LMZ
           IF NOT FIO-STAT-OKS
               GO TO FIN-PROCESO.
           MOVE LMZ-COD-MVTO IN LMZ TO LMC-COD-MVTO IN LMC.
           MOVE LMZ-IND-TCYA IN LMZ TO LMC-IND-TCYA IN LMC.
           MOVE LMZ-IND-TIFZ IN LMZ TO LMC-IND-TIFZ IN LMC.
           MOVE LMZ-FEC-FPRO IN LMZ TO LMC-FEC-FPRO IN LMC.
           MOVE LMZ-COD-VCOC IN LMZ TO LMC-COD-VCOC IN LMC.
           MOVE LMZ-COD-OFOC IN LMZ TO LMC-COD-OFOC IN LMC.
           MOVE LMZ-COD-CCST IN LMZ TO LMC-COD-CCST IN LMC.
           MOVE LMZ-COD-COOC IN LMZ TO LMC-COD-COOC IN LMC.
           MOVE LMZ-FEC-FCTB IN LMZ TO LMC-FEC-FCTB IN LMC.
           MOVE LMZ-SGV-ICTB IN LMZ TO LMC-SGV-ICTB IN LMC.
           MOVE LMZ-IND-RVDB IN LMZ TO LMC-IND-RVDB IN LMC.
           MOVE LMZ-COD-OGEN IN LMZ TO LMC-COD-OGEN IN LMC.
           MOVE LMZ-CIC-IOPC IN LMZ TO LMC-CIC-IOPC IN LMC.
           MOVE LMZ-NUM-IDLC IN LMZ TO LMC-NUM-IDLC IN LMC.
           MOVE LMZ-NUM-IVCT IN LMZ TO LMC-NUM-IVCT IN LMC.
           MOVE LMZ-SGV-SCRE IN LMZ TO LMC-SGV-SCRE IN LMC.
           MOVE LMZ-CIC-ICYA IN LMZ TO LMC-CIC-ICYA IN LMC.
           MOVE LMZ-NUM-ICAN IN LMZ TO LMC-NUM-ICAN IN LMC.
           MOVE LMZ-MSC-MCAN IN LMZ TO LMC-MSC-MCAN IN LMC.
           MOVE LMZ-KEY-IDLO IN LMZ TO LMC-KEY-IDLO IN LMC.
           MOVE LMZ-MSC-TCCT IN LMZ TO LMC-MSC-TCCT IN LMC.
           MOVE LMZ-COD-ODES IN LMZ TO LMC-COD-ODES IN LMC.
           MOVE LMZ-NUM-CCAP IN LMZ TO LMC-NUM-CCAP IN LMC.
           MOVE LMZ-CIC-CCSB IN LMZ TO LMC-CIC-CCSB IN LMC.
           MOVE LMZ-IND-DBHB IN LMZ TO LMC-IND-DBHB IN LMC.
           MOVE LMZ-COD-CATE IN LMZ TO LMC-COD-CATE IN LMC.
           MOVE LMZ-CIC-TCDC IN LMZ TO LMC-CIC-TCDC IN LMC.
           MOVE LMZ-VAL-AIVA IN LMZ TO LMC-VAL-AIVA IN LMC.
           MOVE LMZ-VAL-TIMP IN LMZ TO LMC-VAL-TIMP IN LMC.
           MOVE LMZ-VAL-MCAL IN LMZ TO LMC-VAL-MCAL IN LMC.
           MOVE LMZ-VAL-VREN IN LMZ TO LMC-VAL-VREN IN LMC.
           MOVE LMZ-NUM-ADIC IN LMZ TO LMC-NUM-ADIC IN LMC.
           MOVE LMZ-COD-OORE IN LMZ TO LMC-COD-OORE IN LMC.
           MOVE LMZ-COD-ODRE IN LMZ TO LMC-COD-ODRE IN LMC.
           MOVE LMZ-COD-MPPI IN LMZ TO LMC-COD-MPPI IN LMC.
           MOVE LMZ-COD-OPPI IN LMZ TO LMC-COD-OPPI IN LMC.
           MOVE LMZ-GLS-DISP IN LMZ TO LMC-GLS-DISP IN LMC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-LMC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL GRABAR; STATUS : ' FIO-STAT
                       '. EN REGISTRO : ' LMC.
           GO TO INI-PROCESO.
       FIN-PROCESO.
           EXIT.

       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-LMZ.
           PERFORM COL-FIO-LMC.
       FIN-CLOSE-FILE.
           EXIT.

       COPY COLBFLMZ.
       COPY COLBFLMC.
