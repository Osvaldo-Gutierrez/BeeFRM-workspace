       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    COLPRCIN.
       AUTHOR.        CONSIST.

      *Prueba rutina calculo intereses

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
       COPY COLBRICG.
       01  WSS-VARI.
           03 WSS-SREV                     VALUE "[7m" PIC X(04).
           03 WSS-NREV                     VALUE "[0m" PIC X(04).
           03 WSS-FFEC.
              05 WSS-AFEC                         PIC X(02).
              05 WSS-MFEC                         PIC X(02).
              05 WSS-DFEC                         PIC X(02).
           03 WSS-HHOY                            PIC 9(08).
           03 WSS-HHOY-RED REDEFINES WSS-HHOY.
              05 WSS-HHHY                         PIC 9(02).
              05 WSS-MMHY                         PIC 9(02).
              05 WSS-SSHY                         PIC 9(02).
              05 WSS-CCHY                         PIC 9(02).
           03 WSS-TIPE                            PIC 9(06)V9(08).
           03 WSS-TIPE-EDT REDEFINES WSS-TIPE     PIC ZZZZ9,99999999.
      *
       01  WSS-VINT.
      *
      *    Opera Como (P,C,D,B)
           03  WSS-OPEC                         PIC X(01).
      *
      *    Tipo Tasa 
           03  WSS-TIPT.
      *
      *            Base Calculo ( Anticipada, Vencida )
               05  WSS-BCTI                     PIC X(01).
      *
      *            Base Calculo ( D,M,A,T,N,C,X,Y,Z )
               05  WSS-PBTI                     PIC X(01).
      *
      *            Modo Calculo bajo Periodo Base ( Simple, Compuesto )
               05  WSS-BPBT                     PIC X(01).
      *
      *            Modo Calculo Sobre Pdo Base ( S, C )
               05  WSS-SPBT                     PIC X(01).
      *
      *            Tipo Valor Tasa Interes
      *            WSS-TVTI = "I"               PIC X(01).
      *
      *            Codigo Valor Tasa Interes ( Tasa Variable )
               05  WSS-CVTI                     PIC X(03).
      *
      *            Tipo Cambio Tasa Interes                   
      *            WSS-TCTI = WSS-PBTI          PIC X(02).
      *
      *            Tipo Fecha Periodo de Repacto ( C, F, A )
               05  WSS-TFPR                     PIC X(01).
      *
      *            Periodo de Repacto
               05  WSS-PREP                     PIC 9(03).
      *
      *            Unidad de Tiempo Periodo Repacto ( D, M, A )
               05  WSS-UTPR                     PIC X(01).
      *
      *    Fecha del Interes
           03  WSS-FINT.
               05  WSS-SDMA                     PIC 9(02).
               05  WSS-ADMA                     PIC 9(02).
               05  WSS-MDMA                     PIC 9(02).
               05  WSS-DDMA                     PIC 9(02).
      *
      *    Fecha del Interes
           03  WSS-FBTV.
               05  WSS-DBTV                     PIC 9(02).
               05  WSS-MBTV                     PIC 9(02).
               05  WSS-SBTV                     PIC 9(02).
               05  WSS-ABTV                     PIC 9(02).
      *
      *    Fecha Inicio Periodo
           03 WSS-FUNO.
              05 WSS-DUNO                       PIC 9(02).
              05 WSS-MUNO                       PIC 9(02).
              05 WSS-SUNO                       PIC 9(02).
              05 WSS-AUNO                       PIC 9(02).
      *
      *    Fecha Termino Periodo
           03 WSS-FDOS.
              05 WSS-DDOS                       PIC 9(02).
              05 WSS-MDOS                       PIC 9(02).
              05 WSS-SDOS                       PIC 9(02).
              05 WSS-ADOS                       PIC 9(02).
      *
      *    Fecha Colocacion
           03 WSS-FCOL.
              05 WSS-DCOL                       PIC 9(02).
              05 WSS-MCOL                       PIC 9(02).
              05 WSS-SCOL                       PIC 9(02).
              05 WSS-ACOL                       PIC 9(02).
      *    Indicador analisis de Feriados
           03 WSS-AFER                VALUE 'N' PIC X(01).
              88  WSS-AFER-YES        VALUE 'S'.
      *
      *    Valor de Cambio
           03  WSS-VCAM.
      *            Tipo Valor
               05  CAM-MSC-TVAL                 PIC X(01).
      *            Codigo Valor
               05  CAM-COD-CVAL                 PIC X(03).
      *            Tipo Cambio
               05  CAM-COD-TCAM                 PIC X(02).
      *
      *	   Mensaje
           03  WSS-MENS.
               05  WSS-MEN1                     PIC X(40).
               05  WSS-MEN2                     PIC X(39).
      *
      *    Separacion
           03  WSS-SEPA                         PIC 9(05).
      *
      *    Unidad Separacion ( D,M,A )
           03  WSS-IPER                         PIC X(01).
      *
      *    Modalidad de Calculo Tasa Interes
           03  WSS-MCTI                         PIC X(01).
      *
      *    Separaciones de trabajo
           03  WSS-SDIA                         PIC 9(05).
           03  WSS-S30D                         PIC 9(04).
      *JSS 03  WSS-SMES                         PIC 9(04).
           03  WSS-S360                         PIC 9(04).
      *JSS 03  WSS-SANO                         PIC 9(04).
      *
      *    Tasa Interes Informada
           03  WSS-TINT                         PIC 9(03)V9(07) COMP.
      *
      *    Tasas de trabajo
           03  WSS-TDIA                         PIC 9(01)V9(09) COMP.
           03  WSS-T30D                         PIC 9(01)V9(09) COMP.
      *JSS 03  WSS-TMES                         PIC 9(01)V9(09) COMP.
      *JSS 03  WSS-TANO                         PIC 9(01)V9(09) COMP.
           03  WSS-T360                         PIC 9(01)V9(09) COMP.
      *
           03 WSS-FINI.
              05 WSS-DINI                         PIC 9(02).
              05 WSS-MINI                         PIC 9(02).
              05 WSS-SINI                         PIC 9(02).
              05 WSS-AINI                         PIC 9(02).
           03 WSS-FTER.
              05 WSS-DTER                         PIC 9(02).
              05 WSS-MTER                         PIC 9(02).
              05 WSS-STER                         PIC 9(02).
              05 WSS-ATER                         PIC 9(02).
           03 WSS-IDSP                  VALUE 'S' PIC X(01).
              88 WSS-IDSP-YES           VALUE 'S' ' '.
           03 WSS-CONT                  VALUE 0   PIC 9(03).
           03 WSS-IOPC                            PIC X(12).
           03 WSS-IDLC                            PIC 9(03).
      *===================================================================

       COPY GNSWGFEC.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSBRMSG.
       COPY GNSWGHOY.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
      *
       COPY TABBRCAM.
      *
       COPY COLWGINT.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           DISPLAY 'Digite Operacion              : ' WITH NO ADVANCING.
           ACCEPT WSS-IOPC.
           IF WSS-IOPC > SPACES
               MOVE WSS-IOPC TO INT-IOPC.

           DISPLAY 'Digite Numero de Documento    : ' WITH NO ADVANCING.
           ACCEPT WSS-IDLC WITH CONVERSION.
           IF WSS-IDLC > ZEROES
               MOVE WSS-IDLC TO INT-IDLC.

           DISPLAY 'Digite Fecha Colocacion       : ' WITH NO ADVANCING.
           ACCEPT WSS-FCOL.
           IF WSS-FCOL > ZEROES
               MOVE WSS-FCOL TO INT-FCOL.

           DISPLAY 'Digite Fecha Inicial Periodo  : ' WITH NO ADVANCING.
           ACCEPT WSS-FUNO.
           IF WSS-FUNO > ZEROES
               MOVE WSS-FUNO TO INT-FUNO.

           DISPLAY 'Digite Fecha Final   Periodo  : ' WITH NO ADVANCING.
           ACCEPT WSS-FDOS.
           IF WSS-FDOS > ZEROES
               MOVE WSS-FDOS TO INT-FDOS.

           DISPLAY 'Digite Fecha Base T.Variable  : ' WITH NO ADVANCING.
           ACCEPT WSS-FBTV.
           IF WSS-FBTV > ZEROES
               MOVE WSS-FBTV TO INT-FBTV.

           PERFORM COL-CAL-INT.
           IF INT-CMSG > SPACES
               DISPLAY 'INT-CMSG : ' INT-CMSG
               DISPLAY 'INT-MENS : ' INT-MENS
           ELSE
               DISPLAY WSS-SREV 'INT-TIPE : ' INT-TIPE WITH CONVERSION
                       WSS-NREV.
           GO TO INI-MAIN.
       FIN-MAIN.
           STOP RUN.

       COPY COLBGINT.
      *
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGSYS.

       GET-FHOY SECTION.
       INI-GET-FHOY.
           ACCEPT WSS-FFEC FROM DATE.
           MOVE '19'     TO HOY-SHOY.
           MOVE WSS-AFEC TO HOY-AHOY.
           MOVE WSS-MFEC TO HOY-MHOY.
           MOVE WSS-DFEC TO HOY-DHOY.
           ACCEPT WSS-HHOY FROM TIME.
           MOVE WSS-HHHY TO HOY-HHHY.
           MOVE WSS-MMHY TO HOY-MMHY.
           MOVE WSS-SSHY TO HOY-SSHY.
       FIN-GET-FHOY.
           EXIT.

       GNS-FIO-TAB SECTION.
       INI-GNS-FIO-TAB.
           MOVE 'N' TO TAB-IND-VIGE IN TAB.
       FIN-GNS-FIO-TAB.
           EXIT.

       GNS-FIO-MSC SECTION.
       INI-GNS-FIO-MSC.
           MOVE MSC-COD-CMSC IN MSC TO MSC-CIC-CMSC IN MSC.
           MOVE '00' TO FIO-STAT.
       FIN-GNS-FIO-MSC.
           EXIT.

       GET-MSG SECTION.
       INI-GET-MSG.
           MOVE MSG-COD-MENS TO MSG-GLS-DESC.
       FIN-GET-MSG.
           EXIT.

       TAB-FIO-CAM SECTION.
       INI-TAB-FIO-CAM.
           MOVE '00' TO FIO-STAT.
           DISPLAY 'INGRESE VALOR DE CAMBIO PARA: ' CAM-KEY-CAMB IN CAM.
           ACCEPT CAM-SGV-VCAM IN CAM WITH CONVERSION.
           IF CAM-SGV-VCAM IN CAM = ZEROES
               MOVE '23' TO FIO-STAT
               GO TO FIN-TAB-FIO-CAM.
           DISPLAY 'INGRESE STATUS PARA: ' CAM-KEY-CAMB IN CAM.
           ACCEPT CAM-MSC-STAT IN CAM WITH CONVERSION.
       FIN-TAB-FIO-CAM.
           EXIT.
       
       COL-FIO-ICG SECTION.
       INI-COL-FIO-ICG.
           MOVE '00' TO FIO-STAT.
           DISPLAY 'INGRESE FECHA PARA ICG : '.
           ACCEPT ICG-FEC-FINI IN ICG.
           IF ICG-FEC-FINI IN ICG = SPACES
               MOVE '23' TO FIO-STAT
               GO TO FIN-COL-FIO-ICG.
           DISPLAY 'INGRESE TIPO TASA PARA ICG: '.
           ACCEPT ICG-COD-TINT IN ICG.
           DISPLAY 'INGRESE      TASA PARA ICG: '.
           ACCEPT ICG-SGV-TINT IN ICG WITH CONVERSION.
           MOVE   ICG-SGV-TINT IN ICG TO ICG-SGV-SPRD IN ICG.
       FIN-COL-FIO-ICG.
           EXIT.
