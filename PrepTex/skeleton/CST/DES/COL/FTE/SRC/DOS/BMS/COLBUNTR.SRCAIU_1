      * 28-Jul-93 04:55 PM
       RET-ALL-NTR SECTION.
       INI-RET-ALL-NTR.
           PERFORM KEY-ALL-NTR.
           PERFORM RET-NTR-NTR.
       FIN-RET-ALL-NTR.
           EXIT.
       
       RET-NTR-NTR SECTION.
       INI-RET-NTR-NTR.
           MOVE NTR-CIC-GNOT IN NTR-FLD TO NTR-CIC-GNOT IN NTR.
           MOVE NTR-IND-VIGE IN NTR-FLD TO NTR-IND-VIGE IN NTR.
           MOVE NTR-NUM-DTRN IN NTR-FLD TO NTR-NUM-DTRN IN NTR.
           MOVE NTR-NUM-MTRN IN NTR-FLD TO NTR-NUM-MTRN IN NTR.
           MOVE NTR-NUM-STRN IN NTR-FLD TO NTR-NUM-STRN IN NTR.
           MOVE NTR-NUM-ATRN IN NTR-FLD TO NTR-NUM-ATRN IN NTR.
           MOVE NTR-GLS-CCTE IN NTR-FLD TO NTR-GLS-CCTE IN NTR.
           MOVE NTR-VAL-GNOT IN NTR-FLD TO NTR-VAL-GNOT IN NTR.
       FIN-RET-NTR-NTR.
           EXIT.
       
       KEY-ALL-NTR SECTION.
       INI-KEY-ALL-NTR.
           PERFORM KEY-NTR-NTR.
       FIN-KEY-ALL-NTR.
           EXIT.
       
       KEY-NTR-NTR SECTION.
       INI-KEY-NTR-NTR.
           MOVE NTR-COD-NOTA IN NTR-FLD TO NTR-COD-NOTA IN NTR.
           MOVE NTR-COD-OFIC IN NTR-FLD TO NTR-COD-OFIC IN NTR.
           MOVE NTR-COD-TDOC IN NTR-FLD TO NTR-COD-TDOC IN NTR.
       FIN-KEY-NTR-NTR.
           EXIT.
       
       SCR-CLRA-NTR SECTION.
       INI-SCR-CLRA-NTR.
           PERFORM CLR-KEY-NTR.
           PERFORM CLR-FLD-NTR.
       FIN-SCR-CLRA-NTR.
           EXIT.
       
       CLR-KEY-NTR SECTION.
       INI-CLR-KEY-NTR.
           MOVE SPACES TO NTR-COD-NOTA IN NTR-FLD.
           MOVE SPACES TO NTR-COD-OFIC IN NTR-FLD.
           MOVE SPACES TO NTR-COD-TDOC IN NTR-FLD.
       FIN-CLR-KEY-NTR.
           EXIT.
       
       CLR-FLD-NTR SECTION.
       INI-CLR-FLD-NTR.
           MOVE SPACES TO FRM-GLS-NOTA IN NTR-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN NTR-FLD.
           MOVE SPACES TO FRM-GLS-TDOC IN NTR-FLD.
           PERFORM CLR-NTR-NTR.
       FIN-CLR-FLD-NTR.
           EXIT.
       
       CLR-NTR-NTR SECTION.
       INI-CLR-NTR-NTR.
           MOVE SPACES TO NTR-CIC-GNOT IN NTR-FLD.
           MOVE SPACES TO NTR-IND-VIGE IN NTR-FLD.
           MOVE SPACES TO NTR-FEC-FTRN IN NTR-FLD.
           MOVE SPACES TO NTR-GLS-CCTE IN NTR-FLD.
           MOVE ZEROES TO NTR-VAL-GNOT IN NTR-FLD.
       FIN-CLR-NTR-NTR.
           EXIT.
       
       FST-KEY-NTR SECTION.
       INI-FST-KEY-NTR.
           MOVE -1 TO NTR-COD-NOTA-LEN IN NTR-FLD.
       FIN-FST-KEY-NTR.
           EXIT.
       
       FST-FLD-NTR SECTION.
       INI-FST-FLD-NTR.
           MOVE -1 TO NTR-CIC-GNOT-LEN IN NTR-FLD.
       FIN-FST-FLD-NTR.
           EXIT.
       
       PRO-KEY-NTR SECTION.
       INI-PRO-KEY-NTR.
           PERFORM PRO-MKY-NTR.
       FIN-PRO-KEY-NTR.
           EXIT.
       
       PRO-MKY-NTR SECTION.
       INI-PRO-MKY-NTR.
       FIN-PRO-MKY-NTR.
           EXIT.
       
       PRO-FLD-NTR SECTION.
       INI-PRO-FLD-NTR.
           PERFORM PRO-NTR-NTR.
       FIN-PRO-FLD-NTR.
           EXIT.
       
       PRO-NTR-NTR SECTION.
       INI-PRO-NTR-NTR.
           MOVE FRM-CPIM-AEY TO NTR-CIC-GNOT-ATR IN NTR-FLD.
           MOVE FRM-CPIM-AEY TO NTR-IND-VIGE-ATR IN NTR-FLD.
           MOVE FRM-CPIM-AEY TO NTR-GLS-CCTE-ATR IN NTR-FLD.
           MOVE FRM-CPIM-AEY TO NTR-VAL-GNOT-ATR IN NTR-FLD.
       FIN-PRO-NTR-NTR.
           EXIT.
       
       UNP-KEY-NTR SECTION.
       INI-UNP-KEY-NTR.
           PERFORM UNP-IKY-NTR.
           PERFORM UNP-AKY-NTR.
           PERFORM UNP-MKY-NTR.
       FIN-UNP-KEY-NTR.
           EXIT.
       
       UNP-IKY-NTR SECTION.
       INI-UNP-IKY-NTR.
           MOVE FRM-CPIM-UBY TO NTR-COD-NOTA-ATR.
           MOVE FRM-CPIM-UBY TO NTR-COD-OFIC-ATR.
           MOVE FRM-CPIM-UBY TO NTR-COD-TDOC-ATR.
       FIN-UNP-IKY-NTR.
           EXIT.
       
       UNP-MKY-NTR SECTION.
       INI-UNP-MKY-NTR.
       FIN-UNP-MKY-NTR.
           EXIT.
       
       UNP-AKY-NTR SECTION.
       INI-UNP-AKY-NTR.
       FIN-UNP-AKY-NTR.
           EXIT.
       
       UNP-FLD-NTR SECTION.
       INI-UNP-FLD-NTR.
           PERFORM UNP-NTR-NTR.
       FIN-UNP-FLD-NTR.
           EXIT.
       
       UNP-NTR-NTR SECTION.
       INI-UNP-NTR-NTR.
           MOVE FRM-CPIM-UBY TO NTR-CIC-GNOT-ATR IN NTR-FLD.
           MOVE FRM-CPIM-UBY TO NTR-IND-VIGE-ATR IN NTR-FLD.
           MOVE FRM-CPIM-UBY TO NTR-GLS-CCTE-ATR IN NTR-FLD.
           MOVE FRM-CPIM-UBY TO NTR-VAL-GNOT-ATR IN NTR-FLD.
       FIN-UNP-NTR-NTR.
           EXIT.
       
       VAL-MKY-NTR SECTION.
       INI-VAL-MKY-NTR.
       FIN-VAL-MKY-NTR.
           EXIT.
       
       VAL-FLD-NTR SECTION.
       INI-VAL-FLD-NTR.
           PERFORM VAL-FRM-GLS-NOTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-NOTA-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFIC-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-FRM-GLS-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TDOC-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-NTR-CIC-GNOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO NTR-CIC-GNOT-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-NTR-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO NTR-IND-VIGE-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-NTR-FEC-FTRN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO NTR-FEC-FTRN-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-NTR-GLS-CCTE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO NTR-GLS-CCTE-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
           PERFORM VAL-NTR-VAL-GNOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO NTR-VAL-GNOT-LEN IN NTR-FLD
                GO TO FIN-VAL-FLD-NTR.
       FIN-VAL-FLD-NTR.
           EXIT.
       
       VAL-FRM-GLS-NOTA SECTION.
       INI-VAL-FRM-GLS-NOTA.
       FIN-VAL-FRM-GLS-NOTA.
           EXIT.
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-FRM-GLS-TDOC SECTION.
       INI-VAL-FRM-GLS-TDOC.
       FIN-VAL-FRM-GLS-TDOC.
           EXIT.
       
       VAL-NTR-CIC-GNOT SECTION.
       INI-VAL-NTR-CIC-GNOT.
           IF NTR-CIC-GNOT IN NTR-FLD NOT > SPACES
              MOVE SPACES TO NTR-CIC-GNOT IN NTR-FLD.
      *<<<< NTR_CIC_GNOT
           IF NTR-CIC-GNOT IN NTR-FLD NOT > SPACES
               MOVE NTR-COD-NOTA IN NTR-FLD TO WSS-CIC-NOTA
               MOVE NTR-COD-OFIC IN NTR-FLD TO WSS-CIC-OFIC
               MOVE NTR-COD-TDOC IN NTR-FLD TO WSS-CIC-TDOC
               MOVE WSS-CIC-GNOT TO NTR-CIC-GNOT IN NTR-FLD.
      *>>>>
       FIN-VAL-NTR-CIC-GNOT.
           EXIT.
       
       VAL-NTR-IND-VIGE SECTION.
       INI-VAL-NTR-IND-VIGE.
           IF NTR-IND-VIGE IN NTR-FLD NOT > SPACES
              MOVE SPACES TO NTR-IND-VIGE IN NTR-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'VIGE' TO MSC-COD-TMSC IN MSC.
           MOVE NTR-IND-VIGE IN NTR-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-NTR-IND-VIGE.
           EXIT.
       
       VAL-NTR-FEC-FTRN SECTION.
       INI-VAL-NTR-FEC-FTRN.
           IF NTR-FEC-FTRN IN NTR-FLD NOT > ZEROES
              MOVE ZEROES TO NTR-FEC-FTRN IN NTR-FLD.
       FIN-VAL-NTR-FEC-FTRN.
           EXIT.
       
       VAL-NTR-GLS-CCTE SECTION.
       INI-VAL-NTR-GLS-CCTE.
           IF NTR-GLS-CCTE IN NTR-FLD NOT > SPACES
              MOVE SPACES TO NTR-GLS-CCTE IN NTR-FLD.
      *<<<< NTR_GLS_CCTE
           IF NTR-GLS-CCTE IN NTR-FLD NOT > SPACES
               MOVE SPACES TO NTR-GLS-CCTE IN NTR-FLD
               GO TO FIN-VAL-NTR-GLS-CCTE.
      * Busca datos en registro TAB.
           MOVE 'TAB'        TO FIO-SIST.
           MOVE 'NOT'        TO TAB-COD-TTAB IN TAB.
           MOVE NTR-COD-NOTA IN NTR-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB TO IVB.
      * Busca CIC en DBC con IDC.
           MOVE IVB-IDC-IIVB IN IVB TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      * Verifica en RCO si existe CTA CTE.
           MOVE DBC-CIC-ICLI IN DBC     TO RCO-CIC-ICLI IN RCO.
           MOVE NTR-GLS-CCTE IN NTR-FLD TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE NTR-GLS-CCTE IN NTR-FLD TO RCO-CIC-IOPE IN RCO
               MOVE 'RCO-KEY-IOPE' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCO
               IF NOT FIO-STAT-OKS
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'GLSCCTENEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-NTR-GLS-CCTE
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'GLSCCTENNOTC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-NTR-GLS-CCTE.
           EXIT.
       
       VAL-NTR-VAL-GNOT SECTION.
       INI-VAL-NTR-VAL-GNOT.
           IF NTR-VAL-GNOT IN NTR-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-NTR-VAL-GNOT.
       FIN-VAL-NTR-VAL-GNOT.
           EXIT.
       
       VAL-CON-FLD-NTR SECTION.
       INI-VAL-CON-FLD-NTR.
       FIN-VAL-CON-FLD-NTR.
           EXIT.
       
       VAL-CON-NTR SECTION.
       INI-VAL-CON-NTR.
       FIN-VAL-CON-NTR.
           EXIT.
       
       VAL-NUM-KEY-NTR SECTION.
       INI-VAL-NUM-KEY-NTR.
           PERFORM VAL-NUM-IKY-NTR.
           PERFORM VAL-NUM-MKY-NTR.
           PERFORM VAL-NUM-AKY-NTR.
       FIN-VAL-NUM-KEY-NTR.
           EXIT.
       
       VAL-NUM-IKY-NTR SECTION.
       INI-VAL-NUM-IKY-NTR.
       FIN-VAL-NUM-IKY-NTR.
           EXIT.
       
       VAL-NUM-MKY-NTR SECTION.
       INI-VAL-NUM-MKY-NTR.
       FIN-VAL-NUM-MKY-NTR.
           EXIT.
       
       VAL-NUM-AKY-NTR SECTION.
       INI-VAL-NUM-AKY-NTR.
       FIN-VAL-NUM-AKY-NTR.
           EXIT.
       
       VAL-NUM-FLD-NTR SECTION.
       INI-VAL-NUM-FLD-NTR.
       VAL-NUM-NTR-VAL-GNOT.
           MOVE NTR-VAL-GNOT-ALF IN NTR-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO NTR-VAL-GNOT IN NTR-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO NTR-VAL-GNOT-LEN IN NTR-FLD
                GO TO FIN-VAL-NUM-FLD-NTR.
       FIN-VAL-NUM-FLD-NTR.
           EXIT.
       
       EDT-KEY-NTR SECTION.
       INI-EDT-KEY-NTR.
           PERFORM EDT-IKY-NTR.
           PERFORM EDT-MKY-NTR.
           PERFORM EDT-AKY-NTR.
       FIN-EDT-KEY-NTR.
           EXIT.
       
       EDT-IKY-NTR SECTION.
       INI-EDT-IKY-NTR.
       FIN-EDT-IKY-NTR.
           EXIT.
       
       EDT-MKY-NTR SECTION.
       INI-EDT-MKY-NTR.
       FIN-EDT-MKY-NTR.
           EXIT.
       
       EDT-AKY-NTR SECTION.
       INI-EDT-AKY-NTR.
       FIN-EDT-AKY-NTR.
           EXIT.
       
       EDT-FLD-NTR SECTION.
       INI-EDT-FLD-NTR.
           IF NTR-VAL-GNOT-LEN IN NTR-FLD = -9
                MOVE -1 TO NTR-VAL-GNOT-LEN IN NTR-FLD
                GO TO FIN-EDT-FLD-NTR.
           MOVE NTR-VAL-GNOT IN NTR-FLD TO NTR-VAL-GNOT-EDT IN NTR-EDT.
           MOVE NTR-VAL-GNOT-EDT IN NTR-EDT TO 
                NTR-VAL-GNOT-ALF IN NTR-FLD.
       FIN-EDT-FLD-NTR.
           EXIT.
