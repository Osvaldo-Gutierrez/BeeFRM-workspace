*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.

      * OFICINA
           03  WSS-COD-OFIC                          PIC X(03).

      * FECHA INGRESADA COMO PARAMETRO INICIO DEL RANGO
           03  WSS-FEC-FMIN.
               05  WSS-NUM-DMIN                      PIC 9(02).
               05  WSS-NUM-MMIN                      PIC 9(02).
               05  WSS-NUM-SMIN                      PIC 9(02).
               05  WSS-NUM-AMIN                      PIC 9(02).

      * FECHA INICIO RANGO PARA BUSCAR EN ARCHIVO VEN
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).

      * FECHA INGRESADA COMO PARAMETRO FIN DEL RANGO
           03  WSS-FEC-FMAX.
               05  WSS-NUM-DMAX                      PIC 9(02).
               05  WSS-NUM-MMAX                      PIC 9(02).
               05  WSS-NUM-SMAX                      PIC 9(02).
               05  WSS-NUM-AMAX                      PIC 9(02).

      * FECHA FINAL RANGO PARA BUSCAR EN ARCHIVO VEN
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).


      * FECHA INICIO RANGO ACELERACION
           03  WSS-FEC-FIRA.
               05  WSS-NUM-DIRA                      PIC 9(02).
               05  WSS-NUM-MIRA                      PIC 9(02).
               05  WSS-NUM-SIRA                      PIC 9(02).
               05  WSS-NUM-AIRA                      PIC 9(02).

      * FECHA TERMINO RANGO ACELERACION
           03  WSS-FEC-FTRA.
               05  WSS-NUM-DTRA                      PIC 9(02).
               05  WSS-NUM-MTRA                      PIC 9(02).
               05  WSS-NUM-STRA                      PIC 9(02).
               05  WSS-NUM-ATRA                      PIC 9(02).

      * TOTAL DIAS NO HABILES
           03  WSS-NUM-TDNH         VALUE ZEROES     PIC 9(03).

      * TOTAL
      * DIAS NECESARIOS PARA PASAR UN VENCIMIENTO A
      * CARTERA
      * VENCIDA
           03  WSS-NUM-TDCV         VALUE ZEROES     PIC 9(05).
           03  WSS-NUM-TDCV-RED
                          REDEFINES WSS-NUM-TDCV     PIC X(05).

      * TOTAL DIAS NECESARIOS PARA
      * ACELERAR VENCIMIENTOS A
      * CARTERA
      * VENCIDA
           03  WSS-NUM-TACV         VALUE ZEROES     PIC 9(05).
           03  WSS-NUM-TACV-RED
                          REDEFINES WSS-NUM-TACV     PIC X(05).

      * PRIMER CONTROL HEADING
           03 WSS-IND-IPPH   VALUE 0           PIC 9(01).
              88 PRIMER-PAGE-HEADING                  VALUE 0.

      * CODIGOS PARA SITUACIONES DE CARTERA VENCIDA Y CASTIGADA RESPECT.
           03  WSS-COD-SVCD         VALUE LOW-VALUES PIC X(08).
           03  WSS-COD-SCAS         VALUE LOW-VALUES PIC X(08).
           03  WSS-COD-SIDJ         VALUE LOW-VALUES PIC X(08).

           03  WSS-COD-SCTB         VALUE LOW-VALUES PIC X(08).
           03  WSS-COD-VCOC         VALUE LOW-VALUES PIC X(06).
           03  WSS-CIC-IOPC         VALUE LOW-VALUES PIC X(12).
           03  WSS-COD-RMOC         VALUE LOW-VALUES PIC X(12).

      *       RESPALDA VEN(1) PARA OPERACIONES ESTRUCTURADAS, PARA
      *       EXPANDIR PROXIMOS VENCIMIENTOS DE ESA ESTRUCTURA DENTRO
      *       DEL RANGO DE FECHAS Y LUEGO RESTAURARLO Y SEGUIR RECORRIENDO
      *       LA BASE DE DATOS
           03 SCR-VEN-KEY-IVEN                       PIC X(15).
           03 WSS-VEN-KEY-IVEN                       PIC X(15).


      *       INDICADOR PARA OBTENER VENCIMIENTOS DENTRO DEL RANGO
      *       ASOCIADOS A UNA ESTRUCTURA
           03 WSS-IND-RECO   VALUE 0                 PIC 9(01).
              88 RECORRE-ESTRUCTURA                  VALUE 1.

      *VERIFCAR CIC MONEDA CHILENA Y NO PESOS
           03  WSS-VLR.    
               05  WSS-CIC-VCAM.
      *
      *            Tipo Valor
                   07  WSS-CIC-TVAL                     PIC X(01).
      *
      *            Codigo Valor
                   07  WSS-CIC-CVAL                     PIC X(03).
      *
      *            Tipo Cambio
                   07  WSS-CIC-TCAM                     PIC X(08).

      * NUMERO SIN DECIMALES ( PARA TRUNCAR )
           03 WSS-NUM-NDEC                              PIC 9(12).
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCBRDBC.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY TABBROFI.
       COPY TABBRVLR.
       COPY TABBRCAM.
       COPY TABBRUSR.
       COPY COLBROPC.
       COPY GNSWGCPT.


       COPY COLWGVEN.
       COPY GNSWGCVI.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY COLBREVC.
       COPY COLBRRCV.
       COPY COLBRCCB.
       COPY COLBRTOC.
       COPY COLBRICG.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==. 
      *>>>>
*% END
*% IF PH_VTC
      *<<<< PH_VTC
           IF PRIMER-PAGE-HEADING
               MOVE 0 TO PAGE-COUNTER
               MOVE 1 TO PRINT-SWITCH
               MOVE 1 TO WSS-IND-IPPH.
      *>>>> END
*% END
*% IF CH_VTC_OPC_COD_OFOC
      *<<<< CH_VTC_OPC_COD_OFOC
      *BUS-OFI busca oficina en tablas
           MOVE SPACES TO OFI-GLS-DESC IN OFI.
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
      * OFICINA ESTA EN PAGE HEADING Y LA PRIMERA NO APARECE
      *BUS-OFI busca oficina en tablas
           MOVE SPACES TO OFI-GLS-DESC IN OFI.
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.
      *>>>> END
*% END
*% IF INI_INP
      *<<<< INI_INP
      *Captura Oficina
           DISPLAY 'OFICINA ( */XXX ) :'.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY ' OFICINA : ' WSS-COD-OFIC IN WSS-VARI.
           DISPLAY ' '.

      *Captura Fecha de Inicio
      *     DISPLAY 'FECHA DE INICIO ( DDMMSSAA ) :'.
      *     ACCEPT  WSS-FEC-FMIN IN WSS-VARI.
      *     DISPLAY ' RANGO DE SOLICITUD :'
      *             ' FECHA INICIAL          = ' WSS-FEC-FMIN.
      *     DISPLAY ' '.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DMIN IN WSS-FEC-FMIN.
           MOVE HOY-MHOY TO WSS-NUM-MMIN IN WSS-FEC-FMIN.
           MOVE HOY-SHOY TO WSS-NUM-SMIN IN WSS-FEC-FMIN.
           MOVE HOY-AHOY TO WSS-NUM-AMIN IN WSS-FEC-FMIN.
           

      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMSSAA ) : '
           ACCEPT  WSS-FEC-FMAX IN WSS-VARI.
           IF WSS-FEC-FMAX IN WSS-VARI NOT > SPACES
               MOVE WSS-FEC-FMIN TO WSS-FEC-FMAX.
           DISPLAY ' RANGO DE SOLICITUD :'
                   ' FECHA FINAL            = ' WSS-FEC-FMAX.
           DISPLAY ' '.

      *VAL-OFI Valida Oficina
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS NOT = SPACES
                   DISPLAY 'ABORTO : ' WSS-COD-OFIC
                   DISPLAY MSG-GLS-DESC
                   PERFORM GNS-PRO-END.

      *VAL-FEC Valida Fecha de Inicio
           MOVE WSS-FEC-FMIN IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ABORTO : ' WSS-FEC-FMIN
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END
           ELSE
               MOVE WSS-NUM-DMIN TO WSS-NUM-DDES
               MOVE WSS-NUM-MMIN TO WSS-NUM-MDES
               MOVE WSS-NUM-SMIN TO WSS-NUM-SDES
               MOVE WSS-NUM-AMIN TO WSS-NUM-ADES.

      *VAL-FEC Valida Fecha de Termino
           MOVE WSS-FEC-FMAX IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ABORTO : ' WSS-FEC-FMAX
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END
           ELSE
               MOVE WSS-NUM-DMAX TO WSS-NUM-DHAS
               MOVE WSS-NUM-MMAX TO WSS-NUM-MHAS
               MOVE WSS-NUM-SMAX TO WSS-NUM-SHAS
               MOVE WSS-NUM-AMAX TO WSS-NUM-AHAS.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FMIN IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FMAX IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'FECFMINFMAX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY 'ABORTO : ' WSS-FEC-FMIN '  ' WSS-FEC-FMAX
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-END.


      * BUSCA CODIGO DE SITUACION CONTABLE "VENCIDA"

           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-CIC-TMSC IN MSC.
           MOVE 'VCD'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SVCD
           ELSE
               DISPLAY 'ABORTO : SIS = COL, MSC = SCTB, '
                       'MSC-CIC-CMSC = VCD'
               DISPLAY ' ' MSG-GLS-DESC
               PERFORM GNS-PRO-END.


      * BUSCA CODIGO DE SITUACION CONTABLE "CASTIGADA"

           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-CIC-TMSC IN MSC.
           MOVE 'CAS'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SCAS
           ELSE
               DISPLAY 'ABORTO : SIS = COL, MSC = SCTB, '
                       'MSC-CIC-CMSC = CAS'
               DISPLAY ' ' MSG-GLS-DESC
               PERFORM GNS-PRO-END.


      * BUSCA CODIGO DE SITUACION COBRANZA "INICIO DEMANDA JUDICIAL"

           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'SCBZ' TO MSC-CIC-TMSC IN MSC.
           MOVE 'IDJ'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS = SPACES
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SIDJ
           ELSE
               DISPLAY 'ABORTO : SIS = COL, MSC = SCBZ, '
                       'MSC-CIC-CMSC = IDJ'
               DISPLAY ' ' MSG-GLS-DESC
               PERFORM GNS-PRO-END.

      * BUSCA PARAMETRO "CANTIDAD DE DIAS PARA PASAR UN VENCIMIENTO
      *                  A CARTERA VENCIDA"

           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'PCV' TO TAB-COD-TTAB IN TAB.
           MOVE 'DCV' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY 'ABORTO : SIS = COL, TAB = PCV, COD = DCV'
               DISPLAY MSG-GLS-DESC
               PERFORM GNS-PRO-END.

           MOVE TAB-GLS-ABRV TO WSS-NUM-TDCV-RED.
           IF WSS-NUM-TDCV-RED NOT NUMERIC
               DISPLAY 'ABORTO : SIS = COL, TAB = PCV, COD = DCV'
               DISPLAY 'ABREVIACION NO NUMERICA'
               PERFORM GNS-PRO-END.


      * BUSCA PARAMETRO CANTIDAD DE DIAS DESPUES QUE SE INICIA
      * LA DEMANDA JUDICIAL QUE IMPLICA ACELERACION

           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'PCV' TO TAB-COD-TTAB IN TAB.
           MOVE 'ACV' TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY 'ABORTO : SIS = COL, TAB = PCV, COD = ACV'
               DISPLAY MSG-GLS-DESC
               PERFORM GNS-PRO-END.

           MOVE TAB-GLS-ABRV TO WSS-NUM-TACV-RED.
           IF WSS-NUM-TACV-RED NOT NUMERIC
               DISPLAY 'ABORTO : SIS = COL, TAB = PCV, COD = ACV'
               DISPLAY 'ABREVIACION NO NUMERICA'
               PERFORM GNS-PRO-END.

           DISPLAY 'Fin de Validacion de Parametros'.

      * OBTENER FECHA INICIO RANGO DE SELECCION
      *    WSS-FEC-FINI = WSS-FEC-FMIN - WSS-NUM-DTVC
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA TO FEC-CMND.
           MOVE WSS-NUM-TDCV TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FINI.
           DISPLAY ' RANGO DE SELECCION :'
                   ' FECHA INICIAL          = ' WSS-FEC-FINI.
           DISPLAY ' '.

      * SI EL WSS-FEC-FMIN NO ES HABIL, WSS-FEC-FINI
      * DEBE QUEDAR COMO  WSS-FEC-FINI + EL TOTAL DE DIAS NO HABILES
      * CONTIGUOS HACIA ADELANTE DE WSS-FEC-FMIN

      *VAL-FEC Validar Fecha
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-HBL
                GO TO NOT-BUS-PDH.
      * BUS-PRIMER-DIA-HABIL
           MOVE 1 TO WSS-NUM-TDNH.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
       BUS-PDH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
                ADD 1 TO WSS-NUM-TDNH
                GO TO BUS-PDH.
       NOT-BUS-PDH.

           IF WSS-NUM-TDNH > ZEROES
               MOVE WSS-FEC-FINI        TO FEC-FECH
               MOVE FEC-FORM-FEC        TO FEC-FORM
               MOVE FEC-SUM-DIA         TO FEC-CMND
               MOVE WSS-NUM-TDNH        TO FEC-NDIA
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               MOVE FEC-FECH TO WSS-FEC-FINI.

           DISPLAY ' RANGO DE SELECCION :'
                   ' FECHA INICIAL EFECTIVA = ' WSS-FEC-FINI.
           DISPLAY ' '.

      * OBTENER FECHA FINAL RANGO DE SELECCION
      *    WSS-FEC-FTER = WSS-FEC-FMAX - WSS-NUM-DTVC
           MOVE WSS-FEC-FMAX TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA TO FEC-CMND.
           MOVE WSS-NUM-TDCV TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FTER.
           DISPLAY ' RANGO DE SELECCION :'
                   ' FECHA FINAL            = ' WSS-FEC-FTER.
           DISPLAY ' '.

      * SI EL DIA SIGUIENTE A WSS-FEC-FMAX ES NO HABIL, WSS-FEC-FTER
      * DEBE QUEDAR COMO  WSS-FEC-FTER + EL TOTAL DE DIAS NO HABILES
      * CONTIGUOS HACIA ADELANTE DE WSS-FEC-FMAX

      * BUS-ULTIMO-DIA-NO-HABIL
           MOVE ZEROES              TO WSS-NUM-TDNH.
           MOVE WSS-FEC-FMAX        TO FEC-FECH.
       BUS-UDNH.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-SUM-DIA         TO FEC-CMND.
           MOVE 1                   TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
                ADD 1 TO WSS-NUM-TDNH
                GO TO BUS-UDNH.

           IF WSS-NUM-TDNH > ZEROES
               MOVE WSS-FEC-FTER        TO FEC-FECH
               MOVE FEC-FORM-FEC        TO FEC-FORM
               MOVE FEC-SUM-DIA         TO FEC-CMND
               MOVE WSS-NUM-TDNH        TO FEC-NDIA
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               MOVE FEC-FECH TO WSS-FEC-FTER.

           DISPLAY ' RANGO DE SELECCION :'
                   ' FECHA FINAL EFECTIVA   = ' WSS-FEC-FTER.
           DISPLAY ' '.


       NXT-INP.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *    OBTIENE PRIMER REGISTRO VEN SEGUN RANGO Y SE SALTA
      *    PRIMER VEN SEGUN ESQUELETO

           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE WSS-NUM-DINI TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MINI TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SINI TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-AINI TO VEN-NUM-AVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           PERFORM COL-FIO-VEN.
           GO TO LUP-INP-SRT.
      *>>>> END
*% END
*% IF LUP_INP
      *<<<< LUP_INP

           MOVE VEN-KEY-IVEN IN VEN TO WSS-VEN-KEY-IVEN.

      *    VERIFICA QUE FECHA DE VENCIMIENTO NO SOBREPASE LIMITE MAXIMO
      *     MOVE WSS-FEC-FTER        TO FEC-FEC1.
      *     MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
      *     MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
      *     MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
      *     MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
      *     MOVE FEC-FORM-FEC        TO FEC-FORM.
      *     MOVE FEC-CMP-FEC         TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF FEC-STAT-LES
      *        GO TO FIN-INP-SRT.

      * VERIFICA ULTIMO VENCIMIENTO DE UNA ESTRUCTURA
           IF RECORRE-ESTRUCTURA
               IF VEN-STAT-EOF
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT
               ELSE
               IF NOT VEN-STAT-OKS
                   DISPLAY VEN-KEY-IVEN
                           ' ERROR EN EXPANSION DE VENCIMIENTO '
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE VEN-STAT TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT.

      * Verifica que Fecha Vencimiento no sobrepase Fecha Superior del rango
      * de fechas
      *    VERIFICA QUE FECHA DE VENCIMIENTO NO SOBREPASE LIMITE MAXIMO
      *    ESTE CODIGO SE PUEDE OPTIMIZAR NO LLAMANDO A RUTINA DE FECHAS
      *    BASTARIA DEFINIRSE LAS VARIABLES ADECUADAS PARA COMPARAR
           MOVE WSS-FEC-FTER        TO FEC-FEC1.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-CMP-FEC         TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               IF RECORRE-ESTRUCTURA
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT
               ELSE
                   GO TO FIN-INP-SRT.

           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               GO TO NXT-INP-SRT.

           PERFORM GET-CUR-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY VEN-KEY-IVEN ' VENCIMIENTO SIN OPERACION '
                       'ASOCIADA'
               GO TO NXT-INP-SRT.

           IF OPC-MSC-STAT NOT = 'A'
               GO TO NXT-INP-SRT.
      
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO NXT-INP-SRT.

           PERFORM GET-CUR-DLC.
           IF NOT FIO-STAT-OKS
               DISPLAY VEN-KEY-IVEN ' VENCIMIENTO SIN DOCUMENTO '
                       'ASOCIADO'
                   GO TO NXT-INP-SRT.

      *    VENCIMIENTO ESTRUCTURADO Y 'VIGENTE'

           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
           DISPLAY VEN-KEY-IVEN ' VCTO CANDIDATO'.

           IF NOT RECORRE-ESTRUCTURA
               IF OPC-IND-VSTR IN OPC = 'S' AND
                  VEN-IND-SCTB IN VEN NOT > SPACES 
                    DISPLAY VEN-KEY-IVEN ' RESPALDA VEN ' 
                    MOVE WSS-VEN-KEY-IVEN TO SCR-VEN-KEY-IVEN
                    MOVE 1 TO WSS-IND-RECO
               ELSE
                    MOVE 0 TO WSS-IND-RECO.

      * SI CODIGO DE SITUACION CONTABLE DE VENCIMIENTO = "VENCIDA" O
      *    "CASTIGADO" ==> NO CONSIDERAR VENCIMIENTO

           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-CIC-TMSC IN MSC.
           MOVE VEN-IND-SCTB IN VEN TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.

           IF MSG-COD-MENS NOT = SPACES
               GO TO NXT-INP-SRT.

           IF MSC-CIC-CMSC IN MSC = WSS-COD-SVCD OR
              MSC-CIC-CMSC IN MSC = WSS-COD-SCAS
               GO TO NXT-INP-SRT.

           MOVE OPC-COD-RMOC IN OPC TO USR-COD-USER IN USR.
           PERFORM BUS-USR.


      * COMO ESTE CAMPO ES NUEVO SE VERIFICA QUE SEA NUMERICO
      *     IF DLC-NUM-VSCE IN DLC NOT NUMERIC
      *         MOVE ZEROES TO DLC-NUM-VSCE IN DLC.
      *     ADD 1 TO DLC-NUM-VSCE IN DLC.

      * ACELERACION O ULTIMO VENCIMIENTO DEL DOCUMENTO

      *     IF WSS-NUM-TACV NOT > DLC-NUM-VSCE IN DLC
      * SALDO DLC - INTERESES DE LA CUOTA
      *  10-NOV-1989 11:30:30 ELIMINADO POR PETICION DGS
      *          COMPUTE VEN-VAL-SFIN IN VEN =
      *                   DLC-VAL-SDLC IN DLC + VEN-VAL-SFIN IN VEN -
      *                   VEN-VAL-SCAP IN VEN
      *          MOVE 'S' TO SRT-IND-ACEL.
                   
      * OBTIENE FECHA CANDIDATA EN QUE EL VENCIMIENTO SE PASARA
      * A CARTERA VENCIDA

           MOVE VEN-NUM-DVEN IN VEN TO FEC-ITM1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-ITM2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-ITM3.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-ITM4.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-SUM-DIA         TO FEC-CMND.
           MOVE WSS-NUM-TDCV        TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.

      * SI LA FECHA EN QUE EL VENCIMIENTO SE PASARA A CARTERA VENCIDA
      * ES UNA FECHA NO HABIL, SE BUSCA EL PRIMER DIA HABIL HACIA ATRAS
      * BUS-Primer-Dia-Habil-BACK.
           PERFORM BUS-PDH-BACK.

           PERFORM PRO-ACEL.
      * OBTIENE VALOR DE CAMBIO PARA MONEDA DEL CREDITO

           PERFORM CNV-VCAM.

      *>>>> END
*% END
*% IF INI_NXT_INP
      *<<<< IF INI_NXT_INP
      * Mueve la Llave Alternativa por la cual se leera VEN
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF RECORRE-ESTRUCTURA
      *INI-DBG
                DISPLAY VEN-KEY-IVEN ' PREVIO    EXPANSION ' 
      *FIN-DBG
                PERFORM COL-OBT-VEN
                MOVE '00' TO FIO-STAT
      *INI-DBG
                DISPLAY VEN-KEY-IVEN ' POSTERIOR EXPANSION ' 
      *FIN-DBG
           ELSE
               MOVE 'VEN-FEC-FVEN' TO FIO-AKEY
                PERFORM COL-FIO-VEN.

      *INI-DBG
           IF NOT RECORRE-ESTRUCTURA
               DISPLAY VEN-KEY-IVEN ' VEN EXPANDIDO NO '.
      *FIN-DBG

           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *BUS-TAB busca Codigo Clase Operacion Credito en tabla
           IF OPC-COD-COOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-COOC IN WSS-VTC
           ELSE
               MOVE SPACES TO WSS-GLS-COOC IN WSS-VTC.
      *
      *BUS-TAB busca codigo en tabla
      *Solo busca cuando cambia el codigo
           IF OPC-COD-VCOC IN SRT > SPACES
               IF OPC-COD-VCOC IN SRT NOT = WSS-COD-VCOC
                   MOVE OPC-COD-VCOC IN SRT TO WSS-COD-VCOC
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'VLR' TO TAB-COD-TTAB IN TAB
                   MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-VTC
              ELSE
                 NEXT SENTENCE
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-VTC.

           MOVE OPC-CIC-IOPC IN SRT TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO RST-DBC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO RST-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           GO TO GEN-OUT-SRT.
       RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       GET-CUR-OPC SECTION.
       INI-GET-CUR-OPC.
      *    PARA N VENCIMIENTOS CON EL MISMO CIC,
      *    LEE SOLO UNA VEZ SU OPC ASOCIADO
           MOVE '00' TO FIO-STAT.
           IF VEN-CIC-IOPC IN VEN NOT = OPC-CIC-IOPC IN OPC
               MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO OPC-CIC-IOPC IN OPC.
       FIN-GET-CUR-OPC.
           EXIT.

       GET-CUR-DLC SECTION.
       INI-GET-CUR-DLC.
      *    PARA N DOCUMENTOS CON EL MISMO CIC,
      *    LEE SOLO UNA VEZ SU DLC ASOCIADO
           MOVE '00' TO FIO-STAT.
           IF VEN-CIC-IOPC IN VEN NOT = DLC-CIC-IOPC IN DLC
               MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC
               MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO OPC-CIC-IOPC IN OPC.
       FIN-GET-CUR-DLC.
           EXIT.

       PRO-ACEL SECTION.
       INI-PRO-ACEL.
           MOVE 'N' TO SRT-IND-ACEL.
           MOVE SRT-NUM-DVTC TO WSS-NUM-DIRA.
           MOVE SRT-NUM-MVTC TO WSS-NUM-MIRA.
           MOVE SRT-NUM-SVTC TO WSS-NUM-SIRA.
           MOVE SRT-NUM-AVTC TO WSS-NUM-AIRA.

           MOVE WSS-FEC-FIRA TO FEC-FECH.
       PXM-HBL.
           MOVE FEC-FECH TO WSS-FEC-FTRA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
                GO TO PXM-HBL.

      * OBTENER FECHA INICIO RANGO DE SELECCION
      *    WSS-FEC-FIRA = WSS-FEC-FIRA - WSS-NUM-TACV
           MOVE WSS-FEC-FIRA TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA TO FEC-CMND.
           MOVE WSS-NUM-TACV TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIRA.
           DISPLAY ' RANGO DE SELECCION : CCB'
                   ' FECHA INICIAL          = ' WSS-FEC-FIRA.
           DISPLAY ' '.
           
      * OBTENER FECHA TERMINO RANGO DE SELECCION
      *    WSS-FEC-FTRA = WSS-FEC-FTRA - WSS-NUM-TACV
           MOVE WSS-FEC-FTRA TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA TO FEC-CMND.
           MOVE WSS-NUM-TACV TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FTRA.
           DISPLAY ' RANGO DE SELECCION : CCB'
                   ' FECHA FINAL = ' WSS-FEC-FTRA.
           DISPLAY ' '.
           MOVE VEN-CIC-IOPC IN VEN TO CCB-CIC-IOPC IN CCB.
           MOVE VEN-NUM-IDLC IN VEN TO CCB-NUM-IDLC IN CCB.
           MOVE ZEROES TO CCB-NUM-ICCB IN CCB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-PRO-ACEL.
           PERFORM COL-FIO-CCB.
           IF NOT FIO-STAT-OKS
               DISPLAY VEN-KEY-IVEN ' FIN CCB'
               GO TO FIN-PRO-ACEL.

           IF NOT ( VEN-CIC-IOPC IN VEN = CCB-CIC-IOPC IN CCB AND
                    VEN-NUM-IDLC IN VEN = CCB-NUM-IDLC IN CCB )
                DISPLAY VEN-KEY-IVEN ' VEN NO ACELERADO '
                GO TO FIN-PRO-ACEL.

           IF CCB-IND-SCBZ NOT = WSS-COD-SIDJ
               DISPLAY CCB-KEY-ICCB IN CCB ' ' CCB-IND-SCBZ IN CCB
                       ' RECHAZADO POR SIT. COBRANZA NO VALIDA'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-PRO-ACEL.

      *    VERIFICA QUE FECHA DE CAMBIO SITUACION COBRANZA ESTE
      *    EN EL RANGO
           MOVE CCB-NUM-DCCB IN CCB TO FEC-DEC1.
           MOVE CCB-NUM-MCCB IN CCB TO FEC-MEC1.
           MOVE CCB-NUM-SCCB IN CCB TO FEC-SEC1.
           MOVE CCB-NUM-ACCB IN CCB TO FEC-AEC1.
           MOVE WSS-FEC-FIRA        TO FEC-FEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-CMP-FEC         TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               DISPLAY CCB-KEY-ICCB ' ' CCB-FEC-FCCB ' FECHA CCB '
                       ' MENOR QUE FECHA BUSQUEDA INICIAL '
                       WSS-FEC-FIRA
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-PRO-ACEL.

      *    VERIFICA QUE FECHA DE CAMBIO SITUACION COBRANZA ESTE
      *    EN EL RANGO
           MOVE CCB-NUM-DCCB IN CCB TO FEC-DEC1.
           MOVE CCB-NUM-MCCB IN CCB TO FEC-MEC1.
           MOVE CCB-NUM-SCCB IN CCB TO FEC-SEC1.
           MOVE CCB-NUM-ACCB IN CCB TO FEC-AEC1.
           MOVE WSS-FEC-FTRA        TO FEC-FEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-CMP-FEC         TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               DISPLAY CCB-KEY-ICCB ' ' CCB-FEC-FCCB ' FECHA CCB '
                       ' MAYOR QUE FECHA BUSQUEDA FINAL '
                       WSS-FEC-FTRA
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-PRO-ACEL.
           MOVE 'S' TO SRT-IND-ACEL.

       FIN-PRO-ACEL.
           EXIT.

       BUS-PDH-BACK SECTION.
       INI-BUS-PDH-BACK.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
               MOVE FEC-FORM-FEC        TO FEC-FORM
               MOVE FEC-RST-DIA         TO FEC-CMND
               MOVE 1                   TO FEC-NDIA
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               GO TO INI-BUS-PDH-BACK.
           MOVE FEC-ITM1 TO SRT-NUM-DVTC.
           MOVE FEC-ITM2 TO SRT-NUM-MVTC.
           MOVE FEC-ITM3 TO SRT-NUM-SVTC.
           MOVE FEC-ITM4 TO SRT-NUM-AVTC.
       FIN-BUS-PDH-BACK.
           EXIT.

       CNV-VCAM SECTION.
       INI-CNV-VCAM.

      * ASUME ERROR
           MOVE ZEROES TO SRT-VAL-VTRA IN SRT.

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY ' '
               GO TO FIN-CNV-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *    CONVIERTE A PESOS

           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               MOVE VEN-VAL-SFIN IN VEN  TO SRT-VAL-VTRA IN SRT
               GO TO END-CNV-VCAM.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CODIGO DE PESOS INEXISTENTE'
               DISPLAY 'OPERACION ' OPC-CIC-IOPC IN OPC
               DISPLAY ' '
               GO TO FIN-CNV-VCAM.

           MOVE VEN-FEC-FVEN IN VEN TO CAM-FEC-FCAM IN CAM(1).
           MOVE VEN-FEC-FVEN IN VEN TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC TO CAM-COD-VCAM IN CAM(1).
      *ISP CODIGO DE PESOS
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODVCAMNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY VEN-KEY-IVEN ' ' MSG-GLS-DESC
               DISPLAY ' PARA VENCIMIENTO '
               DISPLAY 'PARA FECHA : '      VEN-FEC-FVEN IN VEN
               MOVE ZEROES TO SRT-VAL-VTRA IN SRT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'VALCAMNVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY VEN-KEY-IVEN ' ' MSG-GLS-DESC
                   DISPLAY ' PARA VENCIMIENTO '
                   DISPLAY 'PARA FECHA : '      VEN-FEC-FVEN IN VEN
                   MOVE ZEROES TO SRT-VAL-VTRA IN SRT
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM
                         BY VEN-VAL-SFIN IN VEN
                   GIVING   SRT-VAL-VTRA IN SRT.
       END-CNV-VCAM.
           IF WSS-CIC-TVAL = '0'
                MOVE SRT-VAL-VTRA IN SRT TO WSS-NUM-NDEC
                MOVE WSS-NUM-NDEC TO SRT-VAL-VTRA IN SRT.
       FIN-CNV-VCAM.
           EXIT.

       GET-NXT-VEN-FVEN SECTION.
       INI-GET-NXT-VEN-FVEN.
           MOVE SCR-VEN-KEY-IVEN TO VEN-KEY-IVEN IN VEN.
      *     MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE 0 TO WSS-IND-RECO.

           MOVE SPACES TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           DISPLAY VEN-KEY-IVEN ' RECUPERO VENCIMIENTO '

           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
      *INI-DBG
           DISPLAY VEN-KEY-IVEN ' VENCIMIENTO RESCATADO '.
       FIN-GET-NXT-VEN-FVEN.
           EXIT.

       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY SGCBFDBC.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY COLBFOPC.
       COPY TABBFOFI.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY TABBBUSR.
       COPY TABBFUSR.

       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBVTAB.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBFMSC.

       COPY COLBGVEN.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
       COPY COLBFEVC.
       COPY COLBFRCV.
       COPY COLBFCCB.
       COPY COLBFTOC.
       COPY COLBFICG.

      *
      *>>>>
*% END
