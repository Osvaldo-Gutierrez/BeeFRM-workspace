*%! Codigo adicional para archivo COLPQCDC
*% TCA = 1030
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY COLBROPC.
       COPY TABBRVLR.
       COPY GNSWGCPT.
       COPY GNSWGPES.
       01  WSS-VARI.
           03 WSS-IMAX               VALUE 6          PIC 9(02).
           03 WSS-NUM-DEUD                            PIC 9(02).
           03 WSS-KEY-IDLC                            PIC X(15).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
      *>>>>
*% END
*% RA1 = "RDC"
*% NRA = 1
*% FRM = "CDC"
*% TBL = "RDC"
*% INCLUDE 'PFSCONALL'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-RDC-DSC-REQA==.
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-RDC-ASC-REQA==.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF RDC-CAI-IOPC IN CDC-FLD NOT > SPACES
               MOVE SPACES TO RDC-CAI-IOPC IN RDC
               MOVE SPACES TO RDC-CAI-IOPC IN CDC-FLD.
           IF RDC-NUM-IDLC IN CDC-FLD NOT > ZEROES
               MOVE ZEROES TO RDC-NUM-IDLC IN RDC
               MOVE ZEROES TO RDC-NUM-IDLC IN CDC-FLD.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-OR-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-CDC
                   MOVE RDC-CAI-IOPC IN RDC TO RDC-CAI-IOPC IN CDC-FLD
                   MOVE RDC-IIC-IOPC IN RDC TO RDC-IIC-IOPC IN CDC-FLD
                   MOVE RDC-NUM-IDLC IN RDC TO RDC-NUM-IDLC IN CDC-FLD
                   GO TO PUT-RDC
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'RDC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC   TO FRM-MENS
                       MOVE '00'           TO FIO-STAT
                       MOVE SCR-STAT-CON   TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'RDC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC   TO FRM-MENS
                       MOVE '00'           TO FIO-STAT
                       MOVE SCR-STAT-CON   TO SCR-STAT
                       GO TO FIN-FND-KEY.
           IF RDC-CAI-IOPC IN CDC-FLD NOT > SPACES AND
              RDC-IIC-IOPC IN CDC-FLD NOT > ZEROES
               GO TO FIN-FND-KEY.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *DSP CAMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND
           MOVE RDC-KEY-IDLC IN RDC TO WSS-KEY-IDLC.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-KEY-IDLC IN RDC = WSS-KEY-IDLC
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT-NEX TO FIO-STAT 
               GO TO FIN-FND-KEY.
       PUT-RDC.
           MOVE '00' TO PGM-STAT-RDC.
           MOVE ZEROES TO WSS-NUM-DEUD.
           MOVE SPACES TO SCR-RDC-DSC-REQA.
           MOVE SPACES TO SCR-RDC-ASC-REQA.
           MOVE ADR-RDC-REQA TO SCR-RDC-DSC-REQA.
           MOVE RDC-CAI-IOPC IN CDC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN CDC-FLD TO OPC-IIC-IOPC IN OPC.           
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE '00' TO PGM-STAT-OPC.
           PERFORM PUT-OPC-CDC.
           MOVE ZEROES TO FRM-IFLD.
       LUP-OPE-RDC.
           MOVE ADR-RDC-REQA TO SCR-RDC-ASC-REQA.
           ADD 1 TO WSS-NUM-DEUD.
           ADD 1 TO FRM-IFLD.
           PERFORM PUT-TAB-OPE-RDC. 
           IF FRM-IFLD < WSS-IMAX
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS AND
                  RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND
                  RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND
                  RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD
                  GO TO LUP-OPE-RDC.
           PERFORM KEY-RDC-CDC.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PUT-TAB-OPE-RDC SECTION.
       INI-PUT-TAB-OPE-RDC.
           MOVE RDC-NUM-DIRE IN RDC TO FRM-NUM-DIRE
                                                 IN CDC-FLD(FRM-IFLD).
           MOVE RDC-VAL-LIMD IN RDC TO FRM-VAL-LIMD
                                                 IN CDC-FLD(FRM-IFLD).
           MOVE WSS-NUM-DEUD        TO FRM-NUM-DEUD
                                                 IN CDC-FLD(FRM-IFLD).
           MOVE RDC-KEY-IRDC IN RDC TO DBC-KEY-IDBC IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI  
                                                 IN CDC-FLD(FRM-IFLD)
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI 
                                                 IN CDC-FLD(FRM-IFLD)
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI  
                                                 IN CDC-FLD(FRM-IFLD)
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI  
                                                 IN CDC-FLD(FRM-IFLD)
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC     IN CDC-FLD(FRM-IFLD)
           ELSE
               MOVE ZEROES TO FRM-NUM-ICLI IN CDC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-IND-ICLI IN CDC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-VRF-ICLI IN CDC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-GLS-ICLI IN CDC-FLD(FRM-IFLD)
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMC IN
                                         CDC-FLD(FRM-IFLD).
           MOVE RDC-CAI-IOPC IN CDC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN CDC-FLD TO OPC-IIC-IOPC IN OPC.           
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *DAD  ini 02-MAY-1994
      * Calcula Monto Limite Deuda de Deudor Credito
      *     MULTIPLY OPC-VAL-CRED IN OPC BY RDC-VAL-LIMD IN RDC
      *                       GIVING FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).
      *     DIVIDE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) BY 100 GIVING
      *            FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).
           COMPUTE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) =
                   ( OPC-VAL-CRED IN OPC * RDC-VAL-LIMD IN RDC ) / 100.
      *DAD  fin 02-MAY-1994
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE SPACES TO TAB-COD-CTAB IN TAB.
           IF TAB-COD-CTAB IN TAB = OPC-COD-VCOC IN CDC-FLD
               MOVE FRM-VAL-MONL IN CDC-FLD(FRM-IFLD) TO
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO 
                    FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).
       FIN-PUT-TAB-OPE-RDC.        
           EXIT.

      * Modulo Programacion Generica para Scroll con PF5(dsc) y PF6(asc).
       SCRL-TAB-RDC SECTION.
       INI-SCRL-TAB-RDC.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-FFLD = FRM-FFLD-PF6
               IF FRM-NUM-ICLI IN CDC-FLD(WSS-IMAX) > ZEROES
                   PERFORM PUT-TAB-ASC
               ELSE
                   MOVE 'CLI    N+RDC' TO MSG-COD-MENS
           ELSE
      *        IF FRM-FFLD = FRM-FFLD-PF5
               IF FRM-NUM-ICLI IN CDC-FLD(1) > ZEROES
                   PERFORM PUT-TAB-DSC
               ELSE
                   MOVE 'CLI    N-RDC' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-RDC.
           EXIT.

      * Modulo Efectua Llenado de Tabla en Pantalla en Forma Ascendente.
       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE FRM-NUM-DEUD IN CDC-FLD(6) TO WSS-NUM-DEUD.
           MOVE SCR-RDC-ASC-REQA TO ADR-RDC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
       LUP-PUT-TAB-ASC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD
               MOVE ADR-RDC-REQA TO SCR-RDC-ASC-REQA
               IF FRM-IFLD = 0
                   MOVE ADR-RDC-REQA TO SCR-RDC-DSC-REQA
                   PERFORM CLR-TAB-RDC VARYING FRM-IFLD FROM 1 BY 1
                                       UNTIL FRM-IFLD > WSS-IMAX
                   MOVE 1 TO FRM-IFLD
                   ADD 1 TO WSS-NUM-DEUD
                   PERFORM PUT-TAB-OPE-RDC 
               ELSE
                   ADD 1 TO FRM-IFLD
                   ADD 1 TO WSS-NUM-DEUD
                   PERFORM PUT-TAB-OPE-RDC
           ELSE
               IF FRM-IFLD = 0
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLI    N+RDC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           IF FRM-IFLD < WSS-IMAX
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-RDC
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           EXIT.

      * Modulo Efectua Llenado de Tabla en Pantalla en Forma Descendente.
       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE FRM-NUM-DEUD IN CDC-FLD(1) TO WSS-NUM-DEUD.
           MOVE SCR-RDC-DSC-REQA TO ADR-RDC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-RDC.
       LUP-PUT-TAB-DSC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD 
               MOVE ADR-RDC-REQA TO SCR-RDC-DSC-REQA
               IF FRM-IFLD = 0
                   MOVE ADR-RDC-REQA TO SCR-RDC-ASC-REQA
                   PERFORM CLR-TAB-RDC VARYING FRM-IFLD FROM 1 BY 1
                                       UNTIL FRM-IFLD > WSS-IMAX
                   MOVE WSS-IMAX TO FRM-IFLD
                   SUBTRACT 1 FROM WSS-NUM-DEUD
                   PERFORM PUT-TAB-OPE-RDC 
               ELSE
                   SUBTRACT 1 FROM FRM-IFLD
                   SUBTRACT 1 FROM WSS-NUM-DEUD
                   PERFORM PUT-TAB-OPE-RDC
           ELSE
               IF FRM-IFLD = 0
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLI    N-RDC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           IF FRM-IFLD > 1
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-PRV TO FIO-CMND
               PERFORM COL-FIO-RDC
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.
           EXIT.

       LEE-NXT-OR-PRV SECTION.
       INI-LEE-NXT-OR-PRV.
           IF RDC-KEY-IDLC IN RDC > SPACES
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       PERFORM LEE-PRV-RDC
                   ELSE
                       PERFORM LEE-NXT-RDC
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'RDC-KEY-IDLC' TO FIO-AKEY 
                       MOVE FIO-GET-LEQ TO FIO-CMND
                       MOVE '00'        TO FIO-STAT
                   ELSE
                       MOVE 'RDC-KEY-IDLC' TO FIO-AKEY 
                       MOVE FIO-GET-NLS TO FIO-CMND
                       MOVE '00'        TO FIO-STAT
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY 
                   MOVE FIO-GET-LEQ TO FIO-CMND
                   MOVE '00'        TO FIO-STAT
               ELSE
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY 
                   MOVE FIO-GET-NLS TO FIO-CMND
                   MOVE '00'        TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-RDC
               GO TO FIN-LEE-NXT-OR-PRV
           ELSE
               PERFORM COL-FIO-RDC
               MOVE FIO-STAT TO PGM-STAT-RDC.
       FIN-LEE-NXT-OR-PRV.
           EXIT.       
       LEE-PRV-RDC SECTION.
       INI-LEE-PRV-RDC.
       LUP-LEE-PRV-RDC.
           IF RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD AND
              FIO-STAT-OKS
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-PRV TO FIO-CMND
               PERFORM COL-FIO-RDC       
               GO TO LUP-LEE-PRV-RDC
           ELSE
               IF NOT FIO-STAT-OKS
                   GO TO FIN-LEE-PRV-RDC
               ELSE
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND.                   
       FIN-LEE-PRV-RDC.
           EXIT.
       LEE-NXT-RDC SECTION.
       INI-LEE-NXT-RDC.
       LUP-LEE-NXT-RDC.
           IF RDC-CAI-IOPC IN RDC = RDC-CAI-IOPC IN CDC-FLD AND
              RDC-IIC-IOPC IN RDC = RDC-IIC-IOPC IN CDC-FLD AND
              RDC-NUM-IDLC IN RDC = RDC-NUM-IDLC IN CDC-FLD AND
              FIO-STAT-OKS
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-RDC       
               GO TO LUP-LEE-NXT-RDC
           ELSE
               IF NOT FIO-STAT-OKS
                   GO TO FIN-LEE-NXT-RDC
               ELSE
                   MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND.                   
       FIN-LEE-NXT-RDC.    
           EXIT.

      * Modulo Limpia Campos de Tabla en Pantalla.
       CLR-TAB-RDC SECTION.
       INI-CLR-TAB-RDC.
           MOVE ZEROES TO FRM-NUM-DEUD IN CDC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-NUM-ICLI IN CDC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-ICLI IN CDC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-VRF-ICLI IN CDC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-ICLI IN CDC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-VAL-LIMD IN CDC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-VAL-MONL IN CDC-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-NUM-DIRE IN CDC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-NOMC IN CDC-FLD(FRM-IFLD).
       FIN-CLR-TAB-RDC.
           EXIT.

       COPY SGCBFDBC.
       COPY COLBFOPC.
       COPY GNSBGPES.
       COPY TABBFVLR.
       COPY GNSBVTAB.
       COPY TABBVOFI.
       COPY GNSBVCOD.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
      * COPY GNSBEGLS.
      *>>>>
*% END
