*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY TABBRVLR.
       COPY TABBRUSR.
       COPY SGCBRDBC.
       COPY SGCBRRCD.

       COPY COLWGSTO.

       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       01  WSS-VARI.
           03  WSS-VAL-MLIM         PIC 9(11)V9(4).
           03  WSS-VAL-CRED         PIC 9(11)V9(4).
           03 WSS-COD-LUGA.
              05 WSS-IND-LUGA                            PIC X(01).
              05 WSS-COD-PAIS                            PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF DBC-NUM-ICLI IN RDC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN RDC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN RDC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN RDC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE SPACES TO RDC-CAI-ICLI IN RDC-FLD
                   MOVE SPACES TO RDC-IIC-ICLI IN RDC-FLD
                   MOVE SPACES TO DBC-GLS-NOMC IN RDC-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN RDC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC-FLD
                   MOVE '00' TO PGM-STAT-DBC
           ELSE
           IF DBC-GLS-NOMC IN RDC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

               MOVE DBC-GLS-NOMC IN RDC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN RDC-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN RDC-FLD
                   MOVE SPACES TO DBC-IND-ICLI IN RDC-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN RDC-FLD
                   MOVE SPACES TO RDC-CAI-ICLI IN RDC-FLD
                   MOVE SPACES TO RDC-IIC-ICLI IN RDC-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN RDC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RDC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RDC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN RDC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN RDC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC-FLD
                   MOVE '00' TO PGM-STAT-DBC.

           IF RDC-CAI-IOPC IN RDC-FLD NOT > SPACES
               MOVE SPACES TO RDC-CAI-IOPC IN RDC-FLD.

           PERFORM KEY-ALL-RDC.
           IF ( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
                RDC-IIC-ICLI IN RDC-FLD > SPACES ) AND

              ( RDC-CAI-IOPC IN RDC-FLD > SPACES OR
                RDC-IIC-IOPC IN RDC-FLD > ZEROES ) AND

               RDC-NUM-IDLC IN RDC-FLD > ZEROES    AND
               SCR-CCPP = 'ING'

               MOVE ZEROES TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS
                   PERFORM EDT-KEY-RDC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    DDIR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY.

           PERFORM KEY-ALL-RDC.
           IF ( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
                RDC-IIC-ICLI IN RDC-FLD > SPACES ) AND

                RDC-CAI-IOPC IN RDC-FLD NOT > SPACES AND
                RDC-IIC-IOPC IN RDC-FLD NOT > ZEROES AND

                RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES

               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF NOT FIO-STAT-OKS OR
                   RDC-CAI-ICLI IN RDC NOT = RDC-CAI-ICLI IN RDC-FLD OR
                   RDC-IIC-ICLI IN RDC NOT = RDC-IIC-ICLI IN RDC-FLD
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NORDC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE FIO-STAT TO PGM-STAT-RDC
                   PERFORM BUS-DLC
                   PERFORM BUS-OPE
                   IF FIO-STAT-OKS
                       PERFORM BUS-RCD
      *                IF OPC-MSC-STAT = 'A'
                       IF OPC-ACTIVADA
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'OPC    ACAYA' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
      *                    IF OPC-MSC-STAT = 'D'
                           IF OPC-DESACTIVADA
                               MOVE 'COL' TO MSG-COD-SIST
                               MOVE 'OPC    DESYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
*% IF PGM_PER
      *                        IF OPC-MSC-STAT = 'F'
                               IF OPC-APROBADA-CTC
                                   MOVE 'COL' TO MSG-COD-SIST
                                   MOVE 'OPC    APDYA' TO MSG-COD-MENS
                                   PERFORM GET-MSG
                                   MOVE MSG-GLS-DESC TO FRM-MENS
                                   MOVE '00' TO FIO-STAT
                                   MOVE SCR-STAT-CON TO SCR-STAT
                                   GO TO FIN-FND-KEY
                               ELSE
*% END
                                   MOVE 'COL' TO MSG-COD-SIST
                                   GO TO FIN-FND-KEY.

           IF ( RDC-CAI-IOPC IN RDC-FLD > SPACES OR
                RDC-IIC-IOPC IN RDC-FLD > ZEROES ) AND
                RDC-CAI-ICLI IN RDC-FLD NOT > SPACES AND
                RDC-IIC-ICLI IN RDC-FLD NOT > SPACES

               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF FIO-STAT-OKS
                   MOVE FIO-STAT TO PGM-STAT-RDC
                   PERFORM BUS-RCD
                   PERFORM BUS-DLC
                   PERFORM BUS-CLI
                   IF FIO-STAT-OKS
                       PERFORM BUS-OPE
                       IF FIO-STAT-OKS
      *                    IF OPC-MSC-STAT = 'A'
                           IF OPC-ACTIVADA
                               MOVE 'COL' TO MSG-COD-SIST
                               MOVE 'OPC    ACAYA' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
      *                        IF OPC-MSC-STAT = 'D'
                               IF OPC-DESACTIVADA
                                   MOVE 'COL' TO MSG-COD-SIST
                                   MOVE 'OPC    DESYA' TO MSG-COD-MENS
                                   PERFORM GET-MSG
                                   MOVE MSG-GLS-DESC TO FRM-MENS
                                   MOVE '00' TO FIO-STAT
                                   MOVE SCR-STAT-CON TO SCR-STAT
                                   GO TO FIN-FND-KEY
                               ELSE
*% IF PGM_PER
      *                            IF OPC-MSC-STAT = 'F'
                                   IF OPC-APROBADA-CTC
                                       MOVE 'COL' TO MSG-COD-SIST
                                       MOVE 'OPC    APDYA'
                                         TO MSG-COD-MENS
                                       PERFORM GET-MSG
                                       MOVE MSG-GLS-DESC TO FRM-MENS
                                       MOVE '00' TO FIO-STAT
                                       MOVE SCR-STAT-CON TO SCR-STAT
                                       GO TO FIN-FND-KEY
                                   ELSE
*% END
                                       GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
                   ELSE
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'OPCIDLCNORDC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           MOVE FIO-STAT TO PGM-STAT-RDC.
           MOVE RDC-CAI-ICLI IN RDC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI IN RDC-FLD TO DBC-IIC-ICLI IN DBC.
           IF PGM-STAT-RDC-OKS
               PERFORM BUS-RCD.
           PERFORM BUS-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMIDLCNODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
           PERFORM BUS-OPE.
           MOVE PGM-STAT-RDC TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
      *ALD
      *     IF NOT ( OPC-MSC-STAT IN OPC = 'L' OR 'A' )

*% IF NOT PGM_PER
      *     IF OPC-MSC-STAT IN OPC NOT = 'A' AND
      *        OPC-MSC-STAT IN OPC NOT = 'D'
            IF ( NOT OPC-ACTIVADA ) AND ( NOT OPC-DESACTIVADA )
                GO TO FIN-FND-KEY.
*% END
*% IF PGM_PER
      *     IF OPC-MSC-STAT IN OPC NOT = 'A' AND
      *        OPC-MSC-STAT IN OPC NOT = 'D' AND
      *        OPC-MSC-STAT IN OPC NOT = 'F'
            IF ( NOT OPC-ACTIVADA ) AND ( NOT OPC-DESACTIVADA )
                                    AND ( NOT OPC-APROBADA-CTC )
                GO TO FIN-FND-KEY.
*% END
      *     IF OPC-MSC-STAT IN OPC = 'L'
      *         MOVE 'OPC    LIQYA' TO MSG-COD-MENS.

      *    IF OPC-MSC-STAT IN OPC = 'A'
           IF OPC-ACTIVADA
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS.
      *    IF OPC-MSC-STAT IN OPC = 'D'
           IF OPC-DESACTIVADA
               MOVE 'OPC    DESYA' TO MSG-COD-MENS.
*% IF PGM_PER
      *    IF OPC-MSC-STAT IN OPC = 'F'
           IF OPC-APROBADA-CTC
               MOVE 'OPC    APDYA' TO MSG-COD-MENS.
*% END
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.

           MOVE MSG-GLS-DESC TO CPT-STR1
           MOVE MSG-GLS-DATA TO CPT-STR2
           PERFORM CPT-BLKS
           MOVE CPT-STRN     TO FRM-MENS

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
           MOVE RDC-CAI-IOPC IN RDC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-OPC
           ELSE
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.

      *ISP CARGA TAMBIEN LOS DATOS DE DLC
           IF RDC-NUM-IDLC IN RDC-FLD > ZEROES
               MOVE RDC-CAI-IOPC IN RDC-FLD TO DLC-CAI-IOPC IN DLC
               MOVE RDC-IIC-IOPC IN RDC-FLD TO DLC-IIC-IOPC IN DLC
               MOVE RDC-NUM-IDLC IN RDC-FLD TO DLC-NUM-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF FIO-STAT-OKS
                   MOVE '00' TO PGM-STAT-RDC
               ELSE
                   PERFORM FST-FLD-RDC
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DLC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO ERR-SCR-GFLD.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SPACES TO RDC-GLS-FLAG IN RDC.
      *     MOVE SPACES TO RDC-IND-AINV IN RDC.
      *     MOVE SPACES TO RDC-COD-OINV IN RDC.
           MOVE SPACES TO RDC-GLS-DISP IN RDC.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO RDC-STP-IINV IN RDC.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
      *        MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE STO-MODIFICADA IN STO-VARI TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
               MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC
               MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   MOVE STO-MODIFICADA IN STO-VARI
                                       TO OPC-MSC-STAT IN OPC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-OPC.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY COLWGENG.
      * ISP ES NECESARIO GUARDAR RQA CUANDO SE MUEVE POR PFS
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY COLWGPMP.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF SCR_GIKY_VAL_CON_IKY OR FIN_CMN_ING
      *<<<< SCR_GIKY_VAL_CON_IKY OR FIN_CMN_ING
           IF FRM-FFLD = FRM-FFLD-PF10 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM SET-ENG
               PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-VEC-ENG
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'MSGKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
               PERFORM ING-FPEN-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-RDC.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       PUT-RCD-RDC SECTION.
       INI-PUT-RCD-RDC.
           IF PGM-STAT-RCD-NUL
               GO TO FIN-PUT-RCD-RDC.
           IF NOT PGM-STAT-RCD-OKS
               PERFORM CLR-RCD-RDC
               GO TO FIN-PUT-RCD-RDC.
           MOVE RCD-GLS-DIRE IN RCD TO RCD-GLS-DIRE IN RDC-FLD.
           MOVE RCD-COD-LUGA IN RCD TO RCD-COD-LUGA IN RDC-FLD.
           MOVE RCD-GLS-FONO IN RCD TO RCD-GLS-FONO IN RDC-FLD.
       FIN-PUT-RCD-RDC.
           EXIT.

       PUT-OPC-RDC SECTION.
       INI-PUT-OPC-RDC.
           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-RDC.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-RDC
               GO TO FIN-PUT-OPC-RDC.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN RDC-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN RDC-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN RDC-FLD.
           MOVE OPC-COD-COOC IN OPC TO OPC-COD-COOC IN RDC-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN RDC-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN RDC-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN RDC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN RDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN RDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN RDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN RDC-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN RDC-FLD > SPACES
               MOVE OPC-COD-OFOC IN RDC-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN RDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-COOC IN RDC-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN RDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COOC IN RDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN RDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN RDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN RDC-FLD.
       FIN-PUT-OPC-RDC.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       SET-ENG SECTION.
       INI-SET-ENG.
      *     IF SCR-IND-EOV IN SCR-VARI = 'S'
      *          MOVE 'CO13COLPAEVCCOLFEVCCOLAEVC' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
      *     ELSE
      *          MOVE 'KO33COLPAVENCOLFVENCOLAVEN' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV).

           IF SCR-IND-EOV IN SCR-VARI = 'S'
                MOVE 'KQ13COLPQEVCCOLFEVCCOLAEVC' TO
                        WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                MOVE 'KU13COLPUEVC'               TO
                        WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV)
           ELSE
                MOVE 'KQ33COLPQVENCOLFVENCOLAVEN' TO
                        WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
                MOVE 'KU33COLPUVEN'               TO
                        WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV).
       FIN-SET-ENG.
           EXIT.

       HBL-KEY-RDC SECTION.
       INI-HBL-KEY-RDC.
           MOVE SCR-INST-GKY TO SCR-INST.
      *ISP   25-JUL-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           MOVE FRM-CPIM-AEY TO RDC-CAI-IOPC-ATR IN RDC-FLD.
           MOVE FRM-CPIM-AEY TO RDC-IIC-IOPC-ATR IN RDC-FLD.
           MOVE FRM-CPIM-AEY TO RDC-NUM-IDLC-ATR IN RDC-FLD.
           MOVE +4           TO RDC-CAI-IOPC-LEN IN RDC-FLD.
           MOVE -1           TO DBC-NUM-ICLI-LEN IN RDC-FLD.
           PERFORM SCR-CLRA-RDC.
           MOVE SCR-NUM-IDOC TO RDC-NUM-IDLC IN RDC-FLD.
           MOVE SCR-CAI-IOPC TO RDC-CAI-IOPC IN RDC-FLD.
           MOVE SCR-IIC-IOPC TO RDC-IIC-IOPC IN RDC-FLD.

      * ISP SCR-DMSG LIMPIA TODO Y HACE STP-EXIT
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.

      *ISP SIEMPRE VA A BUSCAR DATOS DE OPC Y LOS CARGA
           MOVE SCR-CAI-IOPC IN SCR-VARI TO OPC-CAI-IOPC IN OPC.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               PERFORM CLR-OPC-RDC
           ELSE
               PERFORM PUT-OPC-RDC.
           PERFORM EDT-KEY-RDC.
           PERFORM EDT-FLD-RDC.

           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM SCR-EXIT
           ELSE
               PERFORM SCR-PUTA.

      *     IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
      *         MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
      *         PERFORM SCR-INIT
      *     ELSE
      *         PERFORM SCR-PUTA.
      *     PERFORM SCR-EXIT.
       FIN-HBL-KEY-RDC.
           EXIT.

       BUS-OPE SECTION.
       INI-BUS-OPE.
           MOVE RDC-CAI-IOPC IN RDC TO OPC-CAI-IOPC IN OPC.
           MOVE RDC-IIC-IOPC IN RDC TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-OPE
           ELSE
               IF SCR-CCPP = 'ING' OR ( SCR-CCPP = 'ACT' AND
                  NOT PGM-STAT-RDC-OKS )
      *ISP CUANDO VIENE DE PROGRAMA OPC ( ENGANCHADO ) YA HIZO EL PUT
      *    A LA PANTALLA EN HBL-KEY
                   PERFORM PUT-OPC-RDC.
               MOVE PGM-STAT-RDC TO FIO-STAT.
       FIN-BUS-OPE.
           EXIT.

       BUS-DLC SECTION.
       INI-BUS-DLC.
           IF RDC-NUM-IDLC IN RDC NOT > ZEROES
               MOVE '00' TO FIO-STAT
               GO TO FIN-BUS-DLC.
           MOVE RDC-CAI-IOPC IN RDC TO DLC-CAI-IOPC IN DLC.
           MOVE RDC-IIC-IOPC IN RDC TO DLC-IIC-IOPC IN DLC.
           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-BUS-DLC.
           EXIT.

       BUS-CLI SECTION.
       INI-BUS-CLI.
           MOVE RDC-CAI-ICLI IN RDC TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI IN RDC TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO RDC-CAI-ICLI IN RDC-FLD
               MOVE SPACES TO RDC-IIC-ICLI IN RDC-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN RDC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN RDC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN RDC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN RDC-FLD
               MOVE SPACES TO DBC-GLS-NOMC IN RDC-FLD
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE RDC-CIC-ICLI IN RDC TO FRM-MEN2
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN RDC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RDC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RDC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN RDC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN RDC-FLD
               MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC-FLD
               MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC-FLD
               MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-DBC.
       FIN-BUS-CLI.
           EXIT.

       BUS-RCD SECTION.
       INI-BUS-RCD.
           IF RDC-NUM-DIRE IN RDC > ZEROES
               MOVE RDC-CAI-ICLI IN RDC TO RCD-CAI-ICLI IN RCD
               MOVE RDC-IIC-ICLI IN RDC TO RCD-IIC-ICLI IN RCD
               MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD
               MOVE 'RCD-KEY-IRCD' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF FIO-STAT-OKS
                    MOVE '00' TO PGM-STAT-RCD
               ELSE
                    MOVE  SPACES TO RCD-GLS-DIRE IN RCD
           ELSE
              PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD > SPACES
               MOVE '00' TO PGM-STAT-RCD
               PERFORM BUS-LUGA
               MOVE RCD-NUM-DIRE IN RCD TO RDC-NUM-DIRE IN RDC-FLD
               PERFORM PUT-RCD-RDC.
       FIN-BUS-RCD.
           EXIT.

       BUS-LUGA SECTION.
       INI-BUS-LUGA.
           MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA IN WSS-VARI.
           IF WSS-IND-LUGA IN WSS-VARI = 'P'
               MOVE 'PAI' TO TAB-COD-TTAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
               MOVE 'COM' TO TAB-COD-TTAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC TO FRM-GLS-LUGA IN RDC-FLD.
       FIN-BUS-LUGA.
           EXIT.

       VAL-LUGA SECTION.
       INI-VAL-LUGA.
           MOVE RCD-COD-LUGA IN RDC-FLD TO WSS-COD-LUGA IN WSS-VARI.
           IF WSS-IND-LUGA IN WSS-VARI = 'P'
               MOVE 'PAI' TO TAB-COD-TTAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
               MOVE 'COM' TO TAB-COD-TTAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              RCD-COD-LUGA IN RDC-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN RDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LUGA IN RDC-FLD.
       FIN-VAL-LUGA.
           EXIT.

       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY SGCBFDBC.
       COPY SGCBFRCD.

       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGPES.
       COPY TABBBUSR.
       COPY GNSBVCOD.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY GNSBVTAB.
       COPY TABBFUSR.
       COPY TABBFVLR.
       COPY SGCBGDOM.
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO RDC-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO RDC-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-RDC.
           MOVE SCR-MENS-EXT TO RDC-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE RDC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.

      *>>>>
*% END
