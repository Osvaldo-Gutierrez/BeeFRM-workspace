*%! Codigo adicional para archivo
*% IF FIN_KEY_ICG_ICG
      *<<<< FIN_KEY_ICG_ICG
           MOVE 'INT' TO ICG-IND-TTAS IN ICG.
           MOVE ICG-NUM-IVCT IN ICG TO WSS-NUM-IVCT.
           MOVE ZEROES TO ICG-NUM-IVCT IN ICG.
      *>>>>
*% END
*% IF FIN_PUT_ICG_ICG
      *<<<< FIN_PUT_ICG_ICG
           IF ICG-COD-CVTI IN ICG-FLD > SPACES
               MOVE 'I'                     TO VLR-MSC-TVAL IN VLR
               MOVE ICG-COD-CVTI IN ICG-FLD TO VLR-COD-CVAL IN VLR
               MOVE ICG-MSC-PBTI IN ICG-FLD TO VLR-COD-TCAM IN VLR
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN ICG-FLD.
           MOVE WSS-NUM-IVCT TO ICG-NUM-IVCT IN ICG-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_ICG
      *<<<< INI_VAL_CON_KEY_ICG
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8     
               GO TO FIN-VAL-CON-KEY-ICG.
      *>>>>
*% END
*% IF INI_ICG_FEC_FINI
      *<<<< INI_ICG_FEC_FINI
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF INI_ICG_FEC_FTER
      *<<<< INI_ICG_FEC_FTER
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_ICG
      *<<<< FIN_VAL_CON_IKY_ICG
           IF ICG-IIC-IOPC IN ICG-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'IICIOPCNOCON' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-ICG.
           IF ICG-NUM-ICAN IN ICG-FLD NOT > ZEROES AND
              ICG-NUM-IVCT IN ICG-FLD     > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMICANIVCTI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-ICG.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_ICG
      *<<<< FIN_VAL_CON_KEY_ICG
           IF ICG-IIC-IOPC IN ICG-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'IICIOPCNOCON' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-ICG.
           IF ICG-NUM-ICAN IN ICG-FLD NOT > ZEROES AND
              ICG-NUM-IVCT IN ICG-FLD     > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMICANIVCTI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-ICG.
           MOVE SPACES TO ICG-CAI-IOPV IN ICG-FLD.
           MOVE SPACES TO ICG-IIC-IOPV IN ICG-FLD.
           IF ICG-NUM-ICAN IN ICG-FLD > ZEROES AND
              ICG-NUM-IVCT IN ICG-FLD > ZEROES
               MOVE ICG-CAI-IOPC IN ICG-FLD TO ICG-CAI-IOPV IN ICG-FLD
               MOVE ICG-IIC-IOPC IN ICG-FLD TO ICG-IIC-IOPV IN ICG-FLD.
      *>>>>
*% END
*% IF VAL_CON_FLD_ICG
      *<<<< VAL_CON_FLD_ICG
      *ISP PREGUNTA ANTIGUA
      *     IF ICG-IND-TTAS IN ICG-FLD = 'INT'
           MOVE ICG-MSC-BCTI IN ICG-FLD TO ICG-MSC-BCTI IN ICG.
           MOVE ICG-MSC-PBTI IN ICG-FLD TO ICG-MSC-PBTI IN ICG.
           MOVE ICG-MSC-BPBT IN ICG-FLD TO ICG-MSC-BPBT IN ICG.
           MOVE ICG-MSC-SPBT IN ICG-FLD TO ICG-MSC-SPBT IN ICG.
           MOVE ICG-COD-CVTI IN ICG-FLD TO ICG-COD-CVTI IN ICG.
           MOVE ICG-MSC-TFPR IN ICG-FLD TO ICG-MSC-TFPR IN ICG.
           MOVE ICG-NUM-PREP IN ICG-FLD TO ICG-NUM-PREP IN ICG.
           MOVE ICG-MSC-UTPR IN ICG-FLD TO ICG-MSC-UTPR IN ICG.
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'INT' TO TAB-COD-TTAB IN TAB.
           MOVE ICG-COD-TINT IN ICG TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'  OR 'COD    NVG'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTINT' TO MSG-COD-TMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-ICG.
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-CON-FLD-ICG.
      *ALD/6-OCT-1988
           IF POC-IND-MTIC IN POC = 'S' AND
              ( POC-COD-TIPT IN POC > SPACES OR
                POC-COD-CVTI IN POC > SPACES OR
                POC-MSC-TFPR IN POC > SPACES OR
                POC-NUM-PREP IN POC > ZEROES OR
                POC-MSC-UTPR IN POC > SPACES )
                GO TO CON-VAL-CON-FLD-ICG.

           IF POC-COD-TINT IN POC NOT = ICG-COD-TINT IN ICG AND
              ( POC-COD-TIPT IN POC > SPACES OR
                POC-COD-CVTI IN POC > SPACES OR
                POC-MSC-TFPR IN POC > SPACES OR
                POC-NUM-PREP IN POC > ZEROES OR
                POC-MSC-UTPR IN POC > SPACES )
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'ITRTINTNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-TINT IN POC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-ICG.
      *
       CON-VAL-CON-FLD-ICG.
      *>>>>
*% END
*% IF ICG_IND_TTAS
      *<<<< ICG_IND_TTAS
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8     
               GO TO FIN-VAL-ICG-IND-TTAS.
      *>>>>
*% END
*% IF FIN_ICG_MSC_BCTI
      *<<<< FIN_ICG_MSC_BCTI
           MOVE ICG-CAI-IOPC IN ICG-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE ICG-IIC-IOPC IN ICG-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
               MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
               MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
               MOVE ZEROES              TO POC-NUM-IPOC IN POC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-POC
               MOVE FIO-STAT TO PGM-STAT-POC.
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-BCTI.
           IF POC-MSC-BCTI IN POC NOT = ICG-MSC-BCTI IN ICG-FLD AND
              POC-MSC-BCTI IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCBCTINOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-BCTI IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-BCTI.
       CON-VAL-ICG-MSC-BCTI.
      *>>>>
*% END
*% IF FIN_ICG_MSC_PBTI
      *<<<< FIN_ICG_MSC_PBTI
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-PBTI.
           IF POC-MSC-PBTI IN POC NOT = ICG-MSC-PBTI IN ICG-FLD AND
              POC-MSC-PBTI IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCPBTINOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-PBTI IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-PBTI.
       CON-VAL-ICG-MSC-PBTI.
      *>>>>
*% END
*% IF FIN_ICG_MSC_BPBT
      *<<<< FIN_ICG_MSC_BPBT
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-BPBT.
           IF POC-MSC-BPBT IN POC NOT = ICG-MSC-BPBT IN ICG-FLD AND
              POC-MSC-BPBT IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCBPBTNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-BPBT IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-BPBT.
       CON-VAL-ICG-MSC-BPBT.
      *>>>>
*% END
*% IF FIN_ICG_MSC_SPBT
      *<<<< FIN_ICG_MSC_SPBT
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-SPBT.
           IF POC-MSC-SPBT IN POC NOT = ICG-MSC-SPBT IN ICG-FLD AND
              POC-MSC-SPBT IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCSPBTNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-SPBT IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-SPBT.
       CON-VAL-ICG-MSC-SPBT.
      *>>>>
*% END
*% IF ICG_COD_CVTI
      *<<<< ICG-COD-CVTI
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-COD-CVTI.
           IF POC-COD-CVTI IN POC NOT = ICG-COD-CVTI IN ICG-FLD AND
              POC-COD-CVTI IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODCVTINOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-CVTI IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-COD-CVTI.
       CON-VAL-ICG-COD-CVTI.
      *>>>>
*% END
*% IF ICG_COD_CVTI
      *<<<< ICG_COD_CVTI
           IF ICG-COD-CVTI IN ICG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CVTI IN ICG-FLD
               GO TO FIN-VAL-ICG-COD-CVTI.
           MOVE 'I'                     TO VLR-MSC-TVAL IN VLR.
           MOVE ICG-COD-CVTI IN ICG-FLD TO VLR-COD-CVAL IN VLR.
           MOVE ICG-MSC-PBTI IN ICG-FLD TO VLR-COD-TCAM IN VLR.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              VLR-COD-VCAM IN VLR  > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN ICG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CVTI IN ICG-FLD.
      *>>>>
*% END
*% IF FIN_ICG_MSC_TFPR
      *<<<< FIN_ICG_MSC_TFPR
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-TFPR.
           IF POC-MSC-TFPR IN POC NOT = ICG-MSC-TFPR IN ICG-FLD AND
              POC-MSC-TFPR IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCTFPRNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-TFPR IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-TFPR.
       CON-VAL-ICG-MSC-TFPR.
      *>>>>
*% END
*% IF ICG_NUM_PREP
      *<<<< ICG-NUM-PREP
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-NUM-PREP.
           IF POC-NUM-PREP IN POC NOT = ICG-NUM-PREP IN ICG-FLD AND
              POC-NUM-PREP IN POC > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMPREPNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-NUM-PREP IN POC TO WSS-NUM-VAL1-EDT IN WSS-VARI
               MOVE ZEROES              TO WSS-IND-DMA1     IN WSS-VARI
               MOVE SPACES              TO WSS-GLS-GUI2     IN WSS-VARI
               MOVE ZEROES              TO WSS-NUM-VAL2-EDT IN WSS-VARI
               MOVE SPACES              TO WSS-IND-DMA2     IN WSS-VARI
               MOVE WSS-MEN2 IN WSS-VARI TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-NUM-PREP.
       CON-VAL-ICG-NUM-PREP.
      *>>>>
*% END
*% IF FIN_ICG_MSC_UTPR
      *<<<< FIN_ICG_MSC_UTPR
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-MSC-UTPR.
           IF POC-MSC-UTPR IN POC NOT = ICG-MSC-UTPR IN ICG-FLD AND
              POC-MSC-UTPR IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCUTPRNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-UTPR IN POC  TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-MSC-UTPR.
       CON-VAL-ICG-MSC-UTPR.
      *>>>>
*% END
*% IF ICG_SGV_TINT
      *<<<< ICG_SGV_TINT
           IF ICG-COD-CVTI IN ICG-FLD > SPACES AND
              ICG-SGV-TINT IN ICG-FLD > 0
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'ICGTINTZRO=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-SGV-TINT.
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-SGV-TINT.
           IF ICG-COD-CVTI IN ICG-FLD > SPACES
               GO TO CON-VAL-ICG-SGV-TINT.
           IF ICG-SGV-TINT IN ICG-FLD = ZEROES AND
              POC-IND-TICE IN POC NOT = 'S'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTINTTINTZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-SGV-TINT.
           IF ICG-SGV-TINT IN ICG-FLD < ZEROES AND
              POC-IND-TINE IN POC NOT = 'S'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTINTTINTN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-SGV-TINT.
       CON-VAL-ICG-SGV-TINT.
      *>>>>
*% END
*% IF ICG_SGV_SPRD
      *<<<< ICG_SGV_SPRD
           IF NOT PGM-STAT-POC-OKS
               GO TO CON-VAL-ICG-SGV-SPRD.
           IF ICG-COD-CVTI IN ICG-FLD NOT > SPACES
               GO TO CON-VAL-ICG-SGV-SPRD.
           IF ICG-SGV-SPRD IN ICG-FLD = ZEROES AND
              POC-IND-TICE IN POC NOT = 'S'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTINTTINTZ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-SGV-SPRD.
           IF ICG-SGV-SPRD IN ICG-FLD < ZEROES AND
              POC-IND-TINE IN POC NOT = 'S'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTINTTINTN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ICG-SGV-SPRD.
       CON-VAL-ICG-SGV-SPRD.
      *>>>>
*% END
