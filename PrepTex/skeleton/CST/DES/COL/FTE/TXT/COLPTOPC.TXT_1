*%! Codigo adicional
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
      *ALD/22-AUG-1988
           03  WSS-I                              PIC 9(02).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL1-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA1                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-GLS-GUI2                      PIC X(01).
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-NUM-VAL2-EDT                   PIC ----.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-IND-DMA2                      PIC X(01).
           03  PGM-STAT-POC          VALUE '23'   PIC X(02).              
               88  PGM-STAT-POC-OKS  VALUE '00'.                             
               88  PGM-STAT-POC-NUL  VALUE '  '.                             
           03  WSS-NUM-ACTI                       PIC 9(01).
           03  WSS-NUM-COTO                       PIC 9(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-NUM-TVEN                       PIC 9(03).
           03  WSS-VAL-TEVC             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TCAP             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-TVEN             COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-NDLC             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PDIR             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PIND             COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-FEDT                   PIC  --.---.--9,99999.
           03  WSS-NUM-FALF                   PIC  --.---.--9,99999.
           03  WSS-VAL-CRED   COMP-3 VALUE ZEROES PIC 9(11)V9(04).
           03  WSS-IND-TMON          VALUE SPACES PIC X(01).
           03  WSS-IND-TMMN          VALUE 'N'    PIC X(01).
           03  WSS-IND-TMMX          VALUE 'E'    PIC X(01).
      *
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  WSS-VAL-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-AUX-IMPU   COMP-3 VALUE 0      PIC 9(11)V9(04).
           03  WSS-VAL-GNOT   COMP-3 VALUE 0      PIC 9(11)V9(04).

           03  WSS-SGV-LIQU          VALUE +0     PIC S9(13)V9(05)
                                     SIGN LEADING SEPARATE.
           03  WSS-SGV-LIQU-ALF                   PIC X(24).
           03  WSS-SGV-LIQU-EDT REDEFINES WSS-SGV-LIQU-ALF
                                     PIC --.---.---.---.---,-----.

           03  WSS-NUM-TABN          VALUE 0      PIC 9(03).
           03  WSS-NUM-TABZ          VALUE 0      PIC 9(03).
           03  WSS-INTR                           PIC X(01).
           03  WSS-KEY-ICYA.
               05  WSS-CIC-IOPC                   PIC X(12).
               05  WSS-NUM-ICAN                   PIC X(03).
               05  WSS-NUM-ICYA                   PIC 9(01).
           03  WSS-FEC-FPVC VALUE ZEROES.
               05  WSS-NUM-SPVC                   PIC 9(02).
               05  WSS-NUM-APVC                   PIC 9(02).
               05  WSS-NUM-MPVC                   PIC 9(02).
               05  WSS-NUM-DPVC                   PIC 9(02).
           03  WSS-NUM-DESD                  COMP PIC 9(04).
           03  WSS-NUM-IEVC                       PIC 9(03).
           03  WSS-NUM-IDLC                       PIC 9(03).
           03  WSS-IND-CAUT                       PIC X(01).
      *JSS
       01  SCR-INST-BRW              VALUE 'BRW'  PIC X(03).
      *
      *Registros de GENESIS
       COPY GNSBRTAB.
      *Registros de TABLAS
       COPY TABBROFI.
       COPY TABBRUSR.
      *ALD/22-AUG-1988
       COPY TABBRCAM.
      *Registros de CLIENTES
       COPY SGCBRDBC.
      *Registros de Colocaciones
       COPY COLBRRDC.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRROV.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRIMP.
       COPY COLBRICG.
       COPY COLBRNTR.
       COPY COLBRTOC.
       COPY COLBRPOC.
      *
       COPY COLWGUVD.
      *
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *
       COPY GNSWGIDC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
      *
       COPY GNSWGPES.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *ALD/22-AUG-1988
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-NTR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF OPC-IIC-IOPC IN OPC-FLD > ZEROES
               GO TO CON-FND-KEY
           ELSE
           IF DBC-NUM-ICLI IN OPC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN OPC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN OPC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               UNSTRING DBC-GLS-NOMC IN OPC-FLD DELIMITED BY '/' INTO
                                        DBC-GLS-APAT IN DBC
                                        DBC-GLS-AMAT IN DBC
                                        DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.

           MOVE '00' TO PGM-STAT-OPC.
           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               GO TO OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    INCKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO ANL-CLI.
       OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-RDC.
           MOVE 'IDLC' TO SCR-KEY-IRDC.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN OPC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO ANL-CLI.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ADR-DBC-REQA TO SCR-RQA1.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
       ANL-CLI.
           PERFORM ANL-KEY-ALL.
           IF MSG-COD-MENS NOT = SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
       REC-OPC-STAT.
           MOVE PGM-STAT-OPC TO FIO-STAT.
      *>>>>
*% END
*% IF INI_SCR_TRL
      *<<<< INI_SCR_TRL
           IF OPC-MSC-STAT IN OPC = 'A'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
           ELSE
               IF OPC-MSC-STAT IN OPC = 'L'
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'OPC    LIQYA' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-CON TO SCR-STAT
               ELSE
                   PERFORM VRF-ROPC
                   IF FRM-SUAR = FRM-SUAR-MAL
                       MOVE SCR-STAT-CON TO SCR-STAT
                   ELSE
                       MOVE SPACES TO FRM-MENS
                       PERFORM LIQ-ROPC
                       IF MSG-COD-MENS > SPACES
                           MOVE MSG-GLS-DESC TO FRM-MEN1
                           MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>>
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOLIQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE  MSG-GLS-DESC TO FRM-MENS
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-NUM-TABN.
           MOVE 0 TO WSS-NUM-TABZ.

           MOVE OPC-CAI-IOPC IN OPC-FLD TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES                  TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES                  TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *Lee cada CYA ( ABONO )
       LUP-CMN-ACC.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
               CYA-CAI-IOPC IN CYA = OPC-CAI-IOPC IN OPC-FLD AND
               CYA-IIC-IOPC IN CYA = OPC-IIC-IOPC IN OPC-FLD AND
               CYA-NUM-ICAN IN CYA = ZEROES )
               GO TO ACT-CMN-ACC.
           ADD 1 TO WSS-NUM-TABN.
      *Acumula el valor liquido ( > 0 ) del CYA en particular 
           IF CYA-SGV-LIQU IN CYA NOT > ZEROES OR
              CYA-IND-FREE IN CYA = 'S'
               MOVE CYA-KEY-ICYA IN CYA TO WSS-KEY-ICYA IN WSS-VARI
               ADD 1 TO WSS-NUM-TABZ
           ELSE
               ADD CYA-SGV-LIQU IN CYA TO WSS-SGV-LIQU IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CMN-ACC.

       ACT-CMN-ACC.
           IF WSS-NUM-TABN = ZEROES
               MOVE 'CYA    NOABN' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.
           IF WSS-NUM-TABZ NOT = 1
               MOVE 'CYA    ABNN1' TO MSG-COD-MENS
               MOVE WSS-NUM-TABZ   TO FRM-MEN2
               GO TO MSG-CMN-ACC.
      *ALD
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           IF OPC-MSC-TVOC IN OPC-FLD = MSC-COD-CMSC IN MSC
               MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
               MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
               MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
               MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
               MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
               MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
               MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
               PERFORM GET-VCAM
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MULTIPLY CAM-SGV-VCAM IN CAM BY WSS-SGV-LIQU IN
                          WSS-VARI GIVING WSS-SGV-LIQU IN WSS-VARI
               ELSE
                   IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
                       MOVE 1 TO CAM-SGV-VCAM IN CAM
                       MOVE SPACES TO MSG-COD-MENS IN MSG
                   ELSE
                       GO TO MSG-CMN-ACC.
      *
           IF WSS-SGV-LIQU IN WSS-VARI > OPC-SGV-LIQU IN OPC-FLD
               MOVE 'OPCLIQUSABN<' TO MSG-COD-MENS
               MOVE WSS-SGV-LIQU TO WSS-SGV-LIQU-EDT
               MOVE WSS-SGV-LIQU-ALF TO FRM-MEN2
               GO TO MSG-CMN-ACC.

           MOVE WSS-KEY-ICYA IN WSS-VARI TO CYA-KEY-ICYA IN CYA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NGKUP' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.

           SUBTRACT WSS-SGV-LIQU IN WSS-VARI FROM
                    OPC-SGV-LIQU IN OPC-FLD  GIVING CYA-SGV-LIQU IN CYA.

      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI 
               DIVIDE CYA-SGV-LIQU IN CYA BY CAM-SGV-VCAM IN CAM
                      GIVING CYA-SGV-LIQU IN CYA ROUNDED.
      *
           MOVE 'S' TO CYA-IND-FREE IN CYA.

           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO CYA-STP-IINV IN CYA.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NGKUP' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.

           PERFORM KEY-OPC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.

           PERFORM RET-OPC-OPC.
           MOVE 'L' TO OPC-MSC-STAT IN OPC.

           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO OPC-STP-ITRN IN OPC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.

           IF OPC-NUM-IEVC IN OPC NOT = ZEROES
               GO TO MSG-CMN-ACC.

           MOVE OPC-CAI-IOPC IN OPC-FLD TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO EVC-IIC-IOPC IN EVC.
           MOVE 0                       TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       EVC-CMN-ACC.
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS AND
              EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC-FLD AND
              EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC-FLD
               IF EVC-FEC-FPVC IN EVC < WSS-FEC-FPVC IN WSS-VARI OR
                  WSS-FEC-FPVC IN WSS-VARI = ZEROES
                   MOVE EVC-FEC-FPVC IN EVC TO WSS-FEC-FPVC IN WSS-VARI
                   MOVE EVC-NUM-DESD IN EVC TO WSS-NUM-DESD IN WSS-VARI
                   MOVE EVC-NUM-IEVC IN EVC TO WSS-NUM-IEVC IN WSS-VARI
                   MOVE EVC-NUM-IDLC IN EVC TO WSS-NUM-IDLC IN WSS-VARI
                   MOVE EVC-IND-CAUT IN EVC TO WSS-IND-CAUT IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO EVC-CMN-ACC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO EVC-CMN-ACC.

           IF WSS-FEC-FPVC IN WSS-VARI = ZEROES
               MOVE 'EVC    NEX' TO MSG-COD-MENS
               GO TO MSG-CMN-ACC.

           MOVE WSS-NUM-DPVC IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPVC IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPVC IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APVC IN WSS-VARI TO FEC-ITM4.
           MOVE WSS-NUM-DESD IN WSS-VARI TO FEC-NDIA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FEC-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.

           MOVE FEC-VHBL-S  TO FEC-VHBL.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE FEC-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.
           IF FEC-STAT-FER
               MOVE FEC-SIG-HBL TO FEC-CMND
      *        PERFORM PRO-FEC
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE FEC-MENS TO FRM-MENS
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-CMN-ACC.

           MOVE OPC-CAI-IOPC IN OPC-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE 1                       TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.

           MOVE WSS-FEC-FPVC IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE FEC-ITM1                 TO VEN-NUM-DIMV IN VEN.
           MOVE FEC-ITM2                 TO VEN-NUM-MIMV IN VEN.
           MOVE FEC-ITM3                 TO VEN-NUM-SIMV IN VEN.
           MOVE FEC-ITM4                 TO VEN-NUM-AIMV IN VEN.

      *JSS Pendiente
           MOVE ZEROES                   TO VEN-VAL-CAPI IN VEN.
      *
           MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN.
      *JSS Pendiente
           MOVE ZEROES                   TO VEN-VAL-IDNI IN VEN.
           MOVE ZEROES                   TO VEN-VAL-FINA IN VEN.
      *
           MOVE VEN-VAL-FINA IN VEN      TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES                   TO VEN-IND-SCTB IN VEN.
           MOVE 1                        TO VEN-NUM-IVCT IN VEN.
           MOVE WSS-NUM-IEVC IN WSS-VARI TO VEN-NUM-IEVC IN VEN.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO VEN-NUM-IDLC IN VEN.
           MOVE SPACES                   TO VEN-IND-SCBZ IN VEN.
           MOVE WSS-IND-CAUT IN WSS-VARI TO VEN-IND-CAUT IN VEN.
      *     MOVE SPACES                   TO VEN-GLS-DISP IN VEN.

           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO VEN-STP-IINV IN VEN.

           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-CMN-ACC.

       MSG-CMN-ACC.
           IF MSG-COD-MENS NOT > SPACES
               MOVE 'OPC    SILIQ' TO MSG-COD-MENS.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           IF MSG-COD-MENS = 'OPC    SILIQ' 
               PERFORM PRO-OPC.
           GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBPFEC 
       RET-OPC-OPC SECTION.
       INI-RET-OPC-OPC.
           MOVE OPC-MSC-TVOC IN OPC-FLD TO OPC-MSC-TVOC IN OPC.
           MOVE OPC-COD-TOOC IN OPC-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-OFOC IN OPC-FLD TO OPC-COD-OFOC IN OPC.
           MOVE OPC-COD-VCOC IN OPC-FLD TO OPC-COD-VCOC IN OPC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO OPC-COD-AOOC IN OPC.
           MOVE OPC-VAL-CRED IN OPC-FLD TO OPC-VAL-CRED IN OPC.
           MOVE OPC-VAL-SCRE IN OPC-FLD TO OPC-VAL-SCRE IN OPC.
           MOVE OPC-CAI-ILDC IN OPC-FLD TO OPC-CAI-ILDC IN OPC.
           MOVE OPC-IIC-ILDC IN OPC-FLD TO OPC-IIC-ILDC IN OPC.
           MOVE OPC-NUM-VCVG IN OPC-FLD TO OPC-NUM-VCVG IN OPC.
           MOVE OPC-IND-RENO IN OPC-FLD TO OPC-IND-RENO IN OPC.
           MOVE OPC-CAI-ICEN IN OPC-FLD TO OPC-CAI-ICEN IN OPC.
           MOVE OPC-IIC-ICEN IN OPC-FLD TO OPC-IIC-ICEN IN OPC.
           MOVE OPC-COD-SEGD IN OPC-FLD TO OPC-COD-SEGD IN OPC.
           MOVE OPC-NUM-DINP IN OPC-FLD TO OPC-NUM-DINP IN OPC.
           MOVE OPC-NUM-MINP IN OPC-FLD TO OPC-NUM-MINP IN OPC.
           MOVE OPC-NUM-SINP IN OPC-FLD TO OPC-NUM-SINP IN OPC.
           MOVE OPC-NUM-AINP IN OPC-FLD TO OPC-NUM-AINP IN OPC.
           MOVE OPC-NUM-DCOL IN OPC-FLD TO OPC-NUM-DCOL IN OPC.
           MOVE OPC-NUM-MCOL IN OPC-FLD TO OPC-NUM-MCOL IN OPC.
           MOVE OPC-NUM-SCOL IN OPC-FLD TO OPC-NUM-SCOL IN OPC.
           MOVE OPC-NUM-ACOL IN OPC-FLD TO OPC-NUM-ACOL IN OPC.
           MOVE OPC-NUM-DING IN OPC-FLD TO OPC-NUM-DING IN OPC.
           MOVE OPC-NUM-MING IN OPC-FLD TO OPC-NUM-MING IN OPC.
           MOVE OPC-NUM-SING IN OPC-FLD TO OPC-NUM-SING IN OPC.
           MOVE OPC-NUM-AING IN OPC-FLD TO OPC-NUM-AING IN OPC.
           MOVE OPC-VAL-SEGD IN OPC-FLD TO OPC-VAL-SEGD IN OPC.
           MOVE OPC-IND-GARA IN OPC-FLD TO OPC-IND-GARA IN OPC.
           MOVE OPC-SGV-VCOM IN OPC-FLD TO OPC-SGV-VCOM IN OPC.
           MOVE OPC-MSC-MCVF IN OPC-FLD TO OPC-MSC-MCVF IN OPC.
           MOVE OPC-IND-AFER IN OPC-FLD TO OPC-IND-AFER IN OPC.
           MOVE OPC-VAL-GAST IN OPC-FLD TO OPC-VAL-GAST IN OPC.
           MOVE OPC-SGV-LIQU IN OPC-FLD TO OPC-SGV-LIQU IN OPC.
           MOVE OPC-COD-RMOC IN OPC-FLD TO OPC-COD-RMOC IN OPC.
           MOVE OPC-COD-CDOC IN OPC-FLD TO OPC-COD-CDOC IN OPC.
       FIN-RET-OPC-OPC.
           EXIT.

       ANL-KEY-OPC SECTION.
       INI-ANL-KEY-OPC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-OPC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD
               PERFORM BUS-DEU-DIR
               IF FIO-STAT-OKS
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NODIR' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-OPC.
           EXIT.

       ANL-KEY-ALL SECTION.
       INI-ANL-KEY-ALL.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-ANL-KEY-ALL.
           PERFORM GET-NXT-ITR.
           IF SCR-IND-MITR = 'M'
               MOVE 'MULTIPLES'  TO ITR-COD-TINT IN OPC-FLD
           ELSE
               MOVE '00' TO PGM-STAT-ITR
               PERFORM PUT-ITR-OPC.
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-COM
                PERFORM GET-NXT-COM
                IF SCR-IND-MCOM = 'M'
                    MOVE 'MULTIPLES' TO COM-COD-TINT IN OPC-FLD
                ELSE
                    PERFORM PUT-COM-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO COM-SGV-TINT IN OPC-FLD
                MOVE SPACES TO COM-COD-TINT IN OPC-FLD.
           PERFORM GET-CUR-CYA.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-CYA
                PERFORM GET-NXT-CYA
                IF SCR-IND-MCYA = 'M'
                    MOVE 'M'          TO CYA-IND-TCYA IN OPC-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-CYA-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE SPACES TO CYA-IND-TCYA IN OPC-FLD
                MOVE SPACES TO CYA-CAI-ICYA IN OPC-FLD
                MOVE ZEROES TO CYA-IIC-ICYA IN OPC-FLD.
           MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-AUT
               PERFORM PUT-AUT-OPC
           ELSE
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO AUT-IIC-ICYA IN OPC-FLD
               MOVE SPACES TO AUT-CAI-ICYA IN OPC-FLD.
           PERFORM GET-CUR-ROV.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-ROV.
       FIN-ANL-KEY-ALL.
           EXIT.

       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-DIR.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-DIR
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIR.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN OPC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN OPC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN OPC-FLD.
       FIN-PUT-DBC.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.

       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO SCR-IND-MITR
           ELSE
                MOVE SPACES TO SCR-IND-MITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.

       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.

       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO SCR-IND-MCOM
           ELSE
                MOVE SPACES TO SCR-IND-MCOM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.

       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CYA.
       FIN-GET-CUR-CYA.
           EXIT.

       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPC    MCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.

       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE 'ROV-KEY-IROV' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ROV.
       FIN-GET-CUR-ROV.
           EXIT.
      *
       LIQ-ROPC SECTION.
       INI-LIQ-ROPC.
           MOVE SPACES TO MSG-COD-MENS.
      *ALD/22-AUG-1988
      *Si es moneda Nacional transformar a Pesos
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           MOVE OPC-VAL-CRED IN OPC-FLD  TO WSS-VAL-CRED IN WSS-VARI.
           IF OPC-MSC-TVOC IN OPC-FLD = MSC-COD-CMSC IN MSC
               MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
               MOVE OPC-COD-VCOC IN OPC-FLD TO TAB-COD-CTAB IN TAB
               MOVE '0999  '                TO TAB-CIC-CTAB IN TAB
               MOVE OPC-NUM-DCOL IN OPC-FLD TO TAB-NUM-DTRN IN TAB
               MOVE OPC-NUM-MCOL IN OPC-FLD TO TAB-NUM-MTRN IN TAB
               MOVE OPC-NUM-SCOL IN OPC-FLD TO TAB-NUM-STRN IN TAB
               MOVE OPC-NUM-ACOL IN OPC-FLD TO TAB-NUM-ATRN IN TAB
               PERFORM GET-VCAM
               IF MSG-COD-MENS IN MSG NOT > SPACES
                   MULTIPLY CAM-SGV-VCAM IN CAM BY OPC-VAL-CRED IN
                            OPC-FLD GIVING WSS-VAL-CRED IN WSS-VARI
               ELSE
                   IF MSG-COD-MENS IN MSG = 'CODVCAMEQL'
                       MOVE 1 TO CAM-SGV-VCAM IN CAM
                       MOVE SPACES TO MSG-COD-MENS IN MSG
                       MOVE OPC-VAL-CRED IN OPC-FLD TO WSS-VAL-CRED IN
                                                       WSS-VARI
                   ELSE
                       GO TO MSG-LIQ-ROPC.
      *
      *Valor del Seguro
           MOVE ZEROES TO OPC-VAL-SEGD IN OPC-FLD.

      *Valor de Comision
           MOVE OPC-CAI-IOPC IN OPC-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES                  TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES                  TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG.
           MOVE 'COM'                   TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES                  TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN OPC-FLD AND
              ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN OPC-FLD AND
              ICG-NUM-ICAN IN ICG = ZEROES AND
              ICG-CIC-IOPV IN ICG = SPACES AND
              ICG-NUM-IVCT IN ICG = ZEROES AND
              ICG-IND-TTAS IN ICG = 'COM'
               MULTIPLY OPC-VAL-CRED IN OPC-FLD BY ICG-SGV-TINT IN ICG
                        GIVING OPC-SGV-VCOM IN OPC-FLD
           ELSE
               MOVE ZEROES TO OPC-SGV-VCOM IN OPC-FLD.

      *Valor del Impuesto y Gastos de Notario
           PERFORM OBT-VIMP-GNOT.
           IF MSG-COD-MENS > SPACES
               GO TO MSG-LIQ-ROPC.
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MULTIPLY CAM-SGV-VCAM IN CAM BY OPC-SGV-VCOM IN
                        OPC-FLD GIVING OPC-SGV-VCOM IN OPC-FLD.

           DIVIDE OPC-SGV-VCOM IN OPC-FLD BY 100
               GIVING OPC-SGV-VCOM IN OPC-FLD.

           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE OPC-SGV-VCOM IN OPC-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO OPC-SGV-VCOM IN OPC-FLD.
      *
           COMPUTE OPC-SGV-LIQU IN OPC-FLD =
      *ALD     OPC-VAL-CRED IN OPC-FLD - OPC-VAL-SEGD IN OPC-FLD -
               WSS-VAL-CRED IN WSS-VARI - OPC-VAL-SEGD IN OPC-FLD -
               OPC-VAL-GAST IN OPC-FLD - OPC-SGV-VCOM IN OPC-FLD -
               WSS-VAL-IMPU IN WSS-VARI - WSS-VAL-GNOT IN WSS-VARI.
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE OPC-SGV-LIQU IN OPC-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO OPC-SGV-LIQU IN OPC-FLD.
           GO TO FIN-LIQ-ROPC.
       MSG-LIQ-ROPC.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
       FIN-LIQ-ROPC.
           EXIT.

       OBT-VIMP-GNOT SECTION.
       INI-OBT-VIMP-GNOT.
           MOVE 0 TO WSS-VAL-IMPU IN WSS-VARI.
           MOVE 0 TO WSS-VAL-GNOT IN WSS-VARI.

           MOVE OPC-COD-TOOC IN OPC-FLD TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPCTOOCNEX'        TO MSG-COD-MENS
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
               GO TO FIN-OBT-VIMP-GNOT.

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE 'TOCOPECNEX'        TO MSG-COD-MENS
               MOVE MSC-COD-TABL IN MSC TO FRM-MEN2
               GO TO FIN-OBT-VIMP-GNOT.

           IF MSC-CIC-CMSC IN MSC = 'D'
               MOVE 'N' TO WSS-INTR
           ELSE
               MOVE 'S' TO WSS-INTR.

           MOVE OPC-CAI-IOPC IN OPC-FLD TO UVD-CAI-IOPC IN UVD.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO UVD-IIC-IOPC IN UVD.
           PERFORM BUS-UVD.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-OBT-VIMP-GNOT.

           MOVE OPC-CAI-IOPC IN OPC-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE 0                       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-VIMP-GNOT.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN OPC-FLD AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN OPC-FLD )
               GO TO FIN-OBT-VIMP-GNOT.
           MOVE OPC-COD-TOOC IN OPC-FLD TO OPC-COD-TOOC IN OPC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO OPC-COD-AOOC IN OPC.

      *Leer Tabla de Impuestos ( IMP )
           MOVE DLC-COD-TDOC IN DLC TO IMP-COD-TDOC IN IMP.
           MOVE DLC-MSC-TIMP IN DLC TO IMP-MSC-TIMP IN IMP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-IMP.
           IF NOT FIO-STAT-OKS
               MOVE 'IMP    NEX' TO MSG-COD-MENS
               MOVE IMP-COD-TABL IN IMP TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.

           IF WSS-INTR = 'S' AND DLC-COD-NOTC IN DLC > SPACES
      *Leer Tabla de Notarios ( NTR )
               MOVE DLC-COD-NOTC IN DLC TO NTR-COD-NOTA IN NTR
               MOVE OPC-COD-OFOC IN OPC TO NTR-COD-OFIC IN NTR
               MOVE DLC-COD-TDOC IN DLC TO NTR-COD-TDOC IN NTR
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-NTR
               IF NOT FIO-STAT-OKS
                   MOVE 'NTR    NEX' TO MSG-COD-MENS
                   MOVE NTR-COD-TABL IN NTR TO FRM-MEN2
                   MOVE FIO-BCK-OUT TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   GO TO FIN-OBT-VIMP-GNOT
               ELSE
      *SUMA el Gasto del Notario
                   ADD NTR-VAL-GNOT IN NTR TO WSS-VAL-GNOT IN WSS-VARI
           ELSE
               MOVE 0 TO NTR-VAL-GNOT IN NTR.

      *Obtiene Diferencia de Meses entre Fecha de Colocacion  ( OPC ) y
      *                                  Fecha de Vencimiento ( DLC )
           IF DLC-NUM-IDLC IN DLC > UVD-IMAX IN UVD
               MOVE 'DLCFVENNODET'      TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.

           MOVE OPC-FEC-FCOL IN OPC-FLD                  TO FEC-FEC1.
           MOVE DLC-NUM-DVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-DEC2.
           MOVE DLC-NUM-MVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-MEC2.
           MOVE DLC-NUM-SVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-SEC2.
           MOVE DLC-NUM-AVEN IN UVD(DLC-NUM-IDLC IN DLC) TO FEC-AEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *Despues cambiar a CAL-FEC.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.
           IF FEC-NDIA > 0
               ADD 1 TO FEC-NMES.

      *Calcula el valor de interes para el DLC en particular y lo SUMA
           MULTIPLY IMP-VAL-TIMP IN IMP BY FEC-NMES
               GIVING WSS-AUX-IMPU IN WSS-VARI.
           IF WSS-AUX-IMPU IN WSS-VARI > IMP-VAL-TOPE IN IMP
               MOVE IMP-VAL-TOPE IN IMP TO WSS-AUX-IMPU IN WSS-VARI.
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MULTIPLY CAM-SGV-VCAM IN CAM BY DLC-VAL-NDLC IN
                        DLC GIVING WSS-VAL-NDLC IN WSS-VARI
           ELSE
               MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-NDLC IN WSS-VARI.
      *    MULTIPLY WSS-AUX-IMPU IN WSS-VARI BY DLC-VAL-NDLC IN DLC
           MULTIPLY WSS-AUX-IMPU IN WSS-VARI BY WSS-VAL-NDLC IN WSS-VARI
               GIVING WSS-AUX-IMPU IN WSS-VARI.

           DIVIDE WSS-AUX-IMPU IN WSS-VARI BY 100
               GIVING WSS-AUX-IMPU IN WSS-VARI.
      *ALD
           IF WSS-IND-TMON IN WSS-VARI = WSS-IND-TMMN IN WSS-VARI
               MOVE WSS-AUX-IMPU IN WSS-VARI TO PES-SGV-DECI IN
                                                       PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-AUX-IMPU IN
                                                       WSS-VARI.
           ADD WSS-AUX-IMPU IN WSS-VARI TO WSS-VAL-IMPU IN WSS-VARI.

      * DEBE IMPLEMENTARSE EL FIO-GET-NXT-UPD......para no leer nuevamente
      *Actualiza el Valor del impuesto en el DLC particular
      *Actualiza el Gasto de Notario   en el DLC particular
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NGKUP' TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.


           MOVE WSS-AUX-IMPU IN WSS-VARI TO DLC-VAL-IMPU IN DLC.
           IF WSS-INTR = 'S'
               MOVE NTR-VAL-GNOT IN NTR  TO DLC-VAL-GNOT IN DLC
           ELSE
               MOVE ZEROES               TO DLC-VAL-GNOT IN DLC.
      *    MOVE DLC-FEC-FVEN IN UVD(DLC-NUM-IDLC IN DLC) TO
      *         DLC-FEC-FVEN IN DLC.

           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN TO DLC-STP-IINV IN DLC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NOUPD' TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               GO TO FIN-OBT-VIMP-GNOT.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-OBT-VIMP-GNOT.
       FIN-OBT-VIMP-GNOT.
           EXIT.


      *ALD/24-OCT-1988
       VRF-ROPC SECTION.
       INI-VRF-ROPC.
           PERFORM KEY-OPC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOUPD' TO MSG-COD-MENS
               MOVE OPC-KEY-IOPC IN OPC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VRF-ROPC.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM PRO-DLC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-RDC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-EVC.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-VEN.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-ITR.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-CYA.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-VRF-ROPC.
           PERFORM PRO-ROV.
           IF FRM-SUAR =  FRM-SUAR-MAL
                GO TO FIN-VRF-ROPC.
           PERFORM PRO-RCO.
           IF FRM-SUAR =  FRM-SUAR-MAL
                GO TO FIN-VRF-ROPC.
           IF OPC-NUM-IEVC IN OPC = ZEROES
               PERFORM SUM-EVC
               IF FRM-SUAR =  FRM-SUAR-MAL
                   GO TO FIN-VRF-ROPC
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM ULT-VEN
               IF FRM-SUAR =  FRM-SUAR-MAL
                   GO TO FIN-VRF-ROPC.
           MOVE 'V' TO OPC-MSC-STAT IN OPC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOUPD' TO MSG-COD-MENS
               MOVE OPC-KEY-IOPC IN OPC TO FRM-MEN2
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VRF-ROPC.
       FIN-VRF-ROPC.
           EXIT.

       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE ZEROES TO WSS-VAL-NDLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.            
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-DLC.
       LUP-INP-DLC.
           ADD DLC-VAL-NDLC TO WSS-VAL-NDLC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
               GO TO LUP-INP-DLC.
           IF OPC-VAL-CRED IN OPC NOT = WSS-VAL-NDLC
               MOVE WSS-VAL-NDLC TO WSS-NUM-FEDT
               MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALCREDNDLC=' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING WSS-NUM-FALF
                      MSG-GLS-DESC
                      WSS-NUM-FEDT
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-DLC.
       FIN-PRO-DLC.           
           EXIT.           

       PRO-RDC SECTION.
       INI-PRO-RDC.
           MOVE ZEROES TO WSS-NUM-PDIR.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES ) 
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-RDC.
       LUP-INP-RDC.
           MOVE ZEROES TO WSS-NUM-PIND.
           ADD RDC-VAL-LIMD TO WSS-NUM-PDIR.
           MOVE ADR-RDC-REQA TO ADR-AUX-REQA.
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE 1                   TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF ( FIO-STAT-OKS AND
                RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC )
                PERFORM VAL-DEU-IND.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-RDC.
           MOVE ADR-AUX-REQA TO ADR-RDC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
               RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
               RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-INP-RDC.
           IF WSS-NUM-PDIR < 100
               MOVE WSS-NUM-PDIR TO WSS-NUM-FEDT
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMPDIR100<' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      WSS-NUM-FEDT
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-RDC.
       FIN-PRO-RDC.
           EXIT.

       PRO-EVC SECTION.
       INI-PRO-EVC.
      *     IF OPC-NUM-IEVC NOT = ZEROES
      *        PERFORM GET-FST-EVC
      *        IF MSG-COD-MENS = 'OPC    NOEVC'
      *            GO TO FIN-PRO-EVC
      *        ELSE
      *            MOVE 'COL' TO MSG-COD-SIST
      *            MOVE 'OPC    SIEVC' TO MSG-COD-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS
      *            GO TO FIN-PRO-EVC.
           IF OPC-NUM-IEVC NOT = ZEROES
                  GO TO FIN-PRO-EVC.
           PERFORM GET-FST-EVC.
           IF MSG-COD-MENS = 'OPC    NOEVC'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS.
       FIN-PRO-EVC.
           EXIT.

       GET-FST-EVC SECTION.
       INI-GET-FST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC. 
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS.
       FIN-GET-FST-EVC.
           EXIT.

       PRO-VEN SECTION.
       INI-PRO-VEN.            
      *     IF OPC-NUM-IEVC = ZEROES
      *        PERFORM GET-FST-VEN
      *        IF MSG-COD-MENS = 'OPC    NOVEN'
      *            GO TO FIN-PRO-VEN
      *        ELSE
      *            MOVE 'COL' TO MSG-COD-SIST
      *            MOVE 'OPC    SIVEN' TO MSG-COD-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            PERFORM GET-MSG
      *            STRING MSG-GLS-DESC
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *            INTO FRM-MENS
      *            GO TO FIN-PRO-VEN.
           IF OPC-NUM-IEVC = ZEROES
                  GO TO FIN-PRO-VEN.
           PERFORM GET-FST-VEN.
           IF MSG-COD-MENS = 'OPC    NOVEN'
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-VEN.
      * Valdra la pena contarlos ?
           MOVE 1 TO WSS-NUM-TVEN.
           MOVE VEN-VAL-CAPI IN VEN TO WSS-VAL-TVEN.
       LUP-PRO-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              VEN-CIC-IOPC IN VEN = OPC-CIC-IOPC IN OPC
               ADD VEN-VAL-CAPI IN VEN TO WSS-VAL-TVEN
               ADD 1 TO WSS-NUM-TVEN
               GO TO LUP-PRO-VEN.
           IF WSS-VAL-TVEN NOT = OPC-VAL-CRED IN OPC
               MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
               MOVE WSS-VAL-TVEN        TO WSS-NUM-FEDT
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    TVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING WSS-NUM-FALF
                      MSG-GLS-DESC
                      WSS-NUM-FEDT
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-VEN.
       FIN-PRO-VEN.
           EXIT.
 
       GET-FST-VEN SECTION.
       INI-GET-FST-VEN.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CIC-IOPC IN VEN = OPC-CIC-IOPC IN OPC )
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS.
       FIN-GET-FST-VEN.
           EXIT.


       PRO-ITR SECTION.
       INI-PRO-ITR.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES TO ITR-NUM-ICAN IN ITR.

      * No se si esta bien
           MOVE SPACES TO ITR-KEY-IVCT IN ITR.

           MOVE SPACES TO ITR-IND-TTAS IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOICG' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS.
       FIN-PRO-ITR.
           EXIT.

       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS.
       FIN-PRO-CYA.
           EXIT.

       PRO-ROV SECTION.
       INI-PRO-ROV.
           IF OPC-IND-RENO IN OPC = SPACES
               GO TO FIN-PRO-ROV.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
      * No se si esta bien
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = ROV-CIC-IOPC IN ROV )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOROV' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS.
       FIN-PRO-ROV.
           EXIT.

       PRO-RCO SECTION.
       INI-PRO-RCO.
           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           MOVE FIO-STAT TO PGM-STAT-POC.
           IF NOT PGM-STAT-POC-OKS
               GO TO FIN-PRO-RCO.
           MOVE ZEROES TO WSS-NUM-COTO.
           MOVE ZEROES TO WSS-NUM-ACTI.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES ) 
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-RCO.
           IF POC-COD-ACTI IN POC NOT > SPACES
               MOVE 1 TO WSS-NUM-ACTI IN WSS-VARI.
           IF POC-COD-COTO IN POC NOT > SPACES
               MOVE 1 TO WSS-NUM-COTO IN WSS-VARI.
       LUP-INP-RDC.
           IF WSS-NUM-ACTI IN WSS-VARI NOT > ZEROES
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               PERFORM VAL-ACTI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE 1 TO WSS-NUM-ACTI IN WSS-VARI.
           MOVE SPACES TO RCO-KEY-IRCO IN RCO.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       GET-NXT-RCO.
           IF WSS-NUM-COTO IN WSS-VARI > ZEROES
               GO TO LEE-NXT-RDC.
           PERFORM SGC-FIO-RCO.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-ICLI IN RDC = RCO-CIC-ICLI IN RCO )
               GO TO LEE-NXT-RDC.
           PERFORM VAL-COTO
           IF MSG-COD-MENS NOT > SPACES AND
              RCO-MSC-STAT IN RCO NOT > SPACES 
               MOVE 1 TO WSS-NUM-COTO IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND
           GO TO GET-NXT-RCO.
       LEE-NXT-RDC.
           IF WSS-NUM-ACTI IN WSS-VARI > ZEROES AND
              WSS-NUM-COTO IN WSS-VARI > ZEROES
               GO TO FIN-PRO-RCO.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
               RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
               RDC-NUM-IDLC IN RDC = ZEROES
                GO TO LUP-INP-RDC.
           IF WSS-NUM-ACTI NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODACTISNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-ACTI TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-RCO.
           IF WSS-NUM-COTO NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODCOTOSNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-COTO TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-RCO.
       FIN-PRO-RCO.
           EXIT.

       PRO-OPC SECTION.
       INI-PRO-OPC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES ) 
               GO TO FIN-PRO-OPC.
       LUP-INP-OPC.
           MOVE ADR-RDC-REQA TO ADR-AUX-REQA.
           MOVE RDC-CIC-ICLI IN RDC TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE SPACES TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-NXT-RDC.
           PERFORM COL-FIO-RDC.
           IF WSS-CIC-ICLI IN WSS-VARI NOT = RDC-CIC-ICLI IN RDC
               GO TO LUP-NXT-OPC.
           IF RDC-NUM-IDLC IN RDC > ZEROES OR
              WSS-CIC-IOPC IN WSS-VARI = RDC-CIC-IOPC IN RDC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-NXT-RDC.
           MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC
           IF FIO-STAT-OKS AND
              ( OPC-MSC-STAT = 'M' OR
                OPC-MSC-STAT = 'I' OR
                OPC-MSC-STAT NOT > SPACES )
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CLI    NOVRF' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DCOR
                      OPC-CIC-IOPC IN OPC DELIMITED BY SIZE
               INTO FRM-MEN2
               GO TO FIN-PRO-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-NXT-RDC.
       LUP-NXT-OPC.
           MOVE ADR-AUX-REQA TO ADR-RDC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = WSS-CIC-IOPC IN WSS-VARI AND
              RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-INP-OPC.
       FIN-PRO-OPC.
           EXIT.


       SUM-EVC SECTION.
       INI-SUM-EVC.
           MOVE ZEROES TO WSS-VAL-TEVC.
           MOVE ZEROES TO WSS-VAL-TCAP.
           MOVE ZEROES TO OPC-NUM-VCVG IN OPC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GET-EVC.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               GO TO CON-SUM-EVC.
           MULTIPLY EVC-NUM-VIGU IN EVC BY EVC-VAL-VENC IN EVC GIVING
                    WSS-VAL-TCAP.
           ADD WSS-VAL-TCAP TO WSS-VAL-TEVC.
           ADD EVC-NUM-VIGU IN EVC TO OPC-NUM-VCVG IN OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GET-EVC.
       CON-SUM-EVC.
           IF WSS-VAL-TEVC > OPC-VAL-CRED IN OPC
               MOVE OPC-VAL-CRED IN OPC TO WSS-NUM-FALF
               MOVE WSS-VAL-TEVC        TO WSS-NUM-FEDT
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    TEVC' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING WSS-NUM-FALF
                      MSG-GLS-DESC
                      WSS-NUM-FEDT
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-SUM-EVC.
           IF NOT PGM-STAT-POC-OKS
               GO TO FIN-SUM-EVC.
           IF ( POC-NUM-VMIN IN POC NOT > ZEROES OR 
                POC-NUM-VMIN IN POC NOT > OPC-NUM-VCVG IN OPC ) AND
              ( POC-NUM-VMAX IN POC NOT > ZEROES OR
                POC-NUM-VMAX IN POC NOT < OPC-NUM-VCVG IN OPC )
                 GO TO FIN-SUM-EVC.
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'NUMVCVGNORNG' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE POC-NUM-VMIN IN POC     TO WSS-NUM-VAL1-EDT IN WSS-VARI.
           MOVE SPACES                  TO WSS-IND-DMA1     IN WSS-VARI.
           MOVE '-'                     TO WSS-GLS-GUI2     IN WSS-VARI.
           MOVE POC-NUM-VMAX IN POC     TO WSS-NUM-VAL2-EDT IN WSS-VARI.
           MOVE SPACES                  TO WSS-IND-DMA2     IN WSS-VARI.
           MOVE WSS-MEN2 IN WSS-VARI    TO FRM-MEN2.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-SUM-EVC.
           EXIT.
       ULT-VEN SECTION.
       INI-ULT-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE 999 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE VEN-NUM-IVEN IN VEN TO OPC-NUM-VCVG IN OPC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN 
               IF VEN-VAL-SFIN IN VEN NOT > ZEROES
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'VALSFINULTZ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-ULT-VEN.
           EXIT.

       VAL-DEU-IND SECTION.
       INI-VAL-DEU-IND.
           IF RDC-CIC-ICLI = WSS-CIC-ICLI
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CICICLIICLI=' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      RDC-CIC-ICLI
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-VAL-DEU-IND.
           ADD RDC-VAL-LIMD TO WSS-NUM-PIND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC
                 GO TO INI-VAL-DEU-IND.
       FIN-VAL-DEU-IND.
           EXIT.

       VAL-ACTI SECTION.
       INI-VAL-ACTI.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-COD-DIGT.
           IF POC-COD-ACTI IN POC > SPACES
               MOVE POC-COD-ACTI IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 9 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'ACT' TO TAB-COD-TTAB IN TAB
                   MOVE POC-COD-ACTI IN POC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE NUM-NN9N TO WSS-NUM-DIGT
                       MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
                   ELSE
                   IF POC-COD-ACTI IN POC NOT = DBC-COD-ACTI IN DBC 
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF POC-COD-ACTI IN POC NOT = DBC-COD-ACTI IN DBC 
                       MOVE 'CODACTINOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-ACTI.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-ACTI.
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB
           MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = TAB-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CODACTINEFAM' TO MSG-COD-MENS
               GO TO FIN-VAL-ACTI.
       FIN-VAL-ACTI.
           EXIT.

       VAL-COTO SECTION.
       INI-VAL-COTO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-COD-DIGT.
           IF POC-COD-COTO IN POC > SPACES
               MOVE POC-COD-COTO IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3 TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE 'TAB' TO TAB-COD-SIST
                   MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                   MOVE POC-COD-COTO IN POC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
                       MOVE NUM-NN9N TO WSS-NUM-DIGT
                       MOVE WSS-NUM-DIGT TO WSS-COD-DIGT
                   ELSE
                   IF RCO-COD-TOPR IN RCO NOT = POC-COD-COTO IN POC
                       MOVE 'CODCOTONOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-COTO
                   ELSE
                       NEXT SENTENCE
               ELSE
                   IF RCO-COD-TOPR IN RCO NOT = POC-COD-COTO IN POC
                       MOVE 'CODCOTONOPLT' TO MSG-COD-MENS
                       GO TO FIN-VAL-COTO.
           IF WSS-COD-DIGT NOT > SPACES
               GO TO FIN-VAL-COTO.
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB
           MOVE RCO-COD-TOPR IN RCO TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           PERFORM BUS-FAM VARYING WSS-I FROM 1 BY 1 UNTIL WSS-I > 10 OR
                           WSS-COD-DIGT = TAB-COD-DAT2 (WSS-I).
           IF WSS-I > 10
               MOVE 'CODCOTONEFAM' TO MSG-COD-MENS
               GO TO FIN-VAL-COTO.
       FIN-VAL-COTO.
           EXIT.
       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.
      *
       COPY SGCBGCLI.
       COPY SGCBFDBC.
      *
       COPY COLBFRDC.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFROV.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFIMP.
       COPY COLBFICG.
       COPY COLBFNTR.
       COPY COLBFTOC.
       COPY COLBFPOC.
      *
       COPY COLBGUVD.
      *
       COPY COLBGCLI.
      *
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBVIND.
       COPY GNSBVMSC.
      *
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBFTAB.
      *ALD/22-AUG-1988
       COPY GNSBGCAM.
       COPY GNSBGPES.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
      *
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *ALD/22-AUG-1988
       COPY TABBFCAM.
       COPY TABBVTDU.
       COPY TABBVOFI.
       COPY TABBVUSR.
       
      *
       COPY SGCBGDOM.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
      *>>>>
*% END
