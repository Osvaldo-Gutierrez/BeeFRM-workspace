*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      * Reporte 2
      *DOS SELECT RPTFC1         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTFC1         ASSIGN TO        UT-S-RPTFC1.
           SELECT RPTFC1         ASSIGN TO SYS012-UR-1403-S.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
      * Reporte 2
       FD  RPTFC1 LABEL RECORD OMITTED
           REPORT IS RPT-FC1.
       01  PASO.
           03 FILLER                                   PIC X(01).
      *>>>>
*% END
*% IF RW
      *<<<< RW
       01  WSS-FCA-R  REDEFINES  WSS-FCA.
           03  FILLER                                  PIC X(09).
           03  WSS-FCA-V.
               05  WSS-FCA-VR1          OCCURS 6.
                   07  WSS-TMN1                        PIC 9(09).
                   07  WSS-TMN2                        PIC 9(09).
                   07  WSS-TMN3                        PIC 9(09).
                   07  WSS-TMN4                        PIC 9(09).
                   07  WSS-TMN5                        PIC 9(09).
                   07  WSS-TMN6                        PIC 9(09).
                   07  WSS-TMN7                        PIC 9(09).

       COPY COLRWFCB.
       01  WSS-FCB-R  REDEFINES  WSS-FCB.
           03  WSS-FCB-V.
               05  WSS-FCB-VR1          OCCURS 3.
                   07  WSS-TMN1                        PIC 9(09).
                   07  WSS-TMN2                        PIC 9(09).
                   07  WSS-TMN3                        PIC 9(09).
                   07  WSS-TMN4                        PIC 9(09).
                   07  WSS-TMN5                        PIC 9(09).
                   07  WSS-TMN6                        PIC 9(09).
                   07  WSS-TMN7                        PIC 9(09).
               05  WSS-FCB-VR2          OCCURS 3.
                   07  WSS-TMNA                        PIC 9(09).
                   07  WSS-TMNB                        PIC 9(09).
               05  WSS-FCB-VR3          OCCURS 4.
                   07  WSS-TMX1                        PIC 9(09).
                   07  WSS-TMX2                        PIC 9(09).
                   07  WSS-TMX3                        PIC 9(09).
                   07  WSS-TMX4                        PIC 9(09).
                   07  WSS-TMX5                        PIC 9(09).

       COPY COLRWFCC.
       01  WSS-FCC-R  REDEFINES  WSS-FCC.
           03  WSS-FCC-V.
               05  WSS-FCC-VR1          OCCURS 5.
                   07  WSS-TMX1                        PIC 9(09).
                   07  WSS-TMX2                        PIC 9(09).
                   07  WSS-TMX3                        PIC 9(09).
                   07  WSS-TMX4                        PIC 9(09).
                   07  WSS-TMX5                        PIC 9(09).
               05  WSS-FCC-VR2          OCCURS 3.
                   07  WSS-TMXA                        PIC 9(09).

       COPY COLRWFCD.
       COPY COLRWFCE.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY SGCBRDBC.
       COPY SGCBRREC.
       COPY DEUBRRDE.
       COPY DEUBRESC.
       COPY DEUBRFIA.
       COPY DEUBRAMF.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY COLBRVEN.
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY COLBRRDT.
       COPY COLWGVEN.
       COPY DEUWGDEU.
       COPY SGCWVPPU.
       COPY GNSWCNUM.
       COPY GNSWVNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       01  WSS-VARI.
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                          PIC 9(02).
              05 WSS-NUM-MINF                          PIC 9(02).
              05 WSS-NUM-SINF                          PIC 9(02).
              05 WSS-NUM-AINF                          PIC 9(02).
           03 WSS-FEC-FIN1.
              05 WSS-NUM-SIN1                          PIC 9(02).
              05 WSS-NUM-AIN1                          PIC 9(02).
              05 WSS-NUM-MIN1                          PIC 9(02).
              05 WSS-NUM-DIN1                          PIC 9(02).
           03 WSS-COD-OFOC                             PIC X(03).
           03 WSS-COD-COOC                             PIC X(06).
           03 WSS-IND-TDEU                             PIC X(01).
           03 WSS-ALF-SELE         VALUE SPACES        PIC X(11).
           03 WSS-VAL-SELE         VALUE ZEROES        PIC 9(11).
           03 WSS-COD-PESO                             PIC X(06).
           03 WSS-VAL-2POR                             PIC 9(11).
           03 WSS-SGV-20UF                             PIC S9(11).
           03 WSS-IND-STAT         VALUE 0             PIC 9(01).
           03 WSS-IND-ERRO         VALUE 0             PIC 9(01).
           03 WSS-VAL-DPES                             PIC 9(11).
           03 WSS-VAL-TDEU                             PIC 9(11).
           03 WSS-GLS-DAT3.
              05 FILLER                                PIC X(16).
              05 WSS-IND-OMIT                          PIC X(01).
              05 FILLER                                PIC X(13).
           03 WSS-MSC-TCOL                             PIC X(04).
           03 WSS-SGV-FINF                             PIC S9(11)V9999.
           03 WSS-SGV-FVEN                             PIC S9(11)V9999.
           03 WSS-NUM-PLAZ                             PIC S9(04).
           03 WSS-VAL-SCAP                             PIC 9(11)V9(04).
           03 WSS-VAL-INTS                             PIC 9(11)V9(04).
           03 WSS-IND-MNAC         VALUE ZEROES        PIC 9(01).
           03 WSS-VAL-MNAC         VALUE ZEROES        PIC 9(11).
           03 WSS-IND                                  PIC 9(02).
           03 WSS-SUB                                  PIC 9(02).
           03 WSS-NUM-OPCL         VALUE 0             PIC 9(06).
           03 WSS-NUM-OPCS         VALUE 0             PIC 9(06).
           03 WSS-NUM-OPCP         VALUE 0             PIC 9(06).
           03 WSS-NUM-OPCR         VALUE 0             PIC 9(06).
           03 WSS-NUM-VENL         VALUE 0             PIC 9(06).
           03 WSS-NUM-VENS         VALUE 0             PIC 9(06).
           03 WSS-NUM-VENP         VALUE 0             PIC 9(06).
           03 WSS-COD-PART.
              05 WSS-NUM-PART                          PIC 9(04).
                 88 VAL-PAR-OPC    VALUES ARE 1105 THRU 1245, 1805,
                                              1810, 1820.
                 88 VAL-PAR-OPCB   VALUES ARE 1405 THRU 1415, 1745,
                                              1825.
           03 WSS-VECT.
              05 WSS-VTMN          OCCURS 8.
                 07 WSS-TMN1                           PIC 9(11)V9(04).
                 07 WSS-TMN2                           PIC 9(11)V9(04).
                 07 WSS-TMN3                           PIC 9(11)V9(04).
                 07 WSS-TMN4                           PIC 9(11)V9(04).
                 07 WSS-TMN5                           PIC 9(11)V9(04).
                 07 WSS-TMN6                           PIC 9(11)V9(04).
              05 WSS-VTCN          OCCURS 2.
                 07 WSS-TMNA                           PIC 9(11)V9(04).
                 07 WSS-TMNB                           PIC 9(11)V9(04).
              05 WSS-VTMX          OCCURS 8.
                 07 WSS-TMX1                           PIC 9(11)V9(04).
                 07 WSS-TMX2                           PIC 9(11)V9(04).
                 07 WSS-TMX3                           PIC 9(11)V9(04).
                 07 WSS-TMX4                           PIC 9(11)V9(04).
                 07 WSS-TMX5                           PIC 9(11)V9(04).
              05 WSS-VTCX          OCCURS 2.
                 07 WSS-TMXA                           PIC 9(11)V9(04).
           03 WSS-VECR.
              05 WSS-VRMN          OCCURS 9.
                 07 WSS-TMN1                           PIC 9(09).
                 07 WSS-TMN2                           PIC 9(09).
                 07 WSS-TMN3                           PIC 9(09).
                 07 WSS-TMN4                           PIC 9(09).
                 07 WSS-TMN5                           PIC 9(09).
                 07 WSS-TMN6                           PIC 9(09).
                 07 WSS-TMN7                           PIC 9(09).
              05 WSS-VRCN          OCCURS 3.
                 07 WSS-TMNA                           PIC 9(09).
                 07 WSS-TMNB                           PIC 9(09).
              05 WSS-VRMX          OCCURS 9.
                 07 WSS-TMX1                           PIC 9(09).
                 07 WSS-TMX2                           PIC 9(09).
                 07 WSS-TMX3                           PIC 9(09).
                 07 WSS-TMX4                           PIC 9(09).
                 07 WSS-TMX5                           PIC 9(09).
              05 WSS-VRCX          OCCURS 3.
                 07 WSS-TMXA                           PIC 9(09).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRTFCB.
       COPY COLRTFCC.
       COPY COLRTFCD.
       COPY COLRTFCE.
      * Reporte 2
       COPY COLRFFC1.
           .
       COPY COLRTFC1.
       COPY COLRTFC2.
       COPY COLRTFC3.
       COPY COLRTFC4.
      *>>>>
*% END
*% IF INI
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'INGRESE FECHA DEL INFORME (DDMMSSAA) '.
           ACCEPT WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.
      * Captura Codigo de Oficina
           DISPLAY 'OFICINA (*=BANCO): '.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
           DISPLAY WSS-COD-OFOC IN WSS-VARI.
      * Captura Codigo Clase Operacion como Indicador Seleccion Cartera
           DISPLAY 'CLASE OPERACION (*=TODA LA CARTERA) : '.
           ACCEPT  WSS-COD-COOC IN WSS-VARI.
           DISPLAY WSS-COD-COOC IN WSS-VARI.
      * Captura Monto Minimo
           DISPLAY 'MONTO MINIMO SELECCION EN PESOS ( 99999999999 ) : '
           ACCEPT  WSS-ALF-SELE IN WSS-VARI.
           DISPLAY WSS-ALF-SELE IN WSS-VARI.
      * Captura Indicador Seleccion Tipo Deudor
      *     DISPLAY 'TIPO DEUDOR (M=MAYORES,R=RELACIONADOS,*=TODOS) : '
      *     ACCEPT  WSS-IND-TDEU IN WSS-VARI.
      *     DISPLAY WSS-IND-TDEU IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
        
      *VAL-FEC Valida Fecha de Informe
           DISPLAY 'FECHA DEL INFORME : ' WSS-FEC-FINF IN WSS-VARI.
           MOVE WSS-FEC-FINF    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DACT IN WSS-FCA
                                            WSS-NUM-DIN1 IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-NUM-MACT IN WSS-FCA
                                            WSS-NUM-MIN1 IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SACT IN WSS-FCA
                                            WSS-NUM-SIN1 IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AACT IN WSS-FCA
                                            WSS-NUM-AIN1 IN WSS-VARI.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               DISPLAY 'OFICINA : ' WSS-COD-OFOC IN WSS-VARI
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-END.

      *VAL-TAB Valida Clase de Operacion en TABLAS
           IF WSS-COD-COOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-COOC IN WSS-VARI.
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               DISPLAY 'CLASE OPERACION : ' WSS-COD-COOC IN WSS-VARI
                      ': SE EFECTUA SELECCION DE CARTERA SEGUN MARCA '
                      'EN TABLA AUX'
           ELSE
               DISPLAY 'SE CONSIDERA TODA LA CARTERA'.
      *         DISPLAY WSS-COD-COOC IN WSS-VARI
      *         MOVE 'COL'                    TO TAB-COD-SIST
      *         MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
      *         MOVE WSS-COD-COOC IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *         PERFORM VAL-TAB
      *         IF MSG-COD-MENS > SPACES
      *             DISPLAY MSG-GLS-DESC IN MSG
      *             PERFORM GNS-PRO-END.

      *VAL-NUM Validacion numerica Monto Minimo Seleccion
           MOVE WSS-ALF-SELE IN WSS-VARI TO NUM-NUME.
           MOVE NUM-ZERO-S               TO NUM-ZERO.
           MOVE NUM-SGNO-N               TO NUM-SGNO.
           MOVE 11                       TO NUM-NENT.
           MOVE 0                        TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WSS-VAL-SELE IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-VAL-SELE IN WSS-VARI.
           DISPLAY 'MONTO MINIMO : ' WSS-VAL-SELE IN WSS-VARI.
           IF WSS-VAL-SELE IN WSS-VARI NOT > ZEROES
               PERFORM GNS-PRO-END.

      * Valida Indicador Seleccion Tipo Deudor
      *     IF WSS-IND-TDEU IN WSS-VARI NOT > SPACES
      *         MOVE '*' TO WSS-IND-TDEU IN WSS-VARI.
      *     IF WSS-IND-TDEU IN WSS-VARI NOT = '*'
      *         IF WSS-IND-TDEU IN WSS-VARI = 'M'
      *             DISPLAY 'DEUDORES : ' WSS-IND-TDEU IN WSS-VARI
      *                     ' : SE EFECTUARA EMISION SOLO DE MAYORES '
      *                     'DEUDORES'
      *         ELSE
      *         IF WSS-IND-TDEU IN WSS-VARI = 'R'
      *             DISPLAY 'DEUDORES : ' WSS-IND-TDEU IN WSS-VARI
      *                     ' : SE EFECTUARA EMISION SOLO DE DEUDORES '
      *                     'RELACIONADOS'
      *         ELSE
      *             DISPLAY 'DEUDORES : ' WSS-IND-TDEU IN WSS-VARI
      *                     ' : ALTERNATIVA DE SELECCION DEL TIPO DE '
      *                     'DEUDOR ES ERRONEA'
      *             PERFORM GNS-PRO-END
      *     ELSE
      *         DISPLAY 'DEUDORES : ' WSS-IND-TDEU IN WSS-VARI
      *                 ' : SE EMITEN TODOS LOS TIPOS DE DEUDORES'.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene el Codigo Valor de Cambio de Pesos mediante el CIC de la moneda
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * BUS-USR busca Usuario en tablas para obtener Codigo de la Institucion
      * Financiera para reporte
           MOVE 'USR' TO USR-COD-USER IN USR.
           PERFORM BUS-USR.

      * CIC-PPU Busca CIC del Usuario en DBC
      *     PERFORM CIC-PPU.
      *     IF MSG-COD-MENS > SPACES
      *         DISPLAY MSG-GLS-DESC
      *         PERFORM GNS-PRO-END.

      * Obtiene el Capital del Banco en Pesos mediante el CIC 'UCAP'
      *     MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
      *     MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
      *     MOVE 'UCAP  '                 TO CAM-COD-VCAM IN CAM(1).
      *     MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM TAB-FIO-CAM.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'NO EXISTE VALOR CAPITAL BANCO A ESTA FECHA : '
      *                  WSS-FEC-FINF IN WSS-VARI
      *         PERFORM GNS-PRO-END.

      * Obtiene el 2% del Capital del Banco en Pesos
      *     MULTIPLY CAM-SGV-VCAM IN CAM BY 0,020 GIVING
      *                              WSS-VAL-2POR IN WSS-VARI ROUNDED.

      * Obtiene Valor de Cambio en Pesos para la UF a Fecha del Informe
      *     MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
      *     MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
      *     MOVE '0998'                   TO CAM-COD-VCAM IN CAM(1).
      *     MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM TAB-FIO-CAM.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA INFORME : '
      *                  WSS-FEC-FINF IN WSS-VARI
      *                 ' PARA LA U.F.'
      *         PERFORM GNS-PRO-END.

      * Obtiene el Monto en Pesos de 20.000 U.F.
      *     MULTIPLY CAM-SGV-VCAM IN CAM BY 20000 GIVING
      *                              WSS-SGV-20UF IN WSS-VARI ROUNDED.

      * Obtiene el Codigo Relacion Banco mediante el CIC de relacion 'RB'
      *     MOVE 'SGC'          TO FIO-SIST.
      *     MOVE 'REC'          TO TAB-CIC-TTAB IN TAB.
      *     MOVE 'RB'           TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'SGC'          TO MSG-COD-SIST
      *         MOVE 'CICRECRB NEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB IN TAB
      *         PERFORM GNS-PRO-END.
      *     MOVE TAB-COD-CTAB IN TAB TO REC-COD-RBCO IN REC-VARI.

      * Inicializa Variables
      * Inicializar Matriz de campos del Reporte
           MOVE ZEROES TO WSS-VECT IN WSS-VARI
                          WSS-VECR IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      * Lectura Inicial de la Operacion de Credito
           MOVE ZEROES         TO OPC-FEC-FCOL IN OPC.
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FIN1 IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS OPC HASTA FECHA DE INFORME : '
                       WSS-FEC-FINF IN WSS-VARI
               GO TO FIN-INP-SRT.
           GO TO INI-OUT-SRT.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
      * Apertura e Inicializacion de Reportes distintos del Base
           OPEN OUTPUT RPTFC1.
           INITIATE RPT-FC1.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           ADD 1 TO WSS-NUM-OPCL IN WSS-VARI.

      * Seleccion de los Registros OPC Leidos para ser Procesados
           PERFORM SEL-REG-PRO.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.
           ADD 1 TO WSS-NUM-OPCS IN WSS-VARI.

      * De tabla TOC Tipo Operaciones Creditos se obtiene 'Tipo de Colocacion'
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' PARA : ' TOC-COD-TABL IN TOC
                       ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.
           MOVE TOC-MSC-TCOL IN TOC TO WSS-MSC-TCOL IN WSS-VARI.

      **************************************************************************
      * Proceso para los Vencimientos de la Operacion de Credito seleccionada
       INI-PRO-OPC-VEN.
      * Lectura Inicial de Vencimientos de la Operacion de Credito
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S' 
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    VENNX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC '/KEY : ' VEN-KEY-IVEN IN VEN
                   GO TO FIN-PRO-OPC-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE  1  TO VEN-NUM-IVEN IN VEN
               PERFORM COL-OBT-VEN
               IF NOT VEN-STAT-OKS
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    VENNX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC '/KEY : ' VEN-KEY-IVEN IN VEN
                   GO TO FIN-PRO-OPC-VEN.

           MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
           ADD 1 TO WSS-NUM-OPCP IN WSS-VARI.
       LUP-PRO-OPC-VEN.
      * Ciclo de Proceso del Vencimiento de la Operacion de Credito seleccionada
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           ADD   1  TO WSS-NUM-VENL IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos a Fecha Vencimiento 
           IF WSS-IND-MNAC IN WSS-VARI = 1 AND
              VEN-FEC-FVEN IN VEN NOT > WSS-FEC-FIN1 IN WSS-VARI
               MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
               MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA'
                           ' VENCIMIENTO : '    VEN-FEC-FVEN IN VEN
                           ' PARA : '           OPC-COD-VCOC IN OPC
                           ' EN VENCIMIENTO : ' OPC-CIC-IOPC IN OPC
                   GO TO FIN-PRO-OPC-VEN
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA'
                               ' VENCIMIENTO : '    VEN-FEC-FVEN IN VEN
                               ' PARA : '           OPC-COD-VCOC IN OPC
                               ' EN VENCIMIENTO : ' OPC-CIC-IOPC IN OPC
                       GO TO FIN-PRO-OPC-VEN
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVEN
                                                           IN WSS-VARI.

      * Distribucion del Vencimiento segun Situacion Contable y/o Partidas
      * Validas
      * INTERESES DE OPC CONTINGENTES
           IF WSS-MSC-TCOL IN WSS-VARI = 'C'
               PERFORM DIS-OPC-VEN-4
           ELSE
           IF ( VEN-IND-SCTB IN VEN = ' ' OR
                VEN-IND-SCTB IN VEN = 'VIG' ) AND
              VEN-FEC-FVEN IN VEN > WSS-FEC-FIN1 IN WSS-VARI
      *       AND VAL-PAR-OPC
      * SALDO CAP. E INTERES DE OPC VIGENTES
               PERFORM DIS-OPC-VEN-1
           ELSE
           IF VEN-IND-SCTB IN VEN = 'MOR'
      *        AND VAL-PAR-OPC
      * SALDO CAP. E INTERES DE OPC MOROSAS
               PERFORM DIS-OPC-VEN-2
           ELSE
           IF VEN-IND-SCTB IN VEN = 'VCD'
      *        AND VAL-PAR-OPCB
      * SALDO CAP. E INTERES DE OPC VENCIDAS
               PERFORM DIS-OPC-VEN-3.

           IF WSS-IND-STAT IN WSS-VARI = 1
               ADD 1 TO WSS-NUM-OPCR IN WSS-VARI
               GO TO FIN-PRO-OPC-VEN.
       NXT-PRO-OPC-VEN.
      * Lectura de Siguiente Vencimiento de la Operacion de Credito
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S' 
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS OR
                  OPC-CIC-IOPC IN OPC NOT = VEN-CIC-IOPC IN VEN
                   GO TO FIN-PRO-OPC-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO FIN-PRO-OPC-VEN
               ELSE
               IF NOT VEN-STAT-OKS
                   MOVE 'COL'    TO MSG-COD-SIST
                   MOVE VEN-STAT TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC   VEN-KEY-IVEN IN VEN
                   GO TO FIN-PRO-OPC-VEN.
           GO TO LUP-PRO-OPC-VEN.
       FIN-PRO-OPC-VEN.
      **************************************************************************
           GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
      * Verifica que Registro Leido pertenesca al Periodo de Proceso
           IF OPC-FEC-FCOL IN OPC > WSS-FEC-FIN1 IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
      * Redondea en Millones ($) Montos Acumulados para el Reporte
           PERFORM PRO-RND-8 VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                               UNTIL WSS-IND IN WSS-VARI > 8.
           PERFORM PRO-RND-2 VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                               UNTIL WSS-IND IN WSS-VARI > 2.

      * Totaliza Montos Acumulados Redondeados para el Reporte
           PERFORM PRO-TOT-LIN1 VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                                  UNTIL WSS-IND IN WSS-VARI > 8.
           PERFORM PRO-TOT-COL1 VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                                  UNTIL WSS-IND IN WSS-VARI > 8.
           ADD WSS-TMN1 IN WSS-VRMN(9)
               WSS-TMNA IN WSS-VRCN(1)
               WSS-TMNA IN WSS-VRCN(2)
                           GIVING WSS-TMNA IN WSS-VRCN(3).
           ADD WSS-TMN2 IN WSS-VRMN(9)
               WSS-TMNB IN WSS-VRCN(1)
               WSS-TMNB IN WSS-VRCN(2)
                           GIVING WSS-TMNB IN WSS-VRCN(3).
           ADD WSS-TMX1 IN WSS-VRMX(9)
               WSS-TMXA IN WSS-VRCX(1)
               WSS-TMXA IN WSS-VRCX(2)
                           GIVING WSS-TMXA IN WSS-VRCX(3).

      * Traspasar Totales al Registro WSS que Corresponde del Reporte
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-TRA-WSS.
           IF WSS-IND IN WSS-VARI < 7
               MOVE WSS-VRMN(WSS-IND) TO WSS-FCA-VR1(WSS-IND)
           ELSE
               SUBTRACT 6 FROM WSS-IND IN WSS-VARI
                                   GIVING WSS-SUB IN WSS-VARI
               MOVE WSS-VRMN(WSS-IND) TO WSS-FCB-VR1(WSS-SUB).

           IF WSS-IND IN WSS-VARI < 4
               MOVE WSS-VRCN(WSS-IND) TO WSS-FCB-VR2(WSS-IND)
               MOVE WSS-VRCX(WSS-IND) TO WSS-FCC-VR2(WSS-IND).

           IF WSS-IND IN WSS-VARI < 5
               MOVE WSS-VRMX(WSS-IND) TO WSS-FCB-VR3(WSS-IND)
           ELSE
               SUBTRACT 4 FROM WSS-IND IN WSS-VARI
                                   GIVING WSS-SUB IN WSS-VARI
               MOVE WSS-VRMX(WSS-IND) TO WSS-FCC-VR1(WSS-SUB).

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI < 9
               GO TO LUP-TRA-WSS.

           MOVE WSS-VRMN(WSS-IND) TO WSS-FCB-VR1(3).
           MOVE WSS-VRMX(WSS-IND) TO WSS-FCC-VR1(5).

      * Despliega Totales de Control Proceso
           DISPLAY 'TOTAL OPC LEIDOS             : '
                               WSS-NUM-OPCL IN WSS-VARI.
           DISPLAY 'TOTAL OPC SELECCIONADOS      : '
                               WSS-NUM-OPCS IN WSS-VARI.
           DISPLAY 'TOTAL OPC PARA PROCESO       : '
                               WSS-NUM-OPCP IN WSS-VARI.
           DISPLAY 'TOTAL OPC RECHAZADOS         : '
                               WSS-NUM-OPCR IN WSS-VARI.
           DISPLAY 'TOTAL VEN LEIDOS             : '
                               WSS-NUM-VENL IN WSS-VARI.
           DISPLAY 'TOTAL VEN SELECCIONADOS      : '
                               WSS-NUM-VENS IN WSS-VARI.
           DISPLAY 'TOTAL VEN PROCESADOS         : '
                               WSS-NUM-VENP IN WSS-VARI.

      * Genera Reporte T13 Completo
           GENERATE DL-FC1.
           GENERATE DL-FC2.
           GENERATE DL-FC3.
           GENERATE DL-FC4.
           GENERATE DL-FCA.
           GENERATE DL-FCB.
           GENERATE DL-FCC.
           GENERATE DL-FCD.
           GENERATE DL-FCE.
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
      * Cierre de Reportes distintos del Base
           TERMINATE RPT-FC1.
           CLOSE RPTFC1.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBPFEC
      **************************************************************************
      * Seleccion del Registro OPC Leido para ser Procesado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

      * Seleccion de Operacion de Credito con Estado 'ACA'
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO FIN-SEL-REG-PRO.

      * Seleccion de Oficina de Operacion de Credito
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFOC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO FIN-SEL-REG-PRO.

      * Seleccion de las Operaciones de Credito segun Indicador Tipo Deudor
      *     IF WSS-IND-TDEU IN WSS-VARI NOT = '*'
      *         PERFORM DET-CIC-DEU
      *         IF WSS-IND-ERRO IN WSS-VARI = 1
      *             GO TO FIN-SEL-REG-PRO
      *         ELSE
      *             IF WSS-IND-TDEU IN WSS-VARI = 'M'
      *                 PERFORM DET-DEU-MAYO
      *                 IF WSS-IND-ERRO IN WSS-VARI = 1
      *                     GO TO FIN-SEL-REG-PRO
      *                 ELSE
      *                     NEXT SENTENCE
      *             ELSE
      *             IF WSS-IND-TDEU IN WSS-VARI = 'R'
      *                 PERFORM DET-DEU-RELA
      *                 IF WSS-IND-ERRO IN WSS-VARI = 1
      *                     GO TO FIN-SEL-REG-PRO.

      * Obtiene Valor de Cambio de Operacion Credito en Pesos a Fecha Informe
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
               MOVE WSS-FEC-FIN1 IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA'
                           ' INFORME : '      WSS-FEC-FINF IN WSS-VARI
                           ' PARA : '         OPC-COD-VCOC IN OPC
                           ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
                   GO TO FIN-SEL-REG-PRO
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       DISPLAY 'IND. VIGENCIA NO VALIDO A FECHA'
                             ' INFORME : '      WSS-FEC-FINF IN WSS-VARI
                             ' PARA : '         OPC-COD-VCOC IN OPC
                             ' EN OPERACION : ' OPC-CIC-IOPC IN OPC
                       GO TO FIN-SEL-REG-PRO
                   ELSE
                       MOVE  1  TO WSS-IND-MNAC IN WSS-VARI
                       MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FINF
                                                          IN WSS-VARI
           ELSE
               MOVE  0  TO WSS-IND-MNAC IN WSS-VARI.

      * Monto Saldo de la Operacion de Credito en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-SGV-FINF IN WSS-VARI
                              GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
           ELSE
               MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-MNAC IN WSS-VARI.

      * Seleccion de Operacion de Credito que tenga Saldo > = Monto Parametro
           IF WSS-VAL-MNAC IN WSS-VARI < WSS-VAL-SELE IN WSS-VARI
               GO TO FIN-SEL-REG-PRO.

      * TODAS las Operaciones de Credito segun Indicador Seleccion Cartera
           IF WSS-COD-COOC IN WSS-VARI = '*'
               GO TO CON-SEL-REG-PRO.

      * Mediante BUS-TAB Busca Ind. Inclusion en Tabla AUX (Pos.47 Datos Anexos)
           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DAT3 IN WSS-VARI
           ELSE
               DISPLAY 'OPERACION SIN COD-COOC : ' OPC-KEY-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Incluye ( Clases de Operaciones )
           IF WSS-IND-OMIT IN WSS-VARI NOT = 'X'
               GO TO FIN-SEL-REG-PRO.
       CON-SEL-REG-PRO.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Busca CIC del Cliente con el CIC de Operacion de Credito en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
       DET-CIC-DEU SECTION.
       INI-DET-CIC-DEU.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI.
       FIN-DET-CIC-DEU.
           EXIT.
      **************************************************************************
      * Seleccion de Cliente que sea Tipo Mayor Deudor
       DET-DEU-MAYO SECTION.
       INI-DET-DEU-MAYO.
      * Inicializa tabla RDE utiliza la Rutina de Choque Deudas
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           PERFORM CLR-TAB-RDE VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                           UNTIL WSS-IND IN WSS-VARI > 50.

      * Invocacion Rutina de Choque Deudas que llena tabla RDE
           PERFORM GET-FHOY.
           PERFORM INI-CAM.
           MOVE HOY-FHOY TO DEU-FEC-FPRO.
           MOVE 'R'      TO DEU-FPRO IN DEU.
           MOVE RDC-CIC-ICLI IN RDC TO DEU-CIC-ICLI IN DEU.
           PERFORM CAL-DEU.
           IF DEU-STAT NOT = DEU-STAT-OKS
               MOVE 'DEU'    TO MSG-COD-SIST
               MOVE DEU-STAT TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC  DEU-MEN2
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-DET-DEU-MAYO.

      * Lee y Calcula Total Deuda Cliente en Pesos en RDE
           MOVE ZEROES TO WSS-VAL-TDEU IN WSS-VARI.
           MOVE 0      TO DEU-R.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-RDE.
           IF NOT FIO-STAT-OKS OR
              RDE-CIC-ICLI IN RDE NOT = RDC-CIC-ICLI IN RDC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-DET-DEU-MAYO.
       LUP-TOT-DEU.
      * Calcula Deuda en Pesos
           PERFORM CAL-DPES.
           IF WSS-IND-ERRO IN WSS-VARI = 1
               GO TO FIN-DET-DEU-MAYO.
           ADD WSS-VAL-DPES IN WSS-VARI TO WSS-VAL-TDEU IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-RDE.
           IF FIO-STAT-OKS AND
              RDE-CIC-ICLI IN RDE = RDC-CIC-ICLI IN RDC
               GO TO LUP-TOT-DEU.

      * Compara Total Deuda del Cliente con el Limite de Deuda Super
           IF WSS-VAL-TDEU IN WSS-VARI NOT < WSS-SGV-20UF IN WSS-VARI OR
              WSS-VAL-TDEU IN WSS-VARI NOT < WSS-VAL-2POR IN WSS-VARI
               GO TO FIN-DET-DEU-MAYO.

           MOVE  1  TO WSS-IND-ERRO IN WSS-VARI.
       FIN-DET-DEU-MAYO.
           EXIT.
      **************************************************************************
       CLR-TAB-RDE SECTION.
       INI-CLR-TAB-RDE.
      * Inicializa tabla RDE utiliza la Rutina de Choque Deudas
           MOVE SPACES TO RDE-KEY-IRDE IN DEU(WSS-IND).
           MOVE ZEROES TO RDE-VAL-DEUD IN DEU(WSS-IND).
       FIN-CLR-TAB-RDE.
           EXIT.
      **************************************************************************
       CAL-DPES SECTION.
       INI-CAL-DPES.
      * Calcula Deuda en Pesos
           IF RDE-COD-VCCR IN RDE NOT > SPACES
               MOVE RDE-VAL-DEUD IN RDE TO WSS-VAL-DPES IN WSS-VARI
           ELSE
           IF RDE-COD-VCCR IN RDE = CAM-COD-MNAC
               MOVE RDE-VAL-DEUD IN RDE TO WSS-VAL-DPES IN WSS-VARI
           ELSE
               MOVE RDE-COD-VCCR IN RDE TO CAM-COD-VCAM IN CAM(1)
               PERFORM GET-CAM
               IF NOT FIO-STAT-OKS
                   MOVE ZEROES TO WSS-VAL-DPES IN WSS-VARI
                   MOVE  1     TO WSS-IND-ERRO IN WSS-VARI
               ELSE
                   IF CAM-IND-VIGE IN CAM = 'N'
                       MOVE ZEROES TO WSS-VAL-DPES IN WSS-VARI
                   ELSE
                       MULTIPLY RDE-VAL-DEUD IN RDE BY
                                CAM-SGV-VCAM IN CAM GIVING
                                WSS-VAL-DPES IN WSS-VARI.
       FIN-CAL-DPES.
           EXIT.
      **************************************************************************
      * Busca Relacion del Cliente con USUARIO BCI en REC
       DET-DEU-RELA SECTION.
       INI-DET-DEU-RELA.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE PPU-CIC-IPPU IN PPU-VARI TO REC-CIC-ICLI IN REC.
           MOVE REC-COD-RBCO IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE RDC-CIC-ICLI IN RDC      TO REC-CIC-IREL IN REC.
           MOVE ZEROES                   TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DET-DEU-RELA.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              PPU-CIC-IPPU IN PPU-VARI = REC-CIC-ICLI IN REC AND
              RDC-CIC-ICLI IN RDC      = REC-CIC-IREL IN REC AND
              REC-COD-TREC IN REC      = REC-COD-RBCO IN REC-VARI
               IF REC-IND-VIGE IN REC  = 'N'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-DET-DEU-RELA
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI.
       FIN-DET-DEU-RELA.
           EXIT.
      **************************************************************************
      **************************************************************************
      * Distribucion del Vencimiento Vigente y Partidas Validas VAL-PAR-OPC
       DIS-OPC-VEN-1 SECTION.
       INI-DIS-OPC-VEN-1.
      * Determinacion de los Plazos del Vencimiento segun Fecha Vencimiento
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.
           PERFORM DIF-MES-VEN-INF.
           IF WSS-IND-STAT IN WSS-VARI = 1
               DISPLAY 'ERROR AL CALCULAR PLAZO VENCIMIENTO VIGENTE : '
                        VEN-KEY-IVEN
               GO TO FIN-DIS-OPC-VEN-1.
           MOVE FEC-NMES IN FEC-VARI TO WSS-NUM-PLAZ IN WSS-VARI.
           PERFORM DIS-REG-PROC.

      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Informe
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-SGV-FINF IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP IN WSS-VARI.

      * Monto Interes del Vencimiento en Pesos a Fecha Informe
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FINF IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.

      * Distribucion de Valores del Vencimiento segun Plazo y Moneda
           PERFORM PRO-ADD-VTCP.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.
       FIN-DIS-OPC-VEN-1.
           EXIT.
      **************************************************************************
      * Distribucion del Vencimiento Moroso y Partidas Validas VAL-PAR-OPC
       DIS-OPC-VEN-2 SECTION.
       INI-DIS-OPC-VEN-2.
      * Determinacion de los Plazos del Vencimiento segun Fecha Vencimiento
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.
           PERFORM DIF-MES-INF-VEN.
           IF WSS-IND-STAT IN WSS-VARI = 1
               DISPLAY 'ERROR AL CALCULAR PLAZO VENCIMIENTO MOROSO : '
                        VEN-KEY-IVEN
               GO TO FIN-DIS-OPC-VEN-2.

      * Monto Saldo Capital del Vencimiento Moroso en Pesos a Fecha Vencimiento
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-SGV-FVEN IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP IN WSS-VARI.

      * Monto Interes del Vencimiento Moroso en Pesos a Fecha Vencimiento
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FVEN IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.

      * Distribucion de Valores del Vencimiento segun Plazo, Moneda y Estado
           IF FEC-NMES IN FEC-VARI NOT > 1
               MOVE 2 TO WSS-IND IN WSS-VARI
               PERFORM PRO-ADD-VTCP
           ELSE
               MOVE 1 TO WSS-IND IN WSS-VARI
               PERFORM PRO-ADD-VTCS.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.
       FIN-DIS-OPC-VEN-2.
           EXIT.
      **************************************************************************
      * Distribucion del Vencimiento Vencido y Partidas Validas VAL-PAR-OPCB
       DIS-OPC-VEN-3 SECTION.
       INI-DIS-OPC-VEN-3.
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.

      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Vencimiento
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY VEN-VAL-SCAP IN VEN BY WSS-SGV-FVEN IN WSS-VARI
                                GIVING WSS-VAL-SCAP IN WSS-VARI ROUNDED
           ELSE
               MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SCAP IN WSS-VARI.

      * Monto Intereses del Vencimiento en Pesos a Fecha Vencimiento
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FVEN IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.

      * Distribucion de Valores del Vencimiento segun Moneda y Estado
           MOVE 2 TO WSS-IND IN WSS-VARI.
           PERFORM PRO-ADD-VTCS.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.
       FIN-DIS-OPC-VEN-3.
           EXIT.
      **************************************************************************
      * Distribucion del Vencimiento de Operaciones Contingentes
       DIS-OPC-VEN-4 SECTION.
       INI-DIS-OPC-VEN-4.
           ADD 1 TO WSS-NUM-VENS IN WSS-VARI.

      * Monto Saldo Capital del Vencimiento en Pesos a Fecha Informe
           MOVE ZEROES TO WSS-VAL-SCAP IN WSS-VARI.

      * Monto Intereses del Vencimiento en Pesos a Fecha Informe
           SUBTRACT VEN-VAL-SCAP IN VEN FROM
                    VEN-VAL-SFIN IN VEN GIVING
                    WSS-VAL-INTS IN WSS-VARI.
           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY WSS-VAL-INTS IN WSS-VARI BY
                        WSS-SGV-FINF IN WSS-VARI GIVING
                        WSS-VAL-INTS IN WSS-VARI ROUNDED.

      * Distribucion de Valores del Vencimiento segun Plazo y Moneda
           MOVE 2 TO WSS-IND IN WSS-VARI.
           PERFORM PRO-ADD-VTCP.
           ADD 1 TO WSS-NUM-VENP IN WSS-VARI.
       FIN-DIS-OPC-VEN-4.
           EXIT.
      **************************************************************************
      * Calcula Diferencia en Meses entre Fecha Informe y Fecha Vencimiento
       DIF-MES-VEN-INF SECTION.
       INI-DIF-MES-VEN-INF.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FEC1.
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           IF FEC-NDIA IN FEC-VARI > 0
               ADD  1  TO FEC-NMES IN FEC-VARI.
       FIN-DIF-MES-VEN-INF.
           EXIT.
      **************************************************************************
      * Calcula Diferencia en Meses entre Fecha Vencimiento y Fecha Informe
       DIF-MES-INF-VEN SECTION.
       INI-DIF-MES-INF-VEN.
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC1.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-MES  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
           IF FEC-NDIA IN FEC-VARI > 0
               ADD  1  TO FEC-NMES IN FEC-VARI.
       FIN-DIF-MES-INF-VEN.
           EXIT.
      **************************************************************************
      * Distribucion de Registros Seleccionados para Tramo Correspondiente
       DIS-REG-PROC SECTION.
       INI-DIS-REG-PROC.
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 1
               MOVE 2 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 3
               MOVE 3 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 6
               MOVE 4 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 12
               MOVE 5 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 36
               MOVE 6 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI NOT > 120
               MOVE 7 TO WSS-IND IN WSS-VARI
           ELSE
           IF WSS-NUM-PLAZ IN WSS-VARI > 120
               MOVE 8 TO WSS-IND IN WSS-VARI.
       FIN-DIS-REG-PROC.
           EXIT.
      **************************************************************************
      * Clasificacion del Vencimiento segun Moneda y Plazo
       PRO-ADD-VTCP SECTION.
       INI-PRO-ADD-VTCP.
           IF WSS-IND-MNAC IN WSS-VARI = 0
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMN1 IN WSS-VTMN(WSS-IND)
           ELSE
           IF WSS-IND-MNAC IN WSS-VARI = 1 AND
              OPC-MSC-TVOC IN OPC = '0'
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMN2 IN WSS-VTMN(WSS-IND)
           ELSE
           IF WSS-IND-MNAC IN WSS-VARI = 1 AND
              OPC-MSC-TVOC IN OPC = '1'
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMX1 IN WSS-VTMX(WSS-IND).
       FIN-PRO-ADD-VTCP.
           EXIT.
      **************************************************************************
      * Clasificacion del Vencimiento segun Moneda y Estado
       PRO-ADD-VTCS SECTION.
       INI-PRO-ADD-VTCS.
           IF WSS-IND-MNAC IN WSS-VARI = 0
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMNA IN WSS-VTCN(WSS-IND)
           ELSE
           IF WSS-IND-MNAC IN WSS-VARI = 1 AND
              OPC-MSC-TVOC IN OPC = '0'
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMNB IN WSS-VTCN(WSS-IND)
           ELSE
           IF WSS-IND-MNAC IN WSS-VARI = 1 AND
              OPC-MSC-TVOC IN OPC = '1'
               ADD WSS-VAL-SCAP IN WSS-VARI
                   WSS-VAL-INTS IN WSS-VARI
                                   TO WSS-TMXA IN WSS-VTCX(WSS-IND).
       FIN-PRO-ADD-VTCS.
           EXIT.
      **************************************************************************
      * Redondea en Millones ($) Montos Acumulados para el Reporte
       PRO-RND-VAL-RPT SECTION.
       INI-PRO-RND-VAL-RPT.
       PRO-RND-8.
           DIVIDE WSS-TMN1 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN1 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMN2 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN2 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMN3 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN3 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMN4 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN4 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMN5 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN5 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMN6 IN WSS-VTMN(WSS-IND) BY 1000000
                           GIVING WSS-TMN6 IN WSS-VRMN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMX1 IN WSS-VTMX(WSS-IND) BY 1000000
                           GIVING WSS-TMX1 IN WSS-VRMX(WSS-IND) ROUNDED.
           DIVIDE WSS-TMX2 IN WSS-VTMX(WSS-IND) BY 1000000
                           GIVING WSS-TMX2 IN WSS-VRMX(WSS-IND) ROUNDED.
           DIVIDE WSS-TMX3 IN WSS-VTMX(WSS-IND) BY 1000000
                           GIVING WSS-TMX3 IN WSS-VRMX(WSS-IND) ROUNDED.
           DIVIDE WSS-TMX4 IN WSS-VTMX(WSS-IND) BY 1000000
                           GIVING WSS-TMX4 IN WSS-VRMX(WSS-IND) ROUNDED.
           DIVIDE WSS-TMX5 IN WSS-VTMX(WSS-IND) BY 1000000
                           GIVING WSS-TMX5 IN WSS-VRMX(WSS-IND) ROUNDED.
       PRO-RND-2.
           DIVIDE WSS-TMNA IN WSS-VTCN(WSS-IND) BY 1000000
                           GIVING WSS-TMNA IN WSS-VRCN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMNB IN WSS-VTCN(WSS-IND) BY 1000000
                           GIVING WSS-TMNB IN WSS-VRCN(WSS-IND) ROUNDED.
           DIVIDE WSS-TMXA IN WSS-VTCX(WSS-IND) BY 1000000
                           GIVING WSS-TMXA IN WSS-VRCX(WSS-IND) ROUNDED.
       FIN-PRO-RND-VAL-RPT.
           EXIT.
      **************************************************************************
      * Totaliza Montos Acumulados Redondeados para el Reporte
       PRO-TOT-VAL-RPT SECTION.
       INI-PRO-TOT-VAL-RPT.
       PRO-TOT-LIN1.
           ADD WSS-TMN3 IN WSS-VRMN(WSS-IND)
               WSS-TMN4 IN WSS-VRMN(WSS-IND)
               WSS-TMN5 IN WSS-VRMN(WSS-IND)
               WSS-TMN6 IN WSS-VRMN(WSS-IND)
                           GIVING WSS-TMN7 IN WSS-VRMN(WSS-IND).
           ADD WSS-TMX1 IN WSS-VRMX(WSS-IND)
               WSS-TMX2 IN WSS-VRMX(WSS-IND)
               WSS-TMX3 IN WSS-VRMX(WSS-IND)
                           GIVING WSS-TMX4 IN WSS-VRMX(WSS-IND).
       PRO-TOT-COL1.
           ADD WSS-TMN1 IN WSS-VRMN(WSS-IND) TO WSS-TMN1 IN WSS-VRMN(9).
           ADD WSS-TMN2 IN WSS-VRMN(WSS-IND) TO WSS-TMN2 IN WSS-VRMN(9).
           ADD WSS-TMN3 IN WSS-VRMN(WSS-IND) TO WSS-TMN3 IN WSS-VRMN(9).
           ADD WSS-TMN4 IN WSS-VRMN(WSS-IND) TO WSS-TMN4 IN WSS-VRMN(9).
           ADD WSS-TMN5 IN WSS-VRMN(WSS-IND) TO WSS-TMN5 IN WSS-VRMN(9).
           ADD WSS-TMN6 IN WSS-VRMN(WSS-IND) TO WSS-TMN6 IN WSS-VRMN(9).
           ADD WSS-TMN7 IN WSS-VRMN(WSS-IND) TO WSS-TMN7 IN WSS-VRMN(9).
           ADD WSS-TMX1 IN WSS-VRMX(WSS-IND) TO WSS-TMX1 IN WSS-VRMX(9).
           ADD WSS-TMX2 IN WSS-VRMX(WSS-IND) TO WSS-TMX2 IN WSS-VRMX(9).
           ADD WSS-TMX3 IN WSS-VRMX(WSS-IND) TO WSS-TMX3 IN WSS-VRMX(9).
           ADD WSS-TMX4 IN WSS-VRMX(WSS-IND) TO WSS-TMX4 IN WSS-VRMX(9).
           ADD WSS-TMX5 IN WSS-VRMX(WSS-IND) TO WSS-TMX5 IN WSS-VRMX(9).
       FIN-PRO-TOT-VAL-RPT.
           EXIT.
      **************************************************************************

       COPY GNSBFMSC.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY SGCBFDBC.
       COPY SGCBFREC.
      *COPY DEUBFRDE.
       DEU-FIO-RDE SECTION.
       INI-DEU-FIO-RDE.
      * Lee y Mueve desde RDE en Memoria al Registro RDE
           PERFORM GET-RDE.
       FIN-DEU-FIO-RDE.
           EXIT.
       GET-RDE SECTION.
       INI-GET-RDE.
      * Lee y Mueve desde RDE en Memoria al Registro RDE
           MOVE '00' TO FIO-STAT.
           ADD  1  TO DEU-R.
           IF DEU-R > DEU-RMAX OR
              DEU-R > 50
               MOVE '10' TO FIO-STAT
               GO TO FIN-GET-RDE.
           MOVE DEU-CIC-ICLI IN DEU        TO RDE-CIC-ICLI IN RDE.
           MOVE RDE-IND-TIPD IN DEU(DEU-R) TO RDE-IND-TIPD IN RDE.
           MOVE RDE-IND-SCRT IN DEU(DEU-R) TO RDE-IND-SCRT IN RDE.
           MOVE RDE-IND-SCTB IN DEU(DEU-R) TO RDE-IND-SCTB IN RDE.
           MOVE RDE-IND-SCBZ IN DEU(DEU-R) TO RDE-IND-SCBZ IN RDE.
           MOVE RDE-COD-COCR IN DEU(DEU-R) TO RDE-COD-COCR IN RDE.
           MOVE RDE-COD-VCCR IN DEU(DEU-R) TO RDE-COD-VCCR IN RDE.
           MOVE RDE-COD-OFCR IN DEU(DEU-R) TO RDE-COD-OFCR IN RDE.
           MOVE RDE-VAL-DEUD IN DEU(DEU-R) TO RDE-VAL-DEUD IN RDE.
       FIN-GET-RDE.
           EXIT.
       COPY DEUBFESC.
       COPY DEUBFFIA.
       COPY DEUBFAMF.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFTOC.
       COPY COLBFRDT.
       COPY GNSBBMSC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBGCAM.
       COPY DEUBCDEU.
       COPY SGCBGPPU.
       COPY COLBGVEN.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
      *>>>>
*% END
