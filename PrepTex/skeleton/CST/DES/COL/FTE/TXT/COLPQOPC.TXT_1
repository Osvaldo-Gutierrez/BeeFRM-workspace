*%! Codigo adicional para archivo
*% IF PGM_CHI AND PGM_BCI
*%     PRV_BCI = TRUE
*% END
*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
       COPY COLWGENG.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
           02 SCR-IND-ACAN                         PIC X(03).
           02 SCR-MSC-TCAN                         PIC X(01).
           02 SCR-OPC-STAT                         PIC X(01).
      *>>>>
*% END
*% LARGO_MI_COMMAREA = 2750
*% IF WSS
      *<<<< WSS
       COPY COLWGRNO.
      *Por el manejo del INGreso que tiene el modulo BQ
       COPY COLBRTOC.
      *
       01  WSS-VARI.
      *Por el manejo del INGreso que tiene el modulo BQ
           03 WSS-CAI-ICIC.
              05 WSS-COD-TCIC                     PIC X(01).
              05 WSS-COD-CCIC                     PIC X(03).
           03  WSS-MSC-TCAN                       PIC X(01).
           03  WSS-CIC-IOPV                       PIC X(12).
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                   PIC X(40).
               05  WSS-CPT-IOPV                   PIC X(12).
               05  WSS-CPT-DATA                   PIC X(40).
           03  WSS-CPT-NOMB-R REDEFINES WSS-CPT-NOMB PIC X(92).
      *
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-SGV-RENO   COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  RCAN-CAN-KEY-ICAN                  PIC X(15).
           03  WSS-TOT-RCAN   VALUE ZEROES        PIC 9(04).
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           03  WSS-TOT-PTTS   VALUE ZEROES        PIC 9(04).
           03  WSS-CIC-IOPC                       PIC X(12).
           03  WSS-KEY-IVCT                       PIC X(15).
      *DAD fin  09-DIC-1991

           03  WSS-IND-PAUT       VALUE 'N'       PIC X(01).
           03  WSS-MENS.
               05  WSS-DCOR                       PIC X(12).
               05  EDT-CAN-SGV-TREN PIC  --.---.---.--9,99999.
               05  WSS-ABRV                       PIC X(05).
               05  EDT-WSS-SGV-RENO PIC  --.---.---.--9,99999.
               05  WSS-DESC                       PIC X(40).
           03  WSS-SGV-RENO-PES COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-ROV-SGV-RENO COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-ROV-COD-VCVR                     PIC X(06).

      *Registros de TABLAS
       COPY TABBRCAM.
      *Registros de CLIENTES
       COPY SGCBRDBC.
       COPY SGCBROPE.
       COPY SGCBRRCO.
      *Registros de Colocaciones
      *DAD ini  21-JUL-1992
       COPY COLBRPOC.
      *DAD fin  21-JUL-1992
       COPY COLBRRDC.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRCAN.
       COPY COLBRROV.
      *
       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *
       COPY COLWGPMP.
*% IF PRV_BCI
      *DAD ini  02-ENE-1992   (Memo.09-12-91)
           COPY USPC113.
      *DAD fin  02-ENE-1992
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *DAD ini  21-JUL-1992
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
      *DAD fin  21-JUL-1992
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *Por el manejo del INGreso que tiene el modulo BQ
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2
               MOVE 'O'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF INI_STP_EXIT
      *<<<< INI_STP_EXIT
           IF SCR-CMND = 'DES'
               MOVE 'COLPDOPC' TO SCR-PROV
               MOVE 'KO53'     TO SCR-NTRV
           ELSE
           IF SCR-CMND = 'ACA' OR 'ACO'
               MOVE 'COLPOOPC' TO SCR-PROV
               MOVE 'KO45'     TO SCR-NTRV
           ELSE
               MOVE 'COLPUOPC' TO SCR-PROV
               MOVE 'KO42'     TO SCR-NTRV.
      *>>>>
*% END 
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC.

           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC.
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *     IF SCR-CCPP = 'ING' AND
      *        OPC-IIC-IOPC IN OPC-FLD NOT > ZEROES
      *         MOVE FIO-STAT-NEX TO FIO-STAT
      *         GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               GO TO CON-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   IF MSG-COD-MENS = 'RDCSI'
                       PERFORM SCR-CLRA-OPC
                       PERFORM PUT-DBC
                       MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                       MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                       GO TO CON-FND-KEY
                   ELSE
                       IF SCR-KEY-IRDC = 'IDLC'
                           PERFORM CLR-FLD-OPC
                           IF FRM-FFLD = FRM-FFLD-PF5
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDC    NOPRV' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDC    NONXT' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                       ELSE
                           PERFORM SCR-CLRA-OPC
                           PERFORM PUT-DBC
                           PERFORM BUS-DEU-DIR
                           IF NOT FIO-STAT-OKS
                               MOVE 'COL' TO MSG-COD-SIST
                               MOVE 'CLI    NODIR' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MEN2
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                               MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC
                                                                 IN OPC
                               GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   PERFORM CLR-FLD-OPC
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
           ELSE
           IF OPC-IIC-IOPC IN OPC-FLD > ZEROES
               GO TO CON-FND-KEY
           ELSE
           IF DBC-NUM-ICLI IN OPC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN OPC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN OPC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

               MOVE DBC-GLS-NOMC IN OPC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-OPC.
      *
           MOVE OPC-MSC-STAT IN OPC TO SCR-OPC-STAT
      *
           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROV-CAN
               PERFORM BUS-CNC.

           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
               PERFORM GET-ROV-REN
               MOVE WSS-SGV-RENO TO ROV-SGV-RENO IN ROV.

           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               GO TO OPC-FND-KEY.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO ANL-CLI.
       OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00'         TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE '00'   TO PGM-STAT-RDC.
           MOVE 'IDLC' TO SCR-KEY-IRDC.
           MOVE ADR-RDC-REQA TO SCR-RQA2.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN OPC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO ANL-CLI.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
            MOVE '00' TO PGM-STAT-DBC.
            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
            PERFORM CPT-BLKS.
            MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD.
            MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
            MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
            MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
            MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
       ANL-CLI.
            PERFORM ANL-KEY-ALL.
            IF MSG-COD-MENS NOT = SPACES
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE SCR-STAT-CON TO SCR-STAT
                GO TO FIN-FND-KEY.
       REC-OPC-STAT.
      *ALD/4-AUG-1988
           MOVE PGM-STAT-OPC TO FIO-STAT.
      *JSS 16-MAY-1991 15:32:57 ( para manejo de cuenta corriente )

      *    IF OPC-MSC-STAT IN OPC = 'X' OR 'B' OR 'G'
           IF OPC-ESPERA-ABONO
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCSTT'            TO MSG-COD-TMSG
               MOVE OPC-MSC-STAT IN OPC TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00' TO FIO-STAT
           ELSE
      *
      *    IF OPC-MSC-STAT IN OPC = 'S'
           IF OPC-SUSPENDIDA
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    SUSYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF FIO-STAT-OKS
      *        IF OPC-MSC-STAT IN OPC = 'A'
               IF OPC-ACTIVADA
                   IF SCR-CMND = 'MCA'
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OPC    ACAYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
               ELSE
      *            IF OPC-MSC-STAT IN OPC = 'D'
                   IF OPC-DESACTIVADA
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OPC    DESYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       IF SCR-CMND = 'MCA'
                           MOVE 'COL' TO MSG-COD-SIST
                           MOVE 'OPC    NOACA' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY.
      *
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF FIN_HBL_IKY OR FIN_HBL_KEY
      *<<<< FIN_HBL_IKY OR FIN_HBL_KEY
      *HPM ini
           MOVE SPACES TO SCR-OPC-STAT.
      *HPM fin
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'MCA'
      *        PERFORM PRO-IKY-CAN.
               MOVE FRM-CPIM-AEY TO CAN-CAI-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-IIC-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-NUM-ICAN-ATR IN OPC-FLD.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           PERFORM PRO-FLD-BCI.

           MOVE FRM-CPIM-AEY TO OPC-COD-TOOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO OPC-COD-VCOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO OPC-COD-AOOC-ATR IN OPC-FLD.
           MOVE 0            TO OPC-COD-TOOC-LEN IN OPC-FLD.
           MOVE -1           TO OPC-COD-OFOC-LEN IN OPC-FLD.

      *DAD ini  21-JUL-1992
           MOVE OPC-COD-VCOC IN OPC-FLD TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC-FLD TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.

           IF POC-COD-COTO IN POC = 'LAC'
               MOVE FRM-CPIM-UBY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-IIC-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-IIC-ICYA-ATR IN OPC-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IIC-ILDC-ATR IN OPC-FLD.
      *DAD fin  21-JUL-1992

           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-OPC
               PERFORM PRO-MKY-OPC
               MOVE FRM-CPIM-UBY TO RDC-NUM-DIRE-ATR IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGD-ATR IN OPC-FLD
      *DAD fin  12-AUG-1992
               MOVE FRM-CPIM-UBY TO OPC-COD-CDOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-COD-RMOC-ATR IN OPC-FLD
      *DAD ini  21-AUG-1992   (Memo.07-08-92 Pto.3)
               IF POC-COD-COTO IN POC NOT = 'LAC'
                   MOVE FRM-CPIM-UBY TO AUT-CAI-ICYA-ATR IN OPC-FLD
                   MOVE FRM-CPIM-UBY TO AUT-IIC-ICYA-ATR IN OPC-FLD.
           IF SCR-CMND = 'MCA'
      *DAD fin  21-AUG-1992
               IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
      *             MOVE -1           TO OPC-COD-RMOC-LEN IN OPC-FLD
                   MOVE -1           TO OPC-VAL-SEGD-LEN IN OPC-FLD
      *DAD fin  12-AUG-1992
                   GO TO FIN-HBL-FLD
               ELSE
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN OPC-FLD
                   GO TO FIN-HBL-FLD.
      *
           IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO ITR-COD-TINT-ATR IN OPC-FLD.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MITR = 'M'
               MOVE FRM-CPIM-AEY TO ITR-SGV-TINT-ATR IN OPC-FLD.
           IF COM-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MCOM = 'M'
               MOVE FRM-CPIM-AEY TO COM-COD-TINT-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO COM-SGV-TINT-ATR IN OPC-FLD.
           IF CYA-IND-TCYA IN OPC-FLD = 'M' AND
              SCR-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD.

           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC-FLD > SPACES
               MOVE           +3 TO OPC-COD-OFOC-LEN IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-COD-OFOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-FEC-FCOL-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IND-RENO-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO ROV-SGV-RENO-ATR IN OPC-FLD.

           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI) OR
              (DBC-IND-ICLI IN OPC-FLD = 'M')
                 MOVE -1 TO OPC-VAL-CRED-LEN IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
           ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPC-FLD.
           IF OPC-IND-RENO IN OPC-FLD > SPACES
               MOVE           +3 TO OPC-COD-OFOC-LEN IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-COD-OFOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-FEC-FCOL-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IND-RENO-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO ROV-SGV-RENO-ATR IN OPC-FLD.

           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
                 MOVE -1 TO OPC-VAL-CRED-LEN IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
           ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPC-FLD.
      *HPM ini     
           MOVE SCR-OPC-STAT TO OPC-MSC-STAT IN OPC
           IF ( OPC-PENDIENTE-CTC AND SCR-CCPP = 'MOD' )
               MOVE FRM-CPIM-AEY TO OPC-VAL-CRED-ATR IN OPC-FLD
               MOVE -1           TO DBC-NUM-ICLI-LEN IN OPC-FLD.
      *HPM fin
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       GET-ROV-CAN SECTION.
       INI-GET-ROV-CAN.
      * RECUPERA CANCELACION(NOV)  ASOCIADA A OPERACION
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE '23' TO PGM-STAT-CAN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-ROV
               GO TO FIN-GET-ROV-CAN.

           IF OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO FIN-GET-ROV-CAN.

           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
                MOVE FIO-STAT TO PGM-STAT-ROV
                MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM COL-FIO-CAN
                MOVE FIO-STAT TO PGM-STAT-CAN
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROV.
       FIN-GET-ROV-CAN.
           EXIT.

       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-RQA2 > SPACES
               PERFORM LEE-NXT-PRV-RDC
           ELSE
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               MOVE SPACES TO SCR-KEY-IRDC
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-RDC SECTION.
       INI-LEE-NXT-PRV-RDC.
           MOVE SCR-RQA2 TO ADR-RDC-REQA.
           IF SCR-KEY-IRDC = 'IRDC'
               MOVE ADR-VKEY IN ADR-RDC-REQA TO WSS-CIC-ICLI IN
                                                       WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                       GO TO INI-LEE-NXT-PRV-RDC
                   ELSE
                       MOVE 'RDCSI' TO MSG-COD-MENS
                       MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DBC
                       MOVE '00' TO PGM-STAT-DBC
               ELSE
                   IF RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI IN WSS-VARI
                       MOVE ADR-RDC-REQA TO SCR-RQA2
                       IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                           GO TO INI-LEE-NXT-PRV-RDC
                       ELSE
                           MOVE 'RDCSI' TO MSG-COD-MENS
                   ELSE
                       MOVE 'RDCNO' TO MSG-COD-MENS
                       MOVE SPACES TO SCR-RQA2
                       IF SCR-RQA1 > SPACES
                           PERFORM LEE-NXT-PRV-DBC
                       ELSE
                           PERFORM LEE-NXT-PRV-NOM
           ELSE
               MOVE 'RDCNO' TO MSG-COD-MENS
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   IF SCR-RQA1 > SPACES
                       PERFORM LEE-NXT-PRV-DBC
                   ELSE
                       PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-RDC.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES

               MOVE DBC-GLS-NOMC IN OPC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-LEQ TO FIO-CMND
           ELSE
               MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-RQA1
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE 'DBC    NOPRV' TO MSG-COD-MENS
               ELSE
                   MOVE 'DBC    NONXT' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       ANL-KEY-OPC SECTION.
       INI-ANL-KEY-OPC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-OPC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD
               PERFORM BUS-DEU-DIR
               IF FIO-STAT-OKS
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NODIR' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-OPC.
           EXIT.

       ANL-KEY-ALL SECTION.
       INI-ANL-KEY-ALL.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-ANL-KEY-ALL.
           PERFORM GET-NXT-ITR.
           IF SCR-IND-MITR = 'M'
               MOVE 'MULTIPLES'  TO ITR-COD-TINT IN OPC-FLD
           ELSE
               MOVE '00' TO PGM-STAT-ITR
               PERFORM PUT-ITR-OPC.
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-COM
                PERFORM GET-NXT-COM
                IF SCR-IND-MCOM = 'M'
                    MOVE 'MULTIPLES' TO COM-COD-TINT IN OPC-FLD
                ELSE
                    PERFORM PUT-COM-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO COM-SGV-TINT IN OPC-FLD
                MOVE SPACES TO COM-COD-TINT IN OPC-FLD.
           PERFORM BUS-AUT-CYA.
           PERFORM GET-CUR-CYA.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-CYA
                PERFORM GET-NXT-CYA
                IF SCR-IND-MCYA = 'M'
                    MOVE 'M'          TO CYA-IND-TCYA IN OPC-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-CYA-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE SPACES TO CYA-IND-TCYA IN OPC-FLD
                MOVE SPACES TO CYA-CAI-ICYA IN OPC-FLD
                MOVE ZEROES TO CYA-IIC-ICYA IN OPC-FLD.
           MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-AUT
               PERFORM PUT-AUT-OPC
           ELSE
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO AUT-IIC-ICYA IN OPC-FLD
               MOVE SPACES TO AUT-CAI-ICYA IN OPC-FLD.
           PERFORM GET-CUR-ROV.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-ROV.
       FIN-ANL-KEY-ALL.
           EXIT.

       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-DIR.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-DIR
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIR.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN OPC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN OPC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN OPC-FLD.
       FIN-PUT-DBC.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-RDC.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.

       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO SCR-IND-MITR
           ELSE
                MOVE SPACES TO SCR-IND-MITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.

       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.

       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO SCR-IND-MCOM
           ELSE
                MOVE SPACES TO SCR-IND-MCOM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.

       BUS-AUT-CYA SECTION.
       INI-BUS-AUT-CYA.
           MOVE 'N' TO WSS-IND-PAUT IN WSS-VARI.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
      *DSP COMPATIBILIDAD VSAM-DTC FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-AUT-CYA.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS                        AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES )
               GO TO FIN-BUS-AUT-CYA.
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               IF MSC-COD-DAT1(2) = 'S'
                   MOVE 'S' TO WSS-IND-PAUT IN WSS-VARI
                   GO TO FIN-BUS-AUT-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-AUT-CYA.
       FIN-BUS-AUT-CYA.
           EXIT.

       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-CYA.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
              CYA-NUM-ICAN IN CYA = ZEROES AND
              CYA-NUM-ICYA IN CYA = 1
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-CYA.
           EXIT.

       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPC    MCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.

       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE 'ROV-KEY-IROV' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-ROV.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC AND
              ROV-CIC-IOPV IN ROV = SPACES AND
              ROV-NUM-IVCT IN ROV = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-ROV.
           EXIT.
      **************************************************************************
       GET-ROV-REN SECTION.
       INI-GET-ROV-REN.
      * RECUPERA CANCELACIONES (REN)  ASOCIADAS A OPERACION
      * DEJA EN ZERO EN TOTAL DE CANCELACIONES QUE RENUEVAN LA OPERACION
           MOVE ZEROES TO WSS-TOT-RCAN.
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           MOVE ZEROES TO WSS-TOT-PTTS IN WSS-VARI.
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               PERFORM CHK-ROV-PTTS
               IF WSS-TOT-PTTS IN WSS-VARI > ZEROES
                   GO TO VRF-RCAN.
      *DAD fin  09-DIC-1991
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE LOW-VALUES          TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * ASUME QUE NO ENCONTRARA ROV'S
           MOVE '23' TO PGM-STAT-ROV.
       CIC-GET-ROV-REN.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS OR
              OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO VRF-RCAN.

           IF NOT ( ROV-IIC-IOPV IN ROV > ZEROES AND
                    ROV-NUM-IVCT IN ROV > ZEROES )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-ROV-REN
           ELSE       
               MOVE FIO-STAT TO PGM-STAT-ROV
               MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF FIO-STAT-OKS AND
      *JSS 15-MAY-1991 20:41:00 ( agregado OR 'P' para manejo de cc )
                   ( CAN-MSC-STAT IN CAN = 'C' OR 
                     CAN-MSC-STAT IN CAN = 'W' OR 'P' ) OR
      *            ( OPC-MSC-STAT IN OPC = 'A' AND
                   ( OPC-ACTIVADA              AND
                     CAN-MSC-STAT IN CAN = 'A' )
                       MOVE CAN-KEY-ICAN TO RCAN-CAN-KEY-ICAN
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
      *                IF OPC-MSC-STAT IN OPC = 'A' AND
                       IF OPC-ACTIVADA              AND
                          CAN-MSC-STAT IN CAN = 'A' AND
                          CAN-MSC-CANC IN CAN = 'PTT'
      *DAD ini  14-AUG-1992   (Memo.25-06-92 Pto.2)
                           MOVE  1  TO WSS-TOT-PTTS IN WSS-VARI
                           MOVE CAN-SGV-TREN IN CAN TO WSS-SGV-RENO
      *DAD fin  14-AUG-1992
                           MOVE FIO-GET-NXT TO FIO-CMND
                           GO TO CIC-GET-ROV-REN
                       ELSE
      *DAD fin  09-DIC-1991
                           ADD 1                   TO WSS-TOT-RCAN
      *                    ADD ROV-SGV-RENO IN ROV TO WSS-SGV-RENO
                           ADD CAN-SGV-TREN IN CAN TO WSS-SGV-RENO
                           MOVE FIO-GET-NXT TO FIO-CMND
                           GO TO CIC-GET-ROV-REN.
       VRF-RCAN.
      * EN INGRESO VERIFICO QUE EXISTIERA AL MENOS UNA CANCELACION
      * CON STATUS 'C' OR 'W'
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           IF WSS-TOT-RCAN = ZEROES             AND
              WSS-TOT-PTTS IN WSS-VARI = ZEROES
      *DAD fin  09-DIC-1991
               GO TO FIN-GET-ROV-REN.

      *    RECUPERA ULTIMA CANCELACION CON STATUS 'C' O 'W'
           MOVE RCAN-CAN-KEY-ICAN TO CAN-KEY-ICAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
       FIN-GET-ROV-REN.
           EXIT.
      *-------------------------------------------------------------------------
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
      * En el caso de PTT's obtiene la operacion anterior que fue Prorrogada
       CHK-ROV-PTTS SECTION.
       INI-CHK-ROV-PTTS.
           MOVE '23' TO PGM-STAT-ROV.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = ROV-CIC-IOPV IN ROV )
               GO TO FIN-CHK-ROV-PTTS.
           MOVE ROV-CIC-IOPC IN ROV TO WSS-CIC-IOPC IN WSS-VARI.
       CAN-CHK-ROV-PTTS.
           MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
      *             OPC-MSC-STAT IN OPC = 'A' AND
                    OPC-ACTIVADA              AND
                    CAN-MSC-STAT IN CAN = 'A' AND
                    CAN-MSC-CANC IN CAN = 'PTT' )
               GO TO FIN-CHK-ROV-PTTS.
           MOVE LOW-VALUES TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CHK-ROV-PTTS.
           PERFORM COL-FIO-ROV.
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = WSS-CIC-IOPC IN WSS-VARI
               MOVE FIO-STAT TO PGM-STAT-ROV
               IF ROV-CIC-IOPV IN ROV NOT = OPC-CIC-IOPC IN OPC
                   MOVE ROV-KEY-IVCT IN ROV TO WSS-KEY-IVCT IN WSS-VARI
                   ADD 1 TO WSS-TOT-PTTS IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-CHK-ROV-PTTS
               ELSE
                   MOVE WSS-KEY-IVCT IN WSS-VARI TO RCAN-CAN-KEY-ICAN
                                                          IN WSS-VARI.
       FIN-CHK-ROV-PTTS.
           EXIT.
      *DAD fin  09-DIC-1991
      **************************************************************************
      *
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
      *
      *DAD ini  21-JUL-1992
       COPY COLBFPOC.
      *DAD fin  21-JUL-1992
       COPY COLBFRDC.
       COPY COLBFROV.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFCAN.
       COPY COLBFITR.
       COPY COLBFCOM.
      *Por el manejo del INGreso que tiene el modulo BQ
       COPY COLBFTOC.
      *
       COPY GNSBGPES.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY TABBFCAM.
       COPY COLB3OPC.
*% IF PGM_CHI AND PGM_BCI
      *DAD ini  04-OCT-1993   (Memo.28-06-93)
       COPY COLBGVDA.
      *DAD fin  04-OCT-1993

*% END
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-OPC.
           PERFORM EDT-KEY-OPC.
           PERFORM EDT-FLD-OPC.
           MOVE SCR-MENS-EXT TO OPC-GLS-MENS.
           MOVE SPACES TO SCR-CIC-IOPC
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-IND-EOV
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE OPC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.

      * COPY COLBGMPT.
       CRG-TBL-ENG SECTION.
       INI-CRG-TBL-ENG.
           IF SCR-IND-OOD = 'C'
               MOVE 'CO07COLPACANCOLFCANCOLACAN' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'CO16COLPACYACOLFCYACOLACYA' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 2 TO WSS-TOT-IIDX
           ELSE
               MOVE 'KO40COLPQOPCCOLFOPCCOLAOPC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'CO29COLPARDCCOLFRDCCOLARDC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 'CO26COLPAICGCOLFICGCOLAICG' TO
                       WSS-VEC-PPRO IN WSS-PPRO(3)
               MOVE 'CO16COLPACYACOLFCYACOLACYA' TO
                       WSS-VEC-PPRO IN WSS-PPRO(4)
               MOVE 'CO12COLPADLCCOLFDLCCOLADLC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(5)
               MOVE 'CO29COLPARDCCOLFRDCCOLARDC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(6)
               MOVE 7 TO WSS-TOT-IIDX.
       FIN-CRG-TBL-ENG.
           EXIT.
       COPY COLBGRNO.

       GET-FEC-FACO SECTION.
       INI-GET-FEC-FACO.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO OPC-NUM-DINP IN OPC.
           MOVE HOY-MHOY TO OPC-NUM-MINP IN OPC.
           MOVE HOY-SHOY TO OPC-NUM-SINP IN OPC.
           MOVE HOY-AHOY TO OPC-NUM-AINP IN OPC.
       FIN-GET-FEC-FACO.
           EXIT.

       MSG-ABT-KEY SECTION.
       INI-MSG-ABT-KEY.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-MSG-ABT-KEY.
           EXIT.

       GET-ROV-NOV SECTION.
       INI-GET-ROV-NOV.
      * RECUPERA CANCELACION(NOV)  ASOCIADA A OPERACION
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE '23' TO PGM-STAT-CAN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROV-NOV.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = ROV-CIC-IOPC IN ROV )
               MOVE FIO-STAT TO PGM-STAT-ROV
               GO TO FIN-GET-ROV-NOV.

           IF OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO FIN-GET-ROV-NOV.

           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
       
      * INICIALIZA ACUMULADOR CON VALOR DE ROV DE OPC A ACTIVAR
      * PARA CONSIDERARLO EN LA SUMATORIA Y ADEMAS LO RESPALDA
                MOVE ROV-SGV-RENO IN ROV TO WSS-SGV-RENO
                                            WSS-ROV-SGV-RENO
                MOVE ROV-COD-VCVR IN ROV TO WSS-ROV-COD-VCVR 
                MOVE FIO-STAT TO PGM-STAT-ROV
                MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM COL-FIO-CAN
                MOVE FIO-STAT TO PGM-STAT-CAN
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROV-NOV.
           PERFORM OBT-VAL-CAMB.
           MOVE WSS-SGV-RENO-PES TO WSS-SGV-RENO.
       FIN-GET-ROV-NOV.
           EXIT.

       VRF-ROV-NOV SECTION.
       INI-VRF-ROV-NOV.
           MOVE SPACES TO MSG-COD-MENS.
      * LEERA ( POR ROV ) TODAS LAS OPERACIONES ASOCIADAS A LA
      * MISMA CANCELACION
           MOVE CAN-KEY-ICAN IN CAN TO ROV-KEY-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-VRF-ROV-NOV.
           PERFORM COL-FIO-ROV.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = ROV-CIC-IOPV IN ROV

      * SOLO CONTABILIZA AQUELLAS OPERACIONES YA ACTIVADAS EN ESTADO
      * ESPECIAL DE NOVACION
                IF ROV-MSC-STAT IN ROV = 'S'
                    PERFORM OBT-VAL-CAMB
                    ADD WSS-SGV-RENO-PES TO WSS-SGV-RENO
                    MOVE 'ROV-KEY-IVCT' TO FIO-AKEY
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO CIC-VRF-ROV-NOV
                ELSE
                    MOVE 'ROV-KEY-IVCT' TO FIO-AKEY
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO CIC-VRF-ROV-NOV.
       FIN-VRF-ROV-NOV.
           EXIT.

       OBT-VAL-CAMB SECTION.
       INI-OBT-VAL-CAMB.
           MOVE 1 TO CAM-SGV-VCAM IN CAM.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999'         TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF TAB-COD-CTAB NOT = ROV-COD-VCVR IN ROV 
               MOVE CAN-NUM-DCAN IN CAN TO CAM-NUM-DCAM IN CAM(1)
               MOVE CAN-NUM-MCAN IN CAN TO CAM-NUM-MCAM IN CAM(1)
               MOVE CAN-NUM-SCAN IN CAN TO CAM-NUM-SCAM IN CAM(1)
               MOVE CAN-NUM-ACAN IN CAN TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAN-NUM-DCAN IN CAN TO CAM-NUM-DCAM IN CAM(2)
               MOVE CAN-NUM-MCAN IN CAN TO CAM-NUM-MCAM IN CAM(2)
               MOVE CAN-NUM-SCAN IN CAN TO CAM-NUM-SCAM IN CAM(2)
               MOVE CAN-NUM-ACAN IN CAN TO CAM-NUM-ACAM IN CAM(2)
               MOVE ROV-COD-VCVR IN ROV TO CAM-COD-VCAM IN CAM(1)
               MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 1 TO CAM-SGV-VCAM IN CAM.
           MULTIPLY ROV-SGV-RENO IN ROV BY CAM-SGV-VCAM IN CAM 
                    GIVING WSS-SGV-RENO-PES ROUNDED.
           MOVE WSS-SGV-RENO-PES TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-RENO-PES.
       FIN-OBT-VAL-CAMB.
           EXIT.

      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
      *Para comando Desactivar
           IF SCR-CMND = 'DES'
      *        PERFORM PRO-IKY-CAN.
               MOVE FRM-CPIM-AEY TO CAN-CAI-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-IIC-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-NUM-ICAN-ATR IN OPC-FLD.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
      *Validaciones para estado pendiente
           IF ( SCR-CCPP = 'ELI' OR SCR-CMND = 'MCA' ) AND
              ( OPC-PENDIENTE-CTC )
                  MOVE 'COL' TO MSG-COD-SIST
                  MOVE 'OPC    ESCTC' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE '00' TO FIO-STAT
                  MOVE SCR-STAT-CON TO SCR-STAT.
      *Validaciones para comando Desactivar ( DES )
           IF SCR-CMND = 'DES' AND
              NOT OPC-ACTIVADA
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    ACANO' TO MSG-COD-MENS
               PERFORM GET-MSG
      *        STRING MSG-GLS-DESC
      *               MSG-GLS-DATA DELIMITED BY SIZE
      *        INTO FRM-MENS
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT.
      *Validaciones para comando activar ( ACA y ACO )
           IF ( SCR-CMND = 'ACA' OR 'ACO' ) AND
              ( SCR-STAT NOT = SCR-STAT-CON )
               PERFORM VAL-COND-ACA.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-COND-ACA SECTION.
       INI-VAL-COND-ACA.
           IF NOT OPC-LIQUIDADA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    LIQNO' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           PERFORM GET-FEC-FACO.
           IF SCR-CMND = 'ACA' AND
              OPC-FEC-FINP IN OPC NOT = OPC-FEC-FCOL IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECFINPFCOLD' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF SCR-CMND = 'ACO' AND
              OPC-FEC-FINP IN OPC NOT = OPC-FEC-FCOL IN OPC AND
              WSS-IND-PAUT IN WSS-VARI = 'S'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYAAUTNOACA' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.

      *ALD/8-AUG-1988
           IF DBC-IND-ICLI IN OPC-FLD = 'M'
               GO TO UPD-VAL-COND-ACA.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.
           MOVE OPC-CIC-IOPC IN OPC TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RCO    YAEXI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
       UPD-VAL-COND-ACA.
           MOVE OPC-CIC-IOPC IN OPC TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPE    YAEXI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
           IF OPC-IND-RENO IN OPC NOT > SPACES
                GO TO FIN-VAL-COND-ACA.

           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROV-NOV
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-VAL-COND-ACA
               ELSE
               IF ( SCR-CMND = 'ACA' OR 'ACO' ) AND
                    PGM-STAT-CAN-OKS
      *JSS 15-MAY-1991 20:41:00 ( agregado OR 'P' para manejo de cc )
                     IF NOT ( CAN-MSC-STAT IN CAN = 'C' OR 'W' OR 'P' )
                         MOVE 'NOVSTAT INV' TO MSG-COD-MENS
                         PERFORM MSG-ABT-KEY
                         GO TO FIN-VAL-COND-ACA
                     ELSE
                         PERFORM BUS-CNC
                         IF WSS-MSC-TCAN = 'N'
                             PERFORM VRF-ROV-NOV
                             IF CAN-SGV-TREN IN CAN > WSS-SGV-RENO
                                 MOVE CAN-SGV-TREN IN CAN TO
                                      EDT-CAN-SGV-TREN
                                 MOVE WSS-SGV-RENO TO
                                      EDT-WSS-SGV-RENO
                                 MOVE 'COL'         TO MSG-COD-SIST
                                 MOVE 'TOTOPC NOV<' TO MSG-COD-MENS
                                 PERFORM GET-MSG
      * NO ES NECESARIO ABORTAR, SE ACTIVAN CON STATUS ESPECIAL
      *                          STRING MSG-GLS-DCOR
      *                                 EDT-CAN-SGV-TREN
      *                                 MSG-GLS-ABRV
      *                                 EDT-WSS-SGV-RENO
      *                                 MSG-GLS-DESC
      *                                 DELIMITED BY SIZE
      *                          INTO FRM-MENS

                                 MOVE MSG-GLS-DCOR TO WSS-DCOR
                                 MOVE CAN-SGV-TREN IN CAN TO
                                      EDT-CAN-SGV-TREN
                                 MOVE MSG-GLS-ABRV TO WSS-ABRV
                                 MOVE WSS-SGV-RENO TO
                                      EDT-WSS-SGV-RENO
                                 MOVE MSG-GLS-DESC TO WSS-DESC
                                 MOVE WSS-MENS     TO CPT-STRN
                                 PERFORM CPT-BLKS
                                 MOVE CPT-STRN     TO FRM-MENS
                                 MOVE WSS-ROV-SGV-RENO TO
                                      ROV-SGV-RENO IN ROV
                                 MOVE WSS-ROV-COD-VCVR TO
                                      ROV-COD-VCVR IN ROV
                             ELSE
                                 MOVE 'COL'        TO MSG-COD-SIST
                                 MOVE 'ACAOPC NOV' TO MSG-COD-MENS
                                 PERFORM GET-MSG

                                 MOVE MSG-GLS-DESC TO CPT-STR1
                                 MOVE MSG-GLS-DATA TO CPT-STR2
                                 PERFORM CPT-BLKS
                                 MOVE CPT-STRN     TO FRM-MENS
                                 MOVE 'NOV' TO SCR-IND-ACAN
                                 MOVE WSS-ROV-COD-VCVR TO
                                      ROV-COD-VCVR IN ROV
                                 MOVE WSS-ROV-SGV-RENO TO
                                      ROV-SGV-RENO IN ROV.
      *                           COMPUTE ROV-SGV-RENO IN ROV =
      *                                   WSS-ROV-SGV-RENO -
      *                                 ( WSS-SGV-RENO -
      *                                   CAN-SGV-TREN IN CAN ).

           PERFORM BUS-CIC-RENO
           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
               PERFORM GET-ROV-REN
      *         IF ( SCR-CMND = 'ACA' OR 'ACO' )
      *             IF WSS-SGV-RENO > OPC-VAL-CRED IN OPC
      *                  MOVE OPC-VAL-CRED IN OPC TO EDT-OPC-VAL-CRED
      *                  MOVE WSS-SGV-RENO TO EDT-WSS-SGV-RENO
      *                  MOVE 'COL' TO MSG-COD-SIST
      *                  MOVE 'TOTOPC REN<' TO MSG-COD-MENS
      *                  PERFORM GET-MSG
      * NO ES NECESARIO ABORTAR PUES EN INGRESO VALIDO QUE EL MONTO
      * DEL CREDITO NO SEA MENOR QUE LA SUMA LAS CANCELACIONES ASOCIADAS
      *                 STRING MSG-GLS-DCOR
      *                        EDT-OPC-VAL-CRED
      *                        MSG-GLS-ABRV
      *                        EDT-WSS-SGV-RENO
      *                        MSG-GLS-DESC
      *                        DELIMITED BY SIZE
      *                 INTO FRM-MENS
      *                  MOVE MSG-GLS-DCOR TO WSS-DCOR
      *                  MOVE OPC-VAL-CRED IN OPC TO EDT-CAN-SGV-TREN
      *                  MOVE MSG-GLS-ABRV TO WSS-ABRV
      *                  MOVE WSS-SGV-RENO TO EDT-WSS-SGV-RENO
      *                  MOVE MSG-GLS-DESC TO WSS-DESC
      *                  MOVE WSS-MENS     TO CPT-STRN
      *                  PERFORM CPT-BLKS
      *                  MOVE CPT-STRN     TO FRM-MENS
      *             ELSE
                        IF OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI
                            MOVE 'COL'        TO MSG-COD-SIST
                            MOVE 'ACAOPC REN' TO MSG-COD-MENS
                            MOVE 'REN' TO SCR-IND-ACAN
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO CPT-STR1
                            MOVE MSG-GLS-DATA TO CPT-STR2
                            PERFORM CPT-BLKS
                            MOVE CPT-STRN     TO FRM-MENS
                            COMPUTE ROV-SGV-RENO IN ROV =
                                  OPC-VAL-CRED IN OPC -
                                ( OPC-VAL-CRED IN OPC - WSS-SGV-RENO )
                        ELSE
                            IF OPC-IND-RENO IN OPC = RNO-CIC-PRO
                                                     IN RNO-VARI
                                MOVE 'COL'        TO MSG-COD-SIST
                                MOVE 'ACAOPC PRO' TO MSG-COD-MENS
                                MOVE 'PRO'        TO SCR-IND-ACAN
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO CPT-STR1
                                MOVE MSG-GLS-DATA TO CPT-STR2
                                PERFORM CPT-BLKS
                                MOVE CPT-STRN     TO FRM-MENS
                                COMPUTE ROV-SGV-RENO IN ROV =
                                      OPC-VAL-CRED IN OPC -
                                ( OPC-VAL-CRED IN OPC - WSS-SGV-RENO ).

      *DAD ini  20-ABR-1992   (Memo.13-03-92 pto.1)
           IF CAN-MSC-STAT IN CAN NOT = 'C'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    IOPNO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-VAL-COND-ACA.
      *DAD fin  20-ABR-1992
*% IF PRV_BCI
      *DAD ini  02-ENE-1992   (Memo.09-12-91)
           MOVE 'COL'        TO FIO-SIST.
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP ACA' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = 'S'
               PERFORM VAL-OFI-USP
               IF SCR-STAT = SCR-STAT-CON
                   GO TO FIN-VAL-COND-ACA.
      *DAD fin  02-ENE-1992
*% END
*% IF PGM_CHI AND PGM_BCI
      *DAD ini  04-OCT-1993   (Memo.28-06-93)
      *Valida existencia de informacion en campos informados con perdida
           PERFORM VAL-DAT-PREV-ACA.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.
      *DAD fin  04-OCT-1993
*% END
       FIN-VAL-COND-ACA.
           EXIT.
*% IF PRV_BCI
      *DAD ini  02-ENE-1992   (Memo.09-12-91)
       VAL-OFI-USP SECTION.
       INI-VAL-OFI-USP.
           COPY USPC143.
           IF USP-COD-OFICINA NOT = OPC-COD-OFOC IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OFIUSP NOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC    TO FRM-MEN1
               MOVE USP-COD-OFICINA TO FRM-MEN2
               MOVE SCR-STAT-CON    TO SCR-STAT.
       FIN-VAL-OFI-USP.
           EXIT.
      *DAD fin  02-ENE-1992
      *DAD ini  02-ENE-1992   (Memo.09-12-91)
            COPY USPC113.
      *DAD fin  02-ENE-1992
*% END
      *>>>>
*% END
