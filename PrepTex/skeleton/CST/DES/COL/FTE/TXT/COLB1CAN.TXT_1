           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-CAN
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
                   MOVE ZEROES TO VEN-NUM-IVEN IN CAN-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'CAN    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'CAN    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.

           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-RCV
               IF MSG-COD-MENS = 'RCVSI'
                   PERFORM SCR-CLRA-CAN
                   MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN CAN-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'DEU'          TO MSG-COD-SIST
                       MOVE 'RCVIVCTNOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU'          TO MSG-COD-SIST
                       MOVE 'RCVIVCTNONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
       CON-FND-KEY.
           PERFORM GET-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICIOPCNOOPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
 
      *ISP RESPALDA MONEDA DEL CREDITO
           MOVE OPC-COD-VCOC IN OPC TO SCR-COD-VCOC.
      *ISP EN INGRESO ASUME AL INICIO EJECUTIVO DE LA OPERACION
      *BUS-USR busca usuario en tablas
           IF SCR-CCPP = 'ING'
              IF OPC-COD-RMOC IN OPC > SPACES
                 MOVE OPC-COD-RMOC IN OPC TO CAN-COD-RCAN IN CAN-FLD
                 MOVE CAN-COD-RCAN IN CAN-FLD TO USR-COD-USER IN USR
                 PERFORM BUS-USR
                 MOVE USR-GLS-DESC IN USR TO FRM-GLS-RCAN IN CAN-FLD.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *LRH ini  11-ABR-1994    (Memo.02-03-94 Pto.1)
      *        MOVE '00'         TO FIO-STAT
               MOVE FIO-STAT-NEX TO FIO-STAT
      *LRH fin  11-ABR-1994
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.

           IF SCR-CMND = 'REV'
               PERFORM BUS-COR-CAN-REV
      *LRH ini  01-JUN-1994    (Memo.12-08-93 Pto.1)
               IF SCR-STAT = SCR-STAT-CON
                   GO TO FIN-FND-KEY
               ELSE
      *LRH fin  01-JUN-1994
                   MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD
      *DAD ini  04-DIC-1991   (Memo.07-10-91 pto.2.1)
                   IF CAN-MSC-CANC IN CAN = 'ATT'
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'REV    NOATT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       GO TO FIN-FND-KEY
                   ELSE
      *DAD fin  04-DIC-1991
                       GO TO CON-BUS-KEY-IVEN.
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-CAN
               MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD
               GO TO CON-BUS-KEY-IVEN.
           IF CAN-NUM-ICAN IN CAN-FLD NOT > ZEROES AND
              VEN-NUM-IVEN IN VEN         > ZEROES
               MOVE CAN-CAI-IOPC IN CAN-FLD TO RCV-CAI-IOPV IN RCV
               MOVE CAN-IIC-IOPC IN CAN-FLD TO RCV-IIC-IOPV IN RCV
               MOVE VEN-NUM-IVEN IN VEN     TO RCV-NUM-IVCT IN RCV
               MOVE 'RCV-KEY-IVCT' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-RCV
               IF FIO-STAT-OKS
                   MOVE RCV-NUM-ICAN IN RCV TO CAN-NUM-ICAN IN CAN-FLD
               ELSE
                   MOVE 'COL'       TO MSG-COD-SIST
                   MOVE 'CANNEXVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
           ELSE
           IF CAN-NUM-ICAN IN CAN-FLD NOT > ZEROES AND
              VEN-NUM-IVEN IN VEN     NOT > ZEROES
               PERFORM BUS-COR-CAN
               MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD.
       CON-BUS-KEY-IVEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV
               MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV
               MOVE SPACES              TO RCV-CIC-IOPV IN RCV
               MOVE ZEROES              TO RCV-NUM-IVCT IN RCV
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-RCV
               IF NOT (FIO-STAT-OKS AND
                  CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV AND
                  CAN-NUM-ICAN IN CAN = RCV-NUM-ICAN IN RCV )
                   MOVE '23' TO FIO-STAT
               ELSE
                   MOVE '00' TO FIO-STAT                       
                   IF RCV-NUM-IVCT IN RCV > ZEROES
                       MOVE RCV-NUM-IVCT IN RCV TO
                                       VEN-NUM-IVEN IN VEN
                       MOVE RCV-NUM-IVCT IN RCV TO 
                                   VEN-NUM-IVEN IN CAN-FLD
                       MOVE RCV-NUM-IVCT IN RCV TO 
                                   VEN-NUM-IVCT IN CAN-FLD.
           MOVE FIO-STAT TO PGM-STAT-RCV.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES
               IF OPC-IND-VSTR IN OPC = 'S' 
                   MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN
                   MOVE 1                   TO VEN-NUM-IVEN IN VEN
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF FIO-STAT-OKS
                       MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN
                       MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN 
                                                            IN CAN-FLD
                       MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVCT 
                                                            IN CAN-FLD
                   ELSE
                       MOVE 1 TO VEN-NUM-IVEN IN CAN-FLD
                       MOVE 1 TO VEN-NUM-IVCT IN CAN-FLD
               ELSE
                   MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
                   MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN CAN-FLD
                   MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVCT IN CAN-FLD
           ELSE
               IF OPC-IND-VSTR IN OPC = 'S' 
                   MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN
                   MOVE 1                   TO VEN-NUM-IVEN IN VEN
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   IF VEN-NUM-IVCT IN VEN > VEN-NUM-IVCT IN CAN-FLD
                      AND SCR-CCPP = 'ING'
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    YACAN' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       GO TO FIN-FND-KEY
                   ELSE 
                       MOVE VEN-NUM-IVEN IN CAN-FLD TO 
                                         VEN-NUM-IVEN IN VEN
                       MOVE VEN-NUM-IVCT IN CAN-FLD TO
                                         VEN-NUM-IVCT IN VEN
               ELSE
                   IF VEN-NUM-IVCT IN CAN-FLD < OPC-NUM-IVEN IN OPC
                      AND SCR-CCPP = 'ING'
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    YACAN' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       GO TO FIN-FND-KEY.
                      
       NOT-VUV.
           MOVE VEN-NUM-IVEN IN VEN TO SCR-VEN-NUM-IVEN.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           MOVE SCR-VEN-NUM-IVEN TO VEN-NUM-IVEN IN VEN.
           MOVE SCR-VEN-NUM-IVEN TO VEN-NUM-IVEN IN CAN-FLD.

           MOVE FIO-GET-KEY TO FIO-CMND.
      
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
      *        IF VEN-STAT-OKS OR VEN-STAT-ENO
               IF VEN-STAT-OKS 
                   MOVE VEN-NUM-IVEN IN VEN TO
                        VEN-NUM-IVCT IN VEN
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
           ELSE
               PERFORM COL-FIO-VEN.
      
           MOVE FIO-STAT TO PGM-STAT-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
      *DAD ini 23-MAY-1991 
               IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                   MOVE 'OPC    YACAN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
      *DAD fin 23-MAY-1991 
                   MOVE 'CICIOPCNOVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY.
       VEN-ESTR.
      *ALD/27-OCT-1988
      *     IF PGM-STAT-VEN-OKS
      *         IF VEN-VAL-SFIN IN VEN NOT > ZEROES AND
      *            SCR-CCPP = 'ING'
      *            MOVE 'COL'          TO MSG-COD-SIST
      *            MOVE 'VEN    YACAN' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            MOVE FIO-STAT-NEX TO FIO-STAT
      *            GO TO FIN-FND-KEY.
           MOVE 'OPEC' TO MSC-CIC-TMSC IN MSC.
           MOVE 'D'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'COL'  TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
      *JSS 5-APR-1991 20:25:52
      *    IF TOC-MSC-OPEC IN TOC = MSC-COD-CMSC IN MSC
      *        GO TO FIN-VRF-RCV.
           IF SCR-CCPP NOT = 'ING'
                GO TO FIN-VRF-RCV.

           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           MOVE ZEROES              TO RCV-NUM-IVCT IN RCV.
           MOVE SPACES TO WSS-RCV-CIC-IOPC.
           MOVE 0      TO WSS-RCV-NUM-ICAN.
           MOVE 'P'    TO WSS-COD-IPAR.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUR-FND-KEY.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           PERFORM COL-FIO-RCV.
           IF NOT ( FIO-STAT-OKS AND
                    RCV-CIC-IOPV IN RCV = CAN-CIC-IOPC IN CAN AND
                    RCV-NUM-IVCT IN RCV = 0 )
               GO TO SK1-FND-KEY.
           IF RCV-NUM-ICAN IN RCV > WSS-RCV-NUM-ICAN
               MOVE RCV-KEY-IRCV IN RCV TO WSS-RCV-KEY-IRCV.
           IF WSS-COD-IPAR = 'P'
               MOVE 'I' TO WSS-COD-IPAR
           ELSE
               MOVE 'P' TO WSS-COD-IPAR.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUR-FND-KEY.
       SK1-FND-KEY.
           IF WSS-RCV-CIC-IOPC > SPACES
               MOVE WSS-RCV-KEY-IRCV TO RCV-KEY-IRCV IN RCV
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-RCV
           ELSE
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               GO TO SK2-FND-KEY.
           MOVE RCV-KEY-ICAN IN RCV TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
      *Si existe numero par de RCV asume que existe reversa ( para manejar
      *registros antiguos que no tiene signo negativo )
               IF ( RCV-SGV-FINA IN RCV < ZEROES   OR
                    RCV-SGV-CAPI IN RCV < ZEROES ) OR
                    WSS-COD-IPAR = 'P'
                     NEXT SENTENCE
               ELSE
                   MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVCT IN CAN-FLD
                   IF CAN-MSC-STAT IN CAN = 'A'
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OPC    YACAN' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'CANTOTAYAEXI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC        TO FRM-MEN1
                       MOVE CAN-MSC-STAT IN CAN TO FRM-MEN2
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       GO TO FIN-FND-KEY
           ELSE
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RCVIVCTNOCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE RCV-KEY-IRCV IN RCV TO FRM-MEN2
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
       SK2-FND-KEY.
      *JSS 26-MAY-1992
           IF VEN-NUM-IVEN IN VEN NOT = OPC-NUM-IVEN IN OPC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'NUMIVCTSEQ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
      *
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
      *           MOVE 999 TO RCV-NUM-IVCT IN RCV.
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = RCV-CIC-IOPV IN RCV )
                     IF OPC-IND-VSTR IN OPC NOT = 'S'
                         IF VEN-NUM-IVEN IN VEN > OPC-NUM-IVEN IN OPC
                             MOVE 'COL' TO MSG-COD-SIST
                             MOVE 'NUMIVCTSEQ1' TO MSG-COD-MENS
                             PERFORM GET-MSG
                             MOVE MSG-GLS-DESC TO FRM-MENS
                             MOVE FIO-STAT-NEX TO FIO-STAT
                             GO TO FIN-FND-KEY
                         ELSE
                             NEXT SENTENCE
                     ELSE
                         IF VEN-NUM-IVEN IN VEN > 1
                             MOVE 'COL' TO MSG-COD-SIST
                             MOVE 'NUMIVCTSEQ1' TO MSG-COD-MENS
                             PERFORM GET-MSG
                             MOVE MSG-GLS-DESC TO FRM-MENS
                             MOVE FIO-STAT-NEX TO FIO-STAT
                             GO TO FIN-FND-KEY
                         ELSE
                             NEXT SENTENCE
           ELSE
                ADD 1 RCV-NUM-IVCT IN RCV GIVING WSS-NUM-IVCT
                IF VEN-NUM-IVEN IN VEN > WSS-NUM-IVCT
      *DAD ini  20-NOV-1991   (Memo.15-11-91 pto.1)
                   AND WSS-NUM-IVCT IN WSS-VARI > 1
      *DAD fin  20-NOV-1991
                    MOVE 'COL' TO MSG-COD-SIST
                    MOVE 'NUMIVCTSEQ' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FIO-STAT-NEX TO FIO-STAT
                    GO TO FIN-FND-KEY
                ELSE
                    PERFORM ULT-RCV-IVCT
                    MOVE RCV-NUM-ICAN IN RCV TO CAN-NUM-ICAN IN CAN
                    MOVE FIO-GET-KEY TO FIO-CMND
                    PERFORM COL-FIO-CAN
                    IF FIO-STAT-OKS
      *JSS
      *LA PRIMERA PREGUNTA ES POR SI ESTA COLOCANDO EL MISMO NUMERO
      *                  IF ( NOT ( CAN-MSC-STAT IN CAN = 'A' OR
      *                             'R' OR 'X' ) )
      *                     AND VEN-NUM-IVEN IN VEN = RCV-NUM-IVCT IN RCV
                        IF ( NOT ( CAN-MSC-STAT IN CAN = 'A' OR
                                   'R' OR 'X' ) )
                            MOVE VEN-NUM-IVEN IN VEN TO
                                 VEN-NUM-IVCT IN CAN-FLD
                            MOVE 'COL' TO MSG-COD-SIST
                            MOVE 'RCVIVCTIVEN' TO MSG-COD-MENS
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            MOVE FIO-STAT-NEX TO FIO-STAT
                            GO TO FIN-FND-KEY
                        ELSE
      *
                        IF NOT ( CAN-MSC-STAT IN CAN =
                        'A' OR 'S' OR 'C' OR 'W' OR 'R' OR
                        'G' OR 'P' OR 'X' )
                            MOVE VEN-NUM-IVEN IN VEN TO
                                  VEN-NUM-IVCT IN CAN-FLD
                            MOVE 'COL' TO MSG-COD-SIST
                            MOVE 'RCVIVCTIVEN' TO MSG-COD-MENS
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            MOVE FIO-STAT-NEX TO FIO-STAT
                            GO TO FIN-FND-KEY
                        ELSE
                            IF VEN-NUM-IVEN IN VEN NOT = RCV-NUM-IVCT
                               IN RCV AND CAN-MSC-FCAN IN CAN NOT = 'T'
                                MOVE VEN-NUM-IVEN IN VEN TO
                                     VEN-NUM-IVCT IN CAN-FLD
                                MOVE 'COL' TO MSG-COD-SIST
                                MOVE 'RCVIVCTIVEN' TO MSG-COD-MENS
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                MOVE FIO-STAT-NEX TO FIO-STAT
                                GO TO FIN-FND-KEY
                            ELSE
                                NEXT SENTENCE
                    ELSE
                        MOVE 'COL' TO MSG-COD-SIST
                        MOVE 'RCVIVCTNOCAN' TO MSG-COD-MENS
                        PERFORM GET-MSG
                        MOVE MSG-GLS-DESC TO FRM-MENS
                        MOVE FIO-STAT-NEX TO FIO-STAT
                        GO TO FIN-FND-KEY.

           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
       FIN-VRF-RCV.
           PERFORM GET-CUR-ITR.
           IF PGM-STAT-ITR-OKS
               PERFORM GET-NXT-ITR
           ELSE
               MOVE ZEROES TO ITR-SGV-SPRD IN ITR
               MOVE ZEROES TO ITR-SGV-TINT IN ITR 
               MOVE SPACES TO ITR-COD-TINT IN ITR
               MOVE SPACES TO ITR-COD-CVTI IN ITR.

           IF ITR-COD-CVTI IN ITR > SPACES
               MOVE ITR-SGV-SPRD IN ITR TO FRM-SGV-TINT IN CAN-FLD
               IF ITR-MSC-TFPR = 'C' AND ITR-SGV-TINT IN ITR > 0
                   MOVE ITR-SGV-TINT IN ITR TO SCR-SGV-SPR2
               ELSE
                   MOVE 0                   TO SCR-SGV-SPR2
           ELSE
               MOVE ITR-SGV-TINT IN ITR TO FRM-SGV-TINT IN CAN-FLD.
           IF ITR-COD-TINT IN ITR > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'INT' TO TAB-COD-TTAB IN TAB
               MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IITR IN CAN-FLD.
           PERFORM GET-CUR-ICG.
           IF PGM-STAT-ICG-OKS
               MOVE ICG-COD-TINT IN ICG TO SCR-COD-TICG
               PERFORM PUT-ICG-CAN
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'INT' TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN ICG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD
           ELSE
      *ISP SI TASA DEL CREDITO MULTIPLE O VARIABLE ==>
      *                              BUSCA TASA CON CIC = 'CAN'
      *    SINO
      *                              ASUME TASA Y VALOR DE CREDITO
           IF WSS-IND-MITR = 'M' OR
              ITR-COD-CVTI > SPACES

                 MOVE 'COL' TO TAB-COD-SIST
                 MOVE 'INT' TO TAB-CIC-TTAB IN TAB
                 MOVE 'CAN' TO TAB-CIC-CTAB IN TAB
                 MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD
                 MOVE TAB-COD-CTAB IN TAB TO SCR-COD-TICG
           ELSE
                 MOVE 'COL' TO TAB-COD-SIST
                 MOVE 'INT' TO TAB-COD-TTAB IN TAB
                 MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
                 MOVE ITR-COD-TINT IN ITR TO SCR-COD-TICG
                 PERFORM BUS-TAB
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.

           MOVE CAN-CAI-IOPC IN CAN TO RDC-CAI-IOPC IN RDC.
           MOVE CAN-IIC-IOPC IN CAN TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *LRH ini  04-ABR-1994   (Compatibilidad VSAM)
      *    MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
                   RDC-CAI-IOPC IN RDC = CAN-CAI-IOPC IN CAN AND
                   RDC-IIC-IOPC IN RDC = CAN-IIC-IOPC IN CAN AND
                   RDC-NUM-IDLC IN RDC = ZEROES )
      *LRH fin  04-ABR-1994
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE
               GO TO CON-PGD.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE
               GO TO CON-PGD.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = CAN-CAI-IOPC IN CAN AND
              RDC-IIC-IOPC IN RDC = CAN-IIC-IOPC IN CAN AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDDIR' TO MSG-COD-MENS
               MOVE 'M'     TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE.
       CON-PGD.

           PERFORM FND-KEY-CYA.
       NXT-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FND-RST-STAT.
