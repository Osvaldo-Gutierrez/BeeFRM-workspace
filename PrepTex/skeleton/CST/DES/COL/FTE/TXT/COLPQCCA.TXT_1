*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% RA1 = "CYA"
*% FRM = "CCA"
*% NRA = 1
*% INCLUDE 'PFSALLF78'
*% IF WSS
      *<<<< WSS
       COPY COLBRCAN.
       COPY SGCBRDBC.
       COPY COLBRRDC.
       COPY COLBROPC.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       01  WSS-VARI.
           03 WSS-IMAX               VALUE 9          PIC 9(02).
           03  BUS-POR-KEYS          VALUE SPACES     PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'        PIC X(01).
           03  WSS-KEY-ICYA.
               05  WSS-CIC-IOPC                       PIC X(12).
               05  WSS-NUM-ICAN                       PIC X(03).
               05  WSS-NUM-ICAN-RED REDEFINES WSS-NUM-ICAN
                                                      PIC 9(03).
               05  WSS-NUM-ICYA                       PIC 9(01).
           03  WSS-COD-TVOC                           PIC X(01).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF CYA-CAI-IOPC IN CCA-FLD NOT > SPACES
               MOVE SPACES TO CYA-CAI-IOPC IN CCA-FLD.
           IF CYA-NUM-ICAN IN CCA-FLD NOT > SPACES
               MOVE ZEROES TO CYA-NUM-ICAN IN CCA-FLD.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV-IOPC
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-CCA
                   PERFORM PUT-CYA-CCA
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'CCA    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'CCA    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.

            IF DBC-NUM-ICLI IN CCA-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN CCA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CCA-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CCA-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE '00' TO PGM-STAT-DBC
                   MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC
           ELSE
           IF DBC-GLS-NOMC IN CCA-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

               MOVE DBC-GLS-NOMC IN CCA-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC
                   MOVE '00' TO PGM-STAT-DBC
           ELSE
               NEXT SENTENCE.


       SOLO-ICLI.
           IF NOT ( ( ( DBC-NUM-ICLI IN CCA-FLD NOT = ZEROES )  OR
                        DBC-GLS-NOMC IN CCA-FLD > SPACES ) 
                    AND
                    ( CYA-CAI-IOPC IN CCA-FLD NOT > SPACES AND
                      CYA-IIC-IOPC IN CCA-FLD NOT > ZEROES ) )
               GO TO ICLI-IOPC.

           MOVE FIO-GET-NLS TO FIO-CMND.
       LEE-RDC.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CAI-ICLI IN RDC = DBC-CAI-ICLI IN DBC AND
              RDC-IIC-ICLI IN RDC = DBC-IIC-ICLI IN DBC )
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CLI    NOCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.

           IF RDC-NUM-IDLC IN RDC NOT = ZEROES
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LEE-RDC.
           MOVE RDC-CAI-IOPC IN RDC     TO CYA-CAI-IOPC IN CYA.
           MOVE RDC-IIC-IOPC IN RDC     TO CYA-IIC-IOPC IN CYA.
           MOVE CYA-NUM-ICAN IN CCA-FLD TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES                  TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CAI-IOPC IN CYA = RDC-CAI-IOPC IN RDC     AND
                    CYA-IIC-IOPC IN CYA = RDC-IIC-IOPC IN RDC     AND
                    CYA-NUM-ICAN IN CYA = CYA-NUM-ICAN IN CCA-FLD )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LEE-RDC.
           MOVE RDC-CAI-IOPC IN RDC TO CYA-CAI-IOPC IN CCA-FLD.
           MOVE RDC-IIC-IOPC IN RDC TO CYA-IIC-IOPC IN CCA-FLD.
           PERFORM ANL-OPC-ICAN.
           IF NOT FIO-STAT-OKS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           PERFORM BUS-MUL-DEUD.
           GO TO CARGA-CYA.

       ICLI-IOPC.
           IF NOT ( ( ( DBC-NUM-ICLI IN CCA-FLD NOT = ZEROES ) OR
                        DBC-GLS-NOMC IN CCA-FLD > SPACES ) AND

                    ( CYA-CAI-IOPC IN CCA-FLD > SPACES OR
                      CYA-IIC-IOPC IN CCA-FLD > ZEROES ) )

               GO TO SOLO-IOPC.
           MOVE CYA-CAI-IOPC IN CCA-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE CYA-IIC-IOPC IN CCA-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CLIIOPCNORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE RDC-CAI-IOPC IN RDC     TO CYA-CAI-IOPC IN CYA.
           MOVE RDC-IIC-IOPC IN RDC     TO CYA-IIC-IOPC IN CYA.
           MOVE RDC-CAI-IOPC IN RDC TO CYA-CAI-IOPC IN CCA-FLD.
           MOVE RDC-IIC-IOPC IN RDC TO CYA-IIC-IOPC IN CCA-FLD.
           PERFORM ANL-OPC-ICAN.
           IF NOT FIO-STAT-OKS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           PERFORM BUS-MUL-DEUD.
           GO TO CARGA-CYA.

       SOLO-IOPC.
           MOVE CYA-CAI-IOPC IN CCA-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE CYA-IIC-IOPC IN CCA-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = CYA-CAI-IOPC IN CCA-FLD AND
              RDC-IIC-IOPC IN RDC = CYA-IIC-IOPC IN CCA-FLD AND
              RDC-NUM-IDLC IN RDC = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CYAIOPCNORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
       CON-FND-KEY.
           PERFORM ANL-OPC-ICAN.
           IF NOT FIO-STAT-OKS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           PERFORM BUS-MUL-DEUD.
       CARGA-CYA.
           MOVE ZEROES     TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS OR
              CYA-CAI-IOPC IN CCA-FLD NOT = CYA-CAI-IOPC IN CYA OR
              CYA-IIC-IOPC IN CCA-FLD NOT = CYA-IIC-IOPC IN CYA OR
              CYA-NUM-ICAN IN CCA-FLD NOT = CYA-NUM-ICAN IN CYA
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CYA    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-CYA.
           MOVE ADR-CYA-REQA TO SCR-CYA-REQA.

           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE MSC-COD-CMSC IN MSC TO WSS-COD-TVOC IN WSS-VARI.
           MOVE ZEROES TO FRM-IFLD.
       LUP-OPE-CCA.
           ADD 1 TO FRM-IFLD.
           PERFORM PUT-TAB-OPE-CCA.
           IF FRM-IFLD < WSS-IMAX
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-CYA
               IF FIO-STAT-OKS AND
                  CYA-CAI-IOPC IN CYA = CYA-CAI-IOPC IN CCA-FLD AND
                  CYA-IIC-IOPC IN CYA = CYA-IIC-IOPC IN CCA-FLD AND
                  CYA-NUM-ICAN IN CYA = CYA-NUM-ICAN IN CCA-FLD
                  GO TO LUP-OPE-CCA.
           MOVE '00' TO PGM-STAT-CYA.
           PERFORM KEY-CYA-CCA.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PUT-TAB-OPE-CCA SECTION.
       INI-PUT-TAB-OPE-CCA.
           MOVE CYA-NUM-ICYA IN CYA TO FRM-NUM-ICYA
                                   IN CCA-FLD(FRM-IFLD).

           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'  TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-TCYA
                                   IN CCA-FLD(FRM-IFLD)
           ELSE
                MOVE SPACES     TO FRM-GLS-TCYA
                                   IN CCA-FLD(FRM-IFLD).
           MOVE CYA-CAI-ICYA IN CYA TO FRM-CAI-ICYA
                                   IN CCA-FLD(FRM-IFLD).
           MOVE CYA-IIC-ICYA IN CYA TO FRM-IIC-ICYA
                                   IN CCA-FLD(FRM-IFLD).
           IF WSS-COD-TVOC IN WSS-VARI NOT = OPC-MSC-TVOC IN OPC
               MOVE CYA-SGV-LIQU IN CYA TO FRM-SGV-LIQU
                                   IN CCA-FLD(FRM-IFLD)
               MOVE ZEROES TO FRM-VAL-VPES IN CCA-FLD(FRM-IFLD)
           ELSE
               MOVE CYA-SGV-LIQU IN CYA TO FRM-VAL-VPES
                                   IN CCA-FLD(FRM-IFLD)
               MOVE ZEROES TO FRM-SGV-LIQU IN CCA-FLD(FRM-IFLD).
       FIN-PUT-TAB-OPE-CCA.        
           EXIT.

       ANL-OPC-ICAN SECTION.
       INI-ANL-OPC-ICAN.
           MOVE CYA-CAI-IOPC IN CYA TO OPC-CAI-IOPC IN OPC.
           MOVE CYA-IIC-IOPC IN CYA TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CICIOPCNOOPC' TO MSG-COD-MENS
               GO TO FIN-ANL-OPC-ICAN.
           IF CYA-NUM-ICAN IN CYA > ZEROES AND
              CYA-NUM-ICAN IN CYA NOT = 'AUT'
               MOVE CYA-CAI-IOPC IN CYA TO CAN-CAI-IOPC IN CAN
               MOVE CYA-IIC-IOPC IN CYA TO CAN-IIC-IOPC IN CAN
               MOVE CYA-NUM-ICAN IN CYA TO CAN-NUM-ICAN IN CAN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF NOT FIO-STAT-OKS
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'NUMICANNOCAN' TO MSG-COD-MENS.
       FIN-ANL-OPC-ICAN.
           EXIT.

       BUS-MUL-DEUD SECTION.
       INI-BUS-MUL-DEUD.
           MOVE CYA-CAI-IOPC IN CYA TO RDC-CAI-IOPC IN RDC.
           MOVE CYA-IIC-IOPC IN CYA TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *DSP COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
      *DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = CYA-CAI-IOPC IN CYA AND
              RDC-IIC-IOPC IN RDC = CYA-IIC-IOPC IN CYA AND
              RDC-NUM-IDLC IN RDC = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE
               GO TO FIN-BUS-MUL-DEUD.
           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   MOVE SPACES TO DBC-IND-ICLI IN DBC
                   PERFORM SET-MSG-CLTE
                   GO TO FIN-BUS-MUL-DEUD.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = CYA-CAI-IOPC IN CYA AND
              RDC-IIC-IOPC IN RDC = CYA-IIC-IOPC IN CYA AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDDIR' TO MSG-COD-MENS
               IF BUS-POR-KEYS = BUS-POR-CLTE
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE 'M'     TO DBC-IND-ICLI IN DBC
                   PERFORM SET-MSG-CLTE.
       FIN-BUS-MUL-DEUD.
           EXIT.
        
       SET-MSG-CLTE SECTION.
       INI-SET-MSG-CLTE.
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DBC.
       FIN-SET-MSG-CLTE.
           EXIT.

       LEE-NXT-PRV-IOPC SECTION.
       INI-LEE-NXT-PRV-IOPC.
           IF SCR-CYA-REQA > SPACES
               PERFORM LEE-NXT-PRV-CYA
           ELSE
               PERFORM LEE-NXT-PRV-CIC.
       FIN-LEE-NXT-PRV-IOPC.
           EXIT.

       LEE-NXT-PRV-CYA SECTION.
       INI-LEE-NXT-PRV-CYA.
           MOVE SCR-CYA-REQA TO ADR-CYA-REQA.
           MOVE ADR-VKEY IN ADR-CYA-REQA TO WSS-KEY-ICYA IN
                                                       WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
       NXT-CYA.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS 
               IF CYA-NUM-ICAN IN CYA = WSS-NUM-ICAN IN WSS-VARI AND
                  CYA-CIC-IOPC IN CYA = WSS-CIC-IOPC IN WSS-VARI
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO NXT-CYA
                    ELSE
                        MOVE FIO-GET-NXT TO FIO-CMND
                        GO TO NXT-CYA
               ELSE
                  MOVE ADR-CYA-REQA TO SCR-CYA-REQA
                  MOVE '00' TO PGM-STAT-CYA.
       FIN-LEE-NXT-PRV-CYA.
           EXIT.

       LEE-NXT-PRV-CIC SECTION.
       INI-LEE-NXT-PRV-CIC.
           IF CYA-IIC-IOPC IN CYA > ZEROES
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-CYA
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS 
               MOVE ADR-CYA-REQA TO SCR-CYA-REQA
               MOVE '00' TO PGM-STAT-CYA.
       FIN-LEE-NXT-PRV-CIC.
           EXIT.

       COPY COLBFCAN.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY TABBVOFI.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
      * COPY GNSBEGLS.
      *>>>>
*% END
