*%! Codigo adicional para archivo
*% NO_HDR_CST = TRUE
*% IF WSS
      *<<<< WSS
       COPY COLWGPTI.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       01  WSS-VARI.
           03  WSS-I                                    PIC 9(01).
           03  WSS-J                                    PIC 9(01).
           03  WSS-IMAX               VALUE 6           PIC 9(01).
           03  WSS-IOFL               VALUE 7           PIC 9(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                         PIC X(03).
               05  WSS-COD-AOOC                         PIC X(03).
           03  WSS-COD-VCAM.
               05  WSS-COD-TVTI                         PIC X(01).
               05  WSS-COD-CVTI                         PIC X(03).
               05  WSS-COD-TCTI                         PIC X(02).
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND = 'CON'
               PERFORM ANL-BUS-PTI
               MOVE PTI-STAT TO PGM-STAT-PTI
           ELSE
               PERFORM ANL-KEY-PTI.
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           MOVE PTI-COD-VCOC IN PTI-FLD TO POC-COD-VCOC IN POC.
           MOVE PTI-COD-TOOC IN PTI-FLD TO POC-COD-TOOC IN POC.
           MOVE PTI-COD-AOOC IN PTI-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           MOVE FIO-STAT TO PGM-STAT-POC.
           IF FIO-STAT-OKS
               PERFORM PUT-POC-PTI.
           MOVE PGM-STAT-PTI TO FIO-STAT.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE FRM-CPIM-AEY TO PTI-FEC-FTRN-ATR IN PTI-FLD
               MOVE FRM-CPIM-AEY TO PTI-HRA-HRTR-ATR IN PTI-FLD.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'OFC' OR 'DFC'
               MOVE FRM-CPIM-AEY TO PTI-FEC-FTRN-ATR IN PTI-FLD
               MOVE FRM-CPIM-AEY TO PTI-HRA-HRTR-ATR IN PTI-FLD.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'OFC'
               PERFORM PRO-FLD-PTI
               MOVE FRM-CPIM-UBY TO PTI-COD-OFCB-ATR IN PTI-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO PTI-COD-OFCB-ATR IN PTI-FLD.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY COLBFPOC.

       ANL-BUS-PTI SECTION.
       INI-ANL-BUS-PTI.
           MOVE SPACES                  TO PTI-COD-MENS IN PTI-VARI.
           MOVE PTI-COD-OFOC IN PTI-FLD TO PTI-COD-OFOC IN PTI-VARI.
           MOVE PTI-COD-VCOC IN PTI-FLD TO PTI-COD-VCOC IN PTI-VARI.
           MOVE PTI-COD-TOOC IN PTI-FLD TO PTI-COD-TOOC IN PTI-VARI.
           MOVE PTI-COD-AOOC IN PTI-FLD TO PTI-COD-AOOC IN PTI-VARI.
           MOVE PTI-NUM-DTRN IN PTI-FLD TO PTI-NUM-DTRN IN PTI-VARI.
           MOVE PTI-NUM-MTRN IN PTI-FLD TO PTI-NUM-MTRN IN PTI-VARI.
           MOVE PTI-NUM-STRN IN PTI-FLD TO PTI-NUM-STRN IN PTI-VARI.
           MOVE PTI-NUM-ATRN IN PTI-FLD TO PTI-NUM-ATRN IN PTI-VARI.
           IF PTI-HRA-HRTR IN PTI-FLD > ZEROES
               MOVE PTI-HRA-HRTR IN PTI-FLD TO PTI-HRA-HRTR IN PTI-VARI
           ELSE
               PERFORM GET-FHOY
               IF PTI-FEC-FTRN IN PTI-VARI = HOY-FHOY IN HOY-VARI
                  MOVE HOY-HHHY IN HOY-VARI TO PTI-NUM-HHTR IN PTI-VARI
                  MOVE HOY-MMHY IN HOY-VARI TO PTI-NUM-MMTR IN PTI-VARI
               ELSE
                  MOVE '2400'               TO PTI-HRA-HRTR IN PTI-VARI.
      *BUSCAR CON OFICINA Y AUXILIAR
           PERFORM PRO-ARC-PTI.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PTI.
           MOVE PTI-COD-OFOC IN PTI-VARI TO PTI-COD-OFIX IN PTI-VARI.
      *BUSCAR CON OFICINA=* Y AUXILIAR
           MOVE '*  '                    TO PTI-COD-OFOC IN PTI-VARI.
           PERFORM PRO-ARC-PTI.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PTI.
      *BUSCAR CON OFICINA Y AUXILIAR=*
           MOVE PTI-COD-OFIX IN PTI-VARI TO PTI-COD-OFOC IN PTI-VARI.
           MOVE '*  '                    TO PTI-COD-AOOC IN PTI-VARI.
           PERFORM PRO-ARC-PTI.
           IF FIO-STAT-OKS
               GO TO FIN-ANL-BUS-PTI.
      *BUSCAR CON OFICINA=* Y AUXILIAR=*
           MOVE '*  '               TO PTI-COD-OFOC IN PTI-VARI.
           MOVE '*  '               TO PTI-COD-AOOC IN PTI-VARI.
           PERFORM PRO-ARC-PTI.
           IF NOT FIO-STAT-OKS
               MOVE 'PTI    NEX' TO PTI-COD-MENS IN PTI-VARI.
       FIN-ANL-BUS-PTI.
           EXIT.

       PRO-ARC-PTI SECTION.
       INI-PRO-ARC-PTI.
           MOVE PTI-COD-OFOC IN PTI-VARI TO PTI-COD-OFOC IN PTI.
           MOVE PTI-COD-VCOC IN PTI-VARI TO PTI-COD-VCOC IN PTI.
           MOVE PTI-COD-TOOC IN PTI-VARI TO PTI-COD-TOOC IN PTI.
           MOVE PTI-COD-AOOC IN PTI-VARI TO PTI-COD-AOOC IN PTI.
           MOVE PTI-NUM-DTRN IN PTI-VARI TO PTI-NUM-DTRN IN PTI.
           MOVE PTI-NUM-MTRN IN PTI-VARI TO PTI-NUM-MTRN IN PTI.
           MOVE PTI-NUM-STRN IN PTI-VARI TO PTI-NUM-STRN IN PTI.
           MOVE PTI-NUM-ATRN IN PTI-VARI TO PTI-NUM-ATRN IN PTI.
           MOVE PTI-HRA-HRTR IN PTI-VARI TO PTI-HRA-HRTR IN PTI.
      *
           MOVE 9999 TO PTI-NUM-IPTI IN PTI.
       LUP-PRO-ARC-PTI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-PTI
           IF FIO-STAT-OKS AND
              PTI-COD-OFOC IN PTI-VARI = PTI-COD-OFOC IN PTI AND
              PTI-COD-VCOC IN PTI-VARI = PTI-COD-VCOC IN PTI AND
              PTI-COD-TOOC IN PTI-VARI = PTI-COD-TOOC IN PTI AND
              PTI-COD-AOOC IN PTI-VARI = PTI-COD-AOOC IN PTI
               IF PTI-MSC-STAT IN PTI NOT = 'S'
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PTI
                   MOVE 0 TO PTI-NUM-IPTI IN PTI
                   GO TO LUP-PRO-ARC-PTI
               ELSE
               MOVE 0 TO PTI-NUM-IPTI IN PTI
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PTI
               MOVE FIO-STAT TO PTI-STAT
               PERFORM LLE-TAB-PTI
           ELSE
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM COL-FIO-PTI
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PTI-STAT
                   GO TO SETEA-PTI-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PTI-STAT
                   GO TO SETEA-PTI-STAT.
       SETEA-PTI-STAT.
           MOVE PTI-STAT TO FIO-STAT.
       FIN-PRO-ARC-PTI.
           EXIT.

       ANL-KEY-PTI SECTION.
       INI-ANL-KEY-PTI.
      *    HORA DE INGRESO COMPLETA
           IF PTI-HRA-HRTR IN PTI-FLD > ZEROES
               MOVE 0 TO PTI-NUM-IPTI IN PTI
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PTI
               IF FIO-STAT-OKS AND
                  PTI-COD-OFOC IN PTI-FLD = PTI-COD-OFOC IN PTI AND
                  PTI-COD-VCOC IN PTI-FLD = PTI-COD-VCOC IN PTI AND
                  PTI-COD-TOOC IN PTI-FLD = PTI-COD-TOOC IN PTI AND
                  PTI-COD-AOOC IN PTI-FLD = PTI-COD-AOOC IN PTI AND
                  PTI-NUM-STRN IN PTI-FLD = PTI-NUM-STRN IN PTI AND
                  PTI-NUM-ATRN IN PTI-FLD = PTI-NUM-ATRN IN PTI AND
                  PTI-NUM-MTRN IN PTI-FLD = PTI-NUM-MTRN IN PTI AND
                  PTI-NUM-DTRN IN PTI-FLD = PTI-NUM-DTRN IN PTI AND
                  PTI-NUM-IPTI IN PTI     = 1
                   MOVE FIO-STAT TO PGM-STAT-PTI
                   PERFORM LLE-TAB-PTI
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PGM-STAT-PTI
                   GO TO SET-PTI-STAT
           ELSE
      *        OBTENER PRIMER REGISTRO DE ESA FECHA
               MOVE ZEROES TO PTI-HRA-HRTR IN PTI
               MOVE ZEROES TO PTI-NUM-IPTI IN PTI
               IF SCR-CMND = 'OFC' OR 'DFC'
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-PTI
                   MOVE FIO-STAT TO PGM-STAT-PTI
                   GO TO SET-PTI-STAT
               ELSE
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-PTI
               IF FIO-STAT-OKS AND
                  PTI-COD-OFOC IN PTI-FLD = PTI-COD-OFOC IN PTI AND
                  PTI-COD-VCOC IN PTI-FLD = PTI-COD-VCOC IN PTI AND
                  PTI-COD-TOOC IN PTI-FLD = PTI-COD-TOOC IN PTI AND
                  PTI-COD-AOOC IN PTI-FLD = PTI-COD-AOOC IN PTI AND
                  PTI-NUM-STRN IN PTI-FLD = PTI-NUM-STRN IN PTI AND
                  PTI-NUM-ATRN IN PTI-FLD = PTI-NUM-ATRN IN PTI AND
                  PTI-NUM-MTRN IN PTI-FLD = PTI-NUM-MTRN IN PTI AND
                  PTI-NUM-DTRN IN PTI-FLD = PTI-NUM-DTRN IN PTI
                   MOVE FIO-STAT TO PGM-STAT-PTI
                   PERFORM LLE-TAB-PTI
               ELSE
                   MOVE '23' TO FIO-STAT
                   MOVE FIO-STAT TO PGM-STAT-PTI.
       SET-PTI-STAT.
           MOVE PGM-STAT-PTI TO FIO-STAT.
       FIN-ANL-KEY-PTI.
           EXIT.
       LLE-TAB-PTI SECTION.
       INI-LLE-TAB-PTI.
      *
      * MUEVE MONTOS DE PRIMERA PTI (CORRELATIVO 1)
      *
           MOVE PTI-SGV-MTO1 IN PTI TO FRM-SGV-MTO1 IN PTI-FLD.
           MOVE PTI-SGV-MTO2 IN PTI TO FRM-SGV-MTO2 IN PTI-FLD.
           MOVE PTI-SGV-MTO3 IN PTI TO FRM-SGV-MTO3 IN PTI-FLD.
           MOVE PTI-SGV-MTO4 IN PTI TO FRM-SGV-MTO4 IN PTI-FLD.
           PERFORM LEE-TAB-PTI VARYING WSS-I FROM 1 BY 1
                   UNTIL (NOT FIO-STAT-OKS) OR WSS-I > WSS-IMAX.
       FIN-LLE-TAB-PTI.
           EXIT.
       LEE-TAB-PTI SECTION.
       INI-LEE-TAB-PTI.
      *
      * MUEVE VALORES A TABLA EN PANTALLA DESPUES DE LEER PTI(N)
      *
           MOVE PTI-NUM-NDIA IN PTI TO FRM-NUM-NDIA IN PTI-FLD(WSS-I).
           MOVE PTI-SGV-INT1 IN PTI TO FRM-SGV-INT1 IN PTI-FLD(WSS-I).
           MOVE PTI-SGV-INT2 IN PTI TO FRM-SGV-INT2 IN PTI-FLD(WSS-I).
           MOVE PTI-SGV-INT3 IN PTI TO FRM-SGV-INT3 IN PTI-FLD(WSS-I).
           MOVE PTI-SGV-INT4 IN PTI TO FRM-SGV-INT4 IN PTI-FLD(WSS-I).
           MOVE PTI-SGV-INTM IN PTI TO FRM-SGV-INTM IN PTI-FLD(WSS-I).
           MOVE PTI-NUM-DTRN IN PTI TO PTI-NUM-DTRN IN PTI-FLD.
           MOVE PTI-NUM-MTRN IN PTI TO PTI-NUM-MTRN IN PTI-FLD.
           MOVE PTI-NUM-STRN IN PTI TO PTI-NUM-STRN IN PTI-FLD.
           MOVE PTI-NUM-ATRN IN PTI TO PTI-NUM-ATRN IN PTI-FLD.
           MOVE PTI-HRA-HRTR IN PTI TO PTI-HRA-HRTR IN PTI-FLD.
           MOVE PTI-COD-OFOC IN PTI TO PTI-COD-OFOC IN PTI-FLD.
           MOVE PTI-COD-AOOC IN PTI TO PTI-COD-AOOC IN PTI-FLD.
           MOVE PTI-MSC-STAT IN PTI TO PTI-MSC-STAT IN PTI-FLD.
           MOVE PTI-COD-OFCB IN PTI TO PTI-COD-OFCB IN PTI-FLD.
      *HPM ini 3-MAY-1994
           MOVE PTI-NUM-DACT IN PTI TO PTI-NUM-DACT IN PTI-FLD.
           MOVE PTI-NUM-MACT IN PTI TO PTI-NUM-MACT IN PTI-FLD.
           MOVE PTI-NUM-SACT IN PTI TO PTI-NUM-SACT IN PTI-FLD.
           MOVE PTI-NUM-AACT IN PTI TO PTI-NUM-AACT IN PTI-FLD.
      *HPM fin 3-MAY-1994
           MOVE PTI-COD-ATRN IN PTI TO PTI-COD-ATRN IN PTI-FLD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-PTI.
           IF NOT FIO-STAT-OKS
               MOVE PTI-COD-OFOC IN PTI-FLD TO PTI-COD-OFOC IN PTI
               MOVE PTI-COD-VCOC IN PTI-FLD TO PTI-COD-VCOC IN PTI
               MOVE PTI-COD-TOOC IN PTI-FLD TO PTI-COD-TOOC IN PTI
               MOVE PTI-COD-AOOC IN PTI-FLD TO PTI-COD-AOOC IN PTI
               MOVE PTI-NUM-DTRN IN PTI-FLD TO PTI-NUM-DTRN IN PTI
               MOVE PTI-NUM-MTRN IN PTI-FLD TO PTI-NUM-MTRN IN PTI
               MOVE PTI-NUM-STRN IN PTI-FLD TO PTI-NUM-STRN IN PTI
               MOVE PTI-NUM-ATRN IN PTI-FLD TO PTI-NUM-ATRN IN PTI
               MOVE PTI-HRA-HRTR IN PTI-FLD TO PTI-HRA-HRTR IN PTI
               MOVE PTI-MSC-STAT IN PTI-FLD TO PTI-MSC-STAT IN PTI
               MOVE PTI-COD-OFCB IN PTI-FLD TO PTI-COD-OFCB IN PTI
      *HPM ini 3-MAY-1994
               MOVE PTI-NUM-DACT IN PTI-FLD TO PTI-NUM-DACT IN PTI
               MOVE PTI-NUM-MACT IN PTI-FLD TO PTI-NUM-MACT IN PTI
               MOVE PTI-NUM-SACT IN PTI-FLD TO PTI-NUM-SACT IN PTI
               MOVE PTI-NUM-AACT IN PTI-FLD TO PTI-NUM-AACT IN PTI
      *HPM fin 3-MAY-1994
               MOVE PTI-COD-ATRN IN PTI-FLD TO PTI-COD-ATRN IN PTI
           ELSE
           IF NOT (PTI-COD-OFOC IN PTI-FLD = PTI-COD-OFOC IN PTI AND
                   PTI-COD-VCOC IN PTI-FLD = PTI-COD-VCOC IN PTI AND
                   PTI-COD-TOOC IN PTI-FLD = PTI-COD-TOOC IN PTI AND
                   PTI-COD-AOOC IN PTI-FLD = PTI-COD-AOOC IN PTI AND
                   PTI-NUM-STRN IN PTI-FLD = PTI-NUM-STRN IN PTI AND
                   PTI-NUM-ATRN IN PTI-FLD = PTI-NUM-ATRN IN PTI AND
                   PTI-NUM-MTRN IN PTI-FLD = PTI-NUM-MTRN IN PTI AND
                   PTI-NUM-DTRN IN PTI-FLD = PTI-NUM-DTRN IN PTI AND
                   PTI-HRA-HRTR IN PTI-FLD = PTI-HRA-HRTR IN PTI)
               MOVE PTI-COD-OFOC IN PTI-FLD TO PTI-COD-OFOC IN PTI
               MOVE PTI-COD-VCOC IN PTI-FLD TO PTI-COD-VCOC IN PTI
               MOVE PTI-COD-TOOC IN PTI-FLD TO PTI-COD-TOOC IN PTI
               MOVE PTI-COD-AOOC IN PTI-FLD TO PTI-COD-AOOC IN PTI
               MOVE PTI-NUM-DTRN IN PTI-FLD TO PTI-NUM-DTRN IN PTI
               MOVE PTI-NUM-MTRN IN PTI-FLD TO PTI-NUM-MTRN IN PTI
               MOVE PTI-NUM-STRN IN PTI-FLD TO PTI-NUM-STRN IN PTI
               MOVE PTI-NUM-ATRN IN PTI-FLD TO PTI-NUM-ATRN IN PTI
               MOVE PTI-HRA-HRTR IN PTI-FLD TO PTI-HRA-HRTR IN PTI
               MOVE PTI-MSC-STAT IN PTI-FLD TO PTI-MSC-STAT IN PTI
               MOVE PTI-COD-OFCB IN PTI-FLD TO PTI-COD-OFCB IN PTI
      *HPM ini 3-MAY-1994
               MOVE PTI-NUM-DACT IN PTI-FLD TO PTI-NUM-DACT IN PTI
               MOVE PTI-NUM-MACT IN PTI-FLD TO PTI-NUM-MACT IN PTI
               MOVE PTI-NUM-SACT IN PTI-FLD TO PTI-NUM-SACT IN PTI
               MOVE PTI-NUM-AACT IN PTI-FLD TO PTI-NUM-AACT IN PTI
      *HPM fin 3-MAY-1994
               MOVE PTI-COD-ATRN IN PTI-FLD TO PTI-COD-ATRN IN PTI
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-PTI
               MOVE '23' TO FIO-STAT.
       FIN-LEE-TAB-PTI.
           EXIT.
       CLR-TAB-PTI SECTION.
       INI-CLR-TAB-PTI.
      *
      * LIMPIA VALORES DE TABLA EN PANTALLA
      *
           MOVE ZEROES              TO FRM-NUM-NDIA IN PTI-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT1 IN PTI-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT2 IN PTI-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT3 IN PTI-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INT4 IN PTI-FLD(WSS-I).
           MOVE ZEROES              TO FRM-SGV-INTM IN PTI-FLD(WSS-I).
      *
       FIN-CLR-TAB-PTI.
           EXIT.
       PRO-FLD-PTI SECTION.
       INI-PRO-FLD-PTI.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO1-ATR IN PTI-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO2-ATR IN PTI-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO3-ATR IN PTI-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-MTO4-ATR IN PTI-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-NUM-NDIA-ATR IN PTI-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT1-ATR IN PTI-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT2-ATR IN PTI-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT3-ATR IN PTI-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INT4-ATR IN PTI-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-SGV-INTM-ATR IN PTI-FLD(6).
           PERFORM PRO-PTI-PTI.
           PERFORM PRO-POC-PTI.
       FIN-PRO-FLD-PTI.
           EXIT.
       PRO-PTI-PTI SECTION.
       INI-PRO-PTI-PTI.
           MOVE FRM-CPIM-AEY TO PTI-COD-OFCB-ATR IN PTI-FLD.
      *HPM ini 3-MAY-1994
      *    MOVE FRM-CPIM-AEY TO PTI-FEC-FACT-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY TO PTI-COD-ATRN-ATR IN PTI-FLD.
      *HPM fin 3-MAY-1994
           MOVE FRM-CPIM-AEY TO PTI-MSC-STAT-ATR IN PTI-FLD.
       FIN-PRO-PTI-PTI.
           EXIT.

       PRO-POC-PTI SECTION.
       INI-PRO-POC-PTI.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-BCTI-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-PBTI-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-BPBT-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-COD-CVTI-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-TFPR-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-NUM-PREP-ATR IN PTI-FLD.
      *    MOVE FRM-CPIM-AEY        TO POC-MSC-UTPR-ATR IN PTI-FLD.
       FIN-PRO-POC-PTI.
           EXIT.
      *>>>>
*% END
*%! Codigo adicional para archivo
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM KEY-ALL-PTI.
           PERFORM MOD-REG-PTI VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           PERFORM RET-ALL-PTI.
           PERFORM RET-HDR-PTI.
           PERFORM PUT-REG-PTI VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-PTI.
           PERFORM DEL-REG-PTI VARYING WSS-I FROM 1 BY 1
                   UNTIL WSS-I > WSS-IMAX.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY COLBFPOC.

       DEL-REG-PTI SECTION.
       INI-DEL-REG-PTI.
           IF SCR-CMND = 'DFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PTI-NUM-IPTI IN PTI
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-PTI
               IF NOT FIO-STAT-OKS
                   GO TO FIN-DEL-REG-PTI
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-PTI
                   GO TO FIN-DEL-REG-PTI.
           MOVE WSS-I IN WSS-VARI TO PTI-NUM-IPTI IN PTI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-PTI.
           IF NOT FIO-STAT-OKS
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               GO TO FIN-DEL-REG-PTI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-PTI.
       FIN-DEL-REG-PTI.
           EXIT.

       RET-HDR-PTI SECTION.
       INI-RET-HDR-PTI.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
      *    MOVE HOY-FHOY TO PTI-FEC-FTRN IN PTI.
      *    Hora Transaccion
      *    MOVE HOY-HHOY TO PTI-HRA-HRTR IN PTI.
      *    Codigo Origen transaccion
      *
           MOVE SCR-OTRN TO PTI-COD-OTRN IN PTI.
      *    Autor Transaccion
           MOVE SCR-USER TO PTI-COD-ATRN IN PTI.
      *
           IF SCR-CCPP = 'ING'
      *        MOVE 'I' TO PTI-MSC-STAT IN PTI
               MOVE 'I' TO PTI-MSC-TACC IN PTI
           ELSE
           IF SCR-CCPP = 'MOD'
      *        MOVE 'M' TO PTI-MSC-STAT IN PTI
               MOVE 'M' TO PTI-MSC-TACC IN PTI.
       FIN-RET-HDR-PTI.
           EXIT.

       PUT-REG-PTI SECTION.
       INI-PUT-REG-PTI.
           IF SCR-CMND = 'OFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PTI-NUM-IPTI IN PTI
               MOVE ZEROES TO PTI-SGV-MTO1 IN PTI
               MOVE ZEROES TO PTI-SGV-MTO2 IN PTI
               MOVE ZEROES TO PTI-SGV-MTO3 IN PTI
               MOVE ZEROES TO PTI-SGV-MTO4 IN PTI
               MOVE ZEROES TO PTI-NUM-NDIA IN PTI
               MOVE ZEROES TO PTI-SGV-INT1 IN PTI
               MOVE ZEROES TO PTI-SGV-INT2 IN PTI
               MOVE ZEROES TO PTI-SGV-INT3 IN PTI
               MOVE ZEROES TO PTI-SGV-INT4 IN PTI
               MOVE ZEROES TO PTI-SGV-INTM IN PTI
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-PTI
               GO TO FIN-PUT-REG-PTI.
           MOVE WSS-I IN WSS-VARI              TO PTI-NUM-IPTI IN PTI.
           MOVE FRM-SGV-MTO1 IN PTI-FLD        TO PTI-SGV-MTO1 IN PTI.
           MOVE FRM-SGV-MTO2 IN PTI-FLD        TO PTI-SGV-MTO2 IN PTI.
           MOVE FRM-SGV-MTO3 IN PTI-FLD        TO PTI-SGV-MTO3 IN PTI.
           MOVE FRM-SGV-MTO4 IN PTI-FLD        TO PTI-SGV-MTO4 IN PTI.
           MOVE FRM-NUM-NDIA IN PTI-FLD(WSS-I) TO PTI-NUM-NDIA IN PTI.
           MOVE FRM-SGV-INT1 IN PTI-FLD(WSS-I) TO PTI-SGV-INT1 IN PTI.
           MOVE FRM-SGV-INT2 IN PTI-FLD(WSS-I) TO PTI-SGV-INT2 IN PTI.
           MOVE FRM-SGV-INT3 IN PTI-FLD(WSS-I) TO PTI-SGV-INT3 IN PTI.
           MOVE FRM-SGV-INT4 IN PTI-FLD(WSS-I) TO PTI-SGV-INT4 IN PTI.
           MOVE FRM-SGV-INTM IN PTI-FLD(WSS-I) TO PTI-SGV-INTM IN PTI.
      *HPM ini 3-MAY-1994
           MOVE HOY-FHOY TO PTI-FEC-FACT IN PTI.
      *HPM fin 3-MAY-1994
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-PTI.
       FIN-PUT-REG-PTI.
           EXIT.
       MOD-REG-PTI SECTION.
       INI-MOD-REG-PTI.
           IF SCR-CMND = 'OFC'
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               MOVE ZEROES TO PTI-NUM-IPTI IN PTI
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-PTI
               IF NOT FIO-STAT-OKS
                   GO TO FIN-MOD-REG-PTI
               ELSE
                   PERFORM RET-ALL-PTI
                   PERFORM RET-HDR-PTI
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-PTI
                   GO TO FIN-MOD-REG-PTI.
           MOVE WSS-I IN WSS-VARI TO PTI-NUM-IPTI IN PTI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-PTI.
           IF NOT FIO-STAT-OKS
               MOVE WSS-IOFL IN WSS-VARI TO WSS-I IN WSS-VARI
               GO TO FIN-MOD-REG-PTI.
           PERFORM RET-ALL-PTI.
           PERFORM RET-HDR-PTI.
           MOVE FRM-SGV-MTO1 IN PTI-FLD        TO PTI-SGV-MTO1 IN PTI.
           MOVE FRM-SGV-MTO2 IN PTI-FLD        TO PTI-SGV-MTO2 IN PTI.
           MOVE FRM-SGV-MTO3 IN PTI-FLD        TO PTI-SGV-MTO3 IN PTI.
           MOVE FRM-SGV-MTO4 IN PTI-FLD        TO PTI-SGV-MTO4 IN PTI.
           MOVE FRM-NUM-NDIA IN PTI-FLD(WSS-I) TO PTI-NUM-NDIA IN PTI.
           MOVE FRM-SGV-INT1 IN PTI-FLD(WSS-I) TO PTI-SGV-INT1 IN PTI.
           MOVE FRM-SGV-INT2 IN PTI-FLD(WSS-I) TO PTI-SGV-INT2 IN PTI.
           MOVE FRM-SGV-INT3 IN PTI-FLD(WSS-I) TO PTI-SGV-INT3 IN PTI.
           MOVE FRM-SGV-INT4 IN PTI-FLD(WSS-I) TO PTI-SGV-INT4 IN PTI.
           MOVE FRM-SGV-INTM IN PTI-FLD(WSS-I) TO PTI-SGV-INTM IN PTI.
      *HPM ini 3-MAY-1994
           MOVE HOY-FHOY TO PTI-FEC-FACT IN PTI.
      *HPM fin 3-MAY-1994
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-PTI.
       FIN-MOD-REG-PTI.
           EXIT.
      *>>>>
*% END
