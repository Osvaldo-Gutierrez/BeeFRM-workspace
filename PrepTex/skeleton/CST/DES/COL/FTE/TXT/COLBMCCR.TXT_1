*%! Codigo adicional para archivo
*% IF FIN_PUT_ALL_CCR 
      *<<<< FIN_PUT_ALL_CCR
      *DAD ini  22-SEP-1993 / 17-AUG-1992
      * Para sustituir busqueda de glosa que es Generada Automaticamente
      * asociada al campo FRM-GLS-SCRT por campo  DLC-IND-SCRT IN CCR-FLD
      * que no tiene glosa asociada pues es campo Display Only y No Echo
           IF NOT PGM-STAT-CCR-NUL
               IF PGM-STAT-CCR-OKS
                   IF CCR-IND-SCRT IN CCR-FLD > SPACES
                       MOVE 'COL'                   TO MSC-COD-SIST
                       MOVE 'SCRT'                  TO MSC-COD-TMSC
                                                                 IN MSC
                       MOVE CCR-IND-SCRT IN CCR-FLD TO MSC-COD-CMSC
                                                                 IN MSC
                       PERFORM BUS-MSC
                       MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SCRT
                                                             IN CCR-FLD
                   ELSE
                       MOVE SPACES TO FRM-GLS-SCRT IN CCR-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-SCRT IN CCR-FLD.
      *DAD fin  22-SEP-1993 / 17-AUG-1992
      *>>>>
*% END
*% IF FIN_PUT_DLC_CCR 
      *<<<< FIN_PUT_DLC_CCR 
            IF CCR-NUM-ICCR IN CCR-FLD = 1 AND
               ( SCR-CCPP = 'ING' OR
               ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING))
                MOVE DLC-IND-SCRT IN CCR-FLD TO CCR-IND-SCRA IN CCR-FLD
                IF CCR-IND-SCRA IN CCR-FLD > SPACES
                    MOVE 'COL'                   TO MSC-COD-SIST
                    MOVE 'SCRT'                  TO MSC-COD-TMSC IN MSC
                    MOVE CCR-IND-SCRA IN CCR-FLD TO MSC-COD-CMSC IN MSC
                    PERFORM BUS-MSC
                    MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SCRA IN CCR-FLD.
      *>>>>
*% END
*% IF FIN_RET_CCR_CCR 
      *<<<< FIN_RET_CCR_CCR 
           IF CCR-IND-SCRT IN CCR-FLD = 'VIG'
               MOVE SPACES TO CCR-IND-SCRT IN CCR.
      *>>>>
*% END
*% IF CCR_FEC_FCCR
      *<<<< CCR_FEC_FCCR
      *DAD ini  09-MAY-1991 
      *GET-HOY Obtiene Fecha y Hora actual
           PERFORM GET-FHOY.
      * Asume Fecha Actual si No se Digita Fecha de Traspaso
           IF CCR-FEC-FCCR IN CCR-FLD NOT > ZEROES
               MOVE HOY-DHOY IN HOY-VARI TO CCR-NUM-DCCR IN CCR-FLD
               MOVE HOY-MHOY IN HOY-VARI TO CCR-NUM-MCCR IN CCR-FLD
               MOVE HOY-SHOY IN HOY-VARI TO CCR-NUM-SCCR IN CCR-FLD
               MOVE HOY-AHOY IN HOY-VARI TO CCR-NUM-ACCR IN CCR-FLD
           ELSE
      * Verifica que Fecha de Traspaso sea del Mismo Mes que Fecha Actual
               IF HOY-MHOY IN HOY-VARI NOT = CCR-NUM-MCCR IN CCR-FLD OR
                  HOY-SHOY IN HOY-VARI NOT = CCR-NUM-SCCR IN CCR-FLD OR
                  HOY-AHOY IN HOY-VARI NOT = CCR-NUM-ACCR IN CCR-FLD
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'FCCRMHOY<>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CCR-FEC-FCCR.
      *DAD fin  09-MAY-1991 
           IF CCR-NUM-ICCR IN CCR-FLD > 1
               GO TO FCCR-VAR-CMBS.
      *    leer OPC y comparar las fechas
           MOVE CCR-CAI-IOPC IN CCR-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE CCR-IIC-IOPC IN CCR-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPE    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCR-FEC-FCCR.
           MOVE CCR-NUM-DCCR IN CCR-FLD TO WSS-NUM-DCOM IN WSS-VARI.
           MOVE CCR-NUM-MCCR IN CCR-FLD TO WSS-NUM-MCOM IN WSS-VARI.
           MOVE CCR-NUM-SCCR IN CCR-FLD TO WSS-NUM-SCOM IN WSS-VARI.
           MOVE CCR-NUM-ACCR IN CCR-FLD TO WSS-NUM-ACOM IN WSS-VARI.
           IF WSS-FEC-FCOM IN WSS-VARI < OPC-FEC-FCOL IN OPC
      *        ccr-fec-fccr < opc-fec-fcol
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECFCCRFCOL<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CCR-FEC-FCCR.
       FCCR-VAR-CMBS.
      *    restar 1 al NRO-CAMBIO-ACTUAL y comparar las fechas
           SUBTRACT 1 FROM CCR-NUM-ICCR IN CCR-FLD
                    GIVING CCR-NUM-ICCR IN CCR.
           MOVE CCR-CAI-IOPC IN CCR-FLD TO CCR-CAI-IOPC IN CCR.
           MOVE CCR-IIC-IOPC IN CCR-FLD TO CCR-IIC-IOPC IN CCR.
           MOVE CCR-NUM-IDLC IN CCR-FLD TO CCR-NUM-IDLC IN CCR.
      *     MOVE CCR-NUM-ICCR IN CCR-FLD TO CCR-NUM-ICCR IN CCR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CCR.
      *     ADD 1 TO CCR-NUM-ICCR IN CCR-FLD.
           IF FIO-STAT-OKS
               MOVE CCR-NUM-DCCR IN CCR-FLD TO WSS-NUM-DCOM IN WSS-VARI
               MOVE CCR-NUM-MCCR IN CCR-FLD TO WSS-NUM-MCOM IN WSS-VARI
               MOVE CCR-NUM-SCCR IN CCR-FLD TO WSS-NUM-SCOM IN WSS-VARI
               MOVE CCR-NUM-ACCR IN CCR-FLD TO WSS-NUM-ACOM IN WSS-VARI
               IF WSS-FEC-FCOM IN WSS-VARI < CCR-FEC-FCCR IN CCR
      *            ccr-fec-fccr < ccr-fec-fccr anterior
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FCCRFCCRANT<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CCR-FEC-FCCR
               ELSE
                   GO TO FIN-VAL-CCR-FEC-FCCR.
      *>>>>
*% END
*% IF CCR_FEC_FING
      *<<<< CCR_FEC_FING
      *DAD ini  09-MAY-1991 
           IF CCR-FEC-FING IN CCR-FLD NOT > ZEROES
      *DAD fin  09-MAY-1991 
               MOVE CCR-FEC-FCCR IN CCR-FLD TO CCR-FEC-FING IN CCR-FLD
               GO TO FIN-VAL-CCR-FEC-FING.

      *     MOVE CCR-FEC-FCCR IN CCR-FLD TO WSS-FEC-FEC1 IN WSS-VARI.
           MOVE CCR-NUM-SCCR IN CCR-FLD TO WSS-NUM-SEC1 IN WSS-VARI.
           MOVE CCR-NUM-ACCR IN CCR-FLD TO WSS-NUM-AEC1 IN WSS-VARI.
           MOVE CCR-NUM-MCCR IN CCR-FLD TO WSS-NUM-MEC1 IN WSS-VARI.
           MOVE CCR-NUM-DCCR IN CCR-FLD TO WSS-NUM-DEC1 IN WSS-VARI.
           
      *     MOVE CCR-FEC-FING IN CCR-FLD TO WSS-FEC-FEC2 IN WSS-VARI.
           MOVE CCR-NUM-SING IN CCR-FLD TO WSS-NUM-SEC2 IN WSS-VARI.
           MOVE CCR-NUM-AING IN CCR-FLD TO WSS-NUM-AEC2 IN WSS-VARI.
           MOVE CCR-NUM-MING IN CCR-FLD TO WSS-NUM-MEC2 IN WSS-VARI.
           MOVE CCR-NUM-DING IN CCR-FLD TO WSS-NUM-DEC2 IN WSS-VARI.

           IF WSS-FEC-FEC2 IN WSS-VARI < WSS-FEC-FEC1 IN WSS-VARI
      *GET-MSG Busca mensaje en tabla
      *        ccr-fec-fing < ccr-fec-fccr      
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'FECFINGFCCR<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCR-FEC-FING.
      *>>>>
*% END
*% IF CCR_IND_SCRT
      *<<<< CCR_IND_SCRT
           IF CCR-IND-SCRT IN CCR-FLD = CCR-IND-SCRA IN CCR-FLD
      *        nueva situacion cartera debe ser distinta a la anterior
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'INDSCRTSCRA=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCR-IND-SCRT.
      *>>>>
*% END
*% IF VAL_CON_FLD_CCR
      *<<<< VAL_CON_FLD_CCR
           IF CCR-FEC-FCCR IN CCR-FLD > ZEROES AND
              CCR-FEC-FING IN CCR-FLD > ZEROES
               MOVE CCR-FEC-FCCR IN CCR-FLD TO FEC-FEC1
               MOVE CCR-FEC-FING IN CCR-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFCCRFING>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-CCR.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_CCR
      *<<<< FIN_VAL_CON_IKY_CCR
           IF CCR-IIC-IOPC  IN CCR-FLD NOT > ZEROES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'IICIOPCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               IF CCR-NUM-IDLC IN CCR-FLD NOT > ZEROES
                   MOVE 'GNS'       TO MSG-COD-SIST
                   MOVE 'VALCONKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CCR
      *<<<< INI_VAL_CON_KEY_CCR
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CCR.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CCR
      *<<<< FIN_VAL_CON_KEY_CCR
           IF NOT ( ( CCR-IIC-IOPC IN CCR-FLD > ZEROES   AND
                      CCR-NUM-IDLC IN CCR-FLD > ZEROES   AND
                      CCR-NUM-ICCR IN CCR-FLD > ZEROES ) OR

                    ( CCR-IIC-IOPC IN CCR-FLD     > ZEROES   AND
                      CCR-NUM-IDLC IN CCR-FLD     > ZEROES   AND
                      CCR-NUM-ICCR IN CCR-FLD NOT > ZEROES ) OR

                    ( FRM-NUM-ICLI IN CCR-FLD NOT = ZEROES   AND 
                      FRM-NUM-IAVA IN CCR-FLD > ZEROES ) OR

                    ( FRM-NUM-ICLI IN CCR-FLD NOT = ZEROES ) OR

                    ( FRM-NUM-IAVA IN CCR-FLD > ZEROES ) OR

                    ( FRM-GLS-NOMC IN CCR-FLD > SPACES   AND
                      FRM-GLS-NOMA IN CCR-FLD > SPACES ) OR

                    ( FRM-GLS-NOMC IN CCR-FLD > SPACES ) OR

                    ( FRM-GLS-NOMA IN CCR-FLD > SPACES ) )
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
