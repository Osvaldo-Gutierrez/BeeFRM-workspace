       ANL-CIC-IOPC SECTION.
       INI-ANL-CIC-IOPC.
           MOVE CCR-CAI-IOPC IN CCR TO OPC-CAI-IOPC IN OPC.
           MOVE CCR-IIC-IOPC IN CCR TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPCIOPCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-OPC.
           PERFORM PUT-OPC-CCR.
           MOVE CCR-CAI-IOPC IN CCR TO DLC-CAI-IOPC IN DLC.
           MOVE CCR-IIC-IOPC IN CCR TO DLC-IIC-IOPC IN DLC.
           MOVE CCR-NUM-IDLC IN CCR TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLCIDLCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-DLC.
           PERFORM PUT-DLC-CCR.
           PERFORM BUS-DEU-INDI.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'RDC    NOIND' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FIO-STAT-NEX TO FIO-STAT
      *         GO TO FIN-ANL-CIC-IOPC.
           PERFORM BUS-DEU-DIRE.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDC    NODIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-CIC-IOPC.
           EXIT.

       BUS-DEU-INDI SECTION.
       INI-BUS-DEU-INDI.
           MOVE CCR-CIC-IOPC IN CCR TO RDC-CIC-IOPC IN RDC.
           MOVE CCR-NUM-IDLC IN CCR TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCR-CIC-IOPC IN CCR AND
              RDC-NUM-IDLC IN RDC = CCR-NUM-IDLC IN CCR )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-DEU-INDI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCR-CIC-IOPC IN CCR AND
              RDC-NUM-IDLC IN RDC = CCR-NUM-IDLC IN CCR
               MOVE 'M'     TO FRM-IND-IAVA IN CCR-FLD
               MOVE SPACES  TO FRM-GLS-IAVA IN CCR-FLD
               MOVE ZEROES  TO FRM-NUM-IAVA IN CCR-FLD
               MOVE SPACES  TO FRM-VRF-IAVA IN CCR-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-GLS-NOMC IN CCR-FLD
               GO TO FIN-BUS-DEU-INDI.

           IF FIO-STAT-OKS
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY TO FIO-CMND.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMA IN CCR-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IAVA IN CCR-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IAVA IN CCR-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IAVA IN CCR-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IAVA IN CCR-FLD.
      *         GO TO FIN-BUS-DEU-INDI.
       FIN-BUS-DEU-INDI.
           EXIT.

       BUS-DEU-DIRE SECTION.
       INI-BUS-DEU-DIRE.
           MOVE CCR-CIC-IOPC IN CCR TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCR-CIC-IOPC IN CCR AND
              RDC-NUM-IDLC IN RDC = ZEROES )
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-DEU-DIRE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCR-CIC-IOPC IN CCR AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE 'M'     TO FRM-IND-ICLI IN CCR-FLD
               MOVE SPACES  TO FRM-GLS-ICLI IN CCR-FLD
               MOVE ZEROES  TO FRM-NUM-ICLI IN CCR-FLD
               MOVE SPACES  TO FRM-VRF-ICLI IN CCR-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDDIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-GLS-NOMC IN CCR-FLD
               GO TO FIN-BUS-DEU-DIRE.

           IF FIO-STAT-OKS
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-KEY TO FIO-CMND.

           MOVE FIO-GET-PRV TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN CCR-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN CCR-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN CCR-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN CCR-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN CCR-FLD.
      *         GO TO FIN-BUS-DEU-DIRE.
       FIN-BUS-DEU-DIRE.
           EXIT.

       BUS-COR-CCR SECTION.
       INI-BUS-COR-CCR.
           MOVE 99 TO CCR-NUM-ICCR IN CCR.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CCR.
           IF NOT ( FIO-STAT-OKS AND
                    CCR-CAI-IOPC IN CCR-FLD = CCR-CAI-IOPC IN CCR AND
                    CCR-IIC-IOPC IN CCR-FLD = CCR-IIC-IOPC IN CCR AND
                    CCR-NUM-IDLC IN CCR-FLD = CCR-NUM-IDLC IN CCR )
               PERFORM RET-ALL-CCR
               MOVE ZEROES TO CCR-NUM-ICCR IN CCR.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CCR-NUM-ICCR IN CCR
               MOVE CCR-NUM-ICCR IN CCR TO CCR-NUM-ICCR IN CCR-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CCR.
           EXIT.
