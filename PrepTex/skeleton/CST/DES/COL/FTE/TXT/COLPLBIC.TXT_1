*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY COLBRDLC.
       COPY COLBRDCC.
       COPY COLBRAUX.
       COPY COLBRTOC.
       COPY COLBRICG.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY GNSWGCVI.
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-CIC-CCSB.
              05 WSS-CAI-CCSB                     PIC X(04).
              05 WSS-IIC-CCSB                     PIC 9(08).
           03 WSS-IND-NEXT                        PIC 9(01). 
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-UEFE                        PIC X(06).
           03 WSS-SGV-FPRO                        PIC S9(11)V9999.
           03 WSS-SGV-FDEV                        PIC S9(11)V9999.
           03 WSS-SGV-PESO                        PIC S9(11)V9999.
           03 WSS-VAL-REAJ                        PIC S9(11)V9999.
           03 WSS-VAL-PESO                        PIC S9(11).
           03 WSS-INT-TIPE             COMP-3     PIC 9(03)V9(08).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF CH_BIC_SRT_CIC_CCSB
      *<<<< CH_BIC_SRT_CIC_CCSB
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB      TO WSS-GLS-CCSB IN WSS-BIC
               MOVE TAB-COD-CTAB IN TAB      TO WSS-CIC-CCSB IN WSS-VARI
               MOVE WSS-CAI-CCSB IN WSS-VARI TO WSS-CAI-CCSB IN WSS-BIC
               MOVE WSS-IIC-CCSB IN WSS-VARI TO WSS-IIC-CCSB IN WSS-BIC
           ELSE
               MOVE SPACES TO WSS-GLS-CCSB IN WSS-BIC
                              WSS-CAI-CCSB IN WSS-BIC
               MOVE ZEROES TO WSS-IIC-CCSB IN WSS-BIC.
      *>>>>
*% END
*% IF PH_BIC
      *<<<< PH_BIC
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-BIC
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-BIC.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-BIC
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-BIC.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-BIC
                                            WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-BIC
                                            WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-BIC
                                            WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-BIC
                                            WSS-NUM-AFEC IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

      * Obtiene Valor de Cambio de la UF a Fecha de Proceso
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FPRO IN WSS-VARI ' PARA LA UF. ('
                        WSS-COD-UEFE IN WSS-VARI '/'
                        WSS-COD-PESO IN WSS-VARI ')'
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FPRO IN WSS-VARI ' PARA LA UF.'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FPRO IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           MOVE ZEROES         TO OPC-FEC-FING IN OPC.
           MOVE 'OPC-FEC-FING' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FING IN OPC > WSS-FEC-FFEC IN WSS-VARI
               DISPLAY 'NO HAY REGISTRO HASTA FECHA DE PROCESO : '
                       WSS-FEC-FPRO IN WSS-VARI
               GO TO FIN-INP-SRT.
           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.

      * Busca los Documentos de Credito para Operacion Determinada
           MOVE SPACES              TO DLC-KEY-IDLC IN DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-KEY-IOPC IN OPC
               GO TO NXT-INP-SRT.
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FFEC IN WSS-VARI
               GO TO NXT-INP-SRT.
       LUP-BUS-OPC-DLC.
           PERFORM BUS-SRT-REG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC OR
              DLC-FEC-FDEV IN DLC > WSS-FEC-FFEC IN WSS-VARI
               GO TO NXT-INP-SRT.
           GO TO LUP-BUS-OPC-DLC.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FING' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF OPC-FEC-FING IN OPC > WSS-FEC-FFEC IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           PERFORM GEN-LIN-OUT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBPFEC
      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Fecha y Oficina del Listado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO FIN-SEL-REG-PRO.

      * Mediante el Registro TOC Tipo Operaciones Creditos Obtiene 'Como Opera'
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' TOC-COD-TABL
               GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Formacion y Generacion del Registro SRT al Procesar Varios Registros
       BUS-SRT-REG SECTION.
       INI-BUS-SRT-REG.
      * Forma Llave COD-CCTB para Leer DCC
           MOVE 'CAP'               TO DCC-MSC-TCCT IN DCC.
           MOVE OPC-COD-VCOC IN OPC TO DCC-COD-VCAM IN DCC.
           MOVE OPC-COD-TOOC IN OPC TO DCC-COD-TOCR IN DCC.
           MOVE DLC-COD-PLZO IN DLC TO DCC-COD-PLZO IN DCC.
           MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC.
           MOVE SPACES              TO DCC-IND-SCTB IN DCC.
           MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC.

      * Con BUS-TAB Busca Estado de IND-PCTB de Tabla AUX para Completar Llave
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL IN TAB
               GO TO FIN-BUS-SRT-REG.
           MOVE TAB TO AUX.
           IF AUX-IND-PCTB NOT = 'N'
               MOVE OPC-COD-AOOC IN OPC TO DCC-COD-AOCR IN DCC
           ELSE
               MOVE SPACES TO DCC-COD-AOCR IN DCC.

      * Obtiene Cuenta Contable al Leer DCC por Llave COD-CCTB Formada
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' DCC-COD-TABL IN DCC
               GO TO FIN-BUS-SRT-REG.
           MOVE DCC-GLS-CCSB IN DCC TO SRT-CIC-CCSB IN SRT.

      *Compara Fechas del Periodo en Dias
           MOVE DLC-NUM-DDEV IN DLC      TO FEC-DEC1 IN FEC-VARI.
           MOVE DLC-NUM-MDEV IN DLC      TO FEC-MEC1 IN FEC-VARI.
           MOVE DLC-NUM-SDEV IN DLC      TO FEC-SEC1 IN FEC-VARI.
           MOVE DLC-NUM-ADEV IN DLC      TO FEC-AEC1 IN FEC-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               GO TO FIN-BUS-SRT-REG.
           MOVE FEC-NDIA TO SRT-NUM-DIAS IN SRT
                            INT-SEPD.

      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
           IF TOC-MSC-OPEC IN TOC = 'D'
               PERFORM GET-ICG-DLC
           ELSE
               PERFORM GET-ICG-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'REGISTRO OPC NO TIENE INTERESES ' OPC-KEY-IOPC
               GO TO FIN-BUS-SRT-REG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO SRT-SGV-TINT IN SRT
           ELSE
               MOVE ICG-SGV-TINT IN ICG TO SRT-SGV-TINT IN SRT.
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.

      * Calcula Tasa de Interes del Periodo
           PERFORM CAL-TAS-PER.
           IF INT-CMSG > SPACES
               DISPLAY 'DOCUMENTO : ' DLC-KEY-IDLC IN DLC
               IF INT-CMSG = 'CAM    NEX'
                   DISPLAY 'TASA INT./V. CAMBIO/FECHA : ' INT-TIPT '/'
                           INT-VCAM '/' INT-FINT 
                   GO TO FIN-BUS-SRT-REG
               ELSE
                   GO TO FIN-BUS-SRT-REG.
      * Para 'Como Opera' = 'D' y Tasa de Interes Vencida, transforma la Tasa
      * de Interes de la Operacion a Tasa Anticipada
           IF TOC-MSC-OPEC IN TOC = 'D' AND
              INT-BCTI = 'V'
               MOVE INT-TIPE TO WSS-INT-TIPE IN WSS-VARI
               ADD 1 TO INT-TIPE
               DIVIDE WSS-INT-TIPE IN WSS-VARI BY INT-TIPE GIVING
                                                  INT-TIPE ROUNDED.
           MULTIPLY INT-TIPE BY 100 GIVING SRT-SGV-TPER IN SRT ROUNDED.

      * Omite Calcular Reajustes Devengados en el Periodo para Creditos en Pesos
           IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
               MOVE ZEROES TO SRT-VAL-REAJ IN SRT
                              SRT-SGV-VCAM IN SRT
               GO TO CON-BUS-SRT-REG.

      * Obtiene Valor de Cambio de la UF a Fecha de Devengo
           MOVE DLC-FEC-FDEV IN DLC      TO CAM-FEC-FCAM IN CAM(1).
           MOVE DLC-FEC-FDEV IN DLC      TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        DLC-FEC-FDEV IN DLC ' PARA LA UF.'
               GO TO FIN-BUS-SRT-REG.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FPRO IN WSS-VARI ' PARA LA UF.'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FDEV IN WSS-VARI.

      * Calcula Reajustes Devengados en el Periodo
           SUBTRACT WSS-SGV-FDEV IN WSS-VARI FROM WSS-SGV-FPRO
                           IN WSS-VARI GIVING WSS-VAL-REAJ IN WSS-VARI.
           IF OPC-MSC-TVOC IN OPC = '0'
               MULTIPLY WSS-VAL-REAJ IN WSS-VARI BY DLC-VAL-SDLC IN DLC
                                GIVING WSS-VAL-PESO IN WSS-VARI ROUNDED
               MOVE WSS-VAL-PESO IN WSS-VARI TO SRT-VAL-REAJ IN SRT
           ELSE
               MULTIPLY WSS-VAL-REAJ IN WSS-VARI BY DLC-VAL-SDLC IN DLC
                                GIVING SRT-VAL-REAJ IN SRT ROUNDED.

      * Obtiene Valor de Cambio en Pesos a Fecha de Devengo
           IF OPC-COD-VCOC IN OPC = WSS-COD-UEFE IN WSS-VARI
               MOVE WSS-SGV-FDEV IN WSS-VARI TO SRT-SGV-VCAM IN SRT
           ELSE
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MOVE DLC-FEC-FDEV IN DLC      TO CAM-FEC-FCAM IN CAM(1)
               MOVE DLC-FEC-FDEV IN DLC      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA : '
                            DLC-FEC-FDEV IN DLC ' PARA : '
                            OPC-COD-VCOC IN OPC
                   GO TO FIN-BUS-SRT-REG
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       DISPLAY 'VIGENCIA NO VALIDA A FECHA : '
                                DLC-FEC-FDEV IN DLC ' PARA : '
                                OPC-COD-VCOC IN OPC
                       GO TO FIN-BUS-SRT-REG
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO SRT-SGV-VCAM IN SRT.

       CON-BUS-SRT-REG.
      * Obtiene Valor de Cambio en Pesos a Fecha de Proceso para Moneda Nacional
           IF OPC-MSC-TVOC IN OPC = '0' AND
              OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
               MOVE WSS-FEC-FFEC IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)
               MOVE WSS-FEC-FFEC IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA : '
                            WSS-FEC-FPRO IN WSS-VARI ' PARA : '
                            OPC-COD-VCOC IN OPC
                   GO TO FIN-BUS-SRT-REG
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                      DISPLAY 'VIGENCIA NO VALIDA A FECHA : '
                               WSS-FEC-FPRO IN WSS-VARI ' PARA : '
                               OPC-COD-VCOC IN OPC
                      GO TO FIN-BUS-SRT-REG
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-PESO
                                                    IN WSS-VARI
                       MULTIPLY DLC-VAL-SDLC IN DLC BY WSS-SGV-PESO IN
                       WSS-VARI GIVING WSS-VAL-PESO IN WSS-VARI ROUNDED
                       MOVE WSS-VAL-PESO IN WSS-VARI TO DLC-VAL-SDLC
                                                             IN DLC.

      * Calcula Intereses Devengados en el Periodo
           IF OPC-MSC-TVOC IN OPC = '0'
               MULTIPLY INT-TIPE BY DLC-VAL-SDLC IN DLC
                                GIVING WSS-VAL-PESO IN WSS-VARI ROUNDED
               MOVE WSS-VAL-PESO IN WSS-VARI TO SRT-VAL-INTS IN SRT
           ELSE
               MULTIPLY INT-TIPE BY DLC-VAL-SDLC IN DLC
                                GIVING SRT-VAL-INTS IN SRT ROUNDED.

      * Completa Llenado de Campos y Genera el Registro SRT
           COPY COLRMBIC.
           RELEASE SRT.
       FIN-BUS-SRT-REG.
           EXIT.
      **************************************************************************
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       GET-ICG-DLC SECTION.
       INI-GET-ICG-DLC.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               PERFORM GET-ICG-OPC.
       FIN-GET-ICG-DLC.
           EXIT.
      **************************************************************************
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       GET-ICG-OPC SECTION.
       INI-GET-ICG-OPC.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-ICG-OPC.
           EXIT.
      **************************************************************************
       GET-KEY-IICG SECTION.
       INI-GET-KEY-IICG.
      * Forma Llave KEY-IICG y Lee ICG para Obtener Tasa de Interes
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM COL-FIO-ICG.
       FIN-GET-KEY-IICG.
           EXIT.
      **************************************************************************
       CAL-TAS-PER SECTION.
       INI-CAL-TAS-PER.
      * Calculo tasa de interes a partir de una tasa y periodo dado
      * Tasa Interes.                    * INT-TIPT.
      * Valor Tasa Informada.            * INT-TINT.
      * Separacion en Dias.              * INT-SEPD.
      * IF INT-CVTI > SPACES
      *   Fecha Interes.                 * INT-FINT.
      *   Moneda.                        * INT-VCAM.

           MOVE ZEROES TO SRT-SGV-TPER IN SRT.
           IF INT-CVTI > SPACES
               MOVE INT-IBTV-UNA-VEZ    TO INT-IBTV
               MOVE OPC-COD-VCOC IN OPC TO INT-VCAM
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT
      *    En el Ingreso ICG-FEC-FINI = ZEROES
               IF ICG-FEC-FINI IN ICG > ZEROES
                   MOVE ICG-FEC-FINI IN ICG TO INT-FINT
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO INT-FINT
           ELSE
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT.

           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               GO TO MSG-CAL-TAS-PER.
           GO TO FIN-CAL-TAS-PER.
       MSG-CAL-TAS-PER.
           MOVE 'GNS'    TO MSG-COD-SIST.
           MOVE INT-CMSG TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC.
       FIN-CAL-TAS-PER.
           EXIT.
      **************************************************************************
      * Genera Lineas de Detalle a Partir de Registro SRT Ordenado
       GEN-LIN-OUT SECTION.
       INI-GEN-LIN-OUT.
      * Mediante BUS-TAB Busca Tipo de Tasa de Interes de Tabla INT
           IF ICG-COD-TINT IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TINT IN WSS-BIC
           ELSE
               MOVE SPACES TO WSS-GLS-TINT IN WSS-BIC.

           PERFORM BUS-REG-CLI.
       FIN-GEN-LIN-OUT.
           EXIT.
      **************************************************************************
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE DLC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC.
      *        GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              WSS-GLS-AUXI IN WSS-BIC
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
               IF DBC-GLS-ICLI IN DBC > SPACES
                   MOVE '-'    TO WSS-GLS-AUXI IN WSS-BIC
               ELSE
                   MOVE SPACES TO WSS-GLS-AUXI IN WSS-BIC.
       FIN-BUS-REG-CLI.
           EXIT.
      **************************************************************************

       COPY GNSBFMSC.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFDLC.
       COPY COLBFDCC.
       COPY COLBFTOC.
       COPY COLBFICG.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
      *SMC-INI 09.09.1993    
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
      *>>>>
*% END
