       ANL-CIC-IOPC SECTION.
       INI-ANL-CIC-IOPC.
           MOVE CCT-CAI-IOPC IN CCT TO OPC-CAI-IOPC IN OPC.
           MOVE CCT-IIC-IOPC IN CCT TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPCIOPCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-VEN.
           PERFORM PUT-VEN-CCT.
           MOVE '00' TO PGM-STAT-OPC.
           PERFORM PUT-OPC-CCT.
           MOVE CCT-CAI-IOPC IN CCT TO DLC-CAI-IOPC IN DLC.
           MOVE CCT-IIC-IOPC IN CCT TO DLC-IIC-IOPC IN DLC.
           MOVE CCT-NUM-IDLC IN CCT TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLCIDLCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-CIC-IOPC.
           MOVE '00' TO PGM-STAT-DLC.
           PERFORM PUT-DLC-CCT.
           PERFORM BUS-DEU-INDI.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'RDC    NOIND' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FIO-STAT-NEX TO FIO-STAT
      *         GO TO FIN-ANL-CIC-IOPC.
           PERFORM BUS-DEU-DIRE.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDC    NODIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-CIC-IOPC.
           EXIT.

       BUS-DEU-INDI SECTION.
       INI-BUS-DEU-INDI.
           MOVE CCT-CIC-IOPC IN CCT TO RDC-CIC-IOPC IN RDC.
           MOVE CCT-NUM-IDLC IN CCT TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCT-CIC-IOPC IN CCT AND
              RDC-NUM-IDLC IN RDC = CCT-NUM-IDLC IN CCT
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMA IN CCT-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IAVA IN CCT-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IAVA IN CCT-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IAVA IN CCT-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IAVA IN CCT-FLD
                   GO TO FIN-BUS-DEU-INDI.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-INDI.
           EXIT.

       BUS-DEU-DIRE SECTION.
       INI-BUS-DEU-DIRE.
           MOVE CCT-CIC-IOPC IN CCT TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND 
              RDC-CIC-IOPC IN RDC = CCT-CIC-IOPC IN CCT AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN CCT-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN CCT-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN CCT-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN CCT-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN CCT-FLD
                   GO TO FIN-BUS-DEU-DIRE.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIRE.
           EXIT.

       BUS-COR-CCT SECTION.
       INI-BUS-COR-CCT.
           MOVE 99 TO CCT-NUM-ICCT IN CCT.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CCT.
           IF NOT ( FIO-STAT-OKS AND
                    CCT-CAI-IOPC IN CCT-FLD = CCT-CAI-IOPC IN CCT AND
                    CCT-IIC-IOPC IN CCT-FLD = CCT-IIC-IOPC IN CCT AND
                    CCT-NUM-IDLC IN CCT-FLD = CCT-NUM-IDLC IN CCT )
               PERFORM RET-ALL-CCT
               MOVE ZEROES TO CCT-NUM-ICCT IN CCT.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CCT-NUM-ICCT IN CCT
               MOVE CCT-NUM-ICCT IN CCT TO CCT-NUM-ICCT IN CCT-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CCT.
           EXIT.
