*% IF LDA_NUM_SIS
      *<<<
           IF (LDA-NUM-SIS IN AVA-FLD > SPACES)
               MOVE LDA-NUM-SIS IN AVA-FLD  TO WR-NUM-SIS
               IF (WR-NUM-SIS-L NOT = 'L')
                   MOVE FRM-SUAR-MAL        TO FRM-SUAR
                   MOVE 'COL'               TO MSG-COD-SIST
                   MOVE 'LDASISINV'         TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MENS
                   MOVE -1                  TO LDA-NUM-SIS-LEN
                   GO TO FIN-VAL-LDA-NUM-SIS.
      *>>>
*% END
*% IF FRM_VRF_ICLI
      *<<< valida existencia cliente por rut
           IF (FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR OR
               FRM-VRF-ICLI IN AVA-FLD NOT > SPACES)
               GO TO FIN-VAL-FRM-VRF-ICLI.

           MOVE 'DBC-IDC-ICLI'           TO FIO-AKEY
           PERFORM BUS-CLIENTE
           IF (NOT ADR-STAT-OKS IN ADR-DBC-REQA)
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VRF-ICLI.
      *>>>
*% END
*% IF FIN_PUT_LDA_AVA
           MOVE 'DBC-KEY-IDBC'           TO FIO-AKEY
           PERFORM BUS-CLIENTE.
           MOVE CCT-COD-CRR IN LDA       TO FRM-COD-CRR IN AVA-FLD.
      *>>>
*% END
*% IF FIN_PRO_KEY_AVA
      *<<<
           PERFORM PON-TOT-FRM.
      *>>>
*% END
*% IF EOF
      *<<<
       BUS-CLIENTE SECTION.
       INI-BUS-CLTE.
      *Lee DBC y puebla datos pantalla 
           IF (FIO-AKEY = 'DBC-IDC-ICLI')
               MOVE FRM-NUM-ICLI IN AVA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE SPACES                  TO DBC-IND-ICLI IN DBC
               MOVE SPACES                  TO DBC-GLS-ICLI IN DBC
               MOVE FIO-GET-NLS             TO FIO-CMND
           ELSE
               MOVE CLI-CIC IN LDA          TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY             TO FIO-CMND.

           PERFORM SGC-FIO-DBC.

           IF NOT FIO-STAT-OKS OR 
                 (FIO-STAT-OKS AND FRM-NUM-ICLI NOT = DBC-NUM-ICLI AND
                  CLI-CIC IN LDA NOT = DBC-CIC-ICLI IN DBC)
                  MOVE '23'                  TO ADR-STAT IN ADR-DBC-REQA
                  MOVE 'SGC'                 TO MSG-COD-SIST
                  MOVE 'CLI    NEX'          TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC          TO FRM-MENS
                  MOVE '00'                  TO FIO-STAT
                  MOVE SPACES                TO FRM-GLS-NOMC IN AVA-FLD
                  MOVE FRM-SUAR-MAL          TO FRM-SUAR
                  MOVE -1                    TO FRM-NUM-ICLI-LEN
              ELSE
                  MOVE SPACES                TO FRM-MENS
                  MOVE DBC-NUM-ICLI IN DBC   TO FRM-NUM-ICLI IN AVA-FLD
                  MOVE DBC-VRF-ICLI IN DBC   TO FRM-VRF-ICLI IN AVA-FLD
                  MOVE DBC-GLS-NOMC IN DBC   TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN              TO FRM-GLS-NOMC IN AVA-FLD
       FIN-BUS-CLTE.
           EXIT.
      *>>>
*% END
