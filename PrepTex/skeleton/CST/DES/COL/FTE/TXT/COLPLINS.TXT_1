*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY TABBROFI.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *
       01  WSS-VARI.
           03 WSS-FEC-FPRO.
              05  WSS-NUM-DPRO                     PIC 9(02).
              05  WSS-NUM-MPRO                     PIC 9(02).
              05  WSS-NUM-SPRO                     PIC 9(02).
              05  WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FDES.
              05  WSS-NUM-DDES                     PIC 9(02).
              05  WSS-NUM-MDES                     PIC 9(02).
              05  WSS-NUM-SDES                     PIC 9(02).
              05  WSS-NUM-ADES                     PIC 9(02).
           03 WSS-FEC-FTRA.
              05  WSS-NUM-STRA                     PIC 9(02).
              05  WSS-NUM-ATRA                     PIC 9(02).
              05  WSS-NUM-MTRA                     PIC 9(02).
              05  WSS-NUM-DTRA                     PIC 9(02).
           03 WSS-FEC-FXXX                         PIC X(08).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF INI
      *<<<< INI
       LEE-PARAM.
      *---------*
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
 
           ACCEPT WSS-FEC-FXXX IN WSS-VARI.
           DISPLAY WSS-FEC-FXXX IN WSS-VARI.

           IF WSS-FEC-FXXX IS NOT NUMERIC
              MOVE ZEROES TO WSS-FEC-FDES
           ELSE
              MOVE WSS-FEC-FXXX TO WSS-FEC-FDES
      *       VAL-FEC Valida Fecha de Desde
              MOVE WSS-FEC-FDES IN WSS-VARI TO FEC-FECH
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-FBLK-N   TO FEC-FBLK
              MOVE FEC-CHOY-LE  TO FEC-CHOY
              MOVE FEC-VHBL-N   TO FEC-VHBL
              MOVE FEC-VAL-FEC  TO FEC-CMND
              PERFORM PRO-FEC
              IF NOT FEC-STAT-OKS
                 DISPLAY 'ERROR AL VALIDAR FECHA DESDE'
                 PERFORM GNS-PRO-ABT.

      *    VAL-FEC Validar Fecha Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR AL VALIDAR FECHA PROCESO'
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTRA IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTRA IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STRA IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATRA IN WSS-VARI.

      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           GO TO FST-INP-SRT2.
      *<<<< 
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
       FST-INP-SRT2.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE WSS-NUM-SDES IN WSS-VARI TO OPC-NUM-SINP IN OPC.
           MOVE WSS-NUM-ADES IN WSS-VARI TO OPC-NUM-AINP IN OPC.
           MOVE WSS-NUM-MDES IN WSS-VARI TO OPC-NUM-MINP IN OPC.
           MOVE WSS-NUM-DDES IN WSS-VARI TO OPC-NUM-DINP IN OPC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTEN REGISTRO QUE CUMPLAN RANGO FECHAS'
              PERFORM GNS-PRO-ABT.
      *<<<< 
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF OPC-COD-INSI IN OPC = ' '
              GO TO NXT-INP-SRT.
      * Busca Codigo Regional en OFI
           MOVE OPC-COD-OFOC IN OPC TO OFI-COD-OFIC IN OFI.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO SRT-COD-REGI IN SRT
           ELSE
              IF OFI-COD-MODL NOT = '1'
                 MOVE OFI-COD-REGP IN OFI TO SRT-COD-REGI IN SRT
              ELSE
                 MOVE OFI-COD-REGE IN OFI TO SRT-COD-REGI IN SRT.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FTRA IN WSS-VARI
              GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-INS.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-INS.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-INS.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-INS.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF NOT FIO-STAT-OKS 
                  MOVE 'ERROR' TO WSS-GLS-MNDA IN WSS-INS
               ELSE
                  MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MNDA IN WSS-INS
           ELSE 
               MOVE SPACES TO WSS-GLS-MNDA IN WSS-INS.

      * Busca Nombre del Deudor en DBC
           MOVE OPC-CIC-IOPC IN SRT TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              MOVE 'ERROR NO EXISTE DEUDOR' TO WSS-GLS-NOMD IN WSS-INS
           ELSE
              MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
              MOVE FIO-GET-KEY         TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                MOVE 'ERROR NO EXISTE DEUDOR' TO WSS-GLS-NOMD IN WSS-INS
              ELSE
                MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMD IN WSS-INS.

      * Busca Nombre Regional en Tabla REG 
           MOVE 'TAB'               TO TAB-COD-SIST
           MOVE 'RGN'               TO TAB-COD-TTAB IN TAB
           MOVE SRT-COD-REGI IN SRT TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB 
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC TO WSS-GLS-REGN IN WSS-INS
           ELSE
              IF TAB-IND-VIGE = 'N'
                 MOVE 'COD    VIG' TO MSG-COD-MENS
                 MOVE 'GNS'  TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-REGN IN WSS-INS
              ELSE
                 MOVE TAB-GLS-DESC TO WSS-GLS-REGN IN WSS-INS.
      
      * Busca Tipo de Insistencia en Tabla INS
           MOVE 'COL'               TO TAB-COD-SIST
           MOVE 'INS'               TO TAB-COD-TTAB IN TAB
           MOVE OPC-COD-INSI IN SRT TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC TO WSS-GLS-INS IN WSS-INS
           ELSE
              IF TAB-IND-VIGE = 'N'
                 MOVE 'COD    VIG' TO MSG-COD-MENS
                 MOVE 'GNS'  TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-INS IN WSS-INS
              ELSE
                 MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-INS IN WSS-INS.         
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY COLBFRDC.
       COPY TABBFOFI.
       COPY SGCBFDBC.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *>>>>
*% END
