*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
           03  SCR-VARI-PFS.
               05  SCR-KEY-ILDA-ACTU     PIC X(12).
           03  SCR-CIC-ICLI              PIC X(12).
           03  SCR-COD-EST               PIC X(03).
           03 SCR-KEY-ACC                PIC X(13).
      *>>>>
*% END
*% LARGO_MI_COMMAREA = 40
*% IF WSS
      * << Variables definidas por codigo adicional
       01  WR-VARIABLES.
           02 WR-FECHA-AUX1.
              03 WR-ANO-AUX1           PIC 9(04).
              03 WR-MES-AUX1           PIC 9(02).
              03 WR-DIA-AUX1           PIC 9(02).
           02 WR-FECHA-AUX2.
              03 WR-ANO-AUX2           PIC 9(04).
              03 WR-MES-AUX2           PIC 9(02).
              03 WR-DIA-AUX2           PIC 9(02).
           02 WR-COP.
              03 WR-NUM-SIS.
                 04 WR-NUM-SIS-L       PIC X(01).
                 04 WR-COD-OFI         PIC X(03).
              03 WR-COD-CRR            PIC X(08).
           02 WR-MTO-DEUDA             PIC 9(12)V9(04).
       COPY SGCBRDBC.
       COPY SGCBRRCO.
       COPY COLBROPC.
       COPY COLBRRLO.
       COPY GNSWGCPT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLO-REQA==.
*% END
*% IF FND_KEY
      *<< Analizo por llave de acceso
           IF (LDA-NUM-SIS IN CUR-FLD > SPACES)
               MOVE 'LDA-COP'       TO SCR-KEY-ACC
           ELSE
              MOVE SCR-CIC-ICLI     TO CLI-CIC IN LDA
              MOVE 'LDA-CLV-LDA-1'  TO FIO-AKEY SCR-KEY-ACC
              MOVE FIO-GET-NLS      TO FIO-CMND
              PERFORM COL-FIO-LDA
              IF SCR-CIC-ICLI NOT = CLI-CIC IN LDA
                 MOVE '23' TO FIO-STAT PGM-STAT-LDA
                 GO TO FIN-FND-KEY.
*% END
*% IF CMN_ING
      *<< Ingresa campos anexos al registro y de auditoria
           MOVE ZEROES                     TO LDA-FEC-REN-LIN IN LDA
           MOVE '0000'                     TO CCT-NUM-SIS IN LDA
           MOVE FRM-COD-CRR IN CUR-FLD     TO CCT-COD-CRR IN LDA
           MOVE '0999  '                   TO LDA-VCB IN LDA
           MOVE SCR-CIC-ICLI               TO CLI-CIC IN LDA
           MOVE SPACES                     TO FILLER1 IN LDA
           PERFORM DAT-AUD-LDA.
*% END
*% IF CMN_MOD
      *<< Ingresa campos de auditoria
           MOVE FRM-COD-CRR IN CUR-FLD     TO CCT-COD-CRR IN LDA
           MOVE SCR-CIC-ICLI               TO CLI-CIC IN LDA
           PERFORM DAT-AUD-LDA.
*% END
*% IF FIN_SCR_MOD
      *<< Modifica mensaje de MODYES para comando "EST"
           IF (SCR-CMND = 'EST' AND MSG-COD-MENS = 'MODYES    ')
               MOVE 'LDAMODYESEST' TO MSG-COD-MENS
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CUR-GLS-MENS.
       FIN-SCR-MOD-EST.
*% END
*% IF CMN_ACC
      *<< Ingresa campos de auditoria
           IF (SCR-CMND = 'EST')
               PERFORM DAT-AUD-LDA.
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-CUR
               PERFORM VAL-NUM-FLD-CUR
               PERFORM SCRL-TAB-CUR
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF PGM-STAT-LDA-OKS
               MOVE LDA-COP IN LDA TO SCR-KEY-ILDA-ACTU.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       SCRL-TAB-CUR SECTION.
       INI-SCRL-TAB-CUR.
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM SCRL-TAB-CUR-PF7
               GO TO FIN-SCRL-TAB-CUR.
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM SCRL-TAB-CUR-PF8
               GO TO FIN-SCRL-TAB-CUR.
       FIN-SCRL-TAB-CUR.
           EXIT.

       SCRL-TAB-CUR-PF7 SECTION.
       INI-SCRL-TAB-CUR-PF7.
           MOVE SCR-KEY-ILDA-ACTU TO LDA-COP IN LDA.
           MOVE SCR-CIC-ICLI      TO CLI-CIC IN LDA.
           MOVE SCR-KEY-ACC TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-LDA.
           IF NOT FIO-STAT-OKS
               MOVE 'LDACURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CUR-PF7.
           MOVE SCR-KEY-ACC TO FIO-AKEY.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-LDA.
           IF NOT FIO-STAT-OKS
               MOVE 'LDA    NOPRV' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CUR-PF7.
           MOVE FIO-STAT TO PGM-STAT-LDA.
           PERFORM SCR-CLRA-CUR.
           PERFORM PUT-SCR.
           GO TO FIN-SCRL-TAB-CUR-PF7.
       MSG-SCRL-TAB-CUR-PF7.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CUR-PF7.
           EXIT.

       SCRL-TAB-CUR-PF8 SECTION.
       INI-SCRL-TAB-CUR-PF8.
           MOVE SCR-KEY-ILDA-ACTU TO LDA-COP IN LDA.
           MOVE SCR-CIC-ICLI      TO CLI-CIC IN LDA.
           MOVE SCR-KEY-ACC TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-LDA.
           IF NOT FIO-STAT-OKS
               MOVE 'LDACURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CUR-PF8.
           MOVE SCR-KEY-ACC TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-LDA.
           IF NOT FIO-STAT-OKS
               MOVE 'LDA    NONXT' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CUR-PF8.
           MOVE FIO-STAT TO PGM-STAT-LDA.
           PERFORM SCR-CLRA-CUR.
           PERFORM PUT-SCR.
           GO TO FIN-SCRL-TAB-CUR-PF8.
       MSG-SCRL-TAB-CUR-PF8.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CUR-PF8.
           EXIT.
      *>>>>
       INI-PAR-PGM-VRS SECTION.
       REC-RLO-OPC.
           MOVE COL-COP                    TO OPC-CIC-IOPC IN OPC
           MOVE 'OPC-KEY-IOPC'             TO FIO-AKEY
           MOVE FIO-GET-KEY                TO FIO-CMND
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
              ADD OPC-VAL-SCRE IN OPC      TO WR-MTO-DEUDA
              MOVE 'LDA-CLV-RLO-1'         TO FIO-AKEY
              MOVE FIO-GET-NXT             TO FIO-CMND
              PERFORM COL-FIO-RLO
              IF NOT FIO-STAT-OKS
                 MOVE '00'                 TO FIO-STAT
                 MOVE SPACES               TO LDA-CLV-RLO-1 IN RLO.
       DAT-AUD-LDA.
           PERFORM GET-FHOY
           MOVE HOY-FHOY                   TO LDA-FEC-ULT-ACT IN LDA
           MOVE HOY-HHOY                   TO LDA-HOR-ACT IN LDA
           MOVE EIBTRMID                   TO LDA-TML-ACT IN LDA
           MOVE SCR-USER                   TO LDA-IDN-USU-ACT IN LDA.
       FIN-PAR-PGM-VRS.
           EXIT. 
       COPY SGCBFDBC.
       COPY SGCBFRCO.
       COPY COLBFOPC.
       COPY COLBFRLO.
       COPY GNSBGCPT.
*% END
