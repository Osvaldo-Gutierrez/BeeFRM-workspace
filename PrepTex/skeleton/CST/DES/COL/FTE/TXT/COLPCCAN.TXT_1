*%! Codigo adicional para archivo
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY
                           ==02  SCR-CAN-REQA==.
           02 SCR-IND-MCYA                         PIC X(01).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY TABBRUSR.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRITR.
       COPY COLBROPC.
       COPY COLBRRCV.
       COPY COLBRROV.
       COPY COLBRVEN.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSBRTAB.
       COPY TABBROFI.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGIDC.
       COPY GNSWGCIC.
       COPY GNSBRCIC.
       01  WSS-VARI.
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  WSS-NUM-TVEN                       PIC 9(03).
           03  WSS-VAL-TVEN              COMP-3    PIC 9(11)V9(05).
           03  WSS-VAL-NDLC              COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PDIR              COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-PIND              COMP-3    PIC 9(11)V9(05).
           03  WSS-SGV-TCYA VALUE ZEROES COMP-3    PIC 9(11)V9(05).
           03  WSS-NUM-FEDT                   PIC  --.---.--9,99999.
           03  WSS-NUM-FALF                   PIC  --.---.--9,99999.
           03  WSS-IND-MITR             VALUE SPACES PIC X(01).
           03  WSS-ICOR                 VALUE 0      PIC 9(01).
               88 NO-ASIGNE-CORRELATIVO VALUE 0.
           03  WSS-MSC-TCAN                       PIC X(01).
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-CAN
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
                   MOVE ZEROES TO VEN-NUM-IVEN IN CAN-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'CAN    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'CAN    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.

           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-RCV
               IF MSG-COD-MENS = 'RCVSI'
                   PERFORM SCR-CLRA-CAN
                   MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN CAN-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'RCVIVCTNOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'RCVIVCTNONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
       CON-FND-KEY.
           MOVE CAN-CAI-IOPC IN CAN TO OPC-CAI-IOPC IN OPC.
           MOVE CAN-IIC-IOPC IN CAN TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CICIOPCNOOPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
      *ALD 
           MOVE ZEROES TO OPC-NUM-TVCC IN OPC.
           MOVE ZEROES TO OPC-NUM-VCOR IN OPC.
           MOVE 1      TO OPC-NUM-IEVC IN OPC.

           PERFORM GET-CUR-ITR.
           IF PGM-STAT-ITR-OKS
               PERFORM GET-NXT-ITR
               PERFORM PUT-ITR-CAN
           ELSE
               PERFORM CLR-ITR-CAN.

           MOVE CAN-CAI-IOPC IN CAN TO ROV-CAI-IOPV IN ROV.
           MOVE CAN-IIC-IOPC IN CAN TO ROV-IIC-IOPV IN ROV.
           MOVE VEN-NUM-IVEN IN VEN TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-STAT TO PGM-STAT-ROV.
           PERFORM COL-FIO-ROV.

           MOVE CAN-CAI-IOPC IN CAN TO RDC-CAI-IOPC IN RDC.
           MOVE CAN-IIC-IOPC IN CAN TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE
               GO TO CON-PGD.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               MOVE SPACES TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE
               GO TO CON-PGD.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = CAN-CAI-IOPC IN CAN AND
              RDC-IIC-IOPC IN RDC = CAN-IIC-IOPC IN CAN AND
              RDC-NUM-IDLC IN RDC = ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    MDDIR' TO MSG-COD-MENS
               MOVE 'M'     TO DBC-IND-ICLI IN DBC
               PERFORM SET-MSG-CLTE.
       CON-PGD.
           IF SCR-CCPP = 'ING' OR CAN-NUM-ICAN IN CAN NOT > ZEROES
               PERFORM BUS-COR-CAN.

           PERFORM GET-CUR-ITR.
           IF FIO-STAT-OKS
               PERFORM PUT-ITR-CAN
           ELSE
               PERFORM CLR-ITR-CAN.

           MOVE 'C'                 TO RCV-IND-ICOT IN RCV.
           MOVE CAN-CAI-IOPC IN CAN TO RCV-CAI-IOPC IN RCV.
           MOVE CAN-IIC-IOPC IN CAN TO RCV-IIC-IOPC IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           MOVE FIO-STAT TO PGM-STAT-RCV.

           MOVE CAN-CAI-IOPC IN CAN TO CYA-CAI-IOPC IN CYA.
           MOVE CAN-IIC-IOPC IN CAN TO CYA-IIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CAI-IOPC IN CAN = CYA-CAI-IOPC IN CYA AND
                    CAN-IIC-IOPC IN CAN = CYA-IIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               MOVE SPACES TO CYA-IND-TCYA IN CYA
               MOVE SPACES TO CYA-CAI-ICYA IN CYA
               MOVE ZEROES TO CYA-IIC-ICYA IN CYA
               GO TO NXT-FND-KEY.

           MOVE '00' TO PGM-STAT-CYA.
           MOVE CYA-IND-TCYA IN CYA TO CYA-IND-TCYA IN CAN-FLD.
           MOVE CYA-CAI-ICYA IN CYA TO CYA-CAI-ICYA IN CAN-FLD.
           MOVE CYA-IIC-ICYA IN CYA TO CYA-IIC-ICYA IN CAN-FLD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CAI-IOPC IN CAN = CYA-CAI-IOPC IN CYA AND
                    CAN-IIC-IOPC IN CAN = CYA-IIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE CYA-IND-TCYA IN CAN-FLD TO CYA-IND-TCYA IN CYA
               MOVE CYA-CAI-ICYA IN CAN-FLD TO CYA-CAI-ICYA IN CYA
               MOVE CYA-IIC-ICYA IN CAN-FLD TO CYA-IIC-ICYA IN CYA
           ELSE
               MOVE 'M'    TO CYA-IND-TCYA IN CYA
               MOVE SPACES TO CYA-CAI-ICYA IN CYA
               MOVE ZEROES TO CYA-IIC-ICYA IN CYA
               MOVE 'M'    TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD.
       NXT-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FND-RST-STAT.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       FND-RST-STAT.
           MOVE PGM-STAT-CAN TO FIO-STAT.
           IF NOT ( CAN-MSC-STAT IN CAN = 'V' OR 'L' OR 'A' )
                 GO TO FIN-FND-KEY.
           IF CAN-MSC-STAT IN CAN = 'V'
               MOVE 'CAN    VRFYA' TO MSG-COD-MENS.
           IF CAN-MSC-STAT IN CAN = 'L'
               MOVE 'CAN    LIQYA' TO MSG-COD-MENS.
           IF CAN-MSC-STAT IN CAN = 'A'
               MOVE 'CAN    ACAYA' TO MSG-COD-MENS.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           STRING MSG-GLS-DESC
                  MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND NOT = 'VRF'
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CMDINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM PRO-CYA.
           IF FRM-SUAR =  FRM-SUAR-MAL
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           MOVE 'V' TO CAN-MSC-STAT IN CAN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'CAN    VRFOK' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF

       PRO-CYA SECTION.
       INI-PRO-CYA.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CAN    NOCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      MSG-GLS-DATA DELIMITED BY SIZE
               INTO FRM-MENS
               GO TO FIN-PRO-CYA.
       LUP-PRO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               GO TO SIG-PRO-CYA.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DATA TO WSS-GLS-DAT1.
           IF WSS-GLS-DAT1 NOT > SPACES
               ADD CYA-SGV-LIQU IN CYA TO WSS-SGV-TCYA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           GO TO LUP-PRO-CYA.
       SIG-PRO-CYA.
           IF WSS-SGV-TCYA NOT = CAN-SGV-TPAG IN CAN
               MOVE WSS-SGV-TCYA TO WSS-NUM-FEDT
               MOVE CAN-SGV-TPAG IN CAN TO WSS-NUM-FALF
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CAN    TCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               STRING MSG-GLS-DESC
                      WSS-NUM-FEDT
                      MSG-GLS-DATA
                      WSS-NUM-FALF DELIMITED BY SIZE
               INTO FRM-MENS.
       FIN-PRO-CYA.
           EXIT.

       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CYA.
       FIN-GET-CUR-CYA.
           EXIT.

       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPC    MCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.


       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-CAN-REQA > SPACES
               PERFORM LEE-NXT-PRV-CAN
           ELSE
               PERFORM LEE-NXT-PRV-CIC.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-CAN SECTION.
       INI-LEE-NXT-PRV-CAN.
           MOVE SCR-CAN-REQA TO ADR-CAN-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
           IF FIO-STAT-OKS
               MOVE ADR-CAN-REQA TO SCR-CAN-REQA.
       FIN-LEE-NXT-PRV-CAN.
           EXIT.


       LEE-NXT-PRV-RCV SECTION.
       INI-LEE-NXT-PRV-RCV.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'C'                 TO RCV-IND-ICOT IN RCV.
           MOVE CAN-CAI-IOPC IN CAN TO RCV-CAI-IOPC IN RCV.
           MOVE CAN-IIC-IOPC IN CAN TO RCV-IIC-IOPC IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               MOVE 'RCVNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-RCV.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS AND 
              CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV AND
              CAN-CIC-IOPC IN CAN = RCV-CIC-IOPV IN RCV
               MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN VEN
               MOVE 'RCVSI' TO MSG-COD-MENS
               MOVE '00' TO PGM-STAT-RCV
           ELSE
               MOVE 'RCVNO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-RCV.
           EXIT.
           
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE CAN-CIC-IOPC IN CAN TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
               MOVE '00' TO PGM-STAT-ITR
           ELSE
               MOVE '23' TO PGM-STAT-ITR.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = CAN-CIC-IOPC IN CAN AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
              MOVE 'M' TO WSS-IND-MITR
           ELSE
              PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.


       LEE-NXT-PRV-CIC SECTION.
       INI-LEE-NXT-PRV-CIC.
           IF CAN-IIC-IOPC IN CAN > ZEROES
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
           IF FIO-STAT-OKS
               MOVE ADR-CAN-REQA TO SCR-CAN-REQA.
       FIN-LEE-NXT-PRV-CIC.
           EXIT.

       SET-MSG-CLTE SECTION.
       INI-SET-MSG-CLTE.
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DBC.
       FIN-SET-MSG-CLTE.
           EXIT.


       BUS-COR-CAN SECTION.
       INI-BUS-COR-CAN.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
                    CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN )
               PERFORM KEY-ALL-CAN
               MOVE ZEROES TO CAN-NUM-ICAN IN CAN.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CAN-NUM-ICAN IN CAN
               MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CAN.
           EXIT.

       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFITR.
       COPY COLBFOPC.
       COPY COLBFRCV.
       COPY COLBFROV.
       COPY COLBFVEN.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY GNSBVIDC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBPVRF.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY GNSBVCOD.
       COPY TABBVOFI.
       COPY GNSBVTAB.
       COPY GNSBGCPT.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY COLBGCLI.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
      *>>>>
*% END
