*%! Codigo adicional para programa
*% HDR_CST = FALSE
*% PGM_PTC = TRUE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
      *ISP DEBE QUEDAR PRIMERO QUE LABEL FIN_SCR_VARI DE PROG ANTIGUO
       COPY COLWGENG.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *PTC-INI:
       COPY COLMXW05.
       COPY COLMXW06.
      *PTC-FIN:

       01  WSS-VARI.
      *DAD ini 22-MAR-1991 
           03  WSS-VAL-PESO                            PIC 9(11).
      *DAD fin 22-MAR-1991 
           03  BUS-POR-KEYS             VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE             VALUE 'C'    PIC X(01).
           03  WSS-ICOR                 VALUE 0      PIC 9(01).
               88 NO-ASIGNE-CORRELATIVO VALUE 0.
           03  WSS-CIC-ICLI                          PIC X(12).
           03  REQ-POR-KEYS             VALUE SPACES PIC X(01).
           03  REQ-POR-CLTE             VALUE 'C'    PIC X(01).
      *AAA
           03  WSS-CPT-NOMB.
               05 WSS-CPT-DESC                          PIC X(40).
               05 WSS-CPT-FECS                          PIC X(12).
               05 WSS-CPT-DATA                          PIC X(60).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB  PIC X(92).
           03  WSS-OPEC                 VALUE SPACES    PIC X(08).

       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRCYA.
       COPY SGCBRDBC.
       COPY COLBRTOC.
       COPY COLBRICG.

       COPY COLWGVIN.
       COPY GNSWGCPT.
       COPY GNSWVVRF.
       COPY GNSWCVRF.
       COPY GNSWGIDC.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.

*% IF PGM_PQ
      * ISP INI  28-JAN-2004 13:37:42                                   
       77  WSS-LOGN     VALUE 'N'                PIC X(01).             
       77  WSS-DBNM     VALUE ZEROES             PIC 9(03).             
       77  WSS-DBIM     VALUE ZEROES             PIC 9(02).             
       77  WSS-DBNP     VALUE ZEROES             PIC 9(03).             
       77  WSS-DBIP     VALUE ZEROES             PIC 9(02).             
       77  WSS-BUS-BDP  VALUE 'N'                PIC X(01).             
       77  WSS-ENC-IOPE VALUE 'N'                PIC X(01).             
      * ISP FIN  28-JAN-2004 13:37:42                                   
      *>>>>
*% END
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF8 OR
                            FRM-FFLD = FRM-FFLD-PF7 ) )
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-VEN
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-VEN
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF INI_FND_KEY
      * ISP INI  28-JAN-2004 13:37:42                                   
           IF SCR-OFRM-SRV AND                                          
              SCR-CMND = 'CON'                                          
                PERFORM BUSCA-DBIM-DBIP.                                
      * ISP FIN  28-JAN-2004 13:37:42                                   
      * ISP INI  28-JAN-2004 13:37:42                                   
           IF SCR-OFRM-SRV AND                                          
              ( VEN-CAI-IOPC IN VEN-FLD > SPACES OR                     
                VEN-IIC-IOPC IN VEN-FLD > ZEROES ) AND                  
              SCR-CMND = 'CON'                                          
                 MOVE VEN-CAI-IOPC IN VEN-FLD TO                        
                      OPC-CAI-IOPC IN OPC                               
                 MOVE VEN-IIC-IOPC IN VEN-FLD TO                        
                      OPC-IIC-IOPC IN OPC                               
                 MOVE FIO-GET-KEY TO FIO-CMND                           
                 PERFORM COL-FIO-OPC                                    
                 IF NOT FIO-STAT-OKS                                    
                 IF WSS-BUS-BDP = 'N'                                   
                  MOVE 'S' TO WSS-BUS-BDP                               
                  IF WSS-DBIM > ZEROES AND                              
                     WSS-DBIP > ZEROES                                  
                       PERFORM INV-BD.                                  
      * ISP FIN  28-JAN-2004 13:37:42                                   
           PERFORM KEY-ALL-VEN.                                         
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-VEN
               GO TO CON-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-VEN
                   GO TO CON-FND-KEY
               ELSE
                   PERFORM CLR-FLD-VEN
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'VEN    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'VEN    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
           ELSE
           IF VEN-IIC-IOPC IN VEN-FLD > ZEROES
               IF VEN-NUM-IVEN IN VEN-FLD NOT > ZEROES
                   PERFORM BUS-COR-VEN
                   GO TO CON-FND-KEY
               ELSE
                   GO TO CON-FND-KEY.
       CON-FND-KEY.
      *>>>>
           IF SCR-CCPP = 'ELI'                                          
              ADD 1 TO VEN-NUM-IVEN IN VEN                              
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM COL-FIO-VEN                                       
              IF FIO-STAT-OKS                                           
                 MOVE 'VEN   SIGING' TO MSG-COD-MENS                    
                 MOVE 'COL' TO MSG-COD-SIST                             
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE '00' TO FIO-STAT                                  
                 MOVE SCR-STAT-CON TO SCR-STAT                          
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 SUBTRACT  1 FROM  VEN-NUM-IVEN IN VEN.                 
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP = 'ACT' AND NO-ASIGNE-CORRELATIVO AND
              NOT FIO-STAT-OKS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-VEN
           ELSE
               MOVE '00' TO PGM-STAT-VEN.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-OPC
               PERFORM PUT-OPC-VEN
           ELSE
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VEN    NOOPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF OPC-IND-VSTR IN OPC = 'S' AND
              SCR-CMND NOT = 'CFM'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VEN    NOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           MOVE PGM-STAT-VEN TO FIO-STAT.
*% IF PGM_PER
      *HPM Desde
      *    IF OPC-MSC-STAT IN OPC = 'F'
           IF OPC-APROBADA-CTC
               MOVE 'OPC    APDYA' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.
      *HPM Hasta
*% END
      *ALD
      *     IF NOT ( OPC-MSC-STAT IN OPC = 'L' OR 'A' )

      * RBG INI 16-APR-1996                                             
           IF OPC-APROBADA-APR                                          
      * RBG INI 12-JUN-1996                                             
              IF SCR-CMND = 'MCA'                                       
                 MOVE 'OPC    ACANO' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY                                      
              ELSE                                                      
      * RBG INI 12-JUN-1996                                             
                 MOVE 'OPC    APRYA' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
      * RBG FIN 16-APR-1996         

            IF OPC-MSC-STAT IN OPC NOT = 'A' AND
               OPC-MSC-STAT IN OPC NOT = 'D'
                IF SCR-CMND = 'MCA' OR
                   SCR-CMND = 'CFM'
                    MOVE 'OPC    ACANO' TO MSG-COD-MENS
                    GO TO SIG-FND-KEY
                ELSE
                   MOVE PGM-STAT-VEN TO FIO-STAT
                   GO TO FIN-FND-KEY.
      *     IF OPC-MSC-STAT IN OPC = 'L'
      *         MOVE 'OPC    LIQYA' TO MSG-COD-MENS.
           IF OPC-MSC-STAT IN OPC = 'A'
               IF SCR-CMND = 'MCA' OR
                  SCR-CMND = 'CFM'
                   MOVE PGM-STAT-VEN TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE 'OPC    ACAYA' TO MSG-COD-MENS.
           IF OPC-MSC-STAT IN OPC = 'D'
               MOVE 'OPC    DESYA' TO MSG-COD-MENS.
       SIG-FND-KEY.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.

               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-VEN
               MOVE FRM-CPIM-UBY TO VEN-IND-CAUT-ATR IN VEN-FLD
               MOVE  0           TO VEN-NUM-IDLC-LEN IN VEN-FLD
               MOVE -1 TO VEN-IND-CAUT-LEN IN VEN-FLD
           ELSE
               IF SCR-CMND = 'CFM'
                   PERFORM PRO-FLD-VEN
                   MOVE FRM-CPIM-UBY TO VEN-FEC-FIMV-ATR IN VEN-FLD
                   MOVE  0           TO VEN-NUM-IDLC-LEN IN VEN-FLD
                   MOVE -1 TO VEN-FEC-FIMV-LEN IN VEN-FLD
               ELSE
                   MOVE FRM-CPIM-AEY TO VEN-FEC-FIMV-ATR IN VEN-FLD.
      *>>>>
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
      *ISP ES NECESARIO TENER LOS DATOS DE LA OPERACION
      *    PARA LA VALIDACION DE CAMPOS
           MOVE VEN-CAI-IOPC IN VEN-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN VEN-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO ERR-SCR-GFLD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
*% IF PGM_PU
           MOVE ZEROES TO VEN-NUM-IEVC IN VEN.
           MOVE ZEROES TO VEN-VAL-MTSC IN VEN.
           MOVE ZEROES TO VEN-FEC-FVEN IN VEN.
           MOVE ZEROES TO VEN-FEC-FIMV IN VEN.
           MOVE ZEROES TO VEN-FEC-FTRN IN VEN.
           MOVE ZEROES TO VEN-HRA-HRTR IN VEN.
*% END
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SPACES TO VEN-GLS-FLAG IN VEN.
      *     MOVE SPACES TO VEN-IND-AINV IN VEN.
      *     MOVE SPACES TO VEN-COD-OINV IN VEN.
           MOVE ZEROES TO VEN-NUM-IEVC IN VEN.
      *     MOVE SPACES TO VEN-GLS-DISP IN VEN.
           MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVCT IN VEN.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO VEN-STP-IINV IN VEN.
      *AAA  22-MAR-1991 18:35:19 
      *    Marca campo VEN-IND-CALC de acuerdo a lo siguiente :
      *    VEN-IND-CALC = blancos si VEN-VAL-CAPI distinto de 0
      *                            y VEN-VAL-FINA distinto de 0
      *    VEN-IND-CALC = 'N'     si VEN-VAL-CAPI = 0 o VEN-VAL-FINA = 0
      *    Para ambos casos debe ser solo para tasa variable

           IF VEN-VAL-FINA IN VEN-FLD > ZEROS
               MOVE SPACES TO VEN-IND-CALC IN VEN
           ELSE
               MOVE 'N'    TO VEN-IND-CALC IN VEN.
      *AAA Fin
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF SCR-CMND = 'MCA' OR
              SCR-CMND = 'CFM'
               GO TO FIN-CMN-MOD.
           MOVE VEN-CAI-IOPC IN VEN TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN VEN TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE 'M' TO OPC-MSC-STAT IN OPC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
               MOVE VEN-CAI-IOPC IN VEN TO OPC-CAI-IOPC IN OPC
               MOVE VEN-IIC-IOPC IN VEN TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
*% IF PGM_PQ
      *            MOVE 'M' TO OPC-MSC-STAT IN OPC
                   MOVE STO-MODIFICADA IN STO-VARI
                                       TO OPC-MSC-STAT IN OPC
*% END
*% IF PGM_PU
                   MOVE 'M' TO OPC-MSC-STAT IN OPC                      
*% END
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-OPC.
      *>>>>
*% END
*% IF FIN_CMN_ELI
           MOVE VEN-CAI-IOPC IN VEN TO OPC-CAI-IOPC IN OPC.             
           MOVE VEN-IIC-IOPC IN VEN TO OPC-IIC-IOPC IN OPC.             
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM COL-FIO-OPC.                                         
           IF FIO-STAT-OKS                                              
               MOVE 'M' TO OPC-MSC-STAT IN OPC                          
               MOVE FIO-MOD TO FIO-CMND                                 
               PERFORM COL-FIO-OPC.                                     
*% END
*% IF WSS
      *<<<< WSS
       COPY COLWGPMP.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF SCR_GIKY_VAL_IKY 
      *<<<< SCR_GIKY_VAL_IKY 
      *PTC-INI:
           IF SCR-OFRM-SRV AND
              SCR-CCPP = 'ING'

              MOVE PTC-OPC-TYPE TO QUE-TYPE
              MOVE TSK-TERM-ALF TO QUE-TERM
              MOVE PTC-OPC-LENG TO QUE-LITM
              MOVE 1            TO  QUE-NITM
              MOVE QUE-GET        TO QUE-CMND
              PERFORM GNS-PRO-QUE
              IF QUE-STAT = QUE-STAT-OKS
                  MOVE QUE-ITEM TO PTC-OPC-ITEM
                  MOVE PTC-OPC-OPC-CAI-IOPC TO VEN-CAI-IOPC IN VEN-FLD
                  MOVE PTC-OPC-OPC-IIC-IOPC TO VEN-IIC-IOPC IN VEN-FLD.
      *PTC-FIN:
      *>>>>
*% END
*% IF FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-EOV.
      *>>>>
*% END
*% IF FIN_CMN_ING OR SCR_GFLD_VAL_MKY
      *<<<< FIN_CMN_ING OR SCR_GFLD_VAL_MKY
           IF FRM-FFLD = FRM-FFLD-PF10 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-EOV.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *PTC-INI:                                                         
           IF SCR-OFRM-SRV                                              
               MOVE SPACES TO SCR-VEC-ENG                               
               MOVE 1 TO SCR-IPRO.                                      
      *PTC-FIN:                                                         
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
               MOVE SPACES TO SCR-RQA2
               MOVE SPACES TO SCR-VEC-ENG
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'MSGKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
      *         MOVE 'KO33COLPAVENCOLFVENCOLAVEN' TO
      *                  WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
               MOVE 'KQ33COLPQVENCOLFVENCOLAVEN' TO
                        WSS-VEC-PPRO IN WSS-PPRO(WSS-IDX-IEOV)
               MOVE 'KU33COLPUVEN'               TO
                       WSS-VEC-PPRV IN WSS-PPRO(WSS-IDX-IEOV)
               PERFORM ING-FPEN-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF FIN_PUT_SCR 
      *<<<< FIN_PUT_SCR  
      *PTC-INI:
           MOVE SPACES TO PTC-VEN-ITEM.

           IF SCR-CMND = 'CON' AND
              SCR-OFRM-SRV

                 MOVE TSK-TERM-ALF TO QUE-TERM
                 MOVE PTC-VEN-TYPE TO QUE-TYPE
                 MOVE QUE-DEL TO QUE-CMND
                 PERFORM GNS-PRO-QUE

                 MOVE VEN-CAI-IOPC IN VEN-FLD TO VEN-CAI-IOPC IN VEN
                 MOVE VEN-IIC-IOPC IN VEN-FLD TO VEN-IIC-IOPC IN VEN
                 MOVE ZEROES                  TO VEN-NUM-IVEN IN VEN
                 MOVE ZEROES TO QUE-NITM
                 MOVE FIO-GET-NLS TO FIO-CMND.

       CIC-PTC-VEN.
           IF SCR-CMND = 'CON' AND
              SCR-OFRM-SRV
                 PERFORM COL-FIO-VEN
                 IF FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = VEN-CAI-IOPC IN VEN-FLD AND
                    VEN-IIC-IOPC IN VEN = VEN-IIC-IOPC IN VEN-FLD


                       MOVE   VEN-NUM-IVCT IN VEN TO
                          PTC-VEN-VEN-NUM-IVCT-EDT

                       MOVE   VEN-NUM-IDLC IN VEN TO
                          PTC-VEN-VEN-NUM-IDLC-EDT

                       MOVE   VEN-NUM-DIMV IN VEN TO
                          PTC-VEN-VEN-NUM-DIMV

                       MOVE   VEN-NUM-MIMV IN VEN TO
                          PTC-VEN-VEN-NUM-MIMV

                       MOVE   VEN-NUM-SIMV IN VEN TO
                          PTC-VEN-VEN-NUM-SIMV

                       MOVE   VEN-NUM-AIMV IN VEN TO
                          PTC-VEN-VEN-NUM-AIMV

                       MOVE   VEN-IND-SCBZ IN VEN TO
                          PTC-VEN-VEN-IND-SCBZ

                       MOVE   VEN-NUM-DVEN IN VEN TO
                          PTC-VEN-VEN-NUM-DVEN

                       MOVE   VEN-NUM-MVEN IN VEN TO
                          PTC-VEN-VEN-NUM-MVEN

                       MOVE   VEN-NUM-SVEN IN VEN TO
                          PTC-VEN-VEN-NUM-SVEN

                       MOVE   VEN-NUM-AVEN IN VEN TO
                          PTC-VEN-VEN-NUM-AVEN

                       MOVE   VEN-IND-SCTB IN VEN TO
                          PTC-VEN-VEN-IND-SCTB

                       MOVE   VEN-VAL-CAPI IN VEN TO
                          PTC-VEN-VEN-VAL-CAPI-EDT

                       MOVE   VEN-VAL-SCAP IN VEN TO
                          PTC-VEN-VEN-VAL-SCAP-EDT

                       MOVE   VEN-VAL-FINA IN VEN TO
                          PTC-VEN-VEN-VAL-FINA-EDT

                       MOVE   VEN-VAL-SFIN IN VEN TO
                          PTC-VEN-VEN-VAL-SFIN-EDT

                       MOVE   VEN-VAL-IDNI IN VEN TO
                          PTC-VEN-VEN-VAL-IDNI-EDT

                       MOVE   VEN-IND-CAUT IN VEN TO
                          PTC-VEN-VEN-IND-CAUT

                     MOVE SPACES TO QUE-ITEM
                     ADD 1 TO QUE-NITM
                     MOVE TSK-TERM-ALF TO QUE-TERM
                     MOVE PTC-VEN-TYPE TO QUE-TYPE
                     MOVE PTC-VEN-ITEM TO QUE-ITEM
                     MOVE PTC-VEN-LENG TO QUE-LITM
                     MOVE QUE-PUT  TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     MOVE FIO-GET-NXT TO FIO-CMND
                     GO TO CIC-PTC-VEN.

      *PTC-FIN:
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       HBL-KEY-VEN SECTION.
       INI-HBL-KEY-VEN.
           PERFORM SCR-CLRA-VEN.
           MOVE +4 TO VEN-CAI-IOPC-LEN IN VEN-FLD.
      *ALD   12-JUN-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM HBL-FLD.
           MOVE SCR-INST-GFL TO SCR-INST.
           MOVE SCR-CAI-IOPC IN SCR-VARI TO VEN-CAI-IOPC IN VEN-FLD.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO VEN-IIC-IOPC IN VEN-FLD.

      *ISP SE REQUIEREN PARA BUS-COR-VEN
           MOVE SCR-CAI-IOPC IN SCR-VARI TO VEN-CAI-IOPC IN VEN.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO VEN-IIC-IOPC IN VEN.
           PERFORM BUS-COR-VEN.

           MOVE SCR-CAI-IOPC IN SCR-VARI TO OPC-CAI-IOPC IN OPC.
           MOVE SCR-IIC-IOPC IN SCR-VARI TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-STAT TO PGM-STAT-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               PERFORM CLR-OPC-VEN
           ELSE
               PERFORM PUT-OPC-VEN.

           PERFORM EDT-KEY-VEN.
           PERFORM EDT-FLD-VEN.
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM STP-EXIT
           ELSE
               PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-HBL-KEY-VEN.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       BUS-COR-VEN SECTION.
       INI-BUS-COR-VEN.
           MOVE 999 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN-FLD = VEN-CAI-IOPC IN VEN AND
                    VEN-IIC-IOPC IN VEN-FLD = VEN-IIC-IOPC IN VEN )
               PERFORM KEY-ALL-VEN
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO VEN-NUM-IVEN IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVEN IN VEN-FLD
               MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVCT IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVCT IN VEN-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-VEN.
           EXIT.

       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-VEN
           ELSE
               PERFORM LEE-NXT-PRV-CIC.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-VEN SECTION.
       INI-LEE-NXT-PRV-VEN.
           MOVE SCR-RQA1 TO ADR-VEN-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-VEN
               MOVE ADR-VEN-REQA TO SCR-RQA1.
       FIN-LEE-NXT-PRV-VEN.
           EXIT.

       LEE-NXT-PRV-CIC SECTION.
       INI-LEE-NXT-PRV-CIC.
           IF VEN-CIC-IOPC IN VEN > SPACES AND
              VEN-NUM-IVEN IN VEN > ZEROES
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-VEN
               MOVE ADR-VEN-REQA TO SCR-RQA1.
       FIN-LEE-NXT-PRV-CIC.
           EXIT.


       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFCYA.
       COPY COLBGEOV.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY TABBVOFI.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBPFEC.
       COPY GNSBGCPT.
       COPY GNSBEGLS.
       COPY SGCBGCLI.
       COPY COLBFTOC.
       COPY COLBFICG.
       COPY SGCBFDBC.
       COPY COLBGTOC.
       COPY COLBGVIN.
      *>>>>
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO VEN-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO VEN-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-VEN.
           MOVE SCR-MENS-EXT TO VEN-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC-INI-AUT                                                     
           IF NOT SCR-OFRM-SRV                                          
      * PTC-FIN-AUT                                                     
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC-INI-AUT                                                     
           IF NOT SCR-OFRM-SRV                                          
      * PTC-FIN-AUT                                                     
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC-INI-AUT                                                     
           IF NOT SCR-OFRM-SRV                                          
      * PTC-FIN-AUT                                                     
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE VEN-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       PRO-FLD-VEN SECTION.
       INI-PRO-FLD-VEN.
           PERFORM PRO-OPC-VEN.
           PERFORM PRO-VEN-VEN.
       FIN-PRO-FLD-VEN.
           EXIT.
       
       PRO-OPC-VEN SECTION.
       INI-PRO-OPC-VEN.
       FIN-PRO-OPC-VEN.
           EXIT.
       
       PRO-VEN-VEN SECTION.
       INI-PRO-VEN-VEN.
           MOVE FRM-CPIM-AEY TO VEN-NUM-IDLC-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-FEC-FVEN-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-CAPI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-FEC-FIMV-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-SCTB-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-IDNI-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-SCBZ-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-FINA-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-IND-CAUT-ATR IN VEN-FLD.
           MOVE FRM-CPIM-AEY TO VEN-VAL-SFIN-ATR IN VEN-FLD.
       FIN-PRO-VEN-VEN.
           EXIT.
      *>>>>                                                             
                                                                        
      * ISP INI  28-JAN-2004 13:37:42                                   
       BUSCA-DBIM-DBIP SECTION.                                         
       INI-BUSCA-DBIM-DBIP.                                             
           MOVE 'COL'  TO IDD-SAUX.                                     
           MOVE 'M'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
               GO TO DBM-BUSCA-DBIM-DBIP                                
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               MOVE IDD-IENT( IDD-ITBL) TO WSS-DBNM                     
               MOVE IDD-IAUX            TO WSS-DBIM                     
               GO TO CON-BUSCA-DBIM-DBIP.                               
       DBM-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNM.                                          
           MOVE 0 TO WSS-DBIM.                                          
       CON-BUSCA-DBIM-DBIP.                                             
           MOVE 'COL'  TO IDD-SAUX.                                     
           MOVE 'P'    TO IDD-GAUX.                                     
           MOVE SPACES TO IDD-RAUX.                                     
           MOVE 1 TO IDD-IAUX.                                          
           SET IDD-ITBL TO 1.                                           
           SEARCH IDD-VSIS VARYING IDD-IAUX                             
             AT END                                                     
               GO TO DBP-BUSCA-DBIM-DBIP                                
             WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX                       
               MOVE IDD-IENT( IDD-ITBL) TO WSS-DBNP                     
               MOVE IDD-IAUX            TO WSS-DBIP                     
               GO TO FIN-BUSCA-DBIM-DBIP.                               
       DBP-BUSCA-DBIM-DBIP.                                             
           MOVE 0 TO WSS-DBNP.                                          
           MOVE 0 TO WSS-DBIP.                                          
       FIN-BUSCA-DBIM-DBIP.                                             
           EXIT.                                                        
                                                                        
       INV-BD SECTION.                                                  
       INI-INV-BD.                                                      
                                                                        
           MOVE WSS-DBNM TO IDD-IENT( WSS-DBIP ).                       
           MOVE WSS-DBNP TO IDD-IENT( WSS-DBIM ).                       
                                                                        
       FIN-INV-BD.                                                      
           EXIT.                                                        
                                                                        
      * ISP FIN  28-JAN-2004 13:37:42                                   
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       PUT-OPC-VEN SECTION.
       INI-PUT-OPC-VEN.
      *<<<< INI_PUT_OPC_VEN
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-VEN
               GO TO FIN-PUT-OPC-VEN.
      *>>>>
           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-VEN.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-VEN
               GO TO FIN-PUT-OPC-VEN.
           MOVE OPC-MSC-TVOC IN OPC TO OPC-MSC-TVOC IN VEN-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN VEN-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN VEN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN VEN-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF OPC-MSC-TVOC IN VEN-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN VEN-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TVOC IN VEN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN VEN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN VEN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN VEN-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN VEN-FLD > SPACES
               MOVE OPC-COD-OFOC IN VEN-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN VEN-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN VEN-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN VEN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN VEN-FLD.
       FIN-PUT-OPC-VEN.
           EXIT.
      *>>>>
*% END
*% IF INI_HBL_IKY
      *<<<< INI_HBL_IKY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.                           
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           MOVE '1' TO FRM-CPIM-AEY.      
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-VEN.
      *>>>>
*% END
*% IF INI_HBL_KEY
      *<<<< INI_HBL_KEY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.                           
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           MOVE '1' TO FRM-CPIM-AEY.      
      *>>>>
*% END
