*%! Codigo adicional para archivo
*% IF FIN_PUT_ALL_CAN
      *<<<< FIN_PUT_ALL_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF ITR-COD-TINT IN ITR > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-IITR IN CAN-FLD.
      *>>>>
*% END
*% IF FIN_PUT_OPC_CAN
      *<<<< FIN_PUT_OPC_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-AOOC IN CAN-FLD > SPACES
               MOVE 'COL'                    TO TAB-COD-SIST
               MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN CAN-FLD  TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN CAN-FLD  TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN CAN-FLD.
           MOVE OPC-COD-VCOC IN OPC TO SCR-COD-VCOC.
      *>>>>
*% END
*% IF FIN_PUT_CAN_CAN
      *<<<< FIN_PUT_CAN_CAN
      *BUS-TAB busca glosa de codigo en tabla
           IF CAN-MSC-STAT IN CAN-FLD > SPACES
               MOVE 'GNS'                   TO TAB-COD-SIST
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-STAT IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO FRM-GLS-STAT IN CAN-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_CAN
      *<<<< FIN_PUT_DBC_CAN
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CAN-FLD.
      *>>>>
*% END
*% IF FIN_PUT_ROV_CAN
      *<<<< FIN_PUT_ROV_CAN
           MOVE ROV-CAI-IOPC IN ROV TO SCR-ROV-CAI-IOPC.
           MOVE ROV-IIC-IOPC IN ROV TO SCR-ROV-IIC-IOPC.
      *>>>>
*% END
*% IF FIN_PUT_ICG_CAN
      *<<<< FIN_PUT_ICG_CAN
      *DAD ini  10-SEP-1992   (Memo.26-05-92 Pto.3)
           MOVE 'N' TO WSS-IBLK-TINT IN WSS-VARI.
      *DAD fin  10-SEP-1992
      *>>>>
*% END
*% IF INI_PUT_CYA_CAN
      *<<<< INI_PUT_CYA_CAN
           IF SCR-CYA-IND-MCYA = 'M'
               MOVE 'M'         TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES      TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES      TO CYA-IIC-ICYA IN CAN-FLD
               MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-PUT-CYA-CAN.
      *>>>>
*% END
*% IF VEN_NUM_IVCT
      *<<<< VEN_NUM_IVCT
           MOVE VEN-NUM-IVCT IN CAN-FLD TO VEN-NUM-IVEN IN CAN-FLD.
      *>>>>
*% END
*% IF CAN_COD_RCAN
      *<<<< CAN_COD_RCAN
           IF  CAN-COD-RCAN IN CAN-FLD NOT > SPACES
                MOVE OPC-COD-RMOC IN OPC TO CAN-COD-RCAN IN CAN-FLD.
      *>>>>
*% END
*% IF CAN_MSC_CANC
      *<<<< CAN_MSC_CANC
      *LRH ini 31-MAR-1994 
           IF CAN-MSC-CANC IN CAN-FLD = 'CIE' OR 'PTT'
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.3)
               IF OPC-IND-VSTR IN OPC = 'S' 
      *DAD fin  07-JUL-1994
                   MOVE CAN-CAI-IOPC IN CAN-FLD TO EVC-CAI-IOPC IN EVC
                   MOVE CAN-IIC-IOPC IN CAN-FLD TO EVC-IIC-IOPC IN EVC
                   MOVE 1                       TO EVC-NUM-IEVC IN EVC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-EVC
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL'         TO MSG-COD-SIST
                       MOVE 'EVC    NOEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CAN-MSC-CANC
                   ELSE
                       MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
                       MOVE 'CVC'          TO TAB-CIC-TTAB IN TAB
                       MOVE 'FP'           TO TAB-CIC-CTAB IN TAB
                       MOVE FIO-GET-KEY    TO FIO-CMND
                       MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                       PERFORM GNS-FIO-TAB
                       IF NOT FIO-STAT-OKS
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE 'CIC    FPNEX' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE FRM-SUAR-MAL TO FRM-SUAR
                           GO TO FIN-VAL-CAN-MSC-CANC
                       ELSE
                           IF EVC-MSC-TCVE IN EVC = TAB-COD-CTAB IN TAB
                               MOVE 'COL'          TO MSG-COD-SIST
                               MOVE 'MSCCANC NOFP' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE FRM-SUAR-MAL TO FRM-SUAR
                               GO TO FIN-VAL-CAN-MSC-CANC.
      *LRH fin 31-MAR-1994 
      *>>>>
*% END
*% IF ROV_CAI_IOPC
      *<<<< ROV_CAI_IOPC
      *ISP SCR-MSC-TCAN SERA USADO EN VALIDACION DE CONSISTENCIA
           MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-CANC.
      *>>>>
*% END
*% IF ROV_IIC_IOPC
      *<<<< ROV_IIC_IOPC
           IF ROV-CAI-IOPC IN CAN-FLD     > SPACES AND
              ROV-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CICIOPCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF CAN_FEC_FOUT
      *<<<< CAN_FEC_FOUT
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO CAN-NUM-DOUT IN CAN-FLD.
           MOVE HOY-MHOY TO CAN-NUM-MOUT IN CAN-FLD.
           MOVE HOY-SHOY TO CAN-NUM-SOUT IN CAN-FLD.
           MOVE HOY-AHOY TO CAN-NUM-AOUT IN CAN-FLD.
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)
           MOVE HOY-DHOY TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE HOY-SHOY TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ACTB IN WSS-VARI.
       BUS-DIA-HBL-PRV.
      *RST-DIA Retrocede 1 dia la Fecha
           MOVE WSS-NUM-DCTB IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MCTB IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SCTB IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-ACTB IN WSS-VARI TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAN-FEC-FOUT.
           MOVE FEC-ITM1 TO WSS-NUM-DCTB IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MCTB IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SCTB IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-ACTB IN WSS-VARI.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
                GO TO BUS-DIA-HBL-PRV.
      *DAD fin  19-FEB-1993
      *>>>>
*% END
*% IF INI_CAN_FEC_FCAN
      *<<<< INI_CAN_FEC_FCAN
           IF CAN-FEC-FCAN IN CAN-FLD NOT > ZEROES
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FCAN IN CAN-FLD
                                               FEC-FECH.
      *>>>>
*% END
*% IF CAN_FEC_FCAN
      *<<<< CAN_FEC_FCAN
           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN.
       LEE-NXT-CAN.
           SUBTRACT 1 FROM CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
               IF CAN-MSC-STAT IN CAN NOT = 'R' AND
                  CAN-SGV-TPAG IN CAN NOT < ZEROES AND
                  CAN-SGV-TREN IN CAN NOT < ZEROES
                   MOVE CAN-NUM-SCAN IN CAN     TO FEC-SEC1
                   MOVE CAN-NUM-ACAN IN CAN     TO FEC-AEC1
                   MOVE CAN-NUM-MCAN IN CAN     TO FEC-MEC1
                   MOVE CAN-NUM-DCAN IN CAN     TO FEC-DEC1
                   MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC            TO FEC-FORM
                   MOVE FEC-CMP-FEC             TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'COL'         TO MSG-COD-SIST
                       MOVE 'FECFCANANT>' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CAN-FEC-FCAN
                   ELSE
                       NEXT SENTENCE
               ELSE
                   GO TO LEE-NXT-CAN.

           IF CAN-FEC-FCAN IN CAN-FLD > ZEROES
               MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC1
               MOVE OPC-NUM-SCOL IN OPC     TO FEC-SEC2
               MOVE OPC-NUM-ACOL IN OPC     TO FEC-AEC2
               MOVE OPC-NUM-MCOL IN OPC     TO FEC-MEC2
               MOVE OPC-NUM-DCOL IN OPC     TO FEC-DEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-CMP-FEC             TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-LES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFCANFCOL<' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CAN-FEC-FCAN.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DAUX IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MAUX IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SAUX IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-AAUX IN WSS-VARI.
      *DAD fin  19-FEB-1993
      *>>>>
*% END
*% IF FRM_SGV_TINT
      *<<<< FRM_SGV_TINT
      *     IF FRM-SGV-TINT IN CAN-FLD < ZEROES
      *         MOVE 'GNS' TO MSG-COD-SIST
      *         MOVE 'NUM    >CERO' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF ICG_SGV_TINT
      *<<<< ICG_SGV_TINT
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
      *     IF CAN-FEC-FCAN IN CAN < VEN-FEC-FIMV IN VEN
      *         MOVE 'N' TO WSS-IBLK-TINT.
      *>>>>
*% END
*% IF CAN_COD_OFCA
      *<<<< CAN_COD_OFCA
           IF OPC-COD-OFOC IN CAN-FLD = CAN-COD-OFCA IN CAN-FLD AND
              SCR-CMND = 'COF'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CODOFOCOFCA=' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-COD-OFCA.
      *>>>>
*% END
*% IF CAN_SGV_GAST
      *<<<< CAN_SGV_GAST
           IF CAN-SGV-GAST IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-GAST IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-GAST 
                                                      IN CAN-FLD.
      *>>>>
*% END
*% IF CAN_SGV_TREN
      *<<<< CAN_SGV_TREN
           IF CAN-SGV-TREN IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF CAN-SGV-TREN IN CAN-FLD > ZEROES
               MOVE CAN-SGV-TREN IN CAN-FLD TO WSS-SGV-TREN.
      *>>>>
*% END
*% IF CAN_SGV_TPAG
      *<<<< CAN_SGV_TPAG
           IF CAN-SGV-TPAG IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAN-SGV-TPAG.
           IF WSS-CIC-TVAL = '0'
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG
                                                      IN CAN-FLD.
      *>>>>
*% END
*% IF CYA_IND_TCYA
      *<<<< CYA_IND_TCYA
      *    NO OBLIGATORIO
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-IND-TCYA IN CAN-FLD
               MOVE SPACES TO FRM-GLS-TCYA IN CAN-FLD
               GO TO FIN-VAL-CYA-IND-TCYA.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MCYAC' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
                   MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
                   MOVE 'MULTIPLES' TO FRM-GLS-TCYA IN CAN-FLD
                   GO TO FIN-VAL-CYA-IND-TCYA
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MCYAC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CYA-IND-TCYA.
      *DAD ini  18-JUN-1993   (Memo.18-06-93)
      *DAD ini  16-JUN-1993   (Memo.08-06-93 Pto.1)
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-CYA-IND-TCYA.

      *     IF CAN-FEC-FCAN IN CAN-FLD = CAN-FEC-FOUT IN CAN-FLD AND
           IF WSS-FEC-FAUX IN WSS-VARI = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(8) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANONORCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.

      *     IF CAN-FEC-FCAN IN CAN-FLD NOT = CAN-FEC-FOUT IN CAN-FLD AND
           IF WSS-FEC-FAUX IN WSS-VARI NOT = HOY-FHOY IN HOY-VARI AND
              MSC-COD-DAT1 IN MSC(9) = 'N'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'TCYANORETCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CYA-IND-TCYA.
      *DAD fin 18-JUN-1993 / 16-JUN-1993
      *>>>>
*% END
*% IF FRM_GLS_TCYA
      *<<<< FRM_GLS_TCYA
           MOVE MSC-COD-DAT1 IN MSC(3) TO WSS-GLS-DAT1.
      *ISP WSS-GLS-DAT1 SERA USADO EN VALIDACION DE CONSISTENCIA
      *>>>>
*% END
*% IF CYA_CAI_ICYA
      *<<<< CYA_CAI_ICYA
           IF CYA-CAI-ICYA IN CAN-FLD NOT > SPACES
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD.
           IF CYA-IND-TCYA IN CAN-FLD = 'M'
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               GO TO FIN-VAL-CYA-CAI-ICYA.
      *>>>>
*% END
*% IF RCV_SGV_CAPI
      *<<<< RCV_SGV_CAPI
           IF RCV-SGV-CAPI IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF RCV_SGV_FINA
      *<<<< RCV_SGV_FINA
           IF RCV-SGV-FINA IN CAN-FLD < ZEROES
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'NUM    >CERO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CAN
      *<<<< INI_VAL_CON_KEY_CAN
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CAN.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CAN
      *<<<< FIN_VAL_CON_KEY_CAN
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_CAN
      *<<<< FIN_VAL_CON_IKY_CAN
           IF CAN-IIC-IOPC IN CAN-FLD NOT > ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_CAN
      *<<<< VAL_CON_FLD_CAN
           MOVE SPACES TO SCR-RCV-STAT.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *JSS
           MOVE SPACES TO MSG-COD-MENS.
           IF CAN-MSC-CANC IN CAN-FLD = 'ATT'
               IF OPC-IND-RENO IN OPC > SPACES
                   MOVE 'CANATT RENO' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAN-MSC-CANC IN CAN-FLD = 'QTT'
               IF OPC-IND-RENO IN OPC NOT = 'PRO'
                   MOVE 'CANQTT PRO<>' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAN-MSC-CANC IN CAN-FLD = 'STT'
               IF OPC-IND-RENO IN OPC NOT = 'REN'
                   MOVE 'CANQTT REN<>' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAN-MSC-CANC IN CAN-FLD = 'OTT'
               IF OPC-IND-RENO IN OPC NOT = 'NOV'
                   MOVE 'CANQTT NOV<>' TO MSG-COD-MENS.

           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAN.
      *
      *DAD ini  12-NOV-1992
      *     IF SCR-CMND NOT = 'ING'
      *         MOVE CAN-NUM-ICAN IN CAN-FLD TO CAN-NUM-ICAN IN CAN
      *         PERFORM GET-CUR-ICG
      *         IF PGM-STAT-ICG-OKS
      *             IF ICG-COD-TINT IN ICG = 'TIPE'
      *                 MOVE '1' TO FRM-IND-TIPE IN CAN-FLD.
      *DAD fin  12-NOV-1992

           IF SCR-CMND = 'COF'
               GO TO FIN-VAL-CON-FLD-CAN.

      * BUSCA DATO 'COMO OPERA=WSS-OPEC'
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE TOC-COD-TOCR IN TOC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAN.
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.

      * NO ACEPTA ABONOS PARCIALES PARA BOLETAS DE GARANTIA
           IF ( SCR-MSC-FCAN = 'I' OR 'P' OR 'C' ) AND WSS-OPEC = 'B'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'MSCFCANIPCBG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-CAN.

      *ISP NO ACEPTA DIGITACION DE OPERACION PARA PRORROGA O
      *    NOVACION PARA INGRESO
           IF SCR-MSC-TCAN = 'C' AND
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'ROVCANCINV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.

           IF SCR-MSC-TCAN = 'N' AND
              SCR-CMND = 'ING' AND
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )
                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'ROVIOPCNOV0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.

           IF SCR-MSC-TCAN = 'P' AND
              SCR-CMND = 'ING' AND
              ( ROV-CAI-IOPC IN CAN-FLD > SPACES OR
                ROV-IIC-IOPC IN CAN-FLD > ZEROES )
                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'ROVIOPCPRG0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.

           IF ( SCR-MSC-TCAN = 'R' OR 'P' ) AND
                ROV-IIC-IOPC IN CAN-FLD > ZEROES
                 MOVE ROV-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC
                 MOVE ROV-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM COL-FIO-OPC
      *ISP LA OPERACION NO PUEDE ESTAR ACTIVADA
                 IF FIO-STAT-OKS AND
                    OPC-MSC-STAT IN OPC = 'A'
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'OPCSTAT INVA' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO END-VAL-CON-FLD-CAN
                 ELSE
      *DAD ini  05-NOV-1992   (Memo.09-10-92)
                     MOVE CAN-CAI-IOPC IN CAN-FLD TO OPC-CAI-IOPC IN OPC
                     MOVE CAN-IIC-IOPC IN CAN-FLD TO OPC-IIC-IOPC IN OPC
                     MOVE FIO-GET-KEY TO FIO-CMND
                     PERFORM COL-FIO-OPC
                     IF NOT FIO-STAT-OKS
                         MOVE 'COL'        TO MSG-COD-SIST
                         MOVE 'OPC    NEX' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC TO FRM-MENS
                         MOVE FRM-SUAR-MAL TO FRM-SUAR
                         GO TO END-VAL-CON-FLD-CAN
                     ELSE
      *DAD fin  05-NOV-1992
      *ISP DEBE EXISTIR AL MENOS UN ROV
                      MOVE ROV-CAI-IOPC IN CAN-FLD TO
                           ROV-CAI-IOPC IN ROV
                      MOVE ROV-IIC-IOPC IN CAN-FLD TO
                           ROV-IIC-IOPC IN ROV
                      MOVE LOW-VALUES TO ROV-KEY-IVCT IN ROV
                      MOVE FIO-GET-NLS TO FIO-CMND
                      PERFORM COL-FIO-ROV
                      IF NOT ( FIO-STAT-OKS               AND
                               ROV-CAI-IOPC IN CAN-FLD =
                               ROV-CAI-IOPC IN ROV        AND
                               ROV-IIC-IOPC IN CAN-FLD =
                               ROV-IIC-IOPC IN ROV )
                                MOVE 'COL'          TO MSG-COD-SIST
                                MOVE 'REN    NOROV' TO MSG-COD-MENS
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                MOVE FRM-SUAR-MAL TO FRM-SUAR
                                GO TO END-VAL-CON-FLD-CAN.

      * RESTA LOS GASTOS
           IF SCR-MSC-TCAN = 'C'
                SUBTRACT CAN-SGV-GAST IN CAN-FLD FROM 
                         CAN-SGV-TPAG IN CAN-FLD
                IF CAN-SGV-TPAG IN CAN-FLD < ZEROES
                     MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD.

           IF SCR-MSC-TCAN NOT = 'C'
                SUBTRACT CAN-SGV-GAST IN CAN-FLD FROM 
                         CAN-SGV-TREN IN CAN-FLD
                IF CAN-SGV-TREN IN CAN-FLD < ZEROES
                     MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.

           IF SCR-MSC-TCAN = 'C'
               MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD.

           MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.

           PERFORM GET-SLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAN.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO WSS-NUM-DCAN IN WSS-VARI.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO WSS-NUM-MCAN IN WSS-VARI.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO WSS-NUM-SCAN IN WSS-VARI.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO WSS-NUM-ACAN IN WSS-VARI.

           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.
      *ALD/27-SEP-1990
      *   Inconsistencia forma de cargar fecha de vencimiento pues
      *   Existe campo WSS_CMP_FVEN.....se debe corregir....
           IF WSS-CMP-FCAN IN WSS-VARI < WSS-CMP-FIMV IN WSS-VARI
               MOVE 'A' TO RCV-MSC-MCAN IN CAN-FLD
           ELSE
           IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI
               MOVE 'V' TO RCV-MSC-MCAN IN CAN-FLD
           ELSE
               MOVE 'F' TO RCV-MSC-MCAN IN CAN-FLD.
      *ALD/24-MAY-1990
      *
           PERFORM LEE-REG-TCAN.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO SCR-COD-TICG.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF WSS-CMP-FCAN < WSS-CMP-FIMV 
              IF WSS-IBLK-TINT = 'S'
                  MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD
                  MOVE SPACES TO FRM-GLS-TINT IN CAN-FLD
              ELSE
                  IF ICG-SGV-TINT IN CAN-FLD > FRM-SGV-TINT IN CAN-FLD
                      MOVE 'COL'          TO MSG-COD-SIST
                      MOVE 'CANTASD>TASC' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      GO TO END-VAL-CON-FLD-CAN.
      *ISP 25-JAN-1990 
           MOVE VEN-NUM-DVEN IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.
           IF WSS-CMP-FCAN = WSS-CMP-FIMV AND
              ( SCR-MSC-ECAN  NOT = 'T'  OR
                OPC-NUM-VCOR IN OPC = 1 )
                MOVE ZEROES TO ICG-SGV-TINT IN CAN-FLD.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO WSS-NUM-DIMV IN WSS-VARI.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO WSS-NUM-MIMV IN WSS-VARI.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO WSS-NUM-SIMV IN WSS-VARI.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO WSS-NUM-AIMV IN WSS-VARI.

           IF ITR-COD-CVTI IN ITR > SPACES AND
      *DAD ini  27-SEP-1993   (Memo. Producto Nuevo 'FP')
              SCR-MSC-FCAN    NOT = 'T'    AND
              VEN-IND-CALC IN VEN = 'N'
      *DAD fin  27-SEP-1993
               MOVE 'CANPARCINTV' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO PRO-MSG-MAL.          
      *
           MOVE 0 TO SCR-SGV-IPFC.
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
      *ALD/ Procesa tipo de cancelacion CTE.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
               PERFORM PRO-TCAN-CTE.
      *
      *ALD/Procesa tipo de cancelacion CTT.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               PERFORM PRO-TCAN-CTT.
      *
      *ALD/Procesa codigo CIE
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'I' AND 
              SCR-MSC-ECAN = 'E' 
               PERFORM PRO-TCAN-CIE.
      *
      *ALD/Procesa codigo CPE
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'P' AND 
              SCR-MSC-ECAN = 'E' 
               PERFORM PRO-TCAN-CPE.
       PRO-MSG-MAL.
      *
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               GO TO END-VAL-CON-FLD-CAN.

      *CONVIERTE A PESOS EL INTERES PAGADO A FCAN
           MULTIPLY SCR-SGV-IPFC BY SCR-SGV-VCAM
                             GIVING SCR-SGV-IPFC ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE SCR-SGV-IPFC TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO SCR-SGV-IPFC.
      *
       CON-VLD-FLD-SEC.
      *ISP NO PERMITE MODIFICAR CODIGOS DE CANCELACION, 
      *    PARA CANCELACIONES YA CREADAS
           IF SCR-CCPP = 'MOD' OR
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )

               IF SCR-MSC-TCAN = 'C' AND
                  SCR-MSC-TCNC = 'C'
                    GO TO CHG-CAN
               ELSE
               IF SCR-MSC-CANC NOT = SCR-MSC-CCNC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'MSCCANCNOMOD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       CHG-CAN.
      *DAD ini  19-FEB-1993   (Memo.14-10-92 Pto.1)
           IF CAN-FEC-FOUT IN CAN-FLD = CAN-FEC-FCAN IN CAN-FLD
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI = WSS-FEC-FAUX IN WSS-VARI
               MOVE CAN-FEC-FOUT IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD
           ELSE
           IF WSS-FEC-FCTB IN WSS-VARI > WSS-FEC-FAUX IN WSS-VARI
               MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD.
      *     IF CAN-FEC-FEGR IN CAN-FLD NOT > ZEROES
      *         MOVE CAN-FEC-FCAN IN CAN-FLD TO CAN-FEC-FEGR IN CAN-FLD
      *     ELSE
      *         MOVE CAN-FEC-FEGR IN CAN-FLD TO FEC-FEC1
      *         MOVE CAN-FEC-FCAN IN CAN-FLD TO FEC-FEC2
      *         MOVE FEC-FORM-FEC TO FEC-FORM
      *         MOVE FEC-CMP-FEC TO FEC-CMND
      *         PERFORM PRO-FEC
      *         IF FEC-STAT-LES
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             MOVE 'COL'          TO MSG-COD-SIST
      *             MOVE 'FECFEGRFCAN<' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             GO TO END-VAL-CON-FLD-CAN.
      *DAD fin  19-FEB-1993

           IF ( SCR-MSC-TCAN = 'R' OR '1' )
               PERFORM VAL-CON-ROV
               PERFORM RET-CAN-CAN
               PERFORM RET-ROV-CAN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO END-VAL-CON-FLD-CAN.

      *ISP I.- CANCELACIONES
      *ISP PARA UNA CANCELACION : ==> BORRAR VALOR RENOVADO

      *ISP 'CTT' O 'CTE' CON VALOR PAGADO EN CERO
      *ISP CUANTO DEBO PAGAR ?
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T' AND
              CAN-SGV-TPAG IN CAN-FLD NOT > ZEROES AND
              WSS-IBLK-TPAG  = 'S'
                IF SCR-MSC-ECAN = 'T'
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD
                ELSE
                IF SCR-MSC-ECAN = 'E'
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TPAG IN CAN-FLD.

      *ISP 'CTT' O 'CTE' CON VALOR PAGADO MAYOR QUE CERO
      *ISP PAGO ESA CANTIDAD, POSIBLE DIFERENCIA
           PERFORM ABS-TPAG.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-FCAN = 'T' 
      *         IF CAN-SGV-TPAG IN CAN-FLD > ZEROES
                   IF SCR-MSC-ECAN = 'T' OR 'E'
                       SUBTRACT WSS-VAL-SVEN FROM WSS-SGV-TPAG GIVING
                                              CAN-SGV-DIFE IN CAN-FLD.

           IF ( CAN-SGV-DIFE IN CAN-FLD NOT = ZEROS ) AND
              ( SCR-CMND NOT = 'IVP' ) AND ( SCR-CMND NOT = 'MVP' )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'NODEBEIRTPAG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN.
                   
      *DAD ini  21-ABR-1993 / 19-FEB-1993   (Memo.05-11-92 Pto.1)
           IF WSS-VAL-SVEN < WSS-VAL-SCAP AND
              WSS-OPEC NOT = 'B'
               IF NOT ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CANTIPEDESC>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
      *            IF ( SCR-CMND = 'IVP' OR SCR-CMND = 'MVP' )
                   IF ( SCR-MSC-TCAN = 'C' ) AND
                      ( SCR-MSC-FCAN = 'T' ) AND
                      ( SCR-MSC-ECAN = 'T' OR 'E' )
                       SUBTRACT WSS-VAL-SVEN FROM WSS-VAL-SCAP
                                      GIVING CAN-SGV-DIFE IN CAN-FLD.
      *DAD fin  21-ABR-1993 / 19-FEB-1993

      *ISP PARA CANCELACION PARCIAL CON FORMA CANCELACION 'P' O 'I' O 'C'
      *ISP EXIGE VALOR PAGADO
           IF SCR-MSC-TCAN = 'C' AND
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C' ) AND
                CAN-SGV-TPAG IN CAN-FLD NOT > ZEROES AND
                WSS-IBLK-TPAG = 'S'
                  MOVE 'COL'          TO MSG-COD-SIST
                  MOVE 'MSCFCANTPAGP' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO END-VAL-CON-FLD-CAN.

      *ISP II.- RENOVACIONES
      *ISP CALCULOS
      *ISP RENOVACION TOTAL ==> V.P. <> 0 ==> CALCULO V.R.
      *                         V.R. <> 0 ==> CALCULO V.P.
      *ISP TIENE PRIORIDAD EL VALOR PAGADO

           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
                SCR-MSC-FCAN = 'T'
                 IF CAN-SGV-TPAG IN CAN-FLD > ZEROES
                     IF SCR-MSC-ECAN = 'T'
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT
                         IF (CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT'
                                                   OR   'OTT') AND
                            (CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC)
                            IF CAN-SGV-TPAG IN CAN-FLD <
                               OPC-VAL-SCRE IN OPC
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM
                                 OPC-VAL-SCRE IN OPC GIVING
                                 CAN-SGV-TREN IN CAN-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                        ELSE
      *JSS - FIN
                            IF CAN-SGV-TPAG IN CAN-FLD < WSS-VAL-SVEN
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAN-SGV-TREN IN CAN-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                            IF CAN-SGV-TPAG IN CAN-FLD = WSS-VAL-SVEN
                               AND WSS-OPEC = 'B'
                                 MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD
                                 GO TO CON-VAL-CON-FLD-CAN
                            ELSE
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                     ELSE
                     IF SCR-MSC-ECAN = 'E'
                            IF CAN-SGV-TPAG IN CAN-FLD < WSS-VAL-SVEN
                                 SUBTRACT CAN-SGV-TPAG IN CAN-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAN-SGV-TREN IN CAN-FLD
                                 MOVE ZEROES TO WSS-SGV-TREN
                            ELSE
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTPAGSVEN>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                     ELSE
                            NEXT SENTENCE
                 ELSE
                 IF CAN-SGV-TREN IN CAN-FLD > ZEROES
                     IF SCR-MSC-ECAN = 'T'
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT
                         IF (CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT'
                                                   OR   'OTT') AND
                            (CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC)
                            IF CAN-SGV-TREN IN CAN-FLD >
                               OPC-VAL-SCRE IN OPC
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENLIQU>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                            ELSE
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM
                                 OPC-VAL-SCRE IN OPC GIVING
                                 CAN-SGV-TPAG IN CAN-FLD
                         ELSE
      *JSS - FIN
                            IF CAN-SGV-TREN IN CAN-FLD > WSS-VAL-SVEN
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENSCRE>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                            ELSE
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAN-SGV-TPAG IN CAN-FLD
                     ELSE
                     IF SCR-MSC-ECAN = 'E'
                            IF CAN-SGV-TREN IN CAN-FLD > WSS-VAL-SVEN
                                 MOVE 'COL'          TO MSG-COD-SIST
                                 MOVE 'SGVTRENSVEN>' TO MSG-COD-MENS
                                 PERFORM GET-MSG
                                 MOVE MSG-GLS-DESC TO FRM-MENS
                                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                                 GO TO END-VAL-CON-FLD-CAN
                            ELSE
                                 SUBTRACT CAN-SGV-TREN IN CAN-FLD FROM
                                 WSS-VAL-SVEN GIVING
                                 CAN-SGV-TPAG IN CAN-FLD.

      *ISP RENOVACIONES CON VALOR RENOVADO EN CERO
      *ISP CUANTO DEBO RENOVAR ?
           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
              SCR-MSC-FCAN = 'T' AND
              CAN-SGV-TREN IN CAN-FLD = ZEROES
                MOVE ZEROES TO CAN-SGV-TPAG IN CAN-FLD
                IF SCR-MSC-ECAN = 'T'
      *JSS 20-AUG-1991 17:46:36 PARA MANEJAR ANULACION DE PTT,RTT,NTT
                    IF ( CAN-MSC-CANC IN CAN-FLD = 'QTT' OR 'STT' OR
                                                            'OTT' ) AND
                       ( CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC )
                       MOVE OPC-VAL-SCRE IN OPC TO CAN-SGV-TREN
                                                IN CAN-FLD
                    ELSE
      *JSS-FIN
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN-FLD
                ELSE
                IF SCR-MSC-ECAN = 'E'
                       MOVE WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN-FLD.

       CON-VAL-CON-FLD-CAN.
      *DAD ini  27-JUL-1994   (Minu.05-01-93 Pto.1)
           IF CAN-MSC-CANC IN CAN-FLD = 'PTT' OR 'PTE'
               IF WSS-CMP-FCAN IN WSS-VARI > WSS-CMP-FIMV IN WSS-VARI
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'PROFCANNOVAL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   IF SCR-SGV-IPFC > CAN-SGV-TPAG IN CAN-FLD
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'SGVIPFCNOPAG' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-CON-FLD-CAN.
      *DAD fin  27-JUL-1994

      *ISP PARA UNA RENOVACION PARCIAL CON FORMA RENOVACION 'P' O 'I' O 'C'
      *ISP EXIGE VALOR RENOVADO
           IF ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' ) AND
              ( SCR-MSC-FCAN = 'P' OR 'I' OR 'C') AND
                CAN-SGV-TREN IN CAN-FLD = ZEROES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'MSCFCANTRENP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.

      *ISP MANEJO CODIGO DE CARGO
      *    DESPUES DEL MANEJO DE VALOR PAGADO
           IF CAN-SGV-TPAG IN CAN-FLD > ZEROES OR
              ( CAN-SGV-TPAG IN CAN-FLD = ZEROES AND
                WSS-IBLK-TPAG = 'N' )
              IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'INDTCYAOBL' TO MSG-COD-MENS           
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   MOVE CAN-NUM-DOUT IN CAN-FLD TO CAN-NUM-DOUT IN CAN
                   MOVE CAN-NUM-MOUT IN CAN-FLD TO CAN-NUM-MOUT IN CAN
                   MOVE CAN-NUM-SOUT IN CAN-FLD TO CAN-NUM-SOUT IN CAN
                   MOVE CAN-NUM-AOUT IN CAN-FLD TO CAN-NUM-AOUT IN CAN
                   MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN
                   MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN
                   MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN
                   MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN
                   MOVE 'TAB'                   TO MSC-COD-SIST
                   MOVE 'TCYA'                  TO MSC-COD-TMSC IN MSC
                   MOVE CYA-IND-TCYA IN CAN-FLD TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   IF MSC-CIC-CMSC IN MSC = 'CAJA' AND
                      CAN-FEC-FOUT IN CAN NOT = CAN-FEC-FCAN IN CAN
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'CANOUTCANCJI' TO MSG-COD-MENS           
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-CON-FLD-CAN
                   ELSE
                   IF MSC-CIC-CMSC IN MSC = 'CC' AND
                      ( SCR-MSC-TCAN = 'R' OR 'N' OR 'P' )
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'OPCPRGACCTNO' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO END-VAL-CON-FLD-CAN
                   ELSE
                       NEXT SENTENCE
           ELSE
               IF CYA-IND-TCYA IN CAN-FLD > SPACES
                 MOVE 'COL'        TO MSG-COD-SIST
                 MOVE 'INDTCYABLK' TO MSG-COD-MENS           
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO END-VAL-CON-FLD-CAN.

           IF ( CYA-IND-TCYA IN CAN-FLD NOT > SPACES AND
                 ( CYA-CAI-ICYA IN CAN-FLD > SPACES OR
                   CYA-IIC-ICYA IN CAN-FLD > ZEROES ) )
                  
                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'INDTCYAICYA' TO MSG-COD-MENS           
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
                   
           IF CYA-IND-TCYA IN CAN-FLD NOT > SPACES
               GO TO FIN-VAL-ICYA.

           IF WSS-GLS-DAT1 NOT > SPACES
               MOVE SPACES TO CYA-CAI-ICYA IN CAN-FLD
               MOVE ZEROES TO CYA-IIC-ICYA IN CAN-FLD
               GO TO FIN-VAL-ICYA.

           IF CYA-IIC-ICYA IN CAN-FLD NOT > ZEROES
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'IICICYACCOBL' TO MSG-COD-MENS           
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN.
           PERFORM GET-CLI-OPC.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
               IF WSS-GLS-DAT1 = 'O'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACSCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
                   GO TO CER-VAL-CYA-CAI-ICYA.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE CYA-CAI-ICYA IN CAN-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CYA-IIC-ICYA IN CAN-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICICYACCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO END-VAL-CON-FLD-CAN
           ELSE
               IF RCO-COD-STAT IN RCO = 'ELI'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNVIG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN
               ELSE
               IF WSS-GLS-DAT1 = 'M'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CICICYACNCLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       CER-VAL-CYA-CAI-ICYA.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF OPE-FEC-FTOP IN OPE > ZEROES
               IF OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'FECFTOPICYA>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO END-VAL-CON-FLD-CAN.
       FIN-VAL-ICYA.

       END-VAL-CON-FLD-CAN.

      * SUMA LOS GASTOS
           IF SCR-MSC-TCAN = 'C'
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
                ADD CAN-SGV-GAST IN CAN-FLD TO CAN-SGV-TREN IN CAN-FLD.

           IF SCR-MSC-TCAN = 'N' OR 
              SCR-MSC-TCAN = 'R'
                MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD.

      *JSS 30-JUL-1991 17:03:45 para manejar 'ATT'
           IF ( CAN-MSC-CANC IN CAN-FLD = 'ATT' ) AND
              ( CAN-FEC-FCAN IN CAN = OPC-FEC-FCOL IN OPC )
               MOVE ZEROES TO CAN-SGV-GAST IN CAN-FLD
               MOVE ZEROES TO CAN-SGV-TREN IN CAN-FLD
               MOVE ZEROES TO CAN-SGV-DIFE IN CAN-FLD
               MOVE OPC-SGV-LIQU IN OPC TO CAN-SGV-TPAG IN CAN-FLD.

      *ISP PARA MONEDA NACIONAL SIEMPRE MUESTRA VALOR RENOVADO,
      *    VALOR PAGADO, DIFERENCIA Y GASTOS SIN DECIMALES
           IF WSS-CIC-TVAL = '0'
      *ALD
               MOVE CAN-SGV-DIFE IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-DIFE
                                                      IN CAN-FLD
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG
                                                      IN CAN-FLD
               MOVE CAN-SGV-TREN IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TREN
                                                      IN CAN-FLD.

           IF WSS-CIC-VCAM = '0999'
      *ALD
               MOVE RCV-SGV-CAPI IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-CAPI
                                                      IN CAN-FLD

               MOVE RCV-SGV-FINA IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-FINA
                                                      IN CAN-FLD

               MOVE VEN-VAL-SCAP IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SCAP
                                                      IN CAN-FLD

               MOVE VEN-VAL-SFIN IN CAN-FLD TO PES-SGV-DECI
                                                    IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-SFIN
                                                      IN CAN-FLD.
      *DAD ini  12-NOV-1992
           IF FRM-GLS-IITR IN CAN-FLD NOT = FRM-GLS-TINT IN CAN-FLD AND
              FRM-SUAR = FRM-SUAR-MAL
               PERFORM BASE-TASA-INI.
      *DAD fin  12-NOV-1992

      *DAD ini  04-AGO-1993   (Memo.28-06-93)
      *Valida existencia de informacion en campos informados con perdida
           IF NOT ( MSG-COD-MENS > SPACES OR
                    FRM-SUAR = FRM-SUAR-MAL )
               PERFORM VAL-DAT-PREV-ING
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD fin  04-AGO-1993
      *>>>>
*% END
*% IF INI_VAL_NUM_FLD_CAN
      *<<<< INI_VAL_NUM_FLD_CAN
           IF CAN-SGV-TPAG-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TPAG
           ELSE
               MOVE 'N' TO WSS-IBLK-TPAG.
           IF ICG-SGV-TINT-ALF NOT > SPACES
               MOVE 'S' TO WSS-IBLK-TINT
           ELSE
               MOVE 'N' TO WSS-IBLK-TINT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *DAD ini  12-NOV-1992
       BASE-TASA-INI SECTION.
       INI-BASE-TASA-INI.
           MOVE SPACES                  TO ICG-SGV-TINT-ALF IN CAN-FLD.
           MOVE SPACES                  TO FRM-IND-TIPE     IN CAN-FLD
                                           WSS-IBLK-TINT.
           MOVE FRM-GLS-IITR IN CAN-FLD TO FRM-GLS-TINT IN CAN-FLD.
       FIN-BASE-TASA-INI.
           EXIT.
      *DAD fin  12-NOV-1992
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF_IBM
       VAL-CON-ROV SECTION.
       INI-VAL-CON-ROV.
           MOVE ROV-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPC IN ROV.
           MOVE ROV-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES                  TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROS                   TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-CON-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-VAL-CON-ROV.
           IF ROV-CAI-IOPC IN CAN-FLD NOT = ROV-CAI-IOPC IN ROV OR
              ROV-IIC-IOPC IN CAN-FLD NOT = ROV-IIC-IOPC IN ROV
               GO TO FIN-VAL-CON-ROV.

           MOVE ROV-CAI-IOPV IN ROV TO CAN-CAI-IOPC IN CAN
           MOVE ROV-IIC-IOPV IN ROV TO CAN-IIC-IOPC IN CAN
           MOVE ROV-NUM-IVCT IN ROV TO CAN-NUM-ICAN IN CAN
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-CAN
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'EXIROVSINCAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-ROV.

           IF CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
              CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN AND
              CAN-NUM-ICAN IN CAN-FLD = CAN-NUM-ICAN IN CAN
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-VAL-CON-ROV.

      *    IF (CAN-NUM-DOUT IN CAN-FLD NOT = CAN-NUM-DOUT IN CAN) OR
      *       (CAN-NUM-MOUT IN CAN-FLD NOT = CAN-NUM-MOUT IN CAN) OR
      *       (CAN-NUM-AOUT IN CAN-FLD NOT = CAN-NUM-AOUT IN CAN) OR
      *       (CAN-NUM-SOUT IN CAN-FLD NOT = CAN-NUM-SOUT IN CAN)
      *         MOVE 'COL' TO MSG-COD-SIST
      *          MOVE 'FECFCOMDFING' TO MSG-COD-MENS
      *          PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO FRM-MENS
      *          MOVE FRM-SUAR-MAL TO FRM-SUAR
      *          GO TO FIN-VAL-CON-ROV.

           IF (CAN-NUM-DCAN IN CAN-FLD NOT = CAN-NUM-DCAN IN CAN) OR
              (CAN-NUM-MCAN IN CAN-FLD NOT = CAN-NUM-MCAN IN CAN) OR
              (CAN-NUM-ACAN IN CAN-FLD NOT = CAN-NUM-ACAN IN CAN) OR
              (CAN-NUM-SCAN IN CAN-FLD NOT = CAN-NUM-SCAN IN CAN)
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'FECFCANDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROV.

           IF (CAN-NUM-DEGR IN CAN-FLD NOT = CAN-NUM-DEGR IN CAN) OR
              (CAN-NUM-MEGR IN CAN-FLD NOT = CAN-NUM-MEGR IN CAN) OR
              (CAN-NUM-AEGR IN CAN-FLD NOT = CAN-NUM-AEGR IN CAN) OR
              (CAN-NUM-SEGR IN CAN-FLD NOT = CAN-NUM-SEGR IN CAN)
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'FECFCONDFING' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-ROV.

           IF CAN-COD-OFCA IN CAN-FLD NOT = CAN-COD-OFCA IN CAN
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OFICANDOFIIN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
        FIN-VAL-CON-ROV.
           EXIT.

       GET-SLD SECTION.
       INI-GET-SLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           IF SCR-MSC-ECAN = 'T' AND
              OPC-NUM-VCOR IN OPC > 1
               MOVE OPC-VAL-SCRE IN CAN-FLD TO WSS-VAL-SCAP
               ADD VEN-VAL-SFIN IN CAN-FLD OPC-VAL-SCRE IN CAN-FLD
                   GIVING WSS-VAL-SVEN
               SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM WSS-VAL-SVEN
           ELSE
               MOVE VEN-VAL-SCAP IN CAN-FLD TO WSS-VAL-SCAP
               MOVE VEN-VAL-SFIN IN CAN-FLD TO WSS-VAL-SVEN.

           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.

           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEN-VAL-SCAP IN CAN-FLD TO
                     RCV-SGV-CAPI IN CAN-FLD
                MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
               IF OPC-NUM-VCOR IN OPC = 1
                   MOVE VEN-VAL-SCAP IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE VEN-VAL-SFIN IN CAN-FLD TO
                     RCV-SGV-FINA IN CAN-FLD
               ELSE
                   MOVE OPC-VAL-SCRE IN CAN-FLD TO
                        RCV-SGV-CAPI IN CAN-FLD
                   MOVE WSS-VAL-SVEN TO
                        RCV-SGV-FINA IN CAN-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-GET-SLD.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *    CONVIERTE A PESOS

           MOVE 1 TO SCR-SGV-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               GO TO VRF-MON-NAC.

           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TAB-NUM-DTRN IN TAB.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TAB-NUM-MTRN IN TAB.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TAB-NUM-STRN IN TAB.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TAB-NUM-ATRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MOVE CAM-SGV-VCAM IN CAM TO SCR-SGV-VCAM

               MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SVEN ROUNDED

               MULTIPLY WSS-VAL-SCAP BY SCR-SGV-VCAM
                                 GIVING WSS-VAL-SCAP ROUNDED
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
       VRF-MON-NAC.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN
      *DAD ini  22-ABR-1993
               MOVE WSS-VAL-SCAP TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SCAP.
      *DAD fin  22-ABR-1993
       FIN-GET-SLD.
           EXIT.

       ABS-TPAG SECTION.
       INI-ABS-TPAG.
           MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-SGV-TPAG.
           IF WSS-SGV-TPAG < ZEROES
               SUBTRACT WSS-SGV-TPAG FROM 0 GIVING WSS-SGV-TPAG.
       FIN-ABS-TPAG.
           EXIT.

       LEE-REG-TCAN SECTION.
       INI-LEE-REG-TCAN.
           IF VEN-NUM-IVEN IN CAN-FLD = 1
               MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
               MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
               MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
               MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
               GO TO CON-LEE-REG-TCAN.
      *
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN CAN-FLD GIVING
                                           VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN IN WSS-VARI
               ELSE
                   MOVE OPC-NUM-DCOL IN OPC TO WSS-NUM-DVEN IN WSS-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO WSS-NUM-MVEN IN WSS-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO WSS-NUM-SVEN IN WSS-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO WSS-NUM-AVEN IN WSS-VARI.
       CON-LEE-REG-TCAN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN     TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.

           MOVE CAN-CAI-IOPC IN CAN-FLD TO CAN-CAI-IOPC IN CAN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO CAN-IIC-IOPC IN CAN.
           PERFORM GET-CUR-ITR.
           IF PGM-STAT-ITR-OKS
               PERFORM GET-NXT-ITR.
       FIN-LEE-REG-TCAN.
           EXIT.

       PRO-TCAN-CTE SECTION.
       INI-PRO-TCAN-CTE.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CTE
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CTE.
       FIN-PRO-TCAN-CTE.
           EXIT.

       PRO-MORA-CTE SECTION.
       INI-PRO-MORA-CTE.
           IF VEN-IND-CALC IN VEN = 'N'
               MOVE 'VENCALCMORAN' TO MSG-COD-MENS
               MOVE VEN-NUM-IVEN IN VEN TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTE.
           MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SMON.
           PERFORM PRO-FUPM.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S' 
               PERFORM VAL-TMAX-CONV
           ELSE
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
               PERFORM VAL-TMAX-CONV
           ELSE
               PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTE.
           IF WSS-IBLK-TINT = 'S'
               GO TO CON-PRO-CTE-TIPE.
      *JSS 19-AUG-1991 12:44:52
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE
               GO TO CON-PRO-CTE-TIPE.
       CON-PRO-MORA-CTE.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  por  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CTE.
       CON-PRO-CTE-TIPE.
           MOVE WSS-VAL-SMON TO WSS-VAL-SCRE.                                   
           MULTIPLY INT-TIPE BY WSS-VAL-SCRE                                    
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                  GIVING WSS-VAL-SVEN ROUNDED.
                         GIVING WSS-VAL-SVEN.
      *DAD fin  19-FEB-1993
           ADD WSS-VAL-SCRE TO WSS-VAL-SVEN.                                    
      *
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                                   
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                                
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-MORA-CTE.
           EXIT.

       PRO-MORA-TMC SECTION.
       INI-PRO-MORA-TMC.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-TMC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TMC-NUM-DTMC IN TMC.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TMC-NUM-MTMC IN TMC.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TMC-NUM-ATMC IN TMC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-CANT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-CANT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-CANT.

      *     MOVE VEN-NUM-DVEN IN CAN-FLD TO TMC-NUM-DTMC IN TMC.
      *     MOVE VEN-NUM-MVEN IN CAN-FLD TO TMC-NUM-MTMC IN TMC.
      *     MOVE VEN-NUM-AVEN IN CAN-FLD TO TMC-NUM-ATMC IN TMC.
           MOVE WSS-NUM-DUPM IN WSS-VARI TO TMC-NUM-DTMC IN TMC.
           MOVE WSS-NUM-MUPM IN WSS-VARI TO TMC-NUM-MTMC IN TMC.
           MOVE WSS-NUM-AUPM IN WSS-VARI TO TMC-NUM-ATMC IN TMC.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TMC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'TASDNEXFVEN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
           IF WSS-CIC-VCAM = '0998'
               MOVE TMC-SGV-UFAC IN TMC TO WSS-SGV-VENT
           ELSE
           IF WSS-PLZO-B90
               MOVE TMC-SGV-89AC IN TMC TO WSS-SGV-VENT
           ELSE
               MOVE TMC-SGV-PEAC IN TMC TO WSS-SGV-VENT.
           SUBTRACT WSS-SGV-VENT FROM WSS-SGV-CANT GIVING
                    WSS-SGV-MTMC.
           DIVIDE WSS-SGV-MTMC BY 36000 GIVING
                  WSS-INT-TIPE ROUNDED.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
               MOVE WSS-INT-TIPE TO INT-TIPE
               MULTIPLY WSS-INT-TIPE BY 100 GIVING ICG-SGV-TINT
                                             IN CAN-FLD
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               PERFORM GLS-INT-TIPE
               GO TO FIN-PRO-MORA-TMC.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
               DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                      INT-TIPE
               MOVE 'S' TO WSS-IBLK-TINT
               PERFORM GLS-INT-TIPE
               GO TO CMP-INT-TIPE.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-TMC.
       CMP-INT-TIPE.
           IF INT-TIPE > WSS-INT-TIPE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CANTIPE>TMC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-PRO-MORA-TMC.
           EXIT.

       PRO-DESC-CTE SECTION.
       INI-PRO-DESC-CTE.
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CTE-1VCTO
               GO TO FIN-PRO-DESC-CTE.
           PERFORM CAL-TFPR-CAN.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE.
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
      *
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN
               GO TO NXT-PRO-DESC-CTE.
           MOVE VEN-VAL-SFIN IN VEN     TO WSS-VAL-SMON.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE.
           ADD 1 TO INT-TIPE.
           DIVIDE WSS-VAL-SMON BY INT-TIPE                                      
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                    GIVING WSS-VAL-SVEN ROUNDED.
                           GIVING WSS-VAL-SVEN.
      *DAD fin  19-FEB-1993
      *DAD ini  22-SEP-1993   (Memo.02-07-92)
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD AND
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.2)
              OPC-NUM-VCVG IN OPC = 1                           AND
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC
               IF WSS-OPEC = 'B'
                   MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                                  WSS-VAL-SVEN IN WSS-VARI
               ELSE
                   MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-SVEN.
      *DAD fin  07-JUL-1994 / 22-SEP-1993
       NXT-PRO-DESC-CTE.
      *
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTE.
           EXIT.

       PRO-TCAN-CTT SECTION.
       INI-PRO-TCAN-CTT.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CTT
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CTT.
       FIN-PRO-TCAN-CTT.
           EXIT.

       PRO-MORA-CTT SECTION.
       INI-MORA-CTT.
           PERFORM BUS-SIG-VEN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTT.
           PERFORM LEE-REG-TCAN.
           MOVE ZEROES TO WSS-TOT-SVEN IN WSS-VARI.
           MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD.
       LUP-PRO-MORA-CTT.
           PERFORM PRO-MORA-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CTT.
           ADD VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
           ADD WSS-VAL-SMON IN WSS-VARI TO WSS-TOT-SVEN IN WSS-VARI.
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES 
               GO TO NXT-PRO-MORA-CTT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
               IF NOT VEN-STAT-OKS
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-PRO-MORA-CTT
                   ELSE
                       GO TO NXT-PRO-MORA-CTT
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO NXT-PRO-MORA-CTT.
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES
      *         GO TO NXT-PRO-MORA-CTT.
           GO TO LUP-PRO-MORA-CTT.
       NXT-PRO-MORA-CTT.
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.           
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                                   
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                                
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-MORA-CTT.
           EXIT.

       PRO-DESC-CTT SECTION.
       INI-PRO-DESC-CTT.
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CTE-1VCTO
               GO TO FIN-PRO-DESC-CTT.
      *     IF ITR-COD-CVTI IN ITR > SPACES AND
      *        FRM-SGV-TINT IN CAN-FLD NOT = ICG-SGV-TINT IN CAN-FLD
      *         MOVE 'CANTTTV=TC' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-PRO-DESC-CTT.
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD
      *Se hace una excepcion para documentos descontados 
      *siempre deben procesarse como si las tasas fuesen distintas
               IF WSS-OPEC = 'D'
                   PERFORM PRO-DESC-CTT-TADI
               ELSE
                   PERFORM PRO-DESC-CTT-TAIG
           ELSE
               PERFORM PRO-DESC-CTT-TADI.
       FIN-PRO-DESC-CTT.
           EXIT.      

       PRO-DESC-CTT-TAIG SECTION.
       INI-PRO-DESC-CTT-TAIG.
           PERFORM OBT-RCV-FINA.
           IF FRM-SUAR = FRM-SUAR-MAL
      *DAD ini  25-NOV-1991   (Memo.05-11-91 pto.2)
               IF ( MSG-COD-MENS IN MSG = 'CANINTEFINA>' AND
                    OPC-IND-VSTR IN OPC = 'N' )
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                OR ( MSG-COD-MENS IN MSG = 'CAMBTSANXABT' OR
                                           'CAMBTSANVABT' )
                   MOVE OPC-VAL-SCRE IN OPC TO RCV-SGV-CAPI IN CAN-FLD
                   MOVE ZEROES              TO RCV-SGV-FINA IN CAN-FLD
                   MOVE FRM-SUAR-OKS TO FRM-SUAR
                   MOVE SPACES TO INT-CMSG MSG-COD-MENS IN MSG FRM-MENS
               ELSE
      *DAD fin  25-NOV-1991
                   GO TO FIN-PRO-DESC-CTT-TAIG.
           PERFORM LEE-REG-TCAN.
      *Se hace una excepcion para boletas de garantia
      *siempre deben procesarse igual a un descuento de 1 vcto
           IF WSS-OPEC = 'B'
               PERFORM PRO-DESC-CTE-1VCTO
               GO TO FIN-PRO-DESC-CTT-TAIG.
      *
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           PERFORM CAL-TFPR-CAN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-DESC-CTT-TAIG.
           IF WSS-CMP-FVEN IN WSS-VARI NOT < WSS-CMP-FCAN IN WSS-VARI
               IF WSS-OPEC = 'B'
                   MOVE 0 TO WSS-VAL-SMO1
                   GO TO OBT-MON1
               ELSE
                   PERFORM BUS-IDNI-VEN-ANT
                   ADD OPC-VAL-SCRE IN OPC WSS-VAL-IDNI IN WSS-VARI
                                    GIVING WSS-VAL-SMO1
                   GO TO OBT-MON1.
           IF INT-CMSG > SPACES
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-DESC-CTT-TAIG.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTT-TAIG.
           ADD 1 TO INT-TIPE.
           MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI IN WSS-VARI.
           DIVIDE VEN-VAL-SFIN IN VEN BY INT-TIPE
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                           GIVING WSS-VAL-SMO2 ROUNDED.
                                  GIVING WSS-VAL-SMO2.
      *DAD fin  19-FEB-1993
           IF WSS-OPEC = 'B'
               MOVE 0 TO WSS-VAL-SMO1
           ELSE
               SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                                              GIVING WSS-VAL-SMO1.
           ADD WSS-VAL-SMO1 WSS-VAL-IDNI IN WSS-VARI
                                         GIVING WSS-VAL-SMO1.
           ADD WSS-VAL-SMO1 WSS-VAL-SMO2 GIVING WSS-VAL-SMO1.
       OBT-MON1.
           MOVE WSS-VAL-SMO1 TO WSS-VAL-SVEN.
      *
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT OPC-VAL-SCRE IN OPC FROM SCR-SGV-IPFC.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTT-TAIG.
           EXIT.

      *Obtiene la suma de los SCAP y SFIN desdes VEN actual hasta el ultimo
      *completando aquellos incompletos
       OBT-RCV-FINA SECTION.
       INI-OBT-RCV-FINA.
           PERFORM LEE-REG-TCAN.
      *
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-OBT-RCV-FINA.
           PERFORM CAL-TFPR-CAN.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-OBT-RCV-FINA.
      *Si es la primera vez inicializa acumuladores con dicho VEN,
      *en caso contrario acumula los VEN siguientes en los RCV
           IF WSS-IVEZ = 0
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               MOVE 1 TO WSS-IVEZ
           ELSE
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
      *
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO FIN-OBT-RCV-FINA
               ELSE
               IF NOT VEN-STAT-OKS
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-OBT-RCV-FINA
                   ELSE
                       GO TO FIN-OBT-RCV-FINA
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-OBT-RCV-FINA.
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES
      *         GO TO FIN-OBT-RCV-FINA.
           GO TO LUP-OBT-RCV-FINA.
       FIN-OBT-RCV-FINA.
           EXIT.

       BUS-IDNI-VEN-ANT SECTION.
       INI-BUS-IDNI-VEN-ANT.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN = 1
               MOVE ZEROES TO WSS-VAL-IDNI
               GO TO FIN-BUS-IDNI-VEN-ANT.
      *
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
               ELSE
                   MOVE ZEROES              TO WSS-VAL-IDNI 
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
               ELSE
                   MOVE ZEROES              TO WSS-VAL-IDNI.
      *Para restaurar VEN actual
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       FIN-BUS-IDNI-VEN-ANT.
           EXIT.

       PRO-DESC-CTT-TADI SECTION.
       INI-PRO-DESC-CTT-TADI.
      *ald
      *     PERFORM BUS-ANT-VEN.
      *     IF FRM-SUAR = FRM-SUAR-MAL
      *         GO TO FIN-PRO-DESC-CTT-TADI.
           PERFORM LEE-REG-TCAN.
      *
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           MOVE 0 TO WSS-IVEZ.
       LUP-PRO-DESC-CTT-TADI.
           PERFORM PRO-DESC-CTE.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-DESC-CTT-TADI.
      *Si es la primera vez, debe mostrar en pantalla el VEN
      *actual, inicializar acumuladores con dicho VEN e inicializar el
      *valor pagado de la cuota, en caso contrario
      *acumula los VEN siguientes en los RCV y el valor pagado
           IF WSS-IVEZ = 0
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               MOVE WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI
               MOVE 1 TO WSS-IVEZ
           ELSE
               ADD  VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               ADD  VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD
               ADD  WSS-VAL-SMON IN WSS-VARI TO
                    WSS-TOT-SVEN IN WSS-VARI.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM OPC-VAL-SCRE IN OPC
                    GIVING WSS-VAL-SCRE IN WSS-VARI.
      *
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               MOVE CAN-NUM-DCAN IN CAN-FLD TO VEN-DTBS
               MOVE CAN-NUM-MCAN IN CAN-FLD TO VEN-MTBS
               MOVE CAN-NUM-SCAN IN CAN-FLD TO VEN-STBS
               MOVE CAN-NUM-ACAN IN CAN-FLD TO VEN-ATBS
               PERFORM COL-OBT-VEN
               IF VEN-STAT-EOF
                   GO TO NXT-PRO-DESC-CTT-TADI
               ELSE
               IF NOT VEN-STAT-OKS
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-PRO-DESC-CTT-TADI
                   ELSE
                       GO TO NXT-PRO-DESC-CTT-TADI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO NXT-PRO-DESC-CTT-TADI.
      *     IF VEN-VAL-SFIN IN VEN NOT > ZEROES
      *         GO TO NXT-PRO-DESC-CTT-TADI.
           GO TO LUP-PRO-DESC-CTT-TADI.
       NXT-PRO-DESC-CTT-TADI.
           MOVE WSS-TOT-SVEN IN WSS-VARI TO WSS-VAL-SVEN IN WSS-VARI.           
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                                   
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                                
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTT-TADI.
           EXIT.

       CAL-TIPE SECTION.
       INI-CAL-TIPE.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           MOVE FEC-FEC1                TO INT-FUNO.
           MOVE FEC-FEC2                TO INT-FDOS.
           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF WSS-IND-SPR2 = 'S' AND
              VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
           MOVE SPACES TO WSS-IND-SPR2.
      *
      *SMC-INI 09.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE.
           EXIT.

       CAL-TIPE-DESC SECTION.
       INI-CAL-TIPE-DESC.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DDMA INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MDMA INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SDMA INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ADMA INT-ABTV.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       FIN-CAL-TIPE-DESC.
           EXIT.

       PRO-TCAN-CIE SECTION.
       INI-PRO-TCAN-CIE.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CIE
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CIE.
       FIN-PRO-TCAN-CIE.
           EXIT.

       PRO-MORA-CIE SECTION.
       INI-PRO-MORA-CIE.
           PERFORM PRO-FUPM.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S' 
               PERFORM VAL-TMAX-CONV
           ELSE
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
               PERFORM VAL-TMAX-CONV
           ELSE
               PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CIE.
           IF WSS-IBLK-TINT = 'S'
               GO TO CON-PRO-CIE-TIPE.
      *JSS 19-AUG-1991 12:44:52
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE
               GO TO CON-PRO-CIE-TIPE.
       CON-PRO-MORA-CIE.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
       CON-PRO-CIE-TIPE.
           MULTIPLY INT-TIPE BY VEN-VAL-SFIN IN CAN-FLD GIVING
                                      WSS-VAL-SMO1 ROUNDED.
           IF WSS-CIC-VCAM = '0999'
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
           ELSE
               IF WSS-CIC-TVAL = '0'
                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM
                                     GIVING WSS-VAL-SMO1
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
                   DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM
                                   GIVING WSS-VAL-SMO1.

           ADD WSS-VAL-SMO1 VEN-VAL-SFIN IN CAN-FLD GIVING
                                      WSS-VAL-SMO2 ROUNDED.

           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM
                      GIVING CAN-SGV-TPAG IN CAN-FLD
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
      *DAD ini  21-ABR-1993
      *         DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2 IN WSS-VARI
               DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM
      *DAD fin  21-ABR-1993
                                       GIVING WSS-VAL-SMO4.

           IF WSS-VAL-SMO4 < WSS-VAL-SMO1
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-CIE.
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING
                    RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                     GIVING WSS-VAL-SMO2.
           SUBTRACT WSS-VAL-SMO2 FROM RCV-SGV-FINA IN CAN-FLD GIVING
                    RCV-SGV-CAPI IN CAN-FLD.
           IF RCV-SGV-CAPI IN CAN-FLD < ZEROES
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD.
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.
      *
       FIN-PRO-MORA-CIE.
           EXIT.

       PRO-DESC-CIE SECTION.
       INI-PRO-DESC-CIE.
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CIE-1VCTO
               GO TO FIN-PRO-DESC-CIE.

           IF WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  MOVE ZEROES TO INT-TIPE
                  GO TO CON-PRO-DESC-CIE.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE.
       CON-PRO-DESC-CIE.
           ADD 1 TO INT-TIPE.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
      *DAD ini  11-MAY-1994   (Memo.16-12-92)
      *                               GIVING WSS-VAL-SMO4 ROUNDED.
                                      GIVING WSS-VAL-SMO4.
      *DAD fin  11-MAY-1994
           MULTIPLY WSS-VAL-SMO4 BY INT-TIPE GIVING
      *DAD ini  11-MAY-1994   (Memo.16-12-92)
      *                             WSS-VAL-SMO1 ROUNDED.
                                    WSS-VAL-SMO1.
      *DAD fin  11-MAY-1994
           SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                     GIVING WSS-VAL-SMO2.
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.
           IF WSS-VAL-SMO1 < WSS-VAL-SMO2
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE.
           IF WSS-VAL-SMO1 NOT < VEN-VAL-SFIN IN CAN-FLD
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE.
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING
                          RCV-SGV-CAPI IN CAN-FLD ROUNDED.
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.
      *
       FIN-PRO-DESC-CIE.
           EXIT.

       PRO-TCAN-CPE SECTION.
       INI-PRO-TCAN-CPE.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO CAN-NUM-DCAN IN CAN.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO CAN-NUM-MCAN IN CAN.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO CAN-NUM-SCAN IN CAN.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO CAN-NUM-ACAN IN CAN.
           MOVE VEN-NUM-DIMV IN CAN-FLD TO VEN-NUM-DIMV IN VEN.
           MOVE VEN-NUM-MIMV IN CAN-FLD TO VEN-NUM-MIMV IN VEN.
           MOVE VEN-NUM-SIMV IN CAN-FLD TO VEN-NUM-SIMV IN VEN.
           MOVE VEN-NUM-AIMV IN CAN-FLD TO VEN-NUM-AIMV IN VEN.
           MOVE VEN-NUM-DVEN IN CAN-FLD TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MVEN IN CAN-FLD TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SVEN IN CAN-FLD TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AVEN IN CAN-FLD TO VEN-NUM-AVEN IN VEN.
           IF CAN-FEC-FCAN IN CAN > VEN-FEC-FVEN IN VEN
               PERFORM PRO-MORA-CPE
           ELSE
           IF CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FVEN IN VEN
               PERFORM PRO-DESC-CPE.
       FIN-PRO-TCAN-CPE.
           EXIT.

       PRO-MORA-CPE SECTION.
       INI-MORA-CPE.
           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.

           PERFORM PRO-FUPM.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S' 
               PERFORM VAL-TMAX-CONV
           ELSE
           IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
              CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
               PERFORM VAL-TMAX-CONV
           ELSE
               PERFORM PRO-MORA-TMC.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-PRO-MORA-CPE.
           IF WSS-IBLK-TINT = 'S'
               GO TO CON-PRO-CPE-TIPE.
      *JSS 19-AUG-1991 12:44:52
           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
               MOVE 0 TO INT-TIPE
               GO TO CON-PRO-CPE-TIPE.
       CON-PRO-MORA-CPE.
           MOVE WSS-DIAM                TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *DAD ini  27-NOV-1991   (Memo.15-11-91 pto.3.2)
      *    Cambio  OPC-NUM-xCOL IN OPC  x  WSS-NUM-xUPM  --->  INT-xDMA
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
      *DAD fin  27-NOV-1991
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.
       CON-PRO-CPE-TIPE.
           ADD 1 TO INT-TIPE.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
                        GIVING WSS-VAL-SMO4 ROUNDED. 
           DIVIDE WSS-VAL-SMO4 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED.
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-MORA-CPE.
           DIVIDE VEN-VAL-SCAP IN CAN-FLD BY VEN-VAL-SFIN IN CAN-FLD
                  GIVING WSS-VAL-SMO2 ROUNDED.
           MULTIPLY WSS-VAL-SMO2 BY RCV-SGV-FINA IN CAN-FLD GIVING
                    RCV-SGV-CAPI IN CAN-FLD ROUNDED.
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.
      *
       FIN-PRO-MORA-CPE.
           EXIT.

       PRO-DESC-CPE SECTION.
       INI-PRO-DESC-CPE.
           IF OPC-NUM-VCOR IN OPC = 1
               PERFORM PRO-DESC-CPE-1VCTO
               GO TO FIN-PRO-DESC-CPE.

           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  MOVE ZEROES TO INT-TIPE
                  GO TO CON-PRO-DESC-CPE.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           PERFORM CAL-TIPE-DESC.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE.
       CON-PRO-DESC-CPE.
           ADD 1 TO INT-TIPE.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                               GIVING WSS-VAL-SMO4 ROUNDED.
                                      GIVING WSS-VAL-SMO4.
      *DAD fin  31-MAY-1994
           MULTIPLY WSS-VAL-SMO4 BY INT-TIPE GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                             WSS-VAL-SMO1 ROUNDED.
                                    WSS-VAL-SMO1.
      *DAD fin  31-MAY-1994
           MOVE WSS-VAL-SMO1 TO RCV-SGV-FINA IN CAN-FLD.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.2)
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.
      *DAD fin  11-MAY-1994
           DIVIDE VEN-VAL-SCAP IN CAN-FLD BY VEN-VAL-SFIN IN CAN-FLD
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                               GIVING WSS-VAL-SMO2 ROUNDED.
                                      GIVING WSS-VAL-SMO2.
      *DAD fin  31-MAY-1994
           MULTIPLY WSS-VAL-SMO2 BY RCV-SGV-FINA IN CAN-FLD GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                             RCV-SGV-CAPI IN CAN-FLD ROUNDED.
                                    RCV-SGV-CAPI IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.
      *
       FIN-PRO-DESC-CPE.
           EXIT.

       PRO-FUPM SECTION.
       INI-PRO-FUPM.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC1 WSS-NUM-DUPM.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC1 WSS-NUM-MUPM.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC1 WSS-NUM-SUPM.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC1 WSS-NUM-AUPM.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO RCV-CAI-IOPV IN RCV.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO RCV-IIC-IOPV IN RCV.
           MOVE VEN-NUM-IVCT IN VEN     TO RCV-NUM-IVCT IN RCV.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND. 
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )
               GO TO EXT-PRO-FUPM.
           MOVE 1 TO WSS-NUM-ICAN IN WSS-VARI.
       LUP-PRO-FUPM.
           MOVE RCV-KEY-ICAN TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF CAN-MSC-FCAN IN CAN = 'P'
               GO TO NXT-PRO-FUPM.
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND
              CAN-SGV-TPAG IN CAN NOT < ZEROES AND
              CAN-SGV-TREN IN CAN NOT < ZEROES AND
              CAN-FEC-FCAN IN CAN >     VEN-FEC-FVEN IN VEN      AND
      *DAD ini  13-ABR-1993   (Memo.12-04-93)
              CAN-FEC-FCAN IN CAN >     WSS-FEC-FUPM IN WSS-VARI AND
      *DAD fin  193-ABR-1993
              CAN-NUM-ICAN IN CAN NOT = CAN-NUM-ICAN IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN TO FEC-DEC1 WSS-NUM-DUPM
               MOVE CAN-NUM-MCAN IN CAN TO FEC-MEC1 WSS-NUM-MUPM
               MOVE CAN-NUM-SCAN IN CAN TO FEC-SEC1 WSS-NUM-SUPM
               MOVE CAN-NUM-ACAN IN CAN TO FEC-AEC1 WSS-NUM-AUPM.
       NXT-PRO-FUPM.
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND. 
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
              CAN-CAI-IOPC IN CAN-FLD = RCV-CAI-IOPV IN RCV AND
              CAN-IIC-IOPC IN CAN-FLD = RCV-IIC-IOPV IN RCV AND
              VEN-NUM-IVCT IN VEN     = RCV-NUM-IVCT IN RCV )
               GO TO EXT-PRO-FUPM.
           GO TO LUP-PRO-FUPM.
       EXT-PRO-FUPM.
           PERFORM RET-CAN-CAN.
       FIN-PRO-FUPM.
           EXIT.

       BUS-SIG-VEN SECTION.
       INI-BUS-SIG-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-SIG-VEN.
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   NEXT SENTENCE
               ELSE
      *JSS 14-JAN-1992 (Memo.29-11-91 Pto.3)
                   IF VEN-STAT = 'CAMBTSANXABT' OR 'CAMBTSANVABT'
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE VEN-STAT     TO MSG-COD-MENS
                       MOVE VEN-MEN2     TO FRM-MEN2
                       GO TO FIN-BUS-SIG-VEN
                   ELSE
                       GO TO FIN-BUS-SIG-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-SIG-VEN.
           IF VEN-FEC-FVEN IN VEN > CAN-FEC-FCAN IN CAN
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENSGNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-SIG-VEN.
           GO TO LUP-BUS-SIG-VEN.
       FIN-BUS-SIG-VEN.
           EXIT.

       BUS-ANT-VEN SECTION.
       INI-BUS-ANT-VEN.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
           MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
       LUP-BUS-ANT-VEN.
           SUBTRACT 1 FROM VEN-NUM-IVEN IN VEN.
           IF VEN-NUM-IVEN IN VEN NOT > ZEROES
               GO TO FIN-BUS-ANT-VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S' 
               MOVE 1 TO VEN-NUM-IVEN IN VEN
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  VEN-NUM-IVCT IN VEN NOT < VEN-NUM-IVEN IN CAN-FLD
                   GO TO FIN-BUS-ANT-VEN
               ELSE
                   MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
                   MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
                   MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-BUS-ANT-VEN
           ELSE
               PERFORM COL-FIO-VEN
               IF NOT FIO-STAT-OKS
                   GO TO FIN-BUS-ANT-VEN.
           IF VEN-VAL-SFIN IN VEN > ZEROES
               MOVE ZEROES TO RCV-SGV-FINA IN CAN-FLD
               MOVE ZEROES TO RCV-SGV-CAPI IN CAN-FLD
               MOVE 'EXTVENANNCAN' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-BUS-ANT-VEN.
           GO TO LUP-BUS-ANT-VEN.
       FIN-BUS-ANT-VEN.
           EXIT.

       PRO-DESC-CTE-1VCTO SECTION.
       INI-PRO-DESC-CTE-1VCTO.
           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.
           PERFORM CAL-TFPR-CAN.
           IF INT-CMSG > SPACES
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-PRO-DESC-CTE-1VCTO.
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
      *
               MOVE VEN-VAL-SFIN IN VEN TO WSS-VAL-SVEN
               GO TO NXT-PRO-DESC-CTE-1VCTO.
      *DAD ini  22-SEP-1993   (Memo.02-07-92)
           IF FRM-SGV-TINT IN CAN-FLD = ICG-SGV-TINT IN CAN-FLD  AND
              OPC-NUM-VCVG IN OPC = 1                            AND
      *DAD ini  07-JUL-1994   (Memo.07-07-94 Pto.2)
              WSS-CMP-FCAN IN WSS-VARI NOT > DLC-FEC-FDEV IN DLC AND
      *DAD fin  07-JUL-1994
              WSS-OPEC = 'B'
               MOVE ZEROES TO VEN-VAL-SCAP IN VEN
                              WSS-VAL-SVEN IN WSS-VARI
               GO TO NXT-PRO-DESC-CTE-1VCTO.
      *DAD fin  22-SEP-1993
           PERFORM PRO-UVCT-DVEG.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE-1VCTO.
      *JSS 6-JUN-1991 20:57:09 ( un ctt DESC, tasas iguales, opec='B', n venc.
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...
           IF WSS-OPEC = 'B'
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                                 GIVING WSS-VAL-SMO1 ROUNDED
                                        GIVING WSS-VAL-SMO1
      *DAD fin  19-FEB-1993
           ELSE
      *    no afecta a cte DESC,opec='B', 1 venc. ya que en ese caso SCRE=SCAP)
      *
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                                     GIVING WSS-VAL-SMO1 ROUNDED.
                                            GIVING WSS-VAL-SMO1.
      *DAD fin  19-FEB-1993
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CTE-1VCTO.
      *
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
      *     PERFORM CAL-TIPE.
           PERFORM CAL-TIPE-DESC.
      *DAD fin  11-MAY-1994
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CTE-1VCTO.
      *JSS 6-JUN-1991 20:57:09 ( un ctt DESC, tasas iguales, opec='B', n venc.
      *llama a procesar a este parrafo 1 sola vez, por lo tanto ...
           IF WSS-OPEC = 'B'
               MULTIPLY OPC-VAL-SCRE IN OPC BY INT-TIPE
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                                 GIVING WSS-VAL-SMO2 ROUNDED
                                        GIVING WSS-VAL-SMO2
      *DAD fin  19-FEB-1993
           ELSE
      *    no afecta a cte DESC,opec='B', 1 venc. ya que en ese caso SCRE=SCAP)
      *
               MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
      *DAD ini  19-FEB-1993   (Memo.16-12-92)
      *                                     GIVING WSS-VAL-SMO2 ROUNDED.
                                            GIVING WSS-VAL-SMO2.
      *DAD fin  19-FEB-1993
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1.
       CON-PRO-DESC-CTE-1VCTO.
           IF WSS-OPEC = 'B'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SVEN
           ELSE
               ADD VEN-VAL-SCAP IN CAN-FLD  WSS-VAL-SMO1  GIVING
                                                          WSS-VAL-SVEN.
       NXT-PRO-DESC-CTE-1VCTO.
      *
           ADD WSS-VAL-SVEN TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM SCR-SGV-IPFC.
      *
           MOVE WSS-VAL-SVEN TO WSS-VAL-SMON.                                   
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM                                
                             GIVING WSS-VAL-SVEN ROUNDED.
           IF WSS-CIC-TVAL = '0'
               MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       FIN-PRO-DESC-CTE-1VCTO.
           EXIT.

       PRO-UVCT-DVEG SECTION.
       INI-PRO-UVCT-DVEG.
           MOVE DLC-NUM-DDEV IN DLC TO FEC-DEC1.
           MOVE DLC-NUM-MDEV IN DLC TO FEC-MEC1.
           MOVE DLC-NUM-SDEV IN DLC TO FEC-SEC1.
           MOVE DLC-NUM-ADEV IN DLC TO FEC-AEC1.
       FIN-PRO-UVCT-DVEG.
           EXIT.

       PRO-DESC-CIE-1VCTO SECTION.
       INI-PRO-DESC-CIE-1VCTO.
           PERFORM PRO-UVCT-DVEG.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-1VCTO.
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE     
      *DAD ini  11-MAY-1994   (Memo.16-12-92)
      *                                 GIVING WSS-VAL-SMO1 ROUNDED.
                                        GIVING WSS-VAL-SMO1.
      *DAD fin  11-MAY-1994
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CIE-1VCTO.
      *
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  GO TO CON-PRO-DESC-CIE-1VCTO.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
      *     PERFORM CAL-TIPE.
           PERFORM CAL-TIPE-DESC.
      *DAD fin  11-MAY-1994
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-1VCTO.
           MULTIPLY VEN-VAL-SCAP IN CAN-FLD BY INT-TIPE
      *DAD ini  11-MAY-1994   (Memo.16-12-92)
      *                                 GIVING WSS-VAL-SMO2 ROUNDED.
                                        GIVING WSS-VAL-SMO2.
      *DAD fin  11-MAY-1994
           SUBTRACT WSS-VAL-SMO2 FROM WSS-VAL-SMO1 GIVING WSS-VAL-SMO1.
       CON-PRO-DESC-CIE-1VCTO.
           IF WSS-CIC-VCAM = '0999'
               MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
           ELSE
               IF WSS-CIC-TVAL = '0'
                   MULTIPLY WSS-VAL-SMO1 BY SCR-SGV-VCAM
                          GIVING WSS-VAL-SMO1
                   MOVE WSS-VAL-SMO1 TO PES-SGV-DECI IN PES-VARI
                   PERFORM PES-SCTV
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SMO1
                   DIVIDE WSS-VAL-SMO1 BY SCR-SGV-VCAM
                                             GIVING WSS-VAL-SMO1.
      *
           ADD WSS-VAL-SMO1 TO SCR-SGV-IPFC.
      *
           ADD VEN-VAL-SCAP IN CAN-FLD WSS-VAL-SMO1 GIVING WSS-VAL-SMO2.

           IF CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S'
               MOVE WSS-VAL-SMO1 TO WSS-VAL-SMO4
               MULTIPLY WSS-VAL-SMO4 BY SCR-SGV-VCAM
                                 GIVING CAN-SGV-TPAG IN CAN-FLD
               MOVE CAN-SGV-TPAG IN CAN-FLD TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN-FLD
           ELSE
      *DAD ini  21-ABR-1993
      *         DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
               MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-CMP2 IN WSS-VARI
               DIVIDE WSS-VAL-CMP2 IN WSS-VARI BY SCR-SGV-VCAM
      *DAD fin  21-ABR-1993
                                           GIVING WSS-VAL-SMO4.

           IF WSS-VAL-SMO4 NOT < WSS-VAL-SMO2
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE-1VCTO.

           IF WSS-VAL-SMO4 < WSS-VAL-SMO1
               MOVE 'SGVTPAGFINA<' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CIE-1VCTO.
           SUBTRACT WSS-VAL-SMO1 FROM WSS-VAL-SMO4 GIVING
                    RCV-SGV-CAPI IN CAN-FLD ROUNDED.
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CIE-1VCTO.
           ADD 1 TO INT-TIPE.
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED.
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING
                    RCV-SGV-FINA IN CAN-FLD ROUNDED.
       FIN-PRO-DESC-CIE-1VCTO.
           EXIT.

       PRO-DESC-CPE-1VCTO SECTION.
       INI-PRO-DESC-CPE-1VCTO.
           IF (CAN-SGV-TPAG IN CAN-FLD = ZEROES AND WSS-IBLK-TPAG = 'S')
              OR (CAN-SGV-TPAG IN CAN-FLD NOT > ZEROS)
               MOVE 'CANSGVTPAGOB' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE.

           PERFORM PRO-UVCT-DVEG.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2
               MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2
               MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2
               MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2
           ELSE
               MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2
               MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2
               MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2
               MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
      *
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-1VCTO.
           ADD 1 TO INT-TIPE.
           MOVE INT-TIPE TO WSS-INT-TIPE IN WSS-VARI.
      *JSS 17-JAN-1992 (Memo.17-12-91)
           IF ICG-SGV-TINT IN CAN-FLD = FRM-SGV-TINT IN CAN-FLD
               GO TO CON-PRO-DESC-CPE-1VCTO.
      *
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
           IF ICG-SGV-TINT IN CAN-FLD = ZEROES
      *JSS 24-JAN-1992 (Memo.04-12-1991/pto.2.2)
              IF WSS-IBLK-TINT = 'N' AND ITR-COD-CVTI IN ITR > SPACES
                  NEXT SENTENCE
              ELSE
                  GO TO CON-PRO-DESC-CPE-1VCTO.
      *DAD fin  11-MAY-1994
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC1
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC1
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC1
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC1
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
      *DAD ini  11-MAY-1994   (Memo.19-04-94 Pto.1)
      *     PERFORM CAL-TIPE.
           PERFORM CAL-TIPE-DESC.
      *DAD fin  11-MAY-1994
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-1VCTO.
           SUBTRACT INT-TIPE FROM WSS-INT-TIPE GIVING WSS-INT-TIPE.
       CON-PRO-DESC-CPE-1VCTO.
           DIVIDE CAN-SGV-TPAG IN CAN-FLD BY SCR-SGV-VCAM
                                      GIVING WSS-VAL-SMO4.
           DIVIDE WSS-VAL-SMO4 BY WSS-INT-TIPE GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                           RCV-SGV-CAPI IN CAN-FLD ROUNDED.
                                  RCV-SGV-CAPI IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *
           ADD WSS-VAL-SMO4 TO SCR-SGV-IPFC.
           IF WSS-OPEC NOT = 'B'
               SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM SCR-SGV-IPFC.
      *
           SUBTRACT RCV-SGV-CAPI IN CAN-FLD FROM VEN-VAL-SCAP IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-1VCTO.
           PERFORM PRO-UVCT-DVEG.
           MOVE VEN-NUM-DVEN IN VEN     TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN     TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN     TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN     TO FEC-AEC2.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE 'S' TO WSS-IND-SPR2.
           PERFORM CAL-TIPE.
           IF INT-CMSG > SPACES
               GO TO FIN-PRO-DESC-CPE-1VCTO.
           ADD 1 TO INT-TIPE.
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *    MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1 ROUNDED.
           MULTIPLY WSS-VAL-SMO1 BY INT-TIPE GIVING WSS-VAL-SMO1.
      *DAD fin  31-MAY-1994
           SUBTRACT WSS-VAL-SMO1 FROM VEN-VAL-SFIN IN CAN-FLD GIVING
      *DAD ini  31-MAY-1994   (Memo.16-12-92)
      *                           RCV-SGV-FINA IN CAN-FLD ROUNDED.
                                  RCV-SGV-FINA IN CAN-FLD.
      *DAD fin  31-MAY-1994
      *DAD ini  31-MAY-1994   (Memo.19-04-94 Pto.2)
           SUBTRACT RCV-SGV-FINA IN CAN-FLD FROM VEN-VAL-SFIN IN CAN-FLD
                    GIVING WSS-VAL-SMO1.
           IF WSS-VAL-SMO1 NOT > ZEROES
               MOVE 'MSCFCAN=T'  TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRO-DESC-CPE-1VCTO.
      *DAD fin  31-MAY-1994
       FIN-PRO-DESC-CPE-1VCTO.
           EXIT.

       VAL-TMAX-CONV SECTION.
       INI-VAL-TMAX-CONV.
      *DAD ini  29-JUL-1991
      *     IF CAN-FEC-FCAN IN CAN     > VEN-FEC-FVEN IN VEN AND
      *        CAN-FEC-FCAN IN CAN NOT > VEN-FEC-FIMV IN VEN
      *         IF WSS-IBLK-TINT = 'S'
      *         MOVE ITR-SGV-TINT IN ITR TO ICG-SGV-TINT IN CAN-FLD
      *         IF ITR-COD-CVTI IN ITR > SPACES
      *             MOVE ITR-SGV-SPRD IN ITR TO ICG-SGV-TINT IN CAN-FLD
      *             GO TO FIN-VAL-TMAX-CONV
      *         ELSE
      *             GO TO FIN-VAL-TMAX-CONV.
      *DAD fin  29-JUL-1991
           MOVE 0 TO WSS-INT-TB90 WSS-INT-TS90 WSS-INT-TMAX.
           MOVE 'TAB'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB.
           MOVE '0999' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF OPC-COD-VCOC IN OPC = TAB-COD-CTAB IN TAB
               MOVE 'S' TO WSS-PESO
           ELSE
               MOVE 'N' TO WSS-PESO.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF OPC-MSC-TVOC IN OPC = MSC-COD-CMSC IN MSC
             MOVE WSS-IND-TMMN IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI
           ELSE
             MOVE WSS-IND-TMMX IN WSS-VARI TO WSS-IND-TMON IN WSS-VARI.
           IF WSS-PESO-SI
               PERFORM BUS-CIC-PLZO
               IF WSS-PLZO-B90
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TB90
               ELSE
                   MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TS90
           ELSE
               MOVE FRM-SGV-TINT IN CAN-FLD TO WSS-INT-TMAX.
           MOVE ZEROES              TO INT-TIPE.
           MOVE OPC-NUM-DCOL IN OPC TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN OPC TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN OPC TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN OPC TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC TO INT-VCAM.
           IF WSS-PESO-SI
               PERFORM VAL-TMXC-PESO
           ELSE
           IF WSS-IND-TMON = WSS-IND-TMMN
               PERFORM VAL-TMXC-MREA
           ELSE
               PERFORM VAL-TMXC-MEXT.
       FIN-VAL-TMAX-CONV.
           EXIT.

       VAL-TMXC-PESO SECTION.
       INI-VAL-TMXC-PESO.
           IF WSS-INT-TB90 NOT > 0
               GO TO TS9-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TB90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TB9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TB9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR 
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TB90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TB90 > WSS-INT-TMXC
               MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
      *
       TS9-VAL-TMXC-PESO.
           IF WSS-INT-TS90 NOT > 0
               GO TO FIN-VAL-TMXC-PESO.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE CAM-COD-MNAC           TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TS90'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAM$TS9NEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAM$TS9NVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VMSS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30  TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-PESO.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR 
                  GO TO FIN-VAL-TMXC-PESO
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-PESO.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30       TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TS90.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-PESO.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TS90 > WSS-INT-TMXC
               MOVE 'CAN$TS9>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-PESO.
       FIN-VAL-TMXC-PESO.
           EXIT.

       VAL-TMXC-MREA SECTION.
       INI-VAL-TMXC-MREA.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MREA.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC    TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-MREA.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR 
               GO TO FIN-VAL-TMXC-MREA.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30   TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MREA.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CAN$TB9>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR 
                  GO TO FIN-VAL-TMXC-MREA
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MREA.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMRJ>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MREA.
       FIN-VAL-TMXC-MREA.
           EXIT.

       VAL-TMXC-MEXT SECTION.
       INI-VAL-TMXC-MEXT.
           IF WSS-INT-TMAX NOT > 0
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE 'TMEX'                 TO CAM-COD-VCAM IN CAM(1).
           MOVE 'TMXC'                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'CAMTMXCNEX' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           IF CAM-IND-VIGE IN CAM NOT = 'S'
               MOVE 'CAMTMXCNVG' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE CAM-SGV-VCAM IN CAM TO INT-TINT.
           MOVE 'VASS'              TO INT-TIPT.
           IF WSS-IBLK-TINT NOT = 'S' AND
              FRM-IND-TIPE IN CAN-FLD NOT > SPACES
               MOVE 30     TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMXC.
           IF WSS-IBLK-TINT = 'S'
               MOVE '1' TO FRM-IND-TIPE IN CAN-FLD
               MULTIPLY INT-TIPE BY 100 GIVING ICG-SGV-TINT IN CAN-FLD
               PERFORM GLS-INT-TIPE
               GO TO FIN-VAL-TMXC-MEXT.
           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100 GIVING
                     WSS-INT-TIPE
              PERFORM GLS-INT-TIPE
              IF WSS-INT-TIPE > INT-TIPE
                  MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR
                  GO TO FIN-VAL-TMXC-MEXT
              ELSE
                  MOVE WSS-INT-TIPE TO INT-TIPE
                  MOVE 'S' TO WSS-IBLK-TINT
                  GO TO FIN-VAL-TMXC-MEXT.
           MOVE SPACES TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS 20-JAN-1992 (Memo.04-12-91 pto.2)
           MOVE SPACES TO INT-CVTI.
      *
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TMAX.
           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE 30                      TO INT-SEPD.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
           MOVE INT-TIPE TO WSS-INT-TIPE.
           IF WSS-INT-TIPE > WSS-INT-TMXC
               MOVE WSS-INT-TIPE TO WSS-INT-TMXC.
           IF WSS-INT-TMAX > WSS-INT-TMXC
               MOVE 'CANTMEX>TMXC' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-TMXC-MEXT.
       FIN-VAL-TMXC-MEXT.
           EXIT.

       BUS-CIC-PLZO SECTION.
       INI-BUS-CIC-PLZO.
           MOVE 'VSN'         TO TAB-COD-TTAB IN TAB.
           MOVE 'CALMORAFMAV' TO TAB-COD-CTAB IN TAB.
           MOVE 'COL' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FMV-BUS-CIC-PLZO.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX'        TO MSG-COD-MENS
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-CIC-PLZO.
           MOVE 'PZO'               TO TAB-COD-TTAB IN TAB.
           MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-PLZO
           ELSE
               MOVE 'TABPZO NEX' TO MSG-COD-MENS
               MOVE TAB-COD-CTAB IN TAB TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-BUS-CIC-PLZO.
       FMV-BUS-CIC-PLZO.
           MOVE DLC-KEY-IDLC IN DLC TO WSS-DLC-KEY-IDLC.
           MOVE ZEROS               TO WSS-DLC-FEC-FMAV.
           MOVE ZEROS               TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
       LUP-BUS-CIC-PLZO.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   DLC-CIC-IOPC IN DLC = WSS-DLC-CIC-IOPC)
               GO TO CON-BUS-CIC-PLZO.
           IF DLC-FEC-FMAV IN DLC > WSS-DLC-FEC-FMAV
               MOVE DLC-FEC-FMAV IN DLC TO WSS-DLC-FEC-FMAV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-CIC-PLZO.
       CON-BUS-CIC-PLZO.
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE WSS-DLC-NUM-DMAV    TO FEC-DEC2.
           MOVE WSS-DLC-NUM-MMAV    TO FEC-MEC2.
           MOVE WSS-DLC-NUM-SMAV    TO FEC-SEC2.
           MOVE WSS-DLC-NUM-AMAV    TO FEC-AEC2.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE FEC-DIF-DIA         TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF FEC-NDIA < 90
               MOVE 'C1' TO WSS-PLZO
           ELSE
               MOVE 'S9' TO WSS-PLZO.
           MOVE WSS-DLC-KEY-IDLC TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       FIN-BUS-CIC-PLZO.
           EXIT.

       GLS-INT-TIPE SECTION.
       INI-GLS-INT-TIPE.
           MOVE 'TIPE'              TO ITR-COD-TINT IN ITR.
           MOVE 'TIPE'              TO SCR-COD-TICG.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'INT'               TO TAB-COD-TTAB IN TAB.
           MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ITR-COD-TINT IN ITR NOT > SPACES
               MOVE 'TASA PERIODO' TO FRM-GLS-TINT IN CAN-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TINT IN CAN-FLD.
       FIN-GLS-INT-TIPE.
           EXIT.

       CAL-TFPR-CAN SECTION.
       INI-CAL-TFPR-CAN.
           MOVE SPACES TO WSS-CMSG WSS-MENS.    
      *Si VEN ya esta completo continua en el despliegue
           IF VEN-IND-CALC IN VEN NOT = 'N'
               GO TO DSP-CAL-TFPR-CAN.
      *
      *Debe calcular tasa de interes del periodo entre
      *MIN(MAX(FDEV,FVEN anterior o FCOL),VEN actual) y VEN actual,
      *entonces ...

      *En principio asume 0 para IDNI
           MOVE ZEROES TO WSS-VAL-IDNI IN WSS-VARI.
      *
      *Lee el documento asociado al vencimiento
           MOVE VEN-CIC-IOPC IN VEN TO DLC-CIC-IOPC IN DLC.
           MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NEX' TO MSG-COD-MENS INT-CMSG
               MOVE DLC-KEY-IDLC IN DLC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es el primer vencimiento FMAX = MAX(FDEV,FCOL) y continua
           IF VEN-NUM-IVEN IN VEN = 1
               IF DLC-FEC-FDEV IN DLC > OPC-FEC-FCOL IN OPC
                   MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO WSS-FEC-FMAX
                   GO TO CON-CAL-TFPR-CAN.
      *
      *Lee vencimiento anterior ( pero antes asume FMAX como fecha
      *del actual por si ocurre un error al leer el anterior )
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX.

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           SUBTRACT 1             FROM VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS
                   MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FMAX
                   MOVE VEN-VAL-IDNI IN VEN TO WSS-VAL-IDNI
                                               IN WSS-VARI.
      *
      *Compara la fecha del DLC con la FVEN(FMAX) del VEN anterior
      *FMAX = MAX(FDEV,FVEN anterior) y continua
           IF DLC-FEC-FDEV IN DLC > WSS-FEC-FMAX
               MOVE DLC-FEC-FDEV IN DLC TO WSS-FEC-FMAX.
      *
      *Restaura el VEN actual
           ADD 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
           ELSE
               PERFORM COL-FIO-VEN.
       CON-CAL-TFPR-CAN.
      *FUNO = MIN(CANDIDATO=MAX(FDEV,FCOL o FVEN anterior),FVEN actual)
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FMAX
               MOVE VEN-NUM-DVEN IN VEN TO INT-DUNO
               MOVE VEN-NUM-MVEN IN VEN TO INT-MUNO
               MOVE VEN-NUM-SVEN IN VEN TO INT-SUNO
               MOVE VEN-NUM-AVEN IN VEN TO INT-AUNO
           ELSE
               MOVE WSS-NUM-DMAX TO INT-DUNO
               MOVE WSS-NUM-MMAX TO INT-MUNO
               MOVE WSS-NUM-SMAX TO INT-SUNO
               MOVE WSS-NUM-AMAX TO INT-AUNO.
      *Carga FDOS, FCOL, FBTV, TINT, TIPT, VCAM y llama a rutina GNS-CAL-INT
      *para obtener tasa de periodo
           MOVE VEN-NUM-DVEN IN VEN     TO INT-DDOS.
           MOVE VEN-NUM-MVEN IN VEN     TO INT-MDOS.
           MOVE VEN-NUM-SVEN IN VEN     TO INT-SDOS.
           MOVE VEN-NUM-AVEN IN VEN     TO INT-ADOS.

           MOVE OPC-NUM-DCOL IN OPC     TO INT-DCOL.
           MOVE OPC-NUM-MCOL IN OPC     TO INT-MCOL.
           MOVE OPC-NUM-SCOL IN OPC     TO INT-SCOL.
           MOVE OPC-NUM-ACOL IN OPC     TO INT-ACOL.

           MOVE CAN-NUM-DCAN IN CAN-FLD TO INT-DBTV.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO INT-MBTV.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO INT-SBTV.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO INT-ABTV.

           MOVE FRM-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
      *JSS uso de spread para calculo 1ra cuota (Memo.13/05/92)
           IF VEN-NUM-IVCT IN VEN = 1 AND
              INT-CVTI > SPACES AND INT-TFPR = 'C' AND
              SCR-SGV-SPR2 > 0
               MOVE 'COL'       TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE 'VSNLIQTMXCBCI' TO TAB-COD-TABL IN TAB
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
                   MOVE SCR-SGV-SPR2 TO INT-SPR2.
      *
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.

      *SMC-INI 07.09.1993
           MOVE OPC-CIC-IOPC IN OPC TO INT-IOPC
           MOVE VEN-NUM-IDLC IN VEN TO INT-IDLC
      *     PERFORM GNS-CAL-INT.
           PERFORM COL-CAL-INT.
      *SMC-FIN 09.09.1993
           IF INT-CMSG > SPACES
               MOVE INT-CMSG            TO MSG-COD-MENS
               MOVE CAM-KEY-CAMB IN CAM TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.
      *
           ADD WSS-VAL-SCRE IN WSS-VARI WSS-VAL-IDNI IN WSS-VARI
               GIVING WSS-VAL-INTE IN WSS-VARI.
           MULTIPLY WSS-VAL-INTE IN WSS-VARI BY INT-TIPE GIVING
                    WSS-VAL-INTE IN WSS-VARI ROUNDED.
           ADD WSS-VAL-IDNI IN WSS-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si el credito esta en moneda nacional ( no reajustable ), redondea
      *sin centavos el interes
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
            MOVE WSS-VAL-INTE IN WSS-VARI TO PES-SGV-DECI IN PES-VARI
            PERFORM PES-SCTV
            MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-INTE IN WSS-VARI.
      *
      *Si a la cuota le falta el valor final, lo completa con el interes
      *correspondiente
           IF VEN-VAL-FINA IN VEN = 0
               MOVE 'F' TO SCR-RCV-STAT
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN
           ELSE
      *Si a la cuota le falta el valor capital, lo completa con el interes
      *correspondiente
            MOVE 'C' TO SCR-RCV-STAT
            SUBTRACT WSS-VAL-INTE IN WSS-VARI FROM 
                     VEN-VAL-FINA IN VEN GIVING    VEN-VAL-CAPI IN VEN
            MOVE VEN-VAL-CAPI IN VEN          TO   VEN-VAL-SCAP IN VEN.

      *Verifica si el capital es mayor que el saldo del credito,
      *asume capital el saldo del credito
           IF VEN-VAL-SCAP IN VEN > WSS-VAL-SCRE IN WSS-VARI
               MOVE 'F' TO SCR-RCV-STAT
               MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.

      *Si los intereses son mayores que el valor final ( esta situacion se
      *puede dar solo cuando la cuota esta definida con valor final conocido )
      *por ahora se aborta
           IF WSS-VAL-INTE IN WSS-VARI > VEN-VAL-FINA IN VEN
               MOVE 'CANINTEFINA>' TO INT-CMSG MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-CAL-TFPR-CAN.

      *Si es la ultima cuota y el valor de capital es menor que el saldo
      *del credito, asume capital el saldo del credito
           IF VEN-FEC-FVEN IN VEN = DLC-FEC-FMAV IN DLC AND
              VEN-VAL-SCAP IN VEN < WSS-VAL-SCRE IN WSS-VARI
      *JSS 27-JAN-1992 (Memo.06-12-1991/Pto.1)
              AND ( OPC-IND-VSTR IN OPC = 'S' OR
                  ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'T' ) )
      *
               MOVE 'F' TO SCR-RCV-STAT
               MOVE WSS-VAL-SCRE IN WSS-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-CAPI IN VEN      TO VEN-VAL-SCAP IN VEN
               ADD WSS-VAL-INTE IN WSS-VARI
                   VEN-VAL-CAPI IN VEN GIVING  VEN-VAL-FINA IN VEN
               MOVE VEN-VAL-FINA IN VEN     TO VEN-VAL-SFIN IN VEN.
      *
      *Si el credito esta en moneda nacional ( no reajustable ), redondea
      *sin centavos
           IF OPC-COD-VCOC IN OPC = CAM-COD-MNAC IN CAM-VARI
               MOVE VEN-VAL-CAPI IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-CAPI IN VEN
               MOVE VEN-VAL-FINA IN VEN TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO VEN-VAL-FINA IN VEN.
      *
      *JSS 4-APR-1991 17:27:38
       DSP-CAL-TFPR-CAN.
      *En este punto el VEN esta completo

      *Despliega los datos del vencimiento que esta completando
      *si es CTE ( en caso de CTT se hace en el LUP correspondiente ) o
      *en el caso de ser un vencimiento ( ya que un CTT en este caso es
      *tratado como CTE )
           IF ( SCR-MSC-FCAN = 'T' AND SCR-MSC-ECAN = 'E' ) OR
              OPC-NUM-VCOR IN OPC = 1
               MOVE VEN-VAL-SCAP IN VEN TO VEN-VAL-SCAP IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO VEN-VAL-SFIN IN CAN-FLD
               MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN CAN-FLD
               MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN CAN-FLD.
       FIN-CAL-TFPR-CAN.
           EXIT.
      *>>>>
*% END
