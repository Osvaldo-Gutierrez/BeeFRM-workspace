*%! Codigo adicional para archivo
*% PGM_PTC = TRUE
*% IF SETTAG
*% FNCPQ = "NOVSNT"
*% VSNPQ = "06.04.27"
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-CAI-IOPC.
           03  WSS-COD-TOPC             PIC X(01).
           03  WSS-COD-COPC             PIC X(03).
       01  WSS-CON-VEN                  PIC 9(04).

       COPY GNSWGPES.      
       COPY SGCBRDBC.
       COPY COLBRCAN.
       COPY COLBRITR.
       COPY COLBRVEN.
       COPY COLWXCAC.
       COPY COLWGCAC.
       COPY COLWGVEN.
       COPY COLBRICG.
       COPY COLBRTOC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLWGINT.
       COPY COLBRRDC.
       COPY COLBRRCV.
       COPY TABBRCAM.
      
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *>>>>
*% END
*% IF WSS AND PGM_DTC
      *<<<< WSS AND PGM_DTC

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF      SCR-OFRM-SRV
                   MOVE TSK-TERM-ALF        TO CAC-COD-TERM-VEN
                   MOVE TSK-TERM-ALF        TO CAC-COD-TERM-CAN
                   MOVE TSK-TERM-ALF        TO CAC-COD-TERM-M-V
                   MOVE TSK-TERM-ALF        TO CAC-COD-TERM-M-C
                   MOVE TSK-TERM-ALF        TO CAC-COD-TERM-CVC
           ELSE
                   MOVE EIBTRMID            TO CAC-COD-TERM-VEN
                   MOVE EIBTRMID            TO CAC-COD-TERM-CAN
                   MOVE EIBTRMID            TO CAC-COD-TERM-M-V
                   MOVE EIBTRMID            TO CAC-COD-TERM-M-C
                   MOVE EIBTRMID            TO CAC-COD-TERM-CVC
                   MOVE SPACES              TO CAC-TS-CVC.
      *>>>>
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
                MOVE 'OPCIDLCNORDC' TO MSG-COD-MENS IN MSG
                GO TO MSG-FND-KEY.
           IF OPC-LIQUIDADA OR OPC-ACTIVADA
               NEXT SENTENCE
           ELSE
                MOVE 'S' TO SCR-IERR
                MOVE 'OPCSTATINVAL' TO MSG-COD-MENS IN MSG
                GO TO MSG-FND-KEY.
           PERFORM DEL-QUE-CAC.

      *--------------  TASA DE OPERACION  ---------------------------*
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
               IF ITR-COD-CVTI IN ITR > SPACES
                   MOVE ITR-SGV-SPRD IN ITR TO ITR-SGV-TINT IN ITR
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-ITR.
      *--------------  GLOSA DE TASA --------------------------------*
           IF      FIO-STAT-OKS AND
                   ITR-COD-TINT IN ITR > SPACES
                   MOVE 'COL'               TO TAB-COD-SIST
                   MOVE 'INT'               TO TAB-COD-TTAB IN TAB
                   MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TINT
           ELSE
                   MOVE SPACES              TO FRM-GLS-TINT.
      *--------------------------------------------------------------*
           IF FIO-STAT-OKS AND ITR-COD-CVTI IN ITR > SPACES
               MOVE 'I'                 TO CAM-MSC-TVAL IN CAM(1)
               MOVE ITR-COD-CVTI IN ITR TO CAM-COD-CVAL IN CAM(1)
               MOVE ITR-MSC-PBTI IN ITR TO CAM-COD-TCAM IN CAM(1)
               MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL IN OPC TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC TO CAM-COD-VCAM IN CAM(2)
               PERFORM TAB-FIO-CAM
               IF FIO-STAT-OKS
                   ADD CAM-SGV-VCAM IN CAM TO ITR-SGV-TINT IN ITR.
      *--------------  EJECUTO FIO-RDC  -----------------------------*
           MOVE OPC-CAI-IOPC IN OPC     TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC     TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
      *-------------- INICIO INCORPORADO 08-06-1993 ------------
      * DSP COMPATIBILIDAD VSAM-DTC PERFORM COL-SEQ-RDC-IDLC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
      * DSP COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              (OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC) AND
              (OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC) AND
              (RDC-NUM-IDLC IN RDC = ZEROES)
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *-------------- FIN INCORPORADO 08-06-1993 ------------
           IF FIO-STAT-OKS AND
              (OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC) AND
              (OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC) AND
              (RDC-NUM-IDLC IN RDC = ZEROES)
      * ISP
      *       MOVE RDC-IIC-ICLI IN RDC  TO DBC-IIC-ICLI IN DBC
              MOVE RDC-CIC-ICLI IN RDC  TO DBC-CIC-ICLI IN DBC
              MOVE FIO-GET-KEY          TO FIO-CMND
              PERFORM SGC-FIO-DBC
              MOVE FIO-STAT TO PGM-STAT-DBC
              IF FIO-STAT-OKS
                  NEXT SENTENCE
              ELSE
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  GO TO MSG-FND-KEY
           ELSE
               MOVE 'CLI    NODIR' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.
      *----------lectura tabla ven   --------------
           MOVE FRM-NUM-VDES IN CAC-FLD  TO VEN-NUM-IVEN IN VEN.
           MOVE    ZEROES                   TO WS-VENTOT.
           MOVE    ZEROES                   TO WS-CANTOT.
      *    MOVE 1 TO WSS-CON-VEN.
      *HZF FIN-11101993
           MOVE OPC-CIC-IOPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY  TO FIO-CMND.
      *    PERFORM COL-FIO-VEN
      *    PERFORM COL-OBT-VEN.
           MOVE    VEN-SOKS                 TO VEN-STAT.
           PERFORM SET-COLBGCAC
                                          VARYING WS-VEN
                                          FROM 1 BY 1
                                          UNTIL NOT VEN-STAT-OKS.
           MOVE    OPC-CAI-IOPC IN OPC      TO VEN-CAI-IOPC IN VEN.
           MOVE    OPC-IIC-IOPC IN OPC      TO VEN-IIC-IOPC IN VEN.
           MOVE    FRM-NUM-VDES IN CAC-FLD  TO VEN-NUM-IVEN IN VEN.
           MOVE    FIO-GET-KEY              TO FIO-CMND.
           PERFORM COL-OBT-VEN.
           IF      FIO-STAT-OKS
                   MOVE FIO-STAT            TO PGM-STAT-VEN.
           IF      SCR-OFRM-SRV
                   IF  FRM-NUM-VHAS IN CAC-FLD = ZEROES
                       MOVE 669          TO FRM-NUM-VHAS IN CAC-FLD.
           MOVE    FRM-NUM-VDES-ALF IN CAC-FLD TO WS-VENINI.
           MOVE    FRM-NUM-VHAS-ALF IN CAC-FLD TO WS-VENFIN.
           MOVE    ZEROES                   TO WS-CANINI.
           MOVE    ZEROES                      TO WS-CANFIN.
           IF      SCR-OFRM-SRV
                   PERFORM LEE-TSCVC
           ELSE
                   MOVE    'SIN'            TO CAC-CON-CVC.
           IF      CAC-TS-CVC = SPACES
                   PERFORM GRABA-COLAVEN               VARYING WS-L
                                                     FROM 1 BY 1
                                                       UNTIL WS-L > 12
                   PERFORM GRABA-COLACAN               VARYING WS-L
                                                       FROM 1 BY 1
                                                       UNTIL WS-L > 6
                   PERFORM GRABA-TSCAC-MASV
                   PERFORM GRABA-TSCAC-MASC.
           IF      CAC-TS-CVC = 'VEN'
                   MOVE    CAC-LEN-TSCAC-VEN        TO QUE-LITM
                   MOVE    QUE-PUT                  TO QUE-CMND
                   MOVE    ZEROES                   TO WS-C
                   MOVE    FRM-NUM-VDES IN CAC-FLD  TO WS-R
                   PERFORM GRABA-COLAVEN-CVC           VARYING WS-L
                                                       FROM WS-R BY 1
                                                       UNTIL WS-C = 12
                   PERFORM GRABA-TSCAC-MASV.
           IF      CAC-TS-CVC = 'CAN'
                   MOVE    CAC-LEN-TSCAC-CAN        TO QUE-LITM
                   MOVE    QUE-PUT                  TO QUE-CMND
                   MOVE    ZEROES                   TO WS-C
                   MOVE    FRM-NUM-VDES IN CAC-FLD  TO WS-R
                   PERFORM GRABA-COLACAN-CVC           VARYING WS-L
                                                       FROM WS-R BY 1
                                                       UNTIL WS-C = 6
                   PERFORM GRABA-TSCAC-MASC.
           IF      NOT SCR-OFRM-SRV     
                   MOVE   ZEROES                    TO WS-C
                   IF     FRM-NUM-VDES IN CAC-FLD = ZEROES
                          MOVE 1             TO FRM-NUM-VDES IN CAC-FLD  
                          MOVE FRM-NUM-VDES IN CAC-FLD TO WS-R
                          PERFORM MUESTRA-VEN
                   ELSE
                          MOVE FRM-NUM-VDES IN CAC-FLD TO WS-R
                          PERFORM MUESTRA-VEN.
           MOVE    FIO-STAT                 TO PGM-STAT-VEN.
           ADD     1                        TO WSS-CON-VEN.
           ADD     1                        TO FRM-IFLD.
           MOVE    '00'                     TO FIO-STAT.
           GO TO   FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
                       MOVE 1 TO FRM-IFLD.
       LUP-PUT-TAB.
      **********************************************
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEE-TSCVC SECTION.
      *------------------
       INI-LEE-TSCVC.
           MOVE    QUE-GET                  TO QUE-CMND.
           MOVE    CAC-TSCAC-CVC            TO QUE-COLA.
           MOVE    CAC-TS-CVC               TO QUE-ITEM.
           MOVE    CAC-LEN-TSCAC-CVC        TO QUE-LITM.
           MOVE    1                        TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF      QUE-STAT NOT = QUE-STAT-OKS
                   MOVE SPACES              TO CAC-CON-CVC
                   MOVE 1                   TO FRM-NUM-VDES IN CAC-FLD
                   GO TO FIN-LEE-TSCVC.
           IF      FRM-NUM-VDES IN CAC-FLD = ZEROES
                   MOVE 1                   TO FRM-NUM-VDES IN CAC-FLD.
           MOVE    QUE-ITEM                 TO CAC-TS-CVC.
           MOVE    CAC-TSCAC-CVC            TO QUE-COLA.
           MOVE    QUE-DEL                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-LEE-TSCVC.
           EXIT.

       GRABA-COLAVEN SECTION.
      *----------------------
       INI-GRABA-COLAVEN.
           IF      TABV-NUM-IVCT (WS-L) = ZEROES OR
                   WS-L                 > 12
                   MOVE 69                  TO WS-L
                   GO TO  FIN-GRABA-COLAVEN.
           MOVE    TABV-NUM-IVCT (WS-L)     TO WSS-NUM-IVCT.
           IF      TABV-MSC-STAT (WS-L) = 'PAG'
                   MOVE 'P'                 TO WSS-IND-CANC
           ELSE
                   MOVE 'V'                 TO WSS-IND-CANC.
           MOVE    TABV-FEC-FVEN (WS-L)     TO WSS-FEC-FVEN.
           MOVE    TABV-VAL-INTE (WS-L)     TO WSS-VAL-INTC.  
           MOVE    TABV-VAL-CAPI (WS-L)     TO WSS-VAL-SCAP.
           MOVE    TABV-VAL-FINA (WS-L)     TO WSS-VAL-TOTA.
           MOVE    CAC-TS-VEN-MTX           TO QUE-ITEM.
           MOVE    QUE-PUT                  TO QUE-CMND.
           MOVE    CAC-LEN-TSCAC-VEN        TO QUE-LITM.
           MOVE    CAC-TSCAC-VEN            TO QUE-COLA.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-COLAVEN.
           EXIT.

       GRABA-COLACAN SECTION.
      *----------------------
       INI-GRABA-COLACAN.
           IF      TABC-NUM-IVCT (WS-L) = ZEROES  OR
                   WS-L                 > 6
                   MOVE 69                  TO WS-L
                   GO TO  FIN-GRABA-COLACAN.
           MOVE    TABC-NUM-IVCT (WS-L)     TO WSS-NUM-IVEN-ALF.
           MOVE    TABC-NUM-ICAN (WS-L)     TO WSS-NUM-ICAN-ALF.
           MOVE    TABC-SGV-CAPI (WS-L)     TO WSS-SGV-CAPI.
           MOVE    TABC-SGV-INTE (WS-L)     TO WSS-SGV-INTE.
           MOVE    TABC-SGV-INTP (WS-L)     TO WSS-SGV-INTP.
           MOVE    TABC-COD-CANC (WS-L)     TO WSS-COD-CANC.
           MOVE    TABC-COD-STAT (WS-L)     TO WSS-COD-STAT.
           MOVE    TABC-FEC-FCAN (WS-L)     TO WSS-FEC-FCAN.
           MOVE    TABC-SGV-TPAG (WS-L)     TO WSS-SGV-TPAG.
           MOVE    TABC-SGV-VREN (WS-L)     TO WSS-SGV-VREN.
           MOVE    TABC-SGV-SEGU (WS-L)     TO WSS-SGV-SEGU.
           MOVE    CAC-TS-CAN-MTX           TO QUE-ITEM.
           MOVE    CAC-LEN-TSCAC-CAN        TO QUE-LITM.
           MOVE    CAC-TSCAC-CAN            TO QUE-COLA.
           MOVE    QUE-PUT                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-COLACAN.
           EXIT.

       GRABA-TSCAC-MASV SECTION.
      *-------------------------
       INI-GRABA-TSCAC-MASV.
           COMPUTE WS-CUPO = WS-R + WS-GRABADOS - 1.
           IF      WS-CUPO NOT < WS-VENTOT
                   MOVE 'N'                 TO CAC-MAS-IND-HMAS-V
           ELSE
                   MOVE 'S'                 TO CAC-MAS-IND-HMAS-V.
           IF      FRM-NUM-VDES IN CAC-FLD > FRM-NUM-VHAS IN CAC-FLD
                   MOVE 'N'                 TO CAC-MAS-IND-HMAS-V
                   MOVE ZEROES              TO WS-GRABADOS.  
           MOVE    WS-GRABADOS              TO CAC-MAS-NUM-TOCC-V.
           MOVE    CAC-LEN-TSCAC-MAS        TO QUE-LITM.
           MOVE    CAC-NOM-TSCAC-MAS-V      TO QUE-COLA.
           MOVE    CAC-MAS-ITEM-V           TO QUE-ITEM.
           MOVE    QUE-PUT                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-TSCAC-MASV.
           EXIT.

       GRABA-TSCAC-MASC SECTION.
      *-------------------------
       INI-GRABA-TSCAC-MASC.
           COMPUTE WS-CUPO = WS-R + WS-GRABADOS - 1.
           IF      WS-CUPO NOT < WS-CANTOT
                   MOVE 'N'                 TO CAC-MAS-IND-HMAS-C
           ELSE
                   MOVE 'S'                 TO CAC-MAS-IND-HMAS-C.
           IF      FRM-NUM-VDES IN CAC-FLD > FRM-NUM-VHAS IN CAC-FLD
                   MOVE 'N'                 TO CAC-MAS-IND-HMAS-C
                   MOVE ZEROES              TO WS-GRABADOS. 
           MOVE    WS-GRABADOS              TO CAC-MAS-NUM-TOCC-C.
           MOVE    CAC-LEN-TSCAC-MAS        TO QUE-LITM.
           MOVE    CAC-NOM-TSCAC-MAS-C      TO QUE-COLA.
           MOVE    CAC-MAS-ITEM-C           TO QUE-ITEM.
           MOVE    QUE-PUT                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-TSCAC-MASC.
           EXIT.

       GRABA-COLAVEN-CVC SECTION.
      *--------------------------
       INI-GRABA-COLAVEN-CVC.
           IF      TABV-NUM-IVCT (WS-L) = ZEROES
                   MOVE   12                TO WS-C
                   GO TO  FIN-GRABA-COLAVEN-CVC.
           IF      TABV-NUM-IVCT (WS-L) < FRM-NUM-VDES IN CAC-FLD OR
                   TABV-NUM-IVCT (WS-L) > FRM-NUM-VHAS IN CAC-FLD
                   MOVE   12                TO WS-C
                   GO TO  FIN-GRABA-COLAVEN-CVC.
           ADD     1                        TO WS-C.
           MOVE    WS-C                     TO WS-GRABADOS.
           IF      WS-C > 12
                   GO TO  FIN-GRABA-COLAVEN-CVC.
           MOVE    TABV-NUM-IVCT (WS-L)     TO WSS-NUM-IVCT.
           MOVE    TABV-MSC-STAT (WS-L)     TO WSS-IND-CANC.
           MOVE    TABV-FEC-FVEN (WS-L)     TO WSS-FEC-FVEN.
           MOVE    TABV-VAL-INTE (WS-L)     TO WSS-VAL-INTC.
           MOVE    TABV-VAL-CAPI (WS-L)     TO WSS-VAL-SCAP.
           MOVE    TABV-VAL-FINA (WS-L)     TO WSS-VAL-TOTA.
           MOVE    CAC-TS-VEN-MTX           TO QUE-ITEM.
           MOVE    QUE-PUT                  TO QUE-CMND.
           MOVE    CAC-LEN-TSCAC-VEN        TO QUE-LITM.
           MOVE    CAC-TSCAC-VEN            TO QUE-COLA.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-COLAVEN-CVC.
           EXIT.
   
       GRABA-COLACAN-CVC SECTION.
      *--------------------------
       INI-GRABA-COLACAN-CVC.
           IF      TABC-NUM-IVCT (WS-L) = ZEROES
                   MOVE   6                 TO WS-C
                   GO TO  FIN-GRABA-COLACAN-CVC.
           IF      TABC-NUM-ICAN (WS-L) < FRM-NUM-VDES IN CAC-FLD OR
                   TABC-NUM-ICAN (WS-L) > FRM-NUM-VHAS IN CAC-FLD
                   MOVE   6                 TO WS-C
                   GO TO  FIN-GRABA-COLACAN-CVC.
           ADD     1                        TO WS-C.
           MOVE    WS-C                     TO WS-GRABADOS.
           IF      WS-C > 6
                    GO TO  FIN-GRABA-COLACAN-CVC.            
           MOVE    TABC-NUM-IVCT (WS-L)     TO WSS-NUM-IVEN-ALF.
           MOVE    TABC-NUM-ICAN (WS-L)     TO WSS-NUM-ICAN-ALF.
           MOVE    TABC-SGV-CAPI (WS-L)     TO WSS-SGV-CAPI.
           MOVE    TABC-SGV-INTE (WS-L)     TO WSS-SGV-INTE.
           MOVE    TABC-SGV-INTP (WS-L)     TO WSS-SGV-INTP.
           MOVE    TABC-COD-CANC (WS-L)     TO WSS-COD-CANC.
           MOVE    TABC-COD-STAT (WS-L)     TO WSS-COD-STAT.
           MOVE    TABC-FEC-FCAN (WS-L)     TO WSS-FEC-FCAN.
           MOVE    TABC-SGV-TPAG (WS-L)     TO WSS-SGV-TPAG.
           MOVE    TABC-SGV-VREN (WS-L)     TO WSS-SGV-VREN.
           MOVE    TABC-SGV-SEGU (WS-L)     TO WSS-SGV-SEGU.
           MOVE    CAC-TS-CAN-MTX           TO QUE-ITEM.
           MOVE    CAC-LEN-TSCAC-CAN        TO QUE-LITM.
           MOVE    CAC-TSCAC-CAN            TO QUE-COLA.
           MOVE    QUE-PUT                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-GRABA-COLACAN-CVC.
           EXIT.

       DEL-QUE-CAC SECTION.
       INI-DEL-QUE-CAC.
      *----------------
           MOVE    CAC-NOM-TSCAC-VEN        TO QUE-COLA.
           MOVE    QUE-DEL                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE    CAC-NOM-TSCAC-CAN        TO QUE-COLA.
           MOVE    QUE-DEL                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE    CAC-NOM-TSCAC-MAS-C      TO QUE-COLA.
           MOVE    QUE-DEL                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE    CAC-NOM-TSCAC-MAS-V      TO QUE-COLA.
           MOVE    QUE-DEL                  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-DEL-QUE-CAC.
      *----------------
           EXIT.
       
       COPY COLBGCAC.
       COPY COLBFICG.
       COPY COLBFTOC.
       COPY COLBFDLC.
       COPY COLBFEVC.

       COPY GNSBPFEC.
       COPY GNSBGPES.
       COPY COLBGVEN.
       COPY COLBGINT.
       COPY TABBFCAM.
       COPY SGCBFDBC.
       COPY COLBFCAN.
       COPY COLBFITR.
       COPY COLBFVEN.
       COPY COLBFRDC.
       COPY COLBFRCV.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
      *>>>>
*% END
