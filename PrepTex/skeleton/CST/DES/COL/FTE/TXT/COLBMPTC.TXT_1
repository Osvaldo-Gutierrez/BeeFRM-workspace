*%! Codigo adicional para programa PTC
*% IF FIN_PUT_ALL_PTC
      *<<<<
      *Busca glosa en tablas
           IF POC-COD-CVTI IN PTC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE 'I' TO WSS-COD-TVTI
               MOVE POC-COD-CVTI IN PTC-FLD TO WSS-COD-CVTI
               MOVE POC-MSC-PBTI IN PTC-FLD TO WSS-COD-TCTI
               MOVE WSS-COD-VCAM TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF POC-COD-CVTI IN PTC-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN PTC-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-CVTI IN PTC-FLD.
      *Busca glosa en tablas
           IF PTC-COD-AOOC IN PTC-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE PTC-COD-TOOC IN PTC-FLD TO WSS-COD-TOOC
               MOVE PTC-COD-AOOC IN PTC-FLD TO WSS-COD-AOOC
               MOVE WSS-COD-COOC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF PTC-COD-AOOC IN PTC-FLD > SPACES
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN PTC-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-AOOC IN PTC-FLD.
      *>>>>
*% END
*% IF POC_COD_CVTI
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE 'I' TO WSS-COD-TVTI.
           MOVE POC-COD-CVTI IN PTC-FLD TO WSS-COD-CVTI.
           MOVE POC-MSC-PBTI IN PTC-FLD TO WSS-COD-TCTI.
           MOVE WSS-COD-VCAM TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
                POC-COD-CVTI IN PTC-FLD > SPACES
                MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CVTI IN PTC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CVTI IN PTC-FLD.
      *>>>>
*% END
*% IF PTC_COD_AOOC
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE PTC-COD-TOOC IN PTC-FLD TO WSS-COD-TOOC.
           MOVE PTC-COD-AOOC IN PTC-FLD TO WSS-COD-AOOC.
           MOVE WSS-COD-COOC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
                PTC-COD-AOOC IN PTC-FLD > SPACES
                MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN PTC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN PTC-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_PTC
      *<<<< INI_VAL_CON_KEY_PTC
           IF NOT ( PTC-COD-VCOC IN PTC-FLD > SPACES
                AND PTC-COD-OFOC IN PTC-FLD > SPACES
                AND PTC-COD-TOOC IN PTC-FLD > SPACES
                AND PTC-COD-AOOC IN PTC-FLD > SPACES )
                MOVE 'GNS'          TO MSG-COD-SIST
                MOVE 'VALCONKEY' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC   TO FRM-MENS
                MOVE FRM-SUAR-MAL   TO FRM-SUAR
                GO TO FIN-VAL-CON-KEY-PTC.
      *>>>>
*% END
*% IF VAL_CON_FLD_PTC
      *<<<<  VAL_CON_FLD_PTC
           IF PTC-SGV-TIMA IN PTC-FLD < PTC-SGV-TINO IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALTIMATINO<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-SGV-TINO IN PTC-FLD < PTC-SGV-TIMI IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALTINOTIMI<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-SGV-TCMA IN PTC-FLD < PTC-SGV-TCNO IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALTCMATCNO<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-SGV-TCNO IN PTC-FLD < PTC-SGV-TCMI IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALTCNOTCMI<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-VAL-CMIN IN PTC-FLD > PTC-VAL-CMAX IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALCMINCMAX>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-VAL-GMIN IN PTC-FLD > PTC-VAL-GMAX IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALGMINGMAX>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
           IF PTC-VAL-PGMI IN PTC-FLD > PTC-VAL-PGMA IN PTC-FLD
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALPGMIPGMA>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTC.
      *>>>>
*% END
