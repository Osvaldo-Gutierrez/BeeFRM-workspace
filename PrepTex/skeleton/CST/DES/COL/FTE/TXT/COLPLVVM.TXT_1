*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *DOS SELECT RPTVVF         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTVVF         ASSIGN TO        UT-S-RPTVVF.
           SELECT RPTVVF         ASSIGN TO        UT-S-RPTVVF.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTVVF LABEL RECORDS OMITTED
           REPORT IS RPT-VVF.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY COLRWVVF.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRVLR.
       COPY TABBRCAM.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRICG.
      *DAD ini  15-DEC-1993
       COPY COLBRCYA.
      *DAD fin  15-DEC-1993
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY COLWGVEN.
       COPY GNSWGCVI.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY COLBREVC.
       COPY COLBRRCV.
       COPY COLBRRDT.
      *DAD ini  22-JUL-1991
       COPY COLWGCAU.
       COPY COLWGCTO.
       COPY TABBRTIO.
      *DAD fin  22-JUL-1991

       01  WSS-VARI.
      *       RESPALDA VEN(1) PARA OPERACIONES ESTRUCTURADAS, PARA
      *       EXPANDIR PROXIMOS VENCIMIENTOS DE ESA ESTRUCTURA DENTRO
      *       DEL RANGO DE FECHAS Y LUEGO RESTAURARLO Y SEGUIR RECORRIENDO
      *       LA BASE DE DATOS
           03 SCR-VEN-KEY-IVEN                       PIC X(15).
           03 WSS-VEN-KEY-IVEN                       PIC X(15).
           03 PGM-STAT-RDT VALUE SPACES              PIC X(02).
              88 PGM-STAT-RDT-OKS VALUE  '00'.

      *       INDICADOR PARA OBTENER VENCIMIENTOS DENTRO DEL RANGO
      *       ASOCIADOS A UNA ESTRUCTURA
           03 WSS-IND-RECO   VALUE 0              PIC 9(01).
              88 RECORRE-ESTRUCTURA               VALUE 1.

      *       INDICADOR PARA DETERMINAR EOF DE RDT
           03 WSS-IND-LAST   VALUE ' '             PIC X(01).
              88 LAST-RDT VALUE 'S'.

      *       NRO OPERACION PARA RDT'S DE UN MISMO DOCUMENTO
           03 WSS-RDT-CIC-IOPC                    PIC X(12).

      *       NRO DOCUMENTO PARA RDT'S DE UN MISMO DOCUMENTO
           03 WSS-RDT-NUM-IDLC                    PIC 9(03).

      *       STATUS VALIDACION PRO-DLC-VEN
           03 WSS-IND-DLC                         PIC X(01).
      *
      *    Saldo Documento
           03  WSS-RDT-VAL-SRDT   COMP-3          PIC 9(11)V9(04).
      *
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET                     PIC 9(02).
              05 WSS-NUM-AFET                     PIC 9(02).
              05 WSS-NUM-MFET                     PIC 9(02).
              05 WSS-NUM-DFET                     PIC 9(02).
           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-COD-OFOC                        PIC X(03).
           03 WSS-COD-RMOC                        PIC X(12).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-CIC-IOPC                        PIC X(12).
           03 WSS-GLS-NOMM                        PIC X(25).
           03 WSS-GLS-NOMF                        PIC X(25).
           03 WSS-SW                              PIC 9(01).
      * CODIGOS PARA SITUACIONES MOROSA.
           03 WSS-COD-SMOR      VALUE LOW-VALUES  PIC X(08).

      *VERIFCAR CIC MONEDA CHILENA Y NO PESOS
           03  WSS-VLR.    
               05  WSS-CIC-VCAM.
      *            Tipo Valor
                   07  WSS-CIC-TVAL                     PIC X(01).
      *            Codigo Valor
                   07  WSS-CIC-CVAL                     PIC X(03).
      *            Tipo Cambio
                   07  WSS-CIC-TCAM                     PIC X(08).

      * NUMERO SIN DECIMALES ( PARA TRUNCAR )
           03 WSS-NUM-NDEC                              PIC 9(12).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                      PIC X(03).
               05  WSS-COD-AOOC                      PIC X(03).
      * GLOSAS TIO + AUX
           03  WSS-GLS-TIAU.
               05 WSS-GLS-TIO                        PIC X(40).
               05 WSS-GLS-AUX                        PIC X(40).
      *
      *DAD ini  07-DEC-1990 
           03  WSS-GLS-DAT3.
               05 FILLER                               PIC X(17).
               05 WSS-IND-OMIT                         PIC X(01).
               05 FILLER                               PIC X(12).
           03  WSS-IND                                 PIC 9(02).
           03  TAB-FLU-MOR-FUT.
               05 WSS-TAB-MOR      OCCURS 25.
                  07 WSS-COD-MORN                      PIC X(06).
                  07 WSS-VAL-MORN                      PIC 9(12)V9(04).
                  07 WSS-COD-MORE                      PIC X(06).
                  07 WSS-VAL-MORE                      PIC 9(12)V9(04).
               05 WSS-TAB-FUT      OCCURS 25.
                  07 WSS-COD-FUTN                      PIC X(06).
                  07 WSS-VAL-FUTN                      PIC 9(12)V9(04).
                  07 WSS-COD-FUTE                      PIC X(06).
                  07 WSS-VAL-FUTE                      PIC 9(12)V9(04).
      *DAD fin  07-DEC-1990 
      *DAD ini  31-JUL-1991
           03 WSS-COD-COOC.
              05 WSS-IND-COOC      OCCURS 10           PIC X(06).
      *DAD fin  31-JUL-1991
      *DAD ini  29-MAY-1992   (Memo.29-05-92)
           03 WSS-IND-HAYR                             PIC 9(01).
      *DAD fin  29-MAY-1992
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==. 
      *DAD ini  15-DEC-1993
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==. 
      *DAD fin  15-DEC-1993
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRFVVF.
           .
       COPY COLRTVVF.
      *>>>>
*% END
*% IF CF_VVM_OPC_COD_RMOC
      *<<<< CF_VVM_OPC_COD_RMOC
           MOVE  1  TO WSS-SW IN WSS-VARI.
      *>>>>
*% END
*% IF PH_VVM
      *<<<< PH_VVM
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-VVM
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-VVM.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF OPC-COD-RMOC IN SRT > SPACES
               MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VVM
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-VVM.
      *>>>> END
*% END
*% IF INI
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura Fecha de Inicio
      *     DISPLAY 'FECHA DE INICIO ( DDMMSSAA ) : '.
      *     ACCEPT  WSS-FEC-FINI IN WSS-VARI.
      *     IF WSS-FEC-FINI NOT > SPACES
      *         MOVE WSS-FEC-FPRO TO WSS-FEC-FINI.
      *     DISPLAY WSS-FEC-FINI IN WSS-VARI.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO WSS-NUM-DINI IN WSS-FEC-FINI.
           MOVE HOY-MHOY TO WSS-NUM-MINI IN WSS-FEC-FINI.
           MOVE HOY-SHOY TO WSS-NUM-SINI IN WSS-FEC-FINI.
           MOVE HOY-AHOY TO WSS-NUM-AINI IN WSS-FEC-FINI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMSSAA ) : '.
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           IF WSS-FEC-FTER NOT > SPACES
      *DAD ini  23-SEP-1991
               MOVE WSS-FEC-FINI TO WSS-FEC-FTER.
      *DAD fin  23-SEP-1991
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
      *Captura Ejecutivo Operacion Credito
           DISPLAY 'EJECUTIVO : '.
           ACCEPT  WSS-COD-RMOC IN WSS-VARI.
      *DAD ini  31-JUL-1991
      * Captura Codigo Clase Operacion
           DISPLAY 'CLASE OPERACION (*=TODAS) : '.
           MOVE SPACES TO WSS-COD-COOC IN WSS-VARI.
           ACCEPT  WSS-COD-COOC IN WSS-VARI.
           DISPLAY WSS-COD-COOC IN WSS-VARI.
      *DAD fin  31-JUL-1991

           DISPLAY 'FIN    CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Inicio
      *     MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-FBLK-N   TO FEC-FBLK.
      *     MOVE FEC-CHOY-GE  TO FEC-CHOY.
      *     MOVE FEC-VHBL-N   TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-OKS
      *         DISPLAY 'ABORTO: FECHA DE INICIO'
      *         DISPLAY WSS-FEC-FINI ' ' FEC-MENS
      *         PERFORM GNS-PRO-END.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ABORTO: FECHA DE TERMINO ERRONEA'
               DISPLAY WSS-FEC-FTER ' ' FEC-MENS
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY 'ABORTO:'
               DISPLAY MSG-GLS-DESC IN MSG
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

      *DAD ini  23-SEP-1991
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DPRO IN WSS-VVM
                                            WSS-NUM-DPRO IN WSS-VVF.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MPRO IN WSS-VVM
                                            WSS-NUM-MPRO IN WSS-VVF.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SPRO IN WSS-VVM
                                            WSS-NUM-SPRO IN WSS-VVF.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-APRO IN WSS-VVM
                                            WSS-NUM-APRO IN WSS-VVF.
      *DAD fin  23-SEP-1991
           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-VVM
                                            WSS-NUM-DINI IN WSS-VVF
                                            WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-VVM
                                            WSS-NUM-MINI IN WSS-VVF
                                            WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-VVM
                                            WSS-NUM-SINI IN WSS-VVF
                                            WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-VVM
                                            WSS-NUM-AINI IN WSS-VVF
                                            WSS-NUM-AFEC IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-VVM
                                            WSS-NUM-DTER IN WSS-VVF
                                            WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-VVM
                                            WSS-NUM-MTER IN WSS-VVF
                                            WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-VVM
                                            WSS-NUM-STER IN WSS-VVF
                                            WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-VVM
                                            WSS-NUM-ATER IN WSS-VVF
                                            WSS-NUM-AFET IN WSS-VARI.

      *Compara Fechas en Dias entregando Nro. de Dias de Futuros Vencimientos
      *DAD ini  23-SEP-1991
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
      *DAD fin  23-SEP-1991
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-NDIA TO WSS-NUM-FFVA IN WSS-VVF.

      *VAL-OFI Valida Codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY 'ABORTO : OFICINA INEXISTENTE ' WSS-COD-OFOC
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
                   PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               DISPLAY 'OFICINA : ' OFI-COD-OFIC IN OFI '  '
                                    OFI-GLS-DESC IN OFI
           ELSE
               DISPLAY 'OFICINA : ' 'TODAS'.

      *VAL-USR Valida Codigo de Usuario en TABLAS
           IF WSS-COD-RMOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-RMOC IN WSS-VARI.
           IF WSS-COD-RMOC IN WSS-VARI NOT = '*'
               MOVE WSS-COD-RMOC IN WSS-VARI TO USR-COD-USER IN USR
               PERFORM VAL-USR
               IF MSG-COD-MENS > SPACES
                   DISPLAY 'ABORTO : USUARIO INEXISTENTE '
                           WSS-COD-RMOC
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
                   PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

           IF WSS-COD-RMOC IN WSS-VARI NOT = '*'
               DISPLAY 'EJECUTIVO : ' USR-COD-USER '  '
                                      USR-GLS-DESC
           ELSE
               DISPLAY 'EJECUTIVO : ' 'TODOS'.

      *DAD ini  31-JUL-1991
      *VAL-TAB Valida Clase de Operacion en TABLAS
           IF WSS-COD-COOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-COOC IN WSS-VARI.
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               MOVE 1 TO WSS-IND IN WSS-VARI
               PERFORM VAL-PAR-COOC UNTIL WSS-IND IN WSS-VARI > 10
               DISPLAY WSS-COD-COOC IN WSS-VARI
               IF WSS-COD-COOC IN WSS-VARI NOT > SPACES
                   DISPLAY 'NO EXISTE NINGUNA CLASE INGRESADA VALIDA'
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
                   PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
      *DAD fin  31-JUL-1991

      *DAD ini  31-JAN-1992 
      * BUSCA CODIGO DE SITUACION CONTABLE "MOROSO"
      *     MOVE 'COL'  TO MSC-COD-SIST.
      *     MOVE 'SCTB' TO MSC-CIC-TMSC IN MSC.
      *     MOVE 'MOR'  TO MSC-CIC-CMSC IN MSC.
      *     MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
      *     PERFORM BUS-MSC.
      *     IF MSG-COD-MENS = SPACES
      *         MOVE MSC-COD-CMSC IN MSC TO WSS-COD-SMOR
      *     ELSE
      *         DISPLAY 'ABORTO : SIS = COL, MSC = SCTB, '
      *                 'MSC-CIC-CMSC = MOR'
      *         DISPLAY ' ' MSG-GLS-DESC
      *         PERFORM GNS-PRO-END.
      *DAD fin  31-JAN-1992

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      **************************************************************************
      *DAD ini  22-JUL-1991
      * Proceso para Cargar la tabla  COL/AUX  en Memoria
           PERFORM COL-CRG-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
      *DAD ini  29-MAY-1992   (Memo.27-04-92)
               PERFORM GNS-PRO-ABT.
      *DAD fin  29-MAY-1992
      *DAD fin  22-JUL-1991
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *DAD ini  22-JUL-1991 / 12-JUL-1991 
      *    Se Optimizo Bloqueando los Mensajes para Seguir DBUG del Proceso y
      *    Eliminando los Mensajes Intracendentes de Rechazos (NO Error)
      *    Ademas se Cargaron en Memoria las tablas AUX y TOC para Validaciones
      *DAD fin  22-JUL-1991 / 12-JUL-1991 

           MOVE SPACES TO OPC-CIC-IOPC IN OPC.

      * Lee primer registro VEN con situacion contable <> "   "
           MOVE '  A' TO VEN-IND-SCTB IN VEN.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO HAY REGISTROS PARA SITUACION CONTABLE'
               GO TO FIN-VEN-SCTB.

      *DAD ini  12-JUL-1991 
           DISPLAY ' INICIO DE SELECCION POR SCTB'.
      *DAD fin  12-JUL-1991 
       CIC-VEN-SCTB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-VEN-SCTB.

      *DAD ini  12-JUL-1991 
      *     DISPLAY VEN-KEY-IVEN ' VCTO CON SCTB <> SPACES'.
      *DAD fin  12-JUL-1991 
      *DAD ini  07-DEC-1990
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FFEC IN WSS-VARI OR
              VEN-VAL-SFIN IN VEN NOT > ZEROES
      *DAD fin  07-DEC-1990 
                MOVE 'VEN-IND-SCTB' TO FIO-AKEY
                MOVE FIO-GET-NXT    TO FIO-CMND
                PERFORM COL-FIO-VEN
                GO TO CIC-VEN-SCTB.

           IF VEN-CIC-IOPC IN VEN NOT = OPC-CIC-IOPC IN OPC
               PERFORM GET-OPC-VEN
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO OPC-CIC-IOPC IN OPC
                   DISPLAY VEN-KEY-IVEN '    VCTO RECHAZADO NO '
                                        'EXISTE OPERACION ASOCIADA'
                   MOVE 'VEN-IND-SCTB' TO FIO-AKEY
                   MOVE FIO-GET-NXT    TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   GO TO CIC-VEN-SCTB.

           PERFORM VRF-OPC.
           IF MSG-COD-MENS > SPACES
      *DAD 22-JUL-1991
               MOVE 'VEN-IND-SCTB' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-VEN
               GO TO CIC-VEN-SCTB.

      *DAD ini  31-JUL-1991
      * Valida que pertenezca a Clase del parametro
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               MOVE 1 TO WSS-IND IN WSS-VARI
               PERFORM VAL-SEL-COOC UNTIL WSS-IND IN WSS-VARI > 10 OR
                                     WSS-IND-COOC IN WSS-VARI(WSS-IND) =
                                                  OPC-COD-COOC IN OPC
               IF WSS-IND IN WSS-VARI > 10
                   MOVE 'VEN-IND-SCTB' TO FIO-AKEY
                   MOVE FIO-GET-NXT    TO FIO-CMND
                   PERFORM COL-FIO-VEN
                   GO TO CIC-VEN-SCTB.
      *DAD fin  31-JUL-1991

      *DAD ini  22-JUL-1991 / 07-DEC-1990
      * Busca con el Codigo Clase Operacion en la Tabla cargada en Memoria
      * el Indicador de Exclusion o Inclusion segun programa
           MOVE OPC-COD-COOC IN OPC TO CAU-COOC IN CAU-VARI.
           PERFORM COL-BUS-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
                       'OPERACION SIN COD-COOC : ' OPC-KEY-IOPC IN OPC
               MOVE 'VEN-IND-SCTB' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-VEN
               GO TO CIC-VEN-SCTB.

      * Excluye Tipos de Operaciones segun Indicador en Pos. 48 Datos Anexos
           MOVE CAU-DAT3 IN CAU-VARI TO WSS-GLS-DAT3 IN WSS-VARI.
           IF WSS-IND-OMIT IN WSS-VARI = 'X'
               MOVE 'VEN-IND-SCTB' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-VEN
               GO TO CIC-VEN-SCTB.
      *DAD fin  22-JUL-1991 / 07-DEC-1990

           PERFORM GET-TOC.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               DISPLAY VEN-KEY-IVEN '    VCTO RECHAZADO'
                                    ' CAUSA ( TOC ) : ' MSG-GLS-DESC
               MOVE 'VEN-IND-SCTB' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM COL-FIO-VEN
               GO TO CIC-VEN-SCTB.
           
           MOVE 'M' TO SRT-IND-MORA.
           MOVE 'M' TO SRT-IND-TIPO.
      *DAD ini  12-JUL-1991 
      *     DISPLAY VEN-KEY-IVEN ' VCTO SELECCIONADO EN SCTB'.
      *DAD fin  12-JUL-1991 

      * OBTIENE VALOR DE CAMBIO PARA MONEDA DEL CREDITO
           PERFORM CNV-VCAM.

      *DAD ini  17-DEC-1993   (Memo.28-10-93)
      * OBTIENE CUENTA CORRIENTE DE CARGO DEL CREDITO
           PERFORM OBT-CCTE.
      *DAD fin  17-DEC-1993

           PERFORM MOV-INP-SRT.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           GO TO CIC-VEN-SCTB.
       FIN-VEN-SCTB.
           DISPLAY ' FIN SELECCION SCTB'.

      * Lee primer registro VEN con Fecha Inicial del rango de fechas
           MOVE WSS-FEC-FFEC IN WSS-VARI TO VEN-FEC-FVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS OR
              VEN-FEC-FVEN IN VEN > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS PARA RANGO DE FECHAS : DESDE '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT.
      *DAD ini  12-JUL-1991 
           DISPLAY ' INICIO DE SELECCION POR RANGO DE FECHAS'.
      *DAD fin  12-JUL-1991 
           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           MOVE VEN-KEY-IVEN IN VEN TO WSS-VEN-KEY-IVEN.

      * VERIFICA ULTIMO VENCIMIENTO DE UNA ESTRUCTURA
           IF RECORRE-ESTRUCTURA
               IF VEN-STAT-EOF
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT
               ELSE
               IF NOT VEN-STAT-OKS
                   DISPLAY VEN-KEY-IVEN
                              '    ERROR EN EXPANSION DE VCTO '
                   MOVE 'COL'    TO MSG-COD-SIST
                   MOVE VEN-STAT TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT.

      * Verifica que Fecha Vencimiento no sobrepase Fecha Superior del rango
      * de fechas
      *    VERIFICA QUE FECHA DE VENCIMIENTO NO SOBREPASE LIMITE MAXIMO
      *    ESTE CODIGO SE PUEDE OPTIMIZAR NO LLAMANDO A RUTINA DE FECHAS
      *    BASTARIA DEFINIRSE LAS VARIABLES ADECUADAS PARA COMPARAR
           MOVE WSS-FEC-FTER        TO FEC-FEC1.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               IF RECORRE-ESTRUCTURA
      *DAD ini  12-JUL-1991 
      *             DISPLAY VEN-KEY-IVEN ' VCTO '
      *                     'ESTRUCTURADO RECHAZADO FUERA DE RANGO'
      *DAD fin  12-JUL-1991 
                   PERFORM GET-NXT-VEN-FVEN
                   GO TO LUP-INP-SRT
               ELSE
      *DAD ini  12-JUL-1991 
      *             DISPLAY VEN-KEY-IVEN ' VCTO '
      *                     'NO ESTRUCTURADO RECHAZADO FUERA '
      *                     'DE RANGO'
      *DAD fin  12-JUL-1991 
                   GO TO FIN-INP-SRT.

           IF VEN-VAL-SFIN IN VEN NOT > ZEROES
               GO TO NXT-INP-SRT.

      * SI CODIGO DE SITUACION CONTABLE DE VENCIMIENTO ES
      *    "MOROSA" ==> NO CONSIDERAR VENCIMIENTO
      *     MOVE 'COL'               TO MSC-COD-SIST.
      *     MOVE 'SCTB'              TO MSC-CIC-TMSC IN MSC.
      *     MOVE VEN-IND-SCTB IN VEN TO MSC-COD-CMSC IN MSC.
      *     PERFORM BUS-MSC.
      *     IF MSG-COD-MENS NOT = SPACES
      *         GO TO NXT-INP-SRT.
      *     IF MSC-CIC-CMSC IN MSC = WSS-COD-SMOR IN WSS-VARI
      *         GO TO NXT-INP-SRT.

      *    LEE UNA SOLA VEZ OPERACION ASOCIADA A 'N' VENCIMIENTOS.
           IF VEN-CIC-IOPC IN VEN NOT = OPC-CIC-IOPC IN OPC
               PERFORM GET-OPC-VEN
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO OPC-CIC-IOPC IN OPC
                   DISPLAY VEN-KEY-IVEN ' VCTO RECHAZADO NO '
                                        'EXISTE OPERACION ASOCIADA'
                   GO TO NXT-INP-SRT.

           PERFORM VRF-OPC.
           IF MSG-COD-MENS > SPACES
      *DAD 22-JUL-1991
               GO TO NXT-INP-SRT.

      *DAD ini  31-JUL-1991
      * Valida que pertenezca a Clase del parametro
           IF WSS-COD-COOC IN WSS-VARI NOT = '*'
               MOVE 1 TO WSS-IND IN WSS-VARI
               PERFORM VAL-SEL-COOC UNTIL WSS-IND IN WSS-VARI > 10 OR
                                     WSS-IND-COOC IN WSS-VARI(WSS-IND) =
                                                  OPC-COD-COOC IN OPC
               IF WSS-IND IN WSS-VARI > 10
                   GO TO NXT-INP-SRT.
      *DAD fin  31-JUL-1991

      *DAD ini  22-JUL-1991 / 07-DEC-1990
      * Busca con el Codigo Clase Operacion en la Tabla cargada en Memoria
      * el Indicador de Exclusion o Inclusion segun programa
           MOVE OPC-COD-COOC IN OPC TO CAU-COOC IN CAU-VARI.
           PERFORM COL-BUS-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
                       'OPERACION SIN COD-COOC : ' OPC-KEY-IOPC IN OPC
               GO TO NXT-INP-SRT.

      * Excluye Tipos de Operaciones segun Indicador en Pos. 48 Datos Anexos
           MOVE CAU-DAT3 IN CAU-VARI TO WSS-GLS-DAT3 IN WSS-VARI.
           IF WSS-IND-OMIT IN WSS-VARI = 'X'
               GO TO NXT-INP-SRT.
      *DAD fin  22-JUL-1991 / 07-DEC-1990

           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
      *DAD ini  12-JUL-1991 
      *     DISPLAY VEN-KEY-IVEN ' VCTO CANDIDATO'.
      *DAD fin  12-JUL-1991 

           IF NOT RECORRE-ESTRUCTURA
               IF OPC-IND-VSTR IN OPC = 'S'
      *DAD ini  12-JUL-1991 
      *              DISPLAY VEN-KEY-IVEN ' VCTO RESPALDADO'
      *DAD fin  12-JUL-1991 
                    MOVE WSS-VEN-KEY-IVEN TO SCR-VEN-KEY-IVEN
                    MOVE 1 TO WSS-IND-RECO
               ELSE
                    MOVE 0 TO WSS-IND-RECO.

           PERFORM GET-TOC.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               DISPLAY VEN-KEY-IVEN ' VCTO RECHAZADO'
                                    ' CAUSA ( TOC ) : ' MSG-GLS-DESC
               GO TO NXT-INP-SRT.
           
           MOVE 'V' TO SRT-IND-MORA.
           MOVE 'V' TO SRT-IND-TIPO.
      *DAD ini  12-JUL-1991 
      *     DISPLAY VEN-KEY-IVEN ' VCTO SELECCIONADO'
      *DAD fin  12-JUL-1991 

      * OBTIENE VALOR DE CAMBIO PARA MONEDA DEL CREDITO
           PERFORM CNV-VCAM.

      *DAD ini  17-DEC-1993   (Memo.28-10-93)
      * OBTIENE CUENTA CORRIENTE DE CARGO DEL CREDITO
           PERFORM OBT-CCTE.
      *DAD fin  17-DEC-1993
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< IF INI_NXT_INP
      * Mueve la Llave Alternativa por la cual se leera VEN
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF RECORRE-ESTRUCTURA
      *DAD ini  12-JUL-1991 
      *          DISPLAY VEN-KEY-IVEN ' VCTO A EXPANDIR'
      *DAD fin  12-JUL-1991 
                PERFORM COL-OBT-VEN
                MOVE '00' TO FIO-STAT
      *DAD ini  12-JUL-1991 
      *          DISPLAY VEN-KEY-IVEN ' VCTO EXPANDIDO'
      *DAD fin  12-JUL-1991 
           ELSE
      *DAD ini  12-JUL-1991 
      *          DISPLAY VEN-KEY-IVEN ' VCTO NO ESTRUCTURADO'
      *DAD fin  12-JUL-1991 
                MOVE 'VEN-FEC-FVEN' TO FIO-AKEY
      *DAD ini  12-JUL-1991 
                PERFORM COL-FIO-VEN.
      *          DISPLAY VEN-KEY-IVEN ' VCTO NO ESTRUCTURADO PROXIMO'.
      *DAD fin  12-JUL-1991 

           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
      *DAD ini  12-JUL-1991 
           DISPLAY ' FIN DE SELECCION POR RANGO DE FECHAS'.
      *DAD fin  12-JUL-1991 
      *     PERFORM MOR-DLC.
      *     PERFORM MOR-RDT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
      *DAD ini  29-MAY-1992   (Memo.29-05-92)
           MOVE 0 TO WSS-IND-HAYR IN WSS-VARI.
      *DAD fin  29-MAY-1992
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
      *DAD ini  29-MAY-1992   (Memo.29-05-92)
           MOVE 1 TO WSS-IND-HAYR IN WSS-VARI.
      *DAD fin  29-MAY-1992
           OPEN OUTPUT RPTVVF.
           INITIATE RPT-VVF.
           MOVE  0  TO WSS-SW IN WSS-VARI.
           MOVE OPC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
           MOVE OPC-COD-RMOC IN SRT TO WSS-COD-RMOC IN WSS-VARI.
           MOVE SPACES              TO WSS-GLS-NOMM IN WSS-VARI
                                       WSS-GLS-NOMF IN WSS-VARI.
      *DAD ini  07-DEC-1990 
           PERFORM INI-TAB-FLU-MOR-FUT.
      *DAD fin  07-DEC-1990 
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      * Mediante BUS-TAB Busca Clase de Operacion de Tabla AUX
           MOVE OPC-COD-COOC IN SRT TO OPC-COD-COOC IN OPC.
           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN OPC TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AUX IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-AUX IN WSS-VARI.
           IF OPC-COD-TOOC IN OPC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TIO IN WSS-VARI.
           MOVE WSS-GLS-TIAU IN WSS-VARI TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-COOC IN WSS-VVM.

      * ANTIGUO
      *     IF OPC-COD-COOC IN SRT > SPACES
      *         MOVE 'COL'               TO TAB-COD-SIST
      *         MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
      *         MOVE OPC-COD-COOC IN SRT TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-COOC IN WSS-VVM
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-COOC IN WSS-VVM.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-VCOC IN WSS-VVM
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-VVM.

           IF DBC-GLS-ICLI IN SRT > SPACES
               MOVE '-'    TO WSS-GLS-AUXI IN WSS-VVM
           ELSE
               MOVE SPACES TO WSS-GLS-AUXI IN WSS-VVM.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           IF WSS-SW = 1
               PERFORM BUS-GLS-VVF
               GENERATE DL-VVF
      *DAD ini  07-DEC-1990 
               PERFORM GEN-LIN-MOR
               PERFORM GEN-LIN-FUT
               GENERATE DL-RAY
               PERFORM INI-TAB-FLU-MOR-FUT
               MOVE SPACES TO WSS-GLS-MNAM IN WSS-VVF
                              WSS-GLS-MNAF IN WSS-VVF
                              WSS-GLS-MEXM IN WSS-VVF
                              WSS-GLS-MEXF IN WSS-VVF
      *DAD fin  07-DEC-1990 
               MOVE ZEROES TO WSS-VAL-FVMC IN WSS-VVF
                              WSS-VAL-FVME IN WSS-VVF
                              WSS-NUM-NCVM IN WSS-VVF
                              WSS-VAL-FFVC IN WSS-VVF
                              WSS-VAL-FFVE IN WSS-VVF
                              WSS-NUM-NCFV IN WSS-VVF
                              WSS-SW       IN WSS-VARI.

           IF SRT-IND-MORA IN SRT = 'M'
               PERFORM FLU-VEN-MOR
           ELSE
               PERFORM FLU-FUT-VEN.
           MOVE OPC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-VARI.
           MOVE OPC-COD-RMOC IN SRT TO WSS-COD-RMOC IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
      *DAD ini  29-MAY-1992   (Memo.29-05-92)
           IF WSS-IND-HAYR IN WSS-VARI = 0
               MOVE 'NO EXISTE INFORMACION QUE LISTAR, DE ACUERDO A LOS 
      -             'PARAMETROS INGRESADOS' TO WSS-GLS-MENS IN WSS-VVM
               GENERATE DL-MSG
               TERMINATE RPT-VVM
               CLOSE RPTVVM
               GO TO EXT-OUT-SRT.
      *DAD fin  29-MAY-1992
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           PERFORM BUS-GLS-VVF.
           GENERATE DL-VVF.
      *DAD ini  07-DEC-1990 
           PERFORM GEN-LIN-MOR.
           PERFORM GEN-LIN-FUT.
           GENERATE DL-RAY.
      *DAD fin  07-DEC-1990 
           TERMINATE RPT-VVF.
           CLOSE RPTVVF.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      *DAD ini  31-JUL-1991
      * Valida que la Clase del parametro Exista
       VAL-PAR-COOC SECTION.
       INI-VAL-PAR-COOC.
           IF WSS-IND-COOC IN WSS-VARI(WSS-IND) > SPACES
               MOVE 'COL'           TO TAB-COD-SIST
               MOVE 'AUX'           TO TAB-COD-TTAB IN TAB
               MOVE WSS-IND-COOC IN WSS-VARI(WSS-IND)
                                    TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS IN MSG > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                           ' CLASE : ' WSS-IND-COOC IN WSS-VARI(WSS-IND)
                   MOVE SPACES TO WSS-IND-COOC IN WSS-VARI(WSS-IND).
           ADD 1 TO WSS-IND IN WSS-VARI.
       FIN-VAL-PAR-COOC.
           EXIT.
      *DAD fin  31-JUL-1991
      **************************************************************************
       GET-OPC-VEN SECTION.
       INI-GET-OPC-VEN.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-GET-OPC-VEN.
           EXIT.
      **************************************************************************
       VRF-OPC SECTION.
       INI-VRF-OPC.
           MOVE SPACES TO MSG-COD-MENS.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'OPC    NOACA' TO MSG-COD-MENS
               GO TO FIN-VRF-OPC.
           
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFOC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   MOVE 'OPC    NOOFI' TO MSG-COD-MENS
                   GO TO FIN-VRF-OPC.

           IF WSS-COD-RMOC IN WSS-VARI NOT = '*'
               IF WSS-COD-RMOC IN WSS-VARI NOT = OPC-COD-RMOC IN OPC
                   MOVE 'OPC    NOMON' TO MSG-COD-MENS
                   GO TO FIN-VRF-OPC.
       FIN-VRF-OPC.
           EXIT.
      **************************************************************************
      *DAD ini  31-JUL-1991
      * Valida que pertenezca a Clase del parametro
       VAL-SEL-COOC SECTION.
       INI-VAL-SEL-COOC.
           ADD 1 TO WSS-IND IN WSS-VARI.
       FIN-VAL-SEL-COOC.
           EXIT.
      *DAD fin  31-JUL-1991
      **************************************************************************
       CNV-VCAM SECTION.
       INI-CNV-VCAM.
      * ASUME ERROR
           MOVE ZEROES TO SRT-VAL-VTRA IN SRT.

      *DAD ini  07-DEC-1990
           MOVE VEN-VAL-SFIN IN VEN TO SRT-VAL-VTRA IN SRT.
           GO TO FIN-CNV-VCAM.
      *DAD fin  07-DEC-1990 

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY ' '
               GO TO FIN-CNV-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *    CONVIERTE A PESOS
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
           IF NOT ( WSS-CIC-TVAL = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               MOVE VEN-VAL-SFIN IN VEN TO SRT-VAL-VTRA IN SRT
               GO TO END-CNV-VCAM.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'CODIGO DE PESOS INEXISTENTE'
               DISPLAY 'OPERACION ' OPC-CIC-IOPC IN OPC
               DISPLAY ' '
               GO TO FIN-CNV-VCAM.

           MOVE VEN-FEC-FVEN IN VEN TO CAM-FEC-FCAM IN CAM(1).
           MOVE VEN-FEC-FVEN IN VEN TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC TO CAM-COD-VCAM IN CAM(1).
      *ISP CODIGO DE PESOS
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODVCAMNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY VEN-KEY-IVEN '    ' MSG-GLS-DESC
               DISPLAY ' PARA VCTO '
               DISPLAY 'PARA FECHA : '      VEN-FEC-FVEN IN VEN
               MOVE ZEROES TO SRT-VAL-VTRA IN SRT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE 'COL'       TO MSG-COD-SIST
                   MOVE 'VALCAMNVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY VEN-KEY-IVEN '    ' MSG-GLS-DESC
                   DISPLAY ' PARA VCTO '
                   DISPLAY 'PARA FECHA : '      VEN-FEC-FVEN IN VEN
                   MOVE ZEROES TO SRT-VAL-VTRA IN SRT
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM
                         BY VEN-VAL-SFIN IN VEN
                     GIVING SRT-VAL-VTRA IN SRT.
       END-CNV-VCAM.
           IF WSS-CIC-TVAL = '0'
                MOVE SRT-VAL-VTRA IN SRT TO WSS-NUM-NDEC
                MOVE WSS-NUM-NDEC TO SRT-VAL-VTRA IN SRT.
       FIN-CNV-VCAM.
           EXIT.
      **************************************************************************
      *DAD ini  17-DEC-1993   (Memo.28-10-93)
      * OBTIENE CUENTA CORRIENTE DE CARGO DEL CREDITO
       OBT-CCTE SECTION.
       INI-OBT-CCTE.
           MOVE OPC-CAI-IOPC IN OPC TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN OPC TO CYA-IIC-IOPC IN CYA.
           MOVE 'AUT'               TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO CYA-IIC-ICYA IN CYA.
       FIN-OBT-CCTE.
           EXIT.
      *DAD fin  17-DEC-1993
      **************************************************************************
       GET-TOC SECTION.
       INI-GET-TOC.
           MOVE SPACES TO MSG-COD-MENS.

      *DAD ini  22-JUL-1991
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memoria el
      * 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : ' CTO-TOOC IN CTO-VARI
               GO TO FIN-GET-TOC.

      * Obtiene 'Opera Como'
           MOVE SPACES               TO TOC.
           MOVE CTO-OPEC IN CTO-VARI TO TOC-MSC-OPEC IN TOC.
      *DAD fin  22-JUL-1991

      * Complementa Formacion del Registro SRT
           IF TOC-MSC-OPEC IN TOC = 'D'
               PERFORM BUS-DLC-ICG
           ELSE
               MOVE ZEROES TO ICG-NUM-ICAN IN ICG
               PERFORM BUS-OPC-ICG.

      *DAD ini  31-JAN-1992   (Memo.11-12-91 pto.2)
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
      *DAD fin  31-JAN-1992

           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-GET-TOC.

      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC > 0 ====> DEU.IND.
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    RDCNX' TO MSG-COD-MENS
               GO TO FIN-GET-TOC.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-GET-TOC.
           EXIT.
      **************************************************************************
      * Busca Documento Legal de Operacion de Credito segun Vencimiento y
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       BUS-DLC-ICG SECTION.
       INI-BUS-DLC-ICG.
           IF VEN-NUM-IDLC IN VEN NOT = 0
               MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
           ELSE
               MOVE VEN-NUM-IVCT IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE OPC-CIC-IOPC IN OPC     TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC
               GO TO FIN-BUS-DLC-ICG.
       GET-ICG-DLC.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               PERFORM BUS-OPC-ICG.
       FIN-BUS-DLC-ICG.
           EXIT.
      *-------------------------------------------------------------------------
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       BUS-OPC-ICG SECTION.
       INI-BUS-OPC-ICG.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                     MOVE '23' TO FIO-STAT.
       FIN-BUS-OPC-ICG.
           EXIT.
      *-------------------------------------------------------------------------
       GET-KEY-IICG SECTION.
       INI-GET-KEY-IICG.
      * Forma Llave KEY-IICG y Lee ICG para Obtener Tasa de Interes
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-ICG.
       FIN-GET-KEY-IICG.
           EXIT.
      **************************************************************************
       GET-NXT-VEN-FVEN SECTION.
       INI-GET-NXT-VEN-FVEN.
           MOVE SCR-VEN-KEY-IVEN TO VEN-KEY-IVEN IN VEN.
      *     MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE 0 TO WSS-IND-RECO.

           MOVE SPACES TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
       FIN-GET-NXT-VEN-FVEN.
           EXIT.
      **************************************************************************
      **************************************************************************
       MOR-DLC SECTION.
       INI-MOR-DLC.
      *    SON MOROSOS TODOS AQUELLOS DOCUMENTOS CON DLC-IND-SCTB <> ' '
      *    Y <> 'MUL'

      *    SE SALTA DLC CON DLC-IND-SCTB = '   '
           MOVE 'A  ' TO DLC-IND-SCTB IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       NXT-MOR-DLC.
           MOVE 'DLC-IND-SCTB' TO FIO-AKEY.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MOR-DLC.
      *    SE SALTA DLC CON DLC-IND-SCTB = 'MUL'
           IF DLC-IND-SCTB IN DLC = 'MUL'
               MOVE 'MUN' TO DLC-IND-SCTB IN DLC
               MOVE FIO-GET-NLS TO FIO-CMND
               GO TO NXT-MOR-DLC.

           PERFORM PRO-DLC-VEN.
           IF WSS-IND-DLC = SPACES
               MOVE DLC-VAL-SDLC IN DLC TO VEN-VAL-SFIN IN VEN
               PERFORM GET-TOC
               MOVE 'M' TO SRT-IND-MORA
               MOVE 'D' TO SRT-IND-TIPO
               PERFORM MOV-INP-SRT
               DISPLAY DLC-KEY-IDLC '    DLC SELECCIONADO'.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO NXT-MOR-DLC.
       FIN-MOR-DLC.
           EXIT.
      *-------------------------------------------------------------------------
       MOR-RDT SECTION.
       INI-MOR-RDT.
      *    SON MOROSOS TODOS LOS RDT
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM COL-FIO-RDT.
           IF NOT FIO-STAT-OKS
               DISPLAY '    NO EXISTEN RDT '
               GO TO FIN-MOR-RDT.

           MOVE RDT-CIC-IOPC IN RDT TO WSS-RDT-CIC-IOPC.
           MOVE RDT-NUM-IDLC IN RDT TO WSS-RDT-NUM-IDLC.
           MOVE ZEROES              TO WSS-RDT-VAL-SRDT.
       NXT-MOR-RDT.
           IF NOT FIO-STAT-OKS
               MOVE '10' TO PGM-STAT-RDT
               GO TO CIC-MOR-RDT.

           IF RDT-CIC-IOPC IN RDT = WSS-RDT-CIC-IOPC AND
              RDT-NUM-IDLC IN RDT = WSS-RDT-NUM-IDLC
                ADD RDT-VAL-SRDT IN RDT TO WSS-RDT-VAL-SRDT
                MOVE FIO-GET-NXT TO FIO-CMND
                PERFORM COL-FIO-RDT
                GO TO NXT-MOR-RDT
           ELSE
                MOVE RDT-CIC-IOPC IN RDT TO WSS-RDT-CIC-IOPC
                MOVE RDT-NUM-IDLC IN RDT TO WSS-RDT-NUM-IDLC
                MOVE FIO-GET-PRV TO FIO-CMND
                PERFORM COL-FIO-RDT
                MOVE WSS-RDT-VAL-SRDT TO RDT-VAL-SRDT IN RDT
                MOVE ZEROES TO WSS-RDT-VAL-SRDT.
       CIC-MOR-RDT.
           MOVE RDT-CIC-IOPC IN RDT TO DLC-CIC-IOPC IN DLC.
           MOVE RDT-NUM-IDLC IN RDT TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
                DISPLAY RDT-KEY-IRDT ' RDT RECHAZADO SIN DLC'
                MOVE FIO-GET-NXT TO FIO-CMND
                PERFORM COL-FIO-RDT
                GO TO NXT-MOR-RDT.

           PERFORM PRO-DLC-VEN.
           IF WSS-IND-DLC = SPACES
                MOVE RDT-VAL-SRDT IN RDT TO VEN-VAL-SFIN IN VEN
                MOVE 'M' TO SRT-IND-MORA
                MOVE 'R' TO SRT-IND-TIPO
                PERFORM MOV-INP-SRT
                DISPLAY DLC-KEY-IDLC '    DLC SELECCIONADO'.

           IF PGM-STAT-RDT-OKS
                MOVE FIO-GET-NXT TO FIO-CMND
                PERFORM COL-FIO-RDT
                GO TO NXT-MOR-RDT.
       FIN-MOR-RDT.
           EXIT.
      *-------------------------------------------------------------------------
       PRO-DLC-VEN SECTION.
       INI-PRO-DLC-VEN.
           MOVE SPACES TO WSS-IND-DLC.
           MOVE ' '    TO WSS-IND-DLC.

           DISPLAY DLC-KEY-IDLC '    DLC CANDIDATO'.
      *    LEE UNA SOLA VEZ OPERACION ASOCIADA A 'N' DOCUMENTOS.
           IF DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               MOVE DLC-CIC-IOPC IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'E' TO WSS-IND-DLC
                   MOVE SPACES TO OPC-CIC-IOPC IN OPC
                   DISPLAY DLC-KEY-IDLC '    DLC RECHAZADO '
                   DISPLAY ' SIN OPERACION'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO FIN-PRO-DLC-VEN.

           PERFORM VRF-OPC.
           IF MSG-COD-MENS > SPACES
               MOVE 'E' TO WSS-IND-DLC
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               DISPLAY DLC-KEY-IDLC '    DLC RECHAZADO '
                                    'CAUSA ( OPC ) : '
               DISPLAY MSG-GLS-DESC
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO FIN-PRO-DLC-VEN.
               
           MOVE DLC-CIC-IOPC IN DLC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-DLC-VEN.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'E' TO WSS-IND-DLC
               DISPLAY DLC-KEY-IDLC ' DLC RECHAZADO '
                                    'FIO-STAT-VEN '
                       FIO-STAT
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO FIN-PRO-DLC-VEN.

           IF DLC-CIC-IOPC IN DLC NOT = VEN-CIC-IOPC IN VEN
               MOVE 'E' TO WSS-IND-DLC
               DISPLAY DLC-KEY-IDLC ' DLC RECHAZADO '
                                    'NO EXISTE PRIMER '
                                    'VCTO MOROSO'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO FIN-PRO-DLC-VEN.

           IF NOT ( DLC-NUM-IDLC IN DLC = VEN-NUM-IDLC AND
                    VEN-VAL-SFIN IN VEN > ZEROES )
                      MOVE FIO-GET-NXT TO FIO-CMND
                      GO TO CIC-DLC-VEN.

           PERFORM GET-TOC.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               DISPLAY VEN-KEY-IVEN '    VCTO RECHAZADO '
                                    ' CAUSA ( TOC ) : ' MSG-GLS-DESC
               GO TO FIN-PRO-DLC-VEN.
       FIN-PRO-DLC-VEN.
           EXIT.
      **************************************************************************
      **************************************************************************
      *DAD ini  07-DEC-1990 
       INI-TAB-FLU-MOR-FUT SECTION.
       INI-INI-TAB-FLU-MOR-FUT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-INI-TAB-FLU-MOR-FUT.
           MOVE ZEROES TO WSS-VAL-MORN IN WSS-VARI(WSS-IND)
                          WSS-VAL-MORE IN WSS-VARI(WSS-IND)
                          WSS-VAL-FUTN IN WSS-VARI(WSS-IND)
                          WSS-VAL-FUTE IN WSS-VARI(WSS-IND).
           MOVE SPACES TO WSS-COD-MORN IN WSS-VARI(WSS-IND)
                          WSS-COD-MORE IN WSS-VARI(WSS-IND)
                          WSS-COD-FUTN IN WSS-VARI(WSS-IND)
                          WSS-COD-FUTE IN WSS-VARI(WSS-IND).
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               GO TO FIN-INI-TAB-FLU-MOR-FUT.
           GO TO LUP-INI-TAB-FLU-MOR-FUT.
       FIN-INI-TAB-FLU-MOR-FUT.
           EXIT.
      *DAD fin  07-DEC-1990 
      **************************************************************************
       BUS-GLS-VVF SECTION.
       INI-BUS-GLS-VVF.
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF WSS-COD-OFOC IN WSS-VARI > SPACES
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-VVF
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-VVF.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF WSS-COD-RMOC IN WSS-VARI > SPACES
               MOVE WSS-COD-RMOC IN WSS-VARI TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VVF
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-VVF.
       FIN-BUS-GLS-VVF.
           EXIT.
      **************************************************************************
       FLU-VEN-MOR SECTION.
       INI-FLU-VEN-MOR.
      *DAD ini  07-DEC-1990 
           IF OPC-MSC-TVOC IN SRT = '0'
               PERFORM MOR-VAL-NAC
           ELSE
               PERFORM MOR-VAL-EXT.
      *DAD fin  07-DEC-1990 
           IF DBC-GLS-NOMC IN SRT NOT = WSS-GLS-NOMM IN WSS-VARI OR
              ( DBC-GLS-NOMC IN SRT = WSS-GLS-NOMM IN WSS-VARI AND
                OPC-COD-RMOC IN SRT NOT = WSS-COD-RMOC IN WSS-VARI )
               ADD  1  TO WSS-NUM-NCVM IN WSS-VVF
               MOVE DBC-GLS-NOMC IN SRT TO WSS-GLS-NOMM IN WSS-VARI.
       FIN-FLU-VEN-MOR.
           EXIT.
      *-------------------------------------------------------------------------
       FLU-FUT-VEN SECTION.
       INI-FLU-FUT-VEN.
      *DAD ini  07-DEC-1990 
           IF OPC-MSC-TVOC IN SRT = '0'
               PERFORM FUT-VAL-NAC
           ELSE
               PERFORM FUT-VAL-EXT.
      *DAD fin  07-DEC-1990 
           IF DBC-GLS-NOMC IN SRT NOT = WSS-GLS-NOMF IN WSS-VARI OR
              ( DBC-GLS-NOMC IN SRT = WSS-GLS-NOMF IN WSS-VARI AND
                OPC-COD-RMOC IN SRT NOT = WSS-COD-RMOC IN WSS-VARI )
               ADD  1  TO WSS-NUM-NCFV IN WSS-VVF
               MOVE DBC-GLS-NOMC IN SRT TO WSS-GLS-NOMF IN WSS-VARI.
       FIN-FLU-FUT-VEN.
           EXIT.
      **************************************************************************
      *DAD ini  07-DEC-1990 
       GEN-LIN-MOR SECTION.
       INI-GEN-LIN-MOR.
           MOVE 1 TO WSS-IND IN WSS-VARI.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES AND
              WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES
               GENERATE DL-FMO
               GO TO FIN-GEN-LIN-MOR.
       LUP-GEN-LIN-MOR.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-MORN IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MNAM IN WSS-VVF
                MOVE WSS-VAL-MORN IN WSS-VARI(WSS-IND) 
                                         TO WSS-VAL-FVMC IN WSS-VVF
           ELSE
                MOVE SPACES TO WSS-GLS-MNAM IN WSS-VVF
                MOVE ZEROES TO WSS-VAL-FVMC IN WSS-VVF.

           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-MORE IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MEXM IN WSS-VVF
                MOVE WSS-VAL-MORE IN WSS-VARI(WSS-IND) 
                                         TO WSS-VAL-FVME IN WSS-VVF
           ELSE
                MOVE SPACES TO WSS-GLS-MEXM IN WSS-VVF
                MOVE ZEROES TO WSS-VAL-FVME IN WSS-VVF.

           GENERATE DL-FMO.
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF ( WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES AND
                WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES ) OR
              WSS-IND IN WSS-VARI > 25
               GO TO FIN-GEN-LIN-MOR.
           GO TO LUP-GEN-LIN-MOR.
       FIN-GEN-LIN-MOR.
           EXIT.
      *-------------------------------------------------------------------------
       GEN-LIN-FUT SECTION.
       INI-GEN-LIN-FUT.
           GENERATE DL-TFU.
           MOVE 1 TO WSS-IND IN WSS-VARI.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES AND
              WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES
               GENERATE DL-FFU
               GO TO FIN-GEN-LIN-FUT.
       LUP-GEN-LIN-FUT.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-FUTN IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MNAF IN WSS-VVF
                MOVE WSS-VAL-FUTN IN WSS-VARI(WSS-IND) 
                                         TO WSS-VAL-FFVC IN WSS-VVF
           ELSE
                MOVE SPACES TO WSS-GLS-MNAF IN WSS-VVF
                MOVE ZEROES TO WSS-VAL-FFVC IN WSS-VVF.

           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) > SPACES
                MOVE WSS-COD-FUTE IN WSS-VARI(WSS-IND)
                                         TO OPC-COD-VCOC IN OPC
                PERFORM BUS-GLS-MONE
                MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MEXF IN WSS-VVF
                MOVE WSS-VAL-FUTE IN WSS-VARI(WSS-IND) 
                                         TO WSS-VAL-FFVE IN WSS-VVF
           ELSE
                MOVE SPACES TO WSS-GLS-MEXF IN WSS-VVF
                MOVE ZEROES TO WSS-VAL-FFVE IN WSS-VVF.

           GENERATE DL-FFU.
           ADD 1 TO WSS-IND IN WSS-VARI.
           IF ( WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES AND
                WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES ) OR
              WSS-IND IN WSS-VARI > 25
               GO TO FIN-GEN-LIN-FUT.
           GO TO LUP-GEN-LIN-FUT.
       FIN-GEN-LIN-FUT.
           EXIT.
      *-------------------------------------------------------------------------
       BUS-GLS-MONE SECTION.
       INI-BUS-GLS-MONE.
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN OPC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
           ELSE
               MOVE SPACES TO TAB-GLS-ABRV IN TAB.
       FIN-BUS-GLS-MONE.
           EXIT.
      *DAD fin  07-DEC-1990 
      **************************************************************************
      *DAD ini  07-DEC-1990 
       MOR-VAL-NAC SECTION.
       INI-MOR-VAL-NAC.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-MOR-VAL-NAC.
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = SPACES
               MOVE OPC-COD-VCOC IN SRT TO WSS-COD-MORN
                                           IN WSS-VARI(WSS-IND)
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-MORN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-NAC
           ELSE
           IF WSS-COD-MORN IN WSS-VARI(WSS-IND) = OPC-COD-VCOC IN SRT
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-MORN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-NAC.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA CHILENA MOROSOS QUEDO CHICA'
               GO TO FIN-MOR-VAL-NAC.
           GO TO LUP-MOR-VAL-NAC.
       FIN-MOR-VAL-NAC.
           EXIT.
      *-------------------------------------------------------------------------
       MOR-VAL-EXT SECTION.
       INI-MOR-VAL-EXT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-MOR-VAL-EXT.
           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) = SPACES
               MOVE OPC-COD-VCOC IN SRT TO WSS-COD-MORE
                                           IN WSS-VARI(WSS-IND)
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-MORE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-EXT
           ELSE
           IF WSS-COD-MORE IN WSS-VARI(WSS-IND) = OPC-COD-VCOC IN SRT
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-MORE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-MOR-VAL-EXT.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA EXTRANJERA MOROSOS QUEDO CHICA'
               GO TO FIN-MOR-VAL-EXT.
           GO TO LUP-MOR-VAL-EXT.
       FIN-MOR-VAL-EXT.
           EXIT.
      *-------------------------------------------------------------------------
       FUT-VAL-NAC SECTION.
       INI-FUT-VAL-NAC.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-FUT-VAL-NAC.
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = SPACES
               MOVE OPC-COD-VCOC IN SRT TO WSS-COD-FUTN
                                           IN WSS-VARI(WSS-IND)
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-FUTN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-NAC
           ELSE
           IF WSS-COD-FUTN IN WSS-VARI(WSS-IND) = OPC-COD-VCOC IN SRT
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-FUTN
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-NAC.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA CHILENA FUTUROS QUEDO CHICA'
               GO TO FIN-FUT-VAL-NAC.
           GO TO LUP-FUT-VAL-NAC.
       FIN-FUT-VAL-NAC.
           EXIT.
      *-------------------------------------------------------------------------
       FUT-VAL-EXT SECTION.
       INI-FUT-VAL-EXT.
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-FUT-VAL-EXT.
           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) = SPACES
               MOVE OPC-COD-VCOC IN SRT TO WSS-COD-FUTE
                                           IN WSS-VARI(WSS-IND)
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-FUTE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-EXT
           ELSE
           IF WSS-COD-FUTE IN WSS-VARI(WSS-IND) = OPC-COD-VCOC IN SRT
               ADD  SRT-VAL-VTRA IN SRT TO WSS-VAL-FUTE
                                           IN WSS-VARI(WSS-IND)
               GO TO FIN-FUT-VAL-EXT.

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI > 25
               DISPLAY 'TABLA DE MONEDA EXTRANJERA FUTUROS QUEDO CHICA'
               GO TO FIN-FUT-VAL-EXT.
           GO TO LUP-FUT-VAL-EXT.
       FIN-FUT-VAL-EXT.
           EXIT.
      *DAD fin  07-DEC-1990 
      **************************************************************************

       COPY GNSBFMSC.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFTOC.
       COPY COLBFICG.
      *DAD ini  15-DEC-1993
       COPY COLBFCYA.
      *DAD fin  15-DEC-1993
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY GNSBVMSC.
       COPY GNSBVTAB.
       COPY TABBVUSR.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
       COPY COLBGVEN.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
       COPY COLBFEVC.
       COPY COLBFRCV.
       COPY COLBFRDT.
      *DAD ini  22-JUL-1991
       COPY COLBGCAU.
       COPY COLBGCTO.
      *DAD fin  22-JUL-1991
      *>>>>
*% END
