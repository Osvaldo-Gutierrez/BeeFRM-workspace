*%! Codigo adicional para archivo
*% IF RDC_NUM_IDLC
      *<<<< RDC_NUM_IDLC
           IF RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES
               MOVE 'DIR' TO FRM-IND-TDEU IN RDC-FLD
           ELSE
               MOVE 'IND' TO FRM-IND-TDEU IN RDC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_RDC_RDC
      *<<<< FIN_PUT_RDC_RDC
           IF RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES
               MOVE 'DIR' TO FRM-IND-TDEU IN RDC-FLD
           ELSE
               MOVE 'IND' TO FRM-IND-TDEU IN RDC-FLD.
           PERFORM GET-MLIM.
      *>>>>
*% END
*% IF FIN_PUT_DBC_RDC
      *<<<< FIN_PUT_DBC_RDC
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN RDC-FLD.
      *>>>>
*% END
*% IF RDC_NUM_DIRE
      *<<<< RDC_NUM_DIRE
           IF RDC-NUM-DIRE IN RDC-FLD > ZEROES
               MOVE RDC-CAI-ICLI IN RDC-FLD TO RCD-CAI-ICLI IN RCD
               MOVE RDC-IIC-ICLI IN RDC-FLD TO RCD-IIC-ICLI IN RCD
               MOVE RDC-NUM-DIRE IN RDC-FLD TO RCD-NUM-DIRE IN RCD
               MOVE 'RCD-KEY-IRCD' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DIR    NEX' TO MSG-COD-MENS            
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RDC-NUM-DIRE
               ELSE
                   MOVE '00' TO PGM-STAT-RCD
                   PERFORM PUT-RCD-RDC
                   PERFORM VAL-LUGA
           ELSE
               MOVE RDC-CAI-ICLI IN RDC-FLD TO DBC-CAI-ICLI IN DBC
               MOVE RDC-IIC-ICLI IN RDC-FLD TO DBC-IIC-ICLI IN DBC
               PERFORM BUS-DOM
               IF RCD-GLS-DIRE IN RCD > SPACES
                   MOVE RCD-NUM-DIRE IN RCD TO RDC-NUM-DIRE IN RDC-FLD
                   MOVE '00' TO PGM-STAT-RCD
                   PERFORM PUT-RCD-RDC
                   PERFORM VAL-LUGA.
      *>>>>
*% END
*% IF RDC_VAL_LIMD
      *<<<< RDC_VAL_LIMD
           IF RDC-VAL-LIMD IN RDC-FLD > 100
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALLIMD>100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RDC-VAL-LIMD.
      *>>>>
*% END
*% IF FRM_VAL_MLIM
      *<<<< FRM_VAL_MLIM
           IF FRM-VAL-MLIM IN RDC-FLD > OPC-VAL-CRED IN OPC
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALMLIMSCRE>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIM.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_RDC
      *<<<< INI_VAL_CON_KEY_RDC
           IF RDC-CAI-IOPC IN RDC-FLD > SPACES AND
              RDC-IIC-IOPC IN RDC-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDCIOPCNOCON' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-RDC.

      * CONDICION 1 ( SOLO ICLI (NOMBRE O IDC) ) 
      *    IF NOT ((( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
      *               RDC-IIC-ICLI IN RDC-FLD > SPACES ) AND

           IF NOT ((( DBC-NUM-ICLI IN RDC-FLD > ZEROES OR
                      DBC-GLS-NOMC IN RDC-FLD > SPACES ) AND

                      RDC-IIC-IOPC IN RDC-FLD NOT > ZEROES AND

                      RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES ) OR

      * CONDICION 2 ( ICLI (NOMBRE O IDC) + IOPC ) 
      *            (( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
      *               RDC-IIC-ICLI IN RDC-FLD > SPACES ) AND

                   (( DBC-NUM-ICLI IN RDC-FLD > ZEROES OR
                      DBC-GLS-NOMC IN RDC-FLD > SPACES ) AND

                      RDC-IIC-IOPC IN RDC-FLD > ZEROES AND

                      RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES ) OR

      * CONDICION 3 ( SOLO IOPC ) 
                    ( RDC-IIC-IOPC IN RDC-FLD > ZEROES     AND
                      RDC-NUM-IDLC IN RDC-FLD NOT > ZEROES AND

      *               RDC-CAI-ICLI IN RDC-FLD NOT > SPACES AND
      *               RDC-IIC-ICLI IN RDC-FLD NOT > SPACES ) OR

                      DBC-NUM-ICLI IN RDC-FLD NOT > ZEROES AND
                      DBC-GLS-NOMC IN RDC-FLD NOT > SPACES ) OR

      * CONDICION 4 ( IOPC + IDLC ) 
                    ( RDC-IIC-IOPC IN RDC-FLD > ZEROES AND
                      RDC-NUM-IDLC IN RDC-FLD > ZEROES AND
      *               RDC-CAI-ICLI IN RDC-FLD NOT > SPACES AND
      *               RDC-IIC-ICLI IN RDC-FLD NOT > SPACES ) OR

                      DBC-NUM-ICLI IN RDC-FLD NOT > ZEROES AND
                      DBC-GLS-NOMC IN RDC-FLD NOT > SPACES ) OR

      * CONDICION 5 ( TODO LLENO ( ICLI + IOPC + IDLC )
                    ( RDC-IIC-IOPC IN RDC-FLD > ZEROES AND
                      RDC-NUM-IDLC IN RDC-FLD > ZEROES AND
      *             ( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
      *               RDC-IIC-ICLI IN RDC-FLD > SPACES )))

                    ( DBC-NUM-ICLI IN RDC-FLD > ZEROES OR
                      DBC-GLS-NOMC IN RDC-FLD > SPACES ))) 

               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-RDC.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_RDC
      *<<<< INI_VAL_CON_IKY_RDC
           IF RDC-CAI-IOPC IN RDC-FLD > SPACES AND
              RDC-IIC-IOPC IN RDC-FLD NOT > ZEROES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'RDCIOPCNOCON' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-RDC.

      * CONDICION 5 ( TODO LLENO ( ICLI + IOPC + IDLC )
      *    IF NOT (( RDC-CAI-ICLI IN RDC-FLD > SPACES OR
      *              RDC-IIC-ICLI IN RDC-FLD > SPACES ) AND

           IF NOT (( DBC-NUM-ICLI IN RDC-FLD > ZEROES OR
                     DBC-GLS-NOMC IN RDC-FLD > SPACES ) AND

                     RDC-IIC-IOPC IN RDC-FLD > ZEROES )

               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-IKY-RDC.
      *>>>>
*% END
*% IF DBC_IND_ICLI
      *<<<< DBC_IND_ICLI
           MOVE DBC-IND-ICLI IN RDC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN RDC-FLD.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           MOVE DBC-GLS-ICLI IN RDC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN RDC-FLD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN RDC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN RDC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *>>>>
*% END
*% IF VAL_CON_FLD_RDC
      *<<<< VAL_CON_FLD_RDC
      *ISP ESTA INSTRUCCION SE AGREGO PARA NO ELIMINAR EL CODIGO
      *    QUE MANEJA LA SITUACION COMPLETA.
           MOVE ZEROES TO FRM-VAL-MLIM.
      *
           PERFORM GET-MLIM.
           IF WSS-VAL-MLIM NOT = FRM-VAL-MLIM
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'VALLIMDMLIM' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-RDC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       GET-MLIM SECTION.
       INI-GET-MLIM.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE SPACES TO TAB-COD-CTAB IN TAB.
           IF RDC-NUM-IDLC IN RDC-FLD > ZEROES
               MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-CRED
           ELSE
               MOVE OPC-VAL-CRED IN OPC TO WSS-VAL-CRED.
           IF RDC-VAL-LIMD IN RDC-FLD NOT > ZEROES AND
              FRM-VAL-MLIM IN RDC-FLD NOT > ZEROES
               MOVE 100          TO RDC-VAL-LIMD IN RDC-FLD
               MOVE WSS-VAL-CRED TO FRM-VAL-MLIM IN RDC-FLD
               MOVE FRM-VAL-MLIM TO WSS-VAL-MLIM
           ELSE
           IF RDC-VAL-LIMD IN RDC-FLD > ZEROES AND
              FRM-VAL-MLIM IN RDC-FLD NOT > ZEROES
               COMPUTE FRM-VAL-MLIM =
               ( RDC-VAL-LIMD IN RDC-FLD * WSS-VAL-CRED ) / 100
               MOVE FRM-VAL-MLIM TO WSS-VAL-MLIM
           ELSE
           IF RDC-VAL-LIMD IN RDC-FLD NOT > ZEROES AND
              FRM-VAL-MLIM IN RDC-FLD > ZEROES
               COMPUTE RDC-VAL-LIMD IN RDC-FLD =
                       ( FRM-VAL-MLIM * 100 ) / WSS-VAL-CRED
               MOVE FRM-VAL-MLIM TO WSS-VAL-MLIM
           ELSE
               COMPUTE WSS-VAL-MLIM =
               ( RDC-VAL-LIMD IN RDC-FLD * WSS-VAL-CRED ) / 100.
           IF TAB-COD-CTAB IN TAB = OPC-COD-VCOC IN RDC-FLD
               MOVE WSS-VAL-MLIM TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-MLIM
               MOVE FRM-VAL-MLIM TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE TO FRM-VAL-MLIM.
       FIN-GET-MLIM.
           EXIT.
      *>>>>
*% END
