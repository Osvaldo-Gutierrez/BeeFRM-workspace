*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *DOS SELECT RPTMCT         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTMCT         ASSIGN TO        UT-S-RPTMCT.
           SELECT RPTMCT         ASSIGN TO        UT-S-RPTMCT.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTMCT LABEL RECORDS OMITTED
           REPORT IS RPT-MCT.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY COLRWMCT.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRCIC.
       COPY GNSBRMSC.
      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
       COPY GNSWGCMM.
      *DAD  fin 13-DEC-1991
       COPY TABBRCAM.
       COPY TABBROFI.
      *DAD  ini 13-DEC-1991 / 24-ABR-1991
       COPY TABBRTIO.
       COPY COLWGCTO.
      *DAD  fin 13-DEC-1991 / 24-ABR-1991
       COPY COLBRAUX.
       COPY COLBRCAN.
       COPY COLBRCCB.
       COPY COLBRCCR.
       COPY COLBRCCT.
       COPY COLBRCPP.
       COPY COLBRDCC.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRITR.
       COPY COLBRMCT.
       COPY COLBRRCV.
       COPY COLBRRDC.
       COPY COLBRTOC.
       COPY COLBRVEN.
       COPY DEUBRCRI.
       COPY SGCBRDBC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY GNSWGCIC.
       COPY COLWGVIN.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY COLWGVEN REPLACING ==CIC-VARI== BY ==CIC-VARI-VEN==.

       01  WSS-VARI.
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET                     PIC 9(02).
              05 WSS-NUM-AFET                     PIC 9(02).
              05 WSS-NUM-MFET                     PIC 9(02).
              05 WSS-NUM-DFET                     PIC 9(02).
           03 WSS-FEC-FREG.
              05 WSS-NUM-SREG                     PIC 9(02).
              05 WSS-NUM-AREG                     PIC 9(02).
              05 WSS-NUM-MREG                     PIC 9(02).
              05 WSS-NUM-DREG                     PIC 9(02).
           03 WSS-COD-PESO                        PIC X(06).
      * Valor Equi en Pesos a Fechas de Col, Can, Ven y Tras. CCR
           03 WSS-SGV-FCOL                        PIC S9(11)V9999.
           03 WSS-SGV-FCAN                        PIC S9(11)V9999.
           03 WSS-SGV-FVEN                        PIC S9(11)V9999.
           03 WSS-SGV-FCBR                        PIC S9(11)V9999.
      * Intereses de Mora
           03 WSS-VAL-IMOR                        PIC S9(11)V9999999.
      * Intereses y Reajustes Normales del Pago o Traspaso
           03 WSS-VAL-INTE                        PIC S9(11)V9999999.
           03 WSS-VAL-REAJ                        PIC S9(11)V9999999.
      * Capital
           03 WSS-VAL-CAPI                        PIC S9(11)V9999999.
      * Intereses Devengados del DLC
           03 WSS-VAL-INTD         COMP-3         PIC S9(11)V9(04).
      * Reajustes Devengados del DLC
           03 WSS-VAL-READ         COMP-3         PIC S9(11)V9(04).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-IND-ERRO                        PIC 9(01).
              88 ERROR-EN-PROCESO           VALUE 1.
           03 WSS-NUM-TDEB        VALUE ZEROES    PIC 9(03).
           03 WSS-NUM-THAB        VALUE ZEROES    PIC 9(03).
           03 WSS-IND-PRGL                        PIC 9(01).
              88 PRIMER-REGISTRO-LOOP       VALUE 1.
           03 WSS-IND-CIYR                        PIC 9(01).
              88 CAL-INT-YA-REALIZADO       VALUE 1.
           03 WSS-IND-CRYR                        PIC 9(01).
              88 CAL-REA-YA-REALIZADO       VALUE 1.
           03 WSS-IND-BVBD                        PIC 9(01).
              88 LEE-PRIMER-VEN-EXI-BD      VALUE 1.
              88 LEE-PROXIMO-VEN            VALUE 2.
              88 LEE-VEN-ESPECIFICO         VALUE 3.
           03 WSS-IND-ACEL                        PIC X(01).
              88 ACELERACION                VALUE 'S'.
           03 WSS-IND-MNRJ                        PIC 9(01).
              88 MON-NACIONAL-REAJUSTABLE   VALUE 1.
           03 WSS-IND-CANC                        PIC 9(01).
              88 CANC-TOTAL-TODOS-VEN       VALUE 1 THRU 2.
              88 PAGO-TOTAL-TODOS-VEN       VALUE 1.
              88 RPNV-TOTAL-TODOS-VEN       VALUE 2.
              88 CANC-PARCIAL-TODOS-VEN     VALUE 3.
              88 CANC-VEN-ESPECIFICO        VALUE 4 THRU 5.
              88 PAGO-VEN-ESPECIFICO        VALUE 4.
              88 RPNV-VEN-ESPECIFICO        VALUE 5.
           03 WSS-CIC-SCTB                        PIC X(08).
              88 NUEVA-SCTB-VIGENTE         VALUE '        '.
              88 NUEVA-CARTERA-VENCIDA      VALUE 'VCD     '.
              88 NUEVA-CASTIGADO            VALUE 'CAS     '.
           03 WSS-CIC-SCTA                        PIC X(08).
              88 ANTIGUA-SCTB-VIGENTE       VALUE '        '.
              88 ANTIGUA-CARTERA-VENCIDA    VALUE 'VCD     '.
              88 ANTIGUA-CASTIGADO          VALUE 'CAS     '.
           03 WSS-CIC-SCBZ                        PIC X(08).
              88 NUEVA-SCBZ-VIGENTE         VALUE '        '.
              88 NUEVA-JUDICIAL             VALUE 'JUDIC   '.
           03 WSS-CIC-SCBA                        PIC X(08).
              88 ANTIGUA-SCBZ-VIGENTE       VALUE '        '.
              88 ANTIGUA-JUDICIAL           VALUE 'JUDIC   '.
           03 WSS-CIC-SCRT                        PIC X(08).
              88 NUEVA-SCRT-VIGENTE         VALUE '        '.
              88 NUEVA-VENDIDO              VALUE 'VDD     '.
           03 WSS-CIC-SCRA                        PIC X(08).
              88 ANTIGUA-SCRT-VIGENTE       VALUE '        '.
              88 ANTIGUA-VENDIDO            VALUE 'VDD     '.
           03 WSS-IND-RSCT                        PIC 9(01).
              88 REVERSA-DEBE-HABER         VALUE 1.
           03 WSS-IND-RDEV                        PIC 9(01).
              88 REVERSA-DEVENGOS           VALUE 1.
           03 WSS-IND-VTCB                        PIC 9(01).
              88 TCB-POR-VEN                VALUE 1.
      *    Vector Asientos Contables
           03 WSS-VEC-ACTB.
              05 WSS-VAL-ACTB	OCCURS 35.
      *          Identifica Tipo de Cuenta Contable
                 07 WSS-MSC-TCCT                  PIC X(03).
      *          Indicador de Debe o Haber
                 07 WSS-IND-DBHB                  PIC X(01).
      *          Indicador Tipo de Algoritmo
                 07 WSS-IND-TALG                  PIC X(01).
      *          Monto a Contabilizar
                 07 WSS-VAL-MNTO                  PIC S9(11)V9(04).
           03 WSS-NUM-ICPP        VALUE ZEROES    PIC 9(02).
           03 WSS-NUM-ICPA        VALUE ZEROES    PIC 9(02).
           03 WSS-IND-ROPC        VALUE 0         PIC 9(06).
           03 WSS-IND-RCAN        VALUE 0         PIC 9(06).
           03 WSS-IND-RCCT        VALUE 0         PIC 9(06).
           03 WSS-IND-RCCB        VALUE 0         PIC 9(06).
           03 WSS-IND-RCCR        VALUE 0         PIC 9(06).
           03 WSS-IND-RPRO        VALUE 0         PIC 9(06).
           03 WSS-IND-RBAD        VALUE 0         PIC 9(06).
           03 WSS-IND-ROKS        VALUE 0         PIC 9(06).
           03 WSS-IND-RERR        VALUE 0         PIC 9(06).
           03 WSS-GLS-CCSB.
              05 WSS-GLS-DESC                     PIC X(40).
              05 WSS-GLS-DATA.
                 07 FILLER                        PIC X(59).
                 07 WSS-GLS-DVRF                  PIC X(01).
           03 WSS-NUM-IVCT                        PIC 9(03).
           03 WSS-IND-SCTB                        PIC X(03).
           03 WSS-SGV-FFCA         COMP-3         PIC S9(11).
           03 WSS-SGV-FINA         COMP-3         PIC S9(11)V9(04).
      *DAD  ini 24-ABR-1991 
           03 WSS-COD-OFIC                        PIC X(03).
      *DAD  fin 24-ABR-1991 

       01  CON-VARI.
           03 CON-VEC-TOOC
              OCCURS 40 INDEXED BY CON-IND-SI01.
              05 CON-COD-COOC                     PIC X(06).
           03 CON-IND-SI02                        PIC 9(02).
           03 CON-MSC-OPEC                        PIC X(04).
              88 HIPOTECARIO                VALUE 'H   '.
              88 CONSUMO                    VALUE 'C   '.

       01  RYD-VARI.
      * Fecha Corte Devengo Intereses y Reajustes
           03 RYD-FEC-FCDV.
              05 RYD-NUM-SCDV                     PIC 9(02).
              05 RYD-NUM-ACDV                     PIC 9(02).
              05 RYD-NUM-MCDV                     PIC 9(02).
              05 RYD-NUM-DCDV                     PIC 9(02).
      * Fecha de Corte de Intereses si Cuota Solo Interes ( de paso )
           03 RYD-FEC-FCIN.
              05 RYD-NUM-SCIN                     PIC 9(02).
              05 RYD-NUM-ACIN                     PIC 9(02).
              05 RYD-NUM-MCIN                     PIC 9(02).
              05 RYD-NUM-DCIN                     PIC 9(02).
      * Fecha Clasificacion de Riesgo
           03 RYD-FEC-FCLA.
              05 RYD-NUM-SCLA                     PIC 9(02).
              05 RYD-NUM-ACLA                     PIC 9(02).
              05 RYD-NUM-MCLA                     PIC 9(02).
              05 RYD-NUM-DCLA                     PIC 9(02).
      * Fecha Vencimiento Anterior al de la CCT
           03 RYD-FEC-FVAN.
              05 RYD-NUM-SVAN                     PIC 9(02).
              05 RYD-NUM-AVAN                     PIC 9(02).
              05 RYD-NUM-MVAN                     PIC 9(02).
              05 RYD-NUM-DVAN                     PIC 9(02).
      * Intereses del Periodo
           03 RYD-VAL-IPER                        PIC S9(11)V9999999.
      * Intereses Por Cobrar Vencidos
           03 RYD-VAL-IPCV                        PIC S9(11)V9999999.
      * Intereses y Reajustes a Cuentas de Riesgo del Vencimiento
           03 RYD-VAL-IRIE                        PIC S9(11)V9999999.
           03 RYD-VAL-RRIE                        PIC S9(11)V9999999.
      * Intereses y Reajustes a Cuentas de Orden del Vencimiento
           03 RYD-VAL-IORD                        PIC S9(11)V9999999.
           03 RYD-VAL-RORD                        PIC S9(11)V9999999.
      * Indicadores
           03 RYD-IND-PDEU                        PIC 9(01).
              88 PRIMER-DEUDOR              VALUE 1.
           03 RYD-IND-PVCV                        PIC 9(01).
              88 PRIMER-VEN-EN-CV           VALUE 1.
           03 RYD-IND-PVSI                        PIC 9(01).
              88 PRIMER-VEN-CV-SOLO-INT     VALUE 1.
           03 RYD-IND-VCPV                        PIC 9(01).
              88 VEN-CCT-PRIMER-EN-CV       VALUE 1.
           03 RYD-IND-RIES                        PIC 9(01).
              88 RIESGOSO                   VALUE 1 THRU 2.
              88 RIESGOSO-C                 VALUE 1.
              88 RIESGOSO-D                 VALUE 2.
      * Saldo del Credito Al Vencimiento Anterior al de la CCT
           03 RYD-VAL-SCRE                        PIC 9(11)V9(04).
      * Valor Equivalente en Pesos a la Fecha Corte Devengo
           03 RYD-SGV-FCDV                        PIC S9(11)V9(04).
           03 RYD-SGV-FCLA                        PIC S9(11)V9(04).
       COPY GNSWGPES.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CPP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRFMCT.
           .
       COPY COLRTMCT.
      *>>>>
*% END
*% IF CF_LMC_SRT_COD_OFIC
      *<<<< CF_LMC_SRT_COD_OFIC
           MOVE ZEROES TO PAGE-COUNTER IN RPT-LMC.
      *>>>>
*% END
*% IF CF_LMC_SRT_CIC_CCSB
      *<<<< CF_LMC_SRT_CIC_CCSB
           MOVE WSS-NUM-TDEB IN WSS-VARI TO WSS-NUM-TDEB IN WSS-LMC.
           MOVE WSS-NUM-THAB IN WSS-VARI TO WSS-NUM-THAB IN WSS-LMC.
           MOVE ZEROES TO WSS-NUM-TDEB IN WSS-VARI
                          WSS-NUM-THAB IN WSS-VARI.
      *>>>>
*% END
*% IF CF_LMC_OPC_COD_VCOC
      *<<<< CF_LMC_OPC_COD_VCOC
      *>>>>
*% END
*% IF CF_LMC_SRT_FEC_FMOV
      *<<<< CF_LMC_SRT_FEC_FMOV
      *>>>>
*% END
*% IF PH_LMC
      *<<<< PH_LMC
      * Mediante BUS-OFI Obtiene Nombre y Direccion Oficina de Tabla OFI
           IF SRT-COD-OFIC IN SRT > SPACES
               MOVE SRT-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.

      *     MOVE ZEROES TO WSS-NUM-FOLO IN WSS-LMC.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
      *CIC-GET Obtener CIC
           MOVE 'S'                 TO CIC-COD-TCIC IN CIC.
           MOVE SRT-COD-OFIC IN SRT TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               DISPLAY CIC-MENS     IN CIC-VARI ' EN CODIGO : '
                       CIC-CIC-ICIC IN CIC
               GO TO FIN-PH-LMC.
           MOVE CIC-NUM-ICIC IN CIC TO WSS-NUM-FOLO IN WSS-LMC.

      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI
               MOVE WSS-GLS-CCSB IN WSS-VARI TO WSS-GLS-CCSB IN WSS-LMC
               MOVE WSS-GLS-DVRF IN WSS-VARI TO WSS-GLS-DVRF IN WSS-LMC
           ELSE
               MOVE SPACES TO WSS-GLS-CCSB IN WSS-LMC
               MOVE SPACES TO WSS-GLS-DVRF IN WSS-LMC.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-LMC
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-LMC.
      *>>>>
*% END
*% IF CF_MCT_SRT_COD_OFIC
      *<<<< CF_MCT_SRT_COD_OFIC
           MOVE ZEROES TO PAGE-COUNTER IN RPT-MCT.
      *>>>>
*% END
*% IF CF_MCT_SRT_CIC_CCSB
      *<<<< CF_MCT_SRT_CIC_CCSB
      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF SRT-CIC-CCSB IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE SRT-CIC-CCSB IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC IN WSS-VARI
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI
               MOVE WSS-GLS-CCSB IN WSS-VARI TO WSS-GLS-CCSB IN WSS-MCT
               MOVE WSS-GLS-DVRF IN WSS-VARI TO WSS-GLS-DVRF IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-CCSB IN WSS-MCT
               MOVE SPACES TO WSS-GLS-DVRF IN WSS-MCT.
      *>>>>
*% END
*% IF CF_MCT_SRT_FEC_FMOV
      *<<<< CF_MCT_SRT_FEC_FMOV
           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-MCT.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-MCT.
           MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-MCT.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-MCT.
      *>>>>
*% END
*% IF PH_MCT
      *<<<< PH_MCT
      * Mediante BUS-OFI Obtiene Nombre y Direccion Oficina de Tabla OFI
           IF SRT-COD-OFIC IN SRT > SPACES
               MOVE SRT-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-MCT.

      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCOC IN WSS-MCT
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-MCT.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *DAD  ini 24-ABR-1991 
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *DAD  fin 24-ABR-1991 

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-LMC
                                            WSS-NUM-DINI IN WSS-MCT
                                            WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-LMC
                                            WSS-NUM-MINI IN WSS-MCT
                                            WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-LMC
                                            WSS-NUM-SINI IN WSS-MCT
                                            WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-LMC
                                            WSS-NUM-AINI IN WSS-MCT
                                            WSS-NUM-AFEC IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-LMC
                                            WSS-NUM-DTER IN WSS-MCT
                                            WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-LMC
                                            WSS-NUM-MTER IN WSS-MCT
                                            WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-LMC
                                            WSS-NUM-STER IN WSS-MCT
                                            WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-LMC
                                            WSS-NUM-ATER IN WSS-MCT
                                            WSS-NUM-AFET IN WSS-VARI.

      *DAD  ini 24-ABR-1991 
      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFIC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFIC IN WSS-VARI.
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-END.
      *DAD  fin 24-ABR-1991 

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Llena Vector CON-VARI con Codigos Auxiliares de Consumo
      * Instituciones o Distribuidores
           PERFORM PUT-CON-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
      * Proceso para Cargar las tablas  MSC/STCB  en Memoria
           MOVE 'COL'  TO CMM-SIST IN CMM-VARI.
           MOVE 'SCTB' TO CMM-TMSC IN CMM-VARI.
           PERFORM GNS-CRG-CMM.
           IF CMM-CMSG IN CMM-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CMM-CMSG IN CMM-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CMM-MEN2 IN CMM-VARI
               PERFORM GNS-PRO-END.
      *DAD  fin 13-DEC-1991

      *DAD  ini 13-DEC-1991
      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-END.
      *DAD  fin 13-DEC-1991

      * Efectua la Apertura del Archivo SAM de Salida
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM COL-FIO-MCT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO MCT DE OUTPUT' FIO-STAT
               PERFORM GNS-PRO-END.
      **************************************************************************
      *
      * PROCESO INGRESO DE OPERACIONES ( OPC => CUR )
      *
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           DISPLAY 'PROCESO INGRESO DE OPERACIONES ( OPC => CUR )'.
           MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FING IN OPC.
           MOVE 'OPC-FEC-FING' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FING IN OPC > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS OPC EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT.

      * Limpia Switch de Cancelaciones
           MOVE ZEROES TO WSS-IND-CANC IN WSS-VARI.

      * Limpia Indicador de Aceleracion WSS-IND-ACEL (Nivel 88)
           MOVE ZEROES TO WSS-IND-ACEL IN WSS-VARI.

      * Limpia Switch de Reversa para los Traspasos
           MOVE ZEROES TO WSS-IND-RSCT IN WSS-VARI.

      * Limpia Switch de CCB por VEN
           MOVE ZEROES TO WSS-IND-VTCB IN WSS-VARI.

           MOVE 'CUR' TO CPP-COD-MVTO IN CPP.

           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      *DAD  ini 24-ABR-1991 
      *     DISPLAY ' '.
      *     DISPLAY '% DEBUG, OPERACION : ' OPC-CIC-IOPC IN OPC.
      *     DISPLAY '% CPP-COD-MVTO     : ' CPP-COD-MVTO IN CPP.
      *DAD  fin 24-ABR-1991 

      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.

      * Aumenta Contador de Operaciones Leidas OK
           ADD  1  TO WSS-IND-ROPC IN WSS-VARI.

      * Busca Primer Documento de Operacion
           MOVE SPACES              TO DLC-KEY-IDLC IN DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNL' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-KEY-IOPC IN OPC
               GO TO NXT-INP-SRT.

      * Prende Switch Primer Registro DLC de OPC (PRIMER-REGISTRO-LOOP)
           MOVE  1  TO WSS-IND-PRGL IN WSS-VARI.

       LUP-BUS-OPC-DLC.
      * Limpia Switch de Error
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      * Formacion y Generacion del Registro SRT
           PERFORM BUS-SRT-REG.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.

      * Apaga Switch Primer Registro DLC de OPC (PRIMER-REGISTRO-LOOP)
           MOVE ZEROES TO WSS-IND-PRGL IN WSS-VARI.

      * Busca Proximo Documento de Operacion
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.

           GO TO LUP-BUS-OPC-DLC.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FING' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF OPC-FEC-FING IN OPC > WSS-FEC-FFET IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
      **************************************************************************
      *
      * PROCESO CANCELACION DE OPERACIONES ( CAN => CAN )
      *
       INI-INP-SRT-CAN.
           DISPLAY 'PROCESO CANCELACION DE OPERACIONES ( CAN => CAN )'.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CCT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CAN-FEC-FEGR IN CAN.
           MOVE 'CAN-FEC-FEGR' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS OR
              CAN-FEC-FEGR IN CAN > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS CAN EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT-CAN.

      * Limpia Indicador de Aceleracion WSS-IND-ACEL (Nivel 88)
           MOVE ZEROES TO WSS-IND-ACEL IN WSS-VARI.

      * Limpia Switch de Reversa para los Traspasos
           MOVE ZEROES TO WSS-IND-RSCT IN WSS-VARI.

      * Limpia Switch de CCB por VEN
           MOVE ZEROES TO WSS-IND-VTCB IN WSS-VARI.

           MOVE 'CAN' TO CPP-COD-MVTO IN CPP.

       LUP-INP-SRT-CAN.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY ' '.
      *     DISPLAY '% DEBUG, CANCELACION : ' CAN-KEY-ICAN IN CAN.
      *     DISPLAY '% CPP-COD-MVTO       : ' CPP-COD-MVTO IN CPP.
      *DAD  fin 24-ABR-1991 

      * Busca la Operacion de Credito Asociada a la Cancelacion
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    OPCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT-CAN.

      * Proceso de Seleccion y Clasificacion a Partir del Registro CAN
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CAN.

      * Aumenta Contador de Cancelaciones Leidas OK
           ADD  1  TO WSS-IND-RCAN IN WSS-VARI.

      * Prende Switch Primer Registro Saldo Anterior DLC > 0 de CAN
      * (PRIMER-REGISTRO-LOOP)
           MOVE  1  TO WSS-IND-PRGL IN WSS-VARI.

      * Asocia Oficina Ingreso a la Cancelacion si son distintas
      * Para Movimientos de Sucursales
           IF OPC-COD-OFOC IN OPC NOT = CAN-COD-OFCA IN CAN
               MOVE OPC-COD-OFOC IN OPC TO SRT-COD-OFIC IN SRT.

      * Llena Indicador WSS-IND-CANC
           IF CAN-MSC-CANC IN CAN = 'CTT' OR 'RTT' OR 'PTT' OR 'NTT'
               IF CAN-MSC-CANC IN CAN = 'CTT'
                   MOVE 1 TO WSS-IND-CANC IN WSS-VARI
               ELSE
                   MOVE 2 TO WSS-IND-CANC IN WSS-VARI
           ELSE
               IF CAN-MSC-CANC IN CAN = 'CIT' OR 'CPT'
                   MOVE 3 TO WSS-IND-CANC IN WSS-VARI
               ELSE
                   IF CAN-MSC-CANC IN CAN = 'CIE' OR 'CPE' OR 'CTE'
                       MOVE 4 TO WSS-IND-CANC IN WSS-VARI
                   ELSE
                       MOVE 5 TO WSS-IND-CANC IN WSS-VARI.

      * Busca Primera Relacion RCV-VEN Asociada a Cancelacion
           MOVE SPACES              TO RCV-KEY-IRCV IN RCV.
           MOVE CAN-KEY-ICAN IN CAN TO RCV-KEY-ICAN IN RCV.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS OR
              RCV-KEY-ICAN IN RCV NOT = CAN-KEY-ICAN IN CAN
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    RCVNL' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   CAN-KEY-ICAN IN CAN
               GO TO NXT-INP-SRT-CAN.

           IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
      *    Busca Primer Documento de Operacion
               MOVE SPACES              TO DLC-KEY-IDLC IN DLC
               MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
               MOVE FIO-GET-NLS  TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS OR
                  DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    DLCNL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ' Ope : ' OPC-KEY-IOPC IN OPC
                           ' FIO-STAT : ' FIO-STAT
                   GO TO NXT-INP-SRT-CAN
               ELSE
                   NEXT SENTENCE
           ELSE
      *    Busca Documento Asociado a RCV
               MOVE RCV-KEY-IDLC IN RCV TO DLC-KEY-IDLC IN DLC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'RCV    DLCNX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ' Ope : ' OPC-KEY-IOPC IN OPC
                           ' FIO-STAT : ' FIO-STAT
                   GO TO NXT-INP-SRT-CAN.

      * Si Saldo Anterior a Cancelacion del Documento es > 0 => Procesa DLC
           IF DLC-VAL-DPES IN DLC NOT > 0
               IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
                   GO TO NXT-BUS-CAN-DLC
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CAN#*TTDPES0' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ' Ope : ' OPC-KEY-IOPC IN OPC
                   GO TO NXT-INP-SRT-CAN.
       LUP-BUS-CAN-DLC.
      * Limpia Switch de Error
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      * Formacion y Generacion del Registro SRT
           PERFORM BUS-SRT-REG.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CAN.

      * Apaga Switch Primer Registro Saldo Anterior DLC > 0 de CAN
      * (PRIMER-REGISTRO-LOOP)
           MOVE ZEROES TO WSS-IND-PRGL IN WSS-VARI.
       NXT-BUS-CAN-DLC.
           IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
      *    Busca Proximo Documento
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF NOT FIO-STAT-OKS OR
                  DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
                   GO TO NXT-INP-SRT-CAN
               ELSE
      *         Si Saldo Anterior del Documento es > 0 => Procesa DLC
                   IF DLC-VAL-DPES IN DLC NOT > 0
                       GO TO NXT-BUS-CAN-DLC
                   ELSE
                       GO TO LUP-BUS-CAN-DLC.
       NXT-INP-SRT-CAN.
      * Busca la Proxima Cancelacion (CAN)
           MOVE 'CAN-FEC-FEGR' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS OR
              CAN-FEC-FEGR IN CAN > WSS-FEC-FFET IN WSS-VARI
               GO TO FIN-INP-SRT-CAN.
           GO TO LUP-INP-SRT-CAN.
       FIN-INP-SRT-CAN.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CAN.
      **************************************************************************
      *
      * PROCESO TRASPASO SITUACION CONTABLE DE OPERACIONES ( CCT => TCT )
      *
       INI-INP-SRT-CCT.
           DISPLAY 'PROCESO TRASPASO SITUACION CONTABLE ( CCT => TCT )'.
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CCT-FEC-FCCT IN CCT.
           MOVE 'CCT-FEC-FCCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-CCT.
           IF NOT FIO-STAT-OKS OR
              CCT-FEC-FCCT IN CCT > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS CCT EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT-CCT.

      * Limpia Switch de Cancelaciones
           MOVE ZEROES TO WSS-IND-CANC IN WSS-VARI.

      * Limpia Switch de CCB por VEN
           MOVE ZEROES TO WSS-IND-VTCB IN WSS-VARI.

       LUP-INP-SRT-CCT.
      * Busca la Operacion de Credito por Situacion Contable
           MOVE CCT-CIC-IOPC IN CCT TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CCT    OPCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY '% ERROR....' MSG-GLS-DESC
               DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'FECHA CCT   : ' CCT-FEC-FCCT IN CCT
               GO TO NXT-INP-SRT-CCT.

      * Si Situacion Contable Anterior o Actual de Registro CCT
      * es Castigada (CAS), el Codigo de Movimiento (CPP) debe ser CAS
           IF CCT-IND-SCTB IN CCT = 'CAS' OR
              CCT-IND-SCTA IN CCT = 'CAS'
               MOVE 'CAS' TO CPP-COD-MVTO IN CPP
           ELSE
               MOVE 'TCT' TO CPP-COD-MVTO IN CPP.

      *DAD  ini 24-ABR-1991 
      *     DISPLAY ' '.
      *     DISPLAY '% DEBUG, SITUACION CONTABLE : ' CCT-KEY-ICCT IN CCT.
      *     DISPLAY '% CPP-COD-MVTO              : ' CPP-COD-MVTO IN CPP.
      *DAD  fin 24-ABR-1991 

      * Proceso de Seleccion y Clasificacion a Partir del Registro CCT
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CCT.

      * Aumenta Contador de Registros CCT Leidos OK
           ADD  1  TO WSS-IND-RCCT IN WSS-VARI.

      * Limpia Switch de Error
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      * Busca CIC de Situacion Contable Actual
           MOVE CCT-IND-SCTB IN CCT TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCTB.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCT.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCTB IN WSS-VARI.

      * Busca CIC de Situacion Contable Anterior
           MOVE CCT-IND-SCTA IN CCT TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCTB.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCT.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCTA IN WSS-VARI.

      * Marca Indicador de Reversa para Asientos Contables
           IF ( ANTIGUA-CARTERA-VENCIDA AND NUEVA-SCTB-VIGENTE ) OR
              ( ANTIGUA-CASTIGADO AND NUEVA-SCTB-VIGENTE ) OR
              ( ANTIGUA-CASTIGADO AND NUEVA-CARTERA-VENCIDA )
               MOVE 1 TO WSS-IND-RSCT IN WSS-VARI
           ELSE
               MOVE 0 TO WSS-IND-RSCT IN WSS-VARI.

      * Busca Si Operacion es Credito Hipotecario o Consumo
           PERFORM BUS-COD-HYC.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCT.

      * Prende Switch Primer Registro VEN de CCT (PRIMER-REGISTRO-LOOP)
           MOVE 1 TO WSS-IND-PRGL IN WSS-VARI.

      * Mueve Indicador de Aceleracion de CCT a WSS-VARI (Nivel 88)
           MOVE CCT-IND-ACEL IN CCT TO WSS-IND-ACEL IN WSS-VARI.

      * Busca el Documento de Credito por Situacion Contable
           MOVE CCT-KEY-IDLC IN CCT TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CCT    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY '% ERROR....' MSG-GLS-DESC
               DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'DOCUMENTO   : ' DLC-KEY-IDLC IN DLC 
               DISPLAY 'FECHA CCT   : ' CCT-FEC-FCCT IN CCT
               GO TO NXT-INP-SRT-CCT.

      * Busca Primer Vencimiento Existente en la BD
      * Prende Switch con 1 (LEE-PRIMER-VEN-EXI-BD)
           MOVE 1 TO WSS-IND-BVBD IN WSS-VARI.
           PERFORM LEE-VEN.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCT.

      * Define Cual Sera la Fecha de Corte de Devengo Intereses y/o Reajustes
           IF HIPOTECARIO OR CONSUMO OR
              NOT (( ANTIGUA-SCTB-VIGENTE AND NUEVA-CARTERA-VENCIDA ) OR
                    ( ANTIGUA-CARTERA-VENCIDA AND NUEVA-SCTB-VIGENTE ) )
               MOVE '99999999' TO RYD-FEC-FCDV IN RYD-VARI
           ELSE
               PERFORM BUS-FEC-FCDV
               IF ERROR-EN-PROCESO
                   GO TO NXT-INP-SRT-CCT.

      * Busca Saldo Contable al Vencimiento Anterior si VCD -> VIG o Viceversa
           IF ( ANTIGUA-SCTB-VIGENTE AND NUEVA-CARTERA-VENCIDA ) OR
              ( ANTIGUA-CARTERA-VENCIDA AND NUEVA-SCTB-VIGENTE )
               PERFORM PRO-VAL-SCRE
               IF ERROR-EN-PROCESO
                   GO TO NXT-INP-SRT-CCT.
       LUP-BUS-CCT-VEN.
      * Limpia Switch de Error
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      * Formacion y Generacion del Registro SRT
           PERFORM BUS-SRT-REG.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CCT.
       NXT-BUS-CCT-VEN.
      * Apaga Switch Primer Registro VEN de CCT (PRIMER-REGISTRO-LOOP)
           MOVE  0  TO WSS-IND-PRGL IN WSS-VARI.

           IF ACELERACION
      *        Busca Proximo Vencimiento Asociado a Registro CCT
      *        Prende Switch Busca Vencimiento BD con 2 (LEE-PROXIMO-VEN)
               MOVE 2 TO WSS-IND-BVBD IN WSS-VARI
               PERFORM LEE-VEN
               IF ERROR-EN-PROCESO
                   GO TO NXT-INP-SRT-CCT
               ELSE
                   GO TO LUP-BUS-CCT-VEN.
       NXT-INP-SRT-CCT.
           MOVE 'CCT-FEC-FCCT' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CCT.
           IF NOT FIO-STAT-OKS OR
              CCT-FEC-FCCT IN CCT > WSS-FEC-FFET IN WSS-VARI
               GO TO FIN-INP-SRT-CCT.
           GO TO LUP-INP-SRT-CCT.
       FIN-INP-SRT-CCT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CCT.
      **************************************************************************
      *DAD  ini 13-DEC-1991   COBRANZA BLOQUEADA
      **
      ** PROCESO TRASPASO SITUACION COBRANZA DE OPERACIONES ( CCB => TCB )
      **
      * INI-INP-SRT-CCB.
      *     DISPLAY 'PROCESO TRASPASO SITUACION COBRANZA ( CCB => TCB )'.
      *     MOVE FIO-INP TO FIO-CMND.
      *     PERFORM COL-FIO-CCB.
      *     MOVE WSS-FEC-FFEC IN WSS-VARI TO CCB-FEC-FING IN CCB.
      *     MOVE 'CCB-FEC-FING' TO FIO-AKEY.
      *     MOVE FIO-GET-NLS    TO FIO-CMND.
      *     PERFORM COL-FIO-CCB.
      *     IF NOT FIO-STAT-OKS OR
      *        CCB-FEC-FING IN CCB > WSS-FEC-FFET IN WSS-VARI
      *         DISPLAY 'NO HAY REGISTROS CCB EN RANGO DE FECHAS : '
      *                 'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
      *                 WSS-FEC-FTER IN WSS-VARI
      *         GO TO FIN-INP-SRT-CCB.

      ** Limpia Switch de Cancelaciones
      *     MOVE ZEROES TO WSS-IND-CANC IN WSS-VARI.

      ** Limpia Indicador de Aceleracion WSS-IND-ACEL (Nivel 88)
      *     MOVE ZEROES TO WSS-IND-ACEL IN WSS-VARI.

      *     MOVE 'TCB' TO CPP-COD-MVTO IN CPP.
      * LUP-INP-SRT-CCB.
      **DAD  ini 24-ABR-1991 
      **     DISPLAY ' '.
      **     DISPLAY '% DEBUG, SITUACION COBRANZA : ' CCB-KEY-ICCB IN CCB.
      **     DISPLAY '% CPP-COD-MVTO              : ' CPP-COD-MVTO IN CPP.
      **DAD  fin 24-ABR-1991 

      ** Busca la Operacion de Credito por Situacion Cobranza
      *     MOVE CCB-CIC-IOPC IN CCB TO OPC-CIC-IOPC IN OPC.
      *     MOVE FIO-GET-KEY  TO FIO-CMND.
      *     PERFORM COL-FIO-OPC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'CCB    OPCNX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY '% ERROR....' MSG-GLS-DESC
      *         DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
      *         DISPLAY 'FECHA CCB   : ' CCB-FEC-FING IN CCB
      *         GO TO NXT-INP-SRT-CCB.

      ** Proceso de Seleccion y Clasificacion a Partir del Registro CCB
      *     PERFORM SEL-REG-PRO.
      *     IF WSS-IND-NEXT IN WSS-VARI = 1
      *         GO TO NXT-INP-SRT-CCB.

      ** Aumenta Contador de Registros CCB Leidos OK
      *     ADD  1  TO WSS-IND-RCCB IN WSS-VARI.

      ** Limpia Switch de Error
      *     MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      ** Busca CIC de Situacion Cobranza Actual
      *     MOVE CCB-IND-SCBZ IN CCB TO MSC-COD-CMSC IN MSC.
      *     PERFORM BUS-MSC-SCBZ.
      *     IF ERROR-EN-PROCESO
      *         GO TO NXT-INP-SRT-CCB.
      *     MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCBZ IN WSS-VARI.

      ** Busca CIC de Situacion Cobranza Anterior
      *     MOVE CCB-IND-SCBA IN CCB TO MSC-COD-CMSC IN MSC.
      *     PERFORM BUS-MSC-SCBZ.
      *     IF ERROR-EN-PROCESO
      *         GO TO NXT-INP-SRT-CCB.
      *     MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCBA IN WSS-VARI.

      ** Procesa el Registro si es Traspaso a Judicial o Reversa de CCB
      *     IF NOT ( ANTIGUA-JUDICIAL OR NUEVA-JUDICIAL )
      *         GO TO NXT-INP-SRT-CCB.

      ** Busca el Documento de Credito por Situacion Cobranza
      *     MOVE CCB-KEY-IDLC IN CCB TO DLC-KEY-IDLC IN DLC.
      *     MOVE FIO-GET-KEY  TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'CCB    DLCNX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY '% ERROR....' MSG-GLS-DESC
      *         DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
      *         DISPLAY 'DOCUMENTO   : ' DLC-KEY-IDLC IN DLC 
      *         DISPLAY 'FECHA CCB   : ' CCB-FEC-FING IN CCB
      *         GO TO NXT-INP-SRT-CCB.

      ** Si Situacion Cartera Antigua es Judicial Limpia Ind. de Vendido
      *     IF ANTIGUA-JUDICIAL
      *         MOVE SPACES TO WSS-CIC-SCRA IN WSS-VARI
      *     ELSE
      **        Busca el Ultimo Cambio de Situacion Cartera de DLC (si hay)
      *         MOVE DLC-KEY-IDLC IN DLC TO CCR-KEY-IDLC IN CCR
      *         MOVE 99                  TO CCR-NUM-ICCR IN CCR
      *         MOVE FIO-GET-LEQ TO FIO-CMND
      *         PERFORM COL-FIO-CCR
      *         IF NOT FIO-STAT-OKS OR
      *            CCR-KEY-IDLC IN CCR NOT = DLC-KEY-IDLC IN DLC
      **            Busca CIC de Sit Cartera Actual DLC ( CBJ->VDD o VDD->CBJ )
      *             MOVE DLC-IND-SCRT IN DLC TO MSC-COD-CMSC IN MSC
      *             PERFORM BUS-MSC-SCRT
      *             IF ERROR-EN-PROCESO
      *                 GO TO NXT-INP-SRT-CCB
      *             ELSE
      *                 MOVE MSC-CIC-CMSC IN MSC TO
      *                      WSS-CIC-SCRA IN WSS-VARI
      *         ELSE
      **            Busca CIC de Sit Cartera Anterior CCR ( CBJ->VDD o VDD->CBJ )
      *             MOVE CCR-IND-SCRA IN CCR TO MSC-COD-CMSC IN MSC
      *             PERFORM BUS-MSC-SCRT
      *             IF ERROR-EN-PROCESO
      *                 GO TO NXT-INP-SRT-CCB
      *             ELSE
      *                 MOVE MSC-CIC-CMSC IN MSC TO
      *                      WSS-CIC-SCRA IN WSS-VARI.

      ** Marca Indicador de Reversa para Asientos Contables
      *     IF ANTIGUA-JUDICIAL OR ( NUEVA-JUDICIAL AND ANTIGUA-VENDIDO )
      *         MOVE 1 TO WSS-IND-RSCT IN WSS-VARI
      *     ELSE
      *         MOVE 0 TO WSS-IND-RSCT IN WSS-VARI.

      ** Si Sit. Cobranza es por VEN => Lee VEN directo
      ** Si Sit. Cobranza es por DOC => Lee Primer VEN existente en BD
      *     IF CCB-NUM-IVCT IN CCB > ZEROES
      **        Prende Switch TCB-POR-VEN
      *         MOVE 1 TO WSS-IND-VTCB IN WSS-VARI
      **        Busca Vencimiento Especifico de la BD
      **        Prende Switch con 3 (LEE-VEN-ESPECIFICO)
      *         MOVE 3 TO WSS-IND-BVBD IN WSS-VARI
      *         MOVE CCB-KEY-IVCT IN CCB TO VEN-NUM-IVEN IN VEN
      *         PERFORM LEE-VEN
      *         IF ERROR-EN-PROCESO
      *             GO TO NXT-INP-SRT-CCB
      *         ELSE
      *             NEXT SENTENCE
      *     ELSE
      **        Apaga Switch TCB-POR-VEN
      *         MOVE ZEROES TO WSS-IND-VTCB IN WSS-VARI
      **        Busca Primer Vencimiento Existente en la BD
      **        Prende Switch con 1 (LEE-PRIMER-VEN-EXI-BD)
      *         MOVE 1 TO WSS-IND-BVBD IN WSS-VARI
      *         PERFORM LEE-VEN
      *         IF ERROR-EN-PROCESO
      *             GO TO NXT-INP-SRT-CCB.

      ** Prende Switch Primer Registro CCB (PRIMER-REGISTRO-LOOP)
      *     MOVE  1  TO WSS-IND-PRGL IN WSS-VARI.

      ** Formacion y Generacion del Registro SRT
      *     PERFORM BUS-SRT-REG.
      *     IF WSS-IND-NEXT IN WSS-VARI = 1
      *         GO TO NXT-INP-SRT-CCB.

      ** Apaga Switch Primer Registro CCB (PRIMER-REGISTRO-LOOP)
      *     MOVE ZEROES TO WSS-IND-PRGL IN WSS-VARI.
      * NXT-INP-SRT-CCB.
      *     MOVE 'CCB-FEC-FING' TO FIO-AKEY.
      *     MOVE FIO-GET-NXT    TO FIO-CMND.
      *     PERFORM COL-FIO-CCB.
      *     IF NOT FIO-STAT-OKS OR
      *        CCB-FEC-FING IN CCB > WSS-FEC-FFET IN WSS-VARI
      *         GO TO FIN-INP-SRT-CCB.

      *     GO TO LUP-INP-SRT-CCB.
      * FIN-INP-SRT-CCB.
      *     MOVE FIO-CLO TO FIO-CMND.
      *     PERFORM COL-FIO-CCB.
      *DAD  fin 13-DEC-1991
      **************************************************************************
      *
      * PROCESO TRASPASO SITUACION CARTERA DE OPERACIONES ( CCR => TSC )
      *
       INI-INP-SRT-CCR.
           DISPLAY 'PROCESO TRASPASO SITUACION CARTERA ( CCR => TSC )'.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CCR.
           MOVE WSS-FEC-FFEC IN WSS-VARI TO CCR-FEC-FCCR IN CCR.
           MOVE 'CCR-FEC-FCCR' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-CCR.
           IF NOT FIO-STAT-OKS OR
              CCR-FEC-FCCR IN CCR > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS CCR EN RANGO DE FECHAS : '
                       'DESDE ' WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT-CCR.

      * Limpia Switch de Cancelaciones
           MOVE ZEROES TO WSS-IND-CANC IN WSS-VARI.

      * Limpia Indicador de Aceleracion WSS-IND-ACEL (Nivel 88)
           MOVE ZEROES TO WSS-IND-ACEL IN WSS-VARI.

      * Limpia Switch de CCB por VEN
           MOVE ZEROES TO WSS-IND-VTCB IN WSS-VARI.

           MOVE 'TSC' TO CPP-COD-MVTO IN CPP.
       LUP-INP-SRT-CCR.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY ' '.
      *     DISPLAY '% DEBUG, SITUACION CARTERA  : ' CCR-KEY-ICCR IN CCR.
      *     DISPLAY '% CPP-COD-MVTO              : ' CPP-COD-MVTO IN CPP.
      *DAD  fin 24-ABR-1991 

      * Busca la Operacion de Credito por Situacion Cartera
           MOVE CCR-CIC-IOPC IN CCR TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CCR    OPCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY '% ERROR....' MSG-GLS-DESC
               DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'FECHA CCR   : ' CCR-FEC-FCCR IN CCR
               GO TO NXT-INP-SRT-CCR.

      * Proceso de Seleccion y Clasificacion a Partir del Registro CCR
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CCR.

      * Aumenta Contador de Registros CCR Leidos OK
           ADD  1  TO WSS-IND-RCCR IN WSS-VARI.

      * Limpia Switch de Error
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.

      * Busca CIC de Situacion Cartera Actual
           MOVE CCR-IND-SCRT IN CCR TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCRT.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCR.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCRT IN WSS-VARI.

      * Busca CIC de Situacion Cartera Anterior
           MOVE CCR-IND-SCRA IN CCR TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCRT.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCR.
           MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SCRA IN WSS-VARI.

      * Marca Indicador de Reversa para Asientos Contables
           IF ANTIGUA-VENDIDO
               MOVE 1 TO WSS-IND-RSCT IN WSS-VARI
           ELSE
               MOVE 0 TO WSS-IND-RSCT IN WSS-VARI.

      * Busca el Documento de Credito por Situacion Cobranza
           MOVE CCR-KEY-IDLC IN CCR TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CCR    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY '% ERROR....' MSG-GLS-DESC
               DISPLAY 'OPERACION   : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'DOCUMENTO   : ' DLC-KEY-IDLC IN DLC 
               DISPLAY 'FECHA CCR   : ' CCR-FEC-FCCR IN CCR
               GO TO NXT-INP-SRT-CCR.

      * Busca Primer Vencimiento Existente en la BD
      * Prende Switch con 1 (LEE-PRIMER-VEN-EXI-BD)
           MOVE 1 TO WSS-IND-BVBD IN WSS-VARI.
           PERFORM LEE-VEN.
           IF ERROR-EN-PROCESO
               GO TO NXT-INP-SRT-CCR.

      * Prende Switch Primer Registro CCR (PRIMER-REGISTRO-LOOP)
           MOVE  1  TO WSS-IND-PRGL IN WSS-VARI.

      * Formacion y Generacion del Registro SRT
           PERFORM BUS-SRT-REG.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT-CCR.

      * Apaga Switch Primer Registro CCR (PRIMER-REGISTRO-LOOP)
           MOVE ZEROES TO WSS-IND-PRGL IN WSS-VARI.
       NXT-INP-SRT-CCR.
           MOVE 'CCR-FEC-FCCR' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CCR.
           IF NOT FIO-STAT-OKS OR
              CCR-FEC-FCCR IN CCR > WSS-FEC-FFET IN WSS-VARI
               GO TO FIN-INP-SRT-CCR.

           GO TO LUP-INP-SRT-CCR.

       FIN-INP-SRT-CCR.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-CCR.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
      * Efectua el Cierre del Archivo SAM y Display de Contadores
           DISPLAY 'REGISTROS OPC LEIDOS   : ' WSS-IND-ROPC IN WSS-VARI.
           DISPLAY 'REGISTROS CAN LEIDOS   : ' WSS-IND-RCAN IN WSS-VARI.
           DISPLAY 'REGISTROS CCT LEIDOS   : ' WSS-IND-RCCT IN WSS-VARI.
           DISPLAY 'REGISTROS CCB LEIDOS   : ' WSS-IND-RCCB IN WSS-VARI.
           DISPLAY 'REGISTROS CCR LEIDOS   : ' WSS-IND-RCCR IN WSS-VARI.
           DISPLAY 'REGISTROS PROCESADOS   : ' WSS-IND-RPRO IN WSS-VARI.
           DISPLAY 'REGISTROS RECHAZADOS   : ' WSS-IND-RBAD IN WSS-VARI.
           DISPLAY 'REGISTROS MCT GRABADOS : ' WSS-IND-ROKS IN WSS-VARI.
           DISPLAY 'REGISTROS NO GRABADOS  : ' WSS-IND-RERR IN WSS-VARI.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM COL-FIO-MCT.
           OPEN OUTPUT RPTMCT.
           INITIATE RPT-MCT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           PERFORM BUS-REG-CLI.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO FIN-OUT-SRT.
           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO WSS-NUM-DMOV IN WSS-LMC.
           MOVE WSS-NUM-MREG IN WSS-VARI TO WSS-NUM-MMOV IN WSS-LMC.
           MOVE WSS-NUM-SREG IN WSS-VARI TO WSS-NUM-SMOV IN WSS-LMC.
           MOVE WSS-NUM-AREG IN WSS-VARI TO WSS-NUM-AMOV IN WSS-LMC.

           IF SRT-VAL-DEBE IN SRT NOT = 0
               ADD 1 TO WSS-NUM-TDEB IN WSS-VARI.
           IF SRT-VAL-HABE IN SRT NOT = 0
               ADD 1 TO WSS-NUM-THAB IN WSS-VARI.

           GENERATE DL-MCT.
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           TERMINATE RPT-MCT.
           CLOSE RPTMCT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Fechas de Listado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% SEL-REG-PRO'.
      *DAD  fin 24-ABR-1991 

           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

      *DAD  ini 13-DEC-1991 / 24-ABR-1991
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memoria el
      * 'Sistema que lo Maneja'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito
           IF CTO-SIST IN CTO-VARI NOT = 'COL'
               GO TO FIN-SEL-REG-PRO.
      *DAD  fin 13-DEC-1991 / 24-ABR-1991

           IF CPP-COD-MVTO IN CPP = 'CUR'
      *DAD  ini 24-ABR-1991 
      *         DISPLAY '% OPC-MSC-STAT     : ' OPC-MSC-STAT IN OPC
      *DAD  fin 24-ABR-1991 
               IF OPC-MSC-STAT IN OPC = 'A' AND OPC-VAL-SCRE > ZEROES
                   MOVE OPC-FEC-FING IN OPC TO SRT-FEC-FMOV IN SRT
                   MOVE OPC-COD-OFOC IN OPC TO SRT-COD-OFIC IN SRT
               ELSE
                   GO TO FIN-SEL-REG-PRO
           ELSE
           IF CPP-COD-MVTO IN CPP = 'CAN'
      *DAD  ini 24-ABR-1991 
      *         DISPLAY '% CAN-MSC-STAT     : ' CAN-MSC-STAT IN CAN
      *DAD  fin 24-ABR-1991 
               IF CAN-MSC-STAT IN CAN = 'A'
                   MOVE CAN-FEC-FEGR IN CAN TO SRT-FEC-FMOV IN SRT
                   MOVE CAN-COD-OFCA IN CAN TO SRT-COD-OFIC IN SRT
               ELSE
                   GO TO FIN-SEL-REG-PRO
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCT' OR
              CPP-COD-MVTO IN CPP = 'CAS'
      *DAD  ini 24-ABR-1991 
      *         DISPLAY '% OPC-MSC-STAT     : ' OPC-MSC-STAT IN OPC
      *DAD  fin 24-ABR-1991 
               IF OPC-MSC-STAT IN OPC = 'A'
                   MOVE OPC-COD-OFOC IN OPC TO SRT-COD-OFIC IN SRT
                   MOVE CCT-FEC-FCCT IN CCT TO SRT-FEC-FMOV IN SRT
               ELSE
                   GO TO FIN-SEL-REG-PRO
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCB'
      *DAD  ini 24-ABR-1991 
      *         DISPLAY '% OPC-MSC-STAT     : ' OPC-MSC-STAT IN OPC
      *DAD  fin 24-ABR-1991 
               IF OPC-MSC-STAT IN OPC = 'A'
                   MOVE OPC-COD-OFOC IN OPC TO SRT-COD-OFIC IN SRT
                   MOVE CCB-FEC-FING IN CCB TO SRT-FEC-FMOV IN SRT
               ELSE
                   GO TO FIN-SEL-REG-PRO
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TSC'
      *DAD  ini 24-ABR-1991 
      *         DISPLAY '% OPC-MSC-STAT     : ' OPC-MSC-STAT IN OPC
      *DAD  fin 24-ABR-1991 
               IF OPC-MSC-STAT IN OPC = 'A'
                   MOVE OPC-COD-OFOC IN OPC TO SRT-COD-OFIC IN SRT
                   MOVE CCR-FEC-FCCR IN CCR TO SRT-FEC-FMOV IN SRT
               ELSE
                   GO TO FIN-SEL-REG-PRO.

      *DAD  ini 24-ABR-1991 
      * Chequea Oficina del Parametro con Oficina de Credito o de Cancelacion
           IF WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF CPP-COD-MVTO  IN CPP = 'CUR' OR
                  CPP-COD-MVTO  IN CPP = 'TCT' OR
                  CPP-COD-MVTO  IN CPP = 'TCB' OR
                  CPP-COD-MVTO  IN CPP = 'TSC'
                   IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                       GO TO FIN-SEL-REG-PRO
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF CPP-COD-MVTO  IN CPP = 'CAN' AND
                  WSS-COD-OFIC IN WSS-VARI NOT = CAN-COD-OFCA IN CAN
                   GO TO FIN-SEL-REG-PRO.
      *DAD  fin 24-ABR-1991 

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Formacion y Generacion del Registro SRT
       BUS-SRT-REG SECTION.
       INI-BUS-SRT-REG.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-SRT-REG'.
      *DAD  fin 24-ABR-1991 

           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
           ADD   1  TO WSS-IND-RPRO IN WSS-VARI.

      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
      *     IF CPP-COD-MVTO IN CPP = 'CAN' OR 'TCB' OR 'TSC'
           IF CPP-COD-MVTO IN CPP = 'CAN'
               MOVE RCV-IND-SCTB IN RCV TO WSS-IND-SCTB IN WSS-VARI
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCB' OR 'TSC'
      *DAD  fin 13-DEC-1991
               IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN OR
                  ( CPP-COD-MVTO = 'TCB' OR 'TSC' )
      *        Busca el Ultimo Cambio de Situacion Contable de DLC (si hay)
                   MOVE DLC-KEY-IDLC IN DLC TO CCT-KEY-IDLC IN CCT
                   MOVE 99                  TO CCT-NUM-ICCT IN CCT
                   MOVE FIO-GET-LEQ TO FIO-CMND
                   PERFORM COL-FIO-CCT
                   IF NOT FIO-STAT-OKS OR
                      CCT-KEY-IDLC IN CCT NOT = DLC-KEY-IDLC IN DLC
                       MOVE DLC-IND-SCTB IN DLC TO
                            WSS-IND-SCTB IN WSS-VARI
                   ELSE
                       MOVE CCT-IND-SCTB IN CCT TO
                            WSS-IND-SCTB IN WSS-VARI
               ELSE
                   MOVE RCV-IND-SCTB IN RCV TO
                        WSS-IND-SCTB IN WSS-VARI.

      * Obtiene Vector de Asientos Contables al Leer Registro CPP
           MOVE OPC-COD-VCOC IN OPC TO CPP-COD-VCOC IN CPP.
           MOVE OPC-COD-COOC IN OPC TO CPP-COD-COOC IN CPP.
           IF CPP-COD-MVTO IN CPP = 'CUR'
               MOVE DLC-IND-SCRT IN DLC TO CPP-IND-SCRT IN CPP
               MOVE DLC-IND-SCTB IN DLC TO CPP-IND-SCTB IN CPP
           ELSE
           IF CPP-COD-MVTO IN CPP = 'CAN'
               MOVE DLC-IND-SCRT IN DLC TO CPP-IND-SCRT IN CPP
               MOVE WSS-IND-SCTB IN WSS-VARI TO CPP-IND-SCTB IN CPP
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS'
               MOVE DLC-IND-SCRT IN DLC TO CPP-IND-SCRT IN CPP
               IF REVERSA-DEBE-HABER
                   MOVE CCT-IND-SCTB IN CCT TO CPP-IND-SCTB IN CPP
               ELSE
                   MOVE CCT-IND-SCTA IN CCT TO CPP-IND-SCTB IN CPP
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCB'
               MOVE DLC-IND-SCRT IN DLC TO CPP-IND-SCRT IN CPP
               MOVE WSS-IND-SCTB IN WSS-VARI TO CPP-IND-SCTB IN CPP
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TSC'
               MOVE WSS-IND-SCTB IN WSS-VARI TO CPP-IND-SCTB IN CPP
               IF REVERSA-DEBE-HABER
                   MOVE CCR-IND-SCRT IN CCR TO CPP-IND-SCRT IN CPP
               ELSE
                   MOVE CCR-IND-SCRA IN CCR TO CPP-IND-SCRT IN CPP.

      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
      * Busca en la Tabla cargada en Memoria con el Codigo Miscelaneo deseado
           MOVE 'COL'               TO CMM-SIST IN CMM-VARI.
           MOVE 'SCTB'              TO CMM-TMSC IN CMM-VARI.
           MOVE CPP-IND-SCTB IN CPP TO CMM-CMSC IN CMM-VARI.
           PERFORM GNS-BUS-CMM.
           IF CMM-CMSG IN CMM-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CMM-CMSG IN CMM-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CMM-MEN2 IN CMM-VARI
               DISPLAY 'CON CODIGO : '     CMM-MSCL IN CMM-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               ADD 1 TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-BUS-SRT-REG.

      * Obtiene CIC del Codigo Miscelaneo Solicitado
           MOVE MSC-CIC-CMSC IN MSC TO CPP-IND-SCTB IN CPP.
      *DAD  fin 13-DEC-1991

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CPP.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CPP    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' CPP-KEY-ICPP IN CPP
                       ' CON CIC OPERACION : ' OPC-CIC-IOPC IN OPC
               ADD 1 TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-BUS-SRT-REG.

      * Obtiene Valor de Cambio en Pesos para Moneda Nacional
           IF ( PRIMER-REGISTRO-LOOP AND
              ( CPP-COD-MVTO IN CPP = 'CUR' OR 'CAN' ) ) OR
              ( CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS' OR 'TCB' OR 'TSC' )
               MOVE  0  TO WSS-IND-MNRJ IN WSS-VARI
               IF OPC-MSC-TVOC IN OPC = '0' AND
                  OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS-VARI
                   MOVE  1  TO WSS-IND-MNRJ IN WSS-VARI
                   MOVE  0  TO WSS-IND-ERRO IN WSS-VARI
                   PERFORM DET-VAL-PESO
                   IF ERROR-EN-PROCESO
                       GO TO FIN-BUS-SRT-REG.

      * Inicializa Vector de Montos
           MOVE ZEROES TO WSS-VEC-ACTB IN WSS-VARI.

      * Apagar Switch WSS-IND-RDEV (REVERSA-DEVENGOS)
           MOVE ZEROES TO WSS-IND-RDEV IN WSS-VARI.

      * Revisa CPP para Prender Switch WSS-IND-RDEV (REVERSA-DEVENGOS)
           PERFORM REV-IND-RDEV VARYING WSS-NUM-ICPP IN WSS-VARI FROM 1
                             BY 1 UNTIL WSS-NUM-ICPP IN WSS-VARI > 25.

      * Respalda DLC-VAL-INTD y DLC-VAL-READ
           MOVE DLC-VAL-INTD IN DLC TO WSS-VAL-INTD IN WSS-VARI.
           MOVE DLC-VAL-READ IN DLC TO WSS-VAL-READ IN WSS-VARI.

      * Llenado del Vector de Montos
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI
                          WSS-IND-CIYR IN WSS-VARI
                          WSS-IND-CRYR IN WSS-VARI.
           MOVE 27 TO WSS-NUM-ICPA IN WSS-VARI.
           PERFORM PUT-VEC-MNTO VARYING WSS-NUM-ICPP IN WSS-VARI FROM 1
                             BY 1 UNTIL WSS-NUM-ICPP IN WSS-VARI > 25 OR
                                        ERROR-EN-PROCESO.
           IF ERROR-EN-PROCESO
               GO TO FIN-BUS-SRT-REG.

      * Forma Llave COD-CCTB para Leer DCC
           MOVE OPC-COD-VCOC IN OPC TO DCC-COD-VCAM IN DCC.
           MOVE OPC-COD-TOOC IN OPC TO DCC-COD-TOCR IN DCC.
           MOVE DLC-COD-PLZO IN DLC TO DCC-COD-PLZO IN DCC.
           IF CPP-COD-MVTO IN CPP = 'CUR'
               MOVE DLC-IND-SCTB IN DLC TO DCC-IND-SCTB IN DCC
      *DAD  ini 13-DEC-1991
      *         MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC
               MOVE SPACES              TO DCC-IND-SCBZ IN DCC
      *DAD  fin 13-DEC-1991
               MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC
           ELSE
           IF CPP-COD-MVTO IN CPP = 'CAN'
               MOVE WSS-IND-SCTB IN WSS-VARI TO DCC-IND-SCTB IN DCC
      *DAD  ini 13-DEC-1991
      *         MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC
               MOVE SPACES              TO DCC-IND-SCBZ IN DCC
      *DAD  fin 13-DEC-1991
               MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS'
      *DAD  ini 13-DEC-1991
      *         MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC
               MOVE SPACES              TO DCC-IND-SCBZ IN DCC
      *DAD  fin 13-DEC-1991
               MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCB'
               MOVE WSS-IND-SCTB IN WSS-VARI TO DCC-IND-SCTB IN DCC
               MOVE DLC-IND-SCRT IN DLC      TO DCC-IND-SCRT IN DCC
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TSC'
               MOVE WSS-IND-SCTB IN WSS-VARI TO DCC-IND-SCTB IN DCC
      *DAD  ini 13-DEC-1991
      *         MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC.
               MOVE SPACES              TO DCC-IND-SCBZ IN DCC.
      *DAD  fin 13-DEC-1991

      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
      * Busca en la Tabla cargada en Memoria con el Codigo Miscelaneo deseado
           MOVE 'COL'               TO CMM-SIST IN CMM-VARI.
           MOVE 'SCTB'              TO CMM-TMSC IN CMM-VARI.
           MOVE DCC-IND-SCTB IN DCC TO CMM-CMSC IN CMM-VARI.
           PERFORM GNS-BUS-CMM.
           IF CMM-CMSG IN CMM-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CMM-CMSG IN CMM-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CMM-MEN2 IN CMM-VARI
               DISPLAY 'CON CODIGO : '     CMM-MSCL IN CMM-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               ADD 1 TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-BUS-SRT-REG.

      * Obtiene CIC del Codigo Miscelaneo Solicitado
           MOVE MSC-CIC-CMSC IN MSC TO DCC-IND-SCTB IN DCC.
      *DAD  fin 13-DEC-1991

      * Con BUS-TAB Busca Estado de IND-PCTB de Tabla AUX para Completar Llave
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL IN TAB
                       ' AL BUSCAR IND-PCTB CON CLASE OPERACION DE LA'
                       ' OPERACION : ' OPC-CIC-IOPC IN OPC
               ADD 1 TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-BUS-SRT-REG.

           MOVE TAB TO AUX.
           IF AUX-IND-PCTB NOT = 'N'
               MOVE OPC-COD-AOOC IN OPC TO DCC-COD-AOCR IN DCC
           ELSE
               MOVE SPACES TO DCC-COD-AOCR IN DCC.

      * Generacion de los Registros SRT
           MOVE ZEROES TO WSS-IND-ERRO IN WSS-VARI.
           PERFORM GEN-REG-SRT VARYING WSS-NUM-ICPP IN WSS-VARI FROM 1
                            BY 1 UNTIL WSS-NUM-ICPP IN WSS-VARI > 35 OR
                                       ERROR-EN-PROCESO.
           IF ERROR-EN-PROCESO
               GO TO FIN-BUS-SRT-REG.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-BUS-SRT-REG.
           EXIT.
      **************************************************************************
      * Obtiene Valor de Cambio en Pesos para Moneda Nacional
        DET-VAL-PESO SECTION.
        INI-DET-VAL-PESO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% DET-VAL-PESO'.
      *DAD  fin 24-ABR-1991 

      * Obtiene Valor de Cambio en Pesos a Fecha Colocacion
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1).
           MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA COLOCACION : '
                        OPC-FEC-FCOL IN OPC ' PARA : '
                        OPC-COD-VCOC IN OPC ' EN OPERACION : '
                        OPC-CIC-IOPC IN OPC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               ADD   1  TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-DET-VAL-PESO
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCOL IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos a Fecha Cancelacion Real
           IF CPP-COD-MVTO IN CPP = 'CAN'
               MOVE CAN-FEC-FCAN IN CAN      TO CAM-FEC-FCAM IN CAM(1)
               MOVE CAN-FEC-FCAN IN CAN      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FEC. CANCEL. : '
                            CAN-FEC-FCAN IN CAN ' PARA : '
                            OPC-COD-VCOC IN OPC ' EN CANCELACION : '
                            CAN-KEY-ICAN IN CAN
                   MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                   GO TO FIN-DET-VAL-PESO
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCAN IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos a Fecha Traspaso Sit. Cobranza
           IF CPP-COD-MVTO IN CPP = 'TCB'
               MOVE CCB-FEC-FING IN CCB      TO CAM-FEC-FCAM IN CAM(1)
               MOVE CCB-FEC-FING IN CCB      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FING CCB : '
                            CCB-FEC-FING IN CCB ' PARA : '
                            OPC-COD-VCOC IN OPC ' EN TRASPASO CCB : '
                            CCB-KEY-ICCB IN CCB ' DE VENCIMIENTO  : '
                            CCB-KEY-IVCT IN CCB
                   MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                   GO TO FIN-DET-VAL-PESO
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCBR IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos a Fecha Traspaso Sit. Cartera
           IF CPP-COD-MVTO IN CPP = 'TSC'
               MOVE CCR-FEC-FCCR IN CCR      TO CAM-FEC-FCAM IN CAM(1)
               MOVE CCR-FEC-FCCR IN CCR      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FCCR CCR : '
                            CCR-FEC-FCCR IN CCR ' PARA : '
                            OPC-COD-VCOC IN OPC ' EN TRASPASO CCR : '
                            CCR-KEY-ICCR IN CCR
                   MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                   GO TO FIN-DET-VAL-PESO
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FCBR IN WSS-VARI.

      * Obtiene Valor de Cambio en Pesos a Fecha Vencimiento
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS' OR 'TCB' OR 'TSC'
               MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(1)
               MOVE VEN-FEC-FVEN IN VEN      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO EXISTE VALOR DE CAMBIO A FECHA VCTO. : '
                            VEN-FEC-FVEN IN VEN ' PARA : '
                            OPC-COD-VCOC IN OPC ' EN VENCIMIENTO : '
                            VEN-KEY-IVEN IN VEN
                   MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                   GO TO FIN-DET-VAL-PESO
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FVEN IN WSS-VARI.

           IF CPP-COD-MVTO IN CPP = 'TCT'
      * Obtiene Valor de Cambio en Pesos a Fecha Corte Devengo Int y Reaj
               IF RYD-FEC-FCDV IN RYD-VARI NOT >
                  WSS-FEC-FFET IN WSS-VARI
                   MOVE RYD-FEC-FCDV IN RYD-VARI TO
                        CAM-FEC-FCAM IN CAM(1)
                   MOVE RYD-FEC-FCDV IN RYD-VARI TO
                        CAM-FEC-FCAM IN CAM(2)
                   MOVE OPC-COD-VCOC IN OPC      TO
                        CAM-COD-VCAM IN CAM(1)
                   MOVE WSS-COD-PESO IN WSS-VARI TO
                        CAM-COD-VCAM IN CAM(2)
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-CAM
                   IF NOT FIO-STAT-OKS
                       DISPLAY ' '
                       DISPLAY '% ERROR.....CAM A FECHA CORTE DEVENGO'
                       DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
                       DISPLAY 'Fecha CRI    : ' CRI-FEC-FCLA IN CRI
                       DISPLAY 'Fecha C.Devg : '
                                RYD-FEC-FCDV IN RYD-VARI
                       MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
                       ADD  1 TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-DET-VAL-PESO
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO
                            RYD-SGV-FCDV IN RYD-VARI
               ELSE
      * Obtiene Valor de Cambio en Pesos a Fecha Clasificacion Riesgo
               IF RIESGOSO AND
                  RYD-FEC-FCLA IN RYD-VARI NOT >
                  WSS-FEC-FFET IN WSS-VARI
                   MOVE RYD-FEC-FCLA IN RYD-VARI TO
                        CAM-FEC-FCAM IN CAM(1)
                   MOVE RYD-FEC-FCLA IN RYD-VARI TO
                        CAM-FEC-FCAM IN CAM(2)
                   MOVE OPC-COD-VCOC IN OPC      TO
                        CAM-COD-VCAM IN CAM(1)
                   MOVE WSS-COD-PESO IN WSS-VARI TO
                        CAM-COD-VCAM IN CAM(2)
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-CAM
                   IF NOT FIO-STAT-OKS
                       DISPLAY ' '
                       DISPLAY '% ERROR.....CAM A FECHA CORTE DEVENGO'
                       DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
                       DISPLAY 'Fecha CRI    : ' CRI-FEC-FCLA IN CRI
                       DISPLAY 'Fecha C.Ries : '
                                RYD-FEC-FCLA IN RYD-VARI
                       MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
                       ADD  1 TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-DET-VAL-PESO
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO
                            RYD-SGV-FCLA IN RYD-VARI.
       FIN-DET-VAL-PESO.
           EXIT.
      **************************************************************************
      * Revisa CPP para Prender Switch WSS-IND-RDEV (REVERSA-DEVENGOS)
       REV-IND-RDEV SECTION.
       INI-REV-IND-RDEV.
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'M' OR 'N' OR
                                                  'O' OR 'P'
               MOVE 1 TO WSS-IND-RDEV IN WSS-VARI.
       FIN-REV-IND-RDEV.
           EXIT.
      **************************************************************************
      * Determinacion de llenado del Vector de Montos
       PUT-VEC-MNTO SECTION.
       INI-PUT-VEC-MNTO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% PUT-VEC-MNTO'.
      *DAD  fin 24-ABR-1991 

           IF ( CPP-MSC-TCCT IN CPP(WSS-NUM-ICPP) NOT = SPACES AND
                PRIMER-REGISTRO-LOOP ) OR
              ( ( CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'A' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'B' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'D' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'E' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'G' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'H' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'I' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'M' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'N' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'O' OR
                  CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'P' ) AND
                CPP-MSC-TCCT IN CPP(WSS-NUM-ICPP) NOT = SPACES )
               PERFORM DET-VAL-MNTO.
       FIN-PUT-VEC-MNTO.
           EXIT.
      **************************************************************************
      * Llenado del Vector de Montos
       DET-VAL-MNTO SECTION.
       INI-DET-VAL-MNTO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% DET-VAL-MNTO'.
      *DAD  fin 24-ABR-1991 

      *
      * SE SALTA LOS CAMPOS VACIOS ( PARA OPTIMIZAR PROCESO )
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) NOT > SPACES
               NEXT SENTENCE
           ELSE
      * Mueve Valores CPP(TCCT,DBHB,TALG) a WSS-VEC-ACTB
           PERFORM MOV-VEC-ACTB
      *
      * MONTO DEL CREDITO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'A'
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY DLC-VAL-NDLC IN DLC BY WSS-SGV-FCOL IN
                        WSS-VARI GIVING PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
               ELSE
                   MOVE DLC-VAL-NDLC IN DLC TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO DEL IMPUESTO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'B'
               MOVE DLC-VAL-IMPU IN DLC TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO DE LA COMISION
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'C'
               MOVE OPC-SGV-VCOM IN OPC TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO LIQUIDO DEL CREDITO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'D'
               IF PRIMER-REGISTRO-LOOP
                   SUBTRACT DLC-VAL-IMPU IN DLC
                            OPC-SGV-VCOM IN OPC
                       FROM DLC-VAL-DPES IN DLC GIVING
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
               ELSE
                   SUBTRACT DLC-VAL-IMPU IN DLC
                       FROM DLC-VAL-DPES IN DLC GIVING
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO INTERES ANTICIPADOS DEL DOCUMENTO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'E'
      *        Prende Switch Busca Vencimiento BD con 1 (LEE-PRIMER-VEN-EXI-BD)
               MOVE 1 TO WSS-IND-BVBD IN WSS-VARI
               PERFORM LEE-VEN
               IF ERROR-EN-PROCESO
                   GO TO FIN-DET-VAL-MNTO
               ELSE
                   SUBTRACT VEN-VAL-SCAP IN VEN FROM
                            VEN-VAL-SFIN IN VEN GIVING
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   IF MON-NACIONAL-REAJUSTABLE
                       MULTIPLY WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                             BY WSS-SGV-FCOL IN WSS-VARI GIVING
                                PES-SGV-ENTE IN PES-VARI ROUNDED
                       MOVE PES-SGV-ENTE IN PES-VARI TO
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   ELSE
                       NEXT SENTENCE
           ELSE
      *
      * MONTO TOTAL TRASPASADO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'F' AND
              ( ( CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS' ) OR
                ( CPP-COD-MVTO IN CPP = 'TCB' AND TCB-POR-VEN ) )
               PERFORM CAL-CAP-PAGA
               MOVE WSS-VAL-CAPI IN WSS-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
               IF NOT ACELERACION OR
                  ( ACELERACION AND PRIMER-REGISTRO-LOOP )
      *            Calcula Intereses ( Norm, x Cobrar Vcd, Riesgosos y Orden )
                   PERFORM CAL-INT-PAGA
                   IF CPP-COD-MVTO IN CPP = 'TCT' AND
                      RYD-VAL-IPCV IN RYD-VARI > 0
      *                Contabiliza en Interes x Cobrar Vencidos
                       MOVE 'ICV' TO
                            WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP)
                       ADD  RYD-VAL-IPCV IN RYD-VARI TO
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   ELSE
      *                Contabiliza Interes Normal en Cartera Vencida
                       ADD WSS-VAL-INTE IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
      *                Calcula Reajustes ( Normales, Riesgosos y Orden )
                       PERFORM CAL-REA-PAGA
                       ADD WSS-VAL-REAJ IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                       IF REVERSA-DEVENGOS
                           ADD WSS-VAL-INTD IN WSS-VARI TO
                               WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                           ADD WSS-VAL-READ IN WSS-VARI TO
                               WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                       ELSE
                           NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      *
      * MONTO CAPITAL PAGADO o TRASPASADO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'G'
               PERFORM CAL-CAP-PAGA
               MOVE WSS-VAL-CAPI IN WSS-VARI TO WSS-VAL-MNTO IN
                                                WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO INTERESES PAGADOS Y/O TRASPASADOS
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'H'
               PERFORM CAL-INT-PAGA
               MOVE WSS-VAL-INTE IN WSS-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
               IF CPP-COD-MVTO IN CPP = 'TCT'
      *            Contabiliza Intereses Riesgosos y Orden (Si Corresponde)
                   PERFORM PUT-VAL-IRYO
               ELSE
                   NEXT SENTENCE
           ELSE
      *
      * MONTO REAJUSTES PAGADOS Y/O TRASPASADOS
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'I'
               PERFORM CAL-REA-PAGA
               MOVE WSS-VAL-REAJ IN WSS-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
               IF CPP-COD-MVTO IN CPP = 'TCT'
      *            Contabiliza Reajustes Riesgosos y Orden (Si Corresponde)
                   PERFORM PUT-VAL-RRYO
               ELSE
                   NEXT SENTENCE
           ELSE
      *
      * MONTO TRASPASADO COBRANZA JUDICIAL O VENDIDO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'J'
      *        Calcula Intereses del Vencimiento
               PERFORM CAL-INT-PAGA
               ADD WSS-VAL-INTE IN WSS-VARI TO
                   WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
      *        Calcula Reajustes
               PERFORM CAL-REA-PAGA
               ADD WSS-VAL-REAJ IN WSS-VARI TO
                   WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY OPC-VAL-SCRE IN OPC BY
                            WSS-SGV-FCOL IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   ADD PES-SGV-ENTE IN PES-VARI TO
                       WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   IF CPP-COD-MVTO IN CPP = 'TCT' AND REVERSA-DEVENGOS
                       ADD WSS-VAL-INTD IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                       ADD WSS-VAL-READ IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   ELSE
                       NEXT SENTENCE
               ELSE
                   ADD OPC-VAL-SCRE IN OPC TO
                       WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   IF CPP-COD-MVTO IN CPP = 'TCT' AND REVERSA-DEVENGOS
                       ADD WSS-VAL-INTD IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                       ADD WSS-VAL-READ IN WSS-VARI TO
                           WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
                   ELSE
                       NEXT SENTENCE
           ELSE
      *
      * SALDO DEL CREDITO
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'K'
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY OPC-VAL-SCRE IN OPC BY WSS-SGV-FCOL IN
                        WSS-VARI GIVING PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
               ELSE
                   MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO GASTOS PAGADOS
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'L'
               MOVE CAN-SGV-GAST IN CAN TO WSS-VAL-MNTO IN
                                               WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO INTERESES GANADOS
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'M'
               PERFORM CAL-INT-PAGA
               IF ERROR-EN-PROCESO
                   NEXT SENTENCE
               ELSE
                   IF CPP-COD-MVTO IN CPP = 'TCT'
                       MOVE WSS-VAL-INTE IN WSS-VARI TO
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
      *                Contabiliza Intereses Riesgosos y Orden (Si Corresponde)
                       PERFORM PUT-VAL-IRYO
                   ELSE
                       SUBTRACT WSS-VAL-INTD IN WSS-VARI FROM
                                WSS-VAL-INTE IN WSS-VARI GIVING
                                WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO REAJUSTES GANADOS
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'N'
               PERFORM CAL-REA-PAGA
               IF CPP-COD-MVTO IN CPP = 'TCT'
                   MOVE WSS-VAL-REAJ IN WSS-VARI TO
                        WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
      *            Contabiliza Reajustes Riesgosos y Orden (Si Corresponde)
                   PERFORM PUT-VAL-RRYO
               ELSE
                   SUBTRACT WSS-VAL-READ IN WSS-VARI FROM
                            WSS-VAL-REAJ IN WSS-VARI GIVING
                            WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO INTERESES DEVENGADOS MES ANTERIOR
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'O'
               MOVE WSS-VAL-INTD IN WSS-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP)
           ELSE
      *
      * MONTO REAJUSTES DEVENGADOS MES ANTERIOR
           IF CPP-IND-TALG IN CPP(WSS-NUM-ICPP) = 'P'
               MOVE WSS-VAL-READ IN WSS-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP).
       FIN-DET-VAL-MNTO.
           EXIT.
      **************************************************************************
      * Busca Vencimiento
       LEE-VEN SECTION.
       INI-LEE-VEN.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% LEE-VEN'.
      *DAD  fin 24-ABR-1991 

           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           IF LEE-PRIMER-VEN-EXI-BD
      *        Lee Primer Vencimiento Existente en la Base de Datos
               MOVE FIO-GET-KEY TO FIO-CMND
               IF OPC-IND-VSTR IN OPC NOT = 'S' 
                   MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
                   PERFORM COL-FIO-VEN
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    PVINX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC '/KEY ' VEN-KEY-IVEN IN VEN
                               ' FIO-STAT : ' FIO-STAT
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-LEE-VEN
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE  1  TO VEN-NUM-IVEN IN VEN
                   PERFORM COL-OBT-VEN
                   IF NOT VEN-STAT-OKS
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    PVINX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC '/KEY ' VEN-KEY-IVEN IN VEN
                               ' FIO-STAT : ' FIO-STAT
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-LEE-VEN
                   ELSE
                       NEXT SENTENCE
           ELSE
           IF LEE-PROXIMO-VEN
      *        Lee Siguiente Vencimiento de la Operacion de Credito
               MOVE FIO-GET-NXT TO FIO-CMND
               IF OPC-IND-VSTR IN OPC NOT = 'S' 
                   PERFORM COL-FIO-VEN
                   IF NOT FIO-STAT-OKS OR
                      OPC-CIC-IOPC IN OPC NOT = VEN-CIC-IOPC IN VEN
                       GO TO FIN-LEE-VEN
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   PERFORM COL-OBT-VEN
                   IF VEN-STAT-EOF
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       GO TO FIN-LEE-VEN
                   ELSE
                       IF NOT VEN-STAT-OKS
                           MOVE 'COL'          TO MSG-COD-SIST
                           MOVE 'VEN    NXTNX' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           DISPLAY MSG-GLS-DESC '/KEY '
                               VEN-KEY-IVEN IN VEN
                               ' VEN-STAT : ' VEN-STAT
                           MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                           ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                           GO TO FIN-LEE-VEN
                       ELSE
                           NEXT SENTENCE
           ELSE
      *        Lee Vencimiento Especifico de la Base de Datos
               MOVE FIO-GET-KEY TO FIO-CMND
               IF OPC-IND-VSTR IN OPC NOT = 'S' 
                   PERFORM COL-FIO-VEN
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC '/KEY ' VEN-KEY-IVEN IN VEN
                               ' FIO-STAT : ' FIO-STAT
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-LEE-VEN
                   ELSE
                       NEXT SENTENCE
               ELSE
                   PERFORM COL-OBT-VEN
                   IF NOT VEN-STAT-OKS
                       MOVE 'COL'          TO MSG-COD-SIST
                       MOVE 'VEN    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC '/KEY ' VEN-KEY-IVEN IN VEN
                               ' VEN-STAT : ' VEN-STAT
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-LEE-VEN.
       FIN-LEE-VEN.
           EXIT.
      **************************************************************************
      * Mueve Vector Asientos Contables CPP a WSS
       MOV-VEC-ACTB SECTION.
       INI-MOV-VEC-ACTB.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% MOV-VEC-ACTB'.
      *DAD  fin 24-ABR-1991 

           MOVE CPP-MSC-TCCT IN CPP(WSS-NUM-ICPP) TO
                WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP).

           MOVE CPP-IND-DBHB IN CPP(WSS-NUM-ICPP) TO
                WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP).

           MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPP).
       FIN-MOV-VEC-ACTB.
           EXIT.
      **************************************************************************
      * Calcula Monto Capital Pagado
       CAL-CAP-PAGA SECTION.
       INI-CAL-CAP-PAGA.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% CAL-CAP-PAGA'.
      *DAD  fin 24-ABR-1991 

           IF CPP-COD-MVTO IN CPP = 'CAN'
      *    Calcula Monto Capital Pagado para las Cancelaciones 'CAN'
      *    Revisa Capital Pagado Moviendolo a PES-SGV-DECI
               IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
                   MOVE DLC-VAL-DPES IN DLC TO WSS-VAL-CAPI IN WSS-VARI
                   GO TO FIN-CAL-CAP-PAGA
               ELSE
                   MOVE RCV-SGV-CAPI IN RCV TO PES-SGV-DECI IN PES-VARI
                   IF MON-NACIONAL-REAJUSTABLE
                       MULTIPLY PES-SGV-DECI IN PES-VARI BY
                                WSS-SGV-FCOL IN WSS-VARI GIVING
                                PES-SGV-ENTE IN PES-VARI ROUNDED
                       MOVE PES-SGV-ENTE IN PES-VARI TO
                            WSS-VAL-CAPI IN WSS-VARI
                       GO TO FIN-CAL-CAP-PAGA
                   ELSE
                       MOVE PES-SGV-DECI IN PES-VARI TO
                            WSS-VAL-CAPI IN WSS-VARI
                       GO TO FIN-CAL-CAP-PAGA.

      * Calcula Monto Capital Traspasado para Traspasos 'TCT' o 'CAS' o
      * 'TCB' si es por VEN
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS' OR
              ( CPP-COD-MVTO IN CPP = 'TCB' AND TCB-POR-VEN )
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            WSS-SGV-FCOL IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-CAPI IN WSS-VARI
                   GO TO FIN-CAL-CAP-PAGA
               ELSE
                   MOVE VEN-VAL-SCAP IN VEN TO WSS-VAL-CAPI IN WSS-VARI
                   GO TO FIN-CAL-CAP-PAGA.

      * Calcula Monto Capital Traspasado para Traspasos 'TCB' ( Si no es
      * por VEN ) y para Traspasos 'TSC'
           IF ( CPP-COD-MVTO IN CPP = 'TCB' AND NOT TCB-POR-VEN ) OR
              CPP-COD-MVTO IN CPP = 'TSC'
               MOVE DLC-VAL-DPES IN DLC TO WSS-VAL-CAPI IN WSS-VARI
               GO TO FIN-CAL-CAP-PAGA.
       FIN-CAL-CAP-PAGA.
           EXIT.
      **************************************************************************
      * Calcula Monto Intereses Pagados
       CAL-INT-PAGA SECTION.
       INI-CAL-INT-PAGA.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% CAL-INT-PAGA'.
      *DAD  fin 24-ABR-1991 

      * Calcula Monto Intereses para los Traspasos 'CAS' o 'TCB' o 'TSC'
           IF CPP-COD-MVTO IN CPP = 'CAS' OR 'TCB' OR 'TSC'
               SUBTRACT VEN-VAL-SCAP IN VEN FROM VEN-VAL-SFIN IN VEN
                             GIVING WSS-VAL-INTE IN WSS-VARI ROUNDED
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY WSS-VAL-INTE IN WSS-VARI BY
                            WSS-SGV-FVEN IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-INTE IN WSS-VARI
                   GO TO FIN-CAL-INT-PAGA
               ELSE 
                   GO TO FIN-CAL-INT-PAGA.

      * Calcula Monto Intereses Traspasados para los Traspasos 'TCT'
           IF CPP-COD-MVTO IN CPP = 'TCT'
               IF NOT CAL-INT-YA-REALIZADO
      *            Busca Tasa de Interes (ICG de OPC o DLC)
                   MOVE DLC-KEY-IDLC IN DLC TO VIN-KEY-IDLC IN VIN-VARI
                   PERFORM BUS-VIN
                   IF NOT FIO-STAT-OKS
                       MOVE 'COL'        TO MSG-COD-SIST
                       MOVE 'ICG    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY ' '
                       DISPLAY '% ERROR ...' MSG-GLS-DESC
                       DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
                       DISPLAY 'ASIENTO CONTABLE NRO.   : '
                               WSS-NUM-ICPP IN WSS-VARI
                       DISPLAY 'TIPO DE CUENTA CONTABLE : '
                               WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP)
                       DISPLAY 'TIPO DE ALGORITMO       : '
                               WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPP)
                       MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                       ADD   1  TO WSS-IND-RBAD IN WSS-VARI
                       GO TO FIN-CAL-INT-PAGA
                   ELSE
      *                Obtiene Int : Normales, Por Cobrar Vcd, Riesgosos y Orden
                       PERFORM OBT-VAL-INRO
                       IF MON-NACIONAL-REAJUSTABLE
                           MULTIPLY WSS-VAL-INTE IN WSS-VARI BY
                                    WSS-SGV-FVEN IN WSS-VARI GIVING
                                    PES-SGV-ENTE IN PES-VARI ROUNDED
                           MOVE PES-SGV-ENTE IN PES-VARI TO
                                WSS-VAL-INTE IN WSS-VARI
                           MULTIPLY RYD-VAL-IPCV IN RYD-VARI BY
                                    WSS-SGV-FVEN IN WSS-VARI GIVING
                                    PES-SGV-ENTE IN PES-VARI ROUNDED
                           MOVE PES-SGV-ENTE IN PES-VARI TO
                                RYD-VAL-IPCV IN RYD-VARI
                           MULTIPLY RYD-VAL-IRIE IN RYD-VARI BY
                                    WSS-SGV-FVEN IN WSS-VARI GIVING
                                    PES-SGV-ENTE IN PES-VARI ROUNDED
                           MOVE PES-SGV-ENTE IN PES-VARI TO
                                RYD-VAL-IRIE IN RYD-VARI
                           MULTIPLY RYD-VAL-IORD IN RYD-VARI BY
                                    WSS-SGV-FVEN IN WSS-VARI GIVING
                                    PES-SGV-ENTE IN PES-VARI ROUNDED
                           MOVE PES-SGV-ENTE IN PES-VARI TO
                                RYD-VAL-IORD IN RYD-VARI
                           GO TO REV-CAL-INT-PAGA
                       ELSE 
                           GO TO REV-CAL-INT-PAGA
               ELSE 
                   GO TO FIN-CAL-INT-PAGA.

      * Calcula Monto Total Intereses Pagados para las Cancelaciones 'CAN'
      *    Calcula Intereses Normales y Mora Pagados WSS-VAL-INTE
           IF ( CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN ) AND
              DLC-KEY-IDLC IN DLC NOT = RCV-KEY-IDLC IN RCV
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC#RCV00*TT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY ' '
               DISPLAY '% WARNING...'
               DISPLAY MSG-GLS-DESC ' DLC : ' DLC-KEY-IDLC IN DLC
                       ' RCV(DLC) : ' RCV-KEY-IDLC IN RCV
                       ' CON CIC OPERACION : ' OPC-CIC-IOPC IN OPC
               GO TO FIN-CAL-INT-PAGA.

           IF MON-NACIONAL-REAJUSTABLE
               MULTIPLY RCV-SGV-CAPI IN RCV BY
                        WSS-SGV-FCAN IN WSS-VARI GIVING
                        PES-SGV-ENTE IN PES-VARI ROUNDED
           ELSE
               MOVE RCV-SGV-CAPI TO PES-SGV-ENTE IN PES-VARI.

           COMPUTE WSS-VAL-INTE IN WSS-VARI =
                           ( CAN-SGV-TPAG IN CAN +
                             CAN-SGV-TREN IN CAN ) -
                             PES-SGV-ENTE IN PES-VARI.

      *    Suma o Resta el Valor Diferencia del Valor Intereses
           SUBTRACT CAN-SGV-DIFE IN CAN FROM
                    WSS-VAL-INTE IN WSS-VARI GIVING
                    WSS-VAL-INTE IN WSS-VARI ROUNDED.

           GO TO FIN-CAL-INT-PAGA.

      * Revisa Calculo Intereses Respecto a DLC-VAL-INTD ( REVERSA-DEVENGOS )
       REV-CAL-INT-PAGA.
           IF REVERSA-DEVENGOS AND NOT CAL-INT-YA-REALIZADO
      *        Prende Switch CAL-INT-YA-REALIZADO
               MOVE 1 TO WSS-IND-CIYR IN WSS-VARI
               IF WSS-VAL-INTE IN WSS-VARI NOT <
                  WSS-VAL-INTD IN WSS-VARI
                   SUBTRACT WSS-VAL-INTD IN WSS-VARI FROM
                            WSS-VAL-INTE IN WSS-VARI GIVING
                            WSS-VAL-INTE IN WSS-VARI
                   IF RYD-VAL-IPCV IN RYD-VARI > 0
                       SUBTRACT WSS-VAL-INTD IN WSS-VARI FROM
                                RYD-VAL-IPCV IN RYD-VARI GIVING
                                RYD-VAL-IPCV IN RYD-VARI
                   ELSE
                       NEXT SENTENCE
               ELSE
                   MOVE WSS-VAL-INTE IN WSS-VARI TO
                        WSS-VAL-INTD IN WSS-VARI
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI
                   IF RYD-VAL-IPCV IN RYD-VARI > 0
                       MOVE WSS-VAL-INTD IN WSS-VARI TO
                            RYD-VAL-IPCV IN RYD-VARI.
       FIN-CAL-INT-PAGA.
           EXIT.
      **************************************************************************
      * Calcula Monto Reajustes Pagados
       CAL-REA-PAGA SECTION.
       INI-CAL-REA-PAGA.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% CAL-REA-PAGA'.
      *DAD  fin 24-ABR-1991 

      * No procesa si Operacion es Moneda Nacional Reajustable
           IF NOT MON-NACIONAL-REAJUSTABLE
               MOVE ZEROES TO WSS-VAL-REAJ IN WSS-VARI
                              RYD-VAL-RRIE IN RYD-VARI
                              RYD-VAL-RORD IN RYD-VARI
               GO TO FIN-CAL-REA-PAGA.

      * Calcula Monto Reajustes Pagados para Cancelaciones 'CAN'
           IF CPP-COD-MVTO IN CPP = 'CAN'
               IF PAGO-VEN-ESPECIFICO OR RPNV-VEN-ESPECIFICO
                   MOVE RCV-SGV-REAJ IN RCV TO WSS-VAL-REAJ IN WSS-VARI
                   GO TO FIN-CAL-REA-PAGA
               ELSE
                   IF DLC-VAL-DPES IN DLC > 0
                       DIVIDE DLC-VAL-DPES IN DLC BY
                              WSS-SGV-FCOL IN WSS-VARI GIVING
                              PES-SGV-DECI IN PES-VARI ROUNDED
                       SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                                WSS-SGV-FCAN IN WSS-VARI GIVING
                                WSS-VAL-REAJ IN WSS-VARI ROUNDED
                       MULTIPLY PES-SGV-DECI IN PES-VARI BY
                                WSS-VAL-REAJ IN WSS-VARI GIVING
                                PES-SGV-ENTE IN PES-VARI ROUNDED
                       MOVE PES-SGV-ENTE IN PES-VARI TO
                            WSS-VAL-REAJ IN WSS-VARI
                       GO TO FIN-CAL-REA-PAGA
                   ELSE
                       MOVE ZEROES TO WSS-VAL-REAJ IN WSS-VARI
                       GO TO FIN-CAL-REA-PAGA.

      * Calcula Monto Reajustes para los Traspasos 'CAS' o 'TCB' o 'TSC'
           IF CPP-COD-MVTO IN CPP = 'CAS' OR 'TCB' OR 'TSC'
               IF ( CPP-COD-MVTO IN CPP = 'TCB' AND NOT TCB-POR-VEN ) OR
                  CPP-COD-MVTO IN CPP = 'TSC'
                   DIVIDE DLC-VAL-DPES IN DLC BY
                          WSS-SGV-FCOL IN WSS-VARI GIVING
                          PES-SGV-DECI IN PES-VARI ROUNDED
                   SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                            WSS-SGV-FCBR IN WSS-VARI GIVING
                            WSS-VAL-REAJ IN WSS-VARI ROUNDED
                   MULTIPLY PES-SGV-DECI IN PES-VARI BY
                            WSS-VAL-REAJ IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-REAJ IN WSS-VARI
                   GO TO FIN-CAL-REA-PAGA
               ELSE
                   SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                            WSS-SGV-FVEN IN WSS-VARI GIVING
                            WSS-VAL-REAJ IN WSS-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            WSS-VAL-REAJ IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-REAJ IN WSS-VARI
                   GO TO FIN-CAL-REA-PAGA.

      * Calcula Monto Intereses Traspasados para los Traspasos 'TCT'
           IF CPP-COD-MVTO IN CPP = 'TCT' AND NOT CAL-REA-YA-REALIZADO
      *        Obtiene Reajustes : Normales, Riesgosos y Orden
               PERFORM OBT-VAL-RNRO.

      * Revisa Calculo Reajustes Respecto a DLC-VAL-READ ( REVERSA-DEVENGOS )
       REV-CAL-REA-PAGA.
           IF REVERSA-DEVENGOS AND NOT CAL-REA-YA-REALIZADO
      *        Prende Switch CAL-REA-YA-REALIZADO
               MOVE 1 TO WSS-IND-CRYR IN WSS-VARI
               IF WSS-VAL-REAJ IN WSS-VARI NOT <
                  WSS-VAL-READ IN WSS-VARI
                   SUBTRACT WSS-VAL-READ IN WSS-VARI FROM
                            WSS-VAL-REAJ IN WSS-VARI GIVING
                            WSS-VAL-REAJ IN WSS-VARI
               ELSE
                   MOVE WSS-VAL-REAJ IN WSS-VARI TO
                        WSS-VAL-READ IN WSS-VARI
                   MOVE ZEROES TO WSS-VAL-REAJ IN WSS-VARI.
       FIN-CAL-REA-PAGA.
           EXIT.
      **************************************************************************
      * Formacion y Generacion del Registro SRT al Procesar Varios Registros
       GEN-REG-SRT SECTION.
       INI-GEN-REG-SRT.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% GEN-REG-SRT'.
      *DAD  fin 24-ABR-1991 

           IF WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP) < ZEROS
               DISPLAY ' '
               DISPLAY '% ERROR ...MONTO NEGATIVO ASIENTO CONTABLE'
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'ASIENTO CONTABLE NRO.   : '
                       WSS-NUM-ICPP IN WSS-VARI
               DISPLAY 'TIPO DE CUENTA CONTABLE : '
                       WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP)
               DISPLAY 'TIPO DE ALGORITMO       : '
                       WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPP)
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               ADD   1  TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-GEN-REG-SRT.

           IF WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP) = ZEROS
               GO TO FIN-GEN-REG-SRT.

           MOVE WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP) TO
                DCC-MSC-TCCT IN DCC.

      * Reversas para Traspaso Situacion Contable
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS'
               IF REVERSA-DEBE-HABER
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCT-IND-SCTA IN CCT TO DCC-IND-SCTB IN DCC
                   ELSE
                       MOVE CCT-IND-SCTB IN CCT TO DCC-IND-SCTB IN DCC
               ELSE
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCT-IND-SCTB IN CCT TO DCC-IND-SCTB IN DCC
                   ELSE
                       MOVE CCT-IND-SCTA IN CCT TO DCC-IND-SCTB IN DCC.

      * Reversas para Traspaso Situacion Cobranza
           IF CPP-COD-MVTO IN CPP = 'TCB'
               IF REVERSA-DEBE-HABER AND
                  NOT ( NUEVA-JUDICIAL AND ANTIGUA-VENDIDO )
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCB-IND-SCBA IN CCB TO DCC-IND-SCBZ IN DCC
                   ELSE
                       MOVE CCB-IND-SCBZ IN CCB TO DCC-IND-SCBZ IN DCC
               ELSE
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCB-IND-SCBZ IN CCB TO DCC-IND-SCBZ IN DCC
                   ELSE
                       MOVE CCB-IND-SCBA IN CCB TO DCC-IND-SCBZ IN DCC.

      * Reversas para Traspaso Situacion Cartera
           IF CPP-COD-MVTO IN CPP = 'TSC'
               IF REVERSA-DEBE-HABER
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCR-IND-SCRA IN CCR TO DCC-IND-SCRT IN DCC
                   ELSE
                       MOVE CCR-IND-SCRT IN CCR TO DCC-IND-SCRT IN DCC
               ELSE
                   IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'D'
                       MOVE CCR-IND-SCRT IN CCR TO DCC-IND-SCRT IN DCC
                   ELSE
                       MOVE CCR-IND-SCRA IN CCR TO DCC-IND-SCRT IN DCC.

      * Obtiene Cuenta Contable al Leer DCC por Llave COD-CCTB Formada
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF NOT ( FIO-STAT-OKS AND
                    DCC-IND-VIGE IN DCC = 'S' )
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'DCC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY ' '
               DISPLAY '% ERROR ...' MSG-GLS-DESC ' : '
                       DCC-COD-TABL IN DCC
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'ASIENTO CONTABLE NRO.   : '
                       WSS-NUM-ICPP IN WSS-VARI
               DISPLAY 'TIPO DE CUENTA CONTABLE : '
                       WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPP)
               DISPLAY 'TIPO DE ALGORITMO       : '
                       WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPP)
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               ADD   1  TO WSS-IND-RBAD IN WSS-VARI
               GO TO FIN-GEN-REG-SRT.

      * Mueve Codigo Cuenta Contable al Registro SRT
           MOVE DCC-GLS-CCSB IN DCC TO SRT-CIC-CCSB IN SRT.

      * Invierte las Contabilizaciones para las Reversas
           IF REVERSA-DEBE-HABER OR
              ( CPP-COD-MVTO IN CPP = 'CAN' AND
                ( CAN-SGV-TPAG IN CAN < 0 OR CAN-SGV-TREN IN CAN < 0 ) )
               IF WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) = 'H'
                   MOVE 'D' TO SRT-IND-DBHB IN SRT
               ELSE
                   MOVE 'H' TO SRT-IND-DBHB IN SRT
           ELSE
               MOVE WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPP) TO
                    SRT-IND-DBHB IN SRT.

      * Mueve Monto al Debe o Haber, Segun Corresponda
           IF SRT-IND-DBHB IN SRT = 'D'
               MOVE WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP) TO
                    SRT-VAL-DEBE IN SRT
               MOVE ZEROES TO SRT-VAL-HABE IN SRT
           ELSE
           IF SRT-IND-DBHB IN SRT = 'H'
               MOVE WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPP) TO
                    SRT-VAL-HABE IN SRT
               MOVE ZEROES TO SRT-VAL-DEBE IN SRT.

      * Mueve Numero de Vencimiento al Registro SRT
           IF CPP-COD-MVTO IN CPP = 'CUR' OR 'TSC'
               MOVE ZEROES              TO SRT-NUM-IVCT IN SRT
           ELSE
           IF CPP-COD-MVTO IN CPP = 'CAN'
               IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
                   MOVE 999 TO SRT-NUM-IVCT IN SRT
               ELSE
                   MOVE RCV-NUM-IVCT IN RCV TO SRT-NUM-IVCT IN SRT
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS'
               MOVE CCT-NUM-IVCT IN CCT TO SRT-NUM-IVCT IN SRT
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCB'
               IF TCB-POR-VEN
                   MOVE CCB-NUM-IVCT IN CCB TO SRT-NUM-IVCT IN SRT
               ELSE
                   MOVE ZEROES              TO SRT-NUM-IVCT IN SRT.

      * Completa Llenado de Campos y Genera el Registro SRT
           COPY COLRMLMC.

      * Para todos los Impuestos en Moneda Nacional la moneda debe ser Pesos
           IF WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPP) = 'B' AND
              MON-NACIONAL-REAJUSTABLE
               MOVE WSS-COD-PESO IN WSS-VARI TO OPC-COD-VCOC IN SRT.

           RELEASE SRT.
           PERFORM BUS-REG-MCT.
       FIN-GEN-REG-SRT.
           EXIT.
      **************************************************************************
      * Formacion y Generacion del Registro MCT al Procesar Varios Registros
       BUS-REG-MCT SECTION.
       INI-BUS-REG-MCT.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-REG-MCT'.
      *DAD  fin 24-ABR-1991 

      * Formacion del Registro MCT
      *DAD  ini 15-JUL-1991 
           MOVE DCC-GLS-CCSB IN DCC TO MCT-COD-ICTA IN MCT.

      * Mediante BUS-TAB Busca Cuenta Contable de Tabla PCC
           IF DCC-GLS-CCSB IN DCC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PCC'               TO TAB-COD-TTAB IN TAB
               MOVE DCC-GLS-CCSB IN DCC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DATA IN TAB      TO WSS-GLS-DATA IN WSS-VARI
               MOVE WSS-GLS-DVRF IN WSS-VARI TO MCT-VRF-ICTA IN MCT
           ELSE
               MOVE SPACES TO MCT-VRF-ICTA IN MCT.

           MOVE 'COL'                    TO MCT-COD-SIST IN MCT.
           MOVE SRT-FEC-FMOV IN SRT      TO WSS-FEC-FREG IN WSS-VARI.
           MOVE WSS-NUM-DREG IN WSS-VARI TO MCT-NUM-DMOV IN MCT.
           MOVE WSS-NUM-MREG IN WSS-VARI TO MCT-NUM-MMOV IN MCT.
           MOVE WSS-NUM-AREG IN WSS-VARI TO MCT-NUM-AMOV IN MCT.
      *DAD  fin 15-JUL-1991 
           MOVE '00'                TO MCT-COD-MONE IN MCT.
           MOVE SPACES              TO MCT-GLS-FILL IN MCT
                                       MCT-GLS-IDOC IN MCT
                                       MCT-GLS-MOVI IN MCT
                                       MCT-GLS-DISP IN MCT.

           IF SRT-IND-DBHB IN SRT = 'D'
               MOVE  1  TO MCT-IND-TDOC IN MCT
           ELSE
           IF SRT-IND-DBHB IN SRT = 'H'
               MOVE  2  TO MCT-IND-TDOC IN MCT.

           IF CPP-COD-MVTO IN CPP = 'CUR' OR
              ( CPP-COD-MVTO IN CPP = 'TCB' AND NOT TCB-POR-VEN ) OR
              CPP-COD-MVTO IN CPP = 'TSC'
               MOVE OPC-COD-OFOC IN OPC TO MCT-COD-OFIC IN MCT
               MOVE DLC-VAL-DPES IN DLC TO MCT-VAL-MOVI IN MCT
           ELSE
           IF CPP-COD-MVTO IN CPP = 'CAN'
               MOVE CAN-COD-OFCA IN CAN TO MCT-COD-OFIC IN MCT
               IF CANC-TOTAL-TODOS-VEN OR CANC-PARCIAL-TODOS-VEN
                   MOVE DLC-VAL-DPES IN DLC TO MCT-VAL-MOVI IN MCT
               ELSE
                   IF MON-NACIONAL-REAJUSTABLE
                       MULTIPLY RCV-SGV-CAPI IN RCV BY
                                WSS-SGV-FCOL IN WSS-VARI GIVING
                                PES-SGV-ENTE IN PES-VARI ROUNDED
                       MOVE PES-SGV-ENTE IN PES-VARI TO
                            MCT-VAL-MOVI IN MCT
                   ELSE
                       MOVE RCV-SGV-CAPI IN RCV TO MCT-VAL-MOVI IN MCT
           ELSE
           IF CPP-COD-MVTO IN CPP = 'TCT' OR 'CAS' OR
              ( CPP-COD-MVTO IN CPP = 'TCB' AND TCB-POR-VEN )
               MOVE OPC-COD-OFOC IN OPC TO MCT-COD-OFIC IN MCT
               IF MON-NACIONAL-REAJUSTABLE
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            WSS-SGV-FCOL IN WSS-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        MCT-VAL-MOVI IN MCT
               ELSE
                   MOVE VEN-VAL-SCAP IN VEN TO MCT-VAL-MOVI IN MCT.

      * Genera el Registro del Archivo MCT.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-MCT.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'MCT    NOPUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY 'REGISTRO MCT : ' MCT
               ADD 1 TO WSS-IND-RERR IN WSS-VARI
           ELSE
               ADD 1 TO WSS-IND-ROKS IN WSS-VARI.
       FIN-BUS-REG-MCT.
           EXIT.
      **************************************************************************
      * Busca Datos Cliente por Medio del CIC de Operaciones en Registro RDC
       BUS-REG-CLI SECTION.
       INI-BUS-REG-CLI.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-REG-CLI'.
      *DAD  fin 24-ABR-1991 

      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * RDC-NUM-IDLC = 0 ====> DEU.DIR.
           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   RDC-KEY-IDLC IN RDC.
      *        GO TO FIN-BUS-REG-CLI.

      *CIC-CLI Busca Datos del Cliente Mediante su CIC
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO DBC-NUM-ICLI IN DBC
                              DBC-VRF-ICLI IN DBC
                              DBC-IND-ICLI IN DBC
                              WSS-GLS-AUXI IN WSS-LMC
                              DBC-GLS-ICLI IN DBC
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
               IF DBC-GLS-ICLI IN DBC > SPACES
                   MOVE '-'    TO WSS-GLS-AUXI IN WSS-LMC
               ELSE
                   MOVE SPACES TO WSS-GLS-AUXI IN WSS-LMC.
       FIN-BUS-REG-CLI.
           EXIT.
      **************************************************************************
       BUS-MSC-SCTB SECTION.
       INI-BUS-MSC-SCTB.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-MSC-SCTB'.
      *DAD  fin 24-ABR-1991 

      * Busca Codigo Interno Computacional de Codigo Miscelaneo 'SCTB'
      * en Tabla MSC
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE 'COL'               TO MSC-COD-SIST.
           MOVE 'SCTB'              TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY ' '
               DISPLAY '% ERROR....' MSG-GLS-DESC IN MSG
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'COD. SCTB : ' MSC-COD-CMSC IN MSC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-MSC-SCTB.
       FIN-BUS-MSC-SCTB.
           EXIT.
      **************************************************************************
       BUS-MSC-SCBZ SECTION.
       INI-BUS-MSC-SCBZ.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-MSC-SCBZ'.
      *DAD  fin 24-ABR-1991 

      * Busca Codigo Interno Computacional de Codigo Miscelaneo 'SCBZ'
      * en Tabla MSC
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE 'COL'               TO MSC-COD-SIST.
           MOVE 'SCBZ'              TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY ' '
               DISPLAY '% ERROR....' MSG-GLS-DESC IN MSG
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'COD. SCBZ : ' MSC-COD-CMSC IN MSC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-MSC-SCBZ.
       FIN-BUS-MSC-SCBZ.
           EXIT.
      **************************************************************************
       BUS-MSC-SCRT SECTION.
       INI-BUS-MSC-SCRT.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-MSC-SCRT'.
      *DAD  fin 24-ABR-1991 

      * Busca Codigo Interno Computacional de Codigo Miscelaneo 'SCRT'
      * en Tabla MSC
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE 'COL'               TO MSC-COD-SIST.
           MOVE 'SCRT'              TO MSC-COD-TMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY ' '
               DISPLAY '% ERROR....' MSG-GLS-DESC IN MSG
               DISPLAY 'OPERACION : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'COD. SCRT : ' MSC-COD-CMSC IN MSC
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-MSC-SCRT.
       FIN-BUS-MSC-SCRT.
           EXIT.
      **************************************************************************
       BUS-COD-HYC SECTION.
       INI-BUS-COD-HYC.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-COD-HYC'.
      *DAD  fin 24-ABR-1991 

      * Busca TOC para ver si es Hipotecario y CON-VEC-TOOC para Consumo
           MOVE 0 TO WSS-IND-ERRO IN WSS-VARI.
      * Mediante el Registro TOC Tipo Operaciones Creditos Obtiene 'Como Opera'
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'TOC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY ' '
               DISPLAY '% ERROR.....' MSG-GLS-DESC
               DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'Tipo de Operacion : ' TOC-COD-TABL
               MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-COD-HYC.

           MOVE TOC-MSC-OPEC IN TOC TO CON-MSC-OPEC IN CON-VARI.
           IF HIPOTECARIO
               GO TO FIN-BUS-COD-HYC.

      * Obtiene Indicador de Clasificacion mediante Codigo del Credito Consumo
           SET CON-IND-SI01 TO 1.
           SEARCH CON-VEC-TOOC VARYING CON-IND-SI01
                  WHEN CON-COD-COOC IN CON-VARI(CON-IND-SI01) =
                       OPC-COD-COOC IN OPC
                  MOVE 'C' TO CON-MSC-OPEC IN CON-VARI.
       FIN-BUS-COD-HYC.
           EXIT.
      **************************************************************************
       PUT-CON-VARI SECTION.
       INI-PUT-CON-VARI.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% PUT-CON-VARI'.
      *DAD  fin 24-ABR-1991 

      * Lleva la Tabla de Codigos Auxiliares de Consumo
      * Obtiene Codigo Clase de Oper. Mediante CIC de Cred. Consumo Institucion
           MOVE SPACES TO CON-VARI.
           MOVE ZEROES TO CON-IND-SI02 IN CON-VARI.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'AUX'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'CON'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-CIC-TABL NOT = 'AUXCON'
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CICCON    NL' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY ' '
               DISPLAY '% WARNING....' MSG-GLS-DESC
               GO TO INI-PUT-DIS.
       LUP-PUT-CON.
           ADD  1  TO CON-IND-SI02 IN CON-VARI.
           MOVE TAB-COD-CTAB IN TAB TO
                CON-COD-COOC IN CON-VARI(CON-IND-SI02).
           IF CON-IND-SI02 IN CON-VARI > 40
               DISPLAY ' '
               DISPLAY 'VECTOR CLASE OPERACIONES INS QUEDO CHICO'
               PERFORM GNS-PRO-END.
       NXT-PUT-CON.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-CIC-TABL NOT = 'AUXCON'
               GO TO INI-PUT-DIS.
           GO TO LUP-PUT-CON.

       INI-PUT-DIS.
      * Obtiene Codigo Clase de Oper. Mediante CIC de Cred. Consumo Distribuidor
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'AUX'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'DIS'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-CIC-TABL NOT = 'AUXDIS'
      *DAD  ini 07-ABR-1992   (Memo.04-03-92 Pto.2)
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'CICDIS    NL' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY ' '
      *         DISPLAY '% WARNING....' MSG-GLS-DESC
      *DAD  fin 07-ABR-1992
               GO TO FIN-PUT-CON-VARI.
       LUP-PUT-DIS.
           ADD  1  TO CON-IND-SI02 IN CON-VARI.
           MOVE TAB-COD-CTAB IN TAB TO
                CON-COD-COOC IN CON-VARI(CON-IND-SI02).
           IF CON-IND-SI02 IN CON-VARI > 40
               DISPLAY ' '
               DISPLAY 'VECTOR CLASE OPERACIONES DIS QUEDO CHICO'
               PERFORM GNS-PRO-END.
       NXT-PUT-DIS.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-CIC-TABL NOT = 'AUXDIS'
               GO TO FIN-PUT-CON-VARI.
           GO TO LUP-PUT-DIS.
       FIN-PUT-CON-VARI.
           EXIT.
      **************************************************************************
      * Busca Fecha Corte Devengo de Intereses y Reajustes
       BUS-FEC-FCDV SECTION.
       INI-BUS-FEC-FCDV.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-FEC-FCDV'.
      *DAD  fin 24-ABR-1991 

      * Si la Operacion esta Clasificada como Riesgosa FCDV = FCOL
           IF DLC-IND-RIES IN DLC NOT = SPACES
               MOVE OPC-FEC-FCOL IN OPC TO RYD-FEC-FCDV IN RYD-VARI
               GO TO FIN-BUS-FEC-FCDV.

      * Inicializa la Fecha en 999999999 y queda asi si no es Riesgoso
           MOVE '99999999' TO RYD-FEC-FCDV IN RYD-VARI.

      * Obtiene Clasificacion de Riesgo de Deudores Directos de la Operacion
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           PERFORM BUS-RDC-DBC.
           IF ERROR-EN-PROCESO
               GO TO FIN-BUS-FEC-FCDV.
       FIN-BUS-FEC-FCDV.
           EXIT.
      **************************************************************************
      * Busca CIC del Cliente con el CIC de Operaciones de Creditos en RDC
      * y Luego la Clasificacion del Cliente siempre que este sea Deudor Directo
       BUS-RDC-DBC SECTION.
       INI-BUS-RDC-DBC.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-RDC-DBC'.
      *DAD  fin 24-ABR-1991 

           MOVE 0 TO WSS-IND-ERRO IN WSS-VARI.
           MOVE 99999999 TO RYD-FEC-FCDV IN RYD-VARI.
      * Busca Primer Deudor de RDC
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NLSNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY ' '
               DISPLAY '% ERROR.....' MSG-GLS-DESC
               DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'Clave RDC    : ' RDC-KEY-IDLC IN RDC
               MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-BUS-RDC-DBC
           ELSE
               IF RDC-CIC-IOPC IN RDC NOT = OPC-CIC-IOPC IN OPC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'RDC    NLSNX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY ' '
                   DISPLAY '% ERROR.....RDC-CIC-IOPC # OPC-CIC-IOPC'
                   DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
                   DISPLAY 'RDC  OPE     : ' RDC-CIC-IOPC IN RDC
                   MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
                   GO TO FIN-BUS-RDC-DBC.
       LUP-RDC-DBC.
      * Busca Clasificacion de Riesgo Comercial del Cliente si es Deudor Directo
           IF RDC-NUM-IDLC IN RDC = 0
               PERFORM BUS-DBC-CRI
               IF ERROR-EN-PROCESO
                   GO TO FIN-BUS-RDC-DBC.
       NXT-RDC-DBC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS OR
              RDC-CIC-IOPC IN RDC NOT = OPC-CIC-IOPC IN OPC
               GO TO FIN-BUS-RDC-DBC
           ELSE
               GO TO LUP-RDC-DBC.
       FIN-BUS-RDC-DBC.
           EXIT.
      **************************************************************************
      * Busca Clasificacion de Riesgo Comercial del Cliente
       BUS-DBC-CRI SECTION.
       INI-BUS-DBC-CRI.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% BUS-DBC-CRI'.
      *DAD  fin 24-ABR-1991 

           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE RDC-CIC-ICLI IN RDC TO CRI-CIC-ICLI IN CRI.
           MOVE 'C'                 TO CRI-IND-TCAR IN CRI.
           MOVE '99999999'          TO CRI-FEC-FCLA IN CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF NOT FIO-STAT-OKS OR
              CRI-CIC-ICLI IN CRI NOT = RDC-CIC-ICLI IN RDC
               GO TO FIN-BUS-DBC-CRI
           ELSE
               IF CRI-IND-CRSS IN CRI = 'C'
                   PERFORM ACT-FEC-FCLA
                   IF ERROR-EN-PROCESO
                       GO TO FIN-BUS-DBC-CRI
                   ELSE
                       MOVE 1 TO RYD-IND-RIES IN RYD-VARI
                       MOVE FEC-ITM1 IN FEC-FECH TO
                            RYD-NUM-DCLA IN RYD-VARI
                       MOVE FEC-ITM2 IN FEC-FECH TO
                            RYD-NUM-MCLA IN RYD-VARI
                       MOVE FEC-ITM3 IN FEC-FECH TO
                            RYD-NUM-SCLA IN RYD-VARI
                       MOVE FEC-ITM4 IN FEC-FECH TO
                            RYD-NUM-ACLA IN RYD-VARI
                       IF RYD-FEC-FCLA IN RYD-VARI <
                          RYD-FEC-FCDV IN RYD-VARI
                           MOVE RYD-FEC-FCLA IN RYD-VARI TO
                                RYD-FEC-FCDV IN RYD-VARI
                       ELSE
                           NEXT SENTENCE
               ELSE
                   IF CRI-IND-CRSS IN CRI = 'D'
                       MOVE 2 TO RYD-IND-RIES IN RYD-VARI
                       MOVE CRI-NUM-DCLA IN CRI TO
                            RYD-NUM-DCLA IN RYD-VARI
                       MOVE CRI-NUM-MCLA IN CRI TO
                            RYD-NUM-MCLA IN RYD-VARI
                       MOVE CRI-NUM-SCLA IN CRI TO
                            RYD-NUM-SCLA IN RYD-VARI
                       MOVE CRI-NUM-ACLA IN CRI TO
                            RYD-NUM-ACLA IN RYD-VARI
                       IF CRI-FEC-FCLA IN CRI < RYD-FEC-FCDV IN RYD-VARI
                           MOVE CRI-FEC-FCLA IN CRI TO
                                RYD-FEC-FCDV IN RYD-VARI.
       FIN-BUS-DBC-CRI.
           EXIT.
      **************************************************************************
      * Suma Un Ano a Fecha de Clasificacion de Riesgo
       ACT-FEC-FCLA SECTION.
       INI-ACT-FEC-FCLA.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% ACT-FEC-FCLA'.
      *DAD  fin 24-ABR-1991 

           MOVE CRI-NUM-DCLA IN CRI      TO FEC-ITM1 IN FEC-FECH.
           MOVE CRI-NUM-MCLA IN CRI      TO FEC-ITM2 IN FEC-FECH.
           MOVE CRI-NUM-SCLA IN CRI      TO FEC-ITM3 IN FEC-FECH.
           MOVE CRI-NUM-ACLA IN CRI      TO FEC-ITM4 IN FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-ANO  TO FEC-CMND.
           MOVE 1 TO FEC-NANO.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY ' '
               DISPLAY '% ERROR.....' FEC-MENS
               DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'Fecha CRI    : ' CRI-FEC-FCLA IN CRI
               DISPLAY 'Fecha FEC    : ' FEC-FECH
               MOVE 1 TO WSS-IND-ERRO IN WSS-VARI.
       FIN-ACT-FEC-FCLA.
           EXIT.
      **************************************************************************
      * Procesa Saldo del Credito Hasta Obtener el Saldo a la Fecha
      * del Vencimiento Anterior al Asociado al Registro CCT en Proceso
       PRO-VAL-SCRE SECTION.
       INI-PRO-VAL-SCRE.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% PRO-VAL-SCRE'.
      *DAD  fin 24-ABR-1991 

           MOVE OPC-VAL-SCRE IN OPC TO RYD-VAL-SCRE IN RYD-VARI.
           IF DLC-FEC-FDEV IN DLC NOT < VEN-FEC-FVEN IN VEN
               MOVE VEN-FEC-FVEN IN VEN TO RYD-FEC-FVAN IN RYD-VARI
           ELSE
               MOVE DLC-FEC-FDEV IN DLC TO RYD-FEC-FVAN IN RYD-VARI.
           MOVE SPACES TO RYD-FEC-FCIN IN RYD-VARI.
           MOVE 0 TO RYD-IND-PVSI IN RYD-VARI RYD-IND-VCPV IN RYD-VARI.
           MOVE 1 TO RYD-IND-PVCV IN RYD-VARI.

      * Busca CIC de Situacion Contable del Vencimiento
           MOVE VEN-IND-SCTB IN VEN TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCTB.
           IF ERROR-EN-PROCESO
               GO TO FIN-PRO-VAL-SCRE.

      * Si Vencimiento esta en Cartera Vencida
           IF MSC-CIC-CMSC IN MSC = 'VCD'
      *        Apaga Switch PRIMER-VEN-EN-CV
               MOVE 0 TO RYD-IND-PVCV IN RYD-VARI
      *        Si Vencimiento es el Mismo de la CCT
               IF VEN-NUM-IVEN IN VEN = CCT-NUM-IVCT IN CCT
      *            Prende Switch VEN-CCT-PRIMER-EN-CV
                   MOVE 1 TO RYD-IND-VCPV IN RYD-VARI
      *            Si Vencimiento es Solo Interes
                   IF VEN-VAL-CAPI IN VEN = 0
      *                Prende Switch PRIMER-VEN-CV-SOLO-INT
                       MOVE 1 TO RYD-IND-PVSI IN RYD-VARI
                   ELSE
                       NEXT SENTENCE
               ELSE
      *            Si Vencimiento es Solo Interes
                   IF VEN-VAL-CAPI IN VEN = 0
      *                Prende Switch PRIMER-VEN-CV-SOLO-INT
                       MOVE 1 TO RYD-IND-PVSI IN RYD-VARI.
       LUP-PRO-VAL-SCRE.
           IF VEN-NUM-IVEN IN VEN = CCT-NUM-IVCT IN CCT
               GO TO FIN-PRO-VAL-SCRE.

      * Obtiene Saldo y FVAN ( fecha ven ant ) del Ven anterior al de la CCT
           SUBTRACT VEN-VAL-CAPI IN VEN FROM RYD-VAL-SCRE IN RYD-VARI.
           MOVE VEN-FEC-FVEN IN VEN TO RYD-FEC-FVAN IN RYD-VARI.

           IF MSC-CIC-CMSC IN MSC NOT = 'VCD'
               GO TO NXT-PRO-VAL-SCRE.

           IF RYD-FEC-FCIN IN RYD-VARI NOT > SPACES
               MOVE VEN-FEC-FVEN IN VEN TO RYD-FEC-FCIN IN RYD-VARI.

           IF RYD-FEC-FCDV IN RYD-VARI NOT > SPACES OR
              ( RYD-FEC-FCDV IN RYD-VARI > SPACES  AND
                RYD-FEC-FCIN IN RYD-VARI < RYD-FEC-FCDV IN RYD-VARI )
               MOVE RYD-FEC-FCIN IN RYD-VARI TO
                    RYD-FEC-FCDV IN RYD-VARI.
       NXT-PRO-VAL-SCRE.
      * Busca Proximo Vencimiento Asociado a Registro CCT
      *     Prende Switch Busca Vencimiento BD con 2 (LEE-PROXIMO-VEN)
            MOVE 2 TO WSS-IND-BVBD IN WSS-VARI.
            PERFORM LEE-VEN.
            IF ERROR-EN-PROCESO
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'CCT    PVENX' TO MSG-COD-MENS
                PERFORM GET-MSG
                DISPLAY '% ERROR...NO ENCONTRE VEN = CCT ' MSG-GLS-DESC
                DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
                DISPLAY 'FIO-STAT     : ' FIO-STAT
                GO TO FIN-PRO-VAL-SCRE.

      * Busca CIC de Situacion Contable del Vencimiento
           MOVE VEN-IND-SCTB IN VEN TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC-SCTB.
           IF ERROR-EN-PROCESO
               GO TO FIN-PRO-VAL-SCRE.

      * Prende Switch PRIMER-VEN-CV-SOLO-INT si VCD y CAPI = 0
           IF MSC-CIC-CMSC IN MSC = 'VCD' AND PRIMER-VEN-EN-CV
               MOVE 0 TO RYD-IND-PVCV IN RYD-VARI
               IF VEN-VAL-CAPI IN VEN = 0
                   MOVE 1 TO RYD-IND-PVSI IN RYD-VARI.

            GO TO LUP-PRO-VAL-SCRE.
       FIN-PRO-VAL-SCRE.
           EXIT.
      **************************************************************************
      * Obtiene Intereses Normales, Por Cobrar Vencidos, Riesgo y Orden
       OBT-VAL-INRO SECTION.
       INI-OBT-VAL-INRO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% OBT-VAL-INRO'.
      *DAD  fin 24-ABR-1991 

           MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI
                          RYD-VAL-IPCV IN RYD-VARI
                          RYD-VAL-IRIE IN RYD-VARI
                          RYD-VAL-IORD IN RYD-VARI.

      * Caso A, Fecha Corte Devengo mayor o igual a Fecha de Vencimiento
      * Interes de la Cuota => Interes x Cobrar Vcd o Intereses Normales
           IF RYD-FEC-FCDV IN RYD-VARI NOT < VEN-FEC-FVEN IN VEN
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        PES-SGV-DECI IN PES-VARI ROUNDED
               MOVE PES-SGV-DECI IN PES-VARI TO
                    WSS-VAL-INTE IN WSS-VARI
               IF PRIMER-VEN-CV-SOLO-INT AND VEN-CCT-PRIMER-EN-CV
                   MOVE PES-SGV-DECI IN PES-VARI TO
                        RYD-VAL-IPCV IN RYD-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
      * Caso B, Fecha Corte Devengo menor o igual a Fecha Ven Anterior o
      *         Fecha Corte Devengo mayor         a Fecha Ven Ant y
      *                             menor o igual a Fecha Devengo
      * Interes de la Cuota => Intereses Riesgo o Intereses Orden
           IF RYD-FEC-FCDV IN RYD-VARI NOT > RYD-FEC-FVAN IN RYD-VARI OR
              ( RYD-FEC-FCDV IN RYD-VARI > RYD-FEC-FVAN IN RYD-VARI AND
                DLC-FEC-FDEV IN DLC NOT < RYD-FEC-FCDV IN RYD-VARI )
               SUBTRACT VEN-VAL-SCAP IN VEN FROM
                        VEN-VAL-SFIN IN VEN GIVING
                        PES-SGV-DECI IN PES-VARI ROUNDED
               IF RIESGOSO
                   MOVE PES-SGV-DECI IN PES-VARI TO
                        RYD-VAL-IRIE IN RYD-VARI
               ELSE
                   MOVE PES-SGV-DECI IN PES-VARI TO
                        RYD-VAL-IORD IN RYD-VARI
           ELSE
      * Caso C, Fecha Corte Devengo entre Fecha Ven Ant y Fecha Vencimiento
      *         Fecha Devengo menor Fecha Corte Devengo
               PERFORM MOV-FEC-FEC1
      *    C2a, Fecha Devengo menor Fecha Vencimiento Anterior
      * Interes de la Cuota => 1. Interes x Cobrar Vcd o Intereses Normales
      *                           Entre Fecha Ven Ant y Fecha Corte Devengo
      *                        2. Intereses Riesgo o Intereses Orden
      *                           Entre Fecha Corte Devengo y Fecha Vencimiento
      *    C2b, Fecha Devengo mayor Fecha Vencimiento Anterior
      * Interes de la Cuota => 1. Interes x Cobrar Vcd o Intereses Normales
      *                           Entre Fecha Devengo y Fecha Corte Devengo
      *                        2. Intereses Riesgo o Intereses Orden
      *                           Entre Fecha Corte Devengo y Fecha Vencimiento
               MOVE RYD-NUM-DCDV IN RYD-VARI TO FEC-DEC2 IN FEC-VARI
               MOVE RYD-NUM-MCDV IN RYD-VARI TO FEC-MEC2 IN FEC-VARI
               MOVE RYD-NUM-SCDV IN RYD-VARI TO FEC-SEC2 IN FEC-VARI
               MOVE RYD-NUM-ACDV IN RYD-VARI TO FEC-AEC2 IN FEC-VARI
               PERFORM DET-INT-FEC1-FEC2
               IF ERROR-EN-PROCESO
                   GO TO FIN-OBT-VAL-INRO
               ELSE
                   PERFORM MOV-VAL-IPER
                   MOVE RYD-NUM-DCDV IN RYD-VARI TO FEC-DEC1 IN FEC-VARI
                   MOVE RYD-NUM-MCDV IN RYD-VARI TO FEC-MEC1 IN FEC-VARI
                   MOVE RYD-NUM-SCDV IN RYD-VARI TO FEC-SEC1 IN FEC-VARI
                   MOVE RYD-NUM-ACDV IN RYD-VARI TO FEC-AEC1 IN FEC-VARI
                   MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2 IN FEC-VARI
                   MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2 IN FEC-VARI
                   MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2 IN FEC-VARI
                   MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2 IN FEC-VARI
                   PERFORM DET-INT-FEC1-FEC2
                   IF ERROR-EN-PROCESO
                       GO TO FIN-OBT-VAL-INRO
                   ELSE
                       IF RIESGOSO
                           MOVE RYD-VAL-IPER IN RYD-VARI TO
                                RYD-VAL-IRIE IN RYD-VARI
                       ELSE
                           MOVE RYD-VAL-IPER IN RYD-VARI TO
                                RYD-VAL-IORD IN RYD-VARI.
       FIN-OBT-VAL-INRO.
           EXIT.
      **************************************************************************
      * Obtiene Reajustes Normales, Riesgo y Orden
       OBT-VAL-RNRO SECTION.
       INI-OBT-VAL-RNRO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% OBT-VAL-RNRO'.
      *DAD  fin 24-ABR-1991 

           MOVE ZEROES TO WSS-VAL-REAJ IN WSS-VARI
                          RYD-VAL-RRIE IN RYD-VARI
                          RYD-VAL-RORD IN RYD-VARI.

      * Caso A, Fecha Corte Devengo mayor o igual a Fecha de Vencimiento
      * Reajustes de la Cuota => Reajustes Normales
           IF RYD-FEC-FCDV IN RYD-VARI NOT < VEN-FEC-FVEN IN VEN
               SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                        WSS-SGV-FVEN IN WSS-VARI GIVING
                        WSS-VAL-REAJ IN WSS-VARI ROUNDED
               MULTIPLY VEN-VAL-SCAP IN VEN BY
                        WSS-VAL-REAJ IN WSS-VARI GIVING
                        PES-SGV-ENTE IN PES-VARI ROUNDED
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    WSS-VAL-REAJ IN WSS-VARI
           ELSE
      * Caso B, Fecha Corte Devengo menor o igual a Fecha Vencimiento
      *    Ba, No Riesgoso
           IF NOT RIESGOSO
      * Reajustes de la Cuota => Normales Fecha Col a Fecha Corte Devengo
      *                          Orden    Fecha Corte Devengo a Fecha Ven
               SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                        RYD-SGV-FCDV IN RYD-VARI GIVING
                        PES-SGV-DECI IN PES-VARI ROUNDED
               MULTIPLY VEN-VAL-SCAP IN VEN BY
                        PES-SGV-DECI IN PES-VARI GIVING
                        PES-SGV-ENTE IN PES-VARI ROUNDED
               MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-REAJ IN WSS-VARI

               SUBTRACT RYD-SGV-FCDV IN RYD-VARI FROM
                        WSS-SGV-FVEN IN WSS-VARI GIVING
                        PES-SGV-DECI IN PES-VARI ROUNDED
               MULTIPLY VEN-VAL-SCAP IN VEN BY
                        PES-SGV-DECI IN PES-VARI GIVING
                        PES-SGV-ENTE IN PES-VARI ROUNDED
               MOVE PES-SGV-ENTE IN PES-VARI TO RYD-VAL-RORD IN RYD-VARI
           ELSE
      *    Bb, Riesgoso
      *        Fecha Fecha Clasificacion Riesgo mayor o igual Fecha Vencimiento
      * Reajustes de la Cuota => Normales Fecha Col a Fecha Corte Devengo
      *                          Orden    Fecha Corte Devengo a Fecha Ven
               IF RYD-FEC-FCLA IN RYD-VARI NOT < VEN-FEC-FVEN IN VEN
                   SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                            RYD-SGV-FCDV IN RYD-VARI GIVING
                            PES-SGV-DECI IN PES-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            PES-SGV-DECI IN PES-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-REAJ IN WSS-VARI

                   SUBTRACT RYD-SGV-FCDV IN RYD-VARI FROM
                            WSS-SGV-FVEN IN WSS-VARI GIVING
                            PES-SGV-DECI IN PES-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            PES-SGV-DECI IN PES-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        RYD-VAL-RORD IN RYD-VARI
              ELSE
      *    Bc, Riesgoso
      *        Fecha Corte Devengo menor o igual Fecha Clasificacion Riesgo
      * Reajustes de la Cuota => Normales Fecha Col a Fecha Corte Devengo
      *                          Orden    Fecha Corte Devengo a Fecha Clasif.
      *                          Riesgo   Fecha Clasif Riesgo a Fecha Ven
                   SUBTRACT WSS-SGV-FCOL IN WSS-VARI FROM
                            RYD-SGV-FCDV IN RYD-VARI GIVING
                            PES-SGV-DECI IN PES-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            PES-SGV-DECI IN PES-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        WSS-VAL-REAJ IN WSS-VARI

                   SUBTRACT RYD-SGV-FCDV IN RYD-VARI FROM
                            RYD-SGV-FCLA IN RYD-VARI GIVING
                            PES-SGV-DECI IN PES-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            PES-SGV-DECI IN PES-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        RYD-VAL-RORD IN RYD-VARI

                   SUBTRACT RYD-SGV-FCLA IN RYD-VARI FROM
                            WSS-SGV-FVEN IN WSS-VARI GIVING
                            PES-SGV-DECI IN PES-VARI ROUNDED
                   MULTIPLY VEN-VAL-SCAP IN VEN BY
                            PES-SGV-DECI IN PES-VARI GIVING
                            PES-SGV-ENTE IN PES-VARI ROUNDED
                   MOVE PES-SGV-ENTE IN PES-VARI TO
                        RYD-VAL-RRIE IN RYD-VARI.
       FIN-OBT-VAL-RNRO.
           EXIT.
      **************************************************************************
      * Determina los Intereses Entre 2 Fechas
       DET-INT-FEC1-FEC2 SECTION.
       INI-DET-INT-FEC1-FEC2.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% DET-INT-FEC1-FEC2'.
      *DAD  fin 24-ABR-1991 

      *Comparacion en Dias entre Fecha Uno y Fecha Dos
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY '% ERROR...' FEC-MENS
               DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC
               DISPLAY 'FEC-STAT     : ' FEC-STAT
               DISPLAY 'FECHA 1      : ' FEC-FEC1 IN FEC-VARI
               DISPLAY 'FECHA 2      : ' FEC-FEC2 IN FEC-VARI
               MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-DET-INT-FEC1-FEC2.

           MOVE FEC-NDIA TO INT-SEPD.

      * Calcula Tasa de Interes del Periodo
           PERFORM CAL-TAS-PER.
           IF INT-CMSG > SPACES
               MOVE 1 TO WSS-IND-ERRO IN WSS-VARI
               GO TO FIN-DET-INT-FEC1-FEC2.

      * Calcula Intereses Devengados en el Periodo
           MULTIPLY INT-TIPE BY RYD-VAL-SCRE IN RYD-VARI GIVING
                                RYD-VAL-IPER IN RYD-VARI ROUNDED.
       FIN-DET-INT-FEC1-FEC2.
           EXIT.
      **************************************************************************
      * Calculo tasa de interes a partir de una tasa y periodo dado
       CAL-TAS-PER SECTION.
       INI-CAL-TAS-PER.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% CAL-TAS-PER'.
      *DAD  fin 24-ABR-1991 

      * Tasa Interes.                    * INT-TIPT.
      * Valor Tasa Informada.            * INT-TINT.
      * Separacion en Dias.              * INT-SEPD.
      * IF INT-CVTI > SPACES
      *   Fecha Interes.                 * INT-FINT.
      *   Moneda.                        * INT-VCAM.

           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.
           IF INT-CVTI > SPACES
               MOVE INT-IBTV-UNA-VEZ    TO INT-IBTV
               MOVE OPC-COD-VCOC IN OPC TO INT-VCAM
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT
      *        En el Ingreso ICG-FEC-FINI = ZEROES
               IF ICG-FEC-FINI IN ICG > ZEROES
                   MOVE ICG-FEC-FINI IN ICG TO INT-FINT
               ELSE
                   MOVE OPC-FEC-FCOL IN OPC TO INT-FINT
           ELSE
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT.

           PERFORM OBT-VTIN.
           IF INT-CMSG NOT > SPACES
               GO TO FIN-CAL-TAS-PER.

           MOVE 'GNS'    TO MSG-COD-SIST.
           MOVE INT-CMSG TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY '% ERROR...' MSG-GLS-DESC.
           DISPLAY 'OPERACION    : ' OPC-CIC-IOPC IN OPC.
           DISPLAY 'FECHA 1      : ' FEC-FEC1 IN FEC-VARI.
           DISPLAY 'FECHA 2      : ' FEC-FEC2 IN FEC-VARI.
           IF INT-CMSG = 'CAM    NEX'
               DISPLAY 'TASA INT./V. CAMBIO/FECHA : ' INT-TIPT '/'
                        INT-VCAM '/' INT-FINT.
       FIN-CAL-TAS-PER.
           EXIT.
      **************************************************************************
      * Mueve Valor Intereses del Periodo (C2a FVAN y FCDV) a IPCV o INTE 
       MOV-VAL-IPER SECTION.
       INI-MOV-VAL-IPER.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% MOV-VAL-IPER'.
      *DAD  fin 24-ABR-1991 

           MOVE RYD-VAL-IPER IN RYD-VARI TO WSS-VAL-INTE IN WSS-VARI.
           IF PRIMER-VEN-CV-SOLO-INT AND VEN-CCT-PRIMER-EN-CV
               MOVE RYD-VAL-IPER IN RYD-VARI TO
                    RYD-VAL-IPCV IN RYD-VARI.
       FIN-MOV-VAL-IPER.
           EXIT.
      **************************************************************************
      * Mueve Fecha 1, FVAN si Fecha Devengo mayor a Fecha Ven Anterior o
      *                FDEV si Fecha Devengo menor a Fecha Ven Anterior
       MOV-FEC-FEC1 SECTION.
       INI-MOV-FEC-FEC1.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% MOV-FEC-FEC1'.
      *DAD  fin 24-ABR-1991 

           IF DLC-FEC-FDEV IN DLC < RYD-FEC-FVAN IN RYD-VARI
               MOVE RYD-NUM-DVAN IN RYD-VARI TO FEC-DEC1 IN FEC-VARI
               MOVE RYD-NUM-MVAN IN RYD-VARI TO FEC-MEC1 IN FEC-VARI
               MOVE RYD-NUM-SVAN IN RYD-VARI TO FEC-SEC1 IN FEC-VARI
               MOVE RYD-NUM-AVAN IN RYD-VARI TO FEC-AEC1 IN FEC-VARI
           ELSE
               MOVE DLC-NUM-DDEV IN DLC TO FEC-DEC1 IN FEC-VARI
               MOVE DLC-NUM-MDEV IN DLC TO FEC-MEC1 IN FEC-VARI
               MOVE DLC-NUM-SDEV IN DLC TO FEC-SEC1 IN FEC-VARI
               MOVE DLC-NUM-ADEV IN DLC TO FEC-AEC1 IN FEC-VARI.
       FIN-MOV-FEC-FEC1.
           EXIT.
      **************************************************************************
      * Mueve al Vector Valores de Intereses Riesgosos y Orden
       PUT-VAL-IRYO SECTION.
       INI-PUT-VAL-IRYO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% PUT-VAL-IRYO'.
      *DAD  fin 24-ABR-1991 

           IF RYD-VAL-IRIE IN RYD-VARI > 0
               ADD 1 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'OIR' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               MOVE RYD-VAL-IRIE IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA)
               ADD 1 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'RIR' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               MOVE RYD-VAL-IRIE IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA).

           IF RYD-VAL-IORD IN RYD-VARI > 0
               MOVE 26 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'OCV' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               ADD  RYD-VAL-IORD IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 27 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'RCV' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               ADD  RYD-VAL-IORD IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA).
       FIN-PUT-VAL-IRYO.
           EXIT.
      **************************************************************************
      * Mueve al Vector Valores de Reajustes Riesgosos y Orden
       PUT-VAL-RRYO SECTION.
       INI-PUT-VAL-RRYO.
      *DAD  ini 24-ABR-1991 
      *     DISPLAY '% PUT-VAL-RRYO'.
      *DAD  fin 24-ABR-1991 

           IF RYD-VAL-RRIE IN RYD-VARI > 0
               ADD 1 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'ORR' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               MOVE RYD-VAL-RRIE IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA)
               ADD 1 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'RRR' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               MOVE RYD-VAL-RRIE IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA).

           IF RYD-VAL-RORD IN RYD-VARI > 0
               MOVE 26 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'OCV' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'D' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               ADD  RYD-VAL-RORD IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 27 TO WSS-NUM-ICPA IN WSS-VARI
               MOVE 'RCV' TO
                    WSS-MSC-TCCT IN WSS-VARI(WSS-NUM-ICPA)
               MOVE 'H' TO WSS-IND-DBHB IN WSS-VARI(WSS-NUM-ICPA)
               MOVE CPP-IND-TALG IN CPP(WSS-NUM-ICPP) TO
                    WSS-IND-TALG IN WSS-VARI(WSS-NUM-ICPA)
               ADD  RYD-VAL-RORD IN RYD-VARI TO
                    WSS-VAL-MNTO IN WSS-VARI(WSS-NUM-ICPA).
       FIN-PUT-VAL-RRYO.
           EXIT.
      **************************************************************************

       COPY GNSBFCIC.
       COPY GNSBFMSC.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFCAN.
       COPY COLBFCCB.
       COPY COLBFCCR.
       COPY COLBFCCT.
       COPY COLBFCPP.
       COPY COLBFDCC.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFITR.
       COPY COLBFMCT.
       COPY COLBFRCV.
       COPY COLBFRDC.
       COPY COLBFTOC.
       COPY COLBFVEN.
       COPY DEUBFCRI.
       COPY SGCBFDBC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY TABBBOFI.
      *DAD  ini 24-ABR-1991
       COPY TABBVOFI.
      *DAD  fin 24-ABR-1991
      *DAD  ini 13-DEC-1991   (Memo.27-06-91 Pto.5)
       COPY GNSBGCMM.
      *DAD  fin 13-DEC-1991
       COPY GNSBGCIC.
       COPY GNSBGCPT.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGPES.
       COPY COLBGVEN.
       COPY COLBGVIN.
      *DAD  ini 13-DEC-1991
       COPY COLBGCTO.
      *DAD  fin 13-DEC-1991
       COPY SGCBGCLI.
      *>>>>
*% END
