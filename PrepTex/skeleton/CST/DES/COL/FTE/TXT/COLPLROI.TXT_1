*%! Codigo adicional para archivo
*% IF RW
      *<<<< RW
       COPY COLRWOC2.
       COPY COLRWDLC.
       COPY COLRWEVC.
       COPY COLRWVEN.
       COPY COLRWRDC.
       COPY COLRWCYA.
       COPY COLRWICG.
      *>>>>
*% END
*% IF RM
      *<<<< RM
       COPY COLRMOC2.
      *>>>>
*% END
*% IF RR
      *<<<<
       COPY COLRROC2 REPLACING ==01  SRT== BY ==02  SRT-OC2==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-COD-PLZA.
               05 WSS-IND-OFIC                       PIC X(01).
               05 WSS-COD-OFIC      VALUE SPACES     PIC X(03).
           03  WSS-NUM-JUL                VALUE 0    PIC 9(06).
           03  WSS-SGV-VCAM               COMP-3     PIC S9(11)V9(4).
           03  WSS-MSC-STAT                          PIC X(01).
           03  WSS-IND-VEVC                          PIC 9(01).
           03  WSS-GLS-SPAC                          PIC X(01).
           03  WSS-NUM-IDLC                          PIC 9(03).
           03  WSS-NUM-FSTD                          PIC 9(03).
           03  WSS-NUM-SUDL                          PIC 9(05).
           03  WSS-MUL-FSTD                          PIC 9(01).
           03  WSS-MUL-DEUD                          PIC 9(01).
           03  WSS-MUL-DEUI                          PIC 9(01).
           03  WSS-MUL-CYA                           PIC 9(01).
           03  WSS-MUL-ICG                           PIC 9(01).
           03  WSS-NUM-ICAN                          PIC 9(03).
           03  WSS-IND-SEL1                          PIC X(01).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP                      PIC 9(02).
               05  WSS-NUM-ACMP                      PIC 9(02).
               05  WSS-NUM-MCMP                      PIC 9(02).
               05  WSS-NUM-DCMP                      PIC 9(02).
           03  WSS-CIC-IOPC.
               05  WSS-CAI-IOPC         VALUE SPACES PIC X(04).
               05  WSS-IIC-IOPC         VALUE SPACES PIC X(08).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                      PIC X(03).
               05  WSS-COD-AOOC                      PIC X(03).
          03 WSS-COD-LUGA.
               05 WSS-COD-COMU                       PIC X(04).
               05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07 WSS-IND-PAIS                    PIC X(01).
                  07 WSS-COD-PAIS                    PIC X(03).
           03  WSS-UBFD.
               05  WSS-TAB-UBFD                      PIC X(03).
               05  WSS-COD-UBFD                      PIC X(12).
           03  WSS-MSC-TVOC                          PIC X(01).

       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRVEN.
       COPY COLBRRDC.
       COPY COLBRCYA.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRAUT.
       COPY COLBRDCC.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.
      *DAD  ini 23-ABR-1991 
       COPY TABBRTIO.
      *DAD  fin 23-ABR-1991 
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRTOC2.
       COPY COLRTDLC.
       COPY COLRTEVC.
       COPY COLRTVEN.
       COPY COLRTRDC.
       COPY COLRTCYA.
       COPY COLRTICG.
      *>>>>
*% END
*% IF PH_OC1
      *<<<< PH_OC1
           IF OPC-MSC-TVOC IN SRT > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TVAL'              TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-TVOC IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-TVOC IN WSS-OC1.

           IF OPC-COD-TOOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-TOOC IN WSS-OC1.

           IF OPC-MSC-STAT IN SRT > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'STT'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-MSC-STAT IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-MSC-STAT IN WSS-OC1.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Centro asignacion de Operacion
           DISPLAY 'ASIGNACION OPERACION : '.
           ACCEPT  WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY WSS-CAI-IOPC IN WSS-VARI.
      *Captura Codigo de Operacion
           DISPLAY 'IDENTIFICACION OPERACION : '.
           ACCEPT  WSS-IIC-IOPC IN WSS-VARI.
           DISPLAY WSS-IIC-IOPC IN WSS-VARI.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *Captura Status
           DISPLAY 'STATUS : '.
           ACCEPT  WSS-MSC-STAT IN WSS-VARI.
           DISPLAY WSS-MSC-STAT IN WSS-VARI.

           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           IF WSS-MSC-STAT IN WSS-VARI > SPACES AND
              WSS-MSC-STAT IN WSS-VARI NOT = '*'
               MOVE 'GNS'                    TO TAB-COD-SIST
               MOVE 'STT'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-MSC-STAT IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-MENS IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT  FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-MNAC IN CAM-VARI.

           IF WSS-CIC-IOPC IN WSS-VARI > SPACES
               IF WSS-CIC-IOPC IN WSS-VARI = '*'
                   MOVE '*' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP
               ELSE
                   MOVE 'O' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP.

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
 
      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-OC1.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-OC1.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-OC1.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-OC1.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-OC1
                                            WSS-NUM-DCMP IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-OC1
                                            WSS-NUM-MCMP IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-OC1
                                            WSS-NUM-SCMP IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-OC1
                                            WSS-NUM-ACMP IN WSS-VARI.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
       NXT-INP.
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO CON-INP-SRT
           ELSE
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                            OPC-IIC-IOPC IN SRT
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
               ELSE
                   GO TO LUP-INP-SRT.

           MOVE WSS-NUM-DINI IN WSS-VARI TO OPC-NUM-DINP IN OPC.
           MOVE WSS-NUM-MINI IN WSS-VARI TO OPC-NUM-MINP IN OPC.
           MOVE WSS-NUM-SINI IN WSS-VARI TO OPC-NUM-SINP IN OPC.
           MOVE WSS-NUM-AINI IN WSS-VARI TO OPC-NUM-AINP IN OPC.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
       CON-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      *DAD  ini 13-MAY-1991 
      * Verifica Credito tenga Saldo 
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-INP-SRT.
      *DAD  fin 13-MAY-1991 

      *DAD  ini 23-ABR-1991 
      * Mediante BUS-TAB Busca Sistema Valido en Tabla TIO para Operacion
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL
               GO TO NXT-INP-SRT.

      * Obtiene Sistema Valido de la Operacion de Credito
           MOVE TAB TO TIO.
           IF TIO-GLS-SIST IN TIO NOT = 'COL'
               GO TO NXT-INP-SRT.
      *DAD  fin 23-ABR-1991 

      * Compara Oficina del Parametro con la Oficina del Credito
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES AND
              WSS-COD-OFIC IN WSS-VARI     > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO NXT-INP-SRT.

      * Compara Status del Parametro con el Status del Credito
           IF WSS-MSC-STAT IN WSS-VARI > SPACES AND
              WSS-MSC-STAT IN WSS-VARI NOT = '*'
               IF WSS-MSC-STAT IN WSS-VARI NOT = OPC-MSC-STAT IN OPC
                   GO TO NXT-INP-SRT.

           PERFORM GET-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-INP-SRT.

           IF OPC-IND-VSTR IN OPC NOT = 'S' 
               PERFORM GET-VEN
           ELSE
               PERFORM GET-EVC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-INP-SRT.

           IF CAM-COD-MNAC IN CAM-VARI NOT = OPC-COD-VCOC IN OPC
               MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(1)
               MOVE OPC-FEC-FCOL IN OPC      TO CAM-FEC-FCAM IN CAM(2)
               MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1)
               MOVE CAM-COD-MNAC IN CAM-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'CODVCAMNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ':' OPC-FEC-FCOL IN OPC '/'
                                            OPC-COD-VCOC IN OPC '/'
                                            CAM-COD-MNAC IN CAM-VARI '/'
                                            OPC-CIC-IOPC IN OPC
                   GO TO NXT-INP-SRT
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                       MOVE 'COL'       TO MSG-COD-SIST
                       MOVE 'VALCAMNVG' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC ':' OPC-FEC-FCOL IN OPC '/'
                                                OPC-COD-VCOC IN OPC '/'
                                                CAM-COD-MNAC IN CAM-VARI
                                                '/' OPC-CIC-IOPC IN OPC
                       GO TO NXT-INP-SRT.

           MOVE OPC-IND-VSTR IN OPC TO SRT-IND-IEVC IN SRT.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               GO TO FIN-INP-SRT.
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES
               MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO LUP-INP-SRT.
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           PERFORM BUS-OPC-FIL-ANX.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.

           PERFORM BUS-GLS-OPC.
           MOVE ZEROES TO WSS-MUL-DEUD IN WSS-VARI.
           PERFORM BUS-DEU-DIR.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           MOVE CYA-IIC-ICYA IN CYA TO WSS-IIC-ICYA IN WSS-OC2.
           MOVE AUT-IIC-ICYA IN AUT TO WSS-IIC-IAUT IN WSS-OC2.
           GENERATE DL-OC2.
           PERFORM GET-DLC-OPC.
           IF WSS-MUL-FSTD IN WSS-VARI = 1 
      *ALD Solo IBM
               MOVE '67' TO LINE-COUNTER
      *
               MOVE WSS-NUM-FSTD IN WSS-VARI TO DLC-NUM-IDLC IN DLC
               PERFORM GET-IND-RDC
               PERFORM GET-DIR-RDC
               PERFORM GET-ABN-CYA
               PERFORM GET-INT-ICG
           ELSE
           IF WSS-MUL-DEUD IN WSS-VARI = 1
      *ALD Solo IBM
               MOVE '67' TO LINE-COUNTER
      *
               PERFORM GET-DIR-RDC
               PERFORM GET-ABN-CYA
               PERFORM GET-INT-ICG
           ELSE
               IF WSS-MUL-CYA IN WSS-VARI = 1
      *ALD Solo IBM
                   MOVE '67' TO LINE-COUNTER
      *
                   PERFORM GET-ABN-CYA
                   PERFORM GET-INT-ICG
               ELSE
                   IF WSS-MUL-ICG IN WSS-VARI = 1
      *ALD Solo IBM
                       MOVE '67' TO LINE-COUNTER
      *
                       PERFORM GET-INT-ICG.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *DAD ini  02-MAY-1994
       COPY GNSBPFEC.
      *DAD fin  02-MAY-1994
      **************************************************************************
       GET-DLC SECTION.
       INI-GET-DLC.
           MOVE OPC-CAI-IOPC IN OPC TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN OPC TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN OPC AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-DLC.
           EXIT.
      **************************************************************************
       GET-EVC SECTION.
       INI-GET-EVC.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-EVC.
           EXIT.
      **************************************************************************
       GET-VEN SECTION.
       INI-GET-VEN.
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN OPC AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN OPC )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN OPC
                                        OPC-IIC-IOPC IN OPC.
       FIN-GET-VEN.
           EXIT.
      **************************************************************************
       BUS-OPC-FIL-ANX SECTION.
       INI-BUS-OPC-FIL-ANX.
           MOVE ZEROES TO WSS-MUL-ICG IN WSS-VARI.
           MOVE ZEROES TO WSS-MUL-CYA IN WSS-VARI.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOICG' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-BUS-OPC-FIL-ANX.

           PERFORM GET-NXT-ITR.
           IF ITR-COD-CVTI IN ITR > SPACES
               MOVE ITR-SGV-SPRD IN ITR TO ITR-SGV-TINT IN ITR.
           IF ITR-COD-TINT IN ITR = 'M'
               MOVE 'MULTIPLES' TO WSS-GLS-TINT IN WSS-OC1
               MOVE 1           TO WSS-MUL-ICG  IN WSS-VARI
               MOVE ZEROES      TO ITR-SGV-TINT IN ITR
           ELSE
               IF ITR-COD-TINT IN ITR > SPACES
                   MOVE 'COL'               TO TAB-COD-SIST
                   MOVE 'INT'               TO TAB-COD-TTAB IN TAB
                   MOVE ITR-COD-TINT IN ITR TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TINT IN WSS-OC1
               ELSE
                   MOVE SPACES TO WSS-GLS-TINT IN WSS-OC1.

           PERFORM GET-CUR-COM.
           IF NOT FIO-STAT-OKS
                MOVE ZEROES TO COM-SGV-TINT IN COM
                MOVE SPACES TO COM-COD-TINT IN COM
           ELSE
               PERFORM GET-NXT-COM
               IF COM-COD-TINT IN COM = 'M'
                   MOVE 'MULTIPLES' TO COM-COD-TINT IN COM
                   MOVE ZEROES      TO COM-SGV-TINT IN COM
               ELSE
                   IF COM-COD-TINT IN COM > SPACES
                       MOVE 'COL'               TO TAB-COD-SIST
                       MOVE 'COM'               TO TAB-COD-TTAB IN TAB
                       MOVE COM-COD-TINT IN COM TO TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB-GLS-DESC TO COM-COD-TINT IN COM
                   ELSE
                       MOVE SPACES TO COM-COD-TINT IN COM.

           PERFORM GET-CUR-CYA.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO CYA-CAI-ICYA IN CYA
               MOVE ZEROES TO CYA-IIC-ICYA IN CYA
               MOVE SPACES TO CYA-IND-TCYA IN CYA
               MOVE SPACES TO WSS-GLS-TCYA IN WSS-OC2
           ELSE
               PERFORM GET-NXT-CYA
               IF CYA-IND-TCYA IN CYA = 'M'
                    MOVE SPACES      TO CYA-IND-TCYA IN CYA
                    MOVE 1           TO WSS-MUL-CYA  IN WSS-VARI
                    MOVE 'MULTIPLES' TO WSS-GLS-TCYA IN WSS-OC2
                    MOVE SPACES      TO CYA-CAI-ICYA IN CYA
                    MOVE ZEROES      TO CYA-IIC-ICYA IN CYA
               ELSE
                   IF CYA-IND-TCYA IN CYA > SPACES
                       MOVE 'TAB'               TO MSC-COD-SIST
                       MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
                       MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
                       PERFORM BUS-MSC
                       MOVE MSC-GLS-DCOR TO WSS-GLS-TCYA IN WSS-OC2
                   ELSE
                       MOVE SPACES TO WSS-GLS-TCYA IN WSS-OC2.

           MOVE OPC-CAI-IOPC IN SRT TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SRT TO AUT-IIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO AUT-IIC-ICYA IN AUT
               MOVE SPACES TO AUT-CAI-ICYA IN AUT.

           PERFORM GET-CUR-ROV.
           MOVE '00' TO FIO-STAT.
       FIN-BUS-OPC-FIL-ANX.
           EXIT.
      *-------------------------------------------------------------------------
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE OPC-CAI-IOPC IN SRT TO ITR-CAI-IOPC IN ITR.
           MOVE OPC-IIC-IOPC IN SRT TO ITR-IIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
                    ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.
      *-------------------------------------------------------------------------
       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SRT AND
              ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SRT AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO ITR-COD-TINT IN ITR
           ELSE
                MOVE SPACES TO ITR-COD-TINT IN ITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.
      *-------------------------------------------------------------------------
       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE OPC-CAI-IOPC IN SRT TO COM-CAI-IOPC IN COM.
           MOVE OPC-IIC-IOPC IN SRT TO COM-IIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
                    COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.
      *-------------------------------------------------------------------------
       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CAI-IOPC IN COM = OPC-CAI-IOPC IN SRT AND
              COM-IIC-IOPC IN COM = OPC-IIC-IOPC IN SRT AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO COM-COD-TINT IN COM
           ELSE
                MOVE SPACES TO COM-COD-TINT IN COM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.
      *-------------------------------------------------------------------------
       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE OPC-CAI-IOPC IN SRT TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN SRT TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
       FIN-GET-CUR-CYA.
           EXIT.
      *-------------------------------------------------------------------------
       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
              OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO CYA-IND-TCYA IN CYA
           ELSE
               MOVE SPACES TO CYA-IND-TCYA IN CYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.
      *-------------------------------------------------------------------------
       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE OPC-CAI-IOPC IN SRT TO ROV-CAI-IOPC IN ROV.
           MOVE OPC-IIC-IOPC IN SRT TO ROV-IIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
      *DAD  ini 13-MAY-1991 
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = ROV-CAI-IOPC IN ROV AND
                    OPC-IIC-IOPC IN SRT = ROV-IIC-IOPC IN ROV )
               MOVE SPACES TO WSS-CAI-RENO IN WSS-OC1
               MOVE SPACES TO WSS-IIC-RENO IN WSS-OC1
               MOVE ZEROES TO WSS-NUM-RENO IN WSS-OC1
               MOVE ZEROES TO WSS-VAL-RENO IN WSS-OC1
               GO TO FIN-GET-CUR-ROV.
           MOVE ROV-CAI-IOPV IN ROV TO WSS-CAI-RENO IN WSS-OC1.
           MOVE ROV-IIC-IOPV IN ROV TO WSS-IIC-RENO IN WSS-OC1.
           MOVE ROV-NUM-IVCT IN ROV TO WSS-NUM-RENO IN WSS-OC1.
           MOVE ROV-SGV-RENO IN ROV TO WSS-VAL-RENO IN WSS-OC1.
       NXT-GET-CUR-ROV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = ROV-CAI-IOPC IN ROV AND
                    OPC-IIC-IOPC IN SRT = ROV-IIC-IOPC IN ROV )
               GO TO FIN-GET-CUR-ROV.
           MOVE 'MULT'             TO WSS-CAI-RENO IN WSS-OC1.
           MOVE SPACES             TO WSS-IIC-RENO IN WSS-OC1.
           MOVE ZEROES             TO WSS-NUM-RENO IN WSS-OC1.
           ADD ROV-SGV-RENO IN ROV TO WSS-VAL-RENO IN WSS-OC1.
           GO TO NXT-GET-CUR-ROV.
      *DAD  fin 13-MAY-1991 
       FIN-GET-CUR-ROV.
           EXIT.
      **************************************************************************
       BUS-GLS-OPC SECTION.
       INI-BUS-GLS-OPC.
      *BUS-OFI busca oficina en tablas
      *DAD  ini 13-MAY-1991 
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
      *DAD  fin 13-MAY-1991 
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-OC1.

           IF OPC-COD-RMOC IN SRT > SPACES
               MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-OC2
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-OC2.

           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCOC IN WSS-OC1
               MOVE WSS-GLS-VCOC IN WSS-OC1 TO WSS-GLS-VCOC IN WSS-VEN
               MOVE WSS-GLS-VCOC IN WSS-OC1 TO WSS-GLS-VCOC IN WSS-EVC
               MOVE TAB-GLS-ABRV IN TAB     TO WSS-GLS-VCOC IN WSS-CYA
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-VEN
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-EVC
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-CYA
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-OC1.

           IF OPC-COD-AOOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SRT TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN SRT TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AOOC IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-AOOC IN WSS-OC1.

           IF OPC-MSC-STAT IN SRT > SPACES
               MOVE 'GNS'               TO TAB-COD-SIST
               MOVE 'STT'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-MSC-STAT IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-STAT IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-STAT IN WSS-OC1.

           IF OPC-COD-SEGD IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'SDG'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-SEGD IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SEGD IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-SEGD IN WSS-OC1.

           IF OPC-MSC-MCVF IN SRT > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCVF'              TO MSC-COD-TMSC IN MSC
               MOVE OPC-MSC-MCVF IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-MCVF IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-GLS-MCVF IN WSS-OC1.

           IF OPC-COD-CDOC IN SRT > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'DES'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-CDOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CDOC IN WSS-OC2
           ELSE
               MOVE SPACES TO WSS-GLS-CDOC IN WSS-OC2.
       FIN-BUS-GLS-OPC.
           EXIT.
      **************************************************************************
       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-BUS-DEU-DIR.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-OC1
               GO TO NXT-BUS-DEU-DIR.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE SPACES TO WSS-GLS-COMU IN WSS-OC1
               PERFORM RST-RCD
               GO TO NXT-BUS-DEU-DIR.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-OC1.
       NXT-BUS-DEU-DIR.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 1 TO WSS-MUL-DEUD IN WSS-VARI
                PERFORM RST-RCD
                PERFORM RST-DBC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
       CON-BUS-DEU-DIR.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-ICLI IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-OC1
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-OC1.
       FIN-BUS-DEU-DIR.
           EXIT.
      **************************************************************************
       GET-DLC-OPC SECTION.
       INI-GET-DLC-OPC.
           MOVE OPC-CAI-IOPC IN SRT TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN SRT TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN SRT AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-OPC.

           MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-IDLC IN WSS-VARI.
           PERFORM BUS-DLC-FIL-ANX.
           PERFORM BUS-GLS-DLC.
           PERFORM BUS-DEU-IND.
           GENERATE DL-DLC.
           IF SRT-IND-IEVC IN SRT NOT = 'S' 
               PERFORM GET-DLC-VEN
           ELSE
               PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI NOT > ZEROES
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC
               IF SRT-IND-IEVC IN SRT NOT = 'S' 
                   PERFORM GET-DLC-VEN
               ELSE
                   PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI > ZEROES
               GO TO CON-GET-DLC-OPC.

           MOVE 'COL' TO MSG-COD-SIST.
           IF SRT-IND-IEVC IN SRT NOT = 'S' 
               MOVE 'DLC    NOVEN' TO MSG-COD-MENS
           ELSE
               MOVE 'DLC    NOEVC' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                    OPC-IIC-IOPC IN SRT
                                    WSS-NUM-IDLC IN WSS-VARI.
       CON-GET-DLC-OPC.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO DLC-NUM-IDLC IN DLC.
           IF WSS-MUL-DEUI IN WSS-VARI = 1
               MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-FSTD IN WSS-VARI
               MOVE 1 TO WSS-MUL-FSTD IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-MUL-FSTD IN WSS-VARI.
       LUP-GET-DLC-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CAI-IOPC IN DLC = OPC-CAI-IOPC IN SRT AND
                    DLC-IIC-IOPC IN DLC = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-OPC.
           MOVE DLC-NUM-IDLC IN DLC TO WSS-NUM-IDLC IN WSS-VARI.
           PERFORM BUS-DLC-FIL-ANX.
           PERFORM BUS-GLS-DLC.
           PERFORM BUS-DEU-IND.
           IF LINE-COUNTER > ZEROES
      *ALD Solo IBM
               MOVE '67' TO LINE-COUNTER.
      *
           GENERATE DL-DLC.
           IF SRT-IND-IEVC IN SRT NOT = 'S'
               PERFORM GET-DLC-VEN
           ELSE
               PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI NOT > ZEROES
               MOVE ZEROES TO DLC-NUM-IDLC IN DLC
               IF SRT-IND-IEVC IN SRT NOT = 'S' 
                   PERFORM GET-DLC-VEN
               ELSE
                   PERFORM GET-DLC-EVC.

           IF WSS-NUM-SUDL IN WSS-VARI > ZEROES
               GO TO NXT-GET-DLC-OPC.

           MOVE 'COL' TO MSG-COD-SIST.
           IF SRT-IND-IEVC IN SRT NOT = 'S'
               MOVE 'DLC    NOVEN' TO MSG-COD-MENS
           ELSE
               MOVE 'DLC    NOEVC' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                    OPC-IIC-IOPC IN SRT
                                    WSS-NUM-IDLC IN WSS-VARI.
       NXT-GET-DLC-OPC.
           MOVE WSS-NUM-IDLC IN WSS-VARI TO DLC-NUM-IDLC IN DLC.
           IF WSS-MUL-DEUI IN WSS-VARI = 1
               PERFORM GET-IND-RDC.
           GO TO LUP-GET-DLC-OPC.
       FIN-GET-DLC-OPC.
           EXIT.
      **************************************************************************
       GET-DLC-VEN SECTION.
       INI-GET-DLC-VEN.
           MOVE ZEROES TO WSS-NUM-SUDL IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN SRT TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN SRT TO VEN-IIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN SRT AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-VEN.

           IF VEN-NUM-IDLC IN VEN = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               GENERATE DL-VEN.
       LUP-GET-DLC-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CAI-IOPC IN VEN = OPC-CAI-IOPC IN SRT AND
                    VEN-IIC-IOPC IN VEN = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-VEN.

           IF VEN-NUM-IDLC IN VEN = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               GENERATE DL-VEN.
           GO TO LUP-GET-DLC-VEN.
       FIN-GET-DLC-VEN.
           EXIT.

       GET-DLC-EVC SECTION.
       INI-GET-DLC-EVC.
           MOVE ZEROES TO WSS-NUM-SUDL IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN SRT TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN SRT TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN SRT AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN SRT )
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOEVC' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ':' OPC-CAI-IOPC IN SRT
                                        OPC-IIC-IOPC IN SRT
               GO TO FIN-GET-DLC-EVC.

           IF EVC-NUM-IDLC IN EVC = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               PERFORM BUS-GLS-EVC
               GENERATE DL-EVC.
       LUP-GET-DLC-EVC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN SRT AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN SRT )
               GO TO FIN-GET-DLC-EVC.

           IF EVC-NUM-IDLC IN EVC = DLC-NUM-IDLC IN DLC
               ADD 1 TO WSS-NUM-SUDL IN WSS-VARI
               PERFORM BUS-GLS-EVC
               GENERATE DL-EVC.
           GO TO LUP-GET-DLC-EVC.
       FIN-GET-DLC-EVC.
           EXIT.

       GET-DIR-RDC SECTION.
       INI-GET-DIR-RDC.
           IF WSS-MUL-DEUD IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-DIR-RDC.

           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-DIR-RDC.

           MOVE SPACES TO WSS-GLS-DOCU IN WSS-RDC.
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE 'DIRECTOS' TO WSS-GLS-TDEU IN WSS-RDC.
           GENERATE DL-HRDC.
       LUP-GET-DIR-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-GET-DIR-RDC.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               GO TO CON-GET-DIR-RDC.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-RDC.
       CON-GET-DIR-RDC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-RDC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-RDC.

      *DAD  ini 02-MAY-1994    (Memo.06-01-94 Pto.3)
      * Calcula Monto Limite Deuda de Deudor Directo Credito
      *     MULTIPLY OPC-VAL-CRED IN SRT BY RDC-VAL-LIMD IN RDC 
      *                       GIVING WSS-VAL-MONL IN WSS-RDC.
      *     DIVIDE WSS-VAL-MONL IN WSS-RDC BY 100 GIVING
      *            WSS-VAL-MONL IN WSS-RDC.
           COMPUTE WSS-VAL-MONL IN WSS-RDC =
                   ( OPC-VAL-CRED IN SRT * RDC-VAL-LIMD IN RDC ) / 100.
      *DAD  fin 02-MAY-1994
           GENERATE DL-RDC.
       LOOP-GET-DIR-RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
                    OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC )
               GO TO FIN-GET-DIR-RDC.

           IF RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-GET-DIR-RDC
           ELSE
               GO TO LOOP-GET-DIR-RDC.
       FIN-GET-DIR-RDC.
           EXIT.

       GET-IND-RDC SECTION.
       INI-GET-IND-RDC.
           IF WSS-MUL-DEUI IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-IND-RDC.

           MOVE OPC-CAI-IOPC IN SRT TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SRT TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-IND-RDC.

           MOVE 'DOCUMENTO'  TO WSS-GLS-DOCU IN WSS-RDC.
           MOVE 'INDIRECTOS' TO WSS-GLS-TDEU IN WSS-RDC.
           GENERATE DL-HRDC.
       LUP-GET-IND-RDC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               GO TO CON-GET-IND-RDC.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               GO TO CON-GET-IND-RDC.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-RDC.
       CON-GET-IND-RDC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-RDC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-RDC.

      *DAD  ini 02-MAY-1994    (Memo.06-01-94 Pto.3)
      * Calcula Monto Limite Deuda de Deudor Indirecto Credito
      *     MULTIPLY OPC-VAL-CRED IN SRT BY RDC-VAL-LIMD IN RDC 
      *                       GIVING WSS-VAL-MONL IN WSS-RDC.
      *     DIVIDE WSS-VAL-MONL IN WSS-RDC BY 100 GIVING
      *            WSS-VAL-MONL IN WSS-RDC.
           COMPUTE WSS-VAL-MONL IN WSS-RDC =
                   ( OPC-VAL-CRED IN SRT * RDC-VAL-LIMD IN RDC ) / 100.
      *DAD  fin 02-MAY-1994
           GENERATE DL-RDC.

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = RDC-CAI-IOPC IN RDC AND
                    OPC-IIC-IOPC IN SRT = RDC-IIC-IOPC IN RDC AND
                    DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC )
               GO TO FIN-GET-IND-RDC.
           GO TO LUP-GET-IND-RDC.
       FIN-GET-IND-RDC.
           EXIT.

       GET-ABN-CYA SECTION.
       INI-GET-ABN-CYA.
           IF WSS-MUL-CYA IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-ABN-CYA.

           MOVE OPC-CAI-IOPC IN SRT TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN SRT TO CYA-IIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
                    OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
                    CYA-NUM-ICAN IN CYA = ZEROES )
               GO TO FIN-GET-ABN-CYA.

           MOVE 'ABONOS' TO WSS-GLS-TIPM IN WSS-CYA.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'A'   TO TAB-CIC-CTAB IN TAB.
           MOVE 'MOV' TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-TMOV IN WSS-CYA.

           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           MOVE MSC-COD-CMSC IN MSC TO WSS-MSC-TVOC IN WSS-VARI.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-CYA.
           GENERATE DL-HCYA.
       LUP-GET-ABN-CYA.
           PERFORM BUS-GLS-CYA.
           MOVE CYA-IIC-ICYA IN CYA TO WSS-IIC-ICYA IN WSS-CYA.
           GENERATE DL-CYA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN SRT = CYA-CAI-IOPC IN CYA AND
              OPC-IIC-IOPC IN SRT = CYA-IIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES 
               GO TO LUP-GET-ABN-CYA.
       FIN-GET-ABN-CYA.
           EXIT.

       GET-INT-ICG SECTION.
       INI-GET-INT-ICG.
           IF WSS-MUL-ICG IN WSS-VARI NOT > ZEROES
               GO TO FIN-GET-INT-ICG.

           MOVE ZEROES TO WSS-NUM-TASA IN WSS-ICG.
           MOVE OPC-CAI-IOPC IN SRT TO ICG-CAI-IOPC IN ICG.
           MOVE OPC-IIC-IOPC IN SRT TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN SRT AND
                    ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN SRT AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               GO TO FIN-GET-INT-ICG.
       LUP-GET-INT-ICG.
           PERFORM BUS-GLS-ICG.
           ADD 1 TO WSS-NUM-TASA IN WSS-ICG.
           GENERATE DL-ICG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = OPC-CAI-IOPC IN SRT AND
              ICG-IIC-IOPC IN ICG = OPC-IIC-IOPC IN SRT AND
              ICG-NUM-ICAN IN ICG = ZEROES              AND
              ICG-CIC-IOPV IN ICG = SPACES              AND
              ICG-NUM-IVCT IN ICG = ZEROES              AND
              ICG-IND-TTAS IN ICG = 'INT' 
               GO TO LUP-GET-INT-ICG.
       FIN-GET-INT-ICG.
           EXIT.

       BUS-DEU-IND SECTION.
       INI-BUS-DEU-IND.
           MOVE ZEROES TO WSS-MUL-DEUI IN WSS-VARI.
           MOVE DLC-CAI-IOPC IN DLC TO RDC-CAI-IOPC IN RDC.
           MOVE DLC-IIC-IOPC IN DLC TO RDC-IIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO CON-BUS-DEU-IND.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO NXT-BUS-DEU-IND.

           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               PERFORM RST-RCD
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               GO TO NXT-BUS-DEU-IND.

           PERFORM BUS-GLS-COMU.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-DLC.
       NXT-BUS-DEU-IND.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              DLC-CAI-IOPC IN DLC = RDC-CAI-IOPC IN RDC AND
              DLC-IIC-IOPC IN DLC = RDC-IIC-IOPC IN RDC AND
              DLC-NUM-IDLC IN DLC = RDC-NUM-IDLC IN RDC 
               MOVE 1 TO WSS-MUL-DEUI IN WSS-VARI
               PERFORM RST-RCD
               PERFORM RST-DBC
               MOVE SPACES TO WSS-GLS-COMU IN WSS-DLC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
       CON-BUS-DEU-IND.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-ICLI IN DBC > SPACES
               MOVE '-' TO WSS-IND-SCLI IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-IND-SCLI IN WSS-DLC.
       FIN-BUS-DEU-IND.
           EXIT.

       BUS-DIRE SECTION.
       INI-BUS-DIRE.
           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
       FIN-BUS-DIRE.
           EXIT.

       RST-DBC SECTION.
       INI-RST-DBC.
      *     MOVE 'SGC' TO MSG-COD-SIST.
      *     MOVE 'CLI    NEX' TO MSG-COD-MENS.
      *     PERFORM GET-MSG.
      *     MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC.
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

       RST-RCD SECTION.
       INI-RST-RCD.
           MOVE SPACES TO RCD-GLS-DIRE IN RCD.
           MOVE SPACES TO RCD-NUM-FONO IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE SPACES TO RCD-COD-LUGA IN RCD.
       FIN-RST-RCD.
           EXIT.

       BUS-GLS-EVC SECTION.
       INI-BUS-GLS-EVC.
           IF EVC-IND-UTDV IN EVC > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IDMA'              TO MSC-COD-TMSC IN MSC
               MOVE EVC-IND-UTDV IN EVC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-UTDV IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-UTDV IN WSS-EVC.
           
           PERFORM GET-PER-FEC.

           IF EVC-MSC-TCVE IN EVC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'CVC '              TO TAB-COD-TTAB IN TAB
               MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TCVE IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-TCVE IN WSS-EVC.

           IF EVC-IND-UTSV IN EVC > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE EVC-IND-UTSV IN EVC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-UTSV IN WSS-EVC
           ELSE
               MOVE SPACES TO WSS-GLS-UTSV IN WSS-EVC.
       FIN-BUS-GLS-EVC.
           EXIT.

       BUS-GLS-DLC SECTION.
       INI-BUS-GLS-DLC.
           IF DLC-COD-TDOC IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'DOC'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-TDOC IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TDOC IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TDOC IN WSS-DLC.

           IF DLC-MSC-TIMP IN DLC > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'TIMP'              TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-TIMP IN DLC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-TIMP IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TIMP IN WSS-DLC.

           MOVE DLC-COD-UBFD IN DLC TO WSS-UBFD IN WSS-VARI.
           IF WSS-TAB-UBFD NOT > SPACES
               MOVE SPACES TO WSS-GLS-UBFD IN WSS-DLC
           ELSE
               IF WSS-TAB-UBFD = 'OFI'
                   MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   IF MSG-COD-MENS = 'COD    NEX'
                       MOVE SPACES TO WSS-GLS-UBFD IN WSS-DLC
                   ELSE
                       MOVE OFI-GLS-DESC IN OFI TO
                            WSS-GLS-UBFD IN WSS-DLC
               ELSE
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE WSS-TAB-UBFD TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-UBFD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-UBFD IN WSS-DLC.

           IF DLC-COD-NOTC IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'NOT'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-NOTC IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-NOTC IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-NOTC IN WSS-DLC.

           IF DLC-COD-PLZA IN DLC > SPACES
               MOVE DLC-COD-PLZA IN DLC TO WSS-COD-PLZA IN WSS-VARI
               IF WSS-IND-OFIC IN WSS-VARI = 'O'
                   MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-PLZA IN WSS-DLC
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'PZA'               TO TAB-COD-TTAB IN TAB
                   MOVE DLC-COD-PLZA IN DLC TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PLZA IN WSS-DLC
            ELSE
                MOVE SPACES TO WSS-GLS-PLZA IN WSS-DLC.

           IF DLC-MSC-MIPL IN DLC > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MIPL'              TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-MIPL IN DLC TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-MIPL IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-MIPL IN WSS-DLC.

           IF DLC-COD-PLZO IN DLC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'PZO'               TO TAB-COD-TTAB IN TAB
               MOVE DLC-COD-PLZO IN DLC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PLZO IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-PLZO IN WSS-DLC.

      *     IF DLC-IND-SCBZ IN DLC > SPACES
      *         MOVE 'COL'               TO MSC-COD-SIST
      *         MOVE 'SCBZ'              TO MSC-COD-TMSC IN MSC
      *         MOVE DLC-IND-SCBZ IN DLC TO MSC-COD-CMSC IN MSC
      *         PERFORM BUS-MSC
      *         MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-SCBZ IN WSS-DLC
      *     ELSE
      *         MOVE SPACES TO WSS-GLS-SCBZ IN WSS-DLC.

           MOVE 'COL'  TO FIO-SIST.
           MOVE 'TCCT' TO MSC-CIC-TMSC IN MSC.
           MOVE 'CAP'  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO DCC-MSC-TCCT IN DCC
           ELSE
               MOVE 'CAP' TO DCC-MSC-TCCT IN DCC.
           MOVE OPC-COD-VCOC IN SRT TO DCC-COD-VCAM IN DCC.
           MOVE OPC-COD-TOOC IN SRT TO DCC-COD-TOCR IN DCC.
           MOVE OPC-COD-AOOC IN SRT TO DCC-COD-AOCR IN DCC.
           MOVE DLC-COD-PLZO IN DLC TO DCC-COD-PLZO IN DCC.
           MOVE DLC-IND-SCRT IN DLC TO DCC-IND-SCRT IN DCC.
           MOVE DLC-IND-SCTB IN DLC TO DCC-IND-SCTB IN DCC.
           MOVE DLC-IND-SCBZ IN DLC TO DCC-IND-SCBZ IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DCC.
           IF FIO-STAT-OKS
               MOVE DCC-CIC-TCCT IN DCC TO WSS-COD-TOSB IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-COD-TOSB IN WSS-DLC.
       FIN-BUS-GLS-DLC.
           EXIT.

       BUS-GLS-ICG SECTION.
       INI-BUS-GLS-ICG.
           IF ICG-MSC-BCTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'BCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BCTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-BCTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-BCTI IN WSS-ICG.

           IF ICG-MSC-PBTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'PBTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-PBTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-PBTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-PBTI IN WSS-ICG.

           IF ICG-MSC-BPBT IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BPBT IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-BPBT IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-BPBT IN WSS-ICG.

           IF ICG-MSC-SPBT IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-SPBT IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-SPBT IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-SPBT IN WSS-ICG.

           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE 'I'                 TO VLR-MSC-TVAL IN VLR
               MOVE ICG-COD-CVTI IN ICG TO VLR-COD-CVAL IN VLR
               MOVE ICG-MSC-PBTI IN ICG TO VLR-COD-TCAM IN VLR
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CVTI IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-CVTI IN WSS-ICG.
            
           IF ICG-MSC-TFPR IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'TFPR'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-TFPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TFPR IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-TFPR IN WSS-ICG.

           IF ICG-MSC-UTPR IN ICG > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-UTPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-UTPR IN WSS-ICG
           ELSE
               MOVE SPACES TO WSS-GLS-UTPR IN WSS-ICG.
           
       FIN-BUS-GLS-ICG.
           EXIT.

       BUS-GLS-CYA SECTION.
       INI-BUS-GLS-CYA.
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TCYA IN WSS-CYA
           ELSE
               MOVE SPACES TO WSS-GLS-TCYA IN WSS-CYA.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCAM IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-SGV-VCAM IN WSS-VARI.

           MULTIPLY WSS-SGV-VCAM IN WSS-VARI BY CYA-SGV-LIQU IN CYA
                    GIVING WSS-VAL-VPES IN WSS-CYA ROUNDED.
           IF OPC-MSC-TVOC IN SRT = WSS-MSC-TVOC IN WSS-VARI
               MOVE ZEROES TO CYA-SGV-LIQU IN CYA.
       FIN-BUS-GLS-CYA.
           EXIT.

       BUS-GLS-COMU SECTION.
       INI-BUS-GLS-COMU.
           IF RCD-COD-LUGA IN RCD > SPACES
               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA
               IF WSS-IND-PAIS = 'P'
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE 'PAI'        TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'COM'               TO TAB-COD-TTAB IN TAB
                   MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
           ELSE
               MOVE SPACES TO TAB-GLS-DESC IN TAB.
       FIN-BUS-GLS-COMU.
           EXIT.
           
       BUS-DLC-FIL-ANX SECTION.
       INI-BUS-DLC-FIL-ANX.
           PERFORM GET-CUR-ICG.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE SPACES TO WSS-GLS-TIPT IN WSS-DLC
               GO TO FIN-BUS-DLC-FIL-ANX.
           PERFORM GET-NXT-ICG
           IF ICG-COD-TINT IN ICG = 'M'
               MOVE 'M'    TO WSS-GLS-TIPT IN WSS-DLC
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               GO TO FIN-BUS-DLC-FIL-ANX.

           IF ICG-COD-TINT IN ICG > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN ICG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TIPT IN WSS-DLC
           ELSE
               MOVE SPACES TO WSS-GLS-TIPT IN WSS-DLC.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.
       FIN-BUS-DLC-FIL-ANX.
           EXIT.

       GET-CUR-ICG SECTION.
       INI-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
              ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
              ICG-CIC-IOPV IN ICG = SPACES       AND
              ICG-NUM-IVCT IN ICG = ZEROES       AND
              ICG-IND-TTAS IN ICG = 'INT'
               GO TO FIN-GET-CUR-ICG.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE ZEROES       TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES       TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES       TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'        TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES       TO ICG-FEC-FINI IN ICG.
           MOVE 'ICG-KEY-IICG ' TO FIO-AKEY.
           MOVE FIO-GET-NLS     TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
                    ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
                    ICG-NUM-ICAN IN ICG = ZEROES       AND
                    ICG-CIC-IOPV IN ICG = SPACES       AND
                    ICG-NUM-IVCT IN ICG = ZEROES       AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-GET-CUR-ICG.
           EXIT.

       GET-NXT-ICG SECTION.
       INI-GET-NXT-ICG.
           MOVE ICG-NUM-ICAN IN ICG TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS AND
              ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC      AND
              ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC      AND
              ICG-NUM-ICAN IN ICG = WSS-NUM-ICAN IN WSS-VARI AND
              ICG-CIC-IOPV IN ICG = SPACES                   AND
              ICG-NUM-IVCT IN ICG = ZEROES                   AND
              ICG-IND-TTAS IN ICG = 'INT'
                MOVE 'M' TO ICG-COD-TINT IN ICG
           ELSE
                MOVE SPACES TO ICG-COD-TINT IN ICG
                PERFORM GET-CUR-ICG.
       FIN-GET-NXT-ICG.
           EXIT.

       GET-PER-FEC SECTION.
       INI-GET-PER-FEC.
           MOVE FEC-RET-JUL             TO FEC-CMND.
           MOVE FEC-FORM-FEC            TO FEC-FORM.
           MOVE EVC-NUM-DPVC IN EVC     TO FEC-ITM1.
           MOVE EVC-NUM-MPVC IN EVC     TO FEC-ITM2.
           MOVE EVC-NUM-SPVC IN EVC     TO FEC-ITM3.
           MOVE EVC-NUM-APVC IN EVC     TO FEC-ITM4.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-FJUL            TO WSS-NUM-JUL.
           MOVE FEC-RET-JUL         TO FEC-CMND.
           MOVE FEC-FORM-FEC        TO FEC-FORM.
           MOVE OPC-NUM-DCOL IN SRT TO FEC-ITM1.
           MOVE OPC-NUM-MCOL IN SRT TO FEC-ITM2.
           MOVE OPC-NUM-SCOL IN SRT TO FEC-ITM3.
           MOVE OPC-NUM-ACOL IN SRT TO FEC-ITM4.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           SUBTRACT FEC-FJUL FROM WSS-NUM-JUL
                           GIVING WSS-NUM-SPVE IN WSS-EVC
           MOVE 'D' TO WSS-IND-UTPV IN WSS-EVC.
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-UTPV IN WSS-EVC TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-UTPV IN WSS-EVC.
       FIN-GET-PER-FEC.
           EXIT.

       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFRDC.
       COPY COLBFCYA.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFAUT.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFDCC.

       COPY SGCBFDBC.
       COPY SGCBFRCD.

       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFVLR.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBVOFI.
       COPY TABBVUSR.

       COPY GNSBVTAB.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *
      *>>>>
*% END
