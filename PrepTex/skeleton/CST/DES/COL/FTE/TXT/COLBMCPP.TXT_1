*%! Codigo adicional para archivo
*% IF FIN_RET_ALL_CPP
      *<<<< FIN_RET_ALL_CPP
      *GET-HOY Obtiene Fecha y Hora actual
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO CPP-NUM-DTRN IN CPP.
           MOVE HOY-MHOY IN HOY-VARI TO CPP-NUM-MTRN IN CPP.
           MOVE HOY-AHOY IN HOY-VARI TO CPP-NUM-ATRN IN CPP.
           MOVE HOY-SHOY IN HOY-VARI TO CPP-NUM-STRN IN CPP.
           MOVE HOY-HHOY IN HOY-VARI TO CPP-HRA-HRTR IN CPP.
      *>>>>
*% END
*% IF CPP_FEC_FUMO 
      *<<<< CPP_FEC_FUMO 
      *     IF CPP-FEC-FUMO IN CPP-FLD NOT > ZEROES
      *GET-HOY Obtiene Fecha y Hora actual
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO CPP-NUM-DUMO IN CPP-FLD.
           MOVE HOY-MHOY IN HOY-VARI TO CPP-NUM-MUMO IN CPP-FLD.
           MOVE HOY-AHOY IN HOY-VARI TO CPP-NUM-AUMO IN CPP-FLD.
           MOVE HOY-SHOY IN HOY-VARI TO CPP-NUM-SUMO IN CPP-FLD.
      *>>>>
*% END
*% IF CPP_COD_AOOC
      *<<<< CPP_COD_AOOC
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE CPP-COD-TOOC IN CPP-FLD TO WSS-COD-TOOC IN WSS-VARI.
           MOVE CPP-COD-AOOC IN CPP-FLD TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              CPP-COD-AOOC IN CPP-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN CPP-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOOC IN CPP-FLD.
      *>>>>
*% END
*% IF CPP_IND_TALG
      *<<<< CPP_IND_TALG
      *DAD
      * Busca Datos Adicionales(3) en tabla MVT si existen y guarda en WSS
           IF CPP-COD-MVTO IN CPP-FLD > SPACES
               MOVE 'COL'                   TO TAB-COD-SIST
               MOVE 'MVT'                   TO TAB-COD-TTAB IN TAB
               MOVE CPP-COD-MVTO IN CPP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-ADIC IN WSS-VARI
           ELSE
               GO TO AUT-CPP-IND-TALG.

      * Verificar que Datos Adicionales(3) con los Tipos de Algoritmo validos
      * para el Codigo de Movimiento ingresado, correspondan al Tipo de
      * Algoritmo ingresado
           MOVE  0  TO WSS-IND-TALG IN WSS-VARI.
           PERFORM VAL-IND-TALG VARYING WSS-IND FROM 1 BY 1 UNTIL
                         WSS-IND IN WSS-VARI > 20 OR
                         WSS-IND-TALG IN WSS-VARI = 1.
           IF WSS-IND-TALG IN WSS-VARI = 1
               GO TO AUT-CPP-IND-TALG.

      * Busca mensaje en tabla cuando Tipo Algoritmo no sea valido
           MOVE 'COL'          TO MSG-COD-SIST.
           MOVE 'INDTALGNOVAL' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-IFLD     TO WSS-POS.
           MOVE WSS-POS      TO FRM-MEN2.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       AUT-CPP-IND-TALG.
      *DAD
      *>>>>
*% END
*% IF VAL_CON_FLD_CPP
      *<<<< VAL_CON_FLD_CPP
           PERFORM VAL-CON VARYING FRM-IFLD FROM 1 BY 1
               UNTIL FRM-SUAR = FRM-SUAR-MAL OR FRM-IFLD > 20.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *DAD
       VAL-IND-TALG SECTION.
       INI-VAL-IND-TALG.
           IF CPP-IND-TALG IN CPP-FLD(FRM-IFLD) = WSS-COD-ADIC IN
                                                      WSS-VARI(WSS-IND)
               MOVE  1 TO WSS-IND-TALG IN WSS-VARI.
       FIN-VAL-IND-TALG.
           EXIT.
      *DAD

       VAL-CON SECTION.
       INI-VAL-CON.
           IF ( CPP-MSC-TCCT IN CPP-FLD(FRM-IFLD) > SPACES AND
                CPP-IND-DBHB IN CPP-FLD(FRM-IFLD) > SPACES AND
                CPP-IND-TALG IN CPP-FLD(FRM-IFLD) > SPACES )
               GO TO FIN-VAL-CON.
           IF ( CPP-MSC-TCCT IN CPP-FLD(FRM-IFLD) NOT > SPACES AND
                CPP-IND-DBHB IN CPP-FLD(FRM-IFLD) NOT > SPACES AND
                CPP-IND-TALG IN CPP-FLD(FRM-IFLD) NOT > SPACES )
               GO TO FIN-VAL-CON.
      *GET-MSG Busca mensaje en tabla
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'ALLFULLORCLR' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-IFLD     TO WSS-POS.
           MOVE WSS-POS      TO FRM-MEN2.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CON.
           EXIT.
      *>>>>
*% END
*% IF CPP_IND_SCTB
      *<<<< CPP_IND_SCTB
           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = 'COP'
               PERFORM KEY-ALL-CPP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CHK-DUPL SECTION.
       INI-CHK-DUPL.
           PERFORM COL-FIO-CPP.
           IF FIO-STAT-OKS
               MOVE 'DAP' TO MSG-COD-SIST
               MOVE 'KEY    DUPLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.
      *>>>>
*% END
