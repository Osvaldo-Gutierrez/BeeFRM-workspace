*%! Codigo adicional para archivo
*% IF PGM_PER
*% IF FIN_UNP_DLC_DLC
      *<<<< FIN_UNP_DLC_DLC
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               MOVE FRM-CPIM-AEY TO DLC-COD-NBCO-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-FEC-FGIR-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-FEC-FMAV-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-IND-CCOB-ATR IN DLC-FLD
               MOVE FRM-CPIM-AEY TO DLC-MSC-STAT-ATR IN DLC-FLD.
      *>>>>
*% END
*% IF INI_DLC_COD_NBCO
      *<<<< INI_DLC_COD_NBCO
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               GO TO FIN-VAL-DLC-COD-NBCO.
           IF DLC-COD-NBCO IN DLC-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF INI_DLC_FEC_FGIR
      *<<<< INI_DLC_FEC_FGIR
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               MOVE ZEROES TO DLC-FEC-FGIR IN DLC-FLD
               GO TO FIN-VAL-DLC-FEC-FGIR.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_DLC_FEC_FMAV
      *<<<< INI_DLC_FEC_FMAV
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               MOVE ZEROES TO DLC-FEC-FMAV IN DLC-FLD
               GO TO FIN-VAL-DLC-FEC-FMAV.
      * Valida Fecha de Giro
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_DLC_IND_CCOB
      *<<<< INI_DLC_IND_CCOB
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               GO TO FIN-VAL-DLC-IND-CCOB.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'CCOB'                  TO MSC-COD-TMSC IN MSC.
           MOVE DLC-IND-CCOB IN DLC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF INI_DLC_MSC_STAT
      *<<<< INI_DLC_MSC_STAT
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               GO TO FIN-VAL-DLC-MSC-STAT.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'SDLC'                  TO MSC-COD-TMSC IN MSC.
           MOVE DLC-MSC-STAT IN DLC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% END
*% IF INI_PUT_DBC_DLC
      *<<<< INI_PUT_DBC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLC    MDIND' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLC.
           IF NOT PGM-STAT-DBC-OKS
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
               MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
               GO TO FIN-PUT-DBC-DLC.
      *>>>>
*% END
*% IF FIN_PUT_DBC_DLC
      *<<<< FIN_PUT_DBC_DLC
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DLC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_OPC_DLC
      *<<<< FIN_PUT_OPC_DLC
      *BUS-TAB busca glosa de codigo en tabla
      * NO EXISTE OPC-COD-VCOC IN DLC-FLD
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN DLC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_RDC_DLC
      *<<<< FIN_PUT_RDC_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE ZEROES TO RDC-NUM-DIRE IN DLC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DLC_DLC
      *<<<< FIN_PUT_DLC_DLC
*% IF PGM_PER
           IF SCR-STPP = 'M'
               GO TO SIG-PUT-DLC-DLC.
           MOVE OPC-IND-VSTR IN OPC     TO FRM-IND-VSTR IN DLC-FLD.
           MOVE DLC-COD-TDOC IN DLC-FLD TO FRM-CIC-TDOC IN DLC-FLD.
           PERFORM BUS-CIC-TDOC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PUT-DLC-DLC.
           PERFORM BUS-CIC-OPEC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PUT-DLC-DLC.
       SIG-PUT-DLC-DLC.
*% END
      *BUS-TAB busca glosa de codigo en tabla
           MOVE DLC-COD-UBFD IN DLC-FLD TO WSS-UBFD.
           IF WSS-TAB-UBFD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
           ELSE
           IF WSS-TAB-UBFD = 'OFI'
               MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO
                        FRM-GLS-UBFD IN DLC-FLD
            ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE WSS-TAB-UBFD TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-UBFD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN DLC-FLD.
           IF DLC-COD-PLZA IN DLC-FLD NOT > SPACES
               GO TO CON-PUT-DLC-DLC.
           MOVE DLC-COD-PLZA IN DLC-FLD TO WSS-COD-PLZA IN WSS-VARI.
           IF WSS-IND-OFIC IN WSS-VARI = 'O'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-PLZA IN DLC-FLD.
       CON-PUT-DLC-DLC.
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF FIN_RET_DLC_DLC
      *<<<< FIN_RET_DLC_DLC
      *HPM ini
           MOVE 'A' TO DLC-MSC-STAT IN DLC.
      *HPM fin
      *>>>>
*% END
*% END
*% IF FIN_PUT_ICG_DLC
      *<<<< FIN_PUT_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN DLC-FLD.
      *>>>>
*% END
*% IF FIN_RET_ICG_DLC
      *<<<< FIN_RET_ICG_DLC
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-TINT IN DLC-FLD TO ICG-SGV-SPRD IN ICG.
      *>>>>
*% END
*% IF INI_FST_FLD_DLC
      *<<<< INI_FST_FLD_DLC
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
               MOVE -1 TO DLC-VAL-NDLC-LEN IN DLC-FLD
               GO TO FIN-FST-FLD-DLC.
      *>>>>
*% END
*% IF DLC_CAI_IOPC
      *<<<< DLC_CAI_IOPC
           IF DLC-CAI-IOPC IN DLC-FLD NOT > SPACES
               MOVE SPACES TO DLC-CAI-IOPC IN DLC-FLD.
      *>>>>
*% END
*% IF DBC_IND_ICLI
      *<<<< DBC_IND_ICLI
      *VAL-IND o VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DLC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DLC-FLD.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DLC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DLC-FLD.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES 
               IF DBC-IND-ICLI IN DLC-FLD NOT = 'M'
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-IND-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
               ELSE
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                                  DBC-GLS-ICLI IN DLC-FLD
                                  GO TO FIN-VAL-DBC-NUM-ICLI
           ELSE 
               IF DBC-IND-ICLI IN DLC-FLD = 'M'
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'INDNUMICLII' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN DLC-FLD = 'M'
      *ISP PARAMETRIZACION PARA ACEPTAR MULTIPLES DEUDORES INDIRECTOS
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDIND' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DLC-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *VAL-RUT Valida Rut
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               MOVE SPACES TO DBC-VRF-ICLI IN DLC-FLD
                              DBC-IND-ICLI IN DLC-FLD
                              DBC-GLS-ICLI IN DLC-FLD
                              RDC-CAI-ICLI IN DLC-FLD
                              RDC-IIC-ICLI IN DLC-FLD
                              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN DLC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DLC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN DLC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN DLC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN DLC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN DLC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DLC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN DLC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN DLC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLC-FLD
                   MOVE WSS-HAY TO WSS-FRDC. 
      *>>>>
*% END
*% IF RDC_NUM_DIRE
      *<<<< RDC_NUM_DIRE
           IF DBC-IND-ICLI IN DLC-FLD = 'M' OR
              DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES
               MOVE ZEROES TO RDC-NUM-DIRE IN DLC-FLD
               GO TO FIN-VAL-RDC-NUM-DIRE.
           IF RDC-NUM-DIRE IN DLC-FLD NOT > ZEROES
               PERFORM BUS-DOM
               IF RCD-GLS-DIRE IN RCD > SPACES
                   MOVE RCD-NUM-DIRE IN RCD TO RDC-NUM-DIRE IN DLC-FLD
                   GO TO FIN-VAL-RDC-NUM-DIRE
               ELSE
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'NUMDONINEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-RDC-NUM-DIRE.

           MOVE RDC-CAI-ICLI IN DLC-FLD TO RCD-CAI-ICLI IN RCD.
           MOVE RDC-IIC-ICLI IN DLC-FLD TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN DLC-FLD TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'NUMDIRENEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RDC-NUM-DIRE.
      *>>>>
*% END
*% IF DLC_VAL_NDLC
      *<<<< DLC_VAL_NDLC
      *DAD ini  10-MAY-1994    ( lo bloqueo por no ser usado ?? )
      **BUS-TAB busca glosa de codigo en tabla
      *     MOVE OPC-COD-TOOC IN DLC-FLD TO TOC-COD-TOCR IN TOC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-TOC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODTOC NEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      **        STRING MSG-GLS-DESC
      **               MSG-GLS-DATA DELIMITED BY SIZE
      **        INTO FRM-MENS
      *         MOVE MSG-GLS-DESC TO CPT-STR1
      *         MOVE MSG-GLS-DATA TO CPT-STR2
      *         PERFORM CPT-BLKS
      *         MOVE CPT-STRN     TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-DLC-VAL-NDLC.
      *
      *     MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
      *     MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
      *     MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM GNS-FIO-MSC.   
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'INDOPECNEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO CPT-STR1
      *         MOVE MSG-GLS-DATA TO CPT-STR2
      *         PERFORM CPT-BLKS
      *         MOVE CPT-STRN     TO FRM-MENS
      **        STRING MSG-GLS-DESC
      **               MSG-GLS-DATA DELIMITED BY SIZE
      **        INTO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-DLC-VAL-NDLC.
      **
      **     IF MSC-CIC-CMSC IN MSC = 'D'
      **             GO TO FIN-VAL-DLC-VAL-NDLC.
      *DAD fin  10-MAY-1994
      *     IF FRM-CIC-OPEC IN DLC-FLD = 'D'
      *             GO TO FIN-VAL-DLC-VAL-NDLC.
           IF DLC-VAL-NDLC IN DLC-FLD NOT > ZEROES
               MOVE OPC-VAL-CRED IN OPC TO DLC-VAL-NDLC IN DLC-FLD.
           IF DLC-VAL-NDLC IN DLC-FLD > OPC-VAL-CRED IN OPC
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'VALNDLCCRED>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF DLC_VAL_SDLC
      *<<<< DLC_VAL_SDLC
      *    IF OPC-MSC-STAT IN OPC NOT = 'C'
           IF NOT OPC-ESPERA-OPC
               MOVE DLC-VAL-NDLC IN DLC-FLD TO DLC-VAL-SDLC IN DLC-FLD.
      *>>>>
*% END
*% IF DLC_COD_TDOC
      *<<<< DLC_COD_TDOC
           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
               MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
               MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
               MOVE ZEROES              TO POC-NUM-IPOC IN POC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-POC
               MOVE FIO-STAT TO PGM-STAT-POC.
           IF SCR-CMND = 'MCA'
               MOVE '23' TO PGM-STAT-POC.
           IF NOT PGM-STAT-POC-OKS 
               GO TO CON-VAL-DLC-COD-TDOC.
           IF DLC-COD-TDOC IN DLC-FLD NOT = POC-COD-TDOC IN POC AND
              POC-COD-TDOC IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'CODTDOCNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-COD-TDOC IN POC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-COD-TDOC.
       CON-VAL-DLC-COD-TDOC.
      *>>>>
*% END
*% IF DLC_MSC_MIPL
      *<<<< DLC_MSC_MIPL
           IF NOT PGM-STAT-POC-OKS 
               GO TO CON-VAL-DLC-MSC-MIPL.
           IF DLC-MSC-MIPL IN DLC-FLD NOT = POC-MSC-MIPL IN POC AND
              POC-MSC-MIPL IN POC > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'MSCMIPLNOPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE POC-MSC-MIPL IN POC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DLC-MSC-MIPL.
       CON-VAL-DLC-MSC-MIPL.
      *>>>>
*% END
*% IF DLC_COD_PLZA
      *<<<< DLC_COD_PLZA
           IF DLC-COD-PLZA IN DLC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-PLZA.
           MOVE DLC-COD-PLZA IN DLC-FLD TO WSS-COD-PLZA IN WSS-VARI.
           IF WSS-IND-OFIC IN WSS-VARI = 'O'
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS NOT = SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-PLZA
               ELSE
                   MOVE OFI-COD-PLZA IN OFI TO WSS-COD-PLAZ IN WSS-VARI
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-PLZA IN DLC-FLD
                   MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
                   PERFORM BUS-OFI
                   IF OFI-COD-PLZA IN OFI = WSS-COD-PLAZ IN WSS-VARI
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'PLAZAS    =' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-DLC-COD-PLZA
                   ELSE
                       GO TO FIN-VAL-DLC-COD-PLZA.
      *ALD
           MOVE 'COL' TO MSG-COD-SIST.
           MOVE 'CODPLZAINV' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-DLC-COD-PLZA.
         
      *     IF OPC-COD-OFOC IN DLC-FLD > SPACES AND
      *        DLC-COD-PLZA IN DLC-FLD NOT > SPACES
      *         MOVE OPC-COD-OFOC IN DLC-FLD TO OFI-COD-OFIC IN OFI
      *         PERFORM BUS-OFI
      *         MOVE OFI-COD-PLZA IN OFI TO DLC-COD-PLZA IN DLC-FLD.
      *     MOVE 'TAB' TO TAB-COD-SIST.
      *     MOVE 'PZA' TO TAB-COD-TTAB IN TAB.
      *     MOVE DLC-COD-PLZA IN DLC-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF NOT (MSG-COD-MENS NOT = 'COD    NEX' AND
      *        DLC-COD-PLZA IN DLC-FLD > SPACES )
      *         MOVE SPACES TO FRM-GLS-PLZA IN DLC-FLD
      *         GO TO FIN-VAL-DLC-COD-PLZA.
      *     MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PLZA IN DLC-FLD.
      *     IF TAB-COD-DAT3 (1) > SPACES
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODPLZAINV' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *          MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *     GO TO FIN-VAL-DLC-COD-PLZA.
      *>>>>
*% END
*% IF DLC_VAL_DPES
      *<<<< DLC_VAL_DPES
      *     MOVE 'TAB'          TO FIO-SIST.
      *     MOVE 'VLR'          TO TAB-CIC-TTAB.
      *     MOVE '0999  '       TO TAB-CIC-CTAB.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     PERFORM GNS-FIO-TAB.
      *     IF FIO-STAT-OKS
      *         IF TAB-COD-CTAB NOT = OPC-COD-VCOC IN OPC
      *             MOVE OPC-FEC-FING TO CAM-FEC-FCAM IN CAM(1)
      *             MOVE OPC-FEC-FING TO CAM-FEC-FCAM IN CAM(2)
      *             MOVE OPC-COD-VCOC TO CAM-COD-VCAM IN CAM(1)
      *             MOVE TAB-COD-CTAB TO CAM-COD-VCAM IN CAM(2)
      *             MOVE FIO-GET-KEY  TO FIO-CMND
      *             PERFORM TAB-FIO-CAM
      *             IF NOT FIO-STAT-OKS
      *                 MOVE FRM-SUAR-MAL TO FRM-SUAR
      *                 MOVE 'COL' TO MSG-COD-SIST
      *                 MOVE 'CODVCAMNEX' TO MSG-COD-MENS
      *                 PERFORM GET-MSG
      *                 MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
      *             ELSE
      *                 IF CAM-IND-VIGE IN CAM = 'N'
      *                     MOVE FRM-SUAR-MAL TO FRM-SUAR
      *                     MOVE 'COL' TO MSG-COD-SIST
      *                     MOVE 'CODVCAMNVG' TO MSG-COD-MENS
      *                     PERFORM GET-MSG
      *                     MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
      *                 ELSE
      *                     MULTIPLY CAM-SGV-VCAM IN CAM
      *                     BY       DLC-VAL-NDLC IN DLC-FLD
      *                     GIVING   DLC-VAL-DPES IN DLC
      *         ELSE
      *             MOVE DLC-VAL-NDLC IN DLC-FLD TO
      *                  DLC-VAL-DPES IN DLC
      *     ELSE
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE 'COL' TO MSG-COD-SIST
      *         MOVE 'CODTVLRNEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
      *>>>>
*% END
*% IF DLC_COD_UBFD
      *<<<< DLC_COD_UBFD
           IF DLC-COD-UBFD IN DLC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-UBFD.
           MOVE DLC-COD-UBFD IN DLC-FLD TO WSS-UBFD.
           IF WSS-TAB-UBFD = 'OFI'
               MOVE WSS-COD-UBFD TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-UBFD
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO
                        FRM-GLS-UBFD IN DLC-FLD
                   GO TO FIN-VAL-DLC-COD-UBFD.
           IF WSS-TAB-UBFD = 'BCO'
               GO TO BCO-UBFD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-TAB-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
                GO TO FIN-VAL-DLC-COD-UBFD.
       BCO-UBFD.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE WSS-TAB-UBFD IN WSS-UBFD TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-UBFD IN WSS-UBFD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-UBFD IN DLC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UBFD IN DLC-FLD.
      *>>>>
*% END
*% IF DLC_COD_NOTC
      *<<<< DLC_COD_NOTC
           IF DLC-COD-NOTC IN DLC-FLD NOT > SPACES
               MOVE SPACES TO DLC-COD-NOTC IN DLC-FLD
               MOVE SPACES TO FRM-GLS-NOTC IN DLC-FLD
               GO TO FIN-VAL-DLC-COD-NOTC.
      *>>>>
*% END
*% IF FRM_VAL_IPEN
      *<<<< FRM_VAL_IPEN
           IF SCR-CCPP = 'ING'
               IF FRM-VAL-IPEN IN DLC-FLD NOT > ZEROES
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'VALIPENZERO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF DLC_FEC_FDEV
      *<<<< DLC_FEC_FDEV
      *     IF SCR-CCPP = 'ING'
      *         MOVE OPC-NUM-DCOL IN OPC TO DLC-NUM-DDEV IN DLC-FLD
      *         MOVE OPC-NUM-MCOL IN OPC TO DLC-NUM-MDEV IN DLC-FLD
      *         MOVE OPC-NUM-SCOL IN OPC TO DLC-NUM-SDEV IN DLC-FLD
      *         MOVE OPC-NUM-ACOL IN OPC TO DLC-NUM-ADEV IN DLC-FLD.
           MOVE  ZEROES TO DLC-FEC-FDEV IN DLC-FLD.
      *>>>>
*% END
*% IF DLC_FEC_FAMT
      *<<<< DLC_FEC_FAMT
           MOVE ZEROES TO DLC-FEC-FAMT IN DLC-FLD.
      *>>>>
*% END
*% IF DLC_MSC_TCVE
      *<<<< DLC_MSC_TCVE
           IF DLC-MSC-TCVE IN DLC-FLD NOT > SPACES
               MOVE OPC-MSC-TCVE IN OPC TO DLC-MSC-TCVE IN DLC-FLD.
      *>>>>
*% END
*% IF FRM_COD_TOSB
      *<<<< FRM_COD_TOSB
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DLCTOSBVALNO' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S'
               MOVE SPACES TO FRM-COD-TOSB IN DLC-FLD
               GO TO FIN-VAL-FRM-COD-TOSB.

           IF SCR-CCPP = 'ING' AND
              FRM-COD-TOSB IN DLC-FLD NOT > SPACES
               MOVE 'GLS    BLK' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_DLC
      *<<<< INI_VAL_CON_KEY_DLC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-DLC.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_DLC
      *<<<< FIN_VAL_CON_IKY_DLC
           IF DLC-IIC-IOPC IN DLC-FLD NOT > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'IICIDLCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_DLC
      *<<<< FIN_VAL_CON_KEY_DLC
           IF NOT (   DLC-IIC-IOPC IN DLC-FLD > SPACES   OR

                    ( DLC-IIC-IOPC IN DLC-FLD > SPACES   AND
                      DLC-NUM-IDLC IN DLC-FLD > ZEROES ) OR

                    ( DBC-NUM-ICLI IN DLC-FLD > ZEROES ) OR

                    ( DBC-GLS-NOMC IN DLC-FLD > SPACES ) )
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_DLC
      *<<<< VAL_CON_FLD_DLC
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               MOVE SPACES TO DBC-GLS-NOMC IN DLC-FLD.

           MOVE DLC-CAI-IOPC IN DLC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE DLC-IIC-IOPC IN DLC-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC
               MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC
               MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC
               MOVE ZEROES              TO POC-NUM-IPOC IN POC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-POC
               MOVE FIO-STAT TO PGM-STAT-POC.

           IF SCR-CMND = 'MCA'
               MOVE '23' TO PGM-STAT-POC.

           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              PGM-STAT-POC-OKS                     AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               IF POC-IND-AVAL IN POC = 'S'
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-DLC.
      *ALDI
           IF DBC-NUM-ICLI IN DLC-FLD NOT > ZEROES AND
              DBC-IND-ICLI IN DLC-FLD NOT = 'M'
               MOVE 'COL'  TO FIO-SIST
               MOVE 'GARA' TO MSC-CIC-TMSC IN MSC
               MOVE '2'    TO MSC-CIC-CMSC IN MSC
               MOVE 'MSC-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF FIO-STAT-OKS AND 
                  OPC-IND-GARA IN OPC = MSC-COD-CMSC IN MSC
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLIOBLPORPLT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-DLC.
      *ALDF
           PERFORM VAL-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL
                GO TO FIN-VAL-CON-FLD-DLC.

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF DLC-MSC-TIMP IN DLC-FLD > SPACES
               MOVE 'COL'                   TO MSC-COD-SIST
               MOVE 'TIMP'                  TO MSC-COD-TMSC IN MSC
               MOVE DLC-MSC-TIMP IN DLC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               IF MSC-CIC-MSCL IN MSC = 'I'
                   IF DLC-VAL-IMPU IN DLC-FLD NOT > ZEROES
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE 'COL'        TO MSG-COD-SIST
                       MOVE 'VALIMPUZER' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       GO TO FIN-VAL-CON-FLD-DLC.
      *    ELSE CALCULO            

           IF DLC-COD-NOTC IN DLC-FLD NOT  > SPACES
               MOVE ZEROES TO DLC-VAL-GNOT IN DLC-FLD
               GO TO NOT-NOTC.

           MOVE 'NTR'                   TO NTR-COD-TTAB IN NTR.
           MOVE DLC-COD-NOTC IN DLC-FLD TO NTR-COD-NOTA IN NTR.
           MOVE OPC-COD-OFOC IN DLC-FLD TO NTR-COD-OFIC IN NTR.
           MOVE DLC-COD-TDOC IN DLC-FLD TO NTR-COD-TDOC IN NTR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-NTR.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-NTR
               IF NTR-IND-VIGE = 'N'
                    MOVE 'COL'        TO MSG-COD-SIST
                    MOVE 'CODNOTCNVG' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-CON-FLD-DLC
               ELSE
                    MOVE SPACES TO MSG-COD-MENS
                                   MSG-GLS-DESC
           ELSE
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'CODNOTGSTNE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC.

           IF PGM-STAT-NTR-OKS AND
              NTR-IND-VIGE NOT = 'N' AND
              NTR-CIC-GNOT IN NTR = 'I'
               IF DLC-VAL-GNOT IN DLC-FLD NOT > ZEROES
                   MOVE 'COL'         TO MSG-COD-SIST
                   MOVE 'VALGNOTZERO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-DLC.

           IF PGM-STAT-NTR-OKS AND
              DLC-VAL-GNOT IN DLC-FLD NOT > ZEROES
                MOVE NTR-VAL-GNOT IN NTR TO DLC-VAL-GNOT IN DLC-FLD.
       NOT-NOTC.
      *DAD ini 22-MAR-1991 
      * Valida que cuando sea Pesos la moneda no acepte valores con decimales
       INI-VAL-PES-DECI.
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB.
           MOVE '0999  ' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC
           ELSE
               IF OPC-COD-VCOC IN OPC NOT = TAB-COD-CTAB IN TAB
                   GO TO FIN-VAL-PES-DECI.

           MOVE DLC-VAL-NDLC IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-NDLC IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE DLC-VAL-IMPU IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-IMPU IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           MOVE DLC-VAL-GNOT IN DLC-FLD TO WSS-VAL-PESO IN WSS-VARI.
           IF DLC-VAL-GNOT IN DLC-FLD > WSS-VAL-PESO IN WSS-VARI
               GO TO MSG-VAL-PES-DECI.

           GO TO FIN-VAL-PES-DECI.
       MSG-VAL-PES-DECI.
           MOVE 'COL'       TO MSG-COD-SIST.
           MOVE 'VALNODECI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-FLD-DLC.
       FIN-VAL-PES-DECI.
*% IF PGM_PER
           IF NOT ( FRM-CIC-TDOC IN DLC-FLD = 'LTR' AND
                    FRM-IND-VSTR IN DLC-FLD = 'N' )
               GO TO SIG-VAL-CON-FLD-DLC.
           MOVE DLC-FEC-FGIR IN DLC-FLD  TO WSS-FEC-FAUX IN WSS-VARI.
           MOVE WSS-NUM-DAUX IN WSS-VARI TO WSS-NUM-DGIR IN WSS-VARI.
           MOVE WSS-NUM-MAUX IN WSS-VARI TO WSS-NUM-MGIR IN WSS-VARI.
           MOVE WSS-NUM-SAUX IN WSS-VARI TO WSS-NUM-SGIR IN WSS-VARI.
           MOVE WSS-NUM-AAUX IN WSS-VARI TO WSS-NUM-AGIR IN WSS-VARI.

           MOVE DLC-FEC-FMAV IN DLC-FLD  TO WSS-FEC-FAUX IN WSS-VARI.
           MOVE WSS-NUM-DAUX IN WSS-VARI TO WSS-NUM-DMAV IN WSS-VARI.
           MOVE WSS-NUM-MAUX IN WSS-VARI TO WSS-NUM-MMAV IN WSS-VARI.
           MOVE WSS-NUM-SAUX IN WSS-VARI TO WSS-NUM-SMAV IN WSS-VARI.
           MOVE WSS-NUM-AAUX IN WSS-VARI TO WSS-NUM-AMAV IN WSS-VARI.

           IF WSS-FEC-FMAV IN WSS-VARI < OPC-FEC-FCOL IN OPC 
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLCFMAV<FCOL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC.
           IF WSS-FEC-FMAV IN WSS-VARI < WSS-FEC-FGIR IN WSS-VARI 
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'DLCFMAV<FGIR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-DLC.
       SIG-VAL-CON-FLD-DLC.
*% END
      *DAD fin  22-MAR-1991 
      *DAD ini  06-AUG-1992   (Memo.22-07-92 Pto.3)
      *     IF FRM-COD-TOSB IN DLC-FLD NOT > SPACES
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *     MOVE 'COL'  TO FIO-SIST.
      *     MOVE 'TCCT' TO MSC-CIC-TMSC IN MSC.
      *     MOVE 'CAP'  TO MSC-CIC-CMSC IN MSC.
      *     MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-MSC.
      *     IF FIO-STAT-OKS
      *         MOVE MSC-COD-CMSC IN MSC TO DCC-MSC-TCCT IN DCC
      *     ELSE
      *         MOVE 'CAP' TO DCC-MSC-TCCT IN DCC.
      *     MOVE OPC-COD-VCOC IN OPC     TO DCC-COD-VCAM IN DCC.
      *     MOVE OPC-COD-COOC IN OPC     TO DCC-COD-COCR IN DCC.
      *     MOVE DLC-COD-PLZO IN DLC-FLD TO DCC-COD-PLZO IN DCC.
      *     MOVE DLC-IND-SCRT IN DLC-FLD TO DCC-IND-SCRT IN DCC.
      *     MOVE DLC-IND-SCTB IN DLC-FLD TO DCC-IND-SCTB IN DCC.
      *     MOVE DLC-IND-SCBZ IN DLC-FLD TO DCC-IND-SCBZ IN DCC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM COL-FIO-DCC.
      *     IF ( NOT FIO-STAT-OKS) OR
      *        DCC-CIC-TCCT IN DCC NOT = FRM-COD-TOSB IN DLC-FLD
      *         MOVE 'COL'        TO MSG-COD-SIST
      *         MOVE 'CODTOSBNEX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *DAD fin  06-AUG-1992
      *     IF DLC-VAL-IMPU IN DLC-FLD > DLC-VAL-DPES IN DLC-FLD
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'VALIMPUDPES>' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *     IF DLC-VAL-GNOT IN DLC-FLD > DLC-VAL-DPES IN DLC-FLD
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'VALGNOTDPES>' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-DLC.
      *>>>>
*% END
