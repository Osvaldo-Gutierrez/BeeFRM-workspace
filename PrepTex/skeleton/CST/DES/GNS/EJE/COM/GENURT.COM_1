$	ON WARNING THEN EXIT
$ P1:
$	IF P1 .NES. "" THEN GOTO MAIN
$	IF F$MODE() .EQS. "BATCH" THEN EXIT
$	INQUIRE P1 "Programa ? "
$	GOTO P1
$ MAIN:
$	IF F$MODE() .EQS. "BATCH" THEN 'BAT'
$	WRITE SYS$OUTPUT "[5m[1m",-
		"			Generando...[0m"
$	@GNSCOM:FIL 'P1' "COB"
$	IF F$MODE() .EQS. "BATCH" THEN SET NOVER
$	FIL = GNS$FIL
$	I = 0
$	TAB = "NO"
$	USR = "NO"
$	CIL = "DES"
$	REL = "DES"
$	SIS = F$EXTRACT(0,3,"''FIL'")
$	TPG = F$EXTRACT(4,1,"''FIL'")
$	REG = F$EXTRACT(5,3,"''FIL'")
$	URT = "''SIS'C''TPG'''REG'"
$	IF SIS .EQS. "GNS" THEN CIL = "GNS"
$	IF SIS .EQS. "GNS" THEN REL = "GNS"
$	SEARC/OUTPUT=TMP:URTCPY'FIL'.TMP 'GNS$PTH' "       COPY"
$	OPEN/WRITE FILE_OPTX TMP:URTPTX'FIL'.TMP
$	WRITE FILE_OPTX "*% MAQ = ""''GNS$MAQ'"""
$	WRITE FILE_OPTX "*% CMQ = ""''GNS$CMQ'"""
$	WRITE FILE_OPTX "*% SIS = ""''SIS'"""
$	WRITE FILE_OPTX "*% REG = ""''REG'"""
$	WRITE FILE_OPTX "*% CIL = ""''CIL'"""
$	WRITE FILE_OPTX "*% REL = ""''REL'"""
$	WRITE FILE_OPTX "*% PGM = ""''FIL'"""
$	WRITE FILE_OPTX "*% URT = ""''URT'"""
$ LEE_CPY:
$	OPEN/READ FILE_COPY TMP:URTCPY'FIL'.TMP
$	READ/END_OF_FILE=CLO_CPY FILE_COPY CPY
$	TPO = F$EXTRACT(15,2,"''CPY'")
$	IF TPO .NES. "BF" THEN GOTO LEE_CPY
$	SIS = F$EXTRACT(12,3,"''CPY'")
$	REG = F$EXTRACT(17,3,"''CPY'")
$!	Se asume 'M' ( Maestro ), en rigor deberia buscar en EDL = 'REG'.EDL
$	SIN = "???"
$	LOGEDL = F$TRNLNM("EDL")
$	A = F$ELEMENT(0,".",LOGEDL)
$	B = F$EXTRACT(F$LOCATE(".",LOGEDL)+1,F$LENGTH(LOGEDL),LOGEDL)
$	C = F$EXTRACT(F$LOCATE(".",B)+5,F$LENGTH(B),B)
$	D = A + ".DES" + GNS$PAI + GNS$CLI + "." + SIS + "."  + C
$	IF F$SEARC("''D'''REG'.EDL") .NES. "" THEN GOTO SEG
$ PAI:
$	D = A + ".DES" + GNS$PAI + "." + SIS + "."  + C
$	IF F$SEARC("''D'''REG'.EDL") .NES. "" THEN GOTO SEG
$ CLI:
$	D = A + ".DES" + "." + SIS + "."  + C
$	IF F$SEARC("''D'''REG'.EDL") .NES. "" THEN GOTO SEG
$	GOTO CON
$ SEG:
$	OPEN/READ FILE_EDL 'D''REG'.EDL
$	READ FILE_EDL REGEDL
$	GRUPO = "$DB" + F$EXTRACT(F$LENGTH(F$EDIT(REGEDL,"TRIM"))-1,1,REGEDL)
$ CLO_EDL:
$	CLOSE FILE_EDL
$	IF GRUPO .EQS. "$DBM" THEN SIN = '''SIS'$DBM'
$	IF GRUPO .EQS. "$DBC" THEN SIN = '''SIS'$DBC'
$	IF GRUPO .EQS. "$DBT" THEN SIN = '''SIS'$DBT'
$	IF GRUPO .EQS. "$DBS" THEN SIN = '''SIS'$DBS'
$!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
$ CON:
$	IF ( TAB .EQS. "SI" ) .AND. ( SIS .EQS. "GNS" ) .AND.            -
	   ( REG .EQS. "TAB" .OR. REG .EQS. "MSC" .OR. REG .EQS. "MSG" ) -
		THEN GOTO LEE_CPY
$	IF ( TAB .EQS. "NO" ) .AND. ( SIS .EQS. "GNS" ) .AND.            -
	   ( REG .EQS. "TAB" .OR. REG .EQS. "MSC" .OR. REG .EQS. "MSG" ) -
		THEN GOTO PRO_TAB
$	GOSUB GEN_PTX
$	GOTO LEE_CPY
$ PRO_TAB:
$	GOSUB GEN_TAB
$	GOTO LEE_CPY
$ CLO_CPY:
$	CLOSE FILE_COPY
$	DELETE TMP:URTCPY'FIL'.TMP;*
$	WRITE FILE_OPTX "*% NRG = ''I'"
$
$	@GNSCOM:BUSFIL GNSCLURT.COMAIO /ALL
$	WRITE FILE_OPTX "*% INCLUDE '" + GNS$ARC + "'"
$
$	CLOSE FILE_OPTX
$	PTX TMP:URTPTX'FIL'.TMP 'URT'.COMAIO/CONTROL="*%"/NOSHOW
$	DELETE  TMP:URTPTX'FIL'.TMP;*
$	WRITE SYS$OUTPUT "[A[2K"
$	WRITE SYS$OUTPUT "[1m",-
		"			''URT'.COMAIO Generado[0m"
$	EXIT
$ GEN_TAB:
$	REG = "TAB"
$	SIS = "GNS"
$	SIN = 'GNS$DBC'
$	GOSUB GEN_PTX
$	SIS = "TAB"
$	SIN = 'TAB$DBC'
$	GOSUB GEN_PTX
$!RGL	SIS = "SGC"
$!RGL	SIN = 'SGC$DBC'
$!RGL	GOSUB GEN_PTX
$!RGL	SIS = "DEU"
$!RGL	SIN = 'DEU$DBC'
$!RGL	GOSUB GEN_PTX
$!RGL	SIS = "LDC"
$!RGL	SIN = 'LDC$DBC'
$!RGL	GOSUB GEN_PTX
$	SIS = "COL"
$	SIN = 'COL$DBC'
$	GOSUB GEN_PTX
$!RGL	SIS = "GAR"
$!RGL	SIN = 'GAR$DBC'
$!RGL	GOSUB GEN_PTX
$!	SIS = "SUP"
$!	SIN = 'SUP$DBC'
$!	GOSUB GEN_PTX
$	TAB = "SI"
$	RETURN
$ GEN_PTX:
$	DBN = SIN
$	I = I + 1
$	WRITE FILE_OPTX "*% SS''I' = ""''SIS'"""
$	WRITE FILE_OPTX "*% RG''I' = ""''REG'"""
$	WRITE FILE_OPTX "*% DB''I' = ""''DBN'"""
$	RETURN
