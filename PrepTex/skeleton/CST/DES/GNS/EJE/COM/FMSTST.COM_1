$	IF F$MODE() .EQS. "BATCH" THEN EXIT
$ P1:
$	WRITE SYS$OUTPUT "Procedimiento para imprimir la especificacion usuaria de un formulario :"
$	WRITE SYS$OUTPUT "con  su  dibujo ( 'order' )  y  datos  de   documentacion ( 'test' ),"
$	WRITE SYS$OUTPUT "asume que a cada formulario que se presente se daran dos 'hard copy'"
$	WRITE SYS$OUTPUT "uno con el 'order' y otro con el 'test'."
$	WRITE SYS$OUTPUT ""
$
$	WRITE SYS$OUTPUT "Formularios ( Si digita RETURN asume toda la biblioteca de Formularios )"
$	INQUIRE P1 "_? "
$
$	IF P1 .EQS. "" THEN -
	   FMSDIR /OUTPUT=FMS.LIS
$	IF P1 .NES. "" THEN -
	   DIRECTORY/NOTRAILING/NOHEADER/NOOWNER/NOPROTECTION/NODATE/NOSIZE -
	   /COLUMN=1/VERSION=1/OUTPUT=FMS.LIS/EXC=FMS.LIS 'P1'
$	IF P1 .EQS. "" THEN CMD = "FMS/EDIT FMS/FORM="
$	IF P1 .NES. "" THEN CMD = "FMS/EDIT "
$
$ P2:
$	INQUIRE P2 "Desea hacer seleccion de archivos [S/N] ? "
$	IF P2 .EQS. "S" THEN GOTO EDT
$	IF P2 .EQS. "N" THEN GOTO P3
$	GOTO P2
$ EDT:
$	DEFINE/NOLOG SYS$INPUT SYS$COMMAND
$	EDIT FMS.LIS
$ P3:
$	INQUIRE P3 "Desea hacer Order/Test o Ambos [O/T/A] ? "
$	IF P3 .EQS. "" THEN P3 = "A"
$	IF P3 .EQS. "O" .OR. P3 .EQS. "T" .OR. P3 .EQS. "A" THEN GOTO MAIN
$	GOTO P3
$ MAIN:
$
$	ON WARNING   THEN GOTO FIN
$	ON CONTROL_Y THEN GOTO FIN
$	OPEN/READ  FILE_INPUT  FMS.LIS
$	ON WARNING   THEN GOTO CLO
$	ON CONTROL_Y THEN GOTO CLO
$	IF P1 .NES. "" THEN GOTO LEE
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$ LEE:
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	IF P1 .EQS. "" THEN FRM = F$ELEMENT(0," ",REG)
$	GNS$EXT :== ""
$	IF P1 .NES. "" THEN @GNSCOM:FIL 'REG' "FRM"
$	IF P1 .NES. "" .AND. GNS$EXT .NES. "FRM" THEN GOTO LEE
$	IF P1 .NES. "" THEN FRM = "''GNS$FIL'.''GNS$EXT'"
$	DEFINE/NOLOG SYS$INPUT SYS$COMMAND
$	'CMD' 'FRM'
$	INQUIRE P4 " Salta la impresora ? s/* "
$	IF P4 .NES. "S" THEN GOTO LEE
$	GOSUB SKP
$	GOTO LEE
$ CLO:
$	CLOSE FILE_INPUT
$ FIN:
$	DELETE/NOLOG/NOCONFIRM FMS.LIS;*
$	EXIT
$ SKP:
$	WRITE SYS$OUTPUT " [5i "
$	I = 0
$ LUP:
$	WRITE SYS$OUTPUT ""
$	I = I + 1
$	IF P3 .EQS. "T" .OR. P3 .EQS. "O" THEN IF I .NES. 41 THEN GOTO LUP
$	IF P3 .EQS. "A"                   THEN IF I .NES. 17 THEN GOTO LUP
$	WRITE SYS$OUTPUT " [4i "
$	RETURN
