$	IF F$MODE() .EQS. "BATCH" THEN EXIT
$ P1:
$	WRITE SYS$OUTPUT "Procedimiento para imprimir la especificacion usuaria de un reporte :"
$	WRITE SYS$OUTPUT "con  su  dibujo ( 'order' )  y  datos  de   documentacion ( 'test' ),"
$	WRITE SYS$OUTPUT "asume que a cada reporte que se presente se daran dos 'hard copy' uno"
$	WRITE SYS$OUTPUT "con el 'order' y otro con el 'test'."
$	WRITE SYS$OUTPUT ""
$
$	WRITE SYS$OUTPUT "Reportes ( Si digita RETURN asume toda la biblioteca de Reportes)"
$	INQUIRE P1 "_? "
$
$	IF P1 .EQS. "" THEN -
	   RPTDIR /OUTPUT=RPT.LIS
$	IF P1 .NES. "" THEN -
	   DIRECTORY/NOTRAILING/NOHEADER/NOOWNER/NOPROTECTION/NODATE/NOSIZE -
	   /COLUMN=1/VERSION=1/OUTPUT=RPT.LIS/EXC=RPT.LIS 'P1'
$	IF P1 .EQS. "" THEN CMD = "FMS/EDIT RPT/FORM="
$	IF P1 .NES. "" THEN CMD = "FMS/EDIT "
$
$ P2:
$	TYPE RPT.LIS
$	INQUIRE P2 "Desea hacer seleccion de estos archivos [S/N] ? "
$	IF P2 .EQS. "S" THEN GOTO EDT
$	IF P2 .EQS. "N" THEN GOTO P3
$	GOTO P2
$ EDT:
$	DEFINE/NOLOG SYS$INPUT SYS$COMMAND
$	EDIT RPT.LIS
$ P3:
$	INQUIRE P3 "Desea hacer Order/Test o Ambos [O/T/A] ? "
$	IF P3 .EQS. "" THEN P3 = "A"
$	IF P3 .EQS. "O" .OR. P3 .EQS. "T" .OR. P3 .EQS. "A" THEN GOTO MAIN
$	GOTO P3
$ MAIN:
$
$	ON WARNING   THEN GOTO FIN
$	ON CONTROL_Y THEN GOTO FIN
$	OPEN/READ  FILE_INPUT  RPT.LIS
$	ON WARNING   THEN GOTO CLO
$	ON CONTROL_Y THEN GOTO CLO
$	IF P1 .NES. "" THEN GOTO LEE
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$ LEE:
$	READ/END_OF_FILE=CLO FILE_INPUT REG
$	IF P1 .EQS. "" THEN FRM = F$ELEMENT(0," ",REG)
$	GNS$EXT :== ""
$	IF P1 .NES. "" THEN @GNSCOM:FIL 'REG' "RPT"
$	IF P1 .NES. "" .AND. GNS$EXT .NES. "RPT" THEN GOTO LEE
$	IF P1 .NES. "" THEN FRM = "''GNS$FIL'.''GNS$EXT'"
$	OUT = ""
$	IF P1 .EQS. "" THEN OUT = "/OUTPUT=''FRM'.RPT"
$	DEFINE/NOLOG SYS$INPUT SYS$COMMAND
$	'CMD' 'FRM''OUT'
$	INQUIRE P4 " Salta la impresora ? s/* "
$	IF P4 .NES. "S" THEN GOTO LEE
$	GOSUB SKP
$	GOTO LEE
$ CLO:
$	CLOSE FILE_INPUT
$ FIN:
$	DELETE/NOLOG/NOCONFIRM RPT.LIS;*
$	EXIT
$ SKP:
$	WRITE SYS$OUTPUT " [5i "
$	I = 0
$ LUP:
$	WRITE SYS$OUTPUT ""
$	I = I + 1
$	IF P3 .EQS. "T" .OR. P3 .EQS. "O" THEN IF I .NES. 41 THEN GOTO LUP
$	IF P3 .EQS. "A"                   THEN IF I .NES. 17 THEN GOTO LUP
$	WRITE SYS$OUTPUT " [4i "
$	RETURN
