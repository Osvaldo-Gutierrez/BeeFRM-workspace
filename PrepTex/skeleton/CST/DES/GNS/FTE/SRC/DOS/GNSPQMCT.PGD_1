       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GNSPQMCT.
       AUTHOR. CONSIST.
       DATE-WRITTEN.    1-AUG-1989 21:59:50
      *Mini-cartola via FAX.
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWGSCR.
       COPY GNSWCFIO.
        COPY GNSWVFIO.
       COPY GNSBRDML.
       COPY GNSBRTAB.
       COPY GNSWGFRM.
      *<<<< WSS
       COPY GNSWIMC1.
       COPY GNSWIHFX.
       COPY GNSWITFX.
       COPY GNSWIVRS.
       COPY GNSWGHOY.
       COPY GNSWGQUE.
       COPY GNSWGSYS.
       COPY GNSWGFCR.
       01  IFD.
           03  FILLER                            PIC X(01).
           03  IFD-COD-CIFD                      PIC X(12).
           03  IFD-GLS-DATA                      PIC X(210).
           03  FILLER                            PIC X(18).
       01  WSS-VARI.
           03 WSS-I                                   PIC 9(02).
           03 WSS-J                                   PIC 9(02).
           03 WSS-OLD-IFAX.
              05 WSS-TAB-IFAX OCCURS 12.
                 07 WSS-IND-OFAX                      PIC X(01).
           03 WSS-NEW-IFAX.
              05 WSS-TAB-NFAX  OCCURS 12.
                 07 WSS-IND-NFAX                      PIC X(01).
           03 WSS-HOY.
              05 WSS-X              VALUE 'X'         PIC X(01).
      *       05 WSS-DIA-HOY                          PIC 9(02).
              05 WSS-HRA-HOY                          PIC 9(06).
           03 I                                       PIC 9(02).
           03 WSS-IMAX                                PIC 9(04).
           03 WSS-DMA-FECM.
              05 WSS-NUM-DECM                         PIC 9(02).
              05 WSS-NUM-MECM                         PIC 9(02).
              05 WSS-NUM-AECM                         PIC 9(02).
           03 WSS-GLS-FEC2.
              05 WSS-NUM-DIA                          PIC 9(02).
              05 FILLER          VALUE '/'            PIC X(01).
              05 WSS-NUM-MES                          PIC 9(02).
      *        05 FILLER          VALUE '/'            PIC X(01).
      *        05 WSS-NUM-ANO                          PIC 9(02).
           03 WSS-FEC-FHOY                            PIC 9(06).
           03 WSS-GLS-FECH.
              05 WSS-NUM-DHOY                         PIC X(02).
              05 FILLER          VALUE '/'            PIC X(01).
              05 WSS-NUM-MHOY                         PIC X(02).
              05 FILLER          VALUE '/'            PIC X(01).
              05 WSS-NUM-SHOY                         PIC X(02).
              05 WSS-NUM-AHOY                         PIC X(02).
      ********************************
           03  WSS-ICTL.
               05  WSS-IHDR                            PIC X(01).
               05  WSS-ITRL                            PIC X(01).
               05  WSS-IDEL                            PIC X(01).
               05  WSS-KEYS.
                   07  WSS-KNXT                        PIC X(01).
                   07  WSS-KPRV                        PIC X(01).
                   07  WSS-KRET                        PIC X(01).
               05  WSS-TPRO.
                   07 WSS-NPRO                         PIC X(02).
                   07 WSS-FLGR                         PIC X(01).
               05  FILLER                              PIC X(21).
           03  WSS-MAPA.
               05 WSS-NMAP                             PIC X(07).
               05 WSS-LMAP                             PIC X(07).
               05 WSS-ICLR                   VALUE ' ' PIC X(01).
                  88  WSS-ICLR-ALL           VALUE 'A', ' '.
                  88  WSS-ICLR-FRM           VALUE 'F'.
                  88  WSS-ICLR-NOT           VALUE 'N'.
               05 WSS-LINI                             PIC 9(02).
               05 WSS-LFIN                             PIC 9(02).
               05 WSS-FCUR                             PIC 9(02).
               05 WSS-CCUR                             PIC 9(02).
               05 WSS-TMAP                             PIC X(01).
               05 FILLER                               PIC X(06).
               05 WSS-DMAP                             PIC X(2000).
           03 WSS-IKEY.
              05 WSS-IOF1                             PIC X(10).
              05 WSS-IOF2                             PIC X(10).
              05 WSS-IOF3                             PIC X(10).
              05 WSS-IOF4                             PIC X(10).
              05 WSS-IOF5                             PIC X(10).
              05 WSS-IOF6.
                 07 WSS-SOF6                          PIC 9(02).
                 07 WSS-AOF6                          PIC 9(02).
                 07 WSS-MOF6                          PIC 9(02).
                 07 WSS-DOF6                          PIC 9(02).
              05 WSS-GLS-NFAX                         PIC X(10).
              05 WSS-NUM-RFBY                         PIC X(01).
      *>>>>
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                             PIC X(69).
       COPY GNSLGFIO.
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
           IF EIBCALEN = 0
               GOBACK
           ELSE
               MOVE DFHCOMMAREA TO WSS-IKEY.
           PERFORM CIC-ERR THRU FIN-CIC-ERR.
           PERFORM BUS-FSIS.
      *     ENTRY 'DBMSCBL'.
           PERFORM GNS-ERR-QUE.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE QUE-DEL   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE WSS-NUM-RFBY TO TFX-NUM-RFBY IN TFX-FLD.
           PERFORM GET-FHOY.
      *    MOVE HOY-DHOY TO WSS-DIA-HOY IN WSS-VARI.
           MOVE HOY-HHOY TO WSS-HRA-HOY IN WSS-VARI.
           MOVE WSS-IOF1     TO DML-COD-IOF1 IN DML.
           MOVE WSS-IOF2     TO DML-COD-IOF2 IN DML.
           MOVE WSS-IOF3     TO DML-COD-IOF3 IN DML.
           MOVE WSS-IOF4     TO DML-COD-IOF4 IN DML.
           MOVE WSS-IOF5     TO DML-COD-IOF5 IN DML.
           MOVE WSS-DOF6     TO DML-NUM-DDML IN DML.
           MOVE WSS-MOF6     TO DML-NUM-MDML IN DML.
           MOVE WSS-SOF6     TO DML-NUM-SDML IN DML.
           MOVE WSS-AOF6     TO DML-NUM-ADML IN DML.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-DML.
           IF NOT FIO-STAT-OKS
               PERFORM NO-ENV-FAX
               GO TO PROC-DMQ.
           PERFORM GNS-RCV-MC1.
           PERFORM GNS-PUT-TFX.
           MOVE WSS-HOY IN WSS-VARI TO TFX-GLS-FXID IN TFX-FLD.
           MOVE 'N'   TO WSS-IHDR.
           MOVE 'N'   TO WSS-ITRL.
           MOVE 'S'   TO WSS-IDEL.
           MOVE '1'   TO WSS-KNXT.
           MOVE '7'   TO WSS-KPRV.
           MOVE '3'   TO WSS-KRET.
           MOVE 'FX'  TO WSS-NPRO.
           MOVE  TFX-NUM-RFBY IN TFX-FLD TO WSS-FLGR.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 1         TO QUE-NITM.
           MOVE WSS-ICTL  TO QUE-ITEM.
           MOVE +30       TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'A' TO WSS-ICLR.
           MOVE 01  TO WSS-LINI.
           MOVE 21  TO WSS-LFIN.
           MOVE 00  TO WSS-FCUR.
           MOVE 00  TO WSS-CCUR.
           MOVE SPACES TO WSS-TMAP.
           MOVE 'GNSFMC1' TO WSS-NMAP.
           MOVE 'GNSAMC1' TO WSS-LMAP.
           MOVE MC1-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 2         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'N' TO WSS-ICLR.
           MOVE 22  TO WSS-LINI.
           MOVE 23  TO WSS-LFIN.
           MOVE 'T' TO WSS-TMAP.
           MOVE -1 TO TFX-COD-IFAX-LEN IN TFX-FLD.
           MOVE 'GNSFTFX' TO WSS-NMAP.
           MOVE 'GNSATFX' TO WSS-LMAP.
           MOVE TFX-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 3         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 0 TO TFX-COD-IFAX-LEN IN TFX-FLD.
           MOVE 'A' TO WSS-ICLR.
           MOVE 01  TO WSS-LINI.
           MOVE 21  TO WSS-LFIN.
           MOVE 01  TO WSS-FCUR.
           MOVE 02  TO WSS-CCUR.
           MOVE SPACES TO WSS-TMAP.
           MOVE 'A' TO HFX-GLS-FLD1 IN HFX-FLD.
           MOVE 'GNSFHFX' TO WSS-NMAP.
           MOVE 'GNSAHFX' TO WSS-LMAP.
           MOVE HFX-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 4         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'N' TO WSS-ICLR.
           MOVE 22  TO WSS-LINI.
           MOVE 23  TO WSS-LFIN.
           MOVE 'T' TO WSS-TMAP.
           PERFORM GNS-PUT-TFX.
           MOVE 'GNSFTFX' TO WSS-NMAP.
           MOVE 'GNSATFX' TO WSS-LMAP.
           MOVE TFX-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 5         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       PROC-DMQ.
           MOVE 'GNSPPDMQ'   TO FRM-PROG.
           MOVE DFHCOMMAREA  TO FRM-CMMA.
           MOVE EIBCALEN     TO FRM-TCMA.
           MOVE FRM-XCT      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           GOBACK.
       FIN-MAIN.
           EXIT.
       GNS-RCV-MC1 SECTION.
       INI-GNS-RCV-MC1.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO WSS-NUM-DHOY IN WSS-VARI.
           MOVE HOY-MHOY IN HOY-VARI TO WSS-NUM-MHOY IN WSS-VARI.
           MOVE HOY-AHOY IN HOY-VARI TO WSS-NUM-AHOY IN WSS-VARI.
           MOVE HOY-SHOY IN HOY-VARI TO WSS-NUM-SHOY IN WSS-VARI.
           MOVE WSS-GLS-FECH IN WSS-VARI TO FRM-GLS-FECH IN MC1-FLD.
           MOVE HOY-HHHY IN HOY-VARI TO FRM-NUM-HHHY IN MC1-FLD.
           MOVE HOY-MMHY IN HOY-VARI TO FRM-NUM-MMHY IN MC1-FLD.
           MOVE HOY-SSHY IN HOY-VARI TO FRM-NUM-SSHY IN MC1-FLD.
           MOVE WSS-IOF3               TO FRM-NUM-NCCT IN MC1-FLD.
           MOVE FRM-NUM-NCCT IN MC1-FLD TO WSS-OLD-IFAX IN WSS-VARI.
           PERFORM PRO-FAX0.
           MOVE WSS-NEW-IFAX IN WSS-VARI TO FRM-NUM-NCCT IN MC1-FLD.
           MOVE DML-VAL-OUFL IN DML(1) TO DML-VAL-OUFL IN MC1-FLD(1).
           MOVE DML-VAL-OUFL IN DML(2) TO DML-VAL-OUFL IN MC1-FLD(2).
           MOVE DML-VAL-OUFL IN DML(3) TO DML-VAL-OUFL IN MC1-FLD(3).
           MOVE DML-VAL-OUFL IN DML(4) TO DML-VAL-OUFL IN MC1-FLD(4).
           MOVE DML-VAL-OUFL IN DML(5) TO DML-VAL-OUFL IN MC1-FLD(5).
           MOVE DML-VAL-OUFL IN DML(6) TO DML-VAL-OUFL IN MC1-FLD(6).
           MOVE DML-VAL-OUFL IN DML(7) TO DML-VAL-OUFL IN MC1-FLD(7).
           MOVE DML-VAL-OUFL IN DML(8) TO DML-VAL-OUFL IN MC1-FLD(8).
           MOVE DML-VAL-OUFL IN DML(9) TO DML-VAL-OUFL IN MC1-FLD(9).
           MOVE DML-VAL-OUFL IN DML(10) TO DML-VAL-OUFL IN MC1-FLD(10).
       FIN-GNS-RCV-MC1.
           EXIT.
       GNS-PUT-TFX SECTION.
       INI-GNS-PUT-TFX.
           MOVE 'GNS'      TO FIO-SIST.
           MOVE 'VRP'      TO TAB-COD-TTAB IN TAB.
           MOVE 'GNSPQMCT' TO FCR-PVRP.
           MOVE 'DCR'      TO FCR-FVRP.
           MOVE FCR-CTVR TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DESC IN TAB TO FCR-DESC
               MOVE TAB-GLS-DATA IN TAB TO FCR-DATA
               GO TO CON-PUT-TFX.
           MOVE 'GNS'   TO FIO-SIST.
           MOVE 'VRP'   TO TAB-COD-TTAB IN TAB.
           MOVE '*/DCR' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DESC IN TAB TO FCR-DESC
               MOVE TAB-GLS-DATA IN TAB TO FCR-DATA
           ELSE
               MOVE SPACES TO FCR-DESC
               MOVE SPACES TO FCR-DATA.
       CON-PUT-TFX.
           MOVE FCR-PBXE  TO TFX-GLS-PBXE IN TFX-FLD.
           MOVE FCR-FVMU  TO TFX-GLS-FVMU IN TFX-FLD.
           MOVE FCR-ASDT  TO TFX-NUM-ASDT IN TFX-FLD.
           MOVE FCR-NTRI  TO TFX-NUM-NTRI IN TFX-FLD.
           MOVE FCR-TFKY  TO TFX-GLS-TFKY IN TFX-FLD.
           MOVE FCR-FKY5  TO TFX-GLS-FKY5 IN TFX-FLD.
           MOVE FCR-FKY6  TO TFX-GLS-FKY6 IN TFX-FLD.
           MOVE FCR-EPFK  TO TFX-GLS-EPFK IN TFX-FLD.
           MOVE FCR-RPFK  TO TFX-GLS-RPFK IN TFX-FLD.
           MOVE FCR-SOFL  TO TFX-NUM-SOFL IN TFX-FLD.
           MOVE FCR-HMSG  TO TFX-GLS-HMSG IN TFX-FLD.
           MOVE FCR-LFLG  TO TFX-GLS-LFLG IN TFX-FLD.
           MOVE FCR-FKY9  TO TFX-GLS-FKY9 IN TFX-FLD.
           MOVE FCR-FKY0  TO TFX-GLS-FKY0 IN TFX-FLD.
           MOVE FCR-TOLN  TO TFX-NUM-TOLN IN TFX-FLD.
           MOVE FCR-MRLN  TO TFX-NUM-MRLN IN TFX-FLD.
           MOVE FCR-MTLN  TO TFX-NUM-MTLN IN TFX-FLD.
           MOVE FCR-DFEF  TO TFX-GLS-DFEF IN TFX-FLD.
      *    MOVE FCR-RFBY  TO TFX-NUM-RFBY IN TFX-FLD.
           IF TFX-NUM-RFBY IN TFX-FLD = '1'
               MOVE '0' TO TFX-NUM-RFBY IN TFX-FLD
           ELSE
               MOVE '1' TO TFX-NUM-RFBY IN TFX-FLD.
           MOVE 'GNS'      TO FIO-SIST.
           MOVE 'VRP'      TO TAB-COD-TTAB IN TAB.
           MOVE 'GNSPQMCT' TO FCR-PVRP.
           MOVE 'FCR'      TO FCR-FVRP.
           MOVE FCR-CTVR TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DESC IN TAB TO FCR-DESC
               MOVE TAB-GLS-DATA IN TAB TO FCR-DATA
               GO TO NXT-PUT-TFX.
           MOVE 'GNS'   TO FIO-SIST.
           MOVE 'VRP'   TO TAB-COD-TTAB IN TAB.
           MOVE '*/FCR' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DESC IN TAB TO FCR-DESC
               MOVE TAB-GLS-DATA IN TAB TO FCR-DATA
           ELSE
               MOVE SPACES TO FCR-DESC
               MOVE SPACES TO FCR-DATA.
       NXT-PUT-TFX.
      *     MOVE FCR-FXID  TO TFX-GLS-FXID IN TFX-FLD.
           MOVE FCR-FXPN  TO TFX-GLS-FXPN IN TFX-FLD.
           MOVE FCR-FXNP  TO TFX-GLS-FXNP IN TFX-FLD.
           MOVE FCR-FXSK  TO TFX-GLS-FXSK IN TFX-FLD.
           MOVE FCR-FXTT  TO TFX-GLS-FXTT IN TFX-FLD.
           MOVE FCR-FXRC  TO TFX-GLS-FXRC IN TFX-FLD.
           MOVE FCR-FXLF  TO TFX-GLS-FXLF IN TFX-FLD.
           MOVE FCR-FXSI  TO TFX-GLS-FXSI IN TFX-FLD.
           MOVE FCR-FXAT  TO TFX-GLS-FXAT IN TFX-FLD.
           MOVE FCR-FXSP  TO TFX-GLS-FXSP IN TFX-FLD.
           MOVE FCR-FXFF  TO TFX-GLS-FXFF IN TFX-FLD.
           MOVE FCR-IFAX  TO TFX-COD-IFAX IN TFX-FLD.
      *
           MOVE WSS-GLS-NFAX TO WSS-OLD-IFAX IN WSS-VARI.
           PERFORM PRO-FAX0.
           MOVE WSS-NEW-IFAX IN WSS-VARI TO WSS-GLS-NFAX.
      *JSS
           IF FCR-FXP2 = ';'
               MOVE WSS-GLS-NFAX TO FCR-EXTE
               MOVE FCR-FXPN     TO TFX-GLS-FXPN IN TFX-FLD
           ELSE
           IF FCR-FXPN > SPACES
               MOVE FCR-FXPN     TO TFX-GLS-FXPN IN TFX-FLD
           ELSE
               MOVE WSS-GLS-NFAX TO TFX-GLS-FXPN IN TFX-FLD.
      *
       FIN-GNS-PUT-TFX.
           EXIT.
       NO-ENV-FAX SECTION.
       INI-NO-ENV-FAX.
           PERFORM GNS-PUT-TFX.
           PERFORM GET-FHOY.
      *    MOVE HOY-DHOY TO WSS-DIA-HOY IN WSS-VARI.
           MOVE HOY-HHOY TO WSS-HRA-HOY IN WSS-VARI.
           MOVE WSS-HOY IN WSS-VARI TO TFX-GLS-FXID IN TFX-FLD.
           MOVE 'N'   TO WSS-IHDR.
           MOVE 'N'   TO WSS-ITRL.
           MOVE 'S'   TO WSS-IDEL.
           MOVE '1'   TO WSS-KNXT.
           MOVE '7'   TO WSS-KPRV.
           MOVE '3'   TO WSS-KRET.
           MOVE 'FX'  TO WSS-NPRO.
           MOVE  TFX-NUM-RFBY IN TFX-FLD TO WSS-FLGR.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 1         TO QUE-NITM.
           MOVE WSS-ICTL  TO QUE-ITEM.
           MOVE +30       TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'A' TO WSS-ICLR.
           MOVE 01  TO WSS-LINI.
           MOVE 21  TO WSS-LFIN.
           MOVE 02  TO WSS-FCUR.
           MOVE 02  TO WSS-CCUR.
           MOVE SPACES TO WSS-TMAP.
           MOVE LOW-VALUES TO VRS-FLD.
           MOVE 'A'    TO VRS-GLS-VFLD(1).
           MOVE 'GNS'   TO FIO-SIST.
           MOVE 'MSG'   TO TAB-COD-TTAB IN TAB.
           MOVE 'FAX    NENV' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-ABRV TO VRS-GLS-VFLD(6)
           ELSE
               MOVE 'M139' TO VRS-GLS-VFLD(6).
           MOVE 'GNSFVRS' TO WSS-NMAP.
           MOVE 'GNSAVRS' TO WSS-LMAP.
           MOVE VRS-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 2         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'N' TO WSS-ICLR.
           MOVE 22  TO WSS-LINI.
           MOVE 23  TO WSS-LFIN.
           MOVE 'T' TO WSS-TMAP.
           MOVE 'GNSFTFX' TO WSS-NMAP.
           MOVE 'GNSATFX' TO WSS-LMAP.
           MOVE TFX-FLD   TO WSS-DMAP.
           MOVE EIBTRMID  TO QUE-TERM.
           MOVE 'MAP'     TO QUE-TYPE.
           MOVE 3         TO QUE-NITM.
           MOVE WSS-MAPA  TO QUE-ITEM.
           MOVE +3000     TO QUE-LITM.
           MOVE QUE-PUT   TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-NO-ENV-FAX.
           EXIT.
       BUS-FSIS SECTION.
       INI-BUS-FSIS.
           MOVE 'GNSVQMCT' TO IFD-COD-CIFD IN IFD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IFD.
           IF NOT FIO-STAT-OKS
               MOVE 'DEFAULT' TO IFD-COD-CIFD IN IFD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-IFD
               MOVE IFD-GLS-DATA IN IFD TO IFD-FSIS
           ELSE
               MOVE IFD-GLS-DATA IN IFD TO IFD-FSIS.
       FIN-BUS-FSIS.
           EXIT.
       PRO-FAX0 SECTION.
       INI-PRO-FAX0.
            MOVE 0 TO WSS-I.
            MOVE 1 TO WSS-J.
       LUP-FAX0.
            ADD 1 TO WSS-I.
            IF WSS-I > 12
                GO TO FIN-PRO-FAX0.
            IF WSS-IND-OFAX (WSS-I) = '0'
                GO TO LUP-FAX0.
       LUP-TRA-FAX.
            MOVE WSS-IND-OFAX(WSS-I) TO WSS-IND-NFAX (WSS-J).
            ADD 1 TO WSS-J.
            ADD 1 TO WSS-I.
            IF WSS-I NOT > 12
                GO TO LUP-TRA-FAX.
       LUP-FAXS.
            IF WSS-J > 12
                GO TO FIN-PRO-FAX0.
            MOVE SPACES TO WSS-IND-NFAX (WSS-J).
            ADD 1 TO WSS-J.
            GO TO LUP-FAXS.
       FIN-PRO-FAX0.
           EXIT.
      *
       COPY GNSBGHOY.
       COPY GNSBGQUE.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBFDML.
       COPY GNSBFTAB.
       COPY GNSBFIFD.
       COPY GNSBGVSM.
       COPY GNSBECIC.
       COPY GNSBGFRM.
      * COPY GNSBGDSP.
