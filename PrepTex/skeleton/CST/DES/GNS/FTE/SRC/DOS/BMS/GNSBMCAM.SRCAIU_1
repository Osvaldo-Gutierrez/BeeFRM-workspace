      * 11-Dec-89 12:19 PM
       PUT-ALL-CAM SECTION.
       INI-PUT-ALL-CAM.
           PERFORM PUT-TAB-CAM.
           PERFORM PUT-CAM-CAM.
       FIN-PUT-ALL-CAM.
           EXIT.
       
       PUT-TAB-CAM SECTION.
       INI-PUT-TAB-CAM.
           IF PGM-STAT-TAB-NUL
               GO TO FIN-PUT-TAB-CAM.
           IF NOT PGM-STAT-TAB-OKS
               PERFORM CLR-TAB-CAM
               GO TO FIN-PUT-TAB-CAM.
           MOVE TAB-COD-CTAB IN TAB TO TAB-COD-CTAB IN CAM-FLD.
       FIN-PUT-TAB-CAM.
           EXIT.
       
       PUT-CAM-CAM SECTION.
       INI-PUT-CAM-CAM.
           IF PGM-STAT-CAM-NUL
               GO TO FIN-PUT-CAM-CAM.
           IF NOT PGM-STAT-CAM-OKS
               PERFORM CLR-CAM-CAM
               GO TO FIN-PUT-CAM-CAM.
      *
      *    CAMPO INDEXADO   CAM-MSC-TVAL
           MOVE CAM-MSC-TVAL IN CAM(1) TO CAM-MSC-TVAL IN CAM-FLD(1).
           MOVE CAM-MSC-TVAL IN CAM(2) TO CAM-MSC-TVAL IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-COD-CVAL
           MOVE CAM-COD-CVAL IN CAM(1) TO CAM-COD-CVAL IN CAM-FLD(1).
           MOVE CAM-COD-CVAL IN CAM(2) TO CAM-COD-CVAL IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-COD-TCAM
           MOVE CAM-COD-TCAM IN CAM(1) TO CAM-COD-TCAM IN CAM-FLD(1).
           MOVE CAM-COD-TCAM IN CAM(2) TO CAM-COD-TCAM IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-NUM-DCAM
           MOVE CAM-NUM-DCAM IN CAM(1) TO CAM-NUM-DCAM IN CAM-FLD(1).
           MOVE CAM-NUM-DCAM IN CAM(2) TO CAM-NUM-DCAM IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-NUM-MCAM
           MOVE CAM-NUM-MCAM IN CAM(1) TO CAM-NUM-MCAM IN CAM-FLD(1).
           MOVE CAM-NUM-MCAM IN CAM(2) TO CAM-NUM-MCAM IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-NUM-SCAM
           MOVE CAM-NUM-SCAM IN CAM(1) TO CAM-NUM-SCAM IN CAM-FLD(1).
           MOVE CAM-NUM-SCAM IN CAM(2) TO CAM-NUM-SCAM IN CAM-FLD(2).
      *
      *    CAMPO INDEXADO   CAM-NUM-ACAM
           MOVE CAM-NUM-ACAM IN CAM(1) TO CAM-NUM-ACAM IN CAM-FLD(1).
           MOVE CAM-NUM-ACAM IN CAM(2) TO CAM-NUM-ACAM IN CAM-FLD(2).
           MOVE CAM-SGV-VCAM IN CAM TO CAM-SGV-VCAM IN CAM-FLD.
           MOVE CAM-IND-VIGE IN CAM TO CAM-IND-VIGE IN CAM-FLD.
           MOVE CAM-NUM-DTRN IN CAM TO CAM-NUM-DTRN IN CAM-FLD.
           MOVE CAM-NUM-MTRN IN CAM TO CAM-NUM-MTRN IN CAM-FLD.
           MOVE CAM-NUM-STRN IN CAM TO CAM-NUM-STRN IN CAM-FLD.
           MOVE CAM-NUM-ATRN IN CAM TO CAM-NUM-ATRN IN CAM-FLD.
       FIN-PUT-CAM-CAM.
           EXIT.
       
       RET-ALL-CAM SECTION.
       INI-RET-ALL-CAM.
           PERFORM KEY-ALL-CAM.
           PERFORM RET-TAB-CAM.
           PERFORM RET-CAM-CAM.
       FIN-RET-ALL-CAM.
           EXIT.
       
       RET-TAB-CAM SECTION.
       INI-RET-TAB-CAM.
       FIN-RET-TAB-CAM.
           EXIT.
       
       RET-CAM-CAM SECTION.
       INI-RET-CAM-CAM.
           MOVE CAM-SGV-VCAM IN CAM-FLD TO CAM-SGV-VCAM IN CAM.
           MOVE CAM-IND-VIGE IN CAM-FLD TO CAM-IND-VIGE IN CAM.
           MOVE CAM-NUM-DTRN IN CAM-FLD TO CAM-NUM-DTRN IN CAM.
           MOVE CAM-NUM-MTRN IN CAM-FLD TO CAM-NUM-MTRN IN CAM.
           MOVE CAM-NUM-STRN IN CAM-FLD TO CAM-NUM-STRN IN CAM.
           MOVE CAM-NUM-ATRN IN CAM-FLD TO CAM-NUM-ATRN IN CAM.
       FIN-RET-CAM-CAM.
           EXIT.
       
       KEY-ALL-CAM SECTION.
       INI-KEY-ALL-CAM.
           PERFORM KEY-TAB-CAM.
           PERFORM KEY-CAM-CAM.
       FIN-KEY-ALL-CAM.
           EXIT.
       
       KEY-TAB-CAM SECTION.
       INI-KEY-TAB-CAM.
           MOVE TAB-COD-CTAB IN CAM-FLD TO TAB-COD-CTAB IN TAB.
       FIN-KEY-TAB-CAM.
           EXIT.
       
       KEY-CAM-CAM SECTION.
       INI-KEY-CAM-CAM.
           MOVE CAM-MSC-TVAL IN CAM-FLD(1) TO CAM-MSC-TVAL IN CAM(1).
           MOVE CAM-MSC-TVAL IN CAM-FLD(2) TO CAM-MSC-TVAL IN CAM(2).
           MOVE CAM-COD-CVAL IN CAM-FLD(1) TO CAM-COD-CVAL IN CAM(1).
           MOVE CAM-COD-CVAL IN CAM-FLD(2) TO CAM-COD-CVAL IN CAM(2).
           MOVE CAM-COD-TCAM IN CAM-FLD(1) TO CAM-COD-TCAM IN CAM(1).
           MOVE CAM-COD-TCAM IN CAM-FLD(2) TO CAM-COD-TCAM IN CAM(2).
           MOVE CAM-NUM-DCAM IN CAM-FLD(1) TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-NUM-DCAM IN CAM-FLD(2) TO CAM-NUM-DCAM IN CAM(2).
           MOVE CAM-NUM-MCAM IN CAM-FLD(1) TO CAM-NUM-MCAM IN CAM(1).
           MOVE CAM-NUM-MCAM IN CAM-FLD(2) TO CAM-NUM-MCAM IN CAM(2).
           MOVE CAM-NUM-SCAM IN CAM-FLD(1) TO CAM-NUM-SCAM IN CAM(1).
           MOVE CAM-NUM-SCAM IN CAM-FLD(2) TO CAM-NUM-SCAM IN CAM(2).
           MOVE CAM-NUM-ACAM IN CAM-FLD(1) TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-NUM-ACAM IN CAM-FLD(2) TO CAM-NUM-ACAM IN CAM(2).
       FIN-KEY-CAM-CAM.
           EXIT.
       
       SCR-CLRA-CAM SECTION.
       INI-SCR-CLRA-CAM.
           PERFORM CLR-KEY-CAM.
           PERFORM CLR-FLD-CAM.
       FIN-SCR-CLRA-CAM.
           EXIT.
       
       CLR-KEY-CAM SECTION.
       INI-CLR-KEY-CAM.
           MOVE SPACES TO TAB-COD-CTAB IN CAM-FLD.
           MOVE SPACES TO CAM-MSC-TVAL IN CAM-FLD(1).
           MOVE SPACES TO CAM-MSC-TVAL IN CAM-FLD(2).
           MOVE SPACES TO CAM-COD-CVAL IN CAM-FLD(1).
           MOVE SPACES TO CAM-COD-CVAL IN CAM-FLD(2).
           MOVE SPACES TO CAM-COD-TCAM IN CAM-FLD(1).
           MOVE SPACES TO CAM-COD-TCAM IN CAM-FLD(2).
           MOVE SPACES TO CAM-FEC-FCAM IN CAM-FLD(1).
           MOVE SPACES TO CAM-FEC-FCAM IN CAM-FLD(2).
       FIN-CLR-KEY-CAM.
           EXIT.
       
       CLR-FLD-CAM SECTION.
       INI-CLR-FLD-CAM.
           MOVE SPACES TO FRM-GLS-VCAM IN CAM-FLD(1).
           MOVE SPACES TO FRM-GLS-VCAM IN CAM-FLD(2).
           PERFORM CLR-TAB-CAM.
           PERFORM CLR-CAM-CAM.
       FIN-CLR-FLD-CAM.
           EXIT.
       
       CLR-TAB-CAM SECTION.
       INI-CLR-TAB-CAM.
       FIN-CLR-TAB-CAM.
           EXIT.
       
       CLR-CAM-CAM SECTION.
       INI-CLR-CAM-CAM.
           MOVE ZEROES TO CAM-SGV-VCAM IN CAM-FLD.
           MOVE SPACES TO CAM-IND-VIGE IN CAM-FLD.
           MOVE SPACES TO CAM-FEC-FTRN IN CAM-FLD.
       FIN-CLR-CAM-CAM.
           EXIT.
       
       FST-KEY-CAM SECTION.
       INI-FST-KEY-CAM.
           MOVE -1 TO TAB-COD-CTAB-LEN IN CAM-FLD.
       FIN-FST-KEY-CAM.
           EXIT.
       
       FST-FLD-CAM SECTION.
       INI-FST-FLD-CAM.
           MOVE -1 TO CAM-SGV-VCAM-LEN IN CAM-FLD.
       FIN-FST-FLD-CAM.
           EXIT.
       
       PRO-KEY-CAM SECTION.
       INI-PRO-KEY-CAM.
           PERFORM PRO-IKY-CAM.
           PERFORM PRO-AKY-CAM.
           PERFORM PRO-MKY-CAM.
       FIN-PRO-KEY-CAM.
           EXIT.
       
       PRO-IKY-CAM SECTION.
       INI-PRO-IKY-CAM.
           MOVE FRM-CPIM-AEY TO TAB-COD-CTAB-ATR IN CAM-FLD.
           MOVE FRM-CPIM-AEY TO 
                CAM-FEC-FCAM-ATR IN CAM-FLD IN CAM-FLD(1).
           MOVE FRM-CPIM-AEY TO 
                CAM-FEC-FCAM-ATR IN CAM-FLD IN CAM-FLD(2).
       FIN-PRO-IKY-CAM.
           EXIT.
       
       PRO-MKY-CAM SECTION.
       INI-PRO-MKY-CAM.
       FIN-PRO-MKY-CAM.
           EXIT.
       
       PRO-AKY-CAM SECTION.
       INI-PRO-AKY-CAM.
       FIN-PRO-AKY-CAM.
           EXIT.
       
       PRO-FLD-CAM SECTION.
       INI-PRO-FLD-CAM.
           PERFORM PRO-TAB-CAM.
           PERFORM PRO-CAM-CAM.
       FIN-PRO-FLD-CAM.
           EXIT.
       
       PRO-TAB-CAM SECTION.
       INI-PRO-TAB-CAM.
       FIN-PRO-TAB-CAM.
           EXIT.
       
       PRO-CAM-CAM SECTION.
       INI-PRO-CAM-CAM.
           MOVE FRM-CPIM-AEY TO CAM-SGV-VCAM-ATR IN CAM-FLD.
           MOVE FRM-CPIM-AEY TO CAM-IND-VIGE-ATR IN CAM-FLD.
       FIN-PRO-CAM-CAM.
           EXIT.
       
       UNP-KEY-CAM SECTION.
       INI-UNP-KEY-CAM.
           PERFORM UNP-IKY-CAM.
           PERFORM UNP-AKY-CAM.
           PERFORM UNP-MKY-CAM.
       FIN-UNP-KEY-CAM.
           EXIT.
       
       UNP-IKY-CAM SECTION.
       INI-UNP-IKY-CAM.
           MOVE FRM-CPIM-UBY TO TAB-COD-CTAB-ATR.
           MOVE FRM-CPIM-UBY TO CAM-FEC-FCAM-ATR IN CAM-FLD(1).
           MOVE FRM-CPIM-UBY TO CAM-FEC-FCAM-ATR IN CAM-FLD(2).
       FIN-UNP-IKY-CAM.
           EXIT.
       
       UNP-MKY-CAM SECTION.
       INI-UNP-MKY-CAM.
       FIN-UNP-MKY-CAM.
           EXIT.
       
       UNP-AKY-CAM SECTION.
       INI-UNP-AKY-CAM.
       FIN-UNP-AKY-CAM.
           EXIT.
       
       UNP-FLD-CAM SECTION.
       INI-UNP-FLD-CAM.
           PERFORM UNP-TAB-CAM.
           PERFORM UNP-CAM-CAM.
       FIN-UNP-FLD-CAM.
           EXIT.
       
       UNP-TAB-CAM SECTION.
       INI-UNP-TAB-CAM.
       FIN-UNP-TAB-CAM.
           EXIT.
       
       UNP-CAM-CAM SECTION.
       INI-UNP-CAM-CAM.
           MOVE FRM-CPIM-UBY TO CAM-SGV-VCAM-ATR IN CAM-FLD.
           MOVE FRM-CPIM-UBY TO CAM-IND-VIGE-ATR IN CAM-FLD.
       FIN-UNP-CAM-CAM.
           EXIT.
       
       VAL-KEY-CAM SECTION.
       INI-VAL-KEY-CAM.
           PERFORM VAL-IKY-CAM.
           PERFORM VAL-MKY-CAM.
           PERFORM VAL-AKY-CAM.
       FIN-VAL-KEY-CAM.
           EXIT.
       
       VAL-IKY-CAM SECTION.
       INI-VAL-IKY-CAM.
           PERFORM VAL-TAB-COD-CTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAB-COD-CTAB-LEN IN CAM-FLD
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-MSC-TVAL VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-MSC-TVAL-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-COD-CVAL VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-COD-CVAL-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-COD-TCAM VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-COD-TCAM-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
           PERFORM VAL-CAM-FEC-FCAM VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO CAM-FEC-FCAM-LEN(FRM-IFLD)
                GO TO FIN-VAL-IKY-CAM.
       FIN-VAL-IKY-CAM.
           EXIT.
       
       VAL-MKY-CAM SECTION.
       INI-VAL-MKY-CAM.
       FIN-VAL-MKY-CAM.
           EXIT.
       
       VAL-AKY-CAM SECTION.
       INI-VAL-AKY-CAM.
       FIN-VAL-AKY-CAM.
           EXIT.
       
       VAL-FLD-CAM SECTION.
       INI-VAL-FLD-CAM.
           PERFORM VAL-FRM-GLS-VCAM
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 2
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-GLS-VCAM-LEN IN CAM-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-CAM.
           PERFORM VAL-CAM-SGV-VCAM.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAM-SGV-VCAM-LEN IN CAM-FLD
                GO TO FIN-VAL-FLD-CAM.
           PERFORM VAL-CAM-IND-VIGE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAM-IND-VIGE-LEN IN CAM-FLD
                GO TO FIN-VAL-FLD-CAM.
           PERFORM VAL-CAM-FEC-FTRN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CAM-FEC-FTRN-LEN IN CAM-FLD
                GO TO FIN-VAL-FLD-CAM.
       FIN-VAL-FLD-CAM.
           EXIT.
       
       VAL-TAB-COD-CTAB SECTION.
       INI-VAL-TAB-COD-CTAB.
           IF TAB-COD-CTAB IN CAM-FLD NOT > SPACES
              MOVE SPACES TO TAB-COD-CTAB IN CAM-FLD.
      *<<<< TAB_COD_CTAB
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SVC' TO TAB-COD-TTAB IN TAB.
           MOVE TAB-COD-CTAB IN CAM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-CAMB

               MOVE WSS-MSC-TVAL IN WSS-COD-VCAM(1) TO
                    CAM-MSC-TVAL IN CAM-FLD(1)
               MOVE WSS-COD-CVAL IN WSS-COD-VCAM(1) TO
                    CAM-COD-CVAL IN CAM-FLD(1)
               MOVE WSS-COD-TCAM IN WSS-COD-VCAM(1) TO
                    CAM-COD-TCAM IN CAM-FLD(1)

               MOVE WSS-MSC-TVAL IN WSS-COD-VCAM(2) TO
                    CAM-MSC-TVAL IN CAM-FLD(2)
               MOVE WSS-COD-CVAL IN WSS-COD-VCAM(2) TO
                    CAM-COD-CVAL IN CAM-FLD(2)
               MOVE WSS-COD-TCAM IN WSS-COD-VCAM(2) TO
                    CAM-COD-TCAM IN CAM-FLD(2)

               PERFORM VLD-CAM-MSC-TVAL VARYING FRM-IFLD
                       FROM 1 BY 1 UNTIL FRM-IFLD > 2.
      *>>>>
       FIN-VAL-TAB-COD-CTAB.
           EXIT.
       
       VAL-CAM-MSC-TVAL SECTION.
       INI-VAL-CAM-MSC-TVAL.
       FIN-VAL-CAM-MSC-TVAL.
           EXIT.
       
       VAL-CAM-COD-CVAL SECTION.
       INI-VAL-CAM-COD-CVAL.
       FIN-VAL-CAM-COD-CVAL.
           EXIT.
       
       VAL-CAM-COD-TCAM SECTION.
       INI-VAL-CAM-COD-TCAM.
       FIN-VAL-CAM-COD-TCAM.
           EXIT.
       
       VAL-FRM-GLS-VCAM SECTION.
       INI-VAL-FRM-GLS-VCAM.
       FIN-VAL-FRM-GLS-VCAM.
           EXIT.
       
       VAL-CAM-FEC-FCAM SECTION.
       INI-VAL-CAM-FEC-FCAM.
      *VAL-FEC Validar Fecha
           MOVE CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD) TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *DAD
      *<<<< INI_CAM_FEC_FCAM
           MOVE CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD) TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           IF FRM-IFLD = 1
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N  TO FEC-VHBL.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD)
               IF FRM-IFLD = 2 AND FEC-STAT-BLK
                   MOVE CAM-FEC-FCAM IN CAM-FLD(1) TO
                        CAM-FEC-FCAM IN CAM-FLD(2)
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
           GO TO FIN-VAL-CAM-FEC-FCAM.
      *
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CAM-FEC-FCAM IN CAM-FLD(FRM-IFLD)
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CAM-FEC-FCAM.
      *<<<< CAM_FEC_FCAM
      *>>>>
       FIN-VAL-CAM-FEC-FCAM.
           EXIT.
       
       VAL-CAM-SGV-VCAM SECTION.
       INI-VAL-CAM-SGV-VCAM.
       FIN-VAL-CAM-SGV-VCAM.
           EXIT.
       
       VAL-CAM-IND-VIGE SECTION.
       INI-VAL-CAM-IND-VIGE.
           IF CAM-IND-VIGE IN CAM-FLD NOT > SPACES
              MOVE SPACES TO CAM-IND-VIGE IN CAM-FLD.
      *DAD
      *<<<< CAM_IND_VIGE
           IF SCR-CMND = 'VRF'
               MOVE 'GNS'  TO MSC-COD-SIST
               MOVE 'VIGE' TO MSC-COD-TMSC IN MSC
               MOVE CAM-IND-VIGE IN CAM-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *
      *>>>>
       FIN-VAL-CAM-IND-VIGE.
           EXIT.
       
       VAL-CAM-FEC-FTRN SECTION.
       INI-VAL-CAM-FEC-FTRN.
       FIN-VAL-CAM-FEC-FTRN.
           EXIT.
       
       VAL-CON-KEY-CAM SECTION.
       INI-VAL-CON-KEY-CAM.
           IF     TAB-COD-CTAB IN CAM-FLD NOT > SPACES 
              AND CAM-MSC-TVAL IN CAM-FLD(1) NOT > SPACES 
              AND CAM-MSC-TVAL IN CAM-FLD(2) NOT > SPACES 
              AND CAM-COD-CVAL IN CAM-FLD(1) NOT > SPACES 
              AND CAM-COD-CVAL IN CAM-FLD(2) NOT > SPACES 
              AND CAM-COD-TCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-COD-TCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-FEC-FCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-FEC-FCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-NUM-DCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-NUM-DCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-NUM-MCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-NUM-MCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-NUM-SCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-NUM-SCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-NUM-ACAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-NUM-ACAM IN CAM-FLD(2) NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAM.
       FIN-VAL-CON-KEY-CAM.
           EXIT.
       
       VAL-CON-IKY-CAM SECTION.
       INI-VAL-CON-IKY-CAM.
           IF     TAB-COD-CTAB IN CAM-FLD NOT > SPACES 
              AND CAM-MSC-TVAL IN CAM-FLD(1) NOT > SPACES 
              AND CAM-MSC-TVAL IN CAM-FLD(2) NOT > SPACES 
              AND CAM-COD-CVAL IN CAM-FLD(1) NOT > SPACES 
              AND CAM-COD-CVAL IN CAM-FLD(2) NOT > SPACES 
              AND CAM-COD-TCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-COD-TCAM IN CAM-FLD(2) NOT > SPACES 
              AND CAM-FEC-FCAM IN CAM-FLD(1) NOT > SPACES 
              AND CAM-FEC-FCAM IN CAM-FLD(2) NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CAM.
       FIN-VAL-CON-IKY-CAM.
           EXIT.
       
       VAL-CON-FLD-CAM SECTION.
       INI-VAL-CON-FLD-CAM.
       FIN-VAL-CON-FLD-CAM.
           EXIT.
       
       VAL-CON-CAM SECTION.
       INI-VAL-CON-CAM.
       FIN-VAL-CON-CAM.
           EXIT.
       
       VAL-NUM-KEY-CAM SECTION.
       INI-VAL-NUM-KEY-CAM.
           PERFORM VAL-NUM-IKY-CAM.
           PERFORM VAL-NUM-MKY-CAM.
           PERFORM VAL-NUM-AKY-CAM.
       FIN-VAL-NUM-KEY-CAM.
           EXIT.
       
       VAL-NUM-IKY-CAM SECTION.
       INI-VAL-NUM-IKY-CAM.
       FIN-VAL-NUM-IKY-CAM.
           EXIT.
       
       VAL-NUM-MKY-CAM SECTION.
       INI-VAL-NUM-MKY-CAM.
       FIN-VAL-NUM-MKY-CAM.
           EXIT.
       
       VAL-NUM-AKY-CAM SECTION.
       INI-VAL-NUM-AKY-CAM.
       FIN-VAL-NUM-AKY-CAM.
           EXIT.
       
       VAL-NUM-FLD-CAM SECTION.
       INI-VAL-NUM-FLD-CAM.
       VAL-NUM-CAM-SGV-VCAM.
           MOVE CAM-SGV-VCAM-ALF IN CAM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NS9V TO CAM-SGV-VCAM IN CAM-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO CAM-SGV-VCAM-LEN IN CAM-FLD
                GO TO FIN-VAL-NUM-FLD-CAM.
       FIN-VAL-NUM-FLD-CAM.
           EXIT.
       
       EDT-KEY-CAM SECTION.
       INI-EDT-KEY-CAM.
           PERFORM EDT-IKY-CAM.
           PERFORM EDT-MKY-CAM.
           PERFORM EDT-AKY-CAM.
       FIN-EDT-KEY-CAM.
           EXIT.
       
       EDT-IKY-CAM SECTION.
       INI-EDT-IKY-CAM.
       FIN-EDT-IKY-CAM.
           EXIT.
       
       EDT-MKY-CAM SECTION.
       INI-EDT-MKY-CAM.
       FIN-EDT-MKY-CAM.
           EXIT.
       
       EDT-AKY-CAM SECTION.
       INI-EDT-AKY-CAM.
       FIN-EDT-AKY-CAM.
           EXIT.
       
       EDT-FLD-CAM SECTION.
       INI-EDT-FLD-CAM.
           IF CAM-SGV-VCAM-LEN IN CAM-FLD = -9
                MOVE -1 TO CAM-SGV-VCAM-LEN IN CAM-FLD
                GO TO FIN-EDT-FLD-CAM.
           MOVE CAM-SGV-VCAM IN CAM-FLD TO CAM-SGV-VCAM-EDT IN CAM-FLD.
       FIN-EDT-FLD-CAM.
           EXIT.
      *<<<< EOF
       VLD-CAM-MSC-TVAL SECTION.
       INI-VLD-CAM-MSC-TVAL.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE CAM-MSC-TVAL IN CAM-FLD(FRM-IFLD) TO
                                WSS-MSC-TVAL IN WSS-COD-VCAM(FRM-IFLD).
           MOVE CAM-COD-CVAL IN CAM-FLD(FRM-IFLD) TO
                                WSS-COD-CVAL IN WSS-COD-VCAM(FRM-IFLD).
           MOVE CAM-COD-TCAM IN CAM-FLD(FRM-IFLD) TO
                                WSS-COD-TCAM IN WSS-COD-VCAM(FRM-IFLD).

           MOVE WSS-COD-VCAM(FRM-IFLD) TO TAB-COD-CTAB IN TAB.

           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO
                                    FRM-GLS-VCAM IN CAM-FLD(FRM-IFLD).
       FIN-VLD-CAM-MSC-TVAL.
           EXIT.
      *>>>>
