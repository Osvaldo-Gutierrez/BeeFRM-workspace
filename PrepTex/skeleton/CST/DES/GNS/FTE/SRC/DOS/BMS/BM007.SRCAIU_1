%!              BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
% TIPO_{TIPO} = TRUE
      * {TIPO}-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
%! TIPO VRF
% IF TIPO_VRF THEN
% IF NOT TIENE_IDC_{RREG}_IDC_{NOMB} THEN
% IF TIDX > 0 THEN
           PERFORM VAL-{RREG}-NUM-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
% ELSE
           PERFORM VAL-{RREG}-NUM-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
% END IF
% ELSE
%! TIPO IDC
% IF TIPO_IDC THEN
% IF TIDX > 0 THEN
           PERFORM VAL-{RREG}-IND-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-IND-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-GLS-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-GLS-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-NUM-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.

% ELSE
           PERFORM VAL-{RREG}-IND-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-IND-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-GLS-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-GLS-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-NUM-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
% ELSE
%! TIPO FEC Y SUS DERIVADOS
% IF TIPO_FEC OR TIPO_DMA OR TIPO_AMD OR TIPO_MSA OR TIPO_SAM OR TIPO_FMA OR TIPO_FAM OR TIPO_FSA OR TIPO_FAS OR TIPO_FDM OR TIPO_FMD OR TIPO_FFA THEN
% IF TIDX > 0 THEN
           PERFORM VAL-{CAMP} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX} OR
                FRM-SUAR = FRM-SUAR-MAL OR
                FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                {CAMP}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
% FOR I = 1 TO {TIDX}
% NEXT I
% ELSE
           PERFORM VAL-{CAMP}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {CAMP}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
% END IF
% END IF
% END IF
      * {TIPO}-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
% TIPO_{TIPO} = FALSE
