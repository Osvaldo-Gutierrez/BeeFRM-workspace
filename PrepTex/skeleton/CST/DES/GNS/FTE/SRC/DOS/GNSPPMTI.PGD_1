       IDENTIFICATION DIVISION.                                         
      *========================                                         
       PROGRAM-ID. GNSPPMTI.                                            
       AUTHOR. CONSIST.                                                 
       DATE-WRITTEN.  13-JAN-2004 19:39:35                              
      * IDENTIFICACION = MULTI-V1B1                                     
      *                                                                 
      * MENU PARA TRANSIENT DATA                                        
      *                                                                 
       ENVIRONMENT DIVISION.                                            
      *=====================                                            
       DATA DIVISION.                                                   
      *==============                                                   
                                                                        
       WORKING-STORAGE SECTION.                                         
      *------------------------                                         
       01  WSS-IDD-VARI.                                                
           03 WSS-QIDD-LEN  VALUE +490     COMP PIC S9(04).             
           03 WSS-QIDD.                                                 
              05 WSS-NIDD VALUE 'GIDD'    PIC X(04).                    
              05 WSS-TIDD                 PIC X(04).                    
      * XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX                                
      * 77  WSS-AUXI-NUM3    VALUE ZEROES PIC 9(03).                    
      * XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX                                
      * VARIABLES PARA DESPLEGAR CAMPOS CON ATRIBUTOS                   
      * 77  WSS-DSP-TSO VALUE 'N'    PIC X(01).                         
      * 77  WSS-IDX-CAMPO VALUE ZEROES   PIC 9(04).                     
      * 01  WSS-TAB-CAMPO.                                              
      *     03  WSS-TAB-CAMPO-OCC OCCURS 60 TIMES.                      
      *         05 WSS-TAB-CAMPO-ELM    PIC X(01).                      
      * VARIABLES PARA DESPLEGAR CAMPOS CON ATRIBUTOS                   
                                                                        
      *AMB-FIN MANEJO DE HEADER Y BYTE ATRIBUTOS                        
       COPY GNSWGAMB.                                                   
       COPY GNSBRRCI.                                                   
       COPY GNSWRRCI.                                                   
                                                                        
       01  WSS-MIRA    VALUE '*()*' PIC X(04).                          
       01  WSS-COD-CIFD VALUE SPACES PIC X(12).                         
                                                                        
       01  MSG-TDO.                                                     
           03 MSG-TDO-COD-STAT       PIC X(01).                         
           03 MSG-TDO-COD-MSJE       PIC X(12).                         
           03 MSG-TDO-GLS-MSJE       PIC X(79).                         
       77  WSS-PREG-POR-SPAC    VALUE 'N' PIC X(01).                    
                                                                        
      * CH-INI                                                          
      *COPY LDCBRTSM.                                                   
       COPY GNSBRTSM.                                                   
      * CH-FIN                                                          
                                                                        
      * CH-INI                                                          
      * COPY LDCWGMTX.                                                  
       COPY GNSWGMXX.                                                   
      * CH-FIN                                                          
       01  WSS-XXXX    VALUE '(**)' PIC X(04).                          
       COPY GNSWGTSK.                                                   
       COPY GNSWGSYS.                                                   
       COPY GNSBRMNU.                                                   
       COPY GNSBRRPF.                                                   
                                                                        
                                                                        
       COPY GNSBRTSI.                                                   
      * COPY GNSBRABP.                                                  
       COPY GNSBRTSO.                                                   
       COPY GNSWGTDI.                                                   
       COPY GNSWGTDO.                                                   
       COPY GNSWGTSI.                                                   
      * COPY GNSWGABP.                                                  
       COPY GNSWGTSO.                                                   
                                                                        
      * ISP  11-NOV-1992                                                
      *                                                                 
      * BCI-COPY                                                        
      *COPY GNSWVPCC.                                                   
       COPY GNSWV3CR.                                                   
      *                                                                 
      * ISP: CONTINUACION CMMA                                          
           03 SCR-CONT                    PIC X(2750).                  
       COPY GNSWCSCR.                                                   
                                                                        
      * ISP  11-NOV-1992                                                
      *                                                                 
      * BCI-COPY                                                        
      *COPY GNSWGPCO.                                                   
       COPY GNSWGOSC.                                                   
      *                                                                 
      * ISP: CONTINUACION CMMA                                          
           03 OSC-CONT                    PIC X(001).                   
                                                                        
       COPY GNSWCFIO.                                                   
       COPY GNSWVFIO.                                                   
       COPY GNSWGUIB.                                                   
       COPY GNSWGELS.                                                   
       COPY GNSWGRQA.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCI-REQA==.        
                                                                        
       COPY GNSBRIDD.                                                   
       COPY GNSWVIDD.                                                   
       01  WSS-IND-QUE                           PIC X(03).             
       01  IFD.                                                         
           03  FILLER                            PIC X(01).             
           03  IFD-COD-CIFD                      PIC X(12).             
           03  IFD-GLS-DATA                      PIC X(210).            
           03  FILLER                            PIC X(18).             
       COPY GNSWGQUE.                                                   
      * ISP  11-NOV-1992                                                
      * COPY GNSWGTDQ.                                                  
       COPY GNSWGTSL.                                                   
      *                                                                 
       COPY GNSBRTAB.                                                   
      * ISP  11-NOV-1992                                                
      *                                                                 
      * BCI-COPY                                                        
       COPY GNSWG3CF.                                                   
      * COPY GNSWGFRM.                                                  
      *                                                                 
       01  PGM-STAT.                                                    
              05 PGM-STAT-TSI           VALUE '23'      PIC X(02).      
                 88 PGM-STAT-TSI-OKS    VALUE '00'.                     
                 88 PGM-STAT-TSI-NUL    VALUE '  '.                     
      * VARIABLES A TRANSFERIR A COMMAND DESDE ZOOM.                    
      *    TAMANO                                                       
       01  WSS-TCMA-CMN  COMP              PIC S9(4).                   
       01  WSS-VARI.                                                    
      *     03 WSS-QIDD.                                                
      *        05 WSS-NIDD VALUE 'GIDD'    PIC X(04).                   
      *        05 WSS-TIDD                 PIC X(04).                   
           03 WSS-J             VALUE 0                PIC 9(04).       
           03 WSS-K             VALUE 0                PIC 9(04).       
      *LGM-BNL-06.04.1995-INI                                           
           03 WSS-IND-PRIMER    VALUE ZEROES           PIC 9.           
              88 PRIMERA-VEZ    VALUE 1.                                
           03 WSS-NUM-TSO       VALUE ZEROES           PIC 9(03).       
           03 WSS-IND-ERROR     VALUE 999              PIC 9(03).       
           03 WSS-MNU-GLS-ERRO  VALUE SPACES           PIC X(07).       
           03 WSS-MNU-COD-CMND  VALUE SPACES           PIC X(03).       
           03 WSS-TDI-ERROR     VALUE SPACES           PIC X.           
              88 TDI-GLS-ERROR  VALUE 'S'.                              
      *     03 WSS-TSO           VALUE SPACES           PIC X(2014).    
      *LGM-BNL-06.04.1995-FIN                                           
           03 WSS-NITM          VALUE 1                PIC 9(03).       
                                                                        
      * VARIABLES PARA MANEJO DE ERROR                                  
       01  WSS-ERR-VARI.                                                
           03 WSS-DTC-ERR                    PIC X(01).                 
           03 WSS-IDX-ERR                    PIC 9(05).                 
           03 WSS-IDX-FLD-ERR                PIC 9(05).                 
           03 WSS-MAX-FLD-HST                PIC 9(05).                 
           03 WSS-NUM-L3                     PIC 9(03).                 
           03 WSS-MSG-PTC.                                              
              05 WSS-MSG-PTC0                PIC X(02).                 
              05 WSS-MSG-PTC1                PIC X(03).                 
      *        05 WSS-MSG-PTC2                PIC X(03).                
              05 WSS-MSG-PTC3                PIC X(04).                 
           03 WSS-SEP-NFRM.                                             
              05 WSS-SEP-NFRM1               PIC X(04).                 
              05 WSS-SEP-NFRM2               PIC X(03).                 
           03 WSS-NUM-ERR-PTC                PIC 9(04).                 
           03 WSS-GLS-ERR-PTC VALUE SPACES   PIC X(20).                 
                                                                        
      * VARIABLES PARA MANEJO DE ESTADISTICAS                           
       01  WSS-ESTD.                                                    
      * PARA COMPARAR REGISTROS A ELIMINAR                              
           03 WSS-ESTD-ELIM         VALUE SPACES       PIC X(10).       
      * PARA EDITAR HORA                                                
           03 WSS-ESTD-HORA            PIC Z(9).                        
           03 WSS-ESTD-CTAB.                                            
              05 WSS-ESTD-CTAB-01   VALUE 'MONITORPTC' PIC X(10).       
              05 WSS-ESTD-CTAB-02   VALUE ZEROES       PIC 9(02).       
           03 WSS-ESTD-DESC.                                            
                                                                        
      * FUNCION DE MENU                                                 
              05 WSS-ESTD-DESC-01   VALUE SPACES PIC X(12).             
                                                                        
      * ESPACIOS                                                        
              05 WSS-ESTD-DESC-02   VALUE SPACES PIC X(02).             
                                                                        
      * INSTANCIA                                                       
      *   INIPGM INICIO DEL PROGRAMA COLPPMTD                           
      *   LEEMNU LECTURA DE UNA NUEVA FUNCION DE MENU                   
      *   LINK   INVOCACION A UN PROGRAMA                               
      *   RETURN RETORNO DE UN PROGRAMA                                 
      *   INIRSP INICIO ESTRUCTURACION DE RESPUESTA                     
      *   FINPGM FIN DEL PROGRAMA                                       
              05 WSS-ESTD-DESC-03   VALUE SPACES PIC X(06).             
                                                                        
      * ESPACIOS                                                        
              05 WSS-ESTD-DESC-04   VALUE SPACES PIC X(02).             
                                                                        
      * HORA DEL EVENTO                                                 
              05 WSS-ESTD-DESC-05   VALUE SPACES PIC X(30).             
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-INST-OLD                   PIC X(03).                 
           03 WSS-INST-NEW                   PIC X(03).                 
      * ISP: PUNTEROS VARIOS                                            
           03 WSS-AUXI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-I        VALUE ZEROES      PIC 9(05).                 
           03 WSS-PINI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-LENG     VALUE ZEROES      PIC 9(05).                 
           03 WSS-ELEM     VALUE ZEROES      PIC 9(05).                 
           03 WSS-RKEY-ABP VALUE ZEROES      PIC 9(05).                 
           03 WSS-RKEY-TSI VALUE ZEROES      PIC 9(05).                 
           03 WSS-RKEY-TSO VALUE ZEROES      PIC 9(05).                 
           03 WSS-BTDI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-BTSI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-LTDI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-LMSG-SRV VALUE ZEROES      PIC 9(05).                 
           03 WSS-CTDI     VALUE ZEROES      PIC 9(05).                 
           03 WSS-ITDI     VALUE ZEROES      PIC 9(05).                 
      * PUNTERO PARA MOVER UNO A UNO LOS CARACTERES A TDO, EN DEFINITIVA
      * QUEDA CON EL LARGO DEL MENSAJE EN TDO                           
           03 WSS-ISRV     VALUE ZEROES      PIC 9(05).                 
           03 WSS-FST-SRV                    PIC X(01).                 
                                                                        
      * ISP: NUMERO NUMERICO                                            
           03 WSS-NUM-99   VALUE ZEROES      PIC 9(02).                 
      * ISP: NUMERO ALFABETICO                                          
           03 WSS-NUM-XX REDEFINES WSS-NUM-99.                          
              05 WSS-NUM-XX1                 PIC X(01).                 
              05 WSS-NUM-XX2                 PIC X(01).                 
                                                                        
      * ISP: AMBIENTE QUE ORIGINO EL MENSAJE ( HST O SRV )              
           03 WSS-COD-ORIG                   PIC X(03).                 
      * ISP: ORIGINARIO DE HOST                                         
           03 WSS-COD-ORIG-HST VALUE 'HST'   PIC X(03).                 
      * ISP: ORIGINARIO DE SERVER                                       
           03 WSS-COD-ORIG-SRV VALUE 'SRV'   PIC X(03).                 
           03 WSS-COD-CTAB.                                             
              05 WSS-COD-1TAB                PIC X(07).                 
              05 WSS-COD-2TAB                PIC X(05).                 
                                                                        
      * ISP: VARIABLE PARA GUARDAR NOMBRE DE PANTALLA                   
           03 WSS-MNU-GLS-NFRM                   PIC X(07).             
      * ISP: VARIABLE PARA COMPARACION NOMBRE PANTALLA HOST             
           03 WSS-GLS-NFRM-HST                   PIC X(07).             
      * ISP: VARIABLE PARA COMPARACION NOMBRE PANTALLA SERVER           
           03 WSS-GLS-NFRM-SRV                   PIC X(10).             
                                                                        
      * ISP: VARIABLE INDICE PARA BUSCAR SI EXISTE OCURRENCIA           
      *      DE CAMPO CORRELATIVO 'HST' EN TABLA 'SRV'                  
      *      DE ESTA FORMA LA TABLA 'SRV' NO NECESARIAMENTE             
      *      DEBE ESTAR ORDENADA ASCENDENTEMENTE                        
           03 WSS-IDX-SRV-ASC VALUE ZEROES        PIC 9(05).            
      * ISP: VARIABLE PARA INDICAR SI ENCUENTRA OCURRENCIA              
      *      EN TABLA SRV                                               
           03 WSS-IND-ESRV    VALUE SPACES        PIC X(01).            
      * ISP: VARIABLE AUXILIAR PARA SUMAR WSS-IDX-FLD-SRV               
           03 WSS-IDX-AUX     VALUE ZEROES        PIC 9(05).            
      *                                                                 
      * ISP: VARIABLE QUE UNE DESCRIPCION DE TABLA                      
           03 WSS-GLS-TAB.                                              
              05 WSS-GLS-DESC                PIC X(40).                 
              05 WSS-GLS-DATA                PIC X(60).                 
                                                                        
           03 WSS-GLS-TAB-HST REDEFINES WSS-GLS-TAB.                    
              05 WSS-COD-TAB-HST OCCURS 50 TIMES PIC 9(02).             
                                                                        
           03 WSS-GLS-TAB-SRV REDEFINES WSS-GLS-TAB.                    
              05 WSS-COD-TAB-SRV OCCURS 33 TIMES PIC 9(03).             
              05 WSS-COD-TAB-SRV-RST             PIC X(01).             
      * ISP: VARIABLE INDICE DE ESTRUCTURA TABLA HST                    
           03 WSS-IDX-TAB-HST VALUE ZEROES        PIC 9(05).            
      * ISP: VARIABLE INDICE DE ESTRUCTURA TABLA SRV                    
           03 WSS-IDX-TAB-SRV VALUE ZEROES        PIC 9(05).            
                                                                        
                                                                        
      * ISP: VECTOR PARA ESTRUCTURAR REGISTRO IMAGEN SERVER             
           03 WSS-GLS-MSG-SRV.                                          
              05 WSS-GLS-HDR-SRV     VALUE  SPACES PIC X(25).           
              05 WSS-GLS-FRM-SRV     VALUE  SPACES.                     
                 07 WSS-COD-FRM-SRV OCCURS 1330 TIMES  PIC X(01).       
      * ISP: VARIABLE INDICE DE ESTRUCTURA REGISTRO IMAGEN              
      *      POSICION DE INICIO                                         
           03 WSS-IDX-FRM-SRV VALUE ZEROES          PIC 9(05).          
                                                                        
      * ISP: VECTOR DE POSICIONES REGISTRO IMAGEN HOST                  
           03 WSS-GLS-POS-HST VALUE ZEROES.                             
              05 WSS-NUM-POS-HST OCCURS 300 TIMES  PIC 9(05).           
                                                                        
      * ISP: VARIABLE INDICE DE VECTOR DE POSICIONES                    
      *      REGISTRO IMAGEN HOST ( CONTADOR DE CAMPOS )                
           03 WSS-IDX-FLD-HST        VALUE ZEROES   PIC 9(05).          
      * ISP: VARIABLE INDICE DE VECTOR DE POSICIONES SERVER             
      *      REGISTRO IMAGEN SERVER ( CONTADOR DE CAMPOS )              
           03 WSS-IDX-FLD-SRV        VALUE ZEROES   PIC 9(05).          
                                                                        
      * ISP: VECTOR DE LARGOS REGISTRO IMAGEN HOST                      
           03 WSS-GLS-LEN-HST VALUE ZEROES.                             
              05 WSS-NUM-LEN-HST OCCURS 300 TIMES  PIC 9(03).           
                                                                        
      * ISP: VECTOR DE CAMPOS QUE COMPONEN REGISTRO IMAGEN SERVER       
           03 WSS-GLS-FLD-SRV VALUE ZEROES.                             
              05 WSS-COD-FLD-SRV OCCURS 300 TIMES  PIC 9(03).           
                                                                        
      * ISP: TOTAL DE CAMPOS EN DEFINICION MAPA HOST                    
           03 WSS-TOT-FLD-HST        VALUE ZEROES   PIC 9(05).          
      * ISP: TOTAL DE CAMPOS EN DEFINICION MAPA SERVER                  
           03 WSS-TOT-FLD-SRV        VALUE ZEROES   PIC 9(05).          
      * ISP: VARIABLE AUXILIAR PARA MANEJO DE PANTALLA CON              
      *      CODIGO DE MENSAJE Y GLOSA DE MENSAJE                       
           03 WSS-FRM-TSI                   PIC X(2011).                
      * ISP: VARIABLE INDICADOR DE ERROR                                
      *                                                                 
           03 WSS-IND-ERR VALUE 'N'         PIC X(01).                  
      *                                                                 
      * ISP: VARIABLES DE RESPALDO PARA MENSAJE AL SERVER               
           03 WSS-IDX-SRV  VALUE ZEROES      PIC 9(05).                 
      * ESTRUCTURA PARA GUARDAR INFORMACION HISTORICA DEL SERVER        
      *ISP INI ERROR DESDE EL INICIO DEL SISTEMA TOT TXS MTX            
      *    03 WSS-SRV-VARI OCCURS 30 TIMES.                             
           03 WSS-SRV-VARI OCCURS 80 TIMES.                             
      *ISP FIN ERROR DESDE EL INICIO DEL SISTEMA TOT TXS MTX            
                                                                        
      * SISTEMA DONDE SE ENCUENTRA LA DEFINICION DEL FORMATO            
              05 WSS-SRV-SIST                PIC X(03).                 
                                                                        
      * NOMBRE DE LA PANTALLA PARA BUSCAR EL FORMATO                    
              05 WSS-SRV-NFRM                PIC X(07).                 
                                                                        
      * FORMATO DE INPUT ASOCIADO A CADA SUBMENSAJE DE OUTPUT           
      * ( QUE RESPONDER POR CADA PANTALLA, PUEDE ESTAR VACIO )          
              05 WSS-SRV-FOUT                PIC X(03).                 
                                                                        
      * ISP: VARIABLES PARA REVISAR Y LIMPIAR CAMPOS DE TAL MODO QUE    
      *      SIEMPRE SE RESPETE LO QUE EL USUARIO DIGITO                
      *      EJ: SOBREPOSICION DE CAMPOS NUMERICOS                      
           03 WSS-SWI-FLD-USR                PIC X(01).                 
           03 WSS-IDX-FLD-USR                PIC 9(05).                 
                                                                        
       01  WSS-CMMA VALUE SPACES.                                       
           03  WSS-ORIG.                                                
               05  WSS-MODO                  PIC X(01).                 
               05  WSS-CNAL                  PIC X(03).                 
               05  WSS-IERR                  PIC X(01).                 
       01  WSS-TCMA                 VALUE +5 PIC S9(04).                
                                                                        
       LINKAGE SECTION.                                                 
      *----------------                                                 
       01  DFHCOMMAREA.                                                 
           02 FILLER                             PIC X(18).             
       COPY GNSLGFIO.                                                   
                                                                        
       PROCEDURE DIVISION.                                              
      *===================                                              
                                                                        
       MAIN SECTION.                                                    
       INI-MAIN.                                                        
       COPY GNSBGEDB.                                                   
           MOVE SPACES TO WSS-CMMA.                                     
           IF EIBCALEN > 0                                              
               IF EIBCALEN < WSS-TCMA                                   
                   MOVE EIBCALEN TO WSS-TCMA                            
               END-IF                                                   
               MOVE DFHCOMMAREA(1:WSS-TCMA) TO WSS-CMMA                 
           END-IF.                                                      
                                                                        
           PERFORM GNS-HDL-VSM.                                         
           MOVE DFHCOMMAREA(1:EIBCALEN) TO CTM-VARI.                    
                                                                        
      *    DISPLAY 'GNSPPMTI INICIANDO V1 PASO 1'.                      
      * ESTA VERSION MANEJA COLA CON LARGO 100                          
      * EN GNSWGMXX TIENE LARGO 3                                       
           MOVE +100 TO WSS-HDR-LITM.                                   
                                                                        
           MOVE +3327 TO TDI-LTDI.                                      
           MOVE +3328 TO TDO-LTDO.                                      
           MOVE +9000 TO TDI-LTDI.                                      
           MOVE +9000 TO TDO-LTDO.                                      
           PERFORM GET-TSK-TERM.                                        
                                                                        
      *DAD ini  08-OCT-1992                                             
           PERFORM GNS-ERR-QUE.                                         
      *DAD fin  08-OCT-1992                                             
                                                                        
           MOVE 'PTCQ' TO TDI-FIO-TERM                                  
                          TDO-FIO-TERM.                                 
           MOVE '00' TO FIO-STAT.                                       
           PERFORM GET-TDI.                                             
           PERFORM GNS-ERR-QUE.                                         
                                                                        
      *OLD MOVE TSK-TERM-ALF TO QUE-TERM.                               
      * NO MOVE SPACE FIELD                                             
      *OLD MOVE 'NMSF' TO QUE-TYPE.                                     
      *OLD MOVE +1 TO QUE-LITM                                          
      *OLD MOVE 1 TO QUE-NITM.                                          
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD     MOVE QUE-DEL TO QUE-CMND                                 
      *OLD     PERFORM GNS-PRO-QUE                                      
      *OLD     MOVE 'S' TO WSS-PREG-POR-SPAC.                           
                                                                        
      *OLD MOVE TSK-TERM-ALF   TO QUE-TERM.                             
      *OLD MOVE PTC-I24H-TYPE  TO QUE-TYPE.                             
      *OLD MOVE PTC-I24H-LENG TO QUE-LITM.                              
      *OLD MOVE 1 TO QUE-NITM.                                          
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD     MOVE QUE-ITEM TO WSS-COD-CIFD.                           
                                                                        
      *OLD MOVE TSK-TERM-ALF   TO QUE-TERM.                             
      *OLD MOVE PTC-CNAL-TYPE  TO QUE-TYPE.                             
      *OLD MOVE PTC-CNAL-LENG TO QUE-LITM.                              
      *OLD MOVE 1 TO QUE-NITM.                                          
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD     MOVE QUE-ITEM TO WSS-CNAL.                               
                                                                        
      *OLD MOVE TSK-TERM-ALF   TO QUE-TERM.                             
      *OLD MOVE PTC-IBYA-TYPE  TO QUE-TYPE.                             
      *OLD MOVE PTC-IBYA-LENG TO QUE-LITM.                              
      *OLD MOVE 1 TO QUE-NITM.                                          
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD     MOVE QUE-DEL TO QUE-CMND                                 
      *OLD     PERFORM GNS-PRO-QUE                                      
      *OLD     MOVE 'S' TO WSS-IND-IBYA.                                
                                                                        
      *OLD MOVE TSK-TERM-ALF   TO QUE-TERM.                             
      *OLD MOVE PTC-BCKI-TYPE  TO QUE-TYPE.                             
      *OLD MOVE PTC-BCKI-LENG TO QUE-LITM.                              
      *OLD MOVE 1 TO QUE-NITM.                                          
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD     MOVE QUE-DEL TO QUE-CMND                                 
      *OLD     PERFORM GNS-PRO-QUE                                      
      *OLD     MOVE QUE-ITEM TO PTC-WSS-BCKI-QUE.                       
                                                                        
      *DAD ini  08-OCT-1992                                             
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-TDQ.                                        
      *     MOVE 1 TO TDI-NUM-RECO.                                     
      *     MOVE FIO-PUT TO FIO-CMND.                                   
      *     PERFORM GNS-FIO-TDI.                                        
      *     IF NOT FIO-STAT-OKS                                         
      *         MOVE 'ABORTO: ERROR AL GRABAR MENSAJE TDI' TO SYS-MENS  
      *         MOVE SYS-ABOR TO SYS-CMND                               
      *         PERFORM GNS-PRO-SYS.                                    
      *DAD fin  08-OCT-1992                                             
                                                                        
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-ULOG IN TDI TO TSI-FIO-TERM.                   
      *     MOVE TDI-COD-ULOG IN TDI TO TSO-FIO-TERM.                   
      *     MOVE TDI-COD-ULOG IN TDI TO ABP-FIO-TERM.                   
      *     MOVE TDI-COD-ULOG IN TDI TO SCR-OTRN.                       
      *     MOVE TDI-COD-ULOG IN TDI TO OSC-OTRN.                       
      *     MOVE TDI-COD-ULOG IN TDI TO TSC-OTRN.                       
                                                                        
           MOVE TSK-TERM-ALF TO TSI-FIO-TERM.                           
           MOVE TSK-TERM-ALF TO TSO-FIO-TERM.                           
      *     MOVE TDI-TYPE TO ABP-FIO-TERM.                              
           MOVE TSK-TERM-ALF TO SCR-OTRN.                               
           MOVE TSK-TERM-ALF TO OSC-OTRN.                               
           MOVE TSK-TERM-ALF TO TSC-OTRN.                               
      *  27-JUL-1993 08:32:52 - FIN                                     
                                                                        
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-ULOG IN TDI TO WSS-TIDD.                       
      *     MOVE TSK-TERM-ALF TO WSS-TIDD.                              
      *  27-JUL-1993 08:32:52 - FIN                                     
                                                                        
      *     MOVE WSS-QIDD TO SCR-QIDD.                                  
      *     MOVE 'GNSPPMTD' TO TSC-CIDD.                                
      *     PERFORM GET-IDD.                                            
                                                                        
                                                                        
                                                                        
      *     PERFORM DEL-ABP.                                            
      *     PERFORM PUT-ABP.                                            
                                                                        
                                                                        
                                                                        
      *     MOVE 1 TO WSS-BTDI.                                         
      *     MOVE TSK-TERM-ALF TO WSS-TSL-TERM                           
      *     MOVE WSS-TSL-COLA TO QUE-COLA                               
                                                                        
                                                                        
      *     DISPLAY 'GNSPPMTD ANTES DE LEER QUE-AMB = '                 
      *     QUE-COLA.                                                   
                                                                        
      *    DISPLAY 'GNSPPMTI: LEERA COLA HDR ' QUE-ITEM                 
                                                                        
      *OLD MOVE TSK-TERM-ALF TO WSS-HDR-TERM.                           
      *OLD MOVE WSS-HDR-COLA TO QUE-COLA.                               
      *OLD MOVE 1 TO QUE-ITEM.                                          
      *OLD MOVE WSS-HDR-LITM TO QUE-LITM.                               
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *         DISPLAY 'GNSPPMTI: ENCONTRO COLA HDR ' QUE-ITEM         
      *OLD      MOVE QUE-ITEM TO WSS-HDR                                
      * EL HADER VIENE LITERAL EN EL MENSAJE Y NO EN TS                 
           MOVE TDI-GLS-DESC TO WSS-HDR.                                
           IF WSS-HDR-VERS = 'HV01'                                     
                MOVE 100 TO WSS-HDR-LHDR                                
                MOVE WSS-HDR-IBYA TO WSS-IND-IBYA                       
                MOVE WSS-HDR-USER TO     TSC-USER                       
                IF WSS-HDR-BNCO NOT > SPACES                            
                    PERFORM SET-DFL-AMB                                 
                ELSE                                                    
                    PERFORM SET-CNX-HDR                                 
                                                                        
                                                                        
           ELSE                                                         
                MOVE ZEROES TO WSS-HDR-LHDR                             
      * SI NO HAY HDR LEE QUE TSL                                       
      *          MOVE WSS-TSL-LITM TO QUE-LITM                          
      *          MOVE QUE-GET TO QUE-CMND                               
      *          MOVE 1 TO QUE-NITM                                     
      *          PERFORM GNS-PRO-QUE                                    
      *AMB*     DISPLAY 'GNSPPMTD DESPUES DE LEER QUE-AMB QUE STAT '    
      *AMB*                 QUE-STAT.                                   
      *          IF QUE-STAT = QUE-STAT-OKS                             
      *              MOVE QUE-ITEM TO WSS-TSL                           
      *              DISPLAY 'GNSPPMTD VA A PRO-CCI PO OK'              
      *          ELSE                                                   
                    PERFORM SET-DFL-AMB.                                
                                                                        
      *    DISPLAY 'GNSPPMTD ANTES   PRO-CCI'.                          
           PERFORM PRO-CCI.                                             
      *    DISPLAY 'GNSPPMTD DESPUES PRO-CCI'.                          
      *AMB-INI MANEJO DE HEADER Y BYTE ATRIBUTOS                        
      *OLD MOVE SPACES TO WSS-IND-QUE.                                  
      *OLD MOVE TSK-TERM-ALF TO WSS-HDR-TERM.                           
      *OLD MOVE WSS-HDR-COLA TO QUE-COLA.                               
      *OLD MOVE 1            TO QUE-NITM.                               
      *OLD MOVE WSS-HDR-LITM TO QUE-LITM.                               
      *OLD MOVE QUE-GET TO QUE-CMND.                                    
      *OLD PERFORM GNS-PRO-QUE.                                         
      *OLD IF QUE-STAT = QUE-STAT-OKS                                   
      *OLD       MOVE QUE-ITEM TO WSS-HDR-ITEM                          
      *OLD       MOVE QUE-DEL TO QUE-CMND                               
      *OLD       PERFORM GNS-PRO-QUE                                    
      *OLD ELSE                                                         
      *OLD       MOVE ZEROES TO WSS-HDR-LHDR.                           
                                                                        
           MOVE 1 TO WSS-BTDI.                                          
                                                                        
           ADD WSS-HDR-LHDR TO WSS-BTDI.                                
                                                                        
           MOVE WSS-COD-ORIG-SRV TO WSS-COD-ORIG.                       
                                                                        
           PERFORM DFL-TO-TSC.                                          
                                                                        
           PERFORM HDR-TO-TSC.                                          
                                                                        
           PERFORM DEL-TSI.                                             
                                                                        
           PERFORM DEL-TSO.                                             
                                                                        
      *     MOVE '****0001****' TO WSS-MIRA.                            
      *     PERFORM GNS-ERR-QUE.                                        
           PERFORM MSG-FROM-SRV UNTIL                                   
              TDI-COD-TDI(WSS-BTDI) NOT > SPACES OR                     
              WSS-IND-ERR = 'S'.                                        
                                                                        
      *     MOVE '****0008****' TO WSS-MIRA.                            
      *     PERFORM GNS-ERR-QUE.                                        
                                                                        
           MOVE ZEROES TO WSS-RKEY-TSI.                                 
           MOVE WSS-COD-ORIG-HST TO WSS-COD-ORIG.                       
           MOVE 1 TO WSS-BTDI.                                          
           MOVE ZEROES TO WSS-IDX-FRM-SRV.                              
                                                                        
           MOVE ZEROES TO WSS-IDX-SRV.                                  
           MOVE SPACES TO TDO-GLS-DATA IN TDO.                          
      *    IF WSS-IND-ERR = 'N'                                         
                                                                        
               PERFORM MSG-TO-SRV.                                      
                                                                        
           IF WSS-IND-ERR = 'S'                                         
               PERFORM BUS-ERR.                                         
                                                                        
      *    ELSE                                                         
      *        PERFORM LEE-TSO                                          
                                                                        
              PERFORM PUT-TDO.                                          
                                                                        
                                                                        
      *ISP ELIMINA T.S. YA USADAS                                       
                                                                        
      *     PERFORM DEL-ABP.                                            
      *     PERFORM DEL-TSI.                                            
      *     PERFORM DEL-TSO.                                            
                                                                        
           MOVE WSS-IND-ERR TO WSS-IERR.                                
           IF EIBCALEN > 0                                              
               IF EIBCALEN < WSS-TCMA                                   
                   MOVE EIBCALEN TO WSS-TCMA                            
               END-IF                                                   
               MOVE WSS-CMMA(1:WSS-TCMA) TO DFHCOMMAREA                 
           END-IF.                                                      
                                                                        
           PERFORM FIN.                                                 
       FIN-MAIN.                                                        
           EXIT.                                                        
                                                                        
       SET-DFL-AMB SECTION.                                             
       INI-SET-DFL-AMB.                                                 
           MOVE 'BCI'        TO TSC-BNCO.                               
           MOVE 'BCI'        TO TSC-MRCA.                               
           MOVE 'BEE'        TO TSC-CART.                               
           MOVE 'ES'         TO TSC-LENG.                               
           MOVE 'CL'         TO TSC-PAIS.                               
           MOVE SPACES       TO TSC-VRNT.                               
           MOVE SPACES       TO TSC-UMUA.                               
           MOVE SPACES       TO TSC-MODO.                               
       FIN-SET-DFL-AMB.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       SET-CNX-HDR SECTION.                                             
       INI-SET-CNX-HDR.                                                 
           MOVE WSS-HDR-BNCO TO TSC-BNCO.                               
           MOVE WSS-HDR-MRCA TO TSC-MRCA.                               
           MOVE WSS-HDR-CART TO TSC-CART.                               
           MOVE WSS-HDR-LENG TO TSC-LENG.                               
           MOVE WSS-HDR-PAIS TO TSC-PAIS.                               
           MOVE WSS-HDR-VRNT TO TSC-VRNT.                               
           MOVE WSS-HDR-CNAL TO TSC-CNAL.                               
           MOVE WSS-HDR-UMUA TO TSC-UMUA.                               
           MOVE WSS-HDR-MODO TO TSC-MODO.                               
       FIN-SET-CNX-HDR.                                                 
           EXIT.                                                        
                                                                        
                                                                        
       PUT-ESTD SECTION.                                                
       INI-PUT-ESTD.                                                    
      *    ADD 1 TO WSS-ESTD-CTAB-02.                                   
      *    MOVE 'GNS' TO FIO-SIST.                                      
      *    MOVE 'MSG' TO TAB-COD-TTAB IN TAB.                           
      *    MOVE WSS-ESTD-CTAB TO TAB-COD-CTAB IN TAB.                   
      *    MOVE EIBTIME TO WSS-ESTD-HORA.                               
      *    MOVE WSS-ESTD-HORA TO WSS-ESTD-DESC-05.                      
      *    MOVE WSS-ESTD-DESC TO TAB-GLS-DESC.                          
      *    MOVE FIO-PUT TO FIO-CMND.                                    
      *    PERFORM GNS-FIO-TAB.                                         
       FIN-PUT-ESTD.                                                    
           EXIT.                                                        
       BUS-ERR SECTION.                                                 
       INI-BUS-ERR.                                                     
                                                                        
           MOVE 'DTCERR' TO QUE-COLA.                                   
           MOVE QUE-DEL TO QUE-CMND.                                    
      *    PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE SPACES TO QUE-ITEM.                                     
           MOVE 'DTCERR' TO QUE-COLA.                                   
           MOVE WSS-MAX-FLD-HST TO WSS-NUM-L3.                          
           MOVE WSS-NUM-L3 TO QUE-IKEY.                                 
           MOVE TSO TO QUE-DATA.                                        
           MOVE +2000 TO QUE-LITM.                                      
           MOVE QUE-PUT TO QUE-CMND.                                    
      *    PERFORM GNS-PRO-QUE.                                         
                                                                        
           MOVE SPACES TO QUE-ITEM.                                     
           MOVE 'DTCERR' TO QUE-COLA.                                   
           MOVE WSS-GLS-POS-HST TO QUE-DATA.                            
           MOVE +2000 TO QUE-LITM.                                      
           MOVE QUE-PUT TO QUE-CMND.                                    
      *    PERFORM GNS-PRO-QUE.                                         
                                                                        
           IF SCR-IERR = 'A'                                            
                MOVE 'ERROR DE SISTEMA : ' TO WSS-GLS-ERR-PTC           
                GO TO FIN-BUS-ERR.                                      
           MOVE 'N' TO WSS-DTC-ERR.                                     
           SUBTRACT 1 FROM WSS-TOT-FLD-HST GIVING                       
               WSS-MAX-FLD-HST.                                         
           PERFORM DTC-ERR VARYING WSS-IDX-ERR FROM 1                   
               BY 1 UNTIL WSS-DTC-ERR = 'S' OR                          
                       WSS-IDX-ERR > WSS-MAX-FLD-HST.                   
                                                                        
      *LGM-BNL-06.04.1995-INI                                           
           IF TDI-GLS-ERROR AND WSS-DTC-ERR = 'S'                       
              MOVE WSS-MNU-GLS-ERRO TO MNU-GLS-NFRM                     
              MOVE WSS-MNU-COD-CMND TO MNU-COD-CMND.                    
      *LGM-BNL-06.04.1995-FIN                                           
                                                                        
           IF WSS-DTC-ERR = 'S'                                         
                PERFORM PUT-POS                                         
                MOVE TDI-COD-SIST-FRM TO FIO-SIST                       
                MOVE 'MSG' TO TAB-COD-TTAB IN TAB                       
      * && : CORRELATIVO DE CAMPO                                       
                MOVE '&&'         TO WSS-MSG-PTC0                       
                MOVE MNU-GLS-NFRM TO WSS-SEP-NFRM                       
                MOVE WSS-SEP-NFRM2 TO WSS-MSG-PTC1                      
      *          MOVE MNU-COD-CMND TO WSS-MSG-PTC2                      
                MOVE WSS-NUM-ERR-PTC TO WSS-MSG-PTC3                    
                MOVE WSS-MSG-PTC TO TAB-COD-CTAB IN TAB                 
      * << a.e.v. 27-03-1995  - ini                                     
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS                                          
                   MOVE TAB-GLS-DESC TO WSS-GLS-ERR-PTC                 
               ELSE                                                     
      * << a.e.v. 27-03-1995  -fin                                      
                    MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-ERR-PTC.        
       FIN-BUS-ERR.                                                     
           EXIT.                                                        
                                                                        
       DTC-ERR SECTION.                                                 
       INI-DTC-ERR.                                                     
      * ADD 12 - 3 = 9 : , PUES EN ESTA INSTANCIA ESTA ENTREGANDO       
      * EN VECTOR DE POSICIONES, LA POSICION DONDE EMPIEZA              
      * EL CAMPO Y SE REQUIERe LA POSICION DEL BYTE DE ATRIBUTOS        
      * DIFF ISP 10-02-1996                                             
      * DIFF ISP ESTA DIFERENCIA AUN NO HA SIDO DETECTADA               
      * SI SE DEBE SUMAR 9 O 12                                         
           ADD 9 WSS-NUM-POS-HST(WSS-IDX-ERR)                           
      *    ADD 12 WSS-NUM-POS-HST(WSS-IDX-ERR)                          
               GIVING WSS-IDX-FLD-ERR.                                  
           MOVE TSO-COD-FRM-HST(WSS-IDX-FLD-ERR) TO WSS-NUM-XX1.        
           ADD 1 TO WSS-IDX-FLD-ERR.                                    
           MOVE TSO-COD-FRM-HST(WSS-IDX-FLD-ERR) TO WSS-NUM-XX2.        
           IF WSS-NUM-99 NOT NUMERIC                                    
               MOVE WSS-IDX-ERR TO WSS-NUM-ERR-PTC                      
               MOVE 'S' TO WSS-DTC-ERR.                                 
       FIN-DTC-ERR.                                                     
           EXIT.                                                        
                                                                        
       PUT-POS SECTION.                                                 
       INI-PUT-POS.                                                     
                                                                        
      * ESTE CODIGO GRABA LAS POSICIONES DE LOS CAMPOS                  
      * PARA DEBUG EN DESARROLLO                                        
      *                                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.                           
           MOVE 'ZZZZZZZZZZZZ' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
               MOVE FIO-MOD TO FIO-CMND                                 
           ELSE                                                         
               MOVE FIO-PUT TO FIO-CMND.                                
           MOVE WSS-GLS-POS-HST TO TAB-GLS-DESC IN TAB.                 
           PERFORM GNS-FIO-TAB.                                         
       FIN-PUT-POS.                                                     
           EXIT.                                                        
                                                                        
      * GNS-GET-IDD SECTION.                                            
      * INI-GNS-GET-IDD.                                                
      **La independencia de datos es IDD EN TEMPORARY                   
      **STORAGE ( VERSION 3                                             
      *     MOVE TSC-CIDD TO IDD-COD-CIDD IN IDD.                       
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
      *     PERFORM GNS-FIO-IDD.                                        
      *     IF FIO-STAT-OKS                                             
      *         MOVE IDD TO IDD-REGI                                    
      *         GO TO FIN-GNS-GET-IDD.                                  
      *     MOVE 'DEFAULT' TO IDD-COD-CIDD IN IDD.                      
      *     MOVE FIO-GET-KEY TO FIO-CMND.                               
      *     PERFORM GNS-FIO-IDD.                                        
      *     IF NOT FIO-STAT-OKS                                         
      *         MOVE 'NO EXISTE REGISTRO IDD CON LLAVE : ' TO SYS-MEN1  
      *         MOVE IDD-COD-CIDD IN IDD                   TO SYS-MEN2  
      *         MOVE SYS-ABOR TO SYS-CMND                               
      *         PERFORM GNS-PRO-SYS                                     
      *     ELSE                                                        
      *         MOVE IDD TO IDD-REGI.                                   
      * FIN-GNS-GET-IDD.                                                
      *     EXIT.                                                       
                                                                        
      * Modulo interactivo que busca IDD.                               
      * ( EN ESTE PROGRAMA NO USA SCR-QIDD)                             
       GNS-GET-IDD SECTION.                                             
       INI-GNS-GET-IDD.                                                 
                                                                        
           MOVE WSS-QIDD      TO QUE-COLA.                              
           MOVE   +1          TO QUE-NITM.                              
           MOVE WSS-QIDD-LEN  TO QUE-LITM.                              
           MOVE QUE-GET TO QUE-CMND.                                    
                                                                        
           MOVE SPACES TO WSS-IND-QUE.                                  
           PERFORM GNS-PRO-QUE.                                         
           MOVE QUE-ITEM TO IDD-REGI.                                   
      *    DISPLAY ' GNSPPMTD STATUS GNS-GET-IDD COLA STAT DATOS '      
      *         QUE-COLA '-' QUE-STAT '-' IDD-REGI.                     
       FIN-GNS-GET-IDD.                                                 
           EXIT.                                                        
                                                                        
                                                                        
      * GET-IDD-IFD SECTION.                                            
      * INI-GET-IDD-IFD.                                                
      *     IF TSC-TIND = 'T'                                           
      *         PERFORM GET-IDD                                         
      *     ELSE                                                        
      *         PERFORM GET-IFD.                                        
      * FIN-GET-IDD-IFD.                                                
      *     EXIT.                                                       
                                                                        
      * GET-IDD SECTION.                                                
      * INI-GET-IDD.                                                    
      *     MOVE TSC-CIDD TO IDD-COD-CIDD IN IDD                        
      *     MOVE FIO-GET-KEY TO FIO-CMND                                
      *     PERFORM GNS-FIO-IDD                                         
      *     IF NOT FIO-STAT-OKS                                         
      *          MOVE 'DEFAULT' TO IDD-COD-CIDD IN IDD                  
      *          MOVE FIO-GET-KEY TO FIO-CMND                           
      *          PERFORM GNS-FIO-IDD                                    
      *          IF NOT FIO-STAT-OKS                                    
      *              MOVE 'NO EXISTE REGISTRO IDD CON LLAVE :'          
      *                            TO SYS-MEN1                          
      *              MOVE TSC-CIDD TO SYS-MEN2                          
      *              MOVE SYS-ABOR TO SYS-CMND                          
      *              PERFORM GNS-PRO-SYS.                               
                                                                        
      *    MOVE IDD TO IDD-REGI.                                        
      *    PERFORM GNS-PUT-IDD.                                         
      *    MOVE WSS-QIDD TO SCR-QIDD.                                   
      *    MOVE QUE-LITM TO SCR-LIDD.                                   
      *FIN-GET-IDD.                                                     
      *    EXIT.                                                        
                                                                        
      * GET-IFD SECTION.                                                
      * INI-GET-IFD.                                                    
      **    IF ( TSC-TIND = 'C' ) OR ( TSC-TINF NOT > SPACES )          
      *     MOVE TSC-CIDD  TO IFD-COD-CIFD IN IFD                       
      *     MOVE FIO-GET-KEY TO FIO-CMND                                
      *     PERFORM GNS-FIO-IFD                                         
      *     IF NOT FIO-STAT-OKS                                         
      *         MOVE 'DEFAULT' TO IFD-COD-CIFD IN IFD                   
      *         MOVE FIO-GET-KEY TO FIO-CMND                            
      *         PERFORM GNS-FIO-IFD                                     
      *         IF NOT FIO-STAT-OKS                                     
      *             MOVE 'NO EXISTE REGISTRO IFD CON LLAVE :'           
      *                           TO SYS-MEN1                           
      *             MOVE TSC-CIDD TO SYS-MEN2                           
      *             MOVE SYS-ABOR TO SYS-CMND                           
      *             PERFORM GNS-PRO-SYS.                                
                                                                        
      *     MOVE IFD-GLS-DATA IN IFD TO IFD-FSIS.                       
      * FIN-GET-IFD.                                                    
      *     EXIT.                                                       
                                                                        
       GNS-PUT-IDD SECTION.                                             
       INI-GNS-PUT-IDD.                                                 
           EXEC CICS HANDLE CONDITION                                   
                     QIDERR (PUT-GNS-PUT-IDD)                           
                     ITEMERR(PUT-GNS-PUT-IDD)                           
           END-EXEC.                                                    
           MOVE +490     TO QUE-LITM.                                   
                                                                        
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-ULOG TO WSS-TIDD.                              
           MOVE TSK-TERM-ALF TO WSS-TIDD.                               
      *  27-JUL-1993 08:32:52 - FIN                                     
           MOVE +1       TO QUE-NITM.                                   
           EXEC CICS WRITEQ TS                                          
                     QUEUE(WSS-QIDD)                                    
                     FROM(IDD-REGI)                                     
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
                     REWRITE                                            
           END-EXEC.                                                    
      * ISP  11-NOV-1992                                                
           PERFORM GNS-ERR-QUE.                                         
           GO TO FIN-GNS-PUT-IDD.                                       
       PUT-GNS-PUT-IDD.                                                 
           EXEC CICS WRITEQ TS                                          
                     QUEUE(WSS-QIDD)                                    
                     FROM(IDD-REGI)                                     
                     LENGTH(QUE-LITM)                                   
           END-EXEC.                                                    
      * ISP  11-NOV-1992                                                
           PERFORM GNS-ERR-QUE.                                         
       FIN-GNS-PUT-IDD.                                                 
            EXIT.                                                       
                                                                        
      * COPY GNSBBIDD.                                                  
       COPY GNSBFIDD.                                                   
      * COPY GNSBFIFD.                                                  
      * COPY GNSBGVSM.                                                  
                                                                        
      * ISP  11-NOV-1992                                                
      * COPY GNSBGTDQ.                                                  
      *                                                                 
      * CH-INI                                                          
      *COPY LDCBFTDI.                                                   
       COPY GNSBFTXI.                                                   
      * CH-FIN                                                          
                                                                        
      * CH-INI                                                          
      *COPY LDCBFTDO.                                                   
       COPY GNSBFTXO.                                                   
      * CH-FIN                                                          
                                                                        
       COPY GNSBFTSI.                                                   
      * COPY GNSBFABP.                                                  
       COPY GNSBFTSO.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBHVSM.                                                   
                                                                        
       COPY GNSBGEND.                                                   
       COPY GNSBFTAB.                                                   
                                                                        
       COPY GNSBHSYS.                                                   
       COPY GNSBGSYS.                                                   
      * Rutina de Servicios del Sistema                                 
      * V 3.1                                                           
      *       GNS-PRO-SYS SECTION.                                      
      *       INI-GNS-PRO-SYS.                                          
      *           MOVE SYS-STAT-OKS TO SYS-STAT.                        
      *           IF SYS-IHDL NOT > SPACES                              
      *               MOVE 'N' TO SYS-IHDL                              
      *               EXEC CICS IGNORE CONDITION                        
      *                     INVREQ                                      
      *                     LENGERR                                     
      *                     PGMIDERR                                    
      *               END-EXEC.                                         
      *           GO TO DAT-GNS-PRO-SYS TIM-GNS-PRO-SYS EXT-GNS-PRO-SYS 
      *                 XCT-GNS-PRO-SYS LNK-GNS-PRO-SYS ABT-GNS-PRO-SYS 
      *           DEPENDING ON SYS-CMND.                                
      *           MOVE 'ABORTO, comando invalido en GNS-PRO-SYS:' TO SYS
      *           MOVE SYS-CMND                                   TO SYS
      *           GO TO ABT-GNS-PRO-SYS.                                
      *       DAT-GNS-PRO-SYS.                                          
      *           EXEC CICS ASKTIME                                     
      *           END-EXEC.                                             
      *           MOVE EIBDATE TO SYS-JHOY.                             
      *           MOVE EIBTIME TO SYS-HHOY.                             
      *           MOVE SYS-AAHY TO SYS-AHOY.                            
      *           DIVIDE SYS-AAHY BY 4 GIVING SYS-REST REMAINDER SYS-RES
      *           IF SYS-DDHY > 59 AND SYS-REST NOT = 0                 
      *               ADD 1 TO SYS-DDHY.                                
      *           PERFORM FIN-GNS-PRO-SYS VARYING SYS-SIND FROM 1 BY 1 U
      *               SYS-SIND > 12 OR SYS-DDHY NOT > SYS-DACU(SYS-SIND)
      *           SUBTRACT 1 FROM SYS-SIND.                             
      *           MOVE SYS-SIND TO SYS-MHOY.                            
      *           SUBTRACT SYS-DACU(SYS-SIND) FROM SYS-DDHY GIVING SYS-D
      *      * Mueve al Time Stamp                                      
      *           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.                
      *           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.                
      *           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.                
      *      *                                                          
      *           MOVE SYS-HHHY TO SYS-HHTS IN SYS-HSTP-RED.            
      *           MOVE SYS-MMHY TO SYS-MMTS IN SYS-HSTP-RED.            
      *           MOVE SYS-SSHY TO SYS-SSTS IN SYS-HSTP-RED.            
      *           GO TO FIN-GNS-PRO-SYS.                                
      *       TIM-GNS-PRO-SYS.                                          
      *           EXEC CICS ASKTIME                                     
      *           END-EXEC.                                             
      *           MOVE EIBTIME TO SYS-HHOY.                             
      *           GO TO FIN-GNS-PRO-SYS.                                
      *       EXT-GNS-PRO-SYS.                                          
      *           EXEC CICS RETURN                                      
      *                     TRANSID(SYS-NTRN)                           
      *                     COMMAREA(SYS-CMMA)                          
      *                     LENGTH(SYS-TCMA)                            
      *           END-EXEC.                                             
      *           GO TO STT-GNS-PRO-SYS.                                
      *       XCT-GNS-PRO-SYS.                                          
      *           EXEC CICS XCTL                                        
      *                     PROGRAM(SYS-PROG)                           
      *                     COMMAREA(SYS-CMMA)                          
      *                     LENGTH(SYS-TCMA)                            
      *           END-EXEC.                                             
      *           GO TO STT-GNS-PRO-SYS.                                
      *       LNK-GNS-PRO-SYS.                                          
      *           EXEC CICS LINK                                        
      *                     PROGRAM(SYS-PROG)                           
      *                     COMMAREA(SYS-CMMA)                          
      *                     LENGTH(SYS-TCMA)                            
      *           END-EXEC.                                             
      *           GO TO STT-GNS-PRO-SYS.                                
      *                                                                 
      *       ABT-GNS-PRO-SYS.                                          
      *           MOVE SYS-PABT TO SYS-PROG.                            
      *           MOVE +3500    TO SYS-TCMA.                            
      *           MOVE SYS-MENS TO SYS-SCR-MENS.                        
      *           MOVE OSC-VARI TO SYS-SCR-VARI.                        
      *           EXEC CICS XCTL                                        
      *                     PROGRAM(SYS-PROG)                           
      *                     COMMAREA(SYS-CMMA)                          
      *                     LENGTH(SYS-TCMA)                            
      *           END-EXEC.                                             
      *           GOBACK.                                               
      *                                                                 
      *       STT-GNS-PRO-SYS.                                          
      *           IF EIBRESP = ZEROES                                   
      *               MOVE '00' TO SYS-STAT                             
      *               GO TO FIN-GNS-PRO-SYS.                            
      *      *    CONDITION : PGMIDERR                                  
      *           IF EIBRESP = 27                                       
      *               MOVE '23' TO SYS-STAT                             
      *               MOVE 'PGMIDERR EN GNS-PRO-SYS, CMD : ' TO SYS-MEN1
      *               MOVE SYS-CMND                          TO SYS-MEN2
      *               GO TO FIN-GNS-PRO-SYS.                            
      *      *    CONDITION : INVREQ                                    
      *           IF EIBRESP = 16                                       
      *               MOVE '16' TO SYS-STAT                             
      *               MOVE 'INVREQ EN GNS-PRO-SYS, CMD : '   TO SYS-MEN1
      *               MOVE SYS-CMND                          TO SYS-MEN2
      *               GO TO ABT-GNS-PRO-SYS.                            
      *      *    CONDITION : LENGERR                                   
      *           IF EIBRESP = 22                                       
      *               MOVE '22' TO SYS-STAT                             
      *               MOVE 'LENGERR EN GNS-PRO-SYS, CMD : '  TO SYS-MEN1
      *               MOVE SYS-CMND                          TO SYS-MEN2
      *               GO TO ABT-GNS-PRO-SYS.                            
      *           MOVE 'Aborto, EN GNS-PRO-SYS , CMD : ' TO SYS-MEN1.   
      *           MOVE SYS-CMND                          TO SYS-MEN2.   
      *           MOVE '99' TO SYS-STAT.                                
      *                                                                 
      *           GO TO ABT-GNS-PRO-SYS.                                
      *       FIN-GNS-PRO-SYS.                                          
      *           EXIT.                                                 
                                                                        
       COPY GNSBFMNM.                                                   
       COPY GNSBFRPM.                                                   
       COPY GNSBIABT.                                                   
                                                                        
       MSG-FROM-SRV SECTION.                                            
       INI-MSG-FROM-SRV.                                                
      *     MOVE '****0002****' TO WSS-MIRA.                            
      *     PERFORM GNS-ERR-QUE.                                        
                                                                        
      * ISP: MUEVE C.P.C. HEADER DEL SRV                                
                                                                        
      * ISP: APUNTA AL PRIMER CARACTER DE INFORMACION DE UNA PANTALLA   
      *      DE LA CADENA DEL SERVER                                    
           ADD 21 WSS-BTDI GIVING WSS-IDX-FRM-SRV.                      
           MOVE 21 TO WSS-LTDI.                                         
           MOVE ZEROES TO WSS-CTDI.                                     
                                                                        
           PERFORM MOV-HDR-SRV VARYING WSS-ITDI FROM WSS-BTDI BY 1      
             UNTIL WSS-CTDI = WSS-LTDI.                                 
                                                                        
      *     MOVE '****0003****' TO WSS-MIRA.                            
      *     PERFORM GNS-ERR-QUE.                                        
                                                                        
      * ISP: LA NUEVA BASE ES EL SIGUIENTE CARACTER AL ULTIMO EN CADA HE
      *      DE LA CADENA DEL SERVER                                    
           MOVE WSS-ITDI TO WSS-BTDI.                                   
                                                                        
           PERFORM TDI-TO-TSC.                                          
                                                                        
      *     MOVE '****0004****' TO WSS-MIRA.                            
      *     PERFORM GNS-ERR-QUE.                                        
                                                                        
           PERFORM GET-MNU.                                             
                                                                        
           MOVE MNU-GLS-NFRM IN MNU TO WSS-MNU-GLS-NFRM.                
      * ISP: DETECTA NUEVO ELEMENTO ( FOUT, NFRM ) PRA CONTESTAR        
      *      POSTERIORMENTE AL SERVER                                   
           ADD 1 TO WSS-IDX-SRV.                                        
           MOVE TDI-COD-SIST-FRM    TO WSS-SRV-SIST(WSS-IDX-SRV).       
           MOVE TDI-COD-FOUT-FRM    TO WSS-SRV-FOUT(WSS-IDX-SRV).       
           MOVE MNU-GLS-NFRM IN MNU TO WSS-SRV-NFRM(WSS-IDX-SRV).       
                                                                        
           PERFORM GET-TSI.                                             
                                                                        
           IF FIO-STAT-OKS                                              
               IF MNU-GLS-NFRM IN MNU NOT = TSI-GLS-NFRM IN TSI OR      
                  MNU-COD-INST = 'GKY'                                  
                   PERFORM DEL-TSI                                      
                   MOVE SPACES TO TSI-DATA                              
                   MOVE '23' TO PGM-STAT-TSI                            
               ELSE                                                     
                   MOVE '00' TO PGM-STAT-TSI                            
           ELSE                                                         
                   MOVE '23' TO PGM-STAT-TSI.                           
                                                                        
           PERFORM MNU-TO-TSC.                                          
                                                                        
           PERFORM GET-RPF.                                             
                                                                        
           IF TSC-I > ZEROES                                            
               PERFORM RPF-TO-TSC.                                      
                                                                        
      *     PERFORM GET-IDD-IFD.                                        
                                                                        
                                                                        
      *SE CARGAN VARIABLES DEPENDIENDO DE TSC-TINF                      
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )           
               PERFORM PRO-MOVE-SCR1                                    
           ELSE                                                         
               PERFORM PRO-MOVE-SCR2.                                   
                                                                        
           PERFORM PRO-MOVE-VSYS.                                       
                                                                        
      * CARGA EL SISTEMA DONDE BUSCAR LA DEFINICION DE FORMATOS         
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.                           
           PERFORM GET-DEF-SRV.                                         
                                                                        
           PERFORM GET-DEF-HST.                                         
                                                                        
                                                                        
           MOVE 1 TO WSS-IDX-FLD-SRV.                                   
                                                                        
           PERFORM PUT-INF-TO-HST VARYING WSS-IDX-FLD-HST               
                 FROM 1 BY 1 UNTIL WSS-IDX-FLD-HST > WSS-TOT-FLD-HST    
                   ADD 15 WSS-NUM-POS-HST(WSS-TOT-FLD-HST)              
                       GIVING WSS-PINI                                  
                   ADD WSS-NUM-LEN-HST(WSS-TOT-FLD-HST) TO WSS-PINI     
                   MOVE ' ' TO TSI-COD-FRM-HST(WSS-PINI).               
                                                                        
           IF NOT PGM-STAT-TSI-OKS                                      
               PERFORM PUT-TSI                                          
           ELSE                                                         
               PERFORM MOD-TSI.                                         
                                                                        
           PERFORM PRO-CALL-LINK.                                       
           MOVE WSS-IDX-FRM-SRV TO WSS-BTDI.                            
       FIN-MSG-FROM-SRV.                                                
           EXIT.                                                        
                                                                        
       MSG-TO-SRV SECTION.                                              
       INI-MSG-TO-SRV.                                                  
                                                                        
           PERFORM GET-TSO.                                             
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-MSG-TO-SRV.                                    
                                                                        
      * ISP: SIMULA CAMPOS DEL MNU PARA CARGAR DEFINICIONES             
                                                                        
           ADD 1 TO WSS-IDX-SRV.                                        
           MOVE WSS-SRV-NFRM(WSS-IDX-SRV) TO MNU-GLS-NFRM IN MNU.       
           MOVE WSS-SRV-FOUT(WSS-IDX-SRV) TO TDI-COD-FOUT-FRM.          
           MOVE WSS-SRV-SIST(WSS-IDX-SRV) TO FIO-SIST.                  
                                                                        
      *    MOVE WSS-IDX-SRV TO QUE-NITM.                                
      *DBG MOVE +100 TO QUE-LITM.                                       
      *DBG MOVE 'SRVISP' TO QUE-COLA.                                   
      *DBG MOVE WSS-SRV-VARI(WSS-IDX-SRV) TO QUE-ITEM.                  
      *DBG MOVE QUE-PUT TO QUE-CMND.                                    
      *DBG PERFORM GNS-PRO-QUE.                                         
                                                                        
           PERFORM GET-DEF-SRV.                                         
                                                                        
           PERFORM GET-DEF-HST.                                         
                                                                        
           IF TDI-COD-FOUT-FRM NOT > SPACES                             
               GO TO INI-MSG-TO-SRV.                                    
           PERFORM PUT-INF-TO-SRV VARYING WSS-IDX-FLD-SRV               
                 FROM 1 BY 1 UNTIL WSS-IDX-FLD-SRV > WSS-TOT-FLD-SRV.   
                                                                        
           ADD WSS-LMSG-SRV TO WSS-BTDI.                                
           GO TO INI-MSG-TO-SRV.                                        
       FIN-MSG-TO-SRV.                                                  
           EXIT.                                                        
                                                                        
       LEE-TSO SECTION.                                                 
       INI-LEE-TSO.                                                     
                                                                        
           PERFORM GET-TSO.                                             
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-LEE-TSO.                                       
                                                                        
           GO TO INI-LEE-TSO.                                           
       FIN-LEE-TSO.                                                     
           EXIT.                                                        
                                                                        
       GET-TDI SECTION.                                                 
       INI-GET-TDI.                                                     
      *     PERFORM GNS-ERR-TDQ.                                        
           MOVE 1 TO TDI-NUM-RECO.                                      
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TDI.                                         
           IF NOT FIO-STAT-OKS AND                                      
                  QUE-NITM = 2                                          
                    MOVE '00' TO FIO-STAT                               
                    MOVE QUE-STAT-OKS TO QUE-STAT.                      
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ABORTO: NO EXISTE MENSAJE DESDE TDI' TO SYS-MENS   
               MOVE SYS-ABOR TO SYS-CMND                                
               PERFORM GNS-PRO-SYS.                                     
       FIN-GET-TDI.                                                     
           EXIT.                                                        
                                                                        
       PUT-TDO SECTION.                                                 
       INI-PUT-TDO.                                                     
      *DAD ini  08-OCT-1992                                             
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM GNS-FIO-TDO.                                         
      *DAD fin  08-OCT-1992                                             
      *JSS                                                              
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-SDE2 IN TDI TO TDI-COD-SDE1 IN TDI.            
      *     MOVE TDI-COD-TDE2 IN TDI TO TDI-COD-TDE1 IN TDI.            
      *  27-JUL-1993 08:32:52 - FIN                                     
      *JSS-FIN                                                          
      *     MOVE TDI-COD-TRAN IN TDI TO TDO-COD-TRAN IN TDO.            
      *     MOVE TDI-COD-SIST IN TDI TO TDO-COD-SIST IN TDO.            
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-TERM IN TDI TO TDO-COD-TERM IN TDO.            
      *     MOVE TDI-COD-NUOP IN TDI TO TDO-COD-NUOP IN TDO.            
      *  27-JUL-1993 08:32:52 - FIN                                     
      *JSS MOVE TDI-COD-TDE2 IN TDI TO TDO-COD-TDE1 IN TDO.             
      *    MOVE TDI-COD-TDE2 IN TDI TO TDO-COD-TDE2 IN TDO.             
      *  27-JUL-1993 08:32:52 - INI                                     
      *     MOVE TDI-COD-SDE1 IN TDI TO TDO-COD-SDE1 IN TDO.            
      *     MOVE TDI-COD-TDE1 IN TDI TO TDO-COD-TDE1 IN TDO.            
      *     MOVE TDI-COD-SDE2 IN TDI TO TDO-COD-SDE2 IN TDO.            
      *     MOVE TDI-COD-TDE2 IN TDI TO TDO-COD-TDE2 IN TDO.            
      **DAD ini  08-OCT-1992                                            
      *     MOVE TDI-COD-TMSG IN TDI TO TDO-COD-TMSG IN TDO.            
      **DAD fin  08-OCT-1992                                            
      *     MOVE '1'                 TO TDO-COD-IPVR IN TDO.            
      **JSS-FIN                                                         
      *     MOVE TDI-COD-TRRT IN TDI TO TDO-COD-TRRT IN TDO.            
      **     MOVE TDI-COD-ULOG IN TDI TO TDO-COD-ULOG IN TDO.           
      *     MOVE TDI-TYPE TO TDO-COD-ULOG IN TDO.                       
      *  27-JUL-1993 08:32:52 - FIN                                     
      *JSS MOVE 1200                TO TDO-COD-LENG IN TDO.             
                                                                        
           IF TSO-COD-MSJE NOT > SPACES                                 
               MOVE SPACES TO TSO-COD-MSJE.                             
           IF TSO-GLS-MSJE NOT > SPACES                                 
               MOVE SPACES TO TSO-GLS-MSJE.                             
                                                                        
           IF WSS-IND-ERR = 'N'                                         
               MOVE TSO-GLS-MSJE    TO TDO-GLS-MENS                     
      *         MOVE ZEROES TO TDO-NUM-TREP                             
               MOVE '0'    TO TDO-COD-STAT                              
      *  27-JUL-1993 08:32:52 - INI                                     
      *         MOVE ZEROES TO TDO-NUM-MSGP                             
      *  27-JUL-1993 08:32:52 - FIN                                     
           ELSE                                                         
      *         MOVE 1      TO TDO-NUM-TREP                             
      *JSS-INI 20-FEB-1996                                              
      *        MOVE '1'    TO TDO-COD-STAT                              
      *JSS-FIN 20-FEB-1996                                              
      *  27-JUL-1993 08:32:52 - INI                                     
      *         MOVE ZEROES TO TDO-NUM-MSGP                             
      *  27-JUL-1993 08:32:52 - FIN                                     
               MOVE SPACES TO TDO-GLS-DESC IN TDO                       
      *JSS-INI 20-FEB-1996                                              
               MOVE '1'    TO TDO-COD-STAT                              
      *JSS-FIN 20-FEB-1996                                              
               MOVE WSS-GLS-ERR-PTC TO TDO-GLS-MENS1                    
      *        MOVE TSO-MSJE        TO TDO-GLS-MENS2.                   
               PERFORM SET-MSG-VERS.                                    
                                                                        
           MOVE SYS-GET-DATE TO SYS-CMND.                               
           PERFORM GNS-PRO-SYS.                                         
      *     MOVE 19       TO TDO-NUM-STRN IN TDO.                       
      *     MOVE SYS-AHOY TO TDO-NUM-ATRN IN TDO.                       
      *     MOVE SYS-MHOY TO TDO-NUM-MTRN IN TDO.                       
      *     MOVE SYS-DHOY TO TDO-NUM-DTRN IN TDO.                       
      *     MOVE SYS-HHHY TO TDO-NUM-HHTR IN TDO.                       
      *     MOVE SYS-MMHY TO TDO-NUM-MMTR IN TDO.                       
      *     MOVE SYS-SSHY TO TDO-NUM-SSTR IN TDO.                       
      *     MOVE ZEROES   TO TDO-NUM-IPEN IN TDO.                       
      *     MOVE WSS-ISRV TO TDO-NUM-LMSG IN TDO.                       
      *     MOVE +1252 TO TDO-NUM-LMSG IN TDO.                          
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-TDQ.                                        
           MOVE 1 TO TDO-NUM-RECO.                                      
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM GNS-FIO-TDO.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ABORTO: ERROR AL GRABAR MENSAJE TDO' TO SYS-MENS   
               MOVE SYS-ABOR TO SYS-CMND                                
               PERFORM GNS-PRO-SYS.                                     
       FIN-PUT-TDO.                                                     
           EXIT.                                                        
                                                                        
       SET-MSG-VERS SECTION.                                            
       INI-SET-MSG-VERS.                                                
           MOVE TSK-TERM-ALF TO QUE-TERM.                               
      * NO CONTEX MSG FIELD                                             
           MOVE 'NCMF' TO QUE-TYPE.                                     
           MOVE +1 TO QUE-LITM.                                         
           MOVE 1 TO QUE-NITM.                                          
           MOVE QUE-GET TO QUE-CMND                                     
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
                MOVE QUE-DEL TO QUE-CMND                                
                PERFORM GNS-PRO-QUE                                     
                MOVE TDO-COD-STAT TO MSG-TDO-COD-STAT                   
                MOVE TSO-COD-MSJE TO MSG-TDO-COD-MSJE                   
                MOVE TSO-GLS-MSJE TO MSG-TDO-GLS-MSJE                   
                MOVE MSG-TDO TO TDO-GLS-DESC                            
           ELSE                                                         
              MOVE TSO-GLS-MSJE    TO TDO-GLS-MENS2.                    
       FIN-SET-MSG-VERS.                                                
           EXIT.                                                        
                                                                        
       GET-TSI SECTION.                                                 
       INI-GET-TSI.                                                     
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-QUE.                                        
           MOVE 1 TO WSS-RKEY-TSI.                                      
           MOVE WSS-RKEY-TSI TO TSI-NUM-RECO.                           
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TSI.                                         
       FIN-GET-TSI.                                                     
           EXIT.                                                        
                                                                        
       PUT-TSI SECTION.                                                 
       INI-PUT-TSI.                                                     
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-QUE.                                        
           MOVE 1 TO WSS-RKEY-TSI.                                      
           MOVE WSS-RKEY-TSI TO TSI-NUM-RECO.                           
           MOVE WSS-MNU-GLS-NFRM TO TSI-GLS-NFRM IN TSI.                
      * ISP: GRABA AL PROGRAMA SOLO LA PANTALLA                         
           MOVE TSI-GLS-FRM-HST TO WSS-FRM-TSI.                         
           MOVE WSS-FRM-TSI TO TSI-DATA.                                
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM GNS-FIO-TSI.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ABORTO: ERROR AL GRABAR MENSAJE TSI' TO SYS-MENS   
               MOVE SYS-ABOR TO SYS-CMND                                
               PERFORM GNS-PRO-SYS.                                     
                                                                        
           MOVE SPACES TO TSI-GLS-FRM-HST.                              
           MOVE ZEROES TO WSS-NUM-99.                                   
           MOVE ZEROES TO WSS-IDX-FLD-HST.                              
           MOVE 1 TO TSI-IDX-FRM-HST.                                   
           MOVE ZEROES TO WSS-IDX-FLD-SRV.                              
       FIN-PUT-TSI.                                                     
           EXIT.                                                        
                                                                        
       PUT-ABP SECTION.                                                 
       INI-PUT-ABP.                                                     
           MOVE TSK-TERM-ALF TO QUE-TERM.                               
           MOVE 'APTC' TO       QUE-TYPE.                               
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
           MOVE TSK-TERM-ALF TO QUE-TERM.                               
           MOVE 'APTC' TO       QUE-TYPE.                               
           MOVE QUE-PUT TO QUE-CMND.                                    
           MOVE SPACES TO QUE-ITEM.                                     
           MOVE +2 TO QUE-LITM.                                         
           PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-ABP.                                                     
           EXIT.                                                        
                                                                        
      * DEL-ABP SECTION.                                                
      * INI-DEL-ABP.                                                    
      *     MOVE 1 TO ABP-NUM-RECO.                                     
      ** ISP  11-NOV-1992                                               
      **     PERFORM GNS-ERR-QUE.                                       
      *     MOVE FIO-DEL TO FIO-CMND.                                   
      *     PERFORM GNS-FIO-ABP.                                        
      * FIN-DEL-ABP.                                                    
      *     EXIT.                                                       
                                                                        
       MOD-TSI SECTION.                                                 
       INI-MOD-TSI.                                                     
           PERFORM DEL-TSI.                                             
           PERFORM PUT-TSI.                                             
       FIN-MOD-TSI.                                                     
           EXIT.                                                        
                                                                        
       DEL-TSI SECTION.                                                 
       INI-DEL-TSI.                                                     
           MOVE 1 TO TSI-NUM-RECO.                                      
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-QUE.                                        
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM GNS-FIO-TSI.                                         
       FIN-DEL-TSI.                                                     
           EXIT.                                                        
                                                                        
                                                                        
       DEL-TSO SECTION.                                                 
       INI-DEL-TSO.                                                     
           MOVE 1 TO TSO-NUM-RECO.                                      
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-QUE.                                        
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM GNS-FIO-TSO.                                         
       FIN-DEL-TSO.                                                     
           EXIT.                                                        
                                                                        
       GET-TSO SECTION.                                                 
       INI-GET-TSO.                                                     
      * ISP  11-NOV-1992                                                
      *     PERFORM GNS-ERR-QUE.                                        
           MOVE 1 TO TSI-IDX-FRM-HST.                                   
           ADD 1 TO WSS-RKEY-TSO.                                       
           MOVE WSS-RKEY-TSO TO TSO-NUM-RECO.                           
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TSO.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-GET-TSO.                                       
       FIN-GET-TSO.                                                     
           EXIT.                                                        
                                                                        
       GET-MNU SECTION.                                                 
       INI-GET-MNU.                                                     
           MOVE TDI-COD-NEMO-FRM TO MNU-COD-NEMO IN MNU.                
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM VID-MNU.                                             
           IF NOT FIO-STAT-OKS                                          
               PERFORM ERR-MNU.                                         
      *                                                                 
      *Buscar idd con codigo TSC-CIDD.                                  
      *     PERFORM GNS-GET-TSC.                                        
       FIN-GET-MNU.                                                     
           EXIT.                                                        
                                                                        
       GET-RPF SECTION.                                                 
       INI-GET-RPF.                                                     
           MOVE ZEROES TO TSC-I.                                        
           MOVE SPACES TO RPF.                                          
           MOVE MNU-GLS-PROG TO RPF-KEY-DPRO.                           
           MOVE 'C0'         TO RPF-KEY-TRYC.                           
           MOVE FIO-FND-NLS  TO FIO-CMND.                               
           PERFORM VID-RPF.                                             
           IF NOT FIO-STAT-OKS                                          
                 GO TO FIN-GET-RPF.                                     
           PERFORM LEE-CRPF.                                            
           MOVE FIO-END-BRW TO FIO-CMND.                                
           PERFORM VID-RPF.                                             
       FIN-GET-RPF.                                                     
           EXIT.                                                        
                                                                        
       LEE-CRPF SECTION.                                                
       INI-LEE-CRPF.                                                    
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM VID-RPF.                                             
           IF NOT ( FIO-STAT-OKS AND RPF-KEY-DPRO = MNU-GLS-PROG AND    
                                     RPF-KEY-TREG = 'C' )               
                   GO TO FIN-LEE-CRPF.                                  
           IF NOT ( MNU-COD-CMND IN MNU > SPACES AND                    
                    MNU-COD-CMND = RPF-COD-CCMN )                       
               GO TO INI-LEE-CRPF.                                      
           MOVE 1 TO TSC-I.                                             
       FIN-LEE-CRPF.                                                    
           EXIT.                                                        
                                                                        
       DFL-TO-TSC SECTION.                                              
       INI-DFL-TO-TSC.                                                  
           MOVE SPACES TO TSC-COLA                                      
                          TSC-ICMN                                      
                          TSC-INST                                      
                          TSC-SISG                                      
                          TSC-FFLD                                      
                          TSC-IPRV                                      
                          TSC-PROV                                      
                          TSC-NTRV                                      
                          TSC-PRMC                                      
                          TSC-RFBY.                                     
           MOVE ZEROES TO TSC-TCMA.                                     
       FIN-DFL-TO-TSC.                                                  
           EXIT.                                                        
                                                                        
       HDR-TO-TSC SECTION.                                              
       INI-HDR-TO-TSC.                                                  
      *     MOVE TDI-COD-USER TO TSC-USER.                              
       FIN-HDR-TO-TSC.                                                  
           EXIT.                                                        
                                                                        
       TDI-TO-TSC SECTION.                                              
       INI-TDI-TO-TSC.                                                  
           MOVE TDI-COD-SIST-FRM TO TSC-SIST.                           
       FIN-TDI-TO-TSC.                                                  
           EXIT.                                                        
                                                                        
       MNU-TO-TSC SECTION.                                              
       INI-MNU-TO-TSC.                                                  
           MOVE MNU-COD-OPCI TO TSC-OPCI.                               
           MOVE MNU-COD-NEMO TO TSC-NEMO.                               
      *                                                                 
           MOVE MNU-GLS-TRAN TO TSC-NTRN.                               
           MOVE MNU-GLS-PROG TO TSC-PROG.                               
           MOVE MNU-GLS-LFRM TO TSC-NLIB.                               
           MOVE MNU-GLS-NFRM TO TSC-NMAP.                               
           MOVE MNU-GLS-LDOC TO TSC-LDOC.                               
           MOVE MNU-GLS-NDOC TO TSC-NDOC.                               
           MOVE MNU-COD-FRET TO TSC-FRET.                               
           MOVE MNU-COD-INST TO TSC-TINS.                               
           MOVE MNU-COD-TCTL TO TSC-TCTL.                               
           MOVE MNU-COD-TINF TO TSC-TINF.                               
           MOVE MNU-COD-TFUN TO TSC-TFUN.                               
                                                                        
           IF WSS-COD-CIFD > SPACES                                     
               MOVE WSS-COD-CIFD TO MNU-COD-CIFD.                       
                                                                        
           MOVE MNU-COD-CIFD TO TSC-CIDD.                               
                                                                        
       FIN-MNU-TO-TSC.                                                  
           EXIT.                                                        
                                                                        
       RPF-TO-TSC SECTION.                                              
       INI-RPF-TO-TSC.                                                  
           MOVE MNU-COD-CMND TO TSC-CCMN ( TSC-I )                      
                                TSC-CMND.                               
           MOVE RPF-COD-CCPP TO TSC-CCPP ( TSC-I )                      
                                TSC-CMNP.                               
           MOVE RPF-IND-STPP TO TSC-STPP ( TSC-I ).                     
           MOVE SPACES       TO TSC-PRMT ( TSC-I ).                     
      *ISP  15-OCT-1993                                                 
      * SI RPF-GLS-CONF = SPACES, NO SE RESCATA MENSAJE Y POR LO TANTO  
      * PROGRAMA NO CONFIRMA, SI RPF-GLS-CONF = 'NOMSG' TAMPOCO CONFIRMA
      *     MOVE SPACES       TO TSC-CONF ( TSC-I ).                    
           IF RPF-GLS-CONF IN RPF = 'NOMSG'                             
               MOVE SPACES TO RPF-GLS-CONF IN RPF.                      
           MOVE RPF-GLS-CONF IN RPF TO TSC-CONF ( TSC-I ).              
           MOVE SPACES       TO TSC-UARC ( TSC-I ).                     
           IF RPF-GLS-UARC IN RPF > SPACES                              
                MOVE RPF-GLS-UARC IN RPF TO MNU-GLS-PROG IN MNU         
                                            TSC-PROG.                   
       FIN-RPF-TO-TSC.                                                  
           EXIT.                                                        
                                                                        
       VID-MNU SECTION.                                                 
       INI-VID-MNU.                                                     
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.                           
           PERFORM GNS-FIO-MNU.                                         
       FIN-VID-MNU.                                                     
           EXIT.                                                        
                                                                        
       VID-RPF SECTION.                                                 
       INI-VID-RPF.                                                     
           MOVE TDI-COD-SIST-FRM TO FIO-SIST.                           
           PERFORM GNS-FIO-RPF.                                         
       FIN-VID-RPF.                                                     
           EXIT.                                                        
                                                                        
       PRO-MOVE-SCR1 SECTION.                                           
       INI-PRO-MOVE-SCR1.                                               
           MOVE +1110              TO OSC-TCMA.                         
           MOVE TSC-SIST           TO OSC-SIST.                         
           MOVE TSC-OPCI           TO OSC-FUNC.                         
           MOVE TSC-NEMO           TO OSC-NEMO.                         
           MOVE TSC-NTRV           TO OSC-NTRV.                         
           MOVE TSC-NTRN           TO OSC-NTRN.                         
           MOVE TSC-PROG           TO OSC-PROG.                         
           MOVE TSC-NLIB           TO OSC-NLIB.                         
           MOVE TSC-NMAP           TO OSC-NMAP.                         
           MOVE TSC-LDOC           TO OSC-LDOC.                         
           MOVE TSC-NDOC           TO OSC-NDOC.                         
           MOVE TSC-FRET           TO OSC-FRET.                         
           MOVE TSC-IPRV           TO OSC-IPRV.                         
           MOVE TSC-SISG           TO OSC-SISG.                         
           IF TSC-TINS > SPACES                                         
               MOVE TSC-TINS       TO OSC-INST                          
           ELSE                                                         
               MOVE SCR-INST-HKY   TO OSC-INST.                         
           MOVE TSC-TFUN           TO OSC-TFUN.                         
           MOVE TSC-CMNP           TO OSC-CMNP.                         
           MOVE TSC-FFLD           TO OSC-FFLD.                         
           MOVE TSC-I              TO OSC-I.                            
      *    MOVE TSC-CMND           TO OSC-CMND.                         
           MOVE TSC-CCMN( TSC-I )  TO OSC-CMND.                         
           MOVE TSC-PRMC           TO OSC-PRMC.                         
           MOVE TSC-CCPP( TSC-I )  TO OSC-CCPP.                         
           MOVE TSC-STPP( TSC-I )  TO OSC-STPP.                         
           MOVE 1 TO FRM-IFLD.                                          
       LUP-PRO-MOVE-SCR1.                                               
           MOVE TSC-CCMN(FRM-IFLD) TO OSC-COD-CCMN(FRM-IFLD).           
           MOVE TSC-CCPP(FRM-IFLD) TO OSC-COD-CCPP(FRM-IFLD).           
           MOVE TSC-STPP(FRM-IFLD) TO OSC-IND-STPP(FRM-IFLD).           
           MOVE TSC-PRMT(FRM-IFLD) TO OSC-GLS-PRMT(FRM-IFLD).           
           MOVE TSC-CONF(FRM-IFLD) TO OSC-GLS-CONF(FRM-IFLD).           
           MOVE TSC-UARC(FRM-IFLD) TO OSC-GLS-UARC(FRM-IFLD).           
           ADD 1 TO FRM-IFLD.                                           
           IF FRM-IFLD NOT > 10                                         
               GO TO LUP-PRO-MOVE-SCR1.                                 
           IF TSC-USER NOT > SPACES                                     
               MOVE SPACES TO TSC-USER.                                 
           MOVE TSC-USER           TO OSC-USER.                         
           MOVE TSC-PROV           TO OSC-PROV.                         
           IF OSC-INST = 'GKY'                                          
               MOVE 'C'                TO OSC-ICMN                      
           ELSE                                                         
               MOVE 'P'                TO OSC-ICMN.                     
      * ISP: ORIGEN DESDE PTC                                           
           MOVE 'S'                TO OSC-OFRM.                         
      * JSS: ORIGEN DESDE PTC                                           
           MOVE 'N'                TO OSC-IERR.                         
       FIN-PRO-MOVE-SCR1.                                               
           EXIT.                                                        
                                                                        
      *HACE MOVE A VARIABLES DE PROGRAMA ( NUEVA VERSION )              
       PRO-MOVE-SCR2 SECTION.                                           
       INI-PRO-MOVE-SCR2.                                               
           MOVE +250               TO SCR-TCMA.                         
      * ISP:  19-AUG-1995 11:27:19                                      
      *       EN REALIA TIENE IMPORTANCIA ESTE VALOR, PUES SIEMPRE      
      *       ESTABA ENVIANDO TCMA = 250, PERO CON SYS-CMMA 3500        
      *       Y LOS PROGRAMAS HOST RECUPERABAN BIEN LA CMMA ADICIONAL   
           MOVE +3500               TO SCR-TCMA.                        
           MOVE TSC-SIST           TO SCR-SIST.                         
           MOVE TSC-SISG           TO SCR-SISG.                         
           MOVE TSC-NTRN           TO SCR-NTRN.                         
           MOVE TSC-PROG           TO SCR-PROG.                         
           MOVE TSC-NTRV           TO SCR-NTRV.                         
           MOVE TSC-PROV           TO SCR-PROV.                         
           MOVE TSC-NLIB           TO SCR-NLIB.                         
           MOVE TSC-NMAP           TO SCR-NMAP.                         
           IF TSC-TINS > SPACES                                         
               MOVE TSC-TINS       TO SCR-INST                          
           ELSE                                                         
               MOVE SCR-INST-HKY   TO SCR-INST.                         
           MOVE TSC-CMNP           TO SCR-CMNP.                         
      *    MOVE TSC-CMND           TO SCR-CMND.                         
           MOVE TSC-CCMN( TSC-I )  TO SCR-CMND.                         
           MOVE TSC-CCPP( TSC-I )  TO SCR-CCPP.                         
           MOVE TSC-STPP( TSC-I )  TO SCR-STPP.                         
           MOVE TSC-PRMT( TSC-I )  TO SCR-PRMT.                         
           MOVE TSC-CONF( TSC-I )  TO SCR-CONF.                         
           IF TSC-USER NOT > SPACES                                     
               MOVE SPACES TO TSC-USER.                                 
           MOVE TSC-USER           TO SCR-USER.                         
           IF SCR-INST = 'GKY'                                          
                MOVE 'C'                TO SCR-ICMN                     
           ELSE                                                         
                MOVE 'P'                TO SCR-ICMN.                    
           MOVE WSS-QIDD                TO SCR-QIDD.                    
           MOVE WSS-QIDD-LEN            TO SCR-LIDD.                    
           MOVE TSC-NEMO           TO SCR-NEMO.                         
           MOVE TSC-LDOC           TO SCR-LDOC.                         
                                                                        
           MOVE TSC-NDOC           TO SCR-NDOC-DISP.                    
           MOVE TSC-BNCO           TO SCR-HDR-BNCO.                     
           MOVE TSC-MRCA           TO SCR-HDR-MRCA.                     
           MOVE TSC-CART           TO SCR-HDR-CART.                     
           MOVE TSC-LENG           TO SCR-HDR-LENG.                     
           MOVE TSC-PAIS           TO SCR-HDR-PAIS.                     
           MOVE TSC-VRNT           TO SCR-HDR-VRNT.                     
                                                                        
           MOVE TSC-FRET           TO SCR-FRET.                         
           MOVE TSC-IPRV           TO SCR-IPRV.                         
           MOVE TSC-FFLD           TO SCR-FFLD.                         
      * ISP: ORIGEN DESDE PTC                                           
           MOVE 'S'                TO SCR-OFRM.                         
      *    MOVE WSS-ORIG TO SCR-ORIG.                                   
      * ISP: ORIGEN DESDE PTC                                           
           MOVE 'N'                TO SCR-IERR.                         
           IF WSS-COD-CIFD > SPACES                                     
               MOVE 'T' TO SCR-MODO.                                    
           MOVE WSS-CNAL TO SCR-CNAL.                                   
       FIN-PRO-MOVE-SCR2.                                               
           EXIT.                                                        
                                                                        
       PRO-MOVE-VSYS SECTION.                                           
       INI-PRO-MOVE-VSYS.                                               
      *SI LAS VARIABLES DEL PROGRAMA VAN EN COMMAREA VERSION 1          
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )           
               PERFORM CLR-SCR-DISP                                     
               MOVE OSC-VARI TO SYS-CMMA                                
      *        MOVE OSC-TCMA TO SYS-TCMA                                
               MOVE +3500    TO SYS-TCMA                                
           ELSE                                                         
      *SI LAS VARIABLES DEL PROGRAMA VAN EN COMMAREA VERSION 2          
           IF TSC-TINV = 'O'                                            
               PERFORM CLR-SCR-DISP                                     
               MOVE SCR-VARI TO SYS-CMMA                                
               MOVE SCR-TCMA TO SYS-TCMA                                
           ELSE                                                         
      *SE ASUME 'T' = SI LAS VARIABLES DEL PROGRAMA VAN EN TS           
              MOVE SPACES   TO SYS-CMMA                                 
              MOVE 0        TO SYS-TCMA.                                
           MOVE TSC-PROG TO SYS-PROG.                                   
           MOVE TSC-NTRN TO SYS-NTRN.                                   
       FIN-PRO-MOVE-VSYS.                                               
           EXIT.                                                        
                                                                        
       CLR-SCR-DISP SECTION.                                            
       INI-CLR-SCR-DISP.                                                
                                                                        
      *     EXEC CICS WRITEQ TS                                         
      *               QUEUE(SCR-VARI)                                   
      *               FROM(SCR-VARI)                                    
      *               LENGTH(+4000)                                     
      *               AUXILIARY                                         
      *     END-EXEC.                                                   
                                                                        
      *     IF SCR-INST = 'GKY'                                         
      *         MOVE SPACES TO SCR-DISP                                 
      *         MOVE SPACES TO SCR-CONT.                                
       FIN-CLR-SCR-DISP.                                                
           EXIT.                                                        
                                                                        
       ERR-MNU SECTION.                                                 
       INI-ERR-MNU.                                                     
           PERFORM GNS-PRO-END.                                         
       FIN-ERR-MNU.                                                     
           EXIT.                                                        
                                                                        
       GET-DEF-HST SECTION.                                             
       INI-GET-DEF-HST.                                                 
           MOVE ZEROES TO WSS-IDX-FLD-HST.                              
           MOVE TDI-COD-SIST-FRM TO TAB-COD-SIST.                       
           MOVE WSS-COD-ORIG-HST TO TAB-COD-TTAB IN TAB.                
           MOVE MNU-GLS-NFRM     TO TAB-COD-CTAB IN TAB.                
           MOVE SPACES TO WSS-GLS-TAB.                                  
                                                                        
      * EJEMPLO DE CARGA FIJA DE PARAMETROS HST                         
      *                                                                 
      *     IF MNU-GLS-NFRM IN MNU = 'COLFOPC'                          
      *         MOVE                                                    
      *     '01030304081314140408490308010103020615040319261904080303190
      *-    '0806260808081809092012030116010116160320'                  
      *         TO WSS-GLS-TAB                                          
      *         PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1 
      *             UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC  
      *             OR WSS-IDX-TAB-HST > 50                             
      *         MOVE                                                    
      *     '1208054004080319040879'                                    
      *         TO WSS-GLS-TAB                                          
      *         PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1 
      *             UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC  
      *             OR WSS-IDX-TAB-HST > 50.                            
                                                                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       CIC-GET-DEF-HST.                                                 
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO EXT-GET-DEF-HST.                                   
           MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-NFRM-HST.                
           IF WSS-GLS-NFRM-HST = MNU-GLS-NFRM                           
               MOVE TAB-GLS-DESC TO WSS-GLS-DESC                        
               MOVE TAB-GLS-DATA TO WSS-GLS-DATA                        
               PERFORM CRG-DEF-HST VARYING WSS-IDX-TAB-HST FROM 1 BY 1  
                   UNTIL WSS-COD-TAB-HST(WSS-IDX-TAB-HST) NOT NUMERIC   
                   OR WSS-IDX-TAB-HST > 50                              
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO CIC-GET-DEF-HST.                                   
       EXT-GET-DEF-HST.                                                 
           MOVE WSS-IDX-FLD-HST TO WSS-TOT-FLD-HST.                     
       FIN-GET-DEF-HST.                                                 
           EXIT.                                                        
                                                                        
       CRG-DEF-HST SECTION.                                             
       INI-CRG-DEF-HST.                                                 
      * ISP: DETECTA UN NUEVO CAMPO CORRELATIVO                         
           ADD 1 TO WSS-IDX-FLD-HST.                                    
                                                                        
      * ISP: CARGA LARGO DE CAMPO CORRELATIVO                           
           MOVE WSS-COD-TAB-HST(WSS-IDX-TAB-HST) TO                     
                WSS-NUM-LEN-HST(WSS-IDX-FLD-HST).                       
                                                                        
      * ISP: CARGA POSICION DE INICIO DE CAMPO CORRELATIVO              
           IF WSS-COD-ORIG = WSS-COD-ORIG-HST                           
               ADD 3 TO TSI-IDX-FRM-HST.                                
           MOVE TSI-IDX-FRM-HST TO WSS-NUM-POS-HST(WSS-IDX-FLD-HST).    
                                                                        
      * ISP: SUMA LARGO Y ATRIBUTO ( 3 )                                
           IF WSS-COD-ORIG = WSS-COD-ORIG-SRV                           
               ADD 3 TO TSI-IDX-FRM-HST.                                
                                                                        
           ADD  WSS-COD-TAB-HST(WSS-IDX-TAB-HST) TO TSI-IDX-FRM-HST.    
       FIN-CRG-DEF-HST.                                                 
           EXIT.                                                        
                                                                        
       PUT-INF-TO-HST SECTION.                                          
       INI-PUT-INF-TO-HST.                                              
      *     ADD 12 TO WSS-NUM-POS-HST(WSS-IDX-FLD-HST)                  
      *            GIVING WSS-BTSI.                                     
                                                                        
           MOVE WSS-NUM-POS-HST(WSS-IDX-FLD-HST) TO WSS-BTSI.           
           MOVE WSS-NUM-LEN-HST(WSS-IDX-FLD-HST) TO WSS-LTDI.           
      *                                                                 
      * SIEMPRE REINICIALIZA LA NUMERACION DE LOS CAMPOS                
      * DEL MAPA-WI PARA NO CONFUNDIR LOS ERRORES CON                   
      * POSICIONAMIENTOS CORRECTOS DEL CURSOR ENTRE DOS                 
      * TRANSACCIONES QUE USAN EL MISMO MAPA                            
      *                                                                 
      *    IF NOT PGM-STAT-TSI-OKS                                      
               ADD 1 TO WSS-NUM-99                                      
               MOVE WSS-NUM-XX1 TO TSI-COD-FRM-HST(WSS-BTSI)            
               ADD  1           TO                 WSS-BTSI             
               MOVE WSS-NUM-XX2 TO TSI-COD-FRM-HST(WSS-BTSI)            
               ADD  1           TO                 WSS-BTSI             
               MOVE '&' TO TSI-COD-FRM-HST(WSS-BTSI)                    
               ADD  1           TO                 WSS-BTSI             
      *    ELSE                                                         
      *        ADD 3 TO WSS-BTSI.                                       
                                                                        
                                                                        
                                                                        
      * DETERMINA SI EL CAMPO CORRELATIVO DE LA TABLA 'HST' QUE ESTA    
      * PROCESANDO, EXISTE EN ALGUNA OCURRENCIA DE LA TABLA 'SRV'.      
      * NO ASUME QUE LA TABLA 'SRV' VIENE ORDENADA ASCENDENTEMENTE      
           MOVE ZEROES TO WSS-IDX-FLD-SRV.                              
           MOVE WSS-BTDI TO WSS-IDX-FRM-SRV                             
           MOVE 'N' TO WSS-IND-ESRV.                                    
           PERFORM BUS-FLD-SRV VARYING WSS-IDX-SRV-ASC                  
                     FROM 1 BY 1 UNTIL WSS-IDX-SRV-ASC >                
                                       WSS-TOT-FLD-SRV OR               
                                       WSS-IND-ESRV = 'S'.              
                                                                        
           IF WSS-IND-ESRV = 'S'                                        
      *         ADD 1 TO WSS-IDX-FLD-SRV                                
      *ISP SI EL USUARIO INFORMA DATOS, PRIMERO SE LIMPIA EL AREA RECEPT
      *    Y LUEGO SE PONE LO QUE EL USUARIO INFORMO; UTIL POR EJEMPLO P
      *    REDIGITACION DE CAMPOS NUMERICO                              
      *                                                                 
               MOVE ZEROES TO WSS-CTDI                                  
      *        ASUME QUE EL USUARIO NO DIGITO NADA                      
               MOVE 'N' TO WSS-SWI-FLD-USR                              
               MOVE WSS-IDX-FRM-SRV TO WSS-IDX-FLD-USR                  
               PERFORM REV-FLD-USR VARYING WSS-ITDI FROM WSS-BTSI BY 1  
                    UNTIL WSS-CTDI NOT < WSS-LTDI                       
                                                                        
               IF WSS-SWI-FLD-USR = 'S'                                 
                   MOVE ZEROES TO WSS-CTDI                              
                   PERFORM CLR-FLD-USR VARYING WSS-ITDI FROM WSS-BTSI   
                     BY 1                                               
                    UNTIL WSS-CTDI = WSS-LTDI                           
                                                                        
                    MOVE ZEROES TO WSS-CTDI                             
                    PERFORM PUT-ALL-HST VARYING WSS-ITDI FROM WSS-BTSI  
                     BY 1                                               
                    UNTIL WSS-CTDI = WSS-LTDI                           
               ELSE                                                     
                    MOVE ZEROES TO WSS-CTDI                             
                    PERFORM PUT-ALL-HST VARYING WSS-ITDI FROM WSS-BTSI  
                     BY 1                                               
                    UNTIL WSS-CTDI = WSS-LTDI.                          
       FIN-PUT-INF-TO-HST.                                              
           EXIT.                                                        
                                                                        
       BUS-FLD-SRV SECTION.                                             
       INI-BUS-FLD-SRV.                                                 
           IF WSS-IDX-FLD-HST = WSS-COD-FLD-SRV(WSS-IDX-SRV-ASC)        
               MOVE 'S' TO WSS-IND-ESRV                                 
               GO TO FIN-BUS-FLD-SRV.                                   
                                                                        
           MOVE WSS-COD-FLD-SRV(WSS-IDX-SRV-ASC) TO WSS-IDX-AUX.        
           ADD WSS-NUM-LEN-HST(WSS-IDX-AUX) TO                          
               WSS-IDX-FRM-SRV.                                         
       FIN-BUS-FLD-SRV.                                                 
           EXIT.                                                        
                                                                        
       REV-FLD-USR SECTION.                                             
       INI-REV-FLD-USR.                                                 
           IF TDI-COD-TDI(WSS-IDX-FLD-USR) > SPACES                     
               MOVE 'S' TO WSS-SWI-FLD-USR                              
               MOVE WSS-LTDI TO WSS-CTDI                                
           ELSE                                                         
               ADD 1 TO WSS-IDX-FLD-USR                                 
               ADD 1 TO WSS-CTDI.                                       
       FIN-REV-FLD-USR.                                                 
           EXIT.                                                        
                                                                        
       CLR-FLD-USR SECTION.                                             
       INI-CLR-FLD-USR.                                                 
           MOVE SPACES TO TSI-COD-FRM-HST(WSS-ITDI).                    
           ADD 1 TO WSS-CTDI.                                           
       FIN-CLR-FLD-USR.                                                 
           EXIT.                                                        
                                                                        
       PUT-ALL-HST SECTION.                                             
       INI-PUT-ALL-HST.                                                 
      * ISP  11-NOV-1992                                                
      * DEBE RESPETAR DATOS QUE PUSO LA PLANTILLA Y ESTAN DEFINIDOS EN  
      * LOS FORMATOS DE TRANSMISION, PERO EL USUARIO LOS DEJA EN BLANCO 
      * ISP 15-03-1996 SIEMPRE MUEVE TODOS LOS DATOS,                   
      * INCLUSIVE AQUELLOS CON BLANCOS                                  
      * PUT-SOLO-LLENOS                                                 
           IF WSS-PREG-POR-SPAC = 'N'                                   
               MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO                     
                    TSI-COD-FRM-HST(WSS-ITDI)                           
           ELSE                                                         
               IF TDI-COD-TDI(WSS-IDX-FRM-SRV) > SPACES                 
                   MOVE TDI-COD-TDI(WSS-IDX-FRM-SRV) TO                 
                      TSI-COD-FRM-HST(WSS-ITDI).                        
                                                                        
           ADD 1 TO WSS-IDX-FRM-SRV.                                    
           ADD 1 TO WSS-CTDI.                                           
       FIN-PUT-ALL-HST.                                                 
           EXIT.                                                        
                                                                        
       PUT-INF-TO-SRV SECTION.                                          
       INI-PUT-INF-TO-SRV.                                              
           MOVE WSS-COD-FLD-SRV(WSS-IDX-FLD-SRV) TO WSS-IDX-FLD-HST.    
                                                                        
           MOVE WSS-NUM-LEN-HST(WSS-IDX-FLD-HST) TO WSS-LTDI.           
           MOVE ZEROES                           TO WSS-CTDI.           
           MOVE WSS-NUM-POS-HST(WSS-IDX-FLD-HST) TO WSS-PINI.           
                                                                        
           PERFORM PRO-BYA.                                             
                                                                        
           PERFORM LIM-ISRV.                                            
                                                                        
      *     MOVE 1 TO WSS-IDX-CAMPO.                                    
      *     MOVE ALL '.' TO WSS-TAB-CAMPO.                              
                                                                        
                                                                        
           PERFORM PUT-ALL-SRV VARYING WSS-ITDI FROM WSS-PINI BY 1      
                    UNTIL WSS-CTDI = WSS-LTDI.                          
       FIN-PUT-INF-TO-SRV.                                              
           EXIT.                                                        
                                                                        
       PRO-BYA SECTION.                                                 
       INI-PRO-BYA.                                                     
           IF WSS-IND-IBYA = 'S'                                        
               ADD 12 WSS-PINI GIVING WSS-AUXI                          
               SUBTRACT 1 FROM WSS-AUXI                                 
               ADD 1 TO WSS-ISRV                                        
      * XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX                                
      *        MOVE 'BYA' TO QUE-COLA.                                  
      *        MOVE TSO-COD-FRM-HST(WSS-AUXI) TO QUE-ITEM.              
      *        MOVE QUE-PUT TO QUE-CMND.                                
      *        MOVE +1 TO QUE-LITM.                                     
      *        PERFORM GNS-PRO-QUE.                                     
      *        MOVE WSS-AUXI TO WSS-AUXI-NUM3.                          
      *        MOVE 'POS' TO QUE-COLA.                                  
      *        MOVE WSS-AUXI-NUM3 TO QUE-ITEM.                          
      *        MOVE QUE-PUT TO QUE-CMND.                                
      *        MOVE +3 TO QUE-LITM.                                     
      *        PERFORM GNS-PRO-QUE.                                     
      * XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX                                
               IF TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPIM-AEY OR           
                  TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPIM-ANY OR           
                  TSO-COD-FRM-HST(WSS-AUXI) = FRM-CPSF-AEY OR           
                  TSO-COD-FRM-HST(WSS-AUXI) = '&'                       
                   MOVE 'P' TO TDO-COD-TDO(WSS-ISRV)                    
               ELSE                                                     
                   MOVE 'D' TO TDO-COD-TDO(WSS-ISRV).                   
       FIN-PRO-BYA.                                                     
           EXIT.                                                        
                                                                        
       PUT-ALL-SRV SECTION.                                             
       INI-PUT-ALL-SRV.                                                 
                                                                        
                                                                        
           ADD 1 TO WSS-ISRV.                                           
      *     ADD 16 WSS-ITDI GIVING WSS-AUXI.                            
           ADD 12 WSS-ITDI GIVING WSS-AUXI.                             
           MOVE TSO-COD-FRM-HST(WSS-AUXI) TO                            
                TDO-COD-TDO(WSS-ISRV).                                  
           ADD 1 TO WSS-CTDI.                                           
                                                                        
                                                                        
                                                                        
      *     MOVE TDO-COD-TDO(WSS-ISRV) TO                               
      *          WSS-TAB-CAMPO-ELM(WSS-IDX-CAMPO).                      
      *     ADD 1 TO WSS-IDX-CAMPO.                                     
                                                                        
                                                                        
      *DBG MOVE +1   TO QUE-LITM.                                       
      *DBG MOVE 'XXXISP' TO QUE-COLA.                                   
      *DBG MOVE TSO-COD-FRM-HST(WSS-AUXI)   TO QUE-ITEM.                
      *DBG MOVE QUE-PUT TO QUE-CMND.                                    
      *DBG PERFORM GNS-PRO-QUE.                                         
       FIN-PUT-ALL-SRV.                                                 
           EXIT.                                                        
                                                                        
       LIM-ISRV SECTION.                                                
       INI-LIM-ISRV.                                                    
      *     ADD 1 TO WSS-ISRV.                                          
      *     MOVE '%' TO TDO-COD-TDO(WSS-ISRV).                          
       FIN-LIM-ISRV.                                                    
           EXIT.                                                        
                                                                        
       GET-DEF-SRV SECTION.                                             
       INI-GET-DEF-SRV.                                                 
           MOVE ZEROES TO WSS-GLS-FLD-SRV.                              
           IF WSS-COD-ORIG = WSS-COD-ORIG-HST                           
                MOVE ZEROES TO WSS-IDX-FLD-SRV.                         
           MOVE 'S' TO WSS-FST-SRV.                                     
                                                                        
           IF WSS-COD-ORIG = WSS-COD-ORIG-SRV                           
                MOVE TDI-COD-FINP-FRM TO WSS-COD-2TAB                   
           ELSE                                                         
                MOVE TDI-COD-FOUT-FRM TO WSS-COD-2TAB.                  
      * EJEMPLO DE CARGA FIJA DE PARAMETROS SRV                         
      *     IF MNU-GLS-NFRM IN MNU = 'COLFOPC'                          
      *        IF WSS-COD-2TAB = '009'                                  
      *         MOVE                                                    
      *     '00200300400500901001201301401501601701802102202702803503603
      *-    '042051053055056057059060'                                  
      *         TO WSS-GLS-TAB                                          
      *         PERFORM CRG-DEF-SRV VARYING WSS-IDX-TAB-SRV FROM 1 BY 1 
      *            UNTIL WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) NOT NUMERIC   
      *            OR WSS-IDX-TAB-SRV > 33.                             
                                                                        
                                                                        
                                                                        
           MOVE TDI-COD-SIST-FRM TO TAB-COD-SIST.                       
           MOVE WSS-COD-ORIG-SRV TO TAB-COD-TTAB IN TAB.                
           MOVE MNU-GLS-NFRM     TO WSS-COD-1TAB.                       
           MOVE WSS-COD-CTAB     TO TAB-COD-CTAB IN TAB.                
                                                                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       CIC-GET-DEF-SRV.                                                 
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-GET-DEF-SRV.                                   
           MOVE TAB-COD-CTAB IN TAB TO WSS-GLS-NFRM-SRV.                
           IF WSS-FST-SRV = 'S'                                         
               MOVE 'N' TO WSS-FST-SRV                                  
               MOVE TAB-GLS-ABRV TO WSS-LMSG-SRV.                       
                                                                        
           IF WSS-GLS-NFRM-SRV = WSS-COD-CTAB                           
               MOVE TAB-GLS-DESC TO WSS-GLS-DESC                        
               MOVE TAB-GLS-DATA TO WSS-GLS-DATA                        
      *DBG MOVE +100 TO QUE-LITM                                        
      *DBG MOVE 'TABISP' TO QUE-COLA                                    
      *DBG MOVE WSS-GLS-TAB TO QUE-ITEM                                 
      *DBG MOVE QUE-PUT TO QUE-CMND                                     
      *DBG PERFORM GNS-PRO-QUE                                          
               PERFORM CRG-DEF-SRV VARYING WSS-IDX-TAB-SRV FROM 1 BY 1  
                  UNTIL WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) NOT NUMERIC    
                  OR WSS-IDX-TAB-SRV > 33                               
               MOVE FIO-GET-NXT TO FIO-CMND                             
               GO TO CIC-GET-DEF-SRV.                                   
                                                                        
           MOVE WSS-IDX-FLD-SRV TO WSS-TOT-FLD-SRV.                     
       FIN-GET-DEF-SRV.                                                 
           EXIT.                                                        
                                                                        
       CRG-DEF-SRV SECTION.                                             
       INI-CRG-DEF-SRV.                                                 
      * ISP: DETECTA UN NUEVO CAMPO CORRELATIVO                         
           ADD 1 TO WSS-IDX-FLD-SRV.                                    
                                                                        
      * ISP: CARGA LARGO DE CAMPO CORRELATIVO                           
           MOVE WSS-COD-TAB-SRV(WSS-IDX-TAB-SRV) TO                     
                WSS-COD-FLD-SRV(WSS-IDX-FLD-SRV).                       
                                                                        
       FIN-CRG-DEF-SRV.                                                 
           EXIT.                                                        
                                                                        
       MOV-HDR-SRV SECTION.                                             
       INI-MOV-HDR-SRV.                                                 
      * ISP: RESCATA CARACTER A CARACTER EL HEADER DE CADA UNO DE LOS   
      *      MENSAJES DE LA CADENA DEL SERVER                           
           ADD 1 TO WSS-CTDI.                                           
           MOVE TDI-COD-TDI(WSS-ITDI) TO TDI-COD-TDI-FRM(WSS-CTDI).     
       FIN-MOV-HDR-SRV.                                                 
           EXIT.                                                        
                                                                        
       PRO-CALL-LINK SECTION.                                           
       INI-PRO-CALL-LINK.                                               
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )           
               MOVE OSC-INST TO WSS-INST-OLD                            
           ELSE                                                         
               MOVE SCR-INST TO WSS-INST-OLD.                           
                                                                        
           MOVE SYS-LINK TO SYS-CMND.                                   
           MOVE TSC-PROG TO SYS-PROG.                                   
           PERFORM GNS-PRO-SYS.                                         
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )           
               MOVE SYS-CMMA TO OSC-VARI                                
               MOVE OSC-INST TO WSS-INST-NEW                            
           ELSE                                                         
               MOVE SYS-CMMA TO SCR-VARI                                
               MOVE SCR-INST TO WSS-INST-NEW.                           
                                                                        
      *     IF WSS-INST-OLD = WSS-INST-NEW                              
      *          PERFORM DEL-TSI                                        
      *          MOVE 'S' TO WSS-IND-ERR                                
      *          PERFORM BCK-OUT.                                       
                                                                        
           IF ( TSC-TINV = 'C' ) OR ( TSC-TINF NOT > SPACES )           
               IF OSC-IERR-YES                                          
                   PERFORM DEL-TSI                                      
                   MOVE 'S' TO WSS-IND-ERR                              
                   MOVE 'S' TO PTC-WSS-BCKI-VAL                         
               ELSE                                                     
                   NEXT SENTENCE                                        
           ELSE                                                         
               IF SCR-IERR-YES                                          
                   PERFORM DEL-TSI                                      
                   MOVE 'S' TO WSS-IND-ERR                              
                   MOVE 'S' TO PTC-WSS-BCKI-VAL.                        
                                                                        
           IF PTC-WSS-BCKI-VAL = 'S'                                    
                   PERFORM BCK-OUT.                                     
       FIN-PRO-CALL-LINK.                                               
           EXIT.                                                        
                                                                        
                                                                        
       BCK-OUT SECTION.                                                 
       INI-BCK-OUT.                                                     
           MOVE 'GNS' TO TAB-COD-SIST.                                  
           MOVE FIO-BCK-OUT TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
      *        Para informar que el backout se realizo con exito        
               MOVE '49' TO FIO-STAT.                                   
       FIN-BCK-OUT.                                                     
           EXIT.                                                        
                                                                        
       BUS-FSIS SECTION.                                                
       INI-BUS-FSIS.                                                    
      * ISP: ABORTO CUANDO NO ENCUENTRA IDD                             
       FIN-BUS-FSIS.                                                    
           EXIT.                                                        
                                                                        
       LINK-ERR SECTION.                                                
       INI-LINK-ERR.                                                    
      * ISP: ABORTO CUANDO FALLA LINK                                   
       FIN-LINK-ERR.                                                    
           EXIT.                                                        
                                                                        
       FIN SECTION.                                                     
       INI-FIN.                                                         
           MOVE WSS-QIDD TO QUE-COLA.                                   
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
                                                                        
           IF PTC-WSS-BCKI-QUE = 'S'                                    
                   PERFORM BCK-OUT.                                     
                                                                        
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
                                                                        
           MOVE TSK-TERM-ALF        TO QUE-TERM.                        
           MOVE 'CTM '              TO QUE-TYPE.                        
           MOVE +18                 TO QUE-LITM.                        
           MOVE 1                   TO QUE-NITM.                        
           MOVE QUE-GET             TO QUE-CMND.                        
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
                 MOVE 0 TO SYS-TCMA                                     
                 MOVE SPACES TO SYS-CMMA                                
                 MOVE SYS-XCTL TO SYS-CMND                              
                 MOVE 'LDCPPTRO' TO SYS-PROG                            
                 PERFORM GNS-PRO-SYS                                    
           ELSE                                                         
                 EXEC CICS                                              
                   RETURN                                               
                 END-EXEC.                                              
                                                                        
           EXEC CICS                                                    
              FREE                                                      
           END-EXEC.                                                    
       FIN-FIN.                                                         
           EXIT.                                                        
      *COPY LDCBGQUE.                                                   
                                                                        
      *Modulo Generico Manejo de Colas                                  
       GNS-CHK-QUEU SECTION.                                            
       INI-GNS-CHK-QUEU.                                                
           MOVE 1 TO QUE-NITM.                                          
           MOVE QUE-GET TO QUE-CMND.                                    
           PERFORM GNS-PRO-QUE.                                         
       FIN-GNS-CHK-QUEU.                                                
           EXIT.                                                        
                                                                        
       GNS-QUE-EOQ SECTION.                                             
       INI-GNS-QUE-EOQ.                                                 
           MOVE QUE-STAT-EOQ TO QUE-STAT.                               
           GO TO FIN-GNS-PRO-QUE.                                       
       FIN-GNS-QUE-EOQ.                                                 
           EXIT.                                                        
                                                                        
       GNS-QUE-NEX SECTION.                                             
       INI-GNS-QUE-NEX.                                                 
           MOVE QUE-STAT-NEX TO QUE-STAT.                               
           GO TO FIN-GNS-PRO-QUE.                                       
       FIN-GNS-QUE-NEX.                                                 
           EXIT.                                                        
                                                                        
      **************************************************************    
       GNS-ERR-QUE SECTION.                                             
       INI-GNS-ERR-QUE.                                                 
           EXEC CICS HANDLE CONDITION                                   
                     QIDERR (GNS-QUE-NEX)                               
                     ITEMERR(GNS-QUE-EOQ)                               
                     LENGERR(GNS-QUE-NEX)                               
           END-EXEC.                                                    
       FIN-GNS-ERR-QUE.                                                 
           EXIT.                                                        
                                                                        
       GNS-PRO-QUE SECTION.                                             
       INI-GNS-PRO-QUE.                                                 
           MOVE QUE-STAT-OKS TO QUE-STAT.                               
           IF QUE-CMND = QUE-PUT                                        
               GO TO GNS-PUT-QUE                                        
           ELSE                                                         
           IF QUE-CMND = QUE-GET                                        
               GO TO GNS-GET-QUE                                        
           ELSE                                                         
           IF QUE-CMND = QUE-MOD                                        
               GO TO GNS-MOD-QUE                                        
           ELSE                                                         
           IF QUE-CMND = QUE-DEL                                        
               GO TO GNS-DEL-QUE.                                       
           MOVE 'Comando invalido :' TO QUE-MEN1.                       
           MOVE QUE-CMND             TO QUE-MEN2.                       
           EXEC CICS XCTL                                               
                     PROGRAM('GNSPPABT')                                
                     COMMAREA(QUE-MENS)                                 
                     LENGTH(+79)                                        
           END-EXEC.                                                    
                                                                        
       GNS-PUT-QUE.                                                     
           IF WSS-IND-QUE = '   '                                       
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(QUE-ITEM)                                     
                     LENGTH(QUE-LITM)                                   
                     AUXILIARY                                          
              END-EXEC                                                  
           ELSE                                                         
           IF WSS-IND-QUE = 'TDI'                                       
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDI-GLS-DESC-1)                               
                     LENGTH(QUE-LITM)                                   
                     AUXILIARY                                          
               END-EXEC                                                 
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDI-GLS-DESC-2)                               
                     LENGTH(QUE-LITM)                                   
                     AUXILIARY                                          
               END-EXEC                                                 
           ELSE                                                         
           IF WSS-IND-QUE = 'TDO'                                       
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDO-GLS-DESC-1)                               
                     LENGTH(QUE-LITM)                                   
                     AUXILIARY                                          
               END-EXEC                                                 
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDO-GLS-DESC-2)                               
                     LENGTH(QUE-LITM)                                   
                     AUXILIARY                                          
              END-EXEC.                                                 
       FIN-GNS-PUT-QUE.                                                 
           GO TO FIN-GNS-PRO-QUE.                                       
                                                                        
       GNS-GET-QUE.                                                     
           IF WSS-IND-QUE = '   '                                       
               EXEC CICS READQ TS                                       
                     QUEUE(QUE-COLA)                                    
                     INTO(QUE-ITEM)                                     
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
              END-EXEC                                                  
           ELSE                                                         
           IF WSS-IND-QUE = 'TDI'                                       
               EXEC CICS READQ TS                                       
                     QUEUE(QUE-COLA)                                    
                     INTO(TDI-GLS-DESC-1)                               
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
               END-EXEC                                                 
               ADD 1  TO  QUE-NITM                                      
               EXEC CICS READQ TS                                       
                     QUEUE(QUE-COLA)                                    
                     INTO(TDI-GLS-DESC-2)                               
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
              END-EXEC                                                  
           ELSE                                                         
           IF WSS-IND-QUE = 'TDO'                                       
               EXEC CICS READQ TS                                       
                     QUEUE(QUE-COLA)                                    
                     INTO(TDO-GLS-DESC-1)                               
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
               END-EXEC                                                 
               ADD 1   TO  QUE-NITM                                     
               EXEC CICS READQ TS                                       
                     QUEUE(QUE-COLA)                                    
                     INTO(TDO-GLS-DESC-2)                               
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
              END-EXEC.                                                 
       FIN-GNS-GET-QUE.                                                 
           GO TO FIN-GNS-PRO-QUE.                                       
                                                                        
       GNS-MOD-QUE.                                                     
           IF WSS-IND-QUE = SPACES                                      
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(QUE-ITEM)                                     
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
                     REWRITE                                            
               END-EXEC                                                 
           ELSE                                                         
           IF WSS-IND-QUE = 'TDI'                                       
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDI-GLS-DESC)                                 
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
                     REWRITE                                            
               END-EXEC                                                 
           ELSE                                                         
           IF WSS-IND-QUE = 'TDO'                                       
               EXEC CICS WRITEQ TS                                      
                     QUEUE(QUE-COLA)                                    
                     FROM(TDO-GLS-DESC)                                 
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
                     REWRITE                                            
               END-EXEC.                                                
       FIN-GNS-MOD-QUE.                                                 
           GO TO FIN-GNS-PRO-QUE.                                       
                                                                        
       GNS-DEL-QUE.                                                     
           EXEC CICS DELETEQ TS                                         
                     QUEUE(QUE-COLA)                                    
           END-EXEC.                                                    
       FIN-GNS-DEL-QUE.                                                 
           GO TO FIN-GNS-PRO-QUE.                                       
                                                                        
       FIN-GNS-PRO-QUE.                                                 
           EXIT.                                                        
                                                                        
       COPY GNSBGTSK.                                                   
       COPY GNSBGDTC.                                                   
       COPY GNSBGRCI.                                                   
       COPY GNSBFRCI.                                                   
                                                                        
       PRO-CCI SECTION.                                                 
       INI-PRO-CCI.                                                     
      *AMB*     DISPLAY 'INI PRO-CCI'.                                  
      *     MOVE  WSS-TSC-BNCO TO  TSC-BNCO.                            
      *     MOVE  WSS-TSC-MRCA TO  TSC-MRCA.                            
      *     MOVE  WSS-TSC-CART TO  TSC-CART.                            
      *     MOVE  WSS-TSC-LENG TO  TSC-LENG.                            
      *     MOVE  WSS-TSC-PAIS TO  TSC-PAIS.                            
      *     MOVE  WSS-TSC-VRNT TO  TSC-VRNT.                            
                                                                        
      *  SETEA IDD PARA PROGRAMAS DE APLICACION                         
                                                                        
           MOVE TSC-BNCO     TO RCI-COD-BNCO IN RCI-VARI.               
           MOVE TSC-MRCA     TO RCI-COD-MRCA IN RCI-VARI.               
           MOVE TSC-CART     TO RCI-COD-CART IN RCI-VARI.               
           MOVE TSC-LENG     TO RCI-COD-LENG IN RCI-VARI.               
           MOVE TSC-PAIS     TO RCI-COD-PAIS IN RCI-VARI.               
           MOVE TSC-VRNT     TO RCI-COD-VRNT IN RCI-VARI.               
           MOVE TSC-CNAL     TO RCI-COD-CNAL IN RCI-VARI.               
           MOVE TSC-UMUA     TO RCI-COD-UMUA IN RCI-VARI.               
           MOVE TSC-MODO     TO RCI-COD-MODO IN RCI-VARI.               
           MOVE 'DEFAULT'    TO RCI-COD-CPTO IN RCI-VARI.               
           PERFORM BUS-RCI-IDD.                                         
      *    DISPLAY 'MTD-IDD-APL ' IDD-VARI.                             
           PERFORM GNS-PUT-IDD.                                         
           MOVE QUE-LITM TO WSS-QIDD-LEN.                               
      *AMB*     DISPLAY 'INI MED-CCI'.                                  
      *AMB*  SETEA IDD PARA GNSPPMTD                                    
                                                                        
           MOVE TSC-BNCO     TO RCI-COD-BNCO IN RCI-VARI.               
           MOVE TSC-MRCA     TO RCI-COD-MRCA IN RCI-VARI.               
           MOVE TSC-CART     TO RCI-COD-CART IN RCI-VARI.               
           MOVE TSC-LENG     TO RCI-COD-LENG IN RCI-VARI.               
           MOVE TSC-PAIS     TO RCI-COD-PAIS IN RCI-VARI.               
           MOVE TSC-VRNT     TO RCI-COD-VRNT IN RCI-VARI.               
           MOVE 'GNSPP081'   TO RCI-COD-CPTO IN RCI-VARI.               
                                                                        
      *    DISPLAY 'MTD-IDD-MTI ' RCI.                                  
                                                                        
            PERFORM BUS-RCI-IDD.                                        
      *    DISPLAY 'MTD-IDD-MTD ' IDD-VARI.                             
                                                                        
      *     DISPLAY 'GNSPPMTI EN FIN-PRO-CCI'.                          
       FIN-PRO-CCI.                                                     
           EXIT.                                                        
      *COPY GNSBCIDD.                                                   
       COPY GNSBBIDD.                                                   
