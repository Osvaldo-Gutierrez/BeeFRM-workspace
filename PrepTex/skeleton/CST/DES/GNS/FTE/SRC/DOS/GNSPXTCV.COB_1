       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      GNSPXTCV.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      *
      * Programa para cambiar estatus de comunicacion entre Aplicaciones
      * Visual Basic y CICS-Realia, con el fin de terminarla. 
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============

       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
      *
       COPY GNSBRCCS.
      *
      *
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

       01  WSS-VARI.
           03 WSS-WAIT VALUE 'WAIT' PIC X(04).
           03 WSS-TOPE VALUE 1000    PIC 9(05).
           03 WSS-CONTADOR          PIC 9(05). 

       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           PERFORM PRO-CCS.
       FIN-MAIN.
      *--------*
           STOP RUN.

       PRO-CCS SECTION.
      *---------------*
       LUP-PRO-CCS.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-CCS.
           DISPLAY 'APERTURA GNSMCCS: ST: ' FIO-STAT.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO PUEDO ABRIR GNSMCCS: ST: ' FIO-STAT
              GO TO FIN-PRO-CCS.

           DISPLAY 'LEERA DE UPD GNSMCCS'.
           MOVE 'TERM'           TO CCS-COD-TERM IN CCS.
           MOVE 1                TO CCS-NUM-CORR IN CCS.
           MOVE FIO-GET-KEY-UPD  TO FIO-CMND.
           PERFORM GNS-FIO-CCS.
           IF NOT FIO-STAT-OKS
      *        DISPLAY 'FIO-PUT: ' FIO-PUT
              MOVE FIO-PUT         TO FIO-CMND
           ELSE
      *        DISPLAY 'FIO-MOD: ' FIO-MOD
              MOVE FIO-MOD TO FIO-CMND.

           DISPLAY 'LECTURA UPD GNSMCCS: ST: ' FIO-STAT.
           MOVE 'X'                 TO CCS-IND-COMU IN CCS.
           MOVE SPACES              TO CCS-GLS-MENS IN CCS.
      *     DISPLAY 'FIO-CMND: ' FIO-CMND.
           PERFORM GNS-FIO-CCS.
           DISPLAY 'STATUS ACTUALIZACION REG.CCS ' FIO-STAT.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR REG.CCS'.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-CCS.

       FIN-PRO-CCS.
      *-----------*
           EXIT.

       PRO-WAIT SECTION.
       INI-PRO-WAIT.
           MOVE ZEROES TO WSS-CONTADOR IN WSS-VARI.
       CON-PRO-WAIT.
           ADD 1 TO WSS-CONTADOR IN WSS-VARI
           IF WSS-CONTADOR < WSS-TOPE IN WSS-VARI
              GO TO CON-PRO-WAIT.
       FIN-PRO-WAIT.
           EXIT.
      *
       COPY GNSBFCCS.
      *
       COPY GNSBBSYS.
