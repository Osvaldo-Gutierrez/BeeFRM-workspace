       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. PACU010.
       AUTHOR. CONSIST.
       DATE-WRITTEN. 13-APR-1992
      *
      * PROCESA MENSAJE ALTAMIRA E INVOCA A COLPPMTD
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       77  WSS-TOT-CLI     VALUE ZEROES    PIC 9(02).
       01  XXX-AUX1   VALUE '(%%%)'      PIC X(05).
       01  XXX-AID    VALUE SPACES       PIC X(01).
       01  XXX-AUX2   VALUE '($$$)'      PIC X(05).

       01  WWW-AUX.
           03  WWW-AUX1   VALUE '(+++)'      PIC X(05).
           03  WWW-MENSAJE                   PIC X(60).
       01  WWW-DFLD   VALUE SPACES       PIC X(1000).
       01  WWW-AUX2   VALUE '(***)'      PIC X(05).

       01  WWW-AUX3   VALUE '(???)'      PIC X(05).
       01  WWW-AUX4   VALUE SPACES       PIC X(04).
       01  WWW-AUX5   VALUE '(&&&)'      PIC X(05).
       77  WSS-CLI-SIMU   VALUE 'N'      PIC X(01).
       77  WSS-AVL-SIMU   VALUE 'N'      PIC X(01).
       77  WSS-CAJ-SIMU   VALUE 'N'      PIC X(01).
       77  WSS-EJC-SIMU   VALUE 'N'      PIC X(01).

           COPY COLBRAUX.
           COPY COLBRPOC.
123456*    COPY COLBRPTI.
           COPY GNSBRMSG.
           COPY GNSBRTAB.
      *    COPY TABBRCAM.
           COPY TABBROFI.
      *    COPY TABBRUSR.

       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
       COPY GNSBRTDI.
       COPY GNSWGTDI.
       COPY GNSBRTDO.
       COPY GNSWGTDO.
       COPY GNSBRABP.
       COPY GNSWGABP.

       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.

       COPY GNSWGQUE.
      *
      *COPY GNSWGPCF.
       COPY COLWGFP1.
       COPY COLWGFP2.
      *LGM-BNL-22.12.1994-INI
      *COPY CACW2011.
      *LGM-BNL-22.12.1994-FIN

      * FUNCION DE COMPACTACION
       COPY GNSWGCPT.

       01  WSS-CTA.
           03 WSS-CODISER                               PIC 9(02).
           03 WSS-OFIAPE                                PIC 9(03).
           03 WSS-NUMCTA                                PIC 9(06).
           03 WSS-DIGICTA                               PIC 9(01).
       01 WSS-CIC-ICYA.
           03 WSS-CAI-ICYA                              PIC X(04).
           03 WSS-IIC-ICYA                              PIC X(08).
       01  WSS-GLS-DESC.
           03  FILLER                                   PIC X(12).
           03  MENSA-DESC                               PIC X(20).
       01  PGM-STAT.
              05 PGM-STAT-TSI           VALUE '23'      PIC X(02).
                 88 PGM-STAT-TSI-OKS    VALUE '00'.
                 88 PGM-STAT-TSI-NUL    VALUE '  '.
       COPY CGTI0020.

      *****************************************************************
      *      CGTI0010 - EN ESTA TABLA SE DEFINEN LOS VALORES ASO-     *
      *                 CIADOS A LAS TECLAS DE FUNCION, CON LOS QUE   *
      *                 SE COMPARARA EL CAMPO DEL REGISTRO DE CON-    *
      *                 TROL DE SESION 'CGTL0010-MES-AID'             *
      *****************************************************************
           COPY CGTI0010.

       01  CONSTANTES-ALFA.
           05  CON-ESTADO-INICIO              PIC X(1) VALUE 'I'.
           05  CON-ESTADO-CONTINUACION        PIC X(1) VALUE 'C'.
           05  CON-ESTADO-CONFIRMACION        PIC X(1) VALUE 'X'.
           05  CON-APLICACION                 PIC X(4) VALUE 'ACT '.
           05  CON-ENTRADA-BNL-PRTO           PIC X(8) VALUE 'BNL-PRTO'.
           05  CON-ENTRADA-BNL-CASA           PIC X(8) VALUE 'BNL-CASA'.
           05  CON-ENTRADA-BNL-PREN           PIC X(8) VALUE 'BNL-PREN'.
           05  CON-ENTRADA-BNL-SALI           PIC X(8) VALUE 'BNL-SALI'.
           05  CON-ENTRADA-BNL-APRB           PIC X(8) VALUE 'BNL-APRB'.
           05  CON-ENTRADA-CONS-CLI           PIC X(8) VALUE 'CONS-CLI'.
           05  CON-PANTALLA-MANT-CONT         PIC X(7) VALUE 'CCUW010'.
           05  CON-ACCION-TERMINAL            PIC X(3) VALUE 'TER'.
           05  CON-ACCION-PROGRAMA            PIC X(3) VALUE 'PRG'.
           05  CON-ACCION-ALTA                PIC X VALUE 'A'.
           05  CON-ACCION-MODIF               PIC X VALUE 'M'.
           05  CON-ACCION-BAJA                PIC X VALUE 'B'.
           05  CON-SI                         PIC XX VALUE 'SI'.
           05  CON-NO                         PIC XX VALUE 'NO'.
           05  CON-EMPLEADO                   PIC XX VALUE '07'.
           05  CON-VIGENTE                    PIC X  VALUE 'S'.
           05  CON-BV-TRA                     PIC XXX VALUE 'TRA'.
           05  CON-BV-PCL                     PIC XXX VALUE 'PCL'.
           05  CON-BV-EMG                     PIC XXX VALUE 'EMG'.
           05  CON-BV-PEG                     PIC XXX VALUE 'PEG'.
           05  CON-BV-EMP                     PIC XXX VALUE 'EMP'.
           05  CON-BV-PEM                     PIC XXX VALUE 'PEM'.
           05  CON-MENOS-UNO                  PIC S9(4) COMP VALUE -1.
           05  CON-CURRDC           PIC X(16) VALUE 'COLRDC01-CURRDC'.
           05  CON-CROPICDL         PIC X(16) VALUE 'COLOPC01-ICGDLC'.
           05  CON-BASICOS          PIC X(16) VALUE 'VCL0101_BASICOS'.
           05  CON-COLVEN           PIC X(16) VALUE 'COLVEN01_VENCTO.'.
           05  CON-COLIVA           PIC X(16) VALUE 'COLIVA01_IVA    '.
           05  CON-COLRDC           PIC X(16) VALUE 'COLRDC01_RDCIND.'.
           05  CON-COLICG           PIC X(16) VALUE 'COLICG01_ICGCOM.'.
           05  WS-HUBO-CAMBIO           PIC XX      VALUE 'NO'.
           05  CTA-BLANCO               PIC X(01) VALUE SPACES.
           05  CTA-BLANCOS              PIC X(02) VALUE SPACES.
           05  CTA-DESC-TIO             PIC X(30) VALUE SPACES.
           05  CTA-DESC-AUX             PIC X(35) VALUE SPACES.
           05  CTA-SUC-AUX.
              07  CTA-SUC-AUX-F         PIC X(04) VALUE SPACES.
              07  CTA-SUCURSAL          PIC X(26) VALUE SPACES.
           05  CTA-DCOR-AUX.
              07  C-DCOR-AUX-TIPO       PIC X(03) VALUE SPACES.
                88  C-DCOR-AUX-ES-PPL               VALUE 'PPL'.
                88  C-DCOR-AUX-ES-HIP               VALUE 'HIP'.
                88  C-DCOR-AUX-ES-PRD               VALUE 'PRD'.
              07  C-DCOR-AUX-TASA       PIC XX    VALUE SPACES.
                88  C-DCOR-AUX-ES-VARI              VALUE 'TV'.
                88  C-DCOR-AUX-ES-FIJA              VALUE 'TF'.
      *
       01  CTES-ERROR-AVISO.
           05  CON-AHO-E-USUARIO-NO-VALID    PIC X(8) VALUE 'JAHE175'.
           05  CON-ING-DATOS                 PIC X(8) VALUE 'JAHA001'.
           05  CON-ALTA-EFEC                 PIC X(8) VALUE 'JAHA008'.
           05  CON-MODIF-EFEC                PIC X(8) VALUE 'JAHA009'.
           05  CON-CONFIRMACION              PIC X(8) VALUE 'JAHA010'.
           05  CON-ALTA-CANC                 PIC X(8) VALUE 'JAHA016'.
           05  CON-MODIF-CANC                PIC X(8) VALUE 'JCPA099'.
           05  CON-TECLA-INVALIDA            PIC X(8) VALUE 'JCGE008'.
           05  CON-DEBE-CONS-P-MODIF         PIC X(8) VALUE 'JAHE487'.
           05  CON-DEBE-CONS-P-BAJA          PIC X(8) VALUE 'JAHE738'.
           05  CON-MOD-IGNORADA              PIC X(8) VALUE 'JACE111'.
           05  CON-FUNCION-NO-IMPLEMEN       PIC X(8) VALUE 'JACE104'.
           05  CON-NO-CORRESP-PRTO           PIC X(8) VALUE 'JACE106'.
           05  CON-NO-CORRESP-CASA           PIC X(8) VALUE 'JACE107'.
           05  CON-NO-CORRESP-PREN           PIC X(8) VALUE 'JACE108'.
           05  CON-NO-CORRESP-SALI           PIC X(8) VALUE 'JACE109'.
           05  CON-VERIF-DATOS               PIC X(8) VALUE 'JACE110'.
           05  CON-RETORNE-CON-F9            PIC X(8) VALUE 'JACA151'.
           05  CON-CONFIRMA-ALTA             PIC X(8) VALUE 'JACA152'.
           05  CON-CONFIRMA-MODIF            PIC X(8) VALUE 'JACA153'.
           05  CON-CONFIRMA-BAJA             PIC X(8) VALUE 'JACA154'.
           05  CON-SIMUL-EFEC                PIC X(8) VALUE 'JACA155'.
           05  CON-BAJA-EFEC                 PIC X(8) VALUE 'JACA156'.
           05  CON-BAJA-CANC                 PIC X(8) VALUE 'JACA157'.
           05  CON-CONFIRMA-APROB            PIC X(8) VALUE 'JACA158'.
           05  CON-APROB-CANC                PIC X(8) VALUE 'JACA159'.
           05  CON-APROB-EFEC                PIC X(8) VALUE 'JACA160'.
      *
      *
      * PUNTEROS PARA DIRECCIONAMIENTO
       01  XNVT-BLL-RESOLUTION.
           02  XNVT-BLL-AS-COMP    PIC S9(8) COMP.
           02  XNVT-BLL-AS-POINTER
               REDEFINES XNVT-BLL-AS-COMP       POINTER.
       01  WSS-TDF.
           03 WSS-TDF-CON-1   PIC X(01)    VALUE 'I'.
           03 WSS-TDF-SIM-1   PIC X(01)    VALUE '4'.
           03 WSS-TDF-ALT-1   PIC X(01)    VALUE '5'.
           03 WSS-TDF-MOD-1   PIC X(01)    VALUE '6'.
           03 WSS-TDF-ELI-1   PIC X(01)    VALUE '7'.
           03 WSS-TDF-ALT-C   PIC X(01)    VALUE 'A'.
           03 WSS-TDF-MOD-C   PIC X(01)    VALUE 'B'.
           03 WSS-TDF-ELI-C   PIC X(01)    VALUE 'F'.


       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
       COPY CGTL0010.
      *    02 FILLER                             PIC X(3500).
       COPY CACL0010.
       COPY GT301WR1.
       COPY CACW2001.
       COPY CACW2011.
       COPY CACW2021.
       COPY CACW1601.
      * FIN CMMA
       COPY GNSLGFIO.

      *
      * DOCUMENTACION CAMPOS EXCEPCIONALES
      * -----------------------------------
      *
      *    WSA-MAPA     CACW2001     CACW2011     CAW2021
      *    --------     --------     --------     -------
      *
      *    TASACION     X            =            X
      *
      *    VALSEGUR     X            X            =
      *
      *    IMPSEG       X            =            X
      *
      *    IMPSEL       =            X            X
      *
      *    CODINMO      X            =            CODICON
      *
      *    INMOBIL      X            =            CONCESION
      *
      *    COMINMOBIL   X            =            COMICONCE
      *
      *    DESCINMO     X            =            DESCONCE
      *
      *
       PROCEDURE DIVISION.
      *===================

      ******************************************************************
      *           SECCION: RUTINA PRINCIPAL                            *
      ******************************************************************
       RUTINA-PRINCIPAL SECTION.

           PERFORM 100-INICIO-PROGRAMA.

           PERFORM 200-PROCESO-PROGRAMA.

           PERFORM 800-FINAL-PROGRAMA.

           GOBACK.

       FIN.
           EXIT.

       100-INICIO-PROGRAMA SECTION.
      *MAIN SECTION.
       INI-MAIN.
      *
      *  GANAR DIRECCIONAMIENTO
      *
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PRTO
              MOVE CGTL0010-MES-PTR-INPUT  TO XNVT-BLL-AS-COMP
              SET ADDRESS OF CACW2001-AREA TO XNVT-BLL-AS-POINTER
               CONTINUE
             PERFORM ATR-2001
             MOVE CACW2001-AREA TO WWW-DFLD
             MOVE '2001' TO WWW-AUX4
             PERFORM MOV-2001-WSA
           ELSE
             IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-CASA
                MOVE CGTL0010-MES-PTR-INPUT  TO XNVT-BLL-AS-COMP
                SET ADDRESS OF CACW2011-AREA TO XNVT-BLL-AS-POINTER
                CONTINUE
               PERFORM ATR-2011
               MOVE CACW2011-AREA TO WWW-DFLD
               MOVE '2011' TO WWW-AUX4
               PERFORM MOV-2011-WSA
             ELSE
               IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PREN
                   MOVE CGTL0010-MES-PTR-INPUT  TO XNVT-BLL-AS-COMP
                   SET ADDRESS OF CACW2021-AREA TO XNVT-BLL-AS-POINTER
                   CONTINUE
                 PERFORM ATR-2021
                 MOVE CACW2021-AREA TO WWW-DFLD
                 MOVE '2021' TO WWW-AUX4
                 PERFORM MOV-2021-WSA
             ELSE
                 IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-SALI
                   MOVE CGTL0010-MES-PTR-INPUT  TO XNVT-BLL-AS-COMP
                   SET ADDRESS OF CACW2001-AREA TO XNVT-BLL-AS-POINTER
                   CONTINUE
                   PERFORM ATR-2001
                   MOVE CACW2001-AREA TO WWW-DFLD
                   MOVE '2001' TO WWW-AUX4
                   PERFORM MOV-2001-WSA
                 ELSE
                  IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-APRB
                    MOVE CGTL0010-MES-PTR-INPUT  TO XNVT-BLL-AS-COMP
                    SET ADDRESS OF CACW1601-AREA TO XNVT-BLL-AS-POINTER
                    CONTINUE
                    PERFORM ATR-1601
                    MOVE CACW1601-AREA TO WWW-DFLD
                    MOVE '1601' TO WWW-AUX4
                    PERFORM MOV-1601-WSA
                  ELSE
                    MOVE CON-FUNCION-NO-IMPLEMEN TO CGTL0010-ERROR-CODE
                    PERFORM 800-FINAL-PROGRAMA.

           MOVE CGTL0010-MES-AID TO XXX-AID.

           MOVE CGTL0010-PTR-TERMINALES TO XNVT-BLL-AS-COMP
           SET ADDRESS OF GT301-WRK1    TO XNVT-BLL-AS-POINTER
           CONTINUE
      *

           PERFORM GNS-HDL-VSM.
           PERFORM GNS-ERR-QUE.
           PERFORM GNS-HDL-SYS.

           MOVE 'PTCQ' TO TDI-FIO-TERM.
           MOVE SPACES TO TDI.
      *    MOVE TDI-TYPE TO TSI-FIO-TERM.
      *    MOVE TDI-TYPE TO TSO-FIO-TERM.
           MOVE TDI-TYPE TO ABP-FIO-TERM.
      *    MOVE TDI-TYPE TO SCR-OTRN.
      *    MOVE TDI-TYPE TO OSC-OTRN.
      *    MOVE TDI-TYPE TO TSC-OTRN.

      *  27-JUL-1993 08:32:52 - INI
      *    MOVE TDI-COD-ULOG IN TDI TO WSS-TIDD.
      *    MOVE TDI-TYPE TO WSS-TIDD.
      *  27-JUL-1993 08:32:52 - FIN

       FIN.
           EXIT.

      ******************************************************************
      *             200-PROCESO-PROGRAMA                               *
      *   CONTROLA EL PROCESO A REALIZAR SEGUN POSIBLES ESTADOS        *
      *          - INICIO, CONTINUACION, CONFIRMACION -                *
      ******************************************************************
       200-PROCESO-PROGRAMA SECTION.
      *----------------------------*
      *
           IF CGTL0010-ESTADO EQUAL CON-ESTADO-INICIO
             PERFORM 205-INICIO-PROCESO
           ELSE
             IF CGTL0010-ESTADO EQUAL CON-ESTADO-CONTINUACION
               PERFORM 400-CONTINUACION-PROCESO
             ELSE
               IF CGTL0010-ESTADO EQUAL CON-ESTADO-CONFIRMACION
                 PERFORM 600-CONFIRMACION-PROCESO.
       FIN.
           EXIT.


      *--------------------------*
       205-INICIO-PROCESO SECTION.
      *--------------------------*
      *
           MOVE CGTL0010-APLICACION-CCT TO CGTL0010-APLICACION
           MOVE CGTL0010-ENTRADA-CCT    TO CGTL0010-ENTRADA
           MOVE CON-ESTADO-CONTINUACION TO CGTL0010-ESTADO.
           MOVE CON-ACCION-TERMINAL     TO CGTL0010-ACCION.
           MOVE CON-PANTALLA-MANT-CONT  TO CGTL0010-PANTALLA.

           IF WSA-MAPA-NUMERO EQUAL ZEROES
             THEN INITIALIZE WS-AREA-MAPA
                  PERFORM 310-RESERVAR-DATOS-MAPA
                  MOVE CON-ING-DATOS TO CGTL0010-AVISO-CODE-1
             ELSE PERFORM 250-TRATAR-CONSULTA.

           IF CGTL0010-ERROR-CODE  EQUAL SPACES
                PERFORM  300-FORMATEAR-MAPA
                PERFORM  310-RESERVAR-DATOS-MAPA
                MOVE CGTI0010-ENTER  TO CACL0010-PTRO-PFANT.
      *
       205-FIN.
           EXIT.

      *----------------------------*
       250-TRATAR-CONSULTA SECTION.
      *----------------------------*
      *
      * * CONSULTA, OPCIONES DE MENU PARA LLAVES INGRESADAS POR PANTALLA
      * * ALTAMIRA, DE OTRA FORMA LAS
      * * LLAVES VAN VIA CMMA, PUES CORRESPONDE A CONSULTAS
      * * INMEDIATAMENTE DESPUES DE UN INGRESO
      *    IF CGTL0010-MES-AID = WSS-TDF-CON-1
           IF WSA-MAPA-NUMERO EQUAL ZEROES
              MOVE 'DEBE INGRESAR NUMERO DE OPERACION A CONSULTAR'
                   TO WSA-MAPA-MENSAJE
               MOVE CON-NUMERO      TO WSA-MAPA-CAMPO-ERRONEO
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
               GO TO FIN.
           MOVE 'COLOPCCONKEY' TO I-OPCCONGKY-TDI-COD-NEMO
           MOVE 'COLVENCONKEY' TO I-VENCONGKY-TDI-COD-NEMO
           MOVE 'COLDLCCONKEY' TO I-DLCCONGKY-TDI-COD-NEMO
           MOVE 'COLCDCCONKEY' TO I-CDCCONGKY-TDI-COD-NEMO
           PERFORM GEN-CON-OPC.

           PERFORM 390-INVOCAR-AL-MONITOR.

           PERFORM  260-BUSCO-OPERACION
           PERFORM  261-BUSCO-AUXILIAR
           STRING CTA-DESC-TIO CTA-BLANCO CTA-DESC-AUX
                  DELIMITED BY CTA-BLANCOS INTO WSA-MAPA-DESCOPE
           PERFORM  265-BUSCO-SUCURSAL.

       FIN.
           EXIT.

      *-- AEV - INI
      *----------------------------*
       255-TRATO-ENCABEZADO SECTION.
      *----------------------------*
           PERFORM  260-BUSCO-OPERACION.
           PERFORM  261-BUSCO-AUXILIAR.
           STRING CTA-DESC-TIO CTA-BLANCO CTA-DESC-AUX
                  DELIMITED BY CTA-BLANCOS INTO WSA-MAPA-DESCOPE.

           MOVE SPACES TO WSA-MAPA-DESCSUC.

      * ------   PRESTAMOS SALIDA SOLO PUEDE MANTENER LA 995 --------*
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-SALI
             AND GT301-W1-ROFIOPE NOT EQUAL 995
              MOVE 'SUCURSAL NO PERMITIDA' TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
              GO TO FIN.

      * ------   SI NO SE INFORMA SUCURSAL SE ASUME LA DE LA SESION -*
           IF WSA-MAPA-SUCURSAL EQUAL ZEROES
             MOVE GT301-W1-ROFIOPE TO WSA-MAPA-SUCURSAL.

      * ------  CADA SUCURSAL PUEDE CARGAR SUS OPERACIONES   --------*
           IF GT301-W1-ROFIOPE EQUAL WSA-MAPA-SUCURSAL
              GO TO FIN.

      * ------  LA SUCURSAL 995 PUEDE CARGAR LO DE CUALQUIER SUC ----*
           IF GT301-W1-ROFIOPE NOT EQUAL 995
              MOVE 'SUCURSAL NO PERMITIDA' TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
              GO TO FIN.
           PERFORM  265-BUSCO-SUCURSAL.
       FIN.
           EXIT.

      *---------------------------*
       260-BUSCO-OPERACION SECTION.
      *---------------------------*
           MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
           MOVE WSA-MAPA-COD-OPE    TO TAB-COD-CTAB IN TAB
           MOVE SPACES              TO TAB-GLS-DESC IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
             THEN MOVE TAB-GLS-DESC IN TAB TO CTA-DESC-TIO
             ELSE MOVE 'TIPO DE OPERACION ERRONEA' TO WSA-MAPA-MENSAJE
                  MOVE CON-OPERACION TO WSA-MAPA-CAMPO-ERRONEO
                  MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

      *---------------------------*
       261-BUSCO-AUXILIAR  SECTION.
      *---------------------------*
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
           MOVE WSA-MAPA-OPERACION  TO TAB-COD-CTAB IN TAB
           MOVE SPACES              TO TAB-GLS-DESC IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
             THEN MOVE TAB-GLS-DESC IN TAB TO CTA-DESC-AUX
                  MOVE TAB-GLS-ABRV IN TAB TO CTA-DCOR-AUX
             ELSE MOVE 'CODIGO DE OPERACION ERRONEO' TO WSA-MAPA-MENSAJE
                  MOVE CON-OPERACION TO WSA-MAPA-CAMPO-ERRONEO
                  MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

      *---------------------------*
       265-BUSCO-SUCURSAL  SECTION.
      *---------------------------*
           MOVE WSA-MAPA-SUCURSAL   TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           IF FIO-STAT-OKS
             THEN MOVE OFI-GLS-DESC IN OFI TO CTA-SUC-AUX
                  MOVE CTA-SUCURSAL        TO WSA-MAPA-DESCSUC
             ELSE MOVE 'CODIGO SUCURSAL ERRONEA' TO WSA-MAPA-MENSAJE
                  MOVE CON-SUCURSAL      TO WSA-MAPA-CAMPO-ERRONEO
                  MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.
      *-- AEV - FIN

      *----------------------------*
       300-FORMATEAR-MAPA  SECTION.
      *----------------------------*
      *
           IF WSA-MAPA-MENSAJE EQUAL SPACES
             PERFORM 301-CONTROLAR-ESTADO.

           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PRTO
             PERFORM MOV-WSA-2001
             PERFORM CONTROL-2001-PRONTO
           ELSE
             IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-CASA
               PERFORM MOV-WSA-2011
             ELSE
               IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PREN
                 PERFORM MOV-WSA-2021
               ELSE
                 IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-SALI
                   PERFORM MOV-WSA-2001
                   PERFORM CONTROL-2001-SALIDA
                 ELSE
                   IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-APRB
                     PERFORM MOV-WSA-1601
                   ELSE
                     MOVE CON-FUNCION-NO-IMPLEMEN TO CGTL0010-ERROR-CODE
                     PERFORM 800-FINAL-PROGRAMA.

           IF WSA-MAPA-MENSAJE NOT EQUAL SPACES
             MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.

       FIN.
           EXIT.

      *----------------------------*
       301-CONTROLAR-ESTADO SECTION.
      *----------------------------*
      *
           IF WSA-MAPA-ESTADO EQUAL 'ACTIVADO       '
             MOVE 'PRESTAMO ACTIVADO SOLO PUEDE CONSULTAR'
                                                  TO WSA-MAPA-MENSAJE
           ELSE
             IF WSA-MAPA-ESTADO EQUAL 'APROBADO       '
             MOVE 'PRESTAMO APROBADO SOLO PUEDE CONSULTAR'
                                                  TO WSA-MAPA-MENSAJE.
       FIN.
           EXIT.

      ******************************************************************
      *             310-RESERVAR-DATOS-MAPA                            *
      *  PARRAFO QUE MUEVE LOS DATOS DEL MAPA A ENVIAR A LA COMMAREA   *
      ******************************************************************
       310-RESERVAR-DATOS-MAPA SECTION.
      *-------------------------------*
      *
           MOVE WSA-MAPA-MONEDA    TO CACL0010-MONEDA.
           MOVE WSA-MAPA-OPERACION TO CACL0010-OPERACION.
           MOVE WSA-MAPA-NUMERO    TO CACL0010-NUMERO.
           MOVE WSA-MAPA-SUCURSAL  TO CACL0010-SUCURSAL.
           MOVE WSA-MAPA-MONTO     TO CACL0010-MONTO.
           MOVE WSA-MAPA-FECLIQ    TO CACL0010-FECLIQ.
           MOVE WSA-MAPA-SITIVA    TO CACL0010-SITIVA.
           MOVE WSA-MAPA-CANCUOTAS TO CACL0010-CANCUOTAS.
           MOVE WSA-MAPA-CODIDEST  TO CACL0010-CODIDEST.
           MOVE WSA-MAPA-FEPRIVTO  TO CACL0010-FEPRIVTO.
           MOVE WSA-MAPA-IMPGAST   TO CACL0010-IMPGAST.
           MOVE WSA-MAPA-OFICIAL   TO CACL0010-OFICIAL.
           MOVE WSA-MAPA-TASAINT   TO CACL0010-TASAINT.
           MOVE WSA-MAPA-VALSEGUR  TO CACL0010-VALSEGUR.
           MOVE WSA-MAPA-CODCRED   TO CACL0010-CODCRED.
           MOVE WSA-MAPA-CODISER   TO CACL0010-CODISER.
           MOVE WSA-MAPA-OFIAPE    TO CACL0010-OFIAPE.
           MOVE WSA-MAPA-NUMCTA    TO CACL0010-NUMCTA.
           MOVE WSA-MAPA-DIGICTA   TO CACL0010-DIGICTA.
           MOVE WSA-MAPA-NUMCLI1   TO CACL0010-NUMCLI1.
           MOVE WSA-MAPA-SEGVDA1   TO CACL0010-SEGVDA1.
           MOVE WSA-MAPA-NUMCLI2   TO CACL0010-NUMCLI2.
           MOVE WSA-MAPA-SEGVDA2   TO CACL0010-SEGVDA2.
           MOVE WSA-MAPA-NUMCLI3   TO CACL0010-NUMCLI3.
           MOVE WSA-MAPA-SEGVDA3   TO CACL0010-SEGVDA3.
           MOVE WSA-MAPA-CODINMO   TO CACL0010-CODINMO.
           MOVE WSA-MAPA-INMOBIL   TO CACL0010-INMOBIL.
           MOVE WSA-MAPA-COMINMOBIL TO CACL0010-COMINMOBIL.
           MOVE CGTL0010-AVISO-CODE-1 TO CACL0010-AVISO-ENVIADO-1.
           MOVE CGTL0010-AVISO-CODE-2 TO CACL0010-AVISO-ENVIADO-2.
      *
       310-FIN.
           EXIT.

      ******************************************************************
      *             315-MOVER-DATOS-RESER-A-MAPA                       *
      *  PARRAFO QUE MUEVE LOS DATOS RESERVADOS EN  COMMAREA AL MAPA   *
      ******************************************************************
       315-MOVER-DATOS-RESER-A-MAPA SECTION.
      *------------------------------------*
      *
           MOVE CACL0010-MONEDA    TO WSA-MAPA-MONEDA
           MOVE CACL0010-OPERACION TO WSA-MAPA-OPERACION
           MOVE CACL0010-NUMERO    TO WSA-MAPA-NUMERO
           MOVE CACL0010-SUCURSAL  TO WSA-MAPA-SUCURSAL
           MOVE CACL0010-MONTO     TO WSA-MAPA-MONTO
           MOVE CACL0010-FECLIQ    TO WSA-MAPA-FECLIQ
           MOVE CACL0010-SITIVA    TO WSA-MAPA-SITIVA
           MOVE CACL0010-CANCUOTAS TO WSA-MAPA-CANCUOTAS
           MOVE CACL0010-CODIDEST  TO WSA-MAPA-CODIDEST
           MOVE CACL0010-FEPRIVTO  TO WSA-MAPA-FEPRIVTO
           MOVE CACL0010-OFICIAL   TO WSA-MAPA-OFICIAL
           MOVE CACL0010-TASAINT   TO WSA-MAPA-TASAINT
           MOVE CACL0010-VALSEGUR  TO WSA-MAPA-VALSEGUR
           MOVE CACL0010-CODCRED   TO WSA-MAPA-CODCRED
           MOVE CACL0010-CODISER   TO WSA-MAPA-CODISER
           MOVE CACL0010-OFIAPE    TO WSA-MAPA-OFIAPE
           MOVE CACL0010-NUMCTA    TO WSA-MAPA-NUMCTA
           MOVE CACL0010-DIGICTA   TO WSA-MAPA-DIGICTA
           MOVE CACL0010-NUMCLI1   TO WSA-MAPA-NUMCLI1
           MOVE CACL0010-SEGVDA1   TO WSA-MAPA-SEGVDA1
           MOVE CACL0010-NUMCLI2   TO WSA-MAPA-NUMCLI2
           MOVE CACL0010-SEGVDA2   TO WSA-MAPA-SEGVDA2
           MOVE CACL0010-NUMCLI3   TO WSA-MAPA-NUMCLI3
           MOVE CACL0010-SEGVDA3   TO WSA-MAPA-SEGVDA3.
           MOVE CACL0010-CODINMO  TO WSA-MAPA-CODINMO.
           MOVE CACL0010-COMINMOBIL TO WSA-MAPA-COMINMOBIL.
           MOVE CACL0010-INMOBIL  TO WSA-MAPA-INMOBIL.
           MOVE CACL0010-AVISO-ENVIADO-1 TO CGTL0010-AVISO-CODE-1.
           MOVE CACL0010-AVISO-ENVIADO-2 TO CGTL0010-AVISO-CODE-2.
      *
       315-FIN.
           EXIT.

      *--------------------------------------*
       320-DETERMINAR-SI-HUBO-CAMBIOS SECTION.
      *--------------------------------------*
      *
           IF WSA-MAPA-MONEDA NOT EQUAL CACL0010-MONEDA OR
                WSA-MAPA-OPERACION NOT EQUAL CACL0010-OPERACION OR
                WSA-MAPA-SUCURSAL  NOT EQUAL CACL0010-SUCURSAL  OR
                WSA-MAPA-MONTO     NOT EQUAL CACL0010-MONTO     OR
                WSA-MAPA-FECLIQ    NOT EQUAL CACL0010-FECLIQ    OR
                WSA-MAPA-SITIVA    NOT EQUAL CACL0010-SITIVA    OR
                WSA-MAPA-CANCUOTAS NOT EQUAL CACL0010-CANCUOTAS OR
                WSA-MAPA-CODIDEST  NOT EQUAL CACL0010-CODIDEST  OR
                WSA-MAPA-FEPRIVTO  NOT EQUAL CACL0010-FEPRIVTO  OR
                WSA-MAPA-IMPGAST   NOT EQUAL CACL0010-IMPGAST   OR
                WSA-MAPA-OFICIAL   NOT EQUAL CACL0010-OFICIAL   OR
                WSA-MAPA-TASAINT   NOT EQUAL CACL0010-TASAINT   OR
                WSA-MAPA-VALSEGUR  NOT EQUAL CACL0010-VALSEGUR  OR
                WSA-MAPA-CODCRED   NOT EQUAL CACL0010-CODCRED   OR
                WSA-MAPA-CODISER   NOT EQUAL CACL0010-CODISER   OR
                WSA-MAPA-OFIAPE    NOT EQUAL CACL0010-OFIAPE    OR
                WSA-MAPA-NUMCTA    NOT EQUAL CACL0010-NUMCTA    OR
                WSA-MAPA-DIGICTA   NOT EQUAL CACL0010-DIGICTA   OR
                WSA-MAPA-NUMCLI1   NOT EQUAL CACL0010-NUMCLI1   OR
                WSA-MAPA-SEGVDA1   NOT EQUAL CACL0010-SEGVDA1   OR
                WSA-MAPA-NUMCLI2   NOT EQUAL CACL0010-NUMCLI2   OR
                WSA-MAPA-SEGVDA2   NOT EQUAL CACL0010-SEGVDA2   OR
                WSA-MAPA-NUMCLI3   NOT EQUAL CACL0010-NUMCLI3   OR
                WSA-MAPA-SEGVDA3   NOT EQUAL CACL0010-SEGVDA3   OR
                WSA-MAPA-CODINMO   NOT EQUAL CACL0010-CODINMO   OR
                WSA-MAPA-INMOBIL   NOT EQUAL CACL0010-INMOBIL   OR
                WSA-MAPA-COMINMOBIL NOT EQUAL CACL0010-COMINMOBIL
                MOVE CON-SI TO WS-HUBO-CAMBIO
           ELSE MOVE CON-NO TO WS-HUBO-CAMBIO.
      *
       FIN.
           EXIT.

       350-VALIDA-E-INGRESA      SECTION.
      *---------------------------------*
      *
      * SIMULACION                  O
      * ALTA                        O
      * MODIFICACION                O
      * CONFIRMACION MODIFICACION   O
      * CONFIRMACION DE ALTA
      *
               PERFORM RET-I-OPCINGGKY
               MOVE I-OPCINGGKY     TO WSS-MSG-SMJ
               MOVE I-OPCINGGKY-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM CONT-CLI

               PERFORM SET-CLI-OPC

               PERFORM RET-I-OPCINGGFL
               MOVE I-OPCINGGFL TO WSS-MSG-SMJ
               MOVE I-OPCINGGFL-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM SET-CLI-RDC

               PERFORM RET-I-DLCINGGKY
               MOVE I-DLCINGGKY TO WSS-MSG-SMJ
               MOVE I-DLCINGGKY-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-DLCINGGFL
               MOVE I-DLCINGGFL TO WSS-MSG-SMJ
               MOVE I-DLCINGGFL-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-EVCINGGKY
               MOVE I-EVCINGGKY TO WSS-MSG-SMJ
               MOVE I-EVCINGGKY-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-EVCINGGFL
               MOVE I-EVCINGGFL TO WSS-MSG-SMJ
               MOVE I-EVCINGGFL-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-OPCLIQGKY
               MOVE I-OPCLIQGKY TO WSS-MSG-SMJ
               MOVE I-OPCLIQGKY-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-OPCLIQGCS
               MOVE I-OPCLIQGCS TO WSS-MSG-SMJ
               MOVE I-OPCLIQGCS-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM GEN-CON-OPC.

       FIN.
           EXIT.

       360-ELIMINA               SECTION.
      *---------------------------------*
      *
      * CONFIRMACION ELIMINACION O CONFIRMACION DE MODIFICACION
      * PRIMERO GENERA ELIMINACION Y DESPUES REINGRESA LA OPERACION,
      * CON EL MISMO NUMERO
               PERFORM RET-I-OPCELIGKY
               MOVE I-OPCELIGKY TO WSS-MSG-SMJ
               MOVE I-OPCELIGKY-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG

               PERFORM RET-I-OPCELIGCS
               MOVE I-OPCELIGCS TO WSS-MSG-SMJ
               MOVE I-OPCELIGCS-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG.

       FIN.
           EXIT.

       360-ELIMINA-ERROR         SECTION.
      *---------------------------------*
      *
      * CONFIRMACION ELIMINACION O CONFIRMACION DE MODIFICACION
      * PRIMERO GENERA ELIMINACION Y DESPUES REINGRESA LA OPERACION,
      * CON EL MISMO NUMERO
               PERFORM RET-E-OPCELIGKY.
               MOVE E-OPCELIGKY TO WSS-MSG-SMJ.
               MOVE E-OPCELIGKY-LEN TO WSS-MSG-SMJ-LEN.
               PERFORM PUT-MSG-MSG.

               PERFORM RET-E-OPCELIGCS
               MOVE E-OPCELIGCS TO WSS-MSG-SMJ
               MOVE E-OPCELIGCS-LEN TO WSS-MSG-SMJ-LEN
               PERFORM PUT-MSG-MSG.

       FIN.
           EXIT.

      *---------------------------------*
       390-INVOCAR-AL-MONITOR    SECTION.
      *---------------------------------*
      *
           MOVE WSS-MSG-ALT TO SYS-CMMA.
           MOVE WSS-MSG-SMJ-LEN TO SYS-TCMA.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TDI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-TDO.

           MOVE 1 TO TDI-NUM-RECO.
           MOVE WSS-MSG-ALT TO TDI-GLS-DESC IN TDI.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
           MOVE 'COLPPMTD' TO SYS-PROG.
           MOVE SYS-LINK TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SPACES TO TDO-GLS-DESC.
           MOVE 1 TO TDO-NUM-RECO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TDO.
      * ERROR EN PROCESO
           IF TDO-NUM-TREP = 1
               PERFORM POS-CURSOR
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.

           MOVE TDO-GLS-DESC TO O-OPCCONGKY

           PERFORM REV-SIMU

      *    PERFORM CHK-AOOC
      *    MOVE TDO-GLS-MENS2 TO WWW-MENSAJE.
      *    IF 'PTI    NEX'  EQUAL  TDO-GLS-MENS2
      *     IF C-DCOR-AUX-ES-FIJA
      *      THEN MOVE 'FALTA CARGAR PTI ' TO TDO-GLS-MENS
      *      ELSE MOVE 'NO DEBE INGRESAR VALOR DE TASA' TO TDO-GLS-MENS.
           MOVE TDO-GLS-MENS TO WSA-MAPA-MENSAJE.
           PERFORM PUT-O-OPCCONGKY.
      *        MOVE I-OPCCONGKY TO WSS-MSG-SMJ
      *        MOVE I-OPCCONGKY-LEN TO WSS-MSG-SMJ-LEN
      *        PERFORM PUT-MSG-MSG.
       FIN.
           EXIT.

      ******************************************************************
      *             400-CONTINUACION-PROCESO.                          *
      *       PROCESA SEGUN LA TECLA PULSADA EN LA TERMINAL            *
      ******************************************************************
       400-CONTINUACION-PROCESO SECTION.
      *--------------------------------*
      *
      ** FORMATEO CAMPOS SCR **
      *
           MOVE CON-APLICACION          TO CGTL0010-APLICACION
           MOVE CGTL0010-ENTRADA-CCT    TO CGTL0010-ENTRADA
           MOVE CON-PANTALLA-MANT-CONT  TO CGTL0010-PANTALLA
           MOVE CON-ACCION-TERMINAL     TO CGTL0010-ACCION
      *
      * OPCIONES *
      *
           IF CGTL0010-MES-AID = CGTI0010-ENTER OR = CGTI0010-F4 OR =
              CGTI0010-F5 OR  =  CGTI0010-F6 OR = CGTI0010-F7
                          OR  =  CGTI0010-F2
                NEXT SENTENCE
           ELSE MOVE CON-TECLA-INVALIDA TO CGTL0010-ERROR-CODE
                GO TO FIN.
      *
      * CONSULTA   *
      *
           IF CGTL0010-MES-AID EQUAL CGTI0010-ENTER
                PERFORM 250-TRATAR-CONSULTA
                IF CGTL0010-ERROR-CODE = SPACES
                     MOVE CGTI0010-ENTER TO CACL0010-PTRO-PFANT.
      *
      * APROBACION   *
      *
            IF CGTL0010-MES-AID EQUAL CGTI0010-F2
              IF CACL0010-PTRO-PFANT  NOT =  CGTI0010-ENTER
               THEN  MOVE CON-DEBE-CONS-P-MODIF TO CGTL0010-ERROR-CODE
               ELSE  PERFORM 402-PROCESO-APROBACION
                     MOVE CON-CONFIRMA-APROB TO CGTL0010-AVISO-CODE-1
                     MOVE CON-CONFIRMACION   TO CGTL0010-AVISO-CODE-2
                     MOVE CGTI0010-F2        TO CACL0010-PTRO-PFANT.
      *
      * SIMULACION *
      *
           IF CGTL0010-MES-AID EQUAL CGTI0010-F4
                PERFORM 410-PROCESO-SIMULACION
                IF CGTL0010-ERROR-CODE = SPACES
                     MOVE CON-SIMUL-EFEC  TO CGTL0010-AVISO-CODE-1
                     MOVE CGTI0010-F4     TO CACL0010-PTRO-PFANT.
      *
      * ALTA *
      *
           IF CGTL0010-MES-AID EQUAL CGTI0010-F5
                PERFORM 420-PROCESO-ALTA
                IF CGTL0010-ERROR-CODE = SPACES
                     MOVE CON-CONFIRMA-ALTA  TO CGTL0010-AVISO-CODE-1
                     MOVE CON-CONFIRMACION   TO CGTL0010-AVISO-CODE-2
                     MOVE CGTI0010-F5        TO CACL0010-PTRO-PFANT.
      *
      * MODIFICACION *
      *
            IF CGTL0010-MES-AID EQUAL CGTI0010-F6
              IF CACL0010-PTRO-PFANT  NOT =  CGTI0010-ENTER
               THEN  MOVE CON-DEBE-CONS-P-MODIF TO CGTL0010-ERROR-CODE
               ELSE  PERFORM 430-PROCESO-MODIFICACION
                     IF CGTL0010-ERROR-CODE = SPACES
                        MOVE CON-CONFIRMA-MODIF TO CGTL0010-AVISO-CODE-1
                        MOVE CON-CONFIRMACION   TO CGTL0010-AVISO-CODE-2
                        MOVE CGTI0010-F6        TO CACL0010-PTRO-PFANT.
      *
      * BAJA *
      *
           IF CGTL0010-MES-AID EQUAL CGTI0010-F7
             IF CACL0010-PTRO-PFANT  NOT =  CGTI0010-ENTER
               THEN  MOVE CON-DEBE-CONS-P-BAJA  TO CGTL0010-ERROR-CODE
               ELSE  PERFORM 440-PROCESO-BAJA
                     IF CGTL0010-ERROR-CODE = SPACES
                        MOVE CON-CONFIRMA-BAJA  TO CGTL0010-AVISO-CODE-1
                        MOVE CON-CONFIRMACION   TO CGTL0010-AVISO-CODE-2
                        MOVE CGTI0010-F7        TO CACL0010-PTRO-PFANT.


           PERFORM  300-FORMATEAR-MAPA.
           IF CGTL0010-ERROR-CODE = SPACES
             PERFORM  310-RESERVAR-DATOS-MAPA.

           IF CON-CONFIRMACION  = CGTL0010-AVISO-CODE-2
             IF CGTL0010-ERROR-CODE = SPACES
               MOVE CON-ESTADO-CONFIRMACION TO CGTL0010-ESTADO
             ELSE
               MOVE SPACES TO CGTL0010-AVISO-CODE-1
                              CGTL0010-AVISO-CODE-2.
       FIN.
           EXIT.


      *---------------------------------*
       402-PROCESO-APROBACION    SECTION.
      *---------------------------------*
      *
      * PARA APROBACION VALIDA OFICINA SOLAMENTE
      *
           IF WSA-MAPA-NUMERO NOT EQUAL CACL0010-NUMERO
              MOVE 'NO PUEDE MODIFICAR EL NUMERO DE OPERACION '
                   TO WSA-MAPA-MENSAJE
              MOVE CON-VERIF-DATOS   TO CGTL0010-ERROR-CODE
              GO TO FIN.

           IF WSA-MAPA-CODOPE-ES-PPL
              PERFORM 402-1-VALIDA-OFICINA-PRONTO
           ELSE
              IF WSA-MAPA-CODOPE-ES-HIP OR WSA-MAPA-CODOPE-ES-PRD
                PERFORM 402-2-VALIDA-OFICINA-HIP-PRD
              ELSE
                MOVE 'TIPO DE OPERACION ERRONEA' TO WSA-MAPA-MENSAJE
                MOVE CON-VERIF-DATOS             TO CGTL0010-ERROR-CODE.

       FIN.
           EXIT.

      *------------------------------------*
       402-1-VALIDA-OFICINA-PRONTO SECTION.
      *------------------------------------*
      *    ------- PRONTO : CADA SUCURSAL APRUEBA LO SUYO (+ LA 995) ---
      *    ------- SALIDA : SE APRUEBA EN FORMA CENTRALIZADA   ---------
           IF WSA-MAPA-CODAUX-ES-SAL
              MOVE 'NO SE PUEDE APROBAR PRESTAMOS DE SALIDA'
                                                     TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
              GO TO FIN.

           IF GT301-W1-ROFIOPE EQUAL WSA-MAPA-SUCURSAL OR
              GT301-W1-ROFIOPE EQUAL 995
              NEXT SENTENCE
           ELSE
              MOVE 'NO PUEDE APROBAR PRESTAMOS DE OTRA SUCURSAL'
                                                     TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

      *------------------------------------*
       402-2-VALIDA-OFICINA-HIP-PRD SECTION.
      *------------------------------------*
      *    --------------- HIPOTECARIO - PRENDARIO          ------------
      *    ---- SUCURSALES DEL INTERIOR (200-899) C/UNA APRUEBA LOS SUYO
      *    ---- EL RESTO SE APRUEBA EN FORMA CENTRALIZADA --------------

           IF NOT WSA-MAPA-ES-SUC-INTERIOR
             MOVE 'SUCURSAL NO HABILITADA P/APROBAR PRESTAMOS HIP/PRD'
                                   TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
              GO TO FIN.

           IF GT301-W1-ROFIOPE EQUAL WSA-MAPA-SUCURSAL
              NEXT SENTENCE
           ELSE
              MOVE 'NO PUEDE APROBAR PRESTAMOS DE OTRA SUCURSAL'
                                                     TO WSA-MAPA-MENSAJE
              MOVE CON-SUCURSAL    TO WSA-MAPA-CAMPO-ERRONEO
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

      *---------------------------------*
       410-PROCESO-SIMULACION    SECTION.
      *---------------------------------*
      *
      * PARA SIMULACION GENERA OPC CON CAI ESPECIAL Y LA ELIMINA
      *
           IF WSA-MAPA-NUMERO NOT EQUAL ZEROES
              MOVE 'NO DEBE INGRESAR NUMERO DE OPERACION '
                   TO WSA-MAPA-MENSAJE
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
           ELSE
               PERFORM 255-TRATO-ENCABEZADO.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
              GO TO FIN.

           MOVE WSA-MAPA-TASAINT  TO CACL0010-TASA-DIGITADA.

           MOVE 'COLOPCINGSIM' TO I-OPCINGGFL-TDI-COD-NEMO.
           PERFORM 350-VALIDA-E-INGRESA.
           PERFORM 360-ELIMINA.
           PERFORM 360-ELIMINA-ERROR.
           PERFORM 390-INVOCAR-AL-MONITOR.
       FIN.
           EXIT.

      *---------------------------------*
       420-PROCESO-ALTA          SECTION.
      *---------------------------------*
      *
      * PARA ALTA GENERA OPC CON CAI ESPECIAL Y LA ELIMINA
      *
           IF CGTL0010-NIVEL-USUARIO LESS CGTL0010-NIVEL-ALTA-CCT
              MOVE CON-AHO-E-USUARIO-NO-VALID TO CGTL0010-ERROR-CODE
              GO TO FIN.

           MOVE WSA-MAPA-TASAINT  TO CACL0010-TASA-DIGITADA.

           IF WSA-MAPA-NUMERO NOT EQUAL ZEROES
              MOVE 'NO DEBE INGRESAR NUMERO DE OPERACION '
                   TO WSA-MAPA-MENSAJE
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE
           ELSE
               PERFORM 255-TRATO-ENCABEZADO.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
              GO TO FIN.

           MOVE 'COLOPCINGSIM' TO I-OPCINGGFL-TDI-COD-NEMO.
           PERFORM 350-VALIDA-E-INGRESA.
           PERFORM 360-ELIMINA.
           PERFORM 360-ELIMINA-ERROR.
           PERFORM 390-INVOCAR-AL-MONITOR.

       FIN.
           EXIT.

      *---------------------------------*
       430-PROCESO-MODIFICACION  SECTION.
      *---------------------------------*
      *
      * PARA MODIFICACION GENERA OPC CON CAI ESPECIAL Y LA ELIMINA
      *
           IF CGTL0010-NIVEL-USUARIO LESS CGTL0010-NIVEL-MODIF-CCT
              MOVE CON-AHO-E-USUARIO-NO-VALID TO CGTL0010-ERROR-CODE
              GO TO FIN.

           IF WSA-MAPA-NUMERO NOT EQUAL CACL0010-NUMERO
              MOVE 'NO PUEDE MODIFICAR EL NUMERO DE OPERACION '
                   TO WSA-MAPA-MENSAJE
              MOVE CON-VERIF-DATOS   TO CGTL0010-ERROR-CODE
              GO TO FIN.

           PERFORM 320-DETERMINAR-SI-HUBO-CAMBIOS
           IF WS-HUBO-CAMBIO EQUAL CON-NO
              MOVE 'NO MODIFICO NINGUN DATO '
                   TO WSA-MAPA-MENSAJE
              MOVE CON-VERIF-DATOS   TO CGTL0010-ERROR-CODE
           ELSE
              PERFORM 255-TRATO-ENCABEZADO.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
              GO TO FIN.

           IF C-DCOR-AUX-ES-FIJA
            THEN MOVE WSA-MAPA-TASAINT  TO CACL0010-TASA-DIGITADA
            ELSE MOVE ZEROES            TO CACL0010-TASA-DIGITADA.

           MOVE 'COLOPCINGSIM' TO I-OPCINGGFL-TDI-COD-NEMO.
           PERFORM 350-VALIDA-E-INGRESA.
           PERFORM 360-ELIMINA.
           PERFORM 360-ELIMINA-ERROR.
           PERFORM 390-INVOCAR-AL-MONITOR.

       FIN.
           EXIT.

       440-PROCESO-BAJA          SECTION.
      *---------------------------------*
      *
           IF CGTL0010-NIVEL-USUARIO LESS CGTL0010-NIVEL-BAJA-CCT
              MOVE CON-AHO-E-USUARIO-NO-VALID TO CGTL0010-ERROR-CODE
              GO TO FIN.


           PERFORM 320-DETERMINAR-SI-HUBO-CAMBIOS
           IF WS-HUBO-CAMBIO EQUAL CON-SI OR
              WSA-MAPA-NUMERO NOT EQUAL CACL0010-NUMERO
              MOVE 'NO PUEDE MODIFICAR NINGUN DATO'
                   TO WSA-MAPA-MENSAJE
              MOVE CON-VERIF-DATOS   TO CGTL0010-ERROR-CODE.

       FIN.
           EXIT.

      * ---------------------------------------------------------------

      *****************************************************************
      *                 600-CONFIRMACION-PROCESO                      *
      *      TESTEA TECLA VALIDAS Y SECUENCIA PARA CONFIRMACION       *
      *****************************************************************
       600-CONFIRMACION-PROCESO SECTION.
      *-------------------------------*
      *
      *
      * TESTEO QUE NO SE HAYAN MODIFICADO NINGUN DATO *
      *
           IF CGTL0010-MES-AID = CGTI0010-ALTF6
            IF CACL0010-PTRO-PFANT NOT EQUAL CGTI0010-F2
             PERFORM 320-DETERMINAR-SI-HUBO-CAMBIOS
             IF  WS-HUBO-CAMBIO EQUAL CON-SI
                PERFORM 315-MOVER-DATOS-RESER-A-MAPA
                MOVE CON-MOD-IGNORADA  TO CGTL0010-ERROR-CODE
                GO TO FIN.
      *
      * TESTEO CONFIRMACION DE ALTA    *
      *
           IF CACL0010-PTRO-PFANT  =  CGTI0010-F5
             IF CGTL0010-MES-AID  NOT =  CGTI0010-ALTF6
              THEN MOVE CON-ALTA-CANC TO CGTL0010-AVISO-CODE-1
              ELSE PERFORM 610-CONFIRMACION-ALTA
                   IF CGTL0010-ERROR-CODE = SPACES
                      MOVE CON-ALTA-EFEC TO CGTL0010-AVISO-CODE-1.
      *
      * TESTEO CONFIRMACION DE MODIFICACION *
      *
           IF CACL0010-PTRO-PFANT  =  CGTI0010-F6
             IF CGTL0010-MES-AID  NOT =  CGTI0010-ALTF6
              THEN MOVE CON-MODIF-CANC TO CGTL0010-AVISO-CODE-1
              ELSE PERFORM 620-CONFIRMACION-MODIF
                   IF CGTL0010-ERROR-CODE = SPACES
                      MOVE CON-MODIF-EFEC TO CGTL0010-AVISO-CODE-1.
      *
      * TESTEO CONFIRMACION DE BAJA  *
      *
           IF CACL0010-PTRO-PFANT  =  CGTI0010-F7
             IF CGTL0010-MES-AID  NOT =  CGTI0010-ALTF6
              THEN MOVE CON-BAJA-CANC TO CGTL0010-AVISO-CODE-1
              ELSE PERFORM 630-CONFIRMACION-ELIMIN
                   IF CGTL0010-ERROR-CODE = SPACES
                      MOVE CON-BAJA-EFEC TO CGTL0010-AVISO-CODE-1.
      *
      * TESTEO CONFIRMACION DE APROBACION   *
      *
           IF CACL0010-PTRO-PFANT  =  CGTI0010-F2
             IF CGTL0010-MES-AID  NOT =  CGTI0010-ALTF6
              THEN MOVE CON-APROB-CANC TO CGTL0010-AVISO-CODE-1
              ELSE PERFORM 640-CONFIRMACION-APROB
                   IF CGTL0010-ERROR-CODE = SPACES
                      MOVE CON-APROB-EFEC TO CGTL0010-AVISO-CODE-1.
      *
      *
           PERFORM  300-FORMATEAR-MAPA.

           IF CGTL0010-ERROR-CODE = SPACES
              INITIALIZE CACL0010-AREA-COL
              MOVE CON-ESTADO-CONTINUACION TO CGTL0010-ESTADO.

       FIN.
           EXIT.

      *-----------------------------*
       610-CONFIRMACION-ALTA SECTION.
      *-----------------------------*
      *    MOVE 'COLOPCINGGFL' TO I-OPCINGGFL-TDI-COD-NEMO.
           PERFORM 350-VALIDA-E-INGRESA.
           PERFORM 390-INVOCAR-AL-MONITOR.
      *
       FIN.
           EXIT.


      *------------------------------*
       620-CONFIRMACION-MODIF SECTION.
      *------------------------------*
           MOVE 'COLOPCELIKEY' TO I-OPCELIGKY-TDI-COD-NEMO.
           PERFORM 360-ELIMINA.
      *    PERFORM 360-ELIMINA-ERROR.
           PERFORM 350-VALIDA-E-INGRESA.
           PERFORM 390-INVOCAR-AL-MONITOR.
      *
       FIN.
           EXIT.


      *--------------------------------*
       630-CONFIRMACION-ELIMIN  SECTION.
      *--------------------------------*
      *
           MOVE 'COLOPCELIKEY' TO I-OPCELIGKY-TDI-COD-NEMO.
           PERFORM 360-ELIMINA.
      *    PERFORM 360-ELIMINA-ERROR.
           PERFORM 390-INVOCAR-AL-MONITOR.
      *
       FIN.
           EXIT.

      *------------------------------*
       640-CONFIRMACION-APROB SECTION.
      *------------------------------*

      * CONFIRMACION APROBACION
      * ----   CONSULTA
               MOVE 'COLOPCCONKEY' TO I-OPCCONGKY-TDI-COD-NEMO
               MOVE 'COLVENCONKEY' TO I-VENCONGKY-TDI-COD-NEMO
               MOVE 'COLDLCCONKEY' TO I-DLCCONGKY-TDI-COD-NEMO
               MOVE 'COLCDCCONKEY' TO I-CDCCONGKY-TDI-COD-NEMO
               PERFORM GEN-CON-OPC
      * ----   --------
      *    IF CGTL0010-MES-AID = 'A'
              MOVE 'COLOPCAPRKEY' TO I-OPCAPRGKY-TDI-COD-NEMO.
              PERFORM RET-I-OPCAPRGKY
              MOVE I-OPCAPRGKY TO WSS-MSG-SMJ
              MOVE I-OPCAPRGKY-LEN TO WSS-MSG-SMJ-LEN
              PERFORM PUT-MSG-MSG
      *
              PERFORM RET-I-OPCAPRGCS
              MOVE I-OPCAPRGCS TO WSS-MSG-SMJ
              MOVE I-OPCAPRGCS-LEN TO WSS-MSG-SMJ-LEN
              PERFORM PUT-MSG-MSG
      *
            IF WSA-MAPA-CODCRED EQUAL 'ACRE'
              MOVE 'COLOPCACAKEY' TO I-OPCACAGKY-TDI-COD-NEMO
              PERFORM RET-I-OPCACAGKY
              MOVE I-OPCACAGKY TO WSS-MSG-SMJ
              MOVE I-OPCACAGKY-LEN TO WSS-MSG-SMJ-LEN
              PERFORM PUT-MSG-MSG
      *
              PERFORM RET-I-OPCACAGCS
              MOVE I-OPCACAGCS TO WSS-MSG-SMJ
              MOVE I-OPCACAGCS-LEN TO WSS-MSG-SMJ-LEN
              PERFORM PUT-MSG-MSG.
      *
           PERFORM 390-INVOCAR-AL-MONITOR.
      *
       FIN.
           EXIT.

      ******************************************************************
      *           800-FINAL-PROGRAMA
      *      EL PROGRAMA RETORNA AL SCP DEVOLVIENDO EL CONTROL AL CICS
      ******************************************************************
       800-FINAL-PROGRAMA SECTION.

           EXEC CICS
           RETURN
           END-EXEC.
      *
       800-FIN.
           EXIT.


      * ------------------------------------------------------------
      * CONFIRMACION APROBACION
      *    IF CGTL0010-MES-AID = 'A'
      *        PERFORM RET-I-OPCAPRGKY
      *        MOVE I-OPCAPRGKY TO WSS-MSG-SMJ
      *        MOVE I-OPCAPRGKY-LEN TO WSS-MSG-SMJ-LEN
      *        PERFORM PUT-MSG-MSG
      *
      *        PERFORM RET-I-OPCAPRGCS
      *        MOVE I-OPCAPRGCS TO WSS-MSG-SMJ
      *        MOVE I-OPCAPRGCS-LEN TO WSS-MSG-SMJ-LEN
      *        PERFORM PUT-MSG-MSG
      *
      *        PERFORM RET-I-OPCACAGKY
      *        MOVE I-OPCACAGKY TO WSS-MSG-SMJ
      *        MOVE I-OPCACAGKY-LEN TO WSS-MSG-SMJ-LEN
      *        PERFORM PUT-MSG-MSG
      *
      *        PERFORM RET-I-OPCACAGCS
      *        MOVE I-OPCACAGCS TO WSS-MSG-SMJ
      *        MOVE I-OPCACAGCS-LEN TO WSS-MSG-SMJ-LEN
      *        PERFORM PUT-MSG-MSG.
      * ------------------------------------------------------------




       COPY GNSBGQUE.
       COPY GNSBFTDI.
       COPY GNSBFTDO.
       COPY GNSBFABP.
       COPY GNSBGVSM.
       COPY GNSBHVSM.

       COPY GNSBGEND.
       COPY GNSBFTAB.

       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBPNUM.

      * << a.e.v. 27-03-1995  - ini
       POS-CURSOR SECTION.
           MOVE 'COL' TO FIO-SIST
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB
           MOVE TDO-GLS-MENS1 TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF NOT FIO-STAT-OKS
              GO TO FIN-POS-CURSOR.
           IF TAB-GLS-ABRV NUMERIC
              MOVE TAB-GLS-ABRV TO WSA-MAPA-CAMPO-ERRONEO.
           MOVE TAB-GLS-DESC TO TDO-GLS-MENS1.
      * << a.e.v. 27-03-1995  -fin
       FIN-POS-CURSOR.
           EXIT.
       CHK-AOOC SECTION.
       INI-CHK-AOOC.
           IF CGTL0010-MES-AID = 'I'
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PRTO AND
              O-CDCCONGKY-FRM-IND-AOOC NOT = '01'
              MOVE 'OPERACION NO ES PRESTAMO PERSONAL'
                     TO TDO-GLS-MENS
           ELSE
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-CASA AND
              O-CDCCONGKY-FRM-IND-AOOC NOT = '02'
              MOVE 'OPERACION NO ES PRESTAMO HIPOTECARIO'
                     TO TDO-GLS-MENS
           ELSE
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PREN AND
              O-CDCCONGKY-FRM-IND-AOOC NOT = '03'
              MOVE 'OPERACION NO ES PRESTAMO PRENDARIO'
                     TO TDO-GLS-MENS.
       FIN-CHK-AOOC.
           EXIT.

       PUT-MSG-MSG SECTION.
       INI-PUT-MSG-MSG.
           PERFORM PUT-MSG-SMJ VARYING WSS-MSG-SMJ-IDX
                     FROM 1 BY 1 UNTIL
                      WSS-MSG-SMJ-IDX >  WSS-MSG-SMJ-LEN.
       FIN-PUT-MSG-MSG.
           EXIT.

       PUT-MSG-SMJ SECTION.
       INI-PUT-MSG-SMJ.
           ADD 1 TO WSS-MSG-ALT-IDX.
           MOVE WSS-MSG-SMJ-ELM IN WSS-MSG-SMJ(WSS-MSG-SMJ-IDX) TO
                WSS-MSG-ALT-ELM IN WSS-MSG-ALT(WSS-MSG-ALT-IDX).
       FIN-PUT-MSG-SMJ.
           EXIT.

123456*FIN SECTION.
      *INI-FIN.
      *    MOVE 'C' TO CGTL0010-ESTADO.
      *    EXEC CICS
      *          RETURN
      *    END-EXEC.
      *FIN-FIN.
      *    EXIT.

       GEN-CON-OPC SECTION.
       INI-GEN-CON-OPC.
           PERFORM RET-I-OPCCONGKY.
           MOVE I-OPCCONGKY TO WSS-MSG-SMJ.
           MOVE I-OPCCONGKY-LEN TO WSS-MSG-SMJ-LEN.
           PERFORM PUT-MSG-MSG.

           PERFORM RET-I-VENCONGKY.
           MOVE I-VENCONGKY TO WSS-MSG-SMJ.
           MOVE I-VENCONGKY-LEN TO WSS-MSG-SMJ-LEN.
           PERFORM PUT-MSG-MSG.

           PERFORM RET-I-DLCCONGKY.
           MOVE I-DLCCONGKY TO WSS-MSG-SMJ.
           MOVE I-DLCCONGKY-LEN TO WSS-MSG-SMJ-LEN.
           PERFORM PUT-MSG-MSG.

           PERFORM RET-I-CDCCONGKY.
           MOVE I-CDCCONGKY TO WSS-MSG-SMJ.
           MOVE I-CDCCONGKY-LEN TO WSS-MSG-SMJ-LEN.
           PERFORM PUT-MSG-MSG.

       FIN-GEN-CON-OPC.
           EXIT.

       RET-I-OPCINGGKY SECTION.
       INI-RET-I-OPCINGGKY.
           MOVE WSA-MAPA-COD-OPE TO I-OPCINGGKY-OPC-COD-TOCC.
           MOVE SPACES           TO I-OPCINGGKY-OPC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-OPCINGGKY-OPC-IIC-IOPC.
           IF I-OPCINGGFL-TDI-COD-NEMO = 'COLOPCINGSIM'
                MOVE SPACES TO I-OPCINGGKY-OPC-IIC-IOPC.
           MOVE SPACES           TO I-OPCINGGKY-CAN-CAI-IOPC.
           MOVE SPACES           TO I-OPCINGGKY-CAN-IIC-IOPC.
           MOVE SPACES           TO I-OPCINGGKY-CAN-NUM-ICAN.
           IF WSA-MAPA-MONEDA  = ZEROES
               MOVE '0000'   TO I-OPCINGGKY-OPC-COD-VCOC
           ELSE
           IF WSA-MAPA-MONEDA  = 2
               MOVE '100200' TO I-OPCINGGKY-OPC-COD-VCOC
           ELSE
               MOVE SPACES   TO I-OPCINGGKY-OPC-COD-VCOC.
           MOVE WSA-MAPA-COD-AUX TO I-OPCINGGKY-OPC-COD-AOCC.
       FIN-RET-I-OPCINGGKY.
           EXIT.

       CONT-CLI SECTION.
       INI-CONT-CLI.
           IF WSA-MAPA-NUMCLI1 > ZEROES OR
              WSA-MAPA-CODCLI1 > ZEROES
               ADD 1 TO WSS-TOT-CLI.
           IF WSA-MAPA-NUMCLI2 > ZEROES OR
              WSA-MAPA-CODCLI2 > ZEROES
               ADD 1 TO WSS-TOT-CLI.
           IF WSA-MAPA-NUMCLI3 > ZEROES OR
              WSA-MAPA-CODCLI3 > ZEROES
               ADD 1 TO WSS-TOT-CLI.
       FIN-CONT-CLI.
           EXIT.

       SET-CLI-OPC SECTION.
       INI-SET-CLI-OPC.
           MOVE 'N' TO WSS-CLI-SIMU.
           IF CGTL0010-MES-AID = WSS-TDF-SIM-1
               IF WSS-TOT-CLI = ZEROES
                   MOVE 'S' TO WSS-CLI-SIMU
                   MOVE 1 TO WSS-TOT-CLI
                   MOVE 1 TO WSA-MAPA-CODCLI1
123456*            MOVE 1 TO WSA-MAPA-NUMCLI1.
                   MOVE 13208400 TO WSA-MAPA-NUMCLI1.

           MOVE 'N' TO WSS-AVL-SIMU.
           IF CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-CASA
             OR CGTL0010-ENTRADA-CCT EQUAL CON-ENTRADA-BNL-PREN
           IF CGTL0010-MES-AID = WSS-TDF-SIM-1
           IF WSA-MAPA-INMOBIL NOT > ZEROES
               MOVE 'S' TO WSS-AVL-SIMU
123456*        MOVE 1        TO WSA-MAPA-CODINMO
               MOVE 0        TO WSA-MAPA-CODINMO
123456*        MOVE 17068195 TO WSA-MAPA-INMOBIL.
               MOVE 57997551 TO WSA-MAPA-INMOBIL.

           MOVE 'N' TO WSS-CAJ-SIMU.
           IF CGTL0010-MES-AID = WSS-TDF-SIM-1
               IF WSA-MAPA-CODCRED NOT > SPACES
                   MOVE 'S' TO WSS-CAJ-SIMU
                   MOVE 'CAJA' TO WSA-MAPA-CODCRED.


           MOVE 'N' TO WSS-EJC-SIMU.
           IF CGTL0010-MES-AID = WSS-TDF-SIM-1
               IF WSA-MAPA-OFICIAL NOT > SPACES
                   MOVE 'S' TO WSS-EJC-SIMU
                   MOVE SPACES TO WSA-MAPA-OFICIAL.

           IF WSS-TOT-CLI > 1
              MOVE 'M'               TO I-OPCINGGFL-DBC-IND-ICLI
              MOVE SPACES            TO I-OPCINGGFL-DBC-NUM-ICLI
              MOVE SPACES            TO I-OPCINGGFL-DBC-VRF-ICLI
              MOVE SPACES            TO I-OPCINGGFL-DBC-GLS-ICLI
            ELSE
              IF WSA-MAPA-NUMCLI1 > ZEROES OR
                 WSA-MAPA-CODCLI1 > ZEROES
                  MOVE WSA-MAPA-CODCLI1  TO I-OPCINGGFL-DBC-IND-ICLI
                  MOVE WSA-MAPA-NUMCLI1  TO I-OPCINGGFL-DBC-NUM-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-VRF-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-GLS-ICLI
              ELSE
              IF WSA-MAPA-NUMCLI2 > ZEROES OR
                 WSA-MAPA-CODCLI2 > ZEROES
                  MOVE WSA-MAPA-CODCLI2  TO I-OPCINGGFL-DBC-IND-ICLI
                  MOVE WSA-MAPA-NUMCLI2  TO I-OPCINGGFL-DBC-NUM-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-VRF-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-GLS-ICLI
              ELSE
              IF WSA-MAPA-NUMCLI3 > ZEROES OR
                 WSA-MAPA-CODCLI3 > ZEROES
                  MOVE WSA-MAPA-CODCLI3  TO I-OPCINGGFL-DBC-IND-ICLI
                  MOVE WSA-MAPA-NUMCLI3  TO I-OPCINGGFL-DBC-NUM-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-VRF-ICLI
                  MOVE SPACES            TO I-OPCINGGFL-DBC-GLS-ICLI.
       FIN-SET-CLI-OPC.
           EXIT.


       SET-CLI-RDC SECTION.
       INI-SET-CLI-RDC.
           IF WSS-TOT-CLI > 1
              IF WSA-MAPA-NUMCLI1 > ZEROES OR
                 WSA-MAPA-CODCLI1 > ZEROES
                    PERFORM RET-I-RDCINGGKY-1
                    MOVE I-RDCINGGKY TO WSS-MSG-SMJ
                    MOVE I-RDCINGGKY-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG

                    PERFORM RET-I-RDCINGGFL-1
                    MOVE I-RDCINGGFL TO WSS-MSG-SMJ
                    MOVE I-RDCINGGFL-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG.

           IF WSS-TOT-CLI > 1
              IF WSA-MAPA-NUMCLI2 > ZEROES OR
                 WSA-MAPA-CODCLI2 > ZEROES
                    PERFORM RET-I-RDCINGGKY-2
                    MOVE I-RDCINGGKY TO WSS-MSG-SMJ
                    MOVE I-RDCINGGKY-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG

                    PERFORM RET-I-RDCINGGFL-2
                    MOVE I-RDCINGGFL TO WSS-MSG-SMJ
                    MOVE I-RDCINGGFL-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG.

           IF WSS-TOT-CLI > 1
              IF WSA-MAPA-NUMCLI3 > ZEROES OR
                 WSA-MAPA-CODCLI3 > ZEROES
                    PERFORM RET-I-RDCINGGKY-3
                    MOVE I-RDCINGGKY TO WSS-MSG-SMJ
                    MOVE I-RDCINGGKY-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG

                    PERFORM RET-I-RDCINGGFL-3
                    MOVE I-RDCINGGFL TO WSS-MSG-SMJ
                    MOVE I-RDCINGGFL-LEN TO WSS-MSG-SMJ-LEN
                    PERFORM PUT-MSG-MSG.
       FIN-SET-CLI-RDC.
           EXIT.

       RET-I-RDCINGGKY-1 SECTION.
       INI-RET-I-RDCINGGKY-1.
           MOVE SPACES            TO I-RDCINGGKY-RDC-CAI-IOPC.
           MOVE SPACES            TO I-RDCINGGKY-RDC-NUM-IDLC.
           MOVE WSA-MAPA-NUMERO   TO I-RDCINGGKY-RDC-IIC-IOPC.
           MOVE WSA-MAPA-CODCLI1  TO I-RDCINGGKY-DBC-IND-ICLI.
           MOVE WSA-MAPA-NUMCLI1  TO I-RDCINGGKY-DBC-NUM-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-VRF-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-GLS-ICLI.
       FIN-RET-I-RDCINGGKY-1.
           EXIT.

       RET-I-RDCINGGKY-2 SECTION.
       INI-RET-I-RDCINGGKY-2.
           MOVE SPACES            TO I-RDCINGGKY-RDC-CAI-IOPC.
           MOVE SPACES            TO I-RDCINGGKY-RDC-NUM-IDLC.
           MOVE WSA-MAPA-NUMERO   TO I-RDCINGGKY-RDC-IIC-IOPC.
           MOVE WSA-MAPA-CODCLI2  TO I-RDCINGGKY-DBC-IND-ICLI.
           MOVE WSA-MAPA-NUMCLI2  TO I-RDCINGGKY-DBC-NUM-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-VRF-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-GLS-ICLI.
       FIN-RET-I-RDCINGGKY-2.
           EXIT.

       RET-I-RDCINGGKY-3 SECTION.
       INI-RET-I-RDCINGGKY-3.
           MOVE SPACES            TO I-RDCINGGKY-RDC-CAI-IOPC.
           MOVE SPACES            TO I-RDCINGGKY-RDC-NUM-IDLC.
           MOVE WSA-MAPA-NUMERO   TO I-RDCINGGKY-RDC-IIC-IOPC.
           MOVE WSA-MAPA-CODCLI3  TO I-RDCINGGKY-DBC-IND-ICLI.
           MOVE WSA-MAPA-NUMCLI3  TO I-RDCINGGKY-DBC-NUM-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-VRF-ICLI.
           MOVE SPACES            TO I-RDCINGGKY-DBC-GLS-ICLI.
       FIN-RET-I-RDCINGGKY-3.
           EXIT.

       RET-I-RDCINGGFL-1 SECTION.
       INI-RET-I-RDCINGGFL-1.
           MOVE WSA-MAPA-SEGVDA1  TO RDC-VAL-LIMD-E.
           MOVE RDC-VAL-LIMD-E TO I-RDCINGGFL-RDC-VAL-LIMD.
       FIN-RET-I-RDCINGGFL-1.
           EXIT.

       RET-I-RDCINGGFL-2 SECTION.
       INI-RET-I-RDCINGGFL-2.
           MOVE WSA-MAPA-SEGVDA2  TO RDC-VAL-LIMD-E.
           MOVE RDC-VAL-LIMD-E TO I-RDCINGGFL-RDC-VAL-LIMD.
       FIN-RET-I-RDCINGGFL-2.
           EXIT.

       RET-I-RDCINGGFL-3 SECTION.
       INI-RET-I-RDCINGGFL-3.
           MOVE WSA-MAPA-SEGVDA3  TO RDC-VAL-LIMD-E.
           MOVE RDC-VAL-LIMD-E TO I-RDCINGGFL-RDC-VAL-LIMD.
       FIN-RET-I-RDCINGGFL-3.
           EXIT.

       RET-I-OPCINGGFL SECTION.
       INI-RET-I-OPCINGGFL.
      * --- AEV -INI
      *    IF WSA-MAPA-SUCURSAL EQUAL ZEROES
      *      MOVE GT301-W1-ROFIOPE TO WSA-MAPA-SUCURSAL
      *    ELSE IF GT301-W1-ROFIOPE EQUAL WSA-MAPA-SUCURSAL
      *           NEXT SENTENCE
      *         ELSE IF GT301-W1-ROFIOPE NOT EQUAL 995
      *               MOVE 000 TO WSA-MAPA-SUCURSAL.
      * --- AEV -FIN
           MOVE WSA-MAPA-SUCURSAL TO I-OPCINGGFL-OPC-COD-OFOC.

           MOVE WSA-MAPA-MONTO    TO OPC-VAL-CRED-E.
           MOVE OPC-VAL-CRED-E    TO I-OPCINGGFL-OPC-VAL-CRED.

           MOVE CACL0010-TASA-DIGITADA TO ITR-SGV-TINT-E.
      *    MOVE WSA-MAPA-TASAINT  TO ITR-SGV-TINT-E.
           MOVE ITR-SGV-TINT-E    TO I-OPCINGGFL-ITR-SGV-TINT.

           MOVE WSA-MAPA-SITIVA   TO I-OPCINGGFL-OPC-COD-TTRN.
           MOVE WSA-MAPA-CODIDEST TO I-OPCINGGFL-OPC-COD-CDOC.
           MOVE WSA-MAPA-FECLIQ   TO I-OPCINGGFL-OPC-FEC-FCOL.
           MOVE SPACES            TO I-OPCINGGFL-OPC-FEC-FING.
      *    MOVE SPACES            TO I-OPCINGGFL-ITR-SGV-TINT.
           MOVE SPACES            TO I-OPCINGGFL-OPC-IND-GARA.
           MOVE WSA-MAPA-TASACION TO OPC-VAL-SEGP-E.
           MOVE OPC-VAL-SEGP-E    TO I-OPCINGGFL-OPC-VAL-SEGP.

           MOVE WSA-MAPA-IMPGAST  TO OPC-VAL-GAST-E.
           MOVE OPC-VAL-GAST-E    TO I-OPCINGGFL-OPC-VAL-GAST.

           MOVE WSA-MAPA-COMINMOBIL  TO OPC-SGV-VCOM-E.
           MOVE OPC-SGV-VCOM-E    TO I-OPCINGGFL-OPC-SGV-VCOM.

           MOVE WSA-MAPA-OFICIAL  TO I-OPCINGGFL-OPC-COD-RMOC.
           MOVE WSA-MAPA-CODCRED  TO I-OPCINGGFL-CYA-IND-TCYA.
           MOVE WSA-MAPA-CODISER  TO I-OPCINGGFL-CYA-CAI-ICYA.
           MOVE WSA-MAPA-OFIAPE   TO I-OPCINGGFL-CYA-CAI-OFOC.
           MOVE WSA-MAPA-NUMCTA   TO I-OPCINGGFL-CYA-IIC-ICYA.
           MOVE WSA-MAPA-DIGICTA  TO I-OPCINGGFL-CYA-IIC-DIGI.

      * AHORA LA CTA SE CORRIGE EN WSA-MAPA-.....
      *    MOVE ZEROES            TO WSS-CODISER.
      *    MOVE ZEROES            TO WSS-OFIAPE.
      *    MOVE ZEROES            TO WSS-NUMCTA.
      *    MOVE ZEROES            TO WSS-DIGICTA.
      *    MOVE WSS-CTA           TO WSS-CIC-ICYA.
      *    MOVE WSS-CAI-ICYA      TO I-OPCINGGFL-CYA-CAI-ICYA.
      *    MOVE WSS-IIC-ICYA      TO I-OPCINGGFL-CYA-IIC-ICYA.
      *    MOVE 'CAJA'            TO I-OPCINGGFL-AUT-IND-TCYA.
           MOVE SPACES            TO I-OPCINGGFL-AUT-IND-TCYA.
           MOVE SPACES            TO I-OPCINGGFL-AUT-CAI-ICYA.
           MOVE SPACES            TO I-OPCINGGFL-AUT-CAI-OFOC.
           MOVE SPACES            TO I-OPCINGGFL-AUT-IIC-ICYA.
           MOVE SPACES            TO I-OPCINGGFL-AUT-IIC-DIGI.
       FIN-RET-I-OPCINGGFL.
           EXIT.

       RET-I-DLCINGGKY SECTION.
       INI-RET-I-DLCINGGKY.
           MOVE SPACES           TO I-DLCINGGKY-DLC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-DLCINGGKY-DLC-IIC-IOPC.
           MOVE SPACES           TO I-DLCINGGKY-DLC-NUM-IDLC.
       FIN-RET-I-DLCINGGKY.
           EXIT.

       RET-I-DLCINGGFL SECTION.
       INI-RET-I-DLCINGGFL.
           MOVE WSA-MAPA-INMOBIL TO I-DLCINGGFL-DBC-NUM-ICLI.
           MOVE SPACES           TO I-DLCINGGFL-DBC-VRF-ICLI.
           MOVE WSA-MAPA-CODINMO TO I-DLCINGGFL-DBC-IND-ICLI.
           MOVE SPACES           TO I-DLCINGGFL-DBC-GLS-ICLI.
           MOVE SPACES           TO I-DLCINGGFL-DLC-IND-RIES.
           MOVE SPACES           TO I-DLCINGGFL-DLC-COD-UBFD.
           MOVE SPACES           TO I-DLCINGGFL-DLC-VAL-IMPU.
           MOVE SPACES           TO I-DLCINGGFL-DLC-COD-PLZA.
           MOVE SPACES           TO I-DLCINGGFL-DLC-COD-PLZO.
           MOVE SPACES           TO I-DLCINGGFL-DLC-MSC-MIPL.
           MOVE SPACES           TO I-DLCINGGFL-DLC-IND-SCTB.
           MOVE SPACES           TO I-DLCINGGFL-DLC-IND-SCBZ.
       FIN-RET-I-DLCINGGFL.
           EXIT.

       RET-I-EVCINGGKY SECTION.
       INI-RET-I-EVCINGGKY.
           MOVE SPACES           TO I-EVCINGGKY-EVC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-EVCINGGKY-EVC-IIC-IOPC.
           MOVE SPACES           TO I-EVCINGGKY-EVC-NUM-IEVC.
       FIN-RET-I-EVCINGGKY.
           EXIT.

       RET-I-EVCINGGFL SECTION.
       INI-RET-I-EVCINGGFL.
           MOVE WSA-MAPA-CANCUOTAS         TO I-EVCINGGFL-EVC-NUM-VIGU.
           MOVE WSA-MAPA-FEPRIVTO          TO I-EVCINGGFL-EVC-FEC-FPVC.
           MOVE SPACES                     TO I-EVCINGGFL-EVC-NUM-DPVE.
      * EL SGTE DATO ESTA FIJO , PERO OK
           MOVE '001'                      TO I-EVCINGGFL-EVC-NUM-IDLC.
           MOVE SPACES                     TO I-EVCINGGFL-EVC-NUM-SPVE.
           MOVE SPACES                     TO I-EVCINGGFL-FRM-IND-UTPV.
      *    MOVE 'CO'                       TO I-EVCINGGFL-EVC-MSC-TCVE.
           MOVE SPACES                     TO I-EVCINGGFL-EVC-VAL-VENC.
      * LOS SGTES DATOS ESTAN FIJOS, Y DEBEN DEJARSE VARIABLES
           MOVE '001'                      TO I-EVCINGGFL-EVC-NUM-SEVE.
           MOVE 'M'                        TO I-EVCINGGFL-EVC-IND-UTSV.
       FIN-RET-I-EVCINGGFL.
           EXIT.

       RET-I-OPCCONGKY SECTION.
       INI-RET-I-OPCCONGKY.
           MOVE SPACES           TO I-OPCCONGKY-OPC-CAI-IOPC.
           MOVE SPACES           TO I-OPCCONGKY-OPC-CAI-IOPC.
           IF I-OPCCONGKY-TDI-COD-NEMO = 'COLOPCCONKEY'
              MOVE WSA-MAPA-NUMERO  TO I-OPCCONGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCCONGKY.
           EXIT.

       RET-I-VENCONGKY SECTION.
       INI-RET-I-VENCONGKY.
           MOVE SPACES           TO I-VENCONGKY-VEN-CAI-IOPC.
           MOVE SPACES           TO I-VENCONGKY-VEN-IIC-IOPC.
           IF I-VENCONGKY-TDI-COD-NEMO = 'COLVENCONKEY'
              MOVE WSA-MAPA-NUMERO  TO I-VENCONGKY-VEN-IIC-IOPC.
       FIN-RET-I-VENCONGKY.
           EXIT.


       RET-I-OPCLIQGKY SECTION.
       INI-RET-I-OPCLIQGKY.
           MOVE SPACES           TO I-OPCLIQGKY-OPC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-OPCLIQGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCLIQGKY.
           EXIT.

       RET-I-DLCCONGKY SECTION.
       INI-RET-I-DLCCONGKY.
           MOVE SPACES           TO I-DLCCONGKY-DLC-CAI-IOPC.
           MOVE SPACES           TO I-DLCCONGKY-DLC-IIC-IOPC.
           IF I-DLCCONGKY-TDI-COD-NEMO = 'COLDLCCONKEY'
              MOVE WSA-MAPA-NUMERO  TO I-DLCCONGKY-DLC-IIC-IOPC.
       FIN-RET-I-DLCCONGKY.
           EXIT.

       RET-I-CDCCONGKY SECTION.
       INI-RET-I-CDCCONGKY.
           MOVE SPACES           TO I-CDCCONGKY-OPC-CAI-IOPC.
           MOVE SPACES           TO I-CDCCONGKY-OPC-IIC-IOPC.
           IF I-CDCCONGKY-TDI-COD-NEMO = 'COLCDCCONKEY'
              MOVE WSA-MAPA-NUMERO  TO I-CDCCONGKY-OPC-IIC-IOPC.
       FIN-RET-I-CDCCONGKY.
           EXIT.

       RET-I-OPCELIGKY SECTION.
       INI-RET-I-OPCELIGKY.
           MOVE SPACES           TO I-OPCELIGKY-OPC-CAI-IOPC.
           MOVE SPACES           TO I-OPCELIGKY-OPC-IIC-IOPC.
           IF I-OPCELIGKY-TDI-COD-NEMO = 'COLOPCELIKEY'
               MOVE WSA-MAPA-NUMERO  TO I-OPCELIGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCELIGKY.
           EXIT.

       RET-I-OPCLIQGCS SECTION.
       INI-RET-I-OPCLIQGCS.
       FIN-RET-I-OPCLIQGCS.
           EXIT.

      *LGM-BNL-04.03.1995-INI
       RET-E-OPCELIGKY SECTION.
       INI-RET-I-OPCELIGKY.
           MOVE SPACES           TO E-OPCELIGKY-OPC-CAI-IOPC.
           MOVE SPACES           TO E-OPCELIGKY-OPC-IIC-IOPC.
           IF E-OPCELIGKY-TDI-COD-NEMO = 'COLOPCELIKEY'
               MOVE WSA-MAPA-NUMERO  TO E-OPCELIGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCELIGKY.
           EXIT.

       RET-E-OPCELIGCS SECTION.
       INI-RET-E-OPCELIGCS.
       FIN-RET-E-OPCELIGCS.
           EXIT.
      *LGM-BNL-04.03.1995-FIN

       RET-I-OPCELIGCS SECTION.
       INI-RET-I-OPCELIGCS.
       FIN-RET-I-OPCELIGCS.
           EXIT.


       RET-I-OPCAPRGKY SECTION.
       INI-RET-I-OPCAPRGKY.
           MOVE SPACES           TO I-OPCAPRGKY-OPC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-OPCAPRGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCAPRGKY.
           EXIT.

       RET-I-OPCAPRGCS SECTION.
       INI-RET-I-OPCAPRGCS.
       FIN-RET-I-OPCAPRGCS.
           EXIT.

       RET-I-OPCACAGKY SECTION.
       INI-RET-I-OPCACAGKY.
           MOVE SPACES           TO I-OPCACAGKY-OPC-CAI-IOPC.
           MOVE WSA-MAPA-NUMERO  TO I-OPCACAGKY-OPC-IIC-IOPC.
       FIN-RET-I-OPCACAGKY.
           EXIT.

       RET-I-OPCACAGCS SECTION.
       INI-RET-I-OPCACAGCS.
       FIN-RET-I-OPCACAGCS.
           EXIT.

       FIJ-2001 SECTION.
       INI-FIJ-2001.
           MOVE '4' TO CGTL0010-MES-AID.
           PERFORM GNS-HDL-VSM.

           MOVE  ZEROES           TO WSA-MAPA-MONEDA.
           MOVE 'PPL'             TO WSA-MAPA-COD-OPE.
           MOVE 'TAV'             TO WSA-MAPA-COD-AUX.
           MOVE ZEROES            TO WSA-MAPA-NUMERO.
           MOVE 1                 TO WSA-MAPA-SUCURSAL.
           MOVE SPACES            TO WSA-MAPA-DESCOPE.
           MOVE SPACES            TO WSA-MAPA-DESCSUC.
           PERFORM GNS-HDL-VSM.
           MOVE 10000             TO WSA-MAPA-MONTO.
           MOVE ZEROES            TO WSA-MAPA-FECLIQ-DD.
           MOVE ZEROES            TO WSA-MAPA-FECLIQ-MM.
           MOVE ZEROES            TO WSA-MAPA-FECLIQ-AAAA.
           PERFORM GNS-HDL-VSM.
           MOVE 4                 TO WSA-MAPA-CANCUOTAS.
           MOVE 9                 TO WSA-MAPA-FEPRIVTO-DD.
           MOVE 1                 TO WSA-MAPA-FEPRIVTO-MM.
           MOVE 1995              TO WSA-MAPA-FEPRIVTO-AAAA.
           MOVE 4                 TO WSA-MAPA-TASAINT.
           MOVE 'I'               TO WSA-MAPA-SITIVA.
           MOVE SPACES            TO WSA-MAPA-DESCSIT.
           MOVE 'I80'             TO WSA-MAPA-CODIDEST.
           MOVE SPACES            TO WSA-MAPA-DESCDEST.
           MOVE ZEROES            TO WSA-MAPA-IMPGAST.
           MOVE ZEROES            TO WSA-MAPA-MONLIQ.
           MOVE ZEROES            TO WSA-MAPA-IMPIVA.
           MOVE ZEROES            TO WSA-MAPA-1ERCUO.
           MOVE ZEROES            TO WSA-MAPA-IMPSEL.
           MOVE SPACES            TO WSA-MAPA-CODIDEST.
           MOVE SPACES            TO WSA-MAPA-DESCDEST.
           MOVE '3402'            TO WSA-MAPA-OFICIAL.
           MOVE 'CAJA'            TO WSA-MAPA-CODCRED.
           MOVE SPACES            TO WSA-MAPA-DESCOFI.
           MOVE ZEROES            TO WSA-MAPA-CODISER.
           MOVE ZEROES            TO WSA-MAPA-OFIAPE.
           MOVE ZEROES            TO WSA-MAPA-NUMCTA.
           MOVE ZEROES            TO WSA-MAPA-DIGICTA.
           MOVE 1                 TO WSA-MAPA-CODCLI1.
           MOVE 17068195          TO WSA-MAPA-NUMCLI1.
           MOVE ZEROES            TO WSA-MAPA-SEGVDA1.
           MOVE SPACES            TO WSA-MAPA-DESCCLI1.
           MOVE 1                 TO WSA-MAPA-CODCLI2.
           MOVE 1                 TO WSA-MAPA-NUMCLI2.
           MOVE ZEROES            TO WSA-MAPA-CODCLI2.
           MOVE ZEROES            TO WSA-MAPA-NUMCLI2.
           MOVE ZEROES            TO WSA-MAPA-SEGVDA2.
           MOVE SPACES            TO WSA-MAPA-DESCCLI2.
           MOVE ZEROES            TO WSA-MAPA-CODCLI3.
           MOVE ZEROES            TO WSA-MAPA-NUMCLI3.
           MOVE ZEROES            TO WSA-MAPA-SEGVDA3.
           MOVE SPACES            TO WSA-MAPA-DESCCLI3.
           MOVE ZEROES            TO WSA-MAPA-FECLIQ.
           MOVE ZEROES            TO WSA-MAPA-FECULMOD.
       FIN-FIJ-2001.
           EXIT.

       REV-SIMU SECTION.
       INI-REV-SIMU.
           IF CGTL0010-MES-AID NOT = WSS-TDF-SIM-1
               GO TO FIN-REV-SIMU.

           MOVE SPACES TO O-CDCCONGKY-FRM-GLS-STAT.
           MOVE SPACES TO WSA-MAPA-ESTADO.

           IF WSS-CLI-SIMU = 'S'
               MOVE ZEROES TO WSA-MAPA-CODCLI1
               MOVE ZEROES TO WSA-MAPA-NUMCLI1
               MOVE SPACES TO WSA-MAPA-DESCCLI1
               MOVE ZEROES TO WSA-MAPA-SEGVDA1

               MOVE SPACES TO O-CDCCONGKY-FRM-IND-ICLI1
               MOVE SPACES TO O-CDCCONGKY-FRM-NUM-ICLI1
               MOVE SPACES TO O-CDCCONGKY-FRM-GLS-NOMC1
               MOVE SPACES TO O-CDCCONGKY-FRM-VAL-LIMD1.

           IF WSS-AVL-SIMU = 'S'
               MOVE ZEROES TO WSA-MAPA-CODINMO
               MOVE ZEROES TO WSA-MAPA-INMOBIL
               MOVE SPACES TO O-DLCCONGKY-DBC-IND-ICLI
               MOVE SPACES TO O-DLCCONGKY-DBC-NUM-ICLI
               MOVE SPACES TO O-DLCCONGKY-DBC-GLS-NOMC
               MOVE SPACES TO WSA-MAPA-DESCINMO.

           IF WSS-EJC-SIMU = 'S'
               MOVE SPACES TO O-OPCCONGKY-OPC-COD-RMOC
               MOVE SPACES TO WSA-MAPA-OFICIAL
               MOVE SPACES TO O-OPCCONGKY-FRM-GLS-RMOC
               MOVE SPACES TO WSA-MAPA-DESCOFI.

           IF WSS-CAJ-SIMU = 'S'
               MOVE SPACES TO O-OPCCONGKY-CYA-IND-TCYA
               MOVE SPACES TO WSA-MAPA-CODCRED.

       FIN-REV-SIMU.
           EXIT.

       PUT-O-OPCCONGKY SECTION.
       INI-PUT-O-OPCCONGKY.
      *    IF TDO-NUM-TREP IN TDO > ZEROES
      *       MOVE TDO-GLS-DESC IN TDO TO WSS-GLS-DESC
      *       MOVE MENSA-DESC          TO CGTL0010-ERROR-CODE
      *       MOVE SPACES              TO O-OPCCONGKY.



           IF CGTL0010-MES-AID = WSS-TDF-CON-1 OR
                                 WSS-TDF-MOD-1 OR
                                 WSS-TDF-ELI-1 OR
                                 CGTI0010-F2
                PERFORM PUT-FLDS.

           IF CGTL0010-MES-AID NOT = WSS-TDF-MOD-1
               MOVE O-OPCCONGKY-OPC-IIC-IOPC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-S TO NUM-SGNO
               MOVE 8  TO NUM-NENT
               MOVE 0 TO NUM-NDCM
               PERFORM GNS-CRT-VNUM
               IF NUM-STAT-OKS
                   MOVE NUM-NN9V TO WSA-MAPA-NUMERO.

           IF CGTL0010-MES-AID = WSS-TDF-SIM-1 OR
                                 WSS-TDF-ALT-1
               MOVE ZEROES   TO WSA-MAPA-NUMERO.

           MOVE O-OPCCONGKY-OPC-COD-CDOC TO WSA-MAPA-CODIDEST.
      *    MOVE O-OPCCONGKY-FRM-GLS-VCOC TO WSA-MAPA-DESCMON.
           MOVE O-OPCCONGKY-FRM-GLS-TOOC TO CPT-STR1.
           MOVE O-OPCCONGKY-FRM-GLS-AOOC TO CPT-STR2.
           PERFORM CPT-BLKS.
      *    MOVE CPT-STRN TO WSA-MAPA-DESCOPE.
      *    MOVE O-OPCCONGKY-DBC-GLS-NOMC TO WSA-MAPA-DESCCLI1.
      *    MOVE O-OPCCONGKY-FRM-GLS-OFOC TO WSA-MAPA-DESCSUC.
           MOVE O-OPCCONGKY-FRM-GLS-RMOC TO WSA-MAPA-DESCOFI.

           MOVE O-CDCCONGKY-FRM-GLS-CDOC TO WSA-MAPA-DESCDEST.
           MOVE O-CDCCONGKY-FRM-GLS-TTRN TO WSA-MAPA-DESCSIT.
           MOVE O-CDCCONGKY-FRM-GLS-STAT TO WSA-MAPA-ESTADO.

           MOVE O-OPCCONGKY-OPC-SGV-LIQU TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-MONLIQ.

           MOVE O-OPCCONGKY-OPC-COD-RMOC TO WSA-MAPA-OFICIAL.

           MOVE O-OPCCONGKY-OPC-FEC-FCOL TO WSA-MAPA-FECLIQ.

           MOVE O-OPCCONGKY-IVA-VAL-CRED TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-IMPIVA.

           MOVE O-VENCONGKY-FRM-VAL-TINT TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-TASAINT.

123456* ----------------
           IF WSA-MAPA-TASAINT EQUAL ZEROES
               MOVE O-OPCCONGKY-ITR-SGV-TINT TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-S TO NUM-SGNO
               MOVE 04 TO NUM-NENT
               MOVE 3 TO NUM-NDCM
               PERFORM GNS-CRT-VNUM
               IF NUM-STAT-OKS
                  MOVE NUM-NN9V TO WSA-MAPA-TASAINT.
123456* ----------------
           MOVE O-OPCCONGKY-OPC-VAL-SEGP TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-TASACION.

           MOVE O-VENCONGKY-VEN-VAL-SFIN TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-1ERCUO.

           MOVE O-DLCCONGKY-DBC-GLS-NOMC TO WSA-MAPA-DESCINMO.

           MOVE O-DLCCONGKY-DLC-VAL-IMPU TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-IMPSEL.

           MOVE O-CDCCONGKY-FRM-IND-ICLI1  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 2  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-CODCLI1.

           MOVE O-CDCCONGKY-FRM-NUM-ICLI1  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-NUMCLI1.

           MOVE O-CDCCONGKY-FRM-GLS-NOMC1 TO WSA-MAPA-DESCCLI1.

           MOVE O-CDCCONGKY-FRM-VAL-LIMD1 TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3  TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-SEGVDA1.

           MOVE O-CDCCONGKY-FRM-IND-ICLI2  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 2  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-CODCLI2.

           MOVE O-CDCCONGKY-FRM-NUM-ICLI2  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-NUMCLI2.

           MOVE O-CDCCONGKY-FRM-GLS-NOMC2 TO WSA-MAPA-DESCCLI2.

           MOVE O-CDCCONGKY-FRM-VAL-LIMD2 TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3  TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-SEGVDA2.

           MOVE O-CDCCONGKY-FRM-IND-ICLI3  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 2  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-CODCLI3.

           MOVE O-CDCCONGKY-FRM-NUM-ICLI3  TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-NUMCLI3.

           MOVE O-CDCCONGKY-FRM-GLS-NOMC3 TO WSA-MAPA-DESCCLI3.

           MOVE O-CDCCONGKY-FRM-VAL-LIMD3 TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3  TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-SEGVDA3.


      *    IF CGTL0010-TRANID-CCT = 'AC12'
      *       MOVE CACW2011-AREA TO WSA-MAPA-AREA.

       FIN-PUT-O-OPCCONGKY.
           EXIT.

       PUT-FLDS SECTION.
       INI-PUT-FLDS.
      * PONE LOS SIGUIENTES CAMPOS SOLO CUANDO NO LOS PUSO EL USUARIO;
      * ES DECIR CUANDO LOS PIDE DIGITANDO UN NUMERO DE OPERACION

           IF   O-OPCCONGKY-OPC-COD-VCOC = '0000'
                  MOVE ZEROES TO WSA-MAPA-MONEDA
           ELSE
           IF   O-OPCCONGKY-OPC-COD-VCOC = '100200'
                  MOVE 2      TO WSA-MAPA-MONEDA
           ELSE
                  MOVE ZEROES TO WSA-MAPA-MONEDA.

           MOVE O-OPCCONGKY-OPC-COD-TOOC TO WSA-MAPA-COD-OPE.
           MOVE O-OPCCONGKY-OPC-COD-AOOC TO WSA-MAPA-COD-AUX.

           MOVE O-OPCCONGKY-OPC-VAL-CRED TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-MONTO.

           MOVE O-OPCCONGKY-OPC-COD-OFOC TO WSA-MAPA-SUCURSAL.

           MOVE O-OPCCONGKY-OPC-NUM-VCVG TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 4  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-CANCUOTAS.

           MOVE O-OPCCONGKY-OPC-VAL-GAST TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-IMPGAST.

           MOVE O-OPCCONGKY-OPC-SGV-VCOM TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 3 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-COMINMOBIL.


           MOVE O-OPCCONGKY-CYA-IND-TCYA TO  WSA-MAPA-CODCRED.
           MOVE O-OPCCONGKY-CYA-CAI-ICYA TO  WSA-MAPA-CODISER.
           MOVE O-OPCCONGKY-CYA-CAI-OFOC TO  WSA-MAPA-OFIAPE.
           MOVE O-OPCCONGKY-CYA-IIC-ICYA TO  WSA-MAPA-NUMCTA.
           MOVE O-OPCCONGKY-CYA-IIC-DIGI TO  WSA-MAPA-DIGICTA.

           MOVE O-OPCCONGKY-OPC-COD-TTRN TO WSA-MAPA-SITIVA.

           MOVE O-DLCCONGKY-DBC-IND-ICLI TO WSA-MAPA-CODINMO.
           MOVE O-DLCCONGKY-DBC-NUM-ICLI TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-INMOBIL.

           MOVE O-VENCONGKY-VEN-FEC-FVEN TO WSA-MAPA-FEPRIVTO.

       FIN-PUT-FLDS.
           EXIT.

      ******************************************************************
      *  TRANSFIERE DESDE MAPA COMUN A MAPAS ESPECIFICOS               *
      ******************************************************************

       MOV-WSA-2001 SECTION.
       INI-MOV-WSA-2001.
           MOVE WSA-MAPA-MENSAJE   TO CACW2001-MENSAJE.
           MOVE WSA-MAPA-DESCOPE   TO CACW2001-DESCOPE.
           MOVE WSA-MAPA-DESCSUC   TO CACW2001-DESCSUC.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
               PERFORM UBICAR-ERROR-2001
               GO TO FIN-MOV-WSA-2001.

           IF CON-ING-DATOS NOT EQUAL CGTL0010-AVISO-CODE-1
             IF NOT WSA-MAPA-CODOPE-ES-PPL
              MOVE 'NO CORRESPONDE A BNL PRONTO'  TO CACW2001-MENSAJE
              MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.

           MOVE WSA-MAPA-SUCURSAL  TO CACW2001-SUCURSAL.
           MOVE WSA-MAPA-MONEDA    TO CACW2001-MONEDA.
           MOVE WSA-MAPA-OPERACION TO CACW2001-OPERACION
           MOVE WSA-MAPA-NUMERO    TO CACW2001-NUMERO.
           MOVE WSA-MAPA-MONTO     TO CACW2001-MONTO.
           MOVE WSA-MAPA-FECLIQ    TO CACW2001-FECLIQ.
           MOVE WSA-MAPA-SITIVA    TO CACW2001-SITIVA.
           MOVE WSA-MAPA-DESCSIT   TO CACW2001-DESCSIT.
           MOVE WSA-MAPA-CANCUOTAS TO CACW2001-CANCUOTAS
           MOVE WSA-MAPA-CODIDEST  TO CACW2001-CODIDEST.
           MOVE WSA-MAPA-DESCDEST  TO CACW2001-DESCDEST.
           MOVE WSA-MAPA-FEPRIVTO  TO CACW2001-FEPRIVTO
           MOVE WSA-MAPA-IMPGAST   TO CACW2001-IMPGAST.
           MOVE WSA-MAPA-MONLIQ    TO CACW2001-MONLIQ.
           MOVE WSA-MAPA-IMPIVA    TO CACW2001-IMPIVA.
           MOVE WSA-MAPA-1ERCUO    TO CACW2001-1ERCUO.
           MOVE WSA-MAPA-IMPSEL    TO CACW2001-IMPSEL.
           MOVE WSA-MAPA-ESTADO    TO CACW2001-ESTADO.
           MOVE WSA-MAPA-OFICIAL   TO CACW2001-OFICIAL.
           MOVE WSA-MAPA-DESCOFI   TO CACW2001-DESCOFI.
           MOVE WSA-MAPA-TASAINT   TO CACW2001-TASAINT.
           MOVE WSA-MAPA-CODCRED   TO CACW2001-CODCRED.
           MOVE WSA-MAPA-CODISER   TO CACW2001-CODISER.
           MOVE WSA-MAPA-OFIAPE    TO CACW2001-OFIAPE.
           MOVE WSA-MAPA-NUMCTA    TO CACW2001-NUMCTA.
           MOVE WSA-MAPA-DIGICTA   TO CACW2001-DIGICTA.
           MOVE WSA-MAPA-CODCLI1   TO CACW2001-CODCLI1.
           MOVE WSA-MAPA-NUMCLI1   TO CACW2001-NUMCLI1.
           MOVE WSA-MAPA-SEGVDA1   TO CACW2001-SEGVDA1.
           MOVE WSA-MAPA-DESCCLI1  TO CACW2001-DESCCLI1.
           MOVE WSA-MAPA-CODCLI2   TO CACW2001-CODCLI2.
           MOVE WSA-MAPA-NUMCLI2   TO CACW2001-NUMCLI2.
           MOVE WSA-MAPA-SEGVDA2   TO CACW2001-SEGVDA2.
           MOVE WSA-MAPA-DESCCLI2  TO CACW2001-DESCCLI2.
           MOVE WSA-MAPA-CODCLI3   TO CACW2001-CODCLI3.
           MOVE WSA-MAPA-NUMCLI3   TO CACW2001-NUMCLI3.
           MOVE WSA-MAPA-SEGVDA3   TO CACW2001-SEGVDA3.
           MOVE WSA-MAPA-DESCCLI3  TO CACW2001-DESCCLI3.
      *    MOVE WSA-MAPA-FECALTA   TO CACW2001-FECALTA.
      *    MOVE WSA-MAPA-FECULMOD  TO CACW2001-FECULMOD.
      *    MOVE WSA-MAPA-TERULMOD  TO CACW2001-TERULMOD.
      *    MOVE WSA-MAPA-HORULMOD  TO CACW2001-HORULMOD.
       FIN-MOV-WSA-2001.
           EXIT.

       CONTROL-2001-PRONTO SECTION.
           IF CGTL0010-ERROR-CODE EQUAL SPACES
             IF WSA-MAPA-CODAUX-ES-SAL
               MOVE 'NO CORRESPONDE A BNL PRONTO'  TO CACW2001-MENSAJE
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

       CONTROL-2001-SALIDA SECTION.
           IF CGTL0010-ERROR-CODE EQUAL SPACES
             IF NOT WSA-MAPA-CODAUX-ES-SAL
               MOVE 'NO CORRESPONDE A BNL SALIDA'  TO CACW2001-MENSAJE
               MOVE CON-VERIF-DATOS TO CGTL0010-ERROR-CODE.
       FIN.
           EXIT.

       MOV-WSA-2011 SECTION.
       INI-MOV-WSA-2011.
      *    MOVE TDO-GLS-MENS        TO CACW2011-MENSAJE.
           MOVE WSA-MAPA-MENSAJE    TO CACW2011-MENSAJE.
           MOVE WSA-MAPA-DESCOPE    TO CACW2011-DESCOPE.
           MOVE WSA-MAPA-DESCSUC    TO CACW2011-DESCSUC.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
               PERFORM UBICAR-ERROR-2011
               GO TO FIN-MOV-WSA-2011.

           IF NOT WSA-MAPA-CODOPE-ES-HIP AND
              CON-ING-DATOS NOT EQUAL CGTL0010-AVISO-CODE-1
              MOVE 'NO CORRESPONDE A BNL CASA  '  TO CACW2011-MENSAJE.
           COMPUTE
                WSA-MAPA-IMPSEG =
                WSA-MAPA-MONTO -
              ( WSA-MAPA-MONLIQ     +
                WSA-MAPA-IMPGAST    +
                WSA-MAPA-IMPIVA ).
           MOVE WSA-MAPA-SUCURSAL   TO CACW2011-SUCURSAL.
           MOVE WSA-MAPA-MONEDA     TO CACW2011-MONEDA.
           MOVE WSA-MAPA-OPERACION  TO CACW2011-OPERACION
           MOVE WSA-MAPA-NUMERO     TO CACW2011-NUMERO.
           MOVE WSA-MAPA-MONTO      TO CACW2011-MONTO.
           MOVE WSA-MAPA-FECLIQ     TO CACW2011-FECLIQ.
           MOVE WSA-MAPA-SITIVA     TO CACW2011-SITIVA.
           MOVE WSA-MAPA-DESCSIT    TO CACW2011-DESCSIT.
           MOVE WSA-MAPA-CANCUOTAS  TO CACW2011-CANCUOTAS
           MOVE WSA-MAPA-TASACION   TO CACW2011-TASACION.
           MOVE WSA-MAPA-CODIDEST   TO CACW2011-CODIDEST.
           MOVE WSA-MAPA-DESCDEST   TO CACW2011-DESCDEST.
           MOVE WSA-MAPA-FEPRIVTO   TO CACW2011-FEPRIVTO
           MOVE WSA-MAPA-IMPGAST    TO CACW2011-IMPGAST.
           MOVE WSA-MAPA-MONLIQ     TO CACW2011-MONLIQ.
           MOVE WSA-MAPA-IMPIVA     TO CACW2011-IMPIVA.
           MOVE WSA-MAPA-1ERCUO     TO CACW2011-1ERCUO.
           MOVE WSA-MAPA-IMPSEG     TO CACW2011-IMPSEG.
           MOVE WSA-MAPA-ESTADO     TO CACW2011-ESTADO.
           MOVE WSA-MAPA-OFICIAL    TO CACW2011-OFICIAL
           MOVE WSA-MAPA-DESCOFI    TO CACW2011-DESCOFI.
           MOVE WSA-MAPA-TASAINT    TO CACW2011-TASAINT.
           MOVE WSA-MAPA-CODCRED    TO CACW2011-CODCRED.
           MOVE WSA-MAPA-CODISER    TO CACW2011-CODISER.
           MOVE WSA-MAPA-OFIAPE     TO CACW2011-OFIAPE.
           MOVE WSA-MAPA-NUMCTA     TO CACW2011-NUMCTA.
           MOVE WSA-MAPA-DIGICTA    TO CACW2011-DIGICTA.
           MOVE WSA-MAPA-CODCLI1    TO CACW2011-CODCLI1.
           MOVE WSA-MAPA-NUMCLI1    TO CACW2011-NUMCLI1.
           MOVE WSA-MAPA-SEGVDA1    TO CACW2011-SEGVDA1.
           MOVE WSA-MAPA-DESCCLI1   TO CACW2011-DESCCLI1.
           MOVE WSA-MAPA-CODCLI2    TO CACW2011-CODCLI2.
           MOVE WSA-MAPA-NUMCLI2    TO CACW2011-NUMCLI2.
           MOVE WSA-MAPA-SEGVDA2    TO CACW2011-SEGVDA2.
           MOVE WSA-MAPA-DESCCLI2   TO CACW2011-DESCCLI2.
           MOVE WSA-MAPA-CODCLI3    TO CACW2011-CODCLI3.
           MOVE WSA-MAPA-NUMCLI3    TO CACW2011-NUMCLI3
           MOVE WSA-MAPA-SEGVDA3    TO CACW2011-SEGVDA3.
           MOVE WSA-MAPA-DESCCLI3   TO CACW2011-DESCCLI3.
           MOVE WSA-MAPA-CODINMO    TO CACW2011-CODINMO.
           MOVE WSA-MAPA-INMOBIL    TO CACW2011-INMOBIL.
           MOVE WSA-MAPA-COMINMOBIL TO CACW2011-COMINMOBIL.
           MOVE WSA-MAPA-DESCINMO   TO CACW2011-DESCINMO.
      *    MOVE WSA-MAPA-FECALTA    TO CACW2011-FECALTA.
      *    MOVE WSA-MAPA-FECULMOD   TO CACW2011-FECULMOD.
      *    MOVE WSA-MAPA-TERULMOD   TO CACW2011-TERULMOD.
      *    MOVE WSA-MAPA-HORULMOD   TO CACW2011-HORULMOD.
      *
       FIN-MOV-WSA-2011.
           EXIT.

       MOV-WSA-2021 SECTION.
       INI-MOV-WSA-2021.
      *    MOVE TDO-GLS-MENS        TO CACW2021-MENSAJE.
           MOVE WSA-MAPA-MENSAJE    TO CACW2021-MENSAJE.
           MOVE WSA-MAPA-DESCOPE    TO CACW2021-DESCOPE.
           MOVE WSA-MAPA-DESCSUC    TO CACW2021-DESCSUC.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
               PERFORM UBICAR-ERROR-2021
               GO TO FIN-MOV-WSA-2021.
           IF NOT WSA-MAPA-CODOPE-ES-PRD AND
              CON-ING-DATOS NOT EQUAL CGTL0010-AVISO-CODE-1
              MOVE 'NO CORRESPONDE A BNL AUTO  '  TO CACW2021-MENSAJE.
           MOVE WSA-MAPA-SUCURSAL   TO CACW2021-SUCURSAL
           MOVE WSA-MAPA-MONEDA     TO CACW2021-MONEDA.
           MOVE WSA-MAPA-OPERACION  TO CACW2021-OPERACION.
           MOVE WSA-MAPA-NUMERO     TO CACW2021-NUMERO.
           MOVE WSA-MAPA-MONTO      TO CACW2021-MONTO.
           MOVE WSA-MAPA-FECLIQ     TO CACW2021-FECLIQ.
           MOVE WSA-MAPA-SITIVA     TO CACW2021-SITIVA.
           MOVE WSA-MAPA-DESCSIT    TO CACW2021-DESCSIT.
           MOVE WSA-MAPA-CANCUOTAS  TO CACW2021-CANCUOTAS
           MOVE WSA-MAPA-VALSEGUR   TO CACW2021-VALSEGUR.
           MOVE WSA-MAPA-CODIDEST   TO CACW2021-CODIDEST.
           MOVE WSA-MAPA-DESCDEST   TO CACW2021-DESCDEST.
           MOVE WSA-MAPA-FEPRIVTO   TO CACW2021-FEPRIVTO
           MOVE WSA-MAPA-IMPGAST    TO CACW2021-IMPGAST.
           MOVE WSA-MAPA-MONLIQ     TO CACW2021-MONLIQ.
           MOVE WSA-MAPA-IMPIVA     TO CACW2021-IMPIVA.
           MOVE WSA-MAPA-1ERCUO     TO CACW2021-1ERCUO.
           MOVE WSA-MAPA-ESTADO     TO CACW2021-ESTADO.
           MOVE WSA-MAPA-OFICIAL    TO CACW2021-OFICIAL
           MOVE WSA-MAPA-DESCOFI    TO CACW2021-DESCOFI.
           MOVE WSA-MAPA-TASAINT    TO CACW2021-TASAINT.
           MOVE WSA-MAPA-CODCRED    TO CACW2021-CODCRED.
           MOVE WSA-MAPA-CODISER    TO CACW2021-CODISER.
           MOVE WSA-MAPA-OFIAPE     TO CACW2021-OFIAPE.
           MOVE WSA-MAPA-NUMCTA     TO CACW2021-NUMCTA.
           MOVE WSA-MAPA-DIGICTA    TO CACW2021-DIGICTA.
           MOVE WSA-MAPA-CODCLI1    TO CACW2021-CODCLI1.
           MOVE WSA-MAPA-NUMCLI1    TO CACW2021-NUMCLI1.
           MOVE WSA-MAPA-SEGVDA1    TO CACW2021-SEGVDA1.
           MOVE WSA-MAPA-DESCCLI1   TO CACW2021-DESCCLI1.
           MOVE WSA-MAPA-CODCLI2    TO CACW2021-CODCLI2.
           MOVE WSA-MAPA-NUMCLI2    TO CACW2021-NUMCLI2.
           MOVE WSA-MAPA-SEGVDA2    TO CACW2021-SEGVDA2.
           MOVE WSA-MAPA-DESCCLI2   TO CACW2021-DESCCLI2.
           MOVE WSA-MAPA-CODCLI3    TO CACW2021-CODCLI3.
           MOVE WSA-MAPA-NUMCLI3    TO CACW2021-NUMCLI3.
           MOVE WSA-MAPA-SEGVDA3    TO CACW2021-SEGVDA3.
           MOVE WSA-MAPA-DESCCLI3   TO CACW2021-DESCCLI3.
           MOVE WSA-MAPA-CODINMO    TO CACW2021-CODICON.
           MOVE WSA-MAPA-INMOBIL    TO CACW2021-CONCESION
           MOVE WSA-MAPA-COMINMOBIL TO CACW2021-COMICONCE.
           MOVE WSA-MAPA-DESCINMO   TO CACW2021-DESCONCE.
      *    MOVE WSA-MAPA-FECALTA    TO CACW2021-FECALTA.
      *    MOVE WSA-MAPA-FECULMOD   TO CACW2021-FECULMOD.
      *    MOVE WSA-MAPA-TERULMOD   TO CACW2021-TERULMOD.
      *    MOVE WSA-MAPA-HORULMOD   TO CACW2021-HORULMOD.
       FIN-MOV-WSA-2021.
           EXIT.

       MOV-WSA-1601 SECTION.
       INI-MOV-WSA-1601.
      *    MOVE TDO-GLS-MENS        TO CACW1601-MENSAJE.
           MOVE WSA-MAPA-MENSAJE    TO CACW1601-MENSAJE.
           MOVE WSA-MAPA-DESCOPE    TO CACW1601-DESCOPE.
           MOVE WSA-MAPA-SUCURSAL   TO CACW1601-SUCURSAL.
           MOVE WSA-MAPA-DESCSUC    TO CACW1601-DESCSUC.

           IF CGTL0010-ERROR-CODE NOT EQUAL SPACES
               GO TO FIN-MOV-WSA-1601.
           COMPUTE
                WSA-MAPA-IMPSEG =
                WSA-MAPA-MONTO -
              ( WSA-MAPA-MONLIQ     +
                WSA-MAPA-IMPGAST    +
                WSA-MAPA-IMPIVA ).
           MOVE WSA-MAPA-MONEDA     TO CACW1601-MONEDA.
           MOVE WSA-MAPA-OPERACION  TO CACW1601-OPERACION
           MOVE WSA-MAPA-NUMERO     TO CACW1601-NUMERO.
           MOVE WSA-MAPA-MONTO      TO CACW1601-MONTO.
           MOVE WSA-MAPA-FECLIQ     TO CACW1601-FECLIQ.
      *    MOVE WSA-MAPA-SITIVA     TO CACW1601-SITIVA.
           MOVE WSA-MAPA-DESCSIT    TO CACW1601-DESCSIT.
           MOVE WSA-MAPA-CANCUOTAS  TO CACW1601-CANCUOTAS
      *    MOVE WSA-MAPA-CODIDEST   TO CACW1601-CODIDEST.
           MOVE WSA-MAPA-DESCDEST   TO CACW1601-DESCDEST.
           MOVE WSA-MAPA-FEPRIVTO   TO CACW1601-FEPRIVTO
           MOVE WSA-MAPA-IMPGAST    TO CACW1601-IMPGAST.
           MOVE WSA-MAPA-MONLIQ     TO CACW1601-MONLIQ.
           MOVE WSA-MAPA-IMPIVA     TO CACW1601-IMPIVA.
           MOVE WSA-MAPA-1ERCUO     TO CACW1601-1ERCUO.
           MOVE  SPACES             TO CACW1601-VARIABLE1.
           MOVE  SPACES             TO CACW1601-VARIABLE2.
           MOVE  SPACES             TO CACW1601-VARIABLE3.
           IF CACW1601-COD-OPE  EQUAL 'PPL'
             MOVE 'IMPUESTO DE SELLOS:' TO CACW1601-VAR2-LITERAL
             MOVE  WSA-MAPA-IMPSEL      TO CACW1601-VAR2-IMPORTE
           ELSE
             IF CACW1601-COD-OPE  EQUAL 'HIP'
               MOVE 'TASACION INMUEBLE: ' TO CACW1601-VAR1-LITERAL
               MOVE  WSA-MAPA-TASACION    TO CACW1601-VAR1-IMPORTE
               MOVE 'SEGURO DE INCENDIO ' TO CACW1601-VAR2-LITERAL
               MOVE  WSA-MAPA-IMPSEG      TO CACW1601-VAR2-IMPORTE
               MOVE 'INMOBIL.:'           TO CACW1601-VAR3-LITERAL
               MOVE WSA-MAPA-CODINMO      TO CACW1601-VAR3-CODCLI
               MOVE '-'                   TO CACW1601-VAR3-FILLER
               MOVE WSA-MAPA-INMOBIL      TO CACW1601-VAR3-NUMCLI
               MOVE ' COMISION:'          TO CACW1601-VAR3-COMIS
               MOVE WSA-MAPA-COMINMOBIL   TO CACW1601-VAR3-IMPCOM
               MOVE WSA-MAPA-DESCINMO     TO CACW1601-VAR3-DESCRIP
             ELSE
               IF CACW1601-COD-OPE  EQUAL 'PRD'
                 MOVE 'VALOR DEL SEGURO : ' TO CACW1601-VAR1-LITERAL
                 MOVE  WSA-MAPA-VALSEGUR    TO CACW1601-VAR1-IMPORTE
                 MOVE 'CONCESION.:'         TO CACW1601-VAR3-LITERAL
                 MOVE WSA-MAPA-CODINMO      TO CACW1601-VAR3-CODCLI
                 MOVE '-'                   TO CACW1601-VAR3-FILLER
                 MOVE WSA-MAPA-INMOBIL      TO CACW1601-VAR3-NUMCLI
                 MOVE ' COMISION:'          TO CACW1601-VAR3-COMIS
                 MOVE WSA-MAPA-COMINMOBIL   TO CACW1601-VAR3-IMPCOM
                 MOVE WSA-MAPA-DESCINMO     TO CACW1601-VAR3-DESCRIP.
           MOVE WSA-MAPA-ESTADO     TO CACW1601-ESTADO.
           MOVE WSA-MAPA-OFICIAL    TO CACW1601-OFICIAL
           MOVE WSA-MAPA-DESCOFI    TO CACW1601-DESCOFI.
           MOVE WSA-MAPA-TASAINT    TO CACW1601-TASAINT.
           MOVE WSA-MAPA-CODCRED    TO CACW1601-CODCRED.
           MOVE WSA-MAPA-CODISER    TO CACW1601-CODISER.
           MOVE WSA-MAPA-OFIAPE     TO CACW1601-OFIAPE.
           MOVE WSA-MAPA-NUMCTA     TO CACW1601-NUMCTA.
           MOVE WSA-MAPA-DIGICTA    TO CACW1601-DIGICTA.
           MOVE WSA-MAPA-CODCLI1    TO CACW1601-CODCLI1.
           MOVE WSA-MAPA-NUMCLI1    TO CACW1601-NUMCLI1.
           MOVE WSA-MAPA-SEGVDA1    TO CACW1601-SEGVDA1.
           MOVE WSA-MAPA-DESCCLI1   TO CACW1601-DESCCLI1.
           MOVE WSA-MAPA-CODCLI2    TO CACW1601-CODCLI2.
           MOVE WSA-MAPA-NUMCLI2    TO CACW1601-NUMCLI2.
           MOVE WSA-MAPA-SEGVDA2    TO CACW1601-SEGVDA2.
           MOVE WSA-MAPA-DESCCLI2   TO CACW1601-DESCCLI2.
           MOVE WSA-MAPA-CODCLI3    TO CACW1601-CODCLI3.
           MOVE WSA-MAPA-NUMCLI3    TO CACW1601-NUMCLI3
           MOVE WSA-MAPA-SEGVDA3    TO CACW1601-SEGVDA3.
           MOVE WSA-MAPA-DESCCLI3   TO CACW1601-DESCCLI3.
      *
       FIN-MOV-WSA-1601.
           EXIT.


      ******************************************************************
      *  TRANSFIERE DESDE MAPAS ESPECIFICOS A MAPA COMUN               *
      ******************************************************************

       MOV-2001-WSA SECTION.
       INI-MOV-2001-WSA.
           MOVE CACW2001-MONEDA    TO WSA-MAPA-MONEDA.
           MOVE CACW2001-OPERACION TO WSA-MAPA-OPERACION
           MOVE CACW2001-DESCOPE   TO WSA-MAPA-DESCOPE.
           MOVE CACW2001-NUMERO    TO WSA-MAPA-NUMERO
           MOVE CACW2001-SUCURSAL  TO WSA-MAPA-SUCURSAL
           MOVE CACW2001-DESCSUC   TO WSA-MAPA-DESCSUC.
           MOVE CACW2001-MONTO     TO WSA-MAPA-MONTO.
           MOVE CACW2001-FECLIQ    TO WSA-MAPA-FECLIQ.
           MOVE CACW2001-SITIVA    TO WSA-MAPA-SITIVA.
           MOVE CACW2001-DESCSIT   TO WSA-MAPA-DESCSIT.
           MOVE CACW2001-CANCUOTAS TO WSA-MAPA-CANCUOTAS
           MOVE CACW2001-CODIDEST  TO WSA-MAPA-CODIDEST
           MOVE CACW2001-DESCDEST  TO WSA-MAPA-DESCDEST.
           MOVE CACW2001-FEPRIVTO  TO WSA-MAPA-FEPRIVTO
           MOVE CACW2001-IMPGAST   TO WSA-MAPA-IMPGAST.
           MOVE CACW2001-MONLIQ    TO WSA-MAPA-MONLIQ.
           MOVE CACW2001-IMPIVA    TO WSA-MAPA-IMPIVA.
           MOVE CACW2001-1ERCUO    TO WSA-MAPA-1ERCUO.
           MOVE CACW2001-IMPSEL    TO WSA-MAPA-IMPSEL.
           MOVE CACW2001-ESTADO    TO WSA-MAPA-ESTADO.
           MOVE CACW2001-OFICIAL   TO WSA-MAPA-OFICIAL.
           MOVE CACW2001-DESCOFI   TO WSA-MAPA-DESCOFI.
           MOVE CACW2001-TASAINT   TO WSA-MAPA-TASAINT.
           MOVE CACW2001-CODCRED   TO WSA-MAPA-CODCRED.

           MOVE CACW2001-CODISER   TO WSA-MAPA-CODISER.
           MOVE CACW2001-OFIAPE    TO WSA-MAPA-OFIAPE.
           MOVE CACW2001-NUMCTA    TO WSA-MAPA-NUMCTA.
           MOVE CACW2001-DIGICTA   TO WSA-MAPA-DIGICTA.
           PERFORM CTA-NUME.

           MOVE CACW2001-CODCLI1   TO WSA-MAPA-CODCLI1.
           MOVE CACW2001-NUMCLI1   TO WSA-MAPA-NUMCLI1.
           MOVE CACW2001-SEGVDA1   TO WSA-MAPA-SEGVDA1.
           MOVE CACW2001-DESCCLI1  TO WSA-MAPA-DESCCLI1.
           MOVE CACW2001-CODCLI2   TO WSA-MAPA-CODCLI2.
           MOVE CACW2001-NUMCLI2   TO WSA-MAPA-NUMCLI2.
           MOVE CACW2001-SEGVDA2   TO WSA-MAPA-SEGVDA2.
           MOVE CACW2001-DESCCLI2  TO WSA-MAPA-DESCCLI2.
           MOVE CACW2001-CODCLI3   TO WSA-MAPA-CODCLI3.
           MOVE CACW2001-NUMCLI3   TO WSA-MAPA-NUMCLI3
           MOVE CACW2001-SEGVDA3   TO WSA-MAPA-SEGVDA3.
           MOVE CACW2001-DESCCLI3  TO WSA-MAPA-DESCCLI3.
      *    MOVE CACW2001-FECALTA   TO WSA-MAPA-FECALTA.
      *    MOVE CACW2001-FECULMOD  TO WSA-MAPA-FECULMOD.
      *    MOVE CACW2001-TERULMOD  TO WSA-MAPA-TERULMOD.
      *    MOVE CACW2001-HORULMOD  TO WSA-MAPA-HORULMOD.
       FIN-MOV-2001-WSA.
           EXIT.

       MOV-2011-WSA SECTION.
       INI-MOV-2011-WSA.
           MOVE CACW2011-MONEDA     TO WSA-MAPA-MONEDA.
           MOVE CACW2011-OPERACION  TO WSA-MAPA-OPERACION
           MOVE CACW2011-DESCOPE    TO WSA-MAPA-DESCOPE.
           MOVE CACW2011-NUMERO     TO WSA-MAPA-NUMERO
           MOVE CACW2011-SUCURSAL   TO WSA-MAPA-SUCURSAL
           MOVE CACW2011-DESCSUC    TO WSA-MAPA-DESCSUC.
           MOVE CACW2011-MONTO      TO WSA-MAPA-MONTO
           MOVE CACW2011-FECLIQ     TO WSA-MAPA-FECLIQ
           MOVE CACW2011-SITIVA     TO WSA-MAPA-SITIVA
           MOVE CACW2011-DESCSIT    TO WSA-MAPA-DESCSIT.
           MOVE CACW2011-CANCUOTAS  TO WSA-MAPA-CANCUOTAS
           MOVE CACW2011-TASACION   TO WSA-MAPA-TASACION.
           MOVE CACW2011-CODIDEST   TO WSA-MAPA-CODIDEST
           MOVE CACW2011-DESCDEST   TO WSA-MAPA-DESCDEST.
           MOVE CACW2011-FEPRIVTO   TO WSA-MAPA-FEPRIVTO
           MOVE CACW2011-IMPGAST    TO WSA-MAPA-IMPGAST.
           MOVE CACW2011-MONLIQ     TO WSA-MAPA-MONLIQ.
           MOVE CACW2011-IMPIVA     TO WSA-MAPA-IMPIVA.
           MOVE CACW2011-1ERCUO     TO WSA-MAPA-1ERCUO.
           MOVE CACW2011-IMPSEG     TO WSA-MAPA-IMPSEG.
           MOVE CACW2011-ESTADO     TO WSA-MAPA-ESTADO.
           MOVE CACW2011-OFICIAL    TO WSA-MAPA-OFICIAL
           MOVE CACW2011-DESCOFI    TO WSA-MAPA-DESCOFI.
           MOVE CACW2011-TASAINT    TO WSA-MAPA-TASAINT
           MOVE CACW2011-CODCRED    TO WSA-MAPA-CODCRED.

           MOVE CACW2011-CODISER    TO WSA-MAPA-CODISER.
           MOVE CACW2011-OFIAPE     TO WSA-MAPA-OFIAPE.
           MOVE CACW2011-NUMCTA     TO WSA-MAPA-NUMCTA.
           MOVE CACW2011-DIGICTA    TO WSA-MAPA-DIGICTA.
           PERFORM CTA-NUME.

           MOVE CACW2011-CODCLI1    TO WSA-MAPA-CODCLI1.
           MOVE CACW2011-NUMCLI1    TO WSA-MAPA-NUMCLI1.
           MOVE CACW2011-SEGVDA1    TO WSA-MAPA-SEGVDA1.
           MOVE CACW2011-DESCCLI1   TO WSA-MAPA-DESCCLI1.
           MOVE CACW2011-CODCLI2    TO WSA-MAPA-CODCLI2.
           MOVE CACW2011-NUMCLI2    TO WSA-MAPA-NUMCLI2.
           MOVE CACW2011-SEGVDA2    TO WSA-MAPA-SEGVDA2.
           MOVE CACW2011-DESCCLI2   TO WSA-MAPA-DESCCLI2.
           MOVE CACW2011-CODCLI3    TO WSA-MAPA-CODCLI3.
           MOVE CACW2011-NUMCLI3    TO WSA-MAPA-NUMCLI3
           MOVE CACW2011-SEGVDA3    TO WSA-MAPA-SEGVDA3.
           MOVE CACW2011-DESCCLI3   TO WSA-MAPA-DESCCLI3.
           MOVE CACW2011-CODINMO    TO WSA-MAPA-CODINMO.
           MOVE CACW2011-INMOBIL    TO WSA-MAPA-INMOBIL.
           MOVE CACW2011-COMINMOBIL TO WSA-MAPA-COMINMOBIL.
           MOVE CACW2011-DESCINMO   TO WSA-MAPA-DESCINMO.
      *    MOVE CACW2011-FECALTA    TO WSA-MAPA-FECALTA.
      *    MOVE CACW2011-FECULMOD   TO WSA-MAPA-FECULMOD.
      *    MOVE CACW2011-TERULMOD   TO WSA-MAPA-TERULMOD.
      *    MOVE CACW2011-HORULMOD   TO WSA-MAPA-HORULMOD.
           PERFORM GNS-HDL-VSM.
       FIN-MOV-2011-WSA.
           EXIT.

       MOV-2021-WSA SECTION.
       INI-MOV-2021-WSA.
           MOVE CACW2021-MONEDA     TO WSA-MAPA-MONEDA.
           MOVE CACW2021-OPERACION  TO WSA-MAPA-OPERACION
           MOVE CACW2021-DESCOPE    TO WSA-MAPA-DESCOPE.
           MOVE CACW2021-NUMERO     TO WSA-MAPA-NUMERO
           MOVE CACW2021-SUCURSAL   TO WSA-MAPA-SUCURSAL
           MOVE CACW2021-DESCSUC    TO WSA-MAPA-DESCSUC.
           MOVE CACW2021-MONTO      TO WSA-MAPA-MONTO.
           MOVE CACW2021-FECLIQ     TO WSA-MAPA-FECLIQ.
           MOVE CACW2021-SITIVA     TO WSA-MAPA-SITIVA.
           MOVE CACW2021-DESCSIT    TO WSA-MAPA-DESCSIT.
           MOVE CACW2021-CANCUOTAS  TO WSA-MAPA-CANCUOTAS
           MOVE CACW2021-VALSEGUR   TO WSA-MAPA-VALSEGUR.
           MOVE CACW2021-CODIDEST   TO WSA-MAPA-CODIDEST
           MOVE CACW2021-DESCDEST   TO WSA-MAPA-DESCDEST.
           MOVE CACW2021-FEPRIVTO   TO WSA-MAPA-FEPRIVTO
           MOVE CACW2021-IMPGAST    TO WSA-MAPA-IMPGAST.
           MOVE CACW2021-MONLIQ     TO WSA-MAPA-MONLIQ.
           MOVE CACW2021-IMPIVA     TO WSA-MAPA-IMPIVA.
           MOVE CACW2021-1ERCUO     TO WSA-MAPA-1ERCUO.
           MOVE CACW2021-ESTADO     TO WSA-MAPA-ESTADO.
           MOVE CACW2021-OFICIAL    TO WSA-MAPA-OFICIAL
           MOVE CACW2021-DESCOFI    TO WSA-MAPA-DESCOFI.
           MOVE CACW2021-TASAINT    TO WSA-MAPA-TASAINT
           MOVE CACW2021-CODCRED    TO WSA-MAPA-CODCRED

           MOVE CACW2021-CODISER    TO WSA-MAPA-CODISER
           MOVE CACW2021-OFIAPE     TO WSA-MAPA-OFIAPE.
           MOVE CACW2021-NUMCTA     TO WSA-MAPA-NUMCTA.
           MOVE CACW2021-DIGICTA    TO WSA-MAPA-DIGICTA.
           PERFORM CTA-NUME.

           MOVE CACW2021-CODCLI1    TO WSA-MAPA-CODCLI1.
           MOVE CACW2021-NUMCLI1    TO WSA-MAPA-NUMCLI1.
           MOVE CACW2021-SEGVDA1    TO WSA-MAPA-SEGVDA1.
           MOVE CACW2021-DESCCLI1   TO WSA-MAPA-DESCCLI1.
           MOVE CACW2021-CODCLI2    TO WSA-MAPA-CODCLI2.
           MOVE CACW2021-NUMCLI2    TO WSA-MAPA-NUMCLI2.
           MOVE CACW2021-SEGVDA2    TO WSA-MAPA-SEGVDA2.
           MOVE CACW2021-DESCCLI2   TO WSA-MAPA-DESCCLI2.
           MOVE CACW2021-CODCLI3    TO WSA-MAPA-CODCLI3.
           MOVE CACW2021-NUMCLI3    TO WSA-MAPA-NUMCLI3
           MOVE CACW2021-SEGVDA3    TO WSA-MAPA-SEGVDA3.
           MOVE CACW2021-DESCCLI3   TO WSA-MAPA-DESCCLI3.
           MOVE CACW2021-CODICON    TO WSA-MAPA-CODINMO.
           MOVE CACW2021-CONCESION  TO WSA-MAPA-INMOBIL.
           MOVE CACW2021-COMICONCE  TO WSA-MAPA-COMINMOBIL.
           MOVE CACW2021-DESCONCE   TO WSA-MAPA-DESCINMO.
      *    MOVE CACW2021-FECALTA    TO WSA-MAPA-FECALTA.
      *    MOVE CACW2021-FECULMOD   TO WSA-MAPA-FECULMOD.
      *    MOVE CACW2021-TERULMOD   TO WSA-MAPA-TERULMOD.
      *    MOVE CACW2021-HORULMOD   TO WSA-MAPA-HORULMOD.
       FIN-MOV-2021-WSA.
           EXIT.

       MOV-1601-WSA SECTION.
       INI-MOV-1601-WSA.
           MOVE CACW1601-MONEDA    TO WSA-MAPA-MONEDA.
           MOVE CACW1601-OPERACION TO WSA-MAPA-OPERACION
           MOVE CACW1601-DESCOPE   TO WSA-MAPA-DESCOPE.
           MOVE CACW1601-NUMERO    TO WSA-MAPA-NUMERO
           MOVE CACW1601-SUCURSAL  TO WSA-MAPA-SUCURSAL
           MOVE CACW1601-DESCSUC   TO WSA-MAPA-DESCSUC.
           MOVE CACW1601-MONTO     TO WSA-MAPA-MONTO.
           MOVE CACW1601-FECLIQ    TO WSA-MAPA-FECLIQ.
123456*    MOVE CACW1601-SITIVA    TO WSA-MAPA-SITIVA.
           MOVE CACW1601-DESCSIT   TO WSA-MAPA-DESCSIT.
           MOVE CACW1601-CANCUOTAS TO WSA-MAPA-CANCUOTAS
           MOVE CACW1601-DESCDEST  TO WSA-MAPA-DESCDEST.
           MOVE CACW1601-FEPRIVTO  TO WSA-MAPA-FEPRIVTO
           MOVE CACW1601-IMPGAST   TO WSA-MAPA-IMPGAST.
           MOVE CACW1601-MONLIQ    TO WSA-MAPA-MONLIQ.
           MOVE CACW1601-IMPIVA    TO WSA-MAPA-IMPIVA.
           MOVE CACW1601-1ERCUO    TO WSA-MAPA-1ERCUO.
           MOVE CACW1601-ESTADO    TO WSA-MAPA-ESTADO.
           MOVE CACW1601-OFICIAL   TO WSA-MAPA-OFICIAL.
           MOVE CACW1601-DESCOFI   TO WSA-MAPA-DESCOFI.
           MOVE CACW1601-TASAINT   TO WSA-MAPA-TASAINT.
           MOVE CACW1601-CODCRED   TO WSA-MAPA-CODCRED.

           MOVE CACW1601-CODISER   TO WSA-MAPA-CODISER.
           MOVE CACW1601-OFIAPE    TO WSA-MAPA-OFIAPE.
           MOVE CACW1601-NUMCTA    TO WSA-MAPA-NUMCTA.
           MOVE CACW1601-DIGICTA   TO WSA-MAPA-DIGICTA.

           MOVE CACW1601-VAR3-IMPCOM TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 07 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-COMINMOBIL.

           MOVE CACW1601-VAR2-IMPORTE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 08 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-IMPSEL
                                WSA-MAPA-IMPSEG.

           MOVE CACW1601-VAR1-IMPORTE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 08 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-TASACION.
           MOVE CACW1601-VAR3-CODCLI  TO WSA-MAPA-CODINMO
           MOVE CACW1601-VAR3-NUMCLI  TO WSA-MAPA-INMOBIL
           MOVE CACW1601-VAR3-DESCRIP TO WSA-MAPA-DESCINMO

           MOVE CACW1601-CODCLI1   TO WSA-MAPA-CODCLI1.
           MOVE CACW1601-NUMCLI1   TO WSA-MAPA-NUMCLI1.
           MOVE CACW1601-SEGVDA1   TO WSA-MAPA-SEGVDA1.
           MOVE CACW1601-DESCCLI1  TO WSA-MAPA-DESCCLI1.
           MOVE CACW1601-CODCLI2   TO WSA-MAPA-CODCLI2.
           MOVE CACW1601-NUMCLI2   TO WSA-MAPA-NUMCLI2.
           MOVE CACW1601-SEGVDA2   TO WSA-MAPA-SEGVDA2.
           MOVE CACW1601-DESCCLI2  TO WSA-MAPA-DESCCLI2.
           MOVE CACW1601-CODCLI3   TO WSA-MAPA-CODCLI3.
           MOVE CACW1601-NUMCLI3   TO WSA-MAPA-NUMCLI3
           MOVE CACW1601-SEGVDA3   TO WSA-MAPA-SEGVDA3.
           MOVE CACW1601-DESCCLI3  TO WSA-MAPA-DESCCLI3.
      *
       FIN-MOV-1601-WSA.
           EXIT.

      ******************************************************************
      *  POSICIONA CURSOR EN CAMPO ERRONEO Y MUEVE ATR. DE BRILLO      *
      ******************************************************************
      *
       UBICAR-ERROR-2001 SECTION.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONEDA
              MOVE CON-MENOS-UNO    TO CACW2001-MONEDA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-MONEDA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OPERACION
              MOVE CON-MENOS-UNO    TO CACW2001-OPERACION-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-OPERACION-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-NUMERO
              MOVE CON-MENOS-UNO    TO CACW2001-NUMERO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-NUMERO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SUCURSAL
              MOVE CON-MENOS-UNO    TO CACW2001-SUCURSAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-SUCURSAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONTO
              MOVE CON-MENOS-UNO    TO CACW2001-MONTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-MONTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-IMPGAST
              MOVE CON-MENOS-UNO    TO CACW2001-IMPGAST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-IMPGAST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FECLIQ
              MOVE CON-MENOS-UNO    TO CACW2001-FECLIQ-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-FECLIQ-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CANCUOTAS
              MOVE CON-MENOS-UNO    TO CACW2001-CANCUOTAS-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CANCUOTAS-A
      *       GO TO FIN.
      *    IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FEPRIVTO
      *       MOVE CON-MENOS-UNO    TO CACW2001-FEPRIVTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-FEPRIVTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-TASAINT
              MOVE CON-MENOS-UNO    TO CACW2001-TASAINT-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-TASAINT-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SITIVA
              MOVE CON-MENOS-UNO    TO CACW2001-SITIVA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-SITIVA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODIDEST
              MOVE CON-MENOS-UNO    TO CACW2001-CODIDEST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODIDEST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OFICIAL
              MOVE CON-MENOS-UNO    TO CACW2001-OFICIAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-OFICIAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODCRED
              MOVE CON-MENOS-UNO    TO CACW2001-CODCRED-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODCRED-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODISER
              MOVE CON-MENOS-UNO    TO CACW2001-CODISER-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODISER-A
                                       CACW2001-OFIAPE-A
                                       CACW2001-NUMCTA-A
                                       CACW2001-DIGICTA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI1
              MOVE CON-MENOS-UNO    TO CACW2001-CODCLI1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODCLI1-A
                                       CACW2001-NUMCLI1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA1
              MOVE CON-MENOS-UNO    TO CACW2001-SEGVDA1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-SEGVDA1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI2
              MOVE CON-MENOS-UNO    TO CACW2001-CODCLI2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODCLI2-A
                                       CACW2001-NUMCLI2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA2
              MOVE CON-MENOS-UNO    TO CACW2001-SEGVDA2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-SEGVDA2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI3
              MOVE CON-MENOS-UNO    TO CACW2001-CODCLI3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-CODCLI3-A
                                       CACW2001-NUMCLI3-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA3
              MOVE CON-MENOS-UNO    TO CACW2001-SEGVDA3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2001-SEGVDA3-A.
       FIN.
           EXIT.

       UBICAR-ERROR-2011 SECTION.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONEDA
              MOVE CON-MENOS-UNO    TO CACW2011-MONEDA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-MONEDA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OPERACION
              MOVE CON-MENOS-UNO    TO CACW2011-OPERACION-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-OPERACION-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-NUMERO
              MOVE CON-MENOS-UNO    TO CACW2011-NUMERO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-NUMERO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SUCURSAL
              MOVE CON-MENOS-UNO    TO CACW2011-SUCURSAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-SUCURSAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONTO
              MOVE CON-MENOS-UNO    TO CACW2011-MONTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-MONTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-VALSEGUR
              MOVE CON-MENOS-UNO    TO CACW2011-TASACION-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-TASACION-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-IMPGAST
              MOVE CON-MENOS-UNO    TO CACW2011-IMPGAST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-IMPGAST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FECLIQ
              MOVE CON-MENOS-UNO    TO CACW2011-FECLIQ-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-FECLIQ-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CANCUOTAS
              MOVE CON-MENOS-UNO    TO CACW2011-CANCUOTAS-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CANCUOTAS-A
123456*       GO TO FIN.
      *    IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FEPRIVTO
      *       MOVE CON-MENOS-UNO    TO CACW2011-FEPRIVTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-FEPRIVTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-TASAINT
              MOVE CON-MENOS-UNO    TO CACW2011-TASAINT-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-TASAINT-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SITIVA
              MOVE CON-MENOS-UNO    TO CACW2011-SITIVA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-SITIVA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODIDEST
              MOVE CON-MENOS-UNO    TO CACW2011-CODIDEST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODIDEST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OFICIAL
              MOVE CON-MENOS-UNO    TO CACW2011-OFICIAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-OFICIAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODCRED
              MOVE CON-MENOS-UNO    TO CACW2011-CODCRED-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODCRED-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODISER
              MOVE CON-MENOS-UNO    TO CACW2011-CODISER-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODISER-A
                                       CACW2011-OFIAPE-A
                                       CACW2011-NUMCTA-A
                                       CACW2011-DIGICTA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI1
              MOVE CON-MENOS-UNO    TO CACW2011-CODCLI1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODCLI1-A
                                       CACW2011-NUMCLI1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA1
              MOVE CON-MENOS-UNO    TO CACW2011-SEGVDA1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-SEGVDA1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI2
              MOVE CON-MENOS-UNO    TO CACW2011-CODCLI2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODCLI2-A
                                       CACW2011-NUMCLI2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA2
              MOVE CON-MENOS-UNO    TO CACW2011-SEGVDA2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-SEGVDA2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI3
              MOVE CON-MENOS-UNO    TO CACW2011-CODCLI3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODCLI3-A
                                       CACW2011-NUMCLI3-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA3
              MOVE CON-MENOS-UNO    TO CACW2011-SEGVDA3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-SEGVDA3-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODINMO
              MOVE CON-MENOS-UNO    TO CACW2011-CODINMO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-CODINMO-A
                                       CACW2011-INMOBIL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-COMINMOBIL
              MOVE CON-MENOS-UNO    TO CACW2011-COMINMOBIL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2011-COMINMOBIL-A.
       FIN.
           EXIT.

       UBICAR-ERROR-2021 SECTION.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONEDA
              MOVE CON-MENOS-UNO    TO CACW2021-MONEDA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-MONEDA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OPERACION
              MOVE CON-MENOS-UNO    TO CACW2021-OPERACION-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-OPERACION-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-NUMERO
              MOVE CON-MENOS-UNO    TO CACW2021-NUMERO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-NUMERO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SUCURSAL
              MOVE CON-MENOS-UNO    TO CACW2021-SUCURSAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-SUCURSAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-MONTO
              MOVE CON-MENOS-UNO    TO CACW2021-MONTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-MONTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-VALSEGUR
              MOVE CON-MENOS-UNO    TO CACW2021-VALSEGUR-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-VALSEGUR-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-IMPGAST
              MOVE CON-MENOS-UNO    TO CACW2021-IMPGAST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-IMPGAST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FECLIQ
              MOVE CON-MENOS-UNO    TO CACW2021-FECLIQ-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-FECLIQ-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CANCUOTAS
              MOVE CON-MENOS-UNO    TO CACW2021-CANCUOTAS-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CANCUOTAS-A
123456*       GO TO FIN.
      *    IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-FEPRIVTO
      *       MOVE CON-MENOS-UNO    TO CACW2021-FEPRIVTO-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-FEPRIVTO-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-TASAINT
              MOVE CON-MENOS-UNO    TO CACW2021-TASAINT-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-TASAINT-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SITIVA
              MOVE CON-MENOS-UNO    TO CACW2021-SITIVA-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-SITIVA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODIDEST
              MOVE CON-MENOS-UNO    TO CACW2021-CODIDEST-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODIDEST-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-OFICIAL
              MOVE CON-MENOS-UNO    TO CACW2021-OFICIAL-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-OFICIAL-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODCRED
              MOVE CON-MENOS-UNO    TO CACW2021-CODCRED-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODCRED-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODISER
              MOVE CON-MENOS-UNO    TO CACW2021-CODISER-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODISER-A
                                       CACW2021-OFIAPE-A
                                       CACW2021-NUMCTA-A
                                       CACW2021-DIGICTA-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI1
              MOVE CON-MENOS-UNO    TO CACW2021-CODCLI1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODCLI1-A
                                       CACW2021-NUMCLI1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA1
              MOVE CON-MENOS-UNO    TO CACW2021-SEGVDA1-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-SEGVDA1-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI2
              MOVE CON-MENOS-UNO    TO CACW2021-CODCLI2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODCLI2-A
                                       CACW2021-NUMCLI2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA2
              MOVE CON-MENOS-UNO    TO CACW2021-SEGVDA2-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-SEGVDA2-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODICLI3
              MOVE CON-MENOS-UNO    TO CACW2021-CODCLI3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODCLI3-A
                                       CACW2021-NUMCLI3-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-SEGVDA3
              MOVE CON-MENOS-UNO    TO CACW2021-SEGVDA3-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-SEGVDA3-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-CODINMO
              MOVE CON-MENOS-UNO    TO CACW2021-CODICON-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-CODICON-A
                                       CACW2021-CONCESION-A
              GO TO FIN.
           IF WSA-MAPA-CAMPO-ERRONEO EQUAL CON-COMINMOBIL
              MOVE CON-MENOS-UNO    TO CACW2021-COMICONCE-L
              MOVE ATRI-NOP-NUM-BRI TO CACW2021-COMICONCE-A.
       FIN.
           EXIT.

       CTA-NUME SECTION.
       INI-CTA-NUME.

           MOVE WSA-MAPA-CODISER TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-CODISER.

           MOVE WSA-MAPA-OFIAPE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-OFIAPE.

           MOVE WSA-MAPA-NUMCTA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-NUMCTA.

           MOVE WSA-MAPA-DIGICTA TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1  TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM GNS-CRT-VNUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO WSA-MAPA-DIGICTA.
       FIN-CTA-NUME.
           EXIT.

       ATR-2001  SECTION.
       INI-ATR-2001.
      *--------------------------------*
           MOVE ATRI-NOP TO CACW2001-MONEDA-A   CACW2001-OPERACION-A
                            CACW2001-NUMERO-A   CACW2001-SUCURSAL-A
                            CACW2001-MONTO-A    CACW2001-FECLIQ-A
                            CACW2001-SITIVA-A   CACW2001-CANCUOTAS-A
                            CACW2001-CODIDEST-A CACW2001-FEPRIVTO-A
                            CACW2001-OFICIAL-A  CACW2001-TASAINT-A
                            CACW2001-IMPGAST-A
                            CACW2001-CODCRED-A  CACW2001-CODISER-A
                            CACW2001-OFIAPE-A   CACW2001-NUMCTA-A
                            CACW2001-DIGICTA-A  CACW2001-CODCLI1-A
                            CACW2001-NUMCLI1-A  CACW2001-SEGVDA1-A
                            CACW2001-CODCLI2-A  CACW2001-NUMCLI2-A
                            CACW2001-SEGVDA2-A  CACW2001-CODCLI3-A
                            CACW2001-NUMCLI3-A  CACW2001-SEGVDA3-A.
      *
           MOVE ATRI-PRO TO CACW2001-DESCRIP-A  CACW2001-DESCSIT-A
                            CACW2001-DESCDEST-A  CACW2001-1ERCUO-A
                                                 CACW2001-MONLIQ-A
                            CACW2001-IMPIVA-A    CACW2001-IMPSEL-A
                            CACW2001-ESTADO-A
                            CACW2001-DESCOFI-A   CACW2001-DESCCLI1-A
                            CACW2001-DESCCLI2-A  CACW2001-DESCCLI3-A.
      *                     CACW2001-FECALTA-A   CACW2001-FECULMOD-A
      *                     CACW2001-TERULMOD-A  CACW2001-HORULMOD-A.
      *
       FIN-ATR-2001.
           EXIT.

       ATR-2011 SECTION.
       INI-ATR-2011.
           MOVE ATRI-NOP TO CACW2011-MONEDA-A   CACW2011-OPERACION-A
                            CACW2011-NUMERO-A   CACW2011-SUCURSAL-A
                            CACW2011-MONTO-A    CACW2011-FECLIQ-A
                            CACW2011-SITIVA-A   CACW2011-CANCUOTAS-A
                            CACW2011-CODIDEST-A CACW2011-FEPRIVTO-A
                            CACW2011-OFICIAL-A  CACW2011-TASAINT-A
                            CACW2011-IMPGAST-A  CACW2011-TASACION-A
                            CACW2011-CODCRED-A  CACW2011-CODISER-A
                            CACW2011-OFIAPE-A   CACW2011-NUMCTA-A
                            CACW2011-DIGICTA-A  CACW2011-CODCLI1-A
                            CACW2011-NUMCLI1-A  CACW2011-SEGVDA1-A
                            CACW2011-CODCLI2-A  CACW2011-NUMCLI2-A
                            CACW2011-SEGVDA2-A  CACW2011-CODCLI3-A
                            CACW2011-NUMCLI3-A  CACW2011-SEGVDA3-A.
      *
           MOVE ATRI-PRO TO CACW2011-DESCRIP-A  CACW2011-DESCSIT-A
                            CACW2011-DESCDEST-A  CACW2011-1ERCUO-A
                                                 CACW2011-MONLIQ-A
                            CACW2011-IMPIVA-A    CACW2011-IMPSEG-A
                            CACW2011-ESTADO-A
                            CACW2011-DESCOFI-A   CACW2011-DESCCLI1-A
                            CACW2011-DESCCLI2-A  CACW2011-DESCCLI3-A
                            CACW2011-DESCOFI-A   CACW2011-DESCCLI1-A
                            CACW2011-DESCCLI2-A  CACW2011-DESCCLI3-A.
      *                     CACW2011-FECALTA-A   CACW2011-FECULMOD-A
      *                     CACW2011-TERULMOD-A  CACW2011-HORULMOD-A.
      *
       FIN-ATR-2011.
           EXIT.


       ATR-2021 SECTION.
       INI-ATR-2021.
           MOVE ATRI-NOP TO CACW2021-MONEDA-A   CACW2021-OPERACION-A
                            CACW2021-NUMERO-A   CACW2021-SUCURSAL-A
                            CACW2021-MONTO-A    CACW2021-FECLIQ-A
                            CACW2021-SITIVA-A   CACW2021-CANCUOTAS-A
                            CACW2021-CODIDEST-A CACW2021-FEPRIVTO-A
                            CACW2021-VALSEGUR-A CACW2021-FEPRIVTO-A
                            CACW2021-IMPGAST-A
                            CACW2021-OFICIAL-A  CACW2021-TASAINT-A
                            CACW2021-CODCRED-A  CACW2021-CODISER-A
                            CACW2021-OFIAPE-A   CACW2021-NUMCTA-A
                            CACW2021-DIGICTA-A  CACW2021-CODCLI1-A
                            CACW2021-CONCESION-A CACW2021-CODICON-A
                            CACW2021-COMICONCE-A
                            CACW2021-NUMCLI1-A  CACW2021-SEGVDA1-A
                            CACW2021-CODCLI2-A  CACW2021-NUMCLI2-A
                            CACW2021-SEGVDA2-A  CACW2021-CODCLI3-A
                            CACW2021-NUMCLI3-A  CACW2021-SEGVDA3-A.
      *
           MOVE ATRI-PRO TO CACW2021-DESCRIP-A  CACW2021-DESCSIT-A
                            CACW2021-DESCDEST-A  CACW2021-1ERCUO-A
                            CACW2021-IMPIVA-A    CACW2021-MONLIQ-A
                            CACW2021-ESTADO-A
                            CACW2021-DESCOFI-A   CACW2021-DESCCLI1-A
                                                 CACW2021-DESCONCE-A
                            CACW2021-DESCCLI2-A  CACW2021-DESCCLI3-A
                            CACW2021-DESCOFI-A   CACW2021-DESCCLI1-A
                            CACW2021-DESCCLI2-A  CACW2021-DESCCLI3-A.
      *                     CACW2021-FECALTA-A   CACW2021-FECULMOD-A
      *                     CACW2021-TERULMOD-A  CACW2021-HORULMOD-A.
       FIN-ATR-2021.
           EXIT.

       ATR-1601  SECTION.
       INI-ATR-1601.
      *--------------------------------*
           MOVE CON-MENOS-UNO TO CACW1601-NUMERO-L.
           MOVE ATRI-NOP TO CACW1601-NUMERO-A
                            CACW1601-OPERACION-A
                            CACW1601-MONEDA-A
           MOVE ATRI-PRO TO
                                                CACW1601-SUCURSAL-A
                            CACW1601-MONTO-A    CACW1601-FECLIQ-A
                                                CACW1601-CANCUOTAS-A
                                                CACW1601-FEPRIVTO-A
                            CACW1601-OFICIAL-A  CACW1601-TASAINT-A
                            CACW1601-IMPGAST-A
                            CACW1601-CODCRED-A  CACW1601-CODISER-A
                            CACW1601-OFIAPE-A   CACW1601-NUMCTA-A
                            CACW1601-DIGICTA-A  CACW1601-CODCLI1-A
                            CACW1601-NUMCLI1-A  CACW1601-SEGVDA1-A
                            CACW1601-CODCLI2-A  CACW1601-NUMCLI2-A
                            CACW1601-SEGVDA2-A  CACW1601-CODCLI3-A
                            CACW1601-NUMCLI3-A  CACW1601-SEGVDA3-A
      *
                            CACW1601-DESCRIP-A  CACW1601-DESCSIT-A
                            CACW1601-DESCDEST-A  CACW1601-1ERCUO-A
                                                 CACW1601-MONLIQ-A
                            CACW1601-IMPIVA-A
                            CACW1601-ESTADO-A
                            CACW1601-DESCOFI-A   CACW1601-DESCCLI1-A
                            CACW1601-DESCCLI2-A  CACW1601-DESCCLI3-A.
      *
       FIN-ATR-1601.
           EXIT.

       COPY GNSBGCPT.

       CHK-S SECTION.
       INI-CHK-S.
           MOVE 'GNS' TO FIO-SIST.
           MOVE 'MSG' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO FIO-CMND
           ELSE
               MOVE FIO-MOD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
       FIN-CHK-S.
           EXIT.

123456     COPY GNSBBMSG.
           COPY GNSBBTAB.
           COPY GNSBFMSG.
           COPY TABBBOFI.
           COPY TABBFOFI.
      *    COPY TABBFCAM.
      *    COPY TABBFUSR.
           COPY COLBFAUX.
      *    COPY COLBFPOC.
      *    COPY COLBFPTI.
