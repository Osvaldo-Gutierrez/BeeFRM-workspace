      *$ASCII
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSP6TDI.
       AUTHOR.          CONSIST.
      * 
       ENVIRONMENT DIVISION.
      *====================
      *
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSTDS ASSIGN TO 'C:GNSMTDV.SEQ[U60]'
                  ORGANIZATION   IS SEQUENTIAL
                  ACCESS MODE    IS SEQUENTIAL
                  FILE STATUS    IS FIO-STAT.
      *
       CONFIGURATION SECTION.
      *---------------------
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD GNSTDS 
           LABEL RECORDS STANDARD
           RECORD CONTAINS 60.
       01  REG-TDI         PIC X(60).

       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS
       01  WSS-I       VALUE ZEROES PIC 9(06).
       01  WSS-TDI.
           03 WSS-TDI1       PIC X(60).
           03 WSS-TDI2       PIC X(60).
           03 WSS-TDI3       PIC X(60).
           03 WSS-TDI4       PIC X(60).
           03 WSS-TDI5       PIC X(60).
           03 WSS-TDI6       PIC X(60).
           03 WSS-TDI7       PIC X(60).
           03 WSS-TDI8       PIC X(60).
           03 WSS-TDI9       PIC X(60).
           03 WSS-TDI10      PIC X(60).
           03 WSS-TDI11      PIC X(60).
           03 WSS-TDI12      PIC X(60).
           03 WSS-TDI13      PIC X(60).
           03 WSS-TDI14      PIC X(60).
           03 WSS-TDI15      PIC X(60).
           03 WSS-TDI16      PIC X(60).
           03 WSS-TDI17      PIC X(60).
           03 WSS-TDI18      PIC X(60).
           03 WSS-TDI19      PIC X(60).
           03 WSS-TDI20      PIC X(60).
           03 WSS-TDI21      PIC X(60).
           03 WSS-TDI22      PIC X(60).
           03 WSS-TDI23      PIC X(60).
           03 WSS-TDI24      PIC X(60).
           03 WSS-TDI25      PIC X(60).
           03 WSS-TDI26      PIC X(36).

      * WORKING PARA RUTINAS.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.

       COPY GNSBRTDI.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           PERFORM OPN-FILE.
           PERFORM PRO-FILE.
           PERFORM CLO-FILE.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       OPN-FILE SECTION.
      *------------------
       INI-OPE-FILE.
           OPEN OUTPUT GNSTDS.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO OUTPUT GNSTDS FS ' 
                        FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO INPUT  GNSTDI FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
       FIN-OPN-FILE.
           EXIT.

       PRO-FILE SECTION.
      *----------------------
       INI-PRO-FILE.
           MOVE ZEROES       TO WSS-I.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE PRIMER REGISTRO'
              DISPLAY 'ABORTO'
              STOP RUN.
           PERFORM TDI-TRS-TDS UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FILE.
           EXIT.

       TDI-TRS-TDS SECTION.
       INI-TDI-TRS-TDS.
      *GRABA TDS DESDE TDI.
           ADD  1   TO WSS-I.
      *
           MOVE TDI TO WSS-TDI.

           WRITE REG-TDI FROM WSS-TDI1.
           WRITE REG-TDI FROM WSS-TDI2.
           WRITE REG-TDI FROM WSS-TDI3.
           WRITE REG-TDI FROM WSS-TDI4.
           WRITE REG-TDI FROM WSS-TDI5.
           WRITE REG-TDI FROM WSS-TDI6.
           WRITE REG-TDI FROM WSS-TDI7.
           WRITE REG-TDI FROM WSS-TDI8.
           WRITE REG-TDI FROM WSS-TDI9.
           WRITE REG-TDI FROM WSS-TDI10.
           WRITE REG-TDI FROM WSS-TDI11.
           WRITE REG-TDI FROM WSS-TDI12.
           WRITE REG-TDI FROM WSS-TDI13.
           WRITE REG-TDI FROM WSS-TDI14.
           WRITE REG-TDI FROM WSS-TDI15.
           WRITE REG-TDI FROM WSS-TDI16.
           WRITE REG-TDI FROM WSS-TDI17.
           WRITE REG-TDI FROM WSS-TDI18.
           WRITE REG-TDI FROM WSS-TDI19.
           WRITE REG-TDI FROM WSS-TDI20.
           WRITE REG-TDI FROM WSS-TDI21.
           WRITE REG-TDI FROM WSS-TDI22.
           WRITE REG-TDI FROM WSS-TDI23.
           WRITE REG-TDI FROM WSS-TDI24.
           WRITE REG-TDI FROM WSS-TDI25.
           MOVE SPACES TO REG-TDI.
           WRITE REG-TDI FROM WSS-TDI26.
      *
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM GNS-FIO-TDI.
       FIN-TDI-TRS-TDS.
           EXIT.

       CLO-FILE SECTION.
      *------------------
       INI-CLO-FILE.
           DISPLAY 'NRO. REG. TRASPASADOS :' WSS-I.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TDI.
      *
           CLOSE GNSTDS.
      *
       FIN-CLO-FILE.
           EXIT.

      * RUTINAS
       COPY GNSBBSYS.
       COPY GNSBFTDI.
