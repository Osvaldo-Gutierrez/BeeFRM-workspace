       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   GNSPRIDD.
       AUTHOR.       CONSIST.
       DATE-WRITTEN.  19-APR-1993 13:44:24 

      *
      * NOMBRE PROGRAMA                   GNSPRIDD
      * VERSION                           3.1
      * OPCION                            UPD
      * ARCHIVO BASE                      DAPOPD
      * PANTALLA                          DAPOPD
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250
      *
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWVSCR.
       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(750).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
           MOVE 'GNSPRIDD' TO IDD-PROG.
           EXEC CICS LINK
                  PROGRAM ('GNSPPIDD')
                  COMMAREA(IDD-VARI)
                  LENGTH(+507)
           END-EXEC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE '054' TO OFI-COD-OFIC IN OFI.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
               MOVE 'REGISTRO NO ENCONTRADO' TO FIO-MENS
           ELSE
               MOVE OFI-GLS-DESC TO FIO-MENS.
           PERFORM PRG-ABT.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEDB.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.

       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBIABT.
       COPY TABBFOFI.
