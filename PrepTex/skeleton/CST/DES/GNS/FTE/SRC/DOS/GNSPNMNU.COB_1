       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPNMNU.
       AUTHOR.          CONSIST.

      * Genera en batch registro SIS en archivo MNU

       ENVIRONMENT DIVISION.
      *====================
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSMNU ASSIGN TO GNSMNU
                ORGANIZATION    IS INDEXED
                ACCESS          IS SEQUENTIAL
                RECORD KEY      IS MNU-COD-NEMO
                STATUS          IS FIO-STAT.

       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSMNU
           LABEL RECORDS STANDARD.
       COPY GNSBRMNU.

       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-VARI.
           03 FIO-STAT                          PIC X(02).
              88 FIO-STAT-OKS    VALUE '00'.
           03 WSS-CIDD.
              05 WSS-SIST                       PIC X(03).
              05 WSS-DATA         VALUE 'PPMEN' PIC X(09).
           03 WSS-GLS-FMEN.
              05 WSS-GLS-GMEN                   PIC X(07).
              05 FILLER           VALUE SPACES  PIC X(01).
              05 WSS-GLS-SMEN                   PIC X(22).
           03 WSS-GLS-FPRO.
              05 WSS-GLS-GPRO                   PIC X(26).
              05 FILLER           VALUE SPACES  PIC X(01).
              05 WSS-GLS-SPRO                   PIC X(03).
           03 WSS-COD-NEMO.
              05 WSS-COD-GNEM                   PIC X(09).
              05 WSS-COD-SNEM                   PIC X(03).
           
       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           ACCEPT WSS-SIST.
           DISPLAY 'SISTEMA A PROCESAR : ' WSS-SIST.
           OPEN OUTPUT GNSMNU.
           IF FIO-STAT-OKS
               DISPLAY 'APERTURA OUT OK'
           ELSE
               DISPLAY 'ERROR ABRIR  OUT ' FIO-STAT
               GO TO FIN-MAIN.

           PERFORM CRG-MNU.

           CLOSE GNSMNU.
           IF FIO-STAT-OKS
               DISPLAY 'CIERRE       OK'
           ELSE
               DISPLAY 'ERROR CERRAR ' FIO-STAT
               GO TO FIN-MAIN.

           OPEN I-O GNSMNU.
           IF FIO-STAT-OKS
               DISPLAY 'APERTURA I-O OK'
           ELSE
               DISPLAY 'ERROR ABRIR  I-O' FIO-STAT
               GO TO FIN-MAIN.

           MOVE 'SIS' TO MNU-COD-NEMO.
           READ GNSMNU.
           IF FIO-STAT-OKS
               DISPLAY 'LECTURA OK REGISTRO SIS'
           ELSE
               DISPLAY 'ERROR AL LEER REGISTRO SIS ' FIO-STAT
               GO TO FIN-MAIN.

      *     DELETE GNSMNU.
      *     IF FIO-STAT-OKS
      *         DISPLAY 'ELIMINACION  OK'
      *     ELSE
      *         DISPLAY 'ERROR AL ELIMINAR ' FIO-STAT
      *         GO TO FIN-MAIN.

           CLOSE GNSMNU.
           IF FIO-STAT-OKS
               DISPLAY 'CIERRE       OK'
           ELSE
               DISPLAY 'ERROR CERRAR      ' FIO-STAT
               GO TO FIN-MAIN.
       FIN-MAIN.
           STOP RUN.

       CRG-MNU SECTION.
       INI-CRG-MNU.
           MOVE WSS-SIST TO WSS-GLS-SMEN WSS-GLS-SPRO WSS-COD-SNEM.
      *Grabacion de registro actualiza tablas
           MOVE SPACES TO MNU.
           MOVE 'ACTTAB'                     TO WSS-COD-GNEM.
           MOVE WSS-COD-NEMO                 TO MNU-COD-NEMO.
           MOVE 'TAB'                        TO MNU-COD-OPCI.
           MOVE 'SIS980'                     TO MNU-COD-IMEN.
           MOVE 'PTC'                        TO MNU-COD-TFUN.
           MOVE 'GNSPQTAB'                   TO MNU-GLS-PROG.
           MOVE 'GS34'                       TO MNU-GLS-TRAN.
           MOVE 'GNSATAB'                    TO MNU-GLS-LFRM.
           MOVE 'GNSFTAB'                    TO MNU-GLS-NFRM.
           MOVE 'ACTUALIZA  TABLAS  SISTEMA' TO WSS-GLS-GPRO.
           MOVE WSS-GLS-FPRO                 TO MNU-GLS-FMEN.
           MOVE WSS-GLS-FPRO                 TO MNU-GLS-FPRO.
           MOVE 11                           TO MNU-NUM-FILA.
           MOVE 24                           TO MNU-NUM-COLU.
           MOVE 'SIS'                        TO MNU-COD-FRET.
           MOVE 'N'                          TO MNU-IND-EXGL.
           MOVE 'XCTL'                       TO MNU-COD-TCTL.
           MOVE WSS-CIDD                     TO MNU-COD-CIFD.
           MOVE 'OT'                         TO MNU-COD-TINF.
           WRITE MNU.
           IF FIO-STAT-OKS
               DISPLAY 'ESCRITURA OK REGISTRO TAB'
           ELSE
               DISPLAY 'ERROR AL GRABAR REGISTRO TAB '  FIO-STAT
               STOP RUN.
      *Grabacion de registro FIN
           MOVE SPACES TO MNU.
           MOVE 'FIN'                        TO MNU-COD-NEMO.
           MOVE 'FIN'                        TO MNU-COD-OPCI.
           MOVE 'XXXYYY'                     TO MNU-COD-IMEN.
           MOVE 'NEW'                        TO MNU-COD-TFUN.
           MOVE 'GNSPPEXT'                   TO MNU-GLS-PROG.
           MOVE 'XXXX'                       TO MNU-GLS-TRAN.
           MOVE 'FIN'                        TO MNU-GLS-FMEN.
           MOVE 'FIN'                        TO MNU-GLS-FPRO.
           MOVE 00                           TO MNU-NUM-FILA.
           MOVE 00                           TO MNU-NUM-COLU.
           MOVE 'SIS'                        TO MNU-COD-FRET.
           MOVE 'N'                          TO MNU-IND-EXGL.
           MOVE 'XCTL'                       TO MNU-COD-TCTL.
           MOVE 'CC'                         TO MNU-COD-TINF.
           WRITE MNU.
           IF FIO-STAT-OKS
               DISPLAY 'ESCRITURA OK REGISTRO FIN'
           ELSE
               DISPLAY 'ERROR AL GRABAR REGISTRO FIN '  FIO-STAT
               STOP RUN.
      *Grabacion de registro procesa programas BATCH
           MOVE SPACES TO MNU.
           MOVE 'PROBCH'                     TO WSS-COD-GNEM.
           MOVE WSS-COD-NEMO                 TO MNU-COD-NEMO.
           MOVE 'INF'                        TO MNU-COD-OPCI.
           MOVE 'SIS990'                     TO MNU-COD-IMEN.
           MOVE 'PTC'                        TO MNU-COD-TFUN.
           MOVE 'GNSPQJES'                   TO MNU-GLS-PROG.
           MOVE 'GS45'                       TO MNU-GLS-TRAN.
           MOVE 'GNSAJES'                    TO MNU-GLS-LFRM.
           MOVE 'GNSFJES'                    TO MNU-GLS-NFRM.
           MOVE 'PROCESA  INFORMES  SISTEMA' TO WSS-GLS-GPRO.
           MOVE WSS-GLS-FPRO                 TO MNU-GLS-FMEN.
           MOVE WSS-GLS-FPRO                 TO MNU-GLS-FPRO.
           MOVE 13                           TO MNU-NUM-FILA.
           MOVE 24                           TO MNU-NUM-COLU.
           MOVE 'SIS'                        TO MNU-COD-FRET.
           MOVE 'N'                          TO MNU-IND-EXGL.
           MOVE 'XCTL'                       TO MNU-COD-TCTL.
           MOVE WSS-CIDD                     TO MNU-COD-CIFD.
           MOVE 'OT'                         TO MNU-COD-TINF.
           WRITE MNU.
           IF FIO-STAT-OKS
               DISPLAY 'ESCRITURA OK REGISTRO INF'
           ELSE
               DISPLAY 'ERROR AL GRABAR REGISTRO INF '  FIO-STAT
               STOP RUN.
      *Grabacion de registro SIS
           MOVE SPACES TO MNU.
           MOVE 'SIS'                        TO MNU-COD-NEMO.
           MOVE 'SIS'                        TO MNU-COD-OPCI.
           MOVE 'MEN'                        TO MNU-COD-TFUN.
           MOVE 'SISTEMA'                    TO WSS-GLS-GMEN.
           MOVE 'MENU PRINCIPAL DEL SISTEMA' TO WSS-GLS-GPRO.
           MOVE WSS-GLS-FMEN                 TO MNU-GLS-FMEN.
           MOVE WSS-GLS-FPRO                 TO MNU-GLS-FPRO.
           MOVE ZEROES                       TO MNU-NUM-FILA.
           MOVE ZEROES                       TO MNU-NUM-COLU.
           MOVE 'SIS'                        TO MNU-COD-FRET.
           MOVE 'SIS'                        TO MNU-COD-MENU.
           MOVE 'N'                          TO MNU-IND-EXGL.
           MOVE 'XCTL'                       TO MNU-COD-TCTL.
           MOVE 'CC'                         TO MNU-COD-TINF.
           WRITE MNU.
           IF FIO-STAT-OKS
               DISPLAY 'ESCRITURA OK REGISTRO SIS'
           ELSE
               DISPLAY 'ERROR AL GRABAR REGISTRO SIS '  FIO-STAT
               STOP RUN.
       FIN-CRG-MNU.
           EXIT.
