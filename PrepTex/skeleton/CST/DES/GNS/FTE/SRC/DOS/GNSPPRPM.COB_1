       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.      GNSPPRPM.
       AUTHOR.          BEE.
       DATE-WRITTEN.     11-JUN-2004 16:47:34
      
      * Programa que revisa parametros MCI
      
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
      * INPUT-OUTPUT SECTION.
      *----------------------
      * FILE-CONTROL.
      
       DATA DIVISION.
      *=============
      * FILE SECTION.
      *------------
      
       WORKING-STORAGE SECTION.
      *-----------------------
       77  WSS-TAG-GNSPPRPM-INI PIC X(125) VALUE
           '<IDNPGM NOM=$GNSPPRPM$ SKL=$MANUAL$   VSN=$04.12.14$
      -    '       GEN=$14-DIC-04 11:22 PM$ FNC=$DAP-FLEX $>'.
      
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MNU-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
      
       COPY GNSBRMNU.
      * REGISTRO RESCATADO DESDE PROD COMPARAR
      *    Archivo de Menu
      *    ---------------
      *
      *    Nombre Registro : MNU
      *    Clave(s)        : MNU-COD-NEMO(UU),MNU-COD-OPCI(UC),
      *                      MNU-COD-IMEN(UC)
      *    Largo           : 490
      *    Bloqueo         : 1
      *    Observaciones   :
      *
       01  MNU-REV.
      *       Filler Compatibilidad VSAM/MVS
           03 MNU-GLS-FLAG                              PIC X(01).
      *
      *       Llave primaria nemotecnica
           03 MNU-COD-NEMO.
      *
      *          Sistema
              05 MNU-COD-SYST                           PIC X(03).
      *
      *          Codigo accion
              05 MNU-COD-CACC                           PIC X(03).
      *
      *          Codigo de Funcion
              05 MNU-COD-FUNC.
      *
      *             Entidad
                 07 MNU-COD-ENTI                        PIC X(03).
      *
      *             Comando
                 07 MNU-COD-COMD                        PIC X(03).
      *
      *       Llave secundaria 1: Opcion
           03 MNU-COD-OPCI                              PIC X(03).
      *
      *       Llave secundaria 2: Menu + Ordinal
           03 MNU-COD-IMEN.
      *
      *          Codigo menu
              05 MNU-COD-CMEN                           PIC X(03).
      *
      *          Ordinal
              05 MNU-NUM-ORDI                           PIC 9(03).
      *
      *       Tipo funcion
           03 MNU-COD-TFUN                              PIC X(03).
      *
      *       Glosa funcion menu
           03 MNU-GLS-FMEN                              PIC X(30).
      *
      *       Comando
           03 MNU-GLS-CMND.
      *
      *          Prefijo comando
              05 MNU-GLS-COMD                           PIC X(12).
      *
      *          Programa
              05 MNU-GLS-PROG                           PIC X(12).
      *
      *          Resto comando
              05 FILLER                                 PIC X(29).
      *
      *       Transaccion
           03 MNU-GLS-TRAN                              PIC X(04).
      *
      *       Comando ingreso programa
           03 MNU-COD-CMND                              PIC X(03).
      *
      *       Biblioteca documentacion.
           03 MNU-GLS-LDOC                              PIC X(07).
      *
      *       Nombre modulo documentacion
           03 MNU-GLS-NDOC                              PIC X(24).
      *
      *       Biblioteca formulario
           03 MNU-GLS-LFRM                              PIC X(07).
      *
      *       Nombre formulario
           03 MNU-GLS-NFRM                              PIC X(07).
      *
      *       Glosa funcion programa
           03 MNU-GLS-FPRO                              PIC X(30).
      *
      *       Fila
           03 MNU-NUM-FILA                              PIC 9(02).
      *
      *       Columna
           03 MNU-NUM-COLU                              PIC 9(02).
      *
      *       Funcion retorno  (default)
           03 MNU-COD-FRET                              PIC X(12).
      *
      *       Indicador confirmacion
           03 MNU-IND-CONF                              PIC X(01).
      *
      *       Menu
           03 MNU-COD-MENU                              PIC X(03).
      *
      *       Indicador de privilegios
           03 MNU-IND-IPRV                              PIC X(01).
      *
      *       Instancia ingreso programa
           03 MNU-COD-INST                              PIC X(03).
      *
      *       Indicador si expande o no glosa de menu
           03 MNU-IND-EXGL                              PIC X(01).
      *
      *       Indicador transferencia de control
           03 MNU-IND-SEQU                              PIC X(03).
      *
      *       Sistema
           03 MNU-COD-SIST                              PIC X(03).
      *
      *       Codigo de traspaso de control al programa
           03 MNU-COD-TCTL                              PIC X(04).
      *
      *       Accion a ejecutar sobre formulario
           03 MNU-COD-EJFR                              PIC X(03).
      *
      *       Funcion anterior
           03 MNU-COD-FANT                              PIC X(12).
      *
      *       Codigo Tabla
           03 MNU-COD-TABL.
              05 MNU-COD-TTAB                           PIC X(03).
              05 MNU-COD-CTAB                           PIC X(12).
      *
      *       Indicador clear
           03 MNU-IND-NCLR                              PIC X(01).
      *
      *       Biblioteca formulario para VAX
           03 MNU-GLS-LFVX                              PIC X(07).
      *
      *       Nombre formulario para VAX
           03 MNU-GLS-NFVX                              PIC X(07).
      *
      *       Programa
           03 MNU-GLS-PRGM                              PIC X(08).
      *
      *       Independencia Fisica Datos
           03 MNU-COD-CIFD                              PIC X(12).
      *
      *       Codigo de traspaso de informacion al programa
           03 MNU-COD-TINF                              PIC X(03).
      *
      *       Disponible Futuras Ampliaciones
           03 MNU-GLS-DISP                              PIC X(197).
      
       COPY GNSBRRPF.
      *        RELACION PROGRAMA - FORMULARIO
       01  RPF-REV.
      *
      *    FILLER COMPATIBILIDAD VSAM/MVS
      *    03 RPF-GLS-FLAG                         PIC X(01).
      *
      *        DESCRIPCION PROGRAMA + TIPO REGISTRO (LLAVE)
           03 RPF-COD-DPTR.
      *
      *        DESCRIPCION PROGRAMA
              05 RPF-COD-DPRO                      PIC X(12).
      *
      *        TIPO REGISTRO Y CORRELATIVO
      *          A   =   AUTOR
      *          B   =   ARCHIVO BASE
      *          C   =   COMANDOS
      *          C0  =   COMANDO 0
      *          C1  =   COMANDO 1
      *          .
      *          .
      *          C9  =   COMANDO 9
      *          P1  =   FORMULARIO 1
      *          .
      *          .
      *          P9  =   FORMULARIO 9
      *          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA
      *           0  =   LLAVE
      *           1  =   VARIABLE 1
      *           .
      *           .
      *           9  =   VARIABLE 9
      *
              05 RPF-COD-TRYC.
      *
      *        TIPO REGISTRO
                 07 RPF-COD-TREG                   PIC X(01).
      *
      *        CORRELATIVO
                 07 RPF-COD-CORR                   PIC 9(01).
      *
      *        DESCRIPCION ARCHIVOS
              05 RPF-COD-DARC                      PIC X(08).
      *
           03 RPF-KEY-DPTR REDEFINES RPF-COD-DPTR.
      *
      *        DESCRIPCION PROGRAMA
              05 RPF-KEY-DPRO                      PIC X(12).
      *
      *        TIPO REGISTRO Y CORRELATIVO
      *          A   =   AUTOR
      *          B   =   ARCHIVO BASE
      *          C   =   COMANDOS
      *          C0  =   COMANDO 0
      *          C1  =   COMANDO 1
      *          .
      *          .
      *          C9  =   COMANDO 9
      *          P1  =   FORMULARIO 1
      *          .
      *          .
      *          P9  =   FORMULARIO 9
      *          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA
      *           0  =   LLAVE
      *           1  =   VARIABLE 1
      *           .
      *           .
      *           9  =   VARIABLE 9
      *
              05 RPF-KEY-TRYC.
      *
      *        TIPO REGISTRO
                 07 RPF-KEY-TREG                   PIC X(01).
      *
      *        CORRELATIVO
                 07 RPF-KEY-CORR                   PIC 9(01).
      *
      *        DESCRIPCION ARCHIVOS
              05 RPF-KEY-DARC                      PIC X(08).
      *
      *        DATO ANEXO
           03 RPF-GLS-DATA                         PIC X(70).
      *
           03 RPF-GLS-DAT1 REDEFINES RPF-GLS-DATA.
      *
      *        DESCRIPCION AUTOR
              05 RPF-GLS-DAUT                      PIC X(42).
      *
      *        CODIGO INDEPEDENCIA FISICA DE DATOS
              05 RPF-COD-CIFD                      PIC X(12).
      *
      *        FILLER
              05 RPF-GLS-DIS1                      PIC X(16).
      *
           03 RPF-GLS-DAT2 REDEFINES RPF-GLS-DATA.
      *
      *        ARCHIVO BASE
              05 RPF-GLS-ABAS                      PIC X(08).
      *
      *        FILLER
              05 RPF-GLS-DIS2                      PIC X(62).
      *
           03 RPF-GLS-DAT3 REDEFINES RPF-GLS-DATA.
      *
      *        FILLER
              05 RPF-COD-DIS3                      PIC X(03).
      *
      *        GLOSA COMANDOS
              05 RPF-GLS-DCMN                      PIC X(25).
      *
      *        GLOSA ABORTO
              05 RPF-GLS-ABRT                      PIC X(25).
      *
      *        SUBRUTINA ALTERNATIVA COMANDOS
              05 RPF-GLS-UARA                      PIC X(12).
      *
      *        FILLER
              05 RPF-GLS-DIS3                      PIC X(05).
      *
           03 RPF-GLS-DAT4 REDEFINES RPF-GLS-DATA.
      *
      *        CODIGO COMANDO
              05 RPF-COD-CCMN                      PIC X(03).
      *
      *        GLOSA PROMPT
              05 RPF-GLS-PRMT                      PIC X(25).
      *
      *        GLOSA CONFIRMACION
              05 RPF-GLS-CONF                      PIC X(25).
      *
      *        SUBRUTINA COMANDO
              05 RPF-GLS-UARC                      PIC X(12).
      *
      *        CODIGO COMANDO PARA PROGRAMA
              05 RPF-COD-CCPP                      PIC X(03).
      *
      *        ESTADO COMANDO PARA PROGRAMA
              05 RPF-IND-STPP                      PIC X(01).
      *
      *        FILLER
              05 RPF-GLS-DIS4                      PIC X(01).
      *
           03 RPF-GLS-DAT5 REDEFINES RPF-GLS-DATA.
      *
      *        DESCRIPCION BIBLIOTECA DE FORMULARIO
              05 RPF-GLS-LFRM                      PIC X(06).
      *
      *        DESCRIPCION DE FORMULARIO
              05 RPF-GLS-NFRM                      PIC X(06).
      *
      *        FILLER
              05 RPF-GLS-DIS5                      PIC X(58).
      *
           03 RPF-GLS-DAT6 REDEFINES RPF-GLS-DATA.
      *
      *        LUGAR DEL CODIGO EN PROGRAMA
              05 RPF-KEY-LCEP                      PIC X(02).
      *
      *        FORMULARIO DEL CODIGO EN PROGRAMA
              05 RPF-KEY-FCEP                      PIC X(06).
      *
      *        VARIABLE DEL CODIGO EN PROGRAMA
              05 RPF-KEY-VCEP                      PIC X(32).
      *
      *        FILLER
              05 RPF-GLS-DIS6                      PIC X(30).
      *
           03 RPF-GLS-DAT7 REDEFINES RPF-GLS-DATA.
      *
      *        DESCRIPCION LLAVE
              05 RPF-GLS-DKEY                      PIC X(10).
      *
      *        FILLER
              05 RPF-GLS-DIS7                      PIC X(60).
      *
           03 RPF-GLS-DAT8 REDEFINES RPF-GLS-DATA.
      *
      *        DESCRIPCION VARIABLE PARA FORMAR LLAVE
              05 RPF-GLS-DVAR                      PIC X(32).
      *
      *        FILLER
              05 RPF-GLS-DIS8                      PIC X(38).
      
       COPY GNSBRTAB.
      *    Registro Generico de Tablas
      *    NECESARIO PARA COMPILAR CICS RESCATADO EL 02.07.98.
      *    ---------------------------
      *
      *    Nombre Registro : TAB
      *    Clave(s)        : TAB-COD-TABL(UU), TAB-STP-ITRN(UU),
      *                      TAB-CIC-TABL(UU), TAB-EXT-TABL(DC)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  TAB-REV.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  TAB-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  TAB-KEY-IREG.
      *
      *KEY     Tipo + Codigo (LLave Primaria)
               05  TAB-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  TAB-COD-TTAB                     PIC X(03).
      *
      *            Codigo Tabla
                   07  TAB-COD-CTAB                     PIC X(12).
      *
      *        Time Stamp Transaccion
               05  TAB-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  TAB-FEC-FTRN.
                       09  TAB-NUM-STRN                 PIC 9(02).
                       09  TAB-NUM-ATRN                 PIC 9(02).
                       09  TAB-NUM-MTRN                 PIC 9(02).
                       09  TAB-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  TAB-HRA-HRTR.
                       09  TAB-NUM-HHTR                 PIC 9(02).
                       09  TAB-NUM-MMTR                 PIC 9(02).
                       09  TAB-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  TAB-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  TAB-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  TAB-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  TAB-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  TAB-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  TAB-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo (Interno Computacional)
           03  TAB-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-CIC-CTAB                         PIC X(12).
      *
      *    Codigo Externo
           03  TAB-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  TAB-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  TAB-GLS-ABRV                             PIC X(05).
      *
           03  TAB-GLS-MSGD.
      *    Descripcion del Codigo
               05 TAB-GLS-DESC                          PIC X(40).
      *    Datos Anexos
               05 TAB-GLS-DATA.
                  07 TAB-GLS-DAT1.
                     09 TAB-COD-DAT1    OCCURS 10       PIC X(01).
                  07 TAB-GLS-DAT2.
                     09 TAB-COD-DAT2    OCCURS 10       PIC X(02).
                  07 TAB-GLS-DAT3.
                     09 TAB-COD-DAT3    OCCURS 10       PIC X(03).
      *
      *    Clave Soundex
           03  TAB-SNX-TABL.
               05  TAB-SNX-TTAB                         PIC X(03).
               05  TAB-SNX-CTAB                         PIC X(03).
      *
      *    Variables de Tablas
      * 01  TAB-VARI.
      *
      *    Nombre de Programa FIO para TABlas
      *     03  TAB-GLS-FTAB.
      *
      *        Codigo Sistema
      *         05  TAB-COD-SIST                         PIC X(03).
      *
      *        Nombre 'fijo' de FIO TABlas
      *         05  TAB-COD-FTAB           VALUE 'PFTAB' PIC X(05).
      
        01 RPF-KEY.
           03 RPF-COD-DPTR.
              05 RPF-COD-DPRO                      PIC X(12).
              05 RPF-COD-TRYC.
                 07 RPF-COD-TREG                   PIC X(01).
                 07 RPF-COD-CORR                   PIC X(01).
              05 RPF-COD-DARC                      PIC X(08).
      
        01 RPF-BKP.
           03 RPF-COD-DPTR.
              05 RPF-COD-DPRO                      PIC X(12).
              05 RPF-COD-TRYC.
                 07 RPF-COD-TREG                   PIC X(01).
                 07 RPF-COD-CORR                   PIC 9(01).
              05 RPF-COD-DARC                      PIC X(08).
           03 RPF-KEY-DPTR REDEFINES RPF-COD-DPTR.
              05 RPF-KEY-DPRO                      PIC X(12).
              05 RPF-KEY-TRYC.
                 07 RPF-KEY-TREG                   PIC X(01).
                 07 RPF-KEY-CORR                   PIC 9(01).
              05 RPF-KEY-DARC                      PIC X(08).
           03 RPF-GLS-DATA                         PIC X(70).
           03 RPF-GLS-DAT1 REDEFINES RPF-GLS-DATA.
              05 RPF-GLS-DAUT                      PIC X(42).
              05 RPF-COD-CIFD                      PIC X(12).
              05 RPF-GLS-DIS1                      PIC X(16).
           03 RPF-GLS-DAT2 REDEFINES RPF-GLS-DATA.
              05 RPF-GLS-ABAS                      PIC X(08).
              05 RPF-GLS-DIS2                      PIC X(62).
           03 RPF-GLS-DAT3 REDEFINES RPF-GLS-DATA.
              05 RPF-COD-DIS3                      PIC X(03).
              05 RPF-GLS-DCMN                      PIC X(25).
              05 RPF-GLS-ABRT                      PIC X(25).
              05 RPF-GLS-UARA                      PIC X(12).
              05 RPF-GLS-DIS3                      PIC X(05).
           03 RPF-GLS-DAT4 REDEFINES RPF-GLS-DATA.
              05 RPF-COD-CCMN                      PIC X(03).
              05 RPF-GLS-PRMT                      PIC X(25).
              05 RPF-GLS-CONF                      PIC X(25).
              05 RPF-GLS-UARC                      PIC X(12).
              05 RPF-COD-CCPP                      PIC X(03).
              05 RPF-IND-STPP                      PIC X(01).
              05 RPF-GLS-DIS4                      PIC X(01).
           03 RPF-GLS-DAT5 REDEFINES RPF-GLS-DATA.
              05 RPF-GLS-LFRM                      PIC X(06).
              05 RPF-GLS-NFRM                      PIC X(06).
              05 RPF-GLS-DIS5                      PIC X(58).
           03 RPF-GLS-DAT6 REDEFINES RPF-GLS-DATA.
              05 RPF-KEY-LCEP                      PIC X(02).
              05 RPF-KEY-FCEP                      PIC X(06).
              05 RPF-KEY-VCEP                      PIC X(32).
              05 RPF-GLS-DIS6                      PIC X(30).
           03 RPF-GLS-DAT7 REDEFINES RPF-GLS-DATA.
              05 RPF-GLS-DKEY                      PIC X(10).
              05 RPF-GLS-DIS7                      PIC X(60).
           03 RPF-GLS-DAT8 REDEFINES RPF-GLS-DATA.
              05 RPF-GLS-DVAR                      PIC X(32).
              05 RPF-GLS-DIS8                      PIC X(38).
      
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
      
      * 01  PGM-STAT.
      *     03 PGM-STAT-SRT        VALUE ' ' PIC X(01).
      *        88 PGM-STAT-SRT-OKS VALUE ' '.
      *        88 PGM-STAT-SRT-MAL VALUE 'M'.
      *     03 PGM-SOKS            VALUE ' ' PIC X(01).
      *     03 PGM-SMAL            VALUE 'M' PIC X(01).
      
       01  BUF-ACP.
           03 BUF-ACP1                      PIC X(06).
           03 BUF-ACP2                      PIC X(03).
           03 BUF-ACP3                      PIC X(51).
      
       01  WSS-MNU.
           03 WSS-MNU1                      PIC X(60).
           03 WSS-MNU2                      PIC X(60).
           03 WSS-MNU3                      PIC X(60).
           03 WSS-MNU4                      PIC X(60).
           03 WSS-MNU5                      PIC X(60).
           03 WSS-MNU6                      PIC X(60).
           03 WSS-MNU7                      PIC X(60).
           03 WSS-MNU8                      PIC X(60).
           03 WSS-MNU9                      PIC X(60).
      
       01  WSS-TOT.
           03 WSS-MNU-ERP     VALUE ZEROES  PIC 9(05).
           03 WSS-MNU-ERP-EDT               PIC ZZZZ9.
           03 WSS-MNU-ERM     VALUE ZEROES  PIC 9(05).
           03 WSS-MNU-ERM-EDT               PIC ZZZZ9.
           03 WSS-MNU-PUT     VALUE ZEROES  PIC 9(05).
           03 WSS-MNU-PUT-EDT               PIC ZZZZ9.
           03 WSS-MNU-MOD     VALUE ZEROES  PIC 9(05).
           03 WSS-MNU-MOD-EDT               PIC ZZZZ9.
      
           03 WSS-RPF-ERP     VALUE ZEROES  PIC 9(05).
           03 WSS-RPF-ERP-EDT               PIC ZZZZ9.
           03 WSS-RPF-ERM     VALUE ZEROES  PIC 9(05).
           03 WSS-RPF-ERM-EDT               PIC ZZZZ9.
           03 WSS-RPF-PUT     VALUE ZEROES  PIC 9(05).
           03 WSS-RPF-PUT-EDT               PIC ZZZZ9.
           03 WSS-RPF-MOD     VALUE ZEROES  PIC 9(05).
           03 WSS-RPF-MOD-EDT               PIC ZZZZ9.
      
           03 WSS-TAB-ERP     VALUE ZEROES  PIC 9(05).
           03 WSS-TAB-ERP-EDT               PIC ZZZZ9.
           03 WSS-TAB-ERM     VALUE ZEROES  PIC 9(05).
           03 WSS-TAB-ERM-EDT               PIC ZZZZ9.
           03 WSS-TAB-PUT     VALUE ZEROES  PIC 9(05).
           03 WSS-TAB-PUT-EDT               PIC ZZZZ9.
           03 WSS-TAB-MOD     VALUE ZEROES  PIC 9(05).
           03 WSS-TAB-MOD-EDT               PIC ZZZZ9.
      
       01  WSS-RPF.
           03 WSS-RPF1                      PIC X(60).
           03 WSS-RPF2                      PIC X(60).
      
       01  WSS-TAB.
           03 WSS-TAB1                      PIC X(60).
           03 WSS-TAB2                      PIC X(60).
           03 WSS-TAB3                      PIC X(60).
           03 WSS-TAB4                      PIC X(60).
      
       01  WSS-VARI.
      *     03 WSS-I           VALUE ZEROES  PIC 9(06).
           03 WSS-SIST        VALUE '   '   PIC X(03).
      
       77  WSS-GLS-DIFE-HST       VALUE SPACES  PIC X(02).
       77  WSS-GLS-DIFE-SRV       VALUE SPACES  PIC X(03).
      
       77  WSS-IDX-DEDA       VALUE ZEROES  PIC 9(04).
       01  WSS-DEDA-DSP.
           03  WSS-DEDA-DSP-HST-GRP.
               05  WSS-DEDA-DSP-HST.
                   07  WSS-DEDA-DSP-TBL-HST OCCURS 50 TIMES.
                       09  WSS-DEDA-DSP-ELM-HST    PIC X(02).
           03  WSS-DEDA-DSP-SRV-GRP REDEFINES WSS-DEDA-DSP-HST-GRP.
               05  WSS-DEDA-DSP-SRV.
                   07  WSS-DEDA-DSP-TBL-SRV OCCURS 33 TIMES.
                       09  WSS-DEDA-DSP-ELM-SRV    PIC X(03).
               05  WSS-DEDA-DSP-SRV-CPL            PIC X(01).
       01  WSS-DEDA-DSP-DSP REDEFINES WSS-DEDA-DSP.
           03  WSS-DEDA-DSP-DESC                   PIC X(40).
           03  WSS-DEDA-DSP-DATA                   PIC X(60).
      
       01  WSS-DEDA-BDD.
           03 WSS-DEDA-BDD-HST.
              05 WSS-DEDA-BDD-TBL-HST OCCURS 50 TIMES.
                 07 WSS-DEDA-BDD-ELM-HST    PIC X(02).
           03 WSS-DEDA-BDD-SRV REDEFINES WSS-DEDA-BDD-HST.
              05 WSS-DEDA-BDD-TBL-SRV OCCURS 33 TIMES.
                 07 WSS-DEDA-BDD-ELM-SRV    PIC X(03).
              05 WSS-DEDA-BDD-CPL           PIC X(01).
       01  WSS-DEDA-BDD-DEDA REDEFINES WSS-DEDA-BDD.
           03 WSS-DEDA-BDD-DESC             PIC X(40).
           03 WSS-DEDA-BDD-DATA             PIC X(60).
      
       01  WSS-DEDA-PI1.
           03 WSS-DEDA-PI1-HST.
              05 WSS-DEDA-PI1-TBL-HST OCCURS 50 TIMES.
                 07 WSS-DEDA-PI1-ELM-HST    PIC X(02).
           03 WSS-DEDA-PI1-SRV REDEFINES WSS-DEDA-PI1-HST.
              05 WSS-DEDA-PI1-TBL-SRV OCCURS 33 TIMES.
                 07 WSS-DEDA-PI1-ELM-SRV    PIC X(03).
              05 WSS-DEDA-PI1-CPL           PIC X(01).
       01  WSS-DEDA-PI1-DEDA REDEFINES WSS-DEDA-PI1.
           03 WSS-DEDA-PI1-DESC             PIC X(40).
           03 WSS-DEDA-PI1-DATA             PIC X(60).
      
       01 RPF-ENCONTRADO VALUE 'N'   PIC X(01).
      
       COPY GNSWVNUM.
      
       77  WSS-IDX-REV   VALUE  ZEROES PIC 9(05).
       01  REV-RPF-BDD.
           03 REV-RPF-BDD-TBL OCCURS 70 TIMES.
              05 REV-RPF-BDD-ELM     PIC X(01).
       01  REV-RPF-PI1.
           03 REV-RPF-PI1-TBL OCCURS 70 TIMES.
              05 REV-RPF-PI1-ELM     PIC X(01).
      
       77  WSS-IND-MNUOK   VALUE SPACES PIC X(01).
       77  WSS-IND-TABOK   VALUE SPACES PIC X(01).
      
       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           DISPLAY 'INICIO GNSPPRPM VERSION 14-12-2004'
           DISPLAY WSS-TAG-GNSPPRPM-INI .
      
           MOVE SPACES TO IDD-CIDD.
           MOVE 'GNSPPRPM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      
           MOVE FIO-INP  TO FIO-CMND.
           MOVE 'GNS'    TO FIO-SIST WSS-SIST.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL ABRIR MNU FIO-STAT : ' FIO-STAT
              STOP RUN.
      
           MOVE FIO-INP  TO FIO-CMND.
           MOVE 'GNS'    TO FIO-SIST WSS-SIST.
           PERFORM GNS-FIO-RPF.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL ABRIR RPF FIO-STAT : ' FIO-STAT
              STOP RUN.
      
           PERFORM PRO-INP.
           PERFORM GNS-PRO-END.
           PERFORM CLO-FIL.
       FIN-MAIN.
           EXIT.
      
       PRO-INP SECTION.
       INI-PRO-INP.
           MOVE SPACES TO BUF-ACP.
           ACCEPT  BUF-ACP.
           IF BUF-ACP1 = 'REGMNU'
              PERFORM PRO-ACT-MNU
           ELSE
           IF BUF-ACP1 = 'REGRPF'
              PERFORM PRO-ACT-RPF
           ELSE
           IF BUF-ACP1 = 'REGTAB'
              PERFORM PRO-ACT-TAB
           ELSE
           IF BUF-ACP1 NOT = 'FINPI1'
              DISPLAY '++>> ' BUF-ACP
           ELSE
              GO TO FIN-PRO-INP.
           GO TO INI-PRO-INP.
       FIN-PRO-INP.
           EXIT.
      
       PRO-ACT-MNU SECTION.
       INI-PRO-ACT-MNU.
           IF BUF-ACP2 NOT > SPACES
              DISPLAY 'NO SE INDICA SISTEMA DE MNU : ' BUF-ACP
              GO TO FIN-PRO-ACT-MNU.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU1.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU2.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU3.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU4.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU5.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU6.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU7.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU8.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-MNU9.
      
      * MOVE PARA REVISAR
           MOVE WSS-MNU         TO MNU-REV.
      * MOVE SOLO PARA LEER
           MOVE WSS-MNU         TO MNU.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           MOVE WSS-SIST        TO FIO-SIST.
           PERFORM GNS-FIO-MNU.
           IF FIO-STAT-OKS
              PERFORM CHK-MNU
           ELSE
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY 'NO EXISTE EN BDD MNU-'
                 MNU-COD-NEMO IN MNU ' SIST-' FIO-SIST.
       FIN-PRO-ACT-MNU.
           EXIT.
      
       CHK-MNU SECTION.
       INI-CHK-MNU.
           MOVE 'S' TO WSS-IND-MNUOK.
      
           IF MNU-COD-TFUN  IN MNU NOT = MNU-COD-TFUN  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TFUN BDD <> ' MNU-COD-TFUN IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TFUN PI1 <> ' MNU-COD-TFUN IN MNU-REV.
      
           IF MNU-GLS-FMEN  IN MNU NOT = MNU-GLS-FMEN  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-FMEN BDD <> ' MNU-GLS-FMEN IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-FMEN PI1 <> ' MNU-GLS-FMEN IN MNU-REV.
      
           IF MNU-GLS-TRAN  IN MNU NOT = MNU-GLS-TRAN  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-TRAN BDD <> ' MNU-GLS-TRAN IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-TRAN PI1 <> ' MNU-GLS-TRAN IN MNU-REV.
      
           IF MNU-COD-CMND  IN MNU NOT = MNU-COD-CMND  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-CMND BDD <> ' MNU-COD-CMND IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-CMND PI1 <> ' MNU-COD-CMND IN MNU-REV.
      
           IF MNU-GLS-LFRM  IN MNU NOT = MNU-GLS-LFRM  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-LFRM BDD <> ' MNU-GLS-LFRM IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-LFRM PI1 <> ' MNU-GLS-LFRM IN MNU-REV.
      
           IF MNU-GLS-NFRM  IN MNU NOT = MNU-GLS-NFRM  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-NFRM BDD <> ' MNU-GLS-NFRM IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-NFRM PI1 <> ' MNU-GLS-NFRM IN MNU-REV.
      
           IF MNU-GLS-FPRO  IN MNU NOT = MNU-GLS-FPRO  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-FPRO BDD <> ' MNU-GLS-FPRO IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-FPRO PI1 <> ' MNU-GLS-FPRO IN MNU-REV.
      
           IF MNU-COD-MENU  IN MNU NOT = MNU-COD-MENU  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-MENU BDD <> ' MNU-COD-MENU IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-MENU PI1 <> ' MNU-COD-MENU IN MNU-REV.
      
           IF MNU-COD-INST  IN MNU NOT = MNU-COD-INST  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-INST BDD <> ' MNU-COD-INST IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-INST PI1 <> ' MNU-COD-INST IN MNU-REV.
      
           IF MNU-COD-SIST  IN MNU NOT = MNU-COD-SIST  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-SIST BDD <> ' MNU-COD-SIST IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-SIST PI1 <> ' MNU-COD-SIST IN MNU-REV.
      
           IF MNU-COD-TCTL  IN MNU NOT = MNU-COD-TCTL  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TCTL BDD <> ' MNU-COD-TCTL IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TCTL PI1 <> ' MNU-COD-TCTL IN MNU-REV.
      
           IF MNU-GLS-PRGM  IN MNU NOT = MNU-GLS-PRGM  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-PRGM BDD <> ' MNU-GLS-PRGM IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-GLS-PRGM PI1 <> ' MNU-GLS-PRGM IN MNU-REV.
      
           IF MNU-COD-CIFD  IN MNU NOT = MNU-COD-CIFD  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-CIFD BDD <> ' MNU-COD-CIFD IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-CIFD PI1 <> ' MNU-COD-CIFD IN MNU-REV.
      
           IF MNU-COD-TINF  IN MNU NOT = MNU-COD-TINF  IN MNU-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TINF BDD <> ' MNU-COD-TINF IN MNU
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
                      ' MNU-COD-TINF PI1 <> ' MNU-COD-TINF IN MNU-REV.
      
           IF WSS-IND-MNUOK = 'S'
              DISPLAY ' '
              DISPLAY '====> MNU-INI'
              DISPLAY ' MNU:' MNU-COD-NEMO IN MNU ' SIST>' FIO-SIST
              ' MNU BDD =  PI1 '.
      
       FIN-CHK-MNU.
           EXIT.
      
       PRO-ACT-RPF SECTION.
       INI-PRO-ACT-RPF.
           IF BUF-ACP2 NOT > SPACES
              DISPLAY 'NO SE INDICA SISTEMA DE RPF : ' BUF-ACP
              GO TO FIN-PRO-ACT-RPF.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE BUF-ACP TO WSS-RPF1.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE BUF-ACP TO WSS-RPF2.
      
      * MOVE PARA REVISAR
           MOVE WSS-RPF TO RPF-REV.
      * MOVE PARA LEER
           MOVE WSS-RPF TO RPF.
      * MOVE PARA RESPALDAR
           MOVE WSS-RPF TO RPF-BKP.
      
           MOVE WSS-SIST        TO FIO-SIST.
           MOVE 'N' TO RPF-ENCONTRADO.
      
           IF RPF-KEY-TREG IN RPF NOT = 'C'
                MOVE FIO-GET-KEY TO FIO-CMND
           ELSE
                MOVE RPF-COD-DPTR IN RPF TO RPF-COD-DPTR IN RPF-KEY
                MOVE SPACES TO RPF-COD-CORR IN RPF-KEY
                MOVE RPF-COD-DPTR IN RPF-KEY TO RPF-COD-DPTR IN RPF
                MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-RPF.
           MOVE WSS-SIST        TO FIO-SIST.
           PERFORM GNS-FIO-RPF.
           IF FIO-CMND = FIO-GET-KEY
               IF FIO-STAT-OKS
                  MOVE 'S' TO RPF-ENCONTRADO
               ELSE
                  NEXT SENTENCE
           ELSE
               IF FIO-STAT-OKS AND
                  RPF-KEY-DPRO IN RPF = RPF-KEY-DPRO IN RPF-BKP
                    IF RPF-KEY-TREG IN RPF = 'C' AND
                       RPF-COD-CCMN IN RPF = RPF-COD-CCMN IN RPF-BKP
                       MOVE 'S' TO RPF-ENCONTRADO
                    ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO CIC-RPF.
      
           IF RPF-ENCONTRADO = 'N'
              MOVE RPF-REV TO RPF
              DISPLAY ' '
              DISPLAY '====> RPF-INI'
              DISPLAY 'NO EXISTE EN BDD RPF-'
                 RPF-COD-DPTR IN RPF ' SIST-' FIO-SIST
              DISPLAY 'DATA : ' RPF-GLS-DATA IN RPF ':'
           ELSE
              PERFORM CHK-RPF.
       FIN-PRO-ACT-RPF.
           EXIT.
      
       CHK-RPF SECTION.
       INI-CHK-RPF.
      * NO CONSIDERA LOW VALUE DE BDD
              MOVE RPF-GLS-DATA IN RPF TO
                   REV-RPF-BDD.
      *       MOVE RPF-GLS-DATA IN RPF-REV TO
      *            REV-RPF-PI1.
              PERFORM REV-CHR-RPF VARYING WSS-IDX-REV FROM 1 BY 1
                       UNTIL WSS-IDX-REV > 70.
              MOVE REV-RPF-BDD TO
                   RPF-GLS-DATA IN RPF.
      
           IF RPF-GLS-DATA IN RPF NOT = RPF-GLS-DATA IN RPF-REV
              DISPLAY ' '
              DISPLAY '====> RPF-INI'
              DISPLAY '====> RPF-BDD ' RPF-COD-DPTR IN RPF
              DISPLAY '====> RPF-PI1 ' RPF-COD-DPTR IN RPF-REV
              DISPLAY '====> SIST>   ' FIO-SIST
                      ' RPF-GLS-DATA ( BDD <> PI1 )'
              DISPLAY RPF-GLS-DATA IN RPF '+'
              DISPLAY RPF-GLS-DATA IN RPF-REV '+'
           ELSE
              DISPLAY ' '
              DISPLAY '====> RPF-INI'
              DISPLAY '====> RPF-BDD ' RPF-COD-DPTR IN RPF
              DISPLAY '====> RPF-PI1 ' RPF-COD-DPTR IN RPF-REV
              DISPLAY '====> SIST>   ' FIO-SIST
                      ' RPF-GLS-DATA ( BDD =  PI1 )'
              DISPLAY RPF-GLS-DATA IN RPF '+'
              DISPLAY RPF-GLS-DATA IN RPF-REV '+'.
       FIN-CHK-RPF.
           EXIT.
      
       REV-CHR-RPF SECTION.
       INI-REV-CHR-RPF.
           IF REV-RPF-BDD-ELM IN REV-RPF-BDD(WSS-IDX-REV) < SPACES
              MOVE SPACES TO
              REV-RPF-BDD-ELM IN REV-RPF-BDD(WSS-IDX-REV).
       FIN-REV-CHR-RPF.
           EXIT.
      
       PRO-ACT-TAB SECTION.
       INI-PRO-ACT-TAB.
           IF BUF-ACP2 NOT > SPACES
              DISPLAY 'NO SE INDICA SISTEMA DE TAB : ' BUF-ACP
              GO TO FIN-PRO-ACT-TAB.
      
           MOVE BUF-ACP2 TO FIO-SIST WSS-SIST.
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-TAB1.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-TAB2.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-TAB3.
      
           MOVE SPACES TO BUF-ACP.
           ACCEPT BUF-ACP.
           MOVE   BUF-ACP TO WSS-TAB4.
      
      * MOVE PARA REVISAR
           MOVE WSS-TAB         TO TAB-REV.
      * MOVE SOLO PARA LEER
           MOVE WSS-TAB         TO TAB.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           MOVE WSS-SIST        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              PERFORM CHK-TAB
           ELSE
              DISPLAY ' '
              DISPLAY '====> TAB-INI'
              DISPLAY 'NO EXISTE EN BASE DE DATOS TAB-'
                      TAB-COD-TABL IN TAB ' SIST-' FIO-SIST.
       FIN-PRO-ACT-TAB.
           EXIT.
      
       CHK-TAB SECTION.
       INI-CHK-TAB.
           MOVE 'S' TO WSS-IND-TABOK.
           IF TAB-GLS-DCOR IN TAB NOT = TAB-GLS-DCOR IN TAB-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> TAB-INI'
              DISPLAY ' TAB:' TAB-GLS-DCOR IN TAB ' SIST>' FIO-SIST
                      ' TAB-GLS-DCOR BDD <> ' TAB-GLS-DCOR IN TAB
              DISPLAY ' TAB:' TAB-GLS-DCOR IN TAB ' SIST>' FIO-SIST
                      ' TAB-GLS-DCOR PI1 <> ' TAB-GLS-DCOR IN TAB-REV.
      
           IF TAB-GLS-ABRV IN TAB NOT = TAB-GLS-ABRV IN TAB-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> TAB-INI'
              DISPLAY ' TAB:' TAB-GLS-ABRV IN TAB ' SIST>' FIO-SIST
                      ' TAB-GLS-ABRV BDD <> ' TAB-GLS-ABRV IN TAB
              DISPLAY ' TAB:' TAB-GLS-ABRV IN TAB ' SIST>' FIO-SIST
                      ' TAB-GLS-ABRV PI1 <> ' TAB-GLS-ABRV IN TAB-REV.
      
           MOVE SPACES TO WSS-DEDA-DSP.
      
           IF TAB-COD-TTAB IN TAB = 'HST' OR
              TAB-COD-TTAB IN TAB = 'SRV'
                 PERFORM REV-DIF-DEDA.
      
           IF TAB-GLS-DESC IN TAB NOT = TAB-GLS-DESC IN TAB-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> TAB-INI'
              DISPLAY 'TAB: TAB-GLS-DESC COD>' TAB-COD-TABL IN TAB
                                      ' SIST>' FIO-SIST ' BDD <> PI1 '
              DISPLAY WSS-DEDA-DSP-DESC
              DISPLAY TAB-GLS-DESC IN TAB
              DISPLAY TAB-GLS-DESC IN TAB-REV.
      
           IF TAB-GLS-DATA IN TAB NOT = TAB-GLS-DATA IN TAB-REV
              MOVE 'N' TO WSS-IND-MNUOK
              DISPLAY ' '
              DISPLAY '====> TAB-INI'
              DISPLAY 'TAB: TAB-GLS-DATA COD>' TAB-COD-TABL IN TAB
                                      ' SIST>' FIO-SIST ' BDD <> PI1 '
              DISPLAY WSS-DEDA-DSP-DATA
              DISPLAY TAB-GLS-DATA IN TAB
              DISPLAY TAB-GLS-DATA IN TAB-REV.
              IF WSS-IND-TABOK = 'S'
                 DISPLAY ' '
                 DISPLAY '====> TAB-INI'
                 DISPLAY ' TAB:' TAB-COD-TABL IN TAB ' SIST>' FIO-SIST
                 ' TAB BDD =  PI1 '.
       FIN-CHK-TAB.
           EXIT.
      
       REV-DIF-DEDA SECTION.
       INI-REV-DIF-DEDA.
           MOVE TAB-GLS-DESC IN TAB     TO WSS-DEDA-BDD-DESC.
           MOVE TAB-GLS-DESC IN TAB-REV TO WSS-DEDA-PI1-DESC.
           MOVE TAB-GLS-DATA IN TAB     TO WSS-DEDA-BDD-DATA.
           MOVE TAB-GLS-DATA IN TAB-REV TO WSS-DEDA-PI1-DATA.
      
           MOVE '++'  TO WSS-GLS-DIFE-HST.
           MOVE '+++' TO WSS-GLS-DIFE-SRV.
      
           IF TAB-COD-TTAB IN TAB = 'HST'
                PERFORM BUS-DIF-DEDA-HST VARYING WSS-IDX-DEDA
                    FROM 1 BY 1 UNTIL WSS-IDX-DEDA > 50
           ELSE
                PERFORM BUS-DIF-DEDA-SRV VARYING WSS-IDX-DEDA
                    FROM 1 BY 1 UNTIL WSS-IDX-DEDA > 33.
       FIN-REV-DIF-DEDA.
           EXIT.
      
       BUS-DIF-DEDA-HST SECTION.
       INI-BUS-DIF-DEDA-HST.
           IF WSS-DEDA-BDD-ELM-HST IN WSS-DEDA-BDD(WSS-IDX-DEDA)
                            NOT =
              WSS-DEDA-PI1-ELM-HST IN WSS-DEDA-PI1(WSS-IDX-DEDA)
                 MOVE 'N' TO WSS-IND-MNUOK
                 IF WSS-GLS-DIFE-HST = '++'
                    MOVE '..' TO WSS-GLS-DIFE-HST
                    MOVE WSS-GLS-DIFE-HST TO WSS-DEDA-DSP-ELM-HST
                      IN WSS-DEDA-DSP(WSS-IDX-DEDA)
                 ELSE
                    MOVE '++' TO WSS-GLS-DIFE-HST
                    MOVE WSS-GLS-DIFE-HST TO WSS-DEDA-DSP-ELM-HST
                      IN WSS-DEDA-DSP(WSS-IDX-DEDA).
       FIN-BUS-DIF-DEDA-HST.
           EXIT.
      
       BUS-DIF-DEDA-SRV SECTION.
       INI-BUS-DIF-DEDA-SRV.
           IF WSS-DEDA-BDD-ELM-SRV IN WSS-DEDA-BDD-SRV(WSS-IDX-DEDA)
                            NOT =
              WSS-DEDA-PI1-ELM-SRV IN WSS-DEDA-PI1-SRV(WSS-IDX-DEDA)
                 MOVE 'N' TO WSS-IND-MNUOK
                 IF WSS-GLS-DIFE-SRV = '+++'
                    MOVE '...' TO WSS-GLS-DIFE-SRV
                    MOVE WSS-GLS-DIFE-SRV TO WSS-DEDA-DSP-ELM-SRV
                      IN WSS-DEDA-DSP(WSS-IDX-DEDA)
                 ELSE
                    MOVE '+++' TO WSS-GLS-DIFE-SRV
                    MOVE WSS-GLS-DIFE-SRV TO WSS-DEDA-DSP-ELM-SRV
                      IN WSS-DEDA-DSP(WSS-IDX-DEDA).
       FIN-BUS-DIF-DEDA-SRV.
           EXIT.
      
       CLO-FIL SECTION.
       INI-CLO-FIL.
           MOVE FIO-CLO  TO FIO-CMND.
           MOVE 'GNS' TO FIO-SIST.
           PERFORM GNS-FIO-MNU.
      
           MOVE FIO-CLO  TO FIO-CMND.
           MOVE 'GNS' TO FIO-SIST.
           PERFORM GNS-FIO-RPF.
       FIN-CLO-FIL.
           EXIT.
      
      *COPY GNSBFMNU.
       GNS-FIO-MNU SECTION.
       INI-GNS-FIO-MNU.
           CALL 'GNSPFMNU' USING FIO-VARI MNU.
       FIN-GNS-FIO-MNU.
           EXIT.
      
      *COPY GNSBFRPF.
       GNS-FIO-RPF SECTION.
       INI-GNS-FIO-RPF.
           CALL 'GNSPFRPF' USING FIO-VARI RPF.
       FIN-GNS-FIO-RPF.
           EXIT.
      
       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
      * COPY GNSBTABT.
      * COPY GNSBBSYS.
       COPY GNSBGEND.
      * COPY GNSBGABT.
      
       PRG-ABT SECTION.
       INI-PRG-ABT.
           DISPLAY 'ABORTANDO EN PRG-ABT '.
           DISPLAY 'FIO-MENS : ' FIO-MENS.
           MOVE 100 TO RETURN-CODE.
           GOBACK.
       FIN-PRG-ABT.
           EXIT.
