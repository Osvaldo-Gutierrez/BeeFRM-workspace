       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      GNSPXRPF.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      * Programa para Reindexar archivo Secuencial GNSMRPF.SEQ
      * con format LREG=60 a Formato CONSIST.
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT  GNSRPF ASSIGN TO SYS010-GNSRPF
                ORGANIZATION         IS INDEXED
                ACCESS               IS DYNAMIC
                RECORD KEY           IS RPF-KEY-DPTR IN GNSRPF.
      *          STATUS               IS FIO-STAT.

       DATA DIVISION.
      *=============*
       FILE SECTION.
       FD  GNSRPF
           LABEL RECORDS STANDARD
           RECORD CONTAINS 92.
       COPY GNSBRRPF.

       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPF-REQA==.
      *
      *
      * COPY GNSBRTAB.
      * COPY GNSBRIDD.
      * COPY GNSBRMSG.
      * COPY GNSBRMSC.
      * COPY GNSWGRQA.
      * COPY GNSWGUIB.
      * COPY GNSWGELS.
      * COPY GNSWVIDD.
      * COPY GNSWCFIO.
      * COPY GNSWVFIO.
      * COPY GNSWGSYS.
      * COPY GNSWGFEC.
      * COPY GNSWGHOY.
      * COPY GNSWGPES.

       01  REG-RPF.
           03 REG-RPF1                      PIC X(05).
           03 REG-RPF2                      PIC X(55).
       01  WSS-VARI.
           03 WSS-I           VALUE ZEROES  PIC 9(06).
           03 WSS-SIST        VALUE 'GNS'   PIC X(03).
       01  WSS-RPF.
           03 WSS-RPF1                      PIC X(60).
           03 WSS-RPF2                      PIC X(60).

       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
      *     COPY GNSBGEDB.
      *     MOVE 'GNSPXRPF' TO FIO-PROG.
      *     PERFORM GNS-BUS-IDD.
           PERFORM ABRE-ARCHIVOS.
           PERFORM PRO-RPF.
           PERFORM CIERRA-ARCHIVOS.
       FIN-MAIN.
      *--------*
           DISPLAY 'Registros Indexados File GNSMRPF: ' WSS-I.
      *     PERFORM GNS-PRO-END.
           STOP RUN.

       ABRE-ARCHIVOS SECTION.
      *---------------------*
       INI-ABRE-ARCHIVOS.
      *-----------------*
      *     MOVE FIO-OUT TO FIO-CMND.
      *     DISPLAY 'OPEN-OUTPUT GNSRPF'.
      *     PERFORM GNS-FIO-RPF.
           OPEN OUTPUT GNSRPF.
       FIN-ABRE-ARCHIVOS.
      *-----------------*
           EXIT.

       CIERRA-ARCHIVOS SECTION.
      *-----------------------*
       INI-CIERRA-ARCHIVOS.
      *-------------------*
      *     MOVE FIO-CLO TO FIO-CMND.
      *     DISPLAY 'CLOSE GNSRPF'.
      *     PERFORM GNS-FIO-RPF.
           CLOSE GNSRPF.
       FIN-CIERRA-ARCHIVOS.
      *-----------------*
           EXIT.

       PRO-RPF SECTION.
      *---------------*
       INI-PRO-RPF.
      *-----------*
      *     DISPLAY 'Ingrese Sistema: '.
      *     ACCEPT WSS-SIST.
      *     DISPLAY WSS-SIST.
           ACCEPT REG-RPF.
           PERFORM PASA-SEQ-A-IDX.

       FIN-PRO-RPF.
      *-----------*
           EXIT.

       PASA-SEQ-A-IDX SECTION.
      *----------------------*
       INI-PASA-SEQ-A-IDX.
      *------------------*
           IF REG-RPF1 = 'FINAL'
              GO TO FIN-PASA-SEQ-A-IDX.

           MOVE REG-RPF TO WSS-RPF1.
           MOVE SPACES TO REG-RPF.

           ACCEPT REG-RPF.
           MOVE REG-RPF TO WSS-RPF2.

      *     MOVE WSS-RPF TO RPF.
      *     MOVE FIO-PUT TO FIO-CMND.
      *     PERFORM GNS-FIO-RPF.
      *     IF NOT FIO-STAT-OKS
      *        DISPLAY 'ERROR AL GRABAR GNSMRPF'
           WRITE RPF FROM WSS-RPF.

           ADD 1 TO WSS-I.
           ACCEPT REG-RPF.
      *     DISPLAY REG-RPF.
              GO TO INI-PASA-SEQ-A-IDX.

       FIN-PASA-SEQ-A-IDX.
      *------------------*
           EXIT.
      *
      * COPY GNSBFRPF.
      *
      * COPY GNSBFMSG.
      * COPY GNSBFMSC.
      * COPY GNSBFTAB.
      * COPY GNSBBTAB.
      * COPY GNSBBMSG.
      * COPY GNSBGDTC.
      * COPY GNSBGIDD.
      * COPY GNSBTABT.
      * COPY GNSBBSYS.
      * COPY GNSBGEND.
      * COPY GNSBGABT.
      * COPY GNSBGFEC.
      * COPY GNSBPFEC.
      * COPY GNSBGHOY.
      * COPY GNSBGPES.
