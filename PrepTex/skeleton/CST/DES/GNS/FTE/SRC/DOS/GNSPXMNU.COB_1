       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      GNSPXMNU.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.
      * Programa para Reindexar archivo Secuencial GNSMMNU.SEQ
      * con format LREG=60 a Formato CONSIST.
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *DOS SELECT  GNSMNU ASSIGN TO SYS010-GNSMNU
      *MVS SELECT  GNSMNU ASSIGN TO        GNSMNU
           SELECT  GNSMNU ASSIGN TO SYS010-GNSMNU
                ORGANIZATION         IS INDEXED
                ACCESS               IS DYNAMIC
                RECORD KEY           IS MNU-COD-NEMO IN GNSMNU
                ALTERNATE RECORD KEY IS MNU-COD-OPCI IN GNSMNU
                WITH DUPLICATES
                ALTERNATE RECORD KEY IS MNU-COD-IMEN IN GNSMNU
                WITH DUPLICATES.
      *          STATUS               IS FIO-STAT.
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSMNU
           LABEL RECORDS STANDARD
           RECORD CONTAINS 490.
       COPY GNSBRMNU.

       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MNU-REQA==.
      *
      * COPY GNSBRTAB.
      * COPY GNSBRIDD.
      * COPY GNSBRMSG.
      * COPY GNSBRMSC.
      * COPY GNSWGRQA.
      * COPY GNSWGUIB.
      * COPY GNSWGELS.
      * COPY GNSWVIDD.
      * COPY GNSWCFIO.
      * COPY GNSWVFIO.
      * COPY GNSWGSYS.
      * COPY GNSWGFEC.
      * COPY GNSWGHOY.
      * COPY GNSWGPES.

       01  REG-MNU.
           03 REG-MNU1                      PIC X(05).
           03 REG-MNU2                      PIC X(55).
       01  WSS-VARI.
           03 WSS-I           VALUE ZEROES  PIC 9(06).
           03 WSS-SIST        VALUE 'GNS'   PIC X(03).
       01  WSS-MNU.
           03 WSS-MNU1                      PIC X(60).
           03 WSS-MNU2                      PIC X(60).
           03 WSS-MNU3                      PIC X(60).
           03 WSS-MNU4                      PIC X(60).
           03 WSS-MNU5                      PIC X(60).
           03 WSS-MNU6                      PIC X(60).
           03 WSS-MNU7                      PIC X(60).
           03 WSS-MNU8                      PIC X(60).
           03 WSS-MNU9                      PIC X(60).

       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
      *     COPY GNSBGEDB.
      *     MOVE 'GNSPXMNU' TO FIO-PROG.
      *     PERFORM GNS-BUS-IDD.
           PERFORM ABRE-ARCHIVOS.
           PERFORM PRO-MNU.
           PERFORM CIERRA-ARCHIVOS.
       FIN-MAIN.
      *--------*
           DISPLAY 'Registros Indexados File GNSMMNU: ' WSS-I.
      *     PERFORM GNS-PRO-END.
           STOP RUN.

       ABRE-ARCHIVOS SECTION.
      *---------------------*
       INI-ABRE-ARCHIVOS.
      *-----------------*
      *     MOVE FIO-OUT TO FIO-CMND.
      *     DISPLAY 'OPEN-OUTPUT GNSMNU'.
      *     PERFORM GNS-FIO-MNU.
           OPEN I-O GNSMNU.
       FIN-ABRE-ARCHIVOS.
      *-----------------*
           EXIT.

       CIERRA-ARCHIVOS SECTION.
      *-----------------------*
       INI-CIERRA-ARCHIVOS.
      *-------------------*
      *     MOVE FIO-CLO TO FIO-CMND.
      *     DISPLAY 'CLOSE GNSMNU'.
      *     PERFORM GNS-FIO-MNU.
           CLOSE GNSMNU.
       FIN-CIERRA-ARCHIVOS.
      *-----------------*
           EXIT.

       PRO-MNU SECTION.
      *---------------*
       INI-PRO-MNU.
      *-----------*
      *     DISPLAY 'Ingrese Sistema: '.
      *     ACCEPT WSS-SIST.
      *     DISPLAY WSS-SIST.
           ACCEPT REG-MNU.
           PERFORM PASA-SEQ-A-IDX.
       FIN-PRO-MNU.
      *-----------*
           EXIT.

       PASA-SEQ-A-IDX SECTION.
      *----------------------*
       INI-PASA-SEQ-A-IDX.
      *------------------*
           DISPLAY REG-MNU.
           IF REG-MNU1 = 'FINAL'
              GO TO FIN-PASA-SEQ-A-IDX.
              
           MOVE REG-MNU TO WSS-MNU1.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU2.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU3.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU4.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU5.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU6.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU7.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU8.
           MOVE SPACES TO REG-MNU.

           ACCEPT REG-MNU.
           MOVE REG-MNU TO WSS-MNU9.
           MOVE SPACES TO REG-MNU.

      *     MOVE WSS-MNU TO MNU.
      *     MOVE FIO-PUT TO FIO-CMND.
      *     PERFORM GNS-FIO-MNU.
      *     IF NOT FIO-STAT-OKS
      *        DISPLAY 'ERROR AL GRABAR GNSMMNU'
      *        GO TO FIN-PASA-SEQ-A-IDX.
           WRITE MNU FROM WSS-MNU
           ADD 1 TO WSS-I.
           ACCEPT REG-MNU.
      *     DISPLAY REG-MNU.

           GO TO INI-PASA-SEQ-A-IDX.

       FIN-PASA-SEQ-A-IDX.
      *------------------*
           EXIT.
      *
      * COPY GNSBFMNU.
      *
      * COPY GNSBFMSG.
      * COPY GNSBFMSC.
      * COPY GNSBFTAB.
      * COPY GNSBBTAB.
      * COPY GNSBBMSG.
      * COPY GNSBGDTC.
      * COPY GNSBGIDD.
      * COPY GNSBTABT.
      * COPY GNSBBSYS.
      * COPY GNSBGEND.
      * COPY GNSBGABT.
      * COPY GNSBGFEC.
      * COPY GNSBPFEC.
      * COPY GNSBGHOY.
      * COPY GNSBGPES.
