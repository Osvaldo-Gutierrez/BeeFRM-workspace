%!              BMMEXBNM007.SRCAIU PERFORM VAL-[FLD]
%! Creacion para Migración MEX BNM  4-JAN-2017 18:51:50
%! Archivo Logico GNSSRCAIU:BMMEXBNM007210.SRCAIU
%! Archivo Fisico DKB300:[CST.EXP.GNS.FTE.SRC.DOS.BMS]
%!      BMMEXBNM007210.SRCAIU;1
      * BMMEXBNM007.SRCAIU - INI
      * Creacion para Migración MEX BNM  4-JAN-2017 18:51:50
      * Archivo Logico GNSSRCAIU:BMMEXBNM007210.SRCAIU
      * Archivo Fisico DKB300:[CST.EXP.GNS.FTE.SRC.DOS.BMS]
      * BMMEXBNM007210.SRCAIU;1
% TIPO_{TIPO} = TRUE
%! TIPO VRF
% IF TIPO_VRF THEN
% IF NOT TIENE_IDC_{RREG}_IDC_{NOMB} THEN
% IF TIDX > 0 THEN
           PERFORM VAL-{RREG}-NUM-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                     {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
% ELSE
           PERFORM VAL-{RREG}-NUM-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-NUM-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
           PERFORM VAL-{RREG}-VRF-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-VRF-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
% END IF
% ELSE
%! TIPO IDC
% IF TIPO_IDC THEN
      * IDC-INI --> BMMEXBNM007.SRCAIU PERFORM VAL-[FLD]
% IF TIDX > 0 THEN
           PERFORM VAL-{RREG}-IDC-{NOMB} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                {RREG}-IDC-{NOMB}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
% ELSE
           PERFORM VAL-{RREG}-IDC-{NOMB}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {RREG}-IDC-{NOMB}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
      * IDC-FIN --> BMMEXBNM007.SRCAIU PERFORM VAL-[FLD]
% ELSE
%! TIPO FEC Y SUS DERIVADOS
% IF TIPO_FEC OR TIPO_DMA OR TIPO_AMD OR TIPO_MSA OR TIPO_SAM OR TIPO_FMA OR TIPO_FAM OR TIPO_FSA OR TIPO_FAS OR TIPO_FDM OR TIPO_FMD OR TIPO_FFA THEN
% IF TIDX > 0 THEN
           PERFORM VAL-{CAMP} VARYING FRM-IFLD
                FROM 1 BY 1 UNTIL FRM-IFLD > {TIDX}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                {CAMP}-LEN IN {FRM}-FLD(FRM-IFLD)
                GO TO FIN-VAL-{TVAL}-{FRM}.
% FOR I = 1 TO {TIDX}
% NEXT I
% ELSE
           PERFORM VAL-{CAMP}.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                {CAMP}-LEN IN {FRM}-FLD
                GO TO FIN-VAL-{TVAL}-{FRM}.
% END IF
% END IF
% END IF
% END IF
% TIPO_{TIPO} = FALSE
      * BMMEXBNM007.SRCAIU - FIN
      * Creacion para Migración MEX BNM  4-JAN-2017 18:51:50
      * Archivo Logico GNSSRCAIU:BMMEXBNM007210.SRCAIU
      * Archivo Fisico DKB300:[CST.EXP.GNS.FTE.SRC.DOS.BMS]
      * BMMEXBNM007210.SRCAIU;1
