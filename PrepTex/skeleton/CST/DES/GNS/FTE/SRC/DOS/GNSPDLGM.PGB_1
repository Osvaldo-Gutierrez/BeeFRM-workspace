       IDENTIFICATION DIVISION.      *=======================       PROGRAM-ID.      GNSPDLGM.       AUTHOR.          BEENGA.       DATE-WRITTEN.    07/10/2013      *-----------------------------------------------------------------      *  MODIFICACIONES:      *  ---------------      *  AUTOR      : NESTOR GUZMAN      *  FECHA      : 2013-10-02       *  ETIQUETA   : Cima-INI 02-OCT-2013 LOG MTI      *  PROYECTO   : Log MTI      * OBJETIVO   : REPORTE DE STRING ENCONTRADOS EN ARCHIVO DE      *              ENTRADA O EN BASE DE DATOS GNS-LGM      *            --------------------------------------------------      * ENTRADA    : GNS-LGM (ENTRADA LGM APLANADA)      *            --------------------------------------------------      * SALIDA     : GNS-LGR (REPORTE DE ENCONTRADOS)      *            : GNS-LGE (REPORTE DE ERRORES)      * PARAMETROS :      *               WSS-IND-TIPOINP = INDICADOR       *                                 TIPO DE ENTRADA DTC, VSM      *               WSS-ELE-BUSC    = INGRESE ARGUMENTO DE BUSQUEDA      *               WSS-LAR-ELEM    = LARGO ARGUMENTO DE BUSQUEDA      *               WSS-NUM-PIBU    = POSICION INICIAL BUSQUEDA       *                                 EN REGISTRO      *               WSS-NUM-PFBU    = POSICION FINAL BUSQUEDA       *                                 EN REGISTRO      *               WSS-FEC-FINI    = BUSCAR DESDE LA FECHA      *                     *                     *==============================================================      *       ENVIRONMENT DIVISION.       CONFIGURATION SECTION.      *---------------------       SPECIAL-NAMES.            DECIMAL-POINT IS COMMA.      *====================       DATA DIVISION.      *=============       WORKING-STORAGE SECTION.       COPY GNSBRLGM.       COPY GNSBRLGE.       COPY GNSBRLGR.       COPY GNSBRMSG.       COPY GNSBRTAB.       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGM-REQA==.       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGE-REQA==.       COPY GNSBRMSC.       COPY GNSWGRQA.       COPY GNSWGUIB.       COPY GNSWGELS.       COPY GNSWCFIO.       COPY GNSWVFIO.       COPY GNSWVIDD.       COPY GNSWGSYS.       COPY GNSWGFEC.       COPY GNSWGHOY.       COPY GNSWGCPT.       COPY GNSWGPES.       COPY GNSWGBST.       COPY GNSWGLGM.      *-----------------------      * VARIABLES.       01  WSS-VARIABLES.           03 WSS-FEC-FINI.              05 WSS-NUM-DINI       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-MINI       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-SINI       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-AINI       VALUE ZEROES     PIC 9(02).                  03 WSS-FEC-FFIN.              05 WSS-NUM-DFIN       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-MFIN       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-SFIN       VALUE ZEROES     PIC 9(02).              05 WSS-NUM-AFIN       VALUE ZEROES     PIC 9(02).                  03 WSS-FEC-FINI-RED.              05 WSS-NUM-SINI-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-AINI-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-MINI-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-DINI-RED   VALUE ZEROES     PIC 9(02).           03 WSS-FEC-FIN-RED.              05 WSS-NUM-SFIN-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-AFIN-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-MFIN-RED   VALUE ZEROES     PIC 9(02).              05 WSS-NUM-DFIN-RED   VALUE ZEROES     PIC 9(02).       01  WSS-ESTADISTICAS.           03 WSS-NUM-LLGM        VALUE ZEROES        PIC 9(09).           03 WSS-NUM-ELGM        VALUE ZEROES        PIC 9(09).           03 WSS-NUM-GLGR        VALUE ZEROES        PIC 9(09).           03 WSS-NUM-GLGE        VALUE ZEROES        PIC 9(09).       01  WSS-CONS.           03 WSS-CONS-1500       VALUE 1500          PIC 9(04).           03 WSS-CONS-S          VALUE 'S'           PIC X(01).           03 WSS-CONS-N          VALUE 'N'           PIC X(01).           03 WSS-CONS-1          VALUE  1            PIC 9(01).           03 WSS-CONS-50         VALUE  50           PIC 9(02).           03 WSS-CONS-59         VALUE  59           PIC 9(02).           03 WSS-CONS-23         VALUE  23           PIC 9(02).           03 WSS-CONS-2000       VALUE  2000         PIC 9(04).           03 WSS-CONS-235959     VALUE  235959       PIC 9(06).           03 WSS-CONS-99999999   VALUE  99999999     PIC 9(08).           03 WSS-CONS-ARCH-VACIO                     PIC X(20)              VALUE 'ARCHIVO LGM VACIO   '.           03 WSS-CONS-NOGRBLGR                       PIC X(20)              VALUE 'ERROR AL GRABAR LGR '.       01  WSS-PARAMETROS.           03 WSS-IND-TIPOINP     VALUE SPACES        PIC X(03).           03 WSS-IND-TIPOINP-DTC VALUE 'DTC'         PIC X(03).           03 WSS-IND-TIPOINP-VSM VALUE 'VSM'         PIC X(03).                      03 WSS-ELE-BUSC        VALUE SPACES        PIC X(50).           03 WSS-LAR-ELEM        VALUE ZEROES        PIC 9(02).           03 WSS-NUM-PIBU        VALUE ZEROES        PIC 9(04).           03 WSS-NUM-PFBU        VALUE ZEROES        PIC 9(04).                            03 WSS-HRA-DESDE.              05 WSS-HRA-DD-HH       VALUE ZEROES     PIC 9(02).              05 WSS-HRA-DD-MM       VALUE ZEROES     PIC 9(02).              05 WSS-HRA-DD-SS       VALUE ZEROES     PIC 9(02).                         03 WSS-HRA-HASTA.              05 WSS-HRA-HT-HH       VALUE ZEROES     PIC 9(02).              05 WSS-HRA-HT-MM       VALUE ZEROES     PIC 9(02).              05 WSS-HRA-HT-SS       VALUE ZEROES     PIC 9(02).                         03 WSS-COD-ORGN           VALUE SPACES     PIC X(06).           03 WSS-IND-SENT           VALUE SPACES     PIC X(01).           03 WSS-IND-NIVE           VALUE SPACES     PIC X(02).           03 WSS-NUM-CORR           VALUE ZEROES     PIC 9(05).       PROCEDURE DIVISION.      *==================       MAIN SECTION.       INI-MAIN.           COPY GNSBGEDB.           MOVE 'GNSPDLGM' TO FIO-PROG.           PERFORM GNS-BUS-IDD.           PERFORM PARAMETROS.           PERFORM OPEN-FILE.           PERFORM PROCESO.           PERFORM ESTADISTICAS.           PERFORM CLOSE-FILE.           PERFORM GNS-PRO-END.       FIN-MAIN.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       OPEN-FILE SECTION.       INI-OPEN-FILE.           DISPLAY '------------------------------------------'.           DISPLAY '--> COMIENZO APERTURA ARCHIVOS         '.           MOVE FIO-OUT TO FIO-CMND.           PERFORM GNS-FIO-LGE.             IF NOT FIO-STAT-OKS                DISPLAY 'ERROR AL ABRIR GNSLGE, STAT : ' FIO-STAT                DISPLAY ' '                PERFORM GNS-PRO-ABT             ELSE                DISPLAY 'ABRE ARCHIVO DE ENTRADA: GNSLGE '.           IF WSS-IND-TIPOINP = WSS-IND-TIPOINP-VSM                MOVE FIO-INP TO FIO-CMND                PERFORM GNS-FIO-LGX                IF NOT FIO-STAT-OKS                    DISPLAY 'ERROR AL ABRIR INDEXADO GNSLGX, STAT : '                         FIO-STAT                    DISPLAY ' '                    PERFORM GNS-PRO-ABT                ELSE                    DISPLAY 'APERTURA ARCHIVO INDEXADO INP : GNSLGX '.           MOVE FIO-OUT TO FIO-CMND.           PERFORM GNS-FIO-LGR.             IF NOT FIO-STAT-OKS                DISPLAY 'ERROR AL ABRIR GNSLGR, STAT : ' FIO-STAT                DISPLAY ' '                PERFORM GNS-PRO-ABT             ELSE                DISPLAY 'ABRE ARCHIVO DE ERRORES: GNSLGR '             DISPLAY '------------------------------------------'.       FIN-OPEN-FILE.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       PARAMETROS SECTION.       INI-PARAMETROS.           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.           DISPLAY 'INGRESE INDICADOR TIPO DE ENTRADA DTC, VSM :'                WSS-IND-TIPOINP.           ACCEPT WSS-IND-TIPOINP.           DISPLAY 'INDICADOR ARCHIVO DE ENTRADA :'WSS-IND-TIPOINP.           DISPLAY ' '.           IF WSS-IND-TIPOINP NOT = WSS-IND-TIPOINP-DTC AND              WSS-IND-TIPOINP NOT = WSS-IND-TIPOINP-VSM                DISPLAY 'ERROR EN TIPO ARCHIVO DE ENTRADA'                DISPLAY 'SE CANCELA EL PROCESO '                PERFORM GNS-PRO-ABT.           DISPLAY 'INGRESE ARGUMENTO DE BUSQUEDA X(50) '.           ACCEPT WSS-ELE-BUSC.           DISPLAY 'ELEMENTO A BUSCAR            :' WSS-ELE-BUSC.           DISPLAY 'ARGUMENTO DE BUSQUEDA ('  WSS-ELE-BUSC ')'.           DISPLAY ' '.           DISPLAY 'INGRESE LARGO ARGUMENTO DE BUSQUEDA 9(02) <= 50 '.           ACCEPT WSS-LAR-ELEM.           DISPLAY 'LARGO DE ELEMENTO A BUSCAR   :' WSS-LAR-ELEM.           DISPLAY ' '.           IF WSS-LAR-ELEM IS NOT NUMERIC              DISPLAY 'ERROR FORMATO ARGUMENTO DE BUSQUEDA :'                            WSS-LAR-ELEM              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-LAR-ELEM > WSS-CONS-50 AND WSS-LAR-ELEM IS NUMERIC              DISPLAY 'ERROR LARGO DE BUSQUEDA :' WSS-LAR-ELEM              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           DISPLAY 'INGRESE POSICION INICIAL BUSQUEDA EN REGISTRO '           DISPLAY ' CON RANGO 1 A ' WSS-CONS-1500.           ACCEPT WSS-NUM-PIBU.           DISPLAY 'BUSCAR DESDE LA POSICION :' WSS-NUM-PIBU.           DISPLAY ' '.           IF WSS-NUM-PIBU IS NOT NUMERIC              DISPLAY 'FORMATO POSICION INICIAL BUSQUEDA ERRONEO  :'                 WSS-NUM-PIBU              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           DISPLAY 'INGRESE POSICION FINAL BUSQUEDA EN REGISTRO '           DISPLAY ' CON RANGO 1 A ' WSS-CONS-1500.           IF WSS-NUM-PIBU > WSS-CONS-1500 OR WSS-NUM-PIBU = ZEROES              DISPLAY 'RANGO POSICION INICIAL BUSQUEDA ERRONEO  :'              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           ACCEPT WSS-NUM-PFBU.           DISPLAY 'BUSCAR DESDE LA POSICION :' WSS-NUM-PFBU.           DISPLAY ' '.           IF WSS-NUM-PFBU IS NOT NUMERIC              DISPLAY 'FORMATO POSICION FINAL BUSQUEDA ERRONEO  :'                 WSS-NUM-PFBU              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           DISPLAY 'INGRESE POSICION FINAL BUSQUEDA EN REGISTRO '           IF WSS-NUM-PFBU > WSS-CONS-1500 OR WSS-NUM-PFBU = ZEROES              DISPLAY 'RANGO POSICION FINAL BUSQUEDA ERRONEO  :'              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           ACCEPT WSS-FEC-FINI.           DISPLAY 'BUSCAR DESDE LA FECHA               : '                     WSS-FEC-FINI.           MOVE WSS-NUM-DINI  TO WSS-NUM-DINI-RED.           MOVE WSS-NUM-MINI  TO WSS-NUM-MINI-RED.           MOVE WSS-NUM-SINI  TO WSS-NUM-SINI-RED.           MOVE WSS-NUM-AINI  TO WSS-NUM-AINI-RED.           MOVE WSS-FEC-FINI TO FEC-FECH.           MOVE FEC-FORM-FEC  TO FEC-FORM.           MOVE FEC-FBLK-S   TO  FEC-FBLK.           MOVE FEC-CHOY-N   TO  FEC-CHOY.           MOVE FEC-VHBL-N   TO  FEC-VHBL.           MOVE FEC-VAL-FEC  TO  FEC-CMND.           PERFORM PRO-FEC.           IF NOT FEC-STAT-OKS AND WSS-FEC-FINI NOT = SPACES              DISPLAY 'INGRESE FECHA DESDE VALIDA       : '                           WSS-FEC-FINI              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-FEC-FINI = SPACES              MOVE ZEROES TO WSS-FEC-FINI              DISPLAY 'SE ASUME FECHA DESDE             : '                           WSS-FEC-FINI.                         ACCEPT WSS-FEC-FFIN.           DISPLAY 'BUSCAR HASTA LA FECHA               : '               WSS-FEC-FFIN.           MOVE WSS-FEC-FFIN TO FEC-FECH.           MOVE FEC-FORM-FEC  TO FEC-FORM.           MOVE FEC-FBLK-S   TO  FEC-FBLK.           MOVE FEC-CHOY-N   TO  FEC-CHOY.           MOVE FEC-VHBL-N   TO  FEC-VHBL.           MOVE FEC-VAL-FEC  TO  FEC-CMND.           PERFORM PRO-FEC.           IF NOT FEC-STAT-OKS AND WSS-FEC-FFIN NOT = SPACES              DISPLAY ' FECHA HASTA VALIDA        : ' WSS-FEC-FFIN              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-FEC-FFIN = SPACES              MOVE WSS-CONS-99999999 TO WSS-FEC-FFIN              DISPLAY 'SE ASUME FECHA HASTA              : '                   WSS-FEC-FFIN.           MOVE WSS-NUM-DFIN  TO WSS-NUM-DFIN-RED.           MOVE WSS-NUM-MFIN  TO WSS-NUM-MFIN-RED.           MOVE WSS-NUM-SFIN  TO WSS-NUM-SFIN-RED.           MOVE WSS-NUM-AFIN  TO WSS-NUM-AFIN-RED.           ACCEPT WSS-HRA-DESDE.           DISPLAY 'BUSCAR DESDE LA HORA     :'WSS-HRA-DESDE.           IF WSS-HRA-DESDE IS NOT NUMERIC AND               WSS-HRA-DESDE NOT = SPACES               DISPLAY 'INGRESE HORA  DESDE VALIDA       : '                    WSS-HRA-DESDE               DISPLAY 'SE CANCELA EL PROCESO '               PERFORM GNS-PRO-ABT.           IF WSS-HRA-DD-HH > WSS-CONS-23 AND WSS-HRA-DD-HH NOT = SPACES              DISPLAY 'INGRESE HORA HH DESDE VALIDA     : '                         WSS-HRA-DD-HH              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-DD-MM > WSS-CONS-59 AND WSS-HRA-DD-MM NOT = SPACES              DISPLAY 'INGRESE HORA MM DESDE VALIDA     : '                         WSS-HRA-DD-MM              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-DD-SS > WSS-CONS-59 AND WSS-HRA-DD-SS NOT = SPACES              DISPLAY 'INGRESE HORA SS DESDE VALIDA     : '                          WSS-HRA-DD-SS              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-DESDE = SPACES              MOVE ZEROES TO WSS-HRA-DESDE              DISPLAY 'SE ASUME HORA  DESDE             : '                       WSS-HRA-DESDE.           ACCEPT WSS-HRA-HASTA.           DISPLAY 'BUSCAR HASTA LA HORA                : '                      WSS-HRA-HASTA.           IF WSS-HRA-HASTA IS NOT NUMERIC AND               WSS-HRA-HASTA NOT = SPACES              DISPLAY 'INGRESE HORA  HASTA VALIDA       : '                      WSS-HRA-HASTA              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-HT-HH > WSS-CONS-23 AND WSS-HRA-HT-HH NOT = SPACES              DISPLAY 'INGRESE HORA HH HASTA VALIDA     : '                     WSS-HRA-HT-HH              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-HT-MM > WSS-CONS-59 AND WSS-HRA-HT-MM NOT = SPACES              DISPLAY 'INGRESE HORA MM HASTA VALIDA     : '                       WSS-HRA-HT-MM              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-HT-SS > WSS-CONS-59 AND WSS-HRA-HT-SS NOT = SPACES              DISPLAY 'INGRESE HORA SS HASTA VALIDA     : '                        WSS-HRA-HT-SS              DISPLAY 'SE CANCELA EL PROCESO '              PERFORM GNS-PRO-ABT.           IF WSS-HRA-HASTA = SPACES              MOVE WSS-CONS-235959 TO WSS-HRA-HASTA              DISPLAY 'SE ASUME HORA  HASTA             : '                     WSS-HRA-HASTA.           ACCEPT WSS-COD-ORGN.           DISPLAY 'IDENTIFICADOR QUE ACTIVA PROCESO    : '                      WSS-COD-ORGN.           ACCEPT WSS-IND-SENT.           DISPLAY 'IDENTIFICADOR DE SENTIDO            : '                      WSS-IND-SENT.           ACCEPT WSS-IND-NIVE.           DISPLAY 'IDENTIFICADOR DE NIVEL              : '                   WSS-IND-NIVE.           ACCEPT WSS-NUM-CORR.           DISPLAY 'NUMERO CORRELATIVO DENTRO DE  TAREA : '                  WSS-NUM-CORR.            IF  WSS-NUM-CORR  IS NOT NUMERIC               MOVE ZEROES   TO WSS-NUM-CORR               DISPLAY 'SE ASUME CORRE DENTRO DE TAREA  : '                  WSS-NUM-CORR.           DISPLAY '-------------------------------------------------'.       FIN-PARAMETROS.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       PROCESO SECTION.       INI-PROCESO.           MOVE SPACES TO LGM.           MOVE WSS-FEC-FINI-RED TO LGM-FEC-FLGM IN LGM           MOVE WSS-HRA-DESDE TO LGM-HRA-HRTR IN LGM-STP-ILGM           MOVE FIO-GET-NLS   TO FIO-CMND           IF WSS-IND-TIPOINP = WSS-IND-TIPOINP-DTC                PERFORM GNS-FIO-LGM           ELSE                PERFORM GNS-FIO-LGX.                         IF NOT FIO-STAT-OKS                 MOVE SPACES TO LGE                 MOVE WSS-CONS-ARCH-VACIO TO LGE-MSG                 PERFORM GRB-ERROR                 PERFORM GNS-PRO-ABT.       LUP-PROCESO.      *VALIDAMOS LECTURA A BASE DE DATOS           IF NOT FIO-STAT-OKS                 GO TO FIN-PROCESO.           ADD WSS-CONS-1  TO WSS-NUM-LLGM.      *VALIDAMOS FECHA.           IF LGM-FEC-FLGM IN LGM > WSS-FEC-FIN-RED              GO TO FIN-PROCESO.      *VALIDAMOS HORA.           IF LGM-HRA-HRTR IN LGM-STP-ILGM > WSS-HRA-HASTA              GO TO NXT-PROCESO.      *BUSCAMOS TODO REGISTRO ENTRE UNA FECHA Y OTRA FILTRANDO POR HORA           IF WSS-ELE-BUSC = SPACES              PERFORM GRB-REPORTE              GO TO NXT-PROCESO.      *VALIDAMOS ORIGEN.           IF WSS-COD-ORGN NOT = SPACES              AND              WSS-COD-ORGN NOT = LGM-COD-ORGN IN LGM              GO TO NXT-PROCESO.      *VALIDAMOS SENTIDO.           IF WSS-IND-SENT NOT = SPACES              AND              WSS-IND-SENT NOT = LGM-IND-SENT IN LGM              GO TO NXT-PROCESO.      *VALIDAMOS NIVEL.           IF WSS-IND-NIVE NOT = SPACES              AND              WSS-IND-NIVE NOT = LGM-IND-NIVE IN LGM              GO TO NXT-PROCESO.      *VALIDAMOS CORRELATIVO.           IF WSS-NUM-CORR NOT = ZEROES              AND              WSS-NUM-CORR NOT = LGM-NUM-CORR IN LGM              GO TO NXT-PROCESO.      *BUSCAMOS EN RUTINA PRO-BST           PERFORM BUSCA-ELEMENTO.                 *VALIDAMOS RETORNO DE RUTINA BUSCA STRING Y GRABAMOS                 IF  BST-IND-ENCT = WSS-CONS-S               ADD WSS-CONS-1   TO WSS-NUM-ELGM               PERFORM GRB-REPORTE.      *BUSCAMOS SIGUIENTE REGISTRO LGM       NXT-PROCESO.           MOVE FIO-GET-NXT TO FIO-CMND.           IF WSS-IND-TIPOINP = WSS-IND-TIPOINP-DTC              PERFORM GNS-FIO-LGM           ELSE              PERFORM GNS-FIO-LGX.           GO TO LUP-PROCESO.       FIN-PROCESO.           EXIT.       BUSCA-ELEMENTO SECTION.       INI-BUSCA-ELEMENTO.      *CARGAMOS VARIABLES PARA BUSQUEDA           MOVE SPACES                  TO BST-VEC-BUS-ENTR.           MOVE WSS-LAR-ELEM            TO BST-IND-LAR-ELEM.           MOVE WSS-ELE-BUSC            TO BST-VEC-BUS-ELEM.           MOVE WSS-NUM-PIBU           TO BST-IND-DES-BUSC.           MOVE WSS-NUM-PFBU           TO BST-IND-HAS-BUSC.           MOVE LGM-GLS-REQU IN LGM     TO BST-VEC-BUS-ENTR.      *LLAMADO A RUTINA BUSCA STRING           PERFORM PRO-BST.       FIN-BUSCA-ELEMENTO.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       GRB-REPORTE SECTION.       INI-GRB-REPORTE.      *LIMPIAMOS REGISTRO REPORTE           MOVE SPACES TO LGR.      *MOVEMOS A REPORTE           MOVE LGM-GLS-FLAG   IN LGM  TO   LGR-GLS-FLAG  IN LGR.           MOVE LGM-KEY-IREG   IN LGM  TO   LGR-KEY-IREG  IN LGR.           MOVE LGM-STP-ITRN   IN LGM  TO   LGR-STP-ITRN  IN LGR.           MOVE LGM-MSC-TACC   IN LGM  TO   LGR-MSC-TACC  IN LGR.           MOVE LGM-MSC-STAT   IN LGM  TO   LGR-MSC-STAT  IN LGR.           MOVE LGM-COD-OTRN   IN LGM  TO   LGR-COD-OTRN  IN LGR.           MOVE LGM-COD-ATRN   IN LGM  TO   LGR-COD-ATRN  IN LGR.           MOVE LGM-COD-CTO1   IN LGM  TO   LGR-COD-CTO1  IN LGR.           MOVE LGM-NUM-TASK   IN LGM  TO   LGR-NUM-TASK  IN LGR.           MOVE LGM-COD-CTO2   IN LGM  TO   LGR-COD-CTO2  IN LGR.           MOVE LGM-COD-CTO3   IN LGM  TO   LGR-COD-CTO3  IN LGR.           MOVE LGM-GLS-ITRO   IN LGM  TO   LGR-GLS-ITRO  IN LGR.           MOVE LGM-COD-AMBI   IN LGM  TO   LGR-COD-AMBI  IN LGR.           MOVE LGM-COD-PROG   IN LGM  TO   LGR-COD-PROG  IN LGR.           MOVE LGM-COD-IPRO   IN LGM  TO   LGR-COD-IPRO  IN LGR.           MOVE LGM-COD-CICS   IN LGM  TO   LGR-COD-CICS  IN LGR.           MOVE LGM-COD-TERM   IN LGM  TO   LGR-COD-TERM  IN LGR.           MOVE LGM-COD-TRAN   IN LGM  TO   LGR-COD-TRAN  IN LGR.           MOVE LGM-COD-USER   IN LGM  TO   LGR-COD-USER  IN LGR.           MOVE LGM-NUM-TAIN   IN LGM  TO   LGR-NUM-TAIN  IN LGR.           MOVE LGM-NUM-TAWR   IN LGM  TO   LGR-NUM-TAWR  IN LGR.           MOVE LGM-NUM-LMSG   IN LGM  TO   LGR-NUM-LMSG  IN LGR.           IF WSS-ELE-BUSC NOT = SPACES              MOVE LGM-GLS-REQU IN LGM TO   LGR-VEC-BUSQ  IN LGR           ELSE              MOVE BST-VEC-BUS-SALI    TO   LGR-VEC-BUSQ  IN LGR.      *GRABAMOS SALIDA           MOVE FIO-PUT                    TO FIO-CMND.           PERFORM GNS-FIO-LGR.              IF NOT FIO-STAT-OKS                 MOVE SPACES TO LGE                 MOVE LGM-KEY-IREG IN LGM  TO LGE-COD                 MOVE WSS-CONS-NOGRBLGR    TO LGE-MSG                 PERFORM GRB-ERROR              ELSE                 ADD WSS-CONS-1    TO WSS-NUM-GLGR.       FIN-GRB-REPORTE.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       GRB-ERROR SECTION.       INI-GRB-ERROR.           MOVE FIO-PUT TO FIO-CMND.           PERFORM GNS-FIO-LGE.              IF NOT FIO-STAT-OKS                 DISPLAY 'ARCH LGE NO PUDO GRABAR :'WSS-CONS-NOGRBLGR              ELSE                 ADD WSS-CONS-1   TO WSS-NUM-GLGE.       FIN-GRB-ERROR.           EXIT.      *------------------------------------------------------------      *-------------------------------------------------------------       CLOSE-FILE SECTION.       INI-CLOSE-FILE.           DISPLAY '-->COMIENZO CIERRE ARCHIVOS: '.      *    CIERRO LGR           MOVE FIO-CLO TO FIO-CMND.           PERFORM GNS-FIO-LGR.           DISPLAY 'CIERRE ARCHIVO:  GNSLGR' FIO-STAT.      *    CIERRO LGE           MOVE FIO-CLO TO FIO-CMND.           PERFORM GNS-FIO-LGE.           DISPLAY 'CIERRE ARCHIVO:  GNSLGE' FIO-STAT.      *    CIERRO LGX           MOVE FIO-CLO TO FIO-CMND.           PERFORM GNS-FIO-LGX.           DISPLAY 'CIERRE ARCHIVO:  GNSLGX' FIO-STAT.           DISPLAY 'TERMINO  CIERRE ARCHIVOS: '.           DISPLAY '------------------------------------------'.           DISPLAY '  '.       FIN-CLOSE-FILE.           EXIT.      *------------------------------------------------------------      *------------------------------------------------------------       ESTADISTICAS SECTION.       INI-ESTADISTICAS.           DISPLAY '-----------------------------------------------'.           DISPLAY '               ESTADISTICAS                    '.           DISPLAY '-----------------------------------------------'.           DISPLAY '  PROGRAMA       :  GNSPDLGM                   '.           DISPLAY '  VERSION        :  V1.0                       '.           DISPLAY '-----------------------------------------------'.           DISPLAY 'REGISTROS LEIDOS            LGM:' WSS-NUM-LLGM.           DISPLAY '-----------------------------------------------'.           DISPLAY 'REGISTROS ENCONTRADOS       LGM:' WSS-NUM-ELGM.           DISPLAY '-----------------------------------------------'.           DISPLAY '-----------------------------------------------'.           DISPLAY 'REGISTROS GRABADOS          LGR:' WSS-NUM-GLGR.           DISPLAY 'REGISTROS GRABADOS          ERR:' WSS-NUM-GLGE.           DISPLAY '-----------------------------------------------'.       FIN-ESTADISTICAS.           EXIT.      *------------------------------------------------------------      *------------------------------------------------------------       COPY GNSBGDTC.       COPY GNSBGBST.       COPY GNSBGIFD.       COPY GNSBFTAB.       COPY GNSBGIDD.       COPY GNSBBSYS.       COPY GNSBFLGE.       COPY GNSBFLGR.       COPY GNSBFMSG.       COPY GNSBFLGM.       COPY GNSBFLGX.       COPY GNSBBMSG.       COPY GNSBBTAB.       COPY GNSBGABT.       COPY GNSBGPES.       COPY GNSBGFEC.       COPY GNSBPFEC.       COPY GNSBGHOY.       COPY GNSBGEND.       COPY GNSBTABT.      *------------------------------------------------