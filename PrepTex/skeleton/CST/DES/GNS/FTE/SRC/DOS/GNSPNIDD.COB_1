       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPNIDD.
       AUTHOR.          CONSIST.

      * Genera en batch registro para el sistema (que acepta por
      * parametro) en archivo IDD

       ENVIRONMENT DIVISION.
      *====================
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSIDD ASSIGN TO GNSIDD
                ORGANIZATION    IS INDEXED
                ACCESS          IS SEQUENTIAL
                RECORD KEY      IS IDD-COD-CIDD
                STATUS          IS FIO-STAT.

       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSIDD
           LABEL RECORDS STANDARD.
       COPY GNSBRIDD.

       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-VARI.
           03 FIO-STAT                          PIC X(02).
              88 FIO-STAT-OKS     VALUE '00'.
           03 WSS-CIDD.
              05 WSS-SIST                       PIC X(03).
              05 WSS-DATA         VALUE 'PPMEN' PIC X(09).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           ACCEPT WSS-SIST.
           DISPLAY 'SISTEMA A PROCESAR : ' WSS-SIST.
           OPEN OUTPUT GNSIDD.
           IF FIO-STAT-OKS
               DISPLAY 'APERTURA OUT OK'
           ELSE
      *        DISPLAY 'ERROR ABRIR  OUT ' FIO-STAT
               OPEN I-O GNSIDD
               IF FIO-STAT-OKS
                   DISPLAY 'APERTURA I-O OK'
               ELSE
                   DISPLAY 'ERROR ABRIR  I-O' FIO-STAT
                   GO TO FIN-MAIN.

           PERFORM CRG-IDD.
           WRITE IDD.
           IF FIO-STAT-OKS
               DISPLAY 'ESCRITURA    OK'
           ELSE
               DISPLAY 'ERROR GRABAR ' FIO-STAT
               GO TO FIN-MAIN.

           CLOSE GNSIDD.
           IF FIO-STAT-OKS
               DISPLAY 'CIERRE       OK'
           ELSE
               DISPLAY 'ERROR CERRAR ' FIO-STAT
               GO TO FIN-MAIN.
       FIN-MAIN.
           STOP RUN.

       CRG-IDD SECTION.
       INI-CRG-IDD.
           MOVE SPACES   TO IDD.
           MOVE WSS-CIDD TO IDD-COD-CIDD.
      *
           MOVE 'GNS'    TO IDD-COD-SIST(1).
           MOVE 'C'      TO IDD-COD-GRPO(1).
           MOVE 'D'      TO IDD-COD-TENT(1).
           MOVE '180'    TO IDD-COD-IENT(1).
      *
           MOVE WSS-SIST TO IDD-COD-SIST(5).
           MOVE 'C'      TO IDD-COD-GRPO(5).
           MOVE 'D'      TO IDD-COD-TENT(5).
           MOVE '150'    TO IDD-COD-IENT(5).
       FIN-CRG-IDD.
           EXIT.
