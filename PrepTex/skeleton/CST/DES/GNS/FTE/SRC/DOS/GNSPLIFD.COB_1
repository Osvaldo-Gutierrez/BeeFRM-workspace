       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPLIFD.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    05-Aug-88 03:59 PM.

      * Programa Listador de Reporte IFD con Sort.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *DOS SELECT RPTIFD         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTIFD         ASSIGN TO        UT-S-RPTIFD.
           SELECT RPTIFD         ASSIGN TO SYS011-UR-1403-S.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY GNSRRIFD.
       FD  RPTIFD LABEL RECORDS OMITTED
           REPORT IS RPT-IFD
           .

       WORKING-STORAGE SECTION.
      *-----------------------
      *ALD
      *COPY GNSBRIFD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSRWIFD.
       COPY GNSWGSYS.
      *<<<< WSS
       01  IFD.
           03  FILLER                                     PIC X(01).
           03  IFD-COD-CIFD                               PIC X(12).
           03  IFD-GLS-DATA                               PIC X(210).
           03  FILLER                                     PIC X(18).
      *>>>>

       REPORT SECTION.
      *--------------
       COPY GNSRFIFD.
           .
       COPY GNSRTIFD.

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-PH-IFD SECTION.
           USE BEFORE REPORTING PH-IFD.
       INI-PH-IFD.
       FIN-PH-IFD.
           EXIT.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'GNSPLIFD' TO FIO-PROG.
           PERFORM BUS-FSIS.
           SORT GNSSRT
       COPY GNSRSIFD.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
       COPY GNSBGGBK.
      *    STOP RUN.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-IFD.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-IFD.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           MOVE IFD-GLS-DATA IN IFD TO IFD-FSIS IN IFD-VARI.

           MOVE IFD-SIST(01) TO SRT-COD-SS01 IN SRT.
           MOVE IFD-SIST(02) TO SRT-COD-SS02 IN SRT.
           MOVE IFD-SIST(03) TO SRT-COD-SS03 IN SRT.

           MOVE IFD-SIST(04) TO SRT-COD-SS04 IN SRT.
           MOVE IFD-SIST(07) TO SRT-COD-SS05 IN SRT.
           MOVE IFD-SIST(10) TO SRT-COD-SS06 IN SRT.
           MOVE IFD-SIST(13) TO SRT-COD-SS07 IN SRT.
           MOVE IFD-SIST(16) TO SRT-COD-SS08 IN SRT.
           MOVE IFD-SIST(19) TO SRT-COD-SS09 IN SRT.
           MOVE IFD-SIST(22) TO SRT-COD-SS10 IN SRT.
           MOVE IFD-SIST(25) TO SRT-COD-SS11 IN SRT.
           MOVE IFD-SIST(28) TO SRT-COD-SS12 IN SRT.

           MOVE IFD-GSIS(01) TO SRT-COD-GS01 IN SRT.
           MOVE IFD-GSIS(02) TO SRT-COD-GS02 IN SRT.
           MOVE IFD-GSIS(03) TO SRT-COD-GS03 IN SRT.
           MOVE IFD-GSIS(04) TO SRT-COD-GS04 IN SRT.
           MOVE IFD-GSIS(05) TO SRT-COD-GS05 IN SRT.
           MOVE IFD-GSIS(06) TO SRT-COD-GS06 IN SRT.
           MOVE IFD-GSIS(07) TO SRT-COD-GS07 IN SRT.
           MOVE IFD-GSIS(08) TO SRT-COD-GS08 IN SRT.
           MOVE IFD-GSIS(09) TO SRT-COD-GS09 IN SRT.
           MOVE IFD-GSIS(10) TO SRT-COD-GS10 IN SRT.
           MOVE IFD-GSIS(11) TO SRT-COD-GS11 IN SRT.
           MOVE IFD-GSIS(12) TO SRT-COD-GS12 IN SRT.
           MOVE IFD-GSIS(13) TO SRT-COD-GS13 IN SRT.
           MOVE IFD-GSIS(14) TO SRT-COD-GS14 IN SRT.
           MOVE IFD-GSIS(15) TO SRT-COD-GS15 IN SRT.
           MOVE IFD-GSIS(16) TO SRT-COD-GS16 IN SRT.
           MOVE IFD-GSIS(17) TO SRT-COD-GS17 IN SRT.
           MOVE IFD-GSIS(18) TO SRT-COD-GS18 IN SRT.
           MOVE IFD-GSIS(19) TO SRT-COD-GS19 IN SRT.
           MOVE IFD-GSIS(20) TO SRT-COD-GS20 IN SRT.
           MOVE IFD-GSIS(21) TO SRT-COD-GS21 IN SRT.
           MOVE IFD-GSIS(22) TO SRT-COD-GS22 IN SRT.
           MOVE IFD-GSIS(23) TO SRT-COD-GS23 IN SRT.
           MOVE IFD-GSIS(24) TO SRT-COD-GS24 IN SRT.
           MOVE IFD-GSIS(25) TO SRT-COD-GS25 IN SRT.
           MOVE IFD-GSIS(26) TO SRT-COD-GS26 IN SRT.
           MOVE IFD-GSIS(27) TO SRT-COD-GS27 IN SRT.
           MOVE IFD-GSIS(28) TO SRT-COD-GS28 IN SRT.
           MOVE IFD-GSIS(29) TO SRT-COD-GS29 IN SRT.
           MOVE IFD-GSIS(30) TO SRT-COD-GS30 IN SRT.
      *>>>>
       MOV-INP-SRT.
       COPY GNSRMIFD.
           RELEASE SRT.
       NXT-INP-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-IFD.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-IFD.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           OPEN OUTPUT RPTIFD.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-IFD.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           IF SRT-COD-SS01 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P01 IN WSS-IFD.
           IF SRT-COD-SS02 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P02 IN WSS-IFD.
           IF SRT-COD-SS03 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P03 IN WSS-IFD.
           IF SRT-COD-SS04 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P04 IN WSS-IFD.
           IF SRT-COD-SS05 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P05 IN WSS-IFD.
           IF SRT-COD-SS06 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P06 IN WSS-IFD.
           IF SRT-COD-SS07 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P07 IN WSS-IFD.
           IF SRT-COD-SS08 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P08 IN WSS-IFD.
           IF SRT-COD-SS09 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P09 IN WSS-IFD.
           IF SRT-COD-SS10 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P10 IN WSS-IFD.
           IF SRT-COD-SS11 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P11 IN WSS-IFD.
           IF SRT-COD-SS12 IN SRT > SPACES
               MOVE ':' TO WSS-GLS-2P12 IN WSS-IFD.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-IFD.
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
           TERMINATE RPT-IFD.
           CLOSE RPTIFD.

      *ALD
      *COPY GNSIOIFD.
       COPY GNSBFIFD.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.

      *<<<< EOF
      *>>>>
