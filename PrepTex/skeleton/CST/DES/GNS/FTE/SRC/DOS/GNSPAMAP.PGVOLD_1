       IDENTIFICATION DIVISION.      *========================       PROGRAM-ID. ^pgm^.       AUTHOR.     ^aut^.      * ACTUALIZA ARCHIVO ^reg^ EN FORMA INTERACTIVA.       ENVIRONMENT DIVISION.      *=====================       DATA DIVISION.      *==============       WORKING-STORAGE SECTION.      *------------------------       COPY ^sio^BR^reg^.       COPY ^sfr^WI^frm^.^cpy^^for^       COPY GNSBRMSG.       COPY GNSBRMSC.       COPY GNSWGFIO.       COPY GNSWGFRM.       COPY GNSWGSCR.*% INCLUDE FIN_SCR_VARI OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_VARI OF '^pgm^.GEN'.       COPY GNSWGNUM.*% INCLUDE WSS OF '^pgm^.TXT'.*% INCLUDE WSS OF '^pgm^.GEN'.*% INCLUDE WSS_IBM OF '^pgm^.TXT'.*% INCLUDE WSS_IBM OF '^pgm^.GEN'.       LINKAGE SECTION.      *----------------       01  DFHCOMMAREA.*% IF NOT CMA_USR THEN           02 FILLER                  PIC X(900).*% ELSE*% INCLUDE CMA OF '^pgm^.TXT'.*% INCLUDE CMA OF '^pgm^.GEN'.*% END IF       COPY GNSLGFIO.       PROCEDURE DIVISION.      *===================       MAIN SECTION.       INI-MAIN.           PERFORM INI.       LUP-MAIN.           IF SCR-INST = SCR-INST-HCM                 PERFORM SCR-COM.           IF SCR-CCPP = 'MOD'                 PERFORM SCR-MOD           ELSE           IF SCR-CCPP = 'ING'                 PERFORM SCR-ING           ELSE           IF SCR-CCPP = 'ACC'                 PERFORM SCR-ACC           ELSE           IF SCR-CCPP = 'ELI'                 PERFORM SCR-ELI           ELSE           IF SCR-CCPP = 'ACT'                 PERFORM SCR-ACT           ELSE                 PERFORM SCR-PGM.*% INCLUDE FIN_LUP_MAIN OF '^pgm^.TXT'.*% INCLUDE FIN_LUP_MAIN OF '^pgm^.GEN'.           GO TO LUP-MAIN.       FIN-MAIN.           EXIT.       INI SECTION.       INI-INI.           IF EIBCALEN = 0                 GOBACK.           PERFORM CIC-ERR THRU FIN-CIC-ERR.           MOVE DFHCOMMAREA TO SCR-VARI.*% INCLUDE INI_FIO OF '^pgm^.TXT'.*% INCLUDE INI_FIO OF '^pgm^.GEN'.       FIN-INI.           EXIT.       SCR-COM SECTION.       INI-SCR-COM.           PERFORM PRO-ALL.           PERFORM SCR-CLRA.           PERFORM SCR-PUTA.           MOVE SCR-INST-HCM TO SCR-INST.           MOVE SCR-CMNP     TO FRM-PROG.           MOVE SCR-VARI     TO FRM-CMMA.           MOVE SCR-TCMA     TO FRM-TCMA.           MOVE FRM-XCT      TO FRM-CMND.           PERFORM GNS-PRO-FRM.           MOVE FRM-CLR-FRM  TO FRM-CMND.           PERFORM GNS-PRO-FRM.           MOVE 'XCTERR    ' TO MSG-COD-MENS.           MOVE 'GNS'        TO MSG-COD-SIST.           PERFORM GET-MSG.           MOVE MSG-GLS-DESC TO FRM-MENS           MOVE FRM-MSG      TO FRM-CMND.           PERFORM GNS-PRO-FRM.           GOBACK.       FIN-SCR-COM.           EXIT.       SCR-MOD SECTION.       INI-SCR-MOD.*% INCLUDE INI_SCR_MOD OF '^pgm^.TXT'.*% INCLUDE INI_SCR_MOD OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-KEY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-KEY                IF SCR-STAT NOT = SCR-STAT-ABT                        PERFORM SCR-TRL                ELSE                        PERFORM DESSCRTRL                        GO TO FIN-SCR-MOD           ELSE           IF SCR-INST = SCR-INST-GFL                PERFORM GET-FLD           ELSE           IF SCR-INST = SCR-INST-GCS                PERFORM GET-ACC           ELSE           IF SCR-INST = SCR-INST-GAB                PERFORM GET-CON.           PERFORM DESSCRTRL.       MSG-SCR-MOD.           IF SCR-STAT = SCR-STAT-CON               MOVE SPACES TO FRM-MENS           ELSE           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT               MOVE 'MODNOT    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS           ELSE                PERFORM CMN-MOD                IF FIO-STAT-OKS                    MOVE 'MODYES    ' TO MSG-COD-MENS                    MOVE 'GNS' TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS                ELSE                    MOVE 'FIOSTAT' TO MSG-COD-TMSG                    MOVE FIO-STAT  TO MSG-COD-CMSG                    MOVE 'GNS'     TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS.           PERFORM SCR-MSSG.       FIN-SCR-MOD.*% INCLUDE FIN_SCR_MOD OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_MOD OF '^pgm^.GEN'.           EXIT.       SCR-ING SECTION.       INI-SCR-ING.*% INCLUDE INI_SCR_ING OF '^pgm^.TXT'.*% INCLUDE INI_SCR_ING OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-IKY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-RST                PERFORM GET-IKY                IF NOT FRM-STAT-ABT                        PERFORM FND-KEY                        IF NOT FIO-STAT-OKS                              PERFORM SCR-TRL                        ELSE                            MOVE 'REGEXI    ' TO MSG-COD-MENS                            MOVE 'GNS' TO MSG-COD-SIST                            PERFORM GET-MSG                            MOVE MSG-GLS-DESC TO FRM-MENS                            PERFORM SCR-MSSG                            MOVE SCR-STAT-ABT TO SCR-STAT                            PERFORM DESSCRTRL                            GO TO FIN-SCR-ING                ELSE                        MOVE SPACES TO FRM-MENS                        PERFORM SCR-MSSG                        PERFORM DESSCRTRL                        GO TO FIN-SCR-ING           ELSE           IF SCR-INST = SCR-INST-GFL                PERFORM GET-FLD           ELSE           IF SCR-INST = SCR-INST-GCS                PERFORM GET-ACC           ELSE           IF SCR-INST = SCR-INST-GAB                PERFORM GET-CON.           PERFORM DESSCRTRL.       MSG-SCR-ING.           IF SCR-STAT = SCR-STAT-CON               MOVE SPACES TO FRM-MENS           ELSE           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT               MOVE 'INGNOT    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS           ELSE                PERFORM CMN-ING                IF FIO-STAT-OKS                    MOVE 'INGYES    ' TO MSG-COD-MENS                    MOVE 'GNS' TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS                ELSE                    MOVE 'FIOSTAT' TO MSG-COD-TMSG                    MOVE FIO-STAT  TO MSG-COD-CMSG                    MOVE 'GNS'     TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS.           PERFORM SCR-MSSG.       FIN-SCR-ING.*% INCLUDE FIN_SCR_ING OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_ING OF '^pgm^.GEN'.           EXIT.       SCR-ACC SECTION.       INI-SCR-ACC.*% INCLUDE INI_SCR_ACC OF '^pgm^.TXT'.*% INCLUDE INI_SCR_ACC OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-KEY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-KEY                IF SCR-STAT NOT = SCR-STAT-ABT                        PERFORM SCR-TRL                ELSE                        PERFORM DESSCRTRL                        GO TO FIN-SCR-ACC           ELSE           IF SCR-INST = SCR-INST-GFL                PERFORM GET-FLD           ELSE           IF SCR-INST = SCR-INST-GCS                PERFORM GET-ACC           ELSE           IF SCR-INST = SCR-INST-GAB                PERFORM GET-CON.           PERFORM DESSCRTRL.           MOVE SPACES TO FRM-MENS.           IF SCR-STAT NOT = SCR-STAT-CON               PERFORM CMN-ACC.           PERFORM SCR-MSSG.       FIN-SCR-ACC.*% INCLUDE FIN_SCR_ACC OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_ACC OF '^pgm^.GEN'.           EXIT.       SCR-ELI SECTION.       INI-SCR-ELI.*% INCLUDE INI_SCR_ELI OF '^pgm^.TXT'.*% INCLUDE INI_SCR_ELI OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-KEY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-KEY                IF SCR-STAT NOT = SCR-STAT-ABT                        PERFORM SCR-TRL                ELSE                        PERFORM DESSCRTRL                        GO TO FIN-SCR-ELI           ELSE           IF SCR-INST = SCR-INST-GCS                PERFORM GET-ACC           ELSE           IF SCR-INST = SCR-INST-GAB                PERFORM GET-CON.           PERFORM DESSCRTRL.           IF SCR-STAT = SCR-STAT-CON               MOVE SPACES TO FRM-MENS           ELSE           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT               MOVE 'ELINOT    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS           ELSE                PERFORM CMN-ELI                IF FIO-STAT-OKS                    MOVE 'ELIYES    ' TO MSG-COD-MENS                    MOVE 'GNS' TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS                ELSE                    MOVE 'FIOSTAT' TO MSG-COD-TMSG                    MOVE FIO-STAT  TO MSG-COD-CMSG                    MOVE 'GNS'     TO MSG-COD-SIST                    PERFORM GET-MSG                    MOVE MSG-GLS-DESC TO FRM-MENS.           PERFORM SCR-MSSG.       FIN-SCR-ELI.*% INCLUDE FIN_SCR_ELI OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_ELI OF '^pgm^.GEN'.           EXIT.       SCR-ACT SECTION.       INI-SCR-ACT.*% INCLUDE INI_SCR_ACT OF '^pgm^.TXT'.*% INCLUDE INI_SCR_ACT OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-KEY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-RST                PERFORM GET-KEY                IF NOT FRM-STAT-ABT                        PERFORM FND-KEY                        IF FIO-STAT-OKS                              MOVE SCR-ACTU-MOD TO SCR-ACTU                              PERFORM PUT-SCR                              PERFORM SCR-TRL                        ELSE                        IF FIO-STAT-EOF                              MOVE 'REGEOF    ' TO MSG-COD-MENS                              MOVE 'GNS' TO MSG-COD-SIST                              PERFORM GET-MSG                              MOVE MSG-GLS-DESC TO FRM-MENS                              PERFORM SCR-MSSG                              MOVE SCR-STAT-ABT TO SCR-STAT                              PERFORM DESSCRTRL                              GO TO FIN-SCR-ACT                        ELSE                        IF FIO-STAT = FIO-STAT-NEX                              MOVE 'REGNEX    ' TO MSG-COD-MENS                              MOVE 'GNS' TO MSG-COD-SIST                              PERFORM GET-MSG                              MOVE MSG-GLS-DESC TO FRM-MENS                              PERFORM SCR-MSSG                              MOVE SCR-STAT-ABT TO SCR-STAT                              PERFORM DESSCRTRL                              GO TO FIN-SCR-ACT                        ELSE                              MOVE SCR-ACTU-ING TO SCR-ACTU                              PERFORM SCR-TRL                ELSE                        MOVE SPACES TO FRM-MENS                        PERFORM SCR-MSSG                        PERFORM DESSCRTRL                        GO TO FIN-SCR-ACT           ELSE           IF SCR-INST = SCR-INST-GFL                PERFORM GET-FLD           ELSE           IF SCR-INST = SCR-INST-GCS                PERFORM GET-ACC           ELSE           IF SCR-INST = SCR-INST-GAB                PERFORM GET-CON.           PERFORM DESSCRTRL.           IF SCR-ACTU = SCR-ACTU-MOD                  PERFORM MSG-SCR-MOD           ELSE                  PERFORM MSG-SCR-ING.       FIN-SCR-ACT.*% INCLUDE FIN_SCR_ACT OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_ACT OF '^pgm^.GEN'.           EXIT.       SCR-PGM SECTION.       INI-SCR-PGM.*% INCLUDE INI_SCR_PGM OF '^pgm^.TXT'.*% INCLUDE INI_SCR_PGM OF '^pgm^.GEN'.           IF SCR-INST = SCR-INST-HKY                MOVE SCR-INST-GKY TO SCR-INST                PERFORM HBL-KEY                PERFORM SCR-CLRA                PERFORM SCR-PUTA                PERFORM SCR-EXIT           ELSE           IF SCR-INST = SCR-INST-GKY                PERFORM SCR-RST                PERFORM GET-KEY                IF FRM-STAT-ABT                        MOVE SPACES TO FRM-MENS                        PERFORM SCR-MSSG                        PERFORM DESSCRTRL                        GO TO FIN-SCR-PGM.           PERFORM FND-KEY.*% INCLUDE SCR_PGM OF '^pgm^.TXT'.*% INCLUDE SCR_PGM OF '^pgm^.GEN'.       TRL-SCR-PGM.           PERFORM DESSCRTRL.           MOVE SPACES TO FRM-MENS.           IF SCR-STAT NOT = SCR-STAT-CON               PERFORM CMN-PGM.           PERFORM SCR-MSSG.       FIN-SCR-PGM.*% INCLUDE FIN_SCR_PGM OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_PGM OF '^pgm^.GEN'.           EXIT.       SCR-KEY SECTION.       INI-SCR-KEY.           PERFORM SCR-RST.           PERFORM GET-KEY.           IF FRM-STAT-ABT                   MOVE SPACES TO FRM-MENS                   PERFORM SCR-MSSG                   GO TO FIN-SCR-KEY.           MOVE SPACES TO FRM-MENS.           PERFORM FND-KEY.           IF FIO-STAT-OKS                   PERFORM PUT-SCR                   GO TO FIN-SCR-KEY.        ERR-SCR-KEY.           IF FRM-MENS NOT > SPACES               IF FIO-STAT-EOF                   MOVE 'REGEOF    ' TO MSG-COD-MENS                   MOVE 'GNS' TO MSG-COD-SIST                   PERFORM GET-MSG                   MOVE MSG-GLS-DESC TO FRM-MENS               ELSE                   MOVE 'REGNEX    ' TO MSG-COD-MENS                   MOVE 'GNS' TO MSG-COD-SIST                   PERFORM GET-MSG                   MOVE MSG-GLS-DESC TO FRM-MENS.           PERFORM SCR-MSSG.           MOVE SCR-STAT-ABT TO SCR-STAT.        FIN-SCR-KEY.           EXIT.       SCR-RST SECTION.       INI-SCR-RST.           MOVE SPACES       TO SCR-STAT.           MOVE SCR-MFLD-NOT TO SCR-MFLD.           MOVE LOW-VALUES   TO ^frm^-FLD.*% INCLUDE SCR_RST OF '^pgm^.TXT'.*% INCLUDE SCR_RST OF '^pgm^.GEN'.       FIN-SCR-RST.           EXIT.       GET-KEY SECTION.       INI-GET-KEY.*% INCLUDE GET_KEY OF '^pgm^.TXT'.*% INCLUDE GET_KEY OF '^pgm^.GEN'.           PERFORM SCR-GKEY.           IF FRM-STAT-ABT               MOVE SCR-STAT-ABT TO SCR-STAT.       FIN-GET-KEY.           EXIT.       GET-IKY SECTION.       INI-GET-IKY.*% INCLUDE GET_IKY OF '^pgm^.TXT'.*% INCLUDE GET_IKY OF '^pgm^.GEN'.           PERFORM SCR-GIKY.           IF FRM-STAT-ABT               MOVE SCR-STAT-ABT TO SCR-STAT.       FIN-GET-IKY.           EXIT.       FND-KEY SECTION.       INI-FND-KEY.*% INCLUDE INI_FND_KEY OF '^pgm^.TXT'.*% INCLUDE INI_FND_KEY OF '^pgm^.GEN'.           PERFORM KEY-ALL.*% INCLUDE FND_KEY OF '^pgm^.TXT'.*% INCLUDE FND_KEY OF '^pgm^.GEN'.           MOVE FIO-GET-KEY TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.*% INCLUDE FIN_FND_KEY OF '^pgm^.TXT'.*% INCLUDE FIN_FND_KEY OF '^pgm^.GEN'.       FIN-FND-KEY.           EXIT.       PUT-SCR SECTION.       INI-PUT-SCR.*% INCLUDE PUT_SCR OF '^pgm^.TXT'.*% INCLUDE PUT_SCR OF '^pgm^.GEN'.           PERFORM PUT-ALL.       FIN-PUT-SCR.           EXIT.       GET-FLD SECTION.       INI-GET-FLD.*% INCLUDE GET_FLD OF '^pgm^.TXT'.*% INCLUDE GET_FLD OF '^pgm^.GEN'.           PERFORM SCR-GFLD.           IF FRM-STAT-ABT               MOVE SCR-STAT-ABT TO SCR-STAT.       FIN-GET-FLD.           EXIT.       CMN-MOD SECTION.       INI-CMN-MOD.*% INCLUDE INI_CMN_MOD OF '^pgm^.TXT'.*% INCLUDE INI_CMN_MOD OF '^pgm^.GEN'.           PERFORM KEY-ALL.           MOVE FIO-GET-KEY-UPD TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.           IF NOT FIO-STAT-OKS               GO TO FIN-CMN-MOD.           PERFORM RET-ALL.*% INCLUDE CMN_MOD OF '^pgm^.TXT'.*% INCLUDE CMN_MOD OF '^pgm^.GEN'.           MOVE FIO-MOD TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.*% INCLUDE FIN_CMN_MOD OF '^pgm^.TXT'.*% INCLUDE FIN_CMN_MOD OF '^pgm^.GEN'.       FIN-CMN-MOD.           EXIT.       CMN-ING SECTION.       INI-CMN-ING.*% INCLUDE INI_CMN_ING OF '^pgm^.TXT'.*% INCLUDE INI_CMN_ING OF '^pgm^.GEN'.           PERFORM RET-ALL.*% INCLUDE CMN_ING OF '^pgm^.TXT'.*% INCLUDE CMN_ING OF '^pgm^.GEN'.           MOVE FIO-PUT TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.*% INCLUDE FIN_CMN_ING OF '^pgm^.TXT'.*% INCLUDE FIN_CMN_ING OF '^pgm^.GEN'.       FIN-CMN-ING.           EXIT.       CMN-ACC SECTION.       INI-CMN-ACC.*% INCLUDE INI_CMN_ACC OF '^pgm^.TXT'.*% INCLUDE INI_CMN_ACC OF '^pgm^.GEN'.           PERFORM KEY-ALL.           MOVE FIO-GET-KEY-UPD TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.           IF NOT FIO-STAT-OKS               GO TO FIN-CMN-ACC.           PERFORM RET-ALL.*% INCLUDE CMN_ACC OF '^pgm^.TXT'.*% INCLUDE CMN_ACC OF '^pgm^.GEN'.       FIN-CMN-ACC.           EXIT.       CMN-ELI SECTION.       INI-CMN-ELI.*% INCLUDE INI_CMN_ELI OF '^pgm^.TXT'.*% INCLUDE INI_CMN_ELI OF '^pgm^.GEN'.           PERFORM RET-ALL.*% INCLUDE CMN_ELI OF '^pgm^.TXT'.*% INCLUDE CMN_ELI OF '^pgm^.GEN'.           MOVE FIO-DEL TO FIO-CMND.           PERFORM ^sio^-FIO-^reg^.*% INCLUDE FIN_CMN_ELI OF '^pgm^.TXT'.*% INCLUDE FIN_CMN_ELI OF '^pgm^.GEN'.       FIN-CMN-ELI.           EXIT.       CMN-PGM SECTION.       INI-CMN-PGM.*% INCLUDE INI_CMN_PGM OF '^pgm^.TXT'.*% INCLUDE INI_CMN_PGM OF '^pgm^.GEN'.           PERFORM RET-ALL.*% INCLUDE CMN_PGM OF '^pgm^.TXT'.*% INCLUDE CMN_PGM OF '^pgm^.GEN'.       FIN-CMN-PGM.           EXIT.       SCR-EXIT SECTION.       INI-SCR-EXIT.           MOVE SCR-NTRN TO FRM-NTRN.           MOVE SCR-VARI TO FRM-CMMA.           MOVE SCR-TCMA TO FRM-TCMA.           MOVE FRM-EXT  TO FRM-CMND.           PERFORM GNS-PRO-FRM.       FIN-SCR-EXIT.           EXIT.       SCR-PUTA SECTION.       INI-SCR-PUTA.           PERFORM EDT-FORM-^frm^.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE ^frm^-FLD TO FRM-DFLD.           MOVE FRM-PUT-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.       FIN-SCR-PUTA.           EXIT.       SCR-MSSG SECTION.       INI-SCR-MSSG.           MOVE FRM-MENS TO ^frm^-GLS-MENS.       FIN-SCR-MSSG.           EXIT.       SCR-GKEY SECTION.       INI-SCR-GKEY.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           MOVE SPACES TO FRM-MENS.           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )*% INCLUDE PFS_SCR_GKEY OF '^pgm^.TXT'.*% INCLUDE PFS_SCR_GKEY OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               PERFORM FST-KEY               GO TO ERR-SCR-GKEY.           MOVE FRM-DFLD TO ^frm^-FLD.           IF FRM-STAT-ABT               GO TO FIN-SCR-GKEY.           MOVE FRM-SUAR-OKS TO FRM-SUAR.*% INCLUDE SCR_GKEY_VAL_CON_KEY OF '^pgm^.TXT'.*% INCLUDE SCR_GKEY_VAL_CON_KEY OF '^pgm^.GEN'.           PERFORM VAL-CON-KEY.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               PERFORM FST-KEY               GO TO ERR-SCR-GKEY.*% INCLUDE SCR_GKEY_VAL_IKY OF '^pgm^.TXT'.*% INCLUDE SCR_GKEY_VAL_IKY OF '^pgm^.GEN'.           PERFORM VAL-IKY.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               GO TO ERR-SCR-GKEY.*% INCLUDE SCR_GKEY_VAL_MKY OF '^pgm^.TXT'.*% INCLUDE SCR_GKEY_VAL_MKY OF '^pgm^.GEN'.           PERFORM VAL-MKY.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               GO TO ERR-SCR-GKEY.*% INCLUDE SCR_GKEY_VAL_AKY OF '^pgm^.TXT'.*% INCLUDE SCR_GKEY_VAL_AKY OF '^pgm^.GEN'.           PERFORM VAL-AKY.           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )               GO TO FIN-SCR-GKEY.       ERR-SCR-GKEY.           PERFORM SCR-MSSG.           PERFORM SCR-PUTA.           PERFORM SCR-EXIT.       FIN-SCR-GKEY.*% INCLUDE FIN_SCR_GKEY OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_GKEY OF '^pgm^.GEN'.           PERFORM SCR-MSSG.       SCR-GIKY SECTION.       INI-SCR-GIKY.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           MOVE SPACES TO FRM-MENS.           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )*% INCLUDE PFS_SCR_GIKY OF '^pgm^.TXT'.*% INCLUDE PFS_SCR_GIKY OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               PERFORM FST-KEY               GO TO ERR-SCR-GIKY.           MOVE FRM-DFLD TO ^frm^-FLD.           IF FRM-STAT-ABT               GO TO FIN-SCR-GIKY.           MOVE FRM-SUAR-OKS TO FRM-SUAR.*% INCLUDE SCR_GIKY_VAL_CON_IKY OF '^pgm^.TXT'.*% INCLUDE SCR_GIKY_VAL_CON_IKY OF '^pgm^.GEN'.           PERFORM VAL-CON-IKY.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               PERFORM FST-KEY               GO TO ERR-SCR-GIKY.*% INCLUDE SCR_GIKY_VAL_IKY OF '^pgm^.TXT'.*% INCLUDE SCR_GIKY_VAL_IKY OF '^pgm^.GEN'.           PERFORM VAL-IKY.           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )               GO TO FIN-SCR-GIKY.       ERR-SCR-GIKY.           PERFORM SCR-MSSG.           PERFORM SCR-PUTA.           PERFORM SCR-EXIT.       FIN-SCR-GIKY.*% INCLUDE FIN_SCR_GIKY OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_GIKY OF '^pgm^.GEN'.           PERFORM SCR-MSSG.       SCR-GFLD SECTION.       INI-SCR-GFLD.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           MOVE SPACES TO FRM-MENS.           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )*% INCLUDE PFS_SCR_GFLD OF '^pgm^.TXT'.*% INCLUDE PFS_SCR_GFLD OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               PERFORM FST-FLD               GO TO ERR-SCR-GFLD.           MOVE FRM-DFLD TO ^frm^-FLD.           IF FRM-STAT-ABT               GO TO FIN-SCR-GFLD.           MOVE FRM-SUAR-OKS TO FRM-SUAR.*% INCLUDE SCR_GFLD_VAL_FLD OF '^pgm^.TXT'.*% INCLUDE SCR_GFLD_VAL_FLD OF '^pgm^.GEN'.           PERFORM VAL-FLD.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               GO TO ERR-SCR-GFLD.*% INCLUDE SCR_GFLD_VAL_MKY OF '^pgm^.TXT'.*% INCLUDE SCR_GFLD_VAL_MKY OF '^pgm^.GEN'.           PERFORM VAL-MKY.           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR               GO TO ERR-SCR-GFLD.*% INCLUDE SCR_GFLD_VAL_CON_FLD OF '^pgm^.TXT'.*% INCLUDE SCR_GFLD_VAL_CON_FLD OF '^pgm^.GEN'.           PERFORM VAL-CON-FLD.           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )               GO TO FIN-SCR-GFLD.           PERFORM FST-FLD.       ERR-SCR-GFLD.           PERFORM SCR-MSSG.           PERFORM SCR-PUTA.           PERFORM SCR-EXIT.       FIN-SCR-GFLD.*% INCLUDE FIN_SCR_GFLD OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_GFLD OF '^pgm^.GEN'.           PERFORM SCR-MSSG.       GET-ACC SECTION.       INI-GET-ACC.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )*% INCLUDE PFS_GET_ACC OF '^pgm^.TXT'.*% INCLUDE PFS_GET-ACC OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC          TO ^frm^-GLS-MEN2               MOVE SCR-GLS-PRMT( SCR-I ) TO ^frm^-GLS-MEN1               PERFORM FST-MSG               PERFORM SCR-PUTA               PERFORM SCR-EXIT.           MOVE FRM-DFLD TO ^frm^-FLD.*% INCLUDE FIN_GET_ACC OF '^pgm^.TXT'.*% INCLUDE FIN_GET-ACC OF '^pgm^.GEN'.       FIN-GET-ACC.           EXIT.       GET-CON SECTION.       INI-GET-CON.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           IF NOT ( FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF3 )*% INCLUDE PFS_GET_CON OF '^pgm^.TXT'.*% INCLUDE PFS_GET-CON OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC          TO ^frm^-GLS-MEN2               MOVE SCR-GLS-PRMT( SCR-I ) TO ^frm^-GLS-MEN1               PERFORM FST-MSG               PERFORM SCR-PUTA               PERFORM SCR-EXIT.           MOVE FRM-DFLD TO ^frm^-FLD.*% INCLUDE FIN_GET_CON OF '^pgm^.TXT'.*% INCLUDE FIN_GET-CON OF '^pgm^.GEN'.       FIN-GET-CON.           EXIT.       CLR-MSG SECTION.       INI-CLR-MSG.           MOVE SPACES TO ^frm^-GLS-MENS.       FIN-CLR-MSG.           EXIT.       HBL-IKY SECTION.       INI-HBL-IKY.           PERFORM PRO-FLD.           PERFORM PRO-MKY.           PERFORM PRO-AKY.           PERFORM UNP-IKY.           PERFORM FST-KEY.       FIN-HBL-IKY.           EXIT.       HBL-KEY SECTION.       INI-HBL-KEY.           PERFORM PRO-FLD.           PERFORM UNP-KEY.           PERFORM FST-KEY.       FIN-HBL-KEY.           EXIT.       HBL-FLD SECTION.       INI-HBL-FLD.*% INCLUDE INI_HBL_FLD OF '^pgm^.TXT'.*% INCLUDE INI_HBL_FLD OF '^pgm^.GEN'.           PERFORM PRO-IKY.           PERFORM PRO-AKY.           PERFORM UNP-MKY.           PERFORM UNP-FLD.           PERFORM FST-FLD.*% INCLUDE FIN_HBL_FLD OF '^pgm^.TXT'.*% INCLUDE FIN_HBL_FLD OF '^pgm^.GEN'.       FIN-HBL-FLD.           EXIT.       FST-MSG SECTION.       INI-FST-MSG.           MOVE -1 TO ^frm^-GLS-MENS-LEN.       FIN-FST-MSG.           EXIT.       PRO-ALL SECTION.       INI-PRO-ALL.           PERFORM PRO-KEY.           PERFORM PRO-FLD.           PERFORM FST-MSG.       FIN-PRO-ALL.           EXIT.       SCR-TRL SECTION.       INI-SCR-TRL.*% INCLUDE INI_SCR_TRL OF '^pgm^.TXT'.*% INCLUDE INI_SCR-TRL OF '^pgm^.GEN'.           MOVE SCR-STPP TO SCR-STAT.           MOVE SCR-GLS-PRMT( SCR-I ) TO FRM-MENS.*% INCLUDE FIN_SCR_TRL OF '^pgm^.TXT'.*% INCLUDE FIN_SCR-TRL OF '^pgm^.GEN'.           IF SCR-STAT = SCR-STAT-MOD               MOVE SCR-INST-GFL TO SCR-INST               PERFORM HBL-FLD               PERFORM SCR-MSSG               PERFORM SCR-PUTA               PERFORM SCR-EXIT.           IF SCR-STAT = SCR-STAT-SON               MOVE SCR-INST-GCS TO SCR-INST               PERFORM PRO-ALL               PERFORM SCR-MSSG               PERFORM SCR-PUTA               PERFORM SCR-EXIT.      *ASUME SCR-STAT-CON.           MOVE SCR-STAT-CON TO SCR-STAT.           MOVE SCR-INST-GAB TO SCR-INST.           PERFORM PRO-ALL.           PERFORM SCR-MSSG.           PERFORM SCR-PUTA.           PERFORM SCR-EXIT.       FIN-SCR-TRL.           EXIT.       DESSCRTRL SECTION.       INI-DESSCRTRL.           IF SCR-INST = SCR-INST-GCF                  PERFORM SCR-GCNF                  GO TO FIN-DESSCRTRL.           MOVE SCR-VFLD-NOT TO SCR-VFLD.           MOVE FRM-FFLD TO SCR-FFLD.           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON                  GO TO FIN-DESSCRTRL.           IF SCR-FFLD-RET OR SCR-FFLD-PF10                  MOVE SCR-VFLD-YES TO SCR-VFLD                  PERFORM PRO-CONF.       FIN-DESSCRTRL.           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3                 MOVE SCR-INST-HCM TO SCR-INST           ELSE                 MOVE SCR-INST-HKY TO SCR-INST.       EXT-DESSCRTRL.           EXIT.       PRO-CONF SECTION.       INI-PRO-CONF.           IF SCR-GLS-CONF( SCR-I ) NOT > SPACES                  GO TO FIN-PRO-CONF.      *JSS      *    MOVE 'PFSCNF' TO MSG-COD-MENS.      *    MOVE 'GNS'    TO MSG-COD-SIST.      *    PERFORM GET-MSG.      *    STRING MSG-GLS-DESC MSG-GLS-MENS DELIMITED BY SIZE      *        INTO ^frm^-GLS-TERM.           MOVE SCR-INST-GCF TO SCR-INST.           MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MENS.           PERFORM SCR-MSSG.           PERFORM PRO-KEY.           PERFORM PRO-FLD.           PERFORM FST-MSG.           PERFORM SCR-PUTA.           PERFORM SCR-EXIT.       FIN-PRO-CONF.           EXIT.       SCR-GCNF SECTION.       INI-SCR-GCNF.           MOVE SCR-NMAP TO FRM-NAME.           MOVE SCR-NLIB TO FRM-NLIB.           MOVE FRM-GET-ALL TO FRM-CMND.           PERFORM GNS-PRO-FRM.           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR                               FRM-FFLD-PF4 )*% INCLUDE PFS_SCR_GCNF OF '^pgm^.TXT'.*% INCLUDE PFS_SCR_GCNF OF '^pgm^.GEN'.               MOVE 'PFSINV    ' TO MSG-COD-MENS               MOVE 'GNS' TO MSG-COD-SIST               PERFORM GET-MSG               MOVE MSG-GLS-DESC          TO ^frm^-GLS-MEN2               MOVE SCR-GLS-CONF( SCR-I ) TO ^frm^-GLS-MEN1               PERFORM FST-MSG               PERFORM SCR-PUTA               PERFORM SCR-EXIT.           MOVE FRM-DFLD TO ^frm^-FLD.           MOVE FRM-FFLD TO SCR-FFLD.           IF FRM-FFLD = FRM-FFLD-PF3               MOVE SCR-VFLD-NOT TO SCR-VFLD           ELSE           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4               MOVE SCR-VFLD-YES TO SCR-VFLD           ELSE           IF FRM-FFLD = FRM-FFLD-PF12               MOVE SCR-STPP TO SCR-STAT               IF SCR-STAT = SCR-STAT-MOD                   PERFORM SCR-TRL               ELSE                   MOVE SCR-VFLD-NOT TO SCR-VFLD.*% INCLUDE FIN_SCR_GCNF OF '^pgm^.TXT'.*% INCLUDE FIN_SCR_GCNF OF '^pgm^.GEN'.       FIN-SCR-GCNF.           EXIT.       COPY ^sfr^BM^frm^.       COPY ^sio^BF^reg^.       COPY GNSBFMSC.       COPY GNSBFMSG.       COPY GNSBECIC.       COPY GNSBGFIO.       COPY GNSBGFRM.       COPY GNSBGMSG.       COPY GNSBEKEY.       COPY GNSBVNUM.*% INCLUDE EOF OF '^pgm^.TXT'.*% INCLUDE EOF OF '^pgm^.GEN'.*% INCLUDE EOF_IBM OF '^pgm^.TXT'.*% INCLUDE EOF_IBM OF '^pgm^.GEN'.