       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GNSPPSGO.
       AUTHOR. CONSIST.
       DATE-WRITTEN. 3-JUN-1996 16:19:28
      *
      * TRANSACCION = GSGO
      * Programa Segmentador para Respuesta del Host al PC
      *
      *-----------------------------------------------------------------
      *  MODIFICACIONES:
      *  ---------------
      *  AUTOR      : Cima-Ivan Silva
      *  FECHA      : 2013-10-02 
      *  ETIQUETA   : Cima-INI 02-OCT-2013 LOG MTI
      *  PROYECTO   : Log MTI
      *  CAMBIOS    : 1. Incorpora grabacion LOG MTI
      *-----------------------------------------------------------------

       ENVIRONMENT DIVISION.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *========================
       77  WSS-TAG-GNSPOLGM PIC X(0125) VALUE
           '<IDNPGM NOM=$GNSPOLGM$ VSN=$08.08.20$ GEN=$17-08-05
      -    '19:36$ FNC=$080817$/>'.

       COPY GNSWGTSK.
       COPY GNSWGHOY.
       COPY GNSWGSYS.

      * Cima-INI 02-OCT-2013 LOG MTI
       COPY GNSBRLGM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LGM-REQA==.

      * Cima-FIN 02-OCT-2013 LOG MTI
       COPY GNSBRTAB.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.

       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
      *
       77  WSS-IND-SIST    VALUE SPACES PIC X(03).
       77  WSS-IDN-IOPC    VALUE SPACES PIC X(12).
       01  WSS-SEND VALUE SPACES.
           03 WSS-HEAD-SEND.
      *          Status Respuesta 0=OK ; 1=ERR
              05 WSS-RES-STAT                         PIC X(0001).
      *          Fecha Transaccion
              05 WSS-FEC-FTRN                         PIC X(0008).
      *          Hora Transaccion
              05 WSS-HRS-HTRN                         PIC X(0006).
      *          Indicador Mensajes Pendientes 0=NO ; 1=SI
              05 WSS-IND-MSGP                         PIC X(0001).
      *          Largo de la parte Variable del Mensaje
              05 WSS-NUM-LENM                         PIC 9(0005).
      *          Codigo Transaccion
              05 WSS-COD-TRAN                         PIC X(0008).
      *          Codigo Sistema
              05 WSS-COD-SIST                         PIC X(0003).
      *          Codigo Usuario
              05 WSS-COD-USER                         PIC X(0012).
      *          Password
              05 WSS-COD-PASS                         PIC X(0008).
      *          MENSAJE RESPUESTA LDC/COL
           03 WSS-GLS-RESP.
      *          Filler Vacio y Fijo de 111 Caracteres
              05 WSS-GLS-FILL                         PIC X(0111).
      *          DATA a ser transmitida de OUTPUT
              05 WSS-GLS-DOUT                         PIC X(1088).
      *
       77  WSS-MSG-OKS          VALUE '0'             PIC X(1024).

       01  TSIDENT.
           05 TRANS                    PIC X(04) VALUE 'PL01'.
           05 TSKNO                    PIC S9(07) COMP-3.

       01  VARIABLES.
           05 TERM                     PIC X(04).
           05 WS-LARGO                PIC S9(04) COMP-4 VALUE +0.

      * FIN VARIABLES AREA DE COMUNICACION BCI

       01  WSS-VARI.
      *                   LARGO RECEIVE = 31+ 6 + 1 + 1024 = 1062
           03 WSS-LEN-SND    VALUE +1166     COMP    PIC S9(04).
      *
           03 WSS-LENG VALUE +1500  COMP              PIC S9(04).
           03 WSS-CONTADOR                            PIC 9(05).
      *        STRING STANDARD PARA ENTREGAR MSG AL PC
      *
       01  WSS-SCR-OTRN         VALUE 'ABCD'          PIC X(04).
       01  TSPT-VARI.
           03 WSS-NOM-TSPT.
              05 WSS-COD-TERM     VALUE 'TR'          PIC X(02).
              05 WSS-COD-TYPE     VALUE SPACES        PIC X(06).
           03 WSS-LEN-TSPT     VALUE +1025     COMP   PIC S9(04).
           03 WSS-NITM-TSPT    VALUE ZEROES           PIC 9(05).
           03 WSS-ITEM-TSPT.
               05  WSS-INDICA                         PIC X(0001).
               05  WSS-DATA                           PIC X(1024).
           03 WSS-MSG-COL.
               05  WSS-MSG-COL-STAT                   PIC X(0001).
               05  WSS-MSG-COL-DATA                   PIC X(1024).
           03 WSS-MSG-COL-ING.
               05  WSS-MSG-COL-ING-IOPC               PIC X(0012).
               05  WSS-MSG-COL-ING-DATA               PIC X(1024).

       01  WSS-IDN-IQUE                               PIC X(04).

       01  WSS-KEY-ABP.
           03 WSS-KEY-ABP-TSPT.
              05 WSS-KEY-ABP-TERM     VALUE 'IX'       PIC X(02).
              05 WSS-KEY-ABP-TYPE     VALUE SPACES     PIC X(06).

       77  WSS-J                      VALUE ZEROES     PIC 9(05).
       01  WSS-TAB-TBL.
           03 WSS-TAB-TBL-OCC    OCCURS 25 TIMES.
              05 WSS-TAB-TBL-ELM        PIC X(04).
       01  WSS-TAB-TBL-TAB REDEFINES WSS-TAB-TBL.
           03 WSS-TAB-TBL-DESC         PIC X(40).
           03 WSS-TAB-TBL-DATA         PIC X(60).

      * Cima-INI 02-OCT-2013 LOG MTI
       COPY GNSWGLGM.
       COPY GNSWGCLM.
      * Cima-FIN 02-OCT-2013 LOG MTI
      *
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                     PIC X(06).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM GET-FHOY.
      * Cima-INI 02-OCT-2013 LOG MTI


           PERFORM INIT-LGM.

           MOVE WSS-LGM-IND-SENT-OUT TO WSS-LGM-IND-SENT.
           MOVE WSS-LGM-IND-NIVE-SGM TO WSS-LGM-IND-NIVE.
           MOVE WSS-LGM-COD-PROG-SGO TO WSS-LGM-COD-PROG.

           
           EXEC CICS ASSIGN
                 APPLID(LGM-COD-CICS)
           END-EXEC.

           EXEC CICS ASSIGN
                 INVOKINGPROG(LGM-COD-IPRO)
           END-EXEC.

           EXEC CICS ASSIGN
                 USERID(LGM-COD-USER)
           END-EXEC.
           
           MOVE WSS-LGM-INVO-START TO WSS-LGM-INVO.           

      * Cima-FIN 02-OCT-2013 LOG MTI

           MOVE DFHCOMMAREA(1:EIBCALEN) TO WSS-COD-TYPE.

      * Cima-INI 02-OCT-2013 LOG MTI

           MOVE WSS-COD-TYPE            TO WSS-LGM-COD-ORGN.

      * Cima-FIN 02-OCT-2013 LOG MTI

           MOVE EIBTRMID TO TERM.
           PERFORM GET-TSK-TERM.
           MOVE EIBTASKN TO TSKNO.
      * Cima-INI 02-OCT-2013 LOG MTI
           MOVE TSK-TERM-ALF TO WSS-CLM-TS-VDS-COLA-TERM.

           PERFORM GNS-ERR-QUE.
           
           MOVE WSS-CLM-TS-VDS-COLA TO QUE-COLA.
           MOVE WSS-CLM-TS-VDS-LITM TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           MOVE 1 TO QUE-NITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE
               MOVE WSS-CLM-WRT-LGM-S TO WSS-CLM-WRT-LGM.
      * Cima-FIN 02-OCT-2013 LOG MTI

           PERFORM GNS-ERR-QUE.
           PERFORM GNS-HDL-VSM.
           PERFORM PROCESO-ENVIA-MSG.
       FIN-MAIN.

           MOVE WSS-COD-TYPE TO WSS-KEY-ABP-TYPE.
           MOVE WSS-KEY-ABP TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SPACES TO TAB.
           MOVE 'GNS' TO FIO-SIST.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'ETS' TO TAB-COD-TTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-TAB.
           PERFORM GNS-FIO-TAB.




      *    MOVE 'TABTAB' TO QUE-COLA.
      *    MOVE +300 TO QUE-LITM.
      *    MOVE TAB TO QUE-ITEM.
      *    MOVE QUE-PUT TO QUE-CMND.
      *    PERFORM GNS-PRO-QUE.




           IF FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'ETS'
                 IF TAB-COD-CTAB IN TAB > SPACES
                     MOVE TAB-GLS-DESC IN TAB TO WSS-TAB-TBL-DESC
                     MOVE TAB-GLS-DATA IN TAB TO WSS-TAB-TBL-DATA

                     PERFORM DEL-ALL-TS VARYING WSS-J FROM 1 BY 1
                       UNTIL WSS-J > 25
                     MOVE FIO-GET-NXT TO FIO-CMND
                     GO TO CIC-TAB
                 ELSE
                     MOVE FIO-GET-NXT TO FIO-CMND
                     GO TO CIC-TAB.

      *X     MOVE TSK-TERM-ALF TO QUE-TERM.
      *X     MOVE 'PL01'       TO QUE-TYPE.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TERM.
      *X     MOVE 'PL02'       TO QUE-TYPE.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TERM.
      *X     MOVE 'TSI '       TO QUE-TYPE.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TERM.
      *X     MOVE 'TSO '       TO QUE-TYPE.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TYPE.
      *X     MOVE 'PL01'       TO QUE-TERM.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TYPE.
      *X     MOVE 'PL02'       TO QUE-TERM.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TYPE.
      *X     MOVE 'TSI '       TO QUE-TERM.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE TSK-TERM-ALF TO QUE-TYPE.
      *X     MOVE 'TSO '       TO QUE-TERM.
      *X     MOVE QUE-DEL TO QUE-CMND.
      *X     PERFORM GNS-PRO-QUE.

      *X     MOVE 'APTC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'ABP' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PCYA' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PEVC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PICG' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PRDC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'POPC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'TLDC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'GQCF' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'NCMF' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'CTM' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'APFA' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PCLF' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'PLDC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'CREC' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

      *X     MOVE 'FCLN' TO WSS-IDN-IQUE.
      *X     PERFORM DEL-ALL-TS.

           EXEC CICS RETURN END-EXEC.
       EXT-MAIN.
           EXIT.

       PROCESO-ENVIA-MSG SECTION.
       INI-PROCESO-ENVIA-MSG.
           PERFORM PROCESO-LEE-TS.
       FIN-PROCESO-ENVIA-MSG.
           EXIT.

       DEL-ALL-TS SECTION.
       INI-DEL-ALL-TS.

           IF WSS-TAB-TBL-ELM IN WSS-TAB-TBL ( WSS-J ) NOT > SPACES
               MOVE 101 TO WSS-J
               GO TO FIN-DEL-ALL-TS.
           MOVE WSS-TAB-TBL-ELM IN WSS-TAB-TBL ( WSS-J )
                    TO WSS-IDN-IQUE.

           MOVE TSK-TERM-ALF TO QUE-TYPE.
           MOVE WSS-IDN-IQUE TO QUE-TERM.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE WSS-IDN-IQUE TO QUE-TYPE.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-DEL-ALL-TS.
           EXIT.

       PROCESO-LEE-TS SECTION.
       INI-PROCESO-LEE-TS.
           MOVE ZEROES   TO WSS-NITM-TSPT.
           MOVE +1252    TO WSS-LEN-TSPT.
           MOVE '0'      TO WSS-RES-STAT.
           MOVE HOY-FHOY TO WSS-FEC-FTRN.
           MOVE HOY-HHOY TO WSS-HRS-HTRN.
           MOVE '0'      TO WSS-IND-MSGP.
           MOVE +1166    TO WSS-NUM-LENM.
           MOVE SPACES   TO WSS-COD-TRAN.
           MOVE SPACES   TO WSS-COD-SIST.
           MOVE SPACES   TO WSS-COD-USER.
           MOVE SPACES   TO WSS-COD-PASS.
           MOVE SPACES   TO WSS-GLS-FILL.
           MOVE +1187    TO WSS-LEN-SND.
           PERFORM GET-TSPT.
       FIN-PROCESO-LEE-TS.
           EXIT.

       GET-TSPT SECTION.
       INI-GET-TSPT.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE 'ICOL'       TO QUE-TYPE.
           MOVE 1 TO QUE-NITM.
           MOVE +12 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO WSS-IDN-IOPC
               MOVE 'COL' TO WSS-IND-SIST
               MOVE QUE-DEL TO QUE-CMND
               PERFORM GNS-PRO-QUE.
           ADD 1 TO WSS-NITM-TSPT.
           MOVE WSS-NOM-TSPT   TO QUE-COLA.
           MOVE WSS-NITM-TSPT  TO QUE-NITM.
           MOVE WSS-LEN-TSPT   TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO WSS-ITEM-TSPT
               IF WSS-IND-SIST = 'COL'
                  MOVE 'PL02' TO WSS-COD-TRAN
                  MOVE 'COL'  TO WSS-COD-SIST
                  IF WSS-INDICA = '0'
                      MOVE '1' TO WSS-IND-MSGP
                      PERFORM ENV-MSG-OUT-HST
                      GO TO INI-GET-TSPT
                  ELSE
                      MOVE '0' TO WSS-IND-MSGP
                      PERFORM SET-MSG-COL
                      PERFORM ENV-MSG-OUT-HST-ULT
               ELSE
                  IF WSS-INDICA = '0'
                      MOVE '1' TO WSS-IND-MSGP
                      MOVE SPACES   TO WSS-GLS-DOUT
                      MOVE WSS-DATA TO WSS-GLS-DOUT
                      PERFORM ENV-MSG-OUT-HST
                      GO TO INI-GET-TSPT
                  ELSE
                      MOVE '0' TO WSS-IND-MSGP
                      MOVE SPACES   TO WSS-GLS-DOUT
                      MOVE WSS-DATA TO WSS-GLS-DOUT
                      PERFORM ENV-MSG-OUT-HST-ULT.
       FIN-GET-TSPT.
           EXIT.

       SET-MSG-COL SECTION.
       INI-SET-MSG-COL.
           MOVE WSS-DATA TO WSS-MSG-COL.
           MOVE WSS-MSG-COL-STAT TO WSS-RES-STAT.
           MOVE WSS-MSG-COL-DATA TO WSS-GLS-RESP.
           IF WSS-IDN-IOPC > SPACES
                MOVE WSS-IDN-IOPC TO WSS-MSG-COL-ING-IOPC
                MOVE WSS-GLS-RESP TO WSS-MSG-COL-ING-DATA
                MOVE WSS-MSG-COL-ING TO WSS-GLS-RESP.
       FIN-SET-MSG-COL.
           EXIT.

       ENV-MSG-OUT-HST-ULT SECTION.
       INI-ENV-MSG-OUT-HST-ULT.
      *    MOVE WSS-LEN-SND TO QUE-LITM.
      *    EXEC CICS WRITEQ TS QNAME('ABCDRPC')
      *       FROM (WSS-SEND)
      *    END-EXEC.

      * Cima-INI 02-OCT-2013 LOG MTI
            PERFORM PRM-LGM.

      * Cima-FIN 02-OCT-2013 LOG MTI

            EXEC CICS SEND
                      LENGTH(WSS-LEN-SND)
                      FROM(WSS-SEND)
                      CONVID(TERM)
                      LAST
            END-EXEC.
      *    IF WSS-IND-MENS = 'F' OR WSS-IND-MENS = 'X'
               MOVE WSS-NOM-TSPT   TO QUE-COLA.
               MOVE QUE-DEL        TO QUE-CMND.
               PERFORM GNS-PRO-QUE.
       FIN-ENV-MSG-OUT-HST-ULT.
           EXIT.

       ENV-MSG-OUT-HST SECTION.
       INI-ENV-MSG-OUT-HST.

      * Cima-INI 02-OCT-2013 LOG MTI
            PERFORM PRM-LGM.
      * Cima-FIN 02-OCT-2013 LOG MTI

           EXEC CICS SEND
                     LENGTH(WSS-LEN-SND)
                     FROM(WSS-SEND)
                     CONVID(TERM)
           END-EXEC.
       FIN-ENV-MSG-OUT-HST.
           EXIT.

       COPY GNSBGEND.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBHVSM.
       COPY GNSBGVSM.
       COPY GNSBGQUE.
       COPY GNSBGTSK.
       COPY GNSBGDTC.

      * Cima-INI 02-OCT-2013 LOG MTI
       PRM-LGM SECTION.
       INI-PRM-LGM.
      * GRABA LOG LGM




           MOVE WSS-SEND TO LGM-GLS-REQU IN LGM.

           EXEC CICS ASKTIME ABSTIME(WSS-LGM-ABSTIME)
           END-EXEC.
           
           MOVE WSS-LGM-ABSTIME TO LGM-NUM-TAWR IN LGM.
           
           
           PERFORM WRT-LGM.

           IF WSS-CLM-WRT-LGM = WSS-CLM-WRT-LGM-S
           
               IF WSS-LGM-INVO = WSS-LGM-INVO-START
                    EXEC CICS START
                        TRANSID( WSS-LMG-TRAN-WRT )
                        FROM   ( SYS-CMMA )
                        LENGTH ( SYS-TCMA )
                    END-EXEC
              ELSE
                    MOVE 'GNSPULGM' TO SYS-PROG
                    MOVE SYS-LINK   TO SYS-CMND
                    PERFORM GNS-PRO-SYS.
       
       FIN-PRM-LGM.
           EXIT.


      * Cima-FIN 02-OCT-2013 LOG MTI
      * Modulo FIO para registro TAB en DATACOM
       GNS-FIO-TAB SECTION.
       INI-GNS-FIO-TAB.
           MOVE ADR-TAB-REQA TO ADR-REQA.
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.
      *JSS MOVE IFD-GSIS( 1 ) TO ADR-DBID IN ADR-REQA.
      *X   MOVE FIO-SIST TO IFD-SAUX.
      *X   MOVE 'C'      TO IFD-QAUX.
      *X   MOVE 1 TO IFD-IAUX.
      *X     SET IFD-ITBL TO 1.
      *X     SEARCH IFD-VSIS VARYING IFD-IAUX
      *X         AT END
      *X             MOVE 'Sistema Invalido en GNS-FIO-TAB' TO FIO-MEN1
      *X             MOVE IFD-DAUX                          TO FIO-MEN2
      *X             GO TO PRG-ABT
      *X         WHEN IFD-DSIS( IFD-ITBL ) = IFD-DAUX
      *X             MOVE IFD-GSIS( IFD-ITBL) TO ADR-DBID IN ADR-REQA.
      *X*
           MOVE 180   TO ADR-DBID IN ADR-REQA.
           MOVE 'TAB00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE TAB-COD-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-STP-ITRN'
               MOVE TAB-STP-ITRN IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-CIC-TABL'
               MOVE TAB-CIC-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-EXT-TABL'
               MOVE TAB-EXT-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA.
      *X     ELSE
      *X         MOVE 'En GNS-FIO-TAB, key' TO FIO-MENS
      *X         MOVE FIO-AKEY   TO FIO-MENS-KEY
      *X         MOVE 'Invalida' TO FIO-MENS-FIL
      *X         GO TO PRG-ABT.
      *JSS
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB
                                           TAB-EXT-TTAB IN TAB
                                           TAB-SNX-TTAB IN TAB.
      *
           MOVE TAB TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO TAB
           ELSE
      *JSS     MOVE 'GNSTAB' TO FIO-MEN2
               MOVE FIO-SIST TO FIO-MENS-SIS
               MOVE 'TAB'    TO FIO-MENS-REG.
      *
      *X         IF FIO-STAT-FTL
      *X             GO TO PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE ADR-REQA TO ADR-TAB-REQA.
       FIN-GNS-FIO-TAB.
           EXIT.

      * Cima-INI 02-OCT-2013 LOG MTI
       COPY GNSBGLGM.
      * Cima-FIN 02-OCT-2013 LOG MTI
