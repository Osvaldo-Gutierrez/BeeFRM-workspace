      *$ASCII
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPDTAB.
       AUTHOR.          CONSIST.
      * 
       ENVIRONMENT DIVISION.
      *====================
      *
       INPUT-OUTPUT SECTION.
      *
       CONFIGURATION SECTION.
      *---------------------
       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS
       01  WSS-VARI.
           03 WSS-I       VALUE ZEROES PIC 9(06).

      * WORKING PARA RUTINAS.
       COPY GNSWGSYS.
      * COPY GNSWGFEC.
      * COPY GNSWGHOY.
       COPY GNSWCFIO.
       COPY GNSWVFIO.

       COPY GNSBRTAB.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           PERFORM OPN-FILE.
           PERFORM PRO-FILE.
           PERFORM CLO-FILE.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       OPN-FILE SECTION.
      *------------------
       INI-OPE-FILE.
           MOVE 'GNS'   TO FIO-SIST.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO I-O  GNSTAB FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
       FIN-OPN-FILE.
           EXIT.

       PRO-FILE SECTION.
      *----------------------
       INI-PRO-FILE.
           MOVE 'GNS'   TO FIO-SIST.
           MOVE ZEROES       TO WSS-I.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE PRIMER REGISTRO'
              DISPLAY 'ABORTO'
              STOP RUN.
           PERFORM DEPURA-TAB UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FILE.
           EXIT.

       DEPURA-TAB SECTION.
       INI-DEPURA-TAB.
           MOVE 'GNS'   TO FIO-SIST.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL DEPURAR REG.TAB: ' TAB-COD-TABL IN TAB
              GO TO FIN-DEPURA-TAB.

           MOVE SPACES TO TAB-GLS-FLAG IN TAB.
           IF TAB-NUM-STRN IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-STRN IN TAB.
           IF TAB-NUM-ATRN IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-ATRN IN TAB.
           IF TAB-NUM-MTRN IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-MTRN IN TAB.
           IF TAB-NUM-DTRN IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-DTRN IN TAB.
           IF TAB-NUM-HHTR IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-HHTR IN TAB.
           IF TAB-NUM-MMTR IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-MMTR IN TAB.
           IF TAB-NUM-SSTR IN TAB NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-SSTR IN TAB.

           IF  TAB-MSC-TACC IN TAB NOT > SPACES
               MOVE SPACES TO TAB-MSC-TACC IN TAB.
           IF  TAB-MSC-STAT IN TAB NOT > SPACES
               MOVE SPACES TO TAB-MSC-STAT IN TAB.
      *    IF  TAB-COD-OTRN IN TAB NOT > SPACES
      *        MOVE SPACES TO TAB-COD-OTRN IN TAB.
           IF  TAB-MSC-TTRN IN TAB NOT > SPACES
               MOVE SPACES TO TAB-MSC-TTRN IN TAB.
           IF  TAB-COD-TTRN IN TAB NOT > SPACES
               MOVE SPACES TO TAB-COD-TTRN IN TAB.
           IF  TAB-COD-ATRN IN TAB NOT > SPACES
               MOVE SPACES TO TAB-COD-ATRN IN TAB.
      *    IF  TAB-CIC-TABL IN TAB NOT > SPACES
      *        MOVE SPACES TO TAB-CIC-TABL IN TAB.
           IF  TAB-CIC-TTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-CIC-TTAB IN TAB.
           IF  TAB-CIC-CTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-CIC-CTAB IN TAB.
      *    IF  TAB-EXT-TABL IN TAB NOT > SPACES
      *        MOVE SPACES TO TAB-EXT-TABL IN TAB.
           IF  TAB-EXT-TTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-EXT-TTAB IN TAB.
           IF  TAB-EXT-CTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-EXT-CTAB IN TAB.
           IF  TAB-GLS-DCOR IN TAB NOT > SPACES
               MOVE SPACES TO TAB-GLS-DCOR IN TAB.
           IF  TAB-GLS-ABRV IN TAB NOT > SPACES
               MOVE SPACES TO TAB-GLS-ABRV IN TAB.
           IF  TAB-GLS-DESC IN TAB NOT > SPACES
               MOVE SPACES TO TAB-GLS-DESC IN TAB.

      *    IF  TAB-GLS-DATA IN TAB NOT > SPACES
      *        MOVE SPACES TO TAB-GLS-DATA IN TAB.
           IF  TAB-COD-DAT1 IN TAB(1) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(1).
           IF  TAB-COD-DAT1 IN TAB(2) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(2).
           IF  TAB-COD-DAT1 IN TAB(3) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(3).
           IF  TAB-COD-DAT1 IN TAB(4) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(4).
           IF  TAB-COD-DAT1 IN TAB(5) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(5).
           IF  TAB-COD-DAT1 IN TAB(6) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(6).
           IF  TAB-COD-DAT1 IN TAB(7) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(7).
           IF  TAB-COD-DAT1 IN TAB(8) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(8).
           IF  TAB-COD-DAT1 IN TAB(9) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(9).
           IF  TAB-COD-DAT1 IN TAB(10) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT1 IN TAB(10).

           IF  TAB-COD-DAT2 IN TAB(1) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(1).
           IF  TAB-COD-DAT2 IN TAB(2) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(2).
           IF  TAB-COD-DAT2 IN TAB(3) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(3).
           IF  TAB-COD-DAT2 IN TAB(4) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(4).
           IF  TAB-COD-DAT2 IN TAB(5) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(5).
           IF  TAB-COD-DAT2 IN TAB(6) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(6).
           IF  TAB-COD-DAT2 IN TAB(7) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(7).
           IF  TAB-COD-DAT2 IN TAB(8) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(8).
           IF  TAB-COD-DAT2 IN TAB(9) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(9).
           IF  TAB-COD-DAT2 IN TAB(10) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT2 IN TAB(10).

           IF  TAB-COD-DAT3 IN TAB(1) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(1).
           IF  TAB-COD-DAT3 IN TAB(2) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(2).
           IF  TAB-COD-DAT3 IN TAB(3) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(3).
           IF  TAB-COD-DAT3 IN TAB(4) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(4).
           IF  TAB-COD-DAT3 IN TAB(5) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(5).
           IF  TAB-COD-DAT3 IN TAB(6) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(6).
           IF  TAB-COD-DAT3 IN TAB(7) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(7).
           IF  TAB-COD-DAT3 IN TAB(8) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(8).
           IF  TAB-COD-DAT3 IN TAB(9) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(9).
           IF  TAB-COD-DAT3 IN TAB(10) NOT > SPACES
               MOVE SPACES TO   TAB-COD-DAT3 IN TAB(10).

      *    IF  TAB-SNX-TABL IN TAB NOT > SPACES
      *        MOVE SPACES TO TAB-SNX-TABL IN TAB.
           IF  TAB-SNX-TTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-SNX-TTAB IN TAB.
           IF  TAB-SNX-TTAB IN TAB NOT > SPACES
               MOVE SPACES TO TAB-SNX-CTAB IN TAB.

           MOVE 'GNS'   TO FIO-SIST
           MOVE FIO-MOD TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE 'GNS'   TO FIO-SIST
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL DEPURAR REG.TAB: ' TAB-COD-TABL IN TAB
           ELSE
              ADD  1   TO WSS-I.
      *
           MOVE 'GNS'   TO FIO-SIST.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM GNS-FIO-TAB.
       FIN-DEPURA-TAB.
           EXIT.

       CLO-FILE SECTION.
      *------------------
       INI-CLO-FILE.
           DISPLAY 'NRO. REG. DEPURADOS :' WSS-I.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
       FIN-CLO-FILE.
           EXIT.

      * RUTINAS
       COPY GNSBBSYS.
      * COPY GNSBGEND.

       COPY GNSBFTAB.
