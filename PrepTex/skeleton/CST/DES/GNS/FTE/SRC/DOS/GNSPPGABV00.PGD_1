       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GNSPPGAB.
       AUTHOR. BEE.
       DATE-WRITTEN.   02-ENE-2004 19:52:30
       ENVIRONMENT DIVISION.
      *=====================
       DATA DIVISION.
      *==============
       WORKING-STORAGE SECTION.
      *------------------------
       77  WSS-TAG-GNSPPO81-IDN PIC X(125) VALUE
           '<IDNPGM NOM=$GNSPPGAB$ VGF=$MANUAL                $ VSN=$04.
      -    '10.26$ GEN=$26-OCT-04 09:39 PM$ FNC=$GAV-V1$/>'.
      
       01  WSS-IDN-IQUE                               PIC X(04).
       COPY GNSBRLAB.
      
       COPY GNSWVIDD.
       COPY GNSWVFIO.
       COPY GNSWCFIO.
      *
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAB-REQA==.
      *
       COPY GNSWGSYS.
       COPY GNSWGQUE.
       COPY GNSWGTSK.
      
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                             PIC X(260).
       COPY GNSLGFIO.
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
      
      *     MOVE DFHCOMMAREA(1:EIBCALEN) TO LAB.
           MOVE +260 TO SYS-TCMA.
           EXEC CICS RETRIEVE
                 INTO(LAB) LENGTH(SYS-TCMA)
           END-EXEC.
      
           MOVE LAB-NUM-TASK IN LAB TO TSK-TERM-NUM.
           PERFORM GNS-ERR-QUE.
      
           PERFORM DEL-TSS.
      
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-LAB.
      
           EXEC CICS
                  RETURN
           END-EXEC.
       FIN-MAIN.
           EXIT.
      
       COPY GNSBFLAB.
       COPY GNSBGDTC.
       COPY GNSBGQUE.
      
       DEL-TSS SECTION.
       INI-DEL-TSS.
           MOVE 'PL01' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'PL02' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'TSI ' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'TSO ' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'APTC' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'ABP' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'PCYA' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'PEVC' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'PICG' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'PRDC' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'POPC' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'TLDC' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'GQCF' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'CTM' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'NCMF' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'MNSF' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'FCGD' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'GIDD' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'CCAN' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'CTM TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
           MOVE 'NCMF' TO WSS-IDN-IQUE.
           PERFORM DEL-ALL-TS.
      
       FIN-DEL-TSS.
           EXIT.
      
       DEL-ALL-TS SECTION.
       INI-DEL-ALL-TS.
      
           MOVE TSK-TERM-ALF TO QUE-TYPE.
           MOVE WSS-IDN-IQUE TO QUE-TERM.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE WSS-IDN-IQUE TO QUE-TYPE.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
       FIN-DEL-ALL-TS.
           EXIT.
      
