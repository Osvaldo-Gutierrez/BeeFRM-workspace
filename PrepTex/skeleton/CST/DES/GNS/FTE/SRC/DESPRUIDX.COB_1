IDENTIFICATION DIVISION.
*=======================
PROGRAM-ID.	^sis^PRU^reg^.
AUTHOR.		GUZMAN Y CIA.

* Prueba rutina ^sis^FIO^reg^ para archivo INDEXADO ^sis^^reg^.

ENVIRONMENT DIVISION.
*====================

DATA DIVISION.
*=============
WORKING-STORAGE SECTION.
*-----------------------
COPY	'^sis^REG.^reg^'	FROM	DICTIONARY
	REPLACING
	==^reg^==		BY	==^reg^	EXTERNAL==.
COPY	FIOWSS	IN	DESTXT.
01 WSS-VARI.
	03 WSS-CMND		VALUE SPACES	PIC X(80).
	03 WSS-VKEY.
		05 FILLER	VALUE SPACES	PIC X(80).

PROCEDURE DIVISION.
*==================

MAIN SECTION.
*------------
INI-MAIN.
	MOVE SPACES TO FIO-AKEY.
	DISPLAY ' '.
	DISPLAY 'INP		OUT		UPD		CLO'.
	DISPLAY 'GET_KEY	GET_NXT	GET_FST		GET_NLS		GET_GRT'.
	DISPLAY	'GET_KEY_ALT	GET_FST_ALT	GET_NLS_ALT	GET_GRT_ALT'
	DISPLAY 'FND_KEY		FND_FST		FND_NLS		FND_GRT'.
	DISPLAY 'FND_KEY_ALT	FND_FST_ALT	FND_NLS_ALT	FND_GRT_ALT'.
	DISPLAY 'PUT		MOD		DEL		CHG	ULK_REC	ULK_ALL'.
	DISPLAY 'VID		ACC		REC_LCK		REC_LEN	FNF	FIN'.
	DISPLAY ' '.
	DISPLAY 'FIO-CMND : ' WITH NO ADVANCING.
	ACCEPT WSS-CMND WITH CONVERSION.
	DISPLAY ' '.
	IF WSS-CMND EQUAL 'FIN'
		GO TO FIN-MAIN.
	IF WSS-CMND EQUAL SPACES
		MOVE FIO-GET-NXT TO WSS-CMND.
	UNSTRING WSS-CMND DELIMITED BY '/' INTO FIO-CMND FIO-AKEY.
	IF FIO-CMND = FIO-VID
		DISPLAY 'FIO-VOID : ' WITH NO ADVANCING
		ACCEPT FIO-VOID WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-ACC
		DISPLAY 'FIO-ACCS : ' WITH NO ADVANCING
		ACCEPT FIO-ACCS WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-REC-LCK
		DISPLAY 'FIO-RLCK : ' WITH NO ADVANCING
		ACCEPT FIO-RLCK WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-FNF
		DISPLAY 'FIO-IFNF : ' WITH NO ADVANCING
		ACCEPT FIO-IFNF WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-REC-LEN
		DISPLAY 'FIO-RLEN : ' WITH NO ADVANCING
		ACCEPT FIO-RLEN WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-FND-EQL-ALT OR FIO-FND-GRT-ALT OR FIO-FND-NLS-ALT OR
		      FIO-GET-KEY-ALT OR FIO-GET-GRT-ALT OR FIO-GET-NLS-ALT
		IF FIO-AKEY = SPACES OR LOW-VALUES
			DISPLAY 'FIO-AKEY : ' WITH NO ADVANCING
			ACCEPT FIO-AKEY WITH CONVERSION
			DISPLAY ' '
			DISPLAY 'FIO-VKEY : ' WITH NO ADVANCING
			ACCEPT WSS-VKEY WITH CONVERSION
		ELSE
			DISPLAY 'FIO-VKEY : ' WITH NO ADVANCING
			ACCEPT WSS-VKEY WITH CONVERSION
	ELSE
	IF FIO-CMND = FIO-FND-FST-ALT OR FIO-GET-FST-ALT
		IF FIO-AKEY = SPACES OR LOW-VALUES
			DISPLAY 'FIO-AKEY : ' WITH NO ADVANCING
			ACCEPT FIO-AKEY WITH CONVERSION
		ELSE
			NEXT SENTENCE
	ELSE
	IF FIO-CMND = FIO-FND-EQL OR FIO-FND-GRT OR FIO-FND-NLS OR
		      FIO-GET-KEY OR FIO-GET-GRT OR FIO-GET-NLS OR FIO-DEL
		DISPLAY 'FIO-VKEY : ' WITH NO ADVANCING
		ACCEPT WSS-VKEY WITH CONVERSION.
^alt^
	IF FIO-CMND = FIO-PUT OR FIO-MOD OR FIO-CHG
		DISPLAY 'REGISTRO : ' WITH NO ADVANCING
		ACCEPT ^reg^ WITH CONVERSION.
	CALL '^sis^FIO^reg^' USING FIO-CMND.
	IF NOT FIO-STAT-OKS
		DISPLAY ' '
		DISPLAY 'FIO-STAT : ' , FIO-STAT
		GO TO INI-MAIN.
	IF FIO-CMND = FIO-GET-KEY     OR FIO-GET-GRT     OR FIO-GET-NLS     OR
		      FIO-GET-KEY-ALT OR FIO-GET-GRT-ALT OR FIO-GET-NLS-ALT OR
		      FIO-GET-FST     OR FIO-GET-NXT     OR
		      FIO-GET-FST-ALT OR FIO-GET-NXT-ALT
		DISPLAY ' '
		DISPLAY 'REGISTRO : '
		DISPLAY ' '
		DISPLAY ^reg^.
	GO TO INI-MAIN.
FIN-MAIN.
	STOP RUN.
