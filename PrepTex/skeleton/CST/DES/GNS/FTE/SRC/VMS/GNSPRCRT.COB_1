       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    GNSPRCRT.
       AUTHOR.        CONSIST.

      * Programa despliega carta usando Rutina para Edicion
      * Parametrica de Textos
      * NOTA: Al usar este ejemplo como base para un programa se
      *       debe substituir la referencia PRY-FIO-TAB por GNS-FIO-TAB
      *       y cargar previamente el sistema donde esta la carta en la
      *       variable FIO-SIST

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
      *Modulos necesarios para EPT ( Edicion Parametrica de Textos )
       COPY GNSWGEPT.
       COPY GNSWGHOY.
       COPY GNSWGSYS.
      *Modulos necesarios para leer una 'carta' de las tablas generales
       COPY GNSWVFIO.
       COPY GNSWCFIO.
       COPY GNSBRTAB.
      *Variables auxiliares
       01  WSS-VARI.
           03 WSS-SIND             VALUE 0 PIC 9(03).
           03 WSS-IMAT                     PIC X(01).
           03 WSS-CART                     PIC X(07).
           03 WSS-CTAB.
              05 WSS-CTA1                  PIC X(07).
              05 WSS-CTA2                  PIC X(05).
           03 WSS-STRN.
              05 WSS-DESC                  PIC X(40).
              05 WSS-DATA                  PIC X(60).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM PRY-FIO-TAB.
       LUP-MAIN.
           IF WSS-SIND < EPT-NTOK
               DISPLAY 'DESEA INGRESAR TOKEN: ' WITH NO ADVANCING
               ACCEPT WSS-IMAT
               IF WSS-IMAT = 'S' OR 's'
                   ADD 1 TO WSS-SIND
                   DISPLAY 'INGRESE NOMBRE DE TOKEN: ' WITH NO ADVANCING
                   ACCEPT EPT-VTOK(WSS-SIND)
                   DISPLAY 'INGRESE VALOR DE TOKEN:  ' WITH NO ADVANCING
                   ACCEPT EPT-GTOK(WSS-SIND)
                   GO TO LUP-MAIN
               ELSE
                   NEXT SENTENCE.
           PERFORM DESPLIEGUE-CARTA.
           IF WSS-CART > SPACES
               GO TO LUP-MAIN.
       CLO-MAIN.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM PRY-FIO-TAB.
       FIN-MAIN.
           STOP RUN.

       DESPLIEGUE-CARTA SECTION.
       INI-DESPLIEGUE-CARTA.
           DISPLAY 'INGRESE NOMBRE DE LA CARTA: ' WITH NO ADVANCING.
           ACCEPT WSS-CART.
           IF WSS-CART NOT > SPACES
               GO TO FIN-DESPLIEGUE-CARTA.
           MOVE 'CRT'    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CART TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DESPLIEGUE-CARTA.
           PERFORM PRY-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DESPLIEGUE-CARTA.
           MOVE TAB-COD-CTAB TO WSS-CTAB.
           IF WSS-CTA1 NOT = WSS-CART
               GO TO FIN-DESPLIEGUE-CARTA.
           IF WSS-CTA2 NOT > SPACES
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-DESPLIEGUE-CARTA.
           MOVE TAB-GLS-DESC TO WSS-DESC.
           MOVE TAB-GLS-DATA TO WSS-DATA.
           MOVE WSS-STRN TO EPT-STRN.
           PERFORM EPT-CARD.
           DISPLAY EPT-STRN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DESPLIEGUE-CARTA.
       FIN-DESPLIEGUE-CARTA.
           EXIT.

      *Modulos necesarios para EPT ( Edicion Parametrica de Textos )
       COPY GNSBGEPT.
       COPY GNSBGHOY.
       COPY GNSBGSYS.
      *Modulos necesarios para leer una 'carta' de las tablas generales
       COPY PRYBFTAB.
