       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    GNSPGMEN.
       AUTHOR.        ( JSS ) CONSIST.

      * Lee registro MEN a partir de nombres logicos

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.

       COPY GNSBRMEN REPLACING ==MEN== BY ==MEN EXTERNAL==.
       01  WSS-VARI.
           03 WSS-NLNM                             PIC X(08).
           03 WSS-VLNM                             PIC X(164).
           03 WSS-RMEN.
              05 WSS-MEN1                          PIC X(164).
              05 WSS-MEN2                          PIC X(164).
              05 WSS-MEN3                          PIC X(162).

       LINKAGE SECTION.
      *===============
       01  LNK-STAT                                PIC X(02).

       PROCEDURE DIVISION USING LNK-STAT.
      *=================================

       MAIN SECTION.
       INI-MAIN.
           MOVE SPACES TO LNK-STAT.

           MOVE 'GNS$MEN1' TO WSS-NLNM.
           PERFORM GET-VLNM.
           MOVE WSS-VLNM   TO WSS-MEN1.

           MOVE 'GNS$MEN2' TO WSS-NLNM.
           PERFORM GET-VLNM.
           MOVE WSS-VLNM   TO WSS-MEN2.

           MOVE 'GNS$MEN3' TO WSS-NLNM.
           PERFORM GET-VLNM.
           MOVE WSS-VLNM   TO WSS-MEN3.

           MOVE WSS-RMEN TO MEN.
       FIN-MAIN.
           EXIT PROGRAM.

       GET-VLNM SECTION.
       INI-GET-VLNM.
           MOVE SPACES TO WSS-VLNM.
           CALL 'LIB$SYS_TRNLOG' USING BY DESCRIPTOR WSS-NLNM
                                       OMITTED
                                       BY DESCRIPTOR WSS-VLNM.
           IF WSS-VLNM = WSS-NLNM
               MOVE 'NO' TO LNK-STAT
               EXIT PROGRAM.
       FIN-GET-VLNM.
           EXIT.
