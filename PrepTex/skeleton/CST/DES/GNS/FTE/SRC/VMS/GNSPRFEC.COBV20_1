       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    GNSPRFEC.
       AUTHOR.        GUZMAN Y CIA.

      * Prueba Rutina para Manejo de Fechas

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.

       COPY GNSWGFEC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSWGHOY.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       01  WSS-VARI.
           03 WSS-FFEC.
              05 WSS-AFEC                                   PIC X(02).
              05 WSS-MFEC                                   PIC X(02).
              05 WSS-DFEC                                   PIC X(02).
           03 WSS-CHOY                                      PIC X(01).
           03 WSS-VHBL                                      PIC X(01).
           03 WSS-FORM                                      PIC X(03).
           03 WSS-SREV                     VALUE "[7m" PIC X(04).
           03 WSS-NREV                     VALUE "[0m" PIC X(04).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GNS'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       LUP-MAIN.
           DISPLAY 'Digite Comando : ' WSS-SREV
                   'VAL-FEC' WSS-NREV
                   ' CMP-FEC CMP-HOY RET-JUL RET-FEC SIG-HBL'.
           DISPLAY '                 RST-DIA RST-MES RST-ANO'.
           DISPLAY '                 SUM-DIA SUM-MES SUM-ANO'.
           DISPLAY '                 DIF-DIA DIF-MES DIF-ANO'.
           DISPLAY '                 F                       :'
                   WITH NO ADVANCING.
           ACCEPT FEC-CMND.
           IF FEC-CMND = 'F'
               GO TO FIN-MAIN.
           IF FEC-CMND NOT > SPACES
               MOVE 'VAL-FEC' TO FEC-CMND.
           IF FEC-CMND NOT = FEC-RET-FEC
               DISPLAY 'INGRESE FORMATO [FEC]/DMA/MSA/FMA/FSA/FFA : '
                        WITH NO ADVANCING
               ACCEPT WSS-FORM
               IF WSS-FORM = 'DMA'
                   MOVE FEC-FORM-DMA TO FEC-FORM
               ELSE
               IF WSS-FORM = 'MSA'
                   MOVE FEC-FORM-MSA TO FEC-FORM
               ELSE
               IF WSS-FORM = 'FMA'
                   MOVE FEC-FORM-FMA TO FEC-FORM
               ELSE
               IF WSS-FORM = 'FSA'
                   MOVE FEC-FORM-FSA TO FEC-FORM
               ELSE
               IF WSS-FORM = 'FFA'
                   MOVE FEC-FORM-FFA TO FEC-FORM
               ELSE
                   MOVE FEC-FORM-FEC TO FEC-FORM.
           IF FEC-CMND = FEC-CMP-FEC OR
              FEC-DIF-DIA OR FEC-DIF-MES OR FEC-DIF-ANO
               DISPLAY 'INGRESE FECHA 1 : ' WITH NO ADVANCING
               ACCEPT FEC-FEC1
               DISPLAY 'INGRESE FECHA 2 : ' WITH NO ADVANCING
               ACCEPT FEC-FEC2
           ELSE
           IF FEC-CMND = FEC-RET-FEC
               DISPLAY 'INGRESE JULIANO : ' WITH NO ADVANCING
               ACCEPT FEC-FJUL WITH CONVERSION
           ELSE
               DISPLAY 'INGRESE FECHA : ' WITH NO ADVANCING
               ACCEPT FEC-FECH.
           IF FEC-CMND = FEC-SUM-DIA OR FEC-RST-DIA
               DISPLAY 'INGRESE DIAS : ' WITH NO ADVANCING
               ACCEPT FEC-NDIA WITH CONVERSION.

           IF FEC-CMND = FEC-SUM-MES OR FEC-RST-MES
               DISPLAY 'INGRESE MESES: ' WITH NO ADVANCING
               ACCEPT FEC-NMES WITH CONVERSION.

           IF FEC-CMND = FEC-SUM-ANO OR FEC-RST-ANO
               DISPLAY 'INGRESE ANOS : ' WITH NO ADVANCING
               ACCEPT FEC-NANO WITH CONVERSION.

           MOVE FEC-VHBL-S TO FEC-VHBL.
           IF FEC-CMND NOT = 'VAL-FEC'
               GO TO PRO-FEC-MAIN.

           DISPLAY 'INGRESE CHOY: L/E/G/LE/GE/LG/[N] : '
                    WITH NO ADVANCING.
           ACCEPT WSS-CHOY.
           IF WSS-CHOY = 'L'
               MOVE FEC-CHOY-L TO FEC-CHOY
           ELSE
           IF WSS-CHOY = 'E'
               MOVE FEC-CHOY-E TO FEC-CHOY
           ELSE
           IF WSS-CHOY = 'G'
               MOVE FEC-CHOY-G TO FEC-CHOY
           ELSE
           IF WSS-CHOY = 'LE'
               MOVE FEC-CHOY-LE TO FEC-CHOY
           ELSE
           IF WSS-CHOY = 'GE'
               MOVE FEC-CHOY-GE TO FEC-CHOY
           ELSE
           IF WSS-CHOY = 'LG'
               MOVE FEC-CHOY-LG TO FEC-CHOY
           ELSE
               MOVE FEC-CHOY-N TO FEC-CHOY.

           DISPLAY 'INGRESE VHBL: S/[N] : ' WITH NO ADVANCING.
           ACCEPT WSS-VHBL.
           IF WSS-VHBL = 'S'
               MOVE FEC-VHBL-S TO FEC-VHBL
           ELSE
               MOVE FEC-VHBL-N TO FEC-VHBL.

       PRO-FEC-MAIN.

           IF FEC-CMND = FEC-VAL-FEC OR FEC-RET-FEC OR FEC-SIG-HBL OR
                         FEC-SUM-DIA OR FEC-SUM-MES OR FEC-SUM-ANO OR
                         FEC-RST-DIA OR FEC-RST-MES OR FEC-RST-ANO
               DISPLAY 'INGRESE CARACTER DE INSERCION : '
                        WITH NO ADVANCING
               ACCEPT FEC-IEDT.

           PERFORM PRO-FEC.
           DISPLAY 'FEC-STAT : ' FEC-STAT.
           IF FEC-CMND = 'VAL-FEC'
               DISPLAY 'FEC-FECH : ' FEC-FECH.
           IF MSG-COD-MENS > SPACES
               DISPLAY 'MSG-MENS : ' MSG-GLS-DESC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'FEC-MENS : ' FEC-MENS
           ELSE
           IF FEC-CMND = FEC-RET-JUL
                DISPLAY 'FEC-FJUL : ' FEC-FJUL
           ELSE
           IF FEC-CMND = FEC-RET-FEC OR FEC-SIG-HBL OR
                         FEC-SUM-DIA OR FEC-SUM-MES OR FEC-SUM-ANO OR
                         FEC-RST-DIA OR FEC-RST-MES OR FEC-RST-ANO
                DISPLAY 'FEC-FECH : ' FEC-FECH
           ELSE
           IF FEC-CMND = FEC-DIF-DIA
                DISPLAY 'FEC-NDIA : ' FEC-NDIA
           ELSE
           IF FEC-CMND = FEC-DIF-MES
                DISPLAY 'FEC-NMES : ' FEC-NMES
                DISPLAY 'FEC-NDIA : ' FEC-NDIA
           ELSE
           IF FEC-CMND = FEC-DIF-ANO
                DISPLAY 'FEC-NANO : ' FEC-NANO.

           GO TO LUP-MAIN.
       FIN-MAIN.
           MOVE FIO-CLO TO FIO-CMND.
           MOVE 'GNS'   TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           STOP RUN.

       COPY GNSBGFEC.
       COPY GNSBFTAB.
       COPY GNSBGMSG.
       COPY GNSBFMSG.

       GET-FHOY SECTION.
       INI-GET-FHOY.
           ACCEPT WSS-FFEC FROM DATE.
           MOVE '19'     TO HOY-SHOY.
           MOVE WSS-AFEC TO HOY-AHOY.
           MOVE WSS-MFEC TO HOY-MHOY.
           MOVE WSS-DFEC TO HOY-DHOY.
       FIN-GET-FHOY.
           EXIT.
