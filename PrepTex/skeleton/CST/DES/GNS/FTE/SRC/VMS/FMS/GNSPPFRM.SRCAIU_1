       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.     GNSPPFRM.
       AUTHOR.          GUZMAN Y CIA.
       
      * Subrutina manejo Formulario
       
       ENVIRONMENT DIVISION.
      *====================
       
       DATA DIVISION.
      *=============
       
       WORKING-STORAGE SECTION.
      *-----------------------
      *JSSCOPY     FRMWSS     IN     DESTXT.
       COPY GNSWGFRM.
       01 WSS-VARI.
           03 WSS-IVEZ          VALUE 0          PIC 9(01).
               88 PRIMERA-VEZ     VALUE 0.
           03 WSS-VFLD                    PIC X(80).
           03 WSS-NFLD                    PIC X(31).
           03 WSS-NREG                    PIC X(10).
           03 WSS-KFLD                    PIC X(03).
           03 WSS-SFLD                    PIC X(01).
           03 WSS-SIND     COMP.
               05 I                    PIC 9(09).
               05 J                    PIC 9(09).
               05 K                    PIC 9(09).
               05 WSS-1UNP             PIC 9(09).
               05 WSS-OLDI             PIC 9(09).
           03 WSS-ONFL                 PIC X(31).
           03 WSS-OIFL         COMP    PIC 9(09).
           03 WSS-STAT-ABT     COMP     VALUE 99     PIC S9(09).
           03 WSS-CMND                    PIC X(20).
               88 WSS-INIT     VALUE 'INI         '.
               88 WSS-GETF     VALUE 'GET_FLD     '.
               88 WSS-GETN     VALUE 'GET_NXT     '.
               88 WSS-GET1     VALUE 'GET_FST     '.
               88 WSS-GETR     VALUE 'GET_RNG     '.
               88 WSS-GETA     VALUE 'GET_ALL     '.
               88 WSS-GETM     VALUE 'GET_MAP     '.
               88 WSS-RETA     VALUE 'RET_ALL     '.
               88 WSS-PUTA     VALUE 'PUT_ALL     '.
               88 WSS-CLRF     VALUE 'CLR_FLD     '.
               88 WSS-CLRR     VALUE 'CLR_RNG     '.
               88 WSS-CLRA     VALUE 'CLR_ALL     '.
               88 WSS-CLRP     VALUE 'CLR_FRM     '.
               88 WSS-CLDP     VALUE 'CLR_DSP     '.
               88 WSS-DSPP     VALUE 'DSP_FRM     '.
               88 WSS-MSGD     VALUE 'MSG         '.
               88 WSS-MSGC     VALUE 'MSG_CLR     '.
               88 WSS-TSET     VALUE 'TAB_SET     '.
               88 WSS-TRST     VALUE 'TAB_RST     '.
               88 WSS-TERM     VALUE 'FIN         '.
               88 WSS-CHCK     VALUE 'CHK         '.
               88 WSS-FABT     VALUE 'ABT         '.
               88 WSS-ATRM     VALUE 'ATERM       '.
               88 WSS-AWSP     VALUE 'AWKSP       '.
               88 WSS-DTRM     VALUE 'DTERM       '.
               88 WSS-DWSP     VALUE 'DWKSP       '.
               88 WSS-LCHN     VALUE 'LCHAN       '.
               88 WSS-LCLO     VALUE 'LCLOS       '.
               88 WSS-LOPE     VALUE 'LOPEN       '.
               88 WSS-STRM     VALUE 'STERM       '.
               88 WSS-SWSP     VALUE 'SWKSP       '.
               88 WSS-TCHN     VALUE 'TCHAN       '.
               88 WSS-CDSP     VALUE 'CDISP       '.
               88 WSS-FDEL     VALUE 'DEL         '.
               88 WSS-DISP     VALUE 'DISP        '.
               88 WSS-DSPW     VALUE 'DISPW       '.
               88 WSS-GTAL     VALUE 'GETAL       '.
               88 WSS-LOAD     VALUE 'LOAD        '.
               88 WSS-NDSP     VALUE 'NDISP       '.
               88 WSS-PTAL     VALUE 'PUTAL       '.
               88 WSS-PTDA     VALUE 'PUTDA       '.
               88 WSS-READ     VALUE 'READ        '.
               88 WSS-RTAL     VALUE 'RETAL       '.
               88 WSS-AFCX     VALUE 'AFCX        '.
               88 WSS-AFVA     VALUE 'AFVA        '.
               88 WSS-FGET     VALUE 'GET         '.
               88 WSS-GTAF     VALUE 'GETAF       '.
               88 WSS-GTSC     VALUE 'GETSC       '.
               88 WSS-FPFT     VALUE 'PFT         '.
               88 WSS-FPUT     VALUE 'PUT         '.
               88 WSS-PUTD     VALUE 'PUTD        '.
               88 WSS-PTSC     VALUE 'PUTSC       '.
               88 WSS-FRET     VALUE 'RET         '.
               88 WSS-RTFN     VALUE 'RETFN       '.
               88 WSS-RTFO     VALUE 'RETFO       '.
               88 WSS-RTLE     VALUE 'RETLE       '.
               88 WSS-ADLV     VALUE 'ADLVA       '.
               88 WSS-BELL     VALUE 'BELL        '.
               88 WSS-CNCL     VALUE 'CANCL       '.
               88 WSS-FCLR     VALUE 'CLEAR       '.
               88 WSS-CLRV     VALUE 'CLEAR_VA    '.
               88 WSS-DFKB     VALUE 'DFKBD       '.
               88 WSS-DPCM     VALUE 'DPCOM       '.
               88 WSS-FXSC     VALUE 'FIX_SCREEN  '.
               88 WSS-GTDL     VALUE 'GETDL       '.
               88 WSS-ILTR     VALUE 'ILTRM       '.
               88 WSS-LEDF     VALUE 'LEDOF       '.
               88 WSS-LEDN     VALUE 'LEDON       '.
               88 WSS-PUTL     VALUE 'PUTL        '.
               88 WSS-RTCX     VALUE 'RETCX       '.
               88 WSS-RTDI     VALUE 'RETDI       '.
               88 WSS-RTDN     VALUE 'RETDN       '.
               88 WSS-RTFL     VALUE 'RETFL       '.
               88 WSS-RFSH     VALUE 'RFRSH       '.
               88 WSS-SWID     VALUE 'SCR_WIDTH   '.
               88 WSS-SGOP     VALUE 'SIGOP       '.
               88 WSS-SPDA     VALUE 'SPADA       '.
               88 WSS-SPOF     VALUE 'SPOFF       '.
               88 WSS-SPON     VALUE 'SPON        '.
               88 WSS-SIGQ     VALUE 'SSIGQ       '.
               88 WSS-SSRV     VALUE 'SSRV        '.
               88 WSS-FSTA     VALUE 'STAT        '.
               88 WSS-STIM     VALUE 'STIME       '.
               88 WSS-URFH     VALUE 'USER_REFRESH'.
               88 WSS-WAIT     VALUE 'WAIT        '.
       
       LINKAGE SECTION.
      *---------------
       01 LNK-CMND                         PIC X(20).
       
       PROCEDURE DIVISION USING LNK-CMND.
      *=================================
       
       MAIN SECTION.
      *------------
       INI-MAIN.
           IF PRIMERA-VEZ
               PERFORM FMS-IVEZ.
           MOVE ZERO TO FRM-STAT.
           MOVE LNK-CMND TO WSS-CMND.
           IF WSS-GETR
                  PERFORM FMS-GETR
               GO TO FIN-MAIN.
           IF WSS-MSGC
               PERFORM FMS-MSGC
               GO TO FIN-MAIN.
           IF WSS-MSGD
               PERFORM FMS-MSGD
               GO TO FIN-MAIN.
           IF WSS-GETA
               PERFORM FMS-GETA
               GO TO FIN-MAIN.
           IF WSS-GETM
               PERFORM FMS-GETM
               GO TO FIN-MAIN.
           IF WSS-CLRA
               PERFORM DRV-PTDA
               GO TO FIN-MAIN.
           IF WSS-PUTA
               PERFORM FMS-PUTA
               GO TO FIN-MAIN.
           IF WSS-FPUT
               PERFORM DRV-FPUT
               GO TO FIN-MAIN.
           IF WSS-CLRR
               PERFORM FMS-CLRR
               GO TO FIN-MAIN.
             IF WSS-GETF
               PERFORM FMS-GETF
               GO TO FIN-MAIN.
           IF WSS-CLRF
               PERFORM DRV-PUTD
               GO TO FIN-MAIN.
           IF WSS-RETA
               PERFORM FMS-RETA
               GO TO FIN-MAIN.
           IF WSS-INIT
                  PERFORM FMS-INIT
               GO TO FIN-MAIN.
           IF WSS-TERM
               PERFORM DRV-LCLO
               PERFORM DRV-DTRM
               GO TO FIN-MAIN.
           IF WSS-GETN
               PERFORM FMS-GETN
               GO TO FIN-MAIN.
           IF WSS-GET1
               PERFORM FMS-GET1
               GO TO FIN-MAIN.
           IF WSS-CLRP
               PERFORM DRV-FCLR
               GO TO FIN-MAIN.
           IF WSS-TSET
               PERFORM FMS-TSET
               GO TO FIN-MAIN.
           IF WSS-TRST
               PERFORM FMS-TRST
               GO TO FIN-MAIN.
           IF WSS-DSPP
               PERFORM FMS-DSPP
               GO TO FIN-MAIN.
           IF WSS-CLDP
               PERFORM FMS-CLDP
               GO TO FIN-MAIN.
           IF WSS-CHCK
               PERFORM FMS-CHCK
               GO TO FIN-MAIN.
           IF WSS-FABT
               PERFORM FMS-FABT
               GO TO FIN-MAIN.
           IF WSS-SWSP
               PERFORM DRV-SWSP
               GO TO FIN-MAIN.
           IF WSS-ADLV
               PERFORM DRV-ADLV
               GO TO FIN-MAIN.
           IF WSS-AFCX
               PERFORM DRV-AFCX
               GO TO FIN-MAIN.
           IF WSS-AFVA
               PERFORM DRV-AFVA
               GO TO FIN-MAIN.
           IF WSS-ATRM
               PERFORM DRV-ATRM
               GO TO FIN-MAIN.
           IF WSS-AWSP
               PERFORM DRV-AWSP
               GO TO FIN-MAIN.
           IF WSS-BELL
               PERFORM DRV-BELL
               GO TO FIN-MAIN.
           IF WSS-CNCL
               PERFORM DRV-CNCL
               GO TO FIN-MAIN.
           IF WSS-CDSP
               PERFORM DRV-CDSP
               GO TO FIN-MAIN.
           IF WSS-FCLR
               PERFORM DRV-FCLR
               GO TO FIN-MAIN.
           IF WSS-CLRV
               PERFORM DRV-CLRV
               GO TO FIN-MAIN.
           IF WSS-FDEL
               PERFORM DRV-FDEL
               GO TO FIN-MAIN.
           IF WSS-DFKB
               PERFORM DRV-DFKB
               GO TO FIN-MAIN.
           IF WSS-DISP
               PERFORM DRV-DISP
               GO TO FIN-MAIN.
           IF WSS-DSPW
               PERFORM DRV-DSPW
               GO TO FIN-MAIN.
           IF WSS-DPCM
               PERFORM DRV-DPCM
               GO TO FIN-MAIN.
           IF WSS-DTRM
               PERFORM DRV-DTRM
               GO TO FIN-MAIN.
           IF WSS-DWSP
               PERFORM DRV-DWSP
               GO TO FIN-MAIN.
           IF WSS-FXSC
               PERFORM DRV-FXSC
               GO TO FIN-MAIN.
           IF WSS-FGET
               PERFORM DRV-FGET
               GO TO FIN-MAIN.
           IF WSS-GTAF
               PERFORM DRV-GTAF
               GO TO FIN-MAIN.
           IF WSS-GTAL
               PERFORM DRV-GTAL
               GO TO FIN-MAIN.
           IF WSS-GTDL
               PERFORM DRV-GTDL
               GO TO FIN-MAIN.
           IF WSS-GTSC
               PERFORM DRV-GTSC
               GO TO FIN-MAIN.
           IF WSS-ILTR
               PERFORM DRV-ILTR
               GO TO FIN-MAIN.
           IF WSS-LCHN
               PERFORM DRV-LCHN
               GO TO FIN-MAIN.
           IF WSS-LCLO
               PERFORM DRV-LCLO
               GO TO FIN-MAIN.
           IF WSS-LEDF
               PERFORM DRV-LEDF
               GO TO FIN-MAIN.
           IF WSS-LEDN
               PERFORM DRV-LEDN
               GO TO FIN-MAIN.
           IF WSS-LOAD
               PERFORM DRV-LOAD
               GO TO FIN-MAIN.
           IF WSS-LOPE
               PERFORM DRV-LOPE
               GO TO FIN-MAIN.
           IF WSS-NDSP
               PERFORM DRV-NDSP
               GO TO FIN-MAIN.
           IF WSS-FPFT
               PERFORM DRV-FPFT
               GO TO FIN-MAIN.
           IF WSS-PTAL
               PERFORM DRV-PTAL
               GO TO FIN-MAIN.
           IF WSS-PUTD
               PERFORM DRV-PUTD
               GO TO FIN-MAIN.
           IF WSS-PTDA
               PERFORM DRV-PTDA
               GO TO FIN-MAIN.
           IF WSS-PUTL
               PERFORM DRV-PUTL
               GO TO FIN-MAIN.
           IF WSS-PTSC
               PERFORM DRV-PTSC
               GO TO FIN-MAIN.
           IF WSS-READ
               PERFORM DRV-READ
               GO TO FIN-MAIN.
           IF WSS-FRET
               PERFORM DRV-FRET
               GO TO FIN-MAIN.
           IF WSS-RTAL
               PERFORM DRV-RTAL
               GO TO FIN-MAIN.
           IF WSS-RTCX
               PERFORM DRV-RTCX
               GO TO FIN-MAIN.
           IF WSS-RTDI
               PERFORM DRV-RTDI
               GO TO FIN-MAIN.
           IF WSS-RTDN
               PERFORM DRV-RTDN
               GO TO FIN-MAIN.
           IF WSS-RTFL
               PERFORM DRV-RTFL
               GO TO FIN-MAIN.
           IF WSS-RTFN
               PERFORM DRV-RTFN
               GO TO FIN-MAIN.
           IF WSS-RTFO
               PERFORM DRV-RTFO
               GO TO FIN-MAIN.
           IF WSS-RTLE
               PERFORM DRV-RTLE
               GO TO FIN-MAIN.
           IF WSS-RFSH
               PERFORM DRV-RFSH
               GO TO FIN-MAIN.
           IF WSS-SWID
               PERFORM DRV-SWID
               GO TO FIN-MAIN.
           IF WSS-SGOP
               PERFORM DRV-SGOP
               GO TO FIN-MAIN.
           IF WSS-SPDA
               PERFORM DRV-SPDA
               GO TO FIN-MAIN.
           IF WSS-SPOF
               PERFORM DRV-SPOF
               GO TO FIN-MAIN.
           IF WSS-SPON
               PERFORM DRV-SPON
               GO TO FIN-MAIN.
           IF WSS-SIGQ
               PERFORM DRV-SIGQ
               GO TO FIN-MAIN.
           IF WSS-SSRV
               PERFORM DRV-SSRV
               GO TO FIN-MAIN.
           IF WSS-FSTA
               PERFORM DRV-STAT
               GO TO FIN-MAIN.
           IF WSS-STRM
               PERFORM DRV-STRM
               GO TO FIN-MAIN.
           IF WSS-STIM
               PERFORM DRV-STIM
               GO TO FIN-MAIN.
           IF WSS-TCHN
               PERFORM DRV-TCHN
               GO TO FIN-MAIN.
           IF WSS-URFH
               PERFORM DRV-URFH
               GO TO FIN-MAIN.
           IF WSS-WAIT
               PERFORM DRV-WAIT
               GO TO FIN-MAIN.
           DISPLAY '? Codigo '
               LINE 23 COLUMN 1 WITH BELL REVERSED.
       ERR-MAIN.
           DISPLAY     LNK-CMND REVERSED
               '  invalido en GNSPPFRM : ABORTO'
               LINE 24 COLUMN 1 REVERSED.
           STOP RUN.
       FIN-MAIN.
           EXIT PROGRAM.
       
       FMS-IVEZ SECTION.
       INI-FMS-IVEZ.
           MOVE FRM-FTCA-YES TO FRM-FTCA.
           MOVE FRM-FWSP-YES TO FRM-FWSP.
           MOVE 12            TO FRM-TTCA.
           MOVE 91            TO FRM-CTCA.
           MOVE 12            TO FRM-TWSP.
           MOVE 93            TO FRM-CLIB.
           MOVE 0            TO FRM-PLIN.
           MOVE SPACES       TO FRM-MENS.
           MOVE 0            TO FRM-IFLD.
           MOVE 0            TO FRM-TFLD.
           MOVE 0            TO FRM-INOV.
           MOVE 1            TO FRM-PCUR.
           MOVE 0            TO FRM-NLIN.
           MOVE 12            TO FRM-TMRF.
           MOVE 1            TO WSS-IVEZ.
       FIN-FMS-IVEZ.
           EXIT.
       
       FMS-MERR SECTION.
       INI-FMS-MERR.
           DISPLAY '? Parametros de Codigo '
               LINE 23 COLUMN 1 WITH BELL REVERSED.
           GO TO ERR-MAIN.
       FIN-FMS-MERR.
           EXIT.
       
       FMS-INIT SECTION.
       INI-FMS-INIT.
           IF FRM-FTCA = FRM-FTCA-YES
               PERFORM DRV-ATRM
               MOVE FRM-FTCA-NOT TO FRM-FTCA.
           IF FRM-FWSP = FRM-FWSP-YES
               PERFORM DRV-AWSP
               MOVE FRM-FWSP-NOT TO FRM-FWSP.
           IF FRM-SINI = FRM-SINI-DB1F
               PERFORM DRV-LOPE
               PERFORM DRV-CDSP
           ELSE
           IF FRM-SINI = FRM-SINI-DBNF
               PERFORM DRV-LOPE
               PERFORM DRV-DISP
           ELSE
           IF FRM-SINI = FRM-SINI-DBLF
               PERFORM DRV-LOPE
               PERFORM DRV-LOAD
           ELSE
           IF FRM-SINI = FRM-SINI-MB1F
               PERFORM DRV-LCHN
               PERFORM DRV-CDSP
           ELSE
           IF FRM-SINI = FRM-SINI-MBNF
               PERFORM DRV-LCHN
               PERFORM DRV-DISP
           ELSE
           IF FRM-SINI = FRM-SINI-MBLF
               PERFORM DRV-LCHN
               PERFORM DRV-LOAD
           ELSE
               PERFORM DRV-LOPE
               PERFORM DRV-CDSP.
       FIN-FMS-INIT.
           EXIT.
       
       FMS-CLDP SECTION.
       INI-FMS-CLDP.
           PERFORM DRV-FCLR.
           PERFORM DRV-DSPW.
       FIN-FMS-CLDP.
           EXIT.
       
       FMS-DSPP SECTION.
       INI-FMS-DSPP.
           PERFORM DRV-DSPW.
       FIN-FMS-DSPP.
           EXIT.
       
       FMS-FGET SECTION.
       INI-FMS-FGET.
           PERFORM DRV-FGET.
           UNSTRING FRM-NFLD DELIMITED BY '_' INTO
                    WSS-NREG WSS-KFLD WSS-NFLD.
           IF NOT ( WSS-KFLD = 'SGN' OR 'SGV' )
               GO TO FIN-FMS-FGET.
           UNSTRING FRM-2FLD DELIMITED BY '+' OR '-' OR '.'
               INTO WSS-VFLD DELIMITER WSS-SFLD.
           IF WSS-SFLD = '.' AND WSS-KFLD NOT = 'SGV'
               MOVE 'SOLO VALIDO NUMERO O SIGNO(+ -)' TO FRM-MENS
               PERFORM FMS-MSGD
               GO TO INI-FMS-FGET.
           IF WSS-SFLD = '+' OR '-'
               IF FRM-1FLD = ZERO
                   MOVE 0 TO J
                   INSPECT FRM-2FLD
                      TALLYING J FOR CHARACTERS BEFORE WSS-SFLD
                   MOVE 0 TO K
                   INSPECT FRM-2FLD
                      TALLYING K FOR ALL '0' BEFORE WSS-SFLD
                      REPLACING FIRST WSS-SFLD BY '0'
                   IF J = K
                      MOVE WSS-SFLD TO FRM-1FLD
                      PERFORM DRV-FPUT
                   ELSE
                      MOVE 'SIGNO(+ -) VALIDO SOLO PRIMERA POSICION'
                           TO FRM-MENS
                      PERFORM FMS-MSGD
                      GO TO INI-FMS-FGET
               ELSE
                   MOVE 'SIGNO(+ -) VALIDO SOLO PRIMERA POSICION'
                      TO FRM-MENS
                   PERFORM FMS-MSGD
                   GO TO INI-FMS-FGET
           ELSE
               IF FRM-1FLD = ZERO
                   MOVE '+' TO FRM-1FLD
                   PERFORM DRV-FPUT
               ELSE
               IF FRM-1FLD = '.' AND WSS-KFLD NOT = 'SGV'
                   MOVE 'SOLO VALIDO NUMERO O SIGNO(+ -)' TO FRM-MENS
                   PERFORM FMS-MSGD
                   GO TO INI-FMS-FGET
               ELSE
               IF NOT ( FRM-1FLD = '+' OR '-' )
                   MOVE 'LARGO CAMPO EXCEDIDO' TO FRM-MENS
                   PERFORM FMS-MSGD
                   GO TO INI-FMS-FGET.
       FIN-FMS-FGET.
           EXIT.
       
       FMS-GETF SECTION.
       INI-FMS-GETF.
           PERFORM FMS-FGET.
           IF FRM-UARV = SPACES OR LOW-VALUES
               GO TO FIN-FMS-GETF.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           CALL FRM-UARV USING FRM-VAL-FLD.
           IF FRM-SUAR = FRM-SUAR-OKS
               GO TO FIN-FMS-GETF.
           PERFORM FMS-MSGD.
           IF FRM-SUAR = FRM-SUAR-WRN
               GO TO FIN-FMS-GETF.
           IF FRM-SUAR = FRM-SUAR-CLR
               PERFORM DRV-PUTD.
           GO TO INI-FMS-GETF.
       FIN-FMS-GETF.
           EXIT.
       
       FMS-GETN SECTION.
       INI-FMS-GETN.
           MOVE FRM-FFLD-TAB TO FRM-FFLD.
           PERFORM DRV-FPFT.
           PERFORM FMS-GETF.
       FIN-FMS-GETN.
           EXIT.
       
       FMS-GET1 SECTION.
       INI-FMS-GET1.
           MOVE '*' TO FRM-NFLD.
           PERFORM FMS-FGET.
           PERFORM DRV-RTFN.
           IF FRM-UARV = SPACES OR LOW-VALUES
               GO TO FIN-FMS-GET1.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           CALL FRM-UARV USING FRM-VAL-FLD.
           IF FRM-SUAR = FRM-SUAR-OKS
               GO TO FIN-FMS-GET1.
           PERFORM FMS-MSGD.
           IF FRM-SUAR = FRM-SUAR-WRN
               GO TO FIN-FMS-GET1.
           IF FRM-SUAR = FRM-SUAR-CLR
               PERFORM DRV-PUTD.
           GO TO INI-FMS-GET1.
       FIN-FMS-GET1.
           EXIT.
       
       FMS-GETR SECTION.
       INI-FMS-GETR.
           MOVE FRM-PFLD TO FRM-NFLD.
           MOVE FRM-PIND TO FRM-IFLD.
       LUP-FMS-GETR.
           PERFORM FMS-FGET.
           IF FRM-FFLD = FRM-FFLD-BSP
               IF FRM-NFLD = FRM-PFLD AND FRM-IFLD = FRM-PIND
                   MOVE 'NO PUEDE IR A ESE CAMPO' TO FRM-MENS
                   PERFORM FMS-MSGD
                   GO TO LUP-FMS-GETR
               ELSE
                   PERFORM DRV-FPFT
                   GO TO LUP-FMS-GETR.
           IF FRM-FFLD = FRM-FFLD-TAB
               MOVE WSS-STAT-ABT TO FRM-STAT
               GO TO FIN-FMS-GETR.
           IF FRM-UARV = SPACES OR LOW-VALUES
               GO TO SIG-FMS-GETR.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           CALL FRM-UARV USING FRM-VAL-FLD.
           IF FRM-SUAR = FRM-SUAR-OKS
               GO TO SIG-FMS-GETR.
           PERFORM FMS-MSGD.
           IF FRM-SUAR = FRM-SUAR-WRN
               GO TO SIG-FMS-GETR.
           IF FRM-SUAR = FRM-SUAR-CLR
               PERFORM DRV-PUTD.
           GO TO LUP-FMS-GETR.
       SIG-FMS-GETR.
           IF FRM-FFLD = FRM-FFLD-PF4
               GO TO FIN-FMS-GETR.
           IF FRM-NFLD = FRM-UFLD AND FRM-IFLD = FRM-UIND
               GO TO FIN-FMS-GETR.
           MOVE FRM-FFLD-TAB TO FRM-FFLD.
           PERFORM DRV-FPFT.
           PERFORM DRV-STAT.
           IF FRM-STAT-OKS
               GO TO LUP-FMS-GETR.
           GO TO FMS-MERR.
       FIN-FMS-GETR.
           EXIT.

       FMS-GETA SECTION.
       INI-FMS-GETA.
           MOVE FRM-PFLD TO FRM-NFLD.
           MOVE FRM-PIND TO FRM-IFLD.
       LUP-FMS-GETA.
           PERFORM FMS-FGET.
           IF FRM-FFLD = FRM-FFLD-BSP
               IF FRM-NFLD = FRM-PFLD AND FRM-IFLD = FRM-PIND
                   MOVE 'NO PUEDE IR A ESE CAMPO' TO FRM-MENS
                   PERFORM FMS-MSGD
                   GO TO LUP-FMS-GETA
               ELSE
                   PERFORM DRV-FPFT
                   GO TO LUP-FMS-GETA.
           IF FRM-FFLD = FRM-FFLD-TAB
               MOVE WSS-STAT-ABT TO FRM-STAT
               GO TO FIN-FMS-GETA.
           IF FRM-UARV = SPACES OR LOW-VALUES
               GO TO SIG-FMS-GETA.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           CALL FRM-UARV USING FRM-VAL-FLD.
           IF FRM-SUAR = FRM-SUAR-OKS
               GO TO SIG-FMS-GETA.
           PERFORM FMS-MSGD.
           IF FRM-SUAR = FRM-SUAR-WRN
               GO TO SIG-FMS-GETA.
           IF FRM-SUAR = FRM-SUAR-CLR
               PERFORM DRV-PUTD.
           GO TO LUP-FMS-GETA.
       SIG-FMS-GETA.
           IF FRM-FFLD = FRM-FFLD-PF4
               GO TO FIN-FMS-GETA.
           MOVE FRM-FFLD-TAB TO FRM-FFLD.
           PERFORM DRV-FPFT.
           PERFORM DRV-STAT.
           IF FRM-STAT-OKS
               GO TO LUP-FMS-GETA.
       FIN-FMS-GETA.
           EXIT.
       
       FMS-GETM SECTION.
       INI-FMS-GETM.
      *     MOVE FRM-PFLD TO FRM-NFLD.
      *    MOVE FRM-PIND TO FRM-IFLD.
           MOVE FRM-IFLD TO FRM-PIND.
      *
      *     SEARCH FRM-LENG-TBL VARYING I
      *         WHEN FRM-LENG( FRM-LIDX ) = -1
      *             GO TO CON-FMS-GETM.
      *     SEARCH FRM-ATRB-TBL VARYING I
      *         WHEN FRM-ATRB( FRM-AIDX ) = FRM-CPIM-UBY
      *             GO TO CON-FMS-GETM.
      *     GO TO FMS-MERR.
           MOVE 0 TO WSS-1UNP WSS-OLDI.
           PERFORM FMS-PTRM VARYING I FROM 1 BY 1 UNTIL I > FRM-CFLD OR
                                                  WSS-OLDI > 0.
           IF WSS-OLDI = 0
               IF WSS-1UNP = 0
                   GO TO FIN-FMS-GETM
               ELSE
                   MOVE WSS-1UNP TO WSS-OLDI.
       CON-FMS-GETM.
           MOVE FRM-NOMB( WSS-OLDI ) TO FRM-NFLD.
       LUP-FMS-GETM.
           PERFORM FMS-FGET.
      *    IF FRM-FFLD = FRM-FFLD-TAB
           IF FRM-FFLD = FRM-FFLD-PF4
               MOVE WSS-STAT-ABT TO FRM-STAT
               GO TO FIN-FMS-GETM.

           IF FRM-FFLD = FRM-FFLD-TAB
               MOVE FRM-FFLD-TAB TO FRM-FFLD
               PERFORM FMS-FPFT
               GO TO LUP-FMS-GETM.

           IF FRM-FFLD = FRM-FFLD-BSP
               MOVE FRM-FFLD-BSP TO FRM-FFLD
               PERFORM FMS-FPFT
               GO TO LUP-FMS-GETM.

      *     IF FRM-FFLD NOT = FRM-FFLD-RET
      *         MOVE 'TECLA INVALIDA EN ESTE CONTEXTO' TO FRM-MENS
      *         PERFORM FMS-MSGD
      *         GO TO LUP-FMS-GETM.
       FIN-FMS-GETM.
           PERFORM DRV-RTAL.

       FMS-FPFT SECTION.
       INI-FMS-FPFT.
           MOVE FRM-NFLD TO WSS-ONFL.
           MOVE FRM-IFLD TO WSS-OIFL.

           PERFORM DRV-FPFT.
           MOVE 1 TO I.
           SET  FRM-NIDX TO 1.
           SEARCH FRM-NOMB-TBL VARYING I
               WHEN FRM-NOMB( FRM-NIDX ) = FRM-NFLD
                   GO TO CON-FMS-FPFT.
           GO TO FIN-FMS-FPFT.
       CON-FMS-FPFT.
      *    Si el campo esta protegido ...
           IF NOT ( FRM-ATRB( I ) = FRM-CPIM-UBY )
               IF I = FRM-CFLD OR I = 1 OR I = WSS-OLDI OR
                  (  FRM-NFLD = WSS-ONFL AND FRM-IFLD = WSS-OIFL )
                   MOVE FRM-PIND      TO FRM-IFLD
                   MOVE FRM-NOMB( WSS-1UNP ) TO FRM-NFLD
               ELSE
      *            MOVE I TO WSS-OLDI
                   GO TO INI-FMS-FPFT.
       FIN-FMS-FPFT.
           EXIT.

       FMS-PTRM SECTION.
       INI-FMS-PTRM.
           IF FRM-ATRB( I ) = FRM-CPIM-UBY AND WSS-1UNP = 0
               MOVE I TO WSS-1UNP.

           IF ( FRM-LENG( I ) = -1 OR -9 ) AND
                FRM-ATRB( I ) = FRM-CPIM-UBY
               MOVE I TO WSS-OLDI.
       FIN-FMS-PTRM.
           EXIT.

       FMS-RETA SECTION.
       INI-FMS-RETA.
           PERFORM DRV-RTAL.
       FIN-FMS-RETA.
           EXIT.
       
       FMS-PUTA SECTION.
       INI-FMS-PUTA.
           PERFORM DRV-PTAL.
       FIN-FMS-PUTA.
           EXIT.
       
       FMS-CLRR SECTION.
       INI-FMS-CLRR.
           MOVE FRM-PFLD TO FRM-NFLD.
           MOVE FRM-PIND TO FRM-IFLD.
           MOVE 1 TO FRM-TIME.
           PERFORM DRV-STIM.
           PERFORM DRV-FGET.
           MOVE 0 TO FRM-TIME.
           PERFORM DRV-STIM.
       LUP-FMS-CLRR.
           PERFORM DRV-PUTD.
           IF FRM-NFLD = FRM-UFLD AND FRM-IFLD = FRM-UIND
               GO TO FIN-FMS-CLRR.
           MOVE FRM-FFLD-TAB TO FRM-FFLD.
           PERFORM DRV-FPFT.
           PERFORM DRV-STAT.
           IF FRM-STAT-OKS
               GO TO LUP-FMS-CLRR.
           GO TO FMS-MERR.
       FIN-FMS-CLRR.
           EXIT.
       
       FMS-MSGD SECTION.
       INI-FMS-MSGD.
           MOVE 0 TO FRM-PLIN.
           PERFORM DRV-PUTL.
       FIN-FMS-MSGD.
           EXIT.
       
       FMS-MSGC SECTION.
       INI-FMS-MSGC.
           PERFORM FMS-MSGD.
           PERFORM DRV-PUTD.
       FIN-FMS-MSGC.
           EXIT.
       
       FMS-TSET SECTION.
       INI-FMS-TSET.
           MOVE 13 TO FRM-FKBD(1).
           MOVE 1033 TO FRM-FKBD(2).
           MOVE 11 TO FRM-FKBD(3).
           MOVE 1037 TO FRM-FKBD(4).
           MOVE 2 TO FRM-NKBD.
           PERFORM DRV-DFKB.
       FIN-FMS-TSET.
           EXIT.
       
       FMS-TRST SECTION.
       INI-FMS-TRST.
           MOVE 11 TO FRM-FKBD(1).
           MOVE 1033 TO FRM-FKBD(2).
           MOVE 13 TO FRM-FKBD(3).
           MOVE 1037 TO FRM-FKBD(4).
           MOVE 2 TO FRM-NKBD.
           PERFORM DRV-DFKB.
       FIN-FMS-TRST.
           EXIT.
       
       FMS-CHCK SECTION.
       INI-FMS-CHCK.
           PERFORM DRV-STAT.
           IF FRM-STAT-OKS
               GO TO FIN-FMS-CHCK.
           MOVE FRM-STAT TO FRM-EDIT.
           MOVE SPACES TO FRM-MENS.
           STRING 'Funcion : ' , FRM-FUNC , ' Status : ' , FRM-EDIT
               DELIMITED BY SIZE INTO FRM-MENS.
           PERFORM FMS-MSGD.
       FIN-FMS-CHCK.
           EXIT.

       FMS-FABT SECTION.
       INI-FMS-FABT.
           PERFORM FMS-MSGD.
           CALL 'SYS$EXIT' USING BY VALUE 0.
           STOP RUN.
       FIN-FMS-FABT.
           EXIT.

       DRV-ADLV SECTION.
       INI-DRV-ADLV.
           CALL 'FDV$ADLVA' USING
               BY DESCRIPTOR FRM-VIDE.
       FIN-DRV-ADLV.
           EXIT.
       
       DRV-AFCX SECTION.
       INI-DRV-AFCX.
           CALL 'FDV$AFCX' USING
               BY REFERENCE  FRM-INOV
                         FRM-PCUR
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-AFCX.
           EXIT.
       
       DRV-AFVA SECTION.
       INI-DRV-AFVA.
           CALL 'FDV$AFVA' USING
               BY REFERENCE  FRM-VIDE
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-AFVA.
           EXIT.
       
       DRV-ATRM SECTION.
       INI-DRV-ATRM.
           CALL 'FDV$ATERM' USING
               BY DESCRIPTOR FRM-RTCA
               BY REFERENCE  FRM-TTCA
                         FRM-CTCA.
       FIN-DRV-ATRM.
           EXIT.
       
       DRV-AWSP SECTION.
       INI-DRV-AWSP.
           CALL 'FDV$AWKSP' USING
               BY DESCRIPTOR FRM-RWSP
               BY REFERENCE  FRM-TWSP.
       FIN-DRV-AWSP.
           EXIT.
       
       DRV-BELL SECTION.
       INI-DRV-BELL.
           CALL 'FDV$BELL'.
       FIN-DRV-BELL.
           EXIT.
       
       DRV-CNCL SECTION.
       INI-DRV-CNCL.
           CALL 'FDV$CANCL'.
       FIN-DRV-CNCL.
           EXIT.
       
       DRV-CDSP SECTION.
       INI-DRV-CDSP.
           CALL 'FDV$CDISP' USING
               BY DESCRIPTOR FRM-NAME
               BY REFERENCE  FRM-PLIN.
       FIN-DRV-CDSP.
           EXIT.
       
       DRV-FCLR SECTION.
       INI-DRV-FCLR.
           CALL 'FDV$CLEAR' USING
               BY REFERENCE FRM-PLIN
                        FRM-NLIN.
       FIN-DRV-FCLR.
           EXIT.
       
       DRV-CLRV SECTION.
       INI-DRV-CLRV.
           CALL 'FDV$CLEAR_VA'.
       FIN-DRV-CLRV.
           EXIT.
       
       DRV-FDEL SECTION.
       INI-DRV-FDEL.
           CALL 'FDV$DEL' USING
               BY DESCRIPTOR FRM-NAME.
       FIN-DRV-FDEL.
           EXIT.
       
       DRV-DFKB SECTION.
       INI-DRV-DFKB.
           CALL 'FDV$DFKBD' USING
               BY DESCRIPTOR FRM-AKBD
               BY REFERENCE  FRM-NKBD.
       FIN-DRV-DFKB.
           EXIT.
       
       DRV-DISP SECTION.
       INI-DRV-DISP.
           CALL 'FDV$DISP' USING
               BY DESCRIPTOR FRM-NAME
               BY REFERENCE  FRM-PLIN.
       FIN-DRV-DISP.
           EXIT.
       
       DRV-DSPW SECTION.
       INI-DRV-DSPW.
           CALL 'FDV$DISPW' USING
               BY REFERENCE FRM-PLIN.
       FIN-DRV-DSPW.
           EXIT.
       
       DRV-DPCM SECTION.
       INI-DRV-DPCM.
           CALL 'FDV$DPCOM'.
       FIN-DRV-DPCM.
           EXIT.
       
       DRV-DTRM SECTION.
       INI-DRV-DTRM.
           CALL 'FDV$DTERM' USING
               BY DESCRIPTOR FRM-RTCA.
       FIN-DRV-DTRM.
           EXIT.
       
       DRV-DWSP SECTION.
       INI-DRV-DWSP.
           CALL 'FDV$DWKSP' USING
               BY DESCRIPTOR FRM-RWSP.
       FIN-DRV-DWSP.
           EXIT.
       
       DRV-FGET SECTION.
       INI-DRV-FGET.
           CALL 'FDV$GET' USING
               BY DESCRIPTOR FRM-VFLD
               BY REFERENCE  FRM-FFLD
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
      *INI 14-OCT-1998
      *Si apreto CONTROL-A necesita AYUDA
           IF FRM-FFLD = 1025
               CALL 'GNSPPAYD' USING BY REFERENCE FRM-NFLD
               PERFORM DRV-SWSP
               PERFORM DRV-RFSH
               GO TO INI-DRV-FGET.
      *FIN 14-OCT-1998
       FIN-DRV-FGET.
           EXIT.
       
       DRV-FXSC SECTION.
       INI-DRV-FXSC.
           CALL 'FDV$FIX_SCREEN'.
       FIN-DRV-FXSC.
           EXIT.
       
       DRV-GTAF SECTION.
       INI-DRV-GTAF.
           CALL 'FDV$GETAF' USING
               BY DESCRIPTOR FRM-VFLD
               BY REFERENCE  FRM-FFLD
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-GTAF.
           EXIT.
       
       DRV-GTAL SECTION.
       INI-DRV-GTAL.
           CALL 'FDV$GETAL' USING
               BY DESCRIPTOR FRM-DFLD
               BY REFERENCE  FRM-FFLD
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-GTAL.
           EXIT.
       
       DRV-GTDL SECTION.
       INI-DRV-GTDL.
           CALL 'FDV$GETDL' USING
               BY DESCRIPTOR FRM-VFLD
               BY REFERENCE  FRM-FFLD
                         FRM-PLIN
               BY DESCRIPTOR FRM-PRMT.
       FIN-DRV-GTDL.
           EXIT.
       
       DRV-GTSC SECTION.
       INI-DRV-GTSC.
           CALL 'FDV$GETSC' USING
               BY DESCRIPTOR FRM-NFLD
               BY DESCRIPTOR FRM-VFLD
               BY REFERENCE  FRM-FFLD.
       FIN-DRV-GTSC.
           EXIT.
       
       DRV-ILTR SECTION.
       INI-DRV-ILTR.
           CALL 'FDV$ILTRM' USING
               BY REFERENCE FRM-ITMN.
       FIN-DRV-ILTR.
           EXIT.
       
       DRV-LCHN SECTION.
       INI-DRV-LCHN.
           CALL 'FDV$LCHAN' USING
               BY REFERENCE FRM-CLIB.
       FIN-DRV-LCHN.
           EXIT.
       
       DRV-LCLO SECTION.
       INI-DRV-LCLO.
           CALL 'FDV$LCLOS'.
       FIN-DRV-LCLO.
           EXIT.
       
       DRV-LEDF SECTION.
       INI-DRV-LEDF.
           CALL 'FDV$LEDOF' USING
               BY REFERENCE FRM-TLED.
       FIN-DRV-LEDF.
           EXIT.
       
       DRV-LEDN SECTION.
       INI-DRV-LEDN.
           CALL 'FDV$LEDON' USING
               BY REFERENCE FRM-TLED.
       FIN-DRV-LEDN.
           EXIT.
       
       DRV-LOAD SECTION.
       INI-DRV-LOAD.
           CALL 'FDV$LOAD' USING
               BY DESCRIPTOR FRM-NAME.
       FIN-DRV-LOAD.
           EXIT.
       
       DRV-LOPE SECTION.
       INI-DRV-LOPE.
           CALL 'FDV$LOPEN' USING
               BY DESCRIPTOR FRM-NLIB
               BY REFERENCE  FRM-CLIB.
       FIN-DRV-LOPE.
           EXIT.
       
       DRV-NDSP SECTION.
       INI-DRV-NDSP.
           CALL 'FDV$NDISP'.
       FIN-DRV-NDSP.
           EXIT.
       
       DRV-FPFT SECTION.
       INI-DRV-FPFT.
           CALL 'FDV$PFT' USING
               BY REFERENCE  FRM-FFLD
               BY DESCRIPTOR FRM-NFLD
                         FRM-VFLD
                         FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-FPFT.
           EXIT.
       
       DRV-FPUT SECTION.
       INI-DRV-FPUT.
           CALL 'FDV$PUT' USING
               BY DESCRIPTOR FRM-VFLD
                         FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-FPUT.
           EXIT.
       
       DRV-PTAL SECTION.
       INI-DRV-PTAL.
           CALL 'FDV$PUTAL' USING
               BY DESCRIPTOR FRM-DFLD.
       FIN-DRV-PTAL.
           EXIT.
       
       DRV-PUTD SECTION.
       INI-DRV-PUTD.
           CALL 'FDV$PUTD' USING
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-PUTD.
           EXIT.
       
       DRV-PTDA SECTION.
       INI-DRV-PTDA.
           CALL 'FDV$PUTDA'.
       FIN-DRV-PTDA.
           EXIT.
       
       DRV-PUTL SECTION.
       INI-DRV-PUTL.
           CALL 'FDV$PUTL' USING
               BY DESCRIPTOR FRM-MENS
               BY REFERENCE  FRM-PLIN.
       FIN-DRV-PUTL.
           EXIT.
       
       DRV-PTSC SECTION.
       INI-DRV-PTSC.
           CALL 'FDV$PUTSC' USING
               BY DESCRIPTOR FRM-NFLD
               BY DESCRIPTOR FRM-DFLD.
       FIN-DRV-PTSC.
           EXIT.
       
       DRV-READ SECTION.
       INI-DRV-READ.
           CALL 'FDV$READ' USING
               BY DESCRIPTOR FRM-NAME
                         FRM-RMRF
               BY REFERENCE  FRM-TMRF
                         FRM-TMRF.
       FIN-DRV-READ.
           EXIT.
       
       DRV-FRET SECTION.
       INI-DRV-FRET.
           CALL 'FDV$RET' USING
               BY DESCRIPTOR FRM-VFLD
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-FRET.
           EXIT.
       
       DRV-RTAL SECTION.
       INI-DRV-RTAL.
           CALL 'FDV$RETAL' USING
               BY DESCRIPTOR FRM-DFLD.
       FIN-DRV-RTAL.
           EXIT.
       
       DRV-RTCX SECTION.
       INI-DRV-RTCX.
           CALL 'FDV$RETCX' USING
               BY REFERENCE  FRM-RTCA
                         FRM-RWSP
               BY DESCRIPTOR FRM-NAME
                         FRM-VUAR
               BY REFERENCE  FRM-PCUR
                         FRM-FFLD
                         FRM-INOV
                         FRM-NHLP.
       FIN-DRV-RTCX.
           EXIT.
       
       DRV-RTDI SECTION.
       INI-DRV-RTDI.
           CALL 'FDV$RETDI' USING
               BY REFERENCE  FRM-INMD
               BY DESCRIPTOR FRM-VNMD
               BY DESCRIPTOR FRM-NNMD.
       FIN-DRV-RTDI.
           EXIT.
       
       DRV-RTDN SECTION.
       INI-DRV-RTDN.
           CALL 'FDV$RETDN' USING
               BY DESCRIPTOR FRM-NNMD
               BY DESCRIPTOR FRM-VNMD
               BY DESCRIPTOR FRM-INMD.
       FIN-DRV-RTDN.
           EXIT.
       
       DRV-RTFL SECTION.
       INI-DRV-RTFL.
           CALL 'FDV$RETFL' USING
               BY REFERENCE  FRM-PLIN
               BY DESCRIPTOR FRM-VLIN
               BY REFERENCE  FRM-TLIN
                         FRM-KLIN.
       FIN-DRV-RTFL.
           EXIT.
       
       DRV-RTFN SECTION.
       INI-DRV-RTFN.
           CALL 'FDV$RETFN' USING
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-RTFN.
           EXIT.
       
       DRV-RTFO SECTION.
       INI-DRV-RTFO.
           CALL 'FDV$RETFO' USING
               BY REFERENCE  FRM-NFIL
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-RTFO.
           EXIT.
       
       DRV-RTLE SECTION.
       INI-DRV-RTLE.
           CALL 'FDV$RETLE' USING
               BY REFERENCE  FRM-TFLD
               BY DESCRIPTOR FRM-NFLD
               BY REFERENCE  FRM-IFLD.
       FIN-DRV-RTLE.
           EXIT.
       
       DRV-RFSH SECTION.
       INI-DRV-RFSH.
           CALL 'FDV$RFRSH'.
       FIN-DRV-RFSH.
           EXIT.
       
       DRV-SWID SECTION.
       INI-DRV-SWID.
           CALL 'FDV$SCR_WIDTH' USING
               BY REFERENCE FRM-WIDT.
       FIN-DRV-SWID.
           EXIT.
       
       DRV-SGOP SECTION.
       INI-DRV-SGOP.
           CALL 'FDV$SIGOP'.
       FIN-DRV-SGOP.
           EXIT.
       
       DRV-SPDA SECTION.
       INI-DRV-SPDA.
           CALL 'FDV$SPADA' USING
               BY REFERENCE FRM-KPAD.
       FIN-DRV-SPDA.
           EXIT.
       
       DRV-SPOF SECTION.
       INI-DRV-SPOF.
           CALL 'FDV$SPOFF'.
       FIN-DRV-SPOF.
           EXIT.
       
       DRV-SPON SECTION.
       INI-DRV-SPON.
           CALL 'FDV$SPON'.
       FIN-DRV-SPON.
           EXIT.
       
       DRV-SIGQ SECTION.
       INI-DRV-SIGQ.
           CALL 'FDV$SSIGQ' USING
               BY REFERENCE FRM-RBRV.
       FIN-DRV-SIGQ.
           EXIT.
       
       DRV-SSRV SECTION.
       INI-DRV-SSRV.
           CALL 'FDV$SSRV' USING
               BY REFERENCE FRM-STCA
                        FRM-UTCA.
       FIN-DRV-SSRV.
           EXIT.
       
       DRV-STAT SECTION.
       INI-DRV-STAT.
           CALL 'FDV$STAT' USING
               BY REFERENCE FRM-STAT
                        FRM-UWSP.
       FIN-DRV-STAT.
           EXIT.
       
       DRV-STRM SECTION.
       INI-DRV-STRM.
           CALL 'FDV$STERM' USING
               BY DESCRIPTOR FRM-RTCA.
       FIN-DRV-STRM.
           EXIT.
       
       DRV-STIM SECTION.
       INI-DRV-STIM.
           CALL 'FDV$STIME' USING
               BY REFERENCE FRM-TIME.
       FIN-DRV-STIM.
           EXIT.
       
       DRV-SWSP SECTION.
       INI-DRV-SWSP.
           CALL 'FDV$SWKSP' USING
               BY DESCRIPTOR FRM-RWSP.
       FIN-DRV-SWSP.
           EXIT.
       
       DRV-TCHN SECTION.
       INI-DRV-TCHN.
           CALL 'FDV$TCHAN' USING
               BY REFERENCE FRM-CTCA.
       FIN-DRV-TCHN.
           EXIT.
       
       DRV-URFH SECTION.
       INI-DRV-URFH.
           CALL 'FDV$USER_REFRESH' USING
               BY REFERENCE FRM-URFS.
       FIN-DRV-URFH.
           EXIT.
       
       DRV-WAIT SECTION.
       INI-DRV-WAIT.
           CALL 'FDV$WAIT' USING
               BY REFERENCE FRM-FFLD.
       FIN-DRV-WAIT.
           EXIT.
