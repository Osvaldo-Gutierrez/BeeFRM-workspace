IDENTIFICATION DIVISION.
*=======================
PROGRAM-ID.	DESFRMBCH.
AUTHOR.		GUZMAN Y CIA.

* Subrutina Manejo Moves y Validacion Formulario BCH.

ENVIRONMENT DIVISION.
*====================

DATA DIVISION.
*=============

WORKING-STORAGE SECTION.
*-----------------------
COPY	FRMWSS		IN	DESTXT.
01 WSS-VARI.
	03 WSS-CMND				PIC X(20).
		88 WSS-FLDV	VALUE 'VAL_FLD     '.
		88 WSS-CONV	VALUE 'VAL_CON     '.
		88 WSS-ACCV	VALUE 'VAL_ACC     '.
		88 WSS-GETV	VALUE 'VAL_GET     '.
		88 WSS-RETA	VALUE 'RET_ALL     '.
		88 WSS-RETC	VALUE 'RET_REC     '.
		88 WSS-PUTA	VALUE 'PUT_ALL     '.
		88 WSS-PUTC	VALUE 'PUT_REC     '.
		88 WSS-KEYA	VALUE 'KEY_ALL     '.
		88 WSS-KEYC	VALUE 'KEY_REC     '.
COPY	'FRMDATBCH'	IN	DESGEN.
COPY	'DESREG.BAT'	FROM DICTIONARY
	REPLACING
	==BAT==	BY	==BAT EXTERNAL==.
*% INCLUDE WSS OF 'DESFRMBCH.TXT'
*% INCLUDE WSS OF 'DESFRMBCH.GEN'

LINKAGE SECTION.
*---------------
01 LNK-CMND					PIC X(20).

PROCEDURE DIVISION USING LNK-CMND.
*=================================

MAIN SECTION.
*------------
INI-MAIN.
	MOVE LNK-CMND TO WSS-CMND.
	IF WSS-FLDV
		PERFORM VAL-FLD
		GO TO FIN-MAIN.
	IF WSS-CONV
		PERFORM VAL-CON
		GO TO FIN-MAIN.
	IF WSS-ACCV
		PERFORM VAL-ACC
		GO TO FIN-MAIN.
	IF WSS-GETV
		PERFORM VAL-GET
		GO TO FIN-MAIN.
	IF WSS-RETA
		PERFORM FMS-RETA
		GO TO FIN-MAIN.
	IF WSS-KEYA
		PERFORM FMS-KEYA
		GO TO FIN-MAIN.
	IF WSS-PUTA
		PERFORM FMS-PUTA
		GO TO FIN-MAIN.
	IF WSS-RETC
		PERFORM FMS-RETC
		GO TO FIN-MAIN.
	IF WSS-KEYC
		PERFORM FMS-KEYC
		GO TO FIN-MAIN.
	IF WSS-PUTC
		PERFORM FMS-PUTC
		GO TO FIN-MAIN.
	DISPLAY '? Codigo '
		LINE 23 COLUMN 1 WITH BELL REVERSED.
ERR-MAIN.
	DISPLAY	LNK-CMND REVERSED
		'  invalido en DESFRMBCH : ABORTO'
		LINE 24 COLUMN 1 REVERSED.
	STOP RUN.
FIN-MAIN.
	EXIT PROGRAM.

FMS-MERR SECTION.
INI-FMS-MERR.
	DISPLAY '? Parametros de Codigo '
		LINE 23 COLUMN 1 WITH BELL REVERSED.
	GO TO ERR-MAIN.
FIN-FMS-MERR.
	EXIT.

VAL-FLD SECTION.
INI-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-PROC
		PERFORM VAL-BAT-KEY-PROC
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-IGEN
		PERFORM VAL-FRM-IND-IGEN
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-NEJE
		PERFORM VAL-FRM-NUM-NEJE
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-COLA
		PERFORM VAL-FRM-GLS-COLA
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-IDEL
		PERFORM VAL-FRM-IND-IDEL
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-FORM
		PERFORM VAL-FRM-GLS-FORM
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-01
		PERFORM VAL-FRM-DAT-01
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-02
		PERFORM VAL-FRM-DAT-02
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-03
		PERFORM VAL-FRM-DAT-03
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-04
		PERFORM VAL-FRM-DAT-04
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-05
		PERFORM VAL-FRM-DAT-05
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-06
		PERFORM VAL-FRM-DAT-06
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-07
		PERFORM VAL-FRM-DAT-07
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-08
		PERFORM VAL-FRM-DAT-08
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-09
		PERFORM VAL-FRM-DAT-09
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-10
		PERFORM VAL-FRM-DAT-10
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-11
		PERFORM VAL-FRM-DAT-11
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-12
		PERFORM VAL-FRM-DAT-12
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-13
		PERFORM VAL-FRM-DAT-13
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-14
		PERFORM VAL-FRM-DAT-14
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-15
		PERFORM VAL-FRM-DAT-15
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-16
		PERFORM VAL-FRM-DAT-16
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-17
		PERFORM VAL-FRM-DAT-17
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-18
		PERFORM VAL-FRM-DAT-18
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-19
		PERFORM VAL-FRM-DAT-19
		GO TO FIN-VAL-FLD.
	IF FRM-NFLD = BCH-NOM-20
		PERFORM VAL-FRM-DAT-20
		GO TO FIN-VAL-FLD.
	PERFORM FMS-MERR.
FIN-VAL-FLD.
	EXIT.

VAL-CON SECTION.
INI-VAL-CON.
*% INCLUDE VAL_CON OF 'DESFRMBCH.TXT'
*% INCLUDE VAL_CON OF 'DESFRMBCH.GEN'
FIN-VAL-CON.
	EXIT.

VAL-ACC SECTION.
INI-VAL-ACC.
*% INCLUDE VAL_ACC OF 'DESFRMBCH.TXT'
*% INCLUDE VAL_ACC OF 'DESFRMBCH.GEN'
	MOVE FRM-SUAR-MAL TO FRM-SUAR.
FIN-VAL-ACC.
	EXIT.

VAL-GET SECTION.
INI-VAL-GET.
*% INCLUDE VAL_GET OF 'DESFRMBCH.TXT'
*% INCLUDE VAL_GET OF 'DESFRMBCH.GEN'
FIN-VAL-GET.
	EXIT.

FMS-RETA SECTION.
INI-FMS-RETA.
	PERFORM FMS-RETC-BAT.
FIN-FMS-RETA.
	EXIT.

FMS-PUTA SECTION.
INI-FMS-PUTA.
	PERFORM FMS-PUTC-BAT.
FIN-FMS-PUTA.
	EXIT.

FMS-KEYA SECTION.
INI-FMS-KEYA.
	PERFORM FMS-KEYC-BAT.
FIN-FMS-KEYA.
	EXIT.

FMS-RETC SECTION.
INI-FMS-RETC.
	IF FRM-NREG = 'BAT'
		PERFORM FMS-RETC-BAT
	ELSE
		PERFORM FMS-MERR.
FIN-FMS-RETC.
	EXIT.

FMS-PUTC SECTION.
INI-FMS-PUTC.
	IF FRM-NREG = 'BAT'
		PERFORM FMS-PUTC-BAT
	ELSE
		PERFORM FMS-MERR.
FIN-FMS-PUTC.
	EXIT.

FMS-KEYC SECTION.
INI-FMS-KEYC.
	IF FRM-NREG = 'BAT'
		PERFORM FMS-KEYC-BAT
	ELSE
		PERFORM FMS-MERR.
FIN-FMS-KEYC.
	EXIT.

FMS-RETC-BAT SECTION.
INI-FMS-RETC-BAT.
	MOVE BCH-KEY-PROC IN BCH-FLD TO BAT-KEY-PROC IN BAT.
FIN-FMS-RETC-BAT.
	EXIT.

FMS-PUTC-BAT SECTION.
INI-FMS-PUTC-BAT.
	MOVE BAT-KEY-PROC IN BAT TO BCH-KEY-PROC IN BCH-FLD.
	MOVE BCH-DFLD TO FRM-DFLD.
FIN-FMS-PUTC-BAT.
	EXIT.

FMS-KEYC-BAT SECTION.
INI-FMS-KEYC-BAT.
	MOVE BCH-KEY-PROC IN BCH-FLD TO BAT-KEY-PROC IN BAT.
FIN-FMS-KEYC-BAT.
	EXIT.

VAL-BAT-KEY-PROC SECTION.
INI-VAL-BAT-KEY-PROC.
	MOVE FRM-VFLD TO BCH-KEY-PROC IN BCH-FLD.
	IF BCH-KEY-PROC = SPACES
		MOVE 'DEBE SER DISTINTO DE ESPACIOS' TO FRM-MENS
		MOVE FRM-SUAR-MAL TO FRM-SUAR.
FIN-VAL-BAT-KEY-PROC.
	EXIT.

VAL-FRM-IND-IGEN SECTION.
INI-VAL-FRM-IND-IGEN.
	MOVE FRM-VFLD TO BCH-IND-IGEN IN BCH-FLD.
	IF NOT ( BCH-IND-IGEN = 'G' OR 'I' OR 'A' )
		MOVE 'DEBE SER G , I o A' TO FRM-MENS
		MOVE FRM-SUAR-CLR TO FRM-SUAR.
FIN-VAL-FRM-IND-IGEN.
	EXIT.

VAL-FRM-NUM-NEJE SECTION.
INI-VAL-FRM-NUM-NEJE.
	MOVE FRM-VFLD TO BCH-NUM-NEJE IN BCH-FLD.
	IF BCH-NUM-NEJE = ZEROES
		IF BCH-IND-IGEN = 'I' OR 'A'
			MOVE 'SE IMPRIMIRA CON EL DEFAULT' TO FRM-MENS
			MOVE FRM-SUAR-WRN TO FRM-SUAR
		ELSE
			NEXT SENTENCE
	ELSE
		IF BCH-IND-IGEN = 'G'
			MOVE 'NUMERO DE EJEMPLARES IGNORADO' TO FRM-MENS
			MOVE FRM-SUAR-WRN TO FRM-SUAR.
FIN-VAL-FRM-NUM-NEJE.
	EXIT.

VAL-FRM-GLS-COLA SECTION.
INI-VAL-FRM-GLS-COLA.
	MOVE FRM-VFLD TO BCH-GLS-COLA IN BCH-FLD.
	IF BCH-GLS-COLA = SPACES
		GO TO FIN-VAL-FRM-GLS-COLA.
	IF BCH-IND-IGEN = 'G'
		MOVE 'COLA DE IMPRESION IGNORADA' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR
	ELSE
	IF BCH-NUM-NEJE = ZEROES
		MOVE 'IGNORADA, SE IMPRIMIRA CON EL DEFAULT' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR.
FIN-VAL-FRM-GLS-COLA.
	EXIT.

VAL-FRM-IND-IDEL SECTION.
INI-VAL-FRM-IND-IDEL.
	MOVE FRM-VFLD TO BCH-IND-IDEL IN BCH-FLD.
	IF BCH-IND-IDEL = SPACES
		GO TO FIN-VAL-FRM-IND-IDEL.
	IF BCH-IND-IGEN = 'G'
		MOVE 'IGNORADO' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR
		GO TO FIN-VAL-FRM-IND-IDEL.
	IF BCH-NUM-NEJE = ZEROES
		MOVE 'IGNORADO, SE IMPRIMIRA CON EL DEFAULT' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR
		GO TO FIN-VAL-FRM-IND-IDEL.
	IF NOT ( BCH-IND-IDEL = 'S' OR 'N' OR SPACES )
		MOVE 'DEBE SER S (Si) , N o Blancos (No)' TO FRM-MENS
		MOVE FRM-SUAR-MAL TO FRM-SUAR.
FIN-VAL-FRM-IND-IDEL.
	EXIT.

VAL-FRM-GLS-FORM SECTION.
INI-VAL-FRM-GLS-FORM.
	MOVE FRM-VFLD TO BCH-GLS-FORM IN BCH-FLD.
	IF BCH-GLS-FORM = SPACES
		GO TO FIN-VAL-FRM-GLS-FORM.
	IF BCH-IND-IGEN = 'G'
		MOVE 'FORMULARIO ESPECIAL IGNORADO' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR
	ELSE
	IF BCH-NUM-NEJE = ZEROES
		MOVE 'IGNORADO, SE IMPRIMIRA CON EL DEFAULT' TO FRM-MENS
		MOVE FRM-SUAR-WRN TO FRM-SUAR.
FIN-VAL-FRM-GLS-FORM.
	EXIT.

VAL-FRM-DAT-01 SECTION.
INI-VAL-FRM-DAT-01.
	MOVE FRM-VFLD TO BCH-DAT-DATO(1).
*% INCLUDE FRM_DAT_01 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_01 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-01.
	EXIT.

VAL-FRM-DAT-02 SECTION.
INI-VAL-FRM-DAT-02.
	MOVE FRM-VFLD TO BCH-DAT-DATO(2).
*% INCLUDE FRM_DAT_02 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_02 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-02.
	EXIT.

VAL-FRM-DAT-03 SECTION.
INI-VAL-FRM-DAT-03.
	MOVE FRM-VFLD TO BCH-DAT-DATO(3).
*% INCLUDE FRM_DAT_03 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_03 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-03.
	EXIT.

VAL-FRM-DAT-04 SECTION.
INI-VAL-FRM-DAT-04.
	MOVE FRM-VFLD TO BCH-DAT-DATO(4).
*% INCLUDE FRM_DAT_04 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_04 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-04.
	EXIT.

VAL-FRM-DAT-05 SECTION.
INI-VAL-FRM-DAT-05.
	MOVE FRM-VFLD TO BCH-DAT-DATO(5).
*% INCLUDE FRM_DAT_05 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_05 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-05.
	EXIT.

VAL-FRM-DAT-06 SECTION.
INI-VAL-FRM-DAT-06.
	MOVE FRM-VFLD TO BCH-DAT-DATO(6).
*% INCLUDE FRM_DAT_06 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_06 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-06.
	EXIT.

VAL-FRM-DAT-07 SECTION.
INI-VAL-FRM-DAT-07.
	MOVE FRM-VFLD TO BCH-DAT-DATO(7).
*% INCLUDE FRM_DAT_07 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_07 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-07.
	EXIT.

VAL-FRM-DAT-08 SECTION.
INI-VAL-FRM-DAT-08.
	MOVE FRM-VFLD TO BCH-DAT-DATO(8).
*% INCLUDE FRM_DAT_08 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_08 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-08.
	EXIT.

VAL-FRM-DAT-09 SECTION.
INI-VAL-FRM-DAT-09.
	MOVE FRM-VFLD TO BCH-DAT-DATO(9).
*% INCLUDE FRM_DAT_09 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_09 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-09.
	EXIT.

VAL-FRM-DAT-10 SECTION.
INI-VAL-FRM-DAT-10.
	MOVE FRM-VFLD TO BCH-DAT-DATO(10).
*% INCLUDE FRM_DAT_10 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_10 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-10.
	EXIT.

VAL-FRM-DAT-11 SECTION.
INI-VAL-FRM-DAT-11.
	MOVE FRM-VFLD TO BCH-DAT-DATO(11).
*% INCLUDE FRM_DAT_11 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_11 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-11.
	EXIT.

VAL-FRM-DAT-12 SECTION.
INI-VAL-FRM-DAT-12.
	MOVE FRM-VFLD TO BCH-DAT-DATO(12).
*% INCLUDE FRM_DAT_12 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_12 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-12.
	EXIT.

VAL-FRM-DAT-13 SECTION.
INI-VAL-FRM-DAT-13.
	MOVE FRM-VFLD TO BCH-DAT-DATO(13).
*% INCLUDE FRM_DAT_13 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_13 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-13.
	EXIT.

VAL-FRM-DAT-14 SECTION.
INI-VAL-FRM-DAT-14.
	MOVE FRM-VFLD TO BCH-DAT-DATO(14).
*% INCLUDE FRM_DAT_14 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_14 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-14.
	EXIT.

VAL-FRM-DAT-15 SECTION.
INI-VAL-FRM-DAT-15.
	MOVE FRM-VFLD TO BCH-DAT-DATO(15).
*% INCLUDE FRM_DAT_15 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_15 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-15.
	EXIT.

VAL-FRM-DAT-16 SECTION.
INI-VAL-FRM-DAT-16.
	MOVE FRM-VFLD TO BCH-DAT-DATO(16).
*% INCLUDE FRM_DAT_16 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_16 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-16.
	EXIT.

VAL-FRM-DAT-17 SECTION.
INI-VAL-FRM-DAT-17.
	MOVE FRM-VFLD TO BCH-DAT-DATO(17).
*% INCLUDE FRM_DAT_17 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_17 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-17.
	EXIT.

VAL-FRM-DAT-18 SECTION.
INI-VAL-FRM-DAT-18.
	MOVE FRM-VFLD TO BCH-DAT-DATO(18).
*% INCLUDE FRM_DAT_18 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_18 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-18.
	EXIT.

VAL-FRM-DAT-19 SECTION.
INI-VAL-FRM-DAT-19.
	MOVE FRM-VFLD TO BCH-DAT-DATO(19).
*% INCLUDE FRM_DAT_19 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_19 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-19.
	EXIT.

VAL-FRM-DAT-20 SECTION.
INI-VAL-FRM-DAT-20.
	MOVE FRM-VFLD TO BCH-DAT-DATO(20).
*% INCLUDE FRM_DAT_20 OF 'DESFRMBCH.TXT'
*% INCLUDE FRM_DAT_20 OF 'DESFRMBCH.GEN'
FIN-VAL-FRM-DAT-20.
	EXIT.

*% INCLUDE EOF OF 'DESFRMBCH.TXT'
*% INCLUDE EOF OF 'DESFRMBCH.GEN'
