       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPFIFD.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    05-Aug-88 04:18 PM.

      * Subrutina de I/O Batch para archivo indexado VSAM GNSIFD (Reubicable).

       ENVIRONMENT DIVISION.
      *====================
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *DOS SELECT  GNSIFD ASSIGN TO SYS010-GNSIFD
      *MVS SELECT  GNSIFD ASSIGN TO        GNSIFD
           SELECT  GNSIFD ASSIGN TO SYS010-GNSIFD
                ORGANIZATION         IS INDEXED
                ACCESS               IS DYNAMIC
                RECORD KEY           IS IFD-COD-CIFD IN GNSIFD
                STATUS               IS FIO-STAT.

       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSIFD
           LABEL RECORDS STANDARD
           RECORD CONTAINS 241
       .
      *ALD
      *COPY GNSBRIFD.
       01  IFD.
           03  FILLER                                     PIC X(01).
           03  IFD-COD-CIFD                               PIC X(12).
           03  IFD-GLS-DATA                               PIC X(210).
           03  FILLER                                     PIC X(18).
      *
       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-RKEY                             PIC X(012).
       COPY GNSWCFIO.

       LINKAGE SECTION.
      *---------------
       COPY GNSWVFIO.
       01  LNK-REGI                             PIC X(241).

       PROCEDURE DIVISION USING FIO-VARI LNK-REGI.
      *==========================================

       COPY GNSBEFIO
           REPLACING
                FIO-VOID BY =='GNSIFD'==
           .
       MAIN SECTION.
       INI-MAIN.
           GO TO INI-GET-KEY     INI-GET-NXT     INI-GET-FST
                 INI-GET-NLS     INI-GET-GRT     INI-PUT-FIL
                 INI-MOD-FIL     INI-DEL-FIL     INI-CHG-FIL
                 INI-INP-FIL     INI-OUT-FIL     INI-UPD-FIL
                 INI-CLO-FIL     INI-FND-EQL     INI-FND-FST
                 INI-FND-NLS     INI-FND-GRT     ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT
           DEPENDING ON FIO-CMND.

       ERR-MAIN.
           DISPLAY '? CODIGO '
                FIO-CMND
                .
           DISPLAY '  INVALIDO EN GNSPFIFD PARA ARCHIVO '
                'GNSIFD'
                ' : ABORTO'
                .
           STOP RUN.
       FIN-MAIN.
           EXIT PROGRAM.

       GET-KEY SECTION.
       INI-GET-KEY.
           MOVE LNK-REGI TO IFD.
           READ GNSIFD INTO LNK-REGI.
           MOVE IFD-COD-CIFD TO WSS-RKEY.
       FIN-GET-KEY.
           EXIT PROGRAM.

       GET-NXT SECTION.
       INI-GET-NXT.
           READ GNSIFD NEXT INTO LNK-REGI.
           MOVE IFD-COD-CIFD TO WSS-RKEY.
       FIN-GET-NXT.
           EXIT PROGRAM.

       GET-FST SECTION.
       INI-GET-FST.
           MOVE LOW-VALUES TO IFD-COD-CIFD IN GNSIFD.
           START GNSIFD KEY NOT LESS IFD-COD-CIFD IN GNSIFD.
           IF FIO-STAT-OKS
               GO TO INI-GET-NXT.
       FIN-GET-FST.
           EXIT PROGRAM.

       GET-NLS SECTION.
       INI-GET-NLS.
           MOVE LNK-REGI TO IFD.
           START GNSIFD KEY NOT LESS IFD-COD-CIFD IN GNSIFD.
           IF FIO-STAT-OKS
               GO TO INI-GET-NXT.
       FIN-GET-NLS.
           EXIT PROGRAM.

       GET-GRT SECTION.
       INI-GET-GRT.
           MOVE LNK-REGI TO IFD.
           START GNSIFD KEY GREATER IFD-COD-CIFD IN GNSIFD.
           IF FIO-STAT-OKS
               GO TO INI-GET-NXT.
       FIN-GET-GRT.
           EXIT PROGRAM.

       PUT-FIL SECTION.
       INI-PUT-FIL.
           WRITE IFD FROM LNK-REGI.
       FIN-PUT-FIL.
           EXIT PROGRAM.

       MOD-FIL SECTION.
       INI-MOD-FIL.
           REWRITE IFD FROM LNK-REGI.
       FIN-MOD-FIL.
           EXIT PROGRAM.

       DEL-FIL SECTION.
       INI-DEL-FIL.
           MOVE LNK-REGI TO IFD.
           DELETE GNSIFD.
       FIN-DEL-FIL.
           EXIT PROGRAM.

       CHG-FIL SECTION.
       INI-CHG-FIL.
           WRITE IFD FROM LNK-REGI.
           IF NOT FIO-STAT-OKS
                GO TO FIN-CHG-FIL.
           MOVE WSS-RKEY TO IFD-COD-CIFD.
           DELETE GNSIFD.
       FIN-CHG-FIL.
           EXIT PROGRAM.

       INP-FIL SECTION.
       INI-INP-FIL.
           OPEN INPUT GNSIFD.
       FIN-INP-FIL.
           EXIT PROGRAM.

       OUT-FIL SECTION.
       INI-OUT-FIL.
           OPEN OUTPUT GNSIFD.
       FIN-OUT-FIL.
           EXIT PROGRAM.

       UPD-FIL SECTION.
       INI-UPD-FIL.
           OPEN I-O GNSIFD.
       FIN-UPD-FIL.
           EXIT PROGRAM.

       CLO-FIL SECTION.
       INI-CLO-FIL.
           CLOSE GNSIFD.
       FIN-CLO-FIL.
           EXIT PROGRAM.

       FND-EQL SECTION.
       INI-FND-EQL.
           MOVE LNK-REGI TO IFD.
           START GNSIFD KEY EQUAL IFD-COD-CIFD IN GNSIFD.
       FIN-FND-EQL.
           EXIT PROGRAM.

       FND-FST SECTION.
       INI-FND-FST.
           MOVE LOW-VALUES TO IFD-COD-CIFD IN GNSIFD.
           START GNSIFD KEY NOT LESS IFD-COD-CIFD IN GNSIFD.
       FIN-FND-FST.
           EXIT PROGRAM.

       FND-NLS SECTION.
       INI-FND-NLS.
           MOVE LNK-REGI TO IFD.
           START GNSIFD KEY NOT LESS IFD-COD-CIFD IN GNSIFD.
       FIN-FND-NLS.
           EXIT PROGRAM.

       FND-GRT SECTION.
       INI-FND-GRT.
           MOVE LNK-REGI TO IFD.
           START GNSIFD KEY GREATER IFD-COD-CIFD IN GNSIFD.
       FIN-FND-GRT.
           EXIT PROGRAM.

       ERR-ALT SECTION.
       INI-ERR-ALT.
           DISPLAY '? LLAVE'
                FIO-AKEY
                .
           DISPLAY '  INVALIDO EN GNSPFIFD PARA ARCHIVO '
                'GNSIFD'
                ' : ABORTO'
                .
           STOP RUN.
       FIN-ERR-ALT.
           EXIT PROGRAM.
