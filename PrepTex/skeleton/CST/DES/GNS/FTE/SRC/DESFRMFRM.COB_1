IDENTIFICATION DIVISION.
*=======================
PROGRAM-ID.	^sis^FRM^frm^.
AUTHOR.		GUZMAN Y CIA.

* Subrutina Manejo Moves y Validacion Formulario ^frm^.

ENVIRONMENT DIVISION.
*====================

DATA DIVISION.
*=============

WORKING-STORAGE SECTION.
*-----------------------
COPY	FRMWSS		IN	DESTXT.
01 WSS-VARI.
	03 WSS-CMND				PIC X(20).
		88 WSS-FLDV	VALUE 'VAL_FLD     '.
		88 WSS-CONV	VALUE 'VAL_CON     '.
		88 WSS-ACCV	VALUE 'VAL_ACC     '.
		88 WSS-GETV	VALUE 'VAL_GET     '.
		88 WSS-RETA	VALUE 'RET_ALL     '.
		88 WSS-RETC	VALUE 'RET_REC     '.
		88 WSS-PUTA	VALUE 'PUT_ALL     '.
		88 WSS-PUTC	VALUE 'PUT_REC     '.
		88 WSS-KEYA	VALUE 'KEY_ALL     '.
		88 WSS-KEYC	VALUE 'KEY_REC     '.

COPY	'FRMDAT^frm^'	IN	GEN.
^cpy^
*% INCLUDE WSS OF '^sis^FRM^frm^.TXT'
*% INCLUDE WSS OF '^sis^FRM^frm^.GEN'

LINKAGE SECTION.
*---------------
01 LNK-CMND					PIC X(20).

PROCEDURE DIVISION USING LNK-CMND.
*=================================

MAIN SECTION.
*------------
INI-MAIN.
	MOVE LNK-CMND TO WSS-CMND.
	IF WSS-FLDV
		PERFORM VAL-FLD
		GO TO FIN-MAIN.
	IF WSS-CONV
		PERFORM VAL-CON
		GO TO FIN-MAIN.
	IF WSS-ACCV
		PERFORM VAL-ACC
		GO TO FIN-MAIN.
	IF WSS-GETV
		PERFORM VAL-GET
		GO TO FIN-MAIN.
	IF WSS-RETA
		PERFORM FMS-RETA
		GO TO FIN-MAIN.
	IF WSS-KEYA
		PERFORM FMS-KEYA
		GO TO FIN-MAIN.
	IF WSS-PUTA
		PERFORM FMS-PUTA
		GO TO FIN-MAIN.
	IF WSS-RETC
		PERFORM FMS-RETC
		GO TO FIN-MAIN.
	IF WSS-KEYC
		PERFORM FMS-KEYC
		GO TO FIN-MAIN.
	IF WSS-PUTC
		PERFORM FMS-PUTC
		GO TO FIN-MAIN.
	DISPLAY '? Codigo '
		LINE 23 COLUMN 1 WITH BELL REVERSED.
ERR-MAIN.
	DISPLAY	LNK-CMND REVERSED
		'  invalido en ^sis^FRM^frm^ : ABORTO'
		LINE 24 COLUMN 1 REVERSED.
	STOP RUN.
FIN-MAIN.
	EXIT PROGRAM.

FMS-MERR SECTION.
INI-FMS-MERR.
	DISPLAY '? Parametros de Codigo '
		LINE 23 COLUMN 1 WITH BELL REVERSED.
	GO TO ERR-MAIN.
FIN-FMS-MERR.
	EXIT.

VAL-FLD SECTION.
INI-VAL-FLD.
^ifs^
FIN-VAL-FLD.
	EXIT.

VAL-CON SECTION.
INI-VAL-CON.
*% INCLUDE VAL_CON OF '^sis^FRM^frm^.TXT'
*% INCLUDE VAL_CON OF '^sis^FRM^frm^.GEN'
FIN-VAL-CON.
	EXIT.

VAL-ACC SECTION.
INI-VAL-ACC.
*% INCLUDE VAL_ACC OF '^sis^FRM^frm^.TXT'
*% INCLUDE VAL_ACC OF '^sis^FRM^frm^.GEN'
		MOVE FRM-SUAR-MAL TO FRM-SUAR.
FIN-VAL-ACC.
	EXIT.

VAL-GET SECTION.
INI-VAL-GET.
*% INCLUDE VAL_GET OF '^sis^FRM^frm^.TXT'
*% INCLUDE VAL_GET OF '^sis^FRM^frm^.GEN'
FIN-VAL-GET.
	EXIT.

^mov^
^val^

*% INCLUDE EOF OF '^sis^FRM^frm^.TXT'
*% INCLUDE EOF OF '^sis^FRM^frm^.GEN'
