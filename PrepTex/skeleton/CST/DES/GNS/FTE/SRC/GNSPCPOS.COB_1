       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPCPOS.
       AUTHOR.          CONSIST.

      * PROGRAMA PARA GRABAR REGISTROS PARA HELP

       ENVIRONMENT DIVISION.
      *====================
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT  HLPPOS ASSIGN TO SYS010-HLPPOS
                ORGANIZATION     IS INDEXED
                ACCESS           IS DYNAMIC
                RECORD KEY       IS POS-KEY-IREG
                STATUS           IS WSS-STAT.

       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  HLPPOS
           LABEL RECORDS STANDARD.
       01  POS.
           02 POS-KEY-IREG                      PIC X(11).
           02 FILLER                            PIC X(43).

       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-VARI.
           03 WSS-STAT                          PIC X(02).
              88 WSS-STAT-OKS        VALUE '00'.
           03 WSS-RPOS.
              05 WSS-KPOS                       PIC X(11).
              05 FILLER                         PIC X(43).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           OPEN I-O HLPPOS.
           IF NOT WSS-STAT-OKS
               DISPLAY 'ERROR ABRIR I-O' WSS-STAT
               GO TO FIN-MAIN.

       LUP-MAIN.
           ACCEPT WSS-RPOS.
           IF WSS-KPOS NOT > SPACES
               GO TO CLO-MAIN.

           MOVE WSS-RPOS TO POS.
           READ HLPPOS.
           IF WSS-STAT-OKS
               MOVE WSS-RPOS TO POS
               REWRITE POS
           ELSE
               MOVE WSS-RPOS TO POS
               WRITE POS.
           IF NOT WSS-STAT-OKS
               DISPLAY WSS-STAT ' EN REG : ' POS
           ELSE
               DISPLAY 'OK EN REG : ' POS.

           GO TO LUP-MAIN.

       CLO-MAIN.
           CLOSE HLPPOS.
       FIN-MAIN.
           STOP RUN.
