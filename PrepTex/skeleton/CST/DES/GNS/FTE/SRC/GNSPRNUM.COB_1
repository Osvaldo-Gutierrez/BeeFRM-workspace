       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    GNSPRNUM.
       AUTHOR.        GUZMAN Y CIA.

      * Prueba Rutina para Validacion Numerica

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-VARI.
           03 WSS-NUM-NUME-ALF              PIC X(18).
           03 WSS-NUM-NUME-EDT REDEFINES WSS-NUM-NUME-ALF
                                            PIC Z.ZZZ.ZZZ.ZZZ,ZZZZ.
           03 WSS-NUM-NUME     REDEFINES WSS-NUM-NUME-ALF
                                            PIC 9999999999V9999.

       COPY GNSWVNUM.
       COPY GNSWCNUM.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           DISPLAY 'INGRESE NUMERO :'.
           ACCEPT WSS-NUM-NUME-ALF.
           IF WSS-NUM-NUME-ALF = 'FIN'
               GO TO FIN-MAIN.
           MOVE WSS-NUM-NUME-ALF TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE  4 TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           DISPLAY 'NUM-STAT : ' NUM-STAT.
           IF NUM-STAT-OKS
               DISPLAY '    NUM-NN9V         : '
                            NUM-NN9V WITH CONVERSION
               MOVE NUM-NN9V TO WSS-NUM-NUME
               DISPLAY '    WSS-NUM-NUME     : '
                            WSS-NUM-NUME WITH CONVERSION

               MOVE WSS-NUM-NUME TO WSS-NUM-NUME-EDT
               DISPLAY '    WSS-NUM-NUME-EDT : '
                            WSS-NUM-NUME-EDT
           ELSE
               DISPLAY NUM-MENS.
           GO TO INI-MAIN.
       FIN-MAIN.
           STOP RUN.
