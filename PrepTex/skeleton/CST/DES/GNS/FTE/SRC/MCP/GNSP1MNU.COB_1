      *$ASCII
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSP1MNU.
       AUTHOR.          CONSIST.
      * 
       ENVIRONMENT DIVISION.
      *====================
      *
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSMNS ASSIGN TO 'C:GNSMMNU.SEQ[U490]'
                  ORGANIZATION   IS SEQUENTIAL
                  ACCESS MODE    IS SEQUENTIAL
                  FILE STATUS    IS FIO-STAT.
      *
       CONFIGURATION SECTION.
      *---------------------
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD GNSMNS 
           LABEL RECORDS STANDARD
           RECORD CONTAINS 490.
      *
       COPY GNSBRMNS.
      *
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS
       01  WSS-I       VALUE ZEROES PIC 9(06).
      * WORKING PARA RUTINAS.
       COPY GNSWGSYS.
      * COPY GNSWGFEC.
      * COPY GNSWGHOY.
       COPY GNSWCFIO.
       COPY GNSWVFIO.

       COPY GNSBRMNU.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           PERFORM OPN-FILE.
           PERFORM PRO-FILE.
           PERFORM CLO-FILE.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       OPN-FILE SECTION.
      *------------------
       INI-OPE-FILE.
           OPEN OUTPUT GNSMNS.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO OUTPUT GNSMNS FS ' 
                        FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO INPUT  GNSMNU FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
       FIN-OPN-FILE.
           EXIT.

       PRO-FILE SECTION.
      *----------------------
       INI-PRO-FILE.
           MOVE ZEROES       TO WSS-I.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE PRIMER REGISTRO'
              DISPLAY 'ABORTO'
              STOP RUN.
           PERFORM MNU-TRS-MNS UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FILE.
           EXIT.

       MNU-TRS-MNS SECTION.
       INI-MNU-TRS-MNS.
      *GRABA MNS DESDE MNU.
           ADD  1   TO WSS-I.
      *
           MOVE CORR MNU TO MNS.

           MOVE SPACES TO MNU-GLS-FLAG IN MNS.
           IF  MNU-COD-NEMO IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-NEMO IN MNS.
           IF  MNU-COD-OPCI IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-OPCI IN MNS.
           IF  MNU-COD-IMEN IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-IMEN IN MNS.
           IF  MNU-COD-TFUN IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-TFUN IN MNS.
           IF  MNU-GLS-FMEN IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-FMEN IN MNS.
           IF  MNU-GLS-CMND IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-CMND IN MNS.
           IF  MNU-GLS-TRAN IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-TRAN IN MNS.
           IF  MNU-COD-CMND IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-CMND IN MNS.
           IF  MNU-GLS-LDOC IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-LDOC IN MNS.
           IF  MNU-GLS-NDOC IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-NDOC IN MNS.
           IF  MNU-GLS-LFRM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-LFRM IN MNS.
           IF  MNU-GLS-NFRM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-NFRM IN MNS.
           IF  MNU-GLS-FPRO IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-FPRO IN MNS.
           IF  MNU-NUM-FILA IN MNS NOT > ZEROES
                MOVE ZEROES TO MNU-NUM-FILA IN MNS.
           IF  MNU-NUM-COLU IN MNS NOT > ZEROES
                MOVE ZEROES TO MNU-NUM-COLU IN MNS.
           IF  MNU-COD-FRET IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-FRET IN MNS.
           IF  MNU-IND-CONF IN MNS NOT > SPACES
                MOVE SPACES TO MNU-IND-CONF IN MNS.
           IF  MNU-COD-MENU IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-MENU IN MNS.
           IF  MNU-IND-IPRV IN MNS NOT > SPACES
                MOVE SPACES TO MNU-IND-IPRV IN MNS.
           IF  MNU-COD-INST IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-INST IN MNS.
           IF  MNU-IND-EXGL IN MNS NOT > SPACES
                MOVE SPACES TO MNU-IND-EXGL IN MNS.
           IF  MNU-IND-SEQU IN MNS NOT > SPACES
                MOVE SPACES TO MNU-IND-SEQU IN MNS.
           IF  MNU-COD-SIST IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-SIST IN MNS.
           IF  MNU-COD-TCTL IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-TCTL IN MNS.
           IF  MNU-COD-EJFR IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-EJFR IN MNS.
           IF  MNU-COD-FANT IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-FANT IN MNS.
           IF  MNU-COD-TABL IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-TABL IN MNS.
           IF  MNU-IND-NCLR IN MNS NOT > SPACES
                MOVE SPACES TO MNU-IND-NCLR IN MNS.
           IF  MNU-GLS-LFVX IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-LFVX IN MNS.
           IF  MNU-GLS-NFVX IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-NFVX IN MNS.
           IF  MNU-GLS-PRGM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-PRGM IN MNS.
           IF  MNU-COD-CIFD IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-CIFD IN MNS.
           IF  MNU-COD-TINF IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-TINF IN MNS.
           IF  MNU-COD-MSAL IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-MSAL IN MNS.
           IF  MNU-COD-ASCR IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-ASCR IN MNS.
           IF  MNU-COD-AMPG IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-AMPG IN MNS.
           IF  MNU-GLS-NMHD IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-NMHD IN MNS.
           IF  MNU-GLS-LMHD IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-LMHD IN MNS.
           IF  MNU-COD-AMHD IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-AMHD IN MNS.
           IF  MNU-GLS-NMCM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-NMCM IN MNS.
           IF  MNU-GLS-LMCM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-GLS-LMCM IN MNS.
           IF  MNU-COD-AMCM IN MNS NOT > SPACES
                MOVE SPACES TO MNU-COD-AMCM IN MNS.
           MOVE SPACES TO MNU-GLS-DISP IN MNS.

           WRITE MNS.
      *
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM GNS-FIO-MNU.
       FIN-MNU-TRS-MNS.
           EXIT.

       CLO-FILE SECTION.
      *------------------
       INI-CLO-FILE.
           DISPLAY 'NRO. REG. TRASPASADOS :' WSS-I.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
      *
           CLOSE GNSMNS.
      *
       FIN-CLO-FILE.
           EXIT.

      * RUTINAS
       COPY GNSBBSYS.
      * COPY GNSBGEND.

       COPY GNSBFMNU.

