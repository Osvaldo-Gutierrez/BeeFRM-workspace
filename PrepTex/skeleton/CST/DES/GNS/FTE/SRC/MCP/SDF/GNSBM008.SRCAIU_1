%! BM008.SRC VAL-[FLD] SECTION
%! TIPO VRF
% IF TIDX > 0 THEN
% FRM_IFLD = "(FRM-IFLD)"
*% FRM_IFLD = "(FRM-IFLD)"
% ELSE
% FRM_IFLD = ""
*% FRM_IFLD = ""
% END
% TIPO_{TIPO} = TRUE
% IF TIPO_VRF THEN
% IF NOT TIENE_IDC_{RREG}_IDC_{NOMB} THEN
       VAL-{RREG}-NUM-{NOMB} SECTION.
       INI-VAL-{RREG}-NUM-{NOMB}.
*% INCLUDE INI_{RREG}_NUM_{NOMB} {ARCA}
*% INCLUDE {RREG}_NUM_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_NUM_{NOMB} {ARCA}
       FIN-VAL-{RREG}-NUM-{NOMB}.
           EXIT.

       VAL-{RREG}-VRF-{NOMB} SECTION.
       INI-VAL-{RREG}-VRF-{NOMB}.
*% INCLUDE INI_{RREG}_VRF_{NOMB} {ARCA}
% IF OBLI THEN
% IF NOT DISP THEN
           IF {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > SPACES
              PERFORM ERR-GLS.
% END IF
% ELSE
           IF {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > SPACES
              MOVE SPACES TO {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD}.
% END IF
% IF NOT DISP THEN
*% INCLUDE 'SETVRF'
% END IF
% IF NOT DISP THEN
*% INCLUDE 'PROVRF'
% END IF
*% INCLUDE {RREG}_VRF_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_VRF_{NOMB} {ARCA}
       FIN-VAL-{RREG}-VRF-{NOMB}.
           EXIT.

% END IF
% ELSE
%! TIPO IDC
% IF TIPO_IDC THEN
       VAL-{RREG}-IND-{NOMB} SECTION.
       INI-VAL-{RREG}-IND-{NOMB}.
*% INCLUDE INI_{RREG}_IND_{NOMB} {ARCA}
           IF {RREG}-IND-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > SPACES
              MOVE SPACES TO {RREG}-IND-{NOMB} IN {FRM}-FLD{FRM_IFLD}.
% IF NOT DISP THEN
*% INCLUDE 'VALIDC'
% END IF
*% INCLUDE {RREG}_IND_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_IND_{NOMB} {ARCA}
       FIN-VAL-{RREG}-IND-{NOMB}.
           EXIT.

       VAL-{RREG}-GLS-{NOMB} SECTION.
       INI-VAL-{RREG}-GLS-{NOMB}.
*% LBL = "{RREG}_GLS_{NOMB} {ARCA}"
*% INCLUDE INI_{RREG}_GLS_{NOMB} {ARCA}
% IF OBLI THEN
% IF NOT DISP THEN
           IF {RREG}-GLS-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > IDC-INIC-GLS
              PERFORM ERR-GLS.
% END IF
% ELSE
           IF {RREG}-GLS-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO {RREG}-GLS-{NOMB} IN {FRM}-FLD{FRM_IFLD}.
% END IF
*% INCLUDE {RREG}_GLS_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_GLS_{NOMB} {ARCA}
       FIN-VAL-{RREG}-GLS-{NOMB}.
           EXIT.

       VAL-{RREG}-NUM-{NOMB} SECTION.
       INI-VAL-{RREG}-NUM-{NOMB}.
*% INCLUDE INI_{RREG}_NUM_{NOMB} {ARCA}
*% INCLUDE {RREG}_NUM_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_NUM_{NOMB} {ARCA}
       FIN-VAL-{RREG}-NUM-{NOMB}.
           EXIT.

       VAL-{RREG}-VRF-{NOMB} SECTION.
       INI-VAL-{RREG}-VRF-{NOMB}.
*% LBL = "{RREG}_VRF_{NOMB} {ARCA}"
*% INCLUDE INI_{RREG}_VRF_{NOMB} {ARCA}
% IF OBLI THEN
% IF NOT DISP THEN
           IF {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > SPACES
              PERFORM ERR-GLS.
% END IF
% ELSE
           IF {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD} NOT > SPACES
              MOVE SPACES TO {RREG}-VRF-{NOMB} IN {FRM}-FLD{FRM_IFLD}.
% END IF
% IF NOT DISP THEN
*% INCLUDE 'VALRUT'
% END IF
*% INCLUDE {RREG}_VRF_{NOMB} {ARCA}
*% INCLUDE FIN_{RREG}_VRF_{NOMB} {ARCA}
       FIN-VAL-{RREG}-VRF-{NOMB}.
           EXIT.

% ELSE
%! TIPO FEC Y SUS DERIVADOS
% IF TIPO_FEC OR TIPO_DMA OR TIPO_AMD OR TIPO_MSA OR TIPO_SAM OR TIPO_FMA OR TIPO_FAM OR TIPO_FSA OR TIPO_FAS OR TIPO_FDM OR TIPO_FMD OR TIPO_FFA THEN
       VAL-{CAMP} SECTION.
       INI-VAL-{CAMP}.
% IF OBLI THEN
% IF NOT DISP THEN
           IF {CAMP} IN {FRM}-FLD{FRM_IFLD}  NOT > SPACES
              PERFORM ERR-GLS.
% END IF
% ELSE
           IF {CAMP} IN {FRM}-FLD{FRM_IFLD}  NOT > SPACES
              MOVE ZEROES TO {CAMP} IN {FRM}-FLD{FRM_IFLD}.
% END IF
% IF NOT DISP THEN
*% INCLUDE 'SETFEC'
% END IF
*% INCLUDE INI_{LBL}
% IF NOT DISP THEN
*% INCLUDE 'PROFEC'
% END IF
*% INCLUDE {LBL}
*% INCLUDE FIN_{LBL}
       FIN-VAL-{CAMP}.
           EXIT.
% END IF
% END IF
% END IF
% TIPO_{TIPO} = FALSE
