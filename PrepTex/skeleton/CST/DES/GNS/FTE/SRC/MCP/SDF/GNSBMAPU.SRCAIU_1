      * 10-Oct-97 01:53 PM
       PUT-ALL-APU SECTION.
       INI-PUT-ALL-APU.
           PERFORM PUT-RUP-APU.
           PERFORM PUT-USR-APU.
       FIN-PUT-ALL-APU.
           EXIT.
      
       PUT-RUP-APU SECTION.
       INI-PUT-RUP-APU.
           IF PGM-STAT-RUP-NUL
               GO TO FIN-PUT-RUP-APU.
           IF NOT PGM-STAT-RUP-OKS
               PERFORM CLR-RUP-APU
               GO TO FIN-PUT-RUP-APU.
           MOVE RUP-COD-USER IN RUP TO RUP-COD-USER IN APU-FLD.
           MOVE RUP-COD-PSWD IN RUP TO RUP-COD-PSWD IN APU-FLD.
       FIN-PUT-RUP-APU.
           EXIT.
      
       PUT-USR-APU SECTION.
       INI-PUT-USR-APU.
           IF PGM-STAT-USR-NUL
               GO TO FIN-PUT-USR-APU.
           IF NOT PGM-STAT-USR-OKS
               PERFORM CLR-USR-APU
               GO TO FIN-PUT-USR-APU.
           MOVE USR-GLS-DESC IN USR TO USR-GLS-DESC IN APU-FLD.
       FIN-PUT-USR-APU.
           EXIT.
      * 10-Oct-97 01:53 PM
       RET-ALL-APU SECTION.
       INI-RET-ALL-APU.
           PERFORM KEY-ALL-APU.
           PERFORM RET-RUP-APU.
           PERFORM RET-USR-APU.
       FIN-RET-ALL-APU.
           EXIT.
      
       RET-RUP-APU SECTION.
       INI-RET-RUP-APU.
           MOVE RUP-COD-PSWD IN APU-FLD TO RUP-COD-PSWD IN RUP.
       FIN-RET-RUP-APU.
           EXIT.
      
       RET-USR-APU SECTION.
       INI-RET-USR-APU.
           MOVE USR-GLS-DESC IN APU-FLD TO USR-GLS-DESC IN USR.
       FIN-RET-USR-APU.
           EXIT.
      
       KEY-ALL-APU SECTION.
       INI-KEY-ALL-APU.
           PERFORM KEY-RUP-APU.
           PERFORM KEY-USR-APU.
       FIN-KEY-ALL-APU.
           EXIT.
      
       KEY-RUP-APU SECTION.
       INI-KEY-RUP-APU.
           MOVE RUP-COD-USER IN APU-FLD TO RUP-COD-USER IN RUP.
       FIN-KEY-RUP-APU.
           EXIT.
      
       KEY-USR-APU SECTION.
       INI-KEY-USR-APU.
       FIN-KEY-USR-APU.
           EXIT.
      
       SCR-CLRA-APU SECTION.
       INI-SCR-CLRA-APU.
           PERFORM CLR-KEY-APU.
           PERFORM CLR-FLD-APU.
           IF SCR-INST =  SCR-INST-GKY
           IF WSS-IND-USSP = "N"
               DISPLAY "CAH: SCR-USER EN SCR-CLRA-APU:" SCR-USER
               MOVE SCR-USER TO RUP-COD-USER IN APU-FLD
               MOVE RUP-COD-USER IN APU-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO USR-GLS-DESC IN APU-FLD.
      *>>>>
       FIN-SCR-CLRA-APU.
           EXIT.
      
       CLR-KEY-APU SECTION.
       INI-CLR-KEY-APU.
           MOVE SPACES TO RUP-COD-USER IN APU-FLD.
           MOVE SPACES TO FRM-COD-PSWO IN APU-FLD.
       FIN-CLR-KEY-APU.
           EXIT.
      
       CLR-FLD-APU SECTION.
       INI-CLR-FLD-APU.
           MOVE SPACES TO FRM-COD-PSWV IN APU-FLD.
           PERFORM CLR-RUP-APU.
           PERFORM CLR-USR-APU.
       FIN-CLR-FLD-APU.
           EXIT.
      
       CLR-RUP-APU SECTION.
       INI-CLR-RUP-APU.
           MOVE SPACES TO RUP-COD-PSWD IN APU-FLD.
       FIN-CLR-RUP-APU.
           EXIT.
      
       CLR-USR-APU SECTION.
       INI-CLR-USR-APU.
           MOVE SPACES TO USR-GLS-DESC IN APU-FLD.
       FIN-CLR-USR-APU.
           EXIT.
      
       FST-KEY-APU SECTION.
       INI-FST-KEY-APU.
      *<<<< INI_FST_KEY_APU
           IF WSS-IND-USSP = "N"
               MOVE FRM-POS-CURS TO FRM-COD-PSWO-LEN IN APU-FLD
               GO TO FIN-FST-KEY-APU.
      *>>>>
           MOVE FRM-POS-CURS TO RUP-COD-USER-LEN IN APU-FLD.
       FIN-FST-KEY-APU.
           EXIT.
      
       FST-FLD-APU SECTION.
       INI-FST-FLD-APU.
           MOVE FRM-POS-CURS TO RUP-COD-PSWD-LEN IN APU-FLD.
       FIN-FST-FLD-APU.
           EXIT.
      
       PRO-KEY-APU SECTION.
       INI-PRO-KEY-APU.
           MOVE FRM-CPIM-ANY TO FRM-COD-PSWO-ATR IN APU-FLD.
           PERFORM PRO-IKY-APU.
           PERFORM PRO-AKY-APU.
           PERFORM PRO-MKY-APU.
       FIN-PRO-KEY-APU.
           EXIT.
      
       PRO-IKY-APU SECTION.
       INI-PRO-IKY-APU.
           MOVE FRM-CPIM-AEY TO RUP-COD-USER-ATR IN APU-FLD.
           MOVE FRM-CPIM-ANY TO FRM-COD-PSWO-ATR IN APU-FLD.
       FIN-PRO-IKY-APU.
           EXIT.
      
       PRO-MKY-APU SECTION.
       INI-PRO-MKY-APU.
       FIN-PRO-MKY-APU.
           EXIT.
      
       PRO-AKY-APU SECTION.
       INI-PRO-AKY-APU.
       FIN-PRO-AKY-APU.
           EXIT.
      
       PRO-FLD-APU SECTION.
       INI-PRO-FLD-APU.
           MOVE FRM-CPIM-ANY TO FRM-COD-PSWV-ATR IN APU-FLD.
           PERFORM PRO-RUP-APU.
           PERFORM PRO-USR-APU.
       FIN-PRO-FLD-APU.
           EXIT.
      
       PRO-RUP-APU SECTION.
       INI-PRO-RUP-APU.
           MOVE FRM-CPIM-ANY TO RUP-COD-PSWD-ATR IN APU-FLD.
       FIN-PRO-RUP-APU.
           EXIT.
      
       PRO-USR-APU SECTION.
       INI-PRO-USR-APU.
       FIN-PRO-USR-APU.
           EXIT.
      
       PRO-PROT-APU SECTION.
       INI-PRO-PROT-APU.
           MOVE FRM-CPIM-AEY TO USR-GLS-DESC-ATR IN APU-FLD.
       FIN-PRO-PROT-APU.
           EXIT.
      
       UNP-KEY-APU SECTION.
       INI-UNP-KEY-APU.
           MOVE FRM-CPIM-UNY TO FRM-COD-PSWO-ATR IN APU-FLD.
           PERFORM UNP-IKY-APU.
           PERFORM UNP-AKY-APU.
           PERFORM UNP-MKY-APU.
       FIN-UNP-KEY-APU.
           EXIT.
      
       UNP-IKY-APU SECTION.
       INI-UNP-IKY-APU.
           MOVE FRM-CPIM-UBY TO RUP-COD-USER-ATR IN APU-FLD.
           MOVE FRM-CPIM-UNY TO FRM-COD-PSWO-ATR IN APU-FLD.
      *<<<< FIN_UNP_IKY_APU
           IF WSS-IND-USSP = "N"
              MOVE FRM-CPIM-AEY TO RUP-COD-USER-ATR IN APU-FLD
           ELSE
              MOVE FRM-CPIM-AEY TO FRM-COD-PSWO-ATR IN APU-FLD.
      *>>>>
       FIN-UNP-IKY-APU.
           EXIT.
      
       UNP-MKY-APU SECTION.
       INI-UNP-MKY-APU.
       FIN-UNP-MKY-APU.
           EXIT.
      
       UNP-AKY-APU SECTION.
       INI-UNP-AKY-APU.
       FIN-UNP-AKY-APU.
           EXIT.
      
       UNP-FLD-APU SECTION.
       INI-UNP-FLD-APU.
           MOVE FRM-CPIM-UNY TO FRM-COD-PSWV-ATR IN APU-FLD.
           PERFORM UNP-RUP-APU.
           PERFORM UNP-USR-APU.
       FIN-UNP-FLD-APU.
           EXIT.
      
       UNP-RUP-APU SECTION.
       INI-UNP-RUP-APU.
           MOVE FRM-CPIM-UNY TO RUP-COD-PSWD-ATR IN APU-FLD.
       FIN-UNP-RUP-APU.
           EXIT.
      
       UNP-USR-APU SECTION.
       INI-UNP-USR-APU.
       FIN-UNP-USR-APU.
           EXIT.
      
       VAL-KEY-APU SECTION.
       INI-VAL-KEY-APU.
           PERFORM VAL-IKY-APU.
           PERFORM VAL-MKY-APU.
           PERFORM VAL-AKY-APU.
       FIN-VAL-KEY-APU.
           EXIT.
      
       VAL-IKY-APU SECTION.
       INI-VAL-IKY-APU.
           PERFORM VAL-RUP-COD-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RUP-COD-USER-LEN IN APU-FLD
                GO TO FIN-VAL-IKY-APU.
           PERFORM VAL-FRM-COD-PSWO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-PSWO-LEN IN APU-FLD
                GO TO FIN-VAL-IKY-APU.
       FIN-VAL-IKY-APU.
           EXIT.
      
       VAL-MKY-APU SECTION.
       INI-VAL-MKY-APU.
       FIN-VAL-MKY-APU.
           EXIT.
      
       VAL-AKY-APU SECTION.
       INI-VAL-AKY-APU.
       FIN-VAL-AKY-APU.
           EXIT.
      
       VAL-FLD-APU SECTION.
       INI-VAL-FLD-APU.
           PERFORM VAL-USR-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO USR-GLS-DESC-LEN IN APU-FLD
                GO TO FIN-VAL-FLD-APU.
           PERFORM VAL-RUP-COD-PSWD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RUP-COD-PSWD-LEN IN APU-FLD
                GO TO FIN-VAL-FLD-APU.
           PERFORM VAL-FRM-COD-PSWV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-PSWV-LEN IN APU-FLD
                GO TO FIN-VAL-FLD-APU.
       FIN-VAL-FLD-APU.
           EXIT.
      
       VAL-RUP-COD-USER SECTION.
       INI-VAL-RUP-COD-USER.
      *<<<< INI_RUP_COD_USER
           IF WSS-IND-USSP = "N"
               MOVE SCR-USER TO RUP-COD-USER IN APU-FLD.
      *>>>>
           IF RUP-COD-USER IN APU-FLD NOT > SPACES
              MOVE SPACES TO RUP-COD-USER IN APU-FLD.
      *<<<< RUP_COD_USER
           MOVE RUP-COD-USER IN APU-FLD TO USR-COD-USER IN USR.
           DISPLAY "CAH: RUP-USER:" RUP-COD-USER IN APU-FLD
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT > SPACES
               MOVE "00" TO PGM-STAT-USR
               MOVE USR-GLS-DESC IN USR TO USR-GLS-DESC IN APU-FLD
           ELSE
               DISPLAY "CAH: MALO COD:" MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               IF MSG-COD-MENS = "COD    NEX"
                    MOVE SPACES TO USR-GLS-DESC IN APU-FLD.
      *>>>>
       FIN-VAL-RUP-COD-USER.
           EXIT.
      
       VAL-USR-GLS-DESC SECTION.
       INI-VAL-USR-GLS-DESC.
       FIN-VAL-USR-GLS-DESC.
           EXIT.
      
       VAL-FRM-COD-PSWO SECTION.
       INI-VAL-FRM-COD-PSWO.
           IF FRM-COD-PSWO IN APU-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-PSWO IN APU-FLD.
       FIN-VAL-FRM-COD-PSWO.
           EXIT.
      
       VAL-RUP-COD-PSWD SECTION.
       INI-VAL-RUP-COD-PSWD.
           IF RUP-COD-PSWD IN APU-FLD NOT > SPACES
              MOVE SPACES TO RUP-COD-PSWD IN APU-FLD.
       FIN-VAL-RUP-COD-PSWD.
           EXIT.
      
       VAL-FRM-COD-PSWV SECTION.
       INI-VAL-FRM-COD-PSWV.
           IF FRM-COD-PSWV IN APU-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-PSWV IN APU-FLD.
       FIN-VAL-FRM-COD-PSWV.
           EXIT.
      
       VAL-CON-KEY-APU SECTION.
       INI-VAL-CON-KEY-APU.
           IF     RUP-COD-USER IN APU-FLD NOT > SPACES
              AND FRM-COD-PSWO IN APU-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-APU.
      *<<<< FIN_VAL_CON_KEY_APU
           IF WSS-IND-USSP = "S"
               GO TO FIN-VAL-CON-KEY-APU.
      
           MOVE RUP-COD-USER IN APU-FLD TO RUP-COD-USER IN RUP.
           MOVE 99999                   TO RUP-NUM-CORR IN RUP.
           MOVE FIO-GET-LEQ             TO FIO-CMND.
      
           PERFORM GNS-FIO-RUP.
           IF NOT (FIO-STAT-OKS AND
                   RUP-COD-USER IN RUP = RUP-COD-USER IN APU-FLD)
               MOVE "RUP    NEX" TO MSG-COD-MENS
               GO TO ERR-VAL-CON-KEY-APU.
      
           IF RUP-NUM-INTE IN RUP NOT < 3
               MOVE "INTE>=3     " TO MSG-COD-MENS
               GO TO ERR-VAL-CON-KEY-APU.
      
           MOVE FIO-BEG-TRN TO FIO-CMND.
           MOVE "GNS" TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-RUP.
           IF NOT FIO-STAT-OKS
               MOVE "RUPUPDERR" TO MSG-COD-MENS
               GO TO ERR-VAL-CON-KEY-APU.
      
           IF RUP-COD-PSWD IN RUP NOT = FRM-COD-PSWO IN APU-FLD
               PERFORM SET-NUM-INTE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GNS-FIO-RUP
               IF NOT FIO-STAT-OKS
                   MOVE FIO-CHK-PNT TO FIO-CMND
                   MOVE "GNS" TO FIO-SIST
                   PERFORM GNS-FIO-TAB
                   MOVE "ERR    PMAL" TO MSG-COD-MENS
                   GO TO ERR-VAL-CON-KEY-APU
               ELSE
                   MOVE FIO-CHK-PNT TO FIO-CMND
                   MOVE "GNS" TO FIO-SIST
                   PERFORM GNS-FIO-TAB
                   MOVE "RUPPSWDERR" TO MSG-COD-MENS
                   GO TO ERR-VAL-CON-KEY-APU
           ELSE
               MOVE ZEROES TO RUP-NUM-INTE IN RUP
               MOVE FIO-MOD TO FIO-CMND
               PERFORM GNS-FIO-RUP
               MOVE FIO-CHK-PNT TO FIO-CMND
               MOVE "GNS" TO FIO-SIST
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE "ERR    PMAL" TO MSG-COD-MENS
                   GO TO ERR-VAL-CON-KEY-APU.
      
           GO TO FIN-VAL-CON-KEY-APU.
      
       ERR-VAL-CON-KEY-APU.
           MOVE FRM-POS-CURS TO FRM-COD-PSWO-LEN IN APU-FLD.
           MOVE "S" TO FRM-UCUR.
           MOVE "GNS" TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      
      *>>>>
       FIN-VAL-CON-KEY-APU.
           EXIT.
      
       VAL-CON-IKY-APU SECTION.
       INI-VAL-CON-IKY-APU.
           IF     RUP-COD-USER IN APU-FLD NOT > SPACES
              AND FRM-COD-PSWO IN APU-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-APU.
       FIN-VAL-CON-IKY-APU.
           EXIT.
      
       VAL-CON-FLD-APU SECTION.
       INI-VAL-CON-FLD-APU.
      *<<<< VAL_CON_FLD_APU
           IF RUP-COD-PSWD IN APU-FLD NOT = FRM-COD-PSWV IN APU-FLD
               MOVE "RUP<>PSW/VER" TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-APU.
      
           MOVE RUP-COD-USER IN APU-FLD TO RUP-COD-USER IN RUP.
           MOVE 99999                   TO RUP-NUM-CORR IN RUP.
           MOVE FIO-GET-LEQ             TO FIO-CMND.
      
           PERFORM GNS-FIO-RUP.
           IF NOT (FIO-STAT-OKS AND
                   RUP-COD-USER IN RUP = RUP-COD-USER IN APU-FLD)
               MOVE SPACES TO RUP
               MOVE RUP-COD-USER IN APU-FLD TO RUP-COD-USER IN RUP
               MOVE 1                       TO RUP-NUM-CORR IN RUP
           ELSE
               ADD 1                        TO RUP-NUM-CORR IN RUP.
      
           MOVE FIO-BEG-TRN TO FIO-CMND.
           MOVE "GNS" TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           PERFORM RET-HDR-RUP.
           MOVE RUP-COD-PSWD IN APU-FLD TO RUP-COD-PSWD IN RUP.
           MOVE "I" TO RUP-MSC-TACC IN RUP.
           MOVE "S" TO RUP-COD-STAT IN RUP.
           MOVE ZEROES TO RUP-NUM-INTE IN RUP.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-RUP.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           MOVE "GNS" TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE "RUPPUTERR" TO MSG-COD-MENS
               GO TO ERR-VAL-CON-FLD-APU.
      
           IF WSS-IND-USSP = "N"
               MOVE "HBLCNFUSSPN" TO MSG-COD-MENS
           ELSE
               MOVE "HBLCNFUSSPS" TO MSG-COD-MENS.
           MOVE "GNS" TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      
           GO TO FIN-VAL-CON-FLD-APU.
      
       ERR-VAL-CON-FLD-APU.
           MOVE "GNS" TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      
      *>>>>
       FIN-VAL-CON-FLD-APU.
           EXIT.
      
       VAL-CON-APU SECTION.
       INI-VAL-CON-APU.
       FIN-VAL-CON-APU.
           EXIT.
      
       VAL-NUM-KEY-APU SECTION.
       INI-VAL-NUM-KEY-APU.
           PERFORM VAL-NUM-IKY-APU.
           PERFORM VAL-NUM-MKY-APU.
           PERFORM VAL-NUM-AKY-APU.
       FIN-VAL-NUM-KEY-APU.
           EXIT.
      
       VAL-NUM-IKY-APU SECTION.
       INI-VAL-NUM-IKY-APU.
       FIN-VAL-NUM-IKY-APU.
           EXIT.
      
       VAL-NUM-MKY-APU SECTION.
       INI-VAL-NUM-MKY-APU.
       FIN-VAL-NUM-MKY-APU.
           EXIT.
      
       VAL-NUM-AKY-APU SECTION.
       INI-VAL-NUM-AKY-APU.
       FIN-VAL-NUM-AKY-APU.
           EXIT.
      
       VAL-NUM-FLD-APU SECTION.
       INI-VAL-NUM-FLD-APU.
       FIN-VAL-NUM-FLD-APU.
           EXIT.
      
       EDT-KEY-APU SECTION.
       INI-EDT-KEY-APU.
           PERFORM EDT-IKY-APU.
           PERFORM EDT-MKY-APU.
           PERFORM EDT-AKY-APU.
       FIN-EDT-KEY-APU.
           EXIT.
      
       EDT-IKY-APU SECTION.
       INI-EDT-IKY-APU.
       FIN-EDT-IKY-APU.
           EXIT.
      
       EDT-MKY-APU SECTION.
       INI-EDT-MKY-APU.
       FIN-EDT-MKY-APU.
           EXIT.
      
       EDT-AKY-APU SECTION.
       INI-EDT-AKY-APU.
       FIN-EDT-AKY-APU.
           EXIT.
      
       EDT-FLD-APU SECTION.
       INI-EDT-FLD-APU.
       FIN-EDT-FLD-APU.
           EXIT.
      
       RST-ATR-APU SECTION.
       INI-RST-ATR-APU.
      *     MOVE SPACES TO RUP-COD-USER-ATR IN APU-FLD.
           MOVE SPACES TO RUP-COD-USER-LEN IN APU-FLD.
      *     MOVE SPACES TO USR-GLS-DESC-ATR IN APU-FLD.
           MOVE SPACES TO USR-GLS-DESC-LEN IN APU-FLD.
      *     MOVE SPACES TO FRM-COD-PSWO-ATR IN APU-FLD.
           MOVE SPACES TO FRM-COD-PSWO-LEN IN APU-FLD.
      *     MOVE SPACES TO RUP-COD-PSWD-ATR IN APU-FLD.
           MOVE SPACES TO RUP-COD-PSWD-LEN IN APU-FLD.
      *     MOVE SPACES TO FRM-COD-PSWV-ATR IN APU-FLD.
           MOVE SPACES TO FRM-COD-PSWV-LEN IN APU-FLD.
       FIN-RST-ATR-APU.
           EXIT.
      *<<<< EOF
       SET-NUM-INTE SECTION.
       INI-SET-NUM-INTE.
           ADD 1 TO RUP-NUM-INTE IN RUP.
           IF RUP-NUM-INTE IN RUP NOT < 3
               MOVE "N" TO RUP-COD-STAT IN RUP.
       FIN-SET-NUM-INTE.
           EXIT.
      *>>>>
