       IDENTIFICATION DIVISION.
       PROGRAM-ID.   GNSPP2TX.
       AUTHOR.       CONSIST.
       DATE-WRITTEN.  18-MAR-1998 11:07:13.
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77  SW-FIN               PIC S9(11) BINARY.
           88 FIN               VALUE 1.
       77  UNO                  PIC S9(11) BINARY VALUE 1.
       01  MSG                  PIC X(1920).
       COMMUNICATION SECTION.
       INPUT HEADER  COMS-IN.
       OUTPUT HEADER COMS-OUT.
       PROCEDURE DIVISION.
       P1.
            CHANGE ATTRIBUTE LIBACCESS OF "COMSSUPPORT" TO BYFUNCTION.
            CHANGE ATTRIBUTE FUNCTIONNAME OF "COMSSUPPORT"
                TO "COMSSUPPORT".
            ENABLE INPUT COMS-IN KEY "ONLINE".
            PERFORM PROCESO THRU PROCESO-FIN UNTIL FIN.
            STOP RUN.
       PROCESO.
            RECEIVE COMS-IN MESSAGE INTO MSG.
            IF STATUSVALUE OF COMS-IN = 99
               MOVE 1 TO SW-FIN
               GO TO PROCESO-FIN.
            MOVE SPACES TO MSG.
            STRING @11@ DELIMITED BY SIZE,
                   @1203@ DELIMITED BY SIZE
              INTO MSG.
            MOVE 100 TO TEXTLENGTH OF COMS-OUT.
            MOVE STATION OF COMS-IN TO DESTINATIONDESG OF COMS-OUT.
            MOVE 1 TO DESTCOUNT OF COMS-OUT.
            IF (FUNCTIONSTATUS OF COMS-IN = -11)
              MOVE UNO TO TOGGLES OF COMS-OUT
            ELSE
              MOVE ZEROS TO TOGGLES OF COMS-OUT.
            SEND COMS-OUT FROM MSG.
       PROCESO-FIN.
            EXIT.
