      * 11-May-98 07:08 PM
       PUT-ALL-ROE SECTION.
       INI-PUT-ALL-ROE.
           PERFORM PUT-ROE-ROE.
       FIN-PUT-ALL-ROE.
           EXIT.
      
       PUT-ROE-ROE SECTION.
       INI-PUT-ROE-ROE.
           IF PGM-STAT-ROE-NUL
               GO TO FIN-PUT-ROE-ROE.
           IF NOT PGM-STAT-ROE-OKS
               PERFORM CLR-ROE-ROE
               GO TO FIN-PUT-ROE-ROE.
           MOVE ROE-COD-USER IN ROE TO ROE-COD-USER IN ROE-FLD.
       FIN-PUT-ROE-ROE.
           EXIT.
      * 11-May-98 07:08 PM
       RET-ALL-ROE SECTION.
       INI-RET-ALL-ROE.
           PERFORM KEY-ALL-ROE.
           PERFORM RET-ROE-ROE.
       FIN-RET-ALL-ROE.
           EXIT.
      
       RET-ROE-ROE SECTION.
       INI-RET-ROE-ROE.
       FIN-RET-ROE-ROE.
           EXIT.
      
       KEY-ALL-ROE SECTION.
       INI-KEY-ALL-ROE.
           PERFORM KEY-ROE-ROE.
       FIN-KEY-ALL-ROE.
           EXIT.
      
       KEY-ROE-ROE SECTION.
       INI-KEY-ROE-ROE.
           MOVE ROE-COD-USER IN ROE-FLD TO ROE-COD-USER IN ROE.
       FIN-KEY-ROE-ROE.
           EXIT.
      
       SCR-CLRA-ROE SECTION.
       INI-SCR-CLRA-ROE.
           PERFORM CLR-KEY-ROE.
           PERFORM CLR-FLD-ROE.
       FIN-SCR-CLRA-ROE.
           EXIT.
      
       CLR-KEY-ROE SECTION.
       INI-CLR-KEY-ROE.
           MOVE SPACES TO ROE-COD-USER IN ROE-FLD.
           MOVE SPACES TO FRM-CAI-FST IN ROE-FLD.
           MOVE ZEROES TO FRM-IIC-FST IN ROE-FLD.
       FIN-CLR-KEY-ROE.
           EXIT.
      
       CLR-FLD-ROE SECTION.
       INI-CLR-FLD-ROE.
           MOVE SPACES TO FRM-GLS-USER IN ROE-FLD.
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(2).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(3).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(4).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(5).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(6).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(7).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(8).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(9).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(10).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(11).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(12).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(13).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(14).
           MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(15).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(1).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(2).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(3).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(4).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(5).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(6).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(7).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(8).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(9).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(10).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(11).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(12).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(13).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(14).
           MOVE ZEROES TO FRM-IIC-IOPC IN ROE-FLD(15).
           PERFORM CLR-ROE-ROE.
       FIN-CLR-FLD-ROE.
           EXIT.
      
       CLR-ROE-ROE SECTION.
       INI-CLR-ROE-ROE.
       FIN-CLR-ROE-ROE.
           EXIT.
      
       FST-KEY-ROE SECTION.
       INI-FST-KEY-ROE.
           MOVE FRM-POS-CURS TO ROE-COD-USER-LEN IN ROE-FLD.
       FIN-FST-KEY-ROE.
           EXIT.
      
       FST-FLD-ROE SECTION.
       INI-FST-FLD-ROE.
           MOVE FRM-POS-CURS TO FRM-CAI-IOPC-LEN IN ROE-FLD(1).
       FIN-FST-FLD-ROE.
           EXIT.
      
       PRO-KEY-ROE SECTION.
       INI-PRO-KEY-ROE.
           MOVE FRM-CPIM-AEY TO FRM-CAI-FST-ATR IN ROE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-FST-ATR IN ROE-FLD.
           PERFORM PRO-IKY-ROE.
           PERFORM PRO-AKY-ROE.
           PERFORM PRO-MKY-ROE.
       FIN-PRO-KEY-ROE.
           EXIT.
      
       PRO-IKY-ROE SECTION.
       INI-PRO-IKY-ROE.
           MOVE FRM-CPIM-AEY TO ROE-COD-USER-ATR IN ROE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-CAI-FST-ATR IN ROE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-FST-ATR IN ROE-FLD.
       FIN-PRO-IKY-ROE.
           EXIT.
      
       PRO-MKY-ROE SECTION.
       INI-PRO-MKY-ROE.
       FIN-PRO-MKY-ROE.
           EXIT.
      
       PRO-AKY-ROE SECTION.
       INI-PRO-AKY-ROE.
       FIN-PRO-AKY-ROE.
           EXIT.
      
       PRO-FLD-ROE SECTION.
       INI-PRO-FLD-ROE.
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(10).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(11).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(12).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(13).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(14).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ROE-FLD(15).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(10).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(11).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(12).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(13).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(14).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ROE-FLD(15).
           PERFORM PRO-ROE-ROE.
       FIN-PRO-FLD-ROE.
           EXIT.
      
       PRO-ROE-ROE SECTION.
       INI-PRO-ROE-ROE.
       FIN-PRO-ROE-ROE.
           EXIT.
      
       PRO-PROT-ROE SECTION.
       INI-PRO-PROT-ROE.
       FIN-PRO-PROT-ROE.
           EXIT.
      
       UNP-KEY-ROE SECTION.
       INI-UNP-KEY-ROE.
           MOVE FRM-CPIM-UBY TO FRM-CAI-FST-ATR IN ROE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-FST-ATR IN ROE-FLD.
           PERFORM UNP-IKY-ROE.
           PERFORM UNP-AKY-ROE.
           PERFORM UNP-MKY-ROE.
       FIN-UNP-KEY-ROE.
           EXIT.
      
       UNP-IKY-ROE SECTION.
       INI-UNP-IKY-ROE.
           MOVE FRM-CPIM-UBY TO ROE-COD-USER-ATR IN ROE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-CAI-FST-ATR IN ROE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-FST-ATR IN ROE-FLD.
       FIN-UNP-IKY-ROE.
           EXIT.
      
       UNP-MKY-ROE SECTION.
       INI-UNP-MKY-ROE.
       FIN-UNP-MKY-ROE.
           EXIT.
      
       UNP-AKY-ROE SECTION.
       INI-UNP-AKY-ROE.
       FIN-UNP-AKY-ROE.
           EXIT.
      
       UNP-FLD-ROE SECTION.
       INI-UNP-FLD-ROE.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(10).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(11).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(12).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(13).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(14).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ROE-FLD(15).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(10).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(11).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(12).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(13).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(14).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ROE-FLD(15).
           PERFORM UNP-ROE-ROE.
       FIN-UNP-FLD-ROE.
           EXIT.
      
       UNP-ROE-ROE SECTION.
       INI-UNP-ROE-ROE.
       FIN-UNP-ROE-ROE.
           EXIT.
      
       VAL-KEY-ROE SECTION.
       INI-VAL-KEY-ROE.
           PERFORM VAL-IKY-ROE.
           PERFORM VAL-MKY-ROE.
           PERFORM VAL-AKY-ROE.
       FIN-VAL-KEY-ROE.
           EXIT.
      
       VAL-IKY-ROE SECTION.
       INI-VAL-IKY-ROE.
           PERFORM VAL-ROE-COD-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ROE-COD-USER-LEN IN ROE-FLD
                GO TO FIN-VAL-IKY-ROE.
           PERFORM VAL-FRM-CAI-FST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-CAI-FST-LEN IN ROE-FLD
                GO TO FIN-VAL-IKY-ROE.
           PERFORM VAL-FRM-IIC-FST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IIC-FST-LEN IN ROE-FLD
                GO TO FIN-VAL-IKY-ROE.
       FIN-VAL-IKY-ROE.
           EXIT.
      
       VAL-MKY-ROE SECTION.
       INI-VAL-MKY-ROE.
       FIN-VAL-MKY-ROE.
           EXIT.
      
       VAL-AKY-ROE SECTION.
       INI-VAL-AKY-ROE.
       FIN-VAL-AKY-ROE.
           EXIT.
      
       VAL-FLD-ROE SECTION.
       INI-VAL-FLD-ROE.
           PERFORM VAL-FRM-GLS-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-USER-LEN IN ROE-FLD
                GO TO FIN-VAL-FLD-ROE.
           PERFORM VAL-FRM-CAI-IOPC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 15
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                FRM-CAI-IOPC-LEN IN ROE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ROE.
           PERFORM VAL-FRM-IIC-IOPC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 15
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO
                FRM-IIC-IOPC-LEN IN ROE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ROE.
       FIN-VAL-FLD-ROE.
           EXIT.
      
       VAL-ROE-COD-USER SECTION.
       INI-VAL-ROE-COD-USER.
           IF ROE-COD-USER IN ROE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-ROE-COD-USER.
      *<<<< ROE_COD_USER
           MOVE ROE-COD-USER IN ROE-FLD TO
                USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS > SPACES
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-ROE-COD-USER.
      
           IF USR-COD-TTAB IN USR NOT = "UEN" AND
                USR-COD-TTAB IN USR NOT = "UEP"
              MOVE "GNS"        TO MSG-COD-SIST
              MOVE "USREXT NEX" TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-ROE-COD-USER.
      
           IF USR-COD-TTAB IN USR = "UEP"
              MOVE "GNS"        TO MSG-COD-SIST
              MOVE "USRUEP" TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-ROE-COD-USER.
      
           MOVE SPACES TO UGE-KEY-IUGE IN UGE.
           MOVE ROE-COD-USER IN ROE-FLD TO UGE-COD-USER IN UGE.
           MOVE "UGE-COD-USER" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-UGE.
           IF NOT FIO-STAT-OKS OR
                ROE-COD-USER IN ROE-FLD NOT = UGE-COD-USER IN UGE
              MOVE "GNS"        TO MSG-COD-SIST
              MOVE "USRUGE NEX" TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-ROE-COD-USER.
      
           MOVE UGE-CIC-ICLI IN UGE TO GRP-ICLG.
      
           MOVE SPACES TO UGE-KEY-IUGE IN UGE.
           MOVE SCR-USER TO UGE-COD-USER IN UGE.
           MOVE "UGE-COD-USER" TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-UGE.
           IF NOT FIO-STAT-OKS OR
                SCR-USER NOT = UGE-COD-USER IN UGE
              MOVE "GNS"        TO MSG-COD-SIST
              MOVE "DIGUGE NEX" TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-ROE-COD-USER.
      
           IF GRP-ICLG NOT = UGE-CIC-ICLI IN UGE
              MOVE "GNS"        TO MSG-COD-SIST
              MOVE "DIGROE NEQ" TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-ROE-COD-USER.
      
      *>>>> ROE_COD_USER
       FIN-VAL-ROE-COD-USER.
           EXIT.
      
       VAL-FRM-CAI-FST SECTION.
       INI-VAL-FRM-CAI-FST.
           IF FRM-CAI-FST IN ROE-FLD NOT > SPACES
              MOVE SPACES TO FRM-CAI-FST IN ROE-FLD.
       FIN-VAL-FRM-CAI-FST.
           EXIT.
      
       VAL-FRM-IIC-FST SECTION.
       INI-VAL-FRM-IIC-FST.
       FIN-VAL-FRM-IIC-FST.
           EXIT.
      
       VAL-FRM-GLS-USER SECTION.
       INI-VAL-FRM-GLS-USER.
       FIN-VAL-FRM-GLS-USER.
           EXIT.
      
       VAL-FRM-CAI-IOPC SECTION.
       INI-VAL-FRM-CAI-IOPC.
           IF FRM-CAI-IOPC IN ROE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-CAI-IOPC IN ROE-FLD(FRM-IFLD).
       FIN-VAL-FRM-CAI-IOPC.
           EXIT.
      
       VAL-FRM-IIC-IOPC SECTION.
       INI-VAL-FRM-IIC-IOPC.
      *<<<< FRM_IIC_IOPC
           IF (FRM-CAI-IOPC IN ROE-FLD(FRM-IFLD) > SPACES AND
               FRM-IIC-IOPC IN ROE-FLD(FRM-IFLD) > SPACES AND
               FRM-IIC-IOPC IN ROE-FLD(FRM-IFLD) > ZEROES)
      
               MOVE FRM-CAI-IOPC IN ROE-FLD(FRM-IFLD) TO
                    OPC-CAI-IOPC IN OPC
               MOVE FRM-IIC-IOPC IN ROE-FLD(FRM-IFLD) TO
                    OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE "COL"        TO MSG-COD-SIST
                   MOVE "OPC    NEX" TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                  IF OPC-MSC-STAT NOT = "A"
                     MOVE "COL"        TO MSG-COD-SIST
                     MOVE "OPC  ACANO" TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                  ELSE
      *CAH-INI 11-MAY-1998
      *               PERFORM REV-ROE-OPC.
                      PERFORM REV-ROE-OPC
           ELSE
             IF (FRM-CAI-IOPC IN ROE-FLD(FRM-IFLD) > SPACES OR
      *          FRM-IIC-IOPC IN ROE-FLD(FRM-IFLD) > SPACES OR
                 FRM-IIC-IOPC IN ROE-FLD(FRM-IFLD) > ZEROES)
                   MOVE "COL"        TO MSG-COD-SIST
                   MOVE "OPC    NEX" TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *CAH-FIN 11-MAY-1998
      *>>>> FRM_IIC_IOPC
       FIN-VAL-FRM-IIC-IOPC.
           EXIT.
      
       VAL-CON-KEY-ROE SECTION.
       INI-VAL-CON-KEY-ROE.
           IF     ROE-COD-USER IN ROE-FLD NOT > SPACES
              AND FRM-CAI-FST IN ROE-FLD NOT > SPACES
              AND FRM-IIC-FST IN ROE-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-ROE.
       FIN-VAL-CON-KEY-ROE.
           EXIT.
      
       VAL-CON-IKY-ROE SECTION.
       INI-VAL-CON-IKY-ROE.
           IF     ROE-COD-USER IN ROE-FLD NOT > SPACES
              AND FRM-CAI-FST IN ROE-FLD NOT > SPACES
              AND FRM-IIC-FST IN ROE-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-ROE.
       FIN-VAL-CON-IKY-ROE.
           EXIT.
      
       VAL-CON-FLD-ROE SECTION.
       INI-VAL-CON-FLD-ROE.
      *<<<< VAL_CON_FLD_ROE
           PERFORM VAL-I VARYING WSS-I FROM 1 BY 1
             UNTIL WSS-I > WSS-LIMI-1 OR FRM-SUAR = FRM-SUAR-MAL.
      *>>>> VAL_CON_FLD_ROE
       FIN-VAL-CON-FLD-ROE.
           EXIT.
      
       VAL-CON-ROE SECTION.
       INI-VAL-CON-ROE.
       FIN-VAL-CON-ROE.
           EXIT.
      
       VAL-NUM-KEY-ROE SECTION.
       INI-VAL-NUM-KEY-ROE.
           PERFORM VAL-NUM-IKY-ROE.
           PERFORM VAL-NUM-MKY-ROE.
           PERFORM VAL-NUM-AKY-ROE.
       FIN-VAL-NUM-KEY-ROE.
           EXIT.
      
       VAL-NUM-IKY-ROE SECTION.
       INI-VAL-NUM-IKY-ROE.
       VAL-NUM-FRM-IIC-FST.
           MOVE FRM-IIC-FST-ALF IN ROE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-FST IN ROE-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-FST-LEN IN ROE-FLD
                GO TO FIN-VAL-NUM-IKY-ROE.
       FIN-VAL-NUM-IKY-ROE.
           EXIT.
      
       VAL-NUM-MKY-ROE SECTION.
       INI-VAL-NUM-MKY-ROE.
       FIN-VAL-NUM-MKY-ROE.
           EXIT.
      
       VAL-NUM-AKY-ROE SECTION.
       INI-VAL-NUM-AKY-ROE.
       FIN-VAL-NUM-AKY-ROE.
           EXIT.
      
       VAL-NUM-FLD-ROE SECTION.
       INI-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-1.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(1)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-2.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(2)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-3.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(3)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-4.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(4)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-5.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(5)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-6.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(6)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-7.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(7)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(7)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-8.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(8) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(8)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(8)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-9.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(9) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(9)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(9)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-10.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(10) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(10)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(10)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-11.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(11) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(11)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(11)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-12.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(12) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(12)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(12)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-13.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(13) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(13)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(13)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-14.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(14) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(14)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(14)
                GO TO FIN-VAL-NUM-FLD-ROE.
       VAL-NUM-FRM-IIC-IOPC-15.
           MOVE FRM-IIC-IOPC-ALF IN ROE-FLD(15) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ROE-FLD(15)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ROE-FLD(15)
                GO TO FIN-VAL-NUM-FLD-ROE.
       FIN-VAL-NUM-FLD-ROE.
           EXIT.
      
       EDT-KEY-ROE SECTION.
       INI-EDT-KEY-ROE.
           PERFORM EDT-IKY-ROE.
           PERFORM EDT-MKY-ROE.
           PERFORM EDT-AKY-ROE.
       FIN-EDT-KEY-ROE.
           EXIT.
      
       EDT-IKY-ROE SECTION.
       INI-EDT-IKY-ROE.
           IF FRM-IIC-FST-LEN IN ROE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-FST-LEN IN ROE-FLD
                GO TO FIN-EDT-IKY-ROE.
           MOVE FRM-IIC-FST IN ROE-FLD TO FRM-IIC-FST-EDT IN ROE-EDT.
           MOVE FRM-IIC-FST-EDT IN ROE-EDT TO
                FRM-IIC-FST-ALF IN ROE-FLD.
       FIN-EDT-IKY-ROE.
           EXIT.
      
       EDT-MKY-ROE SECTION.
       INI-EDT-MKY-ROE.
       FIN-EDT-MKY-ROE.
           EXIT.
      
       EDT-AKY-ROE SECTION.
       INI-EDT-AKY-ROE.
       FIN-EDT-AKY-ROE.
           EXIT.
      
       EDT-FLD-ROE SECTION.
       INI-EDT-FLD-ROE.
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(1)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(1) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(1).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(2)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(2) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(2).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(3)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(3) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(3).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(4)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(4) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(4).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(5)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(5) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(5).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(6)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(6) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(6).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(7)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(7) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(7).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(8) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(8)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(8) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(8).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(9) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(9)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(9) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(9).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(10) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(10)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(10) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(10).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(11) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(11)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(11) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(11).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(12) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(12)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(12) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(12).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(13) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(13)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(13) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(13).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(14) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(14)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(14) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(14).
           IF FRM-IIC-IOPC-LEN IN ROE-FLD(15) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-IOPC-LEN IN ROE-FLD(15)
                GO TO FIN-EDT-FLD-ROE.
           MOVE FRM-IIC-IOPC IN ROE-FLD(15) TO
                FRM-IIC-IOPC-EDT IN ROE-EDT.
           MOVE FRM-IIC-IOPC-EDT IN ROE-EDT TO
                FRM-IIC-IOPC-ALF IN ROE-FLD(15).
       FIN-EDT-FLD-ROE.
           EXIT.
      
       RST-ATR-ROE SECTION.
       INI-RST-ATR-ROE.
      *     MOVE SPACES TO ROE-COD-USER-ATR IN ROE-FLD.
           MOVE SPACES TO ROE-COD-USER-LEN IN ROE-FLD.
      *     MOVE SPACES TO FRM-CAI-FST-ATR IN ROE-FLD.
           MOVE SPACES TO FRM-CAI-FST-LEN IN ROE-FLD.
      *     MOVE SPACES TO FRM-IIC-FST-ATR IN ROE-FLD.
           MOVE SPACES TO FRM-IIC-FST-LEN IN ROE-FLD.
      *     MOVE SPACES TO FRM-GLS-USER-ATR IN ROE-FLD.
           MOVE SPACES TO FRM-GLS-USER-LEN IN ROE-FLD.
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(1).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(2).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(2).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(3).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(3).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(4).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(4).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(5).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(5).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(6).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(6).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(7).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(7).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(8).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(8).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(9).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(9).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(10).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(10).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(11).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(11).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(12).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(12).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(13).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(13).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(14).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(14).
      *     MOVE SPACES TO FRM-CAI-IOPC-ATR IN ROE-FLD(15).
           MOVE SPACES TO FRM-CAI-IOPC-LEN IN ROE-FLD(15).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(1).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(1).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(2).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(2).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(3).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(3).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(4).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(4).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(5).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(5).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(6).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(6).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(7).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(7).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(8).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(8).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(9).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(9).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(10).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(10).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(11).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(11).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(12).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(12).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(13).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(13).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(14).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(14).
      *     MOVE SPACES TO FRM-IIC-IOPC-ATR IN ROE-FLD(15).
           MOVE SPACES TO FRM-IIC-IOPC-LEN IN ROE-FLD(15).
       FIN-RST-ATR-ROE.
           EXIT.
      *<<<< EOF
       VAL-I SECTION.
       INI-VAL-I.
           PERFORM VAL-J VARYING WSS-J FROM WSS-I BY 1
             UNTIL WSS-J > WSS-LIMI OR FRM-SUAR = FRM-SUAR-MAL.
       FIN-VAL-I.
           EXIT.
      
       VAL-J SECTION.
       INI-VAL-J.
           IF ( WSS-I NOT = WSS-J ) AND
              ( FRM-CAI-IOPC IN ROE-FLD(WSS-I) > SPACES AND
                FRM-IIC-IOPC IN ROE-FLD(WSS-I) > SPACES AND
                FRM-IIC-IOPC IN ROE-FLD(WSS-I) > ZEROES     AND
                FRM-CAI-IOPC IN ROE-FLD(WSS-J) > SPACES AND
                FRM-IIC-IOPC IN ROE-FLD(WSS-J) > SPACES AND
                FRM-IIC-IOPC IN ROE-FLD(WSS-J) > ZEROES)    AND
              ( FRM-CAI-IOPC IN ROE-FLD(WSS-I) =
                FRM-CAI-IOPC IN ROE-FLD(WSS-J)   AND
                FRM-IIC-IOPC IN ROE-FLD(WSS-I) =
                FRM-IIC-IOPC IN ROE-FLD(WSS-J)          )
                MOVE FRM-POS-CURS TO FRM-IIC-IOPC-LEN IN ROE-FLD(WSS-I)
                MOVE "S" TO FRM-UCUR
                MOVE "GNS" TO MSG-COD-SIST
                MOVE "ROEIOPC=" TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-J.
           EXIT.
       SET-MSG SECTION.
       INI-SET-MSG.
           MOVE MSG-GLS-DESC        TO WSS-MSG-GLS-DESC.
           MOVE ROE-COD-USER IN ROE TO WSS-MSG-GLS-DATA.
           MOVE WSS-MSG             TO FRM-MENS.
       FIN-SET-MSG.
           EXIT.
      
       REV-ROE-OPC SECTION.
       INI-REV-ROE-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE "RDC-KEY-IDLC" TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LUP-REV-ROE-OPC.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
               MOVE "GNS"        TO MSG-COD-SIST
               MOVE "OPCUGE NEX" TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-REV-ROE-OPC.
           MOVE RDC-CIC-ICLI IN RDC TO GRP-ICLI.
           PERFORM BUS-GRP.
           MOVE GRP-ICLG TO UGE-CIC-ICLI IN UGE.
           MOVE ROE-COD-USER IN ROE-FLD TO UGE-COD-USER IN UGE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-UGE.
           IF FIO-STAT-OKS AND GRP-ICLG = UGE-CIC-ICLI IN UGE
      *CAH-INI 20-DIC-1997
              MOVE ROE-COD-USER IN ROE-FLD TO ROE-COD-USER IN ROE
              MOVE OPC-CAI-IOPC IN OPC     TO ROE-CAI-IOPC IN ROE
              MOVE OPC-IIC-IOPC IN OPC     TO ROE-IIC-IOPC IN ROE
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-ROE
              IF FIO-STAT-OKS
      *CAH-INI 14-ENE-1998
                IF SCR-CCPP = "ING"
      *CAH-FIN 14-ENE-1998
                 MOVE "GNS"        TO MSG-COD-SIST
                 MOVE "ROEIOPC=" TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-REV-ROE-OPC
      *CAH-INI 14-ENE-1998
                ELSE
                 GO TO FIN-REV-ROE-OPC
      *CAH-FIN 14-ENE-1998
              ELSE
      *CAH-FIN 20-DIC-1997
                GO TO FIN-REV-ROE-OPC.
      
           MOVE "RDC-KEY-IDLC" TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-REV-ROE-OPC.
       FIN-REV-ROE-OPC.
           EXIT.
      
      
       BUS-GRP SECTION.
       INI-BUS-GRP.
           MOVE GRP-ICLI IN GRP-VARI TO REC-CIC-ICLI IN REC.
           MOVE "PG"                 TO REC-COD-TREC IN REC.
           MOVE "999999999999"       TO REC-CIC-IREL IN REC.
           MOVE 99                   TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-GRP.
           PERFORM SGC-FIO-REC.
           IF NOT ( FIO-STAT-OKS AND
                    REC-CIC-ICLI IN REC = GRP-ICLI IN GRP-VARI AND
                    REC-COD-TREC IN REC = "PG" )
               MOVE SPACES TO GRP-ICLG IN GRP-VARI
               MOVE SPACES TO GRP-NOMG IN GRP-VARI
      *FLB CST 9-MAR 1994 ARREGLA INVREQ
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM SGC-FIO-REC
                   GO TO FIN-BUS-GRP
               ELSE
      *FLB CST 9-MAR 1994 FIN ARREGLA INVREQ
                   GO TO FIN-BUS-GRP.
           IF REC-IND-VIGE IN REC = "N"
               MOVE FIO-GET-PRV TO FIO-CMND
               GO TO LUP-BUS-GRP.
      
           MOVE REC-CIC-IREL IN REC TO GRP-ICLG.
       FIN-BUS-GRP.
           EXIT.
      *>>>> EOF
