      $SET LIST
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPRBTM.
       AUTHOR.          BEE.
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
                DECIMAL-POINT IS COMMA.
      
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       DATA DIVISION.
      *=============
       FILE SECTION.
       DATA-BASE SECTION.
       DB BDCST.
       01  AUDITAREA.
       01  GNSTAB.
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWCFIO OF GNS.
       COPY GNSWVFIO OF GNS.
       COPY GNSWSFIO OF GNS.
       COPY GNSBRTAB OF GNS.
       COPY GNSWRTAB OF GNS.
       01 WSS-GLS-PARM.
          03  WSS-FIO-SIST                    PIC X(03).
          03  WSS-TAB-COD-TTAB                PIC X(03).
          03  WSS-TAB-COD-CTAB                PIC X(12).
          03  WSS-FIO-AKEY                    PIC X(32).
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
      *------------
       INI-MAIN.
           MOVE "N" TO FIO-BTRN.
           DISPLAY "INICIO PROGRAMA GNSPRBTM  ".
           MOVE FIO-INP TO FIO-CMND.
           MOVE "GNS" TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
                DISPLAY "ERROR APERTURA ARCHIVO TAB"
                STOP RUN.
      
       LUP-MAIN.
      
           DISPLAY "INGRESE SIST-TTAB-CTAB-AKEY O FIN".
           ACCEPT WSS-GLS-PARM.
           IF WSS-FIO-SIST = "FIN"
               DISPLAY "FIN DE PROGRAMA"
               MOVE "GNS" TO FIO-SIST
               MOVE FIO-CLO TO FIO-CMND
               PERFORM GNS-FIO-TAB
               STOP RUN.
           IF WSS-FIO-AKEY NOT > SPACES
               MOVE SPACES TO WSS-FIO-AKEY.
           MOVE WSS-FIO-SIST TO FIO-SIST.
           MOVE WSS-TAB-COD-TTAB TO TAB-COD-TTAB
                                    TAB-CIC-TTAB
                                    TAB-EXT-TTAB.
           MOVE WSS-TAB-COD-CTAB TO TAB-COD-CTAB
                                    TAB-CIC-CTAB
                                    TAB-EXT-CTAB.
           MOVE WSS-FIO-AKEY TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           DISPLAY "STATUS " FIO-STAT.
           IF FIO-STAT-OKS
               DISPLAY TAB-COD-CTAB  ":" TAB-GLS-DESC IN TAB.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.
      
      
       COPY GNSBGDMD OF GNS.
       COPY GNSBFBTM OF GNS.
