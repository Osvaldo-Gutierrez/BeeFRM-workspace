      $SET LIST LINEINFO SUMMARY ERRORLIST
       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GNSPPICE.
       AUTHOR. BEE.
       DATE-WRITTEN.        22-SEP-1997 16:47:42 .
      *
      * INGRESO CREDITOS EXTERNOS
      *
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
      
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *PGJ-INI/ 17-JUN-1998
       COPY GNSW1TSX OF GNS.
      *PGJ-FIN/ 18-JUN-1998
           SELECT GNSICE01 ASSIGN TO DISK
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  RECORD KEY IS ICE-NUM-CORR.
           SELECT GNSICE02 ASSIGN TO DISK
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  RECORD KEY IS ERR-NUM-CORR.
           SELECT GNSICE03 ASSIGN TO DISK
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  RECORD KEY IS ENT-NUM-CORR.
      
       DATA DIVISION.
      *==============
      *
       FILE SECTION.
      *PGJ-INI/ 17-JUN-1998
       COPY GNSW2TSX OF GNS.
      *PGJ-FIN/ 18-JUN-1998
       FD  GNSICE01
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7.
       01  REG-GNSICE01.
           03  ICE-NUM-CORR                           PIC X(09).
           03  ICE-GLS-DATA.
               05  ICE-IND-PROC                       PIC X(01).
               05  ICE-COD-ENTI                       PIC X(03).
               05  ICE-FRM-DATA                       PIC X(494).
               05  ICE-REL-ENTI                       PIC X(06).
      
       FD  GNSICE02
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7.
       01  REG-GNSICE02.
           03  ERR-NUM-CORR                           PIC X(09).
           03  ERR-COD-ENTI                           PIC X(03).
           03  ERR-CIC-ENTI.
               05 ERR-CAI-ENTI                        PIC X(04).
               05 ERR-IIC-ENTI                        PIC X(08).
           03  ERR-REL-ENTI                           PIC X(06).
           03  ERR-NOM-CAMPO                          PIC X(50).
           03  ERR-FLS-MENS                           PIC X(100).
      
       FD  GNSICE03
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7.
       01  REG-GNSICE03.
           03  ENT-NUM-CORR                           PIC X(09).
           03  ENT-COD-ENTI                           PIC X(03).
           03  ENT-NUM-ENTI.
               05 ENT-CAI-ENTI                        PIC X(04).
               05 ENT-IIC-ENTI                        PIC X(08).
           03  ENT-NUM-ANEX                           PIC X(03).
           03  ENT-NUM-ICLI                           PIC X(11).
           03  ENT-VRF-ICLI                           PIC X(01).
           03  ENT-IND-ICLI                           PIC X(01).
           03  ENT-GLS-ICLI                           PIC X(03).
      
       DATA-BASE SECTION.
       DB  BDCST.
       01  AUDITAREA.
       01  GNSRPF.
       01  GNSMNU.
       01  GNSTAB.
       01  GNSTSF.
      
      *
       WORKING-STORAGE SECTION.
      *------------------------
      *
       01 WSS-IDENT-CLI.
          05  WSS-NUM-ICLI                  PIC X(11).
          05  WSS-VRF-ICLI                  PIC X(01).
          05  WSS-IND-ICLI                  PIC X(01).
          05  WSS-GLS-ICLI                  PIC X(03).
      
       77  WSS-IND-REL        VALUE SPACES    PIC X(06).
       77  WSS-ENT-PPAL       VALUE SPACES    PIC X(03).
       77  WSS-IND-CMND       VALUE SPACES    PIC X(03).
       77  WSS-AUX-CORR       VALUE ZEROES    PIC X(09).
       77  WSS-OPC-CORR       VALUE ZEROES    PIC X(09).
       77  WSS-GDG-CORR       VALUE ZEROES    PIC X(09).
       77  WSS-ERR-OPC        VALUE "N"       PIC X(01).
       77  WSS-ERR-LIQ        VALUE "N"       PIC X(01).
       77  WSS-ERR-GDG        VALUE "N"       PIC X(01).
       77  WSS-ERR-AGA        VALUE "N"       PIC X(01).
      
       01  WSS-COD-MSG.
           03 WSS-COD-MSG1    VALUE "&&"      PIC X(02).
           03 WSS-COD-MSG2    VALUE SPACES    PIC X(03).
           03 WSS-COD-MSG3    VALUE SPACES    PIC X(03).
           03 WSS-COD-MSG4    VALUE ZEROES    PIC 9(04).
       01  ICM-VARI.
           03 ICM-SIST        VALUE SPACES    PIC X(03).
           03 ICM-FORM        VALUE SPACES    PIC X(03).
       01  WSS-CIC-IOPC.
           03 WSS-CAI-IOPC               PIC X(04).
           03 WSS-IIC-IOPC               PIC X(08).
       01  WSS-NUM-GAR.
           03  WSS-NUM-SIS               PIC X(04).
           03  WSS-COD-CRR               PIC X(08).
      
       01  WSS-ENTRADA.
           03  WSS-FILLER                   PIC X(60).
           03  WSS-COMANDO                  PIC X(255).
      
       01  WSS-SALIDA.
           03  WSS-FILLER                   PIC X(60).
           03  WSS-RESP                     PIC X(255).
      
       01  WSS-TOT-REG    VALUE ZEROES      PIC 9(05).
       01  WSS-KEY-PANT.
           03 WSS-COD-PANT   VALUE SPACES PIC X(07).
           03 WSS-NUM-CAMP   VALUE ZEROES PIC 9(03).
           03 FILLER         VALUE SPACES PIC X(02).
      
       77  WSS-FIN                          PIC S9(11) BINARY.
           88 FIN    VALUE 1.
      
       01  WSS-TBL-ERR.
           03 WSS-TBL-ERR-TBL OCCURS 100 TIMES.
              05 WSS-TBL-ERR-ELM   PIC X(01).
       77  WSS-IDX-ERR    VALUE ZEROES     PIC 9(05).
      
       01  WSS-ENTI.
           03  WSS-IND-CORR                 PIC X(09).
           03  WSS-IND-PROC                 PIC X(01).
           03  WSS-COD-OPCI                 PIC X(03).
           03  WSS-REG-ENTI                 PIC X(494).
           03  WSS-REL-ENTI                 PIC X(06).
      
       01 ENV-VARI.
           03 ENV-FIL                       PIC X(04) VALUE SPACES.
           03 ENV-SCR-VARI                  PIC X(700).
           03 ENV-FRM-VARI                  PIC X(1400).
      
       77  WSS-DSP-TRC                      PIC X(01).
       77  WSS-PUT-MSK                      PIC X(01).
      
       77  WSS-CORR  VALUE ZEROES           PIC 9(09).
      
       COPY GNSWGDEL OF GNS.
       COPY GNSWGICE OF GNS.
       COPY GNSWCSCR OF GNS.
       COPY GNSWVSCR OF GNS.
           03 SCR-DISP-ICE        PIC X(119).
      * LENGTH SCR-VARI 581 + 119 = 700
       COPY GNSWGFEC OF GNS.
       COPY GNSWGHOY OF GNS.
       COPY GNSWGQUE OF GNS.
      
       COPY COLWIOPC OF COL.
       COPY COLWIDLC OF COL.
       COPY COLWIEVC OF COL.
       COPY COLWIRDC OF COL.
       COPY COLWIRMC OF COL.
       COPY SGCWIDBP OF SGC.
       COPY SGCWIDBE OF SGC.
       COPY SGCWIOPE OF SGC.
       COPY SGCWIDIR OF SGC.
       COPY GARWIGDG OF GAR.
       COPY GARWIGDD OF GAR.
       COPY GARWIGVT OF GAR.
       COPY GARWIGSE OF GAR.
      
      
       COPY GNSWGSYS OF GNS.
       COPY GNSWGFRM OF GNS.
       COPY GNSBRTAB OF GNS.
       COPY GNSWRTAB OF GNS.
       COPY GNSBRMSG OF GNS.
       COPY GNSWRMSG OF GNS.
       COPY GNSWVFIO OF GNS.
       COPY GNSWCFIO OF GNS.
       COPY GNSWSFIO OF GNS.
      
       COPY GNSWGACI OF GNS.
       COPY GNSBGCSC OF GNS.
      
      
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
           DISPLAY "[[*****COMIENZA  GNSPPICE*****]]".
           PERFORM PRO-ABRE-ARCH.
           MOVE ZEROES TO ICE-NUM-CORR.
           START GNSICE01 KEY IS NOT < ICE-NUM-CORR
                 INVALID KEY DISPLAY "ERROR EN START GNSICE01"
                             GO TO FIN-MAIN.
           READ GNSICE01 NEXT RECORD
                 AT END      DISPLAY "ERROR EN NEXT  GNSICE01"
                             GO TO FIN-MAIN.
           MOVE REG-GNSICE01 TO WSS-ENTI.
       LOOP-OPER.
      *    ADD 1 TO WSS-TOT-REG.
      *    DISPLAY "===============================".
           DISPLAY "GNSPPICE LEYO REG NRO:" WSS-IND-CORR.
           DISPLAY "PARA ENTIDAD         :" WSS-COD-OPCI.
      *    DISPLAY "===============================".
           IF WSS-COD-OPCI = "OPC"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-COL-OPC
           ELSE
           IF WSS-COD-OPCI = "DLC" AND WSS-CIC-IOPC > SPACES
                PERFORM PRO-COL-DLC
           ELSE
           IF WSS-COD-OPCI = "EVC" AND WSS-CIC-IOPC > SPACES
                PERFORM PRO-COL-EVC
           ELSE
           IF WSS-COD-OPCI = "RDC" AND WSS-CIC-IOPC > SPACES
                PERFORM PRO-COL-RDC
           ELSE
           IF WSS-COD-OPCI = "RMC" AND WSS-CIC-IOPC > SPACES
                PERFORM PRO-COL-RMC
           ELSE
           IF WSS-COD-OPCI = "DBP" AND WSS-IND-PROC NOT = "S"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-SGC-DBP
           ELSE
           IF WSS-COD-OPCI = "DBE" AND WSS-IND-PROC NOT = "S"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-SGC-DBE
           ELSE
           IF WSS-COD-OPCI = "OPE" AND WSS-IND-PROC NOT = "S"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-SGC-OPE
           ELSE
           IF WSS-COD-OPCI = "DIR" AND WSS-IND-PROC NOT = "S"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-SGC-DIR
           ELSE
           IF WSS-COD-OPCI = "GDG"
                PERFORM CHK-LIQ-OPC
                PERFORM CHK-AGA-GDG
                PERFORM PRO-GAR-GDG
           ELSE
           IF WSS-COD-OPCI = "GDD" AND WSS-NUM-GAR > SPACES
                PERFORM PRO-GAR-GDD
           ELSE
           IF WSS-COD-OPCI = "GVT" AND WSS-NUM-GAR > SPACES
                PERFORM PRO-GAR-GVT
           ELSE
           IF WSS-COD-OPCI = "GSE" AND WSS-NUM-GAR > SPACES
                PERFORM PRO-GAR-GSE.
       LEE-REG.
           READ GNSICE01 NEXT RECORD
                AT END   DISPLAY "[[GNSPPICE:GNSICE01 EOF]]"
                         PERFORM CHK-LIQ-OPC
                         PERFORM CHK-AGA-GDG
                         PERFORM PRO-CIERRA-ARCH
                         DISPLAY "[[[GNSPPICE HA FINALIZADO]]]"
                         PERFORM PRO-DISABLE
                         PERFORM PRO-RECIBE
                         DISPLAY "[GNSPPICE HARA STOPRUN]"
                         STOP RUN
                         DISPLAY "[GNSPPICE HIZO STOPRUN]".
           MOVE REG-GNSICE01 TO WSS-ENTI.
           GO TO LOOP-OPER.
       FIN-MAIN.
           PERFORM CHK-LIQ-OPC.
           PERFORM PRO-CIERRA-ARCH.
           EXIT PROGRAM.
      
       PRO-ABRE-ARCH SECTION.
       INI-PRO-ABRE-ARCH.
           MOVE "GNS" TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           OPEN I-O    GNSICE01.
           OPEN OUTPUT GNSICE02.
           OPEN OUTPUT GNSICE03.
           CLOSE GNSICE03.
           OPEN I-O GNSICE03.
       FIN-PRO-ABRE-ARCH.
           EXIT.
      
       PRO-CIERRA-ARCH SECTION.
       INI-PRO-CIERRA-ARCH.
            CLOSE GNSICE01  WITH LOCK.
            CLOSE GNSICE02  WITH LOCK.
            CLOSE GNSICE03  WITH LOCK.
       FIN-PRO-CIERRA-ARCH.
           EXIT.
      
       PRO-DISABLE SECTION.
       INI-PRO-DISABLE.
           MOVE "DISABLE PROGRAM GNSPPICE" TO WSS-COMANDO.
           CALL "COMANDO_COMS OF GNS/EXE/GNSPPCMN"
                 USING WSS-ENTRADA, WSS-SALIDA.
      *    DISPLAY "[> " WSS-SALIDA "<]".
       FIN-PRO-DISABLE.
           EXIT.
      
       PRO-ENVIA SECTION.
       INI-PRO-ENVIA.
           CALL "GET-DESIGNATOR-USING-NAME OF DCILIBRARY"
                 USING SYS-PROG-ALF
                 VALUE PROGRAM
                 SYS-PROG-R
                 GIVING SYS-RESU
           IF SYS-RESU NOT = 0
                DISPLAY "*** [NO EXISTE PROGRAMA] ***"
           ELSE
                MOVE SYS-PROG-R TO DESTINATIONDESG OF COMS-OUT
                MOVE 1 TO DESTCOUNT
                MOVE 2000  TO TEXTLENGTH OF COMS-OUT
                MOVE SCR-VARI TO ENV-SCR-VARI
                SEND COMS-OUT FROM ENV-VARI.
      *    DISPLAY "[GNSPPICE HIZO SEND:ENVIA]".
       FIN-PRO-ENVIA.
            EXIT.
      
       PRO-RECIBE SECTION.
       INI-PRO-RECIBE.
      *    DISPLAY "[INI-RECIBE EN GNSPPICE]".
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-DFLD TO COMS-MESSAGE-AREA.
           MOVE CM-CMMA-GROUP TO SCR-VARI.
      *    DISPLAY "[GNSPPICE DE VUELTA PROGRAMA]".
      *    DISPLAY "[GNSPPICE SCR:INST,CMND,CCPP,IERR]"
      *      SCR-INST "/" SCR-CMND "/" SCR-CCPP "/" SCR-IERR "/".
      *    DISPLAY "[FIN-RECIBE EN GNSPPICE]".
       FIN-PRO-RECIBE.
           EXIT.
      
       PRO-GNS-DEL SECTION.
       INI-PRO-GNS-DEL.
           PERFORM PRO-GNS-DEL-SCR.
           MOVE  SPACES TO ENV-FRM-VARI.
           MOVE SPACES  TO CMMA-ICE-DEL.
           MOVE "GNSPPDEL" TO SYS-PROG-ALF.
           IF WSS-ENT-PPAL = "OPC"
      *       DISPLAY "[[ENVIARA A GNSPPDEL OPC:]]" WSS-CIC-IOPC
              MOVE WSS-CIC-IOPC   TO CMM-COL-CIC-IOPC
           ELSE
           IF WSS-ENT-PPAL = "GDG"
      *       DISPLAY "[[ENVIARA A GNSPPDEL GDG:]]" WSS-NUM-GAR
              MOVE WSS-NUM-GAR   TO CMM-GAR-NUM-GDG
           ELSE
              DISPLAY "[[ERROR CARGAR NUM ENTIDAD ELI-GNSPPDEL]]".
           MOVE CMMA-ICE-DEL   TO ENV-FRM-VARI.
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
       FIN-PRO-GNS-DEL.
           EXIT.
      
       PRO-GNS-DEL-SCR SECTION.
       INI-PRO-GNS-DEL-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GX00" TO SCR-NTRN.
           MOVE "GNSPPDEL" TO SCR-PROG.
       FIN-PRO-GNS-DEL-SCR.
           EXIT.
      
      
       CHK-LIQ-OPC SECTION.
       INI-CHK-LIQ-OPC.
      *    DISPLAY "@EN INI CHK-LIQ@".
      *    DISPLAY "@WSS-CIC-IOPC@" WSS-CIC-IOPC.
      *    DISPLAY "@WSS-ERR-OPC@"  WSS-ERR-OPC.
           IF WSS-CIC-IOPC > SPACES AND WSS-ERR-OPC = "N"
      *       DISPLAY "@ LIQUIDANDO OPC @"
              PERFORM PRO-COL-LIQ
              IF WSS-ERR-LIQ = "N"
                 PERFORM PRO-COL-ACA.
           MOVE SPACES TO WSS-CIC-IOPC.
      *    MOVE SPACES TO WSS-ENT-PPAL.
       FIN-CHK-LIQ-OPC.
           EXIT.
      
       PRO-COL-LIQ SECTION.
       INI-PRO-COL-LIQ.
           MOVE "LIQ" TO WSS-IND-CMND.
           MOVE "N"   TO WSS-ERR-LIQ.
           MOVE "COL" TO ICM-SIST.
           MOVE "OPC" TO ICM-FORM.
           PERFORM PRO-COL-LIQ-KEY-SCR.
           PERFORM PRO-COL-LIQ-KEY.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES LIQ OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-LIQ
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-COL-LIQ.
           PERFORM PRO-COL-LIQ-FLD-SCR.
           PERFORM MOV-WI-F-LIQ-ACA.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS LIQ OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-LIQ
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-COL-LIQ.
           DISPLAY "[MENSAJE LIQ OPC:]".
           DISPLAY SCR-TRL-GLS-MENS.
       FIN-PRO-COL-LIQ.
           EXIT.
      
       PRO-COL-LIQ-KEY-SCR SECTION.
       INI-PRO-COL-LIQ-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTOPC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA40" TO SCR-NTRN.
           MOVE "COLPAOPC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "LIQ" TO SCR-CMND.
           MOVE "ACC" TO SCR-CCPP.
           MOVE "A"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-LIQ-KEY-SCR.
           EXIT.
      
       PRO-COL-LIQ-KEY SECTION.
       INI-PRO-COL-LIQ-KEY.
           MOVE WSS-CAI-IOPC TO SDF-OPC-CAI-IOPC IN COLFOPC.
           MOVE WSS-IIC-IOPC TO SDF-OPC-IIC-IOPC IN COLFOPC.
       FIN-PRO-COL-LIQ-KEY.
           EXIT.
      
       PRO-COL-LIQ-FLD-SCR SECTION.
       INI-PRO-COL-LIQ-FLD-SCR.
           MOVE "GCS" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-LIQ-FLD-SCR.
           EXIT.
      
       MOV-WI-F-LIQ-ACA SECTION.
       INI-MOV-F-WI-LIQ-ACA.
           IF OPC-COD-VCOC IN OPC-FLD > SPACES
              MOVE OPC-COD-VCOC IN OPC-FLD
                   TO SDF-OPC-COD-VCOC IN COLFOPC.
           IF OPC-COD-TOOC IN OPC-FLD > SPACES
              MOVE OPC-COD-TOOC IN OPC-FLD
                   TO SDF-OPC-COD-TOOC IN COLFOPC.
           IF OPC-COD-AOOC IN OPC-FLD > SPACES
              MOVE OPC-COD-AOOC IN OPC-FLD
                   TO SDF-OPC-COD-AOOC IN COLFOPC.
           IF OPC-CAI-IOPC IN OPC-FLD > SPACES
              MOVE OPC-CAI-IOPC IN OPC-FLD
                   TO SDF-OPC-CAI-IOPC IN COLFOPC.
           IF OPC-IIC-IOPC-ALF IN OPC-FLD > SPACES
              MOVE OPC-IIC-IOPC-ALF IN OPC-FLD
                   TO SDF-OPC-IIC-IOPC IN COLFOPC.
           IF CAN-CAI-IOPC IN OPC-FLD > SPACES
              MOVE CAN-CAI-IOPC IN OPC-FLD
                   TO SDF-CAN-CAI-IOPC IN COLFOPC.
           IF CAN-IIC-IOPC-ALF IN OPC-FLD > SPACES
              MOVE CAN-IIC-IOPC-ALF IN OPC-FLD
                   TO SDF-CAN-IIC-IOPC IN COLFOPC.
           IF CAN-NUM-ICAN-ALF IN OPC-FLD > SPACES
              MOVE CAN-NUM-ICAN-ALF IN OPC-FLD
                   TO SDF-CAN-NUM-ICAN IN COLFOPC.
           IF DBC-NUM-ICLI-ALF IN OPC-FLD > SPACES
              MOVE DBC-NUM-ICLI-ALF IN OPC-FLD
                   TO SDF-DBC-NUM-ICLI IN COLFOPC.
           IF DBC-VRF-ICLI IN OPC-FLD > SPACES
              MOVE DBC-VRF-ICLI IN OPC-FLD
                   TO SDF-DBC-VRF-ICLI IN COLFOPC.
           IF DBC-IND-ICLI IN OPC-FLD > SPACES
              MOVE DBC-IND-ICLI IN OPC-FLD
                   TO SDF-DBC-IND-ICLI IN COLFOPC.
           IF DBC-GLS-ICLI IN OPC-FLD > SPACES
              MOVE DBC-GLS-ICLI IN OPC-FLD
                   TO SDF-DBC-GLS-ICLI IN COLFOPC.
           IF RDC-NUM-DIRE-ALF IN OPC-FLD > SPACES
              MOVE RDC-NUM-DIRE-ALF IN OPC-FLD
                   TO SDF-RDC-NUM-DIRE IN COLFOPC.
           IF OPC-COD-RMOC IN OPC-FLD > SPACES
              MOVE OPC-COD-RMOC IN OPC-FLD
                   TO SDF-OPC-COD-RMOC IN COLFOPC.
           IF OPC-COD-OFOC IN OPC-FLD > SPACES
              MOVE OPC-COD-OFOC IN OPC-FLD
                   TO SDF-OPC-COD-OFOC IN COLFOPC.
           IF OPC-VAL-CRED-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-CRED-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-CRED IN COLFOPC.
           IF ROV-SGV-RENO-ALF IN OPC-FLD > SPACES
              MOVE ROV-SGV-RENO-ALF IN OPC-FLD
                   TO SDF-ROV-SGV-RENO IN COLFOPC.
           IF OPC-VAL-SCRE-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-SCRE-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-SCRE IN COLFOPC.
           IF OPC-COD-SEGD IN OPC-FLD > SPACES
              MOVE OPC-COD-SEGD IN OPC-FLD
                   TO SDF-OPC-COD-SEGD IN COLFOPC.
           IF OPC-IND-RENO IN OPC-FLD > SPACES
              MOVE OPC-IND-RENO IN OPC-FLD
                   TO SDF-OPC-IND-RENO IN COLFOPC.
           IF OPC-VAL-GAST-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-GAST-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-GAST IN COLFOPC.
           IF OPC-NUM-VCOR-ALF IN OPC-FLD > SPACES
              MOVE OPC-NUM-VCOR-ALF IN OPC-FLD
                   TO SDF-OPC-NUM-VCOR IN COLFOPC.
           IF OPC-VAL-SEGD-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-SEGD-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-SEGD IN COLFOPC.
           IF OPC-COD-SEGC IN OPC-FLD > SPACES
              MOVE OPC-COD-SEGC IN OPC-FLD
                   TO SDF-OPC-COD-SEGC IN COLFOPC.
           IF OPC-FEC-FMAV IN OPC-FLD > SPACES
              MOVE OPC-FEC-FMAV IN OPC-FLD
                   TO SDF-OPC-FEC-FMAV IN COLFOPC.
           IF OPC-FEC-FINP IN OPC-FLD > SPACES
              MOVE OPC-FEC-FINP IN OPC-FLD
                   TO SDF-OPC-FEC-FINP IN COLFOPC.
           IF OPC-FEC-FCOL IN OPC-FLD > SPACES
              MOVE OPC-FEC-FCOL IN OPC-FLD
                   TO SDF-OPC-FEC-FCOL IN COLFOPC.
           IF OPC-FEC-FING IN OPC-FLD > SPACES
              MOVE OPC-FEC-FING IN OPC-FLD
                   TO SDF-OPC-FEC-FING IN COLFOPC.
           IF FRM-SGV-TFLV-ALF IN OPC-FLD > SPACES
              MOVE FRM-SGV-TFLV-ALF IN OPC-FLD
                   TO SDF-FRM-SGV-TFLV IN COLFOPC.
           IF OPC-COD-PLCO IN OPC-FLD > SPACES
              MOVE OPC-COD-PLCO IN OPC-FLD
                   TO SDF-OPC-COD-PLCO IN COLFOPC.
           IF COM-SGV-TINT-ALF IN OPC-FLD > SPACES
              MOVE COM-SGV-TINT-ALF IN OPC-FLD
                   TO SDF-COM-SGV-TINT IN COLFOPC.
           IF OPC-COD-PLIM IN OPC-FLD > SPACES
              MOVE OPC-COD-PLIM IN OPC-FLD
                   TO SDF-OPC-COD-PLIM IN COLFOPC.
           IF OPC-SGV-VCOM-ALF IN OPC-FLD > SPACES
              MOVE OPC-SGV-VCOM-ALF IN OPC-FLD
                   TO SDF-OPC-SGV-VCOM IN COLFOPC.
           IF ITR-SGV-TINT-ALF IN OPC-FLD > SPACES
              MOVE ITR-SGV-TINT-ALF IN OPC-FLD
                   TO SDF-ITR-SGV-TINT IN COLFOPC.
           IF OPC-MSC-TGAR IN OPC-FLD > SPACES
              MOVE OPC-MSC-TGAR IN OPC-FLD
                   TO SDF-OPC-MSC-TGAR IN COLFOPC.
           IF ITR-COD-TINT IN OPC-FLD > SPACES
              MOVE ITR-COD-TINT IN OPC-FLD
                   TO SDF-ITR-COD-TINT IN COLFOPC.
           IF ITR-MSC-PCTI IN OPC-FLD > SPACES
              MOVE ITR-MSC-PCTI IN OPC-FLD
                   TO SDF-ITR-MSC-PCTI IN COLFOPC.
           IF OPC-IND-VSTR IN OPC-FLD > SPACES
              MOVE OPC-IND-VSTR IN OPC-FLD
                   TO SDF-OPC-IND-VSTR IN COLFOPC.
           IF OPC-IND-AFER IN OPC-FLD > SPACES
              MOVE OPC-IND-AFER IN OPC-FLD
                   TO SDF-OPC-IND-AFER IN COLFOPC.
           IF OPC-SGV-LIQU-ALF IN OPC-FLD > SPACES
              MOVE OPC-SGV-LIQU-ALF IN OPC-FLD
                   TO SDF-OPC-SGV-LIQU IN COLFOPC.
           IF FRM-NUM-IEST-ALF IN OPC-FLD > SPACES
              MOVE FRM-NUM-IEST-ALF IN OPC-FLD
                   TO SDF-FRM-NUM-IEST IN COLFOPC.
           IF FRM-VRF-IEST IN OPC-FLD > SPACES
              MOVE FRM-VRF-IEST IN OPC-FLD
                   TO SDF-FRM-VRF-IEST IN COLFOPC.
           IF FRM-IND-IEST IN OPC-FLD > SPACES
              MOVE FRM-IND-IEST IN OPC-FLD
                   TO SDF-FRM-IND-IEST IN COLFOPC.
           IF FRM-GLS-IEST IN OPC-FLD > SPACES
              MOVE FRM-GLS-IEST IN OPC-FLD
                   TO SDF-FRM-GLS-IEST IN COLFOPC.
           IF CYA-IND-TCYA IN OPC-FLD > SPACES
              MOVE CYA-IND-TCYA IN OPC-FLD
                   TO SDF-CYA-IND-TCYA IN COLFOPC.
           IF FRM-GLS-IESX IN OPC-FLD > SPACES
              MOVE FRM-GLS-IESX IN OPC-FLD
                   TO SDF-FRM-GLS-IESX IN COLFOPC.
           IF CYA-CAI-ICYA IN OPC-FLD > SPACES
              MOVE CYA-CAI-ICYA IN OPC-FLD
                   TO SDF-CYA-CAI-ICYA IN COLFOPC.
           IF CYA-IIC-ICYA-ALF IN OPC-FLD > SPACES
              MOVE CYA-IIC-ICYA-ALF IN OPC-FLD
                   TO SDF-CYA-IIC-ICYA IN COLFOPC.
           IF OPC-COD-CDOC IN OPC-FLD > SPACES
              MOVE OPC-COD-CDOC IN OPC-FLD
                   TO SDF-OPC-COD-CDOC IN COLFOPC.
           IF AUT-CAI-ICYA IN OPC-FLD > SPACES
              MOVE AUT-CAI-ICYA IN OPC-FLD
                   TO SDF-AUT-CAI-ICYA IN COLFOPC.
           IF AUT-IIC-ICYA-ALF IN OPC-FLD > SPACES
              MOVE AUT-IIC-ICYA-ALF IN OPC-FLD
                   TO SDF-AUT-IIC-ICYA IN COLFOPC.
       FIN-MOV-F-WI-LIQ-ACA.
           EXIT.
      
       PRO-COL-ACA SECTION.
       INI-PRO-COL-ACA.
           MOVE "ACA" TO WSS-IND-CMND.
           MOVE "COL" TO ICM-SIST.
           MOVE "OPC" TO ICM-FORM.
           MOVE SPACES TO OPC-FLD-EXT.
           PERFORM PRO-COL-ACA-KEY-SCR.
           PERFORM PRO-COL-ACA-KEY.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES ACA OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-COL-ACA.
           PERFORM PRO-COL-ACA-FLD-SCR.
           PERFORM MOV-WI-F-LIQ-ACA.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS ACA OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-COL-ACA.
           DISPLAY "[MENSAJE ACA OPC:]".
           DISPLAY SCR-TRL-GLS-MENS.
       FIN-PRO-COL-ACA.
           EXIT.
      
       PRO-COL-ACA-KEY-SCR SECTION.
       INI-PRO-COL-ACA-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTOPC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA40" TO SCR-NTRN.
           MOVE "COLPAOPC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ACA" TO SCR-CMND.
           MOVE "ACC" TO SCR-CCPP.
           MOVE "A"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-ACA-KEY-SCR.
           EXIT.
      
       PRO-COL-ACA-KEY SECTION.
       INI-PRO-COL-ACA-KEY.
           MOVE WSS-CAI-IOPC TO SDF-OPC-CAI-IOPC IN COLFOPC.
           MOVE WSS-IIC-IOPC TO SDF-OPC-IIC-IOPC IN COLFOPC.
       FIN-PRO-COL-ACA-KEY.
           EXIT.
      
       PRO-COL-ACA-FLD-SCR SECTION.
       INI-PRO-COL-ACA-FLD-SCR.
           MOVE "GCS" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-ACA-FLD-SCR.
           EXIT.
      
       PRO-COL-OPC SECTION.
       INI-PRO-COL-OPC.
           IF WSS-IND-PROC = "S"
              DISPLAY "[OPC YA PROCESADA]"
              GO TO FIN-PRO-COL-OPC.
           MOVE "OPC"        TO WSS-ENT-PPAL.
           MOVE WSS-IND-CORR TO WSS-OPC-CORR.
           MOVE "N" TO WSS-ERR-OPC.
           MOVE SPACES TO WSS-CIC-IOPC.
           MOVE "COL" TO ICM-SIST.
           MOVE "OPC" TO ICM-FORM.
           MOVE SPACES TO OPC-FLD-EXT.
           MOVE WSS-ENTI TO OPC-FLD-EXT.
           PERFORM PRO-COL-OPC-KEY-SCR.
           PERFORM PRO-COL-OPC-KEY.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-OPC.
           PERFORM PRO-COL-OPC-FLD-SCR.
           PERFORM MOV-WI-F-OPC.
           PERFORM PRO-COL-OPC-FLD.
           MOVE  COLFOPC   TO ENV-FRM-VARI.
           MOVE "COLPAOPC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS OPC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-OPC.
           DISPLAY "MENSAJE :" OPC-GLS-MENS IN OPC-FLD.
           DISPLAY "NRO OPERACION INGRESADA:" OPC-CAI-IOPC IN OPC-FLD
                                         ":"  OPC-IIC-IOPC IN OPC-FLD.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO WSS-CAI-IOPC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO WSS-IIC-IOPC.
           PERFORM GRAB-REG-ING.
       FIN-PRO-COL-OPC.
           EXIT.
      
       PRO-COL-OPC-KEY-SCR SECTION.
       INI-PRO-COL-OPC-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTOPC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA40" TO SCR-NTRN.
           MOVE "COLPAOPC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-OPC-KEY-SCR.
           EXIT.
      
       PRO-COL-OPC-FLD-SCR SECTION.
       INI-PRO-COL-OPC-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-OPC-FLD-SCR.
           EXIT.
      
       PRO-COL-OPC-KEY SECTION.
       INI-PRO-COL-OPC-KEY.
           MOVE SPACES TO COLFOPC.
           IF OPC-COD-VCOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-VCOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-VCOC IN COLFOPC.
           IF OPC-COD-TOOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-TOOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-TOOC IN COLFOPC.
           IF OPC-COD-AOOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-AOOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-AOOC IN COLFOPC.
           IF OPC-CAI-IOPC IN OPC-FLD-EXT > SPACES
              MOVE OPC-CAI-IOPC IN OPC-FLD-EXT
                   TO SDF-OPC-CAI-IOPC IN COLFOPC.
           IF OPC-IIC-IOPC IN OPC-FLD-EXT > ZEROES
              MOVE OPC-IIC-IOPC IN OPC-FLD-EXT
                   TO SDF-OPC-IIC-IOPC IN COLFOPC.
           IF CAN-CAI-IOPC IN OPC-FLD-EXT > SPACES
              MOVE CAN-CAI-IOPC IN OPC-FLD-EXT
                   TO SDF-CAN-CAI-IOPC IN COLFOPC.
           IF CAN-IIC-IOPC IN OPC-FLD-EXT > SPACES
              MOVE CAN-IIC-IOPC IN OPC-FLD-EXT
                   TO SDF-CAN-IIC-IOPC IN COLFOPC.
           IF CAN-NUM-ICAN IN OPC-FLD-EXT > SPACES
              MOVE CAN-NUM-ICAN IN OPC-FLD-EXT
                   TO SDF-CAN-NUM-ICAN IN COLFOPC.
       FIN-PRO-COL-OPC-KEY.
           EXIT.
      
       PRO-COL-OPC-FLD SECTION.
       INI-PRO-COL-OPC-FLD.
           IF DBC-NUM-ICLI IN OPC-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN OPC-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN COLFOPC.
           IF DBC-VRF-ICLI IN OPC-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN OPC-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN COLFOPC.
           IF DBC-IND-ICLI IN OPC-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN OPC-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN COLFOPC.
           IF DBC-GLS-ICLI IN OPC-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN OPC-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN COLFOPC.
           IF RDC-NUM-DIRE IN OPC-FLD-EXT > SPACES
              MOVE RDC-NUM-DIRE IN OPC-FLD-EXT
                   TO SDF-RDC-NUM-DIRE IN COLFOPC.
           IF OPC-COD-RMOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-RMOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-RMOC IN COLFOPC.
           IF OPC-COD-OFOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-OFOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-OFOC IN COLFOPC.
           IF OPC-VAL-CRED IN OPC-FLD-EXT > SPACES
              MOVE OPC-VAL-CRED IN OPC-FLD-EXT
                   TO SDF-OPC-VAL-CRED IN COLFOPC.
           IF ROV-SGV-RENO IN OPC-FLD-EXT > SPACES
              MOVE ROV-SGV-RENO IN OPC-FLD-EXT
                   TO SDF-ROV-SGV-RENO IN COLFOPC.
           IF OPC-COD-SEGD IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-SEGD IN OPC-FLD-EXT
                   TO SDF-OPC-COD-SEGD IN COLFOPC.
           IF OPC-IND-RENO IN OPC-FLD-EXT > SPACES
              MOVE OPC-IND-RENO IN OPC-FLD-EXT
                   TO SDF-OPC-IND-RENO IN COLFOPC.
           IF OPC-VAL-GAST IN OPC-FLD-EXT > SPACES
              MOVE OPC-VAL-GAST IN OPC-FLD-EXT
                   TO SDF-OPC-VAL-GAST IN COLFOPC.
           IF OPC-NUM-VCOR IN OPC-FLD-EXT > SPACES
              MOVE OPC-NUM-VCOR IN OPC-FLD-EXT
                   TO SDF-OPC-NUM-VCOR IN COLFOPC.
           IF OPC-VAL-SEGD IN OPC-FLD-EXT > SPACES
              MOVE OPC-VAL-SEGD IN OPC-FLD-EXT
                   TO SDF-OPC-VAL-SEGD IN COLFOPC.
           IF OPC-COD-SEGC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-SEGC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-SEGC IN COLFOPC.
           IF OPC-FEC-FCOL IN OPC-FLD-EXT > SPACES
              MOVE OPC-FEC-FCOL IN OPC-FLD-EXT
                   TO SDF-OPC-FEC-FCOL IN COLFOPC.
           IF FRM-SGV-TFLV IN OPC-FLD-EXT > SPACES
              MOVE FRM-SGV-TFLV IN OPC-FLD-EXT
                   TO SDF-FRM-SGV-TFLV IN COLFOPC.
           IF OPC-COD-PLCO IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-PLCO IN OPC-FLD-EXT
                   TO SDF-OPC-COD-PLCO IN COLFOPC.
           IF COM-SGV-TINT IN OPC-FLD-EXT > SPACES
              MOVE COM-SGV-TINT IN OPC-FLD-EXT
                   TO SDF-COM-SGV-TINT IN COLFOPC.
           IF OPC-COD-PLIM IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-PLIM IN OPC-FLD-EXT
                   TO SDF-OPC-COD-PLIM IN COLFOPC.
           IF OPC-SGV-VCOM IN OPC-FLD-EXT > SPACES
              MOVE OPC-SGV-VCOM IN OPC-FLD-EXT
                   TO SDF-OPC-SGV-VCOM IN COLFOPC.
           IF ITR-SGV-TINT IN OPC-FLD-EXT > SPACES
              MOVE ITR-SGV-TINT IN OPC-FLD-EXT
                   TO SDF-ITR-SGV-TINT IN COLFOPC.
           IF OPC-MSC-TGAR IN OPC-FLD-EXT > SPACES
              MOVE OPC-MSC-TGAR IN OPC-FLD-EXT
                   TO SDF-OPC-MSC-TGAR IN COLFOPC.
           IF ITR-COD-TINT IN OPC-FLD-EXT > SPACES
              MOVE ITR-COD-TINT IN OPC-FLD-EXT
                   TO SDF-ITR-COD-TINT IN COLFOPC.
           IF ITR-MSC-PCTI IN OPC-FLD-EXT > SPACES
              MOVE ITR-MSC-PCTI IN OPC-FLD-EXT
                   TO SDF-ITR-MSC-PCTI IN COLFOPC.
           IF OPC-IND-VSTR IN OPC-FLD-EXT > SPACES
              MOVE OPC-IND-VSTR IN OPC-FLD-EXT
                   TO SDF-OPC-IND-VSTR IN COLFOPC.
           IF OPC-IND-AFER IN OPC-FLD-EXT > SPACES
              MOVE OPC-IND-AFER IN OPC-FLD-EXT
                   TO SDF-OPC-IND-AFER IN COLFOPC.
           IF OPC-SGV-LIQU IN OPC-FLD-EXT > SPACES
              MOVE OPC-SGV-LIQU IN OPC-FLD-EXT
                   TO SDF-OPC-SGV-LIQU IN COLFOPC.
           IF FRM-NUM-IEST IN OPC-FLD-EXT > SPACES
              MOVE FRM-NUM-IEST IN OPC-FLD-EXT
                   TO SDF-FRM-NUM-IEST IN COLFOPC.
           IF FRM-VRF-IEST IN OPC-FLD-EXT > SPACES
              MOVE FRM-VRF-IEST IN OPC-FLD-EXT
                   TO SDF-FRM-VRF-IEST IN COLFOPC.
           IF FRM-IND-IEST IN OPC-FLD-EXT > SPACES
              MOVE FRM-IND-IEST IN OPC-FLD-EXT
                   TO SDF-FRM-IND-IEST IN COLFOPC.
           IF FRM-GLS-IEST IN OPC-FLD-EXT > SPACES
              MOVE FRM-GLS-IEST IN OPC-FLD-EXT
                   TO SDF-FRM-GLS-IEST IN COLFOPC.
           IF CYA-IND-TCYA IN OPC-FLD-EXT > SPACES
              MOVE CYA-IND-TCYA IN OPC-FLD-EXT
                   TO SDF-CYA-IND-TCYA IN COLFOPC.
           IF FRM-GLS-IESX IN OPC-FLD-EXT > SPACES
              MOVE FRM-GLS-IESX IN OPC-FLD-EXT
                   TO SDF-FRM-GLS-IESX IN COLFOPC.
           IF CYA-CAI-ICYA IN OPC-FLD-EXT > SPACES
              MOVE CYA-CAI-ICYA IN OPC-FLD-EXT
                   TO SDF-CYA-CAI-ICYA IN COLFOPC.
           IF CYA-IIC-ICYA IN OPC-FLD-EXT > SPACES
              MOVE CYA-IIC-ICYA IN OPC-FLD-EXT
                   TO SDF-CYA-IIC-ICYA IN COLFOPC.
           IF OPC-COD-CDOC IN OPC-FLD-EXT > SPACES
              MOVE OPC-COD-CDOC IN OPC-FLD-EXT
                   TO SDF-OPC-COD-CDOC IN COLFOPC.
           IF AUT-CAI-ICYA IN OPC-FLD-EXT > SPACES
              MOVE AUT-CAI-ICYA IN OPC-FLD-EXT
                   TO SDF-AUT-CAI-ICYA IN COLFOPC.
           IF AUT-IIC-ICYA IN OPC-FLD-EXT > SPACES
              MOVE AUT-IIC-ICYA IN OPC-FLD-EXT
                   TO SDF-AUT-IIC-ICYA IN COLFOPC.
       FIN-PRO-COL-OPC-FLD.
           EXIT.
      
       MOV-WI-F-OPC SECTION.
       INI-MOV-F-WI-OPC.
      *     MOVE OPC-COD-VCOC IN OPC-FLD
      *          TO SDF-OPC-COD-VCOC IN COLFOPC.
      *     MOVE OPC-COD-TOOC IN OPC-FLD
      *          TO SDF-OPC-COD-TOOC IN COLFOPC.
      *     MOVE OPC-COD-AOOC IN OPC-FLD
      *          TO SDF-OPC-COD-AOOC IN COLFOPC.
      *     MOVE OPC-CAI-IOPC IN OPC-FLD
      *          TO SDF-OPC-CAI-IOPC IN COLFOPC.
      *     MOVE OPC-IIC-IOPC-ALF IN OPC-FLD
      *          TO SDF-OPC-IIC-IOPC IN COLFOPC.
      *     MOVE CAN-CAI-IOPC IN OPC-FLD
      *          TO SDF-CAN-CAI-IOPC IN COLFOPC.
      *     MOVE CAN-IIC-IOPC-ALF IN OPC-FLD
      *          TO SDF-CAN-IIC-IOPC IN COLFOPC.
      *     MOVE CAN-NUM-ICAN-ALF IN OPC-FLD
      *          TO SDF-CAN-NUM-ICAN IN COLFOPC.
      *     MOVE DBC-NUM-ICLI-ALF IN OPC-FLD
      *          TO SDF-DBC-NUM-ICLI IN COLFOPC.
      *     MOVE DBC-VRF-ICLI IN OPC-FLD
      *          TO SDF-DBC-VRF-ICLI IN COLFOPC.
      *     MOVE DBC-IND-ICLI IN OPC-FLD
      *          TO SDF-DBC-IND-ICLI IN COLFOPC.
      *     MOVE DBC-GLS-ICLI IN OPC-FLD
      *          TO SDF-DBC-GLS-ICLI IN COLFOPC.
      *     MOVE RDC-NUM-DIRE-ALF IN OPC-FLD
      *          TO SDF-RDC-NUM-DIRE IN COLFOPC.
           IF OPC-COD-RMOC IN OPC-FLD > SPACES
              MOVE OPC-COD-RMOC IN OPC-FLD
                   TO SDF-OPC-COD-RMOC IN COLFOPC.
      *     MOVE OPC-COD-OFOC IN OPC-FLD
      *          TO SDF-OPC-COD-OFOC IN COLFOPC.
      *     MOVE OPC-VAL-CRED-ALF IN OPC-FLD
      *          TO SDF-OPC-VAL-CRED IN COLFOPC.
      *     MOVE ROV-SGV-RENO-ALF IN OPC-FLD
      *          TO SDF-ROV-SGV-RENO IN COLFOPC.
           IF OPC-VAL-SCRE-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-SCRE-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-SCRE IN COLFOPC.
           IF OPC-COD-SEGD IN OPC-FLD > SPACES
              MOVE OPC-COD-SEGD IN OPC-FLD
                   TO SDF-OPC-COD-SEGD IN COLFOPC.
           IF OPC-IND-RENO IN OPC-FLD > SPACES
              MOVE OPC-IND-RENO IN OPC-FLD
                   TO SDF-OPC-IND-RENO IN COLFOPC.
           IF OPC-VAL-GAST-ALF IN OPC-FLD > SPACES
              MOVE OPC-VAL-GAST-ALF IN OPC-FLD
                   TO SDF-OPC-VAL-GAST IN COLFOPC.
      *     MOVE OPC-NUM-VCOR-ALF IN OPC-FLD
      *          TO SDF-OPC-NUM-VCOR IN COLFOPC.
      *     MOVE OPC-VAL-SEGD-ALF IN OPC-FLD
      *          TO SDF-OPC-VAL-SEGD IN COLFOPC.
           IF OPC-COD-SEGC IN OPC-FLD > SPACES
              MOVE OPC-COD-SEGC IN OPC-FLD
                   TO SDF-OPC-COD-SEGC IN COLFOPC.
      *     MOVE OPC-FEC-FCOL IN OPC-FLD
      *          TO SDF-OPC-FEC-FCOL IN COLFOPC.
      *     MOVE FRM-SGV-TFLV-ALF IN OPC-FLD
      *          TO SDF-FRM-SGV-TFLV IN COLFOPC.
           IF OPC-COD-PLCO IN OPC-FLD > SPACES
              MOVE OPC-COD-PLCO IN OPC-FLD
                   TO SDF-OPC-COD-PLCO IN COLFOPC.
           IF COM-SGV-TINT-ALF IN OPC-FLD > SPACES
              MOVE COM-SGV-TINT-ALF IN OPC-FLD
                   TO SDF-COM-SGV-TINT IN COLFOPC.
           IF OPC-COD-PLIM IN OPC-FLD > SPACES
              MOVE OPC-COD-PLIM IN OPC-FLD
                   TO SDF-OPC-COD-PLIM IN COLFOPC.
      *     MOVE OPC-SGV-VCOM-FLD IN OPC-FLD
      *          TO SDF-OPC-SGV-VCOM IN COLFOPC.
           IF ITR-SGV-TINT-ALF IN OPC-FLD > SPACES
              MOVE ITR-SGV-TINT-ALF IN OPC-FLD
                   TO SDF-ITR-SGV-TINT IN COLFOPC.
           IF OPC-MSC-TGAR IN OPC-FLD > SPACES
              MOVE OPC-MSC-TGAR IN OPC-FLD
                   TO SDF-OPC-MSC-TGAR IN COLFOPC.
      *     MOVE ITR-COD-TINT IN OPC-FLD
      *          TO SDF-ITR-COD-TINT IN COLFOPC.
           IF ITR-MSC-PCTI IN OPC-FLD > SPACES
              MOVE ITR-MSC-PCTI IN OPC-FLD
                   TO SDF-ITR-MSC-PCTI IN COLFOPC.
           IF OPC-IND-VSTR IN OPC-FLD > SPACES
              MOVE OPC-IND-VSTR IN OPC-FLD
                   TO SDF-OPC-IND-VSTR IN COLFOPC.
           IF OPC-IND-AFER IN OPC-FLD > SPACES
              MOVE OPC-IND-AFER IN OPC-FLD
                   TO SDF-OPC-IND-AFER IN COLFOPC.
      *     MOVE OPC-SGV-LIQU-ALF IN OPC-FLD
      *          TO SDF-OPC-SGV-LIQU IN COLFOPC.
      *     MOVE FRM-NUM-IEST-ALF IN OPC-FLD
      *          TO SDF-FRM-NUM-IEST IN COLFOPC.
      *     MOVE FRM-VRF-IEST IN OPC-FLD
      *          TO SDF-FRM-VRF-IEST IN COLFOPC.
      *     MOVE FRM-IND-IEST IN OPC-FLD
      *          TO SDF-FRM-IND-IEST IN COLFOPC.
      *     MOVE FRM-GLS-IEST IN OPC-FLD
      *          TO SDF-FRM-GLS-IEST IN COLFOPC.
           IF CYA-IND-TCYA IN OPC-FLD > SPACES
              MOVE CYA-IND-TCYA IN OPC-FLD
                   TO SDF-CYA-IND-TCYA IN COLFOPC.
      *     MOVE FRM-GLS-IESX IN OPC-FLD
      *          TO SDF-FRM-GLS-IESX IN COLFOPC.
      *     MOVE CYA-CAI-ICYA IN OPC-FLD
      *          TO SDF-CYA-CAI-ICYA IN COLFOPC.
      *     MOVE CYA-IIC-ICYA-ALF IN OPC-FLD
      *          TO SDF-CYA-IIC-ICYA IN COLFOPC.
           IF OPC-COD-CDOC IN OPC-FLD > SPACES
              MOVE OPC-COD-CDOC IN OPC-FLD
                   TO SDF-OPC-COD-CDOC IN COLFOPC.
           IF AUT-CAI-ICYA IN OPC-FLD > SPACES
              MOVE AUT-CAI-ICYA IN OPC-FLD
                   TO SDF-AUT-CAI-ICYA IN COLFOPC.
           IF AUT-IIC-ICYA-ALF IN OPC-FLD > SPACES
              MOVE AUT-IIC-ICYA-ALF IN OPC-FLD
                   TO SDF-AUT-IIC-ICYA IN COLFOPC.
       FIN-MOV-F-WI-OPC.
           EXIT.
      
      
       PRO-COL-DLC SECTION.
       INI-PRO-COL-DLC.
           IF WSS-ERR-OPC = "S"
               DISPLAY "NO PROCESARA DLC POR ERROR EN TX OPC"
               GO TO FIN-PRO-COL-DLC.
           MOVE "COL" TO ICM-SIST.
           MOVE "DLC" TO ICM-FORM.
           MOVE SPACES TO DLC-FLD-EXT.
           MOVE WSS-ENTI TO DLC-FLD-EXT.
           PERFORM PRO-COL-DLC-KEY-SCR.
           PERFORM PRO-COL-DLC-KEY.
           MOVE  COLFDLC   TO ENV-FRM-VARI.
           MOVE "COLPADLC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES DLC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DLC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-DLC.
           PERFORM PRO-COL-DLC-FLD-SCR.
           PERFORM MOV-WI-F-DLC.
           PERFORM PRO-COL-DLC-FLD.
           MOVE  COLFDLC   TO ENV-FRM-VARI.
           MOVE "COLPADLC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS DLC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DLC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-DLC.
           PERFORM GRAB-REG-ING.
       FIN-PRO-COL-DLC.
           EXIT.
      
       PRO-COL-DLC-KEY-SCR SECTION.
       INI-PRO-COL-DLC-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTDLC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA15" TO SCR-NTRN.
           MOVE "COLPADLC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C"   TO SCR-ICMN.
           MOVE """"  TO SCR-FFLD.
           MOVE "S"   TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-DLC-KEY-SCR.
           EXIT.
      
       PRO-COL-DLC-FLD-SCR SECTION.
       INI-PRO-COL-DLC-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-DLC-FLD-SCR.
           EXIT.
      
       PRO-COL-DLC-KEY SECTION.
       INI-PRO-COL-DLC-KEY.
           MOVE SPACES TO COLFDLC.
           IF DLC-CAI-IOPC IN DLC-FLD-EXT > SPACES
              MOVE DLC-CAI-IOPC IN DLC-FLD-EXT
               TO SDF-DLC-CAI-IOPC IN COLFDLC
           ELSE
               MOVE WSS-CAI-IOPC TO SDF-DLC-CAI-IOPC IN COLFDLC.
           IF DLC-IIC-IOPC IN DLC-FLD-EXT > ZEROES
              MOVE DLC-IIC-IOPC IN DLC-FLD-EXT
               TO SDF-DLC-IIC-IOPC IN COLFDLC
           ELSE
               MOVE WSS-IIC-IOPC TO SDF-DLC-IIC-IOPC IN COLFDLC.
       FIN-PRO-COL-DLC-KEY.
           EXIT.
      
       PRO-COL-DLC-FLD SECTION.
       INI-PRO-COL-DLC-FLD.
      *    IF DLC-CAI-IOPC IN DLC-FLD-EXT > SPACES
      *       MOVE DLC-CAI-IOPC IN DLC-FLD-EXT
      *         TO SDF-DLC-CAI-IOPC IN COLFDLC.
      *    IF DLC-IIC-IOPC IN DLC-FLD-EXT > SPACES
      *       MOVE DLC-IIC-IOPC IN DLC-FLD-EXT
      *         TO SDF-DLC-IIC-IOPC IN COLFDLC.
           IF DLC-NUM-IDLC IN DLC-FLD-EXT > ZEROES
              MOVE DLC-NUM-IDLC IN DLC-FLD-EXT
                TO SDF-DLC-NUM-IDLC IN COLFDLC.
           IF DBC-NUM-ICLI IN DLC-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN DLC-FLD-EXT
                TO SDF-DBC-NUM-ICLI IN COLFDLC.
           IF DBC-VRF-ICLI IN DLC-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN DLC-FLD-EXT
                TO SDF-DBC-VRF-ICLI IN COLFDLC.
           IF DBC-IND-ICLI IN DLC-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN DLC-FLD-EXT
                TO SDF-DBC-IND-ICLI IN COLFDLC.
           IF DBC-GLS-ICLI IN DLC-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN DLC-FLD-EXT
                TO SDF-DBC-GLS-ICLI IN COLFDLC.
           IF RDC-NUM-DIRE IN DLC-FLD-EXT > SPACES
              MOVE RDC-NUM-DIRE IN DLC-FLD-EXT
                TO SDF-RDC-NUM-DIRE IN COLFDLC.
           IF RCD-GLS-DIRE IN DLC-FLD-EXT > SPACES
              MOVE RCD-GLS-DIRE IN DLC-FLD-EXT
                TO SDF-RCD-GLS-DIRE IN COLFDLC.
           IF RCD-COD-LUGA IN DLC-FLD-EXT > SPACES
              MOVE RCD-COD-LUGA IN DLC-FLD-EXT
                TO SDF-RCD-COD-LUGA IN COLFDLC.
           IF DLC-VAL-NDLC IN DLC-FLD-EXT > SPACES
              MOVE DLC-VAL-NDLC IN DLC-FLD-EXT
                TO SDF-DLC-VAL-NDLC IN COLFDLC.
           IF DLC-FEC-FMAV IN DLC-FLD-EXT > SPACES
              MOVE DLC-FEC-FMAV IN DLC-FLD-EXT
                TO SDF-DLC-FEC-FMAV IN COLFDLC.
           IF DLC-FEC-FGIR IN DLC-FLD-EXT > SPACES
              MOVE DLC-FEC-FGIR IN DLC-FLD-EXT
                TO SDF-DLC-FEC-FGIR IN COLFDLC.
           IF DLC-COD-NBCO IN DLC-FLD-EXT > SPACES
              MOVE DLC-COD-NBCO IN DLC-FLD-EXT
                TO SDF-DLC-COD-NBCO IN COLFDLC.
           IF DLC-COD-PLZA IN DLC-FLD-EXT > SPACES
              MOVE DLC-COD-PLZA IN DLC-FLD-EXT
                TO SDF-DLC-COD-PLZA IN COLFDLC.
           IF DLC-COD-TDOC IN DLC-FLD-EXT > SPACES
              MOVE DLC-COD-TDOC IN DLC-FLD-EXT
                TO SDF-DLC-COD-TDOC IN COLFDLC.
           IF ICG-SGV-TINT IN DLC-FLD-EXT > SPACES
              MOVE ICG-SGV-TINT IN DLC-FLD-EXT
                TO SDF-ICG-SGV-TINT IN COLFDLC.
           IF DLC-MSC-TIMP IN DLC-FLD-EXT > SPACES
              MOVE DLC-MSC-TIMP IN DLC-FLD-EXT
                TO SDF-DLC-MSC-TIMP IN COLFDLC.
           IF DLC-VAL-IMPU IN DLC-FLD-EXT > SPACES
              MOVE DLC-VAL-IMPU IN DLC-FLD-EXT
                TO SDF-DLC-VAL-IMPU IN COLFDLC.
           IF DLC-IND-PORD IN DLC-FLD-EXT > SPACES
              MOVE DLC-IND-PORD IN DLC-FLD-EXT
                TO SDF-DLC-IND-PORD IN COLFDLC.
           IF DLC-COD-NOTC IN DLC-FLD-EXT > SPACES
              MOVE DLC-COD-NOTC IN DLC-FLD-EXT
                TO SDF-DLC-COD-NOTC IN COLFDLC.
           IF DLC-COD-UBFD IN DLC-FLD-EXT > SPACES
              MOVE DLC-COD-UBFD IN DLC-FLD-EXT
                TO SDF-DLC-COD-UBFD IN COLFDLC.
           IF DLC-VAL-GNOT IN DLC-FLD-EXT > SPACES
              MOVE DLC-VAL-GNOT IN DLC-FLD-EXT
                TO SDF-DLC-VAL-GNOT IN COLFDLC.
           IF DLC-IND-SCRT IN DLC-FLD-EXT > SPACES
              MOVE DLC-IND-SCRT IN DLC-FLD-EXT
                TO SDF-DLC-IND-SCRT IN COLFDLC.
           IF DLC-IND-SCTB IN DLC-FLD-EXT > SPACES
              MOVE DLC-IND-SCTB IN DLC-FLD-EXT
                TO SDF-DLC-IND-SCTB IN COLFDLC.
           IF DLC-IND-SCBZ IN DLC-FLD-EXT > SPACES
              MOVE DLC-IND-SCBZ IN DLC-FLD-EXT
                TO SDF-DLC-IND-SCBZ IN COLFDLC.
       FIN-PRO-COL-DLC-FLD.
           EXIT.
      
       MOV-WI-F-DLC SECTION.
       INI-WI-F-DLC.
      *     IF DLC-CAI-IOPC IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-CAI-IOPC IN DLC-FLD
      *          TO SDF-DLC-CAI-IOPC IN COLFDLC.
      *     IF DLC-IIC-IOPC-ALF IN DLC-FLD > SPACES
      *        MOVE DLC-IIC-IOPC-ALF IN DLC-FLD
      *          TO SDF-DLC-IIC-IOPC IN COLFDLC.
            IF DLC-NUM-IDLC-ALF IN DLC-FLD > SPACES
               MOVE DLC-NUM-IDLC-ALF IN DLC-FLD
                 TO SDF-DLC-NUM-IDLC IN COLFDLC.
      *     IF DBC-NUM-ICLI-ALF IN DLC-FLD-EXT > SPACES
      *        MOVE DBC-NUM-ICLI-ALF IN DLC-FLD-EXT
      *          TO SDF-DBC-NUM-ICLI IN COLFDLC.
      *     IF DBC-VRF-ICLI IN DLC-FLD-EXT > SPACES
      *        MOVE DBC-VRF-ICLI IN DLC-FLD-EXT
      *          TO SDF-DBC-VRF-ICLI IN COLFDLC.
      *     IF DBC-IND-ICLI IN DLC-FLD-EXT > SPACES
      *        MOVE DBC-IND-ICLI IN DLC-FLD-EXT
      *          TO SDF-DBC-IND-ICLI IN COLFDLC.
      *     IF DBC-GLS-ICLI IN DLC-FLD-EXT > SPACES
      *        MOVE DBC-GLS-ICLI IN DLC-FLD-EXT
      *          TO SDF-DBC-GLS-ICLI IN COLFDLC.
      *     IF RDC-NUM-DIRE-ALF IN DLC-FLD-EXT > SPACES
      *        MOVE RDC-NUM-DIRE-ALF IN DLC-FLD-EXT
      *          TO SDF-RDC-NUM-DIRE IN COLFDLC.
      *     IF RCD-GLS-DIRE IN DLC-FLD-EXT > SPACES
      *        MOVE RCD-GLS-DIRE IN DLC-FLD-EXT
      *           TO SDF-RCD-GLS-DIRE IN COLFDLC.
      *     IF RCD-COD-LUGA IN DLC-FLD-EXT > SPACES
      *        MOVE RCD-COD-LUGA IN DLC-FLD-EXT
      *          TO SDF-RCD-COD-LUGA IN COLFDLC.
      *     IF DLC-VAL-NDLC-ALF IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-VAL-NDLC-ALF IN DLC-FLD-EXT
      *          TO SDF-DLC-VAL-NDLC IN COLFDLC.
      *     IF DLC-FEC-FMAV IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-FEC-FMAV IN DLC-FLD-EXT
      *          TO SDF-DLC-FEC-FMAV IN COLFDLC.
      *     IF DLC-FEC-FGIR IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-FEC-FGIR IN DLC-FLD-EXT
      *          TO SDF-DLC-FEC-FGIR IN COLFDLC.
      *     IF DLC-COD-NBCO IN DLC-FLD-EXT > SPACES
      *     MOVE DLC-COD-NBCO IN DLC-FLD-EXT
      *          TO SDF-DLC-COD-NBCO IN COLFDLC.
      *     IF DLC-COD-PLZA IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-COD-PLZA IN DLC-FLD-EXT
      *          TO SDF-DLC-COD-PLZA IN COLFDLC.
           IF DLC-COD-TDOC IN DLC-FLD > SPACES
              MOVE DLC-COD-TDOC IN DLC-FLD
                TO SDF-DLC-COD-TDOC IN COLFDLC.
           IF ICG-SGV-TINT-ALF IN DLC-FLD > SPACES
              MOVE ICG-SGV-TINT-ALF IN DLC-FLD
                TO SDF-ICG-SGV-TINT IN COLFDLC.
      *     IF DLC-MSC-TIMP IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-MSC-TIMP IN DLC-FLD-EXT
      *          TO SDF-DLC-MSC-TIMP IN COLFDLC.
      *      IF DLC-VAL-IMPU-ALF IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-VAL-IMPU-ALF IN DLC-FLD-EXT
      *          TO SDF-DLC-VAL-IMPU IN COLFDLC.
           IF DLC-IND-PORD IN DLC-FLD > SPACES
              MOVE DLC-IND-PORD IN DLC-FLD
                TO SDF-DLC-IND-PORD IN COLFDLC.
      *      IF DLC-COD-NOTC IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-COD-NOTC IN DLC-FLD-EXT
      *          TO SDF-DLC-COD-NOTC IN COLFDLC.
      *     IF DLC-COD-UBFD IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-COD-UBFD IN DLC-FLD-EXT
      *          TO SDF-DLC-COD-UBFD IN COLFDLC.
      *     IF DLC-VAL-GNOT-ALF IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-VAL-GNOT-ALF IN DLC-FLD-EXT
      *          TO SDF-DLC-VAL-GNOT IN COLFDLC.
      *     IF DLC-IND-SCRT IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-IND-SCRT IN DLC-FLD-EXT
      *          TO SDF-DLC-IND-SCRT IN COLFDLC.
      *     IF DLC-IND-SCTB IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-IND-SCTB IN DLC-FLD-EXT
      *          TO SDF-DLC-IND-SCTB IN COLFDLC.
      *     IF DLC-IND-SCBZ IN DLC-FLD-EXT > SPACES
      *        MOVE DLC-IND-SCBZ IN DLC-FLD-EXT
      *          TO SDF-DLC-IND-SCBZ IN COLFDLC.
       FIN-WI-F-DLC.
           EXIT.
      
       PRO-COL-EVC SECTION.
       INI-PRO-COL-EVC.
           IF WSS-ERR-OPC = "S"
               DISPLAY "NO PROCESARA EVC POR ERROR EN TX OPC"
               GO TO FIN-PRO-COL-EVC.
           MOVE "COL" TO ICM-SIST.
           MOVE "EVC" TO ICM-FORM.
           MOVE SPACES   TO EVC-FLD-EXT.
           MOVE WSS-ENTI TO EVC-FLD-EXT.
           PERFORM PRO-COL-EVC-KEY-SCR.
           PERFORM PRO-COL-EVC-KEY.
           MOVE  COLFEVC   TO ENV-FRM-VARI.
           MOVE "COLPAEVC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES EVC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO EVC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-EVC.
           MOVE CM-DATOS TO EVC-FLD.
           PERFORM PRO-COL-EVC-FLD-SCR.
           PERFORM MOV-WI-F-EVC.
           PERFORM PRO-COL-EVC-FLD.
           MOVE  COLFEVC   TO ENV-FRM-VARI.
           MOVE "COLPAEVC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS EVC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO EVC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-EVC.
           PERFORM GRAB-REG-ING.
       FIN-PRO-COL-EVC.
           EXIT.
      
       PRO-COL-EVC-KEY-SCR SECTION.
       INI-PRO-COL-EVC-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTEVC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA13" TO SCR-NTRN.
           MOVE "COLPAEVC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-EVC-KEY-SCR.
           EXIT.
      
       PRO-COL-EVC-FLD-SCR SECTION.
       INI-PRO-COL-EVC-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-EVC-FLD-SCR.
           EXIT.
      
       PRO-COL-EVC-KEY SECTION.
       INI-PRO-COL-EVC-KEY.
           MOVE SPACES TO COLFEVC.
           IF EVC-CAI-IOPC IN EVC-FLD-EXT > SPACES
              MOVE EVC-CAI-IOPC IN EVC-FLD-EXT
                   TO SDF-EVC-CAI-IOPC IN COLFEVC
           ELSE
               MOVE WSS-CAI-IOPC TO SDF-EVC-CAI-IOPC IN COLFEVC.
           IF EVC-IIC-IOPC IN EVC-FLD-EXT > ZEROES
              MOVE EVC-IIC-IOPC IN EVC-FLD-EXT
                   TO SDF-EVC-IIC-IOPC IN COLFEVC
           ELSE
              MOVE WSS-IIC-IOPC TO SDF-EVC-IIC-IOPC IN COLFEVC.
           IF PVC-CIC-IPVC IN EVC-FLD-EXT > SPACES
              MOVE PVC-CIC-IPVC IN EVC-FLD-EXT
                   TO SDF-PVC-CIC-IPVC IN COLFEVC.
       FIN-PRO-COL-EVC-KEY.
           EXIT.
      
       PRO-COL-EVC-FLD SECTION.
       INI-PRO-COL-EVC-FLD.
           IF   EVC-NUM-IEVC IN EVC-FLD-EXT > ZEROES
           MOVE EVC-NUM-IEVC IN EVC-FLD-EXT
                TO SDF-EVC-NUM-IEVC IN COLFEVC.
           IF   FRM-NUM-DURV IN EVC-FLD-EXT > SPACES
           MOVE FRM-NUM-DURV IN EVC-FLD-EXT
                TO SDF-FRM-NUM-DURV IN COLFEVC.
           IF   FRM-IND-UTDV IN EVC-FLD-EXT > SPACES
           MOVE FRM-IND-UTDV IN EVC-FLD-EXT
                TO SDF-FRM-IND-UTDV IN COLFEVC.
           IF   EVC-NUM-IDLC IN EVC-FLD-EXT > SPACES
           MOVE EVC-NUM-IDLC IN EVC-FLD-EXT
                TO SDF-EVC-NUM-IDLC IN COLFEVC.
           IF   EVC-NUM-VIGU IN EVC-FLD-EXT > SPACES
           MOVE EVC-NUM-VIGU IN EVC-FLD-EXT
                TO SDF-EVC-NUM-VIGU IN COLFEVC.
           IF   EVC-FEC-FPVC IN EVC-FLD-EXT > SPACES
           MOVE EVC-FEC-FPVC IN EVC-FLD-EXT
                 TO SDF-EVC-FEC-FPVC IN COLFEVC.
           IF   EVC-NUM-DPVE IN EVC-FLD-EXT > SPACES
           MOVE EVC-NUM-DPVE IN EVC-FLD-EXT
                TO SDF-EVC-NUM-DPVE IN COLFEVC.
           IF   FRM-NUM-SPVE IN EVC-FLD-EXT > SPACES
           MOVE FRM-NUM-SPVE IN EVC-FLD-EXT
                TO SDF-FRM-NUM-SPVE IN COLFEVC.
           IF   FRM-IND-UTPV IN EVC-FLD-EXT > SPACES
           MOVE FRM-IND-UTPV IN EVC-FLD-EXT
                TO SDF-FRM-IND-UTPV IN COLFEVC.
           IF   EVC-MSC-TCVE IN EVC-FLD-EXT > SPACES
           MOVE EVC-MSC-TCVE IN EVC-FLD-EXT
                TO SDF-EVC-MSC-TCVE IN COLFEVC.
           IF   EVC-NUM-DESD IN EVC-FLD-EXT > SPACES
           MOVE EVC-NUM-DESD IN EVC-FLD-EXT
                TO SDF-EVC-NUM-DESD IN COLFEVC.
           IF   EVC-VAL-VENC IN EVC-FLD-EXT > SPACES
           MOVE EVC-VAL-VENC IN EVC-FLD-EXT
                TO SDF-EVC-VAL-VENC IN COLFEVC.
           IF   EVC-NUM-SEVE IN EVC-FLD-EXT > SPACES
           MOVE EVC-NUM-SEVE IN EVC-FLD-EXT
                TO SDF-EVC-NUM-SEVE IN COLFEVC.
           IF   EVC-IND-UTSV IN EVC-FLD-EXT > SPACES
           MOVE EVC-IND-UTSV IN EVC-FLD-EXT
                TO SDF-EVC-IND-UTSV IN COLFEVC.
           MOVE EVC-SGV-FVAR IN EVC-FLD-EXT
                TO SDF-EVC-SGV-FVAR IN COLFEVC.
           IF   EVC-IND-CAUT IN EVC-FLD-EXT > SPACES
           MOVE EVC-IND-CAUT IN EVC-FLD-EXT
                TO SDF-EVC-IND-CAUT IN COLFEVC.
           IF   EVC-IND-FVAR IN EVC-FLD-EXT > SPACES
           MOVE EVC-IND-FVAR IN EVC-FLD-EXT
                TO SDF-EVC-IND-FVAR IN COLFEVC.
       FIN-PRO-COL-EVC-FLD.
           EXIT.
      
       MOV-WI-F-EVC SECTION.
       INI-MOV-WI-F-OPC.
           IF   OPC-COD-TOOC IN EVC-FLD > SPACES
           MOVE OPC-COD-TOOC IN EVC-FLD
                TO SDF-OPC-COD-TOOC IN COLFEVC.
           IF   EVC-NUM-IEVC-ALF IN EVC-FLD > SPACES
           MOVE EVC-NUM-IEVC-ALF IN EVC-FLD
                TO SDF-EVC-NUM-IEVC IN COLFEVC.
      *    IF   FRM-NUM-DURV-ALF IN EVC-FLD > SPACES
      *    MOVE FRM-NUM-DURV-ALF IN EVC-FLD
      *          TO SDF-FRM-NUM-DURV IN COLFEVC.
      *    IF   FRM-IND-UTDV IN EVC-FLD > SPACES
      *    MOVE FRM-IND-UTDV IN EVC-FLD
      *         TO SDF-FRM-IND-UTDV IN COLFEVC.
      *    IF   EVC-NUM-IDLC-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-NUM-IDLC-ALF IN EVC-FLD
      *         TO SDF-EVC-NUM-IDLC IN COLFEVC.
      *    IF   EVC-NUM-VIGU-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-NUM-VIGU-ALF IN EVC-FLD
      *         TO SDF-EVC-NUM-VIGU IN COLFEVC.
      *    IF   EVC-FEC-FPVC IN EVC-FLD > SPACES
      *    MOVE EVC-FEC-FPVC IN EVC-FLD
      *          TO SDF-EVC-FEC-FPVC IN COLFEVC.
      *    IF   EVC-NUM-DPVE-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-NUM-DPVE-ALF IN EVC-FLD
      *         TO SDF-EVC-NUM-DPVE IN COLFEVC.
      *    IF   FRM-NUM-SPVE-ALF IN EVC-FLD > SPACES
      *    MOVE FRM-NUM-SPVE-ALF IN EVC-FLD
      *         TO SDF-FRM-NUM-SPVE IN COLFEVC.
      *    IF   FRM-IND-UTPV IN EVC-FLD > SPACES
      *    MOVE FRM-IND-UTPV IN EVC-FLD
      *         TO SDF-FRM-IND-UTPV IN COLFEVC.
      *    IF   EVC-MSC-TCVE IN EVC-FLD > SPACES
      *    MOVE EVC-MSC-TCVE IN EVC-FLD
      *         TO SDF-EVC-MSC-TCVE IN COLFEVC.
      *    IF   EVC-NUM-DESD-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-NUM-DESD-ALF IN EVC-FLD
      *         TO SDF-EVC-NUM-DESD IN COLFEVC.
      *    IF   EVC-VAL-VENC-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-VAL-VENC-ALF IN EVC-FLD
      *         TO SDF-EVC-VAL-VENC IN COLFEVC.
      *    IF   EVC-NUM-SEVE-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-NUM-SEVE-ALF IN EVC-FLD
      *         TO SDF-EVC-NUM-SEVE IN COLFEVC.
      *    IF   EVC-IND-UTSV IN EVC-FLD > SPACES
      *    MOVE EVC-IND-UTSV IN EVC-FLD
      *         TO SDF-EVC-IND-UTSV IN COLFEVC.
      *    IF   EVC-SGV-FVAR-ALF IN EVC-FLD > SPACES
      *    MOVE EVC-SGV-FVAR-ALF IN EVC-FLD
      *         TO SDF-EVC-SGV-FVAR IN COLFEVC.
      *    IF   EVC-IND-CAUT IN EVC-FLD > SPACES
      *    MOVE EVC-IND-CAUT IN EVC-FLD
      *         TO SDF-EVC-IND-CAUT IN COLFEVC.
      *    IF   EVC-IND-FVAR IN EVC-FLD > SPACES
      *    MOVE EVC-IND-FVAR IN EVC-FLD
      *         TO SDF-EVC-IND-FVAR IN COLFEVC.
       FIN-MOV-WI-F-OPC.
           EXIT.
      
       PRO-COL-RDC SECTION.
       INI-PRO-COL-RDC.
           IF WSS-ERR-OPC = "S"
               DISPLAY "NO PROCESARA RDC POR ERROR EN TX OPC"
               GO TO FIN-PRO-COL-RDC.
           MOVE "COL" TO ICM-SIST.
           MOVE "RDC" TO ICM-FORM.
           MOVE SPACES   TO RDC-FLD-EXT.
           MOVE WSS-ENTI TO RDC-FLD-EXT.
           PERFORM PRO-COL-RDC-KEY-SCR.
           PERFORM PRO-COL-RDC-KEY.
           MOVE  COLFRDC   TO ENV-FRM-VARI.
           MOVE "COLPARDC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES RDC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO RDC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-RDC.
           PERFORM PRO-COL-RDC-FLD-SCR.
           PERFORM MOV-WI-F-RDC.
           PERFORM PRO-COL-RDC-FLD.
           MOVE  COLFRDC   TO ENV-FRM-VARI.
           MOVE "COLPARDC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS RDC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO RDC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-RDC.
           PERFORM GRAB-REG-ING.
       FIN-PRO-COL-RDC.
           EXIT.
      
       PRO-COL-RDC-KEY-SCR SECTION.
       INI-PRO-COL-RDC-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTRDC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA29" TO SCR-NTRN.
           MOVE "COLPARDC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-RDC-KEY-SCR.
           EXIT.
      
       PRO-COL-RDC-FLD-SCR SECTION.
       INI-PRO-COL-RDC-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-COL-RDC-FLD-SCR.
           EXIT.
      
       PRO-COL-RDC-KEY SECTION.
       INI-PRO-COL-RDC-KEY.
           MOVE SPACES TO COLFRDC.
           IF RDC-CAI-IOPC IN RDC-FLD-EXT > SPACES
              MOVE RDC-CAI-IOPC IN RDC-FLD-EXT
                   TO SDF-RDC-CAI-IOPC IN COLFRDC
           ELSE
              MOVE WSS-CAI-IOPC TO SDF-RDC-CAI-IOPC IN COLFRDC.
           IF RDC-IIC-IOPC IN RDC-FLD-EXT > ZEROES
              MOVE RDC-IIC-IOPC IN RDC-FLD-EXT
                   TO SDF-RDC-IIC-IOPC IN COLFRDC
           ELSE
              MOVE WSS-IIC-IOPC TO SDF-RDC-IIC-IOPC IN COLFRDC.
           IF RDC-NUM-IDLC IN RDC-FLD-EXT > SPACES
              MOVE RDC-NUM-IDLC IN RDC-FLD-EXT
                   TO SDF-RDC-NUM-IDLC IN COLFRDC.
           IF DBC-NUM-ICLI IN RDC-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN RDC-FLD-EXT
                    TO SDF-DBC-NUM-ICLI IN COLFRDC.
           IF DBC-VRF-ICLI IN RDC-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN RDC-FLD-EXT
                    TO SDF-DBC-VRF-ICLI IN COLFRDC.
           IF DBC-IND-ICLI IN RDC-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN RDC-FLD-EXT
                    TO SDF-DBC-IND-ICLI IN COLFRDC.
           IF DBC-GLS-ICLI IN RDC-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN RDC-FLD-EXT
                    TO SDF-DBC-GLS-ICLI IN COLFRDC.
       FIN-PRO-COL-RDC-KEY.
           EXIT.
      
       PRO-COL-RDC-FLD SECTION.
       INI-PRO-COL-RDC-FLD.
           IF RDC-NUM-DIRE IN RDC-FLD-EXT > SPACES
              MOVE RDC-NUM-DIRE IN RDC-FLD-EXT
                   TO SDF-RDC-NUM-DIRE IN COLFRDC.
           IF RDC-VAL-LIMD IN RDC-FLD-EXT > SPACES
              MOVE RDC-VAL-LIMD IN RDC-FLD-EXT
                   TO SDF-RDC-VAL-LIMD IN COLFRDC.
       FIN-PRO-COL-RDC-FLD.
           EXIT.
      
       MOV-WI-F-RDC SECTION.
       INI-MOV-WI-F-RDC.
           IF RDC-NUM-DIRE-ALF IN RDC-FLD > SPACES
              MOVE RDC-NUM-DIRE-ALF IN RDC-FLD
                   TO SDF-RDC-NUM-DIRE IN COLFRDC.
           IF RDC-VAL-LIMD-ALF IN RDC-FLD > SPACES
              MOVE RDC-VAL-LIMD-ALF IN RDC-FLD
                   TO SDF-RDC-VAL-LIMD IN COLFRDC.
       FIN-MOV-WI-F-RDC.
           EXIT.
      
      
       PRO-COL-RMC SECTION.
       INI-PRO-COL-RMC.
           IF WSS-ERR-OPC = "S"
               DISPLAY "NO PROCESARA RMC POR ERROR EN TX OPC"
               GO TO FIN-PRO-COL-RMC.
           MOVE "COL" TO ICM-SIST.
           MOVE "RMC" TO ICM-FORM.
           MOVE SPACES   TO RMC-FLD-EXT.
           MOVE WSS-ENTI TO RMC-FLD-EXT.
           PERFORM PRO-COL-RMC-KEY-SCR.
           PERFORM PRO-COL-RMC-KEY.
           MOVE  COLFRMC   TO ENV-FRM-VARI.
           MOVE "COLPARMC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES RMC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO RMC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-RMC.
           PERFORM PRO-COL-RMC-FLD-SCR.
           PERFORM MOV-WI-F-RMC.
           PERFORM PRO-COL-RMC-FLD.
           MOVE  COLFRMC   TO ENV-FRM-VARI.
           MOVE "COLPARMC" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS RMC]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO RMC-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-OPC
              PERFORM INF-ERR
              GO TO FIN-PRO-COL-RMC.
           PERFORM GRAB-REG-ING.
       FIN-PRO-COL-RMC.
           EXIT.
      
       PRO-COL-RMC-KEY-SCR SECTION.
       INI-PRO-COL-RMC-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "COLACTRMC" TO SCR-NEMO.
           MOVE "COL" TO SCR-SIST.
           MOVE "KA17" TO SCR-NTRN.
           MOVE "COLPARMC" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-COL-RMC-KEY-SCR.
           EXIT.
      
       PRO-COL-RMC-FLD-SCR SECTION.
       INI-PRO-COL-RMC-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-GAR-GSE-FLD-SCR.
           EXIT.
      
       PRO-COL-RMC-KEY SECTION.
       INI-PRO-COL-RMC-KEY.
           MOVE SPACES TO COLFRMC.
           IF RMC-CAI-IOPC IN RMC-FLD-EXT > SPACES
              MOVE RMC-CAI-IOPC IN RMC-FLD-EXT
                   TO SDF-RMC-CAI-IOPC IN COLFRMC
           ELSE
              MOVE WSS-CAI-IOPC TO SDF-RMC-CAI-IOPC IN COLFRMC.
           IF RMC-IIC-IOPC IN RMC-FLD-EXT > ZEROES
              MOVE RMC-IIC-IOPC IN RMC-FLD-EXT
                   TO SDF-RMC-IIC-IOPC IN COLFRMC
           ELSE
              MOVE WSS-IIC-IOPC TO SDF-RMC-IIC-IOPC IN COLFRMC.
       FIN-PRO-COL-RMC-KEY.
           EXIT.
      
       PRO-COL-RMC-FLD SECTION.
       INI-PRO-COL-RMC-FLD.
           IF RMC-CAI-IRMC IN RMC-FLD-EXT > SPACES
              MOVE RMC-CAI-IRMC IN RMC-FLD-EXT
                   TO SDF-RMC-CAI-IRMC IN COLFRMC.
           IF RMC-IIC-IRMC IN RMC-FLD-EXT > SPACES
              MOVE RMC-IIC-IRMC IN RMC-FLD-EXT
                   TO SDF-RMC-IIC-IRMC IN COLFRMC.
           IF RMC-COD-TJCR IN RMC-FLD-EXT > SPACES
              MOVE RMC-COD-TJCR IN RMC-FLD-EXT
                   TO SDF-RMC-COD-TJCR IN COLFRMC.
           IF RMC-NUM-ORIG IN RMC-FLD-EXT > SPACES
              MOVE RMC-NUM-ORIG IN RMC-FLD-EXT
                   TO SDF-RMC-NUM-ORIG IN COLFRMC.
           IF RMC-COD-NPLZ IN RMC-FLD-EXT > SPACES
              MOVE RMC-COD-NPLZ IN RMC-FLD-EXT
                   TO SDF-RMC-COD-NPLZ IN COLFRMC.
           IF RMC-COD-ICCS IN RMC-FLD-EXT > SPACES
              MOVE RMC-COD-ICCS IN RMC-FLD-EXT
                   TO SDF-RMC-COD-ICCS IN COLFRMC.
       FIN-PRO-COL-RMC-FLD.
           EXIT.
      
       MOV-WI-F-RMC SECTION.
       INI-MOV-WI-F-RMC.
           IF OPC-COD-VCOC IN RMC-FLD > SPACES
              MOVE OPC-COD-VCOC IN RMC-FLD
                   TO SDF-OPC-COD-VCOC IN COLFRMC.
           IF OPC-COD-TOOC IN RMC-FLD > SPACES
              MOVE OPC-COD-TOOC IN RMC-FLD
                   TO SDF-OPC-COD-TOOC IN COLFRMC.
           IF OPC-COD-AOOC IN RMC-FLD > SPACES
              MOVE OPC-COD-AOOC IN RMC-FLD
                   TO SDF-OPC-COD-AOOC IN COLFRMC.
           IF DBC-NUM-ICLI-ALF IN RMC-FLD > SPACES
              MOVE DBC-NUM-ICLI-ALF IN RMC-FLD
                   TO SDF-DBC-NUM-ICLI IN COLFRMC.
           IF DBC-VRF-ICLI IN RMC-FLD > SPACES
              MOVE DBC-VRF-ICLI IN RMC-FLD
                   TO SDF-DBC-VRF-ICLI IN COLFRMC.
           IF DBC-IND-ICLI IN RMC-FLD > SPACES
              MOVE DBC-IND-ICLI IN RMC-FLD
                   TO SDF-DBC-IND-ICLI IN COLFRMC.
           IF DBC-GLS-ICLI IN RMC-FLD > SPACES
              MOVE DBC-GLS-ICLI IN RMC-FLD
                   TO SDF-DBC-GLS-ICLI IN COLFRMC.
           IF RMC-CAI-IRMC IN RMC-FLD > SPACES
              MOVE RMC-CAI-IRMC IN RMC-FLD
                   TO SDF-RMC-CAI-IRMC IN COLFRMC.
           IF RMC-IIC-IRMC-ALF IN RMC-FLD > SPACES
              MOVE RMC-IIC-IRMC-ALF IN RMC-FLD
                   TO SDF-RMC-IIC-IRMC IN COLFRMC.
           IF RMC-COD-TJCR IN RMC-FLD > SPACES
              MOVE RMC-COD-TJCR IN RMC-FLD
                   TO SDF-RMC-COD-TJCR IN COLFRMC.
           IF RMC-NUM-ORIG IN RMC-FLD > SPACES
              MOVE RMC-NUM-ORIG IN RMC-FLD
                   TO SDF-RMC-NUM-ORIG IN COLFRMC.
           IF RMC-COD-NPLZ IN RMC-FLD > SPACES
              MOVE RMC-COD-NPLZ IN RMC-FLD
                   TO SDF-RMC-COD-NPLZ IN COLFRMC.
           IF RMC-COD-ICCS IN RMC-FLD > SPACES
              MOVE RMC-COD-ICCS IN RMC-FLD
                   TO SDF-RMC-COD-ICCS IN COLFRMC.
           IF RMC-IND-EPOL IN RMC-FLD > SPACES
              MOVE RMC-IND-EPOL IN RMC-FLD
                   TO SDF-RMC-IND-EPOL IN COLFRMC.
           IF RMC-FEC-FREV IN RMC-FLD > SPACES
              MOVE RMC-FEC-FREV IN RMC-FLD
                   TO SDF-RMC-FEC-FREV IN COLFRMC.
       FIN-MOV-WI-F-RMC.
           EXIT.
      
       PRO-SGC-DBE SECTION.
       INI-PRO-SGC-DBE.
           MOVE "SGC" TO ICM-SIST.
           MOVE "DBE" TO ICM-FORM.
           MOVE "DBE" TO WSS-ENT-PPAL.
           MOVE WSS-REL-ENTI TO WSS-IND-REL.
           MOVE SPACES   TO DBE-FLD-EXT.
           MOVE WSS-ENTI TO DBE-FLD-EXT.
           PERFORM PRO-SGC-DBE-KEY-SCR.
           PERFORM PRO-SGC-DBE-KEY.
           MOVE  SGCFDBE   TO ENV-FRM-VARI.
           MOVE "SGCPADBE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES DBE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBE-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBE.
           PERFORM PRO-SGC-DBE-FLD-SCR.
           PERFORM PRO-SGC-DBE-FLD.
           MOVE  SGCFDBE   TO ENV-FRM-VARI.
           MOVE "SGCPADBE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS DBE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBE-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBE.
           PERFORM GRAB-REG-ING.
       FIN-PRO-SGC-DBE.
           EXIT.
      
       PRO-SGC-DBE-KEY-SCR SECTION.
       INI-PRO-SGC-DBE-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "SGCACTDBE" TO SCR-NEMO.
           MOVE "SGC" TO SCR-SIST.
           MOVE "SA02" TO SCR-NTRN.
           MOVE "SGCPADBE" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-SGC-DBE-KEY-SCR.
           EXIT.
      
       PRO-SGC-DBE-FLD-SCR SECTION.
       INI-PRO-SGC-DBE-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-SGC-DBE-FLD-SCR.
           EXIT.
      
      
       PRO-SGC-DBE-KEY SECTION.
       INI-PRO-SGC-DBE-KEY.
           MOVE SPACES TO SGCFDBE.
      *    IF   DBC-NUM-ICLI IN DBE-FLD-EXT > SPACES
           MOVE DBC-NUM-ICLI IN DBE-FLD-EXT
                TO SDF-DBC-NUM-ICLI IN SGCFDBE.
      *    IF   DBC-VRF-ICLI IN DBE-FLD-EXT > SPACES
           MOVE DBC-VRF-ICLI IN DBE-FLD-EXT
                TO SDF-DBC-VRF-ICLI IN SGCFDBE.
      *    IF   DBC-IND-ICLI IN DBE-FLD-EXT > SPACES
           MOVE DBC-IND-ICLI IN DBE-FLD-EXT
                TO SDF-DBC-IND-ICLI IN SGCFDBE.
      *    IF   DBC-GLS-ICLI IN DBE-FLD-EXT > SPACES
           MOVE DBC-GLS-ICLI IN DBE-FLD-EXT
                TO SDF-DBC-GLS-ICLI IN SGCFDBE.
       FIN-PRO-SGC-DBE-KEY.
           EXIT.
      
       PRO-SGC-DBE-FLD SECTION.
       INI-PRO-SGC-DBE-FLD.
           IF DBC-GLS-NOMC IN DBE-FLD-EXT > SPACES
              MOVE DBC-GLS-NOMC IN DBE-FLD-EXT
                   TO SDF-DBC-GLS-NOMC IN SGCFDBE.
           IF DCE-COD-TSOC IN DBE-FLD-EXT > SPACES
              MOVE DCE-COD-TSOC IN DBE-FLD-EXT
                   TO SDF-DCE-COD-TSOC IN SGCFDBE.
           IF DCE-GLS-NFAN IN DBE-FLD-EXT > SPACES
              MOVE DCE-GLS-NFAN IN DBE-FLD-EXT
                   TO SDF-DCE-GLS-NFAN IN SGCFDBE.
           IF RCD-GLS-DIRE IN DBE-FLD-EXT > SPACES
              MOVE RCD-GLS-DIRE IN DBE-FLD-EXT
                   TO SDF-RCD-GLS-DIRE IN SGCFDBE.
           IF RCD-COD-LUGA IN DBE-FLD-EXT > SPACES
              MOVE RCD-COD-LUGA IN DBE-FLD-EXT
                   TO SDF-RCD-COD-LUGA IN SGCFDBE.
           IF RCD-NUM-FONO IN DBE-FLD-EXT > SPACES
              MOVE RCD-NUM-FONO IN DBE-FLD-EXT
                   TO SDF-RCD-NUM-FONO IN SGCFDBE.
           IF RCD-NUM-ANXO IN DBE-FLD-EXT > SPACES
              MOVE RCD-NUM-ANXO IN DBE-FLD-EXT
                   TO SDF-RCD-NUM-ANXO IN SGCFDBE.
           IF DBC-NUM-DCOR IN DBE-FLD-EXT > SPACES
              MOVE DBC-NUM-DCOR IN DBE-FLD-EXT
                   TO SDF-DBC-NUM-DCOR IN SGCFDBE.
           IF DBC-COD-OFIC IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-OFIC IN DBE-FLD-EXT
                   TO SDF-DBC-COD-OFIC IN SGCFDBE.
           IF DBC-COD-TICL IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-TICL IN DBE-FLD-EXT
                   TO SDF-DBC-COD-TICL IN SGCFDBE.
           IF DBC-COD-EJEC IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-EJEC IN DBE-FLD-EXT
                   TO SDF-DBC-COD-EJEC IN SGCFDBE.
           IF DBC-COD-OTOF IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-OTOF IN DBE-FLD-EXT
                   TO SDF-DBC-COD-OTOF IN SGCFDBE.
           IF DBC-IND-TBCA IN DBE-FLD-EXT > SPACES
              MOVE DBC-IND-TBCA IN DBE-FLD-EXT
                   TO SDF-DBC-IND-TBCA IN SGCFDBE.
           IF DBC-COD-BLOC IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-BLOC IN DBE-FLD-EXT
                   TO SDF-DBC-COD-BLOC IN SGCFDBE.
           IF DBC-COD-ACTI IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-ACTI IN DBE-FLD-EXT
                   TO SDF-DBC-COD-ACTI IN SGCFDBE.
           IF DBC-COD-ACTS IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-ACTS IN DBE-FLD-EXT
                   TO SDF-DBC-COD-ACTS IN SGCFDBE.
           IF DCE-FEC-FCTT IN DBE-FLD-EXT > SPACES
              MOVE DCE-FEC-FCTT IN DBE-FLD-EXT
                   TO SDF-DCE-FEC-FCTT IN SGCFDBE.
           IF DCE-FEC-FCAD IN DBE-FLD-EXT > SPACES
              MOVE DCE-FEC-FCAD IN DBE-FLD-EXT
                   TO SDF-DCE-FEC-FCAD IN SGCFDBE.
           IF DBC-COD-INPP IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-INPP IN DBE-FLD-EXT
                   TO SDF-DBC-COD-INPP IN SGCFDBE.
           IF DCE-FEC-FUME IN DBE-FLD-EXT > SPACES
              MOVE DCE-FEC-FUME IN DBE-FLD-EXT
                   TO SDF-DCE-FEC-FUME IN SGCFDBE.
           IF DBC-COD-ODSE IN DBE-FLD-EXT > SPACES
              MOVE DBC-COD-ODSE IN DBE-FLD-EXT
                   TO SDF-DBC-COD-ODSE IN SGCFDBE.
           IF DCE-COD-CLSO IN DBE-FLD-EXT > SPACES
              MOVE DCE-COD-CLSO IN DBE-FLD-EXT
                   TO SDF-DCE-COD-CLSO IN SGCFDBE.
           IF DCE-IND-TEMP IN DBE-FLD-EXT > SPACES
              MOVE DCE-IND-TEMP IN DBE-FLD-EXT
                   TO SDF-DCE-IND-TEMP IN SGCFDBE.
           IF DCE-COD-TIEN IN DBE-FLD-EXT > SPACES
              MOVE DCE-COD-TIEN IN DBE-FLD-EXT
                   TO SDF-DCE-COD-TIEN IN SGCFDBE.
           IF DCE-IND-EXEN IN DBE-FLD-EXT > SPACES
              MOVE DCE-IND-EXEN IN DBE-FLD-EXT
                   TO SDF-DCE-IND-EXEN IN SGCFDBE.
           IF DBC-IND-RESI IN DBE-FLD-EXT > SPACES
              MOVE DBC-IND-RESI IN DBE-FLD-EXT
                   TO SDF-DBC-IND-RESI IN SGCFDBE.
           IF DCE-IND-AURR IN DBE-FLD-EXT > SPACES
              MOVE DCE-IND-AURR IN DBE-FLD-EXT
                   TO SDF-DCE-IND-AURR IN SGCFDBE.
           IF DBC-FEC-FINP IN DBE-FLD-EXT > SPACES
              MOVE DBC-FEC-FINP IN DBE-FLD-EXT
                   TO SDF-DBC-FEC-FINP IN SGCFDBE.
       FIN-PRO-SGC-DBE-FLD.
           EXIT.
      
      
       PRO-SGC-DBP SECTION.
       INI-PRO-SGC-DBP.
      *    DISPLAY "[[INI-PRO-SGC-DBP]]".
           MOVE "SGC" TO ICM-SIST.
           MOVE "DBP" TO ICM-FORM.
           MOVE "DBP" TO WSS-ENT-PPAL.
           MOVE WSS-REL-ENTI TO WSS-IND-REL.
           MOVE SPACES TO DBP-FLD-EXT.
           MOVE WSS-ENTI TO DBP-FLD-EXT.
           PERFORM PRO-SGC-DBP-KEY-SCR.
           PERFORM PRO-SGC-DBP-KEY.
           MOVE  SGCFDBP   TO ENV-FRM-VARI.
           MOVE "SGCPADBP" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS LLAVES DBP]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBP-FLD.
      *    DISPLAY "[[DBC-NUM-ICLI DBP-FLD]]" DBC-NUM-ICLI IN DBP-FLD.
      *    DISPLAY "[[DBC-IND-ICLI DBP-FLD]]" DBC-IND-ICLI IN DBP-FLD.
      *    DISPLAY "[[SCR-IERR:DBP KEY:]]" SCR-IERR.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBP.
           IF SCR-IERR = "I"
              PERFORM PRO-SGC-DBP-MOD
              GO TO FIN-PRO-SGC-DBP.
           PERFORM PRO-SGC-DBP-FLD-SCR.
           PERFORM PRO-SGC-DBP-FLD.
           MOVE  SGCFDBP   TO ENV-FRM-VARI.
           MOVE "SGCPADBP" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS CAMPOS DBP]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBP-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBP.
           PERFORM GRAB-REG-ING.
      *    DISPLAY "[[FIN-PRO-SGC-DBP]]".
       FIN-PRO-SGC-DBP.
           EXIT.
      
       PRO-SGC-DBP-KEY-SCR SECTION.
       INI-PRO-SGC-DBP-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "SGCACTDBP" TO SCR-NEMO.
           MOVE "SGC" TO SCR-SIST.
           MOVE "SA01" TO SCR-NTRN.
           MOVE "SGCPADBP" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-SGC-DBP-KEY-SCR.
           EXIT.
      
       PRO-SGC-DBP-FLD-SCR SECTION.
       INI-PRO-SGC-DBP-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-SGC-DBP-FLD-SCR.
           EXIT.
      
       PRO-SGC-DBP-KEY SECTION.
       INI-PRO-SGC-DBP-KEY.
           MOVE SPACES TO SGCFDBP.
           IF DBC-NUM-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN SGCFDBP.
           IF DBC-VRF-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN SGCFDBP.
           IF DBC-IND-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN SGCFDBP.
           IF DBC-GLS-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN SGCFDBP.
       FIN-PRO-SGC-DBP-KEY.
           EXIT.
      
       PRO-SGC-DBP-FLD SECTION.
       INI-PRO-SGC-DBP-FLD.
           IF DBC-GLS-APAT IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-APAT IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-APAT IN SGCFDBP.
           IF DBC-GLS-AMAT IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-AMAT IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-AMAT IN SGCFDBP.
           IF DBC-GLS-NOM1 IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-NOM1 IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-NOM1 IN SGCFDBP.
           IF DBC-GLS-NOM2 IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-NOM2 IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-NOM2 IN SGCFDBP.
           IF DCP-IND-CDAD IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-CDAD IN DBP-FLD-EXT
                   TO SDF-DCP-IND-CDAD IN SGCFDBP.
           IF DCP-FEC-EXPE IN DBP-FLD-EXT > SPACES
              MOVE DCP-FEC-EXPE IN DBP-FLD-EXT
                   TO SDF-DCP-FEC-EXPE IN SGCFDBP.
           IF RCD-GLS-DIRE IN DBP-FLD-EXT > SPACES
              MOVE RCD-GLS-DIRE IN DBP-FLD-EXT
                   TO SDF-RCD-GLS-DIRE IN SGCFDBP.
           IF RCD-COD-LUGA IN DBP-FLD-EXT > SPACES
              MOVE RCD-COD-LUGA IN DBP-FLD-EXT
                   TO SDF-RCD-COD-LUGA IN SGCFDBP.
           IF RCD-NUM-FONO IN DBP-FLD-EXT > SPACES
              MOVE RCD-NUM-FONO IN DBP-FLD-EXT
                   TO SDF-RCD-NUM-FONO IN SGCFDBP.
           IF RCD-NUM-ANXO IN DBP-FLD-EXT > SPACES
              MOVE RCD-NUM-ANXO IN DBP-FLD-EXT
                   TO SDF-RCD-NUM-ANXO IN SGCFDBP.
           IF DBC-NUM-DCOR IN DBP-FLD-EXT > SPACES
              MOVE DBC-NUM-DCOR IN DBP-FLD-EXT
                   TO SDF-DBC-NUM-DCOR IN SGCFDBP.
           IF DBC-COD-OFIC IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-OFIC IN DBP-FLD-EXT
                   TO SDF-DBC-COD-OFIC IN SGCFDBP.
           IF DBC-COD-TICL IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-TICL IN DBP-FLD-EXT
                   TO SDF-DBC-COD-TICL IN SGCFDBP.
           IF DBC-COD-EJEC IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-EJEC IN DBP-FLD-EXT
                   TO SDF-DBC-COD-EJEC IN SGCFDBP.
           IF DBC-COD-OTOF IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-OTOF IN DBP-FLD-EXT
                   TO SDF-DBC-IND-TBCA IN SGCFDBP.
           IF DBC-IND-TBCA IN DBP-FLD-EXT > SPACES
              MOVE DBC-IND-TBCA IN DBP-FLD-EXT
                   TO SDF-DBC-IND-TBCA IN SGCFDBP.
           IF DBC-COD-BLOC IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-BLOC IN DBP-FLD-EXT
                   TO SDF-DBC-COD-BLOC IN SGCFDBP.
           IF DBC-COD-ACTI IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-ACTI IN DBP-FLD-EXT
                   TO SDF-DBC-COD-ACTI IN SGCFDBP.
           IF DBC-COD-ACTS IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-ACTS IN DBP-FLD-EXT
                   TO SDF-DBC-COD-ACTS IN SGCFDBP.
           IF DCP-IND-SEXO IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-SEXO IN DBP-FLD-EXT
                   TO SDF-DCP-IND-SEXO IN SGCFDBP.
           IF DCP-FEC-FNAC IN DBP-FLD-EXT > SPACES
              MOVE DCP-FEC-FNAC IN DBP-FLD-EXT
                   TO SDF-DCP-FEC-FNAC IN SGCFDBP.
           IF DCP-IND-NEDU IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-NEDU IN DBP-FLD-EXT
                   TO SDF-DCP-IND-NEDU IN SGCFDBP.
           IF DCP-COD-PROF IN DBP-FLD-EXT > SPACES
              MOVE DCP-COD-PROF IN DBP-FLD-EXT
                   TO SDF-DCP-COD-PROF IN SGCFDBP.
           IF DCP-IND-SLAB IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-SLAB IN DBP-FLD-EXT
                   TO SDF-DCP-IND-SLAB IN SGCFDBP.
           IF DCP-COD-PNAC IN DBP-FLD-EXT > SPACES
              MOVE DCP-COD-PNAC IN DBP-FLD-EXT
                   TO SDF-DCP-COD-PNAC IN SGCFDBP.
           IF DCP-IND-ECIV IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-ECIV IN DBP-FLD-EXT
                   TO SDF-DCP-IND-ECIV IN SGCFDBP.
           IF DCP-COD-CSEC IN DBP-FLD-EXT > SPACES
              MOVE DCP-COD-CSEC IN DBP-FLD-EXT
                   TO SDF-DCP-COD-CSEC IN SGCFDBP.
           IF DCP-IND-CASA IN DBP-FLD-EXT > SPACES
              MOVE DCP-IND-CASA IN DBP-FLD-EXT
                   TO SDF-DCP-IND-CASA IN SGCFDBP.
           IF DBC-IND-RESI IN DBP-FLD-EXT > SPACES
              MOVE DBC-IND-RESI IN DBP-FLD-EXT
                   TO SDF-DBC-IND-RESI IN SGCFDBP.
           IF DBC-COD-INPP IN DBP-FLD-EXT > SPACES
              MOVE DBC-COD-INPP IN DBP-FLD-EXT
                   TO SDF-DBC-COD-INPP IN SGCFDBP.
           DISPLAY "[[DBC-FEC-FINP DBP-FLD]]" DBC-FEC-FINP IN DBP-FLD.
           IF DBC-FEC-FINP IN DBP-FLD NOT > ZEROES
              IF DBC-FEC-FINP IN DBP-FLD-EXT > SPACES
                 MOVE DBC-FEC-FINP IN DBP-FLD-EXT
                      TO SDF-DBC-FEC-FINP IN SGCFDBP.
       FIN-PRO-SGC-DBP-FLD.
           EXIT.
      
      
       PRO-SGC-DBP-MOD SECTION.
       INI-PRO-SGC-DBP-MOD.
           MOVE "SGC" TO ICM-SIST.
           MOVE "DBP" TO ICM-FORM.
           PERFORM PRO-SGC-DBP-MOD-KEY-SCR.
           PERFORM PRO-SGC-DBP-MOD-KEY.
           MOVE  SGCFDBP   TO ENV-FRM-VARI.
           MOVE "SGCPADBP" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS LLAVES DBP:MOD]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBP-FLD.
      *    DISPLAY "[[DBP:MOD SCR-IERR:]]" SCR-IERR.
           IF SCR-IERR = "S" OR SCR-IERR = "I"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBP-MOD.
           PERFORM PRO-SGC-DBP-MOD-FLD-SCR.
           PERFORM MOV-WI-F-DBP-MOD.
           PERFORM PRO-SGC-DBP-FLD.
           MOVE  SGCFDBP   TO ENV-FRM-VARI.
           MOVE "SGCPADBP" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS CAMPOS DBP:MOD]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DBP-FLD.
           IF SCR-IERR = "S" OR SCR-IERR = "I"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DBP-MOD.
           DISPLAY "[MENSAJE MOD DBP:]".
           DISPLAY SCR-TRL-GLS-MENS.
           PERFORM GRAB-REG-ING.
       FIN-PRO-SGC-DBP-MOD.
           EXIT.
      
       PRO-SGC-DBP-MOD-KEY-SCR SECTION.
       INI-PRO-SGC-DBP-MOD-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "SGCACTDBP" TO SCR-NEMO.
           MOVE "SGC" TO SCR-SIST.
           MOVE "SA01" TO SCR-NTRN.
           MOVE "SGCPADBP" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "MOD" TO SCR-CMND.
           MOVE "MOD" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-SGC-DBP-MOD-KEY-SCR.
           EXIT.
      
       PRO-SGC-DBP-MOD-FLD-SCR SECTION.
       INI-PRO-SGC-DBP-MOD-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-SGC-DBP-MOD-FLD-SCR.
           EXIT.
      
       PRO-SGC-DBP-MOD-KEY SECTION.
       INI-PRO-SGC-DBP-MOD-KEY.
           MOVE SPACES TO SGCFDBP.
           IF DBC-NUM-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN SGCFDBP.
           IF DBC-VRF-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN SGCFDBP.
           IF DBC-IND-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN SGCFDBP.
           IF DBC-GLS-ICLI IN DBP-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN DBP-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN SGCFDBP.
       FIN-PRO-SGC-DBP-MOD-KEY.
           EXIT.
      
       MOV-WI-F-DBP-MOD SECTION.
       INI-MOV-WI-F-DBP-MOD.
           IF DBC-GLS-APAT IN DBP-FLD > SPACES
              MOVE DBC-GLS-APAT IN DBP-FLD
                   TO SDF-DBC-GLS-APAT IN SGCFDBP.
           IF DBC-GLS-AMAT IN DBP-FLD > SPACES
              MOVE DBC-GLS-AMAT IN DBP-FLD
                   TO SDF-DBC-GLS-AMAT IN SGCFDBP.
           IF DBC-GLS-NOM1 IN DBP-FLD > SPACES
              MOVE DBC-GLS-NOM1 IN DBP-FLD
                   TO SDF-DBC-GLS-NOM1 IN SGCFDBP.
           IF DBC-GLS-NOM2 IN DBP-FLD > SPACES
              MOVE DBC-GLS-NOM2 IN DBP-FLD
                   TO SDF-DBC-GLS-NOM2 IN SGCFDBP.
           IF DCP-IND-CDAD IN DBP-FLD > SPACES
              MOVE DCP-IND-CDAD IN DBP-FLD
                   TO SDF-DCP-IND-CDAD IN SGCFDBP.
           IF DCP-FEC-EXPE IN DBP-FLD > SPACES
              MOVE DCP-FEC-EXPE IN DBP-FLD
                   TO SDF-DCP-FEC-EXPE IN SGCFDBP.
           IF RCD-GLS-DIRE IN DBP-FLD > SPACES
              MOVE RCD-GLS-DIRE IN DBP-FLD
                   TO SDF-RCD-GLS-DIRE IN SGCFDBP.
           IF DBC-NUM-TDIR-ALF IN DBP-FLD > SPACES
              MOVE DBC-NUM-TDIR-ALF IN DBP-FLD
                   TO SDF-DBC-NUM-TDIR IN SGCFDBP.
           IF RCD-COD-LUGA IN DBP-FLD > SPACES
              MOVE RCD-COD-LUGA IN DBP-FLD
                   TO SDF-RCD-COD-LUGA IN SGCFDBP.
           IF RCD-NUM-FONO IN DBP-FLD > SPACES
              MOVE RCD-NUM-FONO IN DBP-FLD
                   TO SDF-RCD-NUM-FONO IN SGCFDBP.
           IF RCD-NUM-ANXO IN DBP-FLD > SPACES
              MOVE RCD-NUM-ANXO IN DBP-FLD
                   TO SDF-RCD-NUM-ANXO IN SGCFDBP.
           IF DBC-NUM-DCOR IN DBP-FLD > SPACES
              MOVE DBC-NUM-DCOR IN DBP-FLD
                   TO SDF-DBC-NUM-DCOR IN SGCFDBP.
           IF DBC-COD-OFIC IN DBP-FLD > SPACES
              MOVE DBC-COD-OFIC IN DBP-FLD
                   TO SDF-DBC-COD-OFIC IN SGCFDBP.
           IF DBC-COD-TICL IN DBP-FLD > SPACES
              MOVE DBC-COD-TICL IN DBP-FLD
                   TO SDF-DBC-COD-TICL IN SGCFDBP.
           IF DBC-COD-EJEC IN DBP-FLD > SPACES
              MOVE DBC-COD-EJEC IN DBP-FLD
                   TO SDF-DBC-COD-EJEC IN SGCFDBP.
           IF DBC-COD-OTOF IN DBP-FLD > SPACES
              MOVE DBC-COD-OTOF IN DBP-FLD
                   TO SDF-DBC-IND-TBCA IN SGCFDBP.
           IF DBC-IND-TBCA IN DBP-FLD > SPACES
              MOVE DBC-IND-TBCA IN DBP-FLD
                   TO SDF-DBC-IND-TBCA IN SGCFDBP.
           IF DBC-COD-BLOC IN DBP-FLD > SPACES
              MOVE DBC-COD-BLOC IN DBP-FLD
                   TO SDF-DBC-COD-BLOC IN SGCFDBP.
           IF DBC-COD-ACTI IN DBP-FLD > SPACES
              MOVE DBC-COD-ACTI IN DBP-FLD
                   TO SDF-DBC-COD-ACTI IN SGCFDBP.
           IF DBC-COD-ACTS IN DBP-FLD > SPACES
              MOVE DBC-COD-ACTS IN DBP-FLD
                   TO SDF-DBC-COD-ACTS IN SGCFDBP.
           IF DCP-IND-SEXO IN DBP-FLD > SPACES
              MOVE DCP-IND-SEXO IN DBP-FLD
                   TO SDF-DCP-IND-SEXO IN SGCFDBP.
           IF DCP-FEC-FNAC IN DBP-FLD > SPACES
              MOVE DCP-FEC-FNAC IN DBP-FLD
                   TO SDF-DCP-FEC-FNAC IN SGCFDBP.
           IF DCP-IND-NEDU IN DBP-FLD > SPACES
              MOVE DCP-IND-NEDU IN DBP-FLD
                   TO SDF-DCP-IND-NEDU IN SGCFDBP.
           IF DCP-COD-PROF IN DBP-FLD > SPACES
              MOVE DCP-COD-PROF IN DBP-FLD
                   TO SDF-DCP-COD-PROF IN SGCFDBP.
           IF DCP-IND-SLAB IN DBP-FLD > SPACES
              MOVE DCP-IND-SLAB IN DBP-FLD
                   TO SDF-DCP-IND-SLAB IN SGCFDBP.
           IF DCP-COD-PNAC IN DBP-FLD > SPACES
              MOVE DCP-COD-PNAC IN DBP-FLD
                   TO SDF-DCP-COD-PNAC IN SGCFDBP.
           IF DCP-IND-ECIV IN DBP-FLD > SPACES
              MOVE DCP-IND-ECIV IN DBP-FLD
                   TO SDF-DCP-IND-ECIV IN SGCFDBP.
           IF DCP-COD-CSEC IN DBP-FLD > SPACES
              MOVE DCP-COD-CSEC IN DBP-FLD
                   TO SDF-DCP-COD-CSEC IN SGCFDBP.
           IF DCP-IND-CASA IN DBP-FLD > SPACES
              MOVE DCP-IND-CASA IN DBP-FLD
                   TO SDF-DCP-IND-CASA IN SGCFDBP.
           IF DBC-IND-RESI IN DBP-FLD > SPACES
              MOVE DBC-IND-RESI IN DBP-FLD
                   TO SDF-DBC-IND-RESI IN SGCFDBP.
           IF DBC-COD-INPP IN DBP-FLD > SPACES
              MOVE DBC-COD-INPP IN DBP-FLD
                   TO SDF-DBC-COD-INPP IN SGCFDBP.
           IF DBC-FEC-FINP IN DBP-FLD > SPACES
              MOVE DBC-FEC-FINP IN DBP-FLD
                   TO SDF-DBC-FEC-FINP IN SGCFDBP.
           IF DBC-FEC-FTRN IN DBP-FLD > SPACES
              MOVE DBC-FEC-FTRN IN DBP-FLD
                   TO SDF-DBC-FEC-FTRN IN SGCFDBP.
       FIN-MOV-WI-F-DBP-MOD.
           EXIT.
      
       PRO-SGC-OPE SECTION.
       INI-PRO-SGC-OPE.
           MOVE "SGC" TO ICM-SIST.
           MOVE "OPE" TO ICM-FORM.
           MOVE "OPE" TO WSS-ENT-PPAL.
           MOVE SPACES TO OPE-FLD-EXT.
           MOVE WSS-ENTI TO OPE-FLD-EXT.
           PERFORM PRO-SGC-OPE-KEY-SCR.
           PERFORM PRO-SGC-OPE-KEY.
           MOVE  SGCFOPE   TO ENV-FRM-VARI.
           MOVE "SGCPAOPE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS LLAVES OPE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPE-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-OPE.
           PERFORM PRO-SGC-OPE-FLD-SCR.
           PERFORM MOV-WI-F-OPE.
           PERFORM PRO-SGC-OPE-FLD.
           MOVE  SGCFOPE   TO ENV-FRM-VARI.
           MOVE "SGCPAOPE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS CAMPOS OPE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO OPE-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-OPE.
           PERFORM GRAB-REG-ING.
       FIN-PRO-SGC-OPE.
           EXIT.
      
       PRO-SGC-OPE-KEY-SCR SECTION.
       INI-PRO-SGC-OPE-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "SGCACTOPE" TO SCR-NEMO.
           MOVE "SGC" TO SCR-SIST.
           MOVE "SA24" TO SCR-NTRN.
           MOVE "SGCPAOPE" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-SGC-OPE-KEY-SCR.
           EXIT.
      
       PRO-SGC-OPE-FLD-SCR SECTION.
       INI-PRO-SGC-OPE-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-SGC-OPE-FLD-SCR.
           EXIT.
      
       PRO-SGC-OPE-KEY SECTION.
       INI-PRO-SGC-OPE-KEY.
           MOVE SPACES TO SGCFOPE.
           IF OPE-CAI-IOPE IN OPE-FLD-EXT > SPACES
              MOVE OPE-CAI-IOPE IN OPE-FLD-EXT
                   TO SDF-OPE-CAI-IOPE IN SGCFOPE.
           IF OPE-IIC-IOPE IN OPE-FLD-EXT > ZEROES
              MOVE OPE-IIC-IOPE IN OPE-FLD-EXT
                   TO SDF-OPE-IIC-IOPE IN SGCFOPE.
       FIN-PRO-SGC-OPE-KEY.
           EXIT.
      
       PRO-SGC-OPE-FLD SECTION.
       INI-PRO-SGC-OPE-FLD.
           IF OPE-COD-TOPR IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-TOPR IN OPE-FLD-EXT
                   TO SDF-OPE-COD-TOPR IN SGCFOPE.
           IF OPE-COD-OFOP IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-OFOP IN OPE-FLD-EXT
                   TO SDF-OPE-COD-OFOP IN SGCFOPE.
           IF DBC-NUM-ICLI IN OPE-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN OPE-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN SGCFOPE.
           IF DBC-VRF-ICLI IN OPE-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN OPE-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN SGCFOPE.
           IF DBC-IND-ICLI IN OPE-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN OPE-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN SGCFOPE.
           IF DBC-GLS-ICLI IN OPE-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN OPE-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN SGCFOPE.
           IF RCO-NUM-DIRE IN OPE-FLD-EXT > ZEROES
              MOVE RCO-NUM-DIRE IN OPE-FLD-EXT
                   TO SDF-RCO-NUM-DIRE IN SGCFOPE.
           IF OPE-COD-EJOP IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-EJOP IN OPE-FLD-EXT
                   TO SDF-OPE-COD-EJOP IN SGCFOPE.
           IF OPE-IND-MCLI IN OPE-FLD-EXT > SPACES
              MOVE OPE-IND-MCLI IN OPE-FLD-EXT
                   TO SDF-OPE-IND-MCLI IN SGCFOPE.
           IF OPE-COD-VCOP IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-VCOP IN OPE-FLD-EXT
                   TO SDF-OPE-COD-VCOP IN SGCFOPE.
           IF OPE-COD-AOPR IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-AOPR IN OPE-FLD-EXT
                   TO SDF-OPE-COD-AOPR IN SGCFOPE.
           IF OPE-VAL-MNTO IN OPE-FLD-EXT > ZEROES
              MOVE OPE-VAL-MNTO IN OPE-FLD-EXT
                   TO SDF-OPE-VAL-MNTO IN SGCFOPE.
           IF OPE-FEC-FIOP IN OPE-FLD-EXT > SPACES
              MOVE OPE-FEC-FIOP IN OPE-FLD-EXT
                   TO SDF-OPE-FEC-FIOP IN SGCFOPE.
           IF OPE-COD-STAT IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-STAT IN OPE-FLD-EXT
                   TO SDF-OPE-COD-STAT IN SGCFOPE.
           IF OPE-FEC-FTOP IN OPE-FLD-EXT > SPACES
              MOVE OPE-FEC-FTOP IN OPE-FLD-EXT
                   TO SDF-OPE-FEC-FTOP IN SGCFOPE.
           IF OPE-COD-MOTT IN OPE-FLD-EXT > SPACES
              MOVE OPE-COD-MOTT IN OPE-FLD-EXT
                   TO SDF-OPE-COD-MOTT IN SGCFOPE.
           IF OPE-FEC-FROP IN OPE-FLD-EXT > SPACES
              MOVE OPE-FEC-FROP IN OPE-FLD-EXT
                   TO SDF-OPE-FEC-FROP IN SGCFOPE.
       FIN-PRO-SGC-OPE-FLD.
           EXIT.
      
       MOV-WI-F-OPE SECTION.
       INI-MOV-WI-F-OPE.
           IF OPE-COD-TOPR IN OPE-FLD > SPACES
              MOVE OPE-COD-TOPR IN OPE-FLD
                   TO SDF-OPE-COD-TOPR IN SGCFOPE.
           IF OPE-COD-OFOP IN OPE-FLD > SPACES
              MOVE OPE-COD-OFOP IN OPE-FLD
                   TO SDF-OPE-COD-OFOP IN SGCFOPE.
           IF DBC-NUM-ICLI IN OPE-FLD > ZEROES
              MOVE DBC-NUM-ICLI IN OPE-FLD
                   TO SDF-DBC-NUM-ICLI IN SGCFOPE.
           IF DBC-VRF-ICLI IN OPE-FLD > SPACES
              MOVE DBC-VRF-ICLI IN OPE-FLD
                   TO SDF-DBC-VRF-ICLI IN SGCFOPE.
           IF DBC-IND-ICLI IN OPE-FLD > SPACES
              MOVE DBC-IND-ICLI IN OPE-FLD
                   TO SDF-DBC-IND-ICLI IN SGCFOPE.
           IF DBC-GLS-ICLI IN OPE-FLD > SPACES
              MOVE DBC-GLS-ICLI IN OPE-FLD
                   TO SDF-DBC-GLS-ICLI IN SGCFOPE.
           IF RCO-NUM-DIRE IN OPE-FLD > ZEROES
              MOVE RCO-NUM-DIRE IN OPE-FLD
                   TO SDF-RCO-NUM-DIRE IN SGCFOPE.
           IF OPE-COD-EJOP IN OPE-FLD > SPACES
              MOVE OPE-COD-EJOP IN OPE-FLD
                   TO SDF-OPE-COD-EJOP IN SGCFOPE.
           IF OPE-IND-MCLI IN OPE-FLD > SPACES
              MOVE OPE-IND-MCLI IN OPE-FLD
                   TO SDF-OPE-IND-MCLI IN SGCFOPE.
           IF OPE-COD-VCOP IN OPE-FLD > SPACES
              MOVE OPE-COD-VCOP IN OPE-FLD
                   TO SDF-OPE-COD-VCOP IN SGCFOPE.
           IF OPE-COD-AOPR IN OPE-FLD > SPACES
              MOVE OPE-COD-AOPR IN OPE-FLD
                   TO SDF-OPE-COD-AOPR IN SGCFOPE.
           IF OPE-VAL-MNTO IN OPE-FLD > ZEROES
              MOVE OPE-VAL-MNTO IN OPE-FLD
                   TO SDF-OPE-VAL-MNTO IN SGCFOPE.
           IF OPE-FEC-FIOP IN OPE-FLD > SPACES
              MOVE OPE-FEC-FIOP IN OPE-FLD
                   TO SDF-OPE-FEC-FIOP IN SGCFOPE.
           IF OPE-COD-STAT IN OPE-FLD > SPACES
              MOVE OPE-COD-STAT IN OPE-FLD
                   TO SDF-OPE-COD-STAT IN SGCFOPE.
           IF OPE-FEC-FTOP IN OPE-FLD > SPACES
              MOVE OPE-FEC-FTOP IN OPE-FLD
                   TO SDF-OPE-FEC-FTOP IN SGCFOPE.
           IF OPE-COD-MOTT IN OPE-FLD > SPACES
              MOVE OPE-COD-MOTT IN OPE-FLD
                   TO SDF-OPE-COD-MOTT IN SGCFOPE.
           IF OPE-FEC-FROP IN OPE-FLD > SPACES
              MOVE OPE-FEC-FROP IN OPE-FLD
                   TO SDF-OPE-FEC-FROP IN SGCFOPE.
       FIN-MOV-WI-F-OPE.
           EXIT.
      
       PRO-SGC-DIR SECTION.
       INI-PRO-SGC-DIR.
           MOVE "SGC" TO ICM-SIST.
           MOVE "DIR" TO ICM-FORM.
           MOVE "DIR" TO WSS-ENT-PPAL.
           MOVE SPACES TO DIR-FLD-EXT.
           MOVE WSS-ENTI TO DIR-FLD-EXT.
           PERFORM PRO-SGC-DIR-KEY-SCR.
           PERFORM PRO-SGC-DIR-KEY.
           MOVE  SGCFDIR   TO ENV-FRM-VARI.
           MOVE "SGCPADIR" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS LLAVES DIR]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DIR-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DIR.
           PERFORM PRO-SGC-DIR-FLD-SCR.
           PERFORM MOV-WI-F-DIR.
           PERFORM PRO-SGC-DIR-FLD.
           MOVE  SGCFDIR   TO ENV-FRM-VARI.
           MOVE "SGCPADIR" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIAS CAMPOS DIR]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO DIR-FLD.
           IF SCR-IERR = "S"
              PERFORM INF-ERR
              GO TO FIN-PRO-SGC-DIR.
           PERFORM GRAB-REG-ING.
       FIN-PRO-SGC-DIR.
           EXIT.
      
       PRO-SGC-DIR-KEY-SCR SECTION.
       INI-PRO-SGC-DIR-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "SGCACTDIR" TO SCR-NEMO.
           MOVE "SGC" TO SCR-SIST.
           MOVE "SA06" TO SCR-NTRN.
           MOVE "SGCPADIR" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-SGC-DIR-KEY-SCR.
           EXIT.
      
       PRO-SGC-DIR-FLD-SCR SECTION.
       INI-PRO-SGC-DIR-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-SGC-DIR-FLD-SCR.
           EXIT.
      
       PRO-SGC-DIR-KEY SECTION.
       INI-PRO-SGC-DIR-KEY.
           MOVE SPACES TO SGCFDIR.
           IF DBC-NUM-ICLI IN DIR-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN DIR-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN SGCFDIR.
           IF DBC-VRF-ICLI IN DIR-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN DIR-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN SGCFDIR.
           IF DBC-IND-ICLI IN DIR-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN DIR-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN SGCFDIR.
           IF DBC-GLS-ICLI IN DIR-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN DIR-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN SGCFDIR.
       FIN-PRO-SGC-DIR-KEY.
           EXIT.
      
       PRO-SGC-DIR-FLD SECTION.
       INI-PRO-SGC-DIR-FLD.
           IF RCD-NUM-DIRE IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-DIRE IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-DIRE IN SGCFDIR.
           IF RCD-MSC-TDIR IN DIR-FLD-EXT > SPACES
              MOVE RCD-MSC-TDIR IN DIR-FLD-EXT
                   TO SDF-RCD-MSC-TDIR IN SGCFDIR.
           IF RCD-GLS-DIRE IN DIR-FLD-EXT > SPACES
              MOVE RCD-GLS-DIRE IN DIR-FLD-EXT
                   TO SDF-RCD-GLS-DIRE IN SGCFDIR.
           IF RCD-NUM-FONO IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-FONO IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-FONO IN SGCFDIR.
           IF RCD-NUM-ANXO IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-ANXO IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-ANXO IN SGCFDIR.
           IF RCD-NUM-NFAX IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-NFAX IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-NFAX IN SGCFDIR.
           IF RCD-NUM-FON2 IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-FON2 IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-FON2 IN SGCFDIR.
           IF RCD-NUM-ANX2 IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-ANX2 IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-ANX2 IN SGCFDIR.
           IF RCD-NUM-BIPP IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-BIPP IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-BIPP IN SGCFDIR.
           IF RCD-COD-BIPP IN DIR-FLD-EXT > SPACES
              MOVE RCD-COD-BIPP IN DIR-FLD-EXT
                   TO SDF-RCD-COD-BIPP IN SGCFDIR.
           IF RCD-NUM-NCEL IN DIR-FLD-EXT > SPACES
              MOVE RCD-NUM-NCEL IN DIR-FLD-EXT
                   TO SDF-RCD-NUM-NCEL IN SGCFDIR.
           IF RCD-COD-LUGA IN DIR-FLD-EXT > SPACES
              MOVE RCD-COD-LUGA IN DIR-FLD-EXT
                   TO SDF-RCD-COD-LUGA IN SGCFDIR.
           IF RCD-MSC-SDIR IN DIR-FLD-EXT > SPACES
              MOVE RCD-MSC-SDIR IN DIR-FLD-EXT
                   TO SDF-RCD-MSC-SDIR IN SGCFDIR.
           IF RCD-FEC-FVRF IN DIR-FLD-EXT > SPACES
              MOVE RCD-FEC-FVRF IN DIR-FLD-EXT
                   TO SDF-RCD-FEC-FVRF IN SGCFDIR.
       FIN-PRO-SGC-DIR-FLD.
           EXIT.
      
       MOV-WI-F-DIR SECTION.
       INI-MOV-WI-F-DIR.
           IF DBC-NUM-ICLI-ALF IN DIR-FLD > SPACES
              MOVE DBC-NUM-ICLI-ALF IN DIR-FLD
                   TO SDF-DBC-NUM-ICLI IN SGCFDIR.
           IF DBC-VRF-ICLI IN DIR-FLD > SPACES
              MOVE DBC-VRF-ICLI IN DIR-FLD
                   TO SDF-DBC-VRF-ICLI IN SGCFDIR.
           IF DBC-IND-ICLI IN DIR-FLD > SPACES
              MOVE DBC-IND-ICLI IN DIR-FLD
                   TO SDF-DBC-IND-ICLI IN SGCFDIR.
           IF DBC-GLS-ICLI IN DIR-FLD > SPACES
              MOVE DBC-GLS-ICLI IN DIR-FLD
                   TO SDF-DBC-GLS-ICLI IN SGCFDIR.
           IF RCD-NUM-DIRE-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-DIRE-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-DIRE IN SGCFDIR.
           IF RCD-MSC-TDIR IN DIR-FLD > SPACES
              MOVE RCD-MSC-TDIR IN DIR-FLD
                   TO SDF-RCD-MSC-TDIR IN SGCFDIR.
           IF DBC-NUM-TDIR-ALF IN DIR-FLD > SPACES
              MOVE DBC-NUM-TDIR-ALF IN DIR-FLD
                   TO SDF-DBC-NUM-TDIR IN SGCFDIR.
           IF RCD-GLS-DIRE IN DIR-FLD > SPACES
              MOVE RCD-GLS-DIRE IN DIR-FLD
                   TO SDF-RCD-GLS-DIRE IN SGCFDIR.
           IF RCD-NUM-FONO-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-FONO-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-FONO IN SGCFDIR.
           IF RCD-NUM-ANXO-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-ANXO-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-ANXO IN SGCFDIR.
           IF RCD-NUM-NFAX-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-NFAX-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-NFAX IN SGCFDIR.
           IF RCD-NUM-FON2-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-FON2-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-FON2 IN SGCFDIR.
           IF RCD-NUM-ANX2-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-ANX2-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-ANX2 IN SGCFDIR.
           IF RCD-NUM-BIPP-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-BIPP-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-BIPP IN SGCFDIR.
           IF RCD-COD-BIPP-ALF IN DIR-FLD > SPACES
              MOVE RCD-COD-BIPP-ALF IN DIR-FLD
                   TO SDF-RCD-COD-BIPP IN SGCFDIR.
           IF RCD-NUM-NCEL-ALF IN DIR-FLD > SPACES
              MOVE RCD-NUM-NCEL-ALF IN DIR-FLD
                   TO SDF-RCD-NUM-NCEL IN SGCFDIR.
           IF RCD-COD-LUGA IN DIR-FLD > SPACES
              MOVE RCD-COD-LUGA IN DIR-FLD
                   TO SDF-RCD-COD-LUGA IN SGCFDIR.
           IF RCD-MSC-SDIR IN DIR-FLD > SPACES
              MOVE RCD-MSC-SDIR IN DIR-FLD
                   TO SDF-RCD-MSC-SDIR IN SGCFDIR.
           IF RCD-FEC-FVRF IN DIR-FLD > SPACES
              MOVE RCD-FEC-FVRF IN DIR-FLD
                   TO SDF-RCD-FEC-FVRF IN SGCFDIR.
       FIN-MOV-WI-F-DIR.
           EXIT.
      
      
       CHK-AGA-GDG SECTION.
       INI-CHK-AGA-GDG.
      *    DISPLAY "@EN INI CHK-AGA-GDG@".
      *    DISPLAY "@WSS-NUM-GAR@" WSS-NUM-GAR.
      *    DISPLAY "@WSS-ERR-GDG@" WSS-ERR-GDG.
           IF WSS-NUM-GAR > SPACES AND WSS-ERR-GDG = "N"
      *           DISPLAY "@ ACTIVANDO GDG @"
                  PERFORM PRO-GAR-AGA.
           MOVE SPACES TO WSS-NUM-GAR.
      *    MOVE SPACES TO WSS-ENT-PPAL.
       FIN-CHK-AGA-GDG.
           EXIT.
      
       PRO-GAR-AGA SECTION.
       INI-PRO-GAR-AGA.
           MOVE "AGA" TO WSS-IND-CMND.
           MOVE "GAR" TO ICM-SIST.
           MOVE "GDG" TO ICM-FORM.
           PERFORM PRO-GAR-AGA-KEY-SCR.
           PERFORM PRO-GAR-AGA-KEY.
           MOVE  GARFGDG   TO ENV-FRM-VARI.
           MOVE "GARPAGDG" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES AGA-GDG]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDG-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-AGA
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-GAR-AGA.
           PERFORM PRO-GAR-AGA-FLD-SCR.
           PERFORM MOV-WI-F-AGA.
           MOVE  GARFGDG   TO ENV-FRM-VARI.
           MOVE "GARPAGDG" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS AGA-GDG]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDG-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR-ACT
              GO TO FIN-PRO-GAR-AGA.
           DISPLAY "[MENSAJE AGA-GDG:]".
           DISPLAY SCR-TRL-GLS-MENS.
       FIN-PRO-GAR-AGA.
           EXIT.
      
       PRO-GAR-AGA-KEY-SCR SECTION.
       INI-PRO-GAR-AGA-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GARACTGDG" TO SCR-NEMO.
           MOVE "GAR" TO SCR-SIST.
           MOVE "GC03" TO SCR-NTRN.
           MOVE "GARPAGDG" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "AGA" TO SCR-CMND.
           MOVE "ACC" TO SCR-CCPP.
           MOVE "A"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
      FIN-PRO-GAR-AGA-KEY-SCR.
           EXIT.
      
       PRO-GAR-AGA-FLD-SCR SECTION.
       INI-PRO-GAR-AGA-FLD-SCR.
           MOVE "GCS" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-GAR-AGA-FLD-SCR.
           EXIT.
      
       PRO-GAR-AGA-KEY SECTION.
       INI-PRO-GAR-AGA-KEY.
           MOVE SPACES TO GARFGDG.
           MOVE WSS-NUM-SIS TO SDF-GDG-NUM-SIS.
           MOVE WSS-COD-CRR TO SDF-GDG-COD-CRR.
       FIN-PRO-GAR-AGA-KEY.
           EXIT.
      
       MOV-WI-F-AGA SECTION.
       INI-MOV-WI-F-AGA.
           IF GDG-TIP-OPE IN GDG-FLD > SPACES
              MOVE GDG-TIP-OPE IN GDG-FLD
                   TO SDF-GDG-TIP-OPE IN GARFGDG.
           IF GDG-STP-OPE IN GDG-FLD > SPACES
              MOVE GDG-STP-OPE IN GDG-FLD
                   TO SDF-GDG-STP-OPE IN GARFGDG.
           IF GDG-NUM-SIS IN GDG-FLD > SPACES
              MOVE GDG-NUM-SIS IN GDG-FLD
                   TO SDF-GDG-NUM-SIS IN GARFGDG.
           IF GDG-COD-CRR IN GDG-FLD > SPACES
              MOVE GDG-COD-CRR IN GDG-FLD
                   TO SDF-GDG-COD-CRR IN GARFGDG.
           IF DBC-NUM-ICLI IN GDG-FLD > SPACES
              MOVE DBC-NUM-ICLI IN GDG-FLD
                   TO SDF-DBC-NUM-ICLI IN GARFGDG.
           IF DBC-VRF-ICLI IN GDG-FLD > SPACES
              MOVE DBC-VRF-ICLI IN GDG-FLD
                   TO SDF-DBC-VRF-ICLI IN GARFGDG.
           IF DBC-IND-ICLI IN GDG-FLD > SPACES
              MOVE DBC-IND-ICLI IN GDG-FLD
                   TO SDF-DBC-IND-ICLI IN GARFGDG.
           IF DBC-GLS-ICLI IN GDG-FLD > SPACES
              MOVE DBC-GLS-ICLI IN GDG-FLD
                   TO SDF-DBC-GLS-ICLI IN GARFGDG.
           IF FRM-IIC-IOPD IN GDG-FLD > SPACES
              MOVE FRM-IIC-IOPD IN GDG-FLD
                   TO SDF-FRM-IIC-IOPD IN GARFGDG.
           IF GDG-COD-OFI IN GDG-FLD > SPACES
              MOVE GDG-COD-OFI IN GDG-FLD
                   TO SDF-GDG-COD-OFI IN GARFGDG.
           IF GDG-VCB IN GDG-FLD > SPACES
              MOVE GDG-VCB IN GDG-FLD
                   TO SDF-GDG-VCB IN GARFGDG.
           IF GDG-DES-1 IN GDG-FLD > SPACES
              MOVE GDG-DES-1 IN GDG-FLD
                   TO SDF-GDG-DES-1 IN GARFGDG.
           IF GDG-DES-2 IN GDG-FLD > SPACES
              MOVE GDG-DES-2 IN GDG-FLD
                   TO SDF-GDG-DES-2 IN GARFGDG.
           IF GDG-COD-LIM IN GDG-FLD > SPACES
              MOVE GDG-COD-LIM IN GDG-FLD
                   TO SDF-GDG-COD-LIM IN GARFGDG.
           IF GDG-COD-EJE-ORI IN GDG-FLD > SPACES
              MOVE GDG-COD-EJE-ORI IN GDG-FLD
                   TO SDF-GDG-COD-EJE-ORI IN GARFGDG.
           IF GDG-COD-GRA IN GDG-FLD > SPACES
              MOVE GDG-COD-GRA IN GDG-FLD
                   TO SDF-GDG-COD-GRA IN GARFGDG.
           IF GDG-ES1 IN GDG-FLD > SPACES
              MOVE GDG-ES1 IN GDG-FLD
                   TO SDF-GDG-ES1 IN GARFGDG.
           IF GDG-ES2 IN GDG-FLD > SPACES
              MOVE GDG-ES2 IN GDG-FLD
                   TO SDF-GDG-ES2 IN GARFGDG.
           IF GDG-IIV-AUT-ES1 IN GDG-FLD > SPACES
              MOVE GDG-IIV-AUT-ES1 IN GDG-FLD
                   TO SDF-GDG-IIV-AUT-ES1 IN GARFGDG.
           IF GDG-FEC-VTO IN GDG-FLD > SPACES
              MOVE GDG-FEC-VTO IN GDG-FLD
                   TO SDF-GDG-FEC-VTO IN GARFGDG.
           IF GDG-FEC-ALZ IN GDG-FLD > SPACES
              MOVE GDG-FEC-ALZ IN GDG-FLD
                   TO SDF-GDG-FEC-ALZ IN GARFGDG.
           IF GDG-FEC-SOL-CNS IN GDG-FLD > SPACES
              MOVE GDG-FEC-SOL-CNS IN GDG-FLD
                   TO SDF-GDG-FEC-SOL-CNS IN GARFGDG.
           IF FRM-NUM-ICLI IN GDG-FLD > SPACES
              MOVE FRM-NUM-ICLI IN GDG-FLD
                   TO SDF-FRM-NUM-ICLI IN GARFGDG.
           IF FRM-VRF-ICLI IN GDG-FLD > SPACES
              MOVE FRM-VRF-ICLI IN GDG-FLD
                   TO SDF-FRM-VRF-ICLI IN GARFGDG.
           IF FRM-IND-ICLI IN GDG-FLD > SPACES
              MOVE FRM-IND-ICLI IN GDG-FLD
                   TO SDF-FRM-IND-ICLI IN GARFGDG.
           IF FRM-GLS-ICLI IN GDG-FLD > SPACES
              MOVE FRM-GLS-ICLI IN GDG-FLD
                   TO SDF-FRM-GLS-ICLI IN GARFGDG.
           IF GDG-FEC-ESC-CNS IN GDG-FLD > SPACES
              MOVE GDG-FEC-ESC-CNS IN GDG-FLD
                   TO SDF-GDG-FEC-ESC-CNS IN GARFGDG.
           IF GDG-IND-OBL-INS IN GDG-FLD > SPACES
              MOVE GDG-IND-OBL-INS IN GDG-FLD
                   TO SDF-GDG-IND-OBL-INS IN GARFGDG.
           IF GDG-FEC-ING-SIS IN GDG-FLD > SPACES
              MOVE GDG-FEC-ING-SIS IN GDG-FLD
                   TO SDF-GDG-FEC-ING-SIS IN GARFGDG.
       FIN-MOV-WI-F-AGA.
           EXIT.
      
      
       PRO-GAR-GDG SECTION.
       INI-PRO-GAR-GDG.
           IF WSS-IND-PROC = "S"
              DISPLAY "[GDG YA PROCESADA]"
              GO TO FIN-PRO-GAR-GDG.
           MOVE "GDG" TO WSS-ENT-PPAL.
           MOVE WSS-IND-CORR TO WSS-GDG-CORR.
           MOVE "N" TO WSS-ERR-GDG.
           MOVE SPACES TO WSS-NUM-GAR.
           MOVE "GAR" TO ICM-SIST.
           MOVE "GDG" TO ICM-FORM.
           MOVE SPACES   TO GDG-FLD-EXT.
           MOVE WSS-ENTI TO GDG-FLD-EXT.
           PERFORM PRO-GAR-GDG-KEY-SCR.
           PERFORM PRO-GAR-GDG-KEY.
           MOVE  GARFGDG   TO ENV-FRM-VARI.
           MOVE "GARPAGDG" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES GDG]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDG-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GDG.
           PERFORM PRO-GAR-GDG-FLD-SCR.
           PERFORM MOV-WI-F-GDG.
           PERFORM PRO-GAR-GDG-FLD.
           MOVE  GARFGDG   TO ENV-FRM-VARI.
           MOVE "GARPAGDG" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS GDG]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDG-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GDG.
           DISPLAY "[NRO GARANTIA INGRESADA]" GDG-NUM-SIS IN GDG-FLD
                                         ":"  GDG-COD-CRR IN GDG-FLD.
           MOVE GDG-NUM-SIS IN GDG-FLD TO WSS-NUM-SIS.
           MOVE GDG-COD-CRR IN GDG-FLD TO WSS-COD-CRR.
           PERFORM GRAB-REG-ING.
      *    DISPLAY "[NUM-SIS WSS]:" WSS-NUM-SIS.
      *    DISPLAY "[COD-CRR WSS]:" WSS-COD-CRR.
       FIN-PRO-GAR-GDG.
           EXIT.
      
       PRO-GAR-GDG-KEY-SCR SECTION.
       INI-PRO-GAR-GDG-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GARACTGDG" TO SCR-NEMO.
           MOVE "GAR" TO SCR-SIST.
           MOVE "GC03" TO SCR-NTRN.
           MOVE "GARPAGDG" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
      FIN-PRO-GAR-GDG-KEY-SCR.
           EXIT.
      
       PRO-GAR-GDG-FLD-SCR SECTION.
       INI-PRO-GAR-GDG-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-GAR-GDG-FLD-SCR.
           EXIT.
      
       PRO-GAR-GDG-KEY SECTION.
       INI-PRO-GAR-GDG-KEY.
           MOVE SPACES TO GARFGDG.
           IF GDG-TIP-OPE IN GDG-FLD-EXT > SPACES
              MOVE GDG-TIP-OPE IN GDG-FLD-EXT
                   TO SDF-GDG-TIP-OPE IN GARFGDG.
           IF GDG-STP-OPE IN GDG-FLD-EXT > SPACES
              MOVE GDG-STP-OPE IN GDG-FLD-EXT
                   TO SDF-GDG-STP-OPE IN GARFGDG.
       FIN-PRO-GAR-GDG-KEY.
           EXIT.
      
       PRO-GAR-GDG-FLD SECTION.
       INI-PRO-GAR-GDG-FLD.
           IF GDG-NUM-SIS IN GDG-FLD-EXT > SPACES
              MOVE GDG-NUM-SIS IN GDG-FLD-EXT
                   TO SDF-GDG-NUM-SIS IN GARFGDG.
           IF GDG-COD-CRR IN GDG-FLD-EXT > ZEROES
              MOVE GDG-COD-CRR IN GDG-FLD-EXT
                   TO SDF-GDG-COD-CRR IN GARFGDG.
           IF DBC-NUM-ICLI IN GDG-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN GDG-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN GARFGDG.
           IF DBC-VRF-ICLI IN GDG-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN GDG-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN GARFGDG.
           IF DBC-IND-ICLI IN GDG-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN GDG-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN GARFGDG.
           IF DBC-GLS-ICLI IN GDG-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN GDG-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN GARFGDG.
           IF FRM-IIC-IOPD IN GDG-FLD-EXT > SPACES
              MOVE FRM-IIC-IOPD IN GDG-FLD-EXT
                   TO SDF-FRM-IIC-IOPD IN GARFGDG.
           IF GDG-COD-OFI IN GDG-FLD-EXT > SPACES
              MOVE GDG-COD-OFI IN GDG-FLD-EXT
                   TO SDF-GDG-COD-OFI IN GARFGDG.
           IF GDG-VCB IN GDG-FLD-EXT > SPACES
              MOVE GDG-VCB IN GDG-FLD-EXT
                   TO SDF-GDG-VCB IN GARFGDG.
           IF GDG-DES-1 IN GDG-FLD-EXT > SPACES
              MOVE GDG-DES-1 IN GDG-FLD-EXT
                   TO SDF-GDG-DES-1 IN GARFGDG.
           IF GDG-DES-2 IN GDG-FLD-EXT > SPACES
              MOVE GDG-DES-2 IN GDG-FLD-EXT
                   TO SDF-GDG-DES-2 IN GARFGDG.
           IF GDG-COD-LIM IN GDG-FLD-EXT > SPACES
              MOVE GDG-COD-LIM IN GDG-FLD-EXT
                   TO SDF-GDG-COD-LIM IN GARFGDG.
           IF GDG-COD-EJE-ORI IN GDG-FLD-EXT > SPACES
              MOVE GDG-COD-EJE-ORI IN GDG-FLD-EXT
                   TO SDF-GDG-COD-EJE-ORI IN GARFGDG.
           IF GDG-COD-GRA IN GDG-FLD-EXT > SPACES
              MOVE GDG-COD-GRA IN GDG-FLD-EXT
                   TO SDF-GDG-COD-GRA IN GARFGDG.
           IF GDG-ES1 IN GDG-FLD-EXT > SPACES
              MOVE GDG-ES1 IN GDG-FLD-EXT
                   TO SDF-GDG-ES1 IN GARFGDG.
           IF GDG-ES2 IN GDG-FLD-EXT > SPACES
              MOVE GDG-ES2 IN GDG-FLD-EXT
                   TO SDF-GDG-ES2 IN GARFGDG.
           IF GDG-IIV-AUT-ES1 IN GDG-FLD-EXT > SPACES
              MOVE GDG-IIV-AUT-ES1 IN GDG-FLD-EXT
                   TO SDF-GDG-IIV-AUT-ES1 IN GARFGDG.
           IF GDG-FEC-VTO IN GDG-FLD-EXT > SPACES
              MOVE GDG-FEC-VTO IN GDG-FLD-EXT
                   TO SDF-GDG-FEC-VTO IN GARFGDG.
           IF GDG-FEC-ALZ IN GDG-FLD-EXT > SPACES
              MOVE GDG-FEC-ALZ IN GDG-FLD-EXT
                   TO SDF-GDG-FEC-ALZ IN GARFGDG.
           IF GDG-FEC-SOL-CNS IN GDG-FLD-EXT > SPACES
              MOVE GDG-FEC-SOL-CNS IN GDG-FLD-EXT
                   TO SDF-GDG-FEC-SOL-CNS IN GARFGDG.
           IF FRM-NUM-ICLI IN GDG-FLD-EXT > SPACES
              MOVE FRM-NUM-ICLI IN GDG-FLD-EXT
                   TO SDF-FRM-NUM-ICLI IN GARFGDG.
           IF FRM-VRF-ICLI IN GDG-FLD-EXT > SPACES
              MOVE FRM-VRF-ICLI IN GDG-FLD-EXT
                   TO SDF-FRM-VRF-ICLI IN GARFGDG.
           IF FRM-IND-ICLI IN GDG-FLD-EXT > SPACES
              MOVE FRM-IND-ICLI IN GDG-FLD-EXT
                   TO SDF-FRM-IND-ICLI IN GARFGDG.
           IF FRM-GLS-ICLI IN GDG-FLD-EXT > SPACES
              MOVE FRM-GLS-ICLI IN GDG-FLD-EXT
                   TO SDF-FRM-GLS-ICLI IN GARFGDG.
           IF GDG-FEC-ESC-CNS IN GDG-FLD-EXT > SPACES
              MOVE GDG-FEC-ESC-CNS IN GDG-FLD-EXT
                   TO SDF-GDG-FEC-ESC-CNS IN GARFGDG.
           IF GDG-IND-OBL-INS IN GDG-FLD-EXT > SPACES
              MOVE GDG-IND-OBL-INS IN GDG-FLD-EXT
                   TO SDF-GDG-IND-OBL-INS IN GARFGDG.
       FIN-PRO-GAR-GDG-FLD.
           EXIT.
      
       MOV-WI-F-GDG SECTION.
       INI-MOV-WI-F-GDG.
           IF GDG-NUM-SIS IN GDG-FLD > SPACES
              MOVE GDG-NUM-SIS IN GDG-FLD
                   TO SDF-GDG-NUM-SIS IN GARFGDG.
           IF GDG-COD-CRR IN GDG-FLD > SPACES
              MOVE GDG-COD-CRR IN GDG-FLD
                   TO SDF-GDG-COD-CRR IN GARFGDG.
           IF DBC-NUM-ICLI IN GDG-FLD > SPACES
              MOVE DBC-NUM-ICLI IN GDG-FLD
                   TO SDF-DBC-NUM-ICLI IN GARFGDG.
           IF DBC-VRF-ICLI IN GDG-FLD > SPACES
              MOVE DBC-VRF-ICLI IN GDG-FLD
                   TO SDF-DBC-VRF-ICLI IN GARFGDG.
           IF DBC-IND-ICLI IN GDG-FLD > SPACES
              MOVE DBC-IND-ICLI IN GDG-FLD
                   TO SDF-DBC-IND-ICLI IN GARFGDG.
           IF DBC-GLS-ICLI IN GDG-FLD > SPACES
              MOVE DBC-GLS-ICLI IN GDG-FLD
                   TO SDF-DBC-GLS-ICLI IN GARFGDG.
           IF FRM-IIC-IOPD IN GDG-FLD > SPACES
              MOVE FRM-IIC-IOPD IN GDG-FLD
                   TO SDF-FRM-IIC-IOPD IN GARFGDG.
           IF GDG-COD-OFI IN GDG-FLD > SPACES
              MOVE GDG-COD-OFI IN GDG-FLD
                   TO SDF-GDG-COD-OFI IN GARFGDG.
           IF GDG-VCB IN GDG-FLD > SPACES
              MOVE GDG-VCB IN GDG-FLD
                   TO SDF-GDG-VCB IN GARFGDG.
           IF GDG-DES-1 IN GDG-FLD > SPACES
              MOVE GDG-DES-1 IN GDG-FLD
                   TO SDF-GDG-DES-1 IN GARFGDG.
           IF GDG-DES-2 IN GDG-FLD > SPACES
              MOVE GDG-DES-2 IN GDG-FLD
                   TO SDF-GDG-DES-2 IN GARFGDG.
           IF GDG-COD-LIM IN GDG-FLD > SPACES
              MOVE GDG-COD-LIM IN GDG-FLD
                   TO SDF-GDG-COD-LIM IN GARFGDG.
           IF GDG-COD-EJE-ORI IN GDG-FLD > SPACES
              MOVE GDG-COD-EJE-ORI IN GDG-FLD
                   TO SDF-GDG-COD-EJE-ORI IN GARFGDG.
           IF GDG-COD-GRA IN GDG-FLD > SPACES
              MOVE GDG-COD-GRA IN GDG-FLD
                   TO SDF-GDG-COD-GRA IN GARFGDG.
           IF GDG-ES1 IN GDG-FLD > SPACES
              MOVE GDG-ES1 IN GDG-FLD
                   TO SDF-GDG-ES1 IN GARFGDG.
           IF GDG-ES2 IN GDG-FLD > SPACES
              MOVE GDG-ES2 IN GDG-FLD
                   TO SDF-GDG-ES2 IN GARFGDG.
           IF GDG-IIV-AUT-ES1 IN GDG-FLD > SPACES
              MOVE GDG-IIV-AUT-ES1 IN GDG-FLD
                   TO SDF-GDG-IIV-AUT-ES1 IN GARFGDG.
           IF GDG-FEC-VTO IN GDG-FLD > SPACES
              MOVE GDG-FEC-VTO IN GDG-FLD
                   TO SDF-GDG-FEC-VTO IN GARFGDG.
           IF GDG-FEC-ALZ IN GDG-FLD > SPACES
              MOVE GDG-FEC-ALZ IN GDG-FLD
                   TO SDF-GDG-FEC-ALZ IN GARFGDG.
           IF GDG-FEC-SOL-CNS IN GDG-FLD > SPACES
              MOVE GDG-FEC-SOL-CNS IN GDG-FLD
                   TO SDF-GDG-FEC-SOL-CNS IN GARFGDG.
           IF FRM-NUM-ICLI IN GDG-FLD > SPACES
              MOVE FRM-NUM-ICLI IN GDG-FLD
                   TO SDF-FRM-NUM-ICLI IN GARFGDG.
           IF FRM-VRF-ICLI IN GDG-FLD > SPACES
              MOVE FRM-VRF-ICLI IN GDG-FLD
                   TO SDF-FRM-VRF-ICLI IN GARFGDG.
           IF FRM-IND-ICLI IN GDG-FLD > SPACES
              MOVE FRM-IND-ICLI IN GDG-FLD
                   TO SDF-FRM-IND-ICLI IN GARFGDG.
           IF FRM-GLS-ICLI IN GDG-FLD > SPACES
              MOVE FRM-GLS-ICLI IN GDG-FLD
                   TO SDF-FRM-GLS-ICLI IN GARFGDG.
           IF GDG-FEC-ESC-CNS IN GDG-FLD > SPACES
              MOVE GDG-FEC-ESC-CNS IN GDG-FLD
                   TO SDF-GDG-FEC-ESC-CNS IN GARFGDG.
           IF GDG-IND-OBL-INS IN GDG-FLD > SPACES
              MOVE GDG-IND-OBL-INS IN GDG-FLD
                   TO SDF-GDG-IND-OBL-INS IN GARFGDG.
           IF GDG-FEC-ING-SIS IN GDG-FLD > SPACES
              MOVE GDG-FEC-ING-SIS IN GDG-FLD
                   TO SDF-GDG-FEC-ING-SIS IN GARFGDG.
       FIN-MOV-WI-F-GDG.
           EXIT.
      
       PRO-GAR-GDD SECTION.
       INI-PRO-GAR-GDD.
           IF WSS-ERR-GDG = "S"
              DISPLAY "NO PROCESARA GDD POR ERROR EN TX GAR"
              GO TO FIN-PRO-GAR-GDD.
           MOVE "GAR" TO ICM-SIST.
           MOVE "GDD" TO ICM-FORM.
           MOVE SPACES   TO GDD-FLD-EXT.
           MOVE WSS-ENTI TO GDD-FLD-EXT.
           PERFORM PRO-GAR-GDD-KEY-SCR.
           PERFORM PRO-GAR-GDD-KEY.
           MOVE  GARFGDD   TO ENV-FRM-VARI.
           MOVE "GARPAGDD" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES GDD]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDD-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GDD.
           PERFORM PRO-GAR-GDD-FLD-SCR.
           PERFORM MOV-WI-F-GDD.
           PERFORM PRO-GAR-GDD-FLD.
           MOVE  GARFGDD   TO ENV-FRM-VARI.
           MOVE "GARPAGDD" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS GDD]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GDD-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GDD.
           PERFORM GRAB-REG-ING.
       FIN-PRO-GAR-GDD.
           EXIT.
      
       PRO-GAR-GDD-KEY-SCR SECTION.
       INI-PRO-GAR-GDD-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GARACTGDD" TO SCR-NEMO.
           MOVE "GAR" TO SCR-SIST.
           MOVE "GC02" TO SCR-NTRN.
           MOVE "GARPAGDD" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-GAR-GDD-KEY-SCR.
           EXIT.
      
       PRO-GAR-GDD-FLD-SCR SECTION.
       INI-PRO-GAR-GDD-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-GAR-GDD-FLD-SCR.
           EXIT.
      
       PRO-GAR-GDD-KEY SECTION.
       INI-PRO-GAR-GDD-KEY.
           MOVE SPACES TO GARFGDD.
           IF GDD-NUM-SIS IN GDD-FLD-EXT > SPACES
              MOVE GDD-NUM-SIS IN GDD-FLD-EXT
                   TO SDF-GDD-NUM-SIS IN GARFGDD
           ELSE
              MOVE WSS-NUM-SIS TO SDF-GDD-NUM-SIS IN GARFGDD.
           IF GDD-COD-CRR IN GDD-FLD-EXT > ZEROES
              MOVE GDD-COD-CRR IN GDD-FLD-EXT
                   TO SDF-GDD-COD-CRR IN GARFGDD
           ELSE
              MOVE WSS-COD-CRR TO SDF-GDD-COD-CRR IN GARFGDD.
           IF DBC-NUM-ICLI IN GDD-FLD-EXT > SPACES
              MOVE DBC-NUM-ICLI IN GDD-FLD-EXT
                   TO SDF-DBC-NUM-ICLI IN GARFGDD.
           IF DBC-VRF-ICLI IN GDD-FLD-EXT > SPACES
              MOVE DBC-VRF-ICLI IN GDD-FLD-EXT
                   TO SDF-DBC-VRF-ICLI IN GARFGDD.
           IF DBC-IND-ICLI IN GDD-FLD-EXT > SPACES
              MOVE DBC-IND-ICLI IN GDD-FLD-EXT
                   TO SDF-DBC-IND-ICLI IN GARFGDD.
           IF DBC-GLS-ICLI IN GDD-FLD-EXT > SPACES
              MOVE DBC-GLS-ICLI IN GDD-FLD-EXT
                   TO SDF-DBC-GLS-ICLI IN GARFGDD.
       FIN-PRO-GAR-GDD-KEY.
           EXIT.
      
       PRO-GAR-GDD-FLD SECTION.
       INI-PRO-GAR-GDD-FLD.
           IF GDD-VAL-LIM-DDR IN GDD-FLD-EXT > SPACES
              MOVE GDD-VAL-LIM-DDR IN GDD-FLD-EXT
                   TO SDF-GDD-VAL-LIM-DDR IN GARFGDD.
           IF GDD-PCT-LIM-DDR IN GDD-FLD-EXT > SPACES
              MOVE GDD-PCT-LIM-DDR IN GDD-FLD-EXT
                   TO SDF-GDD-PCT-LIM-DDR IN GARFGDD.
       FIN-PRO-GAR-GDD-FLD.
           EXIT.
      
       MOV-WI-F-GDD SECTION.
       INI-MOV-WI-F-GDD.
           IF GDD-VAL-LIM-DDR-ALF IN GDD-FLD > SPACES
              MOVE GDD-VAL-LIM-DDR-ALF IN GDD-FLD
                   TO SDF-GDD-VAL-LIM-DDR IN GARFGDD.
           IF GDD-PCT-LIM-DDR-ALF IN GDD-FLD > SPACES
              MOVE GDD-PCT-LIM-DDR-ALF IN GDD-FLD
                   TO SDF-GDD-PCT-LIM-DDR IN GARFGDD.
       FIN-MOV-WI-F-GDD.
           EXIT.
      
       PRO-GAR-GVT SECTION.
       INI-PRO-GAR-GVT.
           IF WSS-ERR-GDG = "S"
              DISPLAY "NO PROCESARA GVT POR ERROR EN TX GAR"
              GO TO FIN-PRO-GAR-GVT.
           MOVE "GAR" TO ICM-SIST.
           MOVE "GVT" TO ICM-FORM.
           MOVE SPACES   TO GVT-FLD-EXT.
           MOVE WSS-ENTI TO GVT-FLD-EXT.
           PERFORM PRO-GAR-GVT-KEY-SCR.
           PERFORM PRO-GAR-GVT-KEY.
           MOVE  GARFGVT   TO ENV-FRM-VARI.
           MOVE "GARPAGVT" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES GVT]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GVT-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GVT.
           PERFORM PRO-GAR-GVT-FLD-SCR.
           PERFORM MOV-WI-F-GVT.
           PERFORM PRO-GAR-GVT-FLD.
           MOVE  GARFGVT   TO ENV-FRM-VARI.
           MOVE "GARPAGVT" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS GVT]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GVT-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GVT.
           PERFORM GRAB-REG-ING.
       FIN-PRO-GAR-GVT.
           EXIT.
      
       PRO-GAR-GVT-KEY-SCR SECTION.
       INI-PRO-GAR-GVT-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GARACTGVA" TO SCR-NEMO.
           MOVE "GAR" TO SCR-SIST.
           MOVE "GC13" TO SCR-NTRN.
           MOVE "GARPAGVT" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C"   TO SCR-ICMN.
           MOVE """"  TO SCR-FFLD.
           MOVE "S"   TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-GAR-GVT-KEY-SCR.
           EXIT.
      
       PRO-GAR-GVT-FLD-SCR SECTION.
       INI-PRO-GAR-GVT-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P"   TO SCR-ICMN.
       FIN-PRO-GAR-GVT-FLD-SCR.
           EXIT.
      
       PRO-GAR-GVT-KEY SECTION.
       INI-PRO-GAR-GVT-KEY.
      *    DISPLAY "[EN INI-PRO-GAR-GVT-KEY]".
      *    DISPLAY "[NUM-SIS EXT]:" GVT-NUM-SIS IN GVT-FLD-EXT.
      *    DISPLAY "[COD-CRR EXT]:" GVT-COD-CRR IN GVT-FLD-EXT.
      *    DISPLAY "[NUM-SIS WSS]:" WSS-NUM-SIS.
      *    DISPLAY "[COD-CRR WSS]:" WSS-COD-CRR.
           MOVE SPACES TO GARFGVT.
           IF GVT-NUM-SIS IN GVT-FLD-EXT > SPACES
              MOVE GVT-NUM-SIS IN GVT-FLD-EXT
                   TO SDF-GVT-NUM-SIS IN GARFGVT
           ELSE
              MOVE WSS-NUM-SIS TO SDF-GVT-NUM-SIS IN GARFGVT.
           IF GVT-COD-CRR IN GVT-FLD-EXT > ZEROES
              MOVE GVT-COD-CRR IN GVT-FLD-EXT
                   TO SDF-GVT-COD-CRR IN GARFGVT
           ELSE
              MOVE WSS-COD-CRR TO SDF-GVT-COD-CRR IN GARFGVT.
           IF GVT-COD-TSN IN GVT-FLD-EXT > SPACES
              MOVE GVT-COD-TSN IN GVT-FLD-EXT
                   TO SDF-GVT-COD-TSN IN GARFGVT.
      *    DISPLAY "[NUM-SIS SDF]:" SDF-GVT-NUM-SIS IN GARFGVT.
      *    DISPLAY "[COD-CRR SDF]:" SDF-GVT-COD-CRR IN GARFGVT.
       FIN-PRO-GAR-GVT-KEY.
           EXIT.
      
       PRO-GAR-GVT-FLD SECTION.
       INI-PRO-GAR-GVT-FLD.
           IF FRM-IND-GTP IN GVT-FLD-EXT > SPACES
              MOVE FRM-IND-GTP IN GVT-FLD-EXT
                   TO SDF-FRM-IND-GTP IN GARFGVT.
           IF GVT-FEC-TSN IN GVT-FLD-EXT > SPACES
              MOVE GVT-FEC-TSN IN GVT-FLD-EXT
                   TO SDF-GVT-FEC-TSN IN GARFGVT.
           IF GVT-VAL-CML-TSN IN GVT-FLD-EXT > SPACES
              MOVE GVT-VAL-CML-TSN IN GVT-FLD-EXT
                   TO SDF-GVT-VAL-CML-TSN IN GARFGVT.
           IF GVT-VAL-LIQ-TSN IN GVT-FLD-EXT > SPACES
              MOVE GVT-VAL-LIQ-TSN IN GVT-FLD-EXT
                   TO SDF-GVT-VAL-LIQ-TSN IN GARFGVT.
           IF GVT-PCT-AJT-SUP IN GVT-FLD-EXT > SPACES
              MOVE GVT-PCT-AJT-SUP IN GVT-FLD-EXT
                   TO SDF-GVT-PCT-AJT-SUP IN GARFGVT.
           IF FRM-VAL-AJT-SUP IN GVT-FLD-EXT > SPACES
              MOVE FRM-VAL-AJT-SUP IN GVT-FLD-EXT
                   TO SDF-FRM-VAL-AJT-SUP IN GARFGVT.
           IF GVT-VAL-PON IN GVT-FLD-EXT > SPACES
              MOVE GVT-VAL-PON IN GVT-FLD-EXT
                   TO SDF-GVT-VAL-PON IN GARFGVT.
           IF GVT-COD-CFCD IN GVT-FLD-EXT > SPACES
              MOVE GVT-COD-CFCD IN GVT-FLD-EXT
                   TO SDF-GVT-COD-CFCD IN GARFGVT.
           IF GVT-NUM-AMOD IN GVT-FLD-EXT > SPACES
              MOVE GVT-NUM-AMOD IN GVT-FLD-EXT
                   TO SDF-GVT-NUM-AMOD IN GARFGVT.
           IF GVT-IIV-TSD IN GVT-FLD-EXT > SPACES
              MOVE GVT-IIV-TSD IN GVT-FLD-EXT
                   TO SDF-GVT-IIV-TSD IN GARFGVT.
           IF GVT-TIP-CTR IN GVT-FLD-EXT > SPACES
              MOVE GVT-TIP-CTR IN GVT-FLD-EXT
                   TO SDF-GVT-TIP-CTR IN GARFGVT.
           IF GVT-M2-TRR IN GVT-FLD-EXT > SPACES
              MOVE GVT-M2-TRR IN GVT-FLD-EXT
                   TO SDF-GVT-M2-TRR IN GARFGVT.
           IF GVT-COD-UMD IN GVT-FLD-EXT > SPACES
              MOVE GVT-COD-UMD IN GVT-FLD-EXT
                   TO SDF-GVT-COD-UMD IN GARFGVT.
           IF GVT-FEC-RVL IN GVT-FLD-EXT > SPACES
              MOVE GVT-FEC-RVL IN GVT-FLD-EXT
                   TO SDF-GVT-FEC-RVL IN GARFGVT.
           IF GVT-M2-CTR IN GVT-FLD-EXT > SPACES
              MOVE GVT-M2-CTR IN GVT-FLD-EXT
                   TO SDF-GVT-M2-CTR IN GARFGVT.
           IF GVT-TIP-MAQ-EQP IN GVT-FLD-EXT >SPACES
              MOVE GVT-TIP-MAQ-EQP IN GVT-FLD-EXT
                   TO SDF-GVT-TIP-MAQ-EQP IN GARFGVT.
       FIN-PRO-GAR-GVT-FLD.
           EXIT.
      
       MOV-WI-F-GVT SECTION.
       INI-MOV-WI-F-GVT.
           IF GVT-COD-TSN IN GVT-FLD > SPACES
              MOVE GVT-COD-TSN IN GVT-FLD
                   TO SDF-GVT-COD-TSN IN GARFGVT.
           IF FRM-IND-GTP IN GVT-FLD > SPACES
              MOVE FRM-IND-GTP IN GVT-FLD
                   TO SDF-FRM-IND-GTP IN GARFGVT.
           IF GVT-FEC-TSN IN GVT-FLD > SPACES
              MOVE GVT-FEC-TSN IN GVT-FLD
                   TO SDF-GVT-FEC-TSN IN GARFGVT.
           IF GVT-VAL-CML-TSN-ALF IN GVT-FLD > SPACES
              MOVE GVT-VAL-CML-TSN-ALF IN GVT-FLD
                   TO SDF-GVT-VAL-CML-TSN IN GARFGVT.
           IF GVT-VAL-LIQ-TSN-ALF IN GVT-FLD > SPACES
              MOVE GVT-VAL-LIQ-TSN-ALF IN GVT-FLD
                   TO SDF-GVT-VAL-LIQ-TSN IN GARFGVT.
           IF GVT-PCT-AJT-SUP-ALF IN GVT-FLD > SPACES
              MOVE GVT-PCT-AJT-SUP-ALF IN GVT-FLD
                   TO SDF-GVT-PCT-AJT-SUP IN GARFGVT.
           IF FRM-VAL-AJT-SUP-ALF IN GVT-FLD > SPACES
              MOVE FRM-VAL-AJT-SUP-ALF IN GVT-FLD
                   TO SDF-FRM-VAL-AJT-SUP IN GARFGVT.
           IF GVT-VAL-PON-ALF IN GVT-FLD > SPACES
              MOVE GVT-VAL-PON-ALF IN GVT-FLD
                   TO SDF-GVT-VAL-PON IN GARFGVT.
           IF GVT-COD-CFCD IN GVT-FLD > SPACES
              MOVE GVT-COD-CFCD IN GVT-FLD
                   TO SDF-GVT-COD-CFCD IN GARFGVT.
           IF GVT-NUM-AMOD-ALF IN GVT-FLD > SPACES
              MOVE GVT-NUM-AMOD-ALF IN GVT-FLD
                   TO SDF-GVT-NUM-AMOD IN GARFGVT.
           IF GVT-IIV-TSD IN GVT-FLD > SPACES
              MOVE GVT-IIV-TSD IN GVT-FLD
                   TO SDF-GVT-IIV-TSD IN GARFGVT.
           IF GVT-TIP-CTR IN GVT-FLD > SPACES
              MOVE GVT-TIP-CTR IN GVT-FLD
                   TO SDF-GVT-TIP-CTR IN GARFGVT.
           IF GVT-M2-TRR IN GVT-FLD > SPACES
              MOVE GVT-M2-TRR IN GVT-FLD
                   TO SDF-GVT-M2-TRR IN GARFGVT.
           IF GVT-COD-UMD IN GVT-FLD > SPACES
              MOVE GVT-COD-UMD IN GVT-FLD
                   TO SDF-GVT-COD-UMD IN GARFGVT.
           IF GVT-FEC-RVL IN GVT-FLD > SPACES
              MOVE GVT-FEC-RVL IN GVT-FLD
                   TO SDF-GVT-FEC-RVL IN GARFGVT.
           IF GVT-M2-CTR IN GVT-FLD > SPACES
              MOVE GVT-M2-CTR IN GVT-FLD
                   TO SDF-GVT-M2-CTR IN GARFGVT.
           IF GVT-TIP-MAQ-EQP IN GVT-FLD >SPACES
              MOVE GVT-TIP-MAQ-EQP IN GVT-FLD
                   TO SDF-GVT-TIP-MAQ-EQP IN GARFGVT.
       FIN-MOV-WI-F-GVT.
           EXIT.
      
       PRO-GAR-GSE SECTION.
       INI-PRO-GAR-GSE.
           IF WSS-ERR-GDG = "S"
              DISPLAY "NO PROCESARA GSE POR ERROR EN TX GAR"
              GO TO FIN-PRO-GAR-GSE.
           MOVE "GAR" TO ICM-SIST.
           MOVE "GSE" TO ICM-FORM.
           MOVE SPACES   TO GSE-FLD-EXT.
           MOVE WSS-ENTI TO GSE-FLD-EXT.
           PERFORM PRO-GAR-GSE-KEY-SCR.
           PERFORM PRO-GAR-GSE-KEY.
           MOVE  GARFGSE   TO ENV-FRM-VARI.
           MOVE "GARPAGSE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA LLAVES GSE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GSE-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GSE.
           PERFORM PRO-GAR-GSE-FLD-SCR.
           PERFORM MOV-WI-F-GSE.
           PERFORM PRO-GAR-GSE-FLD.
           MOVE  GARFGSE   TO ENV-FRM-VARI.
           MOVE "GARPAGSE" TO SYS-PROG-ALF.
           DISPLAY "[INSTANCIA CAMPOS GSE]".
           PERFORM PRO-ENVIA.
           PERFORM PRO-RECIBE.
           MOVE CM-DATOS TO GSE-FLD.
           IF SCR-IERR = "S"
              MOVE "S" TO WSS-ERR-GDG
              PERFORM INF-ERR
              GO TO FIN-PRO-GAR-GSE.
           PERFORM GRAB-REG-ING.
       FIN-PRO-GAR-GSE.
           EXIT.
      
       PRO-GAR-GSE-KEY-SCR SECTION.
       INI-PRO-GAR-GSE-KEY-SCR.
           MOVE SPACES TO SCR-VARI.
           MOVE "GARACTGSE" TO SCR-NEMO.
           MOVE "GAR" TO SCR-SIST.
           MOVE "GC09" TO SCR-NTRN.
           MOVE "GARPAGSE" TO SCR-PROG.
           MOVE "GKY" TO SCR-INST.
           MOVE "GNSPPICE" TO SCR-CMNP.
           MOVE "ING" TO SCR-CMND.
           MOVE "ING" TO SCR-CCPP.
           MOVE "M"   TO SCR-STPP.
           MOVE "C" TO SCR-ICMN.
           MOVE """" TO SCR-FFLD.
           MOVE "S" TO SCR-OFRM.
           MOVE "   " TO SCR-OFIC.
       FIN-PRO-GAR-GSE-KEY-SCR.
           EXIT.
      
       PRO-GAR-GSE-FLD-SCR SECTION.
       INI-PRO-GAR-GSE-FLD-SCR.
           MOVE "GFL" TO SCR-INST.
           MOVE "P" TO SCR-ICMN.
       FIN-PRO-GAR-GSE-FLD-SCR.
           EXIT.
      
       PRO-GAR-GSE-KEY SECTION.
       INI-PRO-GAR-GSE-KEY.
           MOVE SPACES TO GARFGSE.
           IF GSE-NUM-SIS IN GSE-FLD-EXT > SPACES
              MOVE GSE-NUM-SIS IN GSE-FLD-EXT
                   TO SDF-GSE-NUM-SIS IN GARFGSE
           ELSE
              MOVE WSS-NUM-SIS TO SDF-GSE-NUM-SIS IN GARFGSE.
           IF GSE-COD-CRR IN GSE-FLD-EXT > ZEROES
              MOVE GSE-COD-CRR IN GSE-FLD-EXT
                   TO SDF-GSE-COD-CRR IN GARFGSE
           ELSE
              MOVE WSS-COD-CRR TO SDF-GSE-COD-CRR IN GARFGSE.
       FIN-PRO-GAR-GSE-KEY.
           EXIT.
      
       PRO-GAR-GSE-FLD SECTION.
       INI-PRO-GAR-GSE-FLD.
           IF GSE-COD-RPB-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-RPB-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-COD-RPB-SEG IN GARFGSE.
           IF GSE-COD-PLZ IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-PLZ IN GSE-FLD-EXT
                   TO SDF-GSE-COD-PLZ IN GARFGSE.
           IF GSE-IIV-CIA-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-IIV-CIA-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-IIV-CIA-SEG IN GARFGSE.
           IF GSE-IIV-CRD-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-IIV-CRD-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-IIV-CRD-SEG IN GARFGSE.
           IF GSE-FEC-VIG-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-FEC-VIG-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-FEC-VIG-SEG IN GARFGSE.
           IF GSE-FEC-VTO-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-FEC-VTO-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-FEC-VTO-SEG IN GARFGSE.
           IF GSE-VCB-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-VCB-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-VCB-SEG IN GARFGSE.
           IF GSE-VAL-SEG IN GSE-FLD-EXT > SPACES
              MOVE GSE-VAL-SEG IN GSE-FLD-EXT
                   TO SDF-GSE-VAL-SEG IN GARFGSE.
           IF GSE-COD-COB-1 IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-COB-1 IN GSE-FLD-EXT
                   TO SDF-GSE-COD-COB-1 IN GARFGSE.
           IF GSE-COD-COB-2 IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-COB-2 IN GSE-FLD-EXT
                   TO SDF-GSE-COD-COB-2 IN GARFGSE.
           IF GSE-IND-PAG-CUO IN GSE-FLD-EXT > SPACES
              MOVE GSE-IND-PAG-CUO IN GSE-FLD-EXT
                   TO SDF-GSE-IND-PAG-CUO IN GARFGSE.
           IF GSE-COD-COB-3 IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-COB-3 IN GSE-FLD-EXT
                   TO SDF-GSE-COD-COB-3 IN GARFGSE.
           IF GSE-COD-COB-4 IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-COB-4 IN GSE-FLD-EXT
                   TO SDF-GSE-COD-COB-4 IN GARFGSE.
           IF GSE-COD-COB-5 IN GSE-FLD-EXT > SPACES
              MOVE GSE-COD-COB-5 IN GSE-FLD-EXT
                   TO SDF-GSE-COD-COB-5 IN GARFGSE.
       FIN-PRO-GAR-GSE-FLD.
           EXIT.
      
       MOV-WI-F-GSE SECTION.
       INI-MOV-WI-F-GSE.
           IF GSE-COD-RPB-SEG IN GSE-FLD > SPACES
              MOVE GSE-COD-RPB-SEG IN GSE-FLD
                   TO SDF-GSE-COD-RPB-SEG IN GARFGSE.
           IF GSE-COD-PLZ IN GSE-FLD > SPACES
              MOVE GSE-COD-PLZ IN GSE-FLD
                   TO SDF-GSE-COD-PLZ IN GARFGSE.
           IF GSE-IIV-CIA-SEG IN GSE-FLD > SPACES
              MOVE GSE-IIV-CIA-SEG IN GSE-FLD
                   TO SDF-GSE-IIV-CIA-SEG IN GARFGSE.
           IF GSE-IIV-CRD-SEG IN GSE-FLD > SPACES
              MOVE GSE-IIV-CRD-SEG IN GSE-FLD
                   TO SDF-GSE-IIV-CRD-SEG IN GARFGSE.
           IF GSE-FEC-VIG-SEG IN GSE-FLD > SPACES
              MOVE GSE-FEC-VIG-SEG IN GSE-FLD
                   TO SDF-GSE-FEC-VIG-SEG IN GARFGSE.
           IF GSE-FEC-VTO-SEG IN GSE-FLD > SPACES
              MOVE GSE-FEC-VTO-SEG IN GSE-FLD
                   TO SDF-GSE-FEC-VTO-SEG IN GARFGSE.
           IF GSE-VCB-SEG IN GSE-FLD > SPACES
              MOVE GSE-VCB-SEG IN GSE-FLD
                   TO SDF-GSE-VCB-SEG IN GARFGSE.
           IF GSE-VAL-SEG-ALF IN GSE-FLD > SPACES
              MOVE GSE-VAL-SEG-ALF IN GSE-FLD
                   TO SDF-GSE-VAL-SEG IN GARFGSE.
           IF GSE-COD-COB-1 IN GSE-FLD > SPACES
              MOVE GSE-COD-COB-1 IN GSE-FLD
                   TO SDF-GSE-COD-COB-1 IN GARFGSE.
           IF GSE-COD-COB-2 IN GSE-FLD > SPACES
              MOVE GSE-COD-COB-2 IN GSE-FLD
                   TO SDF-GSE-COD-COB-2 IN GARFGSE.
           IF GSE-IND-PAG-CUO IN GSE-FLD > SPACES
              MOVE GSE-IND-PAG-CUO IN GSE-FLD
                   TO SDF-GSE-IND-PAG-CUO IN GARFGSE.
           IF GSE-COD-COB-3 IN GSE-FLD > SPACES
              MOVE GSE-COD-COB-3 IN GSE-FLD
                   TO SDF-GSE-COD-COB-3 IN GARFGSE.
           IF GSE-COD-COB-4 IN GSE-FLD > SPACES
              MOVE GSE-COD-COB-4 IN GSE-FLD
                   TO SDF-GSE-COD-COB-4 IN GARFGSE.
           IF GSE-COD-COB-5 IN GSE-FLD > SPACES
              MOVE GSE-COD-COB-5 IN GSE-FLD
                   TO SDF-GSE-COD-COB-5 IN GARFGSE.
           IF GSE-IND-EDS-SEG IN GSE-FLD > SPACES
              MOVE GSE-IND-EDS-SEG IN GSE-FLD
                   TO SDF-GSE-IND-EDS-SEG IN GARFGSE.
       FIN-MOV-WI-F-GSE.
           EXIT.
      
       INF-ERR-ACT SECTION.
       INI-INF-ERR-ACT.
           DISPLAY "=============== ERROR ==========================".
           IF WSS-IND-CMND = "LIQ"
              DISPLAY "INFORME DE ERROR EN REG NRO : " WSS-OPC-CORR
              DISPLAY "ERROR EN OPC : LIQUIDACION"
              MOVE "OPC: LIQUIDACION" TO ERR-NOM-CAMPO IN REG-GNSICE02
              MOVE WSS-OPC-CORR       TO ERR-NUM-CORR  IN REG-GNSICE02
              MOVE "OPC"              TO ERR-COD-ENTI  IN REG-GNSICE02
              MOVE WSS-CIC-IOPC       TO ERR-CIC-ENTI  IN REG-GNSICE02
           ELSE
           IF WSS-IND-CMND = "ACA"
              DISPLAY "INFORME DE ERROR EN REG NRO : " WSS-OPC-CORR
              DISPLAY "ERROR EN OPC : ACTIVACION"
              MOVE "OPC: ACTIVACION " TO ERR-NOM-CAMPO IN REG-GNSICE02
              MOVE WSS-OPC-CORR       TO ERR-NUM-CORR  IN REG-GNSICE02
              MOVE "OPC"              TO ERR-COD-ENTI  IN REG-GNSICE02
              MOVE WSS-CIC-IOPC       TO ERR-CIC-ENTI  IN REG-GNSICE02
           ELSE
           IF WSS-IND-CMND = "AGA"
              DISPLAY "INFORME DE ERROR EN REG NRO : " WSS-GDG-CORR
              DISPLAY "ERROR EN GDG : ACTIVACION"
              MOVE "GDG: ACTIVACION " TO ERR-NOM-CAMPO IN REG-GNSICE02
              MOVE WSS-GDG-CORR       TO ERR-NUM-CORR  IN REG-GNSICE02
              MOVE "GDG"              TO ERR-COD-ENTI  IN REG-GNSICE02
              MOVE SPACES             TO ERR-CIC-ENTI  IN REG-GNSICE02.
           DISPLAY "MENSAJE : ".
           DISPLAY SCR-TRL-GLS-MENS.
           MOVE SCR-TRL-GLS-MENS   TO ERR-FLS-MENS  IN REG-GNSICE02.
           MOVE WSS-REL-ENTI       TO ERR-REL-ENTI  IN REG-GNSICE02.
           WRITE REG-GNSICE02 INVALID KEY
                 DISPLAY "ERROR GRABANDO GNSICE02:ACT".
           PERFORM GRAB-NO-PROC.
      *    DISPLAY "[[LLAMARA GNSPPDEL ERR-ACT]]".
      *    DISPLAY "[[COMANDO/WSS-IND-CMND]]" WSS-IND-CMND.
      *    DISPLAY "[[ENTIDAD/WSS-ENT-PPAL]]" WSS-ENT-PPAL.
           PERFORM PRO-GNS-DEL.
       FIN-INF-ERR-ACT.
           EXIT.
      
       INF-ERR SECTION.
       INI-INF-ERR.
      *    DISPLAY "[[EN INI-INF-ERR]]".
           MOVE SCR-ICER TO WSS-IDX-ERR.
           DISPLAY "=============== ERROR ==========================".
           DISPLAY "ERROR EN REG NRO : " WSS-IND-CORR.
      *    DISPLAY "ERROR EN SISTEMA : " ICM-SIST.
           DISPLAY "         ENTIDAD : " ICM-FORM.
           DISPLAY "    CAMPO NUMERO : " WSS-IDX-ERR.
           IF WSS-IDX-ERR > 99
               DISPLAY "CAMPO NO ENCONTRADO"
               DISPLAY "DENTRO DE VECTOR DE ERRORES"
           ELSE
               MOVE "GNS" TO MSG-COD-SIST
               MOVE "GNS" TO FIO-SIST
      * ICM = IDENTIFICACION CAMPOS MONITOR
               MOVE ICM-SIST     TO WSS-COD-MSG2
               MOVE ICM-FORM     TO WSS-COD-MSG3
               MOVE WSS-IDX-ERR  TO WSS-COD-MSG4
               MOVE WSS-COD-MSG  TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               IF FIO-STAT-OKS
                   DISPLAY "DESCRIPCION CAMPO : "
                   DISPLAY MSG-GLS-DESC
                   MOVE MSG-GLS-DESC TO ERR-NOM-CAMPO IN REG-GNSICE02
               ELSE
      *            DISPLAY "CAMPO NO ENCONTRADO"
      *            DISPLAY "EN TABLA DE MENSAJES " MSG-COD-MENS IN MSG
                   MOVE "CAMPO NO ENCONTRADO"
                                     TO ERR-NOM-CAMPO IN REG-GNSICE02.
           DISPLAY "MENSAJE : ".
           DISPLAY SCR-TRL-GLS-MENS.
           MOVE WSS-IND-CORR     TO ERR-NUM-CORR IN REG-GNSICE02.
           MOVE WSS-COD-OPCI     TO ERR-COD-ENTI IN REG-GNSICE02.
           MOVE SCR-TRL-GLS-MENS TO ERR-FLS-MENS IN REG-GNSICE02.
           MOVE WSS-REL-ENTI     TO ERR-REL-ENTI IN REG-GNSICE02.
           MOVE SPACES           TO ERR-CIC-ENTI IN REG-GNSICE02.
           IF WSS-COD-OPCI = "DLC" OR WSS-COD-OPCI = "EVC" OR
              WSS-COD-OPCI = "RDC" OR WSS-COD-OPCI = "RMC"
              MOVE WSS-CIC-IOPC  TO ERR-CIC-ENTI IN REG-GNSICE02
           ELSE
           IF WSS-COD-OPCI = "OPC"
              MOVE OPC-CAI-IOPC IN OPC-FLD-EXT
                                 TO ERR-CAI-ENTI IN REG-GNSICE02
              MOVE OPC-IIC-IOPC IN OPC-FLD-EXT
                                 TO ERR-IIC-ENTI IN REG-GNSICE02.
           WRITE REG-GNSICE02 INVALID KEY
                   DISPLAY "[ERROR GRABANDO GNSICE02 EN REG:]"
                   WSS-IND-CORR.
           PERFORM GRAB-NO-PROC.
      *    DISPLAY "[[WSS-ENT-PPAL :]]" WSS-ENT-PPAL.
           IF WSS-ENT-PPAL = "OPC"
      *       DISPLAY "[[LLAMARA GNSPPDEL ERR]]"
              PERFORM PRO-GNS-DEL
           ELSE
           IF WSS-ENT-PPAL = "GDG"
      *       DISPLAY "[[LLAMARA GNSPPDEL ERR]]"
              PERFORM PRO-GNS-DEL
           ELSE
              DISPLAY "[[NO LLAMARA GNSPPDEL ERR]]".
       FIN-INF-ERR.
           EXIT.
      
       GRAB-NO-PROC SECTION.
       INI-GRAB-NO-PROC.
      *    DISPLAY "[[EN INI-GRAB-NO-PROC]]".
           IF WSS-ENT-PPAL = "OPC"
      *       DISPLAY "[[GRAB-NO-PROC X COL]]"
      *       DISPLAY "[[REG GNSICE01:ACT]]:" WSS-IND-CORR
      *       DISPLAY "[[REG GNSICE01:OPC]]:" WSS-OPC-CORR
              MOVE WSS-OPC-CORR TO ICE-NUM-CORR IN REG-GNSICE01
              MOVE WSS-IND-CORR TO WSS-AUX-CORR
              PERFORM MOD-GNSICE01
              MOVE WSS-OPC-CORR TO ENT-NUM-CORR
              PERFORM DEL-GNSICE03
           ELSE
           IF WSS-ENT-PPAL = "GDG"
      *       DISPLAY "[[GRAB-NO-PROC X GAR]]"
      *       DISPLAY "[[REG GNSICE01:ACT]]:" WSS-IND-CORR
      *       DISPLAY "[[REG GNSICE01:GDG]]:" WSS-GDG-CORR
              MOVE WSS-GDG-CORR TO ICE-NUM-CORR IN REG-GNSICE01
              MOVE WSS-IND-CORR TO WSS-AUX-CORR
              PERFORM MOD-GNSICE01
              MOVE WSS-GDG-CORR TO ENT-NUM-CORR
              PERFORM DEL-GNSICE03
           ELSE
           IF WSS-COD-OPCI = "OPC" OR WSS-COD-OPCI = "DBP" OR
              WSS-COD-OPCI = "DBE" OR WSS-COD-OPCI = "OPE" OR
              WSS-COD-OPCI = "DIR" OR WSS-COD-OPCI = "GDG"
      *       DISPLAY "[[GRAB-NO-PROC X NO COL/GAR]]"
              MOVE "N" TO ICE-IND-PROC IN REG-GNSICE01
              REWRITE REG-GNSICE01 INVALID KEY
                      DISPLAY "[ERROR GRABANDO ENTIDAD NO-PROC]".
       FIN-GRAB-NO-PROC.
           EXIT.
      
       MOD-GNSICE01 SECTION.
       INI-MOD-GNSICE01.
      *    DISPLAY "[[EN INI-MOD-GNSICE01]]".
           READ GNSICE01
                INVALID KEY DISPLAY "[[NO ENCONTRO WSS-XXX-CORR]]".
      *    DISPLAY "[[ENT GNSICE01:OPC/GDG]]:" ICE-COD-ENTI.
           MOVE "N" TO ICE-IND-PROC IN REG-GNSICE01.
           REWRITE REG-GNSICE01 INVALID KEY
                DISPLAY "[ERROR GRABANDO ENTIDAD NO-PROC]".
      *    DISPLAY "[[GRABO  N  A IND-PROC OPC/GDG]]" ICE-NUM-CORR.
           MOVE WSS-IND-CORR TO ICE-NUM-CORR.
           READ GNSICE01
                INVALID KEY DISPLAY "[[NO ENCONTRO WSS-IND-CORR]]".
           MOVE REG-GNSICE01 TO WSS-ENTI.
       FIN-MOD-GNSICE01.
           EXIT.
      
       DEL-GNSICE03 SECTION.
       INI-DEL-GNSICE03.
      *    DISPLAY "[[EN INI-DEL-GNSICE03]]".
           READ GNSICE03
              INVALID KEY DISPLAY "[[NO ENCONTRO OPC/GDG:GNSICE03]]".
       LEE-DEL.
      *    DISPLAY "[[EN REG:]]" ENT-NUM-CORR.
           IF ENT-NUM-CORR = WSS-AUX-CORR
      *       DISPLAY "[[BORRO TODAS ENT COL]]"
              GO TO FIN-DEL-GNSICE03.
           DELETE GNSICE03 RECORD
              INVALID KEY DISPLAY "[[ERROR DELETE   :GNSICE03]]".
      *    DISPLAY "[[BORRO REGISTRO]]".
           READ GNSICE03 NEXT RECORD
               AT  END    DISPLAY "[[ERROR READ NEXT:GNSICE03]]"
                          GO TO FIN-DEL-GNSICE03.
           GO TO LEE-DEL.
       FIN-DEL-GNSICE03.
           EXIT.
      
       GRAB-REG-ING SECTION.
       INI-GRAB-REG-ING.
           IF WSS-COD-OPCI = "OPC" OR WSS-COD-OPCI = "DBP" OR
              WSS-COD-OPCI = "DBE" OR WSS-COD-OPCI = "OPE" OR
              WSS-COD-OPCI = "DIR" OR WSS-COD-OPCI = "GDG"
              MOVE "S" TO ICE-IND-PROC IN REG-GNSICE01
              REWRITE REG-GNSICE01 INVALID KEY
                      DISPLAY "[ERROR GRABANDO ENTIDAD PROCESADA]".
           MOVE WSS-IND-CORR  TO ENT-NUM-CORR IN REG-GNSICE03.
           MOVE WSS-COD-OPCI  TO ENT-COD-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "OPC"
              IF OPC-CAI-IOPC IN OPC-FLD-EXT > SPACES
                 MOVE OPC-CAI-IOPC IN OPC-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE OPC-IIC-IOPC IN OPC-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-CIC-IOPC TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "DLC"
              MOVE DLC-NUM-IDLC IN DLC-FLD
                                   TO ENT-NUM-ANEX IN REG-GNSICE03
              IF DLC-CAI-IOPC IN DLC-FLD-EXT > SPACES
                 MOVE DLC-CAI-IOPC IN DLC-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE DLC-IIC-IOPC IN DLC-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-CIC-IOPC TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "EVC"
              MOVE EVC-NUM-IEVC IN EVC-FLD
                                   TO ENT-NUM-ANEX IN REG-GNSICE03
              IF EVC-CAI-IOPC IN EVC-FLD-EXT > SPACES
                 MOVE EVC-CAI-IOPC IN EVC-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE EVC-IIC-IOPC IN EVC-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-CIC-IOPC TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "RDC"
              MOVE RDC-NUM-IDLC IN RDC-FLD
                                   TO ENT-NUM-ANEX IN REG-GNSICE03
              IF RDC-CAI-IOPC IN RDC-FLD-EXT > SPACES
                 MOVE RDC-CAI-IOPC IN RDC-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE RDC-IIC-IOPC IN RDC-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-CIC-IOPC TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "RMC"
              IF RMC-CAI-IOPC IN RMC-FLD-EXT > SPACES
                 MOVE RMC-CAI-IOPC IN RMC-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE RMC-IIC-IOPC IN RMC-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-CIC-IOPC TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "DBP"
              MOVE DBC-NUM-ICLI IN DBP-FLD-EXT
                                TO ENT-NUM-ICLI IN REG-GNSICE03
              MOVE DBC-VRF-ICLI IN DBP-FLD-EXT
                                TO ENT-VRF-ICLI IN REG-GNSICE03
              MOVE DBC-IND-ICLI IN DBP-FLD-EXT
                                TO ENT-IND-ICLI IN REG-GNSICE03
              MOVE DBC-GLS-ICLI IN DBP-FLD-EXT
                                TO ENT-GLS-ICLI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "DBE"
              MOVE DBC-NUM-ICLI IN DBE-FLD
                                TO ENT-NUM-ICLI IN REG-GNSICE03
              MOVE DBC-VRF-ICLI IN DBE-FLD
                                TO ENT-VRF-ICLI IN REG-GNSICE03
              MOVE DBC-IND-ICLI IN DBE-FLD
                                TO ENT-IND-ICLI IN REG-GNSICE03
              MOVE DBC-GLS-ICLI IN DBE-FLD
                                TO ENT-GLS-ICLI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "OPE"
              MOVE OPE-CAI-IOPE IN OPE-FLD
                                TO ENT-CAI-ENTI IN REG-GNSICE03
              MOVE OPE-IIC-IOPE IN OPE-FLD
                                TO ENT-IIC-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "DIR"
              MOVE DBC-NUM-ICLI IN DIR-FLD-EXT
                                TO ENT-NUM-ICLI IN REG-GNSICE03
              MOVE DBC-VRF-ICLI IN DIR-FLD-EXT
                                TO ENT-VRF-ICLI IN REG-GNSICE03
              MOVE DBC-IND-ICLI IN DIR-FLD-EXT
                                TO ENT-IND-ICLI IN REG-GNSICE03
              MOVE DBC-GLS-ICLI IN DIR-FLD-EXT
                                TO ENT-GLS-ICLI IN REG-GNSICE03
              MOVE RCD-NUM-DIRE IN DIR-FLD
                                TO ENT-NUM-ANEX IN REG-GNSICE03.
           IF WSS-COD-OPCI = "GDG"
              IF GDG-NUM-SIS  IN GDG-FLD-EXT > SPACES
                 MOVE GDG-NUM-SIS  IN GDG-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE GDG-COD-CRR  IN GDG-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-NUM-GAR  TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "GDD"
              IF GDD-NUM-SIS  IN GDD-FLD-EXT > SPACES
                 MOVE GDD-NUM-SIS  IN GDD-FLD
                                   TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE GDD-COD-CRR  IN GDD-FLD
                                   TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-NUM-GAR  TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "GVT"
              IF GVT-NUM-SIS  IN GVT-FLD-EXT > SPACES
                 MOVE GVT-NUM-SIS IN GVT-FLD
                                  TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE GVT-COD-CRR IN GVT-FLD
                                  TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-NUM-GAR TO ENT-NUM-ENTI IN REG-GNSICE03.
           IF WSS-COD-OPCI = "GSE"
              IF GSE-NUM-SIS  IN GSE-FLD-EXT > SPACES
                 MOVE GSE-NUM-SIS IN GSE-FLD
                                  TO ENT-CAI-ENTI IN REG-GNSICE03
                 MOVE GSE-COD-CRR IN GSE-FLD
                                  TO ENT-IIC-ENTI IN REG-GNSICE03
              ELSE
                 MOVE WSS-NUM-GAR TO ENT-NUM-ENTI IN REG-GNSICE03.
           WRITE REG-GNSICE03 INVALID KEY
                   DISPLAY "[ERROR GRABANDO GNSICE03 EN REG:]"
                   WSS-IND-CORR.
       FIN-GRAB-REG-ING.
      
       COPY GNSBFMSG OF GNS.
      
       COPY GNSBGFEC OF GNS.
       COPY GNSBGHOY OF GNS.
       COPY GNSBHFRM OF GNS.
       COPY GNSBHSYS OF GNS.
       COPY GNSBPFEC OF GNS.
       COPY GNSBPRCK OF GNS.
      
       COPY GNSBBMSG OF GNS.
      *COPY GNSBFMNU OF GNS.
      *COPY GNSBFRPF OF GNS.
       COPY GNSBFTAB OF GNS.
      
       COPY GNSBGDMD OF GNS.
       COPY GNSBGSYS OF GNS.
       COPY GNSBGFRM OF GNS.
       COPY GNSBGQUE OF GNS.
      
      
