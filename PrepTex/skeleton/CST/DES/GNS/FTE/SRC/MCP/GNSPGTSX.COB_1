      $SET LIST LINEINFO SUMMARY ERRORLIST
       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. GNSPGTSX.
       AUTHOR. BEE.
       DATE-WRITTEN.         1-JUN-1998 12:56:29
      *
      * CREA ARCHIVO INDEXADO TSX A PARTIR DE ENTIDAD TSF
      *
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
      
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY GNSW1TSX OF GNS.
      
       DATA DIVISION.
      *==============
      *
       FILE SECTION.
       COPY GNSW2TSX OF GNS.
      
       DATA-BASE SECTION.
       DB  BDCST.
       01  AUDITAREA.
       01  GNSTSF.
      
      *
       WORKING-STORAGE SECTION.
      *------------------------
      *
       77 WSS-TOT-REG     VALUE ZEROES      PIC 9(05).
       COPY GNSWGFEC OF GNS.
       COPY GNSWGHOY OF GNS.
       COPY GNSWGQUE OF GNS.
      
       COPY GNSWGSYS OF GNS.
       COPY GNSWVFIO OF GNS.
       COPY GNSWCFIO OF GNS.
       COPY GNSWSFIO OF GNS.
      
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
       INI-MAIN.
      
           MOVE "N" TO TSF-ES-IDX.
      
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-TSF.
      
           OPEN OUTPUT GNSTSX.
      
           MOVE LOW-VALUES TO TSF.
           MOVE FIO-GET-NLS TO FIO-CMND.
      
       CIC-TSF.
      
           PERFORM GNS-FIO-TSF.
           IF FIO-STAT-OKS
               DISPLAY "PROC REG : " TSF-KEY-IREG
               MOVE TSF TO TSX
               WRITE TSX INVALID KEY DISPLAY
                 "ERROR GRABACION TSX " TSX-KEY-IREG
                  STOP RUN.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-TOT-REG
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-TSF.
      
       FIN-MAIN.
           DISPLAY "FIN DE PROCESO TOTTAL REG. PROCESADOS = "
                    WSS-TOT-REG.
           CLOSE GNSTSX WITH LOCK.
           STOP RUN.
      
       COPY GNSBGDMD OF GNS.
       COPY GNSBGQUE OF GNS.
