      $SET LIST
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPGLOI.
       AUTHOR.          BEE.
       ENVIRONMENT DIVISION.
      *====================
      *
      * GENERA ARCHIVO GNSLOI A PARTIR DE GNSLOT
      * PARA SER DIRECTAMENTE ANALIZADO EN CANDE
      *
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
                DECIMAL-POINT IS COMMA.
      
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSLOT  ASSIGN TO DISK
                 ORGANIZATION IS SEQUENTIAL.
           SELECT GNSLOI  ASSIGN TO DISK
                 ORGANIZATION IS SEQUENTIAL.
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSLOT
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7,
           TITLE IS "*GNS/GNSLOT".
       01  REG-540.
           03 REG-540-FECH                PIC X(009).
           03 REG-540-TERM                PIC X(020).
           03 REG-540-RSTO                PIC X(511).
       FD  GNSLOI
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7,
           BLOCKSIZE IS 6300,
           TITLE IS "*GNS/GNSLOI".
       01  REG-LOI.
           03 REG-LOI-SEP                 PIC X(01).
           03 REG-LOI-IDX                 PIC X(01).
           03 REG-LOI-SPA                 PIC X(01).
           03 REG-LOI-DATA                PIC X(60).
       WORKING-STORAGE SECTION.
      *-----------------------
       01  WSS-REG-540.
           03 WSS-REG-540-1              PIC X(60).
           03 WSS-REG-540-2              PIC X(60).
           03 WSS-REG-540-3              PIC X(60).
           03 WSS-REG-540-4              PIC X(60).
           03 WSS-REG-540-5              PIC X(60).
           03 WSS-REG-540-6              PIC X(60).
           03 WSS-REG-540-7              PIC X(60).
           03 WSS-REG-540-8              PIC X(60).
           03 WSS-REG-540-9              PIC X(60).
       77  WSS-GLS-TERM                  PIC X(20).
       77  WSS-TOT-REG VALUE ZEROES      PIC 9(07).
       77  WSS-TOT-100 VALUE ZEROES      PIC 9(02).
       COPY GNSWVFIO OF GNS.
       COPY GNSWCFIO OF GNS.
       COPY GNSWSFIO OF GNS.
      
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
      *------------
       INI-MAIN.
           MOVE "N" TO FIO-BTRN.
           DISPLAY "INICIO PROGRAMA GNSPGLOI  ".
           PERFORM OPEN-FILE.
           DISPLAY "OPEN OK ARCH GNSLOT GNSLOI ".
           DISPLAY "INGRESE CODIGO TERMINAL A SELECCIONAR".
           ACCEPT WSS-GLS-TERM.
           MOVE "TERMINAL " TO REG-LOI-DATA.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-GLS-TERM TO REG-LOI-DATA.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           PERFORM PROC-LOI.
      
       FIN-MAIN.
           EXIT.
      
       OPEN-FILE SECTION.
      *-----------------
       INI-OPEN-FILE.
           OPEN INPUT  GNSLOT.
           OPEN OUTPUT GNSLOI.
       FIN-OPEN-FILE.
           EXIT.
      
       PROC-LOI SECTION.
       INI-PROC-LOI.
           READ GNSLOT RECORD
            AT END DISPLAY "FIN DE ARCHIVO CON : " WSS-TOT-REG " REGS "
                   PERFORM CLOSE-FILE
                   STOP RUN.
           ADD 1 TO WSS-TOT-REG.
           MOVE WSS-TOT-REG TO WSS-TOT-100.
           IF WSS-TOT-100 = ZEROES
               DISPLAY "PROCESANDO REG NRO : " WSS-TOT-REG.
           IF NOT ( WSS-GLS-TERM = REG-540-TERM OR
                    WSS-GLS-TERM = "*" )
               GO TO INI-PROC-LOI.
           MOVE SPACES TO REG-LOI.
           MOVE
           "123456789*123456789*123456789*123456789*123456789*123456789"
           TO REG-LOI-DATA.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE REG-540 TO WSS-REG-540.
           MOVE WSS-REG-540-1 TO REG-LOI-DATA.
           MOVE 1 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-2 TO REG-LOI-DATA.
           MOVE 2 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-3 TO REG-LOI-DATA.
           MOVE 3 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-4 TO REG-LOI-DATA.
           MOVE 4 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-5 TO REG-LOI-DATA.
           MOVE 5 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-6 TO REG-LOI-DATA.
           MOVE 6 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-7 TO REG-LOI-DATA.
           MOVE 7 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-8 TO REG-LOI-DATA.
           MOVE 8 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
           MOVE WSS-REG-540-9 TO REG-LOI-DATA.
           MOVE 9 TO REG-LOI-IDX.
           WRITE REG-LOI
              INVALID KEY DISPLAY "ERROR WRITE LOI".
              GO TO INI-PROC-LOI.
       FIN-PROC-LOI.
           EXIT.
      
       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           CLOSE GNSLOT WITH LOCK.
           CLOSE GNSLOI WITH LOCK.
       FIN-CLOSE-FILE.
           EXIT.
      
