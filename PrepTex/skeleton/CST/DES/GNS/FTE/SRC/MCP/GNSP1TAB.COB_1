      *$ASCII
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSP1TAB.
       AUTHOR.          CONSIST.
      * 
       ENVIRONMENT DIVISION.
      *====================
      *
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSTAS ASSIGN TO 'C:GNSMTAB.SEQ[U194]'
                  ORGANIZATION   IS SEQUENTIAL
                  ACCESS MODE    IS SEQUENTIAL
                  FILE STATUS    IS FIO-STAT.
      *
       CONFIGURATION SECTION.
      *---------------------
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD GNSTAS 
           LABEL RECORDS STANDARD
           RECORD CONTAINS 194.
      *
       COPY GNSBRTAS.
      *
       WORKING-STORAGE SECTION.
      *-----------------------
      *<<<< WSS
       01  WSS-I       VALUE ZEROES PIC 9(06).
      * WORKING PARA RUTINAS.
       COPY GNSWGSYS.
      * COPY GNSWGFEC.
      * COPY GNSWGHOY.
       COPY GNSWCFIO.
       COPY GNSWVFIO.

       COPY GNSBRTAB.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.
           PERFORM OPN-FILE.
           PERFORM PRO-FILE.
           PERFORM CLO-FILE.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       OPN-FILE SECTION.
      *------------------
       INI-OPE-FILE.
           OPEN OUTPUT GNSTAS.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO OUTPUT GNSTAS FS ' 
                        FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO INPUT  GNSTAB FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.
      *
       FIN-OPN-FILE.
           EXIT.

       PRO-FILE SECTION.
      *----------------------
       INI-PRO-FILE.
           MOVE ZEROES       TO WSS-I.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO EXISTE PRIMER REGISTRO'
              DISPLAY 'ABORTO'
              STOP RUN.
           PERFORM TAB-TRS-TAS UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FILE.
           EXIT.

       TAB-TRS-TAS SECTION.
       INI-TAB-TRS-TAS.
      *GRABA TAS DESDE TAB.
           ADD  1   TO WSS-I.
      *
           MOVE CORR TAB TO TAS.

           MOVE SPACES TO TAB-GLS-FLAG IN TAS.
           IF TAB-NUM-STRN IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-STRN IN TAS.
           IF TAB-NUM-ATRN IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-ATRN IN TAS.
           IF TAB-NUM-MTRN IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-MTRN IN TAS.
           IF TAB-NUM-DTRN IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-DTRN IN TAS.
           IF TAB-NUM-HHTR IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-HHTR IN TAS.
           IF TAB-NUM-MMTR IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-MMTR IN TAS.
           IF TAB-NUM-SSTR IN TAS NOT > ZEROES
               MOVE ZEROES TO TAB-NUM-SSTR IN TAS.

           IF  TAB-MSC-TACC IN TAS NOT > SPACES
               MOVE SPACES TO TAB-MSC-TACC IN TAS.
           IF  TAB-MSC-STAT IN TAS NOT > SPACES
               MOVE SPACES TO TAB-MSC-STAT IN TAS.
           IF  TAB-COD-OTRN IN TAS NOT > SPACES
               MOVE SPACES TO TAB-COD-OTRN IN TAS.
           IF  TAB-COD-ATRN IN TAS NOT > SPACES
               MOVE SPACES TO TAB-COD-ATRN IN TAS.
           IF  TAB-CIC-TABL IN TAS NOT > SPACES
               MOVE SPACES TO TAB-CIC-TABL IN TAS.
           IF  TAB-EXT-TABL IN TAS NOT > SPACES
               MOVE SPACES TO TAB-EXT-TABL IN TAS.
           IF  TAB-GLS-DCOR IN TAS NOT > SPACES
               MOVE SPACES TO TAB-GLS-DCOR IN TAS.
           IF  TAB-GLS-ABRV IN TAS NOT > SPACES
               MOVE SPACES TO TAB-GLS-ABRV IN TAS.
           IF  TAB-GLS-DESC IN TAS NOT > SPACES
               MOVE SPACES TO TAB-GLS-DESC IN TAS.
           IF  TAB-GLS-DATA IN TAS NOT > SPACES
               MOVE SPACES TO TAB-GLS-DATA IN TAS.
           IF  TAB-SNX-TABL IN TAS NOT > SPACES
               MOVE SPACES TO TAB-SNX-TABL IN TAS.

           WRITE TAS.
      *
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM GNS-FIO-TAB.
       FIN-TAB-TRS-TAS.
           EXIT.

       CLO-FILE SECTION.
      *------------------
       INI-CLO-FILE.
           DISPLAY 'NRO. REG. TRASPASADOS :' WSS-I.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *
           CLOSE GNSTAS.
      *
       FIN-CLO-FILE.
           EXIT.

      * RUTINAS
       COPY GNSBBSYS.
      * COPY GNSBGEND.

       COPY GNSBFTAB.

