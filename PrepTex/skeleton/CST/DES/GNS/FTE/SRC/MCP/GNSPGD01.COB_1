      $SET LIST
      $SET LINEINFO SUMMARY ERRORLIST
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPGD01.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.     19-JAN-1998 16:31:12.
      *
      * Programa que lee archivo GNSICE01
      * y lo despliega en pantalla.
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT GNSICE01 ASSIGN TO DISK
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  RECORD KEY IS ICE-NUM-CORR.
      
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  GNSICE01
           LABEL RECORD ARE STANDARD
           VALUE OF FILETYPE IS 7.
       01  REG-GNSICE01.
           03  ICE-NUM-CORR                        PIC X(09).
           03  ICE-IND-PROC                        PIC X(01).
           03  ICE-COD-ENTI                        PIC X(03).
           03  ICE-FLS-MENS                        PIC X(500).
      
       DATA-BASE SECTION.
      *DB BDCST.
      *01 AUDITAREA.
      *01 GNSTAB.
      
       WORKING-STORAGE SECTION.
      *---------------------
       01  INI-MSG.
           03 MSK-BCOHDR-FLD.
              05 FILLER                   PIC X(01) VALUE @0C@.
              05 FILLER                   PIC X(04) VALUE @277F4040@.
      
      
       COPY GNSWCFIO OF GNS.
       COPY GNSWVFIO OF GNS.
       COPY GNSWSFIO OF GNS.
       COPY GNSWGDRC OF GNS.
       COPY GNSBRTAB OF GNS.
       COPY GNSWRTAB OF GNS.
       COPY GNSBRMSG OF GNS.
       COPY GNSWRMSG OF GNS.
      
       01  WSS-ICE.
           03  WSS-NUM-CORR                 PIC X(09).
           03  WSS-IND-PROC                 PIC X(01).
           03  WSS-COD-ENTI                 PIC X(03).
           03  WSS-FLS-MENS                 PIC X(500).
      
       01  WSS-IND                          PIC 9(05).
       01  WSS-VAR                          PIC X(30).
      
       LOCAL-STORAGE SECTION.
       LD  LDV-VARI.
      
       PROCEDURE DIVISION.
      *==================
      
       MAIN SECTION.
       INI-MAIN.
           PERFORM OPEN-FILE.
           MOVE 0 TO WSS-IND.
           MOVE ZEROES TO ICE-NUM-CORR.
           START GNSICE01 KEY IS NOT < ICE-NUM-CORR
                 INVALID KEY DISPLAY "[ERROR EN START GNSICE01]"
                 GO TO FIN-MAIN.
           READ GNSICE01 NEXT RECORD
                 AT END      DISPLAY "[ERROR EN NEXT  GNSICE01]"
                             GO TO FIN-MAIN.
           MOVE REG-GNSICE01 TO WSS-ICE.
           DISPLAY INI-MSG.
       LUP-MAIN.
           IF WSS-IND = 5
                 MOVE 0 TO WSS-IND
                 ACCEPT WSS-VAR
                 DISPLAY INI-MSG.
           DISPLAY "[CLAVE REGISTRO]:" WSS-NUM-CORR.
           DISPLAY "[PROCESADO S/N ]:" WSS-IND-PROC.
           DISPLAY "[ENTIDAD       ]:" WSS-COD-ENTI.
           DISPLAY "*****************************************".
           ADD 1 TO WSS-IND.
           READ GNSICE01 NEXT RECORD
                 AT END      DISPLAY "[EOF ARCHIVO GNSICE01]"
                             GO TO FIN-MAIN.
           MOVE REG-GNSICE01 TO WSS-ICE.
           GO TO LUP-MAIN.
        FIN-MAIN.
           GO TO INI-CLOSE-FILE.
           EXIT PROGRAM.
      
       OPEN-FILE SECTION.
       INI-OPEN-FILE.
           OPEN INPUT GNSICE01.
       FIN-OPEN-FILE.
           EXIT.
      
       CLOSE-FILE SECTION.
       INI-CLOSE-FILE.
           CLOSE GNSICE01 WITH LOCK.
           STOP RUN.
       FIN-CLOSE-FILE.
           EXIT PROGRAM.
      
      
      *COPY GNSBGDMD OF GNS.
      *COPY GNSBFTAB OF GNS.
      *COPY GNSBBTAB OF GNS.
      *COPY GNSBFMSG OF GNS.
      *COPY GNSBBMSG OF GNS.
      
      
