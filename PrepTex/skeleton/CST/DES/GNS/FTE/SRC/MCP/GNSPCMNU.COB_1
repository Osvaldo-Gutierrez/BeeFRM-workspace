      $SET LIST
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPCMNU.
       AUTHOR.          CONSIST.
      *
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       INPUT-OUTPUT SECTION.
      *---------------------
       FILE-CONTROL.
           SELECT ARCH-MNU ASSIGN TO DISK.
       DATA DIVISION.
      *=============
       FILE SECTION.
      *-------------
       FD  ARCH-MNU
           LABEL RECORD ARE STANDARD
           DATA RECORD IS MNU.
      *    RECORD  CONTAINS 490 CHARACTERS.
      *    Archivo de Menu OLD
      *    ---------------
      *
      *    Nombre Registro : MNU
      *    Clave(s)        : MNU-COD-NEMO(UU),MNU-COD-OPCI(UC),
      *                      MNU-COD-IMEN(UC)
      *    Largo           : 490
      *    Bloqueo         : 1
      *    Observaciones   :
      *
       01  MNU.
      *
      *       Filler Compatibilidad VSAM/MVS
           03 MNU-GLS-FLAG                              PIC X(01).
      *
      *       Llave primaria nemotecnica
           03 MNU-COD-NEMO.
      *
      *          Sistema
              05 MNU-COD-SYST                           PIC X(03).
      *
      *          Codigo accion
              05 MNU-COD-CACC                           PIC X(03).
      *
      *          Codigo de Funcion
              05 MNU-COD-FUNC.
      *
      *             Entidad
                 07 MNU-COD-ENTI                        PIC X(03).
      *
      *             Comando
                 07 MNU-COD-COMD                        PIC X(03).
      *
      *       Llave secundaria 1: Opcion
           03 MNU-COD-OPCI                              PIC X(03).
      *
      *       Llave secundaria 2: Menu + Ordinal
           03 MNU-COD-IMEN.
      *
      *          Codigo menu
              05 MNU-COD-CMEN                           PIC X(03).
      *
      *          Ordinal
              05 MNU-NUM-ORDI                           PIC 9(03).
      *
      *       Tipo funcion
           03 MNU-COD-TFUN                              PIC X(03).
      *
      *       Glosa funcion menu
           03 MNU-GLS-FMEN                              PIC X(30).
      *
      *       Comando
           03 MNU-GLS-CMND.
      *
      *          Prefijo comando
              05 MNU-GLS-COMD                           PIC X(12).
      *
      *          Programa
              05 MNU-GLS-PROG                           PIC X(12).
      *
      *          Resto comando
              05 FILLER                                 PIC X(29).
      *
      *       Transaccion
           03 MNU-GLS-TRAN                              PIC X(04).
      *
      *       Comando ingreso programa
           03 MNU-COD-CMND                              PIC X(03).
      *
      *       Biblioteca documentacion.
           03 MNU-GLS-LDOC                              PIC X(07).
      *
      *       Nombre modulo documentacion
           03 MNU-GLS-NDOC                              PIC X(24).
      *
      *       Biblioteca formulario
           03 MNU-GLS-LFRM                              PIC X(07).
      *
      *       Nombre formulario
           03 MNU-GLS-NFRM                              PIC X(07).
      *
      *       Glosa funcion programa
           03 MNU-GLS-FPRO                              PIC X(30).
      *
      *       Fila
           03 MNU-NUM-FILA                              PIC 9(02).
      *
      *       Columna
           03 MNU-NUM-COLU                              PIC 9(02).
      *
      *       Funcion retorno  (default)
           03 MNU-COD-FRET                              PIC X(12).
      *
      *       Indicador confirmacion
           03 MNU-IND-CONF                              PIC X(01).
      *
      *       Menu
           03 MNU-COD-MENU                              PIC X(03).
      *
      *       Indicador de privilegios
           03 MNU-IND-IPRV                              PIC X(01).
      *
      *       Instancia ingreso programa
           03 MNU-COD-INST                              PIC X(03).
      *
      *       Indicador si expande o no glosa de menu
           03 MNU-IND-EXGL                              PIC X(01).
      *
      *       Indicador transferencia de control
           03 MNU-IND-SEQU                              PIC X(03).
      *
      *       Sistema
           03 MNU-COD-SIST                              PIC X(03).
      *
      *       Codigo de traspaso de control al programa
           03 MNU-COD-TCTL                              PIC X(04).
      *
      *       Accion a ejecutar sobre formulario
           03 MNU-COD-EJFR                              PIC X(03).
      *
      *       Funcion anterior
           03 MNU-COD-FANT                              PIC X(12).
      *
      *       Codigo Tabla
           03 MNU-COD-TABL.
              05 MNU-COD-TTAB                           PIC X(03).
              05 MNU-COD-CTAB                           PIC X(12).
      *
      *       Indicador clear
           03 MNU-IND-NCLR                              PIC X(01).
      *
      *       Biblioteca formulario para VAX
           03 MNU-GLS-LFVX                              PIC X(07).
      *
      *       Nombre formulario para VAX
           03 MNU-GLS-NFVX                              PIC X(07).
      *
      *       Programa
           03 MNU-GLS-PRGM                              PIC X(08).
      *
      *       Independencia Fisica Datos
           03 MNU-COD-CIFD                              PIC X(12).
      *
      *       Codigo de traspaso de informacion al programa
           03 MNU-COD-TINF                              PIC X(03).
      *
      *       Modalidad de Salida del programa
           03 MNU-COD-MSAL                              PIC X(03).
      *
      *       Accion a ejecutar con pantalla
           03 MNU-COD-ASCR                              PIC X(01).
      *
      *       Accion a ejecutar con mapa programa
           03 MNU-COD-AMPG                              PIC X(01).
      *
      *       Nombre Mapa Header
           03 MNU-GLS-NMHD                              PIC X(07).
      *
      *       Libreria Mapa Header
           03 MNU-GLS-LMHD                              PIC X(07).
      *
      *       Accion a ejecutar con mapa header
           03 MNU-COD-AMHD                              PIC X(01).
      *
      *       Nombre Mapa Comandos
           03 MNU-GLS-NMCM                              PIC X(07).
      *
      *       Libreria Mapa Comandos
           03 MNU-GLS-LMCM                              PIC X(07).
      *
      *       Accion a ejecutar con Mapa comandos
           03 MNU-COD-AMCM                              PIC X(01).
      *
      *       Disponible Futuras Ampliaciones
           03 MNU-GLS-DISP                              PIC X(162).


       WORKING-STORAGE SECTION.
      *-----------------------
       77  AAA               VALUE ZEROES PIC 9(02).
       77  BBB               VALUE ZEROES PIC 9(02).
      *<<<< WSS
      *    Archivo de Menu
      *    ---------------
      *
      *    Nombre Registro : MNO
      *    Clave(s)        : MNU-COD-NEMS(UU),MNU-COD-OPCS(UC),
      *                      MNU-COD-IMES(UC)
      *    Largo           : 490
      *    Bloqueo         : 1
      *    Observaciones   :
      *
       01  MNO.
      *
      *       Filler Compatibilidad VSAM/MVS
           03 MNU-GLS-FLAG                              PIC X(01).
      *
      *       Llave primaria nemotecnica
           03 MNU-COD-NEMS.
      *
      *          Sistema al que pertenece funcion
              05 MNU-COD-SISF                           PIC X(03).
      *
      *       Llave primaria nemotecnica OLD
              05 MNU-COD-NEMO.
      *
      *          Sistema
                 07 MNU-COD-SYST                        PIC X(03).
      *
      *          Codigo accion
                 07 MNU-COD-CACC                        PIC X(03).
      *
      *          Codigo de Funcion
                 07 MNU-COD-FUNC.
      *
      *             Entidad
                    09 MNU-COD-ENTI                     PIC X(03).
      *
      *             Comando
                    09 MNU-COD-COMD                     PIC X(03).
      *
           03 MNU-COD-OPCS.
      *
      *          Sistema al que pertenece opcion
              05 MNU-COD-SISO                           PIC X(03).
      *
              05 MNU-COD-IPCN.
      *       Llave secundaria 1: Opcion
                 07 MNU-COD-OPCI                        PIC X(03).
      *
      *       Llave secundaria 2: Menu + Ordinal
           03 MNU-COD-IMES.
      *
      *          Sistema menu-correlativo
              05 MNU-COD-SISM                           PIC X(03).
      *
              05 MNU-COD-IMEN.
      *            Codigo menu
                 07 MNU-COD-CMEN                        PIC X(03).
      *
      *            Ordinal
                 07 MNU-NUM-ORDI                        PIC 9(03).
      *
      *       Tipo funcion
           03 MNU-COD-TFUN                              PIC X(03).
      *
      *       Glosa funcion menu
           03 MNU-GLS-FMEN                              PIC X(30).
      *
      *       Comando
           03 MNU-GLS-CMND.
      *
      *          Prefijo comando
              05 MNU-GLS-COMD                           PIC X(12).
      *
      *          Programa
              05 MNU-GLS-PROG                           PIC X(12).
      *
      *          Resto comando
              05 FILLER                                 PIC X(29).
      *
      *       Transaccion
           03 MNU-GLS-TRAN                              PIC X(04).
      *
      *       Comando ingreso programa
           03 MNU-COD-CMND                              PIC X(03).
      *
      *       Biblioteca documentacion.
           03 MNU-GLS-LDOC                              PIC X(07).
      *
      *       Nombre modulo documentacion
           03 MNU-GLS-NDOC                              PIC X(24).
      *
      *       Biblioteca formulario
           03 MNU-GLS-LFRM                              PIC X(07).
      *
      *       Nombre formulario
           03 MNU-GLS-NFRM                              PIC X(07).
      *
      *       Glosa funcion programa
           03 MNU-GLS-FPRO                              PIC X(30).
      *
      *       Fila
           03 MNU-NUM-FILA                              PIC 9(02).
      *
      *       Columna
           03 MNU-NUM-COLU                              PIC 9(02).
      *
      *       Funcion retorno  (default)
           03 MNU-COD-FRET                              PIC X(12).
      *
      *       Indicador confirmacion
           03 MNU-IND-CONF                              PIC X(01).
      *
      *       Menu
           03 MNU-COD-MENU                              PIC X(03).
      *
      *       Indicador de privilegios
           03 MNU-IND-IPRV                              PIC X(01).
      *
      *       Instancia ingreso programa
           03 MNU-COD-INST                              PIC X(03).
      *
      *       Indicador si expande o no glosa de menu
           03 MNU-IND-EXGL                              PIC X(01).
      *
      *       Indicador transferencia de control
           03 MNU-IND-SEQU                              PIC X(03).
      *
      *       Sistema
           03 MNU-COD-SIST                              PIC X(03).
      *
      *       Codigo de traspaso de control al programa
           03 MNU-COD-TCTL                              PIC X(04).
      *
      *       Accion a ejecutar sobre formulario
           03 MNU-COD-EJFR                              PIC X(03).
      *
      *       Funcion anterior
           03 MNU-COD-FANT                              PIC X(12).
      *
      *       Codigo Tabla
           03 MNU-COD-TABL.
              05 MNU-COD-TTAB                           PIC X(03).
              05 MNU-COD-CTAB                           PIC X(12).
      *
      *       Indicador clear
           03 MNU-IND-NCLR                              PIC X(01).
      *
      *       Biblioteca formulario para VAX
           03 MNU-GLS-LFVX                              PIC X(07).
      *
      *       Nombre formulario para VAX
           03 MNU-GLS-NFVX                              PIC X(07).
      *
      *       Programa
           03 MNU-GLS-PRGM                              PIC X(08).
      *
      *       Independencia Fisica Datos
           03 MNU-COD-CIFD                              PIC X(12).
      *
      *       Codigo de traspaso de informacion al programa
           03 MNU-COD-TINF                              PIC X(03).
      *
      *       Modalidad de Salida del programa
           03 MNU-COD-MSAL                              PIC X(03).
      *
      *       Accion a ejecutar con pantalla
           03 MNU-COD-ASCR                              PIC X(01).
      *
      *       Accion a ejecutar con mapa programa
           03 MNU-COD-AMPG                              PIC X(01).
      *
      *       Nombre Mapa Header
           03 MNU-GLS-NMHD                              PIC X(07).
      *
      *       Libreria Mapa Header
           03 MNU-GLS-LMHD                              PIC X(07).
      *
      *       Accion a ejecutar con mapa header
           03 MNU-COD-AMHD                              PIC X(01).
      *
      *       Nombre Mapa Comandos
           03 MNU-GLS-NMCM                              PIC X(07).
      *
      *       Libreria Mapa Comandos
           03 MNU-GLS-LMCM                              PIC X(07).
      *
      *       Accion a ejecutar con Mapa comandos
           03 MNU-COD-AMCM                              PIC X(01).
      *
      *       Disponible Futuras Ampliaciones
           03 MNU-GLS-DISP                              PIC X(153).

      * WORKING PARA RUTINAS.
       COPY GNSWSFIO.
       COPY GNSWCFIO.
       COPY GNSWVFIO.

       01  WSS-COD-SIST               PIC X(03).
       01  WSS-TOT-REG                                    PIC 9(06).
       01  WSS-TOT-REG-RNG                                PIC 9(02).
       01  WSS-TOT-REG-100                                PIC 9(06).

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
      *------------
       INI-MAIN.

           DISPLAY 'INGRESE SISTEMA '.
           ACCEPT WSS-COD-SIST.

           IF WSS-COD-SIST = 'ELI'
               MOVE ZEROES       TO WSS-TOT-REG
               MOVE '00'         TO FIO-STAT
               PERFORM DEL-MNO UNTIL NOT FIO-STAT-OKS
               EXIT PROGRAM.

           PERFORM OPN-FILE.
           PERFORM PRO-FILE.
           PERFORM CLO-FILE.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       OPN-FILE SECTION.
      *------------------
       INI-OPE-FILE.
      *
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO INPUT  GNSMNU FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-MNO.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA TABLA OUTPUT  GNSMNO FS '
                       FIO-STAT
               DISPLAY 'ABORTO'
               STOP RUN.

       FIN-OPN-FILE.
           EXIT.

       PRO-FILE SECTION.
      *----------------------
       INI-PRO-FILE.
           MOVE ZEROES       TO WSS-TOT-REG
                                WSS-TOT-REG-RNG
                                WSS-TOT-REG-100.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               DISPLAY ' ERROR FST-MNU '
               STOP RUN.
           PERFORM MNU-TRS-MNO UNTIL NOT FIO-STAT-OKS.
       FIN-PRO-FILE.
           EXIT.

       MNU-TRS-MNO SECTION.
       INI-MNU-TRS-MNO.
      *GRABA MNO DESDE MNU.
           ADD  1   TO WSS-TOT-REG.
           MOVE WSS-TOT-REG TO WSS-TOT-REG-RNG.
      *    IF WSS-TOT-REG = 5
      *         COMPUTE AAA = 6 / BBB.
           IF WSS-TOT-REG-RNG = ZEROES
               ADD 100 TO WSS-TOT-REG-100
               DISPLAY 'REGISTRO INGRESADO ' WSS-TOT-REG-100
               DISPLAY MNO.
      *
           MOVE SPACES              TO MNO.
      *    DISPLAY 'NEMO #' MNU-COD-NEMO IN MNU '&'.
      *    DISPLAY 'OPCI #' MNU-COD-OPCI IN MNU '&'.
      *    DISPLAY 'IMEN #' MNU-COD-IMEN IN MNU '&'.
      *    DISPLAY 'TFUN #' MNU-COD-TFUN IN MNU '&'.
      *    DISPLAY 'FMEN #' MNU-GLS-FMEN IN MNU '&'.
      *    DISPLAY 'FPRO #' MNU-GLS-FPRO IN MNU '&'.
      *    DISPLAY 'FRET #' MNU-COD-FRET IN MNU '&'.
      *    DISPLAY 'PRGM #' MNU-GLS-PRGM IN MNU '&'.

           MOVE  MNU-COD-NEMO IN MNU TO MNU-COD-NEMO IN MNO.
           MOVE  MNU-COD-OPCI IN MNU TO MNU-COD-OPCI IN MNO.
           MOVE  MNU-COD-IMEN IN MNU TO MNU-COD-IMEN IN MNO.

           MOVE  MNU-COD-TFUN IN MNU TO MNU-COD-TFUN IN MNO.
           MOVE  MNU-GLS-FMEN IN MNU TO MNU-GLS-FMEN IN MNO.
           MOVE  MNU-GLS-COMD IN MNU TO MNU-GLS-COMD IN MNO.
           MOVE  MNU-GLS-PROG IN MNU TO MNU-GLS-PROG IN MNO.
           MOVE  MNU-GLS-TRAN IN MNU TO MNU-GLS-TRAN IN MNO.
           MOVE  MNU-COD-CMND IN MNU TO MNU-COD-CMND IN MNO.
           MOVE  MNU-GLS-LDOC IN MNU TO MNU-GLS-LDOC IN MNO.
           MOVE  MNU-GLS-NDOC IN MNU TO MNU-GLS-NDOC IN MNO.
           MOVE  MNU-GLS-LFRM IN MNU TO MNU-GLS-LFRM IN MNO.
           MOVE  MNU-GLS-NFRM IN MNU TO MNU-GLS-NFRM IN MNO.
           MOVE  MNU-GLS-FPRO IN MNU TO MNU-GLS-FPRO IN MNO.
           MOVE  MNU-NUM-FILA IN MNU TO MNU-NUM-FILA IN MNO.
           MOVE  MNU-NUM-COLU IN MNU TO MNU-NUM-COLU IN MNO.
           MOVE  MNU-COD-FRET IN MNU TO MNU-COD-FRET IN MNO.
           MOVE  MNU-IND-CONF IN MNU TO MNU-IND-CONF IN MNO.
           MOVE  MNU-COD-MENU IN MNU TO MNU-COD-MENU IN MNO.
           MOVE  MNU-IND-IPRV IN MNU TO MNU-IND-IPRV IN MNO.
           MOVE  MNU-COD-INST IN MNU TO MNU-COD-INST IN MNO.
           MOVE  MNU-IND-EXGL IN MNU TO MNU-IND-EXGL IN MNO.
           MOVE  MNU-IND-SEQU IN MNU TO MNU-IND-SEQU IN MNO.
           MOVE  MNU-COD-SIST IN MNU TO MNU-COD-SIST IN MNO.
           MOVE  MNU-COD-TCTL IN MNU TO MNU-COD-TCTL IN MNO.
           MOVE  MNU-COD-EJFR IN MNU TO MNU-COD-EJFR IN MNO.
           MOVE  MNU-COD-FANT IN MNU TO MNU-COD-FANT IN MNO.
           MOVE  MNU-COD-TTAB IN MNU TO MNU-COD-TTAB IN MNO.
           MOVE  MNU-COD-CTAB IN MNU TO MNU-COD-CTAB IN MNO.
           MOVE  MNU-IND-NCLR IN MNU TO MNU-IND-NCLR IN MNO.
           MOVE  MNU-GLS-LFVX IN MNU TO MNU-GLS-LFVX IN MNO.
           MOVE  MNU-GLS-NFVX IN MNU TO MNU-GLS-NFVX IN MNO.
           MOVE  MNU-GLS-PRGM IN MNU TO MNU-GLS-PRGM IN MNO.
           MOVE  MNU-COD-CIFD IN MNU TO MNU-COD-CIFD IN MNO.
           MOVE  MNU-COD-TINF IN MNU TO MNU-COD-TINF IN MNO.
           MOVE  MNU-COD-MSAL IN MNU TO MNU-COD-MSAL IN MNO.
           MOVE  MNU-COD-ASCR IN MNU TO MNU-COD-ASCR IN MNO.
           MOVE  MNU-COD-AMPG IN MNU TO MNU-COD-AMPG IN MNO.
           MOVE  MNU-GLS-NMHD IN MNU TO MNU-GLS-NMHD IN MNO.
           MOVE  MNU-GLS-LMHD IN MNU TO MNU-GLS-LMHD IN MNO.
           MOVE  MNU-COD-AMHD IN MNU TO MNU-COD-AMHD IN MNO.
           MOVE  MNU-GLS-NMCM IN MNU TO MNU-GLS-NMCM IN MNO.
           MOVE  MNU-GLS-LMCM IN MNU TO MNU-GLS-LMCM IN MNO.
           MOVE  MNU-COD-AMCM IN MNU TO MNU-COD-AMCM IN MNO.

           MOVE SPACES  TO MNU-GLS-DISP IN MNO.

           MOVE WSS-COD-SIST TO MNU-COD-SISF IN MNO
                         MNU-COD-SISO IN MNO
                         MNU-COD-SISM IN MNO.
      *    DISPLAY 'MNO ' MNO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-MNO.
           IF NOT FIO-STAT-OKS
               DISPLAY 'RESULT PUT '  FIO-STAT.

           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM GNS-FIO-MNU.
       FIN-MNU-TRS-MNO.
           EXIT.

       CLO-FILE SECTION.
      *------------------
       INI-CLO-FILE.
           DISPLAY 'NRO. REG. TRASPASADOS :' WSS-TOT-REG.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
      *    PERFORM GNS-FIO-MNO.
      *
      *
       FIN-CLO-FILE.
           EXIT.

      * RUTINAS

      * Modulo FIO para archivo VSB GNSMNU,   10-MAY-1994 17:21:37
       GNS-FIO-MNU SECTION.
       INI-GNS-FIO-MNU.
           MOVE '00' TO FIO-STAT.
      *    Abrir archivo secuencial
           IF FIO-CMND = FIO-INP
              OPEN INPUT ARCH-MNU.
      *    Leer primer registro
           IF FIO-CMND = FIO-GET-FST
              READ ARCH-MNU AT END MOVE '23' TO FIO-STAT.
      *    Leer proximo registro
           IF FIO-CMND = FIO-GET-NXT
              READ ARCH-MNU AT END MOVE '23' TO FIO-STAT.
      *    Cerrar archivo secuencial
           IF FIO-CMND = FIO-CLO
              CLOSE ARCH-MNU.
      *    DISPLAY 'LEE ' FIO-STAT.
       FIN-GNS-FIO-MNU.
           EXIT.

       GNS-FIO-MNO SECTION.
       INI-GNS-FIO-MNO.
           MOVE '00' TO FIO-STAT.
           IF FIO-AKEY = 'MNU-COD-NEMO' OR FIO-AKEY NOT > SPACES
               MOVE 'MNU-COD-NEMS' TO FIO-AKEY
           ELSE
           IF FIO-AKEY = 'MNU-COD-OPCI'
               MOVE 'MNU-COD-OPCS' TO FIO-AKEY
           ELSE
           IF FIO-AKEY = 'MNU-COD-IMEN'
               MOVE 'MNU-COD-IMES' TO FIO-AKEY.
           CALL 'GNSPFMNU IN OBJECT/GNSPFMNU'
                                 USING FIO-VARI MNO.
           MOVE FIO-STAT-LNK TO FIO-STAT.
      *    IF NOT ( FIO-SIST = MNU-COD-SISF IN MNO AND
      *             FIO-SIST = MNU-COD-SISO IN MNO AND
      *             FIO-SIST = MNU-COD-SISM IN MNO )
      *           MOVE '23' TO FIO-STAT.
       FIN-GNS-FIO-MNO.
           EXIT.

       DEL-MNO SECTION.
      *----------------
       INI-DEL-MNO.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM GNS-FIO-MNO.
           IF NOT FIO-STAT-OKS
                DISPLAY 'NRO. REG. BORRADOS :' WSS-TOT-REG
                EXIT PROGRAM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-MNO
           IF NOT FIO-STAT-OKS
                DISPLAY 'ERROR GRAVE..... ABORTO'
                DISPLAY 'NRO. REG. BORRADOS :' WSS-TOT-REG
                EXIT PROGRAM
           ELSE
                MOVE FIO-DEL TO FIO-CMND
                PERFORM GNS-FIO-MNO.
       FIN-DEL-MNO.
           EXIT.
