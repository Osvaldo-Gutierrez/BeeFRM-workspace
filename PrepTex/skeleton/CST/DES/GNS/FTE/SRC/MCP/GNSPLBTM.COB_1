      $SET LIST
       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      GNSPLBTM.
       AUTHOR.          BEE.
       ENVIRONMENT DIVISION.
      * LISTA TABLA ESPECIFICA PARA REVISAR LLAVES ( CIC DUPLICADO )
      
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
                DECIMAL-POINT IS COMMA.
      
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       DATA DIVISION.
      *=============
       FILE SECTION.
       DATA-BASE SECTION.
       DB BDCST.
       01  AUDITAREA.
       01  GNSTAB.
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWCFIO OF GNS.
       COPY GNSWVFIO OF GNS.
       COPY GNSWSFIO OF GNS.
       COPY GNSBRTAB OF GNS.
       COPY GNSWRTAB OF GNS.
       01  WSS-GLS-PARM.
           03  WSS-FIO-SIST                    PIC X(03).
           03  WSS-TAB-COD-TTAB                PIC X(03).
       01  WSS-44.
           03 WSS-441     PIC X(04).
           03 WSS-442     PIC X(04).
       77  WSS-TOT-REGS   PIC 9(05)       VALUE ZEROES.
       77  WSS-10         PIC 9(01).
       77  WSS-GLS-AUXI   PIC X(01).
       PROCEDURE DIVISION.
      *===================
      
       MAIN SECTION.
      *------------
       INI-MAIN.
           MOVE "N" TO FIO-BTRN.
           DISPLAY "INICIO PROGRAMA GNSPLBTM  ".
           MOVE FIO-INP TO FIO-CMND.
           MOVE "GNS" TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
                DISPLAY "ERROR APERTURA ARCHIVO TAB"
                STOP RUN.
      
      
           DISPLAY "INGRESE SIST-TTAB".
           ACCEPT WSS-GLS-PARM.
           MOVE SPACES TO TAB.
           MOVE WSS-FIO-SIST TO FIO-SIST.
           MOVE WSS-TAB-COD-TTAB TO TAB-COD-TTAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-MAIN.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-COD-TTAB = WSS-TAB-COD-TTAB )
               DISPLAY "TOT-REGS " WSS-TOT-REGS
               MOVE "GNS" TO FIO-SIST
               MOVE FIO-CLO TO FIO-CMND
               PERFORM GNS-FIO-TAB
               STOP RUN.
           MOVE TAB-COD-CTAB TO WSS-44.
      *    IF WSS-442 = "2002"
      *    IF TAB-GLS-DESC = "SAN JOSE"
           ADD 1 TO WSS-TOT-REGS.
           MOVE WSS-TOT-REGS TO WSS-10
           IF WSS-10 = ZEROES
               DISPLAY "INGRESE NADA PARA CONTINUAR"
               ACCEPT WSS-GLS-AUXI.
           DISPLAY TAB-KY0-TABS "/" TAB-KY1-TABS "/" TAB-KY2-TABS.
      *            TAB-GLS-DESC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.
      
      
       COPY GNSBGDMD OF GNS.
       COPY GNSBFTAB OF GNS.
