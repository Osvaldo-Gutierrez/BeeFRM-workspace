       GNS-FIO-MSG SECTION.
       INI-GNS-FIO-MSG.
           IF IFD-GSIS(1) IS NOT NUMERIC
               PERFORM GNS-FIO-MSG-VSM
           ELSE
               PERFORM GNS-FIO-MSG-DTC.
       FIN-GNS-FIO-MSG.
           EXIT.

      *Modulo FIO interactivo para registro TAB de VSAM, 11-Jan-89 01:00 PM
       GNS-FIO-MSG-VSM SECTION.
       INI-GNS-FIO-MSG-VSM.
      *ISP
           MOVE 'MSG' TO MSG-COD-TTAB IN MSG
                         MSG-CIC-TTAB IN MSG
                         MSG-EXT-TTAB IN MSG
                         MSG-SNX-TTAB IN MSG.
           MOVE 194    TO FIO-RLEN.
           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'MSG-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE MSG-COD-TABL IN MSG TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTAB' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
      *JSS     MOVE 'TAB' TO FIO-FNAM
               MOVE IFD-GSIS(1) TO FIO-FNAM
      *
               MOVE 15     TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'MSG-CIC-TABL'
               MOVE MSG-CIC-TABL IN MSG TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA1' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA1' TO FIO-FNAM
               MOVE 15 TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'MSG-EXT-TABL'
               MOVE MSG-EXT-TABL IN MSG TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA2' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA2' TO FIO-FNAM
               MOVE 8 TO FIO-KLEN
           ELSE
               MOVE 'En GNS-FIO-MSG-VSM, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
           IF FIO-CMND = FIO-PUT OR FIO-MOD
      *ISP
               MOVE MSG-COD-TTAB IN MSG TO MSG-CIC-TTAB IN MSG
                                           MSG-EXT-TTAB IN MSG
                                           MSG-SNX-TTAB IN MSG
               MOVE MSG TO FIO-DFLD.
           PERFORM FIO.
           IF FIO-STAT-OKS AND FIO-IGET-YES
               MOVE FIO-BUF0 TO MSG.
           MOVE SPACES TO FIO-AKEY.
       FIN-GNS-FIO-MSG-VSM.
           EXIT.

      * Modulo FIO para registro MSG en DATACOM
       GNS-FIO-MSG-DTC SECTION.
       INI-GNS-FIO-MSG-DTC.
      *JSS
           MOVE 'MSG' TO MSG-COD-TTAB IN MSG
                         MSG-CIC-TTAB IN MSG
                         MSG-EXT-TTAB IN MSG
                         MSG-SNX-TTAB IN MSG.
      *
           MOVE ADR-MSG-REQA TO ADR-REQA.
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.
      *JSS MOVE IFD-GSIS( 1 ) TO ADR-DBID IN ADR-REQA.
           MOVE FIO-SIST TO IFD-SAUX.
           MOVE 'C'      TO IFD-QAUX.
           MOVE 1 TO IFD-IAUX.
           SET IFD-ITBL TO 1.
           SEARCH IFD-VSIS VARYING IFD-IAUX
               AT END
                   MOVE 'Sistema Invalido en GNS-FIO-MSG-DTC'
                                                          TO FIO-MEN1
                   MOVE IFD-DAUX                          TO FIO-MEN2
                   GO TO PRG-ABT
               WHEN IFD-DSIS( IFD-ITBL ) = IFD-DAUX
                   MOVE IFD-GSIS( IFD-ITBL) TO ADR-DBID IN ADR-REQA.
      *
           MOVE 'TAB00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'MSG-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE MSG-COD-TABL IN MSG TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSG-STP-ITRN'
               MOVE MSG-STP-ITRN IN MSG TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSG-CIC-TABL'
               MOVE MSG-CIC-TABL IN MSG TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSG-EXT-TABL'
               MOVE MSG-EXT-TABL IN MSG TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En GNS-FIO-MSG-DTC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               GO TO PRG-ABT.
      *JSS
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE MSG-COD-TTAB IN MSG TO MSG-CIC-TTAB IN MSG
                                           MSG-EXT-TTAB IN MSG
                                           MSG-SNX-TTAB IN MSG.
      *
           MOVE MSG TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO MSG
           ELSE
      *JSS     MOVE 'GNSMSG' TO FIO-MEN2
               MOVE FIO-SIST TO FIO-MENS-SIS
               MOVE 'TAB'    TO FIO-MENS-REG
      *
               IF FIO-STAT-FTL
                   GO TO PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE ADR-REQA TO ADR-MSG-REQA.
       FIN-GNS-FIO-MSG-DTC.
           EXIT.
