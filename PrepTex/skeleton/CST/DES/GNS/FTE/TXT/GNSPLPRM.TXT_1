*%! Codigo adicional para archivo
*% IF WSS
      *<<<<
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY TABBRUSR.
       COPY GNSBRMSG.
       01  WSS-COD-TABL.
           03 WSS-COD-TTAB                      PIC X(03).
           03 WSS-COD-CTAB                      PIC X(12).
       01  WSS-ACC-TTAB                         PIC X(03).
       01  WSS-ACC-VIGE                         PIC X(01).
       01  WSS-ACC-FEC0.
           03 WSS-ACC-DEC0                      PIC X(02).
           03 WSS-ACC-MEC0                      PIC X(02).
           03 WSS-ACC-SEC0                      PIC X(02).
           03 WSS-ACC-AEC0                      PIC X(02).
       01  WSS-ACC-FEC1.
           03 WSS-ACC-SEC1                      PIC X(02).
           03 WSS-ACC-AEC1                      PIC X(02).
           03 WSS-ACC-MEC1                      PIC X(02).
           03 WSS-ACC-DEC1                      PIC X(02).
       01  WSS-ACC-FEC2.
           03 WSS-ACC-SEC2                      PIC X(02).
           03 WSS-ACC-AEC2                      PIC X(02).
           03 WSS-ACC-MEC2                      PIC X(02).
           03 WSS-ACC-DEC2                      PIC X(02).
      *>>>>
*% END
*% IF INI
           ENTRY 'DBMSCBL'.
*% END
*% IF CF_TAB_WSS_COD_TMSC
      *<<<<
           IF NOT ( TAB-COD-TTAB IN SRT = 'MSC'  AND
                    TAB-COD-CTAB IN SRT > SPACES AND
                    WSS-COD-TMSC IN WSS-TAB > SPACES )
               MOVE 1 TO PRINT-SWITCH.
      *>>>>
*% END
*% IF CF_TAB_WSS_COD_TMSG
      *<<<<
           IF NOT ( TAB-COD-TTAB IN SRT = 'MSG'  AND
                    TAB-COD-CTAB IN SRT > SPACES AND
                    WSS-COD-TMSG IN WSS-TAB > SPACES )
               MOVE 1 TO PRINT-SWITCH.
      *>>>>
*% END
*% IF CF_TAB_TAB_COD_TTAB
      *<<<<
           MOVE 0 TO PAGE-COUNTER.
      *>>>>
*% END
*% IF INI_INP
      *<<<<
           ACCEPT FIO-SIST.
           ACCEPT WSS-ACC-TTAB.
           IF WSS-ACC-TTAB NOT > SPACES
               MOVE '*' TO WSS-ACC-TTAB.
           ACCEPT WSS-ACC-FEC0.
           IF WSS-ACC-FEC0 NOT > SPACES OR
              WSS-ACC-FEC0 = '*'
               MOVE LOW-VALUES TO WSS-ACC-FEC1
           ELSE
              MOVE WSS-ACC-DEC0 TO WSS-ACC-DEC1
              MOVE WSS-ACC-MEC0 TO WSS-ACC-MEC1
              MOVE WSS-ACC-SEC0 TO WSS-ACC-SEC1
              MOVE WSS-ACC-AEC0 TO WSS-ACC-AEC1.
           ACCEPT WSS-ACC-FEC0.
           IF WSS-ACC-FEC0 NOT > SPACES OR
              WSS-ACC-FEC0 = '*'
               MOVE '99999999' TO WSS-ACC-FEC2
           ELSE
              MOVE WSS-ACC-DEC0 TO WSS-ACC-DEC2
              MOVE WSS-ACC-MEC0 TO WSS-ACC-MEC2
              MOVE WSS-ACC-SEC0 TO WSS-ACC-SEC2
              MOVE WSS-ACC-AEC0 TO WSS-ACC-AEC2.
           ACCEPT WSS-ACC-VIGE.
           IF WSS-ACC-VIGE NOT > SPACES
               MOVE '*' TO WSS-ACC-VIGE.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<<
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM FIO-TAB.
           IF WSS-ACC-TTAB NOT = '*'
               MOVE LOW-VALUES TO TAB
               MOVE WSS-ACC-TTAB TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM FIO-TAB.
           GO TO INI-OUT-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<<
           IF TAB-COD-TTAB IN SRT NOT = TAB-COD-TTAB IN TAB
               MOVE SPACES TO TAB-COD-TTAB IN SRT WSS-GLS-DTAB
               USR-GLS-DESC.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<<
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM FIO-TAB.
           GO TO LUP-MAIN.
      *>>>>
*% END
*% IF EOF
      *<<<<
       FIO-TAB SECTION.
       INI-FIO-TAB.
           PERFORM GNS-FIO-PRM.
           IF FIO-CMND NOT = FIO-GET-NXT AND FIO-CMND NOT =
                             FIO-GET-NLS
               GO TO FIN-FIO-TAB.
           IF TAB-COD-TTAB IN TAB NOT = WSS-COD-TTAB
               IF TAB-COD-CTAB IN TAB > SPACES
                   MOVE 'TABLA SIN REGISTRO PADRE' TO WSS-GLS-DTAB
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DTAB.
           MOVE TAB-COD-TABL IN TAB TO WSS-COD-TABL.
           IF ( WSS-ACC-TTAB < TAB-COD-TTAB IN TAB AND
                WSS-ACC-TTAB NOT = '*' ) OR
              NOT FIO-STAT-OKS
                 STOP RUN.
           IF TAB-COD-CTAB IN TAB NOT > SPACES
               PERFORM BUS-RES
               PERFORM TAB-NXT-TAB
               GO TO FIN-FIO-TAB.
           IF NOT ( ( WSS-ACC-TTAB = TAB-COD-TTAB IN TAB     OR
                      WSS-ACC-TTAB = '*'
                    ) AND
                    ( WSS-ACC-VIGE = TAB-IND-VIGE IN TAB     OR
                      WSS-ACC-VIGE = '*'
                    ) AND
                    ( WSS-ACC-FEC1 NOT > TAB-FEC-FUMO IN TAB AND
                      WSS-ACC-FEC2 NOT < TAB-FEC-FUMO IN TAB
                    )
                  )
               GO TO INI-FIO-TAB.
           IF TAB-COD-TTAB IN TAB = 'MSC'
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TMSC IN WSS-TAB.
           IF TAB-COD-TTAB IN TAB = 'MSG'
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TMSG IN WSS-TAB.
       FIN-FIO-TAB.
           EXIT.

       BUS-RES SECTION.
       INI-BUS-RES.
           IF TAB-COD-RESP IN TAB > SPACES
               MOVE TAB-COD-RESP IN TAB TO USR-GLS-DESC IN USR
      *        PERFORM BUS-USR
           ELSE
               MOVE SPACES TO USR-GLS-DESC IN USR.
       FIN-BUS-RES.
           EXIT.

       TAB-NXT-TAB SECTION.
       INI-TAB-NXT-TAB.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-PRM.
           IF TAB-COD-TTAB IN TAB NOT = WSS-COD-TTAB
               MOVE WSS-COD-TABL TO TAB-COD-TABL IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               MOVE SPACES TO TAB
               MOVE WSS-COD-TABL TO TAB-COD-TABL IN TAB.
       FIN-TAB-NXT-TAB.
           EXIT.

       COPY TABBBUSR.
       COPY TABBFUSR.

       COPY GNSBBMSG.
       COPY GNSBFMSG.

       COPY GNSBGDTC.
       COPY GNSIOMSJ.
      *>>>>
*% END
