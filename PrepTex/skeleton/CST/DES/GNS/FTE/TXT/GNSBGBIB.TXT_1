      * Rutina que genera comandos de tabla BIBlioteca
       GEN-BIB SECTION.
       INI-GEN-BIB.
           MOVE 'BIB'    TO TAB-COD-TTAB.
           MOVE BIB-BIBL TO TAB-COD-CTAB.
           MOVE SCR-SISG TO FIO-SIST.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB TO BIB-CTAB.
           IF NOT FIO-STAT-OKS
               GO TO BIB-GEN-BIB.
           IF NOT ( TAB-COD-TTAB IN TAB = 'BIB' AND
                    BIB-TNMB = BIB-BIBL )
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GNS-FIO-TAB
               GO TO BIB-GEN-BIB.
           IF BIB-CNMB NOT > SPACES AND TAB-MSC-STAT IN TAB = 'N'
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GNS-FIO-TAB
               GO TO BIB-GEN-BIB
           ELSE
               GO TO LUP-GEN-BIB.
       BIB-GEN-BIB.
           IF SCR-SISG = BIB-SIST
               GO TO FIN-GEN-BIB.
           MOVE 'BIB'    TO TAB-COD-TTAB.
           MOVE BIB-BIBL TO TAB-COD-CTAB.
           MOVE BIB-SIST TO FIO-SIST.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB TO BIB-CTAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-GEN-BIB.
           IF NOT ( TAB-COD-TTAB IN TAB = 'BIB' AND
                    BIB-TNMB = BIB-BIBL )
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GNS-FIO-TAB
               GO TO FIN-GEN-BIB.
           IF BIB-CNMB NOT > SPACES AND TAB-MSC-STAT IN TAB = 'N'
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GNS-FIO-TAB
               GO TO FIN-GEN-BIB
           ELSE
               GO TO LUP-GEN-BIB.
       LUP-GEN-BIB.
           IF BIB-CNMB NOT > SPACES OR TAB-MSC-STAT IN TAB = 'N'
               GO TO NXT-GEN-BIB.
           MOVE TAB-GLS-DESC TO EDT-STR1.
           MOVE TAB-GLS-DATA TO EDT-STR2.
           IF EDT-SCHR(EDT-MSTR) = 'D' OR 'M'
               MOVE SPACES TO EDT-SCHR(EDT-MSTR)
               PERFORM EDT-CARD
               MOVE EDT-STRN TO QUE-ITEM
               MOVE +80      TO QUE-LITM
               MOVE QUE-PUT  TO QUE-CMND
               MOVE 'S' TO BIB-EXP-BIBL
               PERFORM BIB-PUT-QUE
               PERFORM PUT-DATA
           ELSE
               PERFORM EDT-CARD
               MOVE EDT-STRN TO QUE-ITEM
               MOVE +80      TO QUE-LITM
               MOVE QUE-PUT  TO QUE-CMND
               MOVE 'S' TO BIB-EXP-BIBL
               PERFORM BIB-PUT-QUE.
       NXT-GEN-BIB.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-COD-CTAB TO BIB-CTAB.
           IF FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'BIB' AND BIB-TNMB = BIB-BIBL
               GO TO LUP-GEN-BIB.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
       FIN-GEN-BIB.
           EXIT.

       BIB-PUT-QUE SECTION.
       INI-BIB-PUT-QUE.
           IF BIB-EXP-CMND = 'N'
               PERFORM GNS-PRO-QUE
           ELSE
              IF BIB-EXP-BIBL = 'S'
                  MOVE 'B'                 TO BIB-EXP-INDI
                  MOVE FIO-SIST            TO BIB-EXP-SIST
                  MOVE TAB-COD-CTAB IN TAB TO BIB-EXP-CTAB
                  MOVE QUE-ITEM            TO BIB-EXP-ITEM
                  MOVE BIB-EXP-DESC TO QUE-ITEM
                  PERFORM GNS-PRO-QUE
                  MOVE SPACES TO BIB-EXP-DESC
                  MOVE 'N' TO BIB-EXP-BIBL
              ELSE
                  MOVE QUE-ITEM            TO BIB-EXP-ITEM
                  MOVE BIB-EXP-DESC TO QUE-ITEM
                  PERFORM GNS-PRO-QUE
                  MOVE SPACES TO BIB-EXP-DESC.
       FIN-BIB-PUT-QUE.
           EXIT.
