*%! codigo adicional GNSBMCVT
*% IF SETTAG
*% FNCBQ = "CVTWEB"
*% VSNBQ = "07.02.07"
*% FNCBU = "CVTWEB"
*% VSNBU = "07.02.07"
*% END
*% IF FIN_PUT_CVP_NVF
      *<<<< FIN_PUT_CVP_NVF

      *>>>> FIN_PUT_CVP_NVF
*% END
*% IF INI_FRM_FEC_FDES 
      *<<<< INI_FRM_FEC_FDES 
           MOVE FEC-VHBL-N TO FEC-VHBL. 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>> INI_FRM_FEC_FDES 
*% END
*% IF FRM_FEC_FDES 
      *<<<< FRM_FEC_FDES 
           IF SCR-CMND = 'IFN'
              IF FRM-FEC-FDES IN NVF-FLD NOT > ZEROES
                     MOVE 'FDESIFN=SPA' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-FRM-FEC-FDES.
      *>>>> FRM_FEC_FDES 
*% END
*% IF FRM_HRA_HDES 
      *<<<< FRM_HRA_HDES 
           IF SCR-CMND = 'IFN'
              IF FRM-HRA-HDES IN NVF-FLD NOT > ZEROES
                     MOVE 'HDESIFN=ZER' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-FRM-HRA-HDES.
      *>>>> FRM_HRA_HDES 
*% END
*% IF INI_FRM_FEC_FHAS 
      *<<<< INI_FRM_FEC_FHAS 
           MOVE FEC-VHBL-N TO FEC-VHBL. 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>> INI_FRM_FEC_FHAS 
*% END 
*% IF INI_CVP_COD_PROG 
      *<<<< INI_CVP_COD_PROG 
           IF SCR-CMND = 'IF1'
               IF CVP-COD-PROG IN NVF-FLD > SPACES
                     MOVE 'PROGIF1>SPA' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-CVP-COD-PROG.
           IF SCR-CMND = 'IFN'
               IF CVP-COD-PROG IN NVF-FLD NOT > SPACES
                     MOVE 'PROGIFN=SPA' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-CVP-COD-PROG.
      *>>>> INI_CVP_COD_PROG 
*% END
*% IF FIN_VAL_CON_KEY_NVF
      *<<<< FIN_VAL_CON_KEY_NVF
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-CON-KEY-NVF.
      *
      *Contexto rango de fechas
      *
      *   Pgm      PG1  PGS  PE   P*
      *   X        X         X          1era instancia pgm especifico
      *            X              X     1era instancia pgm cualquiera
      *   X             X    X          Sgte instancia pgm especifico
      *   X             X         X     Sgte instancia pgm cualquiera
      *
      *
           IF SCR-CMND = 'IF1' AND
              CVP-COD-PAMB IN NVF-FLD NOT > SPACES
      * 1era instancia pgm especifico => debe indicar ambiente
                     MOVE 'NVFERR01  ' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-CON-KEY-NVF.
                            
           IF SCR-CMND = 'IFN' AND
              CVP-COD-PAMB IN NVF-FLD NOT > SPACES
      * Sgte instancia pgm especifico => debe indicar programa
                     MOVE 'NVFERR03  ' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-CON-KEY-NVF.
                      
           MOVE FRM-NUM-DDES IN NVF-FLD TO WSS-NUM-DDES.
           MOVE FRM-NUM-MDES IN NVF-FLD TO WSS-NUM-MDES.
           MOVE FRM-NUM-SDES IN NVF-FLD TO WSS-NUM-SDES.
           MOVE FRM-NUM-ADES IN NVF-FLD TO WSS-NUM-ADES.
           MOVE FRM-HRA-HDES IN NVF-FLD TO WSS-HRA-HDES.

           MOVE FRM-NUM-DHAS IN NVF-FLD TO WSS-NUM-DHAS.
           MOVE FRM-NUM-MHAS IN NVF-FLD TO WSS-NUM-MHAS.
           MOVE FRM-NUM-SHAS IN NVF-FLD TO WSS-NUM-SHAS.
           MOVE FRM-NUM-AHAS IN NVF-FLD TO WSS-NUM-AHAS.
           MOVE FRM-HRA-HHAS IN NVF-FLD TO WSS-HRA-HHAS.

           IF SCR-CMND NOT = 'IFN'
           IF WSS-STP-FHAS < WSS-STP-FDES
      * FHAS DEBE SER >= FDES
                     MOVE 'FECDESHASERR' TO MSG-COD-MENS
                     MOVE 'GNS' TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE FRM-SUAR-MAL TO FRM-SUAR
                     GO TO FIN-VAL-CON-KEY-NVF.
                      
      *>>>> FIN_VAL_CON_KEY_NVF
*% END 
