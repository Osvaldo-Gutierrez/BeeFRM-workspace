      * Rutina Generica para el manejo de Errores Batch
       PRO-ERR SECTION.
       INI-PRO-ERR.
      * MODIFICADO POR RVALDES EL 28-JAN-1992 12:28:04 (VSAM BATCH)
      *     MOVE SPACES               TO ERR-GLS-FLAG IN ERR
      *                                  ERR-MSC-STAT IN ERR
      *                                  ERR-GLS-DISP IN ERR.
      *    MOVE SYS-TSTP IN SYS-VARI TO ERR-STP-ITRN IN ERR.
      *    MOVE SYS-SHOY IN SYS-VARI TO ERR-NUM-STRN IN ERR.
      *    MOVE SYS-AHOY IN SYS-VARI TO ERR-NUM-ATRN IN ERR.
      *    MOVE SYS-MHOY IN SYS-VARI TO ERR-NUM-MTRN IN ERR.
      *    MOVE SYS-DHOY IN SYS-VARI TO ERR-NUM-DTRN IN ERR.
           MOVE SYS-HHOY IN SYS-VARI TO ERR-HRA-HRTR IN ERR.
      * FIO-FILE SOLO PARA VAX
      *    MOVE FIO-FILE IN FIO-VARI TO ERR-GLS-ALOG IN ERR.
           IF ERR-COD-TERR IN ERR = ERR-TERR-LGC IN ERR-VARI
               MOVE 'FIOSTAT'            TO ERR-COD-TMSG IN ERR
                                            ERR-COD-CMPO IN ERR
               MOVE FIO-CMND IN FIO-VARI TO ERR-COD-CMND IN ERR
               MOVE SPACES               TO ERR-GLS-AFIS IN ERR
               IF FIO-STAT-OKS
                   MOVE 'NEX' TO ERR-COD-CMSG IN ERR
               ELSE
                   MOVE FIO-STAT IN FIO-VARI TO ERR-COD-CMSG IN ERR
           ELSE
               MOVE SPACES               TO ERR-COD-CMND IN ERR
                                            ERR-GLS-AFIS IN ERR
                                            ERR-GLS-AKEY IN ERR.
      *    MOVE FIO-PUT TO FIO-CMND.
      *    PERFORM GNS-FIO-ERR.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE ERR-COD-MENS IN ERR TO MSG-COD-MENS IN MSG.
           PERFORM GET-MSG.
           DISPLAY ' '.
      *     DISPLAY 'DESCRIPCION  : ' , MSG-GLS-DESC IN MSG.
      *     IF ERR-COD-CMND > SPACES
      *         MOVE 'FIOCMND'           TO MSG-COD-TMSG IN MSG
      *         MOVE ERR-COD-CMND IN ERR TO MSG-COD-CMSG IN MSG
      *         PERFORM GET-MSG
      *         DISPLAY 'COMANDO      : ' , MSG-GLS-DESC IN MSG.
      *     DISPLAY 'ARCHIVO      : ' , ERR-GLS-ALOG IN ERR.
      *     IF ERR-GLS-AKEY > SPACES
      *         DISPLAY 'LLAVE ACCESO : ' , ERR-GLS-AKEY IN ERR.
      *     DISPLAY 'REGISTRO     : ' , ERR-GLS-VKEY IN ERR.
      *     DISPLAY 'TIPO ACCION  : ' , ERR-MSC-TACC IN ERR.
      *     DISPLAY 'SEVERIDAD    : ' , ERR-IND-SVRT IN ERR.
      *     DISPLAY 'DESCRIP/' MSG-GLS-DESC ' /ARCHIVO/' ERR-GLS-ALOG.
      *     DISPLAY '/COMANDO/' ERR-COD-CMND IN ERR.
      *     DISPLAY ' /LLAVE/' ERR-GLS-VKEY IN ERR
      *             ' /SEVERIDAD/' ERR-IND-SVRT.
      * RVM :
           IF ERR-COD-CMND IN ERR = FIO-INP
              MOVE 'ERROR DE APERTURA EN ARCHIVO' TO MSG-GLS-DESC.
           DISPLAY 'PROCESO CON ERROR...'.
           DISPLAY 'DESCRIPCION     : ' MSG-GLS-DESC.
           DISPLAY 'TABLA O ARCHIVO : ' ERR-GLS-ALOG IN ERR.
           DISPLAY 'REGISTRO        : ' ERR-GLS-VKEY IN ERR.
           DISPLAY 'COMANDO         : ' ERR-COD-CMND IN ERR.
       FIN-PRO-ERR.
           EXIT.

