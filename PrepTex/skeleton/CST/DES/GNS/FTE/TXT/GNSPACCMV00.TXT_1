*% NO_HDR_CST = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% LARGO_MI_COMMAREA = 24
*% IF WSS
      *<<<< WSS
       COPY GNSBRIDD.

       01  WSS-MATR.
           03 WSS-MATR-FIL    OCCURS 17 TIMES.
              05 WSS-MATR-COL OCCURS  5 TIMES.
                 07 WSS-MATR-ELM         PIC X(12).
       77  WSS-IDX-FIL   VALUE ZEROES    PIC 9(05).
       77  WSS-IDX-COL   VALUE ZEROES    PIC 9(05).

       01  WSS-VARI.
           03  WSS-IDX-IDD VALUE ZEROES           PIC 9(04).
           03  WSS-LIN-DIDD.
               05 WSS-LIN-DIDD-FIL1 VALUE SPACES  PIC X(01).
               05 WSS-LIN-DIDD-SIST VALUE SPACES  PIC X(03).
               05 WSS-LIN-DIDD-FIL2 VALUE '-'     PIC X(01).
               05 WSS-LIN-DIDD-GRPO VALUE SPACES  PIC X(01).
               05 WSS-LIN-DIDD-FIL3 VALUE ' > '   PIC X(03).
               05 WSS-LIN-DIDD-IENT VALUE SPACES  PIC X(03).
      *>>>> WSS
*% END
*% IF FND_KEY
      *<<<< FND_KEY

           MOVE ZEROES TO FRM-IFLD.
           MOVE SPACES TO RCI-COD-CIDD IN RCI.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-FND-KEY.
           PERFORM GNS-FIO-RCI.
           IF NOT FIO-STAT-OKS
               GO TO END-FND-KEY.
           IF RCI-COD-CPTO IN CCM-FLD NOT =
              RCI-COD-CPTO IN RCI OR
              RCI-COD-BNCO IN CCM-FLD NOT =
              RCI-COD-BNCO IN RCI OR
              RCI-COD-MRCA IN CCM-FLD NOT =
              RCI-COD-MRCA IN RCI OR
              RCI-COD-CART IN CCM-FLD NOT =
              RCI-COD-CART IN RCI OR
              RCI-COD-LENG IN CCM-FLD NOT =
              RCI-COD-LENG IN RCI OR
              RCI-COD-PAIS IN CCM-FLD NOT =
              RCI-COD-PAIS IN RCI
                 GO TO END-FND-KEY.

           ADD  1 TO WSS-IDX-COL.
           MOVE 1 TO WSS-IDX-FIL.

           MOVE RCI-COD-CIDD IN RCI TO 
                WSS-MATR-ELM IN WSS-MATR( WSS-IDX-FIL, WSS-IDX-COL)
           MOVE RCI-COD-CIDD IN RCI TO IDD-COD-CIDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-IDD.
           IF FIO-STAT-OKS
               PERFORM PUT-IDD VARYING WSS-IDX-IDD FROM 1 BY 1 UNTIL
                  WSS-IDX-IDD > 43.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-FND-KEY.

       END-FND-KEY.
           MOVE ZEROES TO FRM-IFLD.
           PERFORM PUT-FIL VARYING WSS-IDX-FIL FROM 1 BY 1
             UNTIL WSS-IDX-FIL > 17.
           IF FRM-IFLD > ZEROES
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE '23' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>> FND_KEY
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBFIDD.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBTAB.

       PUT-IDD SECTION.
       INI-PUT-IDD.
           IF IDD-COD-SIST IN IDD(WSS-IDX-IDD) > SPACES
                  MOVE IDD-COD-SIST IN IDD(WSS-IDX-IDD) TO
                          WSS-LIN-DIDD-SIST
                  MOVE IDD-COD-GRPO IN IDD(WSS-IDX-IDD) TO
                          WSS-LIN-DIDD-GRPO
                  MOVE IDD-COD-IENT IN IDD(WSS-IDX-IDD) TO
                          WSS-LIN-DIDD-IENT
                  ADD 1 TO WSS-IDX-FIL
                  MOVE WSS-LIN-DIDD TO 
                   WSS-MATR-ELM IN WSS-MATR( WSS-IDX-FIL, WSS-IDX-COL).
       FIN-PUT-IDD.
           EXIT.


       PUT-FIL SECTION.
       INI-PUT-FIL.
           PERFORM PUT-COL VARYING WSS-IDX-COL FROM 1 BY 1
             UNTIL WSS-IDX-COL > 5.
       FIN-PUT-FIL.
           EXIT.

       PUT-COL SECTION.
       INI-PUT-COL.
           ADD 1 TO FRM-IFLD.
           MOVE WSS-MATR-ELM IN WSS-MATR( WSS-IDX-FIL, WSS-IDX-COL)
             TO FRM-GLS-AMBI IN CCM-FLD(FRM-IFLD).
       FIN-PUT-COL.
           EXIT.

      *>>>> EOF
*% END
