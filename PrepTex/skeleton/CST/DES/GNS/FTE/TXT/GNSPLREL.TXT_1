*%! Codigo adicional para programa
*% IF WSS
      *<<<< WSS
      * COPY DOCWSS IN TXT.
       COPY GNSBRENT.
       01  WSS-VARI.
           03 WSS-TEN1                                 PIC X(01).
              88 WSS-TEN1-MODU          VALUE 'M'.
              88 WSS-TEN1-REGI          VALUE 'R'.
              88 WSS-TEN1-ARCH          VALUE 'A'.
              88 WSS-TEN1-PROG          VALUE 'P'.
              88 WSS-TEN1-FORM          VALUE 'F'.
              88 WSS-TEN1-INFO          VALUE 'I'.
              88 WSS-TEN1-TRAN          VALUE 'T'.
           03 WSS-TEN2                                 PIC X(01).
              88 WSS-TEN2-MODU          VALUE 'M'.
              88 WSS-TEN2-REGI          VALUE 'R'.
              88 WSS-TEN2-ARCH          VALUE 'A'.
              88 WSS-TEN2-PROG          VALUE 'P'.
              88 WSS-TEN2-FORM          VALUE 'F'.
              88 WSS-TEN2-INFO          VALUE 'I'.
              88 WSS-TEN2-TRAN          VALUE 'T'.
           03 WSS-GLS-MODU                             PIC X(13)
                                        VALUE 'odulo        '.
           03 WSS-GLS-REGI                             PIC X(13)
                                        VALUE 'egistro      '.
           03 WSS-GLS-ARCH                             PIC X(13)
                                        VALUE 'rchivo       '.
           03 WSS-GLS-PROG                             PIC X(13)
                                        VALUE 'rograma      '.
           03 WSS-GLS-FORM                             PIC X(13)
                                        VALUE 'ormulario    '.
           03 WSS-GLS-INFO                             PIC X(13)
                                        VALUE 'nforme       '.
           03 WSS-GLS-TRAN                             PIC X(13)
                                        VALUE 'ransaccion   '.
           03 WSS-COD-TEYM.
              05 WSS-COD-TEN1                          PIC X(01).
              05 WSS-COD-MOD1                          PIC X(12).
           03 WSS-COD-BIB1                             PIC X(06).
           03 WSS-COD-TEN2                             PIC X(01).
           03 WSS-COD-BIB2                             PIC X(06).
           03 DOC-E1E2           OCCURS 100.
              05 DOC-ENT1.
                 07 DOC-TEN1                           PIC X(01).
                 07 DOC-MOD1                           PIC X(12).
                 07 DOC-BIB1                           PIC X(06).
              05 DOC-ENT2.
                 07 DOC-TEN2                           PIC X(01).
                 07 DOC-MOD2                           PIC X(12).
                 07 DOC-BIB2                           PIC X(06).
           03 WSS-SIND.
              05 I               COMP                  PIC 9(04).
              05 ICOL            COMP                  PIC 9(04).
              05 PHIJ            COMP                  PIC 9(04).
              05 UHIJ            COMP   VALUE 0        PIC 9(04).
      *>>>>
*% END
*% IF CH_REL_REL_KEY_BIB1
      *<<<< CH_REL_REL_KEY_BIB1
           MOVE REL-KEY-TEN1 IN SRT TO WSS-TEN1.
           IF WSS-TEN1-MODU
               MOVE WSS-GLS-MODU TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-REGI
               MOVE WSS-GLS-REGI TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-ARCH
               MOVE WSS-GLS-ARCH TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-PROG
               MOVE WSS-GLS-PROG TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-FORM
               MOVE WSS-GLS-FORM TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-INFO
               MOVE WSS-GLS-INFO TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
           IF WSS-TEN1-TRAN
               MOVE WSS-GLS-TRAN TO WSS-GLS-TEN1 IN WSS-REL
           ELSE
               DISPLAY 'ERROR: TIPO DE ENTIDAD NO CORRESPONDE'
               COPY GNSBGGBK.
           MOVE REL-KEY-TEN1 IN SRT TO ENT-KEY-TENT.
           MOVE REL-KEY-MOD1 IN SRT TO ENT-KEY-MODU.
           MOVE REL-KEY-BIB1 IN SRT TO ENT-KEY-BIBL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           CALL 'GNSPFENT' USING FIO-VARI ENT.
           IF FIO-STAT-OKS
               MOVE ENT-GLS-DESC TO WSS-GLS-DES1 IN WSS-REL
           ELSE
               MOVE SPACES TO WSS-GLS-DES1 IN WSS-REL.
      *>>>>
*% END
*% IF CH_REL_REL_KEY_TEN2
      *<<<< CH_REL_REL_KEY_TEN2
           MOVE REL-KEY-TEN2 IN SRT TO WSS-TEN2.
           IF WSS-TEN2-MODU
               MOVE WSS-GLS-MODU TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-REGI
               MOVE WSS-GLS-REGI TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-ARCH
               MOVE WSS-GLS-ARCH TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-PROG
               MOVE WSS-GLS-PROG TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-FORM
               MOVE WSS-GLS-FORM TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-INFO
               MOVE WSS-GLS-INFO TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
           IF WSS-TEN2-TRAN
               MOVE WSS-GLS-TRAN TO WSS-GLS-TEN2 IN WSS-REL
           ELSE
               DISPLAY 'ERROR: TIPO DE ENTIDAD NO CORRESPONDE'
               COPY GNSBGGBK.

      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'BIBLIOTECA 1   : ' WITH NO ADVANCING.
           ACCEPT WSS-COD-BIB1.
           DISPLAY 'ENTIDAD 1      : ' WITH NO ADVANCING.
           ACCEPT WSS-COD-TEYM.
           DISPLAY 'BIBLIOTECA 2   : ' WITH NO ADVANCING.
           ACCEPT WSS-COD-BIB2.
           DISPLAY 'TIPO ENTIDAD 2 : ' WITH NO ADVANCING.
           ACCEPT WSS-COD-TEN2.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GNS-FIO-REL.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF NOT (( WSS-COD-BIB1 = 'T' OR REL-COD-BIB1 ) AND
                   ( WSS-COD-TEYM = 'T' OR
                   ( WSS-COD-TEN1 = REL-COD-TEN1 AND
                     WSS-COD-MOD1 = REL-COD-MOD1 )) AND
                   ( WSS-COD-BIB2 = 'T' OR REL-COD-BIB2 ) AND
                   ( WSS-COD-TEN2 = 'T' OR REL-COD-TEN2 ))
               GO TO LUP-INP-SRT.
           IF NOT ( 'T' = WSS-COD-BIB1 AND WSS-COD-TEYM AND
                          WSS-COD-BIB2 AND WSS-COD-TEN2 )
               PERFORM CHK-ESTA VARYING I FROM 1 BY 1 UNTIL I > UHIJ OR
                                          REL-KEY-ENT2 = DOC-ENT2( I )
               IF I > UHIJ
                   ADD 1 TO UHIJ
                   MOVE REL-KEY-E1E2 TO DOC-E1E2( UHIJ ).
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GNS-FIO-ENT.
           MOVE FIO-INP      TO FIO-CMND.
           PERFORM GNS-FIO-ENT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           IF REL-KEY-TEN2 IN SRT = WSS-TEN2
               MOVE SPACES TO WSS-GLS-TEN2.
           MOVE REL-KEY-TEN2 IN SRT TO ENT-KEY-TENT.
           MOVE REL-KEY-MOD2 IN SRT TO ENT-KEY-MODU.
           MOVE REL-KEY-BIB2 IN SRT TO ENT-KEY-BIBL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-ENT.
           IF FIO-STAT-OKS
               MOVE ENT-GLS-DESC TO WSS-GLS-DES2 IN WSS-REL
           ELSE
               MOVE SPACES TO WSS-GLS-DES2 IN WSS-REL.
      *>>>>
*% END
*% IF FIN_INP
      *<<<< FIN_INP
           ADD 1 UHIJ GIVING PHIJ.
           PERFORM PUT-HIJO VARYING ICOL FROM 1 BY 1
                                         UNTIL ICOL > UHIJ.
           PERFORM GEN-LDET VARYING ICOL FROM PHIJ BY 1
                                         UNTIL ICOL > UHIJ.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-ENT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PUT-HIJO SECTION.
      *----------------
       INI-PUT-HIJO.
           MOVE DOC-ENT2( ICOL ) TO REL-KEY-ENT1.
           MOVE SPACES           TO REL-KEY-ENT2.
           MOVE FIO-GET-GRT TO FIO-CMND.
           PERFORM GNS-FIO-REL.
           IF NOT ( FIO-STAT-OKS AND DOC-ENT2( ICOL ) = REL-KEY-ENT1 )
               GO TO FIN-PUT-HIJO.
       LUP-PUT-HIJO.
           PERFORM CHK-ESTA VARYING I FROM 1 BY 1 UNTIL I > UHIJ OR
                                           REL-KEY-ENT2 = DOC-ENT2( I ).
           IF I > UHIJ
               ADD 1 TO UHIJ
               MOVE REL-KEY-E1E2 TO DOC-E1E2( UHIJ ).
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-REL.
           IF FIO-STAT-OKS AND DOC-ENT2( ICOL ) = REL-KEY-ENT1
               GO TO LUP-PUT-HIJO.
       FIN-PUT-HIJO.
           EXIT.

       GEN-LDET SECTION.
      *----------------
       INI-GEN-LDET.
           MOVE DOC-E1E2( ICOL ) TO SRT.
           IF REL-KEY-TEN2 IN SRT = WSS-TEN2
               MOVE SPACES TO WSS-GLS-TEN2.
           MOVE REL-KEY-TEN2 IN SRT TO ENT-KEY-TENT.
           MOVE REL-KEY-MOD2 IN SRT TO ENT-KEY-MODU.
           MOVE REL-KEY-BIB2 IN SRT TO ENT-KEY-BIBL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-ENT.
           IF FIO-STAT-OKS
               MOVE ENT-GLS-DESC TO WSS-GLS-DES2 IN WSS-REL
           ELSE
               MOVE SPACES TO WSS-GLS-DES2 IN WSS-REL.
           GENERATE DL-REL.
       FIN-GEN-LDET.
           EXIT.

       CHK-ESTA SECTION.
      *----------------
       INI-CHK-ESTA.
       FIN-CHK-ESTA.
           EXIT.

       COPY GNSBFENT.
      *>>>>
*% END
