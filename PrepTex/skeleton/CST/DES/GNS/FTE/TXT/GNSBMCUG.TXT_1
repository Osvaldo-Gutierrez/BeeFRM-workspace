*% IF SETTAG
*% FNCBQ = "1710_05"
*% VSNBQ = "01-00"
*% FNCBU = "1710_05"
*% VSNBU = "01-00"
*% END
*% IF FRM_COD_USER
      *<<<< FRM_COD_USER
           IF FRM-COD-USER IN CUG-FLD(FRM-IFLD) > SPACES
               MOVE FRM-COD-USER IN CUG-FLD(FRM-IFLD) TO
                    USR-COD-USER IN USR
               PERFORM VAL-USR
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE FRM-COD-USER IN CUG-FLD(FRM-IFLD) TO
                        RUG-COD-USER IN RUG
                   MOVE 'RUG-COD-USER' TO FIO-AKEY
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM GNS-FIO-RUG
                   IF FIO-STAT-OKS AND
                      FRM-COD-USER IN CUG-FLD(FRM-IFLD) =
                      RUG-COD-USER IN RUG
                         IF RUG-COD-GRPO IN CUG-FLD NOT =
                            RUG-COD-GRPO IN RUG
                              MOVE 'GNS' TO MSG-COD-SIST
                              MOVE 'USER   YADEF' TO MSG-COD-MENS
                              PERFORM GET-MSG
                              PERFORM SET-MSG
                              MOVE FRM-SUAR-MAL TO FRM-SUAR
                         ELSE
                              MOVE FIO-GET-NXT TO FIO-CMND
                              MOVE 'RUG-COD-USER' TO FIO-AKEY
                              PERFORM GNS-FIO-RUG
                              IF FIO-STAT-OKS AND
                                 FRM-COD-USER IN CUG-FLD(FRM-IFLD) =
                                 RUG-COD-USER IN RUG
                                  MOVE 'GNS' TO MSG-COD-SIST
                                  MOVE 'USER   YADEF' TO MSG-COD-MENS
                                  PERFORM GET-MSG
                                  PERFORM SET-MSG
                                  MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>> FRM_COD_USER
*% END
*% IF VAL_CON_FLD_CUG
      *<<<< VAL_CON_FLD_CUG
           PERFORM VAL-I VARYING WSS-I FROM 1 BY 1
             UNTIL WSS-I > WSS-LIMI-1 OR FRM-SUAR = FRM-SUAR-MAL.
      *>>>> VAL_CON_FLD_CUG
*% END
*% IF EOF
      *<<<< EOF
       VAL-I SECTION.
       INI-VAL-I.
           PERFORM VAL-J VARYING WSS-J FROM WSS-I BY 1
             UNTIL WSS-J > WSS-LIMI OR FRM-SUAR = FRM-SUAR-MAL.
       FIN-VAL-I.
           EXIT.

       VAL-J SECTION.
       INI-VAL-J.
           IF ( WSS-I NOT = WSS-J ) AND
              ( FRM-COD-USER IN CUG-FLD(WSS-I) > SPACES AND
                FRM-COD-USER IN CUG-FLD(WSS-J) > SPACES ) AND
              ( FRM-COD-USER IN CUG-FLD(WSS-I) =
                FRM-COD-USER IN CUG-FLD(WSS-J) )
                MOVE -1 TO FRM-COD-USER-LEN IN CUG-FLD(WSS-I)
                MOVE 'S' TO FRM-UCUR
                MOVE 'GNS' TO MSG-COD-SIST
                MOVE 'CUGUSER=' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-J.
           EXIT.
       SET-MSG SECTION.
       INI-SET-MSG.
           MOVE MSG-GLS-DESC        TO WSS-MSG-GLS-DESC.
           MOVE RUG-COD-GRPO IN RUG TO WSS-MSG-GLS-DATA.
           MOVE WSS-MSG             TO FRM-MENS.
       FIN-SET-MSG.
           EXIT.
      *>>>> EOF
*% END
