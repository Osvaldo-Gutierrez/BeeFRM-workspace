*% IF SETTAG
*% FNCBQ = "1710_05"
*% VSNBQ = "01-00"
*% FNCBU = "1710_05"
*% VSNBU = "01-00"
*% END
*% IF INI_VAL_FLD_CDP
      *<<<< INI_VAL_FLD_CDP
           MOVE SPACES TO WSS-TBL-TDPU.
      *>>>> INI_VAL_FLD_CDP
*% END
*% IF INI_FRM_COD_FST1 
      *<<<< INI_FRM_COD_FST1
           IF FRM-COD-FST1 IN CDP-FLD NOT > SPACES
               GO TO FIN-VAL-FRM-COD-FST1.
      *>>>>
*% END
*% IF FRM_COD_TDPU
      *<<<< FRM_COD_TDPU
           IF FRM-COD-TDPU IN CDP-FLD(FRM-IFLD) NOT > SPACES
                GO TO FIN-VAL-FRM-COD-TDPU.
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'TDP' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TDPU IN CDP-FLD(FRM-IFLD) TO
                TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           MOVE TAB-CIC-CTAB TO WSS-CIC-TDPU(FRM-IFLD).
      *>>>> FRM_COD_TDPU
*% END
*% IF FRM_COD_SIST
      *<<<< FRM_COD_SIST
           IF FRM-COD-SIST IN CDP-FLD(FRM-IFLD) = '* '
               GO TO FIN-VAL-FRM-COD-SIST.
           IF FRM-COD-SIST IN CDP-FLD(FRM-IFLD) NOT > SPACES
               GO TO FIN-VAL-FRM-COD-SIST.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SIS' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-SIST IN CDP-FLD(FRM-IFLD) TO
                TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> FRM_COD_SIST
*% END
*% IF FRM_COD_CMND
      *<<<< FRM_COD_CMND
           IF FRM-COD-CMND IN CDP-FLD(FRM-IFLD) = '* '
               GO TO FIN-VAL-FRM-COD-CMND.
           IF FRM-COD-CMND IN CDP-FLD(FRM-IFLD) NOT > SPACES
               GO TO FIN-VAL-FRM-COD-CMND.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'CMN' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-CMND IN CDP-FLD(FRM-IFLD) TO
                TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> FRM_COD_CMND
*% END
*% IF FRM_IND_RESP
      *<<<< FRM_IND_RESP
           IF FRM-IND-RESP IN CDP-FLD(FRM-IFLD) NOT > SPACES
               GO TO FIN-VAL-FRM-IND-RESP.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-IND-RESP IN CDP-FLD(FRM-IFLD) TO
                TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> FRM_IND_RESP
*% END
*% IF VAL_CON_FLD_CDP
      *<<<< VAL_CON_FLD_CDP
           PERFORM VAL-PROC VARYING FRM-IFLD FROM 1
             BY 1 UNTIL FRM-IFLD > WSS-LIMI OR
                        FRM-SUAR = FRM-SUAR-MAL.
           IF FRM-SUAR NOT = FRM-SUAR-MAL
           PERFORM VAL-LINE VARYING FRM-IFLD FROM 1
             BY 1 UNTIL FRM-IFLD > WSS-LIMI OR
                        FRM-SUAR = FRM-SUAR-MAL.

      *>>>> VAL_CON_FLD_CDP
*% END       
*% IF EOF
      *<<<< EOF
       VAL-PROC SECTION.
       INI-VAL-PROC.
           IF WSS-CIC-TDPU(FRM-IFLD) > SPACES
               IF WSS-CIC-TDPU(FRM-IFLD) = 'GI' AND
                  FRM-COD-PROC IN CDP-FLD(FRM-IFLD) > SPACES              
                    MOVE 'GNS' TO MSG-COD-SIST
                    MOVE 'TDPUPROCBLK' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF WSS-CIC-TDPU(FRM-IFLD) = 'GB' AND
                  FRM-COD-PROC IN CDP-FLD(FRM-IFLD) NOT > SPACES              
                    MOVE 'GNS' TO MSG-COD-SIST
                    MOVE 'TDPUPROCOBL' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-PROC.
           EXIT.

       VAL-LINE SECTION.
       INI-VAL-LINE.
           IF FRM-COD-TDPU IN CDP-FLD(FRM-IFLD) > SPACES AND
              ( FRM-NUM-SECU IN CDP-FLD(FRM-IFLD) NOT > ZEROES OR
                FRM-COD-SIST IN CDP-FLD(FRM-IFLD) NOT > SPACES OR
                FRM-COD-NEMO IN CDP-FLD(FRM-IFLD) NOT > SPACES OR
                FRM-COD-CMND IN CDP-FLD(FRM-IFLD) NOT > SPACES OR
                FRM-COD-SIST IN CDP-FLD(FRM-IFLD) NOT > SPACES OR
                FRM-IND-RESP IN CDP-FLD(FRM-IFLD) NOT > SPACES )
                    MOVE 'GNS' TO MSG-COD-SIST
                    MOVE 'TDPLINEINC' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-LINE.
           EXIT.
      *>>>> EOF
*% END
