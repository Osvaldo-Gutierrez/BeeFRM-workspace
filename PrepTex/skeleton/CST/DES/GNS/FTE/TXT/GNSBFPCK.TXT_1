      * Modulo FIO para registro PCK en DATACOM, 13-APR-2007 22:47:51.34
       GNS-FIO-PCK SECTION.
       INI-GNS-FIO-PCK.
           MOVE ADR-PCK-REQA TO ADR-REQA.
           MOVE 'PCK' TO ADR-TABL IN ADR-REQA.
      *
           MOVE 188   TO ADR-DBID IN ADR-REQA.
      *     MOVE 'GNS'  TO IDD-SAUX.
      *     MOVE 'M'    TO IDD-GAUX.
      *     MOVE SPACES TO IDD-RAUX.
      *     MOVE 1 TO IDD-IAUX.
      *     SET IDD-ITBL TO 1.
      *     SEARCH IDD-VSIS VARYING IDD-IAUX
      *       AT END
      *         GO TO GRP-GNS-FIO-PCK
      *       WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
      *         MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA
      *         GO TO FSR-GNS-FIO-PCK.
      * GRP-GNS-FIO-PCK.
      *     MOVE SPACES TO IDD-GAUX.
      *     MOVE 1      TO IDD-IAUX.
      *     SET IDD-ITBL TO 1.
      *     SEARCH IDD-VSIS VARYING IDD-IAUX
      *       AT END
      *         MOVE 'En GNS-FIO-PCK, NO existe en IDD:' TO FIO-MEN1
      *         MOVE IDD-DAUX                            TO FIO-MEN2
      *         PERFORM PRG-ABT
      *       WHEN IDD-DENT( IDD-ITBL ) = IDD-DAUX
      *         MOVE IDD-IENT( IDD-ITBL) TO ADR-DBID IN ADR-REQA.
      * FSR-GNS-FIO-PCK.
      *
           MOVE 'PCK00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           IF FIO-KDEF = FIO-KDEF-S
               GO TO CON-GNS-FIO-PCK.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'PCK-KEY-IREG' OR FIO-AKEY NOT > SPACES )
               MOVE PCK-KEY-IREG IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'PCK-COD-PACK'
               MOVE PCK-COD-PACK IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'PCK-STP-IING'
               MOVE PCK-STP-IING IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'PCK-KEY-IAIN'
               MOVE PCK-KEY-IAIN IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK03' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'PCK-KEY-FUNC'
               MOVE PCK-KEY-FUNC IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK04' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'PCK-COD-APCK'
               MOVE PCK-COD-APCK IN PCK TO ADR-VKEY IN ADR-REQA
               MOVE 'PCK05' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En GNS-FIO-PCK, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.
       CON-GNS-FIO-PCK.
      *ISP-INI
           IF FIO-CMND = FIO-PUT
               MOVE PCK-COD-PAMB IN PCK TO PCK-COD-AAIN IN PCK
               MOVE PCK-STP-IING IN PCK TO PCK-STP-IAIN IN PCK.
      *ISP-FIN
           MOVE PCK TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO PCK
           ELSE
               MOVE 'GNSPCK' TO FIO-MEN2
               IF FIO-STAT-FTL
                   PERFORM PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE FIO-KDEF-N TO FIO-KDEF.
           MOVE ADR-REQA TO ADR-PCK-REQA.
       FIN-GNS-FIO-PCK.
           EXIT.
