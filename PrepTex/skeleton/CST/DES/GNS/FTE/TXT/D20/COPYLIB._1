?SECTION GNSBGFRM, ANSI      ********************* FRM *********************       GNS-PRO-FRM SECTION.       INI-GNS-PRO-FRM.      *Para uso Futuro       FIN-GNS-PRO-FRM.           EXIT.?SECTION GNSBBVCA, ANSI      *Carga variables en areas comunes       GNS-BUS-VCA SECTION.       INI-GNS-BUS-VCA.           READ GNSINP, AT END MOVE "10" TO PGM-SMSG.           IF PGM-SMSG = "10"               GO TO FIN-GNS-BUS-VCA.           MOVE PGM-MSGI-CMA TO SCR-VARI.           MOVE PGM-MSGI-FRM TO FRM-VARI.           MOVE PGM-MSGI-SYS TO SYS-VARI.       FIN-GNS-BUS-VCA.           EXIT.?SECTION GNSBGEXT, ANSI      *Modulo de salida del programa interactivo       SCR-EXIT SECTION.       INI-SCR-EXIT.           MOVE "P"      TO SCR-ICMN.           MOVE SCR-NTRN TO SYS-NTRN.           MOVE SCR-VARI TO SYS-CMMA.           MOVE SCR-TCMA TO SYS-TCMA.           MOVE SYS-RTRN TO SYS-CMND.           PERFORM GNS-PRO-SYS.       FIN-SCR-EXIT.           EXIT.?SECTION GNSWIHDR, ANSI      *    HEADER           03  HDR-FLD.               05 FILLER                              PIC  X(12).      *               05 HDR-COD-SIST-LEN            VALUE 0 PIC S9(02).               05 HDR-COD-SIST-ATR                    PIC  X(01).               05 HDR-COD-SIST                        PIC  X(03).      *               05 HDR-GLS-NFRM-LEN            VALUE 0 PIC S9(02).               05 HDR-GLS-NFRM-ATR                    PIC  X(01).               05 HDR-GLS-NFRM                        PIC  X(03).      *               05 HDR-GLS-FPRO-LEN            VALUE 0 PIC S9(02).               05 HDR-GLS-FPRO-ATR                    PIC  X(01).               05 HDR-GLS-FPRO                        PIC  X(60).      *               05 HDR-FEC-DMSA-LEN            VALUE 0 PIC S9(02).               05 HDR-FEC-DMSA-ATR                    PIC  X(01).               05 HDR-FEC-DMSA.                  07 HDR-NUM-DMSA                     PIC  9(02).                  07 HDR-GLS-1MSA                     PIC  X(01).                  07 HDR-NUM-MMSA                     PIC  9(02).                  07 HDR-GLS-2MSA                     PIC  X(01).                  07 HDR-NUM-SMSA                     PIC  9(02).                  07 HDR-NUM-AMSA                     PIC  9(02).      *               05 HDR-COD-FUNC-LEN            VALUE 0 PIC S9(02).               05 HDR-COD-FUNC-ATR                    PIC  X(01).               05 HDR-COD-FUNC                        PIC  X(11).      *               05 HDR-GLS-GLS1-LEN            VALUE 0 PIC S9(02).               05 HDR-GLS-GLS1-ATR                    PIC  X(01).               05 HDR-GLS-GLS1                        PIC  X(03).               05 HDR-GLS-GLS2-LEN            VALUE 0 PIC S9(02).               05 HDR-GLS-GLS2-ATR                    PIC  X(01).               05 HDR-GLS-GLS2                        PIC  X(03).               05 HDR-GLS-GLS3-LEN            VALUE 0 PIC S9(02).               05 HDR-GLS-GLS3-ATR                    PIC  X(01).               05 HDR-GLS-GLS3                        PIC  X(03).?SECTION GNSWIOPC, ANSI      *    DESPLIEGUE_DE_OPCIONES           03 OPC-FLD.              05 FILLER-OPC                    PIC  X(12).      *              05 OPC-COD-OPCI-IDX  OCCURS 40 TIMES.                 07 OPC-COD-OPCI-LEN           PIC S9(02).                 07 OPC-COD-OPCI-ATR           PIC  X(01).                 07 OPC-COD-OPCI               PIC  X(3).      *                 07 OPC-GLS-FMEN-LEN           PIC S9(02).                 07 OPC-GLS-FMEN-ATR           PIC  X(01).                 07 OPC-GLS-FMEN               PIC  X(32).      * Linea de Mensajes              05 OPC-GLS-MENS-LEN      VALUE 0 PIC S9(02).              05 OPC-GLS-MENS-ATR              PIC  X(01).              05 OPC-GLS-MENS.                 07 OPC-GLS-MEN1               PIC  X(40).                 07 OPC-GLS-MEN2               PIC  X(39).?SECTION GNSWIOP1, ANSI      *    DESPLIEGUE_DE_OPCIONES           03  OP1-FLD.               05 FILLER-OP1                    PIC  X(12).      *               05 OP1-COD-OPCI-IDX  OCCURS 20 TIMES.                  07 OP1-COD-OPCI-LEN           PIC S9(02).                  07 OP1-COD-OPCI-ATR           PIC  X(01).                  07 OP1-COD-OPCI               PIC  X(3).      *                  07 OP1-GLS-FMEN-LEN           PIC S9(02).                  07 OP1-GLS-FMEN-ATR           PIC  X(01).                  07 OP1-GLS-FMEN               PIC  X(32).      * Linea de Mensajes               05 OP1-GLS-MENS-LEN      VALUE 0 PIC S9(02).               05 OP1-GLS-MENS-ATR              PIC  X(01).               05 OP1-GLS-MENS.                  07 OP1-GLS-MEN1               PIC  X(40).                  07 OP1-GLS-MEN2               PIC  X(39).?SECTION GNSWITRL, ANSI      *    COMANDOS           03  TRL-FLD.               05 FILLER                              PIC  X(12).      *               05 TRL-GLS-TERM-LEN            VALUE 0 PIC S9(02).               05 TRL-GLS-TERM-ATR                    PIC  X(01).               05 TRL-GLS-TERM                        PIC  X(79).      *               05 TRL-COD-CMND-LEN            VALUE 0 PIC S9(02).               05 TRL-COD-CMND-ATR                    PIC  X(01).               05 TRL-COD-CMND                        PIC  X(39).      *               05 TRL-GLS-PRMT-LEN            VALUE 0 PIC S9(02).               05 TRL-GLS-PRMT-ATR                    PIC  X(01).               05 TRL-GLS-PRMT                        PIC  X(25).      *               05 TRL-COD-CACC-LEN            VALUE 0 PIC S9(02).               05 TRL-COD-CACC-ATR                    PIC  X(01).               05 TRL-COD-CACC                        PIC  X(11).      * Linea de Mensajes               05 TRL-GLS-MENS-LEN            VALUE 0 PIC S9(02).               05 TRL-GLS-MENS-ATR                    PIC  X(01).               05 TRL-GLS-MENS                        PIC  X(79).?SECTION GNSBESIO, ANSI       DECLARATIVES.       FIO-INP-ERR SECTION.           USE AFTER ERROR PROCEDURE ON INPUT.       FIO-INI-INP.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-INP.           EXIT.       FIO-UPD-ERR SECTION.           USE AFTER ERROR PROCEDURE ON I-O.       FIO-INI-UPD.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-UPD.           EXIT.       FIO-OUT-ERR SECTION.           USE AFTER ERROR PROCEDURE ON OUTPUT.       FIO-INI-OUT.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-OUT.           EXIT.       FIO-EXT-ERR SECTION.           USE AFTER ERROR PROCEDURE ON EXTEND.       FIO-INI-EXT.           MOVE "Status ENS :" TO FIO-MENS-DSC.           MOVE FIO-STAT       TO FIO-MENS-STT.           MOVE SPACES         TO FIO-MENS-SST.           MOVE "Cmd"          TO FIO-MENS-GCM.           MOVE FIO-CMND       TO FIO-MENS-CMD.           MOVE "File"         TO FIO-MENS-GFL.           MOVE FIO-VOID       TO FIO-MENS-FIL.           IF FIO-STAT IS NUMERIC               MOVE FIO-STAT                 TO FIO-SIND               MOVE FIO-GLS-MENS( FIO-SIND ) TO FIO-MENS-KEY           ELSE               MOVE "? Error desconocido." TO FIO-MENS-KEY.           IF FIO-STAT-EOF OR FIO-STAT-IKY OR FIO-STAT-CDK OR              FIO-STAT-FIV                GO TO FIO-FIN-EXT.           MOVE "Aborto, ENS:" TO FIO-MENS-DSC.           MOVE "99"           TO FIO-STAT.           MOVE FIO-VARI TO FIO-OUTP.           WRITE FIO-MSGO.           STOP RUN.       FIO-FIN-EXT.           EXIT.       END DECLARATIVES.?SECTION GNSBEFIO, ANSI       DECLARATIVES.       FIO-INP-ERR SECTION.           USE AFTER ERROR PROCEDURE ON INPUT.       FIO-INI-INP.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-INP.           EXIT.       FIO-UPD-ERR SECTION.           USE AFTER ERROR PROCEDURE ON I-O.       FIO-INI-UPD.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-UPD.           EXIT.       FIO-OUT-ERR SECTION.           USE AFTER ERROR PROCEDURE ON OUTPUT.       FIO-INI-OUT.           PERFORM FIO-INI-EXT THRU FIO-FIN-EXT.       FIO-FIN-OUT.           EXIT.       FIO-EXT-ERR SECTION.           USE AFTER ERROR PROCEDURE ON EXTEND.       FIO-INI-EXT.           MOVE "Status ENS :" TO FIO-MENS-DSC.           MOVE FIO-STAT       TO FIO-MENS-STT.           MOVE SPACES         TO FIO-MENS-SST.           MOVE "Cmd"          TO FIO-MENS-GCM.           MOVE FIO-CMND       TO FIO-MENS-CMD.           MOVE "File"         TO FIO-MENS-GFL.           MOVE FIO-VOID       TO FIO-MENS-FIL.           IF FIO-STAT IS NUMERIC               MOVE FIO-STAT                 TO FIO-SIND               MOVE FIO-GLS-MENS( FIO-SIND ) TO FIO-MENS-KEY           ELSE               MOVE "? Error desconocido." TO FIO-MENS-KEY.           IF FIO-STAT-EOF OR FIO-STAT-IKY OR FIO-STAT-CDK OR              FIO-STAT-FIV                GO TO FIO-FIN-EXT.           MOVE "Aborto, ENS:" TO FIO-MENS-DSC.           MOVE "99"           TO FIO-STAT.       FIO-FIN-EXT.           EXIT.       END DECLARATIVES.?SECTION GNSBRMNU, ANSI      *    Archivo de Menu      *    ---------------      *      *    Nombre Registro : MNU      *    Clave(s)        : MNU-COD-NEMO(UU),MNU-COD-OPCI(UC),      *                      MNU-COD-IMEN(UC)      *    Largo           : 490      *    Bloqueo         : 1      *    Observaciones   :      *       01  MNU.      *      *       Filler Compatibilidad VSAM/MVS           03 MNU-GLS-FLAG                              PIC X(01).      *      *       Llave primaria nemotecnica           03 MNU-COD-NEMO.      *      *          Sistema              05 MNU-COD-SYST                           PIC X(03).      *      *          Codigo accion              05 MNU-COD-CACC                           PIC X(03).      *      *          Codigo de Funcion              05 MNU-COD-FUNC.      *      *             Entidad                 07 MNU-COD-ENTI                        PIC X(03).      *      *             Comando                 07 MNU-COD-COMD                        PIC X(03).      *      *       Llave secundaria 1: Opcion           03 MNU-COD-OPCI                              PIC X(03).      *      *       Llave secundaria 2: Menu + Ordinal           03 MNU-COD-IMEN.      *      *          Codigo menu              05 MNU-COD-CMEN                           PIC X(03).      *      *          Ordinal              05 MNU-NUM-ORDI                           PIC 9(03).      *      *       Tipo funcion           03 MNU-COD-TFUN                              PIC X(03).      *      *       Glosa funcion menu           03 MNU-GLS-FMEN                              PIC X(30).      *      *       Comando           03 MNU-GLS-CMND.      *      *          Prefijo comando              05 MNU-GLS-COMD                           PIC X(12).      *      *          Programa              05 MNU-GLS-PROG                           PIC X(12).      *      *          Resto comando              05 FILLER                                 PIC X(29).      *      *       Transaccion           03 MNU-GLS-TRAN                              PIC X(04).      *      *       Comando ingreso programa           03 MNU-COD-CMND                              PIC X(03).      *      *       Biblioteca documentacion.           03 MNU-GLS-LDOC                              PIC X(07).      *      *       Nombre modulo documentacion           03 MNU-GLS-NDOC                              PIC X(24).      *      *       Biblioteca formulario           03 MNU-GLS-LFRM                              PIC X(07).      *      *       Nombre formulario           03 MNU-GLS-NFRM                              PIC X(07).      *      *       Glosa funcion programa           03 MNU-GLS-FPRO                              PIC X(30).      *      *       Fila           03 MNU-NUM-FILA                              PIC 9(02).      *      *       Columna           03 MNU-NUM-COLU                              PIC 9(02).      *      *       Funcion retorno  (default)           03 MNU-COD-FRET                              PIC X(12).      *      *       Indicador confirmacion           03 MNU-IND-CONF                              PIC X(01).      *      *       Menu           03 MNU-COD-MENU                              PIC X(03).      *      *       Indicador de privilegios           03 MNU-IND-IPRV                              PIC X(01).      *      *       Instancia ingreso programa           03 MNU-COD-INST                              PIC X(03).      *           *       Indicador si expande o no glosa de menu           03 MNU-IND-EXGL                              PIC X(01).      *      *       Indicador transferencia de control           03 MNU-IND-SEQU                              PIC X(03).      *      *       Sistema           03 MNU-COD-SIST                              PIC X(03).      *      *       Codigo de traspaso de control al programa           03 MNU-COD-TCTL                              PIC X(04).      *      *       Accion a ejecutar sobre formulario           03 MNU-COD-EJFR                              PIC X(03).      *      *       Funcion anterior           03 MNU-COD-FANT                              PIC X(12).      *      *       Codigo Tabla           03 MNU-COD-TABL.              05 MNU-COD-TTAB                           PIC X(03).              05 MNU-COD-CTAB                           PIC X(12).      *      *       Indicador clear           03 MNU-IND-NCLR                              PIC X(01).      *      *       Biblioteca formulario para VAX           03 MNU-GLS-LFVX                              PIC X(07).      *      *       Nombre formulario para VAX           03 MNU-GLS-NFVX                              PIC X(07).      *      *       Programa           03 MNU-GLS-PRGM                              PIC X(08).      *      *       Independencia Fisica Datos           03 MNU-COD-CIFD                              PIC X(12).      *      *       Codigo de traspaso de informacion al programa           03 MNU-COD-TINF                              PIC X(03).      *      *       Modalidad de Salida del programa           03 MNU-COD-MSAL                              PIC X(03).      *      *       Accion a ejecutar con pantalla           03 MNU-COD-ASCR                              PIC X(01).      *      *       Accion a ejecutar con mapa programa           03 MNU-COD-AMPG                              PIC X(01).      *      *       Nombre Mapa Header           03 MNU-GLS-NMHD                              PIC X(07).      *      *       Libreria Mapa Header           03 MNU-GLS-LMHD                              PIC X(07).      *      *       Accion a ejecutar con mapa header           03 MNU-COD-AMHD                              PIC X(01).      *      *       Nombre Mapa Comandos           03 MNU-GLS-NMCM                              PIC X(07).      *      *       Libreria Mapa Comandos           03 MNU-GLS-LMCM                              PIC X(07).      *      *       Accion a ejecutar con Mapa comandos           03 MNU-COD-AMCM                              PIC X(01).      *      *       Disponible Futuras Ampliaciones           03 MNU-GLS-DISP                              PIC X(162).      *      *    Variables de Menu       01  MNU-VARI.      *      *    Nombre de Programa FIO para Menu           03  MNU-GLS-FMNU.      *      *        Codigo Sistema               05  MNU-COD-STMA                         PIC X(03).      *      *        Nombre "fijo" de FIO Menu               05  MNU-COD-FMNU.                   07 FILLER                VALUE "P"   PIC X(01).                   07 MNU-COD-SMNU                      PIC X(01).                   07 FILLER                VALUE "MNU" PIC X(03).?SECTION GNSWCFIO, ANSI      *    Constantes para las rutinas FIO"s       01  FIO-CTTS.      *      *    DEFault access for other users           03 FIO-ACCS-DEF        VALUE 0       PIC 9(01).      *      *    NOT     access for other users           03 FIO-ACCS-NOT        VALUE 1       PIC 9(01).      *      *    INPut   access for other users           03 FIO-ACCS-INP        VALUE 2       PIC 9(01).      *      *    UPDate  access for other users           03 FIO-ACCS-UPD        VALUE 3       PIC 9(01).      *      *    FIO     control on record locked           03 FIO-RLCK-FIO        VALUE 0       PIC 9(01).      *      *    ProGraM control on record locked           03 FIO-RLCK-PGM        VALUE 1       PIC 9(01).      *      *    FIO     control on input file not found           03 FIO-IFNF-FIO        VALUE 0       PIC 9(01).      *      *    ProGraM control on input file not found           03 FIO-IFNF-PGM        VALUE 1       PIC 9(01).      *      *    Status Registro Inexistente           03 FIO-STAT-NEX                      PIC X(02) VALUE "39".      *      *    Comandos para las rutinas FIO"s           03 FIO-VCMN.      *      *       Read Key              05 FIO-GET-KEY           VALUE  1 PIC 9(04).      *      *       Read Next              05 FIO-GET-NXT           VALUE  2 PIC 9(04).      *      *       Start First + Read Next              05 FIO-GET-FST           VALUE  3 PIC 9(04).      *      *       Start Not Less + Read Next              05 FIO-GET-NLS           VALUE  4 PIC 9(04).      *      *       Start Greater + Read Next              05 FIO-GET-GRT           VALUE  5 PIC 9(04).      *      *       Write              05 FIO-PUT               VALUE  6 PIC 9(04).      *      *       Rewrite              05 FIO-MOD               VALUE  7 PIC 9(04).      *      *       Delete              05 FIO-DEL               VALUE  8 PIC 9(04).      *      *       Change              05 FIO-CHG               VALUE  9 PIC 9(04).      *      *       Open Input              05 FIO-INP               VALUE 10 PIC 9(04).      *      *       Open Output              05 FIO-OUT               VALUE 11 PIC 9(04).      *      *       Open I-O              05 FIO-UPD               VALUE 12 PIC 9(04).      *      *       Close              05 FIO-CLO               VALUE 13 PIC 9(04).      *      *       Start Equal              05 FIO-FND-EQL           VALUE 14 PIC 9(04).      *      *       Start First              05 FIO-FND-FST           VALUE 15 PIC 9(04).      *      *       Start Not Less              05 FIO-FND-NLS           VALUE 16 PIC 9(04).      *      *       Start Greater              05 FIO-FND-GRT           VALUE 17 PIC 9(04).      *      *       Unlock Record              05 FIO-ULK-REC           VALUE 18 PIC 9(04).      *      *       Unlock All              05 FIO-ULK-ALL           VALUE 19 PIC 9(04).      *      *       Value of ID              05 FIO-VID               VALUE 20 PIC 9(04).      *      *       Acceso              05 FIO-ACC               VALUE 21 PIC 9(04).      *      *       Record Locked              05 FIO-REC-LCK           VALUE 22 PIC 9(04).      *      *       File Not Found              05 FIO-FNF               VALUE 23 PIC 9(04).      *      *       Record Length              05 FIO-REC-LEN           VALUE 24 PIC 9(04).      *      *       Open Extend              05 FIO-EXT               VALUE 25 PIC 9(04).      *      *       Read Key ( Alternate Key )              05 FIO-GET-KEY-ALT       VALUE 26 PIC 9(04).      *      *       Start First + Read Next ( Alternate Key )              05 FIO-GET-FST-ALT       VALUE 27 PIC 9(04).      *      *       Start Not Less + Read Next ( Alternate Key )              05 FIO-GET-NLS-ALT       VALUE 28 PIC 9(04).      *      *       Start Greater + Read Next ( Alternate Key )              05 FIO-GET-GRT-ALT       VALUE 29 PIC 9(04).      *      *       Start Equal ( Alternate Key )              05 FIO-FND-EQL-ALT       VALUE 30 PIC 9(04).      *      *       Start First ( Alternate Key )              05 FIO-FND-FST-ALT       VALUE 31 PIC 9(04).      *      *       Start Not Less ( Alternate Key )              05 FIO-FND-NLS-ALT       VALUE 32 PIC 9(04).      *      *       Start Greater ( Alternate Key )              05 FIO-FND-GRT-ALT       VALUE 33 PIC 9(04).      *      *       Get Next con llave Alternativa              05 FIO-GET-NXT-ALT       VALUE 34 PIC 9(04).      *      *       Get Key Update con llave Alternativa              05 FIO-GET-KEY-UPD-ALT   VALUE 35 PIC 9(04).      *      *       Get Key Update              05 FIO-GET-KEY-UPD       VALUE 36 PIC 9(04).      *      *       End Browse              05 FIO-END-BRW           VALUE 37 PIC 9(04).      *      *       Back Out Transaction              05 FIO-BCK-OUT           VALUE 38 PIC 9(04).      *      *       Get Less or Equal              05 FIO-GET-LEQ           VALUE 39 PIC 9(04).      *      *       Get Previous              05 FIO-GET-PRV           VALUE 40 PIC 9(04).      *      *       Check Point              05 FIO-CHK-PNT           VALUE 41 PIC 9(04).      *      *       Buffer Refresh              05 FIO-BFR-RFH           VALUE 42 PIC 9(04).      *      *       End Browse All              05 FIO-EBR-ALL           VALUE 43 PIC 9(04).      *      *       All file Locked              05 FIO-ALL-LCK           VALUE 44 PIC 9(04).      *           03 FIO-VCMN-RED    REDEFINES FIO-VCMN.              05 FIO-IDX-VCMN OCCURS 44 TIMES   PIC 9(04).      *      *    Programa que usa servicio de FIO           03 FIO-PROG                          PIC X(08).      *      *    Valor de Key           03 FIO-VKEY                          PIC X(180).      *      *    Valor de Key para Comparacion con FIO-VKEY   ( VSI )           03 FIO-CKEY                          PIC X(180).      *      *    Key Length           03 FIO-KLEN  COMP                    PIC S9(4).      *      *    Indicador de uso de Llave alternativa           03 FIO-IAKY                 VALUE  0 PIC 9(04).              88 FIO-IAKY-CON          VALUE 26 THRU 35.      *      *    Indicador de uso de Llave alternativa           03 FIO-IGET                 VALUE  0 PIC 9(04).              88 FIO-IGET-YES          VALUE  1 THRU 5, 26 THRU 29,                                             34, 35, 36, 39, 40.              88 FIO-ICBR-YES          VALUE  2, 34, 40.      *      *    Indicador de Llaves de Default           03 FIO-KDEF                 VALUE 0 PIC 9(01).           03 FIO-KDEF-N               VALUE 0 PIC 9(01).           03 FIO-KDEF-S               VALUE 1 PIC 9(01).      *      *    Indicador de primera VEZ      *     03 FIO-IVEZ            VALUE SPACES PIC X(01).      *      *    Vector de status de archivos      *     03 FIO-MSFL VALUE SPACES.      *        05 FIO-VSFL OCCURS 20 INDEXED BY FIO-ITBL.      *           07 FIO-NFIL                   PIC X(07).      *      *    Indice maximo      *     03 FIO-MXFL               VALUE 20  PIC 9(02).      *      *    Indicador de Start-Browse abierto      *     03 FIO-ISBR               VALUE "N" PIC X(01).      *      *    Indice auxiliar      *     03 FIO-IAUX               VALUE 0   PIC 9(02).      *      *    Variable de Salida de Server de I/O           03 FIO-SRVO                          PIC X(1689).?SECTION GNSWVFIO, ANSI      *    Variables para las rutinas FIO"s      *    ( Linkage Section para VSAM BATCH )       01  FIO-VARI.      *      *    Codigo de Respuesta para Server           03 FIO-RPLY                             COMP PIC S9(04).      *      *    Nombre de la llave alternativa           03 FIO-AKEY                                  PIC X(32).      *      *    Esta variable FILE STATUS es el codigo de retorno      *    de las subrutinas FIO           03 FIO-STAT.      *      *          Created Duplicate Key                 88 FIO-STAT-CDK        VALUE "02".      *      *          Length Record not conform to the file attributes                 88 FIO-STAT-LRN        VALUE "04".      *      *          Referenced optional file is not presented                 88 FIO-STAT-RON        VALUE "05".      *      *          Requested option could not be done                 88 FIO-STAT-RQN        VALUE "07".      *      *          End Of File                 88 FIO-STAT-EOF        VALUE "10".      *      *          Sequential Read Loss                 88 FIO-STAT-SRL        VALUE "14".      *      *          No Ascending Key                 88 FIO-STAT-NAK        VALUE "21".      *      *          Duplicate Alternate Key                 88 FIO-STAT-DAK        VALUE "22".      *      *          Duplicate Master Key                 88 FIO-STAT-DMK        VALUE "22".      *      *          Record Not Found                 88 FIO-STAT-RNF        VALUE "23".      *      *          Invalid Master Key                 88 FIO-STAT-IMK        VALUE "23".      *      *          Invalid KeY                 88 FIO-STAT-IKY        VALUE "22" "23".      *      *          Boundary Violation Error                 88 FIO-STAT-BVE        VALUE "24" "34" "44".      *      *          Other Permanent Errors                 88 FIO-STAT-OPE        VALUE "30" "35" "37" "38".      *      *          Conflict file attributes and attributes especified                 88 FIO-STAT-CFA        VALUE "39".      *      *          Open for file already Open                 88 FIO-STAT-OAO        VALUE "41".      *      *          File Not Open                 88 FIO-STAT-FNO        VALUE "42".      *      *          Record Not Read                 88 FIO-STAT-RNR        VALUE "43".      *      *          Sequential Read without Prerequisite                 88 FIO-STAT-SRP        VALUE "46".      *      *          Read/start on file not open                 88 FIO-STAT-RNO        VALUE "47".      *      *          Write on File Not Open                 88 FIO-STAT-WNO        VALUE "48".      *      *          Delete/rewrite on file Not Open                 88 FIO-STAT-DNO        VALUE "49".      *      *          LoGic Error                 88 FIO-STAT-LGE        VALUE "90".      *      *          I-O Error                 88 FIO-STAT-IOE        VALUE "91".      *      *          File Integrity Verified                 88 FIO-STAT-FIV        VALUE "97".      *      *          Fatal                 88 FIO-STAT-FTL        VALUE "99".      *                 05 FIO-STT1                    PIC 9(01).      *      *               OK Status                      88 FIO-STAT-OKS   VALUE 0.      *      *               At End Status                      88 FIO-STAT-AES   VALUE 1.      *      *               Invalid Key Status                      88 FIO-STAT-IKS   VALUE 2.      *      *               Permanent Error                      88 FIO-STAT-ERR   VALUE 3.      *      *               Logic Error                      88 FIO-STAT-LOG   VALUE 4.      *      *               Implementor Defined Error                      88 FIO-STAT-IDE   VALUE 9.      *                 05 FIO-STT2                    PIC 9(01).      *      *               No Further Information                      88 FIO-STAT-NFI   VALUE 0.      *      *               SEQuential access                      88 FIO-STAT-SEQ   VALUE 1.      *      *               DUPlicates                      88 FIO-STAT-DUP   VALUE 2.      *      *               No Current Record                      88 FIO-STAT-NCR   VALUE 3.      *      *    Esta variable RELATIVE KEY indica a las subrutinas FIO      *    la llave de un archivo relativo para su acceso.           03 FIO-RKEY          COMP            PIC 9(09).      *      *    Comando de las Subrutinas FIO           03 FIO-CMND                          PIC 9(04).      *      *    Esta variable  ACCESS indica a las subrutinas      *    FIO la forma de abrir un archivo en cuanto al      *    acceso desde otros programas           03 FIO-ACCS                      PIC 9(01).      *      *       0 = DEFault access      *       1 = NOT     access      *       2 = INPut   access      *       3 = UPDate  access      *      *    Esta variable RECORD LOCKED indica a las subrutinas      *    FIO si tomar o no el control cuando hay un registro      *    ocupado           03 FIO-RLCK                      PIC 9(01).      *      *       0 = FIO     control on record locked ( Default )      *       1 = ProGraM control on record locked      *      *    Esta variable INPUT FILE NOT FOUND indica a las      *    subrutinas  FIO si tomar o no el control cuando      *    al abrir un archivo de Input, este no existe           03 FIO-IFNF                      PIC 9(01).      *      *       0 = FIO     control on file not found      *       1 = ProGraM control on file not found      *      *    Esta  variable  RECORD LENGTH  debe ser  llenada  con el      *    largo  del  registro, para  registros de largo variable,      *    antes de llamar a las subrutinas FIO con comando REC_LEN           03 FIO-RLEN     COMP                 PIC S9(04).      *      *    Value Of ID           03 FIO-VOID.      *      *       Sistema              05 FIO-SIST                       PIC X(03).      *      *       Tipo              05 FIO-FTYP                       PIC X(01).      *      *       Nombre              05 FIO-FNAM                       PIC X(04).      *      *    Filler Para uso Futuro           03 FILLER                            PIC X(16).      *      *    Buffer generico para registros           03  FIO-DFLD                         PIC X(1536).      *      *    Mensaje           03 FIO-MENS.      *      *       Mensaje 1              05 FIO-MEN1                       PIC X(71).      *      *       Mensaje 2              05 FIO-MEN2                       PIC X(09).      *           03 FIO-MENS-RED REDEFINES FIO-MENS.              05 FIO-MENS-DSC                   PIC X(13).              05 FILLER                         PIC X(01).              05 FIO-MENS-STT                   PIC X(02).              05 FIO-MENS-NTT REDEFINES FIO-MENS-STT PIC 9(02).              05 FIO-MENS-SST                   PIC X(01).              05 FILLER                         PIC X(01).              05 FIO-MENS-GKY                   PIC X(03).              05 FILLER                         PIC X(01).              05 FIO-MENS-KEY                   PIC X(32).              05 FIO-MENS-KEY-RED REDEFINES FIO-MENS-KEY.                 07 FIO-MENS-KDT                PIC X(05).                 07 FILLER                      PIC X(01).                 07 FIO-MENS-GBD                PIC X(10).                 07 FILLER                      PIC X(01).                 07 FIO-MENS-DBI                PIC X(05).                 07 FILLER                      PIC X(10).              05 FILLER                         PIC X(01).              05 FIO-MENS-GCM                   PIC X(03).              05 FILLER                         PIC X(01).              05 FIO-MENS-CMD                   PIC X(05).              05 FILLER                         PIC X(01).              05 FIO-MENS-GFL                   PIC X(04).              05 FILLER                         PIC X(01).              05 FIO-MENS-FIL                   PIC X(09).              05 FIO-MENS-FIL-RED REDEFINES FIO-MENS-FIL.                 07 FIO-MENS-SIS                PIC X(03).                 07 FIO-MENS-REG                PIC X(06).              05 FILLER                         PIC X(01).?SECTION GNSWCFRM, ANSI      *Constantes para manejo de formularios       01  FRM-CTTS.           03 FRM-INI                 PIC 9(02) VALUE 1.           03 FRM-GET-ALL             PIC 9(02) VALUE 2.           03 FRM-PUT-ALL             PIC 9(02) VALUE 3.           03 FRM-CLR-ALL             PIC 9(02) VALUE 4.           03 FRM-MSG                 PIC 9(02) VALUE 5.           03 FRM-RCV                 PIC 9(02) VALUE 6.           03 FRM-CLR-FRM             PIC 9(02) VALUE 7.           03 FRM-SINI-DB1F           PIC 9(01) VALUE 0.           03 FRM-SINI-DBNF           PIC 9(01) VALUE 1.           03 FRM-SINI-DBLF           PIC 9(01) VALUE 2.           03 FRM-SINI-MB1F           PIC 9(01) VALUE 3.           03 FRM-SINI-MBNF           PIC 9(01) VALUE 4.           03 FRM-SINI-MBLF           PIC 9(05) VALUE 5.           03 FRM-FFLD-TAB       COMP PIC 9(05) VALUE 0.           03 FRM-FFLD-PF1       COMP PIC 9(05) VALUE 1.           03 FRM-FFLD-PF2       COMP PIC 9(05) VALUE 2.           03 FRM-FFLD-PF3       COMP PIC 9(05) VALUE 3.           03 FRM-FFLD-PF4       COMP PIC 9(05) VALUE 4.           03 FRM-FFLD-PF5       COMP PIC 9(05) VALUE 5.           03 FRM-FFLD-PF6       COMP PIC 9(05) VALUE 6.           03 FRM-FFLD-PF7       COMP PIC 9(05) VALUE 7.           03 FRM-FFLD-PF8       COMP PIC 9(05) VALUE 8.           03 FRM-FFLD-PF9       COMP PIC 9(05) VALUE 9.      *    03 FRM-FFLD-PF10      COMP PIC 9(05) VALUE 10.           03 FRM-FFLD-PF10      COMP PIC 9(05) VALUE 99.           03 FRM-FFLD-PF11      COMP PIC 9(05) VALUE 11.           03 FRM-FFLD-PF12      COMP PIC 9(05) VALUE 12.           03 FRM-FFLD-PFA       COMP PIC 9(05) VALUE 1.           03 FRM-FFLD-PFB       COMP PIC 9(05) VALUE 2.           03 FRM-FFLD-PFC       COMP PIC 9(05) VALUE 3.           03 FRM-FFLD-PFD       COMP PIC 9(05) VALUE 4.           03 FRM-FFLD-PFE       COMP PIC 9(05) VALUE 5.           03 FRM-FFLD-PFF       COMP PIC 9(05) VALUE 6.           03 FRM-FFLD-PFG       COMP PIC 9(05) VALUE 7.           03 FRM-FFLD-PFH       COMP PIC 9(05) VALUE 8.           03 FRM-FFLD-PFI       COMP PIC 9(05) VALUE 9.           03 FRM-FFLD-PFJ       COMP PIC 9(05) VALUE 10.           03 FRM-FFLD-PFK       COMP PIC 9(05) VALUE 11.           03 FRM-FFLD-PFL       COMP PIC 9(05) VALUE 12.           03 FRM-FFLD-RET       COMP PIC 9(05) VALUE 10.           03 FRM-FFLD-PA1       COMP PIC 9(05) VALUE 14.           03 FRM-FFLD-PA2       COMP PIC 9(05) VALUE 15.           03 FRM-FFLD-PA3       COMP PIC 9(05) VALUE 16.           03 FRM-SUAR-MAL            PIC X(3) VALUE "MAL".           03 FRM-SUAR-WRN            PIC X(3) VALUE "WRN".           03 FRM-SUAR-CLR            PIC X(3) VALUE "CLR".           03 FRM-SUAR-OKS            PIC X(3) VALUE "OKS".           03 FRM-CPIM.              05 FRM-CPIM-AEY         PIC X(01) VALUE "&".              05 FRM-CPIM-UBY         PIC X(01) VALUE "'".              05 FRM-CPIM-ANY         PIC X(01) VALUE "&".              05 FRM-CPIM-UNY         PIC X(01) VALUE "'".              05 FRM-CPSF-AEY         PIC X(01) VALUE "&".           03 FRM-POS-CURS   VALUE -1 PIC S9(02).           03 FRM-IND-ERRO   VALUE -9 PIC S9(02).           03 FRM-ERR-NUME   VALUE -9 PIC S9(02).?SECTION GNSWVFRM, ANSI      *Variables para Manejo Generico de Formularios       01  FRM-VARI.           03 FRM-STAT                PIC X(03).              88 FRM-STAT-OKS   VALUE "OKS".              88 FRM-STAT-ABT   VALUE "ABT".           03 FRM-NAME                PIC X(007).           03 FRM-NLIB                PIC X(007).           03 FRM-UCUR                PIC X(01).           03 FRM-DFLD                PIC X(2500).           03 FRM-IFLD                PIC 9(04).           03 FRM-MENS                PIC X(79).           03 FRM-MENS-RED REDEFINES  FRM-MENS.              05 FRM-MEN1             PIC X(40).              05 FRM-MEN2             PIC X(39).           03 FRM-FFLD                PIC 9(05).           03 FRM-SUAR                PIC X(03).           03 FRM-SINI                PIC 9(01).           03 FRM-CMND                PIC 9(02).           03 FILLER                  PIC X(15).?SECTION GNSWVSCR, ANSI       01  SCR-VARI.           03 SCR-CMAG.              05 SCR-TCMA                    PIC S9(04).              05 SCR-SIST                    PIC X(03).              05 SCR-SISG                    PIC X(03).              05 SCR-NTRN                    PIC X(04).              05 SCR-PROG                    PIC X(08).              05 SCR-NTRV                    PIC X(04).              05 SCR-PROV                    PIC X(08).              05 SCR-NLIB                    PIC X(07).              05 SCR-NMAP                    PIC X(07).              05 SCR-RFBY                    PIC X(01).              05 SCR-STAT                    PIC X(01).              05 SCR-INST                    PIC X(03).              05 SCR-ACTU                    PIC X(03).              05 SCR-CMNP                    PIC X(08).              05 SCR-CRPF.                 07 SCR-CMND                 PIC X(03).                 07 SCR-CCPP                 PIC X(03).                 07 SCR-STPP                 PIC X(01).                 07 SCR-PRMT                 PIC X(25).                 07 SCR-CONF                 PIC X(25).              05 SCR-USER                    PIC X(12).              05 SCR-OTRN                    PIC X(04).              05 SCR-UMOD                    PIC X(14).              05 SCR-ICMN                    PIC X(01).                 88 SCR-DESDE-MEN VALUE "M".                 88 SCR-DESDE-HDR VALUE "H".                 88 SCR-DESDE-CMN VALUE "C".                 88 SCR-DESDE-PGM VALUE "P".              05 SCR-QIDD                    PIC X(08).              05 SCR-LIDD                    PIC S9(04).      *              05 SCR-NEMO                    PIC X(12).              05 SCR-LDOC                    PIC X(12).              05 SCR-NDOC                    PIC X(25).              05 SCR-FRET                    PIC X(12).              05 SCR-IPRV                    PIC X(01).      *              05 SCR-MFLD                    PIC X(01).              05 SCR-VFLD                    PIC X(01).              05 SCR-FFLD                    PIC 9(05).                 88 SCR-FFLD-RET   VALUE 10.                 88 SCR-FFLD-PF1   VALUE 1.                 88 SCR-FFLD-PF2   VALUE 2.                 88 SCR-FFLD-PF3   VALUE 3.                 88 SCR-FFLD-PF4   VALUE 4.                 88 SCR-FFLD-PF5   VALUE 5.                 88 SCR-FFLD-PF6   VALUE 6.                 88 SCR-FFLD-PF7   VALUE 7.                 88 SCR-FFLD-PF8   VALUE 8.                 88 SCR-FFLD-PF9   VALUE 9.      *          88 SCR-FFLD-PF10  VALUE 10.                 88 SCR-FFLD-PF10  VALUE 99.                 88 SCR-FFLD-PF11  VALUE 11.                 88 SCR-FFLD-PF12  VALUE 12.                 88 SCR-FFLD-PFA   VALUE 1.                 88 SCR-FFLD-PFB   VALUE 2.                 88 SCR-FFLD-PFC   VALUE 3.                 88 SCR-FFLD-PFD   VALUE 4.                 88 SCR-FFLD-PFE   VALUE 5.                 88 SCR-FFLD-PFF   VALUE 6.                 88 SCR-FFLD-PFG   VALUE 7.                 88 SCR-FFLD-PFH   VALUE 8.                 88 SCR-FFLD-PFI   VALUE 9.                 88 SCR-FFLD-PFJ   VALUE 10.                 88 SCR-FFLD-PFK   VALUE 11.                 88 SCR-FFLD-PFL   VALUE 12.              05 SCR-OFIC                    PIC X(03).              05 SCR-DISP                    PIC X(14).?SECTION GNSBSMNU, ANSI      * Modulo FIO Server para archivo GNSMNU, 20-MAR-1995 21:45:25.74       GNS-FIO-MNU SECTION.       INI-GNS-FIO-MNU.           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.           IF FIO-CMND = FIO-CHK-PNT               CHECKPOINT               GO TO FIN-GNS-FIO-MNU.           MOVE MNU TO FIO-DFLD.           MOVE FIO-SIST TO MNU-COD-STMA IN MNU-VARI.           MOVE "S"      TO MNU-COD-SMNU IN MNU-VARI.           SEND FIO-VARI TO MNU-GLS-FMNU IN MNU-VARI                REPLY CODE 0 YIELDS FIO-MSGO-RMNU                ON ERROR GO TO ERR-GNS-FIO-MNU.           MOVE FIO-OUTP-RMNU TO FIO-VARI.           IF TERMINATION-STATUS = 1 AND              FIO-STAT-OKS AND FIO-IGET-YES                   MOVE FIO-DFLD TO MNU           ELSE           IF NOT FIO-STAT-OKS               MOVE FIO-SIST TO FIO-MENS-SIS               MOVE "MNU"    TO FIO-MENS-REG               IF FIO-STAT-FTL                   PERFORM GNS-PRG-ABT.           GO TO FIN-GNS-FIO-MNU.       ERR-GNS-FIO-MNU.           MOVE "Error llamada Server:"   TO FIO-MEN1.           MOVE MNU-GLS-FMNU IN MNU-VARI  TO FIO-MENS-KEY.           MOVE "Stat:"                   TO FIO-MENS-CMD.           MOVE TERMINATION-STATUS        TO FIO-MENS-GFL.           MOVE TERMINATION-SUBSTATUS     TO FIO-MENS-FIL.           PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-MNU.           EXIT.?SECTION GNSBSMSG, ANSI      * Modulo FIO Server para archivo GNSMSG, 22-MAR-1995 14:54:57.67       GNS-FIO-MSG SECTION.       INI-GNS-FIO-MSG.           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.      *JSS           MOVE "MSG" TO MSG-COD-TTAB IN MSG                         MSG-CIC-TTAB IN MSG                         MSG-EXT-TTAB IN MSG                         MSG-SNX-TTAB IN MSG.      *           IF FIO-CMND = FIO-CHK-PNT               CHECKPOINT               GO TO FIN-GNS-FIO-MSG.           MOVE MSG TO FIO-DFLD.           MOVE FIO-SIST TO MSG-COD-SIST IN MSG-VARI.           MOVE "S"      TO MSG-COD-SMSG IN MSG-VARI.           SEND FIO-VARI TO MSG-GLS-FMSG IN MSG-VARI                REPLY CODE 0 YIELDS FIO-SRVO                ON ERROR GO TO ERR-GNS-FIO-MSG.           MOVE FIO-SRVO TO FIO-VARI.           IF TERMINATION-STATUS = 1 AND              FIO-STAT-OKS AND FIO-IGET-YES                   MOVE FIO-DFLD TO MSG           ELSE           IF NOT FIO-STAT-OKS               MOVE FIO-SIST TO FIO-MENS-SIS               MOVE "TAB"    TO FIO-MENS-REG               IF FIO-STAT-FTL                   PERFORM GNS-PRG-ABT.           GO TO FIN-GNS-FIO-MSG.       ERR-GNS-FIO-MSG.           MOVE "Error llamada Server:"   TO FIO-MEN1.           MOVE MSG-GLS-FMSG IN MSG-VARI  TO FIO-MENS-KEY.           MOVE "Stat:"                   TO FIO-MENS-CMD.           MOVE TERMINATION-STATUS        TO FIO-MENS-GFL.           MOVE TERMINATION-SUBSTATUS     TO FIO-MENS-FIL.           PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-MSG.           EXIT.?SECTION GNSBSRPF, ANSI      * Modulo FIO Server para archivo GNSRPF, 20-MAR-1995 21:45:25.74       GNS-FIO-RPF SECTION.       INI-GNS-FIO-RPF.           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.           IF FIO-CMND = FIO-CHK-PNT               CHECKPOINT               GO TO FIN-GNS-FIO-RPF.           MOVE RPF TO FIO-DFLD.           MOVE FIO-SIST TO RPF-COD-SIST IN RPF-VARI.           MOVE "S"      TO RPF-COD-SRPF IN RPF-VARI.           SEND FIO-VARI TO RPF-GLS-FRPF IN RPF-VARI                REPLY CODE 0 YIELDS FIO-MSGO-RRPF                ON ERROR GO TO ERR-GNS-FIO-RPF.           MOVE FIO-OUTP-RRPF TO FIO-VARI.           IF TERMINATION-STATUS = 1 AND              FIO-STAT-OKS AND FIO-IGET-YES                   MOVE FIO-DFLD TO RPF           ELSE           IF NOT FIO-STAT-OKS               MOVE FIO-SIST TO FIO-MENS-SIS               MOVE "RPF"    TO FIO-MENS-REG               IF FIO-STAT-FTL                   PERFORM GNS-PRG-ABT.           GO TO FIN-GNS-FIO-RPF.       ERR-GNS-FIO-RPF.           MOVE "Error llamada Server:"   TO FIO-MEN1.           MOVE RPF-GLS-FRPF IN RPF-VARI  TO FIO-MENS-KEY.           MOVE "Stat:"                   TO FIO-MENS-CMD.           MOVE TERMINATION-STATUS        TO FIO-MENS-GFL.           MOVE TERMINATION-SUBSTATUS     TO FIO-MENS-FIL.           PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-RPF.           EXIT.?SECTION GNSBSTAB, ANSI      * Modulo FIO Server para archivo GNSTAB, 22-MAR-1995 14:47:50.93       GNS-FIO-TAB SECTION.       INI-GNS-FIO-TAB.           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.           IF FIO-CMND = FIO-CHK-PNT               CHECKPOINT               GO TO FIN-GNS-FIO-TAB.           IF FIO-CMND = FIO-PUT OR FIO-MOD               MOVE TAB-COD-TTAB IN TBL TO TAB-CIC-TTAB IN TBL                                           TAB-EXT-TTAB IN TBL                                           TAB-SNX-TTAB IN TBL.           MOVE TBL TO FIO-DFLD.           MOVE FIO-SIST TO TAB-COD-SIST IN TAB-VARI.           MOVE "S"      TO TAB-COD-STAB IN TAB-VARI.           SEND FIO-VARI TO TAB-GLS-FTAB IN TAB-VARI                REPLY CODE 0 YIELDS FIO-SRVO                ON ERROR GO TO ERR-GNS-FIO-TAB.           MOVE FIO-SRVO TO FIO-VARI.           IF TERMINATION-STATUS = 1 AND              FIO-STAT-OKS AND FIO-IGET-YES                   MOVE FIO-DFLD TO TBL           ELSE           IF NOT FIO-STAT-OKS               MOVE FIO-SIST TO FIO-MENS-SIS               MOVE "TAB"    TO FIO-MENS-REG               IF FIO-STAT-FTL                   PERFORM GNS-PRG-ABT.           GO TO FIN-GNS-FIO-TAB.       ERR-GNS-FIO-TAB.           MOVE "Error llamada Server:"   TO FIO-MEN1.           MOVE TAB-GLS-FTAB IN TAB-VARI  TO FIO-MENS-KEY.           MOVE "Stat:"                   TO FIO-MENS-CMD.           MOVE TERMINATION-STATUS        TO FIO-MENS-GFL.           MOVE TERMINATION-SUBSTATUS     TO FIO-MENS-FIL.           PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-TAB.           EXIT.?SECTION GNSBPFRM, ANSI      ********************* FRM *********************       GNS-PRO-FRM SECTION.       INI-GNS-PRO-FRM.           GO TO IFR-GNS-PRO-FRM GTA-GNS-PRO-FRM PTA-GNS-PRO-FRM                 CLA-GNS-PRO-FRM MSG-GNS-PRO-FRM RCV-GNS-PRO-FRM                 CLF-GNS-PRO-FRM           DEPENDING ON FRM-CMND.           MOVE "ABORTO, comando invalido en GNS-PRO-FRM:" TO SYS-MEN1.           MOVE FRM-CMND                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.      *Inicializa Formulario       IFR-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-IFR-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Recibe todos ( all ) los campos del formulario y unifica teclas       GTA-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.           IF FRM-FFLD = FRM-FFLD-PF3  OR FRM-FFLD-PF12               MOVE "ABT" TO FRM-STAT.       FIN-GTA-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Despliega todos los campos de un formulario       PTA-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-PTA-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Limpia todos los campos de un formulario       CLA-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-CLA-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Despliega un mensaje en pantalla       MSG-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-MSG-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Recibe toda la pantalla       RCV-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-RCV-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.      *Limpia pantalla desde linea de inicio ( PLIN ) n lineas ( NLIN )       CLF-GNS-PRO-FRM.           CALL FRM-NLIB USING FRM-VARI.       FIN-CLF-GNS-PRO-FRM.           GO TO FIN-GNS-PRO-FRM.       FIN-GNS-PRO-FRM.           EXIT.?SECTION GNSBGHOY, ANSI      * Obtiene Fecha y Hora Actual       GET-FHOY SECTION.       INI-GET-FHOY.           MOVE SYS-GET-DATE TO SYS-CMND.           PERFORM GNS-PRO-SYS.           MOVE SYS-DHOY TO HOY-DHOY.           MOVE SYS-MHOY TO HOY-MHOY.           MOVE SYS-SHOY TO HOY-SHOY.           MOVE SYS-AHOY TO HOY-AHOY.           MOVE SYS-HHHY TO HOY-HHHY.           MOVE SYS-MMHY TO HOY-MMHY.           MOVE SYS-SSHY TO HOY-SSHY.       FIN-GET-FHOY.           EXIT.?SECTION GNSBGMSG, ANSI      * Obtencion de Mensaje       GET-MSG SECTION.       INI-GET-MSG.           MOVE SCR-SIST TO FIO-SIST.           MOVE FIO-GET-KEY TO FIO-CMND.           PERFORM GNS-FIO-MSG.           IF FIO-STAT-OKS AND MSG-IND-VIGE NOT = "N"               GO TO FIN-GET-MSG.           IF MSG-COD-SIST NOT = SCR-SIST               MOVE MSG-COD-SIST TO FIO-SIST               MOVE FIO-GET-KEY TO FIO-CMND               PERFORM GNS-FIO-MSG.           IF NOT FIO-STAT-OKS               MOVE MSG-COD-MENS          TO MSG-GLS-DES1 IN MSG               MOVE "MENSAJE INEXISTENTE" TO MSG-GLS-DES2 IN MSG           ELSE               IF MSG-IND-VIGE = "N"                   MOVE MSG-COD-MENS         TO MSG-GLS-DES1 IN MSG                   MOVE "MENSAJE NO VIGENTE" TO MSG-GLS-DES2 IN MSG.       FIN-GET-MSG.           EXIT.?SECTION GNSBGSYS, ANSI      * Rutina de Servicios del Sistema       GNS-PRO-SYS SECTION.       INI-GNS-PRO-SYS.           MOVE SYS-STAT-OKS TO SYS-STAT.           GO TO DAT-GNS-PRO-SYS TIM-GNS-PRO-SYS EXT-GNS-PRO-SYS                 XCT-GNS-PRO-SYS LNK-GNS-PRO-SYS ABT-GNS-PRO-SYS               DEPENDING ON SYS-CMND.           MOVE "ABORTO, comando invalido en GNS-PRO-SYS:" TO SYS-MEN1.           MOVE SYS-CMND                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.       DAT-GNS-PRO-SYS.           ACCEPT SYS-FHOY-DATE FROM DATE.           MOVE SYS-AHOY-DATE TO SYS-AHOY.           MOVE SYS-MHOY-DATE TO SYS-MHOY.           MOVE SYS-DHOY-DATE TO SYS-DHOY.           ACCEPT SYS-HHOY-TIME FROM TIME.           MOVE SYS-HHHY-TIME TO SYS-HHHY.           MOVE SYS-MMHY-TIME TO SYS-MMHY.           MOVE SYS-SSHY-TIME TO SYS-SSHY.           MOVE SYS-CCHY-TIME TO SYS-CCHY.           GO TO FIN-GNS-PRO-SYS.       TIM-GNS-PRO-SYS.           ACCEPT SYS-HHOY-TIME FROM TIME.           MOVE SYS-HHHY-TIME TO SYS-HHHY.           MOVE SYS-MMHY-TIME TO SYS-MMHY.           MOVE SYS-SSHY-TIME TO SYS-SSHY.           MOVE SYS-CCHY-TIME TO SYS-CCHY.           GO TO FIN-GNS-PRO-SYS.       EXT-GNS-PRO-SYS.           MOVE "SI"     TO PGM-EXIT.           MOVE 0        TO PGM-MSGO-COD.           MOVE SCR-VARI TO PGM-MSGO-CMA.           MOVE FRM-VARI TO PGM-MSGO-FRM.           MOVE SYS-VARI TO PGM-MSGO-SYS.           WRITE PGM-MSGO.           MOVE "SI" TO PGM-EXIT.           GO TO FIN-GNS-PRO-SYS.       XCT-GNS-PRO-SYS.           MOVE "ABORTO, comando SYS-XCTL en GNS-PRO-SYS:" TO SYS-MEN1.           MOVE SYS-PROG                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.       LNK-GNS-PRO-SYS.           CALL SYS-PROG USING SYS-CMMA.           GO TO STT-GNS-PRO-SYS.       ABT-GNS-PRO-SYS.           MOVE "S"      TO SYS-BKOU.           MOVE "P"      TO SCR-ICMN.           MOVE "SI"     TO PGM-EXIT.           MOVE 0        TO PGM-MSGO-COD.           MOVE SCR-VARI TO PGM-MSGO-CMA.           MOVE FRM-VARI TO PGM-MSGO-FRM.           MOVE SYS-VARI TO PGM-MSGO-SYS.           WRITE PGM-MSGO.           STOP RUN.       STT-GNS-PRO-SYS.       FIN-GNS-PRO-SYS.           EXIT.?SECTION GNSBPSYS, ANSI      * Rutina de Servicios del Sistema       GNS-PRO-SYS SECTION.       INI-GNS-PRO-SYS.           MOVE SYS-STAT-OKS TO SYS-STAT.           GO TO DAT-GNS-PRO-SYS TIM-GNS-PRO-SYS EXT-GNS-PRO-SYS                 XCT-GNS-PRO-SYS LNK-GNS-PRO-SYS ABT-GNS-PRO-SYS               DEPENDING ON SYS-CMND.           MOVE "ABORTO, comando invalido en GNS-PRO-SYS:" TO SYS-MEN1.           MOVE SYS-CMND                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.       DAT-GNS-PRO-SYS.           ACCEPT SYS-FHOY-DATE FROM DATE.           MOVE SYS-AHOY-DATE TO SYS-AHOY.           MOVE SYS-MHOY-DATE TO SYS-MHOY.           MOVE SYS-DHOY-DATE TO SYS-DHOY.           ACCEPT SYS-HHOY-TIME FROM TIME.           MOVE SYS-HHHY-TIME TO SYS-HHHY.           MOVE SYS-MMHY-TIME TO SYS-MMHY.           MOVE SYS-SSHY-TIME TO SYS-SSHY.           MOVE SYS-CCHY-TIME TO SYS-CCHY.           GO TO FIN-GNS-PRO-SYS.       TIM-GNS-PRO-SYS.           ACCEPT SYS-HHOY-TIME FROM TIME.           MOVE SYS-HHHY-TIME TO SYS-HHHY.           MOVE SYS-MMHY-TIME TO SYS-MMHY.           MOVE SYS-SSHY-TIME TO SYS-SSHY.           MOVE SYS-CCHY-TIME TO SYS-CCHY.           GO TO FIN-GNS-PRO-SYS.       EXT-GNS-PRO-SYS.           MOVE "ABORTO, comando SYS-RTRN en GNS-PRO-SYS:" TO SYS-MEN1.           MOVE SYS-NTRN                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.       XCT-GNS-PRO-SYS.           MOVE "ABORTO, comando SYS-XCTL en GNS-PRO-SYS:" TO SYS-MEN1.           MOVE SYS-PROG                                   TO SYS-MEN2.           GO TO ABT-GNS-PRO-SYS.       LNK-GNS-PRO-SYS.           CALL SYS-PROG USING SYS-CMMA.           GO TO STT-GNS-PRO-SYS.       ABT-GNS-PRO-SYS.           CALL "GNSPPABT" USING SYS-MENS.           ABORT-TRANSACTION.       STT-GNS-PRO-SYS.       FIN-GNS-PRO-SYS.           EXIT.?SECTION GNSBRMSG, ANSI      *    Registro Generico de Mensajes      *    -----------------------------      *       *    Nombre Registro : MSG        *    Clave(s)        : MSG-COD-TABL(UU), MSG-STP-ITRN(UU),      *                      MSG-CIC-TABL(UU), MSG-EXT-TABL(UU)      *    Largo           : 194      *    Bloqueo         : 2      *    Observaciones   :       *       01  MSG.       *      *    Filler Compatibilidad VSAM/MVS           03  MSG-GLS-FLAG                             PIC X(01).            *      *    Clave Primaria Registro           03  MSG-KEY-IREG.      *      *KEY     Tipo + Codigo ( LLave Primaria )               05  MSG-COD-TABL.      *      *            Codigo Tipo Tabla                   07  MSG-COD-TTAB                     PIC X(03).      *      *            Codigo Mensaje                   07  MSG-COD-MENS.      *      *                Tipo Mensaje                       09  MSG-COD-TMSG                 PIC X(07).      *      *                Codigo Mensaje                       09  MSG-COD-CMSG                 PIC X(05).      *      *        Time Stamp Transaccion               05  MSG-STP-ITRN.      *      *            Fecha Transaccion                   07  MSG-FEC-FTRN.                       09  MSG-NUM-STRN                 PIC 9(02).                       09  MSG-NUM-ATRN                 PIC 9(02).                       09  MSG-NUM-MTRN                 PIC 9(02).                       09  MSG-NUM-DTRN                 PIC 9(02).      *      *            Hora Transaccion                   07  MSG-HRA-HRTR.                       09  MSG-NUM-HHTR                 PIC 9(02).                       09  MSG-NUM-MMTR                 PIC 9(02).                       09  MSG-NUM-SSTR                 PIC 9(02).      *      *    Indicador Tipo Accion           03  MSG-MSC-TACC                             PIC X(01).      *      *    Indicador Status           03  MSG-MSC-STAT                             PIC X(01).      *      *    Indicador Vigencia                           GNS VIGE           03  MSG-IND-VIGE  REDEFINES  MSG-MSC-STAT    PIC X(01).      *      *    Codigo Origen Transaccion           03  MSG-COD-OTRN.      *      *        Indicador Tipo Origen               05  MSG-MSC-TTRN                         PIC X(01).      *      *        Codigo Tipo Origen               05  MSG-COD-TTRN                         PIC X(03).      *      *    Autor Transaccion           03  MSG-COD-ATRN                             PIC X(12).                  *      *KEY Tipo + Codigo ( Interno Computacional )           03  MSG-CIC-TABL.      *      *        Codigo Tipo Tabla               05  MSG-CIC-TTAB                         PIC X(03).      *      *        Codigo Mensaje               05  MSG-CIC-MENS.      *      *            Tipo Mensaje                   07  MSG-CIC-TMSG                     PIC X(07).      *      *            Codigo Mensaje                   07  MSG-CIC-CMSG                     PIC X(05).      *      *    Codigo Externo           03  MSG-EXT-TABL.      *      *        Codigo Tipo Tabla               05  MSG-EXT-TTAB                         PIC X(03).      *      *        Codigo Tabla               05  MSG-EXT-CTAB                         PIC X(05).      *      *    Descripcion Corta           03  MSG-GLS-DCOR                             PIC X(12).      *      *    Abreviacion Descripcion           03  MSG-GLS-ABRV                             PIC X(05).      *      *    Descripcion del Codigo           03  MSG-GLS-DESC.               05  MSG-GLS-DES1                         PIC X(20).               05  MSG-GLS-DES2                         PIC X(20).      *      *    Datos Anexos           03  MSG-GLS-DATA.      *      *        Glosa Mensaje               05  MSG-GLS-MENS                         PIC X(40).      *      *        Disponible               05  MSG-GLS-DISP                         PIC X(20).      *      *    Clave Soundex           03  MSG-SNX-TABL.               05  MSG-SNX-TTAB                         PIC X(03).               05  MSG-SNX-MENS                         PIC X(03).      *      *    Variables de Mensajes       01  MSG-VARI.      *      *    Nombre de Programa FIO para Mensajes           03  MSG-GLS-FMSG.      *      *        Codigo Sistema               05  MSG-COD-SIST                         PIC X(03).      *      *        Nombre "fijo" de FIO Mensajes               05  MSG-COD-FMSG.                   07 FILLER                VALUE "P"   PIC X(01).                   07 MSG-COD-SMSG                      PIC X(01).                   07 FILLER                VALUE "TAB" PIC X(03).?SECTION GNSBRRPF, ANSI      *        RELACION PROGRAMA - FORMULARIO       01  RPF.      *      *    Filler Compatibilidad VSAM/MVS      *    03 RPF-GLS-FLAG                         PIC X(01).      *      *        DESCRIPCION PROGRAMA + TIPO REGISTRO (LLAVE)           03 RPF-COD-DPTR.      *      *        DESCRIPCION PROGRAMA              05 RPF-COD-DPRO                      PIC X(12).      *      *        TIPO REGISTRO Y CORRELATIVO      *          A   =   AUTOR      *          B   =   ARCHIVO BASE      *          C   =   COMANDOS      *          C0  =   COMANDO 0      *          C1  =   COMANDO 1      *          .      *          .      *          C9  =   COMANDO 9      *          P1  =   FORMULARIO 1      *          .      *          .      *          P9  =   FORMULARIO 9      *          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA      *           0  =   LLAVE      *           1  =   VARIABLE 1      *           .      *           .      *           9  =   VARIABLE 9      *              05 RPF-COD-TRYC.      *      *        TIPO REGISTRO                 07 RPF-COD-TREG                   PIC X(01).      *      *        CORRELATIVO                 07 RPF-COD-CORR                   PIC 9(01).      *      *        DESCRIPCION ARCHIVOS              05 RPF-COD-DARC                      PIC X(08).      *           03 RPF-KEY-DPTR REDEFINES RPF-COD-DPTR.      *      *        DESCRIPCION PROGRAMA              05 RPF-KEY-DPRO                      PIC X(12).      *      *        TIPO REGISTRO Y CORRELATIVO      *          A   =   AUTOR      *          B   =   ARCHIVO BASE      *          C   =   COMANDOS      *          C0  =   COMANDO 0      *          C1  =   COMANDO 1      *          .      *          .      *          C9  =   COMANDO 9      *          P1  =   FORMULARIO 1      *          .      *          .      *          P9  =   FORMULARIO 9      *          F   =   ARCHIVO ANEXO Y LUGAR EN DONDE SE LLENA      *           0  =   LLAVE      *           1  =   VARIABLE 1      *           .      *           .      *           9  =   VARIABLE 9      *              05 RPF-KEY-TRYC.      *      *        TIPO REGISTRO                 07 RPF-KEY-TREG                   PIC X(01).      *      *        CORRELATIVO                 07 RPF-KEY-CORR                   PIC 9(01).      *      *        DESCRIPCION ARCHIVOS              05 RPF-KEY-DARC                      PIC X(08).      *      *        DATO ANEXO           03 RPF-GLS-DATA                         PIC X(70).      *           03 RPF-GLS-DAT1 REDEFINES RPF-GLS-DATA.      *      *        DESCRIPCION AUTOR              05 RPF-GLS-DAUT                      PIC X(42).      *      *        CODIGO INDEPEDENCIA FISICA DE DATOS              05 RPF-COD-CIFD                      PIC X(12).      *      *        FILLER              05 RPF-GLS-DIS1                      PIC X(16).      *           03 RPF-GLS-DAT2 REDEFINES RPF-GLS-DATA.      *      *        ARCHIVO BASE              05 RPF-GLS-ABAS                      PIC X(08).      *      *        FILLER              05 RPF-GLS-DIS2                      PIC X(62).      *           03 RPF-GLS-DAT3 REDEFINES RPF-GLS-DATA.      *      *        FILLER              05 RPF-COD-DIS3                      PIC X(03).      *      *        GLOSA COMANDOS              05 RPF-GLS-DCMN                      PIC X(25).      *      *        GLOSA ABORTO              05 RPF-GLS-ABRT                      PIC X(25).      *      *        SUBRUTINA ALTERNATIVA COMANDOS              05 RPF-GLS-UARA                      PIC X(12).      *      *        FILLER              05 RPF-GLS-DIS3                      PIC X(05).      *           03 RPF-GLS-DAT4 REDEFINES RPF-GLS-DATA.      *      *        CODIGO COMANDO              05 RPF-COD-CCMN                      PIC X(03).      *      *        GLOSA PROMPT              05 RPF-GLS-PRMT                      PIC X(25).      *      *        GLOSA CONFIRMACION              05 RPF-GLS-CONF                      PIC X(25).      *      *        SUBRUTINA COMANDO              05 RPF-GLS-UARC                      PIC X(12).      *      *        CODIGO COMANDO PARA PROGRAMA              05 RPF-COD-CCPP                      PIC X(03).      *      *        ESTADO COMANDO PARA PROGRAMA              05 RPF-IND-STPP                      PIC X(01).      *      *        FILLER              05 RPF-GLS-DIS4                      PIC X(01).      *           03 RPF-GLS-DAT5 REDEFINES RPF-GLS-DATA.      *      *        DESCRIPCION BIBLIOTECA DE FORMULARIO              05 RPF-GLS-LFRM                      PIC X(06).      *      *        DESCRIPCION DE FORMULARIO              05 RPF-GLS-NFRM                      PIC X(06).      *      *        FILLER              05 RPF-GLS-DIS5                      PIC X(58).      *           03 RPF-GLS-DAT6 REDEFINES RPF-GLS-DATA.      *      *        LUGAR DEL CODIGO EN PROGRAMA              05 RPF-KEY-LCEP                      PIC X(02).      *      *        FORMULARIO DEL CODIGO EN PROGRAMA              05 RPF-KEY-FCEP                      PIC X(06).      *      *        VARIABLE DEL CODIGO EN PROGRAMA              05 RPF-KEY-VCEP                      PIC X(32).      *      *        FILLER              05 RPF-GLS-DIS6                      PIC X(30).      *           03 RPF-GLS-DAT7 REDEFINES RPF-GLS-DATA.      *      *        DESCRIPCION LLAVE              05 RPF-GLS-DKEY                      PIC X(10).      *      *        FILLER              05 RPF-GLS-DIS7                      PIC X(60).      *           03 RPF-GLS-DAT8 REDEFINES RPF-GLS-DATA.      *      *        DESCRIPCION VARIABLE PARA FORMAR LLAVE              05 RPF-GLS-DVAR                      PIC X(32).      *      *        FILLER              05 RPF-GLS-DIS8                      PIC X(38).      *      *    Variables de RPF       01  RPF-VARI.      *      *    Nombre de Programa FIO para RPF           03  RPF-GLS-FRPF.      *      *        Codigo Sistema               05  RPF-COD-SIST                         PIC X(03).      *      *        Nombre "fijo" de FIO Rpf               05  RPF-COD-FRPF.                   07 FILLER                VALUE "P"   PIC X(01).                   07 RPF-COD-SRPF                      PIC X(01).                   07 FILLER                VALUE "RPF" PIC X(03).?SECTION GNSBRTAB, ANSI      *    Registro Generico de Tablas      *    ---------------------------      *       *    Nombre Registro : TAB        *    Clave(s)        : TAB-COD-TABL(UU), TAB-STP-ITRN(UU),      *                      TAB-CIC-TABL(UU), TAB-EXT-TABL(DC)      *    Largo           : 194      *    Bloqueo         : 2      *    Observaciones   :       *       01  TAB.       *      *    Filler Compatibilidad VSAM/MVS           03  TAB-GLS-FLAG                             PIC X(01).            *      *    Clave Primaria Registro           03  TAB-KEY-IREG.      *      *KEY     Tipo + Codigo ( LLave Primaria )               05  TAB-COD-TABL.      *      *            Codigo Tipo Tabla                   07  TAB-COD-TTAB                     PIC X(03).      *      *            Codigo Tabla                   07  TAB-COD-CTAB                     PIC X(12).      *      *        Time Stamp Transaccion               05  TAB-STP-ITRN.      *      *            Fecha Transaccion                   07  TAB-FEC-FTRN.                       09  TAB-NUM-STRN                 PIC 9(02).                       09  TAB-NUM-ATRN                 PIC 9(02).                       09  TAB-NUM-MTRN                 PIC 9(02).                       09  TAB-NUM-DTRN                 PIC 9(02).      *      *            Hora Transaccion                   07  TAB-HRA-HRTR.                       09  TAB-NUM-HHTR                 PIC 9(02).                       09  TAB-NUM-MMTR                 PIC 9(02).                       09  TAB-NUM-SSTR                 PIC 9(02).      *      *    Indicador Tipo Accion           03  TAB-MSC-TACC                             PIC X(01).      *      *    Indicador Status           03  TAB-MSC-STAT                             PIC X(01).      *      *    Indicador Vigencia                           GNS VIGE           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).      *      *    Codigo Origen Transaccion           03  TAB-COD-OTRN.      *      *        Indicador Tipo Origen               05  TAB-MSC-TTRN                         PIC X(01).      *      *        Codigo Tipo Origen               05  TAB-COD-TTRN                         PIC X(03).      *      *    Autor Transaccion           03  TAB-COD-ATRN                             PIC X(12).                  *      *KEY Tipo + Codigo ( Interno Computacional )           03  TAB-CIC-TABL.      *      *        Codigo Tipo Tabla               05  TAB-CIC-TTAB                         PIC X(03).      *      *        Codigo Tabla               05  TAB-CIC-CTAB                         PIC X(12).      *      *    Codigo Externo           03  TAB-EXT-TABL.      *      *        Codigo Tipo Tabla               05  TAB-EXT-TTAB                         PIC X(03).      *      *        Codigo Tabla               05  TAB-EXT-CTAB                         PIC X(05).      *      *    Descripcion Corta           03  TAB-GLS-DCOR                             PIC X(12).      *      *    Abreviacion Descripcion           03  TAB-GLS-ABRV                             PIC X(05).      *      *    Descripcion del Codigo           03  TAB-GLS-DESC                             PIC X(40).      *      *    Datos Anexos           03  TAB-GLS-DATA.               05  TAB-GLS-DAT1.                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).               05  TAB-GLS-DAT2.                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).               05  TAB-GLS-DAT3.                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).      *      *    Clave Soundex           03  TAB-SNX-TABL.               05  TAB-SNX-TTAB                         PIC X(03).               05  TAB-SNX-CTAB                         PIC X(03).      *      *    Variables de Tablas       01  TAB-VARI.      *      *    Nombre de Programa FIO para TABlas           03  TAB-GLS-FTAB.      *      *        Codigo Sistema               05  TAB-COD-SIST                         PIC X(03).      *      *        Nombre "fijo" de FIO Tab               05  TAB-COD-FTAB.                   07 FILLER                VALUE "P"   PIC X(01).                   07 TAB-COD-STAB                      PIC X(01).                   07 FILLER                VALUE "TAB" PIC X(03).?SECTION GNSLGUYP, ANSI      *    GNSLGUYP       01  UYP-VARI.           03 UYP-COD-TDPU                       PIC X(02).           03 UYP-COD-USER                       PIC X(12).           03 UYP-COD-PREG.              05 UYP-COD-SIST                    PIC X(03).              05 UYP-COD-NEMO                    PIC X(12).              05 UYP-COD-CMND                    PIC X(03).              05 UYP-COD-PROC                    PIC X(12).           03 UYP-COD-STAT                       PIC X(01).           03 UYP-IND-RESP                       PIC X(01).           03 FILLER                             PIC X(01).?SECTION GNSWCSCR, ANSI       01  SCR-CTTS.           03 SCR-INST-INI                PIC X(03) VALUE "INI".           03 SCR-INST-HCM                PIC X(03) VALUE "HCM".           03 SCR-INST-GCM                PIC X(03) VALUE "GCM".           03 SCR-INST-HKY                PIC X(03) VALUE "HKY".           03 SCR-INST-GKY                PIC X(03) VALUE "GKY".           03 SCR-INST-HFL                PIC X(03) VALUE "HFL".           03 SCR-INST-GFL                PIC X(03) VALUE "GFL".           03 SCR-INST-GCS                PIC X(03) VALUE "GCS".           03 SCR-INST-GAB                PIC X(03) VALUE "GAB".           03 SCR-INST-GCF                PIC X(03) VALUE "GCF".           03 SCR-INST-SIS                PIC X(03) VALUE "SIS".           03 SCR-INST-BRW                PIC X(03) VALUE "BRW".           03 SCR-STAT-CON                PIC X(01) VALUE "C".           03 SCR-STAT-ABT                PIC X(01) VALUE "K".           03 SCR-STAT-MOD                PIC X(01) VALUE "M".           03 SCR-STAT-SON                PIC X(01) VALUE "A".           03 SCR-ACTU-MOD                PIC X(03) VALUE "MOD".           03 SCR-ACTU-ING                PIC X(03) VALUE "ING".           03 SCR-VFLD-NOT                PIC X(01) VALUE "N".           03 SCR-VFLD-YES                PIC X(01) VALUE "S".           03 SCR-MFLD-NOT                PIC X(01) VALUE "N".           03 SCR-MFLD-YES                PIC X(01) VALUE "S".?SECTION GNSWGHOY, ANSI      * Variables para Current-Date       01  HOY-VARI.           03 HOY-STP-ITRN.              05 HOY-FHOY.                 07 HOY-SHOY                      PIC 9(02).                 07 HOY-AHOY                      PIC 9(02).                 07 HOY-MHOY                      PIC 9(02).                 07 HOY-DHOY                      PIC 9(02).              05 HOY-HHOY                         PIC 9(06).              05 HOY-HHOY-RED REDEFINES HOY-HHOY.                 07 HOY-HHHY                      PIC 9(02).                 07 HOY-MMHY                      PIC 9(02).                 07 HOY-SSHY                      PIC 9(02).?SECTION GNSWGSYS, ANSI      *    Variables para Rutinas del Sistema. GNSWGSYS      *    Mensaje       01  SYS-MENS.           03 SYS-MEN1                         PIC X(40).           03 SYS-MEN2                         PIC X(40).      *    Communication Area       01  SYS-CMMA.           03 SYS-SCR-MENS                     PIC X(79).           03 SYS-SCR-VARI                     PIC X(3421).      *****************************************************       01  SYS-VARI.      *    Variables para DATE           03 SYS-FHOY-DATE  VALUE ZEROES      PIC 9(06).           03 SYS-FHOY-DATE-RED REDEFINES SYS-FHOY-DATE.              05 SYS-AHOY-DATE                 PIC 9(02).              05 SYS-MHOY-DATE                 PIC 9(02).              05 SYS-DHOY-DATE                 PIC 9(02).      *    Variables para TIME           03 SYS-HHOY-TIME  VALUE ZEROES      PIC 9(08).           03 SYS-HHOY-TIME-RED REDEFINES SYS-HHOY-TIME.              05 SYS-HHHY-TIME                 PIC 9(02).              05 SYS-MMHY-TIME                 PIC 9(02).              05 SYS-SSHY-TIME                 PIC 9(02).              05 SYS-CCHY-TIME                 PIC 9(02).      *    Variables Genericas para manejo de FECHA y HORA           03 SYS-SHOY         VALUE 19        PIC 9(02).           03 SYS-FHOY.              05 SYS-DHOY                      PIC 9(02).              05 SYS-SLH1                      PIC X(01).              05 SYS-MHOY                      PIC 9(02).              05 SYS-SLH2                      PIC X(01).              05 SYS-AHOY                      PIC 9(02).           03 SYS-HHOY.              05 SYS-HHHY                      PIC 9(02).              05 SYS-MMHY                      PIC 9(02).              05 SYS-SSHY                      PIC 9(02).              05 SYS-CCHY                      PIC 9(02).      *    Tamano de Communication Area           03 SYS-TCMA                         PIC S9(04).      *    Transaccion           03 SYS-NTRN                         PIC X(04).      *    Programa           03 SYS-PROG                         PIC X(08).           03 SYS-PROG-RED REDEFINES SYS-PROG                                      OCCURS 8 PIC X(01).      *    Comando           03 SYS-CMND                 VALUE 0 PIC 9(02).      *    Indicador de Back-out           03 SYS-BKOU               VALUE "N" PIC X(01).      *    Status           03 SYS-STAT                         PIC X(02).           03 SYS-STAT-OKS        VALUE "00"   PIC X(02).      *      *    Constantes para Rutinas del Sistema.       01  SYS-CTTS.      *    Comandos           03 SYS-GET-DATE             VALUE 1 PIC 9(01).           03 SYS-GET-TIME             VALUE 2 PIC 9(01).           03 SYS-RTRN                 VALUE 3 PIC 9(01).           03 SYS-XCTL                 VALUE 4 PIC 9(01).           03 SYS-LINK                 VALUE 5 PIC 9(01).           03 SYS-ABOR                 VALUE 6 PIC 9(01).?SECTION GNSWGTSC, ANSI      *Variables de procesador de menu y comandos      *10-JUL-1990 14:50       01  TSC-VARI.           03 TSC-ITEM.              05  TSC-ICMN                        PIC X(01).              05  TSC-TFUN                        PIC X(03).                  88 TSC-TFUN-OLD VALUE "PGI" "HMC" "HMX"                                        "XMC" "XMX" "RET".                  88 TSC-TFUN-NPC VALUE "NPC".              05  TSC-INST                        PIC X(03).              05  TSC-PROG                        PIC X(08).              05  TSC-NTRN                        PIC X(04).              05  TSC-SIST                        PIC X(03).              05  TSC-SISG                        PIC X(03).              05  TSC-FRET                        PIC X(12).              05  TSC-FFLD        COMP            PIC 9(05).              05  TSC-NEMO                        PIC X(12).              05  TSC-CMNP                        PIC X(12).              05  TSC-CMND                        PIC X(03).              05  TSC-OPCI                        PIC X(03).              05  TSC-NLIB                        PIC X(07).              05  TSC-NMAP                        PIC X(07).              05  TSC-LDOC                        PIC X(12).              05  TSC-NDOC                        PIC X(25).              05  TSC-IPRV                        PIC X(01).              05  TSC-TINS                        PIC X(03).              05  TSC-TCTL                        PIC X(04).              05  TSC-TINF.                  07  TSC-TINV                    PIC X(01).                  07  TSC-TIND                    PIC X(01).                  07  FILLER                      PIC X(01).              05  TSC-ASCR                        PIC X(01).              05  TSC-AMPG                        PIC X(01).              05  TSC-NMHD                        PIC X(07).              05  TSC-LMHD                        PIC X(07).              05  TSC-AMHD                        PIC X(01).              05  TSC-NMCM                        PIC X(07).              05  TSC-LMCM                        PIC X(07).              05  TSC-AMCM                        PIC X(01).              05  TSC-MSAL                        PIC X(03).              05  TSC-TCMA               COMP PIC S9(04).              05  TSC-PROV                        PIC X(12).              05  TSC-NTRV                        PIC X(04).              05  TSC-CIDD                        PIC X(12).              05  TSC-I                           PIC 9(02).              05  TSC-PRMC                        PIC X(25).              05  TSC-USER                        PIC X(12).              05  TSC-OTRN                        PIC X(04).              05  TSC-CRPF.                  07  TSC-TABL OCCURS 10.                      09  TSC-CCMN                PIC X(03).                      09  TSC-CCPP                PIC X(03).                      09  TSC-STPP                PIC X(01).                      09  TSC-PRMT                PIC X(25).                      09  TSC-CONF                PIC X(25).                      09  TSC-UARC.                          11  TSC-NUAR            PIC X(08).                          11  TSC-TUAR            PIC X(04).              05  TSC-RFBY                        PIC X(01).              05  TSC-PASW                        PIC X(01).              05  TSC-OACC                        PIC X(11).              05  TSC-DISP                        PIC X(09).       01  TSC-VARI-BKP                           PIC X(950).?SECTION GNSBIABT, ANSI      * Modulo de Aborto Programa Interactivo       GNS-PRG-ABT SECTION.       INI-GNS-PRG-ABT.           IF FRM-MENS > SPACES AND FIO-MENS NOT > SPACES               MOVE FRM-MENS TO FIO-MENS.           MOVE FIO-MENS TO SYS-MENS.           MOVE SYS-ABOR TO SYS-CMND.           PERFORM GNS-PRO-SYS.       FIN-GNS-PRG-ABT.           EXIT.?SECTION GNSWIMNU, ANSI      * 13-Apr-95 09:23 PM      * DEFINICION_DE_MENU       01  MNU-FLD.           05 FILLER-MNU                    PIC  X(12).      *Funcion Nemotecnica           05 MNU-COD-NEMO-LEN VALUE 0   PIC S9(02).           05 MNU-COD-NEMO-ATR              PIC X(01).           05 MNU-COD-NEMO                  PIC XXXXXXXXXXXX.      *           05 MNU-COD-OPCI-LEN VALUE 0   PIC S9(02).           05 MNU-COD-OPCI-ATR              PIC X(01).           05 MNU-COD-OPCI                  PIC X(3).      *           05 MNU-COD-IMEN-LEN VALUE 0   PIC S9(02).           05 MNU-COD-IMEN-ATR              PIC X(01).           05 MNU-COD-IMEN                  PIC XXXXXX.      *Sistema           05 MNU-COD-SIST-LEN VALUE 0   PIC S9(02).           05 MNU-COD-SIST-ATR              PIC X(01).           05 MNU-COD-SIST                  PIC X(3).      *Funcion de Retorno           05 MNU-COD-FRET-LEN VALUE 0   PIC S9(02).           05 MNU-COD-FRET-ATR              PIC X(01).           05 MNU-COD-FRET                  PIC XXXXXXXXXXXX.      *Glosa de Menu           05 MNU-GLS-FMEN-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-FMEN-ATR              PIC X(01).           05 MNU-GLS-FMEN                  PIC X(30).      *Funcion Anterior           05 MNU-COD-FANT-LEN VALUE 0   PIC S9(02).           05 MNU-COD-FANT-ATR              PIC X(01).           05 MNU-COD-FANT                  PIC XXXXXXXXXXXX.      *Glosa de Programa           05 MNU-GLS-FPRO-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-FPRO-ATR              PIC X(01).           05 MNU-GLS-FPRO                  PIC X(30).      *Nombre Mapa Header           05 MNU-GLS-NMHD-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-NMHD-ATR              PIC X(01).           05 MNU-GLS-NMHD                  PIC X(7).      *Libreria Mapa Header           05 MNU-GLS-LMHD-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-LMHD-ATR              PIC X(01).           05 MNU-GLS-LMHD                  PIC X(7).      *Accion Mapa Header           05 MNU-COD-AMHD-LEN VALUE 0   PIC S9(02).           05 MNU-COD-AMHD-ATR              PIC X(01).           05 MNU-COD-AMHD                  PIC X.      *           05 MNU-IND-EXGL-LEN VALUE 0   PIC S9(02).           05 MNU-IND-EXGL-ATR              PIC X(01).           05 MNU-IND-EXGL                  PIC X.      *Mapa           05 MNU-GLS-NFRM-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-NFRM-ATR              PIC X(01).           05 MNU-GLS-NFRM                  PIC X(7).      *Mapset           05 MNU-GLS-LFRM-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-LFRM-ATR              PIC X(01).           05 MNU-GLS-LFRM                  PIC X(7).      *Accion Mapa Programa           05 MNU-COD-AMPG-LEN VALUE 0   PIC S9(02).           05 MNU-COD-AMPG-ATR              PIC X(01).           05 MNU-COD-AMPG                  PIC X.      *Nombre de Mapa de Comandos           05 MNU-GLS-NMCM-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-NMCM-ATR              PIC X(01).           05 MNU-GLS-NMCM                  PIC X(7).      *Mapset del Mapa de Comandos           05 MNU-GLS-LMCM-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-LMCM-ATR              PIC X(01).           05 MNU-GLS-LMCM                  PIC X(7).      *Accion asociada a Mapa de Comandos           05 MNU-COD-AMCM-LEN VALUE 0   PIC S9(02).           05 MNU-COD-AMCM-ATR              PIC X(01).           05 MNU-COD-AMCM                  PIC X.      *Tipo de Funcion           05 MNU-COD-TFUN-LEN VALUE 0   PIC S9(02).           05 MNU-COD-TFUN-ATR              PIC X(01).           05 MNU-COD-TFUN                  PIC X(3).      *Codigo de Menu           05 MNU-COD-MENU-LEN VALUE 0   PIC S9(02).           05 MNU-COD-MENU-ATR              PIC X(01).           05 MNU-COD-MENU                  PIC X(3).      *           05 MNU-COD-CIFD-LEN VALUE 0   PIC S9(02).           05 MNU-COD-CIFD-ATR              PIC X(01).           05 MNU-COD-CIFD                  PIC X(12).      *Programa           05 MNU-GLS-PROG-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-PROG-ATR              PIC X(01).           05 MNU-GLS-PROG                  PIC X(8).      *Transaccion           05 MNU-GLS-TRAN-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-TRAN-ATR              PIC X(01).           05 MNU-GLS-TRAN                  PIC X(4).      *           05 MNU-COD-CMND-LEN VALUE 0   PIC S9(02).           05 MNU-COD-CMND-ATR              PIC X(01).           05 MNU-COD-CMND                  PIC X(3).      *Instancia           05 MNU-COD-INST-LEN VALUE 0   PIC S9(02).           05 MNU-COD-INST-ATR              PIC X(01).           05 MNU-COD-INST                  PIC X(3).      *Informacion de Control           05 MNU-COD-TINF-LEN VALUE 0   PIC S9(02).           05 MNU-COD-TINF-ATR              PIC X(01).           05 MNU-COD-TINF                  PIC X(3).      *Comando para Traspaso de control           05 MNU-COD-TCTL-LEN VALUE 0   PIC S9(02).           05 MNU-COD-TCTL-ATR              PIC X(01).           05 MNU-COD-TCTL                  PIC X(4).      *Accion en Pantalla           05 MNU-COD-ASCR-LEN VALUE 0   PIC S9(02).           05 MNU-COD-ASCR-ATR              PIC X(01).           05 MNU-COD-ASCR                  PIC X.      *Modalidad de Salida           05 MNU-COD-MSAL-LEN VALUE 0   PIC S9(02).           05 MNU-COD-MSAL-ATR              PIC X(01).           05 MNU-COD-MSAL                  PIC X(3).      *Indicador de Privilegios           05 MNU-IND-IPRV-LEN VALUE 0   PIC S9(02).           05 MNU-IND-IPRV-ATR              PIC X(01).           05 MNU-IND-IPRV                  PIC X.      *           05 MNU-IND-SEQU-LEN VALUE 0   PIC S9(02).           05 MNU-IND-SEQU-ATR              PIC X(01).           05 MNU-IND-SEQU                  PIC X(3).      *           05 MNU-GLS-LDOC-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-LDOC-ATR              PIC X(01).           05 MNU-GLS-LDOC                  PIC X(7).      *           05 MNU-GLS-NDOC-LEN VALUE 0   PIC S9(02).           05 MNU-GLS-NDOC-ATR              PIC X(01).           05 MNU-GLS-NDOC                  PIC X(27).      *           05 MNU-IND-CONF-LEN VALUE 0   PIC S9(02).           05 MNU-IND-CONF-ATR              PIC X(01).           05 MNU-IND-CONF                  PIC X.      *           05 MNU-NUM-FILA-LEN VALUE 0   PIC S9(02).           05 MNU-NUM-FILA-ATR              PIC X(01).           05 MNU-NUM-FILA-ALF              PIC X(2).           05 MNU-NUM-FILA      REDEFINES              MNU-NUM-FILA-ALF              PIC 99.      *           05 MNU-NUM-COLU-LEN VALUE 0   PIC S9(02).           05 MNU-NUM-COLU-ATR              PIC X(01).           05 MNU-NUM-COLU-ALF              PIC X(2).           05 MNU-NUM-COLU      REDEFINES              MNU-NUM-COLU-ALF              PIC 99.           05 MNU-GLS-MENS-LEN      VALUE 0 PIC S9(02).           05 MNU-GLS-MENS-ATR              PIC  X(01).           05 MNU-GLS-MENS.              07 MNU-GLS-MEN1               PIC  X(40).              07 MNU-GLS-MEN2               PIC  X(39).      *      * REGISTRO EDICION DE CAMPOS PARA MAPA MNU       01  MNU-EDT.           05 MNU-NUM-FILA-EDT PIC ZZ.           05 MNU-NUM-COLU-EDT PIC ZZ.?SECTION GNSWGTSF, ANSI      *Tabla para almacenar mensajes asociados a las FIO       01  FIO-TBL-MENS.           03 FIO-SIND                  PIC 9(02).           03 FIO-TBL-MENS.              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Created Duplicate Key".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Length Record not conform to       -                                   "the file attributes".              05 FILLER PIC   X(80) VALUE "Referenced optional file is n      -                                   "ot presented".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Requested option could not be      -                                   " done".              05 FILLER PIC  X(160) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "End Of File".              05 FILLER PIC  X(240) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Sequential Read Loss".              05 FILLER PIC  X(480) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "No Ascending Key".              05 FILLER PIC   X(80) VALUE "Duplicate Key".              05 FILLER PIC   X(80) VALUE "Record Not Found".              05 FILLER PIC   X(80) VALUE "Boundary Violation Error".              05 FILLER PIC  X(400) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Other Permanent Errors".              05 FILLER PIC  X(320) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Other Permanent Errors".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Other Permanent Errors".              05 FILLER PIC   X(80) VALUE "Other Permanent Errors".              05 FILLER PIC   X(80) VALUE "Conflict file attributes and       -                                   "attributes especified".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Open for file already Open".              05 FILLER PIC   X(80) VALUE "File Not Open".              05 FILLER PIC   X(80) VALUE "Record Not Read".              05 FILLER PIC   X(80) VALUE "Boundary Violation Error".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Sequential Read without Prere      -                                   "quisite".              05 FILLER PIC   X(80) VALUE "Read/start on file not open".              05 FILLER PIC   X(80) VALUE "Write on File Not Open".              05 FILLER PIC   X(80) VALUE "Delete/rewrite on file Not Op      -                                   "en".              05 FILLER PIC X(3200) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "LoGic Error".              05 FILLER PIC   X(80) VALUE "I-O Error".              05 FILLER PIC  X(400) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "File Integrity Verified".              05 FILLER PIC   X(80) VALUE SPACES.              05 FILLER PIC   X(80) VALUE "Fatal".           03 FIO-TBL-MENS-RED REDEFINES FIO-TBL-MENS.              05 FIO-GLS-MENS OCCURS 99 PIC X(80).?SECTION GNSWITAB, ANSI      * 02-Jul-93 11:03 AM      * TABLAS       01  TAB-FLD.           05 FILLER-TAB       VALUE SPACES PIC  X(12).      *Codigo Tabla           05 TAB-COD-TTAB-LEN VALUE 0      PIC S9(02).           05 TAB-COD-TTAB-ATR VALUE SPACES PIC  X(01).           05 TAB-COD-TTAB     VALUE SPACES PIC  X(3).      *Codigo           05 TAB-COD-CTAB-LEN VALUE 0      PIC S9(02).           05 TAB-COD-CTAB-ATR VALUE SPACES PIC  X(01).           05 TAB-COD-CTAB     VALUE SPACES PIC  X(12).      *Codigo Interno     utacional           05 TAB-CIC-CTAB-LEN VALUE 0      PIC S9(02).           05 TAB-CIC-CTAB-ATR VALUE SPACES PIC  X(01).           05 TAB-CIC-CTAB     VALUE SPACES PIC  X(12).      *Codigo Externo           05 TAB-EXT-CTAB-LEN VALUE 0      PIC S9(02).           05 TAB-EXT-CTAB-ATR VALUE SPACES PIC  X(01).           05 TAB-EXT-CTAB     VALUE SPACES PIC  X(5).      *Descripcion del Codigo           05 TAB-GLS-DESC-LEN VALUE 0      PIC S9(02).           05 TAB-GLS-DESC-ATR VALUE SPACES PIC  X(01).           05 TAB-GLS-DESC     VALUE SPACES PIC  X(40).      *Abreviacion de la Descripcion           05 TAB-GLS-ABRV-LEN VALUE 0      PIC S9(02).           05 TAB-GLS-ABRV-ATR VALUE SPACES PIC  X(01).           05 TAB-GLS-ABRV     VALUE SPACES PIC  X(5).      *Descripcion Corta           05 TAB-GLS-DCOR-LEN VALUE 0      PIC S9(02).           05 TAB-GLS-DCOR-ATR VALUE SPACES PIC  X(01).           05 TAB-GLS-DCOR     VALUE SPACES PIC  X(12).      *Vigencia del Codigo           05 TAB-IND-VIGE-LEN VALUE 0      PIC S9(02).           05 TAB-IND-VIGE-ATR VALUE SPACES PIC  X(01).           05 TAB-IND-VIGE     VALUE SPACES PIC  X.      *           05 TAB-FEC-FTRN-LEN VALUE 0      PIC S9(02).           05 TAB-FEC-FTRN-ATR VALUE SPACES PIC  X(01).      *    FECHA FEC CST           05 TAB-FEC-FTRN.              07 TAB-NUM-DTRN VALUE 0        PIC 9(02).              07 TAB-NUM-MTRN VALUE 0        PIC 9(02).              07 TAB-NUM-STRN VALUE 0        PIC 9(02).              07 TAB-NUM-ATRN VALUE 0        PIC 9(02).      *Datos Anexos           05 TAB-GLS-DATA-LEN VALUE 0      PIC S9(02).           05 TAB-GLS-DATA-ATR VALUE SPACES PIC  X(01).           05 TAB-GLS-DATA     VALUE SPACES PIC  X(60).      * Linea de Mensajes           05 TAB-GLS-MENS-LEN VALUE 0      PIC S9(02).           05 TAB-GLS-MENS-ATR VALUE SPACES PIC  X(01).           05 TAB-GLS-MENS.              07 TAB-GLS-MEN1  VALUE SPACES PIC  X(40).              07 TAB-GLS-MEN2  VALUE SPACES PIC  X(39).?SECTION GNSWIRPF, ANSI      * 01-Jul-93 07:44 PM      * DEFINICION_PROGRAMA_INTERACTIVO       01  RPF-FLD.           05 FILLER-RPF       VALUE SPACES PIC  X(12).      *Descripcion ( nombre ) del Programa           05 RPF-COD-DPRO-LEN VALUE 0      PIC S9(02).           05 RPF-COD-DPRO-ATR VALUE SPACES PIC  X(01).           05 RPF-COD-DPRO     VALUE SPACES PIC  X(12).      *Descripcion ( nombre ) del Autor           05 FRM-GLS-DAUT-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-DAUT-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-DAUT     VALUE SPACES PIC  X(42).      *Codigo Independencia Fisica de Datos           05 FRM-COD-CIFD-LEN VALUE 0      PIC S9(02).           05 FRM-COD-CIFD-ATR VALUE SPACES PIC  X(01).           05 FRM-COD-CIFD     VALUE SPACES PIC  X(12).      *Archivo Base           05 FRM-GLS-ABAS-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-ABAS-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-ABAS     VALUE SPACES PIC  X(8).      *Nombre de Formulario           05 FRM-GLS-NFRM-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-NFRM-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-NFRM     VALUE SPACES PIC  X(12).      *Libreria de Formulario           05 FRM-GLS-LFRM-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-LFRM-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-LFRM     VALUE SPACES PIC  X(12).      *Programa de Comandos Alternativo           05 FRM-GLS-UARA-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-UARA-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-UARA     VALUE SPACES PIC  X(12).      *Prompt para Comandos           05 FRM-GLS-DCMN-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-DCMN-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-DCMN     VALUE SPACES PIC  X(25).      *Prompt de aborto           05 FRM-GLS-ABRT-LEN VALUE 0      PIC S9(02).           05 FRM-GLS-ABRT-ATR VALUE SPACES PIC  X(01).           05 FRM-GLS-ABRT     VALUE SPACES PIC  X(25).      *Comando Externo           05 FRM-COD-CCMN-IDX  OCCURS 10 TIMES.              07 FRM-COD-CCMN-LEN              PIC S9(02).              07 FRM-COD-CCMN-ATR              PIC  X(01).              07 FRM-COD-CCMN                  PIC  X(3).      *Comando Interno para Programa              07 FRM-COD-CCPP-LEN              PIC S9(02).              07 FRM-COD-CCPP-ATR              PIC  X(01).              07 FRM-COD-CCPP                  PIC  X(3).      *Status para Programa              07 FRM-IND-STPP-LEN              PIC S9(02).              07 FRM-IND-STPP-ATR              PIC  X(01).              07 FRM-IND-STPP                  PIC  X.      *Prompt Asociado a Comando              07 FRM-GLS-PRMT-LEN              PIC S9(02).              07 FRM-GLS-PRMT-ATR              PIC  X(01).              07 FRM-GLS-PRMT                  PIC  X(23).      *Prompt de Confirmacion              07 FRM-GLS-CONF-LEN              PIC S9(02).              07 FRM-GLS-CONF-ATR              PIC  X(01).              07 FRM-GLS-CONF                  PIC  X(22).      *Subrutina asociada a Comando              07 FRM-GLS-UARC-LEN              PIC S9(02).              07 FRM-GLS-UARC-ATR              PIC  X(01).              07 FRM-GLS-UARC                  PIC  X(12).      * Linea de Mensajes           05 RPF-GLS-MENS-LEN VALUE 0      PIC S9(02).           05 RPF-GLS-MENS-ATR VALUE SPACES PIC  X(01).           05 RPF-GLS-MENS.              07 RPF-GLS-MEN1  VALUE SPACES PIC  X(40).              07 RPF-GLS-MEN2  VALUE SPACES PIC  X(39).?SECTION GNSBFMNU, ANSI      * Modulo FIO Batch para archivo VSAM GNSMNU, 29-MAR-1995 16:57:20.81       GNS-FIO-MNU SECTION.       INI-GNS-FIO-MNU.           IF FIO-CMND = FIO-BCK-OUT               MOVE "S" TO SYS-BKOU               GO TO FIN-GNS-FIO-MNU.           IF FIO-SIST = "GNS"               CALL "GNSPFMNU" USING FIO-VARI MNU           ELSE           IF FIO-SIST = "TAB"               CALL "TABPFMNU" USING FIO-VARI MNU           ELSE           IF FIO-SIST = "SGC"               CALL "SGCPFMNU" USING FIO-VARI MNU           ELSE           IF FIO-SIST = "COL"               CALL "COLPFMNU" USING FIO-VARI MNU           ELSE               MOVE "?GNS-FIO-MNU:"            TO FIO-MENS-DSC               MOVE "NO instalado el Sistema:" TO FIO-MENS-KEY               MOVE FIO-SIST                   TO FIO-MENS-GCM               PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-MNU.           EXIT.?SECTION GNSBFMSG, ANSI      * Modulo FIO Batch para archivo VSAM GNSMSG, 29-MAR-1995 16:58:08.74       GNS-FIO-MSG SECTION.       INI-GNS-FIO-MSG.           IF FIO-CMND = FIO-BCK-OUT               MOVE "S" TO SYS-BKOU               GO TO FIN-GNS-FIO-MSG.      *           MOVE FIO-SIST TO MSG-COD-SIST.           MOVE "MSG"    TO MSG-COD-TTAB IN MSG                            MSG-CIC-TTAB IN MSG                            MSG-EXT-TTAB IN MSG                            MSG-SNX-TTAB IN MSG.           IF FIO-CMND = FIO-PUT OR FIO-MOD               MOVE MSG-COD-TTAB IN MSG TO MSG-CIC-TTAB IN MSG                                           MSG-EXT-TTAB IN MSG                                           MSG-SNX-TTAB IN MSG.      *           IF FIO-SIST = "GNS"               CALL "GNSPFTAB" USING FIO-VARI MSG           ELSE           IF FIO-SIST = "TAB"               CALL "TABPFTAB" USING FIO-VARI MSG           ELSE           IF FIO-SIST = "SGC"               CALL "SGCPFTAB" USING FIO-VARI MSG           ELSE           IF FIO-SIST = "COL"               CALL "COLPFTAB" USING FIO-VARI MSG           ELSE               MOVE "?GNS-FIO-MSG:"            TO FIO-MENS-DSC               MOVE "NO instalado el Sistema:" TO FIO-MENS-KEY               MOVE FIO-SIST                   TO FIO-MENS-GCM               PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-MSG.           EXIT.?SECTION GNSBFRPF, ANSI      * Modulo FIO Batch para archivo VSAM GNSRPF, 29-MAR-1995 16:58:34.38       GNS-FIO-RPF SECTION.       INI-GNS-FIO-RPF.           IF FIO-CMND = FIO-BCK-OUT               MOVE "S" TO SYS-BKOU               GO TO FIN-GNS-FIO-RPF.           IF FIO-SIST = "GNS"               CALL "GNSPFRPF" USING FIO-VARI RPF           ELSE           IF FIO-SIST = "TAB"               CALL "TABPFRPF" USING FIO-VARI RPF           ELSE           IF FIO-SIST = "SGC"               CALL "SGCPFRPF" USING FIO-VARI RPF           ELSE           IF FIO-SIST = "COL"               CALL "COLPFRPF" USING FIO-VARI RPF           ELSE               MOVE "?GNS-FIO-RPF:"            TO FIO-MENS-DSC               MOVE "NO instalado el Sistema:" TO FIO-MENS-KEY               MOVE FIO-SIST                   TO FIO-MENS-GCM               PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-RPF.           EXIT.?SECTION GNSBFTAB, ANSI      * Modulo FIO Batch para archivo VSAM GNSTAB, 29-MAR-1995 16:58:08.74       GNS-FIO-TAB SECTION.       INI-GNS-FIO-TAB.           IF FIO-CMND = FIO-BCK-OUT               MOVE "S" TO SYS-BKOU               GO TO FIN-GNS-FIO-TAB.      *           MOVE FIO-SIST TO TAB-COD-SIST.           IF FIO-CMND = FIO-PUT OR FIO-MOD               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB                                           TAB-EXT-TTAB IN TAB                                           TAB-SNX-TTAB IN TAB.      *           IF FIO-SIST = "GNS"               CALL "GNSPFTAB" USING FIO-VARI TAB           ELSE           IF FIO-SIST = "TAB"               CALL "TABPFTAB" USING FIO-VARI TAB           ELSE           IF FIO-SIST = "SGC"               CALL "SGCPFTAB" USING FIO-VARI TAB           ELSE           IF FIO-SIST = "COL"               CALL "COLPFTAB" USING FIO-VARI TAB           ELSE               MOVE "?GNS-FIO-TAB:"            TO FIO-MENS-DSC               MOVE "NO instalado el Sistema:" TO FIO-MENS-KEY               MOVE FIO-SIST                   TO FIO-MENS-GCM               PERFORM GNS-PRG-ABT.       FIN-GNS-FIO-TAB.           EXIT.?SECTION GNSCGSPN, ANSI               KF1           IS F1,               KF2           IS F2,               KF3           IS F3,               KF4           IS F4,               KF5           IS F5,               KF6           IS F6,               KF7           IS F7,               KF8           IS F8,               KF9           IS F9,               KF10          IS F10,               KF11          IS F11,               KF12          IS F12,               BLINK         IS BLINK,               NOBLINK       IS NOBLINK,               NORMAL        IS NORMAL,               MDTON         IS MDTON,               MDTOFF        IS MDTOFF,               HIDDEN        IS HIDDEN,               NOTHIDDEN     IS NOTHIDDEN,               REVERSE       IS REVERSE,               NOREVERSE     IS NOREVERSE,               UNDERLINE     IS UNDERLINE,               NOUNDERLINE   IS NOUNDERLINE,               PROTECTED     IS PROTECTED,               UNPROTECTED   IS UNPROTECTED,               DECIMAL-POINT IS COMMA.?SECTION GNSBEGLS, ANSI      * Error de Glosa en programa interactivo       ERR-GLS SECTION.       INI-ERR-GLS.           MOVE "GLS    BLK" TO MSG-COD-MENS.           MOVE "GNS" TO MSG-COD-SIST.           PERFORM GET-MSG.           MOVE MSG-GLS-DESC TO FRM-MENS.           MOVE FRM-SUAR-MAL TO FRM-SUAR.       FIN-ERR-GLS.           EXIT.?SECTION GNSBEKEY, ANSI      * Error de Llave en programa interactivo       ERR-KEY SECTION.       INI-ERR-KEY.           MOVE "KEY    BLK" TO MSG-COD-MENS.           MOVE "GNS" TO MSG-COD-SIST.           PERFORM GET-MSG.           MOVE MSG-GLS-DESC TO FRM-MENS.           MOVE FRM-SUAR-MAL TO FRM-SUAR.       FIN-ERR-KEY.           EXIT.?SECTION GNSBHVSM, ANSI      ********************* ERR *********************       GNS-HDL-VSM SECTION.       INI-GNS-HDL-VSM.           IF FIO-IVEZ NOT > SPACES               MOVE "N" TO FIO-IVEZ               EXEC CICS IGNORE CONDITION                     DSIDERR                       DUPKEY                        DUPREC                        ENDFILE                       ILLOGIC                       IOERR                         NOSPACE                       NOTFND                        NOTOPEN                 END-EXEC.       FIN-GNS-HDL-VSM.           EXIT.?SECTION GNSBMMNU, ANSI      * 13-Apr-95 04:48 PM       PUT-ALL-MNU SECTION.       INI-PUT-ALL-MNU.           PERFORM PUT-MNU-MNU.       FIN-PUT-ALL-MNU.           EXIT.              PUT-MNU-MNU SECTION.       INI-PUT-MNU-MNU.           IF PGM-STAT-MNU-NUL               GO TO FIN-PUT-MNU-MNU.           IF NOT PGM-STAT-MNU-OKS               PERFORM CLR-MNU-MNU               GO TO FIN-PUT-MNU-MNU.           MOVE MNU-COD-NEMO IN MNU TO MNU-COD-NEMO IN MNU-FLD.           MOVE MNU-COD-OPCI IN MNU TO MNU-COD-OPCI IN MNU-FLD.           MOVE MNU-COD-IMEN IN MNU TO MNU-COD-IMEN IN MNU-FLD.           MOVE MNU-COD-SIST IN MNU TO MNU-COD-SIST IN MNU-FLD.           MOVE MNU-COD-FRET IN MNU TO MNU-COD-FRET IN MNU-FLD.           MOVE MNU-GLS-FMEN IN MNU TO MNU-GLS-FMEN IN MNU-FLD.           MOVE MNU-COD-FANT IN MNU TO MNU-COD-FANT IN MNU-FLD.           MOVE MNU-GLS-FPRO IN MNU TO MNU-GLS-FPRO IN MNU-FLD.           MOVE MNU-GLS-NMHD IN MNU TO MNU-GLS-NMHD IN MNU-FLD.           MOVE MNU-GLS-LMHD IN MNU TO MNU-GLS-LMHD IN MNU-FLD.           MOVE MNU-COD-AMHD IN MNU TO MNU-COD-AMHD IN MNU-FLD.           MOVE MNU-IND-EXGL IN MNU TO MNU-IND-EXGL IN MNU-FLD.           MOVE MNU-GLS-NFRM IN MNU TO MNU-GLS-NFRM IN MNU-FLD.           MOVE MNU-GLS-LFRM IN MNU TO MNU-GLS-LFRM IN MNU-FLD.           MOVE MNU-COD-AMPG IN MNU TO MNU-COD-AMPG IN MNU-FLD.           MOVE MNU-GLS-NMCM IN MNU TO MNU-GLS-NMCM IN MNU-FLD.           MOVE MNU-GLS-LMCM IN MNU TO MNU-GLS-LMCM IN MNU-FLD.           MOVE MNU-COD-AMCM IN MNU TO MNU-COD-AMCM IN MNU-FLD.           MOVE MNU-COD-TFUN IN MNU TO MNU-COD-TFUN IN MNU-FLD.           MOVE MNU-COD-MENU IN MNU TO MNU-COD-MENU IN MNU-FLD.           MOVE MNU-COD-CIFD IN MNU TO MNU-COD-CIFD IN MNU-FLD.           MOVE MNU-GLS-PROG IN MNU TO MNU-GLS-PROG IN MNU-FLD.           MOVE MNU-GLS-TRAN IN MNU TO MNU-GLS-TRAN IN MNU-FLD.           MOVE MNU-COD-CMND IN MNU TO MNU-COD-CMND IN MNU-FLD.           MOVE MNU-COD-INST IN MNU TO MNU-COD-INST IN MNU-FLD.           MOVE MNU-COD-TINF IN MNU TO MNU-COD-TINF IN MNU-FLD.           MOVE MNU-COD-TCTL IN MNU TO MNU-COD-TCTL IN MNU-FLD.           MOVE MNU-COD-ASCR IN MNU TO MNU-COD-ASCR IN MNU-FLD.           MOVE MNU-COD-MSAL IN MNU TO MNU-COD-MSAL IN MNU-FLD.           MOVE MNU-IND-IPRV IN MNU TO MNU-IND-IPRV IN MNU-FLD.           MOVE MNU-IND-SEQU IN MNU TO MNU-IND-SEQU IN MNU-FLD.           MOVE MNU-GLS-LDOC IN MNU TO MNU-GLS-LDOC IN MNU-FLD.           MOVE MNU-GLS-NDOC IN MNU TO MNU-GLS-NDOC IN MNU-FLD.           MOVE MNU-IND-CONF IN MNU TO MNU-IND-CONF IN MNU-FLD.           MOVE MNU-NUM-FILA IN MNU TO MNU-NUM-FILA IN MNU-FLD.           MOVE MNU-NUM-COLU IN MNU TO MNU-NUM-COLU IN MNU-FLD.       FIN-PUT-MNU-MNU.           EXIT.      * 13-Apr-95 04:48 PM       RET-ALL-MNU SECTION.       INI-RET-ALL-MNU.           PERFORM KEY-ALL-MNU.           PERFORM RET-MNU-MNU.       FIN-RET-ALL-MNU.           EXIT.              RET-MNU-MNU SECTION.       INI-RET-MNU-MNU.           MOVE MNU-COD-SIST IN MNU-FLD TO MNU-COD-SIST IN MNU.           MOVE MNU-COD-FRET IN MNU-FLD TO MNU-COD-FRET IN MNU.           MOVE MNU-GLS-FMEN IN MNU-FLD TO MNU-GLS-FMEN IN MNU.           MOVE MNU-COD-FANT IN MNU-FLD TO MNU-COD-FANT IN MNU.           MOVE MNU-GLS-FPRO IN MNU-FLD TO MNU-GLS-FPRO IN MNU.           MOVE MNU-GLS-NMHD IN MNU-FLD TO MNU-GLS-NMHD IN MNU.           MOVE MNU-GLS-LMHD IN MNU-FLD TO MNU-GLS-LMHD IN MNU.           MOVE MNU-COD-AMHD IN MNU-FLD TO MNU-COD-AMHD IN MNU.           MOVE MNU-IND-EXGL IN MNU-FLD TO MNU-IND-EXGL IN MNU.           MOVE MNU-GLS-NFRM IN MNU-FLD TO MNU-GLS-NFRM IN MNU.           MOVE MNU-GLS-LFRM IN MNU-FLD TO MNU-GLS-LFRM IN MNU.           MOVE MNU-COD-AMPG IN MNU-FLD TO MNU-COD-AMPG IN MNU.           MOVE MNU-GLS-NMCM IN MNU-FLD TO MNU-GLS-NMCM IN MNU.           MOVE MNU-GLS-LMCM IN MNU-FLD TO MNU-GLS-LMCM IN MNU.           MOVE MNU-COD-AMCM IN MNU-FLD TO MNU-COD-AMCM IN MNU.           MOVE MNU-COD-TFUN IN MNU-FLD TO MNU-COD-TFUN IN MNU.           MOVE MNU-COD-MENU IN MNU-FLD TO MNU-COD-MENU IN MNU.           MOVE MNU-COD-CIFD IN MNU-FLD TO MNU-COD-CIFD IN MNU.           MOVE MNU-GLS-PROG IN MNU-FLD TO MNU-GLS-PROG IN MNU.           MOVE MNU-GLS-TRAN IN MNU-FLD TO MNU-GLS-TRAN IN MNU.           MOVE MNU-COD-CMND IN MNU-FLD TO MNU-COD-CMND IN MNU.           MOVE MNU-COD-INST IN MNU-FLD TO MNU-COD-INST IN MNU.           MOVE MNU-COD-TINF IN MNU-FLD TO MNU-COD-TINF IN MNU.           MOVE MNU-COD-TCTL IN MNU-FLD TO MNU-COD-TCTL IN MNU.           MOVE MNU-COD-ASCR IN MNU-FLD TO MNU-COD-ASCR IN MNU.           MOVE MNU-COD-MSAL IN MNU-FLD TO MNU-COD-MSAL IN MNU.           MOVE MNU-IND-IPRV IN MNU-FLD TO MNU-IND-IPRV IN MNU.           MOVE MNU-IND-SEQU IN MNU-FLD TO MNU-IND-SEQU IN MNU.           MOVE MNU-GLS-LDOC IN MNU-FLD TO MNU-GLS-LDOC IN MNU.           MOVE MNU-GLS-NDOC IN MNU-FLD TO MNU-GLS-NDOC IN MNU.           MOVE MNU-IND-CONF IN MNU-FLD TO MNU-IND-CONF IN MNU.           MOVE MNU-NUM-FILA IN MNU-FLD TO MNU-NUM-FILA IN MNU.           MOVE MNU-NUM-COLU IN MNU-FLD TO MNU-NUM-COLU IN MNU.       FIN-RET-MNU-MNU.           EXIT.              KEY-ALL-MNU SECTION.       INI-KEY-ALL-MNU.           PERFORM KEY-MNU-MNU.       FIN-KEY-ALL-MNU.           EXIT.              KEY-MNU-MNU SECTION.       INI-KEY-MNU-MNU.           MOVE MNU-COD-NEMO IN MNU-FLD TO MNU-COD-NEMO IN MNU.           MOVE MNU-COD-OPCI IN MNU-FLD TO MNU-COD-OPCI IN MNU.           MOVE MNU-COD-IMEN IN MNU-FLD TO MNU-COD-IMEN IN MNU.       FIN-KEY-MNU-MNU.           EXIT.              SCR-CLRA-MNU SECTION.       INI-SCR-CLRA-MNU.           PERFORM CLR-KEY-MNU.           PERFORM CLR-FLD-MNU.       FIN-SCR-CLRA-MNU.           EXIT.              CLR-KEY-MNU SECTION.       INI-CLR-KEY-MNU.           MOVE SPACES TO MNU-COD-NEMO IN MNU-FLD.           MOVE SPACES TO MNU-COD-OPCI IN MNU-FLD.           MOVE SPACES TO MNU-COD-IMEN IN MNU-FLD.       FIN-CLR-KEY-MNU.           EXIT.              CLR-FLD-MNU SECTION.       INI-CLR-FLD-MNU.           PERFORM CLR-MNU-MNU.       FIN-CLR-FLD-MNU.           EXIT.              CLR-MNU-MNU SECTION.       INI-CLR-MNU-MNU.           MOVE SPACES TO MNU-COD-SIST IN MNU-FLD.           MOVE SPACES TO MNU-COD-FRET IN MNU-FLD.           MOVE SPACES TO MNU-GLS-FMEN IN MNU-FLD.           MOVE SPACES TO MNU-COD-FANT IN MNU-FLD.           MOVE SPACES TO MNU-GLS-FPRO IN MNU-FLD.           MOVE SPACES TO MNU-GLS-NMHD IN MNU-FLD.           MOVE SPACES TO MNU-GLS-LMHD IN MNU-FLD.           MOVE SPACES TO MNU-COD-AMHD IN MNU-FLD.           MOVE SPACES TO MNU-IND-EXGL IN MNU-FLD.           MOVE SPACES TO MNU-GLS-NFRM IN MNU-FLD.           MOVE SPACES TO MNU-GLS-LFRM IN MNU-FLD.           MOVE SPACES TO MNU-COD-AMPG IN MNU-FLD.           MOVE SPACES TO MNU-GLS-NMCM IN MNU-FLD.           MOVE SPACES TO MNU-GLS-LMCM IN MNU-FLD.           MOVE SPACES TO MNU-COD-AMCM IN MNU-FLD.           MOVE SPACES TO MNU-COD-TFUN IN MNU-FLD.           MOVE SPACES TO MNU-COD-MENU IN MNU-FLD.           MOVE SPACES TO MNU-COD-CIFD IN MNU-FLD.           MOVE SPACES TO MNU-GLS-PROG IN MNU-FLD.           MOVE SPACES TO MNU-GLS-TRAN IN MNU-FLD.           MOVE SPACES TO MNU-COD-CMND IN MNU-FLD.           MOVE SPACES TO MNU-COD-INST IN MNU-FLD.           MOVE SPACES TO MNU-COD-TINF IN MNU-FLD.           MOVE SPACES TO MNU-COD-TCTL IN MNU-FLD.           MOVE SPACES TO MNU-COD-ASCR IN MNU-FLD.           MOVE SPACES TO MNU-COD-MSAL IN MNU-FLD.           MOVE SPACES TO MNU-IND-IPRV IN MNU-FLD.           MOVE SPACES TO MNU-IND-SEQU IN MNU-FLD.           MOVE SPACES TO MNU-GLS-LDOC IN MNU-FLD.           MOVE SPACES TO MNU-GLS-NDOC IN MNU-FLD.           MOVE SPACES TO MNU-IND-CONF IN MNU-FLD.           MOVE ZEROES TO MNU-NUM-FILA IN MNU-FLD.           MOVE ZEROES TO MNU-NUM-COLU IN MNU-FLD.       FIN-CLR-MNU-MNU.           EXIT.              FST-KEY-MNU SECTION.       INI-FST-KEY-MNU.           MOVE FRM-POS-CURS TO MNU-COD-NEMO-LEN IN MNU-FLD.       FIN-FST-KEY-MNU.           EXIT.              FST-FLD-MNU SECTION.       INI-FST-FLD-MNU.           MOVE FRM-POS-CURS TO MNU-COD-OPCI-LEN IN MNU-FLD.       FIN-FST-FLD-MNU.           EXIT.              PRO-KEY-MNU SECTION.       INI-PRO-KEY-MNU.           PERFORM PRO-IKY-MNU.           PERFORM PRO-AKY-MNU.           PERFORM PRO-MKY-MNU.       FIN-PRO-KEY-MNU.           EXIT.              PRO-IKY-MNU SECTION.       INI-PRO-IKY-MNU.           MOVE FRM-CPIM-AEY TO MNU-COD-NEMO-ATR IN MNU-FLD.       FIN-PRO-IKY-MNU.           EXIT.              PRO-MKY-MNU SECTION.       INI-PRO-MKY-MNU.           MOVE FRM-CPIM-AEY TO MNU-COD-OPCI-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-IMEN-ATR IN MNU-FLD.       FIN-PRO-MKY-MNU.           EXIT.              PRO-AKY-MNU SECTION.       INI-PRO-AKY-MNU.       FIN-PRO-AKY-MNU.           EXIT.              PRO-FLD-MNU SECTION.       INI-PRO-FLD-MNU.           PERFORM PRO-MNU-MNU.       FIN-PRO-FLD-MNU.           EXIT.              PRO-MNU-MNU SECTION.       INI-PRO-MNU-MNU.           MOVE FRM-CPIM-AEY TO MNU-COD-SIST-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-FRET-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-FMEN-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-FANT-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-FPRO-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-NMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-LMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-AMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-IND-EXGL-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-NFRM-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-LFRM-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-AMPG-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-NMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-LMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-AMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-TFUN-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-MENU-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-CIFD-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-PROG-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-TRAN-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-CMND-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-INST-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-TINF-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-TCTL-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-ASCR-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-COD-MSAL-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-IND-IPRV-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-IND-SEQU-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-LDOC-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-GLS-NDOC-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-IND-CONF-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-NUM-FILA-ATR IN MNU-FLD.           MOVE FRM-CPIM-AEY TO MNU-NUM-COLU-ATR IN MNU-FLD.       FIN-PRO-MNU-MNU.           EXIT.              UNP-KEY-MNU SECTION.       INI-UNP-KEY-MNU.           PERFORM UNP-IKY-MNU.           PERFORM UNP-AKY-MNU.           PERFORM UNP-MKY-MNU.       FIN-UNP-KEY-MNU.           EXIT.              UNP-IKY-MNU SECTION.       INI-UNP-IKY-MNU.           MOVE FRM-CPIM-UBY TO MNU-COD-NEMO-ATR IN MNU-FLD.       FIN-UNP-IKY-MNU.           EXIT.              UNP-MKY-MNU SECTION.       INI-UNP-MKY-MNU.           MOVE FRM-CPIM-UBY TO MNU-COD-OPCI-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-IMEN-ATR IN MNU-FLD.       FIN-UNP-MKY-MNU.           EXIT.              UNP-AKY-MNU SECTION.       INI-UNP-AKY-MNU.       FIN-UNP-AKY-MNU.           EXIT.              UNP-FLD-MNU SECTION.       INI-UNP-FLD-MNU.           PERFORM UNP-MNU-MNU.       FIN-UNP-FLD-MNU.           EXIT.              UNP-MNU-MNU SECTION.       INI-UNP-MNU-MNU.           MOVE FRM-CPIM-UBY TO MNU-COD-SIST-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-FRET-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-FMEN-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-FANT-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-FPRO-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-NMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-LMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-AMHD-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-IND-EXGL-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-NFRM-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-LFRM-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-AMPG-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-NMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-LMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-AMCM-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-TFUN-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-MENU-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-CIFD-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-PROG-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-TRAN-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-CMND-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-INST-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-TINF-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-TCTL-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-ASCR-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-COD-MSAL-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-IND-IPRV-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-IND-SEQU-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-LDOC-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-GLS-NDOC-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-IND-CONF-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-NUM-FILA-ATR IN MNU-FLD.           MOVE FRM-CPIM-UBY TO MNU-NUM-COLU-ATR IN MNU-FLD.       FIN-UNP-MNU-MNU.           EXIT.              VAL-KEY-MNU SECTION.       INI-VAL-KEY-MNU.           PERFORM VAL-IKY-MNU.           PERFORM VAL-MKY-MNU.           PERFORM VAL-AKY-MNU.       FIN-VAL-KEY-MNU.           EXIT.              VAL-IKY-MNU SECTION.       INI-VAL-IKY-MNU.           PERFORM VAL-MNU-COD-NEMO.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-NEMO-LEN IN MNU-FLD                GO TO FIN-VAL-IKY-MNU.       FIN-VAL-IKY-MNU.           EXIT.              VAL-MKY-MNU SECTION.       INI-VAL-MKY-MNU.           PERFORM VAL-MNU-COD-OPCI.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-OPCI-LEN IN MNU-FLD                GO TO FIN-VAL-MKY-MNU.           PERFORM VAL-MNU-COD-IMEN.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-IMEN-LEN IN MNU-FLD                GO TO FIN-VAL-MKY-MNU.       FIN-VAL-MKY-MNU.           EXIT.              VAL-AKY-MNU SECTION.       INI-VAL-AKY-MNU.       FIN-VAL-AKY-MNU.           EXIT.              VAL-FLD-MNU SECTION.       INI-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-SIST.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-SIST-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-FRET.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-FRET-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-FMEN.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-FMEN-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-FANT.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-FANT-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-FPRO.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-FPRO-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-NMHD.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-NMHD-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-LMHD.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-LMHD-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-AMHD.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-AMHD-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-IND-EXGL.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-IND-EXGL-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-NFRM.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-NFRM-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-LFRM.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-LFRM-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-AMPG.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-AMPG-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-NMCM.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-NMCM-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-LMCM.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-LMCM-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-AMCM.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-AMCM-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-TFUN.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-TFUN-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-MENU.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-MENU-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-CIFD.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-CIFD-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-PROG.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-PROG-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-TRAN.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-TRAN-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-CMND.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-CMND-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-INST.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-INST-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-TINF.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-TINF-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-TCTL.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-TCTL-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-ASCR.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-ASCR-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-COD-MSAL.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-COD-MSAL-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-IND-IPRV.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-IND-IPRV-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-IND-SEQU.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-IND-SEQU-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-LDOC.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-LDOC-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-GLS-NDOC.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-GLS-NDOC-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-IND-CONF.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-IND-CONF-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-NUM-FILA.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-NUM-FILA-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.           PERFORM VAL-MNU-NUM-COLU.           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR                MOVE FRM-IND-ERRO TO MNU-NUM-COLU-LEN IN MNU-FLD                GO TO FIN-VAL-FLD-MNU.       FIN-VAL-FLD-MNU.           EXIT.              VAL-MNU-COD-NEMO SECTION.       INI-VAL-MNU-COD-NEMO.           IF MNU-COD-NEMO IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-NEMO IN MNU-FLD.      *<<<< MNU_COD_NEMO      *>>>>       FIN-VAL-MNU-COD-NEMO.           EXIT.              VAL-MNU-COD-OPCI SECTION.       INI-VAL-MNU-COD-OPCI.           IF MNU-COD-OPCI IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-OPCI IN MNU-FLD.      *<<<< MNU_COD_OPCI           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = "COP"               MOVE "MNU-COD-OPCI" TO FIO-AKEY               MOVE MNU-COD-OPCI IN MNU-FLD TO MNU-COD-OPCI IN MNU               MOVE FIO-GET-KEY TO FIO-CMND               PERFORM CHK-DUPL.      *>>>>       FIN-VAL-MNU-COD-OPCI.           EXIT.              VAL-MNU-COD-IMEN SECTION.       INI-VAL-MNU-COD-IMEN.           IF MNU-COD-IMEN IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-IMEN IN MNU-FLD.      *<<<< MNU_COD_IMEN           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = "COP"               MOVE "MNU-COD-IMEN" TO FIO-AKEY               MOVE MNU-COD-IMEN IN MNU-FLD TO MNU-COD-IMEN IN MNU               MOVE FIO-GET-KEY TO FIO-CMND               PERFORM CHK-DUPL.      *>>>>       FIN-VAL-MNU-COD-IMEN.           EXIT.              VAL-MNU-COD-SIST SECTION.       INI-VAL-MNU-COD-SIST.           IF MNU-COD-SIST IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-SIST IN MNU-FLD.      *<<<< MNU_COD_SIST      *>>>>       FIN-VAL-MNU-COD-SIST.           EXIT.              VAL-MNU-COD-FRET SECTION.       INI-VAL-MNU-COD-FRET.           IF MNU-COD-FRET IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-FRET IN MNU-FLD.      *<<<< MNU_COD_FRET           IF MNU-COD-FRET IN MNU-FLD NOT > SPACES               MOVE "SIS" TO MNU-COD-FRET IN MNU-FLD.      *>>>>       FIN-VAL-MNU-COD-FRET.           EXIT.              VAL-MNU-GLS-FMEN SECTION.       INI-VAL-MNU-GLS-FMEN.           IF MNU-GLS-FMEN IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-FMEN IN MNU-FLD.      *<<<< MNU_GLS_FMEN      *>>>>       FIN-VAL-MNU-GLS-FMEN.           EXIT.              VAL-MNU-COD-FANT SECTION.       INI-VAL-MNU-COD-FANT.           IF MNU-COD-FANT IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-FANT IN MNU-FLD.      *<<<< MNU_COD_FANT      *>>>>       FIN-VAL-MNU-COD-FANT.           EXIT.              VAL-MNU-GLS-FPRO SECTION.       INI-VAL-MNU-GLS-FPRO.           IF MNU-GLS-FPRO IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-FPRO IN MNU-FLD.      *<<<< MNU_GLS_FPRO           IF MNU-GLS-FPRO IN MNU-FLD = """"               MOVE MNU-GLS-FMEN IN MNU-FLD TO MNU-GLS-FPRO IN MNU-FLD.      *>>>>       FIN-VAL-MNU-GLS-FPRO.           EXIT.              VAL-MNU-GLS-NMHD SECTION.       INI-VAL-MNU-GLS-NMHD.           IF MNU-GLS-NMHD IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-NMHD IN MNU-FLD.       FIN-VAL-MNU-GLS-NMHD.           EXIT.              VAL-MNU-GLS-LMHD SECTION.       INI-VAL-MNU-GLS-LMHD.           IF MNU-GLS-LMHD IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-LMHD IN MNU-FLD.       FIN-VAL-MNU-GLS-LMHD.           EXIT.              VAL-MNU-COD-AMHD SECTION.       INI-VAL-MNU-COD-AMHD.           IF MNU-COD-AMHD IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-AMHD IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "AMP " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-AMHD IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-AMHD.           EXIT.              VAL-MNU-IND-EXGL SECTION.       INI-VAL-MNU-IND-EXGL.           IF MNU-IND-EXGL IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-IND-EXGL IN MNU-FLD.      *<<<< MNU_IND_EXGL           IF MNU-IND-EXGL IN MNU-FLD NOT > SPACES               MOVE "N" TO MNU-IND-EXGL IN MNU-FLD.      *>>>>      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "SON " TO TAB-COD-TTAB IN TAB.           MOVE MNU-IND-EXGL IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-IND-EXGL.           EXIT.              VAL-MNU-GLS-NFRM SECTION.       INI-VAL-MNU-GLS-NFRM.           IF MNU-GLS-NFRM IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-NFRM IN MNU-FLD.      *<<<< MNU_GLS_NFRM           IF MNU-GLS-NFRM IN MNU-FLD NOT > SPACES AND              MNU-GLS-LFRM IN MNU-FLD     > SPACES               MOVE MNU-GLS-LFRM IN MNU-FLD TO WSS-GLS-FORM               MOVE "F" TO WSS-COD-FORM               MOVE WSS-GLS-FORM TO MNU-GLS-NFRM IN MNU-FLD.      *>>>>       FIN-VAL-MNU-GLS-NFRM.           EXIT.              VAL-MNU-GLS-LFRM SECTION.       INI-VAL-MNU-GLS-LFRM.           IF MNU-GLS-LFRM IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-LFRM IN MNU-FLD.      *<<<< MNU_GLS_LFRM           IF MNU-GLS-LFRM IN MNU-FLD NOT > SPACES AND              MNU-GLS-NFRM IN MNU-FLD     > SPACES               MOVE MNU-GLS-NFRM IN MNU-FLD TO WSS-GLS-FORM               MOVE "A" TO WSS-COD-FORM               MOVE WSS-GLS-FORM TO MNU-GLS-LFRM IN MNU-FLD.      *>>>>       FIN-VAL-MNU-GLS-LFRM.           EXIT.              VAL-MNU-COD-AMPG SECTION.       INI-VAL-MNU-COD-AMPG.           IF MNU-COD-AMPG IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-AMPG IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "AMP " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-AMPG IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-AMPG.           EXIT.              VAL-MNU-GLS-NMCM SECTION.       INI-VAL-MNU-GLS-NMCM.           IF MNU-GLS-NMCM IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-NMCM IN MNU-FLD.       FIN-VAL-MNU-GLS-NMCM.           EXIT.              VAL-MNU-GLS-LMCM SECTION.       INI-VAL-MNU-GLS-LMCM.           IF MNU-GLS-LMCM IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-LMCM IN MNU-FLD.       FIN-VAL-MNU-GLS-LMCM.           EXIT.              VAL-MNU-COD-AMCM SECTION.       INI-VAL-MNU-COD-AMCM.           IF MNU-COD-AMCM IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-AMCM IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "AMP " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-AMCM IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-AMCM.           EXIT.              VAL-MNU-COD-TFUN SECTION.       INI-VAL-MNU-COD-TFUN.           IF MNU-COD-TFUN IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-TFUN IN MNU-FLD.      *<<<< MNU_COD_TFUN           IF MNU-COD-TFUN IN MNU-FLD NOT > SPACES               MOVE "PGI" TO MNU-COD-TFUN IN MNU-FLD.      *>>>>      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "TFN " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-TFUN IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-TFUN.           EXIT.              VAL-MNU-COD-MENU SECTION.       INI-VAL-MNU-COD-MENU.           IF MNU-COD-MENU IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-MENU IN MNU-FLD.      *<<<< MNU_COD_MENU      *>>>>       FIN-VAL-MNU-COD-MENU.           EXIT.              VAL-MNU-COD-CIFD SECTION.       INI-VAL-MNU-COD-CIFD.           IF MNU-COD-CIFD IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-CIFD IN MNU-FLD.       FIN-VAL-MNU-COD-CIFD.           EXIT.              VAL-MNU-GLS-PROG SECTION.       INI-VAL-MNU-GLS-PROG.           IF MNU-GLS-PROG IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-PROG IN MNU-FLD.      *<<<< MNU_GLS_PROG      *>>>>       FIN-VAL-MNU-GLS-PROG.           EXIT.              VAL-MNU-GLS-TRAN SECTION.       INI-VAL-MNU-GLS-TRAN.           IF MNU-GLS-TRAN IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-TRAN IN MNU-FLD.      *<<<< MNU_GLS_TRAN      *>>>>       FIN-VAL-MNU-GLS-TRAN.           EXIT.              VAL-MNU-COD-CMND SECTION.       INI-VAL-MNU-COD-CMND.           IF MNU-COD-CMND IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-CMND IN MNU-FLD.      *<<<< MNU_COD_CMND      *>>>>       FIN-VAL-MNU-COD-CMND.           EXIT.              VAL-MNU-COD-INST SECTION.       INI-VAL-MNU-COD-INST.           IF MNU-COD-INST IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-INST IN MNU-FLD.      *<<<< MNU_COD_INST      *>>>>      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "IST " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-INST IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-INST.           EXIT.              VAL-MNU-COD-TINF SECTION.       INI-VAL-MNU-COD-TINF.           IF MNU-COD-TINF IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-TINF IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "TIN " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-TINF IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-TINF.           EXIT.              VAL-MNU-COD-TCTL SECTION.       INI-VAL-MNU-COD-TCTL.           IF MNU-COD-TCTL IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-TCTL IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "TCT " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-TCTL IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-TCTL.           EXIT.              VAL-MNU-COD-ASCR SECTION.       INI-VAL-MNU-COD-ASCR.           IF MNU-COD-ASCR IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-ASCR IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "ASC " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-ASCR IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-ASCR.           EXIT.              VAL-MNU-COD-MSAL SECTION.       INI-VAL-MNU-COD-MSAL.           IF MNU-COD-MSAL IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-COD-MSAL IN MNU-FLD.      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "MSL " TO TAB-COD-TTAB IN TAB.           MOVE MNU-COD-MSAL IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-COD-MSAL.           EXIT.              VAL-MNU-IND-IPRV SECTION.       INI-VAL-MNU-IND-IPRV.           IF MNU-IND-IPRV IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-IND-IPRV IN MNU-FLD.      *<<<< MNU_IND_IPRV      *>>>>      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "IPV " TO TAB-COD-TTAB IN TAB.           MOVE MNU-IND-IPRV IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-IND-IPRV.           EXIT.              VAL-MNU-IND-SEQU SECTION.       INI-VAL-MNU-IND-SEQU.           IF MNU-IND-SEQU IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-IND-SEQU IN MNU-FLD.      *<<<< MNU_IND_SEQU      *>>>>       FIN-VAL-MNU-IND-SEQU.           EXIT.              VAL-MNU-GLS-LDOC SECTION.       INI-VAL-MNU-GLS-LDOC.           IF MNU-GLS-LDOC IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-LDOC IN MNU-FLD.      *<<<< MNU_GLS_LDOC      *>>>>       FIN-VAL-MNU-GLS-LDOC.           EXIT.              VAL-MNU-GLS-NDOC SECTION.       INI-VAL-MNU-GLS-NDOC.           IF MNU-GLS-NDOC IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-GLS-NDOC IN MNU-FLD.      *<<<< MNU_GLS_NDOC      *>>>>       FIN-VAL-MNU-GLS-NDOC.           EXIT.              VAL-MNU-IND-CONF SECTION.       INI-VAL-MNU-IND-CONF.           IF MNU-IND-CONF IN MNU-FLD NOT > SPACES              MOVE SPACES TO MNU-IND-CONF IN MNU-FLD.      *<<<< MNU_IND_CONF      *>>>>      *VAL-COD Valida codigo de tabla           MOVE "GNS" TO TAB-COD-SIST.           MOVE "SON " TO TAB-COD-TTAB IN TAB.           MOVE MNU-IND-CONF IN MNU-FLD TO TAB-COD-CTAB IN TAB.           PERFORM VAL-COD.       FIN-VAL-MNU-IND-CONF.           EXIT.              VAL-MNU-NUM-FILA SECTION.       INI-VAL-MNU-NUM-FILA.      *<<<< MNU_NUM_FILA           IF MNU-NUM-FILA IN MNU-FLD NOT > ZEROES               GO TO FIN-VAL-MNU-NUM-FILA.           IF MNU-NUM-FILA IN MNU-FLD < 3 OR              MNU-NUM-FILA IN MNU-FLD > 21               MOVE "GNS" TO MSG-COD-SIST               MOVE "MNUFILAINV" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR.      *>>>>       FIN-VAL-MNU-NUM-FILA.           EXIT.              VAL-MNU-NUM-COLU SECTION.       INI-VAL-MNU-NUM-COLU.      *<<<< MNU_NUM_COLU           IF MNU-NUM-COLU IN MNU-FLD NOT > ZEROES               GO TO FIN-VAL-MNU-NUM-COLU.           IF NOT ( MNU-NUM-COLU IN MNU-FLD = 1  OR                    MNU-NUM-COLU IN MNU-FLD = 24 OR                    MNU-NUM-COLU IN MNU-FLD = 41 )               MOVE "GNS" TO MSG-COD-SIST               MOVE "MNUCOLUINV" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR.      *>>>>       FIN-VAL-MNU-NUM-COLU.           EXIT.              VAL-CON-KEY-MNU SECTION.       INI-VAL-CON-KEY-MNU.           IF     MNU-COD-NEMO IN MNU-FLD NOT > SPACES               AND MNU-COD-OPCI IN MNU-FLD NOT > SPACES               AND MNU-COD-IMEN IN MNU-FLD NOT > SPACES                 PERFORM ERR-KEY                PERFORM FST-KEY-MNU.       FIN-VAL-CON-KEY-MNU.           EXIT.              VAL-CON-IKY-MNU SECTION.       INI-VAL-CON-IKY-MNU.           IF     MNU-COD-NEMO IN MNU-FLD NOT > SPACES                 PERFORM ERR-KEY                PERFORM FST-KEY-MNU.       FIN-VAL-CON-IKY-MNU.           EXIT.              VAL-CON-FLD-MNU SECTION.       INI-VAL-CON-FLD-MNU.      *<<<< VAL_CON_FLD_MNU           IF SCR-CMND = "COP"               MOVE MNU-COD-NEMO IN MNU-FLD TO MNU-COD-NEMO IN MNU               MOVE FIO-GET-KEY TO FIO-CMND               PERFORM CHK-DUPL.           IF MNU-COD-OPCI IN MNU-FLD NOT > SPACES               PERFORM ERR-GLS               GO TO FIN-VAL-CON-FLD-MNU.           IF MNU-COD-SIST IN MNU-FLD     > SPACES   AND              MNU-COD-SIST IN MNU-FLD NOT = SCR-SISG AND              MNU-COD-TFUN IN MNU-FLD NOT = "MEN"               MOVE "GNS"   TO MSG-COD-SIST               MOVE "MNUSISTTFUNI" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR               GO TO FIN-VAL-CON-FLD-MNU.           IF MNU-COD-CMND IN MNU-FLD     > SPACES AND              MNU-COD-SIST IN MNU-FLD     > SPACES AND              MNU-COD-SIST IN MNU-FLD NOT = SCR-SISG                 MOVE "GNS"   TO MSG-COD-SIST               MOVE "MNUCMNDSISTI" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR               GO TO FIN-VAL-CON-FLD-MNU.           IF MNU-COD-CMND IN MNU-FLD     > SPACES AND              MNU-COD-TFUN IN MNU-FLD     = "MEN"                MOVE "GNS"   TO MSG-COD-SIST               MOVE "MNUCMNDTFUNI" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR               GO TO FIN-VAL-CON-FLD-MNU.           PERFORM VAL-CON-GLS-PROG.      *>>>>       FIN-VAL-CON-FLD-MNU.           EXIT.              VAL-CON-MNU SECTION.       INI-VAL-CON-MNU.       FIN-VAL-CON-MNU.           EXIT.              VAL-NUM-KEY-MNU SECTION.       INI-VAL-NUM-KEY-MNU.           PERFORM VAL-NUM-IKY-MNU.           PERFORM VAL-NUM-MKY-MNU.           PERFORM VAL-NUM-AKY-MNU.       FIN-VAL-NUM-KEY-MNU.           EXIT.              VAL-NUM-IKY-MNU SECTION.       INI-VAL-NUM-IKY-MNU.       FIN-VAL-NUM-IKY-MNU.           EXIT.              VAL-NUM-MKY-MNU SECTION.       INI-VAL-NUM-MKY-MNU.       FIN-VAL-NUM-MKY-MNU.           EXIT.              VAL-NUM-AKY-MNU SECTION.       INI-VAL-NUM-AKY-MNU.       FIN-VAL-NUM-AKY-MNU.           EXIT.              VAL-NUM-FLD-MNU SECTION.       INI-VAL-NUM-FLD-MNU.       VAL-NUM-MNU-NUM-FILA.           MOVE MNU-NUM-FILA-ALF IN MNU-FLD TO NUM-NUME.           MOVE NUM-ZERO-S TO NUM-ZERO.           MOVE NUM-SGNO-N TO NUM-SGNO.           MOVE 2 TO NUM-NENT.           MOVE 0 TO NUM-NDCM.           PERFORM VAL-NUM.           IF NUM-STAT-OKS               MOVE NUM-NN9N TO MNU-NUM-FILA IN MNU-FLD           ELSE               MOVE NUM-MENS     TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR               MOVE FRM-ERR-NUME TO MNU-NUM-FILA-LEN IN MNU-FLD                GO TO FIN-VAL-NUM-FLD-MNU.       VAL-NUM-MNU-NUM-COLU.           MOVE MNU-NUM-COLU-ALF IN MNU-FLD TO NUM-NUME.           MOVE NUM-ZERO-S TO NUM-ZERO.           MOVE NUM-SGNO-N TO NUM-SGNO.           MOVE 2 TO NUM-NENT.           MOVE 0 TO NUM-NDCM.           PERFORM VAL-NUM.           IF NUM-STAT-OKS               MOVE NUM-NN9N TO MNU-NUM-COLU IN MNU-FLD           ELSE               MOVE NUM-MENS     TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR               MOVE FRM-ERR-NUME TO MNU-NUM-COLU-LEN IN MNU-FLD                GO TO FIN-VAL-NUM-FLD-MNU.       FIN-VAL-NUM-FLD-MNU.           EXIT.              EDT-KEY-MNU SECTION.       INI-EDT-KEY-MNU.           PERFORM EDT-IKY-MNU.           PERFORM EDT-MKY-MNU.           PERFORM EDT-AKY-MNU.       FIN-EDT-KEY-MNU.           EXIT.              EDT-IKY-MNU SECTION.       INI-EDT-IKY-MNU.       FIN-EDT-IKY-MNU.           EXIT.              EDT-MKY-MNU SECTION.       INI-EDT-MKY-MNU.       FIN-EDT-MKY-MNU.           EXIT.              EDT-AKY-MNU SECTION.       INI-EDT-AKY-MNU.       FIN-EDT-AKY-MNU.           EXIT.              EDT-FLD-MNU SECTION.       INI-EDT-FLD-MNU.           IF MNU-NUM-FILA-LEN IN MNU-FLD = FRM-ERR-NUME                MOVE FRM-IND-ERRO TO MNU-NUM-FILA-LEN IN MNU-FLD                GO TO FIN-EDT-FLD-MNU.           MOVE MNU-NUM-FILA IN MNU-FLD TO MNU-NUM-FILA-EDT IN MNU-EDT.           MOVE MNU-NUM-FILA-EDT IN MNU-EDT TO                 MNU-NUM-FILA-ALF IN MNU-FLD.           IF MNU-NUM-COLU-LEN IN MNU-FLD = FRM-ERR-NUME                MOVE FRM-IND-ERRO TO MNU-NUM-COLU-LEN IN MNU-FLD                GO TO FIN-EDT-FLD-MNU.           MOVE MNU-NUM-COLU IN MNU-FLD TO MNU-NUM-COLU-EDT IN MNU-EDT.           MOVE MNU-NUM-COLU-EDT IN MNU-EDT TO                 MNU-NUM-COLU-ALF IN MNU-FLD.       FIN-EDT-FLD-MNU.           EXIT.      *<<<< EOF       CHK-DUPL SECTION.       INI-CHK-DUPL.           MOVE SCR-SISG TO FIO-SIST.           PERFORM GNS-FIO-MNU.           IF FIO-STAT-OKS               MOVE "GNS" TO MSG-COD-SIST               MOVE "KEY    DUPLI" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR.       FIN-CHK-DUPL.           EXIT.      *>>>>      *<<<< EOF_IBM       VAL-CON-GLS-PROG SECTION.       INI-VAL-CON-GLS-PROG.           IF NOT ( ( MNU-GLS-PROG IN MNU-FLD     > SPACES AND                      MNU-GLS-TRAN IN MNU-FLD     > SPACES ) OR                    ( MNU-GLS-PROG IN MNU-FLD NOT > SPACES AND                      MNU-GLS-TRAN IN MNU-FLD NOT > SPACES ) )               MOVE "GNS"   TO MSG-COD-SIST               MOVE "MNUPROGTRANI" TO MSG-COD-MENS               PERFORM GET-MSG               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR.       FIN-VAL-CON-GLS-PROG.           EXIT.      *>>>>?SECTION GNSBVCOD, ANSI      * Validacion de Codigo en Tabla en programa interactivo       VAL-COD SECTION.       INI-VAL-COD.           PERFORM VAL-TAB.           IF MSG-COD-MENS NOT = SPACES               MOVE MSG-GLS-DESC TO FRM-MENS               MOVE FRM-SUAR-MAL TO FRM-SUAR.       FIN-VAL-COD.           EXIT.?SECTION GNSBVNUM, ANSI      * INVOCACION A RUTINA DE VALIDACION NUMERICA       VAL-NUM SECTION.       INI-VAL-NUM.           CALL "GNSPVNUM" USING NUM-VARI.       FIN-VAL-NUM.           EXIT.?SECTION GNSBVTAB, ANSI      * Validacion de Codigo en Tabla       VAL-TAB SECTION.       INI-VAL-TAB.           MOVE TAB-COD-SIST TO FIO-SIST.           MOVE FIO-GET-KEY TO FIO-CMND.           PERFORM GNS-FIO-TAB.           IF FIO-STAT-OKS               IF TAB-IND-VIGE IN TAB = "N"                   MOVE "COD    NVG" TO MSG-COD-MENS                   MOVE "GNS" TO MSG-COD-SIST                   PERFORM GET-MSG               ELSE                   MOVE SPACES TO MSG-COD-MENS                                  MSG-GLS-DESC           ELSE               MOVE "COD    NEX" TO MSG-COD-MENS               MOVE "GNS" TO MSG-COD-SIST               PERFORM GET-MSG.       FIN-VAL-TAB.           EXIT.?SECTION GNSWCNUM, ANSI      * Constantes para validacion numerica       01  NUM-CTTS.           03 NUM-ZERO-N                        VALUE 1 PIC 9(01).           03 NUM-ZERO-S                        VALUE 0 PIC 9(01).           03 NUM-SGNO-N                        VALUE 0 PIC 9(01).           03 NUM-SGNO-S                        VALUE 1 PIC 9(01).?SECTION GNSWVNUM, ANSI      * Variables para validacion numerica       01  NUM-VARI.           03 NUM-NUME                                PIC X(25).           03 NUM-CNDV.              05 NUM-NENT                             PIC 9(02).              05 NUM-NDCM                             PIC 9(02).              05 NUM-ZERO                             PIC 9(01).              05 NUM-SGNO                             PIC 9(01).           03 NUM-STAT                                PIC 9(02).              88 NUM-STAT-OKS                 VALUE 0.              88 NUM-STAT-FMT                 VALUE 1.           03 NUM-MENS                                PIC X(67).           03 NUM-CMSG                                PIC X(12).           03 NUM-NUMV.              05 NUM-NS9V                             PIC S9(13)V9(05).              05 NUM-RED4     REDEFINES NUM-NS9V.                 07 NUM-PENT                          PIC 9(13).                 07 NUM-PENT-RED REDEFINES NUM-PENT   PIC X(01)                                 OCCURS 13.                 07 NUM-PENT-RE1 REDEFINES NUM-PENT.                    09 FILLER                         PIC X(05).                    09 NUM-PENT-DE8                   PIC 9(08).                 07 NUM-PDCM                          PIC V9(05).                 07 NUM-PDCM-RED REDEFINES NUM-PDCM   PIC X(01)                                 OCCURS 5.              05 NUM-NS9N     REDEFINES NUM-NS9V      PIC S9(13)V9(05).              05 NUM-NN9V     REDEFINES NUM-NS9V      PIC S9(13)V9(05).              05 NUM-NN9N     REDEFINES NUM-NS9V      PIC S9(13)V9(05).?SECTION GNSSGHDR, ANSI           03 SC-HDR.              05 SC-HDR-COD-SIST AT 01, 02                            PIC X(03)                            FROM HDR-COD-SIST IN HDR-FLD                            SHADOWED BY HDR-COD-SIST-ATR IN HDR-FLD.              05 SC-HDR-GLS-NFRM AT 01, 06                            PIC X(03)                            FROM HDR-GLS-NFRM IN HDR-FLD                            SHADOWED BY HDR-GLS-NFRM-ATR IN HDR-FLD.              05 SC-HDR-GLS-FPRO AT 01, 10                            PIC X(59)                            FROM HDR-GLS-FPRO IN HDR-FLD                            SHADOWED BY HDR-GLS-FPRO-ATR IN HDR-FLD.              05 SC-HDR-FEC-DMSA AT 01, 70                            PIC X(10)                            FROM HDR-FEC-DMSA IN HDR-FLD                            SHADOWED BY HDR-FEC-DMSA-ATR IN HDR-FLD.              05 SC-HDR-COD-FUNC AT 02, 01                            PIC X(11)                            FROM HDR-COD-FUNC IN HDR-FLD                            SHADOWED BY HDR-COD-FUNC-ATR IN HDR-FLD.              05 SC-HDR-GLS-GLS1 AT 02, 69                            PIC X(03)                            FROM HDR-GLS-GLS1 IN HDR-FLD                            SHADOWED BY HDR-GLS-GLS1-ATR IN HDR-FLD.              05 SC-HDR-GLS-GLS2 AT 02, 73                            PIC X(03)                            FROM HDR-GLS-GLS2 IN HDR-FLD                            SHADOWED BY HDR-GLS-GLS2-ATR IN HDR-FLD.              05 SC-HDR-GLS-GLS3 AT 02, 77                            PIC X(03)                            FROM HDR-GLS-GLS3 IN HDR-FLD                            SHADOWED BY HDR-GLS-GLS3-ATR IN HDR-FLD.      *?SECTION GNSSGTRL, ANSI           03 SC-TRL.              05 SC-TRL-GLS-TERM AT 22, 01                            PIC X(79)                            FROM  TRL-GLS-TERM IN TRL-FLD                            SHADOWED BY TRL-GLS-TERM-ATR IN TRL-FLD.              05 SC-TRL-COD-CMND AT 23, 01                            PIC X(39)                            FROM  TRL-COD-CMND IN TRL-FLD                            SHADOWED BY TRL-COD-CMND-ATR IN TRL-FLD.              05 SC-TRL-GLS-PRMT AT 23, 41                            PIC X(25)                            FROM  TRL-GLS-PRMT IN TRL-FLD                            SHADOWED BY TRL-GLS-PRMT-ATR IN TRL-FLD.              05 SC-TRL-COD-CACC AT 23, 69                            PIC X(11)                            USING TRL-COD-CACC IN TRL-FLD                            SHADOWED BY TRL-COD-CACC-ATR IN TRL-FLD.      *        05 SC-TRL-GLS-MENS AT 24, 01      *                      PIC X(79)      *                      FROM  TRL-GLS-MENS IN TRL-FLD      *                      SHADOWED BY TRL-GLS-MENS-ATR IN TRL-FLD.?SECTION GNSWCVRF, ANSI      *    Constantes para VRF       01  VRF-CTTS.      *    Verificador "K"           03 VRF-SVRF-K                VALUE 0         PIC 9(01).      *    Verificador "0"           03 VRF-SVRF-0                VALUE 1         PIC 9(01).      *    Verificador "1"           03 VRF-SVRF-1                VALUE 2         PIC 9(01).      *    Validacion dado un Numero y su Verificador           03 VRF-VAL           COMP    VALUE 1         PIC 9(04).      *    Obtencion del Verificador para un Numero dado.           03 VRF-GET           COMP    VALUE 2         PIC 9(04).      *    No acepta numero en cero           03 VRF-ZERO-N                VALUE 0         PIC 9(01).      *    Si acepta numero en cero           03 VRF-ZERO-S                VALUE 1         PIC 9(01).      *    Status BLK           03 VRF-SBLK                  VALUE 2         PIC 9(01).?SECTION GNSWVVRF, ANSI      *    Variables para VRF       01  VRF-VARI.      *    Numero + Digito Verificador           03 VRF-NUDV          JUST RIGHT              PIC X(13).           03 VRF-NUDV-RED REDEFINES VRF-NUDV.      *       Numero              05 VRF-NUME                               PIC 9(12).              05 VRF-NUME-RED REDEFINES VRF-NUME.                 07 VRF-DIGI OCCURS 12                  PIC 9(01).      *       Digito Verificador              05 VRF-DVRF                               PIC X(01).      *    Switch para Verificador "K" o "0"           03 VRF-SVRF                                  PIC 9(01).      *    Status de Retorno           03 VRF-STAT                                  PIC 9(01).              88 VRF-STAT-OKS           VALUE 0.              88 VRF-STAT-MAL           VALUE 1 THRU 9.              88 VRF-STAT-NUM           VALUE 1.              88 VRF-STAT-BLK           VALUE 2.              88 VRF-STAT-VRF           VALUE 3.      *    Switch para que acepte o no numero en cero           03 VRF-ZERO                                  PIC 9(01).      *    Mensaje de Retorno           03 VRF-CMSG                                  PIC X(12).      *    Comando           03 VRF-CMND          COMP                    PIC 9(04).      *    Limite superior           03 VRF-LMAX          COMP                    PIC 9(04).?SECTION DUMMY, ANSI       *DUMMY DUMMY DUMMY DUMMY DUMMY DUMMY DUMMY DUMMY DUMMY DUMMY