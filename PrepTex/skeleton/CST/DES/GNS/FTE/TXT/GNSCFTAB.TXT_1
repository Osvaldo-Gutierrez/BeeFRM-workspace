       GNS-FIO-TAB SECTION.
       INI-GNS-FIO-TAB.
           IF IFD-GSIS(1) IS NOT NUMERIC
               PERFORM GNS-FIO-TAB-VSM
           ELSE
               PERFORM GNS-FIO-TAB-DTC.
       FIN-GNS-FIO-TAB.
           EXIT.

      *Modulo FIO interactivo para registro TAB de VSAM, 11-Jan-89 01:00 PM
       GNS-FIO-TAB-VSM SECTION.
       INI-GNS-FIO-TAB-VSM.
           MOVE 194    TO FIO-RLEN.
           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE TAB-COD-TABL IN TAB TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTAB' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
      *JSS     MOVE 'TAB' TO FIO-FNAM
               MOVE IFD-GSIS(1) TO FIO-FNAM
      *
               MOVE 15     TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'TAB-CIC-TABL'
               MOVE TAB-CIC-TABL IN TAB TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA1' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA1' TO FIO-FNAM
               MOVE 15 TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'TAB-EXT-TABL'
               MOVE TAB-EXT-TABL IN TAB TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA2' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA2' TO FIO-FNAM
               MOVE 8 TO FIO-KLEN
           ELSE
               MOVE 'En GNS-FIO-TAB-VSM, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.

           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE TAB TO FIO-DFLD.
           PERFORM FIO.
           IF FIO-STAT-OKS AND FIO-IGET-YES
               MOVE FIO-BUF0 TO TAB.
           MOVE SPACES TO FIO-AKEY.
       FIN-GNS-FIO-TAB-VSM.
           EXIT.

      * Modulo FIO para registro TAB en DATACOM
       GNS-FIO-TAB-DTC SECTION.
       INI-GNS-FIO-TAB-DTC.
           MOVE ADR-TAB-REQA TO ADR-REQA.
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.
      *JSS MOVE IFD-GSIS( 1 ) TO ADR-DBID IN ADR-REQA.
           MOVE FIO-SIST TO IFD-SAUX.
           MOVE 'C'      TO IFD-QAUX.
           MOVE 1 TO IFD-IAUX.
           SET IFD-ITBL TO 1.
           SEARCH IFD-VSIS VARYING IFD-IAUX
               AT END
                   MOVE 'Sistema Invalido en GNS-FIO-TAB-DTC'
                                                          TO FIO-MEN1
                   MOVE IFD-DAUX                          TO FIO-MEN2
                   GO TO PRG-ABT
               WHEN IFD-DSIS( IFD-ITBL ) = IFD-DAUX
                   MOVE IFD-GSIS( IFD-ITBL) TO ADR-DBID IN ADR-REQA.
      *
           MOVE 'TAB00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'TAB-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE TAB-COD-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-STP-ITRN'
               MOVE TAB-STP-ITRN IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-CIC-TABL'
               MOVE TAB-CIC-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'TAB-EXT-TABL'
               MOVE TAB-EXT-TABL IN TAB TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En GNS-FIO-TAB-DTC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               GO TO PRG-ABT.
      *JSS
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB
                                           TAB-EXT-TTAB IN TAB
                                           TAB-SNX-TTAB IN TAB.
      *
           MOVE TAB TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO TAB
           ELSE
      *JSS     MOVE 'GNSTAB' TO FIO-MEN2
               MOVE FIO-SIST TO FIO-MENS-SIS
               MOVE 'TAB'    TO FIO-MENS-REG
      *
               IF FIO-STAT-FTL
                   GO TO PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE ADR-REQA TO ADR-TAB-REQA.
       FIN-GNS-FIO-TAB-DTC.
           EXIT.
