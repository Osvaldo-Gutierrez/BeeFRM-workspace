*%! Codigo adicional para GNSPANVF Novedades
*% IF SETTAG
*% FNCPQ = "CVTWEB"
*% VSNPQ = "07.02.07"
*% FNCPU = "CVTWEB"
*% VSNPU =  "07.02.07"
*% END
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS
      *
      * Contexto rango de fechas
      *
      *   Pgm      PG1  PGS  PE   P*
      *   X        X         X          1era instancia pgm especifico
      *            X              X     1era instancia pgm cualquiera
      *   X             X    X          Sgte instancia pgm especifico
      *   X             X         X     Sgte instancia pgm cualquiera
      *
      *
      *
      * Flujo de busqueda y recorrido
      *
      *  Pgm *   Pgm E      PG1  PGS   CVP-KEY-IREG    CVP-STP-IPFF
      *                                AMB-Pgm+Ffoto   Fecha Foto
      * 1)---------------------------------------------------------
      *   X                  X                          X GET-NLS(R1)
      *                                X FND-KEY-GKEY
      *                                                 X GET-NXT-CICLO
      *
      * 2)--------------------------------------------------------
      *   X                       X    X FND-KEY-GKEY(ANT)
      *                                                X GET-NXT-PTR
      *                                                X GET-NXT-CICLO
      * 3)--------------------------------------------------------
      *           X          X         X GET-NLS(R1)
      *                                X FND-KEY-GKEY
      *                                X GET-NXT-CICLO
      *
      * 4)-------------------------------------------------------
      *           X               X    X FND-KEY-GKEY(ANT)
      *                                X GET-NXT-PTR
      *                                X GET-NXT-CICLO
      *
      *
      *OLD 77  WSS-FUNC-VIG       VALUE SPACES        PIC X(12).
      *OLD 77  WSS-PROG-VIG       VALUE SPACES        PIC X(12).
       01  WSS-CVP-BKP        VALUE SPACES        PIC X(500).
      
       01  WSS-STP-FMDE.
           03  WSS-FEC-FMDE.
               05  WSS-NUM-SMDE                   PIC X(02).
               05  WSS-NUM-AMDE                   PIC X(02).
               05  WSS-NUM-MMDE                   PIC X(02).
               05  WSS-NUM-DMDE                   PIC X(02).
           03  WSS-HRA-HMDE                       PIC X(06).
      
       01  WSS-STP-FMHA.
           03  WSS-FEC-FMHA.
               05  WSS-NUM-SMHA                   PIC X(02).
               05  WSS-NUM-AMHA                   PIC X(02).
               05  WSS-NUM-MMHA                   PIC X(02).
               05  WSS-NUM-DMHA                   PIC X(02).
           03  WSS-HRA-HMHA                       PIC X(06).
      
      *Entidades de GNS
       77  WSS-AKEY           VALUE SPACES        PIC X(32).
       COPY GNSWGNVF.
       01  WSS-FEC-FDMA.
           03  WSS-NUM-DDMA                       PIC X(02).
           03  WSS-NUM-MDMA                       PIC X(02).
           03  WSS-NUM-SDMA                       PIC X(02).
           03  WSS-NUM-ADMA                       PIC X(02).
      
       01  WSS-FEC-FAMD.
           03  WSS-NUM-SAMD                       PIC X(02).
           03  WSS-NUM-AAMD                       PIC X(02).
           03  WSS-NUM-MAMD                       PIC X(02).
           03  WSS-NUM-DAMD                       PIC X(02).
           03  WSS-HRA-HAMD                       PIC X(06).
      
       01  WSS-STP-FAMP.
           03  WSS-FEC-FAMP.
               05  WSS-NUM-SAMP                   PIC X(02).
               05  WSS-NUM-AAMP                   PIC X(02).
               05  WSS-NUM-MAMP                   PIC X(02).
               05  WSS-NUM-DAMP                   PIC X(02).
           03  WSS-HRA-HAMP                       PIC X(06).
      
       01  WSS-STP-FDES.
           03  WSS-FEC-FDES.
               05  WSS-NUM-SDES                   PIC X(02).
               05  WSS-NUM-ADES                   PIC X(02).
               05  WSS-NUM-MDES                   PIC X(02).
               05  WSS-NUM-DDES                   PIC X(02).
           03  WSS-HRA-HDES                       PIC X(06).
      
       01  WSS-STP-FHAS.
           03  WSS-FEC-FHAS.
               05  WSS-NUM-SHAS                   PIC X(02).
               05  WSS-NUM-AHAS                   PIC X(02).
               05  WSS-NUM-MHAS                   PIC X(02).
               05  WSS-NUM-DHAS                   PIC X(02).
           03  WSS-HRA-HHAS                       PIC X(06).
      
       77  WSS-COD-TTAB                PIC X(03).
       77  WSS-COD-SIST                PIC X(03).
       77  WSS-COD-CTAB-L11            PIC X(11).
       77  WSS-COD-CTAB-L11-CMP        PIC X(11).
       77  IMP-GLOSA-VDT               PIC 9(04).
       77  IMP-GLOSA-FDC               PIC 9(04).
      
      *>>>> WSS
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CVM-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE TSK-TERM-ALF    TO TS-IF1-TERM-OCC.
           MOVE 'PRU1'          TO TS-IF1-TERM-OCC.
      
           MOVE TS-IF1-COLA-OCC TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
           MOVE 'CVPNLS' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'TSIF1' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'CVPKEY1' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP01' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP02' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP03' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP04' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP05' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP06' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP07' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PROCVP08' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
      
           MOVE 'CVPKEY' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'CVPKEYSK' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'CVPCVP' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'CVPCVPSC' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
      
           MOVE 'FDC3' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'VDT1' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'VDT2' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'VDT3' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'VDT3' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'PRU1OVDP' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      *>>>> INI_FIO
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE FRM-NUM-DHAS IN NVF-FLD TO WSS-NUM-DMHA.
           MOVE FRM-NUM-MHAS IN NVF-FLD TO WSS-NUM-MMHA.
           MOVE FRM-NUM-SHAS IN NVF-FLD TO WSS-NUM-SMHA.
           MOVE FRM-NUM-AHAS IN NVF-FLD TO WSS-NUM-AMHA.
           MOVE FRM-HRA-HHAS IN NVF-FLD TO WSS-HRA-HMHA.
      
           MOVE FRM-NUM-DDES IN NVF-FLD TO WSS-NUM-DMDE.
           MOVE FRM-NUM-MDES IN NVF-FLD TO WSS-NUM-MMDE.
           MOVE FRM-NUM-SDES IN NVF-FLD TO WSS-NUM-SMDE.
           MOVE FRM-NUM-ADES IN NVF-FLD TO WSS-NUM-AMDE.
           MOVE FRM-HRA-HDES IN NVF-FLD TO WSS-HRA-HMDE.
      
           MOVE CVP-COD-PAMB IN NVF-FLD TO CVP-COD-NAMB IN CVP.
           MOVE CVP-COD-PFNC IN NVF-FLD TO CVP-COD-NFNC IN CVP.
           MOVE CVP-COD-PROG IN NVF-FLD TO CVP-COD-NPRG IN CVP.
      
           IF FRM-FEC-FDES IN NVF-FLD > ZEROES  AND
              FRM-FEC-FHAS IN NVF-FLD > ZEROES
               MOVE FRM-NUM-SDES IN NVF-FLD TO CVP-NUM-SNFF IN CVP
               MOVE FRM-NUM-ADES IN NVF-FLD TO CVP-NUM-ANFF IN CVP
               MOVE FRM-NUM-MDES IN NVF-FLD TO CVP-NUM-MNFF IN CVP
               MOVE FRM-NUM-DDES IN NVF-FLD TO CVP-NUM-DNFF IN CVP
               MOVE FRM-HRA-HDES IN NVF-FLD TO CVP-HRA-HNHF IN CVP
           ELSE
               MOVE ZEROES                  TO CVP-FEC-FNFF IN CVP
               MOVE ZEROES                  TO CVP-HRA-HNHF IN CVP
           END-IF.
      
      * VALIDA
      *OLD MOVE CVP-COD-PFNC IN NVF-FLD     TO WSS-FUNC-VIG.
      
           IF SCR-CMND = 'IFN'
               MOVE FRM-NUM-DDES IN NVF-FLD TO CVP-NUM-DNFF IN CVP
               MOVE FRM-NUM-MDES IN NVF-FLD TO CVP-NUM-MNFF IN CVP
               MOVE FRM-NUM-SDES IN NVF-FLD TO CVP-NUM-SNFF IN CVP
               MOVE FRM-NUM-ADES IN NVF-FLD TO CVP-NUM-ANFF IN CVP
               MOVE FRM-HRA-HDES IN NVF-FLD TO CVP-HRA-HNHF IN CVP.
      
           MOVE 'CVPKEY4'       TO QUE-COLA.
           MOVE CVP-KEY-NFNC    TO QUE-ITEM.
           MOVE +41             TO QUE-LITM.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           IF SCR-CMND = 'IF1' OR
              SCR-CMND = 'IFN'
               MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY
               MOVE FIO-GET-NLS     TO FIO-CMND
               PERFORM GNS-FIO-CVP
               MOVE FIO-STAT TO PGM-STAT-CVP
               IF NOT FIO-STAT-OKS
                   GO TO FIN-FND-KEY
               ELSE
               IF SCR-CMND = 'IF1'
                    MOVE CVP-COD-NPRG IN CVP TO 
                         CVP-COD-PROG IN NVF-FLD
               ELSE
               IF SCR-CMND = 'IFN'
                  MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY
                  MOVE FIO-GET-NXT     TO FIO-CMND
                  PERFORM GNS-FIO-CVP
                  MOVE FIO-STAT TO PGM-STAT-CVP
                  IF FIO-STAT-OKS
                    MOVE CVP-COD-NPRG IN CVP TO 
                         CVP-COD-PROG IN NVF-FLD
                  ELSE
                      GO TO FIN-FND-KEY.
      
           MOVE 'CVPNLS'            TO QUE-COLA.
           MOVE CVP-KEY-NFNC        TO QUE-ITEM.
           MOVE +41                 TO QUE-LITM.
           MOVE QUE-PUT             TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           IF SCR-CMND = 'IF1' OR
              SCR-CMND = 'IFN'
                GO TO CIC-NVF.
      
      *>>>> FND_KEY
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           MOVE CVP TO WSS-CVP-BKP.
           MOVE 'CVPKEY'       TO QUE-COLA.
           MOVE CVP            TO QUE-ITEM.
           MOVE +400           TO  QUE-LITM.
           MOVE QUE-PUT        TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'CVPKEYSK'     TO QUE-COLA.
           MOVE FIO-STAT       TO QUE-ITEM.
           MOVE +4             TO QUE-LITM.
           MOVE QUE-PUT        TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
       CIC-NVF.
      
           IF NOT PGM-STAT-CVP-OKS
               GO TO FIN-FND-KEY.
      
      *OLD MOVE CVP-COD-NPRG IN CVP  TO WSS-PROG-VIG.
      
           IF SCR-CMND = 'IF1' OR
              SCR-CMND = 'IFN'
               PERFORM PRO-CVP
           ELSE
      *   PTR ( POINTER )
           IF SCR-CMND = 'IFN'
               MOVE 'CVP-KEY-NFNC' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM GNS-FIO-CVP
               MOVE FIO-STAT       TO PGM-STAT-CVP
               MOVE CVP            TO WSS-CVP-BKP
               PERFORM PRO-CVP.
      
           MOVE WSS-CVP-BKP TO CVP.
      *>>>> FIN_FND_KEY
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
      *>>>> CMN_ING
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *>>>> FIN_CMN_ING
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      *>>>> CMN_MOD_RET
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
      *>>>> CMN_ACC
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      
      *>>>> EOF_PQ
*% END
*% IF EOF
      *<<<< EOF
      *PRO
       PRO-CVP SECTION.
       INI-PRO-CVP.
      
       CIC-PRO-CVP.
           MOVE SPACES          TO TS-IF1-OCC.
      
           MOVE 'PROCVP01'      TO QUE-COLA.
           MOVE CVP-KEY-NFNC    TO QUE-ITEM.
           MOVE +41             TO QUE-LITM.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           IF NOT FIO-STAT-OKS
              GO TO FIN-PRO-CVP.
      
           IF SCR-CMND = 'IF1' OR
              SCR-CMND = 'IFN'
           IF CVP-COD-PAMB IN NVF-FLD NOT = CVP-COD-NAMB IN CVP OR
              CVP-COD-PFNC IN NVF-FLD NOT = CVP-COD-NFNC IN CVP
              GO TO FIN-PRO-CVP.
      
           MOVE 'PROCVP02'      TO QUE-COLA
           MOVE CVP-KEY-NFNC    TO QUE-ITEM
           MOVE +41             TO QUE-LITM
           MOVE QUE-PUT         TO QUE-CMND
           PERFORM GNX-PRO-QUE
      
      
      *    PERFORM BUS-ULT-RNG-FRM.
      
      *    MOVE 'PROCVP04'      TO QUE-COLA.
      *    MOVE CVP             TO QUE-ITEM.
      *    MOVE +400            TO  QUE-LITM.
      *    MOVE QUE-PUT TO QUE-CMND.
      *    PERFORM GNX-PRO-QUE.
      
      *    MOVE CVP-FEC-FNFF IN CVP   TO WSS-FEC-FAMP.
      *    MOVE CVP-HRA-HNHF IN CVP   TO WSS-HRA-HAMP.
      *    IF WSS-STP-FAMP NOT < WSS-STP-FMDE AND
      *       WSS-STP-FAMP NOT > WSS-STP-FMHA
      * ENCONTRAMOS EN RANGO DE FECHA
      *       MOVE 'PROCVP03'        TO QUE-COLA
      *       MOVE CVP             TO QUE-ITEM
      *       MOVE +400            TO  QUE-LITM
      *       MOVE QUE-PUT TO QUE-CMND
      *       PERFORM GNX-PRO-QUE
      
      *    MOVE 'PROCVP06'      TO QUE-COLA
      *    MOVE CVP             TO QUE-ITEM
      *    MOVE +400            TO  QUE-LITM
      *    MOVE QUE-PUT TO QUE-CMND
      *    PERFORM GNX-PRO-QUE
      
           PERFORM BUS-ULT-RNG-FIS.
           PERFORM GRABA-TS.
           IF TS-IF1-IDX-OCC > TS-IF1-TOT-OCC
              GO TO FIN-PRO-CVP.
      
      * GRABAR TS---------------------------------
           MOVE 'TSIF1'      TO QUE-COLA
           MOVE CVP-KEY-NFNC    TO QUE-ITEM
           MOVE +41             TO  QUE-LITM
           MOVE QUE-PUT TO QUE-CMND
           PERFORM GNX-PRO-QUE
      
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'CVP-KEY-NFNC' TO FIO-AKEY.
           PERFORM GNS-FIO-CVP.
      
           IF NOT FIO-STAT-OKS
              GO TO FIN-PRO-CVP.
      
      *OLD MOVE CVP-COD-NPRG IN CVP TO WSS-PROG-VIG.
      
           MOVE 'PROCVP04'      TO QUE-COLA.
           MOVE CVP-KEY-NFNC    TO QUE-ITEM.
           MOVE +41             TO  QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      *    IF CVP-COD-PFNC IN NVF-FLD NOT = CVP-COD-NFNC IN CVP OR
      *       CVP-COD-PAMB IN NVF-FLD NOT = CVP-COD-NAMB IN CVP
      *       GO TO FIN-PRO-CVP.
      
           MOVE CVP-COD-NPRG IN CVP TO CVP-COD-PROG IN NVF-FLD.

           GO TO CIC-PRO-CVP.
      
       FIN-PRO-CVP.
           EXIT.
      
       GRABA-TS SECTION.
       INI-GRABA-TS.
      
           ADD 1              TO TS-IF1-IDX-OCC.
           IF TS-IF1-IDX-OCC > TS-IF1-TOT-OCC
              MOVE 'S' TO FRM-COD-HMAS IN NVF-FLD
              GO TO FIN-GRABA-TS.
      
           MOVE 'N' TO FRM-COD-HMAS IN NVF-FLD.
           MOVE TS-IF1-IDX-OCC TO FRM-NUM-TOCC IN NVF-FLD.
      
           MOVE CVP-COD-NPRG IN CVP TO TS-IF1-CVP-COD-PROG.
           MOVE CVP-COD-ESQL IN CVP TO TS-IF1-CVP-COD-ESQL.
           MOVE CVP-COD-PLEN IN CVP TO TS-IF1-CVP-COD-PLEN.
           MOVE CVP-COD-PGEN IN CVP TO TS-IF1-CVP-COD-PGEN.
      
           MOVE CVP-NUM-DREV IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MREV IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SREV IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-AREV IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-IF1-CVP-FEC-FREV.
      
           MOVE CVP-HRA-HREV IN CVP TO TS-IF1-CVP-HRA-HREV.
           MOVE CVP-COD-PVGM IN CVP TO TS-IF1-CVP-COD-PVGM.
      
           MOVE CVP-NUM-DPFF IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MPFF IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SPFF IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-APFF IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-IF1-CVP-FEC-FPFF.
      
           MOVE CVP-HRA-HPHF IN CVP TO TS-IF1-CVP-HRA-HPHF.
           MOVE CVP-COD-CVCA IN CVP TO TS-IF1-CVP-COD-CVCA.
      
           MOVE CVP-NUM-DCPL IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MCPL IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SCPL IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-ACPL IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-IF1-CVP-FEC-FCPL.
      
           MOVE CVP-HRA-HRCP IN CVP TO TS-IF1-CVP-HRA-HRCP.
           PERFORM BUS-GLS-PMOD.
           MOVE CVP-COD-PMOD IN CVP TO TS-IF1-CVP-COD-PMOD.
      *    MOVE FRM-GLS-PMOD IN NVF-FLD
      *                             TO TS-IF1-FRM-GLS-PMOD.
      
           MOVE CVP-NUM-DCSG IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MCSG IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SCSG IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-ACSG IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-IF1-CVP-FEC-FCSG.
      
           MOVE CVP-COD-PVSN IN CVP TO TS-IF1-CVP-COD-PVSN
           MOVE CVP-HRA-HCSG IN CVP TO TS-IF1-CVP-HRA-HCSG.
           MOVE CVP-COD-PUSR IN CVP TO TS-IF1-CVP-COD-PUSR.
           MOVE CVP-COD-UCVT IN CVP TO TS-IF1-CVP-COD-UCVT.
           PERFORM BUS-GLS-UCVT.
      
      *    MOVE FRM-GLS-UCVT IN NVF-FLD
      *                             TO TS-IF1-FRM-GLS-UCVT.
           PERFORM BUS-GLS-PUSR.
      *    MOVE FRM-GLS-PUSR IN NVF-FLD
      *                             TO TS-IF1-FRM-GLS-PUSR.
           MOVE CVP-COD-NFNC IN CVP TO TS-IF1-FRM-COD-PFN1.
           PERFORM BUS-GLS-FDC
      
           MOVE CVP-COD-PVDT IN CVP TO TS-IF1-CVP-COD-PVDT.
      
           PERFORM BUS-GLS-VDT.
      
           MOVE TS-IF1-COLA-OCC TO QUE-COLA.
           MOVE TS-IF1-LITM-OCC TO QUE-LITM.
           MOVE TS-IF1-OCC      TO QUE-ITEM.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
      *    MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY.
      *    MOVE FIO-GET-NXT     TO FIO-CMND.
      *    PERFORM GNS-FIO-CVP.
      *    MOVE FIO-STAT        TO PGM-STAT-CVP
      *    IF FIO-STAT-OKS
      *       GO TO CIC-PRO-CVP
      *    END-IF
      
           MOVE 'CVPCVP'        TO QUE-COLA.
           MOVE CVP             TO QUE-ITEM.
           MOVE +400            TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'CVPCVPSC'      TO QUE-COLA.
           MOVE FIO-STAT        TO QUE-ITEM.
           MOVE +4              TO QUE-LITM.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
       FIN-GRABA-TS.
           EXIT.
      
       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
      *     IF SCR-OFRM-SRV
                PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.
      
       BUS-GLS-FDC SECTION.
       INI-BUS-GLS-FDC.
      
           MOVE 'GNS' TO FIO-SIST.
           MOVE 'FDC'               TO WSS-COD-TTAB.
           MOVE WSS-COD-TTAB        TO TAB-COD-TTAB IN TAB.
      
           MOVE CVP-COD-PFNC IN CVP TO WSS-COD-CTAB-L11.
           MOVE WSS-COD-CTAB-L11    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS         TO FIO-CMND.
      
           MOVE ZEROES              TO IMP-GLOSA-FDC.
      
       CIC-BUS-GLS-FDC.
      
           PERFORM GNS-FIO-TAB.
      
           IF FIO-STAT-OKS
      
              MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB-L11-CMP
      
              IF TAB-COD-TTAB IN TAB = WSS-COD-TTAB AND
                 WSS-COD-CTAB-L11 = WSS-COD-CTAB-L11-CMP
                 ADD 1 TO IMP-GLOSA-FDC
                 IF IMP-GLOSA-FDC > 3
                       GO TO FIN-BUS-GLS-FDC
                 ELSE
                 IF IMP-GLOSA-FDC = 1
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PFN1
                     MOVE FRM-GLS-PFN1 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PFN1
      
                     MOVE TAB-GLS-DATA IN TAB TO
                          FRM-GLS-PFN2
                     MOVE FRM-GLS-PFN2 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PFN2
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO CIC-BUS-GLS-FDC
                 ELSE
                 IF IMP-GLOSA-FDC = 2
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PFN3
                     MOVE FRM-GLS-PFN3 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PFN3
      
                     MOVE TAB-GLS-DATA IN TAB TO
                          FRM-GLS-PFN4
                     MOVE FRM-GLS-PFN4 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PFN4
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO CIC-BUS-GLS-FDC
                 ELSE
                 IF IMP-GLOSA-FDC = 3
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PFN5
                     MOVE FRM-GLS-PFN5 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PFN5
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO CIC-BUS-GLS-FDC.
       FIN-BUS-GLS-FDC.
           EXIT.
      
       BUS-GLS-VDT SECTION.
       INI-BUS-GLS-VDT.
      
           MOVE 'VDT'              TO WSS-COD-TTAB.
           MOVE WSS-COD-TTAB       TO TAB-COD-TTAB IN TAB.
           MOVE CVP-COD-PROG IN CVP TO WSS-COD-SIST.
           MOVE WSS-COD-SIST TO FIO-SIST.
      
           MOVE CVP-COD-PVDT IN CVP TO WSS-COD-CTAB-L11.
           MOVE WSS-COD-CTAB-L11   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS        TO FIO-CMND.
      
           MOVE ZEROES             TO IMP-GLOSA-VDT.
      
       CIC-BUS-GLS-VDT.
           PERFORM GNS-FIO-TAB.
      
      
           MOVE 'VDT1' TO QUE-COLA.
           MOVE TAB-COD-CTAB IN TAB TO QUE-ITEM
           MOVE +15 TO  QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'VDT2' TO QUE-COLA.
           MOVE CVP-COD-PVDT IN CVP TO QUE-ITEM
           MOVE +15 TO  QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           MOVE 'TAB2' TO QUE-COLA.
           MOVE TAB                 TO QUE-ITEM
           MOVE +194 TO  QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
           IF NOT FIO-STAT-OKS
              GO TO FIN-BUS-GLS-VDT.
      
              MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB-L11-CMP
      
              IF TAB-COD-TTAB IN TAB = WSS-COD-TTAB AND
                 WSS-COD-CTAB-L11 = WSS-COD-CTAB-L11-CMP
                 ADD 1 TO IMP-GLOSA-VDT
                 IF IMP-GLOSA-VDT > 3
                       GO TO FIN-BUS-GLS-VDT
                 ELSE
                 IF IMP-GLOSA-VDT = 1
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PVD1
                     MOVE FRM-GLS-PVD1 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PVD1
      
                     MOVE TAB-GLS-DATA IN TAB TO
                          FRM-GLS-PVD2
                     MOVE FRM-GLS-PVD2 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PVD2
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO CIC-BUS-GLS-VDT
                 ELSE
                 IF IMP-GLOSA-VDT = 2
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PVD3
                     MOVE FRM-GLS-PVD3 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PVD3
      
                     MOVE TAB-GLS-DATA IN TAB TO
                          FRM-GLS-PVD4
                     MOVE FRM-GLS-PVD4 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PVD4
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO CIC-BUS-GLS-VDT
                 ELSE
                 IF IMP-GLOSA-VDT = 3
                     MOVE TAB-GLS-DESC IN TAB TO
                          FRM-GLS-PVD5
                     MOVE FRM-GLS-PVD5 IN NVF-FLD TO
                   TS-IF1-FRM-GLS-PVD5
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO CIC-BUS-GLS-VDT.
       FIN-BUS-GLS-VDT.
           EXIT.
      
       BUS-GLS-PMOD SECTION.
       INI-BUS-GLS-PMOD.
      
           IF CVP-COD-PMOD IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'MDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-PMOD IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-IF1-FRM-GLS-PMOD
           ELSE
              MOVE 'MODALIDAD NO REGISTRADA'
                                        TO TS-IF1-FRM-GLS-PMOD.
      
       FIN-BUS-GLS-PMOD.
           EXIT.
      
       BUS-GLS-UCVT SECTION.
       INI-BUS-GLS-UCVT.
      
           IF CVP-COD-UCVT IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'UDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-UCVT IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-IF1-FRM-GLS-UCVT
           ELSE
               MOVE 'USUARIO NO REGISTRADO'
                                        TO TS-IF1-FRM-GLS-UCVT.
      
       FIN-BUS-GLS-UCVT.
           EXIT.
      
       BUS-GLS-PUSR SECTION.
       INI-BUS-GLS-PUSR.
      
           IF CVP-COD-PUSR IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'UDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-PUSR IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-IF1-FRM-GLS-PUSR
           ELSE
              MOVE 'USUARIO NO REGISTRADO'
                                        TO TS-IF1-FRM-GLS-PUSR.
      
       FIN-BUS-GLS-PUSR.
           EXIT.
      
       BUS-ULT-RNG-FIS SECTION.
       INI-BUS-ULT-RNG-FIS.
      *    MOVE CVP-COD-PAMB IN NVF-FLD TO CVP-COD-NAMB IN CVP.
      *    MOVE CVP-COD-PFNC IN NVF-FLD TO CVP-COD-NFNC IN CVP.
      *OLD MOVE WSS-PROG-VIG            TO CVP-COD-NPRG IN CVP.
           MOVE CVP-COD-PROG IN NVF-FLD TO CVP-COD-NPRG IN CVP.
           MOVE '99999999'              TO CVP-FEC-FNFF IN CVP.
           MOVE '999999'                TO CVP-HRA-HNHF IN CVP.
           MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GNS-FIO-CVP.
      *   GRABAR Y LEE OTRO
           MOVE 'PROCVP03'      TO QUE-COLA.
           MOVE CVP-KEY-NFNC    TO QUE-ITEM.
           MOVE +41             TO  QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      *    MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY.
      *    MOVE FIO-GET-NXT TO FIO-CMND.
      *    PERFORM GNS-FIO-CVP.
      *    MOVE 'PROCVP04'      TO QUE-COLA.
      *    MOVE CVP             TO QUE-ITEM.
      *    MOVE +400            TO  QUE-LITM.
      *    MOVE QUE-PUT TO QUE-CMND.
      *    PERFORM GNX-PRO-QUE.
      
       FIN-BUS-ULT-RNG-FIS.
           EXIT.
      
      
       BUS-ULT-RNG-FRM SECTION.
       INI-BUS-ULT-RNG-FRM.
           MOVE CVP-COD-PAMB IN NVF-FLD TO CVP-COD-NAMB IN CVP.
           MOVE CVP-COD-PFNC IN NVF-FLD TO CVP-COD-NFNC IN CVP.
      *OLD MOVE WSS-PROG-VIG            TO CVP-COD-NPRG IN CVP.
           MOVE CVP-COD-PFNC IN NVF-FLD TO CVP-COD-NPRG IN CVP.
           MOVE ZEROES                  TO CVP-FEC-FNFF IN CVP.
           MOVE ZEROES                  TO CVP-HRA-HNHF IN CVP.
           MOVE 'CVP-KEY-NFNC'  TO FIO-AKEY
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM GNS-FIO-CVP.
      
       FIN-BUS-ULT-RNG-FRM.
           EXIT.
      
      *>>>> EOF
*% END
