*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% HDR_CST = FALSE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF WSS
      *<<<< WSS
       77  WSS-IDN-TPG                     PIC X(01).
       COPY GNSWGTDI.
*% IF NOT PGM_VMS AND NOT PGM_MCP
       COPY GNSWGQUE.
      *>>>>
*% END
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWGTSK.
       01  WSS-TDI VALUE SPACES.
      *RRM-INI 4-MAR-2002
      *       05 WSS-FRM-GLS-HD01            PIC  X(64).
      *RRM-FIN 4-MAR-2002
              05 WSS-FRM-GLS-FL01            PIC  X(64).
              05 WSS-FRM-GLS-FL02            PIC  X(64).
              05 WSS-FRM-GLS-FL03            PIC  X(64).
              05 WSS-FRM-GLS-FL04            PIC  X(64).
              05 WSS-FRM-GLS-FL05            PIC  X(64).
              05 WSS-FRM-GLS-FL06            PIC  X(64).
              05 WSS-FRM-GLS-FL07            PIC  X(64).
              05 WSS-FRM-GLS-FL08            PIC  X(64).
              05 WSS-FRM-GLS-FL09            PIC  X(64).
              05 WSS-FRM-GLS-FL10            PIC  X(64).
              05 WSS-FRM-GLS-FL11            PIC  X(64).
              05 WSS-FRM-GLS-FL12            PIC  X(64).
              05 WSS-FRM-GLS-FL13            PIC  X(64).
              05 WSS-FRM-GLS-FL14            PIC  X(64).
              05 WSS-FRM-GLS-FL15            PIC  X(64).
              05 WSS-FRM-GLS-FL16            PIC  X(64).
              05 WSS-FRM-GLS-FL17            PIC  X(64).
      *>>>> WSS
*% END
*% IF INI_FIO
*% IF NOT PGM_VMS AND NOT PGM_MCP
      *     PERFORM GNS-ERR-TDQ.
           PERFORM GNS-ERR-QUE.
*% END
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      *RRM-INI 1-MAR-2002 IGUALACIONDE CODIGO
      *    IF FRM-COD-IKEY IN TDI-FLD = 'TDV'
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM GNS-FIO-TDV
      *        MOVE FIO-STAT TO PGM-STAT-TDI
      *        GO TO FIN-FND-KEY.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
      *RRM-INI 1-MAR-2002 IGUALACION DE CODIGO
      *    IF FRM-COD-IKEY IN TDI-FLD = 'TDV'
      *        MOVE FIO-PUT TO FIO-CMND
      *        PERFORM GNS-FIO-TDV
      *        MOVE FIO-STAT TO PGM-STAT-TDI
      *        GO TO FIN-CMN-ING.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>> CMN_ING
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM KEY-ALL-TDI.
      *RRM-INI 1-MAR-2002 IGUALACIONDE CODIGO
      *    IF FRM-COD-IUPD IN TDI-FLD = 'TDV'
      *        MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *        PERFORM GNS-FIO-TDV
      *        MOVE FIO-STAT TO PGM-STAT-TDI
      *        IF NOT FIO-STAT-OKS
      *            GO TO FIN-CMN-MOD
      *        ELSE
      *            GO TO REG-LEIDO.
      *RRM-INI 1-MAR-2002 IGUALACION DE CODIGO
      *>>>> INI_CMN_MOD
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
       REG-LEIDO.
      *>>>>
*% END
*% IF CMN_MOD 
      *<<<< CMN_MOD
      *RRM-INI 1-MAR-2002 IGUALACIONDE CODIGO
      *    IF FRM-COD-IMOD IN TDI-FLD = 'TDV'
      *        IF FRM-COD-IUPD = 'TDV'
      *             MOVE FIO-MOD TO FIO-CMND
      *             PERFORM GNS-FIO-TDV
      *             GO TO FIN-CMN-MOD
      *        ELSE
      *             MOVE FIO-PUT TO FIO-CMND
      *             IF FRM-NUM-CORR IN TDI-FLD > ZEROES
      *                  MOVE FRM-NUM-CORR IN TDI-FLD TO
      *                       TDI-NUM-RECO IN TDI 
      *                  PERFORM GNS-FIO-TDV
      *                  GO TO FIN-CMN-MOD
      *             ELSE
      *                  PERFORM GNS-FIO-TDV
      *                  GO TO FIN-CMN-MOD
      *    ELSE
      *         IF FRM-COD-IUPD = 'TDV'
      *             MOVE FIO-PUT TO FIO-CMND
      *             PERFORM GNS-FIO-TDI
      *             GO TO FIN-CMN-MOD.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>>
*% END
*% IF FIN_CMN_MOD 
      *<<<< FIN_CMN_MOD
      *RRM-INI 1-MAR-2002 IGUALACION DE CODIGO
           IF SCR-CMND = 'MYA'
              PERFORM LNK-TPG
              MOVE 'TO' TO QUE-COLA
              MOVE +3500 TO QUE-LITM
              MOVE 1 TO QUE-NITM
              MOVE QUE-GET TO QUE-CMND
              PERFORM GNS-PRO-QUE
              IF QUE-STAT = QUE-STAT-OKS
                 MOVE QUE-ITEM TO WSS-TDI
           MOVE WSS-FRM-GLS-FL01 TO FRM-GLS-FL01
           MOVE WSS-FRM-GLS-FL02 TO FRM-GLS-FL02
           MOVE WSS-FRM-GLS-FL03 TO FRM-GLS-FL03
           MOVE WSS-FRM-GLS-FL04 TO FRM-GLS-FL04
           MOVE WSS-FRM-GLS-FL05 TO FRM-GLS-FL05
           MOVE WSS-FRM-GLS-FL06 TO FRM-GLS-FL06
           MOVE WSS-FRM-GLS-FL07 TO FRM-GLS-FL07
           MOVE WSS-FRM-GLS-FL08 TO FRM-GLS-FL08
           MOVE WSS-FRM-GLS-FL09 TO FRM-GLS-FL09
           MOVE WSS-FRM-GLS-FL10 TO FRM-GLS-FL10
           MOVE WSS-FRM-GLS-FL11 TO FRM-GLS-FL11
           MOVE WSS-FRM-GLS-FL12 TO FRM-GLS-FL12
           MOVE WSS-FRM-GLS-FL13 TO FRM-GLS-FL13
           MOVE WSS-FRM-GLS-FL14 TO FRM-GLS-FL14
           MOVE WSS-FRM-GLS-FL15 TO FRM-GLS-FL15
           MOVE WSS-FRM-GLS-FL16 TO FRM-GLS-FL16
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-TDI.
      *RRM-INI 1-MAR-2002 IGUALACION DE CODIGO
      *    IF FRM-COD-IKEY IN TDI-FLD = 'TDV'
      *        MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *        PERFORM GNS-FIO-TDV
      *        MOVE FIO-STAT TO PGM-STAT-TDI
      *        IF NOT FIO-STAT-OKS
      *            GO TO FIN-CMN-ELI
      *        ELSE
      *            GO TO LEI-DEL.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
       LEI-DEL.
      *RRM-INI 1-MAR-2002 IGUALACION DE CODIGO
      *    IF FRM-COD-IKEY IN TDI-FLD = 'TDV'
      *         MOVE FIO-DEL TO FIO-CMND
      *         PERFORM GNS-FIO-TDV
      *         GO TO FIN-CMN-ELI.
      *RRM-FIN 1-MAR-2002 IGUALACION DE CODIGO
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
       COPY GNSBGTSK.
*% IF PGM_MCP
       LNK-TPG SECTION.
       INI-LNK-TPG.

       FIN-LNK-TPG.
           EXIT.
*% ELSE
       COPY GNSBGQUE.
       LNK-TPG SECTION.
       INI-LNK-TPG.
           IF WSS-IDN-TPG = 'C' OR
              WSS-IDN-TPG = SPACES
              EXEC CICS LINK
                PROGRAM('COLPPTPG')
                COMMAREA (SYS-CMMA)
                LENGTH(+0)
              END-EXEC
           ELSE
           IF WSS-IDN-TPG = 'U'
              EXEC CICS LINK
                PROGRAM('DEUPPTPG')
                COMMAREA (SYS-CMMA)
                LENGTH(+0)
              END-EXEC
           ELSE
           IF WSS-IDN-TPG = 'D'
              EXEC CICS LINK
                PROGRAM('DAPPPTPG')
                COMMAREA (SYS-CMMA)
                LENGTH(+0)
              END-EXEC
           ELSE
           IF WSS-IDN-TPG = 'G'
              EXEC CICS LINK
                PROGRAM('GARPPTPG')
                COMMAREA (SYS-CMMA)
                LENGTH(+0)
              END-EXEC
           ELSE
           IF WSS-IDN-TPG = 'L'
              EXEC CICS LINK
                PROGRAM('LDCPPTPG')
                COMMAREA (SYS-CMMA)
                LENGTH(+0)
              END-EXEC.
       FIN-LNK-TPG.
           EXIT.
*% END
      *>>>>
*% END
