*%! Codigo adicional para programa
*% IF SETTAG
*% FNCPQ = "LOGMTI"
*% VSNPQ = "13.09.24"
*% FNCPU = "LOGMTI"
*% VSNPU =  "13.09.24"
*% END
*%! LA SIGUIENTE INSTRUCCION PERMITE NO INCLUIR LOS
*%! COPYS GNSBRTAB Y GNSBFTAB DEL ESQUELETO,
*%! PUES EL REGISTRO TAB ES EL ARCHIVO BASE
*%! NO_TIENE_TIMESTAMP = TRUE
*%! HDR_CST = FALSE
*% NO_INC_TAB = TRUE
*% FRM = "CLM"
*% PADRE = "TAB"
*% KEY_PADRE = "TAB-COD-TABL"
*% LARGO_KEY_PADRE = 15
*% FIO_PADRE = "SIS-FIO-TAB"
*% SIST_PADRE = "GNS"
*% KEY_BROWSE_PADRE = "TAB-COD-TABL"
*% ACEPTE_PF7 = TRUE
*% ACEPTE_PF8 = TRUE
*% ORG_PADRE_VSI = TRUE
*% INCLUDE 'GNSSRC:PFSCONENT.SRC'
*% PGM_PTC = TRUE
*% IF CMT_ID
      *<<<< CMT_ID
      *-----------------------------------------------------------------
      *  MODIFICACIONES:
      *  ---------------
      *  AUTOR      : KATHERINE ALARCON GIADACH
      *  ETIQUETA   : Cima-INI 02-OCT-2013 LOG MTI
      *  PROYECTO   : Log MTI
      *  OBJETIVO   : CONFIGURA TABLAS PARAMETROS LOG BATCH
      *-----------------------------------------------------------------
      *>>>> CMT_ID
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSMXW01.
       COPY GNSWGCLM.
       COPY GNSWGLGM.
      *>>>> WSS
*% END
*% IF PGM_PRE_EIB
      *<<<< PGM_PRE_EIB
           PERFORM CRG-CMMA-PRE.
*% IF PGM_PQ
           IF EIBCALEN = 0
               PERFORM CRG-CMMA
           ELSE
*% END
      *>>>> PGM_PRE_EIB
*% END
*% IF PGM_INI
      *<<<< PGM_INI
      *>>>> PGM_INI
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GET-TSK-TERM.
      * PTC-INI-AUT
      * PTC-FIN-AUT
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO SCR-SISG.
      *>>>> INI_FIO
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
           IF SCR-NEMO = SPACES
                MOVE FRM-CLR-FRM TO FRM-CMND
                PERFORM GNS-PRO-FRM
                GOBACK.
      *>>>> INI_SCR_COM
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND = 'CON'
                MOVE FIO-GET-NLS TO FIO-CMND
                PERFORM SIS-FIO-TAB
                MOVE FIO-STAT TO PGM-STAT-TAB
                GO TO FND-TAB-NLS.
      *>>>> FND_KEY
*% END
*% IF FND_KEY OR CMN_ING OR INI_CMN_MOD
      *<<<< FND_KEY OR CMN_ING OR INI_CMN_MOD
           MOVE SCR-SISG TO FIO-SIST.
      *>>>> FND_KEY OR CMN_ING OR INI_CMN_MOD
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       FND-TAB-NLS.
      *>>>> FIN_FND_KEY
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF TAB-FEC-FTRN IN TAB IS NOT NUMERIC
               MOVE ZEROES TO TAB-FEC-FTRN IN TAB.
      *>>>> PUT_SCR
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR
      *>>>> FIN_PUT_SCR
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
      *>>>> ABT_CMN_ACC
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
      *>>>> INI_CMN_ACC
*% END
*% IF INI_CMN_ELI OR INI_CMN_ACC OR CMN_PGM
      *<<<< INI_CMN_ELI OR INI_CMN_ACC OR CMN_PGM
           MOVE SCR-SISG TO FIO-SIST.
      *>>>> INI_CMN_ELI OR INI_CMN_ACC OR CMN_PGM
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO TAB-STP-ITRN IN TAB.
      *>>>> CMN_ING OR CMN_MOD
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SPACES TO TAB-GLS-FLAG IN TAB.
           MOVE ZEROES TO TAB-HRA-HRTR IN TAB.
           MOVE SPACES TO TAB-MSC-TACC IN TAB.
           MOVE SPACES TO TAB-COD-OTRN IN TAB.
           MOVE SPACES TO TAB-COD-ATRN IN TAB.
           MOVE SPACES TO TAB-SNX-TABL IN TAB.
      *>>>> CMN_ING
*% END
*% IF EOF
      *<<<< EOF
       CRG-CMMA-PRE SECTION.
       INI-CRG-CMMA-PRE.

           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           PERFORM GNS-ERR-QUE.

           MOVE 'GNSPQCLM'  TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI    TO SYS-CMMA.
           MOVE +507        TO SYS-TCMA.
           MOVE 'GNSPPIDD'  TO SYS-PROG.
           MOVE SYS-LINK    TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA    TO IDD-VARI.
       FIN-CRG-CMMA-PRE.
           EXIT.

       FIN-CRG-CMMA-PRE.
           EXIT.

      *PTC-INI:
      *PTC-FIN:
       SIS-FIO-TAB SECTION.
       INI-SIS-FIO-TAB.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       FIN-SIS-FIO-TAB.
           EXIT.

      *>>>> EOF
*% END
*% IF EOF_IBM
      *<<<< IF EOF_IBM
      *>>>>
*% END  EOF_IBM
*% IF EOF_PQ
      *<<<< EOF_PQ

       CRG-CMMA SECTION.
       INI-CRG-CMMA.

           MOVE 'GNS' TO FIO-SIST
                         TAB-COD-SIST.
           MOVE WSS-CLM-COD-TTAB-CAT     TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CLM-COD-TTAB-CAT-CLM TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-CRG-CMMA.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-COD-CTAB IN TAB TO WSS-CLM-COD-TTAB-CAT-CPR.
               
           IF FIO-STAT-OKS AND
              WSS-CLM-COD-TTAB-CAT     = TAB-COD-TTAB IN TAB
                              AND
              WSS-CLM-COD-TTAB-CAT-CPR = WSS-CLM-COD-TTAB-CAT-CLM
                 MOVE TAB-GLS-DESC IN TAB TO WSS-CLM-TAB-GLS-DESC
                 MOVE TAB-GLS-DATA IN TAB TO WSS-CLM-TAB-GLS-DATA
                 ADD WSS-CLM-CTE-1        TO WSS-CLM-SCR-VARI-IDX
                 MOVE WSS-CLM-TAB TO WSS-CLM-SCR-VARI-ELM IN
                      WSS-CLM-SCR-VARI ( WSS-CLM-SCR-VARI-IDX )
                 MOVE FIO-GET-NXT TO FIO-CMND
                 GO TO CIC-CRG-CMMA.

           MOVE WSS-CLM-SCR-VARI TO SCR-VARI.
           MOVE WSS-CLM-TCMA     TO SCR-TCMA.
           MOVE WSS-CLM-LIDD     TO SCR-LIDD.
           MOVE SPACES           TO SCR-NEMO.
           MOVE SCR-INST-GKY     TO SCR-INST.
          
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.


           PERFORM PRO-MKY-CLM.
           PERFORM PRO-AKY-CLM.
           PERFORM UNP-IKY-CLM.
           PERFORM FST-KEY-CLM.
           
           MOVE WSS-CLM-COD-TTAB-VDS TO TAB-COD-TTAB IN CLM-FLD.
           MOVE CLM-FLD       TO FRM-DFLD.
           MOVE FRM-SINI-DB1F TO FRM-SINI.
           MOVE FRM-INI       TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           
           PERFORM SCR-EXIT.              
              
       FIN-CRG-CMMA.
           EXIT.
      *>>>> EOF_PQ
*% END
*% IF EOF_PU
      *<<<< EOF_PU
      *>>>> EOF_PU
*% END
