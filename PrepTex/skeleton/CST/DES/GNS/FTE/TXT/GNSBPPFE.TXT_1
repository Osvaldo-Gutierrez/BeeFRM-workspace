       GNS-OBT-PFE SECTION.
       INI-GNS-OBT-PFE.
      *************************************************************
      * Obtiene Parametro fecha (GNSBPPFE)
      * Ojo: Deben estar abiertos los archivos: 
      *      - TAB de TAB
      *      - MSG de TAB
      *************************************************************
      * Datos de Entrada : PAR-GLS-TFEC, Tipo de Fecha :
      *                        FDES  : Fecha Desde
      *                        FHAS  : Fecha Hasta
      *                        FPRO  : Fecha Proceso
      *                    PAR-GLS-TPRO, Tipo de Proceso :
      *                        DIA   : Diario
      *                        MES   : Mensual
      *                        ANO   : Anual
      *                    PAR-COD-NPRO, Nombre Programa :
      *                        3 ultimas posiciones
      * Datos de Salida  : PAR-IND-ERRO, Indicador de ERROR:
      *                    PAR-FEC-FPRO, Fecha
      *************************************************************
      *
           MOVE ZEROES TO PAR-IND-ERRO IN PAR-VPFE.
      *
      *************************************************************
      * Obtiene fecha desde Tabla TAB-TFP, si no viene por SYSIN
      *************************************************************
      * Lee Tabla TFP para ver Fecha Especial para Programa
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'TFP'                    TO TAB-COD-TTAB IN TAB.
           MOVE PAR-GLS-TFEC IN PAR-VPFE TO PAR-COD-TFEC IN PAR-VPFE.
           MOVE PAR-COD-NPRO IN PAR-VPFE TO PAR-COD-TPRO IN PAR-VPFE.
           MOVE PAR-COD-CTAB IN PAR-VPFE TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
      *        Lee Tabla TFP para ver FPRO, FDES,FHAS.
               MOVE 'TAB'            TO TAB-COD-SIST
               MOVE 'TFP'            TO TAB-COD-TTAB IN TAB
      *         MOVE 'FPRO'           TO PAR-COD-TFEC IN PAR-VPFE
               MOVE PAR-GLS-TFEC IN PAR-VPFE TO PAR-COD-TFEC  IN PAR-VPFE
               MOVE PAR-GLS-TPRO IN PAR-VPFE TO PAR-COD-TPRO IN PAR-VPFE
               MOVE PAR-COD-CTAB IN PAR-VPFE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'TFP    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC ' ' TAB-COD-CTAB IN TAB
                   MOVE 1 TO PAR-IND-ERRO IN PAR-VPFE
               ELSE
                   MOVE TAB-GLS-DAT1 IN TAB TO PAR-GLS-DAT1 IN PAR-VPFE
           ELSE
               MOVE TAB-GLS-DAT1 IN TAB TO PAR-GLS-DAT1 IN PAR-VPFE.
       FIN-GNS-OBT-PFE.
           DISPLAY 'FECHA PARAMETRO : ' PAR-FEC-FPRO IN PAR-VPFE.
       EXT-GNS-OBT-PFE.
           EXIT.
