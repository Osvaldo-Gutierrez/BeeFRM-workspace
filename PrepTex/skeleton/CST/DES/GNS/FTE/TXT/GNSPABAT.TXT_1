*%! Codigo adicional para programa
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY TABBROFI.

       01  WSS-VARI.
           03 WSS-CMND                                  PIC 9(02).
           03 WSS-CMNA                                  PIC 9(02).
           03 WSS-SIND.
              05 I                                      PIC 9(02).
              05 J                                      PIC 9(02).
           03 WSS-TMN1                          VALUE 9 PIC 9(01).
           03 WSS-COD-PROC                              PIC X(06).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO SCR-SISG.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE SCR-SISG TO FIO-SIST.
           MOVE SPACES   TO BAT-COD-TRYC.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           MOVE BAT-COD-PROC IN BAT TO WSS-COD-PROC IN WSS-VARI.
           MOVE BAT-COD-CLVE IN BAT TO FRM-COD-CLVE IN BAT-FLD.
           MOVE BAT-NUM-NEJM IN BAT TO FRM-NUM-NEJM IN BAT-FLD.
           MOVE BAT-IND-IDEL IN BAT TO FRM-IND-IDEL IN BAT-FLD.
           MOVE BAT-IND-IGIA IN BAT TO FRM-IND-IGIA IN BAT-FLD.
           MOVE BAT-COD-DEST IN BAT TO FRM-COD-DEST IN BAT-FLD.
           MOVE BAT-COD-CLSE IN BAT TO FRM-COD-CLSE IN BAT-FLD.
           MOVE BAT-COD-FORM IN BAT TO FRM-COD-FORM IN BAT-FLD.
           MOVE BAT-GLS-NFRM IN BAT TO FRM-GLS-NFRM IN BAT-FLD.
           MOVE BAT-GLS-LFRM IN BAT TO FRM-GLS-LFRM IN BAT-FLD.
           MOVE BAT-IND-IPRV IN BAT TO FRM-IND-IPRV IN BAT-FLD.
           MOVE BAT-VEC-ILEE IN BAT TO FRM-VEC-ILEE IN BAT-FLD.
           MOVE BAT-VEC-PLNT IN BAT TO FRM-VEC-PLNT IN BAT-FLD.

           MOVE 'B'         TO BAT-COD-TRYC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF FIO-STAT-OKS
               MOVE BAT-GLS-GLSA IN BAT TO FRM-GLS-GLSA IN BAT-FLD
               MOVE BAT-GLS-NRPT IN BAT TO FRM-GLS-NRPT IN BAT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-GLSA IN BAT-FLD
               MOVE SPACES TO FRM-GLS-NRPT IN BAT-FLD.

           MOVE 'C'         TO BAT-COD-TRYC.
           MOVE FIO-FND-NLS TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF FIO-STAT-OKS
               PERFORM LEE-CMN
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GNS-FIO-BAT.
      *JSS MOVE BAT-DFLD                 TO FRM-DFLD.
           MOVE WSS-COD-PROC IN WSS-VARI TO BAT-COD-PROC IN BAT.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SCR-SISG TO FIO-SIST.
           MOVE FIO-PUT  TO WSS-CMND.
           PERFORM FIO-BAT.
           GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM RET-ALL-BAT.
           MOVE SCR-SISG TO FIO-SIST.
           MOVE FIO-MOD  TO WSS-CMND.
           PERFORM FIO-BAT.
           GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM RET-ALL-BAT.
           MOVE BAT-COD-PROC IN BAT-FLD TO BAT-COD-PROC IN BAT.
           MOVE SPACES                  TO BAT-COD-TRYC IN BAT.
           MOVE SCR-SISG                TO FIO-SIST.
           MOVE FIO-GET-KEY-UPD         TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           MOVE 'B'             TO BAT-COD-TRYC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF FIO-STAT-OKS
               MOVE FIO-DEL TO FIO-CMND
               PERFORM GNS-FIO-BAT.

           PERFORM DEL-CMN VARYING I FROM 0 BY 1 UNTIL I > WSS-TMN1.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-BAT
               PERFORM FST-KEY-BAT.
      *>>>>
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEE-CMN SECTION.
       INI-LEE-CMN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF NOT ( FIO-STAT-OKS AND
                    BAT-COD-PROC IN BAT = BAT-COD-PROC IN BAT-FLD AND
                    BAT-COD-TREG = 'C' )
               GO TO FIN-LEE-CMN.
           ADD BAT-NUM-CORR 1 GIVING I.
           MOVE BAT-IND-TCMN IN BAT TO FRM-IND-TCMN IN BAT-FLD( I ).
           MOVE BAT-GLS-CMND IN BAT TO FRM-GLS-CMND IN BAT-FLD( I ).
           GO TO INI-LEE-CMN.
       FIN-LEE-CMN.
           EXIT.

       FIO-BAT SECTION.
       INI-FIO-BAT.
           MOVE SPACES TO BAT.
           MOVE BAT-COD-PROC IN BAT-FLD TO BAT-COD-PROC IN BAT.
           MOVE SPACES                  TO BAT-COD-TRYC IN BAT.
           IF WSS-CMND = FIO-MOD
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GNS-FIO-BAT
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   GO TO FIN-FIO-BAT
               ELSE
                   PERFORM RET-ALL-BAT.
           MOVE BAT-COD-PROC IN BAT-FLD TO BAT-COD-PROC IN BAT.
           MOVE FRM-COD-CLVE IN BAT-FLD TO BAT-COD-CLVE IN BAT.
           MOVE FRM-NUM-NEJM IN BAT-FLD TO BAT-NUM-NEJM IN BAT.
           MOVE FRM-IND-IDEL IN BAT-FLD TO BAT-IND-IDEL IN BAT.
           MOVE FRM-IND-IGIA IN BAT-FLD TO BAT-IND-IGIA IN BAT.
           MOVE FRM-COD-DEST IN BAT-FLD TO BAT-COD-DEST IN BAT.
           MOVE FRM-COD-CLSE IN BAT-FLD TO BAT-COD-CLSE IN BAT.
           MOVE FRM-COD-FORM IN BAT-FLD TO BAT-COD-FORM IN BAT.
           MOVE FRM-GLS-NFRM IN BAT-FLD TO BAT-GLS-NFRM IN BAT.
           MOVE FRM-GLS-LFRM IN BAT-FLD TO BAT-GLS-LFRM IN BAT.
           MOVE FRM-IND-IPRV IN BAT-FLD TO BAT-IND-IPRV IN BAT.
           MOVE FRM-VEC-ILEE IN BAT-FLD TO BAT-VEC-ILEE IN BAT.
           MOVE FRM-VEC-PLNT IN BAT-FLD TO BAT-VEC-PLNT IN BAT.
           MOVE WSS-CMND                TO FIO-CMND.
           PERFORM GNS-FIO-BAT.

           MOVE 'B' TO BAT-COD-TRYC.
           IF WSS-CMND = FIO-MOD
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GNS-FIO-BAT
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   MOVE FRM-ABT  TO FRM-CMND
                   PERFORM GNS-PRO-FRM.
           MOVE FRM-GLS-GLSA IN BAT-FLD TO BAT-GLS-GLSA IN BAT.
           MOVE FRM-GLS-NRPT IN BAT-FLD TO BAT-GLS-NRPT IN BAT.
           MOVE WSS-CMND                TO FIO-CMND.
           PERFORM GNS-FIO-BAT.

           PERFORM WRT-CMN VARYING I FROM 0 BY 1 UNTIL I > WSS-TMN1 OR
                                                 NOT FIO-STAT-OKS.
       FIN-FIO-BAT.
           EXIT.

       WRT-CMN SECTION.
       INI-WRT-CMN.
           MOVE SPACES TO BAT.
           MOVE BAT-COD-PROC IN BAT-FLD TO BAT-COD-PROC IN BAT.
           MOVE 'C'                     TO BAT-COD-TREG IN BAT.
           MOVE I                       TO BAT-NUM-CORR IN BAT.
           ADD I 1 GIVING J.
           IF SCR-CCPP = 'ING' OR ( SCR-CCPP = 'ACT' AND
                                    SCR-ACTU = SCR-ACTU-ING )
               MOVE FIO-PUT TO WSS-CMNA
               GO TO CON-WRT-CMN.

           IF FRM-GLS-CMND IN BAT-FLD( J ) NOT > SPACES
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM GNS-FIO-BAT
               IF FIO-STAT-OKS
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM GNS-FIO-BAT
                   GO TO FIN-WRT-CMN
               ELSE
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-WRT-CMN.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-PUT TO WSS-CMNA
           ELSE
               PERFORM RET-ALL-BAT
               MOVE FIO-MOD TO WSS-CMNA.
       CON-WRT-CMN.
           MOVE FRM-IND-TCMN IN BAT-FLD( J ) TO BAT-IND-TCMN IN BAT.
           MOVE FRM-GLS-CMND IN BAT-FLD( J ) TO BAT-GLS-CMND IN BAT.
           MOVE WSS-CMNA                     TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
       FIN-WRT-CMN.
           EXIT.

       DEL-CMN SECTION.
       INI-DEL-CMN.
           ADD I 1 GIVING J.
           IF FRM-GLS-CMND IN BAT-FLD( J ) NOT > SPACES
               GO TO FIN-DEL-CMN.
           MOVE BAT-COD-PROC IN BAT-FLD TO BAT-COD-PROC IN BAT.
           MOVE 'C'                     TO BAT-COD-TREG.
           MOVE I                       TO BAT-NUM-CORR.
           MOVE FIO-GET-KEY-UPD         TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-DEL-CMN.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-BAT.
       FIN-DEL-CMN.
           EXIT.

       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBTAB.

       COPY GNSBEGLS.

       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
      *>>>>
*% END
