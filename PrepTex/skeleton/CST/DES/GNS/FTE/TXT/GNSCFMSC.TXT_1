       GNS-FIO-MSC SECTION.
       INI-GNS-FIO-MSC.
           IF IFD-GSIS(1) IS NOT NUMERIC
               PERFORM GNS-FIO-MSC-VSM
           ELSE
               PERFORM GNS-FIO-MSC-DTC.
       FIN-GNS-FIO-MSC.
           EXIT.

      *Modulo FIO interactivo para registro TAB de VSAM, 11-Jan-89 01:00 PM
       GNS-FIO-MSC-VSM SECTION.
       INI-GNS-FIO-MSC-VSM.
      *ISP 
           MOVE 'MSC' TO MSC-COD-TTAB IN MSC
                         MSC-CIC-TTAB IN MSC
                         MSC-EXT-TTAB IN MSC
                         MSC-SNX-TTAB IN MSC.
           MOVE 194    TO FIO-RLEN.
           MOVE FIO-CMND TO FIO-IAKY FIO-IGET.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'MSC-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE MSC-COD-TABL IN MSC TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTAB' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
      *JSS     MOVE 'TAB' TO FIO-FNAM
               MOVE IFD-GSIS(1) TO FIO-FNAM
      *
               MOVE 15     TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'MSC-CIC-TABL'
               MOVE MSC-CIC-TABL IN MSC TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA1' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA1' TO FIO-FNAM
               MOVE 15 TO FIO-KLEN
           ELSE
           IF FIO-AKEY = 'MSC-EXT-TABL'
               MOVE MSC-EXT-TABL IN MSC TO FIO-VKEY
      *ISP
      *         MOVE 'GNSMTA2' TO FIO-VOID
               MOVE 'M' TO FIO-FTYP
               MOVE 'TA2' TO FIO-FNAM
               MOVE 8 TO FIO-KLEN
           ELSE
               MOVE 'En GNS-FIO-MSC-VSM, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               PERFORM PRG-ABT.

           IF FIO-CMND = FIO-PUT OR FIO-MOD
      *ISP
               MOVE MSC-COD-TTAB IN MSC TO MSC-CIC-TTAB IN MSC
                                           MSC-EXT-TTAB IN MSC
                                           MSC-SNX-TTAB IN MSC
               MOVE MSC TO FIO-DFLD.
           PERFORM FIO.
           IF FIO-STAT-OKS AND FIO-IGET-YES
               MOVE FIO-BUF0 TO MSC.
           MOVE SPACES TO FIO-AKEY.
       FIN-GNS-FIO-MSC-VSM.
           EXIT.

      * Modulo FIO para registro MSC en DATACOM
       GNS-FIO-MSC-DTC SECTION.
       INI-GNS-FIO-MSC-DTC.
      *JSS
           MOVE 'MSC' TO MSC-COD-TTAB IN MSC
                         MSC-CIC-TTAB IN MSC
                         MSC-EXT-TTAB IN MSC
                         MSC-SNX-TTAB IN MSC.
      *
           MOVE ADR-MSC-REQA TO ADR-REQA.
           MOVE 'TAB' TO ADR-TABL IN ADR-REQA.
      *JSS MOVE IFD-GSIS( 1 ) TO ADR-DBID IN ADR-REQA.
           MOVE FIO-SIST TO IFD-SAUX.
           MOVE 'C'      TO IFD-QAUX.
           MOVE 1 TO IFD-IAUX.
           SET IFD-ITBL TO 1.
           SEARCH IFD-VSIS VARYING IFD-IAUX
               AT END
                   MOVE 'Sistema Invalido en GNS-FIO-MSC-DTC'
                                                          TO FIO-MEN1
                   MOVE IFD-DAUX                          TO FIO-MEN2
                   GO TO PRG-ABT
               WHEN IFD-DSIS( IFD-ITBL ) = IFD-DAUX
                   MOVE IFD-GSIS( IFD-ITBL) TO ADR-DBID IN ADR-REQA.
      *
           MOVE 'TAB00' TO ADR-ELM1.
           MOVE FIO-PROG TO ADR-PROG.
           MOVE FIO-CMND TO FIO-IAKY.
           IF NOT FIO-IAKY-CON AND
              ( FIO-AKEY = 'MSC-COD-TABL' OR FIO-AKEY NOT > SPACES )
               MOVE MSC-COD-TABL IN MSC TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB00' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSC-STP-ITRN'
               MOVE MSC-STP-ITRN IN MSC TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB01' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSC-CIC-TABL'
               MOVE MSC-CIC-TABL IN MSC TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB02' TO ADR-DKEY IN ADR-REQA
           ELSE
           IF FIO-AKEY = 'MSC-EXT-TABL'
               MOVE MSC-EXT-TABL IN MSC TO ADR-VKEY IN ADR-REQA
               MOVE 'TAB03' TO ADR-DKEY IN ADR-REQA
           ELSE
               MOVE 'En GNS-FIO-MSC-DTC, key' TO FIO-MENS
               MOVE FIO-AKEY   TO FIO-MENS-KEY
               MOVE 'Invalida' TO FIO-MENS-FIL
               GO TO PRG-ABT.
      *JSS
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE MSC-COD-TTAB IN MSC TO MSC-CIC-TTAB IN MSC
                                           MSC-EXT-TTAB IN MSC
                                           MSC-SNX-TTAB IN MSC.
      *
           MOVE MSC TO FIO-DFLD.
           PERFORM GNS-FIO-DTC.
           IF FIO-STAT-OKS
               MOVE FIO-DFLD TO MSC
           ELSE
      *JSS     MOVE 'GNSMSC' TO FIO-MEN2
               MOVE FIO-SIST TO FIO-MENS-SIS
               MOVE 'TAB'    TO FIO-MENS-REG
      *
               IF FIO-STAT-FTL
                   GO TO PRG-ABT.
           MOVE SPACES   TO FIO-AKEY.
           MOVE ADR-REQA TO ADR-MSC-REQA.
       FIN-GNS-FIO-MSC-DTC.
           EXIT.
