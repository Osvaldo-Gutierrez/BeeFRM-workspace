*%! Codigo adicional para programa
*%! LA SIGUIENTE INSTRUCCION PERMITE NO INCLUIR LOS
*%! COPYS GNSBRTAB Y GNSBFTAB DEL ESQUELETO,
*%! PUES EL REGISTRO TAB ES EL ARCHIVO BASE
*%! NO_TIENE_TIMESTAMP = TRUE
*%! HDR_CST = FALSE
*% NO_INC_TAB = TRUE
*% FRM = "TAB"
*% PADRE = "TAB"
*% KEY_PADRE = "TAB-COD-TABL"
*% LARGO_KEY_PADRE = 15
*% FIO_PADRE = "SIS-FIO-TAB"
*% SIST_PADRE = "GNS"
*% KEY_BROWSE_PADRE = "TAB-COD-TABL"
*% ACEPTE_PF7 = TRUE
*% ACEPTE_PF8 = TRUE
*% ORG_PADRE_VSI = TRUE
*% INCLUDE 'GNSSRC:PFSCONENT.SRC'
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS
       COPY GNSWGTSK.
       COPY GNSMXW01.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GET-TSK-TERM.
      * PTC-INI-AUT
           IF SCR-OFRM-SRV

              PERFORM GET-ISIS.

      * PTC-FIN-AUT
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO SCR-SISG.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND = 'CMR' OR
              SCR-CMND = 'CON'
                MOVE FIO-GET-NLS TO FIO-CMND
                PERFORM SIS-FIO-TAB
                MOVE FIO-STAT TO PGM-STAT-TAB
                GO TO FND-TAB-NLS.
      *>>>>
*% END
*% IF FND_KEY OR CMN_ING OR INI_CMN_MOD
      *<<<< FND_KEY OR CMN_ING OR INI_CMN_MOD
           MOVE SCR-SISG TO FIO-SIST.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       FND-TAB-NLS.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF TAB-FEC-FTRN IN TAB IS NOT NUMERIC
               MOVE ZEROES TO TAB-FEC-FTRN IN TAB.
      *>>>>
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR
      *PTC-INI:
           IF SCR-CMND = 'CMR' AND
              SCR-OFRM-SRV

                 MOVE TSK-TERM-ALF TO QUE-TERM
                 MOVE PTC-TAB-PTAB-TYPE TO QUE-TYPE
                 MOVE QUE-DEL TO QUE-CMND
                 PERFORM GNS-PRO-QUE

                 MOVE SCR-SISG TO FIO-SIST
                 MOVE TAB-COD-TTAB IN TAB-FLD TO TAB-COD-TTAB IN TAB
                 MOVE TAB-COD-CTAB IN TAB-FLD TO TAB-COD-CTAB IN TAB
                 MOVE ZEROES TO QUE-NITM
                 MOVE FIO-GET-NLS TO FIO-CMND.

       CIC-PTC-TAB.
           IF SCR-CMND = 'CMR' AND
              SCR-OFRM-SRV     AND
              QUE-NITM < PTC-TAB-PTAB-MITM
                 PERFORM SIS-FIO-TAB
                 IF FIO-STAT-OKS AND
                    TAB-COD-TTAB IN TAB = TAB-COD-TTAB IN TAB-FLD

                     MOVE SPACES TO PTC-TAB-ITEM
                     ADD 1 TO QUE-NITM
                     MOVE TSK-TERM-ALF TO QUE-TERM
                     MOVE PTC-TAB-PTAB-TYPE TO QUE-TYPE

                     MOVE TAB-COD-TTAB IN TAB TO PTC-TAB-TAB-COD-TTAB
                     MOVE TAB-COD-CTAB IN TAB TO PTC-TAB-TAB-COD-CTAB
                     MOVE TAB-CIC-CTAB IN TAB TO PTC-TAB-TAB-CIC-CTAB
                     MOVE TAB-EXT-CTAB IN TAB TO PTC-TAB-TAB-EXT-CTAB
                     MOVE TAB-GLS-DESC IN TAB TO PTC-TAB-TAB-GLS-DESC
                     MOVE TAB-GLS-ABRV IN TAB TO PTC-TAB-TAB-GLS-ABRV
                     MOVE TAB-GLS-DCOR IN TAB TO PTC-TAB-TAB-GLS-DCOR
                     MOVE TAB-IND-VIGE IN TAB TO PTC-TAB-TAB-IND-VIGE
                     MOVE TAB-NUM-DTRN IN TAB 
                                              TO TAB-NUM-DTRN IN TAB-FLD
                     MOVE TAB-NUM-MTRN IN TAB 
                                              TO TAB-NUM-MTRN IN TAB-FLD
                     MOVE TAB-NUM-STRN IN TAB 
                                              TO TAB-NUM-STRN IN TAB-FLD
                     MOVE TAB-NUM-ATRN IN TAB 
                                              TO TAB-NUM-ATRN IN TAB-FLD

                     MOVE TAB-FEC-FTRN IN TAB-FLD
                                              TO PTC-TAB-TAB-FEC-FTRN
                     MOVE TAB-GLS-DATA IN TAB TO PTC-TAB-TAB-GLS-DATA

                     MOVE PTC-TAB-ITEM TO QUE-ITEM
                     MOVE PTC-TAB-PTAB-LENG TO QUE-LITM
                     MOVE QUE-PUT  TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     MOVE FIO-GET-NXT TO FIO-CMND
                     GO TO CIC-PTC-TAB.

      *PTC-FIN:
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-TAB
               PERFORM FST-KEY-TAB.
      *>>>>
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF INI_CMN_ELI OR INI_CMN_ACC OR CMN_PGM
      *<<<< INI_CMN_ELI OR INI_CMN_ACC OR CMN_PGM
           MOVE SCR-SISG TO FIO-SIST.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           IF TAB-COD-CTAB IN TAB-FLD > SPACES
               PERFORM GET-FHOY
               MOVE HOY-STP-ITRN TO TAB-STP-ITRN IN TAB.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE SPACES TO TAB-GLS-FLAG IN TAB.
           MOVE ZEROES TO TAB-HRA-HRTR IN TAB.
           MOVE SPACES TO TAB-MSC-TACC IN TAB.
           MOVE SPACES TO TAB-COD-OTRN IN TAB.
           MOVE SPACES TO TAB-COD-ATRN IN TAB.
           MOVE SPACES TO TAB-SNX-TABL IN TAB.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *PTC-INI:
       GET-ISIS SECTION.
       INI-GET-ISIS.
           PERFORM KEY-ISIS.
           MOVE PTC-TAB-ISIS-LENG TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE QUE-ITEM TO PTC-TAB-ISIS-CSIS.
           MOVE PTC-TAB-ISIS-CSIS TO SCR-SISG.
       FIN-GET-ISIS.
           EXIT.

       KEY-ISIS SECTION.
       INI-KEY-ISIS.
           MOVE PTC-TAB-ISIS-TYPE TO QUE-TYPE.
           MOVE TSK-TERM-ALF      TO QUE-TERM.
       FIN-KEY-ISIS.
           EXIT.

       COPY GNSBGTSK.
      *PTC-FIN:
       SIS-FIO-TAB SECTION.
       INI-SIS-FIO-TAB.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       FIN-SIS-FIO-TAB.
           EXIT.

       COPY GNSBVCOD.
       COPY GNSBVTAB.
      *>>>>
*% END
*% IF EOF_VAX
      *<<<< EOF_VAX
      * Modulo FIO para archivo GNSTAB ( MSG )
       GNS-FIO-MSG SECTION.
       INI-GNS-FIO-MSG.
      *JSS
           MOVE FIO-SIST TO MSG-COD-SIST.
           MOVE 'MSG'    TO MSG-COD-TTAB IN MSG.
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE MSG-COD-TTAB IN MSG TO MSG-CIC-TTAB IN MSG
                                           MSG-EXT-TTAB IN MSG
                                           MSG-SNX-TTAB IN MSG.
      *JSS
           MOVE 'PFMSG'  TO MSG-COD-FMSG IN MSG-VARI.
           CALL MSG-GLS-FMSG USING FIO-CMND MSG.
           MOVE FIO-SIST TO FIO-MENS-SIS.
           MOVE 'MSG'    TO FIO-MENS-REG.
       FIN-GNS-FIO-MSG.
           EXIT.

      * Modulo FIO para archivo GNSTAB
       GNS-FIO-TAB SECTION.
       INI-GNS-FIO-TAB.
      *JSS
           MOVE FIO-SIST TO TAB-COD-SIST.
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE TAB-COD-TTAB IN TAB TO TAB-CIC-TTAB IN TAB
                                           TAB-EXT-TTAB IN TAB
                                           TAB-SNX-TTAB IN TAB.
      *JSS CALL TAB-GLS-FTAB USING FIO-CMND TAB.
           CALL 'PRYPFTAB'   USING FIO-CMND TAB.
      *
           MOVE FIO-SIST TO FIO-MENS-SIS.
           MOVE 'TAB'    TO FIO-MENS-REG.
       FIN-GNS-FIO-TAB.
           EXIT.

      * Modulo FIO para archivo GNSTAB ( MSC )
       GNS-FIO-MSC SECTION.
       INI-GNS-FIO-MSC.
      *JSS
           MOVE FIO-SIST TO MSC-COD-SIST.
           MOVE 'MSC'    TO MSC-COD-TTAB IN MSC.
           IF FIO-CMND = FIO-PUT OR FIO-MOD
               MOVE MSC-COD-TTAB IN MSC TO MSC-CIC-TTAB IN MSC
                                           MSC-EXT-TTAB IN MSC
                                           MSC-SNX-TTAB IN MSC.
      *JSS se ocupa fio del MSG para no abrir archivo MSC
           MOVE 'PFMSG'  TO MSC-COD-FMSC IN MSC-VARI.
           CALL MSC-GLS-FMSC USING FIO-CMND MSC.
           MOVE FIO-SIST TO FIO-MENS-SIS.
           MOVE 'MSC'    TO FIO-MENS-REG.
       FIN-GNS-FIO-MSC.
           EXIT.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< IF EOF_IBM
      *>>>>
*% END
*% IF EOF_PU
      *<<<< IF EOF_PU
       VAL-IKY-TAB SECTION.
       INI-VAL-IKY-TAB.
           PERFORM VAL-TAB-COD-TTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAB-COD-TTAB-LEN IN TAB-FLD
                GO TO FIN-VAL-IKY-TAB.
           PERFORM VAL-TAB-COD-CTAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAB-COD-CTAB-LEN IN TAB-FLD
                GO TO FIN-VAL-IKY-TAB.
       FIN-VAL-IKY-TAB.
           EXIT.

       VAL-TAB-COD-TTAB SECTION.
       INI-VAL-TAB-COD-TTAB.
           IF TAB-COD-TTAB IN TAB-FLD NOT > SPACES
              MOVE SPACES TO TAB-COD-TTAB IN TAB-FLD.
       FIN-VAL-TAB-COD-TTAB.
           EXIT.
       
       VAL-TAB-COD-CTAB SECTION.
       INI-VAL-TAB-COD-CTAB.
           IF TAB-COD-CTAB IN TAB-FLD NOT > SPACES
              MOVE SPACES TO TAB-COD-CTAB IN TAB-FLD.
      *<<<< TAB_COD_CTAB
           IF TAB-COD-CTAB IN TAB-FLD NOT > SPACES
               MOVE SPACES TO TAB-COD-CTAB IN TAB-FLD
               GO TO FIN-VAL-TAB-COD-CTAB.
           MOVE TAB-COD-TTAB IN TAB-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SCR-SISG TO FIO-SIST.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-TAB-COD-CTAB.
           EXIT.
      *>>>>
*% END
