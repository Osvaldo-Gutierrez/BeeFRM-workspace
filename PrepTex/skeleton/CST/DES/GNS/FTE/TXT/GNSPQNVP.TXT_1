*%! Codigo adicional para GNSPANVP Novedades
*% IF SETTAG
*% FNCPQ = "CVTWEB"
*% VSNPQ = "07.02.07"
*% FNCPU = "CVTWEB"
*% VSNPU =  "07.02.07"
*% END
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS                                                         
      *                                                                 
      * Contexto rango de fechas                                         
      *                                                                 
      *   Pgm      PG1  PGS  PE   P*                                    
      *   X        X         X          1era instancia pgm especifico   
      *            X              X     1era instancia pgm cualquiera   
      *   X             X    X          Sgte instancia pgm especifico   
      *   X             X         X     Sgte instancia pgm cualquiera   
      *                                                                 
      *                                                                 
      *                                                                 
      * Flujo de busqueda y recorrido 
      *                                                                 
      *  Pgm *   Pgm E      PG1  PGS   CVP-KEY-IREG    CVP-STP-IPFF
      *                                AMB-Pgm+Ffoto   Fecha Foto
      * 1)---------------------------------------------------------
      *   X                  X                          X GET-NLS(R1)
      *                                X FND-KEY-GKEY
      *                                                 X GET-NXT-CICLO
      *
      * 2)--------------------------------------------------------
      *   X                       X    X FND-KEY-GKEY(ANT)
      *                                                X GET-NXT-PTR
      *                                                X GET-NXT-CICLO
      * 3)--------------------------------------------------------
      *           X          X         X GET-NLS(R1)
      *                                X FND-KEY-GKEY
      *                                X GET-NXT-CICLO
      *
      * 4)-------------------------------------------------------
      *           X               X    X FND-KEY-GKEY(ANT)
      *                                X GET-NXT-PTR
      *                                X GET-NXT-CICLO
      *
      *
       01  WSS-CVP-BKP        VALUE SPACES        PIC X(500).           
      *Entidades de GNS                                                 
       77  WSS-AKEY           VALUE SPACES        PIC X(32).            
       COPY GNSWGNVP.
       01  WSS-FEC-FDMA.
           03  WSS-NUM-DDMA                       PIC X(02).
           03  WSS-NUM-MDMA                       PIC X(02).
           03  WSS-NUM-SDMA                       PIC X(02).
           03  WSS-NUM-ADMA                       PIC X(02).
      
       01  WSS-FEC-FMHA.
           03  WSS-NUM-SMHA                       PIC X(02).
           03  WSS-NUM-AMHA                       PIC X(02).
           03  WSS-NUM-MMHA                       PIC X(02).
           03  WSS-NUM-DMHA                       PIC X(02).
           03  WSS-HRA-HMHA                       PIC X(06).
      
       01  WSS-FEC-FMDE.
           03  WSS-NUM-SMDE                       PIC X(02).
           03  WSS-NUM-AMDE                       PIC X(02).
           03  WSS-NUM-MMDE                       PIC X(02).
           03  WSS-NUM-DMDE                       PIC X(02).
           03  WSS-HRA-HMDE                       PIC X(06).
      
       01  WSS-FEC-FAMP.
           03  WSS-NUM-SAMP                       PIC X(02).
           03  WSS-NUM-AAMP                       PIC X(02).
           03  WSS-NUM-MAMP                       PIC X(02).
           03  WSS-NUM-DAMP                       PIC X(02).
           03  WSS-HRA-HAMP                       PIC X(06).
      
       01  WSS-STP-FDES.
           03  WSS-FEC-FDES.
               05  WSS-NUM-SDES                   PIC X(02).
               05  WSS-NUM-ADES                   PIC X(02).
               05  WSS-NUM-MDES                   PIC X(02).
               05  WSS-NUM-DDES                   PIC X(02).
           03  WSS-HRA-HDES                       PIC X(06).
      
       01  WSS-STP-FHAS.
           03  WSS-FEC-FHAS.
               05  WSS-NUM-SHAS                   PIC X(02).
               05  WSS-NUM-AHAS                   PIC X(02).
               05  WSS-NUM-MHAS                   PIC X(02).
               05  WSS-NUM-DHAS                   PIC X(02).
           03  WSS-HRA-HHAS                       PIC X(06).
      
       77  WSS-COD-TTAB                PIC X(03).
       77  WSS-COD-SIST                PIC X(03).
       77  WSS-COD-CTAB-L11            PIC X(11).
       77  WSS-COD-CTAB-L11-CMP        PIC X(11).
       77  IMP-GLOSA-VDT               PIC 9(04).
       77  IMP-GLOSA-FDC               PIC 9(04).
      
                                                                        
      *>>>> WSS                                                         
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CVM-REQA==.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *<<<< INI_FIO                                                     
           MOVE TSK-TERM-ALF    TO TS-NVP-TERM-OCC.                     
           MOVE 'PRU1'          TO TS-NVP-TERM-OCC.                     
                                                                        
           MOVE TS-NVP-COLA-OCC TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'CVPNLS' TO QUE-COLA.                                   
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'PROCVP01' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'PROCVP02' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'PROCVP03' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'PROCVP04' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'PROCVP05' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
                                                                        
           MOVE 'CVPKEY' TO QUE-COLA.                                   
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           MOVE 'CVPKEYSK' TO QUE-COLA.                                 
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'CVPCVP' TO QUE-COLA.                                   
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'CVPCVPSC' TO QUE-COLA.                                 
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'FDC1' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'FDC2' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'FDC3' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'VDT1' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'VDT2' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'VDT3' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'VDT3' TO QUE-COLA.                                     
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'PRU1OVDP' TO QUE-COLA.                                 
           MOVE QUE-DEL TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
      *>>>> INI_FIO                                                     
      *>>>> INI_FIO
*% END
*% IF FND_KEY
      *<<<< FND_KEY                                                     
                                                                        
           IF SCR-CMND = 'UPF'
              MOVE 'F-FOTO' TO FRM-COD-BUSQ IN NVP-FLD
              MOVE 99       TO FRM-NUM-DDES IN NVP-FLD
              MOVE 99       TO FRM-NUM-MDES IN NVP-FLD
              MOVE 99       TO FRM-NUM-SDES IN NVP-FLD
              MOVE 99       TO FRM-NUM-ADES IN NVP-FLD
              MOVE 999999   TO FRM-HRA-HDES IN NVP-FLD.
      
           MOVE FRM-NUM-DHAS IN NVP-FLD TO WSS-NUM-DMHA.
           MOVE FRM-NUM-MHAS IN NVP-FLD TO WSS-NUM-MMHA.
           MOVE FRM-NUM-SHAS IN NVP-FLD TO WSS-NUM-SMHA.
           MOVE FRM-NUM-AHAS IN NVP-FLD TO WSS-NUM-AMHA.
           MOVE FRM-HRA-HHAS IN NVP-FLD TO WSS-HRA-HMHA.
      
           MOVE FRM-NUM-DDES IN NVP-FLD TO WSS-NUM-DMDE.
           MOVE FRM-NUM-MDES IN NVP-FLD TO WSS-NUM-MMDE.
           MOVE FRM-NUM-SDES IN NVP-FLD TO WSS-NUM-SMDE.
           MOVE FRM-NUM-ADES IN NVP-FLD TO WSS-NUM-AMDE.
           MOVE FRM-HRA-HDES IN NVP-FLD TO WSS-HRA-HMDE.
      
           IF FRM-COD-BUSQ IN NVP-FLD = 'F-REVISION'
               MOVE CVP-COD-PAMB IN NVP-FLD TO CVP-COD-RAMB IN CVP
               MOVE CVP-COD-PROG IN NVP-FLD TO CVP-COD-PREV IN CVP
               MOVE FRM-NUM-DDES IN NVP-FLD TO CVP-NUM-DREV IN CVP
               MOVE FRM-NUM-MDES IN NVP-FLD TO CVP-NUM-MREV IN CVP
               MOVE FRM-NUM-SDES IN NVP-FLD TO CVP-NUM-SREV IN CVP
               MOVE FRM-NUM-ADES IN NVP-FLD TO CVP-NUM-AREV IN CVP
               MOVE FRM-HRA-HDES IN NVP-FLD TO CVP-HRA-HREV IN CVP
           ELSE
               MOVE CVP-COD-PAMB IN NVP-FLD TO CVP-COD-PAMB IN CVP
               MOVE CVP-COD-PROG IN NVP-FLD TO CVP-COD-PROG IN CVP
               MOVE CVP-COD-PAMB IN NVP-FLD TO CVP-COD-IAMB IN CVP
               MOVE FRM-NUM-DDES IN NVP-FLD TO CVP-NUM-DPFF IN CVP
               MOVE FRM-NUM-MDES IN NVP-FLD TO CVP-NUM-MPFF IN CVP
               MOVE FRM-NUM-SDES IN NVP-FLD TO CVP-NUM-SPFF IN CVP
               MOVE FRM-NUM-ADES IN NVP-FLD TO CVP-NUM-APFF IN CVP
               MOVE FRM-HRA-HDES IN NVP-FLD TO CVP-HRA-HPHF IN CVP.
      
      
           IF SCR-CMND = 'UPF'
                 MOVE FIO-GET-LEQ TO FIO-CMND
                 PERFORM GNS-FIO-CVP
                 IF NOT FIO-STAT-OKS
                    GO TO FIN-FND-KEY
                 END-IF
                 MOVE 1 TO TS-NVP-TOT-OCC.
      
      
           IF SCR-CMND = 'PG1'
              IF FRM-COD-BUSQ IN NVP-FLD = 'F-REVISION'
                 MOVE FIO-GET-NLS TO FIO-CMND
                 MOVE 'CVP-KEY-REVI'     TO FIO-AKEY
                 PERFORM GNS-FIO-CVP
                 IF NOT FIO-STAT-OKS
                    GO TO FIN-FND-KEY
                 END-IF
                 MOVE 'FSTREV02'          TO QUE-COLA
                 MOVE QUE-DEL             TO QUE-CMND
                 PERFORM GNX-PRO-QUE
                 MOVE 'FSTREV02'          TO QUE-COLA
                 MOVE CVP-KEY-REVI        TO QUE-ITEM
                 MOVE +29                 TO QUE-LITM
                 MOVE QUE-PUT             TO QUE-CMND
                 PERFORM GNX-PRO-QUE
              ELSE
                 IF FRM-COD-TBUS = '*'
                     MOVE 'CVP-STP-IPFF' TO FIO-AKEY
                 ELSE
                     MOVE 'CVP-KEY-IREG' TO FIO-AKEY
                 END-IF
              END-IF
              MOVE FIO-GET-NLS TO FIO-CMND
              PERFORM GNS-FIO-CVP
              IF NOT FIO-STAT-OKS
                 GO TO FIN-FND-KEY
              END-IF
           END-IF.
      
           MOVE 'CVPNLS'            TO QUE-COLA.
           MOVE CVP                 TO QUE-ITEM.
           MOVE +400                TO QUE-LITM.
           MOVE QUE-PUT             TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
      
      *    MOVE 'NVPKIREG'          TO QUE-COLA.
      *    MOVE QUE-PUT             TO QUE-CMND.
      *    MOVE +100                TO QUE-LITM.
      *    MOVE CVP-KEY-IREG IN CVP TO QUE-ITEM.
      *    PERFORM GNX-PRO-QUE.
      
      *    MOVE 'NVPKREVI'          TO QUE-COLA.
      *    MOVE QUE-PUT             TO QUE-CMND.
      *    MOVE +100                TO QUE-LITM.
      *    MOVE CVP-KEY-REVI IN CVP TO QUE-ITEM.
      *    PERFORM GNX-PRO-QUE.
      
      *    MOVE 'NVPKFUNC'          TO QUE-COLA.
      *    MOVE QUE-PUT             TO QUE-CMND.
      *    MOVE +100                TO QUE-LITM.
      *    MOVE CVP-KEY-FUNC IN CVP TO QUE-ITEM.
      *    PERFORM GNX-PRO-QUE.
      
      *    MOVE 'NVPKAKEY'          TO QUE-COLA.
      *    MOVE QUE-PUT             TO QUE-CMND.
      *    MOVE +100                TO QUE-LITM.
      *    MOVE WSS-AKEY            TO QUE-ITEM.
      *    PERFORM GNX-PRO-QUE.
      
           MOVE WSS-AKEY TO FIO-AKEY.
      
                                                                        
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           MOVE CVP                 TO WSS-CVP-BKP.
           MOVE 'CVPKEY'            TO QUE-COLA.
           MOVE CVP                 TO QUE-ITEM.
           MOVE +400                TO  QUE-LITM.
           MOVE QUE-PUT             TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           MOVE 'CVPKEYSK'          TO QUE-COLA.
           MOVE FIO-STAT            TO QUE-ITEM.
           MOVE +4                  TO  QUE-LITM.
           MOVE QUE-PUT             TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           IF NOT PGM-STAT-CVP-OKS
               GO TO FIN-FND-KEY.
      
      
           IF SCR-CMND = 'UPF'
               PERFORM PRO-CVP
           ELSE
           IF SCR-CMND = 'PG1'
               PERFORM PRO-CVP
           ELSE
      * PTR ( POINTER )
           IF SCR-CMND = 'PGS'
              IF FRM-COD-TBUS IN NVP-FLD = '*'
                 MOVE 'CVP-STP-IPFF' TO FIO-AKEY
              ELSE
                 MOVE 'CVP-KEY-IREG' TO FIO-AKEY
              END-IF
              MOVE FIO-GET-NXT       TO FIO-CMND
              PERFORM GNS-FIO-CVP
              MOVE FIO-STAT          TO PGM-STAT-CVP
              MOVE CVP               TO WSS-CVP-BKP
              PERFORM PRO-CVP.
      
           MOVE WSS-CVP-BKP          TO CVP.
      *>>>> FIN_FND_KEY                                                 
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
      *>>>> FIN_SCR_TRL
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>> FIN_HBL_FLD
*% END
*% IF SCR_GFLD_VAL_FLD
      *<<<< SCR_GFLD_VAL_FLD
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
      *>>>> CMN_ING
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *>>>> FIN_CMN_ING
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
      *>>>> CMN_MOD_RET
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
      *>>>> CMN_ACC
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      
      *>>>> EOF_PQ
*% END
*% IF EOF
      *<<<< EOF                                                         
                                                                        
       PRO-CVP SECTION.
       INI-PRO-CVP.
      
       CIC-PRO-CVP.
           MOVE SPACES                TO TS-NVP-OCC.
      
           MOVE 'FSTREV02'          TO QUE-COLA
           MOVE QUE-DEL             TO QUE-CMND
           PERFORM GNX-PRO-QUE
           MOVE 'FSTREV02'          TO QUE-COLA.
           MOVE CVP-KEY-REVI        TO QUE-ITEM.
           MOVE +29                 TO QUE-LITM.
           MOVE QUE-PUT             TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
      
           IF NOT FIO-STAT-OKS
                GO TO FIN-PRO-CVP.
      
           IF CVP-COD-PAMB IN NVP-FLD NOT = CVP-COD-PAMB IN CVP
              GO TO FIN-PRO-CVP.
      
           IF CVP-FEC-FCPL IN CVP NOT > ZEROES
               MOVE FIO-GET-NXT       TO FIO-CMND
               PERFORM GNS-FIO-CVP
               MOVE FIO-STAT          TO PGM-STAT-CVP
               IF FIO-STAT-OKS
                  GO TO CIC-PRO-CVP
               ELSE
                  GO TO FIN-PRO-CVP.
      
           IF FRM-COD-BUSQ IN NVP-FLD = 'F-REVISION'
              MOVE CVP-NUM-DREV IN CVP   TO WSS-NUM-DAMP
              MOVE CVP-NUM-MREV IN CVP   TO WSS-NUM-MAMP
              MOVE CVP-NUM-SREV IN CVP   TO WSS-NUM-SAMP
              MOVE CVP-NUM-AREV IN CVP   TO WSS-NUM-AAMP
              MOVE CVP-HRA-HREV IN CVP   TO WSS-HRA-HAMP
           ELSE
              MOVE CVP-NUM-DPFF IN CVP   TO WSS-NUM-DAMP
              MOVE CVP-NUM-MPFF IN CVP   TO WSS-NUM-MAMP
              MOVE CVP-NUM-SPFF IN CVP   TO WSS-NUM-SAMP
              MOVE CVP-NUM-APFF IN CVP   TO WSS-NUM-AAMP
              MOVE CVP-HRA-HPHF IN CVP   TO WSS-HRA-HAMP.
      
           IF FRM-COD-TBUS IN NVP-FLD = '*'          AND
              FRM-COD-BUSQ IN NVP-FLD = 'F-REVISION'
              IF WSS-FEC-FAMP NOT < WSS-FEC-FMDE AND
                 WSS-FEC-FAMP NOT > WSS-FEC-FMHA
                 CONTINUE
              ELSE
                 MOVE FIO-GET-NXT       TO FIO-CMND
                 PERFORM GNS-FIO-CVP
                 MOVE FIO-STAT          TO PGM-STAT-CVP
                 IF FIO-STAT-OKS
                    GO TO CIC-PRO-CVP
                 ELSE
                    GO TO FIN-PRO-CVP
                 END-IF
              END-IF
           ELSE
              IF SCR-CMND = 'UPF'
                  NEXT SENTENCE
              ELSE
              IF WSS-FEC-FAMP NOT < WSS-FEC-FMDE AND
                 WSS-FEC-FAMP NOT > WSS-FEC-FMHA
                  NEXT SENTENCE
              ELSE
                 GO TO FIN-PRO-CVP
              END-IF
           END-IF.
      
           IF FRM-COD-TBUS IN NVP-FLD = 'E' AND
              CVP-COD-PROG IN CVP NOT = CVP-COD-PROG IN NVP-FLD
              GO TO FIN-PRO-CVP
           END-IF.
      
           ADD 1 TO TS-NVP-IDX-OCC.
           IF TS-NVP-IDX-OCC > TS-NVP-TOT-OCC
              MOVE 'S'      TO FRM-COD-HMAS IN NVP-FLD
              GO TO FIN-PRO-CVP.
      
           MOVE 'N'                 TO FRM-COD-HMAS IN NVP-FLD.
           MOVE TS-NVP-IDX-OCC      TO FRM-NUM-TOCC IN NVP-FLD.
      
           MOVE CVP-COD-PROG IN CVP TO TS-NVP-CVP-COD-PROG.
           MOVE CVP-COD-ESQL IN CVP TO TS-NVP-CVP-COD-ESQL.
           MOVE CVP-COD-PLEN IN CVP TO TS-NVP-CVP-COD-PLEN.
           MOVE CVP-COD-PGEN IN CVP TO TS-NVP-CVP-COD-PGEN.
      
           MOVE CVP-NUM-DREV IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MREV IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SREV IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-AREV IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-NVP-CVP-FEC-FREV.
      
           MOVE CVP-HRA-HREV IN CVP TO TS-NVP-CVP-HRA-HREV.
           MOVE CVP-COD-PVGM IN CVP TO TS-NVP-CVP-COD-PVGM.
      
           MOVE CVP-NUM-DPFF IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MPFF IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SPFF IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-APFF IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-NVP-CVP-FEC-FPFF.
      
           MOVE CVP-HRA-HPHF IN CVP TO TS-NVP-CVP-HRA-HPHF.
           MOVE CVP-COD-CVCA IN CVP TO TS-NVP-CVP-COD-CVCA.
      
           MOVE CVP-NUM-DCPL IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MCPL IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SCPL IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-ACPL IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-NVP-CVP-FEC-FCPL.
      
           MOVE CVP-HRA-HRCP IN CVP TO TS-NVP-CVP-HRA-HRCP.
           MOVE CVP-COD-PMOD IN CVP TO TS-NVP-CVP-COD-PMOD.
           PERFORM BUS-GLS-PMOD.
      
           MOVE CVP-NUM-DCSG IN CVP TO WSS-NUM-DDMA.
           MOVE CVP-NUM-MCSG IN CVP TO WSS-NUM-MDMA.
           MOVE CVP-NUM-SCSG IN CVP TO WSS-NUM-SDMA.
           MOVE CVP-NUM-ACSG IN CVP TO WSS-NUM-ADMA.
           MOVE WSS-FEC-FDMA        TO TS-NVP-CVP-FEC-FCSG.
      
           MOVE CVP-HRA-HCSG IN CVP TO TS-NVP-CVP-HRA-HCSG.
           MOVE CVP-COD-PUSR IN CVP TO TS-NVP-CVP-COD-PUSR.
           MOVE CVP-COD-UCVT IN CVP TO TS-NVP-CVP-COD-UCVT.
           PERFORM BUS-GLS-UCVT.
      
           PERFORM BUS-GLS-PUSR.
           MOVE CVP-COD-PFNC IN CVP TO TS-NVP-CVP-COD-PFNC.
      
           PERFORM BUS-GLS-FDC.
           MOVE CVP-COD-PVSN IN CVP TO TS-NVP-CVP-COD-PVSN.
           MOVE CVP-COD-PVDT IN CVP TO TS-NVP-CVP-COD-PVDT.
      
           PERFORM BUS-GLS-VDT.
      
           MOVE TS-NVP-COLA-OCC TO QUE-COLA.
           MOVE TS-NVP-LITM-OCC TO QUE-LITM.
           MOVE TS-NVP-OCC      TO QUE-ITEM.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      
           IF FRM-COD-BUSQ IN NVP-FLD = 'F-REVISION'
               MOVE 'CVP-KEY-REVI'    TO FIO-AKEY
           ELSE
              IF FRM-COD-TBUS IN NVP-FLD = '*'
                  MOVE 'CVP-STP-IPFF' TO FIO-AKEY
              ELSE
                  MOVE 'CVP-KEY-IREG' TO FIO-AKEY
              END-IF
           END-IF.
           MOVE FIO-GET-NXT       TO FIO-CMND.
           PERFORM GNS-FIO-CVP.
           MOVE FIO-STAT          TO PGM-STAT-CVP.
           IF FIO-STAT-OKS
              GO TO CIC-PRO-CVP
           END-IF.
      
       FIN-PRO-CVP.
           EXIT.
                                                                        
       GNX-PRO-QUE SECTION.                                             
       INI-GNX-PRO-QUE.                                                 
      *     IF SCR-OFRM-SRV                                             
      *         PERFORM GNX-PRO-QUE.                                     
       FIN-GNX-PRO-QUE.                                                 
           EXIT.                                                        
                                                                        
       BUS-GLS-FDC SECTION.                                             
       INI-BUS-GLS-FDC.                                                 
                                                                        
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE 'FDC'               TO WSS-COD-TTAB.                    
           MOVE WSS-COD-TTAB        TO TAB-COD-TTAB IN TAB.             
                                                                        
           MOVE CVP-COD-PFNC IN CVP TO WSS-COD-CTAB-L11.                
           MOVE WSS-COD-CTAB-L11    TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-NLS         TO FIO-CMND.                        
                                                                        
           MOVE ZEROES              TO IMP-GLOSA-FDC.                   
                                                                        
       CIC-BUS-GLS-FDC.                                                 
                                                                        
           PERFORM GNS-FIO-TAB.                                         
                                                                        
           MOVE 'FDC1' TO QUE-COLA.                                     
           MOVE TAB-COD-CTAB IN TAB TO QUE-ITEM                         
           MOVE +15 TO  QUE-LITM.                                       
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'FDC2' TO QUE-COLA.                                     
           MOVE CVP-COD-PFNC IN CVP TO QUE-ITEM                         
           MOVE +15 TO  QUE-LITM.                                       
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'TAB1' TO QUE-COLA.                                     
           MOVE TAB                 TO QUE-ITEM                         
           MOVE +194 TO  QUE-LITM.                                      
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
           IF FIO-STAT-OKS                                              
                                                                        
              MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB-L11-CMP          
                                                                        
              IF TAB-COD-TTAB IN TAB = WSS-COD-TTAB AND                 
                 WSS-COD-CTAB-L11 = WSS-COD-CTAB-L11-CMP                
                 ADD 1 TO IMP-GLOSA-FDC                                 
                 IF IMP-GLOSA-FDC > 3                                   
                       GO TO FIN-BUS-GLS-FDC                            
                 ELSE                                                   
                 IF IMP-GLOSA-FDC = 1                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PFN1                                  
                     MOVE FRM-GLS-PFN1 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PFN1                                  
                                                                        
                     MOVE TAB-GLS-DATA IN TAB TO                        
                          FRM-GLS-PFN2                                  
                     MOVE FRM-GLS-PFN2 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PFN2                                  
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO CIC-BUS-GLS-FDC                                
                 ELSE                                                   
                 IF IMP-GLOSA-FDC = 2                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PFN3                                  
                     MOVE FRM-GLS-PFN3 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PFN3                                  
                                                                        
                     MOVE TAB-GLS-DATA IN TAB TO                        
                          FRM-GLS-PFN4                                  
                     MOVE FRM-GLS-PFN4 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PFN4                                  
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO CIC-BUS-GLS-FDC                                
                 ELSE                                                   
                 IF IMP-GLOSA-FDC = 3                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PFN5                                  
                     MOVE FRM-GLS-PFN5 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PFN5                                  
                  MOVE FIO-GET-NXT TO FIO-CMND                          
                  GO TO CIC-BUS-GLS-FDC.                                
       FIN-BUS-GLS-FDC.                                                 
           EXIT.                                                        
                                                                        
       BUS-GLS-VDT SECTION.                                             
       INI-BUS-GLS-VDT.                                                 
                                                                        
           MOVE 'VDT'              TO WSS-COD-TTAB.                     
           MOVE WSS-COD-TTAB       TO TAB-COD-TTAB IN TAB.              
           MOVE CVP-COD-PROG IN CVP TO WSS-COD-SIST.                    
           MOVE WSS-COD-SIST TO FIO-SIST.                               
                                                                        
           MOVE CVP-COD-PVDT IN CVP TO WSS-COD-CTAB-L11.                
           MOVE WSS-COD-CTAB-L11   TO TAB-COD-CTAB IN TAB.              
           MOVE FIO-GET-NLS        TO FIO-CMND.                         
                                                                        
           MOVE ZEROES             TO IMP-GLOSA-VDT.                    
                                                                        
       CIC-BUS-GLS-VDT.                                                 
           PERFORM GNS-FIO-TAB.                                         
                                                                        
                                                                        
           MOVE 'VDT1' TO QUE-COLA.                                     
           MOVE TAB-COD-CTAB IN TAB TO QUE-ITEM                         
           MOVE +15 TO  QUE-LITM.                                       
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'VDT2' TO QUE-COLA.                                     
           MOVE CVP-COD-PVDT IN CVP TO QUE-ITEM                         
           MOVE +15 TO  QUE-LITM.                                       
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'TAB2' TO QUE-COLA.                                     
           MOVE TAB                 TO QUE-ITEM                         
           MOVE +194 TO  QUE-LITM.                                      
           MOVE QUE-PUT TO QUE-CMND.                                    
           PERFORM GNX-PRO-QUE.                                         
                                                                        
                                                                        
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-BUS-GLS-VDT.                                    
                                                                        
              MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB-L11-CMP          
                                                                        
              IF TAB-COD-TTAB IN TAB = WSS-COD-TTAB AND                 
                 WSS-COD-CTAB-L11 = WSS-COD-CTAB-L11-CMP                
                 ADD 1 TO IMP-GLOSA-VDT                                 
                 IF IMP-GLOSA-VDT > 3                                   
                       GO TO FIN-BUS-GLS-VDT                            
                 ELSE                                                   
                 IF IMP-GLOSA-VDT = 1                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PVD1                                  
                     MOVE FRM-GLS-PVD1 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PVD1                                  
                                                                        
                     MOVE TAB-GLS-DATA IN TAB TO                        
                          FRM-GLS-PVD2                                  
                     MOVE FRM-GLS-PVD2 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PVD2                                  
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO CIC-BUS-GLS-VDT                                
                 ELSE                                                   
                 IF IMP-GLOSA-VDT = 2                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PVD3                                  
                     MOVE FRM-GLS-PVD3 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PVD3                                  
                                                                        
                     MOVE TAB-GLS-DATA IN TAB TO                        
                          FRM-GLS-PVD4                                  
                     MOVE FRM-GLS-PVD4 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PVD4                                  
                   MOVE FIO-GET-NXT TO FIO-CMND                         
                   GO TO CIC-BUS-GLS-VDT                                
                 ELSE                                                   
                 IF IMP-GLOSA-VDT = 3                                   
                     MOVE TAB-GLS-DESC IN TAB TO                        
                          FRM-GLS-PVD5                                  
                     MOVE FRM-GLS-PVD5 IN NVP-FLD TO                    
                   TS-NVP-FRM-GLS-PVD5                                  
                  MOVE FIO-GET-NXT TO FIO-CMND                          
                  GO TO CIC-BUS-GLS-VDT.                                
       FIN-BUS-GLS-VDT.                                                 
           EXIT.                                                        
                                                                        
       BUS-GLS-PMOD SECTION.
       INI-BUS-GLS-PMOD.
      
           IF CVP-COD-PMOD IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'MDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-PMOD IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-NVP-FRM-GLS-PMOD
           ELSE
              MOVE 'MODALIDAD NO REGISTRADA'
                                        TO TS-NVP-FRM-GLS-PMOD.
      
       FIN-BUS-GLS-PMOD.
           EXIT.
      
       BUS-GLS-UCVT SECTION.
       INI-BUS-GLS-UCVT.
      
           IF CVP-COD-UCVT IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'UDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-UCVT IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-NVP-FRM-GLS-UCVT
           ELSE
               MOVE 'USUARIO NO REGISTRADO'
                                        TO TS-NVP-FRM-GLS-UCVT.
      
       FIN-BUS-GLS-UCVT.
           EXIT.
      
       BUS-GLS-PUSR SECTION.
       INI-BUS-GLS-PUSR.
      
           IF CVP-COD-PUSR IN CVP > SPACES
              MOVE 'GNS'                TO TAB-COD-SIST
              MOVE 'UDC '               TO TAB-COD-TTAB IN TAB
              MOVE CVP-COD-PUSR IN CVP  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB  TO TS-NVP-FRM-GLS-PUSR
           ELSE
              MOVE 'USUARIO NO REGISTRADO'
                                        TO TS-NVP-FRM-GLS-PUSR.
      
       FIN-BUS-GLS-PUSR.
           EXIT.
      
      *>>>> EOF
*% END
