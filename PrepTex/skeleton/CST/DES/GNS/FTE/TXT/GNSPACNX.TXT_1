*% NO_HDR_CST = TRUE
*%! INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% LARGO_MI_COMMAREA = 67
*% IF WSS
      *<<<< WSS
       77 WSS-INIC-FRM  VALUE 'N' PIC X(01).
       77 WSS-IDN-IPRO  VALUE SPACES PIC X(08).
       01  WSS-QIDD-01.
           03 WSS-QIDD.                                                 
              05 WSS-NIDD VALUE 'GIDD'    PIC X(04).                    
              05 WSS-TIDD                 PIC X(04).                    
       01  WSS-CMMA VALUE SPACES.
           03 WSS-RFUN                             PIC X(300).
           03 WSS-NSXC                             PIC X(003).
           03 WSS-GSXC                             PIC X(003).
           03 FILLER                               PIC X(011).
       01  WSS-DFLD VALUE SPACES.
              05 WSS-NTRN                             PIC X(04).
              05 WSS-CAXC.
                 07 WSS-SIST.
                    09 WSS-CSIS OCCURS 3              PIC X(01).
                 07 WSS-FILL                          PIC X(01).
                 07 WSS-SISG                          PIC X(03).
      *  BNCO-MRCA-CART-LENG-PAIS-VRNT-CNAL-USER-MODO
                 07 WSS-RCV-AMBI.
                    09 WSS-RCV-AMBI-BNCO              PIC X(03).
                    09 WSS-RCV-AMBI-MRCA              PIC X(03).
                    09 WSS-RCV-AMBI-CART              PIC X(03).
                    09 WSS-RCV-AMBI-LENG              PIC X(02).
                    09 WSS-RCV-AMBI-PAIS              PIC X(02).
                    09 WSS-RCV-AMBI-VRNT              PIC X(01).
                    09 WSS-RCV-AMBI-CNAL              PIC X(05).
                    09 WSS-RCV-AMBI-USER              PIC X(12).
                    09 WSS-RCV-AMBI-MODO              PIC X(01).
      
       COPY GNSWGQUE.
           COPY USPC113.
      *>>>> WSS
*% END
*% IF PGM_PRE_EIB
*% IF PGM_PQ
      *<<<< PGM_PRE_EIB
           GO TO PGM-POS-EIB.
      *>>>> PGM_PRE_EIB
*% END
*% END
*% IF PGM_POS_RCK
*% IF PGM_PQ
      *<<<< PGM_POS_RCK
           IF WSS-IDN-IPRO NOT = 'USDP930 '
      *>>>> PGM_POS_RCK
*% END
*% END
*% IF PGM_INI
*% IF PGM_PQ
      *<<<< PGM_INI
       PGM-POS-EIB.
      *>>>> PGM_INI
*% END
*% END
*% IF PGM_POS_EDB
*% IF PGM_PQ
      *<<<< PGM_POS_EDB
      * == MANUAL INI ==
      * DEJAR ESTE COPY ANTERIOR CON COMENTARIOS
      *COPY GNSBGEIB.
      * == MANUAL FIN ==
           EXEC CICS ASSIGN
               INVOKINGPROG(WSS-IDN-IPRO)
           END-EXEC.
      *    IF EIBCALEN = 0
           IF WSS-IDN-IPRO = 'USDP930 '
               MOVE DFHCOMMAREA(1:EIBCALEN) TO WSS-CMMA
      
               MOVE 'GNSPQCNX'  TO IDD-PROG FIO-PROG
               MOVE IDD-VARI    TO SYS-CMMA
               MOVE +507        TO SYS-TCMA
               MOVE 'GNSPPIDD'  TO SYS-PROG
               MOVE SYS-LINK    TO SYS-CMND
               PERFORM GNS-PRO-SYS
               MOVE SYS-CMMA TO IDD-VARI
               PERFORM GNS-PUT-IDD
               PERFORM GNS-ERR-QUE

               MOVE 'S' TO WSS-INIC-FRM
               MOVE SPACES          TO SCR-VARI
               MOVE +274            TO SCR-TCMA
               MOVE 'GNS'           TO SCR-SIST
               MOVE 'GQ62'          TO SCR-NTRN
               MOVE 'GNSPQCNX'      TO SCR-PROG
               MOVE 'GU62'          TO SCR-NTRV
               MOVE 'GNSPUCNX'      TO SCR-PROV
               MOVE 'GNSACNX'       TO SCR-NLIB
               MOVE 'GNSFCNX'       TO SCR-NMAP
               MOVE 'HKY'           TO SCR-INST
               MOVE WSS-QIDD-01     TO SCR-QIDD
               MOVE 'GNSPP081'      TO SCR-CMNP
               MOVE 'CNF'           TO SCR-CMND
               MOVE 'ACC'           TO SCR-CCPP
               MOVE 'A'             TO SCR-STPP
               MOVE 'CONECTAMOS ? ' TO SCR-PRMT
               MOVE SPACES          TO SCR-CONF
               MOVE 'M'             TO SCR-ICMN
               MOVE 'GNSACTCNX'     TO SCR-NEMO.
      

           IF EIBAID = FRM-FFLD-PFA  OR
              EIBAID = FRM-FFLD-PF1  OR
              EIBAID = FRM-FFLD-PFC  OR
              EIBAID = FRM-FFLD-PF3  OR
              EIBAID = FRM-FFLD-PFL  OR
              EIBAID = FRM-FFLD-PF12
      *>>>> PGM_POS_EDB
*% END
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
           MOVE 'USDP930' TO SYS-PROG.
           MOVE SPACES       TO SYS-CMMA.
           MOVE ZEROES       TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
      *>>>> INI_SCR_COM
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      * == MANUAL INI ==
      * DEJAR ESTA INSTRUCCION ANTERIOR CON *
      *    PERFORM GNS-BUS-IDD.                                         
      * == MANUAL FIN ==
           PERFORM GNS-ERR-QUE.
      *>>>> INI_FIO
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
      
           MOVE FRM-COD-SIST IN CNX-FLD TO WSS-SIST.
           MOVE RCI-COD-USER IN CNX-FLD TO WSS-RCV-AMBI-USER.
           MOVE RCI-COD-BNCO IN CNX-FLD TO WSS-RCV-AMBI-BNCO.
           MOVE RCI-COD-MRCA IN CNX-FLD TO WSS-RCV-AMBI-MRCA.
           MOVE RCI-COD-CART IN CNX-FLD TO WSS-RCV-AMBI-CART.
           MOVE RCI-COD-LENG IN CNX-FLD TO WSS-RCV-AMBI-LENG.
           MOVE RCI-COD-PAIS IN CNX-FLD TO WSS-RCV-AMBI-PAIS.
           MOVE RCI-COD-VRNT IN CNX-FLD TO WSS-RCV-AMBI-VRNT.
           MOVE RCI-COD-CNAL IN CNX-FLD TO WSS-RCV-AMBI-CNAL.
           MOVE RCI-COD-MODO IN CNX-FLD TO WSS-RCV-AMBI-MODO.
      
           MOVE +43         TO SYS-TCMA.
           MOVE WSS-DFLD    TO SYS-CMMA.
           MOVE 'GNSPP081'  TO SYS-PROG.
           MOVE SYS-XCTL    TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           GO TO FIN-CMN-ACC.
      *>>>> INI_CMN_ACC
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-RCI.
           MOVE FIO-STAT TO PGM-STAT-RCI.
           GO TO FIN-FND-KEY.
      *>>>> FND_KEY
*% END
*% IF INI_SCR_PUTA
*% IF PGM_PQ
      *<<<< INI_SCR_PUTA
      
           IF WSS-INIC-FRM = 'S'
               PERFORM BUS-USER.
      
           IF WSS-INIC-FRM = 'S'
                MOVE WSS-NSXC TO FRM-COD-SIST IN CNX-FLD
                MOVE 'GNS' TO TAB-COD-SIST
                MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                MOVE FRM-COD-SIST TO TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                MOVE TAB-GLS-DESC TO FRM-GLS-SIST IN CNX-FLD
      
                MOVE USP-COD-USUARIO TO  FRM-COD-UCNX IN CNX-FLD
                MOVE USP-COD-USUARIO TO  USR-COD-USER IN USR
                PERFORM BUS-USR
                MOVE USR-GLS-DESC TO FRM-GLS-UCNX IN CNX-FLD
                MOVE SCR-NMAP TO FRM-NAME                                   
                MOVE SCR-NLIB TO FRM-NLIB                                   
      
                MOVE CNX-FLD TO FRM-DFLD
                MOVE FRM-INI TO FRM-CMND
                PERFORM GNS-PRO-FRM
                GO TO FIN-SCR-PUTA.
      *>>>> INI_SCR_PUTA
*% END
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGQUE.
       BUS-USER SECTION.
       INI-BUS-USER.
            COPY USPC143.
       FIN-BUS-USER.
           EXIT.

       GNS-PUT-IDD SECTION.                                             
       INI-GNS-PUT-IDD.                                                 
           EXEC CICS HANDLE CONDITION                                   
                     QIDERR (PUT-GNS-PUT-IDD)                           
                     ITEMERR(PUT-GNS-PUT-IDD)                           
           END-EXEC.                                                    
           MOVE +490     TO QUE-LITM.                                   
           MOVE EIBTRMID TO WSS-TIDD.                                   
           MOVE +1       TO QUE-NITM.                                   
           EXEC CICS WRITEQ TS                                          
                     QUEUE(WSS-QIDD)                                    
                     FROM(IDD-REGI)                                     
                     LENGTH(QUE-LITM)                                   
                     ITEM(QUE-NITM)                                     
                     REWRITE                                            
           END-EXEC.                                                    
           GO TO FIN-GNS-PUT-IDD.                                       
       PUT-GNS-PUT-IDD.                                                 
           EXEC CICS WRITEQ TS                                          
                     QUEUE(WSS-QIDD)                                    
                     FROM(IDD-REGI)                                     
                     LENGTH(QUE-LITM)                                   
           END-EXEC.                                                    
       FIN-GNS-PUT-IDD.                                                 
           EXIT.                                                        

      *>>>> EOF
*% END
