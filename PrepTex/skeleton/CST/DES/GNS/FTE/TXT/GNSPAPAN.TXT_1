*%! Codigo adicional
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03 WSS-I                         PIC 9(03).
           03 WSS-J                         PIC 9(03).
           03 WSS-IMAX         VALUE 120    PIC 9(03).
           03 WSS-TFUN.
              05 WSS-IFUN      OCCURS 120.
                 07 WSS-TCLA                PIC X(03).
                 07 WSS-CHAR                PIC X(01).
                 07 WSS-FUNC                PIC X(12).
           03 WSS-TPAN.
              05 WSS-RPAN      OCCURS 120.
                 07 WSS-RTCL                PIC X(03).
                 07 WSS-RCHR                PIC X(01).
                 07 WSS-RFUN                PIC X(12).
                 07 WSS-RTFU                PIC X(03).
                 07 WSS-RCMD                PIC X(50).
           03 WSS-NLIN         VALUE 12     PIC 9(02).
           03 WSS-NPAG         VALUE 0      PIC 9(02).
           03 WSS-LPAG         VALUE 10     PIC 9(02).
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-PAN
               PERFORM FST-KEY-PAN.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           MOVE 1 TO WSS-NPAG.
           INITIALIZE WSS-TFUN.
           INITIALIZE WSS-TPAN.
           MOVE PAN-GLS-ARCH IN PAN TO FRM-GLS-ARCH IN PAN-FLD.
           MOVE PAN-NUM-FILO IN PAN TO FRM-NUM-FILO IN PAN-FLD.
           MOVE PAN-NUM-COLO IN PAN TO FRM-NUM-COLO IN PAN-FLD.
           MOVE PAN-NUM-LINE IN PAN TO FRM-NUM-LINE IN PAN-FLD.
           MOVE PAN-COD-CLRP IN PAN TO FRM-COD-CLRP IN PAN-FLD.
           MOVE PAN-COD-CLRV IN PAN TO FRM-COD-CLRV IN PAN-FLD.
           MOVE PAN-GLS-PRM1 IN PAN TO FRM-GLS-PRM1 IN PAN-FLD.
           MOVE PAN-GLS-PRM2 IN PAN TO FRM-GLS-PRM2 IN PAN-FLD.
           PERFORM LEA-FUNC.
           GO TO FIN-PUT-SCR.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_GET_CON
      *F7, F8, PREV-SCREEN, NEXT-SCREEN
           IF NOT ( FRM-FFLD = 50 OR 51 OR 37 OR 38 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD OR FIN_GET_CON
      *<<<< SCR_GFLD_VAL_CON_FLD OR FIN_GET_CON
      *F7, PREV-SCREEN
           IF FRM-FFLD = 50 OR 37
               IF WSS-NPAG = 1
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'PAN    NOPRV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   PERFORM GUARDA-PANTALLA-ACTUAL
                   SUBTRACT 1 FROM WSS-NPAG
                   PERFORM DESPLIEGA-PANTALLA-ACTUAL
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
      *F8, NEXT-SCREEN
           IF FRM-FFLD = 51 OR 38
               IF WSS-NPAG = WSS-LPAG
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'PAN    NONXT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   PERFORM GUARDA-PANTALLA-ACTUAL
                   ADD 1 TO WSS-NPAG
                   PERFORM DESPLIEGA-PANTALLA-ACTUAL
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               PERFORM GUARDA-PANTALLA-ACTUAL.
      *>>>>
*% END
*% IF FIN_GET_CON
      *<<<< FIN_GET_CON
      *F7, F8, PREV-SCREEN, NEXT-SCREEN
           IF FRM-FFLD = 50 OR 51 OR 37 OR 38
               GO TO INI-GET-CON.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF FIO-STAT-OKS
               PERFORM ING-FUNC.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF FIO-STAT-OKS
               PERFORM MOD-FUNC.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF FIO-STAT-OKS
               PERFORM ELI-FUNC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEA-FUNC SECTION.
       INI-LEA-FUNC.
           MOVE SPACES TO WSS-TFUN.
           MOVE 0 TO WSS-I.
       LUP-LEA-FUNC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-LEA-FUNC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF NOT ( FIO-STAT-OKS AND
                    PAN-COD-IPAN IN PAN = PAN-COD-IPAN IN PAN-FLD )
               GO TO FIN-LEA-FUNC.
           IF WSS-I > WSS-NLIN
               GO TO CON-LEA-FUNC.
           MOVE PAN-COD-TCLA IN PAN TO FRM-COD-TCLA IN PAN-FLD(WSS-I).
           MOVE PAN-COD-CHAR IN PAN TO FRM-COD-CHAR IN PAN-FLD(WSS-I).
           MOVE PAN-COD-FUNC IN PAN TO FRM-COD-FUNC IN PAN-FLD(WSS-I).
           MOVE PAN-COD-TFUN IN PAN TO FRM-COD-TFUN IN PAN-FLD(WSS-I).
           MOVE PAN-GLS-CMND IN PAN TO FRM-GLS-CMND IN PAN-FLD(WSS-I).
       CON-LEA-FUNC.
           MOVE PAN-COD-TCLA IN PAN TO WSS-TCLA(WSS-I) WSS-RTCL(WSS-I).
           MOVE PAN-COD-CHAR IN PAN TO WSS-CHAR(WSS-I) WSS-RCHR(WSS-I).
           MOVE PAN-COD-FUNC IN PAN TO WSS-FUNC(WSS-I) WSS-RFUN(WSS-I).
           MOVE PAN-COD-TFUN IN PAN TO                 WSS-RTFU(WSS-I).
           MOVE PAN-GLS-CMND IN PAN TO                 WSS-RCMD(WSS-I).
           GO TO LUP-LEA-FUNC.
       FIN-LEA-FUNC.
           EXIT.

       GUARDA-PANTALLA-ACTUAL SECTION.
       INI-GUARDA-PANTALLA-ACTUAL.
           SUBTRACT 1 FROM WSS-NPAG   GIVING WSS-I.
           MULTIPLY WSS-I BY WSS-NLIN GIVING WSS-I.
           MOVE 0 TO WSS-J.
       LUP-GUARDA-PANTALLA-ACTUAL.
           ADD 1 TO WSS-I.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-NLIN
               GO TO FIN-GUARDA-PANTALLA-ACTUAL.
           MOVE FRM-COD-TCLA IN PAN-FLD(WSS-J) TO WSS-RTCL(WSS-I).
           MOVE FRM-COD-CHAR IN PAN-FLD(WSS-J) TO WSS-RCHR(WSS-I).
           MOVE FRM-COD-FUNC IN PAN-FLD(WSS-J) TO WSS-RFUN(WSS-I).
           MOVE FRM-COD-TFUN IN PAN-FLD(WSS-J) TO WSS-RTFU(WSS-I).
           MOVE FRM-GLS-CMND IN PAN-FLD(WSS-J) TO WSS-RCMD(WSS-I).
           GO TO LUP-GUARDA-PANTALLA-ACTUAL.
       FIN-GUARDA-PANTALLA-ACTUAL.
           EXIT.

       DESPLIEGA-PANTALLA-ACTUAL SECTION.
       INI-DESPLIEGA-PANTALLA-ACTUAL.
           SUBTRACT 1 FROM WSS-NPAG   GIVING WSS-I.
           MULTIPLY WSS-I BY WSS-NLIN GIVING WSS-I.
           MOVE 0 TO WSS-J.
       LUP-DESPLIEGA-PANTALLA-ACTUAL.
           ADD 1 TO WSS-I.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-NLIN
               GO TO FIN-DESPLIEGA-PANTALLA-ACTUAL.
           MOVE WSS-RTCL(WSS-I) TO FRM-COD-TCLA IN PAN-FLD(WSS-J).
           MOVE WSS-RCHR(WSS-I) TO FRM-COD-CHAR IN PAN-FLD(WSS-J).
           MOVE WSS-RFUN(WSS-I) TO FRM-COD-FUNC IN PAN-FLD(WSS-J).
           MOVE WSS-RTFU(WSS-I) TO FRM-COD-TFUN IN PAN-FLD(WSS-J).
           MOVE WSS-RCMD(WSS-I) TO FRM-GLS-CMND IN PAN-FLD(WSS-J).
           GO TO LUP-DESPLIEGA-PANTALLA-ACTUAL.
       FIN-DESPLIEGA-PANTALLA-ACTUAL.
           EXIT.

       ING-FUNC SECTION.
       INI-ING-FUNC.
           MOVE 0 TO WSS-I.
       LUP-ING-FUNC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ING-FUNC.
           IF WSS-RTCL(WSS-I) NOT > SPACES
               GO TO LUP-ING-FUNC.
           MOVE PAN-COD-IPAN IN PAN-FLD TO PAN-COD-IPAN IN PAN.
           MOVE WSS-RTCL(WSS-I)         TO PAN-COD-TCLA IN PAN.
           MOVE WSS-RCHR(WSS-I)         TO PAN-COD-CHAR IN PAN.
           MOVE WSS-RFUN(WSS-I)         TO PAN-COD-FUNC IN PAN.
           MOVE WSS-RTFU(WSS-I)         TO PAN-COD-TFUN IN PAN.
           MOVE WSS-RCMD(WSS-I)         TO PAN-GLS-CMND IN PAN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF FIO-STAT-OKS
               GO TO LUP-ING-FUNC.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'PAN    NOPUT' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE PAN-KEY-IPAN IN PAN TO FRM-MEN2.
       FIN-ING-FUNC.
           EXIT.

       ELI-FUNC SECTION.
       INI-ELI-FUNC.
           MOVE 0 TO WSS-I.
       LUP-ELI-FUNC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ELI-FUNC.
           IF WSS-RTCL(WSS-I) NOT > SPACES
               GO TO LUP-ELI-FUNC.
           MOVE PAN-COD-IPAN IN PAN-FLD TO PAN-COD-IPAN IN PAN.
           MOVE WSS-RTCL(WSS-I)         TO PAN-COD-TCLA IN PAN.
           MOVE WSS-RCHR(WSS-I)         TO PAN-COD-CHAR IN PAN.
           MOVE WSS-RFUN(WSS-I)         TO PAN-COD-FUNC IN PAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ELI-FUNC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF FIO-STAT-OKS
               GO TO LUP-ELI-FUNC.
       ERR-ELI-FUNC.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'PAN    NOELI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE PAN-KEY-IPAN IN PAN TO FRM-MEN2.
       FIN-ELI-FUNC.
           EXIT.

       MOD-FUNC SECTION.
       INI-MOD-FUNC.
           PERFORM ELI-FUNC-WSS.
           IF MSG-COD-MENS NOT > SPACES
               PERFORM ING-FUNC.
       FIN-MOD-FUNC.
           EXIT.

       ELI-FUNC-WSS SECTION.
       INI-ELI-FUNC-WSS.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-I.
       LUP-ELI-FUNC-WSS.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ELI-FUNC-WSS.
           IF WSS-TCLA IN WSS-VARI(WSS-I) NOT > SPACES
               GO TO LUP-ELI-FUNC-WSS.
           MOVE PAN-COD-IPAN IN PAN-FLD     TO PAN-COD-IPAN IN PAN.
           MOVE WSS-TCLA IN WSS-VARI(WSS-I) TO PAN-COD-TCLA IN PAN.
           MOVE WSS-CHAR IN WSS-VARI(WSS-I) TO PAN-COD-CHAR IN PAN.
           MOVE WSS-FUNC IN WSS-VARI(WSS-I) TO PAN-COD-FUNC IN PAN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ELI-FUNC-WSS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM GNS-FIO-PAN.
           IF FIO-STAT-OKS
               GO TO LUP-ELI-FUNC-WSS.
       ERR-ELI-FUNC-WSS.
           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'PAN    NOELI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE PAN-KEY-IPAN IN PAN TO FRM-MEN2.
       FIN-ELI-FUNC-WSS.
           EXIT.
      *>>>>
*% END
