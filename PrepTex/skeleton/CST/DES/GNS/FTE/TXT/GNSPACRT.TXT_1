*%! Codigo adicional
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03 WSS-COD-CTAB.
              05 WSS-COD-CTA1        PIC X(05).
              05 WSS-COD-CTA2        PIC X(02).
              05 WSS-COD-CTA3        PIC X(05).
              05 WSS-NUM-CTA3 REDEFINES WSS-COD-CTA3
                                     PIC 9(05).
           03 WSS-NUM-LMAX  VALUE 18 PIC 9(02).
           03 WSS-GLS-LINE.
              05 WSS-GLS-DESC        PIC X(40).
              05 WSS-GLS-DATA        PIC X(40).
       COPY GNSWGHOY.
       COPY GNSWGFEC.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-SISG NOT > SPACES
               MOVE SCR-SIST TO SCR-SISG.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
          MOVE SCR-SISG TO FIO-SIST.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
          IF FIO-STAT-OKS AND SCR-CCPP NOT = 'ING'
              PERFORM BUS-CRTA
              MOVE '00' TO FIO-STAT.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       BUS-CRTA SECTION.
       INI-BUS-CRTA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE SCR-SISG    TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DESC IN CRT-FLD.
           MOVE 0 TO FRM-IFLD.
       LUP-BUS-CRTA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE SCR-SISG    TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-COD-TTAB IN TAB = 'CRT' )
               GO TO FIN-BUS-CRTA.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.
           IF WSS-COD-CTA1 NOT = FRM-COD-CRTA IN CRT-FLD
               GO TO FIN-BUS-CRTA.
           IF WSS-COD-CTA2 NOT > SPACES
               GO TO LUP-BUS-CRTA.
           ADD 1 TO FRM-IFLD.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA.
           MOVE WSS-GLS-LINE TO FRM-GLS-LINE IN CRT-FLD(FRM-IFLD).
           IF FRM-IFLD < WSS-NUM-LMAX
               GO TO LUP-BUS-CRTA.
       FIN-BUS-CRTA.
           EXIT.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           PERFORM KEY-ALL-CRT.
           PERFORM ING-CRTA.
           GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM KEY-ALL-CRT.
           PERFORM MOD-CRTA.
           GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI
           PERFORM KEY-ALL-CRT.
           PERFORM ELI-CRTA.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       ING-CRTA SECTION.
       INI-ING-CRTA.
           PERFORM GET-FHOY.
           PERFORM LOD-RTAB.
           MOVE FRM-GLS-DESC IN CRT-FLD TO TAB-GLS-DESC IN TAB.
 
           MOVE FIO-PUT  TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ING-CRTA.
           MOVE WSS-NUM-LMAX TO FRM-IFLD.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.
       LUP-ING-CRTA.
           MOVE FRM-IFLD TO WSS-NUM-CTA3.
           MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB.
 
           PERFORM LOD-RTAB.
           MOVE FRM-GLS-LINE IN CRT-FLD(FRM-IFLD) TO WSS-GLS-LINE.
           MOVE WSS-GLS-DESC TO TAB-GLS-DESC IN TAB.
           MOVE WSS-GLS-DATA TO TAB-GLS-DATA IN TAB.

           MOVE FIO-PUT  TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ING-CRTA.
           IF FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD
               GO TO LUP-ING-CRTA.
       FIN-ING-CRTA.
           EXIT.

       MOD-CRTA SECTION.
       INI-MOD-CRTA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE SCR-SISG        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MOD-CRTA.

           PERFORM GET-FHOY.
           PERFORM LOD-RTAB.
           MOVE FRM-GLS-DESC IN CRT-FLD TO TAB-GLS-DESC IN TAB.

           MOVE FIO-MOD TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MOD-CRTA.
           MOVE WSS-NUM-LMAX TO FRM-IFLD.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.
       LUP-MOD-CRTA.
           MOVE FRM-IFLD TO WSS-NUM-CTA3.
           MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB.
 
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE SCR-SISG        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MOD-CRTA.

           PERFORM LOD-RTAB.
           MOVE FRM-GLS-LINE IN CRT-FLD(FRM-IFLD) TO WSS-GLS-LINE.
           MOVE WSS-GLS-DESC TO TAB-GLS-DESC IN TAB.
           MOVE WSS-GLS-DATA TO TAB-GLS-DATA IN TAB.

           MOVE FIO-MOD TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-MOD-CRTA.
           IF FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD
               GO TO LUP-MOD-CRTA.
       FIN-MOD-CRTA.
           EXIT.

       ELI-CRTA SECTION.
       INI-ELI-CRTA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE SCR-SISG        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ELI-CRTA.
           MOVE FIO-DEL TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ELI-CRTA.
           MOVE WSS-NUM-LMAX TO FRM-IFLD.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAB.
       LUP-ELI-CRTA.
           MOVE FRM-IFLD TO WSS-NUM-CTA3.
           MOVE WSS-COD-CTAB TO TAB-COD-CTAB IN TAB.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE SCR-SISG        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               GO TO NXT-ELI-CRTA.
           MOVE FIO-DEL TO FIO-CMND.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
       NXT-ELI-CRTA.
           IF FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD
               GO TO LUP-ELI-CRTA.
       FIN-ELI-CRTA.
           EXIT.

       LOD-RTAB SECTION.
       INI-LOD-RTAB.
           MOVE 'S'          TO TAB-MSC-STAT IN TAB.
           MOVE HOY-STP-ITRN TO TAB-STP-ITRN IN TAB.
           MOVE SCR-OTRN     TO TAB-COD-OTRN IN TAB.
           MOVE SCR-USER     TO TAB-COD-ATRN IN TAB.
           MOVE SPACES       TO TAB-GLS-FLAG IN TAB
                                TAB-SNX-TABL IN TAB.
       FIN-LOD-RTAB.
           EXIT.

       COPY GNSBGHOY.
       COPY GNSBGFEC.
      *>>>>
*% END
