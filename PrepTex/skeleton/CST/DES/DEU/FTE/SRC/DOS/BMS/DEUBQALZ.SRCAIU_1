      *
      * DEUBQALZ
      * Version 3.0.1 Nov-2005
      * 18-Jun-19 06:56 PM
      *
       SET-TAG-DEUBQALZ SECTION.
       INI-SET-TAG-DEUBQALZ.
           MOVE
           '<IDNMOD NOM=$DEUBQALZ$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$18-Jun-19 06:56 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DEUBQALZ.
           EXIT.
           
       PUT-ALL-ALZ SECTION.
       INI-PUT-ALL-ALZ.
           PERFORM PUT-FIA-ALZ.
           PERFORM PUT-ESC-ALZ.
       FIN-PUT-ALL-ALZ.
           EXIT.
       
       PUT-FIA-ALZ SECTION.
       INI-PUT-FIA-ALZ.
      *<<<< INI_PUT_FIA_ALZ
           IF PGM-STAT-FIA-NUL                                          
               GO TO FIN-PUT-FIA-ALZ.                                   
           IF NOT PGM-STAT-FIA-OKS                                      
               PERFORM CLR-FIA-ALZ                                      
               GO TO FIN-PUT-FIA-ALZ.    
      *<<<< INI_PUT_FIA_ALZ
           IF PGM-STAT-FIA-NUL
               GO TO FIN-PUT-FIA-ALZ.
           IF NOT PGM-STAT-FIA-OKS
               PERFORM CLR-FIA-ALZ
               GO TO FIN-PUT-FIA-ALZ.
           MOVE FIA-MSC-TVLF IN FIA TO FIA-MSC-TVLF IN ALZ-FLD.
           MOVE FIA-COD-TOFS IN FIA TO FIA-COD-TOFS IN ALZ-FLD.
           MOVE FIA-NUM-IFIA IN FIA TO FIA-NUM-IFIA IN ALZ-FLD.
           MOVE FIA-VAL-LIMF IN FIA TO FIA-VAL-LIMF IN ALZ-FLD.
           MOVE FIA-COD-VCLF IN FIA TO FIA-COD-VCLF IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-NUM-DVEN IN FIA TO FIA-NUM-DVEN IN ALZ-FLD.
           MOVE FIA-NUM-MVEN IN FIA TO FIA-NUM-MVEN IN ALZ-FLD.
           MOVE FIA-NUM-SVEN IN FIA TO FIA-NUM-SVEN IN ALZ-FLD.
           MOVE FIA-NUM-AVEN IN FIA TO FIA-NUM-AVEN IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-CAI-ICLI IN FIA TO FIA-CAI-ICLI IN ALZ-FLD.
           MOVE FIA-IIC-ICLI IN FIA TO FIA-IIC-ICLI IN ALZ-FLD.
           MOVE FIA-CAI-ICFS IN FIA TO FIA-CAI-ICFS IN ALZ-FLD.
           MOVE FIA-IIC-ICFS IN FIA TO FIA-IIC-ICFS IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-NUM-DSOL IN FIA TO FIA-NUM-DSOL IN ALZ-FLD.
           MOVE FIA-NUM-MSOL IN FIA TO FIA-NUM-MSOL IN ALZ-FLD.
           MOVE FIA-NUM-SSOL IN FIA TO FIA-NUM-SSOL IN ALZ-FLD.
           MOVE FIA-NUM-ASOL IN FIA TO FIA-NUM-ASOL IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-NUM-DAUT IN FIA TO FIA-NUM-DAUT IN ALZ-FLD.
           MOVE FIA-NUM-MAUT IN FIA TO FIA-NUM-MAUT IN ALZ-FLD.
           MOVE FIA-NUM-SAUT IN FIA TO FIA-NUM-SAUT IN ALZ-FLD.
           MOVE FIA-NUM-AAUT IN FIA TO FIA-NUM-AAUT IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-NUM-DALZ IN FIA TO FIA-NUM-DALZ IN ALZ-FLD.
           MOVE FIA-NUM-MALZ IN FIA TO FIA-NUM-MALZ IN ALZ-FLD.
           MOVE FIA-NUM-SALZ IN FIA TO FIA-NUM-SALZ IN ALZ-FLD.
           MOVE FIA-NUM-AALZ IN FIA TO FIA-NUM-AALZ IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE FIA-COD-RAUT IN FIA TO FIA-COD-RAUT IN ALZ-FLD.
           MOVE FIA-COD-ABOA IN FIA TO FIA-COD-ABOA IN ALZ-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-TOFS IN ALZ-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-TOFS IN ALZ-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOFS IN ALZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOFS IN ALZ-FLD.
      *<<<< FIN_PUT_FIA_ALZ
      *BUS-MSC busca glosa de miscelaneo en tabla                       
           IF FIA-MSC-TVLF IN ALZ-FLD > SPACES                          
               MOVE 'TAB' TO MSC-COD-SIST                               
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC                       
               MOVE FIA-MSC-TVLF IN ALZ-FLD TO MSC-COD-CMSC IN MSC      
               PERFORM BUS-MSC                                          
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVLF IN ALZ-FLD.     
           IF FIA-FEC-FSOL IN ALZ-FLD NOT > ZEROES                      
               MOVE SPACES TO FIA-FEC-FSOL IN ALZ-FLD.                  
           IF FIA-FEC-FAUT IN ALZ-FLD > ZEROES                          
      *BUS-USR busca usuario en tablas                                  
               IF FIA-COD-RAUT IN ALZ-FLD > SPACES                      
                   MOVE FIA-COD-RAUT IN ALZ-FLD TO USR-COD-USER IN USR  
                   PERFORM BUS-USR                                      
                   MOVE USR-GLS-DESC IN USR TO FRM-GLS-RAUT IN ALZ-FLD  
               ELSE                                                     
                   MOVE SPACES TO FIA-COD-RAUT IN ALZ-FLD               
           ELSE                                                         
               MOVE SPACES TO FIA-COD-RAUT IN ALZ-FLD                   
               MOVE SPACES TO FIA-FEC-FAUT IN ALZ-FLD.                  
      *MHM-INI 30-JUN-2006                                              
      *    IF FIA-FEC-FALZ IN ALZ-FLD > ZEROES                          
      *MHM-FIN 30-JUN-2006                                              
      *BUS-TAB busca glosa de codigo en tabla                           
               IF FIA-COD-ABOA IN ALZ-FLD > SPACES                      
                   MOVE 'TAB' TO TAB-COD-SIST                           
                   MOVE 'ABG' TO TAB-COD-TTAB IN TAB                    
                   MOVE FIA-COD-ABOA IN ALZ-FLD TO TAB-COD-CTAB IN TAB  
                   PERFORM BUS-TAB                                      
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ABOA IN ALZ-FLD  
               ELSE                                                     
      *MHM-INI 30-JUN-2006                                              
      *            MOVE SPACES TO FIA-COD-ABOA IN ALZ-FLD               
                   MOVE SPACES TO FIA-COD-ABOA IN ALZ-FLD.              
           IF FIA-FEC-FALZ IN ALZ-FLD NOT > ZEROES                      
               MOVE SPACES TO FIA-FEC-FALZ IN ALZ-FLD.                  
      *    ELSE                                                         
      *        MOVE SPACES TO FIA-COD-ABOA IN ALZ-FLD                   
      *        MOVE SPACES TO FIA-FEC-FALZ IN ALZ-FLD.                  
      *MHM-FIN 30-JUN-2006                                              
      *CIC-CLI Busca Cliente por medio de CIC                           
           MOVE FIA-CAI-ICLI IN ALZ-FLD TO DBC-CAI-ICLI IN DBC.         
           MOVE FIA-IIC-ICLI IN ALZ-FLD TO DBC-IIC-ICLI IN DBC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE ZEROES TO FRM-NUM-ICLI IN ALZ-FLD                   
               MOVE SPACES TO FRM-GLS-NOMC IN ALZ-FLD                   
               MOVE SPACES TO FRM-VRF-ICLI IN ALZ-FLD                   
               MOVE SPACES TO FRM-IND-ICLI IN ALZ-FLD                   
               MOVE SPACES TO FRM-GLS-ICLI IN ALZ-FLD                   
           ELSE                                                         
               PERFORM CPT-NOMC                                         
               MOVE CPT-STRN TO FRM-GLS-NOMC IN ALZ-FLD                 
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN ALZ-FLD      
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN ALZ-FLD      
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN ALZ-FLD      
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN ALZ-FLD.     
      *CIC-CLI Busca Cliente por medio de CIC                           
           MOVE FIA-CAI-ICFS IN ALZ-FLD TO DBC-CAI-ICLI IN DBC.         
           MOVE FIA-IIC-ICFS IN ALZ-FLD TO DBC-IIC-ICLI IN DBC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE ZEROES TO FRM-NUM-ICFS IN ALZ-FLD                   
               MOVE SPACES TO FRM-GLS-NOMF IN ALZ-FLD                   
               MOVE SPACES TO FRM-VRF-ICFS IN ALZ-FLD                   
               MOVE SPACES TO FRM-IND-ICFS IN ALZ-FLD                   
               MOVE SPACES TO FRM-GLS-ICFS IN ALZ-FLD                   
           ELSE                                                         
               PERFORM CPT-NOMC                                         
               MOVE CPT-STRN TO FRM-GLS-NOMF IN ALZ-FLD                 
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN ALZ-FLD      
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN ALZ-FLD      
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN ALZ-FLD      
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN ALZ-FLD.     
      *BUS-TAB busca glosa de codigo en tabla                           
           IF FIA-COD-VCLF IN ALZ-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB                        
               MOVE FIA-COD-VCLF IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCLF IN ALZ-FLD.     
      *>>>>
       FIN-PUT-FIA-ALZ.
           EXIT.
       
       PUT-ESC-ALZ SECTION.
       INI-PUT-ESC-ALZ.
      *<<<< INI_PUT_ESC_ALZ
           IF PGM-STAT-ESC-NUL                                          
               GO TO FIN-PUT-ESC-ALZ.                                   
           IF NOT PGM-STAT-ESC-OKS                                      
               PERFORM CLR-ESC-ALZ                                      
               GO TO FIN-PUT-ESC-ALZ.  
      *>>>> INI_PUT_ESC_ALZ
           IF PGM-STAT-ESC-NUL
               GO TO FIN-PUT-ESC-ALZ.
           IF NOT PGM-STAT-ESC-OKS
               PERFORM CLR-ESC-ALZ
               GO TO FIN-PUT-ESC-ALZ.
           MOVE ESC-COD-OFEF IN ESC TO ESC-COD-OFEF IN ALZ-FLD.
           MOVE ESC-CAI-IESC IN ESC TO ESC-CAI-IESC IN ALZ-FLD.
           MOVE ESC-IIC-IESC IN ESC TO ESC-IIC-IESC IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ESC-NUM-DCTT IN ESC TO ESC-NUM-DCTT IN ALZ-FLD.
           MOVE ESC-NUM-MCTT IN ESC TO ESC-NUM-MCTT IN ALZ-FLD.
           MOVE ESC-NUM-SCTT IN ESC TO ESC-NUM-SCTT IN ALZ-FLD.
           MOVE ESC-NUM-ACTT IN ESC TO ESC-NUM-ACTT IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE ESC-COD-NOTC IN ESC TO ESC-COD-NOTC IN ALZ-FLD.
           MOVE ESC-COD-RCTT IN ESC TO ESC-COD-RCTT IN ALZ-FLD.
           MOVE ESC-COD-ABOC IN ESC TO ESC-COD-ABOC IN ALZ-FLD.
      *BUS-OFI busca oficina en tablas
           IF ESC-COD-OFEF IN ALZ-FLD > SPACES
               MOVE ESC-COD-OFEF IN ALZ-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFEF IN ALZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFEF IN ALZ-FLD.
      *BUS-USR busca usuario en tablas
           IF ESC-COD-RCTT IN ALZ-FLD > SPACES
               MOVE ESC-COD-RCTT IN ALZ-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-RCTT IN ALZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-RCTT IN ALZ-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ESC-COD-ABOC IN ALZ-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ABG ' TO TAB-COD-TTAB IN TAB
               MOVE ESC-COD-ABOC IN ALZ-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ABOC IN ALZ-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ABOC IN ALZ-FLD.
      *<<<< FIN_PUT_ESC_ALZ
      *BUS-TAB busca glosa de codigo en tabla                           
           IF ESC-COD-NOTC IN ALZ-FLD > SPACES                          
               MOVE 'TAB' TO TAB-COD-SIST                               
               MOVE 'NOT' TO TAB-COD-TTAB IN TAB                        
               MOVE ESC-COD-NOTC IN ALZ-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-NOTC IN ALZ-FLD.    
      *>>>> FIN_PUT_ESC_ALZ
       FIN-PUT-ESC-ALZ.
           EXIT.
       
       KEY-ALL-ALZ SECTION.
       INI-KEY-ALL-ALZ.
           PERFORM KEY-FIA-ALZ.
           PERFORM KEY-ESC-ALZ.
       FIN-KEY-ALL-ALZ.
           EXIT.
       
       KEY-FIA-ALZ SECTION.
       INI-KEY-FIA-ALZ.
           MOVE FIA-NUM-IFIA IN ALZ-FLD TO FIA-NUM-IFIA IN FIA.
      *<<<< FIN_RET_FIA_ALZ OR FIN_KEY_FIA_ALZ
           MOVE ESC-CAI-IESC IN ALZ-FLD TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN ALZ-FLD TO FIA-IIC-IESC IN FIA.
      *>>>>
       FIN-KEY-FIA-ALZ.
           EXIT.
       
       KEY-ESC-ALZ SECTION.
       INI-KEY-ESC-ALZ.
           MOVE ESC-CAI-IESC IN ALZ-FLD TO ESC-CAI-IESC IN ESC.
           MOVE ESC-IIC-IESC IN ALZ-FLD TO ESC-IIC-IESC IN ESC.
       FIN-KEY-ESC-ALZ.
           EXIT.
       
       SCR-CLRA-ALZ SECTION.
       INI-SCR-CLRA-ALZ.
           PERFORM CLR-KEY-ALZ.
           PERFORM CLR-FLD-ALZ.
       FIN-SCR-CLRA-ALZ.
           EXIT.
       
       CLR-KEY-ALZ SECTION.
       INI-CLR-KEY-ALZ.
           MOVE SPACES TO ESC-CAI-IESC IN ALZ-FLD.
           MOVE ZEROES TO ESC-IIC-IESC IN ALZ-FLD.
           MOVE ZEROES TO FIA-NUM-IFIA IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-NOMF IN ALZ-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN ALZ-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN ALZ-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICFS IN ALZ-FLD.
           MOVE SPACES TO FRM-VRF-ICFS IN ALZ-FLD.
           MOVE SPACES TO FRM-IND-ICFS IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-ICFS IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-ALZ.
           EXIT.
       
       CLR-FLD-ALZ SECTION.
       INI-CLR-FLD-ALZ.
           MOVE SPACES TO FRM-GLS-TVLF IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-TOFS IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-OFEF IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-NOTC IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-RCTT IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-ABOC IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-VCLF IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-RAUT IN ALZ-FLD.
           MOVE SPACES TO FRM-GLS-ABOA IN ALZ-FLD.
           PERFORM CLR-FIA-ALZ.
           PERFORM CLR-ESC-ALZ.
       FIN-CLR-FLD-ALZ.
           EXIT.
       
       CLR-FIA-ALZ SECTION.
       INI-CLR-FIA-ALZ.
           MOVE SPACES TO FIA-MSC-TVLF IN ALZ-FLD.
           MOVE SPACES TO FIA-COD-TOFS IN ALZ-FLD.
           MOVE ZEROES TO FIA-VAL-LIMF IN ALZ-FLD.
           MOVE SPACES TO FIA-COD-VCLF IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FIA-FEC-FVEN IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FIA-CAI-ICLI IN ALZ-FLD.
           MOVE SPACES TO FIA-IIC-ICLI IN ALZ-FLD.
           MOVE SPACES TO FIA-CAI-ICFS IN ALZ-FLD.
           MOVE SPACES TO FIA-IIC-ICFS IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FIA-FEC-FSOL IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FIA-FEC-FAUT IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FIA-FEC-FALZ IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FIA-COD-RAUT IN ALZ-FLD.
           MOVE SPACES TO FIA-COD-ABOA IN ALZ-FLD.
       FIN-CLR-FIA-ALZ.
           EXIT.
       
       CLR-ESC-ALZ SECTION.
       INI-CLR-ESC-ALZ.
           MOVE SPACES TO ESC-COD-OFEF IN ALZ-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ESC-FEC-FCTT IN ALZ-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ESC-COD-NOTC IN ALZ-FLD.
           MOVE SPACES TO ESC-COD-RCTT IN ALZ-FLD.
           MOVE SPACES TO ESC-COD-ABOC IN ALZ-FLD.
       FIN-CLR-ESC-ALZ.
           EXIT.
       
       FST-KEY-ALZ SECTION.
       INI-FST-KEY-ALZ.
           MOVE -1 TO ESC-CAI-IESC-LEN IN ALZ-FLD.
       FIN-FST-KEY-ALZ.
           EXIT.
       
       FST-FLD-ALZ SECTION.
       INI-FST-FLD-ALZ.
           MOVE FRM-POS-CURS TO FIA-FEC-FSOL-LEN IN ALZ-FLD.
       FIN-FST-FLD-ALZ.
           EXIT.
       
       PRO-KEY-ALZ SECTION.
       INI-PRO-KEY-ALZ.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMF-ATR IN ALZ-FLD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICFS-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           PERFORM PRO-IKY-ALZ.
           PERFORM PRO-AKY-ALZ.
           PERFORM PRO-MKY-ALZ.
       FIN-PRO-KEY-ALZ.
           EXIT.
       
       PRO-IKY-ALZ SECTION.
       INI-PRO-IKY-ALZ.
           MOVE FRM-CPIM-AEY TO ESC-CAI-IESC-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO ESC-IIC-IESC-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FIA-NUM-IFIA-ATR IN ALZ-FLD.
       FIN-PRO-IKY-ALZ.
           EXIT.
       
       PRO-MKY-ALZ SECTION.
       INI-PRO-MKY-ALZ.
       FIN-PRO-MKY-ALZ.
           EXIT.
       
       PRO-AKY-ALZ SECTION.
       INI-PRO-AKY-ALZ.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMF-ATR IN ALZ-FLD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICFS-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-AKY-ALZ.
           EXIT.
       
       UNP-KEY-ALZ SECTION.
       INI-UNP-KEY-ALZ.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMC-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMF-ATR IN ALZ-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICFS-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           PERFORM UNP-IKY-ALZ.
           PERFORM UNP-AKY-ALZ.
           PERFORM UNP-MKY-ALZ.
       FIN-UNP-KEY-ALZ.
           EXIT.
       
       UNP-IKY-ALZ SECTION.
       INI-UNP-IKY-ALZ.
           MOVE FRM-CPIM-UBY TO ESC-CAI-IESC-ATR.
           MOVE FRM-CPIM-UBY TO ESC-IIC-IESC-ATR.
           MOVE FRM-CPIM-UBY TO FIA-NUM-IFIA-ATR.
       FIN-UNP-IKY-ALZ.
           EXIT.
       
       UNP-MKY-ALZ SECTION.
       INI-UNP-MKY-ALZ.
       FIN-UNP-MKY-ALZ.
           EXIT.
       
       UNP-AKY-ALZ SECTION.
       INI-UNP-AKY-ALZ.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMC-ATR.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMF-ATR.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICFS-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICFS-ATR IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-AKY-ALZ.
           EXIT.
       
       UNP-FLD-ALZ SECTION.
       INI-UNP-FLD-ALZ.
           PERFORM UNP-FIA-ALZ.
           PERFORM UNP-ESC-ALZ.
       FIN-UNP-FLD-ALZ.
           EXIT.
       
       UNP-FIA-ALZ SECTION.
       INI-UNP-FIA-ALZ.
           MOVE FRM-CPIM-UBY TO FIA-FEC-FSOL-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FIA-FEC-FAUT-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FIA-FEC-FALZ-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FIA-COD-RAUT-ATR IN ALZ-FLD.
           MOVE FRM-CPIM-UBY TO FIA-COD-ABOA-ATR IN ALZ-FLD.
       FIN-UNP-FIA-ALZ.
           EXIT.
       
       UNP-ESC-ALZ SECTION.
       INI-UNP-ESC-ALZ.
       FIN-UNP-ESC-ALZ.
           EXIT.
       
       VAL-KEY-ALZ SECTION.
       INI-VAL-KEY-ALZ.
           PERFORM VAL-IKY-ALZ.
           PERFORM VAL-MKY-ALZ.
           PERFORM VAL-AKY-ALZ.
       FIN-VAL-KEY-ALZ.
           EXIT.
       
       VAL-IKY-ALZ SECTION.
       INI-VAL-IKY-ALZ.
           PERFORM VAL-ESC-CAI-IESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ESC-CAI-IESC-LEN IN ALZ-FLD
                GO TO FIN-VAL-IKY-ALZ.
           PERFORM VAL-ESC-IIC-IESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ESC-IIC-IESC-LEN IN ALZ-FLD
                GO TO FIN-VAL-IKY-ALZ.
           PERFORM VAL-FIA-NUM-IFIA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FIA-NUM-IFIA-LEN IN ALZ-FLD
                GO TO FIN-VAL-IKY-ALZ.
       FIN-VAL-IKY-ALZ.
           EXIT.
       
       VAL-MKY-ALZ SECTION.
       INI-VAL-MKY-ALZ.
       FIN-VAL-MKY-ALZ.
           EXIT.
       
       VAL-AKY-ALZ SECTION.
       INI-VAL-AKY-ALZ.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-GLS-NOMF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMF-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-IND-ICLI-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-GLS-ICLI-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-ICLI-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-ICLI-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-IND-ICFS-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-GLS-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-GLS-ICFS-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-NUM-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-ICFS-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
           PERFORM VAL-FRM-VRF-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-ICFS-LEN IN ALZ-FLD
                GO TO FIN-VAL-AKY-ALZ.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-AKY-ALZ.
           EXIT.
       
       VAL-ESC-CAI-IESC SECTION.
       INI-VAL-ESC-CAI-IESC.
           IF ESC-CAI-IESC IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO ESC-CAI-IESC IN ALZ-FLD.
      *<<<< ESC_CAI_IESC
      *>>>>
       FIN-VAL-ESC-CAI-IESC.
           EXIT.
       
       VAL-ESC-IIC-IESC SECTION.
       INI-VAL-ESC-IIC-IESC.
      *<<<< ESC_IIC_IESC
      *>>>>
       FIN-VAL-ESC-IIC-IESC.
           EXIT.
       
       VAL-FIA-NUM-IFIA SECTION.
       INI-VAL-FIA-NUM-IFIA.
       FIN-VAL-FIA-NUM-IFIA.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
           IF FRM-GLS-NOMC IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-NOMC IN ALZ-FLD.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-FRM-GLS-NOMF SECTION.
       INI-VAL-FRM-GLS-NOMF.
           IF FRM-GLS-NOMF IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-NOMF IN ALZ-FLD.
       FIN-VAL-FRM-GLS-NOMF.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.

       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
      *<<<< INI_FRM_VRF_ICLI
      *     IF FRM-NUM-ICLI IN ALZ-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-VRF-ICLI.
      *>>>>
           IF FRM-VRF-ICLI IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN ALZ-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE FRM-NUM-ICLI IN ALZ-FLD TO IDC-NUM-RUTV.
           MOVE FRM-VRF-ICLI IN ALZ-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< FRM_VRF_ICLI
           IF FRM-NUM-ICLI IN ALZ-FLD NOT > ZEROES                      
               GO TO FIN-VAL-FRM-VRF-ICLI.                              
      *VAL-RUT Valida Rut                                               
           MOVE FRM-NUM-ICLI IN ALZ-FLD TO IDC-NUM-RUTV.                
           MOVE FRM-VRF-ICLI IN ALZ-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.
      *>>>> FRM_VRF_ICLI
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
           IF FRM-IND-ICLI IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICLI IN ALZ-FLD.
      *VAL-IDC Valida identificador
           MOVE FRM-IND-ICLI IN ALZ-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO FRM-IND-ICLI IN ALZ-FLD.
      *<<<< FRM_IND_ICLI                                                
      *VAL-IND o VAL-IDC Valida identificador                           
           MOVE FRM-IND-ICLI IN ALZ-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO FRM-IND-ICLI IN ALZ-FLD.                
      *>>>> FRM_IND_ICLI                                                 
       FIN-VAL-FRM-IND-ICLI.
           EXIT.

       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
           IF FRM-GLS-ICLI IN ALZ-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO FRM-GLS-ICLI IN ALZ-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICLI IN ALZ-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN ALZ-FLD.
      *<<<< FRM_GLS_ICLI                                                
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador    
           MOVE FRM-GLS-ICLI IN ALZ-FLD TO IDC-GLS-RUTV.                
           PERFORM VAL-GLS.                                             
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN ALZ-FLD.                
      *>>>> FRM_GLS_ICLI                                                   
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-FRM-NUM-ICFS SECTION.
       INI-VAL-FRM-NUM-ICFS.
       FIN-VAL-FRM-NUM-ICFS.
           EXIT.

       VAL-FRM-VRF-ICFS SECTION.
       INI-VAL-FRM-VRF-ICFS.
      *<<<< INI_FRM_VRF_ICFS
      *     IF FRM-NUM-ICFS IN ALZ-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-VRF-ICFS.
      *>>>>
           IF FRM-VRF-ICFS IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICFS IN ALZ-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE FRM-NUM-ICFS IN ALZ-FLD TO IDC-NUM-RUTV.
           MOVE FRM-VRF-ICFS IN ALZ-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< FRM_VRF_ICFS
           IF FRM-NUM-ICFS IN ALZ-FLD NOT > ZEROES                      
               GO TO FIN-VAL-FRM-VRF-ICFS.                              
      *VAL-RUT Valida Rut                                               
           MOVE FRM-NUM-ICFS IN ALZ-FLD TO IDC-NUM-RUTV.                
           MOVE FRM-VRF-ICFS IN ALZ-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT. 
      *>>>> FRM_VRF_ICFS
       FIN-VAL-FRM-VRF-ICFS.
           EXIT.
       VAL-FRM-IND-ICFS SECTION.
       INI-VAL-FRM-IND-ICFS.
           IF FRM-IND-ICFS IN ALZ-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICFS IN ALZ-FLD.
      *VAL-IDC Valida identificador
           MOVE FRM-IND-ICFS IN ALZ-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO FRM-IND-ICFS IN ALZ-FLD.
      *<<<< FRM_IND_ICFS
      *VAL-IND o VAL-IDC Valida identificador                           
           MOVE FRM-IND-ICFS IN ALZ-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO FRM-IND-ICFS IN ALZ-FLD. 
      *>>>> FRM_IND_ICFS
       FIN-VAL-FRM-IND-ICFS.
           EXIT.

       VAL-FRM-GLS-ICFS SECTION.
       INI-VAL-FRM-GLS-ICFS.
           IF FRM-GLS-ICFS IN ALZ-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO FRM-GLS-ICFS IN ALZ-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICFS IN ALZ-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICFS IN ALZ-FLD.
      *<<<< FRM_GLS_ICFS
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador    
           MOVE FRM-GLS-ICFS IN ALZ-FLD TO IDC-GLS-RUTV.                
           PERFORM VAL-GLS.                                             
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICFS IN ALZ-FLD.
      *>>>> FRM_GLS_ICFS
       FIN-VAL-FRM-GLS-ICFS.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-KEY-ALZ SECTION.
       INI-VAL-CON-KEY-ALZ.
      *<<<<
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-ALZ.
      *>>>>
           IF     ESC-CAI-IESC IN ALZ-FLD NOT > SPACES 
              AND ESC-IIC-IESC IN ALZ-FLD NOT > ZEROES 
              AND FIA-NUM-IFIA IN ALZ-FLD NOT > ZEROES 
              AND FRM-GLS-NOMC IN ALZ-FLD NOT > SPACES 
              AND FRM-GLS-NOMF IN ALZ-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND FRM-NUM-ICLI IN ALZ-FLD NOT > ZEROES
              AND FRM-VRF-ICLI IN ALZ-FLD NOT > SPACES
              AND FRM-IND-ICLI IN ALZ-FLD NOT > SPACES
              AND FRM-GLS-ICLI IN ALZ-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND FRM-NUM-ICFS IN ALZ-FLD NOT > ZEROES
              AND FRM-VRF-ICFS IN ALZ-FLD NOT > SPACES
              AND FRM-IND-ICFS IN ALZ-FLD NOT > SPACES
              AND FRM-GLS-ICFS IN ALZ-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-ALZ.
      *<<<< FIN_VAL_CON_KEY_ALZ
           IF NOT (   ESC-IIC-IESC IN ALZ-FLD > ZEROES   OR             
                    ( ESC-IIC-IESC IN ALZ-FLD > ZEROES   AND            
                      FIA-NUM-IFIA IN ALZ-FLD > ZEROES ) OR             
                    ( FRM-NUM-ICLI IN ALZ-FLD > ZEROES   AND            
                      FRM-NUM-ICFS IN ALZ-FLD > ZEROES ) OR             
                    ( FRM-NUM-ICLI IN ALZ-FLD > ZEROES ) OR             
                    ( FRM-NUM-ICFS IN ALZ-FLD > ZEROES ) OR             
                    ( FRM-GLS-NOMC IN ALZ-FLD > SPACES   AND            
                      FRM-GLS-NOMF IN ALZ-FLD > SPACES ) OR             

                    ( FRM-GLS-NOMC IN ALZ-FLD > SPACES ) OR             

                    ( FRM-GLS-NOMF IN ALZ-FLD > SPACES ) )              
               MOVE 'GNS'          TO MSG-COD-SIST                      
               MOVE 'VALCONKEY' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-KEY-ALZ.
           EXIT.
       
       VAL-CON-IKY-ALZ SECTION.
       INI-VAL-CON-IKY-ALZ.
           IF     ESC-CAI-IESC IN ALZ-FLD NOT > SPACES 
              AND ESC-IIC-IESC IN ALZ-FLD NOT > ZEROES 
              AND FIA-NUM-IFIA IN ALZ-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-ALZ.
       FIN-VAL-CON-IKY-ALZ.
           EXIT.
       
       VAL-NUM-KEY-ALZ SECTION.
       INI-VAL-NUM-KEY-ALZ.
           PERFORM VAL-NUM-IKY-ALZ.
           PERFORM VAL-NUM-MKY-ALZ.
           PERFORM VAL-NUM-AKY-ALZ.
       FIN-VAL-NUM-KEY-ALZ.
           EXIT.
       
       VAL-NUM-IKY-ALZ SECTION.
       INI-VAL-NUM-IKY-ALZ.
       VAL-NUM-ESC-IIC-IESC.
           MOVE ESC-IIC-IESC-ALF IN ALZ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ESC-IIC-IESC IN ALZ-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ESC-IIC-IESC-LEN IN ALZ-FLD
                GO TO FIN-VAL-NUM-IKY-ALZ.
       VAL-NUM-FIA-NUM-IFIA.
           MOVE FIA-NUM-IFIA-ALF IN ALZ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FIA-NUM-IFIA IN ALZ-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FIA-NUM-IFIA-LEN IN ALZ-FLD
                GO TO FIN-VAL-NUM-IKY-ALZ.
       FIN-VAL-NUM-IKY-ALZ.
           EXIT.
       
       VAL-NUM-MKY-ALZ SECTION.
       INI-VAL-NUM-MKY-ALZ.
       FIN-VAL-NUM-MKY-ALZ.
           EXIT.
       
       VAL-NUM-AKY-ALZ SECTION.
       INI-VAL-NUM-AKY-ALZ.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN ALZ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN ALZ-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN ALZ-FLD
                GO TO FIN-VAL-NUM-AKY-ALZ.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICFS.
           MOVE FRM-NUM-ICFS-ALF IN ALZ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICFS IN ALZ-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICFS-LEN IN ALZ-FLD
                GO TO FIN-VAL-NUM-AKY-ALZ.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-AKY-ALZ.
           EXIT.
       
       VAL-NUM-FLD-ALZ SECTION.
       INI-VAL-NUM-FLD-ALZ.
       VAL-NUM-FIA-VAL-LIMF.
           MOVE FIA-VAL-LIMF-ALF IN ALZ-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FIA-VAL-LIMF IN ALZ-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FIA-VAL-LIMF-LEN IN ALZ-FLD
                GO TO FIN-VAL-NUM-FLD-ALZ.
       FIN-VAL-NUM-FLD-ALZ.
           EXIT.
       
       EDT-KEY-ALZ SECTION.
       INI-EDT-KEY-ALZ.
           PERFORM EDT-IKY-ALZ.
           PERFORM EDT-MKY-ALZ.
           PERFORM EDT-AKY-ALZ.
       FIN-EDT-KEY-ALZ.
           EXIT.
       
       EDT-IKY-ALZ SECTION.
       INI-EDT-IKY-ALZ.
           IF ESC-IIC-IESC-LEN IN ALZ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ESC-IIC-IESC-LEN IN ALZ-FLD
                GO TO FIN-EDT-IKY-ALZ.
           MOVE ESC-IIC-IESC IN ALZ-FLD TO ESC-IIC-IESC-EDT IN ALZ-EDT.
           MOVE ESC-IIC-IESC-EDT IN ALZ-EDT TO 
                ESC-IIC-IESC-ALF IN ALZ-FLD.
           IF FIA-NUM-IFIA-LEN IN ALZ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FIA-NUM-IFIA-LEN IN ALZ-FLD
                GO TO FIN-EDT-IKY-ALZ.
           MOVE FIA-NUM-IFIA IN ALZ-FLD TO FIA-NUM-IFIA-EDT IN ALZ-EDT.
           MOVE FIA-NUM-IFIA-EDT IN ALZ-EDT TO 
                FIA-NUM-IFIA-ALF IN ALZ-FLD.
       FIN-EDT-IKY-ALZ.
           EXIT.
       
       EDT-MKY-ALZ SECTION.
       INI-EDT-MKY-ALZ.
       FIN-EDT-MKY-ALZ.
           EXIT.
       
       EDT-AKY-ALZ SECTION.
       INI-EDT-AKY-ALZ.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN ALZ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN ALZ-FLD
                GO TO FIN-EDT-AKY-ALZ.
           MOVE FRM-NUM-ICLI IN ALZ-FLD TO
                FRM-NUM-ICLI-EDT IN ALZ-EDT.
           MOVE FRM-NUM-ICLI-EDT IN ALZ-EDT TO
                FRM-NUM-ICLI-ALF IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICFS-LEN IN ALZ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICFS-LEN IN ALZ-FLD
                GO TO FIN-EDT-AKY-ALZ.
           MOVE FRM-NUM-ICFS IN ALZ-FLD TO
                FRM-NUM-ICFS-EDT IN ALZ-EDT.
           MOVE FRM-NUM-ICFS-EDT IN ALZ-EDT TO
                FRM-NUM-ICFS-ALF IN ALZ-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-AKY-ALZ.
           EXIT.
       
       EDT-FLD-ALZ SECTION.
       INI-EDT-FLD-ALZ.
           IF FIA-VAL-LIMF-LEN IN ALZ-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FIA-VAL-LIMF-LEN IN ALZ-FLD
                GO TO FIN-EDT-FLD-ALZ.
           MOVE FIA-VAL-LIMF IN ALZ-FLD TO FIA-VAL-LIMF-EDT IN ALZ-EDT.
           MOVE FIA-VAL-LIMF-EDT IN ALZ-EDT TO 
                FIA-VAL-LIMF-ALF IN ALZ-FLD.
       FIN-EDT-FLD-ALZ.
           EXIT.
      *<<<<
      *IMV-INI 10-MAR-2015 PENTA               
       PRO-FLD-ALZ SECTION.                                             
       INI-PRO-FLD-ALZ.                                                 
           PERFORM PRO-FIA-ALZ.                                         
           PERFORM PRO-ESC-ALZ.                                         
       FIN-PRO-FLD-ALZ.                                                 
           EXIT.                                                        
       PRO-FIA-ALZ SECTION.                                             
       INI-PRO-FIA-ALZ.                                                 
           MOVE FRM-CPIM-AEY TO FIA-FEC-FSOL-ATR IN ALZ-FLD.            
           MOVE FRM-CPIM-AEY TO FIA-FEC-FAUT-ATR IN ALZ-FLD.            
           MOVE FRM-CPIM-AEY TO FIA-FEC-FALZ-ATR IN ALZ-FLD.            
           MOVE FRM-CPIM-AEY TO FIA-COD-RAUT-ATR IN ALZ-FLD.            
           MOVE FRM-CPIM-AEY TO FIA-COD-ABOA-ATR IN ALZ-FLD.            
       FIN-PRO-FIA-ALZ.                                                 
           EXIT.                                                        
       PRO-ESC-ALZ SECTION.                                             
       INI-PRO-ESC-ALZ.                                                 
       FIN-PRO-ESC-ALZ.                                                 
           EXIT.                                                        
      *IMV-FIN 10-MAR-2015 PENTA 
      *>>>>
