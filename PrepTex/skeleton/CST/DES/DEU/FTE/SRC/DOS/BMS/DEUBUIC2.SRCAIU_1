      *
      * DEUBUIC2
      * Version 3.0.1 Nov-2005
      * 24-Jun-19 11:28 AM
      *
       SET-TAG-DEUBUIC2 SECTION.
       INI-SET-TAG-DEUBUIC2.
           MOVE
           '<IDNMOD NOM=$DEUBUIC2$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$24-Jun-19 11:28 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DEUBUIC2.
           EXIT.
           
       RET-ALL-IC2 SECTION.
       INI-RET-ALL-IC2.
           PERFORM KEY-ALL-IC2.
           PERFORM RET-CIP-IC2.
       FIN-RET-ALL-IC2.
           EXIT.
       
       RET-CIP-IC2 SECTION.
       INI-RET-CIP-IC2.
      *<<<< INI_RET_CIP_IC2
           MOVE CIP-COD-CPTO IN IC2-FLD TO CIP-COD-CPTO IN CIP.
           MOVE CIP-NUM-DCOL IN IC2-FLD TO CIP-NUM-DCOL IN CIP.
           MOVE CIP-NUM-MCOL IN IC2-FLD TO CIP-NUM-MCOL IN CIP.
           MOVE CIP-NUM-SCOL IN IC2-FLD TO CIP-NUM-SCOL IN CIP.
           MOVE CIP-NUM-ACOL IN IC2-FLD TO CIP-NUM-ACOL IN CIP.
           MOVE CIP-NUM-DMAV IN IC2-FLD TO CIP-NUM-DMAV IN CIP.
           MOVE CIP-NUM-MMAV IN IC2-FLD TO CIP-NUM-MMAV IN CIP.
           MOVE CIP-NUM-SMAV IN IC2-FLD TO CIP-NUM-SMAV IN CIP.
           MOVE CIP-NUM-AMAV IN IC2-FLD TO CIP-NUM-AMAV IN CIP.
           MOVE CIP-VAL-SIMO IN IC2-FLD TO CIP-VAL-SIMO IN CIP.
           MOVE CIP-SGV-TOPE IN IC2-FLD TO CIP-SGV-TOPE IN CIP.
           MOVE CIP-SGV-TINT IN IC2-FLD TO CIP-SGV-TINT IN CIP.
           MOVE CIP-NUM-DINI IN IC2-FLD TO CIP-NUM-DINI IN CIP.
           MOVE CIP-NUM-MINI IN IC2-FLD TO CIP-NUM-MINI IN CIP.
           MOVE CIP-NUM-SINI IN IC2-FLD TO CIP-NUM-SINI IN CIP.
           MOVE CIP-NUM-AINI IN IC2-FLD TO CIP-NUM-AINI IN CIP.
           MOVE CIP-NUM-DTER IN IC2-FLD TO CIP-NUM-DTER IN CIP.
           MOVE CIP-NUM-MTER IN IC2-FLD TO CIP-NUM-MTER IN CIP.
           MOVE CIP-NUM-STER IN IC2-FLD TO CIP-NUM-STER IN CIP.
           MOVE CIP-NUM-ATER IN IC2-FLD TO CIP-NUM-ATER IN CIP.
           MOVE CIP-NUM-PTRM IN IC2-FLD TO CIP-NUM-PTRM IN CIP.
           MOVE CIP-SGV-CUOT IN IC2-FLD TO CIP-SGV-CUOT IN CIP.
           MOVE CIP-NUM-FOLI IN IC2-FLD TO CIP-NUM-FOLI IN CIP.
           IF CIP-GLS-NORM IN IC2-FLD = SPACES
               MOVE WCC-DL20130 IN WSS-VARI TO CIP-GLS-NORM IN CIP
           ELSE
               MOVE CIP-GLS-NORM IN IC2-FLD TO CIP-GLS-NORM IN CIP.
           MOVE CIP-COD-TIPO IN IC2-FLD TO CIP-COD-TIPO IN CIP.

           MOVE WCC-HIS      IN WSS-VARI TO CIP-COD-EVEN IN CIP.
           MOVE WCC-1        IN WSS-VARI TO CIP-NUM-ICAN IN CIP.
           MOVE WCC-1        IN WSS-VARI TO CIP-NUM-CPTO IN CIP.
           MOVE CIP-FEC-FCOL IN CIP      TO CIP-FEC-FORI IN CIP.
           MOVE CIP-NUM-PTRM IN CIP      TO CIP-VAL-CTRA IN CIP.
           MOVE CIP-SGV-TINT IN CIP      TO CIP-SGV-TACU IN CIP.
           IF CIP-NUM-PTRM IN CIP > ZEROES
               COMPUTE CIP-SGV-TUNI IN CIP = CIP-SGV-TINT IN CIP /
                                                   CIP-NUM-PTRM IN CIP
           ELSE
               MOVE ZEROES TO CIP-SGV-TUNI IN CIP.

           MOVE CIP-SGV-MNTO IN IC2-FLD  TO CIP-SGV-MNTO IN CIP.
           IF CIP-COD-MONE IN CIP = WCC-PESOS
               MOVE CIP-SGV-MNTO IN CIP TO CIP-SGV-MORI IN CIP
           ELSE
               MOVE SPACES TO CAM
               MOVE CIP-COD-MONE IN CIP TO CAM-COD-VCAM IN CAM(1)
               MOVE WCC-PESOS IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE CIP-FEC-FCOL IN CIP TO CAM-FEC-FCAM IN CAM(1)
               MOVE CIP-FEC-FCOL IN CIP TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS OR CAM-MSC-STAT IN CAM NOT = WCC-S
                   MOVE ZEROES TO CIP-SGV-MORI IN CIP
               ELSE
                   COMPUTE CIP-SGV-MORI IN CIP = CIP-SGV-MNTO IN CIP /
                                                 CAM-SGV-VCAM IN CAM.

           COMPUTE CIP-SGV-VTOT IN CIP = CIP-SGV-CUOT IN CIP -
                                         CIP-SGV-VDES IN CIP.

           IF CIP-SGV-VTOT IN CIP NOT > ZEROES
               MOVE ZEROES TO CIP-SGV-VTOT IN CIP.

           MOVE CIP-SGV-VTOT IN CIP TO CIP-SGV-MCAL IN CIP.
           MOVE CIP-FEC-FTER IN CIP TO CIP-FEC-TTRI IN CIP.
           MOVE CIP-NUM-PTRM IN CIP TO CIP-VAL-CTRA IN CIP.
           MOVE CIP-FEC-FMAV IN CIP TO CIP-FEC-FVEN IN CIP.
           MOVE CIP-COD-TIPO IN CIP TO CIP-MSC-STAT IN CIP.
           MOVE WCC-N TO CIP-IND-DUSO IN CIP.

           GO TO FIN-RET-CIP-IC2.
      *>>>>
           MOVE CIP-COD-CPTO IN IC2-FLD TO CIP-COD-CPTO IN CIP.
           MOVE CIP-COD-TIPO IN IC2-FLD TO CIP-COD-TIPO IN CIP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-NUM-DCOL IN IC2-FLD TO CIP-NUM-DCOL IN CIP.
           MOVE CIP-NUM-MCOL IN IC2-FLD TO CIP-NUM-MCOL IN CIP.
           MOVE CIP-NUM-SCOL IN IC2-FLD TO CIP-NUM-SCOL IN CIP.
           MOVE CIP-NUM-ACOL IN IC2-FLD TO CIP-NUM-ACOL IN CIP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-NUM-DMAV IN IC2-FLD TO CIP-NUM-DMAV IN CIP.
           MOVE CIP-NUM-MMAV IN IC2-FLD TO CIP-NUM-MMAV IN CIP.
           MOVE CIP-NUM-SMAV IN IC2-FLD TO CIP-NUM-SMAV IN CIP.
           MOVE CIP-NUM-AMAV IN IC2-FLD TO CIP-NUM-AMAV IN CIP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-SGV-MNTO IN IC2-FLD TO CIP-SGV-MNTO IN CIP.
           MOVE CIP-VAL-SIMO IN IC2-FLD TO CIP-VAL-SIMO IN CIP.
           MOVE CIP-SGV-TOPE IN IC2-FLD TO CIP-SGV-TOPE IN CIP.
           MOVE CIP-SGV-TINT IN IC2-FLD TO CIP-SGV-TINT IN CIP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-NUM-DINI IN IC2-FLD TO CIP-NUM-DINI IN CIP.
           MOVE CIP-NUM-MINI IN IC2-FLD TO CIP-NUM-MINI IN CIP.
           MOVE CIP-NUM-SINI IN IC2-FLD TO CIP-NUM-SINI IN CIP.
           MOVE CIP-NUM-AINI IN IC2-FLD TO CIP-NUM-AINI IN CIP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-NUM-DTER IN IC2-FLD TO CIP-NUM-DTER IN CIP.
           MOVE CIP-NUM-MTER IN IC2-FLD TO CIP-NUM-MTER IN CIP.
           MOVE CIP-NUM-STER IN IC2-FLD TO CIP-NUM-STER IN CIP.
           MOVE CIP-NUM-ATER IN IC2-FLD TO CIP-NUM-ATER IN CIP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CIP-NUM-PTRM IN IC2-FLD TO CIP-NUM-PTRM IN CIP.
           MOVE CIP-SGV-CUOT IN IC2-FLD TO CIP-SGV-CUOT IN CIP.
           MOVE CIP-NUM-FOLI IN IC2-FLD TO CIP-NUM-FOLI IN CIP.
           MOVE CIP-GLS-NORM IN IC2-FLD TO CIP-GLS-NORM IN CIP.
       FIN-RET-CIP-IC2.
           EXIT.
       
       KEY-ALL-IC2 SECTION.
       INI-KEY-ALL-IC2.
           PERFORM KEY-CIP-IC2.
       FIN-KEY-ALL-IC2.
           EXIT.
       
       KEY-CIP-IC2 SECTION.
       INI-KEY-CIP-IC2.
           MOVE CIP-CAI-ICER IN IC2-FLD TO CIP-CAI-ICER IN CIP.
           MOVE CIP-IIC-ICER IN IC2-FLD TO CIP-IIC-ICER IN CIP.
           MOVE CIP-NUM-ICIP IN IC2-FLD TO CIP-NUM-ICIP IN CIP.
       FIN-KEY-CIP-IC2.
           EXIT.
       
       SCR-CLRA-IC2 SECTION.
       INI-SCR-CLRA-IC2.
           PERFORM CLR-KEY-IC2.
           PERFORM CLR-FLD-IC2.
       FIN-SCR-CLRA-IC2.
           EXIT.
       
       CLR-KEY-IC2 SECTION.
       INI-CLR-KEY-IC2.
           MOVE SPACES TO CIP-CAI-ICER IN IC2-FLD.
           MOVE ZEROES TO CIP-IIC-ICER IN IC2-FLD.
           MOVE ZEROES TO CIP-NUM-ICIP IN IC2-FLD.
       FIN-CLR-KEY-IC2.
           EXIT.
       
       CLR-FLD-IC2 SECTION.
       INI-CLR-FLD-IC2.
           MOVE SPACES TO FRM-GLS-CPTO IN IC2-FLD.
           MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD.
           PERFORM CLR-CIP-IC2.
       FIN-CLR-FLD-IC2.
           EXIT.
       
       CLR-CIP-IC2 SECTION.
       INI-CLR-CIP-IC2.
           MOVE SPACES TO CIP-COD-CPTO IN IC2-FLD.
           MOVE SPACES TO CIP-COD-TIPO IN IC2-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FCOL IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FMAV IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-SGV-MNTO IN IC2-FLD.
           MOVE ZEROES TO CIP-VAL-SIMO IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-TOPE IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-TINT IN IC2-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FINI IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FTER IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-NUM-PTRM IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-CUOT IN IC2-FLD.
           MOVE ZEROES TO CIP-NUM-FOLI IN IC2-FLD.
           MOVE SPACES TO CIP-GLS-NORM IN IC2-FLD.
       FIN-CLR-CIP-IC2.
           EXIT.
       
       FST-KEY-IC2 SECTION.
       INI-FST-KEY-IC2.
           MOVE -1 TO CIP-CAI-ICER-LEN IN IC2-FLD.
       FIN-FST-KEY-IC2.
           EXIT.
       
       FST-FLD-IC2 SECTION.
       INI-FST-FLD-IC2.
           MOVE -1 TO CIP-COD-CPTO-LEN IN IC2-FLD.
       FIN-FST-FLD-IC2.
           EXIT.
       
       PRO-KEY-IC2 SECTION.
       INI-PRO-KEY-IC2.
           PERFORM PRO-MKY-IC2.
       FIN-PRO-KEY-IC2.
           EXIT.
       
       PRO-MKY-IC2 SECTION.
       INI-PRO-MKY-IC2.
       FIN-PRO-MKY-IC2.
           EXIT.
       
       PRO-FLD-IC2 SECTION.
       INI-PRO-FLD-IC2.
           PERFORM PRO-CIP-IC2.
       FIN-PRO-FLD-IC2.
           EXIT.
       
       PRO-CIP-IC2 SECTION.
       INI-PRO-CIP-IC2.
           MOVE FRM-CPIM-AEY TO CIP-COD-CPTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-COD-TIPO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-FEC-FCOL-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-FEC-FMAV-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-SGV-MNTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-VAL-SIMO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-SGV-TOPE-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-SGV-TINT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-FEC-FINI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-FEC-FTER-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-NUM-PTRM-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-SGV-CUOT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-NUM-FOLI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-GLS-NORM-ATR IN IC2-FLD.
       FIN-PRO-CIP-IC2.
           EXIT.
       
       UNP-KEY-IC2 SECTION.
       INI-UNP-KEY-IC2.
           PERFORM UNP-IKY-IC2.
           PERFORM UNP-AKY-IC2.
           PERFORM UNP-MKY-IC2.
       FIN-UNP-KEY-IC2.
           EXIT.
       
       UNP-IKY-IC2 SECTION.
       INI-UNP-IKY-IC2.
      *<<<< INI_UNP_IKY_IC2
           IF SCR-CCPP = WCC-ING
               MOVE FRM-CPIM-UBY TO CIP-CAI-ICER-ATR
               MOVE FRM-CPIM-UBY TO CIP-IIC-ICER-ATR
               MOVE FRM-CPIM-AEY TO CIP-NUM-ICIP-ATR
               GO TO FIN-UNP-IKY-IC2.
      *>>>>
           MOVE FRM-CPIM-UBY TO CIP-CAI-ICER-ATR.
           MOVE FRM-CPIM-UBY TO CIP-IIC-ICER-ATR.
           MOVE FRM-CPIM-UBY TO CIP-NUM-ICIP-ATR.
       FIN-UNP-IKY-IC2.
           EXIT.
       
       UNP-MKY-IC2 SECTION.
       INI-UNP-MKY-IC2.
       FIN-UNP-MKY-IC2.
           EXIT.
       
       UNP-AKY-IC2 SECTION.
       INI-UNP-AKY-IC2.
       FIN-UNP-AKY-IC2.
           EXIT.
       
       UNP-FLD-IC2 SECTION.
       INI-UNP-FLD-IC2.
           PERFORM UNP-CIP-IC2.
       FIN-UNP-FLD-IC2.
           EXIT.
       
       UNP-CIP-IC2 SECTION.
       INI-UNP-CIP-IC2.
           MOVE FRM-CPIM-UBY TO CIP-COD-CPTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-COD-TIPO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FCOL-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FMAV-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-MNTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-VAL-SIMO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-TOPE-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-TINT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FINI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FTER-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-NUM-PTRM-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-CUOT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-NUM-FOLI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-GLS-NORM-ATR IN IC2-FLD.
       FIN-UNP-CIP-IC2.
           EXIT.
       
       VAL-MKY-IC2 SECTION.
       INI-VAL-MKY-IC2.
       FIN-VAL-MKY-IC2.
           EXIT.
       
       VAL-FLD-IC2 SECTION.
       INI-VAL-FLD-IC2.
           PERFORM VAL-CIP-COD-CPTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-COD-CPTO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-FRM-GLS-CPTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CPTO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-COD-TIPO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-FRM-GLS-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIPO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-FEC-FCOL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CIP-FEC-FCOL-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-FEC-FMAV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CIP-FEC-FMAV-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-SGV-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-SGV-MNTO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-VAL-SIMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-VAL-SIMO-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-SGV-TOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-SGV-TOPE-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CIP-FEC-FINI-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-FEC-FTER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CIP-FEC-FTER-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CIP-NUM-PTRM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-NUM-PTRM-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-SGV-CUOT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-SGV-CUOT-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-NUM-FOLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-NUM-FOLI-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
           PERFORM VAL-CIP-GLS-NORM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-GLS-NORM-LEN IN IC2-FLD
                GO TO FIN-VAL-FLD-IC2.
       FIN-VAL-FLD-IC2.
           EXIT.
       
       VAL-CIP-COD-CPTO SECTION.
       INI-VAL-CIP-COD-CPTO.
           IF CIP-COD-CPTO IN IC2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-COD-CPTO.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'CNP ' TO TAB-COD-TTAB IN TAB.
           MOVE CIP-COD-CPTO IN IC2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CIP-COD-CPTO IN IC2-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CPTO IN IC2-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CPTO IN IC2-FLD.
       FIN-VAL-CIP-COD-CPTO.
           EXIT.
       
       VAL-FRM-GLS-CPTO SECTION.
       INI-VAL-FRM-GLS-CPTO.
       FIN-VAL-FRM-GLS-CPTO.
           EXIT.
       
       VAL-CIP-COD-TIPO SECTION.
       INI-VAL-CIP-COD-TIPO.
      *<<<< INI_CIP_COD_TIPO
           GO TO CONT-COD-TIPO.
      *>>>>
           IF CIP-COD-TIPO IN IC2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-COD-TIPO.
      *<<<< CIP_COD_TIPO
       CONT-COD-TIPO.

      *VAL-COD Valida codigo de tabla
           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CEO ' TO TAB-COD-TTAB IN TAB.
           MOVE CIP-COD-CPTO IN IC2-FLD  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS  AND TAB-IND-VIGE = 'S'
               MOVE TAB-GLS-DATA IN TAB(1:1) TO CIP-COD-TIPO IN IC2-FLD.

           IF CIP-COD-TIPO IN IC2-FLD NOT > SPACES
               MOVE WCC-A TO CIP-COD-TIPO IN IC2-FLD.
      *         PERFORM ERR-GLS
      *         MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD
      *         GO TO FIN-VAL-CIP-COD-TIPO.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'TEA ' TO TAB-COD-TTAB IN TAB.
           MOVE CIP-COD-TIPO IN IC2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CIP-COD-TIPO IN IC2-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIPO IN IC2-FLD.
       FIN-VAL-CIP-COD-TIPO.
           EXIT.
       
       VAL-FRM-GLS-TIPO SECTION.
       INI-VAL-FRM-GLS-TIPO.
       FIN-VAL-FRM-GLS-TIPO.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CIP-FEC-FCOL SECTION.
       INI-VAL-CIP-FEC-FCOL.
           IF CIP-FEC-FCOL IN IC2-FLD  NOT > ZEROES
              MOVE ZEROES TO CIP-FEC-FCOL IN IC2-FLD.
      *VAL-FEC Validar Fecha
           MOVE CIP-FEC-FCOL IN IC2-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CIP_FEC_FCOL
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FCOL IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FCOL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FCOL IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CIP-FEC-FCOL.
       FIN-VAL-CIP-FEC-FCOL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CIP-FEC-FMAV SECTION.
       INI-VAL-CIP-FEC-FMAV.
           IF CIP-FEC-FMAV IN IC2-FLD  NOT > ZEROES
              MOVE ZEROES TO CIP-FEC-FMAV IN IC2-FLD.
      *VAL-FEC Validar Fecha
           MOVE CIP-FEC-FMAV IN IC2-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CIP_FEC_FMAV
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FMAV IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FMAV.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FMAV IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CIP-FEC-FMAV.
       FIN-VAL-CIP-FEC-FMAV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CIP-SGV-MNTO SECTION.
       INI-VAL-CIP-SGV-MNTO.
           IF CIP-SGV-MNTO IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-SGV-MNTO.
       FIN-VAL-CIP-SGV-MNTO.
           EXIT.
       
       VAL-CIP-VAL-SIMO SECTION.
       INI-VAL-CIP-VAL-SIMO.
           IF CIP-VAL-SIMO IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-VAL-SIMO.
       FIN-VAL-CIP-VAL-SIMO.
           EXIT.
       
       VAL-CIP-SGV-TOPE SECTION.
       INI-VAL-CIP-SGV-TOPE.
           IF CIP-SGV-TOPE IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-SGV-TOPE.
       FIN-VAL-CIP-SGV-TOPE.
           EXIT.
       
       VAL-CIP-SGV-TINT SECTION.
       INI-VAL-CIP-SGV-TINT.
       FIN-VAL-CIP-SGV-TINT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CIP-FEC-FINI SECTION.
       INI-VAL-CIP-FEC-FINI.
           IF CIP-FEC-FINI IN IC2-FLD  NOT > ZEROES
              MOVE ZEROES TO CIP-FEC-FINI IN IC2-FLD.
      *VAL-FEC Validar Fecha
           MOVE CIP-FEC-FINI IN IC2-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CIP_FEC_FINI
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FINI IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FINI.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FINI IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CIP-FEC-FINI.
       FIN-VAL-CIP-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CIP-FEC-FTER SECTION.
       INI-VAL-CIP-FEC-FTER.
           IF CIP-FEC-FTER IN IC2-FLD  NOT > ZEROES
              MOVE ZEROES TO CIP-FEC-FTER IN IC2-FLD.
      *VAL-FEC Validar Fecha
           MOVE CIP-FEC-FTER IN IC2-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CIP_FEC_FTER
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FTER IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FTER.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FTER IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CIP-FEC-FTER.
       FIN-VAL-CIP-FEC-FTER.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CIP-NUM-PTRM SECTION.
       INI-VAL-CIP-NUM-PTRM.
      *<<<< FIN_CIP_NUM_PTRM
           MOVE ZEROES TO WSS-NUM-MAXI IN WSS-VARI
           MOVE WCC-COL    TO FIO-SIST.
           MOVE WCC-IPTE   TO TAB-COD-TTAB IN TAB.
           MOVE WCC-IPTEXC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S)
                MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.

           IF CIP-NUM-PTRM IN IC2-FLD > ZEROES AND
              CIP-NUM-PTRM IN IC2-FLD > WSS-NUM-MAXI IN WSS-VARI
               MOVE WCC-COL        TO MSG-COD-SIST
               MOVE WCC-ERRVALTRM  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CIP-NUM-PTRM.
      *>>>>
       FIN-VAL-CIP-NUM-PTRM.
           EXIT.
       
       VAL-CIP-SGV-CUOT SECTION.
       INI-VAL-CIP-SGV-CUOT.
       FIN-VAL-CIP-SGV-CUOT.
           EXIT.
       
       VAL-CIP-NUM-FOLI SECTION.
       INI-VAL-CIP-NUM-FOLI.
      *<<<< INI_CIP_NUM_FOLI
           IF CIP-NUM-FOLI IN IC2-FLD = ZEROES AND
              CIP-COD-TIPO IN IC2-FLD = WCC-A
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-NUM-FOLI.

           GO TO FIN-VAL-CIP-NUM-FOLI.
      *>>>>
           IF CIP-NUM-FOLI IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-NUM-FOLI.
       FIN-VAL-CIP-NUM-FOLI.
           EXIT.
       
       VAL-CIP-GLS-NORM SECTION.
       INI-VAL-CIP-GLS-NORM.
      *<<<< INI_CIP_GLS_NORM
           IF CIP-GLS-NORM IN IC2-FLD NOT > SPACES
               MOVE WCC-DL20130 TO CIP-GLS-NORM IN IC2-FLD
               GO TO FIN-VAL-CIP-GLS-NORM.

           MOVE SPACES TO TAB.
           MOVE WCC-COL TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-NOEE TO TAB-COD-TTAB IN TAB.
           MOVE CIP-GLS-NORM IN IC2-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = WCC-S
               GO TO FIN-VAL-CIP-GLS-NORM
           ELSE
               MOVE WCC-COL        TO MSG-COD-SIST
               MOVE WCC-ERRVALNEXC TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CIP-GLS-NORM.

           GO TO FIN-VAL-CIP-GLS-NORM.
      *>>>>
           IF CIP-GLS-NORM IN IC2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-GLS-NORM.
       FIN-VAL-CIP-GLS-NORM.
           EXIT.
       
       VAL-CON-FLD-IC2 SECTION.
       INI-VAL-CON-FLD-IC2.
      *<<<< VAL_CON_FLD_IC2
      *FECHA CURSE-VENCIMIENTO TERMINO
           MOVE CIP-NUM-DCOL IN IC2-FLD TO WSS-NU1-DIA IN WSS-VARI.
           MOVE CIP-NUM-MCOL IN IC2-FLD TO WSS-NU1-MES IN WSS-VARI.
           MOVE CIP-NUM-SCOL IN IC2-FLD TO WSS-NU1-SIG IN WSS-VARI.
           MOVE CIP-NUM-ACOL IN IC2-FLD TO WSS-NU1-ANO IN WSS-VARI.
           MOVE CIP-NUM-DMAV IN IC2-FLD TO WSS-NU2-DIA IN WSS-VARI.
           MOVE CIP-NUM-MMAV IN IC2-FLD TO WSS-NU2-MES IN WSS-VARI.
           MOVE CIP-NUM-SMAV IN IC2-FLD TO WSS-NU2-SIG IN WSS-VARI.
           MOVE CIP-NUM-AMAV IN IC2-FLD TO WSS-NU2-ANO IN WSS-VARI.
           IF WSS-FEC-FEC1 IN WSS-VARI > WSS-FEC-FEC2 IN WSS-VARI
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-FEC-FMAV-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN1 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      *FECHA INICIO-FECHA TERMINO
           MOVE CIP-NUM-DINI IN IC2-FLD TO WSS-NU1-DIA IN WSS-VARI.
           MOVE CIP-NUM-MINI IN IC2-FLD TO WSS-NU1-MES IN WSS-VARI.
           MOVE CIP-NUM-SINI IN IC2-FLD TO WSS-NU1-SIG IN WSS-VARI.
           MOVE CIP-NUM-AINI IN IC2-FLD TO WSS-NU1-ANO IN WSS-VARI.
           MOVE CIP-NUM-DTER IN IC2-FLD TO WSS-NU2-DIA IN WSS-VARI.
           MOVE CIP-NUM-MTER IN IC2-FLD TO WSS-NU2-MES IN WSS-VARI.
           MOVE CIP-NUM-STER IN IC2-FLD TO WSS-NU2-SIG IN WSS-VARI.
           MOVE CIP-NUM-ATER IN IC2-FLD TO WSS-NU2-ANO IN WSS-VARI.
           IF WSS-FEC-FEC1 IN WSS-VARI > WSS-FEC-FEC2 IN WSS-VARI
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-FEC-FTER-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN2 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

           IF CIP-COD-TIPO IN IC2-FLD = WCC-A AND
              CIP-NUM-PTRM IN IC2-FLD = ZEROES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-NUM-PTRM-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN3 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

           IF CIP-COD-TIPO IN IC2-FLD = WCC-A AND
              CIP-SGV-TINT IN IC2-FLD = ZEROES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN4 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      * VALIDACION MONTO Y SALDO
           IF CIP-SGV-MNTO IN IC2-FLD < CIP-VAL-SIMO IN IC2-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-VAL-SIMO-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN6 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      * VALIDACION TASA MAXIMA Y TASA PERIODO
           IF CIP-SGV-TOPE IN IC2-FLD < CIP-SGV-TINT IN IC2-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN5 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.
      *>>>>
       FIN-VAL-CON-FLD-IC2.
           EXIT.
       
       VAL-CON-IC2 SECTION.
       INI-VAL-CON-IC2.
       FIN-VAL-CON-IC2.
           EXIT.
       
       VAL-NUM-KEY-IC2 SECTION.
       INI-VAL-NUM-KEY-IC2.
           PERFORM VAL-NUM-IKY-IC2.
           PERFORM VAL-NUM-MKY-IC2.
           PERFORM VAL-NUM-AKY-IC2.
       FIN-VAL-NUM-KEY-IC2.
           EXIT.
       
       VAL-NUM-IKY-IC2 SECTION.
       INI-VAL-NUM-IKY-IC2.
       VAL-NUM-CIP-IIC-ICER.
           MOVE CIP-IIC-ICER-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-IIC-ICER IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-IIC-ICER-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-IKY-IC2.
       VAL-NUM-CIP-NUM-ICIP.
           MOVE CIP-NUM-ICIP-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-ICIP IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-ICIP-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-IKY-IC2.
       FIN-VAL-NUM-IKY-IC2.
           EXIT.
       
       VAL-NUM-MKY-IC2 SECTION.
       INI-VAL-NUM-MKY-IC2.
       FIN-VAL-NUM-MKY-IC2.
           EXIT.
       
       VAL-NUM-AKY-IC2 SECTION.
       INI-VAL-NUM-AKY-IC2.
       FIN-VAL-NUM-AKY-IC2.
           EXIT.
       
       VAL-NUM-FLD-IC2 SECTION.
       INI-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-MNTO.
           MOVE CIP-SGV-MNTO-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-MNTO IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-MNTO-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-VAL-SIMO.
           MOVE CIP-VAL-SIMO-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-VAL-SIMO IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-VAL-SIMO-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-TOPE.
           MOVE CIP-SGV-TOPE-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-TOPE IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-TOPE-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-TINT.
           MOVE CIP-SGV-TINT-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-TINT IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-TINT-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-NUM-PTRM.
           MOVE CIP-NUM-PTRM-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-PTRM IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-PTRM-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-CUOT.
           MOVE CIP-SGV-CUOT-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-CUOT IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-CUOT-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-NUM-FOLI.
           MOVE CIP-NUM-FOLI-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-FOLI IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-FOLI-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       FIN-VAL-NUM-FLD-IC2.
           EXIT.
       
       EDT-KEY-IC2 SECTION.
       INI-EDT-KEY-IC2.
           PERFORM EDT-IKY-IC2.
           PERFORM EDT-MKY-IC2.
           PERFORM EDT-AKY-IC2.
       FIN-EDT-KEY-IC2.
           EXIT.
       
       EDT-IKY-IC2 SECTION.
       INI-EDT-IKY-IC2.
           IF CIP-IIC-ICER-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-IIC-ICER-LEN IN IC2-FLD
                GO TO FIN-EDT-IKY-IC2.
           MOVE CIP-IIC-ICER IN IC2-FLD TO CIP-IIC-ICER-EDT IN IC2-EDT.
           MOVE CIP-IIC-ICER-EDT IN IC2-EDT TO 
                CIP-IIC-ICER-ALF IN IC2-FLD.
           IF CIP-NUM-ICIP-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-ICIP-LEN IN IC2-FLD
                GO TO FIN-EDT-IKY-IC2.
           MOVE CIP-NUM-ICIP IN IC2-FLD TO CIP-NUM-ICIP-EDT IN IC2-EDT.
           MOVE CIP-NUM-ICIP-EDT IN IC2-EDT TO 
                CIP-NUM-ICIP-ALF IN IC2-FLD.
       FIN-EDT-IKY-IC2.
           EXIT.
       
       EDT-MKY-IC2 SECTION.
       INI-EDT-MKY-IC2.
       FIN-EDT-MKY-IC2.
           EXIT.
       
       EDT-AKY-IC2 SECTION.
       INI-EDT-AKY-IC2.
       FIN-EDT-AKY-IC2.
           EXIT.
       
       EDT-FLD-IC2 SECTION.
       INI-EDT-FLD-IC2.
           IF CIP-SGV-MNTO-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-MNTO-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-MNTO IN IC2-FLD TO CIP-SGV-MNTO-EDT IN IC2-EDT.
           MOVE CIP-SGV-MNTO-EDT IN IC2-EDT TO 
                CIP-SGV-MNTO-ALF IN IC2-FLD.
           IF CIP-VAL-SIMO-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-VAL-SIMO-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-VAL-SIMO IN IC2-FLD TO CIP-VAL-SIMO-EDT IN IC2-EDT.
           MOVE CIP-VAL-SIMO-EDT IN IC2-EDT TO 
                CIP-VAL-SIMO-ALF IN IC2-FLD.
           IF CIP-SGV-TOPE-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-TOPE-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-TOPE IN IC2-FLD TO CIP-SGV-TOPE-EDT IN IC2-EDT.
           MOVE CIP-SGV-TOPE-EDT IN IC2-EDT TO 
                CIP-SGV-TOPE-ALF IN IC2-FLD.
           IF CIP-SGV-TINT-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-TINT IN IC2-FLD TO CIP-SGV-TINT-EDT IN IC2-EDT.
           MOVE CIP-SGV-TINT-EDT IN IC2-EDT TO 
                CIP-SGV-TINT-ALF IN IC2-FLD.
           IF CIP-NUM-PTRM-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-PTRM-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-NUM-PTRM IN IC2-FLD TO CIP-NUM-PTRM-EDT IN IC2-EDT.
           MOVE CIP-NUM-PTRM-EDT IN IC2-EDT TO 
                CIP-NUM-PTRM-ALF IN IC2-FLD.
           IF CIP-SGV-CUOT-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-CUOT-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-CUOT IN IC2-FLD TO CIP-SGV-CUOT-EDT IN IC2-EDT.
           MOVE CIP-SGV-CUOT-EDT IN IC2-EDT TO 
                CIP-SGV-CUOT-ALF IN IC2-FLD.
           IF CIP-NUM-FOLI-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-FOLI-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-NUM-FOLI IN IC2-FLD TO CIP-NUM-FOLI-EDT IN IC2-EDT.
           MOVE CIP-NUM-FOLI-EDT IN IC2-EDT TO 
                CIP-NUM-FOLI-ALF IN IC2-FLD.
       FIN-EDT-FLD-IC2.
           EXIT.
