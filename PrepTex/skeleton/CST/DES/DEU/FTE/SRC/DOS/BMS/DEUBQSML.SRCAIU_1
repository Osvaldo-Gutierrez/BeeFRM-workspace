      *
      * DEUBQSML
      * Version 3.0.1 Nov-2005
      * 25-Jun-19 11:50 AM
      *
       SET-TAG-DEUBQSML SECTION.
       INI-SET-TAG-DEUBQSML.
           MOVE
           '<IDNMOD NOM=$DEUBQSML$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$25-Jun-19 11:50 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DEUBQSML.
           EXIT.
           
       PUT-ALL-SML SECTION.
       INI-PUT-ALL-SML.
           PERFORM PUT-DBC-SML.
           PERFORM PUT-OPC-SML.
       FIN-PUT-ALL-SML.
           EXIT.
       
       PUT-DBC-SML SECTION.
       INI-PUT-DBC-SML.
      *>>>>> INI_PUT_DBC_SML
           GO TO FIN-PUT-DBC-SML.
      *>>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-SML.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-SML
               GO TO FIN-PUT-DBC-SML.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN SML-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN SML-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN SML-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN SML-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN SML-FLD.
       FIN-PUT-DBC-SML.
           EXIT.
       
       PUT-OPC-SML SECTION.
       INI-PUT-OPC-SML.
           IF PGM-STAT-OPC-NUL
               GO TO FIN-PUT-OPC-SML.
           IF NOT PGM-STAT-OPC-OKS
               PERFORM CLR-OPC-SML
               GO TO FIN-PUT-OPC-SML.
           MOVE OPC-COD-CVTA IN OPC TO OPC-COD-CVTA IN SML-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN SML-FLD.
           MOVE OPC-COD-TOOC IN OPC TO OPC-COD-TOOC IN SML-FLD.
           MOVE OPC-COD-AOOC IN OPC TO OPC-COD-AOOC IN SML-FLD.
           MOVE OPC-COD-OFOC IN OPC TO OPC-COD-OFOC IN SML-FLD.
           MOVE OPC-CAI-IOPC IN OPC TO OPC-CAI-IOPC IN SML-FLD.
           MOVE OPC-IIC-IOPC IN OPC TO OPC-IIC-IOPC IN SML-FLD.
           MOVE OPC-VAL-CRED IN OPC TO OPC-VAL-CRED IN SML-FLD.
      *<<<< FIN_PUT_OPC_SML
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN SML-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN SML-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN SML-FLD > SPACES
               MOVE OPC-COD-OFOC IN SML-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOC IN SML-FLD.
      *RGD

           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND
                   TAB-IND-VIGE IN TAB = 'S')
              MOVE SPACES TO FRM-GLS-AOOC IN SML-FLD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO
                   FRM-GLS-AOOC IN SML-FLD.

           MOVE OPC-MSC-STAT IN OPC TO FRM-MSC-STAT IN SML-FLD.
           MOVE 'ESP'         TO TAB-CIC-TTAB IN TAB.
           IF FRM-MSC-STAT IN SML-FLD > SPACES
              MOVE FRM-MSC-STAT  IN SML-FLD
                                 TO TAB-CIC-CTAB IN TAB
              MOVE 'COL'         TO FIO-SIST
              MOVE 'TAB-CIC-TABL' TO FIO-AKEY
              MOVE FIO-GET-KEY   TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT (FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'S')
                 MOVE SPACES TO FRM-GLS-STAT IN SML-FLD
              ELSE
                 MOVE TAB-COD-CTAB IN TAB TO
                      FRM-GLS-STAT IN SML-FLD.

           MOVE OPC-NUM-DCOL IN OPC TO FRM-NUM-DINI IN SML-FLD.
           MOVE OPC-NUM-MCOL IN OPC TO FRM-NUM-MINI IN SML-FLD.
           MOVE OPC-NUM-SCOL IN OPC TO FRM-NUM-SINI IN SML-FLD.
           MOVE OPC-NUM-ACOL IN OPC TO FRM-NUM-AINI IN SML-FLD.

           MOVE OPC-CAI-IOPC IN SML-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-PUT-OPC-SML.
           MOVE 'RDC-KEY-IDLC'          TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
      *     DISPLAY 'SML FIO-STAT :' FIO-STAT.
      *     DISPLAY 'SML RDC : ' RDC.
           IF FIO-STAT-OKS AND
               OPC-CAI-IOPC IN SML-FLD = RDC-CAI-IOPC IN RDC AND
               OPC-IIC-IOPC IN SML-FLD = RDC-IIC-IOPC IN RDC
              IF RDC-NUM-IDLC IN RDC     = ZEROES
                 MOVE RDC-CAI-ICLI IN RDC          TO SCR-CAI-ICLI
                 MOVE RDC-IIC-ICLI IN RDC          TO SCR-IIC-ICLI
              ELSE
                 MOVE FIO-GET-NXT             TO FIO-CMND
                 GO TO LUP-PUT-OPC-SML
           ELSE
              MOVE SPACES                       TO SCR-CAI-ICLI
              MOVE SPACES                       TO SCR-IIC-ICLI.

           IF SCR-IIC-ICLI > SPACES
               MOVE SCR-CIC-ICLI TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES       TO DBC-GLS-NOMC IN SML-FLD
               ELSE
                  MOVE DBC-NUM-ICLI IN DBC
                                    TO DBC-NUM-ICLI IN SML-FLD
                  MOVE DBC-IND-ICLI IN DBC
                                    TO DBC-IND-ICLI IN SML-FLD
                  MOVE DBC-GLS-ICLI IN DBC
                                    TO DBC-GLS-ICLI IN SML-FLD
                  MOVE DBC-VRF-ICLI IN DBC
                                    TO DBC-VRF-ICLI IN SML-FLD
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN            TO
                              DBC-GLS-NOMC IN SML-FLD.
      *           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.

           MOVE OPC-CAI-IOPC IN SML-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE 1                       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS
              MOVE DLC-NUM-DMAV IN DLC TO FRM-NUM-DMAX IN SML-FLD
              MOVE DLC-NUM-MMAV IN DLC TO FRM-NUM-MMAX IN SML-FLD
              MOVE DLC-NUM-SMAV IN DLC TO FRM-NUM-SMAX IN SML-FLD
              MOVE DLC-NUM-AMAV IN DLC TO FRM-NUM-AMAX IN SML-FLD.

           IF DLC-IND-SCTB IN DLC = 'CAS'
              MOVE OPC-CAI-IOPC IN SML-FLD TO CCT-CAI-IOPC IN CCT
              MOVE OPC-IIC-IOPC IN SML-FLD TO CCT-IIC-IOPC IN CCT
              MOVE 1                       TO CCT-NUM-IDLC IN CCT
              MOVE 1                       TO CCT-NUM-ICCT IN CCT

              MOVE FIO-GET-KEY             TO FIO-CMND
              PERFORM COL-FIO-CCT
              IF FIO-STAT-OKS
                 MOVE CCT-NUM-SCCT IN CCT TO FRM-NUM-SCAS IN SML-FLD
                 MOVE CCT-NUM-ACCT IN CCT TO FRM-NUM-ACAS IN SML-FLD
                 MOVE CCT-NUM-MCCT IN CCT TO FRM-NUM-MCAS IN SML-FLD
                 MOVE CCT-NUM-DCCT IN CCT TO FRM-NUM-DCAS IN SML-FLD.

           MOVE OPC-CAI-IOPC IN SML-FLD TO CXE-CAI-IOPC IN CXE.
           MOVE OPC-IIC-IOPC IN SML-FLD TO CXE-IIC-IOPC IN CXE.
           MOVE 'SML'                   TO CXE-COD-EVEN IN CXE.
           MOVE 1                       TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                  TO CXE-CAI-IOPV IN CXE.
           MOVE SPACES                  TO CXE-IIC-IOPV IN CXE.
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES                  TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY             TO FIO-CMND.

           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
              MOVE CXE-SGV-MNTO IN CXE TO FRM-VAL-CREX IN SML-FLD.
              MOVE CXE-COD-VCOC IN CXE TO FRM-COD-VCOX IN SML-FLD.

           IF FRM-COD-VCOX IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-VCOX IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOX IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOX IN SML-FLD.

           PERFORM CARGA-AVALES.
      *>>>>>
       FIN-PUT-OPC-SML.
           EXIT.
       
       KEY-ALL-SML SECTION.
       INI-KEY-ALL-SML.
           PERFORM KEY-DBC-SML.
           PERFORM KEY-OPC-SML.
       FIN-KEY-ALL-SML.
           EXIT.
       
       KEY-DBC-SML SECTION.
       INI-KEY-DBC-SML.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN SML-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SML-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SML-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SML-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-SML.
           EXIT.
       
       KEY-OPC-SML SECTION.
       INI-KEY-OPC-SML.
           MOVE OPC-CAI-IOPC IN SML-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO OPC-IIC-IOPC IN OPC.
       FIN-KEY-OPC-SML.
           EXIT.
       
       SCR-CLRA-SML SECTION.
       INI-SCR-CLRA-SML.
           PERFORM CLR-KEY-SML.
           PERFORM CLR-FLD-SML.
       FIN-SCR-CLRA-SML.
           EXIT.
       
       CLR-KEY-SML SECTION.
       INI-CLR-KEY-SML.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN SML-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN SML-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN SML-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN SML-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO OPC-CAI-IOPC IN SML-FLD.
           MOVE ZEROES TO OPC-IIC-IOPC IN SML-FLD.
       FIN-CLR-KEY-SML.
           EXIT.
       
       CLR-FLD-SML SECTION.
       INI-CLR-FLD-SML.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FINI IN SML-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FMAX IN SML-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-MSC-STAT IN SML-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN SML-FLD.
           MOVE SPACES TO FRM-COD-PAI IN SML-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN SML-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN SML-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN SML-FLD.
           MOVE SPACES TO FRM-GLS-OFOC IN SML-FLD.
           MOVE SPACES TO FRM-GLS-PAI IN SML-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FCAS IN SML-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-COD-VCOX IN SML-FLD.
           MOVE SPACES TO FRM-GLS-VCOX IN SML-FLD.
           MOVE ZEROES TO FRM-VAL-CREX IN SML-FLD.
           MOVE SPACES TO FRM-GLS-MARG IN SML-FLD.
           MOVE SPACES TO FRM-COD-MARG IN SML-FLD.
           MOVE SPACES TO FRM-GLS-RESP IN SML-FLD.
           MOVE ZEROES TO FRM-COD-RESP IN SML-FLD.
           MOVE ZEROES TO FRM-NUM-RESP IN SML-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(1).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(1).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(1).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(1).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(2).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(2).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(2).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(2).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(3).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(3).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(3).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(3).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(4).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(4).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(4).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(4).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(5).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(5).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(5).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(5).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(6).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(6).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(6).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(6).
           MOVE ZEROES TO FRM-NUM-ICLI IN SML-FLD(7).
           MOVE SPACES TO FRM-VRF-ICLI IN SML-FLD(7).
           MOVE SPACES TO FRM-IND-ICLI IN SML-FLD(7).
           MOVE SPACES TO FRM-GLS-ICLI IN SML-FLD(7).
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(1).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(2).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(3).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(4).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(5).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(6).
           MOVE ZEROES TO FRM-SGV-PORC IN SML-FLD(7).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(1).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(2).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(3).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(4).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(5).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(6).
           MOVE SPACES TO FRM-GLS-NOMC IN SML-FLD(7).
           PERFORM CLR-DBC-SML.
           PERFORM CLR-OPC-SML.
       FIN-CLR-FLD-SML.
           EXIT.
       
       CLR-DBC-SML SECTION.
       INI-CLR-DBC-SML.
           MOVE SPACES TO DBC-GLS-NOMC IN SML-FLD.
       FIN-CLR-DBC-SML.
           EXIT.
       
       CLR-OPC-SML SECTION.
       INI-CLR-OPC-SML.
           MOVE SPACES TO OPC-COD-CVTA IN SML-FLD.
           MOVE SPACES TO OPC-COD-VCOC IN SML-FLD.
           MOVE SPACES TO OPC-COD-TOOC IN SML-FLD.
           MOVE SPACES TO OPC-COD-AOOC IN SML-FLD.
           MOVE SPACES TO OPC-COD-OFOC IN SML-FLD.
           MOVE ZEROES TO OPC-VAL-CRED IN SML-FLD.
       FIN-CLR-OPC-SML.
           EXIT.
       
       FST-KEY-SML SECTION.
       INI-FST-KEY-SML.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN SML-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-SML.
           EXIT.
       
       FST-FLD-SML SECTION.
       INI-FST-FLD-SML.
           MOVE FRM-POS-CURS TO FRM-FEC-FINI-LEN IN SML-FLD.
       FIN-FST-FLD-SML.
           EXIT.
       
       PRO-KEY-SML SECTION.
       INI-PRO-KEY-SML.
           PERFORM PRO-IKY-SML.
           PERFORM PRO-AKY-SML.
           PERFORM PRO-MKY-SML.
       FIN-PRO-KEY-SML.
           EXIT.
       
       PRO-IKY-SML SECTION.
       INI-PRO-IKY-SML.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SML-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SML-FLD.
           MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SML-FLD.
       FIN-PRO-IKY-SML.
           EXIT.
       
       PRO-MKY-SML SECTION.
       INI-PRO-MKY-SML.
       FIN-PRO-MKY-SML.
           EXIT.
       
       PRO-AKY-SML SECTION.
       INI-PRO-AKY-SML.
       FIN-PRO-AKY-SML.
           EXIT.
       
       UNP-KEY-SML SECTION.
       INI-UNP-KEY-SML.
           PERFORM UNP-IKY-SML.
           PERFORM UNP-AKY-SML.
           PERFORM UNP-MKY-SML.
       FIN-UNP-KEY-SML.
           EXIT.
       
       UNP-IKY-SML SECTION.
       INI-UNP-IKY-SML.
      *<<<< INI_UNP_IKY_SML
      *RGD
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SML-FLD

              MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR IN SML-FLD
           ELSE
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SML-FLD

              MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SML-FLD.
           GO TO FIN-UNP-IKY-SML.
 
      *>>>>
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SML-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR.
       FIN-UNP-IKY-SML.
           EXIT.
       
       UNP-MKY-SML SECTION.
       INI-UNP-MKY-SML.
       FIN-UNP-MKY-SML.
           EXIT.
       
       UNP-AKY-SML SECTION.
       INI-UNP-AKY-SML.
       FIN-UNP-AKY-SML.
           EXIT.
       
       UNP-FLD-SML SECTION.
       INI-UNP-FLD-SML.
      *<<<< INI_UNP_FLD_SML
           IF SCR-CCPP = 'MOD'
              PERFORM UNP-OPC-SML
              GO TO FIN-UNP-FLD-SML.

      *>>>>
           MOVE FRM-CPIM-UBY TO FRM-FEC-FINI-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FMAX-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-MSC-STAT-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-PAI-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FCAS-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOX-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VAL-CREX-ATR IN SML-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SML-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SML-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SML-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SML-FLD(7).
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-SGV-PORC-ATR IN SML-FLD(7).
           PERFORM UNP-DBC-SML.
           PERFORM UNP-OPC-SML.
       FIN-UNP-FLD-SML.
           EXIT.
       
       UNP-DBC-SML SECTION.
       INI-UNP-DBC-SML.
       FIN-UNP-DBC-SML.
           EXIT.
       
       UNP-OPC-SML SECTION.
       INI-UNP-OPC-SML.
      *<<<< INI_UNP_OPC_SML 
      *RGD
           IF SCR-CCPP = 'ING' OR SCR-CCPP = 'ACC'
              MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR IN SML-FLD.

           IF SCR-CCPP = 'MOD'
              MOVE FRM-CPIM-UBY TO OPC-VAL-CRED-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO FRM-FEC-FCAS-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO FRM-VAL-CREX-ATR IN SML-FLD
              GO TO FIN-UNP-OPC-SML.
      *>>>>
           MOVE FRM-CPIM-UBY TO OPC-COD-CVTA-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-VCOC-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-TOOC-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-AOOC-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-OFOC-ATR IN SML-FLD.
           MOVE FRM-CPIM-UBY TO OPC-VAL-CRED-ATR IN SML-FLD.
       FIN-UNP-OPC-SML.
           EXIT.
       
       VAL-KEY-SML SECTION.
       INI-VAL-KEY-SML.
           PERFORM VAL-IKY-SML.
           PERFORM VAL-MKY-SML.
           PERFORM VAL-AKY-SML.
       FIN-VAL-KEY-SML.
           EXIT.
       
       VAL-IKY-SML SECTION.
       INI-VAL-IKY-SML.
      *<<<< INI_VAL_IKY_SML 
      *RGD
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              PERFORM VALIDA-KEY-OPC
           ELSE
              PERFORM VALIDA-KEY-DBC.
           GO TO FIN-VAL-IKY-SML.
      *>>>>
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-OPC-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-CAI-IOPC-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
           PERFORM VAL-OPC-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SML-FLD
                GO TO FIN-VAL-IKY-SML.
       FIN-VAL-IKY-SML.
           EXIT.
       
       VAL-MKY-SML SECTION.
       INI-VAL-MKY-SML.
       FIN-VAL-MKY-SML.
           EXIT.
       
       VAL-AKY-SML SECTION.
       INI-VAL-AKY-SML.
       FIN-VAL-AKY-SML.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN SML-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN SML-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN SML-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN SML-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<<  FIN_DBC_VRF_ICLI
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN SML-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN SML-FLD
                                 TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN SML-FLD
                                 TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN SML-FLD
                                 TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN SML-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO
                               DBC-GLS-NOMC IN SML-FLD
      *RGD-INI PENTA 22-06-2015
      *            MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
                   MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI
                   IF DBC-CAI-ICLI IN DBC = 'NC  ' 
                      MOVE 'SGC'         TO MSG-COD-SIST
                      MOVE 'CLIINVSML  ' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC  TO FRM-MENS
      *RGD-INI PENTA 02-07-2015
      *               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
                      MOVE FRM-SUAR-MAL  TO FRM-SUAR 
                   ELSE
                      DISPLAY 'DBC-COD-ODSE: ' DBC-COD-ODSE IN DBC
                      IF DBC-COD-ODSE IN DBC = '005'
                         MOVE 'SGC'         TO MSG-COD-SIST
                         MOVE 'CLINAPSML  ' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC  TO FRM-MENS
                         MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      *RGD-FIN PENTA 02-07-2015
      *RGD-FIN PENTA 22-06-2015
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN SML-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN SML-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN SML-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN SML-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN SML-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SML-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN SML-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN SML-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-OPC-CAI-IOPC SECTION.
       INI-VAL-OPC-CAI-IOPC.
           IF OPC-CAI-IOPC IN SML-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OPC-CAI-IOPC.
       FIN-VAL-OPC-CAI-IOPC.
           EXIT.
       
       VAL-OPC-IIC-IOPC SECTION.
       INI-VAL-OPC-IIC-IOPC.
           IF OPC-IIC-IOPC IN SML-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OPC-IIC-IOPC.
      *>>>> FIN_OPC_IIC_IOPC
           MOVE OPC-CAI-IOPC IN SML-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              IF NOT FIO-STAT-OKS
                 MOVE 'COL' TO MSG-COD-SIST
                 MOVE 'OPC    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 IF OPC-COD-ATRN IN OPC NOT = 'DEUPUSML    '
                    MOVE 'COL' TO MSG-COD-SIST
                    MOVE 'OPENOELIM   ' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF NOT (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI')
              IF FIO-STAT-OKS
                 MOVE 'REGEXI    ' TO MSG-COD-MENS
                 MOVE 'GNS'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-OPC-IIC-IOPC.
           EXIT.
       
       VAL-CON-KEY-SML SECTION.
       INI-VAL-CON-KEY-SML.
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
           IF     DBC-NUM-ICLI IN SML-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN SML-FLD NOT > SPACES
              AND DBC-IND-ICLI IN SML-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN SML-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND OPC-CAI-IOPC IN SML-FLD NOT > SPACES 
              AND OPC-IIC-IOPC IN SML-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-SML.
       FIN-VAL-CON-KEY-SML.
           EXIT.
       
       VAL-CON-IKY-SML SECTION.
       INI-VAL-CON-IKY-SML.
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
           IF     DBC-NUM-ICLI IN SML-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN SML-FLD NOT > SPACES
              AND DBC-IND-ICLI IN SML-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN SML-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND OPC-CAI-IOPC IN SML-FLD NOT > SPACES 
              AND OPC-IIC-IOPC IN SML-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-SML.
       FIN-VAL-CON-IKY-SML.
           EXIT.
       
       VAL-NUM-KEY-SML SECTION.
       INI-VAL-NUM-KEY-SML.
           PERFORM VAL-NUM-IKY-SML.
           PERFORM VAL-NUM-MKY-SML.
           PERFORM VAL-NUM-AKY-SML.
       FIN-VAL-NUM-KEY-SML.
           EXIT.
       
       VAL-NUM-IKY-SML SECTION.
       INI-VAL-NUM-IKY-SML.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-IKY-SML.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-OPC-IIC-IOPC.
           MOVE OPC-IIC-IOPC-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OPC-IIC-IOPC IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPC-IIC-IOPC-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-IKY-SML.
       FIN-VAL-NUM-IKY-SML.
           EXIT.
       
       VAL-NUM-MKY-SML SECTION.
       INI-VAL-NUM-MKY-SML.
       FIN-VAL-NUM-MKY-SML.
           EXIT.
       
       VAL-NUM-AKY-SML SECTION.
       INI-VAL-NUM-AKY-SML.
       FIN-VAL-NUM-AKY-SML.
           EXIT.
       
       VAL-NUM-FLD-SML SECTION.
       INI-VAL-NUM-FLD-SML.
       VAL-NUM-OPC-VAL-CRED.
           MOVE OPC-VAL-CRED-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO OPC-VAL-CRED IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPC-VAL-CRED-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-VAL-CREX.
           MOVE FRM-VAL-CREX-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-CREX IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-CREX-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-COD-RESP.
           MOVE FRM-COD-RESP-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 7 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-COD-RESP IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-COD-RESP-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-RESP.
           MOVE FRM-NUM-RESP-ALF IN SML-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 4 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-RESP IN SML-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-RESP-LEN IN SML-FLD
                GO TO FIN-VAL-NUM-FLD-SML.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI-1.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(1)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-2.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(2)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-3.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(3)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-4.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(4)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-5.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(5)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(5)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-6.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(6)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(6)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-NUM-ICLI-7.
           MOVE FRM-NUM-ICLI-ALF IN SML-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SML-FLD(7)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SML-FLD(7)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-1.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(1)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-2.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(2)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-3.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(3)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-4.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(4)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-5.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(5)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(5)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-6.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(6)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(6)
                GO TO FIN-VAL-NUM-FLD-SML.
       VAL-NUM-FRM-SGV-PORC-7.
           MOVE FRM-SGV-PORC-ALF IN SML-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 5 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-PORC IN SML-FLD(7)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-PORC-LEN IN SML-FLD(7)
                GO TO FIN-VAL-NUM-FLD-SML.
       FIN-VAL-NUM-FLD-SML.
           EXIT.
       
       EDT-KEY-SML SECTION.
       INI-EDT-KEY-SML.
           PERFORM EDT-IKY-SML.
           PERFORM EDT-MKY-SML.
           PERFORM EDT-AKY-SML.
       FIN-EDT-KEY-SML.
           EXIT.
       
       EDT-IKY-SML SECTION.
       INI-EDT-IKY-SML.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN SML-FLD
                GO TO FIN-EDT-IKY-SML.
           MOVE DBC-NUM-ICLI IN SML-FLD TO
                DBC-NUM-ICLI-EDT IN SML-EDT.
           MOVE DBC-NUM-ICLI-EDT IN SML-EDT TO
                DBC-NUM-ICLI-ALF IN SML-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF OPC-IIC-IOPC-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SML-FLD
                GO TO FIN-EDT-IKY-SML.
           MOVE OPC-IIC-IOPC IN SML-FLD TO OPC-IIC-IOPC-EDT IN SML-EDT.
           MOVE OPC-IIC-IOPC-EDT IN SML-EDT TO 
                OPC-IIC-IOPC-ALF IN SML-FLD.
       FIN-EDT-IKY-SML.
           EXIT.
       
       EDT-MKY-SML SECTION.
       INI-EDT-MKY-SML.
       FIN-EDT-MKY-SML.
           EXIT.
       
       EDT-AKY-SML SECTION.
       INI-EDT-AKY-SML.
       FIN-EDT-AKY-SML.
           EXIT.
       
       EDT-FLD-SML SECTION.
       INI-EDT-FLD-SML.
           IF OPC-VAL-CRED-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPC-VAL-CRED-LEN IN SML-FLD
                GO TO FIN-EDT-FLD-SML.
           MOVE OPC-VAL-CRED IN SML-FLD TO OPC-VAL-CRED-EDT IN SML-EDT.
           MOVE OPC-VAL-CRED-EDT IN SML-EDT TO 
                OPC-VAL-CRED-ALF IN SML-FLD.
           IF FRM-VAL-CREX-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-CREX-LEN IN SML-FLD
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-VAL-CREX IN SML-FLD TO FRM-VAL-CREX-EDT IN SML-EDT.
           MOVE FRM-VAL-CREX-EDT IN SML-EDT TO 
                FRM-VAL-CREX-ALF IN SML-FLD.
           IF FRM-COD-RESP-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-COD-RESP-LEN IN SML-FLD
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-COD-RESP IN SML-FLD TO FRM-COD-RESP-EDT IN SML-EDT.
           MOVE FRM-COD-RESP-EDT IN SML-EDT TO 
                FRM-COD-RESP-ALF IN SML-FLD.
           IF FRM-NUM-RESP-LEN IN SML-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-RESP-LEN IN SML-FLD
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-RESP IN SML-FLD TO FRM-NUM-RESP-EDT IN SML-EDT.
           MOVE FRM-NUM-RESP-EDT IN SML-EDT TO 
                FRM-NUM-RESP-ALF IN SML-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN SML-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(1)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(1) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(1).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(2)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(2) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(2).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(3)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(3) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(3).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(4)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(4) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(4).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(5)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(5) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(5).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(6)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(6) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(6).
           IF FRM-NUM-ICLI-LEN IN SML-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SML-FLD(7)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-NUM-ICLI IN SML-FLD(7) TO
                FRM-NUM-ICLI-EDT IN SML-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SML-EDT TO
                FRM-NUM-ICLI-ALF IN SML-FLD(7).
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-SGV-PORC-LEN IN SML-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(1)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(1) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(1).
           IF FRM-SGV-PORC-LEN IN SML-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(2)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(2) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(2).
           IF FRM-SGV-PORC-LEN IN SML-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(3)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(3) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(3).
           IF FRM-SGV-PORC-LEN IN SML-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(4)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(4) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(4).
           IF FRM-SGV-PORC-LEN IN SML-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(5)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(5) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(5).
           IF FRM-SGV-PORC-LEN IN SML-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(6)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(6) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(6).
           IF FRM-SGV-PORC-LEN IN SML-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-PORC-LEN IN SML-FLD(7)
                GO TO FIN-EDT-FLD-SML.
           MOVE FRM-SGV-PORC IN SML-FLD(7) TO 
                FRM-SGV-PORC-EDT IN SML-EDT.
           MOVE FRM-SGV-PORC-EDT IN SML-EDT TO 
                FRM-SGV-PORC-ALF IN SML-FLD(7).
       FIN-EDT-FLD-SML.
           EXIT.
      *<<<< EOF_BQ
      *RGD
       VALIDA-KEY-OPC SECTION.
       INI-VALIDA-KEY-OPC.
           PERFORM VAL-OPC-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-CAI-IOPC-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-OPC.
           PERFORM VAL-OPC-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-OPC.
       FIN-VALIDA-KEY-OPC.
           EXIT.

       VALIDA-KEY-DBC SECTION.
       INI-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
       FIN-VALIDA-KEY-DBC.
           EXIT.

       CARGA-AVALES SECTION.
       INI-CARGA-AVALES.
           MOVE ZEROES TO WSS-I.
           MOVE OPC-CAI-IOPC IN SML-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE 1                       TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CARGA-AVALES.
           MOVE 'RDC-KEY-IDLC'          TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
               OPC-CAI-IOPC IN SML-FLD = RDC-CAI-IOPC IN RDC AND
               OPC-IIC-IOPC IN SML-FLD = RDC-IIC-IOPC IN RDC AND
               RDC-NUM-IDLC IN RDC = 1)
               GO TO FIN-CARGA-AVALES.

           ADD 1 TO WSS-I.

           IF WSS-I > 8
               GO TO FIN-CARGA-AVALES.

           MOVE RDC-VAL-LIMD IN RDC TO FRM-SGV-PORC IN SML-FLD(WSS-I).

           MOVE RDC-CAI-ICLI TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
              MOVE SPACES       TO FRM-NUM-ICLI-ALF IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-VRF-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-IND-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-GLS-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-GLS-NOMC IN SML-FLD(WSS-I)
           ELSE
              MOVE DBC-NUM-ICLI IN DBC
                                TO FRM-NUM-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-VRF-ICLI IN DBC
                                TO FRM-VRF-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-IND-ICLI IN DBC
                                TO FRM-IND-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-GLS-ICLI IN DBC
                                TO FRM-GLS-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN            TO
                          FRM-GLS-NOMC IN SML-FLD(WSS-I).

           MOVE FIO-GET-NXT             TO FIO-CMND.
           GO TO LUP-CARGA-AVALES.

       FIN-CARGA-AVALES.
           MOVE SCR-CAI-ICLI TO DBC-CAI-ICLI IN DBC.
           MOVE SCR-IIC-ICLI TO DBC-IIC-ICLI IN DBC.
           EXIT.
      *>>>>
