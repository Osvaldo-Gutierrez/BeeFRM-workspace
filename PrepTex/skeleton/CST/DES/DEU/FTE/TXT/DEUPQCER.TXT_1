*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "DEUZQCER"
*% ELSE
*% CLRMFC = "DEUZUCER"
*% END
*% PGM_STAT_CLF = TRUE
*% IF CMT_ID
      *----------------------------------------------------------------
      * MANTENCION: CAMBIO DE FECHA DE CURSE
      * FECHA : NOVIEMBRE 2014
      * RESPONSABLE: AFRI-CGC
      * ETIQUETA: *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
      *----------------------------------------------------------------
*% END
*% IF MI_COMMAREA
            03 SCR-NUM-PANT               PIC 9(0005).
            03 SCR-CER-FLD                PIC X(110).
*% END
*% IF WSS
      *<<<< WSS
      *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
       01 WCC-PRO                 VALUE 'PRO'    PIC X(03).
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
      *AFRI-FIN 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGCPT.
       COPY DEUWXCER.
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).

       01  WSS-VARI.
           03 WSS-VEC-CER.
              05 WSS-ARR-CER      OCCURS 500 TIMES.
                 07 WSS-NUM-ICIP  VALUE ZEROES PIC  9(3).
                 07 WSS-COD-CPTO  VALUE SPACES PIC  X(6).
                 07 WSS-COD-EVEN  VALUE SPACES PIC  X(3).
                 07 WSS-SGV-TINT  VALUE ZEROES PIC  S9(3)V9(12).
                 07 WSS-SGV-MORI  VALUE ZEROES PIC  9(11)V9(4).
                 07 WSS-NUM-FOLI  VALUE ZEROES PIC  9(10).
                 07 WSS-NUM-CPTO  VALUE ZEROES PIC  9(3).
                 07 WSS-NUM-ICAN  VALUE ZEROES PIC  9(3).
                 07 WSS-NUM-PTRM  VALUE ZEROES PIC  9(3).
                 07 WSS-SGV-CUOT  VALUE ZEROES PIC  S9(11)V9(4).
                 07 WSS-GLS-NORM  VALUE SPACES PIC  X(12).

           03 WSS-CAI-ICE2         VALUE SPACES     PIC X(04).
           03 WSS-IIC-ICE2         VALUE SPACES     PIC X(08).

           03 WSS-IND-VEC            VALUE ZEROES   PIC 9(02).
           03 WSS-VEC-MAX            VALUE 500      PIC 9(03).
           03 WSS-GLS-UNO            VALUE 1        PIC 9(01).
           03 WSS-GLS-SI             VALUE 'S'      PIC X(01).
           03 WSS-GLS-NO             VALUE 'N'      PIC X(01).
           03 WSS-IND-CIP            VALUE SPACES   PIC X(01).
           03 WSS-I                  VALUE ZEROES   PIC  9(03).

           03 WSS-FEC-FVIG.
              05  WSS-NUM-DVIG    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-MVIG    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-SVIG    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-AVIG    VALUE ZEROES    PIC 9(02).
           03 WSS-FEC-FCOL.
              05  WSS-NUM-DCOL    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-MCOL    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-SCOL    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-ACOL    VALUE ZEROES    PIC 9(02).
           03 WSS-FEC-FLIQ.
              05  WSS-NUM-DLIQ    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-MLIQ    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-SLIQ    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-ALIQ    VALUE ZEROES    PIC 9(02).
           03 WSS-FEC-FVEN.
              05  WSS-NUM-DVEN    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-MVEN    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-SVEN    VALUE ZEROES    PIC 9(02).
              05  WSS-NUM-AVEN    VALUE ZEROES    PIC 9(02).
           03 WCC-DEU             VALUE 'DEU'     PIC X(03).
           03 WCC-I               VALUE 'I'       PIC X(01).
           03 WCC-CIPSINDETA      VALUE 'CIPSINDETA' PIC X(10).              
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
               PERFORM CLR-FRM VARYING WSS-I FROM 1 BY 1
                                 UNTIL WSS-I > WSS-IMAX
                MOVE TSK-TERM-ALF TO CER-COD-TERM
                MOVE TSK-TERM-ALF TO CER-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO CER-COD-TERM
                MOVE EIBTRMID     TO CER-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-CER-FLD TO CER-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE CER-NOM-TSCER TO QUE-COLA
               MOVE CER-LEN-TSCER TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-CER-FLD TO CER-FLD
                  GO TO FIN-INI.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CER
               PERFORM VAL-NUM-FLD-CER
               PERFORM SCRL-TAB-CER
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           MOVE CER-NOM-TSCER     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF CIP-NUM-ICIP IN CER-FLD NOT > ZEROES OR
              CIP-NUM-ICIP IN CER-FLD IS NOT NUMERIC
               MOVE ZEROES TO CIP-NUM-ICIP IN CIP
           ELSE
               MOVE CIP-NUM-ICIP IN CER-FLD TO
                    CIP-NUM-ICIP IN CIP.

           MOVE CIP-CAI-ICER IN CER-FLD TO WSS-CAI-ICE2 IN WSS-VARI.
           MOVE CIP-IIC-ICER IN CER-FLD TO WSS-IIC-ICE2 IN WSS-VARI.
           
           PERFORM BUS-DAT-ICER.
          
      *>>>>
*% END
*% IF FIN_PUT_SCR
      *<<<< FIN_PUT_SCR
           PERFORM MOV-REG-PANT.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
       COPY COLBFOPC.
       COPY COLBFDLC.
      *AFRI-FIN 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
       COPY SGCBFDBC.
       COPY GNSBGCPT.

       BUS-DAT-ICER SECTION.
       INI-BUS-DAT-ICER.

           MOVE CIP-CAI-ICER IN CER-FLD TO CIP-CAI-ICER IN CIP.
           MOVE CIP-IIC-ICER IN CER-FLD TO CIP-IIC-ICER IN CIP.
           MOVE FIO-GET-NLS             TO FIO-CMND.
           PERFORM DEU-FIO-CIP.
           MOVE FIO-STAT TO PGM-STAT-CIP.
           IF NOT FIO-STAT-OKS OR
            CIP-CAI-ICER IN CER-FLD NOT = CIP-CAI-ICER IN CIP OR
            CIP-IIC-ICER IN CER-FLD NOT = CIP-IIC-ICER IN CIP
              MOVE 'REGNEX    ' TO MSG-COD-MENS
              MOVE 'GNS' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              SET FIO-STAT-ERR TO TRUE
              MOVE 'S' TO SCR-IERR
              GO TO FIN-BUS-DAT-ICER.

           MOVE SPACES TO MSG-COD-MENS.

           PERFORM CAR-VEC-ICER.

           IF MSG-COD-MENS > SPACES
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
              GO TO FIN-BUS-DAT-ICER.

           IF WSS-IND-VEC =  WSS-GLS-UNO
              MOVE WCC-CIPSINDETA TO MSG-COD-MENS
              MOVE WCC-DEU TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-BUS-DAT-ICER.

           MOVE WSS-CAI-ICE2 IN WSS-VARI TO CIP-CAI-ICER IN CIP.
           MOVE WSS-IIC-ICE2 IN WSS-VARI TO CIP-IIC-ICER IN CIP.
           MOVE ZEROES TO CIP-NUM-ICIP IN CIP.
           MOVE FIO-GET-NLS             TO FIO-CMND.
           PERFORM DEU-FIO-CIP.

           PERFORM CAR-FLD-CER.

           MOVE WSS-CAI-ICE2 IN WSS-VARI TO CIP-CAI-ICER IN CER-FLD.
           MOVE WSS-IIC-ICE2 IN WSS-VARI TO CIP-IIC-ICER IN CER-FLD.
           MOVE WSS-CAI-ICE2 IN WSS-VARI TO CIP-CAI-ICER IN CIP.
           MOVE WSS-IIC-ICE2 IN WSS-VARI TO CIP-IIC-ICER IN CIP.

           PERFORM PUT-TAB.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.

       FIN-BUS-DAT-ICER.
           EXIT.

       CAR-VEC-ICER SECTION.
       INI-CAR-VEC-ICER.
           MOVE WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           MOVE SPACES                  TO WSS-IND-CIP.

       LOOP-BUS-VEC-ICER.
           MOVE WSS-GLS-SI          TO WSS-IND-CIP.
           MOVE CIP-NUM-ICIP IN CIP TO WSS-NUM-ICIP(WSS-IND-VEC).  
           MOVE CIP-COD-CPTO IN CIP TO WSS-COD-CPTO(WSS-IND-VEC).
           MOVE CIP-COD-EVEN IN CIP TO WSS-COD-EVEN(WSS-IND-VEC).
           MOVE CIP-SGV-TINT IN CIP TO WSS-SGV-TINT(WSS-IND-VEC).
           MOVE CIP-SGV-MORI IN CIP TO WSS-SGV-MORI(WSS-IND-VEC).
           MOVE CIP-NUM-FOLI IN CIP TO WSS-NUM-FOLI(WSS-IND-VEC).
           MOVE CIP-NUM-CPTO IN CIP TO WSS-NUM-CPTO(WSS-IND-VEC).
           MOVE CIP-NUM-ICAN IN CIP TO WSS-NUM-ICAN(WSS-IND-VEC).
           MOVE CIP-NUM-FOLI IN CIP TO WSS-NUM-FOLI(WSS-IND-VEC).
           MOVE CIP-VAL-CTRA IN CIP TO WSS-NUM-PTRM(WSS-IND-VEC).
           MOVE CIP-SGV-MCAL IN CIP TO WSS-SGV-CUOT(WSS-IND-VEC).
           MOVE CIP-GLS-NORM IN CIP TO WSS-GLS-NORM(WSS-IND-VEC).

       NXT-BUS-VEC-ICER.

           IF CIP-IND-DUSO IN CIP = WCC-I
               GO TO FIN-CAR-VEC-ICER.

           IF WSS-IND-CIP = WSS-GLS-SI
              ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.

           MOVE SPACES TO WSS-IND-CIP.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
             CIP-CAI-ICER IN CER-FLD NOT = CIP-CAI-ICER IN CIP OR
             CIP-IIC-ICER IN CER-FLD NOT = CIP-IIC-ICER IN CIP
              GO TO FIN-CAR-VEC-ICER.

           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-CAR-VEC-ICER.

           GO TO LOOP-BUS-VEC-ICER.

       FIN-CAR-VEC-ICER.
           EXIT.

       CAR-FLD-CER SECTION.
       INI-CAR-FLD-CER.

           MOVE ZEROES TO WSS-J IN CER-VARI.

       LOOP-CARGA.
           ADD 1 TO WSS-J IN CER-VARI.
           IF WSS-J IN CER-VARI > WSS-JMAX IN CER-VARI
               GO TO FIN-CAR-FLD-CER.

           IF (WSS-J IN CER-VARI < WSS-IND-VEC IN WSS-VARI)
      *    IF (WSS-J IN CER-VARI NOT > WSS-IND-VEC IN WSS-VARI)
                NEXT SENTENCE
           ELSE
               GO TO FIN-CAR-FLD-CER.

           PERFORM CLR-CER-VEC.
           MOVE WSS-NUM-ICIP(WSS-J) TO FRM-NUM-ICIP-V(WSS-J).
           MOVE WSS-COD-CPTO(WSS-J) TO FRM-COD-CPTO-V(WSS-J).
           MOVE WSS-COD-EVEN(WSS-J) TO FRM-COD-EVEN-V(WSS-J).
           MOVE WSS-SGV-TINT(WSS-J) TO FRM-SGV-TINT-V(WSS-J).
           MOVE WSS-SGV-MORI(WSS-J) TO FRM-SGV-MORI-V(WSS-J).
           MOVE WSS-NUM-FOLI(WSS-J) TO FRM-NUM-FOLI-V(WSS-J).
           MOVE WSS-NUM-CPTO(WSS-J) TO FRM-NUM-CPTO-V(WSS-J).
           MOVE WSS-NUM-ICAN(WSS-J) TO FRM-NUM-ICAN-V(WSS-J).
           MOVE WSS-NUM-PTRM(WSS-J) TO FRM-NUM-PTRM-V(WSS-J).
           MOVE WSS-SGV-CUOT(WSS-J) TO FRM-SGV-CUOT-V(WSS-J).
           MOVE WSS-GLS-NORM(WSS-J) TO FRM-GLS-NORM-V(WSS-J).

           GO TO LOOP-CARGA.

       FIN-CAR-FLD-CER.
           EXIT.

       MOV-REG-PANT SECTION.
       INI-MOV-REG-PANT.

           MOVE CIP-NUM-DLIQ IN CIP TO WSS-NUM-DLIQ IN WSS-VARI.
           MOVE CIP-NUM-MLIQ IN CIP TO WSS-NUM-MLIQ IN WSS-VARI.
           MOVE CIP-NUM-SLIQ IN CIP TO WSS-NUM-SLIQ IN WSS-VARI.
           MOVE CIP-NUM-ALIQ IN CIP TO WSS-NUM-ALIQ IN WSS-VARI.
           MOVE WSS-FEC-FLIQ IN WSS-VARI TO FRM-FEC-FLIQ IN CER-FLD.
           MOVE CIP-NUM-DVIG IN CIP TO WSS-NUM-DVIG IN WSS-VARI.
           MOVE CIP-NUM-MVIG IN CIP TO WSS-NUM-MVIG IN WSS-VARI.
           MOVE CIP-NUM-SVIG IN CIP TO WSS-NUM-SVIG IN WSS-VARI.
           MOVE CIP-NUM-AVIG IN CIP TO WSS-NUM-AVIG IN WSS-VARI.
           MOVE WSS-FEC-FVIG IN WSS-VARI TO FRM-FEC-FVIG IN CER-FLD.
           MOVE CIP-NUM-DCOL IN CIP TO WSS-NUM-DCOL IN WSS-VARI.
           MOVE CIP-NUM-MCOL IN CIP TO WSS-NUM-MCOL IN WSS-VARI.
           MOVE CIP-NUM-SCOL IN CIP TO WSS-NUM-SCOL IN WSS-VARI.
           MOVE CIP-NUM-ACOL IN CIP TO WSS-NUM-ACOL IN WSS-VARI.
      *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
           IF CIP-CIC-IOPC IN CIP > SPACES
               MOVE CIP-CIC-IOPC IN CIP TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   NEXT SENTENCE
               ELSE
                   IF OPC-IND-RENO IN OPC = WCC-PRO
                       MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
                       MOVE ZEROES TO DLC-NUM-IDLC IN DLC
                       MOVE FIO-GET-NLS TO FIO-CMND
                       PERFORM COL-FIO-DLC
                       IF FIO-STAT-OKS AND
                          OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
                           MOVE DLC-CIC-IOCO IN DLC TO
                                OPC-CIC-IOPC IN OPC
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM COL-FIO-OPC
                           MOVE OPC-NUM-DCOL TO WSS-NUM-DCOL IN WSS-VARI
                           MOVE OPC-NUM-MCOL TO WSS-NUM-MCOL IN WSS-VARI
                           MOVE OPC-NUM-SCOL TO WSS-NUM-SCOL IN WSS-VARI
                           MOVE OPC-NUM-ACOL TO WSS-NUM-ACOL IN WSS-VARI
                       ELSE
                           NEXT SENTENCE
                   ELSE
                       NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *AFRI-FIN 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
           MOVE WSS-FEC-FCOL IN WSS-VARI TO FRM-FEC-FCOL IN CER-FLD.
           MOVE CIP-NUM-DVEN IN CIP TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE CIP-NUM-MVEN IN CIP TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE CIP-NUM-SVEN IN CIP TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE CIP-NUM-AVEN IN CIP TO WSS-NUM-AVEN IN WSS-VARI.
           MOVE WSS-FEC-FVEN IN WSS-VARI TO FRM-FEC-FVEN IN CER-FLD.

           IF CIP-COD-VCOC IN CIP > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE CIP-COD-VCOC IN CIP TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCOC IN CER-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN CER-FLD.           

       FIN-MOV-REG-PANT.
           EXIT.

       CLR-CER-VEC SECTION.
       INI-CLR-CER-VEC.
           MOVE ZEROES TO FRM-NUM-ICIP-V(WSS-J).
           MOVE SPACES TO FRM-COD-CPTO-V(WSS-J).
           MOVE SPACES TO FRM-COD-EVEN-V(WSS-J).
           MOVE ZEROES TO FRM-SGV-TINT-V(WSS-J).
           MOVE ZEROES TO FRM-SGV-MORI-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-FOLI-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-CPTO-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-ICAN-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-PTRM-V(WSS-J).
           MOVE ZEROES TO FRM-SGV-CUOT-V(WSS-J).
           MOVE SPACES TO FRM-GLS-NORM-V(WSS-J).
       FIN-CLR-CER-VEC.
           EXIT.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE CER-NOM-TSCER     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE CER-NOM-TSCER-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE SPACES TO CER-VEC-TS.
           MOVE LOW-VALUES TO WSS-NUM-NCRE-IDX.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN CER-VARI.

           MOVE 1 TO WSS-F IN CER-VARI.

      *    MOVE FRM-IND-HMAS IN CER-FLD TO WSS-IND-HMAS IN CER-VARI.

       LUP-PUT-TAB.
           IF WSS-F IN CER-VARI > WSS-FMAX IN CER-VARI
              GO TO FIN-PUT-TAB.

           IF WSS-IND-VEC IN WSS-VARI NOT > WSS-GLS-UNO IN WSS-VARI
               MOVE WCC-CIPSINDETA TO MSG-COD-MENS
               MOVE WCC-DEU TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-F = WSS-IND-VEC IN WSS-VARI
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-COD-CPTO(WSS-F) > SPACES
               PERFORM PUT-TAB-CER
               PERFORM PUT-CER-QUE
               PERFORM SET-FRM-IFLD
           ELSE
               IF FRM-IFLD = 1 AND WSS-F = 1
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB
               ELSE
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN CER-VARI.
           GO TO LUP-PUT-TAB.

       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE CER-LEN-TSCER-MAS  TO QUE-LITM.
           MOVE CER-NOM-TSCER-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO CER-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO CER-MAS-IND-HMAS.

           IF WSS-NITM > WSS-NITMMAX
               MOVE WSS-NITMMAX TO WSS-NUM-ICUR
           ELSE
               MOVE WSS-NITM TO WSS-NUM-ICUR.

           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO CER-MAS-NUM-TOCC.
           MOVE CER-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       PUT-TAB-CER SECTION.
       INI-PUT-TAB-CER.
           PERFORM CLR-WSS.

           MOVE FRM-NUM-ICIP-V(WSS-F)
                      TO FRM-NUM-ICIP-CER     IN CER-VARI.
           MOVE FRM-COD-CPTO-V(WSS-F)
                      TO FRM-COD-CPTO-CER     IN CER-VARI.
           MOVE FRM-COD-EVEN-V(WSS-F)
                      TO FRM-COD-EVEN-CER     IN CER-VARI.
           MOVE FRM-SGV-TINT-V(WSS-F)
                      TO FRM-SGV-TINT-CER     IN CER-VARI.
           MOVE FRM-SGV-MORI-V(WSS-F)
                      TO FRM-SGV-MORI-CER     IN CER-VARI.
           MOVE FRM-NUM-FOLI-V(WSS-F)
                      TO FRM-NUM-FOLI-CER     IN CER-VARI.
           MOVE FRM-NUM-CPTO-V(WSS-F)
                      TO FRM-NUM-CPTO-CER     IN CER-VARI.
           MOVE FRM-NUM-ICAN-V(WSS-F)
                      TO FRM-NUM-ICAN-CER     IN CER-VARI.
           MOVE FRM-NUM-PTRM-V(WSS-F)
                      TO FRM-NUM-PTRM-CER     IN CER-VARI.
           MOVE FRM-SGV-CUOT-V(WSS-F)
                      TO FRM-SGV-CUOT-CER     IN CER-VARI.
           MOVE FRM-GLS-NORM-V(WSS-F)
                      TO FRM-GLS-NORM-CER     IN CER-VARI.

           MOVE FRM-NUM-ICIP-CER     TO FRM-NUM-ICIP-FRM.
           MOVE FRM-COD-CPTO-CER     TO FRM-COD-CPTO-FRM.
           MOVE FRM-COD-EVEN-CER     TO FRM-COD-EVEN-FRM.
           MOVE FRM-SGV-TINT-CER     TO FRM-SGV-TINT-FRM.
           MOVE FRM-SGV-MORI-CER     TO FRM-SGV-MORI-FRM.
           MOVE FRM-NUM-FOLI-CER     TO FRM-NUM-FOLI-FRM.
           MOVE FRM-NUM-CPTO-CER     TO FRM-NUM-CPTO-FRM.
           MOVE FRM-NUM-ICAN-CER     TO FRM-NUM-ICAN-FRM.
           MOVE FRM-NUM-PTRM-CER     TO FRM-NUM-PTRM-FRM.
           MOVE FRM-SGV-CUOT-CER     TO FRM-SGV-CUOT-FRM.
           MOVE FRM-GLS-NORM-CER     TO FRM-GLS-NORM-FRM.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-CER.
           MOVE FRM-NUM-ICIP-V(WSS-F)
                      TO FRM-NUM-ICIP     IN CER-FLD(FRM-IFLD).
           MOVE FRM-COD-CPTO-V(WSS-F)
                      TO FRM-COD-CPTO     IN CER-FLD(FRM-IFLD).
           MOVE FRM-COD-EVEN-V(WSS-F)
                      TO FRM-COD-EVEN     IN CER-FLD(FRM-IFLD).
           MOVE FRM-SGV-TINT-V(WSS-F)
                      TO FRM-SGV-TINT     IN CER-FLD(FRM-IFLD).
           MOVE FRM-SGV-MORI-V(WSS-F)
                      TO FRM-SGV-MORI     IN CER-FLD(FRM-IFLD).
           MOVE FRM-NUM-FOLI-V(WSS-F)
                      TO FRM-NUM-FOLI     IN CER-FLD(FRM-IFLD).
           MOVE FRM-NUM-CPTO-V(WSS-F)
                      TO FRM-NUM-CPTO     IN CER-FLD(FRM-IFLD).
           MOVE FRM-NUM-ICAN-V(WSS-F)
                      TO FRM-NUM-ICAN     IN CER-FLD(FRM-IFLD).
           MOVE FRM-NUM-PTRM-V(WSS-F)
                      TO FRM-VAL-CTRA     IN CER-FLD(FRM-IFLD).
           MOVE FRM-SGV-CUOT-V(WSS-F)
                      TO FRM-SGV-MCAL     IN CER-FLD(FRM-IFLD).
           MOVE FRM-GLS-NORM-V(WSS-F)
                      TO FRM-GLS-NORM     IN CER-FLD(FRM-IFLD).

       FIN-PUT-TAB-CER.
           EXIT.

       CLR-WSS SECTION.
       INI-CLR-WSS.

           MOVE ZEROES TO FRM-NUM-ICIP-CER    IN CER-VARI.
           MOVE SPACES TO FRM-COD-CPTO-CER    IN CER-VARI.
           MOVE SPACES TO FRM-COD-EVEN-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-SGV-TINT-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-SGV-MORI-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-NUM-FOLI-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-NUM-CPTO-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-NUM-ICAN-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-NUM-PTRM-CER    IN CER-VARI.
           MOVE ZEROES TO FRM-SGV-CUOT-CER    IN CER-VARI.
           MOVE SPACES TO FRM-GLS-NORM-CER    IN CER-VARI.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.

       FIN-CLR-WSS.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.
           MOVE ZEROES TO FRM-NUM-ICIP    IN CER-FLD(1).
           MOVE SPACES TO FRM-COD-CPTO    IN CER-FLD(1).
           MOVE SPACES TO FRM-COD-EVEN    IN CER-FLD(1).
           MOVE ZEROES TO FRM-SGV-TINT    IN CER-FLD(1).
           MOVE ZEROES TO FRM-SGV-MORI    IN CER-FLD(1).
           MOVE ZEROES TO FRM-NUM-FOLI    IN CER-FLD(1).
           MOVE ZEROES TO FRM-NUM-CPTO    IN CER-FLD(1).
           MOVE ZEROES TO FRM-NUM-ICAN    IN CER-FLD(1).
           MOVE ZEROES TO FRM-VAL-CTRA    IN CER-FLD(1).
           MOVE ZEROES TO FRM-SGV-MCAL    IN CER-FLD(1).
           MOVE SPACES TO FRM-GLS-NORM    IN CER-FLD(1).

       FIN-CLR-FRM-MTX.
           EXIT.

       PUT-CER-QUE SECTION.
       INI-PUT-CER-QUE.
           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE CER-NOM-TSCER    TO QUE-COLA.
           MOVE CER-LEN-TSCER    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
               IF NOT (WSS-NITM > WSS-NITMMAX)

                   MOVE FRM-NUM-ICIP-V(WSS-F)
                           TO FRM-NUM-ICIP-EDT
                   MOVE FRM-SGV-TINT-V(WSS-F)
                           TO FRM-SGV-TINT-EDT
                   MOVE FRM-SGV-TINT-EDT IN CER-EDT
                           TO FRM-SGV-TINT-ALF-CER IN CER-VARI

                   MOVE FRM-SGV-MORI-V(WSS-F)
                           TO FRM-SGV-MORI-EDT
                   MOVE FRM-SGV-MORI-EDT IN CER-EDT
                           TO FRM-SGV-MORI-ALF-CER IN CER-VARI

                   MOVE FRM-NUM-FOLI-V(WSS-F)
                           TO FRM-NUM-FOLI-EDT
                   MOVE FRM-NUM-FOLI-EDT IN CER-EDT
                           TO FRM-NUM-FOLI-ALF-CER IN CER-VARI

                   MOVE FRM-NUM-CPTO-V(WSS-F)
                           TO FRM-NUM-CPTO-EDT
                   MOVE FRM-NUM-CPTO-EDT IN CER-EDT
                           TO FRM-NUM-CPTO-ALF-CER IN CER-VARI

                   MOVE FRM-NUM-ICAN-V(WSS-F)
                           TO FRM-NUM-ICAN-EDT
                   MOVE FRM-NUM-ICAN-EDT IN CER-EDT
                           TO FRM-NUM-ICAN-ALF-CER IN CER-VARI

                   MOVE FRM-NUM-PTRM-V(WSS-F)
                           TO FRM-VAL-CTRA-EDT
                   MOVE FRM-VAL-CTRA-EDT IN CER-EDT
                           TO FRM-NUM-PTRM-ALF-CER IN CER-VARI

                   MOVE FRM-SGV-CUOT-V(WSS-F)
                           TO FRM-SGV-MCAL-EDT
                   MOVE FRM-SGV-MCAL-EDT IN CER-EDT
                           TO FRM-SGV-CUOT-ALF-CER IN CER-VARI

                   MOVE CER-VEC-TS    TO QUE-ITEM
               ELSE
                   GO TO FIN-PUT-CER-QUE
           ELSE
               MOVE WSS-NUM-NCRE-IDX TO QUE-ITEM.

           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-CER-QUE.
           EXIT.

       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.

           MOVE 'P' TO FRM-NUM-ICIP-ATR-CER.
           MOVE 'P' TO FRM-COD-CPTO-ATR-CER.
           MOVE 'P' TO FRM-COD-EVEN-ATR-CER.
           MOVE 'P' TO FRM-SGV-TINT-ATR-CER.
           MOVE 'P' TO FRM-SGV-MORI-ATR-CER.
           MOVE 'P' TO FRM-NUM-FOLI-ATR-CER.
           MOVE 'P' TO FRM-NUM-CPTO-ATR-CER.
           MOVE 'P' TO FRM-NUM-ICAN-ATR-CER.
           MOVE 'P' TO FRM-NUM-PTRM-ATR-CER.
           MOVE 'P' TO FRM-SGV-CUOT-ATR-CER.
           MOVE 'P' TO FRM-GLS-NORM-ATR-CER.

       FIN-PRO-FLD-QUE.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE CER-NOM-TSCER TO QUE-COLA.
           MOVE CER-LEN-TSCER TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'CCTTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-ICIP-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE CER-NOM-TSCER TO QUE-COLA
               MOVE CER-LEN-TSCER TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE ZEROES TO FRM-NUM-ICIP IN CER-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-CPTO IN CER-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EVEN IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TINT IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MORI IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-FOLI IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-CPTO IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-ICAN IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-CTRA IN CER-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MCAL IN CER-FLD(WSS-I).
           MOVE SPACES TO FRM-GLS-NORM IN CER-FLD(WSS-I).

       FIN-CLR-FRM.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE CER-NOM-TSCER TO QUE-COLA
           MOVE CER-LEN-TSCER TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-ICIP-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

       SCRL-TAB-CER SECTION.
       INI-SCRL-TAB-CER.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CER.
           EXIT.
      *>>>>
*% END
