*%! Codigo adicional para archivo
*% IF RR
      *<<<<
      *DEAD
       COPY DEURRDSF REPLACING ==01  SRT== BY ==02  SRT-DSF==.
      *>>>>
*% END
*% IF RW
      *<<<<
      *DEAD
       COPY DEURWDSF REPLACING ==01  WSS-DSF== BY ==02  WSS-DSF==.
      *>>>>
*% END
*% IF WSS
      *<<<<
      *ALD (PGV)
       COPY DEUBRESC.
       COPY DEUBRFIA.
       COPY DEUBRAMF.
       COPY COLBRRDT.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRDLC.
      *ALD COPY DEUWGDEU.
       COPY DEUWGESP.
      *COPY COLBRCAN.
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *ALD
       COPY GNSWGCPT.
      *
       COPY GNSWGPES.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRCAM.
       COPY SGCBRDBC.
       COPY SGCBRREC.
       COPY SGCBRDSF.
       COPY SGCBRRBS.
       COPY DEUBRCRI.
       COPY DEUBRRDE.
       COPY DEUBRRGA.
       COPY DEURWRDE.
       COPY DEURWRGA.
      *DEAD
       COPY DEURWRDG REPLACING ==01  WSS-RDG== BY ==02  WSS-RDG==.
      *
      *ALD Rutina GARPGRGB
       COPY DEUWGGAR.
      *
       COPY SGCWVPPU.
       01  WSS-VARI.
      *ALD/22-SEP-1988
           03  WSS-IND-TFEC       VALUE SPACES   PIC X(01).
           03  WSS-CIC-TFEC       VALUE SPACES   PIC X(01).
           03  WSS-IND-SCRT                      PIC X(03).
           03  WSS-IND-SCTB                      PIC X(03).
           03  WSS-IND-SCBZ                      PIC X(05).
           03  WSS-VAL-INTE       COMP-3         PIC 9(11)V9(04).
      *
           03 WSS-I                              PIC 9(03).
           03 WSS-COD-CTCA.
              05 WSS-COD-TREC                    PIC X(02).
      *DAD ini  30-JUL-1993
              05 WSS-COD-AREC                    PIC X(05).
      *DAD fin  30-JUL-1993
           03 WSS-CIC-ICLI.
              05 WSS-CAI-ICLI                    PIC X(04).
              05 WSS-IIC-ICLI                    PIC X(08).
           03 WSS-COD-CRIB                       PIC X(02).
           03 WSS-COD-CRIS                       PIC X(02).
           03 WSS-FEC-FCLA                       PIC X(08).
           03 WSS-IDC-ICLI                       PIC X(12).
           03 WSS-FEC-FFOT.
              05 WSS-NUM-DFOT                   PIC 9(02).
              05 WSS-NUM-MFOT                   PIC 9(02).
              05 WSS-NUM-SFOT                   PIC 9(02).
              05 WSS-NUM-AFOT                   PIC 9(02).
           03 WSS-COD-VAL1                      PIC X(06).
           03 WSS-COD-VAL2                      PIC X(06).
           03 WSS-VAL-DEUD                      PIC 9(11)V9(04).
           03 WSS-VAL-DPES                      PIC 9(11)V9(04).
	   03 WSS-IND-VCCR       VALUE SPACES   PIC X(01).
              88 EQUIVALENCIA-NO-VIGENTE    VALUE 'N'.
              88 EQUIVALENCIA-NO-EXISTE     VALUE 'X'.
              88 MONEDA-NO-EXISTENTE        VALUE 'M'.
           03 WSS-VAL-AUX                       PIC S9(10).
      *DEAD
           03 WSS-FEC-FDSF.
              05 WSS-NUM-DDSF                   PIC 9(02).
              05 WSS-NUM-MDSF                   PIC 9(02).
              05 WSS-NUM-SDSF                   PIC 9(02).
              05 WSS-NUM-ADSF                   PIC 9(02).
      *
      *>>>>
*% END
*% IF WSS_DTC
      *<<<<
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RGA-REQA==.
      *ALD
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
      *>>>>
*% END
*% IF RF
      *<<<<
      *>>>>
*% END
*% IF RT
      *<<<<
      *DEAD
        COPY DEURTDSF.
      *
        COPY DEURTRDE.
        COPY DEURTRGA.
      *DEAD
        COPY DEURTRDG.
      *
      *>>>>
*% END
*% IF INI_INP
      *<<<<
      *ALD/22-SEP-1988
      *Capura Tipo de Fecha
           DISPLAY 'TIPO FECHA (C : COMPUTACIONAL,R : REAL) : '
           ACCEPT  WSS-IND-TFEC IN WSS-VARI.
           DISPLAY WSS-IND-TFEC IN WSS-VARI.
      *
      *Captura Fecha de Informe
           DISPLAY 'FECHA INFORME ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FFOT IN WSS-VARI.
           DISPLAY WSS-FEC-FFOT IN WSS-VARI.
      *Captura Identificador
           DISPLAY 'IDENTIFICADOR : '.
           ACCEPT  WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY WSS-IDC-ICLI IN WSS-VARI.
      *ALD/22-SEP-1988
      *VAL-MSC Valida indicador ( miscelaneo ) de tabla : Tipo de Fecha
           MOVE 'TAB'                    TO MSC-COD-SIST.
           MOVE 'TFEC'                   TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-TFEC IN WSS-VARI TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-ABT
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TFEC IN WSS-RDB
               MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-TFEC IN WSS-VARI.
      *
      *VAL-FEC Valida Fecha de Informe
           DISPLAY WSS-FEC-FFOT IN WSS-VARI.
           MOVE WSS-FEC-FFOT IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.
           MOVE WSS-NUM-DFOT IN WSS-VARI TO WSS-NUM-DRDB IN WSS-RDB.
           MOVE WSS-NUM-MFOT IN WSS-VARI TO WSS-NUM-MRDB IN WSS-RDB.
           MOVE WSS-NUM-SFOT IN WSS-VARI TO WSS-NUM-SRDB IN WSS-RDB.
           MOVE WSS-NUM-AFOT IN WSS-VARI TO WSS-NUM-ARDB IN WSS-RDB.
      * ISP:  20-APR-1992 21:54:11 
      *       ELIMINADO ESTE CODIGO ( NO TIENE SENTIDO ; BUSCA PPU CON
      *       LOW VALUES
      *     PERFORM BUS-PPU.
      *     IF MSG-COD-MENS > SPACES
      *         DISPLAY MSG-GLS-DESC
      *         PERFORM GNS-PRO-ABT.
      *     PERFORM CIC-PPU.
      *     IF MSG-COD-MENS > SPACES
      *         DISPLAY MSG-GLS-DESC
      *         PERFORM GNS-PRO-ABT.

           MOVE 'SGC'  TO MSC-COD-SIST IN MSC-VARI.
           MOVE 'FISF' TO MSC-COD-TMSC IN MSC.
           MOVE 'FDSF' TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC
           ELSE
      *DEAD
               MOVE MSC-GLS-DATA TO WSS-FEC-FDSF IN WSS-VARI
               MOVE WSS-NUM-DDSF IN WSS-VARI TO WSS-NUM-DDSF IN WSS-RDB
               MOVE WSS-NUM-MDSF IN WSS-VARI TO WSS-NUM-MDSF IN WSS-RDB
               MOVE WSS-NUM-SDSF IN WSS-VARI TO WSS-NUM-SDSF IN WSS-RDB
               MOVE WSS-NUM-ADSF IN WSS-VARI TO WSS-NUM-ADSF IN WSS-RDB.
      *
      *IDC-CLI Busca Cliente por medio de IdC
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC
               PERFORM GNS-PRO-ABT.
      *ALD
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<<
           MOVE DBC-CIC-ICLI IN DBC TO DBD-CIC-ICLI IN DBD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-DBD.
           IF NOT FIO-STAT-OKS
               PERFORM INI-REG-DBD.
           MOVE DBC-CAI-ICLI IN DBC TO WSS-CAI-ICLI IN WSS-VARI.
           MOVE DBC-IIC-ICLI IN DBC TO WSS-IIC-ICLI IN WSS-VARI.
           MOVE '00' TO FIO-STAT.
           GO TO INI-OUT-SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<<
      *>>>>
*% END
*% IF FST_OUT
      *<<<<
      *>>>>
*% END
*% IF LUP_INP
      *<<<<
      *BUS-OFI busca oficina en tablas
           MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-RDB.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB.
           MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-ACTI IN WSS-RDB.
      *BUS-USR busca usuario en tablas
           MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR
           PERFORM BUS-USR
           MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-RDB
      *Leer DSF
           MOVE DBC-CIC-ICLI IN DBC TO DSF-CIC-ICLI IN DSF.
           MOVE 'DSF-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DSF.
           IF FIO-STAT-OKS
               ADD DSF-VAL-DVGN IN DSF 
                   DSF-VAL-DVGX IN DSF
                   DSF-VAL-DVCN IN DSF  
                   DSF-VAL-DVCX IN DSF 
                   DSF-VAL-IVGT IN DSF  
                   DSF-VAL-IVCT IN DSF
      *DAD ini  11-JAN-1994
                   DSF-VAL-CDIR IN DSF
                   DSF-VAL-CIND IN DSF
      *DAD fin  11-JAN-1994
                   GIVING WSS-VAL-DTOT IN WSS-RDB.
      *Leer RBS
           MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS.
           MOVE 'RBS-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF FIO-STAT-OKS
               IF RBS-IND-ICSF IN RBS NOT > SPACES
                   MOVE 'N' TO WSS-IND-CASF IN WSS-RDB
               ELSE
                   MOVE RBS-IND-ICSF IN RBS TO WSS-IND-CASF IN WSS-RDB
           ELSE
               MOVE 'N' TO WSS-IND-CASF IN WSS-RDB.
      *>>>>
*% END
*% IF RM
      *<<<< 
      *ALD/21-SEP-1988
       COPY DEURMDSF.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<<
      *Buscar Ultima Fecha de Clasificacion en CRI
           PERFORM BUS-ULT-CRI.
      *Buscar Relacion con el Banco
           MOVE DBD-CAI-ICLI IN SRT TO PPU-CAI-ICLI.
           MOVE DBD-IIC-ICLI IN SRT TO PPU-IIC-ICLI.
           PERFORM BUS-RCU.
      *ALD/22-SEP-1988
           MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-RBCO IN WSS-RDB.
      *Buscar Deudor Complementario
       GET-WSS-IND-DCOM.
           MOVE SPACES TO REC-KEY-IREC IN REC.
           MOVE DBD-CAI-ICLI IN SRT TO REC-CAI-ICLI IN REC.
           MOVE DBD-IIC-ICLI IN SRT TO REC-IIC-ICLI IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GET-WSS-IND-DCOM.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO WSS-IND-DCOM IN WSS-RDB
               GO TO FIN-GET-WSS-IND-DCOM.
           IF REC-CAI-ICLI IN REC = DBD-CAI-ICLI IN SRT AND
              REC-IIC-ICLI IN REC = DBD-IIC-ICLI IN SRT
               IF REC-IND-VIGE IN REC = 'S' AND
                  REC-COD-TREC IN REC = REC-COD-DCOM
                   MOVE 'S' TO WSS-IND-DCOM IN WSS-RDB
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-GET-WSS-IND-DCOM
           ELSE
               MOVE 'N' TO WSS-IND-DCOM IN WSS-RDB.
       FIN-GET-WSS-IND-DCOM.
           IF DSF-VAL-DVCN IN SRT > ZEROES OR
              DSF-VAL-DVCX IN SRT > ZEROES OR
              DSF-VAL-IVCT IN SRT > ZEROES
               MOVE 'S' TO WSS-IND-DVCF IN WSS-RDB
           ELSE
               MOVE 'N' TO WSS-IND-DVCF IN WSS-RDB.

      *DAD ini  25-SEP-1992
      *     IF DSF-VAL-PVDT IN SRT > ZEROES
      *         MOVE 'S' TO WSS-IND-DVDF IN WSS-RDB
      *     ELSE
      *DAD fin  25-SEP-1992
               MOVE 'N' TO WSS-IND-DVDF IN WSS-RDB.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<<
      *DEAD
           GENERATE DL-DSF.
      *
      *ALD
      * Mover complemento de la llave en RDE
      * 
      * Rutina PGV
           PERFORM GET-FHOY.
           PERFORM INI-CAM.
           MOVE HOY-FHOY TO DEU-FEC-FPRO.
           MOVE 'R' TO DEU-FPRO IN DEU.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO DEU-CIC-ICLI IN DEU.
           PERFORM CAL-DEU.
           IF DEU-STAT NOT = DEU-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE DEU-STAT TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               DISPLAY DEU-MEN2
               GO TO DL-GAR.
           MOVE 0 TO DEU-R.
      *
           MOVE DBD-CAI-ICLI IN SRT TO RDE-CAI-ICLI IN RDE.
           MOVE DBD-IIC-ICLI IN SRT TO RDE-IIC-ICLI IN RDE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-RDE.
           IF NOT FIO-STAT-OKS OR
              DBD-CAI-ICLI IN SRT NOT = RDE-CAI-ICLI IN RDE OR
              DBD-IIC-ICLI IN SRT NOT = RDE-IIC-ICLI IN RDE
               GENERATE DL-HRDE
               GENERATE DL-FRDE               
               GO TO DL-GAR.
           GENERATE DL-HRDE.
           MOVE RDE-IND-TIPD IN RDE TO WSS-IND-TIPD IN WSS-RDE.
           MOVE RDE-IND-SCRT IN RDE TO WSS-IND-SCRT IN WSS-VARI.
           MOVE RDE-IND-SCTB IN RDE TO WSS-IND-SCTB IN WSS-VARI.
           MOVE RDE-IND-SCBZ IN RDE TO WSS-IND-SCBZ IN WSS-VARI.
       LUP-MAIN-RDE.
           IF NOT ( FIO-STAT-OKS AND 
                    DBD-CAI-ICLI IN SRT = RDE-CAI-ICLI IN RDE AND
                    DBD-IIC-ICLI IN SRT = RDE-IIC-ICLI IN RDE )
               PERFORM BUS-GLS-RDE
               GENERATE DL-RDE
               IF WSS-IND-TIPD IN WSS-RDE NOT = 'FIA' AND
                  WSS-IND-TIPD IN WSS-RDE NOT = 'COM'
                   GENERATE DL-INT
                   GENERATE DL-FRDE
                   GO TO DL-GAR
               ELSE
                   GENERATE DL-FRDE
                   GO TO DL-GAR.
           IF (WSS-IND-TIPD IN WSS-RDE  = RDE-IND-TIPD IN RDE AND
               WSS-IND-SCRT IN WSS-VARI = RDE-IND-SCRT IN RDE AND
               WSS-IND-SCTB IN WSS-VARI = RDE-IND-SCTB IN RDE AND
               WSS-IND-SCBZ IN WSS-VARI = RDE-IND-SCBZ IN RDE )
                GO TO CON-RDE.
           PERFORM BUS-GLS-RDE.
           GENERATE DL-RDE.
           IF WSS-IND-TIPD IN WSS-RDE NOT = 'FIA' AND
              WSS-IND-TIPD IN WSS-RDE NOT = 'COM'
               GENERATE DL-INT.
           MOVE RDE-IND-TIPD IN RDE TO WSS-IND-TIPD IN WSS-RDE.
           MOVE RDE-IND-SCRT IN RDE TO WSS-IND-SCRT IN WSS-VARI.
           MOVE RDE-IND-SCTB IN RDE TO WSS-IND-SCTB IN WSS-VARI.
           MOVE RDE-IND-SCBZ IN RDE TO WSS-IND-SCBZ IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-DNAC IN WSS-RDE.
           MOVE ZEROES TO WSS-VAL-DEXT IN WSS-RDE.
           MOVE ZEROES TO WSS-VAL-DTOT IN WSS-RDE.
           MOVE ZEROES TO WSS-VAL-INAC IN WSS-RDE.
           MOVE ZEROES TO WSS-VAL-IEXT IN WSS-RDE.
           MOVE ZEROES TO WSS-VAL-ITOT IN WSS-RDE.
       CON-RDE.
           PERFORM SUM-RDE.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM DEU-FIO-RDE
           GO TO LUP-MAIN-RDE.
       DL-GAR.
           MOVE SPACES TO WSS-IND-VCCR.
      *ALD
      * Mover complemento de la llave en RGA
      * 
           PERFORM CLR-RGA VARYING WSS-I FROM 1 BY 1
                           UNTIL WSS-I > 100.
      * Rutina GARPGRGB
           MOVE SPACES TO RGA-COD-STAT IN RGA-LINK.
      *    MOVE DBD-CAI-ICLI IN SRT TO RGA-CAI-ICLI IN RGA.
      *    MOVE DBD-IIC-ICLI IN SRT TO RGA-IIC-ICLI IN RGA.

           MOVE WSS-IDC-ICLI IN WSS-VARI TO RGA-CIC-ICLI IN RGA-LINK.
      *
           PERFORM IDG-PUT-RGB.
           IF NOT FIO-STAT-OKS
               DISPLAY RGA-COD-STAT
               GO TO FIN-GAR.
      *
      *Determinar RMAX
           MOVE 0 TO RGA-RMAX.
           PERFORM DET-RMAX VARYING WSS-I FROM 1 BY 1 UNTIL
               WSS-I > 100.
      *
      * 
           MOVE 0 TO RGA-R.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-RGA.
           IF NOT FIO-STAT-OKS OR
              DBD-CAI-ICLI IN SRT NOT = RGA-CAI-ICLI IN RGA OR
              DBD-IIC-ICLI IN SRT NOT = RGA-IIC-ICLI IN RGA
               GO TO FIN-GAR.
       LUP-MAIN-RGA.
           IF NOT ( FIO-STAT-OKS AND 
                    DBD-CAI-ICLI IN SRT = RGA-CAI-ICLI IN RGA AND
                    DBD-IIC-ICLI IN SRT = RGA-IIC-ICLI IN RGA )
                     GO TO FIN-GAR.
           PERFORM PUT-RGA.
           PERFORM ERR-RGA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-RGA.
           GO TO LUP-MAIN-RGA.
       FIN-GAR.
           ADD WSS-VAL-RAGC IN WSS-RGA
               WSS-VAL-RAEC IN WSS-RGA
               GIVING WSS-VAL-TRAC IN WSS-RGA.   
           ADD WSS-VAL-RBGC IN WSS-RGA
               WSS-VAL-RBEC IN WSS-RGA
               GIVING WSS-VAL-TRBC IN WSS-RGA.   
           ADD WSS-VAL-NRGC IN WSS-RGA
               WSS-VAL-NREC IN WSS-RGA
               GIVING WSS-VAL-TNRC IN WSS-RGA.   
           ADD WSS-VAL-TRAC IN WSS-RGA
               WSS-VAL-TRBC IN WSS-RGA
               WSS-VAL-TNRC IN WSS-RGA
               GIVING WSS-VAL-TGAC IN WSS-RGA.   

      *DEAD
           ADD WSS-VAL-RAGL IN WSS-RGA
               WSS-VAL-RAEL IN WSS-RGA
               GIVING WSS-VAL-TRAL IN WSS-RGA.   
           ADD WSS-VAL-RBGL IN WSS-RGA
               WSS-VAL-RBEL IN WSS-RGA
               GIVING WSS-VAL-TRBL IN WSS-RGA.   
           ADD WSS-VAL-NRGL IN WSS-RGA
               WSS-VAL-NREL IN WSS-RGA
               GIVING WSS-VAL-TNRL IN WSS-RGA.   
           ADD WSS-VAL-TRAL IN WSS-RGA
               WSS-VAL-TRBL IN WSS-RGA
               WSS-VAL-TNRL IN WSS-RGA
               GIVING WSS-VAL-TGAL IN WSS-RGA.   
           ADD WSS-VAL-RAGP IN WSS-RGA
               WSS-VAL-RAEP IN WSS-RGA
               GIVING WSS-VAL-TRAP IN WSS-RGA.   
           ADD WSS-VAL-RBGP IN WSS-RGA
               WSS-VAL-RBEP IN WSS-RGA
              GIVING WSS-VAL-TRBP IN WSS-RGA.   
           ADD WSS-VAL-NRGP IN WSS-RGA
               WSS-VAL-NREP IN WSS-RGA
               GIVING WSS-VAL-TNRP IN WSS-RGA.   
           ADD WSS-VAL-TRAP IN WSS-RGA
               WSS-VAL-TRBP IN WSS-RGA
               WSS-VAL-TNRP IN WSS-RGA
               GIVING WSS-VAL-TGAP IN WSS-RGA.
      *
           MOVE WSS-VAL-TGAP IN WSS-RGA TO WSS-VAL-TTGC IN WSS-RGA.
           MOVE WSS-VAL-TTOT IN WSS-RDE TO WSS-VAL-TDGL IN WSS-RGA.
      *ALD/21-SEP-1988
           ADD WSS-VAL-RAEP IN WSS-RGA
               WSS-VAL-RBEP IN WSS-RGA
               WSS-VAL-NREP IN WSS-RGA
               GIVING WSS-VAL-EXGE IN WSS-RGA.
      *
           SUBTRACT WSS-VAL-TDGL IN WSS-RGA
                    WSS-VAL-EXGE IN WSS-RGA
                    FROM   WSS-VAL-TTGC IN WSS-RGA
                    GIVING WSS-VAL-AUX IN WSS-VARI.
           IF WSS-VAL-AUX IN WSS-VARI NOT < ZEROES
               MOVE 'EXCEDENTE' TO WSS-GLS-DGRD IN WSS-RGA
           ELSE
               MOVE 'DEFICIT' TO WSS-GLS-DGRD IN WSS-RGA.
      * DEAD
      *     SUBTRACT WSS-VAL-TDGL IN WSS-RGA
      *              WSS-VAL-EXGE IN WSS-RGA
      *              FROM   WSS-VAL-TTGC IN WSS-RGA
      *              GIVING WSS-VAL-TGRD IN WSS-RGA.
           MOVE WSS-VAL-AUX IN WSS-VARI TO WSS-VAL-TGRD IN WSS-RGA.
      *
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<<
           GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<<
      *>>>>
*% END
*% IF FIN_INP
      *<<<<
      *>>>>
*% END
*% IF FIN_OUT
      *<<<<
      *DEAD
      *    GENERATE DL-RGA.
      *>>>>
*% END
*% IF EOF
      *<<<<
      **************************************************************************
       BUS-ULT-CRI SECTION.
       INI-BUS-ULT-CRI.
      *DAD ini  11-JAN-1994
      * Inicializacion de variables para proceso de busqueda de
      * Clasificacion Cartera Comercial BANCO y SUPER
           MOVE SPACES TO WSS-FEC-FCLA IN WSS-VARI
                          WSS-COD-CRIB IN WSS-VARI
                          WSS-COD-CRIS IN WSS-VARI
                          CRI-IND-CRSB IN CRI
                          CRI-IND-CRSS IN CRI.
      * Seteo inicial para lectura en proceso de busqueda de
      * Clasificacion Cartera Comercial BANCO y SUPER
           MOVE DBD-CAI-ICLI IN SRT TO CRI-CAI-ICLI IN CRI
                                       WSS-CAI-ICLI IN WSS-VARI.
           MOVE DBD-IIC-ICLI IN SRT TO CRI-IIC-ICLI IN CRI
                                       WSS-IIC-ICLI IN WSS-VARI.
           MOVE 'C'                 TO CRI-IND-TCAR IN CRI.
           MOVE '99999999'          TO CRI-FEC-FCLA IN CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-ULT-CRI.
      * LUP de Lectura y Analisis al registro CRI para determinar
      * Clasificacion Cartera Comercial BANCO y SUPER
           PERFORM DEU-FIO-CRI.
           IF FIO-STAT-OKS AND
              WSS-CIC-ICLI IN WSS-VARI = CRI-CIC-ICLI IN CRI AND
              CRI-IND-TCAR IN CRI = 'C'
               MOVE CRI-FEC-FCLA IN CRI TO WSS-FEC-FCLA IN WSS-VARI
               PERFORM DET-CLA-BCO-SUP
               IF WSS-COD-CRIB IN WSS-VARI > SPACES AND
                  WSS-COD-CRIS IN WSS-VARI > SPACES
                   GO TO SET-BUS-ULT-CRI
               ELSE
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-BUS-ULT-CRI.
       SET-BUS-ULT-CRI.
           MOVE WSS-COD-CRIB IN WSS-VARI TO WSS-COD-CRCB IN WSS-RDB.
           MOVE WSS-COD-CRIS IN WSS-VARI TO WSS-COD-CRCS IN WSS-RDB.
      *DAD fin  11-JAN-1994
       FIN-BUS-ULT-CRI.
           EXIT.
      *-------------------------------------------------------------------------
      *DAD ini  11-JAN-1994
       DET-CLA-BCO-SUP SECTION.
       INI-DET-CLA-BCO-SUP.
      * Clasificacion Riesgo Cartera Comercial BANCO
           IF CRI-IND-CRSB IN CRI > SPACES AND
              WSS-COD-CRIB IN WSS-VARI = SPACES
               MOVE CRI-NUM-DCLA IN CRI TO SRT-NUM-DARB IN SRT
               MOVE CRI-NUM-MCLA IN CRI TO SRT-NUM-MARB IN SRT
               MOVE CRI-NUM-SCLA IN CRI TO SRT-NUM-SARB IN SRT
               MOVE CRI-NUM-ACLA IN CRI TO SRT-NUM-AARB IN SRT
               MOVE CRI-IND-CRSB IN CRI TO WSS-COD-CRIB IN WSS-VARI.

      * Clasificacion Riesgo Cartera Comercial SUPER
           IF CRI-IND-CRSS IN CRI > SPACES AND
              WSS-COD-CRIS IN WSS-VARI = SPACES
               MOVE CRI-NUM-DCLA IN CRI TO SRT-NUM-DARS IN SRT
               MOVE CRI-NUM-MCLA IN CRI TO SRT-NUM-MARS IN SRT
               MOVE CRI-NUM-SCLA IN CRI TO SRT-NUM-SARS IN SRT
               MOVE CRI-NUM-ACLA IN CRI TO SRT-NUM-AARS IN SRT
               MOVE CRI-IND-CRSS IN CRI TO WSS-COD-CRIS IN WSS-VARI.
       FIN-DET-CLA-BCO-SUP.
           EXIT.
      *DAD fin  11-JAN-1994
      **************************************************************************

       SUM-RDE SECTION.
       INI-SUM-RDE.
           PERFORM PUT-RES.
           PERFORM ERR-RDE.
           PERFORM PUT-INT.
           ADD  WSS-VAL-DNAC IN WSS-RDE
                WSS-VAL-DEXT IN WSS-RDE
                GIVING WSS-VAL-DTOT IN WSS-RDE.
           ADD  WSS-VAL-INAC IN WSS-RDE
                WSS-VAL-IEXT IN WSS-RDE
                GIVING WSS-VAL-ITOT IN WSS-RDE.
           ADD  WSS-VAL-TDMN IN WSS-RDE 
                WSS-VAL-TDME IN WSS-RDE
                GIVING WSS-VAL-TDIR IN WSS-RDE.
           ADD  WSS-VAL-TIMN IN WSS-RDE 
                WSS-VAL-TIME IN WSS-RDE
                GIVING WSS-VAL-TIND IN WSS-RDE.
           ADD  WSS-VAL-IDMN IN WSS-RDE 
                WSS-VAL-IDME IN WSS-RDE
                GIVING WSS-VAL-IDIR IN WSS-RDE.
           ADD WSS-VAL-TDIR IN WSS-RDE
               WSS-VAL-TIND IN WSS-RDE
               WSS-VAL-TSOL IN WSS-RDE
               WSS-VAL-TCOM IN WSS-RDE
               GIVING WSS-VAL-TAAM IN WSS-RDE.
           ADD WSS-VAL-IDIR IN WSS-RDE
               WSS-VAL-IIND IN WSS-RDE
               GIVING WSS-VAL-IAAM IN WSS-RDE.
           ADD WSS-VAL-TAAM IN WSS-RDE
               WSS-VAL-IAAM IN WSS-RDE
               GIVING WSS-VAL-TTOT IN WSS-RDE.
      *ALD/22-SEP-1988
           
       FIN-SUM-RDE.
           EXIT.

       PUT-RES SECTION.
       INI-PUT-RES.
      * transformar a pesos
            MOVE RDE-COD-VCCR IN RDE TO WSS-COD-VAL1 IN WSS-VARI.
            MOVE CAM-COD-MNAC        TO WSS-COD-VAL2 IN WSS-VARI.
            MOVE RDE-VAL-DEUD IN RDE TO WSS-VAL-DEUD IN WSS-VARI.
            PERFORM CAL-DPES.
            IF NOT FIO-STAT-OKS
                GO TO FIN-PUT-RES.
            MOVE WSS-VAL-DPES IN WSS-VARI TO RDE-VAL-DEUD IN RDE.
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-DIR
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DNAC IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TDMN IN WSS-RDE
                ELSE
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DEXT IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TDME IN WSS-RDE
            ELSE 
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-IND
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DNAC IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TIMN IN WSS-RDE
                ELSE
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DEXT IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TIME IN WSS-RDE
            ELSE
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-FIA
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT OR
                   RDE-COD-VCCR IN RDE NOT > SPACES
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DNAC IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TSOL IN WSS-RDE
                ELSE
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DEXT IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TSOL IN WSS-RDE
            ELSE
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-COM
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT OR
                   RDE-COD-VCCR IN RDE NOT > SPACES
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DNAC IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TCOM IN WSS-RDE
                ELSE
                    ADD RDE-VAL-DEUD IN RDE TO 
                        WSS-VAL-DEXT IN WSS-RDE
                    ADD RDE-VAL-DEUD IN RDE TO
                        WSS-VAL-TCOM IN WSS-RDE
            ELSE
                DISPLAY 'TIPO DE OPERACION INVALIDO : ' 
                         RDE-IND-TIPD IN RDE
                         PERFORM GNS-PRO-ABT.
       FIN-PUT-RES.
           EXIT.

       PUT-INT SECTION.
       INI-PUT-INT.
      * transformar a pesos
            MOVE RDE-COD-VCCR IN RDE TO WSS-COD-VAL1 IN WSS-VARI.
            MOVE CAM-COD-MNAC        TO WSS-COD-VAL2 IN WSS-VARI.
            MOVE WSS-VAL-INTE IN WSS-VARI TO WSS-VAL-DEUD IN WSS-VARI.
            PERFORM CAL-DPES.
            IF NOT FIO-STAT-OKS
                GO TO FIN-PUT-RES.
            MOVE WSS-VAL-DPES IN WSS-VARI TO WSS-VAL-INTE IN WSS-VARI.
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-DIR
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT
                    ADD WSS-VAL-INTE IN WSS-VARI TO 
                        WSS-VAL-INAC IN WSS-RDE
                    ADD WSS-VAL-INTE IN WSS-VARI TO
                        WSS-VAL-IDMN IN WSS-RDE
                ELSE
                    ADD WSS-VAL-INTE IN WSS-VARI TO 
                        WSS-VAL-IEXT IN WSS-RDE
                    ADD WSS-VAL-INTE IN WSS-VARI TO
                        WSS-VAL-IDME IN WSS-RDE
            ELSE 
            IF RDE-IND-TIPD  IN RDE = DEU-TIPD-IND
                IF RDE-COD-VCCR IN RDE     = CAM-COD-MNAC OR
                   RDE-MSC-TVCR IN RDE NOT = CAM-COD-MEXT
                    ADD WSS-VAL-INTE IN WSS-VARI TO 
                        WSS-VAL-INAC IN WSS-RDE
                    ADD WSS-VAL-INTE IN WSS-VARI TO
                        WSS-VAL-IIMN IN WSS-RDE
                ELSE
                    ADD WSS-VAL-INTE IN WSS-VARI TO 
                        WSS-VAL-IEXT IN WSS-RDE
                    ADD WSS-VAL-INTE IN WSS-VARI TO
                        WSS-VAL-IIME IN WSS-RDE.
       FIN-PUT-INT.
           EXIT.
                 
       PUT-RGA SECTION.
       INI-PUT-RGA.
      *ALD
      * transformar a pesos COMERCIAL
      *      MOVE RGA-COD-VCGA IN RGA TO WSS-COD-VAL1 IN WSS-VARI.
      *      MOVE CAM-COD-MNAC        TO WSS-COD-VAL2 IN WSS-VARI.
      *      MOVE RGA-VAL-COME IN RGA TO WSS-VAL-DEUD IN WSS-VARI.
      *      PERFORM CAL-DPES.
      *      IF NOT FIO-STAT-OKS
      *          GO TO FIN-PUT-RGA.
      *      MOVE WSS-VAL-DPES IN WSS-VARI TO RGA-VAL-COME IN RGA.
      * transformar a pesos LIQUIDO
      *      MOVE RGA-VAL-LIQU IN RGA TO WSS-VAL-DEUD IN WSS-VARI.
      *      PERFORM CAL-DPES.
      *      IF NOT FIO-STAT-OKS
      *          GO TO FIN-PUT-RGA.
      *      MOVE WSS-VAL-DPES IN WSS-VARI TO RGA-VAL-LIQU IN RGA.
      * transformar a pesos PONDERADO
      *      MOVE RGA-VAL-POND IN RGA TO WSS-VAL-DEUD IN WSS-VARI.
      *      PERFORM CAL-DPES.
      *      IF NOT FIO-STAT-OKS
      *          GO TO FIN-PUT-RGA.
      *      MOVE WSS-VAL-DPES IN WSS-VARI TO RGA-VAL-POND IN RGA.
            IF RGA-IND-REAL IN RGA = 'R '
                IF RGA-IND-CGAR IN RGA = 'G'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-RAGC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-RAGL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-RAGP IN WSS-RGA
                ELSE
                IF RGA-IND-CGAR IN RGA = 'E'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-RAEC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-RAEL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-RAEP IN WSS-RGA
                ELSE
                    DISPLAY 'TIPO DE CATEGORIA INVALIDO : '
                               RGA-IND-CGAR IN RGA

            ELSE
            IF RGA-IND-REAL IN RGA = 'RB'
                IF RGA-IND-CGAR IN RGA = 'G'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-RBGC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-RBGL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-RBGP IN WSS-RGA
                ELSE
                IF RGA-IND-CGAR IN RGA = 'E'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-RBEC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-RBEL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-RBEP IN WSS-RGA
                ELSE
                    DISPLAY 'TIPO DE CATEGORIA INVALIDO : '
                                 RGA-IND-CGAR IN RGA
            ELSE
            IF RGA-IND-REAL IN RGA = 'NR'
                IF RGA-IND-CGAR IN RGA = 'G'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-NRGC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-NRGL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-NRGP IN WSS-RGA
                ELSE
                IF RGA-IND-CGAR IN RGA = 'E'
                    ADD RGA-VAL-COME IN RGA TO 
                        WSS-VAL-NREC IN WSS-RGA
                    ADD RGA-VAL-LIQU IN RGA TO
                        WSS-VAL-NREL IN WSS-RGA
                    ADD RGA-VAL-POND IN RGA TO 
                        WSS-VAL-NREP IN WSS-RGA
                ELSE
                    DISPLAY 'TIPO DE CATEGORIA INVALIDO : '
                               RGA-IND-CGAR IN RGA
            ELSE
                DISPLAY ' INDICADOR GARANTIA NO EXISTE : '
                          RGA-IND-REAL IN RGA.
       FIN-PUT-RGA.
           EXIT.


       CAL-DPES SECTION.
       INI-CAL-DPES.

           IF WSS-COD-VAL1 IN WSS-VARI  = WSS-COD-VAL2 IN WSS-VARI OR
              WSS-COD-VAL1 IN WSS-VARI NOT > SPACES
               MOVE WSS-VAL-DEUD IN WSS-VARI TO
                    WSS-VAL-DPES IN WSS-VARI
           ELSE
               MOVE WSS-COD-VAL1 IN WSS-VARI TO CAM-COD-VCAM IN CAM(1)
               PERFORM GET-CAM
               IF NOT FIO-STAT-OKS
      *ALD Equivalencia inexistente
                   MOVE 'X'  TO WSS-IND-VCCR
                   MOVE ZEROES TO WSS-VAL-DPES IN WSS-VARI
               ELSE
                   IF CAM-IND-VIGE IN CAM = 'N'
      *ALD Equivalencia no vigente
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       MOVE 'N'  TO WSS-IND-VCCR
                       MOVE ZEROES TO WSS-VAL-DPES IN WSS-VARI
                   ELSE
                       MULTIPLY WSS-VAL-DEUD IN WSS-VARI BY 
                                CAM-SGV-VCAM IN CAM
                                GIVING WSS-VAL-DPES IN WSS-VARI.
       FIN-CAL-DPES.
           EXIT.

       ERR-RDE SECTION.
       INI-ERR-RDE.
           IF MONEDA-NO-EXISTENTE
               DISPLAY 'CODIGO DE MONEDA INVALIDO (RDE) : '
                        RDE-COD-VCCR IN RDE
               PERFORM GNS-PRO-ABT
           ELSE 
           IF EQUIVALENCIA-NO-VIGENTE
               DISPLAY 'EQUIVALENCIA NO VIGENTE A LA FECHA (RDE) : '
                        RDE-COD-VCCR IN RDE
               PERFORM GNS-PRO-ABT
           ELSE
           IF EQUIVALENCIA-NO-EXISTE
               DISPLAY 'EQUIVALENCIA NO EXISTE A LA FECHA (RDE) : '
                        RDE-COD-VCCR IN RDE
               PERFORM GNS-PRO-ABT.
       FIN-ERR-RDE.
           EXIT.

       ERR-RGA SECTION.
       INI-ERR-RGA.
           IF MONEDA-NO-EXISTENTE
               DISPLAY 'CODIGO DE MONEDA INVALIDO (RGA) : '
                        RGA-COD-VCGA IN RGA
               PERFORM GNS-PRO-ABT
           ELSE 
           IF EQUIVALENCIA-NO-VIGENTE
               DISPLAY 'EQUIVALENCIA NO VIGENTE A LA FECHA (RGA) : '
                        RGA-COD-VCGA IN RGA
               PERFORM GNS-PRO-ABT
           ELSE
           IF EQUIVALENCIA-NO-EXISTE
               DISPLAY 'EQUIVALENCIA NO EXISTE A LA FECHA (RGA) : '
                        RGA-COD-VCGA IN RGA
               PERFORM GNS-PRO-ABT.
       FIN-ERR-RGA.
           EXIT.

       GET-RDE SECTION.
       INI-GET-RDE.
           MOVE '00' TO FIO-STAT.
           ADD 1 TO DEU-R.
           IF DEU-R > DEU-RMAX
               MOVE '10' TO FIO-STAT
               GO TO FIN-GET-RDE.
           MOVE DEU-CIC-ICLI IN DEU        TO RDE-CIC-ICLI IN RDE.
           MOVE RDE-IND-TIPD IN DEU(DEU-R) TO RDE-IND-TIPD IN RDE.
           MOVE RDE-IND-SCRT IN DEU(DEU-R) TO RDE-IND-SCRT IN RDE.
           MOVE RDE-IND-SCTB IN DEU(DEU-R) TO RDE-IND-SCTB IN RDE.
           MOVE RDE-IND-SCBZ IN DEU(DEU-R) TO RDE-IND-SCBZ IN RDE.
           MOVE RDE-COD-COCR IN DEU(DEU-R) TO RDE-COD-COCR IN RDE.
           MOVE RDE-COD-VCCR IN DEU(DEU-R) TO RDE-COD-VCCR IN RDE.
           MOVE RDE-COD-OFCR IN DEU(DEU-R) TO RDE-COD-OFCR IN RDE.
           MOVE RDE-VAL-DEUD IN DEU(DEU-R) TO RDE-VAL-DEUD IN RDE.
      *    MOVE RDE-VAL-DPES IN DEU(DEU-R) TO RDE-VAL-DPES IN RDE.
      *     MOVE RDE-VAL-INTE IN DEU(DEU-R) TO WSS-VAL-INTE IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI.
       FIN-GET-RDE.
           EXIT.


       CLR-RGA SECTION.
       INI-CLR-RGA.
           MOVE SPACES TO RGA-KEY-IRGA IN RGA-LINK(WSS-I).
           MOVE ZEROES TO RGA-VAL-COME IN RGA-LINK(WSS-I).
           MOVE ZEROES TO RGA-VAL-LIQU IN RGA-LINK(WSS-I).
           MOVE ZEROES TO RGA-VAL-POND IN RGA-LINK(WSS-I).
       FIN-CLR-RGA.
           EXIT.

       GET-RGA SECTION.
       INI-GET-RGA.
           MOVE '00' TO FIO-STAT.
           IF FIO-CMND = FIO-GET-PRV OR FIO-CMND = FIO-GET-LEQ
               SUBTRACT 1 FROM RGA-R
               IF RGA-R NOT > ZEROES
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-GET-RGA
               ELSE
                   NEXT SENTENCE
           ELSE
               ADD 1 TO RGA-R 
               IF RGA-R > RGA-RMAX
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-GET-RGA.
      *ALD MOVE RGA-CIC-ICLI IN RGA-LINK        TO RGA-CIC-ICLI IN RGA.
           MOVE DBD-CAI-ICLI IN SRT             TO RGA-CAI-ICLI IN RGA.
           MOVE DBD-IIC-ICLI IN SRT             TO RGA-IIC-ICLI IN RGA.
      *
           MOVE RGA-IND-REAL IN RGA-LINK(RGA-R) TO RGA-IND-REAL IN RGA.
           MOVE RGA-COD-COGA IN RGA-LINK(RGA-R) TO RGA-COD-COGA IN RGA.
           MOVE RGA-IND-CGAR IN RGA-LINK(RGA-R) TO RGA-IND-CGAR IN RGA.
           MOVE RGA-COD-VCGA IN RGA-LINK(RGA-R) TO RGA-COD-VCGA IN RGA.
           MOVE RGA-COD-OFGA IN RGA-LINK(RGA-R) TO RGA-COD-OFGA IN RGA.
           MOVE RGA-VAL-COME IN RGA-LINK(RGA-R) TO RGA-VAL-COME IN RGA.
           MOVE RGA-VAL-LIQU IN RGA-LINK(RGA-R) TO RGA-VAL-LIQU IN RGA.
           MOVE RGA-VAL-POND IN RGA-LINK(RGA-R) TO RGA-VAL-POND IN RGA.
       FIN-GET-RGA.
           EXIT.

       DET-RMAX SECTION.
       INI-DET-RMAX.
           IF RGA-KEY-IRGA IN RGA-LINK(WSS-I) > SPACES
               MOVE WSS-I TO RGA-RMAX
           ELSE
               MOVE 101 TO WSS-I.
       FIN-DET-RMAX.
           EXIT.

       BUS-GLS-RDE SECTION.
       INI-BUS-GLS-RDE.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF WSS-IND-SCRT IN WSS-VARI > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'SCRT' TO MSC-COD-TMSC IN MSC
               MOVE WSS-IND-SCRT IN WSS-VARI TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SCRT IN WSS-RDE.
           IF WSS-IND-SCTB IN WSS-VARI > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'SCTB' TO MSC-COD-TMSC IN MSC
               MOVE WSS-IND-SCTB IN WSS-VARI TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SCTB IN WSS-RDE.
           IF WSS-IND-SCBZ IN WSS-VARI > SPACES
               MOVE 'COL' TO MSC-COD-SIST
               MOVE 'SCBZ' TO MSC-COD-TMSC IN MSC
               MOVE WSS-IND-SCBZ IN WSS-VARI TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-SCBZ IN WSS-RDE.
       FIN-BUS-GLS-RDE.
           EXIT.
       INI-REG-DBD SECTION.
       INI-INI-REG-DBD.
           MOVE DBC-CAI-ICLI IN DBC TO DBD-CAI-ICLI IN DBD.
           MOVE DBC-IIC-ICLI IN DBC TO DBD-IIC-ICLI IN DBD.
           MOVE SPACES TO DBD-IND-GARV IN DBD.
           MOVE ZEROES TO DBD-NUM-SOLR IN DBD.
           MOVE ZEROES TO DBD-NUM-OCTD IN DBD.
           MOVE ZEROES TO DBD-NUM-MIVA IN DBD.
           MOVE ZEROES TO DBD-NUM-SIVA IN DBD.
           MOVE ZEROES TO DBD-NUM-AIVA IN DBD.
           MOVE ZEROES TO DBD-NUM-OCVG IN DBD.
           MOVE ZEROES TO DBD-NUM-VCVG IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCO IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCA IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCP IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCR IN DBD.
           MOVE SPACES TO DBD-IND-DLDC IN DBD.
           MOVE ZEROES TO DBD-NUM-DPCR IN DBD.
           MOVE ZEROES TO DBD-NUM-MPCR IN DBD.
           MOVE ZEROES TO DBD-NUM-SPCR IN DBD.
           MOVE ZEROES TO DBD-NUM-APCR IN DBD.
           MOVE SPACES TO DBD-IND-DVCB IN DBD.
           MOVE ZEROES TO DBD-NUM-DUCR IN DBD.
           MOVE ZEROES TO DBD-NUM-MUCR IN DBD.
           MOVE ZEROES TO DBD-NUM-SUCR IN DBD.
           MOVE ZEROES TO DBD-NUM-AUCR IN DBD.
           MOVE SPACES TO DBD-IND-CASB IN DBD.
           MOVE ZEROES TO DBD-NUM-DUCA IN DBD.
           MOVE ZEROES TO DBD-NUM-MUCA IN DBD.
           MOVE ZEROES TO DBD-NUM-SUCA IN DBD.
           MOVE ZEROES TO DBD-NUM-AUCA IN DBD.
           MOVE SPACES TO DBD-IND-DVDB IN DBD.
           MOVE ZEROES TO DBD-NUM-DEMA IN DBD.
           MOVE ZEROES TO DBD-NUM-MEMA IN DBD.
           MOVE ZEROES TO DBD-NUM-SEMA IN DBD.
           MOVE ZEROES TO DBD-NUM-AEMA IN DBD.
           MOVE ZEROES TO DBD-VAL-EMUF IN DBD.
           MOVE ZEROES TO DBD-VAL-EPUF IN DBD.
       FIN-INI-REG-DBD.
           EXIT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *ALD
       COPY GNSBGCPT.
      *

       COPY GNSBBTAB.

       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.

       COPY GNSBBMSG.

       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.

       COPY TABBBUSR.
       COPY TABBFUSR.

       COPY SGCBFDBC.
       COPY SGCBGCLI.

       COPY SGCBFREC.
       COPY SGCBFDSF.
       COPY SGCBFRBS.
       COPY DEUBFCRI.
       COPY TABBFCAM.
      *ALD
      *COPY DEUBFRDE.
      *ALD
       DEU-FIO-RDE SECTION.
       INI-DEU-FIO-RDE.
           PERFORM GET-RDE.
       FIN-DEU-FIO-RDE.
           EXIT.
      *ALD
      *COPY DEUBFRGA.
       DEU-FIO-RGA SECTION.
       INI-DEU-FIO-RGA.
           PERFORM GET-RGA.
       FIN-DEU-FIO-RGA.
           EXIT.
       COPY DEUBFESC.
       COPY DEUBFFIA.
       COPY DEUBFAMF.
       COPY COLBFRDT.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY COLBFDLC.
      *COPY COLBFCAN.
       COPY TABBGCAM.
       COPY DEUBCDEU.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY GNSBGPPU.
       COPY GNSBGPES.
      *ALD 
      *Rutina GARPGRGB
       COPY DEUBGRGB.
      *>>>>
*% END
