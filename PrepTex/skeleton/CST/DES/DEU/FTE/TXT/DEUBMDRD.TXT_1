*%! Codigo adicional para archivo
*% IF FIN_PUT_ALL_DRD
      *<<<<
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF DRD-IND-TFEC IN DRD-FLD > SPACES
               MOVE 'DEU' TO MSC-COD-SIST
               MOVE 'TFEC' TO MSC-COD-TMSC IN MSC
               MOVE DRD-IND-TFEC IN DRD-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TFEC IN DRD-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF DRD-COD-VCCR IN DRD-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE DRD-COD-VCCR IN DRD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCCR IN DRD-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF DRD-COD-COCR IN DRD-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE DRD-COD-COCR IN DRD-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COCR IN DRD-FLD.
      *BUS-OFI busca oficina en tablas
           IF DRD-COD-OFCR IN DRD-FLD > SPACES
               MOVE DRD-COD-OFCR IN DRD-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCR IN DRD-FLD.
      *>>>>
*% END
*% IF DRD_FEC_FINV
      *<<<<
      *VAL-FEC Validar Fecha
           MOVE DRD-FEC-FINV IN DRD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO DRD-FEC-FINV IN DRD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
      *>>>>
*% END
*% IF DRD_HRA_HRIN
      *<<<<
      *>>>>
*% END
*% IF DRD_CAI_ICLI
      *<<<<
      *>>>>
*% END
*% IF DRD_IIC_ICLI
      *<<<<
      *>>>>
*% END
*% IF DBC_GLS_NOMC
      *<<<<
      *>>>>
*% END
*% IF DBC_IND_ICLI
      *<<<<
      *VAL-IND o VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DRD-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<<
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DRD-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<<
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<<
      *VAL-RUT Valida Rut
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN DRD-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DRD-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *>>>>
*% END
*% IF DRD_IND_TFEC
      *<<<<
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'TFEC' TO MSC-COD-TMSC IN MSC.
           MOVE DRD-IND-TFEC IN DRD-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *Dejar codigo solo si tiene glosa asociada
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              DRD-IND-TFEC IN DRD-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TFEC IN DRD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TFEC IN DRD-FLD.

      *>>>>
*% END
*% IF DRD_FEC_FINF
      *<<<<
      *VAL-FEC Validar Fecha
           MOVE DRD-FEC-FINF IN DRD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO DRD-FEC-FINF IN DRD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
      *>>>>
*% END
*% IF DRD_COD_VCCR
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE DRD-COD-VCCR IN DRD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              DRD-COD-VCCR IN DRD-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VCCR IN DRD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCCR IN DRD-FLD.
      *>>>>
*% END
*% IF DRD_COD_COCR
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE DRD-COD-COCR IN DRD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              DRD-COD-COCR IN DRD-FLD > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COCR IN DRD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COCR IN DRD-FLD.
      *>>>>
*% END
*% IF DRD_COD_OFCR
      *<<<<
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE DRD-COD-OFCR IN DRD-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFCR IN DRD-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFCR IN DRD-FLD.

      *>>>>
*% END
