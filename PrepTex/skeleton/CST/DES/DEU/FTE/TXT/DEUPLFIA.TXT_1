*%! Codigo adicional DEUPLFIA
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
      * COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
      *>>>>
*% END
*% IF RR
      *<<<< RR
      *DAD
       COPY DEURRAMF REPLACING ==01  SRT== BY ==02  SRT-AMF==.
      *>>>>
*% END
*% IF RW
      *<<<< RW
      *DAD
       COPY DEURWAMF REPLACING ==01  WSS-AMF== BY ==02  WSS-AMF==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
      *DAD
       COPY DEURTAMF.
      *>>>>
*% END
*% IF RM
      *<<<< RM
      *DAD
       COPY DEURMAMF.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
      * COPY GNSBRMSG.
      * COPY GNSBRTAB.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY SGCBRDBC.
       COPY DEUBRESC.
       COPY DEUBRAMF.
       COPY GNSWGCPT.
       01  WSS-VARI.
           03 WSS-FEC-FFOT.
              05 WSS-NUM-DFOT                     PIC 9(02).
              05 WSS-NUM-MFOT                     PIC 9(02).
              05 WSS-NUM-SFOT                     PIC 9(02).
              05 WSS-NUM-AFOT                     PIC 9(02).
           03 WSS-FEC-CMPR.
              05 WSS-NUM-SMPR                     PIC 9(02).
              05 WSS-NUM-AMPR                     PIC 9(02).
              05 WSS-NUM-MMPR                     PIC 9(02).
              05 WSS-NUM-DMPR                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-IND-TFEC          VALUE SPACES  PIC X(01).
           03 WSS-CIC-TFEC          VALUE SPACES  PIC X(01).
           03 WSS-COD-OFIP                        PIC X(03).
           03 WSS-IND-TIDE                        PIC X(01).
           03 WSS-CIC-TIDE                        PIC X(01).
           03 WSS-COD-TIDE                        PIC X(12).
           03 WSS-IND-STAT                        PIC X(01).
           03 WSS-CIC-STAT                        PIC X(01).
           03 WSS-IDC-IDEN.                      
              05 WSS-NUM-IDEN                     PIC X(08).
              05 WSS-IND-IDEN                     PIC X(01).
              05 WSS-GLS-IDEN                     PIC X(03).
           03 WSS-CIC-IESC                        PIC X(12).
           03 WSS-IPPH                VALUE 0     PIC 9(01).
              88 PRIMER-PAGE-HEADING  VALUE 0.
      *JJV
           03 WSS-COD-TOAX.
              05 WSS-COD-TOOA                     PIC X(03).
              05 WSS-COD-AOOA                     PIC X(03).
      *>>>>
*% END
*% IF PH_FIA
      *<<<< PH_FIA
      *DAD
      *     IF PRIMER-PAGE-HEADING
      *         MOVE 1 TO PRINT-SWITCH
      *         MOVE 0 TO PAGE-COUNTER
      *         MOVE 1 TO WSS-IPPH.
      *
      *>>>>
*% END
*% IF CH_FIA_ESC_COD_OFEF
      *<<<< CH_FIA_ESC_COD_OFEF
      *DAD
      * ESTE CODIGO DEBERIA IR EN LABEL PH_FIA, PERO POR ALGUNA
      * RAZON GENRPT NO LO GENERA EN ARCHIVO RD.
           IF PRIMER-PAGE-HEADING
               MOVE 1 TO PRINT-SWITCH
               MOVE 0 TO PAGE-COUNTER
               MOVE 1 TO WSS-IPPH
               GO TO FIN-CH-FIA-ESC-COD-OFEF.
      *
      *BUS-OFI busca oficina en tablas
      *DAD Cambia FIA-COD-OFFS y GLS-OFFS  por  ESC-COD-OFEF y GLS-OFEF.
           MOVE ESC-COD-OFEF IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFEF IN WSS-FIA.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIP IN WSS-FIA.
      *
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'Inicio de Captura de Parametros'.

      *Captura Tipo de Fecha
           DISPLAY 'TIPO FECHA (C:COMPUTACIONAL,R:REAL) : '.
           ACCEPT  WSS-IND-TFEC IN WSS-VARI.
           DISPLAY WSS-IND-TFEC IN WSS-VARI.
      *Captura Fecha de Informe
           DISPLAY 'FECHA INFORME ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FFOT IN WSS-VARI.
           DISPLAY WSS-FEC-FFOT IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIP IN WSS-VARI.
           DISPLAY WSS-COD-OFIP IN WSS-VARI.
      *Captura indicador de Identificador
           DISPLAY 'IDENTIFICADOR ( D:DEUDOR,F:FIADOR,E:ESCRITURA ) : '.
           ACCEPT  WSS-IND-TIDE IN WSS-VARI.
           DISPLAY WSS-IND-TIDE IN WSS-VARI.
      *Captura Identificador
           DISPLAY 'IDENTIFICADOR : '.
           ACCEPT  WSS-COD-TIDE IN WSS-VARI.
           DISPLAY WSS-COD-TIDE IN WSS-VARI.
      *Captura Estado de Fianzas
           DISPLAY 'ESTADO DE FIANZAS ( I:INGRESADAS,V:VIGENTES,'.
           DISPLAY '                    N:NO VIGENTES,*:TODAS,  '.
      *RVM: 08/05/1992
           DISPLAY '                    P:POR CONSTITUIR       ): '.
           ACCEPT  WSS-IND-STAT IN WSS-VARI.
           DISPLAY WSS-IND-STAT IN WSS-VARI.

           DISPLAY 'Fin    de Captura    de Parametros'.
           DISPLAY 'Inicio de Validacion de Parametros'.

      *VAL-MSC Valida miscelaneo de tabla : Tipo de Fecha
           DISPLAY WSS-IND-TFEC IN WSS-VARI.
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TFEC' TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-TFEC IN WSS-VARI TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TFEC IN WSS-FIA
               MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-TFEC IN WSS-VARI.

      *VAL-FEC Valida Fecha de Informe
           DISPLAY WSS-FEC-FFOT IN WSS-VARI.
           MOVE WSS-FEC-FFOT IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
      *DAD
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
      *
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE WSS-NUM-DFOT IN WSS-VARI TO WSS-NUM-DFOT IN WSS-FIA.
           MOVE WSS-NUM-MFOT IN WSS-VARI TO WSS-NUM-MFOT IN WSS-FIA.
           MOVE WSS-NUM-SFOT IN WSS-VARI TO WSS-NUM-SFOT IN WSS-FIA.
           MOVE WSS-NUM-AFOT IN WSS-VARI TO WSS-NUM-AFOT IN WSS-FIA.

           IF WSS-COD-OFIP IN WSS-VARI > SPACES
      *VAL-OFI Valida codigo de Oficina en TABLAS
               DISPLAY WSS-COD-OFIP IN WSS-VARI
               MOVE WSS-COD-OFIP IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIP IN WSS-FIA
               ELSE
                   DISPLAY MSG-GLS-DESC
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

      *VAL-MSC Valida miscelaneo de tabla : Tipo de Identificador
           DISPLAY WSS-IND-TIDE IN WSS-VARI.
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'TIDE' TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-TIDE IN WSS-VARI TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TIDE
               MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-TIDE.

      *Valida Identificador
           DISPLAY WSS-COD-TIDE.
           IF WSS-CIC-TIDE IN WSS-VARI = 'D' OR
              WSS-CIC-TIDE IN WSS-VARI = 'F'
               MOVE WSS-COD-TIDE IN WSS-VARI TO WSS-IDC-IDEN IN WSS-VARI
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE WSS-IDC-IDEN IN WSS-VARI TO DBC-IDC-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO WSS-GLS-IDEN IN WSS-FIA
           ELSE
           IF WSS-CIC-TIDE IN WSS-VARI = 'E'
      *Valida Codigo de Escritura
               MOVE WSS-COD-TIDE IN WSS-VARI TO WSS-CIC-IESC IN WSS-VARI
               MOVE WSS-CIC-IESC IN WSS-VARI TO ESC-CIC-IESC IN ESC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM DEU-FIO-ESC
               IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'ESCIESCNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
               ELSE
                   MOVE SPACES TO WSS-GLS-IDEN IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-IDEN IN WSS-FIA
               MOVE SPACES TO WSS-CIC-TIDE IN WSS-VARI.

      *DAD
      *VAL-COD Valida codigo de tabla : Verificacion de Fianzas
           DISPLAY WSS-IND-STAT IN WSS-VARI.
           MOVE 'GNS'        TO TAB-COD-SIST.
           MOVE 'EST'        TO TAB-COD-TTAB IN TAB.
           MOVE WSS-IND-STAT IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS > SPACES
      *RVM:
               DISPLAY 'ERROR: Cod. Estado Fianza no existe o no vigte.'
               DISPLAY TAB-GLS-DESC IN TAB ' ' WSS-IND-STAT IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-STAT IN WSS-FIA
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-STAT IN WSS-VARI.
      *
      *DAD
      *Compara Fecha Informe con Fecha de HOY al pedir Fianzas No Verificadas.
           IF WSS-IND-STAT IN WSS-VARI = 'I'
               MOVE WSS-FEC-FFOT IN WSS-VARI TO FEC-FECH
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-HOY  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-EQL
                   NEXT SENTENCE
               ELSE
                   DISPLAY 'ERROR :  FECHA INFORME : ' WSS-FEC-FFOT
                           ' DISTINTA FECHA DE HOY AL PEDIR'
                   DISPLAY '         ESTADO FIANZAS = I:INGRESADAS'
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
      *
           DISPLAY 'Fin de Validacion de Parametros'.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Se debe leer ESC para comparar fechas 
           MOVE FIA-CIC-IESC IN FIA TO ESC-CIC-IESC IN ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'ESCIESCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG ' ' FIA-CIC-IESC IN FIA
               GO TO NXT-INP-SRT.

           MOVE WSS-FEC-FFOT IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
      *DAD
           IF WSS-CIC-TFEC = 'R' AND
              ESC-FEC-FCTT IN ESC > ZEROES
               MOVE ESC-NUM-DCTT IN ESC TO FEC-DEC1
               MOVE ESC-NUM-MCTT IN ESC TO FEC-MEC1
               MOVE ESC-NUM-SCTT IN ESC TO FEC-SEC1
               MOVE ESC-NUM-ACTT IN ESC TO FEC-AEC1
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   GO TO NXT-INP-SRT
               ELSE
                   NEXT SENTENCE
           ELSE
           IF WSS-CIC-TFEC = 'C' AND
              ESC-FEC-FINP IN ESC > ZEROES
               MOVE ESC-NUM-DINP IN ESC TO FEC-DEC1
               MOVE ESC-NUM-MINP IN ESC TO FEC-MEC1
               MOVE ESC-NUM-SINP IN ESC TO FEC-SEC1
               MOVE ESC-NUM-AINP IN ESC TO FEC-AEC1
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   GO TO NXT-INP-SRT.

           IF WSS-CIC-STAT = 'I'
      *DAD     IF FIA-MSC-STAT = 'V'
               IF FIA-MSC-STAT = 'S'
                   GO TO NXT-INP-SRT
               ELSE
                   GO TO CON-SEL-PAR.

           IF WSS-CIC-STAT = '*'
               GO TO CON-SEL-PAR.


      *RVM: 08/05/1992
           IF ( 
               WSS-CIC-STAT = 'P' AND
               FIA-MSC-STAT NOT = 'P' 
              )
                GO TO NXT-INP-SRT.

               
      *DAD IF FIA-MSC-STAT NOT = 'V'
      *     IF FIA-MSC-STAT NOT = 'S'
      *         GO TO NXT-INP-SRT.


      *RVM: 08/05/1992 Se ingresa nuevo estado 'P' por constituirse
           IF NOT ( 
                    FIA-MSC-STAT = 'S' OR 'P'
                  )
                    GO TO NXT-INP-SRT.


           IF WSS-CIC-TFEC = 'R' AND WSS-CIC-STAT = 'V'
               IF FIA-FEC-FALZ NOT > ZEROES
                   GO TO CON-SEL-PAR
               ELSE
                   MOVE FIA-NUM-DALZ IN FIA TO FEC-DEC1
                   MOVE FIA-NUM-MALZ IN FIA TO FEC-MEC1
                   MOVE FIA-NUM-SALZ IN FIA TO FEC-SEC1
                   MOVE FIA-NUM-AALZ IN FIA TO FEC-AEC1
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       GO TO CON-SEL-PAR
                   ELSE
                       GO TO NXT-INP-SRT.
           IF WSS-CIC-TFEC = 'C' AND WSS-CIC-STAT = 'V'
               IF FIA-FEC-FOUT NOT > ZEROES
                   GO TO CON-SEL-PAR
               ELSE
                   MOVE FIA-NUM-DOUT IN FIA TO FEC-DEC1
                   MOVE FIA-NUM-MOUT IN FIA TO FEC-MEC1
                   MOVE FIA-NUM-SOUT IN FIA TO FEC-SEC1
                   MOVE FIA-NUM-AOUT IN FIA TO FEC-AEC1
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       GO TO CON-SEL-PAR
                   ELSE
                       GO TO NXT-INP-SRT.

           IF WSS-CIC-TFEC = 'R' AND WSS-CIC-STAT = 'N'
               IF FIA-FEC-FALZ NOT > ZEROES
                   GO TO NXT-INP-SRT
               ELSE
                   MOVE FIA-NUM-DALZ IN FIA TO FEC-DEC1
                   MOVE FIA-NUM-MALZ IN FIA TO FEC-MEC1
                   MOVE FIA-NUM-SALZ IN FIA TO FEC-SEC1
                   MOVE FIA-NUM-AALZ IN FIA TO FEC-AEC1
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       GO TO NXT-INP-SRT
                   ELSE
                       GO TO CON-SEL-PAR.
           IF WSS-CIC-TFEC = 'C' AND WSS-CIC-STAT = 'N'
               IF FIA-FEC-FOUT NOT > ZEROES
                   GO TO NXT-INP-SRT
               ELSE
                   MOVE FIA-NUM-DOUT IN FIA TO FEC-DEC1
                   MOVE FIA-NUM-MOUT IN FIA TO FEC-MEC1
                   MOVE FIA-NUM-SOUT IN FIA TO FEC-SEC1
                   MOVE FIA-NUM-AOUT IN FIA TO FEC-AEC1
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       GO TO NXT-INP-SRT.
      *
       CON-SEL-PAR.           
      *DAD Cambia FIA-COD-OFFS  por  ESC-COD-OFEF.
           IF WSS-COD-OFIP IN WSS-VARI NOT = SPACES AND
              WSS-COD-OFIP IN WSS-VARI NOT = ESC-COD-OFEF IN ESC
               GO TO NXT-INP-SRT.
      *
      *CIC-CLI Busca Cliente por medio de CIC
           MOVE FIA-CIC-ICLI IN FIA TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES              TO SRT-NUM-RUTD IN SRT
               MOVE SPACES              TO SRT-VRF-RUTD IN SRT
               MOVE SPACES              TO SRT-IND-RUTD IN SRT
               MOVE SPACES              TO SRT-GLS-RUTD IN SRT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO SRT-GLS-NOMD IN SRT
               MOVE DBC-NUM-ICLI IN DBC TO SRT-NUM-RUTD IN SRT
               MOVE DBC-VRF-ICLI IN DBC TO SRT-VRF-RUTD IN SRT
               MOVE DBC-IND-ICLI IN DBC TO SRT-IND-RUTD IN SRT
               MOVE DBC-GLS-ICLI IN DBC TO SRT-GLS-RUTD IN SRT.

           IF WSS-CIC-TIDE IN WSS-VARI = 'D'
               IF WSS-IDC-IDEN IN WSS-VARI NOT = DBC-IDC-ICLI IN DBC
                   GO TO NXT-INP-SRT.

      *CIC-CLI Busca Cliente por medio de CIC
           MOVE FIA-CIC-ICFS IN FIA TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES              TO SRT-NUM-RUTF IN SRT
               MOVE SPACES              TO SRT-VRF-RUTF IN SRT
               MOVE SPACES              TO SRT-IND-RUTF IN SRT
               MOVE SPACES              TO SRT-GLS-RUTF IN SRT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO SRT-GLS-NOMF IN SRT
               MOVE DBC-NUM-ICLI IN DBC TO SRT-NUM-RUTF IN SRT
               MOVE DBC-VRF-ICLI IN DBC TO SRT-VRF-RUTF IN SRT
               MOVE DBC-IND-ICLI IN DBC TO SRT-IND-RUTF IN SRT
               MOVE DBC-GLS-ICLI IN DBC TO SRT-GLS-RUTF IN SRT.

           IF WSS-CIC-TIDE IN WSS-VARI = 'F'
               IF WSS-IDC-IDEN IN WSS-VARI NOT = DBC-IDC-ICLI IN DBC
                   GO TO NXT-INP-SRT
           ELSE
           IF WSS-CIC-TIDE IN WSS-VARI = 'E'        
               IF WSS-CIC-IESC IN WSS-VARI NOT = ZEROES AND
                  WSS-CIC-IESC IN WSS-VARI NOT = SPACES
                   IF WSS-CIC-IESC IN WSS-VARI NOT = FIA-CIC-IESC IN FIA
                       GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
      *BUS-OFI busca oficina en tablas
      *DAD Cambia FIA-COD-OFFS y GLS-OFFS  por  ESC-COD-OFEF y GLS-OFEF.
           MOVE ESC-COD-OFEF IN SRT TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFEF IN WSS-FIA.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIP IN WSS-FIA.
      *
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *Busqueda de glosas de Fianza

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FIA-MSC-TVLF IN SRT > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE FIA-MSC-TVLF IN SRT TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVLF IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-TVLF IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-TOFS IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-TOFS IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOFS IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-TOFS IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF ESC-COD-ABOC IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ABG' TO TAB-COD-TTAB IN TAB
               MOVE ESC-COD-ABOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-ABOC IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-ABOC IN WSS-FIA.
      *BUS-USR busca usuario en tablas
           IF ESC-COD-RCTT IN SRT > SPACES
               MOVE ESC-COD-RCTT IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-EJEC IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF ESC-COD-NOTC IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'NOT' TO TAB-COD-TTAB IN TAB
               MOVE ESC-COD-NOTC IN ESC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-NOTC IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-NOTC IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-VCLF IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-VCLF IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCLF IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-VCLF IN WSS-FIA.

      *Fin busqueda de glosas de Fianza
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           MOVE FIA-CIC-IESC IN SRT TO AMF-CIC-IESC IN AMF.
           MOVE FIA-NUM-IFIA IN SRT TO AMF-NUM-IFIA IN AMF.
           MOVE 0                   TO AMF-NUM-IAMF IN AMF.
           MOVE FIO-GET-NLS TO FIO-CMND.
       GET-NXT-AMF.
           PERFORM DEU-FIO-AMF.
           IF NOT FIO-STAT-OKS OR
              AMF-CIC-IESC IN AMF NOT = FIA-CIC-IESC IN SRT OR
              AMF-NUM-IFIA IN AMF NOT = FIA-NUM-IFIA IN SRT
               GO TO GEN-DL-ALZ.

      *Busqueda de glosas de Ambito

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF AMF-MSC-TVOA IN AMF NOT = SPACES  
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE AMF-MSC-TVOA IN AMF TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-TVOA IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-TOOA IN AMF NOT = SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-TOOA IN AMF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-TOOA IN WSS-FIA.
      *BUS-OFI busca oficina en tablas
           IF AMF-COD-OFOA IN AMF NOT = SPACES
               MOVE AMF-COD-OFOA IN AMF TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-OFOA IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-VCOA IN AMF NOT = SPACES  
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-VCOA IN AMF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-VCOA IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-AOOA IN AMF NOT = SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
      *JJV     MOVE AMF-COD-AOOA IN AMF TO TAB-COD-CTAB IN TAB
      *JJV
               MOVE AMF-COD-TOOA IN AMF TO WSS-COD-TOOA IN WSS-VARI
               MOVE AMF-COD-AOOA IN AMF TO WSS-COD-AOOA IN WSS-VARI 
               MOVE WSS-COD-TOAX IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *JJV
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AOOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-AOOA IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-CDOA IN AMF NOT = SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'DES' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-CDOA IN AMF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CDOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-CDOA IN WSS-FIA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-VCLA IN AMF NOT = SPACES  
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-VCLA IN AMF TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCLA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-VCLA IN WSS-FIA.

      *Fin busqueda de glosas de Ambito

           GENERATE DL-AMF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO GET-NXT-AMF.

       GEN-DL-ALZ. 
      *Busqueda de glosas de Alzamiento
      *DAD  IF FIA-NUM-SSOL IN SRT NOT > ZEROES
           IF FIA-NUM-SSOL IN SRT NOT NUMERIC
               OR FIA-NUM-SSOL IN SRT = ZEROES
                   GO TO GEN-DL-FIN.
      *
      *BUS-USR busca usuario en tablas
           IF FIA-COD-RAUT IN SRT > SPACES 
               MOVE FIA-COD-RAUT IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RAUT IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-RAUT IN WSS-FIA.
      *DAD  Cambia Busqueda en T. USR (BUS-USR)  por  T. ABG (BUS-TAB).
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-ABOA IN SRT > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ABG' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-ABOA IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-ABOA IN WSS-FIA
           ELSE
               MOVE SPACES TO WSS-GLS-ABOA IN WSS-FIA.
      *
      *Fin busqueda de glosas de Alzamiento

           GENERATE DL-ALZ.
       GEN-DL-FIN.
           GENERATE DL-FIN. 
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGFEC.
       COPY GNSBGHOY.

       COPY GNSBBTAB.
       COPY GNSBVTAB.
      * COPY GNSBFTAB.

       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.

       COPY GNSBBMSG.
      * COPY GNSBFMSG.

       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.

       COPY TABBBUSR.
       COPY TABBFUSR.

       COPY SGCBFDBC.
       COPY SGCBGCLI.

       COPY DEUBFESC.
       COPY DEUBFAMF.
       COPY GNSBGCPT.
      *>>>>
*% END
