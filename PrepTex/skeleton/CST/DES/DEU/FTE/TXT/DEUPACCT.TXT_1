*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_CLF = TRUE
*% IF WSS
      *<<<< WSS
       COPY GNSWGCPT.
       COPY COLBRCEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CEN-REQA==.
       COPY DEUBRCIP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIP-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY DEUWXCCT.
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).

       01 WSS-VARI.
          03 WCC-N           VALUE 'N'             PIC X(01).
          03 WCC-S           VALUE 'S'             PIC X(01).
          03 WCC-ASO         VALUE 'ASO'           PIC X(03).
          03 WCC-ING         VALUE 'ING'           PIC X(03).
          03 WCC-EMI         VALUE 'EMI'           PIC X(03).
          03 WCC-TOD         VALUE 'TOD'           PIC X(03).
          03 WCC-CCT         VALUE 'CCT'           PIC X(03).
          03 WSS-IND-OKS                           PIC X(01).
          03 WSS-EXI-TCEN                          PIC X(01).
          03 WSS-CIP-ANTE                          PIC X(12).
          03 WSS-COD-COMA   VALUE SPACES           PIC X(12).
          03 WSS-TIP-COMA                          PIC X(03).
          03 WSS-FEC-FINI.
              05 WSS-NUM-SINI                      PIC 9(02).
              05 WSS-NUM-AINI                      PIC 9(02).
              05 WSS-NUM-MINI                      PIC 9(02).
              05 WSS-NUM-DINI                      PIC 9(02).
          03 WSS-FEC-FTER.
              05 WSS-NUM-STER                      PIC 9(02).
              05 WSS-NUM-ATER                      PIC 9(02).
              05 WSS-NUM-MTER                      PIC 9(02).
              05 WSS-NUM-DTER                      PIC 9(02).       
           03 WSS-VEC-CCT.
              05 WSS-ARR-CCT      OCCURS 500 TIMES.
                 07 WSS-CIC-ICER                    PIC X(12).
                 07 WSS-NUM-ICIP                    PIC 9(03).
                 07 WSS-FEC-FVIG.
                    09 WSS-NUM-DVIG                 PIC 9(02).
                    09 WSS-NUM-MVIG                 PIC 9(02).
                    09 WSS-NUM-SVIG                 PIC 9(02).
                    09 WSS-NUM-AVIG                 PIC 9(02).
                 07 WSS-FEC-FEMI.
                    09 WSS-NUM-DEMI                 PIC 9(02).
                    09 WSS-NUM-MEMI                 PIC 9(02).
                    09 WSS-NUM-SEMI                 PIC 9(02).
                    09 WSS-NUM-AEMI                 PIC 9(02).
                 07 WSS-GLS-COMA                    PIC X(12).
                 07 WSS-CIC-IOPC.
                    09 WSS-CAI-IOPC                 PIC X(04).
                    09 WSS-IIC-IOPC                 PIC 9(08).
                 07 WSS-IND-DUSO                    PIC X(01).
           03 WSS-IND-VEC                           PIC 9(03).
           03 WSS-VEC-MAX            VALUE 500      PIC 9(03).
           03 WSS-GLS-UNO            VALUE 1        PIC 9(01).
           03 WSS-GLS-SI             VALUE 'S'      PIC X(01).
           03 WSS-GLS-NO             VALUE 'N'      PIC X(01).
           03 WSS-GLS-IMP            VALUE 'IMP'    PIC X(03).
           03 WSS-GLS-CIP            VALUE 'CIP'    PIC X(03).           
           03 WSS-I                  VALUE ZEROES   PIC  9(03).
           03 WSS-ICT             VALUE 'DEUPUICT'  PIC  X(12).
           03 WSS-IC2             VALUE 'DEUPUIC2'  PIC  X(12).
           03 WCC-CIPSINDETA   VALUE 'CIPSINDETA '  PIC  X(11).
           03 WCC-SOLOCLIENTE  VALUE 'SOLOCLIENTE'  PIC  X(11).
           03 WCC-DEU          VALUE 'DEU'          PIC  X(03).           
      *>>>>
*% END
*% IF MI_COMMAREA
           03 SCR-NUM-PANT               PIC 9(0005).
           03 SCR-CCT-FLD                PIC X(110).
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
               PERFORM CLR-FRM VARYING WSS-I FROM 1 BY 1
                                 UNTIL WSS-I > WSS-IMAX
                MOVE TSK-TERM-ALF TO CCT-COD-TERM
                MOVE TSK-TERM-ALF TO CCT-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO CCT-COD-TERM
                MOVE EIBTRMID     TO CCT-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-CCT-FLD TO CCT-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE CCT-NOM-TSCCT TO QUE-COLA
               MOVE CCT-LEN-TSCCT TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-CCT-FLD TO CCT-FLD
                  GO TO FIN-INI.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CCT
               PERFORM VAL-NUM-FLD-CCT
               PERFORM SCRL-TAB-CCT
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           MOVE CCT-NOM-TSCCT     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE CCT-NOM-TSCCT-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           GO TO REV-COM-ENT.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       REV-COM-ENT.

           MOVE FRM-NUM-DINI IN CCT-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE FRM-NUM-MINI IN CCT-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE FRM-NUM-SINI IN CCT-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE FRM-NUM-AINI IN CCT-FLD TO WSS-NUM-AINI IN WSS-VARI.
           MOVE FRM-NUM-DTER IN CCT-FLD TO WSS-NUM-DTER IN WSS-VARI.
           MOVE FRM-NUM-MTER IN CCT-FLD TO WSS-NUM-MTER IN WSS-VARI.
           MOVE FRM-NUM-STER IN CCT-FLD TO WSS-NUM-STER IN WSS-VARI.
           MOVE FRM-NUM-ATER IN CCT-FLD TO WSS-NUM-ATER IN WSS-VARI.
           MOVE FRM-IND-CONS IN CCT-FLD TO WSS-TIP-COMA IN WSS-VARI.

           PERFORM VAL-FEC-FECH.
           IF FRM-MEN2 NOT = SPACES
               GO TO FIN-FND-KEY.

           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WSS-TIP-COMA IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.

           MOVE ZEROES TO WSS-IND-VEC IN WSS-VARI.
           
           IF FRM-IND-CONS IN CCT-FLD = WCC-ASO
               IF DBC-NUM-ICLI IN CCT-FLD > ZEROES AND
                  DBC-NUM-ICLI IN CCT-FLD > SPACES
                   PERFORM PRO-CCA-FECC
               ELSE
                   PERFORM PRO-CCA-FECO
           ELSE
               NEXT SENTENCE.

           IF FRM-IND-CONS IN CCT-FLD = WCC-EMI
               IF DBC-NUM-ICLI IN CCT-FLD > ZEROES AND
                  DBC-NUM-ICLI IN CCT-FLD > SPACES
                   PERFORM PRO-CCE-FECC
               ELSE
                   PERFORM PRO-CCE-FECO
           ELSE
               NEXT SENTENCE.

           IF FRM-IND-CONS IN CCT-FLD = WCC-ING
               IF DBC-NUM-ICLI IN CCT-FLD > ZEROES AND
                  DBC-NUM-ICLI IN CCT-FLD > SPACES
                   PERFORM PRO-CCI-FECC
               ELSE
                   MOVE WCC-SOLOCLIENTE TO MSG-COD-MENS
                   MOVE WCC-DEU TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-FND-KEY
           ELSE
               NEXT SENTENCE.

           IF FRM-IND-CONS IN CCT-FLD = WCC-TOD
               IF DBC-NUM-ICLI IN CCT-FLD > ZEROES AND
                  DBC-NUM-ICLI IN CCT-FLD > SPACES
                   PERFORM PRO-CCT-FECC
               ELSE
                   PERFORM PRO-CCT-FECO
           ELSE
               NEXT SENTENCE.

           IF FRM-NUM-OCUR IN CCT-FLD NOT > ZEROES OR
              FRM-NUM-OCUR IN CCT-FLD IS NOT NUMERIC
               MOVE ZEROES TO FRM-NUM-OCUR IN CCT-FLD.

           IF WSS-IND-VEC < WSS-GLS-UNO OR
              WSS-IND-VEC < FRM-NUM-OCUR IN CCT-FLD
               MOVE 'REGNEX    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               SET FIO-STAT-ERR TO TRUE
               MOVE 'S' TO SCR-IERR
               GO TO FIN-FND-KEY.

           PERFORM CAR-FLD-CCT.

           PERFORM PUT-TAB.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGCPT.
       COPY COLBFCEN.
       COPY DEUBFCIP.
       COPY SGCBFDBC.
       COPY COLBFRDC.

       VAL-FEC-FECH SECTION.
       INI-VAL-FEC-FECH.
           MOVE SPACES TO FRM-MEN2.

           IF WSS-FEC-FINI IN WSS-VARI NOT > ZEROES OR
              WSS-FEC-FTER IN WSS-VARI NOT > ZEROES
               GO TO FIN-VAL-FEC-FECH.

           IF WSS-FEC-FINI IN WSS-VARI > WSS-FEC-FTER IN WSS-VARI
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCTFECINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
               GO TO FIN-VAL-FEC-FECH.
       FIN-VAL-FEC-FECH.
           EXIT.

       OBT-CIC-ICLI SECTION.
       INI-OBT-CIC-ICLI.
           MOVE OPC-CIC-IOPC IN OPC     TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC
           MOVE 'RDC-KEY-IDLC'          TO FIO-AKEY.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-RDC.

           IF NOT FIO-STAT-OKS
              GO TO FIN-OBT-CIC-ICLI.

           MOVE RDC-CIC-ICLI IN RDC     TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

       FIN-OBT-CIC-ICLI.
           EXIT.

       CAR-VEC SECTION.
       INI-CAR-VEC.
           MOVE WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           MOVE SPACES TO CEN.
           MOVE WSS-GLS-IMP             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CIC-IOPC IN OPC     TO CEN-CIC-IENT IN CEN.
           MOVE SPACES                  TO CEN-COD-CREN IN CEN.
           MOVE SPACES                  TO CEN-COD-SREN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-IENT IN CEN.
           MOVE SPACES                  TO CEN-CIC-ISEN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-ISEN IN CEN.
           MOVE FIO-GET-NLS             TO FIO-CMND.

       LUP-CEN.
           PERFORM COL-FIO-CEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CAR-VEC.

           IF CEN-CIC-IENT IN CEN NOT = OPC-CIC-IOPC IN OPC OR
              CEN-COD-ENTI IN CEN NOT = WSS-GLS-IMP
              GO TO FIN-CAR-VEC.

           MOVE SPACES TO CIP.
           MOVE CEN-COD-COD1 IN CEN     TO CIP-CIC-ICER IN CIP.
           MOVE ZEROES                  TO CIP-NUM-ICIP IN CIP.
           MOVE FIO-GET-NLS             TO FIO-CMND.

       LUP-CIP.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS
               GO TO NXT-CEN.

           IF CIP-CIC-ICER IN CIP NOT = CEN-COD-COD1 IN CEN
              GO TO NXT-CEN.

           MOVE CIP-CIC-IOPC IN CIP     TO WSS-CIC-IOPC(WSS-IND-VEC).
           MOVE CIP-CIC-ICER IN CIP     TO WSS-CIC-ICER(WSS-IND-VEC).
           MOVE CIP-NUM-ICIP IN CIP     TO WSS-NUM-ICIP(WSS-IND-VEC).
           MOVE CIP-NUM-DVIG IN CIP     TO WSS-NUM-DVIG(WSS-IND-VEC).
           MOVE CIP-NUM-MVIG IN CIP     TO WSS-NUM-MVIG(WSS-IND-VEC).
           MOVE CIP-NUM-SVIG IN CIP     TO WSS-NUM-SVIG(WSS-IND-VEC).
           MOVE CIP-NUM-AVIG IN CIP     TO WSS-NUM-AVIG(WSS-IND-VEC).
           MOVE CIP-NUM-DEMI IN CIP     TO WSS-NUM-DEMI(WSS-IND-VEC).
           MOVE CIP-NUM-MEMI IN CIP     TO WSS-NUM-MEMI(WSS-IND-VEC).
           MOVE CIP-NUM-SEMI IN CIP     TO WSS-NUM-SEMI(WSS-IND-VEC).
           MOVE CIP-NUM-AEMI IN CIP     TO WSS-NUM-AEMI(WSS-IND-VEC).
           MOVE WSS-COD-COMA IN WSS-VARI TO WSS-GLS-COMA(WSS-IND-VEC).
           MOVE CIP-IND-DUSO IN CIP     TO WSS-IND-DUSO(WSS-IND-VEC).

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-CAR-VEC.

       NXT-CIP.
           MOVE FIO-GET-NXT             TO FIO-CMND.
           GO TO LUP-CIP.

       NXT-CEN.
           MOVE FIO-GET-NXT             TO FIO-CMND.
           GO TO LUP-CEN.

       FIN-CAR-VEC.
           EXIT.

       CAR-FLD-CCT SECTION.
       INI-CAR-FLD-CCT.

           MOVE ZEROES TO WSS-J IN CCT-VARI.

       LOOP-CARGA.
           ADD 1 TO WSS-J IN CCT-VARI.
           IF WSS-J IN CCT-VARI > WSS-JMAX IN CCT-VARI
               GO TO FIN-CAR-FLD-CCT.

           IF (WSS-J IN CCT-VARI <= WSS-IND-VEC IN WSS-VARI)
                NEXT SENTENCE
           ELSE
               GO TO FIN-CAR-FLD-CCT.

           PERFORM CLR-CCT-VEC.
           MOVE WSS-CAI-IOPC(WSS-J)  TO FRM-CAI-IOPC-V(WSS-J).
           MOVE WSS-IIC-IOPC(WSS-J)  TO FRM-IIC-IOPC-V(WSS-J).
           MOVE WSS-CIC-ICER(WSS-J)  TO FRM-CIC-ICER-V(WSS-J).
           MOVE WSS-NUM-ICIP(WSS-J)  TO FRM-NUM-ICIP-V(WSS-J).
           MOVE WSS-NUM-DVIG(WSS-J)  TO FRM-NUM-DVIG-V(WSS-J).
           MOVE WSS-NUM-MVIG(WSS-J)  TO FRM-NUM-MVIG-V(WSS-J).
           MOVE WSS-NUM-SVIG(WSS-J)  TO FRM-NUM-SVIG-V(WSS-J).
           MOVE WSS-NUM-AVIG(WSS-J)  TO FRM-NUM-AVIG-V(WSS-J).
           MOVE WSS-NUM-DEMI(WSS-J)  TO FRM-NUM-DEMI-V(WSS-J).
           MOVE WSS-NUM-MEMI(WSS-J)  TO FRM-NUM-MEMI-V(WSS-J).
           MOVE WSS-NUM-SEMI(WSS-J)  TO FRM-NUM-SEMI-V(WSS-J).
           MOVE WSS-NUM-AEMI(WSS-J)  TO FRM-NUM-AEMI-V(WSS-J).
           MOVE WSS-GLS-COMA(WSS-J)  TO FRM-COD-ATRN-V(WSS-J).
           MOVE WSS-IND-DUSO(WSS-J)  TO FRM-IND-DUSO-V(WSS-J).

           GO TO LOOP-CARGA.

       FIN-CAR-FLD-CCT.
           EXIT.

       CLR-CCT-VEC SECTION.
       INI-CLR-CCT-VEC.
           MOVE SPACES TO FRM-CAI-IOPC-V(WSS-J).
           MOVE ZEROES TO FRM-IIC-IOPC-V(WSS-J).
           MOVE SPACES TO FRM-CIC-ICER-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-ICIP-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-DVIG-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-MVIG-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-SVIG-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-AVIG-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-DEMI-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-MEMI-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-SEMI-V(WSS-J).
           MOVE ZEROES TO FRM-NUM-AEMI-V(WSS-J).
           MOVE SPACES TO FRM-COD-ATRN-V(WSS-J).
           MOVE SPACES TO FRM-IND-DUSO-V(WSS-J).
       FIN-CLR-CCT-VEC.
           EXIT.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE CCT-NOM-TSCCT     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE CCT-NOM-TSCCT-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE SPACES TO CCT-VEC-TS.
           MOVE LOW-VALUES TO WSS-NUM-NCRE-IDX.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN CCT-VARI.

           MOVE 1 TO WSS-F IN CCT-VARI.

       LUP-PUT-TAB.
           IF WSS-F IN CCT-VARI > WSS-FMAX IN CCT-VARI
              GO TO FIN-PUT-TAB.

           IF WSS-IND-VEC IN WSS-VARI NOT > ZEROES
               MOVE WCC-CIPSINDETA TO MSG-COD-MENS
               MOVE WCC-DEU TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-F > WSS-IND-VEC IN WSS-VARI
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-CIC-ICER(WSS-F) > SPACES
               PERFORM PUT-TAB-CCT
               PERFORM PUT-CCT-QUE
               PERFORM SET-FRM-IFLD
           ELSE
               IF FRM-IFLD = 1 AND WSS-F = 1
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB
               ELSE
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN CCT-VARI.
           GO TO LUP-PUT-TAB.

       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE CCT-LEN-TSCCT-MAS  TO QUE-LITM.
           MOVE CCT-NOM-TSCCT-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO CCT-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO CCT-MAS-IND-HMAS.

           IF WSS-NITM > WSS-NITMMAX
               MOVE WSS-NITMMAX TO WSS-NUM-ICUR
           ELSE
               MOVE WSS-NITM TO WSS-NUM-ICUR.

           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO CCT-MAS-NUM-TOCC.
           MOVE CCT-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-CCT SECTION.
       INI-PUT-TAB-CCT.
           PERFORM CLR-WSS.

           MOVE FRM-CAI-IOPC-V(WSS-F)
                      TO FRM-CAI-IOPC-CCT     IN CCT-VARI.
           MOVE FRM-IIC-IOPC-V(WSS-F)
                      TO FRM-IIC-IOPC-CCT     IN CCT-VARI.
           MOVE FRM-CIC-ICER-V(WSS-F)
                      TO FRM-CIC-ICER-CCT     IN CCT-VARI.
           MOVE FRM-NUM-ICIP-V(WSS-F)
                      TO FRM-NUM-ICIP-CCT     IN CCT-VARI.
           MOVE FRM-NUM-DVIG-V(WSS-F)
                      TO FRM-NUM-DVIG-CCT     IN CCT-VARI.
           MOVE FRM-NUM-MVIG-V(WSS-F)
                      TO FRM-NUM-MVIG-CCT     IN CCT-VARI.
           MOVE FRM-NUM-SVIG-V(WSS-F)
                      TO FRM-NUM-SVIG-CCT     IN CCT-VARI.
           MOVE FRM-NUM-AVIG-V(WSS-F)
                      TO FRM-NUM-AVIG-CCT     IN CCT-VARI.
           MOVE FRM-NUM-DEMI-V(WSS-F)
                      TO FRM-NUM-DEMI-CCT     IN CCT-VARI.
           MOVE FRM-NUM-MEMI-V(WSS-F)
                      TO FRM-NUM-MEMI-CCT     IN CCT-VARI.
           MOVE FRM-NUM-SEMI-V(WSS-F)
                      TO FRM-NUM-SEMI-CCT     IN CCT-VARI.
           MOVE FRM-NUM-AEMI-V(WSS-F)
                      TO FRM-NUM-AEMI-CCT     IN CCT-VARI.
           MOVE FRM-COD-ATRN-V(WSS-F)
                      TO FRM-COD-ATRN-CCT     IN CCT-VARI.
           MOVE FRM-IND-DUSO-V(WSS-F)
                      TO FRM-IND-DUSO-CCT     IN CCT-VARI.

           MOVE FRM-CAI-IOPC-CCT     TO FRM-CAI-IOPC-FRM.
           MOVE FRM-IIC-IOPC-CCT     TO FRM-IIC-IOPC-FRM.
           MOVE FRM-CIC-ICER-CCT     TO FRM-CIC-ICER-FRM.
           MOVE FRM-NUM-ICIP-CCT     TO FRM-NUM-ICIP-FRM.
           MOVE FRM-NUM-DVIG-CCT     TO FRM-NUM-DVIG-FRM.
           MOVE FRM-NUM-MVIG-CCT     TO FRM-NUM-MVIG-FRM.
           MOVE FRM-NUM-SVIG-CCT     TO FRM-NUM-SVIG-FRM.
           MOVE FRM-NUM-AVIG-CCT     TO FRM-NUM-AVIG-FRM.
           MOVE FRM-NUM-DEMI-CCT     TO FRM-NUM-DEMI-FRM.
           MOVE FRM-NUM-MEMI-CCT     TO FRM-NUM-MEMI-FRM.
           MOVE FRM-NUM-SEMI-CCT     TO FRM-NUM-SEMI-FRM.
           MOVE FRM-NUM-AEMI-CCT     TO FRM-NUM-AEMI-FRM.
           MOVE FRM-COD-ATRN-CCT     TO FRM-COD-ATRN-FRM.
           MOVE FRM-IND-DUSO-CCT     TO FRM-IND-DUSO-FRM.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-CCT.

           IF WSS-F < FRM-NUM-OCUR IN CCT-FLD
               GO TO FIN-PUT-TAB-CCT.

           MOVE FRM-CAI-IOPC-V(WSS-F)
                      TO FRM-CAI-IOPC     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-IIC-IOPC-V(WSS-F)
                      TO FRM-IIC-IOPC     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-CIC-ICER-V(WSS-F)
                      TO FRM-CIC-ICER     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-CIC-ICER-V(WSS-F)
                      TO FRM-CIC-ICER     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-ICIP-V(WSS-F)
                      TO FRM-NUM-ICIP     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-DVIG-V(WSS-F)
                      TO FRM-NUM-DVIG     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-MVIG-V(WSS-F)
                      TO FRM-NUM-MVIG     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-SVIG-V(WSS-F)
                      TO FRM-NUM-SVIG     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-AVIG-V(WSS-F)
                      TO FRM-NUM-AVIG     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-DEMI-V(WSS-F)
                      TO FRM-NUM-DEMI     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-MEMI-V(WSS-F)
                      TO FRM-NUM-MEMI     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-SEMI-V(WSS-F)
                      TO FRM-NUM-SEMI     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-NUM-AEMI-V(WSS-F)
                      TO FRM-NUM-AEMI     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-COD-ATRN-V(WSS-F)
                      TO FRM-COD-ATRN     IN CCT-FLD(FRM-IFLD).
           MOVE FRM-IND-DUSO-V(WSS-F)
                      TO FRM-IND-DUSO     IN CCT-FLD(FRM-IFLD).

       FIN-PUT-TAB-CCT.
           EXIT.
      *----------------------------------------------------------------
       CLR-WSS SECTION.
       INI-CLR-WSS.

           MOVE SPACES TO FRM-CAI-IOPC-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-IIC-IOPC-CCT IN CCT-VARI.
           MOVE SPACES TO FRM-CIC-ICER-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-ICIP-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-DVIG-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-MVIG-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-SVIG-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-AVIG-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-DEMI-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-MEMI-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-SEMI-CCT IN CCT-VARI.
           MOVE ZEROES TO FRM-NUM-AEMI-CCT IN CCT-VARI.
           MOVE SPACES TO FRM-COD-ATRN-CCT IN CCT-VARI.
           MOVE SPACES TO FRM-IND-DUSO-CCT IN CCT-VARI.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.

       FIN-CLR-WSS.
           EXIT.
      *-----------------------------------------------------------------
       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.

           MOVE SPACES TO FRM-CAI-IOPC IN CCT-FLD(1).
           MOVE ZEROES TO FRM-IIC-IOPC IN CCT-FLD(1).
           MOVE SPACES TO FRM-CIC-ICER IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-ICIP IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-DVIG IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-MVIG IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-SVIG IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-AVIG IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-DEMI IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-MEMI IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-SEMI IN CCT-FLD(1).
           MOVE ZEROES TO FRM-NUM-AEMI IN CCT-FLD(1).
           MOVE SPACES TO FRM-COD-ATRN IN CCT-FLD(1).
           MOVE SPACES TO FRM-IND-DUSO IN CCT-FLD(1).

       FIN-CLR-FRM-MTX.
           EXIT.
      *----------------------------------------------------------------
       PUT-CCT-QUE SECTION.
       INI-PUT-CCT-QUE.

           IF WSS-F < FRM-NUM-OCUR IN CCT-FLD
               GO TO FIN-PUT-CCT-QUE.

           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE CCT-NOM-TSCCT    TO QUE-COLA.
           MOVE CCT-LEN-TSCCT    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
               IF NOT (WSS-NITM > WSS-NITMMAX)

                   MOVE FRM-IIC-IOPC-V(WSS-F)
                           TO FRM-IIC-IOPC-EDT
                   MOVE FRM-IIC-IOPC-EDT IN CCT-EDT
                           TO FRM-IIC-IOPC-ALF-CCT IN CCT-VARI
                   MOVE FRM-NUM-ICIP-V(WSS-F)
                           TO FRM-NUM-ICIP-EDT
                   MOVE FRM-NUM-ICIP-EDT IN CCT-EDT
                           TO FRM-NUM-ICIP-ALF-CCT IN CCT-VARI
                   MOVE CCT-VEC-TS    TO QUE-ITEM
               ELSE
                   GO TO FIN-PUT-CCT-QUE
           ELSE
               MOVE WSS-NUM-NCRE-IDX TO QUE-ITEM.


           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-CCT-QUE.
           EXIT.
      *----------------------------------------------------------------
       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.

           MOVE 'P' TO FRM-CAI-IOPC-ATR-CCT.
           MOVE 'P' TO FRM-IIC-IOPC-ATR-CCT.
           MOVE 'P' TO FRM-CIC-ICER-ATR-CCT.
           MOVE 'P' TO FRM-NUM-ICIP-ATR-CCT.
           MOVE 'P' TO FRM-FEC-FVIG-ATR-CCT.
           MOVE 'P' TO FRM-FEC-FEMI-ATR-CCT.
           MOVE 'P' TO FRM-COD-ATRN-ATR-CCT.
           MOVE 'P' TO FRM-IND-DUSO-ATR-CCT.

       FIN-PRO-FLD-QUE.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                IF WSS-F < FRM-NUM-OCUR IN CCT-FLD
                    GO TO FIN-SET-FRM-IFLD
                ELSE
                    ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE CCT-NOM-TSCCT TO QUE-COLA.
           MOVE CCT-LEN-TSCCT TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'CCTTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-CAI-IOPC-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE CCT-NOM-TSCCT TO QUE-COLA
               MOVE CCT-LEN-TSCCT TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.
      *---------------------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.

           MOVE SPACES TO FRM-CAI-IOPC IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-IIC-IOPC IN CCT-FLD(WSS-I).
           MOVE SPACES TO FRM-CIC-ICER IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-ICIP IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-DVIG IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-MVIG IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-SVIG IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-AVIG IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-DEMI IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-MEMI IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-SEMI IN CCT-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-AEMI IN CCT-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-ATRN IN CCT-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-DUSO IN CCT-FLD(WSS-I).

       FIN-CLR-FRM.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE CCT-NOM-TSCCT TO QUE-COLA
           MOVE CCT-LEN-TSCCT TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-CAI-IOPC-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.
      *-----------------------------------------------------------------
       SCRL-TAB-CCT SECTION.
       INI-SCRL-TAB-CCT.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CCT.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCE-FECO SECTION.
       INI-PRO-CCE-FECO.

           MOVE SPACES TO WSS-CIP-ANTE IN WSS-VARI.

           MOVE SPACES TO CIP.
           MOVE OPC-CAI-IOPC IN CCT-FLD TO CIP-CAI-IOPC IN CIP.
           MOVE OPC-IIC-IOPC IN CCT-FLD TO CIP-IIC-IOPC IN CIP.
           MOVE SPACES                  TO CIP-COD-EVEN IN CIP.
           MOVE ZEROES                  TO CIP-NUM-ICAN IN CIP.
           MOVE SPACES                  TO CIP-COD-CPTO IN CIP.
           MOVE 'CIP-KEY-IIPT' TO FIO-AKEY.                             00006120
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CCE-FECO.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
              OPC-CAI-IOPC IN CCT-FLD NOT = CIP-CAI-IOPC IN CIP OR
              OPC-IIC-IOPC IN CCT-FLD NOT = CIP-IIC-IOPC IN CIP
               GO TO FIN-PRO-CCE-FECO.

      * DISTINTOS A IC2 E ICT SON EMITIDOS
           IF CIP-COD-ATRN IN CIP = WSS-ICT IN WSS-VARI OR
              CIP-COD-ATRN IN CIP = WSS-IC2 IN WSS-VARI
               GO TO NXT-CCE-FECO.

           PERFORM VAL-FEC-CIP.
           IF WSS-IND-OKS IN WSS-VARI = WCC-N
               GO TO NXT-CCE-FECO.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI
           PERFORM CAR-VEC-PANT.

       REC-CCE-FECO.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-PRO-CCE-FECO.

       NXT-CCE-FECO.
           MOVE 'CIP-KEY-IIPT' TO FIO-AKEY.                             00006120
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCE-FECO.
       FIN-PRO-CCE-FECO.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCE-FECC SECTION.
       INI-PRO-CCE-FECC.

           MOVE SPACES TO WSS-CIP-ANTE IN WSS-VARI.

           MOVE SPACES TO DBC.
           MOVE DBC-NUM-ICLI IN CCT-FLD TO DBC-NUM-ICLI IN DBC.         00006090
           MOVE DBC-IND-ICLI IN CCT-FLD TO DBC-IND-ICLI IN DBC.         00006100
           MOVE DBC-GLS-ICLI IN CCT-FLD TO DBC-GLS-ICLI IN DBC.         00006110
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.                             00006120
           MOVE FIO-GET-KEY    TO FIO-CMND.                             00006130
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                          00006150
               GO TO FIN-PRO-CCE-FECC.

           MOVE SPACES TO CIP.
           MOVE DBC-CIC-ICLI IN DBC TO CIP-CIC-ICLI IN CIP.
           MOVE 'CIP-CIC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CCE-FECC.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
              DBC-CIC-ICLI IN DBC NOT = CIP-CIC-ICLI IN CIP
               GO TO FIN-PRO-CCE-FECC.

      * DISTINTOS A IC2 E ICT SON EMITIDOS
           IF CIP-COD-ATRN IN CIP = WSS-ICT IN WSS-VARI OR
              CIP-COD-ATRN IN CIP = WSS-IC2 IN WSS-VARI
               GO TO NXT-CCE-FECC.

           PERFORM VAL-FEC-CIP.
           IF WSS-IND-OKS IN WSS-VARI = WCC-N
               GO TO NXT-CCE-FECC.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           PERFORM CAR-VEC-PANT.

       REC-CCE-FECC.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-PRO-CCE-FECC.

       NXT-CCE-FECC.
           MOVE 'CIP-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCE-FECC.
       FIN-PRO-CCE-FECC.
           EXIT.
      *-----------------------------------------------------------------
       CAR-VEC-PANT SECTION.
       INI-CAR-VEC-PANT.
      *CAR-VEC
           IF WSS-TIP-COMA IN WSS-VARI = WCC-ASO
               MOVE CEN-CIC-IENT IN CEN TO WSS-CIC-IOPC(WSS-IND-VEC)
           ELSE
               MOVE CIP-CIC-IOPC IN CIP TO WSS-CIC-IOPC(WSS-IND-VEC).

           MOVE CIP-CIC-ICER IN CIP      TO WSS-CIC-ICER(WSS-IND-VEC).
           MOVE CIP-NUM-ICIP IN CIP      TO WSS-NUM-ICIP(WSS-IND-VEC).
           MOVE CIP-NUM-DVIG IN CIP      TO WSS-NUM-DVIG(WSS-IND-VEC).
           MOVE CIP-NUM-MVIG IN CIP      TO WSS-NUM-MVIG(WSS-IND-VEC).
           MOVE CIP-NUM-SVIG IN CIP      TO WSS-NUM-SVIG(WSS-IND-VEC).
           MOVE CIP-NUM-AVIG IN CIP      TO WSS-NUM-AVIG(WSS-IND-VEC).
           MOVE CIP-NUM-DEMI IN CIP      TO WSS-NUM-DEMI(WSS-IND-VEC).
           MOVE CIP-NUM-MEMI IN CIP      TO WSS-NUM-MEMI(WSS-IND-VEC).
           MOVE CIP-NUM-SEMI IN CIP      TO WSS-NUM-SEMI(WSS-IND-VEC).
           MOVE CIP-NUM-AEMI IN CIP      TO WSS-NUM-AEMI(WSS-IND-VEC).
           MOVE WSS-COD-COMA IN WSS-VARI TO WSS-GLS-COMA(WSS-IND-VEC).
           MOVE CIP-IND-DUSO IN CIP      TO WSS-IND-DUSO(WSS-IND-VEC).
       FIN-CAR-VEC-PANT.
           EXIT.
      *-----------------------------------------------------------------
       PRO-BUS-CLIE SECTION.
       INI-PRO-BUS-CLIE.
           PERFORM OBT-CIC-ICLI.

           IF NOT FIO-STAT-OKS
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              MOVE 'TAB' TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN1
              SET FIO-STAT-ERR TO TRUE
              GO TO PRO-BUS-CLIE
           ELSE
              MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI-ALF IN CCT-FLD
              MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CCT-FLD
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO FRM-GLS-NOMC IN CCT-FLD.

       FIN-PRO-BUS-CLIE.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCA-FECO SECTION.
       INI-PRO-CCA-FECO.

           MOVE SPACES TO CEN.
           MOVE WSS-GLS-IMP             TO CEN-COD-ENTI IN CEN.
           MOVE OPC-CAI-IOPC IN CCT-FLD TO CEN-CAI-IENT IN CEN.
           MOVE OPC-IIC-IOPC IN CCT-FLD TO CEN-IIC-IENT IN CEN.
           MOVE SPACES                  TO CEN-COD-CREN IN CEN.
           MOVE SPACES                  TO CEN-COD-SREN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-IENT IN CEN.
           MOVE SPACES                  TO CEN-CIC-ISEN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-ISEN IN CEN.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CCA-OCEN.
           PERFORM COL-FIO-CEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-PRO-CCA-FECO.

           IF CEN-CAI-IENT IN CEN NOT = OPC-CAI-IOPC IN CCT-FLD OR
              CEN-IIC-IENT IN CEN NOT = OPC-IIC-IOPC IN CCT-FLD OR
              CEN-COD-ENTI IN CEN NOT = WSS-GLS-IMP
               GO TO FIN-PRO-CCA-FECO.

           MOVE SPACES TO CIP.
           MOVE CEN-CIC-ISEN IN CEN     TO CIP-CIC-ICER IN CIP.
           MOVE ZEROES                  TO CIP-NUM-ICIP IN CIP.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CCA-OCIP.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS
               GO TO NXT-CCA-OCEN.

           IF CIP-CIC-ICER IN CIP NOT = CEN-CIC-ISEN IN CEN
              GO TO NXT-CCA-OCEN.

           PERFORM VAL-FEC-CIP.
           IF WSS-IND-OKS IN WSS-VARI = WCC-N
               GO TO NXT-CCA-OCEN.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           PERFORM CAR-VEC-PANT.

       REC-CCA-FECO.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-PRO-CCA-FECO.

       NXT-CCA-OCIP.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCA-OCIP.

       NXT-CCA-OCEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCA-OCEN.

       FIN-PRO-CCA-FECO.
           EXIT.
      *-----------------------------------------------------------------
       VAL-FEC-CIP SECTION.
       INI-VAL-FEC-CIP.

           MOVE WCC-N TO WSS-IND-OKS IN WSS-VARI.

           IF WSS-FEC-FINI IN WSS-VARI = ZEROES AND
              WSS-FEC-FTER IN WSS-VARI = ZEROES
               MOVE WCC-S IN WSS-VARI TO WSS-IND-OKS IN WSS-VARI
               GO TO FIN-VAL-FEC-CIP.

           IF WSS-FEC-FINI IN WSS-VARI > ZEROES AND
              WSS-FEC-FTER IN WSS-VARI > ZEROES
               IF CIP-FEC-FVIG IN CIP >= WSS-FEC-FINI IN WSS-VARI AND
                  CIP-FEC-FVIG IN CIP <= WSS-FEC-FTER IN WSS-VARI
                   MOVE WCC-S IN WSS-VARI TO WSS-IND-OKS IN WSS-VARI
                   GO TO FIN-VAL-FEC-CIP
               ELSE
                   GO TO FIN-VAL-FEC-CIP
           ELSE
               NEXT SENTENCE.

           IF WSS-FEC-FINI IN WSS-VARI > ZEROES AND
              WSS-FEC-FTER IN WSS-VARI = ZEROES
               IF CIP-FEC-FVIG IN CIP >= WSS-FEC-FINI IN WSS-VARI
                   MOVE WCC-S IN WSS-VARI TO WSS-IND-OKS IN WSS-VARI
                   GO TO FIN-VAL-FEC-CIP
               ELSE
                   GO TO FIN-VAL-FEC-CIP
           ELSE
               NEXT SENTENCE.

           IF WSS-FEC-FINI IN WSS-VARI = ZEROES AND
              WSS-FEC-FTER IN WSS-VARI > ZEROES
               IF CIP-FEC-FVIG IN CIP <= WSS-FEC-FTER IN WSS-VARI
                   MOVE WCC-S IN WSS-VARI TO WSS-IND-OKS IN WSS-VARI
                   GO TO FIN-VAL-FEC-CIP
               ELSE
                   GO TO FIN-VAL-FEC-CIP
           ELSE
               NEXT SENTENCE.

       FIN-VAL-FEC-CIP.
           EXIT.
      *-----------------------------------------------------------------
       VAL-CIP-NCEN SECTION.
       INI-VAL-CIP-NCEN.

           MOVE WCC-N TO WSS-EXI-TCEN IN WSS-VARI.

           MOVE SPACES TO CEN.
           MOVE WSS-GLS-CIP IN WSS-VARI TO CEN-COD-CCSE IN CEN.
           MOVE CIP-CIC-ICER IN CIP     TO CEN-CIC-ISEN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-ISEN IN CEN.
           MOVE 'CEN-KEY-ISEN'          TO FIO-AKEY.
           MOVE FIO-GET-NLS             TO FIO-CMND.
           PERFORM COL-FIO-CEN.
           IF FIO-STAT-OKS AND
              CEN-CIC-ISEN IN CEN = CIP-CIC-ICER IN CIP AND
              CEN-COD-CCSE IN CEN = WSS-GLS-CIP IN WSS-VARI
               MOVE WCC-S TO WSS-EXI-TCEN IN WSS-VARI.

           IF FRM-IND-CONS IN CCT-FLD  = WCC-TOD IN WSS-VARI AND
              WSS-TIP-COMA IN WSS-VARI = WCC-ASO IN WSS-VARI AND
              WSS-EXI-TCEN IN WSS-VARI = WCC-S
               PERFORM INF-TOD-CEN.

       FIN-VAL-CIP-NCEN.
           EXIT.
      *-----------------------------------------------------------------
       INF-TOD-CEN SECTION.
       INI-INF-TOD-CEN.
           MOVE SPACES TO CEN.
           MOVE WSS-GLS-CIP IN WSS-VARI TO CEN-COD-CCSE IN CEN.
           MOVE CIP-CAI-ICER IN CIP     TO CEN-CAI-ISEN IN CEN.
           MOVE CIP-IIC-ICER IN CIP     TO CEN-IIC-ISEN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-ISEN IN CEN.
           MOVE 'CEN-KEY-ISEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-TOD-CEN.
           PERFORM COL-FIO-CEN.
           IF NOT FIO-STAT-OKS OR
              CEN-COD-CCSE IN CEN NOT = WSS-GLS-CIP IN WSS-VARI OR
              CIP-CIC-ICER IN CIP NOT = CEN-CIC-ISEN IN CEN
               GO TO FIN-INF-TOD-CEN.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           PERFORM CAR-VEC-PANT.

           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-INF-TOD-CEN.

       NXT-TOD-CEN.
           MOVE 'CEN-KEY-ISEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-TOD-CEN.

       FIN-INF-TOD-CEN.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCA-FECC SECTION.
       INI-PRO-CCA-FECC.

           MOVE DBC-NUM-ICLI IN CCT-FLD TO DBC-NUM-ICLI IN DBC.         00006090
           MOVE DBC-IND-ICLI IN CCT-FLD TO DBC-IND-ICLI IN DBC.         00006100
           MOVE DBC-GLS-ICLI IN CCT-FLD TO DBC-GLS-ICLI IN DBC.         00006110
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.                             00006120
           MOVE FIO-GET-KEY    TO FIO-CMND.                             00006130
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                          00006150
               GO TO FIN-PRO-CCA-FECC.

           MOVE DBC-CAI-ICLI IN DBC TO CIP-CAI-ICLI IN CIP.
           MOVE DBC-IIC-ICLI IN DBC TO CIP-IIC-ICLI IN CIP.
           MOVE ZEROES              TO CIP-NUM-ICIP IN CIP.
           MOVE 'CIP-CIC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CCA-CCIP.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
              DBC-CAI-ICLI IN DBC NOT = CIP-CAI-ICLI IN CIP OR
              DBC-IIC-ICLI IN DBC NOT = CIP-IIC-ICLI IN CIP
               GO TO FIN-PRO-CCA-FECC.

           PERFORM VAL-FEC-CIP.
           IF WSS-IND-OKS IN WSS-VARI = WCC-N
               GO TO NXT-CCA-CCIP.

           MOVE SPACES TO CEN.
           MOVE WSS-GLS-CIP IN WSS-VARI TO CEN-COD-CCSE IN CEN.
           MOVE CIP-CAI-ICER IN CIP     TO CEN-CAI-ISEN IN CEN.
           MOVE CIP-IIC-ICER IN CIP     TO CEN-IIC-ISEN IN CEN.
           MOVE ZEROES                  TO CEN-NUM-ISEN IN CEN.
           MOVE 'CEN-KEY-ISEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CCA-CCEN.
           PERFORM COL-FIO-CEN.
           IF NOT FIO-STAT-OKS
               GO TO NXT-CCA-CCIP.

           IF CEN-CIC-ISEN IN CEN NOT = CIP-CIC-ICER IN CIP OR
              CEN-COD-CCSE IN CEN NOT = WSS-GLS-CIP IN WSS-VARI
               GO TO NXT-CCA-CCIP.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           PERFORM CAR-VEC-PANT.

       REC-CCA-FECC.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-PRO-CCA-FECC.

       NXT-CCA-CCEN.
           MOVE 'CEN-KEY-ISEN' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCA-CCEN.

       NXT-CCA-CCIP.
           MOVE 'CIP-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCA-CCIP.

       FIN-PRO-CCA-FECC.
           EXIT.
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
       PRO-CCI-FECC SECTION.
       INI-PRO-CCI-FECC.
           MOVE SPACES TO WSS-EXI-TCEN IN WSS-VARI.
           MOVE SPACES TO WSS-CIP-ANTE IN WSS-VARI.

           MOVE DBC-NUM-ICLI IN CCT-FLD TO DBC-NUM-ICLI IN DBC.         00006090
           MOVE DBC-IND-ICLI IN CCT-FLD TO DBC-IND-ICLI IN DBC.         00006100
           MOVE DBC-GLS-ICLI IN CCT-FLD TO DBC-GLS-ICLI IN DBC.         00006110
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.                             00006120
           MOVE FIO-GET-KEY    TO FIO-CMND.                             00006130
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                          00006150
               GO TO FIN-PRO-CCI-FECC.

           MOVE SPACES TO CIP.
           MOVE DBC-CIC-ICLI IN DBC TO CIP-CIC-ICLI IN CIP.
           MOVE 'CIP-CIC-ICLI'      TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CCI-CCIP.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
              DBC-CIC-ICLI IN DBC NOT = CIP-CIC-ICLI IN CIP
               GO TO FIN-PRO-CCI-FECC.

      * IGUALES A IC2 E ICT SON INGRESADOS
           IF CIP-COD-ATRN IN CIP NOT = WSS-ICT IN WSS-VARI AND
              CIP-COD-ATRN IN CIP NOT = WSS-IC2 IN WSS-VARI
               GO TO NXT-CCI-CCIP.

           PERFORM VAL-FEC-CIP.
           IF WSS-IND-OKS IN WSS-VARI = WCC-N
               GO TO NXT-CCI-CCIP.

           ADD WSS-GLS-UNO IN WSS-VARI TO WSS-IND-VEC IN WSS-VARI.
           PERFORM CAR-VEC-PANT.

       REC-CCI-FECC.
           IF WSS-IND-VEC IN WSS-VARI > WSS-VEC-MAX IN WSS-VARI
               GO TO FIN-PRO-CCI-FECC.

       NXT-CCI-CCIP.
           MOVE 'CIP-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CCI-CCIP.
       FIN-PRO-CCI-FECC.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCT-FECC SECTION.
       INI-PRO-CCT-FECC.

           MOVE WCC-ASO IN WSS-VARI TO WSS-TIP-COMA IN WSS-VARI.
           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WCC-ASO IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = WCC-S
               MOVE SPACES TO WSS-COD-COMA IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.
           PERFORM PRO-CCA-FECC.

           MOVE WCC-EMI IN WSS-VARI TO WSS-TIP-COMA IN WSS-VARI.
           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WCC-EMI IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = WCC-S
               MOVE SPACES TO WSS-COD-COMA IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.
           PERFORM PRO-CCE-FECC.

           MOVE WCC-ING IN WSS-VARI TO WSS-TIP-COMA IN WSS-VARI
           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WCC-ING IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = WCC-S
               MOVE SPACES TO WSS-COD-COMA IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.
           PERFORM PRO-CCI-FECC.

       FIN-PRO-CCT-FECC.
           EXIT.
      *-----------------------------------------------------------------
       PRO-CCT-FECO SECTION.
       INI-PRO-CCT-FECO.

           MOVE WCC-ASO IN WSS-VARI TO WSS-TIP-COMA IN WSS-VARI.
           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WCC-ASO IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = WCC-S
               MOVE SPACES TO WSS-COD-COMA IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.
           PERFORM PRO-CCA-FECO.

           MOVE WCC-EMI IN WSS-VARI TO WSS-TIP-COMA IN WSS-VARI.
           MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-CCT TO TAB-COD-TTAB IN TAB.
           MOVE WCC-EMI IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE NOT = WCC-S
               MOVE SPACES TO WSS-COD-COMA IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO WSS-COD-COMA IN WSS-VARI.
           PERFORM PRO-CCE-FECO.

       FIN-PRO-CCT-FECO.
           EXIT.
      *>>>>
*% END
