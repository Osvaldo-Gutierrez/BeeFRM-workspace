*%! Codigo adicional
*% IF FIN_PUT_FIA_FIA
      *<<<< FIN_PUT_FIA_FIA
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-VCLF IN FIA-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-VCLF IN FIA-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCLF IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCLF IN FIA-FLD.
      *MHM-INI 07-ENE-2015
      *BUS-TAB busca glosa de codigo en tabla
           IF FIA-COD-AOFS IN FIA-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE FIA-COD-TOFS IN FIA-FLD  TO FIA-COD-TOFS IN FIA
               MOVE FIA-COD-AOFS IN FIA-FLD  TO FIA-COD-AOFS IN FIA
               MOVE FIA-COD-COFS IN FIA      TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-AOFS IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOFS IN FIA-FLD.
      *MHM-FIN 07-ENE-2015
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FIA-MSC-TVLF IN FIA-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE FIA-MSC-TVLF IN FIA-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVLF IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVLF IN FIA-FLD.
      *BUS-CLI busca cliente
           IF FIA-CAI-ICLI IN FIA-FLD > SPACES OR
              FIA-IIC-ICLI IN FIA-FLD > SPACES
               MOVE FIA-CAI-ICLI IN FIA-FLD TO DBC-CAI-ICLI IN DBC
               MOVE FIA-IIC-ICLI IN FIA-FLD TO DBC-IIC-ICLI IN DBC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMC IN FIA-FLD
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD.
      *BUS-CLI busca cliente
           IF FIA-CAI-ICFS IN FIA-FLD > SPACES OR
              FIA-IIC-ICFS IN FIA-FLD > SPACES
               MOVE FIA-CAI-ICFS IN FIA-FLD TO DBC-CAI-ICLI IN DBC
               MOVE FIA-IIC-ICFS IN FIA-FLD TO DBC-IIC-ICLI IN DBC
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMF IN FIA-FLD
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD.
      *>>>>
*% END
*% IF FIN_PUT_ESC_FIA
      *<<<< FIN_PUT_ESC_FIA
      *BUS-TAB busca glosa de codigo en tabla
           IF ESC-COD-NOTC IN FIA-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'NOT ' TO TAB-COD-TTAB IN TAB
               MOVE ESC-COD-NOTC IN FIA-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-NOTC IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOTC IN FIA-FLD. 
      *>>>>
*% END
*% IF FIN_PUT_AMF_FIA
      *<<<< FIN_PUT_AMF_FIA
           IF AMF-NUM-IAMF IN FIA-FLD NOT > ZEROES
               GO TO FIN-PUT-AMF-FIA.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF AMF-MSC-TVOA IN FIA-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE AMF-MSC-TVOA IN FIA-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVOA IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVOA IN FIA-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMF-COD-AOOA IN FIA-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-TOOA IN FIA-FLD TO WSS-COD-TOOA
               MOVE AMF-COD-AOOA IN FIA-FLD TO WSS-COD-AOOA
               MOVE WSS-COD-TOAX TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AUXI IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AUXI IN FIA-FLD.
      *>>>>
*% END
*% IF INI_PRO_MKY_FIA
      *<<<< INI_PRO_MKY_FIA 
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICFS-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICFS-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICFS-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICFS-ATR IN FIA-FLD.
      *>>>>
*% END
*% IF FIN_RET_FIA_FIA OR FIN_KEY_FIA_FIA
      *<<<< FIN_RET_FIA_FIA OR FIN_KEY_FIA_FIA
*% IF FIN_RET_FIA_FIA AND PGM_PU
           IF FIA-VAL-LIMI IN FIA IS NOT NUMERIC
            MOVE ZEROES  TO FIA-VAL-LIMI IN FIA.
           IF FIA-VAL-LIMF IN FIA IS NOT NUMERIC
            MOVE ZEROES  TO FIA-VAL-LIMF IN FIA.
*% END
           MOVE ESC-CAI-IESC IN FIA-FLD TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN FIA-FLD TO FIA-IIC-IESC IN FIA.
      *>>>>
*% END
*% IF FIN_RET_AMF_FIA OR FIN_KEY_AMF_FIA
      *<<<< FIN_RET_AMF_FIA OR FIN_KEY_AMF_FIA
*% IF PGM_BU
           IF AMF-VAL-LIMI IN AMF IS NOT NUMERIC
            MOVE ZEROES  TO AMF-VAL-LIMI IN AMF.
           IF AMF-VAL-LIMA IN AMF IS NOT NUMERIC
            MOVE ZEROES  TO AMF-VAL-LIMA IN AMF.
*% END
           MOVE ESC-CAI-IESC IN FIA-FLD TO AMF-CAI-IESC IN AMF.
           MOVE ESC-IIC-IESC IN FIA-FLD TO AMF-IIC-IESC IN AMF.
           MOVE FIA-NUM-IFIA IN FIA-FLD TO AMF-NUM-IFIA IN AMF.
      *>>>>
*% END
*% IF FIN_UNP_FIA_FIA
      *<<<< FIN_UNP_FIA_FIA
      *MHM-INI 23-JUN-2006
           IF SCR-CMND = 'INC'
               MOVE FRM-CPIM-AEY TO FIA-MSC-STAT-ATR IN FIA-FLD.
      *MHM-FIN 23-JUN-2006
      *>>>>
*% END
*% IF FIN_VAL_MKY_FIA
*% IF PGM_BU
      *<<<< FIN_VAL_MKY_FIA 
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-ICLI-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ICLI-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-ICLI-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VRF-ICLI-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-IND-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-ICFS-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-GLS-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ICFS-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-NUM-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-ICFS-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
           PERFORM VAL-FRM-VRF-ICFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VRF-ICFS-LEN IN FIA-FLD
                GO TO FIN-VAL-MKY-FIA.
      *>>>>
*% END
*% END
*% IF FIN_UNP_ESC_FIA
      *<<<< FIN_UNP_ESC_FIA
      *MHM-INI 23-JUN-2006
      *PVC-INI 23-SEP-2010  GENERE NUMERO DE FIANZA
      *    IF SCR-CMND = 'INC'
      *        MOVE FRM-CPIM-AEY TO ESC-FEC-FCTT-ATR IN FIA-FLD
      *        MOVE FRM-CPIM-AEY TO ESC-COD-NOTC-ATR IN FIA-FLD
      *        MOVE FRM-CPIM-AEY TO ESC-COD-ABOC-ATR IN FIA-FLD.
      *PVC-FIN 23-SEP-2010
      *MHM-INI 23-JUN-2006
      *>>>>
*% END
*% IF FIA_COD_TOFS
      *<<<< FIA_COD_TOFS
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
               GO TO FIN-VAL-FIA-COD-TOFS.
      *>>>>
*% END
*% IF FIN_FIA_COD_TOFS
      *<<<< FIN_FIA_COD_TOFS
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-FIA-COD-TOFS.
           MOVE TAB TO TIO.
           IF TIO-GLS-SIST NOT = 'DEU'
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIA_COD_AOFS
      *<<<< FIA_COD_AOFS
      *MHM-INI 07-ENE-2015                                              
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
               GO TO FIN-VAL-FIA-COD-AOFS.
      *MHM-INI 07-ENE-2015                                              
      *>>>>
*% END
*% IF FIN_FIA_COD_AOFS
      *<<<< FIN_FIA_COD_AOFS
      *MHM-INI 07-ENE-2015                                              
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'  TO TAB-COD-SIST.                                 
           MOVE 'AUX'  TO TAB-COD-TTAB IN TAB.                          
           MOVE FIA-COD-TOFS IN FIA-FLD  TO FIA-COD-TOFS IN FIA.   
           MOVE FIA-COD-AOFS IN FIA-FLD  TO FIA-COD-AOFS IN FIA.   
           MOVE FIA-COD-COFS IN FIA      TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
              MOVE SPACES TO FRM-GLS-AOFS IN FIA-FLD                    
                GO TO FIN-VAL-FIA-COD-AOFS.                             
                                                                        
           MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-AOFS IN FIA-FLD.
      *MHM-FIN 07-ENE-2015                                              
      *>>>>
*% END
*% IF INI_ESC_COD_RCTT AND PGM_PER
      *<<<< INI_ESC_COD_RCTT
           IF ESC-COD-RCTT IN FIA-FLD NOT > SPACES
               GO TO FIN-VAL-ESC-COD-RCTT.
      *>>>>
*% END
*% IF FIA_NUM_IFIA
      *<<<< FIA_NUM_IFIA
      *MHM INI 23-JUN-2006
           IF SCR-CMND = 'INC'
           IF     ESC-CAI-IESC IN FIA-FLD NOT > SPACES
              AND ESC-IIC-IESC IN FIA-FLD NOT > ZEROES
              AND FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
              MOVE 1 TO FIA-NUM-IFIA IN FIA-FLD.
      *MHM FIN 23-JUN-2006
      *>>>>
*% END
*% IF FIN_ESC_COD_OFEF
      *<<<< FIN_ESC_COD_OFEF
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-ESC-COD-OFEF.
*% IF PGM_PER
      *<<<< PGM_PER
      *FLB CST  28-MAR-1995 
      *     MOVE ESC-COD-OFEF IN FIA-FLD TO ESC-COD-OFEF IN ESC.
      *     PERFORM VAL-OFI-USR.
      *     IF MSG-COD-MENS > SPACES
      *         GO TO FIN-VAL-ESC-COD-OFEF.
      *FLB CST  28-MAR-1995 FIN
      *>>>>
*% END
      *MHM-INI 28-JUN-2006
      *    IF ESC-CAI-IESC IN FIA-FLD NOT > SPACES AND
      *       ESC-IIC-IESC IN FIA-FLD NOT > ZEROES
      *        MOVE 'F'                     TO CIC-COD-TCIC IN CIC
      *        MOVE ESC-COD-OFEF IN FIA-FLD TO CIC-COD-CCIC IN CIC
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM GNS-FIO-CIC
      *        IF NOT FIO-STAT-OKS
      *            MOVE 'GNS'        TO MSG-COD-SIST
      *            MOVE 'CICSTAT'    TO MSG-COD-TMSG
      *            MOVE CIC-STAT-NEX TO MSG-COD-CMSG
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC        TO FRM-MEN1
      *            MOVE CIC-CAI-ICIC IN CIC TO FRM-MEN2
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        ELSE
      *        IF CIC-IND-VIGE IN CIC = 'N'
      *            MOVE 'GNS'        TO MSG-COD-SIST
      *            MOVE 'CICSTAT'    TO MSG-COD-TMSG
      *            MOVE CIC-STAT-NVG TO MSG-COD-CMSG
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC        TO FRM-MEN1
      *            MOVE CIC-CAI-ICIC IN CIC TO FRM-MEN2
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *MHM-FIN 28-JUN-2006
      *>>>>
*% END
*% IF INI_FRM_IND_ICLI
      *<<<< INI_FRM_IND_ICLI
      *     IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-IND-ICLI.
      *>>>>
*% END
*% IF INI_FRM_GLS_ICLI
      *<<<< INI_FRM_GLS_ICLI
      *     IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-GLS-ICLI.
      *>>>>
*% END
*% IF INI_ESC_FEC_FCTT
      *<<<< INI_FRM_GLS_ICLI
      *MHM-INI 23-JUN-2006
           IF SCR-CMND = 'INC'
               MOVE FEC-FBLK-S  TO FEC-FBLK.
      *MHM-FIN 23-JUN-2006
      *>>>>
*% END
*% IF ESC_COD_NOTC
      *<<<< ESC_COD_NOTC
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'NOT ' TO TAB-COD-TTAB IN TAB.
           MOVE ESC-COD-NOTC IN FIA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ESC-COD-NOTC IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-NOTC IN FIA-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-NOTC IN FIA-FLD. 
      *>>>>
*% END
*% IF ESC_COD_ABOC
      *<<<< ESC_COD_ABOC
      *MHM-INI 23-JUN-2006
           IF SCR-CMND = 'INC' AND
              ESC-COD-ABOC IN FIA-FLD NOT > SPACES
               GO TO FIN-VAL-ESC-COD-ABOC.
      *MHM-FIN 23-JUN-2006 
      *>>>>
*% END
*% IF INI_FRM_VRF_ICLI
      *<<<< INI_FRM_VRF_ICLI
*% IF PGM_BQ
            IF SCR-INST = SCR-INST-GKY
                MOVE IDC-ZERO-S TO IDC-ZERO
            ELSE
            IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
                MOVE IDC-ZERO-N TO IDC-ZERO
            ELSE
                GO TO FIN-VAL-FRM-VRF-ICLI.
*% END
*% IF PGM_BU
      *     IF SCR-INST = SCR-INST-GKY
      *         MOVE IDC-ZERO-S TO IDC-ZERO
      *     ELSE
      *     IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
      *         MOVE IDC-ZERO-N TO IDC-ZERO
      *     ELSE
      *         GO TO FIN-VAL-FRM-VRF-ICLI.
*% END
      *>>>>
*% END
*% IF FIN_FRM_VRF_ICLI
      *<<<< FIN_FRM_VRF_ICLI
           IF MSG-COD-MENS = SPACES AND
              FRM-NUM-ICLI IN FIA-FLD NOT = ZEROES
               MOVE FRM-NUM-ICLI IN FIA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN FIA-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN FIA-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMC IN FIA-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD
*% IF PGM_BU AND PGM_PER 
      * LAV BCP ini 11-01-94
                   IF ESC-COD-RCTT IN FIA-FLD NOT > SPACES
                       MOVE DBC-COD-EJEC IN DBC TO
                                                ESC-COD-RCTT IN FIA-FLD
                       MOVE ESC-COD-RCTT IN FIA-FLD TO
                                                USR-COD-USER IN USR
                       PERFORM BUS-USR
                       MOVE USR-GLS-DESC IN USR TO
                                                FRM-GLS-RCTT IN FIA-FLD
                       IF SCR-KEY-IDBC = 'DEU'
                           MOVE DBC-GLS-NOMC IN DBC TO ADR-VKEY IN
                                                      ADR-DBC-REQA
                           MOVE 'DBC03'             TO ADR-DKEY IN
                                                      ADR-DBC-REQA
                           MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                       ELSE
                           NEXT SENTENCE
                   ELSE
      * LAV BCP fin 11-01-94
*% END
                   IF SCR-KEY-IDBC = 'DEU'
                       MOVE DBC-GLS-NOMC IN DBC TO ADR-VKEY IN
                                                   ADR-DBC-REQA
                       MOVE 'DBC03'             TO ADR-DKEY IN
                                                   ADR-DBC-REQA
                       MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
      *>>>>
*% END
*% IF INI_FRM_IND_ICFS
      *<<<< INI_FRM_IND_ICFS
      *     IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-IND-ICFS.
      *>>>>
*% END
*% IF INI_FRM_GLS_ICFS
      *<<<< INI_FRM_GLS_ICFS
      *     IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
      *         GO TO FIN-VAL-FRM-GLS-ICFS.
      *>>>>
*% END
*% IF INI_FRM_VRF_ICFS
      *<<<< INI_FRM_VRF_ICFS
*% IF PGM_BQ
            IF SCR-INST = SCR-INST-GKY
                MOVE IDC-ZERO-S TO IDC-ZERO
            ELSE
            IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
                MOVE IDC-ZERO-N TO IDC-ZERO
            ELSE
                GO TO FIN-VAL-FRM-VRF-ICFS.
*% END
*% IF PGM_BU
      *     IF SCR-INST = SCR-INST-GKY
      *         MOVE IDC-ZERO-S TO IDC-ZERO
      *     ELSE
      *     IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
      *         MOVE IDC-ZERO-N TO IDC-ZERO
      *     ELSE
      *         GO TO FIN-VAL-FRM-VRF-ICFS.
*% END
      *>>>>
*% END
*% IF FIN_FRM_VRF_ICFS
      *<<<< FIN_FRM_VRF_ICFS
           IF MSG-COD-MENS = SPACES AND
              FRM-NUM-ICFS IN FIA-FLD NOT = ZEROES
               MOVE FRM-NUM-ICFS IN FIA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICFS IN FIA-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICFS IN FIA-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMF IN FIA-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD
                   IF SCR-KEY-IDBC = 'FIA'
                       MOVE DBC-GLS-NOMC IN DBC TO ADR-VKEY IN
                                                  ADR-DBC-REQA
                       MOVE 'DBC03'             TO ADR-DKEY IN
                                                  ADR-DBC-REQA
                       MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
      *>>>>
*% END
*% IF INI_FIA_COD_VCLF
      *<<<< INI_FIA_COD_VCLF
*% IF PGM_PER
AMP        IF FIA-VAL-LIMF IN FIA-FLD > ZEROES AND
AMP           FIA-COD-VCLF IN FIA-FLD NOT > SPACES
AMP            PERFORM ERR-GLS
AMP            GO TO FIN-VAL-FIA-COD-VCLF.
*% END
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
               GO TO FIN-VAL-FIA-COD-VCLF.
           IF FIA-COD-VCLF IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCLF IN FIA-FLD
               MOVE SPACES TO FIA-MSC-TVLF IN FIA-FLD
               MOVE SPACES TO FRM-GLS-TVLF IN FIA-FLD
               GO TO FIN-VAL-FIA-COD-VCLF.
      *>>>>
*% END
*% IF FIN_FIA_COD_VCLF
      *<<<< FIN_FIA_COD_VCLF
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF NOT ( FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR )
               MOVE FIA-COD-VCLF IN FIA-FLD TO FIA-MSC-TVLF IN FIA-FLD
               IF FIA-MSC-TVLF IN FIA-FLD > SPACES
                   MOVE 'TAB' TO MSC-COD-SIST
                   MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
                   MOVE FIA-MSC-TVLF IN FIA-FLD TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVLF IN FIA-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TVLF IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVLF IN FIA-FLD.
      *>>>>
*% END
*% IF FIA_VAL_LIMF AND PGM_PER
      *<<<< FIA_VAL_LIMF AND PGM_PER
AMP        IF FIA-VAL-LIMF IN FIA-FLD = ZEROES
AMP            PERFORM ERR-GLS
AMP            GO TO FIN-VAL-FIA-VAL-LIMF.
      *>>>>
*% END
*% IF INI_FIA_FEC_FVEN
      *<<<< INI_FIA_FEC_FVEN
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
               GO TO FIN-VAL-FIA-FEC-FVEN.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF FIN_FIA_FEC_FVEN
      *<<<< FIN_FIA_FEC_FVEN

      *OGB-INI 25-FEB-2016 FIANZAS FASE I
           IF FIA-MSC-STAT IN FIA = WSS-CT-S
              IF FIA-NUM-SVEN IN FIA-FLD NOT > ZEROES
                 MOVE WSS-CT-DEU      TO MSG-COD-SIST
                 MOVE WSS-CT-FVCTOINF TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC    TO FRM-MEN2
                 MOVE WSS-CT-C00      TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN.

           IF FIA-MSC-STAT IN FIA NOT  = WSS-CT-S
              IF FIA-NUM-SVEN IN FIA-FLD NOT > ZEROES
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-SNOACTINF TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC    TO FRM-MEN2
                 MOVE WSS-CT-C00      TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN.

           PERFORM GET-FHOY.
           MOVE FIA-NUM-DVEN IN FIA-FLD TO WSS-NUM-DHOY.
           MOVE FIA-NUM-MVEN IN FIA-FLD TO WSS-NUM-MHOY.
           MOVE FIA-NUM-SVEN IN FIA-FLD TO WSS-NUM-SHOY.
           MOVE FIA-NUM-AVEN IN FIA-FLD TO WSS-NUM-AHOY.

      *FIA ACTIVADA
           IF FIA-MSC-STAT IN FIA = WSS-CT-S
              IF HOY-FHOY > WSS-FEC-FHOY
                 MOVE WSS-CT-DEU     TO MSG-COD-SIST
                 MOVE WSS-CT-FIAVCDA TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN
              ELSE
              IF HOY-FHOY = WSS-FEC-FHOY
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-AFVCTOHOY TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN
              ELSE
              IF HOY-FHOY < WSS-FEC-FHOY
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-AFVCTOFUT TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN.

      *FIA NO ACTIVADA
           IF FIA-MSC-STAT IN FIA NOT = WSS-CT-S
              IF HOY-FHOY > WSS-FEC-FHOY
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTVCDA TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN
              ELSE
              IF HOY-FHOY = WSS-FEC-FHOY
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTFECH TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN
              ELSE
              IF HOY-FHOY < WSS-FEC-FHOY
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTFECF TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MEN2
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-VAL-FIA-FEC-FVEN.
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
      *>>>>
*% END
*% IF INI_AMF_FEC_FFAM
      *<<<< INI_AMF_FEC_FFAM
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
               GO TO FIN-VAL-AMF-FEC-FFAM.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF FIA_MSC_STAT
      *<<<< FIA_MSC_STAT
      *VAL-IND Valida miscelaneo de tabla
           IF SCR-CMND = 'VRF'
               MOVE 'GNS' TO MSC-COD-SIST
               MOVE 'VIGE' TO MSC-COD-TMSC IN MSC
               MOVE FIA-MSC-STAT IN FIA-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
*% IF AMF_MSC_TVOA
      *<<<< AMF_MSC_TVOA
           IF AMF-MSC-TVOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TVOA IN FIA-FLD
               GO TO FIN-VAL-AMF-MSC-TVOA.
      *VAL-MSC Valida indicador ( miscelaneo ) de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TVAL' TO MSC-COD-TMSC IN MSC.
           MOVE AMF-MSC-TVOA IN FIA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              AMF-MSC-TVOA IN FIA-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVOA IN FIA-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TVOA IN FIA-FLD.
      *>>>>
*% END
*% IF INI_AMF_COD_TOOA
      *<<<< INI_AMF_COD_TOOA
           IF AMF-COD-TOOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOA IN FIA-FLD
               GO TO FIN-VAL-AMF-COD-TOOA.
      *>>>>
*% END
*% IF FIN_AMF_COD_TOOA
      *<<<< FIN_AMF_COD_TOOA
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-AMF-COD-TOOA.
           MOVE TAB TO TIO.
*% IF PGM_PER
      *LAV ini 22-04-94
           IF NOT (TIO-GLS-SIST = 'COL' OR TIO-GLS-SIST = 'CTE' OR
                   TIO-GLS-SIST = 'CEX')
      *LAV fin 22-04-94
*% ELSE
           IF TIO-GLS-SIST NOT = 'COL'
*% END
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_AMF_COD_OFOA
      *<<<< INI_AMF_COD_OFOA
           IF AMF-COD-OFOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-OFOA IN FIA-FLD
               GO TO FIN-VAL-AMF-COD-OFOA.
      *>>>>
*% END
*% IF AMF_IIC_IOCA
      *<<<< AMF_IIC_IOCA
           IF ( ESC-CAI-IESC IN FIA-FLD > SPACES OR
                ESC-IIC-IESC IN FIA-FLD > ZEROES ) AND
              ( AMF-CAI-IOCA IN FIA-FLD = ESC-CAI-IESC IN FIA-FLD AND
                AMF-IIC-IOCA IN FIA-FLD = ESC-IIC-IESC IN FIA-FLD )
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICIESC=IOCA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_AMF_COD_VCOA
      *<<<< INI_AMF_COD_VCOA
           IF AMF-COD-VCOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOA IN FIA-FLD
               MOVE SPACES TO AMF-MSC-TVOA IN FIA-FLD
               MOVE SPACES TO FRM-GLS-TVOA IN FIA-FLD
               GO TO FIN-VAL-AMF-COD-VCOA.
      *>>>>
*% END
*% IF FIN_AMF_COD_VCOA
      *<<<< FIN_AMF_COD_VCOA
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF NOT ( FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR )
               MOVE AMF-COD-VCOA IN FIA-FLD TO AMF-MSC-TVOA IN FIA-FLD
               IF AMF-MSC-TVOA IN FIA-FLD > SPACES
                   MOVE 'TAB' TO MSC-COD-SIST
                   MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
                   MOVE AMF-MSC-TVOA IN FIA-FLD TO MSC-COD-CMSC IN MSC
                   PERFORM BUS-MSC
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TVOA IN FIA-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TVOA IN FIA-FLD.
      *>>>>
*% END
*% IF AMF_COD_AUXI
      *<<<< AMF_COD_AUXI
      *JSS En validacion de consistencia entre campos
      *>>>>
*% END
*% IF INI_AMF_COD_CDOA
      *<<<< INI_AMF_COD_CDOA
           IF AMF-COD-CDOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CDOA IN FIA-FLD
               GO TO FIN-VAL-AMF-COD-CDOA.
      *>>>>
*% END
*% IF INI_AMF_COD_VCLA
      *<<<< INI_AMF_COD_VCLA
           IF AMF-COD-VCLA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCLA IN FIA-FLD
               GO TO FIN-VAL-AMF-COD-VCLA.
      *>>>>
*% END
*% IF INI_AMF_IND_TDEU
      *<<<< INI_AMF_IND_TDEU
           IF AMF-IND-TDEU IN FIA-FLD NOT > SPACES
               GO TO FIN-VAL-AMF-IND-TDEU.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_FIA
      *<<<< FIN_VAL_CON_IKY_FIA
           IF ESC-IIC-IESC IN FIA-FLD NOT > ZEROES
      *MHM-INI 23-JUN-2006
              AND SCR-CMND NOT = 'INC'
      *MHM-FIN 23-JUN-2006
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'IICIESCBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_FIA
      *<<<< INI_VAL_CON_KEY_FIA
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-FIA.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_FIA
      *<<<< FIN_VAL_CON_KEY_FIA
           IF NOT (   ESC-IIC-IESC IN FIA-FLD > ZEROES OR

                    ( ESC-IIC-IESC IN FIA-FLD > ZEROES   AND
                      FIA-NUM-IFIA IN FIA-FLD > ZEROES ) OR

                    ( ESC-IIC-IESC IN FIA-FLD > ZEROES   AND
                      FIA-NUM-IFIA IN FIA-FLD > ZEROES   AND
                      AMF-NUM-IAMF IN FIA-FLD > ZEROES ) OR

                    ( ESC-IIC-IESC IN FIA-FLD > ZEROES   AND
                      AMF-NUM-IAMF IN FIA-FLD > ZEROES ) OR

                    ( FRM-NUM-ICLI IN FIA-FLD > ZEROES   AND 
                      FRM-NUM-ICFS IN FIA-FLD > ZEROES ) OR

                    ( FRM-NUM-ICLI IN FIA-FLD > ZEROES ) OR

                    ( FRM-NUM-ICFS IN FIA-FLD > ZEROES ) OR

                    ( FRM-GLS-NOMC IN FIA-FLD > SPACES   AND
                      FRM-GLS-NOMF IN FIA-FLD > SPACES ) OR

                    ( FRM-GLS-NOMC IN FIA-FLD > SPACES ) OR

                    ( FRM-GLS-NOMF IN FIA-FLD > SPACES ) )
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_AMF_FEC_FIAM
      *<<<< INI_AMF_FEC_FIAM
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF VAL_CON_FLD_FIA
      *<<<< VAL_CON_FLD_FIA
           IF FIA-NUM-IFIA IN FIA-FLD > ZEROES AND
              FIA-CAI-ICLI IN FIA-FLD = FIA-CAI-ICFS IN FIA-FLD AND
              FIA-IIC-ICLI IN FIA-FLD = FIA-IIC-ICFS IN FIA-FLD
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICLI=ICFS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO FRM-NUM-ICLI-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.
           IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
               PERFORM VAL-MUL-FIA
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
      *RGD-INI PENTA 02-02-2014
                   MOVE -1 TO ESC-CAI-IESC-LEN IN FIA-FLD
      *RGD-FIN PENTA
                   GO TO FIN-VAL-CON-FLD-FIA.
           IF FIA-FEC-FVEN IN FIA-FLD > ZEROES
               MOVE FIA-FEC-FINI IN FIA-FLD TO FEC-FEC1
               MOVE FIA-FEC-FVEN IN FIA-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'FECFCTTFVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
                   MOVE -1 TO FIA-FEC-FVEN-LEN IN FIA-FLD
      *RGD-FIN PENTA
                   GO TO FIN-VAL-CON-FLD-FIA.
      *MHM-INI PENTA 10-MAR-2015
           IF FIA-FEC-FINI IN FIA-FLD > ZEROES
               MOVE ESC-FEC-FCTT IN FIA-FLD TO FEC-FEC1
               MOVE FIA-FEC-FINI IN FIA-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'FIAFINI<FCTT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE -1 TO FIA-FEC-FINI-LEN IN FIA-FLD
                   GO TO FIN-VAL-CON-FLD-FIA.
      *MHM-FIN PENTA 10-MAR-2015


      *IMV-INI 22-SEP-2014 PENTA

           IF AMF-FEC-FFAM IN FIA-FLD > ZEROES
               MOVE AMF-FEC-FIAM IN FIA-FLD TO FEC-FEC1
               MOVE AMF-FEC-FFAM IN FIA-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'AMFFIN<INI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
                   MOVE -1 TO AMF-FEC-FFAM-LEN IN FIA-FLD
      *RGD-FIN PENTA
                   GO TO FIN-VAL-CON-FLD-FIA.

           IF AMF-FEC-FIAM  IN FIA-FLD > ZEROES
               MOVE FIA-FEC-FINI IN FIA-FLD TO FEC-FEC1
               MOVE AMF-FEC-FIAM IN FIA-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'AMINI<FIAINI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
                   MOVE -1 TO AMF-FEC-FIAM-LEN IN FIA-FLD
      *RGD-FIN PENTA
                   GO TO FIN-VAL-CON-FLD-FIA.

           IF AMF-FEC-FFAM  IN FIA-FLD > ZEROES
               MOVE AMF-FEC-FFAM IN FIA-FLD TO FEC-FEC1
               MOVE FIA-FEC-FVEN IN FIA-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'AMFFIN>FIAVE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
                   MOVE -1 TO AMF-FEC-FFAM-LEN IN FIA-FLD
      *RGD-FIN PENTA
                   GO TO FIN-VAL-CON-FLD-FIA.

      *IMV-FIN 22-SEP-2014 PENTA
      *IMV-INI 12-NOV-2014 PENTA

      *     IF ( FIA-VAL-LIMF IN FIA-FLD     > ZEROES AND
      *          FIA-COD-VCLF IN FIA-FLD NOT > SPACES ) OR
      *        ( FIA-VAL-LIMF IN FIA-FLD NOT > ZEROES AND
      *          FIA-COD-VCLF IN FIA-FLD     > SPACES )
      *IMV-FIN 12-NOV-2014 PENTA

            IF (( FIA-VAL-LIMF IN FIA-FLD  > ZEROES OR
                  FIA-VAL-LIMI IN FIA-FLD   > ZEROES) AND
                 FIA-COD-VCLF IN FIA-FLD  NOT > SPACES)
                  OR
              ( FIA-VAL-LIMF IN FIA-FLD NOT > ZEROES AND
                 FIA-VAL-LIMI IN FIA-FLD NOT > ZEROES  AND
                  FIA-COD-VCLF IN FIA-FLD  > SPACES)


               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FIALIMFVCLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *JSS-INI 5-MAY-1994
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO FIA-VAL-LIMF-LEN IN FIA-FLD
      *JSS-FIN 5-MAY-1994
               GO TO FIN-VAL-CON-FLD-FIA.
           IF AMF-CAI-IOCA IN FIA-FLD > SPACES AND
              AMF-IIC-IOCA IN FIA-FLD NOT > ZEROES
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'IICIOCABLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO AMF-CAI-IOCA-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.
           IF AMF-COD-AOOA IN FIA-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AUXI IN FIA-FLD
           ELSE
           IF AMF-COD-TOOA IN FIA-FLD NOT > SPACES
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'AMFTOOAAUXI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO AMF-COD-TOOA-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA
           ELSE
      *VAL-COD Valida codigo de tabla
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE AMF-COD-TOOA IN FIA-FLD TO WSS-COD-TOOA
               MOVE AMF-COD-AOOA IN FIA-FLD TO WSS-COD-AOOA
               MOVE WSS-COD-TOAX TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' AND WSS-COD-TOAX > SPACES
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'AMFAUXINEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE SPACES TO FRM-GLS-AUXI IN FIA-FLD
      *JSS-INI 31-MAY-1994
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1 TO AMF-COD-AOOA-LEN IN FIA-FLD
      *JSS-FIN 31-MAY-1994
                   GO TO FIN-VAL-CON-FLD-FIA
               ELSE
               IF MSG-COD-MENS = 'COD    NVG'
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'AMFAUXINVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AUXI IN FIA-FLD
      *JSS-INI 31-MAY-1994
                   MOVE 'S' TO FRM-UCUR
                   MOVE -1 TO AMF-COD-AOOA-LEN IN FIA-FLD
      *JSS-FIN 31-MAY-1994
                   GO TO FIN-VAL-CON-FLD-FIA
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AUXI IN FIA-FLD.
           IF ( AMF-VAL-LIMA IN FIA-FLD     > ZEROES AND
                AMF-COD-VCLA IN FIA-FLD NOT > SPACES ) OR
              ( AMF-VAL-LIMA IN FIA-FLD NOT > ZEROES AND
                AMF-COD-VCLA IN FIA-FLD     > SPACES )
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'AMFLIMAVCLA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *JSS-INI 5-MAY-1994
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO AMF-VAL-LIMA-LEN IN FIA-FLD
      *JSS-FIN 5-MAY-1994
               GO TO FIN-VAL-CON-FLD-FIA.
      *JSS-INI 24-FEB-1994 (Req. BCP)
           IF FIA-VAL-LIMF IN FIA-FLD > ZEROES AND
              FIA-COD-VCLF IN FIA-FLD > SPACES AND
              AMF-VAL-LIMA IN FIA-FLD > ZEROES AND
              AMF-COD-VCLA IN FIA-FLD > SPACES AND
              FIA-COD-VCLF IN FIA-FLD = AMF-COD-VCLA IN FIA-FLD AND
              FIA-VAL-LIMF IN FIA-FLD < AMF-VAL-LIMA IN FIA-FLD
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'FIALIMF<LIMA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO AMF-VAL-LIMA-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.

      *IMV-INI 22-SEP-2014 PENTA

           IF FIA-VAL-LIMI IN FIA-FLD > ZEROES AND
              FIA-COD-VCLF IN FIA-FLD > SPACES AND
              FIA-VAL-LIMF IN FIA-FLD > ZEROES AND
              FIA-VAL-LIMF IN FIA-FLD < FIA-VAL-LIMI IN FIA-FLD
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'FIALIMF<LIMI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO FIA-VAL-LIMI-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.

          IF  AMF-VAL-LIMI IN FIA-FLD > ZEROES AND
              AMF-COD-VCLA IN FIA-FLD > SPACES AND
              AMF-VAL-LIMA IN FIA-FLD > ZEROES AND
              AMF-VAL-LIMA IN FIA-FLD < AMF-VAL-LIMI IN FIA-FLD
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'AMFLIMA<LIMI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO AMF-VAL-LIMI-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.

           IF FIA-VAL-LIMI IN FIA-FLD > ZEROES AND
              FIA-COD-VCLF IN FIA-FLD > SPACES AND
      *RGD-INI PENTA 02-02-2014
      *       AMF-VAL-LIMI IN FIA-FLD > ZEROES AND
      *RGD-FIN PENTA
              AMF-COD-VCLA IN FIA-FLD > SPACES AND
              FIA-COD-VCLF IN FIA-FLD = AMF-COD-VCLA IN FIA-FLD AND
              FIA-VAL-LIMI IN FIA-FLD > AMF-VAL-LIMI IN FIA-FLD
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'FIINI<AMINI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RGD-INI PENTA 02-02-2014
               MOVE -1 TO AMF-VAL-LIMI-LEN IN FIA-FLD
      *RGD-FIN PENTA
               GO TO FIN-VAL-CON-FLD-FIA.
      *IMV-FIN 22-SEP-2014 PENTA

      *JSS-FIN 24-FEB-1994
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-MUL-FIA SECTION.
       INI-VAL-MUL-FIA.
           MOVE FIA-CAI-ICLI IN FIA-FLD TO FIA-CAI-ICLI IN FIA.
           MOVE FIA-IIC-ICLI IN FIA-FLD TO FIA-IIC-ICLI IN FIA.
           MOVE FIA-CAI-ICFS IN FIA-FLD TO FIA-CAI-ICFS IN FIA.
           MOVE FIA-IIC-ICFS IN FIA-FLD TO FIA-IIC-ICFS IN FIA.
           MOVE 0                       TO FIA-NUM-IFIA IN FIA.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LUP-VAL-MUL-FIA.
           MOVE 'FIA-GLS-ICYF' TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
              FIA-CAI-ICLI IN FIA = FIA-CAI-ICLI IN FIA-FLD AND
              FIA-IIC-ICLI IN FIA = FIA-IIC-ICLI IN FIA-FLD AND
              FIA-CAI-ICFS IN FIA = FIA-CAI-ICFS IN FIA-FLD AND
              FIA-IIC-ICFS IN FIA = FIA-IIC-ICFS IN FIA-FLD
               IF FIA-CAI-IESC IN FIA = ESC-CAI-IESC IN FIA-FLD AND
                  FIA-IIC-IESC IN FIA = ESC-IIC-IESC IN FIA-FLD AND
                  FIA-NUM-IFIA IN FIA NOT = FIA-NUM-IFIA IN FIA-FLD
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'FIA    YAEXI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-VAL-MUL-FIA.
       FIN-VAL-MUL-FIA.
           EXIT.
*% IF PGM_PER

      *LAV ini 10-02-1994 se valida que el deudor sea el mismo cuando
      * a este se le ingresa mas de un fiador.
       VAL-UNI-DEU SECTION.
       INI-VAL-UNI-DEU.
           MOVE ESC-CAI-IESC IN FIA-FLD TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN FIA-FLD TO FIA-IIC-IESC IN FIA.
           MOVE 0                       TO FIA-NUM-IFIA IN FIA.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LUP-VAL-UNI-DEU.
           PERFORM DEU-FIO-FIA.
           IF ( FIO-STAT-OKS AND
                FIA-CAI-IESC IN FIA = ESC-CAI-IESC IN FIA-FLD AND
                FIA-IIC-IESC IN FIA = ESC-IIC-IESC IN FIA-FLD )
               IF FIA-CAI-ICLI IN FIA = FIA-CAI-ICLI IN FIA-FLD AND
                  FIA-IIC-ICLI IN FIA = FIA-IIC-ICLI IN FIA-FLD
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-VAL-UNI-DEU
               ELSE
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'FIADEUNOTUNI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE FIA-KEY-IFIA TO FRM-MEN2
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
       FIN-VAL-UNI-DEU.
           EXIT.
      *LAV fin 10-02-1994
*% END
      *>>>>
*% END
*%!
*% IF INI_VAL_IKY_FIA AND ( NOT PGM_BCI )
      *<<<< INI_VAL_IKY_FIA AND ( NOT PGM_BCI )
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_FIA AND ( NOT PGM_BCI )
      *<<<< INI_VAL_CON_IKY_FIA AND ( NOT PGM_BCI )
      *>>>>
*% END
*% IF INI_ESC_IIC_IESC AND ( NOT PGM_BCI )
      *<<<< INI_ESC_IIC_IESC AND ( NOT PGM_BCI )
      *>>>>
*% END
