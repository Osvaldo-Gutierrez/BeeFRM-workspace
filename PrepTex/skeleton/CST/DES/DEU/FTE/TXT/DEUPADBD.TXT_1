*%! Codigo adicional para archivo
*% RA1 = "DBC"
*% FRM = "DBD"
*% NRA = 1
*% TCA = 1369
*% NO_TIENE_TIMESTAMP = TRUE
*% PGM_PTC = TRUE
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "DEUZQDBD"
*% ELSE
*% CLRMFC = "DEUZUDBD"
*% END
*% INCLUDE 'PFSALLF78'
*% IF WSS_DTC
      *<<<< WSS_DTC 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      *>>>>
*% END
*% IF CMT_ID
      * ACTUALIZA ARCHIVO DEUDBD EN FORMA INTERACTIVA.
*% END
*% IF WSS_IBM
      *<<<< WSS_IBM
       COPY SGCBRREC.
       COPY SGCBRDBC.
       COPY SGCBRDSF.
       COPY SGCBRRBS.
       COPY DEUBRCRI.
       COPY COLBRRDC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY SGCWVPPU.
       01  WSS-VARI.
           03 WSS-CIC-ICLI.
              05 WSS-CAI-ICLI                    PIC X(04).
              05 WSS-IIC-ICLI                    PIC X(08).
           03 WSS-COD-CRIB                       PIC X(02).
           03 WSS-COD-CRIS                       PIC X(02).
           03 WSS-FEC-FCLA                       PIC X(08).
      * NGA-INI/CAMBIO ARCHIVO DEUDA BANCARIA/OCT 2013
           03 WSS-CVT-ITEM                       PIC X(125).
      * NGA-FIN/CAMBIO ARCHIVO DEUDA BANCARIA/OCT 2013
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) 
      * Si existe nombre de Deudor
               PERFORM KEY-ALL-DBD
               IF DBC-NUM-ICLI IN DBD-FLD NOT > ZEROES
                   PERFORM BUS-CLI-NMB
                   IF NOT FIO-STAT-OKS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       NEXT SENTENCE
               ELSE
                   PERFORM BUS-CLI-IDC
                   IF NOT FIO-STAT-OKS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-DBD
                   MOVE DBC-CAI-ICLI IN DBC TO DBD-CAI-ICLI IN DBD
                   MOVE DBC-IIC-ICLI IN DBC TO DBD-IIC-ICLI IN DBD
                   MOVE DBC-CAI-ICLI IN DBC TO DBD-CAI-ICLI IN DBD-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DBD-IIC-ICLI IN DBD-FLD
                   MOVE ZEROS               TO CRI-FEC-FCLA IN DBD-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF8
                       MOVE 'DEU'          TO MSG-COD-SIST
                       MOVE 'DBD    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU'          TO MSG-COD-SIST
                       MOVE 'DBD    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF ( NOT FIO-STAT-OKS AND ( SCR-CCPP = 'ACC' OR
                SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI' )) OR
              ( NOT FIO-STAT-OKS AND ( FRM-FFLD = FRM-FFLD-PF7 OR
                FRM-FFLD-PF8 ) )
               IF SCR-CMND = 'ACR' OR
                  SCR-CMND = 'ECR'
                   GO TO BUS-ULT-CRI
               ELSE
                   PERFORM BUS-CRI
                   MOVE DBD-CAI-ICLI IN DBD-FLD TO RDC-CAI-ICLI IN RDC
                   MOVE DBD-IIC-ICLI IN DBD-FLD TO RDC-IIC-ICLI IN RDC
                   MOVE SPACES                  TO RDC-CIC-IOPC IN RDC
                   MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC
                   MOVE FIO-GET-NLS TO FIO-CMND
                   PERFORM COL-FIO-RDC
                   IF FIO-STAT-OKS AND
                      RDC-CAI-ICLI IN RDC = DBD-CAI-ICLI IN DBD-FLD AND
                      RDC-IIC-ICLI IN RDC = DBD-IIC-ICLI IN DBD-FLD
                       IF SCR-STAT = SCR-STAT-CON
                           MOVE '00' TO FIO-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           IF FRM-FFLD = FRM-FFLD-PF7 OR
                              FRM-FFLD = FRM-FFLD-PF8
                               MOVE '.'          TO FRM-MENS
                               MOVE SCR-STAT-CON TO SCR-STAT
                               MOVE '00'         TO FIO-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE '23' TO FIO-STAT
                               GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU'        TO MSG-COD-SIST
                       MOVE 'DEU    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-FND-KEY.
           IF FIO-STAT-OKS
               MOVE DBD-STP-ITRN IN DBD TO SCR-UMOD.
       BUS-ULT-CRI.
           IF ( SCR-CCPP = 'ACC' OR SCR-CCPP = 'MOD' OR
                SCR-CCPP = 'ELI' )
      *ALD Leer la ultima declaracion de Riesgos
                 PERFORM BUS-CRI
                 IF ( SCR-CMND = 'ACR' OR SCR-CMND = 'ECR' ) AND
                    ( CRI-FEC-FCLA IN CRI NOT > ZEROES OR
                      CRI-FEC-FCLA IN CRI NOT > SPACES )
                     MOVE 'DEU'        TO MSG-COD-SIST
                     MOVE 'CRI    NEX' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     MOVE SCR-STAT-CON TO SCR-STAT
                     MOVE '00'         TO FIO-STAT
                     GO TO FIN-FND-KEY.
           IF NOT PGM-STAT-DBD-OKS AND
              ( SCR-CCPP = 'ACT' OR SCR-CCPP = 'ING')
                PERFORM PUT-DBC-DBD
                PERFORM PUT-CRI-DBD.
           IF SCR-CMND = 'ACR' OR
              SCR-CMND = 'ECR'
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE PGM-STAT-DBD TO FIO-STAT.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'ACR' OR
              SCR-CMND = 'ECR'
               MOVE FRM-CPIM-AEY TO DBD-MSA-PIVA-ATR IN DBD-FLD
               MOVE FRM-CPIM-AEY TO CRI-FEC-FCLA-ATR IN DBD-FLD
               MOVE ZEROES TO DBD-MSA-PIVA-LEN IN DBD-FLD
               MOVE -1 TO FRM-COD-CRCB-LEN IN DBD-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO CRI-FEC-FCLA-ATR IN DBD-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-CRCB-ATR IN DBD-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-CRCS-ATR IN DBD-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-CRVB-ATR IN DBD-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-CRVS-ATR IN DBD-FLD.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           IF DBD-STP-ITRN IN DBD NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO DBD-NUM-DTRN IN DBD.
           MOVE HOY-MHOY IN HOY-VARI TO DBD-NUM-MTRN IN DBD.
           MOVE HOY-AHOY IN HOY-VARI TO DBD-NUM-ATRN IN DBD.
           MOVE HOY-SHOY IN HOY-VARI TO DBD-NUM-STRN IN DBD.
           MOVE HOY-HHOY IN HOY-VARI TO DBD-HRA-HRTR IN DBD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
           IF DBD-STP-ITRN IN DBD NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
      *GET-MSG Busca mensaje en tabla
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'CRI    NACT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF NOT ( SCR-CMND = 'ACR' OR
              SCR-CMND = 'ECR' )
               GO TO CON-CMN-ACC.
           IF FRM-COD-CRCB IN DBD-FLD NOT > SPACES AND
              FRM-COD-CRCS IN DBD-FLD NOT > SPACES
               GO TO UPD-V.
           PERFORM KEY-ALL-CRC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF FIO-STAT-OKS
               PERFORM RET-ALL-CRC
               IF SCR-CMND = 'ACR'
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM DEU-FIO-CRI
                   IF NOT FIO-STAT-OKS
                       PERFORM ERR-MOD-CRI
                       GO TO FIN-CMN-ACC
                   ELSE
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       GO TO UPD-V
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM DEU-FIO-CRI
                   IF NOT FIO-STAT-OKS
                       PERFORM ERR-MOD-CRI
                       GO TO FIN-CMN-ACC
                   ELSE
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       GO TO UPD-V
           ELSE
      *ALD-BCI-INI
      *EN RET-ALL-CRC CARGA LLAVES DE CRI
               MOVE SPACES TO CRI
      *ALD-BCI-FIN
               PERFORM RET-ALL-CRC
               MOVE FIO-PUT TO FIO-CMND
               PERFORM DEU-FIO-CRI
               IF NOT FIO-STAT-OKS
                   PERFORM ERR-MOD-CRI
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'INGYES    ' TO MSG-COD-MENS.
       UPD-V.
           IF FRM-COD-CRVB IN DBD-FLD NOT > SPACES AND
              FRM-COD-CRVS IN DBD-FLD NOT > SPACES
               GO TO MSG-CMN-ACC.
            PERFORM KEY-ALL-CRV.
            MOVE FIO-GET-KEY-UPD TO FIO-CMND.
            PERFORM DEU-FIO-CRI.
            IF FIO-STAT-OKS
                PERFORM RET-ALL-CRV
                IF SCR-CMND = 'ACR'
                    MOVE FIO-MOD TO FIO-CMND
                    PERFORM DEU-FIO-CRI
                    IF NOT FIO-STAT-OKS
                        PERFORM ERR-MOD-CRI
                        GO TO FIN-CMN-ACC
                    ELSE
                        MOVE 'MODYES    ' TO MSG-COD-MENS
                        GO TO MSG-CMN-ACC
                ELSE
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM DEU-FIO-CRI
                    IF NOT FIO-STAT-OKS
                        PERFORM ERR-MOD-CRI
                        GO TO FIN-CMN-ACC
                    ELSE
                        MOVE 'ELIYES    ' TO MSG-COD-MENS
                        GO TO MSG-CMN-ACC
             ELSE
      *ALD-BCI-INI
      *EN RET-ALL-CRV CARGA LLAVES DE CRI
                 MOVE SPACES TO CRI
      *ALD-BCI-FIN
                 PERFORM RET-ALL-CRV
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM DEU-FIO-CRI
                 IF NOT FIO-STAT-OKS
                     PERFORM ERR-MOD-CRI
                     GO TO FIN-CMN-ACC
                 ELSE
                     MOVE 'INGYES    ' TO MSG-COD-MENS.
       MSG-CMN-ACC.
           MOVE 'GNS' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO FIN-CMN-ACC.
       CON-CMN-ACC.
*% END
*% IF EOF
      *>>>>
      *<<<< EOF
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
       ERR-MOD-CRI SECTION.
       INI-ERR-MOD-CRI.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF FIO-STAT-OKS
               MOVE '99' TO FIO-STAT
               MOVE 'ERROR : TRANSACCION BACK OUT, OK' TO FRM-MENS
           ELSE
               MOVE SYS-ABOR TO SYS-CMND
               MOVE 'ERROR : TRANSACCION BACK OUT, ABORTO' TO SYS-MENS
               PERFORM GNS-PRO-SYS.
       FIN-ERR-MOD-CRI.
           EXIT.
       BUS-CRI SECTION.
       INI-BUS-CRI.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO CRI-CAI-ICLI IN CRI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO CRI-IIC-ICLI IN CRI.
           MOVE 'C'                 TO CRI-IND-TCAR IN CRI.
           IF CRI-FEC-FCLA IN DBD-FLD NOT > ZEROES OR
              CRI-FEC-FCLA IN DBD-FLD NOT > SPACES
               MOVE '99999999' TO CRI-FEC-FCLA IN CRI
           ELSE
               MOVE CRI-NUM-SCLA IN DBD-FLD TO CRI-NUM-SCLA IN CRI
               MOVE CRI-NUM-ACLA IN DBD-FLD TO CRI-NUM-ACLA IN CRI
               MOVE CRI-NUM-MCLA IN DBD-FLD TO CRI-NUM-MCLA IN CRI
               MOVE CRI-NUM-DCLA IN DBD-FLD TO CRI-NUM-DCLA IN CRI.
           MOVE SPACES              TO WSS-COD-CRIB IN WSS-VARI.
           MOVE SPACES              TO WSS-COD-CRIS IN WSS-VARI.
           MOVE SPACES              TO CRI-IND-CRSB IN CRI.
           MOVE SPACES              TO CRI-IND-CRSS IN CRI.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO WSS-CAI-ICLI IN WSS-VARI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO WSS-IIC-ICLI IN WSS-VARI.
           IF ( SCR-CMND = 'ACR' OR SCR-CMND = 'ECR' ) AND
              CRI-FEC-FCLA IN CRI NOT = '99999999'
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DEU-FIO-CRI
               IF FIO-STAT-OKS
                   GO TO CON-LEE-CRI
               ELSE
                   MOVE SPACES TO WSS-COD-CRIB IN WSS-VARI
                   MOVE SPACES TO WSS-COD-CRIS IN WSS-VARI
                   MOVE 'V' TO CRI-IND-TCAR IN CRI
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-CRI
                   IF FIO-STAT-OKS
                       GO TO SET-VAL-CRI
                   ELSE
                       GO TO MOV-FEC-CRI
           ELSE
               PERFORM BUS-MAX-CRI
               IF NOT FIO-STAT-OKS
                   IF CRI-FEC-FCLA IN DBD-FLD NOT > ZEROES OR
                      CRI-FEC-FCLA IN DBD-FLD NOT > SPACES
                       MOVE ZEROES TO CRI-FEC-FCLA IN CRI
                       GO TO SET-VAL-CRI.
       CON-LEE-CRI.
           IF WSS-CIC-ICLI IN WSS-VARI NOT = CRI-CIC-ICLI IN CRI
               GO TO MOV-FEC-CRI.
           IF CRI-IND-TCAR IN CRI = 'C'
               MOVE CRI-FEC-FCLA IN CRI TO WSS-FEC-FCLA IN WSS-VARI
               MOVE CRI-IND-CRSB IN CRI TO WSS-COD-CRIB IN WSS-VARI
               MOVE CRI-IND-CRSS IN CRI TO WSS-COD-CRIS IN WSS-VARI
               IF WSS-FEC-FCLA IN WSS-VARI NOT = ZEROES
                   MOVE SPACES                   TO CRI-IND-CRSB IN CRI
                   MOVE SPACES                   TO CRI-IND-CRSS IN CRI
                   MOVE WSS-CIC-ICLI IN WSS-VARI TO CRI-CIC-ICLI IN CRI
                   MOVE WSS-FEC-FCLA IN WSS-VARI TO CRI-FEC-FCLA IN CRI
                   MOVE 'V'                      TO CRI-IND-TCAR IN CRI
                   MOVE FIO-GET-KEY     TO FIO-CMND
                   PERFORM DEU-FIO-CRI
                   IF FIO-STAT-OKS
                       GO TO SET-VAL-CRI
                   ELSE
                       MOVE SPACES TO CRI-IND-CRSB IN CRI
                       MOVE SPACES TO CRI-IND-CRSS IN CRI
                       GO TO SET-VAL-CRI
               ELSE
                   GO TO MOV-FEC-CRI
           ELSE
               IF CRI-IND-TCAR IN CRI = 'V'
                   MOVE SPACES TO WSS-COD-CRIB IN WSS-VARI
                   MOVE SPACES TO WSS-COD-CRIS IN WSS-VARI
                   GO TO SET-VAL-CRI.
       MOV-FEC-CRI.
           MOVE CRI-NUM-SCLA IN DBD-FLD TO CRI-NUM-SCLA IN CRI.
           MOVE CRI-NUM-ACLA IN DBD-FLD TO CRI-NUM-ACLA IN CRI.
           MOVE CRI-NUM-MCLA IN DBD-FLD TO CRI-NUM-MCLA IN CRI.
           MOVE CRI-NUM-DCLA IN DBD-FLD TO CRI-NUM-DCLA IN CRI.
           MOVE SPACES              TO WSS-COD-CRIB IN WSS-VARI.
           MOVE SPACES              TO WSS-COD-CRIS IN WSS-VARI.
           MOVE SPACES              TO CRI-IND-CRSB IN CRI.
           MOVE SPACES              TO CRI-IND-CRSS IN CRI.
       SET-VAL-CRI.
           MOVE CRI-NUM-DCLA IN CRI TO CRI-NUM-DCLA IN DBD-FLD.
           MOVE CRI-NUM-MCLA IN CRI TO CRI-NUM-MCLA IN DBD-FLD.
           MOVE CRI-NUM-SCLA IN CRI TO CRI-NUM-SCLA IN DBD-FLD.
           MOVE CRI-NUM-ACLA IN CRI TO CRI-NUM-ACLA IN DBD-FLD.
           MOVE WSS-COD-CRIB        TO FRM-COD-CRCB IN DBD-FLD.
           MOVE WSS-COD-CRIS        TO FRM-COD-CRCS IN DBD-FLD.
           MOVE CRI-IND-CRSB IN CRI TO FRM-COD-CRVB IN DBD-FLD.
           MOVE CRI-IND-CRSS IN CRI TO FRM-COD-CRVS IN DBD-FLD.
           MOVE '00' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-CRI.
       FIN-BUS-CRI.
           EXIT.
       BUS-MAX-CRI SECTION.
       INI-BUS-MAX-CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF NOT ( FIO-STAT-OKS AND
              WSS-CIC-ICLI IN WSS-VARI = CRI-CIC-ICLI IN CRI AND
              CRI-IND-TCAR IN CRI = 'C' )
               MOVE ZEROES TO CRI-FEC-FCLA IN CRI.
           MOVE CRI-FEC-FCLA IN CRI TO WSS-FEC-FCLA IN WSS-VARI.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO CRI-CAI-ICLI IN CRI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO CRI-IIC-ICLI IN CRI.
           MOVE 'V'                     TO CRI-IND-TCAR IN CRI.
           MOVE '99999999'              TO CRI-FEC-FCLA IN CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF FIO-STAT-OKS AND
              WSS-CIC-ICLI IN WSS-VARI = CRI-CIC-ICLI IN CRI AND
              CRI-IND-TCAR IN CRI = 'V'
               IF CRI-FEC-FCLA IN CRI > WSS-FEC-FCLA IN WSS-VARI
                   GO TO FIN-BUS-MAX-CRI.
           IF WSS-FEC-FCLA IN WSS-VARI NOT > ZEROES
               MOVE SPACES TO CRI-IND-CRSB IN CRI
               MOVE SPACES TO CRI-IND-CRSS IN CRI
               MOVE SPACES TO WSS-COD-CRIB IN WSS-VARI
               MOVE SPACES TO WSS-COD-CRIS IN WSS-VARI
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-BUS-MAX-CRI
           ELSE
               MOVE WSS-FEC-FCLA IN WSS-VARI TO CRI-FEC-FCLA IN CRI.
           MOVE CRI-FEC-FCLA IN CRI TO WSS-FEC-FCLA IN WSS-VARI.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO CRI-CAI-ICLI IN CRI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO CRI-IIC-ICLI IN CRI.
           MOVE 'C'                     TO CRI-IND-TCAR IN CRI.
           MOVE '99999999'              TO CRI-FEC-FCLA IN CRI.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
       FIN-BUS-MAX-CRI.
           EXIT.
       KEY-ALL-CRC SECTION.
       INI-KEY-ALL-CRC.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO CRI-CAI-ICLI IN CRI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO CRI-IIC-ICLI IN CRI.
           MOVE 'C' TO CRI-IND-TCAR IN CRI.
           MOVE CRI-NUM-DCLA IN DBD-FLD TO CRI-NUM-DCLA IN CRI.
           MOVE CRI-NUM-MCLA IN DBD-FLD TO CRI-NUM-MCLA IN CRI.
           MOVE CRI-NUM-SCLA IN DBD-FLD TO CRI-NUM-SCLA IN CRI.
           MOVE CRI-NUM-ACLA IN DBD-FLD TO CRI-NUM-ACLA IN CRI.
       FIN-KEY-ALL-CRC.
           EXIT.
       KEY-ALL-CRV SECTION.
       INI-KEY-ALL-CRV.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO CRI-CAI-ICLI IN CRI.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO CRI-IIC-ICLI IN CRI.
           MOVE 'V' TO CRI-IND-TCAR IN CRI.
           MOVE CRI-NUM-DCLA IN DBD-FLD TO CRI-NUM-DCLA IN CRI.
           MOVE CRI-NUM-MCLA IN DBD-FLD TO CRI-NUM-MCLA IN CRI.
           MOVE CRI-NUM-SCLA IN DBD-FLD TO CRI-NUM-SCLA IN CRI.
           MOVE CRI-NUM-ACLA IN DBD-FLD TO CRI-NUM-ACLA IN CRI.
       FIN-KEY-ALL-CRV.
           EXIT.
       RET-ALL-CRC SECTION.
       INI-RET-ALL-CRC.
           PERFORM KEY-ALL-CRC.
           MOVE FRM-COD-CRCB IN DBD-FLD TO CRI-IND-CRSB IN CRI.
           MOVE FRM-COD-CRCS IN DBD-FLD TO CRI-IND-CRSS IN CRI.
       FIN-RET-ALL-CRC.
           EXIT.
       RET-ALL-CRV SECTION.
       INI-RET-ALL-CRV.
           PERFORM KEY-ALL-CRV.
           MOVE FRM-COD-CRVB IN DBD-FLD TO CRI-IND-CRSB IN CRI.
           MOVE FRM-COD-CRVS IN DBD-FLD TO CRI-IND-CRSS IN CRI.
       FIN-RET-ALL-CRV.
           EXIT.
       COPY SGCBFREC.
       COPY SGCBFDBC.
       COPY SGCBFDSF.
       COPY SGCBFRBS.
       COPY DEUBFCRI.
       COPY COLBFRDC.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBMSC.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY SGCBGCLI.
       COPY GNSBGPPU.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       BUS-CLI-NMB SECTION.
       INI-BUS-CLI-NMB.
      *NOM-CLI Busca Cliente por medio del Nombre
           MOVE DBC-GLS-NOMC IN DBD-FLD TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.
           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBD-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DBD-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DBD-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DBD-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DBD-FLD
               MOVE DBC-CAI-ICLI IN DBC TO DBD-CAI-ICLI IN DBD-FLD 
               MOVE DBC-IIC-ICLI IN DBC TO DBD-IIC-ICLI IN DBD-FLD
               IF SCR-CCPP = 'ING'    
                   PERFORM PUT-FRM-DBD
                   MOVE '00' TO FIO-STAT.
       FIN-BUS-CLI-NMB.
           EXIT.
       BUS-CLI-IDC SECTION.
       INI-BUS-CLI-IDC.
      *IDC-CLI Busca Cliente por medio de IdC
           MOVE DBC-NUM-ICLI IN DBD-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DBD-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DBD-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBD-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DBD-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DBD-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DBD-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DBD-FLD
               MOVE DBC-CAI-ICLI IN DBC TO DBD-CAI-ICLI IN DBD-FLD 
               MOVE DBC-IIC-ICLI IN DBC TO DBD-IIC-ICLI IN DBD-FLD
               IF SCR-CCPP = 'ING'    
                   PERFORM PUT-FRM-DBD
                   MOVE '00' TO FIO-STAT.
       FIN-BUS-CLI-IDC.
           EXIT.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
      *ALD-BCI-INI
           MOVE ZEROES TO DBD-FEC-FUCA IN DBD.
           MOVE ZEROES TO DBD-FEC-FEMA IN DBD.
           MOVE ZEROES TO DBD-FEC-FCRI IN DBD.
           MOVE ZEROES TO DBD-NUM-SOLR IN DBD.
           MOVE ZEROES TO DBD-NUM-OCTD IN DBD.
           MOVE ZEROES TO DBD-NUM-OCVG IN DBD.
           MOVE ZEROES TO DBD-NUM-VCVG IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCO IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCA IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCP IN DBD.
           MOVE ZEROES TO DBD-NUM-VCCR IN DBD.
           MOVE ZEROES TO DBD-VAL-EMUF IN DBD.
           MOVE ZEROES TO DBD-VAL-EPUF IN DBD.
      *ALD-BCI-FIN
      *>>>>
*% END
*% IF INI_HBL_KEY AND PGM_PU
           IF SCR-DESDE-CMN
               MOVE DBD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBD-FLD
               MOVE FRM-MENS TO DBD-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-DBD.
           PERFORM UNP-KEY-DBD.
           PERFORM FST-KEY-DBD.
           GO TO FIN-HBL-KEY.
*% END
*% IF INI_HBL_IKY AND PGM_PU
           IF SCR-DESDE-CMN
               MOVE DBD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBD-FLD
               MOVE FRM-MENS TO DBD-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-DBD.
           PERFORM PRO-MKY-DBD.
           PERFORM UNP-IKY-DBD.
           PERFORM FST-KEY-DBD.
           GO TO FIN-HBL-IKY.
*% END
*% IF SCR_PGM
      *<<<<
       GO TO FIN-SCR-PGM.
      *>>>>
*% END
*% IF INI_HBL_IKY AND PGM_PQ
           IF SCR-DESDE-CMN
               MOVE DBD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBD-FLD
               MOVE FRM-MENS TO DBD-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-MKY-DBD.
           PERFORM PRO-AKY-DBD.
           PERFORM UNP-IKY-DBD.
           PERFORM FST-KEY-DBD.
           GO TO FIN-HBL-IKY.
*% END
*% IF INI_HBL_KEY AND PGM_PQ
           IF SCR-DESDE-CMN
               MOVE DBD-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBD-FLD
               MOVE FRM-MENS TO DBD-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-DBD.
           PERFORM FST-KEY-DBD.
           GO TO FIN-HBL-KEY.
*% END           
