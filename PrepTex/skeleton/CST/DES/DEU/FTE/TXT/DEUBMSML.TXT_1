*%! Codigo adicional para archivo
*% IF INI_PUT_DBC_SML
      *>>>>> INI_PUT_DBC_SML
           GO TO FIN-PUT-DBC-SML.
      *>>>>>
*% END
*% IF FIN_PUT_OPC_SML
      *<<<< FIN_PUT_OPC_SML
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-VCOC IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN SML-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPC-COD-TOOC IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN SML-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPC-COD-OFOC IN SML-FLD > SPACES
               MOVE OPC-COD-OFOC IN SML-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOC IN SML-FLD.
      *RGD

           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND
                   TAB-IND-VIGE IN TAB = 'S')
              MOVE SPACES TO FRM-GLS-AOOC IN SML-FLD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO
                   FRM-GLS-AOOC IN SML-FLD.

           MOVE OPC-MSC-STAT IN OPC TO FRM-MSC-STAT IN SML-FLD.
           MOVE 'ESP'         TO TAB-CIC-TTAB IN TAB.
           IF FRM-MSC-STAT IN SML-FLD > SPACES
              MOVE FRM-MSC-STAT  IN SML-FLD
                                 TO TAB-CIC-CTAB IN TAB
              MOVE 'COL'         TO FIO-SIST
              MOVE 'TAB-CIC-TABL' TO FIO-AKEY
              MOVE FIO-GET-KEY   TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT (FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'S')
                 MOVE SPACES TO FRM-GLS-STAT IN SML-FLD
              ELSE
                 MOVE TAB-COD-CTAB IN TAB TO
                      FRM-GLS-STAT IN SML-FLD.

           MOVE OPC-NUM-DCOL IN OPC TO FRM-NUM-DINI IN SML-FLD.
           MOVE OPC-NUM-MCOL IN OPC TO FRM-NUM-MINI IN SML-FLD.
           MOVE OPC-NUM-SCOL IN OPC TO FRM-NUM-SINI IN SML-FLD.
           MOVE OPC-NUM-ACOL IN OPC TO FRM-NUM-AINI IN SML-FLD.

           MOVE OPC-CAI-IOPC IN SML-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-PUT-OPC-SML.
           MOVE 'RDC-KEY-IDLC'          TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
      *     DISPLAY 'SML FIO-STAT :' FIO-STAT.
      *     DISPLAY 'SML RDC : ' RDC.
           IF FIO-STAT-OKS AND
               OPC-CAI-IOPC IN SML-FLD = RDC-CAI-IOPC IN RDC AND
               OPC-IIC-IOPC IN SML-FLD = RDC-IIC-IOPC IN RDC
              IF RDC-NUM-IDLC IN RDC     = ZEROES
                 MOVE RDC-CAI-ICLI IN RDC          TO SCR-CAI-ICLI
                 MOVE RDC-IIC-ICLI IN RDC          TO SCR-IIC-ICLI
              ELSE
                 MOVE FIO-GET-NXT             TO FIO-CMND
                 GO TO LUP-PUT-OPC-SML
           ELSE
              MOVE SPACES                       TO SCR-CAI-ICLI
              MOVE SPACES                       TO SCR-IIC-ICLI.

           IF SCR-IIC-ICLI > SPACES
               MOVE SCR-CIC-ICLI TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES       TO DBC-GLS-NOMC IN SML-FLD
               ELSE
                  MOVE DBC-NUM-ICLI IN DBC
                                    TO DBC-NUM-ICLI IN SML-FLD
                  MOVE DBC-IND-ICLI IN DBC
                                    TO DBC-IND-ICLI IN SML-FLD
                  MOVE DBC-GLS-ICLI IN DBC
                                    TO DBC-GLS-ICLI IN SML-FLD
                  MOVE DBC-VRF-ICLI IN DBC
                                    TO DBC-VRF-ICLI IN SML-FLD
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN            TO
                              DBC-GLS-NOMC IN SML-FLD.
      *           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.

           MOVE OPC-CAI-IOPC IN SML-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE 1                       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS
              MOVE DLC-NUM-DMAV IN DLC TO FRM-NUM-DMAX IN SML-FLD
              MOVE DLC-NUM-MMAV IN DLC TO FRM-NUM-MMAX IN SML-FLD
              MOVE DLC-NUM-SMAV IN DLC TO FRM-NUM-SMAX IN SML-FLD
              MOVE DLC-NUM-AMAV IN DLC TO FRM-NUM-AMAX IN SML-FLD.

           IF DLC-IND-SCTB IN DLC = 'CAS'
              MOVE OPC-CAI-IOPC IN SML-FLD TO CCT-CAI-IOPC IN CCT
              MOVE OPC-IIC-IOPC IN SML-FLD TO CCT-IIC-IOPC IN CCT
              MOVE 1                       TO CCT-NUM-IDLC IN CCT
              MOVE 1                       TO CCT-NUM-ICCT IN CCT

              MOVE FIO-GET-KEY             TO FIO-CMND
              PERFORM COL-FIO-CCT
              IF FIO-STAT-OKS
                 MOVE CCT-NUM-SCCT IN CCT TO FRM-NUM-SCAS IN SML-FLD
                 MOVE CCT-NUM-ACCT IN CCT TO FRM-NUM-ACAS IN SML-FLD
                 MOVE CCT-NUM-MCCT IN CCT TO FRM-NUM-MCAS IN SML-FLD
                 MOVE CCT-NUM-DCCT IN CCT TO FRM-NUM-DCAS IN SML-FLD.

           MOVE OPC-CAI-IOPC IN SML-FLD TO CXE-CAI-IOPC IN CXE.
           MOVE OPC-IIC-IOPC IN SML-FLD TO CXE-IIC-IOPC IN CXE.
           MOVE 'SML'                   TO CXE-COD-EVEN IN CXE.
           MOVE 1                       TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                  TO CXE-CAI-IOPV IN CXE.
           MOVE SPACES                  TO CXE-IIC-IOPV IN CXE.
           MOVE ZEROES                  TO CXE-NUM-IVCT IN CXE.
           MOVE SPACES                  TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY             TO FIO-CMND.

           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
              MOVE CXE-SGV-MNTO IN CXE TO FRM-VAL-CREX IN SML-FLD.
              MOVE CXE-COD-VCOC IN CXE TO FRM-COD-VCOX IN SML-FLD.

           IF FRM-COD-VCOX IN SML-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-VCOX IN SML-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOX IN SML-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOX IN SML-FLD.

           PERFORM CARGA-AVALES.
      *>>>>>
*% END
*% IF INI_FST_KEY_SML AND PGM_PQ
      *<<<< INI_FST_KEY_SML
      *RGD
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              MOVE FRM-POS-CURS TO OPC-CAI-IOPC-LEN IN SML-FLD
           ELSE
              MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN SML-FLD.
           GO TO FIN-FST-KEY-SML.
 
      *>>>>
*% END
*% IF INI_UNP_IKY_SML
      *<<<< INI_UNP_IKY_SML
      *RGD
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SML-FLD

              MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR IN SML-FLD
           ELSE
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SML-FLD

              MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SML-FLD.
           GO TO FIN-UNP-IKY-SML.
 
      *>>>>
*% END
*% IF INI_UNP_FLD_SML
      *<<<< INI_UNP_FLD_SML
           IF SCR-CCPP = 'MOD'
              PERFORM UNP-OPC-SML
              GO TO FIN-UNP-FLD-SML.

      *>>>>
*% END
*% IF INI_VAL_IKY_SML
      *<<<< INI_VAL_IKY_SML 
      *RGD
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              PERFORM VALIDA-KEY-OPC
           ELSE
              PERFORM VALIDA-KEY-DBC.
           GO TO FIN-VAL-IKY-SML.
      *>>>>
*% END
*% IF INI_UNP_OPC_SML
      *<<<< INI_UNP_OPC_SML 
      *RGD
           IF SCR-CCPP = 'ING' OR SCR-CCPP = 'ACC'
              MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR IN SML-FLD.

           IF SCR-CCPP = 'MOD'
              MOVE FRM-CPIM-UBY TO OPC-VAL-CRED-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO FRM-FEC-FCAS-ATR IN SML-FLD
              MOVE FRM-CPIM-UBY TO FRM-VAL-CREX-ATR IN SML-FLD
              GO TO FIN-UNP-OPC-SML.
      *>>>>
*% END
*% IF FIN_VAL_FLD_SML
      *>>>> FIN_VAL_FLD_SML
           IF SCR-CMND = 'ING'
              PERFORM VAL-OPC-CAI-IOPC
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO OPC-CAI-IOPC-LEN IN SML-FLD
                   GO TO FIN-VAL-FLD-SML.

           IF SCR-CMND = 'ING'
              PERFORM VAL-OPC-IIC-IOPC
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SML-FLD
                   GO TO FIN-VAL-FLD-SML.

           PERFORM VALIDA-DIRIND
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 8
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.

           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-FLD-SML.

           PERFORM VALIDA-AVALES.
      *>>>> 
*% END
*% IF INI_FRM_FEC_FMAX      
      *>>>> INI_FRM_FEC_FMAX
           MOVE FEC-CHOY-GE TO FEC-CHOY.
      *>>>> 
*% END
*% IF INI_OPC_COD_CVTA
      *>>>> INI_OPC_COD_CVTA
      *RGD
           MOVE 'DEU'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VEL'          TO TAB-CIC-TTAB IN TAB.
           MOVE OPC-COD-CVTA   IN SML-FLD
                               TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND
                   TAB-IND-VIGE IN TAB = 'S')
              MOVE 'GNS'        TO MSG-COD-SIST
              MOVE 'COD    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

           GO TO FIN-VAL-OPC-COD-CVTA.
 
      *>>>> 
*% END
*% IF FIN_OPC_COD_CVTA
      *<<<< FIN_OPC_COD_CVTA
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'CVT ' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-CVTA IN SML-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> 
*% END
*% IF FIN_OPC_IIC_IOPC
      *>>>> FIN_OPC_IIC_IOPC
           MOVE OPC-CAI-IOPC IN SML-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              IF NOT FIO-STAT-OKS
                 MOVE 'COL' TO MSG-COD-SIST
                 MOVE 'OPC    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 IF OPC-COD-ATRN IN OPC NOT = 'DEUPUSML    '
                    MOVE 'COL' TO MSG-COD-SIST
                    MOVE 'OPENOELIM   ' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF NOT (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI')
              IF FIO-STAT-OKS
                 MOVE 'REGEXI    ' TO MSG-COD-MENS
                 MOVE 'GNS'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF  FIN_DBC_VRF_ICLI
      *<<<<  FIN_DBC_VRF_ICLI
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN SML-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN SML-FLD
                                 TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN SML-FLD
                                 TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN SML-FLD
                                 TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN SML-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO
                               DBC-GLS-NOMC IN SML-FLD
      *RGD-INI PENTA 22-06-2015
      *            MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
                   MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI
                   IF DBC-CAI-ICLI IN DBC = 'NC  ' 
                      MOVE 'SGC'         TO MSG-COD-SIST
                      MOVE 'CLIINVSML  ' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC  TO FRM-MENS
      *RGD-INI PENTA 02-07-2015
      *               MOVE FRM-SUAR-MAL  TO FRM-SUAR.
                      MOVE FRM-SUAR-MAL  TO FRM-SUAR 
                   ELSE
                      DISPLAY 'DBC-COD-ODSE: ' DBC-COD-ODSE IN DBC
                      IF DBC-COD-ODSE IN DBC = '005'
                         MOVE 'SGC'         TO MSG-COD-SIST
                         MOVE 'CLINAPSML  ' TO MSG-COD-MENS
                         PERFORM GET-MSG
                         MOVE MSG-GLS-DESC  TO FRM-MENS
                         MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      *RGD-FIN PENTA 02-07-2015
      *RGD-FIN PENTA 22-06-2015
      *>>>>
*% END
*% IF INI_FRM_SGV_PORC
      *<<<< INI_FRM_SGV_PORC
           IF FRM-NUM-ICLI IN SML-FLD(FRM-IFLD) > ZEROES
             IF FRM-SGV-PORC IN SML-FLD(FRM-IFLD) NOT > ZEROES
                MOVE 'INDFVARVARE' TO MSG-COD-MENS
                MOVE 'GNS'         TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
             ELSE
               IF FRM-SGV-PORC IN SML-FLD(FRM-IFLD) > 100
                  MOVE 'VALLIMD>100' TO MSG-COD-MENS
                  MOVE 'COL'         TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC  TO FRM-MENS
                  MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_FRM_MSC_STAT
      *<<<<  FIN_FRM_MSC_STAT
            MOVE 'ESP'         TO TAB-CIC-TTAB IN TAB.
            MOVE FRM-MSC-STAT  IN SML-FLD
                               TO TAB-CIC-CTAB IN TAB.
            MOVE 'COL'         TO FIO-SIST.
            MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND
                    TAB-IND-VIGE IN TAB = 'S')
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-STAT.

               MOVE TAB-COD-CTAB IN TAB TO
                    FRM-GLS-STAT IN SML-FLD.
      *>>>>
*% END
*% IF  FIN_OPC_COD_VCOC
      *<<<<  FIN_OPC_COD_VCOC
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN SML-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              OPC-COD-VCOC IN SML-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN SML-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN SML-FLD.

            MOVE 'VLR'         TO TAB-COD-TTAB IN TAB.
            MOVE OPC-COD-VCOC  IN SML-FLD
                               TO TAB-COD-CTAB IN TAB.
            MOVE 'TAB'         TO FIO-SIST.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND
                    TAB-IND-VIGE IN TAB = 'S')
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPC-COD-VCOC.

               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCOC IN SML-FLD.
      *>>>>
*% END
*% IF  FIN_OPC_COD_TOOC
      *<<<<  FIN_OPC_COD_TOOC
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN SML-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              OPC-COD-TOOC IN SML-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN SML-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOOC IN SML-FLD.

            MOVE 'TIO'         TO TAB-COD-TTAB IN TAB.
            MOVE OPC-COD-TOOC  IN SML-FLD
                               TO TAB-COD-CTAB IN TAB.
            MOVE 'TAB'         TO FIO-SIST.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND
                    TAB-IND-VIGE IN TAB = 'S')
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPC-COD-TOOC.

               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOOC IN SML-FLD.
      *>>>>
*% END
*% IF  FIN_OPC_COD_AOOC
      *<<<<  FIN_OPC_COD_AOOC
            MOVE OPC-COD-TOOC  IN SML-FLD TO WSS-COD-TIO.
            MOVE OPC-COD-AOOC  IN SML-FLD TO WSS-COD-AUX.
            MOVE 'AUX'         TO TAB-COD-TTAB IN TAB.
            MOVE WSS-TIO-AUX   TO TAB-COD-CTAB IN TAB.
            MOVE 'TAB'         TO FIO-SIST.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND
                    TAB-IND-VIGE IN TAB = 'S')
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPC-COD-AOOC.

               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-AOOC IN SML-FLD.
      *>>>>
*% END
*% IF  FIN_OPC_COD_OFOC
      *<<<<  FIN_OPC_COD_OFOC
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE OPC-COD-OFOC IN SML-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFOC IN SML-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOC IN SML-FLD.

            MOVE OPC-COD-OFOC  IN SML-FLD
                               TO OFI-COD-OFIC IN OFI.
            MOVE 'TAB'         TO FIO-SIST.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM TAB-FIO-OFI.
            IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-OPC-COD-OFOC.

               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-OFOC IN SML-FLD.
      *>>>>
*% END
*% IF INI_FRM_COD_PAI
      *<<<< INI_FRM_COD_PAI
      *RGD
           IF FRM-COD-PAI IN SML-FLD NOT > SPACES
                GO TO FIN-VAL-FRM-COD-PAI.

      *>>>>
*% END
*% IF  FIN_FRM_COD_PAI
      *<<<<  FIN_FRM_COD_PAI
            MOVE 'PAI'         TO TAB-COD-TTAB IN TAB.
            MOVE FRM-COD-PAI   IN SML-FLD
                               TO TAB-COD-CTAB IN TAB.
            MOVE 'TAB'         TO FIO-SIST.
            MOVE FIO-GET-KEY   TO FIO-CMND.
            PERFORM GNS-FIO-TAB.
            IF NOT (FIO-STAT-OKS AND
                    TAB-IND-VIGE IN TAB = 'S')
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-PAI.

               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-PAI IN SML-FLD.
      *>>>>
*% END
*% IF INI_FRM_FEC_FCAS
      *<<<< INI_FRM_FEC_FCAS
      *RGD
           IF FRM-FEC-FCAS IN SML-FLD  NOT > ZEROES
              GO TO FIN-VAL-FRM-FEC-FCAS.
         
           MOVE FEC-CHOY-N  TO FEC-CHOY.
      *>>>>
*% END
*% IF FIN_FRM_COD_VCOX
      *<<<< FIN_FRM_COD_VCOX
           MOVE 'VLR'         TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-VCOX  IN SML-FLD
                              TO TAB-COD-CTAB IN TAB.
           MOVE 'TAB'         TO FIO-SIST.
           MOVE FIO-GET-KEY   TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND
                   TAB-IND-VIGE IN TAB = 'S')
              MOVE 'GNS'        TO MSG-COD-SIST
              MOVE 'COD    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-VCOX.

           MOVE TAB-GLS-DCOR IN TAB TO
                FRM-GLS-VCOX IN SML-FLD.
      *>>>>
*% END
*% IF  FIN_FRM_VRF_ICLI
      *<<<<  FIN_FRM_VRF_ICLI
           MOVE SPACES TO AUX-CIC-ICLA(FRM-IFLD).
           IF MSG-COD-MENS = SPACES AND
              FRM-NUM-ICLI IN SML-FLD(FRM-IFLD) > ZEROES
               MOVE FRM-NUM-ICLI IN SML-FLD(FRM-IFLD)
                                 TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN SML-FLD(FRM-IFLD)
                                 TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN SML-FLD(FRM-IFLD)
                                 TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                  MOVE 'SGC'        TO MSG-COD-SIST
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN SML-FLD(FRM-IFLD)
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-VRF-ICLI
               ELSE
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN            TO
                              FRM-GLS-NOMC IN SML-FLD(FRM-IFLD)
      *RGD-INI PENTA 22-06-2015
      *           MOVE DBC-CIC-ICLI IN DBC TO AUX-CIC-ICLA(FRM-IFLD).
                  MOVE DBC-CIC-ICLI IN DBC TO AUX-CIC-ICLA(FRM-IFLD) 
                  IF DBC-CAI-ICLI IN DBC = 'NC  '
                      MOVE 'SGC'         TO MSG-COD-SIST
                      MOVE 'CLIINVSML  ' TO MSG-COD-MENS
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC  TO FRM-MENS
                      MOVE FRM-SUAR-MAL  TO FRM-SUAR.
      *RGD-FIN PENTA 22-06-2015
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
      *RGD
       VALIDA-KEY-OPC SECTION.
       INI-VALIDA-KEY-OPC.
           PERFORM VAL-OPC-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-CAI-IOPC-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-OPC.
           PERFORM VAL-OPC-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-OPC.
       FIN-VALIDA-KEY-OPC.
           EXIT.

       VALIDA-KEY-DBC SECTION.
       INI-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SML-FLD
                GO TO FIN-VALIDA-KEY-DBC.
       FIN-VALIDA-KEY-DBC.
           EXIT.

       CARGA-AVALES SECTION.
       INI-CARGA-AVALES.
           MOVE ZEROES TO WSS-I.
           MOVE OPC-CAI-IOPC IN SML-FLD TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE 1                       TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CARGA-AVALES.
           MOVE 'RDC-KEY-IDLC'          TO FIO-AKEY.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
               OPC-CAI-IOPC IN SML-FLD = RDC-CAI-IOPC IN RDC AND
               OPC-IIC-IOPC IN SML-FLD = RDC-IIC-IOPC IN RDC AND
               RDC-NUM-IDLC IN RDC = 1)
               GO TO FIN-CARGA-AVALES.

           ADD 1 TO WSS-I.

           IF WSS-I > 8
               GO TO FIN-CARGA-AVALES.

           MOVE RDC-VAL-LIMD IN RDC TO FRM-SGV-PORC IN SML-FLD(WSS-I).

           MOVE RDC-CAI-ICLI TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
              MOVE SPACES       TO FRM-NUM-ICLI-ALF IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-VRF-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-IND-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-GLS-ICLI IN SML-FLD(WSS-I)
              MOVE SPACES       TO FRM-GLS-NOMC IN SML-FLD(WSS-I)
           ELSE
              MOVE DBC-NUM-ICLI IN DBC
                                TO FRM-NUM-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-VRF-ICLI IN DBC
                                TO FRM-VRF-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-IND-ICLI IN DBC
                                TO FRM-IND-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-GLS-ICLI IN DBC
                                TO FRM-GLS-ICLI IN SML-FLD(WSS-I)
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN            TO
                          FRM-GLS-NOMC IN SML-FLD(WSS-I).

           MOVE FIO-GET-NXT             TO FIO-CMND.
           GO TO LUP-CARGA-AVALES.

       FIN-CARGA-AVALES.
           MOVE SCR-CAI-ICLI TO DBC-CAI-ICLI IN DBC.
           MOVE SCR-IIC-ICLI TO DBC-IIC-ICLI IN DBC.
           EXIT.
      *>>>>
*% END
*% IF EOF_BU
      *>>>> EOF_BU
       VALIDA-DIRIND SECTION.
       INI-VALIDA-DIRIND.
           IF FRM-NUM-ICLI IN SML-FLD(FRM-IFLD) > ZEROES
              IF FRM-NUM-ICLI IN SML-FLD(FRM-IFLD) =
                 DBC-NUM-ICLI IN SML-FLD
                  MOVE 'DEUDIR=IND'  TO MSG-COD-MENS
                  MOVE 'COL'         TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC  TO FRM-MENS
                  MOVE FRM-IND-ERRO TO
                       FRM-NUM-ICLI-LEN IN SML-FLD(FRM-IFLD)
                  MOVE FRM-SUAR-MAL  TO FRM-SUAR.
       FIN-VALIDA-DIRIND.
           EXIT.
       VALIDA-AVALES SECTION.
       INI-VALIDA-AVALES.
           MOVE ZEROES TO WSS-I.
       LUP-WSS-I.
           ADD 1 TO WSS-I.
           IF WSS-I > 8
              GO TO FIN-VALIDA-AVALES.

           MOVE ZEROES TO WSS-J.
       LUP-WSS-J.
           ADD 1 TO WSS-J.
           IF WSS-J > 8
              GO TO LUP-WSS-I.

           IF WSS-J = WSS-I
              GO TO LUP-WSS-J.

           IF FRM-NUM-ICLI IN SML-FLD(WSS-I) NOT > ZEROES  OR
                FRM-NUM-ICLI IN SML-FLD(WSS-J) NOT > ZEROES
              GO TO LUP-WSS-J.

           IF FRM-NUM-ICLI IN SML-FLD(WSS-I) =
                FRM-NUM-ICLI IN SML-FLD(WSS-J)
                  MOVE 'DEUINDDUP'   TO MSG-COD-MENS
                  MOVE 'COL'         TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC  TO FRM-MENS
                  MOVE FRM-SUAR-MAL  TO FRM-SUAR
                  MOVE FRM-IND-ERRO TO
                       FRM-NUM-ICLI-LEN IN SML-FLD(WSS-I)
                  GO TO FIN-VALIDA-AVALES.

              GO TO LUP-WSS-J.

       FIN-VALIDA-AVALES.
           EXIT.

       VAL-OPC-CAI-IOPC SECTION.
       INI-VAL-OPC-CAI-IOPC.
           IF OPC-CAI-IOPC IN SML-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OPC-CAI-IOPC.
       FIN-VAL-OPC-CAI-IOPC.
           EXIT.

       VAL-OPC-IIC-IOPC SECTION.
       INI-VAL-OPC-IIC-IOPC.
           IF OPC-IIC-IOPC IN SML-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-OPC-IIC-IOPC.
      *>>>>>FIN_OPC_IIC_IOPC
           MOVE OPC-CAI-IOPC IN SML-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SML-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI'
              IF NOT FIO-STAT-OKS
                 MOVE 'COL' TO MSG-COD-SIST
                 MOVE 'OPC    NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 IF OPC-COD-ATRN IN OPC NOT = 'DEUPUSML    '
                    MOVE 'COL' TO MSG-COD-SIST
                    MOVE 'OPENOELIM   ' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF NOT (SCR-CCPP = 'MOD' OR SCR-CCPP = 'ELI')
              IF FIO-STAT-OKS
                 MOVE 'REGEXI    ' TO MSG-COD-MENS
                 MOVE 'GNS'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>>
       FIN-VAL-OPC-IIC-IOPC.
           EXIT.
      *>>>>
*% END
