       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. SGCPADBP.
       AUTHOR.     CONSIST.
       DATE-WRITTEN. 29-Jul-92 07:23 PM.

      * ACTUALIZA ARCHIVO SGCDBC EN FORMA INTERACTIVA.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY SGCBRDBC.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSCR.


       COPY SGCWIDBP.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY TABBROFI.
       COPY TABBRUSR.
      *<<<< WSS
      *ALD/21-JUL-1988
       COPY SGCBRRBS.
      *
       COPY SGCBRREC.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
       COPY SGCBRRCD.
       COPY GNSBRCIC.
       COPY TABBRPAI.
       COPY GNSWGCIC.
       COPY GNSWGCPT.
       COPY SGCWVPPU.

       01  WSS-VARI.
           03 WSS-COD-CTCA.
              05 WSS-COD-TREC                           PIC X(02).
              05 WSS-COD-AREC                           PIC X(03).
           03 WSS-COD-LUGA.
              05 WSS-COD-COMU                           PIC X(04).
              05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                 07 WSS-IND-PAIS                        PIC X(01).
                 07 WSS-COD-PAIS                        PIC X(03).
           03 WSS-COD-TUSR                              PIC X(05).
           03 WSS-SIND.
              05 I                                      PIC 9(03).

           03 WSS-GLS-NOM1                              PIC X(25).
           03 WSS-VEC-NOM1 REDEFINES WSS-GLS-NOM1
                              OCCURS 25                 PIC X(01).

           03 WSS-GLS-NOM2                              PIC X(25).
           03 WSS-VEC-NOM2 REDEFINES WSS-GLS-NOM2
                              OCCURS 25                 PIC X(01).

           03 WSS-IND-NOM1                              PIC 9(02).
           03 WSS-IND-NOM2                              PIC 9(02).
      *DAD ini 26-FEB-1991
           03 WSS-NUM-NMSG                              PIC X(04).
      *DAD fin 26-FEB-1991
      *DAD ini  05-JUN-1992
           03 WSS-IND                                   PIC 9(02).
           03 WSS-IND-STAT                              PIC X(01).
           03 WSS-GLS-FONO.
              05 WSS-NUM-FONO         OCCURS 12         PIC X(01).
      *DAD fin  05-JUN-1992
      *DAD ini  13-MAY-1992
           03 WSS-CIC-TICL                              PIC X(02).
           03 WSS-COD-OFIC                              PIC X(03).
           03 WSS-COD-EJEC                              PIC X(12).
      *DAD fin  13-MAY-1992
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-STAT.
              05 PGM-STAT-DBC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-DBC-OKS    VALUE '00'.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
              05 PGM-STAT-RCD           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCD-OKS    VALUE '00'.
                 88 PGM-STAT-RCD-NUL    VALUE '  '.
              05 PGM-STAT-DCP           VALUE '23'      PIC X(02).
                 88 PGM-STAT-DCP-OKS    VALUE '00'.
                 88 PGM-STAT-DCP-NUL    VALUE '  '.
              05 PGM-STAT-MNP           VALUE '23'      PIC X(02).
                 88 PGM-STAT-MNP-OKS    VALUE '00'.
                 88 PGM-STAT-MNP-NUL    VALUE '  '.
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-NCUR                  VALUE "[?25l" PIC X(06).
           03 PGM-SCUR                  VALUE "[?25h" PIC X(06).

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
           MOVE 'SGCPADBP' TO SCR-PROG.
           CALL 'GNSPPHDR'.
           MOVE SCR-INST-HKY TO SCR-INST.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-MSG.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GNS'   TO FIO-SIST.
           PERFORM GNS-FIO-MSG.

           MOVE 'SGC'        TO FIO-SIST.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           PERFORM GNS-FIO-TAB.
           MOVE 'SGC'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *<<<< INI_FIO AND PGM_VMS

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-CIC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-CIC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RBS.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-REC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-REC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DCP.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RCD.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.

      *>>>>
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *    MOVE SCR-NLIB TO FRM-NLIB.
      *    MOVE SCR-NMAP TO FRM-NAME.
           MOVE 'SGCFMS' TO FRM-NLIB.
           MOVE 'DBP' TO FRM-NAME.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       CMN-INI.
           MOVE SCR-INST-HCM TO SCR-INST.
           INITIALIZE DBP-DFLD.
           INITIALIZE DBP-DFLD-ATR.
           INITIALIZE DBP-DFLD-LEN.
           MOVE DBP-CFLD TO FRM-CFLD.
       FIN-INI.
           EXIT.

       SCR-COM SECTION.
       INI-SCR-COM.
      *     MOVE FRM-MSG TO FRM-CMND.
      *     MOVE DBP-GLS-MENS TO FRM-MENS.
      *     PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
      *     PERFORM SCR-CLRA-DBP.
           CALL 'GNSPPCMN'.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-MOD.
       TRL-SCR-MOD.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-MOD.
           PERFORM SCR-DMSG.

       SCR-ING SECTION.
       INI-SCR-ING.
           PERFORM SCR-RST.
           PERFORM HBL-IKY.
           PERFORM GET-IKY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ING.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS OR FIO-STAT = FIO-STAT-NEX
               MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGEXI    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ING
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ING.
           MOVE PGM-LIMPIAR-TODO TO PGM-ICLR.
       TRL-SCR-ING.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ING.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-ING.
           PERFORM SCR-DMSG.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ACC.
       TRL-SCR-ACC.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ACC.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
       FIN-SCR-ACC.
           PERFORM SCR-DMSG.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM SCR-KEY.
           IF SCR-STAT = SCR-STAT-ABT
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ELI.
       TRL-SCR-ELI.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-SCR-ELI.
           PERFORM SCR-DMSG.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM GET-KEY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-ACT.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               MOVE SCR-ACTU-MOD TO SCR-ACTU
               PERFORM PUT-SCR
           ELSE
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR
           IF FIO-STAT-EOF
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
           ELSE
           IF FIO-STAT = FIO-STAT-NEX
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT
           ELSE
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               MOVE SCR-ACTU-ING TO SCR-ACTU.
       TRL-SCR-ACT.
           PERFORM SCR-TRL.
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD.
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
           IF SCR-FFLD-BSP
               GO TO TRL-SCR-ACT.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           PERFORM SCR-DMSG.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           PERFORM SCR-RST.
           PERFORM HBL-KEY.
           PERFORM GET-KEY.

           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM DESSCRTRL
               GO TO FIN-SCR-PGM.

           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM
               ELSE
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
       FIN-SCR-PGM.
           PERFORM SCR-DMSG.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               PERFORM SCR-DSP-MSSG
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               DISPLAY PGM-NCUR WITH NO ADVANCING
               PERFORM SCR-CLRA-DBP
               PERFORM SCR-DSP-MSSG
               DISPLAY PGM-SCUR WITH NO ADVANCING
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-DBP
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
           ELSE
               PERFORM CLR-FLD-DBP
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               MOVE SPACES TO FRM-MENS
               PERFORM SCR-MSSG
               GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
       ERR-SCR-KEY.
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
        FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           INITIALIZE           DBP-DFLD.
           MOVE PGM-SRNF TO PGM-STAT-DBC.
           MOVE PGM-SRNF TO PGM-STAT-RCD.
           MOVE PGM-SRNF TO PGM-STAT-DCP.
           MOVE PGM-SRNF TO PGM-STAT-MNP.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
           PERFORM KEY-ALL-DBP.
      *<<<< FND_KEY
           IF DBC-NUM-ICLI IN DBP-FLD NOT > ZEROES
               PERFORM BUS-CLI-PER
               IF NOT FIO-STAT-OKS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-KEY-IDBC IN DBC TO DCP-KEY-IDCP IN DCP
                   MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD
                   MOVE 01                  TO RCD-NUM-DIRE IN RCD
                   GO TO CON-FND-KEY.
           MOVE DBC-NUM-ICLI IN DBP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DBP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DBP-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               IF NOT ( DBC-IND-TICL IN DBC = 'P' )
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CLI    EMP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-KEY-IDBC IN DBC TO DCP-KEY-IDCP IN DCP
                   MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD
                   MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           GO TO CON-FND-KEY.
      *>>>>
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
      *OJO
           MOVE DBC-KEY-IDBC IN DBC TO DCP-KEY-IDCP IN DCP.
           MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE '00' TO PGM-STAT-DBC.
      *    Se guarda en Common Area la fecha de la ultima modificacion
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           MOVE FIO-STAT TO PGM-STAT-DCP
           IF FIO-STAT-OKS
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               MOVE FIO-STAT TO PGM-STAT-RCD
               IF FIO-STAT-OKS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE
                   'ERROR : Existe cliente en DBC, DCP pero no en RCD'
                                                           TO FRM-MENS
           ELSE
               MOVE 'ERROR : Existe cliente en DBC pero no en DCP'
                    TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
       FIN-FND-KEY.
           EXIT.

       PUT-SCR SECTION.
       INI-PUT-SCR.
           PERFORM PUT-ALL-DBP.
       FIN-PUT-SCR.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-DBP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< CMN_MOD_RET
      *DAD ini  13-MAY-1992
           IF FRM-IND-VERS IN DBP-FLD = 'N'
               MOVE DBC-NUM-DCOR IN DBC TO DBC-NUM-DCOR IN DBP-FLD.
      *DAD fin  13-MAY-1992
      *>>>>
           PERFORM RET-ALL-DBP.
      *<<<< CMN_MOD
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA

      *    PERFORM KEY-DCP-DBP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *DAD ini  13-MAY-1992
           IF FRM-IND-VERS IN DBP-FLD = 'N'
               MOVE DCP-COD-CSEC IN DCP TO DCP-COD-CSEC IN DBP-FLD.
      *DAD fin  13-MAY-1992
           PERFORM RET-DCP-DBP.
      *    PERFORM KEY-RCD-DBP.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCP
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM RET-RCD-DBP.
           PERFORM RET-HDR-DBC.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           MOVE DBC-STP-ITRN IN DBC TO DCP-STP-ITRN IN DCP.
           PERFORM RET-HDR-DCP.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *AVM 11-JUN-1990 19:00 Hrs.
      *    PERFORM ACT-MNP.
      *    IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
      *        PERFORM BCK-OUT
      *        GO TO FIN-CMN-MOD.
      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           INITIALIZE DBC.
      *<<<< INI_CMN_ING
           MOVE SPACES TO DBC.
           MOVE ZEROES TO DBC-STP-ITRN IN DBC.
           MOVE ZEROES TO DBC-NUM-DCOR IN DBC.
           MOVE ZEROES TO DBC-FEC-FA85 IN DBC.
           MOVE ZEROES TO DBC-FEC-FUPI IN DBC.
           MOVE ZEROES TO DBC-FEC-FSCL IN DBC.
           MOVE ZEROES TO DBC-NUM-TDIR IN DBC.
           MOVE ZEROES TO DBC-NUM-TCMT IN DBC.
           MOVE ZEROES TO DBC-FEC-FIOP IN DBC.
           MOVE ZEROES TO DBC-FEC-FTOP IN DBC.
           MOVE ZEROES TO DBC-NUM-OFTN IN DBC.
           MOVE ZEROES TO DBC-FEC-FINP IN DBC.
           MOVE SPACES TO RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE ZEROES TO RCD-STP-ITRN IN RCD.
           MOVE ZEROES TO RCD-FEC-FVRF IN RCD.
           MOVE SPACES TO DCP.
           MOVE ZEROES TO DCP-STP-ITRN IN DCP.
           MOVE ZEROES TO DCP-FEC-FNAC IN DCP.
      *>>>>
           PERFORM RET-ALL-DBP.
      *<<<< CMN_ING
           PERFORM RET-HDR-DBC.
           MOVE 1      TO DBC-NUM-TDIR IN DBC.
           MOVE 'D'    TO RCD-MSC-TDIR IN RCD.
           MOVE 'C'    TO RCD-MSC-SDIR IN RCD.
           MOVE 'P'    TO DBC-IND-TICL IN DBC.
           MOVE ZEROES TO DBC-NUM-TCMT IN DBC.
      *GET-CIC Obtener CIC
           MOVE SPACES TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE CIC-CIC-ICIC TO DBC-CIC-ICLI IN DBC.
      *ALD
      *    MOVE DBC-IDC-ICLI IN DBC TO DBC-CIC-ICLI IN DBC.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
      *    PERFORM KEY-DCP-DBP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE DBC-STP-ITRN IN DBC TO DCP-STP-ITRN IN DCP.
           PERFORM RET-HDR-DCP.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE 01                  TO RCD-NUM-DIRE IN RCD.
      *    PERFORM KEY-RCD-DBP.
           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *ALD/21-JUL-1988
           MOVE DBC-NUM-ICLI IN DBC TO RBS-NUM-RUTS IN RBS.
           MOVE DBC-VRF-ICLI IN DBC TO RBS-VRF-RUTS IN RBS.
           MOVE 'RBS-GLS-ICLS' TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992

           MOVE DBC-STP-ITRN IN DBC TO RBS-STP-ITRN IN RBS.
           MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS.
           MOVE 'RBS-GLS-ICLS' TO FIO-AKEY.
           PERFORM RET-HDR-RBS.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992

      *DAD ini  13-MAY-1992
       EXT-CMN-ING.
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = 'CCL'
      *DAD fin  05-JUN-1992
           IF SCR-CMND = 'ICD'
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992

      *AVM 11-JUN-1990 19:00 Hrs.
      *    PERFORM ACT-MNP.
      *    IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
      *        PERFORM BCK-OUT
      *        GO TO FIN-CMN-ING.
      *
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'MIC'
               PERFORM KEY-DBC-DBP
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-CMND = 'PAE'
                   PERFORM CMB-PRS-EMP
                   GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM RET-ALL-DBP.
      *<<<< CMN_ACC
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE 'MODYES    ' TO MSG-COD-MENS
      *DAD ini 26-FEB-1991
               IF SCR-CMND = 'MNC'
                   MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM SGC-FIO-DCP
                   PERFORM RET-DCP-DBP
                   PERFORM RET-HDR-DCP
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-DCP
               ELSE
                   NEXT SENTENCE
      *DAD fin 26-FEB-1991
           ELSE
               MOVE 'MODNOT    ' TO MSG-COD-MENS.
           MOVE 'GNS' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-DBP.
      *<<<< CMN_ELI
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *    PERFORM KEY-DCP-DBP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *    PERFORM KEY-RCD-DBP.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCP
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-DBP.
       FIN-CMN-PGM.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE SPACES TO FRM-MENS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           DISPLAY PGM-NCUR WITH NO ADVANCING.
           MOVE DBP-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE DBP-GLS-MENS TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           DISPLAY PGM-SCUR WITH NO ADVANCING.
       FIN-SCR-PUTA.
           EXIT.

       SCR-DSP-MSSG SECTION.
       INI-SCR-DSP-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO DBP-GLS-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-DSP-MSSG.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO DBP-GLS-MENS.
      *    MOVE FRM-MSG TO FRM-CMND.
      *    PERFORM GNS-PRO-FRM.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE DBP-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GKEY.
           MOVE DBP-DFLD-ATR   TO FRM-VATR.
           MOVE DBP-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-DBP
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GKEY.
           MOVE FRM-DFLD TO DBP-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE DBP-DFLD-LEN.
           PERFORM VAL-NUM-KEY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-DBP
               GO TO ERR-SCR-GKEY.
      *JSS
           PERFORM VAL-IKY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-DBP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
       ERR-SCR-GKEY.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           GO TO LUP-SCR-GKEY.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE DBP-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GIKY.
           MOVE DBP-DFLD-ATR   TO FRM-VATR.
           MOVE DBP-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-DBP
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GIKY.
           MOVE FRM-DFLD TO DBP-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE DBP-DFLD-LEN.
           PERFORM VAL-NUM-IKY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-DBP
               GO TO ERR-SCR-GIKY.
      *JSS
           PERFORM VAL-IKY-DBP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
       ERR-SCR-GIKY.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           GO TO LUP-SCR-GIKY.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE DBP-NFLD       TO FRM-VNOM.
           MOVE 1 TO FRM-IFLD.
       LUP-SCR-GFLD.
           MOVE DBP-DFLD-ATR   TO FRM-VATR.
           MOVE DBP-DFLD-LEN   TO FRM-VLEN.
           MOVE FRM-GET-MAP      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-DBP
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO LUP-SCR-GFLD.
           MOVE FRM-DFLD TO DBP-DFLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           INITIALIZE DBP-DFLD-LEN.
           PERFORM VAL-NUM-KEY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-NUM-FLD-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-MKY-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-DBP.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-DBP.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           MOVE 1 TO FRM-IFLD.
           PERFORM FST-FLD-DBP.
       ERR-SCR-GFLD.
           PERFORM SCR-MSSG.
           PERFORM SCR-PUTA.
           GO TO LUP-SCR-GFLD.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
      *    MOVE FDV-WAIT TO FRM-CMND.
           MOVE 0 TO FRM-PLIN.
      *    MOVE FRM-MENS TO FRM-PRMT.
           MOVE DBP-GLS-MENS TO FRM-PRMT.
           MOVE FDV-GETDL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO DBP-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO DBP-GLS-MEN1
               MOVE DBP-GLS-MENS TO FRM-MENS
               GO TO INI-GET-ACC.
           MOVE FRM-VFLD TO SCR-VFLD.
           MOVE FRM-VFLD TO SCR-VFLD.
           IF FRM-FFLD = FRM-FFLD-RET
               IF SCR-VFLD = SCR-VFLD-NOT
                   MOVE FRM-FFLD-PF12 TO FRM-FFLD
               ELSE
                   PERFORM VAL-NUM-KEY-DBP
                   PERFORM VAL-NUM-FLD-DBP
           ELSE
               IF SCR-VFLD = SCR-VFLD-YES
                   MOVE FRM-FFLD-PF10 TO FRM-FFLD
                   PERFORM VAL-NUM-KEY-DBP
                   PERFORM VAL-NUM-FLD-DBP.
           DISPLAY '' LINE 24 COLUMN 1 WITH NO ADVANCING.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE FDV-WAIT TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO DBP-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO DBP-GLS-MEN1
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SPACES TO FRM-MENS
               GO TO INI-GET-CON.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO DBP-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           PERFORM PRO-FLD-DBP.
           PERFORM PRO-MKY-DBP.
           PERFORM PRO-AKY-DBP.
           PERFORM UNP-IKY-DBP.
           PERFORM FST-KEY-DBP.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           PERFORM PRO-FLD-DBP.
           PERFORM UNP-KEY-DBP.
           PERFORM FST-KEY-DBP.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-DBP.
           PERFORM PRO-AKY-DBP.
           PERFORM UNP-MKY-DBP.
           PERFORM UNP-FLD-DBP.
           PERFORM FST-FLD-DBP.
      *<<<< FIN_HBL_FLD
      *DAD ini  13-MAY-1992
           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DBCDCOR  DBP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = 'S' )
               MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBP-FLD
               MOVE ZEROES       TO DBC-NUM-DCOR     IN DBP-FLD
               MOVE 'N'          TO FRM-IND-VERS     IN DBP-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-DCOR IN DBP-FLD
               MOVE 'S'                 TO FRM-IND-VERS IN DBP-FLD
               IF  SCR-CCPP = 'ING' OR
                 ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING )
                   MOVE 01 TO DBC-NUM-DCOR IN DBP-FLD.

           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DCPCSEC  DBP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = 'S' )
               MOVE FRM-CPIM-AEY TO DCP-COD-CSEC-ATR IN DBP-FLD
               MOVE SPACES       TO DCP-COD-CSEC     IN DBP-FLD
                                    FRM-GLS-CSEC     IN DBP-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CATS IN DBP-FLD.

           IF SCR-CMND = 'ICD'
               PERFORM BUS-SCR-USER
               MOVE 'CA'                     TO DBC-COD-TICL IN DBP-FLD
               MOVE WSS-COD-OFIC IN WSS-VARI TO DBC-COD-OFIC IN DBP-FLD
               MOVE WSS-COD-EJEC IN WSS-VARI TO DBC-COD-EJEC IN DBP-FLD
               MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBP-FLD.

      *DAD ini  05-JUN-1992
           IF SCR-CMND = 'CCL'
               MOVE 'CL'         TO DBC-COD-TICL     IN DBP-FLD
               MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBP-FLD.
      *DAD fin  05-JUN-1992

      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = 'CCL'
      *DAD fin  05-JUN-1992
           IF SCR-CMND = 'ICD'
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992

      *ALD/9-NOV-1989
           IF SCR-CMND = 'MIC' OR 'MNC' OR 'INC' OR 
              DBC-IND-ICLI IN DBP-FLD = 'A'
               PERFORM PRO-KEY-DBP
               PERFORM PRO-FLD-DBP.
      *
           IF SCR-CMND = 'MIC'
               PERFORM UNP-IKY-DBP
               MOVE 0  TO DBC-GLS-APAT-LEN IN DBP-FLD
               MOVE -1 TO DBC-NUM-ICLI-LEN IN DBP-FLD.

           IF SCR-CMND = 'MNC'
               PERFORM UNP-MKY-DBP
      *DAD ini 26-FEB-1991
               MOVE FRM-CPIM-UBY TO DCP-NUM-NMSG-ATR
               MOVE FRM-CPIM-UBY TO MNP-GLS-NOMB-ATR
           ELSE
               MOVE FRM-CPIM-AEY TO DCP-NUM-NMSG-ATR
               MOVE FRM-CPIM-AEY TO MNP-GLS-NOMB-ATR.
      *DAD fin 26-FEB-1991

           IF SCR-CMND = 'INC' OR DBC-IND-ICLI IN DBP-FLD = 'A'
               PERFORM UNP-MKY-DBP
               MOVE FRM-CPIM-UBY TO RCD-GLS-DIRE-ATR IN DBP-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-OFIC-ATR IN DBP-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-TICL-ATR IN DBP-FLD
               IF DBC-COD-TICL IN DBP-FLD NOT > SPACES
                   MOVE 'NC'     TO DBC-COD-TICL     IN DBP-FLD.

           IF  SCR-CCPP = 'MOD' OR
             ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )
               PERFORM PRO-MKY-DBP
               MOVE 0  TO DBC-GLS-APAT-LEN IN DBP-FLD
               MOVE -1 TO RCD-GLS-DIRE-LEN IN DBP-FLD.
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO DBP-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-DBP.
           PERFORM PRO-FLD-DBP.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-GLS-PRMT( SCR-I ) TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-BSP
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL
               ELSE
                   MOVE FRM-MSG TO FRM-CMND
                   PERFORM GNS-PRO-FRM
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-BSP
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL
               ELSE
                   MOVE FRM-MSG TO FRM-CMND
                   PERFORM GNS-PRO-FRM
                   PERFORM SCR-EXIT
                   GO TO FIN-SCR-TRL.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           IF FRM-FFLD NOT = FRM-FFLD-BSP
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT
           ELSE
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF
                  IF SCR-INST = SCR-INST-GCF
                      GO TO INI-DESSCRTRL.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *<<<< INI_PRO_CONF
      *DAD ini  13-MAY-1992
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = 'CCL'
      *DAD fin  05-JUN-1992
           IF SCR-CMND = 'ICD'
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDCNF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992
      *>>>>
           IF FRM-MENS NOT > SPACES
               IF SCR-GLS-CONF( SCR-I ) NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MEN1.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-MSSG.
           PERFORM PRO-KEY-DBP.
           PERFORM PRO-FLD-DBP.
           PERFORM FST-MSG.
      *JSS PERFORM SCR-PUTA.
           DISPLAY PGM-NCUR WITH NO ADVANCING.
           MOVE DBP-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           DISPLAY PGM-SCUR WITH NO ADVANCING.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
      *    MOVE FDV-WAIT TO FRM-CMND.
           MOVE 0 TO FRM-PLIN.
           MOVE FRM-MENS  TO FRM-PRMT.
           MOVE FDV-GETDL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF4 OR
                               FRM-FFLD-BSP )
      *<<<< PFS_SCR_GCNF 
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO DBP-GLS-MEN2
               MOVE SCR-GLS-CONF( SCR-I ) TO DBP-GLS-MEN1
               MOVE DBP-GLS-MENS TO FRM-MENS
               GO TO INI-SCR-GCNF.
           MOVE FRM-VFLD TO SCR-VFLD.
           IF NOT ( SCR-VFLD = SCR-VFLD-YES OR SCR-VFLD-NOT OR SPACES )
               MOVE 'CNF    INV' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               STRING MSG-GLS-DCOR SCR-GLS-CONF( SCR-I )
                      DELIMITED BY SIZE INTO DBP-GLS-MENS
               MOVE DBP-GLS-MENS TO FRM-MENS
               GO TO INI-SCR-GCNF.
           IF FRM-FFLD = FRM-FFLD-RET
               IF SCR-VFLD = SCR-VFLD-NOT
                   MOVE FRM-FFLD-PF12 TO FRM-FFLD
               ELSE
                   MOVE SCR-VFLD-YES TO SCR-VFLD
                   PERFORM VAL-NUM-KEY-DBP
                   PERFORM VAL-NUM-FLD-DBP
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF4
               IF SCR-VFLD = SCR-VFLD-YES
                   MOVE FRM-FFLD-PF10 TO FRM-FFLD
                   PERFORM VAL-NUM-KEY-DBP
                   PERFORM VAL-NUM-FLD-DBP
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT NOT = SCR-STAT-MOD
                   MOVE FRM-FFLD-RET TO FRM-FFLD
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           MOVE SPACES TO FRM-MENS.
           DISPLAY '' LINE 24 COLUMN 1 WITH NO ADVANCING.
       FIN-SCR-GCNF.
           EXIT.

       COPY SGCBMDBP.
       COPY SGCBFDBC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.

      *<<<< EOF_PU OR (EOF AND PGM_VMS)
       RET-HDR-DCP SECTION.
       INI-RET-HDR-DCP.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCP-FEC-FTRN IN DCP.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCP-HRA-HRTR IN DCP.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCP-MSC-TACC IN DCP
               MOVE 'I' TO DCP-MSC-STAT IN DCP
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCP-MSC-TACC IN DCP
               MOVE 'M' TO DCP-MSC-STAT IN DCP.
       FIN-RET-HDR-DCP.
           EXIT.

       RET-HDR-RCD SECTION.
       INI-RET-HDR-RCD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RCD-FEC-FTRN IN RCD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RCD-HRA-HRTR IN RCD.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RCD-MSC-TACC IN RCD
               MOVE 'I' TO RCD-MSC-STAT IN RCD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RCD-MSC-TACC IN RCD
               MOVE 'M' TO RCD-MSC-STAT IN RCD.
       FIN-RET-HDR-RCD.
           EXIT.

       RET-HDR-DCE SECTION.
       INI-RET-HDR-DCE.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCE-FEC-FTRN IN DCE.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCE-HRA-HRTR IN DCE.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCE-MSC-TACC IN DCE
               MOVE 'I' TO DCE-MSC-STAT IN DCE
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCE-MSC-TACC IN DCE
               MOVE 'M' TO DCE-MSC-STAT IN DCE.
       FIN-RET-HDR-DCE.
           EXIT.

       RET-HDR-RBS SECTION.
       INI-RET-HDR-RBS.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RBS-FEC-FTRN IN RBS.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RBS-HRA-HRTR IN RBS.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RBS-MSC-TACC IN RBS
               MOVE 'I' TO RBS-MSC-STAT IN RBS
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RBS-MSC-TACC IN RBS
               MOVE 'M' TO RBS-MSC-STAT IN RBS.
       FIN-RET-HDR-RBS.
           EXIT.

       RET-HDR-DBC SECTION.
       INI-RET-HDR-DBC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DBC-FEC-FTRN IN DBC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DBC-HRA-HRTR IN DBC.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DBC-MSC-TACC IN DBC
               MOVE 'I' TO DBC-MSC-STAT IN DBC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DBC-MSC-TACC IN DBC
               MOVE 'M' TO DBC-MSC-STAT IN DBC.
       FIN-RET-HDR-DBC.
           EXIT.


       CMB-PRS-EMP SECTION.
       INI-CMB-PRS-EMP.
           PERFORM KEY-DBC-DBP.
      * ISP : LEE POR RUT Y ACTUALIZA POR CIC ==> ERROR VSAM
      *       EL CIC ESTA EN LA PANTALLA
      *     MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'    TO MSG-COD-SIST
               MOVE 'REGNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMB-PRS-EMP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMB-PRS-EMP.
           PERFORM LLN-REG-DBP.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE DBC-STP-ITRN IN DBC TO DCE-STP-ITRN IN DCE.
           PERFORM RET-HDR-DCE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-PRS-EMP.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-PRS-EMP.
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'           TO MSG-COD-SIST
               MOVE 'UPD    ERRDBC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-CMB-PRS-EMP.
           EXIT.
      *>>>>
      *<<<< EOF
      *DAD ini  13-MAY-1992
       BUS-SCR-USER SECTION.
       INI-BUS-SCR-USER.
       FIN-BUS-SCR-USER.
           EXIT.
      *DAD fin  13-MAY-1992

       LLN-REG-DBP SECTION.
       INI-LLN-REG-DBP.
           MOVE SPACES TO DCE.
           MOVE ZEROES TO DCE-STP-ITRN IN DCE.
           MOVE ZEROES TO DCE-FEC-FCTT IN DCE.
           MOVE ZEROES TO DCE-FEC-FUME IN DCE.
           MOVE ZEROES TO DCE-FEC-FCAD IN DCE. 
           MOVE 'E'    TO DBC-IND-TICL IN DBC.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO DBC-NUM-DTRN IN DBC.
           MOVE HOY-MHOY IN HOY-VARI TO DBC-NUM-MTRN IN DBC.
           MOVE HOY-AHOY IN HOY-VARI TO DBC-NUM-ATRN IN DBC.
           MOVE HOY-SHOY IN HOY-VARI TO DBC-NUM-STRN IN DBC.
           MOVE HOY-HHOY IN HOY-VARI TO DBC-HRA-HRTR IN DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-LLN-REG-DBP.
           EXIT.

       BUS-CLI-PER SECTION.
       INI-BUS-CLI-PER.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-CLI-PER.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL IN DBC NOT = 'P'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-CLI-PER.
       FIN-BUS-CLI-PER.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

      *AVM 11-JUN-1990 19:00 Hrs.
       OBT-GLS-NOMB SECTION.
       INI-OBT-GLS-NOMB.
           MOVE ZEROES TO WSS-IND-NOM1 , WSS-IND-NOM2.
           MOVE SPACES TO WSS-GLS-NOM2.
       LOO-OBT-GLS-NOMB.
           ADD 1 TO WSS-IND-NOM1.
           IF WSS-IND-NOM1 > 25 OR
                  WSS-VEC-NOM1(WSS-IND-NOM1) NOT > SPACES
               GO TO FIN-OBT-GLS-NOMB.
           ADD 1 TO WSS-IND-NOM2.
           MOVE WSS-VEC-NOM1(WSS-IND-NOM1) TO
                WSS-VEC-NOM2(WSS-IND-NOM2).
           GO TO LOO-OBT-GLS-NOMB.
       FIN-OBT-GLS-NOMB.
           EXIT.
      *>>>>
      *<<<< EOF

      *ALD/21-JUL-1988
       COPY SGCBFRBS.
      *
       COPY SGCBFREC.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY SGCBFRCD.
       COPY TABBVUSR.
      *
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBGCPT.
       COPY GNSBGPPU.
       COPY GNSBEGLS.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY SGCBGDOM.
      *>>>>
