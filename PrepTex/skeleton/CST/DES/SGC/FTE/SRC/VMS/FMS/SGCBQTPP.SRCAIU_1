      *
      * SGCBQTPP
      * Version 3.0.1 Nov-2005
      * 03-Oct-19 10:38 AM
      *
       SET-TAG-SGCBQTPP SECTION.
       INI-SET-TAG-SGCBQTPP.
           MOVE
           '<IDNMOD NOM=$SGCBQTPP$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$03-Oct-19 10:38 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBQTPP.
           EXIT.
           
       PUT-ALL-TPP SECTION.
       INI-PUT-ALL-TPP.
           PERFORM PUT-TPP-TPP.
       FIN-PUT-ALL-TPP.
           EXIT.
       
       PUT-TPP-TPP SECTION.
       INI-PUT-TPP-TPP.
           IF PGM-STAT-TPP-NUL
               GO TO FIN-PUT-TPP-TPP.
           IF NOT PGM-STAT-TPP-OKS
               PERFORM CLR-TPP-TPP
               GO TO FIN-PUT-TPP-TPP.
           MOVE TPP-COD-TDOC IN TPP TO TPP-COD-TDOC IN TPP-FLD.
           MOVE TPP-COD-TCLI IN TPP TO TPP-COD-TCLI IN TPP-FLD.
           MOVE TPP-IND-CRPR IN TPP TO TPP-IND-CRPR IN TPP-FLD.
           MOVE TPP-IND-CAEX IN TPP TO TPP-IND-CAEX IN TPP-FLD.
           MOVE TPP-IND-CDPX IN TPP TO TPP-IND-CDPX IN TPP-FLD.
           MOVE TPP-IND-CEFE IN TPP TO TPP-IND-CEFE IN TPP-FLD.
           MOVE TPP-IND-CDEX IN TPP TO TPP-IND-CDEX IN TPP-FLD.
           MOVE TPP-IND-CATC IN TPP TO TPP-IND-CATC IN TPP-FLD.
           MOVE TPP-IND-CPAE IN TPP TO TPP-IND-CPAE IN TPP-FLD.
           MOVE TPP-IND-CDAE IN TPP TO TPP-IND-CDAE IN TPP-FLD.
           MOVE TPP-IND-CDAC IN TPP TO TPP-IND-CDAC IN TPP-FLD.
           MOVE TPP-IND-CRGC IN TPP TO TPP-IND-CRGC IN TPP-FLD.
           MOVE TPP-IND-CDAP IN TPP TO TPP-IND-CDAP IN TPP-FLD.
           MOVE TPP-IND-CDPR IN TPP TO TPP-IND-CDPR IN TPP-FLD.
           MOVE TPP-IND-CBRZ IN TPP TO TPP-IND-CBRZ IN TPP-FLD.
           MOVE TPP-IND-CDAX IN TPP TO TPP-IND-CDAX IN TPP-FLD.
           MOVE TPP-IND-CDBN IN TPP TO TPP-IND-CDBN IN TPP-FLD.
           MOVE TPP-IND-CVEH IN TPP TO TPP-IND-CVEH IN TPP-FLD.
           MOVE TPP-IND-CVSC IN TPP TO TPP-IND-CVSC IN TPP-FLD.
           MOVE TPP-IND-CVOE IN TPP TO TPP-IND-CVOE IN TPP-FLD.
           MOVE TPP-IND-DIR1 IN TPP TO TPP-IND-DIR1 IN TPP-FLD.
           MOVE TPP-IND-OTBN IN TPP TO TPP-IND-OTBN IN TPP-FLD.
           MOVE TPP-IND-DIR2 IN TPP TO TPP-IND-DIR2 IN TPP-FLD.
           MOVE TPP-IND-REX1 IN TPP TO TPP-IND-REX1 IN TPP-FLD.
           MOVE TPP-IND-DIR3 IN TPP TO TPP-IND-DIR3 IN TPP-FLD.
           MOVE TPP-IND-REX2 IN TPP TO TPP-IND-REX2 IN TPP-FLD.
           MOVE TPP-IND-DIR4 IN TPP TO TPP-IND-DIR4 IN TPP-FLD.
           MOVE TPP-IND-REX3 IN TPP TO TPP-IND-REX3 IN TPP-FLD.
           MOVE TPP-IND-DIR5 IN TPP TO TPP-IND-DIR5 IN TPP-FLD.
           MOVE TPP-IND-REX4 IN TPP TO TPP-IND-REX4 IN TPP-FLD.
           MOVE TPP-COD-EEFR IN TPP TO TPP-COD-EEFR IN TPP-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE TPP-NUM-DEFR IN TPP TO TPP-NUM-DEFR IN TPP-FLD.
           MOVE TPP-NUM-MEFR IN TPP TO TPP-NUM-MEFR IN TPP-FLD.
           MOVE TPP-NUM-SEFR IN TPP TO TPP-NUM-SEFR IN TPP-FLD.
           MOVE TPP-NUM-AEFR IN TPP TO TPP-NUM-AEFR IN TPP-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
       FIN-PUT-TPP-TPP.
           EXIT.
       
       KEY-ALL-TPP SECTION.
       INI-KEY-ALL-TPP.
           PERFORM KEY-TPP-TPP.
       FIN-KEY-ALL-TPP.
           EXIT.
       
       KEY-TPP-TPP SECTION.
       INI-KEY-TPP-TPP.
           MOVE TPP-COD-TDOC IN TPP-FLD TO TPP-COD-TDOC IN TPP.
           MOVE TPP-COD-TCLI IN TPP-FLD TO TPP-COD-TCLI IN TPP.
       FIN-KEY-TPP-TPP.
           EXIT.
       
       SCR-CLRA-TPP SECTION.
       INI-SCR-CLRA-TPP.
           PERFORM CLR-KEY-TPP.
           PERFORM CLR-FLD-TPP.
       FIN-SCR-CLRA-TPP.
           EXIT.
       
       CLR-KEY-TPP SECTION.
       INI-CLR-KEY-TPP.
           MOVE SPACES TO TPP-COD-TDOC IN TPP-FLD.
           MOVE SPACES TO TPP-COD-TCLI IN TPP-FLD.
       FIN-CLR-KEY-TPP.
           EXIT.
       
       CLR-FLD-TPP SECTION.
       INI-CLR-FLD-TPP.
           PERFORM CLR-TPP-TPP.
       FIN-CLR-FLD-TPP.
           EXIT.
       
       CLR-TPP-TPP SECTION.
       INI-CLR-TPP-TPP.
           MOVE SPACES TO TPP-IND-CRPR IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CAEX IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDPX IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CEFE IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDEX IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CATC IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CPAE IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDAE IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDAC IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CRGC IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDAP IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDPR IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CBRZ IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDAX IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CDBN IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CVEH IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CVSC IN TPP-FLD.
           MOVE SPACES TO TPP-IND-CVOE IN TPP-FLD.
           MOVE SPACES TO TPP-IND-DIR1 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-OTBN IN TPP-FLD.
           MOVE SPACES TO TPP-IND-DIR2 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-REX1 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-DIR3 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-REX2 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-DIR4 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-REX3 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-DIR5 IN TPP-FLD.
           MOVE SPACES TO TPP-IND-REX4 IN TPP-FLD.
           MOVE SPACES TO TPP-COD-EEFR IN TPP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO TPP-FEC-FEFR IN TPP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      *<<<< FIN_CLR_TPP_TPP
           IF SCR-CMND = 'ING'
              PERFORM GET-FHOY
              MOVE HOY-SHOY TO WSS-FEC-SCUR IN WSS-VARI
              MOVE HOY-AHOY TO WSS-FEC-ACUR IN WSS-VARI
              MOVE HOY-MHOY TO WSS-FEC-MCUR IN WSS-VARI
              MOVE HOY-DHOY TO WSS-FEC-DCUR IN WSS-VARI
              MOVE WSS-FEC-CURR IN WSS-VARI
                               TO TPP-FEC-FEFR IN TPP-FLD
              MOVE SCR-USER    TO TPP-COD-EEFR IN TPP-FLD.

           IF (SCR-CMND = 'MOD' OR  SCR-CMND = 'ELI' OR
               SCR-CMND = 'CON') AND
                            (TPP-FEC-FEFR IN TPP-FLD = ZEROS)
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO WSS-FEC-SCUR IN WSS-VARI
               MOVE HOY-AHOY TO WSS-FEC-ACUR IN WSS-VARI
               MOVE HOY-MHOY TO WSS-FEC-MCUR IN WSS-VARI
               MOVE HOY-DHOY TO WSS-FEC-DCUR IN WSS-VARI
               MOVE WSS-FEC-CURR IN WSS-VARI
                             TO TPP-FEC-FEFR IN TPP-FLD
               IF TPP-COD-EEFR IN TPP-FLD = SPACES
                   MOVE SCR-USER TO TPP-COD-EEFR IN TPP-FLD
               ELSE
                   NEXT SENTENCE
            ELSE
            IF (SCR-CMND = 'MOD' OR  SCR-CMND = 'ELI' OR
               SCR-CMND = 'CON') AND
                          (TPP-COD-EEFR IN TPP-FLD = SPACES)
               MOVE SCR-USER TO TPP-COD-EEFR IN TPP-FLD.
      *>>>>
       FIN-CLR-TPP-TPP.
           EXIT.
       
       FST-KEY-TPP SECTION.
       INI-FST-KEY-TPP.
           MOVE -1 TO TPP-COD-TDOC-LEN IN TPP-FLD.
       FIN-FST-KEY-TPP.
           EXIT.
       
       FST-FLD-TPP SECTION.
       INI-FST-FLD-TPP.
           MOVE -1 TO TPP-IND-CAEX-LEN IN TPP-FLD.
       FIN-FST-FLD-TPP.
           EXIT.
       
       PRO-KEY-TPP SECTION.
       INI-PRO-KEY-TPP.
           PERFORM PRO-IKY-TPP.
           PERFORM PRO-AKY-TPP.
           PERFORM PRO-MKY-TPP.
       FIN-PRO-KEY-TPP.
           EXIT.
       
       PRO-IKY-TPP SECTION.
       INI-PRO-IKY-TPP.
           MOVE FRM-CPIM-AEY TO TPP-COD-TDOC-ATR IN TPP-FLD.
           MOVE FRM-CPIM-AEY TO TPP-COD-TCLI-ATR IN TPP-FLD.
       FIN-PRO-IKY-TPP.
           EXIT.
       
       PRO-MKY-TPP SECTION.
       INI-PRO-MKY-TPP.
       FIN-PRO-MKY-TPP.
           EXIT.
       
       PRO-AKY-TPP SECTION.
       INI-PRO-AKY-TPP.
       FIN-PRO-AKY-TPP.
           EXIT.
       
       UNP-KEY-TPP SECTION.
       INI-UNP-KEY-TPP.
           PERFORM UNP-IKY-TPP.
           PERFORM UNP-AKY-TPP.
           PERFORM UNP-MKY-TPP.
       FIN-UNP-KEY-TPP.
           EXIT.
       
       UNP-IKY-TPP SECTION.
       INI-UNP-IKY-TPP.
           MOVE FRM-CPIM-UBY TO TPP-COD-TDOC-ATR.
           MOVE FRM-CPIM-UBY TO TPP-COD-TCLI-ATR.
       FIN-UNP-IKY-TPP.
           EXIT.
       
       UNP-MKY-TPP SECTION.
       INI-UNP-MKY-TPP.
       FIN-UNP-MKY-TPP.
           EXIT.
       
       UNP-AKY-TPP SECTION.
       INI-UNP-AKY-TPP.
       FIN-UNP-AKY-TPP.
           EXIT.
       
       UNP-FLD-TPP SECTION.
       INI-UNP-FLD-TPP.
           PERFORM UNP-TPP-TPP.
       FIN-UNP-FLD-TPP.
           EXIT.
       
       UNP-TPP-TPP SECTION.
       INI-UNP-TPP-TPP.
           MOVE FRM-CPIM-UBY TO TPP-IND-CAEX-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CEFE-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CATC-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CPAE-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CDAE-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CDAC-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CRGC-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CDAP-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CBRZ-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CDBN-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CVEH-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CVSC-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-CVOE-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-DIR1-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-OTBN-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-DIR2-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-REX1-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-DIR3-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-REX2-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-DIR4-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-REX3-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-DIR5-ATR IN TPP-FLD.
           MOVE FRM-CPIM-UBY TO TPP-IND-REX4-ATR IN TPP-FLD.
       FIN-UNP-TPP-TPP.
           EXIT.
       
       VAL-KEY-TPP SECTION.
       INI-VAL-KEY-TPP.
           PERFORM VAL-IKY-TPP.
           PERFORM VAL-MKY-TPP.
           PERFORM VAL-AKY-TPP.
       FIN-VAL-KEY-TPP.
           EXIT.
       
       VAL-IKY-TPP SECTION.
       INI-VAL-IKY-TPP.
           PERFORM VAL-TPP-COD-TDOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TPP-COD-TDOC-LEN IN TPP-FLD
                GO TO FIN-VAL-IKY-TPP.
           PERFORM VAL-TPP-COD-TCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO TPP-COD-TCLI-LEN IN TPP-FLD
                GO TO FIN-VAL-IKY-TPP.
       FIN-VAL-IKY-TPP.
           EXIT.
       
       VAL-MKY-TPP SECTION.
       INI-VAL-MKY-TPP.
       FIN-VAL-MKY-TPP.
           EXIT.
       
       VAL-AKY-TPP SECTION.
       INI-VAL-AKY-TPP.
       FIN-VAL-AKY-TPP.
           EXIT.
       
       VAL-TPP-COD-TDOC SECTION.
       INI-VAL-TPP-COD-TDOC.
           IF TPP-COD-TDOC IN TPP-FLD NOT > SPACES
              MOVE SPACES TO TPP-COD-TDOC IN TPP-FLD.
      *<<<< INI-VAL-TPP-COD-TDOC
      *VAL-COD VALIDA CODIGO DE TABLA
           MOVE TPP-COD-TDOC IN TPP-FLD TO WSS-DOC-TCL.
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'TFO' TO TAB-COD-TTAB IN TAB.
           MOVE TPP-COD-TDOC IN TPP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> VAL-TPP-COD-TDOC
       FIN-VAL-TPP-COD-TDOC.
           EXIT.
       
       VAL-TPP-COD-TCLI SECTION.
       INI-VAL-TPP-COD-TCLI.
           IF TPP-COD-TCLI IN TPP-FLD NOT > SPACES
              MOVE SPACES TO TPP-COD-TCLI IN TPP-FLD.
      *<<<< INI-VAL-TPP-COD-TCLI
      *VAL-IND VALIDA MISCELANEO DE TABLA
           MOVE 'SGC' TO MSC-COD-SIST.
           MOVE 'TICL' TO MSC-COD-TMSC IN MSC.
           MOVE TPP-COD-TCLI IN TPP-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-TPP-COD-TCLI.
           IF WSS-DTCL = 'J' AND TPP-COD-TCLI IN TPP-FLD NOT = 'E'
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FRMNVALTCL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TPP-COD-TCLI.
           IF WSS-DTCL = 'N' AND TPP-COD-TCLI IN TPP-FLD NOT = 'P'
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FRMNVALTCL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TPP-COD-TCLI.
      *>>>> VAL-TPP-COD-TCLI
       FIN-VAL-TPP-COD-TCLI.
           EXIT.
       
       VAL-CON-KEY-TPP SECTION.
       INI-VAL-CON-KEY-TPP.
           IF     TPP-COD-TDOC IN TPP-FLD NOT > SPACES 
              AND TPP-COD-TCLI IN TPP-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-TPP.
       FIN-VAL-CON-KEY-TPP.
           EXIT.
       
       VAL-CON-IKY-TPP SECTION.
       INI-VAL-CON-IKY-TPP.
           IF     TPP-COD-TDOC IN TPP-FLD NOT > SPACES 
              AND TPP-COD-TCLI IN TPP-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-TPP.
       FIN-VAL-CON-IKY-TPP.
           EXIT.
       
       VAL-NUM-KEY-TPP SECTION.
       INI-VAL-NUM-KEY-TPP.
           PERFORM VAL-NUM-IKY-TPP.
           PERFORM VAL-NUM-MKY-TPP.
           PERFORM VAL-NUM-AKY-TPP.
       FIN-VAL-NUM-KEY-TPP.
           EXIT.
       
       VAL-NUM-IKY-TPP SECTION.
       INI-VAL-NUM-IKY-TPP.
       FIN-VAL-NUM-IKY-TPP.
           EXIT.
       
       VAL-NUM-MKY-TPP SECTION.
       INI-VAL-NUM-MKY-TPP.
       FIN-VAL-NUM-MKY-TPP.
           EXIT.
       
       VAL-NUM-AKY-TPP SECTION.
       INI-VAL-NUM-AKY-TPP.
       FIN-VAL-NUM-AKY-TPP.
           EXIT.
       
       VAL-NUM-FLD-TPP SECTION.
       INI-VAL-NUM-FLD-TPP.
       FIN-VAL-NUM-FLD-TPP.
           EXIT.
       
       EDT-KEY-TPP SECTION.
       INI-EDT-KEY-TPP.
           PERFORM EDT-IKY-TPP.
           PERFORM EDT-MKY-TPP.
           PERFORM EDT-AKY-TPP.
       FIN-EDT-KEY-TPP.
           EXIT.
       
       EDT-IKY-TPP SECTION.
       INI-EDT-IKY-TPP.
       FIN-EDT-IKY-TPP.
           EXIT.
       
       EDT-MKY-TPP SECTION.
       INI-EDT-MKY-TPP.
       FIN-EDT-MKY-TPP.
           EXIT.
       
       EDT-AKY-TPP SECTION.
       INI-EDT-AKY-TPP.
       FIN-EDT-AKY-TPP.
           EXIT.
       
       EDT-FLD-TPP SECTION.
       INI-EDT-FLD-TPP.
       FIN-EDT-FLD-TPP.
           EXIT.
      *<<<< EOF
      *>>>> EOF
