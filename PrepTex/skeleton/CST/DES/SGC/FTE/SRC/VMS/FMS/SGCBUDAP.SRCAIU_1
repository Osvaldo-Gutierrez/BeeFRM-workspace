      *
      * SGCBUDAP
      * Version 3.0.1 Nov-2005
      * 02-Oct-19 08:15 AM
      *
      *<<<< SETTAG
      ***************************************************************
      *MANTENCION: CAMBIO FECHA HABIL
      *RESPONSABLE: AFRI
      *FECHA: NOV-2011.
      *ETIQUETA: *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
      *CAMBIOS: SE DEJA SIN VALIDACION DE DIA HABIL CAMPO
      *         FECHA DE FALLECIMIENTO
      **************************************************************
      *>>>>
       SET-TAG-SGCBUDAP SECTION.
       INI-SET-TAG-SGCBUDAP.
           MOVE
           '<IDNMOD NOM=$SGCBUDAP$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$02-Oct-19 08:15 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBUDAP.
           EXIT.
           
       RET-ALL-DAP SECTION.
       INI-RET-ALL-DAP.
           PERFORM KEY-ALL-DAP.
           PERFORM RET-DBC-DAP.
           PERFORM RET-DAP-DAP.
       FIN-RET-ALL-DAP.
           EXIT.
       
       RET-DBC-DAP SECTION.
       INI-RET-DBC-DAP.
       FIN-RET-DBC-DAP.
           EXIT.
       
       RET-DAP-DAP SECTION.
       INI-RET-DAP-DAP.
           IF SCR-CCPP = 'MOD'
              MOVE DAP-COD-EEFR IN DAP TO DAP-COD-EEFR IN DAP-FLD
              MOVE DAP-NUM-DEFR IN DAP TO DAP-NUM-DEFR IN DAP-FLD
              MOVE DAP-NUM-MEFR IN DAP TO DAP-NUM-MEFR IN DAP-FLD
              MOVE DAP-NUM-SEFR IN DAP TO DAP-NUM-SEFR IN DAP-FLD
              MOVE DAP-NUM-AEFR IN DAP TO DAP-NUM-AEFR IN DAP-FLD.

           MOVE DAP-IND-PEXP IN DAP-FLD TO DAP-IND-PEXP IN DAP.
           MOVE DAP-IND-FAEX IN DAP-FLD TO DAP-IND-FAEX IN DAP.
           MOVE DAP-NRO-MDAC IN DAP-FLD TO DAP-NRO-MDAC IN DAP.
           MOVE DAP-NRO-MDAN IN DAP-FLD TO DAP-NRO-MDAN IN DAP.
           MOVE DAP-VAL-MIRF IN DAP-FLD TO DAP-VAL-MIRF IN DAP.
           MOVE DAP-VAL-MEED IN DAP-FLD TO DAP-VAL-MEED IN DAP.
           MOVE DAP-VAL-MIRV IN DAP-FLD TO DAP-VAL-MIRV IN DAP.
           MOVE DAP-VAL-MEDC IN DAP-FLD TO DAP-VAL-MEDC IN DAP.
           MOVE DAP-VAL-MAFM IN DAP-FLD TO DAP-VAL-MAFM IN DAP.
           MOVE DAP-VAL-MEDB IN DAP-FLD TO DAP-VAL-MEDB IN DAP.
           MOVE DAP-VAL-MIAL IN DAP-FLD TO DAP-VAL-MIAL IN DAP.
           MOVE DAP-VAL-MEDL IN DAP-FLD TO DAP-VAL-MEDL IN DAP.
           MOVE DAP-VAL-ORCL IN DAP-FLD TO DAP-VAL-ORCL IN DAP.
           MOVE DAP-VAL-MEDA IN DAP-FLD TO DAP-VAL-MEDA IN DAP.
           MOVE DAP-GLS-DORC IN DAP-FLD TO DAP-GLS-DORC IN DAP.
           MOVE DAP-VAL-INVM IN DAP-FLD TO DAP-VAL-INVM IN DAP.
           MOVE DAP-IND-TM2M IN DAP-FLD TO DAP-IND-TM2M IN DAP.
           MOVE DAP-IND-T2A3 IN DAP-FLD TO DAP-IND-T2A3 IN DAP.
           MOVE DAP-IND-T3A5 IN DAP-FLD TO DAP-IND-T3A5 IN DAP.
           MOVE DAP-IND-TM5M IN DAP-FLD TO DAP-IND-TM5M IN DAP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DAP-NUM-DFAL IN DAP-FLD TO DAP-NUM-DFAL IN DAP.
           MOVE DAP-NUM-MFAL IN DAP-FLD TO DAP-NUM-MFAL IN DAP.
           MOVE DAP-NUM-SFAL IN DAP-FLD TO DAP-NUM-SFAL IN DAP.
           MOVE DAP-NUM-AFAL IN DAP-FLD TO DAP-NUM-AFAL IN DAP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DAP-COD-EEFR IN DAP-FLD TO DAP-COD-EEFR IN DAP.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DAP-NUM-DEFR IN DAP-FLD TO DAP-NUM-DEFR IN DAP.
           MOVE DAP-NUM-MEFR IN DAP-FLD TO DAP-NUM-MEFR IN DAP.
           MOVE DAP-NUM-SEFR IN DAP-FLD TO DAP-NUM-SEFR IN DAP.
           MOVE DAP-NUM-AEFR IN DAP-FLD TO DAP-NUM-AEFR IN DAP.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-DAP-DAP.
           EXIT.
       
       KEY-ALL-DAP SECTION.
       INI-KEY-ALL-DAP.
           PERFORM KEY-DBC-DAP.
           PERFORM KEY-DAP-DAP.
       FIN-KEY-ALL-DAP.
           EXIT.
       
       KEY-DBC-DAP SECTION.
       INI-KEY-DBC-DAP.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN DAP-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN DAP-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DAP-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DAP-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-DAP.
           EXIT.
       
       KEY-DAP-DAP SECTION.
       INI-KEY-DAP-DAP.
           MOVE DAP-CAI-IFOL IN DAP-FLD TO DAP-CAI-IFOL IN DAP.
           MOVE DAP-IIC-IFOL IN DAP-FLD TO DAP-IIC-IFOL IN DAP.
       FIN-KEY-DAP-DAP.
           EXIT.
       
       SCR-CLRA-DAP SECTION.
       INI-SCR-CLRA-DAP.
           PERFORM CLR-KEY-DAP.
           PERFORM CLR-FLD-DAP.
       FIN-SCR-CLRA-DAP.
           EXIT.
       
       CLR-KEY-DAP SECTION.
       INI-CLR-KEY-DAP.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN DAP-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN DAP-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN DAP-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN DAP-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DAP-CAI-IFOL IN DAP-FLD.
           MOVE ZEROES TO DAP-IIC-IFOL IN DAP-FLD.
       FIN-CLR-KEY-DAP.
           EXIT.
       
       CLR-FLD-DAP SECTION.
       INI-CLR-FLD-DAP.
           MOVE SPACES TO FRM-GLS-NOMC IN DAP-FLD.
           PERFORM CLR-DBC-DAP.
           PERFORM CLR-DAP-DAP.
       FIN-CLR-FLD-DAP.
           EXIT.
       
       CLR-DBC-DAP SECTION.
       INI-CLR-DBC-DAP.
       FIN-CLR-DBC-DAP.
           EXIT.
       
       CLR-DAP-DAP SECTION.
       INI-CLR-DAP-DAP.
           MOVE SPACES TO DAP-IND-PEXP IN DAP-FLD.
           MOVE SPACES TO DAP-IND-FAEX IN DAP-FLD.
           MOVE ZEROES TO DAP-NRO-MDAC IN DAP-FLD.
           MOVE ZEROES TO DAP-NRO-MDAN IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MIRF IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MEED IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MIRV IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MEDC IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MAFM IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MEDB IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MIAL IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MEDL IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-ORCL IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-MEDA IN DAP-FLD.
           MOVE SPACES TO DAP-GLS-DORC IN DAP-FLD.
           MOVE ZEROES TO DAP-VAL-INVM IN DAP-FLD.
           MOVE SPACES TO DAP-IND-TM2M IN DAP-FLD.
           MOVE SPACES TO DAP-IND-T2A3 IN DAP-FLD.
           MOVE SPACES TO DAP-IND-T3A5 IN DAP-FLD.
           MOVE SPACES TO DAP-IND-TM5M IN DAP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DAP-FEC-FFAL IN DAP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DAP-COD-EEFR IN DAP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DAP-FEC-FEFR IN DAP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DAP-DAP.
           EXIT.
       
       FST-KEY-DAP SECTION.
       INI-FST-KEY-DAP.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN DAP-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-DAP.
           EXIT.
       
       FST-FLD-DAP SECTION.
       INI-FST-FLD-DAP.
           MOVE -1 TO DAP-IND-PEXP-LEN IN DAP-FLD.
       FIN-FST-FLD-DAP.
           EXIT.
       
       PRO-KEY-DAP SECTION.
       INI-PRO-KEY-DAP.
           PERFORM PRO-MKY-DAP.
       FIN-PRO-KEY-DAP.
           EXIT.
       
       PRO-MKY-DAP SECTION.
       INI-PRO-MKY-DAP.
       FIN-PRO-MKY-DAP.
           EXIT.
       
       PRO-FLD-DAP SECTION.
       INI-PRO-FLD-DAP.
           PERFORM PRO-DBC-DAP.
           PERFORM PRO-DAP-DAP.
       FIN-PRO-FLD-DAP.
           EXIT.
       
       PRO-DBC-DAP SECTION.
       INI-PRO-DBC-DAP.
       FIN-PRO-DBC-DAP.
           EXIT.
       
       PRO-DAP-DAP SECTION.
       INI-PRO-DAP-DAP.
           MOVE FRM-CPIM-AEY TO DAP-IND-PEXP-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-IND-FAEX-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-NRO-MDAC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-NRO-MDAN-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MIRF-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MEED-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MIRV-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MEDC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MAFM-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MEDB-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MIAL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MEDL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-ORCL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-MEDA-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-GLS-DORC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-VAL-INVM-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-IND-TM2M-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-IND-T2A3-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-IND-T3A5-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-IND-TM5M-ATR IN DAP-FLD.
           MOVE FRM-CPIM-AEY TO DAP-FEC-FFAL-ATR IN DAP-FLD.
       FIN-PRO-DAP-DAP.
           EXIT.
       
       UNP-KEY-DAP SECTION.
       INI-UNP-KEY-DAP.
           PERFORM UNP-IKY-DAP.
           PERFORM UNP-AKY-DAP.
           PERFORM UNP-MKY-DAP.
       FIN-UNP-KEY-DAP.
           EXIT.
       
       UNP-IKY-DAP SECTION.
       INI-UNP-IKY-DAP.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN DAP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DAP-CAI-IFOL-ATR.
           MOVE FRM-CPIM-UBY TO DAP-IIC-IFOL-ATR.
       FIN-UNP-IKY-DAP.
           EXIT.
       
       UNP-MKY-DAP SECTION.
       INI-UNP-MKY-DAP.
       FIN-UNP-MKY-DAP.
           EXIT.
       
       UNP-AKY-DAP SECTION.
       INI-UNP-AKY-DAP.
       FIN-UNP-AKY-DAP.
           EXIT.
       
       UNP-FLD-DAP SECTION.
       INI-UNP-FLD-DAP.
           PERFORM UNP-DBC-DAP.
           PERFORM UNP-DAP-DAP.
       FIN-UNP-FLD-DAP.
           EXIT.
       
       UNP-DBC-DAP SECTION.
       INI-UNP-DBC-DAP.
       FIN-UNP-DBC-DAP.
           EXIT.
       
       UNP-DAP-DAP SECTION.
       INI-UNP-DAP-DAP.
           MOVE FRM-CPIM-UBY TO DAP-IND-PEXP-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-IND-FAEX-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-NRO-MDAC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-NRO-MDAN-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MIRF-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MEED-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MIRV-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MEDC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MAFM-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MEDB-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MIAL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MEDL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-ORCL-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-MEDA-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-GLS-DORC-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-VAL-INVM-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-IND-TM2M-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-IND-T2A3-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-IND-T3A5-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-IND-TM5M-ATR IN DAP-FLD.
           MOVE FRM-CPIM-UBY TO DAP-FEC-FFAL-ATR IN DAP-FLD.
      *<<<< FIN_UNP_DAP_DAP
           MOVE FRM-CPIM-AEY TO DAP-IND-FAEX-ATR IN DAP-FLD.
      *>>>>
       FIN-UNP-DAP-DAP.
           EXIT.
       
       VAL-MKY-DAP SECTION.
       INI-VAL-MKY-DAP.
       FIN-VAL-MKY-DAP.
           EXIT.
       
       VAL-FLD-DAP SECTION.
       INI-VAL-FLD-DAP.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-PEXP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-PEXP-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-FAEX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-FAEX-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-NRO-MDAC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-NRO-MDAC-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-NRO-MDAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-NRO-MDAN-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MIRF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MIRF-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MEED.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MEED-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MIRV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MIRV-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MEDC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDC-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MAFM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MAFM-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MEDB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDB-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MIAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MIAL-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MEDL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDL-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-ORCL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-ORCL-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-MEDA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDA-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-GLS-DORC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-GLS-DORC-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-VAL-INVM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-VAL-INVM-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-TM2M.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-TM2M-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-T2A3.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-T2A3-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-T3A5.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-T3A5-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
           PERFORM VAL-DAP-IND-TM5M.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-IND-TM5M-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DAP-FEC-FFAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DAP-FEC-FFAL-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DAP-COD-EEFR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DAP-COD-EEFR-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DAP-FEC-FEFR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DAP-FEC-FEFR-LEN IN DAP-FLD
                GO TO FIN-VAL-FLD-DAP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-FLD-DAP.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-DAP-IND-PEXP SECTION.
       INI-VAL-DAP-IND-PEXP.
           IF DAP-IND-PEXP IN DAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DAP-IND-PEXP.
      *<<<< DAP_IND_PEXP
           MOVE 'SGC'                   TO TAB-COD-SIST.               
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.        
           MOVE DAP-IND-PEXP IN DAP-FLD TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-COD.                                     
      *>>>> 
       FIN-VAL-DAP-IND-PEXP.
           EXIT.
       
       VAL-DAP-IND-FAEX SECTION.
       INI-VAL-DAP-IND-FAEX.
           IF DAP-IND-FAEX IN DAP-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DAP-IND-FAEX.
      *<<<< DAP_IND_FAEX
           MOVE 'SGC'                   TO TAB-COD-SIST.               
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.        
           MOVE DAP-IND-FAEX IN DAP-FLD TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-COD.                                            
      *>>>> 
       FIN-VAL-DAP-IND-FAEX.
           EXIT.
       
       VAL-DAP-NRO-MDAC SECTION.
       INI-VAL-DAP-NRO-MDAC.
           IF DAP-NRO-MDAC IN DAP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DAP-NRO-MDAC.
       FIN-VAL-DAP-NRO-MDAC.
           EXIT.
       
       VAL-DAP-NRO-MDAN SECTION.
       INI-VAL-DAP-NRO-MDAN.
       FIN-VAL-DAP-NRO-MDAN.
           EXIT.
       
       VAL-DAP-VAL-MIRF SECTION.
       INI-VAL-DAP-VAL-MIRF.
           IF DAP-VAL-MIRF IN DAP-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DAP-VAL-MIRF.
       FIN-VAL-DAP-VAL-MIRF.
           EXIT.
       
       VAL-DAP-VAL-MEED SECTION.
       INI-VAL-DAP-VAL-MEED.
       FIN-VAL-DAP-VAL-MEED.
           EXIT.
       
       VAL-DAP-VAL-MIRV SECTION.
       INI-VAL-DAP-VAL-MIRV.
       FIN-VAL-DAP-VAL-MIRV.
           EXIT.
       
       VAL-DAP-VAL-MEDC SECTION.
       INI-VAL-DAP-VAL-MEDC.
       FIN-VAL-DAP-VAL-MEDC.
           EXIT.
       
       VAL-DAP-VAL-MAFM SECTION.
       INI-VAL-DAP-VAL-MAFM.
       FIN-VAL-DAP-VAL-MAFM.
           EXIT.
       
       VAL-DAP-VAL-MEDB SECTION.
       INI-VAL-DAP-VAL-MEDB.
       FIN-VAL-DAP-VAL-MEDB.
           EXIT.
       
       VAL-DAP-VAL-MIAL SECTION.
       INI-VAL-DAP-VAL-MIAL.
       FIN-VAL-DAP-VAL-MIAL.
           EXIT.
       
       VAL-DAP-VAL-MEDL SECTION.
       INI-VAL-DAP-VAL-MEDL.
       FIN-VAL-DAP-VAL-MEDL.
           EXIT.
       
       VAL-DAP-VAL-ORCL SECTION.
       INI-VAL-DAP-VAL-ORCL.
       FIN-VAL-DAP-VAL-ORCL.
           EXIT.
       
       VAL-DAP-VAL-MEDA SECTION.
       INI-VAL-DAP-VAL-MEDA.
       FIN-VAL-DAP-VAL-MEDA.
           EXIT.
       
       VAL-DAP-GLS-DORC SECTION.
       INI-VAL-DAP-GLS-DORC.
           IF DAP-GLS-DORC IN DAP-FLD NOT > SPACES
              MOVE SPACES TO DAP-GLS-DORC IN DAP-FLD.
       FIN-VAL-DAP-GLS-DORC.
           EXIT.
       
       VAL-DAP-VAL-INVM SECTION.
       INI-VAL-DAP-VAL-INVM.
       FIN-VAL-DAP-VAL-INVM.
           EXIT.
       
       VAL-DAP-IND-TM2M SECTION.
       INI-VAL-DAP-IND-TM2M.
           IF DAP-IND-TM2M IN DAP-FLD NOT > SPACES
              MOVE SPACES TO DAP-IND-TM2M IN DAP-FLD.
      *<<<< DAP_IND_TM2M
           IF DAP-IND-TM2M IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-TM2M.                             
           IF DAP-IND-TM2M IN DAP-FLD > SPACES AND                     
              (DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM2M.                             
           IF DAP-IND-TM2M IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM2M.                             
      *>>>> 
       FIN-VAL-DAP-IND-TM2M.
           EXIT.
       
       VAL-DAP-IND-T2A3 SECTION.
       INI-VAL-DAP-IND-T2A3.
           IF DAP-IND-T2A3 IN DAP-FLD NOT > SPACES
              MOVE SPACES TO DAP-IND-T2A3 IN DAP-FLD.
      *<<<< DAP_IND_T2A3
           IF DAP-IND-T2A3 IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-T2A3.                             
           IF DAP-IND-T2A3 IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T2A3.                             
           IF DAP-IND-T2A3 IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T2A3.                             
      *>>>> 
       FIN-VAL-DAP-IND-T2A3.
           EXIT.
       
       VAL-DAP-IND-T3A5 SECTION.
       INI-VAL-DAP-IND-T3A5.
           IF DAP-IND-T3A5 IN DAP-FLD NOT > SPACES
              MOVE SPACES TO DAP-IND-T3A5 IN DAP-FLD.
      *<<<< DAP_IND_T3A5
           IF DAP-IND-T3A5 IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-T3A5.                             
           IF DAP-IND-T3A5 IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T3A5.                             
           IF DAP-IND-T3A5 IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T3A5.                             
      *>>>> 
       FIN-VAL-DAP-IND-T3A5.
           EXIT.
       
       VAL-DAP-IND-TM5M SECTION.
       INI-VAL-DAP-IND-TM5M.
           IF DAP-IND-TM5M IN DAP-FLD NOT > SPACES
              MOVE SPACES TO DAP-IND-TM5M IN DAP-FLD.
      *<<<< DAP_IND_TM5M
           IF DAP-IND-TM5M IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-TM5M.                             
           IF DAP-IND-TM5M IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM5M.                             
           IF DAP-IND-TM5M IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM5M.                             
      *>>>> 
       FIN-VAL-DAP-IND-TM5M.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-DAP-FEC-FFAL SECTION.
       INI-VAL-DAP-FEC-FFAL.
           IF DAP-FEC-FFAL IN DAP-FLD  NOT > ZEROES
              MOVE ZEROES TO DAP-FEC-FFAL IN DAP-FLD.
      *VAL-FEC Validar Fecha
           MOVE DAP-FEC-FFAL IN DAP-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_DAP_FEC_FFAL 
      *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL      
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO DAP-FEC-FFAL IN DAP-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-DAP-FEC-FFAL.
       FIN-VAL-DAP-FEC-FFAL.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DAP-COD-EEFR SECTION.
       INI-VAL-DAP-COD-EEFR.
       FIN-VAL-DAP-COD-EEFR.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-DAP-FEC-FEFR SECTION.
       INI-VAL-DAP-FEC-FEFR.
           IF DAP-FEC-FEFR IN DAP-FLD  NOT > ZEROES
              MOVE ZEROES TO DAP-FEC-FEFR IN DAP-FLD.
       FIN-VAL-DAP-FEC-FEFR.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-FLD-DAP SECTION.
       INI-VAL-CON-FLD-DAP.
       FIN-VAL-CON-FLD-DAP.
           EXIT.
       
       VAL-CON-DAP SECTION.
       INI-VAL-CON-DAP.
       FIN-VAL-CON-DAP.
           EXIT.
       
       VAL-NUM-KEY-DAP SECTION.
       INI-VAL-NUM-KEY-DAP.
           PERFORM VAL-NUM-IKY-DAP.
           PERFORM VAL-NUM-MKY-DAP.
           PERFORM VAL-NUM-AKY-DAP.
       FIN-VAL-NUM-KEY-DAP.
           EXIT.
       
       VAL-NUM-IKY-DAP SECTION.
       INI-VAL-NUM-IKY-DAP.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-IKY-DAP.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DAP-IIC-IFOL.
           MOVE DAP-IIC-IFOL-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DAP-IIC-IFOL IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-IIC-IFOL-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-IKY-DAP.
       FIN-VAL-NUM-IKY-DAP.
           EXIT.
       
       VAL-NUM-MKY-DAP SECTION.
       INI-VAL-NUM-MKY-DAP.
       FIN-VAL-NUM-MKY-DAP.
           EXIT.
       
       VAL-NUM-AKY-DAP SECTION.
       INI-VAL-NUM-AKY-DAP.
       FIN-VAL-NUM-AKY-DAP.
           EXIT.
       
       VAL-NUM-FLD-DAP SECTION.
       INI-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-NRO-MDAC.
           MOVE DAP-NRO-MDAC-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DAP-NRO-MDAC IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-NRO-MDAC-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-NRO-MDAN.
           MOVE DAP-NRO-MDAN-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DAP-NRO-MDAN IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-NRO-MDAN-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MIRF.
           MOVE DAP-VAL-MIRF-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MIRF IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MIRF-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MEED.
           MOVE DAP-VAL-MEED-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MEED IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MEED-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MIRV.
           MOVE DAP-VAL-MIRV-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MIRV IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MIRV-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MEDC.
           MOVE DAP-VAL-MEDC-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MEDC IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MEDC-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MAFM.
           MOVE DAP-VAL-MAFM-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MAFM IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MAFM-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MEDB.
           MOVE DAP-VAL-MEDB-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MEDB IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MEDB-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MIAL.
           MOVE DAP-VAL-MIAL-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MIAL IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MIAL-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MEDL.
           MOVE DAP-VAL-MEDL-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MEDL IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MEDL-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-ORCL.
           MOVE DAP-VAL-ORCL-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-ORCL IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-ORCL-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-MEDA.
           MOVE DAP-VAL-MEDA-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-MEDA IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-MEDA-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       VAL-NUM-DAP-VAL-INVM.
           MOVE DAP-VAL-INVM-ALF IN DAP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO DAP-VAL-INVM IN DAP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DAP-VAL-INVM-LEN IN DAP-FLD
                GO TO FIN-VAL-NUM-FLD-DAP.
       FIN-VAL-NUM-FLD-DAP.
           EXIT.
       
       EDT-KEY-DAP SECTION.
       INI-EDT-KEY-DAP.
           PERFORM EDT-IKY-DAP.
           PERFORM EDT-MKY-DAP.
           PERFORM EDT-AKY-DAP.
       FIN-EDT-KEY-DAP.
           EXIT.
       
       EDT-IKY-DAP SECTION.
       INI-EDT-IKY-DAP.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN DAP-FLD
                GO TO FIN-EDT-IKY-DAP.
           MOVE DBC-NUM-ICLI IN DAP-FLD TO
                DBC-NUM-ICLI-EDT IN DAP-EDT.
           MOVE DBC-NUM-ICLI-EDT IN DAP-EDT TO
                DBC-NUM-ICLI-ALF IN DAP-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DAP-IIC-IFOL-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-IIC-IFOL-LEN IN DAP-FLD
                GO TO FIN-EDT-IKY-DAP.
           MOVE DAP-IIC-IFOL IN DAP-FLD TO DAP-IIC-IFOL-EDT IN DAP-EDT.
           MOVE DAP-IIC-IFOL-EDT IN DAP-EDT TO 
                DAP-IIC-IFOL-ALF IN DAP-FLD.
       FIN-EDT-IKY-DAP.
           EXIT.
       
       EDT-MKY-DAP SECTION.
       INI-EDT-MKY-DAP.
       FIN-EDT-MKY-DAP.
           EXIT.
       
       EDT-AKY-DAP SECTION.
       INI-EDT-AKY-DAP.
       FIN-EDT-AKY-DAP.
           EXIT.
       
       EDT-FLD-DAP SECTION.
       INI-EDT-FLD-DAP.
           IF DAP-NRO-MDAC-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-NRO-MDAC-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-NRO-MDAC IN DAP-FLD TO DAP-NRO-MDAC-EDT IN DAP-EDT.
           MOVE DAP-NRO-MDAC-EDT IN DAP-EDT TO 
                DAP-NRO-MDAC-ALF IN DAP-FLD.
           IF DAP-NRO-MDAN-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-NRO-MDAN-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-NRO-MDAN IN DAP-FLD TO DAP-NRO-MDAN-EDT IN DAP-EDT.
           MOVE DAP-NRO-MDAN-EDT IN DAP-EDT TO 
                DAP-NRO-MDAN-ALF IN DAP-FLD.
           IF DAP-VAL-MIRF-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MIRF-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MIRF IN DAP-FLD TO DAP-VAL-MIRF-EDT IN DAP-EDT.
           MOVE DAP-VAL-MIRF-EDT IN DAP-EDT TO 
                DAP-VAL-MIRF-ALF IN DAP-FLD.
           IF DAP-VAL-MEED-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MEED-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MEED IN DAP-FLD TO DAP-VAL-MEED-EDT IN DAP-EDT.
           MOVE DAP-VAL-MEED-EDT IN DAP-EDT TO 
                DAP-VAL-MEED-ALF IN DAP-FLD.
           IF DAP-VAL-MIRV-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MIRV-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MIRV IN DAP-FLD TO DAP-VAL-MIRV-EDT IN DAP-EDT.
           MOVE DAP-VAL-MIRV-EDT IN DAP-EDT TO 
                DAP-VAL-MIRV-ALF IN DAP-FLD.
           IF DAP-VAL-MEDC-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDC-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MEDC IN DAP-FLD TO DAP-VAL-MEDC-EDT IN DAP-EDT.
           MOVE DAP-VAL-MEDC-EDT IN DAP-EDT TO 
                DAP-VAL-MEDC-ALF IN DAP-FLD.
           IF DAP-VAL-MAFM-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MAFM-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MAFM IN DAP-FLD TO DAP-VAL-MAFM-EDT IN DAP-EDT.
           MOVE DAP-VAL-MAFM-EDT IN DAP-EDT TO 
                DAP-VAL-MAFM-ALF IN DAP-FLD.
           IF DAP-VAL-MEDB-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDB-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MEDB IN DAP-FLD TO DAP-VAL-MEDB-EDT IN DAP-EDT.
           MOVE DAP-VAL-MEDB-EDT IN DAP-EDT TO 
                DAP-VAL-MEDB-ALF IN DAP-FLD.
           IF DAP-VAL-MIAL-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MIAL-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MIAL IN DAP-FLD TO DAP-VAL-MIAL-EDT IN DAP-EDT.
           MOVE DAP-VAL-MIAL-EDT IN DAP-EDT TO 
                DAP-VAL-MIAL-ALF IN DAP-FLD.
           IF DAP-VAL-MEDL-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDL-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MEDL IN DAP-FLD TO DAP-VAL-MEDL-EDT IN DAP-EDT.
           MOVE DAP-VAL-MEDL-EDT IN DAP-EDT TO 
                DAP-VAL-MEDL-ALF IN DAP-FLD.
           IF DAP-VAL-ORCL-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-ORCL-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-ORCL IN DAP-FLD TO DAP-VAL-ORCL-EDT IN DAP-EDT.
           MOVE DAP-VAL-ORCL-EDT IN DAP-EDT TO 
                DAP-VAL-ORCL-ALF IN DAP-FLD.
           IF DAP-VAL-MEDA-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-MEDA-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-MEDA IN DAP-FLD TO DAP-VAL-MEDA-EDT IN DAP-EDT.
           MOVE DAP-VAL-MEDA-EDT IN DAP-EDT TO 
                DAP-VAL-MEDA-ALF IN DAP-FLD.
           IF DAP-VAL-INVM-LEN IN DAP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DAP-VAL-INVM-LEN IN DAP-FLD
                GO TO FIN-EDT-FLD-DAP.
           MOVE DAP-VAL-INVM IN DAP-FLD TO DAP-VAL-INVM-EDT IN DAP-EDT.
           MOVE DAP-VAL-INVM-EDT IN DAP-EDT TO 
                DAP-VAL-INVM-ALF IN DAP-FLD.
       FIN-EDT-FLD-DAP.
           EXIT.
      *<<<< EOF
      *>>>>
