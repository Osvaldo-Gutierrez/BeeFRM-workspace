       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.    SGCPPVEC.
       AUTHOR.        CONSIST.
       DATE-WRITTEN.  11-ABR-1994     

      *  Verifica si un cliente esta relacionado con otras
      *  entidades antes de eliminarlo.

       ENVIRONMENT DIVISION.
      *=====================
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
       COPY GNSWCSCR.
       COPY GNSWVSCR.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWVIDD.
       COPY GNSWGFRM.
       COPY GNSWGSYS.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.

       COPY SGCBRRCD.
       COPY SGCBRREC.
       COPY SGCBRAEP.
       COPY SGCBREFE.
       COPY SGCBRRCO.
       COPY GNSBRRCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      
       COPY GARBRGDD.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDD-REQA==.

       COPY DEUBRCRI.
       COPY DEUBRDBD.
       COPY DEUBRFIA.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
        
       COPY LDCBRRDC REPLACING RDC BY RDL.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.

       COPY COLBRRDC.
       COPY COLBREST.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EST-REQA==.

       COPY SGCWGVEC.

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           03 FILLER                          PIC X(677).

       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPPVEC'  TO FIO-PROG.
           MOVE DFHCOMMAREA TO VEC-CMMA.
           MOVE VEC-MSFL    TO FIO-MSFL.
           MOVE 'SGC'       TO SCR-SIST.
           MOVE VEC-VIDD    TO IDD-FSIS.
           MOVE SPACES      TO VEC-CMSG VEC-MEN2.
           PERFORM REV-SIS-SGC.
           IF VEC-CMSG > SPACES 
              GO TO FIN-MAIN.
           PERFORM REV-SIS-GAR.
           IF VEC-CMSG > SPACES 
              GO TO FIN-MAIN.
           PERFORM REV-SIS-DEU.
           IF VEC-CMSG > SPACES 
              GO TO FIN-MAIN.
           PERFORM REV-SIS-LDC.
           IF VEC-CMSG > SPACES 
              GO TO FIN-MAIN.
           PERFORM REV-SIS-COL.
           IF VEC-CMSG > SPACES 
              GO TO FIN-MAIN.
       FIN-MAIN.

           MOVE FIO-MSFL TO VEC-MSFL.
           MOVE VEC-CMMA TO DFHCOMMAREA.
           MOVE    +0    TO EIBRESP. 
           EXEC CICS RETURN END-EXEC.

      * Seccion para revisar sistema SGC *
       REV-SIS-SGC SECTION.
       INI-REV-SIS-SGC.
      * Revisa si existe datos en entidad RCD *
           MOVE  SPACES     TO RCD-KEY-IRCD.
           MOVE  VEC-ICLI   TO RCD-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF FIO-STAT-OKS AND
               RCD-CIC-ICLI = VEC-ICLI
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF FIO-STAT-OKS AND
                  RCD-CIC-ICLI = VEC-ICLI
                  MOVE 'VEC SGC RCD' TO VEC-CMSG
                  MOVE   SPACES      TO VEC-MEN2
                  GO TO FIN-REV-SIS-SGC. 
       
      * Revisa si existe datos en entidad REC *
           MOVE  SPACES     TO REC-KEY-IREC.
           MOVE  VEC-ICLI   TO REC-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
               REC-CIC-ICLI = VEC-ICLI
               MOVE 'VEC SGC REC' TO VEC-CMSG
               MOVE REC-COD-TREC IN REC TO VEC-MEN2
               GO TO FIN-REV-SIS-SGC.
             
      * Revisa si existe datos en entidad AEP *
           MOVE  SPACES     TO AEP-KEY-IAEP.
           MOVE  VEC-ICLI   TO AEP-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF FIO-STAT-OKS AND
               AEP-CIC-ICLI = VEC-ICLI
               MOVE 'VEC SGC AEP' TO VEC-CMSG
               MOVE AEP-FEC-FAEP  TO VEC-MEN2
               GO TO FIN-REV-SIS-SGC.
 
      * Revisa si existe datos en entidad EFE *
           MOVE  SPACES     TO EFE-KEY-IEFE.
           MOVE  VEC-ICLI   TO EFE-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF FIO-STAT-OKS AND
               EFE-CIC-ICLI = VEC-ICLI
               MOVE 'VEC SGC EFE' TO VEC-CMSG
               MOVE EFE-FEC-FEFE  TO VEC-MEN2
               GO TO FIN-REV-SIS-SGC.
 
      * Revisa si existe datos en entidad RCO *
           MOVE  SPACES     TO RCO-KEY-IRCO.
           MOVE  VEC-ICLI   TO RCO-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS AND
               RCO-CIC-ICLI = VEC-ICLI
               MOVE 'VEC SGC RCO' TO VEC-CMSG
               MOVE RCO-CIC-IOPE  TO VEC-MEN2
               GO TO FIN-REV-SIS-SGC.
 
      * Revisa si existe datos en entidad RCE *
           MOVE  SPACES     TO RCE-KEY-IREG.
           MOVE  VEC-ICLI   TO RCE-CIC-IENT.
           MOVE 'RCE-KEY-IENT' TO FIO-AKEY
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-RCE.
           IF FIO-STAT-OKS AND
               RCE-CIC-IENT = VEC-ICLI
               MOVE 'VEC SGC RCE' TO VEC-CMSG
               MOVE    SPACES     TO VEC-MEN2
               GO TO FIN-REV-SIS-SGC. 
       FIN-REV-SIS-SGC.
           EXIT.

      * Seccion para revisar sistema GAR *
       REV-SIS-GAR SECTION.
       INI-REV-SIS-GAR.
      * Revisa si existe datos en entidad GDD *
           MOVE  SPACES     TO GAR-CLV-GDD-1.
           MOVE  VEC-ICLI   TO GDD-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS AND
               GDD-CIC-ICLI = VEC-ICLI
               MOVE 'VEC GAR GDD'  TO VEC-CMSG
               MOVE GAR-CLV-GDD-2  TO VEC-MEN2
               GO TO FIN-REV-SIS-GAR. 
       FIN-REV-SIS-GAR.
           EXIT.

      * Seccion para revisar sistema DEU *
       REV-SIS-DEU SECTION.
       INI-REV-SIS-DEU.
      * Revisa si existe datos en entidad CRI *
           MOVE  SPACES     TO CRI-KEY-ICRI.
           MOVE  VEC-ICLI   TO CRI-CIC-ICLI.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-CRI.
           IF FIO-STAT-OKS AND
               CRI-CIC-ICLI = VEC-ICLI
               MOVE 'VEC DEU CRI' TO VEC-CMSG
               MOVE CRI-FEC-FCLA  TO VEC-MEN2
               GO TO FIN-REV-SIS-DEU. 
       
      * Revisa si existe datos en entidad DBD *
           MOVE  SPACES     TO DBD-KEY-IDBD.
           MOVE  VEC-ICLI   TO DBD-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-DBD.
           IF FIO-STAT-OKS AND
               DBD-CIC-ICLI = VEC-ICLI
               MOVE 'VEC DEU DBD' TO VEC-CMSG
               MOVE    SPACES     TO VEC-MEN2
               GO TO FIN-REV-SIS-DEU.
 
      * Revisa si existe datos en entidad FIA *
           MOVE  SPACES     TO FIA-GLS-ICYF.
           MOVE  VEC-ICLI   TO FIA-CIC-ICLI.
           MOVE 'FIA-GLS-ICYF' TO FIO-AKEY
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
               FIA-CIC-ICLI = VEC-ICLI
               MOVE 'VEC DEU FIAD' TO VEC-CMSG
               MOVE  FIA-KEY-IFIA  TO VEC-MEN2
               GO TO FIN-REV-SIS-DEU.

           MOVE     VEC-ICLI   TO FIA-CIC-ICFS.
           MOVE   FIO-GET-KEY  TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
               FIA-CIC-ICLI = VEC-ICLI
               MOVE 'VEC DEU FIAF' TO VEC-CMSG
               MOVE  FIA-KEY-IFIA  TO VEC-MEN2
               GO TO FIN-REV-SIS-DEU.
       FIN-REV-SIS-DEU.
           EXIT.

      * Seccion para revisar sistema LDC *
       REV-SIS-LDC SECTION.
       INI-REV-SIS-LDC.
      * Revisa si existe datos en entidad RDC *
           MOVE  SPACES     TO RDC-KEY-IREG IN RDL.
           MOVE  VEC-ICLI   TO RDC-CIC-ICLI IN RDL.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
               RDC-CIC-ICLI IN RDL = VEC-ICLI
               MOVE 'VEC LDC RDC' TO VEC-CMSG
               MOVE RDC-KEY-ICLF IN RDL  TO VEC-MEN2
               GO TO FIN-REV-SIS-LDC. 
       FIN-REV-SIS-LDC.
           EXIT.

      * Seccion para revisar sistema COL *
       REV-SIS-COL SECTION.
       INI-REV-SIS-COL.
      * Revisa si existe datos en entidad RDC *
           MOVE  SPACES     TO RDC-KEY-IRDC IN RDC.
           MOVE  VEC-ICLI   TO RDC-CIC-ICLI IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
               RDC-CIC-ICLI IN RDC = VEC-ICLI
               MOVE 'VEC COL RDC' TO VEC-CMSG
               MOVE RDC-CIC-IOPC IN RDC TO VEC-MEN2
               GO TO FIN-REV-SIS-COL. 

      * Revisa si existe datos en entidad EST *
           MOVE  SPACES     TO EST-KEY-IREG.
           MOVE  VEC-ICLI   TO EST-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-EST.
           IF FIO-STAT-OKS AND
               EST-CIC-ICLI = VEC-ICLI
               MOVE 'VEC COL EST' TO VEC-CMSG
               MOVE     SPACES    TO VEC-MEN2
               GO TO FIN-REV-SIS-COL. 
       FIN-REV-SIS-COL.
           EXIT.

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBGMSG.
       COPY GNSBGDTC.
       COPY GNSBIABT.
       COPY GNSBGFRM.
       COPY GNSBGSYS.

       COPY SGCBFRCD.
       COPY SGCBFREC.
       COPY SGCBFAEP.
       COPY SGCBFEFE.
       COPY SGCBFRCO.
       COPY GNSBFRCE.
       COPY GARBFGDD.
       COPY DEUBFCRI.
       COPY DEUBFDBD.
       COPY DEUBFFIA.
       COPY LDCBFRDC REPLACING RDC BY RDL
            ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
      *
       COPY COLBFRDC.
       COPY COLBFEST.
