       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. SGCPBEDP.
       AUTHOR.     CONSIST.
      * REFORMATEA REGISTRO EDP
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *=============
       WORKING-STORAGE SECTION.
      *------------------------

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EDP-REQA==.
       COPY SGCBREDP.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGHOY.
      *
       01  WSS-VARI.
           03  WSS-VEC-PODE
               05  WSS-ELM-PODE      OCCURS 100           PIC X(01).
           03  WSS-REG-LEE         PIC 9(07) VALUE 00.
           03  WSS-REG-ERR         PIC 9(07) VALUE 00.
           03  WSS-REG-GRA         PIC 9(07) VALUE 00.


       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPBEDP'     TO FIO-PROG
           PERFORM GNS-BUS-IDD.

           MOVE FIO-UPD        TO FIO-CMND.
           PERFORM SGC-FIO-EDP.

           MOVE FIO-GET-FST    TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF NOT FIO-STAT-OKS
              DISPLAY ' NO EXISTEN REGISTROS EN EDP'
              PERFORM GNS-PRO-ABT.

       CIC-MOD-PODE.
           ADD  1  TO WSS-REG-LEE IN WSS-VARI.
           MOVE FIO-GET-KEY-UPD   TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           MOVE EDP-VEC-PODE      TO WSS-VEC-PODE  IN WSS-VARI.
           MOVE SPACES            TO EDP-VEC-PODE  IN EDP.
                                                                       
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (01) TO 
                EDP-IND-PODE IN EDP (1) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (03) TO
                EDP-IND-PODE IN EDP (2) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (36) TO
                EDP-IND-PODE IN EDP (3) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (15) TO
                EDP-IND-PODE IN EDP (4) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (05) TO
                EDP-IND-PODE IN EDP (5) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (02) TO
                EDP-IND-PODE IN EDP (6) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (40) TO
                EDP-IND-PODE IN EDP (7) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (19) TO
                EDP-IND-PODE IN EDP (8) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (13) TO 
                EDP-IND-PODE IN EDP (9) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (06) TO
                EDP-IND-PODE IN EDP (10) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (44) TO
                EDP-IND-PODE IN EDP (11) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (23) TO
                EDP-IND-PODE IN EDP (12) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (17) TO
                EDP-IND-PODE IN EDP (13) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (10) TO
                EDP-IND-PODE IN EDP (14) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (48) TO
                EDP-IND-PODE IN EDP (15) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (50) TO 
                EDP-IND-PODE IN EDP (16) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (21) TO
                EDP-IND-PODE IN EDP (17) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (22) TO
                EDP-IND-PODE IN EDP (18) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (52) TO
                EDP-IND-PODE IN EDP (19) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (54) TO
                EDP-IND-PODE IN EDP (20) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (25) TO
                EDP-IND-PODE IN EDP (21) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (26) TO
                EDP-IND-PODE IN EDP (22) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (56) TO
                EDP-IND-PODE IN EDP (23) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (29) TO
                EDP-IND-PODE IN EDP (24) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (55) TO
                EDP-IND-PODE IN EDP (27) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (27) TO
                EDP-IND-PODE IN EDP (31) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (30) TO
                EDP-IND-PODE IN EDP (32) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (07) TO
                EDP-IND-PODE IN EDP (33) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (04) TO
                EDP-IND-PODE IN EDP (34) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (31) TO
                EDP-IND-PODE IN EDP (35) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (33) TO
                EDP-IND-PODE IN EDP (36) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (24) TO
                EDP-IND-PODE IN EDP (38) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (34) TO
                EDP-IND-PODE IN EDP (39) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (37) TO
                EDP-IND-PODE IN EDP (40) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (28) TO
                EDP-IND-PODE IN EDP (42) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (38) TO
                EDP-IND-PODE IN EDP (43) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (41) TO
                EDP-IND-PODE IN EDP (44) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (32) TO
                EDP-IND-PODE IN EDP (46) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (42) TO
                EDP-IND-PODE IN EDP (47) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (45) TO 
                EDP-IND-PODE IN EDP (48) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (47) TO 
                EDP-IND-PODE IN EDP (50) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (46) TO 
                EDP-IND-PODE IN EDP (51) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (49) TO 
                EDP-IND-PODE IN EDP (52) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (11) TO 
                EDP-IND-PODE IN EDP (53) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (53) TO 
                EDP-IND-PODE IN EDP (54)

           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (08) TO 
                EDP-IND-PODE IN EDP (55) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (09) TO 
                EDP-IND-PODE IN EDP (56) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (12) TO 
                EDP-IND-PODE IN EDP (57) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (14) TO 
                EDP-IND-PODE IN EDP (58) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (16) TO 
                EDP-IND-PODE IN EDP (59) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (18) TO 
                EDP-IND-PODE IN EDP (60) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (20) TO 
                EDP-IND-PODE IN EDP (61) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (35) TO 
                EDP-IND-PODE IN EDP (62) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (39) TO 
                EDP-IND-PODE IN EDP (63)
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (43) TO 
                EDP-IND-PODE IN EDP (64) 
           MOVE WSS-ELM-PODE IN WSS-VEC-PODE (51) TO 
                EDP-IND-PODE IN EDP (65).

           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO EDP-NUM-DTRN IN EDP.
           MOVE HOY-MHOY IN HOY-VARI TO EDP-NUM-MTRN IN EDP.
           MOVE HOY-AHOY IN HOY-VARI TO EDP-NUM-ATRN IN EDP.
           MOVE HOY-SHOY IN HOY-VARI TO EDP-NUM-STRN IN EDP.
           MOVE HOY-HHOY IN HOY-VARI TO EDP-HRA-HRTR IN EDP.

           MOVE FIO-MOD  TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF NOT FIO-STAT-OKS
              ADD 1 TO WSS-REG-ERR IN WSS-VARI
           ELSE
              ADD 1 TO WSS-REG-GRA IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF NOT FIO-STAT-OKS
              GO TO FIN-MAIN.
           GO TO CIC-MOD-PODE.

       FIN-MAIN.
           MOVE FIO-CLO  TO FIO-CMND.
           PERFORM SGC-FIO-EDP.

           DISPLAY ' REGISTROS LEIDOS   : ' WSS-REG-LEE IN WSS-VARI.
           DISPLAY ' REGISTROS ERRONEOS : ' WSS-REG-ERR IN WSS-VARI.
           DISPLAY ' REGISTROS GRABADOS : ' WSS-REG-GRA IN WSS-VARI.
           
           PERFORM GNS-PRO-END.

       COPY SGCBFEDP.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGHOY.
