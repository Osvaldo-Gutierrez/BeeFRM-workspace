       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SGCPLICC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    23-Dec-88 06:30 PM.
      * Programa Listador de Reporte ICC con Sort.
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *DOS SELECT RPTICC         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTICC         ASSIGN TO        UT-S-RPTICC.
           SELECT RPTICC         ASSIGN TO SYS011-UR-1403-S.
       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY SGCRRICC.
       FD  RPTICC LABEL RECORDS OMITTED
           REPORT IS RPT-ICC
           .
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY SGCRWICC.
      *<<<< RW
       COPY SGCRWCTA.
       COPY SGCRWDPT.
      *>>>>
       COPY GNSWGSYS.
      *<<<< WSS
       COPY GNSWGCPT.
       COPY SGCWGCCT.
       COPY SGCWVPPU.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY SGCBRDCC.
       COPY SGCBRRCD.
       COPY SGCBRRBS.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRREC.
       COPY SGCBRAEP.
       COPY SGCBREFE.
       COPY SGCBRDSF.
       COPY SGCBRCHP.
       COPY TABBRCAM.
       01  WSS-VARI.
           03 WSS-IDC-ICLI.
              05 WSS-NUM-ICLI                    PIC X(08).
              05 WSS-IND-ICLI                    PIC X(01).
              05 WSS-GLS-ICLI                    PIC X(03).
           03 WSS-COD-LUGA.
              05 WSS-COD-COMU                    PIC X(04).
              05 WSS-GLS-PAIS  REDEFINES  WSS-COD-COMU.
                 07 WSS-IND-PAIS                 PIC X(01).
                 07 WSS-COD-PAIS                 PIC X(03).
           03 WSS-TBL-RCHP.
              05 WSS-RCHP      OCCURS 5.
                 07 FILLER                       PIC X(13).
                 07 WSS-FEC-FCHP                 PIC 9(08).
                 07 FILLER                       PIC X(96).
           03 WSS-NCHP                           PIC 9(01).
           03 I                                  PIC 9(01).
           03 J                                  PIC 9(01).
           03 K                                  PIC 9(01).
           03 WSS-IND-HCTA VALUE 0               PIC 9(01).
           03 WSS-VAL-MNAC                       PIC 9(11).

      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CHP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *>>>>
       REPORT SECTION.
      *--------------
       COPY SGCRFICC.
           .
       COPY SGCRTICC.
      *<<<< RT
       COPY SGCRTCTA.
       COPY SGCRTDPT.
      *>>>>
       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CF-ICC-DBC-GLS-NOMC SECTION.
           USE BEFORE REPORTING CF-ICC-DBC-GLS-NOMC.
       INI-CF-ICC-DBC-GLS-NOMC.
       FIN-CF-ICC-DBC-GLS-NOMC.
           EXIT.
       DEC-PH-ICC SECTION.
           USE BEFORE REPORTING PH-ICC.
       INI-PH-ICC.
       FIN-PH-ICC.
           EXIT.
       END DECLARATIVES.
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPLICC' TO FIO-PROG.
           PERFORM BUS-FSIS.
           SORT GNSSRT
       COPY SGCRSICC.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
       COPY GNSBGGBK.
       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
           DISPLAY 'Ingrese IDC de Cliente : '.
           ACCEPT  WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY WSS-IDC-ICLI IN WSS-VARI.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY WSS-IDC-ICLI IN WSS-VARI
               DISPLAY MSG-GLS-DESC IN MSG
               GOBACK
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>

       MOV-INP-SRT.
       COPY SGCRMICC.
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
           GO TO FIN-INP-SRT.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           OPEN OUTPUT RPTICC.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-ICC.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           MOVE SPACES TO WSS-ICC.
      ******************************************************************
********
           IF DBC-COD-ACTI IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'ACT'               TO TAB-COD-TTAB
               MOVE DBC-COD-ACTI IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-ACTI IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-ACTI IN WSS-ICC.
           IF DBC-COD-OFIC IN SRT > SPACES
               MOVE DBC-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-ICC
           ELSE
               MOVE SPACES  TO WSS-GLS-OFIC IN WSS-ICC.
           IF DBC-COD-EJEC IN SRT > SPACES
               MOVE DBC-COD-EJEC IN SRT TO USR-COD-USER
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-EJEC IN WSS-ICC.
           IF DBC-IND-UPIR IN SRT > SPACES
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'UPIR'              TO MSC-COD-TMSC
               MOVE DBC-IND-UPIR IN SRT TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-UPIR IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-UPIR IN WSS-ICC.
           IF DBC-COD-TICL IN SRT > SPACES
               MOVE 'SGC'               TO TAB-COD-SIST
               MOVE 'TCL'               TO TAB-COD-TTAB
               MOVE DBC-COD-TICL IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TICL IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-TICL IN WSS-ICC.
           IF DBC-COD-CLCM IN SRT > SPACES
               MOVE 'SGC'               TO TAB-COD-SIST
               MOVE 'CLC'               TO TAB-COD-TTAB
               MOVE DBC-COD-CLCM IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-CLCM IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-CLCM IN WSS-ICC.
           IF DBC-COD-BLOC IN SRT > SPACES
               MOVE 'SGC'               TO TAB-COD-SIST
               MOVE 'BLO'               TO TAB-COD-TTAB
               MOVE DBC-COD-BLOC IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-BLOC IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-BLOC IN WSS-ICC.
           IF DBC-MSC-SCLI IN SRT > SPACES
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'SCLI'              TO MSC-COD-TMSC
               MOVE DBC-MSC-SCLI IN SRT TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-SCLI IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-SCLI IN WSS-ICC.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD > SPACES
               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA

               IF WSS-IND-PAIS = 'P'
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE 'PAI'        TO TAB-COD-TTAB
                   MOVE WSS-COD-PAIS TO TAB-COD-CTAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DCOR TO WSS-GLS-LUGA IN WSS-ICC
               ELSE
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE 'COM'        TO TAB-COD-TTAB
                   MOVE WSS-COD-LUGA TO TAB-COD-CTAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DCOR TO WSS-GLS-LUGA IN WSS-ICC
           ELSE
               MOVE '*' TO RCD-GLS-DIRE
               MOVE '*' TO WSS-GLS-LUGA IN WSS-ICC
               MOVE '*' TO RCD-GLS-FONO.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DSF-CIC-ICLI IN DSF.
           MOVE 'DSF-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DSF.
           IF FIO-STAT-OKS  AND
              ( DSF-VAL-DVCN IN DSF > ZEROES OR
                DSF-VAL-DVCX IN DSF > ZEROES OR
                DSF-VAL-IVCT IN DSF > ZEROES )
               MOVE 'S' TO WSS-IND-IVCS IN WSS-ICC
           ELSE
               MOVE 'N' TO WSS-IND-IVCS IN WSS-ICC.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO RBS-CIC-ICLI IN RBS.
           MOVE 'RBS-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO RBS-IND-ICSF.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DCC-CIC-ICLI IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           IF FIO-STAT-OKS
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC
               MOVE DCC-IND-UTBC IN DCC TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-UTBC IN WSS-ICC
           ELSE
               MOVE ZEROES TO DCC
               MOVE SPACES TO DCC-IND-PBOL IN DCC
               MOVE SPACES TO WSS-GLS-UTBC IN WSS-ICC.
      ******************************************************************
********
           IF DBC-IND-TICL IN SRT = 'P'
               PERFORM BUS-AEP
           ELSE
               PERFORM BUS-EFE.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-RCP.
           IF MSG-COD-MENS NOT > SPACES
               MOVE REC-CIC-IREL IN REC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO WSS-GLS-NCLP IN WSS-ICC
                   MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLP IN WSS-ICC
                   MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLP IN WSS-ICC
                   MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLP IN WSS-ICC
                   MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLP IN WSS-ICC
               ELSE
                   MOVE '*' TO WSS-NUM-ICLP IN WSS-ICC
                   MOVE '*' TO WSS-VRF-ICLP IN WSS-ICC
                   MOVE '*' TO WSS-IND-ICLP IN WSS-ICC
                   MOVE '*' TO WSS-GLS-ICLP IN WSS-ICC
                   MOVE '*' TO WSS-GLS-NCLP IN WSS-ICC.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-DCM.
           IF MSG-COD-MENS NOT > SPACES
               MOVE 'S' TO WSS-IND-DCOM IN WSS-ICC
           ELSE
               MOVE 'N' TO WSS-IND-DCOM IN WSS-ICC.
      ******************************************************************
********
           PERFORM BUS-PPU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DCOR TO WSS-GLS-RELB IN WSS-ICC
           ELSE
               PERFORM CIC-PPU
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DCOR TO WSS-GLS-RELB IN WSS-ICC

               ELSE
                   MOVE DBC-CIC-ICLI IN SRT TO PPU-CIC-ICLI
                   PERFORM BUS-RCU
                   MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-RELB IN WSS-ICC.
      ******************************************************************
********
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE DBC-COD-OFIC IN SRT TO DBC-COD-OFIC IN DBC.
           PERFORM BUS-OLD-CCT.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO OPE
               MOVE SPACES TO OPE-CIC-IOPE IN SRT
               MOVE SPACES TO OPE-CIC-IOPE IN OPE
               MOVE SPACES TO OPE-IND-MCLI IN OPE
               MOVE SPACES TO OPE-COD-EJOP IN OPE
               MOVE SPACES TO OPE-COD-VCOP IN OPE
               GO TO GEN-OUT-SRT.
           MOVE OPE-CIC-IOPE IN OPE  TO OPE-CIC-IOPE IN SRT.
           MOVE CCT-NCCT IN CCT-VARI TO WSS-NUM-CCTE IN WSS-ICC.
           IF OPE-IND-MCLI IN OPE > SPACES
               MOVE 'S' TO WSS-IND-MCLI IN WSS-ICC
           ELSE
               MOVE 'N' TO WSS-IND-MCLI IN WSS-ICC.
           IF OPE-COD-EJOP IN OPE > SPACES
               MOVE OPE-COD-EJOP IN OPE TO USR-COD-USER
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJOP IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-EJOP IN WSS-ICC.
           IF OPE-COD-VCOP IN OPE > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB
               MOVE OPE-COD-VCOP IN OPE TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCAM IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-ICC.
           IF OPE-COD-MOTT IN OPE > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'MTO'               TO TAB-COD-TTAB
               MOVE OPE-COD-MOTT IN OPE TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-MOTT IN WSS-ICC
           ELSE
               MOVE SPACES TO WSS-GLS-MOTT IN WSS-ICC.
      ******************************************************************
********
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-ICC.
      *<<<< FIN_GEN_OUT
      ******************************************************************
********
           IF CCT-NCCT IN CCT-VARI > ZEROES
               MOVE SPACES TO WSS-CTA
               MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC
               PERFORM BUS-CTA-CTE.
      ******************************************************************
********
           MOVE SPACES TO WSS-DPT.
           MOVE SPACES TO WSS-TBL-RCHP.
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-DOC-PRO.
           PERFORM LIS-DOC-PRO.
      ******************************************************************
********
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
           TERMINATE RPT-ICC.
           CLOSE RPTICC.
       COPY SGCBFDBC.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
      *<<<< EOF
      ******************************************************************
********
       BUS-AEP SECTION.
       INI-BUS-AEP.
           MOVE DBC-CIC-ICLI IN SRT TO AEP-CIC-ICLI IN AEP.
           MOVE '99999999'          TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = AEP-CIC-ICLI IN AEP
               MOVE AEP-NUM-DAEP IN AEP TO WSS-NUM-DESB IN WSS-ICC
               MOVE AEP-NUM-MAEP IN AEP TO WSS-NUM-MESB IN WSS-ICC
               MOVE AEP-NUM-SAEP IN AEP TO WSS-NUM-SESB IN WSS-ICC
               MOVE AEP-NUM-AAEP IN AEP TO WSS-NUM-AESB IN WSS-ICC
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'ESBL'              TO MSC-COD-TMSC
               MOVE 'S'                 TO MSC-COD-CMSC

               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-ESOB IN WSS-ICC
           ELSE
               MOVE 'SITUACION'  TO WSS-GLS-ESOB IN WSS-ICC.
       FIN-BUS-AEP.
           EXIT.
       BUS-EFE SECTION.
       INI-BUS-EFE.
           MOVE DBC-CIC-ICLI IN SRT TO EFE-CIC-ICLI IN EFE.
           MOVE '99999999'          TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = EFE-CIC-ICLI IN EFE
               MOVE EFE-NUM-DEFE IN EFE TO WSS-NUM-DESB IN WSS-ICC
               MOVE EFE-NUM-MEFE IN EFE TO WSS-NUM-MESB IN WSS-ICC
               MOVE EFE-NUM-SEFE IN EFE TO WSS-NUM-SESB IN WSS-ICC
               MOVE EFE-NUM-AEFE IN EFE TO WSS-NUM-AESB IN WSS-ICC
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'ESBL'              TO MSC-COD-TMSC
               MOVE EFE-IND-ESBL IN EFE TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-ESOB IN WSS-ICC
           ELSE
               MOVE 'BALANCE'    TO WSS-GLS-ESOB IN WSS-ICC.
       FIN-BUS-EFE.
           EXIT.
      ******************************************************************
********
      * Busca Cuenta Corriente
       BUS-CTA-CTE SECTION.
       INI-BUS-CTA-CTE.
           MOVE SPACES         TO MSG-COD-MENS.
           MOVE SPACES         TO MSG-GLS-DESC.
           MOVE 'AUX'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'CTE'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICCTACNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-BUS-CTA-CTE.
           MOVE TAB-COD-CTAB IN TAB TO CCT-CTAB IN CCT-VARI.
           MOVE SPACES              TO RCO-KEY-IRCO IN RCO.
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.
           MOVE TAB-COD-CTAB IN TAB TO RCO-COD-COPR IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-CTA-CTE.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS OR
              RCO-CIC-ICLI IN RCO NOT = DBC-CIC-ICLI IN DBC OR
              RCO-COD-COPR IN RCO NOT = CCT-CTAB IN CCT-VARI
               GO TO FIN-BUS-CTA-CTE.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-CTA-CTE.
           IF OPE-CIC-IOPE IN SRT = OPE-CIC-IOPE IN OPE
               GO TO FIN-COM-CTA.
           IF WSS-IND-HCTA IN WSS-VARI NOT = 1
               GENERATE DL-HCTA.
           PERFORM PRO-CTA-CTE.
       FIN-COM-CTA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-CTA-CTE.
       FIN-BUS-CTA-CTE.
           EXIT.
      * Proceso Lista Cuenta Corriente
       PRO-CTA-CTE SECTION.
       INI-PRO-CTA-CTE.
           MOVE OPE-CIC-IOPE IN OPE TO WSS-CIC-IOPE IN WSS-CTA.
           IF OPE-COD-EJOP IN OPE > SPACES
               MOVE OPE-COD-EJOP IN OPE TO USR-COD-USER
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJOP IN WSS-CTA
           ELSE
               MOVE SPACE TO WSS-GLS-EJOP IN WSS-CTA.
           IF OPE-COD-MOTT IN OPE > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'MTO'               TO TAB-COD-TTAB
               MOVE OPE-COD-MOTT IN OPE TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-MOTT IN WSS-CTA
           ELSE
               MOVE SPACE TO WSS-GLS-MOTT IN WSS-CTA.
           IF OPE-IND-MCLI IN OPE > SPACES

               MOVE 'S' TO WSS-IND-MCLI IN WSS-CTA
           ELSE
               MOVE 'N' TO WSS-IND-MCLI IN WSS-CTA.
           GENERATE DL-CTA.
           MOVE 1 TO WSS-IND-HCTA IN WSS-VARI.
       FIN-PRO-CTA-CTE.
           EXIT.
      ******************************************************************
********
      * Busca Documentos Protestados
       BUS-DOC-PRO SECTION.
       INI-BUS-DOC-PRO.
           MOVE ZEROES TO WSS-NCHP.
           MOVE SPACES              TO RCO-KEY-IRCO IN RCO.
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-RCO.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS OR
              RCO-CIC-ICLI IN RCO NOT = DBC-CIC-ICLI IN DBC
               GO TO FIN-BUS-DOC-PRO.
           MOVE SPACES TO CHP-KEY-ICHP IN CHP.
           MOVE RCO-CIC-IOPE IN RCO TO CHP-CIC-ICCT IN CHP.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-CHP.
           PERFORM SGC-FIO-CHP.
           IF NOT FIO-STAT-OKS OR
              CHP-CIC-ICCT IN CHP NOT = RCO-CIC-IOPE IN RCO
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-RCO.
           PERFORM ORD-DOC-FEC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-CHP.
       FIN-BUS-DOC-PRO.
           EXIT.
      * Ordena Documentos Protestados por Fecha
       ORD-DOC-FEC SECTION.
       INI-ORD-DOC-FEC.
           IF WSS-NCHP = 0
               GENERATE DL-HDPT
               MOVE CHP TO WSS-RCHP(1)
               MOVE  1  TO WSS-NCHP
           ELSE
               PERFORM DET-UBIC VARYING I FROM 1 BY 1 UNTIL I > 5  OR
                                          CHP-FEC-FCHP > WSS-FEC-FCHP(I)
               IF I NOT > 5
                   PERFORM MOV-ELEM VARYING J FROM 5 BY -1 UNTIL
                                                              J NOT > I
                   MOVE CHP TO WSS-RCHP(I).
       FIN-ORD-DOC-FEC.
           EXIT.
       DET-UBIC SECTION.
       INI-DET-UBIC.
       FIN-DET-UBIC.
           EXIT.
       MOV-ELEM SECTION.
       INI-MOV-ELEM.
           SUBTRACT 1 FROM J GIVING K.
           MOVE WSS-RCHP(K) TO WSS-RCHP(J).
       FIN-MOV-ELEM.
           EXIT.
      * Lista Documentos Protestados
       LIS-DOC-PRO SECTION.
       INI-LIS-DOC-PRO.
           MOVE 1 TO I.
       LUP-LIS-DOC.
           IF I NOT > 5
               MOVE WSS-RCHP(I) TO CHP
               ADD     1       TO I
               IF CHP-FEC-FCHP > ZEROES
                   PERFORM LIS-GLS-DESC
                   PERFORM BUS-VAL-CAM
                   MOVE WSS-VAL-MNAC IN WSS-VARI TO WSS-VAL-CHEQ
                                                            IN WSS-DPT
                   GENERATE DL-DPT
                   GO TO LUP-LIS-DOC
               ELSE
                   MOVE ZEROES TO CHP
                   MOVE SPACES TO CHP-CIC-ICCT IN CHP
                   GO TO LUP-LIS-DOC.
       FIN-LIS-DOC-PRO.
           EXIT.
       LIS-GLS-DESC SECTION.
       INI-LIS-GLS-DESC.
           IF CHP-COD-VCMC IN CHP > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB
               MOVE CHP-COD-VCMC IN CHP TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-VCMC IN WSS-DPT
           ELSE

               MOVE SPACES TO WSS-GLS-VCMC IN WSS-DPT.
           IF CHP-COD-MOTP IN CHP > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'MTP'               TO TAB-COD-TTAB
               MOVE CHP-COD-MOTP IN CHP TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-MOTP IN WSS-DPT
           ELSE
               MOVE SPACES TO WSS-GLS-MOTP IN WSS-DPT.
           IF CHP-COD-OFIC IN CHP > SPACES
               MOVE CHP-COD-OFIC IN CHP TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-ABRV IN OFI TO WSS-GLS-OFOP IN WSS-DPT
           ELSE
               MOVE SPACES TO WSS-GLS-OFOP IN WSS-DPT.
       FIN-LIS-GLS-DESC.
           EXIT.
      * Obtiene Valor de Cambio de Documento Protestado en Moneda Nacion
al
       BUS-VAL-CAM SECTION.
       INI-BUS-VAL-CAM.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-COD-CTAB NOT = CHP-COD-VCMC AND
                  CHP-COD-VCMC > SPACES
                   MOVE CHP-FEC-FCHP TO CAM-FEC-FCAM IN CAM(1)
                   MOVE CHP-FEC-FCHP TO CAM-FEC-FCAM IN CAM(2)
                   MOVE CHP-COD-VCMC TO CAM-COD-VCAM IN CAM(1)
                   MOVE TAB-COD-CTAB TO CAM-COD-VCAM IN CAM(2)
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM TAB-FIO-CAM
                   IF NOT FIO-STAT-OKS
                       MOVE ZEROES TO WSS-VAL-MNAC IN WSS-VARI
                       DISPLAY 'NO EXISTE VALOR CAMBIO A ESTA FECHA : '
                                CHP-FEC-FCHP
                   ELSE
                       MULTIPLY CAM-SGV-VCAM IN CAM BY CHP-VAL-CHEQ
                         IN CHP GIVING WSS-VAL-MNAC IN WSS-VARI
               ELSE
                   MOVE CHP-VAL-CHEQ IN CHP TO WSS-VAL-MNAC IN WSS-VARI
           ELSE
               DISPLAY 'NO EXISTE MONEDA NACIONAL DEFINIDA : '
                        TAB-CIC-CTAB.
       FIN-BUS-VAL-CAM.
           EXIT.
      ******************************************************************
********
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY SGCBFDCC.
       COPY SGCBFRCD.
       COPY SGCBFOPE.
       COPY SGCBFRBS.
       COPY SGCBFRCO.
       COPY SGCBFREC.
       COPY SGCBFEFE.
       COPY SGCBFAEP.
       COPY SGCBFDSF.
       COPY SGCBFCHP.
       COPY TABBFCAM.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY SGCBGRCP.
       COPY SGCBGDCM.
       COPY SGCBGCCT.
       COPY GNSBGPPU.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
