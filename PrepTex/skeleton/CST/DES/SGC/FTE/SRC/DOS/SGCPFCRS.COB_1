       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SGCPFCRS.
       AUTHOR.          GUZMAN Y CIA.
      * Subrutina de I/O Batch para archivo secuencial VSAM SGCCRS (Reubicable).
       ENVIRONMENT DIVISION.
      *====================
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *DOS SELECT  SGCCRS ASSIGN TO SYS010-DA-3375-S-SGCCRS
      *MVS SELECT  SGCCRS ASSIGN TO        DA-S-SGCCRS
           SELECT  SGCCRS ASSIGN TO        DA-S-SGCCRS
                ORGANIZATION         IS SEQUENTIAL
                ACCESS               IS SEQUENTIAL
                STATUS               IS FIO-STAT.
       DATA DIVISION.
      *=============
       FILE SECTION.
       FD  SGCCRS
           LABEL RECORDS OMITTED
      *JSS BLOCK CONTAINS 5 RECORDS
           BLOCK CONTAINS 0 RECORDS
           RECORD CONTAINS 66
       .
       COPY SGCBRCRS.
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWCFIO.
       LINKAGE SECTION.
      *---------------
       COPY GNSWVFIO.
       01  LNK-REGI                             PIC X(66).
       PROCEDURE DIVISION USING FIO-VARI LNK-REGI.
      *==========================================
       COPY GNSBEFIO
           REPLACING
                FIO-VOID BY =='SGCCRS'==
           .
       MAIN SECTION.
       INI-MAIN.
           GO TO ERR-ALT         INI-GET-NXT     ERR-ALT
                 ERR-ALT         ERR-ALT         INI-PUT-FIL
                 ERR-ALT         ERR-ALT         ERR-ALT
                 INI-INP-FIL     INI-OUT-FIL     ERR-ALT
                 INI-CLO-FIL     ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT         ERR-ALT
                 ERR-ALT         ERR-ALT
           DEPENDING ON FIO-CMND.
       ERR-MAIN.
           DISPLAY '? CODIGO '
                FIO-CMND
                .
           DISPLAY '  INVALIDO EN SGCPFCRS PARA ARCHIVO '
                'SGCCRS'
                ' : ABORTO'
                .
           STOP RUN.
       FIN-MAIN.
           EXIT PROGRAM.
       GET-NXT SECTION.
       INI-GET-NXT.
           READ SGCCRS NEXT INTO LNK-REGI.
       FIN-GET-NXT.
           EXIT PROGRAM.
       PUT-FIL SECTION.
       INI-PUT-FIL.
           WRITE CRS FROM LNK-REGI.
       FIN-PUT-FIL.
           EXIT PROGRAM.
       INP-FIL SECTION.
       INI-INP-FIL.
           OPEN INPUT SGCCRS.
       FIN-INP-FIL.
           EXIT PROGRAM.
       OUT-FIL SECTION.
       INI-OUT-FIL.
           OPEN OUTPUT SGCCRS.
       FIN-OUT-FIL.
           EXIT PROGRAM.
       CLO-FIL SECTION.
       INI-CLO-FIL.
           CLOSE SGCCRS.
       FIN-CLO-FIL.
           EXIT PROGRAM.
       ERR-ALT SECTION.
       INI-ERR-ALT.
           DISPLAY '  INVALIDO EN SGCPFCRS PARA ARCHIVO '
                'SGCCRS'
                ' : ABORTO'
                .
           STOP RUN.
       FIN-ERR-ALT.
           EXIT PROGRAM.
