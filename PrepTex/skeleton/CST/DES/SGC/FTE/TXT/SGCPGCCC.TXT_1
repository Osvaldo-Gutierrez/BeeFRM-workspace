*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *DOS SELECT RPTRCH         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTRCH         ASSIGN TO        UT-S-RPTRCH.
           SELECT RPTRCH         ASSIGN TO        UT-S-RPTRCH.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTRCH LABEL RECORDS OMITTED
           REPORT IS RPT-RCH.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RR
      *<<<< RR
       COPY SGCRRRCH REPLACING ==01  SRT== BY ==02  CSRT==.
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY SGCRWRCH.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY GNSBRCIC.
       COPY GNSBRJGN.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRRCD.
       COPY SGCBRREC.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRJCC.
       COPY SGCBRBCT.
       COPY COLBRMVO.

       COPY GNSWGBCD.
       COPY GNSWCNUM.
       COPY GNSWVNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGCIC.
       COPY GNSWGCPT.

       01  WSS-VARI.
           03 WSS-CAI-CCTE                        PIC X(04).
           03 WSS-COD-OFIC                        PIC X(03).
           03 WSS-COD-EJEC                        PIC X(12).
           03 WSS-COD-ACTI                        PIC X(09).
           03 WSS-COD-COMD                        PIC X(04).
           03 WSS-ALF-TERM      VALUE SPACES      PIC X(04).
           03 WSS-NUM-TERM                        PIC 9(04).
           03 WSS-IDC-EMPL.
              05 WSS-NUM-EMPL                     PIC X(08).
              05 WSS-IND-EMPL                     PIC X(01).
              05 WSS-GLS-EMPL                     PIC X(03).
           03 WSS-CIC-EMPL                        PIC X(12).
           03 WSS-COD-TCOM                        PIC X(02).
           03 WSS-CIC-ICAR                        PIC X(12).
           03 WSS-COD-IPRO                        PIC X(12).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FTRN.
              05 WSS-NUM-STRN                     PIC 9(02).
              05 WSS-NUM-ATRN                     PIC 9(02).
              05 WSS-NUM-MTRN                     PIC 9(02).
              05 WSS-NUM-DTRN                     PIC 9(02).
           03 WSS-HRA-HRTR      VALUE '030000'    PIC X(06).
           03 WSS-I                               PIC 9(02).
           03 WSS-INF                             PIC 9(02).
           03 WSS-SUP                             PIC 9(02).
           03 WSS-RNG-AINF.
              05 WSS-ALF-ICTE      OCCURS 10      PIC X(08).
           03 WSS-RNG-ASUP.
              05 WSS-ALF-FCTE      OCCURS 10      PIC X(08).
           03 WSS-RNG-NINF.
              05 WSS-NUM-ICTE      OCCURS 10      PIC 9(08).
           03 WSS-RNG-NSUP.
              05 WSS-NUM-FCTE      OCCURS 10      PIC 9(08).
           03 WSS-NUM-SELE      VALUE ZEROES      PIC 9(08).
           03 WSS-COD-PESO                        PIC X(06).
           03 WSS-COD-TOPR                        PIC X(03).
           03 WSS-NUM-CORG                        PIC 9(08).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-IND-ERRO                        PIC 9(01).
           03 WSS-IDC-ICLI.
              05 WSS-NUM-ICLI                     PIC X(08).
              05 WSS-IND-ICLI                     PIC X(01).
              05 WSS-GLS-ICLI                     PIC X(03).
           03 WSS-CIC-ICLI.
              05 WSS-CAI-ICLI                     PIC X(04).
              05 WSS-IIC-ICLI                     PIC X(08).
           03 WSS-COD-LUGA.
              05 WSS-COD-COMU                     PIC X(04).
              05 WSS-GLS-PAIS  REDEFINES  WSS-COD-COMU.
                 07 WSS-IND-PAIS                  PIC X(01).
                 07 WSS-COD-PAIS                  PIC X(03).
           03 WSS-NRO-CCTA                        PIC 9(08).
           03 WSS-CTA-CCTE.
              05 WSS-NUM-CCTE                     PIC 9(07).
              05 WSS-VRF-CCTE                     PIC 9(01).
           03 WSS-CIC-IOPE.
              05 WSS-CAI-IOPE                     PIC X(04).
              05 WSS-IIC-IOPE.
                 07 WSS-COD-SOPE                  PIC X(02).
                 07 WSS-GLS-SOPE                  PIC X(06).
           03 WSS-NUM-TREC                        PIC 9(02).
           03 WSS-CONT.
              05 WSS-NUM-READ                     PIC 9(06).
              05 WSS-NUM-REGP                     PIC 9(06).
              05 WSS-NUM-RECH                     PIC 9(06).
              05 WSS-NUM-CLIP                     PIC 9(06).
              05 WSS-NUM-CTAP                     PIC 9(06).
              05 WSS-NUM-ACEP                     PIC 9(06).
           03  WSS-FEC-FHOY.
               05  WSS-NUM-DHOY                   PIC 9(02).
               05  WSS-NUM-MHOY                   PIC 9(02).
               05  WSS-NUM-AHOY                   PIC 9(02).
           03  WSS-RUT.
               05  WSS-FILLER                     PIC 9(03).
               05  WSS-GLS-RUT.
                   07  WSS-NUM-RUT                PIC X(07).
                   07  WSS-NUM-DIG                PIC X(01).
               05  WSS-NUM-VRF                    PIC X(01).  
           03  WSS-SIN-BRUT.
               05  WSS-FIL1                       PIC 9(03).
               05  WSS-GLS-SINB                   PIC X(07).
           03  WSS-BCD-RUT.
               05  WSS-NUM-BRUT                   PIC X(05).
               05  WSS-VRF-BRUT                   PIC X(01).
           03  WSS-AUX                COMP        PIC 9(02).
           03  WSS-DIG                            PIC 9(01).
           03  WSS-AUX-DLIM.
               05  WSS-AUX-DLI1                   PIC X(01).
               05  WSS-AUX-DLI2                   PIC X(01).
           03  WSS-CIC-OPEA.
               05  WSS-NUM-DIGA                   PIC X(02).
               05  WSS-IIC-OPEA                   PIC X(08).
           03  WSS-CIC-ACTI.
               05  WSS-CIC-ACT1                   PIC X(02).
               05  WSS-CIC-ACT2                   PIC X(09).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MVO-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY SGCRFRCH.
           .
       COPY SGCRTRCH.
      *>>>>
*% END
*% IF PH_ACP
      *<<<< PH_ACP
      *>>>>
*% END
*% IF FF_ACP
      *<<<< FF_ACP
      *>>>>
*% END
*% IF FIN_DEC
      *<<<< FIN_DEC
      *>>>>
*% END
*% IF INI
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura Codigo Centro de Asignacion
      *     DISPLAY 'CENTRO ASIGNACION        ( XXXX ) : '.
      *     ACCEPT  WSS-CAI-CCTE IN WSS-VARI.
      *     DISPLAY WSS-CAI-CCTE IN WSS-VARI.
      *Captura Cta. Cte. Inicial
           DISPLAY 'CTA. CTE. INICIAL    ( 99999999 ) : '.
           MOVE SPACES TO WSS-RNG-AINF IN WSS-VARI.
           ACCEPT  WSS-RNG-AINF IN WSS-VARI.
           DISPLAY WSS-RNG-AINF IN WSS-VARI.
      *Captura Cta. Cte. Final
           DISPLAY 'CTA. CTE. FINAL      ( 99999999 ) : '.
           MOVE SPACES TO WSS-RNG-ASUP IN WSS-VARI.
           ACCEPT  WSS-RNG-ASUP IN WSS-VARI.
           DISPLAY WSS-RNG-ASUP IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'CODIGO OFICINA            ( XXX ) : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *Captura Codigo de Ejecutivo
           DISPLAY 'CODIGO EJECUTIVO ( XXXXXXXXXXXX ) : '.
           ACCEPT  WSS-COD-EJEC IN WSS-VARI.
           DISPLAY WSS-COD-EJEC IN WSS-VARI.
      *Captura Codigo de Actividad
           DISPLAY 'CODIGO ACTIVIDAD    ( XXXXXXXXX ) : '.
           ACCEPT  WSS-COD-ACTI IN WSS-VARI.
           DISPLAY WSS-COD-ACTI IN WSS-VARI.
      *Captura Terminal
           DISPLAY 'IDENTIFICACION TERMINAL  ( 9999 ) : '.
           ACCEPT  WSS-ALF-TERM IN WSS-VARI.
           DISPLAY WSS-ALF-TERM IN WSS-VARI.
      *Captura Codigo de Comuna Domicilio
      *     DISPLAY 'CODIGO COMUNA DOMICILIO  ( XXXX ) : '.
      *     ACCEPT  WSS-COD-COMD IN WSS-VARI.
      *     DISPLAY WSS-COD-COMD IN WSS-VARI.
      *Captura IDC del Empleador
           DISPLAY 'INGRESE IDC DE EMPLEADOR : '. 
           ACCEPT  WSS-IDC-EMPL IN WSS-VARI.
           DISPLAY WSS-IDC-EMPL IN WSS-VARI.
      *Captura Codigo Tipo de Comision
           DISPLAY 'CODIGO TIPO COMISION       ( XX ) : '.
           ACCEPT  WSS-COD-TCOM IN WSS-VARI.
           DISPLAY WSS-COD-TCOM IN WSS-VARI.
      *Captura Cta. de Cargo Asociada
           DISPLAY 'CTA CARGO ASOCIADA ( XXXXXXXXXXXX ) : '.
           ACCEPT  WSS-CIC-ICAR IN WSS-VARI.
           DISPLAY WSS-CIC-ICAR IN WSS-VARI.
      *Captura Identificacion Proceso
           DISPLAY 'IDENTIFICACION PROCESO ( XXXXXXXXXXXX ) : '.
           ACCEPT  WSS-COD-IPRO IN WSS-VARI.
           DISPLAY WSS-COD-IPRO IN WSS-VARI.
      *Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO     ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-TAB Valida Centro de Asignacion en TABLAS
      *     DISPLAY WSS-CAI-CCTE IN WSS-VARI.
      *     IF WSS-CAI-CCTE IN WSS-VARI NOT > SPACES
      *         DISPLAY 'SE ASUMIO '0000' PARA C. ASIGNACION'
      *          MOVE ZEROES TO WSS-CAI-CCTE IN WSS-VARI.

      *VAL-NUM Validacion numerica CTA. CTE. Inicial
           IF WSS-RNG-AINF IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-RNG-AINF IN WSS-VARI
               DISPLAY 'DEBE DIGITAR RANGO INFERIOR DE CTAS. CTES. '
               PERFORM GNS-PRO-ABT.
           IF WSS-RNG-AINF IN WSS-VARI NOT = SPACES
               MOVE 1      TO WSS-I        IN WSS-VARI
                              WSS-INF      IN WSS-VARI
               MOVE ZEROES TO WSS-RNG-NINF IN WSS-VARI
               PERFORM VAL-RNG-INFE UNTIL WSS-I IN WSS-VARI > 10
               DISPLAY WSS-RNG-NINF IN WSS-VARI
               IF WSS-RNG-NINF IN WSS-VARI NOT > ZEROES
                   DISPLAY 'NO EXISTE NINGUN RANGO INFERIOR DE CTA. '
                           'CTE. INGRESADO VALIDO'
                   PERFORM GNS-PRO-ABT.
      * Valor inicial de CTA. CTE.
           MOVE WSS-NUM-ICTE IN WSS-VARI(1) TO WSS-NRO-CCTA IN WSS-VARI.

      *VAL-NUM Validacion numerica CTA. CTE. Final
           IF WSS-RNG-ASUP IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-RNG-ASUP IN WSS-VARI
               DISPLAY 'DEBE DIGITAR RANGO SUPERIOR DE CTAS. CTES. '
               PERFORM GNS-PRO-ABT.
           IF WSS-RNG-ASUP IN WSS-VARI NOT = SPACES
               MOVE 1      TO WSS-I        IN WSS-VARI
                              WSS-SUP      IN WSS-VARI
               MOVE ZEROES TO WSS-RNG-NSUP IN WSS-VARI
               PERFORM VAL-RNG-SUPE UNTIL WSS-I IN WSS-VARI > 10
               DISPLAY WSS-RNG-NSUP IN WSS-VARI
               IF WSS-RNG-NSUP IN WSS-VARI NOT > ZEROES
                   DISPLAY 'NO EXISTE NINGUN RANGO SUPERIOR DE CTA. '
                           'CTE. INGRESADO VALIDO'
                   PERFORM GNS-PRO-ABT.

      * Validacion de Consistencia en los Rangos de CTAS. CTES. ingresados
           IF WSS-INF IN WSS-VARI NOT = WSS-SUP IN WSS-VARI
               DISPLAY 'NO EXISTE CONSISTENCIA EN LOS RANGOS DE CTAS. '
                       'CTES. INGRESADOS VALIDOS'
                PERFORM GNS-PRO-ABT.

      *VAL-OFI Valida Codigo de Oficina en TABLAS
           IF WSS-COD-OFIC IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-COD-OFIC IN WSS-VARI
               DISPLAY 'DEBE DIGITAR CODIGO DE OFICINA '
               PERFORM GNS-PRO-ABT.
           IF WSS-COD-OFIC IN WSS-VARI NOT = SPACES
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

      *VAL-USR Valida Codigo de Usuario en TABLAS
           IF WSS-COD-EJEC IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-COD-EJEC IN WSS-VARI
               DISPLAY 'DEBE DIGITAR CODIGO DE EJECUTIVO '
               PERFORM GNS-PRO-ABT.
           IF WSS-COD-EJEC IN WSS-VARI NOT = SPACES
               DISPLAY WSS-COD-EJEC IN WSS-VARI
               MOVE WSS-COD-EJEC IN WSS-VARI TO USR-COD-USER IN USR
               PERFORM VAL-USR
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

      *VAL-COD Valida Codigo de Actividad en TABLAS
           IF WSS-COD-ACTI IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-COD-ACTI IN WSS-VARI
               DISPLAY 'DEBE DIGITAR CODIGO DE ACTIVIDAD '
               PERFORM GNS-PRO-ABT.
           IF WSS-COD-ACTI IN WSS-VARI NOT = SPACES
               DISPLAY WSS-COD-ACTI IN WSS-VARI
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'ACT'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-ACTI IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

      *VAL-NUM Validacion numerica TERMINAL
           MOVE WSS-ALF-TERM IN WSS-VARI TO NUM-NUME.
           MOVE NUM-ZERO-S               TO NUM-ZERO.
           MOVE NUM-SGNO-N               TO NUM-SGNO.
           MOVE 4                        TO NUM-NENT.
           MOVE 0                        TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-PENT TO WSS-NUM-SELE IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-NUM-SELE IN WSS-VARI.
           DISPLAY WSS-NUM-SELE IN WSS-VARI.
           IF WSS-NUM-SELE IN WSS-VARI NOT > ZEROES
               DISPLAY 'IDENTIFICACION TERMINAL INVALIDO'
               PERFORM GNS-PRO-ABT.
           MOVE WSS-NUM-SELE IN WSS-VARI TO WSS-NUM-TERM IN WSS-VARI.

      *VAL-TAB Valida Codigo de Comuna en TABLAS
      *     IF WSS-COD-COMD IN WSS-VARI NOT > SPACES
      *         MOVE SPACES TO WSS-COD-COMD IN WSS-VARI
      *         DISPLAY 'DEBE DIGITAR CODIGO DE COMUNA '
      *         PERFORM GNS-PRO-ABT.
      ** Valida Codigo Comuna con Codigos de Tabla COM
      *     IF WSS-COD-COMD IN WSS-VARI NOT = SPACES
      *         DISPLAY WSS-COD-COMD IN WSS-VARI
      *         MOVE WSS-COD-COMD IN WSS-VARI TO WSS-COD-LUGA IN WSS-VARI
      *         IF WSS-IND-PAIS IN WSS-VARI NOT = 'P'
      *             MOVE 'TAB'                    TO TAB-COD-SIST
      *             MOVE 'COM'                    TO TAB-COD-TTAB IN TAB
      *             MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *             PERFORM VAL-TAB
      *             IF MSG-COD-MENS > SPACES
      *                 DISPLAY MSG-GLS-DESC IN MSG
      *                 PERFORM GNS-PRO-ABT
      *             ELSE
      *                 NEXT SENTENCE
      *         ELSE
      *             MOVE 'TAB'                    TO TAB-COD-SIST
      *             MOVE 'PAI'                    TO TAB-COD-TTAB IN TAB
      *             MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
      *             PERFORM VAL-TAB
      *             IF MSG-COD-MENS > SPACES
      *                 DISPLAY MSG-GLS-DESC IN MSG
      *                 PERFORM GNS-PRO-ABT.

      * Valida existencia Empleador al leerlo con IDC del Parametro
           DISPLAY WSS-IDC-EMPL IN WSS-VARI.
           MOVE WSS-IDC-EMPL IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG 
               PERFORM GNS-PRO-ABT.
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-EMPL IN WSS-VARI.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           DISPLAY DBC-GLS-NOMC IN DBC.

      *VAL-COD Valida Codigo Tipo de Comision en TABLAS
           IF WSS-COD-TCOM IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-COD-TCOM IN WSS-VARI.
      *         DISPLAY 'DEBE DIGITAR CODIGO TIPO DE COMISION '
      *         PERFORM GNS-PRO-ABT.
           IF WSS-COD-TCOM IN WSS-VARI NOT = SPACES
               DISPLAY WSS-COD-TCOM IN WSS-VARI
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'TIC'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TCOM IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

      * Valida existencia Cta. de Cargo Asociada al leerlo con Parametro
      *VAL-COD Valida Cta. de Cargo Asociada en TABLAS
           IF WSS-CIC-ICAR IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-CIC-ICAR IN WSS-VARI.
      *         DISPLAY 'DEBE DIGITAR CUENTA DE CARGO ASOCIADA '
      *         PERFORM GNS-PRO-ABT.
      *     IF WSS-CIC-ICAR IN WSS-VARI NOT = SPACES
      *         DISPLAY WSS-CIC-ICAR IN WSS-VARI

      * Valida existencia de Identificacion del Proceso en el Parametro
           IF WSS-COD-IPRO IN WSS-VARI NOT > SPACES
               MOVE SPACES TO WSS-COD-IPRO IN WSS-VARI
               DISPLAY 'DEBE DIGITAR IDENTIFICACION DEL PROCESO '
               PERFORM GNS-PRO-ABT.

      *VAL-FEC Valida Fecha de Proceso
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE ZEROES TO WSS-FEC-FPRO IN WSS-VARI
               DISPLAY 'DEBE DIGITAR FECHA DE PROCESO CORRECTA '
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTRN IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTRN IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STRN IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATRN IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Mediante BUS-OFI Obtiene Descripcion de Oficina de Tabla OFI
           MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE WSS-COD-OFIC IN WSS-VARI TO WSS-COD-OFIC IN WSS-ACP
                                            WSS-COD-OFIC IN WSS-RCH.
           MOVE OFI-GLS-DESC IN OFI      TO WSS-GLS-OFIC IN WSS-ACP
                                            WSS-GLS-OFIC IN WSS-RCH.

      * Mediante BUS-USR Obtiene Descripcion del Usuario de Tabla USR
           MOVE WSS-COD-EJEC IN WSS-VARI TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-ACP
                                       WSS-GLS-EJEC IN WSS-RCH.

      * Obtiene Codigo Valor de Cambio Mediante CIC de Moneda
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'VLR'    TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  ' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * Obtiene Codigo de Operacion Mediante CIC de Cta. Cte.
           MOVE 'TAB'    TO FIO-SIST.
           MOVE 'AUX'    TO TAB-CIC-TTAB IN TAB.
           MOVE 'CTE'    TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICCTACNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TOPR IN WSS-VARI.

      * Valor inicial de Nro. correlativo ( MVO )
           MOVE HOY-HHOY IN HOY-VARI TO WSS-NUM-CORG IN WSS-VARI.

      * Inicializa Variables
           MOVE ZEROES TO WSS-CONT IN WSS-VARI.

      * Se asumio '0000' para Centro de Asignacion Ctas. Ctes.
           MOVE ZEROES TO WSS-CAI-CCTE IN WSS-VARI.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      * Efectua la Apertura de Archivos distintos del Base
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           PERFORM SGC-FIO-DCP.
           PERFORM SGC-FIO-RCD.
           PERFORM SGC-FIO-REC.
           PERFORM SGC-FIO-OPE.
           PERFORM SGC-FIO-RCO.
           PERFORM COL-FIO-MVO.
      * Efectua la Apertura del Archivo SAM de JOURNAL
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM SGC-FIO-JCC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO JCC DE OUTPUT' FIO-STAT
               PERFORM GNS-PRO-ABT.
      * Efectua la Apertura del Archivo SAM de TARJETAS
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM SGC-FIO-BCT.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO BCT DE OUTPUT' FIO-STAT
               PERFORM GNS-PRO-ABT.
      * Efectua la Apertura del Archivo ESDS de JOURNAL GENERICO
           MOVE FIO-EXT TO FIO-CMND.
           PERFORM GNS-FIO-JGN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO JGN DE OUTPUT' FIO-STAT
               PERFORM GNS-PRO-ABT.

      * Inicializa Indice para asignar Ctas. Ctes. desde los rangos
           MOVE  1  TO WSS-SUP IN WSS-VARI.

      *DAD  Los archivos SAM no tienen habilitado el comando FIO-GET-FST luego..
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-TCC.
           GO TO INI-OUT-SRT.
      *>>>>
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
      * Efectua la Apertura del Reporte de ACEPTADOS
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
      * Efectua la Apertura del Reporte de RECHAZOS
           OPEN OUTPUT RPTRCH.
           INITIATE RPT-RCH.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           ADD  1  TO WSS-NUM-READ IN WSS-VARI.

      * Proceso de Validacion y Seleccion del registro TCC leido
           PERFORM VAL-REG-PRO.
           IF WSS-IND-ERRO IN WSS-VARI = 1
               ADD  1  TO WSS-NUM-RECH IN WSS-VARI
               GENERATE DL-RAY
               GO TO NXT-INP-SRT.
           ADD  1  TO WSS-NUM-REGP IN WSS-VARI.

      * Proceso de Lectura y Creacion del Registro DBC con registro TCC leido
           PERFORM BUS-REG-DBC.
           IF WSS-IND-ERRO IN WSS-VARI = 1
               ADD  1  TO WSS-NUM-RECH IN WSS-VARI
               GENERATE DL-RAY
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               GO TO NXT-INP-SRT.
           ADD  1  TO WSS-NUM-CLIP IN WSS-VARI.

      * Proceso de Validacion y Seleccion de la CTA. CTE.
           PERFORM VAL-CTA-CTE.
           IF WSS-IND-ERRO IN WSS-VARI = 1
               ADD  1  TO WSS-NUM-RECH IN WSS-VARI
               GENERATE DL-RAY
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               GO TO FIN-INP-SRT.
           ADD  1  TO WSS-NUM-CTAP IN WSS-VARI.

      * Proceso de Lectura y Creacion del Registro RCO con Cta. Cte. Asignada
           PERFORM BUS-REG-RCO.
           IF WSS-IND-ERRO IN WSS-VARI = 1
               ADD  1  TO WSS-NUM-RECH IN WSS-VARI
               GENERATE DL-RAY
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-RCO
               GO TO NXT-INP-SRT.
           ADD  1  TO WSS-NUM-ACEP IN WSS-VARI.

      * Proceso de llenado de los campos y listado de registro JCC ( Journal )
           COPY SGCRMACP.
           GENERATE DL-ACP.
           MOVE FIO-CHK-PNT TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           ADD 1 TO WSS-NRO-CCTA IN WSS-VARI.
           GO TO NXT-INP-SRT.
      *--------------------------------------------------------------
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
      * Efectua la Clausura de Archivos distintos del Base
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           PERFORM SGC-FIO-DCP.
           PERFORM SGC-FIO-RCD.
           PERFORM SGC-FIO-REC.
           PERFORM SGC-FIO-OPE.
           PERFORM SGC-FIO-RCO.
           PERFORM SGC-FIO-JCC.
           PERFORM SGC-FIO-BCT.
           PERFORM GNS-FIO-JGN.
           PERFORM COL-FIO-MVO.

      * Despliegue de los Totales de Control
           DISPLAY 'LOS REGISTROS LEIDOS     SON : '
                    WSS-NUM-READ IN WSS-VARI.
           DISPLAY 'LOS REGISTROS RECHAZADOS SON : '
                    WSS-NUM-RECH IN WSS-VARI.
           DISPLAY 'LOS REGISTROS ACEPTADOS  SON : '
                    WSS-NUM-ACEP IN WSS-VARI.
           DISPLAY 'PROCESADOS (VALIDACION INPUT DATOS) OK : '
                    WSS-NUM-REGP IN WSS-VARI.
           DISPLAY 'PROCESADOS (VALIDACION DEL CLIENTE) OK : '
                    WSS-NUM-CLIP IN WSS-VARI.
           DISPLAY 'PROCESADOS (VALIDACION DE CTA.CTE.) OK : '
                    WSS-NUM-CTAP IN WSS-VARI.
           DISPLAY 'LA ULTIMA CUENTA CORRIENTE ASIGNADA FUE : '
                   WSS-CTA-CCTE IN WSS-VARI.

           MOVE WSS-NUM-READ IN WSS-VARI TO WSS-NUM-READ IN WSS-RCH.
           MOVE WSS-NUM-RECH IN WSS-VARI TO WSS-NUM-RECH IN WSS-RCH.
           MOVE WSS-NUM-ACEP IN WSS-VARI TO WSS-NUM-ACEP IN WSS-ACP.
           MOVE WSS-NUM-REGP IN WSS-VARI TO WSS-NUM-REGP IN WSS-ACP.
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           TERMINATE RPT-RCH.
           CLOSE RPTRCH.
      *>>>>
*% END
*% IF FIN
      *<<<< FIN
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      *VAL-NUM Validacion numerica del rango Inferior de CTA. CTE.
       VAL-RNG-INFE SECTION.
       INI-VAL-RNG-INFE.
           IF WSS-ALF-ICTE IN WSS-VARI(WSS-I) > SPACES
               MOVE ZEROES TO WSS-NUM-SELE IN WSS-VARI
               MOVE WSS-ALF-ICTE IN WSS-VARI(WSS-I) TO NUM-NUME
               MOVE NUM-ZERO-S                      TO NUM-ZERO
               MOVE NUM-SGNO-N                      TO NUM-SGNO
               MOVE 8                               TO NUM-NENT
               MOVE 0                               TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE NUM-PENT TO WSS-NUM-SELE IN WSS-VARI
                   MOVE WSS-NUM-SELE IN WSS-VARI TO WSS-NUM-ICTE
                                                    IN WSS-VARI(WSS-I)
                   MOVE WSS-I IN WSS-VARI TO WSS-INF IN WSS-VARI
               ELSE
                   IF WSS-NUM-SELE IN WSS-VARI NOT > ZEROES
                       MOVE ZEROES TO WSS-NUM-ICTE IN WSS-VARI(WSS-I)
                       DISPLAY 'RANGO INFERIOR DE CTA. CTE. INVALIDO'
                                WSS-RNG-NINF IN WSS-VARI
                       PERFORM GNS-PRO-ABT.
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-RNG-INFE.
           EXIT.
      **************************************************************************
      *VAL-NUM Validacion numerica del rango Superior de CTA. CTE.
       VAL-RNG-SUPE SECTION.
       INI-VAL-RNG-SUPE.
           IF WSS-ALF-FCTE IN WSS-VARI(WSS-I) > SPACES
               MOVE ZEROES TO WSS-NUM-SELE IN WSS-VARI
               MOVE WSS-ALF-FCTE IN WSS-VARI(WSS-I) TO NUM-NUME
               MOVE NUM-ZERO-S                      TO NUM-ZERO
               MOVE NUM-SGNO-N                      TO NUM-SGNO
               MOVE 8                               TO NUM-NENT
               MOVE 0                               TO NUM-NDCM
               CALL 'GNSPVNUM' USING NUM-VARI
               IF NUM-STAT-OKS
                   MOVE NUM-PENT TO WSS-NUM-SELE IN WSS-VARI
                   MOVE WSS-NUM-SELE IN WSS-VARI TO WSS-NUM-FCTE
                                                    IN WSS-VARI(WSS-I)
                   MOVE WSS-I IN WSS-VARI TO WSS-SUP IN WSS-VARI
               ELSE
                   IF WSS-NUM-SELE IN WSS-VARI NOT > ZEROES
                       MOVE ZEROES TO WSS-NUM-FCTE IN WSS-VARI(WSS-I)
                       DISPLAY 'RANGO SUPERIOR DE CTA. CTE. INVALIDO'
                                WSS-RNG-NSUP IN WSS-VARI
                       PERFORM GNS-PRO-ABT.
           ADD 1 TO WSS-I IN WSS-VARI.
       FIN-VAL-RNG-SUPE.
           EXIT.
      **************************************************************************
      * Proceso de Validacion y Seleccion del registro TCC leido
       VAL-REG-PRO SECTION.
       INI-VAL-REG-PRO.
      *--------------------------------------------------------------
           COPY SGCRMRCH.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI
                       WSS-IND-NEXT IN WSS-VARI.
      *--------------------------------------------------------------
      * Valida Numero del RUT
           IF TCC-NUM-ICLI IN TCC NOT > ZEROES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE NUMERO DEL RUT SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Digito Verificador del RUT
           IF TCC-VRF-ICLI IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DEL DIGITO VERIFICADOR SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida RUT para campo IDC
           MOVE SPACES TO MSG-COD-MENS.
           MOVE TCC-NUM-ICLI IN TCC TO VRF-NUME.
           MOVE TCC-VRF-ICLI IN TCC TO VRF-DVRF.
           MOVE VRF-SVRF-K          TO VRF-SVRF.
           MOVE VRF-ZERO-S          TO VRF-ZERO.
           MOVE 7                   TO VRF-LMAX.
           MOVE ZEROES              TO VRF-STAT.
           MOVE VRF-VAL             TO VRF-CMND.
      * Procesa Digito Verificador
           CALL 'GNSPPVRF' USING VRF-VARI.
           IF VRF-STAT-OKS
               GO TO FIN-PRO-VRF.
           IF VRF-CMSG > SPACES
               MOVE VRF-CMSG     TO MSG-COD-MENS
           ELSE
               MOVE 'VRF    NOT' TO MSG-COD-MENS.
           MOVE 'GNS' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           IF MSG-COD-MENS > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-PRO-VRF.
           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE MSG-GLS-DESC IN MSG TO
      *         MOVE 'CAMPO DIGITO VERIFICADOR INVALIDO' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Apellido Paterno
           IF TCC-GLS-APAT IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE APELLIDO PATERNO SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Apellido Materno
           IF TCC-GLS-AMAT IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE APELLIDO MATERNO SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Nombres
           IF TCC-GLS-NOMB IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE NOMBRES SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Direccion
           IF TCC-GLS-DIRE IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE DIRECCION SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Comuna Direccion
           IF TCC-COD-LUGA IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE COMUNA SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Codigo Comuna con Codigos de Tabla COM
           MOVE TCC-COD-LUGA IN TCC TO WSS-COD-LUGA IN WSS-VARI.
           IF WSS-IND-PAIS IN WSS-VARI NOT = 'P'
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'COM'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   MOVE  1  TO WSS-IND-NEXT IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'PAI'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
      *         MOVE MSG-GLS-DESC IN MSG TO
               MOVE 'CAMPO DE COMUNA CON CODIGO INVALIDO' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Fecha Nacimiento
           MOVE TCC-NUM-DNAC IN TCC TO FEC-ITM1.
           MOVE TCC-NUM-MNAC IN TCC TO FEC-ITM2.
           MOVE TCC-NUM-SNAC IN TCC TO FEC-ITM3.
           MOVE TCC-NUM-ANAC IN TCC TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE FEC-MENS TO
      *         MOVE 'CAMPO DE FECHA CON FECHA INVALIDA' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Indicador de Sexo
           IF TCC-IND-SEXO IN TCC NOT > SPACES
      *         MOVE SPACES TO TCC-IND-SEXO IN TCC.
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE SEXO SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Indicador de Sexo con Codigos miscelaneos de Tabla MSC
           MOVE 'SGC'               TO MSC-COD-SIST.
           MOVE 'SEXO'              TO MSC-COD-TMSC IN MSC.
           MOVE TCC-IND-SEXO IN TCC TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
      *         MOVE MSG-GLS-DESC IN MSG TO
               MOVE 'CAMPO DE SEXO CON CODIGO INVALIDO' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Indicador de Estado Civil
           IF TCC-IND-ECIV IN TCC NOT > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
               MOVE 'CAMPO DE ESTADO CIVIL SIN INFORMACION' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
      * Valida Indicador de Estado Civil con Codigos miscelaneos de Tabla MSC
           MOVE 'SGC'               TO MSC-COD-SIST.
           MOVE 'ECIV'              TO MSC-COD-TMSC IN MSC.
           MOVE TCC-IND-ECIV IN TCC TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1 AND
              WSS-IND-ERRO IN WSS-VARI = 0
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               GENERATE DL-RCH.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE  0  TO WSS-IND-NEXT IN WSS-VARI
      *         MOVE MSG-GLS-DESC IN MSG TO
               MOVE 'CAMPO DE ESTADO CIVIL CON CODIGO INVALIDO' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-ERR.
      *--------------------------------------------------------------
       FIN-VAL-REG-PRO.
           EXIT.
      **************************************************************************
      * Proceso de Lectura y Creacion del Registro DBC con registro TCC leido
       BUS-REG-DBC SECTION.
       INI-BUS-REG-DBC.
      *--------------------------------------------------------------
           COPY SGCRMRCH.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI
                       WSS-IND-NEXT IN WSS-VARI.
      *--------------------------------------------------------------
      *VAL-RUT Valida Rut para campo IDC
           MOVE TCC-NUM-ICLI IN TCC TO WSS-NUM-ICLI IN WSS-VARI.
      *VAL-IDC Valida identificador
           MOVE SPACES              TO WSS-IND-ICLI IN WSS-VARI.
      *VAL-GLS Valida glosa ( extension ) de identificador
           MOVE SPACES              TO WSS-GLS-ICLI IN WSS-VARI.
      *--------------------------------------------------------------
      * Lee DBC con Rut leido
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               DISPLAY 'YA EXISTE CLIENTE : ' WSS-IDC-ICLI IN WSS-VARI
               MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI IN WSS-VARI
               GO TO CON-BUS-REG-DBC.
      *--------------------------------------------------------------
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
      * Obtener CIC con CIC-GET
           MOVE SPACES  TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE CIC-MENS IN CIC-VARI TO
      *         MOVE 'ERROR AL OBTENER CIC PARA CLIENTE NUEVO ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
           MOVE CIC-CIC-ICIC IN CIC TO WSS-CIC-ICLI IN WSS-VARI.
      *--------------------------------------------------------------
      * Crea cliente en DBC
      *
      * Inicializa registro Datos Basicos del Cliente
           MOVE SPACES TO DBC.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO DBC-STP-ITRN IN DBC.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO DBC-FEC-FTRN IN DBC.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO DBC-HRA-HRTR IN DBC.
      * Indicador Tipo Accion
           MOVE 'I'                      TO DBC-MSC-TACC IN DBC.
      * Indicador Status
           MOVE 'I'                      TO DBC-MSC-STAT IN DBC.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO DBC-COD-ATRN IN DBC.
      * Rut Cliente + Indicador o Calificador + Extension
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
      * Digito Verificador del Rut
           MOVE TCC-VRF-ICLI IN TCC      TO DBC-VRF-ICLI IN DBC.
      * Apellido Paterno Cliente
           MOVE TCC-GLS-APAT IN TCC      TO DBC-GLS-APAT IN DBC.
      * Apellido Materno Cliente
           MOVE TCC-GLS-AMAT IN TCC      TO DBC-GLS-AMAT IN DBC.
      * Nombres Cliente
           MOVE TCC-GLS-NOMB IN TCC      TO DBC-GLS-NOMB IN DBC.
      * Numero de Direccion de Envio Correspondencia
           MOVE 1                        TO DBC-NUM-DCOR IN DBC.
      * Ind Tipo Cliente ( Persona o Empresa )       SGC TICL
           MOVE 'P'                      TO DBC-IND-TICL IN DBC.
      * Tipo Cliente (Potencial,No Cliente,Grupo)    SGC TCL
           MOVE 'CL'                     TO DBC-COD-TICL IN DBC.
      * Codigo del Ejecutivo Encargado del Cliente   TAB USR
           MOVE WSS-COD-EJEC IN WSS-VARI TO DBC-COD-EJEC IN DBC.
      * Codigo de Oficina donde opera el Cliente     TAB OFI
           MOVE WSS-COD-OFIC IN WSS-VARI TO DBC-COD-OFIC IN DBC.
      * Indicador si opera en otra Oficina           SGC OOFI
           MOVE 'N'                      TO DBC-IND-OOFI IN DBC.
      * Codigo Actividad Economica                   TAB ACT
           MOVE WSS-COD-ACTI IN WSS-VARI TO DBC-COD-ACTI IN DBC.
      * Origen y Destino Sect (Comp.Inst)            TAB ODS
           MOVE '121'                    TO DBC-COD-ODSE IN DBC.
      * Fecha Ultima Declaracion Articulo 85
           MOVE ZEROES                   TO DBC-FEC-FA85 IN DBC.
      * Fecha Ultimo Pago Impuesto a la Renta
           MOVE ZEROES                   TO DBC-FEC-FUPI IN DBC.
      * Fecha Estado Cliente
           MOVE ZEROES                   TO DBC-FEC-FSCL IN DBC.
      * Numero Total de Direcciones
           MOVE 1                        TO DBC-NUM-TDIR IN DBC.
      * Numero Total de Comentarios
           MOVE ZEROES                   TO DBC-NUM-TCMT IN DBC.
      * Fecha Inicio Operacion
           MOVE DBC-FEC-FTRN IN DBC      TO DBC-FEC-FIOP IN DBC.
      * Fecha Termino Operacion
           MOVE ZEROES                   TO DBC-FEC-FTOP IN DBC.
      * Numero Operaciones Fecha Termino Nula
           MOVE ZEROES                   TO DBC-NUM-OFTN IN DBC.
      * Fecha Ingreso de Datos a la Base de Datos
           MOVE DBC-FEC-FTRN IN DBC      TO DBC-FEC-FINP IN DBC.
      * Identificacion Datos Basicos Clientes ( CLIENTE )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN DBC ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
      *--------------------------------------------------------------
      * Crea cliente en DCP
      *
      * Inicializa registro Datos Complementarios Personas
           MOVE SPACES TO DCP.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO DCP-STP-ITRN IN DCP.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO DCP-FEC-FTRN IN DCP.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO DCP-HRA-HRTR IN DCP.
      * Indicador Tipo Accion
           MOVE 'I'                      TO DCP-MSC-TACC IN DCP.
      * Indicador Status
           MOVE 'I'                      TO DCP-MSC-STAT IN DCP.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO DCP-COD-ATRN IN DCP.
      * Fecha de Nacimiento
           MOVE TCC-FEC-FNAC IN TCC      TO DCP-FEC-FNAC IN DCP.
      * Codigo del Pais de la Nacionalidad           TAB PAI
           MOVE '997'                    TO DCP-COD-PNAC IN DCP.
      * Indicador de Sexo                            TAB SEXO
           MOVE TCC-IND-SEXO IN TCC      TO DCP-IND-SEXO IN DCP.
      * Indicador de Estado Civil                    TAB ECIV
           MOVE TCC-IND-ECIV IN TCC      TO DCP-IND-ECIV IN DCP.
      * Cedula de Identidad
           MOVE WSS-NUM-ICLI IN WSS-VARI TO DCP-NUM-CIDE IN DCP.
      * Digito Verificador Cedula Identidad
           MOVE TCC-VRF-ICLI IN TCC      TO DCP-VRF-CIDE IN DCP.
      * Gabinete Cedula de Identidad
           MOVE 'SANTIAGO'               TO DCP-GLS-GABI IN DCP.
      * Codigo Tipo Banca                            SGC BAN
           MOVE 'P'                      TO DCP-COD-TBAN IN DCP.
      * # Msj Asoc a Nombre de Pila (SBT)
           MOVE ZEROES                   TO DCP-NUM-NMSG IN DCP.
      * Indicador Regimen Conyugal                   SGC RCNY
           IF DCP-IND-ECIV IN DCP = 'CAS'
               MOVE '1' TO DCP-IND-RCNY IN DCP.
      * Identificacion Datos Complementarios Personas ( CLIENTE )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN DCP ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
      *--------------------------------------------------------------
      * Crea cliente en RCD
      *
      * Inicializa registro Relacion Cliente Direcciones
           MOVE SPACES TO RCD.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO RCD-STP-ITRN IN RCD.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO RCD-FEC-FTRN IN RCD.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO RCD-HRA-HRTR IN RCD.
      * Indicador Tipo Accion
           MOVE 'I'                      TO RCD-MSC-TACC IN RCD.
      * Indicador Status
           MOVE 'I'                      TO RCD-MSC-STAT IN RCD.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO RCD-COD-ATRN IN RCD.
      * Tipo Direccion                               SGC TDIR
           MOVE RCD-MSC-DOMI IN RCD-VARI TO RCD-MSC-TDIR IN RCD.
      * Estado Direccion ( Mala, Verificada, etc )   SGC SDIR
           MOVE 'C'                      TO RCD-MSC-SDIR IN RCD.
      * Fecha de Verificacion
           MOVE ZEROES                   TO RCD-FEC-FVRF IN RCD.
      * Descripcion de la Direccion
           MOVE TCC-GLS-DIRE IN TCC      TO RCD-GLS-DIRE IN RCD.
      * Codigo de Lugar ( Comuna )                   TAB COM
           MOVE TCC-COD-LUGA IN TCC      TO RCD-COD-LUGA IN RCD.
      * Telefono de la Direccion
           MOVE '0'                      TO RCD-GLS-FONO IN RCD.
      * Identificacion Relacion Cliente Direcciones ( CLIENTE + Nro.Dir. )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO RCD-CIC-ICLI IN RCD.
           MOVE 1                        TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN RCD ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
      *--------------------------------------------------------------
       CON-BUS-REG-DBC.
      * Deja leida entidad RCD ( Direcciones )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO RCD-CIC-ICLI IN RCD.
           MOVE 1                        TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL LEER DIRECCION 1 DE CLIENTE EN RCD ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
      *--------------------------------------------------------------
      * Lee Ultima Relacion del Cliente en REC ( EM )
           MOVE ZEROES                   TO WSS-NUM-TREC IN WSS-VARI.
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-ICLI IN REC.
           MOVE REC-COD-EMPL IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-IREL IN REC.
           MOVE 99                       TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CIC-ICLI IN REC = WSS-CIC-EMPL IN WSS-VARI AND
              REC-CIC-IREL IN REC = WSS-CIC-ICLI IN WSS-VARI AND
              REC-COD-TREC IN REC = REC-COD-EMPL IN REC-VARI
      *         MOVE REC-NUM-TREC IN REC TO WSS-NUM-TREC IN WSS-VARI.
               DISPLAY 'YA EXISTE RELACION ( EM ): ' REC-KEY-IREC IN REC
               GO TO RFU-BUS-REG-DBC.
           ADD 1 TO WSS-NUM-TREC IN WSS-VARI.

      * Crea cliente en REC ( EM )
      *
      * Inicializa registro Relacion entre Clientes
           MOVE SPACES TO REC.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO REC-FEC-FTRN IN REC.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO REC-HRA-HRTR IN REC.
      * Indicador Tipo Accion
           MOVE 'I'                      TO REC-MSC-TACC IN REC.
      * Indicador Status
           MOVE 'I'                      TO REC-MSC-STAT IN REC.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO REC-COD-ATRN IN REC.
      * Indicador de Vigencia Relacion (S/N)         TAB VIGE
           MOVE 'S'                      TO REC-IND-VIGE IN REC.
      * Fecha Inicio de la Relacion
           MOVE REC-FEC-FTRN IN REC      TO REC-FEC-FINI IN REC.
      * Fecha Inicio Computacional
           MOVE ZEROES                   TO REC-FEC-FINP IN REC.
      * Fecha de Termino de la Relacion
           MOVE ZEROES                   TO REC-FEC-FTER IN REC.
      * Fecha de Termino Computacional
           MOVE ZEROES                   TO REC-FEC-FOUT IN REC.
      * Codigo Asociado a la Relacion                SGC REC
           MOVE SPACES                   TO REC-COD-AREC IN REC.
      * Valor Asociado a la Relacion
           MOVE ZEROES                   TO REC-SGV-AREC IN REC.
      * Codigo de Valor Asociado a la Relacion       TAB VLR
           MOVE SPACES                   TO REC-COD-VCAM IN REC.
      * Fecha Referencia Valor Asociado a Relacion
           MOVE ZEROES                   TO REC-FEC-FVAL IN REC.
      * Fecha de Verificacion
           MOVE ZEROES                   TO REC-FEC-FVRF IN REC.
      * Identificacion Relacion entre Clientes ( CLIENTE + Cod.Rel. + Nro.Rel.)
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-ICLI IN REC.
           MOVE REC-COD-EMPL IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-IREL IN REC 
           MOVE WSS-NUM-TREC IN WSS-VARI TO REC-NUM-TREC IN REC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN REC (EM) ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.

       RFU-BUS-REG-DBC.
      * Lee Ultima Relacion del Cliente en REC ( FU )
           MOVE ZEROES                   TO WSS-NUM-TREC IN WSS-VARI.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-ICLI IN REC 
           MOVE REC-COD-FUNC IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-IREL IN REC.
           MOVE 99                       TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CIC-ICLI IN REC = WSS-CIC-ICLI IN WSS-VARI AND
              REC-CIC-IREL IN REC = WSS-CIC-EMPL IN WSS-VARI AND
              REC-COD-TREC IN REC = REC-COD-FUNC IN REC-VARI
      *         MOVE REC-NUM-TREC IN REC TO WSS-NUM-TREC IN WSS-VARI.
               DISPLAY 'YA EXISTE RELACION ( FU ): ' REC-KEY-IREC IN REC
               GO TO RPP-BUS-REG-DBC.
           ADD 1 TO WSS-NUM-TREC IN WSS-VARI.

      * Crea cliente en REC ( FU )
      *
      * Inicializa registro Relacion entre Clientes
           MOVE SPACES TO REC.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO REC-FEC-FTRN IN REC.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO REC-HRA-HRTR IN REC.
      * Indicador Tipo Accion
           MOVE 'I'                      TO REC-MSC-TACC IN REC.
      * Indicador Status
           MOVE 'I'                      TO REC-MSC-STAT IN REC.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO REC-COD-ATRN IN REC.
      * Indicador de Vigencia Relacion (S/N)         TAB VIGE
           MOVE 'S'                      TO REC-IND-VIGE IN REC.
      * Fecha Inicio de la Relacion
           MOVE REC-FEC-FTRN IN REC      TO REC-FEC-FINI IN REC.
      * Fecha Inicio Computacional
           MOVE ZEROES                   TO REC-FEC-FINP IN REC.
      * Fecha de Termino de la Relacion
           MOVE ZEROES                   TO REC-FEC-FTER IN REC.
      * Fecha de Termino Computacional
           MOVE ZEROES                   TO REC-FEC-FOUT IN REC.
      * Codigo Asociado a la Relacion                SGC REC
           MOVE SPACES                   TO REC-COD-AREC IN REC.
      * Valor Asociado a la Relacion
           MOVE ZEROES                   TO REC-SGV-AREC IN REC.
      * Codigo de Valor Asociado a la Relacion       TAB VLR
           MOVE SPACES                   TO REC-COD-VCAM IN REC.
      * Fecha Referencia Valor Asociado a Relacion
           MOVE ZEROES                   TO REC-FEC-FVAL IN REC.
      * Fecha de Verificacion
           MOVE ZEROES                   TO REC-FEC-FVRF IN REC.
      * Identificacion Relacion entre Clientes ( CLIENTE + Cod.Rel. + Nro.Rel.)
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-ICLI IN REC 
           MOVE REC-COD-FUNC IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-IREL IN REC.
           MOVE WSS-NUM-TREC IN WSS-VARI TO REC-NUM-TREC IN REC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN REC (FU) ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.

       RPP-BUS-REG-DBC.
      * Lee Ultima Relacion del Cliente en REC ( PP )
           MOVE ZEROES                   TO WSS-NUM-TREC IN WSS-VARI.
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-ICLI IN REC 
           MOVE REC-COD-PRES IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-IREL IN REC.
           MOVE 99                       TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CIC-ICLI IN REC = WSS-CIC-ICLI IN WSS-VARI AND
              REC-CIC-IREL IN REC = WSS-CIC-EMPL IN WSS-VARI AND
              REC-COD-TREC IN REC = REC-COD-PRES IN REC-VARI
      *         MOVE REC-NUM-TREC IN REC TO WSS-NUM-TREC IN WSS-VARI.
               DISPLAY 'YA EXISTE RELACION ( PP ): ' REC-KEY-IREC IN REC
               GO TO FIN-BUS-REG-DBC.
           ADD 1 TO WSS-NUM-TREC IN WSS-VARI.

      * Crea cliente en REC ( PP )
      *
      * Inicializa registro Relacion entre Clientes
           MOVE SPACES TO REC.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO REC-FEC-FTRN IN REC.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO REC-HRA-HRTR IN REC.
      * Indicador Tipo Accion
           MOVE 'I'                      TO REC-MSC-TACC IN REC.
      * Indicador Status
           MOVE 'I'                      TO REC-MSC-STAT IN REC.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO REC-COD-ATRN IN REC.
      * Indicador de Vigencia Relacion (S/N)         TAB VIGE
           MOVE 'S'                      TO REC-IND-VIGE IN REC.
      * Fecha Inicio de la Relacion
           MOVE REC-FEC-FTRN IN REC      TO REC-FEC-FINI IN REC.
      * Fecha Inicio Computacional
           MOVE ZEROES                   TO REC-FEC-FINP IN REC.
      * Fecha de Termino de la Relacion
           MOVE ZEROES                   TO REC-FEC-FTER IN REC.
      * Fecha de Termino Computacional
           MOVE ZEROES                   TO REC-FEC-FOUT IN REC.
      * Codigo Asociado a la Relacion                SGC REC
           MOVE SPACES                   TO REC-COD-AREC IN REC.
      * Valor Asociado a la Relacion
           MOVE ZEROES                   TO REC-SGV-AREC IN REC.
      * Codigo de Valor Asociado a la Relacion       TAB VLR
           MOVE SPACES                   TO REC-COD-VCAM IN REC.
      * Fecha Referencia Valor Asociado a Relacion
           MOVE ZEROES                   TO REC-FEC-FVAL IN REC.
      * Fecha de Verificacion
           MOVE ZEROES                   TO REC-FEC-FVRF IN REC.
      * Identificacion Relacion entre Clientes ( CLIENTE + Cod.Rel. + Nro.Rel.)
           MOVE WSS-CIC-ICLI IN WSS-VARI TO REC-CIC-ICLI IN REC 
           MOVE REC-COD-PRES IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE WSS-CIC-EMPL IN WSS-VARI TO REC-CIC-IREL IN REC.
           MOVE WSS-NUM-TREC IN WSS-VARI TO REC-NUM-TREC IN REC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR CLIENTE NUEVO EN REC (PP) ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-DBC.
      *--------------------------------------------------------------
       FIN-BUS-REG-DBC.
           EXIT.
      **************************************************************************
      * Proceso de Validacion y Seleccion de la CTA. CTE.
       VAL-CTA-CTE SECTION.
       INI-VAL-CTA-CTE.
      *--------------------------------------------------------------
           COPY SGCRMRCH.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI.
           MOVE WSS-SUP IN WSS-VARI TO WSS-I IN WSS-VARI.
      *--------------------------------------------------------------
       LUP-VAL-CTA-CTE.
           MOVE WSS-NRO-CCTA IN WSS-VARI TO WSS-CTA-CCTE IN WSS-VARI.
           MOVE WSS-NUM-CCTE IN WSS-VARI TO VRF-NUME.
           MOVE WSS-VRF-CCTE IN WSS-VARI TO VRF-DVRF.
           MOVE VRF-ZERO-S               TO VRF-ZERO.
           MOVE VRF-SVRF-1               TO VRF-SVRF.
           MOVE 8                        TO VRF-LMAX.
           MOVE VRF-VAL                  TO VRF-CMND.
           MOVE ZEROES                   TO VRF-STAT.
           CALL 'GNSPPVRF' USING VRF-VARI.
           IF VRF-CMSG > SPACES OR
              NOT VRF-STAT-OKS
               ADD 1 TO WSS-NRO-CCTA IN WSS-VARI
               GO TO LUP-VAL-CTA-CTE.

           IF WSS-I IN WSS-VARI < WSS-INF IN WSS-VARI
               IF WSS-NRO-CCTA IN WSS-VARI < WSS-NUM-ICTE IN
                                                     WSS-VARI(WSS-I) OR
                  WSS-NRO-CCTA IN WSS-VARI > WSS-NUM-FCTE IN
                                                     WSS-VARI(WSS-I)
                   ADD 1 TO WSS-I IN WSS-VARI
                   MOVE WSS-NUM-ICTE IN WSS-VARI(WSS-I) TO
                                        WSS-NRO-CCTA IN WSS-VARI
                   GO TO LUP-VAL-CTA-CTE
               ELSE
                   NEXT SENTENCE
           ELSE
               IF WSS-NRO-CCTA IN WSS-VARI < WSS-NUM-ICTE IN
                                                     WSS-VARI(WSS-I) OR
                  WSS-NRO-CCTA IN WSS-VARI > WSS-NUM-FCTE IN
                                                     WSS-VARI(WSS-I)
                   MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'OPENORNGCCTE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO
      *             MOVE 'SE TERMINARON LOS NUMEROS DE CTAS. CTES. ' TO
                               WSS-GLS-MENS IN WSS-RCH
                   GENERATE DL-RCH
                   GENERATE DL-ERR
                   GO TO FIN-VAL-CTA-CTE.

      * Marca Indice para continuar asignacion Ctas. Ctes. desde los rangos
           MOVE WSS-I IN WSS-VARI TO WSS-SUP IN WSS-VARI.
      *--------------------------------------------------------------
       FIN-VAL-CTA-CTE.
           EXIT.
      **************************************************************************
      * Proceso de Lectura y Creacion del Registro RCO con Cta. Cte. Asignada
       BUS-REG-RCO SECTION.
       INI-BUS-REG-RCO.
      *--------------------------------------------------------------
           COPY SGCRMRCH.
           MOVE  0  TO WSS-IND-ERRO IN WSS-VARI
                       WSS-IND-NEXT IN WSS-VARI.
      *--------------------------------------------------------------
      * Centro de Asignacion
           MOVE WSS-CAI-CCTE IN WSS-VARI TO WSS-CAI-IOPE IN WSS-VARI.
      * Cta. Cte. Asignada
           MOVE WSS-CTA-CCTE IN WSS-VARI TO WSS-IIC-IOPE IN WSS-VARI.
      *--------------------------------------------------------------
      * Lee RCO con CIC Cliente + Centro de Asignacion + '99'
           MOVE WSS-CIC-ICLI IN WSS-VARI TO RCO-CIC-ICLI IN RCO.
           MOVE WSS-CAI-IOPE IN WSS-VARI TO RCO-CAI-IOPE IN RCO.
           MOVE SPACES                   TO RCO-IIC-IOPE IN RCO.
           MOVE '99'                     TO RCO-COD-SOPE IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS AND
              RCO-CIC-ICLI IN RCO = WSS-CIC-ICLI IN WSS-VARI AND
              RCO-CAI-IOPE IN RCO = WSS-CAI-IOPE IN WSS-VARI AND
              RCO-COD-SOPE IN RCO = '99'
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               STRING 'YA TIENE OPERACION CON CTA. PRIMA : '
                       RCO-CIC-IOPE IN RCO DELIMITED BY SIZE INTO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Crea operacion en OPE
      *
      * Inicializa registro Operaciones
           MOVE SPACES TO OPE.
      *     PERFORM GET-FHOY.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO OPE-STP-ITRN IN OPE.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO OPE-FEC-FTRN IN OPE.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO OPE-HRA-HRTR IN OPE.
      * Indicador Status
           MOVE 'I'                      TO OPE-MSC-STAT IN OPE.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO OPE-COD-ATRN IN OPE.
      * Codigo Status                                TAB STA
           MOVE 'VIG'                    TO OPE-COD-STAT IN OPE.
      * Valor de Cambio Operacion                    TAB VLR
           MOVE WSS-COD-PESO IN WSS-VARI TO OPE-COD-VCOP IN OPE.
      * Codigo Clase Operacion                       TAB AUX
      * Codigo Tipo Operacion                        TAB TIO
           MOVE WSS-COD-TOPR IN WSS-VARI TO OPE-COD-COPR IN OPE.
      * Codigo Oficina                               TAB OFI
           MOVE WSS-COD-OFIC IN WSS-VARI TO OPE-COD-OFOP IN OPE.
      * Ejecutivo                                    TAB USR
           MOVE WSS-COD-EJEC IN WSS-VARI TO OPE-COD-EJOP IN OPE.
      * Fecha Inicio Operacion
           MOVE OPE-FEC-FTRN IN OPE      TO OPE-FEC-FIOP IN OPE.
      * Fecha Termino Operacion
           MOVE ZEROES                   TO OPE-FEC-FTOP IN OPE.
      * Fecha Reapertura Operacion
           MOVE ZEROES                   TO OPE-FEC-FROP IN OPE.
      * Ind Multiples Clientes ( Y, O, etc)          SGC MCL
           MOVE SPACES                   TO OPE-IND-MCLI IN OPE.
      * Codigo Tipo de Comision
           MOVE WSS-COD-TCOM IN WSS-VARI TO OPE-COD-TCOM IN OPE.
      * Cod. Int. Comp. Operacion de Cargo
           MOVE WSS-CIC-ICAR IN WSS-VARI TO OPE-CIC-ICAR IN OPE.
      * Identificacion Operacion ( CTA.CTE. )
           MOVE WSS-CIC-IOPE IN WSS-VARI TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN OPE ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Crea operacion en RCO
      *
      * Inicializa registro Relacion Cliente Operacion
           MOVE SPACES TO RCO.
      * Time Stamp Transaccion
      *     MOVE HOY-STP-ITRN IN HOY-VARI TO RCO-STP-ITRN IN RCO.
      * Fecha Transaccion
           MOVE WSS-FEC-FTRN IN WSS-VARI TO RCO-FEC-FTRN IN RCO.
      * Hora Transaccion
           MOVE WSS-HRA-HRTR IN WSS-VARI TO RCO-HRA-HRTR IN RCO.
      * Indicador Status
           MOVE 'I'                      TO RCO-MSC-STAT IN RCO.
      * Autor Transaccion
           MOVE WSS-COD-IPRO IN WSS-VARI TO RCO-COD-ATRN IN RCO.
      * Codigo Status                                TAB STA
           MOVE 'VIG'                    TO RCO-COD-STAT IN RCO.
      * Cod Relacion Cliente Operacion               TAB RCO
           MOVE 'DIR'                    TO RCO-COD-RCOP IN RCO.
      * Numero de Direccion
      *     MOVE 1                        TO RCO-NUM-DIRE IN RCO.
           MOVE RCD-NUM-DIRE IN RCD      TO RCO-NUM-DIRE IN RCO.
      * Porcentaje Relacion
           MOVE 100                      TO RCO-VAL-PRCO IN RCO.
      * Codigo Clase Operacion                       TAB AUX
      * Codigo Tipo Operacion                        TAB TIO
           MOVE WSS-COD-TOPR IN WSS-VARI TO RCO-COD-COPR IN RCO.
      * Identificacion Relacion Cliente Operacion ( CLIENTE + CTA.CTE. )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO RCO-CIC-ICLI IN RCO.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN RCO ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Llenado de los campos y Grabado del Archivo JCC ( Journal )
           MOVE TCC-NUM-ICLI IN TCC TO JCC-NUM-ICLI IN JCC.
           MOVE TCC-VRF-ICLI IN TCC TO JCC-VRF-ICLI IN JCC.
           MOVE TCC-GLS-NOMC IN TCC TO JCC-GLS-NOMC IN JCC.
           MOVE TCC-GLS-DIRE IN TCC TO JCC-GLS-DIRE IN JCC.
           MOVE TCC-COD-LUGA IN TCC TO JCC-COD-LUGA IN JCC.
           MOVE TCC-FEC-FNAC IN TCC TO JCC-FEC-FNAC IN JCC.
           MOVE TCC-IND-SEXO IN TCC TO JCC-IND-SEXO IN JCC.
           MOVE TCC-IND-ECIV IN TCC TO JCC-IND-ECIV IN JCC.
           MOVE OPE-CIC-IOPE IN OPE TO JCC-CIC-IOPE IN JCC.
           MOVE SPACES              TO JCC-GLS-DISP IN JCC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-JCC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN JCC ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Llenado de los campos y Grabado del Archivo JGN ( Journal )
           MOVE WSS-CIC-ICLI IN WSS-VARI TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL LEER CLIENTE EN DBC PARA JGN ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
           MOVE LOW-VALUES TO JGN.
      *    Codigo de Transaccion
           MOVE 9001                 TO BCD-DAT2-INT IN BCD-VARI.
           MOVE BCD-DAT2 IN BCD-VARI TO JGN-COD-TRAN IN JGN.
      *    Sucursal
           MOVE OPE-COD-OFOP IN OPE  TO JGN-COD-SUCU IN JGN.
      *    Filler
           MOVE SPACES               TO JGN-GLS-FIL1 IN JGN.
      *    Largo de Datos
           MOVE 77                   TO JGN-GLS-LDAT IN JGN.
      *    Filler
           MOVE SPACES               TO JGN-GLS-FIL2 IN JGN.
      *    Fecha
           PERFORM GET-FHOY.
           MOVE HOY-AHOY      IN HOY-VARI TO WSS-NUM-AHOY  IN WSS-VARI.
           MOVE HOY-MHOY      IN HOY-VARI TO WSS-NUM-MHOY  IN WSS-VARI.
           MOVE HOY-DHOY      IN HOY-VARI TO WSS-NUM-DHOY  IN WSS-VARI.
           MOVE WSS-FEC-FHOY  IN WSS-VARI TO BCD-DAT3-EBCD IN BCD-VARI.
           MOVE BCD-DAT3-EBCD IN BCD-VARI TO BCD-DAT3-INT  IN BCD-VARI.
           MOVE BCD-DAT3      IN BCD-VARI TO JGN-FEC-FHOY  IN JGN.
      *    Rut
           MOVE DBC-NUM-ICLI IN DBC TO WSS-GLS-RUT IN WSS-VARI.
           IF DBC-VRF-ICLI IN DBC NOT = 'K'
               MOVE ZEROES              TO WSS-FILLER    IN WSS-VARI
               MOVE DBC-VRF-ICLI IN DBC TO WSS-NUM-VRF   IN WSS-VARI
               MOVE WSS-RUT IN WSS-VARI TO BCD-DAT6-EBCD IN BCD-VARI
               MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT6 IN BCD-VARI TO JGN-GLS-RUT IN JGN
           ELSE
               MOVE ZEROES                   TO WSS-FIL1 IN WSS-VARI
               MOVE WSS-NUM-RUT  IN WSS-VARI TO WSS-GLS-SINB IN WSS-VARI
               MOVE WSS-SIN-BRUT IN WSS-VARI TO BCD-DAT5-EBCD IN 
                                                        BCD-VARI
               MOVE BCD-DAT5-EBCD IN BCD-VARI TO BCD-DAT5-INT IN 
                                                        BCD-VARI
               MOVE BCD-DAT5    IN BCD-VARI TO WSS-NUM-BRUT IN WSS-VARI
               MOVE WSS-NUM-DIG IN WSS-VARI TO WSS-DIG IN WSS-VARI
               MOVE WSS-DIG     IN WSS-VARI TO WSS-AUX IN WSS-VARI
               MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                        WSS-AUX IN WSS-VARI
               ADD 11 TO WSS-AUX IN WSS-VARI
               MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI
               MOVE WSS-AUX-DLI2        TO WSS-VRF-BRUT IN WSS-VARI
               MOVE WSS-BCD-RUT IN WSS-VARI TO JGN-GLS-RUT IN JGN.
      *    Delimitador
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 15 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING 
                                              WSS-AUX IN WSS-VARI.
           ADD 13 TO WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2        TO JGN-GLS-DLI1 IN JGN.
      *    Nombre
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-GLS-NOMC IN DBC TO JGN-GLS-NOMB IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2        TO JGN-GLS-DLI2 IN JGN.
      *    Cuenta Corriente Apertura
           MOVE '09'                      TO WSS-NUM-DIGA IN WSS-VARI.
           MOVE OPE-IIC-IOPE  IN OPE      TO WSS-IIC-OPEA IN WSS-VARI.
           MOVE WSS-CIC-OPEA  IN WSS-VARI TO BCD-DAT5-EBCD IN BCD-VARI.
           MOVE BCD-DAT5-EBCD IN BCD-VARI TO BCD-DAT5-INT IN BCD-VARI.
           MOVE BCD-DAT5      IN BCD-VARI TO JGN-IIC-ACCT IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2        TO JGN-GLS-DLI3 IN JGN.
      *    Direccion
           MOVE RCD-GLS-DIRE IN RCD TO JGN-GLS-DIRE IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2        TO JGN-GLS-DLI4 IN JGN.
      *    Actividad
           IF DBC-COD-ACTI IN DBC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'ACT'               TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB TO WSS-CIC-ACTI IN WSS-VARI
               MOVE WSS-CIC-ACT1 TO BCD-DAT1-EBCD IN BCD-VARI
               MOVE BCD-DAT1-EBCD IN BCD-VARI TO BCD-DAT1-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT1 IN BCD-VARI TO JGN-COD-ACTI IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI5 IN JGN.
      *    Filler
           MOVE SPACES       TO JGN-GLS-FIL3 IN JGN.
      *    Filler
           MOVE SPACES       TO JGN-GLS-FIL5 IN JGN.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM GNS-FIO-JGN.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN JGN ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Llenado de los campos y Grabado del Archivo BCT ( Tarjetas )
           MOVE OPE-IIC-IOPE IN OPE TO BCT-IIC-IOPE IN BCT.
           MOVE OPE-COD-OFOP IN OPE TO BCT-COD-OFOP IN BCT.
           MOVE OPE-COD-EJOP IN OPE TO BCT-COD-EJOP IN BCT.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-BCT.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN BCT ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
      * Llenado de los campos y Grabado del Archivo MVO ( Movimientos )
           ADD  1                        TO WSS-NUM-CORG IN WSS-VARI.
      * Inicializa registro Movimientos Operaciones al sistema en linea
           MOVE SPACES TO MVO.
      * Fecha Ingreso del Movimiento
      *     MOVE HOY-FHOY IN HOY-VARI     TO MVO-FEC-FIMV IN MVO.
           MOVE WSS-FEC-FTRN IN WSS-VARI TO MVO-FEC-FIMV IN MVO.
      * Codigo Origen del movimiento
           MOVE 'SGC '                   TO MVO-COD-TORG IN MVO.
      * Indicador Correlativo Por Origen del Movimiento
           MOVE WSS-NUM-CORG IN WSS-VARI TO MVO-NUM-CORG IN MVO.
      * Fecha del Movimiento
      *     MOVE HOY-FHOY IN HOY-VARI     TO MVO-FEC-FMVO IN MVO.
           MOVE WSS-FEC-FTRN IN WSS-VARI TO MVO-FEC-FMVO IN MVO.
      * Numero Unico Operacion
           MOVE ZEROES                   TO MVO-CIC-NUOP IN MVO.
      * Codigo de Ambiente de Generacion
           MOVE 'S'                      TO MVO-COD-AMBT IN MVO.
      * Codigo modalidad
           MOVE 'L'                      TO MVO-COD-MODA IN MVO.
      * Identificacion Terminal Fisico
           MOVE WSS-NUM-TERM IN WSS-VARI TO MVO-COD-TERM IN MVO.
      * Estado de proceso
           MOVE 'I '                     TO MVO-COD-EPRC IN MVO.
      * Tipo Origen Para Cuadratura
           MOVE ZEROES                   TO MVO-COD-TCUA IN MVO.
      * Codigo Sistema de Abono
           MOVE 'CCT'                    TO MVO-COD-SIAB IN MVO.
      * Codigo de Transaccion de Abono
           MOVE '0370 '                  TO MVO-COD-TRAB IN MVO.
      * Indicador Orden Proceso Movimiento
           MOVE '9'                      TO MVO-IND-OPMV IN MVO.
      * Valor del Movimiento
           MOVE ZEROES                   TO MVO-SGV-VMVO IN MVO.
      * Msj. Disconformidad Firma y Forma Cta. Cargo
           MOVE '000'                    TO MVO-IND-DFCR IN MVO.
      * Codigo Operacion de Abono
           MOVE OPE-CIC-IOPE IN OPE      TO MVO-CIC-OPAB IN MVO.
      * Indicador Llave Supervisor Transaccion Abono
           MOVE 'S'                      TO MVO-IND-KESA IN MVO.
      * Numero de Lote Cuadratura
           MOVE ZEROES                   TO MVO-NUM-LCUA IN MVO.
      * Hora Ingreso Movimiento
           MOVE WSS-HRA-HRTR IN WSS-VARI TO MVO-HRA-HRMV IN MVO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-MVO.
           IF NOT FIO-STAT-OKS
               MOVE  1  TO WSS-IND-ERRO IN WSS-VARI
               MOVE 'ERROR AL GRABAR OPERACION NUEVA EN MVO ' TO
                           WSS-GLS-MENS IN WSS-RCH
               GENERATE DL-RCH
               GENERATE DL-ERR
               GO TO FIN-BUS-REG-RCO.
      *--------------------------------------------------------------
       FIN-BUS-REG-RCO.
           EXIT.
      **************************************************************************

       COPY GNSBFMSC.
       COPY GNSBFCIC.
       COPY GNSBFJGN.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFRCD.
       COPY SGCBFREC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY SGCBFJCC.
       COPY SGCBFBCT.
       COPY COLBFMVO.

       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCIC.
       COPY GNSBGCPT.
      *>>>>
*% END
