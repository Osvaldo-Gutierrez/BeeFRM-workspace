*%! Codigo adicional para archivo
*% IF INI_PUT_ALL_DBE AND PGM_ARG
      *<<<< INI_PUT_ALL_DBE
           MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE.
           MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
              MOVE 01 TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE DBC-STP-ITRN IN DBC TO SCR-UMOD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-STAT TO PGM-STAT-DCE.
           IF FIO-STAT-OKS
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-RCD
              MOVE FIO-STAT TO PGM-STAT-RCD.
      *>>>>
*% END
*% IF FIN_PUT_ALL_DBE
      *<<<< FIN_PUT_ALL_DBE
*% IF NOT PGM_PER
      *DAD ini  09-FEB-1994
      *     IF RCD-COD-LUGA IN DBE-FLD > SPACES
      *         MOVE RCD-COD-LUGA IN DBE-FLD TO WSS-COD-LUGA
      *         IF WSS-IND-PAIS = 'P'
      *             MOVE 'TAB'        TO TAB-COD-SIST
      *             MOVE 'PAI'        TO TAB-COD-TTAB IN TAB
      *             MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
      *             PERFORM BUS-TAB
      *             MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
      *         ELSE
      *             MOVE 'TAB'                   TO TAB-COD-SIST
      *             MOVE 'COM'                   TO TAB-COD-TTAB IN TAB
      *             MOVE RCD-COD-LUGA IN DBE-FLD TO TAB-COD-CTAB IN TAB
      *             PERFORM BUS-TAB
      *             MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD.
      *DAD fin  09-FEB-1994
*% END
       GET-FRM-IND-ERCC.
           MOVE SPACES TO REC-KEY-IREC IN REC.
           MOVE DBC-CAI-ICLI IN DBE-FLD TO REC-CAI-ICLI IN REC.
           MOVE DBC-IIC-ICLI IN DBE-FLD TO REC-IIC-ICLI IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GET-FRM-IND-ERCC.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO FRM-IND-ERCC IN DBE-FLD
*% IF PGM_PER
               GO TO GET-FRM-GLS-RBCO.
*% ELSE
               GO TO FIN-GET-FRM-IND-ERCC.
*% END
           IF REC-CAI-ICLI IN REC = DBC-CAI-ICLI IN DBE-FLD AND
              REC-IIC-ICLI IN REC = DBC-IIC-ICLI IN DBE-FLD
               IF REC-IND-VIGE IN REC = 'N' OR
                  REC-COD-TREC IN REC = REC-COD-RBCO
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-GET-FRM-IND-ERCC
               ELSE
                   MOVE 'S' TO FRM-IND-ERCC IN DBE-FLD
           ELSE
               MOVE 'N' TO FRM-IND-ERCC IN DBE-FLD.
*% IF NOT PGM_PER
       FIN-GET-FRM-IND-ERCC.
           EXIT.
*% END
       GET-FRM-GLS-RBCO.
           PERFORM BUS-PPU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DCOR TO FRM-GLS-RBCO IN DBE-FLD
           ELSE
               PERFORM CIC-PPU
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DCOR TO FRM-GLS-RBCO IN DBE-FLD
               ELSE
                   MOVE DBC-CAI-ICLI IN DBE-FLD TO PPU-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBE-FLD TO PPU-IIC-ICLI
                   PERFORM BUS-RCU
                   MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RBCO IN DBE-FLD. 
      *>>>>
*% END
*% IF INI_PUT_DBC_DBE AND (PGM_CHI OR PGM_ARG)
      *<<<< INI_PUT_DBC_DBE AND (PGM_CHI OR PGM_ARG)
      *DAD ini  26-JUN-1992
           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DBCDCOR  DBE' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = 'S' )
      *         MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD
      *         MOVE ZEROES       TO DBC-NUM-DCOR     IN DBE-FLD
               MOVE 'N'          TO FRM-IND-VERS     IN DBE-FLD
           ELSE
               MOVE 'S'                 TO FRM-IND-VERS IN DBE-FLD
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-DCOR IN DBE-FLD.
      *DAD fin  26-JUN-1992
      *>>>>
*% END
*% IF FIN_PUT_DBC_DBE
*% IF PGM_BCI OR PGM_ARG
      *<<<< FIN_PUT_DBC_DBE
      *DAD ini  26-JUN-1992
           IF FRM-IND-VERS IN DBE-FLD = 'N'
               MOVE ZEROES TO DBC-NUM-DCOR IN DBE-FLD.
      *DAD fin  26-JUN-1992
*% IF PGM_ARG
      *RDA INI 14-02-94
           IF DBC-MSC-SCLI IN DBE-FLD > SPACES
              MOVE 'SGC'                   TO MSC-COD-SIST
              MOVE 'SCLI'                  TO MSC-COD-TMSC IN MSC
              MOVE DBC-MSC-SCLI IN DBE-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SCLI IN DBE-FLD.
      *RDA FIN 14-02-94
*% END
      *>>>>
*% END
*% END
*% IF PGM_PER
*% IF INI_DBC_IND_ICLI
      *<<<< INI_DBC_IND_ICLI
           IF SCR-CCPP = 'ING'
               MOVE IDC-BLCO-N TO IDC-BLCO.
           MOVE IDC-TCLI-EMP TO IDC-TCLI.
      *>>>>
*% END
*% END
*% IF DBC_NUM_ICLI AND PGM_PER
      *<<<< DBC_NUM_ICLI AND PGM_PER
           IF DBC-IND-ICLI IN DBE-FLD = '7' AND SCR-CCPP = 'ING'
               IF DBC-NUM-ICLI IN DBE-FLD = ZEROES
                   MOVE 'CLIA'  TO CIC-CAI-ICIC IN CIC
                   MOVE CIC-GET TO CIC-CMND
                   PERFORM PRO-CIC
                   IF CIC-STAT NOT = CIC-STAT-OKS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       MOVE CIC-MENS     TO FRM-MENS
                   ELSE
                       MOVE CIC-NUM-ICIC TO DBC-NUM-ICLI IN DBE-FLD
                       MOVE CIC-CAI-ICIC TO SCR-CAI-ICLI  
                       MOVE CIC-IIC-ICIC TO SCR-IIC-ICLI
               ELSE
                   MOVE SPACES TO SCR-CAI-ICLI
                   MOVE ZEROES TO SCR-IIC-ICLI
           ELSE
               MOVE SPACES TO SCR-CAI-ICLI
               MOVE ZEROES TO SCR-IIC-ICLI.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF SCR-CMND = 'MIC' AND SCR-INST = SCR-INST-GFL
               PERFORM KEY-DBC-DBE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
*% END
*% IF INI_VAL_FLD_DBE
      *<<<< INI_VAL_FLD_DBE
      *Este label al  15-NOV-1989 no existia, por lo se debe incorporar al
      *SGCBMDBE.SRCAIU
      *DAD 12-SEP-1990 19:40:16 
           IF SCR-CMND = 'MNC'
               GO TO FIN-VAL-FLD-DBE.

           IF SCR-CMND = 'MIC' 
               PERFORM VAL-IKY-DBE
               GO TO FIN-VAL-FLD-DBE.

           IF SCR-CMND = 'INC'
*% IF PGM_CHI OR PGM_ARG
              OR DBC-IND-ICLI IN DBE-FLD = 'A'
*% END
               PERFORM VAL-MKY-DBE
               IF SCR-CMND = 'INC'
*% IF PGM_PER
                   MOVE ZEROES TO DCE-FEC-FCTT IN DBE-FLD
                   MOVE ZEROES TO DCE-FEC-FUME IN DBE-FLD
                   MOVE ZEROES TO DCE-FEC-FCAD IN DBE-FLD
                   MOVE ZEROES TO DBC-FEC-FTRN IN DBE-FLD
*% END
                   IF DBC-COD-OFIC IN DBE-FLD NOT > SPACES
                       PERFORM ERR-GLS
                       MOVE -1 TO DBC-COD-OFIC-LEN IN DBE-FLD
                       GO TO FIN-VAL-FLD-DBE
                   ELSE
                       PERFORM VAL-DBC-COD-OFIC
                       IF FRM-SUAR = FRM-SUAR-MAL OR
                          FRM-SUAR = FRM-SUAR-CLR
                           MOVE -1 TO DBC-COD-OFIC-LEN IN DBE-FLD
                           GO TO FIN-VAL-FLD-DBE
                       ELSE
*% IF PGM_ARG
                          PERFORM VAL-DCE-COD-TSOC
                          IF FRM-SUAR = FRM-SUAR-MAL OR
                             FRM-SUAR = FRM-SUAR-CLR
                              MOVE -1 TO DCE-COD-TSOC-LEN IN DBE-FLD
                              GO TO FIN-VAL-FLD-DBE
                          ELSE
*% END
                              GO TO FIN-VAL-FLD-DBE
               ELSE
                   GO TO FIN-VAL-FLD-DBE.

      *DAD ini  13-MAY-1992
           MOVE 'SGC'                   TO FIO-SIST.
           MOVE 'TCL'                   TO TAB-COD-TTAB.
           MOVE DBC-COD-TICL IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TICL IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-CIC-TICL IN WSS-VARI.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF PGM_PER
*%! INICIO DE IMPLEMENTACION DE COMANDO 'DEP'
*% IF INI_DCE_COD_TSOC
      *<<<< INI_DCE_COD_TSOC
           IF DCE-COD-TSOC IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DCE-COD-TSOC.
      *>>>>
*% END
*%! IF DCE_GLS_NFAN
*%!      *<<<< DCE_GLS_NFAN
*%!           IF DCE-GLS-NFAN IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
*%!               GO TO FIN-VAL-DCE-GLS-NFAN.
*%!      *>>>>
*%! END
*% IF RCD_GLS_DIRE
      *<<<< RCD_GLS_DIRE
           IF RCD-GLS-DIRE IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-RCD-GLS-DIRE.
      *>>>>
*% END
*% IF INI_RCD_COD_LUGA
      *<<<< INI_RCD_COD_LUGA
           IF RCD-COD-LUGA IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD
               GO TO FIN-VAL-RCD-COD-LUGA.
      *>>>>
*% END
*% IF RCD_GLS_FONO
      *<<<< RCD_GLS_FONO
           IF RCD-GLS-FONO IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-RCD-GLS-FONO.
      *>>>>
*% END
*% IF DBC_NUM_DCOR
      *<<<< DBC_NUM_DCOR
           IF DBC-NUM-DCOR IN DBE-FLD NOT > ZEROES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DBC-NUM-DCOR.
      *>>>>
*% END
*% IF INI_DBC_COD_OFIC
      *<<<< INI_DBC_COD_OFIC
           IF DBC-COD-OFIC IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-OFIC IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-OFIC.
      *>>>>
*% END
*% IF INI_DBC_COD_TICL
      *<<<< INI_DBC_COD_TICL
           IF DBC-COD-TICL IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-TICL IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-TICL.
      *>>>>
*% END
*% IF INI_DBC_COD_EJEC
      *<<<< INI_DBC_COD_EJEC
           IF DBC-COD-EJEC IN DBE-FLD NOT > SPACES
               IF SCR-CMND = 'DEP'
                   MOVE SPACES TO FRM-GLS-EJEC IN DBE-FLD
                   GO TO FIN-VAL-DBC-COD-EJEC
               ELSE
                   PERFORM ERR-GLS
                   GO TO FIN-VAL-DBC-COD-EJEC.
      *>>>>
*% END
*% IF INI_DBC_IND_OOFI
      *<<<< INI_DBC_IND_OOFI
           IF DBC-IND-OOFI IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DBC-IND-OOFI.
      *>>>>
*% END
*% IF INI_DBC_COD_ODSE
      *<<<< INI_DBC_COD_ODSE
           IF DBC-COD-ODSE IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-ODSE IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-ODSE.
      *>>>>
*% END
*% IF INI_DBC_COD_ACTI
      *<<<< INI_DBC_COD_ACTI
           IF DBC-COD-ACTI IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-ACTI IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-ACTI.
      *>>>>
*% END
*% IF INI_DCE_IND_CATE
      *<<<< INI_DCE_IND_CATE
           IF DCE-IND-CATE IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD
               GO TO FIN-VAL-DCE-IND-CATE.
      *>>>>
*% END
*% IF INI_DCE_IND_CMOS
      *<<<< INI_DCE_IND_CMOS
           IF DCE-IND-CMOS IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DCE-IND-CMOS.
      *>>>>
*% END
*% IF INI_DCE_FEC_FCTT
      *<<<< INI_DCE_FEC_FCTT
           IF DCE-FEC-FCTT IN DBE-FLD NOT > ZEROES AND SCR-CMND = 'DEP'
               MOVE ZEROES TO DCE-FEC-FCTT IN DBE-FLD
               GO TO FIN-VAL-DCE-FEC-FCTT.
      *>>>>
*% END
*% IF INI_DCE_IND_TEMP
      *<<<< INI_DCE_IND_TEMP
           IF DCE-IND-TEMP IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DCE-IND-TEMP.
      *>>>>
*% END
*% IF INI_DBC_IND_RESI
      *<<<< INI_DBC_IND_RESI
           IF DBC-IND-RESI IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DBC-IND-RESI.
      *>>>>
*% END
*%! IF DBC_NUM_RMER
*%!      *<<<< DBC_NUM_RMER
*%!           IF DBC-NUM-RMER IN DBE-FLD NOT > ZEROES AND SCR-CMND = 'DEP'
*%!               GO TO FIN-VAL-DBC-NUM-RMER.
*%!      *>>>>
*%! END
*% IF INI_DBC_IND_MEMP
      *<<<< INI_DBC_IND_MEMP
           IF DBC-IND-MEMP IN DBE-FLD NOT > SPACES AND SCR-CMND = 'DEP'
               GO TO FIN-VAL-DBC-IND-MEMP.
      *>>>>
*% END
*%! FIN DE IMPLEMENTACION DE COMANDO 'DEP'
*% END
*% IF DBC_GLS_NOMC
      *<<<< DBC_GLS_NOMC
           IF DBC-GLS-NOMC IN DBE-FLD NOT > SPACES AND
              SCR-INST = SCR-INST-GFL
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF RCD_GLS_DIRE
      *<<<< RCD_GLS_DIRE
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR ' ' ) AND
              RCD-GLS-DIRE IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-RCD-GLS-DIRE.
      *DAD fin  13-MAY-1992
           IF RCD-GLS-DIRE IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF RCD_COD_LUGA
      *<<<< RCD_COD_LUGA
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR ' ' ) AND
              RCD-COD-LUGA IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD
               GO TO FIN-VAL-RCD-COD-LUGA.

           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'CA' ) AND
              RCD-COD-LUGA IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-RCD-COD-LUGA.
      *DAD fin  13-MAY-1992
*% IF NOT PGM_PER
      *DAD ini  09-FEB-1994
      *     MOVE RCD-COD-LUGA IN DBE-FLD TO WSS-COD-LUGA.
      *     IF WSS-IND-PAIS = 'P'
      *         MOVE 'TAB'        TO TAB-COD-SIST
      *         MOVE 'PAI'        TO TAB-COD-TTAB IN TAB
      *         MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
      *         PERFORM VAL-COD
      *         IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
      *            RCD-COD-LUGA IN DBE-FLD > SPACES
      *             MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
      *         ELSE
      *             MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD
      *     ELSE
      *         MOVE 'TAB'                   TO TAB-COD-SIST
      *         MOVE 'COM'                   TO TAB-COD-TTAB IN TAB
      *         MOVE RCD-COD-LUGA IN DBE-FLD TO TAB-COD-CTAB IN TAB
      *         PERFORM VAL-COD
      *         IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
      *            RCD-COD-LUGA IN DBE-FLD > SPACES
      *             MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
      *         ELSE
      *             MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD.
      *DAD fin  09-FEB-1994
*% END
      *>>>>
*% END
*% IF RCD_GLS_FONO
      *<<<< RCD_GLS_FONO
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'CA' ) AND
              RCD-GLS-FONO IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-RCD-GLS-FONO.
      *     IF SCR-CMND = 'ICD' AND RCD-GLS-FONO IN DBE-FLD NOT > SPACES
      *         GO TO FIN-VAL-RCD-GLS-FONO.
      *DAD fin  13-MAY-1992
      *DAD ini  05-JUN-1992
           MOVE 'A' TO WSS-IND-STAT IN WSS-VARI.
           IF RCD-GLS-FONO IN DBE-FLD NOT NUMERIC
               MOVE RCD-GLS-FONO IN DBE-FLD TO WSS-GLS-FONO IN WSS-VARI
               PERFORM CHK-NUM-FONO VARYING WSS-IND FROM 1 BY 1 UNTIL
                                    WSS-IND > 12 OR
                                    WSS-IND-STAT IN WSS-VARI = 'X'.
           IF WSS-IND-STAT IN WSS-VARI = 'X' OR 'C'
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'NUMFONOERROR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-RCD-GLS-FONO.
      *DAD fin  05-JUN-1992
      *>>>>
*% END
*% IF DBC_NUM_DCOR
      *<<<< DBC_NUM_DCOR
*% IF PGM_BCI OR PGM_ARG
      *DAD ini  13-MAY-1992
      *     IF DBC-NUM-DCOR-ATR IN DBE-FLD = FRM-CPIM-AEY
           IF FRM-IND-VERS IN DBE-FLD = 'N'
               MOVE ZEROES TO DBC-NUM-DCOR IN DBE-FLD
               GO TO FIN-VAL-DBC-NUM-DCOR.
      *DAD fin  13-MAY-1992
*% END
           IF SCR-CMND = 'ICD' AND DBC-NUM-DCOR IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-NUM-DCOR.
           IF SCR-CCPP = 'MOD' OR
            ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )
               MOVE DBC-CAI-ICLI IN DBE-FLD TO RCD-CAI-ICLI IN RCD
               MOVE DBC-IIC-ICLI IN DBE-FLD TO RCD-IIC-ICLI IN RCD
               MOVE DBC-NUM-DCOR IN DBE-FLD TO RCD-NUM-DIRE IN RCD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'NUMDCORNEX  ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-NUM-DCOR.
      *>>>>
*% END
*% IF DBC_COD_TICL
      *<<<< DBC_COD_TICL
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'PV' OR 'CA' OR 'EX' ) AND
              DBC-COD-TICL IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-COD-TICL.
      *     IF SCR-CMND = 'ICD' AND DBC-COD-TICL IN DBE-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-TICL IN DBE-FLD
      *         GO TO FIN-VAL-DBC-COD-TICL.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF DBC_COD_EJEC
      *<<<< DBC_COD_EJEC
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'CA' ) AND
              DBC-COD-EJEC IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-COD-EJEC
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' ) AND
              DBC-COD-EJEC IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EJEC IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-EJEC.
      *     IF SCR-CMND = 'ICD' AND DBC-COD-EJEC IN DBE-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-EJEC IN DBE-FLD
      *         GO TO FIN-VAL-DBC-COD-EJEC.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF DBC_COD_OFIC
      *<<<< DBC_COD_OFIC
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'PV' OR 'CA' ) AND
              DBC-COD-OFIC IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-COD-OFIC.
      *     IF SCR-CMND = 'ICD' AND DBC-COD-OFIC IN DBE-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-OFIC IN DBE-FLD
      *         GO TO FIN-VAL-DBC-COD-OFIC.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF DCE_COD_TPLN
      *<<<< DCE_COD_TPLN
      *DAD ini  18-FEB-1994
      *     IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' ) AND
      *     IF DCE-COD-TPLN IN DBE-FLD NOT > SPACES
      *         PERFORM ERR-GLS
      *         GO TO FIN-VAL-DCE-COD-TPLN.
      *DAD fin  18-FEB-1994
      *>>>>
*% END
*% IF DCE_COD_TBAN
      *<<<< DCE_COD_TBAN
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DCE-COD-TBAN IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TBAN IN DBE-FLD
               GO TO FIN-VAL-DCE-COD-TBAN.
      *DAD fin  10-FEB-1993
      *DAD ini  26-AUG-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' ) AND
              DCE-COD-TBAN IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DCE-COD-TBAN.
      *DAD fin  26-AUG-1992
      *DAD ini  09-FEB-1994 / 26-JUL-1993
      *     IF DCE-COD-TBAN IN DBE-FLD = 'P' AND
           MOVE DCE-COD-TBAN IN DBE-FLD TO WSS-COD-TBAN IN WSS-VARI.
           IF VAL-TBAN AND
      *DAD fin  09-FEB-1994
              DBC-NUM-ICLI IN DBE-FLD NOT < WSS-NUM-MRUT IN WSS-VARI
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'CODTBANNORUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE SPACES TO FRM-GLS-TBAN IN DBE-FLD
               GO TO FIN-VAL-DCE-COD-TBAN.
      *DAD fin  26-JUL-1993
      *>>>>
*% END
*% IF DBC_IND_OOFI
      *<<<< DBC_IND_OOFI
*% IF NOT PGM_PER
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DBC-IND-OOFI IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-IND-OOFI.
      *DAD fin  10-FEB-1993
*% END
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' ) AND
              DBC-IND-OOFI IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-IND-OOFI
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR 'CA' ) AND
              DBC-IND-OOFI IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-IND-OOFI.
      *DAD fin  13-MAY-1992
*% IF PGM_PER
           IF SCR-CMND = 'ICD' AND DBC-IND-OOFI IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DBC-IND-OOFI.
*% END
      *>>>>
*% END
*% IF DBC_COD_ODSE
      *<<<< DBC_COD_ODSE
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'CA' ) AND
              DBC-COD-ODSE IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-COD-ODSE
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' ) AND
              DBC-COD-ODSE IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ODSE IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-ODSE.
      *     IF SCR-CMND = 'ICD' AND DBC-COD-ODSE IN DBE-FLD NOT > SPACES
      *         MOVE SPACES TO FRM-GLS-ODSE IN DBE-FLD
      *         GO TO FIN-VAL-DBC-COD-ODSE.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF DBC_COD_ACTI
      *<<<< DBC_COD_ACTI
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DBC-COD-ACTI IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ACTI IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-ACTI.
      *DAD fin  10-FEB-1993
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' ) AND
              DBC-COD-ACTI IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-COD-ACTI
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR 'CA' ) AND
              DBC-COD-ACTI IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ACTI IN DBE-FLD
               GO TO FIN-VAL-DBC-COD-ACTI.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF DCE_COD_TSOC AND (PGM_CHI OR PGM_ARG)
      *<<<< DCE_COD_TSOC AND (PGM_CHI OR PGM_ARG)
      *DAD ini  05-JUN-1992
           IF SCR-CMND NOT = 'MNJ'
*% IF PGM_ARG
              AND SCR-CMND NOT = 'ING' 
              AND SCR-CMND NOT = 'INC' 
*% END
               GO TO FIN-VAL-DCE-COD-TSOC.
      *DAD fin  05-JUN-1992
      *>>>>
*% END
*% IF DCE_IND_CATE
      *<<<< DCE_IND_CATE
*% IF NOT PGM_PER
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DCE-IND-CATE IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD
               GO TO FIN-VAL-DCE-IND-CATE.
      *DAD fin  10-FEB-1993
*% END
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' ) AND
              DCE-IND-CATE IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DCE-IND-CATE
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR 'CA' ) AND
              DCE-IND-CATE IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD
               GO TO FIN-VAL-DCE-IND-CATE.
      *DAD fin  13-MAY-1992
*% IF PGM_PER
           IF SCR-CMND = 'ICD' AND DCE-IND-CATE IN DBE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD
               GO TO FIN-VAL-DCE-IND-CATE.
*% END
      *>>>>
*% END
*% IF DCE_IND_CMOS
      *<<<< DCE_IND_CMOS
*% IF NOT PGM_PER
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DCE-IND-CMOS IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-CMOS.
      *DAD fin  10-FEB-1993
*% END
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' ) AND
              DCE-IND-CMOS IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DCE-IND-CMOS
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR 'CO' OR 'CA' ) AND
              DCE-IND-CMOS IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-CMOS.
      *DAD fin  13-MAY-1992
*% IF PGM_PER
           IF SCR-CMND = 'ICD' AND DCE-IND-CMOS IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-CMOS.
*% END
      *>>>>
*% END
*% IF DCE_FEC_FCTT
      *<<<< DCE_FEC_FCTT
           IF SCR-CMND = 'ICD' AND DCE-FEC-FCTT IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-FEC-FCTT.
      *>>>>
*% END
*% IF DCE_FEC_FUME
      *<<<< DCE_FEC_FUME
           IF SCR-CMND = 'ICD' AND DCE-FEC-FUME IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-FEC-FUME.
      *>>>>
*% END
*% IF DCE_IND_TEMP
      *<<<< DCE_IND_TEMP
*% IF NOT PGM_PER
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND = 'ICD' AND
              DCE-IND-TEMP IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-TEMP.
      *DAD fin  10-FEB-1993
*% END
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' ) AND
              DCE-IND-TEMP IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DCE-IND-TEMP
           ELSE
           IF ( WSS-CIC-TICL IN WSS-VARI = 'PV' OR 'CA' ) AND
              DCE-IND-TEMP IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-TEMP.
      *DAD fin  13-MAY-1992
*% IF PGM_PER
           IF SCR-CMND = 'ICD' AND DCE-IND-TEMP IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-TEMP.
*% END
      *>>>>
*% END
*% IF DCE_FEC_FCAD
      *<<<< DCE_FEC_FCAD
           IF SCR-CMND = 'ICD' AND DCE-FEC-FCAD IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-FEC-FCAD.
      *>>>>
*% END
*% IF DCE_IND_RAUT
      *<<<< DCE_IND_RAUT
           IF SCR-CMND = 'ICD' AND DCE-IND-RAUT IN DBE-FLD NOT > SPACES
               GO TO FIN-VAL-DCE-IND-RAUT.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_DBE
      *<<<< INI_VAL_CON_KEY_DBE
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-DBE.
      *>>>>
*% END
*% IF INI_DBC_MSC_SCLI AND PGM_ARG
      *<<<< INI_DBC_MSC_SCLI
           IF DBC-MSC-SCLI IN DBE-FLD NOT > SPACES
                PERFORM ERR-GLS
                MOVE SPACES TO FRM-GLS-SCLI IN DBE-FLD
                GO TO FIN-VAL-DBC-MSC-SCLI.
      *>>>>
*% END
*% IF INI_DCE_COD_TSOC AND PGM_ARG
      *<<<< INI_DCE_COD_TSOC AND PGM_ARG
           IF DCE-COD-TSOC IN DBE-FLD NOT > SPACES
                PERFORM ERR-GLS
                MOVE SPACES TO FRM-GLS-TSOC IN DBE-FLD
                GO TO FIN-VAL-DCE-COD-TSOC.
      *>>>>
*% END
*% IF FIN_DBC_MSC_SCLI AND PGM_ARG
      *<<<< FIN_DBC_MSC_SCLI
           IF MSG-COD-MENS = 'COD    NEX' OR
              DBC-MSC-SCLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-SCLI IN DBE-FLD
           ELSE
              MOVE MSC-GLS-DESC IN MSC TO
              FRM-GLS-SCLI IN DBE-FLD.
      *>>>>
*% END
*% IF DBC_COD_CATE AND PGM_ARG
      *<<<< DBC_COD_CATE AND PGM_ARG
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SIV ' TO TAB-COD-TTAB IN TAB.
           MOVE DBC-COD-CATE IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *DAD ini  05-JUN-1992
       CHK-NUM-FONO SECTION.
       INI-CHK-NUM-FONO.
           IF WSS-NUM-FONO IN WSS-VARI(WSS-IND) = SPACES
               IF WSS-IND-STAT IN WSS-VARI = 'A' OR 'E'
                   NEXT SENTENCE
               ELSE
               IF WSS-IND-STAT IN WSS-VARI = 'B' OR 'D'
                   MOVE 'E' TO WSS-IND-STAT IN WSS-VARI
               ELSE
      *         IF WSS-IND-STAT IN WSS-VARI = 'C'
                   MOVE 'X' TO WSS-IND-STAT IN WSS-VARI
           ELSE
           IF WSS-NUM-FONO IN WSS-VARI(WSS-IND) = '-'
               IF WSS-IND-STAT IN WSS-VARI = 'A' OR 'C' OR 'D' OR 'E'
                   MOVE 'X' TO WSS-IND-STAT IN WSS-VARI
               ELSE
      *         IF WSS-IND-STAT IN WSS-VARI = 'B'
                   MOVE 'C' TO WSS-IND-STAT IN WSS-VARI
           ELSE
           IF WSS-NUM-FONO IN WSS-VARI(WSS-IND) IS NUMERIC
               IF WSS-IND-STAT IN WSS-VARI = 'A'
                   MOVE 'B' TO WSS-IND-STAT IN WSS-VARI
               ELSE
               IF WSS-IND-STAT IN WSS-VARI = 'B' OR 'D'
                   NEXT SENTENCE
               ELSE
               IF WSS-IND-STAT IN WSS-VARI = 'C'
                   MOVE 'D' TO WSS-IND-STAT IN WSS-VARI
               ELSE
      *         IF WSS-IND-STAT IN WSS-VARI = 'E'
                   MOVE 'X' TO WSS-IND-STAT IN WSS-VARI
           ELSE
               MOVE 'X' TO WSS-IND-STAT IN WSS-VARI.
       FIN-CHK-NUM-FONO.
           EXIT.
      *DAD fin  05-JUN-1992
      *>>>>
*% END
