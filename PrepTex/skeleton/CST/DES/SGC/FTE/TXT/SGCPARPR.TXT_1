*%! Codigo adicional para archivo SGCPQRPR
*% FRM = 'RPR'
*% PGM_PTC = TRUE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "SGCZQRPR"
*% ELSE
*% CLRMFC = "SGCZURPR"
*% END
*% LARGO_MI_COMMAREA = 12
*% IF FIN_SCR_VARI
      *PVG INI 10-NOV-2014
           03 SCR-COD-EJEC                PIC X(12).
      *PVG FIN 10-NOV-2014
*% END
*% IF WSS
      *<<<< WSS 
       COPY SGCBRDBC.
       COPY GNSBRCIC.                                                  
       COPY TABBROFI.
       COPY SGCBRIPC.                                                  
       COPY SGCBRTPP.                                                  
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.    
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.       
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.       
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TPP-REQA==.       
       COPY GNSWGCIC.                                                  
       COPY GNSWGCPT.

       01 WSS-VARI.
          03 WSS-FEC-PRPR.                                              
             05 WSS-FEC-DPRP           VALUE ZEROES     PIC 9(02).      
             05 WSS-FEC-MPRP           VALUE ZEROES     PIC 9(02).      
             05 WSS-FEC-SPRP           VALUE ZEROES     PIC 9(02).      
             05 WSS-FEC-APRP           VALUE ZEROES     PIC 9(02).      
          03 WSS-COD-TFRM       VALUE SPACES            PIC X(04).     
          03 WSS-GLS-CLIE       VALUE SPACES            PIC X(01).     
      * INI RGD 01/10/2008
          03 WSS-IND-CLIE       VALUE SPACES            PIC X(01).      
      * FIN RGD 01/10/2008
          03 WSS-FEC-FEFR       VALUE ZEROES            PIC 9(08).     
          03 WSS-FEC-FSTA       VALUE ZEROES            PIC 9(08).     
          03 WSS-IND-IPC        VALUE ZEROES            PIC 9(02).     
          03 WSS-COD-TDOC       VALUE SPACES            PIC X(03).     
          03 WSS-FEC-RPRF.                                             
             05 WSS-NUM-SRPR    VALUE ZEROES            PIC 9(02).     
             05 WSS-NUM-ARPR    VALUE ZEROES            PIC 9(02).     
             05 WSS-NUM-MRPR    VALUE ZEROES            PIC 9(02).     
             05 WSS-NUM-DRPR    VALUE ZEROES            PIC 9(02).     
      *MHM-INI 05-MAR-2007                                              
          05 WSS-KEY-IIPC                               PIC X(15).      
      *MHM-FIN 05-MAR-2007                                              
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<<
           IF SCR-CMND = 'ANL'                                         
              PERFORM BUS-IND                                          
              GO TO FIN-CMN-MOD                                        
           ELSE                                                        
           IF SCR-CMND = 'ACA'                                         
              MOVE DBC-NUM-ICLI IN RPR-FLD TO DBC-NUM-ICLI IN DBC      
              MOVE DBC-IND-ICLI IN RPR-FLD TO DBC-IND-ICLI IN DBC      
              MOVE DBC-GLS-ICLI IN RPR-FLD TO DBC-GLS-ICLI IN DBC      
              MOVE 'DBC-IDC-ICLI' TO FIO-AKEY                          
              MOVE FIO-GET-KEY TO FIO-CMND                             
              PERFORM SGC-FIO-DBC                                      
              MOVE DBC-IND-TICL IN DBC TO WSS-GLS-CLIE                 
              PERFORM ACA-IND                                          
              GO TO FIN-CMN-MOD                                        
           ELSE                                                        
           IF SCR-CMND = 'MOD'                                         
              PERFORM MOD-RPR.                                         
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<<
           IF SCR-CMND = 'ING'                                          
              MOVE FRM-CPIM-AEY TO RPR-CAI-IFOL-ATR IN RPR-FLD          
              MOVE FRM-CPIM-AEY TO RPR-IIC-IFOL-ATR IN RPR-FLD.         
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<<
           IF SCR-CMND = 'ANL' OR SCR-CMND = 'ACA'                      
              MOVE FRM-CPIM-AEY TO RPR-COD-EJEC-ATR IN RPR-FLD          
              MOVE FRM-CPIM-AEY TO RPR-FEC-FRPR-ATR IN RPR-FLD          
              MOVE FRM-CPIM-AEY TO RPR-COD-TFRM-ATR IN RPR-FLD          
              MOVE 0            TO RPR-COD-EJEC-LEN 
              MOVE -1           TO RPR-GLS-MENS-LEN.                    
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<<
           IF SCR-CMND NOT = 'ING'                                      
              GO TO CON-FND-KEY                                         
           ELSE                                                         
              PERFORM GET-FHOY                                          
              MOVE DBC-NUM-ICLI IN RPR-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE DBC-IND-ICLI IN RPR-FLD TO DBC-IND-ICLI IN DBC       
              MOVE DBC-GLS-ICLI IN RPR-FLD TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI' TO FIO-AKEY                           
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC                                       
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                      
              PERFORM CPT-BLKS                                          
              MOVE CPT-STRN TO FRM-GLS-NOMC IN RPR-FLD                  
              MOVE DBC-IND-TICL IN DBC TO FRM-GLS-CLIE IN RPR-FLD       
              MOVE 'I' TO RPR-IND-ESTA IN RPR-FLD                       
      *PVG INI 10-NOV-2014
              MOVE DBC-COD-EJEC IN DBC TO SCR-COD-EJEC IN SCR-VARI
      *PVG FIN 10-NOV-2014
              MOVE HOY-DHOY TO  WSS-FEC-DPRP                            
              MOVE HOY-MHOY TO  WSS-FEC-MPRP                            
              MOVE HOY-SHOY TO  WSS-FEC-SPRP                            
              MOVE HOY-AHOY TO  WSS-FEC-APRP                            
              MOVE WSS-FEC-PRPR TO RPR-FEC-ESTA IN RPR-FLD.             
       CON-FND-KEY.                                                     
      *>>>>    
*% END
*% IF FIN_FND_KEY
      *<<<<
           IF SCR-CMND = 'ING'
              GO TO FIN-FND-KEY.
           IF ((DBC-NUM-ICLI IN RPR-FLD > SPACES AND                    
                DBC-VRF-ICLI IN RPR-FLD > SPACES) AND                   
               (RPR-CAI-IFOL IN RPR-FLD NOT > SPACES AND                
                RPR-IIC-IFOL IN RPR-FLD NOT > ZEROES))                  
                PERFORM BUS-CLIE                                        
      * INI RGD 01/10/2008
                IF WSS-IND-CLIE = 'N'                                   
                   GO TO FIN-FND-KEY.                                   
      *FIN RGD 01/10/2008
           IF  (RPR-CAI-IFOL IN RPR-FLD > SPACES AND                    
                RPR-IIC-IFOL IN RPR-FLD > ZEROES)  
                MOVE RPR-CAI-IFOL IN RPR-FLD TO RPR-CAI-IFOL IN RPR     
                MOVE RPR-IIC-IFOL IN RPR-FLD TO RPR-IIC-IFOL IN RPR     
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM SGC-FIO-RPR          
      * INI RGD 01/10/2008
                MOVE FIO-STAT TO PGM-STAT-RPR
      * FIN RGD 01/10/2008
                MOVE RPR-IND-CLIE IN RPR TO FRM-GLS-CLIE IN RPR-FLD     
                MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC         
                MOVE FIO-GET-KEY TO FIO-CMND                            
                PERFORM SGC-FIO-DBC                                     
                IF FIO-STAT-OKS                                         
                   PERFORM PUT-DBC-RPR                                  
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN RPR-FLD  
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RPR-FLD  
      * INI RGD 01/10/2008
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RPR-FLD.
           MOVE FIO-STAT TO PGM-STAT-RPR.                               
           IF PGM-STAT-RPR-OKS AND
                RPR-IND-ESTA IN RPR NOT = 'I' AND
                SCR-CMND = 'MOD'
                MOVE 'SGC' TO MSG-COD-SIST
                MOVE 'RPR NO MODI' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE 'S' TO SCR-IERR
                MOVE SCR-STAT-CON TO SCR-STAT
                MOVE PGM-STAT-RPR TO FIO-STAT
                GO TO FIN-FND-KEY.
           IF PGM-STAT-RPR-OKS AND
                RPR-IND-ESTA IN RPR NOT = 'I' AND
                SCR-CMND = 'ELI'
                MOVE 'SGC' TO MSG-COD-SIST
                MOVE 'RPR NO ELIMI' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE 'S' TO SCR-IERR
                MOVE SCR-STAT-CON TO SCR-STAT
                MOVE PGM-STAT-RPR TO FIO-STAT
                GO TO FIN-FND-KEY.
           IF PGM-STAT-RPR-OKS AND
                RPR-IND-ESTA IN RPR = 'A' AND
                SCR-CMND = 'ACA'
                MOVE 'SGC' TO MSG-COD-SIST
                MOVE 'RPR NO MODI' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE 'S' TO SCR-IERR
                MOVE SCR-STAT-CON TO SCR-STAT
                MOVE PGM-STAT-RPR TO FIO-STAT
                GO TO FIN-FND-KEY.
      * FIN RGD 01/10/2008
      *>>>>
*% END
*% IF CMN_ING
      *<<<<                                                    
           IF RPR-COD-TFRM IN RPR-FLD = '01'                           
              MOVE 'FP01' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '02'                           
              MOVE 'FP02' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '03'                           
              MOVE 'FP03' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '04'                           
              MOVE 'FP04' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '05'                           
              MOVE 'FP05' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '06'                           
              MOVE 'FP06' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO                                         
           ELSE                                                        
           IF RPR-COD-TFRM IN RPR-FLD = '07'                           
              MOVE 'FP07' TO WSS-COD-TFRM                              
              PERFORM GEN-FLIO.                                        
           PERFORM GET-FHOY.                                           
           MOVE DBC-NUM-ICLI IN RPR-FLD TO DBC-NUM-ICLI IN DBC.        
           MOVE DBC-IND-ICLI IN RPR-FLD TO DBC-IND-ICLI IN DBC.        
           MOVE DBC-GLS-ICLI IN RPR-FLD TO DBC-GLS-ICLI IN DBC.        
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.                            
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM SGC-FIO-DBC.                                        
           MOVE DBC-CIC-ICLI IN DBC TO RPR-CIC-ICLI IN RPR.            
           MOVE HOY-FHOY            TO RPR-FEC-FEFR IN RPR.            
           MOVE HOY-FHOY            TO RPR-FEC-FSTA IN RPR.            
           MOVE DBC-IND-TICL IN DBC TO RPR-IND-CLIE IN RPR.            
      *>>>>                                                                 
*% END
*% IF FIN_CMN_ING
      *<<<<
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                           
           PERFORM SGC-FIO-RPR.                                        
           MOVE RPR-COD-ATRN IN RPR TO RPR-COD-EEFR IN RPR.            
           MOVE FIO-MOD TO FIO-CMND.                                   
           PERFORM SGC-FIO-RPR.                                        
           PERFORM GRABA-IPC.                                          
      *>>>>
*% END
*% IF INI_CMN_ELI
      *>>>>
           IF SCR-CMND = 'ELI'                                         
              PERFORM ELI-RPR                                          
              GO TO FIN-CMN-ELI.                                       
      *<<<<
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY SGCBFDBC.
       COPY GNSBBTAB.
       COPY GNSBFCIC.                                                  
       COPY GNSBGCIC.                                                  
       COPY GNSBGCPT.
       COPY SGCBFIPC.                                                  
       COPY SGCBFTPP.                                                  
       COPY GNSBPFEC.                                                  
       COPY TABBBOFI.                                                   
       COPY TABBVOFI.                                                   
       COPY TABBFOFI.                                                   
      *>>>>
*% END
*% IF EOF_PQ
      *<<<<
       BUS-CLIE SECTION.                                                
       INI-BUS-CLIE.                                                    
      * INI RGD 01/10/2008
           MOVE 'S' TO WSS-GLS-CLIE.                                    
      * FIN RGD 01/10/2008
           MOVE DBC-NUM-ICLI IN RPR-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE DBC-IND-ICLI IN RPR-FLD TO DBC-IND-ICLI IN DBC.         
           MOVE DBC-GLS-ICLI IN RPR-FLD TO DBC-GLS-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-BUS-CLIE.                                       
           MOVE DBC-CAI-ICLI IN DBC TO RPR-COD-CCIC IN RPR.             
           MOVE DBC-IIC-ICLI IN DBC TO RPR-IIC-ICLI IN RPR.             
           MOVE 99999999            TO RPR-FEC-FRPR IN RPR.             
           MOVE 'RPR-AKY-IRPR' TO FIO-AKEY.                             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
       LUP-BUS-CLIE.                                                    
           PERFORM SGC-FIO-RPR.                                         
           MOVE RPR-IND-CLIE IN RPR TO FRM-GLS-CLIE IN RPR-FLD.         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'SGC'   TO MSG-COD-SIST                              
              MOVE 'NO EXISTE' TO MSG-COD-MENS                          
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              MOVE 'N' TO WSS-IND-CLIE                                  
              GO TO FIN-BUS-CLIE                                        
           ELSE                                                         
              IF (DBC-CIC-ICLI IN DBC = RPR-CIC-ICLI IN RPR)            
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                   
                 PERFORM CPT-BLKS                                       
                 MOVE CPT-STRN            TO FRM-GLS-NOMC IN RPR-FLD    
                 MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RPR-FLD    
                 MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RPR-FLD    
                 GO TO FIN-BUS-CLIE.                                    
           MOVE FIO-GET-PRV TO FIO-CMND .                               
           GO TO LUP-BUS-CLIE.                                      
       FIN-BUS-CLIE.                                                    
           EXIT.                                                        
      *>>>>  
*% END
*% IF EOF_PU
      *<<<<
       GEN-FLIO SECTION.                                               
       INI-GEN-FLIO.                                                   
           MOVE WSS-COD-TFRM TO CIC-CAI-ICIC IN CIC.                   
           MOVE CIC-GET TO CIC-CMND.                                   
           PERFORM PRO-CIC.                                            
           IF CIC-STAT NOT = CIC-STAT-OKS                              
              MOVE 'S' TO SCR-IERR                                     
              MOVE CIC-MENS TO FRM-MENS                                
              MOVE FIO-STAT-NEX TO FIO-STAT                            
              GO TO FIN-GEN-FLIO                                       
           ELSE                                                        
              MOVE CIC-CAI-ICIC TO RPR-CAI-IFOL IN RPR                 
              MOVE CIC-IIC-ICIC TO RPR-IIC-IFOL IN RPR   
              MOVE 'SGC' TO MSG-COD-SIST                               
              MOVE 'CIC FOLIO: ' TO MSG-GLS-MENS                       
              PERFORM GET-MSG                                          
              MOVE CIC-CAI-ICIC TO RPR-CAI-IFOL IN RPR-FLD             
              MOVE CIC-IIC-ICIC TO RPR-IIC-IFOL IN RPR-FLD
              MOVE RPR-CIC-IFOL IN RPR TO FRM-MEN2.                    
       FIN-GEN-FLIO.                                                   
           EXIT.                           

       GRABA-IPC SECTION.                                              
       INI-GRABA-IPC.                                                  
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '01'                               
              MOVE 'PPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '01'                               
              MOVE 'PPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '02'                               
              MOVE 'FPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '02'                               
              MOVE 'FPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '03'                               
              MOVE 'DPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '03'                               
              MOVE 'DPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '04'                               
              MOVE 'PPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
              MOVE 'FPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '04'                               
              MOVE 'PPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
              MOVE 'FPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '05'                               
              MOVE 'PPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
              MOVE 'DPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '05'                               
              MOVE 'PPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
              MOVE 'DPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '06'                               
              MOVE 'FPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
              MOVE 'DPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '06'                               
              MOVE 'FPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
              MOVE 'DPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'E' AND                            
              RPR-COD-TFRM IN RPR = '07'                               
              MOVE 'PPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
              MOVE 'FPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
              MOVE 'DPJ' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-E                                      
           ELSE                                                        
           IF DBC-IND-TICL IN DBC = 'P' AND                            
              RPR-COD-TFRM IN RPR = '07'                               
              MOVE 'PPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
              MOVE 'FPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P                                      
              MOVE 'DPN' TO WSS-COD-TDOC                               
              PERFORM GRABA-IPC-P.                                     
       FIN-GRABA-IPC.                                                  
           EXIT.                                                       
                                                                       
                                                                       
       GRABA-IPC-E SECTION.                                            
       INI-GRABA-IPC-E.                                                
           MOVE SPACES              TO IPC-GLS-FLAG IN IPC.            
           MOVE RPR-CIC-IFOL IN RPR TO IPC-CIC-IFOL IN IPC.            
           MOVE WSS-COD-TDOC        TO IPC-COD-TDOC IN IPC.            
           MOVE RPR-STP-ITRN IN RPR TO IPC-STP-ITRN IN IPC.            
           MOVE RPR-MSC-TACC IN RPR TO IPC-MSC-TACC IN IPC.            
           MOVE RPR-MSC-STAT IN RPR TO IPC-MSC-STAT IN IPC.            
           MOVE RPR-COD-OTRN IN RPR TO IPC-COD-OTRN IN IPC.            
           MOVE RPR-COD-ATRN IN RPR TO IPC-COD-ATRN IN IPC.            
           MOVE 'S'                 TO IPC-IND-CRPR IN IPC.            
           MOVE SPACES              TO IPC-IND-CDPX IN IPC             
           MOVE 'S'                 TO IPC-IND-CDEX IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAC IN IPC.            
           MOVE SPACES              TO IPC-IND-CDPR IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAP IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAX IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAE IN IPC.            
           MOVE SPACES              TO IPC-IND-CAEX IN IPC.            
           MOVE SPACES              TO IPC-IND-CATC IN IPC.            
           MOVE SPACES              TO IPC-IND-CBRZ IN IPC.            
           MOVE SPACES              TO IPC-IND-CDBN IN IPC.            
           MOVE SPACES              TO IPC-IND-CPAE IN IPC.            
           MOVE SPACES              TO IPC-IND-CRGC IN IPC.            
           MOVE SPACES              TO IPC-IND-CVEH IN IPC.            
           MOVE SPACES              TO IPC-IND-CVOE IN IPC.            
           MOVE SPACES              TO IPC-IND-CVSC IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR1 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR2 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR3 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR4 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR5 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX1 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX2 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX3 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX4 IN IPC.            
           MOVE RPR-COD-EEFR IN RPR TO IPC-COD-EEFR IN IPC.            
           MOVE RPR-FEC-FEFR IN RPR TO IPC-FEC-FEFR IN IPC.            
           MOVE FIO-PUT TO FIO-CMND.                                   
           PERFORM SGC-FIO-IPC.                                        
       FIN-GRABA-IPC-E.                                                
           EXIT.                                                       
                                                                       
       GRABA-IPC-P SECTION.                                            
       INI-GRABA-IPC-P.                                                
           MOVE SPACES              TO IPC-GLS-FLAG IN IPC.            
           MOVE RPR-CIC-IFOL IN RPR TO IPC-CIC-IFOL IN IPC.            
           MOVE WSS-COD-TDOC        TO IPC-COD-TDOC IN IPC.            
           MOVE RPR-STP-ITRN IN RPR TO IPC-STP-ITRN IN IPC.            
           MOVE RPR-MSC-TACC IN RPR TO IPC-MSC-TACC IN IPC.            
           MOVE RPR-MSC-STAT IN RPR TO IPC-MSC-STAT IN IPC.            
           MOVE RPR-COD-OTRN IN RPR TO IPC-COD-OTRN IN IPC.            
           MOVE RPR-COD-ATRN IN RPR TO IPC-COD-ATRN IN IPC.            
           MOVE 'S'                 TO IPC-IND-CRPR IN IPC.            
           MOVE 'S'                 TO IPC-IND-CDPX IN IPC             
           MOVE SPACES              TO IPC-IND-CDEX IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAC IN IPC.            
           MOVE SPACES              TO IPC-IND-CDPR IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAP IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAX IN IPC.            
           MOVE SPACES              TO IPC-IND-CDAE IN IPC.            
           MOVE SPACES              TO IPC-IND-CAEX IN IPC.            
           MOVE SPACES              TO IPC-IND-CATC IN IPC.            
           MOVE SPACES              TO IPC-IND-CBRZ IN IPC.            
           MOVE SPACES              TO IPC-IND-CDBN IN IPC.            
           MOVE SPACES              TO IPC-IND-CPAE IN IPC.            
           MOVE SPACES              TO IPC-IND-CRGC IN IPC.            
           MOVE SPACES              TO IPC-IND-CVEH IN IPC.            
           MOVE SPACES              TO IPC-IND-CVOE IN IPC.            
           MOVE SPACES              TO IPC-IND-CVSC IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR1 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR2 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR3 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR4 IN IPC.            
           MOVE SPACES              TO IPC-IND-DIR5 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX1 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX2 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX3 IN IPC.            
           MOVE SPACES              TO IPC-IND-REX4 IN IPC.            
           MOVE RPR-COD-EEFR IN RPR TO IPC-COD-EEFR IN IPC.            
           MOVE RPR-FEC-FEFR IN RPR TO IPC-FEC-FEFR IN IPC.            
           MOVE FIO-PUT TO FIO-CMND.                                   
           PERFORM SGC-FIO-IPC.                                        
       FIN-GRABA-IPC-P.                                                
           EXIT.                                                       
                                                                       
       BUS-IND SECTION.                                                
       INI-BUS-IND.                                                    
           PERFORM GET-FHOY.                                           
           MOVE RPR-CAI-IFOL IN RPR-FLD TO RPR-CAI-IFOL IN RPR.        
           MOVE RPR-IIC-IFOL IN RPR-FLD TO RPR-IIC-IFOL IN RPR.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM SGC-FIO-RPR.                                        
           IF RPR-IND-ESTA IN RPR = 'A'                                
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
              PERFORM SGC-FIO-RPR                                      
              IF FIO-STAT-OKS                
                 MOVE 'I' TO RPR-IND-ESTA IN RPR                       
                 MOVE HOY-FHOY TO RPR-FEC-FSTA IN RPR                  
                 MOVE FIO-MOD TO FIO-CMND                              
                 PERFORM SGC-FIO-RPR                                   
                 GO TO FIN-BUS-IND.                                    
           IF RPR-IND-ESTA IN RPR = 'I'                                
                 MOVE 'SGC'   TO MSG-COD-SIST                          
                 MOVE 'NO MOD RPR=A' TO MSG-COD-MENS                   
                 PERFORM GET-MSG                                       
                 MOVE MSG-GLS-DESC TO FRM-MENS                         
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.                        
       FIN-BUS-IND.                                                    
           EXIT.                                                       
                                                                       
       ACA-IND SECTION.                                                
       INI-ACA-IND.                                                    
      *MHM-INI 05-MAR-2007                                              
           PERFORM ACT-IPC-OLD.                                         
      *MHM-FIN 05-MAR-2007                                              
           PERFORM GET-FHOY.                                           
           MOVE RPR-CAI-IFOL IN RPR-FLD TO RPR-CAI-IFOL IN RPR.        
           MOVE RPR-IIC-IFOL IN RPR-FLD TO RPR-IIC-IFOL IN RPR.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM SGC-FIO-RPR.                                        
           MOVE RPR-CIC-IFOL IN RPR TO IPC-CIC-IFOL IN IPC.            
           MOVE SPACES              TO IPC-COD-TDOC IN IPC.            
      *MHM-INI 07-ENE-2009
      *    MOVE FIO-GET-FST TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *MHM-FIN 07-ENE-2009
       LUP-ELI-RPR.                                                    
           PERFORM SGC-FIO-IPC.                                        
      *MHM-INI 07-ENE-2009
      *    IF (FIO-STAT-OKS AND
      *        RPR-CIC-IFOL IN RPR = IPC-CIC-IFOL IN IPC)
           IF NOT (FIO-STAT-OKS AND
              RPR-CIC-IFOL IN RPR = IPC-CIC-IFOL IN IPC)
               GO TO CON-ACA-IND.
      *MHM-FIN 07-ENE-2009
              MOVE IPC-COD-TDOC IN IPC TO TPP-COD-TDOC IN TPP.
              MOVE WSS-GLS-CLIE        TO TPP-COD-TCLI IN TPP.
              MOVE FIO-GET-KEY TO FIO-CMND.
              PERFORM SGC-FIO-TPP.
               IF NOT FIO-STAT-OKS                                     
                  GO TO CON-ACA-IND                                    
               ELSE                                                    
                  PERFORM COMPARA-IPC                                  
                  IF WSS-IND-IPC = ZEROES                              
                     GO TO CON-ACA-IND                                 
                  ELSE                                                 
                     MOVE 'SGC'   TO MSG-COD-SIST                      
                     MOVE 'TPP NOT=IPC' TO MSG-COD-MENS                
                     PERFORM GET-MSG                                   
                     MOVE MSG-GLS-DESC TO FRM-MENS                     
                     MOVE FRM-SUAR-MAL TO FRM-SUAR                     
                     GO TO FIN-ACA-IND.
      *MHM-INI 07-ENE-2009
      *    ELSE
      *        MOVE FIO-GET-NXT TO FIO-CMND
      *        GO TO LUP-ELI-RPR.
      *MHM-FIN 07-ENE-2009
       CON-ACA-IND.                                                    
           IF RPR-IND-ESTA IN RPR = 'I'                                
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
              PERFORM SGC-FIO-RPR                                      
              IF FIO-STAT-OKS                                          
                 MOVE 'A' TO RPR-IND-ESTA IN RPR                       
                 MOVE HOY-FHOY TO RPR-FEC-FSTA IN RPR                  
                 MOVE FIO-MOD TO FIO-CMND                              
                 PERFORM SGC-FIO-RPR                                   
      * INI RGD 01/10/2008
                 IF FIO-STAT-OKS AND SCR-CMND = 'ACA'
                    MOVE 'SGC' TO MSG-COD-SIST
                    MOVE 'RPR    SIACA' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC IN MSG TO FRM-MENS.
      * FIN RGD 01/10/2008
       FIN-ACA-IND.                                                    
           EXIT.                                                       

       MOD-RPR SECTION.                                                
       INI-MOD-RPR.                                                    
           MOVE RPR-CAI-IFOL IN RPR-FLD TO RPR-CAI-IFOL IN RPR.        
           MOVE RPR-IIC-IFOL IN RPR-FLD TO RPR-IIC-IFOL IN RPR.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM SGC-FIO-RPR.                                        
           IF RPR-IND-ESTA IN RPR = 'A'                                
              MOVE 'SGC'   TO MSG-COD-SIST                             
              MOVE 'RPR NO MODI' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                          
              MOVE MSG-GLS-DESC TO FRM-MENS                            
              MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
       FIN-MOD-RPR.                                                    
           EXIT.                                                       
                                                                       
                                                                       
       ELI-RPR SECTION.                                                
       INI-ELI-RPR.                                                    
           MOVE RPR-CAI-IFOL IN RPR-FLD TO RPR-CAI-IFOL IN RPR.        
           MOVE RPR-IIC-IFOL IN RPR-FLD TO RPR-IIC-IFOL IN RPR.        
           MOVE FIO-GET-KEY TO FIO-CMND.                               
           PERFORM SGC-FIO-RPR.                                        
           MOVE RPR-CIC-IFOL IN RPR TO IPC-CIC-IFOL IN IPC.            
           MOVE SPACES              TO IPC-COD-TDOC IN IPC.            
      *RGD-INI PENTA
      *    MOVE FIO-GET-FST TO FIO-CMND.                                
           MOVE FIO-GET-NLS TO FIO-CMND.                                
      *RGD-FIN PENTA
       LUP-ELI-RPR.                                                    
           PERFORM SGC-FIO-IPC.                                        
           IF ((FIO-STAT-OKS AND                                       
                RPR-CIC-IFOL IN RPR = IPC-CIC-IFOL IN IPC) AND         
               (IPC-GLS-INDC IN IPC NOT = 'S'))                        
                GO TO CON-ELI-RPR                                      
           ELSE                                                        
              MOVE FIO-GET-NXT TO FIO-CMND                             
              GO TO LUP-ELI-RPR.                                       
       CON-ELI-RPR.                                                    
           IF RPR-IND-ESTA IN RPR = 'A'                                
              MOVE 'SGC'   TO MSG-COD-SIST                             
              MOVE 'RPR NO ELIMI' TO MSG-COD-MENS                      
              PERFORM GET-MSG                                          
              MOVE MSG-GLS-DESC TO FRM-MENS                            
              MOVE FRM-SUAR-MAL TO FRM-SUAR                            
           ELSE                                                        
              MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
              PERFORM SGC-FIO-RPR                                      
              IF FIO-STAT-OKS                                          
                 MOVE FIO-DEL TO FIO-CMND                              
                 PERFORM SGC-FIO-RPR.                                  
       FIN-ELI-RPR.                                                    
           EXIT.                                                       
                                                                       
       COMPARA-IPC SECTION.                                            
       INI-COMPARA-IPC.                                                
           MOVE ZEROES TO WSS-IND-IPC.                                 
           IF IPC-IND-CRPR IN IPC NOT = 'S' AND                        
              TPP-IND-CRPR IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDPX IN IPC NOT = 'S' AND                        
              TPP-IND-CDPX IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDEX IN IPC NOT = 'S' AND                        
              TPP-IND-CDEX IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDAC IN IPC NOT = 'S' AND                        
              TPP-IND-CDAC IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDPR IN IPC NOT = 'S' AND                        
              TPP-IND-CDPR IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDAP IN IPC NOT = 'S' AND                        
              TPP-IND-CDAP IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDAX IN IPC NOT = 'S' AND                        
              TPP-IND-CDAX IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDAE IN IPC NOT = 'S' AND                        
              TPP-IND-CDAE IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
*          IF IPC-IND-CAEX IN IPC NOT = 'S' AND                        
*             TPP-IND-CAEX IN TPP = 'S'                                
*             ADD 1 TO WSS-IND-IPC                                     
*          ELSE                                                        
           IF IPC-IND-CATC IN IPC NOT = 'S' AND                        
              TPP-IND-CATC IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CBRZ IN IPC NOT = 'S' AND                        
              TPP-IND-CBRZ IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CDBN IN IPC NOT = 'S' AND                        
              TPP-IND-CDBN IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CPAE IN IPC NOT = 'S' AND                        
              TPP-IND-CPAE IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CRGC IN IPC NOT = 'S' AND                        
              TPP-IND-CRGC IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CVEH IN IPC NOT = 'S' AND                        
              TPP-IND-CVEH IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CVOE IN IPC NOT = 'S' AND                        
              TPP-IND-CVOE IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
           IF IPC-IND-CVSC IN IPC NOT = 'S' AND                        
              TPP-IND-CVSC IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC                                     
           ELSE                                                        
      * INI RGD 01/10/2008
      *    IF IPC-IND-DIR1 IN IPC NOT = 'S' AND                        
      *       TPP-IND-DIR1 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-DIR2 IN IPC NOT = 'S' AND                        
      *       TPP-IND-DIR2 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-DIR3 IN IPC NOT = 'S' AND                        
      *       TPP-IND-DIR3 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-DIR4 IN IPC NOT = 'S' AND                        
      *       TPP-IND-DIR4 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-DIR5 IN IPC NOT = 'S' AND                        
      *       TPP-IND-DIR5 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-REX1 IN IPC NOT = 'S' AND                        
      *       TPP-IND-REX1 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-REX2 IN IPC NOT = 'S' AND                        
      *       TPP-IND-REX2 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE
      *    IF IPC-IND-REX3 IN IPC NOT = 'S' AND                        
      *       TPP-IND-REX3 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      *    IF IPC-IND-REX4 IN IPC NOT = 'S' AND                        
      *       TPP-IND-REX4 IN TPP = 'S'                                
      *       ADD 1 TO WSS-IND-IPC                                     
      *    ELSE                                                        
      * FIN RGD 01/10/2008
           IF IPC-IND-OTBN IN IPC NOT = 'S' AND                        
              TPP-IND-OTBN IN TPP = 'S'                                
              ADD 1 TO WSS-IND-IPC.                                    
       FIN-COMPARA-IPC.                                                
           EXIT.                                                       
      *MHM-INI 05-MAR-2007                                              
       ACT-IPC-OLD SECTION.                                             
       INI-ACT-IPC-OLD.                                                 
           MOVE RPR-CAI-IFOL IN RPR-FLD TO IPC-CAI-IFOL IN IPC.         
           MOVE RPR-IIC-IFOL IN RPR-FLD TO IPC-IIC-IFOL IN IPC.         
           MOVE SPACES                  TO IPC-COD-TDOC IN IPC.         
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
       LUP-ACT-IPC-OLD.                                                 
           PERFORM SGC-FIO-IPC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               RPR-CAI-IFOL IN RPR-FLD = IPC-CAI-IFOL IN IPC AND        
               RPR-IIC-IFOL IN RPR-FLD = IPC-IIC-IFOL IN IPC)           
                GO TO FIN-ACT-IPC-OLD.                                  
           MOVE IPC-KEY-IIPC IN IPC TO WSS-KEY-IIPC IN WSS-VARI.        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-ACT-IPC-OLD.                                   
           IF DBC-IND-TICL IN DBC = 'P'                                 
               MOVE 'S' TO IPC-IND-CDPX IN IPC                          
           ELSE                                                         
           IF DBC-IND-TICL IN DBC = 'E'                                 
               MOVE 'S' TO IPC-IND-CDEX IN IPC.                         
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM SGC-FIO-IPC.                                         
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
           PERFORM SGC-FIO-IPC.                                         
       NXT-ACT-IPC-OLD.                                                 
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-ACT-IPC-OLD.                                       
       FIN-ACT-IPC-OLD.                                                 
           EXIT.                                                        
                                                                        
      *MHM-FIN 05-MAR-2007                                              
      *>>>>
*% END
