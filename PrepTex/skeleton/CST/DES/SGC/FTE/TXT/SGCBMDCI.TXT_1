*%! Codigo adicional para archivo
*% IF FIN_PUT_DBC_DCI
      *<<<< FIN_PUT_DBC_DCI
          PERFORM BUS-BAN.                                             
      *>>>>
*% END
*% IF FIN_PUT_DCI_DCI
      *<<<< FIN_PUT_DCI_DCI                                             
           IF DCI-COD-EJEC IN DCI-FLD > SPACES                          
               MOVE DCI-COD-EJEC IN DCI-FLD TO USR-COD-USER IN USR      
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEI IN DCI-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-EJEI IN DCI-FLD.                  
                                                                        
           IF DCI-COD-SGMT IN DCI-FLD > SPACES                          
               MOVE 'SGC'                   TO TAB-COD-SIST             
               MOVE 'SGM'                   TO TAB-COD-TTAB IN TAB      
               MOVE DCI-COD-SGMT IN DCI-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-SGMT IN DCI-FLD  
           ELSE                                                         
               MOVE SPACES                  TO FRM-GLS-SGMT IN DCI-FLD. 
                                                                        
           IF DCI-COD-PEFL IN DCI-FLD > SPACES                          
               MOVE 'SGC'                   TO TAB-COD-SIST             
               MOVE 'PIN'                   TO TAB-COD-TTAB IN TAB      
               MOVE DCI-COD-PEFL IN DCI-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-PEFL IN DCI-FLD  
           ELSE                                                         
               MOVE SPACES                  TO FRM-GLS-PEFL IN DCI-FLD. 
                                                                        
           IF DCI-COD-TINV IN DCI-FLD > SPACES                          
               MOVE 'SGC'                   TO TAB-COD-SIST             
               MOVE 'TIN'                   TO TAB-COD-TTAB IN TAB      
               MOVE DCI-COD-TINV IN DCI-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-TINV IN DCI-FLD  
           ELSE                                                         
               MOVE SPACES                  TO FRM-GLS-TINV IN DCI-FLD. 
                                                                        
           IF DCI-IND-AACC IN DCI-FLD > SPACES                          
               MOVE 'GNS'                   TO TAB-COD-SIST             
               MOVE 'SON'                   TO TAB-COD-TTAB IN TAB      
               MOVE DCI-IND-AACC IN DCI-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-AACC IN DCI-FLD  
           ELSE                                                         
               MOVE SPACES                  TO FRM-GLS-AACC IN DCI-FLD. 
                                                                        
           IF DCI-COD-OFIC IN DCI-FLD > SPACES                          
               MOVE DCI-COD-OFIC IN DCI-FLD TO OFI-COD-OFIC IN OFI      
               PERFORM BUS-OFI                                          
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOI IN DCI-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-OFOI IN DCI-FLD.                  
      *>>>>
*% END
*% IF FIN_KEY_DCI_DCI 
      *<<<< FIN_KEY_DCI_DCI                                             
           MOVE SCR-CAI-ICLI TO DCI-CAI-ICLI IN DCI.                    
           MOVE SCR-IIC-ICLI TO DCI-IIC-ICLI IN DCI.                    
      *>>>>                                                             
*% END
*% IF INI_DBC_GLS_NOMC
      *<<<< INI_DBC_GLS_NOMC                                            
      *NOM-CLI Busca Cliente por medio del Nombre                       
           IF DBC-NUM-ICLI IN DCI-FLD > ZEROES                          
               GO TO FIN-VAL-DBC-GLS-NOMC.                              
                                                                        
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.                          
           MOVE DBC-GLS-NOMC IN DCI-FLD TO STR-GLS-GSTR.                
BORRAR     DISPLAY 'NOMC FLD:' DBC-GLS-NOMC IN DCI-FLD.
           PERFORM STR-UNS.                                             
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC.     
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC.     
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.     
BORRAR     DISPLAY 'APAT:' DBC-GLS-APAT IN DBC.
BORRAR     DISPLAY 'AMAT:' DBC-GLS-AMAT IN DBC.
BORRAR     DISPLAY 'NOMB:' DBC-GLS-NOMB IN DBC.
           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.                            
AKII*******MOVE FIO-GET-NLS-ALT TO FIO-CMND.                            
AKII       MOVE FIO-GET-NLS     TO FIO-CMND.                            
           PERFORM GET-CLI.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FIO-STAT-NEX TO FIO-STAT                            
           ELSE                                                         
               MOVE '00' TO PGM-STAT-DBC                                
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                     
               PERFORM CPT-BLKS                                         
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DCI-FLD                 
                                                                        
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DCI-FLD      
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DCI-FLD      
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DCI-FLD      
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DCI-FLD      
               MOVE DBC-COD-EJEC IN DBC TO DBC-COD-EJEC IN DCI-FLD      
               MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN DCI-FLD      
               MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI                 
               MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI                 
               MOVE '00' TO FIO-STAT                                    
               MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR          
               PERFORM BUS-USR                                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DCI-FLD      
               MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI          
               PERFORM BUS-OFI                                          
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DCI-FLD      
               PERFORM BUS-BAN.                                         
      *>>>>                                                             
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI                                                
           IF DBC-NUM-ICLI IN DCI-FLD > ZEROES                          
               MOVE DBC-NUM-ICLI IN DCI-FLD TO DBC-NUM-ICLI IN DBC      
               MOVE DBC-IND-ICLI IN DCI-FLD TO DBC-IND-ICLI IN DBC      
               MOVE DBC-GLS-ICLI IN DCI-FLD TO DBC-GLS-ICLI IN DBC      
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                         
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DBC                                      
               MOVE FIO-STAT TO PGM-STAT-DBC                            
               IF NOT FIO-STAT-OKS                                      
                   MOVE 'SGC'        TO MSG-COD-SIST                    
                   MOVE 'CLI    NEX' TO MSG-COD-MENS                    
                   PERFORM GET-MSG                                      
                   MOVE SPACES       TO DBC-GLS-NOMC IN DCI-FLD         
                   MOVE MSG-GLS-DESC TO FRM-MENS                        
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                        
                   GO TO FIN-VAL-DBC-GLS-ICLI                           
               ELSE                                                     
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                 
                   PERFORM CPT-BLKS                                     
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DCI-FLD  
                   MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI             
                   MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI             
                   MOVE DBC-COD-EJEC IN DBC TO DBC-COD-EJEC IN DCI-FLD  
                   MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN DCI-FLD  
                   MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR      
                   PERFORM BUS-USR                                      
                   MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DCI-FLD  
                   MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI      
                   PERFORM BUS-OFI                                      
                   MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DCI-FLD  
                   PERFORM BUS-BAN.                                     
      *>>>>                                                             
*% END
*% IF DCI_COD_EJEC
      *<<<< DCI_COD_EJEC                                                
      *VAL-TDU Valida Tipo de Usuario                                   
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.                   
           MOVE DCI-COD-EJEC IN DCI-FLD TO USR-COD-USER IN USR.         
           PERFORM VAL-TDU.                                             
           IF MSG-COD-MENS > SPACES                                     
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
           IF MSG-COD-MENS NOT = 'COD    NEX' AND                       
              DBC-COD-EJEC IN DCI-FLD > SPACES                          
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEI IN DCI-FLD      
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-EJEI IN DCI-FLD.                  
      *>>>>                                                             
*% END
*% IF DCI_COD_SGMT 
      *<<<< DCI_COD_SGMT                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'SGM'                   TO TAB-COD-TTAB IN TAB.         
           MOVE DCI-COD-SGMT IN DCI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
               MOVE SPACES       TO FRM-GLS-SGMT IN DCI-FLD             
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DCI-COD-SGMT                               
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SGMT IN DCI-FLD.      
      *>>>>                                                             
*% END
*% IF DCI_COD_PEFL
      *<<<< DCI_COD_PEFL                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'PIN'                   TO TAB-COD-TTAB IN TAB.         
           MOVE DCI-COD-PEFL IN DCI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
               MOVE SPACES       TO FRM-GLS-PEFL IN DCI-FLD             
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DCI-COD-PEFL                               
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PEFL IN DCI-FLD.     
      *>>>>                                                             
*% END
*% IF DCI_COD_TINV
      *<<<< DCI_COD_TINV                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'TIN'                   TO TAB-COD-TTAB IN TAB.         
           MOVE DCI-COD-TINV IN DCI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
               MOVE SPACES       TO FRM-GLS-TINV IN DCI-FLD             
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DCI-COD-TINV                               
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TINV IN DCI-FLD.
      *>>>>                                                             
*% END
*% IF DCI_COD_OFIC
      *<<<< DCI_COD_OFIC
      *VAL-OFI Valida codigo de Oficina en TABLAS                       
           MOVE DCI-COD-OFIC IN DCI-FLD TO OFI-COD-OFIC IN OFI.         
           PERFORM VAL-OFI.                                             
           IF MSG-COD-MENS NOT = SPACES                                 
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
           IF MSG-COD-MENS = 'COD    NEX'                               
               MOVE SPACES TO FRM-GLS-OFOI IN DCI-FLD                   
           ELSE                                                         
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOI IN DCI-FLD.     
      *>>>>                                                             
*% END
*% IF DCI_IND_AACC
      *<<<< DCI_IND_AACC                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'GNS'                   TO TAB-COD-SIST.                
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.         
           MOVE DCI-IND-AACC IN DCI-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'               
               MOVE SPACES       TO FRM-GLS-AACC IN DCI-FLD             
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-DCI-IND-AACC                               
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AACC IN DCI-FLD.     
      *>>>>                                                             
*% END
*% IF EOF_BQ 
      *<<<< EOF_BQ 
       BUS-BAN SECTION.                                                 
       INI-BUS-BAN.                                                     
           IF DBC-IND-TICL IN DBC = 'P'                                 
               MOVE DBC-CAI-ICLI IN DBC TO DCP-CAI-ICLI IN DCP          
               MOVE DBC-IIC-ICLI IN DBC TO DCP-IIC-ICLI IN DCP          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DCP                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE SPACES TO FRM-COD-TBAN IN DCI-FLD                
                  MOVE SPACES TO FRM-GLS-TBAN IN DCI-FLD                
               ELSE                                                     
                  MOVE DCP-COD-TBAN IN DCP TO FRM-COD-TBAN IN DCI-FLD   
           ELSE                                                         
           IF DBC-IND-TICL IN DBC = 'E'                                 
               MOVE DBC-CAI-ICLI IN DBC TO DCE-CAI-ICLI IN DCE          
               MOVE DBC-IIC-ICLI IN DBC TO DCE-IIC-ICLI IN DCE          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM SGC-FIO-DCE                                      
               IF NOT FIO-STAT-OKS                                      
                  MOVE SPACES TO FRM-COD-TBAN IN DCI-FLD                
                  MOVE SPACES TO FRM-GLS-TBAN IN DCI-FLD                
               ELSE                                                     
                  MOVE DCE-COD-TBAN IN DCE TO FRM-COD-TBAN IN DCI-FLD.  
                                                                        
           IF FRM-COD-TBAN IN DCI-FLD > SPACES                          
               MOVE 'SGC'                   TO TAB-COD-SIST             
               MOVE 'BAN'                   TO TAB-COD-TTAB IN TAB      
               MOVE FRM-COD-TBAN IN DCI-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-TBAN IN DCI-FLD  
           ELSE                                                         
               MOVE SPACES                  TO FRM-GLS-TBAN IN DCI-FLD. 
       FIN-BUS-BAN.                                                     
           EXIT.                                                        
      *>>>>
*% END
