*%! Codigo adicional para archivo
*% NO_HDR_CST = TRUE
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
       COPY SGCBRRCD.
       COPY GNSWGSTR.
       COPY GNSWGCPT.
*%! IF PGM_PER
       COPY TABWGLOC.
*%! END
       01  WSS-VARI.
           03 WSS-FEC-FCNC.
              05 WSS-NUM-DCNC                         PIC 9(02).
              05 WSS-NUM-MCNC                         PIC 9(02).
              05 WSS-NUM-SCNC                         PIC 9(02).
              05 WSS-NUM-ACNC                         PIC 9(02).
           03 WSS-COD-LUGA.
              05 WSS-COD-COMU                         PIC X(04).
              05 WSS-GLS-PAIS  REDEFINES  WSS-COD-COMU.
                 07 WSS-IND-PAIS                      PIC X(01).
                 07 WSS-COD-PAIS                      PIC X(03).
*% IF PGM_VMS
       01  SCR-OTRN           PIC X(04).
       01  SCR-USER           PIC X(12).
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
      *>>>>
*% END
*% IF PGM_INI
           MOVE SPACES TO RCD
           MOVE SPACES TO REC
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF FRM-NUM-ICLI IN EMP-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE FRM-NUM-ICLI IN EMP-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN EMP-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN EMP-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE SPACES TO REC-CAI-ICLI IN EMP-FLD
                   MOVE SPACES TO REC-IIC-ICLI IN EMP-FLD
                   MOVE SPACES TO FRM-GLS-NOMC IN EMP-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN EMP-FLD
                   
                   MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-ICLI IN EMP-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-ICLI IN EMP-FLD
           ELSE
               IF FRM-GLS-NOMC IN EMP-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

                   MOVE FRM-GLS-NOMC IN EMP-FLD TO STR-GLS-GSTR
                   PERFORM STR-UNS
                   MOVE STR-GLS-FUNS IN STR-VARI(1) TO 
                                        DBC-GLS-APAT IN DBC
                   MOVE STR-GLS-FUNS IN STR-VARI(2) TO 
                                        DBC-GLS-AMAT IN DBC
                   MOVE STR-GLS-FUNS IN STR-VARI(3) TO 
                                        DBC-GLS-NOMB IN DBC

                   MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
                   MOVE FIO-GET-NLS    TO FIO-CMND
                   PERFORM GET-CLI
                   IF MSG-COD-MENS > SPACES
                       MOVE ZEROES TO FRM-NUM-ICLI IN EMP-FLD
                       MOVE SPACES TO FRM-VRF-ICLI IN EMP-FLD
                       MOVE SPACES TO FRM-IND-ICLI IN EMP-FLD
*% IF PGM_ARG
                       MOVE ZEROES TO FRM-GLS-ICLI IN EMP-FLD
*% ELSE
                       MOVE SPACES TO FRM-GLS-ICLI IN EMP-FLD
*% END
                       MOVE SPACES TO REC-CAI-ICLI IN EMP-FLD
                       MOVE SPACES TO REC-IIC-ICLI IN EMP-FLD
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       GO TO FIN-FND-KEY
                   ELSE
                       
                       MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                       PERFORM CPT-BLKS
                       MOVE CPT-STRN TO FRM-GLS-NOMC IN EMP-FLD
                       
                       MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-ICLI
                                                             IN EMP-FLD.
      * Mover complemento de la llave
           IF FRM-NUM-IEMP IN EMP-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE FRM-NUM-IEMP IN EMP-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-IEMP IN EMP-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-IEMP IN EMP-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE SPACES TO REC-CAI-IREL IN EMP-FLD
                   MOVE SPACES TO REC-IIC-IREL IN EMP-FLD
                   MOVE SPACES TO FRM-GLS-NOME IN EMP-FLD
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'EMP    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOME IN EMP-FLD

                   MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-IREL IN EMP-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-IREL IN EMP-FLD
           ELSE
               IF FRM-GLS-NOME IN EMP-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

                   MOVE FRM-GLS-NOME IN EMP-FLD TO STR-GLS-GSTR
                   PERFORM STR-UNS
                   MOVE STR-GLS-FUNS IN STR-VARI(1) TO 
                                        DBC-GLS-APAT IN DBC
                   MOVE STR-GLS-FUNS IN STR-VARI(2) TO 
                                        DBC-GLS-AMAT IN DBC
                   MOVE STR-GLS-FUNS IN STR-VARI(3) TO 
                                        DBC-GLS-NOMB IN DBC

                   MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
                   MOVE FIO-GET-NLS    TO FIO-CMND
                   PERFORM GET-CLI
                   IF MSG-COD-MENS > SPACES
                       MOVE ZEROES TO FRM-NUM-IEMP IN EMP-FLD
                       MOVE SPACES TO FRM-VRF-IEMP IN EMP-FLD
                       MOVE SPACES TO FRM-IND-IEMP IN EMP-FLD
*% IF PGM_ARG
                       MOVE ZEROES TO FRM-GLS-IEMP IN EMP-FLD
*% ELSE
                       MOVE SPACES TO FRM-GLS-IEMP IN EMP-FLD
*% END
                       MOVE SPACES TO REC-CAI-IREL IN EMP-FLD
                       MOVE SPACES TO REC-IIC-IREL IN EMP-FLD
                       MOVE FIO-STAT-NEX TO FIO-STAT
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       GO TO FIN-FND-KEY
                   ELSE
                       
                       MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                       PERFORM CPT-BLKS
                       MOVE CPT-STRN TO FRM-GLS-NOME IN EMP-FLD

                       MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IEMP
                                                             IN EMP-FLD
                       MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IEMP
                                                             IN EMP-FLD
                       MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IEMP
                                                             IN EMP-FLD
                       MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IEMP
                                                             IN EMP-FLD
                       MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-IREL
                                                             IN EMP-FLD
                       MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-IREL
                                                             IN EMP-FLD.

           IF REC-CAI-ICLI IN EMP-FLD = REC-CAI-IREL IN EMP-FLD AND
              REC-IIC-ICLI IN EMP-FLD = REC-IIC-IREL IN EMP-FLD
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'CICICLI=IREL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.

           MOVE SPACES TO REC-KEY-IREC.
           PERFORM KEY-ALL-EMP.
           IF ( REC-CAI-ICLI IN REC > SPACES  OR
                REC-IIC-ICLI IN REC > SPACES )  AND
              ( REC-CAI-IREL IN REC > SPACES  OR
                REC-IIC-IREL IN REC > SPACES )
               PERFORM BUS-COR-REC
      *        MOVE FIO-GET-KEY TO FIO-CMND
      *        PERFORM SGC-FIO-REC
               GO TO CON-FND-KEY.

           IF ( REC-CAI-ICLI IN REC > SPACES     OR
                REC-IIC-ICLI IN REC > SPACES )      AND
              ( REC-CAI-IREL IN REC NOT > SPACES AND
                REC-IIC-IREL IN REC NOT > SPACES )
               PERFORM BUS-ICLI-IREL
               IF FIO-STAT = FIO-STAT-NEX
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO CON-FND-KEY.

           IF ( REC-CAI-ICLI IN REC NOT > SPACES AND
                REC-IIC-ICLI IN REC NOT > SPACES )  AND
              ( REC-CAI-IREL IN REC > SPACES     OR
                REC-IIC-IREL IN REC > SPACES )
               PERFORM BUS-IREL-ICLI
               IF FIO-STAT = FIO-STAT-NEX
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO CON-FND-KEY.

       CON-FND-KEY.
           MOVE FIO-STAT       TO PGM-STAT-REC.
           MOVE 'SGC'          TO MSC-COD-SIST.
           MOVE 'TDIR'         TO MSC-CIC-TMSC.
           MOVE 'E'            TO MSC-CIC-CMSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICDIRENEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY
           ELSE
               MOVE MSC-COD-CMSC IN MSC TO RCD-MSC-TDIR IN EMP-FLD.

           PERFORM KEY-RCD-EMP.
           MOVE ZEROES      TO RCD-NUM-DIRE IN RCD.
           MOVE ZEROES      TO RCD-NUM-DIRE IN EMP-FLD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-NXT-RCD.
           PERFORM SGC-FIO-RCD.
           IF FIO-STAT-OKS AND
              RCD-CAI-ICLI IN RCD = REC-CAI-ICLI IN EMP-FLD AND
              RCD-IIC-ICLI IN RCD = REC-IIC-ICLI IN EMP-FLD
               MOVE RCD-NUM-DIRE IN RCD TO RCD-NUM-DIRE IN EMP-FLD
               IF RCD-MSC-TDIR IN RCD NOT = RCD-MSC-TDIR IN EMP-FLD
                   MOVE FIO-GET-NXT  TO FIO-CMND
                   GO TO LUP-NXT-RCD
               ELSE
                   MOVE FIO-STAT TO PGM-STAT-RCD
           ELSE
               ADD 1 TO RCD-NUM-DIRE IN EMP-FLD.

           IF ( SCR-CCPP = 'ING' OR 'ACT' ) AND
              ( NOT PGM-STAT-REC-OKS ) AND PGM-STAT-RCD-OKS
               PERFORM PUT-RCD-EMP.

           MOVE PGM-STAT-REC TO FIO-STAT.

           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM RET-HDR-REC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

           PERFORM PUT-REC-INV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-REC
               GO TO FIN-CMN-ING.

           PERFORM PUT-RCD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-REC.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           PERFORM PUT-REC-INV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-REC
               GO TO FIN-CMN-MOD.

           PERFORM PUT-RCD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-REC.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       RET-REC-EMP SECTION.
       INI-RET-REC-EMP.
           MOVE REC-IND-VIGE IN EMP-FLD TO REC-IND-VIGE IN REC.
           MOVE REC-NUM-DINI IN EMP-FLD TO REC-NUM-DINI IN REC.
           MOVE REC-NUM-MINI IN EMP-FLD TO REC-NUM-MINI IN REC.
           MOVE REC-NUM-SINI IN EMP-FLD TO REC-NUM-SINI IN REC.
           MOVE REC-NUM-AINI IN EMP-FLD TO REC-NUM-AINI IN REC.
           MOVE REC-NUM-DTER IN EMP-FLD TO REC-NUM-DTER IN REC.
           MOVE REC-NUM-MTER IN EMP-FLD TO REC-NUM-MTER IN REC.
           MOVE REC-NUM-STER IN EMP-FLD TO REC-NUM-STER IN REC.
           MOVE REC-NUM-ATER IN EMP-FLD TO REC-NUM-ATER IN REC.
           MOVE REC-COD-AREC IN EMP-FLD TO REC-COD-AREC IN REC.
           MOVE REC-NUM-DVRF IN EMP-FLD TO REC-NUM-DVRF IN REC.
           MOVE REC-NUM-MVRF IN EMP-FLD TO REC-NUM-MVRF IN REC.
           MOVE REC-NUM-SVRF IN EMP-FLD TO REC-NUM-SVRF IN REC.
           MOVE REC-NUM-AVRF IN EMP-FLD TO REC-NUM-AVRF IN REC.
           MOVE REC-SGV-AREC IN EMP-FLD TO REC-SGV-AREC IN REC.
           MOVE REC-COD-VCAM IN EMP-FLD TO REC-COD-VCAM IN REC.
           MOVE REC-NUM-DVAL IN EMP-FLD TO REC-NUM-DVAL IN REC.
           MOVE REC-NUM-MVAL IN EMP-FLD TO REC-NUM-MVAL IN REC.
           MOVE REC-NUM-SVAL IN EMP-FLD TO REC-NUM-SVAL IN REC.
           MOVE REC-NUM-AVAL IN EMP-FLD TO REC-NUM-AVAL IN REC.
       FIN-RET-REC-EMP.
           EXIT.
       
       RET-RCD-EMP SECTION.
       INI-RET-RCD-EMP.
           MOVE RCD-MSC-TDIR IN EMP-FLD TO RCD-MSC-TDIR IN RCD.
           MOVE RCD-GLS-DIRE IN EMP-FLD TO RCD-GLS-DIRE IN RCD.
           MOVE RCD-GLS-FONO IN EMP-FLD TO RCD-GLS-FONO IN RCD.
           MOVE RCD-COD-LUGA IN EMP-FLD TO RCD-COD-LUGA IN RCD.
           MOVE RCD-MSC-SDIR IN EMP-FLD TO RCD-MSC-SDIR IN RCD.
       FIN-RET-RCD-EMP.
           EXIT.
      *>>>>
*% END
*% IF EOF AND PGM_PU
      *<<<< EOF AND PGM_PU
       PUT-REC-INV SECTION.
       INI-PUT-REC-INV.
           IF FRM-COD-TREC IN EMP-FLD > SPACES
               PERFORM MOV-KEY-INV-REC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-REC
               IF FIO-STAT-OKS
                   PERFORM RET-REC-EMP
                   MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC
                   PERFORM MOV-KEY-INV-REC
                   PERFORM RET-HDR-REC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-REC
               ELSE
                   PERFORM RET-REC-EMP
                   MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC
                   PERFORM RET-HDR-REC
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM SGC-FIO-REC.
       FIN-PUT-REC-INV.
           EXIT.

       PUT-RCD SECTION.
       INI-PUT-RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF FIO-STAT-OKS
               PERFORM RET-RCD-EMP
               MOVE REC-STP-ITRN IN REC TO RCD-STP-ITRN IN RCD
               PERFORM RET-HDR-RCD
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-RCD
           ELSE
               PERFORM RET-RCD-EMP
               MOVE REC-STP-ITRN IN REC TO RCD-STP-ITRN IN RCD
               PERFORM RET-HDR-DBC
               MOVE FIO-PUT TO FIO-CMND
               PERFORM SGC-FIO-RCD
               PERFORM PUT-DBC.
       FIN-PUT-RCD.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           IF FIO-STAT-OKS
               MOVE RCD-CIC-ICLI IN RCD TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY-UPD     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE RCD-STP-ITRN IN RCD TO DBC-STP-ITRN IN DBC
                   ADD     1    TO DBC-NUM-TDIR IN DBC
                   PERFORM RET-HDR-DBC
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-DBC.
       FIN-PUT-DBC.
           EXIT.

       RET-HDR-DBC SECTION.
       INI-RET-HDR-DBC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DBC-FEC-FTRN IN DBC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DBC-HRA-HRTR IN DBC.
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO DBC-COD-OTRN IN DBC.
      *    Autor Transaccion
           MOVE SCR-USER TO DBC-COD-ATRN IN DBC.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DBC-MSC-TACC IN DBC
               MOVE 'I' TO DBC-MSC-STAT IN DBC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DBC-MSC-TACC IN DBC
               MOVE 'M' TO DBC-MSC-STAT IN DBC.
       FIN-RET-HDR-DBC.
           EXIT.

       RET-HDR-REC SECTION.
       INI-RET-HDR-REC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO REC-FEC-FTRN IN REC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO REC-HRA-HRTR IN REC.
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO REC-COD-OTRN IN REC.
      *    Autor Transaccion
           MOVE SCR-USER TO REC-COD-ATRN IN REC.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO REC-MSC-TACC IN REC
               MOVE 'I' TO REC-MSC-STAT IN REC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO REC-MSC-TACC IN REC
               MOVE 'M' TO REC-MSC-STAT IN REC.
       FIN-RET-HDR-REC.
           EXIT.

       RET-HDR-RCD SECTION.
       INI-RET-HDR-RCD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RCD-FEC-FTRN IN RCD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RCD-HRA-HRTR IN RCD.
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO RCD-COD-OTRN IN RCD.
      *    Autor Transaccion
           MOVE SCR-USER TO RCD-COD-ATRN IN RCD.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RCD-MSC-TACC IN RCD
               MOVE 'I' TO RCD-MSC-STAT IN RCD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RCD-MSC-TACC IN RCD
               MOVE 'M' TO RCD-MSC-STAT IN RCD.
       FIN-RET-HDR-RCD.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-ICLI-IREL SECTION.
       INI-BUS-ICLI-IREL.
           MOVE '999999999999' TO REC-CIC-IREL IN REC.
           MOVE 99             TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ    TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-ICLI IN REC = REC-CAI-ICLI IN EMP-FLD AND
              REC-IIC-ICLI IN REC = REC-IIC-ICLI IN EMP-FLD AND
              REC-COD-TREC IN REC = REC-COD-TREC IN EMP-FLD 
               MOVE REC-NUM-TREC IN REC TO REC-NUM-TREC IN EMP-FLD
               MOVE REC-CAI-IREL IN REC TO DBC-CAI-ICLI IN DBC
               MOVE REC-IIC-IREL IN REC TO DBC-IIC-ICLI IN DBC
               PERFORM LEE-CIC-DBC
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE SPACES TO REC-CAI-IREL IN EMP-FLD
                   MOVE SPACES TO REC-IIC-IREL IN EMP-FLD
                   MOVE SPACES TO FRM-GLS-NOME IN EMP-FLD
               ELSE
                   MOVE CPT-STRN            TO FRM-GLS-NOME IN EMP-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IEMP IN EMP-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IEMP IN EMP-FLD
                   MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IEMP IN EMP-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IEMP IN EMP-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-IREL IN EMP-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-IREL IN EMP-FLD
           ELSE
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'CLI    NOEMR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-ICLI-IREL.
           EXIT.

       BUS-IREL-ICLI SECTION.
       INI-BUS-IREL-ICLI.
           MOVE FIO-GET-LEQ    TO FIO-CMND.
       LUP-PRV-ICLI.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-IREL IN REC = REC-CAI-IREL IN EMP-FLD AND
              REC-IIC-IREL IN REC = REC-IIC-IREL IN EMP-FLD
               IF REC-COD-TREC IN REC = REC-COD-TREC IN EMP-FLD
                   MOVE REC-NUM-TREC IN REC TO REC-NUM-TREC IN EMP-FLD
                   MOVE REC-CAI-ICLI IN REC TO DBC-CAI-ICLI IN DBC
                   MOVE REC-IIC-ICLI IN REC TO DBC-IIC-ICLI IN DBC
                   PERFORM LEE-CIC-DBC
                   IF FIO-STAT = FIO-STAT-NEX
                       MOVE SPACES TO REC-CAI-ICLI IN EMP-FLD
                       MOVE SPACES TO REC-IIC-ICLI IN EMP-FLD
                       MOVE SPACES TO FRM-GLS-NOMC IN EMP-FLD
                   ELSE
                       MOVE CPT-STRN     TO FRM-GLS-NOMC     IN EMP-FLD
                       MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-ICLI
                                                             IN EMP-FLD
                       MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-ICLI
                                                             IN EMP-FLD
               ELSE
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-PRV-ICLI
           ELSE
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'CLI    NOEMO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IREL-ICLI.
           EXIT.

       LEE-CIC-DBC SECTION.
       INI-LEE-CIC-DBC.
      *CIC-CLI Busca Cliente por medio del CIC
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS.
       FIN-LEE-CIC-DBC.
           EXIT.

       BUS-COR-REC SECTION.
       INI-BUS-COR-REC.
           MOVE ZEROES       TO REC-NUM-TREC IN EMP-FLD.
           MOVE REC-CAI-ICLI IN EMP-FLD TO REC-CAI-ICLI IN REC.
           MOVE REC-IIC-ICLI IN EMP-FLD TO REC-IIC-ICLI IN REC.
           MOVE REC-CAI-IREL IN EMP-FLD TO REC-CAI-IREL IN REC.
           MOVE REC-IIC-IREL IN EMP-FLD TO REC-IIC-IREL IN REC.
           MOVE REC-COD-TREC IN EMP-FLD TO REC-COD-TREC IN REC.
           MOVE 99                      TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-ICLI IN EMP-FLD = REC-CAI-ICLI IN REC AND
              REC-IIC-ICLI IN EMP-FLD = REC-IIC-ICLI IN REC AND
              REC-CAI-IREL IN EMP-FLD = REC-CAI-IREL IN REC AND
              REC-IIC-IREL IN EMP-FLD = REC-IIC-IREL IN REC AND
              REC-COD-TREC IN EMP-FLD = REC-COD-TREC IN REC
               MOVE REC-NUM-TREC IN REC TO REC-NUM-TREC IN EMP-FLD
               IF SCR-CCPP = 'ING' OR 'ACT'
                   ADD   1   TO REC-NUM-TREC IN EMP-FLD
                   MOVE '23' TO FIO-STAT
               ELSE
                   MOVE '00' TO FIO-STAT
           ELSE
               IF SCR-CCPP = 'ING' OR 'ACT'
                   MOVE   1  TO REC-NUM-TREC IN EMP-FLD
                   MOVE '23' TO FIO-STAT
               ELSE
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'RECCLTENEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-COR-REC.
           EXIT.

       MOV-KEY-INV-REC SECTION.
       INI-MOV-KEY-INV-REC.
           MOVE REC-CAI-ICLI IN EMP-FLD TO REC-CAI-IREL IN REC.
           MOVE REC-IIC-ICLI IN EMP-FLD TO REC-IIC-IREL IN REC.
           MOVE REC-CAI-IREL IN EMP-FLD TO REC-CAI-ICLI IN REC.
           MOVE REC-IIC-IREL IN EMP-FLD TO REC-IIC-ICLI IN REC.
           MOVE FRM-COD-TREC IN EMP-FLD TO REC-COD-TREC IN REC.
       FIN-MOV-KEY-INV-REC.
           EXIT.

       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY SGCBFRCD.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
*% IF PGM_PU
       COPY GNSBEGLS.
*% END
       COPY SGCBGCLI.
*%! IF PGM_PER
       COPY TABBBLOC.
       COPY TABBVLOC.
*%! END
      *>>>>
*% END
