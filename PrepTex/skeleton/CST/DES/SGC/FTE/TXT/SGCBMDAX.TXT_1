*% IF PGM_BU
*% IF SETTAG
      ***************************************************************
      *MANTENCION: CAMBIO FECHA HABIL
      *RESPONSABLE: AFRI
      *FECHA: NOV-2011.
      *ETIQUETA: *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
      *CAMBIOS: SE DEJA SIN VALIDACION DE DIA HABIL CAMPO
      *         FECHA RETIRO TITULAR Y FECHA RETIRO CONYUGE
      **************************************************************
*% END
*% END
*% IF INI_DAP_FEC_FREC
      *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL
*% END
*% IF FIN_DAP_IND_CALB
      *<<<< DAP_IND_CALB                                                
      *RGD-INI PENTA
      *    IF DAP-IND-CALB IN DAX-FLD = 'D' OR 'M' OR 'A'               
      *       CONTINUE                                                  
      *    ELSE                                                         
      *       MOVE MSG-GLS-DESC TO FRM-MENS                             
      *       MOVE FRM-SUAR-MAL TO FRM-SUAR                             
      *       GO TO FIN-VAL-DAP-IND-CALB.                               

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE DAP-IND-CALB IN DAX-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DAP-IND-CALB IN DAX-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CALB IN DAX-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-CALB IN DAX-FLD.

           IF  DAP-NUM-CALB IN DAX-FLD = ZEROES  AND
               DAP-IND-CALB IN DAX-FLD > SPACES
               MOVE SPACES         TO FRM-GLS-CALB IN DAX-FLD
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'CAMPOBLANCO'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DAP-IND-CALB.

           IF  DAP-NUM-CALB IN DAX-FLD > ZEROES  AND
               DAP-IND-CALB IN DAX-FLD = SPACES
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'GLS    BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DAP-IND-CALB.

      *RGD-FIN PENTA
      *>>>>                                                             
*% END
*% IF FIN_DAP_IND_WALB
      *<<<< DAP_IND_WALB                                                
      *RGD-INI PENTA
      *    IF DAP-IND-WALB IN DAX-FLD = 'D' OR 'M' OR 'A'               
      *       CONTINUE                                                  
      *    ELSE                                                         
      *       MOVE SPACES TO DAP-IND-WALB IN DAX-FLD.                   

      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE DAP-IND-WALB IN DAX-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DAP-IND-WALB IN DAX-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-WALB IN DAX-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-WALB IN DAX-FLD.

           IF  DAP-NUM-WALB IN DAX-FLD = ZEROES  AND
               DAP-IND-WALB IN DAX-FLD > SPACES
               MOVE SPACES         TO FRM-GLS-CALB IN DAX-FLD
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'CAMPOBLANCO'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DAP-IND-WALB.

           IF  DAP-NUM-WALB IN DAX-FLD > ZEROES  AND
               DAP-IND-WALB IN DAX-FLD = SPACES
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'GLS    BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DAP-IND-WALB.

      *RGD-FIN PENTA
      *>>>>                                                             
*% END
*% IF INI_RET_DAP_DAX
           IF SCR-CCPP = 'MOD'                                          
              MOVE DAP-COD-EEFR IN DAP TO DAP-COD-EEFR IN DAX-FLD       
              MOVE DAP-NUM-DEFR IN DAP TO DAP-NUM-DEFR IN DAX-FLD       
              MOVE DAP-NUM-MEFR IN DAP TO DAP-NUM-MEFR IN DAX-FLD       
              MOVE DAP-NUM-SEFR IN DAP TO DAP-NUM-SEFR IN DAX-FLD       
              MOVE DAP-NUM-AEFR IN DAP TO DAP-NUM-AEFR IN DAX-FLD.  
*% END
*% IF FIN_DBC_GLS_ICLI      
      *<<<< DBC_GLS_ICLI                                                
           IF DBC-NUM-ICLI IN DAX-FLD > ZEROES                          
              MOVE DBC-NUM-ICLI IN DAX-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE DBC-IND-ICLI IN DAX-FLD TO DBC-IND-ICLI IN DBC       
              MOVE DBC-GLS-ICLI IN DAX-FLD TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                          
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC                                       
              IF NOT FIO-STAT-OKS                                       
                  MOVE 'SGC'        TO MSG-COD-SIST                     
                  MOVE 'CLI    NEX' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE SPACES       TO FRM-GLS-NOMC IN DAX-FLD          
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-DBC-GLS-ICLI                            
              ELSE                                                      
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
                  PERFORM CPT-BLKS                                      
                  MOVE CPT-STRN  TO FRM-GLS-NOMC IN DAX-FLD             
                  MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI              
                  MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.             
      *>>>>                                                             
*% END
*% IF FIN_PUT_DAP_DAX
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF DAP-IND-CALB IN DAX-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE DAP-IND-CALB IN DAX-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-CALB IN DAX-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-CALB IN DAX-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF DAP-IND-WALB IN DAX-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE DAP-IND-WALB IN DAX-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-WALB IN DAX-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-WALB IN DAX-FLD.
*% END
*% IF FIN_UNP_DAP_DAX
           MOVE FRM-CPIM-UBY TO DAP-GLS-CRGE-ATR IN DAX-FLD.            
           MOVE FRM-CPIM-UBY TO DAP-GLS-CRGC-ATR IN DAX-FLD.            
*% END
*% IF PGM_BU
*% IF FIN_PRO_DAP_DAX
           MOVE FRM-CPIM-AEY TO DAP-GLS-CRGE-ATR IN DAX-FLD.            
           MOVE FRM-CPIM-AEY TO DAP-GLS-CRGC-ATR IN DAX-FLD.            
*% END
*% END
*% IF INI_DAP_GLS_CRGC
           IF DAP-GLS-CRGC IN DAX-FLD NOT > SPACES                      
              MOVE SPACES TO DAP-GLS-CRGC IN DAX-FLD.                   
*% END
*% IF INI_DAP_GLS_CRGE
           IF DAP-GLS-CRGE IN DAX-FLD NOT > SPACES                      
              MOVE SPACES TO DAP-GLS-CRGE IN DAX-FLD.                   
*% END
*% IF INI_DAP_FEC_FRET
      *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL
*% END
