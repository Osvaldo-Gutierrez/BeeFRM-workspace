      * Calculo Moralidad
       CAL-MRL SECTION.
       INI-CAL-MRL.
           MOVE 'N' TO MRL-IND-PROT IN MRL.
           PERFORM GET-FHOY.
           MOVE HOY-SHOY IN HOY-VARI TO MRL-NUM-SHOY IN MRL.
           MOVE HOY-AHOY IN HOY-VARI TO MRL-NUM-AHOY IN MRL.
           MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
           MOVE 'CTE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE 'TAB' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'   TO MSG-COD-SIST
               MOVE 'CICCTACNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-CAL-MRL.
           MOVE TAB-COD-CTAB IN TAB TO MRL-COD-CCTE IN MRL.
           MOVE MRL-CIC-ICLI IN MRL TO RCO-CIC-ICLI IN RCO.
           MOVE SPACES              TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-MRL-RCO.
           PERFORM SGC-FIO-RCO.
           IF NOT ( FIO-STAT-OKS AND
              MRL-CIC-ICLI IN MRL = RCO-CIC-ICLI IN RCO )
               MOVE '00' TO FIO-STAT
               GO TO FIN-CAL-MRL.
           IF RCO-COD-COPR IN RCO NOT = MRL-COD-CCTE IN MRL
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-MRL-RCO.
           MOVE RCO-CIC-IOPE IN RCO TO CHP-CIC-ICCT IN CHP.
           MOVE SPACES              TO CHP-NUM-ICHP IN CHP.
           MOVE SPACES              TO CHP-FEC-FCHP IN CHP.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-MRL-CHP.
           PERFORM SGC-FIO-CHP.
           IF NOT ( FIO-STAT-OKS AND
              RCO-CIC-IOPE IN RCO = CHP-CIC-ICCT IN CHP )
               GO TO BUS-MRL-PHI.
           MOVE CHP-NUM-SCHP IN CHP TO MRL-NUM-SCHP IN MRL.
           MOVE CHP-NUM-ACHP IN CHP TO MRL-NUM-ACHP IN MRL.
           SUBTRACT MRL-NUM-ANOS IN MRL FROM MRL-NUM-FHOY IN MRL GIVING
                    MRL-NUM-SANO IN MRL.
           IF MRL-NUM-FCHP IN MRL < MRL-NUM-SANO IN MRL
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-MRL-CHP.
           IF CHP-FEC-FACL IN CHP NOT > ZEROES
               MOVE 'S' TO MRL-IND-PROT IN MRL
               GO TO FIN-CAL-MRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-MRL-CHP.
       BUS-MRL-PHI.
           MOVE RCO-CIC-IOPE IN RCO TO PHI-CIC-ICCT IN PHI.
           MOVE SPACES              TO PHI-NUM-ICHP IN PHI.
           MOVE SPACES              TO PHI-FEC-FCHP IN PHI.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-MRL-PHI.
           PERFORM SGC-FIO-PHI.
           IF NOT ( FIO-STAT-OKS AND
              RCO-CIC-IOPE IN RCO = PHI-CIC-ICCT IN PHI )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-MRL-RCO.
           MOVE PHI-NUM-SCHP IN PHI TO MRL-NUM-SCHP IN MRL.
           MOVE PHI-NUM-ACHP IN PHI TO MRL-NUM-ACHP IN MRL.
           SUBTRACT MRL-NUM-ANOS IN MRL FROM MRL-NUM-FHOY IN MRL GIVING
                    MRL-NUM-SANO IN MRL.
           IF MRL-NUM-FCHP IN MRL < MRL-NUM-SANO IN MRL
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-MRL-PHI.
           IF PHI-FEC-FACL IN PHI NOT > ZEROES
               MOVE 'S' TO MRL-IND-PROT IN MRL
               GO TO FIN-CAL-MRL.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-MRL-PHI.
       FIN-CAL-MRL.
           EXIT.
