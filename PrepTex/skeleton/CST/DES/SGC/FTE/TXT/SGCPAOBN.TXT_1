*%! Codigo adicional para archivo COLPQQTI
*% IF SETTAG
*% FNCPQ = " "
*% VSNPQ = " "
*% END
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "SGCZQOBN"
*% ELSE
*% CLRMFC = "SGCZUOBN"
*% END
*% PGM_PTC = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-CIC-ICLI.
              05 SCR-CAI-ICLI            PIC X(04).
              05 SCR-IIC-ICLI            PIC X(08).
      *>>>>      
*% END             
*% IF WSS                                                         
      *<<<< WSS   
       COPY GNSWGCPT.
       COPY SGCBRIPC.
       COPY SGCBRDBC.
       COPY SGCBRRPR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.


       01 WSS-VARI.
           03 WSS-KEY-IIPC                 PIC X(15).
           03 WSS-FND-INFO                 PIC X(01).
           03 WSS-EXI-ROBN                 PIC X(01).
           03 WSS-ULT-INFO                 PIC X(01).
           03 WSS-CIC-IFOL                 PIC X(12).
           03 WSS-FIO-STAT                 PIC X(02).
           03 WSS-FIO-STT1                 PIC 9(01).
           03 WSS-FEC-DSPL.
              05 WSS-DIA-DSPL              PIC 99.
              05 WSS-MES-DSPL              PIC 99.
              05 WSS-SIG-DSPL              PIC 99.
              05 WSS-ANO-DSPL              PIC 99.
           03 WSS-IND-OTBN                 PIC X(01).

      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF SCR-CMND = 'ING'
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO OBN-NUM-DEFR IN OBN-FLD
               MOVE HOY-MHOY TO OBN-NUM-MEFR IN OBN-FLD
               MOVE HOY-SHOY TO OBN-NUM-SEFR IN OBN-FLD
               MOVE HOY-AHOY TO OBN-NUM-AEFR IN OBN-FLD
               MOVE SCR-USER TO OBN-COD-EEFR IN OBN-FLD.
      *>>>>                 
*% END     
*% IF FND_KEY
      *<<<< FND_KEY
           IF OBN-IIC-IFOL IN OBN-FLD > ZEROES
               PERFORM OBT-FOL
           ELSE
           IF DBC-NUM-ICLI IN OBN-FLD > ZEROES
               PERFORM OBT-CLI-FOL.

           IF MSG-COD-MENS > SPACES
               GO TO FIN-FND-KEY.

           MOVE RPR-CAI-IFOL TO OBN-CAI-IFOL IN OBN.
           MOVE RPR-IIC-IFOL TO OBN-IIC-IFOL IN OBN.
           MOVE RPR-CAI-IFOL TO OBN-CAI-IFOL IN OBN-FLD.
           MOVE RPR-IIC-IFOL TO OBN-IIC-IFOL IN OBN-FLD.

           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-OBN
               GO TO CON-FND-KEY.
           IF OBN-NUM-IOBN IN OBN-FLD NOT > ZEROES
               PERFORM BUS-COR-OBN.
       CON-FND-KEY.
      *>>>>                 
*% END     
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FIO-STAT-OKS AND
              RPR-IND-ESTA IN RPR = 'A' AND
             (SCR-CMND = 'ELI' OR SCR-CMND = 'MOD')
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FOLRPRYAACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE PGM-STAT-OBN TO FIO-STAT
               GO TO FIN-FND-KEY.

           IF FIO-STAT-OKS AND
              RPR-IND-ESTA IN RPR NOT = 'A' AND
              SCR-CMND = 'MRA'
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FOLRPRNOACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE PGM-STAT-OBN TO FIO-STAT
               GO TO FIN-FND-KEY.

      *>>>>                 
*% END     
*% IF EOF
      *<<<< EOF
       OBT-FOL SECTION.
       INI-OBT-FOL.
           MOVE OBN-CAI-IFOL IN OBN-FLD TO RPR-CAI-IFOL IN RPR.
           MOVE OBN-IIC-IFOL IN OBN-FLD TO RPR-IIC-IFOL IN RPR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RPR.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-OBT-FOL.
           MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-OBT-FOL.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OBN-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OBN-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OBN-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OBN-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN OBN-FLD.
       FIN-OBT-FOL.
           EXIT.

       OBT-CLI-FOL SECTION.
       INI-OBT-CLI-FOL.
           MOVE SCR-CIC-ICLI       TO RPR-CIC-ICLI IN RPR.
           MOVE '99999999'         TO RPR-FEC-FRPR IN RPR.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           MOVE 'RPR-AKY-IRPR' TO FIO-AKEY.
           PERFORM SGC-FIO-RPR.
       LUP-LEE-RPR.
           IF NOT (FIO-STAT-OKS AND
               RPR-CIC-ICLI IN RPR = SCR-CIC-ICLI)
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-OBT-CLI-FOL.
       FIN-OBT-CLI-FOL.
           EXIT.

       BUS-COR-OBN SECTION.
       INI-BUS-COR-OBN.
           MOVE 999 TO OBN-NUM-IOBN IN OBN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-OBN.
           IF NOT ( FIO-STAT-OKS AND
                    OBN-CAI-IFOL IN OBN-FLD = OBN-CAI-IFOL IN OBN AND
                    OBN-IIC-IFOL IN OBN-FLD = OBN-IIC-IFOL IN OBN )
               PERFORM KEY-ALL-OBN
               MOVE ZEROES TO OBN-NUM-IOBN IN OBN.

           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO OBN-NUM-IOBN IN OBN
               MOVE OBN-NUM-IOBN IN OBN TO OBN-NUM-IOBN IN OBN-FLD.
       FIN-BUS-COR-OBN.
           EXIT.

       ACT-IPC SECTION.
       INI-ACT-IPC.
           MOVE OBN-CAI-IFOL IN OBN-FLD TO IPC-CAI-IFOL IN IPC.
           MOVE OBN-IIC-IFOL IN OBN-FLD TO IPC-IIC-IFOL IN IPC.
           MOVE SPACES                  TO IPC-COD-TDOC IN IPC.
           MOVE FIO-GET-NLS   TO FIO-CMND.
       LUP-ACT-IPC.
           PERFORM SGC-FIO-IPC.
           IF NOT (FIO-STAT-OKS AND
               OBN-CAI-IFOL IN OBN-FLD = IPC-CAI-IFOL IN IPC AND
               OBN-IIC-IFOL IN OBN-FLD = IPC-IIC-IFOL IN IPC)
                GO TO FIN-ACT-IPC.

           MOVE IPC-KEY-IIPC IN IPC TO WSS-KEY-IIPC IN WSS-VARI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-IPC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-ACT-IPC.

           IF SCR-CMND = 'ING'
               MOVE 'S' TO IPC-IND-OTBN IN IPC
           ELSE
           IF SCR-CMND = 'ELI'
               PERFORM BUS-OBN
               IF WSS-IND-OTBN IN WSS-VARI = SPACES
                  MOVE 'N' TO IPC-IND-OTBN IN IPC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-IPC.

           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.
           MOVE FIO-GET-NLS   TO FIO-CMND.
           PERFORM SGC-FIO-IPC.

       NXT-ACT-IPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ACT-IPC.

       FIN-ACT-IPC.
           EXIT.

       BUS-OBN SECTION.
       INI-BUS-OBN.
           MOVE SPACES TO WSS-IND-OTBN IN WSS-VARI.
           MOVE OBN-CAI-IFOL IN OBN-FLD TO OBN-CAI-IFOL IN OBN.
           MOVE OBN-IIC-IFOL IN OBN-FLD TO OBN-IIC-IFOL IN OBN.
           MOVE ZEROES TO OBN-NUM-IOBN IN OBN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-OBN.
           IF NOT ( FIO-STAT-OKS AND
              OBN-CAI-IFOL IN OBN = OBN-CAI-IFOL IN OBN-FLD AND
              OBN-IIC-IFOL IN OBN = OBN-IIC-IFOL IN OBN-FLD )
               MOVE SPACES TO WSS-IND-OTBN IN WSS-VARI
           ELSE
               MOVE 'S' TO WSS-IND-OTBN IN WSS-VARI.
       FIN-BUS-OBN.
           EXIT.

       COPY SGCBFIPC.
       COPY SGCBFDBC.
       COPY SGCBFRPR.
       COPY GNSBGCPT.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBEGLS.
       COPY GNSBBTAB.
      *>>>>                 
*% END     
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           MOVE FIO-STAT TO PGM-STAT-OBN.
           PERFORM ACT-IPC.
           MOVE PGM-STAT-OBN TO FIO-STAT.
      *>>>>                 
*% END     
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           MOVE FIO-STAT TO PGM-STAT-OBN.
           PERFORM ACT-IPC.
           MOVE PGM-STAT-OBN TO FIO-STAT.
      *>>>>                 
*% END     
