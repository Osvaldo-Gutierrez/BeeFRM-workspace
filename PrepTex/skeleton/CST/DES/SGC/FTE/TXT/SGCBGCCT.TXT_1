      * Busca Ultima Cuenta Corriente
       BUS-OLD-CCT SECTION.
       INI-BUS-OLD-CCT.
           MOVE SPACES     TO MSG-COD-MENS.
           MOVE SPACES     TO MSG-GLS-DESC.

           MOVE SPACES     TO CCT-IOPE IN CCT-VARI.
           MOVE '99999999' TO CCT-FIOP IN CCT-VARI.
           MOVE SPACES     TO CCT-OFOP IN CCT-VARI.
           MOVE ZEROES     TO CCT-NCCT IN CCT-VARI.

           MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
           MOVE 'CTE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE 'TAB' TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'   TO MSG-COD-SIST
               MOVE 'CICCTACNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-BUS-OLD-CCT.

           MOVE SPACES TO RCO-KEY-IRCO IN RCO.
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-OLD-CCT.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS OR
              RCO-CIC-ICLI IN RCO NOT = DBC-CIC-ICLI IN DBC
               GO TO CON-BUS-OLD-CCT.
           IF RCO-COD-COPR IN RCO NOT = TAB-COD-CTAB IN TAB
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-OLD-CCT.

           ADD 1 TO CCT-NCCT IN CCT-VARI.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-OLD-CCT.
      *ALD/ Busca operaciones solo vigentes
           IF ( OPE-MSC-STAT IN OPE = 'D'  OR
                OPE-COD-STAT IN OPE = 'ELI' )  OR
              ( ( OPE-FEC-FTOP IN OPE > ZEROES OR
                  OPE-COD-MOTT IN OPE > SPACES ) AND
              (  OPE-FEC-FROP IN OPE NOT > ZEROES ))
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-OLD-CCT.
      *
           IF OPE-COD-OFOP IN OPE = DBC-COD-OFIC IN DBC
               IF OPE-FEC-FIOP IN OPE <     CCT-FIOP IN CCT-VARI OR
                  OPE-COD-OFOP IN OPE NOT = CCT-OFOP IN CCT-VARI
                   MOVE OPE-CIC-IOPE IN OPE TO CCT-IOPE IN CCT-VARI
                   MOVE OPE-FEC-FIOP IN OPE TO CCT-FIOP IN CCT-VARI
                   MOVE OPE-COD-OFOP IN OPE TO CCT-OFOP IN CCT-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
               IF ( CCT-OFOP IN CCT-VARI NOT = DBC-COD-OFIC IN DBC AND
                    CCT-FIOP IN CCT-VARI > OPE-FEC-FIOP IN OPE ) OR
                  ( DBC-COD-OFIC IN DBC NOT > SPACES AND
                    CCT-FIOP IN CCT-VARI > OPE-FEC-FIOP IN OPE )
                   MOVE OPE-CIC-IOPE IN OPE TO CCT-IOPE IN CCT-VARI
                   MOVE OPE-FEC-FIOP IN OPE TO CCT-FIOP IN CCT-VARI
                   MOVE OPE-COD-OFOP IN OPE TO CCT-OFOP IN CCT-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-OLD-CCT.
       CON-BUS-OLD-CCT.
           IF CCT-IOPE IN CCT-VARI > SPACES
               MOVE CCT-IOPE IN CCT-VARI TO OPE-CIC-IOPE IN OPE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-OPE
           ELSE
               MOVE 'SGC'   TO MSG-COD-SIST
               MOVE 'CLI    NOCCT' TO MSG-COD-MENS
               PERFORM GET-MSG.
       FIN-BUS-OLD-CCT.
           EXIT.
