*%! Codigo adicional para archivo
*% IF WSS_DTC
      *<<<<
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
      *>>>>
*% END
*% IF WSS_IBM
      *<<<<
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY SGCBRRBS.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRREC.
       COPY SGCBRAEP.
       COPY SGCBREFE.
       COPY SGCBRDSF.
       COPY SGCWGCCT.
       COPY SGCWVPPU.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRPAI.
       COPY GNSWGCPT.
       COPY GNSBRTAB.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGIDC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       01  WSS-VARI.
           03 WSS-COD-LUGA.
              05  WSS-COD-COMU                   PIC X(04).
              05  WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07  WSS-IND-PAIS                PIC X(01).
                  07  WSS-COD-PAIS                PIC X(03).
           03  WSS-IND-IEDS                       PIC X(01).
           03  WSS-IND-IBAL                       PIC X(01).
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(2500).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +2500 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF8 OR
                            FRM-FFLD = FRM-FFLD-PF7 ) )
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-ICC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-ICC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-RQA1
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           MOVE SPACES TO SCR-RQA1.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-ICC.
           MOVE FRM-GLS-NOMC IN ICC-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-ICC
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN ICC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN ICC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN ICC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN ICC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN ICC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICC-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DCC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DCC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
           IF DBC-NUM-ICLI IN ICC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN ICC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN ICC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN ICC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE ADR-DBC-REQA TO SCR-RQA1
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN ICC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICC-FLD
           ELSE
           IF FRM-GLS-NOMC IN ICC-FLD > SPACES
               MOVE SPACES TO DBC-GLS-NOMC IN DBC
      *NOM-CLI Busca Cliente por medio del Nombre
               UNSTRING FRM-GLS-NOMC IN ICC-FLD DELIMITED BY '/' INTO
                                        DBC-GLS-APAT IN DBC
                                        DBC-GLS-AMAT IN DBC
                                        DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS-ALT TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE ADR-DBC-REQA TO SCR-RQA1
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN ICC-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN ICC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN ICC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN ICC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN ICC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICC-FLD.
       CON-FND-KEY.
           PERFORM BUS-DOM.
           PERFORM PUT-RCD.
           PERFORM BUS-DSF.
           PERFORM BUS-RBS.
           PERFORM BUS-DCM.
           IF MSG-COD-MENS > SPACES
               MOVE 'N' TO FRM-IND-DCOM IN ICC-FLD
           ELSE
               MOVE 'S' TO FRM-IND-DCOM IN ICC-FLD.
           PERFORM PUT-DBC.
           PERFORM BUS-OLD-CCT.
           IF MSG-COD-MENS     > SPACES AND
              MSG-COD-MENS NOT = 'CLI    NOCCT'
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF MSG-COD-MENS NOT > SPACES
               MOVE '00' TO PGM-STAT-OPE
               PERFORM PUT-OPE-ICC
               PERFORM PUT-OPE.
           PERFORM BUS-RCP.
           PERFORM PUT-RCP.
           PERFORM RET-DBC-ICC.
           PERFORM KEY-DBC-ICC.
           PERFORM BUS-REB.
           PERFORM RET-DBC-ICC.
           PERFORM KEY-DBC-ICC.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR SCR-CCPP = 'ACT' 
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO DCC-STP-ITRN IN DCC.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE DCC-CIC-ICLI IN DCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                                    
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                                  
      *        Como la transaccion Termina no es necesario hacer UNLOCK de      
      *        DCC
      *        Comunicar que no se pudo actualizar con mensaje pertinente       
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
      *>>>>
*% END          
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.                                               
           PERFORM RET-ALL-ICC.
           MOVE DCC-STP-ITRN IN DCC TO DBC-STP-ITRN IN DBC.
           MOVE FIO-MOD TO FIO-CMND.                                            
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar 
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM KEY-ALL-ICC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           GO TO CON-CMN-MOD.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
       CON-CMN-MOD.
           PERFORM RET-ALL-ICC.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO DCC-STP-ITRN IN DCC.
           IF FIO-STAT-OKS
               GO TO MOD-CMN-MOD.
           IF DCC-NUM-TCHP IN DCC > ZEROES OR
              DCC-NUM-TCHA IN DCC > ZEROES OR
              DCC-IND-PBOL IN DCC > SPACES OR
              DCC-FEC-FIBC IN DCC > ZEROES OR
              DCC-NUM-UPBC IN DCC > ZEROES OR
              DCC-IND-UTBC IN DCC > SPACES
                 MOVE FIO-PUT TO FIO-CMND
                 PERFORM SGC-FIO-DCC
                 GO TO NXT-CMN-MOD
           ELSE
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'DCC    NOING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
               GO TO UPD-DBC.
       MOD-CMN-MOD.
      *>>>>
*% END           
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
       NXT-CMN-MOD.
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en el ingreso : informar                    
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.                                               
       UPD-DBC.
           MOVE DCC-CIC-ICLI IN DCC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                                    
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                                  
      *        Como la transaccion Termina no es necesario hacer UNLOCK de      
      *        DCC
      *        Comunicar que no se pudo actualizar con mensaje pertinente       
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-ICC.
           MOVE DCC-STP-ITRN IN DCC TO DBC-STP-ITRN IN DBC.
           MOVE FIO-MOD TO FIO-CMND.                                            
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS                                                  
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar 
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-RQA1.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-RQA1.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.                                       
       FIN-BCK-OUT.                                                             
           EXIT.                                                                
       PUT-RCP SECTION.
       INI-PUT-RCP.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO FRM-GLS-NCLP IN ICC-FLD
               MOVE ZEROES TO FRM-NUM-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-VRF-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-IND-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-GLS-ICLP IN ICC-FLD
               GO TO FIN-PUT-RCP.
           MOVE REC-CIC-IREL IN REC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO FRM-GLS-NCLP IN ICC-FLD
               MOVE ZEROES TO FRM-NUM-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-VRF-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-IND-ICLP IN ICC-FLD
               MOVE SPACES TO FRM-GLS-ICLP IN ICC-FLD
               GO TO FIN-PUT-RCP.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NCLP IN ICC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLP IN ICC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLP IN ICC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLP IN ICC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLP IN ICC-FLD.
       FIN-PUT-RCP.
           EXIT.

       PUT-RCD SECTION.
       INI-PUT-RCD.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE SPACES TO RCD-GLS-FONO IN RCD.
           MOVE RCD-GLS-DIRE IN RCD TO RCD-GLS-DIRE IN ICC-FLD.
           MOVE RCD-GLS-FONO IN RCD TO RCD-GLS-FONO IN ICC-FLD.
           IF RCD-COD-LUGA IN RCD NOT > SPACES OR
              RCD-GLS-DIRE IN RCD NOT > SPACES
               GO TO FIN-PUT-RCD.
           MOVE '00' TO PGM-STAT-RCD.
           MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA.
           IF WSS-IND-PAIS = 'P'
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PAI' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-LUGA IN ICC-FLD
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'COM' TO TAB-COD-TTAB IN TAB
               MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-LUGA IN ICC-FLD.
       FIN-PUT-RCD.
           EXIT.

       BUS-DSF SECTION.
       INI-BUS-DSF.
           MOVE DBC-CIC-ICLI IN DBC TO DSF-CIC-ICLI IN DSF.
           MOVE 'DSF-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DSF.
           IF FIO-STAT-OKS
               IF DSF-VAL-DVCN IN DSF > ZEROES OR
                  DSF-VAL-IVCT IN DSF > ZEROES OR
                  DSF-VAL-DVCX IN DSF > ZEROES
                   MOVE 'S' TO FRM-IND-IVCS IN ICC-FLD
               ELSE
                   MOVE 'N' TO FRM-IND-IVCS IN ICC-FLD
           ELSE
               MOVE 'N' TO FRM-IND-IVCS IN ICC-FLD.
       FIN-PUT-DSF.
           EXIT.

       BUS-RBS SECTION.
       INI-BUS-RBS.
           MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS.
           MOVE 'RBS-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           MOVE '00' TO PGM-STAT-RBS.
           IF FIO-STAT-OKS
               MOVE RBS-IND-ICSF IN RBS TO RBS-IND-ICSF IN ICC-FLD
           ELSE
               MOVE 'N' TO RBS-IND-ICSF IN ICC-FLD
               MOVE 'N' TO RBS-IND-ICSF IN RBS.
       FIN-BUS-RBS.
           EXIT.

       PUT-DBC SECTION.
       INI-PUT-DBC.
           IF DBC-COD-ACTI IN DBC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTI IN ICC-FLD.
           IF DBC-COD-EJEC IN DBC > SPACES
               MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN ICC-FLD.
           IF DBC-COD-OFIC IN DBC > SPACES
               MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN ICC-FLD.
           IF DBC-COD-BLOC IN DBC > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'BLO' TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-BLOC IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-BLOC IN ICC-FLD.
           IF DBC-COD-CLCM IN DBC  > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'CLC' TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-CLCM IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-CLCM IN ICC-FLD.
           IF DBC-MSC-SCLI IN DBC > SPACES
               MOVE 'SGC'  TO MSC-COD-SIST
               MOVE 'SCLI' TO MSC-COD-TMSC
               MOVE DBC-MSC-SCLI IN DBC TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-SCLI IN ICC-FLD.
           IF DBC-COD-TICL IN DBC  > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'TCL' TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-TICL IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TICL IN ICC-FLD.
           IF DBC-NUM-TCMT IN DBC > ZEROES
               MOVE 'S' TO FRM-IND-CMTR IN ICC-FLD
           ELSE
               MOVE 'N' TO FRM-IND-CMTR IN ICC-FLD.
           MOVE DBC-COD-TICL IN DBC TO DBC-COD-TICL IN ICC-FLD.
           MOVE DBC-IND-OOFI IN DBC TO DBC-IND-OOFI IN ICC-FLD.
           MOVE DBC-COD-CLCM IN DBC TO DBC-COD-CLCM IN ICC-FLD.
           MOVE DBC-IND-UPIR IN DBC TO DBC-IND-UPIR IN ICC-FLD.
           MOVE DBC-NUM-SUPI IN DBC TO DBC-NUM-SUPI IN ICC-FLD.
           MOVE DBC-NUM-AUPI IN DBC TO DBC-NUM-AUPI IN ICC-FLD.
           MOVE DBC-COD-BLOC IN DBC TO DBC-COD-BLOC IN ICC-FLD.
           MOVE DBC-MSC-SCLI IN DBC TO DBC-MSC-SCLI IN ICC-FLD.
           MOVE DBC-NUM-DSCL IN DBC TO DBC-NUM-DSCL IN ICC-FLD.
           MOVE DBC-NUM-MSCL IN DBC TO DBC-NUM-MSCL IN ICC-FLD.
           MOVE DBC-NUM-SSCL IN DBC TO DBC-NUM-SSCL IN ICC-FLD.
           MOVE DBC-NUM-ASCL IN DBC TO DBC-NUM-ASCL IN ICC-FLD.
           MOVE DBC-IND-MUBC IN DBC TO DBC-IND-MUBC IN ICC-FLD.
           MOVE DBC-IND-JUBC IN DBC TO DBC-IND-JUBC IN ICC-FLD.
           MOVE DBC-NUM-DA85 IN DBC TO DBC-NUM-DA85 IN ICC-FLD.
           MOVE DBC-NUM-MA85 IN DBC TO DBC-NUM-MA85 IN ICC-FLD.
           MOVE DBC-NUM-SA85 IN DBC TO DBC-NUM-SA85 IN ICC-FLD.
           MOVE DBC-NUM-AA85 IN DBC TO DBC-NUM-AA85 IN ICC-FLD.
           MOVE DBC-NUM-DTRN IN DBC TO DBC-NUM-DTRN IN ICC-FLD.
           MOVE DBC-NUM-MTRN IN DBC TO DBC-NUM-MTRN IN ICC-FLD.
           MOVE DBC-NUM-STRN IN DBC TO DBC-NUM-STRN IN ICC-FLD.
           MOVE DBC-NUM-ATRN IN DBC TO DBC-NUM-ATRN IN ICC-FLD.
           IF DBC-IND-TICL IN DBC = 'P' 
               PERFORM BUS-AEP
           ELSE
               PERFORM BUS-EFE.
       FIN-PUT-DBC.
           EXIT.

       BUS-AEP SECTION.
       INI-BUS-AEP.
           MOVE DBC-CIC-ICLI IN DBC TO AEP-CIC-ICLI IN AEP.
           MOVE '99999999' TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = AEP-CIC-ICLI IN AEP
               MOVE AEP-NUM-DAEP IN AEP TO FRM-NUM-DESB IN ICC-FLD
               MOVE AEP-NUM-MAEP IN AEP TO FRM-NUM-MESB IN ICC-FLD
               MOVE AEP-NUM-SAEP IN AEP TO FRM-NUM-SESB IN ICC-FLD
               MOVE AEP-NUM-AAEP IN AEP TO FRM-NUM-AESB IN ICC-FLD
               MOVE 'SGC'   TO MSC-COD-SIST
               MOVE 'ESBL'  TO MSC-COD-TMSC IN MSC
               MOVE 'S'     TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-ESBL IN ICC-FLD
           ELSE
               MOVE SPACES TO FRM-FEC-FESB IN ICC-FLD
               MOVE SPACES TO FRM-GLS-ESBL IN ICC-FLD.
       FIN-BUS-AEP.
           EXIT.
    
       BUS-EFE SECTION.
       INI-BUS-EFE.
           MOVE DBC-CIC-ICLI IN DBC TO EFE-CIC-ICLI IN EFE.
           MOVE '99999999' TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-EFE.
           PERFORM SGC-FIO-EFE.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = EFE-CIC-ICLI IN EFE
               MOVE EFE-NUM-DEFE IN EFE TO FRM-NUM-DESB IN ICC-FLD
               MOVE EFE-NUM-MEFE IN EFE TO FRM-NUM-MESB IN ICC-FLD
               MOVE EFE-NUM-SEFE IN EFE TO FRM-NUM-SESB IN ICC-FLD
               MOVE EFE-NUM-AEFE IN EFE TO FRM-NUM-AESB IN ICC-FLD
               MOVE 'SGC'   TO MSC-COD-SIST
               MOVE 'ESBL'  TO MSC-COD-TMSC IN MSC
               MOVE EFE-IND-ESBL IN EFE TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-ESBL IN ICC-FLD
           ELSE
               MOVE SPACES TO FRM-FEC-FESB IN ICC-FLD
               MOVE SPACES TO FRM-GLS-ESBL IN ICC-FLD.
       FIN-BUS-EFE.
           EXIT.
    
       
       PUT-OPE SECTION.
       INI-PUT-OPE.
           IF OPE-COD-EJOP IN OPE > SPACES
                MOVE OPE-COD-EJOP IN OPE TO USR-COD-USER IN USR
                PERFORM BUS-USR
                MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOP IN ICC-FLD.
           IF OPE-COD-MOTT IN OPE > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'MTO' TO TAB-COD-TTAB IN TAB
               MOVE OPE-COD-MOTT IN OPE TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MOTT IN ICC-FLD.
           IF CCT-NCCT IN CCT-VARI > ZEROES
               MOVE CCT-NCCT IN CCT-VARI TO FRM-NUM-CCTE IN ICC-FLD
           ELSE
               MOVE ZEROES TO FRM-NUM-CCTE IN ICC-FLD.    
       FIN-PUT-OPE.
           EXIT.
       

       BUS-REB SECTION.
       INI-BUS-REB.
           PERFORM BUS-PPU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DCOR TO FRM-GLS-RELB IN ICC-FLD
           ELSE
               PERFORM CIC-PPU
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DCOR TO FRM-GLS-RELB IN ICC-FLD
               ELSE
                   MOVE DCC-CAI-ICLI IN ICC-FLD TO PPU-CAI-ICLI
                   MOVE DCC-IIC-ICLI IN ICC-FLD TO PPU-IIC-ICLI
                   PERFORM BUS-RCU
                   MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RELB IN ICC-FLD.
       FIN-BUS-REB.
           EXIT.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<<
       COPY SGCBFDBC.
       COPY SGCBFRCD.
       COPY SGCBFOPE.
       COPY SGCBFRBS.
       COPY SGCBFRCO.
       COPY SGCBFREC.
       COPY SGCBFEFE.
       COPY SGCBFAEP.
       COPY SGCBFDSF.
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY SGCBGCCT.
       COPY SGCBGRCP.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY SGCBGDCM.
       COPY TABBFUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBVTDU.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBVCOD.
       COPY GNSBVIND.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBEGLS.
       COPY GNSBGCPT.
       COPY GNSBGPPU.
      *>>>>
*% END
