*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *DOS SELECT RPTETI         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTETI         ASSIGN TO        UT-S-RPTETI.
           SELECT RPTETI         ASSIGN TO SYS012-UR-1403-S.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTETI LABEL RECORDS OMITTED
           REPORT IS RPT-ETI.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY SGCRWETI.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRCOM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       01  WSS-VARI.
           03 WSS-FEC-FINV.
              05 WSS-NUM-DINV                     PIC 9(02).
              05 WSS-NUM-MINV                     PIC 9(02).
              05 WSS-NUM-SINV                     PIC 9(02).
              05 WSS-NUM-AINV                     PIC 9(02).
           03 WSS-HRA-HRIN.
              05 WSS-NUM-HHIN                     PIC 9(02).
              05 WSS-NUM-MMIN                     PIC 9(02).
              05 WSS-NUM-SSIN                     PIC 9(02).
           03 WSS-COD-OINV.
              05 WSS-MSC-TINV                     PIC X(01).
              05 WSS-COD-TINV                     PIC X(03).
           03 WSS-COD-TORD                        PIC X(01).
           03 WSS-COD-OFIC                        PIC X(03).
           03 WSS-COD-EJEC                        PIC X(12).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-GLS-COMU                        PIC X(20).
           03 WSS-GLS-CIUD                        PIC X(20).
           03 WSS-GLS-PAIS                        PIC X(20).
           03 WSS-SW             VALUE 1          PIC 9(01).
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-COD-LUGA.
              05 WSS-COD-COMU                     PIC X(04).
              05 WSS-RED-PAIS  REDEFINES  WSS-COD-COMU.
                 07 WSS-IND-PAIS                  PIC X(01).
                 07 WSS-COD-PAIS                  PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==. 
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY SGCRFETI.
           .
       COPY SGCRTETI.
      *>>>>
*% END
*% IF CF_LDE_SDC_COD_OFIC
      *<<<< CF_LDE_SDC_COD_OFIC
      *>>>>
*% END
*% IF CF_LDE_SDC_COD_EJEC
      *<<<< CF_LDE_SDC_COD_EJEC
      *>>>>
*% END
*% IF PH_LDE
      *<<<< PH_LDE
      * Mediante BUS-OFI se Obtiene Nombre de la Oficina de Tabla OFI
           IF SRT-COD-OFIC IN SRT > SPACES
               MOVE SRT-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-LDE
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-LDE.

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF SRT-COD-EJEC IN SRT > SPACES
               MOVE SRT-COD-EJEC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-LDE
           ELSE
               MOVE SPACES TO WSS-GLS-EJEC IN WSS-LDE.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'Inicio de Captura de Parametros'.

      *Captura Concepto de Ordenamiento
           DISPLAY 'LISTA ORDENADO POR (N:NO ORDENA,O:OFICINA'.
           DISPLAY '                    E:EJECUTIVO,A:AMBAS) : '.
           ACCEPT  WSS-COD-TORD IN WSS-VARI.
           DISPLAY WSS-COD-TORD IN WSS-VARI.
      *Captura Fecha de Invocacion
           DISPLAY 'FECHA DE INVOCACION ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINV IN WSS-VARI.
           DISPLAY WSS-FEC-FINV IN WSS-VARI.
      *Captura Hora de Invocacion
           DISPLAY 'HORA DE INVOCACION ( HHMMSS ) : '.
           ACCEPT  WSS-HRA-HRIN IN WSS-VARI.
           DISPLAY WSS-HRA-HRIN IN WSS-VARI.
      *Captura Tipo Origen Invocacion
           DISPLAY 'TIPO ORIGEN INVOCACION   : '.
           ACCEPT  WSS-MSC-TINV IN WSS-VARI.
           DISPLAY WSS-MSC-TINV IN WSS-VARI.
      *Captura Codigo Origen Invocacion
           DISPLAY 'CODIGO ORIGEN INVOCACION : '.
           ACCEPT  WSS-COD-TINV IN WSS-VARI.
           DISPLAY WSS-COD-TINV IN WSS-VARI.

           DISPLAY 'Fin    de Captura    de Parametros'.
           DISPLAY 'Inicio de Validacion de Parametros'.

      *Valida Concepto de Ordenamiento
           IF WSS-COD-TORD IN WSS-VARI NOT > SPACES
               MOVE 'N' TO WSS-COD-TORD IN WSS-VARI.
           IF WSS-COD-TORD IN WSS-VARI NOT = 'N' AND
              WSS-COD-TORD IN WSS-VARI NOT = 'O' AND
              WSS-COD-TORD IN WSS-VARI NOT = 'E' AND
              WSS-COD-TORD IN WSS-VARI NOT = 'A'
               DISPLAY WSS-COD-TORD IN WSS-VARI
               DISPLAY 'CONCEPTO DE ORDENAMIENTO NO EXISTE'
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *VAL-FEC Valida Fecha de Invocacion
           DISPLAY WSS-FEC-FINV IN WSS-VARI.
           MOVE WSS-FEC-FINV    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE WSS-NUM-DINV IN WSS-VARI TO WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINV IN WSS-VARI TO WSS-NUM-MFEC IN WSS-VARI.
           MOVE WSS-NUM-SINV IN WSS-VARI TO WSS-NUM-SFEC IN WSS-VARI.
           MOVE WSS-NUM-AINV IN WSS-VARI TO WSS-NUM-AFEC IN WSS-VARI.

      *Valida Hora de Invocacion
      *     IF WSS-HRA-HRIN IN WSS-VARI NOT > ZEROES
      *         MOVE ZEROES TO WSS-HRA-HRIN IN WSS-VARI.
      *     IF WSS-HRA-HRIN IN WSS-VARI NOT = ZEROES AND
      *        ( WSS-NUM-HHIN IN WSS-VARI > 24 OR 
           IF ( WSS-NUM-HHIN IN WSS-VARI > 24 OR 
                WSS-NUM-MMIN IN WSS-VARI > 60 OR
                WSS-NUM-SSIN IN WSS-VARI > 60 )
               DISPLAY WSS-HRA-HRIN IN WSS-VARI
               DISPLAY 'HORA DE INVOCACION NO ESTA CORRECTA'
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *VAL-TAB Valida Tipo de Origen de Invocacion en TABLAS
      *     IF WSS-MSC-TINV IN WSS-VARI NOT > SPACES
      *         MOVE '*' TO WSS-MSC-TINV IN WSS-VARI.
      *     IF WSS-MSC-TINV IN WSS-VARI NOT = '*'
               DISPLAY WSS-MSC-TINV IN WSS-VARI
               MOVE 'GNS'                    TO TAB-COD-SIST
               MOVE 'TOI'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-MSC-TINV IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

      *VAL-TAB Valida Codigo de Origen de Invocacion en TABLAS
      *     IF WSS-COD-TINV IN WSS-VARI NOT > SPACES
      *         MOVE '*' TO WSS-COD-TINV IN WSS-VARI.
      *     IF WSS-COD-TINV IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-TINV IN WSS-VARI
               MOVE 'GNS'                    TO TAB-COD-SIST
               MOVE 'COI'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TINV IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-TAB
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.

           DISPLAY 'Fin de Validacion de Parametros'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      * Para Saltarce el Comando FIO_GET_FST No Disponible para SAM por ahora
           GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro SDC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.
           PERFORM BUS-SRT-REG.
           GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           IF WSS-COD-TORD IN WSS-VARI = 'N'
               MOVE SPACES TO WSS-GLS-TIT1 IN WSS-LDE
               MOVE SPACES TO WSS-GLS-TIT2 IN WSS-LDE
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'O'
               MOVE 'OFICINA   :' TO WSS-GLS-TIT1 IN WSS-LDE
               MOVE SPACES        TO WSS-GLS-TIT2 IN WSS-LDE
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'E'
               MOVE SPACES        TO WSS-GLS-TIT1 IN WSS-LDE
               MOVE 'EJECUTIVO :' TO WSS-GLS-TIT2 IN WSS-LDE
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'A'
               MOVE 'OFICINA   :' TO WSS-GLS-TIT1 IN WSS-LDE
               MOVE 'EJECUTIVO :' TO WSS-GLS-TIT2 IN WSS-LDE.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
           OPEN OUTPUT RPTETI.
           INITIATE RPT-ETI.
           MOVE SRT-COD-OFIC IN SRT TO WSS-COD-OFIC IN WSS-VARI.
           MOVE SRT-COD-EJEC IN SRT TO WSS-COD-EJEC IN WSS-VARI.
           MOVE 1 TO WSS-SW.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      * Mediante BUS-TAB Busca Comuna Obteniendo Codigos de Tabla COM
           IF SDC-COD-LUGA IN SRT > SPACES
               MOVE SDC-COD-LUGA IN SRT TO WSS-COD-LUGA IN WSS-VARI
               IF WSS-IND-PAIS NOT = 'P'
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'COM'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB TO COM
                   MOVE COM-GLS-COMU IN COM TO WSS-GLS-COMU IN WSS-VARI
                   MOVE COM-GLS-CIUD IN COM TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'PAI'               TO TAB-COD-TTAB IN TAB
                   MOVE COM-COD-PAIS IN COM TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PAIS IN WSS-VARI
               ELSE
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'PAI'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-PAIS IN WSS-VARI
           ELSE
               MOVE  '*'  TO WSS-GLS-COMU IN WSS-VARI
               MOVE  '*'  TO WSS-GLS-CIUD IN WSS-VARI
               MOVE  '*'  TO WSS-GLS-PAIS IN WSS-VARI.
           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COMU IN WSS-LDE.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIUD IN WSS-LDE.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           IF WSS-COD-OFIC IN WSS-VARI = SRT-COD-OFIC IN SRT AND
              WSS-COD-EJEC IN WSS-VARI = SRT-COD-EJEC IN SRT
               IF WSS-SW = 1
                   PERFORM GEN-LIN-OUT1
                   ADD 1 TO WSS-SW
               ELSE
                   PERFORM GEN-LIN-OUT2
                   GENERATE DL-ETI
                   MOVE 1 TO WSS-SW
           ELSE
               IF WSS-SW = 1
                   PERFORM GEN-LIN-OUT1
                   ADD 1 TO WSS-SW
                   MOVE SRT-COD-OFIC IN SRT TO WSS-COD-OFIC IN WSS-VARI
                   MOVE SRT-COD-EJEC IN SRT TO WSS-COD-EJEC IN WSS-VARI
               ELSE
                   GENERATE DL-ETI
                   PERFORM GEN-LIN-OUT1
                   ADD 1 TO WSS-SW
                   MOVE SRT-COD-OFIC IN SRT TO WSS-COD-OFIC IN WSS-VARI
                   MOVE SRT-COD-EJEC IN SRT TO WSS-COD-EJEC IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
           IF WSS-SW NOT = 1
               GENERATE DL-ETI.
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           TERMINATE RPT-ETI.
           CLOSE RPTETI.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Cod Invocacion del Listado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

           IF SDC-IND-AINV IN SDC NOT = 'I'
               GO TO FIN-SEL-REG-PRO.

      *     IF WSS-FEC-FINV IN WSS-VARI NOT = ZEROES
               IF WSS-FEC-FFEC IN WSS-VARI NOT = SDC-FEC-FINV IN SDC
                   GO TO FIN-SEL-REG-PRO.

      *     IF WSS-HRA-HRIN IN WSS-VARI NOT = ZEROES
               IF WSS-HRA-HRIN IN WSS-VARI NOT = SDC-HRA-HRIN IN SDC
                   GO TO FIN-SEL-REG-PRO.

      *     IF WSS-COD-OINV IN WSS-VARI NOT = '*'
               IF WSS-COD-OINV IN WSS-VARI NOT = SDC-COD-OINV IN SDC
                   GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Formacion y Generacion del Registro SRT al Procesar Varios Registros
       BUS-SRT-REG SECTION.
       INI-BUS-SRT-REG.
      * Complementa Formacion del Registro SRT
           IF WSS-COD-TORD IN WSS-VARI = 'N'
               MOVE SPACES TO SRT-COD-OFIC IN SRT
                              SRT-COD-EJEC IN SRT
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'O'
               MOVE SDC-COD-OFIC IN SDC TO SRT-COD-OFIC IN SRT
               MOVE SPACES              TO SRT-COD-EJEC IN SRT
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'E'
               MOVE SDC-COD-EJEC IN SDC TO SRT-COD-EJEC IN SRT
               MOVE SPACES              TO SRT-COD-OFIC IN SRT
           ELSE
           IF WSS-COD-TORD IN WSS-VARI = 'A'
               MOVE SDC-COD-OFIC IN SDC TO SRT-COD-OFIC IN SRT
               MOVE SDC-COD-EJEC IN SDC TO SRT-COD-EJEC IN SRT.

           MOVE SDC-GLS-NOMC IN SDC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN     TO SDC-GLS-NOMC IN SDC.
           MOVE SDC-GLS-DIRE IN SDC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN     TO SDC-GLS-DIRE IN SDC.

      * Completa Llenado de Campos y Genera el Registro SRT
           COPY SGCRMLDE.
           RELEASE SRT.
       FIN-BUS-SRT-REG.
           EXIT.
      **************************************************************************
      * Genera Lineas de Detalle a Partir de Registro SRT Ordenado
       GEN-LIN-OUT1 SECTION.
       INI-GEN-LIN-OUT1.
           MOVE SDC-GLS-NOMC IN SRT      TO WSS-GLS-NOM1 IN WSS-ETI.
           MOVE SDC-GLS-DIRE IN SRT      TO WSS-GLS-DIR1 IN WSS-ETI.
           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COM1 IN WSS-ETI.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIU1 IN WSS-ETI.
           MOVE WSS-GLS-PAIS IN WSS-VARI TO WSS-GLS-PAI1 IN WSS-ETI.
           MOVE SPACES                   TO WSS-GLS-NOM2 IN WSS-ETI.
           MOVE SPACES                   TO WSS-GLS-DIR2 IN WSS-ETI.
           MOVE SPACES                   TO WSS-GLS-COM2 IN WSS-ETI.
           MOVE SPACES                   TO WSS-GLS-CIU2 IN WSS-ETI.
           MOVE SPACES                   TO WSS-GLS-PAI2 IN WSS-ETI.
       FIN-GEN-LIN-OUT1.
           EXIT.
      **************************************************************************
      * Genera Lineas de Detalle a Partir de Registro SRT Ordenado
       GEN-LIN-OUT2 SECTION.
       INI-GEN-LIN-OUT2.
           MOVE SDC-GLS-NOMC IN SRT      TO WSS-GLS-NOM2 IN WSS-ETI.
           MOVE SDC-GLS-DIRE IN SRT      TO WSS-GLS-DIR2 IN WSS-ETI.
           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COM2 IN WSS-ETI.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIU2 IN WSS-ETI.
           MOVE WSS-GLS-PAIS IN WSS-VARI TO WSS-GLS-PAI2 IN WSS-ETI.
       FIN-GEN-LIN-OUT2.
           EXIT.
      **************************************************************************

       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY GNSBVTAB.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
      *>>>>
*% END
