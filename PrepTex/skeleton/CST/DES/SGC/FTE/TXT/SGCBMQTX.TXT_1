*%! Codigo adicional
*% IF INI_NUM_FLD_QTX
     *<<<<INI_EDT_FLD_QTX
           IF FRM-NUM-ITXO-LEN IN QTX-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITXO-LEN IN QTX-FLD(1)
                GO TO FIN-EDT-FLD-QTX.
           MOVE FRM-NUM-ITXO IN QTX-FLD(1) TO
                FRM-NUM-ITXO-EDT IN QTX-EDT.
           MOVE FRM-NUM-ITXO-EDT IN QTX-EDT TO
                FRM-NUM-ITXO-ALF IN QTX-FLD(1).
           IF FRM-NUM-ITXO-LEN IN QTX-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITXO-LEN IN QTX-FLD(2)
                GO TO FIN-EDT-FLD-QTX.
           MOVE FRM-NUM-ITXO IN QTX-FLD(2) TO
                FRM-NUM-ITXO-EDT IN QTX-EDT.
           MOVE FRM-NUM-ITXO-EDT IN QTX-EDT TO
                FRM-NUM-ITXO-ALF IN QTX-FLD(2).
           IF FRM-NUM-ITXO-LEN IN QTX-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITXO-LEN IN QTX-FLD(3)
                GO TO FIN-EDT-FLD-QTX.
           MOVE FRM-NUM-ITXO IN QTX-FLD(3) TO
                FRM-NUM-ITXO-EDT IN QTX-EDT.
           MOVE FRM-NUM-ITXO-EDT IN QTX-EDT TO
                FRM-NUM-ITXO-ALF IN QTX-FLD(3).
           IF FRM-NUM-ITXO-LEN IN QTX-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITXO-LEN IN QTX-FLD(4)
                GO TO FIN-EDT-FLD-QTX.
           MOVE FRM-NUM-ITXO IN QTX-FLD(4) TO
                FRM-NUM-ITXO-EDT IN QTX-EDT.
           MOVE FRM-NUM-ITXO-EDT IN QTX-EDT TO
                FRM-NUM-ITXO-ALF IN QTX-FLD(4).
           IF FRM-NUM-ITXO-LEN IN QTX-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ITXO-LEN IN QTX-FLD(5)
                GO TO FIN-EDT-FLD-QTX.
           MOVE FRM-NUM-ITXO IN QTX-FLD(5) TO
                FRM-NUM-ITXO-EDT IN QTX-EDT.
           MOVE FRM-NUM-ITXO-EDT IN QTX-EDT TO
                FRM-NUM-ITXO-ALF IN QTX-FLD(5).
*% END 
*% IF INI_FRM_FEC_FFIH OR INI_FRM_FEC_FIND 
MAN        MOVE FEC-CHOY-N TO FEC-CHOY.
MAN        MOVE FEC-VHBL-N TO FEC-VHBL.
*% END 
*% IF INI_FRM_FEC_FINH OR INI_FRM_FEC_FFID
MAN        MOVE FEC-CHOY-N TO FEC-CHOY.
MAN        MOVE FEC-VHBL-N TO FEC-VHBL.
*% END 
*% IF INI_VAL_NUM_AKY_QTX
       VAL-NUM-FRM-NUM-KTXO.
           MOVE FRM-NUM-KTXO-ALF IN QTX-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-KTXO IN QTX-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-KTXO-LEN IN QTX-FLD
                GO TO FIN-VAL-NUM-AKY-QTX.
*% END
*% IF FIN_FRM_MSC_STAT
      *<<<<
           IF FRM-MSC-STAT IN QTX-FLD > SPACES
              MOVE 'GNS'                   TO TAB-COD-SIST
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-MSC-STAT IN QTX-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END 
*% IF FIN_FRM_COD_CPTO
      *<<<<
           IF FRM-COD-CPTO IN QTX-FLD > SPACES
              MOVE 'SGC'                   TO TAB-COD-SIST
              MOVE 'TXO'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-CPTO IN QTX-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_FRM_FEC_FINH
      *<<<<
           MOVE FRM-NUM-SIND IN QTX-FLD TO WSS-NUM-SIND IN WSS-VARI.
           MOVE FRM-NUM-AIND IN QTX-FLD TO WSS-NUM-AIND IN WSS-VARI.
           MOVE FRM-NUM-MIND IN QTX-FLD TO WSS-NUM-MIND IN WSS-VARI.
           MOVE FRM-NUM-DIND IN QTX-FLD TO WSS-NUM-DIND IN WSS-VARI.

           MOVE FRM-NUM-SINH IN QTX-FLD TO WSS-NUM-SINH IN WSS-VARI.
           MOVE FRM-NUM-AINH IN QTX-FLD TO WSS-NUM-AINH IN WSS-VARI.
           MOVE FRM-NUM-MINH IN QTX-FLD TO WSS-NUM-MINH IN WSS-VARI.
           MOVE FRM-NUM-DINH IN QTX-FLD TO WSS-NUM-DINH IN WSS-VARI.

           IF (WSS-FEC-FIND IN WSS-VARI > ZEROES AND
               WSS-FEC-FINH IN WSS-VARI > ZEROES AND
               WSS-FEC-FINH IN WSS-VARI NOT > WSS-FEC-FIND IN WSS-VARI)
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'FINH<FIND'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-FEC-FINH.
      *>>>>
*% END
*% IF FIN_FRM_FEC_FFIH
      *<<<<FIN_FRM_FEC_FFIH
           MOVE FRM-NUM-SFID IN QTX-FLD TO WSS-NUM-SFID IN WSS-VARI.
           MOVE FRM-NUM-AFID IN QTX-FLD TO WSS-NUM-AFID IN WSS-VARI.
           MOVE FRM-NUM-MFID IN QTX-FLD TO WSS-NUM-MFID IN WSS-VARI.
           MOVE FRM-NUM-DFID IN QTX-FLD TO WSS-NUM-DFID IN WSS-VARI.

           MOVE FRM-NUM-SFIH IN QTX-FLD TO WSS-NUM-SFIH IN WSS-VARI.
           MOVE FRM-NUM-AFIH IN QTX-FLD TO WSS-NUM-AFIH IN WSS-VARI.
           MOVE FRM-NUM-MFIH IN QTX-FLD TO WSS-NUM-MFIH IN WSS-VARI.
           MOVE FRM-NUM-DFIH IN QTX-FLD TO WSS-NUM-DFIH IN WSS-VARI.
           IF (WSS-FEC-FFID IN WSS-VARI > ZEROES AND
               WSS-FEC-FFIH IN WSS-VARI > ZEROES AND
               WSS-FEC-FFIH IN WSS-VARI NOT > WSS-FEC-FFID IN WSS-VARI)
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'FFIH<FFID'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-FEC-FFIH.
      *>>>>
*% END 
