*%! CMA_USR = TRUE
*% HDR_CST    = TRUE
*% NO_HDR_CST = FALSE
*% PGM_PTC    = TRUE
*%! GNSTCA_ORIG = 3000
*%! GNSTCA = 3000
*% GEN_MFC = TRUE
*% IF PGM_PQ
*% CLRMFC = "SGCZQDPR"
*% ELSE
*% CLRMFC = "SGCZUDPR"
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0010).                   
           03 SCR-QEC-FLD                PIC X(1100).                   
           03 SCR-CIC-ICLI.                                             
              05 SCR-CAI-ICLI            PIC X(04).                     
              05 SCR-IIC-ICLI            PIC X(08).              
      *>>>> FIN_SCR_VARI                                               
*% END
*% IF WSS                                                            
      *<<<< WSS_DTC                                                     
       COPY GNSWGCPT.                                                   
       COPY SGCBRIPC.                                                   
       COPY SGCBRDBC.                                                   
       COPY SGCBRRPR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.        
                                                                        
                                                                        
       01 WSS-VARI.                                                     
           03 WSS-KEY-IIPC                 PIC X(15).                   
           03 WSS-FND-INFO                 PIC X(01).                   
           03 WSS-FEC-DSPL.                                             
              05 WSS-DIA-DSPL              PIC 99.                      
              05 WSS-MES-DSPL              PIC 99.                      
              05 WSS-SIG-DSPL              PIC 99.                      
              05 WSS-ANO-DSPL              PIC 99.                      
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF SCR-CMND = 'ING'                                          
              PERFORM GET-FHOY                                          
              MOVE HOY-SHOY        TO WSS-SIG-DSPL IN WSS-VARI          
              MOVE HOY-AHOY        TO WSS-ANO-DSPL IN WSS-VARI          
              MOVE HOY-MHOY        TO WSS-MES-DSPL IN WSS-VARI          
              MOVE HOY-DHOY        TO WSS-DIA-DSPL IN WSS-VARI          
              MOVE WSS-FEC-DSPL IN WSS-VARI                             
                                   TO FRM-FEC-FEFR IN DPR-FLD           
              MOVE SCR-USER        TO DAC-COD-EEFR IN DPR-FLD.          
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF            
       FND-IPC-IFOL SECTION.                                            
       INI-FND-IPC-IFOL.                                                
           MOVE DAC-CAI-IFOL IN DPR-FLD   TO IPC-CAI-IFOL IN IPC.       
           MOVE DAC-IIC-IFOL IN DPR-FLD   TO IPC-IIC-IFOL IN IPC.       
           MOVE SPACES                    TO IPC-COD-TDOC IN IPC.       
           MOVE FIO-GET-NLS               TO FIO-CMND.                  
       LUP-FND-IPC-IFOL.                                                
           PERFORM SGC-FIO-IPC.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    DAC-CAI-IFOL IN DPR-FLD = IPC-CAI-IFOL IN IPC AND   
                    DAC-IIC-IFOL IN DPR-FLD = IPC-IIC-IFOL IN IPC )     
              GO TO FIN-FND-IPC-IFOL                                    
           ELSE                                                         
              MOVE IPC-KEY-IREG IN IPC   TO WSS-KEY-IIPC IN WSS-VARI    
              PERFORM UPD-IPC-TDOC.                                     
       LEE-SIG-IFOL.                                                    
           MOVE FIO-GET-NXT              TO FIO-CMND.                   
           GO TO LUP-FND-IPC-IFOL.                                      
       FIN-FND-IPC-IFOL.                                                
           EXIT.                                                        
                                                                        
       UPD-IPC-TDOC SECTION.                                            
       INI-UPD-IPC-TDOC.                                                
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-KEY-UPD          TO FIO-CMND.                   
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-UPD-IPC-TDOC.                                   
           IF SCR-CMND = 'ING'                                          
              MOVE 'S'                   TO IPC-IND-CDPR IN IPC         
           ELSE                                                         
              IF SCR-CMND = 'ELI'                                       
                 MOVE 'N'                TO IPC-IND-CDPR IN IPC.        
           MOVE FIO-MOD                  TO FIO-CMND.                   
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-UPD-IPC-TDOC.                                   
       FIN-UPD-IPC-TDOC.                                                
           EXIT.                                                        
                                                                        
       COPY SGCBFIPC.                                                   
       COPY SGCBFDBC.                                                   
       COPY SGCBFRPR.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBEGLS.                                                   
       COPY GNSBBTAB.                                                   
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING                                                 
           IF FIO-STAT-OKS                                              
              MOVE FIO-STAT     TO PGM-STAT-DAC                         
              PERFORM FND-IPC-IFOL                                      
              MOVE PGM-STAT-DAC TO FIO-STAT.                            
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI                                                 
           IF FIO-STAT-OKS                                              
              MOVE FIO-STAT     TO PGM-STAT-DAC                         
              PERFORM FND-IPC-IFOL                                      
              MOVE PGM-STAT-DAC TO FIO-STAT.                            
      *>>>>
*% END
