
      * Obtencion de parametros para DBC
       GET-PAR SECTION.
       INI-GET-PAR.
      *Captura Tipo de Identificador
           DISPLAY 'INGRESE T/C/O/E : '.
           ACCEPT  WSS-IND-SEL1.
           DISPLAY WSS-IND-SEL1.
      *Captura Identificador
           DISPLAY 'INGRESE IDENTIFICACION : '.
           ACCEPT  WSS-IND-SEL2.
           DISPLAY WSS-IND-SEL2.

           DISPLAY 'Fin    de Captura    de Parametros'.
           DISPLAY 'Inicio de Validacion de Parametros'.

      *VAL-MSC Valida miscelaneo de tabla : Tipo de Identificador
           DISPLAY WSS-IND-SEL1.
           MOVE 'SGC' TO MSC-COD-SIST.
           MOVE 'TOEC' TO MSC-COD-TMSC IN MSC.
           MOVE WSS-IND-SEL1 TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-END
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-SEL1
               MOVE MSC-CIC-CMSC IN MSC TO WSS-CIC-SEL1.

           IF WSS-CIC-SEL1 = 'O'
      *VAL-OFI valida Codigo de Oficina en tablas
               DISPLAY WSS-IND-SEL2
               MOVE WSS-IND-SEL2 TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-END
               ELSE
                   MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-SEL2
                   MOVE WSS-IND-SEL2        TO WSS-COD-OFIC
           ELSE
           IF WSS-CIC-SEL1 = 'E'
      *VAL-USR Valida Usuario ( Ejecutivo )
               DISPLAY WSS-IND-SEL2
               MOVE 'EJC'        TO USR-COD-TTAB IN USR
               MOVE WSS-IND-SEL2 TO USR-COD-USER IN USR
               PERFORM VAL-USR
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-DESC
                   PERFORM GNS-PRO-END
               ELSE
                   MOVE WSS-IND-SEL2        TO WSS-COD-EJEC
                   MOVE USR-GLS-DESC IN USR TO WSS-GLS-SEL2
           ELSE
           IF WSS-CIC-SEL1 = 'C'
      *Lee Cliente solicitado
               DISPLAY WSS-IND-SEL2
               MOVE WSS-IND-SEL2   TO DBC-IDC-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC
                   PERFORM GNS-PRO-END
               ELSE
                   MOVE WSS-IND-SEL2 TO WSS-IDC-ICLI
                   MOVE SPACES       TO WSS-GLS-SEL2.
       FIN-GET-PAR.
           EXIT.
