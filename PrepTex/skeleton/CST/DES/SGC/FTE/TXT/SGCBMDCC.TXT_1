*%! Codigo adicional para archivo
*% IF FIN_UNP_DCC_DCC AND PGM_BU
           MOVE FRM-CPIM-UBY TO DBC-COD-SETO-ATR IN DCC-FLD.
*% END
*% IF INI_FST_FLD_DCC
      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
           IF SCR-CMND = WSS-IND-CMND
               MOVE 0   TO DCC-NUM-TCHP-LEN IN DCC-FLD
               MOVE -1  TO DBC-COD-SETO-LEN IN DCC-FLD
               GO TO FIN-FST-FLD-DCC.
      *PVC-FIN 25-02-2014
*% END
*% IF FIN_PUT_DCC_DCC
      *<<<< FIN_PUT_DCC_DCC
      *BUS-USR busca usuario en tablas
           IF DCC-COD-EJCE IN DCC-FLD > SPACES
               MOVE DCC-COD-EJCE IN DCC-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DCC-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-EJEC IN DCC-FLD.
      *BUS-OFI busca oficina en tablas
           IF DCC-COD-OFIR IN DCC-FLD > SPACES
               MOVE DCC-COD-OFIR IN DCC-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIR IN DCC-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-OFIR IN DCC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF DCC-COD-BDIR IN DCC-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'BDR'                   TO TAB-COD-TTAB IN TAB
               MOVE DCC-COD-BDIR IN DCC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-BDIR IN DCC-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-BDIR     IN DCC-FLD.
           MOVE     FRM-CPIM-AEY        TO FRM-GLS-BDIR-ATR IN DCC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_DCC
      *<<<< FIN_PUT_DBC_DCC
           MOVE    DBC-GLS-NOMC IN DBC TO CPT-STRN
           PERFORM CPT-BLKS
           MOVE    CPT-STRN            TO FRM-GLS-NOMC IN DCC-FLD.
      *>>>>
*% END
*% IF INI_KEY_DCC_DCC
      *<<<< INI_KEY_DCC_DCC
           MOVE SCR-CAI-ICLI TO DCC-CAI-ICLI IN DCC.
           MOVE SCR-IIC-ICLI TO DCC-IIC-ICLI IN DCC.
      *>>>>
*% END
*% IF FIN_CLR_FLD_DCC
      *<<<< FIN_CLR_FLD_DCC
           MOVE     FRM-CPIM-AEY   TO FRM-GLS-BDIR-ATR IN DCC-FLD.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN DCC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN DCC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN DCC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN DCC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-GLS-ICLI
               ELSE
                   MOVE FIO-STAT TO PGM-STAT-DBC
                   MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.
      *>>>>
*% END
*% IF FIN_DCC_IND_UTBC
      *<<<< FIN_DCC_IND_UTBC
           IF  DCC-NUM-UPBC IN DCC-FLD = ZEROES  AND
               DCC-IND-UTBC IN DCC-FLD > SPACES
               MOVE SPACES         TO FRM-GLS-UTBC IN DCC-FLD
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'CAMPOBLANCO'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-IND-UTBC.

           IF  DCC-NUM-UPBC IN DCC-FLD > ZEROES  AND
               DCC-IND-UTBC IN DCC-FLD = SPACES
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'GLS    BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-IND-UTBC.
      *>>>>
*% END
*% IF INI_DCC_FEC_FIBC
      *<<<< INI_DCC_FEC_FIBC
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF FIN_DCC_IND_PBOL
      *<<<< FIN_DCC_IND_PBOL
      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
      *    IF DCC-IND-PBOL IN DCC-FLD NOT > SPACES
      *       GO TO FIN-VAL-DCC-IND-PBOL.
      *
      *    MOVE  'BGL'                    TO TAB-COD-SIST.
      *    MOVE  'SIN'                    TO TAB-COD-TTAB IN TAB.
      *    MOVE  DCC-IND-PBOL IN DCC-FLD  TO TAB-COD-CTAB IN TAB.
      *    PERFORM VAL-COD.
      *PVC-FIN 25-02-2014
      *>>>>
*% END
*% IF FIN_DCC_COD_RCHZ
      *<<<< FIN_DCC_COD_RCHZ
           IF DCC-COD-RCHZ IN DCC-FLD NOT > SPACES
              GO TO FIN-VAL-DCC-COD-RCHZ.

      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
      *    MOVE  'BGL'                    TO TAB-COD-SIST.
      *    MOVE  'SIN'                    TO TAB-COD-TTAB IN TAB.
           MOVE  'GNS'                    TO TAB-COD-SIST.
           MOVE  'SON'                    TO TAB-COD-TTAB IN TAB.
      *PVC-FIN 25-02-2014
           MOVE  DCC-COD-RCHZ IN DCC-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_DCC_COD_OFIR
      *<<<< FIN_DCC_COD_OFIR
           IF (DCC-COD-RCHZ IN DCC-FLD NOT > SPACES   OR
               DCC-COD-RCHZ IN DCC-FLD     = 'N'         )  AND
               DCC-COD-OFIR IN DCC-FLD NOT > SPACES
               GO TO FIN-VAL-DCC-COD-OFIR.

           IF (DCC-COD-RCHZ IN DCC-FLD     = ' '   OR
               DCC-COD-RCHZ IN DCC-FLD     = 'N')  AND
               DCC-COD-OFIR IN DCC-FLD > SPACES
               MOVE SPACES         TO FRM-GLS-OFIR IN DCC-FLD
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'CAMPOBLANCO'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-COD-OFIR.

           IF  DCC-COD-RCHZ IN DCC-FLD     = 'S' AND
               DCC-COD-OFIR IN DCC-FLD = SPACES
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'GLS    BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-COD-OFIR.

           MOVE DCC-COD-OFIR IN DCC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES              TO FRM-GLS-OFIR IN DCC-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIR IN DCC-FLD.
      *>>>>
*% END
*% IF FIN_DCC_IND_CCEE
      *<<<< FIN_DCC_IND_CCEE
           IF DCC-IND-CCEE IN DCC-FLD NOT > SPACES
              GO TO FIN-VAL-DCC-IND-CCEE.

      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
      *    MOVE  'BGL'                    TO TAB-COD-SIST.
      *    MOVE  'SIN'                    TO TAB-COD-TTAB IN TAB.
           MOVE  'GNS'                    TO TAB-COD-SIST.
           MOVE  'SON'                    TO TAB-COD-TTAB IN TAB.
      *PVC-FIN 25-02-2014
           MOVE  DCC-IND-CCEE IN DCC-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_DCC_COD_EJCE
      *<<<< FIN_DCC_COD_EJCE
           IF  DCC-IND-CCEE IN DCC-FLD NOT = 'S' AND
               DCC-COD-EJCE IN DCC-FLD > SPACES
               MOVE SPACES         TO FRM-GLS-EJEC IN DCC-FLD
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'CAMPOBLANCO'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-COD-EJCE.

           IF  DCC-IND-CCEE IN DCC-FLD     = 'S' AND
               DCC-COD-EJCE IN DCC-FLD = SPACES
               MOVE 'SGC'          TO MSG-COD-SIST    FIO-SIST
               MOVE 'GLS    BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DCC-COD-EJCE.

           IF  DCC-COD-EJCE IN DCC-FLD = SPACES
               MOVE SPACES TO FRM-GLS-EJEC IN DCC-FLD.
           MOVE    'EJC '               TO USR-COD-TTAB IN USR.
           MOVE DCC-COD-EJCE IN DCC-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF  MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF  MSG-COD-MENS NOT = 'COD    NEX' AND
               DCC-COD-EJCE IN DCC-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DCC-FLD
           ELSE
               MOVE SPACES             TO FRM-GLS-EJEC IN DCC-FLD.
      *>>>>
*% END
*% IF FIN_DCC_COD_BDIR
      *<<<< FIN_DCC_COD_BDIR
           IF DCC-COD-BDIR IN DCC-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-BDIR IN DCC-FLD
              GO TO FIN-VAL-DCC-COD-BDIR.

           MOVE 'SGC'                    TO TAB-COD-SIST.
           MOVE 'BDR '                   TO TAB-COD-TTAB IN TAB.
           MOVE  DCC-COD-BDIR IN DCC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_DCC_IND_MBCS
      *<<<< FIN_DCC_IND_MBCS
           IF DCC-IND-MBCS IN DCC-FLD NOT > SPACES
              GO TO FIN-VAL-DCC-IND-MBCS.

      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
      *    MOVE  'BGL'                    TO TAB-COD-SIST.
      *    MOVE  'SIN'                    TO TAB-COD-TTAB IN TAB.
           MOVE  'GNS'                    TO TAB-COD-SIST.
           MOVE  'SON'                    TO TAB-COD-TTAB IN TAB.
      *PVC-FIN 25-02-2014
           MOVE  DCC-IND-MBCS IN DCC-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_DBC_COD_SETO
      *PVC-INI 25-02-2014 - PRC; SEGMENTACION HAX; 52731
           MOVE SPACES  TO WSS-IND-SEGB.
           MOVE SPACES  TO WSS-IND-SEGS.
           MOVE SPACES  TO WSS-COD-TBAN.

           IF SCR-CMND NOT = WSS-IND-CMND
               GO TO FIN-VAL-DBC-COD-SETO.
*% END
*% IF FIN_DBC_COD_SETO

           IF MSG-COD-MENS NOT = WSS-COD-SPCE
               GO TO FIN-VAL-DBC-COD-SETO.

           MOVE TAB-COD-DAT1(1)  TO WSS-IND-SEGS.

           MOVE SCR-CIC-ICLI         TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF FIO-STAT-OKS
               MOVE DCP-COD-TBAN IN DCP TO WSS-COD-TBAN
           ELSE
           MOVE SCR-CIC-ICLI         TO DCE-CIC-ICLI IN DCE
           MOVE FIO-GET-KEY          TO FIO-CMND
           PERFORM SGC-FIO-DCE
           IF FIO-STAT-OKS
               MOVE DCE-COD-TBAN IN DCE TO WSS-COD-TBAN.

           IF WSS-COD-TBAN NOT > WSS-COD-SPCE
               MOVE SPACES   TO DBC-COD-SETO IN DCC-FLD
               MOVE WSS-COD-SIST TO MSG-COD-SIST FIO-SIST
               MOVE WSS-COD-MSGM TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-DBC-COD-SETO.

           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'BAN'          TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-TBAN   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = WSS-COD-SPCE
               GO TO FIN-VAL-DBC-COD-SETO.

           MOVE TAB-COD-DAT1(1) TO WSS-IND-SEGB.

           IF WSS-IND-SEGB NOT = WSS-IND-SEGS
               MOVE WSS-COD-SIST TO MSG-COD-SIST FIO-SIST
               MOVE WSS-COD-MSGM TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVC-FIN 25-02-2014
*% END
