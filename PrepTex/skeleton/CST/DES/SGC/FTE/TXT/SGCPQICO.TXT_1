*%! Codigo adicional para archivo
*% FRM = "RCO"
*%
*% PADRE = "DBC"
*% KEY_PADRE = "DBC-KEY-IDBC"
*% LARGO_KEY_PADRE = 12
*% RELACION_PADRE_HIJO = "DBC-CIC-ICLI"
*% LARGO_RELACION_PADRE_HIJO = 12
*% FIO_PADRE = "SGC-FIO-DBC"
*% SIST_PADRE = "SGC"
*% KEY_BROWSE_PADRE = "DBC-GLS-NOMC"
*%
*% HIJO  = "RCO"
*% KEY_HIJO = "RCO-KEY-IRCO"
*% LARGO_KEY_HIJO = 24
*% RELACION_HIJO_PADRE = "RCO-CIC-ICLI"
*% FIO_HIJO = "SGC-FIO-RCO"
*% SIST_HIJO = "SGC"
*% KEY_BROWSE_HIJO = "RCO-KEY-IRCO"
*%
*% HERMANO = "OPE"
*% COLAR_OPE = TRUE
*%
*% ACEPTE_PF5 = TRUE
*% ACEPTE_PF6 = TRUE
*% ACEPTE_PF7 = TRUE
*% ACEPTE_PF8 = TRUE
*%
*%! INCLUDE 'GNSSRC:PFSCONREL.SRC'
*% INCLUDE 'PFSCONREL.SRC'
*% IF WSS AND PGM_DTC
      *<<<< WSS AND PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY SGCBROPE.
       COPY SGCBRRCD.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGHOY.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF DBC-NUM-ICLI IN RCO-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN RCO-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN RCO-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN RCO-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO RCO-CAI-ICLI IN RCO-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RCO-IIC-ICLI IN RCO-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RCO-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RCO-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN RCO-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN RCO-FLD
                   PERFORM CPT-NOMC
                   MOVE '00' TO PGM-STAT-DBC FIO-STAT
           ELSE
           IF DBC-GLS-NOMC IN RCO-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE DBC-GLS-NOMC IN RCO-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO RCO-CAI-ICLI IN RCO-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO RCO-IIC-ICLI IN RCO-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN RCO-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN RCO-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN RCO-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN RCO-FLD
                   PERFORM CPT-NOMC
                   MOVE '00' TO PGM-STAT-DBC FIO-STAT.

           PERFORM KEY-RCO-RCO.
      * CONDICION 1 ( SOLO ICLI (NOMBRE O IDC) ) 

           IF ( RCO-CAI-ICLI IN RCO-FLD > SPACES OR
                RCO-IIC-ICLI IN RCO-FLD > SPACES ) AND

                RCO-CAI-IOPE IN RCO-FLD NOT > SPACES AND
                RCO-IIC-IOPE IN RCO-FLD NOT > ZEROES
                 GO TO FIN-FND-KEY.

      * CONDICION 2 ( SOLO IOPE )

           IF ( RCO-CAI-IOPE IN RCO-FLD > SPACES OR
                RCO-IIC-IOPE IN RCO-FLD > ZEROES ) AND

                RCO-CAI-ICLI IN RCO-FLD NOT > SPACES AND
                RCO-IIC-ICLI IN RCO-FLD NOT > SPACES

               MOVE 'RCO-KEY-IOPE' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCO
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'OPE    NORCO' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE '00' TO PGM-STAT-RCO
                   GO TO FIN-FND-KEY.

      * CONDICION 3 ( ICLI (NOMBRE O IDC) + IOPE ) 
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF ( NOT FIO-STAT-OKS ) AND ( SCR-CMND = 'ING' OR 'ACT' )
               PERFORM LEER-HERMANO
               IF NOT PGM-STAT-OPE-OKS
                   MOVE FIO-STAT-NEX TO FIO-STAT
               ELSE
                   PERFORM PUT-OPE-RCO
                   PERFORM PUT-DBC-RCO
                   MOVE PGM-STAT-RCO TO FIO-STAT.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO RCO-STP-ITRN IN RCO.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEER-HERMANO SECTION.
       INI-LEER-HERMANO.
           MOVE RCO-CAI-IOPE IN RCO TO OPE-CAI-IOPE IN OPE.
           MOVE RCO-IIC-IOPE IN RCO TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           MOVE FIO-STAT TO PGM-STAT-OPE.
           IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'OPE    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-LEER-HERMANO.
           EXIT.

       COLAR-RCO SECTION.
       INI-COLAR-RCO.
       FIN-COLAR-RCO.
           EXIT.

       CPT-NOMC SECTION.
       INI-CPT-NOMC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                            DBC-GLS-NOMC IN RCO-FLD.
       FIN-CPT-NOMC.
           EXIT.

       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBGHOY.
      *>>>>
*% END
