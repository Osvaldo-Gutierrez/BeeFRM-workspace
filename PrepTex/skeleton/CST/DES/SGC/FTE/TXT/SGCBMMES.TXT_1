*%! Codigo adicional para archivo
*% IF FIN_PUT_DBC_MES
      *<<<< FIN_PUT_DBC_MES
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN MES-FLD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO MES-NUM-DTRN IN MES-FLD.
           MOVE HOY-MHOY IN HOY-VARI TO MES-NUM-MTRN IN MES-FLD.
           MOVE HOY-AHOY IN HOY-VARI TO MES-NUM-ATRN IN MES-FLD.
           MOVE HOY-SHOY IN HOY-VARI TO MES-NUM-STRN IN MES-FLD.
      *>>>>
*% END
*% IF FIN_PUT_MES_MES
      *<<<< FIN_PUT_MES_MES
      *     PERFORM BUS-REGI.
      *     IF COM-COD-REGI IN COM > SPACES AND
      *        COM-COD-REGI IN COM = '13'
            IF MES-COD-ABGI IN MES-FLD > SPACES
                MOVE MES-COD-ABGI IN MES-FLD TO NUM-NUME
                MOVE NUM-ZERO-S TO NUM-ZERO
                MOVE NUM-SGNO-N TO NUM-SGNO
                MOVE 12 TO NUM-NENT
                MOVE 0  TO NUM-NDCM
                CALL 'GNSPVNUM' USING NUM-VARI
                IF NOT NUM-STAT-OKS
                   MOVE MES-COD-ABGI IN MES-FLD TO USR-COD-USER IN USR
                   PERFORM BUS-USR
                   MOVE USR-GLS-DESC IN USR TO FRM-GLS-ABGI IN MES-FLD.
      *>>>>
*% END
*% IF INI_MES_FEC_FMES
      *<<<< INI_MES_FEC_FMES
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF MES_COD_ABGI
      *<<<< MES_COD_ABGI
      *     PERFORM BUS-REGI.
      *     IF NOT ( COM-COD-REGI IN COM > SPACES AND
      *        COM-COD-REGI IN COM = '13')
      *         GO TO CON-MES-COD-ABGI.
            MOVE MES-COD-ABGI IN MES-FLD TO NUM-NUME.
            MOVE NUM-ZERO-S TO NUM-ZERO.
            MOVE NUM-SGNO-N TO NUM-SGNO.
            MOVE 12 TO NUM-NENT.
            MOVE 0  TO NUM-NDCM.
            CALL 'GNSPVNUM' USING NUM-VARI.
            IF NUM-STAT-OKS
                GO TO CON-MES-COD-ABGI.
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'ABG'        TO USR-COD-TTAB IN USR.
           MOVE MES-COD-ABGI IN MES-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              MES-COD-ABGI IN MES-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ABGI IN MES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ABGI IN MES-FLD.
           GO TO FIN-VAL-MES-COD-ABGI.
       CON-MES-COD-ABGI.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_MES
      *<<<< INI_VAL_CON_KEY_MES
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-MES.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_MES
      *<<<< FIN_VAL_CON_KEY_MES
           IF NOT ( ( ( DBC-GLS-NOMC IN MES-FLD     > SPACES     OR
                        DBC-NUM-ICLI IN MES-FLD     > ZEROES )   AND
                        MES-FEC-FINF IN MES-FLD     > ZEROES )   OR
                    ( ( DBC-GLS-NOMC IN MES-FLD     > SPACES     OR
                        DBC-NUM-ICLI IN MES-FLD     > ZEROES )   AND
                        MES-FEC-FINF IN MES-FLD NOT > ZEROES ) ) 
                MOVE 'GNS' TO MSG-COD-SIST
                MOVE 'VALCONKEY' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-KEY-MES.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_MES
      *<<<< FIN_VAL_CON_IKY_MES
           IF NOT ( DBC-NUM-ICLI IN MES-FLD > ZEROES AND
                    MES-FEC-FINF IN MES-FLD > ZEROES )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF MES_FEC_FINF
      *<<<< MES_FEC_FINF
           IF MES-FEC-FINF IN MES-FLD NOT > ZEROES
               GO TO FIN-VAL-MES-FEC-FINF.
           MOVE MES-CAI-ICLI IN MES-FLD TO EDS-CAI-ICLI IN EDS.
           MOVE MES-IIC-ICLI IN MES-FLD TO EDS-IIC-ICLI IN EDS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           MOVE MES-NUM-DINF IN MES-FLD TO MES-NUM-DINF IN MES.
           MOVE MES-NUM-MINF IN MES-FLD TO MES-NUM-MINF IN MES.
           MOVE MES-NUM-SINF IN MES-FLD TO MES-NUM-SINF IN MES.
           MOVE MES-NUM-AINF IN MES-FLD TO MES-NUM-AINF IN MES.
           IF MES-FEC-FINF IN MES NOT > EDS-FEC-FINF IN EDS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FINIMES>EDS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF MES_FEC_FMES
      *<<<< MES_FEC_FMES
           IF MES-FEC-FMES IN MES-FLD NOT > ZEROES
               GO TO FIN-VAL-MES-FEC-FMES.
           MOVE MES-CAI-ICLI IN MES-FLD TO EDS-CAI-ICLI IN EDS.
           MOVE MES-IIC-ICLI IN MES-FLD TO EDS-IIC-ICLI IN EDS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           MOVE MES-NUM-DMES IN MES-FLD TO MES-NUM-DMES IN MES.
           MOVE MES-NUM-MMES IN MES-FLD TO MES-NUM-MMES IN MES.
           MOVE MES-NUM-SMES IN MES-FLD TO MES-NUM-SMES IN MES.
           MOVE MES-NUM-AMES IN MES-FLD TO MES-NUM-AMES IN MES.
           IF MES-FEC-FMES IN MES NOT > EDS-FEC-FESC IN EDS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FECFMESFESC>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_MES_FEC_FPUB
      *<<<< INI_MES_FEC_FPUB
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_MES_FEC_FLEG
      *<<<< INI_MES_FEC_FLEG
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF VAL_CON_FLD_MES
      *<<<< VAL_CON_FLD_MES
           IF NOT ( ( MES-GLS-LEGA IN MES-FLD NOT > SPACES     AND
                      MES-FEC-FLEG IN MES-FLD NOT > ZEROES)    OR
                    ( MES-GLS-LEGA IN MES-FLD     > SPACES     AND
                      MES-FEC-FLEG IN MES-FLD     > ZEROES ) )
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FECFLEGNOCNS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-MES.
      *ALD
      *    IF MES-FEC-FMES IN MES-FLD     > ZEROES AND
      *       MES-FEC-FLEG IN MES-FLD     > ZEROES
      *        MOVE MES-FEC-FMES IN MES-FLD TO FEC-FEC1
      *        MOVE MES-FEC-FLEG IN MES-FLD TO FEC-FEC2
      *        MOVE FEC-FORM-FEC TO FEC-FORM
      *        MOVE FEC-CMP-FEC  TO FEC-CMND
      *        PERFORM PRO-FEC
      *        IF FEC-STAT-GRT
      *            MOVE 'SGC' TO MSG-COD-SIST
      *            MOVE 'FECFMESFLEG' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            GO TO FIN-VAL-CON-FLD-MES.
      *    IF MES-FEC-FLEG IN MES-FLD     > ZEROES AND
      *       MES-FEC-FPUB IN MES-FLD     > ZEROES
      *        MOVE MES-FEC-FLEG IN MES-FLD TO FEC-FEC1
      *        MOVE MES-FEC-FPUB IN MES-FLD TO FEC-FEC2
      *        MOVE FEC-FORM-FEC TO FEC-FORM
      *        MOVE FEC-CMP-FEC  TO FEC-CMND
      *        PERFORM PRO-FEC
      *        IF FEC-STAT-GRT
      *            MOVE 'SGC' TO MSG-COD-SIST
      *            MOVE 'FECFLEGFPUB' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            GO TO FIN-VAL-CON-FLD-MES.
           IF MES-FEC-FPUB IN MES-FLD     > ZEROES AND
              MES-FEC-FINF IN MES-FLD     > ZEROES
               MOVE MES-FEC-FPUB IN MES-FLD TO FEC-FEC1
               MOVE MES-FEC-FINF IN MES-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFPUBFINF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-MES.
           IF MES-FEC-FINF IN MES-FLD     > ZEROES AND
              MES-FEC-FTRN IN MES-FLD     > ZEROES
               MOVE MES-FEC-FINF IN MES-FLD TO FEC-FEC1
               MOVE MES-FEC-FTRN IN MES-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFINFFTRN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-MES.
           IF MES-FEC-FMES IN MES-FLD     > ZEROES AND
              MES-FEC-FPUB IN MES-FLD     > ZEROES
               MOVE MES-FEC-FMES IN MES-FLD TO FEC-FEC1
               MOVE MES-FEC-FPUB IN MES-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFMESFPUB' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-MES.
           IF MES-FEC-FMES IN MES-FLD     > ZEROES AND
              MES-FEC-FINF IN MES-FLD     > ZEROES
               MOVE MES-FEC-FMES IN MES-FLD TO FEC-FEC1
               MOVE MES-FEC-FINF IN MES-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFMESFINF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-MES.
           IF MES-FEC-FLEG IN MES-FLD     > ZEROES AND
              MES-FEC-FINF IN MES-FLD     > ZEROES
               MOVE MES-FEC-FLEG IN MES-FLD TO FEC-FEC1
               MOVE MES-FEC-FINF IN MES-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFLEGFINF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-MES.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-REGI SECTION.
       INI-BUS-REGI.
      * Mediante BUS-OFI Busca Oficina Obteniendo Codigos de Tabla OFI
           IF MES-COD-OFII IN MES-FLD NOT > SPACES
               MOVE SPACES TO COM-COD-REGI IN COM
               GO TO FIN-BUS-REGI.
      * Mediante BUS-TAB Busca Comuna Obteniendo Codigos de Tabla COM
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'COM'               TO TAB-COD-TTAB IN TAB.
           MOVE OFI-COD-COMU IN OFI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO COM-COD-REGI IN COM
               GO TO FIN-BUS-REGI.
      * Obtiene Region de Oficina de Operacion del Credito
           MOVE TAB TO COM.
       FIN-BUS-REGI.
           EXIT.
      *>>>>
*% END
