*%! Codigo adicional para archivo
*% IF REC_IND_ADI1
      *<<<< REC_IND_ADI1
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE REC-IND-ADI1 IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF REC_IND_ADI2
      *<<<< REC_IND_ADI2
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE REC-IND-ADI2 IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_RET_REC_REC
      *<<<< INI_RET_REC_REC
           MOVE REC-IND-VIGE IN REC-FLD TO REC-IND-VIGE IN REC.         
           MOVE REC-NUM-DINI IN REC-FLD TO REC-NUM-DINI IN REC.
           MOVE REC-NUM-MINI IN REC-FLD TO REC-NUM-MINI IN REC.
           MOVE REC-NUM-SINI IN REC-FLD TO REC-NUM-SINI IN REC.
           MOVE REC-NUM-AINI IN REC-FLD TO REC-NUM-AINI IN REC.
           MOVE REC-NUM-DTER IN REC-FLD TO REC-NUM-DTER IN REC.
           MOVE REC-NUM-MTER IN REC-FLD TO REC-NUM-MTER IN REC.
           MOVE REC-NUM-STER IN REC-FLD TO REC-NUM-STER IN REC.
           MOVE REC-NUM-ATER IN REC-FLD TO REC-NUM-ATER IN REC.
           MOVE REC-COD-AREC IN REC-FLD TO REC-COD-AREC IN REC.
           MOVE REC-COD-SARC IN REC-FLD TO REC-COD-SARC IN REC.
           MOVE REC-NUM-DVRF IN REC-FLD TO REC-NUM-DVRF IN REC.
           MOVE REC-NUM-MVRF IN REC-FLD TO REC-NUM-MVRF IN REC.
           MOVE REC-NUM-SVRF IN REC-FLD TO REC-NUM-SVRF IN REC.
           MOVE REC-NUM-AVRF IN REC-FLD TO REC-NUM-AVRF IN REC.
           MOVE REC-CAI-IARC IN REC-FLD TO REC-CAI-IARC IN REC.
           MOVE REC-IIC-IARC IN REC-FLD TO REC-IIC-IARC IN REC.
           MOVE REC-EXT-IARC IN REC-FLD TO REC-EXT-IARC IN REC.
           MOVE REC-IND-ADI1 IN REC-FLD TO REC-IND-ADI1 IN REC.
           MOVE REC-IND-ADI2 IN REC-FLD TO REC-IND-ADI2 IN REC.
           MOVE REC-SGV-AREC IN REC-FLD TO REC-SGV-AREC IN REC.
           MOVE REC-COD-VCAM IN REC-FLD TO REC-COD-VCAM IN REC.
           MOVE REC-NUM-DVAL IN REC-FLD TO REC-NUM-DVAL IN REC.
           MOVE REC-NUM-MVAL IN REC-FLD TO REC-NUM-MVAL IN REC.
           MOVE REC-NUM-SVAL IN REC-FLD TO REC-NUM-SVAL IN REC.
           MOVE REC-NUM-AVAL IN REC-FLD TO REC-NUM-AVAL IN REC.
           MOVE REC-SGV-SARC IN REC-FLD TO REC-SGV-SARC IN REC.
           GO TO FIN-RET-REC-REC.
      *>>>>
*% END
*% IF INI_PUT_REC_REC
      *<<<< INI_PUT_REC_REC
           IF REC-SGV-SARC IN REC IS NOT NUMERIC 
               MOVE ZEROES TO REC-SGV-SARC IN REC.
      *>>>>
*% END
*% IF FIN_PUT_REC_REC
      *<<<< FIN_PUT_REC_REC
      *BUS-CLI busca cliente
           MOVE REC-CAI-ICLI IN REC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE REC-IIC-ICLI IN REC-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMC IN REC-FLD
               MOVE ZEROES              TO FRM-NUM-ICLI IN REC-FLD
               MOVE SPACES              TO FRM-IND-ICLI IN REC-FLD
*% IF PGM_ARG
               MOVE ZEROES              TO FRM-GLS-ICLI IN REC-FLD
               MOVE SPACES              TO FRM-MSC-SCLT IN REC-FLD
*% ELSE
               MOVE SPACES              TO FRM-GLS-ICLI IN REC-FLD
*% END
               MOVE SPACES              TO FRM-VRF-ICLI IN REC-FLD
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN REC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN REC-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN REC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN REC-FLD
*% IF PGM_ARG
               MOVE DBC-MSC-SCLI IN DBC TO FRM-MSC-SCLT IN REC-FLD
*% END
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN REC-FLD.
      *BUS-CLI busca cliente
           MOVE REC-CAI-IREL IN REC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE REC-IIC-IREL IN REC-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-NOMR IN REC-FLD
               MOVE ZEROES              TO FRM-NUM-IREL IN REC-FLD
               MOVE SPACES              TO FRM-IND-IREL IN REC-FLD
*% IF PGM_ARG
               MOVE ZEROES              TO FRM-GLS-IREL IN REC-FLD
               MOVE SPACES              TO FRM-MSC-SREL IN REC-FLD
*% ELSE
               MOVE SPACES              TO FRM-GLS-IREL IN REC-FLD
*% END
               MOVE SPACES              TO FRM-VRF-IREL IN REC-FLD
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMR IN REC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IREL IN REC-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IREL IN REC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IREL IN REC-FLD
*% IF PGM_ARG
               MOVE DBC-MSC-SCLI IN DBC TO FRM-MSC-SREL IN REC-FLD
*% END
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IREL IN REC-FLD.

*% IF PGM_ARG
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FRM-MSC-SCLT IN REC-FLD > SPACES
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'SCLI' TO MSC-COD-TMSC IN MSC
               MOVE FRM-MSC-SCLT IN REC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SCLT IN REC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SCLT IN REC-FLD.


      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FRM-MSC-SREL IN REC-FLD > SPACES
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'SCLI' TO MSC-COD-TMSC IN MSC
               MOVE FRM-MSC-SREL IN REC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SREL IN REC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SREL IN REC-FLD.
*% END

      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB

           IF REC-COD-TREC IN REC-FLD NOT > SPACES
              MOVE SPACE TO REC-COD-TREC IN REC-FLD.

           IF REC-COD-SARC IN REC-FLD NOT > SPACES
              MOVE SPACE TO REC-COD-SARC IN REC-FLD.

      *JCD-FIN 03-FEB-2015 Altas y Bajas en la WEB
           IF REC-COD-TREC IN REC-FLD = REC-COD-APOD IN REC-VARI OR
              REC-COD-TREC IN REC-FLD = REC-COD-OPOD IN REC-VARI
               MOVE SPACES TO FRM-GLS-AREC IN REC-FLD
               GO TO NO-BUS-REC.
           IF REC-COD-AREC IN REC-FLD > SPACES
      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB
           OR REC-COD-SARC IN REC-FLD > SPACES                          
      *JCD-FIN 03-FEB-2015 Altas y Bajas en la WEB
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'REC' TO TAB-COD-TTAB IN TAB
               MOVE REC-COD-TREC IN REC-FLD TO WSS-COD-TREC
               MOVE REC-COD-AREC IN REC-FLD TO WSS-COD-AREC
      *MHM-INI 16-MAY-2003
               MOVE REC-COD-SARC IN REC-FLD TO WSS-COD-SARC
      *MHM-FIN 16-MAY-2003
               MOVE WSS-COD-CREC            TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB
               IF TAB-MSC-STAT = WC-VIGENTE
      *JCD-FIN 03-FEB-2015 Altas y Bajas en la WEB
                  MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AREC IN REC-FLD
      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB
               ELSE
                  MOVE SPACES TO FRM-GLS-AREC IN REC-FLD.
      *JCD-FIN 03-FEB-2015 Altas y Bajas en la WEB
       NO-BUS-REC.
      *>>>>
*% END
*% IF FIN_CLR_REC_REC
      *<<<< FIN_CLR_REC_REC
*% IF PGM_DOS OR PGM_MVS
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               MOVE 'S'          TO REC-IND-VIGE IN REC-FLD
               MOVE SCR-COD-CLAP TO REC-COD-AREC IN REC-FLD.
*% END
      *>>>>
*% END
*% IF FRM_VRF_ICLI
      *<<<< FRM_VRF_ICLI
           IF FRM-NUM-ICLI IN REC-FLD = ZEROES
               GO TO FIN-VAL-FRM-VRF-ICLI.
           MOVE FRM-NUM-ICLI IN REC-FLD TO IDC-NUM-RUTV.
           MOVE FRM-VRF-ICLI IN REC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           MOVE IDC-NUM-RUTV TO FRM-NUM-ICLI IN REC-FLD.
           MOVE IDC-VRF-RUTV TO FRM-VRF-ICLI IN REC-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO FIN-VAL-FRM-VRF-ICLI.
           MOVE FRM-NUM-ICLI IN REC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLI IN REC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLI IN REC-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VRF-ICLI.
*%! RVM: 31-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
*% END
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMC IN REC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-ICLI IN REC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-ICLI IN REC-FLD.
*% IF PGM_ARG
           MOVE DBC-MSC-SCLI IN DBC TO FRM-MSC-SCLT IN REC-FLD.

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FRM-MSC-SCLT IN REC-FLD > SPACES
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'SCLI' TO MSC-COD-TMSC IN MSC
               MOVE FRM-MSC-SCLT IN REC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SCLT IN REC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SCLT IN REC-FLD.
*% END
      *>>>>
*% END
*% IF FRM_VRF_IREL
      *<<<< FRM_VRF_IREL
           IF FRM-NUM-IREL IN REC-FLD = ZEROES
               GO TO FIN-VAL-FRM-VRF-IREL.
           MOVE FRM-NUM-IREL IN REC-FLD TO IDC-NUM-RUTV.
           MOVE FRM-VRF-IREL IN REC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           MOVE IDC-NUM-RUTV TO FRM-NUM-IREL IN REC-FLD.
           MOVE IDC-VRF-RUTV TO FRM-VRF-IREL IN REC-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO FIN-VAL-FRM-VRF-IREL.
           MOVE FRM-NUM-IREL IN REC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-IREL IN REC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-IREL IN REC-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VRF-IREL.
           
           PERFORM CPT-NOMC.
           MOVE CPT-STRN            TO FRM-GLS-NOMR IN REC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO REC-CAI-IREL IN REC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO REC-IIC-IREL IN REC-FLD.
*% IF PGM_ARG
           MOVE DBC-MSC-SCLI IN DBC TO FRM-MSC-SREL IN REC-FLD.

      *BUS-MSC busca glosa de miscelaneo en tabla
           IF FRM-MSC-SREL IN REC-FLD > SPACES
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'SCLI' TO MSC-COD-TMSC IN MSC
               MOVE FRM-MSC-SREL IN REC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-SREL IN REC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-SREL IN REC-FLD.
*% END
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF INI_REC_FEC_FINI
      *<<<< INI_REC_FEC_FINI
      *DAD ini  13-JUL-1993
      *    Para NO comparar con HOY
      * CIMA-INI / VALIDACIONES MOD RELA ART 85 / JULIO 2014
      *     MOVE FEC-CHOY-N  TO FEC-CHOY.
      * CIMA-FIN / VALIDACIONES MOD RELA ART 85 / JULIO 2014
      *    Para NO validar dia habil
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *DAD fin  13-JUL-1992
      *>>>>
*% END
*% IF INI_REC_FEC_FTER
      *<<<< INI_REC_FEC_FTER
      * CIMA-INI / VALIDACIONES MOD RELA ART 85 / JULIO 2014
           MOVE WSS-CT-SGC              TO TAB-COD-SIST.
           MOVE WSS-CT-REC              TO TAB-COD-TTAB IN TAB.
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-IND-VIGE IN TAB = WSS-CT-S AND
              MSG-COD-MENS NOT > SPACES
              IF TAB-GLS-DATA IN TAB(56:1) = WSS-CT-S
              IF  REC-FEC-FTER IN REC-FLD = ZEROES AND
                  REC-IND-VIGE IN REC-FLD = WSS-CT-N
                  PERFORM GET-FHOY
                  MOVE HOY-DHOY IN HOY-VARI TO REC-NUM-DTER IN REC-FLD
                  MOVE HOY-MHOY IN HOY-VARI TO REC-NUM-MTER IN REC-FLD
                  MOVE HOY-AHOY IN HOY-VARI TO REC-NUM-ATER IN REC-FLD
                  MOVE HOY-SHOY IN HOY-VARI TO REC-NUM-STER IN REC-FLD
                  GO TO FIN-VAL-REC-FEC-FTER.

      * CIMA-FIN / VALIDACIONES MOD RELA ART 85 / JULIO 2014
      *DAD ini  13-JUL-1993
      *    Para NO comparar con HOY
           MOVE FEC-CHOY-N  TO FEC-CHOY.
      *    Para NO validar dia habil
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *DAD fin  13-JUL-1992
      *>>>>
*% END
*% END
*% IF REC_COD_AREC
      *<<<< REC_COD_AREC
           IF REC-COD-AREC IN REC-FLD = '0' OR '1' OR '2' OR            
                                        '3' OR '4' OR '5' OR            
                                        '6' OR '7' OR '8' OR            
                                        '9' OR 'S' OR 'N'               
                MOVE SPACES TO FRM-GLS-AREC IN REC-FLD                  
                GO TO NO-VAL-REC.                                       
           IF REC-COD-TREC IN REC-FLD = REC-COD-APOD IN REC-VARI OR     
              REC-COD-TREC IN REC-FLD = REC-COD-OPOD IN REC-VARI        
                MOVE SPACES TO FRM-GLS-AREC IN REC-FLD                  
                GO TO NO-VAL-REC.                                       
           MOVE 'SGC' TO TAB-COD-SIST.                                  
           MOVE 'REC' TO TAB-COD-TTAB IN TAB.                           
           MOVE REC-COD-TREC IN REC-FLD TO WSS-COD-TREC.                
           MOVE REC-COD-AREC IN REC-FLD TO WSS-COD-AREC.                

      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB
           IF REC-COD-SARC IN REC-FLD NOT > SPACES                      
              MOVE SPACES TO REC-COD-SARC IN REC-FLD.                   
      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB

      *MHM-INI 16-MAY-2003                                              
           MOVE REC-COD-SARC IN REC-FLD TO WSS-COD-SARC.                
      *MHM-FIN 16-MAY-2003                                              
           MOVE WSS-COD-CREC            TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *JCD-INI 03-FEB-2015 Altas y Bajas en la WEB
      *    IF MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND                
      *       REC-COD-AREC IN REC-FLD > SPACES                          

           IF (MSG-COD-MENS IN MSG NOT = 'COD    NEX' AND
               (REC-COD-AREC IN REC-FLD > SPACES OR                     
                REC-COD-SARC IN REC-FLD > SPACES ))

               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AREC IN REC-FLD      
            ELSE                                                        
               MOVE SPACES TO FRM-GLS-AREC IN REC-FLD.                  
       NO-VAL-REC.                                                      
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF INI_REC_FEC_FVRF
      *<<<< INI_REC_FEC_FVRF
      *DAD ini  13-JUL-1993
      *    Para NO comparar con HOY
           MOVE FEC-CHOY-N  TO FEC-CHOY.
      *    Para NO validar dia habil
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *DAD fin  13-JUL-1992
      *>>>>
*% END
*% END
*% IF REC_SGV_AREC
      *<<<< REC_SGV_AREC
           IF REC-SGV-AREC IN REC-FLD NOT NUMERIC                       
                MOVE +0 TO REC-SGV-AREC IN REC-FLD.                     
      *RGD-INI PENTA 09-10-2014
           IF REC-COD-VCAM IN REC-FLD NOT = 'P'
              GO TO FIN-VAL-REC-SGV-AREC.                                       

           MOVE 'SGC' TO FIO-SIST.                                      
           MOVE 'REC' TO TAB-COD-TTAB IN TAB.                           
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT ='S'
              MOVE '00' TO FIO-STAT                                    
              GO TO FIN-VAL-REC-SGV-AREC.                                       

           IF TAB-COD-DAT3 (10) = 'HDJ' AND 
                REC-SGV-AREC IN REC-FLD > 100
              MOVE 'SGC' TO MSG-COD-SIST                           
              MOVE 'PORC> 100' TO MSG-COD-MENS                   
              PERFORM GET-MSG                                      
              MOVE MSG-GLS-DESC TO FRM-MENS                        
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *RGD-FIN PENTA
      *>>>>
*% END
*% IF REC_COD_VCAM
      *<<<< REC_COD_VCAM
           IF NOT ( REC-SGV-AREC IN REC-FLD > ZEROES AND
                    REC-COD-VCAM IN REC-FLD > SPACES AND
                    REC-FEC-FVAL IN REC-FLD > ZEROES )
               GO TO FIN-VAL-REC-COD-VCAM.
      *>>>>
*% END
*% IF REC_SGV_SARC                                                
      *<<<< REC_SGV_SARC                                                
      *RGD-INI PENTA 09-10-2014
           IF REC-SGV-SARC IN REC-FLD NOT NUMERIC                       
                MOVE +0 TO REC-SGV-SARC IN REC-FLD.                     
           MOVE 'SGC' TO FIO-SIST.                                      
           MOVE 'REC' TO TAB-COD-TTAB IN TAB.                           
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT ='S'
              MOVE '00' TO FIO-STAT                                    
              GO TO FIN-VAL-REC-SGV-AREC.                                       

           IF TAB-COD-DAT3 (10) = 'HDJ' AND 
                REC-SGV-SARC IN REC-FLD > 100
              MOVE 'SGC' TO MSG-COD-SIST                           
              MOVE 'PORC> 100' TO MSG-COD-MENS                   
              PERFORM GET-MSG                                      
              MOVE MSG-GLS-DESC TO FRM-MENS                        
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *RGD-FIN PENTA
      *>>>>                                                             
*% END
*% IF NOT PGM_PER
*% IF INI_REC_FEC_FVAL
      *<<<< INI_REC_FEC_FVAL
      * CIMA-INI / VALIDACIONES MOD RELA ART 85 / JULIO 2014
           MOVE WSS-CT-SGC              TO TAB-COD-SIST.
           MOVE WSS-CT-REC              TO TAB-COD-TTAB IN TAB.
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-IND-VIGE IN TAB = WSS-CT-S AND
              MSG-COD-MENS NOT > SPACES
              IF TAB-GLS-DATA IN TAB(55:1) = WSS-CT-S
              IF  REC-FEC-FVAL IN REC-FLD = ZEROES AND
                  REC-SGV-AREC IN REC-FLD > ZEROES AND
                  REC-COD-VCAM IN REC-FLD = WSS-CT-P
                  PERFORM GET-FHOY
                  MOVE HOY-DHOY IN HOY-VARI TO REC-NUM-DVAL IN REC-FLD
                  MOVE HOY-MHOY IN HOY-VARI TO REC-NUM-MVAL IN REC-FLD
                  MOVE HOY-AHOY IN HOY-VARI TO REC-NUM-AVAL IN REC-FLD
                  MOVE HOY-SHOY IN HOY-VARI TO REC-NUM-SVAL IN REC-FLD
                  GO TO FIN-VAL-REC-FEC-FVAL.
      * CIMA-FIN / VALIDACIONES MOD RELA ART 85 / JULIO 2014
      *DAD ini  13-JUL-1993
      *    Para NO comparar con HOY
           MOVE FEC-CHOY-N  TO FEC-CHOY.
      *    Para NO validar dia habil
           MOVE FEC-VHBL-N  TO FEC-VHBL.
      *DAD fin  13-JUL-1992
      *>>>>
*% END
*% END
*% IF INI_VAL_NUM_IKY_REC
      *<<<< INI_VAL_NUM_IKY_REC
           PERFORM VAL-NUM-AKY-REC.
      *>>>>
*% END
*% IF FIN_REC_FEC_FINI 
      *<<<< FIN_VAL_REC_FEC_FINI
      *HRS-INI 18-ABR-2007                                              
           IF REC-FEC-FINI IN REC-FLD NOT > ZEROES                      
              MOVE 'SGC'                   TO TAB-COD-SIST              
              MOVE 'REC'                   TO TAB-COD-TTAB IN TAB       
              MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM BUS-TAB                                           
              IF TAB-COD-DAT3(10) = 'CFH'                               
                 PERFORM GET-FHOY                                       
                 MOVE HOY-DHOY IN HOY-VARI TO REC-NUM-DINI IN REC-FLD   
                 MOVE HOY-MHOY IN HOY-VARI TO REC-NUM-MINI IN REC-FLD   
                 MOVE HOY-AHOY IN HOY-VARI TO REC-NUM-AINI IN REC-FLD   
                 MOVE HOY-SHOY IN HOY-VARI TO REC-NUM-SINI IN REC-FLD   
                 GO TO FIN-VAL-REC-FEC-FINI.                            
      *HRS-FIN 18-ABR-2007                                              
      *>>>>                                                             
*% END
*% IF FIN_VAL_CON_IKY_REC
      *<<<< FIN_VAL_CON_IKY_REC
           IF NOT ( FRM-NUM-ICLI IN REC-FLD NOT = ZEROES AND
                    REC-COD-TREC IN REC-FLD > SPACES AND
                    FRM-NUM-IREL IN REC-FLD NOT = ZEROES )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           PERFORM OBT-NEMO
           IF SCR-NEMO = TAB-COD-CTAB IN TAB AND
              SCR-CCPP = 'ING'
              IF NOT ( FRM-NUM-ICLI IN REC-FLD NOT = ZEROES AND
                      REC-COD-TREC IN REC-FLD > SPACES AND
                      FRM-NUM-IREL IN REC-FLD NOT = ZEROES AND
                      REC-NUM-TREC IN REC-FLD > ZEROES )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_REC
      *<<<< FIN_VAL_CON_KEY_REC
           IF NOT ( ( ( FRM-GLS-NOMC IN REC-FLD     > SPACES   OR
                        FRM-NUM-ICLI IN REC-FLD NOT = ZEROES ) AND
                      ( FRM-GLS-NOMR IN REC-FLD     > SPACES   OR
                        FRM-NUM-IREL IN REC-FLD NOT = ZEROES ) AND
                        REC-COD-TREC IN REC-FLD     > SPACES   AND
                        REC-NUM-TREC IN REC-FLD     > ZEROES ) OR
                    ( ( FRM-GLS-NOMC IN REC-FLD     > SPACES   OR
                        FRM-NUM-ICLI IN REC-FLD NOT = ZEROES ) AND
                      ( FRM-GLS-NOMR IN REC-FLD     > SPACES   OR
                        FRM-NUM-IREL IN REC-FLD NOT = ZEROES ) AND
                        REC-COD-TREC IN REC-FLD     > SPACES   AND
                        REC-NUM-TREC IN REC-FLD NOT > ZEROES ) OR
                    ( ( FRM-GLS-NOMC IN REC-FLD     > SPACES   OR
                        FRM-NUM-ICLI IN REC-FLD NOT = ZEROES ) AND
                        REC-COD-TREC IN REC-FLD     > SPACES   AND
                      ( FRM-GLS-NOMR IN REC-FLD NOT > SPACES   AND
                        FRM-NUM-IREL IN REC-FLD     = ZEROES ) AND
                        REC-NUM-TREC IN REC-FLD NOT > ZEROES ) OR
                    ( ( FRM-GLS-NOMC IN REC-FLD     > SPACES   OR
                        FRM-NUM-ICLI IN REC-FLD NOT = ZEROES ) AND
                        REC-COD-TREC IN REC-FLD NOT > SPACES   AND
                      ( FRM-GLS-NOMR IN REC-FLD NOT > SPACES   AND
                        FRM-NUM-IREL IN REC-FLD     = ZEROES ) AND
                        REC-NUM-TREC IN REC-FLD NOT > ZEROES ) )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-REC.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_REC
      *<<<< INI_VAL_CON_KEY_REC
      * CIMAGROUP-EDM INI                                               
           PERFORM UNP-IKY-REC.                                         
      * CIMAGROUP-EDM FIN                                               
          IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-REC.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_REC
      *<<<< INI_VAL_CON_IKY_REC
      * CIMAGROUP-EDM INI                                               
           PERFORM UNP-IKY-REC.                                         
      * CIMAGROUP-EDM FIN                                               
      *>>>>
*% END
*% IF FIN_CLR_KEY_REC
      *<<<< FIN_CLR_KEY_REC
      *MHM-INI 15-FEB-2007                                              
           IF SCR-NEMO = 'SGCACTCYG3.1'                                 
               MOVE 'CY' TO REC-COD-TREC IN REC-FLD                     
           ELSE                                                         
           IF SCR-NEMO = 'SGCACTEMP3.1'                                 
               MOVE 'EM' TO REC-COD-TREC IN REC-FLD                     
           ELSE                                                         
           IF SCR-NEMO = 'SGCACTSOC3.1'                                 
               MOVE 'CD' TO REC-COD-TREC IN REC-FLD.                    
      *MHM-FIN 15-FEB-2007                                              
      *>>>>
*% END
*% IF FIN_UNP_KEY_REC
      *<<<< FIN_UNP_KEY_REC
      *MHM-INI 15-FEB-2007                                              
           IF SCR-NEMO = 'SGCACTCYG3.1' OR 'SGCACTEMP3.1' OR            
                             'SGCACTSOC3.1'                             
               MOVE FRM-CPIM-AEY TO REC-COD-TREC-ATR IN REC-FLD.        
      *MHM-FIN 15-FEB-2007                                              
      *>>>>
*% END
*% IF FIN_UNP_IKY_REC
      *<<<< FIN_UNP_IKY_REC
      *MHM-INI 15-FEB-2007                                              
           IF SCR-NEMO = 'SGCACTCYG3.1' OR 'SGCACTEMP3.1' OR            
                             'SGCACTSOC3.1'                             
               MOVE FRM-CPIM-AEY TO REC-COD-TREC-ATR IN REC-FLD.        
      *MHM-FIN 15-FEB-2007                                              
      *>>>>
*% END
*% IF   VAL_CON_FLD_REC
      *<<<< VAL_CON_FLD_REC VAL_CON_FLD_REC
           IF REC-FEC-FTER IN REC-FLD     > ZEROES AND
              REC-FEC-FINI IN REC-FLD     > ZEROES
               MOVE REC-FEC-FINI IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FTER IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'FECFINIFTER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.

           IF REC-FEC-FVRF IN REC-FLD > ZEROES AND
              REC-FEC-FINI IN REC-FLD > ZEROES
               MOVE REC-FEC-FINI IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FVRF IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFINIFVRF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.

           IF REC-FEC-FVAL IN REC-FLD > ZEROES AND
              REC-FEC-FINI IN REC-FLD > ZEROES
               MOVE REC-FEC-FINI IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FVAL IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFINIFVAL' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.

           IF REC-FEC-FTER IN REC-FLD > ZEROES AND
              REC-FEC-FVRF IN REC-FLD > ZEROES
               MOVE REC-FEC-FVRF IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FTER IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFVRFFTER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.

           IF REC-FEC-FTER IN REC-FLD > ZEROES AND
              REC-FEC-FVAL IN REC-FLD > ZEROES
               MOVE REC-FEC-FVAL IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FTER IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFVALFTER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.

           IF REC-FEC-FVAL IN REC-FLD > ZEROES AND
              REC-FEC-FVRF IN REC-FLD > ZEROES
               MOVE REC-FEC-FVAL IN REC-FLD TO FEC-FEC1
               MOVE REC-FEC-FVRF IN REC-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFVALFVRF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.
           IF NOT ( ( REC-SGV-AREC IN REC-FLD      = ZEROES   AND
                      REC-COD-VCAM IN REC-FLD  NOT > SPACES   AND
                      REC-FEC-FVAL IN REC-FLD      = ZEROES ) OR
                    ( REC-SGV-AREC IN REC-FLD  NOT = ZEROES   AND
                      REC-COD-VCAM IN REC-FLD      > SPACES   AND
                      REC-FEC-FVAL IN REC-FLD  NOT = ZEROES ) )
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FECFVALNOCNS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-REC.
           IF REC-FEC-FINI IN REC-FLD > ZEROES
               MOVE REC-CAI-ICLI IN REC-FLD TO DBC-CAI-ICLI IN DBC
               MOVE REC-IIC-ICLI IN REC-FLD TO DBC-IIC-ICLI IN DBC
               PERFORM VAL-FEC-CTNC
               IF FRM-SUAR = FRM-SUAR-MAL 
                   GO TO FIN-VAL-CON-FLD-REC
               ELSE
                   MOVE REC-CAI-IREL IN REC-FLD TO DBC-CAI-ICLI IN DBC
                   MOVE REC-IIC-IREL IN REC-FLD TO DBC-IIC-ICLI IN DBC
                   PERFORM VAL-FEC-CTNC
                   IF FRM-SUAR = FRM-SUAR-MAL 
                       GO TO FIN-VAL-CON-FLD-REC.
      *MHM-INI 26-MAY-2003
      *     IF REC-FEC-FTER IN REC-FLD > ZEROES
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'REC ' TO TAB-COD-TTAB IN TAB.
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              REC-COD-TREC IN REC-FLD NOT > SPACES
               MOVE SPACES TO WSS-CIC-TREC IN WSS-VARI
           ELSE
      *PVG INI 05-DIC-2008                                              
               MOVE TAB-COD-DAT2(1) TO WSS-GLS-AVIG IN WSS-VARI         
      *PVG FIN 05-DIC-2008                                              
             MOVE TAB-CIC-CTAB IN TAB TO
                    WSS-CIC-TREC IN WSS-VARI.
      *PVG INI 05-DIC-2008                                              
      *    IF REC-FEC-FTER IN REC-FLD > ZEROES AND                      
      *       WSS-GLS-TREC IN WSS-VARI NOT = 'OB' AND                   
      *       WSS-GLS-TREC IN WSS-VARI NOT = 'BO' AND                   
      *       WSS-GLS-TREC IN WSS-VARI NOT = 'CS' AND                   
      *       WSS-GLS-TREC IN WSS-VARI NOT = 'TC'                       
      *MHM-FIN 26-MAY-2003                                              
      *        MOVE 'N' TO REC-IND-VIGE IN REC-FLD.                     
           IF REC-FEC-FTER IN REC-FLD > ZEROES AND                      
              WSS-IND-AVIG IN WSS-VARI NOT = 'N'                        
              MOVE 'N' TO REC-IND-VIGE IN REC-FLD.                      
      *PVG FIN 05-DIC-2008                                              
      *PVG INI 29-AGO-2013
           PERFORM PRO-VAL-DUPL.
      *PVG FIN 29-AGO-2013
      * CIMA-INI / VALIDACIONES MOD RELA ART 85 / JULIO 2014
           MOVE WSS-CT-SGC              TO TAB-COD-SIST.
           MOVE WSS-CT-REC              TO TAB-COD-TTAB IN TAB.
           MOVE REC-COD-TREC IN REC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-IND-VIGE IN TAB = WSS-CT-S AND
              MSG-COD-MENS NOT > SPACES
              IF TAB-GLS-DATA IN TAB(57:1) = WSS-CT-S
              MOVE WSS-CT-SGC              TO TAB-COD-SIST
              MOVE WSS-CT-VSN              TO TAB-COD-TTAB IN TAB
              MOVE WSS-CT-PPAR             TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF TAB-IND-VIGE IN TAB = WSS-CT-S AND
                 MSG-COD-MENS NOT > SPACES
                 MOVE TAB-GLS-DATA IN TAB(1:3) TO WSS-NUM-PPAR
                 IF REC-SGV-AREC IN REC-FLD > WSS-NUM-PPAR
                   MOVE WSS-CT-SGC  TO MSG-COD-SIST
                   MOVE WSS-CT-VAPO TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-REC.
      * CIMA-FIN / VALIDACIONES MOD RELA ART 85 / JULIO 2014
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-FEC-CTNC SECTION.
       INI-VAL-FEC-CTNC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC
           IF NOT FIO-STAT-OKS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'REC    DBCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FEC-CTNC.
           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-KEY-IDBC IN DBC TO DCP-KEY-IDCP IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'REC    DCPNX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DCP-NUM-DNAC IN DCP TO WSS-NUM-DCNC
                   MOVE DCP-NUM-MNAC IN DCP TO WSS-NUM-MCNC
                   MOVE DCP-NUM-SNAC IN DCP TO WSS-NUM-SCNC
                   MOVE DCP-NUM-ANAC IN DCP TO WSS-NUM-ACNC
                   MOVE WSS-FEC-FCNC            TO FEC-FEC1
                   MOVE REC-FEC-FINI IN REC-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC  TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'FECFNACFINI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                   ELSE
                       NEXT SENTENCE
           ELSE
               MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'REC    DCENX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DCE-NUM-DCTT IN DCE TO WSS-NUM-DCNC
                   MOVE DCE-NUM-MCTT IN DCE TO WSS-NUM-MCNC
                   MOVE DCE-NUM-SCTT IN DCE TO WSS-NUM-SCNC
                   MOVE DCE-NUM-ACTT IN DCE TO WSS-NUM-ACNC
                   MOVE WSS-FEC-FCNC            TO FEC-FEC1
                   MOVE REC-FEC-FINI IN REC-FLD TO FEC-FEC2
                   MOVE FEC-FORM-FEC TO FEC-FORM
                   MOVE FEC-CMP-FEC  TO FEC-CMND
                   PERFORM PRO-FEC
                   IF FEC-STAT-GRT
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'FECFCTTFINI' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-FEC-CTNC.
           EXIT.
      *>>>>
*% END
*% IF EOF 
*% IF PGM_BU
      *PVG INI 29-AGO-2013
       PRO-VAL-DUPL SECTION.
       INI-PRO-VAL-DUPL.
           IF REC-NUM-TREC IN REC-FLD NOT > 1
              GO TO FIN-PRO-VAL-DUPL.
           MOVE ZEROES TO WSS-I IN WSS-VARI.

           MOVE 'SGC'          TO TAB-COD-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'VALREGDPLREC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.
       LUP-PRO-VAL-DUPL-TREC.
           ADD 1 TO WSS-I IN WSS-VARI.
           IF WSS-I IN WSS-VARI > WSS-IMAX IN WSS-VARI
              GO TO FIN-PRO-VAL-DUPL.
           IF REC-COD-TREC IN REC-FLD = WSS-COD-DAT1(WSS-I IN WSS-VARI)
              GO TO CNT-PRO-VAL-DUPL.
           GO TO LUP-PRO-VAL-DUPL-TREC.
       CNT-PRO-VAL-DUPL.
           PERFORM KEY-ALL-REC.
           SUBTRACT 1 FROM REC-NUM-TREC IN REC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF NOT (FIO-STAT-OKS AND
                   REC-CAI-ICLI IN REC = REC-CAI-ICLI IN REC-FLD AND
                   REC-IIC-ICLI IN REC = REC-IIC-ICLI IN REC-FLD AND
                   REC-COD-TREC IN REC = REC-COD-TREC IN REC-FLD AND
                   REC-CAI-IREL IN REC = REC-CAI-IREL IN REC-FLD AND
                   REC-IIC-IREL IN REC = REC-IIC-IREL IN REC-FLD)
              GO TO FIN-PRO-VAL-DUPL.
           IF REC-IND-VIGE IN REC NOT = 'S'
              GO TO FIN-PRO-VAL-DUPL.
           IF REC-FEC-FTER IN REC NOT > ZEROES
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'REGREPREC   ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-VAL-DUPL.

      *    WSS-FEC-FINI IN WSS-VARI
           MOVE REC-NUM-DINI IN REC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE REC-NUM-MINI IN REC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE REC-NUM-SINI IN REC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE REC-NUM-AINI IN REC-FLD TO WSS-NUM-AINI IN WSS-VARI.
      *    WSS-FEC-FTER IN WSS-VARI
      *    MOVE REC-NUM-DTER IN REC-FLD TO WSS-NUM-DTER IN WSS-VARI.
      *    MOVE REC-NUM-MTER IN REC-FLD TO WSS-NUM-MTER IN WSS-VARI.
      *    MOVE REC-NUM-STER IN REC-FLD TO WSS-NUM-STER IN WSS-VARI.
      *    MOVE REC-NUM-ATER IN REC-FLD TO WSS-NUM-ATER IN WSS-VARI.

           IF WSS-FEC-FINI IN WSS-VARI NOT > REC-FEC-FTER IN REC
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'REGREPREC   ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-VAL-DUPL.
       FIN-PRO-VAL-DUPL.
           EXIT.
      *PVG FIN 29-AGO-2013
*% END
*% END
