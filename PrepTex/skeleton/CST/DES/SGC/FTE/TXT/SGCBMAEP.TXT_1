*%! Codigo adicional para archivo
*% IF NOT PGM_PER
*% IF INI_PUT_ALL_AEP
      *<<<< INI_PUT_ALL_AEP
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF INI_PUT_AEP_AEP
      *<<<< INI_PUT_AEP_AEP
           IF PGM-STAT-AEP-NUL
               GO TO FIN-PUT-AEP-AEP.
           IF NOT PGM-STAT-AEP-OKS
               PERFORM CLR-AEP-AEP
               PERFORM CLR-FRM-AEP
               GO TO FIN-PUT-AEP-AEP.
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF INI_PUT_DBC_AEP
      *<<<< INI_PUT_DBC_AEP
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-AEP.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-AEP
               GO TO FIN-PUT-DBC-AEP.
      *>>>>
*% END
*% END
*% IF FIN_PUT_DBC_AEP
      *<<<< FIN_PUT_DBC_AEP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN AEP-FLD.
      *>>>>
*% END
*% IF FIN_PUT_AEP_AEP
      *<<<< FIN_PUT_AEP_AEP
       CAL-FRM-VAL-TING.
           ADD AEP-VAL-RLCL IN AEP-FLD
               AEP-VAL-RLCJ IN AEP-FLD
               AEP-VAL-OING IN AEP-FLD
               GIVING FRM-VAL-TING IN AEP-FLD.

       CAL-FRM-VAL-TEGR.
           ADD AEP-VAL-DMEN IN AEP-FLD
               AEP-VAL-ARRD IN AEP-FLD
               AEP-VAL-OEGR IN AEP-FLD
               GIVING FRM-VAL-TEGR IN AEP-FLD.

       CAL-FRM-VAL-TACT.
           ADD AEP-VAL-DPZO IN AEP-FLD
               AEP-VAL-ACBO IN AEP-FLD
               AEP-VAL-BIRA IN AEP-FLD
               AEP-VAL-VEHI IN AEP-FLD
               AEP-VAL-ASOC IN AEP-FLD
               AEP-VAL-OACT IN AEP-FLD
               GIVING FRM-VAL-TACT IN AEP-FLD.

       CAL-FRM-VAL-TPAS.
           ADD AEP-VAL-DBYC IN AEP-FLD
               AEP-VAL-DHIP IN AEP-FLD
               AEP-VAL-OPAS IN AEP-FLD
               GIVING FRM-VAL-TPAS IN AEP-FLD.

       CAL-FRM-VAL-PATR.
           SUBTRACT FRM-VAL-TPAS IN AEP-FLD
               FROM FRM-VAL-TACT IN AEP-FLD
               GIVING FRM-VAL-PATR IN AEP-FLD.

       CAL-FRM-VAL-IDIS.
           SUBTRACT FRM-VAL-TEGR IN AEP-FLD
               FROM FRM-VAL-TING IN AEP-FLD
               GIVING FRM-VAL-IDIS IN AEP-FLD.
      *>>>>
*% END
*% IF DBC_GLS_NOMC
      *<<<<
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF DBC_IND_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF NOT PGM_PER
*% IF DBC_GLS_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF DBC_NUM_ICLI
      *<<<<
      *>>>>
*% END
*% IF NOT PGM_PER
*% IF DBC_VRF_ICLI
      *<<<<
      *>>>>
*% END
*% END
*% IF INI_AEP_FEC_FAEP
      *<<<< INI_AEP_FEC_FAEP
           IF SCR-CCPP = 'ING'
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF AEP_FEC_FVRF
      *<<<< AEP_FEC_FVRF
           IF AEP-FEC-FVRF IN AEP-FLD > ZEROES 
      *JDL ini  18-OCT-1995 
      *         MOVE AEP-FEC-FAEP IN AEP-FLD TO FEC-FEC1
      *JDL fin  18-OCT-1995 
               MOVE AEP-FEC-FVRF IN AEP-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'FECFAEPFVRF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_AEP
      *<<<< VAL_CON_FLD_AEP
           ADD AEP-VAL-RLCL IN AEP-FLD
               AEP-VAL-RLCJ IN AEP-FLD
               AEP-VAL-OING IN AEP-FLD
               GIVING WSS-VAL-TING.
           IF FRM-VAL-TING IN AEP-FLD NOT = WSS-VAL-TING
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTINGERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DMEN IN AEP-FLD
               AEP-VAL-ARRD IN AEP-FLD
               AEP-VAL-OEGR IN AEP-FLD
               GIVING WSS-VAL-TEGR.
           IF FRM-VAL-TEGR IN AEP-FLD NOT = WSS-VAL-TEGR
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTEGRERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DPZO IN AEP-FLD
               AEP-VAL-ACBO IN AEP-FLD
               AEP-VAL-BIRA IN AEP-FLD
               AEP-VAL-VEHI IN AEP-FLD
               AEP-VAL-ASOC IN AEP-FLD
               AEP-VAL-OACT IN AEP-FLD
               GIVING WSS-VAL-TACT.
           IF FRM-VAL-TACT IN AEP-FLD NOT = WSS-VAL-TACT
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTACTERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
           ADD AEP-VAL-DBYC IN AEP-FLD
               AEP-VAL-DHIP IN AEP-FLD
               AEP-VAL-OPAS IN AEP-FLD
               GIVING WSS-VAL-TPAS.
           IF FRM-VAL-TPAS IN AEP-FLD NOT = WSS-VAL-TPAS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-AEP.
       CAL-FRM-VAL-IDIS.
           SUBTRACT FRM-VAL-TEGR IN AEP-FLD
               FROM FRM-VAL-TING IN AEP-FLD
               GIVING FRM-VAL-IDIS IN AEP-FLD.

       CAL-FRM-VAL-PATR.
           SUBTRACT FRM-VAL-TPAS IN AEP-FLD
               FROM FRM-VAL-TACT IN AEP-FLD
               GIVING FRM-VAL-PATR IN AEP-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_AEP
      *<<<< INI_VAL_CON_KEY_AEP
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-AEP.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_AEP
      *<<<< FIN_VAL_CON_KEY_AEP
           IF DBC-NUM-ICLI IN AEP-FLD = ZEROES AND
              DBC-GLS-NOMC IN AEP-FLD NOT > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-AEP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CLR-FRM-AEP SECTION.
       INI-CLR-FRM-AEP.
           MOVE ZEROES TO FRM-VAL-TING IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TEGR IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-IDIS IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-TACT IN AEP-FLD.
           MOVE ZEROES TO FRM-VAL-PATR IN AEP-FLD.
       FIN-CLR-FRM-AEP.
           EXIT.
      *>>>>
*% END
