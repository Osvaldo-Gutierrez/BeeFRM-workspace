*%! Codigo adicional para archivo
*% IF FIN_PUT_DBC_ATC
      *<<<< FIN_PUT_DBC_ATC                                             
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-NOMC IN ATC-FLD.                    
      *>>>>
*% END
*% IF INI_PUT_ATC_ATC 
      *<<<< INI_PUT_ATC_ATC                                             
           MOVE ATC-FEC-FAUD IN ATC TO FRM-NUM-FAUD IN ATC-FLD.         
      *>>>>
*% END
*% IF FIN_PUT_ATC_ATC 
      *<<<< FIN_PUT_ATC_ATC                                             
           MOVE ATC-IIC-IFOL IN ATC TO ATC-IIC-IFOL IN ATC-FLD.         
      *>>>>
*% END
*% IF DBC_GLS_ICLI 
      *<<<< DBC_GLS_ICLI                                                
           IF DBC-NUM-ICLI IN ATC-FLD > ZEROES                          
              MOVE DBC-NUM-ICLI IN ATC-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE DBC-IND-ICLI IN ATC-FLD TO DBC-IND-ICLI IN DBC       
              MOVE DBC-GLS-ICLI IN ATC-FLD TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                          
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC                                       
              IF NOT FIO-STAT-OKS                                       
                  MOVE 'SGC'        TO MSG-COD-SIST                     
                  MOVE 'CLI    NEX' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE SPACES       TO FRM-GLS-NOMC IN ATC-FLD          
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-DBC-GLS-ICLI                            
              ELSE                                                      
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
                  PERFORM CPT-BLKS                                      
                  MOVE CPT-STRN  TO FRM-GLS-NOMC IN ATC-FLD             
                  MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI              
                  MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.             
      *>>>>                                                             
*% END
*% IF FIN_RET_ATC_ATC
      *<<<< FIN_RET_ATC_ATC                                             
           MOVE FRM-NUM-FAUD IN ATC-FLD TO ATC-FEC-FAUD IN ATC.         
      *>>>>
*% END
*% IF VAL_CON_FLD_ATC
      *<<<< VAL_CON_FLD_ATC                                         
           IF SCR-CCPP NOT = 'ING' AND                                  
              SCR-CCPP NOT = 'MOD' AND                                  
              SCR-CCPP NOT = 'MRA'                                      
              GO TO FIN-VAL-CON-FLD-ATC.                                
                                                                        
           IF FRM-NUM-FAUD IN ATC-FLD > ZEROES                          
              PERFORM GET-FHOY                                          
              MOVE HOY-SHOY TO WSS-FSA-SAUD IN WSS-VARI                 
              MOVE HOY-AHOY TO WSS-FSA-AAUD IN WSS-VARI                 
              IF FRM-NUM-FAUD IN ATC-FLD > WSS-FSA-FAUD IN WSS-VARI     
                 MOVE -1   TO FRM-NUM-FAUD-LEN IN ATC-FLD               
                 GO TO ER3-VAL-CON-FLD-ATC.                             
                                                                        
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(1) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(1) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(1)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(1) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(1)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(2) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(2) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(2)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(2) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(2)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(3) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(3) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(3)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(3) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(3)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(4) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(4) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(4)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(4) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(4)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(5) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(5) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(5)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(5) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(5)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
           IF ATC-NUM-MESP IN ATC-FLD(6) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(6) > 12                        
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(6)            
                 GO TO ER4-VAL-CON-FLD-ATC                              
              ELSE                                                      
                 IF ATC-VAL-MNTP IN ATC-FLD(6) > ZEROES                 
                    ADD 1 TO WSS-CNT-MESP                               
                 ELSE                                                   
                    MOVE -1   TO ATC-VAL-MNTP-LEN IN ATC-FLD(6)         
                    GO TO ER1-VAL-CON-FLD-ATC.                          
                                                                        
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(1) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(1) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(1) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(1)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(2) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(2) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(2) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(2)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(3) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(3) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(3) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(3)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(4) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(4) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(4) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(4)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(5) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(5) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(5) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(5)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           IF ATC-VAL-MNTP IN ATC-FLD(6) > ZEROES                       
              IF ATC-NUM-MESP IN ATC-FLD(6) > ZEROES                    
                 ADD ATC-VAL-MNTP IN ATC-FLD(6) TO WSS-SUM-MNTP         
              ELSE                                                      
                 MOVE -1   TO ATC-NUM-MESP-LEN IN ATC-FLD(6)            
                 GO TO ER2-VAL-CON-FLD-ATC.                             
                                                                        
           PERFORM FND-VAL-CON-FLD-ATC                                  
                       VARYING WSS-INDX FROM 2 BY 1 UNTIL WSS-INDX > 6. 
                                                                        
           IF FRM-UCUR = '1'                                            
              GO TO FIN-VAL-CON-FLD-ATC.                                
                                                                        
           IF WSS-CNT-MESP > ZEROES AND WSS-SUM-MNTP > ZEROES           
              COMPUTE WSS-NUM-PROM = WSS-SUM-MNTP / WSS-CNT-MESP        
              MOVE WSS-NUM-PROM IN WSS-VARI                             
                                         TO ATC-VAL-MPPM IN ATC-FLD.    
                                                                        
           GO TO FIN-VAL-CON-FLD-ATC.                                   
                                                                        
                                                                        
       FND-VAL-CON-FLD-ATC.                                             
           IF ATC-NUM-MESP IN ATC-FLD(WSS-INDX)     = 1  AND            
              ATC-NUM-MESP IN ATC-FLD(WSS-INDX - 1) = 12                
              NEXT SENTENCE                                             
           ELSE                                                         
            IF ATC-NUM-MESP IN ATC-FLD(WSS-INDX) > ZEROS                
               IF (     ATC-NUM-MESP IN ATC-FLD(WSS-INDX)               
                  NOT > ATC-NUM-MESP IN ATC-FLD(WSS-INDX - 1))          
                  MOVE -1 TO ATC-NUM-MESP-LEN IN ATC-FLD(WSS-INDX)      
                  MOVE 'SGC'          TO MSG-COD-SIST                   
                  MOVE 'MESDE<A>    ' TO MSG-COD-MENS                   
                  PERFORM GET-MSG                                       
                  MOVE MSG-GLS-DESC   TO FRM-MENS                       
                  MOVE FRM-SUAR-MAL   TO FRM-SUAR                       
                  MOVE '1'            TO FRM-UCUR                       
               ELSE                                                     
                 IF (ATC-NUM-MESP IN ATC-FLD(WSS-INDX - 1) = ZEROS OR   
                     ATC-NUM-MESP IN ATC-FLD(WSS-INDX - 1) = SPACES)    
                     MOVE -1                                            
                        TO ATC-NUM-MESP-LEN IN ATC-FLD(WSS-INDX - 1)    
                     MOVE 'SGC'          TO MSG-COD-SIST                
                     MOVE 'MESNOESP    ' TO MSG-COD-MENS                
                     PERFORM GET-MSG                                    
                     MOVE MSG-GLS-DESC   TO FRM-MENS                    
                     MOVE FRM-SUAR-MAL   TO FRM-SUAR                    
                     MOVE '1'            TO FRM-UCUR.                   
                                                                        
                                                                        
       ER1-VAL-CON-FLD-ATC.                                             
           MOVE 'SGC'          TO MSG-COD-SIST                          
           MOVE 'MONTOOBL    ' TO MSG-COD-MENS                          
           PERFORM GET-MSG                                              
           MOVE MSG-GLS-DESC   TO FRM-MENS                              
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.                             
           MOVE '1'            TO FRM-UCUR.                             
           GO TO FIN-VAL-CON-FLD-ATC.                                   
                                                                        
       ER2-VAL-CON-FLD-ATC.                                             
           MOVE 'SGC'          TO MSG-COD-SIST                          
           MOVE 'MESOBL      ' TO MSG-COD-MENS                          
           PERFORM GET-MSG                                              
           MOVE MSG-GLS-DESC   TO FRM-MENS                              
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.                             
           MOVE '1'            TO FRM-UCUR.                             
           GO TO FIN-VAL-CON-FLD-ATC.                                   
                                                                        
       ER3-VAL-CON-FLD-ATC.                                             
           MOVE 'SGC'          TO MSG-COD-SIST                          
           MOVE 'FEC    >HOY'  TO MSG-COD-MENS                          
           PERFORM GET-MSG                                              
           MOVE MSG-GLS-DESC TO FRM-MENS                                
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
           MOVE '1'          TO FRM-UCUR.                               
           GO TO FIN-VAL-CON-FLD-ATC.                                   
                                                                        
                                                                        
       ER4-VAL-CON-FLD-ATC.                                             
           MOVE 'GNS'          TO MSG-COD-SIST                          
           MOVE 'FECSTAT93   ' TO MSG-COD-MENS                          
           PERFORM GET-MSG                                              
           MOVE MSG-GLS-DESC TO FRM-MENS                                
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
           MOVE '1'          TO FRM-UCUR.                               
           GO TO FIN-VAL-CON-FLD-ATC.                                   
      *>>>>                                                             
*% END
