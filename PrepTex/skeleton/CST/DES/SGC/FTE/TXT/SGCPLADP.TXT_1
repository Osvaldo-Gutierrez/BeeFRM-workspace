*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
       COPY SGCBREDS.
       COPY SGCBRDBC.
       COPY SGCBREDP.
       COPY SGCBRREC.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSWGCPT.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       01  WSS-VARI.
           03  WSS-IND-VIGE                   PIC X(01).
           03  WSS-COD-OFIC                   PIC X(03).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP               PIC 9(02).
               05  WSS-NUM-ACMP               PIC 9(02).
               05  WSS-NUM-MCMP               PIC 9(02).
               05  WSS-NUM-DCMP               PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI               PIC 9(02).
               05  WSS-NUM-MINI               PIC 9(02).
               05  WSS-NUM-SINI               PIC 9(02).
               05  WSS-NUM-AINI               PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER               PIC 9(02).
               05  WSS-NUM-MTER               PIC 9(02).
               05  WSS-NUM-STER               PIC 9(02).
               05  WSS-NUM-ATER               PIC 9(02).
           03  WSS-CIC-ICLI                   PIC X(12).
           03  WSS-IDC-ICLI                   PIC X(12).
           03  WSS-NUM-IEDP                   PIC 9(02).
           03  WSS-COD-IPOD.
               05  WSS-NUM-IPOD               PIC 9(03).
           03  WSS-IVEZ               VALUE 0 PIC 9(01).
               88 WSS-PRIMERA-VEZ     VALUE 0.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EDS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EDP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
      *>>>>
*% END
*% IF CF_ADP_ADP_NUM_IEDP
      *<<<< CF_ADP_ADP_NUM_IEDP
           MOVE 66 TO LINE-COUNTER.
      *>>>>
*% END
*% IF CH_ADP_ADP_COD_IPOD
      *<<<< CH_ADP_ADP_COD_IPOD
      *BUS-TAB busca glosa de codigo en tabla
           IF ADP-COD-IPOD IN SRT > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'FAC' TO TAB-COD-TTAB IN TAB
               MOVE ADP-COD-IPOD IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-IPOD IN WSS-ADP
               ELSE
                   MOVE SPACES TO WSS-GLS-IPOD IN WSS-ADP
           ELSE
               MOVE SPACES TO WSS-GLS-IPOD IN WSS-ADP.
      *>>>>
*% END
*% IF CH_ADP_ADP_NUM_IGRP
      *<<<< CH_ADP_ADP_NUM_IGRP
      *>>>>
*% END
*% IF CF_ADP_ADP_NUM_IGRP
      *<<<< CF_ADP_ADP_NUM_IGRP
      *    MOVE 66 TO LINE-COUNTER
      *>>>>
*% END
*% IF CF_ADP_ADP_NUM_IMDT
      *<<<< CF_ADP_ADP_NUM_IMDT
           MOVE 66 TO LINE-COUNTER.
      *>>>>
*% END
*% IF PH_ADP
      *<<<< PH_ADP
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'Inicio de Captura de Parametros'.
           ACCEPT WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY 'IDC CLIENTE : '.
           DISPLAY WSS-IDC-ICLI IN WSS-VARI.
           ACCEPT WSS-COD-IPOD IN WSS-VARI.
           DISPLAY 'FACULTAD O GRUPO FACULTAD'.
           DISPLAY WSS-COD-IPOD IN WSS-VARI.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
      *Captura Vigencia
           DISPLAY 'VIGENCIA S/N/*: '.
           ACCEPT  WSS-IND-VIGE IN WSS-VARI.
           DISPLAY WSS-IND-VIGE IN WSS-VARI.
           DISPLAY 'Fin captura de parametros'.
      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
           DISPLAY 'Fin de Validacion de Parametros'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           IF WSS-IDC-ICLI IN WSS-VARI NOT > SPACES OR
              WSS-IDC-ICLI IN WSS-VARI = '*'
               GO TO CON-INI-FST-INP.
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL  TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN DBC TO ADP-CIC-IMDT IN ADP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-ADP.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = ADP-CIC-IMDT IN ADP
               GO TO SEL-REG.
           MOVE 'SGC' TO MSG-COD-SIST.
           MOVE 'ADP    NEX' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           DISPLAY MSG-GLS-DESC IN MSG.
           MOVE PGM-SMAL  TO PGM-STAT-SRT.
           GO TO FIN-INP-SRT.
       CON-INI-FST-INP.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           MOVE ADP-CIC-IMDT IN ADP TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               DISPLAY ' CIC : ' ADP-CIC-IMDT IN ADP
               GO TO NXT-INP-SRT.
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI IN WSS-VARI.
       SEL-REG.
           IF WSS-IDC-ICLI IN WSS-VARI NOT = '*' AND
              WSS-IDC-ICLI IN WSS-VARI > SPACES  
               IF WSS-IDC-ICLI IN WSS-VARI NOT = DBC-IDC-ICLI IN DBC
                   GO TO NXT-INP-SRT.
           IF WSS-COD-IPOD IN WSS-VARI NOT = '*' AND
              WSS-COD-IPOD IN WSS-VARI > SPACES 
               IF WSS-COD-IPOD IN WSS-VARI NOT = ADP-COD-IPOD IN ADP
                   GO TO NXT-INP-SRT.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           MOVE ADP-CIC-IMDT IN ADP TO EDP-CIC-IMDT IN EDP.
           MOVE 'F'                 TO EDP-IND-TINF IN EDP.
           MOVE ADP-NUM-IEDP IN ADP TO EDP-NUM-IEDP IN EDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF NOT FIO-STAT-OKS
               MOVE ADP-CIC-IMDT IN ADP TO EDP-CIC-IMDT IN EDP
               MOVE 'P'                 TO EDP-IND-TINF IN EDP
               MOVE ADP-NUM-IEDP IN ADP TO EDP-NUM-IEDP IN EDP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-EDP
               IF NOT FIO-STAT-OKS
      *GET-MSG Busca mensaje en tabla
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'ADP    NOEDP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   DISPLAY MSG-GLS-DESC IN MSG
                   DISPLAY ' IDC : ' DBC-IDC-ICLI IN DBC
                   DISPLAY ' NOM : ' DBC-GLS-NOMC IN DBC
                   DISPLAY ' EDP : ' ADP-NUM-IEDP IN ADP
                   GO TO NXT-INP-SRT
               ELSE
                   MOVE EDP-CIC-IMDT IN EDP TO EDS-CIC-ICLI IN EDS
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM SGC-FIO-EDS
                   IF NOT FIO-STAT-OKS
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'EDP    NOEDS' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC IN MSG
                       DISPLAY ' IDC : ' DBC-IDC-ICLI IN DBC
                       DISPLAY ' NOM : ' DBC-GLS-NOMC IN DBC
                       DISPLAY ' EDP : ' ADP-NUM-IEDP IN ADP
                       GO TO NXT-INP-SRT.

           IF WSS-FEC-FINI IN WSS-VARI  > SPACES AND
              WSS-FEC-FINI IN WSS-VARI  NOT = '*'
               MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DCMP IN WSS-VARI
               MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MCMP IN WSS-VARI
               MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SCMP IN WSS-VARI
               MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-ACMP IN WSS-VARI
               IF EDP-FEC-FINF IN EDP < WSS-FEC-FCMP IN WSS-VARI
                   GO TO NXT-INP-SRT.
           IF WSS-FEC-FTER IN WSS-VARI     > SPACES AND
              WSS-FEC-FTER IN WSS-VARI  NOT = '*'
               MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DCMP IN WSS-VARI
               MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MCMP IN WSS-VARI
               MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SCMP IN WSS-VARI
               MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ACMP IN WSS-VARI
               IF EDP-FEC-FINF IN EDP > WSS-FEC-FCMP IN WSS-VARI
                   GO TO NXT-INP-SRT.
           IF WSS-COD-OFIC IN WSS-VARI     > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF EDP-IND-TINF IN EDP = 'P'                 
                  IF WSS-COD-OFIC IN WSS-VARI NOT = EDS-COD-OFII IN EDS
                      GO TO NXT-INP-SRT
                  ELSE
                      NEXT SENTENCE
               ELSE
               IF WSS-COD-OFIC IN WSS-VARI NOT = EDP-COD-OFII IN EDP
                   GO TO NXT-INP-SRT.
           IF ( WSS-IND-VIGE IN WSS-VARI = 'S' AND
              EDP-MSC-STAT IN EDP NOT = 'A' ) OR
              ( WSS-IND-VIGE IN WSS-VARI = 'N' AND
              EDP-MSC-STAT IN EDP = 'A' )
               GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF WSS-IDC-ICLI IN WSS-VARI NOT = '*' AND
              WSS-IDC-ICLI IN WSS-VARI > SPACES
               IF WSS-CIC-ICLI IN WSS-VARI NOT = ADP-CIC-IMDT IN ADP
                   GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *BUS-TAB busca glosa de codigo en tabla
           IF ADP-IND-CONE IN SRT > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'CNX' TO TAB-COD-TTAB IN TAB
               MOVE ADP-IND-CONE IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CONE IN WSS-ADP
           ELSE
               MOVE SPACES TO WSS-GLS-CONE IN WSS-ADP.
           IF ADP-CIC-IAPO IN SRT > SPACES
               MOVE ADP-CIC-IAPO IN SRT TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC' TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   STRING MSG-GLS-DESC ' CIC : ' ADP-CIC-IMDT IN SRT
                          DELIMITED BY SIZE INTO WSS-GLS-NOMA IN WSS-ADP
                   GENERATE DL-ADP
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO WSS-GLS-NOMA IN WSS-ADP
                   MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-IAPO IN WSS-ADP
                   MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-IAPO IN WSS-ADP
                   MOVE DBC-IND-ICLI IN DBC TO WSS-IND-IAPO IN WSS-ADP
                   MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-IAPO IN WSS-ADP
                   GENERATE DL-ADP
           ELSE
               GENERATE DL-CLA
               PERFORM BUS-REC.
           GO TO FIN-GEN-OUT.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
       FIN-GEN-OUT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-REC SECTION.
       INI-BUS-REC.
           MOVE SPACES TO REC-KEY-IREC IN REC.
           MOVE ADP-CIC-IMDT IN SRT TO REC-CIC-ICLI IN REC.
           MOVE REC-COD-OPOD IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-REC.
           PERFORM SGC-FIO-REC.
           IF NOT ( FIO-STAT-OKS AND
              ADP-CIC-IMDT IN SRT = REC-CIC-ICLI IN REC AND
              REC-COD-OPOD IN REC-VARI = REC-COD-TREC IN REC)
               GO TO FIN-BUS-REC.
           IF NOT (REC-NUM-TREC IN REC = ADP-NUM-IEDP IN SRT AND
              REC-COD-AREC IN REC = ADP-COD-CLAP IN SRT )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-REC.
           MOVE REC-CIC-IREL IN REC TO DBC-CIC-ICLI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-REC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-NOMC IN WSS-ADP.
           MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLA IN WSS-ADP.
           MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLA IN WSS-ADP.
           MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLA IN WSS-ADP.
           MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLA IN WSS-ADP.
           GENERATE DL-REC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-REC.
       FIN-BUS-REC.
           EXIT.

       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBGCPT.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBFMSG.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY SGCBFEDS.
       COPY SGCBFEDP.
       COPY SGCBFREC.
      *>>>>
*% END
