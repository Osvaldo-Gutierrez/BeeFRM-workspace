*%       MANEJO FORMULARIO MVT   ( MULTIPLES PANTALLAS )
*% IF FIN_PUT_ALL_MVT
      *<<<< IF FIN_PUT_ALL_MVT

           MOVE MOV-NUM-CCTB IN MVT-FLD TO CTB-NUM-CCTB IN CTB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-CTB.
           IF NOT FIO-STAT-OKS
               MOVE 'CTB    NEX' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-GLS-CCTB IN MVT-FLD
           ELSE
               MOVE CTB-GLS-CCTB IN CTB TO FRM-GLS-CCTB IN MVT-FLD.

           MOVE CTB-IND-OBDC IN CTB TO FRM-IND-OBDC IN MVT-FLD.

           MOVE MOV-NUM-CCDC IN MVT-FLD TO CDC-NUM-CCDC IN CDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
           IF FIO-STAT-OKS
               MOVE CDC-GLS-CCDC IN CDC TO FRM-GLS-CCDC IN MVT-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'CDC    NEX' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-GLS-CCDC IN MVT-FLD.
      *>>>> END
*% END
*% IF FIN_RET_ALL_MVT
      *<<<< IF FIN_RET_ALL_MVT
           IF SCR-CCPP = 'ING'
               MOVE SPACES TO MOV-COD-MONE IN MOV
               MOVE ZEROES TO MOV-NUM-CUNA IN MOV.
      *>>>> END
*% END
*% IF INI_KEY_MOV_MVT
      *<<<< IF INI_KEY_MOV_MVT
           MOVE CPB-NUM-DMOV IN CPB TO MOV-NUM-DMOV IN MOV.
           MOVE CPB-NUM-MMOV IN CPB TO MOV-NUM-MMOV IN MOV.
           MOVE CPB-NUM-SMOV IN CPB TO MOV-NUM-SMOV IN MOV.
           MOVE CPB-NUM-AMOV IN CPB TO MOV-NUM-AMOV IN MOV.
           MOVE CPB-NUM-COMP IN CPB TO MOV-NUM-COMP IN MOV.
      *>>>> END
*% END
*% IF FIN_CLR_KEY_MVT
      *<<<< IF FIN_CLR_KEY_MVT
           IF SCR-CCPP = 'ING'
               MOVE CPB-NUM-DMOV IN CPB TO MOV-NUM-DMOV IN MVT-FLD
               MOVE CPB-NUM-MMOV IN CPB TO MOV-NUM-MMOV IN MVT-FLD
               MOVE CPB-NUM-SMOV IN CPB TO MOV-NUM-SMOV IN MVT-FLD
               MOVE CPB-NUM-AMOV IN CPB TO MOV-NUM-AMOV IN MVT-FLD
               MOVE CPB-NUM-COMP IN CPB TO MOV-NUM-COMP IN MVT-FLD.
      *>>>> END
*% END
*% IF MOV_COD_TMOV
      *<<<< IF MOV_COD_TMOV
           MOVE 'CTB' TO TAB-COD-SIST.
           MOVE 'TMO' TO TAB-COD-TTAB IN TAB.
           MOVE MOV-COD-TMOV IN MVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-TMOV IN MVT-FLD
           ELSE
               MOVE TAB-GLS-DESC TO FRM-GLS-TMOV IN MVT-FLD.
      *>>>> END
*% END
*% IF INI_MOV_VRF_CCTB
      *<<<< IF INI_MOV_VRF_CCTB
           MOVE VRF-SVRF-0 TO VRF-SVRF.
      *>>>> END
*% END
*% IF INI_MOV_VRF_CCDC
      *<<<< IF INI_MOV_VRF_CCDC
           MOVE VRF-SVRF-0 TO VRF-SVRF.
      *>>>> END
*% END
*% IF MOV_VRF_CCTB
      *<<<< IF MOV_VRF_CCTB
           IF NOT VRF-STAT-OKS
               GO TO FIN-VAL-MOV-VRF-CCTB.
           MOVE MOV-NUM-CCTB IN MVT-FLD TO CTB-NUM-CCTB IN CTB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-CTB.
           IF FIO-STAT-OKS
               MOVE CTB-GLS-CCTB IN CTB TO FRM-GLS-CCTB IN MVT-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-CCTB IN MVT-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'CTB    NEX' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-VAL-MOV-VRF-CCTB.
           IF CTB-COD-PART IN CTB = '000' OR
              CTB-COD-CMAY IN CTB = '00'  OR
              CTB-COD-SCTA IN CTB = '000'
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'CTB    SUB' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-VAL-MOV-VRF-CCTB.
           MOVE CTB-IND-OBDC IN CTB TO FRM-IND-OBDC IN MVT-FLD.
           IF FRM-IND-OBDC IN MVT-FLD = 'N'
               GO TO FIN-VAL-MOV-VRF-CCTB.
           MOVE MOV-NUM-CCTB IN MVT-FLD TO MDC-NUM-CCTB IN MDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-MDC.
           IF NOT FIO-STAT-OKS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'MDC    NEX' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-VAL-MOV-VRF-CCTB.
      *>>>> END
*% END
*% IF MOV_VRF_CCDC
      *<<<< IF MOV_VRF_CCDC
           IF NOT VRF-STAT-OKS
               GO TO FIN-VAL-MOV-VRF-CCDC.
           IF CTB-IND-OBCC IN CTB = 'N' AND
              MOV-NUM-CCDC IN MVT-FLD NOT > ZEROES
                MOVE SPACES TO FRM-GLS-CCDC IN MVT-FLD
                GO TO FIN-VAL-MOV-VRF-CCDC.
           IF CTB-IND-OBCC IN CTB = 'S' AND
              MOV-NUM-CCDC IN MVT-FLD NOT > ZEROES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'CDC    OBL' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SPACES TO FRM-GLS-CCDC IN MVT-FLD
               GO TO FIN-VAL-MOV-VRF-CCDC.
           MOVE MOV-NUM-CCDC IN MVT-FLD TO CDC-NUM-CCDC IN CDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
           IF FIO-STAT-OKS
               MOVE CDC-GLS-CCDC IN CDC TO FRM-GLS-CCDC IN MVT-FLD
           ELSE
               MOVE SPACES              TO FRM-GLS-CCDC IN MVT-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'CDC    NEX' TO MSG-COD-MENS IN MSG
               MOVE 'CTB'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>> END
*% END
*% IF MOV_NUM_REFE
      *<<<< IF MOV_NUM_REFE
           IF CTB-IND-CTAA IN CTB = 'N' AND
              MOV-NUM-REFE IN MVT-FLD NOT > ZEROES
                GO TO FIN-VAL-MOV-NUM-REFE
           ELSE
           IF CTB-IND-CTAA IN CTB = 'N' AND
              MOV-NUM-REFE IN MVT-FLD > ZEROES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'REF    BLK' TO MSG-COD-MENS IN MSG
                MOVE 'CTB'        TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-VAL-MOV-NUM-REFE.
           IF CTB-IND-CTAA IN CTB = 'S' AND
              MOV-NUM-REFE IN MVT-FLD NOT > ZEROES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'REF    OBL' TO MSG-COD-MENS IN MSG
                MOVE 'CTB'        TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-VAL-MOV-NUM-REFE.
      *>>>> END
*% END
*% IF MOV_COD_FINA
      *<<<< IF MOV_COD_FINA
           IF CTB-IND-OBCF IN CTB = 'N' AND
              MOV-COD-FINA IN MVT-FLD NOT > ZEROES
                GO TO FIN-VAL-MOV-COD-FINA
           ELSE
           IF CTB-IND-OBCF IN CTB = 'N' AND
              MOV-COD-FINA IN MVT-FLD > ZEROES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'FIN    BLK' TO MSG-COD-MENS IN MSG
                MOVE 'CTB'        TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-VAL-MOV-COD-FINA.
           IF CTB-IND-OBCF IN CTB = 'S' AND
              MOV-COD-FINA IN MVT-FLD NOT > ZEROES
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'FIN    OBL' TO MSG-COD-MENS IN MSG
                MOVE 'CTB'        TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-VAL-MOV-COD-FINA.
           MOVE 'CTB' TO TAB-COD-SIST.
           MOVE 'FIN' TO TAB-COD-TTAB IN TAB.
           MOVE MOV-COD-FINA IN MVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> END
*% END
*% IF MOV_IND_TRAT
      *<<<< IF MOV_IND_TRAT
           MOVE 'CTB' TO TAB-COD-SIST.
           MOVE 'TRA' TO TAB-COD-TTAB IN TAB.
           MOVE MOV-IND-TRAT IN MVT-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> END
*% END
*% IF MOV_FEC_FFAC
      *<<<< IF MOV_FEC_FFAC
           IF CPB-IND-TCOM IN CPB = 'F' AND
              MOV-FEC-FFAC IN MVT-FLD NOT > ZEROES
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE 'FFAC   OBL' TO MSG-COD-MENS IN MSG
                 MOVE 'CTB'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO FIN-VAL-MOV-FEC-FFAC.
           MOVE MOV-FEC-FFAC IN MVT-FLD TO FEC-FEC1
           MOVE CPB-FEC-FCPB IN CPB TO FEC-FEC2
           MOVE FEC-FORM-FEC TO FEC-FORM
           MOVE FEC-CMP-FEC  TO FEC-CMND 
           PERFORM PRO-FEC
           IF FEC-STAT-GRT
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'FFAC   FMOV' TO MSG-COD-MENS IN MSG
                MOVE 'CTB'        TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>> END
*% END
*% IF MOV_NUM_FACT
      *<<<< IF MOV_NUM_FACT
           IF CPB-IND-TCOM IN CPB = 'F' AND
              MOV-NUM-FACT IN MVT-FLD NOT > ZEROES
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE 'NFAC   OBL' TO MSG-COD-MENS IN MSG
                 MOVE 'CTB'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>> END
*% END
*% IF INI_MOV_FEC_FING
      *<<<< IF INI_MOV_FEC_FING
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>> END
*% END
*% IF MOV_FEC_FING
      *<<<< IF MOV_FEC_FING
           IF MOV-FEC-FING IN MVT-FLD NOT > ZEROES
               PERFORM GET-FHOY
               MOVE HOY-SHOY TO MOV-NUM-SING IN MVT-FLD
               MOVE HOY-AHOY TO MOV-NUM-AING IN MVT-FLD
               MOVE HOY-MHOY TO MOV-NUM-MING IN MVT-FLD
               MOVE HOY-DHOY TO MOV-NUM-DING IN MVT-FLD
               GO TO FIN-VAL-MOV-FEC-FING.

           MOVE MOV-FEC-FING IN MVT-FLD TO FEC-FEC1
                 MOVE CPB-FEC-FCPB IN CPB TO FEC-FEC2
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-CMP-FEC  TO FEC-CMND 
                 PERFORM PRO-FEC
                 IF FEC-STAT-LES
                      MOVE FRM-SUAR-MAL TO FRM-SUAR
                      MOVE 'FECINLEQMO' TO MSG-COD-MENS IN MSG
                      MOVE 'CTB'        TO MSG-COD-SIST
                      PERFORM GET-MSG
                      MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>> END
*% END
*% IF VAL_CON_FLD_MVT
      *<<<< IF VAL_CON_FLD_MVT
           IF MOV-NUM-CCDC IN MVT-FLD NOT > ZEROES
               GO TO NOT-CVG.
           MOVE MOV-NUM-CCTB IN MVT-FLD TO CVG-NUM-CCTB IN CVG.
           MOVE MOV-NUM-CCDC IN MVT-FLD TO CVG-NUM-CCDC IN CVG.
           MOVE ZEROES TO CVG-NUM-PERI IN CVG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM CTB-FIO-CVG.

           IF NOT FIO-STAT-OKS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'CTB'        TO MSG-COD-SIST
                   MOVE 'CVG    NEX' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-MVT.

       CIC-CVG.
           IF NOT ( MOV-NUM-CCTB IN MVT-FLD = CVG-NUM-CCTB IN CVG AND
                    MOV-NUM-CCDC IN MVT-FLD = CVG-NUM-CCDC IN CVG )
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM CTB-FIO-CVG
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 'CTB'        TO MSG-COD-SIST
                   MOVE 'CVG    NEX' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-MVT.

           MOVE CPB-FEC-FCPB IN CPB TO FEC-FEC1.
           MOVE CVG-NUM-DTER IN CVG TO FEC-DEC2.
           MOVE CVG-NUM-MTER IN CVG TO FEC-MEC2.
           MOVE CVG-NUM-STER IN CVG TO FEC-SEC2.
           MOVE CVG-NUM-ATER IN CVG TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM CTB-FIO-CVG
               GO TO CIC-CVG.

           IF CVG-IND-VIGE IN CVG = 'N'
                MOVE FIO-END-BRW TO FIO-CMND
                PERFORM CTB-FIO-CVG
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'CTB'        TO MSG-COD-SIST
                MOVE 'CVG    NVG' TO MSG-COD-MENS IN MSG
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-VAL-CON-FLD-MVT.
        
       NOT-CVG.
      *>>>> END
*% END
