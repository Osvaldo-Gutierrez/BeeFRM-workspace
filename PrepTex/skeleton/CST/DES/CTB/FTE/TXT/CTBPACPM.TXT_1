*%       CODIGO ADICIONAL PARA PROGRAMA CTBPACPM.
*% IF WSS
      *<<<< IF WSS
       COPY CTBBRCPB.
       COPY CTBBRMDC.
      *>>>> END
*% END
*% IF INI_FIO_VAX
      *<<<< INI_FIO_VAX

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM CTB-FIO-MDC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM CTB-FIO-MDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR DE APERTURA ARCHIVO CTBMDC: ABORTO'
               STOP RUN.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM CTB-FIO-CPB.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM CTB-FIO-CPB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR DE APERTURA ARCHIVO CTBCPB: ABORTO'
               STOP RUN.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'CTB'        TO FIO-SIST.
           PERFORM GNS-FIO-MSG.
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'CTB'   TO FIO-SIST.
           PERFORM GNS-FIO-MSG.
           PERFORM GET-TMP.
      *>>>> END
*% END
*% IF INI_SCR_ING
      *<<<< IF INI_SCR_ING
           PERFORM SCR-RST.
           MOVE SCR-INST-GFL TO SCR-INST.
           GO TO TRL-SCR-ING.
      *>>>> END
*% END
*% IF FIN_CMN_ING
      *<<<< IF FIN_CMN_ING
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CTB-FIO-CPB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING
           ELSE
               MOVE MOV-NUM-MVTO IN MOV TO CPB-NUM-UMOV IN CPB
               MOVE 'D' TO CPB-IND-ESTA IN CPB
               MOVE FIO-MOD TO FIO-CMND
               PERFORM CTB-FIO-CPB.
           ADD 1 TO MOV-NUM-MVTO IN MOV.
           IF MOV-NUM-MVTO IN MOV NOT > CPB-NUM-TMOV IN CPB
               MOVE 'CTBACTMVT   ' TO SCR-FRET
           ELSE
               MOVE 'CTBACTMOV   ' TO SCR-FRET.
      *>>>> END
*% END
*% IF FIN_CMN_MOD
      *<<<< IF FIN_CMN_MOD
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM CTB-FIO-CPB.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD
           ELSE
               MOVE 'D' TO CPB-IND-ESTA IN CPB
               MOVE FIO-MOD TO FIO-CMND
               PERFORM CTB-FIO-CPB.
      *>>>> END
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           MOVE MOV-NUM-CCTB IN MOV TO MDC-NUM-CCTB IN MDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-MDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.

           IF MDC-IND-RUTR IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-NUM-RUTR-ATR IN CPM-FLD
               MOVE FRM-CPIM-AEY TO MOV-VRF-RUTR-ATR IN CPM-FLD
               MOVE +9 TO MOV-NUM-RUTR-LEN IN CPM-FLD.

           IF MDC-IND-FOPE IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-FEC-FOPE-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-FEC-FOPE-LEN IN CPM-FLD.

           IF MDC-IND-TOPE IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-COD-TOPE-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-COD-TOPE-LEN IN CPM-FLD.


           IF MDC-IND-MOTI IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-COD-MOTI-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-COD-MOTI-LEN IN CPM-FLD.


           IF MDC-IND-BANC IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-COD-BANC-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-COD-BANC-LEN IN CPM-FLD.


           IF MDC-IND-FEMI IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-FEC-FEMI-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-FEC-FEMI-LEN IN CPM-FLD.


           IF MDC-IND-FVCT IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-FEC-FVCT-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-FEC-FVCT-LEN IN CPM-FLD.


           IF MDC-IND-RDOC IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-NUM-DOCI-ATR IN CPM-FLD
               MOVE FRM-CPIM-AEY TO MOV-NUM-DOCF-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-NUM-DOCI-LEN IN CPM-FLD
               MOVE -1 TO MOV-NUM-DOCF-LEN IN CPM-FLD.


           IF MDC-IND-AUTZ IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-COD-AUTZ-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-COD-AUTZ-LEN IN CPM-FLD.


           IF MDC-IND-MDOC IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-VAL-DOCT-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-VAL-DOCT-LEN IN CPM-FLD.

    
           IF MDC-IND-AMOR IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-NUM-AMOR-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-NUM-AMOR-LEN IN CPM-FLD.


           IF MDC-IND-TINT IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-VAL-TINT-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-VAL-TINT-LEN IN CPM-FLD.


           IF MDC-IND-PGEN IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-MSA-PPGN-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-MSA-PPGN-LEN IN CPM-FLD.


           IF MDC-IND-CGEN IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-COD-GENE-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-COD-GENE-LEN IN CPM-FLD.


           IF MDC-IND-FGEN IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-FEC-FFGN-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-FEC-FFGN-LEN IN CPM-FLD.

           IF MDC-IND-MGN1 IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-VAL-MTO1-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-VAL-MTO1-LEN IN CPM-FLD.

           IF MDC-IND-MGN2 IN MDC = 'N'
               MOVE FRM-CPIM-AEY TO MOV-VAL-MTO2-ATR IN CPM-FLD
           ELSE
               MOVE -1 TO MOV-VAL-MTO2-LEN IN CPM-FLD.

      *>>>> END
*% END
*% IF EOF
      *<<<< IF EOF
       GET-OPID SECTION.
       INI-GET-OPID.
       FIN-GET-OPID.
           EXIT.

       GET-TMP SECTION.
       INI-GET-TMP.
           CALL 'LIB$GET_SYMBOL' USING BY DESCRIPTOR
                               'CTB$CPB' CPB.
           CALL 'LIB$GET_SYMBOL' USING BY DESCRIPTOR
                               'CTB$MOV' MOV.
       FIN-GET-TMP.
           EXIT.


       EGR-LOOP-BCK SECTION.
       INI-EGR-LOOP-BCK.
       FIN-EGR-LOOP-BCK.
           EXIT.

       MVT-INH-PF3 SECTION.
       INI-MVT-INH-PF3.
       FIN-MVT-INH-PF3.
           EXIT.

       COPY CTBBFCPB.
      *COPY CTBBFCTB.
      *COPY CTBBFCDC.
       COPY CTBBFMDC.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.

      *>>>> END
*% END
