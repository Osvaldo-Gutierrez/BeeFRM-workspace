      *  CODIGO ADICIONAL PARA PROGRAMA CTBPAMOV.
*% IF FIN_SCR_VARI
       COPY CTBWIMOV REPLACING ==01  MOV-FLD== BY ==03  MOV-FLD==.
       COPY CTBWICOM REPLACING ==01  COM-FLD== BY ==03  COM-FLD==.
       COPY CTBWGMOV.
*% END
*% IF WSS
       COPY CTBBRCDC.
       COPY CTBBRCTB.
       COPY CTBBRCPB.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRTAB.
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
       COPY CTBLGMOV.
*% END
*% IF INI_HBL_KEY OR INI_HBL_IKY
           MOVE LOW-VALUES TO COM-FLD.
*% END
*% IF INI_FIO
           MOVE 1 TO SCR-IPRO.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC
           ELSE
           IF SCR-INST-EXT = WSS-INST-FTER-CMN
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CMN
           ELSE
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FPEN-CIC.
*% END
*% IF INI_SCR_ING
*% END
*% IF INI_CMN_ING OR INI_CMN_MOD  OR INI_CMN_ELI OR INI_CMN_ACC OR INI_CMN_PGM 
           IF FRM-IND-OBDC IN MOV-FLD = 'S'
               PERFORM EGR-FPEN-FRW.
*% END
*% IF FIN_CMN_ING
           IF FIO-STAT-OKS
              IF MOV-NUM-MVTO IN MOV-FLD = 1
                  MOVE MOV-FEC-FMOV IN MOV-FLD TO CPB-FEC-FCPB IN CPB
                  MOVE MOV-NUM-COMP IN MOV-FLD TO CPB-NUM-COMP IN CPB
                  MOVE 1 TO CPB-NUM-UMOV IN CPB
                  MOVE FIO-PUT TO FIO-CMND
                  PERFORM CTB-FIO-CPB
              ELSE
                  MOVE MOV-FEC-FMOV IN MOV-FLD TO CPB-FEC-FCPB IN CPB
                  MOVE MOV-NUM-COMP IN MOV-FLD TO CPB-NUM-COMP IN CPB
                  MOVE FIO-GET-KEY-UPD TO FIO-CMND
                  PERFORM CTB-FIO-CPB
                  IF NOT FIO-STAT-OKS
                    GO TO CIC-NEX-CPB
                  ELSE
                    MOVE MOV-NUM-MVTO IN MOV-FLD TO CPB-NUM-UMOV IN CPB
                    MOVE FIO-MOD TO FIO-CMND
                    PERFORM CTB-FIO-CPB.
       CIC-NEX-CPB.
           ADD 1 TO MOV-NUM-MVTO IN MOV-FLD.
           IF MOV-NUM-MVTO IN MOV-FLD NOT > CPB-NUM-TMOV IN MOV-FLD
              AND FIO-STAT-OKS
      * SCR-TRL SALVO PROTECCION CAMPOS DE CPB Y FST-FLD-MOV
               MOVE SCR-STPP TO SCR-STAT
               MOVE 'INGYES NEXT' TO MSG-COD-MENS
               MOVE 'CTB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      * ASUME SCR-STAT-MOD DE COMANDO ING
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM PRO-IKY-MOV
               PERFORM PRO-AKY-MOV
               PERFORM UNP-MKY-MOV
               PERFORM UNP-MOV-MOV
               PERFORM PRO-CPB-MOV
               MOVE -1 TO MOV-COD-TMOV-LEN IN MOV-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-MOV
               PERFORM EDT-FLD-MOV
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )
*% END
*% IF SCR_GFLD_VAL_CON_FLD OR FIN_SCR_GCNF OR FIN_GET_ACC OR FIN_GET_CON
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM MOV-VAL-PF8
               PERFORM EGR-FPEN-FRW.
*% END
*% IF FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF8
               IF SCR-GLS-CONF( SCR-I ) > SPACES
                   PERFORM VAL-NUM-KEY-MOV
                   PERFORM VAL-NUM-FLD-MOV
                   PERFORM EGR-FPEN-FRW
               ELSE
                   PERFORM EGR-FPEN-FRW.
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-MOV
               PERFORM VAL-NUM-FLD-MOV
               PERFORM EGR-FPEN-FRW.
*% END
*% IF FIN_HBL_IKY
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-UBY TO MOV-NUM-MVTO-ATR IN MOV-FLD.
*% END
*% IF FIN_HBL_FLD
*% END
*% IF EOF
       COPY CTBBMCOM.
       MOV-VAL-PF8 SECTION.
       INI-MOV-VAL-PF8.
           IF CTB-IND-OBDC IN CTB NOT = 'S'
               MOVE 'NEXCOMP     ' TO MSG-COD-MENS
               MOVE 'CTB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM SCR-MSSG
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM FST-FLD-MOV
               PERFORM EDT-FLD-MOV
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
       FIN-MOV-VAL-PF8.
           EXIT.

       COPY CTBBFCTB.
       COPY CTBBFCDC.
       COPY CTBBFCPB.
       COPY GNSBPVRF.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
*% FRM = "MOV"
*% INCLUDE 'GNSMMP'
*% END
