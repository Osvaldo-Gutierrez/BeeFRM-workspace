*%        CODIGO ADICIONAL PARA PROGRAMA LISTADOR CTBPLCMP.
*% IF WSS
      *<<<< WSS
       COPY CTBBRHDC.
       01  WSS-PER.
           03 WSS-NUM-MPER                            PIC 9(02).
           03 WSS-NUM-SPER                            PIC 9(02).
           03 WSS-NUM-APER                            PIC 9(02).
       01  WSS-PRE.
           03 PRE-FEC-FMOV                            PIC X(08).
           03 PRE-NUM-COMP                            PIC 9(06).
           03 PRE-NUM-MVTO                            PIC 9(03).
      *>>>> END 
*% END 
*% IF INI_INP
      *<<<< INI_INP
           PERFORM ZER-DET.
           PERFORM ZER-TOT.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM CTB-FIO-HDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO HDC: ABORTO'
               STOP RUN.

           MOVE 'CTB'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE 'CTB' TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR APERTURA ARCHIVO CTBTAB: ABORTO'
               STOP RUN.

      *>>>> END 
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
           DISPLAY ' PERIODO DE PROCESO MMSSAA : '.
           ACCEPT WSS-PER.
           MOVE WSS-NUM-MPER TO HMV-NUM-MMOV IN HMV.
           MOVE WSS-NUM-SPER TO HMV-NUM-SMOV IN HMV.
           MOVE WSS-NUM-APER TO HMV-NUM-AMOV IN HMV.
           MOVE ZEROES       TO HMV-NUM-DMOV IN HMV.
           MOVE ZEROES       TO HMV-NUM-COMP IN HMV.
           MOVE ZEROES       TO HMV-NUM-MVTO IN HMV.
           MOVE FIO-GET-NLS  TO FIO-CMND.
           PERFORM CTB-FIO-HMV.

       FND-FST-HMV.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
           IF NOT ( HMV-COD-TMOV = 010 OR 011 OR 012 OR 013 )
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM CTB-FIO-HMV
               GO TO FND-FST-HMV.

           MOVE HMV-FEC-FMOV IN HMV TO PRE-FEC-FMOV.
           MOVE HMV-NUM-COMP IN HMV TO PRE-NUM-COMP.
           MOVE HMV-NUM-MVTO IN HMV TO PRE-NUM-MVTO.
           MOVE WSS-NUM-SPER TO WSS-NUM-SANO IN WSS-CMP.
           MOVE WSS-NUM-APER TO WSS-NUM-AANO IN WSS-CMP.
           MOVE 'CTB' TO TAB-COD-SIST.
           MOVE 'MES' TO TAB-COD-TTAB.
           MOVE WSS-NUM-MPER TO TAB-COD-CTAB.
           MOVE SPACES TO MSG-COD-MENS.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC TO WSS-GLS-MESS IN WSS-CMP.
      *>>>> END 
*% END
*% IF PH_CMP
      *<<<< PH_CMP
           MOVE WSS-VAL-TASC IN WSS-CMP TO WSS-VAL-ANSC IN WSS-CMP.
           MOVE WSS-VAL-TAEX IN WSS-CMP TO WSS-VAL-ANEX IN WSS-CMP.
           MOVE WSS-VAL-TAAF IN WSS-CMP TO WSS-VAL-ANAF IN WSS-CMP.
           MOVE WSS-VAL-TAIV IN WSS-CMP TO WSS-VAL-ANIV IN WSS-CMP.
           MOVE WSS-VAL-TATO IN WSS-CMP TO WSS-VAL-ANTO IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACSC IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACEX IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACAF IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACIV IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACTO IN WSS-CMP.
      *>>>> END 
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF HMV-NUM-SMOV IN HMV > WSS-NUM-SPER OR
              HMV-NUM-AMOV IN HMV > WSS-NUM-APER OR
              HMV-NUM-MMOV IN HMV > WSS-NUM-MPER
               GO TO FIN-INP-SRT.
           IF NOT ( HMV-COD-TMOV = 010 OR 011 OR 012 OR 013 )
                   MOVE FIO-GET-NXT TO FIO-CMND
                   PERFORM CTB-FIO-HMV
                   GO TO LUP-INP-SRT.
           MOVE HMV-COD-MVTO IN HMV TO HDC-COD-DCOM IN HDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-HDC.
           IF NOT FIO-STAT-OKS
              DISPLAY ' DATOS COMPLEMENTARIOS INEXISTENTES'
              DISPLAY ' LLAVE : ' HDC-COD-DCOM
              DISPLAY ' '
           ELSE
              MOVE 'CTB' TO TAB-COD-SIST
              MOVE 'PRO' TO TAB-COD-TTAB
              MOVE HDC-NUM-RUTR IN HDC TO TAB-COD-CTAB
              MOVE SPACES TO MSG-COD-MENS
              PERFORM BUS-TAB
              IF MSG-COD-MENS = 'COD    NEX'
                   MOVE 'PROVEEDOR INEXISTENTE '
                                     TO WSS-GLS-RUTR IN WSS-CMP
              ELSE
                   MOVE TAB-GLS-DESC TO WSS-GLS-RUTR IN WSS-CMP.
           PERFORM ZER-DET.
      *>>>> END 
*% END
*% IF RM
      *<<<< RM
           PERFORM ADD-HMV.
       INI-MOV-HMV.
           MOVE HMV-FEC-FMOV IN HMV TO PRE-FEC-FMOV IN WSS-PRE.
           MOVE HMV-NUM-COMP IN HMV TO PRE-NUM-COMP IN WSS-PRE.
           MOVE HMV-NUM-MVTO IN HMV TO PRE-NUM-MVTO IN WSS-PRE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CTB-FIO-HMV.
           IF NOT FIO-STAT-OKS
               PERFORM REC-HMV
               GO TO FIN-MOV-HMV.
           IF PRE-NUM-COMP = HMV-NUM-COMP IN HMV AND
              PRE-FEC-FMOV = HMV-FEC-FMOV IN HMV
               IF ( HMV-COD-TMOV = 010 OR 011 OR 012 OR 013 )
                   PERFORM ADD-HMV
                   GO TO INI-MOV-HMV
               ELSE
                   GO TO INI-MOV-HMV
            ELSE
               PERFORM REC-HMV.
       FIN-MOV-HMV.
      *>>>> END 
*% END
*% IF FIN_GEN_OUT 
      *<<<< FIN_GEN_OUT 
           ADD WSS-VAL-SCRE IN SRT TO WSS-VAL-ACSC IN WSS-CMP.
           ADD WSS-VAL-SCRE IN SRT TO WSS-VAL-ACTO IN WSS-CMP.
           ADD WSS-VAL-SCRE IN SRT TO WSS-VAL-TASC IN WSS-CMP.
           ADD WSS-VAL-SCRE IN SRT TO WSS-VAL-TATO IN WSS-CMP.       
           ADD WSS-VAL-EXEN IN SRT TO WSS-VAL-ACEX IN WSS-CMP.
           ADD WSS-VAL-EXEN IN SRT TO WSS-VAL-ACTO IN WSS-CMP.
           ADD WSS-VAL-EXEN IN SRT TO WSS-VAL-TAEX IN WSS-CMP.
           ADD WSS-VAL-EXEN IN SRT TO WSS-VAL-TATO IN WSS-CMP.
           ADD WSS-VAL-AFEC IN SRT TO WSS-VAL-ACAF IN WSS-CMP.
           ADD WSS-VAL-AFEC IN SRT TO WSS-VAL-ACTO IN WSS-CMP.
           ADD WSS-VAL-AFEC IN SRT TO WSS-VAL-TAAF IN WSS-CMP.
           ADD WSS-VAL-AFEC IN SRT TO WSS-VAL-TATO IN WSS-CMP.
           ADD WSS-VAL-MIVA IN SRT TO WSS-VAL-ACIV IN WSS-CMP.
           ADD WSS-VAL-MIVA IN SRT TO WSS-VAL-ACTO IN WSS-CMP.
           ADD WSS-VAL-MIVA IN SRT TO WSS-VAL-TAIV IN WSS-CMP.
           ADD WSS-VAL-MIVA IN SRT TO WSS-VAL-TATO IN WSS-CMP.
      *>>>> END 
*% END
*% IF EOF   
      *<<<< EOF   

       ZER-DET SECTION.
       INI-ZER-DET.
           MOVE ZEROES TO WSS-VAL-SCRE IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-EXEN IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-AFEC IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-MIVA IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TOTA IN WSS-CMP.
       FIN-ZER-DET.
           EXIT.

       ZER-TOT SECTION.
       INI-ZER-TOT.
           MOVE ZEROES TO WSS-VAL-ANSC IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ANEX IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ANAF IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ANIV IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ANTO IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACSC IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACEX IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACAF IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACIV IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-ACTO IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TASC IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TAEX IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TAAF IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TAIV IN WSS-CMP.
           MOVE ZEROES TO WSS-VAL-TATO IN WSS-CMP.
       FIN-ZER-DET.
           EXIT.

       ADD-HMV SECTION.
       INI-ADD-HMV.
           IF HMV-COD-TMOV = 010
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-SCRE IN SRT
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-TOTA IN SRT
           ELSE
           IF HMV-COD-TMOV = 011 
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-EXEN IN SRT
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-TOTA IN SRT
           ELSE
           IF HMV-COD-TMOV = 012
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-AFEC IN SRT
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-TOTA IN SRT
           ELSE
           IF HMV-COD-TMOV = 013 
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-MIVA IN SRT
               ADD HMV-VAL-MVTO IN HMV TO WSS-VAL-TOTA IN SRT.
       FIN-ADD-HMV.
           EXIT.


       REC-HMV SECTION.
       INI-REC-HMV.
           MOVE PRE-FEC-FMOV IN WSS-PRE TO HMV-FEC-FMOV IN HMV.
           MOVE PRE-NUM-COMP IN WSS-PRE TO HMV-NUM-COMP IN HMV.
           MOVE PRE-NUM-MVTO IN WSS-PRE TO HMV-NUM-MVTO IN HMV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-HMV.
       FIN-REC-HMV.
           EXIT.

       COPY CTBBFHDC.
       COPY GNSBSTAB.
       COPY GNSBSMSG.
      *>>>> END 
*% END
