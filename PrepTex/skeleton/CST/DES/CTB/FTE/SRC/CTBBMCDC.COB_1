       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.     CTBBMCDC.
       AUTHOR.         CONSIST.
       
      * Subrutina Manejo Moves y Validacion Formulario CDC.
       
       ENVIRONMENT DIVISION.
      *====================
       
       DATA DIVISION.
      *=============
       
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGFRM.
       01  WSS-VARI.
           03 WSS-CMND                    PIC X(20).
               88 WSS-FLDV     VALUE 'VAL_FLD     '.
               88 WSS-CONV     VALUE 'VAL_CON     '.
               88 WSS-ACCV     VALUE 'VAL_ACC     '.
               88 WSS-GETV     VALUE 'VAL_GET     '.
               88 WSS-RETA     VALUE 'RET_ALL     '.
               88 WSS-RETC     VALUE 'RET_REC     '.
               88 WSS-PUTA     VALUE 'PUT_ALL     '.
               88 WSS-PUTC     VALUE 'PUT_REC     '.
               88 WSS-KEYA     VALUE 'KEY_ALL     '.
               88 WSS-KEYC     VALUE 'KEY_REC     '.
       
       COPY CTBWICDC.
       COPY CTBBRCDC           REPLACING
           ==CDC== BY ==CDC EXTERNAL==.
      *<<<< WSS
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *>>>>
       LINKAGE SECTION.
      *---------------
       01 LNK-CMND                         PIC X(20).
       
       PROCEDURE DIVISION USING LNK-CMND.
      *=================================
       
       MAIN SECTION.
      *------------
       INI-MAIN.
           MOVE LNK-CMND TO WSS-CMND.
           IF WSS-FLDV
               PERFORM VAL-FLD-CDC
               GO TO FIN-MAIN.
           IF WSS-CONV
               PERFORM VAL-CON-CDC
               GO TO FIN-MAIN.
           IF WSS-ACCV
               PERFORM VAL-ACC-CDC
               GO TO FIN-MAIN.
           IF WSS-GETV
               PERFORM VAL-GET-CDC
               GO TO FIN-MAIN.
           IF WSS-RETA
               PERFORM RET-ALL-CDC
               GO TO FIN-MAIN.
           IF WSS-KEYA
               PERFORM KEY-ALL-CDC
               GO TO FIN-MAIN.
           IF WSS-PUTA
               PERFORM PUT-ALL-CDC
               GO TO FIN-MAIN.
           IF WSS-RETC
               PERFORM FMS-RETC
               GO TO FIN-MAIN.
           IF WSS-KEYC
               PERFORM FMS-KEYC
               GO TO FIN-MAIN.
           IF WSS-PUTC
               PERFORM FMS-PUTC
               GO TO FIN-MAIN.
           DISPLAY '? Codigo '
               LINE 23 COLUMN 1 WITH BELL REVERSED.
       ERR-MAIN.
           DISPLAY     LNK-CMND REVERSED
               '  invalido en CTBBMCTB : ABORTO'
               LINE 24 COLUMN 1 REVERSED.
           STOP RUN.
       FIN-MAIN.
           EXIT PROGRAM.
       
       FMS-MERR SECTION.
       INI-FMS-MERR.
           DISPLAY '? Parametros de Codigo '
               LINE 23 COLUMN 1 WITH BELL REVERSED.
           GO TO ERR-MAIN.
       FIN-FMS-MERR.
           EXIT.
       
       VAL-FLD-CDC SECTION.
       INI-VAL-FLD-CDC.
           IF FRM-NFLD = CDC-VRF-CCDC-N
               PERFORM VAL-CDC-NUM-CCDC
               GO TO FIN-VAL-FLD-CDC.
           IF FRM-NFLD = CDC-VRF-ICDC-N
               PERFORM VAL-CDC-NUM-ICDC
               GO TO FIN-VAL-FLD-CDC.
           IF FRM-NFLD = CDC-GLS-CCDC-N
               PERFORM VAL-CDC-GLS-CCDC
               GO TO FIN-VAL-FLD-CDC.
           PERFORM FMS-MERR.
       FIN-VAL-FLD-CDC.
           EXIT.
       
       VAL-CON-CDC SECTION.
       INI-VAL-CON-CDC.
       FIN-VAL-CON-CDC.
           EXIT.
       
       VAL-ACC-CDC SECTION.
       INI-VAL-ACC-CDC.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-ACC-CDC.
           EXIT.
       
       VAL-GET-CDC SECTION.
       INI-VAL-GET-CDC.
       FIN-VAL-GET-CDC.
           EXIT.
       
       RET-ALL-CDC SECTION.
       INI-RET-ALL-CDC.
           PERFORM KEY-ALL-CDC.
           PERFORM RET-CDC-CDC.
       FIN-RET-ALL-CDC.
           EXIT.

       PUT-ALL-CDC SECTION.
       INI-PUT-ALL-CDC.
           PERFORM PUT-CDC-CDC.
           MOVE CDC-DFLD TO FRM-DFLD.
       FIN-PUT-ALL-CDC.
           EXIT.

       KEY-ALL-CDC SECTION.
       INI-KEY-ALL-CDC.
           PERFORM KEY-CDC-CDC.
       FIN-KEY-ALL-CDC.
           EXIT.

       FMS-RETC SECTION.
       INI-FMS-RETC.
           IF FRM-NREG = 'CDC'
               PERFORM RET-CDC-CDC
           ELSE
               PERFORM FMS-MERR.
       FIN-FMS-RETC.
           EXIT.

       FMS-PUTC SECTION.
       INI-FMS-PUTC.
           IF FRM-NREG = 'CDC'
               PERFORM PUT-CDC-CDC
           ELSE
               PERFORM FMS-MERR.
       FIN-FMS-PUTC.
           EXIT.

       FMS-KEYC SECTION.
       INI-FMS-KEYC.
           IF FRM-NREG = 'CDC'
               PERFORM KEY-CDC-CDC
           ELSE
               PERFORM FMS-MERR.
       FIN-FMS-KEYC.
           EXIT.

       RET-CDC-CDC SECTION.
       INI-RET-CDC-CDC.
           MOVE CDC-NUM-ICDC IN CDC-FLD TO CDC-NUM-ICDC IN CDC.
           MOVE CDC-VRF-ICDC IN CDC-FLD TO CDC-VRF-ICDC IN CDC.
           MOVE CDC-GLS-CCDC IN CDC-FLD TO CDC-GLS-CCDC IN CDC.
       FIN-RET-CDC-CDC.
           EXIT.

       PUT-CDC-CDC SECTION.
       INI-PUT-CDC-CDC.
           MOVE CDC-NUM-CCDC IN CDC TO CDC-NUM-CCDC IN CDC-FLD.
           MOVE CDC-VRF-CCDC IN CDC TO CDC-VRF-CCDC IN CDC-FLD.
           MOVE CDC-NUM-ICDC IN CDC TO CDC-NUM-ICDC IN CDC-FLD.
           MOVE CDC-VRF-ICDC IN CDC TO CDC-VRF-ICDC IN CDC-FLD.
           MOVE CDC-GLS-CCDC IN CDC TO CDC-GLS-CCDC IN CDC-FLD.
       FIN-PUT-CDC-CDC.
           EXIT.

       KEY-CDC-CDC SECTION.
       INI-KEY-CDC-CDC.
           MOVE CDC-NUM-CCDC IN CDC-FLD TO CDC-NUM-CCDC IN CDC.
           MOVE CDC-VRF-CCDC IN CDC-FLD TO CDC-VRF-CCDC IN CDC.
       FIN-KEY-CDC-CDC.
           EXIT.

       VAL-CDC-NUM-CCDC SECTION.
       INI-VAL-CDC-NUM-CCDC.
           MOVE FRM-VFLD TO CDC-VRF-CCDC-VRF IN CDC-FLD.
      *<<<< CDC_NUM_CCDC
           MOVE CDC-NUM-CCDC IN CDC-FLD TO VRF-NUME.
           MOVE CDC-VRF-CCDC IN CDC-FLD TO VRF-DVRF.
           MOVE VRF-ZERO-N TO VRF-ZERO.
           MOVE VRF-SVRF-0 TO VRF-SVRF.
           MOVE 7 TO VRF-LMAX.
           MOVE VRF-VAL TO VRF-CMND.
           PERFORM PRO-VRF.
      *>>>>
       FIN-VAL-CDC-NUM-CCDC.
           EXIT.

       VAL-CDC-NUM-ICDC SECTION.
       INI-VAL-CDC-NUM-ICDC.
           MOVE FRM-VFLD TO CDC-VRF-ICDC-VRF IN CDC-FLD.
      *<<<< CDC_NUM_ICDC
           IF CDC-NUM-ICDC IN CDC-FLD NOT > ZEROES
               MOVE CDC-NUM-CCDC IN CDC-FLD TO CDC-NUM-ICDC IN CDC-FLD
               MOVE CDC-VRF-CCDC IN CDC-FLD TO CDC-VRF-ICDC IN CDC-FLD
      * ISP 
      * ES NECESARIO DESPLEGAR LAS GLOSAS
               MOVE CDC-VRF-ICDC-N  IN CDC-NFLD TO FRM-NFLD
               MOVE CDC-VRF-ICDC-VRF   IN CDC-FLD  TO FRM-VFLD
      *         CALL 'DESPROSCR' USING FDV-PUT
               CALL 'FDV$PUT' USING
               BY DESCRIPTOR FRM-VFLD
                             FRM-NFLD
                   BY REFERENCE  FRM-IFLD
           ELSE
               MOVE CDC-NUM-ICDC IN CDC-FLD TO VRF-NUME
               MOVE CDC-VRF-ICDC IN CDC-FLD TO VRF-DVRF
               MOVE VRF-ZERO-N TO VRF-ZERO
               MOVE VRF-SVRF-0 TO VRF-SVRF
               MOVE 7 TO VRF-LMAX
               MOVE VRF-VAL TO VRF-CMND
               PERFORM PRO-VRF.
      *>>>>
       FIN-VAL-CDC-NUM-ICDC.
           EXIT.

       VAL-CDC-GLS-CCDC SECTION.
       INI-VAL-CDC-GLS-CCDC.
           MOVE FRM-VFLD TO CDC-GLS-CCDC IN CDC-FLD.
       FIN-VAL-CDC-GLS-CCDC.
           EXIT.

      *<<<< EOF_VAX
       COPY GNSBPVRF.
       COPY GNSBGMSG.
       COPY GNSIOMSG.
      *>>>>
