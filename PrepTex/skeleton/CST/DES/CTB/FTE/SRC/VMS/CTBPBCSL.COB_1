       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      CTBPBCSL.
       AUTHOR.          CONSIST.

      * CONDENSA SALDOS

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
      * INPUT-OUTPUT SECTION.
      *--------------------
      * FILE-CONTROL.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY CTBBRSLD.
      *
       01  WSS-VARI.
      *
           03  WSS-FEC-FING.
               05 WSS-NUM-DING                  PIC 9(02).
               05 WSS-NUM-MING                  PIC 9(02).
               05 WSS-NUM-SING                  PIC 9(02).
               05 WSS-NUM-AING                  PIC 9(02).
      *
           03  WSS-FEC-FCON.
               05 WSS-NUM-SCON                       PIC 9(02).
               05 WSS-NUM-ACON                       PIC 9(02).
               05 WSS-NUM-MCON                       PIC 9(02).
               05 WSS-NUM-DCON                       PIC 9(02).

           03  WSS-FEC-FMVS.
               05 WSS-NUM-SMVS                       PIC 9(02).
               05 WSS-NUM-AMVS                       PIC 9(02).
               05 WSS-NUM-MMVS                       PIC 9(02).
               05 WSS-NUM-DMVS                       PIC 9(02).

       COPY GNSWCFIO.
       COPY GNSWVFIO.

       PROCEDURE DIVISION.
      *==================
       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
           PERFORM PRO-SLD UNTIL SLD-FEC-FSLD > WSS-FEC-FCON OR
               NOT FIO-STAT-OKS.
           PERFORM FIN.
           STOP RUN.
       FIN-MAIN.
           EXIT.

       PRO-SLD SECTION.
       INI-PRO-SLD.
           IF SLD-IND-TREG  = '3'
               GO TO LAB-NXT-SLD.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CTB-FIO-SLD.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN ELIMINACION'
               DISPLAY SLD.
       LAB-NXT-SLD.
           PERFORM NXT-SLD.
       FIN-PRO-SLD.
           EXIT.

       NXT-SLD SECTION.
       INI-NXT-SLD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CTB-FIO-SLD.
       FIN-NXT-SLD.
           EXIT.

       INI SECTION.
       INI-INI.
           DISPLAY ' INGRESE FECHA DE PROCESO : '.
           ACCEPT WSS-FEC-FING.
           DISPLAY ' FECHA DE PROCESO : ' WSS-FEC-FING.
           DISPLAY ' '.
           MOVE WSS-NUM-SING TO WSS-NUM-SCON.
           MOVE WSS-NUM-AING TO WSS-NUM-ACON.
           MOVE WSS-NUM-MING TO WSS-NUM-MCON.
           MOVE WSS-NUM-DING TO WSS-NUM-DCON.

           DISPLAY WSS-FEC-FCON.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM CTB-FIO-SLD.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM CTB-FIO-SLD.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ARCHIVO SALDOS VACIO :  ABORTO'
               STOP RUN.
       FIN-INI.
           EXIT.

       FIN SECTION.
       FIN-INI.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM CTB-FIO-SLD.
       FIN-FIN.
           EXIT.

       COPY CTBBFSLD.
