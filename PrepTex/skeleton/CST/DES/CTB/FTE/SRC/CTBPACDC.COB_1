       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.     CTBPACDC.
       AUTHOR.          CONSIST.
       
      * Actualiza Archivo CTBCDC en forma Interactiva.
       
       ENVIRONMENT DIVISION.
      *====================
       
       DATA DIVISION.
      *=============
       
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY CTBBRCDC REPLACING ==CDC== BY
                               ==CDC EXTERNAL==.
       COPY CTBWICDC.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSCR.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       COPY GNSBRTAB.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       
       PROCEDURE DIVISION.
      *==================
       
       MAIN SECTION.
      *------------
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           CALL 'DESSCRCMN'.
           IF SCR-CCPP = 'MOD'
               PERFORM SCR-MOD UNTIL SCR-FFLD-TAB
           ELSE
           IF SCR-CCPP = 'ING'
               PERFORM SCR-ING UNTIL SCR-FFLD-TAB
           ELSE
           IF SCR-CCPP = 'ACC'
               PERFORM SCR-ACC UNTIL SCR-FFLD-TAB
           ELSE
           IF SCR-CCPP = 'ELI'
               PERFORM SCR-ELI UNTIL SCR-FFLD-TAB
           ELSE
           IF SCR-CCPP = 'ACT'
               PERFORM SCR-ACT UNTIL SCR-FFLD-TAB
           ELSE
               PERFORM SCR-PGM UNTIL SCR-FFLD-TAB.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.
       
       INI SECTION.
      *-----------
       INI-INI.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
       HDR-INI.
           CALL 'DESSCRHDR'.
       FOR-INI.
           MOVE 'CTBFMS'          TO FRM-NLIB.
           MOVE 'CDC'          TO FRM-NAME.
           MOVE FRM-SINI-DBNF     TO FRM-SINI.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE CDC-UARV          TO FRM-UARV.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       CMN-INI.
           MOVE 'CTBPACDC'     TO SCR-PROG.
       FIN-INI.
           EXIT.
       
       SCR-MOD SECTION.
      *---------------
       INI-SCR-MOD.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-KEY.
           PERFORM SCR-TRL.
           IF SCR-STAT EQUAL SCR-STAT-ABT
               GO TO FIN-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-VFLD = SCR-VFLD-NOT OR ( SCR-MFLD NOT 
              EQUAL SCR-MFLD-YES )
               MOVE 'NO FUE MODIFICADO' TO FRM-MENS
           ELSE
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   MOVE 'MODIFICADO OK' TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-MOD.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       
       SCR-ING SECTION.
      *----------------
       INI-SCR-ING.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               GO TO TRL-SCR-ING.
           PERFORM FND-KEY.
           IF NOT FIO-STAT-OKS
               PERFORM GET-FLD
           ELSE
               MOVE 'YA EXISTE REGISTRO' TO FRM-MENS
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SCR-STAT-ABT TO SCR-STAT.
       TRL-SCR-ING.
           PERFORM SCR-TRL.
           IF SCR-STAT EQUAL SCR-STAT-ABT
               GO TO FIN-SCR-ING.
       MSG-SCR-ING.
           IF SCR-VFLD = SCR-VFLD-NOT
               MOVE 'NO FUE INGRESADO' TO FRM-MENS
           ELSE
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'INGRESADO OK' TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-ING.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       
       SCR-ACC SECTION.
      *---------------
       INI-SCR-ACC.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-KEY.
           PERFORM SCR-TRL.
           IF SCR-STAT EQUAL SCR-STAT-ABT
               GO TO FIN-SCR-ACC.
           PERFORM CMN-ACC.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-ACC.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       
       SCR-ELI SECTION.
      *---------------
       INI-SCR-ELI.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-KEY.
           PERFORM SCR-TRL.
           IF SCR-STAT EQUAL SCR-STAT-ABT
               GO TO FIN-SCR-ELI.
       MSG-SCR-ELI.
           IF SCR-VFLD = SCR-VFLD-NOT
               MOVE 'NO FUE ELIMINADO' TO FRM-MENS
           ELSE
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   MOVE 'ELIMINADO OK' TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-ELI.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       
       SCR-ACT SECTION.
      *---------------
       INI-SCR-ACT.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               PERFORM SCR-TRL
               GO TO FIN-SCR-ACT.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               PERFORM SCR-TRL
               IF SCR-STAT NOT EQUAL SCR-STAT-ABT
                   PERFORM MSG-SCR-MOD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF FIO-STAT-EOF
               MOVE 'NO HAY MAS REGISTROS' TO FRM-MENS
               MOVE FRM-MSG TO FRM-CMND
               PERFORM GNS-PRO-FRM
               MOVE SCR-STAT-ABT TO SCR-STAT
               PERFORM SCR-TRL
           ELSE
               PERFORM GET-FLD
               PERFORM SCR-TRL
               IF SCR-STAT NOT EQUAL SCR-STAT-ABT
                   PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           
       SCR-PGM SECTION.
      *---------------
       INI-SCR-PGM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               GO TO TRL-SCR-PGM.
           PERFORM FND-KEY.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       TRL-SCR-PGM.
           PERFORM SCR-TRL.
           IF SCR-STAT EQUAL SCR-STAT-ABT
               GO TO FIN-SCR-PGM.
           PERFORM CMN-PGM.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PGM.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       
       SCR-KEY SECTION.
      *---------------
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-KEY.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               GO TO FIN-SCR-KEY.
       ERR-SCR-KEY.
           IF FIO-STAT-EOF
               MOVE 'NO HAY MAS REGISTROS' TO FRM-MENS
           ELSE
               MOVE 'NO EXISTE REGISTRO' TO FRM-MENS.
           MOVE FRM-MSG TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.
       
       SCR-RST SECTION.
      *---------------
       INI-SCR-RST.
           MOVE SCR-STPP TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           INITIALIZE CDC-DFLD.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       FIN-SCR-RST.
           EXIT.
       
       GET-KEY SECTION.
      *---------------
       INI-GET-KEY.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       COPY CTBKYCDC.
       FIN-GET-KEY.
           EXIT.
       
       FND-KEY SECTION.
      *---------------
       INI-FND-KEY.
           IF FRM-UARV NOT = SPACES
               PERFORM KEY-ALL-CDC.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
       FIN-FND-KEY.
           EXIT.
       
       SCR-TRL SECTION.
      *---------------
       INI-SCR-TRL.
           CALL 'DESSCRTRL'.
           IF SCR-FFLD-BSP
               PERFORM GET-FLD
               MOVE SCR-MFLD-YES TO SCR-MFLD
               GO TO INI-SCR-TRL.
       FIN-SCR-TRL.
           EXIT.
       
       PUT-SCR SECTION.
      *---------------
       INI-PUT-SCR.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           PERFORM PUT-ALL-CDC.
       FIN-PUT-SCR.
           EXIT.
       
       GET-FLD SECTION.
      *---------------
       INI-GET-FLD.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       COPY CTBFLCDC.
       FIN-GET-FLD.
           EXIT.
       
       CMN-MOD SECTION.
      *---------------
       INI-CMN-MOD.
           PERFORM RET-ALL-CDC.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
           IF NOT FIO-STAT-OKS
               MOVE 'ERROR al MODIFICAR' TO FRM-MENS.
       FIN-CMN-MOD.
           EXIT.     
       
       CMN-ING SECTION.
      *---------------
       INI-CMN-ING.
           PERFORM RET-ALL-CDC.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
           IF NOT FIO-STAT-OKS
               MOVE 'ERROR al INGRESAR' TO FRM-MENS.
       FIN-CMN-ING.
           EXIT.     
       
       CMN-ACC SECTION.
      *---------------
       INI-CMN-ACC.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       FIN-CMN-ACC.
           EXIT.
       
       CMN-ELI SECTION.
      *---------------
       INI-CMN-ELI.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM CTB-FIO-CDC.
           IF NOT FIO-STAT-OKS
               MOVE 'ERROR al ELIMINAR' TO FRM-MENS.
       FIN-CMN-ELI.
           EXIT.
       
       CMN-PGM SECTION.
      *---------------
       INI-CMN-PGM.
      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       FIN-CMN-PGM.
           EXIT.

       PUT-ALL-CDC SECTION.
       INI-PUT-ALL-CDC.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-PUT-ALL-CDC.
           EXIT.

       KEY-ALL-CDC SECTION.
       INI-KEY-ALL-CDC.
           MOVE FRM-KEY-ALL TO FRM-CMND.
           CALL FRM-UARV USING FRM-CMND.
       FIN-KEY-ALL-CDC.
           EXIT.

       RET-ALL-CDC SECTION.
       INI-RET-ALL-CDC.
           MOVE FRM-RET-ALL TO FRM-CMND.
           CALL FRM-UARV USING FRM-CMND.
       FIN-RET-ALL-CDC.
           EXIT.

       GNS-PRO-FRM SECTION.
       INI-GNS-PRO-FRM.
           CALL 'DESPROFRM' USING  FRM-CMND.
       FIN-GNS-PRO-FRM.
           EXIT.

       COPY GNSBGMSG.
       COPY GNSIOMSG.
       COPY GNSIOMSC.
       COPY CTBIOCDC.

      *  CODIGO ADICIONAL PARA PROGRAMA CTBPACDC.
       COPY GNSBPVRF.
       COPY GNSIOTAB.
