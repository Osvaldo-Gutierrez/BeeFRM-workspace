       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SUPPLFD3.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    16-Sep-94 11:56 AM.

      * Programa Listador de Reporte D3A sin Sort.


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPTD3A       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTD3A       ASSIGN TO        UT-S-RPTD3A.
           SELECT RPTD3A       ASSIGN TO        UT-S-RPTD3A.
      *<<<< IOS
      * Reporte 2
      *DOS SELECT RPTD31         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTD31         ASSIGN TO        UT-S-RPTD31.
           SELECT RPTD31         ASSIGN TO        UT-S-RPTD31.
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTD3A LABEL RECORD OMITTED
           REPORT IS RPT-D3A
           .
      *<<<< FLS
      * Reporte 2
       FD  RPTD31 LABEL RECORD OMITTED
           REPORT IS RPT-D31.
       01  PASO.
           03 FILLER                                   PIC X(01).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FD3-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY SUPBRFD3.
       COPY SUPRRD3A.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY SUPRWD3A.
      *<<<< RW
       01  WSS-D3A-R  REDEFINES  WSS-D3A.
           03  WSS-D3A-V.
               05  WSS-D3A-ELE          OCCURS 11.
                   07  WSS-MONT                        PIC 9(11).
                   07  WSS-TMIN                        PIC 9(03)V9(02).
                   07  WSS-TMAX                        PIC 9(03)V9(02).
                   07  WSS-PPON                        PIC 9(03)V9(02).

       COPY SUPRWD3B.
       01  WSS-D3B-R  REDEFINES  WSS-D3B.
           03  WSS-D3B-V.
               05  WSS-D3B-ELE          OCCURS 21.
                   07  WSS-MONT                        PIC 9(11).
                   07  WSS-TMIN                        PIC 9(03)V9(02).
                   07  WSS-TMAX                        PIC 9(03)V9(02).
                   07  WSS-PPON                        PIC 9(03)V9(02).

       COPY SUPRWD3C.
       01  WSS-D3C-R  REDEFINES  WSS-D3C.
           03  WSS-D3C-V.
               05  WSS-D3C-ELE          OCCURS 11.
                   07  WSS-MONT                        PIC 9(11).
                   07  WSS-TMIN                        PIC 9(03)V9(02).
                   07  WSS-TMAX                        PIC 9(03)V9(02).
                   07  WSS-PPON                        PIC 9(03)V9(02).
               05  WSS-D3C-TOT.
                   07  WSS-TMON                        PIC 9(12).
                   07  WSS-TTMI                        PIC 9(04)V9(02).
                   07  WSS-TTMA                        PIC 9(04)V9(02).
                   07  WSS-TPPO                        PIC 9(04)V9(02).
               05  WSS-CTFL                            PIC 9(12).

       COPY SUPRWD31.
      * 01  WSS-D31-R  REDEFINES  WSS-D31.
       COPY SUPRWD32.
      * 01  WSS-D32-R  REDEFINES  WSS-D32.
       COPY SUPRWD33.
      * 01  WSS-D33-R  REDEFINES  WSS-D33.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY TABBRUSR.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       01  WSS-VARI.
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                          PIC 9(02).
              05 WSS-NUM-MINF                          PIC 9(02).
              05 WSS-NUM-SINF                          PIC 9(02).
              05 WSS-NUM-AINF                          PIC 9(02).
           03 WSS-FEC-FIN1.
              05 WSS-NUM-SIN1                          PIC 9(02).
              05 WSS-NUM-AIN1                          PIC 9(02).
              05 WSS-NUM-MIN1                          PIC 9(02).
              05 WSS-NUM-DIN1                          PIC 9(02).
           03 WSS-IND                                  PIC 9(02).
           03 WSS-SUB                                  PIC 9(02).
           03 WSS-IND-STAT         VALUE 0             PIC 9(01).
           03 WSS-NUM-FD3L         VALUE 0             PIC 9(06).
           03 WSS-NUM-FD3S         VALUE 0             PIC 9(06).
           03 WSS-NUM-FD3P         VALUE 0             PIC 9(06).
           03 WSS-NUM-FD3R         VALUE 0             PIC 9(06).

           03 WSS-VECT.
              05 WSS-ACTI          OCCURS 44.
                 07 WSS-MONT                           PIC 9(13)V9(04).
                 07 WSS-TMIN                           PIC 9(03)V9(02).
                 07 WSS-TMAX                           PIC 9(03)V9(02).
                 07 WSS-TPPO                           PIC 9(03)V9(02).
              05 WSS-PASI          OCCURS 44.
                 07 WSS-MONT                           PIC 9(13)V9(04).
                 07 WSS-TMIN                           PIC 9(03)V9(02).
                 07 WSS-TMAX                           PIC 9(03)V9(02).
                 07 WSS-TPPO                           PIC 9(03)V9(02).
           03 WSS-VECR.
              05 WSS-RACT          OCCURS 43.
                 07 WSS-RMON                           PIC 9(11).
                 07 WSS-TMIN                           PIC 9(03)V9(02).
                 07 WSS-TMAX                           PIC 9(03)V9(02).
                 07 WSS-TPPO                           PIC 9(03)V9(02).
              05 WSS-COTF                              PIC 9(12).
              05 WSS-RPAS          OCCURS 43.
                 07 WSS-RMON                           PIC 9(11).
                 07 WSS-TMIN                           PIC 9(03)V9(02).
                 07 WSS-TMAX                           PIC 9(03)V9(02).
                 07 WSS-TPPO                           PIC 9(03)V9(02).
              05 WSS-CATF                              PIC 9(12).
              05 WSS-TRCN          OCCURS 2.
                 07 WSS-TMON                           PIC 9(12).
                 07 WSS-TTMI                           PIC 9(04)V9(02).
                 07 WSS-TTMA                           PIC 9(04)V9(02).
                 07 WSS-TTPP                           PIC 9(04)V9(02).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY SUPRFD3A.
           .
       COPY SUPRTD3A.
      *<<<< RT
       COPY SUPRTD3B.
       COPY SUPRTD3C.
      * Reporte 2
       COPY SUPRFD31.
           .
       COPY SUPRTD31.
       COPY SUPRTD32.
       COPY SUPRTD33.
      *>>>>

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-PH-D3A SECTION.
           USE BEFORE REPORTING PH-D3A.
       INI-PH-D3A.
       FIN-PH-D3A.
           EXIT.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SUPPLFD3' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      * Captura Fecha de Proceso
           DISPLAY 'INGRESE FECHA DEL INFORME (DDMMSSAA) '.
           ACCEPT WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Informe
           DISPLAY 'FECHA DEL INFORME : ' WSS-FEC-FINF IN WSS-VARI.
           MOVE WSS-FEC-FINF    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DACT IN WSS-D31
                                            WSS-NUM-DIN1 IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-NUM-MACT IN WSS-D31
                                            WSS-NUM-MIN1 IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SACT IN WSS-D31
                                            WSS-NUM-SIN1 IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AACT IN WSS-D31
                                            WSS-NUM-AIN1 IN WSS-VARI.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * BUS-USR busca Usuario en tablas para obtener Codigo de la Instit
      * Financiera para reporte
           MOVE 'USR' TO USR-COD-USER IN USR.
           PERFORM BUS-USR.

      * Inicializa Variables
      * Inicializar Matriz de campos del Reporte
           MOVE ZEROES TO WSS-VECT IN WSS-VARI
                          WSS-VECR IN WSS-VARI.
      *>>>>
       INI-INP-SRT.
      *     MOVE 'SUPPLFD3' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SUP-FIO-FD3.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM SUP-FIO-FD3.
      *<<<< FIN_FST_INP
      * Validacion Lectura Inicial del registro FD3
           IF NOT FIO-STAT-OKS
               MOVE  9  TO WSS-IND-STAT IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS EN FD3 PARA EL INFORME : '
               GO TO FIN-INP-SRT.
      *>>>>
       INI-OUT-SRT.
           OPEN OUTPUT RPTD3A.
           INITIATE RPT-D3A.
      *<<<< FST_OUT
      * Apertura e Inicializacion de Reportes distintos del Base
           OPEN OUTPUT RPTD31.
           INITIATE RPT-D31.
      *>>>>
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<< LUP_INP
      * Proceso de Clasificacion a Partir del Registro FD3 Leido
           ADD 1 TO WSS-NUM-FD3L IN WSS-VARI.

      * Seleccion de los Registros FD3 Leidos, para ser Procesados
           PERFORM SEL-REG-PRO.
           IF WSS-IND-STAT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.
           ADD 1 TO WSS-NUM-FD3S IN WSS-VARI.

      * Proceso para los Registros FD3 Seleccionados
           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.

      * Distribucion del Registro FD3 Seleccionado en Clasificacion segu
      * Tipo / Plazo / Partidas
           IF FD3-COD-TIPO IN FD3 = 'A'
               PERFORM DIS-A-COL.
      *     ELSE
      *     IF FD3-COD-TIPO IN FD3 = 'B'
      *         PERFORM DIS-B-DAP.

           IF WSS-IND-STAT IN WSS-VARI = 1
               ADD 1 TO WSS-NUM-FD3R IN WSS-VARI
           ELSE
               ADD 1 TO WSS-NUM-FD3P IN WSS-VARI.

           GO TO NXT-INP-SRT.
      *>>>>
       MOV-INP-SRT.
       COPY SUPRMD3A.
       LUP-OUT-SRT.
           GENERATE DL-D3A.
       NXT-INP-SRT.
       NXT-OUT-SRT.
      *<<<< INI_NXT_INP
      * Lectura de Siguiente registro FD3
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SUP-FIO-FD3.
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SUP-FIO-FD3.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
      * Se salta hasta termino reporte cuando no existen datos en Archiv
           IF WSS-IND-STAT IN WSS-VARI = 9
               GO TO FINAL-PROCESO.

      * Redondea en Miles ($) Montos Acumulados para el Reporte
           PERFORM PRO-RND-ACTI VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                                  UNTIL WSS-IND IN WSS-VARI > 43.
           DIVIDE WSS-MONT IN WSS-ACTI(44) BY 1000 GIVING
                                  WSS-COTF IN WSS-VECR ROUNDED.
      *     PERFORM PRO-RND-PASI VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
      *                            UNTIL WSS-IND IN WSS-VARI > 43.
      *     DIVIDE WSS-MONT IN WSS-PASI(44) BY 1000 GIVING
      *                            WSS-CATF IN WSS-VECR ROUNDED.

      * Totaliza Montos Acumulados Redondeados para el Reporte
           PERFORM PRO-TOT-ACTI VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
                                  UNTIL WSS-IND IN WSS-VARI > 43.
      *     PERFORM PRO-TOT-PASI VARYING WSS-IND IN WSS-VARI FROM 1 BY 1
      *                            UNTIL WSS-IND IN WSS-VARI > 43.

      * Traspasar Totales al Registro WSS que Corresponde del Reporte
           MOVE 1 TO WSS-IND IN WSS-VARI.
       LUP-TRA-WSS.
           IF WSS-IND IN WSS-VARI < 12
               MOVE WSS-RACT(WSS-IND) TO WSS-D3A-ELE(WSS-IND)
      *         MOVE WSS-RACT(WSS-IND) TO WSS-D31-ELE(WSS-IND)
           ELSE
           IF WSS-IND IN WSS-VARI < 33
               SUBTRACT 11 FROM WSS-IND IN WSS-VARI GIVING
                                WSS-SUB IN WSS-VARI
               MOVE WSS-RACT(WSS-IND) TO WSS-D3B-ELE(WSS-SUB)
      *         MOVE WSS-RACT(WSS-IND) TO WSS-D32-ELE(WSS-IND)
           ELSE
               SUBTRACT 32 FROM WSS-IND IN WSS-VARI GIVING
                                WSS-SUB IN WSS-VARI
               MOVE WSS-RACT(WSS-IND) TO WSS-D3C-ELE(WSS-SUB).
      *         MOVE WSS-RACT(WSS-IND) TO WSS-D33-ELE(WSS-IND).

           ADD 1 TO WSS-IND IN WSS-VARI.
           IF WSS-IND IN WSS-VARI < 44
               GO TO LUP-TRA-WSS.

           MOVE WSS-COTF IN WSS-VECR TO WSS-CTFL    IN WSS-D3C-V.
           MOVE WSS-TRCN(1)          TO WSS-D3C-TOT IN WSS-D3C-V.
      *     MOVE WSS-CATF IN WSS-VECR TO WSS-CTFL    IN WSS-D33-V.
      *     MOVE WSS-TRCN(2)          TO WSS-D33-TOT IN WSS-D33-V.

      * Despliega Totales de Control Proceso
           DISPLAY 'TOTAL FD3 LEIDOS          : '
                              WSS-NUM-FD3L IN WSS-VARI.
           DISPLAY 'TOTAL FD3 SELECCIONADOS   : '
                              WSS-NUM-FD3S IN WSS-VARI.
           DISPLAY 'TOTAL FD3 PROCESADOS      : '
                              WSS-NUM-FD3P IN WSS-VARI.
           DISPLAY 'TOTAL FD3 RECHAZADOS      : '
                              WSS-NUM-FD3R IN WSS-VARI.

      * Genera Reporte D3 Completo
           GENERATE DL-D3A.
           GENERATE DL-D3B.
           GENERATE DL-D3C.
           GENERATE DL-D31.
           GENERATE DL-D32.
           GENERATE DL-D33.
      *>>>>
           TERMINATE RPT-D3A.
      *<<<< FIN_TMT
      * Cierre de Reportes distintos del Base
           TERMINATE RPT-D31.
           CLOSE RPTD31.
      *>>>>
           CLOSE RPTD3A.
      *<<<< FIN
      * Termino del reporte
       FINAL-PROCESO.
      *>>>>
           IF PGM-STAT-SRT-MAL
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       COPY SUPBFFD3.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF
      ******************************************************************
      * Seleccion del Registro FD3 Leido para ser Procesado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-STAT IN WSS-VARI.

           MOVE  0  TO WSS-IND-STAT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      ******************************************************************
      * Distribucion del Registro Seleccionado en Clasificacion Colocaci
      * segun Plazo / Partidas
       DIS-A-COL SECTION.
       INI-DIS-A-COL.
           IF FD3-NUM-LINE IN FD3     > 44 OR
              FD3-NUM-LINE IN FD3 NOT > 0
               DISPLAY 'ERROR : REGISTRO CON LINEA DE PLAZO EXTRANA '
                       'EN OPER. ACTIVAS / KEY : ' FD3-KEY-IFD3 IN FD3
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI
           ELSE
               MOVE FD3-NUM-LINE IN FD3 TO WSS-IND IN WSS-VARI
               PERFORM PRO-FIL-VCPP.
       FIN-DIS-A-COL.
           EXIT.
      ******************************************************************
      * Distribucion del Registro Seleccionado en Clasificacion Captacio
      * segun Plazo / Partidas
       DIS-A-DAP SECTION.
       INI-DIS-A-DAP.
           IF FD3-NUM-LINE IN FD3     > 44 OR
              FD3-NUM-LINE IN FD3 NOT > 0
               DISPLAY 'ERROR : REGISTRO CON LINEA DE PLAZO EXTRANA '
                       'EN OPER. PASIVAS / KEY : ' FD3-KEY-IFD3 IN FD3
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI
           ELSE
               MOVE FD3-NUM-LINE IN FD3 TO WSS-IND IN WSS-VARI
               PERFORM PRO-FIL-VCPP.
       FIN-DIS-A-DAP.
           EXIT.
      ******************************************************************
      * Con el Registro Seleccionado se Llena el Vector de Clasificacion
      * segun Plazo / Partidas
       PRO-FIL-VCPP SECTION.
       INI-PRO-FIL-VCPP.
           IF FD3-COD-TIPO IN FD3 = 'A'
               MOVE FD3-VAL-MONT IN FD3 TO WSS-MONT IN WSS-ACTI(WSS-IND)
               MOVE FD3-VAL-TMIN IN FD3 TO WSS-TMIN IN WSS-ACTI(WSS-IND)
               MOVE FD3-VAL-TMAX IN FD3 TO WSS-TMAX IN WSS-ACTI(WSS-IND)
               MOVE FD3-VAL-PPON IN FD3 TO WSS-TPPO IN WSS-ACTI(WSS-IND)
           ELSE
           IF FD3-COD-TIPO IN FD3 = 'B'
               MOVE FD3-VAL-MONT IN FD3 TO WSS-MONT IN WSS-PASI(WSS-IND)
               MOVE FD3-VAL-TMIN IN FD3 TO WSS-TMIN IN WSS-PASI(WSS-IND)
               MOVE FD3-VAL-TMAX IN FD3 TO WSS-TMAX IN WSS-PASI(WSS-IND)
               MOVE FD3-VAL-PPON IN FD3 TO WSS-TPPO IN WSS-PASI(WSS-IND)
           ELSE
               DISPLAY 'ERROR : REGISTRO CON SISTEMA EXTRANO '
                       '/ KEY : ' FD3-KEY-IFD3 IN FD3
               MOVE  1  TO WSS-IND-STAT IN WSS-VARI.
       FIN-PRO-FIL-VCPP.
           EXIT.
      ******************************************************************
      * Redondea en Miles ($) Montos Acumulados para el Reporte
       PRO-RND-VAL-RPT SECTION.
       INI-PRO-RND-VAL-RPT.
       PRO-RND-ACTI.
           DIVIDE WSS-MONT IN WSS-ACTI(WSS-IND) BY 1000 GIVING
                  WSS-RMON IN WSS-RACT(WSS-IND) ROUNDED.
           MOVE WSS-TMIN IN WSS-ACTI(WSS-IND) TO
                WSS-TMIN IN WSS-RACT(WSS-IND).
           MOVE WSS-TMAX IN WSS-ACTI(WSS-IND) TO
                WSS-TMAX IN WSS-RACT(WSS-IND).
           MOVE WSS-TPPO IN WSS-ACTI(WSS-IND) TO
                WSS-TPPO IN WSS-RACT(WSS-IND).
       PRO-RND-PASI.
           DIVIDE WSS-MONT IN WSS-PASI(WSS-IND) BY 1000 GIVING
                  WSS-RMON IN WSS-RPAS(WSS-IND) ROUNDED.
           MOVE WSS-TMIN IN WSS-PASI(WSS-IND) TO
                WSS-TMIN IN WSS-RPAS(WSS-IND).
           MOVE WSS-TMAX IN WSS-PASI(WSS-IND) TO
                WSS-TMAX IN WSS-RPAS(WSS-IND).
           MOVE WSS-TPPO IN WSS-PASI(WSS-IND) TO
                WSS-TPPO IN WSS-RPAS(WSS-IND).
       FIN-PRO-RND-VAL-RPT.
           EXIT.
      ******************************************************************
      * Totaliza Montos Acumulados Redondeados para el Reporte
       PRO-TOT-VAL-RPT SECTION.
       INI-PRO-TOT-VAL-RPT.
       PRO-TOT-ACTI.
           ADD WSS-RMON IN WSS-RACT(WSS-IND) TO WSS-TMON IN WSS-TRCN(1).
           ADD WSS-TMIN IN WSS-RACT(WSS-IND) TO WSS-TTMI IN WSS-TRCN(1).
           ADD WSS-TMAX IN WSS-RACT(WSS-IND) TO WSS-TTMA IN WSS-TRCN(1).
           ADD WSS-TPPO IN WSS-RACT(WSS-IND) TO WSS-TTPP IN WSS-TRCN(1).
       PRO-TOT-PASI.
           ADD WSS-RMON IN WSS-RPAS(WSS-IND) TO WSS-TMON IN WSS-TRCN(2).
           ADD WSS-TMIN IN WSS-RPAS(WSS-IND) TO WSS-TTMI IN WSS-TRCN(2).
           ADD WSS-TMAX IN WSS-RPAS(WSS-IND) TO WSS-TTMA IN WSS-TRCN(2).
           ADD WSS-TPPO IN WSS-RPAS(WSS-IND) TO WSS-TTPP IN WSS-TRCN(2).
       FIN-PRO-TOT-VAL-RPT.
           EXIT.
      ******************************************************************

       COPY TABBFUSR.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *>>>>

