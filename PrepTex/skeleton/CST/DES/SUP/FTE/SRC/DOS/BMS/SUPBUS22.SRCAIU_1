      * 10-Mar-94 12:28 PM
       RET-ALL-S22 SECTION.
       INI-RET-ALL-S22.
           PERFORM KEY-ALL-S22.
           PERFORM RET-D02-S22.
      *<<<< FIN_RET_ALL_S22
           PERFORM RET-ALL-S21.
      *>>>>
       FIN-RET-ALL-S22.
           EXIT.
       
       RET-D02-S22 SECTION.
       INI-RET-D02-S22.
           MOVE D02-COD-OFIC IN S22-FLD TO D02-COD-OFIC IN D02.
           MOVE D02-IND-ESTC IN S22-FLD TO D02-IND-ESTC IN D02.
           MOVE D02-COD-TCCO IN S22-FLD TO D02-COD-TCCO IN D02.
           MOVE D02-IND-ALGB IN S22-FLD TO D02-IND-ALGB IN D02.
           MOVE D02-NUM-DOTO IN S22-FLD TO D02-NUM-DOTO IN D02.
           MOVE D02-NUM-MOTO IN S22-FLD TO D02-NUM-MOTO IN D02.
           MOVE D02-NUM-AOTO IN S22-FLD TO D02-NUM-AOTO IN D02.
           MOVE D02-COD-LOCA IN S22-FLD TO D02-COD-LOCA IN D02.
           MOVE D02-NUM-DPVC IN S22-FLD TO D02-NUM-DPVC IN D02.
           MOVE D02-NUM-MPVC IN S22-FLD TO D02-NUM-MPVC IN D02.
           MOVE D02-NUM-APVC IN S22-FLD TO D02-NUM-APVC IN D02.
           MOVE D02-NUM-DEXT IN S22-FLD TO D02-NUM-DEXT IN D02.
           MOVE D02-NUM-MEXT IN S22-FLD TO D02-NUM-MEXT IN D02.
           MOVE D02-NUM-AEXT IN S22-FLD TO D02-NUM-AEXT IN D02.
           MOVE D02-COD-ACTD IN S22-FLD TO D02-COD-ACTD IN D02.
           MOVE D02-NUM-DUPI IN S22-FLD TO D02-NUM-DUPI IN D02.
           MOVE D02-NUM-MUPI IN S22-FLD TO D02-NUM-MUPI IN D02.
           MOVE D02-NUM-AUPI IN S22-FLD TO D02-NUM-AUPI IN D02.
           MOVE D02-IND-BCTI IN S22-FLD TO D02-IND-BCTI IN D02.
           MOVE D02-COD-MONE IN S22-FLD TO D02-COD-MONE IN D02.
           MOVE D02-VAL-TINT IN S22-FLD TO D02-VAL-TINT IN D02.
           MOVE D02-IND-SOPE IN S22-FLD TO D02-IND-SOPE IN D02.
           MOVE D02-IND-TCRE IN S22-FLD TO D02-IND-TCRE IN D02.
           MOVE D02-IND-TGAR IN S22-FLD TO D02-IND-TGAR IN D02.
           MOVE D02-NUM-VCIM IN S22-FLD TO D02-NUM-VCIM IN D02.
           MOVE D02-VAL-SMO1 IN S22-FLD TO D02-VAL-SMO1 IN D02.
           MOVE D02-NUM-NDPL IN S22-FLD TO D02-NUM-NDPL IN D02.
           MOVE D02-VAL-SMO2 IN S22-FLD TO D02-VAL-SMO2 IN D02.
           MOVE D02-NUM-DCRG IN S22-FLD TO D02-NUM-DCRG IN D02.
           MOVE D02-NUM-MCRG IN S22-FLD TO D02-NUM-MCRG IN D02.
           MOVE D02-NUM-ACRG IN S22-FLD TO D02-NUM-ACRG IN D02.
           MOVE D02-NUM-DUMO IN S22-FLD TO D02-NUM-DUMO IN D02.
           MOVE D02-NUM-MUMO IN S22-FLD TO D02-NUM-MUMO IN D02.
           MOVE D02-NUM-AUMO IN S22-FLD TO D02-NUM-AUMO IN D02.
           MOVE D02-COD-ACRG IN S22-FLD TO D02-COD-ACRG IN D02.
           MOVE D02-COD-AUMO IN S22-FLD TO D02-COD-AUMO IN D02.
           MOVE D02-IND-RUTD IN S22-FLD TO D02-IND-RUTD IN D02.
           MOVE D02-GLS-RUTD IN S22-FLD TO D02-GLS-RUTD IN D02.
           MOVE D02-IND-MAYD IN S22-FLD TO D02-IND-MAYD IN D02.
           MOVE D02-COD-ODSE IN S22-FLD TO D02-COD-ODSE IN D02.
           MOVE D02-IND-CCOM IN S22-FLD TO D02-IND-CCOM IN D02.
       FIN-RET-D02-S22.
           EXIT.
       
       KEY-ALL-S22 SECTION.
       INI-KEY-ALL-S22.
           PERFORM KEY-D02-S22.
       FIN-KEY-ALL-S22.
           EXIT.
       
       KEY-D02-S22 SECTION.
       INI-KEY-D02-S22.
      *<<<< FIN_KEY_D02_S22
           PERFORM KEY-D02-S21.
      *>>>>
       FIN-KEY-D02-S22.
           EXIT.
       
       SCR-CLRA-S22 SECTION.
       INI-SCR-CLRA-S22.
           PERFORM CLR-KEY-S22.
           PERFORM CLR-FLD-S22.
       FIN-SCR-CLRA-S22.
           EXIT.
       
       CLR-KEY-S22 SECTION.
       INI-CLR-KEY-S22.
       FIN-CLR-KEY-S22.
           EXIT.
       
       CLR-FLD-S22 SECTION.
       INI-CLR-FLD-S22.
           MOVE SPACES TO FRM-GLS-OFIC IN S22-FLD.
           MOVE SPACES TO FRM-GLS-ESTC IN S22-FLD.
           MOVE SPACES TO FRM-GLS-TCCO IN S22-FLD.
           MOVE SPACES TO FRM-GLS-LOCA IN S22-FLD.
           MOVE SPACES TO FRM-GLS-ACTD IN S22-FLD.
           MOVE SPACES TO FRM-GLS-BCTI IN S22-FLD.
           MOVE SPACES TO FRM-GLS-MONE IN S22-FLD.
           MOVE SPACES TO FRM-GLS-SOPE IN S22-FLD.
           MOVE SPACES TO FRM-GLS-TCRE IN S22-FLD.
           MOVE SPACES TO FRM-GLS-TGAR IN S22-FLD.
           MOVE SPACES TO FRM-GLS-ODSE IN S22-FLD.
           PERFORM CLR-D02-S22.
       FIN-CLR-FLD-S22.
           EXIT.
       
       CLR-D02-S22 SECTION.
       INI-CLR-D02-S22.
           MOVE SPACES TO D02-COD-OFIC IN S22-FLD.
           MOVE SPACES TO D02-IND-ESTC IN S22-FLD.
           MOVE SPACES TO D02-COD-TCCO IN S22-FLD.
           MOVE SPACES TO D02-IND-ALGB IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FOTO IN S22-FLD.
           MOVE SPACES TO D02-COD-LOCA IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FPVC IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FEXT IN S22-FLD.
           MOVE SPACES TO D02-COD-ACTD IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FUPI IN S22-FLD.
           MOVE SPACES TO D02-IND-BCTI IN S22-FLD.
           MOVE SPACES TO D02-COD-MONE IN S22-FLD.
           MOVE ZEROES TO D02-VAL-TINT IN S22-FLD.
           MOVE SPACES TO D02-IND-SOPE IN S22-FLD.
           MOVE SPACES TO D02-IND-TCRE IN S22-FLD.
           MOVE SPACES TO D02-IND-TGAR IN S22-FLD.
           MOVE ZEROES TO D02-NUM-VCIM IN S22-FLD.
           MOVE ZEROES TO D02-VAL-SMO1 IN S22-FLD.
           MOVE ZEROES TO D02-NUM-NDPL IN S22-FLD.
           MOVE ZEROES TO D02-VAL-SMO2 IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FCRG IN S22-FLD.
           MOVE ZEROES TO D02-DMA-FUMO IN S22-FLD.
           MOVE SPACES TO D02-COD-ACRG IN S22-FLD.
           MOVE SPACES TO D02-COD-AUMO IN S22-FLD.
           MOVE SPACES TO D02-IND-RUTD IN S22-FLD.
           MOVE SPACES TO D02-GLS-RUTD IN S22-FLD.
           MOVE SPACES TO D02-IND-MAYD IN S22-FLD.
           MOVE SPACES TO D02-COD-ODSE IN S22-FLD.
           MOVE SPACES TO D02-IND-CCOM IN S22-FLD.
       FIN-CLR-D02-S22.
           EXIT.
       
       FST-KEY-S22 SECTION.
       INI-FST-KEY-S22.
       FIN-FST-KEY-S22.
           EXIT.
       
       FST-FLD-S22 SECTION.
       INI-FST-FLD-S22.
           MOVE -1 TO D02-COD-OFIC-LEN IN S22-FLD.
       FIN-FST-FLD-S22.
           EXIT.
       
       PRO-KEY-S22 SECTION.
       INI-PRO-KEY-S22.
           PERFORM PRO-MKY-S22.
       FIN-PRO-KEY-S22.
           EXIT.
       
       PRO-MKY-S22 SECTION.
       INI-PRO-MKY-S22.
       FIN-PRO-MKY-S22.
           EXIT.
       
       PRO-FLD-S22 SECTION.
       INI-PRO-FLD-S22.
           PERFORM PRO-D02-S22.
       FIN-PRO-FLD-S22.
           EXIT.
       
       PRO-D02-S22 SECTION.
       INI-PRO-D02-S22.
           MOVE FRM-CPIM-AEY TO D02-COD-OFIC-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-ESTC-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-TCCO-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-ALGB-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-DMA-FOTO-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-LOCA-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-DMA-FPVC-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-DMA-FEXT-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-ACTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-DMA-FUPI-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-BCTI-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-MONE-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-TINT-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-SOPE-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-TCRE-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-TGAR-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-VCIM-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SMO1-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-NDPL-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SMO2-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-ACRG-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-AUMO-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-RUTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-GLS-RUTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-MAYD-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-ODSE-ATR IN S22-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-CCOM-ATR IN S22-FLD.
       FIN-PRO-D02-S22.
           EXIT.
       
       UNP-KEY-S22 SECTION.
       INI-UNP-KEY-S22.
           PERFORM UNP-IKY-S22.
           PERFORM UNP-AKY-S22.
           PERFORM UNP-MKY-S22.
       FIN-UNP-KEY-S22.
           EXIT.
       
       UNP-IKY-S22 SECTION.
       INI-UNP-IKY-S22.
       FIN-UNP-IKY-S22.
           EXIT.
       
       UNP-MKY-S22 SECTION.
       INI-UNP-MKY-S22.
       FIN-UNP-MKY-S22.
           EXIT.
       
       UNP-AKY-S22 SECTION.
       INI-UNP-AKY-S22.
       FIN-UNP-AKY-S22.
           EXIT.
       
       UNP-FLD-S22 SECTION.
       INI-UNP-FLD-S22.
           PERFORM UNP-D02-S22.
       FIN-UNP-FLD-S22.
           EXIT.
       
       UNP-D02-S22 SECTION.
       INI-UNP-D02-S22.
           MOVE FRM-CPIM-UBY TO D02-COD-OFIC-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-ESTC-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-TCCO-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-ALGB-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-DMA-FOTO-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-LOCA-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-DMA-FPVC-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-DMA-FEXT-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-ACTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-DMA-FUPI-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-BCTI-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-MONE-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-TINT-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-SOPE-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-TCRE-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-TGAR-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-VCIM-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SMO1-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-NUM-NDPL-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-VAL-SMO2-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-ACRG-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-AUMO-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-RUTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-GLS-RUTD-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-MAYD-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-COD-ODSE-ATR IN S22-FLD.
           MOVE FRM-CPIM-UBY TO D02-IND-CCOM-ATR IN S22-FLD.
       FIN-UNP-D02-S22.
           EXIT.
       
       VAL-MKY-S22 SECTION.
       INI-VAL-MKY-S22.
       FIN-VAL-MKY-S22.
           EXIT.
       
       VAL-FLD-S22 SECTION.
       INI-VAL-FLD-S22.
           PERFORM VAL-D02-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-OFIC-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-ESTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-ESTC-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFIC-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-ESTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ESTC-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-TCCO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-TCCO-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-ALGB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-ALGB-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-TCCO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TCCO-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FOTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FOTO-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-LOCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-LOCA-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FPVC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FPVC-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-LOCA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-LOCA-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FEXT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FEXT-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-ACTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-ACTD-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FUPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FUPI-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-ACTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ACTD-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-BCTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-BCTI-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-MONE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-MONE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-BCTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-BCTI-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-MONE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-MONE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-VAL-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-TINT-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-SOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-SOPE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-TCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-TCRE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-SOPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-SOPE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-TCRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TCRE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-TGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-TGAR-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-NUM-VCIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-VCIM-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-TGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TGAR-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-VAL-SMO1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SMO1-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-NUM-NDPL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-NUM-NDPL-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-VAL-SMO2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-VAL-SMO2-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FCRG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FCRG-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-DMA-FUMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-DMA-FUMO-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-ACRG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-ACRG-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-AUMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-AUMO-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-RUTD-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-GLS-RUTD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-GLS-RUTD-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-MAYD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-MAYD-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-COD-ODSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-COD-ODSE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-FRM-GLS-ODSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ODSE-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
           PERFORM VAL-D02-IND-CCOM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO D02-IND-CCOM-LEN IN S22-FLD
                GO TO FIN-VAL-FLD-S22.
       FIN-VAL-FLD-S22.
           EXIT.
       
       VAL-D02-COD-OFIC SECTION.
       INI-VAL-D02-COD-OFIC.
           IF D02-COD-OFIC IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-OFIC IN S22-FLD.
      *<<<< D02_COD_OFIC
           MOVE D02-COD-OFIC IN S22-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN S22-FLD.
      *>>>>
       FIN-VAL-D02-COD-OFIC.
           EXIT.
       
       VAL-D02-IND-ESTC SECTION.
       INI-VAL-D02-IND-ESTC.
           IF D02-IND-ESTC IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-ESTC IN S22-FLD.
      *<<<< D02_IND_ESTC
           IF D02-IND-ESTC IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'ESTC'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-ESTC IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-ESTC IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-ESTC IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTC IN S22-FLD.
      *>>>>
       FIN-VAL-D02-IND-ESTC.
           EXIT.
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-FRM-GLS-ESTC SECTION.
       INI-VAL-FRM-GLS-ESTC.
       FIN-VAL-FRM-GLS-ESTC.
           EXIT.
       
       VAL-D02-COD-TCCO SECTION.
       INI-VAL-D02-COD-TCCO.
           IF D02-COD-TCCO IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-TCCO IN S22-FLD.
      *<<<< D02_COD_TCCO
           IF D02-COD-TCCO IN S22-FLD > SPACES
               MOVE 'SUP'                   TO TAB-COD-SIST
               MOVE 'COL'                   TO TAB-COD-TTAB IN TAB
               MOVE D02-COD-TCCO IN S22-FLD TO TAB-COD-CTAB IN TAB
      *RCR         PERFORM VAL-TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCCO IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TCCO IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCCO IN S22-FLD.
      *>>>>
       FIN-VAL-D02-COD-TCCO.
           EXIT.
       
       VAL-D02-IND-ALGB SECTION.
       INI-VAL-D02-IND-ALGB.
           IF D02-IND-ALGB IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-ALGB IN S22-FLD.
      *<<<< D02_IND_ALGB
           IF D02-IND-ALGB IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'ALGB'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-ALGB IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *JJV Se elimina el IF ya que VAL-IND da un status de OK.
      *>>>>
       FIN-VAL-D02-IND-ALGB.
           EXIT.
       
       VAL-FRM-GLS-TCCO SECTION.
       INI-VAL-FRM-GLS-TCCO.
       FIN-VAL-FRM-GLS-TCCO.
           EXIT.
       
       VAL-D02-DMA-FOTO SECTION.
       INI-VAL-D02-DMA-FOTO.
      *VAL-FEC Validar Fecha
           MOVE D02-DMA-FOTO IN S22-FLD TO FEC-FECH.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D02-DMA-FOTO IN S22-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D02-DMA-FOTO.
       FIN-VAL-D02-DMA-FOTO.
           EXIT.
       
       VAL-D02-COD-LOCA SECTION.
       INI-VAL-D02-COD-LOCA.
           IF D02-COD-LOCA IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-LOCA IN S22-FLD.
      *<<<< D02_COD_LOCA
           MOVE D02-COD-LOCA IN S22-FLD TO WSS-COD-LOCA IN WSS-VARI-S22.
           MOVE 'TAB'                        TO TAB-COD-SIST.
           MOVE 'COM'                        TO TAB-EXT-TTAB IN TAB.
           MOVE WSS-COD-PLZA IN WSS-VARI-S22 TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB TO COM
               IF WSS-COD-REGI = COM-COD-REGI
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCA IN S22-FLD
               ELSE
                   MOVE FRM-SUAR-MAL         TO FRM-SUAR
                   MOVE 'CODIGO INEXISTENTE' TO FRM-MENS
                   MOVE SPACES TO FRM-GLS-LOCA IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LOCA IN S22-FLD.
      *>>>>
       FIN-VAL-D02-COD-LOCA.
           EXIT.
       
       VAL-D02-DMA-FPVC SECTION.
       INI-VAL-D02-DMA-FPVC.
      *VAL-FEC Validar Fecha
           MOVE D02-DMA-FPVC IN S22-FLD TO FEC-FECH.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_D02_DMA_FPVC
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D02-DMA-FPVC IN S22-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D02-DMA-FPVC.
       FIN-VAL-D02-DMA-FPVC.
           EXIT.
       
       VAL-FRM-GLS-LOCA SECTION.
       INI-VAL-FRM-GLS-LOCA.
       FIN-VAL-FRM-GLS-LOCA.
           EXIT.
       
       VAL-D02-DMA-FEXT SECTION.
       INI-VAL-D02-DMA-FEXT.
      *VAL-FEC Validar Fecha
           MOVE D02-DMA-FEXT IN S22-FLD TO FEC-FECH.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_D02_DMA_FEXT
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D02-DMA-FEXT IN S22-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D02-DMA-FEXT.
       FIN-VAL-D02-DMA-FEXT.
           EXIT.
       
       VAL-D02-COD-ACTD SECTION.
       INI-VAL-D02-COD-ACTD.
           IF D02-COD-ACTD IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-ACTD IN S22-FLD.
      *<<<< D02_COD_ACTD
           IF D02-COD-ACTD IN S22-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'ACT'                   TO TAB-EXT-TTAB IN TAB
               MOVE D02-COD-ACTD IN S22-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTD IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-ACTD IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACTD IN S22-FLD.
      *>>>>
       FIN-VAL-D02-COD-ACTD.
           EXIT.
       
       VAL-D02-DMA-FUPI SECTION.
       INI-VAL-D02-DMA-FUPI.
      *VAL-FEC Validar Fecha
           MOVE D02-DMA-FUPI IN S22-FLD TO FEC-FECH.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO D02-DMA-FUPI IN S22-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-D02-DMA-FUPI.
       FIN-VAL-D02-DMA-FUPI.
           EXIT.
       
       VAL-FRM-GLS-ACTD SECTION.
       INI-VAL-FRM-GLS-ACTD.
       FIN-VAL-FRM-GLS-ACTD.
           EXIT.
       
       VAL-D02-IND-BCTI SECTION.
       INI-VAL-D02-IND-BCTI.
           IF D02-IND-BCTI IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-BCTI IN S22-FLD.
      *<<<< D02_IND_BCTI
           IF D02-IND-BCTI IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-BCTI IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-BCTI IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-BCTI IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-BCTI IN S22-FLD.
      *>>>>
       FIN-VAL-D02-IND-BCTI.
           EXIT.
       
       VAL-D02-COD-MONE SECTION.
       INI-VAL-D02-COD-MONE.
           IF D02-COD-MONE IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-MONE IN S22-FLD.
      *>>>> D02_COD_MONE
           IF D02-COD-MONE IN S22-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'VLR'                   TO TAB-EXT-TTAB IN TAB
               MOVE D02-COD-MONE IN S22-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-MONE IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-MONE IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MONE IN S22-FLD.
      *>>>>
       FIN-VAL-D02-COD-MONE.
           EXIT.
       
       VAL-FRM-GLS-BCTI SECTION.
       INI-VAL-FRM-GLS-BCTI.
       FIN-VAL-FRM-GLS-BCTI.
           EXIT.
       
       VAL-FRM-GLS-MONE SECTION.
       INI-VAL-FRM-GLS-MONE.
       FIN-VAL-FRM-GLS-MONE.
           EXIT.
       
       VAL-D02-VAL-TINT SECTION.
       INI-VAL-D02-VAL-TINT.
       FIN-VAL-D02-VAL-TINT.
           EXIT.
       
       VAL-D02-IND-SOPE SECTION.
       INI-VAL-D02-IND-SOPE.
           IF D02-IND-SOPE IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-SOPE IN S22-FLD.
      *<<<< D02_IND_SOPE
           IF D02-IND-SOPE IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'SOPE'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-SOPE IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SOPE IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-SOPE IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN S22-FLD.
      *>>>>
       FIN-VAL-D02-IND-SOPE.
           EXIT.
       
       VAL-D02-IND-TCRE SECTION.
       INI-VAL-D02-IND-TCRE.
           IF D02-IND-TCRE IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-TCRE IN S22-FLD.
      *<<<< D02_IND_TCRE
           IF D02-IND-TCRE IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'TCRE'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-TCRE IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TCRE IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TCRE IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCRE IN S22-FLD.
      *>>>>
       FIN-VAL-D02-IND-TCRE.
           EXIT.
       
       VAL-FRM-GLS-SOPE SECTION.
       INI-VAL-FRM-GLS-SOPE.
       FIN-VAL-FRM-GLS-SOPE.
           EXIT.
       
       VAL-FRM-GLS-TCRE SECTION.
       INI-VAL-FRM-GLS-TCRE.
       FIN-VAL-FRM-GLS-TCRE.
           EXIT.
       
       VAL-D02-IND-TGAR SECTION.
       INI-VAL-D02-IND-TGAR.
           IF D02-IND-TGAR IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-TGAR IN S22-FLD.
      *<<<< D02_IND_TGAR
           IF D02-IND-TGAR IN S22-FLD > SPACES
               MOVE 'SUP'                   TO MSC-COD-SIST
               MOVE 'TGAR'                  TO MSC-COD-TMSC IN MSC
               MOVE D02-IND-TGAR IN S22-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TGAR IN S22-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TGAR IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TGAR IN S22-FLD.
      *>>>>
       FIN-VAL-D02-IND-TGAR.
           EXIT.
       
       VAL-D02-NUM-VCIM SECTION.
       INI-VAL-D02-NUM-VCIM.
       FIN-VAL-D02-NUM-VCIM.
           EXIT.
       
       VAL-FRM-GLS-TGAR SECTION.
       INI-VAL-FRM-GLS-TGAR.
       FIN-VAL-FRM-GLS-TGAR.
           EXIT.
       
       VAL-D02-VAL-SMO1 SECTION.
       INI-VAL-D02-VAL-SMO1.
       FIN-VAL-D02-VAL-SMO1.
           EXIT.
       
       VAL-D02-NUM-NDPL SECTION.
       INI-VAL-D02-NUM-NDPL.
       FIN-VAL-D02-NUM-NDPL.
           EXIT.
       
       VAL-D02-VAL-SMO2 SECTION.
       INI-VAL-D02-VAL-SMO2.
       FIN-VAL-D02-VAL-SMO2.
           EXIT.
       
       VAL-D02-DMA-FCRG SECTION.
       INI-VAL-D02-DMA-FCRG.
           IF D02-DMA-FCRG IN S22-FLD NOT > ZEROES
              MOVE ZEROES TO D02-DMA-FCRG IN S22-FLD.
       FIN-VAL-D02-DMA-FCRG.
           EXIT.
       
       VAL-D02-DMA-FUMO SECTION.
       INI-VAL-D02-DMA-FUMO.
           IF D02-DMA-FUMO IN S22-FLD NOT > ZEROES
              MOVE ZEROES TO D02-DMA-FUMO IN S22-FLD.
       FIN-VAL-D02-DMA-FUMO.
           EXIT.
       
       VAL-D02-COD-ACRG SECTION.
       INI-VAL-D02-COD-ACRG.
           IF D02-COD-ACRG IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-ACRG IN S22-FLD.
      *<<<< D02_COD_ACRG
      *VAL-USR Valida Usuario
           MOVE  D02-COD-ACRG IN S22-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD ini
      *     IF MSG-COD-MENS NOT = 'COD    NEX'
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN S22-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-ACRG IN S22-FLD.
      *DAD fin
      *>>>>
       FIN-VAL-D02-COD-ACRG.
           EXIT.
       
       VAL-D02-COD-AUMO SECTION.
       INI-VAL-D02-COD-AUMO.
           IF D02-COD-AUMO IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-AUMO IN S22-FLD.
      *<<<< D02_COD_AUMO
      *VAL-USR Valida Usuario
           MOVE  D02-COD-AUMO IN S22-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD ini
      *     IF MSG-COD-MENS NOT = 'COD    NEX'
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN S22-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-AUMO IN S22-FLD.
      *DAD fin
      *>>>>
       FIN-VAL-D02-COD-AUMO.
           EXIT.
       
       VAL-D02-IND-RUTD SECTION.
       INI-VAL-D02-IND-RUTD.
           IF D02-IND-RUTD IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-RUTD IN S22-FLD.
      *<<<< D02_IND_RUTD
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'GNS'                   TO MSC-COD-SIST.
           MOVE 'IRUT'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-RUTD IN S22-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-D02-IND-RUTD.
           EXIT.
       
       VAL-D02-GLS-RUTD SECTION.
       INI-VAL-D02-GLS-RUTD.
           IF D02-GLS-RUTD IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-GLS-RUTD IN S22-FLD.
      *<<<< D02_GLS_RUTD
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador
      *    MOVE D02-GLS-RUTD IN S22-FLD TO IDC-GLS-RUTV.
      *    PERFORM VAL-GLS.
      *>>>>
       FIN-VAL-D02-GLS-RUTD.
           EXIT.
       
       VAL-D02-IND-MAYD SECTION.
       INI-VAL-D02-IND-MAYD.
           IF D02-IND-MAYD IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-MAYD IN S22-FLD.
      *<<<< D02_IND_MAYD
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'MAYD'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-MAYD IN S22-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *JJV Se elimina el IF ya que VAL-IND da un status de OK.
      *>>>>
       FIN-VAL-D02-IND-MAYD.
           EXIT.
       
       VAL-D02-COD-ODSE SECTION.
       INI-VAL-D02-COD-ODSE.
           IF D02-COD-ODSE IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-COD-ODSE IN S22-FLD.
      *>>>> D02_COD_ODSE
      *DAD ini
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'ODS'                   TO TAB-EXT-TTAB IN TAB.
           MOVE D02-COD-ODSE IN S22-FLD TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-ODSE IN S22-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ODSE IN S22-FLD.
      *DAD fin
      *>>>>
       FIN-VAL-D02-COD-ODSE.
           EXIT.
       
       VAL-FRM-GLS-ODSE SECTION.
       INI-VAL-FRM-GLS-ODSE.
       FIN-VAL-FRM-GLS-ODSE.
           EXIT.
       
       VAL-D02-IND-CCOM SECTION.
       INI-VAL-D02-IND-CCOM.
           IF D02-IND-CCOM IN S22-FLD NOT > SPACES
              MOVE SPACES TO D02-IND-CCOM IN S22-FLD.
      *<<<< D02_IND_CCOM
      *DAD ini
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'SGC'                   TO MSC-COD-SIST.
           MOVE 'RIES'                  TO MSC-EXT-TMSC IN MSC.
           MOVE D02-IND-CCOM IN S22-FLD TO MSC-EXT-CMSC IN MSC.
           MOVE 'MSC-EXT-TABL' TO FIO-AKEY
           PERFORM VAL-IND.
      *DAD fin
      *>>>>
       FIN-VAL-D02-IND-CCOM.
           EXIT.
       
       VAL-CON-FLD-S22 SECTION.
       INI-VAL-CON-FLD-S22.
      *<<<< VAL_CON_FLD_S22
       VAL-FUPI-FOTO.
           IF D02-DMA-FUPI IN S22-FLD = ZEROES
               GO TO VAL-FPVC-FUPI.
           MOVE D02-DMA-FOTO IN S22-FLD TO FEC-FEC1.
           MOVE D02-DMA-FUPI IN S22-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'FECFUPIFOTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S22.

      *RCR Validacion de fecha de extincion sea > que fecha otorgamiento
       VAL-FEXT-FOTO.
           IF D02-DMA-FEXT IN S22-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD-S22.
           MOVE D02-DMA-FOTO IN S22-FLD TO FEC-FEC1.
           MOVE D02-DMA-FEXT IN S22-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'FECFEXTFOTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR.

       VAL-FPVC-FUPI.
           IF D02-DMA-FPVC IN S22-FLD = ZEROES
               GO TO VAL-FPVC-FEXT.
           MOVE D02-DMA-FUPI IN S22-FLD TO FEC-FEC1.
           MOVE D02-DMA-FPVC IN S22-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'FECFPVCFUPI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       VAL-FPVC-FEXT.
           IF D02-DMA-FEXT IN S22-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD-S22.
      *DAD ini  24-FEB-1992
      *     MOVE D02-DMA-FPVC IN S22-FLD TO FEC-FEC1.
      *     MOVE D02-DMA-FEXT IN S22-FLD TO FEC-FEC2.
      *     MOVE FEC-FORM-FEC TO FEC-FORM.
      *     MOVE FEC-CMP-FEC  TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF FEC-STAT-GRT
      *         MOVE 'SUP'         TO MSG-COD-SIST
      *         MOVE 'FECFEXTFPVC' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD fin  24-FEB-1992
      *>>>>
       FIN-VAL-CON-FLD-S22.
           EXIT.
       
       VAL-CON-S22 SECTION.
       INI-VAL-CON-S22.
       FIN-VAL-CON-S22.
           EXIT.
       
       VAL-NUM-KEY-S22 SECTION.
       INI-VAL-NUM-KEY-S22.
           PERFORM VAL-NUM-IKY-S22.
           PERFORM VAL-NUM-MKY-S22.
           PERFORM VAL-NUM-AKY-S22.
       FIN-VAL-NUM-KEY-S22.
           EXIT.
       
       VAL-NUM-IKY-S22 SECTION.
       INI-VAL-NUM-IKY-S22.
       FIN-VAL-NUM-IKY-S22.
           EXIT.
       
       VAL-NUM-MKY-S22 SECTION.
       INI-VAL-NUM-MKY-S22.
       FIN-VAL-NUM-MKY-S22.
           EXIT.
       
       VAL-NUM-AKY-S22 SECTION.
       INI-VAL-NUM-AKY-S22.
       FIN-VAL-NUM-AKY-S22.
           EXIT.
       
       VAL-NUM-FLD-S22 SECTION.
       INI-VAL-NUM-FLD-S22.
       VAL-NUM-D02-VAL-TINT.
           MOVE D02-VAL-TINT-ALF IN S22-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-TINT IN S22-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-TINT-LEN IN S22-FLD
                GO TO FIN-VAL-NUM-FLD-S22.
       VAL-NUM-D02-NUM-VCIM.
           MOVE D02-NUM-VCIM-ALF IN S22-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-VCIM IN S22-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-VCIM-LEN IN S22-FLD
                GO TO FIN-VAL-NUM-FLD-S22.
       VAL-NUM-D02-VAL-SMO1.
           MOVE D02-VAL-SMO1-ALF IN S22-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SMO1 IN S22-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SMO1-LEN IN S22-FLD
                GO TO FIN-VAL-NUM-FLD-S22.
       VAL-NUM-D02-NUM-NDPL.
           MOVE D02-NUM-NDPL-ALF IN S22-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO D02-NUM-NDPL IN S22-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-NUM-NDPL-LEN IN S22-FLD
                GO TO FIN-VAL-NUM-FLD-S22.
       VAL-NUM-D02-VAL-SMO2.
           MOVE D02-VAL-SMO2-ALF IN S22-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO D02-VAL-SMO2 IN S22-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO D02-VAL-SMO2-LEN IN S22-FLD
                GO TO FIN-VAL-NUM-FLD-S22.
       FIN-VAL-NUM-FLD-S22.
           EXIT.
       
       EDT-KEY-S22 SECTION.
       INI-EDT-KEY-S22.
           PERFORM EDT-IKY-S22.
           PERFORM EDT-MKY-S22.
           PERFORM EDT-AKY-S22.
       FIN-EDT-KEY-S22.
           EXIT.
       
       EDT-IKY-S22 SECTION.
       INI-EDT-IKY-S22.
       FIN-EDT-IKY-S22.
           EXIT.
       
       EDT-MKY-S22 SECTION.
       INI-EDT-MKY-S22.
       FIN-EDT-MKY-S22.
           EXIT.
       
       EDT-AKY-S22 SECTION.
       INI-EDT-AKY-S22.
       FIN-EDT-AKY-S22.
           EXIT.
       
       EDT-FLD-S22 SECTION.
       INI-EDT-FLD-S22.
           IF D02-VAL-TINT-LEN IN S22-FLD = -9
                MOVE -1 TO D02-VAL-TINT-LEN IN S22-FLD
                GO TO FIN-EDT-FLD-S22.
           MOVE D02-VAL-TINT IN S22-FLD TO D02-VAL-TINT-EDT IN S22-EDT.
           MOVE D02-VAL-TINT-EDT IN S22-EDT TO 
                D02-VAL-TINT-ALF IN S22-FLD.
           IF D02-NUM-VCIM-LEN IN S22-FLD = -9
                MOVE -1 TO D02-NUM-VCIM-LEN IN S22-FLD
                GO TO FIN-EDT-FLD-S22.
           MOVE D02-NUM-VCIM IN S22-FLD TO D02-NUM-VCIM-EDT IN S22-EDT.
           MOVE D02-NUM-VCIM-EDT IN S22-EDT TO 
                D02-NUM-VCIM-ALF IN S22-FLD.
           IF D02-VAL-SMO1-LEN IN S22-FLD = -9
                MOVE -1 TO D02-VAL-SMO1-LEN IN S22-FLD
                GO TO FIN-EDT-FLD-S22.
           MOVE D02-VAL-SMO1 IN S22-FLD TO D02-VAL-SMO1-EDT IN S22-EDT.
           MOVE D02-VAL-SMO1-EDT IN S22-EDT TO 
                D02-VAL-SMO1-ALF IN S22-FLD.
           IF D02-NUM-NDPL-LEN IN S22-FLD = -9
                MOVE -1 TO D02-NUM-NDPL-LEN IN S22-FLD
                GO TO FIN-EDT-FLD-S22.
           MOVE D02-NUM-NDPL IN S22-FLD TO D02-NUM-NDPL-EDT IN S22-EDT.
           MOVE D02-NUM-NDPL-EDT IN S22-EDT TO 
                D02-NUM-NDPL-ALF IN S22-FLD.
           IF D02-VAL-SMO2-LEN IN S22-FLD = -9
                MOVE -1 TO D02-VAL-SMO2-LEN IN S22-FLD
                GO TO FIN-EDT-FLD-S22.
           MOVE D02-VAL-SMO2 IN S22-FLD TO D02-VAL-SMO2-EDT IN S22-EDT.
           MOVE D02-VAL-SMO2-EDT IN S22-EDT TO 
                D02-VAL-SMO2-ALF IN S22-FLD.
       FIN-EDT-FLD-S22.
           EXIT.
