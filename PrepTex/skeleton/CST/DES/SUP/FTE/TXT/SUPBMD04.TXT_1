*%! Codigo adicional para archivo
*% IF INI_PUT_D04_D04
      *<<<< INI_PUT_D04_D04
      *>>>>
*% END
*% IF FIN_PUT_D04_D04
      *<<<< FIN_PUT_D04_D04
      * Obtencion de Glosa de Localidad del Cliente
      *BUS-TAB busca glosa de codigo en tabla, con codigo externo
           IF D04-COD-LOCA IN D04-FLD > SPACES
               MOVE D04-COD-LOCA IN D04-FLD  TO WSS-COD-LOCA IN WSS-VARI
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'COM'                    TO TAB-EXT-TTAB IN TAB
               MOVE WSS-COD-PLZA IN WSS-VARI TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCA IN D04-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LOCA IN D04-FLD.
      *
      * Obtencion de Glosa de Localidad de la Oficina
      *BUS-TAB busca glosa de codigo en tabla, con codigo externo
           IF D04-COD-LOCO IN D04-FLD > SPACES
               MOVE D04-COD-LOCO IN D04-FLD  TO WSS-COD-LOCA IN WSS-VARI
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'COM'                    TO TAB-EXT-TTAB IN TAB
               MOVE WSS-COD-PLZA IN WSS-VARI TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCO IN D04-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LOCO IN D04-FLD.
      *>>>>
*% END
*% IF D04_GLS_NOMC
      *<<<< D04_GLS_NOMC
           IF D04-GLS-NOMC IN D04-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF D04_NUM_RUTC
      *<<<< D04_NUM_RUTC
      *>>>>
*% END
*% IF D04_VRF_RUTC
      *<<<< D04_VRF_RUTC
      *>>>>
*% END
*% IF D04_COD_NIIC
      *<<<< D04_COD_NIIC
           IF D04-COD-NIIC IN D04-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF D04_IND_CAJU
      *<<<< D04_IND_CAJU
      *>>>>
*% END
*% IF D04_IND_TCLI
      *<<<< D04_IND_TCLI
      *>>>>
*% END
*% IF FRM_GLS_CAJU
      *<<<< FRM_GLS_CAJU
      *>>>>
*% END
*% IF FRM_GLS_TCLI
      *<<<< FRM_GLS_TCLI
      *>>>>
*% END
*% IF D04_IND_TRCB
      *<<<< D04_IND_TRCB
      *>>>>
*% END
*% IF D04_IND_CATE
      *<<<< D04_IND_CATE
      *>>>>
*% END
*% IF FRM_GLS_TRCB
      *<<<< FRM_GLS_TRCB
      *>>>>
*% END
*% IF FRM_GLS_CATE
      *<<<< FRM_GLS_CATE
      *>>>>
*% END
*% IF D04_COD_ODSE
      *<<<< D04_COD_ODSE
      *>>>>
*% END
*% IF D04_IND_ESTA
      *<<<< D04_IND_ESTA
      *>>>>
*% END
*% IF FRM_GLS_ODSE
      *<<<< FRM_GLS_ODSE
      *>>>>
*% END
*% IF FRM_GLS_ESTA
      *<<<< FRM_GLS_ESTA
      *>>>>
*% END
*% IF D04_COD_LOCA
      *<<<< D04_COD_LOCA
      * Validacion del Codigo de Localidad del Cliente
      *VAL-COD Valida codigo ( externo ) de tabla
           MOVE D04-COD-LOCA IN D04-FLD  TO WSS-COD-LOCA IN WSS-VARI.
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'COM'                    TO TAB-EXT-TTAB IN TAB.
           MOVE WSS-COD-PLZA IN WSS-VARI TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              D04-COD-LOCA IN D04-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LOCA IN D04-FLD
           ELSE
               MOVE TAB TO COM
               IF COM-COD-REGI IN COM = WSS-COD-REGI
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCA IN D04-FLD
               ELSE
                   MOVE FRM-SUAR-MAL         TO FRM-SUAR
                   MOVE 'CODIGO INEXISTENTE' TO FRM-MENS
                   MOVE SPACES               TO FRM-GLS-LOCA IN D04-FLD.
      *>>>>
*% END
*% IF D04_COD_LOCO
      *<<<< D04_COD_LOCO
      * Validacion del Codigo de Localidad de la Oficina
      *VAL-COD Valida codigo ( externo ) de tabla
           MOVE D04-COD-LOCO IN D04-FLD  TO WSS-COD-LOCA IN WSS-VARI.
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'COM'                    TO TAB-EXT-TTAB IN TAB.
           MOVE WSS-COD-PLZA IN WSS-VARI TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              D04-COD-LOCO IN D04-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LOCO IN D04-FLD
           ELSE
               MOVE TAB TO COM
               IF COM-COD-REGI IN COM = WSS-COD-REGI
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LOCO IN D04-FLD
               ELSE
                   MOVE FRM-SUAR-MAL         TO FRM-SUAR
                   MOVE 'CODIGO INEXISTENTE' TO FRM-MENS
                   MOVE SPACES               TO FRM-GLS-LOCO IN D04-FLD.
      *>>>>
*% END
*% IF FRM_GLS_LOCA
      *<<<< FRM_GLS_LOCA
      *>>>>
*% END
*% IF FRM_GLS_LOCO
      *<<<< FRM_GLS_LOCO
      *>>>>
*% END
*% IF D04_IND_TCAP
      *<<<< D04_IND_TCAP
           MOVE D04-IND-TCAP IN D04-FLD TO WSS-IND-TCAP IN WSS-VARI.
           IF NOT VAL-TCAP
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'TCAPNOVALD04' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE WSS-IND-TCAP TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-D04-IND-TCAP.
      *>>>>
*% END
*% IF D04_IND_BCTI
      *<<<< D04_IND_BCTI
      *>>>>
*% END
*% IF FRM_GLS_TCAP
      *<<<< FRM_GLS_TCAP
      *>>>>
*% END
*% IF FRM_GLS_BCTI
      *<<<< FRM_GLS_BCTI
      *>>>>
*% END
*% IF D04_COD_MCAP
      *<<<< D04_COD_MCAP
      *>>>>
*% END
*% IF D04_COD_MINT
      *<<<< D04_COD_MINT
      *>>>>
*% END
*% IF FRM_GLS_MCAP
      *<<<< FRM_GLS_MCAP
      *>>>>
*% END
*% IF FRM_GLS_MINT
      *<<<< FRM_GLS_MINT
      *>>>>
*% END
*% IF D04_VAL_MCAP
      *<<<< D04_VAL_MCAP
      *>>>>
*% END
*% IF INI_D04_DMA_FOCA
      *<<<< INI_D04_DMA_FOCA
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D04_DMA_FOCA
      *<<<< D04_DMA_FOCA
      *>>>>
*% END
*% IF D04_VAL_SCAP
      *<<<< D04_VAL_SCAP
      *>>>>
*% END
*% IF INI_D04_DMA_FPVE
      *<<<< INI_D04_DMA_FPVE
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D04_DMA_FPVE
      *<<<< D04_DMA_FPVE
      *>>>>
*% END
*% IF D04_VAL_IPPA
      *<<<< D04_VAL_IPPA
      *>>>>
*% END
*% IF INI_D04_DMA_FXVE
      *<<<< INI_D04_DMA_FXVE
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D04_DMA_FXVE
      *<<<< D04_DMA_FXVE
      *>>>>
*% END
*% IF D04_VAL_TINT
      *<<<< D04_VAL_TINT
      *>>>>
*% END
*% IF INI_D04_DMA_FEXT
      *<<<< INI_D04_DMA_FEXT
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D04_DMA_FEXT
      *<<<< D04_DMA_FEXT
      *>>>>
*% END
*% IF VAL_CON_FLD_D04
      *<<<< VAL_CON_FLD_D04
       VAL-FOCA-FPVE.
           MOVE D04-DMA-FOCA IN D04-FLD TO FEC-FEC1.
           MOVE D04-DMA-FPVE IN D04-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'FOCANOT<FPVE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D04.
       VAL-FPVE-FXVE.
           MOVE D04-DMA-FPVE IN D04-FLD TO FEC-FEC1.
           MOVE D04-DMA-FXVE IN D04-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'FECFPVE>FXVE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D04.
       VAL-FXVE-FEXT.
           MOVE D04-DMA-FXVE IN D04-FLD TO FEC-FEC1.
           MOVE D04-DMA-FEXT IN D04-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'FECFXVE>FEXT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D04.
       VAL-TBL-DCLI.
           MOVE D04-IND-TCLI IN D04-FLD TO WSS-IND-TCLI IN WSS-VARI.
           MOVE D04-IND-CAJU IN D04-FLD TO WSS-IND-CAJU IN WSS-VARI.
           MOVE D04-IND-CATE IN D04-FLD TO WSS-IND-CATE IN WSS-VARI.
           MOVE D04-COD-ODSE IN D04-FLD TO WSS-COD-ODSE IN WSS-VARI.
           MOVE D04-IND-ESTA IN D04-FLD TO WSS-IND-ESTA IN WSS-VARI.
           IF VAL-TCLI1
               IF VAL-CAJU1
                   IF VAL-CATE3 AND VAL-ODSE1
                       GO TO FIN-VAL-CON-FLD-D04
                   ELSE
                       NEXT SENTENCE
               ELSE
      *        IF NOT VAL-CAJU1
                   IF NOT (VAL-CATE3 OR VAL-ODSE2 OR VAL-ODSE3)
                       GO TO FIN-VAL-CON-FLD-D04
                   ELSE
                       NEXT SENTENCE
           ELSE
           IF VAL-TCLI2
               IF VAL-CAJU3 AND VAL-CATE2 AND VAL-ODSE2 AND VAL-ESTA4
                   GO TO FIN-VAL-CON-FLD-D04
               ELSE
                   NEXT SENTENCE
           ELSE
           IF VAL-TCLI3
               IF NOT VAL-CAJU1 AND VAL-CATE2 AND VAL-ODSE3
                   GO TO FIN-VAL-CON-FLD-D04.
           MOVE 'SUP'          TO MSG-COD-SIST.
           MOVE 'CONDATOCLIEN' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE WSS-TBL-DCLI TO FRM-MEN2.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           GO TO FIN-VAL-CON-FLD-D04.
      *>>>>
*% END
*% IF VAL_CON_D04
      *<<<< VAL_CON_D04
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *>>>>
*% END
