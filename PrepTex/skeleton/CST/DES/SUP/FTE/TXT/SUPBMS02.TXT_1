*%! Codigo adicional 
*% IF FIN_PUT_ALL_S02
      *<<<< FIN_PUT_ALL_S02
       GET-FRM-GLS-SOPE.
           IF D00-IND-SOPE IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'SOPE' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-SOPE IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SOPE IN S02-FLD.

       GET-FRM-GLS-TGAR.
           IF D00-COD-TGAR IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'TGAR' TO MSC-COD-TMSC IN MSC
               MOVE D00-COD-TGAR IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TGAR IN S02-FLD.

       GET-FRM-GLS-OFIC.
               MOVE D00-COD-OFIC IN S02-FLD TO OFI-COD-OFIC IN OFI.
               PERFORM BUS-OFI.
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN S02-FLD.

       GET-FRM-GLS-ESTC.
           IF D00-IND-ESTC IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'ESTC' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-ESTC IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-ESTC IN S02-FLD.

       GET-FRM-GLS-ACTD.
           IF D00-COD-ACTD IN S02-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-EXT-TTAB IN TAB
               MOVE D00-COD-ACTD IN S02-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTD IN S02-FLD.

       GET-FRM-GLS-BCTI.
           IF D00-IND-BCTI IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'BCTI' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-BCTI IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-BCTI IN S02-FLD.

       GET-FRM-GLS-ACRG.
               MOVE D00-COD-ACRG IN S02-FLD TO USR-COD-USER IN USR.
               PERFORM BUS-USR.
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN S02-FLD.

       GET-FRM-GLS-AUMO.
               MOVE D00-COD-AUMO IN S02-FLD TO USR-COD-USER IN USR.
               PERFORM BUS-USR.
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN S02-FLD.
      *>>>>
*% END
*% IF FIN_KEY_D00_S02
      *<<<< FIN_KEY_D00_S02
           PERFORM KEY-D00-S01.
      *>>>>
*% END
*% IF D00_IND_SOPE
      *<<<< D00_IND_SOPE
      *VAL-MSC Valida miscelaneo de tabla
           IF D00-IND-SOPE IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'SOPE' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-SOPE IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SOPE IN S02-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-SOPE IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SOPE IN S02-FLD.
      *>>>>
*% END
*% IF D00_COD_TGAR
      *<<<< D00_COD_TGAR
      *VAL-COD Valida codigo de tabla
           IF D00-COD-TGAR IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'TGAR' TO MSC-COD-TMSC IN MSC
               MOVE D00-COD-TGAR IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TGAR IN S02-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TGAR IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TGAR IN S02-FLD.
      *>>>>
*% END
*% IF D00_COD_OFIC
      *<<<< D00_COD_OFIC
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE D00-COD-OFIC IN S02-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN S02-FLD.
      *>>>>
*% END
*% IF D00_IND_ESTC
      *<<<< D00_IND_ESTC
      *VAL-MSC Valida miscelaneo de tabla
           IF D00-IND-ESTC IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'ESTC' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-ESTC IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-ESTC IN S02-FLD
               ELSE
                  MOVE SPACES TO FRM-GLS-ESTC IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTC IN S02-FLD.
      *>>>>
*% END
*% IF D00_COD_ACTD
      *<<<< D00_COD_ACTD
      *VAL-COD Valida codigo de tabla
           IF D00-COD-ACTD IN S02-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-EXT-TTAB IN TAB
               MOVE D00-COD-ACTD IN S02-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTD IN S02-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-ACTD IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACTD IN S02-FLD.
      *>>>>
*% END
*% IF D00_IND_BCTI
      *<<<< D00_IND_BCTI
      *VAL-MSC Valida miscelaneo de tabla
           IF D00-IND-BCTI IN S02-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'BCTI' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-BCTI IN S02-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-BCTI IN S02-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-BCTI IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-BCTI IN S02-FLD.
      *>>>>
*% END
*% IF INI_D00_DMA_FEXT
      *<<<< INI_D00_DMA_FEXT
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF INI_D00_DMA_FUPI
      *<<<< INI_D00_DMA_FUPI
           MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF D00_COD_ACRG
      *<<<< D00_COD_ACRG
      *VAL-USR Valida Usuario
           MOVE D00-COD-ACRG IN S02-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACRG IN S02-FLD.
      *>>>>
*% END
*% IF D00_COD_AUMO
      *<<<< D00_COD_AUMO
      *VAL-USR Valida Usuario
           MOVE D00-COD-AUMO IN S02-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN S02-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AUMO IN S02-FLD.
      *>>>>
*% END
*% IF VAL_CON_FLD_S02
      *<<<< VAL_CON_FLD_S02
      *JJV 03/02/88
       VAL-FUPI-FOTO.
           IF D00-DMA-FUPI IN S02-FLD = ZEROES
               GO TO VAL-FEXT-FOTO.
           MOVE D00-DMA-FOTO IN S02-FLD TO FEC-FEC1.
           MOVE D00-DMA-FUPI IN S02-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'FECFUPIFOTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S02.
       VAL-FEXT-FOTO.
           IF D00-DMA-FEXT IN S02-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD-S02.
           MOVE D00-DMA-FOTO IN S02-FLD TO FEC-FEC1.
           MOVE D00-DMA-FEXT IN S02-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'FECFEXTFOTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       VAL-FEXT-FUPI.
           IF D00-DMA-FUPI IN S02-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD-S02.
           MOVE D00-DMA-FUPI IN S02-FLD TO FEC-FEC1.
           MOVE D00-DMA-FEXT IN S02-FLD TO FEC-FEC2.
           MOVE FEC-FORM-DMA TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'FECFEXTFUPI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *JJV 03/02/88
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-FLD-S02 SECTION.
       INI-PRO-FLD-S02.
           PERFORM PRO-D00-S02.
       FIN-PRO-FLD-S02.
           EXIT.
       
       PRO-D00-S02 SECTION.
       INI-PRO-D00-S02.
           MOVE FRM-CPIM-AEY TO D00-IND-SOPE-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-TGAR-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-OFIC-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-IND-ESTC-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-ACTD-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-IND-BCTI-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-DMA-FOTO-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-TINT-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-DMA-FEXT-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-UINP-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-DMA-FUPI-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-NUM-PPPR-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-ACRG-ATR IN S02-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-AUMO-ATR IN S02-FLD.
       FIN-PRO-D00-S02.
           EXIT.
      *>>>>
*% END
