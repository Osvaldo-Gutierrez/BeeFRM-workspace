*%! Codigo Adicional
*% IF FIN_PUT_ALL_S21
      *<<<< FIN_PUT_ALL_S21
           PERFORM PUT-ALL-S22.
      *>>>>
*% END
*% IF FIN_SCR_CLRA_S21
      *<<<< FIN_SCR_CLRA_S21
           PERFORM SCR-CLRA-S22.
      *>>>>
*% END
*% IF INI_KEY_D02_S21 OR FIN_RET_D02_S21
      *<<<< INI_KEY_D02_S21 OR FIN_RET_D02_S21
           MOVE '2' TO D02-IND-TREG IN D02.
      *>>>>
*% END
*% IF D02_VRF_RUTD
      *<<<< D02_VRF_RUTD
      * PRO-VRF
           MOVE D02-NUM-RUTD IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RUTD IN S21-FLD TO VRF-DVRF.
           MOVE 7                       TO VRF-LMAX.
           MOVE VRF-ZERO-N              TO VRF-ZERO.
           MOVE VRF-SVRF-K              TO VRF-SVRF.
           MOVE VRF-VAL                 TO VRF-CMND.
           PERFORM PRO-VRF.
      *JSS IF MSG-COD-MENS = SPACES
      *        MOVE VRF-NUME TO D02-NUM-RUTD IN S21-FLD.
      *>>>>
*% END
*% IF D02_COD_NIIO
      *<<<< D02_COD_NIIO
           IF D02-COD-NIIO IN S21-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF D02_VAL_PPCC
      *<<<< D02_VAL_PPCC
           IF D02-VAL-PPCC IN S21-FLD > 100
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'VAL    %>100' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF D02_IND_TDOP
      *<<<< D02_IND_TDOP
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'TDOP'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-TDOP IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF D02_VRF_RDDA
      *<<<< D02_VRF_RDDA
      * PRO-VRF
           MOVE D02-NUM-RDDA IN S21-FLD TO VRF-NUME.
           MOVE D02-VRF-RDDA IN S21-FLD TO VRF-DVRF.
           MOVE 7                       TO VRF-LMAX.
           MOVE VRF-ZERO-S              TO VRF-ZERO.
           MOVE VRF-SVRF-K              TO VRF-SVRF.
           MOVE VRF-VAL                 TO VRF-CMND.
           PERFORM PRO-VRF.
           IF D02-NUM-RDDA IN S21-FLD = ZEROES AND
               ( D02-IND-TDOP IN S21-FLD = 'C' OR
                 D02-IND-TDOP IN S21-FLD = 'I' )
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'NUMRDDA#BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF D02-NUM-RDDA IN S21-FLD NOT = ZEROES AND
               ( D02-IND-TDOP IN S21-FLD = 'D' )
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'NUMRDDA=BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF D02_VAL_PPCC
      *<<<< D02_VAL_PPCC
           IF  D02-IND-TDOP IN S21-FLD = 'C' AND
               D02-VAL-PPCC IN S21-FLD = ZEROES
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'VALPPCC#BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF  D02-IND-TDOP IN S21-FLD NOT = 'C' AND
               D02-VAL-PPCC IN S21-FLD NOT = ZEROES
               MOVE 'SUP'         TO MSG-COD-SIST
               MOVE 'VALPPCC=BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF D02_IND_OPAV
      *<<<< D02_IND_OPAV
      *DAD ini
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS'                   TO TAB-COD-SIST.
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.
           MOVE D02-IND-OPAV IN S21-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *DAD fin
      *>>>>
*% END
*% IF D02_NUM_DDIR
      *<<<< D02_NUM_DDIR
      *DAD ini
      *DAD fin
      *>>>>
*% END
*% IF D02_IND_DEXC
      *<<<< D02_IND_DEXC
      *DAD ini
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'DEXC'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-DEXC IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *DAD fin
      *>>>>
*% END
*% IF D02_IND_DCAS
      *<<<< D02_IND_DCAS
      *DAD ini
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'SUP'                   TO MSC-COD-SIST.
           MOVE 'DCAS'                  TO MSC-COD-TMSC IN MSC.
           MOVE D02-IND-DCAS IN S21-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *DAD fin
      *>>>>
*% END
*% IF VAL_CON_FLD_S21
      *<<<< VAL_CON_FLD_S21
           IF D02-NUM-RUTD IN S21-FLD = D02-NUM-RDDA IN S21-FLD
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'NUMRUTD=RDDA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       VAL-RCCV-MOOP.
           IF D02-VAL-RCCV IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCON-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCON-MOOP.
      *DAD ini  24-FEB-1992
      *     IF D02-VAL-SCON IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
      *         GO TO VAL-ICCB-MOOP.
      *         MOVE 'SUP'          TO MSG-COD-SIST
      *         MOVE 'VALSCON>MOOP' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         GO TO FIN-VAL-CON-FLD-S21.
      *DAD fin  24-FEB-1992
       VAL-ICCB-MOOP.
           IF D02-VAL-ICCB IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVD-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCB>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVD-MOOP.
           IF D02-VAL-SCVD IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-RCCR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVD>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-RCCR-MOOP.
           IF D02-VAL-RCCR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCIL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCIL-MOOP.
           IF D02-VAL-SCIL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-ICCR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCIL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-ICCR-MOOP.
           IF D02-VAL-ICCR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCOI-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCOI-MOOP.
           IF D02-VAL-SCOI IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-RCCL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCOI>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-RCCL-MOOP.
           IF D02-VAL-RCCL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SMOR-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALRCCL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SMOR-MOOP.
           IF D02-VAL-SMOR IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-ICCL-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSMOR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-ICCL-MOOP.
           IF D02-VAL-ICCL IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVC-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALICCL>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVC-MOOP.
           IF D02-VAL-SCVC IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-UINP-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVC>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-UINP-MOOP.
           IF D02-VAL-UINP IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-SCVV-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALUINP>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-SCVV-MOOP.
           IF D02-VAL-SCVV IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-IPCO-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALSCVV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-IPCO-MOOP.
           IF D02-VAL-IPCO IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO VAL-IPCV-MOOP.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALIPCO>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
       VAL-IPCV-MOOP.
           IF D02-VAL-IPCO IN S21-FLD NOT > D02-VAL-MOOP IN S21-FLD
               GO TO FIN-VAL-CON-FLD-S21.
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALIPCV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S21.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-FLD-S21 SECTION.
       INI-PRO-FLD-S21.
           PERFORM PRO-D02-S21.
       FIN-PRO-FLD-S21.
           EXIT.
       
       PRO-D02-S21 SECTION.
       INI-PRO-D02-S21.
           MOVE FRM-CPIM-AEY TO D02-GLS-NOMD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-COD-NIIG-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VRF-RDDA-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-PPCC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-PPPR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-MOOP-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCON-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCB-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVD-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCIL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCOI-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-RCCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SMOR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-ICCL-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-UINP-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-SCVV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-CAPV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-IPCO-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-VAL-IPCV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-OPAV-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-NUM-DDIR-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-DEXC-ATR IN S21-FLD.
           MOVE FRM-CPIM-AEY TO D02-IND-DCAS-ATR IN S21-FLD.
       FIN-PRO-D02-S21.
           EXIT.
      *>>>>
*% END
