*%! Codigo adicional para programa
*% NO_HDR_CST = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY SUPWIS11 REPLACING ==01  S11-FLD== BY ==03  S11-FLD==.
       COPY SUPWIS12 REPLACING ==01  S12-FLD== BY ==03  S12-FLD==.
       COPY SUPWGD01.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGHOY.
       COPY TABBRUSR.
      *DAD
       COPY GNSBRMSC.
      *
       COPY GNSBRLOG.
           03 LOG-GLS-DATA                       PIC X(695).
       COPY SUPBRD1L REPLACING ==D1L.== BY ==D1L REDEFINES LOG.==.
       COPY TABBRCOM.
       01  WSS-VARI-S11.
           03  WSS-COD-LOCA.
               05  WSS-COD-REGI                  PIC X(02).
               05  WSS-COD-PLZA                  PIC X(04). 
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *DAD
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
       COPY SUPLGD01.
      *>>>>
*% END
*% IF FIN_LUP_MAIN
      *<<<< FIN_LUP_MAIN
           MOVE FRM-MENS TO SCR-MENS-EXT.
           IF SCR-INST = SCR-INST-HCM
               PERFORM EGR-FTER-CMN
           ELSE
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF PRE_PRO_FLD
      *<<<< PRE_PRO_FLD
           MOVE '1'          TO FRM-CPIM-AEY. 
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *JSS MOVE S11-FLD-EXT TO S11-FLD.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
                 MOVE WSS-INST-NULL TO SCR-INST-EXT
                 PERFORM ING-FPEN-CIC.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD
      *<<<< SCR_GFLD_VAL_CON_FLD
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF7
               IF SCR-CONF > SPACES
                   PERFORM VAL-NUM-KEY-S12
                   PERFORM VAL-NUM-FLD-S12
                   PERFORM EGR-FPEN-BCK
               ELSE
                   PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
      *<<<< FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-S12
               PERFORM VAL-NUM-FLD-S12
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE D01-COD-ACRG IN S12-FLD TO D01-COD-AUMO IN D01.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D01-NUM-DCRG IN D01.
           MOVE HOY-MHOY IN HOY-VARI TO D01-NUM-MCRG IN D01.
           MOVE HOY-AHOY IN HOY-VARI TO D01-NUM-ACRG IN D01.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D01-NUM-DUMO IN D01.
           MOVE HOY-MHOY IN HOY-VARI TO D01-NUM-MUMO IN D01.
           MOVE HOY-AHOY IN HOY-VARI TO D01-NUM-AUMO IN D01.
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'M'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D01-COD-ID01 TO LOG-COD-VKEY.
           MOVE D01          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D1L.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           MOVE 'N' TO LOG-IND-ACCI.
           MOVE D01 TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D1L.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'I'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D01-COD-ID01 TO LOG-COD-VKEY.
           MOVE D01          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D1L.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'E'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D01-COD-ID01 TO LOG-COD-VKEY.
           MOVE D01          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D1L.
      *>>>>
*% END
*% IF INI_XCT_PRGP
      *<<<< 
           GO TO FIN-XCT-PRGP.
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
*% FRM = "S12"
*% INCLUDE 'GNSMMP'
      * COPY SUPBMS11.
*% IF PGM_PQ
      *<<<< 
       COPY SUPBQS11.
*% ELSE
       COPY SUPBUS11.
      *>>>>
*% END
       COPY SUPBFD1L.
      *DAD
       COPY GNSBFMSC.
      *
       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGHOY.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
      *>>>>
*% END
