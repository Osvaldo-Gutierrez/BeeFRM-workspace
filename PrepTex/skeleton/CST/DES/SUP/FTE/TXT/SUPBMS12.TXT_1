*%! Codigo adicional
*% IF FIN_PUT_ALL_S12
      *<<<< FIN_PUT_ALL_S12
      * Incluir busqueda de glosas de S12
      * 
      * FRM-GLS-ARCV.
           IF D01-COD-ARCV IN S12-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-EXT-TTAB IN TAB
               MOVE D01-COD-ARCV IN S12-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ARCV IN S12-FLD.
      *DAD
      *BUS-USR busca usuario en tablas
      *         MOVE D01-COD-ACRG IN S12-FLD TO USR-COD-USER IN USR.
      *         PERFORM BUS-USR.
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN S12-FLD.
      *BUS-USR busca usuario en tablas
      *         MOVE D01-COD-AUMO IN S12-FLD TO USR-COD-USER IN USR.
      *         PERFORM BUS-USR.
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN S12-FLD.
      *
      *>>>>
*% END
*% IF FIN_RET_ALL_S12
      *<<<< FIN_RET_ALL_S12
           PERFORM RET-ALL-S11.
      *>>>>
*% END
*% IF FIN_KEY_D01_S12
      *<<<< FIN_KEY_D01_S12
           PERFORM KEY-D01-S11.
      *>>>>
*% END
*% IF D01_COD_ARCV
      *<<<< D01_COD_ARCV
           IF D01-COD-ARCV IN S12-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-EXT-TTAB IN TAB
               MOVE D01-COD-ARCV IN S12-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ARCV IN S12-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-ARCV IN S12-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ARCV IN S12-FLD.
      *>>>>
*% END
*% IF D01_IND_EA45
      *<<<< D01_IND_EA45
           IF D01-IND-EA45 IN S12-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'EA45' TO MSC-COD-TMSC IN MSC
               MOVE D01-IND-EA45 IN S12-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
*% IF D01_COD_ACRG
      *<<<<  D01_COD_ACRG
      *VAL-USR Valida Usuario
           MOVE D01-COD-ACRG IN S12-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD
      *     IF MSG-COD-MENS NOT = 'COD    NEX'
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN S12-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-ACRG IN S12-FLD.
      *
      *>>>>
*% END
*% IF D01_COD_AUMO
      *<<<<  D01_COD_AUMO
      *VAL-USR Valida Usuario
           MOVE D01-COD-AUMO IN S12-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *DAD
      *     IF MSG-COD-MENS NOT = 'COD    NEX'
      *         MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN S12-FLD
      *     ELSE
      *         MOVE SPACES TO FRM-GLS-AUMO IN S12-FLD.
      *
      *>>>>
*% END
*% IF D01_IND_MAYD
      *<<<< D01_IND_MAYD
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'SUP' TO MSC-COD-SIST.
           MOVE 'MAYD' TO MSC-COD-TMSC IN MSC.
           MOVE D01-IND-MAYD IN S12-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF D01_IND_RUTD
      *<<<< D01_IND_RUTD
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'IRUT' TO MSC-COD-TMSC IN MSC.
           MOVE D01-IND-RUTD IN S12-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF VAL_CON_FLD_S12
      *<<<< VAL_CON_FLD_S12
      *DAD
       VAL-DEXC-TA84.
           IF D01-SGV-DEXC IN S12-FLD > D01-VAL-TA84 IN S12-FLD
               MOVE 'SUP'          TO MSG-COD-SIST
               MOVE 'VALDEXC>TA84' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S12.
      *
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-FLD-S12 SECTION.
       INI-PRO-FLD-S12.
           PERFORM PRO-D01-S12.
       FIN-PRO-FLD-S12.
           EXIT.
       
       PRO-D01-S12 SECTION.
       INI-PRO-D01-S12.
           MOVE FRM-CPIM-AEY TO D01-COD-ARCV-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-DGLI-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-DGXI-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TCBN-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-DCLI-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TCVD-ATR IN S12-FLD.
      *lrh     MOVE FRM-CPIM-AEY TO D01-VAL-DCXI-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TPCB-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-NUM-CRCO-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TPCV-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-NUM-CAPC-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TLVB-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-NUM-CRHV-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TLVV-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-NUM-DHAT-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TXPE-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-IND-EA45-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TCOM-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-GPER-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TDPI-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-OGCM-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-FDPL-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-GLGB-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-ICDL-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-ICDX-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TA84-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-T84N-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TDGB-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-VAL-TDGV-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-COD-ACRG-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-COD-AUMO-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-IND-RUTD-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-GLS-RUTD-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-IND-MAYD-ATR IN S12-FLD.
           MOVE FRM-CPIM-AEY TO D01-SGV-DEXC-ATR IN S12-FLD.
       FIN-PRO-D01-S12.
           EXIT.
      *>>>>
*% END
