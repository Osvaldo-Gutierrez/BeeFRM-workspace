*%! Codigo adicional
*% IF FIN_PUT_ALL_S01
      *<<<< FIN_PUT_ALL_S01
       GET-FRM-GLS-MONE.
           IF D00-COD-MONE IN S01-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-EXT-TTAB IN TAB
               MOVE D00-COD-MONE IN S01-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-MONE IN S01-FLD.

       GET-FRM-GLS-TOPE.
           IF D00-COD-TOPE IN S01-FLD > SPACES
               MOVE 'SUP' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE D00-COD-TOPE IN S01-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TOPE IN S01-FLD.

       GET-FRM-GLS-TCRE.
           IF D00-IND-TCRE IN S01-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'TCRE' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-TCRE IN S01-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TCRE IN S01-FLD.

       GET-FRM-GLS-TCCO.
           IF D00-COD-TCCO IN S01-FLD > SPACES
               MOVE 'SUP' TO TAB-COD-SIST
               MOVE 'COL' TO TAB-COD-TTAB IN TAB
               MOVE D00-COD-TCCO IN S01-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCCO IN S01-FLD.

       GET-FRM-GLS-CCTB.

               PERFORM PUT-ALL-S02.
               PERFORM PUT-ALL-S03.
      *>>>>
*% END
*% IF FIN_SCR_CLRA_S01
      *<<<< FIN_SCR_CLRA_S01
           PERFORM SCR-CLRA-S02.
           PERFORM SCR-CLRA-S03.
      *>>>>
*% END
*% IF D00_COD_SIST
      *<<<< D00_COD_SIST
      *VAL-COD Valida codigo de tabla
           IF D00-COD-SIST IN S01-FLD > SPACES
               MOVE 'SUP' TO TAB-COD-SIST
               MOVE 'SIS' TO TAB-COD-TTAB IN TAB
               MOVE D00-COD-SIST IN S01-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SIST IN S01-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-SIST IN S01-FLD.
      *>>>>
*% END
*% IF D00_COD_NIID
      *<<<< D00_COD_NIID
           IF D00-COD-NIID IN S01-FLD NOT > SPACES
               PERFORM ERR-GLS.
      *>>>>
*% END
*% IF INI_D00_DMA_FCIE
      *<<<< INI_D00_DMA_FCIE
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D00_COD_MONE
      *<<<< D00_COD_MONE
      *VAL-COD Valida codigo de tabla
           IF D00-COD-MONE IN S01-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-EXT-TTAB IN TAB
               MOVE D00-COD-MONE IN S01-FLD TO TAB-EXT-CTAB IN TAB
               MOVE 'TAB-EXT-TABL' TO FIO-AKEY
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-MONE IN S01-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-MONE IN S01-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MONE IN S01-FLD.
      *>>>>
*% END
*% IF D00_COD_TOPE
      *<<<< D00_COD_TOPE
      *VAL-COD Valida codigo de tabla
           IF D00-COD-TOPE IN S01-FLD > SPACES
               MOVE 'SUP' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE D00-COD-TOPE IN S01-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TOPE IN S01-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TOPE IN S01-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOPE IN S01-FLD.
      *>>>>
*% END
*% IF D00_IND_TCRE
      *<<<< D00_IND_TCRE
      *VAL-MSC Valida miscelaneo de tabla
           IF D00-IND-TCRE IN S01-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'TCRE' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-TCRE IN S01-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TCRE IN S01-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TCRE IN S01-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCRE IN S01-FLD.
      *>>>>
*% END
*% IF D00_COD_TCCO
      *<<<< D00_COD_TCCO
      *VAL-COD Valida codigo de tabla
           IF D00-COD-TCCO IN S01-FLD > SPACES
               MOVE 'SUP' TO TAB-COD-SIST
               MOVE 'COL' TO TAB-COD-TTAB IN TAB
               MOVE D00-COD-TCCO IN S01-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCCO IN S01-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-TCCO IN S01-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCCO IN S01-FLD.
      *>>>>
*% END
*% IF D00_IND_ALGB
      *<<<< D00_IND_ALGB
           IF D00-IND-ALGB IN S01-FLD > SPACES
               MOVE 'SUP' TO MSC-COD-SIST
               MOVE 'ALGB' TO MSC-COD-TMSC IN MSC
               MOVE D00-IND-ALGB IN S01-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *JJV Se elimina el IF ya que VAL-IND da un status de OK.
      *>>>>
*% END
*% IF INI_D00_DMA_FPVC
      *<<<< INI_D00_DMA_FPVC
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF VAL_CON_FLD_S01
      *<<<< VAL_CON_FLD_S01
       VAL-SCON-MOOP.
           IF D00-VAL-SCON IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-SMO1-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALSCON>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-SMO1-MOOP.
           IF D00-VAL-SMO1 IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-VMES-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALSMO1>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-VMES-MOOP.
           IF D00-VAL-VMES IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-SMO2-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALVMES>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-SMO2-MOOP.
           IF D00-VAL-SMO2 IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-PMES-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALSMO2>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-PMES-MOOP.
           IF D00-VAL-PMES IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-SCVC-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALPMES>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-SCVC-MOOP.
           IF D00-VAL-SCVC IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-RMES-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALSCVC>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-RMES-MOOP.
           IF D00-VAL-RMES IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-SREP-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALRMES>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-SREP-MOOP.
           IF D00-VAL-SREP IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-IPCO-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALSREP>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-IPCO-MOOP.
           IF D00-VAL-IPCO IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-CAPV-CORI.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALIPCO>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-CAPV-CORI.
           IF D00-NUM-CAPV IN S01-FLD NOT > D00-NUM-CORI IN S01-FLD
               GO TO VAL-IPCV-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALCAPV>CORI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-IPCV-MOOP.
           IF D00-VAL-IPCV IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-VCIM-CORI.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALIPCV>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-VCIM-CORI.
           IF D00-NUM-VCIM IN S01-FLD NOT > D00-NUM-CORI IN S01-FLD
               GO TO VAL-IPCR-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALVCIM>CORI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-IPCR-MOOP.
           IF D00-VAL-IPCR IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO VAL-RDEV-MOOP.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALIPCR>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
       VAL-RDEV-MOOP.
      *    IF D00-VAL-RDEV IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
      *        GO TO VAL-RDER-MOOP.
      *        MOVE 'SUP' TO MSG-COD-SIST
      *        MOVE 'VALRDEV>MOOP' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-CON-FLD-S01.
       VAL-RDER-MOOP.
           IF D00-VAL-RDER IN S01-FLD NOT > D00-VAL-MOOP IN S01-FLD
               GO TO FIN-VAL-CON-FLD-S01.
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALRDER>MOOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-S01.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-FLD-S01 SECTION.
       INI-PRO-FLD-S01.
           PERFORM PRO-D00-S01.
       FIN-PRO-FLD-S01.
           EXIT.
       
       PRO-D00-S01 SECTION.
       INI-PRO-D00-S01.
           MOVE FRM-CPIM-AEY TO D00-DMA-FCIE-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-MONE-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-TOPE-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-IND-TCRE-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-TCCO-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-COD-CCTB-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-SCON-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-MOOP-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-SMO1-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-VMES-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-SMO2-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-PMES-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-SCVC-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-RMES-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-SREP-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-NUM-CORI-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-IPCO-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-NUM-CAPV-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-IPCV-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-NUM-VCIM-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-IPCR-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-DMA-FPVC-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-RDEV-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-IND-ALGB-ATR IN S01-FLD.
           MOVE FRM-CPIM-AEY TO D00-VAL-RDER-ATR IN S01-FLD.
       FIN-PRO-D00-S01.
           EXIT.
      *>>>>
*% END
