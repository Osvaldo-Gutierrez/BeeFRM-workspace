*%! Codigo adicional para programa
*% NO_HDR_CST = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY SUPWIS11 REPLACING ==01  S11-FLD== BY ==03  S11-FLD==.
       COPY SUPWIS12 REPLACING ==01  S12-FLD== BY ==03  S12-FLD==.
       COPY SUPWGD01.
       COPY GNSBRMSC.
       COPY SGCBRDBC.
       COPY SGCBRDCE.
      *DAD ini  05-JAN-1994
      * COPY SUPBRDMD.
      *DAD fin  05-JAN-1994
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY GNSWGCPT.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY TABBRCOM.
       01  WSS-VARI-S11.
           03 WSS-COD-RUTC                      PIC 9(08).
           03 WSS-COD-LOCA.
              05  WSS-COD-REGI                  PIC X(02).
              05  WSS-COD-PLZA                  PIC X(04). 
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
       COPY SUPLGD01.
      *>>>>
*% END
*% IF PRE_PRO_FLD
      *<<<< PRE_PRO_FLD
           MOVE '1'          TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-DESDE-CMN
                MOVE LOW-VALUES TO S11-FLD.
           MOVE 1 TO SCR-IPRO.
      *JSS MOVE S12-FLD-EXT TO S12-FLD.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
                MOVE WSS-INST-NULL TO SCR-INST-EXT
                PERFORM ING-FTER-CIC
           ELSE
           IF SCR-INST-EXT = WSS-INST-FTER-CMN
                MOVE WSS-INST-NULL TO SCR-INST-EXT
                PERFORM ING-FTER-CMN
           ELSE
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
                MOVE WSS-INST-NULL TO SCR-INST-EXT
                PERFORM ING-FPEN-CIC.
      *>>>>
*% END
*% IF INI_HBL_KEY OR INI_HBL_IKY
      *<<<< INI_HBL_KEY OR INI_HBL_IKY
           MOVE LOW-VALUES TO S12-FLD.
           IF SCR-DESDE-CMN OR
              FRM-FFLD = FRM-FFLD-PF12
                MOVE 'GNS' TO MSG-COD-SIST
                MOVE 'MSGKEY' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                                     S11-GLS-MENS IN S11-FLD.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FIO-STAT-OKS OR ( NOT ( SCR-CCPP = 'ING' OR 'ACT' ) )
               GO TO FIN-FND-KEY.
      *DAD ini  05-JAN-1994
      *     MOVE D01-NUM-RUTD IN S11-FLD TO DMD-NUM-RUTD IN DMD.
      *     MOVE SPACES                  TO DMD-IND-RUTD IN DMD.
      *     MOVE SPACES                  TO DMD-GLS-RUTD IN DMD.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM SUP-FIO-DMD.
      *     IF FIO-STAT-OKS
      *         MOVE DMD-IND-DREL IN DMD TO D01-IND-TRDB IN S11-FLD
      *BUS-MSC busca glosa de miscelaneo en tabla
      *Cambiado por busqueda en tabla
      *         MOVE 'SGC' TO TAB-COD-SIST
      *         MOVE 'REC' TO TAB-EXT-TTAB IN TAB
      *         MOVE D01-IND-TRDB IN S11-FLD TO TAB-EXT-CTAB IN TAB
      *         MOVE 'TAB-EXT-TABL' TO FIO-AKEY
      *         PERFORM BUS-TAB
      *         MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TRDB IN S11-FLD

      *         MOVE DMD-IND-CRCC IN DMD TO D01-IND-CRCC IN S11-FLD
      *         MOVE DMD-IND-CRCV IN DMD TO D01-IND-CRCV IN S11-FLD.
      *DAD fin  05-JAN-1994

           MOVE D01-NUM-RUTD IN S11-FLD TO WSS-COD-RUTC.
           MOVE WSS-COD-RUTC TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES       TO DBC-IND-ICLI IN DBC.
           MOVE SPACES       TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO D01-GLS-NOMD IN S11-FLD
               MOVE '99' TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-GLS-NOMC IN DBC TO D01-GLS-NOMD IN S11-FLD.
           MOVE DBC-COD-ODSE IN DBC TO D01-COD-ODSE IN S11-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ODS' TO TAB-EXT-TTAB IN TAB.
           MOVE D01-COD-ODSE IN S11-FLD TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ODSE IN S11-FLD.

           MOVE DBC-MSC-SCLI IN DBC TO D01-IND-ESTA IN S11-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'SGC'                   TO MSC-COD-SIST.
           MOVE 'SCLI'                  TO MSC-EXT-TMSC IN MSC.
           MOVE D01-IND-ESTA IN S11-FLD TO MSC-EXT-CMSC IN MSC.
           MOVE 'MSC-EXT-TABL' TO FIO-AKEY
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-ESTA IN S11-FLD.

           IF DBC-IND-TICL IN DBC = 'P'
               MOVE '99' TO FIO-STAT
               GO TO FIN-FND-KEY.
      *PENDIENTE JJV
      *    MOVE DBC-NUM-ICLI IN DBC TO DCE-COD-RUTC IN DCE.
      *    MOVE DBC-IND-ICLI IN DBC TO DCE-IND-RUTC IN DCE.
      *    MOVE DBC-GLS-ICLI IN DBC TO DCE-GLS-RUTC IN DCE.

           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           MOVE DCE-COD-TSOC IN DCE TO D01-IND-CAJU IN S11-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
      *Cambiado por busqueda en tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'SOC' TO TAB-EXT-TTAB IN TAB.
           MOVE D01-IND-CAJU IN S11-FLD TO TAB-EXT-CTAB IN TAB.
           MOVE 'TAB-EXT-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CAJU IN S11-FLD.

           MOVE DCE-IND-TEMP IN DCE TO D01-IND-TDEU IN S11-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'SUP' TO MSC-COD-SIST.
           MOVE 'TDEU' TO MSC-EXT-TMSC IN MSC.
           MOVE D01-IND-TDEU IN S11-FLD TO MSC-EXT-CMSC IN MSC.
           MOVE 'MSC-EXT-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TDEU IN S11-FLD.

           MOVE DCE-IND-CATE IN DCE TO D01-IND-CATE IN S11-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE 'SGC' TO MSC-COD-SIST.
           MOVE 'CATE' TO MSC-EXT-TMSC IN MSC.
           MOVE D01-IND-CATE IN S11-FLD TO MSC-EXT-CMSC IN MSC.
           MOVE 'MSC-EXT-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CATE IN S11-FLD.

           MOVE '99' TO FIO-STAT.
      *>>>>
*% END
*% IF INI_CMN_ING OR INI_CMN_MOD OR INI_CMN_ELI OR INI_CMN_ACC OR INI_CMN_PGM
      *<<<< INI_CMN_ING OR INI_CMN_MOD OR INI_CMN_ELI
      *     OR INI_CMN_ACC OR INI_CMN_PGM
           PERFORM EGR-FPEN-FRW.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD
      *<<<< SCR_GFLD_VAL_CON_FLD
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-S11
               PERFORM EGR-FPEN-FRW.
      *>>>>
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF8
               IF SCR-CONF > SPACES
                   PERFORM VAL-NUM-KEY-S11
                   PERFORM VAL-NUM-FLD-S11
                   PERFORM EGR-FPEN-FRW
               ELSE
                   PERFORM EGR-FPEN-FRW.
      *>>>>
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
      *<<<< FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-S11
               PERFORM VAL-NUM-FLD-S11
               PERFORM EGR-FPEN-FRW.
      *>>>>
*% END
*% IF INI_XCT_PRGP
      *<<<< 
           GO TO FIN-XCT-PRGP.
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
*% FRM = "S11"
*% INCLUDE 'GNSMMP'
      * COPY SUPBMS12.

*% IF PGM_PQ
      *<<<< 
       COPY SUPBQS12.
*% ELSE
       COPY SUPBUS12.
      *>>>>
*% END
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
       COPY GNSBFMSC.
       COPY GNSBEGLS.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
      *DAD ini  05-JAN-1994
      * COPY SUPBFDMD.
      *DAD fin  05-JAN-1994
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY GNSBGCPT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *>>>>
*% END
