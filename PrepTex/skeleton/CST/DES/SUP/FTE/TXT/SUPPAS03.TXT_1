*%! Codigo adicional para programa
*% NO_HDR_CST = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF FIN_SCR_VARI
      *<<<<< FIN_SCR_VARI
       COPY SUPWIS01 REPLACING ==01  S01-FLD== BY ==03  S01-FLD==.
       COPY SUPWIS02 REPLACING ==01  S02-FLD== BY ==03  S02-FLD==.
       COPY SUPWIS03 REPLACING ==01  S03-FLD== BY ==03  S03-FLD==.
       COPY SUPWGD00.
       COPY GNSBRMSC.
       COPY GNSWGHOY.

       COPY TABBROFI.
       COPY TABBRUSR.
       COPY SGCBRDBC.
      *JSS Solo lo ocupa el modulo de manejo del mapa S03
       01  WSS-VARI.
           03 WSS-COD-RUTC                             PIC 9(08).
      *>>>>>
       COPY GNSWGCPT.
       COPY GNSWGFEC.
*% END
*% IF WSS_DTC
      *<<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>>
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
      *<<<<< CMA
       COPY SUPLGD00.
      *>>>>>
*% END
*% IF FIN_LUP_MAIN
      *<<<<< FIN_LUP_MAIN
           MOVE FRM-MENS TO SCR-MENS-EXT.
           IF SCR-INST = SCR-INST-HCM
               PERFORM EGR-FTER-CMN
           ELSE
               PERFORM EGR-FTER-CIC.
      *>>>>>
*% END
*% IF PRE_PRO_FLD
      *<<<<< PRE_PRO_FLD
            MOVE '1'         TO FRM-CPIM-AEY.
      *>>>>>
*% END
*% IF INI_FIO
      *<<<<< INI_FIO
      *JSS MOVE S01-FLD-EXT TO S01-FLD.
      *JSS MOVE S02-FLD-EXT TO S02-FLD.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
                 MOVE WSS-INST-NULL TO SCR-INST-EXT
                 PERFORM ING-FPEN-CIC.
      *>>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
      *<<<<< PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD
      *<<<<< SCR_GFLD_VAL_CON_FLD
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM EGR-FPEN-BCK.
      *>>>>>
*% END
*% IF FIN_GET_ACC
      *<<<<< FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF7
               IF SCR-CONF > SPACES
                   PERFORM VAL-NUM-KEY-S03
                   PERFORM VAL-NUM-FLD-S03
                   PERFORM EGR-FPEN-BCK
               ELSE
                   PERFORM EGR-FPEN-BCK.
      *>>>>>
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
      *<<<<< FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-S03
               PERFORM VAL-NUM-FLD-S03
               PERFORM EGR-FPEN-BCK.
      *>>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE D00-COD-ACRG IN S02-FLD TO D00-COD-AUMO IN D00.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D00-NUM-DCRG IN D00.
           MOVE HOY-MHOY IN HOY-VARI TO D00-NUM-MCRG IN D00.
           MOVE HOY-AHOY IN HOY-VARI TO D00-NUM-ACRG IN D00.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D00-NUM-DUMO IN D00.
           MOVE HOY-MHOY IN HOY-VARI TO D00-NUM-MUMO IN D00.
           MOVE HOY-AHOY IN HOY-VARI TO D00-NUM-AUMO IN D00.
      *>>>>
*% END
*% IF INI_XCT_PRGP
      *<<<< 
           GO TO FIN-XCT-PRGP.
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
*% FRM = "S03"
*% INCLUDE 'GNSMMP'
      * COPY SUPBMS01.
      * COPY SUPBMS02.
*% IF PGM_PQ
      *<<<< 
       COPY SUPBQS01.
       COPY SUPBQS02.
*% ELSE
       COPY SUPBUS01.
       COPY SUPBUS02.
      *>>>>
*% END
       COPY GNSBGHOY.
       COPY GNSBFMSC.
       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBEGLS.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY SGCBFDBC.
       COPY GNSBGCPT.
       COPY GNSBGFEC.
      *>>>>>
*% END
