*%! Codigo adicional para archivo M6S
*% IF WSS
      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPDB.
       COPY GNSWGPES.

      *Entidades de TAB
       COPY TABBRVLR.
       COPY TABBRCAM.

      * Modulo de variables de ingreso y validacion parametros 
       01  M6-WSS-VARI.
      *        Cod. Region 
           03  WSS-M6S-COD-REGI                   PIC X(02).
      *
      *        Correlativo Sistema
           03  WSS-M6S-COD-CORR                   PIC X(02).
      *
           03 WSS-FEC-FFIN.
              05 WSS-NUM-DFIN                     PIC 9(02).
              05 WSS-NUM-MFIN                     PIC 9(02).
              05 WSS-NUM-SFIN                     PIC 9(02).
              05 WSS-NUM-AFIN                     PIC 9(02).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO                     PIC 9(02).
              05 WSS-NUM-MPRO                     PIC 9(02).
              05 WSS-NUM-SPRO                     PIC 9(02).
              05 WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FULD.
              05 WSS-NUM-DULD                     PIC 9(02).
              05 WSS-NUM-MULD                     PIC 9(02).
              05 WSS-NUM-SULD                     PIC 9(02).
              05 WSS-NUM-AULD                     PIC 9(02).
           03 WSS-FEC-FUDM.
              05 WSS-NUM-SUDM                     PIC 9(02).
              05 WSS-NUM-AUDM                     PIC 9(02).
              05 WSS-NUM-MUDM                     PIC 9(02).
              05 WSS-NUM-DUDM                     PIC 9(02).
           03 WSS-COD-0999        VALUE SPACES    PIC X(06).
           03 WSS-CIC-0999        VALUE SPACES    PIC X(06).
           03 WSS-COD-0998        VALUE SPACES    PIC X(06).
           03 WSS-CIC-0998        VALUE SPACES    PIC X(06).
           03 WSS-COD-0013        VALUE SPACES    PIC X(06).
           03 WSS-CIC-0013        VALUE SPACES    PIC X(06).
           03 WSS-COD-DOLL.
              05 WSS-COD-CVAL                     PIC X(04).
              05 WSS-COD-TVAL                     PIC X(02).
           03 WSS-CIC-1013        VALUE SPACES    PIC X(06).
           03 WSS-SGV-FUEF        VALUE ZEROS     PIC S9(11)V9999.
           03 WSS-SGV-FDOL        VALUE ZEROS     PIC S9(11)V9999.
           03 WSS-SGV-FRDO        VALUE ZEROS     PIC S9(11)V9999.
           03 WSS-STAT-ULDM       VALUE ZEROES    PIC 9(01). 
           03 WSS-VAL-COL1        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-VAL-COL2        VALUE ZEROS     PIC S9(13)V9999.
           03 WSS-VAL-COL3        VALUE ZEROS     PIC S9(13)V9999.

       01  WSS-VARI.
           03 WSS-GLS-GLOS.
              05 WSS-GLS-GLO1                  PIC X(48).
              05 WSS-GLS-GLO2                  PIC X(72).
           03 WSS-IND-PALO     VALUE SPACES     PIC X(01).
           03 WSS-IND-RAYA     VALUE SPACES     PIC X(01).
           03 WSS-IND-CRUZ     VALUE '+'        PIC X(01).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      *Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
      *Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY SUPRWM62.
       COPY SUPRWM63.
       COPY SUPRWM64.
      *>>>>
*% END
*% IF RR
      *<<<<
       COPY SUPRRM62.
       COPY SUPRRM63.
       COPY SUPRRM64.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY SUPRTM62.
       COPY SUPRTM63.
       COPY SUPRTM64.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
      * Captura y valida parametros 
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      * Captura Fecha de Proceso
           DISPLAY 'FECHA DE PROCESO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FPRO IN M6-WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN M6-WSS-VARI.

      *VAL-FEC Valida Fecha de Proceso
           MOVE WSS-FEC-FPRO IN M6-WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-END.
 
      *Calcular el ultimo dia del mes
           MOVE 01           TO WSS-NUM-DFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-MPRO TO WSS-NUM-MFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-SPRO TO WSS-NUM-SFIN IN M6-WSS-VARI.
           MOVE WSS-NUM-APRO TO WSS-NUM-AFIN IN M6-WSS-VARI.
           ADD 1 TO WSS-NUM-MFIN IN M6-WSS-VARI.
           IF WSS-NUM-MFIN = 13
              MOVE 01 TO WSS-NUM-MFIN IN M6-WSS-VARI
              ADD 1   TO WSS-NUM-AFIN IN M6-WSS-VARI.
           PERFORM BUS-ULT-MES.
           IF MSG-COD-MENS > SPACES 
              DISPLAY 'ERROR EN RUTINA ULTIMO DIA DEL MES'
                                                       FIO-STAT
              DISPLAY MSG-COD-MENS
              PERFORM GNS-PRO-END.
           
           IF WSS-FEC-FULD IN M6-WSS-VARI NOT = 
                                    WSS-FEC-FPRO IN M6-WSS-VARI
              DISPLAY 'F. PROCESO NO ES F. ULTIMO DIA DEL MES '
                                    WSS-FEC-FPRO IN M6-WSS-VARI
              DISPLAY 'ABORTO'
              PERFORM GNS-PRO-END.

           MOVE WSS-NUM-DULD IN M6-WSS-VARI TO
                                    WSS-NUM-DUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-MULD IN M6-WSS-VARI TO 
                                    WSS-NUM-MUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-SULD IN M6-WSS-VARI TO 
                                    WSS-NUM-SUDM IN M6-WSS-VARI.
           MOVE WSS-NUM-AULD IN M6-WSS-VARI TO 
                                    WSS-NUM-AUDM IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0999   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0999 IN M6-WSS-VARI.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-0999 IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de UF Mediante CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0998   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0998 IN M6-WSS-VARI.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-0998 IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-0013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-0013 IN M6-WSS-VARI.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-0013 IN M6-WSS-VARI.

      * Obtiene Codigo Valor de Cambio de US$ Mediante CIC de la Moneda '1013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE PDB-CIC-1013   TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR : ' TAB-CIC-CTAB IN TAB
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC1013  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-END.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLL IN M6-WSS-VARI.
           MOVE PDB-COD-TVAL-DOLO   TO WSS-COD-TVAL.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-1013 IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la UF a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-0998 IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-0999 IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA LA UF.'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA LA UF.'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FUEF IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la US$REAJ a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-0013 IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-0999 IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA REAJ. DOLAR'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA REAJ. DOLAR'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FRDO IN M6-WSS-VARI.

      * Obtiene Valor de Cambio de la US$ a Fecha Ultimo dia del mes.
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FUDM IN M6-WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-DOLL IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-0999 IN M6-WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA DOLAR'
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(1)
               DISPLAY 'PARA MONEDA ' CAM-COD-VCAM IN CAM(2)
               PERFORM GNS-PRO-END.
           IF CAM-IND-VIGE NOT = 'S'
               DISPLAY 'INDICADOR DE VIGENCIA NO VALIDO A ESTA FECHA : '
                        WSS-FEC-FUDM IN M6-WSS-VARI ' PARA DOLAR'
               PERFORM GNS-PRO-END.
           MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-FDOL IN M6-WSS-VARI.

           MOVE WSS-NUM-DULD TO WSS-NUM-DSLD.
           MOVE WSS-NUM-MULD TO WSS-NUM-MSLD.
           MOVE WSS-NUM-SULD TO WSS-NUM-SSLD.
           MOVE WSS-NUM-AULD TO WSS-NUM-ASLD.
           MOVE WSS-SGV-FDOL TO WSS-VAL-VCUS.
           MOVE WSS-SGV-FUEF TO WSS-VAL-VCUF.
           MOVE '016'        TO WSS-COD-CINS.

           PERFORM LIMPIA-DET.
           PERFORM LIMPIA-TOT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           MOVE ZEROES TO WSS-VAL-COL1.
           MOVE ZEROES TO WSS-VAL-COL2.
           MOVE ZEROES TO WSS-VAL-COL3.
*% LINEA = "02"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "03"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "04"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "05"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "06"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "09"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "10"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "11"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "15"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "16"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "19"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "20"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "21"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "22"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "26"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "27"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "28"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"
*% LINEA = "31"
*% INCLUDE "SUPTXT:SUPBGM6P.TXT"

           ADD WSS-VAL-COL1 TO SRT-VAL-301.
           ADD WSS-VAL-COL2 TO SRT-VAL-302.
           ADD WSS-VAL-COL3 TO SRT-VAL-303.

           IF M6S-NUM-LINE = 2 OR 3 OR 4 OR 5 OR 6
               ADD WSS-VAL-COL1 TO SRT-VAL-071
               ADD WSS-VAL-COL1 TO SRT-VAL-131

               ADD WSS-VAL-COL2 TO SRT-VAL-072
               ADD WSS-VAL-COL2 TO SRT-VAL-132

               ADD WSS-VAL-COL3 TO SRT-VAL-073
               ADD WSS-VAL-COL3 TO SRT-VAL-133.

           IF M6S-NUM-LINE = 9 OR 10 OR 11
               ADD WSS-VAL-COL1 TO SRT-VAL-121
               ADD WSS-VAL-COL1 TO SRT-VAL-131

               ADD WSS-VAL-COL2 TO SRT-VAL-122
               ADD WSS-VAL-COL2 TO SRT-VAL-132

               ADD WSS-VAL-COL3 TO SRT-VAL-123
               ADD WSS-VAL-COL3 TO SRT-VAL-133.

           IF M6S-NUM-LINE = 15 OR 16
               ADD WSS-VAL-COL1 TO SRT-VAL-171
               ADD WSS-VAL-COL1 TO SRT-VAL-241

               ADD WSS-VAL-COL2 TO SRT-VAL-172
               ADD WSS-VAL-COL2 TO SRT-VAL-242

               ADD WSS-VAL-COL3 TO SRT-VAL-173
               ADD WSS-VAL-COL3 TO SRT-VAL-243.

           IF M6S-NUM-LINE = 19 OR 20 OR 21 OR 22
               ADD WSS-VAL-COL1 TO SRT-VAL-231
               ADD WSS-VAL-COL1 TO SRT-VAL-241

               ADD WSS-VAL-COL2 TO SRT-VAL-232
               ADD WSS-VAL-COL2 TO SRT-VAL-242

               ADD WSS-VAL-COL3 TO SRT-VAL-233
               ADD WSS-VAL-COL3 TO SRT-VAL-243.

           IF M6S-NUM-LINE = 26 OR 27 OR 28
               ADD WSS-VAL-COL1 TO SRT-VAL-291

               ADD WSS-VAL-COL2 TO SRT-VAL-292

               ADD WSS-VAL-COL3 TO SRT-VAL-293.

           IF M6S-COD-CORR IN M6S = '04'
              ADD WSS-VAL-COL1 TO SRT-VAL-321
              ADD WSS-VAL-COL2 TO SRT-VAL-322
              ADD WSS-VAL-COL3 TO SRT-VAL-323
              IF M6S-NUM-LINE = 31
                  ADD WSS-VAL-COL1 TO SRT-VAL-311
                  ADD WSS-VAL-COL2 TO SRT-VAL-312
                  ADD WSS-VAL-COL3 TO SRT-VAL-313.
      *>>>>
*% END
*% IF RM
      *<<<< RM
       COPY SUPRMM62.
       COPY SUPRMM63.
       COPY SUPRMM64.
      *>>>>
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
           IF FIO-STAT-OKS
               MOVE M6S-COD-REGI IN M6S TO WSS-M6S-COD-REGI
               MOVE M6S-COD-CORR IN M6S TO WSS-M6S-COD-CORR.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SUP-FIO-M6S.

           IF FIO-STAT-OKS
               IF M6S-COD-REGI IN M6S = WSS-M6S-COD-REGI AND
                  M6S-COD-CORR IN M6S = WSS-M6S-COD-CORR
                     GO TO LUP-MAIN.
           
           PERFORM PUT-TIT.
           MOVE M6S-COD-REGI IN M6S TO WSS-M6S-COD-REGI
           MOVE M6S-COD-CORR IN M6S TO WSS-M6S-COD-CORR.
           PERFORM DIV-1000.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           IF M6S-COD-CORR IN SRT = '04'
               GENERATE DL-M64.
           PERFORM LIMPIA-DET.
           PERFORM LIMPIA-TOT.
           GO TO LUP-MAIN.
      *>>>> FIN_GEN_OUT
*% END
*% IF EOF
      *<<<< EOF

       DIV-1000 SECTION.
       INI-DIV-1000.
       FIN-DIV-1000.
           EXIT.

       PUT-TIT SECTION.
       INI-PUT-TIT.
      *Recupera glosa region para titulos
           IF WSS-M6S-COD-REGI = '98'
               MOVE SPACES TO WSS-GLS-TIRE
               MOVE 'TOTALES A NIVEL BANCO ' TO WSS-GLS-REGI
           ELSE
               MOVE 'REGION :' TO WSS-GLS-TIRE
               MOVE 'TAB'        TO TAB-COD-SIST
               MOVE 'REG'        TO TAB-COD-TTAB IN TAB
               MOVE WSS-M6S-COD-REGI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-REGI IN WSS-M61.

           MOVE SPACES TO WSS-GLS-GLO1 IN WSS-VARI.

           IF WSS-M6S-COD-CORR = '01'
              MOVE ' ' TO WSS-IND-PALO
              MOVE 'DEPOSITOS Y CAPTACIONES' TO 
                                     WSS-GLS-GLS1 IN WSS-M61
              MOVE 'Exigible a menos de 30 dias ' TO
                                     WSS-GLS-GLS2 IN WSS-M61
              MOVE 'Cuentas Corrientes Part. 3005 MB1' TO
                                     WSS-GLS-GLO2 IN WSS-VARI 
              MOVE WSS-GLS-GLOS IN WSS-VARI TO 
                                     WSS-GLS-GLS3 IN WSS-M61
              MOVE '          Moneda                   ' TO
                                     WSS-GLS-GLS4 IN WSS-M61
              MOVE '         Chilena                     ' 
                                  TO WSS-GLS-GLS5 IN WSS-M61.

           IF WSS-M6S-COD-CORR = '02'
              MOVE ' ' TO WSS-IND-PALO
              MOVE 'DEPOSITOS Y CAPTACIONES' TO 
                                     WSS-GLS-GLS1 IN WSS-M61
              MOVE 'Exigible a menos de 30 dias ' TO
                                     WSS-GLS-GLS2 IN WSS-M61
              MOVE 'Otros saldos acreedores Parts. 3010,3015 MB1' 
                                  TO WSS-GLS-GLO2 IN WSS-VARI 
              MOVE WSS-GLS-GLOS IN WSS-VARI TO 
                                     WSS-GLS-GLS3 IN WSS-M61
              MOVE '          Moneda                   ' TO
                                     WSS-GLS-GLS4 IN WSS-M61
              MOVE '         Chilena                     ' 
                                  TO WSS-GLS-GLS5 IN WSS-M61.

           IF WSS-M6S-COD-CORR = '03'
              MOVE '!' TO WSS-IND-PALO
              MOVE 'DEPOSITOS Y CAPTACIONES' TO 
                                     WSS-GLS-GLS1 IN WSS-M61
              MOVE 'Exigible a 30 dias o mas ' TO
                                     WSS-GLS-GLS2 IN WSS-M61
              MOVE 'Parts. 3020-3035,3045,3065,3075,3080 MB1'
                                  TO WSS-GLS-GLO2 IN WSS-VARI 
              MOVE WSS-GLS-GLOS IN WSS-VARI TO 
                                     WSS-GLS-GLS3 IN WSS-M61
              MOVE '               Moneda Chilena          '
                                  TO WSS-GLS-GLS4 IN WSS-M61
              MOVE '   No Reajustable !        Reajustable '
                                  TO WSS-GLS-GLS5 IN WSS-M61.

           IF WSS-M6S-COD-CORR = '04'
              MOVE '!' TO WSS-IND-PALO
              MOVE SPACES TO WSS-GLS-GLS1 IN WSS-M61
              MOVE 'Colocaciones Efectivas ' TO
                                     WSS-GLS-GLS2 IN WSS-M61
              MOVE 'Parts. 1105-1245,1405,1415 MB1' 
                                  TO WSS-GLS-GLO2 IN WSS-VARI 
              MOVE WSS-GLS-GLOS IN WSS-VARI TO 
                                     WSS-GLS-GLS3 IN WSS-M61
              MOVE '               Moneda Chilena          '
                                  TO WSS-GLS-GLS4 IN WSS-M61
              MOVE '   No Reajustable !        Reajustable '
                                  TO WSS-GLS-GLS5 IN WSS-M61.
           PERFORM PONE-PAL.
       FIN-PUT-TIT.
           EXIT.

       PONE-PAL SECTION.
       INI-PONE-PAL.
           IF WSS-IND-PALO = ' '
              MOVE '-'          TO WSS-IND-RAYA
           ELSE
              MOVE WSS-IND-PALO TO WSS-IND-RAYA.

           MOVE WSS-IND-CRUZ TO WSS-GLS-R000 IN WSS-M61.

           MOVE WSS-IND-PALO TO WSS-GLS-R001 IN WSS-M61.

           MOVE WSS-IND-PALO TO WSS-GLS-R010 IN WSS-M61 
                                WSS-GLS-R011 IN WSS-M61 
                                WSS-GLS-R012 IN WSS-M61 
                                WSS-GLS-R020 IN WSS-M61 
                                WSS-GLS-R021 IN WSS-M61 
                                WSS-GLS-R030 IN WSS-M61 
                                WSS-GLS-R040 IN WSS-M61 
                                WSS-GLS-R050 IN WSS-M61 
                                WSS-GLS-R060 IN WSS-M61 
                                WSS-GLS-R061 IN WSS-M61 
                                WSS-GLS-R070 IN WSS-M61. 

           MOVE WSS-IND-CRUZ TO WSS-GLS-R071 IN WSS-M61. 

           MOVE WSS-IND-PALO TO WSS-GLS-R080 IN WSS-M61 
                                WSS-GLS-R081 IN WSS-M61 
                                WSS-GLS-R090 IN WSS-M61 
                                WSS-GLS-R091 IN WSS-M61 
                                WSS-GLS-R100 IN WSS-M61 
                                WSS-GLS-R110 IN WSS-M61 
                                WSS-GLS-R120 IN WSS-M61 
                                WSS-GLS-R130 IN WSS-M61. 

           MOVE WSS-IND-CRUZ TO WSS-GLS-R131 IN WSS-M61. 

           MOVE WSS-IND-PALO TO WSS-GLS-R132 IN WSS-M61 
                                WSS-GLS-R140 IN WSS-M61 
                                WSS-GLS-R141 IN WSS-M61 
                                WSS-GLS-R142 IN WSS-M61 
                                WSS-GLS-R150 IN WSS-M61 
                                WSS-GLS-R160 IN WSS-M61 
                                WSS-GLS-R170 IN WSS-M61. 

           MOVE WSS-IND-CRUZ TO WSS-GLS-R171 IN WSS-M61. 

           MOVE WSS-IND-PALO TO WSS-GLS-R180 IN WSS-M61 
                                WSS-GLS-R181 IN WSS-M61 
                                WSS-GLS-R190 IN WSS-M61 
                                WSS-GLS-R200 IN WSS-M61 
                                WSS-GLS-R220 IN WSS-M61 
                                WSS-GLS-R210 IN WSS-M61.

           MOVE WSS-IND-PALO TO WSS-GLS-R220 IN WSS-M61 
                                WSS-GLS-R221 IN WSS-M61 
                                WSS-GLS-R230 IN WSS-M61 
                                WSS-GLS-R240 IN WSS-M61.

           MOVE WSS-IND-CRUZ TO WSS-GLS-R241 IN WSS-M61. 

           MOVE WSS-IND-PALO TO WSS-GLS-R250 IN WSS-M61 
                                WSS-GLS-R251 IN WSS-M61 
                                WSS-GLS-R260 IN WSS-M61 
                                WSS-GLS-R270 IN WSS-M61 
                                WSS-GLS-R280 IN WSS-M61 
                                WSS-GLS-R281 IN WSS-M61 
                                WSS-GLS-R290 IN WSS-M61. 

           MOVE WSS-IND-CRUZ TO WSS-GLS-R291 IN WSS-M61. 

           MOVE WSS-IND-PALO TO WSS-GLS-R300 IN WSS-M61.
           MOVE WSS-IND-PALO TO WSS-GLS-R300 IN WSS-M61.

       FIN-PONE-PAL.
           EXIT.

       LIMPIA-DET SECTION.
       INI-LIMPIA-DET.
           MOVE ZEROES TO SRT-VAL-021 IN SRT 
                          SRT-VAL-022 IN SRT 
                          SRT-VAL-023 IN SRT 
                          SRT-VAL-031 IN SRT 
                          SRT-VAL-032 IN SRT 
                          SRT-VAL-033 IN SRT 
                          SRT-VAL-041 IN SRT 
                          SRT-VAL-042 IN SRT 
                          SRT-VAL-043 IN SRT 
                          SRT-VAL-051 IN SRT 
                          SRT-VAL-052 IN SRT 
                          SRT-VAL-053 IN SRT 
                          SRT-VAL-061 IN SRT 
                          SRT-VAL-062 IN SRT 
                          SRT-VAL-063 IN SRT. 
 
           MOVE ZEROES TO SRT-VAL-091 IN SRT 
                          SRT-VAL-092 IN SRT 
                          SRT-VAL-093 IN SRT 
                          SRT-VAL-101 IN SRT 
                          SRT-VAL-102 IN SRT 
                          SRT-VAL-103 IN SRT 
                          SRT-VAL-111 IN SRT 
                          SRT-VAL-112 IN SRT 
                          SRT-VAL-113 IN SRT 
                          SRT-VAL-151 IN SRT 
                          SRT-VAL-152 IN SRT 
                          SRT-VAL-153 IN SRT 
                          SRT-VAL-191 IN SRT 
                          SRT-VAL-192 IN SRT 
                          SRT-VAL-193 IN SRT 
                          SRT-VAL-211 IN SRT 
                          SRT-VAL-212 IN SRT 
                          SRT-VAL-213 IN SRT.

           MOVE ZEROES TO SRT-VAL-221 IN SRT 
                          SRT-VAL-222 IN SRT 
                          SRT-VAL-223 IN SRT 
                          SRT-VAL-261 IN SRT 
                          SRT-VAL-262 IN SRT 
                          SRT-VAL-263 IN SRT 
                          SRT-VAL-271 IN SRT 
                          SRT-VAL-272 IN SRT 
                          SRT-VAL-273 IN SRT 
                          SRT-VAL-281 IN SRT 
                          SRT-VAL-282 IN SRT 
                          SRT-VAL-283 IN SRT. 

       FIN-LIMPIA-DET.
           EXIT.

       LIMPIA-TOT SECTION.
       INI-LIMPIA-TOT.
           MOVE ZEROES TO SRT-VAL-071 IN SRT 
                          SRT-VAL-072 IN SRT 
                          SRT-VAL-073 IN SRT 
                          SRT-VAL-121 IN SRT 
                          SRT-VAL-122 IN SRT 
                          SRT-VAL-123 IN SRT 
                          SRT-VAL-131 IN SRT 
                          SRT-VAL-132 IN SRT 
                          SRT-VAL-133 IN SRT 
                          SRT-VAL-171 IN SRT 
                          SRT-VAL-172 IN SRT 
                          SRT-VAL-173 IN SRT 
                          SRT-VAL-231 IN SRT 
                          SRT-VAL-232 IN SRT 
                          SRT-VAL-233 IN SRT 
                          SRT-VAL-241 IN SRT 
                          SRT-VAL-242 IN SRT 
                          SRT-VAL-243 IN SRT 
                          SRT-VAL-291 IN SRT 
                          SRT-VAL-292 IN SRT 
                          SRT-VAL-293 IN SRT 
                          SRT-VAL-301 IN SRT 
                          SRT-VAL-302 IN SRT 
                          SRT-VAL-303 IN SRT. 

           MOVE ZEROES TO SRT-VAL-311 IN SRT 
                          SRT-VAL-312 IN SRT 
                          SRT-VAL-313 IN SRT 
                          SRT-VAL-321 IN SRT 
                          SRT-VAL-322 IN SRT 
                          SRT-VAL-323 IN SRT.
       FIN-LIMPIA-TOT.
           EXIT.

       BUS-ULT-MES SECTION.
       INI-BUS-ULT-MES.
      * BUS-ULTIMO-DIA-MES
           MOVE WSS-FEC-FFIN TO FEC-FECH.
           MOVE 1 TO WSS-STAT-ULDM.
       LUP-BUS-ULT-MES.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
      *VAL-FEC Validar Fecha
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF WSS-STAT-ULDM = 1
              MOVE 0        TO WSS-STAT-ULDM
              MOVE FEC-FECH TO WSS-FEC-FULD.           

       NOT-BUS-ULT-MES.
           MOVE FEC-FECH TO WSS-FEC-FFIN.
           DISPLAY 'ULTIMO DIA DEL MES       ' WSS-FEC-FULD.
       FIN-BUS-ULT-MES.
           EXIT.

       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBFCAM.
      *>>>>
*% END
