*% IF FIN_PUT_D06_D06
      *<<<< FIN_PUT_D06_D06
      *BUS-OFI busca oficina en tablas
           MOVE D06-COD-OFIC IN D06-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN D06-FLD.
      *BUS-USR busca usuario en tablas
           MOVE D06-COD-ACRG IN D06-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN D06-FLD.
      *BUS-USR busca usuario en tablas
           MOVE D06-COD-AUMO IN D06-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN D06-FLD.
      *BUS-MSC busca codigo miscelaneo en tabla
           MOVE 'SUP' TO MSC-COD-SIST.
           MOVE 'ACLA' TO MSC-COD-TMSC IN MSC.
           MOVE D06-COD-CAAC IN D06 TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC IN MSG TO FRM-GLS-CAAC IN D06-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CAAC IN D06-FLD.
      *>>>>
*% END
*% IF INI_RET_D06_D06
      *<<<< INI_RET_D06_D06
           MOVE '2' TO D06-IND-TREG IN D06.
      *>>>>
*% END
*% IF INI_KEY_D06_D06
      *<<<< INI_KEY_D06_D06
           MOVE '2' TO D06-IND-TREG IN D06.
      *>>>>
*% END
*% IF D06_IND_RUTD
      *<<<< D06_IND_RUTD
      *VAL-MSC Valida miscelaneo de tabla
           MOVE 'GNS' TO MSC-COD-SIST.
           MOVE 'IRUT' TO MSC-COD-TMSC IN MSC.
           MOVE D06-IND-RUTD IN D06-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF D06_COD_OFIC
      *<<<< D06_COD_OFIC
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE D06-COD-OFIC IN D06-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN D06-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN D06-FLD.
      *>>>>
*% END
*% IF D06_COD_ACRG
      *<<<< D06_COD_ACRG
      *VAL-USR Valida Usuario
           MOVE D06-COD-ACRG IN D06-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-ACRG IN D06-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACRG IN D06-FLD.
      *>>>>
*% END
*% IF D06_COD_AUMO
      *<<<< D06_COD_AUMO
      *VAL-USR Valida Usuario
           MOVE D06-COD-AUMO IN D06-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-AUMO IN D06-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AUMO IN D06-FLD.
      *>>>>
*% END
*% IF D06_COD_CAAC
      *<<<< D06_COD_CAAC
           MOVE 'SUP' TO MSC-COD-SIST.
           MOVE 'ACLA' TO MSC-COD-TMSC.
           MOVE D06-COD-CAAC IN D06-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-MSC.
           IF MSG-COD-MENS NOT > SPACES
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CAAC IN D06-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SPACES TO FRM-GLS-CAAC IN D06-FLD.
      *>>>>
*% END
*% IF VAL_CON_FLD_D06
      *<<<< VAL_CON_FLD_D06
       VAL-FRCA-FCAS.
           MOVE D06-DMA-FCAS IN D06-FLD TO FEC-FEC1.
           MOVE D06-DMA-FRCA IN D06-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'FECFRCAFCAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D06.

           IF  D06-VAL-DRMN IN D06-FLD = ZEROES AND
               D06-VAL-DRME IN D06-FLD = ZEROES AND
               D06-VAL-IRMN IN D06-FLD = ZEROES AND
               D06-VAL-IRME IN D06-FLD = ZEROES
      *GET-MSG Busca mensaje en tabla
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALXXXXBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D06
           ELSE
               IF (    D06-VAL-DRMN IN D06-FLD +
                       D06-VAL-DRME IN D06-FLD +
                       D06-VAL-IRMN IN D06-FLD +
                       D06-VAL-IRME IN D06-FLD ) >
                       D06-VAL-CAST IN D06-FLD
      *GET-MSG Busca mensaje en tabla
               MOVE 'SUP' TO MSG-COD-SIST
               MOVE 'VALCAST<DDA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
