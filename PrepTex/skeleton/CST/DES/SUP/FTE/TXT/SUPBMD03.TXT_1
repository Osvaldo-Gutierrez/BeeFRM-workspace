*%! Codigo adicional para manejo mapa D03
*% IF INI_D03_DMA_TAS
      *<<<< 
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_D03_DMA_EXT
      *<<<< 
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF D03-VRF-RUT-DDR
      *<<<<
           IF (SCR-RUT-DDR = D03-NUM-RUT-DDR IN D03-FLD OR
               FRM-SUAR = FRM-SUAR-MAL)
               GO TO FIN-VAL-D03-VRF-RUT-DUE.

           MOVE D03-NUM-RUT-DDR IN D03-FLD TO W-NUM-RUT
           PERFORM BUS-CLIENTE
           MOVE DBC-GLS-NOMC IN DBC TO D03-NOM-DDR IN D03-FLD
           IF (FRM-SUAR = FRM-SUAR-MAL)
               MOVE -1 TO D03-VRF-RUT-DDR-LEN
           ELSE
               MOVE D03-NUM-RUT-DDR IN D03-FLD TO SCR-RUT-DDR.
      *>>>>
*% END
*% IF D03_VRF_RUT_DUE 
      *<<<<  
           IF (SCR-RUT-DUE = D03-NUM-RUT-DUE IN D03-FLD OR
               FRM-SUAR = FRM-SUAR-MAL)
               GO TO FIN-VAL-D03-VRF-RUT-DUE.

           MOVE D03-NUM-RUT-DUE IN D03-FLD TO W-NUM-RUT
           PERFORM BUS-CLIENTE
           MOVE DBC-GLS-NOMC IN DBC TO D03-NOM-DUE IN D03-FLD
           IF (FRM-SUAR = FRM-SUAR-MAL)
               MOVE -1 TO D03-VRF-RUT-DUE-LEN
           ELSE
               MOVE D03-NUM-RUT-DUE IN D03-FLD TO SCR-RUT-DUE.
      *>>>>
*% END
*% IF VAL_CON_FLD_D03
      *<<<<
           IF (D03-OPE-GAR IN D03-FLD = SPACES AND 
               D03-CLS-COB IN D03-FLD = 'E')
               MOVE 'INCONSIST. OPER. GARANTIZA V/S CLAUSULA COBERTURA'
               TO FRM-MENS
               MOVE -1 TO D03-CLS-COB-LEN IN D03-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D03.

           IF (D03-CLS-COB IN D03-FLD = 'E' AND
               D03-DMA-EXT IN D03-FLD NOT > '000000')
               MOVE 'FECHA EXTINCION OBLIGATORIA SEGUN CLAUSULA COB.'
               TO FRM-MENS
               MOVE -1 TO D03-CLS-COB-LEN IN D03-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D03.

           IF (D03-CLS-GAR-CLS IN D03-FLD = 2 AND
               D03-GAR-PRF IN D03-FLD = 0)
               MOVE 'GRADO PREFERANCIA OBLIGATORIO SEGUN CLASE DE GAR.'
               TO FRM-MENS
               MOVE -1 TO D03-GAR-PRF-LEN IN D03-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-D03.
      *<<<<
*% END          
*% IF EOF
      *<<<
       BUS-CLIENTE SECTION.
       INI-BUS-CLTE.
      *Lee DBC y puebla datos pantalla 
           MOVE W-NUM-RUT               TO DBC-NUM-ICLI IN DBC
           MOVE SPACES                  TO DBC-IND-ICLI IN DBC
           MOVE SPACES                  TO DBC-GLS-ICLI IN DBC
           MOVE FIO-GET-NLS             TO FIO-CMND
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY
           PERFORM SGC-FIO-DBC.

           IF NOT FIO-STAT-OKS OR 
                 (FIO-STAT-OKS AND W-NUM-RUT NOT = DBC-NUM-ICLI IN DBC)
                  MOVE '23'                  TO ADR-STAT IN ADR-DBC-REQA
                  MOVE 'SGC'                 TO MSG-COD-SIST
                  MOVE 'CLI    NEX'          TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC          TO FRM-MENS
                  MOVE '00'                  TO FIO-STAT
                  MOVE FRM-SUAR-MAL          TO FRM-SUAR
                  MOVE SPACES                TO DBC-GLS-NOMC IN DBC
              ELSE
                  MOVE SPACES                TO FRM-MENS
                  MOVE DBC-GLS-NOMC IN DBC   TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN              TO DBC-GLS-NOMC IN DBC.
       FIN-BUS-CLTE.
           EXIT.
      *>>>
*% END
