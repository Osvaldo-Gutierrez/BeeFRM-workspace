*%! Codigo adicional para programa
*% NO_HDR_CST = TRUE
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY SUPWIS21 REPLACING ==01  S21-FLD== BY ==03  S21-FLD==.
       COPY SUPWIS22 REPLACING ==01  S22-FLD== BY ==03  S22-FLD==.
       COPY SUPWGD02.
       COPY GNSBRMSC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY GNSBRLOG.
           03 LOG-GLS-DATA                       PIC X(695).
       COPY SUPBRD2L REPLACING ==D2L.== BY ==D2L REDEFINES LOG.==.
       COPY TABBRCOM.
       01  WSS-VARI-S22.
           03  WSS-COD-LOCA.
               05  WSS-COD-REGI                  PIC X(02).
               05  WSS-COD-PLZA                  PIC X(04). 
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% WIG_USR = TRUE
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
       COPY SUPLGD02.
      *>>>>
*% END
*% IF FIN_LUP_MAIN
      *<<<< FIN_LUP_MAIN
           MOVE FRM-MENS TO SCR-MENS-EXT.
           IF SCR-INST = SCR-INST-HCM
               PERFORM EGR-FTER-CMN
           ELSE
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF PRE_PRO_FLD
      *<<<< PRE_PRO_FLD
           MOVE '1'          TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *JSS MOVE S21-FLD-EXT TO S21-FLD.
           MOVE WSS-TCMA TO SCR-TCMA.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
                 MOVE WSS-INST-NULL TO SCR-INST-EXT
                 PERFORM ING-FPEN-CIC.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_SCR_GCNF OR PFS_GET_ACC OR PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD
      *<<<< SCR_GFLD_VAL_CON_FLD
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC
           IF FRM-FFLD = FRM-FFLD-PF7
               IF SCR-CONF > SPACES
                   PERFORM VAL-NUM-KEY-S22
                   PERFORM VAL-NUM-FLD-S22
                   PERFORM EGR-FPEN-BCK
               ELSE
                   PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF FIN_GET_CON OR FIN_SCR_GCNF
      *<<<< FIN_GET_CON OR FIN_SCR_GCNF
           IF FRM-FFLD = FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-S22
               PERFORM VAL-NUM-FLD-S22
               PERFORM EGR-FPEN-BCK.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           MOVE D02-COD-ACRG IN S22-FLD TO D02-COD-AUMO IN D02.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D02-NUM-DCRG IN D02.
           MOVE HOY-MHOY IN HOY-VARI TO D02-NUM-MCRG IN D02.
           MOVE HOY-AHOY IN HOY-VARI TO D02-NUM-ACRG IN D02.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO D02-NUM-DUMO IN D02.
           MOVE HOY-MHOY IN HOY-VARI TO D02-NUM-MUMO IN D02.
           MOVE HOY-AHOY IN HOY-VARI TO D02-NUM-AUMO IN D02.
      *>>>>
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'M'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D02-COD-ID02 TO LOG-COD-VKEY.
           MOVE D02          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D2L.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           MOVE 'N' TO LOG-IND-ACCI.
           MOVE D02 TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D2L.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING 
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'I'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D02-COD-ID02 TO LOG-COD-VKEY.
           MOVE D02          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D2L.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO LOG-NUM-DHOY IN LOG.
           MOVE HOY-MHOY IN HOY-VARI TO LOG-NUM-MHOY IN LOG.
           MOVE HOY-AHOY IN HOY-VARI TO LOG-NUM-AHOY IN LOG.
           MOVE HOY-HHHY IN HOY-VARI TO LOG-NUM-HHTT IN LOG.
           MOVE HOY-MMHY IN HOY-VARI TO LOG-NUM-MMTT IN LOG.
           MOVE HOY-SSHY IN HOY-VARI TO LOG-NUM-SSTT IN LOG.
           MOVE 'E'          TO LOG-IND-ACCI.
      *    MOVE SCR-USER     TO LOG-COD-USER.
           MOVE D02-COD-ID02 TO LOG-COD-VKEY.
           MOVE D02          TO LOG-GLS-DATA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SUP-FIO-D2L.
      *>>>>
*% END
*% IF INI_XCT_PRGP
      *<<<< 
           GO TO FIN-XCT-PRGP.
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
*% FRM = "S22"
*% INCLUDE 'GNSMMP'
      * COPY SUPBMS21.
*% IF PGM_PQ
      *<<<< 
       COPY SUPBQS21.
*% ELSE
       COPY SUPBUS21.
      *>>>>
*% END
       COPY SUPBFD2L.
       COPY GNSBBTAB.
       COPY GNSBFMSC.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY TABBVOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBVUSR.
      *>>>>
*% END
