*%! Codigo adicional
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
           03 WSS-I                         PIC 9(03).
           03 WSS-J                         PIC 9(03).
           03 WSS-IMAX         VALUE  200   PIC 9(03).
           03 WSS-TFUN.
              05 WSS-IFUN      OCCURS 200.
                 07 WSS-EXIS                PIC X(01).
                 07 WSS-CORR                PIC 9(03).
           03 WSS-TCMA.
              05 WSS-RCMA      OCCURS 200.
                 07 WSS-REXI                PIC X(01).
                 07 WSS-RFNS                PIC X(03).
                 07 WSS-RFUN                PIC X(03).
                 07 WSS-RACT                PIC X(09).
                 07 WSS-RENT                PIC X(03).
                 07 WSS-RLUG                PIC X(03).
                 07 WSS-RFAS.
                    09 WSS-RDAS             PIC 9(02).
                    09 WSS-RMAS             PIC 9(02).
                    09 WSS-RSAS             PIC 9(02).
                    09 WSS-RAAS             PIC 9(02).
                 07 WSS-RFES.
                    09 WSS-RDES             PIC 9(02).
                    09 WSS-RMES             PIC 9(02).
                    09 WSS-RSES             PIC 9(02).
                    09 WSS-RAES             PIC 9(02).
                 07 WSS-RFRE.
                    09 WSS-RDRE             PIC 9(02).
                    09 WSS-RMRE             PIC 9(02).
                    09 WSS-RSRE             PIC 9(02).
                    09 WSS-RARE             PIC 9(02).
                 07 WSS-RHES                PIC 9(03).
                 07 WSS-RHRE                PIC 9(03).
                 07 WSS-ROB1                PIC X(80).
                 07 WSS-ROB2                PIC X(80).
           03 WSS-LLIN         VALUE 05     PIC 9(02).
           03 WSS-NPAG         VALUE  0     PIC 9(02).
           03 WSS-LPAG         VALUE 40     PIC 9(02).
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE 0 TO CMA-NUM-CORR IN CMA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF FIO-STAT-OKS AND
              CMA-COD-CLIE IN CMA = CMA-COD-CLIE IN CMA-FLD AND
              CMA-COD-PROY IN CMA = CMA-COD-PROY IN CMA-FLD AND
              CMA-NUM-DSOL IN CMA = CMA-NUM-DSOL IN CMA-FLD AND
              CMA-NUM-MSOL IN CMA = CMA-NUM-MSOL IN CMA-FLD AND
              CMA-NUM-SSOL IN CMA = CMA-NUM-SSOL IN CMA-FLD AND
              CMA-NUM-ASOL IN CMA = CMA-NUM-ASOL IN CMA-FLD
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-CMA.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-CMA
               PERFORM FST-KEY-CMA.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           MOVE 1 TO WSS-NPAG.
           INITIALIZE WSS-TFUN.
           INITIALIZE WSS-TCMA.
           PERFORM LEA-FUNC.
           GO TO FIN-PUT-SCR.
      *>>>>
*% END
*% IF PFS_SCR_GFLD OR PFS_GET_CON
      *<<<< PFS_SCR_GFLD OR PFS_GET_CON
      *F7, F8, PREV-SCREEN, NEXT-SCREEN
           IF NOT ( FRM-FFLD = 50 OR 51 OR 37 OR 38 )
      *>>>>
*% END
*% IF SCR_GFLD_VAL_CON_FLD OR FIN_GET_CON
      *<<<< SCR_GFLD_VAL_CON_FLD OR FIN_GET_CON
      *F7, PREV-SCREEN
           IF FRM-FFLD = 50 OR 37
               IF WSS-NPAG = 1
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'CMA    NOPRV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 1 TO FRM-IFLD
               ELSE
                   PERFORM GUARDA-PANTALLA-ACTUAL
                   SUBTRACT 1 FROM WSS-NPAG
                   PERFORM DESPLIEGA-PANTALLA-ACTUAL
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 1 TO FRM-IFLD
           ELSE
      *F8, NEXT-SCREEN
           IF FRM-FFLD = 51 OR 38
               IF WSS-NPAG = WSS-LPAG
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'CMA    NONXT' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 1 TO FRM-IFLD
               ELSE
                   PERFORM GUARDA-PANTALLA-ACTUAL
                   ADD 1 TO WSS-NPAG
                   PERFORM DESPLIEGA-PANTALLA-ACTUAL
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE 1 TO FRM-IFLD
           ELSE
               PERFORM GUARDA-PANTALLA-ACTUAL.
      *>>>>
*% END
*% IF FIN_GET_CON
      *<<<< FIN_GET_CON
      *F7, F8, PREV-SCREEN, NEXT-SCREEN
           IF FRM-FFLD = 50 OR 51 OR 37 OR 38
               GO TO INI-GET-CON.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM ING-FUNC.
           GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD
           PERFORM MOD-FUNC.
           GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
           PERFORM ELI-FUNC.
           GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       LEA-FUNC SECTION.
       INI-LEA-FUNC.
           MOVE SPACES TO WSS-TFUN.
           MOVE 1 TO WSS-I.
       LUP-LEA-FUNC.
           MOVE 'S'                 TO FRM-COD-EXIS IN CMA-FLD(WSS-I).
           MOVE CMA-COD-FNSO IN CMA TO FRM-COD-FNSO IN CMA-FLD(WSS-I).
           MOVE CMA-COD-FUNC IN CMA TO FRM-COD-FUNC IN CMA-FLD(WSS-I).
           MOVE CMA-COD-ACTI IN CMA TO FRM-COD-ACTI IN CMA-FLD(WSS-I).
           MOVE CMA-COD-ENTI IN CMA TO FRM-COD-ENTI IN CMA-FLD(WSS-I).
           MOVE CMA-COD-LUGA IN CMA TO FRM-COD-LUGA IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-DASG IN CMA TO FRM-NUM-DASG IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-MASG IN CMA TO FRM-NUM-MASG IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-SASG IN CMA TO FRM-NUM-SASG IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-AASG IN CMA TO FRM-NUM-AASG IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-DESE IN CMA TO FRM-NUM-DESE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-MESE IN CMA TO FRM-NUM-MESE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-SESE IN CMA TO FRM-NUM-SESE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-AESE IN CMA TO FRM-NUM-AESE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-DREE IN CMA TO FRM-NUM-DREE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-MREE IN CMA TO FRM-NUM-MREE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-SREE IN CMA TO FRM-NUM-SREE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-AREE IN CMA TO FRM-NUM-AREE IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-HEST IN CMA TO FRM-NUM-HEST IN CMA-FLD(WSS-I).
           MOVE CMA-NUM-HREA IN CMA TO FRM-NUM-HREA IN CMA-FLD(WSS-I).
           MOVE CMA-GLS-OBS1 IN CMA TO FRM-GLS-OBS1 IN CMA-FLD(WSS-I).
           MOVE CMA-GLS-OBS2 IN CMA TO FRM-GLS-OBS2 IN CMA-FLD(WSS-I).
       CON-LEA-FUNC.
           MOVE 'S'                 TO WSS-REXI(WSS-I) WSS-EXIS(WSS-I).
           MOVE CMA-NUM-CORR IN CMA TO                 WSS-CORR(WSS-I).
           MOVE CMA-COD-FNSO IN CMA TO WSS-RFNS(WSS-I).
           MOVE CMA-COD-FUNC IN CMA TO WSS-RFUN(WSS-I).
           MOVE CMA-COD-ACTI IN CMA TO WSS-RACT(WSS-I).
           MOVE CMA-COD-ENTI IN CMA TO WSS-RENT(WSS-I).
           MOVE CMA-COD-LUGA IN CMA TO WSS-RLUG(WSS-I).
           MOVE CMA-NUM-DASG IN CMA TO WSS-RDAS(WSS-I).
           MOVE CMA-NUM-MASG IN CMA TO WSS-RMAS(WSS-I).
           MOVE CMA-NUM-SASG IN CMA TO WSS-RSAS(WSS-I).
           MOVE CMA-NUM-AASG IN CMA TO WSS-RAAS(WSS-I).
           MOVE CMA-NUM-DESE IN CMA TO WSS-RDES(WSS-I).
           MOVE CMA-NUM-MESE IN CMA TO WSS-RMES(WSS-I).
           MOVE CMA-NUM-SESE IN CMA TO WSS-RSES(WSS-I).
           MOVE CMA-NUM-AESE IN CMA TO WSS-RAES(WSS-I).
           MOVE CMA-NUM-DREE IN CMA TO WSS-RDRE(WSS-I).
           MOVE CMA-NUM-MREE IN CMA TO WSS-RMRE(WSS-I).
           MOVE CMA-NUM-SREE IN CMA TO WSS-RSRE(WSS-I).
           MOVE CMA-NUM-AREE IN CMA TO WSS-RARE(WSS-I).
           MOVE CMA-NUM-HEST IN CMA TO WSS-RHES(WSS-I).
           MOVE CMA-NUM-HREA IN CMA TO WSS-RHRE(WSS-I).
           MOVE CMA-GLS-OBS1 IN CMA TO WSS-ROB1(WSS-I).
           MOVE CMA-GLS-OBS2 IN CMA TO WSS-ROB2(WSS-I).
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-LEA-FUNC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF NOT ( FIO-STAT-OKS AND
                    CMA-COD-CLIE IN CMA = CMA-COD-CLIE IN CMA-FLD AND
                    CMA-COD-PROY IN CMA = CMA-COD-PROY IN CMA-FLD AND
                    CMA-NUM-DSOL IN CMA = CMA-NUM-DSOL IN CMA-FLD AND
                    CMA-NUM-MSOL IN CMA = CMA-NUM-MSOL IN CMA-FLD AND
                    CMA-NUM-SSOL IN CMA = CMA-NUM-SSOL IN CMA-FLD AND
                    CMA-NUM-ASOL IN CMA = CMA-NUM-ASOL IN CMA-FLD )
               GO TO FIN-LEA-FUNC.
           IF WSS-I > WSS-LLIN
               GO TO CON-LEA-FUNC
           ELSE
               GO TO LUP-LEA-FUNC.
       FIN-LEA-FUNC.
           EXIT.

       GUARDA-PANTALLA-ACTUAL SECTION.
       INI-GUARDA-PANTALLA-ACTUAL.
           SUBTRACT 1 FROM WSS-NPAG   GIVING WSS-I.
           MULTIPLY WSS-I BY WSS-LLIN GIVING WSS-I.
           MOVE 0 TO WSS-J.
       LUP-GUARDA-PANTALLA-ACTUAL.
           ADD 1 TO WSS-I.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-LLIN
               GO TO FIN-GUARDA-PANTALLA-ACTUAL.
           MOVE FRM-COD-EXIS IN CMA-FLD(WSS-J) TO WSS-REXI(WSS-I).
           MOVE FRM-COD-FNSO IN CMA-FLD(WSS-J) TO WSS-RFNS(WSS-I).
           MOVE FRM-COD-FUNC IN CMA-FLD(WSS-J) TO WSS-RFUN(WSS-I).
           MOVE FRM-COD-ACTI IN CMA-FLD(WSS-J) TO WSS-RACT(WSS-I).
           MOVE FRM-COD-ENTI IN CMA-FLD(WSS-J) TO WSS-RENT(WSS-I).
           MOVE FRM-COD-LUGA IN CMA-FLD(WSS-J) TO WSS-RLUG(WSS-I).
           MOVE FRM-NUM-DASG IN CMA-FLD(WSS-J) TO WSS-RDAS(WSS-I).
           MOVE FRM-NUM-MASG IN CMA-FLD(WSS-J) TO WSS-RMAS(WSS-I).
           MOVE FRM-NUM-SASG IN CMA-FLD(WSS-J) TO WSS-RSAS(WSS-I).
           MOVE FRM-NUM-AASG IN CMA-FLD(WSS-J) TO WSS-RAAS(WSS-I).
           MOVE FRM-NUM-DESE IN CMA-FLD(WSS-J) TO WSS-RDES(WSS-I).
           MOVE FRM-NUM-MESE IN CMA-FLD(WSS-J) TO WSS-RMES(WSS-I).
           MOVE FRM-NUM-SESE IN CMA-FLD(WSS-J) TO WSS-RSES(WSS-I).
           MOVE FRM-NUM-AESE IN CMA-FLD(WSS-J) TO WSS-RAES(WSS-I).
           MOVE FRM-NUM-DREE IN CMA-FLD(WSS-J) TO WSS-RDRE(WSS-I).
           MOVE FRM-NUM-MREE IN CMA-FLD(WSS-J) TO WSS-RMRE(WSS-I).
           MOVE FRM-NUM-SREE IN CMA-FLD(WSS-J) TO WSS-RSRE(WSS-I).
           MOVE FRM-NUM-AREE IN CMA-FLD(WSS-J) TO WSS-RARE(WSS-I).
           MOVE FRM-NUM-HEST IN CMA-FLD(WSS-J) TO WSS-RHES(WSS-I).
           MOVE FRM-NUM-HREA IN CMA-FLD(WSS-J) TO WSS-RHRE(WSS-I).
           MOVE FRM-GLS-OBS1 IN CMA-FLD(WSS-J) TO WSS-ROB1(WSS-I).
           MOVE FRM-GLS-OBS2 IN CMA-FLD(WSS-J) TO WSS-ROB2(WSS-I).
           GO TO LUP-GUARDA-PANTALLA-ACTUAL.
       FIN-GUARDA-PANTALLA-ACTUAL.
           EXIT.

       DESPLIEGA-PANTALLA-ACTUAL SECTION.
       INI-DESPLIEGA-PANTALLA-ACTUAL.
           SUBTRACT 1 FROM WSS-NPAG   GIVING WSS-I.
           MULTIPLY WSS-I BY WSS-LLIN GIVING WSS-I.
           MOVE 0 TO WSS-J.
       LUP-DESPLIEGA-PANTALLA-ACTUAL.
           ADD 1 TO WSS-I.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-LLIN
               GO TO FIN-DESPLIEGA-PANTALLA-ACTUAL.
           MOVE WSS-REXI(WSS-I) TO FRM-COD-EXIS IN CMA-FLD(WSS-J).
           MOVE WSS-RFNS(WSS-I) TO FRM-COD-FNSO IN CMA-FLD(WSS-J).
           MOVE WSS-RFUN(WSS-I) TO FRM-COD-FUNC IN CMA-FLD(WSS-J).
           MOVE WSS-RACT(WSS-I) TO FRM-COD-ACTI IN CMA-FLD(WSS-J).
           MOVE WSS-RENT(WSS-I) TO FRM-COD-ENTI IN CMA-FLD(WSS-J).
           MOVE WSS-RLUG(WSS-I) TO FRM-COD-LUGA IN CMA-FLD(WSS-J).
           MOVE WSS-RDAS(WSS-I) TO FRM-NUM-DASG IN CMA-FLD(WSS-J).
           MOVE WSS-RMAS(WSS-I) TO FRM-NUM-MASG IN CMA-FLD(WSS-J).
           MOVE WSS-RSAS(WSS-I) TO FRM-NUM-SASG IN CMA-FLD(WSS-J).
           MOVE WSS-RAAS(WSS-I) TO FRM-NUM-AASG IN CMA-FLD(WSS-J).
           MOVE WSS-RDES(WSS-I) TO FRM-NUM-DESE IN CMA-FLD(WSS-J).
           MOVE WSS-RMES(WSS-I) TO FRM-NUM-MESE IN CMA-FLD(WSS-J).
           MOVE WSS-RSES(WSS-I) TO FRM-NUM-SESE IN CMA-FLD(WSS-J).
           MOVE WSS-RAES(WSS-I) TO FRM-NUM-AESE IN CMA-FLD(WSS-J).
           MOVE WSS-RDRE(WSS-I) TO FRM-NUM-DREE IN CMA-FLD(WSS-J).
           MOVE WSS-RMRE(WSS-I) TO FRM-NUM-MREE IN CMA-FLD(WSS-J).
           MOVE WSS-RSRE(WSS-I) TO FRM-NUM-SREE IN CMA-FLD(WSS-J).
           MOVE WSS-RARE(WSS-I) TO FRM-NUM-AREE IN CMA-FLD(WSS-J).
           MOVE WSS-RHES(WSS-I) TO FRM-NUM-HEST IN CMA-FLD(WSS-J).
           MOVE WSS-RHRE(WSS-I) TO FRM-NUM-HREA IN CMA-FLD(WSS-J).
           MOVE WSS-ROB1(WSS-I) TO FRM-GLS-OBS1 IN CMA-FLD(WSS-J).
           MOVE WSS-ROB2(WSS-I) TO FRM-GLS-OBS2 IN CMA-FLD(WSS-J).
           GO TO LUP-DESPLIEGA-PANTALLA-ACTUAL.
       FIN-DESPLIEGA-PANTALLA-ACTUAL.
           EXIT.

       ING-FUNC SECTION.
       INI-ING-FUNC.
           MOVE 0 TO WSS-I.
       LUP-ING-FUNC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ING-FUNC.
           IF WSS-REXI(WSS-I) NOT = 'S'
               GO TO LUP-ING-FUNC.
           PERFORM KEY-ALL-CMA.
           MOVE WSS-I           TO CMA-NUM-CORR IN CMA.
           MOVE WSS-RFNS(WSS-I) TO CMA-COD-FNSO IN CMA.
           MOVE WSS-RFUN(WSS-I) TO CMA-COD-FUNC IN CMA.
           MOVE WSS-RACT(WSS-I) TO CMA-COD-ACTI IN CMA.
           MOVE WSS-RENT(WSS-I) TO CMA-COD-ENTI IN CMA.
           MOVE WSS-RLUG(WSS-I) TO CMA-COD-LUGA IN CMA.
           MOVE WSS-RDAS(WSS-I) TO CMA-NUM-DASG IN CMA. 
           MOVE WSS-RMAS(WSS-I) TO CMA-NUM-MASG IN CMA.
           MOVE WSS-RSAS(WSS-I) TO CMA-NUM-SASG IN CMA.
           MOVE WSS-RAAS(WSS-I) TO CMA-NUM-AASG IN CMA.
           MOVE WSS-RDES(WSS-I) TO CMA-NUM-DESE IN CMA. 
           MOVE WSS-RMES(WSS-I) TO CMA-NUM-MESE IN CMA.
           MOVE WSS-RSES(WSS-I) TO CMA-NUM-SESE IN CMA.
           MOVE WSS-RAES(WSS-I) TO CMA-NUM-AESE IN CMA.
           MOVE WSS-RDRE(WSS-I) TO CMA-NUM-DREE IN CMA.
           MOVE WSS-RMRE(WSS-I) TO CMA-NUM-MREE IN CMA.
           MOVE WSS-RSRE(WSS-I) TO CMA-NUM-SREE IN CMA.
           MOVE WSS-RARE(WSS-I) TO CMA-NUM-AREE IN CMA.
           MOVE WSS-RHES(WSS-I) TO CMA-NUM-HEST IN CMA.
           MOVE WSS-RHRE(WSS-I) TO CMA-NUM-HREA IN CMA.
           MOVE WSS-ROB1(WSS-I) TO CMA-GLS-OBS1 IN CMA.
           MOVE WSS-ROB2(WSS-I) TO CMA-GLS-OBS2 IN CMA.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF FIO-STAT-OKS
               GO TO LUP-ING-FUNC.
           MOVE 'ADM' TO MSG-COD-SIST.
           MOVE 'CMA    NOPUT' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE CMA-KEY-ICMA IN CMA TO FRM-MEN2.
       FIN-ING-FUNC.
           EXIT.

       ELI-FUNC SECTION.
       INI-ELI-FUNC.
           MOVE 0 TO WSS-I.
       LUP-ELI-FUNC.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ELI-FUNC.
           IF WSS-EXIS(WSS-I) NOT = 'S'
               GO TO LUP-ELI-FUNC.
           PERFORM KEY-ALL-CMA.
           MOVE WSS-CORR(WSS-I) TO CMA-NUM-CORR IN CMA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ELI-FUNC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF FIO-STAT-OKS
               GO TO LUP-ELI-FUNC.
       ERR-ELI-FUNC.
           MOVE 'ADM' TO MSG-COD-SIST.
           MOVE 'CMA    NOELI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE CMA-KEY-ICMA IN CMA TO FRM-MEN2.
       FIN-ELI-FUNC.
           EXIT.

       MOD-FUNC SECTION.
       INI-MOD-FUNC.
           PERFORM ELI-FUNC-WSS.
           IF MSG-COD-MENS NOT > SPACES
               PERFORM ING-FUNC.
       FIN-MOD-FUNC.
           EXIT.

       ELI-FUNC-WSS SECTION.
       INI-ELI-FUNC-WSS.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 0 TO WSS-I.
       LUP-ELI-FUNC-WSS.
           ADD 1 TO WSS-I.
           IF WSS-I > WSS-IMAX
               GO TO FIN-ELI-FUNC-WSS.
           IF WSS-EXIS IN WSS-VARI(WSS-I) NOT = 'S'
               GO TO LUP-ELI-FUNC-WSS.
           PERFORM KEY-ALL-CMA.
           MOVE WSS-CORR IN WSS-VARI(WSS-I) TO CMA-NUM-CORR IN CMA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF NOT FIO-STAT-OKS
               GO TO ERR-ELI-FUNC-WSS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM ADM-FIO-CMA.
           IF FIO-STAT-OKS
               GO TO LUP-ELI-FUNC-WSS.
       ERR-ELI-FUNC-WSS.
           MOVE 'ADM' TO MSG-COD-SIST.
           MOVE 'CMA    NOELI' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC        TO FRM-MEN1.
           MOVE CMA-KEY-ICMA IN CMA TO FRM-MEN2.
       FIN-ELI-FUNC-WSS.
           EXIT.
      *>>>>
*% END
