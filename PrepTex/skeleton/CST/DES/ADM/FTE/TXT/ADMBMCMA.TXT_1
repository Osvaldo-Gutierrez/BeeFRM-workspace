*%! Codigo adicional
*% IF FRM_COD_EXIS
      *<<<< FRM_COD_EXIS
           IF FRM-COD-FNSO IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-FUNC IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-ACTI IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-ENTI IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-LUGA IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-NUM-DASG IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-MASG IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-SASG IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-AASG IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-DESE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-MESE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-SESE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-AESE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-DREE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-MREE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-SREE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-AREE IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-HEST IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-HREA IN CMA-FLD(FRM-IFLD) > ZEROES OR
              FRM-GLS-OBS1 IN CMA-FLD(FRM-IFLD) > SPACES OR
              FRM-GLS-OBS2 IN CMA-FLD(FRM-IFLD) > SPACES
               MOVE 'S' TO FRM-COD-EXIS IN CMA-FLD(FRM-IFLD)
           ELSE
               MOVE 'N' TO FRM-COD-EXIS IN CMA-FLD(FRM-IFLD).
      *>>>>
*% END
*% IF FRM_COD_FNSO
      *<<<< FRM_COD_FNSO
           IF FRM-COD-FNSO IN CMA-FLD(FRM-IFLD) > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'CLI' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-FNSO IN CMA-FLD(FRM-IFLD) TO
                    TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_FUNC
      *<<<< FRM_COD_FUNC
           IF FRM-COD-FUNC IN CMA-FLD(FRM-IFLD) > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-FUNC IN CMA-FLD(FRM-IFLD) TO
                    TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_ACTI
      *<<<< FRM_COD_ACTI
           IF FRM-COD-ACTI IN CMA-FLD(FRM-IFLD) > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'ACT' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-ACTI IN CMA-FLD(FRM-IFLD) TO
                    TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_ENTI
      *<<<< FRM_COD_ENTI
           IF FRM-COD-ENTI IN CMA-FLD(FRM-IFLD) > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'ENT' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-ENTI IN CMA-FLD(FRM-IFLD) TO
                    TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_LUGA
      *<<<< FRM_COD_LUGA
           IF FRM-COD-LUGA IN CMA-FLD(FRM-IFLD) > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'LUG' TO TAB-COD-TTAB IN TAB
               MOVE FRM-COD-LUGA IN CMA-FLD(FRM-IFLD) TO
                    TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_FEC_FASG
      *<<<< FRM_FEC_FASG
           IF FRM-FEC-FASG IN CMA-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-FRM-FEC-FASG.
           MOVE CMA-NUM-DSOL IN CMA-FLD           TO FEC-DEC1.
           MOVE CMA-NUM-MSOL IN CMA-FLD           TO FEC-MEC1.
           MOVE CMA-NUM-SSOL IN CMA-FLD           TO FEC-SEC1.
           MOVE CMA-NUM-ASOL IN CMA-FLD           TO FEC-AEC1.
           MOVE FRM-NUM-DASG IN CMA-FLD(FRM-IFLD) TO FEC-DEC2.
           MOVE FRM-NUM-MASG IN CMA-FLD(FRM-IFLD) TO FEC-MEC2.
           MOVE FRM-NUM-SASG IN CMA-FLD(FRM-IFLD) TO FEC-SEC2.
           MOVE FRM-NUM-AASG IN CMA-FLD(FRM-IFLD) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'CMAFSOLFASG>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_FRM_FEC_FESE
      *<<<< INI_FRM_FEC_FESE
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF FRM_FEC_FESE
      *<<<< FRM_FEC_FESE
           IF FRM-FEC-FESE IN CMA-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-FRM-FEC-FESE.
           MOVE CMA-NUM-DSOL IN CMA-FLD           TO FEC-DEC1.
           MOVE CMA-NUM-MSOL IN CMA-FLD           TO FEC-MEC1.
           MOVE CMA-NUM-SSOL IN CMA-FLD           TO FEC-SEC1.
           MOVE CMA-NUM-ASOL IN CMA-FLD           TO FEC-AEC1.
           MOVE FRM-NUM-DESE IN CMA-FLD(FRM-IFLD) TO FEC-DEC2.
           MOVE FRM-NUM-MESE IN CMA-FLD(FRM-IFLD) TO FEC-MEC2.
           MOVE FRM-NUM-SESE IN CMA-FLD(FRM-IFLD) TO FEC-SEC2.
           MOVE FRM-NUM-AESE IN CMA-FLD(FRM-IFLD) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'CMAFSOLFESE>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-FEC-FESE.
           IF FRM-FEC-FASG IN CMA-FLD(FRM-IFLD) > ZEROES
               MOVE FRM-NUM-DASG IN CMA-FLD(FRM-IFLD) TO FEC-DEC1
               MOVE FRM-NUM-MASG IN CMA-FLD(FRM-IFLD) TO FEC-MEC1
               MOVE FRM-NUM-SASG IN CMA-FLD(FRM-IFLD) TO FEC-SEC1
               MOVE FRM-NUM-AASG IN CMA-FLD(FRM-IFLD) TO FEC-AEC1
               MOVE FRM-NUM-DESE IN CMA-FLD(FRM-IFLD) TO FEC-DEC2
               MOVE FRM-NUM-MESE IN CMA-FLD(FRM-IFLD) TO FEC-MEC2
               MOVE FRM-NUM-SESE IN CMA-FLD(FRM-IFLD) TO FEC-SEC2
               MOVE FRM-NUM-AESE IN CMA-FLD(FRM-IFLD) TO FEC-AEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'ADM' TO MSG-COD-SIST
                   MOVE 'CMAFASGFESE>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FRM_FEC_FREE
      *<<<< FRM_FEC_FREE
           IF FRM-FEC-FREE IN CMA-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-FRM-FEC-FREE.
           MOVE CMA-NUM-DSOL IN CMA-FLD           TO FEC-DEC1.
           MOVE CMA-NUM-MSOL IN CMA-FLD           TO FEC-MEC1.
           MOVE CMA-NUM-SSOL IN CMA-FLD           TO FEC-SEC1.
           MOVE CMA-NUM-ASOL IN CMA-FLD           TO FEC-AEC1.
           MOVE FRM-NUM-DREE IN CMA-FLD(FRM-IFLD) TO FEC-DEC2.
           MOVE FRM-NUM-MREE IN CMA-FLD(FRM-IFLD) TO FEC-MEC2.
           MOVE FRM-NUM-SREE IN CMA-FLD(FRM-IFLD) TO FEC-SEC2.
           MOVE FRM-NUM-AREE IN CMA-FLD(FRM-IFLD) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'CMAFSOLFREE>' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-FEC-FREE.
           IF FRM-FEC-FASG IN CMA-FLD(FRM-IFLD) > ZEROES
               MOVE FRM-NUM-DASG IN CMA-FLD(FRM-IFLD) TO FEC-DEC1
               MOVE FRM-NUM-MASG IN CMA-FLD(FRM-IFLD) TO FEC-MEC1
               MOVE FRM-NUM-SASG IN CMA-FLD(FRM-IFLD) TO FEC-SEC1
               MOVE FRM-NUM-AASG IN CMA-FLD(FRM-IFLD) TO FEC-AEC1
               MOVE FRM-NUM-DREE IN CMA-FLD(FRM-IFLD) TO FEC-DEC2
               MOVE FRM-NUM-MREE IN CMA-FLD(FRM-IFLD) TO FEC-MEC2
               MOVE FRM-NUM-SREE IN CMA-FLD(FRM-IFLD) TO FEC-SEC2
               MOVE FRM-NUM-AREE IN CMA-FLD(FRM-IFLD) TO FEC-AEC2
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-CMP-FEC  TO FEC-CMND
               PERFORM PRO-FEC
               IF FEC-STAT-GRT
                   MOVE 'ADM' TO MSG-COD-SIST
                   MOVE 'CMAFASGFREE>' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
