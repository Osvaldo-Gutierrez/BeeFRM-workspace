*%! Codigo adicional
*% INI_LBL = TRUE
*% IF INI_IDT_FEC_FACT 
      *<<<< INI_IDT_FEC_FACT
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF IDT_COD_FUNC 
      *<<<< IDT_COD_FUNC
      *>>>>
*% END
*% IF IDT_NUM_CORR 
      *<<<< IDT_NUM_CORR
      *>>>>
*% END
*% IF FIN_PUT_ALL_IDT 
      *<<<< FIN_PUT_ALL_IDT
      *JUS
           PERFORM BUS-REQ.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-PUT-ALL-IDT.
           PERFORM BUS-CCOS.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-PUT-ALL-IDT.
           PERFORM BUS-ACT.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-PUT-ALL-IDT.
      *>>>>
*% END
*% IF VAL_CON_FLD_IDT
      *<<<< VAL_CON_FLD_IDT
           IF (( IDT-NUM-HINI IN IDT-FLD > ZEROES ) OR
               ( IDT-NUM-MINI IN IDT-FLD > ZEROES ))
                IF NOT (( IDT-NUM-HTER IN IDT-FLD > ZEROES ) OR
                        ( IDT-NUM-MTER IN IDT-FLD > ZEROES ))
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'HRAHTERNOT>0' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT
               ELSE
                   NEXT SENTENCE
           ELSE
                IF (( IDT-NUM-HTER IN IDT-FLD > ZEROES ) OR
                    ( IDT-NUM-MTER IN IDT-FLD > ZEROES ))
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'HRAINICNOT>0' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.
           IF NOT ((( IDT-NUM-HINI IN IDT-FLD > ZEROES ) OR
                    ( IDT-NUM-MINI IN IDT-FLD > ZEROES ))
               AND (( IDT-NUM-HTER IN IDT-FLD > ZEROES ) OR
                    ( IDT-NUM-MTER IN IDT-FLD > ZEROES ))          
               OR  (( IDT-NUM-HTOT IN IDT-FLD > ZEROES ) OR
                    ( IDT-NUM-MTOT IN IDT-FLD > ZEROES )))
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'IYTOTNOT>0' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.

      *JUS-INI 7-DEC-1995 17:29:35 
           IF IDT-NUM-HINI IN IDT-FLD < ZEROES OR
              IDT-NUM-HINI IN IDT-FLD > 23
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'HRAOUTRANG' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.

           IF IDT-NUM-MINI IN IDT-FLD < ZEROES OR
              IDT-NUM-MINI IN IDT-FLD > 59
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'MINOUTRANG' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.

           IF IDT-NUM-HTER IN IDT-FLD < ZEROES OR
              IDT-NUM-HTER IN IDT-FLD > 23
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'HRAOUTRANG' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.

           IF IDT-NUM-MTER IN IDT-FLD < ZEROES OR
              IDT-NUM-MTER IN IDT-FLD > 59
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'MINOUTRANG' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-IDT.

           PERFORM BUS-REQ.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-VAL-CON-FLD-IDT.

           IF TAB-GLS-DATA IN TAB NOT > SPACES
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE 'EN REQ.DEBE INDICAR CENTRO COSTO' TO FRM-MENS
                 GO TO FIN-VAL-CON-FLD-IDT.

           MOVE IDT-COD-CCOS IN IDT-FLD TO WSS-COD-CCOS.
           IF WSS-COD-CCOS = SPACES
              MOVE TAB-GLS-DATA IN TAB TO IDT-COD-CCOS IN IDT-FLD
           ELSE
              IF WSS-COD-CCLI NOT = 'CST' AND TAB-GLS-DATA IN TAB
                 NOT = IDT-COD-CCOS IN IDT-FLD
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE 'SE DEBE RESPETAR CENTRO COSTO DE REQ.' TO FRM-MENS
                GO TO FIN-VAL-CON-FLD-IDT.

           PERFORM BUS-CCOS.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-VAL-CON-FLD-IDT.

           PERFORM BUS-ACT.
           IF FRM-SUAR = FRM-SUAR-MAL
              GO TO FIN-VAL-CON-FLD-IDT.
      *JUS-FIN
      *>>>>
*% END
*% IF IDT_NUM_HTOT
      *<<<< IDT_NUM_HTOT
           IF ((( IDT-NUM-HINI IN IDT-FLD > ZEROES ) OR
                ( IDT-NUM-MINI IN IDT-FLD > ZEROES )) AND 
               (( IDT-NUM-HTER IN IDT-FLD > ZEROES ) OR
                ( IDT-NUM-MTER IN IDT-FLD > ZEROES )))        
              MULTIPLY IDT-NUM-HINI IN IDT-FLD BY 60
                GIVING WSS-NUM-MINI IN WSS-VARI
              ADD IDT-NUM-MINI IN IDT-FLD TO WSS-NUM-MINI IN WSS-VARI
              MULTIPLY IDT-NUM-HTER IN IDT-FLD BY 60
                GIVING WSS-NUM-MTER IN WSS-VARI
              ADD IDT-NUM-MTER IN IDT-FLD TO WSS-NUM-MTER IN WSS-VARI
              IF WSS-NUM-MINI IN WSS-VARI > WSS-NUM-MTER IN WSS-VARI
                   MOVE 'ADM'          TO MSG-COD-SIST
                   MOVE 'HRAINIC>TERM' TO MSG-COD-MENS IN MSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-IDT-NUM-HTOT
              ELSE
                  SUBTRACT WSS-NUM-MTER IN WSS-VARI FROM
                     WSS-NUM-MINI IN WSS-VARI GIVING
                     WSS-NUM-MAUX IN WSS-VARI
                  DIVIDE WSS-NUM-MAUX IN WSS-VARI BY 60 GIVING
                     IDT-NUM-HTOT IN IDT-FLD REMAINDER
                     IDT-NUM-MTOT IN IDT-FLD.
      *>>>>
*% END
