*%! Codigo adicional para archivo
*% IF FIN_PUT_ALL_PTR
      *<<<< FIN_PUT_ALL_PTR
      *    Fecha Inicio Programada
           MOVE PTR-NUM-SIPR IN PTR-FLD TO FEC-SEC1.
           MOVE PTR-NUM-AIPR IN PTR-FLD TO FEC-AEC1.
           MOVE PTR-NUM-MIPR IN PTR-FLD TO FEC-MEC1.
           MOVE PTR-NUM-DIPR IN PTR-FLD TO FEC-DEC1.
      *    Fecha termino Programada
           MOVE PTR-NUM-STPR IN PTR-FLD TO FEC-SEC2.
           MOVE PTR-NUM-ATPR IN PTR-FLD TO FEC-AEC2.
           MOVE PTR-NUM-MTPR IN PTR-FLD TO FEC-MEC2.
           MOVE PTR-NUM-DTPR IN PTR-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           MOVE FEC-NDIA TO FRM-NUM-DHBP IN PTR-FLD.

      *    Fecha Inicio Real
           MOVE PTR-NUM-SIRE IN PTR-FLD TO FEC-SEC1.
           MOVE PTR-NUM-AIRE IN PTR-FLD TO FEC-AEC1.
           MOVE PTR-NUM-MIRE IN PTR-FLD TO FEC-MEC1.
           MOVE PTR-NUM-DIRE IN PTR-FLD TO FEC-DEC1.
      *    Fecha termino Real
           MOVE PTR-NUM-STRE IN PTR-FLD TO FEC-SEC2.
           MOVE PTR-NUM-ATRE IN PTR-FLD TO FEC-AEC2.
           MOVE PTR-NUM-MTRE IN PTR-FLD TO FEC-MEC2.
           MOVE PTR-NUM-DTRE IN PTR-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           MOVE FEC-NDIA TO FRM-NUM-DHBR IN PTR-FLD.
      *>>>>
*% END
*% IF INI_PTR_FEC_FIRE 
      *<<<< INI_PTR_FEC_FIRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF INI_PTR_FEC_FTRE 
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF INI_PTR_FEC_FIPR 
      *<<<< INI_PTR_FEC_FIPR 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF INI_PTR_FEC_FTPR
      *<<<< INI_PTR_FEC_FTPR
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
*% END
*% IF PTR_FEC_FTPR
      *<<<< PTR_FEC_FTPR
      *    Fecha Inicio Programada
           MOVE PTR-NUM-SIPR IN PTR-FLD TO WSS-NUM-SIPR IN WSS-VARI.
           MOVE PTR-NUM-AIPR IN PTR-FLD TO WSS-NUM-AIPR IN WSS-VARI.
           MOVE PTR-NUM-MIPR IN PTR-FLD TO WSS-NUM-MIPR IN WSS-VARI.
           MOVE PTR-NUM-DIPR IN PTR-FLD TO WSS-NUM-DIPR IN WSS-VARI.
      *
      *    Fecha Termino Programada
           MOVE PTR-NUM-STPR IN PTR-FLD TO WSS-NUM-STPR IN WSS-VARI.
           MOVE PTR-NUM-ATPR IN PTR-FLD TO WSS-NUM-ATPR IN WSS-VARI.
           MOVE PTR-NUM-MTPR IN PTR-FLD TO WSS-NUM-MTPR IN WSS-VARI.
           MOVE PTR-NUM-DTPR IN PTR-FLD TO WSS-NUM-DTPR IN WSS-VARI.

           IF WSS-FEC-FTPR IN WSS-VARI < WSS-FEC-FIPR IN WSS-VARI
      * Fecha Termino Programada debe ser >= Fecha Inicio Programada
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FECFTPRFIPR<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF PTR_FEC_FING
      *<<<< PTR_FEC_FING
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO PTR-NUM-DING IN PTR-FLD.
           MOVE HOY-MHOY TO PTR-NUM-MING IN PTR-FLD.
           MOVE HOY-SHOY TO PTR-NUM-SING IN PTR-FLD.
           MOVE HOY-AHOY TO PTR-NUM-AING IN PTR-FLD.
      *>>>>
*% END
*% IF VAL_CON_FLD_PTR
      *<<<< VAL_CON_FLD_PTR
      * consistencia de fecha inic real y fecha term real
           IF PTR-FEC-FIRE IN PTR-FLD NOT > ZEROES AND
              PTR-FEC-FTRE IN PTR-FLD NOT > ZEROES
      * ambas fechas son cero. es decir aun no empieza realmente la actividad
               GO TO FIN-VAL-CON-FLD-PTR.
           IF ( PTR-FEC-FIRE IN PTR-FLD NOT > ZEROES AND
                PTR-FEC-FTRE IN PTR-FLD > ZEROES )   OR
              ( PTR-FEC-FIRE IN PTR-FLD > ZEROES AND
                PTR-FEC-FTRE IN PTR-FLD NOT > ZEROES )
      * ambas fechas deben ser distintas de cero
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FIREFTRE>0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTR.
      *    Fecha Inicio real
           MOVE PTR-NUM-SIRE IN PTR-FLD TO WSS-NUM-SIRE IN WSS-VARI.
           MOVE PTR-NUM-AIRE IN PTR-FLD TO WSS-NUM-AIRE IN WSS-VARI.
           MOVE PTR-NUM-MIRE IN PTR-FLD TO WSS-NUM-MIRE IN WSS-VARI.
           MOVE PTR-NUM-DIRE IN PTR-FLD TO WSS-NUM-DIRE IN WSS-VARI.
      *
      *    Fecha Termino real
           MOVE PTR-NUM-STRE IN PTR-FLD TO WSS-NUM-STRE IN WSS-VARI.
           MOVE PTR-NUM-ATRE IN PTR-FLD TO WSS-NUM-ATRE IN WSS-VARI.
           MOVE PTR-NUM-MTRE IN PTR-FLD TO WSS-NUM-MTRE IN WSS-VARI.
           MOVE PTR-NUM-DTRE IN PTR-FLD TO WSS-NUM-DTRE IN WSS-VARI.

           IF WSS-FEC-FTRE IN WSS-VARI < WSS-FEC-FIRE IN WSS-VARI
      * Fecha Termino real debe ser >= Fecha Inicio real 
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FECFTREFIRE<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *>>>>
*% END
*% IF EOF_VAX
      *<<<< EOF_VAX
      *>>>>
*% END
