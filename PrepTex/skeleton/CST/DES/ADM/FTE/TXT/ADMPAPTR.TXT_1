*%! codigo adicional
*% IF WSS 
      *<<<< WSS 
       01  WSS-VARI.
      *    Fecha Inicio Programada
           03 WSS-FEC-FIPR.
              05 WSS-NUM-SIPR                  PIC 9(02).
              05 WSS-NUM-AIPR                  PIC 9(02).
              05 WSS-NUM-MIPR                  PIC 9(02).
              05 WSS-NUM-DIPR                  PIC 9(02).
      *
      *    Fecha Termino Programada
           03 WSS-FEC-FTPR.
              05 WSS-NUM-STPR                  PIC 9(02).
              05 WSS-NUM-ATPR                  PIC 9(02).
              05 WSS-NUM-MTPR                  PIC 9(02).
              05 WSS-NUM-DTPR                  PIC 9(02).

      *    Fecha Inicio real
           03 WSS-FEC-FIRE.
              05 WSS-NUM-SIRE                  PIC 9(02).
              05 WSS-NUM-AIRE                  PIC 9(02).
              05 WSS-NUM-MIRE                  PIC 9(02).
              05 WSS-NUM-DIRE                  PIC 9(02).
      *
      *    Fecha Termino real
           03 WSS-FEC-FTRE.
              05 WSS-NUM-STRE                  PIC 9(02).
              05 WSS-NUM-ATRE                  PIC 9(02).
              05 WSS-NUM-MTRE                  PIC 9(02).
              05 WSS-NUM-DTRE                  PIC 9(02).

           03  WSS-KEY-IPTR.
               05  WSS-COD-CLIE                PIC X(03).
               05  WSS-COD-PROY                PIC X(03).
               05  WSS-COD-EVEN                PIC X(09).
               05  WSS-COD-ETAP                PIC X(09).
               05  WSS-COD-ACTI                PIC X(09).
               05  WSS-NUM-CORR                PIC 9(03).
               05  WSS-FEC-FING.
                   07 WSS-NUM-SING             PIC 9(02).
                   07 WSS-NUM-AING             PIC 9(02).
                   07 WSS-NUM-MING             PIC 9(02).
                   07 WSS-NUM-DING             PIC 9(02).
           03  WSS-ICOR              VALUE ' ' PIC X(01).
               88 WSS-ASIGNE-CORRELATIVO VALUE 'S'.
      *>>>>
*% END
*% IF INI_FIO_VAX
      *<<<< INI_FIO_VAX
           MOVE 'ADM'        TO FIO-SIST.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           PERFORM GNS-FIO-TAB.
           MOVE 'ADM'        TO FIO-SIST.
           MOVE FIO-INP      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE 'N' TO WSS-ICOR.
           IF SCR-CCPP = 'ING'
               PERFORM BUS-CORR
           ELSE
           IF PTR-NUM-CORR IN PTR-FLD = ZEROES
               PERFORM BUS-CORR.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF ( NOT FIO-STAT-OKS ) AND
              ( SCR-CCPP = 'ACT' ) AND
              ( NOT WSS-ASIGNE-CORRELATIVO )
                 MOVE FIO-STAT-NEX TO FIO-STAT.
      *>>>>
*% END
*% IF PFS_GET_ACC 
      *<<<< PFS_GET_ACC 
              AND NOT ( FRM-FFLD = 38 OR FRM-FFLD = 51 )
      *>>>>
*% END
*% IF PFS_GET_CON 
      *<<<< PFS_GET_CON 
              AND NOT ( FRM-FFLD = 38 OR FRM-FFLD = 51 )
      *>>>>
*% END
*% IF PFS_SCR_MOD 
      *<<<< PFS_SCR_MOD
           IF FRM-FFLD = 38 OR
              FRM-FFLD = 51
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM ADM-FIO-PTR
               IF FIO-STAT-OKS
                   PERFORM PUT-SCR
                   GO TO TRL-SCR-MOD
               ELSE
                   MOVE 'ADM' TO MSG-COD-SIST
                   MOVE 'EOF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-SCR-MOD.
      *>>>>
*% END
*% IF PFS_SCR_ACC 
      *<<<< PFS_SCR_ACC 
           IF FRM-FFLD = 38 OR
              FRM-FFLD = 51
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM ADM-FIO-PTR
               IF FIO-STAT-OKS
                   PERFORM PUT-SCR
                   GO TO TRL-SCR-ACC
               ELSE
                   MOVE 'ADM' TO MSG-COD-SIST
                   MOVE 'EOF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-SCR-ACC.
      *>>>>
*% END
*% IF FIN_SCR_ING
      *ESTE CODIGO DEBE QUEDAR ANTES DEL PERFORM SCR-DMSG
      *( SE DEBE ARREGLAR EL ESQUELETO )
      *<<<< FIN_SCR_ING
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.

           MOVE SPACES TO PTR-COD-ACTI IN PTR-FLD.
           MOVE SPACES TO PTR-GLS-SACT IN PTR-FLD.
           MOVE ZEROES TO PTR-NUM-PRIO IN PTR-FLD.
           MOVE SPACES TO PTR-COD-ESTA IN PTR-FLD.
           MOVE ZEROES TO PTR-FEC-FIPR IN PTR-FLD.
           MOVE ZEROES TO PTR-FEC-FTPR IN PTR-FLD.
           MOVE ZEROES TO PTR-FEC-FIRE IN PTR-FLD.
           MOVE ZEROES TO PTR-FEC-FTRE IN PTR-FLD.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.
      *>>>>
*% END
*% IF EOF_VAX
      *<<<< EOF_VAX
       BUS-CORR SECTION.
       INI-BUS-CORR.
           MOVE 'S' TO WSS-ICOR.
           MOVE 00 TO PTR-NUM-CORR IN PTR-FLD.
           MOVE 00 TO PTR-NUM-CORR IN PTR.

           MOVE PTR-COD-CLIE IN PTR TO WSS-COD-CLIE IN WSS-VARI.
           MOVE PTR-COD-PROY IN PTR TO WSS-COD-PROY IN WSS-VARI.
           MOVE PTR-COD-EVEN IN PTR TO WSS-COD-EVEN IN WSS-VARI.
           MOVE PTR-COD-ETAP IN PTR TO WSS-COD-ETAP IN WSS-VARI.
           MOVE PTR-COD-ACTI IN PTR TO WSS-COD-ACTI IN WSS-VARI.
           MOVE PTR-FEC-FING IN PTR TO WSS-FEC-FING IN WSS-VARI.

           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-CORR.
           PERFORM ADM-FIO-PTR.
           IF FIO-STAT-OKS AND
              PTR-COD-CLIE IN PTR = WSS-COD-CLIE IN WSS-VARI AND
              PTR-COD-PROY IN PTR = WSS-COD-PROY IN WSS-VARI AND
              PTR-COD-EVEN IN PTR = WSS-COD-EVEN IN WSS-VARI AND
              PTR-COD-ETAP IN PTR = WSS-COD-ETAP IN WSS-VARI AND
              PTR-COD-ACTI IN PTR = WSS-COD-ACTI IN WSS-VARI AND
              PTR-FEC-FING IN PTR = WSS-FEC-FING IN WSS-VARI
               MOVE PTR-NUM-CORR IN PTR TO PTR-NUM-CORR IN PTR-FLD
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-CORR.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO PTR-NUM-CORR IN PTR-FLD.
           MOVE WSS-COD-CLIE IN WSS-VARI TO PTR-COD-CLIE IN PTR.
           MOVE WSS-COD-PROY IN WSS-VARI TO PTR-COD-PROY IN PTR.
           MOVE WSS-COD-EVEN IN WSS-VARI TO PTR-COD-EVEN IN PTR.
           MOVE WSS-COD-ETAP IN WSS-VARI TO PTR-COD-ETAP IN PTR.
           MOVE WSS-COD-ACTI IN WSS-VARI TO PTR-COD-ACTI IN PTR.
           MOVE PTR-NUM-CORR IN PTR-FLD  TO PTR-NUM-CORR IN PTR.
           MOVE WSS-FEC-FING IN WSS-VARI TO PTR-FEC-FING IN PTR.
       FIN-BUS-CORR.
           EXIT.
      *>>>>
*% END
