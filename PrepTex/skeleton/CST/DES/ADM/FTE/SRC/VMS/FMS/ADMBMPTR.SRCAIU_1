      * 28-MAY-90 06:22 PM
       PUT-ALL-PTR SECTION.
       INI-PUT-ALL-PTR.
           PERFORM PUT-PTR-PTR.
      *<<<< FIN_PUT_ALL_PTR
      *    Fecha Inicio Programada
           MOVE PTR-NUM-SIPR IN PTR-FLD TO FEC-SEC1.
           MOVE PTR-NUM-AIPR IN PTR-FLD TO FEC-AEC1.
           MOVE PTR-NUM-MIPR IN PTR-FLD TO FEC-MEC1.
           MOVE PTR-NUM-DIPR IN PTR-FLD TO FEC-DEC1.
      *    Fecha termino Programada
           MOVE PTR-NUM-STPR IN PTR-FLD TO FEC-SEC2.
           MOVE PTR-NUM-ATPR IN PTR-FLD TO FEC-AEC2.
           MOVE PTR-NUM-MTPR IN PTR-FLD TO FEC-MEC2.
           MOVE PTR-NUM-DTPR IN PTR-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           MOVE FEC-NDIA TO FRM-NUM-DHBP IN PTR-FLD.

      *    Fecha Inicio Real
           MOVE PTR-NUM-SIRE IN PTR-FLD TO FEC-SEC1.
           MOVE PTR-NUM-AIRE IN PTR-FLD TO FEC-AEC1.
           MOVE PTR-NUM-MIRE IN PTR-FLD TO FEC-MEC1.
           MOVE PTR-NUM-DIRE IN PTR-FLD TO FEC-DEC1.
      *    Fecha termino Real
           MOVE PTR-NUM-STRE IN PTR-FLD TO FEC-SEC2.
           MOVE PTR-NUM-ATRE IN PTR-FLD TO FEC-AEC2.
           MOVE PTR-NUM-MTRE IN PTR-FLD TO FEC-MEC2.
           MOVE PTR-NUM-DTRE IN PTR-FLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA TO FEC-CMND.
           PERFORM PRO-FEC.
           MOVE FEC-NDIA TO FRM-NUM-DHBR IN PTR-FLD.
      *>>>>
       FIN-PUT-ALL-PTR.
           EXIT.
       
       PUT-PTR-PTR SECTION.
       INI-PUT-PTR-PTR.
           IF PGM-STAT-PTR-NUL
               GO TO FIN-PUT-PTR-PTR.
           IF NOT PGM-STAT-PTR-OKS
               PERFORM CLR-PTR-PTR
               GO TO FIN-PUT-PTR-PTR.
           MOVE PTR-COD-CLIE IN PTR TO PTR-COD-CLIE IN PTR-FLD.
           MOVE PTR-COD-PROY IN PTR TO PTR-COD-PROY IN PTR-FLD.
           MOVE PTR-COD-EVEN IN PTR TO PTR-COD-EVEN IN PTR-FLD.
           MOVE PTR-COD-ETAP IN PTR TO PTR-COD-ETAP IN PTR-FLD.
           MOVE PTR-COD-ACTI IN PTR TO PTR-COD-ACTI IN PTR-FLD.
           MOVE PTR-NUM-CORR IN PTR TO PTR-NUM-CORR IN PTR-FLD.
           MOVE PTR-GLS-SACT IN PTR TO PTR-GLS-SACT IN PTR-FLD.
           MOVE PTR-NUM-PRIO IN PTR TO PTR-NUM-PRIO IN PTR-FLD.
           MOVE PTR-COD-ESTA IN PTR TO PTR-COD-ESTA IN PTR-FLD.
           MOVE PTR-NUM-DIPR IN PTR TO PTR-NUM-DIPR IN PTR-FLD.
           MOVE PTR-NUM-MIPR IN PTR TO PTR-NUM-MIPR IN PTR-FLD.
           MOVE PTR-NUM-SIPR IN PTR TO PTR-NUM-SIPR IN PTR-FLD.
           MOVE PTR-NUM-AIPR IN PTR TO PTR-NUM-AIPR IN PTR-FLD.
           MOVE PTR-NUM-DTPR IN PTR TO PTR-NUM-DTPR IN PTR-FLD.
           MOVE PTR-NUM-MTPR IN PTR TO PTR-NUM-MTPR IN PTR-FLD.
           MOVE PTR-NUM-STPR IN PTR TO PTR-NUM-STPR IN PTR-FLD.
           MOVE PTR-NUM-ATPR IN PTR TO PTR-NUM-ATPR IN PTR-FLD.
           MOVE PTR-NUM-DIRE IN PTR TO PTR-NUM-DIRE IN PTR-FLD.
           MOVE PTR-NUM-MIRE IN PTR TO PTR-NUM-MIRE IN PTR-FLD.
           MOVE PTR-NUM-SIRE IN PTR TO PTR-NUM-SIRE IN PTR-FLD.
           MOVE PTR-NUM-AIRE IN PTR TO PTR-NUM-AIRE IN PTR-FLD.
           MOVE PTR-NUM-DTRE IN PTR TO PTR-NUM-DTRE IN PTR-FLD.
           MOVE PTR-NUM-MTRE IN PTR TO PTR-NUM-MTRE IN PTR-FLD.
           MOVE PTR-NUM-STRE IN PTR TO PTR-NUM-STRE IN PTR-FLD.
           MOVE PTR-NUM-ATRE IN PTR TO PTR-NUM-ATRE IN PTR-FLD.
           MOVE PTR-COD-APRG IN PTR TO PTR-COD-APRG IN PTR-FLD.
           MOVE PTR-COD-RESP IN PTR TO PTR-COD-RESP IN PTR-FLD.
           MOVE PTR-COD-EJEC IN PTR TO PTR-COD-EJEC IN PTR-FLD.
           MOVE PTR-COD-USUA IN PTR TO PTR-COD-USUA IN PTR-FLD.
           MOVE PTR-COD-INGR IN PTR TO PTR-COD-INGR IN PTR-FLD.
           MOVE PTR-NUM-DING IN PTR TO PTR-NUM-DING IN PTR-FLD.
           MOVE PTR-NUM-MING IN PTR TO PTR-NUM-MING IN PTR-FLD.
           MOVE PTR-NUM-SING IN PTR TO PTR-NUM-SING IN PTR-FLD.
           MOVE PTR-NUM-AING IN PTR TO PTR-NUM-AING IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-CLIE IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'CLI' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-CLIE IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CLIE IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-PROY IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'PRO' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-PROY IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-PROY IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-EVEN IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'EVN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-EVEN IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EVEN IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-ETAP IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'ETP' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-ETAP IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ETAP IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-ACTI IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'ENT' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-ACTI IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ACTI IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-ESTA IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'EST' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-ESTA IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-APRG IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-APRG IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-APRG IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-RESP IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-RESP IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-RESP IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-EJEC IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-EJEC IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EJEC IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-USUA IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-USUA IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-USUA IN PTR-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF PTR-COD-INGR IN PTR-FLD > SPACES
               MOVE 'ADM' TO TAB-COD-SIST
               MOVE 'FUN' TO TAB-COD-TTAB IN TAB
               MOVE PTR-COD-INGR IN PTR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-INGR IN PTR-FLD.
       FIN-PUT-PTR-PTR.
           EXIT.
       
       RET-ALL-PTR SECTION.
       INI-RET-ALL-PTR.
           PERFORM KEY-ALL-PTR.
           PERFORM RET-PTR-PTR.
       FIN-RET-ALL-PTR.
           EXIT.
       
       RET-PTR-PTR SECTION.
       INI-RET-PTR-PTR.
           MOVE PTR-GLS-SACT IN PTR-FLD TO PTR-GLS-SACT IN PTR.
           MOVE PTR-NUM-PRIO IN PTR-FLD TO PTR-NUM-PRIO IN PTR.
           MOVE PTR-COD-ESTA IN PTR-FLD TO PTR-COD-ESTA IN PTR.
           MOVE PTR-NUM-DIPR IN PTR-FLD TO PTR-NUM-DIPR IN PTR.
           MOVE PTR-NUM-MIPR IN PTR-FLD TO PTR-NUM-MIPR IN PTR.
           MOVE PTR-NUM-SIPR IN PTR-FLD TO PTR-NUM-SIPR IN PTR.
           MOVE PTR-NUM-AIPR IN PTR-FLD TO PTR-NUM-AIPR IN PTR.
           MOVE PTR-NUM-DTPR IN PTR-FLD TO PTR-NUM-DTPR IN PTR.
           MOVE PTR-NUM-MTPR IN PTR-FLD TO PTR-NUM-MTPR IN PTR.
           MOVE PTR-NUM-STPR IN PTR-FLD TO PTR-NUM-STPR IN PTR.
           MOVE PTR-NUM-ATPR IN PTR-FLD TO PTR-NUM-ATPR IN PTR.
           MOVE PTR-NUM-DIRE IN PTR-FLD TO PTR-NUM-DIRE IN PTR.
           MOVE PTR-NUM-MIRE IN PTR-FLD TO PTR-NUM-MIRE IN PTR.
           MOVE PTR-NUM-SIRE IN PTR-FLD TO PTR-NUM-SIRE IN PTR.
           MOVE PTR-NUM-AIRE IN PTR-FLD TO PTR-NUM-AIRE IN PTR.
           MOVE PTR-NUM-DTRE IN PTR-FLD TO PTR-NUM-DTRE IN PTR.
           MOVE PTR-NUM-MTRE IN PTR-FLD TO PTR-NUM-MTRE IN PTR.
           MOVE PTR-NUM-STRE IN PTR-FLD TO PTR-NUM-STRE IN PTR.
           MOVE PTR-NUM-ATRE IN PTR-FLD TO PTR-NUM-ATRE IN PTR.
           MOVE PTR-COD-APRG IN PTR-FLD TO PTR-COD-APRG IN PTR.
           MOVE PTR-COD-RESP IN PTR-FLD TO PTR-COD-RESP IN PTR.
           MOVE PTR-COD-EJEC IN PTR-FLD TO PTR-COD-EJEC IN PTR.
           MOVE PTR-COD-USUA IN PTR-FLD TO PTR-COD-USUA IN PTR.
           MOVE PTR-COD-INGR IN PTR-FLD TO PTR-COD-INGR IN PTR.
       FIN-RET-PTR-PTR.
           EXIT.
       
       KEY-ALL-PTR SECTION.
       INI-KEY-ALL-PTR.
           PERFORM KEY-PTR-PTR.
       FIN-KEY-ALL-PTR.
           EXIT.
       
       KEY-PTR-PTR SECTION.
       INI-KEY-PTR-PTR.
           MOVE PTR-COD-CLIE IN PTR-FLD TO PTR-COD-CLIE IN PTR.
           MOVE PTR-COD-PROY IN PTR-FLD TO PTR-COD-PROY IN PTR.
           MOVE PTR-COD-EVEN IN PTR-FLD TO PTR-COD-EVEN IN PTR.
           MOVE PTR-COD-ETAP IN PTR-FLD TO PTR-COD-ETAP IN PTR.
           MOVE PTR-COD-ACTI IN PTR-FLD TO PTR-COD-ACTI IN PTR.
           MOVE PTR-NUM-CORR IN PTR-FLD TO PTR-NUM-CORR IN PTR.
           MOVE PTR-NUM-DING IN PTR-FLD TO PTR-NUM-DING IN PTR.
           MOVE PTR-NUM-MING IN PTR-FLD TO PTR-NUM-MING IN PTR.
           MOVE PTR-NUM-SING IN PTR-FLD TO PTR-NUM-SING IN PTR.
           MOVE PTR-NUM-AING IN PTR-FLD TO PTR-NUM-AING IN PTR.
       FIN-KEY-PTR-PTR.
           EXIT.
       
       SCR-CLRA-PTR SECTION.
       INI-SCR-CLRA-PTR.
           MOVE FRM-CLR-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-CLRA-PTR.
           EXIT.
       
       CLR-KEY-PTR SECTION.
       INI-CLR-KEY-PTR.
           MOVE SPACES TO PTR-COD-CLIE IN PTR-FLD.
           MOVE SPACES TO PTR-COD-PROY IN PTR-FLD.
           MOVE SPACES TO PTR-COD-EVEN IN PTR-FLD.
           MOVE SPACES TO PTR-COD-ETAP IN PTR-FLD.
           MOVE SPACES TO PTR-COD-ACTI IN PTR-FLD.
           MOVE ZEROES TO PTR-NUM-CORR IN PTR-FLD.
           MOVE SPACES TO PTR-FEC-FING IN PTR-FLD.
       FIN-CLR-KEY-PTR.
           EXIT.
       
       CLR-FLD-PTR SECTION.
       INI-CLR-FLD-PTR.
           MOVE SPACES TO FRM-GLS-CLIE IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-PROY IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-EVEN IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-ETAP IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-ACTI IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-ESTA IN PTR-FLD.
           MOVE ZEROES TO FRM-NUM-DHBP IN PTR-FLD.
           MOVE ZEROES TO FRM-NUM-DHBR IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-APRG IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-RESP IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-USUA IN PTR-FLD.
           MOVE SPACES TO FRM-GLS-INGR IN PTR-FLD.
           PERFORM CLR-PTR-PTR.
       FIN-CLR-FLD-PTR.
           EXIT.
       
       CLR-PTR-PTR SECTION.
       INI-CLR-PTR-PTR.
           MOVE SPACES TO PTR-GLS-SACT IN PTR-FLD.
           MOVE ZEROES TO PTR-NUM-PRIO IN PTR-FLD.
           MOVE SPACES TO PTR-COD-ESTA IN PTR-FLD.
           MOVE SPACES TO PTR-FEC-FIPR IN PTR-FLD.
           MOVE SPACES TO PTR-FEC-FTPR IN PTR-FLD.
           MOVE SPACES TO PTR-FEC-FIRE IN PTR-FLD.
           MOVE SPACES TO PTR-FEC-FTRE IN PTR-FLD.
           MOVE SPACES TO PTR-COD-APRG IN PTR-FLD.
           MOVE SPACES TO PTR-COD-RESP IN PTR-FLD.
           MOVE SPACES TO PTR-COD-EJEC IN PTR-FLD.
           MOVE SPACES TO PTR-COD-USUA IN PTR-FLD.
           MOVE SPACES TO PTR-COD-INGR IN PTR-FLD.
       FIN-CLR-PTR-PTR.
           EXIT.
       
       FST-KEY-PTR SECTION.
       INI-FST-KEY-PTR.
           MOVE -1 TO PTR-COD-CLIE-LEN IN PTR-FLD.
       FIN-FST-KEY-PTR.
           EXIT.
       
       FST-FLD-PTR SECTION.
       INI-FST-FLD-PTR.
           MOVE -1 TO PTR-GLS-SACT-LEN IN PTR-FLD.
       FIN-FST-FLD-PTR.
           EXIT.
       
       PRO-KEY-PTR SECTION.
       INI-PRO-KEY-PTR.
           PERFORM PRO-IKY-PTR.
           PERFORM PRO-AKY-PTR.
           PERFORM PRO-MKY-PTR.
       FIN-PRO-KEY-PTR.
           EXIT.
       
       PRO-IKY-PTR SECTION.
       INI-PRO-IKY-PTR.
           MOVE FRM-CPIM-AEY TO PTR-COD-CLIE-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-PROY-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-EVEN-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-ETAP-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-ACTI-ATR IN PTR-FLD.
       FIN-PRO-IKY-PTR.
           EXIT.
       
       PRO-MKY-PTR SECTION.
       INI-PRO-MKY-PTR.
           MOVE FRM-CPIM-AEY TO PTR-FEC-FING-ATR IN PTR-FLD.
       FIN-PRO-MKY-PTR.
           EXIT.
       
       PRO-AKY-PTR SECTION.
       INI-PRO-AKY-PTR.
           MOVE FRM-CPIM-AEY TO PTR-NUM-CORR-ATR IN PTR-FLD.
       FIN-PRO-AKY-PTR.
           EXIT.
       
       PRO-FLD-PTR SECTION.
       INI-PRO-FLD-PTR.
           PERFORM PRO-PTR-PTR.
       FIN-PRO-FLD-PTR.
           EXIT.
       
       PRO-PTR-PTR SECTION.
       INI-PRO-PTR-PTR.
           MOVE FRM-CPIM-AEY TO PTR-GLS-SACT-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-NUM-PRIO-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-ESTA-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-FEC-FIPR-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-FEC-FTPR-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-FEC-FIRE-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-FEC-FTRE-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-APRG-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-RESP-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-EJEC-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-USUA-ATR IN PTR-FLD.
           MOVE FRM-CPIM-AEY TO PTR-COD-INGR-ATR IN PTR-FLD.
       FIN-PRO-PTR-PTR.
           EXIT.
       
       UNP-KEY-PTR SECTION.
       INI-UNP-KEY-PTR.
           PERFORM UNP-IKY-PTR.
           PERFORM UNP-AKY-PTR.
           PERFORM UNP-MKY-PTR.
       FIN-UNP-KEY-PTR.
           EXIT.
       
       UNP-IKY-PTR SECTION.
       INI-UNP-IKY-PTR.
           MOVE FRM-CPIM-UBY TO PTR-COD-CLIE-ATR.
           MOVE FRM-CPIM-UBY TO PTR-COD-PROY-ATR.
           MOVE FRM-CPIM-UBY TO PTR-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO PTR-COD-ETAP-ATR.
           MOVE FRM-CPIM-UBY TO PTR-COD-ACTI-ATR.
       FIN-UNP-IKY-PTR.
           EXIT.
       
       UNP-MKY-PTR SECTION.
       INI-UNP-MKY-PTR.
           MOVE FRM-CPIM-UBY TO PTR-FEC-FING-ATR.
       FIN-UNP-MKY-PTR.
           EXIT.
       
       UNP-AKY-PTR SECTION.
       INI-UNP-AKY-PTR.
           MOVE FRM-CPIM-UBY TO PTR-NUM-CORR-ATR.
       FIN-UNP-AKY-PTR.
           EXIT.
       
       UNP-FLD-PTR SECTION.
       INI-UNP-FLD-PTR.
           PERFORM UNP-PTR-PTR.
       FIN-UNP-FLD-PTR.
           EXIT.
       
       UNP-PTR-PTR SECTION.
       INI-UNP-PTR-PTR.
           MOVE FRM-CPIM-UBY TO PTR-GLS-SACT-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-NUM-PRIO-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-ESTA-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-FEC-FIPR-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-FEC-FTPR-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-FEC-FIRE-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-FEC-FTRE-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-APRG-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-RESP-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-EJEC-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-USUA-ATR IN PTR-FLD.
           MOVE FRM-CPIM-UBY TO PTR-COD-INGR-ATR IN PTR-FLD.
       FIN-UNP-PTR-PTR.
           EXIT.
       
       VAL-KEY-PTR SECTION.
       INI-VAL-KEY-PTR.
           PERFORM VAL-IKY-PTR.
           PERFORM VAL-MKY-PTR.
           PERFORM VAL-AKY-PTR.
       FIN-VAL-KEY-PTR.
           EXIT.
       
       VAL-IKY-PTR SECTION.
       INI-VAL-IKY-PTR.
           PERFORM VAL-PTR-COD-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-CLIE-LEN IN PTR-FLD
                GO TO FIN-VAL-IKY-PTR.
           PERFORM VAL-PTR-COD-PROY.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-PROY-LEN IN PTR-FLD
                GO TO FIN-VAL-IKY-PTR.
           PERFORM VAL-PTR-COD-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-EVEN-LEN IN PTR-FLD
                GO TO FIN-VAL-IKY-PTR.
           PERFORM VAL-PTR-COD-ETAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-ETAP-LEN IN PTR-FLD
                GO TO FIN-VAL-IKY-PTR.
           PERFORM VAL-PTR-COD-ACTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-ACTI-LEN IN PTR-FLD
                GO TO FIN-VAL-IKY-PTR.
       FIN-VAL-IKY-PTR.
           EXIT.
       
       VAL-MKY-PTR SECTION.
       INI-VAL-MKY-PTR.
           PERFORM VAL-PTR-FEC-FING.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-FEC-FING-LEN IN PTR-FLD
                GO TO FIN-VAL-MKY-PTR.
       FIN-VAL-MKY-PTR.
           EXIT.
       
       VAL-AKY-PTR SECTION.
       INI-VAL-AKY-PTR.
           PERFORM VAL-PTR-NUM-CORR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-NUM-CORR-LEN IN PTR-FLD
                GO TO FIN-VAL-AKY-PTR.
       FIN-VAL-AKY-PTR.
           EXIT.
       
       VAL-FLD-PTR SECTION.
       INI-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-CLIE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-CLIE-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-PROY.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-PROY-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-EVEN.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-EVEN-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-ETAP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ETAP-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-ACTI.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ACTI-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-GLS-SACT.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-GLS-SACT-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-NUM-PRIO.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-NUM-PRIO-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-ESTA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-ESTA-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-ESTA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ESTA-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-FEC-FIPR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-FEC-FIPR-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-FEC-FTPR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-FEC-FTPR-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-FEC-FIRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-FEC-FIRE-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-FEC-FTRE.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-FEC-FTRE-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-NUM-DHBP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-DHBP-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-NUM-DHBR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-DHBR-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-APRG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-APRG-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-RESP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-RESP-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-APRG.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-APRG-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-RESP.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-RESP-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-EJEC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-EJEC-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-USUA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-USUA-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-EJEC.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-EJEC-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-USUA.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-USUA-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-PTR-COD-INGR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO PTR-COD-INGR-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
           PERFORM VAL-FRM-GLS-INGR.
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-INGR-LEN IN PTR-FLD
                GO TO FIN-VAL-FLD-PTR.
       FIN-VAL-FLD-PTR.
           EXIT.
       
       VAL-PTR-COD-CLIE SECTION.
       INI-VAL-PTR-COD-CLIE.
           IF PTR-COD-CLIE IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-COD-CLIE IN PTR-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'CLI' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-CLIE IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-CLIE IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CLIE IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CLIE IN PTR-FLD.
       FIN-VAL-PTR-COD-CLIE.
           EXIT.
       
       VAL-PTR-COD-PROY SECTION.
       INI-VAL-PTR-COD-PROY.
           IF PTR-COD-PROY IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-COD-PROY IN PTR-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'PRO' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-PROY IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-PROY IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PROY IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-PROY IN PTR-FLD.
       FIN-VAL-PTR-COD-PROY.
           EXIT.
       
       VAL-FRM-GLS-CLIE SECTION.
       INI-VAL-FRM-GLS-CLIE.
           IF FRM-GLS-CLIE IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-CLIE IN PTR-FLD.
       FIN-VAL-FRM-GLS-CLIE.
           EXIT.
       
       VAL-FRM-GLS-PROY SECTION.
       INI-VAL-FRM-GLS-PROY.
           IF FRM-GLS-PROY IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-PROY IN PTR-FLD.
       FIN-VAL-FRM-GLS-PROY.
           EXIT.
       
       VAL-PTR-COD-EVEN SECTION.
       INI-VAL-PTR-COD-EVEN.
           IF PTR-COD-EVEN IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-COD-EVEN IN PTR-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'EVN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-EVEN IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-EVEN IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EVEN IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EVEN IN PTR-FLD.
       FIN-VAL-PTR-COD-EVEN.
           EXIT.
       
       VAL-PTR-COD-ETAP SECTION.
       INI-VAL-PTR-COD-ETAP.
           IF PTR-COD-ETAP IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-COD-ETAP IN PTR-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'ETP' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-ETAP IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-ETAP IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ETAP IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ETAP IN PTR-FLD.
       FIN-VAL-PTR-COD-ETAP.
           EXIT.
       
       VAL-FRM-GLS-EVEN SECTION.
       INI-VAL-FRM-GLS-EVEN.
           IF FRM-GLS-EVEN IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-EVEN IN PTR-FLD.
       FIN-VAL-FRM-GLS-EVEN.
           EXIT.
       
       VAL-FRM-GLS-ETAP SECTION.
       INI-VAL-FRM-GLS-ETAP.
           IF FRM-GLS-ETAP IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ETAP IN PTR-FLD.
       FIN-VAL-FRM-GLS-ETAP.
           EXIT.
       
       VAL-PTR-COD-ACTI SECTION.
       INI-VAL-PTR-COD-ACTI.
           IF PTR-COD-ACTI IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-COD-ACTI IN PTR-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'ENT' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-ACTI IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-ACTI IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ACTI IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ACTI IN PTR-FLD.
       FIN-VAL-PTR-COD-ACTI.
           EXIT.
       
       VAL-PTR-NUM-CORR SECTION.
       INI-VAL-PTR-NUM-CORR.
       FIN-VAL-PTR-NUM-CORR.
           EXIT.
       
       VAL-FRM-GLS-ACTI SECTION.
       INI-VAL-FRM-GLS-ACTI.
           IF FRM-GLS-ACTI IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ACTI IN PTR-FLD.
       FIN-VAL-FRM-GLS-ACTI.
           EXIT.
       
       VAL-PTR-GLS-SACT SECTION.
       INI-VAL-PTR-GLS-SACT.
           IF PTR-GLS-SACT IN PTR-FLD NOT > SPACES
              MOVE SPACES TO PTR-GLS-SACT IN PTR-FLD.
       FIN-VAL-PTR-GLS-SACT.
           EXIT.
       
       VAL-PTR-NUM-PRIO SECTION.
       INI-VAL-PTR-NUM-PRIO.
           IF PTR-NUM-PRIO IN PTR-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-NUM-PRIO.
       FIN-VAL-PTR-NUM-PRIO.
           EXIT.
       
       VAL-PTR-COD-ESTA SECTION.
       INI-VAL-PTR-COD-ESTA.
           IF PTR-COD-ESTA IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-ESTA.
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'EST' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-ESTA IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-ESTA IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ESTA IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN PTR-FLD.
       FIN-VAL-PTR-COD-ESTA.
           EXIT.
       
       VAL-FRM-GLS-ESTA SECTION.
       INI-VAL-FRM-GLS-ESTA.
           IF FRM-GLS-ESTA IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ESTA IN PTR-FLD.
       FIN-VAL-FRM-GLS-ESTA.
           EXIT.
       
       VAL-PTR-FEC-FIPR SECTION.
       INI-VAL-PTR-FEC-FIPR.
      *VAL-FEC Validar Fecha
           MOVE PTR-FEC-FIPR IN PTR-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PTR_FEC_FIPR 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PTR-FEC-FIPR IN PTR-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PTR-FEC-FIPR.
       FIN-VAL-PTR-FEC-FIPR.
           EXIT.
       
       VAL-PTR-FEC-FTPR SECTION.
       INI-VAL-PTR-FEC-FTPR.
      *VAL-FEC Validar Fecha
           MOVE PTR-FEC-FTPR IN PTR-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PTR_FEC_FTPR
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PTR-FEC-FTPR IN PTR-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PTR-FEC-FTPR.
      *<<<< PTR_FEC_FTPR
      *    Fecha Inicio Programada
           MOVE PTR-NUM-SIPR IN PTR-FLD TO WSS-NUM-SIPR IN WSS-VARI.
           MOVE PTR-NUM-AIPR IN PTR-FLD TO WSS-NUM-AIPR IN WSS-VARI.
           MOVE PTR-NUM-MIPR IN PTR-FLD TO WSS-NUM-MIPR IN WSS-VARI.
           MOVE PTR-NUM-DIPR IN PTR-FLD TO WSS-NUM-DIPR IN WSS-VARI.
      *
      *    Fecha Termino Programada
           MOVE PTR-NUM-STPR IN PTR-FLD TO WSS-NUM-STPR IN WSS-VARI.
           MOVE PTR-NUM-ATPR IN PTR-FLD TO WSS-NUM-ATPR IN WSS-VARI.
           MOVE PTR-NUM-MTPR IN PTR-FLD TO WSS-NUM-MTPR IN WSS-VARI.
           MOVE PTR-NUM-DTPR IN PTR-FLD TO WSS-NUM-DTPR IN WSS-VARI.

           IF WSS-FEC-FTPR IN WSS-VARI < WSS-FEC-FIPR IN WSS-VARI
      * Fecha Termino Programada debe ser >= Fecha Inicio Programada
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FECFTPRFIPR<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-PTR-FEC-FTPR.
           EXIT.
       
       VAL-PTR-FEC-FIRE SECTION.
       INI-VAL-PTR-FEC-FIRE.
      *VAL-FEC Validar Fecha
           MOVE PTR-FEC-FIRE IN PTR-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PTR_FEC_FIRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PTR-FEC-FIRE IN PTR-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PTR-FEC-FIRE.
       FIN-VAL-PTR-FEC-FIRE.
           EXIT.
       
       VAL-PTR-FEC-FTRE SECTION.
       INI-VAL-PTR-FEC-FTRE.
      *VAL-FEC Validar Fecha
           MOVE PTR-FEC-FTRE IN PTR-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PTR-FEC-FTRE IN PTR-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PTR-FEC-FTRE.
       FIN-VAL-PTR-FEC-FTRE.
           EXIT.
       
       VAL-FRM-NUM-DHBP SECTION.
       INI-VAL-FRM-NUM-DHBP.
       FIN-VAL-FRM-NUM-DHBP.
           EXIT.
       
       VAL-FRM-NUM-DHBR SECTION.
       INI-VAL-FRM-NUM-DHBR.
       FIN-VAL-FRM-NUM-DHBR.
           EXIT.
       
       VAL-PTR-COD-APRG SECTION.
       INI-VAL-PTR-COD-APRG.
           IF PTR-COD-APRG IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-APRG.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'FUN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-APRG IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-APRG IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-APRG IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-APRG IN PTR-FLD.
       FIN-VAL-PTR-COD-APRG.
           EXIT.
       
       VAL-PTR-COD-RESP SECTION.
       INI-VAL-PTR-COD-RESP.
           IF PTR-COD-RESP IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-RESP.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'FUN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-RESP IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-RESP IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RESP IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-RESP IN PTR-FLD.
       FIN-VAL-PTR-COD-RESP.
           EXIT.
       
       VAL-FRM-GLS-APRG SECTION.
       INI-VAL-FRM-GLS-APRG.
           IF FRM-GLS-APRG IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-APRG IN PTR-FLD.
       FIN-VAL-FRM-GLS-APRG.
           EXIT.
       
       VAL-FRM-GLS-RESP SECTION.
       INI-VAL-FRM-GLS-RESP.
           IF FRM-GLS-RESP IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-RESP IN PTR-FLD.
       FIN-VAL-FRM-GLS-RESP.
           EXIT.
       
       VAL-PTR-COD-EJEC SECTION.
       INI-VAL-PTR-COD-EJEC.
           IF PTR-COD-EJEC IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-EJEC.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'FUN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-EJEC IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-EJEC IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EJEC IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-EJEC IN PTR-FLD.
       FIN-VAL-PTR-COD-EJEC.
           EXIT.
       
       VAL-PTR-COD-USUA SECTION.
       INI-VAL-PTR-COD-USUA.
           IF PTR-COD-USUA IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-USUA.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'FUN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-USUA IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-USUA IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-USUA IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-USUA IN PTR-FLD.
       FIN-VAL-PTR-COD-USUA.
           EXIT.
       
       VAL-FRM-GLS-EJEC SECTION.
       INI-VAL-FRM-GLS-EJEC.
           IF FRM-GLS-EJEC IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-EJEC IN PTR-FLD.
       FIN-VAL-FRM-GLS-EJEC.
           EXIT.
       
       VAL-FRM-GLS-USUA SECTION.
       INI-VAL-FRM-GLS-USUA.
           IF FRM-GLS-USUA IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-USUA IN PTR-FLD.
       FIN-VAL-FRM-GLS-USUA.
           EXIT.
       
       VAL-PTR-COD-INGR SECTION.
       INI-VAL-PTR-COD-INGR.
           IF PTR-COD-INGR IN PTR-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PTR-COD-INGR.
      *<<<< INI_PTR_FEC_FTRE 
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'ADM' TO TAB-COD-SIST.
           MOVE 'FUN' TO TAB-COD-TTAB IN TAB.
           MOVE PTR-COD-INGR IN PTR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PTR-COD-INGR IN PTR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-INGR IN PTR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-INGR IN PTR-FLD.
       FIN-VAL-PTR-COD-INGR.
           EXIT.
       
       VAL-PTR-FEC-FING SECTION.
       INI-VAL-PTR-FEC-FING.
      *VAL-FEC Validar Fecha
           MOVE PTR-FEC-FING IN PTR-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PTR-FEC-FING IN PTR-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PTR-FEC-FING.
      *<<<< PTR_FEC_FING
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO PTR-NUM-DING IN PTR-FLD.
           MOVE HOY-MHOY TO PTR-NUM-MING IN PTR-FLD.
           MOVE HOY-SHOY TO PTR-NUM-SING IN PTR-FLD.
           MOVE HOY-AHOY TO PTR-NUM-AING IN PTR-FLD.
      *>>>>
       FIN-VAL-PTR-FEC-FING.
           EXIT.
       
       VAL-FRM-GLS-INGR SECTION.
       INI-VAL-FRM-GLS-INGR.
           IF FRM-GLS-INGR IN PTR-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-INGR IN PTR-FLD.
       FIN-VAL-FRM-GLS-INGR.
           EXIT.
       
       VAL-CON-KEY-PTR SECTION.
       INI-VAL-CON-KEY-PTR.
           IF     PTR-COD-CLIE IN PTR-FLD NOT > SPACES 
              AND PTR-COD-PROY IN PTR-FLD NOT > SPACES 
              AND PTR-COD-EVEN IN PTR-FLD NOT > SPACES 
              AND PTR-COD-ETAP IN PTR-FLD NOT > SPACES 
              AND PTR-COD-ACTI IN PTR-FLD NOT > SPACES 
              AND PTR-NUM-CORR IN PTR-FLD NOT > ZEROES 
              AND PTR-FEC-FING IN PTR-FLD NOT > SPACES 
              AND PTR-NUM-DING IN PTR-FLD NOT > SPACES 
              AND PTR-NUM-MING IN PTR-FLD NOT > SPACES 
              AND PTR-NUM-SING IN PTR-FLD NOT > SPACES 
              AND PTR-NUM-AING IN PTR-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PTR.
       FIN-VAL-CON-KEY-PTR.
           EXIT.
       
       VAL-CON-IKY-PTR SECTION.
       INI-VAL-CON-IKY-PTR.
           IF     PTR-COD-CLIE IN PTR-FLD NOT > SPACES 
              AND PTR-COD-PROY IN PTR-FLD NOT > SPACES 
              AND PTR-COD-EVEN IN PTR-FLD NOT > SPACES 
              AND PTR-COD-ETAP IN PTR-FLD NOT > SPACES 
              AND PTR-COD-ACTI IN PTR-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PTR.
       FIN-VAL-CON-IKY-PTR.
           EXIT.
       
       VAL-CON-FLD-PTR SECTION.
       INI-VAL-CON-FLD-PTR.
      *<<<< VAL_CON_FLD_PTR
      * consistencia de fecha inic real y fecha term real
           IF PTR-FEC-FIRE IN PTR-FLD NOT > ZEROES AND
              PTR-FEC-FTRE IN PTR-FLD NOT > ZEROES
      * ambas fechas son cero. es decir aun no empieza realmente la actividad
               GO TO FIN-VAL-CON-FLD-PTR.
           IF ( PTR-FEC-FIRE IN PTR-FLD NOT > ZEROES AND
                PTR-FEC-FTRE IN PTR-FLD > ZEROES )   OR
              ( PTR-FEC-FIRE IN PTR-FLD > ZEROES AND
                PTR-FEC-FTRE IN PTR-FLD NOT > ZEROES )
      * ambas fechas deben ser distintas de cero
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FIREFTRE>0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PTR.
      *    Fecha Inicio real
           MOVE PTR-NUM-SIRE IN PTR-FLD TO WSS-NUM-SIRE IN WSS-VARI.
           MOVE PTR-NUM-AIRE IN PTR-FLD TO WSS-NUM-AIRE IN WSS-VARI.
           MOVE PTR-NUM-MIRE IN PTR-FLD TO WSS-NUM-MIRE IN WSS-VARI.
           MOVE PTR-NUM-DIRE IN PTR-FLD TO WSS-NUM-DIRE IN WSS-VARI.
      *
      *    Fecha Termino real
           MOVE PTR-NUM-STRE IN PTR-FLD TO WSS-NUM-STRE IN WSS-VARI.
           MOVE PTR-NUM-ATRE IN PTR-FLD TO WSS-NUM-ATRE IN WSS-VARI.
           MOVE PTR-NUM-MTRE IN PTR-FLD TO WSS-NUM-MTRE IN WSS-VARI.
           MOVE PTR-NUM-DTRE IN PTR-FLD TO WSS-NUM-DTRE IN WSS-VARI.

           IF WSS-FEC-FTRE IN WSS-VARI < WSS-FEC-FIRE IN WSS-VARI
      * Fecha Termino real debe ser >= Fecha Inicio real 
               MOVE 'ADM' TO MSG-COD-SIST
               MOVE 'FECFTREFIRE<' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-FLD-PTR.
           EXIT.
       
       VAL-CON-PTR SECTION.
       INI-VAL-CON-PTR.
       FIN-VAL-CON-PTR.
           EXIT.
       
       VAL-NUM-KEY-PTR SECTION.
       INI-VAL-NUM-KEY-PTR.
           PERFORM VAL-NUM-IKY-PTR.
           PERFORM VAL-NUM-MKY-PTR.
           PERFORM VAL-NUM-AKY-PTR.
       FIN-VAL-NUM-KEY-PTR.
           EXIT.
       
       VAL-NUM-IKY-PTR SECTION.
       INI-VAL-NUM-IKY-PTR.
       FIN-VAL-NUM-IKY-PTR.
           EXIT.
       
       VAL-NUM-MKY-PTR SECTION.
       INI-VAL-NUM-MKY-PTR.
       FIN-VAL-NUM-MKY-PTR.
           EXIT.
       
       VAL-NUM-AKY-PTR SECTION.
       INI-VAL-NUM-AKY-PTR.
       FIN-VAL-NUM-AKY-PTR.
           EXIT.
       
       VAL-NUM-FLD-PTR SECTION.
       INI-VAL-NUM-FLD-PTR.
       FIN-VAL-NUM-FLD-PTR.
           EXIT.
      *<<<< EOF
      *>>>>
      *<<<< EOF_VAX
      *>>>>
