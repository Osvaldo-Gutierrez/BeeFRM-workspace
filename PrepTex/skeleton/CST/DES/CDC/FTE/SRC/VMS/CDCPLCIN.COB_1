       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      CDCPLCIN.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    10-Jul-90 01:18 PM.

      * Programa Listador de Reporte CIN con Sort.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
           SELECT GNSSRT         ASSIGN TO 'SYS$DISK:'.
           SELECT RPTCIN	   ASSIGN TO RPTCIN.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY CDCRRCIN.
       FD  RPTCIN LABEL RECORDS OMITTED
           REPORT IS RPT-CIN
           .

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY CDCBRCIN.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY CDCRWCIN.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       01  WSS-VARI.
           
           03 I                     PIC 9(02)        VALUE ZEROES.
           03 WSS-NUM-CONT          PIC 9(01)        VALUE 1.
           03 WSS-NUM-IENT          PIC 9(02)        VALUE ZEROES.

           03  WSS-TAB-ENVA   OCCURS 4 TIMES.
               05  WSS-COD-ENTI                         PIC X(03).
               05  WSS-COD-OPER                         PIC X(02).
               05  WSS-COD-VALO                         PIC X(12).

           03  WSS-TAB-CTES   OCCURS 4 TIMES.
               05  WSS-GLS-CTES                         PIC X(40).

           03  WSS-CMP-ENTI                             PIC X(03).
           03  WSS-GLS-ENTI                             PIC X(40).

      * VALORES ENTIDADES
           03  WSS-VLR-INST                             PIC X(03).
           03  WSS-VLR-SIST                             PIC X(03).
           03  WSS-VLR-IUSR                             PIC X(12).
           03  WSS-VLR-UBIF                             PIC X(06).
      * OPERADORES ENTIDADES
           03  WSS-OPR-INST                             PIC X(02).
           03  WSS-OPR-SIST                             PIC X(02).
           03  WSS-OPR-IUSR                             PIC X(02).
           03  WSS-OPR-UBIF                             PIC X(02).

       COPY TABBRUSR.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>> END

       REPORT SECTION.
      *--------------
       COPY CDCRFCIN.
           .
       COPY CDCRTCIN.

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-CH-CIN-SRT-COD-ENT1 SECTION.
           USE BEFORE REPORTING CH-CIN-SRT-COD-ENT1.
       INI-CH-CIN-SRT-COD-ENT1.
           MOVE 1 TO I.
      * INI SOLO VAX
      *BUS-GLS SECTION.
      *INI-BUS-GLS.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           IF WSS-COD-ENTI(I) = 'INP'
               IF CIN-COD-INST IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'INP' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-INST IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'SIS'
               IF CIN-COD-SISA IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-SISA IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.


           IF WSS-COD-ENTI(I) = 'USR'
              IF CIN-COD-IUSR IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'USR' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-IUSR IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'UBF'
              IF CIN-COD-UBIF IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'UBF' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-UBIF IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

      *FIN-BUS-GLS.
      *     EXIT.
      * FIN SOLO VAX
           MOVE TAB-GLS-DESC TO WSS-GLS-ENT1.
       FIN-CH-CIN-SRT-COD-ENT1.
           EXIT.
       DEC-CF-CIN-SRT-COD-ENT1 SECTION.
           USE BEFORE REPORTING CF-CIN-SRT-COD-ENT1.
       INI-CF-CIN-SRT-COD-ENT1.
       FIN-CF-CIN-SRT-COD-ENT1.
           EXIT.
       DEC-CH-CIN-SRT-COD-ENT2 SECTION.
           USE BEFORE REPORTING CH-CIN-SRT-COD-ENT2.
       INI-CH-CIN-SRT-COD-ENT2.
           MOVE 2 TO I.
      * INI SOLO VAX
      *BUS-GLS SECTION.
      *INI-BUS-GLS.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           IF WSS-COD-ENTI(I) = 'INP'
               IF CIN-COD-INST IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'INP' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-INST IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'SIS'
               IF CIN-COD-SISA IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-SISA IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.


           IF WSS-COD-ENTI(I) = 'USR'
              IF CIN-COD-IUSR IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'USR' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-IUSR IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'UBF'
              IF CIN-COD-UBIF IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'UBF' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-UBIF IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

      *FIN-BUS-GLS.
      *     EXIT.
      * FIN SOLO VAX
           MOVE TAB-GLS-DESC TO WSS-GLS-ENT2.
       FIN-CH-CIN-SRT-COD-ENT2.
           EXIT.
       DEC-CH-CIN-SRT-COD-ENT3 SECTION.
           USE BEFORE REPORTING CH-CIN-SRT-COD-ENT3.
       INI-CH-CIN-SRT-COD-ENT3.
           MOVE 3 TO I.
      * INI SOLO VAX
      *BUS-GLS SECTION.
      *INI-BUS-GLS.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           IF WSS-COD-ENTI(I) = 'INP'
               IF CIN-COD-INST IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'INP' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-INST IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'SIS'
               IF CIN-COD-SISA IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-SISA IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.


           IF WSS-COD-ENTI(I) = 'USR'
              IF CIN-COD-IUSR IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'USR' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-IUSR IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'UBF'
              IF CIN-COD-UBIF IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'UBF' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-UBIF IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

      *FIN-BUS-GLS.
      *     EXIT.
      * FIN SOLO VAX
           MOVE TAB-GLS-DESC TO WSS-GLS-ENT3.
       FIN-CH-CIN-SRT-COD-ENT3.
           EXIT.
       DEC-CH-CIN-SRT-COD-ENT4 SECTION.
           USE BEFORE REPORTING CH-CIN-SRT-COD-ENT4.
       INI-CH-CIN-SRT-COD-ENT4.
           MOVE 4 TO I.
      * INI SOLO VAX
      *BUS-GLS SECTION.
      *INI-BUS-GLS.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           IF WSS-COD-ENTI(I) = 'INP'
               IF CIN-COD-INST IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'INP' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-INST IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'SIS'
               IF CIN-COD-SISA IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-SISA IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.


           IF WSS-COD-ENTI(I) = 'USR'
              IF CIN-COD-IUSR IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'USR' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-IUSR IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

           IF WSS-COD-ENTI(I) = 'UBF'
              IF CIN-COD-UBIF IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'UBF' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-UBIF IN SRT TO TAB-COD-CTAB IN TAB
      *            PERFORM BUS-TAB.
                    MOVE FIO-GET-KEY         TO FIO-CMND
                    CALL TAB-GLS-FTAB USING FIO-CMND TAB
                    IF NOT FIO-STAT-OKS
                        MOVE 'CODIGO INEXISTENTE' TO TAB-GLS-DESC.

      *FIN-BUS-GLS.
      *     EXIT.
      * FIN SOLO VAX
           MOVE TAB-GLS-DESC TO WSS-GLS-ENT4.
       FIN-CH-CIN-SRT-COD-ENT4.
           EXIT.
       DEC-DL-CIN SECTION.
           USE BEFORE REPORTING DL-CIN.
       INI-DL-CIN.
       FIN-DL-CIN.
           EXIT.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
           MOVE 'CDCPLCIN' TO FIO-PROG.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
            MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           SORT GNSSRT
       COPY CDCRSCIN.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
      * INI SOLO VAX

           MOVE 'CDC'        TO FIO-SIST.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           PERFORM GNS-FIO-TAB.
           MOVE 'CDC'        TO FIO-SIST.
           MOVE FIO-INP      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

      * FIN SOLO VAX

       ENVA-1.
           MOVE 1 TO I.             
           MOVE I TO WSS-NUM-IENT.
           PERFORM ACC-ENVA.
       ENVA-2.
           ADD 1 TO I.
           MOVE 2 TO WSS-NUM-IENT.
           PERFORM ACC-ENVA.
       ENVA-3.
           ADD 1 TO I.
           MOVE 3 TO WSS-NUM-IENT.
           PERFORM ACC-ENVA.
       ENVA-4.
           ADD 1 TO I.
           MOVE 4 TO WSS-NUM-IENT.
           PERFORM ACC-ENVA.

       GLEN-1.

      * GLOSA ENTIDAD INSTITUCION
           MOVE 'INP' TO WSS-CMP-ENTI.
           MOVE 'INSTITUCION' TO WSS-GLS-ENTI.
           PERFORM BUS-CTE VARYING I FROM 1 BY 1
                   UNTIL WSS-COD-ENTI(I) = WSS-CMP-ENTI OR
                         I > 4.
           MOVE WSS-COD-VALO(I) TO WSS-VLR-INST.
           MOVE WSS-COD-OPER(I) TO WSS-OPR-INST.
           MOVE WSS-GLS-ENTI    TO WSS-GLS-CTES(I).

       GLEN-2.

      * GLOSA ENTIDAD SISTEMA
           MOVE 'SIS' TO WSS-CMP-ENTI.
           MOVE 'SISTEMA' TO WSS-GLS-ENTI.
           PERFORM BUS-CTE VARYING I FROM 1 BY 1
                   UNTIL WSS-COD-ENTI(I) = WSS-CMP-ENTI OR
                         I > 4.
           MOVE WSS-COD-VALO(I) TO WSS-VLR-SIST.
           MOVE WSS-COD-OPER(I) TO WSS-OPR-SIST.
           MOVE WSS-GLS-ENTI    TO WSS-GLS-CTES(I).

       GLEN-3.

      * GLOSA ENTIDAD USUARIO
           MOVE 'USR' TO WSS-CMP-ENTI.
           MOVE 'USUARIO' TO WSS-GLS-ENTI.
           PERFORM BUS-CTE VARYING I FROM 1 BY 1
                   UNTIL WSS-COD-ENTI(I) = WSS-CMP-ENTI OR
                         I > 4.
           MOVE WSS-COD-VALO(I) TO WSS-VLR-IUSR.
           MOVE WSS-COD-OPER(I) TO WSS-OPR-IUSR.
           MOVE WSS-GLS-ENTI    TO WSS-GLS-CTES(I).

       GLEN-4.

      * GLOSA ENTIDAD UBICACION FISICA
           MOVE 'UBF' TO WSS-CMP-ENTI.
           MOVE 'UBICACION' TO WSS-GLS-ENTI.
           PERFORM BUS-CTE VARYING I FROM 1 BY 1
                   UNTIL WSS-COD-ENTI(I) = WSS-CMP-ENTI OR
                         I > 4.
           MOVE WSS-COD-VALO(I) TO WSS-VLR-UBIF.
           MOVE WSS-COD-OPER(I) TO WSS-OPR-UBIF.
           MOVE WSS-GLS-ENTI    TO WSS-GLS-CTES(I).

      * PONE GLOSAS RESPECTIVAS
           MOVE WSS-GLS-CTES(1) TO WSS-GLS-CTE1.
           MOVE WSS-GLS-CTES(2) TO WSS-GLS-CTE2.
           MOVE WSS-GLS-CTES(3) TO WSS-GLS-CTE3.
           MOVE WSS-GLS-CTES(4) TO WSS-GLS-CTE4.

      *>>>> END
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM CDC-FIO-CIN.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM CDC-FIO-CIN.
       FST-INP-SRT.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM CDC-FIO-CIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP

      * SELECCION INSTITUCION
           IF WSS-VLR-INST NOT = '*'
               IF WSS-OPR-INST = '= '
                   IF WSS-VLR-INST NOT = CIN-COD-INST IN CIN
                    GO TO NXT-INP-SRT
               ELSE
               IF WSS-OPR-INST = '<>'
                   IF WSS-VLR-INST = CIN-COD-INST IN CIN
                    GO TO NXT-INP-SRT.

      * SELECCION PROYECTO
           IF WSS-VLR-SIST NOT = '*'
               IF WSS-OPR-SIST = '= '
                   IF WSS-VLR-SIST NOT = CIN-COD-SISA IN CIN 
                    GO TO NXT-INP-SRT
               ELSE
               IF WSS-OPR-SIST = '<>'
                   IF WSS-VLR-SIST = CIN-COD-SISA IN CIN
                    GO TO NXT-INP-SRT.

      * SELECCION USUARIO
           IF WSS-VLR-IUSR NOT = '*'
               IF WSS-OPR-IUSR = '= '
                   IF WSS-VLR-IUSR NOT = CIN-COD-IUSR IN CIN
                    GO TO NXT-INP-SRT
               ELSE
               IF WSS-OPR-IUSR = '<>'
                   IF WSS-VLR-IUSR = CIN-COD-IUSR IN CIN
                    GO TO NXT-INP-SRT.


      * SELECCION UBICACION
           IF WSS-VLR-UBIF NOT = '*'
               IF WSS-OPR-UBIF = '= '
                   IF WSS-VLR-UBIF NOT = CIN-COD-UBIF IN CIN
                    GO TO NXT-INP-SRT
               ELSE
               IF WSS-OPR-UBIF = '<>'
                   IF WSS-VLR-UBIF = CIN-COD-UBIF IN CIN
                    GO TO NXT-INP-SRT.

      * MOVE INSTITUCION
           IF WSS-COD-ENTI(1) = 'INP'
               MOVE CIN-COD-INST IN CIN TO SRT-COD-ENT1
           ELSE
           IF WSS-COD-ENTI(2) = 'INP'
               MOVE CIN-COD-INST IN CIN TO SRT-COD-ENT2
           ELSE
           IF WSS-COD-ENTI(3) = 'INP'
               MOVE CIN-COD-INST IN CIN TO SRT-COD-ENT3
           ELSE
           IF WSS-COD-ENTI(4) = 'INP'
               MOVE CIN-COD-INST IN CIN TO SRT-COD-ENT4.

      * MOVE PROYECTO
           IF WSS-COD-ENTI(1) = 'SIS'
               MOVE CIN-COD-SISA IN CIN TO SRT-COD-ENT1
           ELSE
           IF WSS-COD-ENTI(2) = 'SIS'
               MOVE CIN-COD-SISA IN CIN TO SRT-COD-ENT2
           ELSE
           IF WSS-COD-ENTI(3) = 'SIS'
               MOVE CIN-COD-SISA IN CIN TO SRT-COD-ENT3
           ELSE
           IF WSS-COD-ENTI(4) = 'SIS'
               MOVE CIN-COD-SISA IN CIN TO SRT-COD-ENT4.

      * MOVE USUARIO
           IF WSS-COD-ENTI(1) = 'USR'
               MOVE CIN-COD-IUSR IN CIN TO SRT-COD-ENT1
           ELSE
           IF WSS-COD-ENTI(2) = 'USR'
               MOVE CIN-COD-IUSR IN CIN TO SRT-COD-ENT2
           ELSE
           IF WSS-COD-ENTI(3) = 'USR'
               MOVE CIN-COD-IUSR IN CIN TO SRT-COD-ENT3
           ELSE
           IF WSS-COD-ENTI(4) = 'USR'
               MOVE CIN-COD-IUSR IN CIN TO SRT-COD-ENT4.

      * MOVE UBICACION
           IF WSS-COD-ENTI(1) = 'UBF'
               MOVE CIN-COD-UBIF IN CIN TO SRT-COD-ENT1
           ELSE
           IF WSS-COD-ENTI(2) = 'UBF'
               MOVE CIN-COD-UBIF IN CIN TO SRT-COD-ENT2
           ELSE
           IF WSS-COD-ENTI(3) = 'UBF'
               MOVE CIN-COD-UBIF IN CIN TO SRT-COD-ENT3
           ELSE
           IF WSS-COD-ENTI(4) = 'UBF'
               MOVE CIN-COD-UBIF IN CIN TO SRT-COD-ENT4.

           MOVE 1 TO SRT-NUM-CONT IN SRT.

      *>>>> END
       MOV-INP-SRT.
       COPY CDCRMCIN.
           RELEASE SRT.
       NXT-INP-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM CDC-FIO-CIN.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM CDC-FIO-CIN.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTCIN.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-CIN.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           MOVE SPACES TO WSS-GLS-MARK.
           IF CIN-COD-MARK IN SRT > SPACES
               MOVE 'CDC' TO TAB-COD-SIST
               MOVE 'MAR' TO TAB-COD-TTAB IN TAB
               MOVE CIN-COD-MARK IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR TO WSS-GLS-MARK.

           MOVE SPACES TO WSS-GLS-LONG.
           IF CIN-COD-LONG IN SRT > SPACES
               MOVE 'CDC' TO TAB-COD-SIST
               MOVE 'LON' TO TAB-COD-TTAB IN TAB
               MOVE CIN-COD-LONG IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR TO WSS-GLS-LONG.
      *>>>> END
       GEN-OUT-SRT.
           GENERATE DL-CIN.
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
           TERMINATE RPT-CIN.
           CLOSE RPTCIN.
       EXT-OUT-SRT.
           EXIT.

       COPY CDCBFCIN.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.

       GNS-PRO-END SECTION.
       INI-GNS-PRO-END.
           STOP RUN.
       FIN-GNS-PRO-END.
           EXIT.

      *<<<< EOF
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBGHOY.
       COPY GNSBGFEC.

      *COPY TABBBUSR.
      *COPY TABBVUSR.
      *COPY TABBFUSR.

       ACC-ENVA SECTION.
       INI-ACC-ENVA.
           DISPLAY 'INGRESE ENTIDAD-OPERADOR-VALOR (' I ') :'.
           ACCEPT  WSS-TAB-ENVA(WSS-NUM-IENT).

           DISPLAY '        ENTIDAD-OPERADOR-VALOR (' I ') : '
                   WSS-TAB-ENVA(WSS-NUM-IENT).

           IF NOT ( WSS-COD-ENTI IN WSS-VARI(WSS-NUM-IENT) = 'INP'
                    OR 'SIS' OR 'USR' OR 'UBF' )
               DISPLAY 'ABORTO : ENTIDAD INVALIDA'
               DISPLAY 'VALIDAS         : INP,SIS,USR,UBF'
               PERFORM GNS-PRO-END
           ELSE
           IF WSS-COD-OPER IN WSS-VARI(WSS-NUM-IENT) NOT > SPACES
                MOVE '= ' TO WSS-COD-OPER IN WSS-VARI(WSS-NUM-IENT)
           ELSE
           IF NOT ( WSS-COD-OPER IN WSS-VARI(WSS-NUM-IENT) = '= ' OR
                                                             '<>' )
               DISPLAY 'ABORTO : OPERADOR INVALIDO'
               DISPLAY 'VALIDOS         : =,<>'
               PERFORM GNS-PRO-END.

       FIN-ACC-ENVA.
           EXIT.

       BUS-CTE SECTION.
       INI-BUS-CTE.
       FIN-BUS-CTE.
           EXIT.

      *       
       BUS-GLS SECTION.
       INI-BUS-GLS.
           MOVE SPACES TO TAB-GLS-DESC IN TAB.
           IF WSS-COD-ENTI(I) = 'INP'
               IF CIN-COD-INST IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'INP' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-INST IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB.

           IF WSS-COD-ENTI(I) = 'SIS'
               IF CIN-COD-SISA IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'SIS' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-SISA IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB.

           IF WSS-COD-ENTI(I) = 'USR'
              IF CIN-COD-IUSR IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'USR' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-IUSR IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB.

           IF WSS-COD-ENTI(I) = 'UBF'
              IF CIN-COD-UBIF IN SRT > SPACES
                   MOVE 'CDC' TO TAB-COD-SIST
                   MOVE 'UBF' TO TAB-COD-TTAB IN TAB
                   MOVE CIN-COD-UBIF IN SRT TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB.
       FIN-BUS-GLS.
            EXIT.
      *
      *>>>>
