      * 30-May-94 04:36 PM
       PUT-ALL-PXI SECTION.
       INI-PUT-ALL-PXI.
           PERFORM PUT-GDG-PXI.
           PERFORM PUT-DBC-PXI.
       FIN-PUT-ALL-PXI.
           EXIT.
       
       PUT-GDG-PXI SECTION.
       INI-PUT-GDG-PXI.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-PXI.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-PXI
               GO TO FIN-PUT-GDG-PXI.
           MOVE GAR-NUM-SIS IN GDG TO GDG-NUM-SIS IN PXI-FLD.
           MOVE GAR-COD-CRR IN GDG TO GDG-COD-CRR IN PXI-FLD.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN PXI-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN PXI-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN PXI-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN PXI-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE IN PXI-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN PXI-FLD.
      *<<<< FIN_PUT_GDG_PXI

           MOVE ZEROES TO WSS-OPIN, WSS-OPXI.
           MOVE SPACES TO FRM-GLS-AUXI IN PXI-FLD.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDG' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDGNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.
           ADD 1 TO WSS-OPIN.
           MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN).
           MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN).

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDD' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDDNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE '00' TO PGM-STAT-DBC.
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDD.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDD.
           MOVE 'GAR-CLV-GDD-2' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GDD AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GDD )
               MOVE '23' TO PGM-STAT-DBC
               MOVE '23' TO FIO-STAT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      *    Busca DBC
           IF PGM-STAT-DBC NOT = '23'
               MOVE GDD-CIC-ICLI IN GDD TO DBC-KEY-IDBC IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GVT' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGVTNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE 'S' TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GAP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGAPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-COD-GRA IN GDG > '1'
               MOVE 'S' TO GAR-IND-EXG-GAP IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GAP IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GAP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GAP.
           MOVE ZEROES             TO GAR-COD-PRD-ACR IN GAP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GAP.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GAP AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GAP )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GAP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDO' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDONEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDO.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDO.
           MOVE GAR-IND-EXG-GDO IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GDP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGDPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GDP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           MOVE GAR-IND-EXG-GDP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GES' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGESNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-COD-LIM  IN GDG = 'E'
               MOVE 'S' TO GAR-IND-EXG-GES IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GES IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.
           MOVE ZEROES             TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GES AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GES )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GES IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GIN' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGINNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           IF GAR-IND-OBL-INS IN GDG = 'S'
               MOVE 'S' TO GAR-IND-EXG-GIN IN TAG
           ELSE
               MOVE 'N' TO GAR-IND-EXG-GIN IN TAG.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GIN.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GIN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GIN.
           MOVE GAR-IND-EXG-GIN IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GLE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGLENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GLE.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GLE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GLE.
           MOVE GAR-IND-EXG-GLE IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSENEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSE.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSE.
           MOVE GAR-IND-EXG-GSE IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GSI' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGSINEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GSI.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GSI.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GSI.
           MOVE GAR-IND-EXG-GSI IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GTP' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGTPNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GTP.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GTP.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GTP.
           MOVE ZEROES             TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-NUM-SIS IN GDG = GAR-NUM-SIS IN GTP AND
                    GAR-COD-CRR IN GDG = GAR-COD-CRR IN GTP AND 
                    GAR-COD-TSN IN GDG = GAR-COD-TSN IN GTP
                  )
               MOVE '23' TO FIO-STAT.
           MOVE GAR-IND-EXG-GTP IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Obtiene Opcion y NEMO de MNU
           MOVE 'GUB' TO TAB-CIC-CTAB IN TAB.
           MOVE 'CICGUBNEX' TO MSG-COD-MENS.
           PERFORM BUS-OPC-MNU.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-PUT-GDG-PXI.

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GUB.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GUB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GUB.
           MOVE GAR-IND-EXG-GUB IN TAG TO WSS-IND-EXIG.
           PERFORM DIS-FMEN.

      * Limpia COD-NEMO no desplegados
               MOVE WSS-OPXI TO FRM-IFLD.
               PERFORM LIM-RES-LIN UNTIL FRM-IFLD > WSS-IMAX.

           GO TO FIN-PUT-GDG-PXI.
       ERR-PUT-GDG-PXI.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-PUT-GDG-PXI.
           EXIT.
       
       PUT-DBC-PXI SECTION.
       INI-PUT-DBC-PXI.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-PXI.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-PXI
               GO TO FIN-PUT-DBC-PXI.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN PXI-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN PXI-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN PXI-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN PXI-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN PXI-FLD.
      *<<<< FIN_PUT_DBC_PXI
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN PXI-FLD.
      *>>>>
       FIN-PUT-DBC-PXI.
           EXIT.
       
       KEY-ALL-PXI SECTION.
       INI-KEY-ALL-PXI.
           PERFORM KEY-GDG-PXI.
           PERFORM KEY-DBC-PXI.
       FIN-KEY-ALL-PXI.
           EXIT.
       
       KEY-GDG-PXI SECTION.
       INI-KEY-GDG-PXI.
           MOVE GDG-NUM-SIS IN PXI-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GDG-COD-CRR IN PXI-FLD TO GAR-COD-CRR IN GDG.
       FIN-KEY-GDG-PXI.
           EXIT.
       
       KEY-DBC-PXI SECTION.
       INI-KEY-DBC-PXI.
       FIN-KEY-DBC-PXI.
           EXIT.
       
       SCR-CLRA-PXI SECTION.
       INI-SCR-CLRA-PXI.
           PERFORM CLR-KEY-PXI.
           PERFORM CLR-FLD-PXI.
       FIN-SCR-CLRA-PXI.
           EXIT.
       
       CLR-KEY-PXI SECTION.
       INI-CLR-KEY-PXI.
           MOVE SPACES TO GDG-NUM-SIS IN PXI-FLD.
           MOVE ZEROES TO GDG-COD-CRR IN PXI-FLD.
       FIN-CLR-KEY-PXI.
           EXIT.
       
       CLR-FLD-PXI SECTION.
       INI-CLR-FLD-PXI.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN PXI-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN PXI-FLD.
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(1).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(2).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(3).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(4).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(5).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(6).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(7).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(8).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(9).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(10).
           MOVE SPACES TO FRM-COD-OPIN IN PXI-FLD(11).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(1).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(2).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(3).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(4).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(5).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(6).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(7).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(8).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(9).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(10).
           MOVE SPACES TO FRM-GLS-PING IN PXI-FLD(11).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(1).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(2).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(3).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(4).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(5).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(6).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(7).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(8).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(9).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(10).
           MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(11).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(1).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(2).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(3).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(4).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(5).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(6).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(7).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(8).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(9).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(10).
           MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(11).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(1).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(2).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(3).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(4).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(5).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(6).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(7).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(8).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(9).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(10).
           MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(11).
           MOVE SPACES TO FRM-GLS-AUXI IN PXI-FLD.
           PERFORM CLR-GDG-PXI.
           PERFORM CLR-DBC-PXI.
       FIN-CLR-FLD-PXI.
           EXIT.
       
       CLR-GDG-PXI SECTION.
       INI-CLR-GDG-PXI.
           MOVE SPACES TO GDG-TIP-OPE IN PXI-FLD.
           MOVE SPACES TO GDG-STP-OPE IN PXI-FLD.
       FIN-CLR-GDG-PXI.
           EXIT.
       
       CLR-DBC-PXI SECTION.
       INI-CLR-DBC-PXI.
           MOVE SPACES TO DBC-GLS-NOMC IN PXI-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN PXI-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN PXI-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN PXI-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN PXI-FLD.
       FIN-CLR-DBC-PXI.
           EXIT.
       
       FST-KEY-PXI SECTION.
       INI-FST-KEY-PXI.
           MOVE -1 TO GDG-NUM-SIS-LEN IN PXI-FLD.
       FIN-FST-KEY-PXI.
           EXIT.
       
       FST-FLD-PXI SECTION.
       INI-FST-FLD-PXI.
           MOVE -1 TO DBC-GLS-NOMC-LEN IN PXI-FLD.
       FIN-FST-FLD-PXI.
           EXIT.
       
       PRO-KEY-PXI SECTION.
       INI-PRO-KEY-PXI.
           PERFORM PRO-IKY-PXI.
           PERFORM PRO-AKY-PXI.
           PERFORM PRO-MKY-PXI.
       FIN-PRO-KEY-PXI.
           EXIT.
       
       PRO-IKY-PXI SECTION.
       INI-PRO-IKY-PXI.
           MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN PXI-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-CRR-ATR IN PXI-FLD.
       FIN-PRO-IKY-PXI.
           EXIT.
       
       PRO-MKY-PXI SECTION.
       INI-PRO-MKY-PXI.
       FIN-PRO-MKY-PXI.
           EXIT.
       
       PRO-AKY-PXI SECTION.
       INI-PRO-AKY-PXI.
       FIN-PRO-AKY-PXI.
           EXIT.
       
       UNP-KEY-PXI SECTION.
       INI-UNP-KEY-PXI.
           PERFORM UNP-IKY-PXI.
           PERFORM UNP-AKY-PXI.
           PERFORM UNP-MKY-PXI.
       FIN-UNP-KEY-PXI.
           EXIT.
       
       UNP-IKY-PXI SECTION.
       INI-UNP-IKY-PXI.
           MOVE FRM-CPIM-UBY TO GDG-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GDG-COD-CRR-ATR.
       FIN-UNP-IKY-PXI.
           EXIT.
       
       UNP-MKY-PXI SECTION.
       INI-UNP-MKY-PXI.
       FIN-UNP-MKY-PXI.
           EXIT.
       
       UNP-AKY-PXI SECTION.
       INI-UNP-AKY-PXI.
       FIN-UNP-AKY-PXI.
           EXIT.
       
       UNP-FLD-PXI SECTION.
       INI-UNP-FLD-PXI.
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(10).
           MOVE FRM-CPIM-UBY TO FRM-COD-OPXI-ATR IN PXI-FLD(11).
           PERFORM UNP-GDG-PXI.
           PERFORM UNP-DBC-PXI.
       FIN-UNP-FLD-PXI.
           EXIT.
       
       UNP-GDG-PXI SECTION.
       INI-UNP-GDG-PXI.
       FIN-UNP-GDG-PXI.
           EXIT.
       
       UNP-DBC-PXI SECTION.
       INI-UNP-DBC-PXI.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR IN PXI-FLD.
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN PXI-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN PXI-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN PXI-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN PXI-FLD.
       FIN-UNP-DBC-PXI.
           EXIT.
       
       VAL-KEY-PXI SECTION.
       INI-VAL-KEY-PXI.
           PERFORM VAL-IKY-PXI.
           PERFORM VAL-MKY-PXI.
           PERFORM VAL-AKY-PXI.
       FIN-VAL-KEY-PXI.
           EXIT.
       
       VAL-IKY-PXI SECTION.
       INI-VAL-IKY-PXI.
           PERFORM VAL-GDG-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-NUM-SIS-LEN IN PXI-FLD
                GO TO FIN-VAL-IKY-PXI.
           PERFORM VAL-GDG-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-CRR-LEN IN PXI-FLD
                GO TO FIN-VAL-IKY-PXI.
       FIN-VAL-IKY-PXI.
           EXIT.
       
       VAL-MKY-PXI SECTION.
       INI-VAL-MKY-PXI.
       FIN-VAL-MKY-PXI.
           EXIT.
       
       VAL-AKY-PXI SECTION.
       INI-VAL-AKY-PXI.
       FIN-VAL-AKY-PXI.
           EXIT.
       
       VAL-GDG-NUM-SIS SECTION.
       INI-VAL-GDG-NUM-SIS.
           IF GDG-NUM-SIS IN PXI-FLD NOT > SPACES
              MOVE SPACES TO GDG-NUM-SIS IN PXI-FLD.
       FIN-VAL-GDG-NUM-SIS.
           EXIT.
       
       VAL-GDG-COD-CRR SECTION.
       INI-VAL-GDG-COD-CRR.
       FIN-VAL-GDG-COD-CRR.
           EXIT.
       
       VAL-CON-KEY-PXI SECTION.
       INI-VAL-CON-KEY-PXI.
           IF     GDG-NUM-SIS IN PXI-FLD NOT > SPACES 
              AND GDG-COD-CRR IN PXI-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PXI.
       FIN-VAL-CON-KEY-PXI.
           EXIT.
       
       VAL-CON-IKY-PXI SECTION.
       INI-VAL-CON-IKY-PXI.
           IF     GDG-NUM-SIS IN PXI-FLD NOT > SPACES 
              AND GDG-COD-CRR IN PXI-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PXI.
       FIN-VAL-CON-IKY-PXI.
           EXIT.
       
       VAL-NUM-KEY-PXI SECTION.
       INI-VAL-NUM-KEY-PXI.
           PERFORM VAL-NUM-IKY-PXI.
           PERFORM VAL-NUM-MKY-PXI.
           PERFORM VAL-NUM-AKY-PXI.
       FIN-VAL-NUM-KEY-PXI.
           EXIT.
       
       VAL-NUM-IKY-PXI SECTION.
       INI-VAL-NUM-IKY-PXI.
       VAL-NUM-GDG-COD-CRR.
           MOVE GDG-COD-CRR-ALF IN PXI-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-CRR IN PXI-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-CRR-LEN IN PXI-FLD
                GO TO FIN-VAL-NUM-IKY-PXI.
       FIN-VAL-NUM-IKY-PXI.
           EXIT.
       
       VAL-NUM-MKY-PXI SECTION.
       INI-VAL-NUM-MKY-PXI.
       FIN-VAL-NUM-MKY-PXI.
           EXIT.
       
       VAL-NUM-AKY-PXI SECTION.
       INI-VAL-NUM-AKY-PXI.
       FIN-VAL-NUM-AKY-PXI.
           EXIT.
       
       VAL-NUM-FLD-PXI SECTION.
       INI-VAL-NUM-FLD-PXI.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN PXI-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN PXI-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN PXI-FLD
                GO TO FIN-VAL-NUM-FLD-PXI.
       FIN-VAL-NUM-FLD-PXI.
           EXIT.
       
       EDT-KEY-PXI SECTION.
       INI-EDT-KEY-PXI.
           PERFORM EDT-IKY-PXI.
           PERFORM EDT-MKY-PXI.
           PERFORM EDT-AKY-PXI.
       FIN-EDT-KEY-PXI.
           EXIT.
       
       EDT-IKY-PXI SECTION.
       INI-EDT-IKY-PXI.
           IF GDG-COD-CRR-LEN IN PXI-FLD = -9
                MOVE -1 TO GDG-COD-CRR-LEN IN PXI-FLD
                GO TO FIN-EDT-IKY-PXI.
           MOVE GDG-COD-CRR IN PXI-FLD TO GDG-COD-CRR-EDT IN PXI-EDT.
           MOVE GDG-COD-CRR-EDT IN PXI-EDT TO 
                GDG-COD-CRR-ALF IN PXI-FLD.
       FIN-EDT-IKY-PXI.
           EXIT.
       
       EDT-MKY-PXI SECTION.
       INI-EDT-MKY-PXI.
       FIN-EDT-MKY-PXI.
           EXIT.
       
       EDT-AKY-PXI SECTION.
       INI-EDT-AKY-PXI.
       FIN-EDT-AKY-PXI.
           EXIT.
       
       EDT-FLD-PXI SECTION.
       INI-EDT-FLD-PXI.
           IF DBC-NUM-ICLI-LEN IN PXI-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN PXI-FLD
                GO TO FIN-EDT-FLD-PXI.
           MOVE DBC-NUM-ICLI IN PXI-FLD TO DBC-NUM-ICLI-EDT IN PXI-EDT.
           MOVE DBC-NUM-ICLI-EDT IN PXI-EDT TO 
                DBC-NUM-ICLI-ALF IN PXI-FLD.
       FIN-EDT-FLD-PXI.
           EXIT.
      *<<<< EOF
       BUS-OPC-MNU SECTION.
       INI-BUS-OPC-MNU.
           MOVE 'GAR'          TO FIO-SIST.
           MOVE 'PXI'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR' TO MSG-COD-SIST
               GO TO FIN-BUS-OPC-MNU.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE TAB-COD-CTAB IN TAB TO MNU-COD-OPCI IN MNU.
           MOVE 'GAR' TO FIO-SIST.
           MOVE 'MNU-COD-OPCI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MNU.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'MNU    NEX' TO MSG-COD-MENS
               GO TO FIN-BUS-OPC-MNU.
       FIN-BUS-OPC-MNU.
           EXIT.

       DIS-FMEN SECTION.
       INI-DIS-FMEN.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-OPIN
               MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPIN 
                                                 IN PXI-FLD(WSS-OPIN)
               MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PING 
                                                 IN PXI-FLD(WSS-OPIN)
           ELSE
               IF WSS-IND-EXIG = 'S'
                   ADD 1 TO WSS-OPXI
                   MOVE MNU-COD-OPCI IN MNU TO FRM-COD-OPXI 
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-GLS-FMEN IN MNU TO FRM-GLS-PXIN
                                                 IN PXI-FLD(WSS-OPXI)
                   MOVE MNU-COD-NEMO IN MNU TO FRM-COD-NEMO
                                                 IN PXI-FLD(WSS-OPXI).
       FIN-DIS-FMEN.
           EXIT.

       LIM-RES-LIN SECTION.
       INI-LIM-RES-LIN.
           IF FRM-IFLD > WSS-OPXI
                MOVE SPACES TO FRM-COD-OPXI IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-GLS-PXIN IN PXI-FLD(FRM-IFLD)
                MOVE SPACES TO FRM-COD-NEMO IN PXI-FLD(FRM-IFLD).
           ADD 1 TO FRM-IFLD.
       FIN-LIM-RES-LIN.
           EXIT.
      *>>>>
