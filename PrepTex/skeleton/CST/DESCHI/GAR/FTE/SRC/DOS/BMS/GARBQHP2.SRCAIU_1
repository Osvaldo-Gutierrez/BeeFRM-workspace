      * 02-Jun-93 07:40 PM
       PUT-ALL-HP2 SECTION.
       INI-PUT-ALL-HP2.
           PERFORM PUT-TAG-HP2.
       FIN-PUT-ALL-HP2.
           EXIT.
       
       PUT-TAG-HP2 SECTION.
       INI-PUT-TAG-HP2.
           IF PGM-STAT-TAG-NUL
               GO TO FIN-PUT-TAG-HP2.
           IF NOT PGM-STAT-TAG-OKS
               PERFORM CLR-TAG-HP2
               GO TO FIN-PUT-TAG-HP2.
           MOVE GAR-TIP-OPE IN TAG TO TAG-TIP-OPE IN HP2-FLD.
           MOVE GAR-STP-OPE IN TAG TO TAG-STP-OPE IN HP2-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF TAG-TIP-OPE IN HP2-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE TAG-TIP-OPE IN HP2-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE IN HP2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN HP2-FLD.
      *<<<< FIN_PUT_TAG_HP2
           MOVE 1 TO WSS-IOBL, WSS-IOPC.
           IF GAR-IND-EXG-GDG IN TAG = 'S'
               MOVE 'DATOS GENERALES' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GDG IN TAG = 'O'
               MOVE 'DATOS GENERALES' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GDD IN TAG = 'S'
               MOVE 'DATOS DE DEUDORES' TO FRM-GLS-IND-OBL 
                                                 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GDD IN TAG = 'O'
               MOVE 'DATOS DE DEUDORES' TO FRM-GLS-IND-OPC
                                                 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GLE IN TAG = 'S'
               MOVE 'DATOS LEGALES'     TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GLE IN TAG = 'O'
               MOVE 'DATOS LEGALES'     TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GSE IN TAG = 'S'
               MOVE 'DATOS DE SEGUROS'  TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GSE IN TAG = 'O'
               MOVE 'DATOS DE SEGUROS ' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GVT IN TAG = 'S'
               MOVE 'VALORES Y TASACIONES' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GVT IN TAG = 'O'
               MOVE 'VALORES Y TASACIONES' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GDO IN TAG = 'S'
               MOVE 'DATOS DEL DOCUMENTO' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GDO IN TAG = 'O'
               MOVE 'DATOS DEL DOCUMENTO' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GUB IN TAG = 'S'
               MOVE 'DATOS DE UBICACION' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GUB IN TAG = 'O'
               MOVE 'DATOS DE UBICACION' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.


           IF GAR-IND-EXG-GAP IN TAG = 'S'
               MOVE 'ACREEDORES PREFERENCIALES' TO FRM-GLS-IND-OBL
 						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GAP IN TAG = 'O'
               MOVE 'ACREEDORES PREFERENCIALES' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GDP IN TAG = 'S'
               MOVE 'DATOS DE DEPRECIACION' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GDP IN TAG = 'O'
               MOVE 'DATOS DE DEPRECIACION' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GES IN TAG = 'S'
               MOVE 'ESPECIFICACION DE GARANTIAS' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GES IN TAG = 'O'
               MOVE 'ESPECIFICACION DE GARANTIAS' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GIN IN TAG = 'S'
               MOVE 'INSPECCIONES'      TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GIN IN TAG = 'O'
               MOVE 'INSPECCIONES'      TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GSI IN TAG = 'S'
               MOVE 'DATOS DE UBICACION' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GSI IN TAG = 'O'
               MOVE 'SINIESTROS '       TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

           IF GAR-IND-EXG-GTP IN TAG = 'S'
               MOVE 'TASACIONES PARCIALES' TO FRM-GLS-IND-OBL
						 IN HP2-FLD(WSS-IOBL)
               ADD 1 TO WSS-IOBL
           ELSE
           IF GAR-IND-EXG-GTP IN TAG = 'O'
               MOVE 'TASACIONES PARCIALES' TO FRM-GLS-IND-OPC
						 IN HP2-FLD(WSS-IOPC)
               ADD 1 TO WSS-IOPC.

      * Limpia los campos que no se usaron
               IF WSS-IOBL > WSS-IOPC
                    MOVE WSS-IOBL TO FRM-IFLD
               ELSE
                    MOVE WSS-IOPC TO FRM-IFLD.
               PERFORM LIM-RES-LIN UNTIL FRM-IFLD > WSS-IMAX.

      *>>>>
       FIN-PUT-TAG-HP2.
           EXIT.
       
       KEY-ALL-HP2 SECTION.
       INI-KEY-ALL-HP2.
           PERFORM KEY-TAG-HP2.
       FIN-KEY-ALL-HP2.
           EXIT.
       
       KEY-TAG-HP2 SECTION.
       INI-KEY-TAG-HP2.
           MOVE TAG-TIP-OPE IN HP2-FLD TO GAR-TIP-OPE IN TAG.
           MOVE TAG-STP-OPE IN HP2-FLD TO GAR-STP-OPE IN TAG.
       FIN-KEY-TAG-HP2.
           EXIT.
       
       SCR-CLRA-HP2 SECTION.
       INI-SCR-CLRA-HP2.
           PERFORM CLR-KEY-HP2.
           PERFORM CLR-FLD-HP2.
       FIN-SCR-CLRA-HP2.
           EXIT.
       
       CLR-KEY-HP2 SECTION.
       INI-CLR-KEY-HP2.
           MOVE SPACES TO TAG-TIP-OPE IN HP2-FLD.
           MOVE SPACES TO TAG-STP-OPE IN HP2-FLD.
       FIN-CLR-KEY-HP2.
           EXIT.
       
       CLR-FLD-HP2 SECTION.
       INI-CLR-FLD-HP2.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN HP2-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN HP2-FLD.
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(1).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(2).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(3).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(4).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(5).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(6).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(7).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(8).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(9).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(10).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(11).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(12).
           MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(13).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(1).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(2).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(3).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(4).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(5).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(6).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(7).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(8).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(9).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(10).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(11).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(12).
           MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(13).
           PERFORM CLR-TAG-HP2.
       FIN-CLR-FLD-HP2.
           EXIT.
       
       CLR-TAG-HP2 SECTION.
       INI-CLR-TAG-HP2.
       FIN-CLR-TAG-HP2.
           EXIT.
       
       FST-KEY-HP2 SECTION.
       INI-FST-KEY-HP2.
           MOVE -1 TO TAG-TIP-OPE-LEN IN HP2-FLD.
       FIN-FST-KEY-HP2.
           EXIT.
       
       FST-FLD-HP2 SECTION.
       INI-FST-FLD-HP2.
       FIN-FST-FLD-HP2.
           EXIT.
       
       PRO-KEY-HP2 SECTION.
       INI-PRO-KEY-HP2.
           PERFORM PRO-IKY-HP2.
           PERFORM PRO-AKY-HP2.
           PERFORM PRO-MKY-HP2.
       FIN-PRO-KEY-HP2.
           EXIT.
       
       PRO-IKY-HP2 SECTION.
       INI-PRO-IKY-HP2.
           MOVE FRM-CPIM-AEY TO TAG-TIP-OPE-ATR IN HP2-FLD.
           MOVE FRM-CPIM-AEY TO TAG-STP-OPE-ATR IN HP2-FLD.
       FIN-PRO-IKY-HP2.
           EXIT.
       
       PRO-MKY-HP2 SECTION.
       INI-PRO-MKY-HP2.
       FIN-PRO-MKY-HP2.
           EXIT.
       
       PRO-AKY-HP2 SECTION.
       INI-PRO-AKY-HP2.
       FIN-PRO-AKY-HP2.
           EXIT.
       
       UNP-KEY-HP2 SECTION.
       INI-UNP-KEY-HP2.
           PERFORM UNP-IKY-HP2.
           PERFORM UNP-AKY-HP2.
           PERFORM UNP-MKY-HP2.
       FIN-UNP-KEY-HP2.
           EXIT.
       
       UNP-IKY-HP2 SECTION.
       INI-UNP-IKY-HP2.
           MOVE FRM-CPIM-UBY TO TAG-TIP-OPE-ATR.
           MOVE FRM-CPIM-UBY TO TAG-STP-OPE-ATR.
       FIN-UNP-IKY-HP2.
           EXIT.
       
       UNP-MKY-HP2 SECTION.
       INI-UNP-MKY-HP2.
       FIN-UNP-MKY-HP2.
           EXIT.
       
       UNP-AKY-HP2 SECTION.
       INI-UNP-AKY-HP2.
       FIN-UNP-AKY-HP2.
           EXIT.
       
       UNP-FLD-HP2 SECTION.
       INI-UNP-FLD-HP2.
           PERFORM UNP-TAG-HP2.
       FIN-UNP-FLD-HP2.
           EXIT.
       
       UNP-TAG-HP2 SECTION.
       INI-UNP-TAG-HP2.
       FIN-UNP-TAG-HP2.
           EXIT.
       
       VAL-KEY-HP2 SECTION.
       INI-VAL-KEY-HP2.
           PERFORM VAL-IKY-HP2.
           PERFORM VAL-MKY-HP2.
           PERFORM VAL-AKY-HP2.
       FIN-VAL-KEY-HP2.
           EXIT.
       
       VAL-IKY-HP2 SECTION.
       INI-VAL-IKY-HP2.
           PERFORM VAL-TAG-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAG-TIP-OPE-LEN IN HP2-FLD
                GO TO FIN-VAL-IKY-HP2.
           PERFORM VAL-TAG-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO TAG-STP-OPE-LEN IN HP2-FLD
                GO TO FIN-VAL-IKY-HP2.
       FIN-VAL-IKY-HP2.
           EXIT.
       
       VAL-MKY-HP2 SECTION.
       INI-VAL-MKY-HP2.
       FIN-VAL-MKY-HP2.
           EXIT.
       
       VAL-AKY-HP2 SECTION.
       INI-VAL-AKY-HP2.
       FIN-VAL-AKY-HP2.
           EXIT.
       
       VAL-TAG-TIP-OPE SECTION.
       INI-VAL-TAG-TIP-OPE.
           IF TAG-TIP-OPE IN HP2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-TIP-OPE.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE TAG-TIP-OPE IN HP2-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              TAG-TIP-OPE IN HP2-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE IN HP2-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE IN HP2-FLD.
       FIN-VAL-TAG-TIP-OPE.
           EXIT.
       
       VAL-TAG-STP-OPE SECTION.
       INI-VAL-TAG-STP-OPE.
           IF TAG-STP-OPE IN HP2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAG-STP-OPE.
      *<<<< TAG_STP_OPE

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE TAG-TIP-OPE IN HP2-FLD TO GAR-TIP-OPE IN TAG.
           MOVE TAG-STP-OPE IN HP2-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN HP2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN HP2-FLD
               GO TO FIN-VAL-TAG-STP-OPE.
      *>>>>
       FIN-VAL-TAG-STP-OPE.
           EXIT.
       
       VAL-CON-KEY-HP2 SECTION.
       INI-VAL-CON-KEY-HP2.
           IF     TAG-TIP-OPE IN HP2-FLD NOT > SPACES 
              AND TAG-STP-OPE IN HP2-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-HP2.
       FIN-VAL-CON-KEY-HP2.
           EXIT.
       
       VAL-CON-IKY-HP2 SECTION.
       INI-VAL-CON-IKY-HP2.
           IF     TAG-TIP-OPE IN HP2-FLD NOT > SPACES 
              AND TAG-STP-OPE IN HP2-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-HP2.
       FIN-VAL-CON-IKY-HP2.
           EXIT.
       
       VAL-NUM-KEY-HP2 SECTION.
       INI-VAL-NUM-KEY-HP2.
           PERFORM VAL-NUM-IKY-HP2.
           PERFORM VAL-NUM-MKY-HP2.
           PERFORM VAL-NUM-AKY-HP2.
       FIN-VAL-NUM-KEY-HP2.
           EXIT.
       
       VAL-NUM-IKY-HP2 SECTION.
       INI-VAL-NUM-IKY-HP2.
       FIN-VAL-NUM-IKY-HP2.
           EXIT.
       
       VAL-NUM-MKY-HP2 SECTION.
       INI-VAL-NUM-MKY-HP2.
       FIN-VAL-NUM-MKY-HP2.
           EXIT.
       
       VAL-NUM-AKY-HP2 SECTION.
       INI-VAL-NUM-AKY-HP2.
       FIN-VAL-NUM-AKY-HP2.
           EXIT.
       
       VAL-NUM-FLD-HP2 SECTION.
       INI-VAL-NUM-FLD-HP2.
       FIN-VAL-NUM-FLD-HP2.
           EXIT.
       
       EDT-KEY-HP2 SECTION.
       INI-EDT-KEY-HP2.
           PERFORM EDT-IKY-HP2.
           PERFORM EDT-MKY-HP2.
           PERFORM EDT-AKY-HP2.
       FIN-EDT-KEY-HP2.
           EXIT.
       
       EDT-IKY-HP2 SECTION.
       INI-EDT-IKY-HP2.
       FIN-EDT-IKY-HP2.
           EXIT.
       
       EDT-MKY-HP2 SECTION.
       INI-EDT-MKY-HP2.
       FIN-EDT-MKY-HP2.
           EXIT.
       
       EDT-AKY-HP2 SECTION.
       INI-EDT-AKY-HP2.
       FIN-EDT-AKY-HP2.
           EXIT.
       
       EDT-FLD-HP2 SECTION.
       INI-EDT-FLD-HP2.
       FIN-EDT-FLD-HP2.
           EXIT.
      *<<<< EOF
       LIM-RES-LIN SECTION.
       INI-LIM-RES-LIN.
           IF FRM-IFLD NOT < WSS-IOBL
                MOVE SPACES TO FRM-GLS-IND-OBL IN HP2-FLD(FRM-IFLD).

           IF FRM-IFLD NOT < WSS-IOPC
                MOVE SPACES TO FRM-GLS-IND-OPC IN HP2-FLD(FRM-IFLD).
           ADD 1 TO FRM-IFLD.
       FIN-LIM-RES-LIN.
           EXIT.
      *>>>>
