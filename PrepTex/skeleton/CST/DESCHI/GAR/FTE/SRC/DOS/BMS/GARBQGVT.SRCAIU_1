      * 19-Oct-93 01:02 PM
       PUT-ALL-GVT SECTION.
       INI-PUT-ALL-GVT.
           PERFORM PUT-GVT-GVT.
           PERFORM PUT-GDG-GVT.
      *<<<< FIN_PUT_ALL_GVT
           PERFORM OBT-COD-MNAC.
           PERFORM OBT-VAL-CON.
      *>>>>
       FIN-PUT-ALL-GVT.
           EXIT.
       
       PUT-GVT-GVT SECTION.
       INI-PUT-GVT-GVT.
           IF PGM-STAT-GVT-NUL
               GO TO FIN-PUT-GVT-GVT.
           IF NOT PGM-STAT-GVT-OKS
               PERFORM CLR-GVT-GVT
               GO TO FIN-PUT-GVT-GVT.
           MOVE GAR-NUM-SIS IN GVT TO GVT-NUM-SIS IN GVT-FLD.
           MOVE GAR-COD-CRR IN GVT TO GVT-COD-CRR IN GVT-FLD.
           MOVE GAR-COD-TSN IN GVT TO GVT-COD-TSN IN GVT-FLD.
           MOVE GAR-FD-TSN IN GVT TO GVT-FD-TSN IN GVT-FLD.
           MOVE GAR-FM-TSN IN GVT TO GVT-FM-TSN IN GVT-FLD.
           MOVE GAR-FA-TSN IN GVT TO GVT-FA-TSN IN GVT-FLD.
           MOVE GAR-VAL-CML-TSN IN GVT TO GVT-VAL-CML-TSN IN GVT-FLD.
           MOVE GAR-VAL-LIQ-TSN IN GVT TO GVT-VAL-LIQ-TSN IN GVT-FLD.
           MOVE GAR-PCT-PON IN GVT TO GVT-PCT-PON IN GVT-FLD.
           MOVE GAR-VAL-PON IN GVT TO GVT-VAL-PON IN GVT-FLD.
           MOVE GAR-PCT-AJT-SUP IN GVT TO GVT-PCT-AJT-SUP IN GVT-FLD.
           MOVE GAR-VAL-AJT-SUP IN GVT TO GVT-VAL-AJT-SUP IN GVT-FLD.
           MOVE GAR-IIV-TSD IN GVT TO GVT-IIV-TSD IN GVT-FLD.
           MOVE GAR-IIV-SVS IN GVT TO GVT-IIV-SVS IN GVT-FLD.
           MOVE GVT-MSC-STAT IN GVT TO GVT-MSC-STAT IN GVT-FLD.
           MOVE GAR-TIP-CTR IN GVT TO GVT-TIP-CTR IN GVT-FLD.
           MOVE GAR-M2-TRR IN GVT TO GVT-M2-TRR IN GVT-FLD.
           MOVE GAR-COD-UMD IN GVT TO GVT-COD-UMD IN GVT-FLD.
           MOVE GAR-FD-RVL IN GVT TO GVT-FD-RVL IN GVT-FLD.
           MOVE GAR-FM-RVL IN GVT TO GVT-FM-RVL IN GVT-FLD.
           MOVE GAR-FA-RVL IN GVT TO GVT-FA-RVL IN GVT-FLD.
           MOVE GAR-M2-CTR IN GVT TO GVT-M2-CTR IN GVT-FLD.
           MOVE GAR-TIP-MAQ-EQP IN GVT TO GVT-TIP-MAQ-EQP IN GVT-FLD.
           MOVE GVT-FD-ING-SIS IN GVT TO GVT-FD-ING-SIS IN GVT-FLD.
           MOVE GVT-FM-ING-SIS IN GVT TO GVT-FM-ING-SIS IN GVT-FLD.
           MOVE GVT-FA-ING-SIS IN GVT TO GVT-FA-ING-SIS IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-IIV-TSD IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TAS ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-IIV-TSD IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-TSD IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-IIV-SVS IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TAS ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-IIV-SVS IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-SVS IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-TIP-CTR IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CTR ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-TIP-CTR IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-CTR IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-COD-UMD IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'UMD ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-COD-UMD IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-UMD IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GVT-TIP-MAQ-EQP IN GVT-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'MEQ ' TO TAB-COD-TTAB IN TAB
               MOVE GVT-TIP-MAQ-EQP IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-MAQ-EQP IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
      *<<<< FIN_PUT_GVT_GVT
      *    PARA RECORDAR RAZON ENTRE VAL-CML Y VAL-LIQ
           MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO
                WSS-VAL-LIQ-TSN IN CMA-VARI.

           IF ( SCR-CCPP = 'ACC' AND SCR-STPP NOT = SCR-STAT-CON OR
                SCR-CMND = 'ATA' ) AND

               GVT-VAL-LIQ-TSN IN GVT-FLD > ZEROES AND
               GVT-VAL-CML-TSN IN GVT-FLD > ZEROES

                COMPUTE WSS-LIQ-CML IN CMA-VARI ROUNDED =
                               GVT-VAL-LIQ-TSN IN GVT-FLD /
                               GVT-VAL-CML-TSN IN GVT-FLD

           ELSE
               MOVE ZEROES TO WSS-LIQ-CML IN CMA-VARI.

       OBT-VEN-TSN.
           PERFORM EXA-VEN-TSN.  

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GTP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GTP.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GTP.
           MOVE ZEROES                 TO GAR-COD-ITM-TSN IN GTP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GTP.
           IF FIO-STAT-OKS AND
              GAR-NUM-SIS IN GTP = GVT-NUM-SIS IN GVT-FLD AND
              GAR-COD-CRR IN GTP = GVT-COD-CRR IN GVT-FLD AND
              GAR-COD-TSN IN GTP = GVT-COD-TSN IN GVT-FLD 
               MOVE 'S' TO FRM-IND-GTP IN GVT-FLD
           ELSE
               MOVE 'N' TO FRM-IND-GTP IN GVT-FLD.
           IF FIO-STAT-OKS 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GTP.
      *>>>>
       FIN-PUT-GVT-GVT.
           EXIT.
       
       PUT-GDG-GVT SECTION.
       INI-PUT-GDG-GVT.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GVT.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GVT
               GO TO FIN-PUT-GDG-GVT.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GVT-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GVT-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GVT-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GVT-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GVT-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GVT-FLD.
           MOVE GAR-VCB-CON IN GDG TO GDG-VCB-CON IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GVT-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GVT-FLD > SPACES
               MOVE GDG-COD-OFI IN GVT-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GVT-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB-CON IN GVT-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB-CON IN GVT-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CON IN GVT-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB-CON IN GVT-FLD.
       FIN-PUT-GDG-GVT.
           EXIT.
       
       KEY-ALL-GVT SECTION.
       INI-KEY-ALL-GVT.
           PERFORM KEY-GVT-GVT.
           PERFORM KEY-GDG-GVT.
       FIN-KEY-ALL-GVT.
           EXIT.
       
       KEY-GVT-GVT SECTION.
       INI-KEY-GVT-GVT.
           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GVT.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GVT.
           MOVE GVT-COD-TSN IN GVT-FLD TO GAR-COD-TSN IN GVT.
       FIN-KEY-GVT-GVT.
           EXIT.
       
       KEY-GDG-GVT SECTION.
       INI-KEY-GDG-GVT.
       FIN-KEY-GDG-GVT.
           EXIT.
       
       SCR-CLRA-GVT SECTION.
       INI-SCR-CLRA-GVT.
           PERFORM CLR-KEY-GVT.
           PERFORM CLR-FLD-GVT.
       FIN-SCR-CLRA-GVT.
           EXIT.
       
       CLR-KEY-GVT SECTION.
       INI-CLR-KEY-GVT.
           MOVE SPACES TO GVT-NUM-SIS IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-CRR IN GVT-FLD.
           MOVE ZEROES TO GVT-COD-TSN IN GVT-FLD.
       FIN-CLR-KEY-GVT.
           EXIT.
       
       CLR-FLD-GVT SECTION.
       INI-CLR-FLD-GVT.
           MOVE SPACES TO FRM-IND-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-IIV-TSD IN GVT-FLD.
           MOVE ZEROES TO FRM-NUM-GTP IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-IIV-SVS IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-CTR IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-VCB-CON IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-UMD IN GVT-FLD.
           MOVE ZEROES TO FRM-VAL-ULT-CON IN GVT-FLD.
           MOVE SPACES TO FRM-GLS-TIP-MAQ-EQP IN GVT-FLD.
           PERFORM CLR-GVT-GVT.
           PERFORM CLR-GDG-GVT.
       FIN-CLR-FLD-GVT.
           EXIT.
       
       CLR-GVT-GVT SECTION.
       INI-CLR-GVT-GVT.
           MOVE ZEROES TO GVT-FEC-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-CML-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-LIQ-TSN IN GVT-FLD.
           MOVE ZEROES TO GVT-PCT-PON IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-PON IN GVT-FLD.
           MOVE ZEROES TO GVT-PCT-AJT-SUP IN GVT-FLD.
           MOVE ZEROES TO GVT-VAL-AJT-SUP IN GVT-FLD.
           MOVE SPACES TO GVT-IIV-TSD IN GVT-FLD.
           MOVE SPACES TO GVT-IIV-SVS IN GVT-FLD.
           MOVE SPACES TO GVT-MSC-STAT IN GVT-FLD.
           MOVE SPACES TO GVT-TIP-CTR IN GVT-FLD.
           MOVE ZEROES TO GVT-M2-TRR IN GVT-FLD.
           MOVE SPACES TO GVT-COD-UMD IN GVT-FLD.
           MOVE ZEROES TO GVT-FEC-RVL IN GVT-FLD.
           MOVE ZEROES TO GVT-M2-CTR IN GVT-FLD.
           MOVE SPACES TO GVT-TIP-MAQ-EQP IN GVT-FLD.
           MOVE ZEROES TO GVT-FEC-ING-SIS IN GVT-FLD.
       FIN-CLR-GVT-GVT.
           EXIT.
       
       CLR-GDG-GVT SECTION.
       INI-CLR-GDG-GVT.
           MOVE SPACES TO GDG-TIP-OPE IN GVT-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GVT-FLD.
           MOVE SPACES TO GDG-COD-OFI IN GVT-FLD.
           MOVE SPACES TO GDG-VCB IN GVT-FLD.
           MOVE SPACES TO GDG-DES-1 IN GVT-FLD.
           MOVE SPACES TO GDG-DES-2 IN GVT-FLD.
           MOVE SPACES TO GDG-VCB-CON IN GVT-FLD.
       FIN-CLR-GDG-GVT.
           EXIT.
       
       FST-KEY-GVT SECTION.
       INI-FST-KEY-GVT.
           MOVE -1 TO GVT-NUM-SIS-LEN IN GVT-FLD.
       FIN-FST-KEY-GVT.
           EXIT.
       
       FST-FLD-GVT SECTION.
       INI-FST-FLD-GVT.
           MOVE -1 TO FRM-IND-GTP-LEN IN GVT-FLD.
      *<<<< FIN_FST_FLD_GVT

           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE  0 TO FRM-IND-GTP-LEN IN GVT-FLD.
           IF SCR-CMND = 'MTA'
               PERFORM PRO-FLD-GVT
               MOVE FRM-CPIM-UBY TO GVT-IIV-TSD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-IIV-SVS-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-CTR-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-TRR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-COD-UMD-ATR IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-M2-CTR-ATR  IN GVT-FLD
               MOVE FRM-CPIM-UBY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD
               MOVE -1 TO GVT-IIV-TSD-LEN IN GVT-FLD
               GO TO FIN-FST-FLD-GVT.

           MOVE FRM-CPIM-AEY TO FRM-IND-GTP-ATR IN GVT-FLD.

           IF SCR-CMND = 'RVL'
               MOVE FRM-CPIM-AEY TO GVT-FEC-TSN-ATR IN GVT-FLD
               MOVE -1 TO GVT-FEC-RVL-LEN IN GVT-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GVT-FEC-RVL-ATR IN GVT-FLD
               MOVE -1 TO GVT-FEC-TSN-LEN IN GVT-FLD.
            
           IF FRM-IND-GTP IN GVT-FLD = 'S'
               MOVE FRM-CPIM-AEY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.

           MOVE GVT-NUM-SIS IN GVT-FLD TO GAR-NUM-SIS IN GDP.
           MOVE GVT-COD-CRR IN GVT-FLD TO GAR-COD-CRR IN GDP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDP.
           IF FIO-STAT-OKS
               MOVE FRM-CPIM-AEY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
      *>>>>
       FIN-FST-FLD-GVT.
           EXIT.
       
       PRO-KEY-GVT SECTION.
       INI-PRO-KEY-GVT.
           PERFORM PRO-IKY-GVT.
           PERFORM PRO-AKY-GVT.
           PERFORM PRO-MKY-GVT.
       FIN-PRO-KEY-GVT.
           EXIT.
       
       PRO-IKY-GVT SECTION.
       INI-PRO-IKY-GVT.
           MOVE FRM-CPIM-AEY TO GVT-NUM-SIS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-CRR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-AEY TO GVT-COD-TSN-ATR IN GVT-FLD.
       FIN-PRO-IKY-GVT.
           EXIT.
       
       PRO-MKY-GVT SECTION.
       INI-PRO-MKY-GVT.
       FIN-PRO-MKY-GVT.
           EXIT.
       
       PRO-AKY-GVT SECTION.
       INI-PRO-AKY-GVT.
       FIN-PRO-AKY-GVT.
           EXIT.
       
       UNP-KEY-GVT SECTION.
       INI-UNP-KEY-GVT.
           PERFORM UNP-IKY-GVT.
           PERFORM UNP-AKY-GVT.
           PERFORM UNP-MKY-GVT.
       FIN-UNP-KEY-GVT.
           EXIT.
       
       UNP-IKY-GVT SECTION.
       INI-UNP-IKY-GVT.
           MOVE FRM-CPIM-UBY TO GVT-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GVT-COD-TSN-ATR.
       FIN-UNP-IKY-GVT.
           EXIT.
       
       UNP-MKY-GVT SECTION.
       INI-UNP-MKY-GVT.
       FIN-UNP-MKY-GVT.
           EXIT.
       
       UNP-AKY-GVT SECTION.
       INI-UNP-AKY-GVT.
       FIN-UNP-AKY-GVT.
           EXIT.
       
       UNP-FLD-GVT SECTION.
       INI-UNP-FLD-GVT.
           MOVE FRM-CPIM-UBY TO FRM-IND-GTP-ATR IN GVT-FLD.
           PERFORM UNP-GVT-GVT.
           PERFORM UNP-GDG-GVT.
       FIN-UNP-FLD-GVT.
           EXIT.
       
       UNP-GVT-GVT SECTION.
       INI-UNP-GVT-GVT.
           MOVE FRM-CPIM-UBY TO GVT-FEC-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-VAL-CML-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-VAL-LIQ-TSN-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-PCT-PON-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-PCT-AJT-SUP-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-IIV-TSD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-IIV-SVS-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-TIP-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-M2-TRR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-COD-UMD-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-FEC-RVL-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-M2-CTR-ATR IN GVT-FLD.
           MOVE FRM-CPIM-UBY TO GVT-TIP-MAQ-EQP-ATR IN GVT-FLD.
       FIN-UNP-GVT-GVT.
           EXIT.
       
       UNP-GDG-GVT SECTION.
       INI-UNP-GDG-GVT.
       FIN-UNP-GDG-GVT.
           EXIT.
       
       VAL-KEY-GVT SECTION.
       INI-VAL-KEY-GVT.
           PERFORM VAL-IKY-GVT.
           PERFORM VAL-MKY-GVT.
           PERFORM VAL-AKY-GVT.
       FIN-VAL-KEY-GVT.
           EXIT.
       
       VAL-IKY-GVT SECTION.
       INI-VAL-IKY-GVT.
           PERFORM VAL-GVT-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-NUM-SIS-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-COD-CRR-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
           PERFORM VAL-GVT-COD-TSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GVT-COD-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-IKY-GVT.
       FIN-VAL-IKY-GVT.
           EXIT.
       
       VAL-MKY-GVT SECTION.
       INI-VAL-MKY-GVT.
       FIN-VAL-MKY-GVT.
           EXIT.
       
       VAL-AKY-GVT SECTION.
       INI-VAL-AKY-GVT.
       FIN-VAL-AKY-GVT.
           EXIT.
       
       VAL-GVT-NUM-SIS SECTION.
       INI-VAL-GVT-NUM-SIS.
           IF GVT-NUM-SIS IN GVT-FLD NOT > SPACES
              MOVE SPACES TO GVT-NUM-SIS IN GVT-FLD.
       FIN-VAL-GVT-NUM-SIS.
           EXIT.
       
       VAL-GVT-COD-CRR SECTION.
       INI-VAL-GVT-COD-CRR.
           IF GVT-COD-CRR IN GVT-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GVT-COD-CRR.
       FIN-VAL-GVT-COD-CRR.
           EXIT.
       
       VAL-GVT-COD-TSN SECTION.
       INI-VAL-GVT-COD-TSN.
       FIN-VAL-GVT-COD-TSN.
           EXIT.
       
       VAL-CON-KEY-GVT SECTION.
       INI-VAL-CON-KEY-GVT.
      *<<<< INI_VAL_CON_KEY_GVT
           IF FRM-FFLD = FRM-FFLD-PF5
               GO TO FIN-VAL-CON-KEY-GVT.

      *>>>>
           IF     GVT-NUM-SIS IN GVT-FLD NOT > SPACES 
              AND GVT-COD-CRR IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TSN IN GVT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
       FIN-VAL-CON-KEY-GVT.
           EXIT.
       
       VAL-CON-IKY-GVT SECTION.
       INI-VAL-CON-IKY-GVT.
           IF     GVT-NUM-SIS IN GVT-FLD NOT > SPACES 
              AND GVT-COD-CRR IN GVT-FLD NOT > ZEROES 
              AND GVT-COD-TSN IN GVT-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GVT.
      *<<<< FIN_VAL_CON_IKY_GVT
           IF GVT-COD-TSN IN GVT-FLD < 1
               MOVE 1 TO GVT-COD-TSN IN GVT-FLD
           ELSE
           IF GVT-COD-TSN IN GVT-FLD > 1
      *        Comando Ingreso
               MOVE 'GAR'      TO MSG-COD-SIST
               MOVE 'GVTIKY>1' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-IKY-GVT.
           EXIT.
       
       VAL-NUM-KEY-GVT SECTION.
       INI-VAL-NUM-KEY-GVT.
           PERFORM VAL-NUM-IKY-GVT.
           PERFORM VAL-NUM-MKY-GVT.
           PERFORM VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-KEY-GVT.
           EXIT.
       
       VAL-NUM-IKY-GVT SECTION.
       INI-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-COD-CRR.
           MOVE GVT-COD-CRR-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GVT-COD-CRR IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-COD-CRR-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       VAL-NUM-GVT-COD-TSN.
           MOVE GVT-COD-TSN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GVT-COD-TSN IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-COD-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-IKY-GVT.
       FIN-VAL-NUM-IKY-GVT.
           EXIT.
       
       VAL-NUM-MKY-GVT SECTION.
       INI-VAL-NUM-MKY-GVT.
       FIN-VAL-NUM-MKY-GVT.
           EXIT.
       
       VAL-NUM-AKY-GVT SECTION.
       INI-VAL-NUM-AKY-GVT.
       FIN-VAL-NUM-AKY-GVT.
           EXIT.
       
       VAL-NUM-FLD-GVT SECTION.
       INI-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-VAL-CML-TSN.
           MOVE GVT-VAL-CML-TSN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-VAL-CML-TSN IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-VAL-CML-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-VAL-LIQ-TSN.
           MOVE GVT-VAL-LIQ-TSN-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-VAL-LIQ-TSN IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-VAL-LIQ-TSN-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-PCT-PON.
           MOVE GVT-PCT-PON-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-PCT-PON IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-PCT-PON-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-VAL-PON.
           MOVE GVT-VAL-PON-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-VAL-PON IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-VAL-PON-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-PCT-AJT-SUP.
           MOVE GVT-PCT-AJT-SUP-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-PCT-AJT-SUP IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-PCT-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-VAL-AJT-SUP.
           MOVE GVT-VAL-AJT-SUP-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GVT-VAL-AJT-SUP IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-VAL-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-NUM-GTP.
           MOVE FRM-NUM-GTP-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-GTP IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-M2-TRR.
           MOVE GVT-M2-TRR-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GVT-M2-TRR IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-M2-TRR-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-GVT-M2-CTR.
           MOVE GVT-M2-CTR-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GVT-M2-CTR IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GVT-M2-CTR-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       VAL-NUM-FRM-VAL-ULT-CON.
           MOVE FRM-VAL-ULT-CON-ALF IN GVT-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO FRM-VAL-ULT-CON IN GVT-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-VAL-NUM-FLD-GVT.
       FIN-VAL-NUM-FLD-GVT.
           EXIT.
       
       EDT-KEY-GVT SECTION.
       INI-EDT-KEY-GVT.
           PERFORM EDT-IKY-GVT.
           PERFORM EDT-MKY-GVT.
           PERFORM EDT-AKY-GVT.
       FIN-EDT-KEY-GVT.
           EXIT.
       
       EDT-IKY-GVT SECTION.
       INI-EDT-IKY-GVT.
           IF GVT-COD-CRR-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-COD-CRR-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-COD-CRR IN GVT-FLD TO GVT-COD-CRR-EDT IN GVT-EDT.
           MOVE GVT-COD-CRR-EDT IN GVT-EDT TO 
                GVT-COD-CRR-ALF IN GVT-FLD.
           IF GVT-COD-TSN-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-COD-TSN-LEN IN GVT-FLD
                GO TO FIN-EDT-IKY-GVT.
           MOVE GVT-COD-TSN IN GVT-FLD TO GVT-COD-TSN-EDT IN GVT-EDT.
           MOVE GVT-COD-TSN-EDT IN GVT-EDT TO 
                GVT-COD-TSN-ALF IN GVT-FLD.
       FIN-EDT-IKY-GVT.
           EXIT.
       
       EDT-MKY-GVT SECTION.
       INI-EDT-MKY-GVT.
       FIN-EDT-MKY-GVT.
           EXIT.
       
       EDT-AKY-GVT SECTION.
       INI-EDT-AKY-GVT.
       FIN-EDT-AKY-GVT.
           EXIT.
       
       EDT-FLD-GVT SECTION.
       INI-EDT-FLD-GVT.
           IF GVT-VAL-CML-TSN-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-VAL-CML-TSN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-VAL-CML-TSN IN GVT-FLD TO 
                GVT-VAL-CML-TSN-EDT IN GVT-EDT.
           MOVE GVT-VAL-CML-TSN-EDT IN GVT-EDT TO 
                GVT-VAL-CML-TSN-ALF IN GVT-FLD.
           IF GVT-VAL-LIQ-TSN-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-VAL-LIQ-TSN-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-VAL-LIQ-TSN IN GVT-FLD TO 
                GVT-VAL-LIQ-TSN-EDT IN GVT-EDT.
           MOVE GVT-VAL-LIQ-TSN-EDT IN GVT-EDT TO 
                GVT-VAL-LIQ-TSN-ALF IN GVT-FLD.
           IF GVT-PCT-PON-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-PCT-PON-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-PCT-PON IN GVT-FLD TO GVT-PCT-PON-EDT IN GVT-EDT.
           MOVE GVT-PCT-PON-EDT IN GVT-EDT TO 
                GVT-PCT-PON-ALF IN GVT-FLD.
           IF GVT-VAL-PON-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-VAL-PON-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-VAL-PON IN GVT-FLD TO GVT-VAL-PON-EDT IN GVT-EDT.
           MOVE GVT-VAL-PON-EDT IN GVT-EDT TO 
                GVT-VAL-PON-ALF IN GVT-FLD.
           IF GVT-PCT-AJT-SUP-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-PCT-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-PCT-AJT-SUP IN GVT-FLD TO 
                GVT-PCT-AJT-SUP-EDT IN GVT-EDT.
           MOVE GVT-PCT-AJT-SUP-EDT IN GVT-EDT TO 
                GVT-PCT-AJT-SUP-ALF IN GVT-FLD.
           IF GVT-VAL-AJT-SUP-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-VAL-AJT-SUP-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO 
                GVT-VAL-AJT-SUP-EDT IN GVT-EDT.
           MOVE GVT-VAL-AJT-SUP-EDT IN GVT-EDT TO 
                GVT-VAL-AJT-SUP-ALF IN GVT-FLD.
           IF FRM-NUM-GTP-LEN IN GVT-FLD = -9
                MOVE -1 TO FRM-NUM-GTP-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-NUM-GTP IN GVT-FLD TO FRM-NUM-GTP-EDT IN GVT-EDT.
           MOVE FRM-NUM-GTP-EDT IN GVT-EDT TO 
                FRM-NUM-GTP-ALF IN GVT-FLD.
           IF GVT-M2-TRR-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-M2-TRR-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-M2-TRR IN GVT-FLD TO GVT-M2-TRR-EDT IN GVT-EDT.
           MOVE GVT-M2-TRR-EDT IN GVT-EDT TO GVT-M2-TRR-ALF IN GVT-FLD.
           IF GVT-M2-CTR-LEN IN GVT-FLD = -9
                MOVE -1 TO GVT-M2-CTR-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE GVT-M2-CTR IN GVT-FLD TO GVT-M2-CTR-EDT IN GVT-EDT.
           MOVE GVT-M2-CTR-EDT IN GVT-EDT TO GVT-M2-CTR-ALF IN GVT-FLD.
           IF FRM-VAL-ULT-CON-LEN IN GVT-FLD = -9
                MOVE -1 TO FRM-VAL-ULT-CON-LEN IN GVT-FLD
                GO TO FIN-EDT-FLD-GVT.
           MOVE FRM-VAL-ULT-CON IN GVT-FLD TO 
                FRM-VAL-ULT-CON-EDT IN GVT-EDT.
           MOVE FRM-VAL-ULT-CON-EDT IN GVT-EDT TO 
                FRM-VAL-ULT-CON-ALF IN GVT-FLD.
       FIN-EDT-FLD-GVT.
           EXIT.
      *<<<< EOF_VAX OR EOF_BQ OR EOF_BU
       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-VAL-CON SECTION.
       INI-OBT-VAL-CON.
           MOVE GDG-VCB IN GVT-FLD TO GAR-VCB IN GDG.
           IF NOT (
              GAR-TIP-VCB IN GDG = '0' AND
              GDG-VCB IN GVT-FLD NOT = WSS-COD-PESO IN WSS-VARI
              )
               MOVE GVT-VAL-AJT-SUP IN GVT-FLD TO
                    FRM-VAL-ULT-CON IN GVT-FLD
               GO TO FIN-OBT-VAL-CON.

           MOVE GVT-FA-RVL   IN GVT-FLD  TO FEC-FANO.
           MOVE FEC-SVLD                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE FEC-AVLD                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE GVT-FM-RVL   IN GVT-FLD  TO CAM-NUM-MCAM IN CAM(1).
           MOVE GVT-FD-RVL   IN GVT-FLD  TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE GDG-VCB      IN GVT-FLD  TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (
              FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
              )
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MULTIPLY GVT-VAL-AJT-SUP IN GVT-FLD
                     BY CAM-SGV-VCAM    IN CAM
                 GIVING WSS-VAL-PESO ROUNDED
               MOVE WSS-VAL-PESO TO FRM-VAL-ULT-CON IN GVT-FLD.
       FIN-OBT-VAL-CON.
           EXIT.

      *>>>>
