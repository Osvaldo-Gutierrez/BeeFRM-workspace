      * 17-Jan-96 12:42 PM
       PUT-ALL-GDG SECTION.
       INI-PUT-ALL-GDG.
           PERFORM PUT-GDG-GDG.
           PERFORM PUT-DBC-GDG.
       FIN-PUT-ALL-GDG.
           EXIT.
       
       PUT-GDG-GDG SECTION.
       INI-PUT-GDG-GDG.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GDG.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GDG
               GO TO FIN-PUT-GDG-GDG.
           MOVE GAR-NUM-SIS IN GDG TO GDG-NUM-SIS IN GDG-FLD.
           MOVE GAR-COD-CRR IN GDG TO GDG-COD-CRR IN GDG-FLD.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GDG-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GDG-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GDG-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GDG-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GDG-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GDG-FLD.
           MOVE GAR-COD-LIM IN GDG TO GDG-COD-LIM IN GDG-FLD.
           MOVE GAR-COD-EJE-ORI IN GDG TO GDG-COD-EJE-ORI IN GDG-FLD.
           MOVE GAR-COD-GRA IN GDG TO GDG-COD-GRA IN GDG-FLD.
           MOVE GAR-ES1 IN GDG TO GDG-ES1 IN GDG-FLD.
           MOVE GAR-IIV-AUT-ES1 IN GDG TO GDG-IIV-AUT-ES1 IN GDG-FLD.
           MOVE GAR-ES2 IN GDG TO GDG-ES2 IN GDG-FLD.
           MOVE GAR-FD-ALZ IN GDG TO GDG-FD-ALZ IN GDG-FLD.
           MOVE GAR-FM-ALZ IN GDG TO GDG-FM-ALZ IN GDG-FLD.
           MOVE GAR-FA-ALZ IN GDG TO GDG-FA-ALZ IN GDG-FLD.
           MOVE GAR-FD-VTO IN GDG TO GDG-FD-VTO IN GDG-FLD.
           MOVE GAR-FM-VTO IN GDG TO GDG-FM-VTO IN GDG-FLD.
           MOVE GAR-FA-VTO IN GDG TO GDG-FA-VTO IN GDG-FLD.
           MOVE GDG-CAI-ICLI IN GDG TO GDG-CAI-ICLI IN GDG-FLD.
           MOVE GDG-IIC-ICLI IN GDG TO GDG-IIC-ICLI IN GDG-FLD.
           MOVE GAR-FD-SOL-CNS IN GDG TO GDG-FD-SOL-CNS IN GDG-FLD.
           MOVE GAR-FM-SOL-CNS IN GDG TO GDG-FM-SOL-CNS IN GDG-FLD.
           MOVE GAR-FA-SOL-CNS IN GDG TO GDG-FA-SOL-CNS IN GDG-FLD.
           MOVE GAR-FD-ESC-CNS IN GDG TO GDG-FD-ESC-CNS IN GDG-FLD.
           MOVE GAR-FM-ESC-CNS IN GDG TO GDG-FM-ESC-CNS IN GDG-FLD.
           MOVE GAR-FA-ESC-CNS IN GDG TO GDG-FA-ESC-CNS IN GDG-FLD.
           MOVE GAR-IND-OBL-INS IN GDG TO GDG-IND-OBL-INS IN GDG-FLD.
           MOVE GDG-FD-ING-SIS IN GDG TO GDG-FD-ING-SIS IN GDG-FLD.
           MOVE GDG-FM-ING-SIS IN GDG TO GDG-FM-ING-SIS IN GDG-FLD.
           MOVE GDG-FA-ING-SIS IN GDG TO GDG-FA-ING-SIS IN GDG-FLD.
           MOVE GAR-COD-TSN IN GDG TO GDG-COD-TSN IN GDG-FLD.
           MOVE GAR-IND-CPL IN GDG TO GDG-IND-CPL IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GDG-FLD > SPACES
               MOVE GDG-COD-OFI IN GDG-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-COD-LIM IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'LIM ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-COD-LIM IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LIM IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
      *BUS-USR busca usuario en tablas
           IF GDG-COD-EJE-ORI IN GDG-FLD > SPACES
               MOVE GDG-COD-EJE-ORI IN GDG-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJE-ORI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-IIV-AUT-ES1 IN GDG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'ALZ ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES2 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES2 ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
      *<<<< FIN_PUT_GDG_GDG
           MOVE GAR-ES1 IN GDG TO WSS-EST-ANT IN CMA-VARI.

      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-ES1 IN GDG-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'ES1' TO TAB-COD-TTAB IN TAB
               MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-COD-DAT2 IN TAB(1) TO WSS-ES1-1 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(2) TO WSS-ES1-2 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(3) TO WSS-ES1-3 IN CMA-VARI
               MOVE TAB-COD-DAT2 IN TAB(4) TO WSS-ES1-4 IN CMA-VARI
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF GDG-IIC-ICLI IN GDG > ZEROES
               MOVE GDG-CIC-ICLI IN GDG TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
           IF FIO-STAT-OKS
               MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
               MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN GDG-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN GDG-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN GDG-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN GDG-FLD
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.

           MOVE GAR-IND-EXI-GAP IN GDG TO GAR-IND-EXI-GAP IN CMA-VARI.
           MOVE GAR-IND-CPL IN GDG TO GAR-IND-CPL IN CMA-VARI.


      *BUS-TAB Busca codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE GAR-TIP-REA-NRE IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TIP-REA-NRE IN GDG-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.


      *<<<< PGM_CHI
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Es Dep Plazo Propio
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
               PERFORM BUS-GDO-OPD
               MOVE OPD-CAI-IOPD IN DAP-VARI TO FRM-CAI-IOPD IN GDG-FLD
               MOVE OPD-IIC-IOPD IN DAP-VARI TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI
               MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD
               MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD,
                          FRM-GLS-DEUD IN GDG-FLD.
      *>>>>
      *>>>>
       FIN-PUT-GDG-GDG.
           EXIT.
       
       PUT-DBC-GDG SECTION.
       INI-PUT-DBC-GDG.
      *<<<< INI_PUT_DBC_GDG
           IF DBC-IIC-ICLI IN CMA-VARI > ZEROES
               MOVE DBC-KEY-IDBC IN CMA-VARI TO DBC-CIC-ICLI IN DBC
               MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
           ELSE
               MOVE FIO-STAT-NEX TO PGM-STAT-DBC.
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-GDG.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-GDG
               GO TO FIN-PUT-DBC-GDG.
           MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN GDG-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN GDG-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN GDG-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN GDG-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN GDG-FLD.
      *<<<< FIN_PUT_DBC_GDG
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-PUT-DBC-GDG.
           EXIT.
       
       KEY-ALL-GDG SECTION.
       INI-KEY-ALL-GDG.
           PERFORM KEY-GDG-GDG.
           PERFORM KEY-DBC-GDG.
       FIN-KEY-ALL-GDG.
           EXIT.
       
       KEY-GDG-GDG SECTION.
       INI-KEY-GDG-GDG.
           MOVE GDG-NUM-SIS IN GDG-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GDG-COD-CRR IN GDG-FLD TO GAR-COD-CRR IN GDG.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN GDG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN GDG.
       FIN-KEY-GDG-GDG.
           EXIT.
       
       KEY-DBC-GDG SECTION.
       INI-KEY-DBC-GDG.
           MOVE DBC-CAI-ICLI IN GDG-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN GDG-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC.
       FIN-KEY-DBC-GDG.
           EXIT.
       
       SCR-CLRA-GDG SECTION.
       INI-SCR-CLRA-GDG.
           PERFORM CLR-KEY-GDG.
           PERFORM CLR-FLD-GDG.
       FIN-SCR-CLRA-GDG.
           EXIT.
       
       CLR-KEY-GDG SECTION.
       INI-CLR-KEY-GDG.
           MOVE SPACES TO GDG-NUM-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-CRR IN GDG-FLD.
           MOVE SPACES TO DBC-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO DBC-IIC-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
           MOVE SPACES TO GDG-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GDG-FLD.
      *<<<< FIN_CLR_KEY_GDG
           MOVE 'GAR' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
               MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN GDG-FLD
               MOVE '0500' TO GDG-NUM-SIS IN GDG-FLD
               MOVE 0  TO GDG-NUM-SIS-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
           ELSE
      *        FLB: version 'C'onsist
               MOVE 'C' TO SCR-IND-V001.
      *>>>>
       FIN-CLR-KEY-GDG.
           EXIT.
       
       CLR-FLD-GDG SECTION.
       INI-CLR-FLD-GDG.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
           MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
           MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.
           PERFORM CLR-GDG-GDG.
           PERFORM CLR-DBC-GDG.
       FIN-CLR-FLD-GDG.
           EXIT.
       
       CLR-GDG-GDG SECTION.
       INI-CLR-GDG-GDG.
           MOVE SPACES TO GDG-COD-OFI IN GDG-FLD.
           MOVE SPACES TO GDG-VCB IN GDG-FLD.
           MOVE SPACES TO GDG-DES-1 IN GDG-FLD.
           MOVE SPACES TO GDG-DES-2 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-LIM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-EJE-ORI IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-GRA IN GDG-FLD.
           MOVE SPACES TO GDG-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-ES2 IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ALZ IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-VTO IN GDG-FLD.
           MOVE SPACES TO GDG-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO GDG-IIC-ICLI IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-SOL-CNS IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ESC-CNS IN GDG-FLD.
           MOVE SPACES TO GDG-IND-OBL-INS IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ING-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-TSN IN GDG-FLD.
           MOVE SPACES TO GDG-IND-CPL IN GDG-FLD.
       FIN-CLR-GDG-GDG.
           EXIT.
       
       CLR-DBC-GDG SECTION.
       INI-CLR-DBC-GDG.
       FIN-CLR-DBC-GDG.
           EXIT.
       
       FST-KEY-GDG SECTION.
       INI-FST-KEY-GDG.
           MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD.
       FIN-FST-KEY-GDG.
           EXIT.
       
       FST-FLD-GDG SECTION.
       INI-FST-FLD-GDG.
           MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      *<<<< FIN_FST_FLD_GDG
      *<<<< PGM_BMS AND NOT PGM_ARG
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      *>>>>
      *ALD-BNL Y FLB
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.             
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.         
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
      *ALD-BNL-FIN.
      *<<<< PGM_CHI
           IF NOT (
                   CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING'
              )
      *       No Es o No Ingresa Dep Plazo Propio 
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
      *>>>>

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
                   MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                   GO TO FIN-FST-FLD-GDG.

           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
               MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
                   MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
      * FIN
                   MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
               MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
           ELSE
           IF SCR-CMND = 'AGA'
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-FA-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FM-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FD-VTO IN GDG-FLD.

       FIN-ANL-HBL-FEC-VTO.
      *>>>>
       FIN-FST-FLD-GDG.
           EXIT.
       
       PRO-KEY-GDG SECTION.
       INI-PRO-KEY-GDG.
           PERFORM PRO-IKY-GDG.
           PERFORM PRO-AKY-GDG.
           PERFORM PRO-MKY-GDG.
       FIN-PRO-KEY-GDG.
           EXIT.
       
       PRO-IKY-GDG SECTION.
       INI-PRO-IKY-GDG.
           MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-CRR-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-TIP-OPE-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-STP-OPE-ATR IN GDG-FLD.
       FIN-PRO-IKY-GDG.
           EXIT.
       
       PRO-MKY-GDG SECTION.
       INI-PRO-MKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
       FIN-PRO-MKY-GDG.
           EXIT.
       
       PRO-AKY-GDG SECTION.
       INI-PRO-AKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       FIN-PRO-AKY-GDG.
           EXIT.
       
       UNP-KEY-GDG SECTION.
       INI-UNP-KEY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM UNP-AKY-GDG.
           PERFORM UNP-MKY-GDG.
       FIN-UNP-KEY-GDG.
           EXIT.
       
       UNP-IKY-GDG SECTION.
       INI-UNP-IKY-GDG.
           MOVE FRM-CPIM-UBY TO GDG-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GDG-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GDG-TIP-OPE-ATR.
           MOVE FRM-CPIM-UBY TO GDG-STP-OPE-ATR.
       FIN-UNP-IKY-GDG.
           EXIT.
       
       UNP-MKY-GDG SECTION.
       INI-UNP-MKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR.
       FIN-UNP-MKY-GDG.
           EXIT.
       
       UNP-AKY-GDG SECTION.
       INI-UNP-AKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-GDG.
           EXIT.
       
       UNP-FLD-GDG SECTION.
       INI-UNP-FLD-GDG.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN GDG-FLD.
           PERFORM UNP-GDG-GDG.
           PERFORM UNP-DBC-GDG.
       FIN-UNP-FLD-GDG.
           EXIT.
       
       UNP-GDG-GDG SECTION.
       INI-UNP-GDG-GDG.
           MOVE FRM-CPIM-UBY TO GDG-COD-OFI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-VCB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-LIM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-GRA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-VTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
       FIN-UNP-GDG-GDG.
           EXIT.
       
       UNP-DBC-GDG SECTION.
       INI-UNP-DBC-GDG.
       FIN-UNP-DBC-GDG.
           EXIT.
       
       VAL-KEY-GDG SECTION.
       INI-VAL-KEY-GDG.
           PERFORM VAL-IKY-GDG.
           PERFORM VAL-MKY-GDG.
           PERFORM VAL-AKY-GDG.
       FIN-VAL-KEY-GDG.
           EXIT.
       
       VAL-IKY-GDG SECTION.
       INI-VAL-IKY-GDG.
           PERFORM VAL-GDG-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-TIP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
           PERFORM VAL-GDG-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-STP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-IKY-GDG.
       FIN-VAL-IKY-GDG.
           EXIT.
       
       VAL-MKY-GDG SECTION.
       INI-VAL-MKY-GDG.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
       FIN-VAL-MKY-GDG.
           EXIT.
       
       VAL-AKY-GDG SECTION.
       INI-VAL-AKY-GDG.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-NOMC-LEN IN GDG-FLD
                GO TO FIN-VAL-AKY-GDG.
       FIN-VAL-AKY-GDG.
           EXIT.
       
       VAL-GDG-NUM-SIS SECTION.
       INI-VAL-GDG-NUM-SIS.
           IF GDG-NUM-SIS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-NUM-SIS IN GDG-FLD.
       FIN-VAL-GDG-NUM-SIS.
           EXIT.
       
       VAL-GDG-COD-CRR SECTION.
       INI-VAL-GDG-COD-CRR.
      *<<<< GDG_COD_CRR
           IF GDG-COD-CRR IN GDG-FLD NOT > ZEROES
               MOVE GDG-NUM-SIS IN GDG-FLD TO CIC-CAI-ICIC IN CIC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-CIC
               IF NOT FIO-STAT-OKS
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'CICSTAT' TO MSG-COD-TMSG
                   MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE 0  TO GDG-COD-CRR-LEN IN GDG-FLD
                   MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD
                   MOVE 'S' TO FRM-UCUR
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-COD-CRR.
           EXIT.
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-IND-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS
               PERFORM GET-MSG
      *FLB CST 21-09-1993
      *<<<< PGM_CHI
               MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *>>>>
               MOVE 0  TO DBC-VRF-ICLI-LEN IN GDG-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *FLB CST 21-09-1993
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        DBC-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GDG-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       
       VAL-GDG-TIP-OPE SECTION.
       INI-VAL-GDG-TIP-OPE.
           IF GDG-TIP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-TIP-OPE IN GDG-FLD.
      *<<<< GDG_TIP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-TIP-OPE.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-TIP-OPE IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GDG-FLD.
       FIN-VAL-GDG-TIP-OPE.
           EXIT.
       
       VAL-GDG-STP-OPE SECTION.
       INI-VAL-GDG-STP-OPE.
           IF GDG-STP-OPE IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-STP-OPE IN GDG-FLD.
      *<<<< GDG_STP_OPE
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-GDG-STP-OPE.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE GAR-CLA-OPE IN TAG   TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = SPACES
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD
               GO TO FIN-VAL-GDG-STP-OPE.
      * Busca Glosa Tabla Real/no Real
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
                MOVE 'TAG    NEX' TO MSG-COD-MENS
                MOVE 'GAR' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
                MOVE SPACES TO MSG-COD-MENS
                MOVE 'GAR' TO TAB-COD-SIST
                MOVE 'RAL' TO TAB-COD-TTAB IN TAB
                MOVE GAR-TIP-REA-NRE IN TAG TO 
                     TAB-COD-CTAB IN TAB
                PERFORM BUS-TAB
                IF MSG-COD-MENS = SPACES
                    MOVE TAB-GLS-DESC IN TAB TO 
                         FRM-GLS-TIP-REA-NRE IN GDG-FLD
                ELSE
                    MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.


      *>>>>
       FIN-VAL-GDG-STP-OPE.
           EXIT.
       
       VAL-CON-KEY-GDG SECTION.
       INI-VAL-CON-KEY-GDG.
      *<<<< INI_VAL_CON_KEY_GDG
           IF FRM-FFLD = FRM-FFLD-PF8 OR
              FRM-FFLD = FRM-FFLD-PF7 OR
              FRM-FFLD = FRM-FFLD-PF5 OR
              FRM-FFLD = FRM-FFLD-PF6
               GO TO FIN-VAL-CON-KEY-GDG.
      *>>>>
           IF     GDG-NUM-SIS IN GDG-FLD NOT > SPACES 
              AND GDG-COD-CRR IN GDG-FLD NOT > ZEROES 
              AND DBC-CAI-ICLI IN GDG-FLD NOT > SPACES 
              AND DBC-IIC-ICLI IN GDG-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN GDG-FLD NOT > SPACES 
              AND DBC-NUM-ICLI IN GDG-FLD NOT > ZEROES 
              AND DBC-VRF-ICLI IN GDG-FLD NOT > SPACES 
              AND DBC-IND-ICLI IN GDG-FLD NOT > SPACES 
              AND DBC-GLS-ICLI IN GDG-FLD NOT > SPACES 
              AND GDG-TIP-OPE IN GDG-FLD NOT > SPACES 
              AND GDG-STP-OPE IN GDG-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-KEY-GDG.
           EXIT.
       
       VAL-CON-IKY-GDG SECTION.
       INI-VAL-CON-IKY-GDG.
      *<<<< INI_VAL_CON_IKY_GDG
           PERFORM VAL-GDG-TIP-OPE.
           PERFORM VAL-GDG-STP-OPE.
 
           MOVE GAR-IND-VTO IN TAG TO GAR-IND-VTO IN CMA-VARI.
      *<<<< PGM_CHI
           MOVE GAR-PCT-PON IN TAG TO GAR-PCT-PON IN CMA-VARI.
           MOVE GAR-PCT-AJT-SUP IN TAG TO 
                GAR-PCT-AJT-SUP IN CMA-VARI.
           PERFORM EXA-DAP.
           IF FRM-SUAR NOT = FRM-SUAR-MAL AND
              OPD-COD-TOPD IN DAP-VARI = GDG-TIP-OPE IN GDG-FLD AND
              OPD-COD-AOPD IN DAP-VARI = GDG-STP-OPE IN GDG-FLD
      *       Ingresa Dep Plazo Propio 
               MOVE 'S' TO CMA-IND-DAP IN CMA-VARI
           ELSE
               MOVE 'N' TO CMA-IND-DAP IN CMA-VARI.
      *>>>>
      *>>>>
           IF     GDG-NUM-SIS IN GDG-FLD NOT > SPACES 
              AND GDG-COD-CRR IN GDG-FLD NOT > ZEROES 
              AND GDG-TIP-OPE IN GDG-FLD NOT > SPACES 
              AND GDG-STP-OPE IN GDG-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GDG.
       FIN-VAL-CON-IKY-GDG.
           EXIT.
       
       VAL-NUM-KEY-GDG SECTION.
       INI-VAL-NUM-KEY-GDG.
           PERFORM VAL-NUM-IKY-GDG.
           PERFORM VAL-NUM-MKY-GDG.
           PERFORM VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-KEY-GDG.
           EXIT.
       
       VAL-NUM-IKY-GDG SECTION.
       INI-VAL-NUM-IKY-GDG.
       VAL-NUM-GDG-COD-CRR.
           MOVE GDG-COD-CRR-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-CRR IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-IKY-GDG.
       FIN-VAL-NUM-IKY-GDG.
           EXIT.
       
       VAL-NUM-MKY-GDG SECTION.
       INI-VAL-NUM-MKY-GDG.
       VAL-NUM-DBC-IIC-ICLI.
           MOVE DBC-IIC-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-IIC-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
       FIN-VAL-NUM-MKY-GDG.
           EXIT.
       
       VAL-NUM-AKY-GDG SECTION.
       INI-VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-AKY-GDG.
           EXIT.
       
       VAL-NUM-FLD-GDG SECTION.
       INI-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-IIC-IOPD.
           MOVE FRM-IIC-IOPD-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-GRA.
           MOVE GDG-COD-GRA-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-GRA IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-IIC-ICLI.
           MOVE GDG-IIC-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-IIC-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-TSN.
           MOVE GDG-COD-TSN-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-TSN IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       FIN-VAL-NUM-FLD-GDG.
           EXIT.
       
       EDT-KEY-GDG SECTION.
       INI-EDT-KEY-GDG.
           PERFORM EDT-IKY-GDG.
           PERFORM EDT-MKY-GDG.
           PERFORM EDT-AKY-GDG.
       FIN-EDT-KEY-GDG.
           EXIT.
       
       EDT-IKY-GDG SECTION.
       INI-EDT-IKY-GDG.
           IF GDG-COD-CRR-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-EDT-IKY-GDG.
           MOVE GDG-COD-CRR IN GDG-FLD TO GDG-COD-CRR-EDT IN GDG-EDT.
           MOVE GDG-COD-CRR-EDT IN GDG-EDT TO 
                GDG-COD-CRR-ALF IN GDG-FLD.
       FIN-EDT-IKY-GDG.
           EXIT.
       
       EDT-MKY-GDG SECTION.
       INI-EDT-MKY-GDG.
           IF DBC-IIC-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-IIC-ICLI IN GDG-FLD TO DBC-IIC-ICLI-EDT IN GDG-EDT.
           MOVE DBC-IIC-ICLI-EDT IN GDG-EDT TO 
                DBC-IIC-ICLI-ALF IN GDG-FLD.
           IF DBC-NUM-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI-EDT IN GDG-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GDG-EDT TO 
                DBC-NUM-ICLI-ALF IN GDG-FLD.
       FIN-EDT-MKY-GDG.
           EXIT.
       
       EDT-AKY-GDG SECTION.
       INI-EDT-AKY-GDG.
       FIN-EDT-AKY-GDG.
           EXIT.
       
       EDT-FLD-GDG SECTION.
       INI-EDT-FLD-GDG.
           IF FRM-IIC-IOPD-LEN IN GDG-FLD = -9
                MOVE -1 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO FRM-IIC-IOPD-EDT IN GDG-EDT.
           MOVE FRM-IIC-IOPD-EDT IN GDG-EDT TO 
                FRM-IIC-IOPD-ALF IN GDG-FLD.
           IF GDG-COD-GRA-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-GRA IN GDG-FLD TO GDG-COD-GRA-EDT IN GDG-EDT.
           MOVE GDG-COD-GRA-EDT IN GDG-EDT TO 
                GDG-COD-GRA-ALF IN GDG-FLD.
           IF GDG-IIC-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-IIC-ICLI IN GDG-FLD TO GDG-IIC-ICLI-EDT IN GDG-EDT.
           MOVE GDG-IIC-ICLI-EDT IN GDG-EDT TO 
                GDG-IIC-ICLI-ALF IN GDG-FLD.
           IF FRM-NUM-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-NUM-ICLI IN GDG-FLD TO FRM-NUM-ICLI-EDT IN GDG-EDT.
           MOVE FRM-NUM-ICLI-EDT IN GDG-EDT TO 
                FRM-NUM-ICLI-ALF IN GDG-FLD.
           IF GDG-COD-TSN-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-TSN IN GDG-FLD TO GDG-COD-TSN-EDT IN GDG-EDT.
           MOVE GDG-COD-TSN-EDT IN GDG-EDT TO 
                GDG-COD-TSN-ALF IN GDG-FLD.
       FIN-EDT-FLD-GDG.
           EXIT.
      *<<<< PGM_CHI AND ( EOF_BQ OR EOF_BU OR EOF_VAX )
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *>>>>
