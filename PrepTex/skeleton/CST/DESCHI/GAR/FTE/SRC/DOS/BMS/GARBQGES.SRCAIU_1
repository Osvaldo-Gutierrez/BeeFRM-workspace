      * 06-Jul-94 09:08 AM
       PUT-ALL-GES SECTION.
       INI-PUT-ALL-GES.
           PERFORM PUT-GES-GES.
           PERFORM PUT-GDG-GES.
       FIN-PUT-ALL-GES.
           EXIT.
       
       PUT-GES-GES SECTION.
       INI-PUT-GES-GES.
           IF PGM-STAT-GES-NUL
               GO TO FIN-PUT-GES-GES.
           IF NOT PGM-STAT-GES-OKS
               PERFORM CLR-GES-GES
               GO TO FIN-PUT-GES-GES.
           MOVE GAR-NUM-SIS IN GES TO GES-NUM-SIS IN GES-FLD.
           MOVE GAR-COD-CRR IN GES TO GES-COD-CRR IN GES-FLD.
           MOVE GAR-COD-ESP IN GES TO GES-COD-ESP IN GES-FLD.
           MOVE GAR-NUM-SIS-CDT IN GES TO GES-NUM-SIS-CDT IN GES-FLD.
           MOVE GAR-COD-CRR-CDT IN GES TO GES-COD-CRR-CDT IN GES-FLD.
           MOVE GAR-NUM-DOC-CDT IN GES TO GES-NUM-DOC-CDT IN GES-FLD.
           MOVE GAR-FD-VTO-CDT IN GES TO GES-FD-VTO-CDT IN GES-FLD.
           MOVE GAR-FM-VTO-CDT IN GES TO GES-FM-VTO-CDT IN GES-FLD.
           MOVE GAR-FA-VTO-CDT IN GES TO GES-FA-VTO-CDT IN GES-FLD.
           MOVE GAR-COD-SIS-CDT IN GES TO GES-COD-SIS-CDT IN GES-FLD.
           MOVE GAR-PCT-LIM-CDT IN GES TO GES-PCT-LIM-CDT IN GES-FLD.
           MOVE GAR-VCB-LIM-CDT IN GES TO GES-VCB-LIM-CDT IN GES-FLD.
           MOVE GAR-VAL-LIM-CDT IN GES TO GES-VAL-LIM-CDT IN GES-FLD.
           MOVE GAR-TIP-VCB-CDT IN GES TO GES-TIP-VCB-CDT IN GES-FLD.
           MOVE GAR-TIP-OPE-CDT IN GES TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE GAR-STP-OPE-CDT IN GES TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE GAR-VCB-CDT IN GES TO GES-VCB-CDT IN GES-FLD.
           MOVE GAR-COD-DST-CDT IN GES TO GES-COD-DST-CDT IN GES-FLD.
           MOVE GAR-TIP-DEU IN GES TO GES-TIP-DEU IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-SIS-CDT IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SIS ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-SIS-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SIS-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SIS-CDT IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-COD-DST-CDT IN GES-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'DES ' TO TAB-COD-TTAB IN TAB
               MOVE GES-COD-DST-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DST-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD.
      *<<<< FIN_PUT_GES_GES
      *BUS-COL busca datos Documento Legal Credito en Colocaciones
           IF GES-COD-CRR-CDT IN GES-FLD > ZEROES
               PERFORM BUS-COL
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-PUT-GES-GES.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-VCB-LIM-CDT IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-VCB-LIM-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-LIM-CDT IN GES-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           MOVE GES-VCB-CDT IN GES-FLD TO GAR-VCB-CDT IN GES.
           IF GES-TIP-VCB-CDT IN GES-FLD > SPACES AND
              GAR-COD-VCB-CDT IN GES NOT > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE GES-TIP-VCB-CDT IN GES-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TIP-VCB-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO GES-TIP-VCB-CDT     IN GES-FLD
                              FRM-GLS-TIP-VCB-CDT IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-TIP-OPE-CDT IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE GES-TIP-OPE-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *FLB CST  8-NOV-1993 
               MOVE TAB TO TIO
      *FLB CST  8-NOV-1993 
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIP-OPE-CDT IN GES-FLD.

      *FLB CST  8-NOV-1993 
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               GO TO FIN-BUS-AUX.

           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE.
           MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE.
           MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO
                FRM-GLS-STP-OPE-CDT IN GES-FLD.
       FIN-BUS-AUX.
      *FLB CST  8-NOV-1993 FIN
      *BUS-TAB busca glosa de codigo en tabla
           IF GES-VCB-CDT IN GES-FLD > SPACES AND
              GAR-COD-VCB-CDT IN GES > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE GES-VCB-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CDT IN GES-FLD.
      *>>>>
       FIN-PUT-GES-GES.
           EXIT.
       
       PUT-GDG-GES SECTION.
       INI-PUT-GDG-GES.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GES.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GES
               GO TO FIN-PUT-GDG-GES.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GES-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GES-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GES-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GES-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GES-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GES-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GES-FLD > SPACES
               MOVE GDG-COD-OFI IN GES-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GES-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GES-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GES-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GES-FLD.
       FIN-PUT-GDG-GES.
           EXIT.
       
       KEY-ALL-GES SECTION.
       INI-KEY-ALL-GES.
           PERFORM KEY-GES-GES.
           PERFORM KEY-GDG-GES.
       FIN-KEY-ALL-GES.
           EXIT.
       
       KEY-GES-GES SECTION.
       INI-KEY-GES-GES.
           MOVE GES-NUM-SIS IN GES-FLD TO GAR-NUM-SIS IN GES.
           MOVE GES-COD-CRR IN GES-FLD TO GAR-COD-CRR IN GES.
           MOVE GES-COD-ESP IN GES-FLD TO GAR-COD-ESP IN GES.
       FIN-KEY-GES-GES.
           EXIT.
       
       KEY-GDG-GES SECTION.
       INI-KEY-GDG-GES.
       FIN-KEY-GDG-GES.
           EXIT.
       
       SCR-CLRA-GES SECTION.
       INI-SCR-CLRA-GES.
           PERFORM CLR-KEY-GES.
           PERFORM CLR-FLD-GES.
       FIN-SCR-CLRA-GES.
           EXIT.
       
       CLR-KEY-GES SECTION.
       INI-CLR-KEY-GES.
           MOVE SPACES TO GES-NUM-SIS IN GES-FLD.
           MOVE ZEROES TO GES-COD-CRR IN GES-FLD.
           MOVE ZEROES TO GES-COD-ESP IN GES-FLD.
       FIN-CLR-KEY-GES.
           EXIT.
       
       CLR-FLD-GES SECTION.
       INI-CLR-FLD-GES.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SIS-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD.
           PERFORM CLR-GES-GES.
           PERFORM CLR-GDG-GES.
       FIN-CLR-FLD-GES.
           EXIT.
       
       CLR-GES-GES SECTION.
       INI-CLR-GES-GES.
           MOVE SPACES TO GES-NUM-SIS-CDT IN GES-FLD.
           MOVE ZEROES TO GES-COD-CRR-CDT IN GES-FLD.
           MOVE ZEROES TO GES-NUM-DOC-CDT IN GES-FLD.
           MOVE ZEROES TO GES-FEC-VTO-CDT IN GES-FLD.
           MOVE SPACES TO GES-COD-SIS-CDT IN GES-FLD.
           MOVE ZEROES TO GES-PCT-LIM-CDT IN GES-FLD.
           MOVE SPACES TO GES-VCB-LIM-CDT IN GES-FLD.
           MOVE ZEROES TO GES-VAL-LIM-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-VCB-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO GES-VCB-CDT IN GES-FLD.
           MOVE SPACES TO GES-COD-DST-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-DEU IN GES-FLD.
       FIN-CLR-GES-GES.
           EXIT.
       
       CLR-GDG-GES SECTION.
       INI-CLR-GDG-GES.
           MOVE SPACES TO GDG-TIP-OPE IN GES-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GES-FLD.
           MOVE SPACES TO GDG-COD-OFI IN GES-FLD.
           MOVE SPACES TO GDG-VCB IN GES-FLD.
           MOVE SPACES TO GDG-DES-1 IN GES-FLD.
           MOVE SPACES TO GDG-DES-2 IN GES-FLD.
       FIN-CLR-GDG-GES.
           EXIT.
       
       FST-KEY-GES SECTION.
       INI-FST-KEY-GES.
           MOVE -1 TO GES-NUM-SIS-LEN IN GES-FLD.
       FIN-FST-KEY-GES.
           EXIT.
       
       FST-FLD-GES SECTION.
       INI-FST-FLD-GES.
           MOVE -1 TO GES-NUM-SIS-CDT-LEN IN GES-FLD.
      *<<<< FIN_FST_FLD_GES
           IF GES-COD-CRR-CDT IN GES-FLD > ZEROES
               MOVE FRM-CPIM-AEY TO GES-FEC-VTO-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-VCB-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-STP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-VCB-CDT-ATR     IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-DST-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-DEU-ATR    IN GES-FLD.
      *>>>>
       FIN-FST-FLD-GES.
           EXIT.
       
       PRO-KEY-GES SECTION.
       INI-PRO-KEY-GES.
           PERFORM PRO-IKY-GES.
           PERFORM PRO-AKY-GES.
           PERFORM PRO-MKY-GES.
       FIN-PRO-KEY-GES.
           EXIT.
       
       PRO-IKY-GES SECTION.
       INI-PRO-IKY-GES.
           MOVE FRM-CPIM-AEY TO GES-NUM-SIS-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-CRR-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-ESP-ATR IN GES-FLD.
       FIN-PRO-IKY-GES.
           EXIT.
       
       PRO-MKY-GES SECTION.
       INI-PRO-MKY-GES.
       FIN-PRO-MKY-GES.
           EXIT.
       
       PRO-AKY-GES SECTION.
       INI-PRO-AKY-GES.
       FIN-PRO-AKY-GES.
           EXIT.
       
       UNP-KEY-GES SECTION.
       INI-UNP-KEY-GES.
           PERFORM UNP-IKY-GES.
           PERFORM UNP-AKY-GES.
           PERFORM UNP-MKY-GES.
       FIN-UNP-KEY-GES.
           EXIT.
       
       UNP-IKY-GES SECTION.
       INI-UNP-IKY-GES.
           MOVE FRM-CPIM-UBY TO GES-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GES-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GES-COD-ESP-ATR.
       FIN-UNP-IKY-GES.
           EXIT.
       
       UNP-MKY-GES SECTION.
       INI-UNP-MKY-GES.
       FIN-UNP-MKY-GES.
           EXIT.
       
       UNP-AKY-GES SECTION.
       INI-UNP-AKY-GES.
       FIN-UNP-AKY-GES.
           EXIT.
       
       UNP-FLD-GES SECTION.
       INI-UNP-FLD-GES.
           PERFORM UNP-GES-GES.
           PERFORM UNP-GDG-GES.
       FIN-UNP-FLD-GES.
           EXIT.
       
       UNP-GES-GES SECTION.
       INI-UNP-GES-GES.
           MOVE FRM-CPIM-UBY TO GES-NUM-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-CRR-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-NUM-DOC-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-FEC-VTO-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-PCT-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VCB-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VAL-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-STP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-DST-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-DEU-ATR IN GES-FLD.
       FIN-UNP-GES-GES.
           EXIT.
       
       UNP-GDG-GES SECTION.
       INI-UNP-GDG-GES.
       FIN-UNP-GDG-GES.
           EXIT.
       
       VAL-KEY-GES SECTION.
       INI-VAL-KEY-GES.
           PERFORM VAL-IKY-GES.
           PERFORM VAL-MKY-GES.
           PERFORM VAL-AKY-GES.
       FIN-VAL-KEY-GES.
           EXIT.
       
       VAL-IKY-GES SECTION.
       INI-VAL-IKY-GES.
           PERFORM VAL-GES-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-NUM-SIS-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
           PERFORM VAL-GES-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-COD-CRR-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
           PERFORM VAL-GES-COD-ESP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-COD-ESP-LEN IN GES-FLD
                GO TO FIN-VAL-IKY-GES.
       FIN-VAL-IKY-GES.
           EXIT.
       
       VAL-MKY-GES SECTION.
       INI-VAL-MKY-GES.
       FIN-VAL-MKY-GES.
           EXIT.
       
       VAL-AKY-GES SECTION.
       INI-VAL-AKY-GES.
       FIN-VAL-AKY-GES.
           EXIT.
       
       VAL-GES-NUM-SIS SECTION.
       INI-VAL-GES-NUM-SIS.
           IF GES-NUM-SIS IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-NUM-SIS IN GES-FLD.
       FIN-VAL-GES-NUM-SIS.
           EXIT.
       
       VAL-GES-COD-CRR SECTION.
       INI-VAL-GES-COD-CRR.
           IF GES-COD-CRR IN GES-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GES-COD-CRR.
       FIN-VAL-GES-COD-CRR.
           EXIT.
       
       VAL-GES-COD-ESP SECTION.
       INI-VAL-GES-COD-ESP.
      *<<<< GES_COD_ESP
           IF GES-COD-ESP IN GES-FLD NOT > ZEROES AND
              SCR-CCPP NOT = 'ING'
               PERFORM KEY-GES-GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF FIO-STAT-OKS
                   GO TO FIN-VAL-GES-COD-ESP.

           IF GES-COD-ESP IN GES-FLD NOT > ZEROES
               PERFORM BUS-COR-GES.

           IF GES-COD-ESP IN GES-FLD = ZEROES
               PERFORM ERR-GLS
                GO TO FIN-VAL-GES-COD-ESP.
      *>>>>
       FIN-VAL-GES-COD-ESP.
           EXIT.
       
       VAL-CON-KEY-GES SECTION.
       INI-VAL-CON-KEY-GES.
           IF     GES-NUM-SIS IN GES-FLD NOT > SPACES 
              AND GES-COD-CRR IN GES-FLD NOT > ZEROES 
              AND GES-COD-ESP IN GES-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GES.
       FIN-VAL-CON-KEY-GES.
           EXIT.
       
       VAL-CON-IKY-GES SECTION.
       INI-VAL-CON-IKY-GES.
      *<<<< INI_VAL_CON_IKY_GES
           IF SCR-CCPP = 'ELI' 
               PERFORM KEY-GES-GES
               ADD 1 TO GAR-COD-ESP IN GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF FIO-STAT-OKS
                   MOVE 'GAR'       TO MSG-COD-SIST
                   MOVE 'IKYSIGEXI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
                   GO TO FIN-VAL-CON-IKY-GES.

           IF GES-COD-ESP IN GES-FLD > 1
               PERFORM KEY-GES-GES
               SUBTRACT 1 FROM GES-COD-ESP IN GES-FLD
                        GIVING GAR-COD-ESP IN GES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF NOT FIO-STAT-OKS
                   MOVE 'GAR'       TO MSG-COD-SIST
                   MOVE 'IKYANTNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-IKY-GES
               ELSE
      *            Gtia a conjunto de creditos
                   IF GAR-COD-CRR-CDT IN GES NOT > ZEROES
                       MOVE 'GAR'         TO MSG-COD-SIST
                       MOVE 'GES SOLO 1'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-CON-IKY-GES
                   ELSE

      *                Gtia a un credito individual
      *                Ingresa Item siguientes al primero
                       GO TO FIN-VAL-CON-IKY-GES.

      *>>>>
           IF     GES-NUM-SIS IN GES-FLD NOT > SPACES 
              AND GES-COD-CRR IN GES-FLD NOT > ZEROES 
              AND GES-COD-ESP IN GES-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GES.
       FIN-VAL-CON-IKY-GES.
           EXIT.
       
       VAL-NUM-KEY-GES SECTION.
       INI-VAL-NUM-KEY-GES.
           PERFORM VAL-NUM-IKY-GES.
           PERFORM VAL-NUM-MKY-GES.
           PERFORM VAL-NUM-AKY-GES.
       FIN-VAL-NUM-KEY-GES.
           EXIT.
       
       VAL-NUM-IKY-GES SECTION.
       INI-VAL-NUM-IKY-GES.
       VAL-NUM-GES-COD-CRR.
           MOVE GES-COD-CRR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-CRR IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-CRR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       VAL-NUM-GES-COD-ESP.
           MOVE GES-COD-ESP-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-ESP IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-ESP-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       FIN-VAL-NUM-IKY-GES.
           EXIT.
       
       VAL-NUM-MKY-GES SECTION.
       INI-VAL-NUM-MKY-GES.
       FIN-VAL-NUM-MKY-GES.
           EXIT.
       
       VAL-NUM-AKY-GES SECTION.
       INI-VAL-NUM-AKY-GES.
       FIN-VAL-NUM-AKY-GES.
           EXIT.
       
       VAL-NUM-FLD-GES SECTION.
       INI-VAL-NUM-FLD-GES.
       VAL-NUM-GES-COD-CRR-CDT.
           MOVE GES-COD-CRR-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-CRR-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-CRR-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-NUM-DOC-CDT.
           MOVE GES-NUM-DOC-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-NUM-DOC-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-NUM-DOC-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-PCT-LIM-CDT.
           MOVE GES-PCT-LIM-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GES-PCT-LIM-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-PCT-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-VAL-LIM-CDT.
           MOVE GES-VAL-LIM-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GES-VAL-LIM-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-VAL-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       FIN-VAL-NUM-FLD-GES.
           EXIT.
       
       EDT-KEY-GES SECTION.
       INI-EDT-KEY-GES.
           PERFORM EDT-IKY-GES.
           PERFORM EDT-MKY-GES.
           PERFORM EDT-AKY-GES.
       FIN-EDT-KEY-GES.
           EXIT.
       
       EDT-IKY-GES SECTION.
       INI-EDT-IKY-GES.
           IF GES-COD-CRR-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-CRR-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-COD-CRR IN GES-FLD TO GES-COD-CRR-EDT IN GES-EDT.
           MOVE GES-COD-CRR-EDT IN GES-EDT TO 
                GES-COD-CRR-ALF IN GES-FLD.
           IF GES-COD-ESP-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-ESP-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-COD-ESP IN GES-FLD TO GES-COD-ESP-EDT IN GES-EDT.
           MOVE GES-COD-ESP-EDT IN GES-EDT TO 
                GES-COD-ESP-ALF IN GES-FLD.
       FIN-EDT-IKY-GES.
           EXIT.
       
       EDT-MKY-GES SECTION.
       INI-EDT-MKY-GES.
       FIN-EDT-MKY-GES.
           EXIT.
       
       EDT-AKY-GES SECTION.
       INI-EDT-AKY-GES.
       FIN-EDT-AKY-GES.
           EXIT.
       
       EDT-FLD-GES SECTION.
       INI-EDT-FLD-GES.
           IF GES-COD-CRR-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-CRR-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO 
                GES-COD-CRR-CDT-EDT IN GES-EDT.
           MOVE GES-COD-CRR-CDT-EDT IN GES-EDT TO 
                GES-COD-CRR-CDT-ALF IN GES-FLD.
           IF GES-NUM-DOC-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-NUM-DOC-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO 
                GES-NUM-DOC-CDT-EDT IN GES-EDT.
           MOVE GES-NUM-DOC-CDT-EDT IN GES-EDT TO 
                GES-NUM-DOC-CDT-ALF IN GES-FLD.
           IF GES-PCT-LIM-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-PCT-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-PCT-LIM-CDT IN GES-FLD TO 
                GES-PCT-LIM-CDT-EDT IN GES-EDT.
           MOVE GES-PCT-LIM-CDT-EDT IN GES-EDT TO 
                GES-PCT-LIM-CDT-ALF IN GES-FLD.
           IF GES-VAL-LIM-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-VAL-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-VAL-LIM-CDT IN GES-FLD TO 
                GES-VAL-LIM-CDT-EDT IN GES-EDT.
           MOVE GES-VAL-LIM-CDT-EDT IN GES-EDT TO 
                GES-VAL-LIM-CDT-ALF IN GES-FLD.
       FIN-EDT-FLD-GES.
           EXIT.
      *<<<< EOF BM
       BUS-COL SECTION.
       INI-BUS-COL.
      * LEE DOCUMENTO LEGAL DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           IF DLC-VAL-SDLC IN DLC NOT > ZEROES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC SDLC=0'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

      * LEE OPERACION DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'OPC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           MOVE DLC-FEC-FMAV   IN DLC TO GAR-FEC-VTO-CDT IN GES.
           MOVE GAR-FA-VTO-CDT IN GES TO GES-FA-VTO-CDT  IN GES-FLD.
           MOVE GAR-FM-VTO-CDT IN GES TO GES-FM-VTO-CDT  IN GES-FLD.
           MOVE GAR-FD-VTO-CDT IN GES TO GES-FD-VTO-CDT  IN GES-FLD.
           MOVE OPC-COD-TOOC   IN OPC TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-AOOC   IN OPC TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-VCOC   IN OPC TO GES-VCB-CDT     IN GES-FLD.
           MOVE OPC-COD-CDOC   IN OPC TO GES-COD-DST-CDT IN GES-FLD.
           GO TO FIN-BUS-COL.
       ERR-BUS-COL.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-BUS-COL.
           EXIT.
      *>>>>
