      * 19-Aug-94 01:47 PM
       RET-ALL-GES SECTION.
       INI-RET-ALL-GES.
           PERFORM KEY-ALL-GES.
           PERFORM RET-GES-GES.
           PERFORM RET-GDG-GES.
       FIN-RET-ALL-GES.
           EXIT.
       
       RET-GES-GES SECTION.
       INI-RET-GES-GES.
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO GAR-NUM-SIS-CDT IN GES.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO GAR-COD-CRR-CDT IN GES.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO GAR-NUM-DOC-CDT IN GES.
           MOVE GES-FD-VTO-CDT IN GES-FLD TO GAR-FD-VTO-CDT IN GES.
           MOVE GES-FM-VTO-CDT IN GES-FLD TO GAR-FM-VTO-CDT IN GES.
           MOVE GES-FA-VTO-CDT IN GES-FLD TO GAR-FA-VTO-CDT IN GES.
           MOVE GES-COD-SIS-CDT IN GES-FLD TO GAR-COD-SIS-CDT IN GES.
           MOVE GES-PCT-LIM-CDT IN GES-FLD TO GAR-PCT-LIM-CDT IN GES.
           MOVE GES-VCB-LIM-CDT IN GES-FLD TO GAR-VCB-LIM-CDT IN GES.
           MOVE GES-VAL-LIM-CDT IN GES-FLD TO GAR-VAL-LIM-CDT IN GES.
           MOVE GES-TIP-VCB-CDT IN GES-FLD TO GAR-TIP-VCB-CDT IN GES.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO GAR-TIP-OPE-CDT IN GES.
           MOVE GES-STP-OPE-CDT IN GES-FLD TO GAR-STP-OPE-CDT IN GES.
           MOVE GES-VCB-CDT IN GES-FLD TO GAR-VCB-CDT IN GES.
           MOVE GES-COD-DST-CDT IN GES-FLD TO GAR-COD-DST-CDT IN GES.
           MOVE GES-TIP-DEU IN GES-FLD TO GAR-TIP-DEU IN GES.
       FIN-RET-GES-GES.
           EXIT.
       
       RET-GDG-GES SECTION.
       INI-RET-GDG-GES.
           MOVE GDG-TIP-OPE IN GES-FLD TO GAR-TIP-OPE IN GDG.
           MOVE GDG-STP-OPE IN GES-FLD TO GAR-STP-OPE IN GDG.
           MOVE GDG-COD-OFI IN GES-FLD TO GAR-COD-OFI IN GDG.
           MOVE GDG-VCB IN GES-FLD TO GAR-VCB IN GDG.
           MOVE GDG-DES-1 IN GES-FLD TO GAR-DES-1 IN GDG.
           MOVE GDG-DES-2 IN GES-FLD TO GAR-DES-2 IN GDG.
       FIN-RET-GDG-GES.
           EXIT.
       
       KEY-ALL-GES SECTION.
       INI-KEY-ALL-GES.
           PERFORM KEY-GES-GES.
           PERFORM KEY-GDG-GES.
       FIN-KEY-ALL-GES.
           EXIT.
       
       KEY-GES-GES SECTION.
       INI-KEY-GES-GES.
           MOVE GES-NUM-SIS IN GES-FLD TO GAR-NUM-SIS IN GES.
           MOVE GES-COD-CRR IN GES-FLD TO GAR-COD-CRR IN GES.
           MOVE GES-COD-ESP IN GES-FLD TO GAR-COD-ESP IN GES.
       FIN-KEY-GES-GES.
           EXIT.
       
       KEY-GDG-GES SECTION.
       INI-KEY-GDG-GES.
       FIN-KEY-GDG-GES.
           EXIT.
       
       SCR-CLRA-GES SECTION.
       INI-SCR-CLRA-GES.
           PERFORM CLR-KEY-GES.
           PERFORM CLR-FLD-GES.
       FIN-SCR-CLRA-GES.
           EXIT.
       
       CLR-KEY-GES SECTION.
       INI-CLR-KEY-GES.
           MOVE SPACES TO GES-NUM-SIS IN GES-FLD.
           MOVE ZEROES TO GES-COD-CRR IN GES-FLD.
           MOVE ZEROES TO GES-COD-ESP IN GES-FLD.
       FIN-CLR-KEY-GES.
           EXIT.
       
       CLR-FLD-GES SECTION.
       INI-CLR-FLD-GES.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GES-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GES-FLD.
           MOVE SPACES TO FRM-GLS-SIS-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD.
           MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD.
           PERFORM CLR-GES-GES.
           PERFORM CLR-GDG-GES.
       FIN-CLR-FLD-GES.
           EXIT.
       
       CLR-GES-GES SECTION.
       INI-CLR-GES-GES.
           MOVE SPACES TO GES-NUM-SIS-CDT IN GES-FLD.
           MOVE ZEROES TO GES-COD-CRR-CDT IN GES-FLD.
           MOVE ZEROES TO GES-NUM-DOC-CDT IN GES-FLD.
           MOVE ZEROES TO GES-FEC-VTO-CDT IN GES-FLD.
           MOVE SPACES TO GES-COD-SIS-CDT IN GES-FLD.
           MOVE ZEROES TO GES-PCT-LIM-CDT IN GES-FLD.
           MOVE SPACES TO GES-VCB-LIM-CDT IN GES-FLD.
           MOVE ZEROES TO GES-VAL-LIM-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-VCB-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE SPACES TO GES-VCB-CDT IN GES-FLD.
           MOVE SPACES TO GES-COD-DST-CDT IN GES-FLD.
           MOVE SPACES TO GES-TIP-DEU IN GES-FLD.
       FIN-CLR-GES-GES.
           EXIT.
       
       CLR-GDG-GES SECTION.
       INI-CLR-GDG-GES.
           MOVE SPACES TO GDG-TIP-OPE IN GES-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GES-FLD.
           MOVE SPACES TO GDG-COD-OFI IN GES-FLD.
           MOVE SPACES TO GDG-VCB IN GES-FLD.
           MOVE SPACES TO GDG-DES-1 IN GES-FLD.
           MOVE SPACES TO GDG-DES-2 IN GES-FLD.
       FIN-CLR-GDG-GES.
           EXIT.
       
       FST-KEY-GES SECTION.
       INI-FST-KEY-GES.
           MOVE -1 TO GES-NUM-SIS-LEN IN GES-FLD.
       FIN-FST-KEY-GES.
           EXIT.
       
       FST-FLD-GES SECTION.
       INI-FST-FLD-GES.
           MOVE -1 TO GES-NUM-SIS-CDT-LEN IN GES-FLD.
      *<<<< FIN_FST_FLD_GES
           IF GES-COD-CRR-CDT IN GES-FLD > ZEROES
               MOVE FRM-CPIM-AEY TO GES-FEC-VTO-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-VCB-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-STP-OPE-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-VCB-CDT-ATR     IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-COD-DST-CDT-ATR IN GES-FLD
               MOVE FRM-CPIM-AEY TO GES-TIP-DEU-ATR    IN GES-FLD.
      *>>>>
       FIN-FST-FLD-GES.
           EXIT.
       
       PRO-KEY-GES SECTION.
       INI-PRO-KEY-GES.
           PERFORM PRO-MKY-GES.
       FIN-PRO-KEY-GES.
           EXIT.
       
       PRO-MKY-GES SECTION.
       INI-PRO-MKY-GES.
       FIN-PRO-MKY-GES.
           EXIT.
       
       PRO-FLD-GES SECTION.
       INI-PRO-FLD-GES.
           PERFORM PRO-GES-GES.
           PERFORM PRO-GDG-GES.
       FIN-PRO-FLD-GES.
           EXIT.
       
       PRO-GES-GES SECTION.
       INI-PRO-GES-GES.
           MOVE FRM-CPIM-AEY TO GES-NUM-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-CRR-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-NUM-DOC-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-FEC-VTO-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-PCT-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-VCB-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-VAL-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-TIP-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-TIP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-STP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-COD-DST-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-AEY TO GES-TIP-DEU-ATR IN GES-FLD.
       FIN-PRO-GES-GES.
           EXIT.
       
       PRO-GDG-GES SECTION.
       INI-PRO-GDG-GES.
       FIN-PRO-GDG-GES.
           EXIT.
       
       UNP-KEY-GES SECTION.
       INI-UNP-KEY-GES.
           PERFORM UNP-IKY-GES.
           PERFORM UNP-AKY-GES.
           PERFORM UNP-MKY-GES.
       FIN-UNP-KEY-GES.
           EXIT.
       
       UNP-IKY-GES SECTION.
       INI-UNP-IKY-GES.
           MOVE FRM-CPIM-UBY TO GES-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GES-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GES-COD-ESP-ATR.
       FIN-UNP-IKY-GES.
           EXIT.
       
       UNP-MKY-GES SECTION.
       INI-UNP-MKY-GES.
       FIN-UNP-MKY-GES.
           EXIT.
       
       UNP-AKY-GES SECTION.
       INI-UNP-AKY-GES.
       FIN-UNP-AKY-GES.
           EXIT.
       
       UNP-FLD-GES SECTION.
       INI-UNP-FLD-GES.
           PERFORM UNP-GES-GES.
           PERFORM UNP-GDG-GES.
       FIN-UNP-FLD-GES.
           EXIT.
       
       UNP-GES-GES SECTION.
       INI-UNP-GES-GES.
           MOVE FRM-CPIM-UBY TO GES-NUM-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-CRR-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-NUM-DOC-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-FEC-VTO-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-SIS-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-PCT-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VCB-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VAL-LIM-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-STP-OPE-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-VCB-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-COD-DST-CDT-ATR IN GES-FLD.
           MOVE FRM-CPIM-UBY TO GES-TIP-DEU-ATR IN GES-FLD.
       FIN-UNP-GES-GES.
           EXIT.
       
       UNP-GDG-GES SECTION.
       INI-UNP-GDG-GES.
       FIN-UNP-GDG-GES.
           EXIT.
       
       VAL-MKY-GES SECTION.
       INI-VAL-MKY-GES.
       FIN-VAL-MKY-GES.
           EXIT.
       
       VAL-FLD-GES SECTION.
       INI-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-REA-NRE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-TIP-OPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-STP-OPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-OPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STP-OPE-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-COD-OFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-OFI-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-OFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFI-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-VCB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-VCB-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-VCB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-DES-1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-1-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GDG-DES-2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-2-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-NUM-SIS-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-NUM-SIS-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-CRR-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-COD-CRR-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-NUM-DOC-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-NUM-DOC-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-FEC-VTO-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-FEC-VTO-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-SIS-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-COD-SIS-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-SIS-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-SIS-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-PCT-LIM-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-PCT-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-VCB-LIM-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-VCB-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-VCB-LIM-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-VAL-LIM-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-VAL-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-TIP-VCB-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-TIP-VCB-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TIP-VCB-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-VCB-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-TIP-OPE-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-TIP-OPE-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-TIP-OPE-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-OPE-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-STP-OPE-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-STP-OPE-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-STP-OPE-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STP-OPE-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-VCB-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-VCB-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-VCB-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-COD-DST-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-COD-DST-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-FRM-GLS-DST-CDT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-DST-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
           PERFORM VAL-GES-TIP-DEU.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GES-TIP-DEU-LEN IN GES-FLD
                GO TO FIN-VAL-FLD-GES.
       FIN-VAL-FLD-GES.
           EXIT.
       
       VAL-FRM-GLS-TIP-REA-NRE SECTION.
       INI-VAL-FRM-GLS-TIP-REA-NRE.
       FIN-VAL-FRM-GLS-TIP-REA-NRE.
           EXIT.
       
       VAL-GDG-TIP-OPE SECTION.
       INI-VAL-GDG-TIP-OPE.
       FIN-VAL-GDG-TIP-OPE.
           EXIT.
       
       VAL-GDG-STP-OPE SECTION.
       INI-VAL-GDG-STP-OPE.
       FIN-VAL-GDG-STP-OPE.
           EXIT.
       
       VAL-FRM-GLS-TIP-OPE SECTION.
       INI-VAL-FRM-GLS-TIP-OPE.
       FIN-VAL-FRM-GLS-TIP-OPE.
           EXIT.
       
       VAL-FRM-GLS-STP-OPE SECTION.
       INI-VAL-FRM-GLS-STP-OPE.
       FIN-VAL-FRM-GLS-STP-OPE.
           EXIT.
       
       VAL-GDG-COD-OFI SECTION.
       INI-VAL-GDG-COD-OFI.
       FIN-VAL-GDG-COD-OFI.
           EXIT.
       
       VAL-FRM-GLS-OFI SECTION.
       INI-VAL-FRM-GLS-OFI.
       FIN-VAL-FRM-GLS-OFI.
           EXIT.
       
       VAL-GDG-VCB SECTION.
       INI-VAL-GDG-VCB.
       FIN-VAL-GDG-VCB.
           EXIT.
       
       VAL-FRM-GLS-VCB SECTION.
       INI-VAL-FRM-GLS-VCB.
       FIN-VAL-FRM-GLS-VCB.
           EXIT.
       
       VAL-GDG-DES-1 SECTION.
       INI-VAL-GDG-DES-1.
       FIN-VAL-GDG-DES-1.
           EXIT.
       
       VAL-GDG-DES-2 SECTION.
       INI-VAL-GDG-DES-2.
       FIN-VAL-GDG-DES-2.
           EXIT.
       
       VAL-GES-NUM-SIS-CDT SECTION.
       INI-VAL-GES-NUM-SIS-CDT.
           IF GES-NUM-SIS-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-NUM-SIS-CDT IN GES-FLD.
      *<<<< GES_NUM_SIS_CDT
           IF GES-NUM-SIS-CDT NOT > SPACES
               MOVE SPACES TO GES-NUM-SIS-CDT IN GES-FLD 
               GO TO FIN-VAL-GES-NUM-SIS-CDT.
      *>>>>
       FIN-VAL-GES-NUM-SIS-CDT.
           EXIT.
       
       VAL-GES-COD-CRR-CDT SECTION.
       INI-VAL-GES-COD-CRR-CDT.
      *<<<< GES_COD_CRR_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-COD-CRR-CDT IN GES-FLD.

           IF GES-COD-ESP IN GES-FLD > 1 AND
              GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GESIICCDTBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-COD-CRR-CDT.

      *>>>>
       FIN-VAL-GES-COD-CRR-CDT.
           EXIT.
       
       VAL-GES-NUM-DOC-CDT SECTION.
       INI-VAL-GES-NUM-DOC-CDT.
      *<<<< GES_NUM_DOC_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-NUM-DOC-CDT IN GES-FLD
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

      *FLB CST  9-MAY-1994 DLC NO DEBE REPETIRSE
           PERFORM VAL-DLC-IGUA.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

           PERFORM BUS-COL.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.

      *<<<< PGM_CHI
           PERFORM VAL-RDC-GDD.
           IF MSG-COD-MENS > SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-NUM-DOC-CDT.
      *>>>>
      *>>>>
       FIN-VAL-GES-NUM-DOC-CDT.
           EXIT.
       
       VAL-GES-FEC-VTO-CDT SECTION.
       INI-VAL-GES-FEC-VTO-CDT.
      *VAL-FEC Validar Fecha
           MOVE GES-FEC-VTO-CDT IN GES-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GES_FEC_VTO_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE ZEROES TO GES-FEC-VTO-CDT IN GES-FLD
               GO TO FIN-VAL-GES-FEC-VTO-CDT.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE GES-FA-VTO-CDT IN GES-FLD TO FEC-FANO.
           MOVE GES-FM-VTO-CDT IN GES-FLD TO FEC-FMES.
           MOVE GES-FD-VTO-CDT IN GES-FLD TO FEC-FDIA.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GES-FEC-VTO-CDT IN GES-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GES-FEC-VTO-CDT.
       FIN-VAL-GES-FEC-VTO-CDT.
           EXIT.
       
       VAL-GES-COD-SIS-CDT SECTION.
       INI-VAL-GES-COD-SIS-CDT.
           IF GES-COD-SIS-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-SIS-CDT IN GES-FLD.
      *<<<< GES_COD_SIS_CDT
           IF GES-COD-CRR-CDT IN GES-FLD NOT > ZEROES
               MOVE SPACES TO GES-COD-SIS-CDT IN GES-FLD 
               GO TO FIN-VAL-GES-COD-SIS-CDT.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'SIS ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-SIS-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-SIS-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SIS-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-SIS-CDT IN GES-FLD.
       FIN-VAL-GES-COD-SIS-CDT.
           EXIT.
       
       VAL-FRM-GLS-SIS-CDT SECTION.
       INI-VAL-FRM-GLS-SIS-CDT.
       FIN-VAL-FRM-GLS-SIS-CDT.
           EXIT.
       
       VAL-GES-PCT-LIM-CDT SECTION.
       INI-VAL-GES-PCT-LIM-CDT.
      *<<<< GES_PCT_LIM_CDT
           IF GES-PCT-LIM-CDT IN GES-FLD > 100
               MOVE '% > 100' TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GES-PCT-LIM-CDT.
           EXIT.
       
       VAL-GES-VCB-LIM-CDT SECTION.
       INI-VAL-GES-VCB-LIM-CDT.
           IF GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-VCB-LIM-CDT IN GES-FLD.
      *<<<< GES_VCB_LIM_CDT
           IF ( GES-VAL-LIM-CDT IN GES-FLD     > ZEROES AND
                GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES ) OR
              ( GES-VAL-LIM-CDT IN GES-FLD NOT > ZEROES AND
                GES-VCB-LIM-CDT IN GES-FLD     > SPACES )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GESVALVCBCDT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GES-VCB-LIM-CDT.

           IF GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-VCB-LIM-CDT     IN GES-FLD
               MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD
               GO TO FIN-VAL-GES-VCB-LIM-CDT.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GES-VCB-LIM-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-VCB-LIM-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB-LIM-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-LIM-CDT IN GES-FLD.

      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *>>>>
       FIN-VAL-GES-VCB-LIM-CDT.
           EXIT.
       
       VAL-FRM-GLS-VCB-LIM-CDT SECTION.
       INI-VAL-FRM-GLS-VCB-LIM-CDT.
       FIN-VAL-FRM-GLS-VCB-LIM-CDT.
           EXIT.
       
       VAL-GES-VAL-LIM-CDT SECTION.
       INI-VAL-GES-VAL-LIM-CDT.
      *<<<< GES_VAL_LIM_CDT
           IF NOT ( GES-VAL-LIM-CDT IN GES-FLD > ZEROES OR
                     GES-PCT-LIM-CDT IN GES-FLD > ZEROES )
               MOVE 100 TO GES-PCT-LIM-CDT IN GES-FLD
           ELSE
           IF GES-VCB-LIM-CDT IN GES-FLD = WSS-COD-PESO IN WSS-VARI
               MOVE GES-VAL-LIM-CDT IN GES-FLD TO 
                    PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                    GES-VAL-LIM-CDT IN GES-FLD.
      *>>>>
       FIN-VAL-GES-VAL-LIM-CDT.
           EXIT.
       
       VAL-GES-TIP-VCB-CDT SECTION.
       INI-VAL-GES-TIP-VCB-CDT.
           IF GES-TIP-VCB-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-TIP-VCB-CDT IN GES-FLD.
      *<<<< GES_TIP_VCB_CDT
           IF GES-TIP-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-TIP-VCB-CDT     IN GES-FLD
               MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD
               GO TO FIN-VAL-GES-TIP-VCB-CDT.

      *VAL-MSC Valida indicador ( miscelaneo ) de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'TVAL' TO MSC-COD-TMSC IN MSC.
           MOVE GES-TIP-VCB-CDT IN GES-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              GES-TIP-VCB-CDT IN GES-FLD > SPACES
               MOVE MSC-GLS-DESC IN MSC TO 
                    FRM-GLS-TIP-VCB-CDT IN GES-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-VCB-CDT IN GES-FLD.

      *>>>>
       FIN-VAL-GES-TIP-VCB-CDT.
           EXIT.
       
       VAL-FRM-GLS-TIP-VCB-CDT SECTION.
       INI-VAL-FRM-GLS-TIP-VCB-CDT.
       FIN-VAL-FRM-GLS-TIP-VCB-CDT.
           EXIT.
       
       VAL-GES-TIP-OPE-CDT SECTION.
       INI-VAL-GES-TIP-OPE-CDT.
           IF GES-TIP-OPE-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-TIP-OPE-CDT IN GES-FLD.
      *<<<< GES_TIP_OPE_CDT
           IF GES-TIP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD
               GO TO FIN-VAL-GES-TIP-OPE-CDT.

           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
               IF MSG-COD-MENS NOT = 'COD    NEX'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-GES-TIP-OPE-CDT
               ELSE
                   MOVE SPACES TO FRM-GLS-TIP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-TIP-OPE-CDT
           ELSE
                MOVE TAB-GLS-DESC IN TAB TO
                     FRM-GLS-TIP-OPE-CDT IN GES-FLD.
      *>>>>
      *<<<< FIN_GES_TIP_OPE_CDT
      *FLB CST  8-NOV-1993 
           MOVE TAB TO TIO.
      *>>>>
       FIN-VAL-GES-TIP-OPE-CDT.
           EXIT.
       
       VAL-FRM-GLS-TIP-OPE-CDT SECTION.
       INI-VAL-FRM-GLS-TIP-OPE-CDT.
       FIN-VAL-FRM-GLS-TIP-OPE-CDT.
           EXIT.
       
       VAL-GES-STP-OPE-CDT SECTION.
       INI-VAL-GES-STP-OPE-CDT.
           IF GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-STP-OPE-CDT IN GES-FLD.
      *<<<< GES_STP_OPE_CDT
           IF GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
               GO TO FIN-VAL-GES-STP-OPE-CDT.

      *FLB CST  8-NOV-1993 
           IF TIO-GLS-SIST IN TIO = 'COL'
      *VAL-COD Valida EN TABLA AUX DE SISTEMA COL
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE
               MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE
               MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' OR
                  GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
                   MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-STP-OPE-CDT
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO
                        FRM-GLS-STP-OPE-CDT IN GES-FLD
                   GO TO FIN-VAL-GES-STP-OPE-CDT.
      *FLB CST  8-NOV-1993 

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE GES-TIP-OPE-CDT IN GES-FLD TO WSS-TIP-OPE.
           MOVE GES-STP-OPE-CDT IN GES-FLD TO WSS-STP-OPE.
           MOVE WSS-TIP-STP-OPE TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
               GES-STP-OPE-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STP-OPE-CDT IN GES-FLD
            ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STP-OPE-CDT IN GES-FLD.

      *>>>>
       FIN-VAL-GES-STP-OPE-CDT.
           EXIT.
       
       VAL-FRM-GLS-STP-OPE-CDT SECTION.
       INI-VAL-FRM-GLS-STP-OPE-CDT.
       FIN-VAL-FRM-GLS-STP-OPE-CDT.
           EXIT.
       
       VAL-GES-VCB-CDT SECTION.
       INI-VAL-GES-VCB-CDT.
           IF GES-VCB-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-VCB-CDT IN GES-FLD.
      *<<<< GES_VCB_CDT
           IF GES-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-VCB-CDT     IN GES-FLD 
               MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD
               GO TO FIN-VAL-GES-VCB-CDT.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GES-VCB-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-VCB-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-CDT IN GES-FLD.
      *>>>>
       FIN-VAL-GES-VCB-CDT.
           EXIT.
       
       VAL-FRM-GLS-VCB-CDT SECTION.
       INI-VAL-FRM-GLS-VCB-CDT.
       FIN-VAL-FRM-GLS-VCB-CDT.
           EXIT.
       
       VAL-GES-COD-DST-CDT SECTION.
       INI-VAL-GES-COD-DST-CDT.
           IF GES-COD-DST-CDT IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-COD-DST-CDT IN GES-FLD.
      *<<<< GES_COD_DST_CDT
           IF GES-COD-DST-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-COD-DST-CDT IN GES-FLD
               MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD
               GO TO FIN-VAL-GES-COD-DST-CDT.

      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'DES ' TO TAB-COD-TTAB IN TAB.
           MOVE GES-COD-DST-CDT IN GES-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GES-COD-DST-CDT IN GES-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DST-CDT IN GES-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-DST-CDT IN GES-FLD.
       FIN-VAL-GES-COD-DST-CDT.
           EXIT.
       
       VAL-FRM-GLS-DST-CDT SECTION.
       INI-VAL-FRM-GLS-DST-CDT.
       FIN-VAL-FRM-GLS-DST-CDT.
           EXIT.
       
       VAL-GES-TIP-DEU SECTION.
       INI-VAL-GES-TIP-DEU.
           IF GES-TIP-DEU IN GES-FLD NOT > SPACES
              MOVE SPACES TO GES-TIP-DEU IN GES-FLD.
      *<<<< GES_TIP_DEU
           IF GES-TIP-DEU IN GES-FLD NOT > SPACES
               MOVE SPACES TO GES-TIP-DEU IN GES-FLD
               GO TO FIN-VAL-GES-TIP-DEU.

           IF NOT ( GES-TIP-DEU IN GES-FLD = 'D' OR 'I' )
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'TDEU    D/I' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GES-TIP-DEU.
           EXIT.
       
       VAL-CON-FLD-GES SECTION.
       INI-VAL-CON-FLD-GES.
      *<<<< VAL_CON_FLD_GES
           IF GES-COD-CRR-CDT IN GES-FLD = ZEROES AND
              GES-TIP-VCB-CDT IN GES-FLD = SPACES AND
              GES-VCB-CDT     IN GES-FLD = SPACES AND
              GES-TIP-OPE-CDT IN GES-FLD = SPACES AND
              GES-COD-DST-CDT IN GES-FLD = SPACES AND
              GES-TIP-DEU IN GES-FLD = SPACES
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GESVALFLDBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-GES.

      *>>>>
       FIN-VAL-CON-FLD-GES.
           EXIT.
       
       VAL-CON-GES SECTION.
       INI-VAL-CON-GES.
       FIN-VAL-CON-GES.
           EXIT.
       
       VAL-NUM-KEY-GES SECTION.
       INI-VAL-NUM-KEY-GES.
           PERFORM VAL-NUM-IKY-GES.
           PERFORM VAL-NUM-MKY-GES.
           PERFORM VAL-NUM-AKY-GES.
       FIN-VAL-NUM-KEY-GES.
           EXIT.
       
       VAL-NUM-IKY-GES SECTION.
       INI-VAL-NUM-IKY-GES.
       VAL-NUM-GES-COD-CRR.
           MOVE GES-COD-CRR-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-CRR IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-CRR-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       VAL-NUM-GES-COD-ESP.
           MOVE GES-COD-ESP-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-ESP IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-ESP-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-IKY-GES.
       FIN-VAL-NUM-IKY-GES.
           EXIT.
       
       VAL-NUM-MKY-GES SECTION.
       INI-VAL-NUM-MKY-GES.
       FIN-VAL-NUM-MKY-GES.
           EXIT.
       
       VAL-NUM-AKY-GES SECTION.
       INI-VAL-NUM-AKY-GES.
       FIN-VAL-NUM-AKY-GES.
           EXIT.
       
       VAL-NUM-FLD-GES SECTION.
       INI-VAL-NUM-FLD-GES.
       VAL-NUM-GES-COD-CRR-CDT.
           MOVE GES-COD-CRR-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-COD-CRR-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-COD-CRR-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-NUM-DOC-CDT.
           MOVE GES-NUM-DOC-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GES-NUM-DOC-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-NUM-DOC-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-PCT-LIM-CDT.
           MOVE GES-PCT-LIM-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GES-PCT-LIM-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-PCT-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       VAL-NUM-GES-VAL-LIM-CDT.
           MOVE GES-VAL-LIM-CDT-ALF IN GES-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GES-VAL-LIM-CDT IN GES-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GES-VAL-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-VAL-NUM-FLD-GES.
       FIN-VAL-NUM-FLD-GES.
           EXIT.
       
       EDT-KEY-GES SECTION.
       INI-EDT-KEY-GES.
           PERFORM EDT-IKY-GES.
           PERFORM EDT-MKY-GES.
           PERFORM EDT-AKY-GES.
       FIN-EDT-KEY-GES.
           EXIT.
       
       EDT-IKY-GES SECTION.
       INI-EDT-IKY-GES.
           IF GES-COD-CRR-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-CRR-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-COD-CRR IN GES-FLD TO GES-COD-CRR-EDT IN GES-EDT.
           MOVE GES-COD-CRR-EDT IN GES-EDT TO 
                GES-COD-CRR-ALF IN GES-FLD.
           IF GES-COD-ESP-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-ESP-LEN IN GES-FLD
                GO TO FIN-EDT-IKY-GES.
           MOVE GES-COD-ESP IN GES-FLD TO GES-COD-ESP-EDT IN GES-EDT.
           MOVE GES-COD-ESP-EDT IN GES-EDT TO 
                GES-COD-ESP-ALF IN GES-FLD.
       FIN-EDT-IKY-GES.
           EXIT.
       
       EDT-MKY-GES SECTION.
       INI-EDT-MKY-GES.
       FIN-EDT-MKY-GES.
           EXIT.
       
       EDT-AKY-GES SECTION.
       INI-EDT-AKY-GES.
       FIN-EDT-AKY-GES.
           EXIT.
       
       EDT-FLD-GES SECTION.
       INI-EDT-FLD-GES.
           IF GES-COD-CRR-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-COD-CRR-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO 
                GES-COD-CRR-CDT-EDT IN GES-EDT.
           MOVE GES-COD-CRR-CDT-EDT IN GES-EDT TO 
                GES-COD-CRR-CDT-ALF IN GES-FLD.
           IF GES-NUM-DOC-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-NUM-DOC-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO 
                GES-NUM-DOC-CDT-EDT IN GES-EDT.
           MOVE GES-NUM-DOC-CDT-EDT IN GES-EDT TO 
                GES-NUM-DOC-CDT-ALF IN GES-FLD.
           IF GES-PCT-LIM-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-PCT-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-PCT-LIM-CDT IN GES-FLD TO 
                GES-PCT-LIM-CDT-EDT IN GES-EDT.
           MOVE GES-PCT-LIM-CDT-EDT IN GES-EDT TO 
                GES-PCT-LIM-CDT-ALF IN GES-FLD.
           IF GES-VAL-LIM-CDT-LEN IN GES-FLD = -9
                MOVE -1 TO GES-VAL-LIM-CDT-LEN IN GES-FLD
                GO TO FIN-EDT-FLD-GES.
           MOVE GES-VAL-LIM-CDT IN GES-FLD TO 
                GES-VAL-LIM-CDT-EDT IN GES-EDT.
           MOVE GES-VAL-LIM-CDT-EDT IN GES-EDT TO 
                GES-VAL-LIM-CDT-ALF IN GES-FLD.
       FIN-EDT-FLD-GES.
           EXIT.
      *<<<< EOF_BU
       VAL-DLC-IGUA SECTION.
       INI-VAL-DLC-IGUA.
      * DLC no debe repetirse
           PERFORM KEY-GES-GES.
           MOVE ZEROES TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
       LUP-VAL-DLC-IGUA.
           IF NOT ( FIO-STAT-OKS AND
              GAR-NUM-SIS IN GES = GES-NUM-SIS IN GES-FLD AND
              GAR-COD-CRR IN GES = GES-COD-CRR IN GES-FLD )
               GO TO BRW-VAL-DLC-IGUA.

           IF GAR-COD-ESP IN GES = GES-COD-ESP IN GES-FLD
               GO TO NXT-VAL-DLC-IGUA.

           IF GAR-NUM-SIS-CDT IN GES = GES-NUM-SIS-CDT IN GES-FLD AND
              GAR-COD-CRR-CDT IN GES = GES-COD-CRR-CDT IN GES-FLD AND
              GAR-NUM-DOC-CDT IN GES = GES-NUM-DOC-CDT IN GES-FLD
               MOVE 'DLCREPETIDO' TO MSG-COD-MENS
               GO TO BRW-VAL-DLC-IGUA.
       NXT-VAL-DLC-IGUA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           GO TO LUP-VAL-DLC-IGUA.
       BRW-VAL-DLC-IGUA.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES.
       FIN-VAL-DLC-IGUA.
           EXIT.

      *>>>>
      *<<<< EOF_BU AND PGM_CHI

       VAL-RDC-GDD SECTION.
       INI-VAL-RDC-GDD.
           MOVE 'GESDLCNORDC' TO MSG-COD-MENS.

           MOVE DLC-KEY-IDLC IN DLC TO RDC-KEY-IDLC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF NOT (
              FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                  )
      * DLC NO TIENE RDC DIRECTO

               GO TO BRW-VAL-RDC-GDD.
       LUP-VAL-RDC-GDD.
           MOVE RDC-CIC-ICLI IN RDC    TO GDD-CIC-ICLI  IN GDD.
           MOVE GES-NUM-SIS IN GES-FLD TO GAR-NUM-SIS   IN GDD.
           MOVE GES-COD-CRR IN GES-FLD TO GAR-COD-CRR   IN GDD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GDD.
           IF FIO-STAT-OKS
               MOVE SPACES TO MSG-COD-MENS
               GO TO BRW-VAL-RDC-GDD.
       NXT-VAL-RDC-GDD.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM COL-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               GO TO LUP-VAL-RDC-GDD.
       BRW-VAL-RDC-GDD.
           IF PGM-STAT-RDC-OKS
               MOVE 'RDC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM COL-FIO-RDC.
       FIN-VAL-RDC-GDD.
           EXIT.
      *>>>>
      *<<<< EOF BM
       BUS-COL SECTION.
       INI-BUS-COL.
      * LEE DOCUMENTO LEGAL DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO DLC-CAI-IOPC IN DLC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO DLC-IIC-IOPC IN DLC.
           MOVE GES-NUM-DOC-CDT IN GES-FLD TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           IF DLC-VAL-SDLC IN DLC NOT > ZEROES
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'DLC SDLC=0'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

      * LEE OPERACION DE CREDITO EN COL
           MOVE GES-NUM-SIS-CDT IN GES-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE GES-COD-CRR-CDT IN GES-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'OPC    NEX'   TO MSG-COD-MENS
               GO TO ERR-BUS-COL.

           MOVE DLC-FEC-FMAV   IN DLC TO GAR-FEC-VTO-CDT IN GES.
           MOVE GAR-FA-VTO-CDT IN GES TO GES-FA-VTO-CDT  IN GES-FLD.
           MOVE GAR-FM-VTO-CDT IN GES TO GES-FM-VTO-CDT  IN GES-FLD.
           MOVE GAR-FD-VTO-CDT IN GES TO GES-FD-VTO-CDT  IN GES-FLD.
           MOVE OPC-COD-TOOC   IN OPC TO GES-TIP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-AOOC   IN OPC TO GES-STP-OPE-CDT IN GES-FLD.
           MOVE OPC-COD-VCOC   IN OPC TO GES-VCB-CDT     IN GES-FLD.
           MOVE OPC-COD-CDOC   IN OPC TO GES-COD-DST-CDT IN GES-FLD.
           GO TO FIN-BUS-COL.
       ERR-BUS-COL.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-BUS-COL.
           EXIT.
      *>>>>
