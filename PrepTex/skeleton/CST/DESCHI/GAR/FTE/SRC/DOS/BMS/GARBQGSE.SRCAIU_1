      * 19-Oct-93 12:53 PM
       PUT-ALL-GSE SECTION.
       INI-PUT-ALL-GSE.
           PERFORM PUT-GSE-GSE.
           PERFORM PUT-GDG-GSE.
       FIN-PUT-ALL-GSE.
           EXIT.
       
       PUT-GSE-GSE SECTION.
       INI-PUT-GSE-GSE.
           IF PGM-STAT-GSE-NUL
               GO TO FIN-PUT-GSE-GSE.
           IF NOT PGM-STAT-GSE-OKS
               PERFORM CLR-GSE-GSE
               GO TO FIN-PUT-GSE-GSE.
           MOVE GAR-NUM-SIS IN GSE TO GSE-NUM-SIS IN GSE-FLD.
           MOVE GAR-COD-CRR IN GSE TO GSE-COD-CRR IN GSE-FLD.
           MOVE GAR-COD-RPB-SEG IN GSE TO GSE-COD-RPB-SEG IN GSE-FLD.
           MOVE GAR-COD-PLZ IN GSE TO GSE-COD-PLZ IN GSE-FLD.
           MOVE GAR-IIV-CIA-SEG IN GSE TO GSE-IIV-CIA-SEG IN GSE-FLD.
           MOVE GAR-IIV-CRD-SEG IN GSE TO GSE-IIV-CRD-SEG IN GSE-FLD.
           MOVE GAR-FD-VTO-SEG IN GSE TO GSE-FD-VTO-SEG IN GSE-FLD.
           MOVE GAR-FM-VTO-SEG IN GSE TO GSE-FM-VTO-SEG IN GSE-FLD.
           MOVE GAR-FA-VTO-SEG IN GSE TO GSE-FA-VTO-SEG IN GSE-FLD.
           MOVE GAR-FD-VIG-SEG IN GSE TO GSE-FD-VIG-SEG IN GSE-FLD.
           MOVE GAR-FM-VIG-SEG IN GSE TO GSE-FM-VIG-SEG IN GSE-FLD.
           MOVE GAR-FA-VIG-SEG IN GSE TO GSE-FA-VIG-SEG IN GSE-FLD.
           MOVE GAR-VCB-SEG IN GSE TO GSE-VCB-SEG IN GSE-FLD.
           MOVE GAR-VAL-SEG IN GSE TO GSE-VAL-SEG IN GSE-FLD.
           MOVE GAR-COD-COB-1 IN GSE TO GSE-COD-COB-1 IN GSE-FLD.
           MOVE GAR-IND-EDS-SEG IN GSE TO GSE-IND-EDS-SEG IN GSE-FLD.
           MOVE GAR-COD-COB-2 IN GSE TO GSE-COD-COB-2 IN GSE-FLD.
           MOVE GAR-IND-PAG-CUO IN GSE TO GSE-IND-PAG-CUO IN GSE-FLD.
           MOVE GAR-COD-COB-3 IN GSE TO GSE-COD-COB-3 IN GSE-FLD.
           MOVE GAR-COD-COB-4 IN GSE TO GSE-COD-COB-4 IN GSE-FLD.
           MOVE GAR-COD-COB-5 IN GSE TO GSE-COD-COB-5 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-RPB-SEG IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'RPB ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-RPB-SEG IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-RPB-SEG IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-RPB-SEG IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-IIV-CIA-SEG IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'CSE ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-IIV-CIA-SEG IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-CIA-SEG IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-CIA-SEG IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-IIV-CRD-SEG IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'SEG ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-IIV-CRD-SEG IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-CRD-SEG IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-IIV-CRD-SEG IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-VCB-SEG IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-VCB-SEG IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB-SEG IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB-SEG IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-COB-1 IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-1 IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB-1 IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COB-1 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-COB-2 IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-2 IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB-2 IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COB-2 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-COB-3 IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-3 IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB-3 IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COB-3 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-COB-4 IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-4 IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB-4 IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COB-4 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GSE-COD-COB-5 IN GSE-FLD > SPACES
               MOVE 'GAR' TO TAB-COD-SIST
               MOVE 'CBS ' TO TAB-COD-TTAB IN TAB
               MOVE GSE-COD-COB-5 IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COB-5 IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-COB-5 IN GSE-FLD.
       FIN-PUT-GSE-GSE.
           EXIT.
       
       PUT-GDG-GSE SECTION.
       INI-PUT-GDG-GSE.
           IF PGM-STAT-GDG-NUL
               GO TO FIN-PUT-GDG-GSE.
           IF NOT PGM-STAT-GDG-OKS
               PERFORM CLR-GDG-GSE
               GO TO FIN-PUT-GDG-GSE.
           MOVE GAR-TIP-OPE IN GDG TO GDG-TIP-OPE IN GSE-FLD.
           MOVE GAR-STP-OPE IN GDG TO GDG-STP-OPE IN GSE-FLD.
           MOVE GAR-COD-OFI IN GDG TO GDG-COD-OFI IN GSE-FLD.
           MOVE GAR-VCB IN GDG TO GDG-VCB IN GSE-FLD.
           MOVE GAR-DES-1 IN GDG TO GDG-DES-1 IN GSE-FLD.
           MOVE GAR-DES-2 IN GDG TO GDG-DES-2 IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-TIP-OPE IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-TIP-OPE IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIP-OPE IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIP-OPE IN GSE-FLD.
      *BUS-OFI busca oficina en tablas
           IF GDG-COD-OFI IN GSE-FLD > SPACES
               MOVE GDG-COD-OFI IN GSE-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFI IN GSE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF GDG-VCB IN GSE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE GDG-VCB IN GSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GSE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCB IN GSE-FLD.
      *<<<< FIN_PUT_GDG_GSE

           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GVT.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GVT.
           MOVE GAR-COD-TSN IN GDG TO GAR-COD-TSN IN GVT.
           MOVE 'GAR-CLV-GVT-1'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-GVT.
           MOVE FIO-STAT TO PGM-STAT-GVT IN CMA-VARI.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO GAR-VAL-LIQ-TSN IN CMA-VARI
               GO TO EXA-VEN-SEG.

           MOVE GAR-VAL-LIQ-TSN IN GVT TO GAR-VAL-LIQ-TSN IN CMA-VARI.

      * Se determina si la tasacion esta vencida o no


           MOVE WSS-NO-EXA-VENC TO WSS-IND-EXAV.
      * Excluye los Subtipos de Garantia que no requieren Tasacion Efectiva
           IF GAR-PDO-VIG-TSN IN TAG NOT > ZEROES
               GO TO EXA-VEN-SEG.

      * Excluye los Creditos Hipotecarios
           MOVE GAR-NUM-SIS IN GDG TO GAR-NUM-SIS IN GES.
           MOVE GAR-COD-CRR IN GDG TO GAR-COD-CRR IN GES.
           MOVE ZEROES             TO GAR-COD-ESP IN GES.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-GES.
           IF NOT FIO-STAT-OKS OR
              GAR-NUM-SIS IN GDG NOT = GAR-NUM-SIS IN GES OR
              GAR-COD-CRR IN GDG NOT = GAR-COD-CRR IN GES
               MOVE SPACES TO GES
               MOVE ZEROES TO GAR-COD-CRR IN GES
                              GAR-FEC-VTO-CDT IN GES
                              GAR-COD-ESP IN GES
           ELSE 
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM GAR-FIO-GES
               IF GAR-COD-SIS-CDT IN GES > SPACES
                   MOVE 'TAB'                  TO TAB-COD-SIST
                   MOVE 'SIS'                  TO TAB-COD-TTAB IN TAB
                   MOVE GAR-COD-SIS-CDT IN GES TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS = SPACES AND TAB-CIC-CTAB = 'HIP'
                       GO TO EXA-VEN-SEG.

           MOVE WSS-SI-EXA-VENC TO WSS-IND-EXAV.
           PERFORM GET-FHOY.
           IF GAR-UTP-VIG-TSN IN TAG = 'D'
              MOVE FEC-SUM-DIA TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NDIA
           ELSE
           IF GAR-UTP-VIG-TSN IN TAG = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NMES
           ELSE
           IF GAR-UTP-VIG-TSN IN TAG = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE GAR-PDO-VIG-TSN IN TAG TO FEC-NANO.

           MOVE GAR-FEC-TSN IN GVT TO FEC-FVLD.
           MOVE FEC-DVLD TO FEC-ITM1.
           MOVE FEC-MVLD TO FEC-ITM2.
           MOVE FEC-AVLD TO FEC-ITM4.
           MOVE FEC-SVLD TO FEC-ITM3.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF MSG-COD-MENS = SPACES
               MOVE FEC-ITM1 TO WSS-FEC-DVTA IN WSS-VARI
               MOVE FEC-ITM2 TO WSS-FEC-MVTA IN WSS-VARI
               MOVE FEC-ITM4 TO WSS-FEC-AVTA IN WSS-VARI
               MOVE FEC-ITM3 TO WSS-FEC-SVTA IN WSS-VARI
           ELSE
               GO TO EXA-VEN-SEG.

      * Tasacion Vencida
           IF WSS-FEC-FVTA IN WSS-VARI > HOY-FHOY
               GO TO EXA-VEN-SEG.

           MOVE 'TASACION VENCIDA' TO FRM-MEN1.

       EXA-VEN-SEG.


      * Se determina si el seguro esta vencido o no


      * Excluye los Creditos Hipotecarios
           IF WSS-IND-EXAV = WSS-NO-EXA-VENC 
               GO TO FIN-EXA-VEN-SEG.

      * Seguro Vigente
           IF SCR-CCPP = 'ING'
               GO TO FIN-EXA-VEN-SEG.
           IF GAR-FEC-VTO-SEG IN GSE > HOY-FHOY
               GO TO FIN-EXA-VEN-SEG.

           MOVE 'SEGURO VENCIDO' TO FRM-MEN2.

       FIN-EXA-VEN-SEG.

      *>>>>
       FIN-PUT-GDG-GSE.
           EXIT.
       
       KEY-ALL-GSE SECTION.
       INI-KEY-ALL-GSE.
           PERFORM KEY-GSE-GSE.
           PERFORM KEY-GDG-GSE.
       FIN-KEY-ALL-GSE.
           EXIT.
       
       KEY-GSE-GSE SECTION.
       INI-KEY-GSE-GSE.
           MOVE GSE-NUM-SIS IN GSE-FLD TO GAR-NUM-SIS IN GSE.
           MOVE GSE-COD-CRR IN GSE-FLD TO GAR-COD-CRR IN GSE.
       FIN-KEY-GSE-GSE.
           EXIT.
       
       KEY-GDG-GSE SECTION.
       INI-KEY-GDG-GSE.
       FIN-KEY-GDG-GSE.
           EXIT.
       
       SCR-CLRA-GSE SECTION.
       INI-SCR-CLRA-GSE.
           PERFORM CLR-KEY-GSE.
           PERFORM CLR-FLD-GSE.
       FIN-SCR-CLRA-GSE.
           EXIT.
       
       CLR-KEY-GSE SECTION.
       INI-CLR-KEY-GSE.
           MOVE SPACES TO GSE-NUM-SIS IN GSE-FLD.
           MOVE ZEROES TO GSE-COD-CRR IN GSE-FLD.
       FIN-CLR-KEY-GSE.
           EXIT.
       
       CLR-FLD-GSE SECTION.
       INI-CLR-FLD-GSE.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-RPB-SEG IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-IIV-CIA-SEG IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-IIV-CRD-SEG IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-VCB-SEG IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB-1 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB-2 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB-3 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB-4 IN GSE-FLD.
           MOVE SPACES TO FRM-GLS-COB-5 IN GSE-FLD.
           PERFORM CLR-GSE-GSE.
           PERFORM CLR-GDG-GSE.
       FIN-CLR-FLD-GSE.
           EXIT.
       
       CLR-GSE-GSE SECTION.
       INI-CLR-GSE-GSE.
           MOVE SPACES TO GSE-COD-RPB-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-COD-PLZ IN GSE-FLD.
           MOVE SPACES TO GSE-IIV-CIA-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-IIV-CRD-SEG IN GSE-FLD.
           MOVE ZEROES TO GSE-FEC-VTO-SEG IN GSE-FLD.
           MOVE ZEROES TO GSE-FEC-VIG-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-VCB-SEG IN GSE-FLD.
           MOVE ZEROES TO GSE-VAL-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB-1 IN GSE-FLD.
           MOVE SPACES TO GSE-IND-EDS-SEG IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB-2 IN GSE-FLD.
           MOVE SPACES TO GSE-IND-PAG-CUO IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB-3 IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB-4 IN GSE-FLD.
           MOVE SPACES TO GSE-COD-COB-5 IN GSE-FLD.
       FIN-CLR-GSE-GSE.
           EXIT.
       
       CLR-GDG-GSE SECTION.
       INI-CLR-GDG-GSE.
           MOVE SPACES TO GDG-TIP-OPE IN GSE-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GSE-FLD.
           MOVE SPACES TO GDG-COD-OFI IN GSE-FLD.
           MOVE SPACES TO GDG-VCB IN GSE-FLD.
           MOVE SPACES TO GDG-DES-1 IN GSE-FLD.
           MOVE SPACES TO GDG-DES-2 IN GSE-FLD.
       FIN-CLR-GDG-GSE.
           EXIT.
       
       FST-KEY-GSE SECTION.
       INI-FST-KEY-GSE.
           MOVE -1 TO GSE-NUM-SIS-LEN IN GSE-FLD.
       FIN-FST-KEY-GSE.
           EXIT.
       
       FST-FLD-GSE SECTION.
       INI-FST-FLD-GSE.
           MOVE -1 TO GSE-COD-RPB-SEG-LEN IN GSE-FLD.
       FIN-FST-FLD-GSE.
           EXIT.
       
       PRO-KEY-GSE SECTION.
       INI-PRO-KEY-GSE.
           PERFORM PRO-IKY-GSE.
           PERFORM PRO-AKY-GSE.
           PERFORM PRO-MKY-GSE.
       FIN-PRO-KEY-GSE.
           EXIT.
       
       PRO-IKY-GSE SECTION.
       INI-PRO-IKY-GSE.
           MOVE FRM-CPIM-AEY TO GSE-NUM-SIS-ATR IN GSE-FLD.
           MOVE FRM-CPIM-AEY TO GSE-COD-CRR-ATR IN GSE-FLD.
       FIN-PRO-IKY-GSE.
           EXIT.
       
       PRO-MKY-GSE SECTION.
       INI-PRO-MKY-GSE.
       FIN-PRO-MKY-GSE.
           EXIT.
       
       PRO-AKY-GSE SECTION.
       INI-PRO-AKY-GSE.
       FIN-PRO-AKY-GSE.
           EXIT.
       
       UNP-KEY-GSE SECTION.
       INI-UNP-KEY-GSE.
           PERFORM UNP-IKY-GSE.
           PERFORM UNP-AKY-GSE.
           PERFORM UNP-MKY-GSE.
       FIN-UNP-KEY-GSE.
           EXIT.
       
       UNP-IKY-GSE SECTION.
       INI-UNP-IKY-GSE.
           MOVE FRM-CPIM-UBY TO GSE-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GSE-COD-CRR-ATR.
       FIN-UNP-IKY-GSE.
           EXIT.
       
       UNP-MKY-GSE SECTION.
       INI-UNP-MKY-GSE.
       FIN-UNP-MKY-GSE.
           EXIT.
       
       UNP-AKY-GSE SECTION.
       INI-UNP-AKY-GSE.
       FIN-UNP-AKY-GSE.
           EXIT.
       
       UNP-FLD-GSE SECTION.
       INI-UNP-FLD-GSE.
           PERFORM UNP-GSE-GSE.
           PERFORM UNP-GDG-GSE.
       FIN-UNP-FLD-GSE.
           EXIT.
       
       UNP-GSE-GSE SECTION.
       INI-UNP-GSE-GSE.
           MOVE FRM-CPIM-UBY TO GSE-COD-RPB-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-PLZ-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IIV-CIA-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IIV-CRD-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-FEC-VTO-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-FEC-VIG-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-VCB-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-VAL-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB-1-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IND-EDS-SEG-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB-2-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-IND-PAG-CUO-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB-3-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB-4-ATR IN GSE-FLD.
           MOVE FRM-CPIM-UBY TO GSE-COD-COB-5-ATR IN GSE-FLD.
       FIN-UNP-GSE-GSE.
           EXIT.
       
       UNP-GDG-GSE SECTION.
       INI-UNP-GDG-GSE.
       FIN-UNP-GDG-GSE.
           EXIT.
       
       VAL-KEY-GSE SECTION.
       INI-VAL-KEY-GSE.
           PERFORM VAL-IKY-GSE.
           PERFORM VAL-MKY-GSE.
           PERFORM VAL-AKY-GSE.
       FIN-VAL-KEY-GSE.
           EXIT.
       
       VAL-IKY-GSE SECTION.
       INI-VAL-IKY-GSE.
           PERFORM VAL-GSE-NUM-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GSE-NUM-SIS-LEN IN GSE-FLD
                GO TO FIN-VAL-IKY-GSE.
           PERFORM VAL-GSE-COD-CRR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GSE-COD-CRR-LEN IN GSE-FLD
                GO TO FIN-VAL-IKY-GSE.
       FIN-VAL-IKY-GSE.
           EXIT.
       
       VAL-MKY-GSE SECTION.
       INI-VAL-MKY-GSE.
       FIN-VAL-MKY-GSE.
           EXIT.
       
       VAL-AKY-GSE SECTION.
       INI-VAL-AKY-GSE.
       FIN-VAL-AKY-GSE.
           EXIT.
       
       VAL-GSE-NUM-SIS SECTION.
       INI-VAL-GSE-NUM-SIS.
           IF GSE-NUM-SIS IN GSE-FLD NOT > SPACES
              MOVE SPACES TO GSE-NUM-SIS IN GSE-FLD.
       FIN-VAL-GSE-NUM-SIS.
           EXIT.
       
       VAL-GSE-COD-CRR SECTION.
       INI-VAL-GSE-COD-CRR.
           IF GSE-COD-CRR IN GSE-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GSE-COD-CRR.
       FIN-VAL-GSE-COD-CRR.
           EXIT.
       
       VAL-CON-KEY-GSE SECTION.
       INI-VAL-CON-KEY-GSE.
           IF     GSE-NUM-SIS IN GSE-FLD NOT > SPACES 
              AND GSE-COD-CRR IN GSE-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSE.
       FIN-VAL-CON-KEY-GSE.
           EXIT.
       
       VAL-CON-IKY-GSE SECTION.
       INI-VAL-CON-IKY-GSE.
           IF     GSE-NUM-SIS IN GSE-FLD NOT > SPACES 
              AND GSE-COD-CRR IN GSE-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-GSE.
       FIN-VAL-CON-IKY-GSE.
           EXIT.
       
       VAL-NUM-KEY-GSE SECTION.
       INI-VAL-NUM-KEY-GSE.
           PERFORM VAL-NUM-IKY-GSE.
           PERFORM VAL-NUM-MKY-GSE.
           PERFORM VAL-NUM-AKY-GSE.
       FIN-VAL-NUM-KEY-GSE.
           EXIT.
       
       VAL-NUM-IKY-GSE SECTION.
       INI-VAL-NUM-IKY-GSE.
       VAL-NUM-GSE-COD-CRR.
           MOVE GSE-COD-CRR-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GSE-COD-CRR IN GSE-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GSE-COD-CRR-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-IKY-GSE.
       FIN-VAL-NUM-IKY-GSE.
           EXIT.
       
       VAL-NUM-MKY-GSE SECTION.
       INI-VAL-NUM-MKY-GSE.
       FIN-VAL-NUM-MKY-GSE.
           EXIT.
       
       VAL-NUM-AKY-GSE SECTION.
       INI-VAL-NUM-AKY-GSE.
       FIN-VAL-NUM-AKY-GSE.
           EXIT.
       
       VAL-NUM-FLD-GSE SECTION.
       INI-VAL-NUM-FLD-GSE.
       VAL-NUM-GSE-VAL-SEG.
           MOVE GSE-VAL-SEG-ALF IN GSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9V TO GSE-VAL-SEG IN GSE-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GSE-VAL-SEG-LEN IN GSE-FLD
                GO TO FIN-VAL-NUM-FLD-GSE.
       FIN-VAL-NUM-FLD-GSE.
           EXIT.
       
       EDT-KEY-GSE SECTION.
       INI-EDT-KEY-GSE.
           PERFORM EDT-IKY-GSE.
           PERFORM EDT-MKY-GSE.
           PERFORM EDT-AKY-GSE.
       FIN-EDT-KEY-GSE.
           EXIT.
       
       EDT-IKY-GSE SECTION.
       INI-EDT-IKY-GSE.
           IF GSE-COD-CRR-LEN IN GSE-FLD = -9
                MOVE -1 TO GSE-COD-CRR-LEN IN GSE-FLD
                GO TO FIN-EDT-IKY-GSE.
           MOVE GSE-COD-CRR IN GSE-FLD TO GSE-COD-CRR-EDT IN GSE-EDT.
           MOVE GSE-COD-CRR-EDT IN GSE-EDT TO 
                GSE-COD-CRR-ALF IN GSE-FLD.
       FIN-EDT-IKY-GSE.
           EXIT.
       
       EDT-MKY-GSE SECTION.
       INI-EDT-MKY-GSE.
       FIN-EDT-MKY-GSE.
           EXIT.
       
       EDT-AKY-GSE SECTION.
       INI-EDT-AKY-GSE.
       FIN-EDT-AKY-GSE.
           EXIT.
       
       EDT-FLD-GSE SECTION.
       INI-EDT-FLD-GSE.
           IF GSE-VAL-SEG-LEN IN GSE-FLD = -9
                MOVE -1 TO GSE-VAL-SEG-LEN IN GSE-FLD
                GO TO FIN-EDT-FLD-GSE.
           MOVE GSE-VAL-SEG IN GSE-FLD TO GSE-VAL-SEG-EDT IN GSE-EDT.
           MOVE GSE-VAL-SEG-EDT IN GSE-EDT TO 
                GSE-VAL-SEG-ALF IN GSE-FLD.
       FIN-EDT-FLD-GSE.
           EXIT.
