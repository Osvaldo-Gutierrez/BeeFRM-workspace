      * 17-Jan-96 12:42 PM
       RET-ALL-GDG SECTION.
       INI-RET-ALL-GDG.
           PERFORM KEY-ALL-GDG.
           PERFORM RET-GDG-GDG.
           PERFORM RET-DBC-GDG.
       FIN-RET-ALL-GDG.
           EXIT.
       
       RET-GDG-GDG SECTION.
       INI-RET-GDG-GDG.
           MOVE GDG-COD-OFI IN GDG-FLD TO GAR-COD-OFI IN GDG.
           MOVE GDG-VCB IN GDG-FLD TO GAR-VCB IN GDG.
           MOVE GDG-DES-1 IN GDG-FLD TO GAR-DES-1 IN GDG.
           MOVE GDG-DES-2 IN GDG-FLD TO GAR-DES-2 IN GDG.
           MOVE GDG-COD-LIM IN GDG-FLD TO GAR-COD-LIM IN GDG.
           MOVE GDG-COD-EJE-ORI IN GDG-FLD TO GAR-COD-EJE-ORI IN GDG.
           MOVE GDG-COD-GRA IN GDG-FLD TO GAR-COD-GRA IN GDG.
           MOVE GDG-ES1 IN GDG-FLD TO GAR-ES1 IN GDG.
           MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO GAR-IIV-AUT-ES1 IN GDG.
           MOVE GDG-ES2 IN GDG-FLD TO GAR-ES2 IN GDG.
           MOVE GDG-FD-ALZ IN GDG-FLD TO GAR-FD-ALZ IN GDG.
           MOVE GDG-FM-ALZ IN GDG-FLD TO GAR-FM-ALZ IN GDG.
           MOVE GDG-FA-ALZ IN GDG-FLD TO GAR-FA-ALZ IN GDG.
           MOVE GDG-FD-VTO IN GDG-FLD TO GAR-FD-VTO IN GDG.
           MOVE GDG-FM-VTO IN GDG-FLD TO GAR-FM-VTO IN GDG.
           MOVE GDG-FA-VTO IN GDG-FLD TO GAR-FA-VTO IN GDG.
           MOVE GDG-CAI-ICLI IN GDG-FLD TO GDG-CAI-ICLI IN GDG.
           MOVE GDG-IIC-ICLI IN GDG-FLD TO GDG-IIC-ICLI IN GDG.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO GAR-FD-SOL-CNS IN GDG.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO GAR-FM-SOL-CNS IN GDG.
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO GAR-FA-SOL-CNS IN GDG.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO GAR-FD-ESC-CNS IN GDG.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO GAR-FM-ESC-CNS IN GDG.
           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO GAR-FA-ESC-CNS IN GDG.
           MOVE GDG-IND-OBL-INS IN GDG-FLD TO GAR-IND-OBL-INS IN GDG.
           MOVE GDG-FD-ING-SIS IN GDG-FLD TO GDG-FD-ING-SIS IN GDG.
           MOVE GDG-FM-ING-SIS IN GDG-FLD TO GDG-FM-ING-SIS IN GDG.
           MOVE GDG-FA-ING-SIS IN GDG-FLD TO GDG-FA-ING-SIS IN GDG.
           MOVE GDG-COD-TSN IN GDG-FLD TO GAR-COD-TSN IN GDG.
           MOVE GDG-IND-CPL IN GDG-FLD TO GAR-IND-CPL IN GDG.
      *<<<< FIN_RET_GDG_GDG
           MOVE GDG-VCB IN GDG-FLD TO WSS-VCB.
           IF WSS-TIP-VCB = '1'
               MOVE GDG-VCB IN GDG-FLD TO GAR-VCB-CON IN GDG
           ELSE
      *    Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de Moneda '0999'
               MOVE 'TAB'          TO FIO-SIST
               MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB
               MOVE '0999  '       TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CIC0999  NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   MOVE SPACES              TO GAR-VCB-CON IN GDG
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO GAR-VCB-CON IN GDG.

           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               MOVE WSS-EST-ANT IN CMA-VARI TO GAR-EST-ANT IN GDG.

           IF FRM-NUM-ICLI IN GDG-FLD NOT > ZEROES
               MOVE SPACES TO GDG-CAI-ICLI IN GDG
               MOVE ZEROES TO GDG-IIC-ICLI IN GDG.
      *>>>>
       FIN-RET-GDG-GDG.
           EXIT.
       
       RET-DBC-GDG SECTION.
       INI-RET-DBC-GDG.
       FIN-RET-DBC-GDG.
           EXIT.
       
       KEY-ALL-GDG SECTION.
       INI-KEY-ALL-GDG.
           PERFORM KEY-GDG-GDG.
           PERFORM KEY-DBC-GDG.
       FIN-KEY-ALL-GDG.
           EXIT.
       
       KEY-GDG-GDG SECTION.
       INI-KEY-GDG-GDG.
           MOVE GDG-NUM-SIS IN GDG-FLD TO GAR-NUM-SIS IN GDG.
           MOVE GDG-COD-CRR IN GDG-FLD TO GAR-COD-CRR IN GDG.
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN GDG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN GDG.
       FIN-KEY-GDG-GDG.
           EXIT.
       
       KEY-DBC-GDG SECTION.
       INI-KEY-DBC-GDG.
           MOVE DBC-CAI-ICLI IN GDG-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN GDG-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN GDG-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC.
       FIN-KEY-DBC-GDG.
           EXIT.
       
       SCR-CLRA-GDG SECTION.
       INI-SCR-CLRA-GDG.
           PERFORM CLR-KEY-GDG.
           PERFORM CLR-FLD-GDG.
       FIN-SCR-CLRA-GDG.
           EXIT.
       
       CLR-KEY-GDG SECTION.
       INI-CLR-KEY-GDG.
           MOVE SPACES TO GDG-NUM-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-CRR IN GDG-FLD.
           MOVE SPACES TO DBC-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO DBC-IIC-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN GDG-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
           MOVE SPACES TO GDG-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO GDG-STP-OPE IN GDG-FLD.
      *<<<< FIN_CLR_KEY_GDG
           MOVE 'GAR' TO FIO-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE '001' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR
              TAB-IND-VIGE IN TAB NOT = 'S'
      *        FLB: version 'B'anco
               MOVE 'B' TO SCR-IND-V001
               MOVE SPACES TO MSG-COD-MENS
               MOVE FRM-CPIM-AEY TO GDG-NUM-SIS-ATR IN GDG-FLD
               MOVE '0500' TO GDG-NUM-SIS IN GDG-FLD
               MOVE 0  TO GDG-NUM-SIS-LEN IN GDG-FLD
               MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
           ELSE
      *        FLB: version 'C'onsist
               MOVE 'C' TO SCR-IND-V001.
      *>>>>
       FIN-CLR-KEY-GDG.
           EXIT.
       
       CLR-FLD-GDG SECTION.
       INI-CLR-FLD-GDG.
           MOVE SPACES TO FRM-GLS-TIP-REA-NRE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-TIP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-STP-OPE IN GDG-FLD.
           MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
           MOVE ZEROES TO FRM-IIC-IOPD IN GDG-FLD.
           MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD.
           MOVE ZEROES TO FRM-NUM-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN GDG-FLD.
           PERFORM CLR-GDG-GDG.
           PERFORM CLR-DBC-GDG.
       FIN-CLR-FLD-GDG.
           EXIT.
       
       CLR-GDG-GDG SECTION.
       INI-CLR-GDG-GDG.
           MOVE SPACES TO GDG-COD-OFI IN GDG-FLD.
           MOVE SPACES TO GDG-VCB IN GDG-FLD.
           MOVE SPACES TO GDG-DES-1 IN GDG-FLD.
           MOVE SPACES TO GDG-DES-2 IN GDG-FLD.
           MOVE SPACES TO GDG-COD-LIM IN GDG-FLD.
           MOVE SPACES TO GDG-COD-EJE-ORI IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-GRA IN GDG-FLD.
           MOVE SPACES TO GDG-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD.
           MOVE SPACES TO GDG-ES2 IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ALZ IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-VTO IN GDG-FLD.
           MOVE SPACES TO GDG-CAI-ICLI IN GDG-FLD.
           MOVE ZEROES TO GDG-IIC-ICLI IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-SOL-CNS IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ESC-CNS IN GDG-FLD.
           MOVE SPACES TO GDG-IND-OBL-INS IN GDG-FLD.
           MOVE ZEROES TO GDG-FEC-ING-SIS IN GDG-FLD.
           MOVE ZEROES TO GDG-COD-TSN IN GDG-FLD.
           MOVE SPACES TO GDG-IND-CPL IN GDG-FLD.
       FIN-CLR-GDG-GDG.
           EXIT.
       
       CLR-DBC-GDG SECTION.
       INI-CLR-DBC-GDG.
       FIN-CLR-DBC-GDG.
           EXIT.
       
       FST-KEY-GDG SECTION.
       INI-FST-KEY-GDG.
           MOVE -1 TO GDG-NUM-SIS-LEN IN GDG-FLD.
       FIN-FST-KEY-GDG.
           EXIT.
       
       FST-FLD-GDG SECTION.
       INI-FST-FLD-GDG.
           MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      *<<<< FIN_FST_FLD_GDG
      *<<<< PGM_BMS AND NOT PGM_ARG
           MOVE 0 TO DBC-NUM-ICLI-LEN IN GDG-FLD.
      *>>>>
      *ALD-BNL Y FLB
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.             
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.         
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
      *ALD-BNL-FIN.
      *<<<< PGM_CHI
           IF NOT (
                   CMA-IND-DAP IN CMA-VARI = 'S' AND
                   SCR-CCPP = 'ING'
              )
      *       No Es o No Ingresa Dep Plazo Propio 
               MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-DEUD-ATR IN GDG-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
      *>>>>

           IF SCR-CCPP = 'ING'
               MOVE SPACES TO WSS-EST-ANT IN CMA-VARI
      *         PERFORM ANL-HBL-COD-GRA
               PERFORM ANL-HBL-FEC-VTO
               MOVE -1           TO DBC-NUM-ICLI-LEN    IN GDG-FLD
               GO TO FIN-FST-FLD-GDG.

           IF SCR-CCPP = 'MOD'
               PERFORM ANL-HBL-DBC-ICLI
               PERFORM ANL-HBL-FEC-VTO
               IF SCR-CMND = 'MOD'
                   MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                   GO TO FIN-FST-FLD-GDG.

           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR         IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR     IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.

           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.

           IF SCR-CMND = 'ALZ' OR SCR-CMND = 'EJE'
               MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR       IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR     IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR    IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD
               IF SCR-CMND = 'ALZ'
      * FLB
                   MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
      * FIN
                   MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
               ELSE
               IF SCR-CMND = 'EJE'
                   MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD
                   MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
               ELSE
                   NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'MGA'
               MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
           ELSE
           IF SCR-CMND = 'AGA'
               MOVE -1 TO GDG-GLS-MENS-LEN IN GDG-FLD.

           GO TO FIN-FST-FLD-GDG.
       ANL-HBL-DBC-ICLI.
           IF MULTIPLES-GDD

               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN GDG-FLD.
       ANL-HBL-COD-GRA.
      *         IF GAR-COD-GRA IN TAG = 'N'
      *             MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD
      *             IF SCR-CCPP = 'ING'
      *                 MOVE SPACES TO GDG-COD-GRA IN GDG-FLD.
       ANL-HBL-FEC-VTO.
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD
               IF SCR-CCPP = 'ING'
                   MOVE ZEROES TO GDG-FA-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FM-VTO IN GDG-FLD
                   MOVE ZEROES TO GDG-FD-VTO IN GDG-FLD.

       FIN-ANL-HBL-FEC-VTO.
      *>>>>
       FIN-FST-FLD-GDG.
           EXIT.
       
       PRO-KEY-GDG SECTION.
       INI-PRO-KEY-GDG.
           PERFORM PRO-MKY-GDG.
       FIN-PRO-KEY-GDG.
           EXIT.
       
       PRO-MKY-GDG SECTION.
       INI-PRO-MKY-GDG.
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN GDG-FLD.
       FIN-PRO-MKY-GDG.
           EXIT.
       
       PRO-FLD-GDG SECTION.
       INI-PRO-FLD-GDG.
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN GDG-FLD.
           PERFORM PRO-GDG-GDG.
           PERFORM PRO-DBC-GDG.
       FIN-PRO-FLD-GDG.
           EXIT.
       
       PRO-GDG-GDG SECTION.
       INI-PRO-GDG-GDG.
           MOVE FRM-CPIM-AEY TO GDG-COD-OFI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-VCB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-DES-1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-DES-2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-LIM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-COD-GRA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-ES2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-ALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-VTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-AEY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
       FIN-PRO-GDG-GDG.
           EXIT.
       
       PRO-DBC-GDG SECTION.
       INI-PRO-DBC-GDG.
       FIN-PRO-DBC-GDG.
           EXIT.
       
       UNP-KEY-GDG SECTION.
       INI-UNP-KEY-GDG.
           PERFORM UNP-IKY-GDG.
           PERFORM UNP-AKY-GDG.
           PERFORM UNP-MKY-GDG.
       FIN-UNP-KEY-GDG.
           EXIT.
       
       UNP-IKY-GDG SECTION.
       INI-UNP-IKY-GDG.
           MOVE FRM-CPIM-UBY TO GDG-NUM-SIS-ATR.
           MOVE FRM-CPIM-UBY TO GDG-COD-CRR-ATR.
           MOVE FRM-CPIM-UBY TO GDG-TIP-OPE-ATR.
           MOVE FRM-CPIM-UBY TO GDG-STP-OPE-ATR.
       FIN-UNP-IKY-GDG.
           EXIT.
       
       UNP-MKY-GDG SECTION.
       INI-UNP-MKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR.
       FIN-UNP-MKY-GDG.
           EXIT.
       
       UNP-AKY-GDG SECTION.
       INI-UNP-AKY-GDG.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-GDG.
           EXIT.
       
       UNP-FLD-GDG SECTION.
       INI-UNP-FLD-GDG.
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-DEUD-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN GDG-FLD.
           PERFORM UNP-GDG-GDG.
           PERFORM UNP-DBC-GDG.
       FIN-UNP-FLD-GDG.
           EXIT.
       
       UNP-GDG-GDG SECTION.
       INI-UNP-GDG-GDG.
           MOVE FRM-CPIM-UBY TO GDG-COD-OFI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-VCB-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-DES-2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-LIM-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-EJE-ORI-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-COD-GRA-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IIV-AUT-ES1-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-ES2-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ALZ-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-VTO-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-SOL-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-FEC-ESC-CNS-ATR IN GDG-FLD.
           MOVE FRM-CPIM-UBY TO GDG-IND-OBL-INS-ATR IN GDG-FLD.
       FIN-UNP-GDG-GDG.
           EXIT.
       
       UNP-DBC-GDG SECTION.
       INI-UNP-DBC-GDG.
       FIN-UNP-DBC-GDG.
           EXIT.
       
       VAL-MKY-GDG SECTION.
       INI-VAL-MKY-GDG.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-MKY-GDG.
       FIN-VAL-MKY-GDG.
           EXIT.
       
       VAL-FLD-GDG SECTION.
       INI-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TIP-REA-NRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-REA-NRE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-TIP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TIP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-STP-OPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-STP-OPE-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-CAI-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-CAI-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-IIC-IOPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-COD-DEUD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-DEUD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-DEUD-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-OFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-OFI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-OFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-OFI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-VCB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-VCB-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-VCB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCB-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-DES-1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-DES-2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-DES-2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-LIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-LIM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-LIM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-LIM-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-EJE-ORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-EJE-ORI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-GRA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-EJE-ORI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-EJE-ORI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-ES1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ES1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IIV-AUT-ES1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IIV-AUT-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-IIV-AUT-ES1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-IIV-AUT-ES1-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-ES2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-ES2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ES2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ES2-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ALZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ALZ-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-VTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-VTO-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-CAI-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-SOL-CNS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-SOL-CNS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IND-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-VRF-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ESC-CNS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ESC-CNS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-NOMC-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-OBL-INS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IND-OBL-INS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-FEC-ING-SIS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-FEC-ING-SIS-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-COD-TSN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
           PERFORM VAL-GDG-IND-CPL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO GDG-IND-CPL-LEN IN GDG-FLD
                GO TO FIN-VAL-FLD-GDG.
       FIN-VAL-FLD-GDG.
           EXIT.
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES 
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-IND-ICLI IN GDG-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN GDG-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'GDGMDDIRNO'   TO MSG-COD-MENS
               PERFORM GET-MSG
      *FLB CST 21-09-1993
      *<<<< PGM_CHI
               MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
      *>>>>
               MOVE 0  TO DBC-VRF-ICLI-LEN IN GDG-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *FLB CST 21-09-1993
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO 
                        DBC-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN GDG-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN GDG-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       
       VAL-FRM-GLS-TIP-REA-NRE SECTION.
       INI-VAL-FRM-GLS-TIP-REA-NRE.
       FIN-VAL-FRM-GLS-TIP-REA-NRE.
           EXIT.
       
       VAL-FRM-GLS-TIP-OPE SECTION.
       INI-VAL-FRM-GLS-TIP-OPE.
       FIN-VAL-FRM-GLS-TIP-OPE.
           EXIT.
       
       VAL-FRM-GLS-STP-OPE SECTION.
       INI-VAL-FRM-GLS-STP-OPE.
       FIN-VAL-FRM-GLS-STP-OPE.
           EXIT.
       
       VAL-FRM-CAI-IOPD SECTION.
       INI-VAL-FRM-CAI-IOPD.
           IF FRM-CAI-IOPD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-CAI-IOPD IN GDG-FLD.
       FIN-VAL-FRM-CAI-IOPD.
           EXIT.
       
       VAL-FRM-IIC-IOPD SECTION.
       INI-VAL-FRM-IIC-IOPD.
      *<<<< FRM_IIC_IOPD AND PGM_CHI
           IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
      *    OR GDG-FEC-ING-SIS IN GDG NOT > '19950115'
      *FLB CST  20-JAN-1995 FIN
      *FLB CST  17-FEB-1995
           OR SCR-CMND = 'ALZ'
               GO TO FIN-VAL-FRM-IIC-IOPD.

           MOVE FRM-CAI-IOPD IN GDG-FLD TO OPD-CAI-IOPD IN OPD.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO OPD-IIC-IOPD IN OPD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DAP-FIO-OPD.
      *RVM-CST-INI 3-APR-1996
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'GAR'          TO MSG-COD-SIST
      *         MOVE 'OPD    NEX'   TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
           IF NOT FIO-STAT-OKS
               IF SCR-CMND = 'ALZ' AND WSS-ALZ-DAP IN WSS-VARI = 'S'
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE 'GAR'          TO MSG-COD-SIST
                   MOVE 'OPD    NEX'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
      *RVM-CST-FIN 3-APR-1996
           ELSE
           IF OPD-COD-STAT IN OPD NOT = 'G'
      *RVM-CST-INI 3-APR-1996
               IF SCR-CMND = 'ALZ'              AND
                  WSS-ALZ-DAP IN WSS-VARI = 'S' AND
                  OPD-COD-STAT IN OPD = 'L'
                   MOVE 'OPD    YALIQ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
      *RVM-CST-FIN 3-APR-1996
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPD    NOVIG'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
           IF OPD-COD-GPOD IN OPD = 'N'
                MOVE 'GAR'            TO MSG-COD-SIST
                MOVE 'OPDNOPERMITI'   TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE 'N'                 TO GDG-IND-OBL-INS IN GDG-FLD
      *DAD ini  05-JAN-1995
               IF OPD-MSC-TVAL IN OPD = '1'
                   MOVE 'GAR'        TO FIO-SIST
                   MOVE 'VSN'        TO TAB-COD-TTAB IN TAB
                   MOVE 'GDGVCB DAP' TO TAB-COD-CTAB IN TAB
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   IF FIO-STAT-OKS AND
                      TAB-IND-VIGE IN TAB = 'S'
      *            Version 'BCI'
                       MOVE OPD-COD-VCAM IN OPD TO GAR-VCB     IN GDG
                       MOVE '01'                TO GAR-TIP-CMB IN GDG
                       MOVE GAR-VCB      IN GDG TO GDG-VCB  IN GDG-FLD
                   ELSE
      *            Version 'CST'
                       MOVE OPD-COD-VCAM IN OPD TO GDG-VCB IN GDG-FLD
               ELSE
      *DAD fin  05-JAN-1995
                   MOVE OPD-COD-VCAM IN OPD TO GDG-VCB IN GDG-FLD.
      *>>>>
       FIN-VAL-FRM-IIC-IOPD.
           EXIT.
       
       VAL-FRM-COD-DEUD SECTION.
       INI-VAL-FRM-COD-DEUD.
           IF FRM-COD-DEUD IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-DEUD IN GDG-FLD.
      *<<<< FRM_COD_DEUD AND PGM_CHI
      *FLB CST  20-JAN-1995
           IF FRM-COD-DEUD IN GDG-FLD NOT > SPACES
               MOVE 'N' TO FRM-COD-DEUD IN GDG-FLD.
      *    IF CMA-IND-DAP IN CMA-VARI NOT = 'S'
           IF NOT ( SCR-CCPP = 'ING' OR SCR-CMND = 'MOD' ) OR
              CMA-IND-DAP IN CMA-VARI NOT = 'S'
               GO TO FIN-VAL-FRM-COD-DEUD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'DAP' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-DEUD IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-DEUD IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-DEUD IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-DEUD IN GDG-FLD.

           IF FRM-COD-DEUD IN GDG-FLD = 'S'
               PERFORM BUS-RCC
               MOVE RCC-CIC-ICLI IN RCC TO DBC-KEY-IDBC IN CMA-VARI
               PERFORM PUT-DBC-GDG
               GO TO FIN-VAL-FRM-COD-DEUD.
      *>>>>
       FIN-VAL-FRM-COD-DEUD.
           EXIT.
       
       VAL-FRM-GLS-DEUD SECTION.
       INI-VAL-FRM-GLS-DEUD.
       FIN-VAL-FRM-GLS-DEUD.
           EXIT.
       
       VAL-GDG-COD-OFI SECTION.
       INI-VAL-GDG-COD-OFI.
           IF GDG-COD-OFI IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-OFI.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE GDG-COD-OFI IN GDG-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFI IN GDG-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFI IN GDG-FLD.
      *<<<< FIN_GDG_COD_OFI AND PGM_CHI
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFI.

      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'OFIUSP'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-MSC-STAT IN TAB = 'S' )
               GO TO FIN-VAL-OFI-USP-GDG-BU.
           PERFORM VAL-USR-OFI.
           IF USP-COD-OFICINA NOT = GDG-COD-OFI IN GDG-FLD
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'USRNODEOFI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-COD-OFI.

       FIN-VAL-OFI-USP-GDG-BU.
      *FLB CST  10-NOV-1993 VALIDA USR CONTRA OFICINA
      *>>>>
       FIN-VAL-GDG-COD-OFI.
           EXIT.
       
       VAL-FRM-GLS-OFI SECTION.
       INI-VAL-FRM-GLS-OFI.
       FIN-VAL-FRM-GLS-OFI.
           EXIT.
       
       VAL-GDG-VCB SECTION.
       INI-VAL-GDG-VCB.
           IF GDG-VCB IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-VCB.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-VCB IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-VCB IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCB IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCB IN GDG-FLD.
      *<<<< FIN_GDG_VCB
           IF MSG-COD-MENS = 'COD    NEX'
               GO TO FIN-VAL-GDG-VCB.
      * Busca Tabla TAG
           MOVE GDG-TIP-OPE IN GDG-FLD TO GAR-TIP-OPE IN TAG.
           MOVE GDG-STP-OPE IN GDG-FLD TO GAR-STP-OPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-VCB.
      * Busca Codigo Cuenta Contable en Tabla DCC de GAR
           MOVE 'GAR'                  TO TAB-COD-SIST.
           MOVE 'DCC'                  TO TAB-COD-TTAB IN TAB.
           MOVE GAR-CLA-OPE-SUP IN TAG TO WSS-CLA-OPE-SUP.
           MOVE GDG-VCB     IN GDG-FLD TO WSS-VCB.
           MOVE WSS-COD-CTA            TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'DCC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-VCB.
      *>>>>
       FIN-VAL-GDG-VCB.
           EXIT.
       
       VAL-FRM-GLS-VCB SECTION.
       INI-VAL-FRM-GLS-VCB.
       FIN-VAL-FRM-GLS-VCB.
           EXIT.
       
       VAL-GDG-DES-1 SECTION.
       INI-VAL-GDG-DES-1.
           IF GDG-DES-1 IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-DES-1.
       FIN-VAL-GDG-DES-1.
           EXIT.
       
       VAL-GDG-DES-2 SECTION.
       INI-VAL-GDG-DES-2.
           IF GDG-DES-2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-DES-2 IN GDG-FLD.
       FIN-VAL-GDG-DES-2.
           EXIT.
       
       VAL-GDG-COD-LIM SECTION.
       INI-VAL-GDG-COD-LIM.
           IF GDG-COD-LIM IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-COD-LIM.
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'LIM ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-COD-LIM IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-COD-LIM IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LIM IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-LIM IN GDG-FLD.
       FIN-VAL-GDG-COD-LIM.
           EXIT.
       
       VAL-FRM-GLS-LIM SECTION.
       INI-VAL-FRM-GLS-LIM.
       FIN-VAL-FRM-GLS-LIM.
           EXIT.
       
       VAL-GDG-COD-EJE-ORI SECTION.
       INI-VAL-GDG-COD-EJE-ORI.
           IF GDG-COD-EJE-ORI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-COD-EJE-ORI IN GDG-FLD.
      *<<<< GDG_COD_EJE_ORI AND PGM_CHI
           IF GDG-COD-EJE-ORI IN GDG-FLD = SPACES AND
              CMA-IND-DAP IN CMA-VARI = 'S'
               MOVE OPD-COD-EJEC IN OPD TO GDG-COD-EJE-ORI IN GDG-FLD.
      *>>>>
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE GDG-COD-EJE-ORI IN GDG-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              GDG-COD-EJE-ORI IN GDG-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJE-ORI IN GDG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJE-ORI IN GDG-FLD.
       FIN-VAL-GDG-COD-EJE-ORI.
           EXIT.
       
       VAL-GDG-COD-GRA SECTION.
       INI-VAL-GDG-COD-GRA.
      *<<<< GDG_COD_GRA
      *FLB CST 22-SEP-1993
           IF GDG-COD-GRA IN GDG-FLD = ZEROES
               MOVE '1' TO GDG-COD-GRA IN GDG-FLD.
      *FLB CST 22-SEP-1993

           IF GDG-COD-GRA IN GDG-FLD = '1' AND 
              GAR-IND-EXI-GAP IN CMA-VARI = 'S'
               MOVE 'GAR' TO MSG-COD-SIST
               MOVE 'GRAEXIGAP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-COD-GRA.
           EXIT.
       
       VAL-FRM-GLS-EJE-ORI SECTION.
       INI-VAL-FRM-GLS-EJE-ORI.
       FIN-VAL-FRM-GLS-EJE-ORI.
           EXIT.
       
       VAL-GDG-ES1 SECTION.
       INI-VAL-GDG-ES1.
           IF GDG-ES1 IN GDG-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-GDG-ES1.
      *<<<< GDG_ES1
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES1' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES1
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES1 IN GDG-FLD.

           IF SCR-CCPP = 'ING'  OR 
                  GAR-IND-CPL IN CMA-VARI NOT = 'S'

               IF GDG-ES1 IN GDG-FLD > '10'
                   MOVE 'GDGES1NOVIG' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1
               ELSE
                   GO TO FIN-VAL-GDG-ES1.

      * CAMBIOS DE ESTADO
           IF GDG-ES1 IN GDG-FLD NOT = WSS-EST-ANT IN CMA-VARI
               IF NOT (GDG-ES1 IN GDG-FLD = WSS-ES1-1 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-2 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-3 IN CMA-VARI OR
                       GDG-ES1 IN GDG-FLD = WSS-ES1-4 IN CMA-VARI)
                   MOVE 'ES1NVOANT' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

      * ALZAMIENTO
           IF SCR-CMND = 'ALZ' AND GDG-ES1 IN GDG-FLD < '20'
                   MOVE 'GDGALZES1' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-ES1.

           GO TO FIN-VAL-GDG-ES1.

       ERR-VAL-GDG-ES1.
           MOVE 'GAR' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-ES1.
           EXIT.
       
       VAL-FRM-GLS-ES1 SECTION.
       INI-VAL-FRM-GLS-ES1.
       FIN-VAL-FRM-GLS-ES1.
           EXIT.
       
       VAL-GDG-IIV-AUT-ES1 SECTION.
       INI-VAL-GDG-IIV-AUT-ES1.
           IF GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD.
      *<<<< GDG_IIV_AUT_ES1
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE SPACES TO GDG-IIV-AUT-ES1 IN GDG-FLD
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
               GO TO FIN-VAL-GDG-IIV-AUT-ES1.

           IF GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-GDG-IIV-AUT-ES1.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ALZ ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IIV-AUT-ES1 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-IIV-AUT-ES1 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-IIV-AUT-ES1 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-IIV-AUT-ES1 IN GDG-FLD.
       FIN-VAL-GDG-IIV-AUT-ES1.
           EXIT.
       
       VAL-FRM-GLS-IIV-AUT-ES1 SECTION.
       INI-VAL-FRM-GLS-IIV-AUT-ES1.
       FIN-VAL-FRM-GLS-IIV-AUT-ES1.
           EXIT.
       
       VAL-GDG-ES2 SECTION.
       INI-VAL-GDG-ES2.
           IF GDG-ES2 IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-ES2 IN GDG-FLD.
      *<<<< GDG_ES2
           IF (SCR-CCPP = 'ING') OR (SCR-CMND NOT = 'EJE') AND
              (GDG-ES2 IN GDG-FLD NOT > SPACES)
                MOVE SPACES TO GDG-ES2 IN GDG-FLD
                MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
                GO TO FIN-VAL-GDG-ES2.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES2' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
               GO TO FIN-VAL-GDG-ES2
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'ES2 ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-ES2 IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              GDG-ES2 IN GDG-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ES2 IN GDG-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-ES2 IN GDG-FLD.
       FIN-VAL-GDG-ES2.
           EXIT.
       
       VAL-FRM-GLS-ES2 SECTION.
       INI-VAL-FRM-GLS-ES2.
       FIN-VAL-FRM-GLS-ES2.
           EXIT.
       
       VAL-GDG-FEC-ALZ SECTION.
       INI-VAL-GDG-FEC-ALZ.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-ALZ IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ALZ
           IF GDG-ES1 IN GDG-FLD < '20'
               MOVE 0 TO GDG-FA-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FM-ALZ IN GDG-FLD
               MOVE 0 TO GDG-FD-ALZ IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ALZ.

      * ALZAMIENTO
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-ALZ IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-ALZ.
      *<<<< GDG_FEC_ALZ
           
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-GDG-FEC-ALZ.

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ALZ IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ALZ IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ALZ IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ALZ<CNS' TO MSG-COD-MENS
               MOVE 'GAR'     TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-FEC-ALZ.
           EXIT.
       
       VAL-GDG-FEC-VTO SECTION.
       INI-VAL-GDG-FEC-VTO.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-VTO IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_VTO
           MOVE FEC-VHBL-N TO FEC-VHBL.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA.
           IF GAR-IND-VTO IN CMA-VARI = 'S'
               IF FEC-FVLD = '00000000' OR > '20201231' 
                   MOVE 'VTO=0' TO MSG-COD-MENS
                   GO TO ERR-VAL-GDG-FEC-VTO
               ELSE
                   NEXT SENTENCE
           ELSE
           IF GAR-IND-VTO IN CMA-VARI = 'N'
               MOVE 2099 TO GDG-FA-VTO IN GDG-FLD
               MOVE   12 TO GDG-FM-VTO IN GDG-FLD
               MOVE   31 TO GDG-FD-VTO IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-VTO.
           MOVE FEC-CHOY-N TO FEC-CHOY.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-VTO IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-VTO.
      *<<<< GDG_FEC_VTO
           
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-VTO IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-VTO IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-VTO IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-LES
               MOVE 'VTO<=SOL' TO MSG-COD-MENS
               GO TO ERR-VAL-GDG-FEC-VTO.

           GO TO FIN-VAL-GDG-FEC-VTO.
       ERR-VAL-GDG-FEC-VTO.
           MOVE 'GAR'     TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-GDG-FEC-VTO.
           EXIT.
       
       VAL-GDG-CAI-ICLI SECTION.
       INI-VAL-GDG-CAI-ICLI.
       FIN-VAL-GDG-CAI-ICLI.
           EXIT.
       
       VAL-GDG-IIC-ICLI SECTION.
       INI-VAL-GDG-IIC-ICLI.
       FIN-VAL-GDG-IIC-ICLI.
           EXIT.
       
       VAL-GDG-FEC-SOL-CNS SECTION.
       INI-VAL-GDG-FEC-SOL-CNS.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-SOL-CNS IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_SOL_CNS
           MOVE FEC-FBLK-N  TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-SOL-CNS IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-SOL-CNS.
       FIN-VAL-GDG-FEC-SOL-CNS.
           EXIT.
       
       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.
       
       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN GDG-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE FRM-NUM-ICLI IN GDG-FLD TO IDC-NUM-RUTV.
           MOVE FRM-VRF-ICLI IN GDG-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< FRM_VRF_ICLI
           IF FRM-NUM-ICLI IN GDG-FLD NOT = ZEROES
               MOVE FRM-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI IN DBC
               MOVE FRM-IND-ICLI IN GDG-FLD TO DBC-IND-ICLI IN DBC
               MOVE FRM-GLS-ICLI IN GDG-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY     TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-NOMC IN GDG-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-CAI-ICLI IN DBC TO GDG-CAI-ICLI IN GDG-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO GDG-IIC-ICLI IN GDG-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN GDG-FLD.
      *>>>>
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.
       
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
           IF FRM-IND-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-ICLI IN GDG-FLD.
      *VAL-IDC Valida identificador
           MOVE FRM-IND-ICLI IN GDG-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO FRM-IND-ICLI IN GDG-FLD.
       FIN-VAL-FRM-IND-ICLI.
           EXIT.
       
       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
           IF FRM-GLS-ICLI IN GDG-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-ICLI IN GDG-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-ICLI IN GDG-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN GDG-FLD.
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.
       
       VAL-GDG-FEC-ESC-CNS SECTION.
       INI-VAL-GDG-FEC-ESC-CNS.
      *VAL-FEC Validar Fecha
           MOVE GDG-FEC-ESC-CNS IN GDG-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_GDG_FEC_ESC_CNS
           IF GDG-ES1 IN GDG-FLD < '10'
               MOVE 0 TO GDG-FA-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FM-ESC-CNS IN GDG-FLD
               MOVE 0 TO GDG-FD-ESC-CNS IN GDG-FLD
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           IF GDG-ES1 IN GDG-FLD > '19'
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO GDG-FEC-ESC-CNS IN GDG-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.
      *<<<< GDG_FEC_ESC_CNS

           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE GDG-FA-SOL-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-SOL-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-SOL-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC1.
           MOVE FEC-AVLD TO FEC-AEC1.
           MOVE FEC-MVLD TO FEC-MEC1.
           MOVE FEC-DVLD TO FEC-DEC1.

           MOVE GDG-FA-ESC-CNS IN GDG-FLD TO FEC-FANO IN FEC-VARI.
           MOVE GDG-FM-ESC-CNS IN GDG-FLD TO FEC-FMES IN FEC-VARI.
           MOVE GDG-FD-ESC-CNS IN GDG-FLD TO FEC-FDIA IN FEC-VARI.
           MOVE FEC-SVLD TO FEC-SEC2.
           MOVE FEC-AVLD TO FEC-AEC2.
           MOVE FEC-MVLD TO FEC-MEC2.
           MOVE FEC-DVLD TO FEC-DEC2.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'ESC<SOL' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO FEC-SEC1.
           MOVE HOY-AHOY TO FEC-AEC1.
           MOVE HOY-MHOY TO FEC-MEC1.
           MOVE HOY-DHOY TO FEC-DEC1.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-LES
               MOVE 'ESC>HOY' TO MSG-COD-MENS
               PERFORM ERR-VAL-GDG-FEC-VTO
               GO TO FIN-VAL-GDG-FEC-ESC-CNS.

      *>>>>
       FIN-VAL-GDG-FEC-ESC-CNS.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-GDG-IND-OBL-INS SECTION.
       INI-VAL-GDG-IND-OBL-INS.
           IF GDG-IND-OBL-INS IN GDG-FLD NOT > SPACES
              MOVE SPACES TO GDG-IND-OBL-INS IN GDG-FLD.
      *<<<< GDG_IND_OBL_INS
      *FLB CST  19-AUG-1994
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               MOVE 'GAR' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-GDG-IND-OBL-INS.

           IF GAR-IND-EXG-GIN IN TAG = 'N' OR
              GDG-IND-OBL-INS IN GDG-FLD NOT > SPACES
      *FLB CST  19-AUG-1994
               MOVE 'N' TO GDG-IND-OBL-INS IN GDG-FLD.

      *VAL-COD Valida codigo de tabla
           MOVE 'GAR' TO TAB-COD-SIST.
           MOVE 'SIN ' TO TAB-COD-TTAB IN TAB.
           MOVE GDG-IND-OBL-INS IN GDG-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-GDG-IND-OBL-INS.
           EXIT.
       
       VAL-GDG-FEC-ING-SIS SECTION.
       INI-VAL-GDG-FEC-ING-SIS.
           IF GDG-FEC-ING-SIS IN GDG-FLD NOT > ZEROES
              MOVE ZEROES TO GDG-FEC-ING-SIS IN GDG-FLD.
       FIN-VAL-GDG-FEC-ING-SIS.
           EXIT.
       
       VAL-GDG-COD-TSN SECTION.
       INI-VAL-GDG-COD-TSN.
       FIN-VAL-GDG-COD-TSN.
           EXIT.
       
       VAL-GDG-IND-CPL SECTION.
       INI-VAL-GDG-IND-CPL.
      *<<<< GDG_IND_CPL
      *FLB CST  22-NOV-1993
           IF GDG-IND-CPL IN GDG-FLD NOT > SPACES
              MOVE 'N' TO GDG-IND-CPL IN GDG-FLD.
      *>>>>
       FIN-VAL-GDG-IND-CPL.
           EXIT.
       
       VAL-CON-FLD-GDG SECTION.
       INI-VAL-CON-FLD-GDG.
       FIN-VAL-CON-FLD-GDG.
           EXIT.
       
       VAL-CON-GDG SECTION.
       INI-VAL-CON-GDG.
       FIN-VAL-CON-GDG.
           EXIT.
       
       VAL-NUM-KEY-GDG SECTION.
       INI-VAL-NUM-KEY-GDG.
           PERFORM VAL-NUM-IKY-GDG.
           PERFORM VAL-NUM-MKY-GDG.
           PERFORM VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-KEY-GDG.
           EXIT.
       
       VAL-NUM-IKY-GDG SECTION.
       INI-VAL-NUM-IKY-GDG.
       VAL-NUM-GDG-COD-CRR.
           MOVE GDG-COD-CRR-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-CRR IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-IKY-GDG.
       FIN-VAL-NUM-IKY-GDG.
           EXIT.
       
       VAL-NUM-MKY-GDG SECTION.
       INI-VAL-NUM-MKY-GDG.
       VAL-NUM-DBC-IIC-ICLI.
           MOVE DBC-IIC-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-IIC-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-MKY-GDG.
       FIN-VAL-NUM-MKY-GDG.
           EXIT.
       
       VAL-NUM-AKY-GDG SECTION.
       INI-VAL-NUM-AKY-GDG.
       FIN-VAL-NUM-AKY-GDG.
           EXIT.
       
       VAL-NUM-FLD-GDG SECTION.
       INI-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-IIC-IOPD.
           MOVE FRM-IIC-IOPD-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPD IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-GRA.
           MOVE GDG-COD-GRA-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 1 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-GRA IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-IIC-ICLI.
           MOVE GDG-IIC-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-IIC-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-NUM-ICLI IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       VAL-NUM-GDG-COD-TSN.
           MOVE GDG-COD-TSN-ALF IN GDG-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO GDG-COD-TSN IN GDG-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-VAL-NUM-FLD-GDG.
       FIN-VAL-NUM-FLD-GDG.
           EXIT.
       
       EDT-KEY-GDG SECTION.
       INI-EDT-KEY-GDG.
           PERFORM EDT-IKY-GDG.
           PERFORM EDT-MKY-GDG.
           PERFORM EDT-AKY-GDG.
       FIN-EDT-KEY-GDG.
           EXIT.
       
       EDT-IKY-GDG SECTION.
       INI-EDT-IKY-GDG.
           IF GDG-COD-CRR-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-CRR-LEN IN GDG-FLD
                GO TO FIN-EDT-IKY-GDG.
           MOVE GDG-COD-CRR IN GDG-FLD TO GDG-COD-CRR-EDT IN GDG-EDT.
           MOVE GDG-COD-CRR-EDT IN GDG-EDT TO 
                GDG-COD-CRR-ALF IN GDG-FLD.
       FIN-EDT-IKY-GDG.
           EXIT.
       
       EDT-MKY-GDG SECTION.
       INI-EDT-MKY-GDG.
           IF DBC-IIC-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO DBC-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-IIC-ICLI IN GDG-FLD TO DBC-IIC-ICLI-EDT IN GDG-EDT.
           MOVE DBC-IIC-ICLI-EDT IN GDG-EDT TO 
                DBC-IIC-ICLI-ALF IN GDG-FLD.
           IF DBC-NUM-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-MKY-GDG.
           MOVE DBC-NUM-ICLI IN GDG-FLD TO DBC-NUM-ICLI-EDT IN GDG-EDT.
           MOVE DBC-NUM-ICLI-EDT IN GDG-EDT TO 
                DBC-NUM-ICLI-ALF IN GDG-FLD.
       FIN-EDT-MKY-GDG.
           EXIT.
       
       EDT-AKY-GDG SECTION.
       INI-EDT-AKY-GDG.
       FIN-EDT-AKY-GDG.
           EXIT.
       
       EDT-FLD-GDG SECTION.
       INI-EDT-FLD-GDG.
           IF FRM-IIC-IOPD-LEN IN GDG-FLD = -9
                MOVE -1 TO FRM-IIC-IOPD-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO FRM-IIC-IOPD-EDT IN GDG-EDT.
           MOVE FRM-IIC-IOPD-EDT IN GDG-EDT TO 
                FRM-IIC-IOPD-ALF IN GDG-FLD.
           IF GDG-COD-GRA-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-GRA-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-GRA IN GDG-FLD TO GDG-COD-GRA-EDT IN GDG-EDT.
           MOVE GDG-COD-GRA-EDT IN GDG-EDT TO 
                GDG-COD-GRA-ALF IN GDG-FLD.
           IF GDG-IIC-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-IIC-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-IIC-ICLI IN GDG-FLD TO GDG-IIC-ICLI-EDT IN GDG-EDT.
           MOVE GDG-IIC-ICLI-EDT IN GDG-EDT TO 
                GDG-IIC-ICLI-ALF IN GDG-FLD.
           IF FRM-NUM-ICLI-LEN IN GDG-FLD = -9
                MOVE -1 TO FRM-NUM-ICLI-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE FRM-NUM-ICLI IN GDG-FLD TO FRM-NUM-ICLI-EDT IN GDG-EDT.
           MOVE FRM-NUM-ICLI-EDT IN GDG-EDT TO 
                FRM-NUM-ICLI-ALF IN GDG-FLD.
           IF GDG-COD-TSN-LEN IN GDG-FLD = -9
                MOVE -1 TO GDG-COD-TSN-LEN IN GDG-FLD
                GO TO FIN-EDT-FLD-GDG.
           MOVE GDG-COD-TSN IN GDG-FLD TO GDG-COD-TSN-EDT IN GDG-EDT.
           MOVE GDG-COD-TSN-EDT IN GDG-EDT TO 
                GDG-COD-TSN-ALF IN GDG-FLD.
       FIN-EDT-FLD-GDG.
           EXIT.
      *<<<< PGM_CHI AND ( EOF_BQ OR EOF_BU OR EOF_VAX )
       BUS-RCC SECTION.
       INI-BUS-RCC.
      * Muestra Primer Cliente del OPD de DAP mediante RCC
           MOVE FRM-CAI-IOPD IN GDG-FLD TO RCC-CAI-IOPD IN RCC.
           MOVE FRM-IIC-IOPD IN GDG-FLD TO RCC-IIC-IOPD IN RCC.
           MOVE 'RCC-KEY-IOPD' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM DAP-FIO-RCC.
           IF NOT (
                  FIO-STAT-OKS AND
                  FRM-CAI-IOPD IN GDG-FLD = RCC-CAI-IOPD IN RCC AND
                  FRM-IIC-IOPD IN GDG-FLD = RCC-IIC-IOPD IN RCC
                  )
               MOVE 'GAR'          TO MSG-COD-SIST
               MOVE 'RCC    NEX'   TO MSG-COD-MENS
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-BUS-RCC.
       FIN-BUS-RCC.
           EXIT.
      *>>>>
