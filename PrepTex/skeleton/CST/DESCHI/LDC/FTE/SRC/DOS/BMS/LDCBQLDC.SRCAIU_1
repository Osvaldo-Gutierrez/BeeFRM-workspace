      * 28-Feb-95 07:43 PM
       PUT-ALL-LDC SECTION.
       INI-PUT-ALL-LDC.
           PERFORM PUT-CLF-LDC.
           PERFORM PUT-LDC-LDC.
           PERFORM PUT-DBC-LDC.
           PERFORM PUT-ARC-LDC.
           PERFORM PUT-ARG-LDC.
      *<<<< FIN_PUT_ALL_LDC
           IF NOT (LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-NUM-PVIG IN LDC-FLD > ZEROES )
               GO TO FIN-PUT-ALL-LDC.
      *>>>>
       FIN-PUT-ALL-LDC.
           EXIT.
       
       PUT-CLF-LDC SECTION.
       INI-PUT-CLF-LDC.
           IF PGM-STAT-CLF-NUL
               GO TO FIN-PUT-CLF-LDC.
           IF NOT PGM-STAT-CLF-OKS
               PERFORM CLR-CLF-LDC
               GO TO FIN-PUT-CLF-LDC.
           MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN LDC-FLD.
           MOVE CLF-COD-TOCF IN CLF TO CLF-COD-TOCF IN LDC-FLD.
           MOVE CLF-COD-AOCF IN CLF TO CLF-COD-AOCF IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCCF IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-TOCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOCF IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
      *<<<< FIN_PUT_CLF_LDC
      *AMP-INI  09-OCT-1993
      * Inmediatamente antes se hizo BUS-TAB para el CLF-COD-TOCF
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      *AMP-FIN  09-OCT-1993
      *<<<< PGM_CHI
      *>>>>

           IF CLF-COD-AOCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN LDC-FLD.
      *LTM CST 30-09-93
            IF WSS-CIC-TOCF = 'CGE'
                MOVE CLF-NUM-SVEN IN CLF TO LDC-NUM-SVEN IN LDC-FLD
                MOVE CLF-NUM-AVEN IN CLF TO LDC-NUM-AVEN IN LDC-FLD
                MOVE CLF-NUM-MVEN IN CLF TO LDC-NUM-MVEN IN LDC-FLD
                MOVE CLF-NUM-DVEN IN CLF TO LDC-NUM-DVEN IN LDC-FLD
                MOVE CLF-VAL-CMAX IN CLF TO LDC-VAL-CMAX IN LDC-FLD.
      *>>>>
       FIN-PUT-CLF-LDC.
           EXIT.
       
       PUT-LDC-LDC SECTION.
       INI-PUT-LDC-LDC.
           IF PGM-STAT-LDC-NUL
               GO TO FIN-PUT-LDC-LDC.
           IF NOT PGM-STAT-LDC-OKS
               PERFORM CLR-LDC-LDC
               GO TO FIN-PUT-LDC-LDC.
           MOVE LDC-CAI-ICLF IN LDC TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE LDC-IIC-ICLF IN LDC TO LDC-IIC-ICLF IN LDC-FLD.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN LDC-FLD.
           MOVE LDC-COD-TIPO IN LDC TO LDC-COD-TIPO IN LDC-FLD.
           MOVE LDC-GLS-DESC IN LDC TO LDC-GLS-DESC IN LDC-FLD.
           MOVE LDC-GLS-DCOR IN LDC TO LDC-GLS-DCOR IN LDC-FLD.
           MOVE LDC-VAL-CMAX IN LDC TO LDC-VAL-CMAX IN LDC-FLD.
           MOVE LDC-COD-VCLC IN LDC TO LDC-COD-VCLC IN LDC-FLD.
           MOVE LDC-IND-MGAR IN LDC TO LDC-IND-MGAR IN LDC-FLD.
           MOVE LDC-NUM-PVIG IN LDC TO LDC-NUM-PVIG IN LDC-FLD.
           MOVE LDC-IND-PVIG IN LDC TO LDC-IND-PVIG IN LDC-FLD.
           MOVE LDC-NUM-DVEN IN LDC TO LDC-NUM-DVEN IN LDC-FLD.
           MOVE LDC-NUM-MVEN IN LDC TO LDC-NUM-MVEN IN LDC-FLD.
           MOVE LDC-NUM-SVEN IN LDC TO LDC-NUM-SVEN IN LDC-FLD.
           MOVE LDC-NUM-AVEN IN LDC TO LDC-NUM-AVEN IN LDC-FLD.
           MOVE LDC-IND-VIGE IN LDC TO LDC-IND-VIGE IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF LDC-COD-VCLC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE LDC-COD-VCLC IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCLC IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCLC IN LDC-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF LDC-IND-PVIG IN LDC-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PVIG IN LDC-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-PVIG IN LDC-FLD.
      *<<<< FIN_PUT_LDC_LDC
      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               GO TO BQ-NO-LDC-TIPO.

           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DESC IN TAB TO LDC-GLS-DESC IN LDC-FLD
               MOVE TAB-GLS-DCOR IN TAB TO LDC-GLS-DCOR IN LDC-FLD.
      *FLB CST  28-FEB-1995 
           IF TAB-CIC-CTAB IN TAB = 'LAV'
               PERFORM OBT-FINI.
       BQ-NO-LDC-TIPO.
      *>>>>
       FIN-PUT-LDC-LDC.
           EXIT.
       
       PUT-DBC-LDC SECTION.
       INI-PUT-DBC-LDC.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-LDC.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-LDC
               GO TO FIN-PUT-DBC-LDC.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN LDC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN LDC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN LDC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN LDC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN LDC-FLD.
       FIN-PUT-DBC-LDC.
           EXIT.
       
       PUT-ARC-LDC SECTION.
       INI-PUT-ARC-LDC.
      *<<<< INI_PUT_ARC_LDC
           IF CMA-NUM-ARC IN CMA-VARI > 1
               PERFORM CLR-ARC-LDC
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               MOVE 'S' TO FRM-IND-MARC IN LDC-FLD
               GO TO FIN-PUT-ARC-LDC.
           MOVE 'N' TO FRM-IND-MARC IN LDC-FLD.
      *>>>>
           IF PGM-STAT-ARC-NUL
               GO TO FIN-PUT-ARC-LDC.
           IF NOT PGM-STAT-ARC-OKS
               PERFORM CLR-ARC-LDC
               GO TO FIN-PUT-ARC-LDC.
           MOVE ARC-COD-VCOC IN ARC TO ARC-COD-VCOC IN LDC-FLD.
           MOVE ARC-COD-TOOC IN ARC TO ARC-COD-TOOC IN LDC-FLD.
           MOVE ARC-COD-AOOC IN ARC TO ARC-COD-AOOC IN LDC-FLD.
           MOVE ARC-CAI-IOPC IN ARC TO ARC-CAI-IOPC IN LDC-FLD.
           MOVE ARC-IIC-IOPC IN ARC TO ARC-IIC-IOPC IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-VCOC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-VCOC IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARC-COD-TOOC IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE ARC-COD-TOOC IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
      *<<<< FIN_PUT_ARC_LDC

           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               GO TO FIN-PUT-AOOC.

           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD
                                       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'LDCTIO   NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PUT-AOOC.

           MOVE TAB  TO TIO.

      *VAL-COD Valida codigo de tabla
           IF TIO-GLS-SIST IN TIO = 'COL'
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI.
           MOVE ARC-COD-AOOC IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
       FIN-PUT-AOOC.
      *>>>>
       FIN-PUT-ARC-LDC.
           EXIT.
       
       PUT-ARG-LDC SECTION.
       INI-PUT-ARG-LDC.
      *<<<< INI_PUT_ARG_LDC
      *FLB CST  26-OCT-1993 TRASLADADO AQUI
           IF WSS-CIC-TOCF = 'CGE'
               MOVE 'S' TO LDC-IND-MGAR IN LDC-FLD.

           IF CMA-NUM-ARG IN CMA-VARI > 1 OR
              WSS-CIC-TOCF = 'CGE' OR
              LDC-IND-MGAR IN LDC-FLD = 'O' OR 'Y'
               PERFORM CLR-ARG-LDC
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD 
               GO TO FIN-PUT-ARG-LDC.
      *>>>>
           IF PGM-STAT-ARG-NUL
               GO TO FIN-PUT-ARG-LDC.
           IF NOT PGM-STAT-ARG-OKS
               PERFORM CLR-ARG-LDC
               GO TO FIN-PUT-ARG-LDC.
           MOVE ARG-COD-TOGA IN ARG TO ARG-COD-TOGA IN LDC-FLD.
           MOVE ARG-COD-AOGA IN ARG TO ARG-COD-AOGA IN LDC-FLD.
           MOVE ARG-NUM-PORG IN ARG TO ARG-NUM-PORG IN LDC-FLD.
           MOVE ARG-CAI-IGAR IN ARG TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE ARG-IIC-IGAR IN ARG TO ARG-IIC-IGAR IN LDC-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF ARG-COD-TOGA IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-TOGA IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOGA IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
      *<<<< FIN_PUT_ARG_LDC
      *LTM CST 30-09-93
           IF LDC-IND-MGAR IN LDC-FLD = 'U' AND
              ARG-IIC-IGAR IN LDC-FLD > ZEROES 
               MOVE 'E' TO LDC-IND-MGAR IN LDC-FLD.

           IF ARG-COD-AOGA IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-TOGA IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE ARG-COD-AOGA IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOGA IN LDC-FLD.

      *>>>>
       FIN-PUT-ARG-LDC.
           EXIT.
       
       KEY-ALL-LDC SECTION.
       INI-KEY-ALL-LDC.
           PERFORM KEY-CLF-LDC.
           PERFORM KEY-LDC-LDC.
           PERFORM KEY-DBC-LDC.
           PERFORM KEY-ARC-LDC.
           PERFORM KEY-ARG-LDC.
       FIN-KEY-ALL-LDC.
           EXIT.
       
       KEY-CLF-LDC SECTION.
       INI-KEY-CLF-LDC.
       FIN-KEY-CLF-LDC.
           EXIT.
       
       KEY-LDC-LDC SECTION.
       INI-KEY-LDC-LDC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-LDC.
           EXIT.
       
       KEY-DBC-LDC SECTION.
       INI-KEY-DBC-LDC.
       FIN-KEY-DBC-LDC.
           EXIT.
       
       KEY-ARC-LDC SECTION.
       INI-KEY-ARC-LDC.
       FIN-KEY-ARC-LDC.
           EXIT.
       
       KEY-ARG-LDC SECTION.
       INI-KEY-ARG-LDC.
       FIN-KEY-ARG-LDC.
           EXIT.
       
       SCR-CLRA-LDC SECTION.
       INI-SCR-CLRA-LDC.
           PERFORM CLR-KEY-LDC.
           PERFORM CLR-FLD-LDC.
       FIN-SCR-CLRA-LDC.
           EXIT.
       
       CLR-KEY-LDC SECTION.
       INI-CLR-KEY-LDC.
           MOVE SPACES TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN LDC-FLD.
       FIN-CLR-KEY-LDC.
           EXIT.
       
       CLR-FLD-LDC SECTION.
       INI-CLR-FLD-LDC.
           MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN LDC-FLD.
           MOVE SPACES TO FRM-IND-MARC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-VCLC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD.
           MOVE ZEROES TO FRM-FEC-FINI IN LDC-FLD.
           PERFORM CLR-CLF-LDC.
           PERFORM CLR-LDC-LDC.
           PERFORM CLR-DBC-LDC.
           PERFORM CLR-ARC-LDC.
           PERFORM CLR-ARG-LDC.
       FIN-CLR-FLD-LDC.
           EXIT.
       
       CLR-CLF-LDC SECTION.
       INI-CLR-CLF-LDC.
           MOVE SPACES TO CLF-COD-VCCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN LDC-FLD.
       FIN-CLR-CLF-LDC.
           EXIT.
       
       CLR-LDC-LDC SECTION.
       INI-CLR-LDC-LDC.
           MOVE SPACES TO LDC-COD-TIPO IN LDC-FLD.
           MOVE SPACES TO LDC-GLS-DESC IN LDC-FLD.
           MOVE SPACES TO LDC-GLS-DCOR IN LDC-FLD.
           MOVE ZEROES TO LDC-VAL-CMAX IN LDC-FLD.
           MOVE SPACES TO LDC-COD-VCLC IN LDC-FLD.
           MOVE SPACES TO LDC-IND-MGAR IN LDC-FLD.
           MOVE ZEROES TO LDC-NUM-PVIG IN LDC-FLD.
           MOVE SPACES TO LDC-IND-PVIG IN LDC-FLD.
           MOVE ZEROES TO LDC-FEC-FVEN IN LDC-FLD.
           MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD.
       FIN-CLR-LDC-LDC.
           EXIT.
       
       CLR-DBC-LDC SECTION.
       INI-CLR-DBC-LDC.
           MOVE SPACES TO DBC-GLS-NOMC IN LDC-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN LDC-FLD.
       FIN-CLR-DBC-LDC.
           EXIT.
       
       CLR-ARC-LDC SECTION.
       INI-CLR-ARC-LDC.
           MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD.
           MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD.
           MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD.
       FIN-CLR-ARC-LDC.
           EXIT.
       
       CLR-ARG-LDC SECTION.
       INI-CLR-ARG-LDC.
           MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD.
           MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD.
           MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD.
           MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-CLR-ARG-LDC.
           EXIT.
       
       FST-KEY-LDC SECTION.
       INI-FST-KEY-LDC.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN LDC-FLD.
      *<<<< FIN_FST_KEY_LDC
           IF SCR-CCPP = 'ING' OR 'ELI'
               MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN LDC-FLD.
      *>>>>
       FIN-FST-KEY-LDC.
           EXIT.
       
       FST-FLD-LDC SECTION.
       INI-FST-FLD-LDC.
           MOVE -1 TO LDC-COD-TIPO-LEN IN LDC-FLD.
      *<<<< FIN_FST_FLD_LDC
      *FLB CST  10-JUN-1994 
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD
               MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD
           ELSE    
               MOVE FRM-CPIM-AEY TO FRM-IND-MARC-ATR IN LDC-FLD.

           IF CMA-NUM-ARC IN CMA-VARI > 1 OR
              FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE 'S'    TO FRM-IND-MARC IN LDC-FLD
               MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD
                              ARC-COD-TOOC IN LDC-FLD
                              ARC-COD-AOOC IN LDC-FLD
                              ARC-CAI-IOPC IN LDC-FLD
               MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD 
               IF CMA-NUM-ARC IN CMA-VARI > 1 
                   MOVE FRM-CPIM-AEY TO ARC-COD-VCOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-TOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-AOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-CAI-IOPC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-IIC-IOPC-ATR IN LDC-FLD.

           IF CMA-NUM-ARG IN CMA-VARI > 1 OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )

               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD 
               IF CMA-NUM-ARG IN CMA-VARI > 1 
                   MOVE FRM-CPIM-AEY TO ARG-COD-TOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-COD-AOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-CAI-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-IIC-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-NUM-PORG-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO LDC-IND-MGAR-ATR IN LDC-FLD.
      *FLB CST  10-JUN-1994 FIN

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               GO TO FST-NO-LDC-TIPO.

           MOVE FRM-CPIM-AEY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
       FST-NO-LDC-TIPO.
      *>>>>
       FIN-FST-FLD-LDC.
           EXIT.
       
       PRO-KEY-LDC SECTION.
       INI-PRO-KEY-LDC.
           PERFORM PRO-IKY-LDC.
           PERFORM PRO-AKY-LDC.
           PERFORM PRO-MKY-LDC.
       FIN-PRO-KEY-LDC.
           EXIT.
       
       PRO-IKY-LDC SECTION.
       INI-PRO-IKY-LDC.
           MOVE FRM-CPIM-AEY TO LDC-CAI-ICLF-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IIC-ICLF-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN LDC-FLD.
       FIN-PRO-IKY-LDC.
           EXIT.
       
       PRO-MKY-LDC SECTION.
       INI-PRO-MKY-LDC.
       FIN-PRO-MKY-LDC.
           EXIT.
       
       PRO-AKY-LDC SECTION.
       INI-PRO-AKY-LDC.
       FIN-PRO-AKY-LDC.
           EXIT.
       
       UNP-KEY-LDC SECTION.
       INI-UNP-KEY-LDC.
           PERFORM UNP-IKY-LDC.
           PERFORM UNP-AKY-LDC.
           PERFORM UNP-MKY-LDC.
       FIN-UNP-KEY-LDC.
           EXIT.
       
       UNP-IKY-LDC SECTION.
       INI-UNP-IKY-LDC.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-LDC.
           EXIT.
       
       UNP-MKY-LDC SECTION.
       INI-UNP-MKY-LDC.
       FIN-UNP-MKY-LDC.
           EXIT.
       
       UNP-AKY-LDC SECTION.
       INI-UNP-AKY-LDC.
       FIN-UNP-AKY-LDC.
           EXIT.
       
       UNP-FLD-LDC SECTION.
       INI-UNP-FLD-LDC.
           MOVE FRM-CPIM-UBY TO FRM-IND-MARC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FINI-ATR IN LDC-FLD.
           PERFORM UNP-CLF-LDC.
           PERFORM UNP-LDC-LDC.
           PERFORM UNP-DBC-LDC.
           PERFORM UNP-ARC-LDC.
           PERFORM UNP-ARG-LDC.
       FIN-UNP-FLD-LDC.
           EXIT.
       
       UNP-CLF-LDC SECTION.
       INI-UNP-CLF-LDC.
       FIN-UNP-CLF-LDC.
           EXIT.
       
       UNP-LDC-LDC SECTION.
       INI-UNP-LDC-LDC.
           MOVE FRM-CPIM-UBY TO LDC-COD-TIPO-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-VAL-CMAX-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-COD-VCLC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-MGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-NUM-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FVEN-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-VIGE-ATR IN LDC-FLD.
       FIN-UNP-LDC-LDC.
           EXIT.
       
       UNP-DBC-LDC SECTION.
       INI-UNP-DBC-LDC.
       FIN-UNP-DBC-LDC.
           EXIT.
       
       UNP-ARC-LDC SECTION.
       INI-UNP-ARC-LDC.
           MOVE FRM-CPIM-UBY TO ARC-COD-VCOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-TOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-AOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-CAI-IOPC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-IIC-IOPC-ATR IN LDC-FLD.
       FIN-UNP-ARC-LDC.
           EXIT.
       
       UNP-ARG-LDC SECTION.
       INI-UNP-ARG-LDC.
           MOVE FRM-CPIM-UBY TO ARG-COD-TOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-COD-AOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-NUM-PORG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-CAI-IGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-IIC-IGAR-ATR IN LDC-FLD.
       FIN-UNP-ARG-LDC.
           EXIT.
       
       VAL-KEY-LDC SECTION.
       INI-VAL-KEY-LDC.
           PERFORM VAL-IKY-LDC.
           PERFORM VAL-MKY-LDC.
           PERFORM VAL-AKY-LDC.
       FIN-VAL-KEY-LDC.
           EXIT.
       
       VAL-IKY-LDC SECTION.
       INI-VAL-IKY-LDC.
           PERFORM VAL-LDC-CAI-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-CAI-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
           PERFORM VAL-LDC-IIC-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
           PERFORM VAL-LDC-NUM-ILDC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-VAL-IKY-LDC.
       FIN-VAL-IKY-LDC.
           EXIT.
       
       VAL-MKY-LDC SECTION.
       INI-VAL-MKY-LDC.
       FIN-VAL-MKY-LDC.
           EXIT.
       
       VAL-AKY-LDC SECTION.
       INI-VAL-AKY-LDC.
       FIN-VAL-AKY-LDC.
           EXIT.
       
       VAL-LDC-CAI-ICLF SECTION.
       INI-VAL-LDC-CAI-ICLF.
           IF LDC-CAI-ICLF IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-CAI-ICLF IN LDC-FLD.
       FIN-VAL-LDC-CAI-ICLF.
           EXIT.
       
       VAL-LDC-IIC-ICLF SECTION.
       INI-VAL-LDC-IIC-ICLF.
       FIN-VAL-LDC-IIC-ICLF.
           EXIT.
       
       VAL-LDC-NUM-ILDC SECTION.
       INI-VAL-LDC-NUM-ILDC.
      *<<<< LDC_NUM_ILDC
            IF LDC-NUM-ILDC IN LDC-FLD = ZEROES
                PERFORM BUS-COR-LDC.

            IF LDC-NUM-ILDC IN LDC-FLD > VCL-TLCR 
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'NUMLDC>MAX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-NUM-ILDC.
      *>>>>
       FIN-VAL-LDC-NUM-ILDC.
           EXIT.
       
       VAL-CON-KEY-LDC SECTION.
       INI-VAL-CON-KEY-LDC.
           IF     LDC-CAI-ICLF IN LDC-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN LDC-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN LDC-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LDC.
       FIN-VAL-CON-KEY-LDC.
           EXIT.
       
       VAL-CON-IKY-LDC SECTION.
       INI-VAL-CON-IKY-LDC.
           IF     LDC-CAI-ICLF IN LDC-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN LDC-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN LDC-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LDC.
       FIN-VAL-CON-IKY-LDC.
           EXIT.
       
       VAL-NUM-KEY-LDC SECTION.
       INI-VAL-NUM-KEY-LDC.
           PERFORM VAL-NUM-IKY-LDC.
           PERFORM VAL-NUM-MKY-LDC.
           PERFORM VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-KEY-LDC.
           EXIT.
       
       VAL-NUM-IKY-LDC SECTION.
       INI-VAL-NUM-IKY-LDC.
       VAL-NUM-LDC-IIC-ICLF.
           MOVE LDC-IIC-ICLF-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-IIC-ICLF IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-IKY-LDC.
       VAL-NUM-LDC-NUM-ILDC.
           MOVE LDC-NUM-ILDC-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-NUM-ILDC IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-IKY-LDC.
       FIN-VAL-NUM-IKY-LDC.
           EXIT.
       
       VAL-NUM-MKY-LDC SECTION.
       INI-VAL-NUM-MKY-LDC.
       FIN-VAL-NUM-MKY-LDC.
           EXIT.
       
       VAL-NUM-AKY-LDC SECTION.
       INI-VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-AKY-LDC.
           EXIT.
       
       VAL-NUM-FLD-LDC SECTION.
       INI-VAL-NUM-FLD-LDC.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-LDC-VAL-CMAX.
           MOVE LDC-VAL-CMAX-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-VAL-CMAX IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARC-IIC-IOPC.
           MOVE ARC-IIC-IOPC-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO ARC-IIC-IOPC IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARG-NUM-PORG.
           MOVE ARG-NUM-PORG-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO ARG-NUM-PORG IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARG-IIC-IGAR.
           MOVE ARG-IIC-IGAR-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO ARG-IIC-IGAR IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-LDC-NUM-PVIG.
           MOVE LDC-NUM-PVIG-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-NUM-PVIG IN LDC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       FIN-VAL-NUM-FLD-LDC.
           EXIT.
       
       EDT-KEY-LDC SECTION.
       INI-EDT-KEY-LDC.
           PERFORM EDT-IKY-LDC.
           PERFORM EDT-MKY-LDC.
           PERFORM EDT-AKY-LDC.
       FIN-EDT-KEY-LDC.
           EXIT.
       
       EDT-IKY-LDC SECTION.
       INI-EDT-IKY-LDC.
           IF LDC-IIC-ICLF-LEN IN LDC-FLD = -9
                MOVE -1 TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-EDT-IKY-LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF-EDT IN LDC-EDT.
           MOVE LDC-IIC-ICLF-EDT IN LDC-EDT TO 
                LDC-IIC-ICLF-ALF IN LDC-FLD.
           IF LDC-NUM-ILDC-LEN IN LDC-FLD = -9
                MOVE -1 TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-EDT-IKY-LDC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO LDC-NUM-ILDC-EDT IN LDC-EDT.
           MOVE LDC-NUM-ILDC-EDT IN LDC-EDT TO 
                LDC-NUM-ILDC-ALF IN LDC-FLD.
       FIN-EDT-IKY-LDC.
           EXIT.
       
       EDT-MKY-LDC SECTION.
       INI-EDT-MKY-LDC.
       FIN-EDT-MKY-LDC.
           EXIT.
       
       EDT-AKY-LDC SECTION.
       INI-EDT-AKY-LDC.
       FIN-EDT-AKY-LDC.
           EXIT.
       
       EDT-FLD-LDC SECTION.
       INI-EDT-FLD-LDC.
           IF DBC-NUM-ICLI-LEN IN LDC-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE DBC-NUM-ICLI IN LDC-FLD TO DBC-NUM-ICLI-EDT IN LDC-EDT.
           MOVE DBC-NUM-ICLI-EDT IN LDC-EDT TO 
                DBC-NUM-ICLI-ALF IN LDC-FLD.
           IF LDC-VAL-CMAX-LEN IN LDC-FLD = -9
                MOVE -1 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD TO LDC-VAL-CMAX-EDT IN LDC-EDT.
           MOVE LDC-VAL-CMAX-EDT IN LDC-EDT TO 
                LDC-VAL-CMAX-ALF IN LDC-FLD.
           IF ARC-IIC-IOPC-LEN IN LDC-FLD = -9
                MOVE -1 TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC-EDT IN LDC-EDT.
           MOVE ARC-IIC-IOPC-EDT IN LDC-EDT TO 
                ARC-IIC-IOPC-ALF IN LDC-FLD.
           IF ARG-NUM-PORG-LEN IN LDC-FLD = -9
                MOVE -1 TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARG-NUM-PORG IN LDC-FLD TO ARG-NUM-PORG-EDT IN LDC-EDT.
           MOVE ARG-NUM-PORG-EDT IN LDC-EDT TO 
                ARG-NUM-PORG-ALF IN LDC-FLD.
           IF ARG-IIC-IGAR-LEN IN LDC-FLD = -9
                MOVE -1 TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR-EDT IN LDC-EDT.
           MOVE ARG-IIC-IGAR-EDT IN LDC-EDT TO 
                ARG-IIC-IGAR-ALF IN LDC-FLD.
           IF LDC-NUM-PVIG-LEN IN LDC-FLD = -9
                MOVE -1 TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE LDC-NUM-PVIG IN LDC-FLD TO LDC-NUM-PVIG-EDT IN LDC-EDT.
           MOVE LDC-NUM-PVIG-EDT IN LDC-EDT TO 
                LDC-NUM-PVIG-ALF IN LDC-FLD.
       FIN-EDT-FLD-LDC.
           EXIT.
      *<<<< EOF_BQ
       BUS-COR-LDC SECTION.
       INI-BUS-COR-LDC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE 99                      TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
                    LDC-CAI-ICLF IN LDC-FLD = LDC-CAI-ICLF IN LDC AND
                    LDC-IIC-ICLF IN LDC-FLD = LDC-IIC-ICLF IN LDC )
               PERFORM KEY-ALL-LDC.
           IF SCR-CCPP = 'ACT' OR 'ING'
               ADD 1 TO LDC-NUM-ILDC IN LDC.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN LDC-FLD.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.
       FIN-BUS-COR-LDC.
           EXIT.

       OBT-FINI SECTION.
       INI-OBT-FINI.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO FEC-ITM1
           MOVE LDC-NUM-MVEN IN LDC-FLD TO FEC-ITM2
           MOVE LDC-NUM-SVEN IN LDC-FLD TO FEC-ITM3
           MOVE LDC-NUM-AVEN IN LDC-FLD TO FEC-ITM4.

           IF LDC-IND-PVIG IN LDC-FLD = 'D'
              MOVE FEC-RST-DIA  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'M'
              MOVE FEC-RST-MES TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'A'
              MOVE FEC-RST-ANO TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO FRM-NUM-DINI IN LDC-FLD.
           MOVE FEC-ITM2     TO FRM-NUM-MINI IN LDC-FLD.
           MOVE FEC-ITM3     TO FRM-NUM-SINI IN LDC-FLD.
           MOVE FEC-ITM4     TO FRM-NUM-AINI IN LDC-FLD.

       FIN-OBT-FINI.
           EXIT.

      *>>>>
