      * 16-Jan-95 04:04 PM
       RET-ALL-ARC SECTION.
       INI-RET-ALL-ARC.
           PERFORM KEY-ALL-ARC.
           PERFORM RET-CLF-ARC.
           PERFORM RET-LDC-ARC.
           PERFORM RET-DBC-ARC.
       FIN-RET-ALL-ARC.
           EXIT.
       
       RET-CLF-ARC SECTION.
       INI-RET-CLF-ARC.
           MOVE CLF-COD-VCCF IN ARC-FLD TO CLF-COD-VCCF IN CLF.
           MOVE CLF-COD-TOCF IN ARC-FLD TO CLF-COD-TOCF IN CLF.
           MOVE CLF-COD-AOCF IN ARC-FLD TO CLF-COD-AOCF IN CLF.
       FIN-RET-CLF-ARC.
           EXIT.
       
       RET-LDC-ARC SECTION.
       INI-RET-LDC-ARC.
           MOVE LDC-COD-TIPO IN ARC-FLD TO LDC-COD-TIPO IN LDC.
           MOVE LDC-GLS-DESC IN ARC-FLD TO LDC-GLS-DESC IN LDC.
       FIN-RET-LDC-ARC.
           EXIT.
       
       RET-DBC-ARC SECTION.
       INI-RET-DBC-ARC.
           MOVE DBC-GLS-NOMC IN ARC-FLD TO DBC-GLS-NOMC IN DBC.
           MOVE DBC-NUM-ICLI IN ARC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN ARC-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN ARC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN ARC-FLD TO DBC-GLS-ICLI IN DBC.
       FIN-RET-DBC-ARC.
           EXIT.
       
       KEY-ALL-ARC SECTION.
       INI-KEY-ALL-ARC.
           PERFORM KEY-CLF-ARC.
           PERFORM KEY-LDC-ARC.
           PERFORM KEY-DBC-ARC.
       FIN-KEY-ALL-ARC.
           EXIT.
       
       KEY-CLF-ARC SECTION.
       INI-KEY-CLF-ARC.
       FIN-KEY-CLF-ARC.
           EXIT.
       
       KEY-LDC-ARC SECTION.
       INI-KEY-LDC-ARC.
           MOVE LDC-CAI-ICLF IN ARC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN ARC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN ARC-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-ARC.
           EXIT.
       
       KEY-DBC-ARC SECTION.
       INI-KEY-DBC-ARC.
       FIN-KEY-DBC-ARC.
           EXIT.
       
       SCR-CLRA-ARC SECTION.
       INI-SCR-CLRA-ARC.
           PERFORM CLR-KEY-ARC.
           PERFORM CLR-FLD-ARC.
       FIN-SCR-CLRA-ARC.
           EXIT.
       
       CLR-KEY-ARC SECTION.
       INI-CLR-KEY-ARC.
           MOVE SPACES TO LDC-CAI-ICLF IN ARC-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN ARC-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN ARC-FLD.
       FIN-CLR-KEY-ARC.
           EXIT.
       
       CLR-FLD-ARC SECTION.
       INI-CLR-FLD-ARC.
           MOVE SPACES TO FRM-GLS-VCCF IN ARC-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN ARC-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN ARC-FLD.
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(1).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(2).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(3).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(4).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(5).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(6).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(7).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(8).
           MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(9).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(2).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(3).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(4).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(5).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(6).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(7).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(8).
           MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(9).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(1).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(2).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(3).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(4).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(5).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(6).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(7).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(8).
           MOVE ZEROES TO FRM-IIC-IOPC IN ARC-FLD(9).
           PERFORM CLR-CLF-ARC.
           PERFORM CLR-LDC-ARC.
           PERFORM CLR-DBC-ARC.
       FIN-CLR-FLD-ARC.
           EXIT.
       
       CLR-CLF-ARC SECTION.
       INI-CLR-CLF-ARC.
           MOVE SPACES TO CLF-COD-VCCF IN ARC-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN ARC-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN ARC-FLD.
       FIN-CLR-CLF-ARC.
           EXIT.
       
       CLR-LDC-ARC SECTION.
       INI-CLR-LDC-ARC.
           MOVE SPACES TO LDC-COD-TIPO IN ARC-FLD.
           MOVE SPACES TO LDC-GLS-DESC IN ARC-FLD.
       FIN-CLR-LDC-ARC.
           EXIT.
       
       CLR-DBC-ARC SECTION.
       INI-CLR-DBC-ARC.
           MOVE SPACES TO DBC-GLS-NOMC IN ARC-FLD.
           MOVE ZEROES TO DBC-NUM-ICLI IN ARC-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN ARC-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN ARC-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN ARC-FLD.
       FIN-CLR-DBC-ARC.
           EXIT.
       
       FST-KEY-ARC SECTION.
       INI-FST-KEY-ARC.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN ARC-FLD.
       FIN-FST-KEY-ARC.
           EXIT.
       
       FST-FLD-ARC SECTION.
       INI-FST-FLD-ARC.
           MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(1).
       FIN-FST-FLD-ARC.
           EXIT.
       
       PRO-KEY-ARC SECTION.
       INI-PRO-KEY-ARC.
           PERFORM PRO-MKY-ARC.
       FIN-PRO-KEY-ARC.
           EXIT.
       
       PRO-MKY-ARC SECTION.
       INI-PRO-MKY-ARC.
       FIN-PRO-MKY-ARC.
           EXIT.
       
       PRO-FLD-ARC SECTION.
       INI-PRO-FLD-ARC.
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-CAI-IOPC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-IIC-IOPC-ATR IN ARC-FLD(9).
           PERFORM PRO-CLF-ARC.
           PERFORM PRO-LDC-ARC.
           PERFORM PRO-DBC-ARC.
       FIN-PRO-FLD-ARC.
           EXIT.
       
       PRO-CLF-ARC SECTION.
       INI-PRO-CLF-ARC.
       FIN-PRO-CLF-ARC.
           EXIT.
       
       PRO-LDC-ARC SECTION.
       INI-PRO-LDC-ARC.
       FIN-PRO-LDC-ARC.
           EXIT.
       
       PRO-DBC-ARC SECTION.
       INI-PRO-DBC-ARC.
       FIN-PRO-DBC-ARC.
           EXIT.
       
       UNP-KEY-ARC SECTION.
       INI-UNP-KEY-ARC.
           PERFORM UNP-IKY-ARC.
           PERFORM UNP-AKY-ARC.
           PERFORM UNP-MKY-ARC.
       FIN-UNP-KEY-ARC.
           EXIT.
       
       UNP-IKY-ARC SECTION.
       INI-UNP-IKY-ARC.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-ARC.
           EXIT.
       
       UNP-MKY-ARC SECTION.
       INI-UNP-MKY-ARC.
       FIN-UNP-MKY-ARC.
           EXIT.
       
       UNP-AKY-ARC SECTION.
       INI-UNP-AKY-ARC.
       FIN-UNP-AKY-ARC.
           EXIT.
       
       UNP-FLD-ARC SECTION.
       INI-UNP-FLD-ARC.
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-CAI-IOPC-ATR IN ARC-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-IIC-IOPC-ATR IN ARC-FLD(9).
           PERFORM UNP-CLF-ARC.
           PERFORM UNP-LDC-ARC.
           PERFORM UNP-DBC-ARC.
       FIN-UNP-FLD-ARC.
           EXIT.
       
       UNP-CLF-ARC SECTION.
       INI-UNP-CLF-ARC.
       FIN-UNP-CLF-ARC.
           EXIT.
       
       UNP-LDC-ARC SECTION.
       INI-UNP-LDC-ARC.
       FIN-UNP-LDC-ARC.
           EXIT.
       
       UNP-DBC-ARC SECTION.
       INI-UNP-DBC-ARC.
       FIN-UNP-DBC-ARC.
           EXIT.
       
       VAL-MKY-ARC SECTION.
       INI-VAL-MKY-ARC.
       FIN-VAL-MKY-ARC.
           EXIT.
       
       VAL-FLD-ARC SECTION.
       INI-VAL-FLD-ARC.
      *<<<< INI_VAL_FLD_ARC
      *FLB CST   13-DEC-1993 
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *FLB CST  6-OCT-1994 TRASLADADO AQUI
      *SMC-INI 26-10-1993 LEE TABLA VSN PARA DETERMINAR SI SE
      *                   USO DE FUNCIONALIDADES DE CTE, CEX
      *                   LEA, TCR.
      * BUSCA REGISTRO CTE.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCTE      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCTE IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCTE IN WSS-VARI.

      * BUSCA REGISTRO CEX.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCEX      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCEX IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCEX IN WSS-VARI.

      * BUSCA REGISTRO LEA.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCLEA      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VLEA IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VLEA IN WSS-VARI.

      * BUSCA REGISTRO TCR.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCTCR      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VTCR IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VTCR IN WSS-VARI.

      *SMC-FIN 26-10-1993 

      * ASIGNA O NO EL NUMERO DE CREDITO
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'ASIGNAOPC   '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AOPC IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AOPC IN WSS-VARI.

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               MOVE 'N' TO TLC-VSN-TIPO IN TLC-VARI
           ELSE
               MOVE 'S' TO TLC-VSN-TIPO IN TLC-VARI
      *FLB CST  24-NOV-1994 
               MOVE LDC-CAI-ICLF IN ARC-FLD TO LDC-CAI-ICLF IN LDC
               MOVE LDC-IIC-ICLF IN ARC-FLD TO LDC-IIC-ICLF IN LDC
               MOVE LDC-NUM-ILDC IN ARC-FLD TO LDC-NUM-ILDC IN LDC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-LDC
               IF NOT FIO-STAT-OKS
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'DATERR' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FLD-ARC
               ELSE
                   MOVE 'DEU' TO TAB-COD-SIST
                   MOVE 'TLC'               TO TAB-COD-TTAB IN TAB
                   MOVE LDC-COD-TIPO IN LDC TO TAB-COD-CTAB IN TAB
                   PERFORM VAL-COD
                   IF MSG-COD-MENS = 'COD    NEX' OR
                      LDC-COD-TIPO IN LDC NOT > SPACES
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'LDCTIPBLK' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FLD-ARC
                   ELSE
                       MOVE TAB-CIC-CTAB IN TAB TO 
                            TLC-CIC-LDIS IN TLC-VARI.

      *FLB CST  17-OCT-1994 
      * Permite o no TIO sin AUX
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'TIO+AUX OBL '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AXOB IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AXOB IN WSS-VARI.

      *FLB CST  24-NOV-1994 MODIFICADO POR LINEA LIBRE DISPONIBILIDAD
           MOVE 'N' TO WSS-EXI-ARC.
      *FLB CST  6-OCT-1994 
           PERFORM VAL-FLD-IDX
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > WSS-IMAX
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-FLD-ARC.

      *FLB CST  24-NOV-1994 MODIFICADO POR LINEA LIBRE DISPONIBILIDAD
           IF WSS-EXI-ARC = 'N' AND
              TLC-CIC-LDIS IN TLC-VARI NOT = 'LIBRE' 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCNOARC'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(1)
               GO TO FIN-VAL-FLD-ARC.

           GO TO FIN-VAL-FLD-ARC.
      *>>>>
           PERFORM VAL-CLF-COD-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-VCCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-CLF-COD-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-TOCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-CLF-COD-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO CLF-COD-AOCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-VCCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-TOCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-GLS-AOCF-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-LDC-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-COD-TIPO-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-LDC-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO LDC-GLS-DESC-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-NOMC-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN ARC-FLD
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-COD-VCOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-VCOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-GLS-VCOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-COD-TOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-COD-TOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-COD-AOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-COD-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-TOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-GLS-TOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-GLS-AOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-GLS-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-CAI-IOPC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-CAI-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
           PERFORM VAL-FRM-IIC-IOPC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 9
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ARC.
       FIN-VAL-FLD-ARC.
           EXIT.
       
       VAL-CLF-COD-VCCF SECTION.
       INI-VAL-CLF-COD-VCCF.
       FIN-VAL-CLF-COD-VCCF.
           EXIT.
       
       VAL-CLF-COD-TOCF SECTION.
       INI-VAL-CLF-COD-TOCF.
       FIN-VAL-CLF-COD-TOCF.
           EXIT.
       
       VAL-CLF-COD-AOCF SECTION.
       INI-VAL-CLF-COD-AOCF.
       FIN-VAL-CLF-COD-AOCF.
           EXIT.
       
       VAL-FRM-GLS-VCCF SECTION.
       INI-VAL-FRM-GLS-VCCF.
       FIN-VAL-FRM-GLS-VCCF.
           EXIT.
       
       VAL-FRM-GLS-TOCF SECTION.
       INI-VAL-FRM-GLS-TOCF.
       FIN-VAL-FRM-GLS-TOCF.
           EXIT.
       
       VAL-FRM-GLS-AOCF SECTION.
       INI-VAL-FRM-GLS-AOCF.
       FIN-VAL-FRM-GLS-AOCF.
           EXIT.
       
       VAL-LDC-COD-TIPO SECTION.
       INI-VAL-LDC-COD-TIPO.
       FIN-VAL-LDC-COD-TIPO.
           EXIT.
       
       VAL-LDC-GLS-DESC SECTION.
       INI-VAL-LDC-GLS-DESC.
       FIN-VAL-LDC-GLS-DESC.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
       
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN ARC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN ARC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN ARC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN ARC-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN ARC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN ARC-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       
       VAL-FRM-COD-VCOC SECTION.
       INI-VAL-FRM-COD-VCOC.
           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-VCOC IN ARC-FLD(FRM-IFLD).
      *<<<< FRM_COD_VCOC                                                
           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD)         
               GO TO FIN-VAL-FRM-COD-VCOC.                               
      *VAL-COD Valida Cod. Moneda de Tabla                              
           MOVE 'TAB'               TO TAB-COD-SIST.                    
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.             
           MOVE FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) TO                    
                                       TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD)         
           ELSE                                                         
               MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-VCOC IN ARC-FLD(FRM-IFLD).        
      *>>>>
       FIN-VAL-FRM-COD-VCOC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-FRM-COD-TOOC SECTION.
       INI-VAL-FRM-COD-TOOC.
           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-TOOC IN ARC-FLD(FRM-IFLD).
      *<<<< FRM_COD_TOOC                                                
           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD)         
      *FLB CST  6-OCT-1994 
               MOVE SPACES TO WSS-CIC-TOOC
               GO TO FIN-VAL-FRM-COD-TOOC.                               
      *VAL-COD Valida Cod. Tipo de Operacion de Tabla                   
           MOVE 'TAB'               TO TAB-COD-SIST.                    
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.             
           MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO                    
                                       TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
      *FLB CST  10-OCT-1994 Modificado por Codificacion Tipo de Linea
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD)         
               GO TO FIN-VAL-FRM-COD-TOOC.                               

           MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-TOOC IN ARC-FLD(FRM-IFLD).
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOOC.
           IF ( TAB-CIC-CTAB IN TAB = 'CGE' )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CODTIOINVL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-TOOC.

           MOVE TAB TO TIO.
           IF NOT ( ( USA-CEX AND TIO-GLS-SIST IN TIO = 'CEX' ) 
                 OR ( USA-CTE AND TIO-GLS-SIST IN TIO = 'CTE' ) 
                 OR ( USA-LEA AND TIO-GLS-SIST IN TIO = 'LEA' ) 
                 OR ( USA-TCR AND TIO-GLS-SIST IN TIO = 'TCR' ) 
                 OR ( TIO-GLS-SIST IN TIO = 'COL' ) )

               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-TOOC.

      *>>>>
       FIN-VAL-FRM-COD-TOOC.
           EXIT.
       
       VAL-FRM-COD-AOOC SECTION.
       INI-VAL-FRM-COD-AOOC.
           IF FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-AOOC IN ARC-FLD(FRM-IFLD).
      *<<<< FRM_COD_AOOC                                                
           IF FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD)         
               GO TO FIN-VAL-FRM-COD-AOOC.                               

      *SMC-INI 22-11-1993

      * VALIDA C. AUX CONTRA COL/AUX, CUANDO TIPO DE OPERACION SEA
      * DE 'COL' ( TIO-GLS-SIST = 'COL') SI NO CONTRA TAB/AUX.

           IF TIO-GLS-SIST IN TIO = 'COL'
              MOVE 'COL'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO                    
                                          WSS-COD-TOPE IN WSS-VARI
              MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO                    
                                          WSS-COD-AOPE IN WSS-VARI
              MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
           ELSE
      *VAL-COD Valida Cod. Auxiliar de Operacion de Tabla TAB/AUX
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'AUX'               TO TAB-COD-TTAB IN TAB             
              MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO                    
                                          WSS-COD-TOPE IN WSS-VARI        
              MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO                    
                                          WSS-COD-AOPE IN WSS-VARI        
              MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.        

      *SMC-FIN 22-11-1993

           PERFORM VAL-COD.                                             
      *FLB CST  10-OCT-1994 Modificado por Codificacion Tipo de Linea
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES            
               MOVE SPACES TO FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD)         
               GO TO FIN-VAL-FRM-COD-AOOC.                               

           MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-AOOC IN ARC-FLD(FRM-IFLD).

      *>>>>
       FIN-VAL-FRM-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
       
       VAL-FRM-CAI-IOPC SECTION.
       INI-VAL-FRM-CAI-IOPC.
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD).
      *<<< FRM_CAI_IOPC
      *FLB CST  6-OCT-1994 PARA CTA CTE PUEDE ESTAR LLENA LA CLAVE
           IF WSS-CIC-TOOC = 'CTE' AND USA-CTE
               GO TO FIN-VAL-FRM-CAI-IOPC.

      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              ( FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES 
              )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'IICIOPC>0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-CAI-IOPC.

      *FLB CST  26-OCT-1993 
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              WSS-VSN-OCAI = 'S'
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO 
                    CIC-CAI-ICIC IN CIC
               IF NOT ( CIC-COD-TCIC IN CIC = 'C' OR
                        CIC-COD-TCIC IN CIC = 'D' )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-CAI-IOPC
               ELSE
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-CIC
                   IF NOT FIO-STAT-OKS
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'CICSTAT' TO MSG-COD-TMSG
                       MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-FRM-CAI-IOPC.
      *>>>>
       FIN-VAL-FRM-CAI-IOPC.
           EXIT.
       
       VAL-FRM-IIC-IOPC SECTION.
       INI-VAL-FRM-IIC-IOPC.
      *<<< FRM_IIC_IOPC

      *     IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND            
      *        FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES            
      *         PERFORM ERR-GLS
      *         GO TO FIN-VAL-FRM-IIC-IOPC.

           IF NOT (
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES 
                  )
               GO TO FIN-VAL-FRM-IIC-IOPC.

           PERFORM VAL-CON-ARC.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-FRM-IIC-IOPC.

           PERFORM VAL-ARC-IGUA VARYING WSS-IFLD FROM 1 BY 1
                      UNTIL WSS-IFLD > WSS-IMAX OR 
                            MSG-COD-MENS > SPACES.

           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'   TO MSG-COD-SIST
               MOVE 'ARC=S' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPC.

      * ASIGNA NRO CREDITO
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND            
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES
      *FLB CST  6-OCT-1994 
                  AND 
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE 
              )
      *FLB CST  6-OCT-1994 
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                    CIC-CAI-ICIC IN CIC
               PERFORM PRO-CIC-OPC
               PERFORM LEE-QUE
               MOVE 'A' TO QUE-ARC-IND-IOPC 
                                     IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) TO 
                    QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE QUE-ARC-VARI TO QUE-ITEM
               IF QUE-STAT NOT = QUE-STAT-OKS
                   MOVE QUE-PUT TO QUE-CMND
                   PERFORM GNS-PRO-QUE
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
                   MOVE QUE-MOD TO QUE-CMND                   
                   PERFORM GNS-PRO-QUE
                   GO TO FIN-VAL-FRM-IIC-IOPC.

      * DIGITA NRO CREDITO O CAMBIO EL NUMERO ASIGNADO
           PERFORM LEE-QUE.
           IF QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) NOT = 'A' AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES OR
              ( FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) NOT =
                QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD) OR 
                FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) NOT = 
                QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
              ) 
               MOVE 'D' TO QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-CAI-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-CAI-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE FRM-IIC-IOPC     IN ARC-FLD(FRM-IFLD) TO
                    QUE-ARC-IIC-IOPC IN QUE-ARC-VARI(FRM-IFLD)
               MOVE QUE-ARC-VARI TO QUE-ITEM
               MOVE QUE-MOD TO QUE-CMND                   
               PERFORM GNS-PRO-QUE.

      * VALIDA QUE NRO CREDITO DIGITADO (NO PARA ASIGNADO) EXISTA Y ESTE
      * VIGENTE
      *AMP-INI   3-NOV-1993
           MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                CIC-CAI-ICIC IN CIC.
      *AMP-FIN   3-NOV-1993
           IF QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) = 'D' AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
      *FLB CST  6-OCT-1994 
      *AMP-INI   3-NOV-1993
      *       AND ( CIC-COD-TCIC IN CIC = 'C' OR 'D' )
              AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR NOT USA-CTE )
      *AMP-FIN   3-NOV-1993
               MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                    OPC-CAI-IOPC IN OPC
               MOVE FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) TO 
                    OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
               IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    YACAN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IOPC
               ELSE
                   GO TO FIN-VAL-FRM-IIC-IOPC.

      *FIN IAS

      *AMP-INI  9-OCT-1993
      * VALIDA LA CTA-CTE 
      *FLB CST  6-OCT-1994 
      *     IF ( FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
            IF ( FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
      *SMC-INI 26-10-1993 
                WSS-CIC-TOOC = 'CTE' AND USA-CTE )
      *SMC-FIN 26-10-1993 
               PERFORM BUSCO-CTA-CTE
               IF WSS-CTA-CTE > ZEROES
                   IF NOT ( RCO-COD-TOPR IN RCO =
                            FRM-COD-TOOC IN ARC-FLD (FRM-IFLD) AND
                            RCO-COD-AOPR IN RCO =
                            FRM-COD-AOOC IN ARC-FLD (FRM-IFLD) )
                       MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                   ELSE
                       MOVE 'TAB' TO TAB-COD-SIST
                       MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                       MOVE RCO-COD-TOPR IN RCO TO
                            TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB TO TIO
                       IF TIO-GLS-SIST IN TIO NOT = 'CTE'
                           MOVE 'CICTIOPNOSIS' TO MSG-COD-MENS
                       ELSE
                           PERFORM VAL-CTA-CTE
                           IF CTE-STAT-OKS
                               IF ( OPE-COD-VCOP IN OPE NOT =
                                  FRM-COD-VCOC IN ARC-FLD (FRM-IFLD) )
                                   MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                               ELSE
                                   NEXT SENTENCE
                           ELSE
                               IF MSG-COD-MENS > SPACES
                                   NEXT SENTENCE
                               ELSE
                                   MOVE 'IFBCPFAIL' TO MSG-COD-MENS
               ELSE
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
           ELSE
               NEXT SENTENCE.
      *SMC-FIN 26-10-1993 INDENTADO OK POR FLB  6-OCT-1994 
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'         TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IOPC.
      *>>>>
       FIN-VAL-FRM-IIC-IOPC.
           EXIT.
       
       VAL-CON-FLD-ARC SECTION.
       INI-VAL-CON-FLD-ARC.
       FIN-VAL-CON-FLD-ARC.
           EXIT.
       
       VAL-CON-ARC SECTION.
       INI-VAL-CON-ARC.
      *<<<< VAL_CON_ARC
      *FLB CST  6-OCT-1994 REVISADA TODA LA SECCION
      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              ( FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES 
              ) AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE 
              )
               MOVE 'IICIOPC>0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-ARC.

           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES
               GO TO FIN-VAL-CON-ARC.

      * FALTA IIC
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              ( WSS-VSN-AOPC NOT = 'S' OR WSS-CIC-TOOC = 'CTE' AND
                USA-CTE )
               PERFORM ERR-GLS
               GO TO FIN-VAL-CON-ARC.

      * OTORGARA EL IIC
           IF FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) NOT > ZEROES AND
              WSS-VSN-AOPC = 'S'
               GO TO FIN-VAL-CON-ARC.

      *FLB CST  6-OCT-1994 PARECE REDUNDANTE
           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) = SPACES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) = SPACES AND
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) = SPACES
               GO TO FIN-VAL-CON-ARC.

           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES
               GO TO FIN-VAL-CON-ARC.

           IF FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
               MOVE 'ERRCONARC'  TO MSG-COD-MENS
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
               MOVE 'S' TO FRM-UCUR
               GO TO ERR-VAL-CON-ARC.

      *FLB CST  17-OCT-1994 
      *    IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES
           IF FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES AND
              WSS-VSN-AXOB NOT = 'S'
               GO TO FIN-VAL-CON-ARC.

           MOVE 'ERRCONARC'  TO MSG-COD-MENS.
           MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD).
           MOVE 'S' TO FRM-UCUR.
       ERR-VAL-CON-ARC.
           MOVE 'DEU'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-CON-ARC.
           EXIT.
       
       VAL-NUM-KEY-ARC SECTION.
       INI-VAL-NUM-KEY-ARC.
           PERFORM VAL-NUM-IKY-ARC.
           PERFORM VAL-NUM-MKY-ARC.
           PERFORM VAL-NUM-AKY-ARC.
       FIN-VAL-NUM-KEY-ARC.
           EXIT.
       
       VAL-NUM-IKY-ARC SECTION.
       INI-VAL-NUM-IKY-ARC.
       VAL-NUM-LDC-IIC-ICLF.
           MOVE LDC-IIC-ICLF-ALF IN ARC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-IIC-ICLF IN ARC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-IIC-ICLF-LEN IN ARC-FLD
                GO TO FIN-VAL-NUM-IKY-ARC.
       VAL-NUM-LDC-NUM-ILDC.
           MOVE LDC-NUM-ILDC-ALF IN ARC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO LDC-NUM-ILDC IN ARC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO LDC-NUM-ILDC-LEN IN ARC-FLD
                GO TO FIN-VAL-NUM-IKY-ARC.
       FIN-VAL-NUM-IKY-ARC.
           EXIT.
       
       VAL-NUM-MKY-ARC SECTION.
       INI-VAL-NUM-MKY-ARC.
       FIN-VAL-NUM-MKY-ARC.
           EXIT.
       
       VAL-NUM-AKY-ARC SECTION.
       INI-VAL-NUM-AKY-ARC.
       FIN-VAL-NUM-AKY-ARC.
           EXIT.
       
       VAL-NUM-FLD-ARC SECTION.
       INI-VAL-NUM-FLD-ARC.
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN ARC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO DBC-NUM-ICLI IN ARC-FLD
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO DBC-NUM-ICLI-LEN IN ARC-FLD
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-1.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(1)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(1)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-2.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(2)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(2)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-3.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(3)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(3)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-4.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(4)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(4)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-5.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(5)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(5)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-6.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(6)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(6)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-7.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(7)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(7)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-8.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(8) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(8)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(8)
                GO TO FIN-VAL-NUM-FLD-ARC.
       VAL-NUM-FRM-IIC-IOPC-9.
           MOVE FRM-IIC-IOPC-ALF IN ARC-FLD(9) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO FRM-IIC-IOPC IN ARC-FLD(9)
           ELSE
               MOVE NUM-MENS     TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -9 TO FRM-IIC-IOPC-LEN IN ARC-FLD(9)
                GO TO FIN-VAL-NUM-FLD-ARC.
       FIN-VAL-NUM-FLD-ARC.
           EXIT.
       
       EDT-KEY-ARC SECTION.
       INI-EDT-KEY-ARC.
           PERFORM EDT-IKY-ARC.
           PERFORM EDT-MKY-ARC.
           PERFORM EDT-AKY-ARC.
       FIN-EDT-KEY-ARC.
           EXIT.
       
       EDT-IKY-ARC SECTION.
       INI-EDT-IKY-ARC.
           IF LDC-IIC-ICLF-LEN IN ARC-FLD = -9
                MOVE -1 TO LDC-IIC-ICLF-LEN IN ARC-FLD
                GO TO FIN-EDT-IKY-ARC.
           MOVE LDC-IIC-ICLF IN ARC-FLD TO LDC-IIC-ICLF-EDT IN ARC-EDT.
           MOVE LDC-IIC-ICLF-EDT IN ARC-EDT TO 
                LDC-IIC-ICLF-ALF IN ARC-FLD.
           IF LDC-NUM-ILDC-LEN IN ARC-FLD = -9
                MOVE -1 TO LDC-NUM-ILDC-LEN IN ARC-FLD
                GO TO FIN-EDT-IKY-ARC.
           MOVE LDC-NUM-ILDC IN ARC-FLD TO LDC-NUM-ILDC-EDT IN ARC-EDT.
           MOVE LDC-NUM-ILDC-EDT IN ARC-EDT TO 
                LDC-NUM-ILDC-ALF IN ARC-FLD.
       FIN-EDT-IKY-ARC.
           EXIT.
       
       EDT-MKY-ARC SECTION.
       INI-EDT-MKY-ARC.
       FIN-EDT-MKY-ARC.
           EXIT.
       
       EDT-AKY-ARC SECTION.
       INI-EDT-AKY-ARC.
       FIN-EDT-AKY-ARC.
           EXIT.
       
       EDT-FLD-ARC SECTION.
       INI-EDT-FLD-ARC.
           IF DBC-NUM-ICLI-LEN IN ARC-FLD = -9
                MOVE -1 TO DBC-NUM-ICLI-LEN IN ARC-FLD
                GO TO FIN-EDT-FLD-ARC.
           MOVE DBC-NUM-ICLI IN ARC-FLD TO DBC-NUM-ICLI-EDT IN ARC-EDT.
           MOVE DBC-NUM-ICLI-EDT IN ARC-EDT TO 
                DBC-NUM-ICLI-ALF IN ARC-FLD.
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(1) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(1)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(1) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(1).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(1) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(1).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(2) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(2)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(2) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(2).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(2) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(2).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(3) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(3)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(3) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(3).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(3) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(3).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(4) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(4)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(4) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(4).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(4) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(4).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(5) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(5)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(5) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(5).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(5) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(5).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(6) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(6)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(6) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(6).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(6) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(6).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(7) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(7)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(7) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(7).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(7) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(7).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(8) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(8)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(8) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(8).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(8) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(8).
           IF FRM-IIC-IOPC-LEN IN ARC-FLD(9) = -9
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(9)
                GO TO FIN-EDT-FLD-ARC.
           MOVE FRM-IIC-IOPC IN ARC-FLD(9) TO 
                FRM-IIC-IOPC-EDT IN ARC-EDT(9).
           MOVE FRM-IIC-IOPC-EDT IN ARC-EDT(9) TO 
                FRM-IIC-IOPC-ALF IN ARC-FLD(9).
       FIN-EDT-FLD-ARC.
           EXIT.
      *<<<< EOF_BU OR PGM_VMS

       VAL-FLD-IDX SECTION.
       INI-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-TOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-COD-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-CAI-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.
           PERFORM VAL-FRM-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO FRM-IIC-IOPC-LEN IN ARC-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-IDX.

           PERFORM VAL-CON-ARC-LDC.
       FIN-VAL-FLD-IDX.
           EXIT.

      * INI IAS

       PRO-CIC-OPC SECTION.
       INI-PRO-CIC-OPC.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-OPC
           ELSE
              MOVE CIC-CAI-ICIC TO OPC-CAI-IOPC IN OPC
              MOVE CIC-IIC-ICIC TO OPC-IIC-IOPC IN OPC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-OPC
              IF FIO-STAT-OKS
                  GO TO INI-PRO-CIC-OPC
              ELSE
                  MOVE CIC-CAI-ICIC TO FRM-CAI-IOPC 
                                         IN ARC-FLD(FRM-IFLD)
                  MOVE CIC-IIC-ICIC TO FRM-IIC-IOPC 
                                         IN ARC-FLD(FRM-IFLD).
       FIN-PRO-CIC-OPC.
           EXIT.

      *FIN IAS
      *AMP-INI  9-OCT-1993  
       BUSCO-CTA-CTE SECTION.
       INI-BUSCO-CTA-CTE.
           MOVE ZEROES TO WSS-CTA-CTE.
           MOVE LDC-CAI-ICLF IN ARC-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE LDC-IIC-ICLF IN ARC-FLD TO RDC-IIC-ICLF IN RDC.
           MOVE SPACES                  TO RDC-CIC-ICLI IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN ARC-FLD = RDC-CAI-ICLF IN RDC AND
              LDC-IIC-ICLF IN ARC-FLD = RDC-IIC-ICLF IN RDC )
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO FIN-BUSCO-CTA-CTE.
       LUP-BUSCO-CTA-CTE.
           MOVE RDC-CIC-ICLI IN RDC     TO RCO-CIC-ICLI IN RCO.
           MOVE FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) TO
                RCO-CAI-IOPE IN RCO.
           MOVE FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) TO
                RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'RCO    NEX' TO MSG-COD-MENS
               GO TO NXT-BUSCO-CTA-CTE
           ELSE
               IF RCO-COD-STAT IN RCO NOT = 'VIG'
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
                   GO TO NXT-BUSCO-CTA-CTE
               ELSE
                   MOVE 99 TO WSS-CTA-CTE.
           IF WSS-CTA-CTE > ZEROES
               GO TO FIN-BUSCO-CTA-CTE.
       NXT-BUSCO-CTA-CTE.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
              LDC-CAI-ICLF IN ARC-FLD = RDC-CAI-ICLF IN RDC AND
              LDC-IIC-ICLF IN ARC-FLD = RDC-IIC-ICLF IN RDC )
                   GO TO LUP-BUSCO-CTA-CTE.
       FIN-BUSCO-CTA-CTE.
           EXIT.

       VAL-CTA-CTE SECTION.
       INI-VAL-CTA-CTE.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCTOPEINEX'    TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.               

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VLR '               TO TAB-COD-TTAB IN TAB.
           MOVE  OPE-COD-VCOP IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCVLRINEX'      TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.               

           MOVE TAB-EXT-CTAB IN TAB TO CTE-MONE.
           MOVE 'READ'              TO CTE-TOPE.
           MOVE RCO-CIC-IOPE IN RCO TO CTE-NCTA.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'AUX '               TO TAB-COD-TTAB IN TAB.
           MOVE  RCO-COD-COPR IN RCO TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              NEXT SENTENCE
           ELSE
              MOVE 'OSCAUXINEX'      TO MSG-COD-MENS
              GO TO FIN-VAL-CTA-CTE.               

           MOVE TAB-EXT-CTAB IN TAB TO CTE-TAUX.

      *<<<< NOT PGM_PER
           MOVE 'LDCPSCTE' TO SYS-PROG
      *>>>>
           MOVE CTE-CMMA   TO SYS-CMMA.
           MOVE CTE-TCMA   TO SYS-TCMA.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO CTE-CMMA.
       FIN-VAL-CTA-CTE.
           EXIT.
      *AMP-FIN  9-OCT-1993  

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
       VAL-CON-ARC-LDC SECTION.
       INI-VAL-CON-ARC-LDC.
           PERFORM LEE-QUE.
           IF TLC-VSN-TIPO IN TLC-VARI NOT = 'S' OR
              NOT (
              FRM-COD-VCOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-CAI-IOPC IN ARC-FLD(FRM-IFLD) > SPACES OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES 
                  ) OR
              FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) NOT > SPACES AND
              WSS-VSN-AOPC = 'S' AND
              QUE-ARC-IND-IOPC IN QUE-ARC-VARI(FRM-IFLD) = 'A'
               GO TO NO-LDC-TIPO.

      *VALIDA ARC EN FAMILIA
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD
           IF ( FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES )
                  AND
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE' 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCEXIARC'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO FRM-COD-VCOC-LEN IN ARC-FLD(FRM-IFLD)
               GO TO FIN-VAL-CON-ARC-LDC.

           IF ( FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) > SPACES OR
                FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES )
               MOVE 'S' TO WSS-EXI-ARC.
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD

           MOVE LDC-COD-TIPO IN ARC-FLD           TO TLC-CODG.
           MOVE FRM-COD-TOOC IN ARC-FLD(FRM-IFLD) TO TLC-TOOC.
           MOVE FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) TO TLC-AOOC.

           IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
              TLC-TOOC NOT > SPACES
               MOVE OPC-COD-TOOC IN OPC TO TLC-TOOC
               MOVE OPC-COD-AOOC IN OPC TO TLC-AOOC.
            
           PERFORM LDC-VAL-TLC.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'          TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               IF FRM-IIC-IOPC IN ARC-FLD(FRM-IFLD) > ZEROES AND
                  TLC-TOOC NOT > SPACES
                   MOVE -1 TO FRM-CAI-IOPC-LEN IN ARC-FLD(FRM-IFLD) 
                   GO TO FIN-VAL-CON-ARC-LDC
               ELSE
               IF FRM-COD-AOOC IN ARC-FLD(FRM-IFLD) > SPACES
                   MOVE -1 TO FRM-COD-AOOC-LEN IN ARC-FLD(FRM-IFLD)
                   GO TO FIN-VAL-CON-ARC-LDC
               ELSE
                   MOVE -1 TO FRM-COD-TOOC-LEN IN ARC-FLD(FRM-IFLD) 
                   GO TO FIN-VAL-CON-ARC-LDC.

       NO-LDC-TIPO.
       FIN-VAL-CON-ARC-LDC.
           EXIT.
      *>>>>
