       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   LDCPQCLF.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 14-Mar-95 04:54 PM.

      * NOMBRE PROGRAMA                   LDCPQCLF
      * VERSION                           3.1
      * OPCION                            CON
      * ARCHIVO BASE                      LDCCLF
      * PANTALLA                          LDCCLF
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWCSCR.
       COPY GNSWVSCR.
      *<<<< PGM_BMS AND FIN_SCR_VARI
      * ISP: VARIABLES EN CMMA, COMUNES PARA ENGANCHE PROGRAMAS CLF-LDC
       COPY LDCWGENG.
           03 SCR-IND-MCLI  VALUE SPACES          PIC X(01).
           03 SCR-IND-OCIC  VALUE SPACES          PIC X(01).
      *FLB CST  9-JAN-1995 debia ser X(62)
      *    03 SCR-CLF-DISP  VALUE SPACES          PIC X(58).
           03 SCR-COD-STAT  VALUE SPACES          PIC X(01).

      *<<<< NOT PGM_ARG
           03 SCR-CLF-DIS1          VALUE SPACES  PIC X(30).
      *>>>>
           03 SCR-VAL-CMAX  COMP-3  VALUE ZEROES  PIC 9(11).
      *<<<< NOT PGM_ARG
           03 SCR-CLF-DISP  VALUE SPACES          PIC X(20).
      *>>>>
      *>>>>
       COPY LDCWICLF.

       COPY LDCBRCLF.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      * Modulo variables de trabajo para ENGANCHE
       COPY LDCWGPMP.
      * Modulo variables de trabajo para LDCPSVCL
       COPY LDCWGVCL.
      * Modulo variables de trabajo para LDCPSMCA
       COPY LDCWGMCA.

       01  PGM-VAR-ADIC.
           03 PGM-STAT-ADIC.
              05 PGM-STAT-LDC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-LDC-OKS VALUE '00'.
                 88 PGM-STAT-LDC-NUL VALUE '  '.
              05 PGM-STAT-ARC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-ARC-OKS VALUE '00'.
                 88 PGM-STAT-ARC-NUL VALUE '  '.
              05 PGM-STAT-ARG        VALUE '23'   PIC X(02).
                 88 PGM-STAT-ARG-OKS VALUE '00'.
                 88 PGM-STAT-ARG-NUL VALUE '  '.
              05 PGM-STAT-RDC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-RDC-OKS VALUE '00'.
                 88 PGM-STAT-RDC-NUL VALUE '  '.

       01  WSS-VARI.
           03 WSS-FEC-FCIE     VALUE 0            PIC 9(08).
           03 WSS-CIC-ICLF                        PIC X(12).
           03 WSS-CLA-OPE.
               05 WSS-TIP-OPE                     PIC X(03).
               05 WSS-STP-OPE                     PIC X(03).
           03 WSS-IND-PER                         PIC X(01).
           03 WSS-NUM-PER                         PIC 9(03).
           03 WSS-NDIA                            PIC 9(05).
           03 WSS-TOT-CLI      VALUE ZEROES       PIC 9(02).
           03 WSS-TOT-ARC                         PIC 9(02).
           03 WSS-TOT-ARG                         PIC 9(02).
           03 WSS-CPT-NOMB VALUE SPACES.
              05  WSS-CPT-DESC                    PIC X(27).
              05  WSS-CPT-CAI                     PIC X(04).
              05  WSS-CPT-IIC                     PIC X(08).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(39).
      * COMPONE MENSAJE DE ACUERDO A :
      *    ENTIDA A PROCESAR                 ( CLF )
      *    COMANDO QUE SE PROCESA            ( ING O MOD )
      *    ESTADO DESPUES DE APLICAR COMANDO ( I O V )
      *    ASIGNACION O NO DE CIC            ( S O N )
      *    DEBEN EXISTIR LAS COMBINACIONES DE MENSAJES RESPECTIVAS
           03  WSS-MSG-CLF.
               05 WSS-MSG-CLF-CLF                 PIC X(03).
               05 WSS-MSG-CLF-CMD                 PIC X(03).
               05 WSS-MSG-CLF-STS                 PIC X(01).
               05 WSS-MSG-CLF-CIC                 PIC X(01).
           03  LDC-KEY-ILDC.
               05 LDC-KEY-ICLF.
                  07 LDC-CAI-ICLF                 PIC X(04).
                  07 LDC-IIC-ICLF                 PIC X(08).
               05 LDC-NUM-ILDC         COMP       PIC S9(04).
           03  ARC-KEY-IARC.
               05  ARC-KEY-ILDC.
                   07  ARC-CAI-ICLF               PIC X(04).
                   07  ARC-IIC-ICLF               PIC X(08).
                   07  ARC-NUM-ILDC               PIC 9(02).
               05  ARC-NUM-IARC                   PIC 9(01).
           03  ARG-KEY-IARG.
               05  ARG-KEY-ILDC.
                   07  ARG-CAI-ICLF               PIC X(04).
                   07  ARG-IIC-ICLF               PIC X(08).
                   07  ARG-NUM-ILDC               PIC 9(02).
               05  ARG-NUM-IARG                   PIC 9(01).
           03  WSS-FEC-FVEN.
               05 WSS-NUM-SVEN                    PIC 9(02).
               05 WSS-NUM-AVEN                    PIC 9(02).
               05 WSS-NUM-MVEN                    PIC 9(02).
               05 WSS-NUM-DVEN                    PIC 9(02).
           03  WSS-FEC-FPRV.
               05  WSS-NUM-SPRV                   PIC 9(02).
               05  WSS-NUM-APRV                   PIC 9(02).
               05  WSS-NUM-MPRV                   PIC 9(02).
               05  WSS-NUM-DPRV                   PIC 9(02).
           03  WSS-FEC-FVE1.
               05 WSS-NUM-SVE1                    PIC 9(02).
               05 WSS-NUM-AVE1                    PIC 9(02).
               05 WSS-NUM-MVE1                    PIC 9(02).
               05 WSS-NUM-DVE1                    PIC 9(02).
           03  WSS-FEC-FVE2.
               05 WSS-NUM-SVE2                    PIC 9(02).
               05 WSS-NUM-AVE2                    PIC 9(02).
               05 WSS-NUM-MVE2                    PIC 9(02).
               05 WSS-NUM-DVE2                    PIC 9(02).
           03  WSS-FHOY.
               05 WSS-SHOY                        PIC 9(02).
               05 WSS-AHOY                        PIC 9(02).
               05 WSS-MHOY                        PIC 9(02).
               05 WSS-DHOY                        PIC 9(02).
           03  WSS-FEC-FPR1.
               05  WSS-NUM-SPR1                   PIC 9(02).
               05  WSS-NUM-APR1                   PIC 9(02).
               05  WSS-NUM-MPR1                   PIC 9(02).
               05  WSS-NUM-DPR1                   PIC 9(02).
      *FLB CST  13-DEC-1993 
           03 WSS-VSN-OCAI                        PIC X(01).
      *FLB CST  13-JAN-1995 
           03 VEC-CMND.
              05 CMND-ING       VALUE 'ING'       PIC X(03).
              05 CMND-MOD       VALUE 'MOD'       PIC X(03).
              05 CMND-ELI       VALUE 'ELI'       PIC X(03).
              05 CMND-CON       VALUE 'CON'       PIC X(03).
              05 CMND-VRF       VALUE 'VRF'       PIC X(03).
              05 CMND-ACA       VALUE 'ACA'       PIC X(03).
              05 CMND-CIE       VALUE 'CIE'       PIC X(03).
              05 CMND-REV       VALUE 'REV'       PIC X(03).
              05 CMND-MCA       VALUE 'MCA'       PIC X(03).
              05 CMND-MSI       VALUE 'MSI'       PIC X(03).
              05 CMND-CMX       VALUE 'CMX'       PIC X(03).
              05 CMND-REA       VALUE 'REA'       PIC X(03).

      *<<<< NOT PGM_DB2
       COPY LDCBRLDC.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY LDCBRRDC.
       COPY LDCBRLAC.
      *>>>>

       COPY TABBRCAM.

       COPY GNSBRCIC.
       COPY GNSWGCIC.
  
       COPY TABBRTIO.

       COPY SGCBRREC.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-CLF.
                 88 PGM-STAT-CLF-NUL    VALUE '  '.
                 07 PGM-STT1-CLF        VALUE '2' PIC X(01).
                    88 PGM-STAT-CLF-OKS VALUE '0'.
                 07 PGM-STT2-CLF        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(450).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CLF-FLD.
           MOVE LOW-VALUES TO CLF-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +450 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'LDCPQCLF' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< ( INI_FIO ) AND ( NOT PGM_VSI )
           PERFORM GNS-HDL-VSM.
      *>>>>
      *<<<< INI_FIO
      *FLB CST  13-JAN-1995 
           MOVE 'DEU'           TO FIO-SIST.
           MOVE 'PRM'           TO TAB-COD-TTAB IN TAB.
           MOVE 'CMNDCLF'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO VEC-CMND.

      *<<<< PGM_PQ
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-IND-MCLI
      * ORIGEN = 'C'LF
               MOVE SPACES TO SCR-VEC-ENG
               MOVE 'C' TO SCR-IND-COL
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CLF.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-IKY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-CLF
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.



       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CLF
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CLF
               PERFORM EDT-KEY-CLF
           ELSE
               PERFORM CLR-FLD-CLF
               PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-CLF.
       ERR-SCR-KEY.
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CLF-FLD.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
      * COMANDO ING, DIGITE CLAVE
           IF SCR-CCPP = 'ING' 
      *        CLF-IIC-ICLF IN CLF-FLD > ZEROES
               PERFORM FND-DIRECTO
               GO TO FIN-FND-KEY.

           MOVE ZEROES TO WSS-TOT-CLI.
           IF CLF-IIC-ICLF IN CLF-FLD > ZEROES
      *       SE DIGITO LO NECESARIO PARA BUSCAR DIRECTO
               PERFORM FND-DIRECTO
               IF FIO-STAT-OKS
                  PERFORM GET-CUR-RDC
                  IF NOT PGM-STAT-RDC-OKS
      *    CLF no tiene RDC asociado
                     MOVE 'DEU' TO MSG-COD-SIST
                     MOVE 'CLF    NORDC' TO MSG-COD-MENS
                     MOVE SCR-STAT-CON TO SCR-STAT
                     GO TO ERR-FND-KEY
                  ELSE
                    MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
      *KEY-CLI BUSCA CLIENTE POR MEDIO DE CIC
                    MOVE 'DBC-KEY-IDBC'  TO FIO-AKEY
                    MOVE FIO-GET-KEY TO FIO-CMND
                    PERFORM SGC-FIO-DBC
                    MOVE FIO-STAT TO PGM-STAT-DBC
                    IF NOT FIO-STAT-OKS
      *        cliente inexistente
                       MOVE 'TAB'        TO MSG-COD-SIST
                       MOVE 'CLI    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO PGM-STAT-DBC
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                    ELSE
                       PERFORM GET-NXT-RDC
                       GO TO EXA-COM-STAT
               ELSE
                   MOVE 'CLF    NEX' TO MSG-COD-MENS
                   GO TO ERR-FND-KEY.

      *    BUSCA EL PADRE POR ALGUNA DE LAS LLAVES (LA DIGITADA)
           IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES
      *IDC-CLI BUSCA CLIENTE POR MEDIO DE IDC
               MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF FIO-STAT-OKS
                   GO TO CON-BUS-DBC.

           IF DBC-GLS-NOMC IN CLF-FLD > SPACES
      *NOM-CLI BUSCA CLIENTE POR MEDIO DEL NOMBRE
               MOVE DBC-GLS-NOMC IN CLF-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO
                    DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO
                    DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO
                    DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC'   TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF FIO-STAT-OKS
                   GO TO CON-BUS-DBC.

           MOVE 'TAB'        TO MSG-COD-SIST.
           MOVE 'CLI    NEX' TO MSG-COD-MENS.
           GO TO AFT-SIS-ERR-FND-KEY.

       CON-BUS-DBC.
      *    SE ENCONTRO EL DBC Y BUSCA EL CLF
           MOVE '00' TO PGM-STAT-DBC.
           PERFORM BUS-CLF.
           IF MSG-COD-MENS > SPACES
               GO TO ERR-FND-KEY
           ELSE
               GO TO EXA-COM-STAT.

       FND-DIRECTO.
      *>>>>
           PERFORM KEY-ALL-CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF.
      *<<<< FIN_FND_KEY
       EXA-COM-STAT.
       FIN-ANL-CLF.
           MOVE PGM-STAT-CLF TO FIO-STAT.

      * EXAMINA STATUS DE REGISTRO

           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON
               GO TO FIN-FND-KEY.

           IF SCR-CMND = CMND-REA AND
              CLF-MSC-STAT IN CLF = 'C' 
               GO TO FIN-FND-KEY.

           IF SCR-CMND = CMND-REA
               MOVE 'CLF    NOCER' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           IF SCR-CMND NOT = CMND-REA AND
              CLF-MSC-STAT IN CLF = 'C' 
               MOVE 'CLF    EXTING' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           IF CLF-MSC-STAT IN CLF = 'R'
               MOVE 'CLF    MCAYA' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

      *FLB CST  9-JAN-1995 
           MOVE CLF-VAL-CMAX IN CLF TO SCR-VAL-CMAX IN SCR-VARI.

           IF CLF-MSC-STAT IN CLF = 'A' AND SCR-CMND = CMND-MCA
      *FLB CST  9-JAN-1995 
           OR CLF-MSC-STAT IN CLF = 'A' AND SCR-CMND = CMND-MSI
           OR CLF-MSC-STAT IN CLF = 'A' AND SCR-CMND = CMND-CMX
           OR CLF-MSC-STAT IN CLF = 'A' AND SCR-CMND = CMND-CIE
           OR CLF-MSC-STAT IN CLF = 'A' AND SCR-CMND = CMND-REV
               IF SCR-CMND = CMND-MSI
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'PROMPTMSI'  TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO FIN-FND-KEY.

           IF SCR-CMND = 'MCA'
      *FLB CST  9-JAN-1995 
           OR SCR-CMND = CMND-MSI
           OR SCR-CMND = CMND-CMX
           OR SCR-CMND = CMND-CIE
           OR SCR-CMND = CMND-REV
              MOVE 'CLF   NOACA' TO MSG-COD-MENS
              GO TO ERR-FND-KEY.

           IF CLF-MSC-STAT IN CLF = 'A'
               MOVE 'CLF    ACAYA' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           IF CLF-MSC-STAT IN CLF = 'V' AND SCR-CMND = CMND-ACA
               GO TO FIN-FND-KEY.

           IF SCR-CMND = CMND-ACA
               MOVE 'CLF    NOVRF' TO MSG-COD-MENS
               GO TO ERR-FND-KEY.

           IF SCR-CMND = CMND-MOD
           OR SCR-CMND = CMND-VRF
           OR SCR-CMND = CMND-ELI
               GO TO FIN-FND-KEY.

           MOVE 'CLF   NOEST' TO MSG-COD-MENS.

       ERR-FND-KEY.
      *    TODOS OTROS CASOS: EL ERROR PERTENECE AL SISTEMA DEU
           MOVE 'DEU' TO MSG-COD-SIST.
       AFT-SIS-ERR-FND-KEY.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.

           IF SCR-CCPP = 'ING'
               MOVE '00' TO PGM-STAT-CLF
               MOVE '00' TO FIO-STAT
           ELSE
               MOVE '23' TO PGM-STAT-CLF
               MOVE '23' TO FIO-STAT.

           IF NOT (
                   PGM-STAT-DBC-OKS OR
                   PGM-STAT-CLF-OKS
                  )
               MOVE SCR-STAT-ABT TO SCR-STAT
               GO TO FIN-FND-KEY.

      * DESPLIEGA DATOS DEL CLF
      *                   O DBC

           MOVE SCR-STAT-CON TO SCR-STAT.
      * JVM: No limpia llaves al desplegar msg de error
           MOVE PGM-NO-LIMPIAR-NADA TO PGM-ICLR.
      *     PERFORM SCR-CLRA-CLF.
           IF PGM-STAT-DBC-OKS
               PERFORM PUT-DBC-CLF.

           IF PGM-STAT-CLF-OKS
               PERFORM PUT-CLF-CLF.

           GO TO FIN-FND-KEY.
      *>>>>
       FIN-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
      *<<<< PUT_SCR 
           IF SCR-CMND = CMND-REA
               PERFORM VAL-CON-RDC-CLF
               IF MSG-COD-MENS > SPACES
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE SCR-STAT-CON TO SCR-STAT
      *AMP-INI  20-OCT-1993
                   GO TO FIN-PUT-SCR
               ELSE
                   MOVE CLF-CAI-ICLF IN CLF-FLD TO
                        CLF-CAI-ICLF IN CLF
                   MOVE CLF-IIC-ICLF IN CLF-FLD TO
                        CLF-IIC-ICLF IN CLF
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM LDC-FIO-CLF
           ELSE
               NEXT SENTENCE.
      *AMP-FIN  20-OCT-1993
      *>>>>
           PERFORM PUT-ALL-CLF.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CLF-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CLF-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CLF
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CLF.
           PERFORM VAL-IKY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-CLF.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CLF.
       ERR-SCR-GKEY.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-CLF
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-CLF.
           PERFORM VAL-IKY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-CLF.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-CLF.
       ERR-SCR-GIKY.
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CLF-GLS-MEN2
               MOVE SCR-PRMT     TO CLF-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CLF-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF SCR-DESDE-CMN
               MOVE CLF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CLF-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-CLF

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CLF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CLF-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-MKY-CLF.
           PERFORM PRO-AKY-CLF.
           PERFORM UNP-IKY-CLF.
           PERFORM FST-KEY-CLF.
           MOVE '1' TO FRM-CPIM-AEY.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF SCR-DESDE-CMN
               MOVE CLF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CLF-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CLF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CLF-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-CLF.
           PERFORM FST-KEY-CLF.
           MOVE '1' TO FRM-CPIM-AEY.
      *<<<< FIN_HBL_KEY
      *>>>>
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-CLF.
           PERFORM PRO-AKY-CLF.
           PERFORM UNP-MKY-CLF.
           PERFORM UNP-FLD-CLF.
           PERFORM FST-FLD-CLF.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CLF-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CLF.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE SCR-INST-GAB TO SCR-INST.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       COPY LDCBQCLF.
       COPY GNSBVNUM.
       COPY LDCBFCLF.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
      *  Codigo adicional para rutina LDCPSVCL
       COPY LDCBGVCL.
       COPY LDCBKVCL.
      *  Codigo adicional para rutina LDCPSMCA
       COPY LDCBGMCA.
       COPY LDCBKMCA.

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       COPY LDCBGMPT.

      *<<<< PGM_PQ
       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-CLF.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.

      * BUSCAR MENSAJE
           MOVE SPACES TO SCR-CIC-ICLF
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-IND-COL
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CLF-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
      *>>>>
      *<<<< PGM_PQ
       BUS-CLF SECTION.
       INI-BUS-CLF.
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-CIC-ICLF IN RDC.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF NOT ( FIO-STAT-OKS AND 
                    DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC )
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    NORDC' TO MSG-COD-MENS
               GO TO BRW-BUS-CLF.

           MOVE ZEROES TO WSS-FEC-FCIE.
           MOVE RDC-CIC-ICLF IN RDC TO WSS-CIC-ICLF.
       LUP-BUS-CLF.
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN CLF-FLD.
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN CLF-FLD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               GO TO BRW-BUS-CLF.

           IF NOT ( CLF-MSC-STAT IN CLF = 'C' OR 'R' )
               GO TO BRW-BUS-CLF.

           IF CLF-FEC-FCIE IN CLF > WSS-FEC-FCIE
      *AMP-INI  27-OCT-1993
              AND CLF-MSC-STAT IN CLF NOT = 'R'
      *AMP-FIN  27-OCT-1993
               MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF
               MOVE CLF-FEC-FCIE IN CLF TO WSS-FEC-FCIE.

       NXT-BUS-CLF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF FIO-STAT-OKS AND 
              DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDC
               GO TO LUP-BUS-CLF.

           MOVE WSS-CIC-ICLF TO CLF-CIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN CLF-FLD.
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN CLF-FLD.
       BRW-BUS-CLF.
           IF PGM-STAT-RDC-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.
       FIN-BUS-CLF.
           EXIT.

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE CLF-CIC-ICLF IN CLF TO RDC-CIC-ICLF IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-CDK
               MOVE '00' TO FIO-STAT.
           IF NOT ( FIO-STAT-OKS AND
                    CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDC )
               MOVE '23' TO PGM-STAT-RDC
               IF FIO-STAT-OKS
                   MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM LDC-FIO-RDC
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '00' TO PGM-STAT-RDC
               MOVE 1 TO WSS-TOT-CLI.

       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDC
                ADD 1 TO WSS-TOT-CLI
                MOVE 'M' TO SCR-IND-MCLI
           ELSE
                MOVE SPACES TO SCR-IND-MCLI.
       FIN-GET-NXT-RDC.
           EXIT.

       GET-NXT-ARC SECTION.
       INI-GET-NXT-ARC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS AND
              ARC-KEY-ILDC IN WSS-VARI = ARC-KEY-ILDC IN ARC
              ADD 1 TO WSS-TOT-ARC.
       FIN-GET-NXT-ARC.
           EXIT.

       GET-NXT-ARG SECTION.
       INI-GET-NXT-ARG.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS AND
              ARG-KEY-ILDC IN WSS-VARI = ARG-KEY-ILDC IN ARG
              ADD 1 TO WSS-TOT-ARG.
       FIN-GET-NXT-ARG.
           EXIT.

      *>>>>
       COPY LDCBFLDC.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY LDCBFRDC.
       COPY SGCBFREC.
       COPY LDCBFLAC.

       COPY TABBFCAM.

       COPY GNSBFCIC.
       COPY GNSBGCIC.

       COPY SGCBFDBC.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBGCLI.
       COPY GNSBPFEC.

      *>>>>
