       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   LDCPUCLF.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 14-Mar-95 04:58 PM.

      * NOMBRE PROGRAMA                   LDCPUCLF
      * VERSION                           3.1
      * OPCION                            UPD
      * ARCHIVO BASE                      LDCCLF
      * PANTALLA                          LDCCLF
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWCSCR.
       COPY GNSWVSCR.
      *<<<< PGM_BMS AND FIN_SCR_VARI
      * ISP: VARIABLES EN CMMA, COMUNES PARA ENGANCHE PROGRAMAS CLF-LDC
       COPY LDCWGENG.
           03 SCR-IND-MCLI  VALUE SPACES          PIC X(01).
           03 SCR-IND-OCIC  VALUE SPACES          PIC X(01).
      *FLB CST  9-JAN-1995 debia ser X(62)
      *    03 SCR-CLF-DISP  VALUE SPACES          PIC X(58).
           03 SCR-COD-STAT  VALUE SPACES          PIC X(01).

      *<<<< NOT PGM_ARG
           03 SCR-CLF-DIS1          VALUE SPACES  PIC X(30).
      *>>>>
           03 SCR-VAL-CMAX  COMP-3  VALUE ZEROES  PIC 9(11).
      *<<<< NOT PGM_ARG
           03 SCR-CLF-DISP  VALUE SPACES          PIC X(20).
      *>>>>
      *>>>>
       COPY LDCWICLF.
       COPY LDCBRCLF.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      * Modulo variables de trabajo para ENGANCHE
       COPY LDCWGPMP.
      * Modulo variables de trabajo para LDCPSVCL
       COPY LDCWGVCL.
      * Modulo variables de trabajo para LDCPSMCA
       COPY LDCWGMCA.

       01  PGM-VAR-ADIC.
           03 PGM-STAT-ADIC.
              05 PGM-STAT-LDC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-LDC-OKS VALUE '00'.
                 88 PGM-STAT-LDC-NUL VALUE '  '.
              05 PGM-STAT-ARC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-ARC-OKS VALUE '00'.
                 88 PGM-STAT-ARC-NUL VALUE '  '.
              05 PGM-STAT-ARG        VALUE '23'   PIC X(02).
                 88 PGM-STAT-ARG-OKS VALUE '00'.
                 88 PGM-STAT-ARG-NUL VALUE '  '.
              05 PGM-STAT-RDC        VALUE '23'   PIC X(02).
                 88 PGM-STAT-RDC-OKS VALUE '00'.
                 88 PGM-STAT-RDC-NUL VALUE '  '.

       01  WSS-VARI.
      *<<<< PGM_PU
      *LTM-INI 30-04-1994
           03 WSS-TRMO         VALUE 0            PIC 9(03).
      *LTM-FIN 30-04-1994
      *SMC-INI 26-10-1993
           03 WSS-VSN-VCTG                        PIC X(01).
               88  USA-CTG     VALUE 'N'.
      *SMC-FIN 26-10-1993
      *>>>>
           03 WSS-FEC-FCIE     VALUE 0            PIC 9(08).
           03 WSS-CIC-ICLF                        PIC X(12).
           03 WSS-CLA-OPE.
               05 WSS-TIP-OPE                     PIC X(03).
               05 WSS-STP-OPE                     PIC X(03).
           03 WSS-IND-PER                         PIC X(01).
           03 WSS-NUM-PER                         PIC 9(03).
           03 WSS-NDIA                            PIC 9(05).
           03 WSS-TOT-CLI      VALUE ZEROES       PIC 9(02).
           03 WSS-TOT-ARC                         PIC 9(02).
           03 WSS-TOT-ARG                         PIC 9(02).
           03 WSS-CPT-NOMB VALUE SPACES.
              05  WSS-CPT-DESC                    PIC X(27).
              05  WSS-CPT-CAI                     PIC X(04).
              05  WSS-CPT-IIC                     PIC X(08).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(39).
      * COMPONE MENSAJE DE ACUERDO A :
      *    ENTIDA A PROCESAR                 ( CLF )
      *    COMANDO QUE SE PROCESA            ( ING O MOD )
      *    ESTADO DESPUES DE APLICAR COMANDO ( I O V )
      *    ASIGNACION O NO DE CIC            ( S O N )
      *    DEBEN EXISTIR LAS COMBINACIONES DE MENSAJES RESPECTIVAS
           03  WSS-MSG-CLF.
               05 WSS-MSG-CLF-CLF                 PIC X(03).
               05 WSS-MSG-CLF-CMD                 PIC X(03).
               05 WSS-MSG-CLF-STS                 PIC X(01).
               05 WSS-MSG-CLF-CIC                 PIC X(01).
           03  LDC-KEY-ILDC.
               05 LDC-KEY-ICLF.
                  07 LDC-CAI-ICLF                 PIC X(04).
                  07 LDC-IIC-ICLF                 PIC X(08).
               05 LDC-NUM-ILDC         COMP       PIC S9(04).
           03  ARC-KEY-IARC.
               05  ARC-KEY-ILDC.
                   07  ARC-CAI-ICLF               PIC X(04).
                   07  ARC-IIC-ICLF               PIC X(08).
                   07  ARC-NUM-ILDC               PIC 9(02).
               05  ARC-NUM-IARC                   PIC 9(01).
           03  ARG-KEY-IARG.
               05  ARG-KEY-ILDC.
                   07  ARG-CAI-ICLF               PIC X(04).
                   07  ARG-IIC-ICLF               PIC X(08).
                   07  ARG-NUM-ILDC               PIC 9(02).
               05  ARG-NUM-IARG                   PIC 9(01).
           03  WSS-FEC-FVEN.
               05 WSS-NUM-SVEN                    PIC 9(02).
               05 WSS-NUM-AVEN                    PIC 9(02).
               05 WSS-NUM-MVEN                    PIC 9(02).
               05 WSS-NUM-DVEN                    PIC 9(02).
           03  WSS-FEC-FPRV.
               05  WSS-NUM-SPRV                   PIC 9(02).
               05  WSS-NUM-APRV                   PIC 9(02).
               05  WSS-NUM-MPRV                   PIC 9(02).
               05  WSS-NUM-DPRV                   PIC 9(02).
           03  WSS-FEC-FVE1.
               05 WSS-NUM-SVE1                    PIC 9(02).
               05 WSS-NUM-AVE1                    PIC 9(02).
               05 WSS-NUM-MVE1                    PIC 9(02).
               05 WSS-NUM-DVE1                    PIC 9(02).
           03  WSS-FEC-FVE2.
               05 WSS-NUM-SVE2                    PIC 9(02).
               05 WSS-NUM-AVE2                    PIC 9(02).
               05 WSS-NUM-MVE2                    PIC 9(02).
               05 WSS-NUM-DVE2                    PIC 9(02).
           03  WSS-FHOY.
               05 WSS-SHOY                        PIC 9(02).
               05 WSS-AHOY                        PIC 9(02).
               05 WSS-MHOY                        PIC 9(02).
               05 WSS-DHOY                        PIC 9(02).
           03  WSS-FEC-FPR1.
               05  WSS-NUM-SPR1                   PIC 9(02).
               05  WSS-NUM-APR1                   PIC 9(02).
               05  WSS-NUM-MPR1                   PIC 9(02).
               05  WSS-NUM-DPR1                   PIC 9(02).
      *<<<< PGM_PU
           03 WSS-VAL-RSG1        COMP-3          PIC S9(11)V9(4).
           03 WSS-VAL-RSG2        COMP-3          PIC S9(11)V9(4).
      *HPM ini 9-FEB-1994
           03 WSS-VAL-CMP-USD     COMP-3          PIC S9(11)V9(4).
      *HPM fin 9-FEB-1994
           03 WSS-VAL-CMAX-USD    COMP-3          PIC S9(11)V9(4).
           03 WSS-VAL-RSG1-USD    COMP-3          PIC S9(11)V9(4).
           03 WSS-VAL-RSG2-USD    COMP-3          PIC S9(11)V9(4).
           03 WSS-COD-USD                         PIC X(06).
           03 WSS-SGV-VCAM        COMP-3          PIC S9(11)V9(4).
           03 WSS-CIC-TOCF                        PIC X(06).
           03 WSS-EXISTE-GRUPO                    PIC 9(02).
      *AMP-INI 24-NOV-1993
           03 WSS-COD1                            PIC X(06).
           03 WSS-COD2                            PIC X(06).
           03 WSS-COD-MNAC                        PIC X(06).
           03 WSS-SAL1           COMP-3           PIC S9(11)V9(4).
      *AMP-INI 24-NOV-1993
      *>>>>
      *FLB CST  13-DEC-1993 
           03 WSS-VSN-OCAI                        PIC X(01).
      *FLB CST  13-JAN-1995 
           03 VEC-CMND.
              05 CMND-ING       VALUE 'ING'       PIC X(03).
              05 CMND-MOD       VALUE 'MOD'       PIC X(03).
              05 CMND-ELI       VALUE 'ELI'       PIC X(03).
              05 CMND-CON       VALUE 'CON'       PIC X(03).
              05 CMND-VRF       VALUE 'VRF'       PIC X(03).
              05 CMND-ACA       VALUE 'ACA'       PIC X(03).
              05 CMND-CIE       VALUE 'CIE'       PIC X(03).
              05 CMND-REV       VALUE 'REV'       PIC X(03).
              05 CMND-MCA       VALUE 'MCA'       PIC X(03).
              05 CMND-MSI       VALUE 'MSI'       PIC X(03).
              05 CMND-CMX       VALUE 'CMX'       PIC X(03).
              05 CMND-REA       VALUE 'REA'       PIC X(03).

      *<<<< NOT PGM_DB2
       COPY LDCBRLDC.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY LDCBRRDC.
       COPY LDCBRLAC.
      *>>>>

       COPY TABBRCAM.

       COPY GNSBRCIC.
       COPY GNSWGCIC.
  
       COPY TABBRTIO.

       COPY SGCBRREC.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-CLF.
                 88 PGM-STAT-CLF-NUL    VALUE '  '.
                 07 PGM-STT1-CLF        VALUE '2' PIC X(01).
                    88 PGM-STAT-CLF-OKS VALUE '0'.
                 07 PGM-STT2-CLF        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(450).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO CLF-FLD.
           MOVE LOW-VALUES TO CLF-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +450 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'LDCPUCLF' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< ( INI_FIO ) AND ( NOT PGM_VSI )
           PERFORM GNS-HDL-VSM.
      *>>>>
      *<<<< INI_FIO
      *FLB CST  13-JAN-1995 
           MOVE 'DEU'           TO FIO-SIST.
           MOVE 'PRM'           TO TAB-COD-TTAB IN TAB.
           MOVE 'CMNDCLF'       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO VEC-CMND.

      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-CLF.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-IKY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.



       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-CLF
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-CLF
               PERFORM EDT-KEY-CLF
           ELSE
               PERFORM CLR-FLD-CLF
               PERFORM EDT-FLD-CLF.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO CLF-FLD.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
           IF SCR-CMND = CMND-MCA OR CMND-MSI
               PERFORM LDC-PRO-MCA
               IF MSG-COD-MENS > SPACES AND 
                  MSG-COD-MENS NOT = 'MCAOK' AND
                  MSG-COD-MENS NOT = 'MSIOK'
                   GO TO FIN-CMN-MOD.
      *>>>>
           PERFORM KEY-ALL-CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< CMN_MOD_RET
      *FLB BCP  13-JAN-1995 
           IF SCR-CMND = CMND-ACA OR CMND-REV OR CMND-CMX
               MOVE 'A' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
           IF SCR-CMND = CMND-CIE
               MOVE 'C' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
           IF SCR-CMND = CMND-MCA OR CMND-MSI
               MOVE CLF-CAI-CREN IN CLF TO CLF-CAI-CREN IN CLF-FLD
               MOVE CLF-IIC-CREN IN CLF TO CLF-IIC-CREN IN CLF-FLD
               MOVE 'I' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
               MOVE 'I' TO CLF-MSC-STAT IN CLF-FLD.
      *>>>>
           PERFORM RET-STT-CLF.
           PERFORM RET-ALL-CLF.
           PERFORM RET-HDR-CLF.
      *<<<< CMN_MOD
      *FLB CST  9-JAN-1995 REVISADO PARA MSI
      *FLB CST  21-SEP-1994 CCU FUNCIONE LUEGO MCA/MSI Y ANTES ACA
           IF SCR-CMND = CMND-ACA
               MOVE SPACES TO CLF-COD-STAT IN CLF
           ELSE
           IF SCR-CMND = CMND-MCA
               MOVE 'M' TO CLF-COD-STAT IN CLF
               MOVE SCR-INST-HCM TO SCR-INST
           ELSE
           IF SCR-CMND = CMND-MSI
               MOVE SCR-INST-HCM TO SCR-INST
               MOVE 'X' TO CLF-COD-STAT IN CLF.
      *FLB CST  21-SEP-1994 

           MOVE 'M'      TO CLF-MSC-TACC IN CLF.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *<<<< FIN_CMN_MOD 
      *FLB CST  19-JAN-1995 
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               MOVE FIO-BCK-OUT  TO FIO-CMND
               PERFORM LDC-FIO-CLF
               GO TO FIN-CMN-MOD.
      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO CLF.
      *<<<< INI_CMN_ING
      *GET-CIC Obtener CIC
       CIC-GET-CIC-ING.
           IF CLF-IIC-ICLF IN CLF-FLD > ZEROES
      *        INDICA QUE NO INVOCO A RUTINA OBTENCION CIC
               MOVE 'N' TO SCR-IND-OCIC
           ELSE
      *        INDICA QUE SI INVOCO A RUTINA OBTENCION CIC
               MOVE 'S' TO SCR-IND-OCIC
      *FLB CST  22-DEC-1993 
      *        MOVE 'L' TO CIC-COD-TCIC IN CIC
      *        MOVE CLF-COD-OFIC IN CLF-FLD TO CIC-COD-CCIC IN CIC
               MOVE CLF-CAI-ICLF IN CLF-FLD TO CIC-CAI-ICIC IN CIC

               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CIC-ICIC TO CLF-CIC-ICLF IN CLF
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM LDC-FIO-CLF
                   IF FIO-STAT-OKS
                       GO TO CIC-GET-CIC-ING
                   ELSE
                       MOVE CIC-CAI-ICIC TO CLF-CAI-ICLF IN CLF-FLD
                       MOVE CIC-IIC-ICIC TO CLF-IIC-ICLF IN CLF-FLD.

           MOVE SPACES TO CLF-GLS-FLAG IN CLF.
           MOVE SPACES TO CLF-CAI-CREN IN CLF.
           MOVE ZEROES TO CLF-IIC-CREN IN CLF.
           MOVE ZEROES TO CLF-GLS-DISP IN CLF.

           MOVE 'I'      TO CLF-MSC-TACC IN CLF.
      *>>>>
           PERFORM RET-STT-CLF.
           PERFORM RET-ALL-CLF.
           PERFORM RET-HDR-CLF.
      *<<<< CMN_ING

           IF DBC-IND-ICLI IN CLF-FLD NOT = 'M'
              PERFORM PUT-RDC
              IF NOT FIO-STAT-OKS
                 MOVE 'DEU'        TO MSG-COD-SIST
                 MOVE 'RDC    PUT' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO FIN-CMN-ING.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN EL INGRESO : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

      *<<<< FIN_CMN_ING
      * LTM-INI 22-04-1994
           MOVE 'TAB'     TO TAB-COD-SIST.
           MOVE 'TIO'     TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN CLF-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF TAB-CIC-CTAB IN TAB = 'CGE'
               MOVE CLF-CAI-ICLF IN CLF-FLD TO LDC-CAI-ICLF IN LDC
               MOVE CLF-IIC-ICLF IN CLF-FLD TO LDC-IIC-ICLF IN LDC
               MOVE 01        TO LDC-NUM-ILDC IN LDC
               MOVE HOY-FHOY  TO LDC-FEC-FTRN IN LDC
               MOVE HOY-HHOY  TO LDC-HRA-HRTR IN LDC
               MOVE 'I'       TO LDC-MSC-TACC IN LDC
               MOVE 'I'       TO LDC-MSC-STAT IN LDC
               MOVE SCR-OTRN  TO LDC-COD-OTRN IN LDC
               MOVE SCR-USER  TO LDC-COD-ATRN IN LDC
               MOVE 'CODIGO DE GRUPO' TO LDC-GLS-DESC IN LDC
               MOVE 'COD.GRU' TO LDC-GLS-DCOR IN LDC
               MOVE CLF-VAL-CMAX IN CLF-FLD TO LDC-VAL-CMAX IN LDC
      *<<<< MON_LDC
               MOVE CLF-COD-VCCF IN CLF-FLD TO LDC-COD-VCLC IN LDC
      *<<<<
               MOVE 'S'       TO LDC-IND-MGAR IN LDC
               MOVE CLF-NUM-PVIG IN CLF-FLD TO LDC-NUM-PVIG IN LDC
               MOVE CLF-IND-PVIG IN CLF-FLD TO LDC-IND-PVIG IN LDC
               MOVE 'S'       TO LDC-IND-VIGE IN LDC
               MOVE CLF-NUM-DVEN IN CLF-FLD TO LDC-NUM-DVEN IN LDC
               MOVE CLF-NUM-MVEN IN CLF-FLD TO LDC-NUM-MVEN IN LDC
               MOVE CLF-NUM-SVEN IN CLF-FLD TO LDC-NUM-SVEN IN LDC
               MOVE CLF-NUM-AVEN IN CLF-FLD TO LDC-NUM-AVEN IN LDC
               MOVE 0         TO LDC-VAL-RSG1 IN LDC
               MOVE 0         TO LDC-VAL-RSG2 IN LDC
               MOVE SPACES    TO LDC-GLS-DISP IN LDC 
      *FLB CST  14-MAR-1995 Linea de Libre Disponibilidad
               MOVE 'DEU' TO FIO-SIST
               MOVE 'VSN'       TO TAB-COD-TTAB IN TAB
               MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
                   MOVE SPACES TO LDC-COD-TIPO IN LDC 
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM LDC-FIO-LDC
                   IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                       MOVE FIO-MENS TO FRM-MENS
                       PERFORM BCK-OUT
                       GO TO FIN-CMN-ING
                   ELSE
                       GO TO NO-ENGANCHA
               ELSE
                   MOVE 'DEU' TO FIO-SIST
                   MOVE 'TLC'   TO TAB-CIC-TTAB IN TAB
                   MOVE 'LIBRE' TO TAB-CIC-CTAB IN TAB
                   MOVE 'TAB-CIC-TABL' TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-TAB
                   IF NOT FIO-STAT-OKS
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'CICLIBRENEX' TO MSG-COD-MENS
                       PERFORM GET-MSG 
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       PERFORM BCK-OUT
                       GO TO FIN-CMN-ING
                   ELSE
                       MOVE TAB-COD-CTAB IN TAB TO LDC-COD-TIPO IN LDC
                       MOVE FIO-PUT TO FIO-CMND
                       PERFORM LDC-FIO-LDC
                       IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                           MOVE FIO-MENS TO FRM-MENS
                           PERFORM BCK-OUT
                           GO TO FIN-CMN-ING
                       ELSE
                           GO TO NO-ENGANCHA.
      *FLB CST  14-MAR-1995 FIN
      * LTM-FIN 22-04-1994

           IF DBC-IND-ICLI IN CLF-FLD = 'M'
              MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IRDC)
              MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IRDC)
           ELSE
              MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IRDC)
              MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IRDC).

           MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ILDC).
           MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ILDC).
           PERFORM EGR-FPEN-CIC.

       NO-ENGANCHA.
      *-------------
           IF PGM-STAT-CLF-OKS
               MOVE 'CLF'               TO WSS-MSG-CLF-CLF
               MOVE SCR-CCPP            TO WSS-MSG-CLF-CMD
               MOVE CLF-MSC-STAT IN CLF TO WSS-MSG-CLF-STS
               MOVE SCR-IND-OCIC        TO WSS-MSG-CLF-CIC
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE WSS-MSG-CLF TO MSG-COD-MENS
               PERFORM GET-MSG
               IF SCR-IND-OCIC = 'S'
                   MOVE CLF-CAI-ICLF IN CLF-FLD TO WSS-CPT-CAI
                   MOVE CLF-IIC-ICLF IN CLF-FLD TO WSS-CPT-IIC
                   PERFORM MSG-CLF
               ELSE
                   PERFORM MSG-CLF.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
      *FLB CST  10-FEB-1995 
           IF SCR-CMND = CMND-VRF
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO WSS-TOT-CLI
                              WSS-TOT-ARC
                              WSS-TOT-ARG
               PERFORM LDC-PRO-VCL
               IF MSG-COD-MENS > SPACES
                   GO TO ERR-ACC.
      *>>>>
           PERFORM KEY-ALL-CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-CLF.
      *<<<< CMN_ACC
      *FLB CST  21-SEP-1994 CCU FUNCIONE LUEGO MCA/CMX Y ANTES ACA
      *    MOVE 'I' TO CLF-COD-STAT IN CLF.

      *FLB CST  10-FEB-1995 
           IF SCR-CMND = CMND-VRF
               MOVE SCR-INST-HCM TO SCR-INST
      *FLB CST  13-JAN-1995 
               IF SCR-COD-STAT IN SCR-VARI = 'X'
                   MOVE ' ' TO CLF-COD-STAT IN CLF
                   MOVE 'A' TO CLF-MSC-STAT IN CLF
               ELSE
                   MOVE 'V' TO CLF-MSC-STAT IN CLF.

FM0194     PERFORM GET-FHOY.
FM0194*    Fecha Transaccion
FM0194     MOVE HOY-FHOY TO CLF-FEC-FTRN IN CLF.
FM0194*    Hora Transaccion
FM0194     MOVE HOY-HHOY TO CLF-HRA-HRTR IN CLF.
FM0194*    Codigo Origen transaccion
FM0194     MOVE SCR-OTRN TO CLF-COD-OTRN IN CLF.
FM0194*    Autor Transaccion
FM0194     MOVE SCR-USER TO CLF-COD-ATRN IN CLF.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           IF FIO-STAT-OKS
               MOVE 'ACCLFOK' TO MSG-COD-TMSG
               MOVE CLF-MSC-STAT IN CLF TO MSG-COD-CMSG
           ELSE
               MOVE 'ACCLFER' TO MSG-COD-TMSG
               MOVE CLF-MSC-STAT IN CLF TO MSG-COD-CMSG.

       ERR-ACC.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DEU' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           PERFORM MSG-CLF.
      *>>>>
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< CMN_ELI
           PERFORM DEL-ARC.
           IF MSG-COD-MENS > SPACES
      *        ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
               GO TO FIN-CMN-ELI.

           PERFORM DEL-ARG.
           IF MSG-COD-MENS > SPACES
      *        ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
               GO TO FIN-CMN-ELI.

           PERFORM DEL-LDC.
           IF MSG-COD-MENS > SPACES
      *        ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
               GO TO FIN-CMN-ELI.

           PERFORM DEL-RDC.
           IF MSG-COD-MENS > SPACES
      *       ERROR INCONSISTENCIA EN LA ELIMINACION : INFORMAR
              GO TO FIN-CMN-ELI.
      *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
       FIN-CMN-ELI.
           EXIT.


       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE CLF-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO CLF-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-CLF
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-CLF.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-CLF.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-CLF.
       ERR-SCR-GFLD.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CLF-GLS-MEN2
               MOVE SCR-PRMT     TO CLF-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-CLF
               PERFORM VAL-NUM-FLD-CLF.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CLF-GLS-MEN2
               MOVE SCR-PRMT     TO CLF-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO CLF-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF SCR-DESDE-CMN
               MOVE CLF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CLF-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-CLF

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CLF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CLF-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-CLF.
           PERFORM PRO-MKY-CLF.
           PERFORM UNP-IKY-CLF.
           PERFORM FST-KEY-CLF.
           MOVE '1' TO FRM-CPIM-AEY.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF SCR-DESDE-CMN
               MOVE CLF-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO CLF-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO CLF-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO CLF-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-CLF.
           PERFORM UNP-KEY-CLF.
           PERFORM FST-KEY-CLF.
           MOVE '1' TO FRM-CPIM-AEY.
      *<<<< FIN_HBL_KEY
      *>>>>
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-CLF.
           PERFORM UNP-FLD-CLF.
           PERFORM FST-FLD-CLF.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO CLF-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-CLF.
           PERFORM PRO-FLD-CLF.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE SCR-INST-GAB TO SCR-INST.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-CLF.
           PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *<<<< INI_PRO_CONF AND PGM_PU
           IF SCR-CMND = CMND-ACA OR CMND-REV
               MOVE 'A' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
           IF SCR-CMND = CMND-CIE
               MOVE 'C' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
           IF SCR-CMND = CMND-REA
               MOVE SPACES TO CLF-COD-RAZC IN CLF-FLD
               MOVE SPACES TO FRM-GLS-RAZC IN CLF-FLD
               MOVE 'I' TO CLF-MSC-STAT    IN CLF-FLD
               MOVE ZEROES TO CLF-FEC-FCIE IN CLF-FLD
           ELSE
      *FLB CST  13-JAN-1995 
           IF SCR-CMND = CMND-VRF AND SCR-COD-STAT = 'M'
               MOVE 'V' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
           IF SCR-CMND = CMND-VRF AND SCR-COD-STAT = 'X'
               MOVE 'A' TO CLF-MSC-STAT IN CLF-FLD
           ELSE
               MOVE 'I' TO CLF-MSC-STAT IN CLF-FLD.

           MOVE 'DEU'  TO MSC-COD-SIST.
           MOVE 'STA ' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-MSC-STAT IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           IF NOT MSG-COD-MENS > SPACES
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-STAT IN CLF-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STAT IN CLF-FLD.

      *>>>>
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-MSSG.
           PERFORM PRO-KEY-CLF.
           PERFORM PRO-FLD-CLF.
           PERFORM FST-MSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-CLF
               PERFORM EDT-FLD-CLF.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CLF-GLS-MEN2
               MOVE SCR-CONF     TO CLF-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO CLF-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-CLF
               PERFORM VAL-NUM-FLD-CLF
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-CLF
                   PERFORM VAL-NUM-FLD-CLF
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

       RET-STT-CLF SECTION.
       INI-RET-STT-CLF.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO CLF-MSC-TACC IN CLF
               MOVE 'I' TO CLF-MSC-STAT IN CLF
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO CLF-MSC-TACC IN CLF
               MOVE 'M' TO CLF-MSC-STAT IN CLF.
       FIN-RET-STT-CLF.
           EXIT.

       RET-HDR-CLF SECTION.
       INI-RET-HDR-CLF.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO CLF-FEC-FTRN IN CLF.
      *    Hora Transaccion
           MOVE HOY-HHOY TO CLF-HRA-HRTR IN CLF.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO CLF-COD-OTRN IN CLF.
      *    Autor Transaccion
           MOVE SCR-USER TO CLF-COD-ATRN IN CLF.
      *>>>>
       FIN-RET-HDR-CLF.
           EXIT.

       COPY LDCBUCLF.
       COPY GNSBVNUM.
       COPY LDCBFCLF.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.

      *<<<< ( EOF ) AND ( NOT PGM_VSI )
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
      *<<<< EOF
      *  Codigo adicional para rutina LDCPSVCL
       COPY LDCBGVCL.
       COPY LDCBKVCL.
      *  Codigo adicional para rutina LDCPSMCA
       COPY LDCBGMCA.
       COPY LDCBKMCA.

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       COPY LDCBGMPT.

      *<<<< PGM_PU
       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           MOVE CLF-CAI-ICLF IN CLF-FLD TO SCR-CAI-ICLF.
           MOVE CLF-IIC-ICLF IN CLF-FLD TO SCR-IIC-ICLF.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
      *<<<< NOT PGM_DB2
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.
      *>>>>
      *<<<< PGM_PU
       MSG-CLF SECTION.
       INI-MSG-CLF.
           MOVE MSG-GLS-DESC   TO WSS-CPT-DESC.
           MOVE WSS-CPT-NOMB-R TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN       TO FRM-MENS.
       FIN-MSG-CLF.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
       FIN-BCK-OUT.
           EXIT.

       DEL-LDC SECTION.
       INI-DEL-LDC.
           MOVE SPACES TO LDC-KEY-ILDC IN LDC.
           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-LDC.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.

           IF NOT ( FIO-STAT-OKS AND
              CLF-KEY-ICLF IN CLF = LDC-CIC-ICLF IN LDC )
               GO TO FIN-DEL-LDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'LDC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-LDC.

           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-LDC.
       FIN-DEL-LDC.
           EXIT.

       DEL-ARC SECTION.
       INI-DEL-ARC.
           MOVE SPACES TO ARC-KEY-IARC IN ARC.
           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARC.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           IF NOT ( FIO-STAT-OKS AND
              ARC-CIC-ICLF IN ARC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ARC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARC.

           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARC.
       FIN-DEL-ARC.
           EXIT.

       DEL-ARG SECTION.
       INI-DEL-ARG.
           MOVE SPACES TO ARG-KEY-IARG IN ARG.
           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARG.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           IF NOT ( FIO-STAT-OKS AND
              ARG-CIC-ICLF IN ARG = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ARG    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARG.

           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARG.
       FIN-DEL-ARG.
           EXIT.

       DEL-RDC SECTION.
       INI-DEL-RDC.
           MOVE SPACES                TO RDC-CIC-ICLI IN RDC.
           MOVE CLF-KEY-ICLF IN CLF   TO RDC-KEY-ICLF IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-RDC.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.

           IF NOT ( FIO-STAT-OKS AND
              RDC-KEY-ICLF IN RDC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-RDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'RDC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-RDC.

           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE CLF-KEY-ICLF IN CLF TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-RDC.
       FIN-DEL-RDC.
           EXIT.

       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN CLF-FLD = 'M'
               GO TO FIN-PUT-RDC.
           MOVE SPACES TO  RDC-GLS-FLAG IN RDC.
           MOVE 100                     TO RDC-VAL-PRDC IN RDC.
           MOVE SPACES                  TO RDC-COD-RDCF IN RDC.
           MOVE ZEROES                  TO RDC-GLS-DISP IN RDC.

           MOVE DBC-CAI-ICLI IN CLF-FLD TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO RDC-IIC-ICLI IN RDC.
           MOVE CLF-CAI-ICLF IN CLF-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE CLF-IIC-ICLF IN CLF-FLD TO RDC-IIC-ICLF IN RDC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

      *>>>>
       COPY LDCBFLDC.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY LDCBFRDC.
       COPY SGCBFREC.
       COPY LDCBFLAC.

       COPY TABBFCAM.

       COPY GNSBFCIC.
       COPY GNSBGCIC.

       COPY SGCBFDBC.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBGCLI.
       COPY GNSBPFEC.

      *<<<< PGM_PU 
        COPY LDCBGLAC.
      *>>>>
      *>>>>
