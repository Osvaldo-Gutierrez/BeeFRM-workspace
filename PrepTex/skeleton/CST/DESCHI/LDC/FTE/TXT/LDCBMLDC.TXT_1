*%! Codigo adicional para archivo LDCBMLDC
*% IF FIN_PUT_ALL_LDC
      *<<<< FIN_PUT_ALL_LDC
           IF NOT (LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-NUM-PVIG IN LDC-FLD > ZEROES )
               GO TO FIN-PUT-ALL-LDC.
      *>>>>
*% END
*%! copiar en el programa el registro TIO = TABBRTIO
*% IF FIN_PUT_CLF_LDC
      *<<<< FIN_PUT_CLF_LDC
      *AMP-INI  09-OCT-1993
      * Inmediatamente antes se hizo BUS-TAB para el CLF-COD-TOCF
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      *AMP-FIN  09-OCT-1993
*% IF NOT PGM_CHI
      *<<<< NOT PGM_CHI
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN LDC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                                           FRM-GLS-CMAX IN LDC-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CMAX IN LDC-FLD.
      *>>>>
*% ELSE
      *<<<< PGM_CHI
      *>>>>
*% END

           IF CLF-COD-AOCF IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN LDC-FLD.
      *LTM CST 30-09-93
            IF WSS-CIC-TOCF = 'CGE'
                MOVE CLF-NUM-SVEN IN CLF TO LDC-NUM-SVEN IN LDC-FLD
                MOVE CLF-NUM-AVEN IN CLF TO LDC-NUM-AVEN IN LDC-FLD
                MOVE CLF-NUM-MVEN IN CLF TO LDC-NUM-MVEN IN LDC-FLD
                MOVE CLF-NUM-DVEN IN CLF TO LDC-NUM-DVEN IN LDC-FLD
                MOVE CLF-VAL-CMAX IN CLF TO LDC-VAL-CMAX IN LDC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_LDC_LDC
      *<<<< FIN_PUT_LDC_LDC
      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               GO TO BQ-NO-LDC-TIPO.

           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DESC IN TAB TO LDC-GLS-DESC IN LDC-FLD
               MOVE TAB-GLS-DCOR IN TAB TO LDC-GLS-DCOR IN LDC-FLD.
      *FLB CST  28-FEB-1995 
           IF TAB-CIC-CTAB IN TAB = 'MLT'
               PERFORM OBT-FINI.
       BQ-NO-LDC-TIPO.
      *>>>>
*% END
*% IF INI_PUT_ARC_LDC
      *<<<< INI_PUT_ARC_LDC
           IF CMA-NUM-ARC IN CMA-VARI > 1
               PERFORM CLR-ARC-LDC
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               MOVE 'S' TO FRM-IND-MARC IN LDC-FLD
               GO TO FIN-PUT-ARC-LDC.
           MOVE 'N' TO FRM-IND-MARC IN LDC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_ARC_LDC
      *<<<< FIN_PUT_ARC_LDC

           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               GO TO FIN-PUT-AOOC.

           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TIO' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD
                                       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'LDCTIO   NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PUT-AOOC.

           MOVE TAB  TO TIO.

      *VAL-COD Valida codigo de tabla
           IF TIO-GLS-SIST IN TIO = 'COL'
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI.
           MOVE ARC-COD-AOOC IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
       FIN-PUT-AOOC.
      *>>>>
*% END
*% IF INI_PUT_ARG_LDC
      *<<<< INI_PUT_ARG_LDC
      *FLB CST  26-OCT-1993 TRASLADADO AQUI
           IF WSS-CIC-TOCF = 'CGE'
               MOVE 'S' TO LDC-IND-MGAR IN LDC-FLD.

           IF CMA-NUM-ARG IN CMA-VARI > 1 OR
              WSS-CIC-TOCF = 'CGE' OR
              LDC-IND-MGAR IN LDC-FLD = 'O' OR 'Y'
               PERFORM CLR-ARG-LDC
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD 
               GO TO FIN-PUT-ARG-LDC.
      *>>>>
*% END
*% IF FIN_PUT_ARG_LDC
      *<<<< FIN_PUT_ARG_LDC
      *LTM CST 30-09-93
           IF LDC-IND-MGAR IN LDC-FLD = 'U' AND
              ARG-IIC-IGAR IN LDC-FLD > ZEROES 
               MOVE 'E' TO LDC-IND-MGAR IN LDC-FLD.

           IF ARG-COD-AOGA IN LDC-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE ARG-COD-TOGA IN LDC-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE ARG-COD-AOGA IN LDC-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-AOGA IN LDC-FLD.

      *>>>>
*% END
*% IF LDC_NUM_ILDC
      *<<<< LDC_NUM_ILDC
            IF LDC-NUM-ILDC IN LDC-FLD = ZEROES
                PERFORM BUS-COR-LDC.

            IF LDC-NUM-ILDC IN LDC-FLD > VCL-TLCR 
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'NUMLDC>MAX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-NUM-ILDC.
      *>>>>
*% END
*% IF FIN_FST_KEY_LDC
      *<<<< FIN_FST_KEY_LDC
           IF SCR-CCPP = 'ING' OR 'ELI'
               MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN LDC-FLD.
      *>>>>
*% END
*% IF FIN_FST_FLD_LDC
      *<<<< FIN_FST_FLD_LDC
      *FLB CST  10-JUN-1994 
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD
               MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD
           ELSE    
               MOVE FRM-CPIM-AEY TO FRM-IND-MARC-ATR IN LDC-FLD.

           IF CMA-NUM-ARC IN CMA-VARI > 1 OR
              FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE 'S'    TO FRM-IND-MARC IN LDC-FLD
               MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD
                              ARC-COD-TOOC IN LDC-FLD
                              ARC-COD-AOOC IN LDC-FLD
                              ARC-CAI-IOPC IN LDC-FLD
               MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD 
               IF CMA-NUM-ARC IN CMA-VARI > 1 
                   MOVE FRM-CPIM-AEY TO ARC-COD-VCOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-TOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-AOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-CAI-IOPC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-IIC-IOPC-ATR IN LDC-FLD.

           IF CMA-NUM-ARG IN CMA-VARI > 1 OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )

               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD 
               IF CMA-NUM-ARG IN CMA-VARI > 1 
                   MOVE FRM-CPIM-AEY TO ARG-COD-TOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-COD-AOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-CAI-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-IIC-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-NUM-PORG-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO LDC-IND-MGAR-ATR IN LDC-FLD.
      *FLB CST  10-JUN-1994 FIN

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               GO TO FST-NO-LDC-TIPO.

           MOVE FRM-CPIM-AEY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
       FST-NO-LDC-TIPO.
      *>>>>
*% END
*% IF FIN_LDC_FEC_FINI
      *<<<< FIN_LDC_FEC_FINI
           PERFORM GET-FHOY.
           MOVE LDC-NUM-DINI IN LDC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE LDC-NUM-MINI IN LDC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE LDC-NUM-SINI IN LDC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE LDC-NUM-AINI IN LDC-FLD TO WSS-NUM-AINI IN WSS-VARI.

           MOVE CLF-NUM-DAPE IN CMA-VARI TO WSS-NUM-DAPE IN WSS-VARI.
           MOVE CLF-NUM-MAPE IN CMA-VARI TO WSS-NUM-MAPE IN WSS-VARI.
           MOVE CLF-NUM-SAPE IN CMA-VARI TO WSS-NUM-SAPE IN WSS-VARI.
           MOVE CLF-NUM-AAPE IN CMA-VARI TO WSS-NUM-AAPE IN WSS-VARI.

           IF WSS-FEC-FINI IN WSS-VARI > HOY-FHOY
              MOVE 'LDC'          TO MSG-COD-SIST
              MOVE 'FINI > FHOY ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-LDC-FEC-FINI.
           IF WSS-FEC-FINI IN WSS-VARI < WSS-FEC-FAPE IN WSS-VARI
              MOVE 'LDC'          TO MSG-COD-SIST
              MOVE 'FINI < FAPE ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-LDC-FEC-FINI.
           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO CON-VAL-LDC-FEC-FINI.
      * OBTIENE MAXIMO VENCIMIENTO DE MLT
           MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH.
           IF WSS-COD-PLAV = 'D'
               MOVE FEC-SUM-DIA  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NDIA
           ELSE
           IF WSS-COD-PLAV = 'M'
               MOVE FEC-SUM-MES  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NMES
           ELSE
           IF WSS-COD-PLAV = 'A'
               MOVE FEC-SUM-ANO  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DMAX IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MMAX IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SMAX IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AMAX IN WSS-VARI.
       CON-VAL-LDC-FEC-FINI.
      *>>>>
*% END
*% IF INI_VAL_FLD_LDC
      *<<<< INI_VAL_FLD_LDC
      *FLB CST  23-FEB-1995 
      * EXAMINA SI LDC PERMITE MONEDA DISTINTA A LA DE CLF
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'MONLDC<>CLF'        TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-MLMC
           ELSE
               MOVE 'N' TO WSS-VSN-MLMC.

      *FLB CST  26-OCT-1993 
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *SMC-INI 26-10-1993 LEE TABLA VSN PARA DETERMINAR SI SE
      *                   USO DE FUNCIONALIDADES DE CTE, CEX
      *                   LEA, TCR.
      * BUSCA REGISTRO CTE.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCTE      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCTE IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCTE IN WSS-VARI.

      * BUSCA REGISTRO CEX.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCEX      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCEX IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCEX IN WSS-VARI.

      * BUSCA REGISTRO LEA.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCLEA      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VLEA IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VLEA IN WSS-VARI.

      * BUSCA REGISTRO TCR.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCTCR      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VTCR IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VTCR IN WSS-VARI.

      * ASIGNA O NO EL NUMERO DE CREDITO
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'ASIGNAOPC   '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AOPC IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AOPC IN WSS-VARI.

      * Permite o no TIO sin AUX
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'TIO+AUX OBL '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AXOB IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AXOB IN WSS-VARI.
      *>>>>
*% END
*% IF LDC_COD_TIPO
      *<<<< LDC_COD_TIPO
      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               MOVE 'N' TO TLC-VSN-TIPO IN TLC-VARI
               GO TO FIN-VAL-LDC-COD-TIPO.

           MOVE 'S' TO TLC-VSN-TIPO IN TLC-VARI.
           IF LDC-COD-TIPO IN LDC-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-LDC-COD-TIPO.
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-COD-TIPO IN LDC-FLD NOT > SPACES
               GO TO FIN-VAL-LDC-COD-TIPO
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO LDC-GLS-DESC IN LDC-FLD
               MOVE TAB-GLS-DCOR IN TAB TO LDC-GLS-DCOR IN LDC-FLD
      *FLB CST  24-NOV-1994 
               MOVE TAB-CIC-CTAB IN TAB TO TLC-CIC-LDIS IN TLC-VARI.

      *DPR CST  20-FEB-1995 LINEA DE AVANCE Y VEN LDC > VEN CLF
      * GUARDA PARAMETROS
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA.

           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO FIN-VAL-LDC-COD-TIPO.

      * HAYA SOLA 1 'MLT'
           PERFORM VAL-1-LAV.
           IF MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-COD-TIPO.
      *DPR CST  20-FEB-1995 FIN
      *>>>>
*% END
*% IF FRM_IND_MARC
      *<<<< FRM_IND_MARC
      *FLB CST  25-NOV-1994 
           IF FRM-IND-MARC IN LDC-FLD NOT > SPACES OR
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE' 
               MOVE 'N' TO FRM-IND-MARC IN LDC-FLD
               GO TO FIN-VAL-FRM-IND-MARC.

           IF FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD
               MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD
               MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD
               MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD
               MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD
               GO TO FIN-VAL-FRM-IND-MARC.
      *>>>>
*% END
*% IF LDC_VAL_CMAX
      *<<<< LDC_VAL_CMAX

      *AMP-INI  22-OCT-1993
      *VAL-COD BUSCA CIC DE TIO DE CLF PARA CASO DE GRUPOS
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           MOVE TAB TO TIO.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      *AMP-FIN  22-OCT-1993
           IF WSS-CIC-TOCF = 'CGE'
               IF LDC-VAL-CMAX IN LDC-FLD NOT =
                  CLF-VAL-CMAX IN CMA-VARI
                   MOVE 'DEU'          TO MSG-COD-SIST
                   MOVE 'CMAXLDC<>CLF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LDC-VAL-CMAX
               ELSE
                   NEXT SENTENCE
           ELSE
      *FLB CST  23-FEB-1995 
           IF NOT PERMITE-MON-LDC-DIF-A-MON-CLF AND
              LDC-VAL-CMAX IN LDC-FLD > CLF-VAL-CMAX IN CMA-VARI
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'MONTOLDC>CLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-VAL-CMAX.
      *>>>>
*% END
*% IF FIN_LDC_COD_VCLC
      *<<<< FIN_LDC_COD_VCLC
*% IF PGM_CHI
      *<<<< PGM_CHI
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-LDC-COD-VCLC.
      *>>>>
*% END

      *FLB CST  23-FEB-1995 MLT Y MON LDC DIFERENTE A MON CLF
           MOVE LDC-COD-VCLC IN LDC-FLD  TO LDC-COD-VCLC IN LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD  TO LDC-VAL-CMAX IN LDC.
           MOVE CLF-COD-VCCF IN LDC-FLD  TO CLF-COD-VCCF IN CLF.
           MOVE CLF-VAL-CMAX IN CMA-VARI TO CLF-VAL-CMAX IN CLF
           PERFORM VAL-MON-LDC-CLF.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               IF MSG-COD-MENS = 'MONTOLDC<PRM' OR 'MONTOLDC>CLF'
                   MOVE -1 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-VAL-LDC-COD-VCLC
               ELSE
                   GO TO FIN-VAL-LDC-COD-VCLC.
       YA-VALIDO-MONTO-LDC-VS-CLF.
      *>>>>
*% END
*% IF ARC_COD_VCOC
      *<<<< ARC_COD_VCOC
*% IF NOT PGM_CHI
      *<<<< NOT PGM_CHI
           IF SCR-CCPP = 'ING' 
               MOVE FRM-GLS-VCCF IN LDC-FLD TO FRM-GLS-CMAX IN LDC-FLD.
      *>>>>
*% ELSE
      *<<<< PGM_CHI
      *>>>>
*% END

           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-VCOC.
      *>>>>
*% END
*% IF ARC_COD_TOOC
      *<<<< ARC_COD_TOOC
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
      *FLB CST  26-OCT-1993 
               MOVE SPACES TO WSS-CIC-TOOC
               GO TO FIN-VAL-ARC-COD-TOOC.
      *>>>>
*% END
*% IF FIN_ARC_COD_TOOC
      *<<<< FIN_ARC_COD_TOOC
      *FLB CST  10-JUN-1994
           IF MSG-COD-MENS > SPACES OR
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-TOOC.
      *FLB CST  10-JUN-1994

           MOVE TAB TO TIO.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOOC.
           IF ( TAB-CIC-CTAB IN TAB = 'CGE' )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CODTIOINVL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.

      *FLB CST  9-MAR-1995 
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SIS' TO TAB-COD-TTAB IN TAB.
           MOVE TIO-GLS-SIST IN TIO TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CODSISNEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.
           MOVE TAB-GLS-DATA TO WSS-SIS-DATA.
      *FLB CST  9-MAR-1995 FIN

           IF NOT (  ( USA-CEX AND TIO-GLS-SIST IN TIO = 'CEX' ) 
                  OR ( USA-CTE AND TIO-GLS-SIST IN TIO = 'CTE' ) 
                  OR ( USA-LEA AND TIO-GLS-SIST IN TIO = 'LEA' ) 
                  OR ( USA-TCR AND TIO-GLS-SIST IN TIO = 'TCR' ) 
                  OR ( TIO-GLS-SIST IN TIO = 'COL' ) 
      *FLB CST  9-MAR-1995 
                  OR ( TAB-CIC-CTAB IN TAB = 'CCC' )
                  OR ( TIO-DE-DEUDA ) )
      *FLB CST  9-MAR-1995 FIN
      *SMC-FIN 26-10-1993 
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.
      *>>>>
*% END
*% IF ARC_COD_AOOC
      *<<<< ARC_COD_AOOC
           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-AOOC.

      *FLB CST  7-OCT-1994 
      * VALIDA C. AUX CONTRA COL/AUX, CUANDO TIPO DE OPERACION SEA
      * DE 'COL' ( TIO-GLS-SIST = 'COL') SI NO CONTRA TAB/AUX.

      *VAL-COD Valida codigo de tabla
           IF TIO-GLS-SIST IN TIO = 'COL'
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARC-COD-AOOC IN LDC-FLD TO
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-AOOC
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
      *>>>>
*% END
*% IF ARC_CAI_IOPC 
      *<<<< ARC_CAI_IOPC
      *FLB CST  6-OCT-1994 PARA CTA CTE PUEDE ESTAR LLENA LA CLAVE
           IF WSS-CIC-TOOC = 'CTE' AND USA-CTE
               GO TO FIN-VAL-ARC-CAI-IOPC.

      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ( ARC-COD-VCOC IN LDC-FLD > SPACES OR
                ARC-COD-TOOC IN LDC-FLD > SPACES 
              )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'IICIOPC>0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-CAI-IOPC.

      *FLB CST  26-OCT-1993 
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              WSS-VSN-OCAI = 'S'
               MOVE ARC-CAI-IOPC IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               IF NOT ( CIC-COD-TCIC IN CIC = 'C' OR
                        CIC-COD-TCIC IN CIC = 'D' )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-CAI-IOPC
               ELSE
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-CIC
                   IF NOT FIO-STAT-OKS
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'CICSTAT' TO MSG-COD-TMSG
                       MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-ARC-CAI-IOPC.
      *>>>>
*% END
*% IF ARC_IIC_IOPC 
      *<<<< ARC_IIC_IOPC
      *FLB CST  6-OCT-1994 MODIFICADO
           IF FRM-IND-MARC IN LDC-FLD = 'S' OR
              NOT (
              ARC-COD-VCOC IN LDC-FLD > SPACES OR
              ARC-COD-TOOC IN LDC-FLD > SPACES OR
              ARC-COD-AOOC IN LDC-FLD > SPACES OR
              ARC-CAI-IOPC IN LDC-FLD > SPACES OR
              ARC-IIC-IOPC IN LDC-FLD > ZEROES 
                  )
               GO TO FIN-VAL-ARC-IIC-IOPC.

           PERFORM VAL-CON-ARC.
      *FLB 11/NOV/92
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-ARC-IIC-IOPC.

      *FLB 11/NOV/92
      * ASIGNA NRO CREDITO
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES
      *FLB CST  6-OCT-1994 
                  AND 
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE 
              ) 
      *FLB CST  6-OCT-1994 
               MOVE ARC-CAI-IOPC IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               PERFORM PRO-CIC-OPC
               MOVE 'A' TO CMA-IND-IOPC IN CMA-VARI
               MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC  
                                                      IN CMA-VARI
               MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC 
                                                      IN CMA-VARI
               GO TO FIN-VAL-ARC-IIC-IOPC.

      *FLB 11/NOV/92
      * DIGITA NRO CREDITO O CAMBIO EL NUMERO ASIGNADO
           IF CMA-IND-IOPC IN CMA-VARI NOT = 'A' AND
              ARC-IIC-IOPC IN LDC-FLD > ZEROES OR
              ( ARC-CAI-IOPC IN LDC-FLD NOT = ARC-CAI-IOPC IN CMA-VARI 
                     OR
                ARC-IIC-IOPC IN LDC-FLD NOT = ARC-IIC-IOPC IN CMA-VARI
              ) 
               MOVE 'D' TO CMA-IND-IOPC IN CMA-VARI
               MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC  
                                                      IN CMA-VARI
               MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC 
                                                      IN CMA-VARI.

      *FLB 11/NOV/92
      * VALIDA QUE NRO CREDITO DIGITADO (NO PARA ASIGNADO) EXISTA Y ESTE
      * VIGENTE
      *FLB CST  26-OCT-1993 SIEMPRE QUE NO SEA CTE
           IF CMA-IND-IOPC IN CMA-VARI = 'D' AND
              ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR NOT USA-CTE )
               MOVE ARC-CAI-IOPC IN LDC-FLD TO OPC-CAI-IOPC IN OPC
               MOVE ARC-IIC-IOPC IN LDC-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-IIC-IOPC
               ELSE
               IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    YACAN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-IIC-IOPC
               ELSE
                   GO TO FIN-VAL-ARC-IIC-IOPC.

      *AMP-INI  9-OCT-1993
      * VALIDA LA CTA-CTE 
      *FLB CST  6-OCT-1994 
      *    IF ( ARC-IIC-IOPC IN LDC-FLD > SPACES AND
           IF ( ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
      *SMC-INI 26-10-1993 
                WSS-CIC-TOOC = 'CTE' AND USA-CTE )
      *SMC-FIN 26-10-1993 
               PERFORM BUSCO-CTA-CTE
               IF WSS-CTA-CTE > ZEROES
                   IF NOT ( RCO-COD-TOPR IN RCO =
                            ARC-COD-TOOC IN LDC-FLD AND
                            RCO-COD-AOPR IN RCO =
                            ARC-COD-AOOC IN LDC-FLD )
                       MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                   ELSE
                       MOVE 'TAB' TO TAB-COD-SIST
                       MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                       MOVE RCO-COD-TOPR IN RCO TO
                            TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB TO TIO
                       IF TIO-GLS-SIST IN TIO NOT = 'CTE'
                           MOVE 'CICTIOPNOSIS' TO MSG-COD-MENS
                       ELSE
                           PERFORM VAL-CTA-CTE
                           IF CTE-STAT-OKS
                               IF ( ARC-COD-VCOC IN LDC-FLD NOT =
                                     OPE-COD-VCOP IN OPE )
                                   MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                               ELSE
                                   NEXT SENTENCE
                           ELSE
                               IF MSG-COD-MENS > SPACES
                                   NEXT SENTENCE
                               ELSE
                                   MOVE 'IFBCPFAIL' TO MSG-COD-MENS
               ELSE
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
           ELSE
               NEXT SENTENCE.

           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'         TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-IIC-IOPC.
      *AMP-FIN  9-OCT-1993
      *>>>>
*% END
*% IF LDC_IND_MGAR
      *<<<< LDC_IND_MGAR
      *LTM CST 30-09-93
           IF WSS-CIC-TOCF = 'CGE' AND
              LDC-IND-MGAR IN LDC-FLD NOT = 'S'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    EQCGE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-IND-MGAR.
      *LTM CST 30-09-93

      *FLB CST  14-OCT-1993 CORRIGE PUNTO A DE PANTALLA LDC (YNP)
           IF LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S'
               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD 
               GO TO FIN-VAL-LDC-IND-MGAR
           ELSE
           IF LDC-IND-MGAR IN LDC-FLD = 'U'
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               GO TO FIN-VAL-LDC-IND-MGAR.
      *>>>>
*% END
*% IF ARG_COD_TOGA
      *<<<< ARG_COD_TOGA
      *FLB CST  25-AGO-1994
           IF LDC-IND-MGAR IN LDC-FLD = 'U' AND
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
               MOVE 'DEU'                TO FIO-SIST
               MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
               MOVE 'NOARGUSINTIO  '     TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT ( FIO-STAT-OKS AND 
                        TAB-IND-VIGE IN TAB = 'S' )

      * VE SI ES ERROR O NO QUE 'U' NO TENGA TIPO GTIA
                   MOVE 'DEU'          TO MSG-COD-SIST
                   MOVE 'ARGUSINTIO'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-COD-TOGA.
      *FLB CST  25-AGO-1994

      *FLB CST  22-JUN-1994
           IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES OR
              ARG-COD-TOGA IN LDC-FLD = 'AVL'      OR
              ARG-COD-TOGA IN LDC-FLD = 'FIA'      OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-TOGA.

           IF LDC-IND-MGAR IN LDC-FLD = 'E' AND
              ARG-COD-TOGA IN LDC-FLD NOT = 'AVL' AND
              ARG-COD-TOGA IN LDC-FLD NOT = 'FIA'
               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-TOGA.

      *FLB CST  22-JUN-1994 FIN
      *>>>>
*% END
*% IF FIN_ARG_COD_TOGA
      *<<<< FIN_ARC_COD_TOGA

           MOVE TAB TO TIO.
           IF NOT ( TIO-GLS-SIST IN TIO = 'GAR' )
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-TOGA.                               

      *FLB CST  10-MAY-1994 
           MOVE ARG-COD-TOGA IN LDC-FLD TO GAR-TIP-OPE IN TAG.
           MOVE SPACES                  TO GAR-STP-OPE IN TAG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT ( FIO-STAT-OKS AND
                    GAR-TIP-OPE IN TAG = ARG-COD-TOGA IN LDC-FLD )
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-TOGA. 
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM GAR-FIO-TAG.

      *FLB CST  10-MAY-1994 FIN
      *>>>>
*% END
*% IF ARG_COD_AOGA
      *<<<< ARG_COD_AOGA
           IF ARG-COD-AOGA IN LDC-FLD NOT > SPACES
                OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB CST  22-JUN-1994 
           IF LDC-IND-MGAR IN LDC-FLD = 'E' 
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD 
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB CST  10-MAY-1994 TRASLADADO AQUI Y CORREGIDO
           IF ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL' OR 'FIA' )
                    AND
              ARG-COD-AOGA IN LDC-FLD > SPACES 
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'AOGA>BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-AOGA.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARG-COD-TOGA IN LDC-FLD TO
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARG-COD-AOGA IN LDC-FLD TO
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARG-COD-AOGA IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOGA IN LDC-FLD.

      *FLB CST  10-MAY-1994 
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB-INI  28-OCT-1993 TRALADADO AQUI
           MOVE ARG-COD-TOGA IN LDC-FLD TO GAR-TIP-OPE IN TAG.
           MOVE ARG-COD-AOGA IN LDC-FLD TO GAR-STP-OPE IN TAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GAR-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'GAR'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-AOGA. 
      *>>>>
*% END
*% IF ARG_NUM_PORG
      *<<<< ARG_NUM_PORG
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               GO TO FIN-VAL-ARG-NUM-PORG.

           IF ARG-COD-TOGA IN LDC-FLD = 'AVL'
               MOVE 100 TO ARG-NUM-PORG IN LDC-FLD
               GO TO FIN-VAL-ARG-NUM-PORG.

           IF ARG-NUM-PORG IN LDC-FLD = ZEROES 
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'PORGOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-NUM-PORG.
      *>>>>
*% END
*% IF ARG_CAI_IGAR 
      *<<<< ARG_CAI_IGAR
      *FLB CST  22-JUN-1994 SEGUN LTM BCP 25-05-1994 Y
      *  MODIFICADO PARA EL CASO QUE NO SE OTORGUEN CIC X SUC
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' OR 'U' )
               GO TO FIN-VAL-ARG-CAI-IGAR.

      *FLB CST  10-MAY-1994 TRASLADADO AQUI Y CORREGIDA LA FORMA DE
      *  PREGUNTAR POR LA INCONSISTENCIA
           IF ARG-CAI-IGAR IN LDC-FLD > SPACES AND
              ( LDC-IND-MGAR IN LDC-FLD NOT = 'E' OR
              NOT ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL'
                                                     OR 'FIA' ) OR
              ARG-COD-AOGA IN LDC-FLD > SPACES
              )
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAI>SPACES' TO MSG-COD-TMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-CAI-IGAR.

      *FLB CST  6-OCT-1994 NO LEER CICXSUC 2 VECES
           IF WSS-VSN-OCAI = 'S' AND
              ARG-CAI-IGAR IN LDC-FLD NOT > SPACES
               MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF
               MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE CLF-COD-OFIC IN CLF TO CIC-COD-CCIC IN CIC
               IF ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA'
*% IF NOT ( PGM_CHI AND PGM_BCI )
                   MOVE 'F'          TO CIC-COD-TCIC IN CIC
*% ELSE
      *<<<< PGM_CHI AND PGM_BCI
                   MOVE '0600'       TO CIC-CAI-ICIC IN CIC
      *>>>>
*% END
               ELSE
*% IF NOT ( PGM_CHI AND PGM_BCI )
                   MOVE 'G'          TO CIC-COD-TCIC IN CIC
*% ELSE
      *<<<< PGM_CHI AND PGM_BCI
                   MOVE '0500'       TO CIC-CAI-ICIC IN CIC
      *>>>>
*% END
           ELSE
               MOVE ARG-CAI-IGAR IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' AND
                  ( ( ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA' ) AND
*% IF NOT ( PGM_CHI AND PGM_BCI )
                    CIC-COD-TCIC IN CIC NOT = 'F' 
*% ELSE
      *<<<< PGM_CHI AND PGM_BCI
                    CIC-CAI-ICIC IN CIC NOT = '0600'
      *>>>>
*% END
                          OR 
                    NOT
                    ( ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA' ) AND
*% IF NOT ( PGM_CHI AND PGM_BCI )
                    CIC-COD-TCIC IN CIC NOT = 'G' 
*% ELSE
      *<<<< PGM_CHI AND PGM_BCI
                    CIC-CAI-ICIC IN CIC NOT = '0500'
      *>>>>
*% END
                  )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-CAI-IGAR
               ELSE
               IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
      * NO HAY QUE VALIDAR EL CAI
                   GO TO FIN-VAL-ARG-CAI-IGAR.

           MOVE CIC-CAI-ICIC IN CIC TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CICSTAT' TO MSG-COD-TMSG
               MOVE CIC-STAT-NEX TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-CAI-IGAR.
      *>>>>
*% END
*% IF ARG_IIC_IGAR 
      *<<<< ARG_IIC_IGAR
      *FLB CST  10-MAY-1994 
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               GO TO FIN-VAL-ARG-IIC-IGAR.

           IF ARG-IIC-IGAR IN LDC-FLD > ZEROES AND
              ( LDC-IND-MGAR IN LDC-FLD NOT = 'E' OR
              NOT ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL' 
                                                     OR 'FIA' ) OR 
              ARG-COD-AOGA IN LDC-FLD > SPACES 
              )
               MOVE 'IICIGAR>0' TO MSG-COD-MENS
               MOVE 'DEU'       TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  10-MAY-1994 CASO 'U'
           IF LDC-IND-MGAR IN LDC-FLD NOT = 'E'
               GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  23/JUN/94 CORREGIDO HASTA FIN SECCION
           IF SCR-CCPP NOT = 'ING' AND ARG-IIC-IGAR IN LDC-FLD = ZEROES
               PERFORM ERR-GLS
               GO TO FIN-VAL-ARG-IIC-IGAR.
               
      *FLB CST  23/JUN/94 ASIGNA NRO GARANTIA O FIANZA
           IF ARG-IIC-IGAR IN LDC-FLD = ZEROES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               MOVE 'A' TO CMA-IND-IGAR IN CMA-VARI
               IF ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA'
                   PERFORM PRO-CIC-FIA
                   MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR 
                                                      IN CMA-VARI
                   MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR 
                                                      IN CMA-VARI
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   PERFORM PRO-CIC-GDG
                   MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR 
                                                      IN CMA-VARI
                   MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR 
                                                      IN CMA-VARI
                   GO TO FIN-VAL-ARG-IIC-IGAR.
               
      *FLB CST  23/JUN/94 CORREGIDO Y DEJADO SIMILAR A IOPC
      * DIGITA NRO GARANTIA O CAMBIO EL NUMERO ASIGNADO
           IF CMA-IND-IGAR IN CMA-VARI NOT = 'A' AND
              ARG-IIC-IGAR IN LDC-FLD > ZEROES OR
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI 
                     OR
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              ) 
               MOVE 'D' TO CMA-IND-IGAR IN CMA-VARI
               MOVE SPACES TO ARG-CAI-IGAR IN CMA-VARI
               MOVE ZEROES TO ARG-IIC-IGAR IN CMA-VARI.

      * VALIDA QUE NRO GARANTIA DIGITADO (NO PARA ASIGNADO) EXISTA
           IF ( CMA-IND-IGAR IN CMA-VARI = 'D' OR
              ( SCR-CCPP NOT = 'ING' OR
                SCR-CCPP = 'ING' AND
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI 
                     OR 
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              )
              )
              ) AND
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO GAR-NUM-SIS IN GDG
               MOVE ARG-IIC-IGAR IN LDC-FLD TO GAR-COD-CRR IN GDG
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GAR-FIO-GDG
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'GDG    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-ARG-IIC-IGAR.

           IF ( CMA-IND-IGAR IN CMA-VARI = 'D' OR
              ( SCR-CCPP NOT = 'ING' OR
                SCR-CCPP = 'ING' AND
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI 
                     OR 
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              )
              )
              ) AND
              ARG-COD-TOGA IN LDC-FLD > SPACES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO FIA-CAI-IESC IN FIA
               MOVE ARG-IIC-IGAR IN LDC-FLD TO FIA-IIC-IESC IN FIA
               MOVE 1                       TO FIA-NUM-IFIA IN FIA
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DEU-FIO-FIA
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'FIA    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-ARG-IIC-IGAR.
      *>>>>
*% END
*% IF LDC_IND_PVIG
      *<<<< LDC_IND_PVIG
           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND 
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES 
               MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD
               GO TO FIN-VAL-LDC-IND-PVIG.

           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES 
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPVGFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO LDC-NUM-PVIG-LEN  IN LDC-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-LDC-IND-PVIG.

      *>>>>
*% END
*% IF LDC_IND_VIGE
      *<<<< LDC_IND_VIGE
           IF LDC-IND-VIGE IN LDC-FLD NOT > SPACES 
               MOVE 'S' TO LDC-IND-VIGE IN LDC-FLD.
      *>>>>
*% END
*% IF INI_LDC_FEC_FINI
      *<<<< INI_LDC_FEC_FINI
      * MHM ini 19-OCT-1995 
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *         MOVE ZEROES TO LDC-FEC-FINI IN LDC-FLD
      *         GO TO FIN-VAL-LDC-FEC-FINI.
      *     MOVE FEC-FBLK-N TO FEC-FBLK.
      * MHM fin 19-OCT-1995
           IF LDC-FEC-FINI IN LDC-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY TO LDC-NUM-DINI IN LDC-FLD
              MOVE HOY-MHOY TO LDC-NUM-MINI IN LDC-FLD
              MOVE HOY-SHOY TO LDC-NUM-SINI IN LDC-FLD
              MOVE HOY-AHOY TO LDC-NUM-AINI IN LDC-FLD
              MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH.
      *>>>>
*% END
*% IF FIN_LDC_IND_PVIG
      *<<<< FIN_LDC_IND_PVIG
      *DPR CST   20-FEB-1995 PER. VIGENCIA = A PARAMETRO DE MLT
           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO FIN-VAL-LDC-IND-PVIG.
      *DPR CST  20-FEB-1995 FIN  
*% END
*% IF INI_LDC_FEC_FVEN
      *<<<< INI_LDC_FEC_FVEN
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.

      *FLB CST  23-FEB-1995 
           IF TLC-CIC-LDIS IN TLC-VARI = 'MLT'
               MOVE FEC-FBLK-N TO FEC-FBLK
               PERFORM ANA-PVIG-FVEN
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-VAL-LDC-FEC-FVEN.
      *>>>>
*% END
*% IF LDC_FEC_FVEN
      *<<<< LDC_FEC_FVEN
      *FLB CST  28-FEB-1995 VENCTO NO MAYOR A PARAMETRO DE MLT
           IF TLC-CIC-LDIS IN TLC-VARI = 'MLT'
               PERFORM VAL-FVEN-LAV
               GO TO FIN-VAL-LDC-FEC-FVEN.

      *LTM CST 30-09-93
           IF WSS-CIC-TOCF = 'CGE'
               IF NOT (LDC-NUM-SVEN IN LDC-FLD =
                       CLF-NUM-SVEN IN CMA-VARI  AND
                       LDC-NUM-AVEN IN LDC-FLD =
                       CLF-NUM-AVEN IN CMA-VARI  AND
                       LDC-NUM-MVEN IN LDC-FLD =
                       CLF-NUM-MVEN IN CMA-VARI  AND
                       LDC-NUM-DVEN IN LDC-FLD =
                       CLF-NUM-DVEN IN CMA-VARI)
                   MOVE 'DEU'       TO MSG-COD-SIST
                   MOVE 'LDCFNECLF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LDC-FEC-FVEN
               ELSE
                   NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *LTM 30-09-93 FIN

           IF NOT (LDC-NUM-PVIG IN LDC-FLD NOT = ZEROES AND
                   LDC-IND-PVIG IN LDC-FLD NOT = SPACES AND
                   LDC-FEC-FVEN IN LDC-FLD NOT = ZEROES)
                     GO TO CON-VAL-LDC-FEC-FVEN.
           MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH
           IF LDC-IND-PVIG IN LDC-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'M'
              MOVE FEC-SUM-MES  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES
           ELSE
              MOVE FEC-SUM-ANO  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM
           PERFORM CAL-FEC
           IF FEC-FECH = LDC-FEC-FVEN IN LDC-FLD
              NEXT SENTENCE
           ELSE
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'FECHINCONS' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-LDC-FEC-FVEN.
 
       CON-VAL-LDC-FEC-FVEN.                  
           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD = SPACES AND
              LDC-FEC-FVEN IN LDC-FLD = ZEROES
               MOVE CLF-NUM-PVIG IN CMA-VARI TO LDC-NUM-PVIG IN LDC-FLD
               MOVE CLF-IND-PVIG IN CMA-VARI TO LDC-IND-PVIG IN LDC-FLD.

           IF LDC-NUM-PVIG IN LDC-FLD NOT = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT = SPACES AND
              LDC-FEC-FVEN IN LDC-FLD = ZEROES
               PERFORM OBT-FVEN
               MOVE WSS-NUM-DVEN TO LDC-NUM-DVEN IN LDC-FLD
               MOVE WSS-NUM-MVEN TO LDC-NUM-MVEN IN LDC-FLD
               MOVE WSS-NUM-SVEN TO LDC-NUM-SVEN IN LDC-FLD
               MOVE WSS-NUM-AVEN TO LDC-NUM-AVEN IN LDC-FLD.

           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD = SPACES AND
              LDC-FEC-FVEN IN LDC-FLD NOT = ZEROES
               PERFORM OBT-PVIG.

       VAL-FVEN-LDC.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO WSS-NUM-DVE1 IN WSS-VARI.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO WSS-NUM-MVE1 IN WSS-VARI.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO WSS-NUM-SVE1 IN WSS-VARI.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO WSS-NUM-AVE1 IN WSS-VARI.
      *DPR CST  21-FEB-1995 
      *    IF WSS-FEC-FVE1 IN WSS-VARI > CLF-FEC-FVEN IN CMA-VARI
           IF WSS-FEC-FVE1 IN WSS-VARI > CLF-FEC-FVEN IN CMA-VARI AND
              WSS-IND-VTOL NOT = 'S'
      *DPR CST  21-FEB-1995 FIN
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'VENLDC>CLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-FEC-FVEN.
       FIN-VAL-FVEN-LDC.
      *>>>>
*% END
*% LBL = ' '
*% IF VAL_CON_FLD_LDC 
      *<<<< VAL_CON_FLD_LDC 

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           IF TLC-VSN-TIPO IN TLC-VARI NOT = 'S' OR
              FRM-IND-MARC IN LDC-FLD = 'S'
                  OR
              ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              WSS-VSN-AOPC = 'S' AND
              CMA-IND-IOPC IN CMA-VARI = 'A'
               GO TO NO-LDC-TIPO.

      *VALIDA ARC EN FAMILIA
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              TLC-VSN-TIPO IN TLC-VARI = 'S' AND
              TLC-CIC-LDIS IN TLC-VARI NOT = 'LIBRE' 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCNOARC'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               GO TO FIN-VAL-CON-FLD-LDC.

           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES
               GO TO FIN-VAL-CON-FLD-LDC.

           IF ( ARC-COD-TOOC IN LDC-FLD > SPACES OR
                ARC-IIC-IOPC IN LDC-FLD > ZEROES ) 
                  AND
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE' 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCEXIARC'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               GO TO FIN-VAL-CON-FLD-LDC.
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD

           MOVE LDC-COD-TIPO IN LDC-FLD TO TLC-CODG.
           MOVE ARC-COD-TOOC IN LDC-FLD TO TLC-TOOC.
           MOVE ARC-COD-AOOC IN LDC-FLD TO TLC-AOOC.

           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              TLC-TOOC NOT > SPACES
               MOVE OPC-COD-TOOC IN OPC TO TLC-TOOC
               MOVE OPC-COD-AOOC IN OPC TO TLC-AOOC.
            
           PERFORM LDC-VAL-TLC.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'          TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
                  TLC-TOOC NOT > SPACES
                   MOVE -1 TO ARC-CAI-IOPC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC
               ELSE
               IF ARC-COD-AOOC IN LDC-FLD > SPACES
                   MOVE -1 TO ARC-COD-AOOC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC
               ELSE
                   MOVE -1 TO ARC-COD-TOOC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC.

       NO-LDC-TIPO.
      *>>>>
*% END
*% LBL = ' '
*% IF EOF_BU OR PGM_VMS
      *<<<< EOF_BU OR PGM_VMS
       OBT-PVIG SECTION.
       INI-OBT-PVIG.
      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *DIF-FEC obtiene la diferencia en aos entre dos fechas
      *         MOVE CLF-NUM-DAPE IN CMA-VARI TO FEC-DEC1
      *         MOVE CLF-NUM-MAPE IN CMA-VARI TO FEC-MEC1
      *         MOVE CLF-NUM-SAPE IN CMA-VARI TO FEC-SEC1
      *         MOVE CLF-NUM-AAPE IN CMA-VARI TO FEC-AEC1
      *         MOVE 'A' TO LDC-IND-PVIG IN LDC-FLD
      *         MOVE FEC-DIF-ANO TO FEC-CMND
      *     ELSE
      *DIF-FEC obtiene la diferencia en dias entre dos fechas
               MOVE LDC-NUM-DINI IN LDC-FLD TO FEC-DEC1.
               MOVE LDC-NUM-MINI IN LDC-FLD TO FEC-MEC1.
               MOVE LDC-NUM-SINI IN LDC-FLD TO FEC-SEC1.
               MOVE LDC-NUM-AINI IN LDC-FLD TO FEC-AEC1.
               MOVE 'D' TO LDC-IND-PVIG IN LDC-FLD.
               MOVE FEC-DIF-DIA TO FEC-CMND.
      *DPR CST  20-FEB-1995 FIN

           MOVE LDC-FEC-FVEN IN LDC-FLD  TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               MOVE 'TAB'   TO MSC-COD-SIST
               MOVE 'IPER'  TO MSC-COD-TMSC IN MSC
               MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO FRM-GLS-PVIG IN LDC-FLD

      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *         IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *             MOVE FEC-NANO TO WSS-NANO IN WSS-VARI
      *             IF WSS-NANO IN WSS-VARI > ZEROES
      *                 MOVE WSS-NANO IN WSS-VARI TO 
      *                      LDC-NUM-PVIG IN LDC-FLD
      *             ELSE
      *                 MOVE 1 TO LDC-NUM-PVIG IN LDC-FLD 
      *         ELSE
                   MOVE FEC-NDIA TO LDC-NUM-PVIG IN LDC-FLD 
      *DPR CST  20-FEB-1995 FIN
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
       FIN-OBT-PVIG.
           EXIT.

       OBT-FVEN SECTION.
       INI-OBT-FVEN.
      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *         MOVE CLF-NUM-DAPE IN CMA-VARI TO FEC-ITM1
      *         MOVE CLF-NUM-MAPE IN CMA-VARI TO FEC-ITM2
      *         MOVE CLF-NUM-SAPE IN CMA-VARI TO FEC-ITM3
      *         MOVE CLF-NUM-AAPE IN CMA-VARI TO FEC-ITM4
      *     ELSE
               MOVE LDC-NUM-DINI IN LDC-FLD TO FEC-ITM1.
               MOVE LDC-NUM-MINI IN LDC-FLD TO FEC-ITM2.
               MOVE LDC-NUM-SINI IN LDC-FLD TO FEC-ITM3.
               MOVE LDC-NUM-AINI IN LDC-FLD TO FEC-ITM4.
      *DPR CST  20-FEB-1995 FIN

           IF LDC-IND-PVIG IN LDC-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AVEN IN WSS-VARI.
       FIN-OBT-FVEN.
           EXIT.

      *FLB 11/NOV/92
       PRO-CIC-OPC SECTION.
       INI-PRO-CIC-OPC.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-OPC
           ELSE
              MOVE CIC-CAI-ICIC TO OPC-CAI-IOPC IN OPC
              MOVE CIC-IIC-ICIC TO OPC-IIC-IOPC IN OPC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-OPC
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-OPC
              ELSE
                 MOVE CIC-CAI-ICIC TO ARC-CAI-IOPC IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARC-IIC-IOPC IN LDC-FLD.
       FIN-PRO-CIC-OPC.
           EXIT.

       PRO-CIC-GDG SECTION.
       INI-PRO-CIC-GDG.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-GDG
           ELSE
              MOVE CIC-CAI-ICIC TO GAR-NUM-SIS IN GDG
              MOVE CIC-IIC-ICIC TO GAR-COD-CRR IN GDG
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GAR-FIO-GDG
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-GDG
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-GDG.
           EXIT.

       PRO-CIC-FIA SECTION.
       INI-PRO-CIC-FIA.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              GO TO FIN-PRO-CIC-FIA
           ELSE
              MOVE CIC-CAI-ICIC TO FIA-CAI-IESC IN FIA
              MOVE CIC-IIC-ICIC TO FIA-IIC-IESC IN FIA
              MOVE 1            TO FIA-NUM-IFIA IN FIA
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM DEU-FIO-FIA
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-FIA
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-FIA.
           EXIT.

       VAL-CON-ARC SECTION.
       INI-VAL-CON-ARC.
      *FLB CST  6-OCT-1994 REVISADA TODA LA SECCION
      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
      * SI SE DIGITA EL TIO O LA MONEDA
           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ( ARC-COD-VCOC IN LDC-FLD > SPACES OR
                ARC-COD-TOOC IN LDC-FLD > SPACES 
              ) AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE 
              )
               MOVE 'IICIOPC>0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-ARC.

           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES
               GO TO FIN-VAL-CON-ARC.

      * FALTA IIC
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              ( WSS-VSN-AOPC NOT = 'S' OR WSS-CIC-TOOC = 'CTE' AND
                USA-CTE 
              )
*% IF PGM_PER
      *<<<< PGM_PER
                  OR
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES
              AND ARC-COD-TOOC IN LDC-FLD = 'CTE'
              AND ARC-COD-AOOC IN LDC-FLD = 'ORD'
      *>>>>
*% END
               PERFORM ERR-GLS
               GO TO FIN-VAL-CON-ARC.

      * OTORGARA EL IIC
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              WSS-VSN-AOPC = 'S'
*% IF PGM_PER
      *<<<< PGM_PER
                  OR
      * ESTA LLENO EL IIC
              ARC-COD-TOOC IN LDC-FLD = 'CTE' AND
              ARC-COD-AOOC IN LDC-FLD = 'ORD'
      *>>>>
*% END
               GO TO FIN-VAL-CON-ARC.

      *FLB CST  6-OCT-1994 PARECE REDUNDANTE
           IF ARC-COD-VCOC IN LDC-FLD = SPACES AND
              ARC-COD-TOOC IN LDC-FLD = SPACES AND
              ARC-COD-AOOC IN LDC-FLD = SPACES
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-VCOC IN LDC-FLD > SPACES AND
              ARC-COD-TOOC IN LDC-FLD > SPACES AND
              ARC-COD-AOOC IN LDC-FLD > SPACES 
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-TOOC IN LDC-FLD > SPACES AND
              ARC-COD-AOOC IN LDC-FLD > SPACES
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-VCOC IN LDC-FLD > SPACES AND
              ARC-COD-TOOC IN LDC-FLD > SPACES
               MOVE 'ERRCONARC'  TO MSG-COD-MENS
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO ERR-VAL-CON-ARC.

      *FLB CST  17-OCT-1994 
      *    IF ARC-COD-TOOC IN LDC-FLD > SPACES
           IF ARC-COD-TOOC IN LDC-FLD > SPACES AND
              WSS-VSN-AXOB NOT = 'S'
               GO TO FIN-VAL-CON-ARC.

           MOVE 'ERRCONARC'  TO MSG-COD-MENS.
           MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD.
           MOVE 'S' TO FRM-UCUR.
       ERR-VAL-CON-ARC.
           MOVE 'DEU'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CON-ARC.
           EXIT.

       BUSCO-CTA-CTE SECTION.
       INI-BUSCO-CTA-CTE.
           MOVE ZEROES TO WSS-CTA-CTE.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO RDC-IIC-ICLF IN RDC.
           MOVE SPACES                  TO RDC-CIC-ICLI IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
               LDC-CAI-ICLF IN LDC-FLD = RDC-CAI-ICLF IN RDC AND
               LDC-IIC-ICLF IN LDC-FLD = RDC-IIC-ICLF IN RDC )
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO FIN-BUSCO-CTA-CTE.
       LUP-BUSCO-CTA-CTE.
           MOVE RDC-CIC-ICLI IN RDC     TO RCO-CIC-ICLI IN RCO.
           MOVE ARC-CAI-IOPC IN LDC-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'RCO    NEX' TO MSG-COD-MENS
               GO TO NXT-BUSCO-CTA-CTE
           ELSE
               IF RCO-COD-STAT IN RCO NOT = 'VIG'
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
                   GO TO NXT-BUSCO-CTA-CTE
               ELSE
                   MOVE 99 TO WSS-CTA-CTE.
           IF WSS-CTA-CTE > ZEROES
               GO TO FIN-BUSCO-CTA-CTE.
       NXT-BUSCO-CTA-CTE.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
               LDC-CAI-ICLF IN LDC-FLD = RDC-CAI-ICLF IN RDC AND
               LDC-IIC-ICLF IN LDC-FLD = RDC-IIC-ICLF IN RDC )
               GO TO LUP-BUSCO-CTA-CTE.
       FIN-BUSCO-CTA-CTE.
           EXIT.

       VAL-CTA-CTE SECTION.
       INI-VAL-CTA-CTE.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCTOPEINEX' TO MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.               

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VLR '               TO TAB-COD-TTAB IN TAB.
           MOVE  OPE-COD-VCOP IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCVLRINEX' TO  MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.               

           MOVE TAB-EXT-CTAB IN TAB TO CTE-MONE.
           MOVE 'READ'              TO CTE-TOPE.
           MOVE RCO-CIC-IOPE IN RCO TO CTE-NCTA.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'AUX '               TO TAB-COD-TTAB IN TAB.
           MOVE  RCO-COD-COPR IN RCO TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCAUXINEX' TO MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.               

           MOVE TAB-EXT-CTAB IN TAB TO CTE-TAUX.
*% IF PGM_PER
      *<<<< PGM_PER          
           MOVE 'BCCRTP01' TO SYS-PROG.
      *>>>>
*% ELSE
      *<<<< NOT PGM_PER
           MOVE 'LDCPSCTE' TO SYS-PROG.
      *>>>>
*% END
           MOVE CTE-CMMA   TO SYS-CMMA.
           MOVE CTE-TCMA   TO SYS-TCMA.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO CTE-CMMA.
       FIN-VAL-CTA-CTE.
           EXIT.
      *AMP-FIN  9-OCT-1993  

       VAL-1-LAV SECTION.
       INI-VAL-1-LAV.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND 
                    LDC-CAI-ICLF IN LDC = LDC-CAI-ICLF IN LDC-FLD AND
                    LDC-IIC-ICLF IN LDC = LDC-IIC-ICLF IN LDC-FLD ) 
               GO TO BRW-VAL-1-LAV.

       LUP-VAL-1-LAV.
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'GNS'   TO MSG-COD-SIST
               GO TO BRW-VAL-1-LAV.

      * ERROR CUANDO :
      * COMANDO ING : YA EXISTE 'MLT' 
      * COMANDO MOD : YA EXISTE 'MLT' EN LDC DISTINTA A LA DE FRM
           IF TAB-CIC-CTAB IN TAB = 'MLT' AND
              ( SCR-CCPP = 'ING' OR
                LDC-NUM-ILDC IN LDC NOT = LDC-NUM-ILDC IN LDC-FLD )
               MOVE 'DEU'   TO MSG-COD-SIST
               MOVE 'MLT SOLO 1'   TO MSG-COD-MENS
               GO TO BRW-VAL-1-LAV.

       NXT-VAL-1-LAV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS AND 
              LDC-CAI-ICLF IN LDC = LDC-CAI-ICLF IN LDC-FLD AND
              LDC-IIC-ICLF IN LDC = LDC-IIC-ICLF IN LDC-FLD
               GO TO LUP-VAL-1-LAV.

       BRW-VAL-1-LAV.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.
       FIN-VAL-1-LAV.
           EXIT.

       ANA-PVIG-FVEN SECTION.
       INI-ANA-PVIG-FVEN.
           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
               PERFORM OBT-FVEN
               MOVE WSS-NUM-DVEN IN WSS-VARI TO LDC-NUM-DVEN IN LDC-FLD
               MOVE WSS-NUM-MVEN IN WSS-VARI TO LDC-NUM-MVEN IN LDC-FLD
               MOVE WSS-NUM-SVEN IN WSS-VARI TO LDC-NUM-SVEN IN LDC-FLD
               MOVE WSS-NUM-AVEN IN WSS-VARI TO LDC-NUM-AVEN IN LDC-FLD
           ELSE
           IF LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
      * ES MLT Y P. VIG Y FVEN VACIOS SE RECHAZARA
               NEXT SENTENCE
           ELSE
           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
      * PVIG Y FVEN deben coincidir
               PERFORM OBT-FVEN
               MOVE LDC-NUM-DVEN IN LDC-FLD TO 
                                            WSS-NUM-DVE1 IN WSS-VARI
               MOVE LDC-NUM-MVEN IN LDC-FLD TO 
                                            WSS-NUM-MVE1 IN WSS-VARI
               MOVE LDC-NUM-SVEN IN LDC-FLD TO
                                            WSS-NUM-SVE1 IN WSS-VARI
               MOVE LDC-NUM-AVEN IN LDC-FLD TO 
                                            WSS-NUM-AVE1 IN WSS-VARI
               IF WSS-FEC-FVEN IN WSS-VARI NOT =
                                            WSS-FEC-FVE1 IN WSS-VARI
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'PVIG<>FVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-ANA-PVIG-FVEN
               ELSE
                   NEXT SENTENCE
           ELSE
           IF LDC-NUM-PVIG IN LDC-FLD NOT > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
               PERFORM OBT-PVIG.

       FIN-ANA-PVIG-FVEN.
           EXIT.

       VAL-FVEN-LAV SECTION.
       INI-VAL-FVEN-LAV.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO FEC-SVLD.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO FEC-AVLD.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO FEC-MVLD.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO FEC-DVLD.

           IF FEC-FVLD > WSS-FEC-FMAX
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'FVEN>MAX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FVEN-LAV.
                       
       FIN-VAL-FVEN-LAV.
           EXIT.

      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       BUS-COR-LDC SECTION.
       INI-BUS-COR-LDC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE 99                      TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
                    LDC-CAI-ICLF IN LDC-FLD = LDC-CAI-ICLF IN LDC AND
                    LDC-IIC-ICLF IN LDC-FLD = LDC-IIC-ICLF IN LDC )
               PERFORM KEY-ALL-LDC.
           IF SCR-CCPP = 'ACT' OR 'ING'
               ADD 1 TO LDC-NUM-ILDC IN LDC.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN LDC-FLD.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.
       FIN-BUS-COR-LDC.
           EXIT.

       OBT-FINI SECTION.
       INI-OBT-FINI.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO FEC-ITM1
           MOVE LDC-NUM-MVEN IN LDC-FLD TO FEC-ITM2
           MOVE LDC-NUM-SVEN IN LDC-FLD TO FEC-ITM3
           MOVE LDC-NUM-AVEN IN LDC-FLD TO FEC-ITM4.

           IF LDC-IND-PVIG IN LDC-FLD = 'D'
              MOVE FEC-RST-DIA  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'M'
              MOVE FEC-RST-MES TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'A'
              MOVE FEC-RST-ANO TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO LDC-NUM-DINI IN LDC-FLD.
           MOVE FEC-ITM2     TO LDC-NUM-MINI IN LDC-FLD.
           MOVE FEC-ITM3     TO LDC-NUM-SINI IN LDC-FLD.
           MOVE FEC-ITM4     TO LDC-NUM-AINI IN LDC-FLD.

       FIN-OBT-FINI.
           EXIT.

      *>>>>
*% END
