      * VALIDA MONEDA DE LDC VS. MONEDA CLF
      * DEBE ESTAR LEIDA LA TABLA TLC Y LLENAS LAS VARIABLES
      * DEBE SABERSE SI NOT PERMITE-MON-LDC-DIF-A-MON-CLF 
       VAL-MON-LDC-CLF SECTION.
       INI-VAL-MON-LDC-CLF.
           PERFORM GET-FHOY.
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1).
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-VAL-MON-LDC-CLF.
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2).

      * VALOR EN PESOS DE CUPO LDC
           IF LDC-COD-VCLC IN LDC = CAM-COD-VCAM IN CAM(2)
               MOVE LDC-VAL-CMAX IN LDC TO WSS-VAL-CMAX
           ELSE
               MOVE LDC-COD-VCLC IN LDC TO CAM-COD-VCAM IN CAM(1)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT (
                       FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
                      )
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE CAM-KEY-CAMB IN CAM TO MSG-GLS-MENS
                   GO TO FIN-VAL-MON-LDC-CLF
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM BY
                            LDC-VAL-CMAX IN LDC GIVING
                            WSS-VAL-CMAX ROUNDED.

           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO VAL-MONTO-LDC-VS-CLF.

      * MONTO LAV NO MENOR AL MINIMO

      * SI MONEDA PANTALLA = MONEDA PARAMETRO LAV
           IF LDC-COD-VCLC IN LDC = WSS-COD-MLAV AND
              LDC-VAL-CMAX IN LDC < WSS-VAL-MMLA
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'MONTOLDC<PRM' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-VAL-MON-LDC-CLF.

      * MONTO OK C/R A PARAMETRO
           IF LDC-COD-VCLC IN LDC = WSS-COD-MLAV
               GO TO VAL-MONTO-LDC-VS-CLF.

      * MONEDA PANTALLA DISTINTA A MONEDA PARAMETRO LAV

      * VALOR EN PESOS DE PARAMETRO DE LAV
           IF WSS-COD-MLAV = CAM-COD-VCAM IN CAM(2)
               MOVE WSS-VAL-MMLA TO WSS-PES-MMLA
           ELSE
               MOVE WSS-COD-MLAV TO CAM-COD-VCAM IN CAM(1)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT (
                       FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
                      )
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE CAM-KEY-CAMB IN CAM TO MSG-GLS-MENS
                   GO TO FIN-VAL-MON-LDC-CLF
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM BY
                            WSS-VAL-MMLA GIVING
                            WSS-PES-MMLA ROUNDED.

           IF WSS-VAL-CMAX < WSS-PES-MMLA
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'MONTOLDC<PRM' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-VAL-MON-LDC-CLF.

       VAL-MONTO-LDC-VS-CLF.

           IF NOT PERMITE-MON-LDC-DIF-A-MON-CLF 
               GO TO YA-VALIDO-MONTO-LDC-VS-CLF.

      * VALOR EN PESOS DE CLF
           IF CLF-COD-VCCF IN CLF = CAM-COD-VCAM IN CAM(2)
               MOVE CLF-VAL-CMAX IN CLF TO WSS-CLF-CMAX
           ELSE
               MOVE CLF-COD-VCCF IN CLF TO CAM-COD-VCAM IN CAM(1)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT (
                       FIO-STAT-OKS AND CAM-IND-VIGE IN CAM = 'S'
                      )
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE CAM-KEY-CAMB IN CAM TO MSG-GLS-MENS
                   GO TO FIN-VAL-MON-LDC-CLF
               ELSE
                   MULTIPLY CAM-SGV-VCAM IN CAM BY
                            CLF-VAL-CMAX IN CLF GIVING
                            WSS-CLF-CMAX ROUNDED.

           IF WSS-VAL-CMAX > WSS-CLF-CMAX 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'MONTOLDC>CLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-VAL-MON-LDC-CLF.
       YA-VALIDO-MONTO-LDC-VS-CLF.
       FIN-VAL-MON-LDC-CLF.
           EXIT.

