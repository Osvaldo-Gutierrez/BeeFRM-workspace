*%! Codigo adicional para archivo LDCPALDC
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*% LARGO_TOTAL_COMMAREA = 566
*% IF PGM_DTC 
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% END
*% IF PGM_BMS AND FIN_SCR_VARI
      *<<<< PGM_BMS AND FIN_SCR_VARI
       COPY LDCWGENG.
           03 SCR-IND-MCLI  VALUE SPACES            PIC X(01).
           03 SCR-IND-OCIC  VALUE SPACES            PIC X(01).
      *JSS-INI 21-MAR-1994
      *    03 SCR-CLF-DISP  VALUE SPACES            PIC X(62).
           03 SCR-COD-TOGA  VALUE SPACES            PIC X(03).
           03 SCR-COD-OFIC  VALUE SPACES            PIC X(03).
           03 SCR-COD-EJEC  VALUE SPACES            PIC X(12).
*% IF PGM_ARG
      *<<<< PGM_ARG
           03 SCR-NUM-ICLI  VALUE SPACES            PIC X(11).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
           03 SCR-NUM-ICLI  VALUE SPACES            PIC X(08).
      *>>>>
*% END
           03 SCR-VRF-ICLI  VALUE SPACES            PIC X(01).
           03 SCR-IND-ICLI  VALUE SPACES            PIC X(01).
*% IF PGM_ARG
      *<<<< PGM_ARG
           03 SCR-GLS-ICLI  VALUE SPACES            PIC X(02).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
           03 SCR-GLS-ICLI  VALUE SPACES            PIC X(03).
      *>>>>
*% END
           03 SCR-VAL-CMAX  VALUE ZEROES            PIC 9(11).
           03 SCR-COD-VCCF  VALUE SPACES            PIC X(06).
           03 SCR-COD-TOOC  VALUE SPACES            PIC X(03).
           03 SCR-COD-AOOC  VALUE SPACES            PIC X(03).
      *    03 SCR-CLF-DISP  VALUE SPACES            PIC X(08).
           03 SCR-COD-VCOC  VALUE SPACES            PIC X(06).
*% IF PGM_ARG
      *<<<< PGM_ARG
      *    03 SCR-CLF-DISP  VALUE SPACES            PIC X(00).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
           03 SCR-CLF-DISP  VALUE SPACES            PIC X(02).
      *>>>>
*% END
      *JSS-FIN 21-MAR-1994
      *FLB CST  11-MAY-1994 FIN

           03 CMA-VARI.
              05 ARG-CAI-IGAR                       PIC X(04).
      * Si > zeroes, en CMN-ING enganchar a GAR y/o FIA
              05 ARG-IIC-IGAR                       PIC 9(08).
      * Si > zeroes, en CMN-ING enganchar a GAR y/o FIA
              05 ARC-CAI-IOPC                       PIC X(04).
              05 ARC-IIC-IOPC                       PIC 9(08).
              05 CMA-NUM-ARC                        PIC 9(01).
              05 CMA-NUM-ARG                        PIC 9(01).
              05 CLF-FEC-FAPE.
                 07 CLF-NUM-DAPE                    PIC 9(02).
                 07 CLF-NUM-MAPE                    PIC 9(02).
                 07 CLF-NUM-SAPE                    PIC 9(02).
                 07 CLF-NUM-AAPE                    PIC 9(02).
              05 CLF-FEC-FVEN.
                 07 CLF-NUM-SVEN                    PIC 9(02).
                 07 CLF-NUM-AVEN                    PIC 9(02).
                 07 CLF-NUM-MVEN                    PIC 9(02).
                 07 CLF-NUM-DVEN                    PIC 9(02).
              05 CLF-NUM-PVIG                       PIC 9(03).
              05 CLF-IND-PVIG                       PIC X(01).
*% IF PGM_ARG
      *<<<< PGM_ARG
              05 CLF-VAL-CMAX    COMP-3             PIC S9(13)V9(2).
      *>>>>
*% ELSE
      *<<<< NOT PGM_ARG
              05 CLF-VAL-CMAX    COMP-3             PIC S9(11)V9(4).
      *>>>>
*% END
              05 CMA-IND-IOPC                       PIC X(01).
      *FLB CST  23-JUN-1994
              05 CMA-IND-IGAR                       PIC X(01).
              05 SCR-LDC-DISP  VALUE SPACES         PIC X(34).
      *FLB CST  23-JUN-1994 FIN
      *>>>>
*% END
*%!LTM-INI Codigo adicional para paginacion de pantalla LTM-12/04/1994
*% IF PGM_PQ
*% FRM = 'LDC'
*% 
*% PADRE = 'LDC'
*% KEY_PADRE = 'LDC-KEY-ILDC'
*% LARGO_KEY_PADRE = 14
*% FIO_PADRE = 'LDC-FIO-LDC'
*% SIST_PADRE = 'LDC'
*% KEY_BROWSE_PADRE = 'LDC-KEY-ILDC'
*% ORG_PADRE_VSI = TRUE
*% RELACION_ENTIDAD = 'LDC-CIC-ICLF'
*% LARGO_RELACION_ENTIDAD = 12
*%
*% ACEPTE_PF5 = TRUE
*% ACEPTE_PF6 = TRUE
*%
*% INCLUDE 'GNSSRC:PFSCONENT.SRC'
*% END
*% 
*%!LTM-FIN Fin codigo adicional para paginacion de pantalla LTM-12/04/1994
*% IF FIN_PGM_STAT AND PGM_CHI
      *<<<< FIN_PGM_STAT AND PGM_CHI
*% IF PGM_PQ
      *<<<< PGM_PQ
              05 PGM-STAT-WSS.
                 88 PGM-STAT-WSS-NUL    VALUE '  '.
                 07 PGM-STT1-WSS        VALUE '2' PIC X(01).
                    88 PGM-STAT-WSS-OKS VALUE '0'.
                 07 PGM-STT2-WSS        VALUE '3' PIC X(01).
      *>>>>
*% END
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_BMS
      *<<<< PGM_BMS
       COPY LDCWGPMP.
      *>>>>
*% END
*% IF PGM_PQ
      *<<<< PGM_PQ
       COPY LDCWGVCL.
      *>>>>
*% END
*% IF PGM_PU
      *<<<< PGM_PU
       01  PGM-STAT-ADIC.
           05 PGM-STAT-GDG           VALUE '23'      PIC X(02).
              88 PGM-STAT-GDG-OKS    VALUE '00'.
              88 PGM-STAT-GDG-NUL    VALUE '  '.
           05 PGM-STAT-FIA           VALUE '23'      PIC X(02).
              88 PGM-STAT-FIA-OKS    VALUE '00'.
              88 PGM-STAT-FIA-NUL    VALUE '  '.
      *>>>>
*% END
       01  WSS-VARI.
*% IF PGM_PU
      *<<<< PGM_PU
      *SMC-INI 26-10-1993
           03  WSS-VSN-VCTE                       PIC X(01).
               88  USA-CTE       VALUE 'N'.
           03  WSS-VSN-VCEX                       PIC X(01).
               88  USA-CEX       VALUE 'N'.
           03  WSS-VSN-VTCR                       PIC X(01).
               88  USA-TCR       VALUE 'N'.
           03  WSS-VSN-VLEA                       PIC X(01).
               88  USA-LEA       VALUE 'N'.
      *SMC-FIN 26-10-1993

      *FLB CST   21-FEB-1995 PARAMETROS LINEA AVANCE
           03  WSS-GLS-DATA.
               05 WSS-NUM-PLAV                    PIC 9(03).
               05 WSS-COD-PLAV                    PIC X(01).
               05 FILLER                          PIC X(01).
               05 WSS-IND-VTOL                    PIC X(01).
               05 FILLER                          PIC X(14).
               05 WSS-COD-MLAV                    PIC X(06).
               05 WSS-VAL-MMLA                    PIC 9(09).
           03  WSS-VAL-CMAX   VALUE ZEROES        PIC 9(15).
           03  WSS-PES-MMLA   VALUE ZEROES        PIC 9(15).
           03  WSS-CLF-CMAX   VALUE ZEROES        PIC 9(15).
           03  WSS-VSN-MLMC   VALUE SPACES        PIC X(01).
               88 PERMITE-MON-LDC-DIF-A-MON-CLF VALUE 'S'.
           03  WSS-FEC-FMAX.
               05  WSS-NUM-SMAX                   PIC 9(02).
               05  WSS-NUM-AMAX                   PIC 9(02).
               05  WSS-NUM-MMAX                   PIC 9(02).
               05  WSS-NUM-DMAX                   PIC 9(02).
      *FLB CST   9-MAR-1995
           03  WSS-SIS-DATA.
               05 WSS-IND-DEUD                    PIC X(01).
                  88 TIO-DE-DEUDA VALUE 'D'.

           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI                   PIC 9(02).
               05  WSS-NUM-AINI                   PIC 9(02).
               05  WSS-NUM-MINI                   PIC 9(02).
               05  WSS-NUM-DINI                   PIC 9(02).

           03  WSS-FEC-FAPE.
               05  WSS-NUM-SAPE                   PIC 9(02).
               05  WSS-NUM-AAPE                   PIC 9(02).
               05  WSS-NUM-MAPE                   PIC 9(02).
               05  WSS-NUM-DAPE                   PIC 9(02).
      *>>>>
*% END
      *LTM-INI 13.04.1994
           03  WSS-IFIN          VALUE SPACES     PIC X(01).
      *LTM-FIN 13.04.1994
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-COD-COPE.
               05  WSS-COD-TOPE                   PIC X(03).
               05  WSS-COD-AOPE                   PIC X(03).
           03  WSS-NUM-PER                        PIC 9(03).
           03  WSS-IND-PER                        PIC X(01).
           03  ARC-KEY-IARC.
               05  ARC-KEY-ILDC.
                   07  ARC-CAI-ICLF               PIC X(04).
                   07  ARC-IIC-ICLF               PIC 9(08).
*% IF PGM_DB2
      *<<<< PGM_DB2
                   07  ARC-NUM-ILDC   COMP        PIC S9(04).
               05  ARC-NUM-IARC       COMP        PIC S9(04).
      *>>>>
*% ELSE
      *<<<< NOT PGM_DB2
                   07  ARC-NUM-ILDC               PIC 9(02).
               05  ARC-NUM-IARC                   PIC 9(01).
      *>>>>
*% END
           03  ARG-KEY-IARG.
               05  ARG-KEY-ILDC.
                   07  ARG-CAI-ICLF               PIC X(04).
                   07  ARG-IIC-ICLF               PIC 9(08).
*% IF PGM_DB2
      *<<<< PGM_DB2
                   07  ARG-NUM-ILDC  COMP         PIC S9(04).
               05  ARG-NUM-IARG      COMP         PIC S9(04).
      *>>>>
*% ELSE
      *<<<< NOT PGM_DB2
                   07  ARG-NUM-ILDC               PIC 9(02).
               05  ARG-NUM-IARG                   PIC 9(01).
      *>>>>
*% END
           03  WSS-NDIA       VALUE ZEROES        PIC 9(04).
           03  WSS-NANO       VALUE ZEROES        PIC 9(06).
           03  WSS-MOV        VALUE ZEROES        PIC 9(02).
           03  WSS-FS-ARC     VALUE ZEROES        PIC 9(02).

           03  WSS-FEC-FVEN.
               05  WSS-NUM-SVEN                   PIC 9(02).
               05  WSS-NUM-AVEN                   PIC 9(02).
               05  WSS-NUM-MVEN                   PIC 9(02).
               05  WSS-NUM-DVEN                   PIC 9(02).
           03  WSS-FEC-FVE1.
               05  WSS-NUM-SVE1                   PIC 9(02).
               05  WSS-NUM-AVE1                   PIC 9(02).
               05  WSS-NUM-MVE1                   PIC 9(02).
               05  WSS-NUM-DVE1                   PIC 9(02).
           03  WSS-CIC-TOCF   VALUE SPACES        PIC X(12).
*% IF PGM_PU
      *<<<< PGM_PU
           03  WSS-CIC-TOOC   VALUE SPACES        PIC X(12).
           03  WSS-CTA-CTE    VALUE ZEROES        PIC 9(02).
           03  WSS-VSN-OCAI                       PIC X(01).
      *FLB CST  10-OCT-1994 ASIGNA EL IIC DE LA OPC
           03  WSS-VSN-AOPC                       PIC X(01).
      *FLB CST  17-OCT-1994 PERMITE O NO TIO SIN AUX
           03  WSS-VSN-AXOB                       PIC X(01).

      *>>>>
*% END
*% IF PGM_DB2
      *<<<< PGM_DB2
           EXEC SQL INCLUDE LDCBRCLF END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-CLF-REQA==.
           EXEC SQL INCLUDE LDCBRARC END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-ARC-REQA==.
           EXEC SQL INCLUDE LDCBRARG END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-ARG-REQA==.
           EXEC SQL INCLUDE LDCBRRDC END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-RDC-REQA==.
*% IF PGM_PU
      *<<<< PGM_PU
           EXEC SQL INCLUDE DEUBRFIA END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-FIA-REQA==.
           EXEC SQL INCLUDE COLBROPC END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-OPC-REQA==.
      *>>>>
*% END           
*% ELSE
      *<<<< NOT PGM_DB2
       COPY LDCBRCLF.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY LDCBRRDC.
*% IF PGM_PU
      *<<<< PGM_PU
       COPY DEUBRFIA.
       COPY COLBROPC.
      *>>>>
*% END           
*% END

*% IF NOT PGM_PQ
      *<<<< NOT PGM_PQ
*% IF PGM_BSH
       COPY GARBRGDG.
*% ELSE
*% IF PGM_DB2
           EXEC SQL INCLUDE GARBRGDG END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-GDG-REQA==.
*% ELSE
       COPY GARBRGDG.
*% END
*% END
*% END

*% IF PGM_BSH
       COPY GARBRTAG.
*% ELSE
*% IF PGM_DB2
           EXEC SQL INCLUDE GARBRTAG END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-TAG-REQA==.
*% ELSE
       COPY GARBRTAG.
*% END
*% END

*% IF PGM_DB2
           EXEC SQL INCLUDE SGCBRDBC END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-DBC-REQA==.
*% ELSE
       COPY SGCBRDBC.
*% END

       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY GNSWGCPT.         
       COPY TABBRTIO.
*% IF PGM_PU
      *<<<< PGM_PU
      *FLB CST  22-FEB-1995
       COPY TABBRCAM.
      *FLB CST  14-OCT-1993 
       COPY TABWGCTE.
*% IF PGM_DB2
           EXEC SQL INCLUDE SGCBROPE END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-OPE-REQA==.
           EXEC SQL INCLUDE SGCBRRCO END-EXEC.
       COPY GNSWGRQS REPLACING ==SQL-REQA== BY ==SQL-RCO-REQA==.
*% ELSE
       COPY SGCBROPE.
       COPY SGCBRRCO.
*% END
      *FLB CST  14-OCT-1993 

      *FLB CST  10-OCT-1994 VALIDA TIPO DE LINEA
       COPY LDCWGTLC.
      *>>>>
*% END           
*% IF PGM_DTC
      *<<<< PGM_DTC

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
*% IF PGM_PU
      *<<<< PGM_PU
      *FLB CST  27-FEB-1995 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.

      *FLB CST  14-OCT-1993 1
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
*% ELSE
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
      *>>>>
*% END
      *>>>>
*% END
      *>>>>
*% END
*% IF SYS_SCOD AND PGM_DB2
      *<<<< SYS_SCOD AND PGM_DB2
      *JSS-IBM
           IF SYS-SCOD = 'SD'
*%!            MOVE +{gnstca} TO SYS-TCMA
               MOVE +9000     TO SYS-TCMA
               EXEC CICS RETRIEVE
                 INTO(SCR-VARI) LENGTH(SYS-TCMA)
               END-EXEC.
      *>>>>
*% END
*% IF INI_FIO 
      *<<<< INI_FIO 
*% IF PGM_PQ
      *<<<< PGM_PQ
           MOVE SPACES TO ARG-CAI-IGAR IN CMA-VARI.
           MOVE ZEROES TO ARG-IIC-IGAR IN CMA-VARI.
*% IF PGM_CHI AND PGM_BCI
      *<<<< ISP-INI  24-JAN-1996 11:35:48 
           IF SCR-OFRM-SRV
              MOVE WSS-IDX-ILDC TO SCR-IPRO
           ELSE
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
*% END
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-VEC-ENG
               MOVE WSS-IDX-ILDC TO SCR-IPRO
*% IF PGM_CHI AND PGM_BCI
      *<<<< ISP-INI  24-JAN-1996 11:35:48
      * ISP ( REVERTIR LINES COMENTARIADAS Y COMENTARIAR LAS OTRAS )
               MOVE 'L' TO SCR-IND-COL.
      *         MOVE 'L' TO SCR-IND-COL
      *    ELSE
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
*% END
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC AND
              SCR-IND-COL = 'C'
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE SPACES TO MSG-COD-MENS
               PERFORM ING-FPEN-CIC
           ELSE
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE SPACES TO SCR-VEC-ENG
               MOVE WSS-IDX-ILDC TO SCR-IPRO
               MOVE 'L' TO SCR-IND-COL
               MOVE LOW-VALUES TO LDC-FLD
               MOVE 'ING' TO SCR-CCPP SCR-CMND
               MOVE SCR-INST-HKY TO SCR-INST
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM ING-SETE
               PERFORM SCR-INIT
               MOVE 'C' TO SCR-ICMN
               MOVE ZEROES TO SCR-INST-EXT.
      *>>>>
*% END
*% IF PGM_VMS
      *<<<< INI_FIO AND PGM_VMS

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-CIC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-CIC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'DEU'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'DEU'        TO FIO-SIST.
           PERFORM DEU-FIO-FIA.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM DEU-FIO-FIA.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'LDC'        TO FIO-SIST.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'LDC'        TO FIO-SIST.
           PERFORM LDC-FIO-ARC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'LDC'        TO FIO-SIST.
           PERFORM LDC-FIO-ARG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GAR'        TO FIO-SIST.
           PERFORM GAR-FIO-GDG.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GAR-FIO-GDG.

      *>>>>
*% END
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE ZEROES TO CMA-NUM-ARC IN CMA-VARI.
           MOVE ZEROES TO CMA-NUM-ARG IN CMA-VARI.
      *FLB CST  23-JUN-1994
           MOVE SPACES TO CMA-IND-IGAR IN CMA-VARI.
           MOVE SPACES TO CMA-IND-IOPC IN CMA-VARI.
           MOVE SPACES TO ARC-CAI-IOPC IN CMA-VARI.
           MOVE ZEROES TO ARC-IIC-IOPC IN CMA-VARI.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP = 'ING' AND PGM-STAT-LDC-OKS OR
              SCR-CCPP NOT = 'ING' AND NOT PGM-STAT-LDC-OKS 
               GO TO FIN-FND-KEY.
      *LTM-INI 13.04.1994
           IF (SCR-CCPP = 'ING') OR (SCR-CCPP = 'ACT' AND
               NOT PGM-STAT-LDC-OKS)
               PERFORM BUS-ENT-ANEX
               IF WSS-IFIN = 'S'
                   GO TO FIN-FND-KEY.
      *LTM-FIN 13.04.1994
           MOVE PGM-STAT-LDC TO FIO-STAT.

      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           IF LDC-IND-MGAR IN LDC-FLD = 'E'
               MOVE 'U' TO LDC-IND-MGAR IN LDC.

      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
      *JVM: Modifica ARC sin Multiples
       MOD-ARC.
           IF CMA-NUM-ARC IN CMA-VARI > 1
               GO TO MOD-ARG.

           IF CMA-NUM-ARC IN CMA-VARI = 0
               GO TO EXA-CERO-ARC.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARC-CAI-ICLF IN ARC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARC-IIC-ICLF IN ARC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARC-NUM-ILDC IN ARC.
           MOVE 1                       TO ARC-NUM-IARC IN ARC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.

           IF ARC-COD-VCOC IN LDC-FLD = SPACES AND
              ARC-COD-TOOC IN LDC-FLD = SPACES AND
              ARC-COD-AOOC IN LDC-FLD = SPACES AND
              ARC-IIC-IOPC IN LDC-FLD = ZEROES 
               MOVE FIO-DEL TO FIO-CMND
           ELSE
               PERFORM RET-ARC-LDC
               MOVE CMA-IND-IOPC IN CMA-VARI TO ARC-IND-IOPC IN ARC
               MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.

           GO TO MOD-ARG.

       EXA-CERO-ARC.
           IF ARC-COD-VCOC IN LDC-FLD = SPACES AND
              ARC-COD-TOOC IN LDC-FLD = SPACES AND
              ARC-COD-AOOC IN LDC-FLD = SPACES AND
              ARC-IIC-IOPC IN LDC-FLD = ZEROES 
               GO TO MOD-ARG.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARC-CAI-ICLF IN ARC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARC-IIC-ICLF IN ARC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARC-NUM-ILDC IN ARC.
           MOVE 1                       TO ARC-NUM-IARC IN ARC.
           PERFORM RET-ARC-LDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD
           ELSE
               GO TO MOD-ARG.

      *JVM: Modifica ARG sin Multiples
       MOD-ARG.
           IF CMA-NUM-ARG IN CMA-VARI > 1
               GO TO MOD-CLF.

           IF CMA-NUM-ARG IN CMA-VARI = 0
               GO TO EXA-CERO-ARG.

           IF LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O'
               GO TO MOD-CLF.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARG-CAI-ICLF IN ARG.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARG-IIC-ICLF IN ARG.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARG-NUM-ILDC IN ARG.
           MOVE 1                       TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.

           IF LDC-IND-MGAR IN LDC-FLD = 'S'
               MOVE FIO-DEL TO FIO-CMND
           ELSE
      * LDC-IND-MGAR IN LDC-FLD = 'U' OR 'E'
               PERFORM RET-ARG-LDC
               MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.

           GO TO MOD-CLF.

       EXA-CERO-ARG.
           IF LDC-IND-MGAR IN LDC-FLD = 'S' OR 'Y' OR 'O'
               GO TO MOD-CLF.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARG-CAI-ICLF IN ARG.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARG-IIC-ICLF IN ARG.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARG-NUM-ILDC IN ARG.
           MOVE 1                       TO ARG-NUM-IARG IN ARG.
           PERFORM RET-ARG-LDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD
           ELSE
               GO TO MOD-CLF.

       MOD-CLF.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      * AMP 19-OCT-1993 (DECIA FIN-CMN-ELI)
           MOVE 'I' TO CLF-MSC-STAT IN CLF.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
      *SMC-INI 23-11-1993, CUANDO SE INGRESA UNA LDC, LA CLF
      *                    QUEDA EN ESTADO DE INGRESADA.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.

           MOVE 'I' TO CLF-MSC-STAT IN CLF.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.

      *SMC-FIN 23-11-1993

      *FLB CST  10-JUN-1994 CAMBIADO AL ELIMINAR 'M' DE VCOC
           IF ARC-COD-VCOC IN LDC-FLD > SPACES OR
              ARC-COD-TOOC IN LDC-FLD > SPACES OR
              ARC-COD-AOOC IN LDC-FLD > SPACES OR
              ARC-IIC-IOPC IN LDC-FLD > ZEROES
               PERFORM PUT-ARC
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   GO TO FIN-CMN-ING.

           IF LDC-IND-MGAR IN LDC-FLD = 'U' OR 'E'
               PERFORM PUT-ARG
               IF NOT FIO-STAT-OKS
                   MOVE FIO-MENS TO FRM-MENS
                   GO TO FIN-CMN-ING.

      *ALD-BNL ELIMINADO 22/JUL/92
*% IF PGM_BMS
      *<<<< PGM_BMS
      *FLB 22/JUL/92
               PERFORM ENG-PGM.
               IF SCR-IND-COL = 'C' 
                   PERFORM EGR-FPEN-CIC
               ELSE
                   IF WSS-IENG = 'S'
                       PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           PERFORM DEL-ARC.
           PERFORM DEL-ARG.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE 'I' TO CLF-MSC-STAT IN CLF.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *>>>>
*% END
*% IF PGM_BMS AND GET_FLD 
      *<<<< PGM_BMS AND GET_FLD
           IF FRM-FFLD = FRM-FFLD-PF10 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
              MOVE SCR-STAT-ABT TO SCR-STAT                             
               IF SCR-IND-COL = 'C'
                   MOVE WSS-TOT-IIDX TO SCR-IPRO
                   PERFORM EGR-FTER-CIC                                  
               ELSE
                   SUBTRACT 1 FROM WSS-IDX-ILDC GIVING SCR-IPRO
                   GO TO FIN-GET-FLD.                                    
      *>>>>
*% END
*% IF PGM_BMS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD)
      *<<<< PGM_BMS AND (FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD)
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S' AND
              SCR-IND-COL = 'C'
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBPFEC.
*% IF PGM_DB2
      *<<<< PGM_DB2
           EXEC SQL INCLUDE LDCBFCLF END-EXEC.
           EXEC SQL INCLUDE LDCBFARC END-EXEC.
           EXEC SQL INCLUDE LDCBFARG END-EXEC.
           EXEC SQL INCLUDE LDCBFRDC END-EXEC.
*% IF PGM_PU
      *<<<< PGM_PU
           EXEC SQL INCLUDE DEUBFFIA END-EXEC.
           EXEC SQL INCLUDE COLBFOPC END-EXEC.
      *>>>>
*% END           
      *>>>>
*% ELSE
      *<<<< NOT PGM_DB2
       COPY LDCBFCLF.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY LDCBFRDC.

*% IF PGM_PU
      *<<<< PGM_PU
       COPY DEUBFFIA.
       COPY COLBFOPC.
      *>>>>
*% END           
      *>>>>
*% END

*% IF NOT PGM_PQ
*% IF PGM_BSH
       COPY GARBFGDG.
*% ELSE
*% IF PGM_DB2
           EXEC SQL INCLUDE GARBFGDG END-EXEC.
*% ELSE
       COPY GARBFGDG.
*% END
*% END
*% END

*% IF PGM_BSH
       COPY GARBFTAG.
*% ELSE
*% IF PGM_DB2
           EXEC SQL INCLUDE GARBFTAG END-EXEC.
*% ELSE
       COPY GARBFTAG.
*% END
*% END

*% IF PGM_DB2
           EXEC SQL INCLUDE SGCBFDBC END-EXEC.
*% ELSE
       COPY SGCBFDBC.
*% END

       COPY GNSBFCIC.
*% IF NOT PGM_PQ
      *<<<< NOT PGM_PQ
       COPY GNSBGCIC.
      *FLB CST  14-OCT-1993 
*% IF PGM_DB2
           EXEC SQL INCLUDE SGCBFOPE END-EXEC.
           EXEC SQL INCLUDE SGCBFRCO END-EXEC.
*% ELSE
       COPY SGCBFOPE.
       COPY SGCBFRCO.
*% END

      *FLB CST  10-OCT-1994 VALIDA TIPO DE LINEA
       COPY LDCBVTLC.
      *FLB CST  13-MAR-1995 VALIDA MONEDA LDC VS. CLF
       COPY LDCBVMLC.
      *>>>>
*% END           

       COPY GNSBGCPT.
*% IF PGM_PQ
      *<<<< PGM_PQ
       GET-ARC SECTION.
       INI-GET-ARC.
           MOVE '00' TO FIO-STAT.
           MOVE LDC-CAI-ICLF IN LDC TO ARC-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC TO ARC-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC TO ARC-NUM-ILDC IN WSS-VARI.
           MOVE ZEROES              TO ARC-NUM-IARC IN WSS-VARI.
           MOVE ARC-KEY-IARC IN WSS-VARI TO ARC-KEY-IARC IN ARC.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT ( FIO-STAT-OKS AND
                    ARC-KEY-ILDC IN WSS-VARI = ARC-KEY-ILDC IN ARC )
               MOVE '23' TO PGM-STAT-ARC
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM LDC-FIO-ARC
                   GO TO FIN-GET-ARC
               ELSE
                   GO TO FIN-GET-ARC.

           MOVE ARC-KEY-IARC IN ARC TO ARC-KEY-IARC IN WSS-VARI.
       LUP-ARC.
           ADD 1 TO CMA-NUM-ARC IN CMA-VARI.
           IF CMA-NUM-ARC IN CMA-VARI > 1
               MOVE '00' TO PGM-STAT-ARC
      *Existen multiples ARC
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC
               GO TO FIN-GET-ARC.

       NXT-LUP-ARC.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS AND
              ARC-KEY-ILDC IN WSS-VARI = ARC-KEY-ILDC IN ARC
               GO TO LUP-ARC.

       END-LUP-ARC.
      *Existe 1 unico ARC
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           MOVE ARC-KEY-IARC IN WSS-VARI TO ARC-KEY-IARC IN ARC.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-ARC.
           IF ARC-IIC-IOPC IN ARC > ZEROES
               MOVE ARC-CAI-IOPC IN ARC TO ARC-CAI-IOPC IN CMA-VARI
               MOVE ARC-IIC-IOPC IN ARC TO ARC-IIC-IOPC IN CMA-VARI
               MOVE ARC-IND-IOPC IN ARC TO CMA-IND-IOPC IN CMA-VARI.
       FIN-GET-ARC.
           EXIT.

       GET-ARG SECTION.
       INI-GET-ARG.
           MOVE '00' TO FIO-STAT.
           MOVE LDC-CAI-ICLF IN LDC TO ARG-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC TO ARG-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC TO ARG-NUM-ILDC IN WSS-VARI.
           MOVE ZEROES              TO ARG-NUM-IARG IN WSS-VARI.
           MOVE ARG-KEY-IARG IN WSS-VARI TO ARG-KEY-IARG IN ARG.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT ( FIO-STAT-OKS AND
                    ARG-KEY-ILDC IN WSS-VARI = ARG-KEY-ILDC IN ARG )
               MOVE '23' TO PGM-STAT-ARG
               IF FIO-STAT-OKS
                   MOVE FIO-END-BRW TO FIO-CMND
                   PERFORM LDC-FIO-ARG
                   GO TO FIN-GET-ARG
               ELSE
                   GO TO FIN-GET-ARG.

           MOVE ARG-KEY-IARG IN ARG TO ARG-KEY-IARG IN WSS-VARI.
       LUP-ARG.
           ADD 1 TO CMA-NUM-ARG IN CMA-VARI.
           IF CMA-NUM-ARG IN CMA-VARI > 1
               MOVE '00' TO PGM-STAT-ARG
      *Existen multiples ARG
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG
               GO TO FIN-GET-ARG.

       NXT-LUP-ARG.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS AND
              ARG-KEY-ILDC IN WSS-VARI = ARG-KEY-ILDC IN ARG
               GO TO LUP-ARG.

       END-LUP-ARG.
      *Existe 1 unico ARG
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           MOVE ARG-KEY-IARG IN WSS-VARI TO ARG-KEY-IARG IN ARG.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-ARG.
       FIN-GET-ARG.
           EXIT.
      *>>>>
*% END
*% IF PGM_PU
      *<<<< PGM_PU
       PUT-ARC SECTION.
       INI-PUT-ARC.
           MOVE '00' TO FIO-STAT.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARC-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARC-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARC-NUM-ILDC IN WSS-VARI.
           MOVE 9                       TO ARC-NUM-IARC IN WSS-VARI.
           MOVE ARC-KEY-IARC IN WSS-VARI TO ARC-KEY-IARC IN ARC.

           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT ( FIO-STAT-OKS AND
                    ARC-KEY-ILDC IN WSS-VARI = ARC-KEY-ILDC IN ARC )
               MOVE ZEROES TO ARC-NUM-IARC IN ARC.

           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           IF ARC-NUM-IARC IN ARC = 9
              GO TO FIN-PUT-ARC.

       GEN-ARC.
           ADD 1                        TO ARC-NUM-IARC IN ARC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARC-CAI-ICLF IN ARC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARC-IIC-ICLF IN ARC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARC-NUM-ILDC IN ARC.
           MOVE ARC-COD-VCOC IN LDC-FLD TO ARC-COD-VCOC IN ARC.
           MOVE ARC-COD-TOOC IN LDC-FLD TO ARC-COD-TOOC IN ARC.
           MOVE ARC-COD-AOOC IN LDC-FLD TO ARC-COD-AOOC IN ARC.
           MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC IN ARC.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC IN ARC.
           MOVE SPACES                  TO ARC-GLS-DISP IN ARC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS.
       FIN-PUT-ARC.
           EXIT.

       PUT-ARG SECTION.
       INI-PUT-ARG.
           MOVE '00' TO FIO-STAT.
           MOVE LDC-CAI-ICLF IN LDC-FLD  TO ARG-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC-FLD  TO ARG-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC-FLD  TO ARG-NUM-ILDC IN WSS-VARI.
           MOVE 9                        TO ARG-NUM-IARG IN WSS-VARI.
           MOVE ARG-KEY-IARG IN WSS-VARI TO ARG-KEY-IARG IN ARG.

           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT ( FIO-STAT-OKS AND
                    ARG-KEY-ILDC IN WSS-VARI = ARG-KEY-ILDC IN ARG )
               MOVE ZEROES TO ARG-NUM-IARG IN ARG.

           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           IF ARG-NUM-IARG IN ARG = 9
              GO TO FIN-PUT-ARG.

       GEN-ARG.
           ADD 1                        TO ARG-NUM-IARG IN ARG.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO ARG-CAI-ICLF IN ARG.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO ARG-IIC-ICLF IN ARG.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO ARG-NUM-ILDC IN ARG.
           MOVE ARG-COD-TOGA IN LDC-FLD TO ARG-COD-TOGA IN ARG.
           MOVE ARG-COD-AOGA IN LDC-FLD TO ARG-COD-AOGA IN ARG.
           MOVE ARG-NUM-PORG IN LDC-FLD TO ARG-NUM-PORG IN ARG.
           MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR IN ARG.
           MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR IN ARG.
           MOVE SPACES                  TO ARG-GLS-DISP IN ARG.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS.
       FIN-PUT-ARG.
           EXIT.

       DEL-ARC SECTION.
       INI-DEL-ARC.
           MOVE LDC-CAI-ICLF IN LDC-FLD  TO ARC-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC-FLD  TO ARC-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC-FLD  TO ARC-NUM-ILDC IN WSS-VARI.
           MOVE ZEROES                   TO ARC-NUM-IARC IN ARC.
           MOVE ARC-KEY-IARC IN WSS-VARI TO ARC-KEY-IARC IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARC.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           IF NOT ( FIO-STAT-OKS AND
              ARC-KEY-ILDC IN WSS-VARI = ARC-KEY-ILDC IN ARC )
               GO TO FIN-DEL-ARC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-ARC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'ARC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARC.

           MOVE ARC-KEY-ILDC IN WSS-VARI TO ARC-KEY-ILDC IN ARC.
*% IF PGM_DB2 
      *<<<< PGM_DB2
           MOVE FIO-GET-NXT TO FIO-CMND.
      *>>>>
*% ELSE
      *<<<< NOT PGM_DB2
           MOVE FIO-GET-NLS TO FIO-CMND.
      *>>>>
*% END
           GO TO LUP-DEL-ARC.
       FIN-DEL-ARC.
           EXIT.

       DEL-ARG SECTION.
       INI-DEL-ARG.
           MOVE LDC-CAI-ICLF IN LDC-FLD  TO ARG-CAI-ICLF IN WSS-VARI.
           MOVE LDC-IIC-ICLF IN LDC-FLD  TO ARG-IIC-ICLF IN WSS-VARI.
           MOVE LDC-NUM-ILDC IN LDC-FLD  TO ARG-NUM-ILDC IN WSS-VARI.
           MOVE ZEROS                    TO ARG-NUM-IARG IN WSS-VARI.
           MOVE ARG-KEY-IARG IN WSS-VARI TO ARG-KEY-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARG.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           IF NOT ( FIO-STAT-OKS AND
              ARG-KEY-ILDC IN WSS-VARI = ARG-KEY-ILDC IN ARG )
               GO TO FIN-DEL-ARG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-ARG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'ARG    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARG.

           MOVE ARG-KEY-ILDC IN WSS-VARI TO ARG-KEY-ILDC IN ARG.
*% IF PGM_DB2 
      *<<<< PGM_DB2
           MOVE FIO-GET-NXT TO FIO-CMND.
      *>>>>
*% ELSE
      *<<<< NOT PGM_DB2
           MOVE FIO-GET-NLS TO FIO-CMND.
      *>>>>
*% END
           GO TO LUP-DEL-ARG.
       FIN-DEL-ARG.
           EXIT.

      *FLB CST  22-FEB-1995 
       COPY TABBFCAM.
      *>>>>
*% END
*% IF EOF AND PGM_BMS
      *<<<< EOF AND PGM_BMS 
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS

*% IF PGM_PQ
      *<<<< PGM_PQ
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           MOVE LOW-VALUES TO LDC-FLD.
           PERFORM ING-SETE.
           PERFORM SCR-CLRA-LDC.
           PERFORM HBL-IKY.
           PERFORM HBL-KEY-LDC.
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO)     TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO)     TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO)     TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO)     TO SCR-NLIB.
      *     MOVE WSS-NEMO(WSS-IDX-ICAD) TO SCR-NEMO.

           MOVE WSS-NTRV(SCR-IPRO)     TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO)     TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       HBL-KEY-LDC SECTION.
       INI-HBL-KEY-LDC.
           MOVE LOW-VALUES TO LDC-FLD.
           PERFORM SCR-CLRA-LDC.
           MOVE SCR-CAI-ICLF IN SCR-VARI TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE SCR-IIC-ICLF IN SCR-VARI TO LDC-IIC-ICLF IN LDC-FLD.

           MOVE 'ING'                  TO SCR-CCPP.
           MOVE 'ING'                  TO SCR-CMND.
           PERFORM VAL-LDC-NUM-ILDC.

           IF MSG-COD-MENS NOT > SPACES
               PERFORM FND-KEY
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS.

      * FLB 24/JUL/92 DIO ALGO MALO 
      * FLB 24/JUL/92 LE AGREGUE QUE SE VAYA Y NO HABILITE LOS CAMPOS
           IF MSG-COD-MENS > SPACES
               PERFORM CLR-CLF-LDC
      *         MOVE SCR-STAT-CON TO SCR-STAT
      *         MOVE SCR-INST-GAB TO SCR-INST
                MOVE SCR-INST-GKY TO SCR-INST

      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY
               PERFORM PRO-ALL
               PERFORM UNP-IKY-LDC

               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LDC
      *         PERFORM EDT-FLD-LDC
               IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
                   MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
                   PERFORM SCR-INIT
                   PERFORM SCR-EXIT
                   GO TO FIN-HBL-KEY-LDC
               ELSE
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
                   GO TO FIN-HBL-KEY-LDC.

           MOVE +4 TO LDC-CAI-ICLF-LEN IN LDC-FLD.
      *ISP   25-JUL-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM HBL-FLD.
      *ALD-BNL.
           MOVE FRM-CPIM-AEY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-AEY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR.
      *
           MOVE SCR-INST-GFL TO SCR-INST.

       CIC-HBL-KEY-CLF.
      *
           PERFORM EDT-KEY-LDC.
           PERFORM EDT-FLD-LDC.

           MOVE 'GNS' TO MSG-COD-SIST.
           MOVE 'FLDING' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN1.
           MOVE FRM-MEN1     TO LDC-GLS-MEN1 IN LDC-FLD.

           MOVE 'F10LDCNINCLF' TO MSG-COD-MENS.
           PERFORM MSG-PF10.

           PERFORM SCR-MSSG.

           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM STP-EXIT
           ELSE
               PERFORM SCR-PUTA.
*% IF PGM_CHI AND PGM_BCI
      *<<<< ISP-INI  24-JAN-1996 11:35:48 
           IF SCR-OFRM-SRV
                EXEC CICS
                 RETURN
                END-EXEC.
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
*% END
           PERFORM SCR-EXIT.
       FIN-HBL-KEY-LDC.
           EXIT.

       MSG-PF10 SECTION.
       INI-MSG-PF10.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DEU' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
           MOVE FRM-MEN2     TO LDC-GLS-MEN2 IN LDC-FLD.
       FIN-MSG-PF10.
           EXIT.

      *>>>>
*% END
       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
*% IF PGM_PQ OR (PGM_PU AND NOT PGM_DB2)
      *<<<< PGM_PQ OR (PGM_PU AND NOT PGM_DB2)
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_CHI AND PGM_BCI AND PGM_PU
      *<<<< ISP-INI  24-JAN-1996 11:35:48 
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-ILDC TO SCR-IPRO
           ELSE
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
*% END
           PERFORM GNS-PRO-SYS.
      *>>>>
*% END
*% IF PGM_PU AND PGM_DB2
      *<<<< PGM_PU AND PGM_DB2
*%!        MOVE +{gnstca} TO SYS-TCMA.
           MOVE SCR-TCMA  TO SYS-TCMA.
           EXEC CICS START
                TRANSID( WSS-NTRN IN WSS-PPRO(SCR-IPRO) )
                TERMID ( EIBTRMID )
                FROM   ( SYS-CMMA )
                LENGTH ( SYS-TCMA )
           END-EXEC.
           EXEC CICS RETURN
           END-EXEC.
      *>>>>
*% END
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-ICLF TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
*% IF PGM_PQ OR (PGM_PU AND NOT PGM_DB2)
      *<<<< PGM_PQ OR (PGM_PU AND NOT PGM_DB2)
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
*% IF PGM_CHI AND PGM_BCI AND PGM_PU
      *<<<< ISP-INI  24-JAN-1996 11:35:48 
           IF SCR-OFRM-SRV
               MOVE WSS-IDX-ILDC TO SCR-IPRO
           ELSE
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
*% END
           PERFORM GNS-PRO-SYS.
      *>>>>
*% END
*% IF PGM_PU AND PGM_DB2
      *<<<< PGM_PU AND PGM_DB2
*%!        MOVE +{gnstca} TO SYS-TCMA.
           MOVE SCR-TCMA  TO SYS-TCMA.
           EXEC CICS START
                TRANSID( WSS-NTRN IN WSS-PPRO(SCR-IPRO) )
                TERMID ( EIBTRMID )
                FROM   ( SYS-CMMA )
                LENGTH ( SYS-TCMA )
           END-EXEC.
           EXEC CICS RETURN
           END-EXEC.
      *>>>>
*% END
       FIN-EGR-FTER-CIC.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE LDC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.

*% IF PGM_PU 
      *<<<< PGM_PU 
       ENG-PGM SECTION.
       INI-ENG-PGM.

           MOVE WSS-IDX-ILDC TO SCR-IPRO.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO SCR-CAI-ICLF.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO SCR-IIC-ICLF.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO SCR-NUM-ILDC.

      * ENGANCHE A ARC 
      *FLB CST  10-JUN-1994 
           IF FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE 'S' TO WSS-IENG 
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARC)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IARC)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARC)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IARC).

      * ENGANCHE A ARG
           IF LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O'
               MOVE 'S' TO WSS-IENG 
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARG)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IARG)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARG)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IARG).

           IF LDC-IND-MGAR IN LDC-FLD = 'E' AND
              ARG-IIC-IGAR IN CMA-VARI > ZEROES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO SCR-CAI-IGAR
               MOVE ARG-IIC-IGAR IN LDC-FLD TO SCR-IIC-IGAR
               MOVE ARG-CAI-IGAR IN LDC-FLD TO SCR-CAI-IFIA
               MOVE ARG-IIC-IGAR IN LDC-FLD TO SCR-IIC-IFIA
               IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES
      * ENGANCHE A GAR
                   MOVE 'S' TO WSS-IENG 
                   MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IGDG)
                   MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IGDG)
                   MOVE ' ' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IFIA)
                   MOVE ' ' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IFIA)
               ELSE
      * ENGANCHE A FIA
                  MOVE 'S' TO WSS-IENG 
                  MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IFIA)
                  MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IFIA)
                  MOVE ' ' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IGDG)
                  MOVE ' ' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IGDG)
      *JSS-INI 21-MAR-1994
                  MOVE ARG-COD-TOGA IN LDC-FLD TO SCR-COD-TOGA
                  MOVE DBC-NUM-ICLI IN LDC-FLD TO SCR-NUM-ICLI
                  MOVE DBC-VRF-ICLI IN LDC-FLD TO SCR-VRF-ICLI
                  MOVE DBC-IND-ICLI IN LDC-FLD TO SCR-IND-ICLI
                  MOVE DBC-GLS-ICLI IN LDC-FLD TO SCR-GLS-ICLI
                  COMPUTE  SCR-VAL-CMAX = ARG-NUM-PORG IN LDC-FLD *
                                          LDC-VAL-CMAX IN LDC-FLD / 100
                  MOVE ARC-COD-TOOC IN LDC-FLD TO SCR-COD-TOOC
                  MOVE ARC-COD-AOOC IN LDC-FLD TO SCR-COD-AOOC
      *AMP     23-MAR-1994 DEBE PASAR MONEDA DEL CREDITO
                  MOVE ARC-COD-VCOC IN LDC-FLD TO SCR-COD-VCOC
                  MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF
                  MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM LDC-FIO-CLF
                  IF FIO-STAT-OKS
                      MOVE CLF-COD-OFIC IN CLF TO SCR-COD-OFIC
                      MOVE CLF-COD-EJEC IN CLF TO SCR-COD-EJEC
                      MOVE CLF-COD-VCCF IN CLF TO SCR-COD-VCCF
                  ELSE
                      MOVE SPACES TO SCR-COD-OFIC
                      MOVE SPACES TO SCR-COD-EJEC
                      MOVE SPACES TO SCR-COD-VCCF
      *JSS-FIN 21-MAR-1994
           ELSE
               MOVE ' ' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IGDG)
               MOVE ' ' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IGDG)
               MOVE ' ' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IFIA)
               MOVE ' ' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IFIA).

           IF SCR-IND-COL = 'C' AND 
              SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARC) NOT > SPACES AND
              SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IARG) NOT > SPACES AND
              SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IGDG) NOT > SPACES AND
              SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IFIA) NOT > SPACES 
               SUBTRACT 1 FROM WSS-IDX-ILDC GIVING SCR-IPRO
               MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ILDC)
               MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ILDC).
       FIN-ENG-PGM.
           EXIT.
      *>>>>
*% END

       COPY LDCBGMPT.

      *>>>>
*% END
      *>>>>
*% END
*% IF EOF AND PGM_PQ
      *<<<< EOF
      *LTM-INI 13.04.1994
       BUS-ENT-ANEX SECTION.
       INI-BUS-ENT-ANEX.
           MOVE ZEROES TO CMA-NUM-ARC IN CMA-VARI.
           MOVE ZEROES TO CMA-NUM-ARG IN CMA-VARI.
           MOVE SPACES TO CMA-IND-IOPC IN CMA-VARI.
           MOVE SPACES TO ARC-CAI-IOPC IN CMA-VARI.
           MOVE ZEROES TO ARC-IIC-IOPC IN CMA-VARI.
           MOVE SPACES              TO WSS-IFIN.
           MOVE LDC-CAI-ICLF IN LDC TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN LDC TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF
           IF NOT FIO-STAT-OKS
      *        LDC no tiene CLF asociado
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

      *    >>>>  

           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE CLF-CAI-ICLF   TO RDC-CAI-ICLF.
           MOVE CLF-IIC-ICLF   TO RDC-IIC-ICLF.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF (NOT FIO-STAT-OKS) OR
              (RDC-CIC-ICLF IN RDC NOT = CLF-CIC-ICLF IN CLF)  
      *        CLF no tiene RDC asociado
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'RDC    NEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX
           ELSE
               MOVE RDC-CIC-ICLI   TO WSS-CIC-ICLI IN WSS-VARI
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-GET-NXT    TO FIO-CMND
               PERFORM LDC-FIO-RDC
               IF FIO-STAT-OKS AND
                  RDC-CIC-ICLF IN RDC = CLF-CIC-ICLF IN CLF
                   MOVE 'MULTIPLES CLIENTES' TO DBC-GLS-NOMC IN DBC
                   MOVE ZEROES               TO DBC-NUM-ICLI IN DBC
                   MOVE SPACES               TO DBC-VRF-ICLI IN DBC
                                                DBC-IND-ICLI IN DBC
      *FLB CST  11-MAY-1994 
                   MOVE IDC-INIC-GLS         TO DBC-GLS-ICLI IN DBC
                   MOVE PGM-SOKS             TO PGM-STAT-DBC
               ELSE
                   MOVE WSS-CIC-ICLI IN WSS-VARI
                                     TO DBC-CIC-ICLI IN DBC
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM SGC-FIO-DBC
                   MOVE FIO-STAT     TO PGM-STAT-DBC       
                   IF NOT FIO-STAT-OKS
      *                RDC no tiene DBC asociado
                       MOVE 'DEU'         TO MSG-COD-SIST
                       MOVE 'DBC    NEX'  TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC  TO FRM-MENS
                       MOVE '00'          TO FIO-STAT
                       MOVE SCR-STAT-CON  TO SCR-STAT
                       MOVE 'S'           TO WSS-IFIN
                       GO TO FIN-BUS-ENT-ANEX
                   ELSE
                       MOVE DBC-GLS-NOMC IN DBC  TO CPT-STRN
                       PERFORM CPT-BLKS
                       MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.      
              
      *    <<<<                  

           IF SCR-CCPP = 'ACC' AND SCR-STAT = SCR-STAT-CON
               PERFORM GET-ARC
               PERFORM GET-ARG
               MOVE PGM-STAT-LDC TO FIO-STAT
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           IF CLF-MSC-STAT IN CLF = 'C'
      *        LDC eliminada
               MOVE 'DEU'           TO MSG-COD-SIST
               MOVE 'CLF    EXTING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *RVM-CST-INI 9-OCT-1996
      *         MOVE '00' TO FIO-STAT
               MOVE '22' TO FIO-STAT
      *RVM-CST-FIN 9-OCT-1996
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           IF CLF-MSC-STAT IN CLF = 'R'
      *        CLF fue renovada
               MOVE 'DEU'           TO MSG-COD-SIST
               MOVE 'CLF    MCAYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *RVM-CST-INI 9-OCT-1996
      *         MOVE '00' TO FIO-STAT
               MOVE '22' TO FIO-STAT
      *RVM-CST-FIN 9-OCT-1996
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           IF CLF-MSC-STAT IN CLF = 'A' 
      *        LDC activada 
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    ACAYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
      *RVM-CST-INI 9-OCT-1996
      *         MOVE '00' TO FIO-STAT
               MOVE '22' TO FIO-STAT
      *RVM-CST-FIN 9-OCT-1996
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           MOVE CLF-NUM-DAPE IN CLF TO CLF-NUM-DAPE IN CMA-VARI.
           MOVE CLF-NUM-MAPE IN CLF TO CLF-NUM-MAPE IN CMA-VARI.
           MOVE CLF-NUM-SAPE IN CLF TO CLF-NUM-SAPE IN CMA-VARI.
           MOVE CLF-NUM-AAPE IN CLF TO CLF-NUM-AAPE IN CMA-VARI.
           MOVE CLF-NUM-DVEN IN CLF TO CLF-NUM-DVEN IN CMA-VARI.
           MOVE CLF-NUM-MVEN IN CLF TO CLF-NUM-MVEN IN CMA-VARI.
           MOVE CLF-NUM-SVEN IN CLF TO CLF-NUM-SVEN IN CMA-VARI.
           MOVE CLF-NUM-AVEN IN CLF TO CLF-NUM-AVEN IN CMA-VARI.
           MOVE CLF-NUM-PVIG IN CLF TO CLF-NUM-PVIG IN CMA-VARI.
           MOVE CLF-IND-PVIG IN CLF TO CLF-IND-PVIG IN CMA-VARI.
           MOVE CLF-VAL-CMAX IN CLF TO CLF-VAL-CMAX IN CMA-VARI.

           IF SCR-CCPP = 'ING' 
               PERFORM PUT-CLF-LDC
               PERFORM PUT-DBC-LDC
               MOVE PGM-STAT-LDC TO FIO-STAT 
               MOVE 'S'          TO WSS-IFIN
               GO TO FIN-BUS-ENT-ANEX.

           PERFORM GET-ARC.
           PERFORM GET-ARG.
       FIN-BUS-ENT-ANEX.
           EXIT.
      *LTM-FIN 13.04.1994
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
      *LTM-INI 13.04.1994
           PERFORM BUS-ENT-ANEX.
      *LTM-FIN 13.04.1994
      *>>>>
*% END
