*%! Codigo adicional para archivo LDCBMCLF
*% INCLUDE 'PAISRC:FNCSIS.SRC'
*% IF FIN_PUT_ALL_CLF
      *<<<< FIN_PUT_ALL_CLF
      *>>>>
*% END
*% IF INI_PUT_CLF_CLF
      *<<<< INI_PUT_CLF_CLF
      *>>>>
*% END
*% IF FIN_PUT_CLF_CLF
      *<<<< FIN_PUT_CLF_CLF
           IF CLF-COD-AOCF IN CLF-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN CLF-FLD TO
                                        WSS-TIP-OPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN CLF-FLD TO
                                        WSS-STP-OPE IN WSS-VARI
               MOVE WSS-CLA-OPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN CLF-FLD.

      *FLB CST  31-JAN-1994 OBSERVACION DE MOR EN BRB
           IF SCR-CMND = CMND-REV
               MOVE ZEROES TO CLF-FEC-FPRV IN CLF-FLD.
      *>>>>
*% END
*% IF INI_PUT_DBC_CLF
      *<<<< INI_PUT_DBC_CLF
           IF SCR-IND-MCLI = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-IND-ICLI IN CLF-FLD
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD
      * JVM: CLF con multiples clientes
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLF    MDEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE 'M' TO DBC-IND-ICLI IN CLF-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN CLF-FLD
               GO TO FIN-PUT-DBC-CLF.

      *>>>>
*% END
*% IF FIN_PUT_DBC_CLF
      *<<<< FIN_PUT_DBC_CLF
           IF SCR-IND-MCLI NOT = 'M'
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN CLF-FLD.

      *FLB CST  06-DIC-1993 LEE TABLA VSN PARA INGRESAR EJECUTIVO O 
      *                    TOMARLO DEL DBC
           MOVE 'DEU'               TO FIO-SIST.
           MOVE 'VSN '              TO TAB-COD-TTAB IN TAB.
           MOVE 'INGEJECUTIVO'      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES AND
                  CLF-COD-EJEC IN CLF-FLD NOT > SPACES
                   MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
                   MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
                   MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
                   MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM SGC-FIO-DBC
                   IF FIO-STAT-OKS AND DBC-COD-EJEC IN DBC > SPACES
                       MOVE DBC-COD-EJEC IN DBC TO
                            CLF-COD-EJEC IN CLF-FLD
                       MOVE CLF-COD-EJEC IN CLF-FLD TO 
                            USR-COD-USER IN USR
                       PERFORM BUS-USR
                       MOVE USR-GLS-DESC IN USR TO 
                            FRM-GLS-EJEC IN CLF-FLD.
      *>>>>
*% END
*% IF FIN_FST_KEY_CLF
      *<<<< FIN_FST_KEY_CLF
      * LTM-INI 25-04-1994
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-FST-KEY-CLF.
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE FRM-CPIM-AEY TO CLF-CAI-ICLF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-IIC-ICLF-ATR IN CLF-FLD
           ELSE
               GO TO FIN-FST-KEY-CLF.
      * LTM-FIN 25-04-1994
      *>>>>
*% END
*% IF FIN_FST_FLD_CLF
      *<<<< FIN_FST_FLD_CLF
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD.

           MOVE 'M' TO CLF-IND-UCAP IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-UCAP-ATR IN CLF-FLD.

           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING' 
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD
*% IF PGM_CHI
      *         MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
*% ELSE
               MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
*% END
               MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

      *FLB CST  31-JAN-1994 
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *AMP IF WSS-VSN-OCAI = 'S'
      *AMP     MOVE FRM-CPIM-AEY TO CLF-COD-OFIC-ATR IN CLF-FLD.
      *FLB CST  31-JAN-1994 FIN

           IF SCR-CMND = CMND-MOD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
*% IF PGM_CHI
      *         MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
*% ELSE
               MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
*% END
               MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           MOVE FRM-CPIM-AEY TO CLF-FEC-FVEN-ATR IN CLF-FLD.
           MOVE 0 TO CLF-COD-VCCF-LEN IN CLF-FLD.

           IF SCR-CMND = CMND-ACA
      *        MOVE -1 TO CLF-FEC-FAPE-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
      *RVM-CST-INI 24.09.1996
               MOVE HOY-DHOY     TO CLF-NUM-DING     IN CLF-FLD
               MOVE HOY-MHOY     TO CLF-NUM-MING     IN CLF-FLD
               MOVE HOY-SHOY     TO CLF-NUM-SING     IN CLF-FLD
               MOVE HOY-AHOY     TO CLF-NUM-AING     IN CLF-FLD
      *RVM-CST-FIN 24.09.1996
               PERFORM PRO-FLD-CLF
*% IF PGM_CHI
      *         MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD
      *         MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
      *         MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
      *         MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
      *         MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD
*% ELSE
               MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD
*% END
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-MCA
      *FLB CST  31-JAN-1994 
      *        MOVE -1 TO CLF-COD-OFIC-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-VCCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-TOCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-AOCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
      *RVM-CST-INI 25.09.1996
      *INHIBIDO, PARA QUE NO ASUMA FECHA DE HOY
      *        MOVE HOY-DHOY     TO CLF-NUM-DAPE     IN CLF-FLD
      *        MOVE HOY-MHOY     TO CLF-NUM-MAPE     IN CLF-FLD
      *        MOVE HOY-SHOY     TO CLF-NUM-SAPE     IN CLF-FLD
      *        MOVE HOY-AHOY     TO CLF-NUM-AAPE     IN CLF-FLD
      *RVM-CST-FIN 25.09.1996
               MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
      *RVM-CST-INI 24.06.1996
      *        MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE HOY-DHOY     TO CLF-NUM-DING     IN CLF-FLD
               MOVE HOY-MHOY     TO CLF-NUM-MING     IN CLF-FLD
               MOVE HOY-SHOY     TO CLF-NUM-SING     IN CLF-FLD
               MOVE HOY-AHOY     TO CLF-NUM-AING     IN CLF-FLD
      *RVM-CST-FIN 24.06.1996
      *FLB CST  31-JAN-1994 
               IF WSS-VSN-OCAI = 'S'
                   MOVE -1 TO CLF-COD-EJEC-LEN IN CLF-FLD
                   GO TO FIN-FST-FLD-CLF
               ELSE
                   MOVE -1 TO CLF-COD-OFIC-LEN IN CLF-FLD
                   GO TO FIN-FST-FLD-CLF.
      *FLB CST  31-JAN-1994 FIN

           IF SCR-CMND = CMND-CMX
               MOVE -1 TO CLF-VAL-CMAX-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-VAL-CMAX-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-CIE
               MOVE -1 TO CLF-COD-RAZC-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-REV
               MOVE -1 TO CLF-FEC-FPRV-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DURV IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MURV IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SURV IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AURV IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-FEC-FPRV-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_CLF
      *<<<< INI_VAL_CON_IKY_CLF
           IF CLF-IIC-ICLF IN CLF-FLD NOT > ZEROES
               MOVE CLF-CAI-ICLF IN CLF-FLD TO CIC-CAI-ICIC IN CIC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-CIC
               IF NOT FIO-STAT-OKS 
                   MOVE CIC-STAT-NEX TO CIC-STAT
                   MOVE 'GNS'     TO MSG-COD-SIST
                   MOVE 'CICSTAT' TO MSG-COD-TMSG
                   MOVE CIC-STAT  TO MSG-COD-CMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   IF CIC-IND-VIGE = 'N'
                       MOVE CIC-STAT-NVG TO CIC-STAT
                       MOVE 'GNS'     TO MSG-COD-SIST
                       MOVE 'CICSTAT' TO MSG-COD-TMSG
                       MOVE CIC-STAT  TO MSG-COD-CMSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.

           GO TO FIN-VAL-CON-IKY-CLF.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_CLF 
      *<<<< INI_VAL_CON_KEY_CLF 
           IF CLF-IIC-ICLF IN CLF-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN CLF-FLD NOT > SPACES 
              AND DBC-NUM-ICLI IN CLF-FLD = ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-CLF.

           GO TO FIN-VAL-CON-KEY-CLF.
      *>>>>
*% END
*% IF CLF_IIC_ICLF 
      *<<<< CLF_IIC_ICLF
           IF CLF-IIC-ICLF IN CLF-FLD NOT > ZEROES
               GO TO FIN-VAL-CLF-IIC-ICLF.
      *>>>>
*% END
*% IF INI_VAL_FLD_CLF
      *<<<< INI_VAL_FLD_CLF 
           PERFORM GET-FHOY.

      *FLB CST   13-DEC-1993
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.
      *>>>>
*% END
*%! copiar en el programa el registro TIO = TABBRTIO
*% IF FIN_CLF_COD_TOCF
      *<<<< FIN_CLF_COD_TOCF
           IF FRM-SUAR NOT = FRM-SUAR-MAL
               MOVE TAB TO TIO
      *FLB CST  3-NOV-1993
      *         IF TIO-GLS-SIST NOT = 'DEU'
               IF TIO-GLS-SIST NOT = 'LDC' 
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CLF-COD-TOCF.
      * AMP-INI 09-OCT-1993
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      * AMP-FIN 09-OCT-1993

      * AMP-INI  3-NOV-1993
           PERFORM VER-SI-ES-GRUPO.
      * AMP-FIN  3-NOV-1993
           IF WSS-EXISTE-GRUPO > ZEROES
               IF WSS-CIC-TOCF NOT = 'CGE'
                    MOVE 'DEU'          TO MSG-COD-SIST
                    MOVE 'TIOGR<>CGE' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-CLF-COD-TOCF
                ELSE
                    NEXT SENTENCE
            ELSE
                IF WSS-CIC-TOCF = 'CGE'
                    MOVE 'DEU'          TO MSG-COD-SIST
                    MOVE 'TIOGR<>CGE' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-CLF-COD-TOCF
                ELSE
                    NEXT SENTENCE.
      *>>>>
*% END
*% IF FIN_CLF_COD_AOCF
      *<<<< FIN_CLF_COD_AOCF
           IF WSS-CIC-TOCF = 'CGE' AND
              CLF-COD-AOCF IN CLF-FLD > SPACES
                MOVE 'DEU'          TO MSG-COD-SIST
                MOVE 'AUXGR<>BLK' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CLF-COD-AOCF.
      *>>>>
*% END
*% IF FIN_CLF_COD_OFIC 
      *<<<< FIN_CLF_COD_OFIC
      *AMP INI   17-MAR-1994  INCORPORA CHEQUEO : OFICINA  = CAI O
      *                                           SUCURSAL = CAI
      *                       SI ES QUE LOS CORRELATIVOS SON POR SUCURS
      *                       (REQUIERE VAL-OFI Y CONTROLA 'COD    NEX')
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-CLF-COD-OFIC.
           IF WSS-VSN-OCAI NOT = 'S'
               GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP INI   18-MAR-1994  TRASLADADO AQUI Y MEJORADO
           IF SCR-CCPP NOT = 'ING'
               MOVE CLF-CAI-ICLF IN CLF-FLD TO CIC-CAI-ICIC IN CIC
               GO TO CON-VAL-CLF-COD-OFIC.
           MOVE 'L'                     TO CIC-COD-TCIC IN CIC.
      *AMP PRIMERO CHEQUEO CAI DE OFI Y SI NO HAY BUSCO CAI DE SUC
           MOVE CLF-COD-OFIC IN CLF-FLD TO CIC-COD-CCIC IN CIC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF FIO-STAT-OKS
               MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD
               GO TO FIN-VAL-CLF-COD-OFIC.
           MOVE OFI-COD-OFCO IN OFI     TO CIC-COD-CCIC IN CIC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CAI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-COD-OFIC.
           MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD.
       CON-VAL-CLF-COD-OFIC.
           IF NOT ( OFI-COD-OFIC IN OFI = CIC-COD-CCIC IN CIC OR
                    OFI-COD-OFCO IN OFI = CIC-COD-CCIC IN CIC )
               MOVE 'DEU'             TO MSG-COD-SIST
               MOVE 'CLFOFICINVL'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC      TO FRM-MENS
               MOVE FRM-SUAR-MAL      TO FRM-SUAR
               GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP FIN   18-MAR-1994  TRASLADADO AQUI Y MEJORADO
      *AMP INI   17-MAR-1994  INHABILITE ESTE PARRAFO PORQUE
      *                       VALIDA QUE OFICINA TENGA CAI  Y
      *                       CUANDO LO TIENE ASIGNA EL CAI A LA CLF
      *FLB CST   13-DEC-1993
      *    IF WSS-VSN-OCAI NOT = 'S'
      *        GO TO FIN-VAL-CLF-COD-OFIC.
      *
      *    MOVE 'L'                     TO CIC-COD-TCIC IN CIC.
      *    MOVE CLF-COD-OFIC IN CLF-FLD TO CIC-COD-CCIC IN CIC.
      *    MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM GNS-FIO-CIC.
      *    IF NOT FIO-STAT-OKS
      *        MOVE 'GNS'        TO MSG-COD-SIST
      *        MOVE 'CAI    NEX' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP FIN   17-MAR-1994  INHABILITE ESTE PARRAFO PORQUE
      *>>>>
*% END
*% IF INI_CLF_COD_EJEC 
      *<<<< INI_CLF_COD_EJEC

      *FLB CST  06-DIC-1993 LEE TABLA VSN PARA INGRESAR EJECUTIVO O 
      *                    TOMARLO DEL DBC
           MOVE 'DEU'               TO FIO-SIST.
           MOVE 'VSN '              TO TAB-COD-TTAB IN TAB.
           MOVE 'INGEJECUTIVO'      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES AND
                  CLF-COD-EJEC IN CLF-FLD NOT > SPACES
                   MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
                   MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
                   MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
                   MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM SGC-FIO-DBC
                   IF FIO-STAT-OKS AND DBC-COD-EJEC IN DBC > SPACES
                       MOVE DBC-COD-EJEC IN DBC TO
                            CLF-COD-EJEC IN CLF-FLD.

      *FLB CST  19-JUL-1994 VERIFICAR OBLIGATORIEDAD DE EJECUTIVO
           IF CLF-COD-EJEC IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EJEC IN CLF-FLD
               PERFORM ERR-GLS
               GO TO FIN-VAL-CLF-COD-EJEC.
      *>>>>
*% END
*% IF FIN_CLF_COD_EJEC 
      *<<<< FIN_CLF_COD_EJEC
*% IF PGM_PER
      *<<<< PGM_PER
           IF FRM-SUAR NOT = FRM-SUAR-MAL
               IF USR-COD-OFUS IN USR NOT = CLF-COD-OFIC IN CLF-FLD
                   MOVE CLF-COD-OFIC IN CLF-FLD TO OFI-COD-OFIC IN OFI
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM TAB-FIO-OFI
                   IF FIO-STAT-OKS
                       IF OFI-COD-OFCO NOT = USR-COD-OFUS IN USR
                           MOVE 'DEU'             TO MSG-COD-SIST
                           MOVE 'CLFOFUSOFIC'     TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC      TO FRM-MENS
                           MOVE FRM-SUAR-MAL      TO FRM-SUAR
                       ELSE
                           NEXT SENTENCE
                   ELSE
                       MOVE 'DEU'             TO MSG-COD-SIST
                       MOVE 'CLFOFUSOFIC'     TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC      TO FRM-MENS
                       MOVE FRM-SUAR-MAL      TO FRM-SUAR.
      *>>>>
*% END
      *>>>>
*% END
*% IF CLF_COD_AOCF
      *<<<< CLF_COD_AOCF
           IF CLF-COD-AOCF IN CLF-FLD NOT > SPACES
              GO TO FIN-VAL-CLF-COD-AOCF.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN CLF-FLD TO
                                    WSS-TIP-OPE IN WSS-VARI.
           MOVE CLF-COD-AOCF IN CLF-FLD TO
                                    WSS-STP-OPE IN WSS-VARI.
           MOVE WSS-CLA-OPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-AOCF IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOCF IN CLF-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-AOCF IN CLF-FLD.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI
           IF DBC-IND-ICLI IN CLF-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD
               GO TO FIN-VAL-DBC-NUM-ICLI.

            IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-NUM-ICLI.

            IF DBC-NUM-ICLI IN CLF-FLD = ZEROES
                MOVE 'TAB'        TO MSG-COD-SIST
                MOVE 'CLI    OBLIG' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-DBC-NUM-ICLI.
      *    IF SCR-INST = SCR-INST-GKY
      *        MOVE IDC-ZERO-S TO IDC-ZERO
      *    ELSE
      *        MOVE IDC-ZERO-N TO IDC-ZERO.

      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN CLF-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    MDEU'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN CLF-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN CLF-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
*% IF NOT PGM_BNL
      *<<<< NOT PGM_BNL
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN CLF-FLD
*% ELSE
      *<<<< PGM_BNL
                   MOVE SPACES              TO
                        DBC-CAI-ICLI IN CLF-FLD
      *>>>>
*% END
                   MOVE DBC-IIC-ICLI IN DBC TO
                        DBC-IIC-ICLI IN CLF-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN CLF-FLD.
                  
           IF SCR-CCPP = 'ING' 
               PERFORM VAL-CON-RDC-CLF
               IF MSG-COD-MENS > SPACES
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
*% END
*% IF DBC_GLS_ICLI AND PGM_BNL
      *<<<< DBC_GLS_ICLI AND PGM_BNL
           IF DBC-GLS-ICLI IN CLF-FLD NOT > SPACES
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD.
      *>>>>
*% END
*% IF CLF_IND_RSTR
      *<<<< CLF_IND_RSTR
           IF CLF-IND-RSTR IN CLF-FLD NOT > SPACES
                GO TO FIN-VAL-CLF-IND-RSTR.
      *>>>>
*% END
*% IF CLF_VAL_CMAX
      *<<<< CLF_VAL_CMAX
           IF CLF-VAL-CMAX IN CLF-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-VAL-CMAX.
      *>>>>
*% END
*% IF CLF_IND_UCAP
      *<<<< CLF_IND_UCAP
           IF ( CLF-IND-UCAP IN CLF-FLD = 'A' OR 'B' ) AND
                CLF-VAL-CMAX IN CLF-FLD > 100
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'ERRVALUCAP' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CLF-IND-UCAP.
      *>>>>
*% END
*% IF CLF_FEC_FING
      *<<<< CLF_FEC_FING
           IF CLF-FEC-FING IN CLF-FLD NOT > ZEROES
               MOVE HOY-DHOY TO CLF-NUM-DING IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MING IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SING IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AING IN CLF-FLD.
           MOVE CLF-FEC-FING IN CLF-FLD TO FEC-FECH.
      *>>>>
*% END
*% IF INI_CLF_FEC_FAPE
      *<<<< INI_CLF_FEC_FAPE

           IF CLF-FEC-FAPE IN CLF-FLD NOT > ZEROES
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD.

           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *>>>>
*% END
*% IF CLF_NUM_PREV
      *<<<< CLF_NUM_PREV
      *FLB CST 18-FEB-1994 NO PERMITA NUM > 0 Y IND = SPACES
      *  Y VICEVERSA
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND 
              CLF-IND-PREV IN CLF-FLD > SPACES 
                  OR
              CLF-NUM-PREV IN CLF-FLD > ZEROES AND 
              CLF-IND-PREV IN CLF-FLD NOT > SPACES 
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPRVFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PREV.

      *FLB CST 18-FEB-1994 TRASLADADO AQUI POR ORDEN
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND
              CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'PREVFPRVBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PREV.
      *>>>>
*% END
*% IF CLF_IND_PREV
      *<<<< CLF_IND_PREV
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND 
              CLF-IND-PREV IN CLF-FLD NOT > SPACES 
               MOVE SPACES TO FRM-GLS-PREV IN CLF-FLD
               GO TO FIN-VAL-CLF-IND-PREV.
      *>>>>
*% END
*% IF INI_CLF_FEC_FPRV
      *<<<< INI_CLF_FEC_FPRV

      * COMANDO REV FUNCIONA IGUAL QUE ING, SALVO POR DIFERENTE F. INICIAL
      *   EN RUTINA OBT-FPRV

      * SI LLENO EL PERIODO, VACIA LA FECHA
           IF CLF-NUM-PREV IN CLF-FLD > ZEROES AND
      *FLB CST  31-JAN-1994 OBSERVACION DE MOR EN BRB
      *       CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES OR
      *       SCR-CMND = CMND-REV
              CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES
               PERFORM OBT-FPRV
               MOVE WSS-NUM-DPRV IN WSS-VARI TO
                                        CLF-NUM-DPRV IN CLF-FLD
               MOVE WSS-NUM-MPRV IN WSS-VARI TO
                                        CLF-NUM-MPRV IN CLF-FLD
               MOVE WSS-NUM-SPRV IN WSS-VARI TO
                                        CLF-NUM-SPRV IN CLF-FLD
               MOVE WSS-NUM-APRV IN WSS-VARI TO
                                        CLF-NUM-APRV IN CLF-FLD.

           MOVE CLF-FEC-FPRV IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF CLF_FEC_FPRV
      *<<<< CLF_FEC_FPRV

      * CASO PERIODO VACIO, LLENA LA FECHA, OBTIENE PERIODO EN AGNOS
           IF CLF-NUM-PREV IN CLF-FLD NOT > ZEROES AND
              CLF-IND-PREV IN CLF-FLD NOT > SPACES AND
              CLF-FEC-FPRV IN CLF-FLD > ZEROES
               PERFORM OBT-PREV.

      * VALIDA QUE FURV < FPRV  
           MOVE CLF-NUM-DPRV IN CLF-FLD TO WSS-NUM-DPR1 IN WSS-VARI.
           MOVE CLF-NUM-MPRV IN CLF-FLD TO WSS-NUM-MPR1 IN WSS-VARI.
           MOVE CLF-NUM-SPRV IN CLF-FLD TO WSS-NUM-SPR1 IN WSS-VARI.
           MOVE CLF-NUM-APRV IN CLF-FLD TO WSS-NUM-APR1 IN WSS-VARI.
           MOVE CLF-NUM-DURV IN CLF-FLD TO WSS-NUM-DVE2 IN WSS-VARI.
           MOVE CLF-NUM-MURV IN CLF-FLD TO WSS-NUM-MVE2 IN WSS-VARI.
           MOVE CLF-NUM-SURV IN CLF-FLD TO WSS-NUM-SVE2 IN WSS-VARI.
           MOVE CLF-NUM-AURV IN CLF-FLD TO WSS-NUM-AVE2 IN WSS-VARI.
           IF WSS-FEC-FPR1 IN WSS-VARI NOT > WSS-FEC-FVE2 IN WSS-VARI
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'FPRVNO>FURV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-FEC-FPRV.
      *>>>>
*% END
*% IF CLF_NUM_PVIG
      *<<<< CLF_NUM_PVIG

      *FLB CST 18-FEB-1994 NO PERMITA NUM > 0 Y IND = SPACES
      *  Y VICEVERSA
           IF CLF-NUM-PVIG IN CLF-FLD = ZEROES AND 
              CLF-IND-PVIG IN CLF-FLD > SPACES 
                  OR
              CLF-NUM-PVIG IN CLF-FLD > ZEROES AND 
              CLF-IND-PVIG IN CLF-FLD NOT > SPACES 
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPVGFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PVIG.
      *>>>>
*% END
*% IF INI_CLF_FEC_FVEN
      *<<<< INI_CLF_FEC_FVEN
      *FLB CST  20-JUL-1994 PARA MANTENER CONSISTENCIA EN 
      * VENCIMENTO DE CLF VS. VENCTOS DE LDC'S, SI RETROCEDE LA F.APE
           IF SCR-CMND = CMND-ACA
               GO TO FIN-VAL-CLF-FEC-FVEN.

      *FLB 11/NOV/92
           PERFORM OBT-FVEN.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO CLF-NUM-DVEN IN CLF-FLD.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO CLF-NUM-MVEN IN CLF-FLD.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO CLF-NUM-SVEN IN CLF-FLD.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO CLF-NUM-AVEN IN CLF-FLD.

           MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF CLF_FEC_FVEN
      *<<<< CLF_FEC_FVEN

       VAL-PRV-VEN.
      *FLB 28/OCT/92
           IF CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES AND
              SCR-CMND = CMND-ACA
               MOVE CLF-FEC-FVEN IN CLF-FLD TO CLF-FEC-FPRV IN CLF-FLD 
               MOVE CLF-NUM-PVIG IN CLF-FLD TO CLF-NUM-PREV IN CLF-FLD 
               MOVE CLF-IND-PVIG IN CLF-FLD TO CLF-IND-PREV IN CLF-FLD 
               MOVE FRM-GLS-PVIG IN CLF-FLD TO FRM-GLS-PREV IN CLF-FLD
               GO TO FIN-VAL-CLF-FEC-FVEN.

           MOVE CLF-NUM-DVEN IN CLF-FLD TO WSS-NUM-DVE1 IN WSS-VARI.
           MOVE CLF-NUM-MVEN IN CLF-FLD TO WSS-NUM-MVE1 IN WSS-VARI.
           MOVE CLF-NUM-SVEN IN CLF-FLD TO WSS-NUM-SVE1 IN WSS-VARI.
           MOVE CLF-NUM-AVEN IN CLF-FLD TO WSS-NUM-AVE1 IN WSS-VARI.
           MOVE CLF-NUM-DPRV IN CLF-FLD TO WSS-NUM-DPR1 IN WSS-VARI.
           MOVE CLF-NUM-MPRV IN CLF-FLD TO WSS-NUM-MPR1 IN WSS-VARI.
           MOVE CLF-NUM-SPRV IN CLF-FLD TO WSS-NUM-SPR1 IN WSS-VARI.
           MOVE CLF-NUM-APRV IN CLF-FLD TO WSS-NUM-APR1 IN WSS-VARI.
                                             
           IF WSS-FEC-FPR1 IN WSS-VARI > WSS-FEC-FVE1 IN WSS-VARI
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'FPRV>FVEN'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1  TO CLF-FEC-FPRV-LEN  IN CLF-FLD
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CLF-FEC-FVEN.

      * INI_LTM 06-10-93
           IF CLF-NUM-PVIG IN CLF-FLD = 0 AND
              CLF-FEC-FVEN IN CLF-FLD NOT = ZEROS
               MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FEC1
               MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-ANO             TO FEC-CMND
               PERFORM CAL-FEC
               IF FEC-STAT-OKS
                   IF FEC-NANO > 0
                       MOVE FEC-NANO TO CLF-NUM-PVIG IN CLF-FLD 
                       MOVE 'A'      TO CLF-IND-PVIG IN CLF-FLD
                   ELSE
                       MOVE 1        TO CLF-NUM-PVIG IN CLF-FLD
                       MOVE 'A'      TO CLF-IND-PVIG IN CLF-FLD
               ELSE
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE FEC-MENS     TO FRM-MENS.
      * FIN_LTM 06-10-93
      *>>>>
*% END
*% IF CLF_IND_COMI
      *<<<< CLF_IND_COMI
           IF CLF-VAL-COMI IN CLF-FLD = ZEROES AND 
              CLF-IND-COMI IN CLF-FLD NOT > SPACES 
               MOVE SPACES TO FRM-GLS-COMI IN CLF-FLD
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-VAL-COMI IN CLF-FLD = ZEROES 
               MOVE 'DEU'     TO MSG-COD-SIST
               MOVE 'COMI=0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-VAL-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF (CLF-VAL-COMI-ALF IN CLF-FLD NOT = SPACES AND
               CLF-VAL-COMI-ALF IN CLF-FLD > ZEROES)    AND
              (CLF-IND-COMI IN CLF-FLD = SPACES)
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'INDI=0'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-IND-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-IND-COMI IN CLF-FLD = 'P' AND
              CLF-VAL-COMI IN CLF-FLD > 100
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INDCOM<>P' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-IND-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-VAL-COMI IN CLF-FLD > CLF-VAL-CMAX IN CLF-FLD
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'COMI>CMAX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-VAL-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.
      *>>>>
*% END
*% IF CLF_IIC_ICAC 
      *<<<< CLF_IIC_ICAC
      *>>>>
*% END
*% IF INI_CLF_FEC_FCIE
      *<<<< INI_CLF_FEC_FCIE
           IF SCR-CMND = CMND-CIE AND
              CLF-FEC-FCIE IN CLF-FLD NOT > ZEROES
              MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
              MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
              MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
              MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD.

           MOVE CLF-FEC-FCIE IN CLF-FLD TO FEC-FECH.
      *>>>>
*% END
*% IF CLF_COD_RAZC
      *<<<< CLF_COD_RAZC
           IF SCR-CMND NOT = CMND-CIE
               GO TO FIN-VAL-CLF-COD-RAZC.

           IF CLF-COD-RAZC IN CLF-FLD NOT > SPACES
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'RAZCOBLIG' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CLF-COD-RAZC.
      *>>>>
*% END
*% IF CLF_MSC_STAT
      *<<<< CLF_MSC_STAT
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO CLF-MSC-STAT IN CLF-FLD.
      *>>>>
*% END
*% IF VAL_CON_FLD_CLF
      *<<<< VAL_CON_FLD_CLF
      * CODIGO PARA VALIDAR LIMITES DE APROBACION CEM (solo en ACA)
           IF SCR-CMND NOT = CMND-ACA
               GO TO FIN-VAL-CON-FLD-CLF.

      *FLB CST  18-MAY-1994 DEJA EN COPY EN LDCPUCLF APROBACION LAC
           PERFORM LDC-PRO-LAC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-CON-RDC-CLF SECTION.
       INI-VAL-CON-RDC-CLF.
           MOVE SPACES TO MSG-COD-MENS.
*% IF NOT PGM_BNL
      *<<<< NOT PGM_BNL
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
*% ELSE
      *<<<< PGM_BNL
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC.
      *>>>>
*% END
           MOVE SPACES              TO RDC-CAI-ICLF IN RDC.
           MOVE ZEROES              TO RDC-IIC-ICLF IN RDC.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND 
*% IF NOT PGM_BNL
      *<<<< NOT PGM_BNL
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC ) 
      *>>>>
*% ELSE
      *<<<< PGM_BNL
                    RDC-IIC-ICLI IN RDC = DBC-IIC-ICLI IN DBC ) 
      *>>>>
*% END
              IF FIO-STAT-OKS
                  GO TO BRW-VAL-CON-RDC-CLF
              ELSE
                  GO TO FIN-VAL-CON-RDC-CLF.

       LUP-VAL-CON-RDC-CLF.
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO BRW-VAL-CON-RDC-CLF.

           IF CLF-MSC-STAT IN CLF NOT = 'C' AND
              CLF-MSC-STAT IN CLF NOT = 'R'
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLINOUNICO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO BRW-VAL-CON-RDC-CLF.

       NXT-VAL-CON-RDC-CLF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
*% IF NOT PGM_BNL
      *<<<< NOT PGM_BNL
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC ) 
      *>>>>
*% ELSE
      *<<<< PGM_BNL
                    RDC-IIC-ICLI IN RDC = DBC-IIC-ICLI IN DBC ) 
      *>>>>
*% END
              GO TO LUP-VAL-CON-RDC-CLF.

       BRW-VAL-CON-RDC-CLF.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.
       FIN-VAL-CON-RDC-CLF.
           EXIT.
*% IF PGM_BU
      *AMP-INI   3-NOV-1993
       VER-SI-ES-GRUPO SECTION.
       INI-VER-SI-ES-GRUPO.
           MOVE ZEROES TO WSS-EXISTE-GRUPO.
           MOVE DBC-CAI-ICLI IN CLF-FLD TO REC-CAI-ICLI IN REC.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO REC-IIC-ICLI IN REC.
           MOVE 'GC'                    TO REC-COD-TREC IN REC.
           MOVE SPACES                  TO REC-CIC-IREL IN REC.
           MOVE ZEROES                  TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS  AND
               DBC-CAI-ICLI IN CLF-FLD = REC-CAI-ICLI IN REC AND
               DBC-IIC-ICLI IN CLF-FLD = REC-IIC-ICLI IN REC
               IF REC-IND-VIGE IN REC = 'S'  AND
                  REC-COD-TREC IN REC = 'GC'
                   MOVE 99 TO WSS-EXISTE-GRUPO
                   GO TO BRW-VER-SI-ES-GRUPO
               ELSE
                   GO TO LUP-VER-SI-ES-GRUPO
           ELSE
               GO TO BRW-VER-SI-ES-GRUPO.
       LUP-VER-SI-ES-GRUPO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS  AND
               DBC-CAI-ICLI IN CLF-FLD = REC-CAI-ICLI IN REC AND
               DBC-IIC-ICLI IN CLF-FLD = REC-IIC-ICLI IN REC
               IF REC-IND-VIGE IN REC = 'S'  AND
                  REC-COD-TREC IN REC = 'GC'
                   MOVE 99 TO WSS-EXISTE-GRUPO
                   GO TO BRW-VER-SI-ES-GRUPO
               ELSE
                   GO TO LUP-VER-SI-ES-GRUPO.
       BRW-VER-SI-ES-GRUPO.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM SGC-FIO-REC.
       FIN-VER-SI-ES-GRUPO.
           EXIT.
      *AMP-FIN   3-NOV-1993
*% END
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ

       PRO-FLD-CLF SECTION.
       INI-PRO-FLD-CLF.
           PERFORM PRO-CLF-CLF.
           PERFORM PRO-DBC-CLF.
       FIN-PRO-FLD-CLF.
           EXIT.

       PRO-CLF-CLF SECTION.
       INI-PRO-CLF-CLF.
           MOVE FRM-CPIM-AEY TO CLF-COD-VCCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-TOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-AOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-OFIC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-EJEC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-RSTR-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-VAL-CMAX-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-UCAP-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-NUM-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FPRV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-NUM-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FVEN-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-VAL-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-CAI-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IIC-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD.
       FIN-PRO-CLF-CLF.
           EXIT.

       PRO-DBC-CLF SECTION.
       INI-PRO-DBC-CLF.
       FIN-PRO-DBC-CLF.
           EXIT.
      *>>>>
*% END
*% IF EOF_BU
      *<<<< EOF_BU

       OBT-FVEN SECTION.
       INI-OBT-FVEN.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           IF CLF-IND-PVIG IN CLF-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NDIA
           ELSE
           IF CLF-IND-PVIG IN CLF-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NMES
           ELSE
           IF CLF-IND-PVIG IN CLF-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AVEN IN WSS-VARI.
       FIN-OBT-FVEN.
           EXIT.

       OBT-PREV SECTION.
       INI-OBT-PREV.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FEC1.
           IF SCR-CMND = CMND-REV
               MOVE CLF-FEC-FURV IN CLF-FLD TO FEC-FEC1.
           MOVE CLF-FEC-FPRV IN CLF-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               IF FEC-NANO > 0
                   MOVE FEC-NANO TO CLF-NUM-PREV IN CLF-FLD 
                   MOVE 'A'      TO CLF-IND-PREV IN CLF-FLD
               ELSE
                   MOVE 1        TO CLF-NUM-PREV IN CLF-FLD
                   MOVE 'A'      TO CLF-IND-PREV IN CLF-FLD
           ELSE
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FEC-MENS     TO FRM-MENS.
       FIN-OBT-PREV.
           EXIT.

       OBT-FPRV SECTION.
       INI-OBT-FPRV.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           IF SCR-CMND = CMND-REV 
               MOVE CLF-FEC-FURV IN CLF-FLD TO FEC-FECH.
           IF CLF-IND-PREV IN CLF-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NDIA
           ELSE
           IF CLF-IND-PREV IN CLF-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NMES
           ELSE
           IF CLF-IND-PREV IN CLF-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DPRV IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MPRV IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SPRV IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-APRV IN WSS-VARI.
           IF SCR-CCPP NOT = 'ING'
               MOVE CLF-NUM-DVEN IN CLF-FLD TO
                                   WSS-NUM-DVE1 IN WSS-VARI
               MOVE CLF-NUM-MVEN IN CLF-FLD TO
                                   WSS-NUM-MVE1 IN WSS-VARI
               MOVE CLF-NUM-SVEN IN CLF-FLD TO
                                   WSS-NUM-SVE1 IN WSS-VARI
               MOVE CLF-NUM-AVEN IN CLF-FLD TO
                                   WSS-NUM-AVE1 IN WSS-VARI
               IF WSS-FEC-FPRV IN WSS-VARI > WSS-FEC-FVE1
                                                IN WSS-VARI
                  MOVE WSS-NUM-DVE1 IN WSS-VARI TO
                                   WSS-NUM-DPRV IN WSS-VARI
                  MOVE WSS-NUM-MVE1 IN WSS-VARI TO
                                   WSS-NUM-MPRV IN WSS-VARI
                  MOVE WSS-NUM-SVE1 IN WSS-VARI TO
                                   WSS-NUM-SPRV IN WSS-VARI
                  MOVE WSS-NUM-AVE1 IN WSS-VARI TO
                                   WSS-NUM-APRV IN WSS-VARI.
       FIN-OBT-FPRV.
           EXIT.

      *>>>>
*% END
