      *
      * LDCBQDLO
      * Version 3.0.1 Nov-2005
      * 08-May-19 04:06 PM
      *
       SET-TAG-LDCBQDLO SECTION.
       INI-SET-TAG-LDCBQDLO.
           MOVE
           '<IDNMOD NOM=$LDCBQDLO$ VSN=$ $ VGM=$3.0.1$
      -    'GEN=$08-May-19 04:06 PM$ FNC=$ $/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBQDLO.
           EXIT.
           
       PUT-ALL-DLO SECTION.
       INI-PUT-ALL-DLO.
           PERFORM PUT-CLF-DLO.
           PERFORM PUT-LDC-DLO.
           PERFORM PUT-DBC-DLO.
           PERFORM PUT-LCC-DLO.
           PERFORM PUT-ICG-DLO.
       FIN-PUT-ALL-DLO.
           EXIT.
       
       PUT-CLF-DLO SECTION.
       INI-PUT-CLF-DLO.
           IF PGM-STAT-CLF-NUL
               GO TO FIN-PUT-CLF-DLO.
           IF NOT PGM-STAT-CLF-OKS
               PERFORM CLR-CLF-DLO
               GO TO FIN-PUT-CLF-DLO.
           MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN DLO-FLD.
           MOVE CLF-COD-TOCF IN CLF TO CLF-COD-TOCF IN DLO-FLD.
           MOVE CLF-COD-AOCF IN CLF TO CLF-COD-AOCF IN DLO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN DLO-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCCF IN DLO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCCF IN DLO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-TOCF IN DLO-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOCF IN DLO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOCF IN DLO-FLD.
      *<<<<
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-AOCF IN DLO-FLD > SPACES
      *VAL-COD Valida codigo de tabla
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN DLO-FLD TO
                                    WSS-TIP-OPER IN WSS-VARI
               MOVE CLF-COD-AOCF IN DLO-FLD TO
                                    WSS-STP-OPER IN WSS-VARI
               MOVE WSS-CLA-OPER IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' OR
                  CLF-COD-AOCF IN DLO-FLD NOT > SPACES
                  MOVE SPACES TO FRM-GLS-AOCF IN DLO-FLD
               ELSE
                  MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-AOCF IN DLO-FLD.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
       FIN-PUT-CLF-DLO.
           EXIT.
       
       PUT-LDC-DLO SECTION.
       INI-PUT-LDC-DLO.
           IF PGM-STAT-LDC-NUL
               GO TO FIN-PUT-LDC-DLO.
           IF NOT PGM-STAT-LDC-OKS
               PERFORM CLR-LDC-DLO
               GO TO FIN-PUT-LDC-DLO.
           MOVE LDC-CAI-ICLF IN LDC TO LDC-CAI-ICLF IN DLO-FLD.
           MOVE LDC-IIC-ICLF IN LDC TO LDC-IIC-ICLF IN DLO-FLD.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN DLO-FLD.
           MOVE LDC-COD-TIPO IN LDC TO LDC-COD-TIPO IN DLO-FLD.
           MOVE LDC-COD-VCLC IN LDC TO LDC-COD-VCLC IN DLO-FLD.
           MOVE LDC-VAL-CMAX IN LDC TO LDC-VAL-CMAX IN DLO-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LDC-NUM-DINI IN LDC TO LDC-NUM-DINI IN DLO-FLD.
           MOVE LDC-NUM-MINI IN LDC TO LDC-NUM-MINI IN DLO-FLD.
           MOVE LDC-NUM-SINI IN LDC TO LDC-NUM-SINI IN DLO-FLD.
           MOVE LDC-NUM-AINI IN LDC TO LDC-NUM-AINI IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LDC-NUM-DVEN IN LDC TO LDC-NUM-DVEN IN DLO-FLD.
           MOVE LDC-NUM-MVEN IN LDC TO LDC-NUM-MVEN IN DLO-FLD.
           MOVE LDC-NUM-SVEN IN LDC TO LDC-NUM-SVEN IN DLO-FLD.
           MOVE LDC-NUM-AVEN IN LDC TO LDC-NUM-AVEN IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE LDC-MSC-STAT IN LDC TO LDC-MSC-STAT IN DLO-FLD.
           MOVE LDC-IND-VIGE IN LDC TO LDC-IND-VIGE IN DLO-FLD.
           MOVE LDC-NUM-PVIG IN LDC TO LDC-NUM-PVIG IN DLO-FLD.
           MOVE LDC-IND-PVIG IN LDC TO LDC-IND-PVIG IN DLO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF LDC-COD-TIPO IN DLO-FLD > SPACES
               MOVE 'DEU' TO TAB-COD-SIST
               MOVE 'TLC ' TO TAB-COD-TTAB IN TAB
               MOVE LDC-COD-TIPO IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIPO IN DLO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIPO IN DLO-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF LDC-COD-VCLC IN DLO-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE LDC-COD-VCLC IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCLC IN DLO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCLC IN DLO-FLD.
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF LDC-IND-PVIG IN DLO-FLD > SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC
               MOVE LDC-IND-PVIG IN DLO-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PVIG IN DLO-FLD
           ELSE
               MOVE SPACES TO
                    FRM-GLS-PVIG IN DLO-FLD.
      *<<<< FIN_PUT_LDC_DLO
           IF LDC-MSC-STAT IN DLO-FLD > SPACES
               MOVE 'DEU' TO TAB-COD-SIST
               MOVE 'ESL ' TO TAB-COD-TTAB IN TAB
               MOVE LDC-MSC-STAT IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-STAT IN DLO-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-STAT IN DLO-FLD.
      *>>>>
       FIN-PUT-LDC-DLO.
           EXIT.
       
       PUT-DBC-DLO SECTION.
       INI-PUT-DBC-DLO.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DLO.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-DLO
               GO TO FIN-PUT-DBC-DLO.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN DLO-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DLO-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DLO-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DLO-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DLO-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
       FIN-PUT-DBC-DLO.
           EXIT.
       
       PUT-LCC-DLO SECTION.
       INI-PUT-LCC-DLO.
           IF PGM-STAT-LCC-NUL
               GO TO FIN-PUT-LCC-DLO.
           IF NOT PGM-STAT-LCC-OKS
               PERFORM CLR-LCC-DLO
               GO TO FIN-PUT-LCC-DLO.
           MOVE LCC-VAL-MADJ IN LCC TO LCC-VAL-MADJ IN DLO-FLD.
           MOVE LCC-VAL-MUTI IN LCC TO LCC-VAL-MUTI IN DLO-FLD.
           MOVE LCC-VAL-MTOS IN LCC TO LCC-VAL-MTOS IN DLO-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LCC-NUM-DACV IN LCC TO LCC-NUM-DACV IN DLO-FLD.
           MOVE LCC-NUM-MACV IN LCC TO LCC-NUM-MACV IN DLO-FLD.
           MOVE LCC-NUM-SACV IN LCC TO LCC-NUM-SACV IN DLO-FLD.
           MOVE LCC-NUM-AACV IN LCC TO LCC-NUM-AACV IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LCC-NUM-DACT IN LCC TO LCC-NUM-DACT IN DLO-FLD.
           MOVE LCC-NUM-MACT IN LCC TO LCC-NUM-MACT IN DLO-FLD.
           MOVE LCC-NUM-SACT IN LCC TO LCC-NUM-SACT IN DLO-FLD.
           MOVE LCC-NUM-AACT IN LCC TO LCC-NUM-AACT IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LCC-NUM-DDES IN LCC TO LCC-NUM-DDES IN DLO-FLD.
           MOVE LCC-NUM-MDES IN LCC TO LCC-NUM-MDES IN DLO-FLD.
           MOVE LCC-NUM-SDES IN LCC TO LCC-NUM-SDES IN DLO-FLD.
           MOVE LCC-NUM-ADES IN LCC TO LCC-NUM-ADES IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LCC-NUM-DREC IN LCC TO LCC-NUM-DREC IN DLO-FLD.
           MOVE LCC-NUM-MREC IN LCC TO LCC-NUM-MREC IN DLO-FLD.
           MOVE LCC-NUM-SREC IN LCC TO LCC-NUM-SREC IN DLO-FLD.
           MOVE LCC-NUM-AREC IN LCC TO LCC-NUM-AREC IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE LCC-NUM-DCTB IN LCC TO LCC-NUM-DCTB IN DLO-FLD.
           MOVE LCC-NUM-MCTB IN LCC TO LCC-NUM-MCTB IN DLO-FLD.
           MOVE LCC-NUM-SCTB IN LCC TO LCC-NUM-SCTB IN DLO-FLD.
           MOVE LCC-NUM-ACTB IN LCC TO LCC-NUM-ACTB IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
       FIN-PUT-LCC-DLO.
           EXIT.
       
       PUT-ICG-DLO SECTION.
       INI-PUT-ICG-DLO.
           IF PGM-STAT-ICG-NUL
               GO TO FIN-PUT-ICG-DLO.
           IF NOT PGM-STAT-ICG-OKS
               PERFORM CLR-ICG-DLO
               GO TO FIN-PUT-ICG-DLO.
           MOVE ICG-COD-TINT IN ICG TO ICG-COD-TINT IN DLO-FLD.
           MOVE ICG-SGV-TINT IN ICG TO ICG-SGV-TINT IN DLO-FLD.
      *<<<<
           IF(ICG-COD-CVTI IN ICG > SPACES)
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN DLO-FLD.
      *>>>>
       FIN-PUT-ICG-DLO.
           EXIT.
       
       KEY-ALL-DLO SECTION.
       INI-KEY-ALL-DLO.
           PERFORM KEY-CLF-DLO.
           PERFORM KEY-LDC-DLO.
           PERFORM KEY-DBC-DLO.
           PERFORM KEY-LCC-DLO.
           PERFORM KEY-ICG-DLO.
       FIN-KEY-ALL-DLO.
           EXIT.
       
       KEY-CLF-DLO SECTION.
       INI-KEY-CLF-DLO.
       FIN-KEY-CLF-DLO.
           EXIT.
       
       KEY-LDC-DLO SECTION.
       INI-KEY-LDC-DLO.
           MOVE LDC-CAI-ICLF IN DLO-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-DLO.
           EXIT.
       
       KEY-DBC-DLO SECTION.
       INI-KEY-DBC-DLO.
       FIN-KEY-DBC-DLO.
           EXIT.
       
       KEY-LCC-DLO SECTION.
       INI-KEY-LCC-DLO.
       FIN-KEY-LCC-DLO.
           EXIT.
       
       KEY-ICG-DLO SECTION.
       INI-KEY-ICG-DLO.
       FIN-KEY-ICG-DLO.
           EXIT.
       
       SCR-CLRA-DLO SECTION.
       INI-SCR-CLRA-DLO.
           PERFORM CLR-KEY-DLO.
           PERFORM CLR-FLD-DLO.
       FIN-SCR-CLRA-DLO.
           EXIT.
       
       CLR-KEY-DLO SECTION.
       INI-CLR-KEY-DLO.
           MOVE SPACES TO LDC-CAI-ICLF IN DLO-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN DLO-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN DLO-FLD.
       FIN-CLR-KEY-DLO.
           EXIT.
       
       CLR-FLD-DLO SECTION.
       INI-CLR-FLD-DLO.
           MOVE SPACES TO FRM-GLS-VCCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TIPO IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-VCLC IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TINT IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN DLO-FLD.
           PERFORM CLR-CLF-DLO.
           PERFORM CLR-LDC-DLO.
           PERFORM CLR-DBC-DLO.
           PERFORM CLR-LCC-DLO.
           PERFORM CLR-ICG-DLO.
       FIN-CLR-FLD-DLO.
           EXIT.
       
       CLR-CLF-DLO SECTION.
       INI-CLR-CLF-DLO.
           MOVE SPACES TO CLF-COD-VCCF IN DLO-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN DLO-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN DLO-FLD.
       FIN-CLR-CLF-DLO.
           EXIT.
       
       CLR-LDC-DLO SECTION.
       INI-CLR-LDC-DLO.
           MOVE SPACES TO LDC-COD-TIPO IN DLO-FLD.
           MOVE SPACES TO LDC-COD-VCLC IN DLO-FLD.
           MOVE ZEROES TO LDC-VAL-CMAX IN DLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FINI IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FVEN IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO LDC-MSC-STAT IN DLO-FLD.
           MOVE SPACES TO LDC-IND-VIGE IN DLO-FLD.
           MOVE ZEROES TO LDC-NUM-PVIG IN DLO-FLD.
           MOVE SPACES TO LDC-IND-PVIG IN DLO-FLD.
       FIN-CLR-LDC-DLO.
           EXIT.
       
       CLR-DBC-DLO SECTION.
       INI-CLR-DBC-DLO.
           MOVE SPACES TO DBC-GLS-NOMC IN DLO-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN DLO-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-DLO.
           EXIT.
       
       CLR-LCC-DLO SECTION.
       INI-CLR-LCC-DLO.
           MOVE ZEROES TO LCC-VAL-MADJ IN DLO-FLD.
           MOVE ZEROES TO LCC-VAL-MUTI IN DLO-FLD.
           MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FACV IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FACT IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FDES IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FREC IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FCTB IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-LCC-DLO.
           EXIT.
       
       CLR-ICG-DLO SECTION.
       INI-CLR-ICG-DLO.
           MOVE SPACES TO ICG-COD-TINT IN DLO-FLD.
           MOVE ZEROES TO ICG-SGV-TINT IN DLO-FLD.
       FIN-CLR-ICG-DLO.
           EXIT.
       
       FST-KEY-DLO SECTION.
       INI-FST-KEY-DLO.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN DLO-FLD.
       FIN-FST-KEY-DLO.
           EXIT.
       
       FST-FLD-DLO SECTION.
       INI-FST-FLD-DLO.
           MOVE -1 TO LDC-COD-TIPO-LEN IN DLO-FLD.
       FIN-FST-FLD-DLO.
           EXIT.
       
       PRO-KEY-DLO SECTION.
       INI-PRO-KEY-DLO.
           PERFORM PRO-IKY-DLO.
           PERFORM PRO-AKY-DLO.
           PERFORM PRO-MKY-DLO.
       FIN-PRO-KEY-DLO.
           EXIT.
       
       PRO-IKY-DLO SECTION.
       INI-PRO-IKY-DLO.
           MOVE FRM-CPIM-AEY TO LDC-CAI-ICLF-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IIC-ICLF-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN DLO-FLD.
       FIN-PRO-IKY-DLO.
           EXIT.
       
       PRO-MKY-DLO SECTION.
       INI-PRO-MKY-DLO.
       FIN-PRO-MKY-DLO.
           EXIT.
       
       PRO-AKY-DLO SECTION.
       INI-PRO-AKY-DLO.
       FIN-PRO-AKY-DLO.
           EXIT.
       
       UNP-KEY-DLO SECTION.
       INI-UNP-KEY-DLO.
           PERFORM UNP-IKY-DLO.
           PERFORM UNP-AKY-DLO.
           PERFORM UNP-MKY-DLO.
       FIN-UNP-KEY-DLO.
           EXIT.
       
       UNP-IKY-DLO SECTION.
       INI-UNP-IKY-DLO.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-DLO.
           EXIT.
       
       UNP-MKY-DLO SECTION.
       INI-UNP-MKY-DLO.
       FIN-UNP-MKY-DLO.
           EXIT.
       
       UNP-AKY-DLO SECTION.
       INI-UNP-AKY-DLO.
       FIN-UNP-AKY-DLO.
           EXIT.
       
       UNP-FLD-DLO SECTION.
       INI-UNP-FLD-DLO.
           PERFORM UNP-CLF-DLO.
           PERFORM UNP-LDC-DLO.
           PERFORM UNP-DBC-DLO.
           PERFORM UNP-LCC-DLO.
           PERFORM UNP-ICG-DLO.
       FIN-UNP-FLD-DLO.
           EXIT.
       
       UNP-CLF-DLO SECTION.
       INI-UNP-CLF-DLO.
       FIN-UNP-CLF-DLO.
           EXIT.
       
       UNP-LDC-DLO SECTION.
       INI-UNP-LDC-DLO.
           MOVE FRM-CPIM-UBY TO LDC-COD-TIPO-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-COD-VCLC-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-VAL-CMAX-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FINI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FVEN-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-MSC-STAT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-VIGE-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-NUM-PVIG-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-PVIG-ATR IN DLO-FLD.
       FIN-UNP-LDC-DLO.
           EXIT.
       
       UNP-DBC-DLO SECTION.
       INI-UNP-DBC-DLO.
       FIN-UNP-DBC-DLO.
           EXIT.
       
       UNP-LCC-DLO SECTION.
       INI-UNP-LCC-DLO.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MADJ-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MUTI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MTOS-ATR IN DLO-FLD.
       FIN-UNP-LCC-DLO.
           EXIT.
       
       UNP-ICG-DLO SECTION.
       INI-UNP-ICG-DLO.
           MOVE FRM-CPIM-UBY TO ICG-COD-TINT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO ICG-SGV-TINT-ATR IN DLO-FLD.
       FIN-UNP-ICG-DLO.
           EXIT.
       
       VAL-KEY-DLO SECTION.
       INI-VAL-KEY-DLO.
           PERFORM VAL-IKY-DLO.
           PERFORM VAL-MKY-DLO.
           PERFORM VAL-AKY-DLO.
       FIN-VAL-KEY-DLO.
           EXIT.
       
       VAL-IKY-DLO SECTION.
       INI-VAL-IKY-DLO.
           PERFORM VAL-LDC-CAI-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-CAI-ICLF-LEN IN DLO-FLD
                GO TO FIN-VAL-IKY-DLO.
           PERFORM VAL-LDC-IIC-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IIC-ICLF-LEN IN DLO-FLD
                GO TO FIN-VAL-IKY-DLO.
           PERFORM VAL-LDC-NUM-ILDC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-NUM-ILDC-LEN IN DLO-FLD
                GO TO FIN-VAL-IKY-DLO.
       FIN-VAL-IKY-DLO.
           EXIT.
       
       VAL-MKY-DLO SECTION.
       INI-VAL-MKY-DLO.
       FIN-VAL-MKY-DLO.
           EXIT.
       
       VAL-AKY-DLO SECTION.
       INI-VAL-AKY-DLO.
       FIN-VAL-AKY-DLO.
           EXIT.
       
       VAL-LDC-CAI-ICLF SECTION.
       INI-VAL-LDC-CAI-ICLF.
           IF LDC-CAI-ICLF IN DLO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-CAI-ICLF.
       FIN-VAL-LDC-CAI-ICLF.
           EXIT.
       
       VAL-LDC-IIC-ICLF SECTION.
       INI-VAL-LDC-IIC-ICLF.
           IF LDC-IIC-ICLF IN DLO-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-IIC-ICLF.
       FIN-VAL-LDC-IIC-ICLF.
           EXIT.
       
       VAL-LDC-NUM-ILDC SECTION.
       INI-VAL-LDC-NUM-ILDC.
      *<<<<
           GO TO CNT-NUM-ILDC.
      *>>>>
           IF LDC-NUM-ILDC IN DLO-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-NUM-ILDC.
      *<<<<
       CNT-NUM-ILDC.
      *    IF LDC-NUM-ILDC IN DLO-FLD = ZEROES
      *         PERFORM ERR-GLS
      *         GO TO FIN-VAL-LDC-NUM-ILDC.

           IF(SCR-CCPP = 'ING')
              MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN PRY-VARI
              MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN PRY-VARI
              PERFORM BUS-NUM-ILDC
              IF (PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   GO TO FIN-VAL-LDC-NUM-ILDC
               ELSE
                   MOVE LDC-NUM-ILDC IN PRY-VARI TO
                        LDC-NUM-ILDC IN DLO-FLD
                   GO TO FIN-VAL-LDC-NUM-ILDC.

            IF LDC-NUM-ILDC IN DLO-FLD = ZEROES
                PERFORM BUS-COR-LDC.
      *>>>>
       FIN-VAL-LDC-NUM-ILDC.
           EXIT.
       
       VAL-CON-KEY-DLO SECTION.
       INI-VAL-CON-KEY-DLO.
           IF     LDC-CAI-ICLF IN DLO-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN DLO-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN DLO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-DLO.
       FIN-VAL-CON-KEY-DLO.
           EXIT.
       
       VAL-CON-IKY-DLO SECTION.
       INI-VAL-CON-IKY-DLO.
           IF     LDC-CAI-ICLF IN DLO-FLD NOT > SPACES 
              AND LDC-IIC-ICLF IN DLO-FLD NOT > ZEROES 
              AND LDC-NUM-ILDC IN DLO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-DLO.
       FIN-VAL-CON-IKY-DLO.
           EXIT.
       
       VAL-NUM-KEY-DLO SECTION.
       INI-VAL-NUM-KEY-DLO.
           PERFORM VAL-NUM-IKY-DLO.
           PERFORM VAL-NUM-MKY-DLO.
           PERFORM VAL-NUM-AKY-DLO.
       FIN-VAL-NUM-KEY-DLO.
           EXIT.
       
       VAL-NUM-IKY-DLO SECTION.
       INI-VAL-NUM-IKY-DLO.
       VAL-NUM-LDC-IIC-ICLF.
           MOVE LDC-IIC-ICLF-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-IIC-ICLF IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-IIC-ICLF-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-IKY-DLO.
       VAL-NUM-LDC-NUM-ILDC.
           MOVE LDC-NUM-ILDC-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-ILDC IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-ILDC-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-IKY-DLO.
       FIN-VAL-NUM-IKY-DLO.
           EXIT.
       
       VAL-NUM-MKY-DLO SECTION.
       INI-VAL-NUM-MKY-DLO.
       FIN-VAL-NUM-MKY-DLO.
           EXIT.
       
       VAL-NUM-AKY-DLO SECTION.
       INI-VAL-NUM-AKY-DLO.
       FIN-VAL-NUM-AKY-DLO.
           EXIT.
       
       VAL-NUM-FLD-DLO SECTION.
       INI-VAL-NUM-FLD-DLO.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-LDC-VAL-CMAX.
           MOVE LDC-VAL-CMAX-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LDC-VAL-CMAX IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-VAL-CMAX-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MADJ.
           MOVE LCC-VAL-MADJ-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MADJ IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MADJ-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MUTI.
           MOVE LCC-VAL-MUTI-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MUTI IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MUTI-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MTOS.
           MOVE LCC-VAL-MTOS-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MTOS IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MTOS-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-ICG-SGV-TINT.
           MOVE ICG-SGV-TINT-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO ICG-SGV-TINT IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ICG-SGV-TINT-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LDC-NUM-PVIG.
           MOVE LDC-NUM-PVIG-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-PVIG IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-PVIG-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       FIN-VAL-NUM-FLD-DLO.
           EXIT.
       
       EDT-KEY-DLO SECTION.
       INI-EDT-KEY-DLO.
           PERFORM EDT-IKY-DLO.
           PERFORM EDT-MKY-DLO.
           PERFORM EDT-AKY-DLO.
       FIN-EDT-KEY-DLO.
           EXIT.
       
       EDT-IKY-DLO SECTION.
       INI-EDT-IKY-DLO.
           IF LDC-IIC-ICLF-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-IIC-ICLF-LEN IN DLO-FLD
                GO TO FIN-EDT-IKY-DLO.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO LDC-IIC-ICLF-EDT IN DLO-EDT.
           MOVE LDC-IIC-ICLF-EDT IN DLO-EDT TO 
                LDC-IIC-ICLF-ALF IN DLO-FLD.
           IF LDC-NUM-ILDC-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-ILDC-LEN IN DLO-FLD
                GO TO FIN-EDT-IKY-DLO.
           MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC-EDT IN DLO-EDT.
           MOVE LDC-NUM-ILDC-EDT IN DLO-EDT TO 
                LDC-NUM-ILDC-ALF IN DLO-FLD.
       FIN-EDT-IKY-DLO.
           EXIT.
       
       EDT-MKY-DLO SECTION.
       INI-EDT-MKY-DLO.
       FIN-EDT-MKY-DLO.
           EXIT.
       
       EDT-AKY-DLO SECTION.
       INI-EDT-AKY-DLO.
       FIN-EDT-AKY-DLO.
           EXIT.
       
       EDT-FLD-DLO SECTION.
       INI-EDT-FLD-DLO.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE DBC-NUM-ICLI IN DLO-FLD TO
                DBC-NUM-ICLI-EDT IN DLO-EDT.
           MOVE DBC-NUM-ICLI-EDT IN DLO-EDT TO
                DBC-NUM-ICLI-ALF IN DLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF LDC-VAL-CMAX-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LDC-VAL-CMAX IN DLO-FLD TO LDC-VAL-CMAX-EDT IN DLO-EDT.
           MOVE LDC-VAL-CMAX-EDT IN DLO-EDT TO 
                LDC-VAL-CMAX-ALF IN DLO-FLD.
           IF LCC-VAL-MADJ-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MADJ-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MADJ IN DLO-FLD TO LCC-VAL-MADJ-EDT IN DLO-EDT.
           MOVE LCC-VAL-MADJ-EDT IN DLO-EDT TO 
                LCC-VAL-MADJ-ALF IN DLO-FLD.
           IF LCC-VAL-MUTI-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MUTI-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MUTI IN DLO-FLD TO LCC-VAL-MUTI-EDT IN DLO-EDT.
           MOVE LCC-VAL-MUTI-EDT IN DLO-EDT TO 
                LCC-VAL-MUTI-ALF IN DLO-FLD.
           IF LCC-VAL-MTOS-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MTOS-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MTOS IN DLO-FLD TO LCC-VAL-MTOS-EDT IN DLO-EDT.
           MOVE LCC-VAL-MTOS-EDT IN DLO-EDT TO 
                LCC-VAL-MTOS-ALF IN DLO-FLD.
           IF ICG-SGV-TINT-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ICG-SGV-TINT-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE ICG-SGV-TINT IN DLO-FLD TO ICG-SGV-TINT-EDT IN DLO-EDT.
           MOVE ICG-SGV-TINT-EDT IN DLO-EDT TO 
                ICG-SGV-TINT-ALF IN DLO-FLD.
           IF LDC-NUM-PVIG-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-PVIG-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LDC-NUM-PVIG IN DLO-FLD TO LDC-NUM-PVIG-EDT IN DLO-EDT.
           MOVE LDC-NUM-PVIG-EDT IN DLO-EDT TO 
                LDC-NUM-PVIG-ALF IN DLO-FLD.
       FIN-EDT-FLD-DLO.
           EXIT.
      *<<<<
       BUS-COR-LDC SECTION.
       INI-BUS-COR-LDC.
           MOVE LDC-CAI-ICLF IN DLO-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE 99                      TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
                    LDC-CAI-ICLF IN DLO-FLD = LDC-CAI-ICLF IN LDC AND
                    LDC-IIC-ICLF IN DLO-FLD = LDC-IIC-ICLF IN LDC )
               PERFORM KEY-ALL-DLO.
           MOVE LDC-NUM-ILDC IN LDC TO LDC-NUM-ILDC IN DLO-FLD.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.
       FIN-BUS-COR-LDC.
           EXIT.
      *>>>>
