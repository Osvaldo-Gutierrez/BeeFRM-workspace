      *
      * LDCBURLO
      * Version 3.0.1 Nov-2005
      * 28-Mar-19 08:16 PM
      *
      *-----------------------------------------------------------------
      *MODIFICACIONES:                                                  
      *--------------                                                   
      *OBJETIVO: SE MODIFICAN LOS COMANDOS LIB Y RBJ                    
      *PROYECTO: LOF CON CANCELACIONES                                  
      *FECHA   : JULIO DE 2009                                          
      *AUTOR   : CHC                                                    
      *ETIQUETA: *AFRI-INI/LOF/CHC/07-2009                              
      *-----------------------------------------------------------------
       SET-TAG-LDCBURLO SECTION.
       INI-SET-TAG-LDCBURLO.
           MOVE
           '<IDNMOD NOM=$LDCBURLO$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$28-Mar-19 08:16 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBURLO.
           EXIT.
           
       RET-ALL-RLO SECTION.
       INI-RET-ALL-RLO.
           PERFORM KEY-ALL-RLO.
           PERFORM RET-RLO-RLO.
       FIN-RET-ALL-RLO.
           EXIT.
       
       RET-RLO-RLO SECTION.
       INI-RET-RLO-RLO.
           MOVE RLO-CIC-ENTI IN RLO-FLD TO RLO-CIC-ENTI IN RLO.
           MOVE RLO-COD-ACTI IN RLO-FLD TO RLO-COD-ACTI IN RLO.
           MOVE RLO-NUM-UNIL IN RLO-FLD TO RLO-NUM-UNIL IN RLO.
           MOVE RLO-VAL-MGAR IN RLO-FLD TO RLO-VAL-MGAR IN RLO.
           MOVE RLO-VAL-SGAR IN RLO-FLD TO RLO-VAL-SGAR IN RLO.
           MOVE RLO-VAL-PGAR IN RLO-FLD TO RLO-VAL-PGAR IN RLO.
           MOVE RLO-COD-CGAR IN RLO-FLD TO RLO-COD-CGAR IN RLO.
           MOVE RLO-COD-CGTA IN RLO-FLD TO RLO-COD-CGTA IN RLO.
           MOVE RLO-COD-DESO IN RLO-FLD TO RLO-COD-DESO IN RLO.
           MOVE RLO-COD-DENV IN RLO-FLD TO RLO-COD-DENV IN RLO.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE RLO-NUM-DACT IN RLO-FLD TO RLO-NUM-DACT IN RLO.
           MOVE RLO-NUM-MACT IN RLO-FLD TO RLO-NUM-MACT IN RLO.
           MOVE RLO-NUM-SACT IN RLO-FLD TO RLO-NUM-SACT IN RLO.
           MOVE RLO-NUM-AACT IN RLO-FLD TO RLO-NUM-AACT IN RLO.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-RLO-RLO.
           EXIT.
       
       KEY-ALL-RLO SECTION.
       INI-KEY-ALL-RLO.
           PERFORM KEY-RLO-RLO.
      *<<<< FIN_KEY_ALL_RLO                                             
           IF RLO-NUM-IOPC IN RLO-FLD > ZEROES                          
              MOVE 'LDC'    TO RLO-COD-CPTO IN RLO                      
           ELSE                                                         
              MOVE 'OPC'    TO RLO-COD-CPTO IN RLO.                     
      *>>>>                                                             
       FIN-KEY-ALL-RLO.
           EXIT.
       
       KEY-RLO-RLO SECTION.
       INI-KEY-RLO-RLO.
           MOVE RLO-CAI-ILIC IN RLO-FLD TO RLO-CAI-ILIC IN RLO.
           MOVE RLO-IIC-ILIC IN RLO-FLD TO RLO-IIC-ILIC IN RLO.
           MOVE RLO-CAI-IOPC IN RLO-FLD TO RLO-CAI-IOPC IN RLO.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO RLO-IIC-IOPC IN RLO.
           MOVE RLO-NUM-IOPC IN RLO-FLD TO RLO-NUM-IOPC IN RLO.
       FIN-KEY-RLO-RLO.
           EXIT.
       
       SCR-CLRA-RLO SECTION.
       INI-SCR-CLRA-RLO.
           PERFORM CLR-KEY-RLO.
           PERFORM CLR-FLD-RLO.
       FIN-SCR-CLRA-RLO.
           EXIT.
       
       CLR-KEY-RLO SECTION.
       INI-CLR-KEY-RLO.
           MOVE SPACES TO RLO-CAI-ILIC IN RLO-FLD.
           MOVE SPACES TO RLO-IIC-ILIC IN RLO-FLD.
           MOVE SPACES TO RLO-CAI-IOPC IN RLO-FLD.
           MOVE ZEROES TO RLO-IIC-IOPC IN RLO-FLD.
           MOVE ZEROES TO RLO-NUM-IOPC IN RLO-FLD.
       FIN-CLR-KEY-RLO.
           EXIT.
       
       CLR-FLD-RLO SECTION.
       INI-CLR-FLD-RLO.
           MOVE SPACES TO FRM-GLS-NOMB IN RLO-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-VRF-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-IND-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-CLIE IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-COD-TIPO IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-DESC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-MOPC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-SOPC IN RLO-FLD.
      * VRF-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN RLO-FLD.
      * VRF-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-IND-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-MLIB IN RLO-FLD.
           MOVE SPACES TO FRM-CAI-ILIC IN RLO-FLD.
           MOVE SPACES TO FRM-IIC-ILIC IN RLO-FLD.
           PERFORM CLR-RLO-RLO.
       FIN-CLR-FLD-RLO.
           EXIT.
       
       CLR-RLO-RLO SECTION.
       INI-CLR-RLO-RLO.
           MOVE SPACES TO RLO-CIC-ENTI IN RLO-FLD.
           MOVE SPACES TO RLO-COD-ACTI IN RLO-FLD.
           MOVE SPACES TO RLO-NUM-UNIL IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-MGAR IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-SGAR IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-PGAR IN RLO-FLD.
           MOVE SPACES TO RLO-COD-CGAR IN RLO-FLD.
           MOVE SPACES TO RLO-COD-CGTA IN RLO-FLD.
           MOVE SPACES TO RLO-COD-DESO IN RLO-FLD.
           MOVE SPACES TO RLO-COD-DENV IN RLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO RLO-FEC-FACT IN RLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-RLO-RLO.
           EXIT.
       
       FST-KEY-RLO SECTION.
       INI-FST-KEY-RLO.
           MOVE -1 TO RLO-CAI-ILIC-LEN IN RLO-FLD.
       FIN-FST-KEY-RLO.
           EXIT.
       
       FST-FLD-RLO SECTION.
       INI-FST-FLD-RLO.
      *<<<< INI-FST-FLD-RLO.                                            
           IF SCR-CMND = 'TRL'                                          
               MOVE -1 TO FRM-CAI-ILIC-LEN IN RLO-FLD                   
           ELSE                                                         
      *>>>>                                                             

           MOVE -1 TO RLO-COD-CGTA-LEN IN RLO-FLD.
       FIN-FST-FLD-RLO.
           EXIT.
       
       PRO-KEY-RLO SECTION.
       INI-PRO-KEY-RLO.
           PERFORM PRO-MKY-RLO.
       FIN-PRO-KEY-RLO.
           EXIT.
       
       PRO-MKY-RLO SECTION.
       INI-PRO-MKY-RLO.
       FIN-PRO-MKY-RLO.
           EXIT.
       
       PRO-FLD-RLO SECTION.
       INI-PRO-FLD-RLO.
           MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO FRM-CAI-ILIC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-ILIC-ATR IN RLO-FLD.
           PERFORM PRO-RLO-RLO.
       FIN-PRO-FLD-RLO.
           EXIT.
       
       PRO-RLO-RLO SECTION.
       INI-PRO-RLO-RLO.
           MOVE FRM-CPIM-AEY TO RLO-COD-CGTA-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO RLO-COD-DENV-ATR IN RLO-FLD.
       FIN-PRO-RLO-RLO.
           EXIT.
       
       UNP-KEY-RLO SECTION.
       INI-UNP-KEY-RLO.
           PERFORM UNP-IKY-RLO.
           PERFORM UNP-AKY-RLO.
           PERFORM UNP-MKY-RLO.
       FIN-UNP-KEY-RLO.
           EXIT.
       
       UNP-IKY-RLO SECTION.
       INI-UNP-IKY-RLO.
           MOVE FRM-CPIM-UBY TO RLO-CAI-ILIC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-IIC-ILIC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-NUM-IOPC-ATR.
       FIN-UNP-IKY-RLO.
           EXIT.
       
       UNP-MKY-RLO SECTION.
       INI-UNP-MKY-RLO.
       FIN-UNP-MKY-RLO.
           EXIT.
       
       UNP-AKY-RLO SECTION.
       INI-UNP-AKY-RLO.
       FIN-UNP-AKY-RLO.
           EXIT.
       
       UNP-FLD-RLO SECTION.
       INI-UNP-FLD-RLO.
           MOVE FRM-CPIM-UBY TO FRM-VAL-MLIB-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO FRM-CAI-ILIC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-ILIC-ATR IN RLO-FLD.
           PERFORM UNP-RLO-RLO.
      *<<<< FIN-UNP-FLD-RLO                                             
           IF SCR-CMND = 'TRL'                                          
               MOVE FRM-CPIM-AEY TO RLO-COD-CGTA-ATR IN RLO-FLD         
               MOVE FRM-CPIM-AEY TO RLO-COD-DENV-ATR IN RLO-FLD         
               MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLO-FLD.        
      *>>>>                                                             
       FIN-UNP-FLD-RLO.
           EXIT.
       
       UNP-RLO-RLO SECTION.
       INI-UNP-RLO-RLO.
           MOVE FRM-CPIM-UBY TO RLO-COD-CGTA-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO RLO-COD-DENV-ATR IN RLO-FLD.
       FIN-UNP-RLO-RLO.
           EXIT.
       
       VAL-MKY-RLO SECTION.
       INI-VAL-MKY-RLO.
       FIN-VAL-MKY-RLO.
           EXIT.
       
       VAL-FLD-RLO SECTION.
       INI-VAL-FLD-RLO.
           PERFORM VAL-FRM-GLS-NOMB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMB-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-IND-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-GLS-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-GLS-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-NUM-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-VRF-CLIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-TIPO-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-DESC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-CIC-ENTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-CIC-ENTI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-COD-ACTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-COD-ACTI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-NUM-UNIL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-NUM-UNIL-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-VAL-MGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-VAL-MGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-VAL-SGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-VAL-SGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-VAL-MOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-MOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-VAL-SOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-SOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-NUM-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-VRF-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-VAL-PGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-VAL-PGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-COD-CGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-COD-CGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-COD-CGTA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-COD-CGTA-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-COD-DESO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-COD-DESO-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-RLO-COD-DENV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-COD-DENV-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-RLO-FEC-FACT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                RLO-FEC-FACT-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-VAL-MLIB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-MLIB-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-CAI-ILIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-CAI-ILIC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
           PERFORM VAL-FRM-IIC-ILIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IIC-ILIC-LEN IN RLO-FLD
                GO TO FIN-VAL-FLD-RLO.
       FIN-VAL-FLD-RLO.
           EXIT.
       
       VAL-FRM-GLS-NOMB SECTION.
       INI-VAL-FRM-GLS-NOMB.
       FIN-VAL-FRM-GLS-NOMB.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-FRM-NUM-CLIE SECTION.
       INI-VAL-FRM-NUM-CLIE.
       FIN-VAL-FRM-NUM-CLIE.
           EXIT.

       VAL-FRM-VRF-CLIE SECTION.
       INI-VAL-FRM-VRF-CLIE.
           IF FRM-VRF-CLIE IN RLO-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-CLIE IN RLO-FLD.
       FIN-VAL-FRM-VRF-CLIE.
           EXIT.
       VAL-FRM-IND-CLIE SECTION.
       INI-VAL-FRM-IND-CLIE.
           IF FRM-IND-CLIE IN RLO-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-CLIE IN RLO-FLD.
       FIN-VAL-FRM-IND-CLIE.
           EXIT.

       VAL-FRM-GLS-CLIE SECTION.
       INI-VAL-FRM-GLS-CLIE.
                                                                        
           IF FRM-GLS-CLIE IN RLO-FLD NOT > IDC-INIC-GLS                
              MOVE IDC-INIC-GLS TO FRM-GLS-CLIE IN RLO-FLD.             
      *VAL-GLS para IDC valida glosa ( extension ) de identificador     
           MOVE FRM-GLS-CLIE IN RLO-FLD TO IDC-GLS-RUTV.                
      *AFRI-INI/LOF/CHC/07-2009
      *    PERFORM VAL-GLS.                                             
      *AFRI-INI/LOF/CHC/07-2009
           MOVE IDC-GLS-RUTV TO FRM-GLS-CLIE IN RLO-FLD.                
                                                                        
           GO TO FIN-VAL-FRM-GLS-CLIE.
           IF FRM-GLS-CLIE IN RLO-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO FRM-GLS-CLIE IN RLO-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE FRM-GLS-CLIE IN RLO-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO FRM-GLS-CLIE IN RLO-FLD.
       FIN-VAL-FRM-GLS-CLIE.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-COD-TIPO SECTION.
       INI-VAL-FRM-COD-TIPO.
       FIN-VAL-FRM-COD-TIPO.
           EXIT.
       
       VAL-FRM-GLS-DESC SECTION.
       INI-VAL-FRM-GLS-DESC.
       FIN-VAL-FRM-GLS-DESC.
           EXIT.
       
       VAL-RLO-CIC-ENTI SECTION.
       INI-VAL-RLO-CIC-ENTI.
       FIN-VAL-RLO-CIC-ENTI.
           EXIT.
       
       VAL-RLO-COD-ACTI SECTION.
       INI-VAL-RLO-COD-ACTI.
       FIN-VAL-RLO-COD-ACTI.
           EXIT.
       
       VAL-RLO-NUM-UNIL SECTION.
       INI-VAL-RLO-NUM-UNIL.
       FIN-VAL-RLO-NUM-UNIL.
           EXIT.
       
       VAL-RLO-VAL-MGAR SECTION.
       INI-VAL-RLO-VAL-MGAR.
       FIN-VAL-RLO-VAL-MGAR.
           EXIT.
       
       VAL-RLO-VAL-SGAR SECTION.
       INI-VAL-RLO-VAL-SGAR.
       FIN-VAL-RLO-VAL-SGAR.
           EXIT.
       
       VAL-FRM-VAL-MOPC SECTION.
       INI-VAL-FRM-VAL-MOPC.
       FIN-VAL-FRM-VAL-MOPC.
           EXIT.
       
       VAL-FRM-VAL-SOPC SECTION.
       INI-VAL-FRM-VAL-SOPC.
       FIN-VAL-FRM-VAL-SOPC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-NUM-ICLI SECTION.
       INI-VAL-FRM-NUM-ICLI.
       FIN-VAL-FRM-NUM-ICLI.
           EXIT.

       VAL-FRM-VRF-ICLI SECTION.
       INI-VAL-FRM-VRF-ICLI.
           IF FRM-VRF-ICLI IN RLO-FLD NOT > SPACES
              MOVE SPACES TO FRM-VRF-ICLI IN RLO-FLD.
       FIN-VAL-FRM-VRF-ICLI.
           EXIT.

      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-IND-ICLI SECTION.
       INI-VAL-FRM-IND-ICLI.
       FIN-VAL-FRM-IND-ICLI.
           EXIT.
       
       VAL-FRM-GLS-ICLI SECTION.
       INI-VAL-FRM-GLS-ICLI.
                                                                        
           IF FRM-GLS-ICLI IN RLO-FLD NOT > IDC-INIC-GLS                
              MOVE IDC-INIC-GLS TO FRM-GLS-ICLI IN RLO-FLD.             
      *VAL-GLS para IDC valida glosa ( extension ) de identificador     
      *    MOVE FRM-GLS-ICLI IN RLO-FLD TO IDC-GLS-RUTV.                
      *    PERFORM VAL-GLS.                                             
      *    MOVE IDC-GLS-RUTV TO FRM-GLS-ICLI IN RLO-FLD.                
           GO TO FIN-VAL-FRM-GLS-ICLI.      
       FIN-VAL-FRM-GLS-ICLI.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-RLO-VAL-PGAR SECTION.
       INI-VAL-RLO-VAL-PGAR.
       FIN-VAL-RLO-VAL-PGAR.
           EXIT.
       
       VAL-RLO-COD-CGAR SECTION.
       INI-VAL-RLO-COD-CGAR.
       FIN-VAL-RLO-COD-CGAR.
           EXIT.
       
       VAL-RLO-COD-CGTA SECTION.
       INI-VAL-RLO-COD-CGTA.
      *<<<<
           IF RLO-COD-CGTA IN RLO-FLD NOT > SPACES                      
              MOVE SPACES TO RLO-COD-CGTA IN RLO-FLD.                   
           IF RLO-COD-CGTA IN RLO-FLD NOT > SPACES AND SCR-CMND = 'RBJ' 
              PERFORM ERR-GLS.                                          
                                                                        
           IF SCR-CMND NOT = 'RBJ'                                      
              GO TO FIN-VAL-RLO-COD-CGTA.                               
           MOVE 'COL'                   TO FIO-SIST.                    
           MOVE 'GARA'                  TO MSC-COD-TMSC IN MSC.         
           MOVE RLO-COD-CGTA IN RLO-FLD TO MSC-COD-CMSC IN MSC.         
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-MSC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GNS'          TO MSG-COD-SIST                      
               MOVE 'COD    NEX'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-RLO-COD-CGTA.                              
           IF  MSC-IND-VIGE IN MSC NOT = 'S'                            
               MOVE 'GNS'          TO MSG-COD-SIST                      
               MOVE 'COD    NVG'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-RLO-COD-CGTA.
           MOVE MSC-GLS-DATA IN MSC TO VLI-TAB-GLS-GARA.                
           IF VLI-TAB-MSC-GARA NOT = 'F'                                
               MOVE 'DEU'          TO MSG-COD-SIST                      
               MOVE 'GAR NO FOGAP' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR.                       
           GO TO FIN-VAL-RLO-COD-CGTA.
      *>>>>
           IF RLO-COD-CGTA IN RLO-FLD NOT > SPACES
              MOVE SPACES TO RLO-COD-CGTA IN RLO-FLD.
       FIN-VAL-RLO-COD-CGTA.
           EXIT.
       
       VAL-RLO-COD-DESO SECTION.
       INI-VAL-RLO-COD-DESO.
       FIN-VAL-RLO-COD-DESO.
           EXIT.
       
       VAL-RLO-COD-DENV SECTION.
       INI-VAL-RLO-COD-DENV.
           IF RLO-COD-DENV IN RLO-FLD NOT > SPACES
              MOVE SPACES TO RLO-COD-DENV IN RLO-FLD.
           IF RLO-COD-DENV IN RLO-FLD NOT > SPACES AND SCR-CMND = 'RBJ' 
              PERFORM ERR-GLS.                                          
           IF SCR-CMND NOT = 'RBJ'                                      
              GO TO FIN-VAL-RLO-COD-DENV.                               
           MOVE 'COL'              TO TAB-COD-SIST FIO-SIST.            
           MOVE 'DES'              TO TAB-COD-TTAB IN TAB.              
           MOVE RLO-COD-DENV IN RLO-FLD   TO TAB-COD-CTAB IN TAB.       
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'GNS'          TO MSG-COD-SIST                      
               MOVE 'COD    NEX'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-RLO-COD-DENV.                              
           IF  MSC-IND-VIGE IN MSC NOT = 'S'                            
               MOVE 'GNS'          TO MSG-COD-SIST                      
               MOVE 'COD    NVG'   TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-RLO-COD-DENV.                              
           MOVE TAB-GLS-DATA IN TAB TO VLI-TAB-GLS-CDOC.                
           IF NOT ( VLI-TAB-COD-CDOC = 'K' OR                           
              VLI-TAB-COD-CDOC = 'I')                                   
              MOVE 'DEU'          TO MSG-COD-SIST                       
              MOVE 'DES NO FOGAP' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR.                          
       FIN-VAL-RLO-COD-DENV.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-RLO-FEC-FACT SECTION.
       INI-VAL-RLO-FEC-FACT.
           IF RLO-FEC-FACT IN RLO-FLD  NOT > ZEROES
              MOVE ZEROES TO RLO-FEC-FACT IN RLO-FLD.
      *<<<<
           IF RLO-FEC-FACT IN RLO-FLD  NOT > ZEROES                     
              PERFORM GET-FHOY                                          
              MOVE HOY-DHOY TO RLO-NUM-DACT IN RLO-FLD                  
              MOVE HOY-MHOY TO RLO-NUM-MACT IN RLO-FLD                  
              MOVE HOY-SHOY TO RLO-NUM-SACT IN RLO-FLD                  
              MOVE HOY-AHOY TO RLO-NUM-AACT IN RLO-FLD.                 
           GO TO FIN-VAL-RLO-FEC-FACT.
      *>>>>
       FIN-VAL-RLO-FEC-FACT.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-VAL-MLIB SECTION.
       INI-VAL-FRM-VAL-MLIB.
           IF SCR-CMND = 'ANC' AND FRM-VAL-MLIB IN RLO-FLD NOT > ZEROES 
      *AFRI-INI/LOF/CHC/07-2009
      *        PERFORM ERR-GLS
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'ANC Y MLIB=0' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
      *AFRI-FIN/LOF/CHC/07-2009
               GO TO FIN-VAL-FRM-VAL-MLIB.

      *AFRI-INI/LOF/CHC/07-2009
           IF SCR-CMND NOT = 'LIB'
              GO TO FIN-VAL-FRM-VAL-MLIB.                               
                                                                        
           MOVE ZEROES TO WSS-POR-MLIB IN WSS.
      *AFRI-FIN/LOF/CHC/07-2009
           IF FRM-VAL-MLIB IN RLO-FLD >  ZEROES                         
      *AFRI-INI/LOF/CHC/07-2009
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'MLIB > 0'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               MOVE ZEROES TO FRM-VAL-MLIB IN RLO-FLD
      *AFRI-FIN/LOF/CHC/07-2009
               GO TO FIN-VAL-FRM-VAL-MLIB.                              
           IF RLO-NUM-IOPC IN RLO-FLD NOT = ZEROES                      
      *AFRI-INI/LOF/CHC/07-2009
      *        MOVE 'DEU'         TO MSG-COD-SIST
      *        MOVE 'NUMIOPC > 0' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC  TO FRM-MENS
      *        MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.                              

           MOVE RLO-CAI-IOPC IN RLO-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'OPC    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.                              

           IF OPC-COD-TOOC IN OPC = 'AVC'
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'TOOC=AVC'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.

           MOVE RLO-CAI-ILIC IN RLO-FLD TO RLO-CAI-ILIC IN RLO.
           MOVE RLO-IIC-ILIC IN RLO-FLD TO RLO-IIC-ILIC IN RLO.
           MOVE 'OPC'                   TO RLO-COD-CPTO IN RLO.
           MOVE RLO-CAI-IOPC IN RLO-FLD TO RLO-CAI-IOPC IN RLO.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO RLO-IIC-IOPC IN RLO.
           MOVE ZEROES                  TO RLO-NUM-IOPC IN RLO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-RLO.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'LDC NO LIC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.

           IF RLO-IND-CMND IN RLO NOT = 'RBJ'
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'PREVNORBJ'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.

           MOVE RLO-CIC-ILIC IN RLO TO LCC-CIC-ILIC IN LCC.
           MOVE 'LCC-KEY-ILIC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'NOEXIS   LCC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.

           MOVE LCC-CAI-ICLF IN LCC TO CLF-CAI-ICLF IN CLF.
           MOVE LCC-IIC-ICLF IN LCC TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.

           PERFORM OBT-COD-VLR.
           IF WSS-COD-PESO IN WSS = ZEROES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-VAL-MLIB.
      *AFRI-FIN/LOF/CHC/07-2009
      *********************************
      *RUTINA BDO
      *    PERFORM LOC-LLE-ENT.
      *    INGRESA PARAMETROS DE ENTRADA BGBDO
           MOVE RLO-CAI-IOPC IN RLO-FLD TO BDO-CAI-IOPC IN BDO-VARI.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO BDO-IIC-IOPC IN BDO-VARI.
           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO BDO-FEC-FPRO IN BDO-VARI.

           PERFORM OBT-OPE-ANT.
           PERFORM OBT-OPE-ORI.
           MOVE BDO-CIC-ORIG TO BDO-CIC-IOPC IN BDO-VARI.
           IF (BDO-CIC-PROR > SPACES)
               MOVE BDO-CIC-PROR TO BDO-CIC-IOPC IN BDO-VARI.

           PERFORM OBT-SAL-OPC.
           MOVE RLO-CAI-IOPC IN RLO-FLD TO BDO-CAI-IOPC IN BDO-VARI.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO BDO-IIC-IOPC IN BDO-VARI.
           PERFORM BUS-OPC-VOP2.
      *    PERFORM LOC-RES-ENT.
      *RUTINA BDO
      *********************************
      *    MOVE RLO-CAI-IOPC IN RLO-FLD TO CAN-CAI-IOPC IN CAN.
      *    MOVE RLO-IIC-IOPC IN RLO-FLD TO CAN-IIC-IOPC IN CAN.
      *    MOVE ZEROES                  TO CAN-NUM-ICAN IN CAN.
      *    MOVE FIO-GET-NLS TO FIO-CMND.
      *LEE-SIG-CAN.
      *    PERFORM COL-FIO-CAN.
      *    IF NOT ( FIO-STAT-OKS AND
      *       RLO-CAI-IOPC IN RLO-FLD =  CAN-CAI-IOPC IN CAN AND
      *       RLO-IIC-IOPC IN RLO-FLD =  CAN-IIC-IOPC IN CAN )
      *AFRI-INI/LOF/CHC/07-2009
      *    IF NOT FIO-STAT-OKS
      *        MOVE 'COL'        TO MSG-COD-SIST
      *        MOVE 'CAN    NEX' TO MSG-COD-MENS
      *       PERFORM GET-MSG
      *       MOVE MSG-GLS-DESC   TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-FRM-VAL-MLIB.

      *    IF NOT (RLO-CAI-IOPC IN RLO-FLD = CAN-CAI-IOPC IN CAN AND
      *     RLO-IIC-IOPC IN RLO-FLD = CAN-IIC-IOPC IN CAN )
      *AFRI-FIN/LOF/CHC/07-2009
      *        GO TO FIN-VAL-FRM-VAL-MLIB.
      *    IF CAN-MSC-STAT IN CAN NOT = 'A'
      *        MOVE FIO-GET-NXT TO FIO-CMND
      *        GO TO LEE-SIG-CAN.
      *AFRI-INI/LOF/CHC/07-2009
      *    PERFORM BUS-REG-CXE.
      *    IF WSS-EXI-RCXE IN WSS = 'S'
      *        MOVE FIO-GET-NXT TO FIO-CMND
      *        GO TO LEE-SIG-CAN.
      *AFRI-FIN/LOF/CHC/07-2009
      *    MOVE CAN-KEY-ICAN IN CAN TO RCV-KEY-ICAN IN RCV
      *    MOVE SPACES              TO RCV-CIC-IOPV IN RCV
      *    MOVE ZEROES              TO RCV-NUM-IVCT IN RCV
      *    MOVE FIO-GET-NLS TO FIO-CMND.
      *    PERFORM COL-FIO-RCV.
      *    IF NOT ( FIO-STAT-OKS AND
      *       CAN-KEY-ICAN IN CAN = RCV-KEY-ICAN IN RCV )
      *        MOVE FIO-GET-NXT TO FIO-CMND
      *        GO TO LEE-SIG-CAN.
      *AFRI-INI/LOF/CHC/07-2009
      *    COMPUTE WSS-POR-MLIB IN WSS = RLO-VAL-PGAR IN RLO *
      *     RCV-SGV-CAPI IN RCV.
      *    DIVIDE WSS-POR-MLIB IN WSS BY 100 GIVING WSS-POR-MLIB IN WSS.
      *    PERFORM DET-MON-LIC.
      *AFRI-FIN/LOF/CHC/07-2009
      *    COMPUTE FRM-VAL-MLIB IN RLO-FLD = FRM-VAL-MLIB IN RLO-FLD +
      *AFRI-INI/LOF/CHC/07-2009
      *            RCV-SGV-CAPI IN RCV.
      *            WSS-POR-MLIB IN WSS.
      *AFRI-FIN/LOF/CHC/07-2009
      *    MOVE FIO-GET-NXT TO FIO-CMND.
      *AFRI-INI/LOF/CHC/07-2009
      *    MOVE ZEROES TO WSS-POR-MLIB IN WSS.
      *AFRI-FIN/LOF/CHC/07-2009
      *    GO TO LEE-SIG-CAN.
       FIN-VAL-FRM-VAL-MLIB.
           EXIT.
       
       VAL-FRM-CAI-ILIC SECTION.
       INI-VAL-FRM-CAI-ILIC.
           IF FRM-CAI-ILIC IN RLO-FLD NOT > SPACES
              MOVE SPACES TO FRM-CAI-ILIC IN RLO-FLD.
       FIN-VAL-FRM-CAI-ILIC.
           EXIT.
       
       VAL-FRM-IIC-ILIC SECTION.
       INI-VAL-FRM-IIC-ILIC.
           IF FRM-IIC-ILIC IN RLO-FLD NOT > SPACES
              MOVE SPACES TO FRM-IIC-ILIC IN RLO-FLD.
      *<<<< INI-VAL-FRM-IIC-ILIC                                        
           IF SCR-CMND NOT = 'TRL'                                      
               GO TO FIN-VAL-FRM-IIC-ILIC.                              
           IF FRM-CAI-ILIC IN RLO-FLD = RLO-CAI-ILIC IN RLO-FLD AND     
              FRM-IIC-ILIC IN RLO-FLD = RLO-IIC-ILIC IN RLO-FLD         
              MOVE 'DEU'          TO MSG-COD-SIST                       
              MOVE 'LCC NO IGUAL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-FRM-IIC-ILIC.                               
           MOVE FRM-CAI-ILIC IN RLO-FLD TO LCC-CAI-ILIC IN LCC.         
           MOVE FRM-IIC-ILIC IN RLO-FLD TO LCC-IIC-ILIC IN LCC.         
           MOVE 'LCC-KEY-ILIC' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM LDC-FIO-LCC                                          
           IF NOT FIO-STAT-OKS                                          
              MOVE 'DEU'          TO MSG-COD-SIST                       
              MOVE 'LCC NO EXIST' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR.                          
           GO TO FIN-VAL-FRM-IIC-ILIC.
      *>>>>                                                             
       FIN-VAL-FRM-IIC-ILIC.
           EXIT.
       
       VAL-CON-FLD-RLO SECTION.
       INI-VAL-CON-FLD-RLO.
       FIN-VAL-CON-FLD-RLO.
           EXIT.
       
       VAL-CON-RLO SECTION.
       INI-VAL-CON-RLO.
       FIN-VAL-CON-RLO.
           EXIT.
       
       VAL-NUM-KEY-RLO SECTION.
       INI-VAL-NUM-KEY-RLO.
           PERFORM VAL-NUM-IKY-RLO.
           PERFORM VAL-NUM-MKY-RLO.
           PERFORM VAL-NUM-AKY-RLO.
       FIN-VAL-NUM-KEY-RLO.
           EXIT.
       
       VAL-NUM-IKY-RLO SECTION.
       INI-VAL-NUM-IKY-RLO.
       VAL-NUM-RLO-IIC-IOPC.
           MOVE RLO-IIC-IOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO RLO-IIC-IOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-IIC-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-IKY-RLO.
       VAL-NUM-RLO-NUM-IOPC.
           MOVE RLO-NUM-IOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO RLO-NUM-IOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-NUM-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-IKY-RLO.
       FIN-VAL-NUM-IKY-RLO.
           EXIT.
       
       VAL-NUM-MKY-RLO SECTION.
       INI-VAL-NUM-MKY-RLO.
       FIN-VAL-NUM-MKY-RLO.
           EXIT.
       
       VAL-NUM-AKY-RLO SECTION.
       INI-VAL-NUM-AKY-RLO.
       FIN-VAL-NUM-AKY-RLO.
           EXIT.
       
       VAL-NUM-FLD-RLO SECTION.
       INI-VAL-NUM-FLD-RLO.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-CLIE.
           MOVE FRM-NUM-CLIE-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-CLIE IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-RLO-VAL-MGAR.
           MOVE RLO-VAL-MGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RLO-VAL-MGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-MGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-RLO-VAL-SGAR.
           MOVE RLO-VAL-SGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RLO-VAL-SGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-SGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-MOPC.
           MOVE FRM-VAL-MOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-MOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-SOPC.
           MOVE FRM-VAL-SOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-SOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-SOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * VRF-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * VRF-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-RLO-VAL-PGAR.
           MOVE RLO-VAL-PGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO RLO-VAL-PGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-PGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-MLIB.
           MOVE FRM-VAL-MLIB-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-MLIB IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MLIB-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       FIN-VAL-NUM-FLD-RLO.
           EXIT.
       
       EDT-KEY-RLO SECTION.
       INI-EDT-KEY-RLO.
           PERFORM EDT-IKY-RLO.
           PERFORM EDT-MKY-RLO.
           PERFORM EDT-AKY-RLO.
       FIN-EDT-KEY-RLO.
           EXIT.
       
       EDT-IKY-RLO SECTION.
       INI-EDT-IKY-RLO.
           IF RLO-IIC-IOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-IIC-IOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-IKY-RLO.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO RLO-IIC-IOPC-EDT IN RLO-EDT.
           MOVE RLO-IIC-IOPC-EDT IN RLO-EDT TO 
                RLO-IIC-IOPC-ALF IN RLO-FLD.
           IF RLO-NUM-IOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-NUM-IOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-IKY-RLO.
           MOVE RLO-NUM-IOPC IN RLO-FLD TO RLO-NUM-IOPC-EDT IN RLO-EDT.
           MOVE RLO-NUM-IOPC-EDT IN RLO-EDT TO 
                RLO-NUM-IOPC-ALF IN RLO-FLD.
       FIN-EDT-IKY-RLO.
           EXIT.
       
       EDT-MKY-RLO SECTION.
       INI-EDT-MKY-RLO.
       FIN-EDT-MKY-RLO.
           EXIT.
       
       EDT-AKY-RLO SECTION.
       INI-EDT-AKY-RLO.
       FIN-EDT-AKY-RLO.
           EXIT.
       
       EDT-FLD-RLO SECTION.
       INI-EDT-FLD-RLO.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-CLIE-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-CLIE-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-NUM-CLIE IN RLO-FLD TO
                FRM-NUM-CLIE-EDT IN RLO-EDT.
           MOVE FRM-NUM-CLIE-EDT IN RLO-EDT TO
                FRM-NUM-CLIE-ALF IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF RLO-VAL-MGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-MGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-MGAR IN RLO-FLD TO RLO-VAL-MGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-MGAR-EDT IN RLO-EDT TO 
                RLO-VAL-MGAR-ALF IN RLO-FLD.
           IF RLO-VAL-SGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-SGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-SGAR IN RLO-FLD TO RLO-VAL-SGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-SGAR-EDT IN RLO-EDT TO 
                RLO-VAL-SGAR-ALF IN RLO-FLD.
           IF FRM-VAL-MOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-MOPC IN RLO-FLD TO FRM-VAL-MOPC-EDT IN RLO-EDT.
           MOVE FRM-VAL-MOPC-EDT IN RLO-EDT TO 
                FRM-VAL-MOPC-ALF IN RLO-FLD.
           IF FRM-VAL-SOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-SOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-SOPC IN RLO-FLD TO FRM-VAL-SOPC-EDT IN RLO-EDT.
           MOVE FRM-VAL-SOPC-EDT IN RLO-EDT TO 
                FRM-VAL-SOPC-ALF IN RLO-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-NUM-ICLI IN RLO-FLD TO
                FRM-NUM-ICLI-EDT IN RLO-EDT.
           MOVE FRM-NUM-ICLI-EDT IN RLO-EDT TO
                FRM-NUM-ICLI-ALF IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF RLO-VAL-PGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-PGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-PGAR IN RLO-FLD TO RLO-VAL-PGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-PGAR-EDT IN RLO-EDT TO 
                RLO-VAL-PGAR-ALF IN RLO-FLD.
           IF FRM-VAL-MLIB-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MLIB-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-MLIB IN RLO-FLD TO FRM-VAL-MLIB-EDT IN RLO-EDT.
           MOVE FRM-VAL-MLIB-EDT IN RLO-EDT TO 
                FRM-VAL-MLIB-ALF IN RLO-FLD.
       FIN-EDT-FLD-RLO.
           EXIT.
                                                                        
      *AFRI-INI/LOF/CHC/07-2009
      *----------------------------------------------------------------
      *DETERMINA LA MONEDA DE LA LICITACION
      *----------------------------------------------------------------
       DET-MON-LIC SECTION.
       INI-DET-MON-LIC.
           IF WSS-COD-PESO IN WSS = LCC-COD-VCOC IN LCC
               MOVE 'S' TO WSS-IND-MONE IN WSS
           ELSE
               MOVE 'N' TO WSS-IND-MONE IN WSS.
           IF OPC-COD-VCOC IN OPC = LCC-COD-VCOC IN LCC
               GO TO FIN-DET-MON-LIC.
           IF OPC-COD-VCOC IN OPC NOT = WSS-COD-PESO IN WSS
               MOVE OPC-COD-VCOC IN OPC    TO CAM-COD-VCAM IN CAM(1)
               MOVE WSS-COD-PESO IN WSS    TO CAM-COD-VCAM IN CAM(2)
               MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1)
               MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CAM    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-DET-MON-LIC
               ELSE
                   MULTIPLY WSS-POR-MLIB IN WSS BY CAM-SGV-VCAM IN CAM
                                     GIVING WSS-POR-MLIB IN WSS ROUNDED.
           IF LCC-COD-VCOC IN LCC = WSS-COD-PESO IN WSS
               GO TO FIN-DET-MON-LIC.
           MOVE LCC-COD-VCOC IN LCC    TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS    TO CAM-COD-VCAM IN CAM(2).
           MOVE OPC-NUM-DCOL IN OPC    TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN OPC    TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN OPC    TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN OPC    TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT (FIO-STAT-OKS AND CAM-IND-VIGE = 'S')
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CAM    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-DET-MON-LIC
           ELSE
              DIVIDE WSS-POR-MLIB IN WSS BY CAM-SGV-VCAM IN CAM
                                     GIVING WSS-POR-MLIB IN WSS ROUNDED.
           IF LCC-COD-VCOC IN LCC = WSS-COD-PESO IN WSS
              MOVE WSS-POR-MLIB IN WSS TO PES-SGV-DECI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE TO WSS-POR-MLIB IN WSS.
       FIN-DET-MON-LIC.
           EXIT.
      *----------------------------------------------------------------
      *OBTIENE CODIGO DE PESO DE LA TABLA VLR
      *----------------------------------------------------------------
       OBT-COD-VLR SECTION.
       INI-OBT-COD-VLR.
           MOVE ZEROES TO WSS-COD-PESO IN WSS.
           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999'         TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
               GO TO FIN-OBT-COD-VLR
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS.
       FIN-OBT-COD-VLR.
           EXIT.
      *----------------------------------------------------------------
      *
      *----------------------------------------------------------------
       BUS-REG-CXE SECTION.
       INI-BUS-REG-CXE.
           MOVE OPC-CAI-IOPC IN OPC      TO CXE-CAI-IOPC IN CXE.
           MOVE OPC-IIC-IOPC IN OPC      TO CXE-IIC-IOPC IN CXE.
           MOVE 'CAN'                    TO CXE-COD-EVEN IN CXE.
           MOVE CAN-NUM-ICAN IN CAN      TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES                   TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES                   TO CXE-NUM-IVCT IN CXE.
           MOVE 'LIBLIC'                 TO CXE-COD-CPTO IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF FIO-STAT-OKS
               MOVE 'S' TO WSS-EXI-RCXE IN WSS
           ELSE
               MOVE 'N' TO WSS-EXI-RCXE IN WSS.
       FIN-BUS-REG-CXE.
           EXIT.
      *----------------------------------------------------------------
      *
      *----------------------------------------------------------------
       BUS-OPC-VOP2 SECTION.
       INI-BUS-OPC-VOP2.
      *BUSCA OPERACIONES ASOCIADAS A OPC ORIG
                                                                        
           MOVE SPACES       TO BDO-IND-ICTT IN BDO-VARI.
           MOVE ZEROES       TO BDO-NUM-IVEN IN BDO-VARI.
                                                                        
           MOVE BDO-CIC-IOPC IN BDO-VARI TO BDO-CIC-IOPE IN BDO-VARI.
           MOVE ZEROES                   TO BDO-NUM-ICAN IN BDO-VARI.
           MOVE ZEROES                   TO BDO-NUM-IVEN IN BDO-VARI.
           PERFORM GRB-VOPC.

      *COMIENZA EL PROCESO
           MOVE BDO-CIC-IOPC IN BDO-VARI TO CAN-CIC-IOPC IN CAN.        
           MOVE ZEROES                   TO CAN-NUM-ICAN IN CAN.        
           MOVE FIO-GET-NLS              TO FIO-CMND.                   
       LUP-BUS-OPC-VOP2.                                                
           PERFORM COL-FIO-CAN.                                         
           IF (NOT FIO-STAT-OKS OR                                      
               BDO-CIC-IOPC IN BDO-VARI NOT = CAN-CIC-IOPC IN CAN)      
                GO TO FIN-BUS-OPC-VOP2
           ELSE
                MOVE ADR-CAN-REQA TO ADR-BDO-REQA.                      

           MOVE CAN-NUM-ICAN IN CAN TO BDO-NUM-ICAN IN BDO-VARI.
           PERFORM BUS-RCV-VOPC.
           IF (CAN-MSC-STAT IN CAN NOT = 'A')
                GO TO NXT-BUS-OPC-VOP2.

      **************************
           MOVE BDO-CIC-IOPC IN BDO-VARI TO OPC-CIC-IOPC IN OPC.        
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         

           PERFORM BUS-REG-CXE.
           IF WSS-EXI-RCXE IN WSS = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO NXT-BUS-OPC-VOP2.

           COMPUTE WSS-POR-MLIB IN WSS = RLO-VAL-PGAR IN RLO *
            BDO-RCV-CAPI IN BDO-VARI.

           DIVIDE WSS-POR-MLIB IN WSS BY 100 GIVING WSS-POR-MLIB IN WSS.

      *    PERFORM PRO-LEE-LCC.
           PERFORM DET-MON-LIC.

           COMPUTE FRM-VAL-MLIB IN RLO-FLD = FRM-VAL-MLIB IN RLO-FLD +
                                             WSS-POR-MLIB IN WSS.

      *    IF WSS-IND-MONE IN WSS = 'N'
      *        MOVE SPACES TO MSG-COD-MENS
      *        PERFORM PRO-CAM-CXE
      *        IF MSG-COD-MENS > SPACES
      *            GO TO FIN-BUS-OPC-VOP2.

      *    IF WSS-POR-MLIB IN WSS > ZEROES
      *        PERFORM PRO-GRA-CXE.

      *    MOVE CAN-FEC-FCAN IN CAN TO WSS-FEC-FCAN IN WSS.

           MOVE ZEROES TO WSS-POR-MLIB IN WSS.
      **************************

           IF (CAN-SGV-TPAG IN CAN < ZEROES OR
               CAN-SGV-DIFE IN CAN < ZEROES OR
               CAN-SGV-TREN IN CAN < ZEROES)
                GO TO NXT-BUS-OPC-VOP2.

      *    VALIDO TIPO DE CANCELACION: TOTAL
           IF (CAN-MSC-CANC IN CAN = 'CTT')
                MOVE 'S' TO BDO-IND-ICTT IN BDO-VARI
                GO TO FIN-BUS-OPC-VOP2.

      *    VALIDO TIPO DE CANCELACION: TOTAL 1 VENCIMIENTO
           IF (CAN-MSC-CANC IN CAN = 'CTE')
                GO TO NXT-BUS-OPC-VOP2.

      *    VALIDO TIPO DE CANCELACION: PARCIAL
           IF (CAN-MSC-CANC IN CAN = 'CIE')
                GO TO NXT-BUS-OPC-VOP2.

      *    VALIDO TIPO DE CANCELACION: PRORROGA
           IF (CAN-MSC-CANC IN CAN = 'PTT' OR 'KTT')                    
                PERFORM BUS-VOPC-PTT
                GO TO FIN-BUS-OPC-VOP2.

      *    VALIDA SI CANCELACION ES PRODUCTO DE TRASPASO
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.             
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.             
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.             
           MOVE FIO-GET-NLS         TO FIO-CMND.                        
           PERFORM COL-FIO-CYA.                                         
                                                                        
      *    SIN CYA => CAN NO TRASPASO
           IF NOT (FIO-STAT-OKS AND                                     
               CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND            
               CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA)               
               IF (CAN-MSC-CANC IN CAN = 'RTT')
                    PERFORM BUS-VOPC-PTT
                    GO TO FIN-BUS-OPC-VOP2
               ELSE
                    GO TO NXT-BUS-OPC-VOP2.                             

      *--------- PRODUCTO TRASPASO ---------                            
           MOVE CYA-IND-TCYA IN CYA TO BDO-COD-TCYA IN BDO-VARI.        
                                                                        
      *    CAN NO PRODUCTO TRASPASO
           IF (BDO-GLS-TCYA IN BDO-VARI  NOT = 'TR' AND                 
               BDO-GLS-TCYA IN BDO-VARI  NOT = 'PB')                    
               IF (CAN-MSC-CANC IN CAN = 'RTT')
                    GO TO FIN-BUS-OPC-VOP2
               ELSE
                    GO TO NXT-BUS-OPC-VOP2.                             

      *    CAN    PRODUCTO TRASPASO
           IF (BDO-GLS-TCYA IN BDO-VARI  = 'TR' OR                      
               BDO-GLS-TCYA IN BDO-VARI  = 'PB')                        
                PERFORM BUS-NEW-VOPC
                     GO TO NXT-BUS-OPC-VOP2.                            

       NXT-BUS-OPC-VOP2.                                                
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           MOVE ADR-BDO-REQA TO ADR-CAN-REQA.                           
           MOVE FIO-KDEF-S TO FIO-KDEF.                                 
           GO TO LUP-BUS-OPC-VOP2.

       FIN-BUS-OPC-VOP2.
           EXIT.
      *----------------------------------------------------------------
      *
      *----------------------------------------------------------------
      *AFRI-FIN/LOF/CHC/07-2009
