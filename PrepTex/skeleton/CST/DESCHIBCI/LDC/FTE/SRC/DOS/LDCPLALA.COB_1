       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      LDCPLALA.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    4-SEP-1995 11:15:32.

      * Programa Listador de Reporte ALA con Sort.
000000*COMPILED SITE 2000          07.12.98
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: 13/03/1998                                             *
      ******************************************************************
      *  NNV                                                           *
      *  MODIFICACION: CONVERTIR A 3.1                                 *
      *  FECHA: 20/08/1998                                             *
      ******************************************************************

      *<<<< CMT_ID
      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C05 IS SALTO5
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTALA         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTALA         ASSIGN TO        UT-S-RPTALA.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      ***** CRW-COMIENZO
      *    SELECT RPTALA         ASSIGN TO        UT-S-RPTALA.
           SELECT RPTALA         ASSIGN TO        RPTALA.
      ***** CRW-FINAL
      *<<<< IOS
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY LDCRRALA.
      *<<<< RR
      *>>>>
      ***** CRW-COMIENZO
      *FD  RPTALA LABEL RECORDS OMITTED
      *    RECORD CONTAINS 155 CHARACTERS.
      *01  GRC-LINEA-ALA     PIC X(155).
      *<<<< FD_RPT
      *>>>>
      *<<<< FLS
      *>>>>
       FD  RPTALA
           RECORD CONTAINS 155 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

CAMBIO*01  RPTALA-REG           PIC X(155).
CAMBIO 01  GRC-LINEA-ALA     PIC X(155).
      ***** CRW-FINAL

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SEL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY LDCBRSEL.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY LDCRWALA.
      *<<<< RW
      *>>>>
       COPY LDCRNALA.
       COPY LDCROALA.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY TABBRCOM.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABWGTVC.
       COPY TABBRCAM.

       COPY SGCBRDBC.
       COPY LDCBRPAG.
       COPY LDCBRRDC.
       COPY SGCBRRCD.
       COPY GNSWGCPT.
       COPY GNSWGMES.
       COPY GNSWGPES.

       01  WSS-VARI.
           03  WSS-NUM-NPAG             PIC 9(3).
           03  WSS-CIC-ICLF             PIC X(12) VALUE SPACES.
           03  WSS-NUM-ILDC             PIC 9(2) VALUE ZEROES.
           03  WSS-VAL-CMAX    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-IND-VIGE             PIC X(1) VALUE SPACES.
           03  WSS-MSC-STAT             PIC X(1) VALUE SPACES.
           03  WSS-FEC-FVEN.
               05  WSS-NUM-SVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-AVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-MVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-DVEN         PIC 9(2) VALUE ZEROES.
           03  WSS-FEC-FPRO.
               05  WSS-NUM-SPRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-APRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-MPRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-DPRO         PIC 9(2) VALUE ZEROES.
      *RVM-CST-INI 08.09.1995
      *VARIABLE DE RESPALDO PARA FECHA DE REGISTRO SRT
           03  WSS-RCD-AUX              PIC X(158) VALUE SPACES.
           03  SEL-FEC-FPRO.
               05  SEL-NUM-SPRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-APRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-MPRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-DPRO         PIC 9(2) VALUE ZEROES.
           03  WSS-COD-OFIC             PIC X(03) VALUE SPACES.
           03  WSS-COD-EJEC             PIC X(12) VALUE SPACES.
           03  WSS-NUM-CARTO            PIC 9(05) VALUE ZEROES.
      *RVM-CST-FIN 08.09.1995
           03  WSS-COD-PESO             PIC X(06) VALUE SPACES.
           03  WSS-COD-UF               PIC X(06) VALUE SPACES.

           03  WSS-SGV-CAPI    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-REAJ    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-INTE    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-VAL-IMPU    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-MUTI    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-MDIS    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-COD-LUGA.
               05 WSS-COD-COMU          PIC X(04).
               05 WSS-RED-PAIS  REDEFINES  WSS-COD-COMU.
                  07 WSS-IND-PAIS       PIC X(01).
                  07 WSS-COD-PAIS       PIC X(03).
           03  WSS-GLS-COMU             PIC X(20) VALUE SPACES.
           03  WSS-GLS-CIUD             PIC X(20) VALUE SPACES.
           03  WSS-GLS-PAIS             PIC X(20) VALUE SPACES.
           03  WSS-NUM-OPER             PIC 9(8) VALUE ZEROES.
           03  WSS-GLS-FPRO.
               05 WSS-MES               PIC X(10).
               05 WSS-FIL1              PIC X(1) VALUE SPACES.
               05 WSS-SIGLO             PIC X(2).
               05 WSS-ANNO              PIC X(2).
           03  WSS-DIV                  PIC 9(3).
           03  WSS-REST                  PIC 9(3).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.

      *>>>>

      * AQUI EXISTIA LABEL RF INI
      *<<<< RF
      *>>>>
      * AQUI EXISTIA LABEL RF FIN
      ***** CRW-COMIENZO
      *COPY LDCRTALA.
      *    09-AUG-95 12:20 PM     ,PAI=CHI ,CLI=BCI ,SOP=MVS4
       01  PH-ALA.
           03 PH-ALA-L1.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L2.
              05 RT-WSS-FO01
                 PIC X.
              05 FILLER PIC X(39)
              VALUE SPACES.
              05 RT-WSS-GLS-NOMC
                 PIC X(50).
              05 FILLER PIC X(13)
              VALUE SPACES.
              05 RT-SEL-COD-OFIC
                 PIC X(3).
           03 PH-ALA-L3.
              05 RT-WSS-FO02
                 PIC X.
              05 FILLER PIC X(39)
              VALUE SPACES.
              05 RT-WSS-GLS-DIRE
                 PIC X(40).
              05 FILLER PIC X(1)
              VALUE SPACES.
              05 RT-WSS-GLS-COMU
                 PIC X(15).
              05 RT-WSS-GLS-CIUD
                 PIC X(15).
           03 PH-ALA-L4.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L5.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L6.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L7.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L8.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L9.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L10.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L11.
              05 RT-WSS-FO03
                 PIC X.
              05 FILLER PIC X(111)
              VALUE SPACES.
              05 RT-RPT-ALA-PAGE-COUNTER
                 PIC ZZ.
              05 FILLER PIC X(1)
              VALUE '-'.
              05 RT-WSS-NUM-NPAG
                 PIC ZZ.
           03 PH-ALA-L12.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM ini  9-AUG-1995
           03 PH-ALA-L13.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L14.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L15.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM fin  9-AUG-1995
      *RVM-BCI-INI 06.11.1995
           03 PH-ALA-L15-2.
              05 FILLER PIC X(155)
              VALUE SPACES.
      *RVM-BCI-FIN 06.11.1995
           03 PH-ALA-L16.
              05 RT-WSS-FO04
                 PIC X.
              05 FILLER PIC X(40)
              VALUE SPACES.
      *RVM-CST-INI 20-SEP-1995
      *        05 RT-WSS-GLS-NOM2
      *           PIC X(50).
              05 RT-WSS-GLS-NOM2
                 PIC X(35).
              05 FILLER PIC X(15)
              VALUE SPACES.
      *RVM-CST-FIN 20-SEP-1995
              05 FILLER PIC X(02)
              VALUE SPACES.
              05 RT-SEL-CIC-ICLF
                 PIC X(12).
      * DPM ini
           03 PH-ALA-L17.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L18.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM fin
           03 PH-ALA-L19.
              05 RT-WSS-FO05
                 PIC X.
              05 FILLER PIC X(40)
              VALUE SPACES.
              05 RT-WSS-GLS-DIR2
                 PIC X(40).
              05 FILLER PIC X(12)
              VALUE SPACES.
              05 RT-WSS-GLS-OFIC
                 PIC X(25).

      * DPM ini
           03 PH-ALA-L20.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L21.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM fin

           03 PH-ALA-L22.
              05 RT-WSS-FO06
                 PIC X.
              05 FILLER PIC X(40)
              VALUE SPACES.
              05 RT-WSS-GLS-COM2
                 PIC X(15).
              05 FILLER PIC X(37)
              VALUE SPACES.
              05 RT-WSS-GLS-EJEC
                 PIC X(25).

      * DPM ini
           03 PH-ALA-L23.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM fin

           03 PH-ALA-L24.
              05 RT-WSS-FO07
                 PIC X.
              05 FILLER PIC X(40)
              VALUE SPACES.
              05 RT-WSS-GLS-CIU2
                 PIC X(15).
              05 FILLER PIC X(37)
              VALUE SPACES.
              05 RT-WSS-GLS-FONO
                 PIC X(10).

      * DPM ini
           03 PH-ALA-L25.
              05 FILLER PIC X(155)
              VALUE SPACES.
      * DPM fin

           03 PH-ALA-L26.
              05 RT-WSS-FO08
                 PIC X.
              05 FILLER PIC X(92)
              VALUE SPACES.
              05 RT-WSS-GLS-FPRO
                 PIC X(15).
           03 PH-ALA-L27.
              05 RT-WSS-GLS-AUX
                 PIC X
              VALUE SPACES.

      * DPM ini
           03 PH-ALA-L28.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L29.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L30.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L31.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L32.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L33.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 PH-ALA-L34.
              05 FILLER PIC X(155)
              VALUE SPACES.
      *RVM-BCI-INI 06.11.1995
      *    03 PH-ALA-L35.
      *       05 FILLER PIC X(155)
      *       VALUE SPACES.
      *RVM-BCI-FIN 06.11.1995
      * DPM fin

       01  DL-ALA.
           03 DL-ALA-L1.
              05 RT-WSS-FO09
                 PIC X.
              05 FILLER PIC X(2)
              VALUE SPACES.
              05 RT-SE1-NUM-DCOL
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-SE1-NUM-MCOL
                 PIC 9(2).
              05 FILLER PIC X(4)
              VALUE SPACES.
              05 RT-SE1-GLS-TIAV
                 PIC X(30).
              05 FILLER PIC X(20)
              VALUE SPACES.
              05 RT-SE1-VAL-CRED
                 PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
              05 FILLER PIC X(3)
              VALUE SPACES.
              05 RT-SE1-VAL-SCRE
                 PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
              05 FILLER PIC X(5)
              VALUE SPACES.
              05 RT-SE1-GLS-MONE
                 PIC X(5).
              05 FILLER PIC X(06)
              VALUE SPACES.
              05 RT-SE1-VAL-SFIN
                 PIC ZZ.ZZZ.ZZZ.ZZZ,ZZZZ.
              05 FILLER PIC X(03)
              VALUE SPACES.
              05 RT-SE1-NUM-DVEN
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-SE1-NUM-MVEN
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-SE1-NUM-SVEN
                 PIC 9(2).
              05 RT-SE1-NUM-AVEN
                 PIC 9(2).
              05 FILLER PIC X(01)
              VALUE SPACES.
              05 RT-SE1-IND-SCTB
                 PIC X(3).
           03 DL-ALA-L2.
              05 FILLER PIC X(64)
              VALUE SPACES.
              05 RT-SEL-CIC-ICLF
                 PIC X(12).
       01  CF-ALA-SEL-CIC-ICLF.
           03 CF-ALA-SEL-CIC-ICLF-L1.
              05 FILLER PIC X(155)
              VALUE SPACES.
      *RVM-BCI-INI 06.11.1995
           03 CF-ALA-SEL-CIC-ICLF-L1-2.
              05 FILLER PIC X(155)
              VALUE SPACES.
      *RVM-BCI-FIN 06.11.1995
           03 CF-ALA-SEL-CIC-ICLF-L2.
              05 RT-WSS-FO10
                 PIC X.
              05 FILLER PIC X(2)
              VALUE SPACES.
              05 RT-WSS-NUM-DPRO
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-WSS-NUM-MPRO
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-WSS-NUM-SPRO
                 PIC 9(2).
              05 RT-WSS-NUM-APRO
                 PIC 9(2).
              05 FILLER PIC X(18)
              VALUE SPACES.
              05 FILLER PIC X(01)
              VALUE '$'.
              05 FILLER PIC X(09)
              VALUE SPACES.
              05 RT-WSS-SGV-CAPI
                 PIC ZZ.ZZZ.ZZZ.ZZ9.
              05 FILLER PIC X(13)
              VALUE SPACES.
              05 RT-WSS-SGV-REAJ
                 PIC ZZ.ZZZ.ZZZ.ZZ9.
              05 FILLER PIC X(13)
              VALUE SPACES.
              05 RT-WSS-SGV-INTE
                 PIC ZZ.ZZZ.ZZZ.ZZ9.
              05 FILLER PIC X(13)
              VALUE SPACES.
              05 RT-WSS-VAL-IMPU
                 PIC ZZ.ZZZ.ZZZ.ZZ9.
           03 CF-ALA-SEL-CIC-ICLF-L3.
              05 FILLER PIC X(155)
              VALUE SPACES.
           03 CF-ALA-SEL-CIC-ICLF-L4.
              05 RT-WSS-FO11
                 PIC X.
              05 FILLER PIC X(20)
              VALUE SPACES.
              05 RT-WSS-VAL-CMAX
                 PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
              05 FILLER PIC X(16)
              VALUE SPACES.
              05 RT-WSS-SGV-MUTI
                 PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
              05 FILLER PIC X(17)
              VALUE SPACES.
              05 RT-WSS-SGV-MDIS
                 PIC ---.---.---.--9,9999.
              05 FILLER PIC X(16)
              VALUE SPACES.
              05 RT-WSS-NUM-DVEN
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-WSS-NUM-MVEN
                 PIC 9(2).
              05 FILLER
                 PIC X(1)
                 VALUE ALL '-'.
              05 RT-WSS-NUM-SVEN
                 PIC 9(2).
              05 RT-WSS-NUM-AVEN
                 PIC 9(2).
       01  CF-ALA-SEL-COD-OFIC.
           03 CF-ALA-SEL-COD-OFIC-L1.
              05 FILLER PIC X(155)
              VALUE SPACES.
       01  CF-ALA-WSS-GLS-COMU.
           03 CF-ALA-WSS-GLS-COMU-L1.
              05 FILLER PIC X(155)
              VALUE SPACES.
       01  CF-ALA-WSS-GLS-DIRE.
           03 CF-ALA-WSS-GLS-DIRE-L1.
              05 FILLER PIC X(155)
              VALUE SPACES.
      ***** CRW-FINAL
      *<<<< RT
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      *<<<< FIN_DEC
      *>>>>
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
      *    MOVE 'LDC' TO RPT-SIST.
           MOVE 'LDCPLALA' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           PERFORM OBT-COD-MNAC.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.

           PERFORM OBT-COD-UF.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.
      *>>>>
           SORT GNSSRT
       COPY LDCRSALA.
      *<<<< RS
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *RVM-CST-INI 14-NOV-1995
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS LDCPLALA'.
           DISPLAY '---------------------'.
           DISPLAY 'CARTOLAS EMITIDAS       : '
                  WSS-NUM-CARTO IN WSS-VARI.
           DISPLAY '---------------------'.
           DISPLAY ' '.
      *RVM-CST-FIN 14-NOV-1995
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
      *>>>>
      *    READY TRACE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCSEL FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO TABUSR FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO TABOFI FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *TABCAM
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: AL ABRIR ARCHIVO TABCAM '
               DISPLAY 'DE INPUT :  '    FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO SGCRCD FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCRDC FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

RMV   *    MOVE FIO-UPD TO FIO-CMND.
RMV        MOVE FIO-OUT TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCPAG FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO SGCDBC FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GNS' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO GNSTAB FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           DISPLAY 'APERTURA ARCHIVOS ANEXOS OK'.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
      *RVM-CST-INI 08.09.1995
           IF FIO-STAT-OKS
               MOVE SEL-FEC-FPRO IN SEL TO SEL-FEC-FPRO IN WSS-VARI.
      *RVM-CST-FIN 08.09.1995
      *<<<< FIN_FST_INP
           PERFORM RESETEAR-SRT.
           IF (FIO-STAT-OKS AND SEL-IND-TREG IN SEL = '1')
             ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
             PERFORM MOVER-SEL-WSS
             MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI

             MOVE MES-DMES(SEL-NUM-MPRO IN SEL) TO WSS-MES IN WSS-VARI
             MOVE SEL-NUM-SPRO IN SEL TO WSS-SIGLO IN WSS-VARI
             MOVE SEL-NUM-APRO IN SEL TO WSS-ANNO IN WSS-VARI
             MOVE WSS-MES IN WSS-VARI TO CPT-STRN
             PERFORM CPT-BLKS
             MOVE CPT-STRN TO WSS-MES IN WSS-VARI
             MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
      *     DISPLAY 'CLF Y OFI SEL : ' SEL-CIC-ICLF IN SEL ' '
      *                            SEL-COD-OFIC IN SEL.
      *
      *RVM-CST-INI 8-SEP-1995
      *     IF SEL-IND-TREG IN SEL = '1'
      *         MOVE SEL-COD-OFIC IN SEL TO SEL-COD-OFIC IN SRT
      *         MOVE SEL-COD-EJEC IN SEL TO SEL-COD-EJEC IN SRT
      *         PERFORM BUSCA-EJEC.
      *RVM-CST-FIN 8-SEP-1995

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL = WSS-CIC-ICLF IN WSS-VARI AND
               SEL-NUM-ILDC IN SEL NOT = WSS-NUM-ILDC IN WSS-VARI)

             ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
             PERFORM MOVER-SEL-WSS
             GO TO NXT-INP-SRT.

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL NOT = WSS-CIC-ICLF IN WSS-VARI)
      *RVM-CST-INI 14-NOV-1995
      *PARA SABER CUANTAS CARTOLAS DEBEN SERAN IMPRESAS
             ADD 1 TO WSS-NUM-CARTO IN WSS-VARI
      *RVM-CST-FIN 14-NOV-1995
             IF WSS-NUM-OPER IN WSS-VARI = 0
               PERFORM RESETEAR-SRT
      *RVM-CST-INI 22-SEP-1995
               MOVE WSS-COD-OFIC IN WSS-VARI TO SEL-COD-OFIC IN SRT
               MOVE WSS-COD-EJEC IN WSS-VARI TO SEL-COD-EJEC IN SRT
               PERFORM BUSCA-EJEC
      *RVM-CST-FIN 22-SEP-1995
               MOVE WSS-CIC-ICLF IN WSS-VARI TO SEL-CIC-ICLF IN SRT
               MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN SRT
               MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN SRT
               MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN SRT
               MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN SRT
               MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT
      * Se ingresan datos del cliente, ejecutivo y oficina a SRT
      *RVM-CST-INI 8-SEP-1995
      *         MOVE SEL-COD-OFIC IN SEL TO SEL-COD-OFIC IN SRT
      *         MOVE SEL-COD-EJEC IN SEL TO SEL-COD-EJEC IN SRT
      *         PERFORM BUSCA-EJEC
      *RVM-CST-FIN 8-SEP-1995
               MOVE WSS-CIC-ICLF IN WSS-VARI TO RDC-CIC-ICLF IN RDC
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM LDC-FIO-RDC
               IF (FIO-STAT-OKS AND
                    WSS-CIC-ICLF IN WSS-VARI = RDC-CIC-ICLF IN RDC)
                 MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM SGC-FIO-DBC
                 IF FIO-STAT-OKS
      * DPM ini  1-AUG-1995
      *             MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                   MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOM2 IN SRT
      * DPM fin  1-AUG-1995
      *RVM         MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN SRT
                   PERFORM BUSCA-COMU
      *RVM         PERFORM BUSCA-EJEC
                 ELSE
                   MOVE SPACES TO WSS-GLS-NOMC IN SRT
                   MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM         MOVE SPACES TO DBC-COD-OFIC IN SRT
                   MOVE SPACES TO WSS-GLS-DIRE IN SRT
                   MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                   MOVE SPACES TO WSS-GLS-COMU IN SRT
                   MOVE SPACES TO WSS-GLS-COM2 IN SRT
                   MOVE SPACES TO WSS-GLS-CIUD IN SRT
                   MOVE SPACES TO WSS-GLS-CIU2 IN SRT
               ELSE
                 MOVE SPACES TO WSS-GLS-NOMC IN SRT
                 MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE SPACES TO DBC-COD-OFIC IN SRT
                 MOVE SPACES TO WSS-GLS-DIRE IN SRT
                 MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                 MOVE SPACES TO WSS-GLS-COMU IN SRT
                 MOVE SPACES TO WSS-GLS-COM2 IN SRT
                 MOVE SPACES TO WSS-GLS-CIUD IN SRT
                 MOVE SPACES TO WSS-GLS-CIU2 IN SRT.

      *RVM
      *     DISPLAY 'SEL-IND-TREG : ' SEL-IND-TREG IN SEL
      *     DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SEL
      *     DISPLAY 'WSS-CIC-ICLF : ' WSS-CIC-ICLF IN WSS-VARI
      *     DISPLAY 'WSS-NUM-OPER : ' WSS-NUM-OPER IN WSS-VARI

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL NOT = WSS-CIC-ICLF IN WSS-VARI)
             IF WSS-NUM-OPER IN WSS-VARI = 0
      *RVM
      *         DISPLAY 'CLF Y OFI SRT1 : ' SEL-CIC-ICLF IN SRT
      *                               SEL-COD-OFIC IN SRT
      *RVM
               RELEASE SRT
               PERFORM GRABAR-NUM-PAG
               PERFORM MOVER-SEL-WSS
               MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI
      *DPM INI  26-APR-1996
               MOVE ZEROES TO WSS-VAL-IMPU IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-CAPI IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-REAJ IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-INTE IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
      *DPM FIN  26-APR-1996
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
               ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
               GO TO NXT-INP-SRT
             ELSE
             IF WSS-NUM-OPER IN WSS-VARI > 0
               PERFORM GRABAR-NUM-PAG
               MOVE ZEROES TO WSS-VAL-IMPU IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-CAPI IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-REAJ IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-INTE IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
               MOVE ZEROES TO WSS-NUM-OPER IN WSS-VARI
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
               PERFORM MOVER-SEL-WSS
               MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI
               ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
               GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '2'
             MOVE SEL TO SE3
             ADD SE3-VAL-IMPU IN SE3 TO WSS-VAL-IMPU IN WSS-VARI
             GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '3'
             MOVE SEL TO SE2
             ADD SE2-SGV-CAPI IN SE2 TO WSS-SGV-CAPI IN WSS-VARI
             ADD SE2-SGV-REAJ IN SE2 TO WSS-SGV-REAJ IN WSS-VARI
             ADD SE2-SGV-INTE IN SE2 TO WSS-SGV-INTE IN WSS-VARI
             GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '4'
             MOVE SEL TO SE1
      *RVM-CST-INI 09.09.1995
      *      ADD SE1-VAL-SCRE IN SE1 TO WSS-SGV-MUTI IN WSS-VARI
             PERFORM CAL-SGV-MUTI
      *RVM-CST-FIN 09.09.1995
             PERFORM GRABAR-SEL-SRT

      * Se ingresan datos del cliente, ejecutivo y oficina a SRT
             MOVE WSS-CIC-ICLF IN WSS-VARI TO RDC-CIC-ICLF IN RDC
             MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
             MOVE FIO-GET-NLS TO FIO-CMND
             PERFORM LDC-FIO-RDC
             IF (FIO-STAT-OKS AND
                  WSS-CIC-ICLF IN WSS-VARI = RDC-CIC-ICLF IN RDC)
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
      * DPM ini  1-AUG-1995
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
      * DPM fin  1-AUG-1995
                 MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                 MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN SRT
                 PERFORM BUSCA-COMU
      *RVM       PERFORM BUSCA-EJEC
               ELSE
                 MOVE SPACES TO WSS-GLS-NOMC IN SRT
                 MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE SPACES TO DBC-COD-OFIC IN SRT
                 MOVE SPACES TO WSS-GLS-DIRE IN SRT
                 MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                 MOVE SPACES TO WSS-GLS-COMU IN SRT
                 MOVE SPACES TO WSS-GLS-COM2 IN SRT
                 MOVE SPACES TO WSS-GLS-CIUD IN SRT
                 MOVE SPACES TO WSS-GLS-CIU2 IN SRT
             ELSE
               MOVE SPACES TO WSS-GLS-NOMC IN SRT
               MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM     MOVE SPACES TO DBC-COD-OFIC IN SRT
               MOVE SPACES TO WSS-GLS-DIRE IN SRT
               MOVE SPACES TO WSS-GLS-DIR2 IN SRT
               MOVE SPACES TO WSS-GLS-COMU IN SRT
               MOVE SPACES TO WSS-GLS-COM2 IN SRT
               MOVE SPACES TO WSS-GLS-CIUD IN SRT
               MOVE SPACES TO WSS-GLS-CIU2 IN SRT.

           IF SEL-IND-TREG IN SEL = '4'
             RELEASE SRT.
           GO TO NXT-INP-SRT.
      *>>>>
       MOV-INP-SRT.
       COPY LDCRMALA.
      *<<<< RM
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
      *RVM-CST-INI 08.09.1995
           IF FIO-STAT-OKS
               MOVE SEL-FEC-FPRO IN SEL TO SEL-FEC-FPRO IN WSS-VARI.
      *RVM-CST-FIN 08.09.1995
      *    DISPLAY 'LEO SEL : ' FIO-STAT.
      *    DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SEL.
      *    DISPLAY 'SEL-NUM-ILDC : ' SEL-NUM-ILDC IN SEL.
      *    DISPLAY 'SEL-FEC-FPRO : ' SEL-FEC-FPRO IN SEL.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
           PERFORM GRABAR-NUM-PAG.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-SEL.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      *>>>>
           OPEN OUTPUT RPTALA.
      *     MOVE 'LDCPLALA' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           PERFORM INITIATE-RPTALA.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.

RMV        MOVE FIO-CLO TO FIO-CMND.
RMV        PERFORM LDC-FIO-PAG.
RMV        MOVE FIO-INP TO FIO-CMND.
RMV        PERFORM LDC-FIO-PAG.
RMV        IF NOT FIO-STAT-OKS
RMV           DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCPAG FIO-STAT '
RMV                    FIO-STAT
RMV            MOVE PGM-SMAL TO PGM-STAT-SRT
RMV            GO TO FIN-OUT-SRT.

           MOVE SRT TO SRT-OLD-ALA.
           MOVE SRT TO SRT-CUR-ALA.
      *RVM
      *     DISPLAY '1 BUSCA-OFIC'.
      *     DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SRT.
      *     DISPLAY 'SEL-COD-OFIC : ' SEL-COD-OFIC IN SRT.
      *RVM
           PERFORM BUSCA-OFIC.
           MOVE SEL-CIC-ICLF IN SRT TO PAG-CIC-ICLF IN PAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF FIO-STAT-OKS
             MOVE PAG-VAL-CMAX IN PAG TO WSS-VAL-CMAX IN WSS-VARI
             MOVE PAG-NUM-SVEN IN PAG TO WSS-NUM-SVEN IN WSS-VARI
             MOVE PAG-NUM-AVEN IN PAG TO WSS-NUM-AVEN IN WSS-VARI
             MOVE PAG-NUM-MVEN IN PAG TO WSS-NUM-MVEN IN WSS-VARI
             MOVE PAG-NUM-DVEN IN PAG TO WSS-NUM-DVEN IN WSS-VARI
             MOVE PAG-VAL-IMPU IN PAG TO WSS-VAL-IMPU IN WSS-VARI
             MOVE PAG-SGV-CAPI IN PAG TO WSS-SGV-CAPI IN WSS-VARI
             MOVE PAG-SGV-REAJ IN PAG TO WSS-SGV-REAJ IN WSS-VARI
             MOVE PAG-SGV-INTE IN PAG TO WSS-SGV-INTE IN WSS-VARI
             MOVE PAG-SGV-MUTI IN PAG TO WSS-SGV-MUTI IN WSS-VARI
             MOVE PAG-SGV-MDIS IN PAG TO WSS-SGV-MDIS IN WSS-VARI
      *       MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-VARI.
             MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-ALA.
           PERFORM ALA-FST-PRO-CTL.
      *<<<< FST_OUT
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           MOVE SEL-CIC-ICLF IN SRT TO PAG-CIC-ICLF IN PAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF FIO-STAT-OKS
             MOVE PAG-VAL-CMAX IN PAG TO WSS-VAL-CMAX IN WSS-VARI
             MOVE PAG-NUM-SVEN IN PAG TO WSS-NUM-SVEN IN WSS-VARI
             MOVE PAG-NUM-AVEN IN PAG TO WSS-NUM-AVEN IN WSS-VARI
             MOVE PAG-NUM-MVEN IN PAG TO WSS-NUM-MVEN IN WSS-VARI
             MOVE PAG-NUM-DVEN IN PAG TO WSS-NUM-DVEN IN WSS-VARI
             MOVE PAG-VAL-IMPU IN PAG TO WSS-VAL-IMPU IN WSS-VARI
             MOVE PAG-SGV-CAPI IN PAG TO WSS-SGV-CAPI IN WSS-VARI
             MOVE PAG-SGV-REAJ IN PAG TO WSS-SGV-REAJ IN WSS-VARI
             MOVE PAG-SGV-INTE IN PAG TO WSS-SGV-INTE IN WSS-VARI
             MOVE PAG-SGV-MUTI IN PAG TO WSS-SGV-MUTI IN WSS-VARI
             MOVE PAG-SGV-MDIS IN PAG TO WSS-SGV-MDIS IN WSS-VARI
      *       MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-VARI.
             MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-ALA
           ELSE
             DISPLAY 'ERROR DE LECTURA PAG PARA LLAVE '
                      PAG-CIC-ICLF IN PAG.
      *

      *>>>>
       GEN-OUT-SRT.
           PERFORM ALA-CLR-VAR-CTL.
           PERFORM ALA-CHK-VAR-CTL.
           MOVE SRT TO SRT-CUR-ALA.
           MOVE SRT-OLD-ALA TO SRT.
           PERFORM ALA-PRO-VAR-CTL-CF.
           MOVE SRT-CUR-ALA TO SRT.
           PERFORM ALA-PRO-VAR-CTL-CH.
           PERFORM ALA-PRO-DET-LIN.
      *<<<< FIN_GEN_OUT
           PERFORM MOVER-WSS-ALA.
      *>>>>
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-ALA.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           PERFORM MOVER-WSS-ALA.
      *     GENERATE DL-ALA.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
      *>>>>
           PERFORM TERMINATE-RPTALA.
      *<<<< FIN_TMT
      *>>>>
           CLOSE RPTALA.
       EXT-OUT-SRT.
           EXIT.
       COPY LDCBFSEL.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
      ***** CRW-COMIENZO
      *COPY LDCREALA.
      *    09-AUG-95 05:51 PM     ,PAI=CHI ,CLI=BCI ,SOP=MVS
       WRT-SEC-PH-ALA SECTION.
       I-WRT-SEC-PH-ALA.
           MOVE PH-ALA-L1 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L2 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L3 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L4 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L5 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L6 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L7 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L8 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L9 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L10 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L11 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L12 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      * DPM ini  8-AUG-1995
           MOVE PH-ALA-L13 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L14 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM-BCI-INI 06.11.1995
           MOVE PH-ALA-L15-2 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM-BCI-FIN 06.11.1995
           MOVE PH-ALA-L16 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L17 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L18 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM
           MOVE PH-ALA-L15 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM
           MOVE PH-ALA-L19 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L21 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L22 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L23 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L24 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L25 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L26 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM
           MOVE PH-ALA-L20 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM
           MOVE PH-ALA-L27 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L28 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L29 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L30 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L31 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L32 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L33 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE PH-ALA-L34 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM-BCI-INI 06.11.1995
      *    MOVE PH-ALA-L35 TO GRC-LINEA-ALA.
      *    PERFORM ALA-WRT-LIN-REP.
      *RVM-BCI-FIN 06.11.1995
      * DPM fin  8-AUG-1995

       F-WRT-SEC-PH-ALA.
           EXIT.

       WRT-SEC-DL-ALA SECTION.
       I-WRT-SEC-DL-ALA.
           MOVE DL-ALA-L1 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE DL-ALA-L2 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
       F-WRT-SEC-DL-ALA.
           EXIT.

       WRT-SEC-CF-ALA-SEL-CIC-ICLF SECTION.
       I-WRT-SEC-CF-ALA-SEL-CIC-ICLF.
      *RVM-BCI-INI 06.11.1995
      *     MOVE CF-ALA-SEL-CIC-ICLF-L1 TO GRC-LINEA-ALA.
      **RVM PERFORM ALA-WRT-LIN-REP.
      *     PERFORM ALA-WRT-LIN-REP-C05.
           MOVE CF-ALA-SEL-CIC-ICLF-L1 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP-C05.
           MOVE CF-ALA-SEL-CIC-ICLF-L1-2 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
      *RVM-BCI-FIN 06.11.1995
           MOVE CF-ALA-SEL-CIC-ICLF-L2 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           MOVE CF-ALA-SEL-CIC-ICLF-L3 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
           PERFORM ALA-WRT-LIN-REP.
           PERFORM ALA-WRT-LIN-REP.
           PERFORM ALA-WRT-LIN-REP.
           MOVE CF-ALA-SEL-CIC-ICLF-L4 TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-LIN-REP.
       F-WRT-SEC-CF-ALA-SEL-CIC-ICLF.
           EXIT.

      *RVM-CST-INI 14.05.1995
       ALA-WRT-LIN-REP-C05 SECTION.
       I-ALA-WRT-LIN-REP-C05.
           WRITE GRC-LINEA-ALA AFTER SALTO5.
           ADD 1 TO RPT-ALA-LINE-COUNTER.
       F-ALA-WRT-LIN-REP-C05.
           EXIT.
      *RVM-CST-FIN 14.05.1995

       WRT-SEC-CF-ALA-SEL-COD-OFIC SECTION.
       I-WRT-SEC-CF-ALA-SEL-COD-OFIC.
       F-WRT-SEC-CF-ALA-SEL-COD-OFIC.
           EXIT.

       WRT-SEC-CF-ALA-WSS-GLS-COMU SECTION.
       I-WRT-SEC-CF-ALA-WSS-GLS-COMU.
       F-WRT-SEC-CF-ALA-WSS-GLS-COMU.
           EXIT.

       WRT-SEC-CF-ALA-WSS-GLS-DIRE SECTION.
       I-WRT-SEC-CF-ALA-WSS-GLS-DIRE.
       F-WRT-SEC-CF-ALA-WSS-GLS-DIRE.
           EXIT.

       ALA-CLR-VAR-CTL SECTION.
       I-ALA-CLR-VAR-CTL.
           MOVE 'N' TO WSS-CTL-SEL-COD-OFIC IN WSS-CTL-ALA.
           MOVE 'N' TO WSS-CTL-WSS-GLS-COMU IN WSS-CTL-ALA.
           MOVE 'N' TO WSS-CTL-WSS-GLS-DIRE IN WSS-CTL-ALA.
           MOVE 'N' TO WSS-CTL-SEL-CIC-ICLF IN WSS-CTL-ALA.
           MOVE 'N' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA.
           MOVE 'N' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
       F-ALA-CLR-VAR-CTL.
           EXIT.

       ALA-FST-PRO-CTL SECTION.
       I-ALA-FST-PRO-CTL.
           PERFORM D-PH-ALA.
           PERFORM M-PH-ALA.
           PERFORM WRT-SEC-PH-ALA.
       F-ALA-FST-PRO-CTL.
           EXIT.

       ALA-PRO-RLL-TAM-CF SECTION.
       I-ALA-PRO-RLL-TAM-CF.
           PERFORM ALA-CLR-SEM-NWP.
           PERFORM ALA-CLR-CTL-SIZ.
           PERFORM ALA-SUM-SIZ-CTL-CF.
           PERFORM ALA-CHK-SIZ-DIS.
           PERFORM ALA-SET-SMF-NWP-CF.
           IF WSS-NO-CABE = 'S'
              PERFORM ALA-WRT-RLL-YPH.
       F-ALA-PRO-RLL-TAM-CF.
           EXIT.

       ALA-WRT-RLL-YPH SECTION.
       I-ALA-WRT-RLL-YPH.
           MOVE SPACES TO GRC-LINEA-ALA.
           PERFORM ALA-WRT-RLL-NWP.
           MOVE  ZEROES TO RPT-ALA-LINE-COUNTER.
           ADD 1 TO RPT-ALA-PAGE-COUNTER IN RPT-VARI-ALA.
           PERFORM D-PH-ALA.
           PERFORM M-PH-ALA.
           PERFORM WRT-SEC-PH-ALA.
           MOVE 'N' TO WSS-SEM-NP IN WSS-SEM-ALA.
       F-ALA-WRT-RLL-YPH.
           EXIT.

       INITIATE-RPTALA SECTION.
       I-INITIATE-RPTALA.
      *RVM-CST-INI 14.08.1994
      *    MOVE 115 TO RPT-ALA-PAGE-LIMIT.
           MOVE 102 TO RPT-ALA-PAGE-LIMIT.
      *RVM-CST-FIN 14.08.1994
       F-INITIATE-RPTALA.
           EXIT.

       TERMINATE-RPTALA SECTION.
       I-TERMINATE-RPTALA.
           PERFORM D-CF-ALA-SEL-COD-OFIC.
           PERFORM D-CF-ALA-WSS-GLS-COMU.
           PERFORM D-CF-ALA-WSS-GLS-DIRE.
           PERFORM D-CF-ALA-SEL-CIC-ICLF.
           PERFORM M-CF-ALA-SEL-COD-OFIC.
           PERFORM WRT-SEC-CF-ALA-SEL-COD-OFIC.
           PERFORM M-CF-ALA-WSS-GLS-COMU.
           PERFORM WRT-SEC-CF-ALA-WSS-GLS-COMU.
           PERFORM M-CF-ALA-WSS-GLS-DIRE.
           PERFORM WRT-SEC-CF-ALA-WSS-GLS-DIRE.
           PERFORM M-CF-ALA-SEL-CIC-ICLF.
           PERFORM WRT-SEC-CF-ALA-SEL-CIC-ICLF.
       F-TERMINATE-RPTALA.
           EXIT.

       ALA-WRT-LIN-REP SECTION.
       I-ALA-WRT-LIN-REP.
           WRITE GRC-LINEA-ALA.
           ADD 1 TO RPT-ALA-LINE-COUNTER.
       F-ALA-WRT-LIN-REP.
           EXIT.

       ALA-WRT-RLL-NWP SECTION.
       I-ALA-WRT-RLL-NWP.
           WRITE GRC-LINEA-ALA AFTER PAGE.
           ADD 1 TO RPT-ALA-LINE-COUNTER.
       F-ALA-WRT-RLL-NWP.
           EXIT.

       ALA-CHK-VAR-CTL SECTION.
       I-ALA-CHK-VAR-CTL.
           IF SEL-COD-OFIC     IN SRT NOT =
              SEL-COD-OFIC-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-SEL-COD-OFIC IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-WSS-GLS-COMU IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-WSS-GLS-DIRE IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SEL-CIC-ICLF IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
           IF WSS-GLS-COMU     IN SRT NOT =
              WSS-GLS-COMU-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-WSS-GLS-COMU IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-WSS-GLS-DIRE IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SEL-CIC-ICLF IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
           IF WSS-GLS-DIRE     IN SRT NOT =
              WSS-GLS-DIRE-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-WSS-GLS-DIRE IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SEL-CIC-ICLF IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
           IF SEL-CIC-ICLF     IN SRT NOT =
              SEL-CIC-ICLF-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-SEL-CIC-ICLF IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
           IF SE1-NUM-MCOL     IN SRT NOT =
              SE1-NUM-MCOL-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-MCOL IN WSS-CTL-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
           IF SE1-NUM-DCOL     IN SRT NOT =
              SE1-NUM-DCOL-OLD IN SRT-OLD-ALA
                 MOVE 'S' TO WSS-CTL-SE1-NUM-DCOL IN WSS-CTL-ALA.
       F-ALA-CHK-VAR-CTL.
           EXIT.

       ALA-SET-NWP-DIB-CH SECTION.
       I-ALA-SET-NWP-DIB-CH.
       F-ALA-SET-NWP-DIB-CH.
           EXIT.



       ALA-SET-SMF-NWP-CF SECTION.
       I-ALA-SET-SMF-NWP-CF.
           IF SI-CTL-SEL-COD-OFIC AND SI-NP-CF-SEL-COD-OFIC
               MOVE 'S' TO WSS-SEM-NP IN WSS-SEM-ALA.
           IF SI-CTL-WSS-GLS-COMU AND SI-NP-CF-WSS-GLS-COMU
               MOVE 'S' TO WSS-SEM-NP IN WSS-SEM-ALA.
           IF SI-CTL-WSS-GLS-DIRE AND SI-NP-CF-WSS-GLS-DIRE
               MOVE 'S' TO WSS-SEM-NP IN WSS-SEM-ALA.
           IF SI-CTL-SEL-CIC-ICLF AND SI-NP-CF-SEL-CIC-ICLF
               MOVE 'S' TO WSS-SEM-NP IN WSS-SEM-ALA.
       F-ALA-SET-SMF-NWP-CF.
           EXIT.


       ALA-CHK-SIZ-DL SECTION.
       I-ALA-CHK-SIZ-DL.
           COMPUTE RPT-ALA-TOT-LDIS =
                RPT-ALA-PAGE-LIMIT - RPT-ALA-LINE-COUNTER.
           IF RPT-ALA-TOT-LDIS < WSS-SIZ-DL-ALA
               MOVE 'S' TO WSS-NO-CABE IN WSS-NCAE-ALA.
       F-ALA-CHK-SIZ-DL.
           EXIT.


       ALA-PRO-DET-LIN SECTION.
       I-ALA-PRO-DET-LIN.
           PERFORM ALA-CHK-SIZ-DL.
           IF SI-SEM-NP OR SI-NO-CABE
              PERFORM ALA-WRT-RLL-YPH.
           PERFORM D-DL-ALA.
           PERFORM M-DL-ALA.
           PERFORM WRT-SEC-DL-ALA.
       F-ALA-PRO-DET-LIN.
           EXIT.


       ALA-CLR-CTL-SIZ SECTION.
       I-ALA-CLR-CTL-SIZ.
           MOVE 'N' TO WSS-NO-CABE IN WSS-NCAE-ALA.
           MOVE ZEROES TO RPT-ALA-TOT-LCTL.
       F-ALA-CLR-CTL-SIZ.
           EXIT.


       ALA-CLR-SEM-NWP SECTION.
       I-ALA-CLR-SEM-NWP.
           MOVE 'N' TO WSS-SEM-NP IN WSS-SEM-ALA.
       F-ALA-CLR-SEM-NWP.
           EXIT.


       ALA-PRO-VAR-CTL-CF SECTION.
       I-ALA-PRO-VAR-CTL-CF.
           PERFORM ALA-PRO-RLL-TAM-CF.
           IF SI-CTL-SEL-CIC-ICLF
              PERFORM D-CF-ALA-SEL-CIC-ICLF
              PERFORM M-CF-ALA-SEL-CIC-ICLF
      *DPM INI  25-ABR-1996
      *       PERFORM WRT-SEC-CF-ALA-SEL-CIC-ICLF.
              PERFORM WRT-SEC-CF-ALA-SEL-CIC-ICLF
              PERFORM LIMPIA-WSS-ALA.
      *DPM FIN  25-ABR-1996
           IF SI-CTL-WSS-GLS-DIRE
              PERFORM D-CF-ALA-WSS-GLS-DIRE.
           IF SI-CTL-WSS-GLS-COMU
              PERFORM D-CF-ALA-WSS-GLS-COMU.
           IF SI-CTL-SEL-COD-OFIC
              PERFORM D-CF-ALA-SEL-COD-OFIC.
       F-ALA-PRO-VAR-CTL-CF.
           EXIT.

      *DPM INI  25-ABR-1996
       LIMPIA-WSS-ALA SECTION.
       INI-LIMPIA-WSS-ALA.
           MOVE ZEROES TO WSS-VAL-IMPU IN WSS-ALA.
           MOVE ZEROES TO WSS-SGV-CAPI IN WSS-ALA.
           MOVE ZEROES TO WSS-SGV-REAJ IN WSS-ALA.
           MOVE ZEROES TO WSS-SGV-INTE IN WSS-ALA.
       FIN-LIMPIA-WSS-ALA.
           EXIT.
      *DPM FIN  25-ABR-1996

       ALA-SUM-SIZ-CTL-CF SECTION.
       I-ALA-SUM-SIZ-CTL-CF.
           IF SI-CTL-SEL-CIC-ICLF
              ADD WSS-SIZ-CF-ALA-SEL-CIC-ICLF TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-WSS-GLS-DIRE TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-WSS-GLS-COMU TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-SEL-COD-OFIC TO RPT-ALA-TOT-LCTL
              GO TO F-ALA-SUM-SIZ-CTL-CF.
           IF SI-CTL-WSS-GLS-DIRE
              ADD WSS-SIZ-CF-ALA-WSS-GLS-DIRE TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-WSS-GLS-COMU TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-SEL-COD-OFIC TO RPT-ALA-TOT-LCTL
              GO TO F-ALA-SUM-SIZ-CTL-CF.
           IF SI-CTL-WSS-GLS-COMU
              ADD WSS-SIZ-CF-ALA-WSS-GLS-COMU TO RPT-ALA-TOT-LCTL
              ADD WSS-SIZ-CF-ALA-SEL-COD-OFIC TO RPT-ALA-TOT-LCTL
              GO TO F-ALA-SUM-SIZ-CTL-CF.
           IF SI-CTL-SEL-COD-OFIC
              ADD WSS-SIZ-CF-ALA-SEL-COD-OFIC TO RPT-ALA-TOT-LCTL
              GO TO F-ALA-SUM-SIZ-CTL-CF.
       F-ALA-SUM-SIZ-CTL-CF.
           EXIT.

       ALA-SUM-SIZ-CTL-CH SECTION.
       I-ALA-SUM-SIZ-CTL-CH.
       F-ALA-SUM-SIZ-CTL-CH.
           EXIT.

       ALA-PRO-RLL-NWP-CH SECTION.
       I-ALA-PRO-RLL-NWP-CH.
           IF SI-SEM-NP
              GO TO CAM-PAG.
           PERFORM ALA-CLR-SEM-NWP.
           PERFORM ALA-SUM-SIZ-CTL-CH.
           PERFORM ALA-CHK-SIZ-DIS.
           IF SI-SEM-NP
              GO TO CAM-PAG.
           PERFORM ALA-SET-NWP-DIB-CH.
           IF SI-SEM-NP
              GO TO CAM-PAG.
       CAM-PAG.
       F-ALA-PRO-RLL-NWP-CH.
           EXIT.

       ALA-CHK-SIZ-DIS SECTION.
       I-ALA-CHK-SIZ-DIS.
           COMPUTE RPT-ALA-TOT-LDIS =
               RPT-ALA-PAGE-LIMIT - RPT-ALA-LINE-COUNTER.
           IF RPT-ALA-TOT-LDIS < RPT-ALA-TOT-LCTL
               MOVE 'S' TO WSS-SEM-NP IN WSS-SEM-ALA
               MOVE 'S' TO WSS-NO-CABE IN WSS-NCAE-ALA.
               IF RPT-ALA-TOT-LDIS = 1
              PERFORM ALA-WRT-RLL-YPH.
           MOVE ZEROES TO RPT-ALA-TOT-LCTL.
       F-ALA-CHK-SIZ-DIS.
           EXIT.


       ALA-PRO-VAR-CTL-CH SECTION.
       I-ALA-PRO-VAR-CTL-CH.
           PERFORM ALA-PRO-RLL-NWP-CH.
           IF SI-SEM-NP
           PERFORM ALA-WRT-RLL-YPH.
       F-ALA-PRO-VAR-CTL-CH.
           EXIT.

       M-PH-ALA SECTION.
       I-M-PH-ALA.
           MOVE WSS-FO01 IN SRT TO
                RT-WSS-FO01 IN PH-ALA.
           MOVE WSS-GLS-NOMC IN SRT TO
                RT-WSS-GLS-NOMC IN PH-ALA.
           MOVE SEL-COD-OFIC IN SRT TO
                RT-SEL-COD-OFIC IN PH-ALA.
           MOVE WSS-FO02 IN SRT TO
                RT-WSS-FO02 IN PH-ALA.
           MOVE WSS-GLS-DIRE IN SRT TO
                RT-WSS-GLS-DIRE IN PH-ALA.
           MOVE WSS-GLS-COMU IN SRT TO
                RT-WSS-GLS-COMU IN PH-ALA.
           MOVE WSS-GLS-CIUD IN SRT TO
                RT-WSS-GLS-CIUD IN PH-ALA.
           MOVE WSS-FO03 IN SRT TO
                RT-WSS-FO03 IN PH-ALA.
           MOVE RPT-ALA-PAGE-COUNTER IN RPT-VARI-ALA TO
                RT-RPT-ALA-PAGE-COUNTER IN PH-ALA.
           MOVE WSS-NUM-NPAG IN WSS-ALA TO
                RT-WSS-NUM-NPAG IN PH-ALA.
           MOVE WSS-FO04 IN SRT TO
                RT-WSS-FO04 IN PH-ALA.
           MOVE WSS-GLS-NOM2 IN SRT TO
                RT-WSS-GLS-NOM2 IN PH-ALA.
           MOVE WSS-FO05 IN SRT TO
                RT-WSS-FO05 IN PH-ALA.
           MOVE WSS-GLS-DIR2 IN SRT TO
                RT-WSS-GLS-DIR2 IN PH-ALA.
           MOVE WSS-GLS-OFIC IN WSS-ALA TO
                RT-WSS-GLS-OFIC IN PH-ALA.
           MOVE WSS-FO06 IN SRT TO
                RT-WSS-FO06 IN PH-ALA.
           MOVE WSS-GLS-COM2 IN SRT TO
                RT-WSS-GLS-COM2 IN PH-ALA.
           MOVE WSS-GLS-EJEC IN SRT TO
                RT-WSS-GLS-EJEC IN PH-ALA.
           MOVE WSS-FO07 IN SRT TO
                RT-WSS-FO07 IN PH-ALA.
           MOVE WSS-GLS-CIU2 IN SRT TO
                RT-WSS-GLS-CIU2 IN PH-ALA.
           MOVE WSS-GLS-FONO IN WSS-ALA TO
                RT-WSS-GLS-FONO IN PH-ALA.
           MOVE WSS-FO08 IN SRT TO
                RT-WSS-FO08 IN PH-ALA.
           MOVE WSS-GLS-FPRO IN SRT TO
                RT-WSS-GLS-FPRO IN PH-ALA.
           MOVE SEL-CIC-ICLF IN SRT TO
                RT-SEL-CIC-ICLF IN PH-ALA.
      *RVM-CST-INI 10.08.1995
           MOVE '2'    TO RT-WSS-FO01.
           MOVE '2'    TO RT-WSS-FO02.
           MOVE '2'    TO RT-WSS-FO03.
           MOVE '2'    TO RT-WSS-FO04.
           MOVE '2'    TO RT-WSS-FO05.
           MOVE '2'    TO RT-WSS-FO06.
           MOVE '2'    TO RT-WSS-FO07.
           MOVE '2'    TO RT-WSS-FO08.
      *RVM-CST-FIN 10.08.1995
       F-M-PH-ALA.
           EXIT.

       M-DL-ALA SECTION.
       I-M-DL-ALA.
           MOVE WSS-FO09 IN SRT TO
                RT-WSS-FO09 IN DL-ALA.
           MOVE SE1-GLS-TIAV IN SRT TO
                RT-SE1-GLS-TIAV IN DL-ALA.
           MOVE SE1-VAL-CRED IN SRT TO
                RT-SE1-VAL-CRED IN DL-ALA.
           MOVE SE1-VAL-SCRE IN SRT TO
                RT-SE1-VAL-SCRE IN DL-ALA.
           MOVE SE1-GLS-MONE IN SRT TO
                RT-SE1-GLS-MONE IN DL-ALA.
           MOVE SE1-VAL-SFIN IN SRT TO
                RT-SE1-VAL-SFIN IN DL-ALA.
           MOVE SE1-NUM-DVEN IN SRT TO
                RT-SE1-NUM-DVEN IN DL-ALA.
           MOVE SE1-NUM-MVEN IN SRT TO
                RT-SE1-NUM-MVEN IN DL-ALA.
           MOVE SE1-NUM-SVEN IN SRT TO
                RT-SE1-NUM-SVEN IN DL-ALA.
           MOVE SE1-NUM-AVEN IN SRT TO
                RT-SE1-NUM-AVEN IN DL-ALA.
           MOVE SE1-IND-SCTB IN SRT TO
                RT-SE1-IND-SCTB IN DL-ALA.
           MOVE SE1-NUM-DCOL IN SRT TO
                RT-SE1-NUM-DCOL IN DL-ALA.
           MOVE SE1-NUM-MCOL IN SRT TO
                RT-SE1-NUM-MCOL IN DL-ALA.
      *RVM-CST-INI 10.08.1995
      *    MOVE SEL-CIC-ICLF IN SRT TO
      *         RT-SEL-CIC-ICLF IN DL-ALA.
           MOVE SPACES TO
                RT-SEL-CIC-ICLF IN DL-ALA.
           MOVE '1'    TO RT-WSS-FO09.
      *RVM-CST-FIN 10.08.1995
       F-M-DL-ALA.
           EXIT.

       M-CF-ALA-SEL-CIC-ICLF SECTION.
       I-M-CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-FO10 IN SRT TO
                RT-WSS-FO10 IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-DPRO IN SRT TO
                RT-WSS-NUM-DPRO IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-MPRO IN SRT TO
                RT-WSS-NUM-MPRO IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-SPRO IN SRT TO
                RT-WSS-NUM-SPRO IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-APRO IN SRT TO
                RT-WSS-NUM-APRO IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-SGV-CAPI IN WSS-ALA TO
                RT-WSS-SGV-CAPI IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-SGV-REAJ IN WSS-ALA TO
                RT-WSS-SGV-REAJ IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-SGV-INTE IN WSS-ALA TO
                RT-WSS-SGV-INTE IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-VAL-IMPU IN WSS-ALA TO
                RT-WSS-VAL-IMPU IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-FO11 IN SRT TO
                RT-WSS-FO11 IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-VAL-CMAX IN WSS-ALA TO
                RT-WSS-VAL-CMAX IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-SGV-MUTI IN WSS-ALA TO
                RT-WSS-SGV-MUTI IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-SGV-MDIS IN WSS-ALA TO
                RT-WSS-SGV-MDIS IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-DVEN IN WSS-ALA TO
                RT-WSS-NUM-DVEN IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-MVEN IN WSS-ALA TO
                RT-WSS-NUM-MVEN IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-SVEN IN WSS-ALA TO
                RT-WSS-NUM-SVEN IN CF-ALA-SEL-CIC-ICLF.
           MOVE WSS-NUM-AVEN IN WSS-ALA TO
                RT-WSS-NUM-AVEN IN CF-ALA-SEL-CIC-ICLF.
      *RVM-CST-INI 11.08.1995
           MOVE '3'    TO RT-WSS-FO10.
           MOVE '3'    TO RT-WSS-FO11.
      *RVM-CST-FIN 11.08.1995
       F-M-CF-ALA-SEL-CIC-ICLF.
           EXIT.

       M-CF-ALA-SEL-COD-OFIC SECTION.
       I-M-CF-ALA-SEL-COD-OFIC.
       F-M-CF-ALA-SEL-COD-OFIC.
           EXIT.

       M-CF-ALA-WSS-GLS-COMU SECTION.
       I-M-CF-ALA-WSS-GLS-COMU.
       F-M-CF-ALA-WSS-GLS-COMU.
           EXIT.

       M-CF-ALA-WSS-GLS-DIRE SECTION.
       I-M-CF-ALA-WSS-GLS-DIRE.
       F-M-CF-ALA-WSS-GLS-DIRE.
           EXIT.
      ***** CRW-FINAL

      *    09-AUG-95 05:51 PM     ,PAI=CHI ,CLI=BCI ,SOP=MVS
       D-CF-ALA-SEL-COD-OFIC SECTION.
       INI-CF-ALA-SEL-COD-OFIC.
      *<<<< CF_ALA_SEL_COD_OFIC
           PERFORM BUSCA-OFIC.
      *>>>> CF_ALA_DBC_COD_OFIC
       FIN-CF-ALA-SEL-COD-OFIC.
           EXIT.
       D-CF-ALA-WSS-GLS-DIRE SECTION.
       INI-CF-ALA-WSS-GLS-DIRE.
       FIN-CF-ALA-WSS-GLS-DIRE.
           EXIT.
       D-CF-ALA-WSS-GLS-COMU SECTION.
       INI-CF-ALA-WSS-GLS-COMU.
       FIN-CF-ALA-WSS-GLS-COMU.
           EXIT.
       D-CF-ALA-SEL-CIC-ICLF SECTION.
       INI-CF-ALA-SEL-CIC-ICLF.
      *<<<< CF_ALA_SEL_CIC_ICLF
           MOVE ZEROES TO RPT-ALA-PAGE-COUNTER.
      *>>>>
       FIN-CF-ALA-SEL-CIC-ICLF.
           EXIT.
       D-PH-ALA SECTION.
       INI-PH-ALA.
      *<<<< PH_ALA
           PERFORM BUSCA-OFIC.
      *>>>>
       FIN-PH-ALA.
           EXIT.
       D-DL-ALA SECTION.
       INI-DL-ALA.
       FIN-DL-ALA.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
       MOVER-SEL-WSS SECTION.
       INI-MOVER-SEL-WSS.
      *RVM-CST-INI 22-SEP-1995
           MOVE SEL-COD-OFIC IN SEL TO WSS-COD-OFIC IN WSS-VARI.
           MOVE SEL-COD-EJEC IN SEL TO WSS-COD-EJEC IN WSS-VARI.
      *RVM-CST-FIN 22-SEP-1995
           MOVE SEL-CIC-ICLF IN SEL TO WSS-CIC-ICLF IN WSS-VARI.
           MOVE SEL-NUM-ILDC IN SEL TO WSS-NUM-ILDC IN WSS-VARI.
      *     MOVE SEL-IND-VIGE IN SEL TO WSS-IND-VIGE IN WSS-VARI.
      *     MOVE SEL-MSC-STAT IN SEL TO WSS-MSC-STAT IN WSS-VARI.
           MOVE SEL-FEC-FPRO IN SEL TO WSS-FEC-FPRO IN WSS-VARI.
       FIN-MOVER-SEL-WSS.
           EXIT.

       GRABAR-SEL-SRT SECTION.
       INI-GRABAR-SEL-SRT.
      *RVM-CST-INI 22-SEP-1995
           MOVE WSS-COD-OFIC IN WSS-VARI TO SEL-COD-OFIC IN SRT.
           MOVE WSS-COD-EJEC IN WSS-VARI TO SEL-COD-EJEC IN SRT.
           PERFORM BUSCA-EJEC.
      *RVM-CST-FIN 22-SEP-1995
           MOVE WSS-CIC-ICLF IN WSS-VARI TO SEL-CIC-ICLF IN SRT.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN SRT.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN SRT.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN SRT.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN SRT.
           MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT.

           MOVE SE1-NUM-MCOL IN SE1 TO SE1-NUM-MCOL IN SRT.
           MOVE SE1-NUM-DCOL IN SE1 TO SE1-NUM-DCOL IN SRT.
           MOVE SE1-GLS-TIAV IN SE1 TO SE1-GLS-TIAV IN SRT.
           MOVE SE1-VAL-CRED IN SE1 TO SE1-VAL-CRED IN SRT.
           MOVE SE1-VAL-SCRE IN SE1 TO SE1-VAL-SCRE IN SRT.
           MOVE SE1-GLS-MONE IN SE1 TO SE1-GLS-MONE IN SRT.
           MOVE SE1-VAL-SFIN IN SE1 TO SE1-VAL-SFIN IN SRT.
           MOVE SE1-NUM-SVEN IN SE1 TO SE1-NUM-SVEN IN SRT.
           MOVE SE1-NUM-AVEN IN SE1 TO SE1-NUM-AVEN IN SRT.
           MOVE SE1-NUM-MVEN IN SE1 TO SE1-NUM-MVEN IN SRT.
           MOVE SE1-NUM-DVEN IN SE1 TO SE1-NUM-DVEN IN SRT.
           MOVE SE1-IND-SCTB IN SE1 TO SE1-IND-SCTB IN SRT.

           ADD 1                    TO WSS-NUM-OPER IN WSS-VARI.

       FIN-GRABAR-SEL-SRT.
           EXIT.


       BUSCA-COMU SECTION.
       INI-BUSCA-COMU.

      * Mediante BUS-DOM y BUS-TAB Busca Comuna Obteniendo Codigos de Ta
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE ZEROES      TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT ( FIO-STAT-OKS AND
                    DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD )
               DISPLAY 'ERROR: NO EXISTE DIRECCION PARA CIC : '
                   DBC-CIC-ICLI IN DBC
               GO TO FIN-BUSCA-COMU.

      *RVM-CST-INI 26-SEP-1995
      *GUARDA PRIMERA DIRECCION EN CASO DE QUE NO TENGA DIRECCION TIPO
      * 'D' ASOCIADA.
           MOVE RCD TO WSS-RCD-AUX IN WSS-VARI.

       LUP-BUSCA-COMU.
           IF NOT ( FIO-STAT-OKS AND
                    DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD )
      *RESTAURA RCD LEIDO
               MOVE WSS-RCD-AUX TO RCD
               GO TO EXT-BUSCA-COMU.

           IF RCD-MSC-TDIR IN RCD NOT = 'D'
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM SGC-FIO-RCD
               GO TO LUP-BUSCA-COMU.

       EXT-BUSCA-COMU.
      *RVM-CST-FIN 26-SEP-1995
           IF RCD-GLS-DIRE IN RCD > SPACES

               MOVE RCD-GLS-DIRE IN RCD TO WSS-GLS-DIRE IN SRT
               MOVE RCD-GLS-DIRE IN RCD TO WSS-GLS-DIR2 IN SRT

               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA IN WSS-VARI
               IF WSS-IND-PAIS NOT = 'P'
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'COM'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB TO COM
                   MOVE COM-GLS-COMU IN COM TO WSS-GLS-COMU IN WSS-VARI
                   MOVE COM-GLS-CIUD IN COM TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'PAI'               TO TAB-COD-TTAB IN TAB
                   MOVE COM-COD-PAIS IN COM TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PAIS IN WSS-VARI
               ELSE
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'PAI'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-PAIS IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-COMU IN WSS-VARI
               MOVE SPACES TO WSS-GLS-CIUD IN WSS-VARI
               MOVE SPACES TO WSS-GLS-PAIS IN WSS-VARI.

           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COMU IN SRT.
           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COM2 IN SRT.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIUD IN SRT.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIU2 IN SRT.

       FIN-BUSCA-COMU.
           EXIT.

       BUSCA-OFIC SECTION.
       INI-BUSCA-OFIC.
      *    DISPLAY 'PASE POR BUSCA OFIC'.
      *    DISPLAY 'DBC-COD-OFIC : ' DBC-COD-OFIC IN SRT.
      *    IF DBC-COD-OFIC IN SRT > SPACES
      *      MOVE DBC-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
           IF SEL-COD-OFIC IN SRT > SPACES
             MOVE SEL-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
             PERFORM BUS-OFI
             MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-ALA
             MOVE OFI-GLS-FON1 IN OFI TO WSS-GLS-FONO IN WSS-ALA
           ELSE
      *      DISPLAY 'ERROR: NO ENCONTRE OFICINA : ' SEL-COD-OFIC IN SRT
             MOVE SPACES TO WSS-GLS-FONO IN WSS-ALA
             MOVE SPACES TO WSS-GLS-OFIC IN WSS-ALA.
       FIN-BUSCA-OFIC.
           EXIT.

       BUSCA-EJEC SECTION.
       INI-BUSCA-EJEC.
      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF SEL-COD-EJEC IN SRT > SPACES
             MOVE 'EJC'               TO USR-COD-TTAB IN USR
             MOVE SEL-COD-EJEC IN SRT TO USR-COD-USER IN USR
             PERFORM BUS-USR
             MOVE USR-GLS-DESC        TO WSS-GLS-EJEC IN SRT
           ELSE
             MOVE SPACES TO WSS-GLS-EJEC IN SRT.
       FIN-BUSCA-EJEC.
           EXIT.

       GRABAR-NUM-PAG SECTION.
       INI-GRABAR-NUM-PAG.
           MOVE WSS-CIC-ICLF IN WSS-VARI TO PAG-CIC-ICLF IN PAG.
           MOVE 1 TO WSS-DIV.
           IF WSS-NUM-OPER IN WSS-VARI NOT < 60
               DIVIDE WSS-NUM-OPER IN WSS-VARI BY 60
               GIVING WSS-DIV ROUNDED REMAINDER WSS-REST IN WSS-VARI
               IF WSS-REST > 0
                   ADD 1 TO WSS-DIV.
           MOVE WSS-DIV TO PAG-NUM-NPAG IN PAG.

      *RVM-CST-INI 4-SEP-1995
      *ANTES DE GRABAR LOS VALORES CORRESPONDIENTES A LA CLF, LOS
      *CONVIERTE DE PESOS A UF.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
      *BUSCA DE UF A PESO PARA LUEGO DIVIDIR.
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
               DISPLAY 'PAG-KEY-IREG : ' PAG-KEY-IREG IN PAG
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
           ELSE
               DIVIDE WSS-VAL-CMAX IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                          GIVING WSS-VAL-CMAX IN WSS-VARI ROUNDED.

           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
           ELSE
               DIVIDE WSS-SGV-MUTI IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                          GIVING WSS-SGV-MUTI IN WSS-VARI .

      *RVM-CST-FIN 4-SEP-1995

           MOVE WSS-VAL-CMAX IN WSS-VARI TO PAG-VAL-CMAX IN PAG.
           MOVE WSS-SGV-MUTI IN WSS-VARI TO PAG-SGV-MUTI IN PAG.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO PAG-NUM-SVEN IN PAG.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO PAG-NUM-AVEN IN PAG.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO PAG-NUM-MVEN IN PAG.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO PAG-NUM-DVEN IN PAG.
           MOVE WSS-VAL-IMPU IN WSS-VARI TO PAG-VAL-IMPU IN PAG.
           MOVE WSS-SGV-CAPI IN WSS-VARI TO PAG-SGV-CAPI IN PAG.
           MOVE WSS-SGV-REAJ IN WSS-VARI TO PAG-SGV-REAJ IN PAG.
           MOVE WSS-SGV-INTE IN WSS-VARI TO PAG-SGV-INTE IN PAG.
           SUBTRACT WSS-SGV-MUTI IN WSS-VARI FROM
             WSS-VAL-CMAX IN WSS-VARI GIVING WSS-SGV-MDIS IN WSS-VARI.
           MOVE WSS-SGV-MDIS IN WSS-VARI TO PAG-SGV-MDIS IN PAG.
           DISPLAY '********************************************'.
           DISPLAY 'INP SRT'.
           DISPLAY 'LLAVE PAG : ' PAG-CIC-ICLF IN PAG.
           DISPLAY 'IMPUESTOS : ' PAG-VAL-IMPU IN PAG.
           DISPLAY 'CAPITALES : ' PAG-SGV-CAPI IN PAG.
           DISPLAY 'REAJUSTES : ' PAG-SGV-REAJ IN PAG.
           DISPLAY 'INTERESES : ' PAG-SGV-INTE IN PAG.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
       FIN-GRABAR-NUM-PAG.
           EXIT.

       MOVER-WSS-ALA SECTION.
       INI-MOVER-WSS-ALA.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO WSS-VAL-CMAX IN WSS-ALA.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO WSS-NUM-SVEN IN WSS-ALA.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO WSS-NUM-AVEN IN WSS-ALA.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO WSS-NUM-MVEN IN WSS-ALA.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO WSS-NUM-DVEN IN WSS-ALA.
           MOVE WSS-VAL-IMPU IN WSS-VARI TO WSS-VAL-IMPU IN WSS-ALA.
           MOVE WSS-SGV-CAPI IN WSS-VARI TO WSS-SGV-CAPI IN WSS-ALA.
           MOVE WSS-SGV-REAJ IN WSS-VARI TO WSS-SGV-REAJ IN WSS-ALA.
           MOVE WSS-SGV-INTE IN WSS-VARI TO WSS-SGV-INTE IN WSS-ALA.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO WSS-VAL-CMAX IN WSS-ALA.
           MOVE WSS-SGV-MUTI IN WSS-VARI TO WSS-SGV-MUTI IN WSS-ALA.
           MOVE WSS-SGV-MDIS IN WSS-VARI TO WSS-SGV-MDIS IN WSS-ALA.
      *     MOVE WSS-NUM-NPAG IN WSS-VARI TO WSS-NUM-NPAG IN WSS-ALA.
       FIN-MOVER-WSS-ALA.
           EXIT.

       RESETEAR-SRT SECTION.
       INI-RESETEAR-SRT.
           MOVE SPACES TO WSS-GLS-DIRE IN SRT.
           MOVE SPACES TO WSS-GLS-DIR2 IN SRT.
           MOVE SPACES TO WSS-GLS-EJEC IN SRT.
           MOVE SPACES TO WSS-GLS-NOMC IN SRT.
           MOVE SPACES TO WSS-GLS-NOM2 IN SRT.
           MOVE SPACES TO WSS-GLS-COMU IN SRT.
           MOVE SPACES TO WSS-GLS-COM2 IN SRT.
           MOVE SPACES TO WSS-GLS-CIUD IN SRT.
           MOVE SPACES TO WSS-GLS-CIU2 IN SRT.
      *    MOVE SPACES TO DBC-COD-OFIC IN SRT.
      *RVM-CST-INI 22-SEP-1995
           MOVE SPACES TO SEL-COD-EJEC IN SRT.
      *RVM-CST-FIN 22-SEP-1995
           MOVE SPACES TO SEL-COD-OFIC IN SRT.
           MOVE ZEROES TO SE1-NUM-MCOL IN SRT.
           MOVE ZEROES TO SE1-NUM-DCOL IN SRT.
           MOVE SPACES TO SE1-GLS-TIAV IN SRT.
           MOVE ZEROES TO SE1-VAL-CRED IN SRT.
           MOVE ZEROES TO SE1-VAL-SCRE IN SRT.
           MOVE SPACES TO SE1-GLS-MONE IN SRT.
           MOVE ZEROES TO SE1-VAL-SFIN IN SRT.
           MOVE ZEROES TO SE1-NUM-SVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-AVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-MVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-DVEN IN SRT.
           MOVE SPACES TO SE1-IND-SCTB IN SRT.
       FIN-RESETEAR-SRT.
           EXIT.

      *RVM-CST-INI 09.09.1995
       CAL-SGV-MUTI SECTION.
       INI-CAL-SGV-MUTI.
           IF SE1-IND-TMON IN SE1 = '0'
               ADD SE1-VAL-SCRE IN SE1 TO WSS-SGV-MUTI IN WSS-VARI
           ELSE
               MOVE SE1-VAL-SCRE IN SE1 TO TVC-VALO IN TVC-VARI
               MOVE WSS-COD-UF   IN WSS-VARI TO TVC-MON1 IN TVC-VARI
               MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
               MOVE WSS-NUM-DPRO IN WSS-VARI TO TVC-DCAM IN TVC-VARI
               MOVE WSS-NUM-MPRO IN WSS-VARI TO TVC-MCAM IN TVC-VARI
               MOVE WSS-NUM-SPRO IN WSS-VARI TO TVC-SCAM IN TVC-VARI
               MOVE WSS-NUM-APRO IN WSS-VARI TO TVC-ACAM IN TVC-VARI
               PERFORM TAB-PRO-TVC
               DISPLAY 'CAM-KEY-CAMB : ' CAM-KEY-CAMB IN CAM
               DISPLAY 'FIO-STAT     : ' FIO-STAT
               IF TVC-CMSG IN TVC-VARI > SPACES
                   DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                        TVC-MON1 IN TVC-VARI ' A : '
                        TVC-MON2 IN TVC-VARI ' AL : '
                        TVC-FCAM IN TVC-VARI
                        GO TO FIN-CAL-SGV-MUTI
               ELSE
                   ADD TVC-VALO IN TVC-VARI TO WSS-SGV-MUTI IN WSS-VARI.

       FIN-CAL-SGV-MUTI.
           EXIT.
      *RVM-CST-FIN 09.09.1995

       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Cod. Valor de Cambio Pesos con CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *    MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC     IN TVC-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-COD-UF SECTION.
       INI-OBT-CODUF.
      * Obtiene Cod. Valor de Cambio UF con CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.
      *    MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC   IN TVC-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       COPY GNSBBMSG.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFCOM.
       COPY GNSBGCPT.
       COPY GNSBGPES.

       COPY LDCBFPAG.
       COPY LDCBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>


