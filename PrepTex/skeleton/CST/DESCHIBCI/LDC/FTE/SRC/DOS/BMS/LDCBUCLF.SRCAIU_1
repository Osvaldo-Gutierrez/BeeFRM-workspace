      *
      * LDCBUCLF
      * Version 3.0.1 Nov-2005
      * 08-May-19 11:44 AM
      *
       SET-TAG-LDCBUCLF SECTION.
       INI-SET-TAG-LDCBUCLF.
           MOVE
           '<IDNMOD NOM=$LDCBUCLF$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$08-May-19 11:44 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBUCLF.
           EXIT.
           
       RET-ALL-CLF SECTION.
       INI-RET-ALL-CLF.
           PERFORM KEY-ALL-CLF.
           PERFORM RET-CLF-CLF.
           PERFORM RET-DBC-CLF.
       FIN-RET-ALL-CLF.
           EXIT.
       
       RET-CLF-CLF SECTION.
       INI-RET-CLF-CLF.
           MOVE CLF-COD-VCCF IN CLF-FLD TO CLF-COD-VCCF IN CLF.
           MOVE CLF-COD-TOCF IN CLF-FLD TO CLF-COD-TOCF IN CLF.
           MOVE CLF-COD-AOCF IN CLF-FLD TO CLF-COD-AOCF IN CLF.
           MOVE CLF-COD-OFIC IN CLF-FLD TO CLF-COD-OFIC IN CLF.
           MOVE CLF-COD-EJEC IN CLF-FLD TO CLF-COD-EJEC IN CLF.
           MOVE CLF-IND-RSTR IN CLF-FLD TO CLF-IND-RSTR IN CLF.
           MOVE CLF-VAL-CMAX IN CLF-FLD TO CLF-VAL-CMAX IN CLF.
           MOVE CLF-IND-UCAP IN CLF-FLD TO CLF-IND-UCAP IN CLF.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DING IN CLF-FLD TO CLF-NUM-DING IN CLF.
           MOVE CLF-NUM-MING IN CLF-FLD TO CLF-NUM-MING IN CLF.
           MOVE CLF-NUM-SING IN CLF-FLD TO CLF-NUM-SING IN CLF.
           MOVE CLF-NUM-AING IN CLF-FLD TO CLF-NUM-AING IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DAPE IN CLF-FLD TO CLF-NUM-DAPE IN CLF.
           MOVE CLF-NUM-MAPE IN CLF-FLD TO CLF-NUM-MAPE IN CLF.
           MOVE CLF-NUM-SAPE IN CLF-FLD TO CLF-NUM-SAPE IN CLF.
           MOVE CLF-NUM-AAPE IN CLF-FLD TO CLF-NUM-AAPE IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-PREV IN CLF-FLD TO CLF-NUM-PREV IN CLF.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DURV IN CLF-FLD TO CLF-NUM-DURV IN CLF.
           MOVE CLF-NUM-MURV IN CLF-FLD TO CLF-NUM-MURV IN CLF.
           MOVE CLF-NUM-SURV IN CLF-FLD TO CLF-NUM-SURV IN CLF.
           MOVE CLF-NUM-AURV IN CLF-FLD TO CLF-NUM-AURV IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-IND-PREV IN CLF-FLD TO CLF-IND-PREV IN CLF.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DPRV IN CLF-FLD TO CLF-NUM-DPRV IN CLF.
           MOVE CLF-NUM-MPRV IN CLF-FLD TO CLF-NUM-MPRV IN CLF.
           MOVE CLF-NUM-SPRV IN CLF-FLD TO CLF-NUM-SPRV IN CLF.
           MOVE CLF-NUM-APRV IN CLF-FLD TO CLF-NUM-APRV IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-PVIG IN CLF-FLD TO CLF-NUM-PVIG IN CLF.
           MOVE CLF-IND-PVIG IN CLF-FLD TO CLF-IND-PVIG IN CLF.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DVEN IN CLF-FLD TO CLF-NUM-DVEN IN CLF.
           MOVE CLF-NUM-MVEN IN CLF-FLD TO CLF-NUM-MVEN IN CLF.
           MOVE CLF-NUM-SVEN IN CLF-FLD TO CLF-NUM-SVEN IN CLF.
           MOVE CLF-NUM-AVEN IN CLF-FLD TO CLF-NUM-AVEN IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-VAL-COMI IN CLF-FLD TO CLF-VAL-COMI IN CLF.
           MOVE CLF-IND-COMI IN CLF-FLD TO CLF-IND-COMI IN CLF.
           MOVE CLF-CAI-ICAC IN CLF-FLD TO CLF-CAI-ICAC IN CLF.
           MOVE CLF-IIC-ICAC IN CLF-FLD TO CLF-IIC-ICAC IN CLF.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-NUM-DCIE IN CLF-FLD TO CLF-NUM-DCIE IN CLF.
           MOVE CLF-NUM-MCIE IN CLF-FLD TO CLF-NUM-MCIE IN CLF.
           MOVE CLF-NUM-SCIE IN CLF-FLD TO CLF-NUM-SCIE IN CLF.
           MOVE CLF-NUM-ACIE IN CLF-FLD TO CLF-NUM-ACIE IN CLF.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE CLF-CAI-CREN IN CLF-FLD TO CLF-CAI-CREN IN CLF.
           MOVE CLF-IIC-CREN IN CLF-FLD TO CLF-IIC-CREN IN CLF.
           MOVE CLF-COD-RAZC IN CLF-FLD TO CLF-COD-RAZC IN CLF.
           MOVE CLF-MSC-STAT IN CLF-FLD TO CLF-MSC-STAT IN CLF.
           MOVE CLF-COD-CAPR IN CLF-FLD TO CLF-COD-CAPR IN CLF.
       FIN-RET-CLF-CLF.
           EXIT.
       
       RET-DBC-CLF SECTION.
       INI-RET-DBC-CLF.
       FIN-RET-DBC-CLF.
           EXIT.
       
       KEY-ALL-CLF SECTION.
       INI-KEY-ALL-CLF.
           PERFORM KEY-CLF-CLF.
           PERFORM KEY-DBC-CLF.
       FIN-KEY-ALL-CLF.
           EXIT.
       
       KEY-CLF-CLF SECTION.
       INI-KEY-CLF-CLF.
           MOVE CLF-CAI-ICLF IN CLF-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE CLF-IIC-ICLF IN CLF-FLD TO CLF-IIC-ICLF IN CLF.
       FIN-KEY-CLF-CLF.
           EXIT.
       
       KEY-DBC-CLF SECTION.
       INI-KEY-DBC-CLF.
           MOVE DBC-GLS-NOMC IN CLF-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN CLF-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-CAI-ICLI IN CLF-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO DBC-IIC-ICLI IN DBC.
       FIN-KEY-DBC-CLF.
           EXIT.
       
       SCR-CLRA-CLF SECTION.
       INI-SCR-CLRA-CLF.
           PERFORM CLR-KEY-CLF.
           PERFORM CLR-FLD-CLF.
       FIN-SCR-CLRA-CLF.
           EXIT.
       
       CLR-KEY-CLF SECTION.
       INI-CLR-KEY-CLF.
           MOVE SPACES TO CLF-CAI-ICLF IN CLF-FLD.
           MOVE ZEROES TO CLF-IIC-ICLF IN CLF-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN CLF-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN CLF-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN CLF-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO DBC-CAI-ICLI IN CLF-FLD.
           MOVE ZEROES TO DBC-IIC-ICLI IN CLF-FLD.
       FIN-CLR-KEY-CLF.
           EXIT.
       
       CLR-FLD-CLF SECTION.
       INI-CLR-FLD-CLF.
           MOVE SPACES TO FRM-GLS-VCCF IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-UCAP IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-PREV IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-COMI IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-RAZC IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN CLF-FLD.
           MOVE SPACES TO FRM-GLS-CAPR IN CLF-FLD.
           PERFORM CLR-CLF-CLF.
           PERFORM CLR-DBC-CLF.
       FIN-CLR-FLD-CLF.
           EXIT.
       
       CLR-CLF-CLF SECTION.
       INI-CLR-CLF-CLF.
           MOVE SPACES TO CLF-COD-VCCF IN CLF-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN CLF-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN CLF-FLD.
           MOVE SPACES TO CLF-COD-OFIC IN CLF-FLD.
           MOVE SPACES TO CLF-COD-EJEC IN CLF-FLD.
           MOVE SPACES TO CLF-IND-RSTR IN CLF-FLD.
           MOVE ZEROES TO CLF-VAL-CMAX IN CLF-FLD.
           MOVE SPACES TO CLF-IND-UCAP IN CLF-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FING IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FAPE IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-NUM-PREV IN CLF-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FURV IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO CLF-IND-PREV IN CLF-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FPRV IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-NUM-PVIG IN CLF-FLD.
           MOVE SPACES TO CLF-IND-PVIG IN CLF-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FVEN IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-VAL-COMI IN CLF-FLD.
           MOVE SPACES TO CLF-IND-COMI IN CLF-FLD.
           MOVE SPACES TO CLF-CAI-ICAC IN CLF-FLD.
           MOVE ZEROES TO CLF-IIC-ICAC IN CLF-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FCIE IN CLF-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO CLF-CAI-CREN IN CLF-FLD.
           MOVE SPACES TO CLF-IIC-CREN IN CLF-FLD.
           MOVE SPACES TO CLF-COD-RAZC IN CLF-FLD.
           MOVE SPACES TO CLF-MSC-STAT IN CLF-FLD.
           MOVE SPACES TO CLF-COD-CAPR IN CLF-FLD.
       FIN-CLR-CLF-CLF.
           EXIT.
       
       CLR-DBC-CLF SECTION.
       INI-CLR-DBC-CLF.
       FIN-CLR-DBC-CLF.
           EXIT.
       
       FST-KEY-CLF SECTION.
       INI-FST-KEY-CLF.
           MOVE -1 TO CLF-CAI-ICLF-LEN IN CLF-FLD.
      *<<<< FIN_FST_KEY_CLF
      * LTM-INI 25-04-1994
           IF SCR-CCPP NOT = 'ING'
               GO TO FIN-FST-KEY-CLF.
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE FRM-CPIM-AEY TO CLF-CAI-ICLF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-IIC-ICLF-ATR IN CLF-FLD
           ELSE
               GO TO FIN-FST-KEY-CLF.
      * LTM-FIN 25-04-1994
      *>>>>
       FIN-FST-KEY-CLF.
           EXIT.
       
       FST-FLD-CLF SECTION.
       INI-FST-FLD-CLF.
           MOVE -1 TO CLF-COD-VCCF-LEN IN CLF-FLD.
      *<<<< FIN_FST_FLD_CLF
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD.

           MOVE 'M' TO CLF-IND-UCAP IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-UCAP-ATR IN CLF-FLD.

           PERFORM GET-FHOY.
           IF SCR-CCPP = 'ING'
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD
      *         MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

      *FLB CST  31-JAN-1994
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *AMP IF WSS-VSN-OCAI = 'S'
      *AMP     MOVE FRM-CPIM-AEY TO CLF-COD-OFIC-ATR IN CLF-FLD.
      *FLB CST  31-JAN-1994 FIN

           IF SCR-CMND = CMND-MOD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
      *         MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           MOVE FRM-CPIM-AEY TO CLF-FEC-FVEN-ATR IN CLF-FLD.
           MOVE 0 TO CLF-COD-VCCF-LEN IN CLF-FLD.

           IF SCR-CMND = CMND-ACA
      *        MOVE -1 TO CLF-FEC-FAPE-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
      *RVM-CST-INI 24.09.1996
               MOVE HOY-DHOY     TO CLF-NUM-DING     IN CLF-FLD
               MOVE HOY-MHOY     TO CLF-NUM-MING     IN CLF-FLD
               MOVE HOY-SHOY     TO CLF-NUM-SING     IN CLF-FLD
               MOVE HOY-AHOY     TO CLF-NUM-AING     IN CLF-FLD
      *RVM-CST-FIN 24.09.1996
               PERFORM PRO-FLD-CLF
      *         MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD
      *         MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
      *         MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
      *         MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
      *         MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-MCA
      *FLB CST  31-JAN-1994
      *        MOVE -1 TO CLF-COD-OFIC-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-VCCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-TOCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-AOCF-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
      *RVM-CST-INI 25.09.1996
      *INHIBIDO, PARA QUE NO ASUMA FECHA DE HOY
      *        MOVE HOY-DHOY     TO CLF-NUM-DAPE     IN CLF-FLD
      *        MOVE HOY-MHOY     TO CLF-NUM-MAPE     IN CLF-FLD
      *        MOVE HOY-SHOY     TO CLF-NUM-SAPE     IN CLF-FLD
      *        MOVE HOY-AHOY     TO CLF-NUM-AAPE     IN CLF-FLD
      *RVM-CST-FIN 25.09.1996
               MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD
      *RVM-CST-INI 24.06.1996
      *        MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD
               MOVE HOY-DHOY     TO CLF-NUM-DING     IN CLF-FLD
               MOVE HOY-MHOY     TO CLF-NUM-MING     IN CLF-FLD
               MOVE HOY-SHOY     TO CLF-NUM-SING     IN CLF-FLD
               MOVE HOY-AHOY     TO CLF-NUM-AING     IN CLF-FLD
      *RVM-ADA-INI 10.08.2004
      *ADA-INI 15-NOV-2002
      *        MOVE FRM-CPIM-AEY TO CLF-COD-CAPR-ATR IN CLF-FLD
      *ADA-FIN 15-NOV-2002
      *RVM-ADA-FIN 10.08.2004
      *RVM-CST-FIN 24.06.1996
      *FLB CST  31-JAN-1994
               IF WSS-VSN-OCAI = 'S'
                   MOVE -1 TO CLF-COD-EJEC-LEN IN CLF-FLD
                   GO TO FIN-FST-FLD-CLF
               ELSE
                   MOVE -1 TO CLF-COD-OFIC-LEN IN CLF-FLD
                   GO TO FIN-FST-FLD-CLF.
      *FLB CST  31-JAN-1994 FIN

           IF SCR-CMND = CMND-CMX
               MOVE -1 TO CLF-VAL-CMAX-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-VAL-CMAX-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-CIE
               MOVE -1 TO CLF-COD-RAZC-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.
           IF SCR-CMND = CMND-CLC
               MOVE -1 TO CLF-COD-RAZC-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-COD-RAZC-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.

           IF SCR-CMND = CMND-REV
               MOVE -1 TO CLF-FEC-FPRV-LEN IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD
               MOVE HOY-DHOY TO CLF-NUM-DURV IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MURV IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SURV IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AURV IN CLF-FLD
               PERFORM PRO-FLD-CLF
               MOVE FRM-CPIM-UBY TO CLF-FEC-FPRV-ATR IN CLF-FLD
               GO TO FIN-FST-FLD-CLF.
      *>>>>
       FIN-FST-FLD-CLF.
           EXIT.
       
       PRO-KEY-CLF SECTION.
       INI-PRO-KEY-CLF.
           PERFORM PRO-MKY-CLF.
       FIN-PRO-KEY-CLF.
           EXIT.
       
       PRO-MKY-CLF SECTION.
       INI-PRO-MKY-CLF.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN CLF-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-MKY-CLF.
           EXIT.
       
       PRO-FLD-CLF SECTION.
       INI-PRO-FLD-CLF.
           PERFORM PRO-CLF-CLF.
           PERFORM PRO-DBC-CLF.
       FIN-PRO-FLD-CLF.
           EXIT.
       
       PRO-CLF-CLF SECTION.
       INI-PRO-CLF-CLF.
           MOVE FRM-CPIM-AEY TO CLF-COD-VCCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-TOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-AOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-OFIC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-EJEC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-RSTR-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-VAL-CMAX-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-UCAP-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FAPE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-NUM-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FURV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FPRV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-NUM-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FVEN-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-VAL-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IND-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-CAI-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IIC-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-FEC-FCIE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-RAZC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN CLF-FLD.
           MOVE FRM-CPIM-AEY TO CLF-COD-CAPR-ATR IN CLF-FLD.
       FIN-PRO-CLF-CLF.
           EXIT.
       
       PRO-DBC-CLF SECTION.
       INI-PRO-DBC-CLF.
       FIN-PRO-DBC-CLF.
           EXIT.
       
       UNP-KEY-CLF SECTION.
       INI-UNP-KEY-CLF.
           PERFORM UNP-IKY-CLF.
           PERFORM UNP-AKY-CLF.
           PERFORM UNP-MKY-CLF.
       FIN-UNP-KEY-CLF.
           EXIT.
       
       UNP-IKY-CLF SECTION.
       INI-UNP-IKY-CLF.
           MOVE FRM-CPIM-UBY TO CLF-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO CLF-IIC-ICLF-ATR.
       FIN-UNP-IKY-CLF.
           EXIT.
       
       UNP-MKY-CLF SECTION.
       INI-UNP-MKY-CLF.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN CLF-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-MKY-CLF.
           EXIT.
       
       UNP-AKY-CLF SECTION.
       INI-UNP-AKY-CLF.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-CLF.
           EXIT.
       
       UNP-FLD-CLF SECTION.
       INI-UNP-FLD-CLF.
           PERFORM UNP-CLF-CLF.
           PERFORM UNP-DBC-CLF.
       FIN-UNP-FLD-CLF.
           EXIT.
       
       UNP-CLF-CLF SECTION.
       INI-UNP-CLF-CLF.
           MOVE FRM-CPIM-UBY TO CLF-COD-VCCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-TOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-AOCF-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-OFIC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-EJEC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IND-RSTR-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-VAL-CMAX-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IND-UCAP-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-FEC-FAPE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-NUM-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-FEC-FURV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IND-PREV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-FEC-FPRV-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-NUM-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IND-PVIG-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-FEC-FVEN-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-VAL-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IND-COMI-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-CAI-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-IIC-ICAC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-FEC-FCIE-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-RAZC-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-MSC-STAT-ATR IN CLF-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-CAPR-ATR IN CLF-FLD.
       FIN-UNP-CLF-CLF.
           EXIT.
       
       UNP-DBC-CLF SECTION.
       INI-UNP-DBC-CLF.
       FIN-UNP-DBC-CLF.
           EXIT.
       
       VAL-MKY-CLF SECTION.
       INI-VAL-MKY-CLF.
      *<<<<
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-MKY-CLF.
      *>>>>
       FIN-VAL-MKY-CLF.
           EXIT.
       
       VAL-FLD-CLF SECTION.
       INI-VAL-FLD-CLF.
      *<<<< INI_VAL_FLD_CLF
           PERFORM GET-FHOY.

      *FLB CST   13-DEC-1993
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *AFRI-INI-OCT2005
           IF SCR-CMND = CMND-CLC
               PERFORM VAL-CLF-COD-RAZC
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE -1 TO CLF-COD-RAZC-LEN IN CLF-FLD
                   GO TO FIN-VAL-FLD-CLF
               ELSE
                   GO TO FIN-VAL-FLD-CLF.
      *AFRI-FIN-OCT2005
      *JSS-INI 29-DEC-1998
           IF SCR-CMND = CMND-CIE
               PERFORM VAL-CLF-COD-RAZC
               IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                   MOVE -1 TO CLF-COD-RAZC-LEN IN CLF-FLD
                   GO TO FIN-VAL-FLD-CLF
               ELSE
                   GO TO FIN-VAL-FLD-CLF.
      *JSS-FIN 29-DEC-1998
      *>>>>
           PERFORM VAL-CLF-COD-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-VCCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-TOCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-AOCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOCF-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-CAI-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-IIC-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-OFIC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-EJEC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-OFIC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EJEC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IND-RSTR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IND-RSTR-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-VAL-CMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-VAL-CMAX-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IND-UCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IND-UCAP-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-UCAP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-UCAP-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FING.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FING-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FAPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FAPE-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-NUM-PREV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-NUM-PREV-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FURV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FURV-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-IND-PREV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IND-PREV-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-PREV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PREV-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FPRV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FPRV-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-NUM-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-NUM-PVIG-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IND-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IND-PVIG-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PVIG-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FVEN-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-VAL-COMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-VAL-COMI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IND-COMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IND-COMI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-COMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-COMI-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-CAI-ICAC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-CAI-ICAC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IIC-ICAC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IIC-ICAC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-FEC-FCIE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                CLF-FEC-FCIE-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-CLF-CAI-CREN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-CAI-CREN-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-IIC-CREN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IIC-CREN-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-RAZC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-RAZC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-RAZC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-RAZC-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-MSC-STAT-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-CLF-COD-CAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-CAPR-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
           PERFORM VAL-FRM-GLS-CAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CAPR-LEN IN CLF-FLD
                GO TO FIN-VAL-FLD-CLF.
       FIN-VAL-FLD-CLF.
           EXIT.
       
       VAL-CLF-COD-VCCF SECTION.
       INI-VAL-CLF-COD-VCCF.
           IF CLF-COD-VCCF IN CLF-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-COD-VCCF.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-VCCF IN CLF-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-VCCF IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCCF IN CLF-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-VCCF IN CLF-FLD.
       FIN-VAL-CLF-COD-VCCF.
           EXIT.
       
       VAL-CLF-COD-TOCF SECTION.
       INI-VAL-CLF-COD-TOCF.
           IF CLF-COD-TOCF IN CLF-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-COD-TOCF.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN CLF-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-TOCF IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOCF IN CLF-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TOCF IN CLF-FLD.
      *<<<< FIN_CLF_COD_TOCF
           IF FRM-SUAR NOT = FRM-SUAR-MAL
               MOVE TAB TO TIO
      *FLB CST  3-NOV-1993
      *         IF TIO-GLS-SIST NOT = 'DEU'
               IF TIO-GLS-SIST NOT = 'LDC'
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CLF-COD-TOCF.
      * AMP-INI 09-OCT-1993
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      * AMP-FIN 09-OCT-1993
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF NOT = 'FGL'
               GO TO CON-VAL-CLF-COD-TOCF.
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'AFG ' TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOP-VAL-CLF-COD-TOCF.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'AFG' )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLINOENAFG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN CLF-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-COD-TOCF.
           MOVE TAB-GLS-DATA IN TAB TO WSS-DBC-GLS-DATA.
           IF NOT ( DBC-NUM-ICLI IN CLF-FLD = WSS-DBC-NUM-ICLI AND
              DBC-VRF-ICLI IN CLF-FLD = WSS-DBC-VRF-ICLI AND
              DBC-IND-ICLI IN CLF-FLD = WSS-DBC-IND-ICLI AND
              DBC-GLS-ICLI IN CLF-FLD = WSS-DBC-GLS-ICLI )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LOP-VAL-CLF-COD-TOCF.
       CON-VAL-CLF-COD-TOCF.
      *AFRI-FIN-SEP-2005

      * AMP-INI  3-NOV-1993
           PERFORM VER-SI-ES-GRUPO.
      * AMP-FIN  3-NOV-1993
           IF WSS-EXISTE-GRUPO > ZEROES
      *MHM-INI 25-MAY-2004
      *         IF WSS-CIC-TOCF NOT = 'CGE'
      *              MOVE 'DEU'          TO MSG-COD-SIST
      *              MOVE 'TIOGR<>CGE' TO MSG-COD-MENS
      *              PERFORM GET-MSG
      *              MOVE MSG-GLS-DESC TO FRM-MENS
      *              MOVE FRM-SUAR-MAL TO FRM-SUAR
      *              GO TO FIN-VAL-CLF-COD-TOCF
      *          ELSE
      *MHM-FIN 25-MAY-2004
                    NEXT SENTENCE
            ELSE
                IF WSS-CIC-TOCF = 'CGE'
                    MOVE 'DEU'          TO MSG-COD-SIST
                    MOVE 'TIOGR<>CGE' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-CLF-COD-TOCF
                ELSE
                    NEXT SENTENCE.
      *>>>>
       FIN-VAL-CLF-COD-TOCF.
           EXIT.
       
       VAL-CLF-COD-AOCF SECTION.
       INI-VAL-CLF-COD-AOCF.
           IF CLF-COD-AOCF IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-AOCF IN CLF-FLD.
      *<<<< CLF_COD_AOCF
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF NOT = 'FGL'
      *AFRI-FIN-SEP-2005
           IF CLF-COD-AOCF IN CLF-FLD NOT > SPACES
              GO TO FIN-VAL-CLF-COD-AOCF.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN CLF-FLD TO
                                    WSS-TIP-OPE IN WSS-VARI.
           MOVE CLF-COD-AOCF IN CLF-FLD TO
                                    WSS-STP-OPE IN WSS-VARI.
           MOVE WSS-CLA-OPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-AOCF IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOCF IN CLF-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-AOCF IN CLF-FLD.
      *>>>>
      *<<<< FIN_CLF_COD_AOCF
           IF WSS-CIC-TOCF = 'CGE' AND
              CLF-COD-AOCF IN CLF-FLD > SPACES
                MOVE 'DEU'          TO MSG-COD-SIST
                MOVE 'AUXGR<>BLK' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CLF-COD-AOCF.
      *>>>>
       FIN-VAL-CLF-COD-AOCF.
           EXIT.
       
       VAL-FRM-GLS-VCCF SECTION.
       INI-VAL-FRM-GLS-VCCF.
       FIN-VAL-FRM-GLS-VCCF.
           EXIT.
       
       VAL-FRM-GLS-TOCF SECTION.
       INI-VAL-FRM-GLS-TOCF.
       FIN-VAL-FRM-GLS-TOCF.
           EXIT.
       
       VAL-FRM-GLS-AOCF SECTION.
       INI-VAL-FRM-GLS-AOCF.
       FIN-VAL-FRM-GLS-AOCF.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<< DBC_NUM_ICLI
           IF DBC-IND-ICLI IN CLF-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD
               GO TO FIN-VAL-DBC-NUM-ICLI.

            IF SCR-CCPP NOT = 'ING'
               GO TO FIN-VAL-DBC-NUM-ICLI.

            IF DBC-NUM-ICLI IN CLF-FLD = ZEROES
                MOVE 'TAB'        TO MSG-COD-SIST
                MOVE 'CLI    OBLIG' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-DBC-NUM-ICLI.
      *    IF SCR-INST = SCR-INST-GKY
      *        MOVE IDC-ZERO-S TO IDC-ZERO
      *    ELSE
      *        MOVE IDC-ZERO-N TO IDC-ZERO.

      *>>>>
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN CLF-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN CLF-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN CLF-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN CLF-FLD = 'M'
               MOVE ZEROES TO DBC-NUM-ICLI IN CLF-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN CLF-FLD
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    MDEU'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN CLF-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN CLF-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
      *<<<< NOT PGM_BNL
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN CLF-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO
                        DBC-IIC-ICLI IN CLF-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN CLF-FLD.

           IF SCR-CCPP = 'ING'
               PERFORM VAL-CON-RDC-CLF
               IF MSG-COD-MENS > SPACES
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN CLF-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN CLF-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN CLF-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN CLF-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN CLF-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN CLF-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN CLF-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN CLF-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-CLF-COD-OFIC SECTION.
       INI-VAL-CLF-COD-OFIC.
           IF CLF-COD-OFIC IN CLF-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-COD-OFIC.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE CLF-COD-OFIC IN CLF-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-OFIC IN CLF-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN CLF-FLD.
      *<<<< FIN_CLF_COD_OFIC
      *AMP INI   17-MAR-1994  INCORPORA CHEQUEO : OFICINA  = CAI O
      *                                           SUCURSAL = CAI
      *                       SI ES QUE LOS CORRELATIVOS SON POR SUCURS
      *                       (REQUIERE VAL-OFI Y CONTROLA 'COD    NEX')
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-VAL-CLF-COD-OFIC.
           IF WSS-VSN-OCAI NOT = 'S'
               GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP INI   18-MAR-1994  TRASLADADO AQUI Y MEJORADO
           IF SCR-CCPP NOT = 'ING'
               MOVE CLF-CAI-ICLF IN CLF-FLD TO CIC-CAI-ICIC IN CIC
               GO TO CON-VAL-CLF-COD-OFIC.
           MOVE 'L'                     TO CIC-COD-TCIC IN CIC.
      *AMP PRIMERO CHEQUEO CAI DE OFI Y SI NO HAY BUSCO CAI DE SUC
           MOVE CLF-COD-OFIC IN CLF-FLD TO CIC-COD-CCIC IN CIC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF FIO-STAT-OKS
               MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD
               GO TO FIN-VAL-CLF-COD-OFIC.
           MOVE OFI-COD-OFCO IN OFI     TO CIC-COD-CCIC IN CIC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CAI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-COD-OFIC.
           MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD.
       CON-VAL-CLF-COD-OFIC.
           IF NOT ( OFI-COD-OFIC IN OFI = CIC-COD-CCIC IN CIC OR
                    OFI-COD-OFCO IN OFI = CIC-COD-CCIC IN CIC )
               MOVE 'DEU'             TO MSG-COD-SIST
               MOVE 'CLFOFICINVL'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC      TO FRM-MENS
               MOVE FRM-SUAR-MAL      TO FRM-SUAR
               GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP FIN   18-MAR-1994  TRASLADADO AQUI Y MEJORADO
      *AMP INI   17-MAR-1994  INHABILITE ESTE PARRAFO PORQUE
      *                       VALIDA QUE OFICINA TENGA CAI  Y
      *                       CUANDO LO TIENE ASIGNA EL CAI A LA CLF
      *FLB CST   13-DEC-1993
      *    IF WSS-VSN-OCAI NOT = 'S'
      *        GO TO FIN-VAL-CLF-COD-OFIC.
      *
      *    MOVE 'L'                     TO CIC-COD-TCIC IN CIC.
      *    MOVE CLF-COD-OFIC IN CLF-FLD TO CIC-COD-CCIC IN CIC.
      *    MOVE CIC-CAI-ICIC IN CIC TO CLF-CAI-ICLF IN CLF-FLD.
      *    MOVE FIO-GET-KEY TO FIO-CMND.
      *    PERFORM GNS-FIO-CIC.
      *    IF NOT FIO-STAT-OKS
      *        MOVE 'GNS'        TO MSG-COD-SIST
      *        MOVE 'CAI    NEX' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-CLF-COD-OFIC.
      *AMP FIN   17-MAR-1994  INHABILITE ESTE PARRAFO PORQUE
      *>>>>
       FIN-VAL-CLF-COD-OFIC.
           EXIT.
       
       VAL-CLF-COD-EJEC SECTION.
       INI-VAL-CLF-COD-EJEC.
           IF CLF-COD-EJEC IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-EJEC IN CLF-FLD.
      *<<<< CLF_COD_EJEC
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE SPACES TO CLF-COD-EJEC IN CLF-FLD
              GO TO FIN-VAL-CLF-COD-EJEC.
      *AFRI-FIN-SEP-2005

      *FLB CST  06-DIC-1993 LEE TABLA VSN PARA INGRESAR EJECUTIVO O
      *                    TOMARLO DEL DBC
           MOVE 'DEU'               TO FIO-SIST.
           MOVE 'VSN '              TO TAB-COD-TTAB IN TAB.
           MOVE 'INGEJECUTIVO'      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               IF DBC-NUM-ICLI IN CLF-FLD NOT = ZEROES AND
                  CLF-COD-EJEC IN CLF-FLD NOT > SPACES
                   MOVE DBC-NUM-ICLI IN CLF-FLD TO DBC-NUM-ICLI IN DBC
                   MOVE DBC-IND-ICLI IN CLF-FLD TO DBC-IND-ICLI IN DBC
                   MOVE DBC-GLS-ICLI IN CLF-FLD TO DBC-GLS-ICLI IN DBC
                   MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM SGC-FIO-DBC
                   IF FIO-STAT-OKS AND DBC-COD-EJEC IN DBC > SPACES
                       MOVE DBC-COD-EJEC IN DBC TO
                            CLF-COD-EJEC IN CLF-FLD.

      *FLB CST  19-JUL-1994 VERIFICAR OBLIGATORIEDAD DE EJECUTIVO
           IF CLF-COD-EJEC IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-EJEC IN CLF-FLD
               PERFORM ERR-GLS
               GO TO FIN-VAL-CLF-COD-EJEC.

      *PRC-INI 06-DIC-2007 MARGEN ENDEUDAMIENTO
      *INHABILITE ESTE PARRAFO PORQUE SE INCORPORO LA FILIAL FACTORING
      *AL APROCRED, FILIAL QUE NO ES DEL TIPO (EJC).
      *>>>>
      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE CLF-COD-EJEC IN CLF-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              CLF-COD-EJEC IN CLF-FLD > SPACES
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN CLF-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN CLF-FLD.
      *<<<< FIN_CLF_COD_EJEC
      *>>>>
       FIN-VAL-CLF-COD-EJEC.
           EXIT.
       
       VAL-FRM-GLS-OFIC SECTION.
       INI-VAL-FRM-GLS-OFIC.
       FIN-VAL-FRM-GLS-OFIC.
           EXIT.
       
       VAL-FRM-GLS-EJEC SECTION.
       INI-VAL-FRM-GLS-EJEC.
       FIN-VAL-FRM-GLS-EJEC.
           EXIT.
       
       VAL-CLF-IND-RSTR SECTION.
       INI-VAL-CLF-IND-RSTR.
           IF CLF-IND-RSTR IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-IND-RSTR IN CLF-FLD.
      *<<<< CLF_IND_RSTR
           IF CLF-IND-RSTR IN CLF-FLD NOT > SPACES
                GO TO FIN-VAL-CLF-IND-RSTR.
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'IRES' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-IND-RSTR IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-CLF-IND-RSTR.
           EXIT.
       
       VAL-CLF-VAL-CMAX SECTION.
       INI-VAL-CLF-VAL-CMAX.
      *<<<< CLF_VAL_CMAX
      *AFRI-INI/SEP2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE ZEROES TO CLF-VAL-CMAX IN CLF-FLD
              GO TO FIN-VAL-CLF-VAL-CMAX.
      *AFRI-FIN/SEP2005
           IF CLF-VAL-CMAX IN CLF-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-VAL-CMAX.
      *>>>>
       FIN-VAL-CLF-VAL-CMAX.
           EXIT.
       
       VAL-CLF-IND-UCAP SECTION.
       INI-VAL-CLF-IND-UCAP.
      *<<<<
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE SPACES TO CLF-IND-UCAP IN CLF-FLD
              GO TO FIN-VAL-CLF-IND-UCAP.
      *AFRI-FIN-SEP-2005
      *>>>>
           IF CLF-IND-UCAP IN CLF-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-IND-UCAP.
      *<<<< CLF_IND_UCAP
           IF ( CLF-IND-UCAP IN CLF-FLD = 'A' OR 'B' ) AND
                CLF-VAL-CMAX IN CLF-FLD > 100
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'ERRVALUCAP' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CLF-IND-UCAP.
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'UCAP' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-IND-UCAP IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-IND-UCAP IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-UCAP IN CLF-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-UCAP IN CLF-FLD.
       FIN-VAL-CLF-IND-UCAP.
           EXIT.
       
       VAL-FRM-GLS-UCAP SECTION.
       INI-VAL-FRM-GLS-UCAP.
       FIN-VAL-FRM-GLS-UCAP.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FING SECTION.
       INI-VAL-CLF-FEC-FING.
           IF CLF-FEC-FING IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FING IN CLF-FLD.
      *<<<< CLF_FEC_FING
           IF CLF-FEC-FING IN CLF-FLD NOT > ZEROES
               MOVE HOY-DHOY TO CLF-NUM-DING IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MING IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SING IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AING IN CLF-FLD.
           MOVE CLF-FEC-FING IN CLF-FLD TO FEC-FECH.
      *>>>>
       FIN-VAL-CLF-FEC-FING.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FAPE SECTION.
       INI-VAL-CLF-FEC-FAPE.
           IF CLF-FEC-FAPE IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FAPE IN CLF-FLD.
      *VAL-FEC Validar Fecha
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CLF_FEC_FAPE

           IF CLF-FEC-FAPE IN CLF-FLD NOT > ZEROES
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN CLF-FLD
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN CLF-FLD
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN CLF-FLD
               MOVE HOY-AHOY TO CLF-NUM-AAPE IN CLF-FLD.

           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
      * MAE-INI  08-07-2011  HABILITA USO DE DIA FERIADO
      * MAE-INI  08-08-2011  HABILITA USO DE DIA FERIADO
      *    IF CLF-COD-TOCF IN CLF-FLD = 'CLF'
           IF CLF-COD-TOCF IN CLF-FLD = 'CLF' AND
              CLF-FEC-FAPE IN CLF-FLD > ZEROES
      * MAE-FIN  08-08-2011  HABILITA USO DE DIA FERIADO
               IF FEC-REST = FEC-AUXI OR FEC-SIND
                   MOVE FEC-SFER TO FEC-STAT
               ELSE
                   MOVE SPACES   TO FEC-MENS
                   MOVE FEC-SOKS TO FEC-STT1
                                    FEC-STT2.
      * MAE-FIN  08-07-2011  HABILITA USO DE DIA FERIADO
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FAPE IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
               MOVE FEC-MENS     TO FRM-MENS.
               GO TO FIN-VAL-CLF-FEC-FAPE.
           GO TO FIN-VAL-CLF-FEC-FAPE.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FAPE IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FAPE.
       FIN-VAL-CLF-FEC-FAPE.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CLF-NUM-PREV SECTION.
       INI-VAL-CLF-NUM-PREV.
      *<<<< CLF_NUM_PREV
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE ZEROES TO CLF-NUM-PREV IN CLF-FLD
              GO TO FIN-VAL-CLF-NUM-PREV.
      *AFRI-FIN-SEP-2005
      *FLB CST 18-FEB-1994 NO PERMITA NUM > 0 Y IND = SPACES
      *  Y VICEVERSA
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND
              CLF-IND-PREV IN CLF-FLD > SPACES
                  OR
              CLF-NUM-PREV IN CLF-FLD > ZEROES AND
              CLF-IND-PREV IN CLF-FLD NOT > SPACES
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPRVFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PREV.

      *FLB CST 18-FEB-1994 TRASLADADO AQUI POR ORDEN
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND
              CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'PREVFPRVBLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PREV.
      *>>>>
       FIN-VAL-CLF-NUM-PREV.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FURV SECTION.
       INI-VAL-CLF-FEC-FURV.
           IF CLF-FEC-FURV IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FURV IN CLF-FLD.
      *VAL-FEC Validar Fecha
           MOVE CLF-FEC-FURV IN CLF-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE ZEROES TO CLF-FEC-FURV IN CLF-FLD
              GO TO FIN-VAL-CLF-FEC-FURV.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
      * MAE-INI  08-07-2011  HABILITA USO DE DIA FERIADO
      * MAE-INI  08-08-2011  HABILITA USO DE DIA FERIADO
      *    IF CLF-COD-TOCF IN CLF-FLD = 'CLF'
           IF CLF-COD-TOCF IN CLF-FLD = 'CLF' AND
              CLF-FEC-FURV IN CLF-FLD > ZEROES
      * MAE-FIN  08-08-2011  HABILITA USO DE DIA FERIADO
               IF FEC-REST = FEC-AUXI OR FEC-SIND
                   MOVE FEC-SFER TO FEC-STAT
               ELSE
                   MOVE SPACES   TO FEC-MENS
                   MOVE FEC-SOKS TO FEC-STT1
                                    FEC-STT2.
      * MAE-FIN  08-07-2011  HABILITA USO DE DIA FERIADO
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FURV IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FURV.
           GO TO FIN-VAL-CLF-FEC-FURV.
      *AFRI-FIN-SEP-2005
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FURV IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FURV.
       FIN-VAL-CLF-FEC-FURV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CLF-IND-PREV SECTION.
       INI-VAL-CLF-IND-PREV.
      *<<<<
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE SPACES TO CLF-IND-PREV IN CLF-FLD
              GO TO FIN-VAL-CLF-IND-PREV.
      *AFRI-FIN-SEP-2005
      *>>>>
           IF CLF-IND-PREV IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-IND-PREV IN CLF-FLD.
      *<<<< CLF_IND_PREV
           IF CLF-NUM-PREV IN CLF-FLD = ZEROES AND
              CLF-IND-PREV IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PREV IN CLF-FLD
               GO TO FIN-VAL-CLF-IND-PREV.
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-IND-PREV IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-IND-PREV IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PREV IN CLF-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PREV IN CLF-FLD.
       FIN-VAL-CLF-IND-PREV.
           EXIT.
       
       VAL-FRM-GLS-PREV SECTION.
       INI-VAL-FRM-GLS-PREV.
       FIN-VAL-FRM-GLS-PREV.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FPRV SECTION.
       INI-VAL-CLF-FEC-FPRV.
           IF CLF-FEC-FPRV IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FPRV IN CLF-FLD.
      *VAL-FEC Validar Fecha
           MOVE CLF-FEC-FPRV IN CLF-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CLF_FEC_FPRV
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE ZEROES TO CLF-FEC-FPRV IN CLF-FLD
              GO TO FIN-VAL-CLF-FEC-FPRV.
      *AFRI-FIN-SEP-2005

      * COMANDO REV FUNCIONA IGUAL QUE ING, SALVO POR DIFERENTE F. INICI
      *   EN RUTINA OBT-FPRV

      * SI LLENO EL PERIODO, VACIA LA FECHA
           IF CLF-NUM-PREV IN CLF-FLD > ZEROES AND
      *FLB CST  31-JAN-1994 OBSERVACION DE MOR EN BRB
      *       CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES OR
      *       SCR-CMND = CMND-REV
              CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES
               PERFORM OBT-FPRV
               MOVE WSS-NUM-DPRV IN WSS-VARI TO
                                        CLF-NUM-DPRV IN CLF-FLD
               MOVE WSS-NUM-MPRV IN WSS-VARI TO
                                        CLF-NUM-MPRV IN CLF-FLD
               MOVE WSS-NUM-SPRV IN WSS-VARI TO
                                        CLF-NUM-SPRV IN CLF-FLD
               MOVE WSS-NUM-APRV IN WSS-VARI TO
                                        CLF-NUM-APRV IN CLF-FLD.

           MOVE CLF-FEC-FPRV IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FPRV IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FPRV.
      *<<<< CLF_FEC_FPRV

      * CASO PERIODO VACIO, LLENA LA FECHA, OBTIENE PERIODO EN AGNOS
           IF CLF-NUM-PREV IN CLF-FLD NOT > ZEROES AND
              CLF-IND-PREV IN CLF-FLD NOT > SPACES AND
              CLF-FEC-FPRV IN CLF-FLD > ZEROES
               PERFORM OBT-PREV.

      * VALIDA QUE FURV < FPRV
           MOVE CLF-NUM-DPRV IN CLF-FLD TO WSS-NUM-DPR1 IN WSS-VARI.
           MOVE CLF-NUM-MPRV IN CLF-FLD TO WSS-NUM-MPR1 IN WSS-VARI.
           MOVE CLF-NUM-SPRV IN CLF-FLD TO WSS-NUM-SPR1 IN WSS-VARI.
           MOVE CLF-NUM-APRV IN CLF-FLD TO WSS-NUM-APR1 IN WSS-VARI.
           MOVE CLF-NUM-DURV IN CLF-FLD TO WSS-NUM-DVE2 IN WSS-VARI.
           MOVE CLF-NUM-MURV IN CLF-FLD TO WSS-NUM-MVE2 IN WSS-VARI.
           MOVE CLF-NUM-SURV IN CLF-FLD TO WSS-NUM-SVE2 IN WSS-VARI.
           MOVE CLF-NUM-AURV IN CLF-FLD TO WSS-NUM-AVE2 IN WSS-VARI.
           IF WSS-FEC-FPR1 IN WSS-VARI NOT > WSS-FEC-FVE2 IN WSS-VARI
               MOVE 'DEU'         TO MSG-COD-SIST
               MOVE 'FPRVNO>FURV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-FEC-FPRV.
      *>>>>
       FIN-VAL-CLF-FEC-FPRV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CLF-NUM-PVIG SECTION.
       INI-VAL-CLF-NUM-PVIG.
      *<<<<
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE ZEROES TO CLF-NUM-PVIG IN CLF-FLD
              GO TO FIN-VAL-CLF-NUM-PVIG.
      *AFRI-FIN-SEP-2005
      *>>>>
           IF CLF-NUM-PVIG IN CLF-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-NUM-PVIG.
      *<<<< CLF_NUM_PVIG

      *FLB CST 18-FEB-1994 NO PERMITA NUM > 0 Y IND = SPACES
      *  Y VICEVERSA
           IF CLF-NUM-PVIG IN CLF-FLD = ZEROES AND
              CLF-IND-PVIG IN CLF-FLD > SPACES
                  OR
              CLF-NUM-PVIG IN CLF-FLD > ZEROES AND
              CLF-IND-PVIG IN CLF-FLD NOT > SPACES
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPVGFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-NUM-PVIG.
      *>>>>
       FIN-VAL-CLF-NUM-PVIG.
           EXIT.
       
       VAL-CLF-IND-PVIG SECTION.
       INI-VAL-CLF-IND-PVIG.
      *<<<< INI_CLF_IND_PVIG
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
              MOVE SPACES TO CLF-IND-PVIG IN CLF-FLD
              GO TO FIN-VAL-CLF-IND-PVIG.
      *AFRI-FIN-SEP-2005
      *>>>>
           IF CLF-IND-PVIG IN CLF-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CLF-IND-PVIG.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-IND-PVIG IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-IND-PVIG IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PVIG IN CLF-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PVIG IN CLF-FLD.
       FIN-VAL-CLF-IND-PVIG.
           EXIT.
       
       VAL-FRM-GLS-PVIG SECTION.
       INI-VAL-FRM-GLS-PVIG.
       FIN-VAL-FRM-GLS-PVIG.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FVEN SECTION.
       INI-VAL-CLF-FEC-FVEN.
           IF CLF-FEC-FVEN IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FVEN IN CLF-FLD.
      *VAL-FEC Validar Fecha
           MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CLF_FEC_FVEN
      *FLB CST  20-JUL-1994 PARA MANTENER CONSISTENCIA EN
      * VENCIMENTO DE CLF VS. VENCTOS DE LDC'S, SI RETROCEDE LA F.APE
           IF SCR-CMND = CMND-ACA
               GO TO FIN-VAL-CLF-FEC-FVEN.

      *FLB 11/NOV/92
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
               MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FECH
               MOVE FEC-FBLK-N  TO FEC-FBLK
               MOVE FEC-CHOY-N  TO FEC-CHOY
               MOVE FEC-VHBL-S TO FEC-VHBL
               GO TO CON-VAL-CLF-FEC-FVEN.
      *AFRI-FIN-SEP-2005
           PERFORM OBT-FVEN.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO CLF-NUM-DVEN IN CLF-FLD.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO CLF-NUM-MVEN IN CLF-FLD.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO CLF-NUM-SVEN IN CLF-FLD.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO CLF-NUM-AVEN IN CLF-FLD.

           MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FECH.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *AFRI-INI-SEP-2005
       CON-VAL-CLF-FEC-FVEN.
      *AFRI-FIN-SEP-2005
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FVEN IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FVEN.
      *<<<< CLF_FEC_FVEN
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
           MOVE CLF-NUM-DVEN IN CLF-FLD TO WSS-NUM-DVE1 IN WSS-VARI
           MOVE CLF-NUM-MVEN IN CLF-FLD TO WSS-NUM-MVE1 IN WSS-VARI
           MOVE CLF-NUM-SVEN IN CLF-FLD TO WSS-NUM-SVE1 IN WSS-VARI
           MOVE CLF-NUM-AVEN IN CLF-FLD TO WSS-NUM-AVE1 IN WSS-VARI
           MOVE CLF-NUM-DAPE IN CLF-FLD TO WSS-NUM-DPR1 IN WSS-VARI
           MOVE CLF-NUM-MAPE IN CLF-FLD TO WSS-NUM-MPR1 IN WSS-VARI
           MOVE CLF-NUM-SAPE IN CLF-FLD TO WSS-NUM-SPR1 IN WSS-VARI
           MOVE CLF-NUM-AAPE IN CLF-FLD TO WSS-NUM-APR1 IN WSS-VARI
           IF WSS-FEC-FPR1 IN WSS-VARI > WSS-FEC-FVE1 IN WSS-VARI
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'FAPE>FVEN'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CLF-FEC-FVEN
           ELSE
               GO TO FIN-VAL-CLF-FEC-FVEN.
      *AFRI-FIN-SEP-2005

       VAL-PRV-VEN.
      *FLB 28/OCT/92
           IF CLF-FEC-FPRV IN CLF-FLD NOT > ZEROES AND
              SCR-CMND = CMND-ACA
               MOVE CLF-FEC-FVEN IN CLF-FLD TO CLF-FEC-FPRV IN CLF-FLD
               MOVE CLF-NUM-PVIG IN CLF-FLD TO CLF-NUM-PREV IN CLF-FLD
               MOVE CLF-IND-PVIG IN CLF-FLD TO CLF-IND-PREV IN CLF-FLD
               MOVE FRM-GLS-PVIG IN CLF-FLD TO FRM-GLS-PREV IN CLF-FLD
               GO TO FIN-VAL-CLF-FEC-FVEN.

           MOVE CLF-NUM-DVEN IN CLF-FLD TO WSS-NUM-DVE1 IN WSS-VARI.
           MOVE CLF-NUM-MVEN IN CLF-FLD TO WSS-NUM-MVE1 IN WSS-VARI.
           MOVE CLF-NUM-SVEN IN CLF-FLD TO WSS-NUM-SVE1 IN WSS-VARI.
           MOVE CLF-NUM-AVEN IN CLF-FLD TO WSS-NUM-AVE1 IN WSS-VARI.
           MOVE CLF-NUM-DPRV IN CLF-FLD TO WSS-NUM-DPR1 IN WSS-VARI.
           MOVE CLF-NUM-MPRV IN CLF-FLD TO WSS-NUM-MPR1 IN WSS-VARI.
           MOVE CLF-NUM-SPRV IN CLF-FLD TO WSS-NUM-SPR1 IN WSS-VARI.
           MOVE CLF-NUM-APRV IN CLF-FLD TO WSS-NUM-APR1 IN WSS-VARI.

           IF WSS-FEC-FPR1 IN WSS-VARI > WSS-FEC-FVE1 IN WSS-VARI
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'FPRV>FVEN'  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
      *ISP-ANL-INI 2-MAR-1998 11:21:47
              MOVE WSS-FEC-FPR1 IN WSS-VARI TO WSS-ERR-FPR1
              MOVE WSS-FEC-FVE1 IN WSS-VARI TO WSS-ERR-FVE1
              MOVE MSG-GLS-DESC TO WSS-ERR-DESC
              MOVE WSS-ERR TO FRM-MENS
      *ISP-ANL-FIN 2-MAR-1998 11:21:47
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -1  TO CLF-FEC-FPRV-LEN  IN CLF-FLD
              MOVE 'S' TO FRM-UCUR
              GO TO FIN-VAL-CLF-FEC-FVEN.

      * INI_LTM 06-10-93
           IF CLF-NUM-PVIG IN CLF-FLD = 0 AND
              CLF-FEC-FVEN IN CLF-FLD NOT = ZEROS
               MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FEC1
               MOVE CLF-FEC-FVEN IN CLF-FLD TO FEC-FEC2
               MOVE FEC-FORM-FEC            TO FEC-FORM
               MOVE FEC-DIF-ANO             TO FEC-CMND
               PERFORM CAL-FEC
               IF FEC-STAT-OKS
                   IF FEC-NANO > 0
                       MOVE FEC-NANO TO CLF-NUM-PVIG IN CLF-FLD
                       MOVE 'A'      TO CLF-IND-PVIG IN CLF-FLD
                   ELSE
                       MOVE 1        TO CLF-NUM-PVIG IN CLF-FLD
                       MOVE 'A'      TO CLF-IND-PVIG IN CLF-FLD
               ELSE
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE FEC-MENS     TO FRM-MENS.
      * FIN_LTM 06-10-93
      *>>>>
       FIN-VAL-CLF-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CLF-VAL-COMI SECTION.
       INI-VAL-CLF-VAL-COMI.
       FIN-VAL-CLF-VAL-COMI.
           EXIT.
       
       VAL-CLF-IND-COMI SECTION.
       INI-VAL-CLF-IND-COMI.
           IF CLF-IND-COMI IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-IND-COMI IN CLF-FLD.
      *<<<< CLF_IND_COMI
      *AFRI-INI-SEP-2005
           IF WSS-CIC-TOCF = 'FGL'
               MOVE SPACES TO CLF-IND-COMI IN CLF-FLD
               GO TO FIN-VAL-CLF-IND-COMI.
      *AFRI-FIN-SEP-2005
           IF CLF-IND-COMI IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-IND-COMI IN CLF-FLD.

           IF CLF-VAL-COMI IN CLF-FLD = ZEROES AND
              CLF-IND-COMI IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COMI IN CLF-FLD
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-VAL-COMI IN CLF-FLD = ZEROES
               MOVE 'DEU'     TO MSG-COD-SIST
               MOVE 'COMI=0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-VAL-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF (CLF-VAL-COMI-ALF IN CLF-FLD NOT = SPACES AND
               CLF-VAL-COMI-ALF IN CLF-FLD > ZEROES)    AND
              (CLF-IND-COMI IN CLF-FLD = SPACES)
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'INDI=0'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-IND-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-IND-COMI IN CLF-FLD = 'P' AND
              CLF-VAL-COMI IN CLF-FLD > 100
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INDCOM<>P' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-IND-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.

           IF CLF-VAL-COMI IN CLF-FLD > CLF-VAL-CMAX IN CLF-FLD
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'COMI>CMAX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO CLF-VAL-COMI-LEN  IN CLF-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-CLF-IND-COMI.
      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'ICOM' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-IND-COMI IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-IND-COMI IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COMI IN CLF-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-COMI IN CLF-FLD.
       FIN-VAL-CLF-IND-COMI.
           EXIT.
       
       VAL-FRM-GLS-COMI SECTION.
       INI-VAL-FRM-GLS-COMI.
       FIN-VAL-FRM-GLS-COMI.
           EXIT.
       
       VAL-CLF-CAI-ICAC SECTION.
       INI-VAL-CLF-CAI-ICAC.
           IF CLF-CAI-ICAC IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-CAI-ICAC IN CLF-FLD.
       FIN-VAL-CLF-CAI-ICAC.
           EXIT.
       
       VAL-CLF-IIC-ICAC SECTION.
       INI-VAL-CLF-IIC-ICAC.
      *<<<< CLF_IIC_ICAC
      *EFECTUA VAL. DE CTA.CTE. EN PANT. CLF
           IF CLF-IIC-ICAC IN CLF-FLD NOT > ZEROES
               GO TO NO-VAL-CLF-IIC-ICAC.

           MOVE DBC-CAI-ICLI IN CLF-FLD TO RCO-CAI-ICLI IN RCO.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO RCO-IIC-ICLI IN RCO.
           MOVE CLF-CAI-ICAC IN CLF-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CLF-IIC-ICAC IN CLF-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               GO TO CER-VAL-CLF-IIC-ICAC.

           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE CLF-CAI-ICAC IN CLF-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CLF-IIC-ICAC IN CLF-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CICICACNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CLF-IIC-ICAC
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'IICICACNOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

       CER-VAL-CLF-IIC-ICAC.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF OPE-FEC-FTOP IN OPE > ZEROES AND
              OPE-FEC-FTOP IN OPE > OPE-FEC-FROP IN OPE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FECFTOPCCCER' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *CON OPE ENCONTRADA VALIDA QUE SEA CUENTA CORRIENTE
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPE-COD-TOPR IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-CIC-CTAB IN TAB = 'CCT' )
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICTOPRNOCCT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPE-COD-TOPR IN OPE TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.

      *CON OPE ENCONTRADA VALIDA QUE ESTE VIGENTE
           IF OPE-COD-STAT IN OPE NOT = 'VIG'
               MOVE 'DEU'      TO MSG-COD-SIST
               MOVE 'OPENOVIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPE-COD-TOPR IN OPE TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.

      *CON OPE ENCONTRADA VALIDA QUE SEA MONEDA NACIONAL NO REAJUSTABLE
           IF OPE-COD-VCOP IN OPE NOT = '0999'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'OPEVCOPNOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC        TO FRM-MEN1
               MOVE OPE-COD-TOPR IN OPE TO FRM-MEN2
               MOVE FRM-SUAR-MAL        TO FRM-SUAR.
       NO-VAL-CLF-IIC-ICAC.
      *>>>>
       FIN-VAL-CLF-IIC-ICAC.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-CLF-FEC-FCIE SECTION.
       INI-VAL-CLF-FEC-FCIE.
           IF CLF-FEC-FCIE IN CLF-FLD  NOT > ZEROES
              MOVE ZEROES TO CLF-FEC-FCIE IN CLF-FLD.
      *VAL-FEC Validar Fecha
           MOVE CLF-FEC-FCIE IN CLF-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_CLF_FEC_FCIE
      *AFRI-INI-OCT-2005
           IF SCR-CMND = CMND-CLC AND
              CLF-FEC-FCIE IN CLF-FLD NOT > ZEROES
              MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
              MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
              MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
              MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD.
      *AFRI-FIN-OCT-2005
           IF SCR-CMND = CMND-CIE AND
              CLF-FEC-FCIE IN CLF-FLD NOT > ZEROES
              MOVE HOY-DHOY TO CLF-NUM-DCIE IN CLF-FLD
              MOVE HOY-MHOY TO CLF-NUM-MCIE IN CLF-FLD
              MOVE HOY-SHOY TO CLF-NUM-SCIE IN CLF-FLD
              MOVE HOY-AHOY TO CLF-NUM-ACIE IN CLF-FLD.

           MOVE CLF-FEC-FCIE IN CLF-FLD TO FEC-FECH.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
      * MAE-INI  08-07-2011  HABILITA USO DE DIA FERIADO
      * MAE-INI  08-08-2011  HABILITA USO DE DIA FERIADO
      *    IF CLF-COD-TOCF IN CLF-FLD = 'CLF'
           IF CLF-COD-TOCF IN CLF-FLD = 'CLF' AND
              CLF-FEC-FCIE IN CLF-FLD > ZEROES
      * MAE-FIN  08-08-2011  HABILITA USO DE DIA FERIADO
               IF FEC-REST = FEC-AUXI OR FEC-SIND
                   MOVE FEC-SFER TO FEC-STAT
               ELSE
                   MOVE SPACES   TO FEC-MENS
                   MOVE FEC-SOKS TO FEC-STT1
                                    FEC-STT2.
      * MAE-FIN  08-07-2011  HABILITA USO DE DIA FERIADO
      *>>>>
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FCIE IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FCIE.
           GO TO FIN-VAL-CLF-FEC-FCIE.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CLF-FEC-FCIE IN CLF-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-CLF-FEC-FCIE.
       FIN-VAL-CLF-FEC-FCIE.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CLF-CAI-CREN SECTION.
       INI-VAL-CLF-CAI-CREN.
       FIN-VAL-CLF-CAI-CREN.
           EXIT.
       
       VAL-CLF-IIC-CREN SECTION.
       INI-VAL-CLF-IIC-CREN.
       FIN-VAL-CLF-IIC-CREN.
           EXIT.
       
       VAL-CLF-COD-RAZC SECTION.
       INI-VAL-CLF-COD-RAZC.
           IF CLF-COD-RAZC IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-RAZC IN CLF-FLD.
      *<<<< CLF_COD_RAZC
           IF SCR-CMND NOT = CMND-CIE
      *AFRI-INI-OCT2005
              AND SCR-CMND NOT = CMND-CLC
      *AFRI-INI-OCT2005
               GO TO FIN-VAL-CLF-COD-RAZC.

           IF CLF-COD-RAZC IN CLF-FLD NOT > SPACES
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'RAZCOBLIG' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CLF-COD-RAZC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'RZC ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-RAZC IN CLF-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-RAZC IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-RAZC IN CLF-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-RAZC IN CLF-FLD.
       FIN-VAL-CLF-COD-RAZC.
           EXIT.
       
       VAL-FRM-GLS-RAZC SECTION.
       INI-VAL-FRM-GLS-RAZC.
       FIN-VAL-FRM-GLS-RAZC.
           EXIT.
       
       VAL-CLF-MSC-STAT SECTION.
       INI-VAL-CLF-MSC-STAT.
           IF CLF-MSC-STAT IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-MSC-STAT IN CLF-FLD.
      *<<<< CLF_MSC_STAT
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO CLF-MSC-STAT IN CLF-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'DEU' TO MSC-COD-SIST.
           MOVE 'STA ' TO MSC-COD-TMSC IN MSC.
           MOVE CLF-MSC-STAT IN CLF-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-MSC-STAT IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STAT IN CLF-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-STAT IN CLF-FLD.
      *>>>>
       FIN-VAL-CLF-MSC-STAT.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-CLF-COD-CAPR SECTION.
       INI-VAL-CLF-COD-CAPR.
           IF CLF-COD-CAPR IN CLF-FLD NOT > SPACES
              MOVE SPACES TO CLF-COD-CAPR IN CLF-FLD.
      *<<<< FIN_CLF_COD_CAPR
      *ADA-INI 15-NOV-2002
      *<<<< INI_CLF_COD_CAPR
      *Si el programa se invoca desde CICS siempre el canal debe ser
      *'07'
           IF ( NOT SCR-OFRM-SRV ) AND
      *RVM-ADA-INI 10.08.2004
      *       ( SCR-CMND = 'ING' OR 'MOD' OR 'MCA' )
              ( SCR-CMND = 'ING' OR 'MOD' OR 'MCA' ) AND
              CLF-COD-CAPR IN CLF-FLD NOT > SPACES
      *RVM-ADA-FIN 10.08.2004
               MOVE '07' TO CLF-COD-CAPR IN CLF-FLD.
      *>>>>
      *ADA-FIN 15-NOV-2002
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CAP ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-CAPR IN CLF-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              CLF-COD-CAPR IN CLF-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-CAPR IN CLF-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CAPR IN CLF-FLD.

      *RVM-ADA-INI 10.08.2004
           IF NOT ( FRM-SUAR = FRM-SUAR-MAL)
      *ESTOY EN CICS
              IF ( NOT SCR-OFRM-SRV )
                 IF NOT ( TAB-CIC-CTAB IN TAB = '07' OR '13' )
                    MOVE FRM-SUAR-MAL  TO FRM-SUAR
                    MOVE 'DEU'         TO MSG-COD-SIST
                    MOVE 'CAPRCICSNO'  TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE FRM-SUAR-MAL  TO FRM-SUAR
                    GO TO FIN-VAL-CLF-COD-CAPR
                 END-IF
              END-IF
           END-IF.
      *RVM-ADA-INI 10.08.2004
      *>>>>>
       FIN-VAL-CLF-COD-CAPR.
           EXIT.
       
       VAL-FRM-GLS-CAPR SECTION.
       INI-VAL-FRM-GLS-CAPR.
       FIN-VAL-FRM-GLS-CAPR.
           EXIT.
       
       VAL-CON-FLD-CLF SECTION.
       INI-VAL-CON-FLD-CLF.
      *<<<< VAL_CON_FLD_CLF
      * CODIGO PARA VALIDAR LIMITES DE APROBACION CEM (solo en ACA)
           IF SCR-CMND NOT = CMND-ACA
               GO TO FIN-VAL-CON-FLD-CLF.

      *FLB CST  18-MAY-1994 DEJA EN COPY EN LDCPUCLF APROBACION LAC
           PERFORM LDC-PRO-LAC.
      *>>>>
       FIN-VAL-CON-FLD-CLF.
           EXIT.
       
       VAL-CON-CLF SECTION.
       INI-VAL-CON-CLF.
       FIN-VAL-CON-CLF.
           EXIT.
       
       VAL-NUM-KEY-CLF SECTION.
       INI-VAL-NUM-KEY-CLF.
           PERFORM VAL-NUM-IKY-CLF.
           PERFORM VAL-NUM-MKY-CLF.
           PERFORM VAL-NUM-AKY-CLF.
       FIN-VAL-NUM-KEY-CLF.
           EXIT.
       
       VAL-NUM-IKY-CLF SECTION.
       INI-VAL-NUM-IKY-CLF.
       VAL-NUM-CLF-IIC-ICLF.
           MOVE CLF-IIC-ICLF-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-IIC-ICLF IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-IIC-ICLF-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-IKY-CLF.
       FIN-VAL-NUM-IKY-CLF.
           EXIT.
       
       VAL-NUM-MKY-CLF SECTION.
       INI-VAL-NUM-MKY-CLF.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-MKY-CLF.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-IIC-ICLI.
           MOVE DBC-IIC-ICLI-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-IIC-ICLI IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-IIC-ICLI-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-MKY-CLF.
       FIN-VAL-NUM-MKY-CLF.
           EXIT.
       
       VAL-NUM-AKY-CLF SECTION.
       INI-VAL-NUM-AKY-CLF.
       FIN-VAL-NUM-AKY-CLF.
           EXIT.
       
       VAL-NUM-FLD-CLF SECTION.
       INI-VAL-NUM-FLD-CLF.
       VAL-NUM-CLF-VAL-CMAX.
           MOVE CLF-VAL-CMAX-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-VAL-CMAX IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-VAL-CMAX-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-FLD-CLF.
       VAL-NUM-CLF-NUM-PREV.
           MOVE CLF-NUM-PREV-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-NUM-PREV IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-NUM-PREV-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-FLD-CLF.
       VAL-NUM-CLF-NUM-PVIG.
           MOVE CLF-NUM-PVIG-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-NUM-PVIG IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-NUM-PVIG-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-FLD-CLF.
       VAL-NUM-CLF-VAL-COMI.
           MOVE CLF-VAL-COMI-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-VAL-COMI IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-VAL-COMI-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-FLD-CLF.
       VAL-NUM-CLF-IIC-ICAC.
           MOVE CLF-IIC-ICAC-ALF IN CLF-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-IIC-ICAC IN CLF-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-IIC-ICAC-LEN IN CLF-FLD
                GO TO FIN-VAL-NUM-FLD-CLF.
       FIN-VAL-NUM-FLD-CLF.
           EXIT.
       
       EDT-KEY-CLF SECTION.
       INI-EDT-KEY-CLF.
           PERFORM EDT-IKY-CLF.
           PERFORM EDT-MKY-CLF.
           PERFORM EDT-AKY-CLF.
       FIN-EDT-KEY-CLF.
           EXIT.
       
       EDT-IKY-CLF SECTION.
       INI-EDT-IKY-CLF.
           IF CLF-IIC-ICLF-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-IIC-ICLF-LEN IN CLF-FLD
                GO TO FIN-EDT-IKY-CLF.
           MOVE CLF-IIC-ICLF IN CLF-FLD TO CLF-IIC-ICLF-EDT IN CLF-EDT.
           MOVE CLF-IIC-ICLF-EDT IN CLF-EDT TO 
                CLF-IIC-ICLF-ALF IN CLF-FLD.
       FIN-EDT-IKY-CLF.
           EXIT.
       
       EDT-MKY-CLF SECTION.
       INI-EDT-MKY-CLF.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN CLF-FLD
                GO TO FIN-EDT-MKY-CLF.
           MOVE DBC-NUM-ICLI IN CLF-FLD TO
                DBC-NUM-ICLI-EDT IN CLF-EDT.
           MOVE DBC-NUM-ICLI-EDT IN CLF-EDT TO
                DBC-NUM-ICLI-ALF IN CLF-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-IIC-ICLI-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-IIC-ICLI-LEN IN CLF-FLD
                GO TO FIN-EDT-MKY-CLF.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO DBC-IIC-ICLI-EDT IN CLF-EDT.
           MOVE DBC-IIC-ICLI-EDT IN CLF-EDT TO 
                DBC-IIC-ICLI-ALF IN CLF-FLD.
       FIN-EDT-MKY-CLF.
           EXIT.
       
       EDT-AKY-CLF SECTION.
       INI-EDT-AKY-CLF.
       FIN-EDT-AKY-CLF.
           EXIT.
       
       EDT-FLD-CLF SECTION.
       INI-EDT-FLD-CLF.
           IF CLF-VAL-CMAX-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-VAL-CMAX-LEN IN CLF-FLD
                GO TO FIN-EDT-FLD-CLF.
           MOVE CLF-VAL-CMAX IN CLF-FLD TO CLF-VAL-CMAX-EDT IN CLF-EDT.
           MOVE CLF-VAL-CMAX-EDT IN CLF-EDT TO 
                CLF-VAL-CMAX-ALF IN CLF-FLD.
           IF CLF-NUM-PREV-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-NUM-PREV-LEN IN CLF-FLD
                GO TO FIN-EDT-FLD-CLF.
           MOVE CLF-NUM-PREV IN CLF-FLD TO CLF-NUM-PREV-EDT IN CLF-EDT.
           MOVE CLF-NUM-PREV-EDT IN CLF-EDT TO 
                CLF-NUM-PREV-ALF IN CLF-FLD.
           IF CLF-NUM-PVIG-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-NUM-PVIG-LEN IN CLF-FLD
                GO TO FIN-EDT-FLD-CLF.
           MOVE CLF-NUM-PVIG IN CLF-FLD TO CLF-NUM-PVIG-EDT IN CLF-EDT.
           MOVE CLF-NUM-PVIG-EDT IN CLF-EDT TO 
                CLF-NUM-PVIG-ALF IN CLF-FLD.
           IF CLF-VAL-COMI-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-VAL-COMI-LEN IN CLF-FLD
                GO TO FIN-EDT-FLD-CLF.
           MOVE CLF-VAL-COMI IN CLF-FLD TO CLF-VAL-COMI-EDT IN CLF-EDT.
           MOVE CLF-VAL-COMI-EDT IN CLF-EDT TO 
                CLF-VAL-COMI-ALF IN CLF-FLD.
           IF CLF-IIC-ICAC-LEN IN CLF-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-IIC-ICAC-LEN IN CLF-FLD
                GO TO FIN-EDT-FLD-CLF.
           MOVE CLF-IIC-ICAC IN CLF-FLD TO CLF-IIC-ICAC-EDT IN CLF-EDT.
           MOVE CLF-IIC-ICAC-EDT IN CLF-EDT TO 
                CLF-IIC-ICAC-ALF IN CLF-FLD.
       FIN-EDT-FLD-CLF.
           EXIT.
      *<<<< EOF_BU

       OBT-FVEN SECTION.
       INI-OBT-FVEN.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           IF CLF-IND-PVIG IN CLF-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NDIA
           ELSE
           IF CLF-IND-PVIG IN CLF-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NMES
           ELSE
           IF CLF-IND-PVIG IN CLF-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE CLF-NUM-PVIG IN CLF-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AVEN IN WSS-VARI.
       FIN-OBT-FVEN.
           EXIT.

       OBT-PREV SECTION.
       INI-OBT-PREV.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FEC1.
           IF SCR-CMND = CMND-REV
               MOVE CLF-FEC-FURV IN CLF-FLD TO FEC-FEC1.
           MOVE CLF-FEC-FPRV IN CLF-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-ANO  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               IF FEC-NANO > 0
                   MOVE FEC-NANO TO CLF-NUM-PREV IN CLF-FLD
                   MOVE 'A'      TO CLF-IND-PREV IN CLF-FLD
               ELSE
                   MOVE 1        TO CLF-NUM-PREV IN CLF-FLD
                   MOVE 'A'      TO CLF-IND-PREV IN CLF-FLD
           ELSE
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FEC-MENS     TO FRM-MENS.
       FIN-OBT-PREV.
           EXIT.

       OBT-FPRV SECTION.
       INI-OBT-FPRV.
           MOVE CLF-FEC-FAPE IN CLF-FLD TO FEC-FECH.
           IF SCR-CMND = CMND-REV
               MOVE CLF-FEC-FURV IN CLF-FLD TO FEC-FECH.
           IF CLF-IND-PREV IN CLF-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NDIA
           ELSE
           IF CLF-IND-PREV IN CLF-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NMES
           ELSE
           IF CLF-IND-PREV IN CLF-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE CLF-NUM-PREV IN CLF-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DPRV IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MPRV IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SPRV IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-APRV IN WSS-VARI.
           IF SCR-CCPP NOT = 'ING'
               MOVE CLF-NUM-DVEN IN CLF-FLD TO
                                   WSS-NUM-DVE1 IN WSS-VARI
               MOVE CLF-NUM-MVEN IN CLF-FLD TO
                                   WSS-NUM-MVE1 IN WSS-VARI
               MOVE CLF-NUM-SVEN IN CLF-FLD TO
                                   WSS-NUM-SVE1 IN WSS-VARI
               MOVE CLF-NUM-AVEN IN CLF-FLD TO
                                   WSS-NUM-AVE1 IN WSS-VARI
               IF WSS-FEC-FPRV IN WSS-VARI > WSS-FEC-FVE1
                                                IN WSS-VARI
                  MOVE WSS-NUM-DVE1 IN WSS-VARI TO
                                   WSS-NUM-DPRV IN WSS-VARI
                  MOVE WSS-NUM-MVE1 IN WSS-VARI TO
                                   WSS-NUM-MPRV IN WSS-VARI
                  MOVE WSS-NUM-SVE1 IN WSS-VARI TO
                                   WSS-NUM-SPRV IN WSS-VARI
                  MOVE WSS-NUM-AVE1 IN WSS-VARI TO
                                   WSS-NUM-APRV IN WSS-VARI.
       FIN-OBT-FPRV.
           EXIT.

      *>>>>
      *<<<< EOF
       VAL-CON-RDC-CLF SECTION.
       INI-VAL-CON-RDC-CLF.
           MOVE SPACES TO MSG-COD-MENS.
      *<<<< NOT PGM_BNL
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-CAI-ICLF IN RDC.
           MOVE ZEROES              TO RDC-IIC-ICLF IN RDC.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
      *<<<< NOT PGM_BNL
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )
      *>>>>
              IF FIO-STAT-OKS
                  GO TO BRW-VAL-CON-RDC-CLF
              ELSE
                  GO TO FIN-VAL-CON-RDC-CLF.

       LUP-VAL-CON-RDC-CLF.
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO BRW-VAL-CON-RDC-CLF.

           IF CLF-MSC-STAT IN CLF NOT = 'C' AND
              CLF-MSC-STAT IN CLF NOT = 'R'
      *AFRI-INI-OCT2005
              AND CLF-MSC-STAT IN CLF NOT = 'N'
      *AFRI-FIN-OCT2005
      *MHM-INI 25-MAY-2004
              AND CLF-COD-TOCF IN CLF = CLF-COD-TOCF IN CLF-FLD
              AND CLF-COD-AOCF IN CLF = CLF-COD-AOCF IN CLF-FLD
      *MHM-FIN 25-MAY-2004
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CLINOUNICO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO BRW-VAL-CON-RDC-CLF.

       NXT-VAL-CON-RDC-CLF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
      *<<<< NOT PGM_BNL
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )
      *>>>>
              GO TO LUP-VAL-CON-RDC-CLF.

       BRW-VAL-CON-RDC-CLF.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.
       FIN-VAL-CON-RDC-CLF.
           EXIT.
      *AMP-INI   3-NOV-1993
       VER-SI-ES-GRUPO SECTION.
       INI-VER-SI-ES-GRUPO.
           MOVE ZEROES TO WSS-EXISTE-GRUPO.
           MOVE DBC-CAI-ICLI IN CLF-FLD TO REC-CAI-ICLI IN REC.
           MOVE DBC-IIC-ICLI IN CLF-FLD TO REC-IIC-ICLI IN REC.
      *ADA-INI 17-JUL-2002
      *    MOVE 'GC'                    TO REC-COD-TREC IN REC.
      *PVG INI 28-MAY-2004
      *    MOVE 'HE'                    TO REC-COD-TREC IN REC.
           MOVE 'DC'                    TO REC-COD-TREC IN REC.
      *PVG FIN 28-MAY-2004
      *ADA-FIN 17-JUL-2002
           MOVE SPACES                  TO REC-CIC-IREL IN REC.
           MOVE ZEROES                  TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS  AND
               DBC-CAI-ICLI IN CLF-FLD = REC-CAI-ICLI IN REC AND
               DBC-IIC-ICLI IN CLF-FLD = REC-IIC-ICLI IN REC
               IF REC-IND-VIGE IN REC = 'S'  AND
      *ADA-INI 17-JUL-2002
      *           REC-COD-TREC IN REC = 'GC'
      *PVG INI 28-MAY-2004
      *           REC-COD-TREC IN REC = 'HE'
                  REC-COD-TREC IN REC = 'DC'
      *PVG FIN 28-MAY-2004
      *ADA-FIN 17-JUL-2002
                   MOVE 99 TO WSS-EXISTE-GRUPO
                   GO TO BRW-VER-SI-ES-GRUPO
               ELSE
                   GO TO LUP-VER-SI-ES-GRUPO
           ELSE
               GO TO BRW-VER-SI-ES-GRUPO.
       LUP-VER-SI-ES-GRUPO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS  AND
               DBC-CAI-ICLI IN CLF-FLD = REC-CAI-ICLI IN REC AND
               DBC-IIC-ICLI IN CLF-FLD = REC-IIC-ICLI IN REC
               IF REC-IND-VIGE IN REC = 'S'  AND
      *ADA-INI 17-JUL-2002
      *           REC-COD-TREC IN REC = 'GC'
      *PVG INI 28-MAY-2004
      *           REC-COD-TREC IN REC = 'HE'
                  REC-COD-TREC IN REC = 'DC'
      *PVG FIN 28-MAY-2004
      *ADA-FIN 17-JUL-2002
                   MOVE 99 TO WSS-EXISTE-GRUPO
                   GO TO BRW-VER-SI-ES-GRUPO
               ELSE
                   GO TO LUP-VER-SI-ES-GRUPO.
       BRW-VER-SI-ES-GRUPO.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM SGC-FIO-REC.
       FIN-VER-SI-ES-GRUPO.
           EXIT.
      *AMP-FIN   3-NOV-1993
      *>>>>
