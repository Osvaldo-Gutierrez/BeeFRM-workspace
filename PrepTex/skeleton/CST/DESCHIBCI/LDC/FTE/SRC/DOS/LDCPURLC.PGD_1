       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   LDCPURLC.
       AUTHOR.       BEE.
       DATE-WRITTEN. 08-May-19 12:11 PM.

      * NOMBRE PROGRAMA                   LDCPURLC
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      LDCRLC
      * PANTALLA                          LDCRLC
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<<
      * Nuevo Requerimiento
      * Objetivo:
      * Incorporar generacion de movimientos contables en entidad LMO
      * Nombre Proyecto: Contabilidad Inmobiliaria
      * Fecha: Noviembre 2008
      * Programador: EVA-AFRI / MAE-AFRI
      *>>>>

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-LDCPURLC-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$LDCPURLC$ SKL=$08.07.21$ VSN=$ $        
      -    'GEN=$08-May-19 12:11 PM$ FNC=$ $/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< MI_COMMAREA                                                 
           03 CMA-VARI.
              05 WSS-FEC-FOPE.
                 07  WSS-NUM-SOPE                       PIC 9(02).
                 07  WSS-NUM-AOPE                       PIC 9(02).
                 07  WSS-NUM-MOPE                       PIC 9(02).
                 07  WSS-NUM-DOPE                       PIC 9(02).

              05 WSS-FEC-FIDE.
                 07  WSS-NUM-DIDE                       PIC 9(02).
                 07  WSS-NUM-MIDE                       PIC 9(02).
                 07  WSS-NUM-SIDE                       PIC 9(02).
                 07  WSS-NUM-AIDE                       PIC 9(02).

              05 WSS-FEC-FRLC.
                 07  WSS-NUM-SRLC                       PIC 9(02).
                 07  WSS-NUM-ARLC                       PIC 9(02).
                 07  WSS-NUM-MRLC                       PIC 9(02).
                 07  WSS-NUM-DRLC                       PIC 9(02).

              05 WSS-COD-VCOC                           PIC X(06).
              05 WSS-COD-VCAM                           PIC X(06).
      *>>>>
       COPY LDCWIRLC.
       COPY LDCBRRLC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.

      *<<<< WSS                                                         
       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY TABBRCAM.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRRCV.
       COPY COLBRCAN.
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRLCC.
       COPY LDCBRACG.
       COPY LDCBRACL.
       COPY SGCBRDBC.
       COPY LDCWGLIC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBRLMO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMO-REQA==.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACG-REQA==.
       01 WSS.
          03  WSS-IFIN      VALUE SPACES   PIC X(01).
          03  WSS-IFLD       VALUE ZEROES        PIC 9(02).
          03  WSS-IMAX       VALUE ZEROES        PIC 9(02).
          03  WSS-MOV        VALUE ZEROES        PIC 9(02).
          03  ACG-KEY-IACG.
               05  ACG-KEY-ILDC.
                   07  ACG-CAI-ICLF               PIC X(04).
                   07  ACG-IIC-ICLF               PIC X(08).
                   07  ACG-NUM-ILDC               PIC 9(02).
          03  WSS-GLS-DATA.
               05  WSS-GLS-FIL1            PIC X(03).
               05  WSS-GLS-ENTI            PIC X(05).
               05  WSS-GLS-FIL2            PIC X(52).

       01 WSS-VARI.
          03 WSS-FEC-FNVA.
              05  WSS-NUM-SNVA                    PIC 9(02).
              05  WSS-NUM-ANVA                    PIC 9(02).
              05  WSS-NUM-MNVA                    PIC 9(02).
              05  WSS-NUM-DNVA                    PIC 9(02).

          03 WSS-NUM-IRLC                         PIC 9(03).

          03 WSS-FEC-FELI.
              05  WSS-NUM-SELI                    PIC 9(02).
              05  WSS-NUM-AELI                    PIC 9(02).
              05  WSS-NUM-MELI                    PIC 9(02).
              05  WSS-NUM-DELI                    PIC 9(02).

          03 WSS-FEC-FDEL.
              05  WSS-NUM-SDEL                    PIC 9(02).
              05  WSS-NUM-ADEL                    PIC 9(02).
              05  WSS-NUM-MDEL                    PIC 9(02).
              05  WSS-NUM-DDEL                    PIC 9(02).

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
          03 WSS-IND-RRLC       VALUE SPACES      PIC X(01).
          03 WSS-IND-REXI       VALUE SPACES      PIC X(01).
          03 WSS-IND-RDES       VALUE SPACES      PIC X(01).
          03 WSS-IND-SOPC       VALUE SPACES      PIC X(01).
          03 WSS-IND-CMAX       VALUE SPACES      PIC X(01).
          03 WSS-IND-MTO2       VALUE SPACES      PIC X(01).
          03 WSS-COD-OFIC       VALUE SPACES      PIC X(03).
          03 WSS-COD-TOOC       VALUE SPACES      PIC X(03).
          03 WSS-COD-AOOC       VALUE SPACES      PIC X(03).
          03 WSS-TAB-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-LDC-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-LCC-VCAM       VALUE SPACES      PIC X(06).
          03 WSS-SGV-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-CMAX       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-MUTI       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-IND-EOPC       VALUE ZEROES      PIC 9(02).
      * EVA-FIN  11/08
      *MAE
          03 WSS-CIC-ILDC.
             05 WSS-CAI-ILDC                      PIC X(04).
             05 WSS-IIC-ILDC                      PIC X(08).
          03 WSS-NUM-ILDC                         PIC 9(02).
          03 WSS-IND-ERRO                         PIC X(01).
          03 WSS-SAL-MTO2       VALUE ZEROES      PIC 9(11)V9(04).
          03 WSS-VAL-VCAM       VALUE ZEROES      PIC 9(11)V9(04).
      *MAE
          03 WSS-VAL-CRED                         PIC 9(11)V9(04).
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
          03 WSS-CAI-ICLF                         PIC X(04).
          03 WSS-IIC-ICLF                         PIC X(08).
          03 WSS-CAI-IOPC                         PIC X(04).
          03 WSS-IIC-IOPC                         PIC X(08).
          03 WSS-NUM-IOPC                         PIC X(03).
          03 WSS-COD-PESO                         PIC X(06).
          03 WSS-COD-UEFE                         PIC X(06).
          03 WSS-VAL-SOPC                         PIC 9(11)V9(04).
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-RLC.
                 88 PGM-STAT-RLC-NUL    VALUE '  '.
                 07 PGM-STT1-RLC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RLC-OKS VALUE '0'.
                 07 PGM-STT2-RLC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(306).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO RLC-FLD.
           MOVE LOW-VALUES TO RLC-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +306 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'LDCPURLC' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-RLC.
           PERFORM EDT-KEY-RLC.
           PERFORM EDT-FLD-RLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-RLC
               PERFORM EDT-KEY-RLC
               PERFORM EDT-FLD-RLC
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-RLC
               PERFORM EDT-KEY-RLC
           ELSE
               PERFORM CLR-FLD-RLC
               PERFORM EDT-FLD-RLC.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO RLC-FLD.
           MOVE LOW-VALUES TO RLC-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-RLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-STP-ITRN IN RLC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-STT-RLC.
           PERFORM RET-ALL-RLC.
           PERFORM RET-HDR-RLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO RLC.
      *<<<<
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * Inicializa Variables
           MOVE ZEROES TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-MTO2 IN WSS-VARI.
           MOVE RLC-CAI-IOPC IN RLC-FLD TO WSS-CAI-IOPC IN WSS-VARI.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO WSS-IIC-IOPC IN WSS-VARI.

      * Busca datos en CLF para grabar entidad LMO
           PERFORM LEE-CLF.
      * Busca registros existentes
           PERFORM BUS-REG-RLC.
      * Busca ultima linea ingresada
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           PERFORM BUS-LEQ-RLC.
           MOVE SPACES TO RLC.

      *>>>>
           PERFORM RET-STT-RLC.
           PERFORM RET-ALL-RLC.
           PERFORM RET-HDR-RLC.
      *<<<<
      * Busca existencia de Operacion
           MOVE RLC-CAI-IOPC IN RLC-FLD TO RLC-CAI-IOPC IN RLC.
           MOVE RLC-IIC-IOPC IN RLC-FLD TO RLC-IIC-IOPC IN RLC.
           IF RLC-NUM-IOPC IN RLC-FLD > ZEROES
              MOVE RLC-NUM-IOPC IN RLC-FLD TO RLC-NUM-IOPC IN RLC
           ELSE
              MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.

           MOVE 'RLC-KEY-IOPC' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS
              MOVE 'DEU' TO MSG-COD-SIST
              MOVE 'RLC    EXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO FIN-CMN-ING.

           ADD 1 TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE WSS-NUM-IRLC IN WSS-VARI TO RLC-NUM-IRLC IN RLC.
           MOVE WSS-NUM-SIDE IN CMA-VARI TO RLC-NUM-SIDE IN RLC.
           MOVE WSS-NUM-AIDE IN CMA-VARI TO RLC-NUM-AIDE IN RLC.
           MOVE WSS-NUM-MIDE IN CMA-VARI TO RLC-NUM-MIDE IN RLC.
           MOVE WSS-NUM-DIDE IN CMA-VARI TO RLC-NUM-DIDE IN RLC.

      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
      *<<<<
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.
      * Actualiza fecha de desembolso (DLO) para la primera RLC
           IF WSS-NUM-IRLC IN WSS-VARI = 1 AND
              WSS-FEC-FIDE IN CMA-VARI > ZEROES
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
              PERFORM ACT-FEC-DES
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
              MOVE RLC-CAI-ICLF IN RLC-FLD TO ACL-CAI-ICLF IN ACL
              MOVE RLC-IIC-ICLF IN RLC-FLD TO ACL-IIC-ICLF IN ACL
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-ACL
              IF FIO-STAT-OKS
                 MOVE WSS-NUM-SIDE IN CMA-VARI TO ACL-NUM-SIDE IN ACL
                 MOVE WSS-NUM-AIDE IN CMA-VARI TO ACL-NUM-AIDE IN ACL
                 MOVE WSS-NUM-MIDE IN CMA-VARI TO ACL-NUM-MIDE IN ACL
                 MOVE WSS-NUM-DIDE IN CMA-VARI TO ACL-NUM-DIDE IN ACL
                 MOVE FIO-MOD TO FIO-CMND
                 PERFORM LDC-FIO-ACL.
      *<<<<
           MOVE RLC-CAI-ICLF IN RLC-FLD TO LCC-CAI-ICLF IN LCC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LCC-IIC-ICLF IN LCC.
           MOVE RLC-NUM-ILDC IN RLC-FLD TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           MOVE FRM-VAL-SOPC IN RLC-FLD TO WSS-VAL-SOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE FRM-VAL-MOPC IN RLC-FLD TO WSS-VAL-CRED IN WSS-VARI.
      *    IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA


           PERFORM CONVIERTE-VCOC.

      *    COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
           COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC +
                   WSS-VAL-SOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE LCC-VAL-MUTI IN LCC TO WSS-VAL-MUTI IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF NOT FIO-STAT-OKS
              MOVE FIO-MENS TO FRM-MENS
              GO TO FIN-CMN-ING.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS             TO FIO-CMND.
       LUP-CMN-ING.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
                RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
                RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
                GO TO FIN-CMN-ING.

           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE 'N' TO WSS-IND-RDES IN WSS-VARI.
           IF LDC-MSC-STAT IN LDC = 'D'
               IF RLC-NUM-ILDC IN RLC-FLD = LDC-NUM-ILDC IN LDC
                 MOVE 'N' TO WSS-IND-RRLC IN WSS-VARI
                 MOVE 'S' TO WSS-IND-RDES IN WSS-VARI
                 PERFORM INI-LMO
               ELSE
                 NEXT SENTENCE
           ELSE
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF LDC-MSC-STAT IN LDC = 'A'
               MOVE 'D' TO LDC-MSC-STAT IN LDC
               MOVE FIO-MOD TO FIO-CMND
               PERFORM LDC-FIO-LDC
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               IF FIO-STAT-OKS
                 PERFORM INI-LMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
       NXT-CMN-ING.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CMN-ING.
      *<<<<
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-RLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-STP-ITRN IN RLC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-RLC.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-RLC.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * Inicializa Variables
           MOVE SPACES TO WSS-CAI-IOPC IN WSS-VARI.
           MOVE SPACES TO WSS-IIC-IOPC IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE RLC-NUM-SACT IN RLC-FLD TO WSS-NUM-SELI IN WSS-VARI.
           MOVE RLC-NUM-AACT IN RLC-FLD TO WSS-NUM-AELI IN WSS-VARI.
           MOVE RLC-NUM-MACT IN RLC-FLD TO WSS-NUM-MELI IN WSS-VARI.
           MOVE RLC-NUM-DACT IN RLC-FLD TO WSS-NUM-DELI IN WSS-VARI.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE RLC-NUM-ILDC IN RLC-FLD TO WSS-NUM-ILDC IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO WSS-NUM-SDEL IN WSS-VARI.
           MOVE HOY-AHOY TO WSS-NUM-ADEL IN WSS-VARI.
           MOVE HOY-MHOY TO WSS-NUM-MDEL IN WSS-VARI.
           MOVE HOY-DHOY TO WSS-NUM-DDEL IN WSS-VARI.
      * Solo permite eliminar RLC ingresadas durante el dia
           IF NOT
              (WSS-FEC-FELI IN WSS-VARI = WSS-FEC-FDEL IN WSS-VARI)
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'ERR  FECELI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.

      *>>>>
           PERFORM KEY-ALL-RLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-STP-ITRN IN RLC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-RLC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<<

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA

      *     MOVE RLC-CAI-ICLF IN RLC-FLD TO WSS-CAI-ICLF IN WSS-VARI.
      *     MOVE RLC-IIC-ICLF IN RLC-FLD TO WSS-IIC-ICLF IN WSS-VARI.
      *     MOVE FIO-DEL TO FIO-CMND.
      *     PERFORM LDC-FIO-RLC.
      *     MOVE RLC-CAI-ICLF IN RLC-FLD TO LCC-CAI-ICLF IN LCC.
      *     MOVE RLC-IIC-ICLF IN RLC-FLD TO LCC-IIC-ICLF IN LCC.
      *     MOVE RLC-NUM-ILDC IN RLC-FLD TO LCC-NUM-ILCC IN LCC.
      *     MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
      *     PERFORM LDC-FIO-LCC.

      *     MOVE FRM-VAL-SOPC IN RLC-FLD TO WSS-VAL-SOPC IN WSS-VARI.

      *     IF WSS-COD-VCOC IN CMA-VARI NOT = LCC-COD-VCOC IN LCC
      *        PERFORM CONVIERTE-VCOC.

      *     COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
      *             WSS-VAL-SOPC IN WSS-VARI.
      *     IF (LCC-VAL-MUTI IN LCC NOT > ZEROES)
      *          MOVE ZEROES TO LCC-VAL-MUTI IN LCC.

      *      MOVE FIO-MOD TO FIO-CMND.
      *     PERFORM LDC-FIO-LCC.

      *     PERFORM BUS-NLS-RLC.

      *     MOVE WSS-CAI-ICLF IN WSS-VARI TO ACL-CAI-ICLF IN ACL
      *     MOVE WSS-IIC-ICLF IN WSS-VARI TO ACL-IIC-ICLF IN ACL
      *     MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *     PERFORM LDC-FIO-ACL
      *     IF FIO-STAT-OKS
      *          MOVE WSS-FEC-FNVA IN WSS-VARI TO
      *                ACL-FEC-FIDE IN ACL
      *           MOVE FIO-MOD TO FIO-CMND
      *           PERFORM LDC-FIO-ACL.

      *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
      *<<<<<
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-STAT TO PGM-STAT-RLC.
           PERFORM UPD-LDC-LCC.

       NXT-CMN-ELI.
           IF WSS-IND-REXI IN WSS-VARI = 'S'
              PERFORM BUS-ULT-RLC.

      * Actualiza Fecha Ini Des (LOM)
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO ACL-CAI-ICLF IN ACL.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO ACL-IIC-ICLF IN ACL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

           IF WSS-IND-REXI IN WSS-VARI = 'S'
               MOVE WSS-FEC-FNVA IN WSS-VARI TO ACL-FEC-FIDE IN ACL
           ELSE
               MOVE ZEROES                   TO ACL-FEC-FIDE IN ACL

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      * Elimina movimientos contables
           PERFORM ELI-RLC-LMO.
           MOVE PGM-STAT-RLC TO FIO-STAT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-RLC.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE RLC-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO RLC-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-RLC
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO RLC-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-RLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-RLC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-RLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-RLC
               PERFORM EDT-FLD-RLC
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-RLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-RLC.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-RLC.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-RLC.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-RLC.
           PERFORM EDT-FLD-RLC.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO RLC-GLS-MEN2
               MOVE SCR-PRMT     TO RLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO RLC-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-RLC
               PERFORM VAL-NUM-FLD-RLC.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO RLC-GLS-MEN2
               MOVE SCR-PRMT     TO RLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO RLC-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO RLC-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE RLC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO RLC-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-RLC

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO RLC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO RLC-GLS-MENS.
           PERFORM PRO-FLD-RLC.
           PERFORM PRO-MKY-RLC.
           PERFORM UNP-IKY-RLC.
           PERFORM FST-KEY-RLC.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE RLC-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO RLC-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO RLC-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO RLC-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-RLC.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-RLC.
           PERFORM FST-KEY-RLC.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-RLC.
           PERFORM UNP-FLD-RLC.
           PERFORM FST-FLD-RLC.
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'ING'
              MOVE FRM-CPIM-AEY TO RLC-COD-CGTA-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO RLC-COD-DENV-ATR IN RLC-FLD
              MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLC-FLD
              MOVE 0            TO RLC-COD-CGTA-LEN IN RLC-FLD
              MOVE -1           TO RLC-NUM-IOPC-LEN IN RLC-FLD.
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO RLC-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-RLC.
           PERFORM PRO-FLD-RLC.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-RLC
               PERFORM EDT-FLD-RLC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-RLC
               PERFORM EDT-FLD-RLC
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-RLC.
           PERFORM EDT-FLD-RLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-RLC.
           PERFORM PRO-FLD-RLC.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-RLC
               PERFORM EDT-FLD-RLC.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO RLC-GLS-MEN2
               MOVE SCR-CONF     TO RLC-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO RLC-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-RLC
               PERFORM VAL-NUM-FLD-RLC
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-RLC
                   PERFORM VAL-NUM-FLD-RLC
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       RET-STT-RLC SECTION.
       INI-RET-STT-RLC.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RLC-MSC-TACC IN RLC
               MOVE 'I' TO RLC-MSC-STAT IN RLC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RLC-MSC-TACC IN RLC
               MOVE 'M' TO RLC-MSC-STAT IN RLC.
       FIN-RET-STT-RLC.
           EXIT.

       RET-HDR-RLC SECTION.
       INI-RET-HDR-RLC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RLC-FEC-FTRN IN RLC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RLC-HRA-HRTR IN RLC.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO RLC-COD-OTRN IN RLC.
      *    Autor Transaccion
           MOVE SCR-USER TO RLC-COD-ATRN IN RLC.
      *>>>>
       FIN-RET-HDR-RLC.
           EXIT.

       COPY LDCBURLC.
       COPY GNSBVNUM.
       COPY LDCBFRLC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       COPY GNSBGPES.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY SGCBFDBC.
       COPY TABBFCAM.
       COPY LDCBFLDC.
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY LDCBFLCC.
       COPY LDCBFACL.
       COPY LDCBFRDC REPLACING RDC BY RDL
                    ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBFCLF.
       COPY LDCBFACG.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBFLMO.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
       CONVIERTE-VCOC SECTION.
       INI-CONVIERTE-VCOC.


           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        

           IF WSS-COD-VCOC IN CMA-VARI = LCC-COD-VCOC IN LCC
              GO TO FIN-CONVIERTE-VCOC.

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.        

           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-CONVIERTE-VCOC.
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                                                                        
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.        

           IF WSS-COD-VCOC IN CMA-VARI = WSS-COD-PESO IN WSS-VARI AND
              LCC-COD-VCOC IN LCC NOT  = WSS-COD-PESO IN WSS-VARI
               MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
                    GO TO FIN-CONVIERTE-VCOC.

           IF LCC-COD-VCOC IN LCC      = WSS-COD-PESO IN WSS-VARI AND
              WSS-COD-VCOC IN CMA-VARI NOT = WSS-COD-PESO IN WSS-VARI
               MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1)  
               MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1)  
               MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1)  
               MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1)  
               MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1)  
               MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)  
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM TAB-FIO-CAM                                      
               IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')   
                    MOVE 'DEU' TO MSG-COD-SIST
                    MOVE 'CAM    NEX' TO MSG-COD-MENS                   
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC  TO FRM-MENS
                    MOVE '00'          TO FIO-STAT
                    MOVE SCR-STAT-CON  TO SCR-STAT
                    MOVE 'S'           TO WSS-IFIN
                    GO TO FIN-CONVIERTE-VCOC
               ELSE
                    COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
                    MOVE WSS-VAL-SOPC IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
                    PERFORM PES-SCTV
                    MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-SOPC IN WSS-VARI
                    GO TO FIN-CONVIERTE-VCOC.

           MOVE WSS-COD-VCOC IN CMA-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM.

           MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1).     
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
           MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
           MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
           MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM TAB-FIO-CAM.                                         
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS                        
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IFIN
               GO TO FIN-CONVIERTE-VCOC.

              COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
              WSS-VAL-SOPC IN WSS-VARI / CAM-SGV-VCAM IN CAM.


      *    MOVE 'TAB'          TO FIO-SIST.                             
      *    MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
      *    MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
      *    MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
      *    MOVE FIO-GET-KEY    TO FIO-CMND.                             
      *    PERFORM GNS-FIO-TAB.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'TAB'          TO MSG-COD-SIST                      
      *        MOVE 'CIC0998  NEX' TO MSG-COD-MENS                      
      *        PERFORM GET-MSG                                          
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB.                     
      *                                                                 
      *    MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.        
      *
      *    MOVE WSS-COD-UEFE IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).     
      *    MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).     
      *    MOVE WSS-NUM-SIDE IN CMA-VARI TO CAM-NUM-SCAM IN CAM(1).     
      *    MOVE WSS-NUM-AIDE IN CMA-VARI TO CAM-NUM-ACAM IN CAM(1).     
      *    MOVE WSS-NUM-MIDE IN CMA-VARI TO CAM-NUM-MCAM IN CAM(1).     
      *    MOVE WSS-NUM-DIDE IN CMA-VARI TO CAM-NUM-DCAM IN CAM(1).     
      *    MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).     
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM TAB-FIO-CAM.                                         
      *    IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')       
      *        MOVE 'DEU' TO MSG-COD-SIST
      *        MOVE 'CAM    NEX' TO MSG-COD-MENS                        
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        GO TO FIN-CONVIERTE-VCOC.
      *
      *    IF LCC-COD-VCOC IN LCC = WSS-COD-UEFE IN WSS-VARI
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD / CAM-SGV-VCAM IN CAM
      *    ELSE
      *       COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
      *       FRM-VAL-SOPC IN RLC-FLD * CAM-SGV-VCAM IN CAM
      *       MOVE WSS-VAL-SOPC IN WSS-VARI TO
      *            PES-SGV-DECI IN PES-VARI
      *       PERFORM PES-SCTV
      *       MOVE PES-SGV-ENTE IN PES-VARI TO
      *            WSS-VAL-SOPC IN WSS-VARI.
       FIN-CONVIERTE-VCOC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       BUS-REG-RLC SECTION.
       INI-BUS-REG-RLC.
      * Busca existencia de registros anteriores
           MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO RLC-IIC-ICLF IN RLC.
           MOVE RLC-NUM-ILDC IN RLC-FLD TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                  TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-RLC.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC AND
              RLC-NUM-ILDC IN RLC-FLD = RLC-NUM-ILDC IN RLC
              GO TO FIN-BUS-REG-RLC
           ELSE
              MOVE 'N' TO WSS-IND-RRLC IN WSS-VARI.

       FIN-BUS-REG-RLC.
           EXIT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-LEQ-RLC SECTION.
       INI-BUS-LEQ-RLC.
           MOVE ZEROES TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE RLC-CAI-ICLF IN RLC-FLD TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                  TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                  TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                  TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-MAX.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC
              IF RLC-NUM-IRLC IN RLC > WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-NUM-IRLC IN RLC TO WSS-NUM-IRLC IN WSS-VARI
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MAX
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MAX.
       FIN-BUS-LEQ-RLC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *BUS-NLS-RLC SECTION.
      *INI-BUS-NLS-RLC.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-ULT-RLC SECTION.
       INI-BUS-ULT-RLC.
      * Busca ultima RLC asociada para actualizar fecha ini Des (LMO)
           MOVE 999 TO WSS-NUM-IRLC IN WSS-VARI.
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                   TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                   TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUSCA-MIN.
           PERFORM LDC-FIO-RLC.
           IF FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = RLC-CAI-ICLF IN RLC AND
              RLC-IIC-ICLF IN RLC-FLD = RLC-IIC-ICLF IN RLC
              IF RLC-NUM-IRLC IN RLC < WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-NUM-IRLC IN RLC TO WSS-NUM-IRLC IN WSS-VARI
                  MOVE RLC-FEC-FIDE IN RLC TO WSS-FEC-FNVA IN WSS-VARI
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MIN
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LUP-BUSCA-MIN.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      * FIN-BUS-NLS-RLC.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       FIN-BUS-ULT-RLC.
           EXIT.


      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       ACT-FEC-DES SECTION.
       INI-ACT-FEC-DES.
      * Actualiza Fecha Desembolso DLO
           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-ACT-FEC.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
              RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-ACT-FEC-DES.

           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO NXT-ACT-FEC-DES.

           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
              MOVE WSS-NUM-SIDE IN CMA-VARI TO LCC-NUM-SDES IN LCC
              MOVE WSS-NUM-AIDE IN CMA-VARI TO LCC-NUM-ADES IN LCC
              MOVE WSS-NUM-MIDE IN CMA-VARI TO LCC-NUM-MDES IN LCC
              MOVE WSS-NUM-DIDE IN CMA-VARI TO LCC-NUM-DDES IN LCC
              MOVE WSS-NUM-SIDE IN CMA-VARI TO LCC-NUM-SCTB IN LCC
              MOVE WSS-NUM-AIDE IN CMA-VARI TO LCC-NUM-ACTB IN LCC
              MOVE WSS-NUM-MIDE IN CMA-VARI TO LCC-NUM-MCTB IN LCC
              MOVE WSS-NUM-DIDE IN CMA-VARI TO LCC-NUM-DCTB IN LCC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LCC.

       NXT-ACT-FEC-DES.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-ACT-FEC.
       FIN-ACT-FEC-DES.
           EXIT.

       INI-LMO SECTION.
       INI-INI-LMO.
           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO FIN-INI-LMO.
           MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI.
           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPURLC'               TO LMO-COD-ATRN IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-CAI-IOPC IN WSS-VARI TO LMO-CAI-IOPC IN LMO.
           MOVE WSS-IIC-IOPC IN WSS-VARI TO LMO-IIC-IOPC IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           IF WSS-IND-RRLC IN WSS-VARI = 'N'
              MOVE ZEROES                   TO LMO-NUM-IMOV IN LMO
              MOVE 1                        TO LMO-NUM-IMOV IN LMO
              MOVE 'RLO'                    TO LMO-COD-ECTB IN LMO
              MOVE WSS-VAL-CRED IN WSS-VARI TO LMO-VAL-MORI IN LMO
              MOVE 'S' TO WSS-IND-SOPC IN WSS-VARI
              MOVE LDC-COD-VCLC IN LDC TO WSS-LDC-VCAM IN WSS-VARI
              PERFORM VALOR-CAM
              MOVE WSS-VAL-SOPC IN WSS-VARI TO LMO-VAL-MPES IN LMO
              PERFORM GRABA-MTO2
           ELSE
              MOVE LDC-CAI-ICLF IN LDC TO WSS-CAI-ILDC IN WSS-VARI
              MOVE LDC-IIC-ICLF IN LDC TO WSS-IIC-ILDC IN WSS-VARI
              MOVE LDC-NUM-ILDC IN LDC TO WSS-NUM-ILDC IN WSS-VARI
              PERFORM GEN-LMO-DES
              MOVE 'S' TO WSS-IND-CMAX IN WSS-VARI
              MOVE 2                        TO LMO-NUM-IMOV IN LMO
              MOVE LDC-VAL-CMAX IN LDC      TO LMO-VAL-MORI IN LMO
              MOVE LDC-COD-VCLC IN LDC TO WSS-LDC-VCAM IN WSS-VARI
              PERFORM VALOR-CAM
              MOVE WSS-VAL-CMAX IN WSS-VARI TO LMO-VAL-MPES IN LMO
              MOVE 'DES'  TO LMO-COD-ECTB IN LMO.

           IF WSS-IND-RDES IN WSS-VARI = 'S'
              MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI.

           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF FIO-STAT-OKS AND
              WSS-IND-RRLC IN WSS-VARI = 'N'
              MOVE 'S' TO WSS-IND-RRLC IN WSS-VARI
              GO TO INI-INI-LMO.
       FIN-INI-LMO.
           EXIT.

       LEE-CLF SECTION.
       INI-LEE-CLF.

           MOVE SPACES TO WSS-COD-OFIC IN WSS-VARI.
           MOVE SPACES TO WSS-COD-TOOC IN WSS-VARI.
           MOVE SPACES TO WSS-COD-AOOC IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS
              MOVE CLF-COD-OFIC IN CLF TO WSS-COD-OFIC IN WSS-VARI
              MOVE CLF-COD-TOCF IN CLF TO WSS-COD-TOOC IN WSS-VARI
              MOVE CLF-COD-AOCF IN CLF TO WSS-COD-AOOC IN WSS-VARI.
       FIN-LEE-CLF.
           EXIT.

       GRABA-MTO2 SECTION.
       INI-GRABA-MTO2.
           MOVE ZEROES TO WSS-SGV-MTO2 IN WSS-VARI.
           MOVE 'S' TO WSS-IND-CMAX IN WSS-VARI.
           MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI.
           PERFORM VALOR-CAM.
           MOVE 'S' TO WSS-IND-MTO2 IN WSS-VARI.
           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           MOVE LCC-COD-VCOC IN LCC TO WSS-LCC-VCAM IN WSS-VARI.
           PERFORM VALOR-CAM.
           COMPUTE WSS-SGV-MTO2 = WSS-VAL-CMAX IN WSS-VARI -
                   WSS-VAL-MUTI IN WSS-VARI.
           IF WSS-NUM-IRLC IN WSS-VARI = 1
              MOVE ZEROES                   TO LCC-VAL-MTO1 IN LCC
              MOVE WSS-SGV-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC
           ELSE
              MOVE LCC-VAL-MTO2 IN LCC      TO LCC-VAL-MTO1 IN LCC
              MOVE WSS-SGV-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
       FIN-GRABA-MTO2.
           EXIT.

       VALOR-CAM SECTION.
       INI-VALOR-CAM.
           MOVE SPACES TO WSS-TAB-VCAM IN WSS-VARI.
           MOVE SPACES TO WSS-COD-UEFE IN WSS-VARI.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           MOVE TAB-COD-CTAB IN TAB TO WSS-TAB-VCAM IN WSS-VARI.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UEFE IN WSS-VARI.

           IF WSS-IND-SOPC IN WSS-VARI = 'S'

              IF WSS-COD-VCOC IN CMA-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE WSS-VAL-CRED IN WSS-VARI TO
                 WSS-VAL-SOPC IN WSS-VARI
                 MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-COD-VCOC IN CMA-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF WSS-IND-CMAX IN WSS-VARI = 'S'

              IF WSS-LDC-VCAM IN WSS-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE LDC-VAL-CMAX IN LDC TO
                      WSS-VAL-CMAX IN WSS-VARI
                 MOVE 'N' TO WSS-IND-CMAX IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-LDC-VCAM IN WSS-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF WSS-IND-MTO2 IN WSS-VARI = 'S'

              IF WSS-LCC-VCAM IN WSS-VARI =
                 WSS-TAB-VCAM IN WSS-VARI
                 MOVE LCC-VAL-MUTI IN LCC TO
                      WSS-VAL-MUTI IN WSS-VARI
                 MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI
                 GO TO FIN-VALOR-CAM
              ELSE
                 MOVE WSS-LCC-VCAM IN WSS-VARI TO
                     CAM-COD-VCAM IN CAM(1).
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       END-IF

      *    END-IF.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           MOVE WSS-TAB-VCAM IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1).
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1).
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1).
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAM    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               GO TO FIN-VALOR-CAM.

           IF WSS-IND-SOPC IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-SOPC IN WSS-VARI
               COMPUTE WSS-VAL-SOPC IN WSS-VARI ROUNDED =
                    WSS-VAL-CRED IN WSS-VARI * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-SOPC IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-SOPC IN WSS-VARI.

           IF WSS-IND-CMAX IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-CMAX IN WSS-VARI
               COMPUTE WSS-VAL-CMAX IN WSS-VARI ROUNDED =
                    LDC-VAL-CMAX IN LDC * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-CMAX IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-CMAX IN WSS-VARI.

           IF WSS-IND-MTO2 IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-IND-MTO2 IN WSS-VARI
               COMPUTE WSS-VAL-MUTI IN WSS-VARI ROUNDED =
                    LCC-VAL-MUTI IN LCC * CAM-SGV-VCAM IN CAM
               MOVE WSS-VAL-MUTI IN WSS-VARI TO
                         PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                         WSS-VAL-MUTI IN WSS-VARI.

       FIN-VALOR-CAM.
           EXIT.
      * EVA-FIN  11/08

      *MAE
      *----------------------------------------------------------
       GEN-LMO-DES SECTION.
       INI-GEN-LMO-DES.

           PERFORM BUS-COD-PESO.
           IF (WSS-IND-ERRO = 'S')
                GO TO FIN-GEN-LMO-DES.

      *    BUSCA LINEAS EN DESEMBOLSO
           MOVE WSS-CIC-ILDC IN WSS-VARI TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES                   TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GEN-LMO-DES.
           PERFORM LDC-FIO-LDC.
           IF (NOT FIO-STAT-OKS OR
               WSS-CIC-ILDC IN WSS-VARI NOT = LDC-CIC-ICLF IN LDC)
                GO TO FIN-GEN-LMO-DES.

           IF WSS-NUM-ILDC IN WSS-VARI = LDC-NUM-ILDC IN LDC
                GO TO NXT-GEN-LMO-DES.

           PERFORM UPD-LCC.
           IF (WSS-IND-ERRO = 'S')
                GO TO NXT-GEN-LMO-DES.
           PERFORM GRB-LMO.

       NXT-GEN-LMO-DES.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-GEN-LMO-DES.

       FIN-GEN-LMO-DES.
           MOVE WSS-CIC-ILDC IN WSS-VARI TO LDC-CIC-ICLF IN LDC.
           MOVE WSS-NUM-ILDC IN WSS-VARI TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           EXIT.
      *----------------------------------------------------------
       UPD-LCC SECTION.
       INI-UPD-LCC.

      *    Actualiza monto y fecha de LCC

           MOVE 'N' TO WSS-IND-ERRO.
           MOVE LDC-CAI-ICLF IN LDC     TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC     TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC     TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD     TO FIO-CMND.
           PERFORM LDC-FIO-LCC.

           COMPUTE WSS-SAL-MTO2 IN WSS-VARI =
                   LDC-VAL-CMAX IN LDC  -
                   LCC-VAL-MUTI IN LCC.

           PERFORM BUS-VCAM-MTO2.
           IF (WSS-IND-ERRO = 'S')
                GO TO FIN-UPD-LCC.

           MOVE WSS-SAL-MTO2 IN WSS-VARI TO LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
              MOVE 'S' TO WSS-IND-ERRO.

       FIN-UPD-LCC.
           EXIT.
      *----------------------------------------------------------
       GRB-LMO SECTION.
       INI-GRB-LMO.

      *    CREA LMO PARA LINEAS
           IF LDC-MSC-STAT IN LDC = 'I'
              GO TO FIN-GRB-LMO.

           PERFORM LIMP-LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPURLC'               TO LMO-COD-ATRN IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-CAI-IOPC IN WSS-VARI TO LMO-CAI-IOPC IN LMO.
           MOVE WSS-IIC-IOPC IN WSS-VARI TO LMO-IIC-IOPC IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           MOVE LDC-VAL-CMAX IN LDC      TO LMO-VAL-MORI IN LMO.
           MOVE 2                        TO LMO-NUM-IMOV IN LMO.
           MOVE 'S'                      TO WSS-IND-CMAX IN WSS-VARI.
           MOVE LDC-COD-VCLC IN LDC      TO WSS-LDC-VCAM IN WSS-VARI.
           PERFORM VALOR-CAM.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO LMO-VAL-MPES IN LMO.
           MOVE 'DES'  TO LMO-COD-ECTB IN LMO.

           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.


       FIN-GRB-LMO.
           EXIT.
      *----------------------------------------------------------
       LIMP-LMO SECTION.
       INI-LIMP-LMO.

      *    LIMPIA LMO

           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.


       FIN-LIMP-LMO.
           EXIT.
      *----------------------------------------------------------
       BUS-VCAM-MTO2 SECTION.
       INI-BUS-VCAM-MTO2.

      *    CAMBIO SALDO DISPONIBLE A PESOS

           MOVE 'N' TO WSS-IND-ERRO.
           IF LCC-COD-VCOC IN LCC = WSS-COD-PESO IN WSS-VARI
               GO TO FIN-BUS-VCAM-MTO2.

           MOVE LCC-COD-VCOC IN LCC      TO CAM-COD-VCAM IN CAM(1)
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
           MOVE HOY-SHOY                 TO CAM-NUM-SCAM IN CAM(1)
           MOVE HOY-AHOY                 TO CAM-NUM-ACAM IN CAM(1)
           MOVE HOY-MHOY                 TO CAM-NUM-MCAM IN CAM(1)
           MOVE HOY-DHOY                 TO CAM-NUM-DCAM IN CAM(1)
           MOVE CAM-FEC-FCAM IN CAM(1)   TO CAM-FEC-FCAM IN CAM(2)
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-CAM
           IF (NOT FIO-STAT-OKS OR CAM-IND-VIGE IN CAM NOT = 'S')
                MOVE 'DEU' TO MSG-COD-SIST
                MOVE 'CAM    NEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC  TO FRM-MENS
                MOVE '00'          TO FIO-STAT
                MOVE SCR-STAT-CON  TO SCR-STAT
                MOVE 'S'           TO WSS-IND-ERRO
                GO TO FIN-BUS-VCAM-MTO2.

           COMPUTE WSS-VAL-VCAM IN WSS-VARI ROUNDED =
                   WSS-SAL-MTO2 IN WSS-VARI * CAM-SGV-VCAM IN CAM.


           MOVE WSS-VAL-VCAM IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SAL-MTO2 IN WSS-VARI.


       FIN-BUS-VCAM-MTO2.
           EXIT.
      *----------------------------------------------------------
       BUS-COD-PESO SECTION.
       INI-BUS-COD-PESO.

      *    BUSCA CODIGO DE MONEDA PESOS

           MOVE 'N'            TO WSS-IND-ERRO.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE '00'          TO FIO-STAT
               MOVE SCR-STAT-CON  TO SCR-STAT
               MOVE 'S'           TO WSS-IND-ERRO
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *        DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
               GO TO FIN-BUS-COD-PESO.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

       FIN-BUS-COD-PESO.
           EXIT.
      *----------------------------------------------------------
       LEE-RLC-RLC SECTION.
       INI-LEE-RLC-RLC.
      * Busca RLC existentes de la Linea eliminada
           MOVE 'S' TO WSS-IND-REXI IN WSS-VARI.

           MOVE RLC-CAI-ICLF IN RLC-FLD  TO RLC-CAI-ICLF IN RLC.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO RLC-IIC-ICLF IN RLC.
           MOVE ZEROES                   TO RLC-NUM-ILDC IN RLC.
           MOVE SPACES                   TO RLC-CAI-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-IIC-IOPC IN RLC.
           MOVE ZEROES                   TO RLC-NUM-IOPC IN RLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RLC.
           IF (FIO-STAT-OKS AND
               RLC-CAI-ICLF IN RLC-FLD  = RLC-CAI-ICLF IN RLC AND
               RLC-IIC-ICLF IN RLC-FLD  = RLC-IIC-ICLF IN RLC AND
               RLC-NUM-ILDC IN RLC-FLD  = RLC-NUM-ILDC IN RLC)
               GO TO FIN-LEE-RLC-RLC.

           MOVE 'N' TO WSS-IND-REXI IN WSS-VARI.

       FIN-LEE-RLC-RLC.
           EXIT.

       UPD-LDC-LCC SECTION.
       INI-UPD-LDC-LCC.
      * Busca existencia de mas rlc asociadas a la linea eliminada
           PERFORM LEE-RLC-RLC.

           MOVE RLC-CAI-ICLF IN RLC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE RLC-IIC-ICLF IN RLC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-UPD-DLO.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD = LDC-CAI-ICLF IN LDC AND
              RLC-IIC-ICLF IN RLC-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-UPD-LDC-LCC.

      * Actualiza estado de la DLO (Desembolso -> Activada)
           IF WSS-IND-REXI IN WSS-VARI = 'S'
              GO TO NXT-UPD-LDC-LCC.

           IF FIO-STAT-OKS AND LDC-MSC-STAT IN LDC = 'D'
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-LDC
              MOVE 'A' TO LDC-MSC-STAT IN LDC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LDC.

      * Actualiza monto LCC
           MOVE LDC-CAI-ICLF IN LDC  TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC  TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC  TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
       LOOP-UPD-LCC.
           PERFORM LDC-FIO-LCC.
           IF NOT (FIO-STAT-OKS)
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-UPD-LDC-LCC.

           IF WSS-NUM-ILDC IN WSS-VARI = LCC-NUM-ILCC IN LCC
               MOVE FRM-VAL-SOPC IN RLC-FLD TO
                    WSS-VAL-SOPC IN WSS-VARI

               PERFORM CONVIERTE-VCOC
               IF WSS-IND-REXI IN WSS-VARI = 'N'
                  MOVE ZEROES TO LCC-VAL-MUTI IN LCC
               ELSE
                  COMPUTE LCC-VAL-MUTI IN LCC = LCC-VAL-MUTI IN LCC -
                       WSS-VAL-SOPC IN WSS-VARI.

           IF WSS-IND-REXI IN WSS-VARI = 'S'
              MOVE LCC-VAL-MTO1 IN LCC TO LCC-VAL-MTO2 IN LCC
              MOVE ZEROES              TO LCC-VAL-MTO1 IN LCC
           ELSE
              MOVE ZEROES              TO LCC-VAL-MTO2 IN LCC
              MOVE ZEROES              TO LCC-VAL-MTO1 IN LCC
              MOVE ZEROES              TO LCC-FEC-FCTB IN LCC
              MOVE ZEROES              TO LCC-FEC-FDES IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-UPD-LDC-LCC.
       NXT-UPD-LDC-LCC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-UPD-DLO.
       FIN-UPD-LDC-LCC.
           EXIT.

       ELI-RLC-LMO SECTION.
       INI-ELI-RLC-LMO.
           MOVE RLC-CAI-ICLF IN RLC-FLD  TO LMO-CAI-ICLF IN LMO.
           MOVE RLC-IIC-ICLF IN RLC-FLD  TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES                   TO LMO-NUM-ILDC IN LMO.
           MOVE 'LMO-KEY-ILDC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LOOP-UPD-LMO.
           PERFORM LDC-FIO-LMO.
           IF NOT (FIO-STAT-OKS AND
              RLC-CAI-ICLF IN RLC-FLD  = LMO-CAI-ICLF IN LMO AND
              RLC-IIC-ICLF IN RLC-FLD  = LMO-IIC-ICLF IN LMO)
              GO TO FIN-ELI-RLC-LMO.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-ELI-RLC-LMO.

           IF WSS-IND-REXI IN WSS-VARI = 'S' AND
              RLC-CAI-IOPC IN RLC-FLD = LMO-CAI-IOPC IN LMO AND
              RLC-IIC-IOPC IN RLC-FLD = LMO-IIC-IOPC IN LMO
              IF LMO-COD-ECTB IN LMO = 'DES'
                 GO TO NXT-UPD-LMO
              ELSE
                 NEXT SENTENCE.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LMO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-ELI-RLC-LMO.

       NXT-UPD-LMO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-UPD-LMO.
       FIN-ELI-RLC-LMO.
           EXIT.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>
