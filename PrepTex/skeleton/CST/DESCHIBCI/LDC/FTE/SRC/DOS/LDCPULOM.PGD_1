       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   LDCPULOM.
       AUTHOR.       BEE-AFRI.
       DATE-WRITTEN. 27-Mar-19 09:25 PM.

      * NOMBRE PROGRAMA                   LDCPULOM
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      LDCCLF
      * PANTALLA                          LDCLOM
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-LDCPULOM-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$LDCPULOM$ SKL=$08.07.21$ VSN=$ $        
      -    'GEN=$27-Mar-19 09:25 PM$ FNC=$ $/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< MI_COMMAREA                                                 
           03 SCR-IND-MCLI  VALUE SPACES          PIC X(01).            
      *>>>>
       COPY LDCWILOM.
       COPY LDCBRCLF.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS                                                         
       COPY LDCBRCLF.                                                   
       COPY LDCBRACL.                                                   
       COPY LDCBRRCL.                                                   
       COPY SGCBRDBC.                                                   
       COPY LDCBRRDC.                                                   
       COPY LDCBRLCC.
       COPY LDCBRRLC.
       COPY LDCBRARG.
       COPY LDCBRARC.
       COPY LDCBRACG.
       COPY COLBROPC.
       COPY TABBRTIO.
       COPY LDCBRLMO.
                                                                 
       COPY LDCWGPRY.                                                   
       COPY LDCBRLDC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.        
       COPY TABBRCAM.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.        
       COPY GNSWGPES.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCL-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCPT.                                                   
       COPY GNSWGCIC.                                                   
       COPY GNSWGSTR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.        

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ACG-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LMO-REQA==.        

       COPY TABBRCOM.                                                   
                                                                 
       01  WSS-VARI.                                                    
           03 WSS-CLA-OPER.                                             
               05 WSS-TIP-OPER                          PIC X(03).      
               05 WSS-STP-OPER                          PIC X(03).      
           03 WSS-COD-COGA.                                             
               05 WSS-COD-TGAR                          PIC X(03).      
               05 WSS-GLS-TGAR                          PIC X(03).      
                                                                        
           03 WSS-VSN-OCAI                        PIC X(01).            
           03 SCR-IND-OCIC  VALUE SPACES                PIC X(01).
           03 WSS-IND-ERCL  VALUE SPACES                PIC X(01).
           03 WSS-IND-ERLC  VALUE SPACES                PIC X(01).
           03 WSS-IND-EDLO  VALUE SPACES                PIC X(01).
           03 WSS-CAI-ICLF  VALUE SPACES                PIC X(04).
           03 WSS-IIC-ICLF  VALUE SPACES                PIC X(08).
      *    FECHA INICIO LDC
           03 WSS-FEC-FINI.
               05 WSS-NUM-SINI                       PIC 9(02).
               05 WSS-NUM-AINI                       PIC 9(02).
               05 WSS-NUM-MINI                       PIC 9(02).
               05 WSS-NUM-DINI                       PIC 9(02).

      *    FECHA VENCIMIENTO LDC
           03 WSS-FEC-TRN.
               05 FEC-TRN1                           PIC 9(02).
               05 FEC-TRN2                           PIC 9(02).
               05 FEC-TRN3                           PIC 9(02).
               05 FEC-TRN4                           PIC 9(02).

      *    FECHA VENCIMIENTO LDC
           03 WSS-FEC-FVEN.
               05 WSS-NUM-SVEN                       PIC 9(02).
               05 WSS-NUM-AVEN                       PIC 9(02).
               05 WSS-NUM-MVEN                       PIC 9(02).
               05 WSS-NUM-DVEN                       PIC 9(02).

           03 WSS-FEC-FFDE.
               05 WSS-NUM-SFDE                       PIC 9(02).
               05 WSS-NUM-AFDE                       PIC 9(02).
               05 WSS-NUM-MFDE                       PIC 9(02).
               05 WSS-NUM-DFDE                       PIC 9(02).

           03 WSS-FEC-FFFE.
               05 WSS-NUM-SFFE                       PIC 9(02).
               05 WSS-NUM-AFFE                       PIC 9(02).
               05 WSS-NUM-MFFE                       PIC 9(02).
               05 WSS-NUM-DFFE                       PIC 9(02).

           03 WSS-FEC-FING.
               05 WSS-NUM-SING                       PIC 9(02).
               05 WSS-NUM-AING                       PIC 9(02).
               05 WSS-NUM-MING                       PIC 9(02).
               05 WSS-NUM-DING                       PIC 9(02).

           03 WSS-FEC-FAPE.
               05 WSS-NUM-SAPE                       PIC 9(02).
               05 WSS-NUM-AAPE                       PIC 9(02).
               05 WSS-NUM-MAPE                       PIC 9(02).
               05 WSS-NUM-DAPE                       PIC 9(02).

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           03 WSS-COD-TOOC                           PIC X(03).
           03 WSS-COD-AOOC                           PIC X(03).
           03 WSS-IND-MLDC                           PIC X(01).
           03 WSS-COD-OFIC                           PIC X(03).
           03 WSS-COD-VCLC                           PIC X(06).
           03 WSS-NUM-ILDC   VALUE ZEROES            PIC 9(02).
           03 WSS-VAL-MORI   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-MUTI   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-MTO2   VALUE ZEROES      PIC 9(11)V9(04).
           03 WSS-SGV-CMAX   VALUE ZEROES      PIC 9(11)V9(04).

           03 WSS-FEC-FACV.
               05 WSS-NUM-SACV                       PIC 9(02).
               05 WSS-NUM-AACV                       PIC 9(02).
               05 WSS-NUM-MACV                       PIC 9(02).
               05 WSS-NUM-DACV                       PIC 9(02).
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

      *    INDICADOR ERROR
           03 WSS-IND-ERRO                           PIC X(01).
           03 WSS-IND-ICLF     VALUE SPACES       PIC X(01).            
       01  WSS-FRM-MEN2.
           03 WSS-CAI-MEN2                  PIC X(04).
           03 WSS-BLK1       VALUE SPACES   PIC X(03).
           03 WSS-NUM-MEN2                  PIC 9(08).
           03 WSS-BLK2       VALUE SPACES   PIC X(24).
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-CLF.
                 88 PGM-STAT-CLF-NUL    VALUE '  '.
                 07 PGM-STT1-CLF        VALUE '2' PIC X(01).
                    88 PGM-STAT-CLF-OKS VALUE '0'.
                 07 PGM-STT2-CLF        VALUE '3' PIC X(01).
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-ACL.
                 88 PGM-STAT-ACL-NUL    VALUE '  '.
                 07 PGM-STT1-ACL        VALUE '2' PIC X(01).
                    88 PGM-STAT-ACL-OKS VALUE '0'.
                 07 PGM-STT2-ACL        VALUE '3' PIC X(01).
      *<<<<
              05 PGM-STAT-RDC.                                          
                 88 PGM-STAT-RDC-NUL    VALUE '  '.                     
                 07 PGM-STT1-RDC        VALUE '2' PIC X(01).            
                    88 PGM-STAT-RDC-OKS VALUE '0'.                      
                 07 PGM-STT2-RDC        VALUE '3' PIC X(01).            
      *>>>>
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(270).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO LOM-FLD.
           MOVE LOW-VALUES TO LOM-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +270 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'LDCPULOM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-LOM.
           PERFORM EDT-KEY-LOM.
           PERFORM EDT-FLD-LOM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-LOM
               PERFORM EDT-KEY-LOM
               PERFORM EDT-FLD-LOM
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-LOM
               PERFORM EDT-KEY-LOM
           ELSE
               PERFORM CLR-FLD-LOM
               PERFORM EDT-FLD-LOM.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO LOM-FLD.
           MOVE LOW-VALUES TO LOM-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
           IF SCR-CMND = 'MOD'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'I')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.
      *>>>>
           PERFORM KEY-ALL-LOM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS AND
              CLF-STP-ITRN IN CLF NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-STT-CLF.
           PERFORM RET-ALL-LOM.
           PERFORM RET-HDR-CLF.
      *<<<< CMN_MOD
           MOVE ACL-NUM-SFDE IN LOM-FLD TO CLF-NUM-SVEN IN CLF.
           MOVE ACL-NUM-AFDE IN LOM-FLD TO CLF-NUM-AVEN IN CLF.
           MOVE ACL-NUM-MFDE IN LOM-FLD TO CLF-NUM-MVEN IN CLF.
           MOVE ACL-NUM-DFDE IN LOM-FLD TO CLF-NUM-DVEN IN CLF.

           IF SCR-CMND = 'ACA'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'V')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *         MOVE 'F' TO CLF-MSC-STAT IN CLF.
                MOVE 'F' TO CLF-MSC-STAT IN CLF
                MOVE 'LOM' TO PRY-IND-IFLD IN PRY-VARI
                MOVE HOY-SHOY TO WSS-NUM-SACV IN WSS-VARI
                MOVE HOY-AHOY TO WSS-NUM-AACV IN WSS-VARI
                MOVE HOY-MHOY TO WSS-NUM-MACV IN WSS-VARI
                MOVE HOY-DHOY TO WSS-NUM-DACV IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD NOT = 'I')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD = 'F')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'CLF    ACAYA' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'VRF' AND
              (CLF-MSC-STAT IN LOM-FLD = 'I')
                MOVE 'V' TO CLF-MSC-STAT IN LOM-FLD
                MOVE 'V' TO CLF-MSC-STAT IN CLF.

           IF SCR-CMND = 'RCH'
              IF NOT
                (CLF-MSC-STAT IN LOM-FLD = 'I' OR
                 CLF-MSC-STAT IN LOM-FLD = 'V')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
                MOVE 'R' TO CLF-MSC-STAT IN CLF.

           IF SCR-CMND = 'TER'
              IF NOT (CLF-MSC-STAT IN LOM-FLD = 'F')
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'MSC    INVAL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                GO TO FIN-CMN-MOD
              ELSE
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-COD-OFIC IN LOM-FLD TO
                     WSS-COD-OFIC IN WSS-VARI
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE 'T' TO CLF-MSC-STAT IN CLF
                MOVE CLF-CAI-ICLF IN LOM-FLD TO
                     WSS-CAI-ICLF IN WSS-VARI
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-COD-TOCF IN LOM-FLD TO
                     WSS-COD-TOOC IN WSS-VARI
                MOVE CLF-COD-AOCF IN LOM-FLD TO
                     WSS-COD-AOOC IN WSS-VARI
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
                MOVE CLF-IIC-ICLF IN LOM-FLD TO
                     WSS-IIC-ICLF IN WSS-VARI.
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFUPDNOMOD ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           IF SCR-CMND NOT = 'ACA'
               GO TO CNT-CMN-MOD.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO LCC-CAI-ICLF IN LCC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO LCC-IIC-ICLF IN LCC.
           MOVE ZEROES                  TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-CMN-MOD.
           PERFORM LDC-FIO-LCC.
           IF NOT (FIO-STAT-OKS AND
               CLF-CAI-ICLF IN LOM-FLD = LCC-CAI-ICLF IN LCC AND
               CLF-IIC-ICLF IN LOM-FLD = LCC-IIC-ICLF IN LCC)
               GO TO CNT-CMN-MOD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
              MOVE WSS-NUM-SACV IN WSS-VARI TO LCC-NUM-SACV IN LCC
              MOVE WSS-NUM-AACV IN WSS-VARI TO LCC-NUM-AACV IN LCC
              MOVE WSS-NUM-MACV IN WSS-VARI TO LCC-NUM-MACV IN LCC
              MOVE WSS-NUM-DACV IN WSS-VARI TO LCC-NUM-DACV IN LCC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM LDC-FIO-LCC
              IF NOT FIO-STAT-OKS
                  MOVE 'DEU' TO MSG-COD-SIST
                  MOVE 'LCCUPDNOMOD ' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  GO TO FIN-CMN-MOD
              ELSE
                  MOVE FIO-GET-NXT TO FIO-CMND
                  GO TO LOOP-CMN-MOD.

       CNT-CMN-MOD.

      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

           IF SCR-CMND = 'TER'
                PERFORM BUS-DLO-DEM.
           MOVE CLF-CAI-ICLF IN LOM-FLD TO ACL-CAI-ICLF IN ACL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO ACL-IIC-ICLF IN ACL.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFNOMOD    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ACL-LOM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLFNOMOD    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.

           IF SCR-CMND = 'ACA'
               MOVE CLF-CIC-ICLF IN CLF TO CLF-CIC-ICLF IN PRY-VARI
               MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN PRY-VARI
               MOVE CLF-FEC-FAPE IN CLF TO WSS-FEC-FAPE IN PRY-VARI
               MOVE CLF-MSC-STAT IN CLF TO CLF-MSC-STAT IN PRY-VARI
               MOVE 'LOM'               TO PRY-IND-IFLD IN PRY-VARI
               PERFORM UPD-CMAX-LOM
               IF(PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE '00' TO FIO-STAT
                   MOVE 'S' TO SCR-IERR.

      *>>>>
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO CLF.
      *<<<< INI_CMN_ING
       CIC-GET-CIC-ING.
           IF CLF-IIC-ICLF IN LOM-FLD > ZEROES
               MOVE 'N' TO SCR-IND-OCIC
           ELSE
               MOVE 'S' TO SCR-IND-OCIC
               MOVE CLF-CAI-ICLF IN LOM-FLD TO CIC-CAI-ICIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CIC-ICIC TO CLF-CIC-ICLF IN CLF
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM LDC-FIO-CLF
                   IF FIO-STAT-OKS
                       GO TO CIC-GET-CIC-ING
                   ELSE
                       MOVE CIC-CAI-ICIC TO CLF-CAI-ICLF IN LOM-FLD
                       MOVE CIC-IIC-ICIC TO CLF-IIC-ICLF IN LOM-FLD.
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'INGYES' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE CIC-CAI-ICIC TO WSS-CAI-MEN2
                       MOVE CIC-NUM-ICIC TO WSS-NUM-MEN2 IN WSS-FRM-MEN2
                       MOVE WSS-FRM-MEN2 TO FRM-MEN2.

           MOVE SPACES TO CLF-GLS-FLAG IN CLF.
           MOVE SPACES TO CLF-CAI-CREN IN CLF.
           MOVE ZEROES TO CLF-IIC-CREN IN CLF.
           MOVE ZEROES TO CLF-NUM-PREV IN CLF.
           MOVE ZEROES TO CLF-VAL-COMI IN CLF.
           MOVE ZEROES TO CLF-NUM-SOL  IN CLF.
           MOVE ZEROES TO CLF-IND-PREV IN CLF.
           MOVE ZEROES TO CLF-FEC-FCIE IN CLF.
           MOVE SPACES TO CLF-COD-RAZC IN CLF.
           MOVE ZEROES TO CLF-FEC-FPRV IN CLF.
           MOVE ACL-NUM-SFDE IN LOM-FLD TO CLF-NUM-SVEN IN CLF.
           MOVE ACL-NUM-AFDE IN LOM-FLD TO CLF-NUM-AVEN IN CLF.
           MOVE ACL-NUM-MFDE IN LOM-FLD TO CLF-NUM-MVEN IN CLF.
           MOVE ACL-NUM-DFDE IN LOM-FLD TO CLF-NUM-DVEN IN CLF.

           MOVE 'I'      TO CLF-MSC-TACC IN CLF.

      *>>>>
           PERFORM RET-STT-CLF.
           PERFORM RET-ALL-LOM.
           PERFORM RET-HDR-CLF.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *<<<< FIN_CMN_ING
           MOVE FIO-STAT TO PGM-STAT-CLF.
           IF NOT FIO-STAT-OKS
      *        ERROR INCONSISTENCIA EN EL INGRESO : INFORMAR
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
      *<<<< FIN_CMN_ING
           IF DBC-IND-ICLI IN LOM-FLD NOT = 'M'
              PERFORM PUT-RDC
              IF NOT FIO-STAT-OKS
                 MOVE 'DEU'        TO MSG-COD-SIST
                 MOVE 'RDC    PUT' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 GO TO FIN-CMN-ING.

           PERFORM PUT-ACL.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ACL    PUT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ING.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-LOM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS AND
              CLF-STP-ITRN IN CLF NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-LOM.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
      *<<<< INI_CMN_ELI
           PERFORM REL-ENT.
           IF WSS-IND-ERCL IN WSS-VARI = 'S' OR
              WSS-IND-EDLO IN WSS-VARI = 'S'
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'ELI    INVAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE 'S' TO SCR-IERR
              GO TO FIN-CMN-ELI.

           IF NOT
             (CLF-MSC-STAT IN LOM-FLD = 'I' OR
              CLF-MSC-STAT IN LOM-FLD = 'V')
              MOVE 'DEU'        TO MSG-COD-SIST
              MOVE 'MSC    INVAL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE 'S' TO SCR-IERR
              GO TO FIN-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-LOM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS AND
              CLF-STP-ITRN IN CLF NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CLFNOELI    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.

           PERFORM DEL-ARC.
           PERFORM DEL-ARG.
           PERFORM DEL-LDC.
           PERFORM DEL-RDC.
           PERFORM DEL-LCC.
           PERFORM DEL-ACL.
           IF MSG-COD-MENS > SPACES
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'ACLNOELI    ' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE 'S' TO SCR-IERR
               GO TO FIN-CMN-ELI.
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-LOM.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE LOM-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO LOM-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-LOM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LOM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-LOM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LOM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-LOM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LOM
               PERFORM EDT-FLD-LOM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-LOM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-LOM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-LOM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-LOM.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LOM.
           PERFORM EDT-FLD-LOM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LOM-GLS-MEN2
               MOVE SCR-PRMT     TO LOM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LOM-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-LOM
               PERFORM VAL-NUM-FLD-LOM.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LOM-GLS-MEN2
               MOVE SCR-PRMT     TO LOM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LOM-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO LOM-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LOM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LOM-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-LOM

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LOM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LOM-GLS-MENS.
           PERFORM PRO-FLD-LOM.
           PERFORM PRO-MKY-LOM.
           PERFORM UNP-IKY-LOM.
           PERFORM FST-KEY-LOM.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE LOM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO LOM-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO LOM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO LOM-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-LOM.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-LOM.
           PERFORM FST-KEY-LOM.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-LOM.
           PERFORM UNP-FLD-LOM.
           PERFORM FST-FLD-LOM.
      *<<<<
           IF SCR-CMND = 'ING' OR SCR-CMND = 'MOD'
                MOVE FRM-CPIM-AEY TO CLF-VAL-CMAX-ATR IN LOM-FLD
                MOVE FRM-CPIM-AEY TO ACL-FEC-FFDE-ATR IN LOM-FLD
                MOVE FRM-CPIM-AEY TO ACL-FEC-FIDE-ATR IN LOM-FLD.

           IF SCR-CMND  = 'ACA' OR 'VRF'
              PERFORM PRO-FLD-LOM.

           IF SCR-CMND = 'VRF'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'TER'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'RCH'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD.

           IF SCR-CMND = 'MDF'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES1-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES2-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DES3-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DIRE-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-LUGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO CLF-COD-EJEC-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-MAIL-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-COD-COGA-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-GLS-DGAR-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-GLS-DES1-LEN IN LOM-FLD.

           IF SCR-CMND = 'MCA'
                PERFORM PRO-MKY-LOM
                PERFORM PRO-FLD-LOM
                MOVE FRM-CPIM-UBY TO ACL-NUM-PVIG-ATR IN LOM-FLD
                MOVE FRM-CPIM-UBY TO ACL-IND-PVIG-ATR IN LOM-FLD
                MOVE 0  TO CLF-COD-VCCF-LEN IN LOM-FLD
                MOVE -1 TO ACL-NUM-PVIG-LEN IN LOM-FLD.
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO LOM-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-LOM.
           PERFORM PRO-FLD-LOM.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LOM
               PERFORM EDT-FLD-LOM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-LOM
               PERFORM EDT-FLD-LOM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-LOM.
           PERFORM EDT-FLD-LOM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-LOM.
           PERFORM PRO-FLD-LOM.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-LOM
               PERFORM EDT-FLD-LOM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO LOM-GLS-MEN2
               MOVE SCR-CONF     TO LOM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO LOM-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-LOM
               PERFORM VAL-NUM-FLD-LOM
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-LOM
                   PERFORM VAL-NUM-FLD-LOM
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       RET-STT-CLF SECTION.
       INI-RET-STT-CLF.
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO CLF-MSC-TACC IN CLF
               MOVE 'I' TO CLF-MSC-STAT IN CLF
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO CLF-MSC-TACC IN CLF
               MOVE 'M' TO CLF-MSC-STAT IN CLF.
       FIN-RET-STT-CLF.
           EXIT.

       RET-HDR-CLF SECTION.
       INI-RET-HDR-CLF.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO CLF-FEC-FTRN IN CLF.
      *    Hora Transaccion
           MOVE HOY-HHOY TO CLF-HRA-HRTR IN CLF.
      *    Codigo Origen transaccion
      *<<<< NOT PGM_VMS
           MOVE SCR-OTRN TO CLF-COD-OTRN IN CLF.
      *    Autor Transaccion
           MOVE SCR-USER TO CLF-COD-ATRN IN CLF.
      *>>>>
       FIN-RET-HDR-CLF.
           EXIT.

       COPY LDCBULOM.
       COPY GNSBVNUM.
       COPY LDCBFCLF.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       COPY LDCBFCLF
       COPY COLBFOPC.
       COPY LDCBFACL.                                                   
       COPY LDCBFRCL.                                                   
       COPY LDCBFRDC.                                                   
       COPY SGCBFDBC.                                                   
       COPY LDCBFARC.
       COPY LDCBFLCC.
       COPY LDCBFARG.
       COPY LDCBFACG.
       COPY LDCBFRLC.
       COPY LDCBGPRY.                                                   
       COPY LDCBFLDC.                                                   
       COPY TABBFCAM.                                                   
       COPY GNSBGPES.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBPFEC.                                                   
       COPY TABBFCOM.                                                   
       COPY GNSBGSTR.                                                   
       COPY GNSBGCIC.                                                   
       COPY GNSBGCPT.                                                   
      *>>>>                                                             
      *<<<< EOF_PU
       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN LOM-FLD = 'M'
               GO TO FIN-PUT-RDC.
           MOVE SPACES TO  RDC.
           MOVE ZEROES TO  RDC-VAL-PRDC IN RDC.
           MOVE SPACES TO  RDC-GLS-FLAG IN RDC.
           MOVE 100                     TO RDC-VAL-PRDC IN RDC.
           MOVE SPACES                  TO RDC-COD-RDCF IN RDC.
           MOVE ZEROES                  TO RDC-GLS-DISP IN RDC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RDC-FEC-FTRN IN RDC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RDC-HRA-HRTR IN RDC.

           MOVE DBC-CAI-ICLI IN LOM-FLD TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN LOM-FLD TO RDC-IIC-ICLI IN RDC.
           MOVE CLF-CAI-ICLF IN LOM-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO RDC-IIC-ICLF IN RDC.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

       PUT-ACL SECTION.
       INI-PUT-ACL.
           IF DBC-IND-ICLI IN LOM-FLD = 'M'
               GO TO FIN-PUT-RDC.
           MOVE SPACES TO  ACL-GLS-FLAG IN ACL.
           MOVE SPACES                  TO ACL-GLS-DISP IN ACL.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO ACL-FEC-FTRN IN ACL.
      *    Hora Transaccion
           MOVE HOY-HHOY TO ACL-HRA-HRTR IN ACL.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO ACL-CAI-ICLF IN ACL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO ACL-IIC-ICLF IN ACL.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-ACL.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
       FIN-BCK-OUT.
           EXIT.

       REL-ENT SECTION.
       INI-REL-ENT.
           MOVE 'N' TO WSS-IND-ERCL IN WSS-VARI.
           MOVE 'N' TO WSS-IND-EDLO IN WSS-VARI.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO RCL-CAI-ICLF IN RCL.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO RCL-IIC-ICLF IN RCL.
           MOVE 'RCL-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-RCL.
           IF FIO-STAT-OKS
              MOVE 'S' TO WSS-IND-ERCL IN WSS-VARI.

           MOVE CLF-CAI-ICLF IN LOM-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              CLF-CAI-ICLF IN LOM-FLD = LDC-CAI-ICLF IN LDC AND
              CLF-IIC-ICLF IN LOM-FLD = LDC-IIC-ICLF IN LDC)
              GO TO FIN-REL-ENT
           ELSE
              MOVE 'S' TO WSS-IND-EDLO IN WSS-VARI.

       FIN-REL-ENT.
           EXIT.

       DEL-ARG SECTION.
       INI-DEL-ARG.
           MOVE SPACES TO ARG-KEY-IARG IN ARG.
           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARG.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARG.

           IF NOT ( FIO-STAT-OKS AND
              ARG-CIC-ICLF IN ARG = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ARG    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ARG.

           MOVE CLF-KEY-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARG.
       FIN-DEL-ARG.
           EXIT.

       DEL-RDC SECTION.
       INI-DEL-RDC.
           MOVE SPACES                TO RDC-CIC-ICLI IN RDC.
           MOVE CLF-KEY-ICLF IN CLF   TO RDC-KEY-ICLF IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-RDC.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.

           IF NOT ( FIO-STAT-OKS AND
              RDC-KEY-ICLF IN RDC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-RDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-DEL-RDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'RDC    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-RDC.

           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE CLF-KEY-ICLF IN CLF TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-RDC.
       FIN-DEL-RDC.
           EXIT.

       DEL-ACG SECTION.
       INI-DEL-ACG.
           MOVE SPACES TO ACG-KEY-IACG IN ACG.
           MOVE CLF-KEY-ICLF IN CLF TO ACG-CIC-ICLF IN ACG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ACG.
           PERFORM LDC-FIO-ACG.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ACG.

           IF NOT ( FIO-STAT-OKS AND
              ACG-CIC-ICLF IN ACG = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ACG.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACG.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ACG.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACG.

           MOVE CLF-KEY-ICLF IN CLF TO ACG-CIC-ICLF IN ACG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ACG.
       FIN-DEL-ACG.
           EXIT.

       DEL-LCC SECTION.
       INI-DEL-LCC.
           MOVE SPACES              TO LCC-KEY-ILCC IN LCC.
           MOVE CLF-KEY-ICLF IN CLF TO LCC-CIC-ICLF IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-LCC.
           PERFORM LDC-FIO-LCC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LCC.

           IF NOT ( FIO-STAT-OKS AND
              CLF-KEY-ICLF IN CLF = LCC-CIC-ICLF IN LCC )
               GO TO FIN-DEL-LCC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LCC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LCC.

           MOVE CLF-KEY-ICLF IN CLF TO LCC-CIC-ICLF IN LCC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-LCC.
       FIN-DEL-LCC.
           EXIT.

       DEL-LDC SECTION.
       INI-DEL-LDC.
           MOVE SPACES TO LDC-KEY-ILDC IN LDC.
           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-LDC.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.

           IF NOT ( FIO-STAT-OKS AND
              CLF-KEY-ICLF IN CLF = LDC-CIC-ICLF IN LDC )
               GO TO FIN-DEL-LDC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LDC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-LDC.

           MOVE CLF-KEY-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-LDC.
       FIN-DEL-LDC.
           EXIT.

       DEL-ACL SECTION.
       INI-DEL-ACL.
           MOVE SPACES              TO ACL-KEY-IACL IN ACL.
           MOVE CLF-KEY-ICLF IN CLF TO ACL-CIC-ICLF IN ACL.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ACL.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ACL.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ACL.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'ACL    DEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-DEL-ACL.

       FIN-DEL-ACL.
           EXIT.

       DEL-ARC SECTION.
       INI-DEL-ARC.
           MOVE SPACES TO ARC-KEY-IARC IN ARC.
           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ARC.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-ARC.

           IF NOT ( FIO-STAT-OKS AND
              ARC-CIC-ICLF IN ARC = CLF-KEY-ICLF IN CLF )
               GO TO FIN-DEL-ARC.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARC.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ARC.

           MOVE CLF-KEY-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           GO TO LUP-DEL-ARC.
       FIN-DEL-ARC.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       COPY LDCBFLMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

       BUS-DLO-DEM SECTION.
       INI-BUS-DLO.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE 'N'    TO WSS-IND-MLDC IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-CMAX IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE WSS-CAI-ICLF IN WSS-VARI TO LDC-CAI-ICLF IN LDC.
           MOVE WSS-IIC-ICLF IN WSS-VARI TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                   TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-DLO-DEM.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              WSS-CAI-ICLF IN WSS-VARI = LDC-CAI-ICLF IN LDC AND
              WSS-IIC-ICLF IN WSS-VARI = LDC-IIC-ICLF IN LDC)
              GO TO FIN-BUS-DLO.
           IF NOT (LDC-MSC-STAT IN LDC = 'D')

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *       GO TO NXT-DLO-DEM
              GO TO NXT-DLO-DEM.
      *     ELSE
      *        MOVE FIO-GET-KEY-UPD TO FIO-CMND
      *        PERFORM LDC-FIO-LDC
      *        MOVE 'R' TO LDC-MSC-STAT IN LDC
      *        MOVE FIO-MOD TO FIO-CMND
      *        PERFORM LDC-FIO-LDC

           MOVE LDC-VAL-CMAX IN LDC TO WSS-SGV-CMAX IN WSS-VARI.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           MOVE 'R' TO LDC-MSC-STAT IN LDC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS
              PERFORM INI-LMO.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
       NXT-DLO-DEM.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-DLO-DEM.
       FIN-BUS-DLO.
           EXIT.

      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
       INI-LMO SECTION.
       INI-INI-LMO.

           PERFORM ACT-FEC-FREC.
           MOVE ZEROES TO WSS-VAL-MORI IN WSS-VARI.

           COMPUTE WSS-VAL-MORI IN WSS-VARI = WSS-SGV-CMAX -
                   WSS-SGV-MUTI.

           MOVE SPACES TO LMO-GLS-FLAG IN LMO.
           MOVE SPACES TO LMO-FEC-FMOV IN LMO.
           MOVE SPACES TO LMO-HRA-HMOV IN LMO.
           MOVE SPACES TO LMO-CAI-ICLF IN LMO.
           MOVE SPACES TO LMO-IIC-ICLF IN LMO.
           MOVE ZEROES TO LMO-NUM-ILDC IN LMO.
           MOVE ZEROES TO LMO-STP-ITRN IN LMO.
           MOVE SPACES TO LMO-MSC-TACC IN LMO.
           MOVE SPACES TO LMO-MSC-STAT IN LMO.
           MOVE SPACES TO LMO-COD-OTRN IN LMO.
           MOVE SPACES TO LMO-COD-TIPO IN LMO.
           MOVE SPACES TO LMO-COD-VCLC IN LMO.
           MOVE ZEROES TO LMO-VAL-MORI IN LMO.
           MOVE ZEROES TO LMO-VAL-MPES IN LMO.
           MOVE SPACES TO LMO-CAI-IOPC IN LMO.
           MOVE SPACES TO LMO-IIC-IOPC IN LMO.
           MOVE SPACES TO LMO-COD-CLVA IN LMO.
           MOVE SPACES TO LMO-GLS-CMPA IN LMO.
           MOVE ZEROES TO LMO-SGV-CMPA IN LMO.
           MOVE SPACES TO LMO-COD-NCLV IN LMO.
           MOVE SPACES TO LMO-GLS-NCMP IN LMO.
           MOVE ZEROES TO LMO-SGV-NCMP IN LMO.
           MOVE SPACES TO LMO-COD-OFMV IN LMO.
           MOVE ZEROES TO LMO-FEC-FING IN LMO.
           MOVE SPACES TO LMO-GLS-DISP IN LMO.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY                 TO LMO-FEC-FMOV IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HMOV IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FING IN LMO.
           MOVE LDC-CAI-ICLF IN LDC      TO LMO-CAI-ICLF IN LMO.
           MOVE LDC-IIC-ICLF IN LDC      TO LMO-IIC-ICLF IN LMO.
           MOVE LDC-NUM-ILDC IN LDC      TO LMO-NUM-ILDC IN LMO.
           MOVE HOY-FHOY                 TO LMO-FEC-FTRN IN LMO.
           MOVE HOY-HHOY                 TO LMO-HRA-HRTR IN LMO.
           MOVE 'LDCPULOM'               TO LMO-COD-ATRN IN LMO.
           MOVE 1                        TO LMO-NUM-IMOV IN LMO.
           MOVE SCR-USER                 TO LMO-CIC-UING IN LMO.
           MOVE SCR-OTRN                 TO LMO-COD-OTRN IN LMO.
           MOVE WSS-SGV-MTO2 IN WSS-VARI TO LMO-VAL-MPES IN LMO.
           MOVE WSS-VAL-MORI IN WSS-VARI TO LMO-VAL-MORI IN LMO.
           MOVE WSS-COD-OFIC IN WSS-VARI TO LMO-COD-OFMV IN LMO.
           MOVE LDC-COD-TIPO IN LDC      TO LMO-COD-TIPO IN LMO.
           MOVE LDC-COD-VCLC IN LDC      TO LMO-COD-VCLC IN LMO.
           MOVE 'TER'                    TO LMO-COD-ECTB IN LMO.
           IF HOY-HHOY > 075959 AND HOY-HHOY < 140000
              MOVE 'M'                   TO LMO-IND-MODO IN LMO
           ELSE
              MOVE 'T'                   TO LMO-IND-MODO IN LMO.
           MOVE WSS-COD-TOOC IN WSS-VARI TO LMO-COD-TOOC IN LMO.
           MOVE WSS-COD-AOOC IN WSS-VARI TO LMO-COD-AOOC IN LMO.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LMO.

           MOVE LDC-CIC-ICLF IN LDC TO LCC-CIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-INI-LMO.

           MOVE WSS-SGV-MTO2 IN WSS-VARI TO
               LCC-VAL-MTO1 IN LCC
           MOVE ZEROES                   TO
               LCC-VAL-MTO2 IN LCC.

           MOVE FIO-MOD TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
       FIN-INI-LMO.
           EXIT.

       ACT-FEC-FREC SECTION.
       INI-ACT-FEC-FREC.
           MOVE LDC-CAI-ICLF IN LDC TO LCC-CAI-ICLF IN LCC.
           MOVE LDC-IIC-ICLF IN LDC TO LCC-IIC-ICLF IN LCC.
           MOVE LDC-NUM-ILDC IN LDC TO LCC-NUM-ILCC IN LCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-LCC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-ACT-FEC-FREC
           ELSE
              MOVE LCC-VAL-MUTI IN LCC TO WSS-SGV-MUTI IN WSS-VARI
              MOVE LCC-VAL-MTO2 IN LCC TO WSS-SGV-MTO2 IN WSS-VARI
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM LDC-FIO-LCC
              IF FIO-STAT-OKS
                 MOVE HOY-SHOY TO LCC-NUM-SREC IN LCC
                 MOVE HOY-AHOY TO LCC-NUM-AREC IN LCC
                 MOVE HOY-MHOY TO LCC-NUM-MREC IN LCC
                 MOVE HOY-DHOY TO LCC-NUM-DREC IN LCC
                 MOVE FIO-MOD TO FIO-CMND
                 PERFORM LDC-FIO-LCC.
       FIN-ACT-FEC-FREC.
           EXIT.

      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
      *>>>>                                                             
