      *
      * LDCBUDLO
      * Version 3.0.1 Nov-2005
      * 08-May-19 04:06 PM
      *
       SET-TAG-LDCBUDLO SECTION.
       INI-SET-TAG-LDCBUDLO.
           MOVE
           '<IDNMOD NOM=$LDCBUDLO$ VSN=$ $ VGM=$3.0.1$
      -    'GEN=$08-May-19 04:06 PM$ FNC=$ $/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBUDLO.
           EXIT.
           
       RET-ALL-DLO SECTION.
       INI-RET-ALL-DLO.
           PERFORM KEY-ALL-DLO.
           PERFORM RET-CLF-DLO.
           PERFORM RET-LDC-DLO.
           PERFORM RET-DBC-DLO.
           PERFORM RET-LCC-DLO.
           PERFORM RET-ICG-DLO.
       FIN-RET-ALL-DLO.
           EXIT.
       
       RET-CLF-DLO SECTION.
       INI-RET-CLF-DLO.
           MOVE CLF-COD-VCCF IN DLO-FLD TO CLF-COD-VCCF IN CLF.
           MOVE CLF-COD-TOCF IN DLO-FLD TO CLF-COD-TOCF IN CLF.
           MOVE CLF-COD-AOCF IN DLO-FLD TO CLF-COD-AOCF IN CLF.
       FIN-RET-CLF-DLO.
           EXIT.
       
       RET-LDC-DLO SECTION.
       INI-RET-LDC-DLO.
           MOVE LDC-COD-TIPO IN DLO-FLD TO LDC-COD-TIPO IN LDC.
           MOVE LDC-COD-VCLC IN DLO-FLD TO LDC-COD-VCLC IN LDC.
           MOVE LDC-VAL-CMAX IN DLO-FLD TO LDC-VAL-CMAX IN LDC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-NUM-DINI IN DLO-FLD TO LDC-NUM-DINI IN LDC.
           MOVE LDC-NUM-MINI IN DLO-FLD TO LDC-NUM-MINI IN LDC.
           MOVE LDC-NUM-SINI IN DLO-FLD TO LDC-NUM-SINI IN LDC.
           MOVE LDC-NUM-AINI IN DLO-FLD TO LDC-NUM-AINI IN LDC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-NUM-DVEN IN DLO-FLD TO LDC-NUM-DVEN IN LDC.
           MOVE LDC-NUM-MVEN IN DLO-FLD TO LDC-NUM-MVEN IN LDC.
           MOVE LDC-NUM-SVEN IN DLO-FLD TO LDC-NUM-SVEN IN LDC.
           MOVE LDC-NUM-AVEN IN DLO-FLD TO LDC-NUM-AVEN IN LDC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-MSC-STAT IN DLO-FLD TO LDC-MSC-STAT IN LDC.
           MOVE LDC-IND-VIGE IN DLO-FLD TO LDC-IND-VIGE IN LDC.
           MOVE LDC-NUM-PVIG IN DLO-FLD TO LDC-NUM-PVIG IN LDC.
           MOVE LDC-IND-PVIG IN DLO-FLD TO LDC-IND-PVIG IN LDC.
       FIN-RET-LDC-DLO.
           EXIT.
       
       RET-DBC-DLO SECTION.
       INI-RET-DBC-DLO.
           MOVE DBC-GLS-NOMC IN DLO-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN DLO-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN DLO-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DLO-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DLO-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-DBC-DLO.
           EXIT.
       
       RET-LCC-DLO SECTION.
       INI-RET-LCC-DLO.
           MOVE LCC-VAL-MADJ IN DLO-FLD TO LCC-VAL-MADJ IN LCC.
           MOVE LCC-VAL-MUTI IN DLO-FLD TO LCC-VAL-MUTI IN LCC.
           MOVE LCC-VAL-MTOS IN DLO-FLD TO LCC-VAL-MTOS IN LCC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LCC-NUM-DACV IN DLO-FLD TO LCC-NUM-DACV IN LCC.
           MOVE LCC-NUM-MACV IN DLO-FLD TO LCC-NUM-MACV IN LCC.
           MOVE LCC-NUM-SACV IN DLO-FLD TO LCC-NUM-SACV IN LCC.
           MOVE LCC-NUM-AACV IN DLO-FLD TO LCC-NUM-AACV IN LCC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LCC-NUM-DACT IN DLO-FLD TO LCC-NUM-DACT IN LCC.
           MOVE LCC-NUM-MACT IN DLO-FLD TO LCC-NUM-MACT IN LCC.
           MOVE LCC-NUM-SACT IN DLO-FLD TO LCC-NUM-SACT IN LCC.
           MOVE LCC-NUM-AACT IN DLO-FLD TO LCC-NUM-AACT IN LCC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LCC-NUM-DDES IN DLO-FLD TO LCC-NUM-DDES IN LCC.
           MOVE LCC-NUM-MDES IN DLO-FLD TO LCC-NUM-MDES IN LCC.
           MOVE LCC-NUM-SDES IN DLO-FLD TO LCC-NUM-SDES IN LCC.
           MOVE LCC-NUM-ADES IN DLO-FLD TO LCC-NUM-ADES IN LCC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LCC-NUM-DREC IN DLO-FLD TO LCC-NUM-DREC IN LCC.
           MOVE LCC-NUM-MREC IN DLO-FLD TO LCC-NUM-MREC IN LCC.
           MOVE LCC-NUM-SREC IN DLO-FLD TO LCC-NUM-SREC IN LCC.
           MOVE LCC-NUM-AREC IN DLO-FLD TO LCC-NUM-AREC IN LCC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LCC-NUM-DCTB IN DLO-FLD TO LCC-NUM-DCTB IN LCC.
           MOVE LCC-NUM-MCTB IN DLO-FLD TO LCC-NUM-MCTB IN LCC.
           MOVE LCC-NUM-SCTB IN DLO-FLD TO LCC-NUM-SCTB IN LCC.
           MOVE LCC-NUM-ACTB IN DLO-FLD TO LCC-NUM-ACTB IN LCC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-LCC-DLO.
           EXIT.
       
       RET-ICG-DLO SECTION.
       INI-RET-ICG-DLO.
           MOVE ICG-COD-TINT IN DLO-FLD TO ICG-COD-TINT IN ICG.
           MOVE ICG-SGV-TINT IN DLO-FLD TO ICG-SGV-TINT IN ICG.
      *<<<<
           IF(ICG-COD-CVTI IN ICG > SPACES)
              MOVE ICG-SGV-TINT IN DLO-FLD TO ICG-SGV-SPRD IN ICG
              MOVE ZEROES                  TO ICG-SGV-TINT IN ICG
           ELSE
              MOVE ZEROES                  TO ICG-SGV-SPRD IN ICG
              MOVE ICG-SGV-TINT IN DLO-FLD TO ICG-SGV-TINT IN ICG.
      *>>>>
       FIN-RET-ICG-DLO.
           EXIT.
       
       KEY-ALL-DLO SECTION.
       INI-KEY-ALL-DLO.
           PERFORM KEY-CLF-DLO.
           PERFORM KEY-LDC-DLO.
           PERFORM KEY-DBC-DLO.
           PERFORM KEY-LCC-DLO.
           PERFORM KEY-ICG-DLO.
       FIN-KEY-ALL-DLO.
           EXIT.
       
       KEY-CLF-DLO SECTION.
       INI-KEY-CLF-DLO.
       FIN-KEY-CLF-DLO.
           EXIT.
       
       KEY-LDC-DLO SECTION.
       INI-KEY-LDC-DLO.
           MOVE LDC-CAI-ICLF IN DLO-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-DLO.
           EXIT.
       
       KEY-DBC-DLO SECTION.
       INI-KEY-DBC-DLO.
       FIN-KEY-DBC-DLO.
           EXIT.
       
       KEY-LCC-DLO SECTION.
       INI-KEY-LCC-DLO.
       FIN-KEY-LCC-DLO.
           EXIT.
       
       KEY-ICG-DLO SECTION.
       INI-KEY-ICG-DLO.
       FIN-KEY-ICG-DLO.
           EXIT.
       
       SCR-CLRA-DLO SECTION.
       INI-SCR-CLRA-DLO.
           PERFORM CLR-KEY-DLO.
           PERFORM CLR-FLD-DLO.
       FIN-SCR-CLRA-DLO.
           EXIT.
       
       CLR-KEY-DLO SECTION.
       INI-CLR-KEY-DLO.
           MOVE SPACES TO LDC-CAI-ICLF IN DLO-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN DLO-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN DLO-FLD.
       FIN-CLR-KEY-DLO.
           EXIT.
       
       CLR-FLD-DLO SECTION.
       INI-CLR-FLD-DLO.
           MOVE SPACES TO FRM-GLS-VCCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TIPO IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-VCLC IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-TINT IN DLO-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN DLO-FLD.
           PERFORM CLR-CLF-DLO.
           PERFORM CLR-LDC-DLO.
           PERFORM CLR-DBC-DLO.
           PERFORM CLR-LCC-DLO.
           PERFORM CLR-ICG-DLO.
       FIN-CLR-FLD-DLO.
           EXIT.
       
       CLR-CLF-DLO SECTION.
       INI-CLR-CLF-DLO.
           MOVE SPACES TO CLF-COD-VCCF IN DLO-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN DLO-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN DLO-FLD.
       FIN-CLR-CLF-DLO.
           EXIT.
       
       CLR-LDC-DLO SECTION.
       INI-CLR-LDC-DLO.
           MOVE SPACES TO LDC-COD-TIPO IN DLO-FLD.
           MOVE SPACES TO LDC-COD-VCLC IN DLO-FLD.
           MOVE ZEROES TO LDC-VAL-CMAX IN DLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FINI IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FVEN IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO LDC-MSC-STAT IN DLO-FLD.
           MOVE SPACES TO LDC-IND-VIGE IN DLO-FLD.
           MOVE ZEROES TO LDC-NUM-PVIG IN DLO-FLD.
           MOVE SPACES TO LDC-IND-PVIG IN DLO-FLD.
       FIN-CLR-LDC-DLO.
           EXIT.
       
       CLR-DBC-DLO SECTION.
       INI-CLR-DBC-DLO.
           MOVE SPACES TO DBC-GLS-NOMC IN DLO-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN DLO-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN DLO-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-DLO.
           EXIT.
       
       CLR-LCC-DLO SECTION.
       INI-CLR-LCC-DLO.
           MOVE ZEROES TO LCC-VAL-MADJ IN DLO-FLD.
           MOVE ZEROES TO LCC-VAL-MUTI IN DLO-FLD.
           MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FACV IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FACT IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FDES IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FREC IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LCC-FEC-FCTB IN DLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-LCC-DLO.
           EXIT.
       
       CLR-ICG-DLO SECTION.
       INI-CLR-ICG-DLO.
           MOVE SPACES TO ICG-COD-TINT IN DLO-FLD.
           MOVE ZEROES TO ICG-SGV-TINT IN DLO-FLD.
       FIN-CLR-ICG-DLO.
           EXIT.
       
       FST-KEY-DLO SECTION.
       INI-FST-KEY-DLO.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN DLO-FLD.
       FIN-FST-KEY-DLO.
           EXIT.
       
       FST-FLD-DLO SECTION.
       INI-FST-FLD-DLO.
           MOVE -1 TO LDC-COD-TIPO-LEN IN DLO-FLD.
       FIN-FST-FLD-DLO.
           EXIT.
       
       PRO-KEY-DLO SECTION.
       INI-PRO-KEY-DLO.
           PERFORM PRO-MKY-DLO.
       FIN-PRO-KEY-DLO.
           EXIT.
       
       PRO-MKY-DLO SECTION.
       INI-PRO-MKY-DLO.
       FIN-PRO-MKY-DLO.
           EXIT.
       
       PRO-FLD-DLO SECTION.
       INI-PRO-FLD-DLO.
           PERFORM PRO-CLF-DLO.
           PERFORM PRO-LDC-DLO.
           PERFORM PRO-DBC-DLO.
           PERFORM PRO-LCC-DLO.
           PERFORM PRO-ICG-DLO.
       FIN-PRO-FLD-DLO.
           EXIT.
       
       PRO-CLF-DLO SECTION.
       INI-PRO-CLF-DLO.
       FIN-PRO-CLF-DLO.
           EXIT.
       
       PRO-LDC-DLO SECTION.
       INI-PRO-LDC-DLO.
           MOVE FRM-CPIM-AEY TO LDC-COD-TIPO-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-COD-VCLC-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-VAL-CMAX-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-FEC-FINI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-FEC-FVEN-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-MSC-STAT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-PVIG-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-PVIG-ATR IN DLO-FLD.
       FIN-PRO-LDC-DLO.
           EXIT.
       
       PRO-DBC-DLO SECTION.
       INI-PRO-DBC-DLO.
       FIN-PRO-DBC-DLO.
           EXIT.
       
       PRO-LCC-DLO SECTION.
       INI-PRO-LCC-DLO.
           MOVE FRM-CPIM-AEY TO LCC-VAL-MADJ-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LCC-VAL-MUTI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO LCC-VAL-MTOS-ATR IN DLO-FLD.
       FIN-PRO-LCC-DLO.
           EXIT.
       
       PRO-ICG-DLO SECTION.
       INI-PRO-ICG-DLO.
           MOVE FRM-CPIM-AEY TO ICG-COD-TINT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-AEY TO ICG-SGV-TINT-ATR IN DLO-FLD.
       FIN-PRO-ICG-DLO.
           EXIT.
       
       UNP-KEY-DLO SECTION.
       INI-UNP-KEY-DLO.
           PERFORM UNP-IKY-DLO.
           PERFORM UNP-AKY-DLO.
           PERFORM UNP-MKY-DLO.
       FIN-UNP-KEY-DLO.
           EXIT.
       
       UNP-IKY-DLO SECTION.
       INI-UNP-IKY-DLO.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-DLO.
           EXIT.
       
       UNP-MKY-DLO SECTION.
       INI-UNP-MKY-DLO.
       FIN-UNP-MKY-DLO.
           EXIT.
       
       UNP-AKY-DLO SECTION.
       INI-UNP-AKY-DLO.
       FIN-UNP-AKY-DLO.
           EXIT.
       
       UNP-FLD-DLO SECTION.
       INI-UNP-FLD-DLO.
           PERFORM UNP-CLF-DLO.
           PERFORM UNP-LDC-DLO.
           PERFORM UNP-DBC-DLO.
           PERFORM UNP-LCC-DLO.
           PERFORM UNP-ICG-DLO.
       FIN-UNP-FLD-DLO.
           EXIT.
       
       UNP-CLF-DLO SECTION.
       INI-UNP-CLF-DLO.
       FIN-UNP-CLF-DLO.
           EXIT.
       
       UNP-LDC-DLO SECTION.
       INI-UNP-LDC-DLO.
           MOVE FRM-CPIM-UBY TO LDC-COD-TIPO-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-COD-VCLC-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-VAL-CMAX-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FINI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FVEN-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-MSC-STAT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-VIGE-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-NUM-PVIG-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-PVIG-ATR IN DLO-FLD.
       FIN-UNP-LDC-DLO.
           EXIT.
       
       UNP-DBC-DLO SECTION.
       INI-UNP-DBC-DLO.
       FIN-UNP-DBC-DLO.
           EXIT.
       
       UNP-LCC-DLO SECTION.
       INI-UNP-LCC-DLO.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MADJ-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MUTI-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO LCC-VAL-MTOS-ATR IN DLO-FLD.
       FIN-UNP-LCC-DLO.
           EXIT.
       
       UNP-ICG-DLO SECTION.
       INI-UNP-ICG-DLO.
           MOVE FRM-CPIM-UBY TO ICG-COD-TINT-ATR IN DLO-FLD.
           MOVE FRM-CPIM-UBY TO ICG-SGV-TINT-ATR IN DLO-FLD.
       FIN-UNP-ICG-DLO.
           EXIT.
       
       VAL-MKY-DLO SECTION.
       INI-VAL-MKY-DLO.
       FIN-VAL-MKY-DLO.
           EXIT.
       
       VAL-FLD-DLO SECTION.
       INI-VAL-FLD-DLO.
      *<<<<
           IF SCR-CMND = 'MCA'
              PERFORM VAL-LDC-VAL-CMAX
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              END-IF
              PERFORM VAL-LCC-VAL-MADJ
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              ELSE
                  GO TO FIN-VAL-FLD-DLO.

           IF SCR-CMND = 'MLI'
              PERFORM VAL-LCC-VAL-MADJ
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              END-IF
              PERFORM VAL-LCC-VAL-MTOS
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              ELSE
                  GO TO FIN-VAL-FLD-DLO.
           IF SCR-CMND = 'ACU'
              PERFORM VAL-LCC-VAL-MUTI
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LCC-VAL-MUTI-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              ELSE
                  GO TO FIN-VAL-FLD-DLO.
           IF SCR-CMND = 'REC'
              PERFORM VAL-LDC-MSC-STAT
              IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                  MOVE FRM-IND-ERRO TO LDC-MSC-STAT-LEN IN DLO-FLD
                  GO TO FIN-VAL-FLD-DLO
              ELSE
                  GO TO FIN-VAL-FLD-DLO.
      *>>>>
           PERFORM VAL-CLF-COD-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-VCCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-CLF-COD-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-TOCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-CLF-COD-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-AOCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOCF-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-COD-TIPO-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TIPO-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-COD-VCLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-COD-VCLC-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-VCLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCLC-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-VAL-CMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LDC-FEC-FINI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-VAL-MADJ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LCC-VAL-MADJ-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LDC-FEC-FVEN-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-VAL-MUTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LCC-VAL-MUTI-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-MSC-STAT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-STAT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LCC-VAL-MTOS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LCC-VAL-MTOS-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IND-VIGE-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-ICG-COD-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ICG-COD-TINT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TINT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-ICG-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ICG-SGV-TINT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-NUM-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-NUM-PVIG-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-LDC-IND-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IND-PVIG-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
           PERFORM VAL-FRM-GLS-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PVIG-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-FEC-FACV.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LCC-FEC-FACV-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-FEC-FACT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LCC-FEC-FACT-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-FEC-FDES.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LCC-FEC-FDES-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-FEC-FREC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LCC-FEC-FREC-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LCC-FEC-FCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LCC-FEC-FCTB-LEN IN DLO-FLD
                GO TO FIN-VAL-FLD-DLO.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-FLD-DLO.
           EXIT.
       
       VAL-CLF-COD-VCCF SECTION.
       INI-VAL-CLF-COD-VCCF.
       FIN-VAL-CLF-COD-VCCF.
           EXIT.
       
       VAL-CLF-COD-TOCF SECTION.
       INI-VAL-CLF-COD-TOCF.
       FIN-VAL-CLF-COD-TOCF.
           EXIT.
       
       VAL-CLF-COD-AOCF SECTION.
       INI-VAL-CLF-COD-AOCF.
       FIN-VAL-CLF-COD-AOCF.
           EXIT.
       
       VAL-FRM-GLS-VCCF SECTION.
       INI-VAL-FRM-GLS-VCCF.
       FIN-VAL-FRM-GLS-VCCF.
           EXIT.
       
       VAL-FRM-GLS-TOCF SECTION.
       INI-VAL-FRM-GLS-TOCF.
       FIN-VAL-FRM-GLS-TOCF.
           EXIT.
       
       VAL-FRM-GLS-AOCF SECTION.
       INI-VAL-FRM-GLS-AOCF.
       FIN-VAL-FRM-GLS-AOCF.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN DLO-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN DLO-FLD.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN DLO-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN DLO-FLD.
      *<<<<
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DLO-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DLO-FLD.
      *>>>>
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN DLO-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN DLO-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DLO-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DLO-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LDC-COD-TIPO SECTION.
       INI-VAL-LDC-COD-TIPO.
           IF LDC-COD-TIPO IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-COD-TIPO IN DLO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN DLO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-COD-TIPO IN DLO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TIPO IN DLO-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-TIPO IN DLO-FLD.
      *<<<<
           IF(SCR-CMND = 'ING' OR 'MOD')
              MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN PRY-VARI
              MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN PRY-VARI
              MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN PRY-VARI
              MOVE LDC-COD-TIPO IN DLO-FLD TO LDC-COD-TIPO IN PRY-VARI
              PERFORM VAL-TIPO
              IF (PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-VAL-LDC-COD-TIPO.

           IF(SCR-CMND = 'ING' OR 'MOD')
              MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN PRY-VARI
              MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN PRY-VARI
              MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN PRY-VARI
              MOVE LDC-COD-TIPO IN DLO-FLD TO LDC-COD-TIPO IN PRY-VARI
              PERFORM VAL-TIPO-GBL
              IF (PRY-IND-ETIP NOT = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE 'TIP NO GBL'             TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-VAL-LDC-COD-TIPO.
      *>>>>
       FIN-VAL-LDC-COD-TIPO.
           EXIT.
       
       VAL-FRM-GLS-TIPO SECTION.
       INI-VAL-FRM-GLS-TIPO.
       FIN-VAL-FRM-GLS-TIPO.
           EXIT.
       
       VAL-LDC-COD-VCLC SECTION.
       INI-VAL-LDC-COD-VCLC.
           IF LDC-COD-VCLC IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-COD-VCLC IN DLO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-VCLC IN DLO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-COD-VCLC IN DLO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCLC IN DLO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCLC IN DLO-FLD.
       FIN-VAL-LDC-COD-VCLC.
           EXIT.
       
       VAL-FRM-GLS-VCLC SECTION.
       INI-VAL-FRM-GLS-VCLC.
       FIN-VAL-FRM-GLS-VCLC.
           EXIT.
       
       VAL-LDC-VAL-CMAX SECTION.
       INI-VAL-LDC-VAL-CMAX.
      *<<<<
           IF LDC-VAL-CMAX IN DLO-FLD NOT > ZEROES
              PERFORM  ERR-GLS
              GO TO FIN-VAL-LDC-VAL-CMAX.
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
           PERFORM GET-FHOY.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA

      *<<<<
           IF(SCR-CMND = 'MCA')
              IF (LDC-VAL-CMAX IN DLO-FLD < LCC-VAL-MUTI IN DLO-FLD)
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE 'APRO < ACUM'            TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-VAL-LDC-VAL-CMAX.

           IF(SCR-CMND = 'ING' OR 'MOD')
              MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN PRY-VARI
              MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN PRY-VARI
              MOVE LDC-VAL-CMAX IN DLO-FLD TO LDC-VAL-CMAX IN PRY-VARI
              MOVE LDC-COD-VCLC IN DLO-FLD TO LDC-COD-VCLC IN PRY-VARI
              MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN PRY-VARI
              PERFORM VAL-CMAX
              IF (PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE ZEROES TO LDC-VAL-CMAX IN DLO-FLD
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-VAL-LDC-VAL-CMAX.

           IF(SCR-CMND = 'MCA')
              COMPUTE LDC-VAL-CMAX IN PRY-VARI =
                      LDC-VAL-CMAX IN DLO-FLD - LDC-VAL-CMAX IN LDC
              IF LDC-VAL-CMAX IN PRY-VARI NOT > ZEROES
                 MOVE ZEROES TO LDC-VAL-CMAX IN PRY-VARI
              END-IF
              MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN PRY-VARI
              MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN PRY-VARI
              MOVE LDC-COD-VCLC IN DLO-FLD TO LDC-COD-VCLC IN PRY-VARI
              MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC IN PRY-VARI
              PERFORM VAL-CMAX
              IF (PRY-IND-ERRO     = 'S')
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   MOVE ZEROES TO LDC-VAL-CMAX IN DLO-FLD
                   MOVE 'S' TO SCR-IERR
                   GO TO FIN-VAL-LDC-VAL-CMAX.
      *>>>>
       FIN-VAL-LDC-VAL-CMAX.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LDC-FEC-FINI SECTION.
       INI-VAL-LDC-FEC-FINI.
           IF LDC-FEC-FINI IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LDC-FEC-FINI IN DLO-FLD.
      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FINI IN DLO-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<
           MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF LDC-FEC-FINI IN DLO-FLD  NOT > ZEROES
               MOVE CLF-NUM-DAPE IN CLF TO LDC-NUM-DINI IN DLO-FLD
               MOVE CLF-NUM-MAPE IN CLF TO LDC-NUM-MINI IN DLO-FLD
               MOVE CLF-NUM-SAPE IN CLF TO LDC-NUM-SINI IN DLO-FLD
               MOVE CLF-NUM-AAPE IN CLF TO LDC-NUM-AINI IN DLO-FLD.

           MOVE LDC-NUM-DINI IN DLO-FLD TO PRY-NUM-DINI IN PRY-VARI.
           MOVE LDC-NUM-MINI IN DLO-FLD TO PRY-NUM-MINI IN PRY-VARI.
           MOVE LDC-NUM-SINI IN DLO-FLD TO PRY-NUM-SINI IN PRY-VARI.
           MOVE LDC-NUM-AINI IN DLO-FLD TO PRY-NUM-AINI IN PRY-VARI.

           IF PRY-FEC-FINI IN PRY-VARI < CLF-FEC-FAPE IN CLF
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FINI<FAPE'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FINI.

      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FINI IN DLO-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FINI IN DLO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FINI.
           GO TO FIN-VAL-LDC-FEC-FINI.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FINI IN DLO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FINI.
       FIN-VAL-LDC-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LCC-VAL-MADJ SECTION.
       INI-VAL-LCC-VAL-MADJ.
      *<<<<
           IF(SCR-CMND = 'MOD')
               MOVE ZEROES TO LCC-VAL-MUTI IN DLO-FLD
               GO TO FIN-VAL-LCC-VAL-MADJ.

           IF(SCR-CMND = 'MCA')
                COMPUTE LCC-VAL-MADJ IN DLO-FLD  ROUNDED =
                       (LDC-VAL-CMAX IN DLO-FLD *
                        LCC-VAL-MTOS IN DLO-FLD) / 100.

           IF(SCR-CMND = 'MLI')
               MOVE 'DEU'                   TO TAB-COD-SIST
               MOVE 'LPI'                   TO TAB-COD-TTAB IN TAB
               MOVE LDC-COD-TIPO IN DLO-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS = 'COD    NEX' OR
                  LDC-COD-TIPO IN DLO-FLD NOT > SPACES
                   MOVE 'DEU'                    TO MSG-COD-SIST
                   MOVE 'LDC NO MLI'             TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC             TO FRM-MENS
                   MOVE FRM-SUAR-MAL             TO FRM-SUAR
                   GO TO FIN-VAL-LCC-VAL-MADJ
               ELSE
                   MOVE TAB-GLS-DAT1 IN TAB TO
                   PRY-GLS-DAT1 IN PRY-VARI
               END-IF
               IF (PRY-GLS-IND1 IN PRY-VARI NOT = 'S')
                    MOVE 'DEU'                    TO MSG-COD-SIST
                    MOVE 'LPI NO S '              TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC             TO FRM-MENS
                    MOVE FRM-SUAR-MAL             TO FRM-SUAR
                    GO TO FIN-VAL-LCC-VAL-MADJ
               ELSE
                    COMPUTE LCC-VAL-MTOS IN DLO-FLD  ROUNDED =
                           (LCC-VAL-MADJ IN DLO-FLD * 100) /
                            LDC-VAL-CMAX IN DLO-FLD.

           IF (LCC-VAL-MADJ IN DLO-FLD > LDC-VAL-CMAX IN DLO-FLD)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'VAL LIB >MAX'           TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LCC-VAL-MADJ.

           IF(SCR-CMND = 'MLI')
              IF (LCC-VAL-MADJ IN DLO-FLD < LCC-VAL-MUTI IN DLO-FLD)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'VAL LIB <ACU'           TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LCC-VAL-MADJ.
      *>>>>
       FIN-VAL-LCC-VAL-MADJ.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LDC-FEC-FVEN SECTION.
       INI-VAL-LDC-FEC-FVEN.
           IF LDC-FEC-FVEN IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LDC-FEC-FVEN IN DLO-FLD.
      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FVEN IN DLO-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<<
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FVEN IN DLO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FVEN.

      *AFRI-INI/AGO2008 (MAE)
           MOVE LDC-NUM-DINI IN DLO-FLD TO PRY-NUM-DINI IN PRY-VARI.
           MOVE LDC-NUM-MINI IN DLO-FLD TO PRY-NUM-MINI IN PRY-VARI.
           MOVE LDC-NUM-SINI IN DLO-FLD TO PRY-NUM-SINI IN PRY-VARI.
           MOVE LDC-NUM-AINI IN DLO-FLD TO PRY-NUM-AINI IN PRY-VARI.
           MOVE LDC-NUM-DVEN IN DLO-FLD TO PRY-NUM-DVEN IN PRY-VARI.
           MOVE LDC-NUM-MVEN IN DLO-FLD TO PRY-NUM-MVEN IN PRY-VARI.
           MOVE LDC-NUM-SVEN IN DLO-FLD TO PRY-NUM-SVEN IN PRY-VARI.
           MOVE LDC-NUM-AVEN IN DLO-FLD TO PRY-NUM-AVEN IN PRY-VARI.

           IF (PRY-FEC-FVEN NOT > ZEROES AND
               LDC-NUM-PVIG IN DLO-FLD NOT > ZEROES)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FEC NOVAL'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.

           IF LDC-NUM-PVIG IN DLO-FLD NOT > ZEROES AND
              LDC-FEC-FVEN IN DLO-FLD > ZEROES
               MOVE PRY-FEC-FINI      TO  WSS-FEC-FUNO
               MOVE PRY-FEC-FVEN      TO  WSS-FEC-FDOS
               PERFORM CAL-DIF-FECH
               IF (WSS-NUM-NDIA NOT > 999)
                    MOVE WSS-NUM-NDIA TO LDC-NUM-PVIG IN DLO-FLD
                    MOVE 'D'          TO LDC-IND-PVIG IN DLO-FLD
                    GO TO VAL-FEC-HBL
               ELSE
                    MOVE WSS-NUM-NMES TO LDC-NUM-PVIG IN DLO-FLD
                    MOVE 'M'          TO LDC-IND-PVIG IN DLO-FLD
                    GO TO VAL-FEC-HBL.


           IF LDC-NUM-PVIG IN DLO-FLD > ZEROES AND
              LDC-FEC-FVEN IN DLO-FLD > ZEROES
               MOVE PRY-FEC-FINI      TO  WSS-FEC-FUNO
               MOVE PRY-FEC-FVEN      TO  WSS-FEC-FDOS
               PERFORM CAL-DIF-FECH
               IF (WSS-NUM-NDIA NOT > 999)
                    MOVE WSS-NUM-NDIA TO LDC-NUM-PVIG IN DLO-FLD
                    MOVE 'D'          TO LDC-IND-PVIG IN DLO-FLD
                    GO TO VAL-FEC-HBL
               ELSE
                    MOVE WSS-NUM-NMES TO LDC-NUM-PVIG IN DLO-FLD
                    MOVE 'M'          TO LDC-IND-PVIG IN DLO-FLD
                    GO TO VAL-FEC-HBL.

           IF NOT (LDC-IND-PVIG IN DLO-FLD = 'D' OR 'M' OR 'A')
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'PERNO VAL'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.

      *    CAMBIA A FORMADO DD/MM/SSAA
           MOVE PRY-NUM-DINI TO FEC-TRN1.
           MOVE PRY-NUM-MINI TO FEC-TRN2.
           MOVE PRY-NUM-SINI TO FEC-TRN3.
           MOVE PRY-NUM-AINI TO FEC-TRN4.

      *    CALCULA FECHA SEGUN IND PVIG (D=DIA; M=MES;A=AGNO)
           IF (LDC-IND-PVIG IN DLO-FLD = 'D')
                MOVE WSS-FEC-TRN              TO FEC-FECH
                MOVE FEC-FORM-FEC             TO FEC-FORM
                MOVE FEC-FBLK-N               TO FEC-FBLK
                MOVE FEC-CHOY-N               TO FEC-CHOY
                MOVE FEC-VHBL-N               TO FEC-VHBL
                MOVE LDC-NUM-PVIG IN DLO-FLD  TO FEC-NDIA
                MOVE FEC-SUM-DIA              TO FEC-CMND
                PERFORM CAL-FEC
                IF NOT FEC-STAT-OKS
                    MOVE 'DEU'                    TO MSG-COD-SIST
                    MOVE 'FECNOVALI'              TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC             TO FRM-MENS
                    MOVE FRM-SUAR-MAL             TO FRM-SUAR
                    GO TO FIN-VAL-LDC-FEC-FVEN.

           IF (LDC-IND-PVIG IN DLO-FLD = 'M')
                MOVE WSS-FEC-TRN              TO FEC-FECH
                MOVE FEC-FORM-FEC             TO FEC-FORM
                MOVE FEC-FBLK-N               TO FEC-FBLK
                MOVE FEC-CHOY-N               TO FEC-CHOY
                MOVE FEC-VHBL-N               TO FEC-VHBL
                MOVE LDC-NUM-PVIG IN DLO-FLD  TO FEC-NMES
                MOVE FEC-SUM-MES              TO FEC-CMND
                PERFORM CAL-FEC
                IF NOT FEC-STAT-OKS
                    MOVE 'DEU'                    TO MSG-COD-SIST
                    MOVE 'FECNOVALI'              TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC             TO FRM-MENS
                    MOVE FRM-SUAR-MAL             TO FRM-SUAR
                    GO TO FIN-VAL-LDC-FEC-FVEN.

           IF (LDC-IND-PVIG IN DLO-FLD = 'A')
                MOVE WSS-FEC-TRN              TO FEC-FECH
                MOVE FEC-FORM-FEC             TO FEC-FORM
                MOVE FEC-FBLK-N               TO FEC-FBLK
                MOVE FEC-CHOY-N               TO FEC-CHOY
                MOVE FEC-VHBL-N               TO FEC-VHBL
                MOVE LDC-NUM-PVIG IN DLO-FLD  TO FEC-NANO
                MOVE FEC-SUM-ANO              TO FEC-CMND
                PERFORM CAL-FEC
                IF NOT FEC-STAT-OKS
                    MOVE 'DEU'                    TO MSG-COD-SIST
                    MOVE 'FECNOVALI'              TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC             TO FRM-MENS
                    MOVE FRM-SUAR-MAL             TO FRM-SUAR
                    GO TO FIN-VAL-LDC-FEC-FVEN.

           MOVE FEC-FECH TO WSS-FEC-TRN.

           MOVE FEC-TRN1 TO  PRY-NUM-DVEN IN PRY-VARI.
           MOVE FEC-TRN2 TO  PRY-NUM-MVEN IN PRY-VARI.
           MOVE FEC-TRN3 TO  PRY-NUM-SVEN IN PRY-VARI.
           MOVE FEC-TRN4 TO  PRY-NUM-AVEN IN PRY-VARI.

           MOVE SPACES                  TO PRY-IND-ERRO IN PRY-VARI.
           IF (PRY-FEC-FVEN IN PRY-VARI NOT > PRY-FEC-FINI IN PRY-VARI)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FECFUERAN'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.
           MOVE PRY-NUM-DVEN IN PRY-VARI TO LDC-NUM-DVEN IN DLO-FLD.
           MOVE PRY-NUM-MVEN IN PRY-VARI TO LDC-NUM-MVEN IN DLO-FLD.
           MOVE PRY-NUM-SVEN IN PRY-VARI TO LDC-NUM-SVEN IN DLO-FLD.
           MOVE PRY-NUM-AVEN IN PRY-VARI TO LDC-NUM-AVEN IN DLO-FLD.

           MOVE LDC-CAI-ICLF IN DLO-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO CLF-IIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF (CLF-FEC-FVEN IN CLF < PRY-FEC-FVEN IN PRY-VARI)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FEC>FCLF '              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.

       VAL-FEC-HBL.
           MOVE LDC-NUM-DVEN IN DLO-FLD TO FEC-ITM1.
           MOVE LDC-NUM-MVEN IN DLO-FLD TO FEC-ITM2.
           MOVE LDC-NUM-SVEN IN DLO-FLD TO FEC-ITM3.
           MOVE LDC-NUM-AVEN IN DLO-FLD TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-FBLK-N  TO FEC-FBLK
              MOVE FEC-CHOY-N  TO FEC-CHOY
              MOVE FEC-SIG-HBL TO FEC-CMND
              PERFORM CAL-FEC
              MOVE '00'  TO FEC-STAT.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FVEN IN DLO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FVEN.

           MOVE LDC-NUM-DVEN IN DLO-FLD TO PRY-NUM-DVEN IN PRY-VARI.
           MOVE LDC-NUM-MVEN IN DLO-FLD TO PRY-NUM-MVEN IN PRY-VARI.
           MOVE LDC-NUM-SVEN IN DLO-FLD TO PRY-NUM-SVEN IN PRY-VARI.
           MOVE LDC-NUM-AVEN IN DLO-FLD TO PRY-NUM-AVEN IN PRY-VARI.
           IF (PRY-FEC-FVEN NOT > PRY-FEC-FINI)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FVEN<FINI'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.

           IF (CLF-FEC-FVEN IN CLF < PRY-FEC-FVEN IN PRY-VARI)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'FEC>FCLF '              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LDC-FEC-FVEN.
           GO TO FIN-VAL-LDC-FEC-FVEN.
      *AFRI-FIN/AGO2008 (MAE)
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FVEN IN DLO-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FVEN.
       FIN-VAL-LDC-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LCC-VAL-MUTI SECTION.
       INI-VAL-LCC-VAL-MUTI.
      *<<<<
           IF (LCC-VAL-MUTI IN DLO-FLD > LDC-VAL-CMAX IN DLO-FLD)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'VAL  DIS>MAX'           TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                MOVE ZEROES TO LCC-VAL-MUTI IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MUTI.

           IF (LCC-VAL-MUTI IN DLO-FLD > LCC-VAL-MADJ IN DLO-FLD)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'VAL ACUM>LIB'           TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                MOVE ZEROES TO LCC-VAL-MUTI IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MUTI.
      *>>>>
       FIN-VAL-LCC-VAL-MUTI.
           EXIT.
       
       VAL-LDC-MSC-STAT SECTION.
       INI-VAL-LDC-MSC-STAT.
      *<<<<
           IF LDC-MSC-STAT IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-MSC-STAT IN DLO-FLD.

           IF SCR-CMND = 'REC'
              MOVE LDC-CAI-ICLF IN DLO-FLD TO LCC-CAI-ICLF IN LCC
              MOVE LDC-IIC-ICLF IN DLO-FLD TO LCC-IIC-ICLF IN LCC
              MOVE LDC-NUM-ILDC IN DLO-FLD TO LCC-NUM-ILCC IN LCC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM LDC-FIO-LCC
              IF FIO-STAT-OKS
                MOVE LCC-VAL-MUTI IN LCC TO LCC-VAL-MUTI IN DLO-FLD
                MOVE LCC-VAL-MADJ IN LCC TO LCC-VAL-MADJ IN DLO-FLD
      * EVA-INI  NOV-2008    CONTABILIDAD INMOBILIARIA
      *         MOVE 'R' TO LDC-MSC-STAT IN DLO-FLD.
                MOVE LCC-NUM-SACV IN LCC TO WSS-NUM-SACV IN WSS-VARI
                MOVE LCC-NUM-AACV IN LCC TO WSS-NUM-AACV IN WSS-VARI
                MOVE LCC-NUM-MACV IN LCC TO WSS-NUM-MACV IN WSS-VARI
                MOVE LCC-NUM-DACV IN LCC TO WSS-NUM-DACV IN WSS-VARI
                MOVE WSS-FEC-FACV IN WSS-VARI TO
                     LCC-FEC-FACV IN DLO-FLD
                MOVE LCC-NUM-SACT IN LCC TO WSS-NUM-SACT IN WSS-VARI
                MOVE LCC-NUM-AACT IN LCC TO WSS-NUM-AACT IN WSS-VARI
                MOVE LCC-NUM-MACT IN LCC TO WSS-NUM-MACT IN WSS-VARI
                MOVE LCC-NUM-DACT IN LCC TO WSS-NUM-DACT IN WSS-VARI
                MOVE WSS-FEC-FACT IN WSS-VARI TO
                     LCC-FEC-FACT IN DLO-FLD
                MOVE LCC-NUM-SDES IN LCC TO WSS-NUM-SDES IN WSS-VARI
                MOVE LCC-NUM-ADES IN LCC TO WSS-NUM-ADES IN WSS-VARI
                MOVE LCC-NUM-MDES IN LCC TO WSS-NUM-MDES IN WSS-VARI
                MOVE LCC-NUM-DDES IN LCC TO WSS-NUM-DDES IN WSS-VARI
                MOVE WSS-FEC-FDES IN WSS-VARI TO
                     LCC-FEC-FDES IN DLO-FLD
                MOVE LCC-NUM-SREC IN LCC TO WSS-NUM-SREC IN WSS-VARI
                MOVE LCC-NUM-AREC IN LCC TO WSS-NUM-AREC IN WSS-VARI
                MOVE LCC-NUM-MREC IN LCC TO WSS-NUM-MREC IN WSS-VARI
                MOVE LCC-NUM-DREC IN LCC TO WSS-NUM-DREC IN WSS-VARI
                MOVE WSS-FEC-FREC IN WSS-VARI TO
                     LCC-FEC-FREC IN DLO-FLD
                MOVE LCC-NUM-SCTB IN LCC TO WSS-NUM-SCTB IN WSS-VARI
                MOVE LCC-NUM-ACTB IN LCC TO WSS-NUM-ACTB IN WSS-VARI
                MOVE LCC-NUM-MCTB IN LCC TO WSS-NUM-MCTB IN WSS-VARI
                MOVE LCC-NUM-DCTB IN LCC TO WSS-NUM-DCTB IN WSS-VARI
                MOVE WSS-FEC-FCTB IN WSS-VARI TO
                     LCC-FEC-FCTB IN DLO-FLD.

           PERFORM GET-FHOY.
           IF SCR-CMND = 'REC'
              MOVE 'R' TO LDC-MSC-STAT IN DLO-FLD.
      * EVA-FIN  NOV-2008    CONTABILIDAD INMOBILIARIA
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'ESL ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-MSC-STAT IN DLO-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-MSC-STAT IN DLO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-STAT IN DLO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-STAT IN DLO-FLD.
      *>>>>
           IF LDC-MSC-STAT IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-MSC-STAT IN DLO-FLD.
       FIN-VAL-LDC-MSC-STAT.
           EXIT.
       
       VAL-FRM-GLS-STAT SECTION.
       INI-VAL-FRM-GLS-STAT.
       FIN-VAL-FRM-GLS-STAT.
           EXIT.
       
       VAL-LCC-VAL-MTOS SECTION.
       INI-VAL-LCC-VAL-MTOS.
      *<<<<
      *AFRI-INI/AGO2008 (MAE)

           IF (SCR-CMND = 'MOD' AND
               LCC-VAL-MTOS IN DLO-FLD NOT > ZEROES )
                MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD
                MOVE ZEROES TO LCC-VAL-MADJ IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MTOS.

           IF (SCR-CMND = 'ING' AND
               LCC-VAL-MTOS IN DLO-FLD NOT > ZEROES )
                MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD
                MOVE ZEROES TO LCC-VAL-MADJ IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MTOS.

           MOVE 'DEU'                   TO FIO-SIST.
           MOVE 'LPI'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN DLO-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY            TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = 'S' OR
               LDC-COD-TIPO IN DLO-FLD NOT > SPACES
               MOVE SPACES TO PRY-GLS-DAT1 IN PRY-VARI
           ELSE
               MOVE TAB-GLS-DAT1 IN TAB TO
                    PRY-GLS-DAT1 IN PRY-VARI.

           IF (SCR-CMND = 'ING' OR 'MOD') AND
              (PRY-GLS-IND1 IN PRY-VARI NOT = 'S' AND
               LCC-VAL-MTOS IN DLO-FLD > ZEROES)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'LPI NO S '              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                GO TO FIN-VAL-LCC-VAL-MTOS.

           IF (SCR-CMND = 'ING' AND
               PRY-GLS-IND1 IN PRY-VARI NOT = 'S')
                MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD
                MOVE ZEROES TO LCC-VAL-MADJ IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MTOS.

           IF (LCC-VAL-MTOS IN DLO-FLD < ZEROES OR
               LCC-VAL-MTOS IN DLO-FLD > 100)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'PORFUERAN'              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                MOVE ZEROES TO LCC-VAL-MTOS IN DLO-FLD
                GO TO FIN-VAL-LCC-VAL-MTOS.

           IF (SCR-CMND = 'ING' OR 'MOD')
                COMPUTE LCC-VAL-MADJ IN DLO-FLD  ROUNDED =
                   LCC-VAL-MTOS IN DLO-FLD *
                   LDC-VAL-CMAX IN DLO-FLD / 100.

      *AFRI-FIN/AGO2008 (MAE)
      *>>>>
       FIN-VAL-LCC-VAL-MTOS.
           EXIT.
       
       VAL-LDC-IND-VIGE SECTION.
       INI-VAL-LDC-IND-VIGE.
      *<<<<
      *    IF LDC-IND-VIGE IN DLO-FLD NOT > SPACES
      *       PERFORM  ERR-GLS
      *       GO TO FIN-VAL-LDC-IND-VIGE.
      *<<<<
           IF LDC-IND-VIGE IN DLO-FLD NOT > SPACES
              MOVE 'S' TO LDC-IND-VIGE IN DLO-FLD.
      *>>>>
      *>>>>
           IF LDC-IND-VIGE IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-VIGE IN DLO-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-IND-VIGE IN DLO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-LDC-IND-VIGE.
           EXIT.
       
       VAL-ICG-COD-TINT SECTION.
       INI-VAL-ICG-COD-TINT.
           IF ICG-COD-TINT IN DLO-FLD NOT > SPACES
              MOVE SPACES TO ICG-COD-TINT IN DLO-FLD.
      *<<<<
      *    IF ICG-COD-TINT IN DLO-FLD NOT > SPACES
      *       PERFORM  ERR-GLS
      *       GO TO FIN-VAL-ICG-COD-TINT.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'INT ' TO TAB-COD-TTAB IN TAB.
           MOVE ICG-COD-TINT IN DLO-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ICG-COD-TINT IN DLO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TINT IN DLO-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TINT IN DLO-FLD.
      *>>>>
       FIN-VAL-ICG-COD-TINT.
           EXIT.
       
       VAL-FRM-GLS-TINT SECTION.
       INI-VAL-FRM-GLS-TINT.
       FIN-VAL-FRM-GLS-TINT.
           EXIT.
       
       VAL-ICG-SGV-TINT SECTION.
       INI-VAL-ICG-SGV-TINT.
      *<<<<
      *    IF ICG-SGV-TINT IN DLO-FLD NOT > ZEROES
      *       PERFORM  ERR-GLS
      *       GO TO FIN-VAL-ICG-SGV-TINT.
           IF (ICG-SGV-TINT IN DLO-FLD > 100)
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE 'TINT>100 '              TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                MOVE ZEROES TO ICG-SGV-TINT IN DLO-FLD
                GO TO FIN-VAL-ICG-SGV-TINT.
      *>>>>
       FIN-VAL-ICG-SGV-TINT.
           EXIT.
       
       VAL-LDC-NUM-PVIG SECTION.
       INI-VAL-LDC-NUM-PVIG.
      *<<<<
      *>>>>
      *<<<<
      *    IF LDC-NUM-PVIG IN DLO-FLD NOT > ZEROES
      *       PERFORM  ERR-GLS
      *       GO TO FIN-VAL-LDC-NUM-PVIG.
      *>>>>
       FIN-VAL-LDC-NUM-PVIG.
           EXIT.
       
       VAL-LDC-IND-PVIG SECTION.
       INI-VAL-LDC-IND-PVIG.
      *<<<<
            IF LDC-IND-PVIG IN DLO-FLD NOT > SPACES
      *       PERFORM  ERR-GLS
              GO TO FIN-VAL-LDC-IND-PVIG.
      *>>>>
           IF LDC-IND-PVIG IN DLO-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-PVIG IN DLO-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE LDC-IND-PVIG IN DLO-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-IND-PVIG IN DLO-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PVIG IN DLO-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO
                    FRM-GLS-PVIG IN DLO-FLD.
       FIN-VAL-LDC-IND-PVIG.
           EXIT.
       
       VAL-FRM-GLS-PVIG SECTION.
       INI-VAL-FRM-GLS-PVIG.
       FIN-VAL-FRM-GLS-PVIG.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LCC-FEC-FACV SECTION.
       INI-VAL-LCC-FEC-FACV.
           IF LCC-FEC-FACV IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LCC-FEC-FACV IN DLO-FLD.
      *>>>>
           IF SCR-CMND = 'ACA'
              MOVE HOY-SHOY TO LCC-NUM-SACV IN DLO-FLD
              MOVE HOY-AHOY TO LCC-NUM-AACV IN DLO-FLD
              MOVE HOY-MHOY TO LCC-NUM-MACV IN DLO-FLD
              MOVE HOY-DHOY TO LCC-NUM-DACV IN DLO-FLD.

      *>>>>
       FIN-VAL-LCC-FEC-FACV.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LCC-FEC-FACT SECTION.
       INI-VAL-LCC-FEC-FACT.
           IF LCC-FEC-FACT IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LCC-FEC-FACT IN DLO-FLD.
       FIN-VAL-LCC-FEC-FACT.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LCC-FEC-FDES SECTION.
       INI-VAL-LCC-FEC-FDES.
           IF LCC-FEC-FDES IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LCC-FEC-FDES IN DLO-FLD.
       FIN-VAL-LCC-FEC-FDES.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LCC-FEC-FREC SECTION.
       INI-VAL-LCC-FEC-FREC.
           IF LCC-FEC-FREC IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LCC-FEC-FREC IN DLO-FLD.
      *<<<<<
           IF SCR-CMND = 'REC'
              MOVE HOY-SHOY TO LCC-NUM-SREC IN DLO-FLD
              MOVE HOY-AHOY TO LCC-NUM-AREC IN DLO-FLD
              MOVE HOY-MHOY TO LCC-NUM-MREC IN DLO-FLD
              MOVE HOY-DHOY TO LCC-NUM-DREC IN DLO-FLD.
      *>>>>
       FIN-VAL-LCC-FEC-FREC.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LCC-FEC-FCTB SECTION.
       INI-VAL-LCC-FEC-FCTB.
           IF LCC-FEC-FCTB IN DLO-FLD  NOT > ZEROES
              MOVE ZEROES TO LCC-FEC-FCTB IN DLO-FLD.
       FIN-VAL-LCC-FEC-FCTB.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-FLD-DLO SECTION.
       INI-VAL-CON-FLD-DLO.
       FIN-VAL-CON-FLD-DLO.
           EXIT.
       
       VAL-CON-DLO SECTION.
       INI-VAL-CON-DLO.
       FIN-VAL-CON-DLO.
           EXIT.
       
       VAL-NUM-KEY-DLO SECTION.
       INI-VAL-NUM-KEY-DLO.
           PERFORM VAL-NUM-IKY-DLO.
           PERFORM VAL-NUM-MKY-DLO.
           PERFORM VAL-NUM-AKY-DLO.
       FIN-VAL-NUM-KEY-DLO.
           EXIT.
       
       VAL-NUM-IKY-DLO SECTION.
       INI-VAL-NUM-IKY-DLO.
       VAL-NUM-LDC-IIC-ICLF.
           MOVE LDC-IIC-ICLF-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-IIC-ICLF IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-IIC-ICLF-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-IKY-DLO.
       VAL-NUM-LDC-NUM-ILDC.
           MOVE LDC-NUM-ILDC-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-ILDC IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-ILDC-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-IKY-DLO.
       FIN-VAL-NUM-IKY-DLO.
           EXIT.
       
       VAL-NUM-MKY-DLO SECTION.
       INI-VAL-NUM-MKY-DLO.
       FIN-VAL-NUM-MKY-DLO.
           EXIT.
       
       VAL-NUM-AKY-DLO SECTION.
       INI-VAL-NUM-AKY-DLO.
       FIN-VAL-NUM-AKY-DLO.
           EXIT.
       
       VAL-NUM-FLD-DLO SECTION.
       INI-VAL-NUM-FLD-DLO.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-LDC-VAL-CMAX.
           MOVE LDC-VAL-CMAX-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LDC-VAL-CMAX IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-VAL-CMAX-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MADJ.
           MOVE LCC-VAL-MADJ-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MADJ IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MADJ-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MUTI.
           MOVE LCC-VAL-MUTI-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MUTI IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MUTI-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LCC-VAL-MTOS.
           MOVE LCC-VAL-MTOS-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO LCC-VAL-MTOS IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LCC-VAL-MTOS-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-ICG-SGV-TINT.
           MOVE ICG-SGV-TINT-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO ICG-SGV-TINT IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ICG-SGV-TINT-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       VAL-NUM-LDC-NUM-PVIG.
           MOVE LDC-NUM-PVIG-ALF IN DLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-PVIG IN DLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-PVIG-LEN IN DLO-FLD
                GO TO FIN-VAL-NUM-FLD-DLO.
       FIN-VAL-NUM-FLD-DLO.
           EXIT.
       
       EDT-KEY-DLO SECTION.
       INI-EDT-KEY-DLO.
           PERFORM EDT-IKY-DLO.
           PERFORM EDT-MKY-DLO.
           PERFORM EDT-AKY-DLO.
       FIN-EDT-KEY-DLO.
           EXIT.
       
       EDT-IKY-DLO SECTION.
       INI-EDT-IKY-DLO.
           IF LDC-IIC-ICLF-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-IIC-ICLF-LEN IN DLO-FLD
                GO TO FIN-EDT-IKY-DLO.
           MOVE LDC-IIC-ICLF IN DLO-FLD TO LDC-IIC-ICLF-EDT IN DLO-EDT.
           MOVE LDC-IIC-ICLF-EDT IN DLO-EDT TO 
                LDC-IIC-ICLF-ALF IN DLO-FLD.
           IF LDC-NUM-ILDC-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-ILDC-LEN IN DLO-FLD
                GO TO FIN-EDT-IKY-DLO.
           MOVE LDC-NUM-ILDC IN DLO-FLD TO LDC-NUM-ILDC-EDT IN DLO-EDT.
           MOVE LDC-NUM-ILDC-EDT IN DLO-EDT TO 
                LDC-NUM-ILDC-ALF IN DLO-FLD.
       FIN-EDT-IKY-DLO.
           EXIT.
       
       EDT-MKY-DLO SECTION.
       INI-EDT-MKY-DLO.
       FIN-EDT-MKY-DLO.
           EXIT.
       
       EDT-AKY-DLO SECTION.
       INI-EDT-AKY-DLO.
       FIN-EDT-AKY-DLO.
           EXIT.
       
       EDT-FLD-DLO SECTION.
       INI-EDT-FLD-DLO.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE DBC-NUM-ICLI IN DLO-FLD TO
                DBC-NUM-ICLI-EDT IN DLO-EDT.
           MOVE DBC-NUM-ICLI-EDT IN DLO-EDT TO
                DBC-NUM-ICLI-ALF IN DLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF LDC-VAL-CMAX-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LDC-VAL-CMAX IN DLO-FLD TO LDC-VAL-CMAX-EDT IN DLO-EDT.
           MOVE LDC-VAL-CMAX-EDT IN DLO-EDT TO 
                LDC-VAL-CMAX-ALF IN DLO-FLD.
           IF LCC-VAL-MADJ-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MADJ-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MADJ IN DLO-FLD TO LCC-VAL-MADJ-EDT IN DLO-EDT.
           MOVE LCC-VAL-MADJ-EDT IN DLO-EDT TO 
                LCC-VAL-MADJ-ALF IN DLO-FLD.
           IF LCC-VAL-MUTI-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MUTI-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MUTI IN DLO-FLD TO LCC-VAL-MUTI-EDT IN DLO-EDT.
           MOVE LCC-VAL-MUTI-EDT IN DLO-EDT TO 
                LCC-VAL-MUTI-ALF IN DLO-FLD.
           IF LCC-VAL-MTOS-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LCC-VAL-MTOS-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LCC-VAL-MTOS IN DLO-FLD TO LCC-VAL-MTOS-EDT IN DLO-EDT.
           MOVE LCC-VAL-MTOS-EDT IN DLO-EDT TO 
                LCC-VAL-MTOS-ALF IN DLO-FLD.
           IF ICG-SGV-TINT-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ICG-SGV-TINT-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE ICG-SGV-TINT IN DLO-FLD TO ICG-SGV-TINT-EDT IN DLO-EDT.
           MOVE ICG-SGV-TINT-EDT IN DLO-EDT TO 
                ICG-SGV-TINT-ALF IN DLO-FLD.
           IF LDC-NUM-PVIG-LEN IN DLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-PVIG-LEN IN DLO-FLD
                GO TO FIN-EDT-FLD-DLO.
           MOVE LDC-NUM-PVIG IN DLO-FLD TO LDC-NUM-PVIG-EDT IN DLO-EDT.
           MOVE LDC-NUM-PVIG-EDT IN DLO-EDT TO 
                LDC-NUM-PVIG-ALF IN DLO-FLD.
       FIN-EDT-FLD-DLO.
           EXIT.
