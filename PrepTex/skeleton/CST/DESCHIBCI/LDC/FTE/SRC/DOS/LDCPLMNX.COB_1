       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.       LDCPLMNX.
       AUTHOR.           BEE-TEAM(RVM).
       DATE-WRITTEN.     26-SEP-1997 (UTLIMA MODIFICACION).

      *<<<< CMT_ID
      *RVM: PARA HACER ESTE PROGRAMA SE TOMO COMO BASE EL LDCPLALA
      *     (CARTOLA MULTILINEA)
      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C05 IS SALTO5
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTMNX         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTMNX         ASSIGN TO        UT-S-RPTMNX.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTMNX         ASSIGN TO        UT-S-RPTMNX.
      *<<<< IOS
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY LDCRRMNX.
      *<<<< RR
      *>>>>
       FD  RPTMNX LABEL RECORDS OMITTED
           RECORD CONTAINS 155 CHARACTERS.
       01  GRC-LINEA-MNX     PIC X(155).
      *<<<< FD_RPT
      *>>>>
      *<<<< FLS
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SEL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
      *COPY LDCBRSEL.
       COPY LDCBRMNX.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY LDCRWMNX.
      *<<<< RW
      *>>>>
       COPY LDCRNMNX.
       COPY LDCROMNX.
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY TABBRCOM.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABWGTVC.
       COPY TABBRCAM.

       COPY SGCBRDBC.
       COPY LDCBRPAG.
       COPY LDCBRRDC.
       COPY SGCBRRCD.
       COPY GNSWGCPT.
       COPY GNSWGMES.
       COPY GNSWGPES.

       01  WSS-VARI.
      *RVM-BEE-INI 26-SEP-1997
           03  WSS-CIC-IOPC.
               05  FILLER               PIC X(01).
               05  WSS-NUM-IOPC-9       PIC 9(11).
           03  WSS-ZZZ-IOPC.
               05  FILLER               PIC X(01).
               05  WSS-ZZZ-IOPC-9       PIC ZZZZZZZZZZZ.
      *RVM-BEE-FIN 26-SEP-1997
           03  WSS-SGV-UF               PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-NUM-NPAG             PIC 9(3).
           03  WSS-CIC-ICLF             PIC X(12) VALUE SPACES.
           03  WSS-NUM-ILDC             PIC 9(2) VALUE ZEROES.
           03  WSS-VAL-CMAX    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-IND-VIGE             PIC X(1) VALUE SPACES.
           03  WSS-MSC-STAT             PIC X(1) VALUE SPACES.
           03  WSS-FEC-FVEN.
               05  WSS-NUM-SVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-AVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-MVEN         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-DVEN         PIC 9(2) VALUE ZEROES.
           03  WSS-FEC-FPRO.
               05  WSS-NUM-SPRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-APRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-MPRO         PIC 9(2) VALUE ZEROES.
               05  WSS-NUM-DPRO         PIC 9(2) VALUE ZEROES.
      *RVM-CST-INI 08.09.1995
      *VARIABLE DE RESPALDO PARA FECHA DE REGISTRO SRT
           03  WSS-RCD-AUX              PIC X(158) VALUE SPACES.
           03  SEL-FEC-FPRO.
               05  SEL-NUM-SPRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-APRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-MPRO         PIC 9(2) VALUE ZEROES.
               05  SEL-NUM-DPRO         PIC 9(2) VALUE ZEROES.
           03  WSS-COD-OFIC             PIC X(03) VALUE SPACES.
           03  WSS-COD-EJEC             PIC X(12) VALUE SPACES.
           03  WSS-COD-TIPO             PIC X(03) VALUE SPACES.
           03  WSS-NUM-CARTO            PIC 9(05) VALUE ZEROES.
      *RVM-CST-FIN 08.09.1995
           03  WSS-COD-PESO             PIC X(06) VALUE SPACES.
           03  WSS-COD-UF               PIC X(06) VALUE SPACES.
           03  WSS-COD-DOLA             PIC X(06) VALUE SPACES.

           03  WSS-SGV-CAPI    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-REAJ    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-INTE    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-VAL-IMPU    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-MUTI    COMP-3   PIC 9(11)V9(4) VALUE ZEROES.
           03  WSS-SGV-MDIS    COMP-3   PIC S9(11)V9(4) VALUE ZEROES.
           03  WSS-COD-LUGA.
               05 WSS-COD-COMU          PIC X(04).
               05 WSS-RED-PAIS  REDEFINES  WSS-COD-COMU.
                  07 WSS-IND-PAIS       PIC X(01).
                  07 WSS-COD-PAIS       PIC X(03).
           03  WSS-GLS-COMU             PIC X(20) VALUE SPACES.
           03  WSS-GLS-CIUD             PIC X(20) VALUE SPACES.
           03  WSS-GLS-PAIS             PIC X(20) VALUE SPACES.
           03  WSS-NUM-OPER             PIC 9(8) VALUE ZEROES.
           03  WSS-GLS-FPRO.
               05 WSS-MES               PIC X(10).
               05 WSS-FIL1              PIC X(1) VALUE SPACES.
               05 WSS-SIGLO             PIC X(2).
               05 WSS-ANNO              PIC X(2).
           03  WSS-DIV                  PIC 9(3).
           03  WSS-REST                  PIC 9(3).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.

      *>>>>

      * AQUI EXISTIA LABEL RF INI
      *<<<< RF
      *>>>>
      * AQUI EXISTIA LABEL RF FIN
       COPY LDCRTMNX.
      *<<<< RT
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI
      *<<<< FIN_DEC
      *>>>>
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
      *    MOVE 'LDC' TO RPT-SIST.
           MOVE 'LDCPLMNX' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI
           PERFORM OBT-COD-MNAC.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.

           PERFORM OBT-COD-DOLA.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.

           PERFORM OBT-COD-UF.
           IF NOT FIO-STAT-OKS
               PERFORM GNS-PRO-ABT.
      *>>>>
           SORT GNSSRT
       COPY LDCRSMNX.
      *<<<< RS
      *>>>>
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
      *<<<< FIN
      *RVM-CST-INI 14-NOV-1995
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS LDCPLMNX'.
           DISPLAY '---------------------'.
           DISPLAY 'CARTOLAS EMITIDAS       : '
                  WSS-NUM-CARTO IN WSS-VARI.
           DISPLAY '---------------------'.
           DISPLAY ' '.
      *RVM-CST-FIN 14-NOV-1995
      *>>>>
           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
      *>>>>
      *    READY TRACE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCSEL FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO TABUSR FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO TABOFI FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

      *TABCAM
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: AL ABRIR ARCHIVO TABCAM '
               DISPLAY 'DE INPUT :  '    FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO SGCRCD FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCRDC FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-UPD TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO LDCPAG FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO SGCDBC FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           MOVE 'GNS' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ABORTO: ERROR APERTURA ARCHIVO GNSTAB FIO-STAT '
                       FIO-STAT
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           DISPLAY 'APERTURA ARCHIVOS ANEXOS OK'.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
      *RVM-CST-INI 08.09.1995
           IF FIO-STAT-OKS
               MOVE SEL-FEC-FPRO IN SEL TO SEL-FEC-FPRO IN WSS-VARI.
      *RVM-CST-FIN 08.09.1995

      *BUSCA VALOR DE CAMBIO DE DOLAR
           MOVE SEL-NUM-DPRO IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE SEL-NUM-MPRO IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE SEL-NUM-SPRO IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE SEL-NUM-APRO IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
      *BUSCA DE UF A PESO PARA LUEGO DIVIDIR.
           MOVE '101301'                   TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO   IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-UF IN WSS-VARI.

      *<<<< FIN_FST_INP
           PERFORM RESETEAR-SRT.
           IF (FIO-STAT-OKS AND SEL-IND-TREG IN SEL = '1')
             ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
             PERFORM MOVER-SEL-WSS
             MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI

             MOVE MES-DMES(SEL-NUM-MPRO IN SEL) TO WSS-MES IN WSS-VARI
             MOVE SEL-NUM-SPRO IN SEL TO WSS-SIGLO IN WSS-VARI
             MOVE SEL-NUM-APRO IN SEL TO WSS-ANNO IN WSS-VARI
             MOVE WSS-MES IN WSS-VARI TO CPT-STRN
             PERFORM CPT-BLKS
             MOVE CPT-STRN TO WSS-MES IN WSS-VARI
             MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT.
      *>>>>
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
      *     DISPLAY 'CLF Y OFI SEL : ' SEL-CIC-ICLF IN SEL ' '
      *                            SEL-COD-OFIC IN SEL.
      *
      *RVM-CST-INI 8-SEP-1995
      *     IF SEL-IND-TREG IN SEL = '1'
      *         MOVE SEL-COD-OFIC IN SEL TO SEL-COD-OFIC IN SRT
      *         MOVE SEL-COD-EJEC IN SEL TO SEL-COD-EJEC IN SRT
      *         PERFORM BUSCA-EJEC.
      *RVM-CST-FIN 8-SEP-1995

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL = WSS-CIC-ICLF IN WSS-VARI AND
               SEL-NUM-ILDC IN SEL NOT = WSS-NUM-ILDC IN WSS-VARI)

             ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
             PERFORM MOVER-SEL-WSS
             GO TO NXT-INP-SRT.

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL NOT = WSS-CIC-ICLF IN WSS-VARI)
      *RVM-CST-INI 14-NOV-1995
      *PARA SABER CUANTAS CARTOLAS DEBEN SERAN IMPRESAS
             ADD 1 TO WSS-NUM-CARTO IN WSS-VARI
      *RVM-CST-FIN 14-NOV-1995
             IF WSS-NUM-OPER IN WSS-VARI = 0
               PERFORM RESETEAR-SRT
      *RVM-CST-INI 22-SEP-1995
               MOVE WSS-COD-OFIC IN WSS-VARI TO SEL-COD-OFIC IN SRT
               MOVE WSS-COD-EJEC IN WSS-VARI TO SEL-COD-EJEC IN SRT
               PERFORM BUSCA-EJEC
               MOVE WSS-COD-TIPO IN WSS-VARI TO SEL-COD-TIPO IN SRT
      *RVM-CST-FIN 22-SEP-1995
               MOVE WSS-CIC-ICLF IN WSS-VARI TO SEL-CIC-ICLF IN SRT
               MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN SRT
               MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN SRT
               MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN SRT
               MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN SRT
               MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT
      * Se ingresan datos del cliente, ejecutivo y oficina a SRT
      *RVM-CST-INI 8-SEP-1995
      *         MOVE SEL-COD-OFIC IN SEL TO SEL-COD-OFIC IN SRT
      *         MOVE SEL-COD-EJEC IN SEL TO SEL-COD-EJEC IN SRT
      *         PERFORM BUSCA-EJEC
      *RVM-CST-FIN 8-SEP-1995
               MOVE WSS-CIC-ICLF IN WSS-VARI TO RDC-CIC-ICLF IN RDC
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM LDC-FIO-RDC
               IF (FIO-STAT-OKS AND
                    WSS-CIC-ICLF IN WSS-VARI = RDC-CIC-ICLF IN RDC)
                 MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
                 MOVE FIO-GET-KEY TO FIO-CMND
                 PERFORM SGC-FIO-DBC
                 IF FIO-STAT-OKS
      * DPM ini  1-AUG-1995
      *             MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                   MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOM2 IN SRT
      * DPM fin  1-AUG-1995
      *RVM         MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN SRT
                   PERFORM BUSCA-COMU
      *RVM         PERFORM BUSCA-EJEC
                 ELSE
                   MOVE SPACES TO WSS-GLS-NOMC IN SRT
                   MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM         MOVE SPACES TO DBC-COD-OFIC IN SRT
                   MOVE SPACES TO WSS-GLS-DIRE IN SRT
                   MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                   MOVE SPACES TO WSS-GLS-COMU IN SRT
                   MOVE SPACES TO WSS-GLS-COM2 IN SRT
                   MOVE SPACES TO WSS-GLS-CIUD IN SRT
                   MOVE SPACES TO WSS-GLS-CIU2 IN SRT
               ELSE
                 MOVE SPACES TO WSS-GLS-NOMC IN SRT
                 MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE SPACES TO DBC-COD-OFIC IN SRT
                 MOVE SPACES TO WSS-GLS-DIRE IN SRT
                 MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                 MOVE SPACES TO WSS-GLS-COMU IN SRT
                 MOVE SPACES TO WSS-GLS-COM2 IN SRT
                 MOVE SPACES TO WSS-GLS-CIUD IN SRT
                 MOVE SPACES TO WSS-GLS-CIU2 IN SRT.

      *RVM
      *     DISPLAY 'SEL-IND-TREG : ' SEL-IND-TREG IN SEL
      *     DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SEL
      *     DISPLAY 'WSS-CIC-ICLF : ' WSS-CIC-ICLF IN WSS-VARI
      *     DISPLAY 'WSS-NUM-OPER : ' WSS-NUM-OPER IN WSS-VARI

           IF (SEL-IND-TREG IN SEL = '1' AND
               SEL-CIC-ICLF IN SEL NOT = WSS-CIC-ICLF IN WSS-VARI)
             IF WSS-NUM-OPER IN WSS-VARI = 0
      *RVM
      *         DISPLAY 'CLF Y OFI SRT1 : ' SEL-CIC-ICLF IN SRT
      *                               SEL-COD-OFIC IN SRT
      *RVM
               RELEASE SRT
               PERFORM GRABAR-NUM-PAG
               PERFORM MOVER-SEL-WSS
               MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI
      *DPM INI  26-APR-1996
               MOVE ZEROES TO WSS-VAL-IMPU IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-CAPI IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-REAJ IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-INTE IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
      *DPM FIN  26-APR-1996
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
               ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
               GO TO NXT-INP-SRT
             ELSE
             IF WSS-NUM-OPER IN WSS-VARI > 0
               PERFORM GRABAR-NUM-PAG
               MOVE ZEROES TO WSS-VAL-IMPU IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-CAPI IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-REAJ IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-INTE IN WSS-VARI
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
               MOVE ZEROES TO WSS-NUM-OPER IN WSS-VARI
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
               PERFORM MOVER-SEL-WSS
               MOVE SEL-FEC-FVEN IN SEL TO WSS-FEC-FVEN IN WSS-VARI
               ADD SEL-VAL-CMAX IN SEL TO WSS-VAL-CMAX IN WSS-VARI
               GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '2'
             MOVE SEL TO SE3
             ADD SE3-VAL-IMPU IN SE3 TO WSS-VAL-IMPU IN WSS-VARI
             GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '3'
             MOVE SEL TO SE2
             ADD SE2-SGV-CAPI IN SE2 TO WSS-SGV-CAPI IN WSS-VARI
             ADD SE2-SGV-REAJ IN SE2 TO WSS-SGV-REAJ IN WSS-VARI
             ADD SE2-SGV-INTE IN SE2 TO WSS-SGV-INTE IN WSS-VARI
             GO TO NXT-INP-SRT.

           IF SEL-IND-TREG IN SEL = '4'
             MOVE SEL TO SE1
      *RVM-CST-INI 09.09.1995
      *      ADD SE1-VAL-SCRE IN SE1 TO WSS-SGV-MUTI IN WSS-VARI
             PERFORM CAL-SGV-MUTI
      *RVM-CST-FIN 09.09.1995
             PERFORM GRABAR-SEL-SRT

      * Se ingresan datos del cliente, ejecutivo y oficina a SRT
             MOVE WSS-CIC-ICLF IN WSS-VARI TO RDC-CIC-ICLF IN RDC
             MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
             MOVE FIO-GET-NLS TO FIO-CMND
             PERFORM LDC-FIO-RDC
             IF (FIO-STAT-OKS AND
                  WSS-CIC-ICLF IN WSS-VARI = RDC-CIC-ICLF IN RDC)
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
      * DPM ini  1-AUG-1995
                 MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                 PERFORM CPT-BLKS
                 MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
      * DPM fin  1-AUG-1995
                 MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOMC IN SRT
                 MOVE DBC-GLS-NOMC IN DBC TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE DBC-COD-OFIC IN DBC TO DBC-COD-OFIC IN SRT
                 PERFORM BUSCA-COMU
      *RVM       PERFORM BUSCA-EJEC
               ELSE
                 MOVE SPACES TO WSS-GLS-NOMC IN SRT
                 MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM       MOVE SPACES TO DBC-COD-OFIC IN SRT
                 MOVE SPACES TO WSS-GLS-DIRE IN SRT
                 MOVE SPACES TO WSS-GLS-DIR2 IN SRT
                 MOVE SPACES TO WSS-GLS-COMU IN SRT
                 MOVE SPACES TO WSS-GLS-COM2 IN SRT
                 MOVE SPACES TO WSS-GLS-CIUD IN SRT
                 MOVE SPACES TO WSS-GLS-CIU2 IN SRT
             ELSE
               MOVE SPACES TO WSS-GLS-NOMC IN SRT
               MOVE SPACES TO WSS-GLS-NOM2 IN SRT
      *RVM     MOVE SPACES TO DBC-COD-OFIC IN SRT
               MOVE SPACES TO WSS-GLS-DIRE IN SRT
               MOVE SPACES TO WSS-GLS-DIR2 IN SRT
               MOVE SPACES TO WSS-GLS-COMU IN SRT
               MOVE SPACES TO WSS-GLS-COM2 IN SRT
               MOVE SPACES TO WSS-GLS-CIUD IN SRT
               MOVE SPACES TO WSS-GLS-CIU2 IN SRT.

           IF SEL-IND-TREG IN SEL = '4'
             RELEASE SRT.
           GO TO NXT-INP-SRT.
      *>>>>
       MOV-INP-SRT.
       COPY LDCRMMNX.
      *<<<< RM
      *>>>>
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
      *RVM-CST-INI 08.09.1995
           IF FIO-STAT-OKS
               MOVE SEL-FEC-FPRO IN SEL TO SEL-FEC-FPRO IN WSS-VARI.
      *RVM-CST-FIN 08.09.1995
      *    DISPLAY 'LEO SEL : ' FIO-STAT.
      *    DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SEL.
      *    DISPLAY 'SEL-NUM-ILDC : ' SEL-NUM-ILDC IN SEL.
      *    DISPLAY 'SEL-FEC-FPRO : ' SEL-FEC-FPRO IN SEL.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
      *<<<< FIN_INP
           PERFORM GRABAR-NUM-PAG.
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-SEL.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
      *<<<< INI_OUT
      *>>>>
           OPEN OUTPUT RPTMNX.
      *     MOVE 'LDCPLMNX' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           PERFORM INITIATE-RPTMNX.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           MOVE SRT TO SRT-OLD-MNX.
           MOVE SRT TO SRT-CUR-MNX.
      *RVM
      *     DISPLAY '1 BUSCA-OFIC'.
      *     DISPLAY 'SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SRT.
      *     DISPLAY 'SEL-COD-OFIC : ' SEL-COD-OFIC IN SRT.
      *RVM
           PERFORM BUSCA-OFIC.
      *RVM-CST-INI 12-SEP-1996
           PERFORM BUSCA-MULTI.
      *RVM-CST-FIN 12-SEP-1996
           MOVE SEL-CIC-ICLF IN SRT TO PAG-CIC-ICLF IN PAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF FIO-STAT-OKS
             MOVE PAG-VAL-CMAX IN PAG TO WSS-VAL-CMAX IN WSS-VARI
             MOVE PAG-NUM-SVEN IN PAG TO WSS-NUM-SVEN IN WSS-VARI
             MOVE PAG-NUM-AVEN IN PAG TO WSS-NUM-AVEN IN WSS-VARI
             MOVE PAG-NUM-MVEN IN PAG TO WSS-NUM-MVEN IN WSS-VARI
             MOVE PAG-NUM-DVEN IN PAG TO WSS-NUM-DVEN IN WSS-VARI
             MOVE PAG-VAL-IMPU IN PAG TO WSS-VAL-IMPU IN WSS-VARI
             MOVE PAG-SGV-CAPI IN PAG TO WSS-SGV-CAPI IN WSS-VARI
             MOVE PAG-SGV-REAJ IN PAG TO WSS-SGV-REAJ IN WSS-VARI
             MOVE PAG-SGV-INTE IN PAG TO WSS-SGV-INTE IN WSS-VARI
             MOVE PAG-SGV-MUTI IN PAG TO WSS-SGV-MUTI IN WSS-VARI
             MOVE PAG-SGV-MDIS IN PAG TO WSS-SGV-MDIS IN WSS-VARI
      *       MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-VARI.
             MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-MNX.
           PERFORM MNX-FST-PRO-CTL.
      *<<<< FST_OUT
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           MOVE SEL-CIC-ICLF IN SRT TO PAG-CIC-ICLF IN PAG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
           IF FIO-STAT-OKS
             MOVE PAG-VAL-CMAX IN PAG TO WSS-VAL-CMAX IN WSS-VARI
             MOVE PAG-NUM-SVEN IN PAG TO WSS-NUM-SVEN IN WSS-VARI
             MOVE PAG-NUM-AVEN IN PAG TO WSS-NUM-AVEN IN WSS-VARI
             MOVE PAG-NUM-MVEN IN PAG TO WSS-NUM-MVEN IN WSS-VARI
             MOVE PAG-NUM-DVEN IN PAG TO WSS-NUM-DVEN IN WSS-VARI
             MOVE PAG-VAL-IMPU IN PAG TO WSS-VAL-IMPU IN WSS-VARI
             MOVE PAG-SGV-CAPI IN PAG TO WSS-SGV-CAPI IN WSS-VARI
             MOVE PAG-SGV-REAJ IN PAG TO WSS-SGV-REAJ IN WSS-VARI
             MOVE PAG-SGV-INTE IN PAG TO WSS-SGV-INTE IN WSS-VARI
             MOVE PAG-SGV-MUTI IN PAG TO WSS-SGV-MUTI IN WSS-VARI
             MOVE PAG-SGV-MDIS IN PAG TO WSS-SGV-MDIS IN WSS-VARI
      *       MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-VARI.
             MOVE PAG-NUM-NPAG IN PAG TO WSS-NUM-NPAG IN WSS-MNX
           ELSE
             DISPLAY 'ERROR DE LECTURA PAG PARA LLAVE '
                      PAG-CIC-ICLF IN PAG.
      *

      *>>>>
       GEN-OUT-SRT.
           PERFORM MNX-CLR-VAR-CTL.
           PERFORM MNX-CHK-VAR-CTL.
           MOVE SRT TO SRT-CUR-MNX.
           MOVE SRT-OLD-MNX TO SRT.
           PERFORM MNX-PRO-VAR-CTL-CF.
           MOVE SRT-CUR-MNX TO SRT.
           PERFORM MNX-PRO-VAR-CTL-CH.
           PERFORM MNX-PRO-DET-LIN.
      *<<<< FIN_GEN_OUT
           PERFORM MOVER-WSS-MNX.
      *>>>>
       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-MNX.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
           PERFORM MOVER-WSS-MNX.
      *     GENERATE DL-MNX.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
      *>>>>
           PERFORM TERMINATE-RPTMNX.
      *<<<< FIN_TMT
      *>>>>
           CLOSE RPTMNX.
       EXT-OUT-SRT.
           EXIT.
      *COPY LDCBFSEL.
       COPY LDCBFMNX.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY LDCREMNX.
      *    09-AUG-95 05:51 PM     ,PAI=CHI ,CLI=BCI ,SOP=MVS
       D-CF-MNX-SEL-COD-OFIC SECTION.
       INI-CF-MNX-SEL-COD-OFIC.
      *<<<< CF_MNX_SEL_COD_OFIC
           PERFORM BUSCA-OFIC.
      *RVM-CST-INI 12-SEP-1996
           PERFORM BUSCA-MULTI.
      *RVM-CST-FIN 12-SEP-1996
      *>>>> CF_MNX_DBC_COD_OFIC
       FIN-CF-MNX-SEL-COD-OFIC.
           EXIT.
       D-CF-MNX-WSS-GLS-DIRE SECTION.
       INI-CF-MNX-WSS-GLS-DIRE.
       FIN-CF-MNX-WSS-GLS-DIRE.
           EXIT.
       D-CF-MNX-WSS-GLS-COMU SECTION.
       INI-CF-MNX-WSS-GLS-COMU.
       FIN-CF-MNX-WSS-GLS-COMU.
           EXIT.
       D-CF-MNX-SEL-CIC-ICLF SECTION.
       INI-CF-MNX-SEL-CIC-ICLF.
      *<<<< CF_MNX_SEL_CIC_ICLF
           MOVE ZEROES TO RPT-MNX-PAGE-COUNTER.
      *>>>>
       FIN-CF-MNX-SEL-CIC-ICLF.
           EXIT.
       D-PH-MNX SECTION.
       INI-PH-MNX.
      *<<<< PH_MNX
           PERFORM BUSCA-OFIC.
      *RVM-CST-INI 12-SEP-1996
           PERFORM BUSCA-MULTI.
      *RVM-CST-FIN 12-SEP-1996
      *>>>>
       FIN-PH-MNX.
           EXIT.
       D-DL-MNX SECTION.
       INI-DL-MNX.
       FIN-DL-MNX.
           EXIT.
       COPY GNSBGABT.

      *<<<< EOF
       MOVER-SEL-WSS SECTION.
       INI-MOVER-SEL-WSS.
      *RVM-CST-INI 22-SEP-1995
           MOVE SEL-COD-OFIC IN SEL TO WSS-COD-OFIC IN WSS-VARI.
           MOVE SEL-COD-EJEC IN SEL TO WSS-COD-EJEC IN WSS-VARI.
           MOVE SEL-COD-TIPO IN SEL TO WSS-COD-TIPO IN WSS-VARI.
      *RVM-CST-FIN 22-SEP-1995
           MOVE SEL-CIC-ICLF IN SEL TO WSS-CIC-ICLF IN WSS-VARI.
           MOVE SEL-NUM-ILDC IN SEL TO WSS-NUM-ILDC IN WSS-VARI.
      *     MOVE SEL-IND-VIGE IN SEL TO WSS-IND-VIGE IN WSS-VARI.
      *     MOVE SEL-MSC-STAT IN SEL TO WSS-MSC-STAT IN WSS-VARI.
           MOVE SEL-FEC-FPRO IN SEL TO WSS-FEC-FPRO IN WSS-VARI.
       FIN-MOVER-SEL-WSS.
           EXIT.

       GRABAR-SEL-SRT SECTION.
       INI-GRABAR-SEL-SRT.
      *RVM-CST-INI 22-SEP-1995
           MOVE WSS-COD-OFIC IN WSS-VARI TO SEL-COD-OFIC IN SRT.
           MOVE WSS-COD-EJEC IN WSS-VARI TO SEL-COD-EJEC IN SRT.
           PERFORM BUSCA-EJEC.
           MOVE WSS-COD-TIPO IN WSS-VARI TO SEL-COD-TIPO IN SRT.
      *RVM-CST-FIN 22-SEP-1995
           MOVE WSS-CIC-ICLF IN WSS-VARI TO SEL-CIC-ICLF IN SRT.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN SRT.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN SRT.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN SRT.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN SRT.
           MOVE WSS-GLS-FPRO IN WSS-VARI TO WSS-GLS-FPRO IN SRT.

      *RVM-BEE-INI 26-SEP-1997
      * SE EDITA EL CAMPO, PARA SACAR 'G' Y ZEROES A LA IZQUIERDA
      *    MOVE SE1-CIC-IOPC IN SE1 TO SE1-CIC-IOPC IN SRT.
           MOVE SE1-CIC-IOPC IN SE1 TO WSS-CIC-IOPC IN WSS-VARI.
           MOVE WSS-NUM-IOPC-9 IN WSS-VARI TO
                                           WSS-ZZZ-IOPC-9 IN WSS-VARI.
           MOVE WSS-ZZZ-IOPC IN WSS-VARI TO SE1-CIC-IOPC IN SRT.
      *RVM-BEE-FIN 26-SEP-1997

      *RVM-CST-INI 16-SEP-1996
           MOVE SE1-NUM-SCOL IN SE1 TO SE1-NUM-SCOL IN SRT.
           MOVE SE1-NUM-ACOL IN SE1 TO SE1-NUM-ACOL IN SRT.
      *RVM-CST-FIN 16-SEP-1996
           MOVE SE1-NUM-MCOL IN SE1 TO SE1-NUM-MCOL IN SRT.
           MOVE SE1-NUM-DCOL IN SE1 TO SE1-NUM-DCOL IN SRT.
           MOVE SE1-GLS-TIAV IN SE1 TO SE1-GLS-TIAV IN SRT.
           MOVE SE1-VAL-CRED IN SE1 TO SE1-VAL-CRED IN SRT.
           MOVE SE1-VAL-SCRE IN SE1 TO SE1-VAL-SCRE IN SRT.
           MOVE SE1-GLS-MONE IN SE1 TO SE1-GLS-MONE IN SRT.
           MOVE SE1-VAL-SFIN IN SE1 TO SE1-VAL-SFIN IN SRT.
           MOVE SE1-NUM-SVEN IN SE1 TO SE1-NUM-SVEN IN SRT.
           MOVE SE1-NUM-AVEN IN SE1 TO SE1-NUM-AVEN IN SRT.
           MOVE SE1-NUM-MVEN IN SE1 TO SE1-NUM-MVEN IN SRT.
           MOVE SE1-NUM-DVEN IN SE1 TO SE1-NUM-DVEN IN SRT.
           MOVE SE1-IND-SCTB IN SE1 TO SE1-IND-SCTB IN SRT.

           ADD 1                    TO WSS-NUM-OPER IN WSS-VARI.

       FIN-GRABAR-SEL-SRT.
           EXIT.


       BUSCA-COMU SECTION.
       INI-BUSCA-COMU.

      * Mediante BUS-DOM y BUS-TAB Busca Comuna Obteniendo Codigos de Ta
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE ZEROES      TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT ( FIO-STAT-OKS AND
                    DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD )
               DISPLAY 'ERROR: NO EXISTE DIRECCION PARA CIC : '
                   DBC-CIC-ICLI IN DBC
               GO TO FIN-BUSCA-COMU.

      *RVM-CST-INI 26-SEP-1995
      *GUARDA PRIMERA DIRECCION EN CASO DE QUE NO TENGA DIRECCION TIPO
      * 'D' ASOCIADA.
           MOVE RCD TO WSS-RCD-AUX IN WSS-VARI.

       LUP-BUSCA-COMU.
           IF NOT ( FIO-STAT-OKS AND
                    DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD )
      *RESTAURA RCD LEIDO
               MOVE WSS-RCD-AUX TO RCD
               GO TO EXT-BUSCA-COMU.

           IF RCD-MSC-TDIR IN RCD NOT = 'D'
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM SGC-FIO-RCD
               GO TO LUP-BUSCA-COMU.

       EXT-BUSCA-COMU.
      *RVM-CST-FIN 26-SEP-1995
           IF RCD-GLS-DIRE IN RCD > SPACES

               MOVE RCD-GLS-DIRE IN RCD TO WSS-GLS-DIRE IN SRT
               MOVE RCD-GLS-DIRE IN RCD TO WSS-GLS-DIR2 IN SRT

               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA IN WSS-VARI
               IF WSS-IND-PAIS NOT = 'P'
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'COM'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-LUGA IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB TO COM
                   MOVE COM-GLS-COMU IN COM TO WSS-GLS-COMU IN WSS-VARI
                   MOVE COM-GLS-CIUD IN COM TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'PAI'               TO TAB-COD-TTAB IN TAB
                   MOVE COM-COD-PAIS IN COM TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-PAIS IN WSS-VARI
               ELSE
                   MOVE 'TAB'                    TO TAB-COD-SIST
                   MOVE 'PAI'                    TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS IN WSS-VARI TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-CIUD IN WSS-VARI
                   MOVE SPACES              TO WSS-GLS-PAIS IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-COMU IN WSS-VARI
               MOVE SPACES TO WSS-GLS-CIUD IN WSS-VARI
               MOVE SPACES TO WSS-GLS-PAIS IN WSS-VARI.

           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COMU IN SRT.
           MOVE WSS-GLS-COMU IN WSS-VARI TO WSS-GLS-COM2 IN SRT.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIUD IN SRT.
           MOVE WSS-GLS-CIUD IN WSS-VARI TO WSS-GLS-CIU2 IN SRT.

       FIN-BUSCA-COMU.
           EXIT.

       BUSCA-MULTI SECTION.
       INI-BUSCA-MULTI.
           IF SEL-COD-TIPO IN SRT > SPACES
               MOVE 'DEU' TO TAB-COD-SIST
               MOVE 'TLC' TO TAB-COD-TTAB IN TAB
               MOVE SEL-COD-TIPO IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-MULTI IN WSS-MNX.
       FIN-BUSCA-MULTI.
           EXIT.
       BUSCA-OFIC SECTION.
       INI-BUSCA-OFIC.
      *    DISPLAY 'PASE POR BUSCA OFIC'.
      *    DISPLAY 'DBC-COD-OFIC : ' DBC-COD-OFIC IN SRT.
      *    IF DBC-COD-OFIC IN SRT > SPACES
      *      MOVE DBC-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
           IF SEL-COD-OFIC IN SRT > SPACES
             MOVE SEL-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
             PERFORM BUS-OFI
             MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-MNX
             MOVE OFI-GLS-FON1 IN OFI TO WSS-GLS-FONO IN WSS-MNX
           ELSE
      *      DISPLAY 'ERROR: NO ENCONTRE OFICINA : ' SEL-COD-OFIC IN SRT
             MOVE SPACES TO WSS-GLS-FONO IN WSS-MNX
             MOVE SPACES TO WSS-GLS-OFIC IN WSS-MNX.
       FIN-BUSCA-OFIC.
           EXIT.

       BUSCA-EJEC SECTION.
       INI-BUSCA-EJEC.
      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF SEL-COD-EJEC IN SRT > SPACES
             MOVE 'EJC'               TO USR-COD-TTAB IN USR
             MOVE SEL-COD-EJEC IN SRT TO USR-COD-USER IN USR
             PERFORM BUS-USR
             MOVE USR-GLS-DESC        TO WSS-GLS-EJEC IN SRT
           ELSE
             MOVE SPACES TO WSS-GLS-EJEC IN SRT.
       FIN-BUSCA-EJEC.
           EXIT.

       GRABAR-NUM-PAG SECTION.
       INI-GRABAR-NUM-PAG.
           IF PGM-STAT-SRT-MAL
               GO TO FIN-GRABAR-NUM-PAG.

           MOVE WSS-CIC-ICLF IN WSS-VARI TO PAG-CIC-ICLF IN PAG.
           MOVE 1 TO WSS-DIV.
           IF WSS-NUM-OPER IN WSS-VARI NOT < 60
               DIVIDE WSS-NUM-OPER IN WSS-VARI BY 60
               GIVING WSS-DIV ROUNDED REMAINDER WSS-REST IN WSS-VARI
               IF WSS-REST > 0
                   ADD 1 TO WSS-DIV.
           MOVE WSS-DIV TO PAG-NUM-NPAG IN PAG.

      *RVM-CST-INI 4-SEP-1995
      *ANTES DE GRABAR LOS VALORES CORRESPONDIENTES A LA CLF, LOS
      *CONVIERTE DE PESOS A DOLAR.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
      *BUSCA DE DOLAR A PESOS PARA LUEGO DIVIDIR.
           MOVE WSS-COD-DOLA IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
               DISPLAY 'PAG-KEY-IREG : ' PAG-KEY-IREG IN PAG
               MOVE ZEROES TO WSS-VAL-CMAX IN WSS-VARI
           ELSE
               DIVIDE WSS-VAL-CMAX IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                       GIVING WSS-VAL-CMAX IN WSS-VARI ROUNDED.

      *CONVIERTE DE PESOS A DOLAR
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               MOVE ZEROES TO WSS-SGV-MUTI IN WSS-VARI
           ELSE
               DIVIDE WSS-SGV-MUTI IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                       GIVING WSS-SGV-MUTI IN WSS-VARI ROUNDED.

      *RVM-CST-FIN 4-SEP-1995

           MOVE WSS-VAL-CMAX IN WSS-VARI TO PAG-VAL-CMAX IN PAG.
           MOVE WSS-SGV-MUTI IN WSS-VARI TO PAG-SGV-MUTI IN PAG.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO PAG-NUM-SVEN IN PAG.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO PAG-NUM-AVEN IN PAG.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO PAG-NUM-MVEN IN PAG.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO PAG-NUM-DVEN IN PAG.
           MOVE WSS-VAL-IMPU IN WSS-VARI TO PAG-VAL-IMPU IN PAG.
           MOVE WSS-SGV-CAPI IN WSS-VARI TO PAG-SGV-CAPI IN PAG.
           MOVE WSS-SGV-REAJ IN WSS-VARI TO PAG-SGV-REAJ IN PAG.
           MOVE WSS-SGV-INTE IN WSS-VARI TO PAG-SGV-INTE IN PAG.
           SUBTRACT WSS-SGV-MUTI IN WSS-VARI FROM
             WSS-VAL-CMAX IN WSS-VARI GIVING WSS-SGV-MDIS IN WSS-VARI.
           MOVE WSS-SGV-MDIS IN WSS-VARI TO PAG-SGV-MDIS IN PAG.
           DISPLAY '********************************************'.
           DISPLAY 'INP SRT'.
           DISPLAY 'LLAVE PAG : ' PAG-CIC-ICLF IN PAG.
           DISPLAY 'IMPUESTOS : ' PAG-VAL-IMPU IN PAG.
           DISPLAY 'CAPITALES : ' PAG-SGV-CAPI IN PAG.
           DISPLAY 'REAJUSTES : ' PAG-SGV-REAJ IN PAG.
           DISPLAY 'INTERESES : ' PAG-SGV-INTE IN PAG.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-PAG.
       FIN-GRABAR-NUM-PAG.
           EXIT.

       MOVER-WSS-MNX SECTION.
       INI-MOVER-WSS-MNX.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO WSS-VAL-CMAX IN WSS-MNX.
           MOVE WSS-NUM-SVEN IN WSS-VARI TO WSS-NUM-SVEN IN WSS-MNX.
           MOVE WSS-NUM-AVEN IN WSS-VARI TO WSS-NUM-AVEN IN WSS-MNX.
           MOVE WSS-NUM-MVEN IN WSS-VARI TO WSS-NUM-MVEN IN WSS-MNX.
           MOVE WSS-NUM-DVEN IN WSS-VARI TO WSS-NUM-DVEN IN WSS-MNX.
           MOVE WSS-VAL-IMPU IN WSS-VARI TO WSS-VAL-IMPU IN WSS-MNX.
           MOVE WSS-SGV-CAPI IN WSS-VARI TO WSS-SGV-CAPI IN WSS-MNX.
           MOVE WSS-SGV-REAJ IN WSS-VARI TO WSS-SGV-REAJ IN WSS-MNX.
           MOVE WSS-SGV-INTE IN WSS-VARI TO WSS-SGV-INTE IN WSS-MNX.
           MOVE WSS-VAL-CMAX IN WSS-VARI TO WSS-VAL-CMAX IN WSS-MNX.
           MOVE WSS-SGV-MUTI IN WSS-VARI TO WSS-SGV-MUTI IN WSS-MNX.
           MOVE WSS-SGV-MDIS IN WSS-VARI TO WSS-SGV-MDIS IN WSS-MNX.
      *     MOVE WSS-NUM-NPAG IN WSS-VARI TO WSS-NUM-NPAG IN WSS-MNX.
       FIN-MOVER-WSS-MNX.
           EXIT.

       RESETEAR-SRT SECTION.
       INI-RESETEAR-SRT.
           MOVE SPACES TO WSS-GLS-DIRE IN SRT.
           MOVE SPACES TO WSS-GLS-DIR2 IN SRT.
           MOVE SPACES TO WSS-GLS-EJEC IN SRT.
           MOVE SPACES TO WSS-GLS-NOMC IN SRT.
           MOVE SPACES TO WSS-GLS-NOM2 IN SRT.
           MOVE SPACES TO WSS-GLS-COMU IN SRT.
           MOVE SPACES TO WSS-GLS-COM2 IN SRT.
           MOVE SPACES TO WSS-GLS-CIUD IN SRT.
           MOVE SPACES TO WSS-GLS-CIU2 IN SRT.
      *    MOVE SPACES TO DBC-COD-OFIC IN SRT.
      *RVM-CST-INI 22-SEP-1995
           MOVE SPACES TO SEL-COD-EJEC IN SRT.
      *RVM-CST-FIN 22-SEP-1995
           MOVE SPACES TO SEL-COD-OFIC IN SRT.
      *RVM-CST-INI 16-SEP-1996
           MOVE ZEROES TO SE1-NUM-SCOL IN SRT.
           MOVE ZEROES TO SE1-NUM-ACOL IN SRT.
      *RVM-CST-FIN 16-SEP-1996
           MOVE ZEROES TO SE1-NUM-MCOL IN SRT.
           MOVE ZEROES TO SE1-NUM-DCOL IN SRT.
           MOVE SPACES TO SE1-GLS-TIAV IN SRT.
           MOVE ZEROES TO SE1-VAL-CRED IN SRT.
           MOVE ZEROES TO SE1-VAL-SCRE IN SRT.
           MOVE SPACES TO SE1-GLS-MONE IN SRT.
           MOVE ZEROES TO SE1-VAL-SFIN IN SRT.
           MOVE ZEROES TO SE1-NUM-SVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-AVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-MVEN IN SRT.
           MOVE ZEROES TO SE1-NUM-DVEN IN SRT.
           MOVE SPACES TO SE1-IND-SCTB IN SRT.
       FIN-RESETEAR-SRT.
           EXIT.

      *RVM-CST-INI 09.09.1995
       CAL-SGV-MUTI SECTION.
       INI-CAL-SGV-MUTI.
      *CONVIERTE A MONEDA COMUN PESOS
           IF SE1-OPC-VCOC IN SE1 = WSS-COD-PESO IN WSS-VARI
               ADD SE1-VAL-SCRE IN SE1 TO WSS-SGV-MUTI IN WSS-VARI
           ELSE
               MOVE SE1-VAL-SCRE IN SE1      TO TVC-VALO IN TVC-VARI
               MOVE SE1-OPC-VCOC IN SE1      TO TVC-MON1 IN TVC-VARI
               MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
               MOVE WSS-NUM-DPRO IN WSS-VARI TO TVC-DCAM IN TVC-VARI
               MOVE WSS-NUM-MPRO IN WSS-VARI TO TVC-MCAM IN TVC-VARI
               MOVE WSS-NUM-SPRO IN WSS-VARI TO TVC-SCAM IN TVC-VARI
               MOVE WSS-NUM-APRO IN WSS-VARI TO TVC-ACAM IN TVC-VARI
               PERFORM TAB-PRO-TVC
               DISPLAY 'CAM-KEY-CAMB : ' CAM-KEY-CAMB IN CAM
               DISPLAY 'FIO-STAT     : ' FIO-STAT
               IF TVC-CMSG IN TVC-VARI > SPACES
                   DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                        TVC-MON1 IN TVC-VARI ' A : '
                        TVC-MON2 IN TVC-VARI ' AL : '
                        TVC-FCAM IN TVC-VARI
                        GO TO FIN-CAL-SGV-MUTI
               ELSE
                   ADD TVC-VALO IN TVC-VARI TO WSS-SGV-MUTI IN WSS-VARI.
       FIN-CAL-SGV-MUTI.
           EXIT.
      *RVM-CST-FIN 09.09.1995

       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Cod. Valor de Cambio Pesos con CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
      *    MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC     IN TVC-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-COD-DOLA SECTION.
       INI-OBT-COD-DOLA.
      * Obtiene Cod. Valor de Cambio UF con CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101301'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101301NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLA IN WSS-VARI.
      *    MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC   IN TVC-VARI.
       FIN-OBT-COD-DOLA.
           EXIT.

       OBT-COD-UF SECTION.
       INI-OBT-COD-UF.
      * Obtiene Cod. Valor de Cambio UF con CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.
      *    MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC   IN TVC-VARI.
       FIN-OBT-COD-UF.
           EXIT.

       COPY GNSBBMSG.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFCOM.
       COPY GNSBGCPT.
       COPY GNSBGPES.

       COPY LDCBFPAG.
       COPY LDCBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFRCD.
      *>>>>



