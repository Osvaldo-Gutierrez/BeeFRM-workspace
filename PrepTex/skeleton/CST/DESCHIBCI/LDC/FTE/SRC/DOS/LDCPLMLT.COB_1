       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      LDCPLMLT.
       AUTHOR.          BEE-TEAM.
       DATE-WRITTEN.    16-APR-99.

      * Programa Listador de Reporte MLT con Sort.
      *
      * V 1.1.2
      *


       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            C01 IS SALTO
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
      *DOS SELECT RPTMLT         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTMLT         ASSIGN TO        UT-S-RPTMLT.
           SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT RPTMLT         ASSIGN TO        UT-S-RPTMLT.

      *<<<< IOS
           SELECT RPTMLR       ASSIGN TO UT-S-RPTMLR.
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY LDCRRMLT.

       FD  RPTMLT LABEL RECORDS OMITTED
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-MLT     PIC X(132).


      *<<<< FLS
       FD  RPTMLR LABEL RECORDS OMITTED
      *VFP-INI 10-DEC-1997
      *     REPORT IS RPT-MLR.
           RECORD CONTAINS 132 CHARACTERS.
       01  GRC-LINEA-MLR PIC X(132).
      *VFP-FIN 10-DEC-1997
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY LDCBRLDC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSWGGRC.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY LDCRWMLT.

      *<<<< RW
       COPY LDCRWMLR.
      *>>>>
       COPY LDCRNMLT.

      *<<<< RN
       COPY LDCRNMLR.
      *>>>>
       COPY LDCROMLT.

      *<<<< RO
       COPY LDCROMLR.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-HRSR-MLT   VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-MLT  VALUE 'S'.

       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).

      *<<<< WSS
      *Entidades de GNS
       COPY GNSBRMSC.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGCPT.
       COPY GNSWGIDC.
      *Entidades de TAB
       COPY TABBROFI.
       COPY TABBRUSR.
      *Entidades de LDC
      *<<<< NOT PGM_DB2
       COPY LDCBRCLF.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
       COPY SGCBRDBC.
      *
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY COLBRRDC.
       COPY COLBROPC.
       COPY COLBRDLC.
      *>>>>
       COPY TABBRCAM.
      *VFP-INI 12-DEC-1997
       01 PGM-HRSR-MLR    VALUE 'N'       PIC X(01).
           88 HAY-REGISTROS-EN-SORT-MLR  VALUE 'S'.
       01  SRT-OLD-MLR  VALUE SPACES PIC X(75).
       01  SRT-CUR-MLR  VALUE SPACES PIC X(75).
      *RRM-INI 15-APR-1999
      *01  WSS-CTL-MLR.
      *    05 WSS-CTL-LIN-ESC PIC X(01) VALUE SPACES.
      *       88 SI-CTL-LIN-ESC  VALUE 'S'.
      *       88 NO-CTL-LIN-ESC  VALUE 'N'.
      *RRM-FIN 15-APR-1999
      *VFP-FIN 12-DEC-1997
       01  WSS-VARI.
      *VFP-INI  22-JAN-1998
           03  CLF-CAI-ANT       VALUE SPACES         PIC X(04).
           03  CLF-IIC-ANT       VALUE ZEROES         PIC 9(08).
           03  WSS-FST-TIME      VALUE 'S'            PIC X(01).
           03  WSS-AUX-TBAN      VALUE SPACES         PIC X(03).
           03  WSS-AUX-OFIC      VALUE SPACES         PIC X(03).
           03  WSS-AUX-REGI      VALUE SPACES         PIC X(03).
           03  WSS-AUX-EJEC      VALUE SPACES         PIC X(12).
           03  WSS-GLS-TBAN      VALUE SPACES         PIC X(40).
           03  WSS-GLS-OFIC      VALUE SPACES         PIC X(40).
           03  WSS-GLS-REGI      VALUE SPACES         PIC X(40).
           03  WSS-GLS-RMOC      VALUE SPACES         PIC X(40).
           03  WSS-I             VALUE ZEROES         PIC 9(02).
           03  WSS-Y             VALUE ZEROES         PIC 9(02).
           03  WSS-NUM-TLIN      VALUE ZEROES         PIC 9(04).
           03  WSS-NUM-TLIN-BCA  VALUE ZEROES         PIC 9(04).
           03  WSS-VAL-ATRZ      VALUE ZEROES         PIC 9(14).
           03  WSS-VAL-UTIL      VALUE ZEROES         PIC 9(14).
           03  WSS-NUM-COTA      VALUE ZEROES         PIC 9(02).
           03  WSS-AUX-COTA      VALUE ZEROES         PIC 9(02).
      *** ESTE CAMPO (WSS-NUM-LVEC) DEBE TENER EL VALOR DEL OCCURS
      *** DEFINIDO PARA LOS VECTORES WSS-ARR-BCO Y BCA RESPECTIVAMENTE.
           03  WSS-NUM-LVEC      VALUE 25             PIC 9(02).
           03  WSS-ARR-BCO.
               05  WSS-ARR-TBAN      OCCURS 25 TIMES.
                   07 WSS-COD-TBAN2                   PIC X(03).
                   07 WSS-NUM-TLIN2                   PIC 9(04).
                   07 WSS-VAL-ATRZ2                   PIC 9(14).
                   07 WSS-VAL-UTIL2                   PIC 9(14).
           03  WSS-ARR-BCA.
               05  WSS-ARR-TBCA      OCCURS 25 TIMES.
                   07 WSS-COD-TBAN3                   PIC X(03).
                   07 WSS-NUM-TLIN3                   PIC 9(04).
                   07 WSS-VAL-ATRZ3                   PIC 9(14).
                   07 WSS-VAL-UTIL3                   PIC 9(14).
           03 WSS-NEX-TBCA   VALUE SPACES    PIC X(03).
           03 WSS-NEX-TLIN   VALUE ZEROES    PIC 9(04).
           03 WSS-NEX-ATRZ   VALUE ZEROES    PIC 9(14).
           03 WSS-NEX-UTIL   VALUE ZEROES    PIC 9(14).
           03 WSS-NVG-TBCA   VALUE SPACES    PIC X(03).
           03 WSS-NVG-TLIN   VALUE ZEROES    PIC 9(04).
           03 WSS-NVG-ATRZ   VALUE ZEROES    PIC 9(14).
           03 WSS-NVG-UTIL   VALUE ZEROES    PIC 9(14).
      *VFP-FIN  22-JAN-1998
      *RVM-CST-INI 30-SEP-1996
           03  WSS-COD-TIPO          VALUE SPACES     PIC X(03).
      *RVM-CST-FIN 30-SEP-1996
      *RVM-CST-INI 10-NOV-1995
      *     03  WSS-FEC-FPRO.
      *         05  WSS-NUM-DPRO                      PIC 9(02).
      *         05  WSS-NUM-MPRO                      PIC 9(02).
      *         05  WSS-NUM-SPRO                      PIC 9(02).
      *         05  WSS-NUM-APRO                      PIC 9(02).
      *     03  WSS-FEC-FTER.
      *         05  WSS-NUM-STER                      PIC 9(02).
      *         05  WSS-NUM-ATER                      PIC 9(02).
      *         05  WSS-NUM-MTER                      PIC 9(02).
      *         05  WSS-NUM-DTER                      PIC 9(02).
      *     03  WSS-FEC-FPAS.
      *         05  WSS-NUM-SPAS                      PIC Z(02).
      *         05  WSS-NUM-APAS                      PIC Z(02).
      *         05  WSS-NUM-MPAS                      PIC Z(02).
      *         05  WSS-NUM-DPAS                      PIC Z(02).
      *RVM-CST-FIN 10-NOV-1995
      *RVM-CST-INI 5-JUL-1996
      *RVM-CST-FIN 5-JUL-1996
           03  WSS-COD-OFIC                          PIC X(03).
           03  WSS-COD-EJEC                          PIC X(12).
           03  WSS-COD-STAT                          PIC X(01).
           03  WSS-SGV-VCAM-UF                       PIC S9(11)V9(4).
           03  WSS-COD-PESO                          PIC X(06).
           03  WSS-COD-UF                            PIC X(06).
           03  WSS-CLA-OPE.
               05  WSS-TIP-OPE                       PIC X(03).
               05  WSS-STP-OPE                       PIC X(03).
           03  ARC-KEY-IARC.
               05  ARC-KEY-ILDC.
                   07  ARC-CAI-ICLF               PIC X(04).
                   07  ARC-IIC-ICLF               PIC 9(08).
                   07  ARC-NUM-ILDC               PIC 9(02).
               05  ARC-NUM-IARC                   PIC 9(01).
           03  ARG-KEY-IARG.
               05  ARG-KEY-ILDC.
                   07  ARG-CAI-ICLF               PIC X(04).
                   07  ARG-IIC-ICLF               PIC 9(08).
                   07  ARG-NUM-ILDC               PIC 9(02).
               05  ARG-NUM-IARG                   PIC 9(01).
           03  WSS-IARC       VALUE ZEROES        PIC 9(02).
           03  WSS-IARG       VALUE ZEROES        PIC 9(02).
           03  WSS-IFLD       VALUE ZEROES        PIC 9(02).
           03  WSS-MOV        VALUE ZEROES        PIC 9(02).
           03  WSS-FIN        VALUE ZEROES        PIC 9(01).

           03  WSS-TAB-ARC   OCCURS 9 TIMES.
               05  WSS-COD-TOOC                   PIC X(05).
               05  WSS-COD-AOOC                   PIC X(08).
               05  WSS-COD-VCOC                   PIC X(05).

           03  WSS-TAB-ARG   OCCURS 9 TIMES.
      *DAD ini  15-SEP-1992
               05  WSS-COD-TGAR                   PIC X(03).
      *DAD fin  15-SEP-1992
               05  WSS-COD-TOGA                   PIC X(05).
               05  WSS-COD-AOGA                   PIC X(08).
               05  WSS-NUM-PORG                   PIC 9(03).

           03 WSS-FEC-FHOY.
              05 WSS-NUM-SHOY                      PIC 9(02).
              05 WSS-NUM-AHOY                      PIC 9(02).
              05 WSS-NUM-MHOY                      PIC 9(02).
              05 WSS-NUM-DHOY                      PIC 9(02).
           03  WSS-STAT-RDC          VALUE ZEROES  PIC 9(01).
           03  WSS-IND-MCLI          VALUE SPACES  PIC X(01).
      *FLB CST  24-JAN-1994
           03  WSS-CIC-TOCF                        PIC X(03).
           03  WSS-AUX-CUTI          VALUE ZEROES  PIC 9(11).
           03  WSS-AUX-CDIS          VALUE ZEROES  PIC S9(11).
           03  WSS-VAL-PES           VALUE ZEROES  PIC 9(15).
           03  WSS-VAL-UF            VALUE ZEROES  PIC 9(12)V9(04).
           03  WSS-AUX-EJEC          VALUE SPACES  PIC X(12).
       COPY LDCWGCCU.
      *>>>>

      *<<<< WSS_DTC
      * Entidades de TAB
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      * Entidades de GNS
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      * Entidades de COL
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
      * Entidades de LDC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
      * Entidades de SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      *>>>>

      * AQUI EXISTIA LABEL RF INI

      * AQUI EXISTIA LABEL RF FIN
       COPY LDCRTMLT.

      *<<<< RT
       COPY LDCRTMLR.
      *>>>>

       PROCEDURE DIVISION.
      *==================

      * AQUI EXISTIA LABEL FIN_DEC INI

      *<<<< FIN_DEC
      *VFP-INI 12-DEC-1997
      * DEC-PH-MLR SECTION.
      *     USE BEFORE REPORTING PH-MLR.
      * INI-PH-MLR.
      * FIN-PH-MLR.
      *     EXIT.
      * DEC-FF-MLR SECTION.
      *     USE BEFORE REPORTING FF-MLR.
      * INI-FF-MLR.
      * FIN-FF-MLR.
      *     EXIT.
      *VFP-FIN 12-DEC-1997
      *>>>>
      * AQUI EXISTIA LABEL FIN_DEC FIN

       MAIN SECTION.
      *------------
       INI-MAIN.

      *    MOVE SYS-MXFL TO SYS-CMND.
      *    PERFORM GNS-PRO-SYS.
       COPY GNSBGEDB.
      *     MOVE 'LDC' TO RPT-SIST.
           MOVE 'LDCPLMLT' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.

      *<<<< INI
           MOVE 'LDC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-CLF.

           MOVE 'LDC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-ARC.

           MOVE 'LDC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-ARG.

           MOVE 'LDC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-RDC.

           MOVE 'TAB'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE 'DEU'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE 'TAB'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE 'TAB'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.

           MOVE 'SGC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE 'SGC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DCP.

           MOVE 'SGC'        TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DCE.


           MOVE 'COL'   TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RDC.

           MOVE 'COL'   TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DLC.

           MOVE 'COL'   TO FIO-SIST.
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.

      *>>>>
      *<<<< INI
           MOVE WSS-NUM-LVEC IN WSS-VARI TO WSS-NUM-COTA IN WSS-VARI.
           PERFORM LIMPIA-VECTOR-BCA.
           PERFORM LIMPIA-VECTOR-BCO.
           PERFORM CARGA-TABLA-EN-VECTOR.
           DISPLAY ' '.
           DISPLAY 'INICIO CAPTURA PARAMETROS'.
           DISPLAY ' '.
      * Captura codigo de oficina,ejecutivo,estado,fecha parametro
      *RVM-CST-INI 10-NOV-1995
      *     DISPLAY 'INGRESE FECHA VENCIMIENTO (ddmmssaa) : '.
      *     ACCEPT WSS-FEC-FPRO IN WSS-VARI.
      *     DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *RVM-CST-FIN 10-NOV-1995

           DISPLAY 'INGRESE COD. OFICINA  (XXX/*)    : '.
           ACCEPT WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.

           DISPLAY 'INGRESE COD. EJECUTIVO (X(12)/*) : '.
           ACCEPT WSS-COD-EJEC IN WSS-VARI.
           DISPLAY WSS-COD-EJEC IN WSS-VARI.

           DISPLAY 'INGRESE COD. ESTADO    (X/*)     : '.
           ACCEPT WSS-COD-STAT IN WSS-VARI.
           DISPLAY WSS-COD-STAT IN WSS-VARI.

      *RVM-CST-INI 30-SEP-1996
           DISPLAY 'TIPO DE LINEA                 : '.
           ACCEPT  WSS-COD-TIPO IN WSS-VARI.
           DISPLAY WSS-COD-TIPO IN WSS-VARI.

      *VALIDA TIPO DE LINEA
           IF WSS-COD-TIPO IN WSS-VARI NOT > SPACES
               DISPLAY 'ERROR: PARAMETRO TIPO DE LINEA OBLIGATORIO '
               PERFORM GNS-PRO-ABT.

           MOVE 'DEU'                    TO TAB-COD-SIST.
           MOVE 'TLC'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-TIPO IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               DISPLAY 'ERROR: PARAMETRO TIPO DE LINEA NO '
                       'EXISTE EN TLC   : '
               WSS-COD-TIPO IN WSS-VARI
               PERFORM GNS-PRO-ABT.
      *RVM-CST-FIN 30-SEP-1996
      *RRM-INI 16-APR-1999
           IF TAB-CIC-CTAB IN TAB      = 'MLT'
                  NEXT SENTENCE
           ELSE
                  DISPLAY 'TAB-CIC-CTAB NO ES IGUAL A "MLT" '
                  PERFORM GNS-PRO-ABT.
      *RRM-FIN 16-APR-1999

           DISPLAY 'FIN CAPTURA PARAMETROS'.
           DISPLAY ' '.
           DISPLAY 'INICIO VALIDACION PARAMETROS'.

      *RVM-CST-INI 10-NOV-1995
      *VAL-FEC Valida fecha proceso
      *     MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
      *     MOVE FEC-FORM-FEC             TO FEC-FORM.
      *     MOVE FEC-FBLK-N               TO FEC-FBLK.
      *     MOVE FEC-CHOY-N               TO FEC-CHOY.
      *     MOVE FEC-VHBL-N               TO FEC-VHBL.
      *     MOVE FEC-VAL-FEC              TO FEC-CMND.
      *     PERFORM PRO-FEC.
      *     IF NOT FEC-STAT-OKS
      *        DISPLAY ' '
      *        DISPLAY ' PROCESO CANCELADO '
      *        DISPLAY ' ERROR EN VALIDACION F. DE PROCESO : '
      *                  WSS-FEC-FPRO IN WSS-VARI '  ' FEC-MENS
      *<<<< NOT PGM_ARG
      *        PERFORM GNS-PRO-ABT.
      *>>>>
      *RVM-CST-FIN 10-NOV-1995

      *VAL-OFI Valida codigo de oficina
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
              IF MSG-GLS-MENS = 'COD    NEX'
                 DISPLAY ' '
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ERROR EN VALIDACION COD. OFICINA : '
                           WSS-COD-OFIC IN WSS-VARI
      *<<<< NOT PGM_ARG
                 PERFORM GNS-PRO-ABT.
      *>>>>

      *VAL-USR Valida codigo de ejecutivo
           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*'
              MOVE WSS-COD-EJEC IN WSS-VARI TO USR-COD-USER IN USR
              PERFORM VAL-USR
              IF MSG-GLS-MENS = 'COD    NEX'
                 DISPLAY ' '
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ERROR EN VALIDACION COD. EJECUTIVO : '
                           WSS-COD-EJEC IN WSS-VARI
      *<<<< NOT PGM_ARG
                 PERFORM GNS-PRO-ABT.
      *>>>>

      *VAL-MSC Valida codigo de estado
           IF WSS-COD-STAT IN WSS-VARI > SPACES AND
              WSS-COD-STAT IN WSS-VARI NOT = '*'
              MOVE 'DEU'  TO MSC-COD-SIST
              MOVE 'STA ' TO MSC-COD-TMSC IN MSC
              MOVE WSS-COD-STAT IN WSS-VARI TO MSC-COD-CMSC IN MSC
              PERFORM VAL-MSC
              IF MSG-GLS-MENS = 'COD    NEX'
                 DISPLAY ' '
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ERROR EN VALIDACION COD. DE ESTADO : '
                           WSS-COD-STAT IN WSS-VARI
      *<<<< NOT PGM_ARG
                 PERFORM GNS-PRO-ABT.
      *>>>>

           IF WSS-COD-STAT IN WSS-VARI = 'C' OR 'R'
                 DISPLAY ' '
                 DISPLAY ' PROCESO CANCELADO '
                 DISPLAY ' ESTADO DEBE SER ING, VER O ACT : '
      *<<<< NOT PGM_ARG
                 PERFORM GNS-PRO-ABT.
      *>>>>
      *RVM-CST-INI 10-NOV-1995
      *     MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DHAS IN WSS-MLT
      *                                      WSS-NUM-DTER IN WSS-VARI.
      *     MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MHAS IN WSS-MLT
      *                                      WSS-NUM-MTER IN WSS-VARI.
      *     MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SHAS IN WSS-MLT
      *                                      WSS-NUM-STER IN WSS-VARI.
      *     MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-AHAS IN WSS-MLT
      *                                      WSS-NUM-ATER IN WSS-VARI.
      *RVM-CST-FIN 10-NOV-1995

           DISPLAY ' '.
           DISPLAY 'FIN VALIDACION PARAMETROS'.
           DISPLAY ' '.

           MOVE SPACES TO CCU-CMMA.

      * OBTIENE COD. VALOR DE CAMBIO UF CON CIC DE LA MONEDA '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0998 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
      *<<<< NOT PGM_ARG
              PERFORM GNS-PRO-ABT.
      *>>>>
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.

      * OBTIENE COD. VALOR DE CAMBIO DE PESOS CON CIC DE LA MONEDA '0999
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0999 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
      *<<<< NOT PGM_ARG
              PERFORM GNS-PRO-ABT.
      *>>>>
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
           MOVE TAB-COD-CTAB IN TAB TO CCU-COD-PESO IN CCU-VARI.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY           TO WSS-NUM-SHOY IN WSS-VARI.
           MOVE HOY-AHOY           TO WSS-NUM-AHOY IN WSS-VARI.
           MOVE HOY-MHOY           TO WSS-NUM-MHOY IN WSS-VARI.
           MOVE HOY-DHOY           TO WSS-NUM-DHOY IN WSS-VARI.
      *RVM-CST-INI 10-NOV-1995
           MOVE HOY-DHOY           TO WSS-NUM-DHAS IN WSS-MLT.
           MOVE HOY-MHOY           TO WSS-NUM-MHAS IN WSS-MLT.
           MOVE HOY-SHOY           TO WSS-NUM-SHAS IN WSS-MLT.
           MOVE HOY-AHOY           TO WSS-NUM-AHAS IN WSS-MLT.
      *RVM-CST-FIN 10-NOV-1995
      *RVM-CST-INI  8-JUL-1996
           MOVE HOY-DHOY           TO WSS-NUM-DHAS IN WSS-MLR.
           MOVE HOY-MHOY           TO WSS-NUM-MHAS IN WSS-MLR.
           MOVE HOY-SHOY           TO WSS-NUM-SHAS IN WSS-MLR.
           MOVE HOY-AHOY           TO WSS-NUM-AHAS IN WSS-MLR.
      *RVM-CST-FIN  8-JUL-1996

           MOVE WSS-NUM-DHOY IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE WSS-NUM-MHOY IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-SHOY IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-AHOY IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
      *BUSCA VALOR DE CAMBIO DE UF A PESO
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
              DISPLAY ' PROCESO CANCELADO '
              PERFORM GNS-PRO-ABT
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-UF IN WSS-VARI.
      *>>>>
           SORT GNSSRT
       COPY LDCRSMLT.

           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.

           IF PGM-STAT-SRT-MAL OR SORT-RETURN > 0
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
       FST-INP-SRT.

           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-LDC.

       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.

      *<<<< LUP_INP
      * RRM-INI 16-APR-1999
      *    MOVE 'DEU'               TO TAB-COD-SIST.
      *    MOVE 'TLC'               TO TAB-COD-TTAB IN TAB.
      *    MOVE LDC-COD-TIPO IN LDC TO TAB-COD-CTAB IN TAB.
      *    PERFORM BUS-TAB.
      *    IF MSG-COD-MENS > SPACES
      *        DISPLAY 'CODIGO INEXISTENTE TABLA TLC '
      *                LDC-COD-TIPO IN LDC
      *        GO TO NXT-INP-SRT.
      * RRM-FIN 16-APR-1999

      *RVM-CST-INI 30-SEP-1996
      *     IF TAB-CIC-CTAB IN TAB NOT = 'MLT' OR
      *         LDC-IND-VIGE IN LDC NOT = 'S'
      *         GO TO NXT-INP-SRT.

           IF WSS-COD-TIPO IN WSS-VARI = LDC-COD-TIPO IN LDC AND
      * RRM-INI 16-APR-1999
      *       TAB-CIC-CTAB IN TAB      = 'MLT' AND
      * RRM-FIN 16-APR-1999
              LDC-IND-VIGE IN LDC      = 'S'
                  NEXT SENTENCE
              ELSE
                  GO TO NXT-INP-SRT.
      *RVM-CST-FIN 30-SEP-1996

           MOVE LDC-CIC-ICLF IN LDC TO CLF-KEY-ICLF IN CLF.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY CLF-KEY-ICLF IN CLF ' ' MSG-GLS-DESC
               GO TO NXT-INP-SRT.
           IF CLF-MSC-STAT IN CLF NOT = 'A'
               GO TO NXT-INP-SRT.

           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*' AND
              WSS-COD-OFIC IN WSS-VARI NOT = CLF-COD-OFIC IN CLF
               GO TO NXT-INP-SRT.

           IF WSS-COD-STAT IN WSS-VARI > SPACES AND
              WSS-COD-STAT IN WSS-VARI NOT = '*' AND
              WSS-COD-STAT IN WSS-VARI NOT = CLF-MSC-STAT IN CLF
               GO TO NXT-INP-SRT.

      *VFP-INI 22-ENE-1998
      * Obtengo Datos desde RDC para datos clientes y luego leer la Banc
           MOVE CLF-CAI-ICLF IN CLF TO RDC-CAI-ICLF IN RDL.
           MOVE CLF-IIC-ICLF IN CLF TO RDC-IIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF'      TO FIO-AKEY.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    CLF-CAI-ICLF IN CLF = RDC-CAI-ICLF IN RDL AND
                    CLF-IIC-ICLF IN CLF = RDC-IIC-ICLF IN RDL )
               DISPLAY 'ERROR: NO EXISTE RDC ASOCIADA A CLF : '
                        CLF-CIC-ICLF IN CLF
               GO TO NXT-INP-SRT.

      * Lee con CIC CLIENTE archivo DBC
           MOVE RDC-CIC-ICLI IN RDL TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE DBC ASOCIADA A RDC : '
                      RDC-CIC-ICLI IN RDL
               GO TO NXT-INP-SRT.

      *VFP-INI 22-ENE-1998
      *     IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
      *        WSS-COD-EJEC IN WSS-VARI NOT = '*' AND
      *        WSS-COD-EJEC IN WSS-VARI NOT = CLF-COD-EJEC IN CLF
           IF WSS-COD-EJEC IN WSS-VARI > SPACES AND
              WSS-COD-EJEC IN WSS-VARI NOT = '*' AND
              WSS-COD-EJEC IN WSS-VARI NOT = DBC-COD-EJEC IN DBC
      *VFP-FIN 22-ENE-1998
               GO TO NXT-INP-SRT.

           IF DBC-IND-TICL IN DBC = 'P'
               MOVE RDC-CIC-ICLI IN RDL TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   DISPLAY 'ERROR: CLIENTE NO TIENE BANCA ASOCIADA, '
                           'IDC DEL CLIENTE : ' DBC-IDC-ICLI IN DBC
                   GO TO NXT-INP-SRT
               ELSE
                   IF DCP-COD-TBAN IN DCP > SPACES
                       MOVE DCP-COD-TBAN IN DCP TO SRT-COD-TBAN IN SRT
                   ELSE
                       DISPLAY 'ERROR: CLIENTE NO TIENE BANCA '
                               'ASOCIADA, IDC : ' DBC-IDC-ICLI IN DBC
                       GO TO NXT-INP-SRT
           ELSE
              IF DBC-IND-TICL IN DBC = 'E'
                  MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM SGC-FIO-DCE
                  IF NOT FIO-STAT-OKS
                     DISPLAY 'ERROR: CLIENTE NO TIENE BANCA ASOCIADA, '
                             'IDC DEL CLIENTE : ' DBC-IDC-ICLI IN DBC
                      GO TO NXT-INP-SRT
                  ELSE
                      IF DCE-COD-TBAN IN DCE > SPACES
                          MOVE DCE-COD-TBAN IN DCE TO SRT-COD-TBAN
                                                                IN SRT
                      ELSE
                          DISPLAY 'ERROR: CLIENTE NO TIENE BANCA '
                                 'ASOCIADA, IDC : ' DBC-IDC-ICLI IN DBC
                          GO TO NXT-INP-SRT.
           PERFORM BUSCA-COD-REGIONAL.
      *VFP-FIN 22-ENE-1998
      *>>>>
       MOV-INP-SRT.
       COPY LDCRMMLT.

           RELEASE SRT.
       NXT-INP-SRT.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-LDC.

           GO TO LUP-INP-SRT.
       FIN-INP-SRT.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-LDC.

       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.

      *<<<< INI_OUT
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-CLF.

           OPEN OUTPUT RPTMLR.
      *VFP-INI 10-DEC-1997
      *     INITIATE RPT-MLR.
           PERFORM INITIATE-RPTMLR.
      *VFP-FIN 10-DEC-1997
      *>>>>
           OPEN OUTPUT RPTMLT.
      *     MOVE 'LDCPLMLT' TO RPT-NPGM.
           PERFORM CAL-HDR.
           PERFORM INITIATE-RPTMLT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           MOVE SRT TO SRT-OLD-MLT.
           MOVE SRT TO SRT-CUR-MLT.

      *<<<< FST_OUT
      *VFP-INI 10-DEC-1997
           PERFORM MLT-FST-PRO-CTL.
           PERFORM MLR-FST-PRO-CTL.
      *VFP-FIN 10-DEC-1997
           MOVE CLF-COD-OFIC IN SRT TO WSS-COD-OFIC IN WSS-MLR.
           MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-MLR.
           MOVE ZEROES TO WSS-VAL-UTIL IN WSS-MLR.
           MOVE ZEROES TO WSS-NUM-TLIN IN WSS-MLR.
           MOVE ZEROES TO WSS-NUM-TLIN-BCA IN WSS-VARI.
      *>>>>
      *    PERFORM MLT-FST-PRO-CTL.
       LUP-OUT-SRT.

      *<<<< LUP_OUT
      *RRM-INI 19-APR-1999
           IF SRT-COD-TBAN IN SRT NOT = SRT-COD-TBAN-OLD
              PERFORM SUMA-VECTOR-BCA
              MOVE ZEROES TO WSS-NUM-TLIN     IN WSS-VARI
                             WSS-NUM-TLIN-BCA IN WSS-VARI
                             WSS-VAL-ATRZ     IN WSS-VARI
                             WSS-VAL-UTIL     IN WSS-VARI.
      *RRM-FIN 19-APR-1999
           IF LDC-COD-VCLC IN SRT = WSS-COD-PESO IN WSS-VARI
               MOVE 1 TO WSS-NUM-LINPES IN WSS-MLT
               MOVE LDC-VAL-CMAX IN SRT TO WSS-VAL-TPE IN WSS-MLT
               MOVE ZEROES TO WSS-NUM-LINUF IN WSS-MLT
               MOVE ZEROES TO WSS-VAL-TUF   IN WSS-MLT
           ELSE
               IF LDC-COD-VCLC IN SRT = WSS-COD-UF IN WSS-VARI
                   MOVE 1 TO WSS-NUM-LINUF  IN WSS-MLT
                   MOVE LDC-VAL-CMAX IN SRT TO WSS-VAL-TUF IN WSS-MLT
                   MOVE ZEROES TO WSS-NUM-LINPES IN WSS-MLT
                   MOVE ZEROES TO WSS-VAL-TPE    IN WSS-MLT
               ELSE
                   MOVE ZEROES TO WSS-NUM-LINUF  IN WSS-MLT
                   MOVE ZEROES TO WSS-VAL-TUF    IN WSS-MLT
                   MOVE ZEROES TO WSS-NUM-LINPES IN WSS-MLT
                   MOVE ZEROES TO WSS-VAL-TPE    IN WSS-MLT
                   DISPLAY 'COD-MONEDA NO SUMABLE A TOTALES '
                            LDC-COD-VCLC IN SRT.

      * Obtiene Datos desde RDC para datos clientes
           PERFORM GET-CUR-RDC.
           IF WSS-STAT-RDC IN WSS-VARI = 1
              PERFORM RST-DBC
           ELSE
              PERFORM GET-RDC-DBC
              PERFORM GET-NXT-RDC.

      *BUS-TAB busca glosa de codigo en tabla
           MOVE SPACES TO WSS-GLS-VCLC IN WSS-MLT.
           IF LDC-COD-VCLC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE LDC-COD-VCLC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VCLC IN WSS-MLT.

      *BUS-TAB busca CIC de codigo en tabla
           IF CLF-COD-TOCF IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
      *FLB CST  24-JAN-1994
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF
           ELSE
               MOVE 'CGE' TO WSS-CIC-TOCF
               DISPLAY 'CLF SIN TIPO OPERACION '
                                         CLF-CAI-ICLF IN SRT ' '
                                         CLF-IIC-ICLF IN SRT.
      *FLB CST  24-JAN-1994

           IF WSS-CIC-TOCF = 'CGE'
               MOVE ZEROES TO WSS-VAL-CDLC   IN WSS-MLT
               MOVE ZEROES TO WSS-NUM-LINUF  IN WSS-MLT
               MOVE ZEROES TO WSS-VAL-TUF    IN WSS-MLT
               MOVE ZEROES TO WSS-NUM-LINPES IN WSS-MLT
               MOVE ZEROES TO WSS-VAL-TPE    IN WSS-MLT
               GO TO FIN-CCU.

           MOVE CLF-CAI-ICLF IN SRT TO CCU-CAI-ICLF.
           MOVE CLF-IIC-ICLF IN SRT TO CCU-IIC-ICLF.
           MOVE SPACES TO CCU-CAI-IOPC(1).
           MOVE ZEROES TO CCU-IIC-IOPC(1).
           MOVE SPACES TO CCU-CAI-DCAN(1).
           MOVE ZEROES TO CCU-IIC-DCAN(1).
           MOVE ZEROES TO CCU-NUM-DCAN(1).
           MOVE SPACES TO CCU-OPE-INDS.
           MOVE SPACES TO CCU-CAI-ICLI.
           MOVE ZEROES TO CCU-IIC-ICLI.
           MOVE ZEROES TO CCU-VAL-CUTI.
           CALL 'LDCSBCCU' USING CCU-CMMA .
           IF CCU-NUM-MENS < CCU-NUM-CALC AND
              CCU-NUM-MENS > ZEROES
               MOVE ZEROES TO WSS-VAL-CDLC IN WSS-MLT
               MOVE CCU-COD-SIST IN CCU-VARI TO MSG-COD-SIST
               MOVE CCU-COD-MENS IN CCU-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               IF CCU-CAMB > SPACES
                   MOVE CCU-CAMB TO CCU-MEN2
                   MOVE MSG-GLS-DESC TO CCU-MEN1
                   DISPLAY 'CALIFICACION ' CCU-CAI-ICLF CCU-IIC-ICLF
                   DISPLAY 'ERROR CALCULO CUPOS ' CCU-MENS
                   DISPLAY ' '
               ELSE
                   MOVE MSG-GLS-DESC TO CCU-MENS
                   DISPLAY 'CALIFICACION ' CCU-CAI-ICLF CCU-IIC-ICLF
                   DISPLAY 'ERROR CALCULO CUPOS ' CCU-MENS
                   DISPLAY ' '
           ELSE
      *CUPO UTILIZADO POR LA LINEA
               IF CLF-COD-VCCF IN SRT = LDC-COD-VCLC IN SRT
      *REDONDEA
                   MULTIPLY CDIS-LCR IN CCU-VARI(LDC-NUM-ILDC IN SRT)
                        BY 1 GIVING WSS-AUX-CDIS IN WSS-VARI ROUNDED
                   MOVE WSS-AUX-CDIS IN WSS-VARI TO
                        WSS-VAL-CDLC IN WSS-MLT
               ELSE
                   IF CLF-COD-VCCF IN SRT = WSS-COD-PESO IN WSS-VARI AND
                       LDC-COD-VCLC IN SRT = WSS-COD-UF IN WSS-VARI
      *CONVIERTE DE PESOS A UF
                       COMPUTE WSS-VAL-CDLC IN WSS-MLT =
                         CDIS-LCR IN CCU-VARI(LDC-NUM-ILDC IN SRT) /
                         WSS-SGV-VCAM-UF IN WSS-VARI
                   ELSE
      *CONVIERTE DE UF A PESOS
                       COMPUTE WSS-VAL-CDLC IN WSS-MLT =
                         CDIS-LCR IN CCU-VARI(LDC-NUM-ILDC IN SRT) *
                         WSS-SGV-VCAM-UF IN WSS-VARI.
      *VFP-INI  10-FEB-1998
      ******** REEMPLAZA LO QUE CON ASTERISCOS VFP-10-FEB-98, MAS *****
      ******** ABAJO(IF CLF-COD-OFIC IN SRT = WSS-COD-OFIC-ANT ...)****
      **********
           ADD 1 TO WSS-NUM-TLIN IN WSS-VARI.
           ADD 1 TO WSS-NUM-TLIN-BCA IN WSS-VARI.
           PERFORM SUMA-CMAX-Y-CUTIL.
           MOVE CLF-CAI-ICLF IN SRT TO CLF-CAI-ANT IN WSS-VARI.
           MOVE CLF-IIC-ICLF IN SRT TO CLF-IIC-ANT IN WSS-VARI.
      **********
      *VFP-FIN  10-FEB-1998

       FIN-CCU.
      *>>>>
       GEN-OUT-SRT.
           PERFORM GENERATE-DL-MLT.

       NXT-OUT-SRT.
           MOVE SRT TO SRT-OLD-MLT.
       RET-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.

           IF HAY-REGISTROS-EN-SORT-MLT
                PERFORM TERMINATE-RPTMLT.

      *<<<< FIN_TMT
           MOVE WSS-COD-OFIC IN WSS-MLR TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-MLR.
      *VFP-INI 10-FEB-1998
           PERFORM PRT-VECTOR-BCO.
      *VFP-FIN 10-FEB-1998
      *VFP-INI 10-DEC-1997
      *     TERMINATE RPT-MLR.
           PERFORM TERMINATE-RPTMLR.
      *VFP-FIN 10-DEC-1997
           CLOSE RPTMLR.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-CLF.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DCP.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DCE.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-RDC.

           MOVE 'TAB' TO FIO-SIST.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-CLO TO FIO-CMND.
           PERFORM TAB-FIO-USR.

      *>>>>
           CLOSE RPTMLT.
       EXT-OUT-SRT.
           EXIT.
       COPY LDCBFLDC.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGIRH.
       COPY LDCREMLT.
      *    14-MAY-98 03:00 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-CF-MLT-DBC-COD-EJEC SECTION.
       INI-CF-MLT-DBC-COD-EJEC.

       FIN-CF-MLT-DBC-COD-EJEC.
           EXIT.
       D-CF-MLT-SRT-COD-REGI SECTION.
       INI-CF-MLT-SRT-COD-REGI.

      *<<<< CF_MLT_SRT_COD_REGI
      *VFP-INI  6-FEB-1998
           PERFORM OBT-GLOSA-REGIONAL.
           MOVE WSS-GLS-REGI IN WSS-VARI TO WSS-GLS-REG2 IN WSS-MLT.
           MOVE WSS-GLS-REGI IN WSS-VARI TO WSS-GLS-REG2 IN WSS-MLR.
           MOVE 'N' TO WSS-MLR-SEM-NP IN WSS-SEM-MLR.
           PERFORM PRO-DL-TREG.
      *RRM-INI 15-APR-1999
           PERFORM PRO-DL-BLCO.
      *RRM-FIN 15-APR-1999
      *VFP-FIN  6-FEB-1998
      *>>>>
       FIN-CF-MLT-SRT-COD-REGI.
           EXIT.
       D-CF-MLT-CLF-COD-OFIC SECTION.
       INI-CF-MLT-CLF-COD-OFIC.

      *<<<< CF_CLF_CLF_COD_OFIC
      *VFP-INI 10-DEC-1997
      *     MOVE ZEROES TO PAGE-COUNTER IN RPT-MLT.
           MOVE ZEROES TO RPT-MLR-PAGE-COUNTER IN RPT-VARI-MLR.
      *VFP-FIN 10-DEC-1997
      *VFP-INI  6-FEB-1998
           IF WSS-FST-TIME IN WSS-VARI =  'N'
                 MOVE 'S' TO WSS-MLR-SEM-NP IN WSS-SEM-MLR.
           MOVE 'N' TO WSS-FST-TIME IN WSS-VARI.
      *RRM-INI 19-ABR-1999
           PERFORM SUMA-VECTOR-BCA.
      *RRM-FIN 19-ABR-1999
           PERFORM PRT-VECTOR-BCA.
           PERFORM SUMA-VECTOR-BCO.
           PERFORM LIMPIA-VECTOR-BCA.
           MOVE CLF-COD-OFIC IN SRT TO WSS-COD-OFIC IN WSS-MLR.
           PERFORM OBT-GLOSA-OFICINA.
           MOVE WSS-GLS-OFIC IN WSS-VARI TO WSS-GLS-OFI2 IN WSS-MLT.
           MOVE WSS-GLS-OFIC IN WSS-VARI TO WSS-GLS-OFI2 IN WSS-MLR.
           PERFORM PRO-DL-TOFI.
      *RRM-INI 15-APR-1999
      *    PERFORM PRO-DL-BLCO.
      *RRM-FIN 15-APR-1999
           MOVE 'S' TO WSS-MLR-SEM-NP IN WSS-SEM-MLR.
      *VFP-FIN  6-FEB-1998
      *VFP-INI  10-FEB-1998
           MOVE 1 TO WSS-NUM-TLIN-BCA IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-UTIL IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-TLIN IN WSS-VARI.
      *VFP-FIN  10-FEB-1998
      *>>>>
       FIN-CF-MLT-CLF-COD-OFIC.
           EXIT.
       D-CF-MLT-SRT-COD-TBAN SECTION.
       INI-CF-MLT-SRT-COD-TBAN.

      *<<<< CF_MLT_SRT_COD_TBAN
      *VFP-INI 10-FEB-1998
           PERFORM OBT-GLOSA-BANCA.
           MOVE WSS-GLS-TBAN IN WSS-VARI TO WSS-GLS-TBA2 IN WSS-MLT.
      *RRM-INI 19-APR-1999
      *    PERFORM SUMA-VECTOR-BCA.
      *RRM-FIN 19-APR-1999
      *VFP-FIN 10-FEB-1998
      *>>>>
       FIN-CF-MLT-SRT-COD-TBAN.
           EXIT.
       D-CH-MLT-SRT-COD-TBAN SECTION.
       INI-CH-MLT-SRT-COD-TBAN.

      *<<<< CH_MLT_SRT_COD_TBAN
           PERFORM OBT-GLOSA-BANCA.
           MOVE WSS-GLS-TBAN IN WSS-VARI TO WSS-GLS-TBAN IN WSS-MLT.
      * RRM-INI 14-MAY-1998
           MOVE SRT-COD-TBAN IN SRT TO WSS-COD-TBAN IN WSS-MLT.
      * RRM-FIN 14-MAY-1998
      *>>>>
       FIN-CH-MLT-SRT-COD-TBAN.
           EXIT.
       D-PH-MLT SECTION.
       INI-PH-MLT.

      *<<<< PH_MLT
      *VFP-INI  22-JAN-1998
      * Busca Glosa de la Oficina.
           PERFORM OBT-GLOSA-OFICINA.
           MOVE WSS-GLS-OFIC IN WSS-VARI TO WSS-GLS-OFIC IN WSS-MLT.
      * Busca Nombre Regional en Tabla REG.
           PERFORM OBT-GLOSA-REGIONAL.
           MOVE WSS-GLS-REGI IN WSS-VARI TO WSS-GLS-REGI IN WSS-MLT.
      * Busca Nombre Ejecutivo.
           PERFORM OBT-NOMBRE-EJECUTIVO.
           MOVE WSS-GLS-RMOC IN WSS-VARI TO WSS-GLS-EJEC IN WSS-MLT.
      * RRM-INI 14-MAY-1998
           MOVE WSS-GLS-RMOC IN WSS-VARI TO WSS-GLS-EJE IN WSS-MLT.
      * RRM-FIN 14-MAY-1998
      *     MOVE SPACES TO WSS-GLS-OFIC IN WSS-MLT.
      *     IF CLF-COD-OFIC IN SRT > SPACES
      *         MOVE CLF-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
      *         PERFORM BUS-OFI
      *         MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-MLT.
      *     MOVE SPACES TO WSS-GLS-EJEC IN WSS-MLT.
      *     IF CLF-COD-EJEC IN SRT > SPACES
      *         MOVE CLF-COD-EJEC IN SRT TO USR-COD-USER IN USR
      *         PERFORM BUS-USR
      *         MOVE USR-GLS-DESC IN USR TO WSS-GLS-EJEC IN WSS-MLT.
      *VFP-FIN  22-JAN-1998
      *>>>>
       FIN-PH-MLT.
           EXIT.
       D-DL-MLT SECTION.
       INI-DL-MLT.

       FIN-DL-MLT.
           EXIT.
       COPY GNSBGABT.


      *<<<< EOF
      *VFP-INI 10-DEC-1997
       COPY LDCREMLR.
      *INCLUYE DECMLRATIVAS PARA MLR.RPT
      *    23-JAN-98 12:12 PM     ,PAI= ,CLI= ,SOP=MVS  V 1.1.3
       D-PH-MLR SECTION.
       INI-PH-MLR.
      *<<<< PH_MLR
           PERFORM OBT-GLOSA-OFICINA.
           MOVE WSS-GLS-OFIC IN WSS-VARI TO WSS-GLS-OFIC IN WSS-MLR.
      * RRM-INI 16-APR-1999
           MOVE CLF-COD-OFIC IN SRT      TO WSS-COD-OFIC IN WSS-MLR.
      * RRM-FIN 16-APR-1999
           PERFORM OBT-GLOSA-REGIONAL.
           MOVE WSS-GLS-REGI IN WSS-VARI TO WSS-GLS-REGI IN WSS-MLR.
      * RRM-INI 16-APR-1999
           MOVE SRT-COD-REGI IN SRT      TO WSS-COD-REGI IN WSS-MLR.
      * RRM-FIN 16-APR-1999
      *>>>>
       FIN-PH-MLR.
           EXIT.
       D-DL-TBAN SECTION.
       INI-DL-TBAN.
       FIN-DL-TBAN.
           EXIT.
       D-DL-MLR SECTION.
       INI-DL-MLR.
       FIN-DL-MLR.
           EXIT.
       D-DL-TOFI SECTION.
       INI-DL-TOFI.
       FIN-DL-TOFI.
           EXIT.
       D-DL-TREG SECTION.
       INI-DL-TREG.
       FIN-DL-TREG.
           EXIT.
       D-DL-TBCO SECTION.
       INI-DL-TBCO.
       FIN-DL-TBCO.
           EXIT.
       D-DL-DBCO SECTION.
       INI-DL-DBCO.
       FIN-DL-DBCO.
           EXIT.
       D-DL-TGBC SECTION.
       INI-DL-TGBC.
       FIN-DL-TGBC.
           EXIT.
       D-DL-BLCO SECTION.
       INI-DL-BLCO.
       FIN-DL-BLCO.
           EXIT.

       CARGA-TABLA-EN-VECTOR SECTION.
      *******************************
       INI-CARGA-TABLA-EN-VECTOR.
           MOVE ZEROES TO WSS-NUM-COTA IN WSS-VARI.
           MOVE 'SGC'               TO FIO-SIST.
           MOVE 'BAN'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-COD-TTAB IN TAB NOT = 'BAN'
               DISPLAY 'NO SE PUDO CARGAR LA TABLA BAN.'
               DISPLAY 'FIN DEL PROGRAMA.'
               PERFORM GNS-PRO-ABT.
       NXT-REG-TAB.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
      * VERIFICA QUE PERTENEZCA A LA TABLA BAN
           IF NOT FIO-STAT-OKS OR TAB-COD-TTAB IN TAB NOT = 'BAN'
               GO TO FIN-CARGA-TABLA-EN-VECTOR.
      * VERIFICA QUE ESTE VIGENTE
           IF TAB-IND-VIGE IN TAB = 'N'
               GO TO NXT-REG-TAB.
           ADD 1 TO WSS-NUM-COTA IN WSS-VARI.
           IF WSS-NUM-COTA IN WSS-VARI > WSS-NUM-LVEC IN WSS-VARI
               DISPLAY 'OVERFLOW EN VECTOR DE TOTALES, '
                       'DEMASIADOS TIPOS DE BANCAS.'
               DISPLAY 'FIN DEL PROGRAMA.'
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO
                           WSS-COD-TBAN2 IN WSS-ARR-BCO(WSS-NUM-COTA).
           MOVE TAB-COD-CTAB IN TAB TO
                           WSS-COD-TBAN3 IN WSS-ARR-BCA(WSS-NUM-COTA).
           GO TO NXT-REG-TAB.
       FIN-CARGA-TABLA-EN-VECTOR.
           EXIT.

      ***************************************************************
      ** SECTION RELACIONADAS CON EL PROCESO DE LA MATRIZ DE TOTAL **
      ** BANCO, POR TIPO DE BANCA                                  **
      ***************************************************************

       LIMPIA-VECTOR-BCO SECTION.
      ***************************
       INI-LIMPIA-VECTOR-BCO.
           MOVE 1 TO WSS-I IN WSS-VARI.
       LUP-LIMPIA-VECTOR-BCO.
           IF WSS-I IN WSS-VARI NOT > WSS-NUM-COTA IN WSS-VARI
      *         MOVE SPACES TO WSS-COD-TBAN2 IN WSS-ARR-BCO(WSS-I)
               MOVE ZEROES TO WSS-NUM-TLIN2 IN WSS-ARR-BCO(WSS-I)
               MOVE ZEROES TO WSS-VAL-ATRZ2 IN WSS-ARR-BCO(WSS-I)
               MOVE ZEROES TO WSS-VAL-UTIL2 IN WSS-ARR-BCO(WSS-I)
               ADD 1 TO WSS-I IN WSS-VARI
               GO TO LUP-LIMPIA-VECTOR-BCO.
           MOVE ZEROES TO WSS-NUM-TLIN2 IN WSS-ARR-BCO(WSS-I).
           MOVE ZEROES TO WSS-VAL-ATRZ2 IN WSS-ARR-BCO(WSS-I).
           MOVE ZEROES TO WSS-VAL-UTIL2 IN WSS-ARR-BCO(WSS-I).
       FIN-LIMPIA-VECTOR-BCO.
           EXIT.

       PRT-VECTOR-BCO SECTION.
      ************************
       INI-PRT-VECTOR-BCO.
           PERFORM PRO-DL-TBCO.
           MOVE 1 TO WSS-I IN WSS-VARI.
       LUP-PRT-VECTOR-BCO.
           IF WSS-I IN WSS-VARI > WSS-NUM-COTA IN WSS-VARI
               GO TO FIN-PRT-VECTOR-BCO.
           IF (WSS-NUM-TLIN2 IN WSS-ARR-BCO(WSS-I) = ZEROES AND
               WSS-VAL-ATRZ2 IN WSS-ARR-BCO(WSS-I) = ZEROES AND
               WSS-VAL-UTIL2 IN WSS-ARR-BCO(WSS-I) = ZEROES)
                  ADD 1 TO WSS-I IN WSS-VARI
                  GO TO LUP-PRT-VECTOR-BCO.
           MOVE WSS-COD-TBAN2 IN WSS-ARR-BCO(WSS-I) TO
                                      WSS-COD-TBA2 IN WSS-MLR.
      * Busca Glosa de la Banca.
           MOVE SRT-COD-TBAN IN SRT TO WSS-AUX-TBAN IN WSS-VARI.
           MOVE WSS-COD-TBAN2 IN WSS-ARR-BCO(WSS-I) TO
                                       SRT-COD-TBAN IN SRT.
           PERFORM OBT-GLOSA-BANCA.
           MOVE WSS-AUX-TBAN IN WSS-VARI TO SRT-COD-TBAN IN SRT.
           MOVE WSS-GLS-TBAN IN WSS-VARI TO WSS-GLS-TBA2 IN WSS-MLR.
           MOVE WSS-NUM-TLIN2 IN WSS-ARR-BCO(WSS-I) TO
                                      WSS-NUM-TLIN-TBCO IN WSS-MLR.
           MOVE WSS-VAL-ATRZ2 IN WSS-ARR-BCO(WSS-I) TO
                                      WSS-VAL-ATRZ-TBCO IN WSS-MLR.
           MOVE WSS-VAL-UTIL2 IN WSS-ARR-BCO(WSS-I) TO
                                      WSS-VAL-UTIL-TBCO IN WSS-MLR.
           ADD 1 TO WSS-I IN WSS-VARI.
           PERFORM PRO-DL-DBCO.
           GO TO LUP-PRT-VECTOR-BCO.
       FIN-PRT-VECTOR-BCO.
      * IMPRFIME EL RESUMEN GENERAL DEL BANCO (FINAL FOOTING)
           PERFORM PRO-DL-TGBC.
       EXT-PRT-VECTOR-BCO.
           EXIT.

       SUMA-VECTOR-BCO SECTION.
      *************************
       INI-SUMA-VECTOR-BCO.
           MOVE 1 TO WSS-I IN WSS-VARI.
       LUP-SUMA-VECTOR-BCO.
           IF WSS-I IN WSS-VARI NOT > WSS-NUM-COTA IN WSS-VARI
               ADD WSS-NUM-TLIN3 IN WSS-ARR-BCA(WSS-I) TO
                   WSS-NUM-TLIN2 IN WSS-ARR-BCO(WSS-I)
               ADD WSS-VAL-ATRZ3 IN WSS-ARR-BCA(WSS-I) TO
                   WSS-VAL-ATRZ2 IN WSS-ARR-BCO(WSS-I)
               ADD WSS-VAL-UTIL3 IN WSS-ARR-BCA(WSS-I) TO
                   WSS-VAL-UTIL2 IN WSS-ARR-BCO(WSS-I)
               ADD 1 TO WSS-I IN WSS-VARI
               GO TO LUP-SUMA-VECTOR-BCO.
       FIN-SUMA-VECTOR-BCO.
           EXIT.

      ***************************************************************
      ** SECTION RELACIONADAS CON EL PROCESO DE LA MATRIZ DE TOTAL **
      ** TIPO DE BANCA                                             **
      ***************************************************************

       LIMPIA-VECTOR-BCA SECTION.
      ***************************
       INI-LIMPIA-VECTOR-BCA.
           MOVE 1 TO WSS-Y IN WSS-VARI.
       LUP-LIMPIA-VECTOR-BCA.
           IF WSS-Y IN WSS-VARI NOT > WSS-NUM-COTA IN WSS-VARI
      *        MOVE SPACES TO WSS-COD-TBAN3 IN WSS-ARR-BCA(WSS-Y)
              MOVE ZEROES TO WSS-NUM-TLIN3 IN WSS-ARR-BCA(WSS-Y)
              MOVE ZEROES TO WSS-VAL-ATRZ3 IN WSS-ARR-BCA(WSS-Y)
              MOVE ZEROES TO WSS-VAL-UTIL3 IN WSS-ARR-BCA(WSS-Y)
              ADD 1 TO WSS-Y IN WSS-VARI
              GO TO LUP-LIMPIA-VECTOR-BCA.
           MOVE ZEROES TO WSS-NUM-TLIN3 IN WSS-ARR-BCA(WSS-Y).
           MOVE ZEROES TO WSS-VAL-ATRZ3 IN WSS-ARR-BCA(WSS-Y).
           MOVE ZEROES TO WSS-VAL-UTIL3 IN WSS-ARR-BCA(WSS-Y).
       FIN-LIMPIA-VECTOR-BCA.
           EXIT.

       PRT-VECTOR-BCA SECTION.
      ************************
       INI-PRT-VECTOR-BCA.
           MOVE 1 TO WSS-Y IN WSS-VARI.
       LUP-PRT-VECTOR-BCA.
           IF WSS-Y IN WSS-VARI > WSS-NUM-COTA IN WSS-VARI
               GO TO FIN-PRT-VECTOR-BCA.
           IF (WSS-NUM-TLIN3 IN WSS-ARR-BCA(WSS-Y) = ZEROES AND
               WSS-VAL-ATRZ3 IN WSS-ARR-BCA(WSS-Y) = ZEROES AND
               WSS-VAL-UTIL3 IN WSS-ARR-BCA(WSS-Y) = ZEROES)
                  ADD 1 TO WSS-Y IN WSS-VARI
                  GO TO LUP-PRT-VECTOR-BCA.
           MOVE WSS-COD-TBAN3 IN WSS-ARR-BCA(WSS-Y) TO
                                      WSS-COD-TBAN IN WSS-MLR.
      * Busca Glosa de la Banca.
           MOVE SRT-COD-TBAN IN SRT TO WSS-AUX-TBAN IN WSS-VARI.
           MOVE WSS-COD-TBAN3 IN WSS-ARR-BCA(WSS-Y) TO
                                       SRT-COD-TBAN IN SRT.
           PERFORM OBT-GLOSA-BANCA.
           MOVE WSS-AUX-TBAN IN WSS-VARI TO SRT-COD-TBAN IN SRT.
           MOVE WSS-GLS-TBAN IN WSS-VARI TO WSS-GLS-TBAN IN WSS-MLR.
      * Mueve Del vector a las variables del reporte
           MOVE WSS-NUM-TLIN3 IN WSS-ARR-BCA(WSS-Y) TO
                                      WSS-NUM-TLIN IN WSS-MLR.
           MOVE WSS-VAL-ATRZ3 IN WSS-ARR-BCA(WSS-Y) TO
                                      WSS-VAL-ATRZ IN WSS-MLR.
           MOVE WSS-VAL-UTIL3 IN WSS-ARR-BCA(WSS-Y) TO
                                      WSS-VAL-UTIL IN WSS-MLR.
           ADD 1 TO WSS-Y IN WSS-VARI.
      * Imprime la linea correspondiente
           PERFORM PRO-DL-TBAN.
           PERFORM PRO-DL-MLR.
           GO TO LUP-PRT-VECTOR-BCA.
       FIN-PRT-VECTOR-BCA.
           EXIT.

       SUMA-VECTOR-BCA SECTION.
      *************************
       INI-SUMA-VECTOR-BCA.
           MOVE 1 TO WSS-Y IN WSS-VARI.
       NXT-POS-VECTOR-BCA.
      * RRM-INI 19-APR-1999
           GO TO COMPARA.
      *RRM-FIN 19-APR-1999
      * ESTO ES PARA EL CASO QUE PERTENEZCA A NINGUNA DE LAS T. BCAS.
      * MARCADAS COMO VIGENTES.
      * VERIFICA QUE TENGA T.BCA. ASOCIADO Y/O ESTE VIGENTE
           MOVE 'SGC'               TO TAB-COD-SIST.
           MOVE 'BAN'               TO TAB-COD-CTAB IN TAB.
           MOVE SRT-COD-TBAN IN SRT TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT = SPACES
              DISPLAY 'NO TIENE T. BCA. ASOCIADO '
      * GRABA CASO NO TIENE T. BCA. ASOCIADO
               MOVE 'NEX'                   TO WSS-NEX-TBCA
                                           IN WSS-VARI
               MOVE WSS-NUM-TLIN-BCA IN WSS-VARI TO WSS-NEX-TLIN
                                           IN WSS-VARI
               ADD WSS-VAL-ATRZ IN WSS-VARI TO WSS-NEX-ATRZ
                                           IN WSS-VARI
               ADD WSS-VAL-UTIL IN WSS-VARI TO WSS-NEX-UTIL
                                           IN WSS-VARI
               GO TO FIN-SUMA-VECTOR-BCA
           ELSE IF TAB-IND-VIGE IN TAB = 'N'
      * GRABA CASO T. BCA. NO VIGENTE
                   DISPLAY 'T. BCA. NO VIGENTE'
                   MOVE 'NVG'  TO WSS-NVG-TBCA IN WSS-VARI
                   MOVE WSS-NUM-TLIN-BCA IN WSS-VARI TO WSS-NVG-TLIN
                                           IN WSS-VARI
                   ADD WSS-VAL-ATRZ IN WSS-VARI TO WSS-NVG-ATRZ
                                           IN WSS-VARI
                   ADD WSS-VAL-UTIL IN WSS-VARI TO WSS-NVG-UTIL
                                           IN WSS-VARI
                   GO TO FIN-SUMA-VECTOR-BCA.

      * RRM-INI 19-APR-1999
       COMPARA.
      *    IF SRT-COD-TBAN IN SRT = WSS-COD-TBAN3
           IF SRT-COD-TBAN-OLD    = WSS-COD-TBAN3
      *RRM-FIN 19-APR-1999
                                           IN WSS-ARR-BCA(WSS-Y)
               MOVE WSS-NUM-TLIN-BCA IN WSS-VARI TO WSS-NUM-TLIN3
                                           IN WSS-ARR-BCA(WSS-Y)
               ADD WSS-VAL-ATRZ IN WSS-VARI TO WSS-VAL-ATRZ3
                                           IN WSS-ARR-BCA(WSS-Y)
               ADD WSS-VAL-UTIL IN WSS-VARI TO WSS-VAL-UTIL3
                                           IN WSS-ARR-BCA(WSS-Y)
           ELSE
      *RRM-INI 19-APR-1999
               IF WSS-NUM-LVEC > WSS-Y
      *RRM-FIN 19-APR-1999
                   ADD 1 TO WSS-Y IN WSS-VARI
                   GO TO NXT-POS-VECTOR-BCA.
       FIN-SUMA-VECTOR-BCA.
           EXIT.

       SUMA-CMAX-Y-CUTIL SECTION.
      *************************
       INI-SUMA-CMAX-Y-CUTIL.
           IF LDC-COD-VCLC IN SRT = WSS-COD-UF IN WSS-VARI
      *MOVER VALORES EN UF
               ADD LDC-VAL-CMAX IN SRT TO WSS-VAL-ATRZ IN WSS-VARI
               IF CCU-NUM-MENS < CCU-NUM-CALC AND
                  CCU-NUM-MENS > ZEROES
                   NEXT SENTENCE
               ELSE
                   ADD CUTI-LCR IN CCU-VARI(LDC-NUM-ILDC IN SRT) TO
                       WSS-VAL-UTIL IN WSS-VARI
           ELSE
      *CONVERTIR A UF
               COMPUTE WSS-VAL-ATRZ IN WSS-VARI ROUNDED =
                   WSS-VAL-ATRZ IN WSS-VARI  +
                  ( LDC-VAL-CMAX IN SRT / WSS-SGV-VCAM-UF IN WSS-VARI )

               IF CCU-NUM-MENS < CCU-NUM-CALC AND
                  CCU-NUM-MENS > ZEROES
                   NEXT SENTENCE
               ELSE
                   COMPUTE WSS-VAL-UTIL IN WSS-VARI ROUNDED =
                       WSS-VAL-UTIL IN WSS-VARI      +
                      ( CUTI-LCR IN CCU-VARI(LDC-NUM-ILDC IN SRT) /
                              WSS-SGV-VCAM-UF IN WSS-VARI ).
       FIN-SUMA-CMAX-Y-CUTIL.
           EXIT.

       OBT-GLOSA-OFICINA SECTION.
      ***************************
       INI-OBT-GLOSA-OFICINA.
           MOVE SPACES TO WSS-GLS-OFIC IN WSS-VARI.
           IF CLF-COD-OFIC IN SRT > SPACES
               MOVE CLF-COD-OFIC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
      *RRM-INI 15-APR-1999
      *        MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-VARI.
               IF FIO-STAT-OKS
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-VARI
               ELSE
                   MOVE 'CODIGO SIN GLOSA' TO WSS-GLS-OFIC IN WSS-VARI
           ELSE
               MOVE 'SIN CODIGO' TO WSS-GLS-OFIC IN WSS-VARI.
      *RRM-FIN 15-APR-1999
       FIN-OBT-GLOSA-OFICINA.
           EXIT.

       OBT-NOMBRE-EJECUTIVO SECTION.
      *****************************
       INI-OBT-NOMBRE-EJECUTIVO.
      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF DBC-COD-EJEC IN SRT > SPACES
                 MOVE DBC-COD-EJEC IN SRT TO USR-COD-USER IN USR
                 PERFORM BUS-USR
      *RRM-INI 15-APR-1999
                 IF FIO-STAT-OKS
      *RRM-FIN 15-APR-1999
                    MOVE USR-GLS-DESC IN USR TO CPT-STRN
                    PERFORM CPT-BLKS
                    MOVE CPT-STRN TO WSS-GLS-RMOC IN WSS-VARI
      *RRM-INI 15-APR-1999
                 ELSE
                    MOVE DBC-COD-EJEC IN SRT TO WSS-GLS-RMOC IN WSS-VARI
      *RRM-FIN 15-APR-1999
           ELSE
      *RRM-INI 15-APR-1999
      *         MOVE SPACES TO WSS-GLS-RMOC IN WSS-VARI.
                MOVE 'SIN CODIGO' TO WSS-GLS-RMOC IN WSS-VARI.
      *RRM-FIN 15-APR-1999
       FIN-OBT-NOMBRE-EJECUTIVO.
           EXIT.

       BUSCA-COD-REGIONAL SECTION.
      ****************************
       INI-BUSCA-COD-REGIONAL.
      * Busca Codigo Regional en OFI
           MOVE CLF-COD-OFIC IN CLF TO OFI-COD-OFIC IN OFI.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO SRT-COD-REGI IN SRT
           ELSE
              IF DBC-IND-TICL IN DBC = 'P'
                 IF OFI-COD-REGP IN OFI = SPACES
                    MOVE OFI-COD-REGE IN OFI TO SRT-COD-REGI IN SRT
                 ELSE
                    MOVE OFI-COD-REGP IN OFI TO SRT-COD-REGI IN SRT
              ELSE
                 IF OFI-COD-REGE IN OFI = SPACES
                    MOVE OFI-COD-REGP IN OFI TO SRT-COD-REGI IN SRT
                 ELSE
                    MOVE OFI-COD-REGE IN OFI TO SRT-COD-REGI IN SRT.
       FIN-BUSCA-COD-REGIONAL.
           EXIT.

       OBT-GLOSA-REGIONAL SECTION.
      ****************************
       INI-OBT-GLOSA-REGIONAL.
      *RRM-INI 15-APR-1999
           IF SRT-COD-REGI IN SRT > SPACES
      *RRM-FIN 15-APR-1999
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'RGN'               TO TAB-COD-TTAB IN TAB
              MOVE SRT-COD-REGI IN SRT TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
      *RRM-INI 15-APR-1999
      *       IF MSG-COD-MENS = SPACES
              IF FIO-STAT-OKS
      *RRM-FIN 15-APR-1999
                  MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-REGI IN WSS-VARI
              ELSE
      *RRM-INI 15-APR-1999
      *          IF TAB-IND-VIGE = 'N'
      *             MOVE 'COD    VIG' TO MSG-COD-MENS
      *             MOVE 'GNS'  TO MSG-COD-SIST
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO WSS-GLS-REGI IN WSS-VARI
      *          ELSE
      *             MOVE TAB-GLS-DESC TO WSS-GLS-REGI IN WSS-VARI.
                  MOVE 'CODIGO SIN GLOSA' TO WSS-GLS-REGI IN WSS-VARI
           ELSE
               MOVE 'SIN CODIGO' TO WSS-GLS-REGI IN WSS-VARI.
      *RRM-FIN 15-APR-1999
       FIN-OBT-GLOSA-REGIONAL.
           EXIT.


       OBT-GLOSA-BANCA SECTION.
      ****************************
       INI-OBT-GLOSA-BANCA.
              MOVE 'SGC'               TO TAB-COD-SIST.
              MOVE 'BAN'               TO TAB-COD-TTAB IN TAB.
              MOVE SRT-COD-TBAN IN SRT TO TAB-COD-CTAB IN TAB.
              PERFORM BUS-TAB.
              IF MSG-COD-MENS = SPACES
                  MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TBAN IN WSS-VARI
              ELSE
                  MOVE 'CODIGO SIN GLOSA' TO WSS-GLS-TBAN IN WSS-VARI.
       FIN-OBT-GLOSA-BANCA.
           EXIT.
      *VFP-FIN 10-DEC-1997

       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE 0 TO WSS-STAT-RDC IN WSS-VARI.
           MOVE CLF-CAI-ICLF IN SRT TO RDC-CAI-ICLF IN RDL.
           MOVE CLF-IIC-ICLF IN SRT TO RDC-IIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    CLF-CAI-ICLF IN SRT = RDC-CAI-ICLF IN RDL AND
                    CLF-IIC-ICLF IN SRT = RDC-IIC-ICLF IN RDL )
              MOVE 1 TO WSS-STAT-RDC IN WSS-VARI.
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
              CLF-CAI-ICLF IN SRT = RDC-CAI-ICLF IN RDL AND
              CLF-IIC-ICLF IN SRT = RDC-IIC-ICLF IN RDL
                MOVE 'M'    TO WSS-IND-MCLI IN WSS-VARI
           ELSE
                MOVE SPACES TO WSS-IND-MCLI IN WSS-VARI.
       FIN-GET-NXT-RDC.
           EXIT.

      * Lee con CIC CLIENTE archivo DBC
       GET-RDC-DBC SECTION.
       INI-GET-RDC-DBC.
           MOVE RDC-CIC-ICLI IN RDL TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              PERFORM RST-DBC
           ELSE
              MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
              PERFORM CPT-BLKS
              MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
       FIN-GET-RDC-DBC.
           EXIT.

       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.

      *Entidades de GNS
       COPY GNSBFMSC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBGCPT.
      *Entidades de TAB
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBVOFI.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
      *Entidades de LDC
      *<<<< NOT PGM_DB2
       COPY LDCBFCLF.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY LDCBFRDC REPLACING RDC BY RDL
                  ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY SGCBFDBC.
      *
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY COLBFRDC.
       COPY COLBFOPC.
       COPY COLBFDLC.
      *>>>>
      *>>>>

