       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      LDCPGICL.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    19-MAR-1996
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.

       DATA DIVISION.
      *=============*
       WORKING-STORAGE SECTION.
      *-----------------------*
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.

       COPY SUPBRD01.
       COPY LDCBRLDC.
       COPY LDCBRRDC.
       COPY LDCBRCLF.
       COPY SGCBRDBC.
       COPY SGCBRBDE.
       COPY TABBRCAM.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY GNSBRCIC.
       COPY GNSBRIDD.
       COPY GNSWVSCR.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGHOY.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGCIC.
       COPY GNSWGFEC.
       COPY GNSWCVRF.
       COPY GNSWVVRF.

       01  WSS-VARI.
           03 WSS-NUM-RLEE      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RCLF      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RERR      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-REXC      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-CLFG      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-LDCG      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-RDCG      VALUE ZEROES     PIC 9(06).
           03 WSS-NUM-ICLI.
               05 WSS-NUM-ICL1                   PIC X(01).
               05 WSS-NUM-ICL2                   PIC X(08).
           03 WSS-FEC-FVUF.
               05 WSS-NUM-DVUF                   PIC 9(02).
               05 WSS-NUM-MVUF                   PIC 9(02).
               05 WSS-NUM-SVUF                   PIC 9(02).
               05 WSS-NUM-AVUF                   PIC 9(02).
           03 WSS-FEC-FVEN.
               05 WSS-NUM-DVEN                   PIC 9(02).
               05 WSS-NUM-MVEN                   PIC 9(02).
               05 WSS-NUM-SVEN                   PIC 9(02).
               05 WSS-NUM-AVEN                   PIC 9(02).
           03 WSS-FEC-FREV.
               05 WSS-NUM-DREV                   PIC 9(02).
               05 WSS-NUM-MREV                   PIC 9(02).
               05 WSS-NUM-SREV                   PIC 9(02).
               05 WSS-NUM-AREV                   PIC 9(02).
           03 WSS-GLS-NOML                       PIC X(03).
           03 WSS-COD-TBTE  OCCURS 10 TIMES.
               05 WSS-COD-TBAN                   PIC X(03).
               05 WSS-COD-TEXC                   PIC X(03).
           03 WSS-AUX-TBTE       VALUE SPACES    PIC X(06).
           03 WSS-NUM-AUX        VALUE ZEROES    PIC 9(02).
           03 WSS-NUM-TBTE       VALUE ZEROES    PIC 9(02).
           03 WSS-VAL-DEUD       VALUE ZEROES    PIC 9(11)V9(2).
           03 WSS-CAI-ICLF
               05 WSS-COD-TCLF   VALUE SPACES    PIC X(01).
               05 WSS-COD-CCLF   VALUE SPACES    PIC X(03).
           03 WSS-COD-PESO       VALUE SPACES    PIC X(12).
           03 WSS-COD-UF         VALUE SPACES    PIC X(12).
           03 WSS-COD-TIPB       VALUE SPACES    PIC X(03).


       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           COPY GNSBGEDB.
           MOVE 'LDCPGICL' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           PERFORM  ABRE-ARCHIVOS.

      *RECIBE PARAMETROS
           DISPLAY ' '.
           DISPLAY 'INGRESE NOMBRE LINEA (XXX) : '.
           ACCEPT  WSS-GLS-NOML IN WSS-VARI.
           DISPLAY WSS-GLS-NOML IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA VALOR UF (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FVUF IN WSS-VARI.
           DISPLAY WSS-FEC-FVUF IN WSS-VARI.

      * VAL-FEC VALIDAR FECHA VALOR UF
           MOVE WSS-FEC-FVUF IN WSS-VARI TO FEC-FECH.
           PERFORM VAL-FECHA.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA VENCIMIENTO (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FVEN IN WSS-VARI.
           DISPLAY WSS-FEC-FVEN IN WSS-VARI.

      * VAL-FEC VALIDAR FECHA VENCIMIENTO
           MOVE WSS-FEC-FVEN IN WSS-VARI TO FEC-FECH.
           PERFORM VAL-FECHA.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA ULTIMA REVISION (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FREV IN WSS-VARI.
           DISPLAY WSS-FEC-FREV IN WSS-VARI.

      * VAL-FEC VALIDAR FECHA ULTIMA REVISION
           MOVE WSS-FEC-FREV IN WSS-VARI TO FEC-FECH.
           PERFORM VAL-FECHA.

           DISPLAY ' '.
           DISPLAY 'INGRESE TIPO BANCA/TABLA EXCLUSION (XXXYYY) : '.
           DISPLAY 'TERMINE INGRESO CON 999'.
           MOVE 0 TO WSS-NUM-TBTE IN WSS-VARI.
       LUP-PARAM.
           ACCEPT WSS-AUX-TBTE IN WSS-VARI.
           DISPLAY WSS-AUX-TBTE IN WSS-VARI.
           IF WSS-AUX-TBTE IN WSS-VARI NOT = '999' AND
              WSS-NUM-TBTE IN WSS-VARI < 10
               ADD 1 TO WSS-NUM-TBTE IN WSS-VARI
               MOVE WSS-AUX-TBTE IN WSS-VARI TO
                                    WSS-COD-TBTE(WSS-NUM-TBTE)
               PERFORM VAL-EXIS-TBAN-TEXC
               GO TO LUP-PARAM.

      * OBTIENE LA FECHA DE HOY.
           PERFORM GET-FHOY.

      * LEE BDE DE INPUT.
           MOVE LOW-VALUES         TO BDE-CIC-ICLI.
           MOVE FIO-GET-FST        TO FIO-CMND.
           PERFORM SGC-FIO-BDE.
           IF NOT FIO-STAT-OKS
              DISPLAY ' ARCHIVO SGCBDE VACIO '
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.

           MOVE 1 TO WSS-NUM-RLEE IN WSS-VARI.
       LUP-BDE.
           MOVE BDE-CIC-ICLI IN BDE   TO RDC-CIC-ICLI IN RDC.
           MOVE LOW-VALUES            TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF (FIO-STAT-OKS AND
               RDC-CIC-ICLI IN RDC = BDE-CIC-ICLI IN BDE)
                ADD 1 TO WSS-NUM-RCLF IN WSS-VARI
                GO TO CON-BDE.

      * LEE DBC
           MOVE BDE-CAI-ICLI IN BDE  TO DBC-CAI-ICLI IN DBC.
           MOVE BDE-IIC-ICLI IN BDE  TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'CLIENTE SIN DBC ' BDE-CIC-ICLI IN BDE
              ADD 1 TO WSS-NUM-RERR IN WSS-VARI
              GO TO CON-BDE.

           MOVE BDE-COD-TIPB TO WSS-COD-TIPB IN WSS-VARI.

           MOVE 1 TO WSS-NUM-AUX.
       LUP-VAL-TBAN.
           IF WSS-COD-TIPB IN WSS-VARI NOT = WSS-COD-TBAN(WSS-NUM-AUX)
              ADD 1 TO WSS-NUM-AUX
              GO TO LUP-VAL-TBAN.

           IF WSS-COD-TEXC(WSS-NUM-AUX) NOT > SPACES
              GO TO CON-ING.


      * VALIDA OFICINA CLIENTE CONTRA TABLA DE EXCLUSION
           MOVE 'LDC' TO FIO-SIST.
           MOVE WSS-COD-TEXC(WSS-NUM-AUX) TO TAB-COD-TTAB IN TAB.
           MOVE DBC-COD-OFIC IN DBC       TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              ADD 1 TO WSS-NUM-REXC IN WSS-VARI
              GO TO CON-BDE.

       CON-ING.
           MOVE '2' TO D01-IND-TREG IN D01.
           MOVE '0' TO WSS-NUM-ICL1 IN WSS-VARI.
           MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICL2 IN WSS-VARI.
           MOVE WSS-NUM-ICLI IN WSS-VARI TO D01-NUM-RUTD IN D01.
           MOVE DBC-VRF-ICLI IN DBC TO D01-VRF-RUTD IN D01.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SUP-FIO-D01.
           IF NOT FIO-STAT-OKS
              DISPLAY 'CLIENTE SIN D01 ' BDE-CIC-ICLI IN BDE
              DISPLAY 'RUT ' DBC-NUM-ICLI '-' DBC-VRF-ICLI
              ADD 1 TO WSS-NUM-RERR IN WSS-VARI
              GO TO CON-BDE.
           DISPLAY 'CLIENTE CON D01 ' BDE-CIC-ICLI IN BDE.
           MOVE D01-VAL-DVGL IN D01 TO WSS-VAL-DEUD IN WSS-VARI.
           ADD D01-VAL-DVGX  IN D01 TO WSS-VAL-DEUD IN WSS-VARI.
           ADD D01-VAL-IVGL  IN D01 TO WSS-VAL-DEUD IN WSS-VARI.
           ADD D01-VAL-IVGX  IN D01 TO WSS-VAL-DEUD IN WSS-VARI.
           ADD D01-VAL-TCOM  IN D01 TO WSS-VAL-DEUD IN WSS-VARI.

           MULTIPLY WSS-VAL-DEUD IN WSS-VARI BY 1000
                                GIVING WSS-VAL-DEUD IN WSS-VARI.

           PERFORM CNV-PESO-UF.
           DISPLAY 'VALORES PESOS CONVERTIDOS'.
           MOVE 'L'                 TO WSS-COD-TCLF IN WSS-VARI.
           MOVE DBC-COD-OFIC IN DBC TO WSS-COD-CCLF IN WSS-VARI.
           MOVE WSS-CAI-ICLF IN WSS-VARI TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               DISPLAY 'ERROR AL OBTENER CORRELATIVO CLF'
               ADD 1 TO WSS-NUM-RERR IN WSS-VARI
               GO TO CON-BDE.
           MOVE CIC-CIC-ICIC TO CLF-CIC-ICLF IN CLF.
           DISPLAY 'CLF ' CIC-CIC-ICIC.
           PERFORM GRABA-CLF.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR CLF ' CLF-CIC-ICLF IN CLF
              ADD 1 TO WSS-NUM-RERR IN WSS-VARI
              GO TO CON-BDE.
           ADD 1 TO WSS-NUM-CLFG IN WSS-VARI.

           PERFORM GRABA-LDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR LDC ' CLF-CIC-ICLF IN CLF
              ADD 1 TO WSS-NUM-RERR IN WSS-VARI
              GO TO CON-BDE.
           ADD 1 TO WSS-NUM-LDCG IN WSS-VARI.

           PERFORM GRABA-RDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR AL GRABAR RDC ' CLF-CIC-ICLF IN CLF
              ADD 1 TO WSS-NUM-RERR IN WSS-VARI
              GO TO CON-BDE.
           ADD 1 TO WSS-NUM-RDCG IN WSS-VARI.

       CON-BDE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-BDE.
           IF FIO-STAT-OKS
              ADD 1 TO WSS-NUM-RLEE IN WSS-VARI
              GO TO LUP-BDE.

           DISPLAY ' FIN DE ARCHIVO '.
           DISPLAY 'NUMERO DE REGISTROS LEIDOS   : ' WSS-NUM-RLEE.
           DISPLAY 'NUMERO DE REGISTROS CON CLF  : ' WSS-NUM-RCLF.
           DISPLAY 'NUMERO DE REGISTROS ERRONEOS : ' WSS-NUM-RERR.
           DISPLAY 'NUMERO DE REGISTROS EXCLUIDOS: ' WSS-NUM-REXC.
           DISPLAY 'NUMERO DE CLF GRABADAS       : ' WSS-NUM-CLFG.
           DISPLAY 'NUMERO DE LDC GRABADAS       : ' WSS-NUM-LDCG.
           DISPLAY 'NUMERO DE RDC GRABADAS       : ' WSS-NUM-RDCG.
           PERFORM CIERRA-ARCHIVOS.
           STOP RUN.

       FIN-MAIN.
      *--------*

       ABRE-ARCHIVOS SECTION.
       INI-ABRE-ARCHIVOS.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-BDE.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN APERTURA SEQ: ' FIO-STAT
              PERFORM GNS-PRO-END.
       FIN-ABRE-ARCHIVOS.
           EXIT.


       CIERRA-ARCHIVOS SECTION.
       INI-CIERRA-ARCHIVOS.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-BDE.
       FIN-CIERRA-ARCHIVOS.
           EXIT.


       GRABA-CLF SECTION.
       INI-GRABA-CLF.
           MOVE SPACES TO CLF.
           MOVE HOY-STP-ITRN TO CLF-STP-ITRN IN CLF.
           MOVE 'I' TO CLF-MSC-TACC IN CLF.
           MOVE 'A'   TO CLF-MSC-STAT IN CLF.
           MOVE 'BACH' TO CLF-COD-OTRN IN CLF.
           MOVE 'LDCPGICL' TO CLF-COD-ATRN IN CLF.
           MOVE '0998' TO CLF-COD-VCCF IN CLF.
           MOVE 'CLF' TO CLF-COD-TOCF IN CLF.
           MOVE DBC-COD-OFIC IN DBC TO CLF-COD-OFIC IN CLF.
           MOVE DBC-COD-EJEC IN DBC TO CLF-COD-EJEC IN CLF.
           MOVE FEC-FHOY TO CLF-FEC-FAPE IN CLF.
           MOVE FEC-FHOY TO CLF-FEC-FING IN CLF.
           MOVE 1 TO CLF-NUM-PREV IN CLF.
           MOVE 'A' TO CLF-IND-PREV IN CLF.
           MOVE WSS-FEC-FREV TO CLF-FEC-FURV IN CLF.
           MOVE 1 TO CLF-NUM-PVIG IN CLF.
           MOVE 'A' TO CLF-IND-PVIG IN CLF.
           MOVE ZEROES TO CLF-FEC-FCIE IN CLF.
           MOVE WSS-VAL-DEUD TO CLF-VAL-CMAX IN CLF.
           MOVE ZEROES TO CLF-FEC-FPRV IN CLF.
           MOVE WSS-FEC-FVEN TO CLF-FEC-FVEN IN CLF.
           MOVE 'M' TO CLF-IND-UCAP IN CLF.
           MOVE ZEROES TO CLF-VAL-COMI IN CLF.
           MOVE ZEROES TO CLF-IIC-CREN IN CLF.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF FIO-STAT-OKS
              DISPLAY '*  ' DBC-NUM-ICLI '-' DBC-VRF-ICLI ' '
               DBC-IND-ICLI '  ' DBC-GLS-ICLI '  ' CLF-CIC-ICLF '  '
               CLF-VAL-CMAX '  ' CLF-FEC-FAPE.
       FIN-GRABA-CLF.
           EXIT.

       GRABA-LDC SECTION.
       INI-GRABA-LDC.
           MOVE SPACES TO LDC.
           MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE 1 TO LDC-NUM-ILDC IN LDC.
           MOVE HOY-STP-ITRN TO LDC-STP-ITRN IN LDC.
           MOVE 'I' TO LDC-MSC-TACC IN LDC.
           MOVE 'BACH' TO LDC-COD-OTRN IN LDC.
           MOVE 'LDCPGICL' TO LDC-COD-ATRN IN LDC.
           MOVE 'ESPECIAL INGRESO SISTEMA' TO
                                LDC-GLS-DESC IN LDC
           MOVE WSS-VAL-DEUD TO LDC-VAL-CMAX IN LDC.
           MOVE 'S'          TO LDC-IND-MGAR IN LDC.
           MOVE 1 TO LDC-NUM-PVIG IN LDC.
           MOVE 'A' TO LDC-IND-PVIG IN LDC.
           MOVE 'S'          TO LDC-IND-VIGE IN LDC.
           MOVE WSS-FEC-FVEN TO LDC-FEC-FVEN IN LDC.
           MOVE 100 TO LDC-VAL-RSG1 IN LDC.
           MOVE ZEROES TO LDC-VAL-RSG2 IN LDC.
           MOVE WSS-GLS-NOML TO LDC-COD-TIPO IN LDC.
           MOVE FEC-FHOY TO LDC-FEC-FINI IN LDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
       FIN-GRABA-LDC.
           EXIT.

       GRABA-RDC SECTION.
       INI-GRABA-RDC.
           MOVE CLF-CIC-ICLF IN CLF TO RDC-CIC-ICLF IN RDC.
           MOVE BDE-CIC-ICLI IN BDE TO RDC-CIC-ICLI IN RDC.
           MOVE HOY-STP-ITRN TO RDC-STP-ITRN IN RDC.
           MOVE 'I' TO RDC-MSC-TACC IN RDC.
           MOVE 'BACH' TO RDC-COD-OTRN IN RDC.
           MOVE 'LDCPGICL' TO RDC-COD-ATRN IN RDC.
           MOVE 100 TO RDC-VAL-PRDC IN RDC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
       FIN-GRABA-RDC.
           EXIT.

       VAL-FECHA SECTION.
       INI-VAL-FECHA.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-HBL
              DISPLAY 'FECHA NO HABIL '
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.
       FIN-VAL-FECHA.
           EXIT.

       VAL-EXIS-TBAN-TEXC SECTION.
       INI-VAL-EXIS-TBAN-TEXC.
      * VALIDA EXISTENCIA TIPO BANCA Y TABLA DE EXCLUSION.
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'BAN ' TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-TBAN(WSS-NUM-TBTE) TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
              DISPLAY MSG-GLS-MENS
              '(TIPO BANCA)'
                                   WSS-COD-TBAN(WSS-NUM-TBTE)
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.
           IF WSS-COD-TEXC(WSS-NUM-TBTE) NOT > SPACES
              GO TO FIN-VAL-EXIS-TBAN-TEXC.
           MOVE 'LDC' TO FIO-SIST.
           MOVE WSS-COD-TEXC(WSS-NUM-TBTE) TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                     TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY 'TABLA EXCLUSION INEXISTENTE '
                                     WSS-COD-TEXC(WSS-NUM-TBTE)
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.
       FIN-VAL-EXIS-TBAN-TEXC.
           EXIT.

       CNV-PESO-UF SECTION.
       INI-CNV-PESO-UF.
      *ANTES DE GRABAR LOS VALORES CORRESPONDIENTES A LA CLF, LOS
      *CONVIERTE DE PESOS A UF.
           MOVE WSS-NUM-DVUF IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE WSS-NUM-MVUF IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-SVUF IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-AVUF IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).

      * OBTIENE CODIGO VALOR DE CAMBIO DE PESOS MEDIANTE CIC DE LA MONED
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0999 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      * OBTIENE CODIGO VALOR DE CAMBIO DE UF MEDIANTE CIC DE LA MONED
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0998 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
              PERFORM CIERRA-ARCHIVOS
              STOP RUN.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.

      *BUSCA DE UF A PESO PARA LUEGO DIVIDIR.
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
           ELSE
               DIVIDE WSS-VAL-DEUD IN WSS-VARI BY CAM-SGV-VCAM IN CAM
                          GIVING WSS-VAL-DEUD IN WSS-VARI ROUNDED.
       FIN-CNV-PESO-UF.
           EXIT.


       COPY SGCBFBDE.
       COPY SGCBFDBC.
       COPY LDCBFRDC.
       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY SUPBXD01.
       COPY TABBFCAM.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBFCIC.
       COPY GNSBGDTC.
       COPY GNSBGCIC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBBTAB.
       COPY GNSBGEND.
       COPY GNSBGABT.

