      *
      * LDCBULDC
      * Version 3.0.1 Nov-2005
      * 08-May-19 11:45 AM
      *
       SET-TAG-LDCBULDC SECTION.
       INI-SET-TAG-LDCBULDC.
           MOVE
           '<IDNMOD NOM=$LDCBULDC$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$08-May-19 11:45 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBULDC.
           EXIT.
           
       RET-ALL-LDC SECTION.
       INI-RET-ALL-LDC.
           PERFORM KEY-ALL-LDC.
           PERFORM RET-CLF-LDC.
           PERFORM RET-LDC-LDC.
           PERFORM RET-DBC-LDC.
           PERFORM RET-ARC-LDC.
           PERFORM RET-ARG-LDC.
       FIN-RET-ALL-LDC.
           EXIT.
       
       RET-CLF-LDC SECTION.
       INI-RET-CLF-LDC.
           MOVE CLF-COD-VCCF IN LDC-FLD TO CLF-COD-VCCF IN CLF.
           MOVE CLF-COD-TOCF IN LDC-FLD TO CLF-COD-TOCF IN CLF.
           MOVE CLF-COD-AOCF IN LDC-FLD TO CLF-COD-AOCF IN CLF.
       FIN-RET-CLF-LDC.
           EXIT.
       
       RET-LDC-LDC SECTION.
       INI-RET-LDC-LDC.
           MOVE LDC-COD-TIPO IN LDC-FLD TO LDC-COD-TIPO IN LDC.
           MOVE LDC-GLS-DESC IN LDC-FLD TO LDC-GLS-DESC IN LDC.
           MOVE LDC-GLS-DCOR IN LDC-FLD TO LDC-GLS-DCOR IN LDC.
           MOVE LDC-COD-FAMI IN LDC-FLD TO LDC-COD-FAMI IN LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD TO LDC-VAL-CMAX IN LDC.
           MOVE LDC-COD-VCLC IN LDC-FLD TO LDC-COD-VCLC IN LDC.
           MOVE LDC-IND-MGAR IN LDC-FLD TO LDC-IND-MGAR IN LDC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-NUM-DINI IN LDC-FLD TO LDC-NUM-DINI IN LDC.
           MOVE LDC-NUM-MINI IN LDC-FLD TO LDC-NUM-MINI IN LDC.
           MOVE LDC-NUM-SINI IN LDC-FLD TO LDC-NUM-SINI IN LDC.
           MOVE LDC-NUM-AINI IN LDC-FLD TO LDC-NUM-AINI IN LDC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-NUM-PVIG IN LDC-FLD TO LDC-NUM-PVIG IN LDC.
           MOVE LDC-IND-PVIG IN LDC-FLD TO LDC-IND-PVIG IN LDC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-NUM-DVEN IN LDC-FLD TO LDC-NUM-DVEN IN LDC.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO LDC-NUM-MVEN IN LDC.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO LDC-NUM-SVEN IN LDC.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO LDC-NUM-AVEN IN LDC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE LDC-IND-VIGE IN LDC-FLD TO LDC-IND-VIGE IN LDC.
       FIN-RET-LDC-LDC.
           EXIT.
       
       RET-DBC-LDC SECTION.
       INI-RET-DBC-LDC.
           MOVE DBC-GLS-NOMC IN LDC-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN LDC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN LDC-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN LDC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN LDC-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-DBC-LDC.
           EXIT.
       
       RET-ARC-LDC SECTION.
       INI-RET-ARC-LDC.
           MOVE ARC-COD-VCOC IN LDC-FLD TO ARC-COD-VCOC IN ARC.
           MOVE ARC-COD-TOOC IN LDC-FLD TO ARC-COD-TOOC IN ARC.
           MOVE ARC-COD-AOOC IN LDC-FLD TO ARC-COD-AOOC IN ARC.
           MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC IN ARC.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC IN ARC.
       FIN-RET-ARC-LDC.
           EXIT.
       
       RET-ARG-LDC SECTION.
       INI-RET-ARG-LDC.
           MOVE ARG-COD-TOGA IN LDC-FLD TO ARG-COD-TOGA IN ARG.
           MOVE ARG-COD-AOGA IN LDC-FLD TO ARG-COD-AOGA IN ARG.
           MOVE ARG-NUM-PORG IN LDC-FLD TO ARG-NUM-PORG IN ARG.
           MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR IN ARG.
           MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR IN ARG.
       FIN-RET-ARG-LDC.
           EXIT.
       
       KEY-ALL-LDC SECTION.
       INI-KEY-ALL-LDC.
           PERFORM KEY-CLF-LDC.
           PERFORM KEY-LDC-LDC.
           PERFORM KEY-DBC-LDC.
           PERFORM KEY-ARC-LDC.
           PERFORM KEY-ARG-LDC.
       FIN-KEY-ALL-LDC.
           EXIT.
       
       KEY-CLF-LDC SECTION.
       INI-KEY-CLF-LDC.
       FIN-KEY-CLF-LDC.
           EXIT.
       
       KEY-LDC-LDC SECTION.
       INI-KEY-LDC-LDC.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO LDC-NUM-ILDC IN LDC.
       FIN-KEY-LDC-LDC.
           EXIT.
       
       KEY-DBC-LDC SECTION.
       INI-KEY-DBC-LDC.
       FIN-KEY-DBC-LDC.
           EXIT.
       
       KEY-ARC-LDC SECTION.
       INI-KEY-ARC-LDC.
       FIN-KEY-ARC-LDC.
           EXIT.
       
       KEY-ARG-LDC SECTION.
       INI-KEY-ARG-LDC.
       FIN-KEY-ARG-LDC.
           EXIT.
       
       SCR-CLRA-LDC SECTION.
       INI-SCR-CLRA-LDC.
           PERFORM CLR-KEY-LDC.
           PERFORM CLR-FLD-LDC.
       FIN-SCR-CLRA-LDC.
           EXIT.
       
       CLR-KEY-LDC SECTION.
       INI-CLR-KEY-LDC.
           MOVE SPACES TO LDC-CAI-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-IIC-ICLF IN LDC-FLD.
           MOVE ZEROES TO LDC-NUM-ILDC IN LDC-FLD.
       FIN-CLR-KEY-LDC.
           EXIT.
       
       CLR-FLD-LDC SECTION.
       INI-CLR-FLD-LDC.
           MOVE SPACES TO FRM-GLS-VCCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-FAMI IN LDC-FLD.
           MOVE SPACES TO FRM-IND-MARC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-VCLC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD.
           MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD.
           PERFORM CLR-CLF-LDC.
           PERFORM CLR-LDC-LDC.
           PERFORM CLR-DBC-LDC.
           PERFORM CLR-ARC-LDC.
           PERFORM CLR-ARG-LDC.
       FIN-CLR-FLD-LDC.
           EXIT.
       
       CLR-CLF-LDC SECTION.
       INI-CLR-CLF-LDC.
           MOVE SPACES TO CLF-COD-VCCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN LDC-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN LDC-FLD.
       FIN-CLR-CLF-LDC.
           EXIT.
       
       CLR-LDC-LDC SECTION.
       INI-CLR-LDC-LDC.
           MOVE SPACES TO LDC-COD-TIPO IN LDC-FLD.
           MOVE SPACES TO LDC-GLS-DESC IN LDC-FLD.
           MOVE SPACES TO LDC-GLS-DCOR IN LDC-FLD.
           MOVE SPACES TO LDC-COD-FAMI IN LDC-FLD.
           MOVE ZEROES TO LDC-VAL-CMAX IN LDC-FLD.
           MOVE SPACES TO LDC-COD-VCLC IN LDC-FLD.
           MOVE SPACES TO LDC-IND-MGAR IN LDC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FINI IN LDC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-NUM-PVIG IN LDC-FLD.
           MOVE SPACES TO LDC-IND-PVIG IN LDC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO LDC-FEC-FVEN IN LDC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD.
       FIN-CLR-LDC-LDC.
           EXIT.
       
       CLR-DBC-LDC SECTION.
       INI-CLR-DBC-LDC.
           MOVE SPACES TO DBC-GLS-NOMC IN LDC-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN LDC-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN LDC-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-LDC.
           EXIT.
       
       CLR-ARC-LDC SECTION.
       INI-CLR-ARC-LDC.
           MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD.
           MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD.
           MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD.
           MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD.
       FIN-CLR-ARC-LDC.
           EXIT.
       
       CLR-ARG-LDC SECTION.
       INI-CLR-ARG-LDC.
           MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD.
           MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD.
           MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD.
           MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-CLR-ARG-LDC.
           EXIT.
       
       FST-KEY-LDC SECTION.
       INI-FST-KEY-LDC.
           MOVE -1 TO LDC-CAI-ICLF-LEN IN LDC-FLD.
      *<<<< FIN_FST_KEY_LDC
           IF SCR-CCPP = 'ING' OR 'ELI'
               MOVE FRM-CPIM-AEY TO LDC-NUM-ILDC-ATR IN LDC-FLD.
      *>>>>
       FIN-FST-KEY-LDC.
           EXIT.
       
       FST-FLD-LDC SECTION.
       INI-FST-FLD-LDC.
           MOVE -1 TO LDC-COD-TIPO-LEN IN LDC-FLD.
      *<<<< FIN_FST_FLD_LDC
      *FLB CST  10-JUN-1994
           IF SCR-CCPP = 'ING'
               MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD
               MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO FRM-IND-MARC-ATR IN LDC-FLD.

           IF CMA-NUM-ARC IN CMA-VARI > 1 OR
              FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE 'S'    TO FRM-IND-MARC IN LDC-FLD
               MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD
                              ARC-COD-TOOC IN LDC-FLD
                              ARC-COD-AOOC IN LDC-FLD
                              ARC-CAI-IOPC IN LDC-FLD
               MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               IF CMA-NUM-ARC IN CMA-VARI > 1
                   MOVE FRM-CPIM-AEY TO ARC-COD-VCOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-TOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-COD-AOOC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-CAI-IOPC-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARC-IIC-IOPC-ATR IN LDC-FLD.

           IF CMA-NUM-ARG IN CMA-VARI > 1 OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )

               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               IF CMA-NUM-ARG IN CMA-VARI > 1
                   MOVE FRM-CPIM-AEY TO ARG-COD-TOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-COD-AOGA-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-CAI-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-IIC-IGAR-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO ARG-NUM-PORG-ATR IN LDC-FLD
                   MOVE FRM-CPIM-AEY TO LDC-IND-MGAR-ATR IN LDC-FLD.
      *FLB CST  10-JUN-1994 FIN

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               GO TO FST-NO-LDC-TIPO.

           MOVE FRM-CPIM-AEY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
       FST-NO-LDC-TIPO.
      *>>>>
       FIN-FST-FLD-LDC.
           EXIT.
       
       PRO-KEY-LDC SECTION.
       INI-PRO-KEY-LDC.
           PERFORM PRO-MKY-LDC.
       FIN-PRO-KEY-LDC.
           EXIT.
       
       PRO-MKY-LDC SECTION.
       INI-PRO-MKY-LDC.
       FIN-PRO-MKY-LDC.
           EXIT.
       
       PRO-FLD-LDC SECTION.
       INI-PRO-FLD-LDC.
           MOVE FRM-CPIM-AEY TO FRM-IND-MARC-ATR IN LDC-FLD.
           PERFORM PRO-CLF-LDC.
           PERFORM PRO-LDC-LDC.
           PERFORM PRO-DBC-LDC.
           PERFORM PRO-ARC-LDC.
           PERFORM PRO-ARG-LDC.
       FIN-PRO-FLD-LDC.
           EXIT.
       
       PRO-CLF-LDC SECTION.
       INI-PRO-CLF-LDC.
       FIN-PRO-CLF-LDC.
           EXIT.
       
       PRO-LDC-LDC SECTION.
       INI-PRO-LDC-LDC.
           MOVE FRM-CPIM-AEY TO LDC-COD-TIPO-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-VAL-CMAX-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-COD-VCLC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-MGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-FEC-FINI-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-NUM-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-FEC-FVEN-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO LDC-IND-VIGE-ATR IN LDC-FLD.
       FIN-PRO-LDC-LDC.
           EXIT.
       
       PRO-DBC-LDC SECTION.
       INI-PRO-DBC-LDC.
       FIN-PRO-DBC-LDC.
           EXIT.
       
       PRO-ARC-LDC SECTION.
       INI-PRO-ARC-LDC.
           MOVE FRM-CPIM-AEY TO ARC-COD-VCOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-COD-TOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-COD-AOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-CAI-IOPC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARC-IIC-IOPC-ATR IN LDC-FLD.
       FIN-PRO-ARC-LDC.
           EXIT.
       
       PRO-ARG-LDC SECTION.
       INI-PRO-ARG-LDC.
           MOVE FRM-CPIM-AEY TO ARG-COD-TOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-COD-AOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-NUM-PORG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-CAI-IGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-AEY TO ARG-IIC-IGAR-ATR IN LDC-FLD.
       FIN-PRO-ARG-LDC.
           EXIT.
       
       UNP-KEY-LDC SECTION.
       INI-UNP-KEY-LDC.
           PERFORM UNP-IKY-LDC.
           PERFORM UNP-AKY-LDC.
           PERFORM UNP-MKY-LDC.
       FIN-UNP-KEY-LDC.
           EXIT.
       
       UNP-IKY-LDC SECTION.
       INI-UNP-IKY-LDC.
           MOVE FRM-CPIM-UBY TO LDC-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-IIC-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO LDC-NUM-ILDC-ATR.
       FIN-UNP-IKY-LDC.
           EXIT.
       
       UNP-MKY-LDC SECTION.
       INI-UNP-MKY-LDC.
       FIN-UNP-MKY-LDC.
           EXIT.
       
       UNP-AKY-LDC SECTION.
       INI-UNP-AKY-LDC.
       FIN-UNP-AKY-LDC.
           EXIT.
       
       UNP-FLD-LDC SECTION.
       INI-UNP-FLD-LDC.
           MOVE FRM-CPIM-UBY TO FRM-IND-MARC-ATR IN LDC-FLD.
           PERFORM UNP-CLF-LDC.
           PERFORM UNP-LDC-LDC.
           PERFORM UNP-DBC-LDC.
           PERFORM UNP-ARC-LDC.
           PERFORM UNP-ARG-LDC.
       FIN-UNP-FLD-LDC.
           EXIT.
       
       UNP-CLF-LDC SECTION.
       INI-UNP-CLF-LDC.
       FIN-UNP-CLF-LDC.
           EXIT.
       
       UNP-LDC-LDC SECTION.
       INI-UNP-LDC-LDC.
           MOVE FRM-CPIM-UBY TO LDC-COD-TIPO-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DESC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-GLS-DCOR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-VAL-CMAX-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-COD-VCLC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-MGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FINI-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-NUM-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-PVIG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-FEC-FVEN-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO LDC-IND-VIGE-ATR IN LDC-FLD.
       FIN-UNP-LDC-LDC.
           EXIT.
       
       UNP-DBC-LDC SECTION.
       INI-UNP-DBC-LDC.
       FIN-UNP-DBC-LDC.
           EXIT.
       
       UNP-ARC-LDC SECTION.
       INI-UNP-ARC-LDC.
           MOVE FRM-CPIM-UBY TO ARC-COD-VCOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-TOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-COD-AOOC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-CAI-IOPC-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARC-IIC-IOPC-ATR IN LDC-FLD.
       FIN-UNP-ARC-LDC.
           EXIT.
       
       UNP-ARG-LDC SECTION.
       INI-UNP-ARG-LDC.
           MOVE FRM-CPIM-UBY TO ARG-COD-TOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-COD-AOGA-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-NUM-PORG-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-CAI-IGAR-ATR IN LDC-FLD.
           MOVE FRM-CPIM-UBY TO ARG-IIC-IGAR-ATR IN LDC-FLD.
       FIN-UNP-ARG-LDC.
           EXIT.
       
       VAL-MKY-LDC SECTION.
       INI-VAL-MKY-LDC.
       FIN-VAL-MKY-LDC.
           EXIT.
       
       VAL-FLD-LDC SECTION.
       INI-VAL-FLD-LDC.
      *<<<< INI_VAL_FLD_LDC
      *FLB CST  23-FEB-1995
      * EXAMINA SI LDC PERMITE MONEDA DISTINTA A LA DE CLF
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'MONLDC<>CLF'        TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-MLMC
           ELSE
               MOVE 'N' TO WSS-VSN-MLMC.

      *FLB CST  26-OCT-1993
      * EXAMINA SI LOS CORRELATIVOS SE DAN DE LA FORMA XSUC O LIBRE
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE 'S' TO WSS-VSN-OCAI
           ELSE
               MOVE 'N' TO WSS-VSN-OCAI.

      *SMC-INI 26-10-1993 LEE TABLA VSN PARA DETERMINAR SI SE
      *                   USO DE FUNCIONALIDADES DE CTE, CEX
      *                   LEA, TCR.
      * BUSCA REGISTRO CTE.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCTE      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCTE IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCTE IN WSS-VARI.

      * BUSCA REGISTRO CEX.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE 'LDCCEX      '       TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VCEX IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VCEX IN WSS-VARI.

      * BUSCA REGISTRO LEA.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCLEA      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VLEA IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VLEA IN WSS-VARI.

      * BUSCA REGISTRO TCR.
           MOVE 'TAB'                TO FIO-SIST
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
           MOVE  'LDCTCR      '      TO TAB-COD-CTAB IN TAB
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM GNS-FIO-TAB
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-VTCR IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-VTCR IN WSS-VARI.

      * ASIGNA O NO EL NUMERO DE CREDITO
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'ASIGNAOPC   '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AOPC IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AOPC IN WSS-VARI.

      * Permite o no TIO sin AUX
           MOVE 'DEU'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE  'TIO+AUX OBL '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
              MOVE TAB-IND-VIGE IN TAB  TO WSS-VSN-AXOB IN WSS-VARI
           ELSE
              MOVE  'N'                 TO WSS-VSN-AXOB IN WSS-VARI.
      *>>>>
           PERFORM VAL-CLF-COD-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-VCCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-CLF-COD-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-TOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-CLF-COD-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-COD-AOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-VCCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOCF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOCF-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-COD-TIPO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-COD-TIPO-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-GLS-DESC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-GLS-DESC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-GLS-DCOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-GLS-DCOR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-COD-FAMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-COD-FAMI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-FAMI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-FAMI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-IND-MARC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-MARC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-VAL-CMAX.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARC-COD-VCOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-COD-VCLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-COD-VCLC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-VCLC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCLC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARC-COD-TOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-COD-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARC-COD-AOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOOC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-IND-MGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IND-MGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARC-CAI-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARC-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-COD-TOGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARG-COD-TOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-COD-AOGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARG-COD-AOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-TOGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-FRM-GLS-AOGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-AOGA-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-NUM-PORG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-CAI-IGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARG-CAI-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-ARG-IIC-IGAR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LDC-FEC-FINI-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-NUM-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
           PERFORM VAL-LDC-IND-PVIG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IND-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-FEC-FVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                LDC-FEC-FVEN-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-LDC-IND-VIGE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO LDC-IND-VIGE-LEN IN LDC-FLD
                GO TO FIN-VAL-FLD-LDC.
       FIN-VAL-FLD-LDC.
           EXIT.
       
       VAL-CLF-COD-VCCF SECTION.
       INI-VAL-CLF-COD-VCCF.
       FIN-VAL-CLF-COD-VCCF.
           EXIT.
       
       VAL-CLF-COD-TOCF SECTION.
       INI-VAL-CLF-COD-TOCF.
       FIN-VAL-CLF-COD-TOCF.
           EXIT.
       
       VAL-CLF-COD-AOCF SECTION.
       INI-VAL-CLF-COD-AOCF.
       FIN-VAL-CLF-COD-AOCF.
           EXIT.
       
       VAL-FRM-GLS-VCCF SECTION.
       INI-VAL-FRM-GLS-VCCF.
       FIN-VAL-FRM-GLS-VCCF.
           EXIT.
       
       VAL-FRM-GLS-TOCF SECTION.
       INI-VAL-FRM-GLS-TOCF.
       FIN-VAL-FRM-GLS-TOCF.
           EXIT.
       
       VAL-FRM-GLS-AOCF SECTION.
       INI-VAL-FRM-GLS-AOCF.
       FIN-VAL-FRM-GLS-AOCF.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN LDC-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN LDC-FLD.
      *<<<<
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN LDC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN LDC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN LDC-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN LDC-FLD.
      *<<<<
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN LDC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN LDC-FLD.
      *>>>>
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN LDC-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LDC-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN LDC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN LDC-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LDC-COD-TIPO SECTION.
       INI-VAL-LDC-COD-TIPO.
           IF LDC-COD-TIPO IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-COD-TIPO IN LDC-FLD.
      *<<<< LDC_COD_TIPO
      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           MOVE 'DEU' TO FIO-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'CODTIPLDC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
               MOVE 'N' TO TLC-VSN-TIPO IN TLC-VARI
               GO TO FIN-VAL-LDC-COD-TIPO.

           MOVE 'S' TO TLC-VSN-TIPO IN TLC-VARI.
           IF LDC-COD-TIPO IN LDC-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-LDC-COD-TIPO.
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-COD-TIPO IN LDC-FLD NOT > SPACES
               GO TO FIN-VAL-LDC-COD-TIPO
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO LDC-GLS-DESC IN LDC-FLD
               MOVE TAB-GLS-DCOR IN TAB TO LDC-GLS-DCOR IN LDC-FLD
      *FLB CST  24-NOV-1994
               MOVE TAB-CIC-CTAB IN TAB TO TLC-CIC-LDIS IN TLC-VARI.

      *DPR CST  20-FEB-1995 LINEA DE AVANCE Y VEN LDC > VEN CLF
      * GUARDA PARAMETROS
               MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA.
      *AFRI-INI-SEP-2005
           MOVE SPACES  TO WSS-CIC-IFGL.
           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF TAB-CIC-CTAB IN TAB NOT = 'FGL'
      *AFRI-INI/CHC/MAY-2009/CANAL DE VENTAS
              MOVE 'DEU'                    TO TAB-COD-SIST FIO-SIST
              MOVE 'TLL'                    TO TAB-COD-TTAB IN TAB
              MOVE TLC-CIC-LDIS IN TLC-VARI TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
      *       IF TLC-CIC-LDIS IN TLC-VARI = 'LEC' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LEL' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LCF'
      *AFRI-FIN/CHC/MAY-2009/CANAL DE VENTAS
                  MOVE 'DEU' TO MSG-COD-SIST
                  MOVE 'TIPONOAUTO' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-LDC-COD-TIPO.
           IF TAB-CIC-CTAB IN TAB = 'FGL'
              MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-IFGL
      *AFRI-INI/CHC/MAY-2009/CANAL DE VENTAS
              MOVE 'DEU'                    TO TAB-COD-SIST FIO-SIST
              MOVE 'TLL'                    TO TAB-COD-TTAB IN TAB
              MOVE TLC-CIC-LDIS IN TLC-VARI TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM GNS-FIO-TAB
              IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
      *       IF NOT ( TLC-CIC-LDIS IN TLC-VARI = 'LEC' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LEL' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LCF' )
      *AFRI-FIN/CHC/MAY-2009/CANAL DE VENTAS
                  MOVE 'DEU' TO MSG-COD-SIST
                  MOVE 'TIPONOAUTO' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-LDC-COD-TIPO
              ELSE
      *AFRI-INI/CHC/MAY-2009/CANAL DE VENTAS
      *       IF TLC-CIC-LDIS IN TLC-VARI = 'LEC' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LEL' OR
      *          TLC-CIC-LDIS IN TLC-VARI = 'LCF'
      *           MOVE 'DEU'                 TO TAB-COD-SIST FIO-SIST
      *           MOVE 'TLL'                 TO TAB-COD-TTAB IN TAB
      *           MOVE LDC-COD-TIPO  IN LDC-FLD  TO TAB-COD-CTAB IN TAB
      *           MOVE FIO-GET-KEY TO FIO-CMND
      *           PERFORM GNS-FIO-TAB
      *           IF NOT ( FIO-STAT-OKS AND
      *              TAB-IND-VIGE IN TAB = 'S' )
      *               MOVE 'DEU' TO MSG-COD-SIST
      *               MOVE 'TLL    NEX' TO MSG-COD-MENS
      *               PERFORM GET-MSG
      *               MOVE MSG-GLS-DESC TO FRM-MENS
      *               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *               GO TO FIN-VAL-LDC-COD-TIPO
      *           ELSE
      *AFRI-FIN/CHC/MAY-2009/CANAL DE VENTAS
                    MOVE TAB-GLS-DATA IN TAB TO WSS-VEC-DATA
                    PERFORM RET-DBC-LDC
             IF NOT (DBC-NUM-ICLI IN DBC = WSS-DBC-NUM-ICLI(1) AND
                DBC-VRF-ICLI IN DBC = WSS-DBC-VRF-ICLI(1) AND
                DBC-IND-ICLI IN DBC = WSS-DBC-IND-ICLI(1) AND
                DBC-GLS-ICLI IN DBC = WSS-DBC-GLS-ICLI(1))
             IF NOT(DBC-NUM-ICLI IN DBC = WSS-DBC-NUM-ICLI(2) AND
              DBC-VRF-ICLI IN DBC = WSS-DBC-VRF-ICLI(2) AND
              DBC-IND-ICLI IN DBC = WSS-DBC-IND-ICLI(2) AND
              DBC-GLS-ICLI IN DBC = WSS-DBC-GLS-ICLI(2))
           IF NOT (DBC-NUM-ICLI IN DBC = WSS-DBC-NUM-ICLI(3) AND
              DBC-VRF-ICLI IN DBC = WSS-DBC-VRF-ICLI(3) AND
              DBC-IND-ICLI IN DBC = WSS-DBC-IND-ICLI(3) AND
              DBC-GLS-ICLI IN DBC = WSS-DBC-GLS-ICLI(3))
           IF NOT (DBC-NUM-ICLI IN DBC = WSS-DBC-NUM-ICLI(4) AND
              DBC-VRF-ICLI IN DBC = WSS-DBC-VRF-ICLI(4) AND
              DBC-IND-ICLI IN DBC = WSS-DBC-IND-ICLI(4) AND
              DBC-GLS-ICLI IN DBC = WSS-DBC-GLS-ICLI(4))
               MOVE 'DEU'           TO MSG-COD-SIST
               MOVE 'CLI    NOAUTO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-COD-TIPO.
      *AFRI-INI-SEP-2005

      *RRM-INI abril-2018 / control LDC duplicadas
      *    IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *        GO TO FIN-VAL-LDC-COD-TIPO.
      *RRM-FIN abril-2018 / control LDC duplicadas

      * HAYA SOLA 1 'MLT'
           PERFORM VAL-1-LAV.
           IF MSG-COD-MENS > SPACES
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-COD-TIPO.
      *DPR CST  20-FEB-1995 FIN
           GO TO FIN-VAL-LDC-COD-TIPO.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-LDC-COD-TIPO.
           EXIT.
       
       VAL-LDC-GLS-DESC SECTION.
       INI-VAL-LDC-GLS-DESC.
           IF LDC-GLS-DESC IN LDC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-GLS-DESC.
       FIN-VAL-LDC-GLS-DESC.
           EXIT.
       
       VAL-LDC-GLS-DCOR SECTION.
       INI-VAL-LDC-GLS-DCOR.
           IF LDC-GLS-DCOR IN LDC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-GLS-DCOR.
       FIN-VAL-LDC-GLS-DCOR.
           EXIT.
       
       VAL-LDC-COD-FAMI SECTION.
       INI-VAL-LDC-COD-FAMI.
       FIN-VAL-LDC-COD-FAMI.
           EXIT.
       
       VAL-FRM-GLS-FAMI SECTION.
       INI-VAL-FRM-GLS-FAMI.
       FIN-VAL-FRM-GLS-FAMI.
           EXIT.
       
       VAL-FRM-IND-MARC SECTION.
       INI-VAL-FRM-IND-MARC.
           IF FRM-IND-MARC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-MARC IN LDC-FLD.
      *<<<< FRM_IND_MARC
      *FLB CST  25-NOV-1994
           IF FRM-IND-MARC IN LDC-FLD NOT > SPACES OR
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE'
               MOVE 'N' TO FRM-IND-MARC IN LDC-FLD
               GO TO FIN-VAL-FRM-IND-MARC.

           IF FRM-IND-MARC IN LDC-FLD = 'S'
               MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD
               MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD
               MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD
               MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD
               MOVE ZEROES TO ARC-IIC-IOPC IN LDC-FLD
               GO TO FIN-VAL-FRM-IND-MARC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-IND-MARC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-FRM-IND-MARC.
           EXIT.
       
       VAL-LDC-VAL-CMAX SECTION.
       INI-VAL-LDC-VAL-CMAX.
      *<<<<
      *AFRI-INI-SEP2005
           IF WSS-CIC-IFGL = 'FGL'
               MOVE ZEROES TO LDC-VAL-CMAX IN  LDC-FLD
                GO TO FIN-VAL-LDC-VAL-CMAX.
      *AFRI-INI-SEP2005
      *>>>>
           IF LDC-VAL-CMAX IN LDC-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-LDC-VAL-CMAX.
      *<<<< LDC_VAL_CMAX

      *AMP-INI  22-OCT-1993
      *VAL-COD BUSCA CIC DE TIO DE CLF PARA CASO DE GRUPOS
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE CLF-COD-TOCF IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           MOVE TAB TO TIO.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOCF.
      *AMP-FIN  22-OCT-1993
           IF WSS-CIC-TOCF = 'CGE'
               IF LDC-VAL-CMAX IN LDC-FLD NOT =
                  CLF-VAL-CMAX IN CMA-VARI
                   MOVE 'DEU'          TO MSG-COD-SIST
                   MOVE 'CMAXLDC<>CLF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LDC-VAL-CMAX
               ELSE
                   NEXT SENTENCE
           ELSE
      *FLB CST  23-FEB-1995
           IF NOT PERMITE-MON-LDC-DIF-A-MON-CLF AND
              LDC-VAL-CMAX IN LDC-FLD > CLF-VAL-CMAX IN CMA-VARI
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'MONTOLDC>CLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-VAL-CMAX.
      *>>>>
       FIN-VAL-LDC-VAL-CMAX.
           EXIT.
       
       VAL-ARC-COD-VCOC SECTION.
       INI-VAL-ARC-COD-VCOC.
           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-VCOC IN LDC-FLD.
      *<<<< ARC_COD_VCOC
      *<<<< PGM_CHI
      *>>>>

           IF ARC-COD-VCOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-VCOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-VCOC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-VCOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCOC IN LDC-FLD.
       FIN-VAL-ARC-COD-VCOC.
           EXIT.
       
       VAL-LDC-COD-VCLC SECTION.
       INI-VAL-LDC-COD-VCLC.
      *<<<<
      *AFRI-INI-SEP2005
           IF WSS-CIC-IFGL = 'FGL'
               MOVE SPACES TO LDC-COD-VCLC IN  LDC-FLD
               GO TO FIN-VAL-LDC-COD-VCLC.
      *AFRI-INI-SEP2005
      *>>>>
           IF LDC-COD-VCLC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-COD-VCLC IN LDC-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-VCLC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-COD-VCLC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCLC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCLC IN LDC-FLD.
      *<<<< FIN_LDC_COD_VCLC
      *<<<< PGM_CHI
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-LDC-COD-VCLC.
      *>>>>

      *FLB CST  23-FEB-1995 MLT Y MON LDC DIFERENTE A MON CLF
           MOVE LDC-COD-VCLC IN LDC-FLD  TO LDC-COD-VCLC IN LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD  TO LDC-VAL-CMAX IN LDC.
           MOVE CLF-COD-VCCF IN LDC-FLD  TO CLF-COD-VCCF IN CLF.
           MOVE CLF-VAL-CMAX IN CMA-VARI TO CLF-VAL-CMAX IN CLF
           PERFORM VAL-MON-LDC-CLF.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               IF MSG-COD-MENS = 'MONTOLDC<PRM' OR 'MONTOLDC>CLF'
                   MOVE -1 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                   MOVE 'S' TO FRM-UCUR
                   GO TO FIN-VAL-LDC-COD-VCLC
               ELSE
                   GO TO FIN-VAL-LDC-COD-VCLC.
       YA-VALIDO-MONTO-LDC-VS-CLF.
      *>>>>
       FIN-VAL-LDC-COD-VCLC.
           EXIT.
       
       VAL-FRM-GLS-VCOC SECTION.
       INI-VAL-FRM-GLS-VCOC.
       FIN-VAL-FRM-GLS-VCOC.
           EXIT.
       
       VAL-FRM-GLS-PVIG SECTION.
       INI-VAL-FRM-GLS-PVIG.
       FIN-VAL-FRM-GLS-PVIG.
           EXIT.
       
       VAL-FRM-GLS-VCLC SECTION.
       INI-VAL-FRM-GLS-VCLC.
       FIN-VAL-FRM-GLS-VCLC.
           EXIT.
       
       VAL-ARC-COD-TOOC SECTION.
       INI-VAL-ARC-COD-TOOC.
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-TOOC IN LDC-FLD.
      *<<<< ARC_COD_TOOC
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
      *FLB CST  26-OCT-1993
               MOVE SPACES TO WSS-CIC-TOOC
               GO TO FIN-VAL-ARC-COD-TOOC.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOOC IN LDC-FLD.
      *<<<< FIN_ARC_COD_TOOC
      *FLB CST  10-JUN-1994
           IF MSG-COD-MENS > SPACES OR
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-TOOC.
      *FLB CST  10-JUN-1994

           MOVE TAB TO TIO.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TOOC.
           IF ( TAB-CIC-CTAB IN TAB = 'CGE' )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CODTIOINVL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.

      *FLB CST  9-MAR-1995
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SIS' TO TAB-COD-TTAB IN TAB.
           MOVE TIO-GLS-SIST IN TIO TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'CODSISNEX'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.
           MOVE TAB-GLS-DATA TO WSS-SIS-DATA.
      *FLB CST  9-MAR-1995 FIN

           IF NOT (  ( USA-CEX AND TIO-GLS-SIST IN TIO = 'CEX' )
                  OR ( USA-CTE AND TIO-GLS-SIST IN TIO = 'CTE' )
                  OR ( USA-LEA AND TIO-GLS-SIST IN TIO = 'LEA' )
                  OR ( USA-TCR AND TIO-GLS-SIST IN TIO = 'TCR' )
                  OR ( TIO-GLS-SIST IN TIO = 'COL' )
      *FLB CST  9-MAR-1995
                  OR ( TAB-CIC-CTAB IN TAB = 'CCC' )
                  OR ( TIO-DE-DEUDA ) )
      *FLB CST  9-MAR-1995 FIN
      *SMC-FIN 26-10-1993
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-COD-TOOC.
      *>>>>
       FIN-VAL-ARC-COD-TOOC.
           EXIT.
       
       VAL-ARC-COD-AOOC SECTION.
       INI-VAL-ARC-COD-AOOC.
           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-COD-AOOC IN LDC-FLD.
      *<<<< ARC_COD_AOOC
           IF ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-AOOC.

      *FLB CST  7-OCT-1994
      * VALIDA C. AUX CONTRA COL/AUX, CUANDO TIPO DE OPERACION SEA
      * DE 'COL' ( TIO-GLS-SIST = 'COL') SI NO CONTRA TAB/AUX.

      *VAL-COD Valida codigo de tabla
           IF TIO-GLS-SIST IN TIO = 'COL'
               MOVE 'COL' TO TAB-COD-SIST
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST.

           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARC-COD-TOOC IN LDC-FLD TO
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARC-COD-AOOC IN LDC-FLD TO
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARC-COD-AOOC IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOOC IN LDC-FLD
               GO TO FIN-VAL-ARC-COD-AOOC
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOOC IN LDC-FLD.
      *>>>>
       FIN-VAL-ARC-COD-AOOC.
           EXIT.
       
       VAL-FRM-GLS-TOOC SECTION.
       INI-VAL-FRM-GLS-TOOC.
       FIN-VAL-FRM-GLS-TOOC.
           EXIT.
       
       VAL-FRM-GLS-AOOC SECTION.
       INI-VAL-FRM-GLS-AOOC.
       FIN-VAL-FRM-GLS-AOOC.
           EXIT.
       
       VAL-LDC-IND-MGAR SECTION.
       INI-VAL-LDC-IND-MGAR.
      *<<<<
      *INI-AFRI/SEP-2005
           IF WSS-CIC-IFGL = 'FGL'
              IF LDC-IND-MGAR IN LDC-FLD NOT > SPACES
                 MOVE 'S' TO LDC-IND-MGAR IN LDC-FLD
                 GO TO FIN-VAL-LDC-IND-MGAR.
      *AFRI-FIN/SEP2005
      *>>>>
           IF LDC-IND-MGAR IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-MGAR IN LDC-FLD.
      *<<<< LDC_IND_MGAR
      *LTM CST 30-09-93
           IF WSS-CIC-TOCF = 'CGE' AND
              LDC-IND-MGAR IN LDC-FLD NOT = 'S'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    EQCGE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-IND-MGAR.
      *LTM CST 30-09-93

      *FLB CST  14-OCT-1993 CORRIGE PUNTO A DE PANTALLA LDC (YNP)
           IF LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S'
               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-NUM-PORG IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               GO TO FIN-VAL-LDC-IND-MGAR
           ELSE
           IF LDC-IND-MGAR IN LDC-FLD = 'U'
               MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD
               MOVE ZEROES TO ARG-IIC-IGAR IN LDC-FLD
               GO TO FIN-VAL-LDC-IND-MGAR.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'CGA ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-IND-MGAR IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-LDC-IND-MGAR.
           EXIT.
       
       VAL-ARC-CAI-IOPC SECTION.
       INI-VAL-ARC-CAI-IOPC.
           IF ARC-CAI-IOPC IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARC-CAI-IOPC IN LDC-FLD.
      *<<<< ARC_CAI_IOPC
      *FLB CST  6-OCT-1994 PARA CTA CTE PUEDE ESTAR LLENA LA CLAVE
           IF WSS-CIC-TOOC = 'CTE' AND USA-CTE
               GO TO FIN-VAL-ARC-CAI-IOPC.

      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ( ARC-COD-VCOC IN LDC-FLD > SPACES OR
                ARC-COD-TOOC IN LDC-FLD > SPACES
              )
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'IICIOPC>0'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-CAI-IOPC.

      *FLB CST  26-OCT-1993
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              WSS-VSN-OCAI = 'S'
               MOVE ARC-CAI-IOPC IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               IF NOT ( CIC-COD-TCIC IN CIC = 'C' OR
                        CIC-COD-TCIC IN CIC = 'D' )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-CAI-IOPC
               ELSE
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM GNS-FIO-CIC
                   IF NOT FIO-STAT-OKS
                       MOVE 'GNS' TO MSG-COD-SIST
                       MOVE 'CICSTAT' TO MSG-COD-TMSG
                       MOVE CIC-STAT-NEX TO MSG-COD-CMSG
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FRM-SUAR-MAL TO FRM-SUAR
                       GO TO FIN-VAL-ARC-CAI-IOPC.
      *>>>>
       FIN-VAL-ARC-CAI-IOPC.
           EXIT.
       
       VAL-ARC-IIC-IOPC SECTION.
       INI-VAL-ARC-IIC-IOPC.
      *<<<< ARC_IIC_IOPC
      *FLB CST  6-OCT-1994 MODIFICADO
           IF FRM-IND-MARC IN LDC-FLD = 'S' OR
              NOT (
              ARC-COD-VCOC IN LDC-FLD > SPACES OR
              ARC-COD-TOOC IN LDC-FLD > SPACES OR
              ARC-COD-AOOC IN LDC-FLD > SPACES OR
              ARC-CAI-IOPC IN LDC-FLD > SPACES OR
              ARC-IIC-IOPC IN LDC-FLD > ZEROES
                  )
               GO TO FIN-VAL-ARC-IIC-IOPC.

           PERFORM VAL-CON-ARC.
      *FLB 11/NOV/92
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-ARC-IIC-IOPC.

      *FLB 11/NOV/92
      * ASIGNA NRO CREDITO
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES
      *FLB CST  6-OCT-1994
                  AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE
              )
      *FLB CST  6-OCT-1994
               MOVE ARC-CAI-IOPC IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               PERFORM PRO-CIC-OPC
               MOVE 'A' TO CMA-IND-IOPC IN CMA-VARI
               MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC
                                                      IN CMA-VARI
               MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC
                                                      IN CMA-VARI
               GO TO FIN-VAL-ARC-IIC-IOPC.

      *FLB 11/NOV/92
      * DIGITA NRO CREDITO O CAMBIO EL NUMERO ASIGNADO
           IF CMA-IND-IOPC IN CMA-VARI NOT = 'A' AND
              ARC-IIC-IOPC IN LDC-FLD > ZEROES OR
              ( ARC-CAI-IOPC IN LDC-FLD NOT = ARC-CAI-IOPC IN CMA-VARI
                     OR
                ARC-IIC-IOPC IN LDC-FLD NOT = ARC-IIC-IOPC IN CMA-VARI
              )
               MOVE 'D' TO CMA-IND-IOPC IN CMA-VARI
               MOVE ARC-CAI-IOPC IN LDC-FLD TO ARC-CAI-IOPC
                                                      IN CMA-VARI
               MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC
                                                      IN CMA-VARI.

      *FLB 11/NOV/92
      * VALIDA QUE NRO CREDITO DIGITADO (NO PARA ASIGNADO) EXISTA Y ESTE
      * VIGENTE
      *FLB CST  26-OCT-1993 SIEMPRE QUE NO SEA CTE
           IF CMA-IND-IOPC IN CMA-VARI = 'D' AND
              ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR NOT USA-CTE )
               MOVE ARC-CAI-IOPC IN LDC-FLD TO OPC-CAI-IOPC IN OPC
               MOVE ARC-IIC-IOPC IN LDC-FLD TO OPC-IIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-IIC-IOPC
               ELSE
               IF OPC-VAL-SCRE IN OPC NOT > ZEROES
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'OPC    YACAN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARC-IIC-IOPC
               ELSE
                   GO TO FIN-VAL-ARC-IIC-IOPC.

      *AMP-INI  9-OCT-1993
      * VALIDA LA CTA-CTE
      *FLB CST  6-OCT-1994
      *    IF ( ARC-IIC-IOPC IN LDC-FLD > SPACES AND
           IF ( ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
      *SMC-INI 26-10-1993
                WSS-CIC-TOOC = 'CTE' AND USA-CTE )
      *SMC-FIN 26-10-1993
               PERFORM BUSCO-CTA-CTE
               IF WSS-CTA-CTE > ZEROES
                   IF NOT ( RCO-COD-TOPR IN RCO =
                            ARC-COD-TOOC IN LDC-FLD AND
                            RCO-COD-AOPR IN RCO =
                            ARC-COD-AOOC IN LDC-FLD )
                       MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                   ELSE
                       MOVE 'TAB' TO TAB-COD-SIST
                       MOVE 'TIO' TO TAB-COD-TTAB IN TAB
                       MOVE RCO-COD-TOPR IN RCO TO
                            TAB-COD-CTAB IN TAB
                       PERFORM BUS-TAB
                       MOVE TAB TO TIO
                       IF TIO-GLS-SIST IN TIO NOT = 'CTE'
                           MOVE 'CICTIOPNOSIS' TO MSG-COD-MENS
                       ELSE
                           PERFORM VAL-CTA-CTE
                           IF CTE-STAT-OKS
                               IF ( ARC-COD-VCOC IN LDC-FLD NOT =
                                     OPE-COD-VCOP IN OPE )
                                   MOVE 'TIORCO<>ARC' TO MSG-COD-MENS
                               ELSE
                                   NEXT SENTENCE
                           ELSE
                               IF MSG-COD-MENS > SPACES
                                   NEXT SENTENCE
                               ELSE
                                   MOVE 'IFBCPFAIL' TO MSG-COD-MENS
               ELSE
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
           ELSE
               NEXT SENTENCE.

           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'         TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARC-IIC-IOPC.
      *AMP-FIN  9-OCT-1993
      *>>>>
       FIN-VAL-ARC-IIC-IOPC.
           EXIT.
       
       VAL-ARG-COD-TOGA SECTION.
       INI-VAL-ARG-COD-TOGA.
           IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD.
      *<<<< ARG_COD_TOGA
      *FLB CST  25-AGO-1994
           IF LDC-IND-MGAR IN LDC-FLD = 'U' AND
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
               MOVE 'DEU'                TO FIO-SIST
               MOVE 'VSN '               TO TAB-COD-TTAB IN TAB
               MOVE 'NOARGUSINTIO  '     TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT ( FIO-STAT-OKS AND
                        TAB-IND-VIGE IN TAB = 'S' )

      * VE SI ES ERROR O NO QUE 'U' NO TENGA TIPO GTIA
                   MOVE 'DEU'          TO MSG-COD-SIST
                   MOVE 'ARGUSINTIO'   TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-COD-TOGA.
      *FLB CST  25-AGO-1994

      *FLB CST  22-JUN-1994
           IF ARG-COD-TOGA IN LDC-FLD NOT > SPACES OR
              ARG-COD-TOGA IN LDC-FLD = 'AVL'      OR
              ARG-COD-TOGA IN LDC-FLD = 'FIA'      OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-TOGA.

           IF LDC-IND-MGAR IN LDC-FLD = 'E' AND
              ARG-COD-TOGA IN LDC-FLD NOT = 'AVL' AND
              ARG-COD-TOGA IN LDC-FLD NOT = 'FIA'
               MOVE SPACES TO ARG-COD-TOGA IN LDC-FLD
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-TOGA.

      *FLB CST  22-JUN-1994 FIN
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE ARG-COD-TOGA IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOGA IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOGA IN LDC-FLD.
      *<<<< FIN_ARC_COD_TOGA

           MOVE TAB TO TIO.
           IF NOT ( TIO-GLS-SIST IN TIO = 'BGL' )
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-TOGA.

      *FLB CST  10-MAY-1994
      *CGL-INI
      *    MOVE ARG-COD-TOGA IN LDC-FLD TO GAR-TIP-OPE IN TAG.
      *    MOVE SPACES                  TO GAR-STP-OPE IN TAG.
           MOVE ARG-COD-TOGA IN LDC-FLD TO TAG-COD-TOPE IN TAG.
           MOVE SPACES                  TO TAG-COD-SOPE IN TAG.
      *CGL-FIN
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT ( FIO-STAT-OKS AND
      *CGL-INI
      *             GAR-TIP-OPE IN TAG = ARG-COD-TOGA IN LDC-FLD )
                   TAG-COD-TOPE IN TAG = ARG-COD-TOGA IN LDC-FLD )
      *CGL-FIN
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-TOGA.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM BGL-FIO-TAG.

      *FLB CST  10-MAY-1994 FIN
      *>>>>
       FIN-VAL-ARG-COD-TOGA.
           EXIT.
       
       VAL-ARG-COD-AOGA SECTION.
       INI-VAL-ARG-COD-AOGA.
           IF ARG-COD-AOGA IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD.
      *<<<< ARG_COD_AOGA
           IF ARG-COD-AOGA IN LDC-FLD NOT > SPACES
                OR
              ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB CST  22-JUN-1994
           IF LDC-IND-MGAR IN LDC-FLD = 'E'
               MOVE SPACES TO ARG-COD-AOGA IN LDC-FLD
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB CST  10-MAY-1994 TRASLADADO AQUI Y CORREGIDO
           IF ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL' OR 'FIA' )
                    AND
              ARG-COD-AOGA IN LDC-FLD > SPACES
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'AOGA>BLK'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-AOGA.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE ARG-COD-TOGA IN LDC-FLD TO
                                    WSS-COD-TOPE IN WSS-VARI.
           MOVE ARG-COD-AOGA IN LDC-FLD TO
                                    WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              ARG-COD-AOGA IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOGA IN LDC-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOGA IN LDC-FLD.

      *FLB CST  10-MAY-1994
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-ARG-COD-AOGA.

      *FLB-INI  28-OCT-1993 TRALADADO AQUI
      *CGL-INI
      *    MOVE ARG-COD-TOGA IN LDC-FLD TO GAR-TIP-OPE IN TAG.
      *    MOVE ARG-COD-AOGA IN LDC-FLD TO GAR-STP-OPE IN TAG.
           MOVE ARG-COD-TOGA IN LDC-FLD TO TAG-COD-TOPE IN TAG.
           MOVE ARG-COD-AOGA IN LDC-FLD TO TAG-COD-SOPE IN TAG.
      *CGL-FIN
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM BGL-FIO-TAG.
           IF NOT FIO-STAT-OKS
               MOVE 'BGL'        TO MSG-COD-SIST
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-COD-AOGA.
      *>>>>
       FIN-VAL-ARG-COD-AOGA.
           EXIT.
       
       VAL-FRM-GLS-TOGA SECTION.
       INI-VAL-FRM-GLS-TOGA.
       FIN-VAL-FRM-GLS-TOGA.
           EXIT.
       
       VAL-FRM-GLS-AOGA SECTION.
       INI-VAL-FRM-GLS-AOGA.
       FIN-VAL-FRM-GLS-AOGA.
           EXIT.
       
       VAL-ARG-NUM-PORG SECTION.
       INI-VAL-ARG-NUM-PORG.
      *<<<< ARG_NUM_PORG
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               GO TO FIN-VAL-ARG-NUM-PORG.

           IF ARG-COD-TOGA IN LDC-FLD = 'AVL'
               MOVE 100 TO ARG-NUM-PORG IN LDC-FLD
               GO TO FIN-VAL-ARG-NUM-PORG.

           IF ARG-NUM-PORG IN LDC-FLD = ZEROES
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'PORGOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-NUM-PORG.
      *>>>>
       FIN-VAL-ARG-NUM-PORG.
           EXIT.
       
       VAL-ARG-CAI-IGAR SECTION.
       INI-VAL-ARG-CAI-IGAR.
           IF ARG-CAI-IGAR IN LDC-FLD NOT > SPACES
              MOVE SPACES TO ARG-CAI-IGAR IN LDC-FLD.
      *<<<< ARG_CAI_IGAR
      *FLB CST  22-JUN-1994 SEGUN LTM BCP 25-05-1994 Y
      *  MODIFICADO PARA EL CASO QUE NO SE OTORGUEN CIC X SUC
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' OR 'U' )
               GO TO FIN-VAL-ARG-CAI-IGAR.

      *FLB CST  10-MAY-1994 TRASLADADO AQUI Y CORREGIDA LA FORMA DE
      *  PREGUNTAR POR LA INCONSISTENCIA
           IF ARG-CAI-IGAR IN LDC-FLD > SPACES AND
              ( LDC-IND-MGAR IN LDC-FLD NOT = 'E' OR
              NOT ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL'
                                                     OR 'FIA' ) OR
              ARG-COD-AOGA IN LDC-FLD > SPACES
              )
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAI>SPACES' TO MSG-COD-TMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-CAI-IGAR.

      *FLB CST  6-OCT-1994 NO LEER CICXSUC 2 VECES
           IF WSS-VSN-OCAI = 'S' AND
              ARG-CAI-IGAR IN LDC-FLD NOT > SPACES
               MOVE LDC-CAI-ICLF IN LDC-FLD TO CLF-CAI-ICLF IN CLF
               MOVE LDC-IIC-ICLF IN LDC-FLD TO CLF-IIC-ICLF IN CLF
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE CLF-COD-OFIC IN CLF TO CIC-COD-CCIC IN CIC
               IF ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA'
      *<<<< PGM_CHI AND PGM_BCI
                   MOVE '0600'       TO CIC-CAI-ICIC IN CIC
      *>>>>
               ELSE
      *<<<< PGM_CHI AND PGM_BCI
                   MOVE '0500'       TO CIC-CAI-ICIC IN CIC
      *>>>>
           ELSE
               MOVE ARG-CAI-IGAR IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' AND
                  ( ( ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA' ) AND
      *<<<< PGM_CHI AND PGM_BCI
                    CIC-CAI-ICIC IN CIC NOT = '0600'
      *>>>>
                          OR
                    NOT
                    ( ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA' ) AND
      *<<<< PGM_CHI AND PGM_BCI
                    CIC-CAI-ICIC IN CIC NOT = '0500'
      *>>>>
                  )
                   MOVE 'TAB'    TO MSG-COD-SIST
                   MOVE 'CAIINV' TO MSG-COD-TMSG
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-CAI-IGAR
               ELSE
               IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
      * NO HAY QUE VALIDAR EL CAI
                   GO TO FIN-VAL-ARG-CAI-IGAR.

           MOVE CIC-CAI-ICIC IN CIC TO ARG-CAI-IGAR IN LDC-FLD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CICSTAT' TO MSG-COD-TMSG
               MOVE CIC-STAT-NEX TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-CAI-IGAR.
      *>>>>
       FIN-VAL-ARG-CAI-IGAR.
           EXIT.
       
       VAL-ARG-IIC-IGAR SECTION.
       INI-VAL-ARG-IIC-IGAR.
      *<<<< ARG_IIC_IGAR
      *FLB CST  10-MAY-1994
           IF ( LDC-IND-MGAR IN LDC-FLD = 'Y' OR 'O' OR 'S' )
               GO TO FIN-VAL-ARG-IIC-IGAR.

           IF ARG-IIC-IGAR IN LDC-FLD > ZEROES AND
              ( LDC-IND-MGAR IN LDC-FLD NOT = 'E' OR
              NOT ( ARG-COD-TOGA IN LDC-FLD = SPACES OR 'AVL'
                                                     OR 'FIA' ) OR
              ARG-COD-AOGA IN LDC-FLD > SPACES
              )
               MOVE 'IICIGAR>0' TO MSG-COD-MENS
               MOVE 'DEU'       TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  10-MAY-1994 CASO 'U'
           IF LDC-IND-MGAR IN LDC-FLD NOT = 'E'
               GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  23/JUN/94 CORREGIDO HASTA FIN SECCION
           IF SCR-CCPP NOT = 'ING' AND ARG-IIC-IGAR IN LDC-FLD = ZEROES
               PERFORM ERR-GLS
               GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  23/JUN/94 ASIGNA NRO GARANTIA O FIANZA
           IF ARG-IIC-IGAR IN LDC-FLD = ZEROES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO CIC-CAI-ICIC IN CIC
               MOVE 'A' TO CMA-IND-IGAR IN CMA-VARI
               IF ARG-COD-TOGA IN LDC-FLD = 'AVL' OR 'FIA'
                   PERFORM PRO-CIC-FIA
                   MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR
                                                      IN CMA-VARI
                   MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR
                                                      IN CMA-VARI
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   PERFORM PRO-CIC-GDG
                   MOVE ARG-CAI-IGAR IN LDC-FLD TO ARG-CAI-IGAR
                                                      IN CMA-VARI
                   MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR
                                                      IN CMA-VARI
                   GO TO FIN-VAL-ARG-IIC-IGAR.

      *FLB CST  23/JUN/94 CORREGIDO Y DEJADO SIMILAR A IOPC
      * DIGITA NRO GARANTIA O CAMBIO EL NUMERO ASIGNADO
           IF CMA-IND-IGAR IN CMA-VARI NOT = 'A' AND
              ARG-IIC-IGAR IN LDC-FLD > ZEROES OR
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI
                     OR
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              )
               MOVE 'D' TO CMA-IND-IGAR IN CMA-VARI
               MOVE SPACES TO ARG-CAI-IGAR IN CMA-VARI
               MOVE ZEROES TO ARG-IIC-IGAR IN CMA-VARI.

      * VALIDA QUE NRO GARANTIA DIGITADO (NO PARA ASIGNADO) EXISTA
           IF ( CMA-IND-IGAR IN CMA-VARI = 'D' OR
              ( SCR-CCPP NOT = 'ING' OR
                SCR-CCPP = 'ING' AND
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI
                     OR
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              )
              )
              ) AND
              ARG-COD-TOGA IN LDC-FLD NOT > SPACES
      *CGL-INI
      *        MOVE ARG-CAI-IGAR IN LDC-FLD TO GAR-NUM-SIS IN GDG
      *        MOVE ARG-IIC-IGAR IN LDC-FLD TO GAR-COD-CRR IN GDG
               MOVE ARG-CAI-IGAR IN LDC-FLD TO GDG-CAI-GTIA IN GDG
               MOVE ARG-IIC-IGAR IN LDC-FLD TO GDG-IIC-GTIA IN GDG
      *CGL-FIN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM BGL-FIO-GDG
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'GDG    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-ARG-IIC-IGAR.

           IF ( CMA-IND-IGAR IN CMA-VARI = 'D' OR
              ( SCR-CCPP NOT = 'ING' OR
                SCR-CCPP = 'ING' AND
              ( ARG-CAI-IGAR IN LDC-FLD NOT = ARG-CAI-IGAR IN CMA-VARI
                     OR
                ARG-IIC-IGAR IN LDC-FLD NOT = ARG-IIC-IGAR IN CMA-VARI
              )
              )
              ) AND
              ARG-COD-TOGA IN LDC-FLD > SPACES
               MOVE ARG-CAI-IGAR IN LDC-FLD TO FIA-CAI-IESC IN FIA
               MOVE ARG-IIC-IGAR IN LDC-FLD TO FIA-IIC-IESC IN FIA
               MOVE 1                       TO FIA-NUM-IFIA IN FIA
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DEU-FIO-FIA
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'FIA    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-ARG-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-ARG-IIC-IGAR.
      *>>>>
       FIN-VAL-ARG-IIC-IGAR.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LDC-FEC-FINI SECTION.
       INI-VAL-LDC-FEC-FINI.
           IF LDC-FEC-FINI IN LDC-FLD  NOT > ZEROES
              MOVE ZEROES TO LDC-FEC-FINI IN LDC-FLD.
      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LDC_FEC_FINI
      * MHM ini 19-OCT-1995
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *         MOVE ZEROES TO LDC-FEC-FINI IN LDC-FLD
      *         GO TO FIN-VAL-LDC-FEC-FINI.
      *     MOVE FEC-FBLK-N TO FEC-FBLK.
      * MHM fin 19-OCT-1995
           IF LDC-FEC-FINI IN LDC-FLD NOT > ZEROES
      *AFRI-INI-SEP2005
              IF WSS-CIC-IFGL = 'FGL'
                  MOVE CLF-NUM-DAPE IN CMA-VARI TO
                           LDC-NUM-DINI IN LDC-FLD
                  MOVE CLF-NUM-MAPE IN CMA-VARI TO
                           LDC-NUM-MINI IN LDC-FLD
                  MOVE CLF-NUM-SAPE IN CMA-VARI TO
                           LDC-NUM-SINI IN LDC-FLD
                  MOVE CLF-NUM-AAPE IN CMA-VARI TO
                           LDC-NUM-AINI IN LDC-FLD
                  MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH
              ELSE
      *AFRI-INI-SEP2005
              PERFORM GET-FHOY
              MOVE HOY-DHOY TO LDC-NUM-DINI IN LDC-FLD
              MOVE HOY-MHOY TO LDC-NUM-MINI IN LDC-FLD
              MOVE HOY-SHOY TO LDC-NUM-SINI IN LDC-FLD
              MOVE HOY-AHOY TO LDC-NUM-AINI IN LDC-FLD
              MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FINI IN LDC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FINI.
      *<<<< FIN_LDC_FEC_FINI
           PERFORM GET-FHOY.
           MOVE LDC-NUM-DINI IN LDC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE LDC-NUM-MINI IN LDC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE LDC-NUM-SINI IN LDC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE LDC-NUM-AINI IN LDC-FLD TO WSS-NUM-AINI IN WSS-VARI.

           MOVE CLF-NUM-DAPE IN CMA-VARI TO WSS-NUM-DAPE IN WSS-VARI.
           MOVE CLF-NUM-MAPE IN CMA-VARI TO WSS-NUM-MAPE IN WSS-VARI.
           MOVE CLF-NUM-SAPE IN CMA-VARI TO WSS-NUM-SAPE IN WSS-VARI.
           MOVE CLF-NUM-AAPE IN CMA-VARI TO WSS-NUM-AAPE IN WSS-VARI.

           IF WSS-FEC-FINI IN WSS-VARI > HOY-FHOY
              MOVE 'LDC'          TO MSG-COD-SIST
              MOVE 'FINI > FHOY ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-LDC-FEC-FINI.
           IF WSS-FEC-FINI IN WSS-VARI < WSS-FEC-FAPE IN WSS-VARI
              MOVE 'LDC'          TO MSG-COD-SIST
              MOVE 'FINI < FAPE ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-LDC-FEC-FINI.
           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO CON-VAL-LDC-FEC-FINI.
      * OBTIENE MAXIMO VENCIMIENTO DE MLT
           MOVE LDC-FEC-FINI IN LDC-FLD TO FEC-FECH.
           IF WSS-COD-PLAV = 'D'
               MOVE FEC-SUM-DIA  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NDIA
           ELSE
           IF WSS-COD-PLAV = 'M'
               MOVE FEC-SUM-MES  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NMES
           ELSE
           IF WSS-COD-PLAV = 'A'
               MOVE FEC-SUM-ANO  TO FEC-CMND
               MOVE WSS-NUM-PLAV TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DMAX IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MMAX IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SMAX IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AMAX IN WSS-VARI.
       CON-VAL-LDC-FEC-FINI.
      *>>>>
       FIN-VAL-LDC-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LDC-NUM-PVIG SECTION.
       INI-VAL-LDC-NUM-PVIG.
       FIN-VAL-LDC-NUM-PVIG.
           EXIT.
       
       VAL-LDC-IND-PVIG SECTION.
       INI-VAL-LDC-IND-PVIG.
           IF LDC-IND-PVIG IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-PVIG IN LDC-FLD.
      *<<<< LDC_IND_PVIG
           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD
               GO TO FIN-VAL-LDC-IND-PVIG.

           IF LDC-NUM-PVIG IN LDC-FLD = ZEROES
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'INGPVGFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE -1 TO LDC-NUM-PVIG-LEN  IN LDC-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO FIN-VAL-LDC-IND-PVIG.

      *>>>>
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'TAB' TO MSC-COD-SIST.
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.
           MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PVIG IN LDC-FLD
           ELSE
               MOVE MSC-GLS-ABRV IN MSC TO
                    FRM-GLS-PVIG IN LDC-FLD.
      *<<<< FIN_LDC_IND_PVIG
      *DPR CST   20-FEB-1995 PER. VIGENCIA = A PARAMETRO DE MLT
           IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
               GO TO FIN-VAL-LDC-IND-PVIG.
      *DPR CST  20-FEB-1995 FIN
       FIN-VAL-LDC-IND-PVIG.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-LDC-FEC-FVEN SECTION.
       INI-VAL-LDC-FEC-FVEN.
           IF LDC-FEC-FVEN IN LDC-FLD  NOT > ZEROES
              MOVE ZEROES TO LDC-FEC-FVEN IN LDC-FLD.
      *VAL-FEC Validar Fecha
           MOVE LDC-FEC-FVEN IN LDC-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_LDC_FEC_FVEN
           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *AFRI-INI-SEP2005
           IF WSS-CIC-IFGL = 'FGL'
               MOVE FEC-CHOY-N TO FEC-CHOY.
      *AFRI-INI-SEP2005

      *FLB CST  23-FEB-1995
           IF TLC-CIC-LDIS IN TLC-VARI = 'MLT'
               MOVE FEC-FBLK-N TO FEC-FBLK
               PERFORM ANA-PVIG-FVEN
               IF MSG-COD-MENS > SPACES
                   GO TO FIN-VAL-LDC-FEC-FVEN.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO LDC-FEC-FVEN IN LDC-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-LDC-FEC-FVEN.
      *<<<< LDC_FEC_FVEN
      *FLB CST  28-FEB-1995 VENCTO NO MAYOR A PARAMETRO DE MLT
           IF TLC-CIC-LDIS IN TLC-VARI = 'MLT'
               PERFORM VAL-FVEN-LAV
               GO TO FIN-VAL-LDC-FEC-FVEN.

      *LTM CST 30-09-93
           IF WSS-CIC-TOCF = 'CGE'
               IF NOT (LDC-NUM-SVEN IN LDC-FLD =
                       CLF-NUM-SVEN IN CMA-VARI  AND
                       LDC-NUM-AVEN IN LDC-FLD =
                       CLF-NUM-AVEN IN CMA-VARI  AND
                       LDC-NUM-MVEN IN LDC-FLD =
                       CLF-NUM-MVEN IN CMA-VARI  AND
                       LDC-NUM-DVEN IN LDC-FLD =
                       CLF-NUM-DVEN IN CMA-VARI)
                   MOVE 'DEU'       TO MSG-COD-SIST
                   MOVE 'LDCFNECLF' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-LDC-FEC-FVEN
               ELSE
                   NEXT SENTENCE
           ELSE
               NEXT SENTENCE.
      *LTM 30-09-93 FIN

      * MHM ini 26-OCT-1995
           IF LDC-NUM-PVIG IN LDC-FLD NOT > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES
               MOVE CLF-NUM-PVIG IN CMA-VARI TO LDC-NUM-PVIG IN LDC-FLD
               MOVE CLF-IND-PVIG IN CMA-VARI TO LDC-IND-PVIG IN LDC-FLD.
      * MHM fin 26-OCT-1995

           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
               PERFORM OBT-FVEN
               MOVE WSS-NUM-DVEN IN WSS-VARI TO LDC-NUM-DVEN IN LDC-FLD
               MOVE WSS-NUM-MVEN IN WSS-VARI TO LDC-NUM-MVEN IN LDC-FLD
               MOVE WSS-NUM-SVEN IN WSS-VARI TO LDC-NUM-SVEN IN LDC-FLD
               MOVE WSS-NUM-AVEN IN WSS-VARI TO LDC-NUM-AVEN IN LDC-FLD
               GO TO VAL-FVEN-LDC.

           IF LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
               MOVE CLF-NUM-DVEN IN CMA-VARI TO LDC-NUM-DVEN IN LDC-FLD
               MOVE CLF-NUM-MVEN IN CMA-VARI TO LDC-NUM-MVEN IN LDC-FLD
               MOVE CLF-NUM-SVEN IN CMA-VARI TO LDC-NUM-SVEN IN LDC-FLD
               MOVE CLF-NUM-AVEN IN CMA-VARI TO LDC-NUM-AVEN IN LDC-FLD
               MOVE CLF-NUM-PVIG IN CMA-VARI TO LDC-NUM-PVIG IN LDC-FLD
               MOVE CLF-IND-PVIG IN CMA-VARI TO LDC-IND-PVIG IN LDC-FLD
               GO TO FIN-VAL-LDC-FEC-FVEN.

           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
      * AMP-INI 06-OCT-1993
               GO TO VAL-FVEN-LDC.
      *        PERFORM OBT-FVEN
      *        MOVE LDC-NUM-DVEN IN LDC-FLD TO
      *                                     WSS-NUM-DVE1 IN WSS-VARI
      *        MOVE LDC-NUM-MVEN IN LDC-FLD TO
      *                                     WSS-NUM-MVE1 IN WSS-VARI
      *        MOVE LDC-NUM-SVEN IN LDC-FLD TO
      *                                     WSS-NUM-SVE1 IN WSS-VARI
      *        MOVE LDC-NUM-AVEN IN LDC-FLD TO
      *                                     WSS-NUM-AVE1 IN WSS-VARI
      *        IF WSS-FEC-FVEN IN WSS-VARI NOT =
      *                                     WSS-FEC-FVE1 IN WSS-VARI
      *            MOVE 'DEU' TO MSG-COD-SIST
      *            MOVE 'ERRCONFLD' TO MSG-COD-MENS
      *            PERFORM GET-MSG
      *            MOVE MSG-GLS-DESC TO FRM-MENS
      *            MOVE FRM-SUAR-MAL TO FRM-SUAR
      *            MOVE -1 TO LDC-FEC-FVEN-LEN  IN LDC-FLD
      *            MOVE 'S' TO FRM-UCUR
      *            GO TO FIN-VAL-LDC-FEC-FVEN
      *        ELSE
      *            MOVE WSS-NUM-DVEN IN WSS-VARI TO
      *                                        LDC-NUM-DVEN IN LDC-FLD
      *            MOVE WSS-NUM-MVEN IN WSS-VARI TO
      *                                        LDC-NUM-MVEN IN LDC-FLD
      *            MOVE WSS-NUM-SVEN IN WSS-VARI TO
      *                                        LDC-NUM-SVEN IN LDC-FLD
      *            MOVE WSS-NUM-AVEN IN WSS-VARI TO
      *                                        LDC-NUM-AVEN IN LDC-FLD
      *            GO TO VAL-FVEN-LDC.
      * AMP-FIN

           IF LDC-NUM-PVIG IN LDC-FLD NOT > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
               PERFORM OBT-PVIG.

       VAL-FVEN-LDC.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO WSS-NUM-DVE1 IN WSS-VARI.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO WSS-NUM-MVE1 IN WSS-VARI.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO WSS-NUM-SVE1 IN WSS-VARI.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO WSS-NUM-AVE1 IN WSS-VARI.
      *AFRI-INI-SEP2005
           IF WSS-CIC-IFGL = 'FGL'
           IF WSS-FEC-FVE1 IN WSS-VARI < CLF-FEC-FAPE IN CMA-VARI
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'VENLDC<APE' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-FEC-FVEN.
      *AFRI-INI-SEP2005
      *DPR CST  21-FEB-1995
      *    IF WSS-FEC-FVE1 IN WSS-VARI > CLF-FEC-FVEN IN CMA-VARI
           IF WSS-FEC-FVE1 IN WSS-VARI > CLF-FEC-FVEN IN CMA-VARI AND
              WSS-IND-VTOL NOT = 'S'
      *DPR CST  21-FEB-1995 FIN
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'VENLDC>CLF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-FEC-FVEN.
       FIN-VAL-FVEN-LDC.
      *>>>>
       FIN-VAL-LDC-FEC-FVEN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-LDC-IND-VIGE SECTION.
       INI-VAL-LDC-IND-VIGE.
           IF LDC-IND-VIGE IN LDC-FLD NOT > SPACES
              MOVE SPACES TO LDC-IND-VIGE IN LDC-FLD.
      *<<<< LDC_IND_VIGE
           IF LDC-IND-VIGE IN LDC-FLD NOT > SPACES
               MOVE 'S' TO LDC-IND-VIGE IN LDC-FLD.
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE LDC-IND-VIGE IN LDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
       FIN-VAL-LDC-IND-VIGE.
           EXIT.
       
       VAL-CON-FLD-LDC SECTION.
       INI-VAL-CON-FLD-LDC.
      *<<<< VAL_CON_FLD_LDC

      *FLB CST  10-OCT-1994 Codificacion Tipo de Linea
           IF TLC-VSN-TIPO IN TLC-VARI NOT = 'S' OR
              FRM-IND-MARC IN LDC-FLD = 'S'
                  OR
              ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              WSS-VSN-AOPC = 'S' AND
              CMA-IND-IOPC IN CMA-VARI = 'A'
               GO TO NO-LDC-TIPO.

      *JSS-INI 11-DEC-1998
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'LDC'       TO FIO-SIST.
           MOVE 'VSN'        TO TAB-COD-TTAB IN TAB.
           MOVE 'LDCSIN ARC' TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N' )
      *JSS-FIN 11-DEC-1998
      *VALIDA ARC EN FAMILIA
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD
           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              TLC-VSN-TIPO IN TLC-VARI = 'S' AND
              TLC-CIC-LDIS IN TLC-VARI NOT = 'LIBRE'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCNOARC'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               GO TO FIN-VAL-CON-FLD-LDC.

           IF ARC-COD-TOOC IN LDC-FLD NOT > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES
               GO TO FIN-VAL-CON-FLD-LDC.

           IF ( ARC-COD-TOOC IN LDC-FLD > SPACES OR
                ARC-IIC-IOPC IN LDC-FLD > ZEROES )
                  AND
              TLC-CIC-LDIS IN TLC-VARI = 'LIBRE'
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'LDCEXIARC'    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               GO TO FIN-VAL-CON-FLD-LDC.
      *FLB CST  24-NOV-1994 LINEA DE LIBRE DISPONIBILIDAD

           MOVE LDC-COD-TIPO IN LDC-FLD TO TLC-CODG.
           MOVE ARC-COD-TOOC IN LDC-FLD TO TLC-TOOC.
           MOVE ARC-COD-AOOC IN LDC-FLD TO TLC-AOOC.

           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              TLC-TOOC NOT > SPACES
               MOVE OPC-COD-TOOC IN OPC TO TLC-TOOC
               MOVE OPC-COD-AOOC IN OPC TO TLC-AOOC.

           PERFORM LDC-VAL-TLC.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'          TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE 'S' TO FRM-UCUR
               IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
                  TLC-TOOC NOT > SPACES
                   MOVE -1 TO ARC-CAI-IOPC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC
               ELSE
               IF ARC-COD-AOOC IN LDC-FLD > SPACES
                   MOVE -1 TO ARC-COD-AOOC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC
               ELSE
                   MOVE -1 TO ARC-COD-TOOC-LEN IN LDC-FLD
                   GO TO FIN-VAL-CON-FLD-LDC.

       NO-LDC-TIPO.
      *>>>>
       FIN-VAL-CON-FLD-LDC.
           EXIT.
       
       VAL-CON-LDC SECTION.
       INI-VAL-CON-LDC.
       FIN-VAL-CON-LDC.
           EXIT.
       
       VAL-NUM-KEY-LDC SECTION.
       INI-VAL-NUM-KEY-LDC.
           PERFORM VAL-NUM-IKY-LDC.
           PERFORM VAL-NUM-MKY-LDC.
           PERFORM VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-KEY-LDC.
           EXIT.
       
       VAL-NUM-IKY-LDC SECTION.
       INI-VAL-NUM-IKY-LDC.
       VAL-NUM-LDC-IIC-ICLF.
           MOVE LDC-IIC-ICLF-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-IIC-ICLF IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-IKY-LDC.
       VAL-NUM-LDC-NUM-ILDC.
           MOVE LDC-NUM-ILDC-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-ILDC IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-IKY-LDC.
       FIN-VAL-NUM-IKY-LDC.
           EXIT.
       
       VAL-NUM-MKY-LDC SECTION.
       INI-VAL-NUM-MKY-LDC.
       FIN-VAL-NUM-MKY-LDC.
           EXIT.
       
       VAL-NUM-AKY-LDC SECTION.
       INI-VAL-NUM-AKY-LDC.
       FIN-VAL-NUM-AKY-LDC.
           EXIT.
       
       VAL-NUM-FLD-LDC SECTION.
       INI-VAL-NUM-FLD-LDC.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-LDC-VAL-CMAX.
           MOVE LDC-VAL-CMAX-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-VAL-CMAX IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARC-IIC-IOPC.
           MOVE ARC-IIC-IOPC-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ARC-IIC-IOPC IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARG-NUM-PORG.
           MOVE ARG-NUM-PORG-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ARG-NUM-PORG IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-ARG-IIC-IGAR.
           MOVE ARG-IIC-IGAR-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ARG-IIC-IGAR IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       VAL-NUM-LDC-NUM-PVIG.
           MOVE LDC-NUM-PVIG-ALF IN LDC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO LDC-NUM-PVIG IN LDC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-VAL-NUM-FLD-LDC.
       FIN-VAL-NUM-FLD-LDC.
           EXIT.
       
       EDT-KEY-LDC SECTION.
       INI-EDT-KEY-LDC.
           PERFORM EDT-IKY-LDC.
           PERFORM EDT-MKY-LDC.
           PERFORM EDT-AKY-LDC.
       FIN-EDT-KEY-LDC.
           EXIT.
       
       EDT-IKY-LDC SECTION.
       INI-EDT-IKY-LDC.
           IF LDC-IIC-ICLF-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-IIC-ICLF-LEN IN LDC-FLD
                GO TO FIN-EDT-IKY-LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF-EDT IN LDC-EDT.
           MOVE LDC-IIC-ICLF-EDT IN LDC-EDT TO 
                LDC-IIC-ICLF-ALF IN LDC-FLD.
           IF LDC-NUM-ILDC-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-ILDC-LEN IN LDC-FLD
                GO TO FIN-EDT-IKY-LDC.
           MOVE LDC-NUM-ILDC IN LDC-FLD TO LDC-NUM-ILDC-EDT IN LDC-EDT.
           MOVE LDC-NUM-ILDC-EDT IN LDC-EDT TO 
                LDC-NUM-ILDC-ALF IN LDC-FLD.
       FIN-EDT-IKY-LDC.
           EXIT.
       
       EDT-MKY-LDC SECTION.
       INI-EDT-MKY-LDC.
       FIN-EDT-MKY-LDC.
           EXIT.
       
       EDT-AKY-LDC SECTION.
       INI-EDT-AKY-LDC.
       FIN-EDT-AKY-LDC.
           EXIT.
       
       EDT-FLD-LDC SECTION.
       INI-EDT-FLD-LDC.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE DBC-NUM-ICLI IN LDC-FLD TO
                DBC-NUM-ICLI-EDT IN LDC-EDT.
           MOVE DBC-NUM-ICLI-EDT IN LDC-EDT TO
                DBC-NUM-ICLI-ALF IN LDC-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF LDC-VAL-CMAX-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-VAL-CMAX-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE LDC-VAL-CMAX IN LDC-FLD TO LDC-VAL-CMAX-EDT IN LDC-EDT.
           MOVE LDC-VAL-CMAX-EDT IN LDC-EDT TO 
                LDC-VAL-CMAX-ALF IN LDC-FLD.
           IF ARC-IIC-IOPC-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ARC-IIC-IOPC-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO ARC-IIC-IOPC-EDT IN LDC-EDT.
           MOVE ARC-IIC-IOPC-EDT IN LDC-EDT TO 
                ARC-IIC-IOPC-ALF IN LDC-FLD.
           IF ARG-NUM-PORG-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ARG-NUM-PORG-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARG-NUM-PORG IN LDC-FLD TO ARG-NUM-PORG-EDT IN LDC-EDT.
           MOVE ARG-NUM-PORG-EDT IN LDC-EDT TO 
                ARG-NUM-PORG-ALF IN LDC-FLD.
           IF ARG-IIC-IGAR-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ARG-IIC-IGAR-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE ARG-IIC-IGAR IN LDC-FLD TO ARG-IIC-IGAR-EDT IN LDC-EDT.
           MOVE ARG-IIC-IGAR-EDT IN LDC-EDT TO 
                ARG-IIC-IGAR-ALF IN LDC-FLD.
           IF LDC-NUM-PVIG-LEN IN LDC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO LDC-NUM-PVIG-LEN IN LDC-FLD
                GO TO FIN-EDT-FLD-LDC.
           MOVE LDC-NUM-PVIG IN LDC-FLD TO LDC-NUM-PVIG-EDT IN LDC-EDT.
           MOVE LDC-NUM-PVIG-EDT IN LDC-EDT TO 
                LDC-NUM-PVIG-ALF IN LDC-FLD.
       FIN-EDT-FLD-LDC.
           EXIT.
      *<<<< EOF_BU OR PGM_VMS
       OBT-PVIG SECTION.
       INI-OBT-PVIG.
      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *DIF-FEC obtiene la diferencia en aos entre dos fechas
      *         MOVE CLF-NUM-DAPE IN CMA-VARI TO FEC-DEC1
      *         MOVE CLF-NUM-MAPE IN CMA-VARI TO FEC-MEC1
      *         MOVE CLF-NUM-SAPE IN CMA-VARI TO FEC-SEC1
      *         MOVE CLF-NUM-AAPE IN CMA-VARI TO FEC-AEC1
      *         MOVE 'A' TO LDC-IND-PVIG IN LDC-FLD
      *         MOVE FEC-DIF-ANO TO FEC-CMND
      *     ELSE
      *DIF-FEC obtiene la diferencia en dias entre dos fechas
               MOVE LDC-NUM-DINI IN LDC-FLD TO FEC-DEC1.
               MOVE LDC-NUM-MINI IN LDC-FLD TO FEC-MEC1.
               MOVE LDC-NUM-SINI IN LDC-FLD TO FEC-SEC1.
               MOVE LDC-NUM-AINI IN LDC-FLD TO FEC-AEC1.
               MOVE 'D' TO LDC-IND-PVIG IN LDC-FLD.
               MOVE FEC-DIF-DIA TO FEC-CMND.
      *DPR CST  20-FEB-1995 FIN

           MOVE LDC-FEC-FVEN IN LDC-FLD  TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
               MOVE 'TAB'   TO MSC-COD-SIST
               MOVE 'IPER'  TO MSC-COD-TMSC IN MSC
               MOVE LDC-IND-PVIG IN LDC-FLD TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO FRM-GLS-PVIG IN LDC-FLD

      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *         IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *             MOVE FEC-NANO TO WSS-NANO IN WSS-VARI
      *             IF WSS-NANO IN WSS-VARI > ZEROES
      *                 MOVE WSS-NANO IN WSS-VARI TO
      *                      LDC-NUM-PVIG IN LDC-FLD
      *             ELSE
      *                 MOVE 1 TO LDC-NUM-PVIG IN LDC-FLD
      *         ELSE
                   MOVE FEC-NDIA TO LDC-NUM-PVIG IN LDC-FLD
      *DPR CST  20-FEB-1995 FIN
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.
       FIN-OBT-PVIG.
           EXIT.

       OBT-FVEN SECTION.
       INI-OBT-FVEN.
      *DPR CST  20-FEB-1995 LINEA DE AVANCE
      *     IF TLC-CIC-LDIS IN TLC-VARI NOT = 'MLT'
      *         MOVE CLF-NUM-DAPE IN CMA-VARI TO FEC-ITM1
      *         MOVE CLF-NUM-MAPE IN CMA-VARI TO FEC-ITM2
      *         MOVE CLF-NUM-SAPE IN CMA-VARI TO FEC-ITM3
      *         MOVE CLF-NUM-AAPE IN CMA-VARI TO FEC-ITM4
      *     ELSE
               MOVE LDC-NUM-DINI IN LDC-FLD TO FEC-ITM1.
               MOVE LDC-NUM-MINI IN LDC-FLD TO FEC-ITM2.
               MOVE LDC-NUM-SINI IN LDC-FLD TO FEC-ITM3.
               MOVE LDC-NUM-AINI IN LDC-FLD TO FEC-ITM4.
      *DPR CST  20-FEB-1995 FIN

           IF LDC-IND-PVIG IN LDC-FLD = 'D'
              MOVE FEC-SUM-DIA  TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NDIA
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'M'
              MOVE FEC-SUM-MES TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NMES
           ELSE
           IF LDC-IND-PVIG IN LDC-FLD = 'A'
              MOVE FEC-SUM-ANO TO FEC-CMND
              MOVE LDC-NUM-PVIG IN LDC-FLD TO FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-AVEN IN WSS-VARI.
       FIN-OBT-FVEN.
           EXIT.

      *FLB 11/NOV/92
       PRO-CIC-OPC SECTION.
       INI-PRO-CIC-OPC.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-OPC
           ELSE
              MOVE CIC-CAI-ICIC TO OPC-CAI-IOPC IN OPC
              MOVE CIC-IIC-ICIC TO OPC-IIC-IOPC IN OPC
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-OPC
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-OPC
              ELSE
                 MOVE CIC-CAI-ICIC TO ARC-CAI-IOPC IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARC-IIC-IOPC IN LDC-FLD.
       FIN-PRO-CIC-OPC.
           EXIT.

       PRO-CIC-GDG SECTION.
       INI-PRO-CIC-GDG.

           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRO-CIC-GDG
           ELSE
      *CGL-INI
      *       MOVE CIC-CAI-ICIC TO GAR-NUM-SIS IN GDG
      *       MOVE CIC-IIC-ICIC TO GAR-COD-CRR IN GDG
              MOVE CIC-CAI-ICIC TO GDG-CAI-GTIA IN GDG
              MOVE CIC-IIC-ICIC TO GDG-IIC-GTIA IN GDG
      *CGL-FIN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM BGL-FIO-GDG

              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-GDG
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-GDG.
           EXIT.

       PRO-CIC-FIA SECTION.
       INI-PRO-CIC-FIA.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
              MOVE CIC-MENS TO FRM-MENS
              MOVE FIO-STAT-NEX TO FIO-STAT
              GO TO FIN-PRO-CIC-FIA
           ELSE
              MOVE CIC-CAI-ICIC TO FIA-CAI-IESC IN FIA
              MOVE CIC-IIC-ICIC TO FIA-IIC-IESC IN FIA
              MOVE 1            TO FIA-NUM-IFIA IN FIA
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM DEU-FIO-FIA
              IF FIO-STAT-OKS
                 GO TO INI-PRO-CIC-FIA
              ELSE
                 MOVE CIC-CAI-ICIC TO ARG-CAI-IGAR IN LDC-FLD
                 MOVE CIC-IIC-ICIC TO ARG-IIC-IGAR IN LDC-FLD.
       FIN-PRO-CIC-FIA.
           EXIT.

       VAL-CON-ARC SECTION.
       INI-VAL-CON-ARC.
      *FLB CST  6-OCT-1994 REVISADA TODA LA SECCION
      * PARA NO CTA CTE NO DEBE ESTAR LLENO EL NRO CREDITO
      * SI SE DIGITA EL TIO O LA MONEDA
           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES AND
              ( ARC-COD-VCOC IN LDC-FLD > SPACES OR
                ARC-COD-TOOC IN LDC-FLD > SPACES
              ) AND
              ( WSS-CIC-TOOC NOT = 'CTE' AND USA-CTE OR
                NOT USA-CTE
              )
               MOVE 'IICIOPC>0' TO MSG-COD-MENS
               GO TO ERR-VAL-CON-ARC.

           IF ARC-IIC-IOPC IN LDC-FLD > ZEROES
               GO TO FIN-VAL-CON-ARC.

      * FALTA IIC
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              ( WSS-VSN-AOPC NOT = 'S' OR WSS-CIC-TOOC = 'CTE' AND
                USA-CTE
              )
               PERFORM ERR-GLS
               GO TO FIN-VAL-CON-ARC.

      * OTORGARA EL IIC
           IF ARC-CAI-IOPC IN LDC-FLD > SPACES AND
              ARC-IIC-IOPC IN LDC-FLD NOT > ZEROES AND
              WSS-VSN-AOPC = 'S'
               GO TO FIN-VAL-CON-ARC.

      *FLB CST  6-OCT-1994 PARECE REDUNDANTE
           IF ARC-COD-VCOC IN LDC-FLD = SPACES AND
              ARC-COD-TOOC IN LDC-FLD = SPACES AND
              ARC-COD-AOOC IN LDC-FLD = SPACES
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-VCOC IN LDC-FLD > SPACES AND
              ARC-COD-TOOC IN LDC-FLD > SPACES AND
              ARC-COD-AOOC IN LDC-FLD > SPACES
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-TOOC IN LDC-FLD > SPACES AND
              ARC-COD-AOOC IN LDC-FLD > SPACES
               GO TO FIN-VAL-CON-ARC.

           IF ARC-COD-VCOC IN LDC-FLD > SPACES AND
              ARC-COD-TOOC IN LDC-FLD > SPACES
               MOVE 'ERRCONARC'  TO MSG-COD-MENS
               MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD
               MOVE 'S' TO FRM-UCUR
               GO TO ERR-VAL-CON-ARC.

      *FLB CST  17-OCT-1994
      *    IF ARC-COD-TOOC IN LDC-FLD > SPACES
           IF ARC-COD-TOOC IN LDC-FLD > SPACES AND
              WSS-VSN-AXOB NOT = 'S'
               GO TO FIN-VAL-CON-ARC.

           MOVE 'ERRCONARC'  TO MSG-COD-MENS.
           MOVE -1 TO ARC-COD-VCOC-LEN IN LDC-FLD.
           MOVE 'S' TO FRM-UCUR.
       ERR-VAL-CON-ARC.
           MOVE 'DEU'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CON-ARC.
           EXIT.

       BUSCO-CTA-CTE SECTION.
       INI-BUSCO-CTA-CTE.
           MOVE ZEROES TO WSS-CTA-CTE.
           MOVE LDC-CAI-ICLF IN LDC-FLD TO RDC-CAI-ICLF IN RDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO RDC-IIC-ICLF IN RDC.
           MOVE SPACES                  TO RDC-CIC-ICLI IN RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
               LDC-CAI-ICLF IN LDC-FLD = RDC-CAI-ICLF IN RDC AND
               LDC-IIC-ICLF IN LDC-FLD = RDC-IIC-ICLF IN RDC )
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO FIN-BUSCO-CTA-CTE.
       LUP-BUSCO-CTA-CTE.
           MOVE RDC-CIC-ICLI IN RDC     TO RCO-CIC-ICLI IN RCO.
           MOVE ARC-CAI-IOPC IN LDC-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE ARC-IIC-IOPC IN LDC-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               MOVE 'RCO    NEX' TO MSG-COD-MENS
               GO TO NXT-BUSCO-CTA-CTE
           ELSE
               IF RCO-COD-STAT IN RCO NOT = 'VIG'
                   MOVE 'RCO    NEX' TO MSG-COD-MENS
                   GO TO NXT-BUSCO-CTA-CTE
               ELSE
                   MOVE 99 TO WSS-CTA-CTE.
           IF WSS-CTA-CTE > ZEROES
               GO TO FIN-BUSCO-CTA-CTE.
       NXT-BUSCO-CTA-CTE.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
               LDC-CAI-ICLF IN LDC-FLD = RDC-CAI-ICLF IN RDC AND
               LDC-IIC-ICLF IN LDC-FLD = RDC-IIC-ICLF IN RDC )
               GO TO LUP-BUSCO-CTA-CTE.
       FIN-BUSCO-CTA-CTE.
           EXIT.

       VAL-CTA-CTE SECTION.
       INI-VAL-CTA-CTE.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCTOPEINEX' TO MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'VLR '               TO TAB-COD-TTAB IN TAB.
           MOVE  OPE-COD-VCOP IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCVLRINEX' TO  MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.

           MOVE TAB-EXT-CTAB IN TAB TO CTE-MONE.
           MOVE 'READ'              TO CTE-TOPE.
           MOVE RCO-CIC-IOPE IN RCO TO CTE-NCTA.

           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'TAB'                TO TAB-COD-SIST.
           MOVE 'AUX '               TO TAB-COD-TTAB IN TAB.
           MOVE  RCO-COD-COPR IN RCO TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'OSCAUXINEX' TO MSG-COD-MENS
               GO TO FIN-VAL-CTA-CTE.

           MOVE TAB-EXT-CTAB IN TAB TO CTE-TAUX.
      *<<<< NOT PGM_PER
           MOVE 'LDCPSCTE' TO SYS-PROG.
      *>>>>
           MOVE CTE-CMMA   TO SYS-CMMA.
           MOVE CTE-TCMA   TO SYS-TCMA.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO CTE-CMMA.
       FIN-VAL-CTA-CTE.
           EXIT.
      *AMP-FIN  9-OCT-1993

       VAL-1-LAV SECTION.
       INI-VAL-1-LAV.
           MOVE SPACES TO MSG-COD-MENS.

           MOVE LDC-CAI-ICLF IN LDC-FLD TO LDC-CAI-ICLF IN LDC.
           MOVE LDC-IIC-ICLF IN LDC-FLD TO LDC-IIC-ICLF IN LDC.
           MOVE ZEROES                  TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
                    LDC-CAI-ICLF IN LDC = LDC-CAI-ICLF IN LDC-FLD AND
                    LDC-IIC-ICLF IN LDC = LDC-IIC-ICLF IN LDC-FLD )
               GO TO BRW-VAL-1-LAV.

       LUP-VAL-1-LAV.
           MOVE 'DEU' TO TAB-COD-SIST.
           MOVE 'TLC'                   TO TAB-COD-TTAB IN TAB.
           MOVE LDC-COD-TIPO IN LDC     TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               MOVE 'GNS'   TO MSG-COD-SIST
               GO TO BRW-VAL-1-LAV.

      *RRM-INI abril-2018 / control LDC duplicadas
           IF TLC-CIC-LDIS IN TLC-VARI NOT = WSS-CT-MLT
               GO TO VRF-LDC-DUPL.
      *RRM-FIN abril-2018 / control LDC duplicadas

      * ERROR CUANDO :
      * COMANDO ING : YA EXISTE 'MLT'
      * COMANDO MOD : YA EXISTE 'MLT' EN LDC DISTINTA A LA DE FRM
           IF TAB-CIC-CTAB IN TAB = 'MLT' AND
              ( SCR-CCPP = 'ING' OR
                LDC-NUM-ILDC IN LDC NOT = LDC-NUM-ILDC IN LDC-FLD )
               MOVE 'DEU'   TO MSG-COD-SIST
               MOVE 'MLT SOLO 1'   TO MSG-COD-MENS
               GO TO BRW-VAL-1-LAV.

      *RRM-INI abril-2018 / control LDC duplicadas
       VRF-LDC-DUPL.
           IF SCR-CCPP NOT = 'ING'
               GO TO NXT-VAL-1-LAV.

           IF LDC-COD-TIPO IN LDC      = LDC-COD-TIPO IN LDC-FLD  AND
              LDC-NUM-ILDC IN LDC  NOT = LDC-NUM-ILDC IN LDC-FLD  AND
              TAB-GLS-DATA IN TAB(7:1) NOT = WSS-D
                MOVE 'DEU'        TO MSG-COD-SIST
                MOVE 'LDC   DPLC' TO MSG-COD-MENS
                GO TO BRW-VAL-1-LAV.
      *RRM-FIN abril-2018 / control LDC duplicadas

       NXT-VAL-1-LAV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS AND
              LDC-CAI-ICLF IN LDC = LDC-CAI-ICLF IN LDC-FLD AND
              LDC-IIC-ICLF IN LDC = LDC-IIC-ICLF IN LDC-FLD
               GO TO LUP-VAL-1-LAV.

       BRW-VAL-1-LAV.
           IF FIO-STAT-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-LDC.
       FIN-VAL-1-LAV.
           EXIT.

       ANA-PVIG-FVEN SECTION.
       INI-ANA-PVIG-FVEN.
           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
               PERFORM OBT-FVEN
               MOVE WSS-NUM-DVEN IN WSS-VARI TO LDC-NUM-DVEN IN LDC-FLD
               MOVE WSS-NUM-MVEN IN WSS-VARI TO LDC-NUM-MVEN IN LDC-FLD
               MOVE WSS-NUM-SVEN IN WSS-VARI TO LDC-NUM-SVEN IN LDC-FLD
               MOVE WSS-NUM-AVEN IN WSS-VARI TO LDC-NUM-AVEN IN LDC-FLD
           ELSE
           IF LDC-FEC-FVEN IN LDC-FLD NOT > ZEROES
      * ES MLT Y P. VIG Y FVEN VACIOS SE RECHAZARA
               NEXT SENTENCE
           ELSE
           IF LDC-NUM-PVIG IN LDC-FLD > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
      * PVIG Y FVEN deben coincidir
               PERFORM OBT-FVEN
               MOVE LDC-NUM-DVEN IN LDC-FLD TO
                                            WSS-NUM-DVE1 IN WSS-VARI
               MOVE LDC-NUM-MVEN IN LDC-FLD TO
                                            WSS-NUM-MVE1 IN WSS-VARI
               MOVE LDC-NUM-SVEN IN LDC-FLD TO
                                            WSS-NUM-SVE1 IN WSS-VARI
               MOVE LDC-NUM-AVEN IN LDC-FLD TO
                                            WSS-NUM-AVE1 IN WSS-VARI
               IF WSS-FEC-FVEN IN WSS-VARI NOT =
                                            WSS-FEC-FVE1 IN WSS-VARI
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'PVIG<>FVEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-ANA-PVIG-FVEN
               ELSE
                   NEXT SENTENCE
           ELSE
           IF LDC-NUM-PVIG IN LDC-FLD NOT > ZEROES AND
              LDC-IND-PVIG IN LDC-FLD NOT > SPACES AND
              LDC-FEC-FVEN IN LDC-FLD > ZEROES
               PERFORM OBT-PVIG.

       FIN-ANA-PVIG-FVEN.
           EXIT.

       VAL-FVEN-LAV SECTION.
       INI-VAL-FVEN-LAV.
           MOVE LDC-NUM-SVEN IN LDC-FLD TO FEC-SVLD.
           MOVE LDC-NUM-AVEN IN LDC-FLD TO FEC-AVLD.
           MOVE LDC-NUM-MVEN IN LDC-FLD TO FEC-MVLD.
           MOVE LDC-NUM-DVEN IN LDC-FLD TO FEC-DVLD.

           IF FEC-FVLD > WSS-FEC-FMAX
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'FVEN>MAX' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FVEN-LAV.

       FIN-VAL-FVEN-LAV.
           EXIT.

      *>>>>
