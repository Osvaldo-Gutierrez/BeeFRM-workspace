       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      LDCPLCLR.
       AUTHOR.          CONSIST (RVM).
       DATE-WRITTEN.    26-Aug-96 05:53 PM.

      * Programa Listador de Reporte RTL sin Sort.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MODIFICACION: CONVERTIR REPORT-WRITER A LISTADO, MIGRAR A     *
      *                A COBOL FOR MVS Y CONVERSION 2000               *
      *  FECHA: 13/03/1998                                             *
      ******************************************************************

      *<<<< CMT_ID
      *PROGRAMA PARA GENERAR RESUMENES POR TIPO DE LINEA Y TOTAL GENERAL
      *BANCO, UTILIZANDO ARCHIVO SORT GENERADO POR LDCPLCLF
      *>>>>

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPTRTL       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTRTL       ASSIGN TO        UT-S-RPTRTL.
      ***** CRW-COMIENZO
      *    SELECT RPTRTL       ASSIGN TO        UT-S-RPTRTL.
           SELECT RPTRTL       ASSIGN TO        RPTRTL.
      ***** CRW-FINAL
      *<<<< IOS
      ***** CRW-COMIENZO
      *    SELECT RPTRBC       ASSIGN TO UT-S-RPTRBC.
           SELECT RPTRBC       ASSIGN TO RPTRBC.
      ***** CRW-FINAL
      *>>>>

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
      ***** CRW-COMIENZO
      *FD  RPTRTL LABEL RECORD OMITTED
      *    REPORT IS RPT-RTL
      *<<<< FD_RPT
      *>>>>
      *    .
      *<<<< FLS
       FD  RPTRTL
           RECORD CONTAINS 132 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.

       01  RPTRTL-REG           PIC X(132).

      *FD  RPTRBC LABEL RECORDS OMITTED
      *    REPORT IS RPT-RBC.
       FD  RPTRBC
           RECORD CONTAINS 132 CHARACTERS
           BLOCK CONTAINS 0 RECORDS
           LABEL RECORD STANDARD.
      ***** CRW-FINAL

       01  RPTRBC-REG           PIC X(132).
      *>>>>

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY LDCBRCLR.
      *COPY LDCRRRTL.
      *    23-JUL-96 01:01 PM
       01  SRT.
           03 SRT-COD-TIPO PIC X(3).
      *<<<< RR
      *>>>>
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
      *COPY LDCRWRTL.
      *    23-JUL-96 01:01 PM
       01  WSS-RTL.
           03 WSS-NUM-DHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-MHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-SHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-AHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-GLS-TIPO PIC X(30)
              VALUE  SPACES.
           03 WSS-COD-OFIC PIC X(3)
              VALUE  SPACES.
           03 WSS-NUM-TLIN PIC 9(6)
              VALUE ZEROES.
           03 WSS-VAL-ATRZ PIC 99999999999999
              VALUE ZEROES.
           03 WSS-VAL-UTIL PIC 99999999999999
              VALUE ZEROES.
           03 WSS-GLS-LIN1 PIC X
              VALUE  SPACES.
           03 WSS-GLS-LIN2 PIC X
              VALUE  SPACES.

      *<<<< RW
      *COPY LDCRWRBC.
      *    23-JUL-96 01:02 PM
       01  WSS-RBC.
           03 WSS-NUM-DHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-MHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-SHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-NUM-AHAS PIC X(2)
              VALUE  SPACES.
           03 WSS-COD-TIPO PIC X(3)
              VALUE  SPACES.
           03 WSS-GLS-TIPO PIC X(30)
              VALUE  SPACES.
           03 WSS-NUM-TLIN PIC 9(6)
              VALUE ZEROES.
           03 WSS-VAL-ATRZ PIC 99999999999999
              VALUE ZEROES.
           03 WSS-VAL-UTIL PIC 99999999999999
              VALUE ZEROES.
           03 WSS-GLS-LIN PIC X
              VALUE  SPACES.

      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       01  WSS-VARI.
           03  WSS-COD-TIPO-ANT       VALUE SPACES   PIC X(03).
           03  WSS-COD-OFIC-ANT       VALUE SPACES   PIC X(03).
           03  WSS-COD-PESO                          PIC X(06).
           03  WSS-COD-UF                            PIC X(06).
           03  WSS-SGV-VCAM-UF                       PIC 9(11)V9(4).
           03  WSS-SGV-UF                            PIC 9(11)V9(4).
           03  WSS-FEC-FHOY.
               05 WSS-NUM-SHOY                       PIC 9(02).
               05 WSS-NUM-AHOY                       PIC 9(02).
               05 WSS-NUM-MHOY                       PIC 9(02).
               05 WSS-NUM-DHOY                       PIC 9(02).
       COPY GNSBRMSC.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGPES.
       COPY TABBRCAM.
       COPY TABWGTVC.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
      *>>>>

      ***** CRW-COMIENZO
      *REPORT SECTION.
      *--------------
      *COPY LDCRFRTL.
      *<<<< RF
      *>>>>
      *    .
      *COPY LDCRTRTL.
       01  RPT-VARIABLES.
           02 RPT-VARIABLES-VARIAS.
               03 RPT-RTL-VARI-LINEA          PIC 9(03) VALUE 60.
               03 RPT-RTL-VARI-PAGE-COUNTER   PIC 9(03).
               03 RPT-RBC-VARI-LINEA          PIC 9(03) VALUE 60.
               03 RPT-RBC-VARI-PAGE-COUNTER   PIC 9(03).
           02 RPT-VARIABLES-CONTROL.
               03 RPT-CTRL-COD-TIPO           PIC X(03) VALUE SPACES.
           02 RPT-VARIABLES-SUMAS.
               03 RPT-SUMA-NUM-TLIN           PIC 9(06).
               03 RPT-SUMA-VAL-ATRZ           PIC 9(15).
               03 RPT-SUMA-VAL-UTIL           PIC 9(15).
               03 RPT-SUMA-BCO-TLIN           PIC 9(06).
               03 RPT-SUMA-BCO-ATRZ           PIC 9(15).
               03 RPT-SUMA-BCO-UTIL           PIC 9(15).
               03 RPT-RBC-SUMA-BCO-TLIN       PIC 9(06).
               03 RPT-RBC-SUMA-BCO-ATRZ       PIC 9(15).
               03 RPT-RBC-SUMA-BCO-UTIL       PIC 9(15).

       01  HDR-RTL.
           03  PH-RTL-01.
               05  RPT-RTL-HEAD-DUSU          PIC X(30).
               05  FILLER                     PIC X(19) VALUE SPACES.

               05  FILLER                     PIC X(35)
                   VALUE 'L I N E A S  G L O B A L E S  A L :'.
               05  FILLER                     PIC X(4) VALUE SPACES.
               05  RPT-RTL-HEAD-NUM-DHAS      PIC X(2).

               05  FILLER                     PIC X(1) VALUE ALL '-'.
               05  RPT-RTL-HEAD-NUM-MHAS      PIC X(2).
               05  FILLER                     PIC X(1) VALUE ALL '-'.
               05  RPT-RTL-HEAD-NUM-SHAS      PIC X(2).
               05  RPT-RTL-HEAD-NUM-AHAS      PIC X(2).
               05  FILLER                     PIC X(24) VALUE SPACES.

               05  RPT-RTL-HEAD-FDMA          PIC 99B99B9999.

           03  PH-RTL-02.
               05  RPT-RTL-HEAD-DSIS          PIC X(30).
               05  FILLER                     PIC X(19) VALUE SPACES.

               05  FILLER                     PIC X(39)
                   VALUE 'R E S U M E N   P O R   T I P O   D E  '.
               05  FILLER                     PIC X(39)
                   VALUE ' L I N E A                        PAGIN'.
               05  FILLER                     PIC X(1)
                   VALUE 'A'.
               05  FILLER                     PIC X(1) VALUE SPACES.

               05  RPT-RTL-HEAD-PAGE-COUNTER  PIC 9(03).

           03  PH-RTL-03.
               05  FILLER                     PIC X(123) VALUE SPACES.

               05  FILLER                     PIC X(8)
                   VALUE 'LDCPLCLR'.

           03  PH-RTL-04.
               05  FILLER                     PIC X(15)
                   VALUE 'TIPO DE LINEA :'.
               05  FILLER                     PIC X(1).
               05  RPT-RTL-HEAD-COD-TIPO      PIC X(3).
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RTL-HEAD-GLS-TIPO      PIC X(30).

           03  PH-RTL-05.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  PH-RTL-06.
               05  FILLER                     PIC X(5) VALUE SPACES.
               05  FILLER                     PIC X(39)
                 VALUE 'OFICINA                  CANTIDAD DE LI'.
               05  FILLER                     PIC X(39)
                 VALUE 'NEAS             MONTO AUTORIZADO      '.
               05  FILLER                     PIC X(27)
                 VALUE '            MONTO UTILIZADO'.

           03  PH-RTL-07.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  DL-RTL-08.
               05  FILLER                     PIC X(7) VALUE SPACES.
               05  RPT-RTL-DETA-COD-OFIC      PIC X(3).
               05  FILLER                     PIC X(26) VALUE SPACES.
               05  RPT-RTL-DETA-NUM-TLIN      PIC ZZZZZZ.
               05  FILLER                     PIC X(13) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(3) VALUE SPACES.
               05  RPT-RTL-DETA-VAL-ATRZ      PIC ZZ.ZZZ.ZZZ.ZZZ.ZZZ.
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(4) VALUE SPACES.
               05  RPT-RTL-DETA-VAL-UTIL      PIC ZZ.ZZZ.ZZZ.ZZZ.ZZZ.

       01  CF-RTL-SRT-COD-TIPO.
           03  CF-RTL-09.
               05  RPT-RTL-FOOT-GLS-LIN1      PIC X(1).

           03  CF-RTL-10.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  CF-RTL-11.
               05  FILLER                     PIC X(19)
                   VALUE 'TOTAL TIPO DE LINEA'.
               05  FILLER                     PIC X(17).
               05  RPT-RTL-FOOT-NUM-TLIN      PIC ZZZZZZ.
               05  FILLER                     PIC X(13) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RTL-FOOT-VAL-ATRZ      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RTL-FOOT-VAL-UTIL      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.

       01  FF-RTL.
           03  CF-RTL-12.
               05  RPT-RTL-FOOT-GLS-LIN2      PIC X(1).

           03  CF-RTL-13.
               05  FILLER                     PIC X(131)
                   VALUE ALL '-'.

           03  CF-RTL-14.
               05  FILLER                     PIC X(11)
                   VALUE 'TOTAL BANCO'.
               05  FILLER                     PIC X(25) VALUE SPACES.
               05  RPT-RTL-FOOT-BCO-TLIN      PIC ZZZZZZ.
               05  FILLER                     PIC X(13) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RTL-FOOT-BCO-ATRZ      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RTL-FOOT-BCO-UTIL      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.

      *<<<< RT
      *COPY LDCRFRBC.
      *    .
      *COPY LDCRTRBC.

       01  HDR-RBC.
           03  PH-RBC-01.
               05  RPT-RBC-HEAD-DUSU          PIC X(30).
               05  FILLER                     PIC X(19) VALUE SPACES.

               05  FILLER                     PIC X(35)
                   VALUE 'L I N E A S  G L O B A L E S  A L :'.
               05  FILLER                     PIC X(4) VALUE SPACES.
               05  RPT-RBC-HEAD-NUM-DHAS      PIC X(2).

               05  FILLER                     PIC X(1) VALUE ALL '-'.
               05  RPT-RBC-HEAD-NUM-MHAS      PIC X(2).
               05  FILLER                     PIC X(1) VALUE ALL '-'.
               05  RPT-RBC-HEAD-NUM-SHAS      PIC X(2).
               05  RPT-RBC-HEAD-NUM-AHAS      PIC X(2).
               05  FILLER                     PIC X(24) VALUE SPACES.

               05  RPT-RBC-HEAD-FDMA          PIC 99B99B9999.

           03  PH-RBC-02.
               05  RPT-RBC-HEAD-DSIS          PIC X(30).
               05  FILLER                     PIC X(27) VALUE SPACES.

               05  FILLER                     PIC X(39)
                   VALUE 'R E S U M E N   B A N C O              '.
               05  FILLER                     PIC X(32)
                   VALUE '                          PAGINA'.
               05  FILLER                     PIC X(1) VALUE SPACES.

               05  RPT-RBC-HEAD-PAGE-COUNTER  PIC 9(03).

           03  PH-RBC-03.
               05  FILLER                     PIC X(123) VALUE SPACES.

               05  FILLER                     PIC X(8)
                   VALUE 'LDCPLCLR'.

           03  PH-RBC-04.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  PH-RBC-05.
               05  FILLER                     PIC X(10) VALUE SPACES.
               05  FILLER                     PIC X(39)
                   VALUE 'TIPO DE LINEA                 CANTIDAD '.
               05  FILLER                     PIC X(39)
                   VALUE 'DE LINEAS             MONTO AUTORIZADO '.
               05  FILLER                     PIC X(32)
                   VALUE '                 MONTO UTILIZADO'.

           03  PH-RBC-06.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.

           03  DL-RBC-07.
               05  FILLER                     PIC X(1) VALUE SPACES.
               05  RPT-RBC-DETA-COD-TIPO      PIC X(3).
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RBC-DETA-GLS-TIPO      PIC X(30).
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  RPT-RBC-DETA-NUM-TLIN      PIC ZZZZZZ.
               05  FILLER                     PIC X(13) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(3) VALUE SPACES.
               05  RPT-RBC-DETA-VAL-ATRZ      PIC ZZ.ZZZ.ZZZ.ZZZ.ZZZ.
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(3) VALUE SPACES.
               05  RPT-RBC-DETA-VAL-UTIL      PIC ZZ.ZZZ.ZZZ.ZZZ.ZZZ.

       01  CF-RBC-SRT-COD-TIPO.
           03  CF-RBC-08.
               05  RPT-RBC-FOOT-GLS-LIN1      PIC X(1).

           03  CF-RBC-09.
               05  FILLER                     PIC X(132)
                   VALUE ALL '-'.


       01  FF-RBC.
           03  CF-RBC-11.
               05  RPT-RBC-FOOT-GLS-LIN2      PIC X(1).

           03  CF-RBC-12.
               05  FILLER                     PIC X(131)
                   VALUE ALL '-'.

           03  CF-RBC-13.
               05  FILLER                     PIC X(13)
                   VALUE 'TOTAL GENERAL'.
               05  FILLER                     PIC X(34) VALUE SPACES.
               05  RPT-RBC-FOOT-BCO-TLIN      PIC ZZZZZZ.
               05  FILLER                     PIC X(13) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RBC-FOOT-BCO-ATRZ      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.
               05  FILLER                     PIC X(11) VALUE SPACES.
               05  FILLER                     PIC X(2)
                   VALUE 'UF'.
               05  FILLER                     PIC X(2) VALUE SPACES.
               05  RPT-RBC-FOOT-BCO-UTIL      PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZZ.
      *>>>>

       PROCEDURE DIVISION.
      *==================
      ***** CRW-COMIENZO
      *DECLARATIVES.
      *DEC-CF-RTL-SRT-COD-TIPO SECTION.
      *    USE BEFORE REPORTING CF-RTL-SRT-COD-TIPO.
      *INI-CF-RTL-SRT-COD-TIPO.
      *FIN-CF-RTL-SRT-COD-TIPO.
      *    EXIT.
      *DEC-PH-RTL SECTION.
      *    USE BEFORE REPORTING PH-RTL.
      *INI-PH-RTL.
      *FIN-PH-RTL.
      *    EXIT.
      *DEC-FF-RTL SECTION.
      *    USE BEFORE REPORTING FF-RTL.
      *INI-FF-RTL.
      *FIN-FF-RTL.
      *    EXIT.
      *<<<< FIN_DEC
      *>>>>
      *END DECLARATIVES.
      ***** CW-FINAL

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'LDCPLCLR' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           MOVE FIO-INP      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *<<<< INI

      * OBTIENE COD. VALOR DE CAMBIO UF CON CIC DE LA MONEDA '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0998 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
              PERFORM GNS-PRO-ABT.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.

      * OBTIENE COD. VALOR DE CAMBIO PESOS CON CIC DE LA MONEDA '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              DISPLAY ' '
              DISPLAY ' PROCESO CANCELADO '
              DISPLAY ' ERROR EN OBTENCION CIC MONEDA 0999 : '
                        TAB-COD-CTAB IN TAB ' FS: ' FIO-STAT
              PERFORM GNS-PRO-ABT.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

           PERFORM GET-FHOY.
           MOVE HOY-SHOY           TO WSS-NUM-SHOY IN WSS-VARI.
           MOVE HOY-AHOY           TO WSS-NUM-AHOY IN WSS-VARI.
           MOVE HOY-MHOY           TO WSS-NUM-MHOY IN WSS-VARI.
           MOVE HOY-DHOY           TO WSS-NUM-DHOY IN WSS-VARI.

           MOVE WSS-NUM-DHOY IN WSS-VARI TO CAM-NUM-DCAM IN CAM(1).
           MOVE WSS-NUM-MHOY IN WSS-VARI TO CAM-NUM-MCAM IN CAM(1).
           MOVE WSS-NUM-SHOY IN WSS-VARI TO CAM-NUM-SCAM IN CAM(1).
           MOVE WSS-NUM-AHOY IN WSS-VARI TO CAM-NUM-ACAM IN CAM(1).
           MOVE CAM-FEC-FCAM IN CAM(1) TO CAM-FEC-FCAM IN CAM(2).
      *BUSCA VALOR DE CAMBIO DE UF A PESO
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND
                    CAM-SGV-VCAM IN CAM > 0 )
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 CAM-COD-VCAM IN CAM(1) ' A : '
                 CAM-COD-VCAM IN CAM(2) ' AL : '
                 CAM-FEC-FCAM IN CAM(1)
               PERFORM GNS-PRO-ABT
           ELSE
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM-UF IN WSS-VARI.
      *>>>>
       INI-INP-SRT.
      *<<<< INI_INP
      *>>>>
      *     MOVE 'LDCPLCLR' TO RPT-NPGM.
           CALL 'GNSPLHDR' USING RPT-VARI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-CLR.
       FST-INP-SRT.
      *<<<< INI_FST_INP
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-CLR.
      *<<<< FIN_FST_INP
      *MUEVE REGISTRO CABECERA
           IF CLR-GLS-FLAG1 IN CLR = '1'
               MOVE CLR-NUM-DPRO IN CLR TO WSS-NUM-DHAS IN WSS-RTL
               MOVE CLR-NUM-MPRO IN CLR TO WSS-NUM-MHAS IN WSS-RTL
               MOVE CLR-NUM-SPRO IN CLR TO WSS-NUM-SHAS IN WSS-RTL
               MOVE CLR-NUM-APRO IN CLR TO WSS-NUM-AHAS IN WSS-RTL

               MOVE CLR-NUM-DPRO IN CLR TO WSS-NUM-DHAS IN WSS-RBC
               MOVE CLR-NUM-MPRO IN CLR TO WSS-NUM-MHAS IN WSS-RBC
               MOVE CLR-NUM-SPRO IN CLR TO WSS-NUM-SHAS IN WSS-RBC
               MOVE CLR-NUM-APRO IN CLR TO WSS-NUM-AHAS IN WSS-RBC
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM LDC-FIO-CLR
               IF NOT FIO-STAT-OKS
                   DISPLAY 'ERROR: NO HAY REGISTROS DETALLES EN LDCCLR'
                   DISPLAY ' '
                      PERFORM GNS-PRO-ABT.

           MOVE CLR-COD-TIPO IN CLR TO SRT-COD-TIPO IN SRT.
           MOVE CLR-COD-TIPO IN CLR TO WSS-COD-TIPO-ANT IN WSS-VARI.
           MOVE CLR-COD-OFIC IN CLR TO WSS-COD-OFIC IN WSS-RTL.
           MOVE CLR-COD-OFIC IN CLR TO WSS-COD-OFIC-ANT IN WSS-VARI.

           MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-RTL.
           MOVE ZEROES TO WSS-VAL-UTIL IN WSS-RTL.
           MOVE ZEROES TO WSS-NUM-TLIN IN WSS-RTL.

           MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-RBC.
           MOVE ZEROES TO WSS-VAL-UTIL IN WSS-RBC.
           MOVE ZEROES TO WSS-NUM-TLIN IN WSS-RBC.

           PERFORM BUS-GLS-TIPO.
      *>>>>
       INI-OUT-SRT.
      *<<<< INI_OUT
           OPEN OUTPUT RPTRBC.
      ***** CRW-COMIENZO
      *    INITIATE RPT-RBC.
           MOVE 0 TO RPT-RBC-SUMA-BCO-TLIN.
           MOVE 0 TO RPT-RBC-SUMA-BCO-ATRZ.
           MOVE 0 TO RPT-RBC-SUMA-BCO-UTIL.
           MOVE 0 TO RPT-RBC-VARI-PAGE-COUNTER.
      ***** CRW-FINAL
      *>>>>
           OPEN OUTPUT RPTRTL.
      ***** CRW-COMIENZO
      *    INITIATE RPT-RTL.
           MOVE 0 TO RPT-SUMA-NUM-TLIN.
           MOVE 0 TO RPT-SUMA-VAL-ATRZ.
           MOVE 0 TO RPT-SUMA-VAL-UTIL.
           MOVE 0 TO RPT-SUMA-BCO-TLIN.
           MOVE 0 TO RPT-SUMA-BCO-ATRZ.
           MOVE 0 TO RPT-SUMA-BCO-UTIL.
           MOVE 0 TO RPT-RTL-VARI-PAGE-COUNTER.
      ***** CRW-FINAL
      *<<<< FST_OUT
      *>>>>
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<< LUP_INP
      *>>>>
       MOV-INP-SRT.
      *COPY LDCRMRTL.
      *    23-JUL-96 01:01 PM

      *<<<< RM
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT

           IF CLR-COD-TIPO IN CLR = WSS-COD-TIPO-ANT IN WSS-VARI
               ADD 1 TO WSS-NUM-TLIN IN WSS-RBC
               IF CLR-COD-OFIC IN CLR = WSS-COD-OFIC-ANT IN WSS-VARI
                   ADD 1 TO WSS-NUM-TLIN IN WSS-RTL
                   IF CLR-COD-VCLC IN CLR = WSS-COD-UF IN WSS-VARI
      *MOVER VALORES EN UF
                     ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RTL
                     ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RBC
                     PERFORM CNV-ME-A-UF-UTIL
                   ELSE
      *CONVERTIR A UF
                     PERFORM CNV-ME-A-UF-ATRZ
                     PERFORM CNV-ME-A-UF-UTIL
               ELSE
      *NUEVA OFICINA
      ***** CRW-COMIENZO
      *            GENERATE DL-RTL
                   PERFORM GENERATE-DL-RTL
      ***** CRW-FINAL
                   MOVE 1                   TO WSS-NUM-TLIN IN WSS-RTL
                   MOVE CLR-COD-OFIC IN CLR TO WSS-COD-OFIC IN WSS-RTL
                   MOVE CLR-COD-OFIC IN CLR TO
                        WSS-COD-OFIC-ANT IN WSS-VARI
                   MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-RTL
                   MOVE ZEROES TO WSS-VAL-UTIL IN WSS-RTL
                   IF CLR-COD-VCLC IN CLR = WSS-COD-UF IN WSS-VARI
      *MOVER VALORES EN UF
                     ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RTL
                     ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RBC
                     PERFORM CNV-ME-A-UF-UTIL
                   ELSE
      *CONVERTIR A UF
                     PERFORM CNV-ME-A-UF-ATRZ
                     PERFORM CNV-ME-A-UF-UTIL
           ELSE
      *NUEVO TIPO DE LINEA
      ***** CRW-COMIENZO
      *      GENERATE DL-RTL
             PERFORM GENERATE-DL-RTL
      ***** CRW-FINAL
             MOVE 1                   TO WSS-NUM-TLIN IN WSS-RTL
             MOVE CLR-COD-OFIC IN CLR TO WSS-COD-OFIC IN WSS-RTL
             MOVE CLR-COD-OFIC IN CLR TO WSS-COD-OFIC-ANT IN WSS-VARI
             MOVE ZEROES TO WSS-VAL-ATRZ IN WSS-RTL
             MOVE ZEROES TO WSS-VAL-UTIL IN WSS-RTL
      ***** CRW-COMIENZO
      *      GENERATE DL-RBC
             PERFORM GENERATE-DL-RBC
      ***** CRW-FINAL
             PERFORM BUS-GLS-TIPO
             MOVE CLR-COD-TIPO IN CLR TO SRT-COD-TIPO IN SRT
             MOVE CLR-COD-TIPO IN CLR TO WSS-COD-TIPO-ANT IN WSS-VARI
             MOVE 1                   TO WSS-NUM-TLIN IN WSS-RBC
             MOVE ZEROES              TO WSS-VAL-ATRZ IN WSS-RBC
             MOVE ZEROES              TO WSS-VAL-UTIL IN WSS-RBC
             IF CLR-COD-VCLC IN CLR = WSS-COD-UF IN WSS-VARI
      *MOVER VALORES EN UF
               ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RTL
               ADD CLR-VAL-CMAX IN CLR TO WSS-VAL-ATRZ IN WSS-RBC
               PERFORM CNV-ME-A-UF-UTIL
             ELSE
      *CONVERTIR A UF
               PERFORM CNV-ME-A-UF-ATRZ
               PERFORM CNV-ME-A-UF-UTIL.

      *SE SALTA GENERATE DEL PROGRAMA
           GO TO NXT-INP-SRT.
      *>>>>
      ***** CRW-COMIENZO
      *    GENERATE DL-RTL.
               PERFORM GENERATE-DL-RTL.
      ***** CRW-FINAL
      *<<<< FIN_GEN_OUT
      *>>>>
       NXT-INP-SRT.
       NXT-OUT-SRT.
      *<<<< INI_NXT_INP
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-CLR.
      *<<<< FIN_NXT_INP
      *>>>>
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
      *<<<< FIN_INP
      *>>>>
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-CLR.
       FIN-OUT-SRT.
      *<<<< FIN_OUT
      ***** CRW-COMIENZO
      *    GENERATE DL-RTL.
           PERFORM GENERATE-DL-RTL.

      ***** CRW-COMIENZO
      *    GENERATE DL-RBC
           PERFORM GENERATE-DL-RBC
      ***** CRW-FINAL

      *>>>>
      ***** CRW-COMIENZO
      *    TERMINATE RPT-RTL.
           MOVE HIGH-VALUE TO RPT-CTRL-COD-TIPO
           PERFORM INI-RTL-CTRL-REPORT
           MOVE RPT-SUMA-BCO-TLIN       TO RPT-RTL-FOOT-BCO-TLIN
           MOVE RPT-SUMA-BCO-ATRZ       TO RPT-RTL-FOOT-BCO-ATRZ
           MOVE RPT-SUMA-BCO-UTIL       TO RPT-RTL-FOOT-BCO-UTIL
           WRITE RPTRTL-REG FROM  CF-RTL-12
           WRITE RPTRTL-REG FROM  CF-RTL-13
           WRITE RPTRTL-REG FROM  CF-RTL-14.
      ***** CRW-FINAL
      *<<<< FIN_TMT
      ***** CRW-COMIENZO
      *    TERMINATE RPT-RBC.
           MOVE RPT-RBC-SUMA-BCO-TLIN   TO RPT-RBC-FOOT-BCO-TLIN
           MOVE RPT-RBC-SUMA-BCO-ATRZ   TO RPT-RBC-FOOT-BCO-ATRZ
           MOVE RPT-RBC-SUMA-BCO-UTIL   TO RPT-RBC-FOOT-BCO-UTIL
           WRITE RPTRBC-REG FROM  CF-RBC-11.
           WRITE RPTRBC-REG FROM  CF-RBC-12.
           WRITE RPTRBC-REG FROM  CF-RBC-13.
      ***** CRW-FINAL
      *>>>>
           CLOSE RPTRTL.
      *<<<< FIN
           CLOSE RPTRBC.
      *>>>>
           IF PGM-STAT-SRT-MAL
               PERFORM GNS-PRO-ABT
           ELSE
               PERFORM GNS-PRO-END.

      ***** CRW-COMIENZO
       INI-GEN-DL-RTL SECTION.
       GENERATE-DL-RTL.
           MOVE WSS-COD-OFIC IN WSS-RTL   TO RPT-RTL-DETA-COD-OFIC
           MOVE WSS-NUM-TLIN IN WSS-RTL   TO RPT-RTL-DETA-NUM-TLIN
           MOVE WSS-VAL-ATRZ IN WSS-RTL   TO RPT-RTL-DETA-VAL-ATRZ
           MOVE WSS-VAL-UTIL IN WSS-RTL   TO RPT-RTL-DETA-VAL-UTIL
           MOVE WSS-GLS-LIN1 IN WSS-RTL   TO RPT-RTL-FOOT-GLS-LIN1
           MOVE WSS-GLS-LIN2 IN WSS-RTL   TO RPT-RTL-FOOT-GLS-LIN2.
           IF RPT-RTL-VARI-LINEA > 59
              PERFORM INI-RTL-HEAD-REPORT.
           IF SRT-COD-TIPO IN SRT NOT = RPT-CTRL-COD-TIPO
              PERFORM INI-RTL-CTRL-REPORT
              PERFORM INI-RTL-HEAD-REPORT.
           ADD WSS-NUM-TLIN IN WSS-RTL    TO RPT-SUMA-NUM-TLIN
           ADD WSS-VAL-ATRZ IN WSS-RTL    TO RPT-SUMA-VAL-ATRZ
           ADD WSS-VAL-UTIL IN WSS-RTL    TO RPT-SUMA-VAL-UTIL
           ADD WSS-NUM-TLIN IN WSS-RTL    TO RPT-SUMA-BCO-TLIN
           ADD WSS-VAL-ATRZ IN WSS-RTL    TO RPT-SUMA-BCO-ATRZ
           ADD WSS-VAL-UTIL IN WSS-RTL    TO RPT-SUMA-BCO-UTIL
           WRITE RPTRTL-REG FROM  DL-RTL-08.
           ADD 1 TO RPT-RTL-VARI-LINEA.
       FIN-GENERATE-DL-RTL.
       FIN-GEN-DL-RTL.
           EXIT.

       INI-GEN-DL-RBC SECTION.
       GENERATE-DL-RBC.
      *    MOVE SRT-COD-TIPO IN SRT       TO RPT-RBC-DETA-COD-TIPO
           MOVE SPACES                    TO RPT-RBC-DETA-COD-TIPO
           MOVE WSS-GLS-TIPO IN WSS-RBC   TO RPT-RBC-DETA-GLS-TIPO
           MOVE WSS-NUM-TLIN IN WSS-RBC   TO RPT-RBC-DETA-NUM-TLIN
           MOVE WSS-VAL-ATRZ IN WSS-RBC   TO RPT-RBC-DETA-VAL-ATRZ
           MOVE WSS-VAL-UTIL IN WSS-RBC   TO RPT-RBC-DETA-VAL-UTIL
           IF RPT-RBC-VARI-LINEA > 59
              PERFORM INI-RBC-HEAD-REPORT.
           ADD WSS-NUM-TLIN IN WSS-RBC    TO RPT-RBC-SUMA-BCO-TLIN
           ADD WSS-VAL-ATRZ IN WSS-RBC    TO RPT-RBC-SUMA-BCO-ATRZ
           ADD WSS-VAL-UTIL IN WSS-RBC    TO RPT-RBC-SUMA-BCO-UTIL
           WRITE RPTRBC-REG FROM  DL-RBC-07.
           ADD 1 TO RPT-RBC-VARI-LINEA.
       FIN-GENERATE-DL-RBC.
       FIN-GEN-DL-RBC.
           EXIT.

       INI-RTL-HEAD-REPORT SECTION.
       INI-RTL-HEADING.
           MOVE SRT-COD-TIPO IN SRT       TO RPT-CTRL-COD-TIPO
           MOVE RPT-DUSU                  TO RPT-RTL-HEAD-DUSU
           MOVE WSS-NUM-DHAS IN WSS-RTL   TO RPT-RTL-HEAD-NUM-DHAS
           MOVE WSS-NUM-MHAS IN WSS-RTL   TO RPT-RTL-HEAD-NUM-MHAS
           MOVE WSS-NUM-SHAS IN WSS-RTL   TO RPT-RTL-HEAD-NUM-SHAS
           MOVE WSS-NUM-AHAS IN WSS-RTL   TO RPT-RTL-HEAD-NUM-AHAS
           MOVE RPT-FDMA                  TO RPT-RTL-HEAD-FDMA
           MOVE RPT-DSIS                  TO RPT-RTL-HEAD-DSIS
           MOVE SRT-COD-TIPO IN SRT       TO RPT-RTL-HEAD-COD-TIPO
           MOVE WSS-GLS-TIPO IN WSS-RTL   TO RPT-RTL-HEAD-GLS-TIPO
           ADD 1 TO RPT-RTL-VARI-PAGE-COUNTER
           MOVE RPT-RTL-VARI-PAGE-COUNTER TO RPT-RTL-HEAD-PAGE-COUNTER
           MOVE SPACES TO RPTRTL-REG.
           WRITE RPTRTL-REG AFTER PAGE
           WRITE RPTRTL-REG FROM  PH-RTL-01
           WRITE RPTRTL-REG FROM  PH-RTL-02
           WRITE RPTRTL-REG FROM  PH-RTL-03
           WRITE RPTRTL-REG FROM  PH-RTL-04
           WRITE RPTRTL-REG FROM  PH-RTL-05
           WRITE RPTRTL-REG FROM  PH-RTL-06
           WRITE RPTRTL-REG FROM  PH-RTL-07
           MOVE 8 TO RPT-RTL-VARI-LINEA.
       FIN-RTL-HEADING.
       FIN-RTL-HEAD-REPORT.
           EXIT.

       INI-RTL-CTRL-REPORT SECTION.
       INI-RTL-CONTROL.
           IF SRT-COD-TIPO IN SRT NOT = RPT-CTRL-COD-TIPO
              MOVE WSS-GLS-LIN1 IN WSS-RTL TO RPT-RTL-FOOT-GLS-LIN1
              MOVE RPT-SUMA-NUM-TLIN       TO RPT-RTL-FOOT-NUM-TLIN
              MOVE RPT-SUMA-VAL-ATRZ       TO RPT-RTL-FOOT-VAL-ATRZ
              MOVE RPT-SUMA-VAL-UTIL       TO RPT-RTL-FOOT-VAL-UTIL
              MOVE 0 TO RPT-SUMA-NUM-TLIN
              MOVE 0 TO RPT-SUMA-VAL-ATRZ
              MOVE 0 TO RPT-SUMA-VAL-UTIL
              MOVE WSS-GLS-LIN2 IN WSS-RTL TO RPT-RTL-FOOT-GLS-LIN2
              WRITE RPTRTL-REG FROM  CF-RTL-09
              WRITE RPTRTL-REG FROM  CF-RTL-10
              WRITE RPTRTL-REG FROM  CF-RTL-11.
       FIN-RTL-CONTROL.
       FIN-RTL-CTRL-REPORT.
           EXIT.

       INI-RBC-HEAD-REPORT SECTION.
       INI-RBC-HEADING.
           MOVE RPT-DUSU                  TO RPT-RBC-HEAD-DUSU
           MOVE WSS-NUM-DHAS IN WSS-RBC   TO RPT-RBC-HEAD-NUM-DHAS
           MOVE WSS-NUM-MHAS IN WSS-RBC   TO RPT-RBC-HEAD-NUM-MHAS
           MOVE WSS-NUM-SHAS IN WSS-RBC   TO RPT-RBC-HEAD-NUM-SHAS
           MOVE WSS-NUM-AHAS IN WSS-RBC   TO RPT-RBC-HEAD-NUM-AHAS
           MOVE RPT-FDMA                  TO RPT-RBC-HEAD-FDMA
           MOVE RPT-DSIS                  TO RPT-RBC-HEAD-DSIS
           ADD 1 TO RPT-RBC-VARI-PAGE-COUNTER
           MOVE RPT-RBC-VARI-PAGE-COUNTER TO RPT-RBC-HEAD-PAGE-COUNTER
           MOVE SPACES TO RPTRBC-REG.
           WRITE RPTRBC-REG AFTER PAGE
           WRITE RPTRBC-REG FROM  PH-RBC-01
           WRITE RPTRBC-REG FROM  PH-RBC-02
           WRITE RPTRBC-REG FROM  PH-RBC-03
           WRITE RPTRBC-REG FROM  PH-RBC-04
           WRITE RPTRBC-REG FROM  PH-RBC-05
           WRITE RPTRBC-REG FROM  PH-RBC-06
           MOVE 7 TO RPT-RBC-VARI-LINEA.
       FIN-RBC-HEADING.
       FIN-RBC-HEAD-REPORT.
           EXIT.
       COPY LDCBFCLR.
       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.
       COPY GNSBGABT.

      *<<<< EOF

       CNV-ME-A-UF-ATRZ SECTION.
       INI-CNV-ME-A-UF-ATRZ.
      *CONVIERTE DE MONEDA EXTRANJERA A UF

           IF CLR-COD-VCLC IN CLR = WSS-COD-UF IN WSS-VARI
               GO TO FIN-CNV-ME-A-UF-ATRZ.

           IF CLR-COD-VCLC IN CLR = WSS-COD-PESO IN WSS-VARI
               COMPUTE WSS-VAL-ATRZ IN WSS-RTL ROUNDED =
                  WSS-VAL-ATRZ IN WSS-RTL  +
                ( CLR-VAL-CMAX IN CLR / WSS-SGV-VCAM-UF IN WSS-VARI )

               COMPUTE WSS-VAL-ATRZ IN WSS-RBC ROUNDED =
                WSS-VAL-ATRZ IN WSS-RBC  +
                ( CLR-VAL-CMAX IN CLR / WSS-SGV-VCAM-UF IN WSS-VARI )
               GO TO FIN-CNV-ME-A-UF-ATRZ.

      *PRIMERO CONVIERTE DE MONEDA EXTRANJERA A PESO
           MOVE CLR-VAL-CMAX IN CLR      TO TVC-VALO IN TVC-VARI.
           MOVE CLR-COD-VCLC IN CLR      TO TVC-MON1 IN TVC-VARI.
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI.
           MOVE WSS-NUM-DHOY IN WSS-VARI TO TVC-DCAM IN TVC-VARI.
           MOVE WSS-NUM-MHOY IN WSS-VARI TO TVC-MCAM IN TVC-VARI.
           MOVE WSS-NUM-SHOY IN WSS-VARI TO TVC-SCAM IN TVC-VARI.
           MOVE WSS-NUM-AHOY IN WSS-VARI TO TVC-ACAM IN TVC-VARI.
           MOVE 4                        TO PES-NUM-DECI IN PES-VARI.
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG IN TVC-VARI > SPACES
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                   TVC-MON1 IN TVC-VARI ' A : '
                   TVC-MON2 IN TVC-VARI ' AL : '
                   TVC-FCAM IN TVC-VARI
                   MOVE ZEROES TO WSS-SGV-UF IN WSS-VARI
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-CNV-ME-A-UF-ATRZ
           ELSE
               MOVE TVC-VALO IN TVC-VARI TO
                    WSS-SGV-UF IN WSS-VARI.

           COMPUTE WSS-VAL-ATRZ IN WSS-RTL ROUNDED =
              WSS-VAL-ATRZ IN WSS-RTL  +
              ( WSS-SGV-UF IN WSS-VARI / WSS-SGV-VCAM-UF IN WSS-VARI ).

           COMPUTE WSS-VAL-ATRZ IN WSS-RBC ROUNDED =
              WSS-VAL-ATRZ IN WSS-RBC  +
              ( WSS-SGV-UF IN WSS-VARI / WSS-SGV-VCAM-UF IN WSS-VARI ).

       FIN-CNV-ME-A-UF-ATRZ.
           EXIT.

       CNV-ME-A-UF-UTIL SECTION.
       INI-CNV-ME-A-UF-UTIL.
      *CONVIERTE DE MONEDA EXTRANJERA A UF

           IF CLR-COD-VCCF IN CLR = WSS-COD-UF IN WSS-VARI
               ADD CLR-VAL-CUTI IN CLR TO WSS-VAL-UTIL IN WSS-RTL
               ADD CLR-VAL-CUTI IN CLR TO WSS-VAL-UTIL IN WSS-RBC
               GO TO FIN-CNV-ME-A-UF-UTIL.

           IF CLR-COD-VCCF IN CLR = WSS-COD-PESO IN WSS-VARI
               COMPUTE WSS-VAL-UTIL IN WSS-RTL ROUNDED =
                  WSS-VAL-UTIL IN WSS-RTL      +
                ( CLR-VAL-CUTI IN CLR / WSS-SGV-VCAM-UF IN WSS-VARI )
               COMPUTE WSS-VAL-UTIL IN WSS-RBC ROUNDED =
                  WSS-VAL-UTIL IN WSS-RBC      +
                ( CLR-VAL-CUTI IN CLR / WSS-SGV-VCAM-UF IN WSS-VARI )
               GO TO FIN-CNV-ME-A-UF-UTIL.

      *PRIMERO CONVIERTE DE MONEDA EXTRANJERA A PESO
           MOVE CLR-VAL-CUTI IN CLR      TO TVC-VALO IN TVC-VARI.
           MOVE CLR-COD-VCCF IN CLR      TO TVC-MON1 IN TVC-VARI.
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI.
           MOVE WSS-NUM-DHOY IN WSS-VARI TO TVC-DCAM IN TVC-VARI.
           MOVE WSS-NUM-MHOY IN WSS-VARI TO TVC-MCAM IN TVC-VARI.
           MOVE WSS-NUM-SHOY IN WSS-VARI TO TVC-SCAM IN TVC-VARI.
           MOVE WSS-NUM-AHOY IN WSS-VARI TO TVC-ACAM IN TVC-VARI.
           MOVE 4                        TO PES-NUM-DECI IN PES-VARI.
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG IN TVC-VARI > SPACES
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                   TVC-MON1 IN TVC-VARI ' A : '
                   TVC-MON2 IN TVC-VARI ' AL : '
                   TVC-FCAM IN TVC-VARI
                   MOVE ZEROES TO WSS-SGV-UF IN WSS-VARI
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-CNV-ME-A-UF-UTIL
           ELSE
               MOVE TVC-VALO IN TVC-VARI TO
                    WSS-SGV-UF IN WSS-VARI.

           COMPUTE WSS-VAL-UTIL IN WSS-RTL ROUNDED =
              WSS-VAL-UTIL IN WSS-RTL      +
              ( WSS-SGV-UF IN WSS-VARI / WSS-SGV-VCAM-UF IN WSS-VARI ).

           COMPUTE WSS-VAL-UTIL IN WSS-RBC ROUNDED =
              WSS-VAL-UTIL IN WSS-RBC      +
              ( WSS-SGV-UF IN WSS-VARI / WSS-SGV-VCAM-UF IN WSS-VARI ).

       FIN-CNV-ME-A-UF-UTIL.
           EXIT.

       BUS-GLS-TIPO SECTION.
       INI-BUS-GLS-TIPO.
           MOVE 'DEU'               TO TAB-COD-SIST.
           MOVE 'TLC'               TO TAB-COD-TTAB IN TAB.
           MOVE CLR-COD-TIPO IN CLR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS > SPACES
               DISPLAY 'CODIGO INEXISTENTE TABLA TLC '
                       CLR-COD-TIPO IN CLR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIPO IN WSS-RBC
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIPO IN WSS-RTL.
       FIN-BUS-GLS-TIPO.
           EXIT.

       COPY GNSBGHOY.
       COPY GNSBBMSG.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBGPES.
       COPY TABBFCAM.
       COPY TABBGTVC.
      *>>>>
