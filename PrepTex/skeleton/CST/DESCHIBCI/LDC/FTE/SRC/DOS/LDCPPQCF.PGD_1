       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   LDCPPQCF.
       AUTHOR.       CONSIST.
       DATE-WRITTEN.  3-JAN-1996 12:29:43.

      * Consulta calificacion de un cliente a una fecha dada.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       01  SCR-VARI.
           05 SCR-SIST     VALUE 'LDC'    PIC X(03).

       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.
       COPY GNSWGFRM.
       COPY GNSWGHOY.

       COPY GNSWGQUE.
       COPY LDCWGQCF.

       COPY SGCBRDBC.
       COPY LDCBRRDC.
       COPY LDCBRCLF.
       COPY LDCBRLDC.
       COPY LDCBRARC.
       COPY LDCBRARG.
       COPY GNSWGFEC.
       COPY GNSWGSTR.

       01  WSS-VARI.
           03  WSS-CLF-CIC-ICLF VALUE SPACES          PIC X(12).
           03  WSS-CLF-MSC-STAT VALUE SPACES          PIC X(01).
           03  WSS-CLF-FEC-FAPE VALUE SPACES          PIC X(08).
           03  WSS-CLF-FEC-FCIE VALUE SPACES          PIC X(08).


           03  WSS-TYPE-R         COMP-3              PIC S9(07).
           03  WSS-TYPE   REDEFINES WSS-TYPE-R        PIC  X(04).
           03  WSS-ITEM.
               05  WSS-NOMB                           PIC X(06).
               05  WSS-DATA                           PIC X(241).
           03  WSS-FEC-CAND                           PIC 9(08).
           03  WSS-KEY-ICLF                           PIC X(12).
      *JSS-INI 3-MAR-1999
           03 WSS-FAMI       OCCURS 100 PIC X(03).
      *ALD-BCI-INI/06-JUL-1999
           03 WSS-APFA       OCCURS 100 PIC X(02).
      *ALD-BCI-FIN/06-JUL-1999
           03 WSS-MAXF                  PIC 9(03).
           03 WSS-LIMF                  PIC 9(03).
           03 WSS-AUXI                  PIC 9(03).
           03 WSS-ESTA                  PIC X(01).
              88 LDC-NO-ESTA VALUE 'N'.
              88 LDC-YA-ESTA VALUE 'S'.
           03 WSS-NUM-CORR              PIC 9(02).
           03 WSS-NUM-REAL              PIC 9(02).
      *JSS-FIN 3-MAR-1999

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ARG-REQA==.


       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           03 FILLER                            PIC X(219).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.

           IF QCF-CIC-ICLF IN QCF-CMMA > SPACES
              PERFORM LEE-CLF
              GO TO CON-PRO-QCF.
           IF QCF-IDC-ICLI IN QCF-CMMA > SPACES
              PERFORM BUS-CLF-IDC
              GO TO CON-PRO-QCF.
           IF QCF-GLS-NOMC IN QCF-CMMA > SPACES
              PERFORM BUS-CLF-NOM.

       CON-PRO-QCF.
           IF QCF-COD-MENS > SPACES
              GO TO MSG-MAIN.

           IF QCF-COD-CMND = 'ELI'
                PERFORM ELI-QCF
           ELSE
                PERFORM CON-QCF.

       MSG-MAIN.
           IF QCF-COD-MENS > SPACES
               MOVE 'LDC'        TO MSG-COD-SIST
               MOVE QCF-COD-MENS TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO QCF-GLS-MEN1.
           MOVE QCF-CMMA TO DFHCOMMAREA.
       FIN-MAIN.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           EXEC CICS RETURN END-EXEC.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.

           MOVE DFHCOMMAREA(1:EIBCALEN) TO QCF-CMMA.
           IF QCF-GLS-COLA NOT > SPACES
                MOVE 'GQCF' TO QCF-GLS-COLA-TERM
                MOVE EIBTASKN TO WSS-TYPE-R
                MOVE WSS-TYPE TO QCF-GLS-COLA-TYPE.

           MOVE 'LDCPPQCF'  TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI    TO SYS-CMMA.
           MOVE +507        TO SYS-TCMA.
           MOVE 'GNSPPIDD'  TO SYS-PROG.
           MOVE SYS-LINK    TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA TO IDD-VARI.
           PERFORM BORRA-COLA.
           MOVE SPACES      TO QCF-COD-MENS QCF-GLS-MENS.
           IF QCF-FEC-FCON IN QCF-CMMA NOT > SPACES OR
              QCF-FEC-FCON IN QCF-CMMA = ZEROES
               PERFORM GET-FHOY
               MOVE HOY-FHOY TO QCF-FEC-FCON IN QCF-CMMA.
      *JSS-INI 3-MAR-1999
           MOVE   0 TO WSS-LIMF.
           MOVE 100 TO WSS-MAXF.
           MOVE   0 TO WSS-NUM-CORR.
      *JSS-FIN 3-MAR-1999
       FIN-INI.
           EXIT.


       CON-QCF SECTION.
       INI-CON-QCF.

           PERFORM LEE-N-RDC.
           MOVE 'LDCCLF'   TO WSS-NOMB IN WSS-VARI.
           MOVE CLF        TO WSS-DATA IN WSS-VARI.
           PERFORM WRT-QUE.
           PERFORM LEE-LDC-ARC-ARG.

       FIN-CON-QCF.
           EXIT.

       ELI-QCF SECTION.
       INI-DEL-QCF.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE 'CLFEXI NEX'   TO QCF-COD-MENS
              GO TO FIN-DEL-QCF.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE 'CLFELI ERR'   TO QCF-COD-MENS
              GO TO FIN-DEL-QCF.

       CIC-DEL-RDC.
           MOVE CLF-CIC-ICLF IN CLF TO RDC-CIC-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDC
                MOVE FIO-GET-KEY-UPD TO FIO-CMND
                PERFORM LDC-FIO-RDC
                IF NOT FIO-STAT-OKS
                    MOVE 'RDCEXI NEX'   TO QCF-COD-MENS
                    GO TO FIN-DEL-QCF
                ELSE
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM LDC-FIO-RDC
                    IF NOT FIO-STAT-OKS
                        MOVE 'RDCDEL ERR'   TO QCF-COD-MENS
                        GO TO FIN-DEL-QCF
                    ELSE
                        GO TO CIC-DEL-RDC.

       CIC-DEL-LDC.
           MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = LDC-CIC-ICLF IN LDC
                MOVE FIO-GET-KEY-UPD TO FIO-CMND
                PERFORM LDC-FIO-LDC
                IF NOT FIO-STAT-OKS
                    MOVE 'LDCEXI NEX'   TO QCF-COD-MENS
                    GO TO FIN-DEL-QCF
                ELSE
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM LDC-FIO-LDC
                    IF NOT FIO-STAT-OKS
                        MOVE 'LDCDEL ERR'   TO QCF-COD-MENS
                        GO TO FIN-DEL-QCF
                    ELSE
                        GO TO CIC-DEL-LDC.

       CIC-DEL-ARC.

           MOVE CLF-CIC-ICLF IN CLF TO ARC-CIC-ICLF IN ARC.
           MOVE ZEROES              TO ARC-NUM-IARC IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARC.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = ARC-CIC-ICLF IN ARC
                MOVE FIO-GET-KEY-UPD TO FIO-CMND
                PERFORM LDC-FIO-ARC
                IF NOT FIO-STAT-OKS
                    MOVE 'ARCEXI NEX'   TO QCF-COD-MENS
                    GO TO FIN-DEL-QCF
                ELSE
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM LDC-FIO-ARC
                    IF NOT FIO-STAT-OKS
                        MOVE 'ARCDEL ERR'   TO QCF-COD-MENS
                        GO TO FIN-DEL-QCF
                    ELSE
                        GO TO CIC-DEL-ARC.

       CIC-DEL-ARG.

           MOVE CLF-CIC-ICLF IN CLF TO ARG-CIC-ICLF IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-ARG.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = ARG-CIC-ICLF IN ARG
                MOVE FIO-GET-KEY-UPD TO FIO-CMND
                PERFORM LDC-FIO-ARG
                IF NOT FIO-STAT-OKS
                    MOVE 'ARGEXI NEX'   TO QCF-COD-MENS
                    GO TO FIN-DEL-QCF
                ELSE
                    MOVE FIO-DEL TO FIO-CMND
                    PERFORM LDC-FIO-ARG
                    IF NOT FIO-STAT-OKS
                        MOVE 'ARGDEL ERR'   TO QCF-COD-MENS
                        GO TO FIN-DEL-QCF
                    ELSE
                        GO TO CIC-DEL-ARG.

       FIN-DEL-QCF.
           EXIT.

       BUS-CLF-IDC SECTION.
       INI-BUS-CLF-IDC.
      * Busca CIC del Cliente por medio de IdC Para Obtener CLF
           MOVE QCF-IDC-ICLI IN QCF-CMMA TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
              MOVE MSG-COD-MENS        TO QCF-COD-MENS
              MOVE DBC-GLS-NOMC IN DBC TO QCF-GLS-MENS
              GO TO FIN-BUS-CLF-IDC.
           PERFORM BUS-RDC-CLI.
           IF WSS-CLF-MSC-STAT = 'C' OR 'R'
               MOVE WSS-CLF-CIC-ICLF TO CLF-CIC-ICLF
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF.
       FIN-BUS-CLF-IDC.
           EXIT.


       BUS-CLF-NOM SECTION.
       INI-BUS-CLF-NOM.
      * Con el Nombre del Cliente lee el CIC para obtener la CLF
           MOVE QCF-GLS-NOMC IN QCF-CMMA TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO
                DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO
                DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO
                DBC-GLS-NOMB IN DBC
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
           MOVE FIO-GET-NLS    TO FIO-CMND
           PERFORM GET-CLI
           IF MSG-COD-MENS > SPACES
              MOVE MSG-COD-MENS TO QCF-COD-MENS
              MOVE DBC-GLS-NOMC IN DBC TO QCF-GLS-MENS
              GO TO FIN-BUS-CLF-NOM.
           PERFORM BUS-RDC-CLI.
       FIN-BUS-CLF-NOM.
           EXIT.

       LEE-CLF SECTION.
       INI-LEE-CLF.
           MOVE QCF-CIC-ICLF IN QCF-CMMA TO CLF-CIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
              MOVE 'CLF    NEX'   TO QCF-COD-MENS.
       FIN-LEE-CLF.
           EXIT.

       BORRA-COLA SECTION.
       INI-BORRA-COLA.
           PERFORM GNS-ERR-QUE.
           MOVE QCF-GLS-COLA  TO QUE-COLA.
           MOVE QUE-DEL       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-BORRA-COLA.
           EXIT.

       LEE-LDC-ARC-ARG SECTION.
       INI-LEE-LDC-ARC-ARG.
           MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES              TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-LDC.
           PERFORM LDC-FIO-LDC.
           IF NOT (FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = LDC-CIC-ICLF IN LDC)
                GO TO FIN-LEE-LDC-ARC-ARG.

      *JSS-INI 3-MAR-1999
           IF LDC-COD-FAMI IN LDC > SPACES
               PERFORM VER-SI-ESTA
               IF LDC-YA-ESTA
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-LDC.
           ADD 1                    TO WSS-NUM-CORR.
           MOVE LDC-NUM-ILDC IN LDC TO WSS-NUM-REAL.
      *JSS-FIN 3-MAR-1999

           IF LDC-IND-MGAR IN LDC = 'U'
               MOVE LDC-KEY-ILDC IN LDC TO ARG-KEY-ILDC IN ARG
               MOVE ZEROES              TO ARG-NUM-IARG IN ARG
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM LDC-FIO-ARG
               IF ARG-IIC-IGAR IN ARG > ZEROES
                   MOVE 'E' TO LDC-IND-MGAR IN LDC.
           MOVE 'LDCLDC' TO WSS-NOMB IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-CORR TO LDC-NUM-ILDC IN LDC.
      *JSS-FIN 23-MAR-1999
           MOVE LDC      TO WSS-DATA IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-REAL TO LDC-NUM-ILDC IN LDC.
      *JSS-FIN 23-MAR-1999
           PERFORM WRT-QUE.

           MOVE LDC-KEY-ILDC IN LDC TO ARC-KEY-ILDC IN ARC.
           MOVE ZEROES              TO ARC-NUM-IARC IN ARC.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-ARC.
           PERFORM LDC-FIO-ARC.
           IF NOT (FIO-STAT-OKS AND
              LDC-KEY-ILDC IN LDC = ARC-KEY-ILDC IN ARC )
                 GO TO CON-ARC.

           MOVE 'LDCARC' TO WSS-NOMB IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-CORR TO ARC-NUM-ILDC IN ARC.
      *JSS-FIN 23-MAR-1999
           MOVE ARC      TO WSS-DATA IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-REAL TO ARC-NUM-ILDC IN ARC.
      *JSS-FIN 23-MAR-1999
           PERFORM WRT-QUE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ARC.

       CON-ARC.
           MOVE LDC-KEY-ILDC IN LDC TO ARG-KEY-ILDC IN ARG.
           MOVE ZEROES              TO ARG-NUM-IARG IN ARG.
           MOVE FIO-GET-NLS TO FIO-CMND.

       LUP-ARG.
           PERFORM LDC-FIO-ARG.
           IF NOT (FIO-STAT-OKS AND
              LDC-KEY-ILDC IN LDC = ARG-KEY-ILDC IN ARG )
                GO TO CON-ARG.

           MOVE 'LDCARG' TO WSS-NOMB IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-CORR TO ARG-NUM-ILDC IN ARG.
      *JSS-FIN 23-MAR-1999
           MOVE ARG      TO WSS-DATA IN WSS-VARI.
      *JSS-INI 23-MAR-1999
           MOVE WSS-NUM-REAL TO ARG-NUM-ILDC IN ARG.
      *JSS-FIN 23-MAR-1999
           PERFORM WRT-QUE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ARG.

       CON-ARG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-LEE-LDC.

       FIN-LEE-LDC-ARC-ARG.
           EXIT.

      *JSS-INI 3-MAR-1999
       VER-SI-ESTA SECTION.
       INI-VER-SI-ESTA.
           MOVE SPACES TO QCF-COD-MENS.
           MOVE 'S' TO WSS-ESTA.
           MOVE 0   TO WSS-AUXI.
       LUP-VER-SI-ESTA.
           ADD 1 TO WSS-AUXI.
           IF WSS-AUXI > WSS-LIMF
               GO TO CON-VER-SI-ESTA.
      *ALD-BCI-INI/06-JUL-1999
           IF LDC-COD-FAMI IN LDC = WSS-FAMI(WSS-AUXI) AND
              LDC-COD-APFA IN LDC = WSS-APFA(WSS-AUXI)
      *ALD-BCI-FIN/06-JUL-1999
               GO TO FIN-VER-SI-ESTA.
           GO TO LUP-VER-SI-ESTA.
       CON-VER-SI-ESTA.
           MOVE 'N' TO WSS-ESTA.
           IF WSS-LIMF NOT < WSS-MAXF
               MOVE 'FAMLIMFOVFLW' TO QCF-COD-MENS
               GO TO FIN-VER-SI-ESTA.
           ADD 1 TO WSS-LIMF.
           MOVE LDC-COD-FAMI IN LDC TO WSS-FAMI(WSS-LIMF).
      *ALD-BCI-INI/06-JUL-1999
           MOVE LDC-COD-APFA IN LDC TO WSS-APFA(WSS-LIMF).
      *ALD-BCI-FIN/06-JUL-1999
           MOVE LDC-COD-FAMI IN LDC TO LDC-COD-TIPO IN LDC.
       FIN-VER-SI-ESTA.
           EXIT.
      *JSS-FIN 3-MAR-1999

       LEE-N-RDC SECTION.
       INI-LEE-N-RDC.
           MOVE CLF-KEY-ICLF IN CLF TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS  TO FIO-CMND.

       LUP-RDC.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           PERFORM LDC-FIO-RDC.
           IF ( FIO-STAT-OKS AND
              RDC-KEY-ICLF IN RDC = CLF-KEY-ICLF IN CLF )
                MOVE 'LDCRDC' TO WSS-NOMB IN WSS-VARI
                MOVE RDC      TO WSS-DATA IN WSS-VARI
                PERFORM WRT-QUE
                PERFORM LEE-DBC
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO LUP-RDC.
       FIN-LEE-N-RDC.
           EXIT.

       BUS-RDC-CLI SECTION.
       INI-BUS-RDC-CLI.
           MOVE ZEROES TO WSS-FEC-CAND IN WSS-VARI.
           MOVE SPACES TO WSS-KEY-ICLF IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN DBC      TO RDC-CIC-ICLI IN RDC.
           MOVE LOW-VALUES               TO RDC-KEY-ICLF IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )
                 MOVE 'DEUCLFNEX' TO QCF-COD-MENS
                 GO TO FIN-BUS-RDC-CLI.

       LUP-BUS-RDC-CLI.
           MOVE RDC-KEY-ICLF IN RDC TO CLF-KEY-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'CLF    NEX' TO QCF-COD-MENS
               GO TO FIN-BUS-RDC-CLI.
      *    IF CLF-FEC-FAPE IN CLF > QCF-FEC-FCON IN QCF-CMMA
      *        GO TO NXT-BUS-RDC-CLI.
      *    IF CLF-FEC-FAPE IN CLF > WSS-FEC-CAND IN WSS-VARI
      *        MOVE CLF-KEY-ICLF IN CLF TO WSS-KEY-ICLF IN WSS-VARI
      *        MOVE CLF-FEC-FAPE IN CLF TO WSS-FEC-CAND IN WSS-VARI.
           IF CLF-MSC-STAT IN CLF = 'I' OR 'V' OR 'A'
               MOVE 'A' TO WSS-CLF-MSC-STAT
               GO TO FIN-BUS-RDC-CLI.
           IF CLF-MSC-STAT IN CLF = 'C'
                IF CLF-FEC-FCIE > WSS-CLF-FEC-FCIE
                    MOVE 'C' TO WSS-CLF-MSC-STAT
                    MOVE     CLF-FEC-FCIE TO
                         WSS-CLF-FEC-FCIE
                    MOVE     CLF-CIC-ICLF TO
                         WSS-CLF-CIC-ICLF
                ELSE
                    NEXT SENTENCE
           ELSE
           IF     CLF-MSC-STAT IN CLF = 'R' AND
              WSS-CLF-MSC-STAT = SPACES
                IF CLF-FEC-FAPE > WSS-CLF-FEC-FAPE
                     MOVE 'R' TO WSS-CLF-MSC-STAT
                     MOVE     CLF-FEC-FAPE IN CLF TO
                          WSS-CLF-FEC-FAPE
                          MOVE     CLF-CIC-ICLF TO
                               WSS-CLF-CIC-ICLF.



       NXT-BUS-RDC-CLI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
                 GO TO LUP-BUS-RDC-CLI.

           IF WSS-KEY-ICLF IN WSS-VARI > SPACES
               MOVE WSS-KEY-ICLF IN WSS-VARI TO CLF-KEY-ICLF IN CLF
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF
           ELSE
               MOVE 'DEUCLFNEX' TO QCF-COD-MENS.

       FIN-BUS-RDC-CLI.
           EXIT.

       WRT-QUE SECTION.
       INI-WRT-QUE.
           MOVE SPACES        TO QUE-ITEM.
           MOVE QCF-GLS-COLA  TO QUE-COLA.
           MOVE +247          TO QUE-LITM.
           MOVE WSS-ITEM      TO QUE-ITEM.
           MOVE QUE-PUT       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-WRT-QUE.
           EXIT.

       LEE-DBC SECTION.
       INI-LEE-DBC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBC    NEX' TO QCF-COD-MENS
               GO TO FIN-LEE-DBC.
           MOVE 'SGCDBC' TO WSS-NOMB IN WSS-VARI.
           MOVE DBC TO WSS-DATA IN WSS-VARI.
           PERFORM WRT-QUE.
       FIN-LEE-DBC.
           EXIT.

       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGMSG.
       COPY GNSBGHOY.
       COPY GNSBGQUE.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBFMSG.

       COPY SGCBFDBC.
       COPY GNSBGFEC.
       COPY GNSBGSTR.
       COPY LDCBFRDC.
       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY LDCBFARC.
       COPY LDCBFARG.
       COPY SGCBGCLI.


