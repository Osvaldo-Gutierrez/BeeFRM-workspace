      *
      * LDCBQLOM
      * Version 3.0.1 Nov-2005
      * 27-Mar-19 07:42 PM
      *
       SET-TAG-LDCBQLOM SECTION.
       INI-SET-TAG-LDCBQLOM.
           MOVE
           '<IDNMOD NOM=$LDCBQLOM$ VSN=$ $ VGM=$3.0.1$
      -    'GEN=$27-Mar-19 07:42 PM$ FNC=$ $/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBQLOM.
           EXIT.
           
       PUT-ALL-LOM SECTION.
       INI-PUT-ALL-LOM.
           PERFORM PUT-CLF-LOM.
           PERFORM PUT-DBC-LOM.
           PERFORM PUT-ACL-LOM.
       FIN-PUT-ALL-LOM.
           EXIT.
       
       PUT-CLF-LOM SECTION.
       INI-PUT-CLF-LOM.
           IF PGM-STAT-CLF-NUL
               GO TO FIN-PUT-CLF-LOM.
           IF NOT PGM-STAT-CLF-OKS
               PERFORM CLR-CLF-LOM
               GO TO FIN-PUT-CLF-LOM.
           MOVE CLF-COD-VCCF IN CLF TO CLF-COD-VCCF IN LOM-FLD.
           MOVE CLF-COD-TOCF IN CLF TO CLF-COD-TOCF IN LOM-FLD.
           MOVE CLF-COD-AOCF IN CLF TO CLF-COD-AOCF IN LOM-FLD.
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN LOM-FLD.
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN LOM-FLD.
           MOVE CLF-MSC-STAT IN CLF TO CLF-MSC-STAT IN LOM-FLD.
           MOVE CLF-COD-OFIC IN CLF TO CLF-COD-OFIC IN LOM-FLD.
           MOVE CLF-COD-EJEC IN CLF TO CLF-COD-EJEC IN LOM-FLD.
           MOVE CLF-VAL-CMAX IN CLF TO CLF-VAL-CMAX IN LOM-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CLF-NUM-DING IN CLF TO CLF-NUM-DING IN LOM-FLD.
           MOVE CLF-NUM-MING IN CLF TO CLF-NUM-MING IN LOM-FLD.
           MOVE CLF-NUM-SING IN CLF TO CLF-NUM-SING IN LOM-FLD.
           MOVE CLF-NUM-AING IN CLF TO CLF-NUM-AING IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CLF-NUM-DAPE IN CLF TO CLF-NUM-DAPE IN LOM-FLD.
           MOVE CLF-NUM-MAPE IN CLF TO CLF-NUM-MAPE IN LOM-FLD.
           MOVE CLF-NUM-SAPE IN CLF TO CLF-NUM-SAPE IN LOM-FLD.
           MOVE CLF-NUM-AAPE IN CLF TO CLF-NUM-AAPE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-VCCF IN LOM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-VCCF IN LOM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCCF IN LOM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCCF IN LOM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CLF-COD-TOCF IN LOM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN LOM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TOCF IN LOM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TOCF IN LOM-FLD.
      *BUS-OFI busca oficina en tablas
           IF CLF-COD-OFIC IN LOM-FLD > SPACES
               MOVE CLF-COD-OFIC IN LOM-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN LOM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN LOM-FLD.
      *BUS-USR busca usuario en tablas
           IF CLF-COD-EJEC IN LOM-FLD > SPACES
               MOVE CLF-COD-EJEC IN LOM-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN LOM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN LOM-FLD.
      *<<<<
      *BUS-MSC busca glosa de miscelaneo en tabla                               
           IF CLF-MSC-STAT IN LOM-FLD > SPACES                                  
              MOVE 'DEU' TO TAB-COD-SIST                                        
              MOVE 'ESP ' TO TAB-COD-TTAB IN TAB                                
              MOVE CLF-MSC-STAT IN LOM-FLD TO TAB-COD-CTAB IN TAB               
              PERFORM VAL-COD                                                   
              IF MSG-COD-MENS = 'COD    NEX' OR                                 
                 CLF-MSC-STAT IN LOM-FLD NOT > SPACES                           
                 MOVE SPACES TO FRM-GLS-STAT IN LOM-FLD                         
              ELSE                                                              
                 MOVE TAB-GLS-DESC IN TAB TO                                    
                    FRM-GLS-STAT IN LOM-FLD.                                    
      *BUS-MSC busca glosa de miscelaneo en tabla                               
           IF ACL-IND-PVIG IN LOM-FLD > SPACES                                  
               MOVE 'TAB' TO MSC-COD-SIST                                       
               MOVE 'IPER' TO MSC-COD-TMSC IN MSC                               
               MOVE ACL-IND-PVIG IN LOM-FLD TO MSC-COD-CMSC IN MSC              
               PERFORM BUS-MSC                                                  
               MOVE MSC-GLS-DCOR IN MSC TO                                      
                    FRM-GLS-PVIG IN LOM-FLD                                     
           ELSE                                                                 
               MOVE SPACES TO                                                   
                    FRM-GLS-PVIG IN LOM-FLD.                                    
      *BUS-TAB busca glosa de codigo en tabla                                   
           IF ACL-COD-LUGA IN LOM-FLD > SPACES                                  
               MOVE 'TAB' TO TAB-COD-SIST                                       
               MOVE 'COM ' TO TAB-COD-TTAB IN TAB                               
               MOVE ACL-COD-LUGA IN LOM-FLD TO TAB-COD-CTAB IN TAB              
               PERFORM BUS-TAB                                                  
               MOVE TAB-GLS-DESC IN TAB TO                                      
                    FRM-GLS-LUGA IN LOM-FLD                                     
               MOVE TAB TO COM                                                  
               MOVE SPACES              TO ACL-COD-CIUD IN ACL                  
               MOVE COM-COD-REGI IN COM TO ACL-COD-REGI IN ACL                  
               MOVE COM-GLS-CIUD IN COM TO FRM-GLS-CIUD IN LOM-FLD              
           ELSE                                                                 
               MOVE SPACES TO FRM-GLS-LUGA IN LOM-FLD                           
               MOVE SPACES TO FRM-GLS-CIUD IN LOM-FLD.                          
                                                                                
           IF ACL-COD-LUGA IN LOM-FLD > SPACES                                  
               MOVE 'TAB' TO TAB-COD-SIST                                       
               MOVE 'REG ' TO TAB-COD-TTAB IN TAB                               
               MOVE COM-COD-REGI IN COM TO TAB-COD-CTAB IN TAB                  
               PERFORM VAL-COD                                                  
               IF MSG-COD-MENS = 'COD    NEX'                                   
                   MOVE SPACES TO FRM-GLS-REGI IN LOM-FLD                       
               ELSE                                                             
                 MOVE TAB-GLS-DESC IN TAB TO                                    
                   FRM-GLS-REGI IN LOM-FLD.                                     
      *<<<<                                                                     
           IF ACL-COD-COGA IN LOM-FLD > SPACES                                  
               MOVE 'TAB' TO TAB-COD-SIST                                       
               MOVE 'AUX ' TO TAB-COD-TTAB IN TAB                               
               MOVE ACL-COD-COGA IN LOM-FLD TO TAB-COD-CTAB IN TAB              
               PERFORM BUS-TAB                                                  
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-COGA IN LOM-FLD          
           ELSE                                                                 
               MOVE SPACES TO FRM-GLS-COGA IN LOM-FLD.                          
                                                                                
           MOVE CLF-COD-OFIC IN CLF TO OFI-COD-OFIC IN OFI.                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM TAB-FIO-OFI.                                                 
           IF OFI-COD-JFOF IN OFI > SPACES                                      
               MOVE OFI-COD-JFOF IN OFI     TO USR-COD-USER IN USR              
               PERFORM BUS-USR                                                  
               MOVE USR-GLS-DCOR IN USR TO FRM-GLS-JDIR IN LOM-FLD              
           ELSE                                                                 
               MOVE SPACES TO FRM-GLS-JDIR IN LOM-FLD.                          
                                                                                
           IF CLF-COD-AOCF IN LOM-FLD > SPACES                                  
               MOVE 'TAB' TO TAB-COD-SIST                                       
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB                                
               MOVE CLF-COD-TOCF IN LOM-FLD TO                                  
                                    WSS-TIP-OPER IN WSS-VARI                    
               MOVE CLF-COD-AOCF IN LOM-FLD TO                                  
                                    WSS-STP-OPER IN WSS-VARI                    
               MOVE WSS-CLA-OPER IN WSS-VARI TO TAB-COD-CTAB IN TAB             
               PERFORM VAL-COD                                                  
               IF MSG-COD-MENS = 'COD    NEX' OR                                
                  CLF-COD-AOCF IN LOM-FLD NOT > SPACES                          
                  MOVE SPACES TO FRM-GLS-AOCF IN LOM-FLD                        
               ELSE                                                             
                  MOVE TAB-GLS-DCOR IN TAB TO                                   
                    FRM-GLS-AOCF IN LOM-FLD.                                    
      *<<<<                                                                     
       FIN-PUT-CLF-LOM.
           EXIT.
       
       PUT-DBC-LOM SECTION.
       INI-PUT-DBC-LOM.
      *<<<<
           IF SCR-IND-MCLI = 'M'                                                
               MOVE ZEROES TO DBC-NUM-ICLI IN LOM-FLD                           
               MOVE SPACES TO DBC-VRF-ICLI IN LOM-FLD                           
               MOVE SPACES TO DBC-IND-ICLI IN LOM-FLD                           
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LOM-FLD                     
               MOVE 'DEU' TO MSG-COD-SIST                                       
               MOVE 'CLF    MDEU' TO MSG-COD-MENS                               
               PERFORM GET-MSG                                                  
               MOVE 'M' TO DBC-IND-ICLI IN LOM-FLD                              
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN LOM-FLD                     
               GO TO FIN-PUT-DBC-LOM.                                           
                                                                                
      *>>>>
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-LOM.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-LOM
               GO TO FIN-PUT-DBC-LOM.
           MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN LOM-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN LOM-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN LOM-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN LOM-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN LOM-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN LOM-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN LOM-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
      *<<<<
           IF SCR-IND-MCLI NOT = 'M'                                            
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                             
               PERFORM CPT-BLKS                                                 
               MOVE CPT-STRN TO DBC-GLS-NOMC IN LOM-FLD.                        
                                                                                
           MOVE 'DEU'               TO FIO-SIST.                                
           MOVE 'VSN '              TO TAB-COD-TTAB IN TAB.                     
           MOVE 'INGEJECUTIVO'      TO TAB-COD-CTAB IN TAB.                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )                
               IF DBC-NUM-ICLI IN LOM-FLD NOT = ZEROES AND                      
                  CLF-COD-EJEC IN LOM-FLD NOT > SPACES                          
                   MOVE DBC-NUM-ICLI IN LOM-FLD TO DBC-NUM-ICLI IN DBC          
                   MOVE DBC-IND-ICLI IN LOM-FLD TO DBC-IND-ICLI IN DBC          
                   MOVE DBC-GLS-ICLI IN LOM-FLD TO DBC-GLS-ICLI IN DBC          
                   MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                             
                   MOVE FIO-GET-KEY TO FIO-CMND                                 
                   PERFORM SGC-FIO-DBC                                          
                   IF FIO-STAT-OKS AND DBC-COD-EJEC IN DBC > SPACES             
                       MOVE DBC-COD-EJEC IN DBC TO                              
                            CLF-COD-EJEC IN LOM-FLD                             
                       MOVE CLF-COD-EJEC IN LOM-FLD TO                          
                            USR-COD-USER IN USR                                 
                       PERFORM BUS-USR                                          
                       MOVE USR-GLS-DESC IN USR TO                              
                            FRM-GLS-EJEC IN LOM-FLD.                            
      *>>>>
       FIN-PUT-DBC-LOM.
           EXIT.
       
       PUT-ACL-LOM SECTION.
       INI-PUT-ACL-LOM.
           IF PGM-STAT-ACL-NUL
               GO TO FIN-PUT-ACL-LOM.
           IF NOT PGM-STAT-ACL-OKS
               PERFORM CLR-ACL-LOM
               GO TO FIN-PUT-ACL-LOM.
           MOVE ACL-GLS-NOMB IN ACL TO ACL-GLS-NOMB IN LOM-FLD.
           MOVE ACL-GLS-DES1 IN ACL TO ACL-GLS-DES1 IN LOM-FLD.
           MOVE ACL-GLS-DES2 IN ACL TO ACL-GLS-DES2 IN LOM-FLD.
           MOVE ACL-GLS-DES3 IN ACL TO ACL-GLS-DES3 IN LOM-FLD.
           MOVE ACL-GLS-DIRE IN ACL TO ACL-GLS-DIRE IN LOM-FLD.
           MOVE ACL-COD-LUGA IN ACL TO ACL-COD-LUGA IN LOM-FLD.
           MOVE ACL-COD-CIUD IN ACL TO ACL-COD-CIUD IN LOM-FLD.
           MOVE ACL-COD-REGI IN ACL TO ACL-COD-REGI IN LOM-FLD.
           MOVE ACL-VAL-MCON IN ACL TO ACL-VAL-MCON IN LOM-FLD.
           MOVE ACL-VAL-MSOL IN ACL TO ACL-VAL-MSOL IN LOM-FLD.
           MOVE ACL-NUM-PVIG IN ACL TO ACL-NUM-PVIG IN LOM-FLD.
           MOVE ACL-IND-PVIG IN ACL TO ACL-IND-PVIG IN LOM-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ACL-NUM-DINI IN ACL TO ACL-NUM-DINI IN LOM-FLD.
           MOVE ACL-NUM-MINI IN ACL TO ACL-NUM-MINI IN LOM-FLD.
           MOVE ACL-NUM-SINI IN ACL TO ACL-NUM-SINI IN LOM-FLD.
           MOVE ACL-NUM-AINI IN ACL TO ACL-NUM-AINI IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ACL-NUM-DIDE IN ACL TO ACL-NUM-DIDE IN LOM-FLD.
           MOVE ACL-NUM-MIDE IN ACL TO ACL-NUM-MIDE IN LOM-FLD.
           MOVE ACL-NUM-SIDE IN ACL TO ACL-NUM-SIDE IN LOM-FLD.
           MOVE ACL-NUM-AIDE IN ACL TO ACL-NUM-AIDE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE ACL-NUM-DFDE IN ACL TO ACL-NUM-DFDE IN LOM-FLD.
           MOVE ACL-NUM-MFDE IN ACL TO ACL-NUM-MFDE IN LOM-FLD.
           MOVE ACL-NUM-SFDE IN ACL TO ACL-NUM-SFDE IN LOM-FLD.
           MOVE ACL-NUM-AFDE IN ACL TO ACL-NUM-AFDE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE ACL-GLS-MAIL IN ACL TO ACL-GLS-MAIL IN LOM-FLD.
           MOVE ACL-COD-COGA IN ACL TO ACL-COD-COGA IN LOM-FLD.
           MOVE ACL-GLS-DGAR IN ACL TO ACL-GLS-DGAR IN LOM-FLD.
       FIN-PUT-ACL-LOM.
           EXIT.
       
       KEY-ALL-LOM SECTION.
       INI-KEY-ALL-LOM.
           PERFORM KEY-CLF-LOM.
           PERFORM KEY-DBC-LOM.
           PERFORM KEY-ACL-LOM.
       FIN-KEY-ALL-LOM.
           EXIT.
       
       KEY-CLF-LOM SECTION.
       INI-KEY-CLF-LOM.
           MOVE CLF-CAI-ICLF IN LOM-FLD TO CLF-CAI-ICLF IN CLF.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO CLF-IIC-ICLF IN CLF.
       FIN-KEY-CLF-LOM.
           EXIT.
       
       KEY-DBC-LOM SECTION.
       INI-KEY-DBC-LOM.
           MOVE DBC-CAI-ICLI IN LOM-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN LOM-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE DBC-GLS-NOMC IN LOM-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN LOM-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN LOM-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN LOM-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN LOM-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-LOM.
           EXIT.
       
       KEY-ACL-LOM SECTION.
       INI-KEY-ACL-LOM.
       FIN-KEY-ACL-LOM.
           EXIT.
       
       SCR-CLRA-LOM SECTION.
       INI-SCR-CLRA-LOM.
           PERFORM CLR-KEY-LOM.
           PERFORM CLR-FLD-LOM.
       FIN-SCR-CLRA-LOM.
           EXIT.
       
       CLR-KEY-LOM SECTION.
       INI-CLR-KEY-LOM.
           MOVE SPACES TO CLF-CAI-ICLF IN LOM-FLD.
           MOVE ZEROES TO CLF-IIC-ICLF IN LOM-FLD.
           MOVE SPACES TO DBC-CAI-ICLI IN LOM-FLD.
           MOVE ZEROES TO DBC-IIC-ICLI IN LOM-FLD.
           MOVE SPACES TO DBC-GLS-NOMC IN LOM-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN LOM-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN LOM-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN LOM-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN LOM-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-LOM.
           EXIT.
       
       CLR-FLD-LOM SECTION.
       INI-CLR-FLD-LOM.
           MOVE SPACES TO FRM-GLS-VCCF IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-TOCF IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-AOCF IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-STAT IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-LUGA IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-CIUD IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-REGI IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-JDIR IN LOM-FLD.
           MOVE SPACES TO FRM-GLS-PVIG IN LOM-FLD.
           MOVE ZEROES TO FRM-VAL-APRY IN LOM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FAVA IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-COGA IN LOM-FLD.
           PERFORM CLR-CLF-LOM.
           PERFORM CLR-DBC-LOM.
           PERFORM CLR-ACL-LOM.
       FIN-CLR-FLD-LOM.
           EXIT.
       
       CLR-CLF-LOM SECTION.
       INI-CLR-CLF-LOM.
           MOVE SPACES TO CLF-COD-VCCF IN LOM-FLD.
           MOVE SPACES TO CLF-COD-TOCF IN LOM-FLD.
           MOVE SPACES TO CLF-COD-AOCF IN LOM-FLD.
           MOVE SPACES TO CLF-MSC-STAT IN LOM-FLD.
           MOVE SPACES TO CLF-COD-OFIC IN LOM-FLD.
           MOVE SPACES TO CLF-COD-EJEC IN LOM-FLD.
           MOVE ZEROES TO CLF-VAL-CMAX IN LOM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FING IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CLF-FEC-FAPE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-CLF-LOM.
           EXIT.
       
       CLR-DBC-LOM SECTION.
       INI-CLR-DBC-LOM.
       FIN-CLR-DBC-LOM.
           EXIT.
       
       CLR-ACL-LOM SECTION.
       INI-CLR-ACL-LOM.
           MOVE SPACES TO ACL-GLS-NOMB IN LOM-FLD.
           MOVE SPACES TO ACL-GLS-DES1 IN LOM-FLD.
           MOVE SPACES TO ACL-GLS-DES2 IN LOM-FLD.
           MOVE SPACES TO ACL-GLS-DES3 IN LOM-FLD.
           MOVE SPACES TO ACL-GLS-DIRE IN LOM-FLD.
           MOVE SPACES TO ACL-COD-LUGA IN LOM-FLD.
           MOVE SPACES TO ACL-COD-CIUD IN LOM-FLD.
           MOVE SPACES TO ACL-COD-REGI IN LOM-FLD.
           MOVE ZEROES TO ACL-VAL-MCON IN LOM-FLD.
           MOVE ZEROES TO ACL-VAL-MSOL IN LOM-FLD.
           MOVE ZEROES TO ACL-NUM-PVIG IN LOM-FLD.
           MOVE SPACES TO ACL-IND-PVIG IN LOM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ACL-FEC-FINI IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ACL-FEC-FIDE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO ACL-FEC-FFDE IN LOM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO ACL-GLS-MAIL IN LOM-FLD.
           MOVE SPACES TO ACL-COD-COGA IN LOM-FLD.
           MOVE SPACES TO ACL-GLS-DGAR IN LOM-FLD.
       FIN-CLR-ACL-LOM.
           EXIT.
       
       FST-KEY-LOM SECTION.
       INI-FST-KEY-LOM.
           MOVE -1 TO CLF-CAI-ICLF-LEN IN LOM-FLD.
      *<<<<
           IF SCR-CCPP NOT = 'ING'                                              
               GO TO FIN-FST-KEY-LOM.                                           
                                                                                
           MOVE 'TAB'                TO FIO-SIST.                               
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.                    
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB.                    
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF FIO-STAT-OKS AND                                                  
              TAB-IND-VIGE IN TAB = 'S'                                         
               MOVE FRM-CPIM-AEY TO CLF-CAI-ICLF-ATR IN LOM-FLD                 
               MOVE FRM-CPIM-AEY TO CLF-IIC-ICLF-ATR IN LOM-FLD                 
           ELSE                                                                 
               GO TO FIN-FST-KEY-LOM.                                           
      *>>>>
       FIN-FST-KEY-LOM.
           EXIT.
       
       FST-FLD-LOM SECTION.
       INI-FST-FLD-LOM.
           MOVE -1 TO CLF-COD-VCCF-LEN IN LOM-FLD.
      *<<<<
           MOVE FRM-CPIM-AEY TO CLF-MSC-STAT-ATR IN LOM-FLD.                    
                                                                                
           PERFORM GET-FHOY.                                                    
           IF SCR-CCPP = 'ING'                                                  
               MOVE HOY-DHOY TO CLF-NUM-DAPE IN LOM-FLD                         
               MOVE HOY-MHOY TO CLF-NUM-MAPE IN LOM-FLD                         
               MOVE HOY-SHOY TO CLF-NUM-SAPE IN LOM-FLD                         

               MOVE HOY-AHOY TO CLF-NUM-AAPE IN LOM-FLD.
                                                                                
           MOVE 'TAB'                TO FIO-SIST.                               
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.                    
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF FIO-STAT-OKS AND                                                  
              TAB-IND-VIGE IN TAB = 'S'                                         
               MOVE 'S' TO WSS-VSN-OCAI                                         
           ELSE                                                                 
               MOVE 'N' TO WSS-VSN-OCAI.                                        
                                                                                
                                                                                
      *>>>>
       FIN-FST-FLD-LOM.
           EXIT.
       
       PRO-KEY-LOM SECTION.
       INI-PRO-KEY-LOM.
           PERFORM PRO-IKY-LOM.
           PERFORM PRO-AKY-LOM.
           PERFORM PRO-MKY-LOM.
       FIN-PRO-KEY-LOM.
           EXIT.
       
       PRO-IKY-LOM SECTION.
       INI-PRO-IKY-LOM.
           MOVE FRM-CPIM-AEY TO CLF-CAI-ICLF-ATR IN LOM-FLD.
           MOVE FRM-CPIM-AEY TO CLF-IIC-ICLF-ATR IN LOM-FLD.
       FIN-PRO-IKY-LOM.
           EXIT.
       
       PRO-MKY-LOM SECTION.
       INI-PRO-MKY-LOM.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN LOM-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-MKY-LOM.
           EXIT.
       
       PRO-AKY-LOM SECTION.
       INI-PRO-AKY-LOM.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN LOM-FLD.
       FIN-PRO-AKY-LOM.
           EXIT.
       
       UNP-KEY-LOM SECTION.
       INI-UNP-KEY-LOM.
           PERFORM UNP-IKY-LOM.
           PERFORM UNP-AKY-LOM.
           PERFORM UNP-MKY-LOM.
       FIN-UNP-KEY-LOM.
           EXIT.
       
       UNP-IKY-LOM SECTION.
       INI-UNP-IKY-LOM.
           MOVE FRM-CPIM-UBY TO CLF-CAI-ICLF-ATR.
           MOVE FRM-CPIM-UBY TO CLF-IIC-ICLF-ATR.
       FIN-UNP-IKY-LOM.
           EXIT.
       
       UNP-MKY-LOM SECTION.
       INI-UNP-MKY-LOM.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN LOM-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-MKY-LOM.
           EXIT.
       
       UNP-AKY-LOM SECTION.
       INI-UNP-AKY-LOM.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-LOM.
           EXIT.
       
       UNP-FLD-LOM SECTION.
       INI-UNP-FLD-LOM.
           PERFORM UNP-CLF-LOM.
           PERFORM UNP-DBC-LOM.
           PERFORM UNP-ACL-LOM.
       FIN-UNP-FLD-LOM.
           EXIT.
       
       UNP-CLF-LOM SECTION.
       INI-UNP-CLF-LOM.
           MOVE FRM-CPIM-UBY TO CLF-COD-VCCF-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-TOCF-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-AOCF-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-MSC-STAT-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-OFIC-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-COD-EJEC-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO CLF-VAL-CMAX-ATR IN LOM-FLD.
       FIN-UNP-CLF-LOM.
           EXIT.
       
       UNP-DBC-LOM SECTION.
       INI-UNP-DBC-LOM.
       FIN-UNP-DBC-LOM.
           EXIT.
       
       UNP-ACL-LOM SECTION.
       INI-UNP-ACL-LOM.
           MOVE FRM-CPIM-UBY TO ACL-GLS-NOMB-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-DES1-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-DES2-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-DES3-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-DIRE-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-COD-LUGA-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-VAL-MCON-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-VAL-MSOL-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-NUM-PVIG-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-IND-PVIG-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-FEC-FINI-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-FEC-FFDE-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-MAIL-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-COD-COGA-ATR IN LOM-FLD.
           MOVE FRM-CPIM-UBY TO ACL-GLS-DGAR-ATR IN LOM-FLD.
       FIN-UNP-ACL-LOM.
           EXIT.
       
       VAL-KEY-LOM SECTION.
       INI-VAL-KEY-LOM.
           PERFORM VAL-IKY-LOM.
           PERFORM VAL-MKY-LOM.
           PERFORM VAL-AKY-LOM.
       FIN-VAL-KEY-LOM.
           EXIT.
       
       VAL-IKY-LOM SECTION.
       INI-VAL-IKY-LOM.
           PERFORM VAL-CLF-CAI-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-CAI-ICLF-LEN IN LOM-FLD
                GO TO FIN-VAL-IKY-LOM.
           PERFORM VAL-CLF-IIC-ICLF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CLF-IIC-ICLF-LEN IN LOM-FLD
                GO TO FIN-VAL-IKY-LOM.
       FIN-VAL-IKY-LOM.
           EXIT.
       
       VAL-MKY-LOM SECTION.
       INI-VAL-MKY-LOM.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-CAI-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-IIC-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-MKY-LOM.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-MKY-LOM.
           EXIT.
       
       VAL-AKY-LOM SECTION.
       INI-VAL-AKY-LOM.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN LOM-FLD
                GO TO FIN-VAL-AKY-LOM.
       FIN-VAL-AKY-LOM.
           EXIT.
       
       VAL-CLF-CAI-ICLF SECTION.
       INI-VAL-CLF-CAI-ICLF.
           IF CLF-CAI-ICLF IN LOM-FLD NOT > SPACES
              MOVE SPACES TO CLF-CAI-ICLF IN LOM-FLD.
       FIN-VAL-CLF-CAI-ICLF.
           EXIT.
       
       VAL-CLF-IIC-ICLF SECTION.
       INI-VAL-CLF-IIC-ICLF.
      *<<<< CLF_IIC_ICLF                                                        
           IF CLF-IIC-ICLF IN LOM-FLD NOT > ZEROES                              
               GO TO FIN-VAL-CLF-IIC-ICLF.                                      
      *>>>>                                                                     
       FIN-VAL-CLF-IIC-ICLF.
           EXIT.
       
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN LOM-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN LOM-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<<
           IF DBC-IND-ICLI IN LOM-FLD = 'M'                                     
               MOVE ZEROES TO DBC-NUM-ICLI IN LOM-FLD                           
               MOVE SPACES TO DBC-VRF-ICLI IN LOM-FLD                           
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LOM-FLD                     
               GO TO FIN-VAL-DBC-NUM-ICLI.                                      
                                                                                
            IF SCR-CCPP NOT = 'ING'                                             
               GO TO FIN-VAL-DBC-NUM-ICLI.                                      
                                                                                
            IF DBC-NUM-ICLI IN LOM-FLD = ZEROES                                 
                MOVE 'TAB'        TO MSG-COD-SIST                               
                MOVE 'CLI    OBLIG' TO MSG-COD-MENS                             
                PERFORM GET-MSG                                                 
                MOVE MSG-GLS-DESC TO FRM-MENS                                   
                MOVE FRM-SUAR-MAL TO FRM-SUAR                                   
                GO TO FIN-VAL-DBC-NUM-ICLI.                                     
      *>>>>
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN LOM-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN LOM-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN LOM-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN LOM-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<<
           IF DBC-IND-ICLI IN LOM-FLD = 'M'                                     
               MOVE ZEROES TO DBC-NUM-ICLI IN LOM-FLD                           
               MOVE SPACES TO DBC-VRF-ICLI IN LOM-FLD                           
               MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LOM-FLD                     
               MOVE 'DEU'          TO MSG-COD-SIST                              
               MOVE 'CLF    MDEU'  TO MSG-COD-MENS                              
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN LOM-FLD                     
               GO TO FIN-VAL-DBC-VRF-ICLI.                                      

           IF DBC-NUM-ICLI IN LOM-FLD NOT = ZEROES
               MOVE DBC-NUM-ICLI IN LOM-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN LOM-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN LOM-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO DBC-GLS-NOMC IN LOM-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE

                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN LOM-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO
                        DBC-IIC-ICLI IN LOM-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN LOM-FLD.
           IF SCR-CCPP = 'ING'                                                  
               PERFORM VAL-CON-RDC-CLF                                          
               IF WSS-IND-ICLF IN WSS-VARI NOT = 'S'                            
                  MOVE 'DEU'        TO MSG-COD-SIST                             
                  MOVE 'CLF    ERR' TO MSG-COD-MENS                             
                  PERFORM GET-MSG                                               
                  MOVE MSG-GLS-DESC TO FRM-MENS                                 
                  GO TO FIN-VAL-DBC-VRF-ICLI                                    
               ELSE                                                             
                  IF MSG-COD-MENS > SPACES                                      
                     MOVE FRM-SUAR-MAL TO FRM-SUAR                              
                     GO TO FIN-VAL-DBC-VRF-ICLI.                                
                                                                                
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN LOM-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN LOM-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN LOM-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN LOM-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN LOM-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN LOM-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN LOM-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN LOM-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-KEY-LOM SECTION.
       INI-VAL-CON-KEY-LOM.
      *<<<< INI_VAL_CON_KEY_CLF                                                 
           IF CLF-IIC-ICLF IN LOM-FLD NOT > ZEROES                              
              AND DBC-GLS-NOMC IN LOM-FLD NOT > SPACES                          
              AND DBC-NUM-ICLI IN LOM-FLD = ZEROES                              
                PERFORM ERR-KEY                                                 
                PERFORM FST-KEY-LOM.                                            
                                                                                
           GO TO FIN-VAL-CON-KEY-LOM.                                           
      *>>>>                                                                     
           IF     CLF-CAI-ICLF IN LOM-FLD NOT > SPACES 
              AND CLF-IIC-ICLF IN LOM-FLD NOT > ZEROES 
              AND DBC-CAI-ICLI IN LOM-FLD NOT > SPACES 
              AND DBC-IIC-ICLI IN LOM-FLD NOT > ZEROES 
              AND DBC-GLS-NOMC IN LOM-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN LOM-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN LOM-FLD NOT > SPACES
              AND DBC-IND-ICLI IN LOM-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN LOM-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-LOM.
       FIN-VAL-CON-KEY-LOM.
           EXIT.
       
       VAL-CON-IKY-LOM SECTION.
       INI-VAL-CON-IKY-LOM.
      *<<<<
           IF CLF-IIC-ICLF IN LOM-FLD NOT > ZEROES                              
               MOVE CLF-CAI-ICLF IN LOM-FLD TO CIC-CAI-ICIC IN CIC              
               MOVE FIO-GET-KEY TO FIO-CMND                                     
               PERFORM GNS-FIO-CIC                                              
               IF NOT FIO-STAT-OKS                                              
                   MOVE CIC-STAT-NEX TO CIC-STAT                                
                   MOVE 'GNS'     TO MSG-COD-SIST                               
                   MOVE 'CICSTAT' TO MSG-COD-TMSG                               
                   MOVE CIC-STAT  TO MSG-COD-CMSG                               
                   PERFORM GET-MSG                                              
                   MOVE MSG-GLS-DESC IN MSG TO FRM-MENS                         
                   MOVE FRM-SUAR-MAL TO FRM-SUAR                                
               ELSE                                                             
                   IF CIC-IND-VIGE = 'N'                                        
                       MOVE CIC-STAT-NVG TO CIC-STAT                            
                       MOVE 'GNS'     TO MSG-COD-SIST                           
                       MOVE 'CICSTAT' TO MSG-COD-TMSG                           
                       MOVE CIC-STAT  TO MSG-COD-CMSG                           
                       PERFORM GET-MSG                                          
                       MOVE MSG-GLS-DESC IN MSG TO FRM-MENS                     
                       MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
                                                                                
           GO TO FIN-VAL-CON-IKY-LOM.                                           
                                                                                
      *>>>>
           IF     CLF-CAI-ICLF IN LOM-FLD NOT > SPACES 
              AND CLF-IIC-ICLF IN LOM-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-LOM.
       FIN-VAL-CON-IKY-LOM.
           EXIT.
       
       VAL-NUM-KEY-LOM SECTION.
       INI-VAL-NUM-KEY-LOM.
           PERFORM VAL-NUM-IKY-LOM.
           PERFORM VAL-NUM-MKY-LOM.
           PERFORM VAL-NUM-AKY-LOM.
       FIN-VAL-NUM-KEY-LOM.
           EXIT.
       
       VAL-NUM-IKY-LOM SECTION.
       INI-VAL-NUM-IKY-LOM.
       VAL-NUM-CLF-IIC-ICLF.
           MOVE CLF-IIC-ICLF-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CLF-IIC-ICLF IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-IIC-ICLF-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-IKY-LOM.
       FIN-VAL-NUM-IKY-LOM.
           EXIT.
       
       VAL-NUM-MKY-LOM SECTION.
       INI-VAL-NUM-MKY-LOM.
       VAL-NUM-DBC-IIC-ICLI.
           MOVE DBC-IIC-ICLI-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-IIC-ICLI IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-IIC-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-MKY-LOM.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-MKY-LOM.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-MKY-LOM.
           EXIT.
       
       VAL-NUM-AKY-LOM SECTION.
       INI-VAL-NUM-AKY-LOM.
       FIN-VAL-NUM-AKY-LOM.
           EXIT.
       
       VAL-NUM-FLD-LOM SECTION.
       INI-VAL-NUM-FLD-LOM.
       VAL-NUM-ACL-VAL-MCON.
           MOVE ACL-VAL-MCON-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO ACL-VAL-MCON IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ACL-VAL-MCON-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-FLD-LOM.
       VAL-NUM-ACL-VAL-MSOL.
           MOVE ACL-VAL-MSOL-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO ACL-VAL-MSOL IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ACL-VAL-MSOL-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-FLD-LOM.
       VAL-NUM-CLF-VAL-CMAX.
           MOVE CLF-VAL-CMAX-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CLF-VAL-CMAX IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CLF-VAL-CMAX-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-FLD-LOM.
       VAL-NUM-ACL-NUM-PVIG.
           MOVE ACL-NUM-PVIG-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO ACL-NUM-PVIG IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO ACL-NUM-PVIG-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-FLD-LOM.
       VAL-NUM-FRM-VAL-APRY.
           MOVE FRM-VAL-APRY-ALF IN LOM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-APRY IN LOM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-APRY-LEN IN LOM-FLD
                GO TO FIN-VAL-NUM-FLD-LOM.
       FIN-VAL-NUM-FLD-LOM.
           EXIT.
       
       EDT-KEY-LOM SECTION.
       INI-EDT-KEY-LOM.
           PERFORM EDT-IKY-LOM.
           PERFORM EDT-MKY-LOM.
           PERFORM EDT-AKY-LOM.
       FIN-EDT-KEY-LOM.
           EXIT.
       
       EDT-IKY-LOM SECTION.
       INI-EDT-IKY-LOM.
           IF CLF-IIC-ICLF-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-IIC-ICLF-LEN IN LOM-FLD
                GO TO FIN-EDT-IKY-LOM.
           MOVE CLF-IIC-ICLF IN LOM-FLD TO CLF-IIC-ICLF-EDT IN LOM-EDT.
           MOVE CLF-IIC-ICLF-EDT IN LOM-EDT TO 
                CLF-IIC-ICLF-ALF IN LOM-FLD.
       FIN-EDT-IKY-LOM.
           EXIT.
       
       EDT-MKY-LOM SECTION.
       INI-EDT-MKY-LOM.
           IF DBC-IIC-ICLI-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-IIC-ICLI-LEN IN LOM-FLD
                GO TO FIN-EDT-MKY-LOM.
           MOVE DBC-IIC-ICLI IN LOM-FLD TO DBC-IIC-ICLI-EDT IN LOM-EDT.
           MOVE DBC-IIC-ICLI-EDT IN LOM-EDT TO 
                DBC-IIC-ICLI-ALF IN LOM-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN LOM-FLD
                GO TO FIN-EDT-MKY-LOM.
           MOVE DBC-NUM-ICLI IN LOM-FLD TO
                DBC-NUM-ICLI-EDT IN LOM-EDT.
           MOVE DBC-NUM-ICLI-EDT IN LOM-EDT TO
                DBC-NUM-ICLI-ALF IN LOM-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-MKY-LOM.
           EXIT.
       
       EDT-AKY-LOM SECTION.
       INI-EDT-AKY-LOM.
       FIN-EDT-AKY-LOM.
           EXIT.
       
       EDT-FLD-LOM SECTION.
       INI-EDT-FLD-LOM.
           IF ACL-VAL-MCON-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ACL-VAL-MCON-LEN IN LOM-FLD
                GO TO FIN-EDT-FLD-LOM.
           MOVE ACL-VAL-MCON IN LOM-FLD TO ACL-VAL-MCON-EDT IN LOM-EDT.
           MOVE ACL-VAL-MCON-EDT IN LOM-EDT TO 
                ACL-VAL-MCON-ALF IN LOM-FLD.
           IF ACL-VAL-MSOL-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ACL-VAL-MSOL-LEN IN LOM-FLD
                GO TO FIN-EDT-FLD-LOM.
           MOVE ACL-VAL-MSOL IN LOM-FLD TO ACL-VAL-MSOL-EDT IN LOM-EDT.
           MOVE ACL-VAL-MSOL-EDT IN LOM-EDT TO 
                ACL-VAL-MSOL-ALF IN LOM-FLD.
           IF CLF-VAL-CMAX-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CLF-VAL-CMAX-LEN IN LOM-FLD
                GO TO FIN-EDT-FLD-LOM.
           MOVE CLF-VAL-CMAX IN LOM-FLD TO CLF-VAL-CMAX-EDT IN LOM-EDT.
           MOVE CLF-VAL-CMAX-EDT IN LOM-EDT TO 
                CLF-VAL-CMAX-ALF IN LOM-FLD.
           IF ACL-NUM-PVIG-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO ACL-NUM-PVIG-LEN IN LOM-FLD
                GO TO FIN-EDT-FLD-LOM.
           MOVE ACL-NUM-PVIG IN LOM-FLD TO ACL-NUM-PVIG-EDT IN LOM-EDT.
           MOVE ACL-NUM-PVIG-EDT IN LOM-EDT TO 
                ACL-NUM-PVIG-ALF IN LOM-FLD.
           IF FRM-VAL-APRY-LEN IN LOM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-APRY-LEN IN LOM-FLD
                GO TO FIN-EDT-FLD-LOM.
           MOVE FRM-VAL-APRY IN LOM-FLD TO FRM-VAL-APRY-EDT IN LOM-EDT.
           MOVE FRM-VAL-APRY-EDT IN LOM-EDT TO 
                FRM-VAL-APRY-ALF IN LOM-FLD.
       FIN-EDT-FLD-LOM.
           EXIT.
      *<<<<
       VAL-CON-RDC-CLF SECTION.                                                 
       INI-VAL-CON-RDC-CLF.                                                     
           MOVE SPACES TO MSG-COD-MENS.                                         
           MOVE 'N' TO WSS-IND-ICLF IN WSS-VARI.                                
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.                     
           MOVE SPACES              TO RDC-CAI-ICLF IN RDC.                     
           MOVE ZEROES              TO RDC-IIC-ICLF IN RDC.                     
                                                                                
           MOVE FIO-GET-NLS TO FIO-CMND.                                        
           PERFORM LDC-FIO-RDC.                                                 
           IF NOT ( FIO-STAT-OKS AND                                            
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )                 
              IF FIO-STAT-OKS                                                   
                  GO TO BRW-VAL-CON-RDC-CLF                                     
              ELSE                                                              
                  GO TO FIN-VAL-CON-RDC-CLF.                                    
                                                                                
       LUP-VAL-CON-RDC-CLF.                                                     
           MOVE RDC-CIC-ICLF IN RDC TO CLF-CIC-ICLF IN CLF.                     
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM LDC-FIO-CLF.                                                 
           IF NOT FIO-STAT-OKS                                                  
               MOVE 'DEU'        TO MSG-COD-SIST                                
               MOVE 'CLF    NEX' TO MSG-COD-MENS                                
               PERFORM GET-MSG                                                  
               MOVE MSG-GLS-DESC TO FRM-MENS                                    
               GO TO BRW-VAL-CON-RDC-CLF.                                       
                                                                                
           IF (CLF-MSC-STAT IN CLF = 'A' AND                                    
               CLF-COD-COCF IN CLF = 'CLF')                                     
               MOVE 'S' TO WSS-IND-ICLF IN WSS-VARI                             
               GO TO FIN-VAL-CON-RDC-CLF.                                       
                                                                                
       NXT-VAL-CON-RDC-CLF.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                        
           PERFORM LDC-FIO-RDC.                                                 
           IF ( FIO-STAT-OKS AND                                                
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC )                 
              GO TO LUP-VAL-CON-RDC-CLF.                                        
                                                                                
       BRW-VAL-CON-RDC-CLF.                                                     
           IF FIO-STAT-OKS                                                      
               MOVE FIO-END-BRW TO FIO-CMND                                     
               PERFORM LDC-FIO-RDC.                                             
       FIN-VAL-CON-RDC-CLF.                                                     
           EXIT.                                                                
      *>>>>                                                                     
