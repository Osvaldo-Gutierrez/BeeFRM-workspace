       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.       LDCPGMNX.
       AUTHOR.           BEE-TEAM(RVM).
       DATE-WRITTEN.     22-DEC-1997 (ULTIMA MODIFICACION).

      *RVM: PARA HACER ESTE PROGRAMA SE TOMO COMO BASE EL LDCPGALA
      *     (CARTOLA MULTILINEA)

      * PROGRAMA BATCH QUE CREA ARCHIVO DE PASO SEL, EN EL CUAL
      * SE GRABAN DATOS DE CLF, OPC, DLC Y CAN PARA LUEGO CORRER
      * PROGRAMA LDCPLMNX Y OBTENER LA CARTOLA COMEX.

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *=====================
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.

       INPUT-OUTPUT SECTION.
      *====================
       FILE-CONTROL.
      *-------------

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------

       WORKING-STORAGE SECTION.
      *-----------------------
      *RVM-CST-INI 12-SEP-1996
      * COPY LDCBRSEL.
       COPY LDCBRMNX.
      *RVM-CST-FIN 12-SEP-1996
       COPY LDCBRCLF.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY LDCBRLDC.
       COPY COLBROPC.
       COPY COLBRRDC.
       COPY COLBRCAN.
       COPY COLBRRCV.
       COPY COLBRVEN.
       COPY COLBRDLC.

       COPY COLWGVEN.
       COPY COLWGINT.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRCCT.
       COPY COLBRTOC.
       COPY COLBRROV.

       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
       COPY GNSWGSYS.
       COPY TABWGTVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY TABBRTIO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CCT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.

       01  WSS-VARI.
           03  WSS-FEC-FPA1.
               05  WSS-NUM-DPA1      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MPA1      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-SPA1      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-APA1      VALUE ZEROES     PIC 9(02).
           03  WSS-FEC-FPA2.
               05  WSS-NUM-DPA2      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MPA2      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-SPA2      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-APA2      VALUE ZEROES     PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-AINI      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MINI      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-DINI      VALUE ZEROES     PIC 9(02).
           03  WSS-FEC-FFIN.
               05  WSS-NUM-SFIN      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-AFIN      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MFIN      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-DFIN      VALUE ZEROES     PIC 9(02).
           03  WSS-FEC-FHOY.
               05  WSS-NUM-SHOY      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-AHOY      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-MHOY      VALUE ZEROES     PIC 9(02).
               05  WSS-NUM-DHOY      VALUE ZEROES     PIC 9(02).
           03  WSS-COD-VCOC.
               05  WSS-MSC-TVOC                       PIC X(01).
               05  WSS-COD-CVOC                       PIC X(03).
               05  WSS-COD-TCOC                       PIC X(02).
           03  WSS-PARAM.
               05  WSS-TIPO-PROC     VALUE SPACES     PIC X(01).
               05  FILLER            VALUE SPACES     PIC X(01).
               05  WSS-LDC.
                   07  WSS-LETRA     VALUE SPACES     PIC X(01).
                   07  WSS-OFIC      VALUE SPACES     PIC X(03).
                   07  WSS-NUMERO    VALUE ZEROES     PIC 9(08).

           03  WSS-SW-LAV            VALUE 'N'        PIC X(01).
           03  WSS-GLS-DAT3.
               05  FILLER                             PIC X(21).
               05  WSS-GLS-TRIO1                      PIC X(03).
               05  WSS-GLS-TRIO2                      PIC X(03).
               05  WSS-GLS-TRIO3                      PIC X(03).

           03  WSS-IND-PVEZ          VALUE 'S'        PIC X(01).
           03  WSS-SW-RECU           VALUE SPACES     PIC X(01).
           03  WSS-SW-DISPLAY        VALUE 'N'        PIC X(01).
      *    03  WSS-NUM-DISPLAY                        PIC  9(11)V9(4).
           03  WSS-NUM-DISPLAY                PIC ZZ.ZZZ.ZZZ.ZZ9,9999.
           03  WSS-CIC-ICLF          VALUE SPACES     PIC X(12).
      *VARIABLE PARA MOVER A REPORTE
           03  WSS-CIC-ICLF-RPT      VALUE SPACES     PIC X(12).
           03  WSS-COD-PESO          VALUE SPACES     PIC X(06).
           03  WSS-COD-TLDC          VALUE SPACES     PIC X(03).
      *     03  WSS-COD-TLAV          VALUE SPACES     PIC X(12).
      *     03  WSS-COD-TMEX          VALUE SPACES     PIC X(12).
           03  WSS-NUM-SELG1         VALUE ZEROES     PIC 9(06).
           03  WSS-NUM-SELG2         VALUE ZEROES     PIC 9(06).
           03  WSS-NUM-SELG3         VALUE ZEROES     PIC 9(06).
           03  WSS-NUM-SELG4         VALUE ZEROES     PIC 9(06).
           03  WSS-PROCESO-OPC       VALUE ' '        PIC X(01).
               88 PROCESO-OPC-OKS    VALUE 'S'.
           03  WSS-NUM-RBAD          VALUE ZEROES     PIC 9(01).
           03  WSS-NUM-ICAN                           PIC 9(03).
           03  WSS-NUM-IVCT                           PIC 9(03).
           03  WSS-RCV-FINA          VALUE ZEROES     PIC S9(11)V9(4).
           03  WSS-VAL-CAPI          VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-INTE          VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-REAJ          VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-IMPU          VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-SCRE          VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-CRED          VALUE ZEROES     PIC 9(11)V9(04).
      *

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
      *------------
       INI-MAIN.
      *
       COPY GNSBGEDB.
      *EFECTUA APERTURA DE ARCHIVOS
           PERFORM INICIO-MNX.

      *PROCESO PRINCIPAL
           PERFORM PROCESO-MNX.

      *CIERRA ARCHIVOS
           PERFORM FINAL-MNX.
      *
       FIN-MAIN.
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS  LDCPGMNX'.
           DISPLAY '----------------------'.
           DISPLAY 'REG. LDCSEL GRABADOS TIPO MLT  : '
                   WSS-NUM-SELG1 IN WSS-VARI.
           DISPLAY 'REG. LDCSEL GRABADOS TIPO DLC  : '
                   WSS-NUM-SELG2 IN WSS-VARI.
           DISPLAY 'REG. LDCSEL GRABADOS TIPO CAN  : '
                   WSS-NUM-SELG3 IN WSS-VARI.
           DISPLAY 'REG. LDCSEL GRABADOS TIPO OPC  : '
                   WSS-NUM-SELG4 IN WSS-VARI.
           DISPLAY ' '.
      *
           IF WSS-NUM-RBAD IN WSS-VARI > ZEROES
      *        PERFORM GNS-PRG-ABT
               MOVE 99 TO RETURN-CODE
               PERFORM PRG-ABT
           ELSE
               PERFORM GNS-PRO-END.

      ***********************************************************
      * PROCESO DE APERTURA DE ARCHIVOS Y LECTURA DE PARAMETROS *
      ***********************************************************
       INICIO-MNX SECTION.
      *---------------
       INI-INICIO-MNX.
           MOVE 'LDCPGMNX' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

      *APERTURA DE ARCHIVOS

      *LDCSEL (SECUENCIAL)
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCSEL '
               DISPLAY 'DE OUTPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *LDCCLF
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCCLF '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *LDCLDC
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-LDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCLDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *LDCRDC
           MOVE FIO-INP TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO LDCRDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLOPC
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLOPC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLRDC
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLRDC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLDLC
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLDLC '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLVEN
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLVEN'
               DISPLAY 'DE INPUT  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLRCV
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLRCV'
               DISPLAY 'DE INPUT  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COLCAN
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO COLCAN '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *TABCAM
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: AL ABRIR ARCHIVO TABCAM '
               DISPLAY 'DE INPUT :  '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *DEUTAB
           MOVE 'DEU'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO DEUTAB '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *TABTAB
           MOVE 'TAB'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO TABTAB '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *GNSTAB
           MOVE 'GNS'   TO FIO-SIST.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR AL ABRIR ARCHIVO GNSTAB '
               DISPLAY 'DE INPUT   '    FIO-STAT
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *RECIBE FECHAS DE PARAMETRO
           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA DE INICIO  (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FPA1 IN WSS-VARI.
           DISPLAY WSS-FEC-FPA1 IN WSS-VARI.

           DISPLAY ' '.
           DISPLAY 'INGRESE FECHA DE TERMINO (DDMMSSAA) : '.
           ACCEPT  WSS-FEC-FPA2 IN WSS-VARI.
           DISPLAY WSS-FEC-FPA2 IN WSS-VARI.

           DISPLAY 'INGRESE TIPO DE SELECCION : '.
           ACCEPT  WSS-PARAM.
           DISPLAY WSS-PARAM.
           IF WSS-TIPO-PROC NOT = '1'
               IF WSS-TIPO-PROC NOT = '2'
                   IF WSS-TIPO-PROC NOT = '3'
                       DISPLAY 'ERROR: EN TIPO DE PARAMETRO, '
                           'DEBE SER 1,2,3'
                       MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                       GO TO FIN-INICIO-MNX.

           DISPLAY 'INGRESE TIPO DE LINEA A BUSCAR (MLI O MLE) : '
           ACCEPT  WSS-COD-TLDC IN WSS-VARI.
           DISPLAY WSS-COD-TLDC IN WSS-VARI.
           IF WSS-COD-TLDC IN WSS-VARI NOT = 'MLI' AND
              WSS-COD-TLDC IN WSS-VARI NOT = 'MLE'
               DISPLAY 'ERROR: TIPO DE LINEA INVALIDO, DEBE SER'
                       ' MLI O MLE     : '
                       WSS-COD-TLDC   IN WSS-VARI
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *IND. DE DISPLAY
           DISPLAY 'INGRESE IND. DE DISPLAY (S/*) : '.
           ACCEPT  WSS-SW-DISPLAY.
           DISPLAY WSS-SW-DISPLAY.

      *CONVIERTE (DDMMSSAA) A (SSAAMMDD) PARAMETRO 1
           MOVE WSS-NUM-DPA1 IN WSS-VARI TO WSS-NUM-DINI IN WSS-VARI.
           MOVE WSS-NUM-MPA1 IN WSS-VARI TO WSS-NUM-MINI IN WSS-VARI.
           MOVE WSS-NUM-SPA1 IN WSS-VARI TO WSS-NUM-SINI IN WSS-VARI.
           MOVE WSS-NUM-APA1 IN WSS-VARI TO WSS-NUM-AINI IN WSS-VARI.

      *CONVIERTE (DDMMSSAA) A (SSAAMMDD) PARAMETRO 2
           MOVE WSS-NUM-DPA2 IN WSS-VARI TO WSS-NUM-DFIN IN WSS-VARI.
           MOVE WSS-NUM-MPA2 IN WSS-VARI TO WSS-NUM-MFIN IN WSS-VARI.
           MOVE WSS-NUM-SPA2 IN WSS-VARI TO WSS-NUM-SFIN IN WSS-VARI.
           MOVE WSS-NUM-APA2 IN WSS-VARI TO WSS-NUM-AFIN IN WSS-VARI.

      *VALIDA FECHA DE PARAMETRO 1
           MOVE WSS-FEC-FPA1 IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
      *    MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
      *    MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *VALIDA FECHA DE PARAMETRO 2
           MOVE WSS-FEC-FPA2 IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
      *    MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
      *    MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      *COMPARA FECHA 1 CON FECHA 2
           IF WSS-FEC-FINI IN WSS-VARI > WSS-FEC-FFIN IN WSS-VARI
               DISPLAY 'ERROR: FECHA 1 ES MAYOR QUE FECHA 2'
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-INICIO-MNX.

      * Obtiene Codigo LAV Mediante CIC
      *     MOVE 'DEU'          TO FIO-SIST.
      *     MOVE 'TLC'          TO TAB-CIC-TTAB IN TAB.
      *     MOVE 'MLI'          TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'ERROR: NO EXISTE CIC MLI : ' FIO-STAT
      *         MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
      *         GO TO FIN-INICIO-MNX.

      *     MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TLAV IN WSS-VARI.

      * Obtiene Codigo LAV Mediante CIC
      *     MOVE 'DEU'          TO FIO-SIST.
      *     MOVE 'TLC'          TO TAB-CIC-TTAB IN TAB.
      *     MOVE 'MLE'          TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'ERROR: NO EXISTE CIC MLE : ' FIO-STAT
      *         MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
      *         GO TO FIN-INICIO-MNX.

      *     MOVE TAB-COD-CTAB IN TAB TO WSS-COD-TMEX IN WSS-VARI.

           PERFORM OBT-COD-MNAC.

           PERFORM GET-FHOY.
           MOVE HOY-FHOY TO WSS-FEC-FHOY IN WSS-VARI.
       FIN-INICIO-MNX.
           EXIT.

       PROCESO-MNX SECTION.
      *--------------------
       INI-PROCESO-MNX.

           IF WSS-NUM-RBAD IN WSS-VARI > ZEROES
               GO TO FIN-PROCESO-MNX.

           IF WSS-TIPO-PROC NOT = '3'
               IF WSS-TIPO-PROC NOT = '2'
                   GO TO UNA-LDC.

      *LEE A PARTIR DESDE LA PRIMERA CLF
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTEN DATOS EN LDCCLF '
               DISPLAY 'PROCESO CANCELADO...'
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
               GO TO FIN-PROCESO-MNX.

      *RVM-CST-INI 14-AUG-1995
       UNA-LDC.
           IF WSS-TIPO-PROC = '1'
               MOVE FIO-GET-KEY TO FIO-CMND
               MOVE WSS-LDC TO CLF-CIC-ICLF IN CLF
               PERFORM LDC-FIO-CLF
               IF NOT FIO-STAT-OKS
                   DISPLAY 'ERROR: NO EXISTE CALIFICACION : ' WSS-LDC
                   GO TO FIN-PROCESO-MNX.
      *RVM-CST-FIN 14-AUG-1995

       LUP-PROCESO-MNX.

           IF NOT FIO-STAT-OKS
               GO TO FIN-PROCESO-MNX.

      *UNA CLF
           IF WSS-TIPO-PROC = '1' AND
              WSS-IND-PVEZ IN WSS-VARI NOT = 'S'
               GO TO FIN-PROCESO-MNX.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'CLF LEIDA ... : ' CLF-CIC-ICLF IN CLF.

      *OFICINA
           IF WSS-TIPO-PROC = '2' AND WSS-OFIC NOT = CLF-COD-OFIC IN CLF
               GO TO NXT-PROCESO-MNX.

      *RESPALDA PUNTERO DE CLF PARA RETOMAR DESPUES
           MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF IN WSS-VARI.

           IF CLF-MSC-STAT IN CLF NOT = 'A'
               GO TO NXT-PROCESO-MNX.

      *GUARDAR CLAVE DE CLF ORIGINAL (SI ES RENOVADA)
      *PARA MOSTRAR EN LISTADO
           MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF-RPT IN WSS-VARI.
       LUP-RENO-MNX.
           IF CLF-FEC-FAPE IN CLF > WSS-FEC-FFIN IN WSS-VARI
      *CHEQUEA SI CLF ES RENOVADA
               IF CLF-CIC-CREN IN CLF > SPACES
                   MOVE CLF-CIC-CREN IN CLF TO CLF-CIC-ICLF IN CLF
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM LDC-FIO-CLF
                   IF FIO-STAT-OKS
                       MOVE 'S' TO WSS-SW-RECU IN WSS-VARI
                       IF WSS-SW-DISPLAY = 'S'
                           DISPLAY 'LECTURA OK CLF ANT. : '
                            CLF-CIC-ICLF IN CLF
                           GO TO LUP-RENO-MNX
                       ELSE
                           GO TO LUP-RENO-MNX
                   ELSE
      *RVM-BCI-INI 28-OCT-1997
      *PARA CORREGIR QUE GET-KEY MALO CORTA GET-NLS
                       MOVE 'S' TO WSS-SW-RECU IN WSS-VARI
      *RVM-BCI-FIN 28-OCT-1997
                       IF WSS-SW-DISPLAY = 'S'
                           DISPLAY 'LECTURA MAL CLF ANT. : '
                            CLF-CIC-ICLF IN CLF    'FS : ' FIO-STAT
                           GO TO NXT-PROCESO-MNX
                       ELSE
                           GO TO NXT-PROCESO-MNX
               ELSE
                   GO TO NXT-PROCESO-MNX.

      *INDICADOR PARA SABER SI SE QUIERE LEER UNA SOLA OPERACION
           IF WSS-TIPO-PROC = '1'
               MOVE 'N' TO WSS-IND-PVEZ IN WSS-VARI.

           MOVE CLF-CIC-ICLF IN CLF TO LDC-CIC-ICLF IN LDC.
           MOVE ZEROES              TO LDC-NUM-ILDC IN LDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-LDC.
           PERFORM LDC-FIO-LDC.
           IF NOT ( FIO-STAT-OKS AND
                    CLF-CIC-ICLF IN CLF = LDC-CIC-ICLF IN LDC )
                 GO TO NXT-PROCESO-MNX.

            IF LDC-COD-TIPO IN LDC NOT = WSS-COD-TLDC IN WSS-VARI
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO LUP-LEE-LDC.

      *************************************************************
      *              INICIO DE PROCESOS PRINCIPALES               *
      *************************************************************
      *
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'PROCESANDO MLT ... : ' LDC-CIC-ICLF IN LDC ' '
                       LDC-NUM-ILDC IN LDC.

      *LEE LDCRDL (RDC)
           MOVE LDC-CIC-ICLF IN LDC TO RDC-CIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE LDCRDC ' RDC-CIC-ICLF IN RDL
               GO TO NXT-PROCESO-MNX.

      *INICIALIZA ACUMULADORES
           MOVE ZEROES TO WSS-VAL-CAPI IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTE IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-REAJ IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-IMPU IN WSS-VARI.

      *LEE COLRDC
           MOVE RDC-CIC-ICLI IN RDL TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PROCESO-RDC.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDL = RDC-CIC-ICLI IN RDC
               IF RDC-NUM-IDLC IN RDC = ZEROES
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM COL-FIO-OPC
                   IF FIO-STAT-OKS
                       MOVE 'S' TO WSS-PROCESO-OPC IN WSS-VARI
                       PERFORM PROCESO-OPC
                       IF PROCESO-OPC-OKS
                           PERFORM GRABAR-SEL-OPC
                           IF FIO-STAT-OKS
                               MOVE FIO-GET-NXT TO FIO-CMND
                               GO TO LUP-PROCESO-RDC
                           ELSE
                               DISPLAY 'ERROR: AL GRABAR REGISTRO TIPO'
                                  ' OPC  STATUS : ' FIO-STAT
                               GO TO ERR-PROCESO-MNX
                       ELSE
                           IF WSS-SW-DISPLAY = 'S'
                               DISPLAY '    AVISO: REGISTRO OPC : '
                                   OPC-CIC-IOPC IN OPC   '...RECHAZADO'
                               MOVE FIO-GET-NXT TO FIO-CMND
                               GO TO LUP-PROCESO-RDC
                           ELSE
                               MOVE FIO-GET-NXT TO FIO-CMND
                               GO TO LUP-PROCESO-RDC
                   ELSE
                       DISPLAY 'ERROR: NO EXISTE REGISTRO COLOPC '
                                   OPC-CIC-IOPC IN OPC
                       GO TO ERR-PROCESO-MNX
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-PROCESO-RDC
           ELSE
               IF FIO-CMND = FIO-GET-NLS
                   GO TO NXT-PROCESO-MNX.

      *ALD-BCI-INI/21.01.1999
           IF LDC-IND-VIGE IN LDC = 'S'          AND
              LDC-FEC-FVEN IN LDC < WSS-FEC-FINI AND
              WSS-NUM-SELG4       = ZEROES
               GO TO NXT-PROCESO-MNX.
      *ALD-BCI-FIN/21.01.1999

      *GRABAR REGISTROS
           PERFORM GRABAR-SEL-LAV.
           PERFORM GRABAR-SEL-DLC.
           PERFORM GRABAR-SEL-CAN.

       NXT-PROCESO-MNX.
           IF WSS-SW-RECU IN WSS-VARI = 'S'
      *RESTAURA PUNTERO DE CLF GUARDADO ANTERIORMENTE
               MOVE WSS-CIC-ICLF IN WSS-VARI TO CLF-CIC-ICLF IN CLF
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE SPACES TO WSS-CIC-ICLF IN WSS-VARI
               MOVE SPACES TO WSS-SW-RECU  IN WSS-VARI.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           GO TO LUP-PROCESO-MNX.

       ERR-PROCESO-MNX.
           DISPLAY '.....: AL PROCESAR CLF : ' CLF-CIC-ICLF IN CLF.
           MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI.
           GO TO FIN-PROCESO-MNX.

       FIN-PROCESO-MNX.
           EXIT.

       PROCESO-OPC SECTION.
       INI-PROCESO-OPC.
      *INICIALIZO ACUMULADORES
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'PROCESANDO OPC ... : ' OPC-CIC-IOPC IN OPC.

           MOVE 999    TO WSS-NUM-ICAN IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-IVCT IN WSS-VARI.
           MOVE ZEROES TO RCV-NUM-IVCT IN RCV.
           MOVE ZEROES TO VEN-FEC-FVEN IN VEN.
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
           MOVE SPACES TO VEN-IND-SCTB IN VEN.

      *ESTO SE HACE POR CADA OPC ASOCIADA A LA CLF
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FFIN IN WSS-VARI
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.

      *RVM-CST-INI 5-SEP-1996
      *CON ESTO SE IDENTIFICAN LAS OPERACIONES QUE PERTENECEN A COMEX
           IF OPC-COD-TOPC IN OPC NOT = 'G'
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.
      *RVM-CST-FIN 5-SEP-1996

      * VALIDA QUE OPC'S SEAN DE MULTIIMPORT O MULTIEXPORT
           PERFORM VALIDA-MIMMEX.
           IF TAB-COD-DAT3 IN TAB(8) = WSS-COD-TLDC IN WSS-VARI
               NEXT SENTENCE
           ELSE
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.


      *RVM-CST
      * 14-SEP-1995
      *    MOVE 'N' TO WSS-SW-LAV IN WSS-VARI.
      *    PERFORM CHEK-TIO-AUX.
      *    IF WSS-SW-LAV IN WSS-VARI NOT = 'S'
      *        MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
      *        GO TO FIN-PROCESO-OPC.
      * 14-SEP-1995

      *SUMA LAS CAN OCURRIDAS DENTRO DEL PERIODO
           PERFORM PROCESO-CAN.

           IF WSS-VAL-SCRE = ZEROES AND
              OPC-FEC-FINP IN OPC < WSS-FEC-FINI IN WSS-VARI
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.

           IF OPC-FEC-FINP IN OPC NOT < WSS-FEC-FINI IN WSS-VARI
               PERFORM PROCESO-DLC.

           IF WSS-NUM-RBAD IN WSS-VARI > ZEROES
               MOVE 'N' TO WSS-PROCESO-OPC IN WSS-VARI
               GO TO FIN-PROCESO-OPC.

           PERFORM BUSCAR-SIG-VCTO.

       FIN-PROCESO-OPC.
           EXIT.

       CHEK-TIO-AUX SECTION.
       INI-CHEK-TIO-AUX.

      *    MOVE 'N' TO WSS-SW-LAV IN WSS-VARI.

      *CHEQUEA QUE TIO DE TAB EN POSICION 52, 55 O 58 SEA LAV
           MOVE SPACES TO WSS-GLS-DAT3 IN WSS-VARI.
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB .
           IF MSG-COD-MENS NOT = SPACES
              DISPLAY 'ERROR: NO EXISTE TABTIO ' OPC-COD-TOOC IN OPC
           ELSE
              MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DAT3 IN WSS-VARI
              IF WSS-GLS-TRIO1 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI
              ELSE
              IF WSS-GLS-TRIO2 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI
              ELSE
              IF WSS-GLS-TRIO3 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI.

           IF WSS-SW-LAV IN WSS-VARI = 'S'
               GO TO FIN-CHEK-TIO-AUX.

      *CHEQUEA QUE AYX DE COL EN POSICION 52, 55 O 58 SEA LAV
           MOVE SPACES TO WSS-GLS-DAT3 IN WSS-VARI.
           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB .
           IF MSG-COD-MENS NOT = SPACES
              DISPLAY 'ERROR: NO EXISTE COLAUX ' OPC-COD-COOC IN OPC
           ELSE
              MOVE TAB-GLS-DAT3 IN TAB TO WSS-GLS-DAT3 IN WSS-VARI
              IF WSS-GLS-TRIO1 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI
              ELSE
              IF WSS-GLS-TRIO2 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI
              ELSE
              IF WSS-GLS-TRIO3 IN WSS-VARI = 'MLT'
                  MOVE 'S' TO WSS-SW-LAV IN WSS-VARI.

       FIN-CHEK-TIO-AUX.
           EXIT.

       PROCESO-CAN SECTION.
       INI-PROCESO-CAN.

           MOVE OPC-VAL-SCRE IN OPC TO WSS-VAL-SCRE IN WSS-VARI.

      *LEE CAN DEL MES ASOCIADA A OPC
           MOVE OPC-CIC-IOPC IN OPC TO CAN-CIC-IOPC IN CAN.
           MOVE ZEROES              TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PROCESO-CAN.
           PERFORM COL-FIO-CAN.
           IF NOT (FIO-STAT-OKS AND
                   OPC-CIC-IOPC IN OPC = CAN-CIC-IOPC IN CAN)
                    GO TO FIN-PROCESO-CAN.

           IF CAN-MSC-STAT IN CAN NOT = 'A' AND
              CAN-MSC-STAT IN CAN NOT = 'R'
               GO TO NXT-PROCESO-CAN.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'PROCESANDO CAN ... : ' CAN-CIC-IOPC IN CAN
                       ' ' CAN-NUM-ICAN IN CAN.

           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE SPACES              TO RCV-CIC-IOPV IN RCV.
           MOVE ZEROES              TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT (FIO-STAT-OKS AND
                   CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV AND
                   CAN-NUM-ICAN IN CAN = RCV-NUM-ICAN IN RCV)
               GO TO NXT-PROCESO-CAN.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'PROCESANDO RCV ... : ' RCV-CIC-IOPC IN RCV
                       ' ' RCV-NUM-ICAN IN RCV.

           IF CAN-FEC-FOUT IN CAN > WSS-FEC-FFIN IN WSS-VARI
               PERFORM DISPLAY-CAN-A
               COMPUTE WSS-VAL-SCRE IN WSS-VARI =
                       WSS-VAL-SCRE IN WSS-VARI + RCV-SGV-CAPI IN RCV
               IF CAN-NUM-ICAN IN CAN < WSS-NUM-ICAN IN WSS-VARI
                   MOVE CAN-NUM-ICAN IN CAN TO WSS-NUM-ICAN IN WSS-VARI
               ELSE
                   NEXT SENTENCE
           ELSE
           IF CAN-FEC-FOUT IN CAN NOT < WSS-FEC-FINI IN WSS-VARI AND
              CAN-FEC-FOUT IN CAN NOT > WSS-FEC-FFIN IN WSS-VARI
               PERFORM DISPLAY-CAN-B
               PERFORM CAL-REAJ-MNX
               PERFORM CAL-CAPI-MNX
               COMPUTE WSS-VAL-REAJ IN WSS-VARI =
                       WSS-VAL-REAJ IN WSS-VARI +
                       RCV-SGV-REAJ IN RCV
               PERFORM CAL-INTE-MNX.

           IF CAN-FEC-FOUT IN CAN NOT > WSS-FEC-FFIN IN WSS-VARI
               IF RCV-NUM-IVCT IN RCV > WSS-NUM-IVCT IN WSS-VARI
                   MOVE RCV-NUM-IVCT IN RCV TO WSS-NUM-IVCT IN WSS-VARI
                   MOVE RCV-SGV-FINA IN RCV TO WSS-RCV-FINA IN WSS-VARI
               ELSE
               IF RCV-NUM-IVCT IN RCV = WSS-NUM-IVCT IN WSS-VARI
                   ADD RCV-SGV-FINA IN RCV TO WSS-RCV-FINA IN WSS-VARI
               ELSE
                   NEXT SENTENCE.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'WSS-RCV-FINA : ' WSS-RCV-FINA IN WSS-VARI.

       NXT-PROCESO-CAN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PROCESO-CAN.

       FIN-PROCESO-CAN.
           EXIT.

       DISPLAY-CAN-A SECTION.
       INI-DISPLAY-CAN-A.
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '*** CAN PARA RESTAURAR SALDO : '
                       CAN-CIC-IOPC IN CAN.
       FIN-DISPLAY-CAN-A.
           EXIT.

       DISPLAY-CAN-B SECTION.
       INI-DISPLAY-CAN-B.
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '*** CAN CONSIDERADA EN EL PERIODO : '
                       CAN-CIC-IOPC IN CAN.

       FIN-DISPLAY-CAN-B.
           EXIT.

       CAL-REAJ-MNX SECTION.
       INI-CAL-REAJ-MNX.
      *<<< PARA CALCULAR EL VALOR DEL REAJUSTE (RCV-SGV-REAJ)
           MOVE RCV-SGV-CAPI IN RCV TO TVC-VALO IN TVC-VARI
           MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
           MOVE CAN-NUM-DCAN IN CAN TO TVC-DCAM IN TVC-VARI
           MOVE CAN-NUM-MCAN IN CAN TO TVC-MCAM IN TVC-VARI
           MOVE CAN-NUM-SCAN IN CAN TO TVC-SCAM IN TVC-VARI
           MOVE CAN-NUM-ACAN IN CAN TO TVC-ACAM IN TVC-VARI
           PERFORM TAB-PRO-TVC
           IF TVC-CMSG IN TVC-VARI > SPACES
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                    TVC-MON1 IN TVC-VARI ' A : '
                    TVC-MON2 IN TVC-VARI ' AL : '
                    TVC-FCAM IN TVC-VARI
                    MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                    GO TO FIN-CAL-REAJ-MNX
           ELSE
               MOVE TVC-VALO IN TVC-VARI TO RCV-SGV-REAJ IN RCV.

           MOVE RCV-SGV-CAPI IN RCV TO TVC-VALO IN TVC-VARI
           MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
           MOVE OPC-NUM-DCOL IN OPC TO TVC-DCAM IN TVC-VARI
           MOVE OPC-NUM-MCOL IN OPC TO TVC-MCAM IN TVC-VARI
           MOVE OPC-NUM-SCOL IN OPC TO TVC-SCAM IN TVC-VARI
           MOVE OPC-NUM-ACOL IN OPC TO TVC-ACAM IN TVC-VARI
           PERFORM TAB-PRO-TVC
           IF TVC-CMSG IN TVC-VARI > SPACES
                 DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                 TVC-MON1 IN TVC-VARI ' A : '
                 TVC-MON2 IN TVC-VARI ' AL : '
                 TVC-FCAM IN TVC-VARI
                 MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                 GO TO FIN-CAL-REAJ-MNX
           ELSE
               SUBTRACT TVC-VALO IN TVC-VARI FROM
                      RCV-SGV-REAJ IN RCV.
      *>>>
       FIN-CAL-REAJ-MNX.
           EXIT.

       CAL-INTE-MNX SECTION.
       INI-CAL-INTE-MNX.
      *CALCULA INTERES A FFIN
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   INI-CAL-INTE-MNX...'
               DISPLAY '    OPC-CIC-IOPC : ' OPC-CIC-IOPC IN OPC
               DISPLAY '    OPC-FEC-FCOL : ' OPC-FEC-FCOL IN OPC
               DISPLAY '    WSS-VAL-INTE : ' WSS-VAL-INTE IN WSS-VARI
               MOVE CAN-SGV-TPAG IN CAN TO WSS-NUM-DISPLAY
               DISPLAY '    CAN-SGV-TPAG : ' WSS-NUM-DISPLAY
               MOVE CAN-SGV-GAST IN CAN TO WSS-NUM-DISPLAY
               DISPLAY '    CAN-SGV-GAST : ' WSS-NUM-DISPLAY
               MOVE RCV-SGV-CAPI IN RCV TO WSS-NUM-DISPLAY
               DISPLAY '    RCV-SGV-CAPI : ' WSS-NUM-DISPLAY.

           IF OPC-MSC-TVOC IN OPC = '0'
               IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
                   COMPUTE WSS-VAL-INTE IN WSS-VARI =
                     WSS-VAL-INTE IN WSS-VARI +
                      CAN-SGV-TREN IN CAN +
                      CAN-SGV-TPAG IN CAN -
                      RCV-SGV-CAPI IN RCV -
                      CAN-SGV-GAST IN CAN
               ELSE
                   MOVE RCV-SGV-CAPI IN RCV TO TVC-VALO IN TVC-VARI
                   MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI
                   MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
                   MOVE OPC-NUM-DCOL IN OPC TO TVC-DCAM IN TVC-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO TVC-MCAM IN TVC-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO TVC-SCAM IN TVC-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO TVC-ACAM IN TVC-VARI
                   PERFORM TAB-PRO-TVC
                   IF TVC-CMSG IN TVC-VARI > SPACES
                       DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                         TVC-MON1 IN TVC-VARI ' A : '
                         TVC-MON2 IN TVC-VARI ' AL : '
                         TVC-FCAM IN TVC-VARI
                         MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                         GO TO FIN-CAL-INTE-MNX
                   ELSE
                      COMPUTE WSS-VAL-INTE IN WSS-VARI =
                        WSS-VAL-INTE IN WSS-VARI +
                         CAN-SGV-TREN IN CAN +
                         CAN-SGV-TPAG IN CAN -
                         TVC-VALO IN TVC-VARI -
                         RCV-SGV-REAJ IN RCV -
                         CAN-SGV-GAST IN CAN
                       IF WSS-SW-DISPLAY = 'S'
                           DISPLAY '    RCV-SGV-CAPI (CONVERTIDO) : '
                             TVC-VALO IN TVC-VARI
                       ELSE
                           NEXT SENTENCE
           ELSE
               COMPUTE WSS-VAL-INTE IN WSS-VARI =
                 WSS-VAL-INTE IN WSS-VARI +
                  CAN-SGV-TREN IN CAN +
                  CAN-SGV-TPAG IN CAN -
                  RCV-SGV-CAPI IN RCV -
                  CAN-SGV-GAST IN CAN.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   FIN-CAL-INTE-MNX...'
               DISPLAY '    WSS-VAL-INTE : ' WSS-VAL-INTE IN WSS-VARI.

       FIN-CAL-INTE-MNX.
           EXIT.

       CAL-CAPI-MNX SECTION.
       INI-CAL-CAPI-MNX.
      *CALCULA CAPITAL A FCOL
           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   INI-CAL-CAPI-MNX...'
               DISPLAY '    OPC-CIC-IOPC : ' OPC-CIC-IOPC IN OPC
               DISPLAY '    OPC-FEC-FCOL : ' OPC-FEC-FCOL IN OPC
               DISPLAY '    WSS-VAL-CAPI : ' WSS-VAL-CAPI IN WSS-VARI
               MOVE RCV-SGV-CAPI IN RCV TO WSS-NUM-DISPLAY
               DISPLAY '    RCV-SGV-CAPI : ' WSS-NUM-DISPLAY
               MOVE RCV-SGV-REAJ IN RCV TO WSS-NUM-DISPLAY
               DISPLAY '    RCV-SGV-REAJ : ' WSS-NUM-DISPLAY.

           IF OPC-MSC-TVOC IN OPC = '0'
               IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
                   COMPUTE WSS-VAL-CAPI IN WSS-VARI =
                           WSS-VAL-CAPI IN WSS-VARI +
                     ( RCV-SGV-CAPI IN RCV - RCV-SGV-REAJ IN RCV )
               ELSE
                   MOVE RCV-SGV-CAPI IN RCV TO TVC-VALO IN TVC-VARI
                   MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI
                   MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
                   MOVE OPC-NUM-DCOL IN OPC TO TVC-DCAM IN TVC-VARI
                   MOVE OPC-NUM-MCOL IN OPC TO TVC-MCAM IN TVC-VARI
                   MOVE OPC-NUM-SCOL IN OPC TO TVC-SCAM IN TVC-VARI
                   MOVE OPC-NUM-ACOL IN OPC TO TVC-ACAM IN TVC-VARI
                   PERFORM TAB-PRO-TVC
                   IF TVC-CMSG IN TVC-VARI > SPACES
                       DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                         TVC-MON1 IN TVC-VARI ' A : '
                         TVC-MON2 IN TVC-VARI ' AL : '
                         TVC-FCAM IN TVC-VARI
                         MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                         GO TO FIN-CAL-CAPI-MNX
                   ELSE
                       COMPUTE WSS-VAL-CAPI IN WSS-VARI =
                               WSS-VAL-CAPI IN WSS-VARI +
                           TVC-VALO IN TVC-VARI
                       IF WSS-SW-DISPLAY = 'S'
                           DISPLAY '    RCV-SGV-CAPI (CONVERTIDO) : '
                             TVC-VALO IN TVC-VARI
                       ELSE
                           NEXT SENTENCE
           ELSE
               COMPUTE WSS-VAL-CAPI IN WSS-VARI =
                       WSS-VAL-CAPI IN WSS-VARI +
                 ( RCV-SGV-CAPI IN RCV - RCV-SGV-REAJ IN RCV ).

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   FIN-CAL-CAPI-MNX...'
               DISPLAY '    WSS-VAL-CAPI : ' WSS-VAL-CAPI IN WSS-VARI.

       FIN-CAL-CAPI-MNX.
           EXIT.

       PROCESO-DLC SECTION.
       INI-PROCESO-DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PROCESO-DLC.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC)
                    GO TO FIN-PROCESO-DLC.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   INI-PROCESO-DLC...'
               DISPLAY '    DLC-CIC-IOPC : ' DLC-CIC-IOPC IN DLC ' '
                       DLC-NUM-IDLC IN DLC.

           IF OPC-MSC-TVOC IN OPC = '0'
               ADD DLC-VAL-IMPU IN DLC TO WSS-VAL-IMPU IN WSS-VARI
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-PROCESO-DLC
           ELSE
               MOVE DLC-VAL-IMPU IN DLC      TO TVC-VALO IN TVC-VARI
               MOVE OPC-COD-VCOC IN OPC      TO TVC-MON1 IN TVC-VARI
               MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
               MOVE WSS-NUM-DFIN TO TVC-DCAM IN TVC-VARI
               MOVE WSS-NUM-MFIN TO TVC-MCAM IN TVC-VARI
               MOVE WSS-NUM-SFIN TO TVC-SCAM IN TVC-VARI
               MOVE WSS-NUM-AFIN TO TVC-ACAM IN TVC-VARI
               PERFORM TAB-PRO-TVC
               IF TVC-CMSG IN TVC-VARI > SPACES
                   DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                     TVC-MON1 IN TVC-VARI ' A : '
                     TVC-MON2 IN TVC-VARI ' AL : '
                     TVC-FCAM IN TVC-VARI
                     MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                     MOVE '00' TO FIO-STAT
                     GO TO FIN-PROCESO-DLC
               ELSE
                   ADD TVC-VALO IN TVC-VARI TO WSS-VAL-IMPU IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-PROCESO-DLC.

           IF WSS-SW-DISPLAY = 'S'
               DISPLAY '   FIN-PROCESO-DLC...'
               DISPLAY '    WSS-VAL-IMPU : ' WSS-VAL-IMPU IN WSS-VARI.

       FIN-PROCESO-DLC.
           EXIT.

       BUSCAR-SIG-VCTO SECTION.
       INI-BUSCAR-SIG-VCTO.
           IF WSS-VAL-SCRE = ZEROES
               GO TO FIN-BUSCAR-SIG-VCTO.

           IF WSS-NUM-ICAN IN WSS-VARI = 999
               MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
               MOVE 1                   TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-VEN
           ELSE
               MOVE OPC-CIC-IOPC IN OPC      TO RCV-CIC-IOPC IN RCV
               MOVE WSS-NUM-ICAN IN WSS-VARI TO RCV-NUM-ICAN IN RCV
               MOVE OPC-CIC-IOPC IN OPC      TO RCV-CIC-IOPV IN RCV
               MOVE 999                      TO RCV-NUM-IVCT IN RCV
               MOVE FIO-GET-LEQ TO FIO-CMND
               PERFORM COL-FIO-RCV
               IF FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN OPC      = RCV-CIC-IOPC IN RCV AND
                  WSS-NUM-ICAN IN WSS-VARI = RCV-NUM-ICAN IN RCV AND
                  OPC-CIC-IOPC IN OPC      = RCV-CIC-IOPV IN RCV
                  IF RCV-NUM-IVCT IN RCV = ZEROES
                      MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN
                      MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
                      PERFORM COL-OBT-VEN
                      IF VEN-STAT-OKS
                          MOVE VEN-VAL-FINA IN VEN TO
                               VEN-VAL-SFIN IN VEN
                      ELSE
                          MOVE SPACES TO VEN-IND-SCTB IN VEN
                          MOVE ZEROES TO VEN-VAL-SFIN IN VEN
                  ELSE
                      MOVE RCV-CIC-IOPC IN RCV TO VEN-CIC-IOPC IN VEN
                      MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN VEN
                      MOVE FIO-GET-KEY TO FIO-CMND
                      PERFORM COL-OBT-VEN
                      IF VEN-STAT-OKS
                          IF WSS-NUM-IVCT IN WSS-VARI =
                             VEN-NUM-IVEN IN VEN
                              SUBTRACT WSS-RCV-FINA IN WSS-VARI FROM
                                 VEN-VAL-FINA IN VEN GIVING
                                 VEN-VAL-SFIN IN VEN
                          ELSE
                              MOVE VEN-VAL-FINA IN VEN TO
                                   VEN-VAL-SFIN IN VEN
                      ELSE
                          MOVE SPACES TO VEN-IND-SCTB IN VEN
                          MOVE ZEROES TO VEN-VAL-SFIN IN VEN
               ELSE
                   DISPLAY 'ERROR: INCONSISTENCIA NO EXISTE COLRCV : '
                      RCV-KEY-IRCV IN RCV.
       FIN-BUSCAR-SIG-VCTO.
           EXIT.

       GRABAR-SEL-LAV SECTION.
       INI-GRABAR-SEL-LAV.
           IF WSS-SW-DISPLAY IN WSS-VARI = 'S'
               DISPLAY ' GRABANDO SEL-MLT : ' LDC-CIC-ICLF IN LDC ' '
                    LDC-NUM-ILDC IN LDC.

           MOVE '1'                 TO SEL-IND-TREG IN SEL.

      *RESTAURA CLAVE DE CLF ORIGINAL POR SI FUE RENOVADA
           MOVE WSS-CIC-ICLF-RPT IN WSS-VARI TO SEL-CIC-ICLF IN SEL.
      *    MOVE LDC-CIC-ICLF IN LDC TO SEL-CIC-ICLF IN SEL.
      *
           MOVE LDC-NUM-ILDC IN LDC TO SEL-NUM-ILDC IN SEL.
           MOVE LDC-COD-VCLC IN LDC TO WSS-COD-VCOC.
           IF LDC-COD-VCLC IN LDC NOT = WSS-COD-PESO IN WSS-VARI
               MOVE LDC-VAL-CMAX IN LDC TO TVC-VALO IN TVC-VARI
               MOVE LDC-COD-VCLC IN LDC TO TVC-MON1 IN TVC-VARI
               MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI
               MOVE WSS-NUM-DFIN TO TVC-DCAM IN TVC-VARI
               MOVE WSS-NUM-MFIN TO TVC-MCAM IN TVC-VARI
               MOVE WSS-NUM-SFIN TO TVC-SCAM IN TVC-VARI
               MOVE WSS-NUM-AFIN TO TVC-ACAM IN TVC-VARI
               PERFORM TAB-PRO-TVC
               IF TVC-CMSG IN TVC-VARI > SPACES
                   DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                     TVC-MON1 IN TVC-VARI ' A : '
                     TVC-MON2 IN TVC-VARI ' AL : '
                     TVC-FCAM IN TVC-VARI
                     MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
                     MOVE '00' TO FIO-STAT
                     GO TO FIN-GRABAR-SEL-LAV
               ELSE
                   MOVE TVC-VALO IN TVC-VARI TO SEL-VAL-CMAX IN SEL
           ELSE
               MOVE LDC-VAL-CMAX IN LDC TO SEL-VAL-CMAX IN SEL.

           MOVE LDC-FEC-FVEN IN LDC TO SEL-FEC-FVEN IN SEL.
           MOVE WSS-NUM-DFIN        TO SEL-NUM-DPRO IN SEL.
           MOVE WSS-NUM-MFIN        TO SEL-NUM-MPRO IN SEL.
           MOVE WSS-NUM-SFIN        TO SEL-NUM-SPRO IN SEL.
           MOVE WSS-NUM-AFIN        TO SEL-NUM-APRO IN SEL.

      *GRABA OFICINA DE LA CLF
           MOVE CLF-COD-OFIC IN CLF TO SEL-COD-OFIC IN SEL.

      *GRABA EJECUTIVO DE LA CLF
           MOVE CLF-COD-EJEC IN CLF TO SEL-COD-EJEC IN SEL.

      *GRABA TIPO DE CLF
           MOVE CLF-COD-COCF IN CLF TO SEL-COD-COCF IN SEL.

      *GRABA TIPO DE LDC
           MOVE LDC-COD-TIPO IN LDC TO SEL-COD-TIPO IN SEL.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-SELG1 IN WSS-VARI
               IF WSS-SW-DISPLAY = 'S'
                  DISPLAY ' GRABADO OK SEL-MLT'
                  DISPLAY '  SEL-CIC-ICLF : ' SEL-CIC-ICLF IN SEL
                  DISPLAY '  SEL-NUM-ILDC : ' SEL-CIC-ICLF IN SEL
                  DISPLAY '  SEL-VAL-CMAX : ' SEL-VAL-CMAX IN SEL
               ELSE
                  NEXT SENTENCE
           ELSE
               DISPLAY 'ERROR: AL GRABAR REGISTRO SEL-MLT : '
                    LDC-CIC-ICLF IN LDC ' ' LDC-NUM-ILDC IN LDC.

       FIN-GRABAR-SEL-LAV.
           EXIT.

       GRABAR-SEL-OPC SECTION.
       INI-GRABAR-SEL-OPC.
           DISPLAY ' GRABANDO SEL-OPC : ' LDC-CIC-ICLF IN LDC ' '
                    LDC-NUM-ILDC IN LDC.
           MOVE '4'                 TO SE1-IND-TREG IN SE1.
      *RESTAURA CLAVE DE CLF ORIGINAL POR SI FUE RENOVADA
           MOVE WSS-CIC-ICLF-RPT IN WSS-VARI TO SE1-CIC-ICLF IN SE1.
      *    MOVE LDC-CIC-ICLF IN LDC TO SE1-CIC-ICLF IN SE1.
      *
           MOVE LDC-NUM-ILDC IN LDC TO SE1-NUM-ILDC IN SE1.

      *RVM-CST-INI 2-DEC-1996
           MOVE OPC-CIC-IOPC IN OPC TO SE1-CIC-IOPC IN SE1.
      *RVM-CST-FIN 2-DEC-1996

      *RVM-CST-INI 16-SEP-1996
      *     MOVE OPC-NUM-DINP IN OPC TO SE1-NUM-DCOL IN SE1.
      *     MOVE OPC-NUM-MINP IN OPC TO SE1-NUM-MCOL IN SE1.
      *     MOVE OPC-NUM-SINP IN OPC TO SE1-NUM-SCOL IN SE1.
      *     MOVE OPC-NUM-AINP IN OPC TO SE1-NUM-ACOL IN SE1.
           MOVE OPC-NUM-DCOL IN OPC TO SE1-NUM-DCOL IN SE1.
           MOVE OPC-NUM-MCOL IN OPC TO SE1-NUM-MCOL IN SE1.
           MOVE OPC-NUM-SCOL IN OPC TO SE1-NUM-SCOL IN SE1.
           MOVE OPC-NUM-ACOL IN OPC TO SE1-NUM-ACOL IN SE1.
      *RVM-CST-FIN 16-SEP-1996

           MOVE 'COL'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-COOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB .
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DESC TO SE1-GLS-TIAV IN SE1
           ELSE
              MOVE TAB-GLS-DESC TO SE1-GLS-TIAV IN SE1.

           MOVE WSS-VAL-SCRE IN WSS-VARI TO SE1-VAL-SCRE IN SE1.
           MOVE OPC-VAL-CRED IN OPC      TO SE1-VAL-CRED IN SE1.

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DCOR TO SE1-GLS-MONE IN SE1
           ELSE
              MOVE TAB-GLS-ABRV TO SE1-GLS-MONE IN SE1.

      *GUARDA UN INDICADOR PARA LA MONEDA
      *RVM-CST-INI 3-DEC-1996
      *     IF OPC-COD-VCOC IN OPC = WSS-COD-PESO IN WSS-VARI
      *         MOVE '0' TO SE1-IND-TMON IN SE1
      *     ELSE
      *         MOVE '1' TO SE1-IND-TMON IN SE1.
           MOVE OPC-COD-VCOC IN OPC TO SE1-OPC-VCOC IN SE1.
      *RVM-CST-INI 3-DEC-1996
      *
      *ESTOS DATOS DE LA VEN NO SON DIRECTOS, SI NO QUE FUERON OBTENIDOS
      *MEDIANTE UNA FORMULA
           MOVE VEN-FEC-FVEN IN VEN TO SE1-FEC-FVEN IN SE1.
           MOVE VEN-VAL-SFIN IN VEN TO SE1-VAL-SFIN IN SE1.
      *RVM-CST-INI 20-SEP-1995
      *A PEDIDO DEL BANCO CUANDO LA FECHA DEL PROXIMO VENCIMIENTO SEA
      *MAYOR QUE LA FECHA DE TERMINO(FFIN), DEBERA SER CONSIDERADO COMO
      *VIGENTE
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FFIN IN WSS-VARI
               MOVE SPACES TO VEN-IND-SCTB IN VEN.

           MOVE VEN-IND-SCTB IN VEN TO SE1-IND-SCTB IN SE1.
      *RVM-CST-FIN 20-SEP-1995

           MOVE SE1 TO SEL.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-SELG4 IN WSS-VARI
               IF WSS-SW-DISPLAY = 'S'
                  DISPLAY ' GRABADO OK SEL-OPC'
                  DISPLAY '  OPC-CIC-IOPC : ' OPC-CIC-IOPC IN OPC
                  DISPLAY '  VEN-CIC-IOPC : ' VEN-CIC-IOPC IN VEN
                  DISPLAY '  VEN-NUM-IVEN : ' VEN-NUM-IVEN IN VEN
                  DISPLAY '  VEN-FEC-FVEN : ' VEN-FEC-FVEN IN VEN
                  DISPLAY '  VEN-VAL-SFIN : ' VEN-VAL-SFIN IN VEN
                  DISPLAY '  VEN-IND-SCTB : ' VEN-IND-SCTB IN VEN
                  DISPLAY '  SE1-CIC-ICLF : ' SE1-CIC-ICLF IN SE1
                  DISPLAY '  SE1-NUM-ILDC : ' SE1-CIC-ICLF IN SE1
                  DISPLAY '  SE1-VAL-SCRE : ' SE1-VAL-SCRE IN SE1
                  DISPLAY '  SE1-VAL-SCRE : ' SE1-VAL-CRED IN SE1
               ELSE
                  NEXT SENTENCE
           ELSE
               DISPLAY 'ERROR: AL GRABAR REGISTRO SEL-OPC : '
                    LDC-CIC-ICLF IN LDC ' ' LDC-NUM-ILDC IN LDC.

       FIN-GRABAR-SEL-OPC.
           EXIT.

       GRABAR-SEL-DLC SECTION.
       INI-GRABAR-SEL-DLC.
           DISPLAY ' GRABANDO SEL-DLC : ' LDC-CIC-ICLF IN LDC ' '
                    LDC-NUM-ILDC IN LDC.
           MOVE '2'                 TO SE3-IND-TREG IN SE3.
      *RESTAURA CLAVE DE CLF ORIGINAL POR SI FUE RENOVADA
           MOVE WSS-CIC-ICLF-RPT IN WSS-VARI TO SE3-CIC-ICLF IN SE3.
      *    MOVE LDC-CIC-ICLF IN LDC TO SE3-CIC-ICLF IN SE3.
      *
           MOVE LDC-NUM-ILDC IN LDC TO SE3-NUM-ILDC IN SE3.
           MOVE WSS-VAL-IMPU IN WSS-VARI TO SE3-VAL-IMPU IN SE3.

           MOVE SE3 TO SEL.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-SELG2 IN WSS-VARI
               IF WSS-SW-DISPLAY = 'S'
                  DISPLAY ' GRABADO OK SEL-DLC'
                  DISPLAY '  SE3-CIC-ICLF : ' SE3-CIC-ICLF IN SE3
                  DISPLAY '  SE3-NUM-ILDC : ' SE3-CIC-ICLF IN SE3
                  DISPLAY '  SE3-VAL-IMPU : ' SE3-VAL-IMPU IN SE3
               ELSE
                  NEXT SENTENCE
           ELSE
               DISPLAY 'ERROR: AL GRABAR REGISTRO SEL-DLC : '
                    LDC-CIC-ICLF IN LDC ' ' LDC-NUM-ILDC IN LDC.

       FIN-GRABAR-SEL-DLC.
           EXIT.

       GRABAR-SEL-CAN SECTION.
       INI-GRABAR-SEL-CAN.
           DISPLAY ' GRABANDO SEL-CAN : ' LDC-CIC-ICLF IN LDC ' '
                    LDC-NUM-ILDC IN LDC.
           MOVE '3'                 TO SE2-IND-TREG IN SE2.
      *RESTAURA CLAVE DE CLF ORIGINAL POR SI FUE RENOVADA
           MOVE WSS-CIC-ICLF-RPT IN WSS-VARI TO SE2-CIC-ICLF IN SE2.
      *    MOVE LDC-CIC-ICLF IN LDC TO SE2-CIC-ICLF IN SE2.
      *
           MOVE LDC-NUM-ILDC IN LDC TO SE2-NUM-ILDC IN SE2.
           MOVE WSS-NUM-DFIN        TO SE2-NUM-DCAN IN SE2.
           MOVE WSS-NUM-MFIN        TO SE2-NUM-MCAN IN SE2.
           MOVE WSS-NUM-SFIN        TO SE2-NUM-SCAN IN SE2.
           MOVE WSS-NUM-AFIN        TO SE2-NUM-ACAN IN SE2.
           MOVE WSS-VAL-INTE IN WSS-VARI TO SE2-SGV-INTE IN SE2.
           MOVE WSS-VAL-REAJ IN WSS-VARI TO SE2-SGV-REAJ IN SE2.


           IF WSS-SW-DISPLAY = 'S'
               DISPLAY 'WSS-VAL-CAPI : ' WSS-VAL-CAPI IN WSS-VARI.

      *RVM
           MOVE WSS-VAL-CAPI IN WSS-VARI TO SE2-SGV-CAPI IN SE2.
      *    MOVE WSS-VAL-CAPI IN WSS-VARI TO TVC-VALO IN TVC-VARI.
      *    MOVE OPC-COD-VCOC IN OPC      TO TVC-MON1 IN TVC-VARI.
      *    MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI.
      *    MOVE OPC-NUM-DCOL IN OPC      TO TVC-DCAM IN TVC-VARI.
      *    MOVE OPC-NUM-MCOL IN OPC      TO TVC-MCAM IN TVC-VARI.
      *    MOVE OPC-NUM-SCOL IN OPC      TO TVC-SCAM IN TVC-VARI.
      *    MOVE OPC-NUM-ACOL IN OPC      TO TVC-ACAM IN TVC-VARI.
      *    PERFORM TAB-PRO-TVC.
      *    IF TVC-CMSG IN TVC-VARI > SPACES
      *        DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
      *          TVC-MON1 IN TVC-VARI ' A : '
      *          TVC-MON2 IN TVC-VARI ' AL : '
      *          TVC-FCAM IN TVC-VARI
      *          MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI
      *          MOVE '00' TO FIO-STAT
      *          GO TO FIN-GRABAR-SEL-CAN
      *    ELSE
      *        MOVE TVC-VALO IN TVC-VARI TO SE2-SGV-CAPI IN SE2.

           MOVE SE2 TO SEL.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           IF FIO-STAT-OKS
               ADD 1 TO WSS-NUM-SELG3 IN WSS-VARI
               IF WSS-SW-DISPLAY = 'S'
                   DISPLAY ' GRABADO OK SEL-CAN'
                   DISPLAY '  SE2-CIC-ICLF : ' SE2-CIC-ICLF IN SE2
                   DISPLAY '  SE2-NUM-ILDC : ' SE2-NUM-ILDC IN SE2
                   DISPLAY '  SE2-SGV-INTE : ' SE2-SGV-INTE IN SE2
                   DISPLAY '  SE2-SGV-REAJ : ' SE2-SGV-REAJ IN SE2
                   DISPLAY '  SE2-SGV-CAPI : ' SE2-SGV-CAPI IN SE2
               ELSE
                  NEXT SENTENCE
           ELSE
               DISPLAY 'ERROR: AL GRABAR REGISTRO SEL-CAN : '
                    LDC-CIC-ICLF IN LDC ' ' LDC-NUM-ILDC IN LDC.

       FIN-GRABAR-SEL-CAN.
           EXIT.

       VALIDA-MIMMEX SECTION.
       INI-VALIDA-MIMMEX.
           MOVE 'TAB'               TO FIO-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR: NO EXISTE TIPO DE OPC EN TABLA TIO : '
                  OPC-COD-TOOC IN OPC
               GO TO FIN-VALIDA-MIMMEX.
       FIN-VALIDA-MIMMEX.
           EXIT.

       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Codigo Valor de Cambio de Pesos Mediante CIC de la Moned
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC
               MOVE 1 TO WSS-NUM-RBAD IN WSS-VARI.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
           MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC     IN TVC-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       FINAL-MNX SECTION.
       INI-FINAL-MNX.
      *-------------------------------------
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM LDC-FIO-SEL.
           PERFORM LDC-FIO-CLF.
           PERFORM LDC-FIO-LDC.
           PERFORM LDC-FIO-RDC.
           PERFORM COL-FIO-OPC.
           PERFORM COL-FIO-RDC.
           PERFORM COL-FIO-DLC.
           PERFORM COL-FIO-VEN.
           PERFORM COL-FIO-RCV.
           PERFORM COL-FIO-CAN.
           PERFORM TAB-FIO-CAM.
           MOVE 'DEU' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE 'GNS' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
      *-------------------------------------
       FIN-FINAL-MNX.
           EXIT.
      *

      *RVM-CST-INI 12-SEP-1996
      * COPY LDCBFSEL.
       COPY LDCBFMNX.
      *RVM-CST-FIN 12-SEP-1996
       COPY LDCBFCLF.
       COPY LDCBFLDC.
       COPY LDCBFRDC REPLACING RDC BY RDL
                   ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
       COPY COLBFOPC.
       COPY COLBFCAN.
       COPY COLBFRCV.
       COPY COLBFVEN.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY COLBFEVC.
       COPY COLBFICG.

       COPY COLBGVEN.
       COPY COLBGINT.
       COPY COLBFCCT.
       COPY COLBFTOC.
       COPY COLBFROV.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGABT.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY GNSBBTAB.
       COPY GNSBFMSG.
       COPY GNSBBMSG.
       COPY GNSBFTAB.
       COPY GNSBFMSC.
       COPY GNSBGEND.
       COPY GNSBGPES.
       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
