      *
      * LDCBQRLO
      * Version 3.0.1 Nov-2005
      * 28-Mar-19 08:16 PM
      *
      *-----------------------------------------------------------------
      *MODIFICACIONES:                                                  
      *--------------                                                   
      *OBJETIVO: SE MODIFICAN LOS COMANDOS LIB Y RBJ                    
      *PROYECTO: LOF CON CANCELACIONES                                  
      *FECHA   : JULIO DE 2009                                          
      *AUTOR   : CHC                                                    
      *ETIQUETA: *AFRI-INI/LOF/CHC/07-2009                              
      *-----------------------------------------------------------------
      *OBJETIVO: SE CREA COMANDO BLI
      *PROYECTO: IMPRESION DOCUMENTO FOGAPE
      *FECHA   : AGOSTO 2015
      *ETIQUETA: *AFRI-INI/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
      *-----------------------------------------------------------------
       SET-TAG-LDCBQRLO SECTION.
       INI-SET-TAG-LDCBQRLO.
           MOVE
           '<IDNMOD NOM=$LDCBQRLO$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$28-Mar-19 08:16 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-LDCBQRLO.
           EXIT.
           
       PUT-ALL-RLO SECTION.
       INI-PUT-ALL-RLO.
           PERFORM PUT-RLO-RLO.
       FIN-PUT-ALL-RLO.
           EXIT.
       
       PUT-RLO-RLO SECTION.
       INI-PUT-RLO-RLO.
           IF PGM-STAT-RLO-NUL
               GO TO FIN-PUT-RLO-RLO.
           IF NOT PGM-STAT-RLO-OKS
               PERFORM CLR-RLO-RLO
               GO TO FIN-PUT-RLO-RLO.
           MOVE RLO-CAI-ILIC IN RLO TO RLO-CAI-ILIC IN RLO-FLD.
           MOVE RLO-IIC-ILIC IN RLO TO RLO-IIC-ILIC IN RLO-FLD.
           MOVE RLO-CAI-IOPC IN RLO TO RLO-CAI-IOPC IN RLO-FLD.
           MOVE RLO-IIC-IOPC IN RLO TO RLO-IIC-IOPC IN RLO-FLD.
           MOVE RLO-NUM-IOPC IN RLO TO RLO-NUM-IOPC IN RLO-FLD.
           MOVE RLO-CIC-ENTI IN RLO TO RLO-CIC-ENTI IN RLO-FLD.
           MOVE RLO-COD-ACTI IN RLO TO RLO-COD-ACTI IN RLO-FLD.
           MOVE RLO-NUM-UNIL IN RLO TO RLO-NUM-UNIL IN RLO-FLD.
           MOVE RLO-VAL-MGAR IN RLO TO RLO-VAL-MGAR IN RLO-FLD.
           MOVE RLO-VAL-SGAR IN RLO TO RLO-VAL-SGAR IN RLO-FLD.
           MOVE RLO-VAL-PGAR IN RLO TO RLO-VAL-PGAR IN RLO-FLD.
           MOVE RLO-COD-CGAR IN RLO TO RLO-COD-CGAR IN RLO-FLD.
           MOVE RLO-COD-CGTA IN RLO TO RLO-COD-CGTA IN RLO-FLD.
           MOVE RLO-COD-DESO IN RLO TO RLO-COD-DESO IN RLO-FLD.
           MOVE RLO-COD-DENV IN RLO TO RLO-COD-DENV IN RLO-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE RLO-NUM-DACT IN RLO TO RLO-NUM-DACT IN RLO-FLD.
           MOVE RLO-NUM-MACT IN RLO TO RLO-NUM-MACT IN RLO-FLD.
           MOVE RLO-NUM-SACT IN RLO TO RLO-NUM-SACT IN RLO-FLD.
           MOVE RLO-NUM-AACT IN RLO TO RLO-NUM-AACT IN RLO-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
       FIN-PUT-RLO-RLO.
           EXIT.
       
       KEY-ALL-RLO SECTION.
       INI-KEY-ALL-RLO.
           PERFORM KEY-RLO-RLO.
      *<<<< FIN_KEY_ALL_RLO                                             
           IF RLO-NUM-IOPC IN RLO-FLD > ZEROES                          
              MOVE 'LDC'    TO RLO-COD-CPTO IN RLO                      
           ELSE                                                         
              MOVE 'OPC'    TO RLO-COD-CPTO IN RLO.                     
      *>>>>                                                             
       FIN-KEY-ALL-RLO.
           EXIT.
       
       KEY-RLO-RLO SECTION.
       INI-KEY-RLO-RLO.
           MOVE RLO-CAI-ILIC IN RLO-FLD TO RLO-CAI-ILIC IN RLO.
           MOVE RLO-IIC-ILIC IN RLO-FLD TO RLO-IIC-ILIC IN RLO.
           MOVE RLO-CAI-IOPC IN RLO-FLD TO RLO-CAI-IOPC IN RLO.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO RLO-IIC-IOPC IN RLO.
           MOVE RLO-NUM-IOPC IN RLO-FLD TO RLO-NUM-IOPC IN RLO.
       FIN-KEY-RLO-RLO.
           EXIT.
       
       SCR-CLRA-RLO SECTION.
       INI-SCR-CLRA-RLO.
           PERFORM CLR-KEY-RLO.
           PERFORM CLR-FLD-RLO.
       FIN-SCR-CLRA-RLO.
           EXIT.
       
       CLR-KEY-RLO SECTION.
       INI-CLR-KEY-RLO.
           MOVE SPACES TO RLO-CAI-ILIC IN RLO-FLD.
           MOVE SPACES TO RLO-IIC-ILIC IN RLO-FLD.
           MOVE SPACES TO RLO-CAI-IOPC IN RLO-FLD.
           MOVE ZEROES TO RLO-IIC-IOPC IN RLO-FLD.
           MOVE ZEROES TO RLO-NUM-IOPC IN RLO-FLD.
       FIN-CLR-KEY-RLO.
           EXIT.
       
       CLR-FLD-RLO SECTION.
       INI-CLR-FLD-RLO.
           MOVE SPACES TO FRM-GLS-NOMB IN RLO-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-VRF-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-IND-CLIE IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-CLIE IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-COD-TIPO IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-DESC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-MOPC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-SOPC IN RLO-FLD.
      * VRF-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN RLO-FLD.
      * VRF-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-IND-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN RLO-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN RLO-FLD.
           MOVE ZEROES TO FRM-VAL-MLIB IN RLO-FLD.
           MOVE SPACES TO FRM-CAI-ILIC IN RLO-FLD.
           MOVE SPACES TO FRM-IIC-ILIC IN RLO-FLD.
           PERFORM CLR-RLO-RLO.
       FIN-CLR-FLD-RLO.
           EXIT.
       
       CLR-RLO-RLO SECTION.
       INI-CLR-RLO-RLO.
           MOVE SPACES TO RLO-CIC-ENTI IN RLO-FLD.
           MOVE SPACES TO RLO-COD-ACTI IN RLO-FLD.
           MOVE SPACES TO RLO-NUM-UNIL IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-MGAR IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-SGAR IN RLO-FLD.
           MOVE ZEROES TO RLO-VAL-PGAR IN RLO-FLD.
           MOVE SPACES TO RLO-COD-CGAR IN RLO-FLD.
           MOVE SPACES TO RLO-COD-CGTA IN RLO-FLD.
           MOVE SPACES TO RLO-COD-DESO IN RLO-FLD.
           MOVE SPACES TO RLO-COD-DENV IN RLO-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO RLO-FEC-FACT IN RLO-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-RLO-RLO.
           EXIT.
       
       FST-KEY-RLO SECTION.
       INI-FST-KEY-RLO.
           MOVE -1 TO RLO-CAI-ILIC-LEN IN RLO-FLD.
      *<<<<
      *AFRI-INI/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
           IF SCR-CMND = WSS-GLS-IBLI
               MOVE WSS-NUM-ZERO  TO RLO-CAI-ILIC-LEN IN RLO-FLD        
               MOVE WSS-NUM-MUNO  TO RLO-CAI-IOPC-LEN IN RLO-FLD.       
      *AFRI-FIN/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
      *>>>>
       FIN-FST-KEY-RLO.
           EXIT.
       
       FST-FLD-RLO SECTION.
       INI-FST-FLD-RLO.
      *<<<< INI-FST-FLD-RLO.                                            
           IF SCR-CMND = 'TRL'                                          
               MOVE -1 TO FRM-CAI-ILIC-LEN IN RLO-FLD                   
           ELSE                                                         
      *>>>>                                                             

           MOVE -1 TO RLO-COD-CGTA-LEN IN RLO-FLD.
       FIN-FST-FLD-RLO.
           EXIT.
       
       PRO-KEY-RLO SECTION.
       INI-PRO-KEY-RLO.
           PERFORM PRO-IKY-RLO.
           PERFORM PRO-AKY-RLO.
           PERFORM PRO-MKY-RLO.
       FIN-PRO-KEY-RLO.
           EXIT.
       
       PRO-IKY-RLO SECTION.
       INI-PRO-IKY-RLO.
           MOVE FRM-CPIM-AEY TO RLO-CAI-ILIC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO RLO-IIC-ILIC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO RLO-CAI-IOPC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO RLO-IIC-IOPC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-AEY TO RLO-NUM-IOPC-ATR IN RLO-FLD.
       FIN-PRO-IKY-RLO.
           EXIT.
       
       PRO-MKY-RLO SECTION.
       INI-PRO-MKY-RLO.
       FIN-PRO-MKY-RLO.
           EXIT.
       
       PRO-AKY-RLO SECTION.
       INI-PRO-AKY-RLO.
       FIN-PRO-AKY-RLO.
           EXIT.
       
       UNP-KEY-RLO SECTION.
       INI-UNP-KEY-RLO.
           PERFORM UNP-IKY-RLO.
           PERFORM UNP-AKY-RLO.
           PERFORM UNP-MKY-RLO.
       FIN-UNP-KEY-RLO.
           EXIT.
       
       UNP-IKY-RLO SECTION.
       INI-UNP-IKY-RLO.
           MOVE FRM-CPIM-UBY TO RLO-CAI-ILIC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-IIC-ILIC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO RLO-NUM-IOPC-ATR.
      *<<<<
      *AFRI-INI/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
           IF SCR-CMND = WSS-GLS-IBLI
               MOVE FRM-CPIM-AEY TO RLO-CAI-ILIC-ATR                    
               MOVE FRM-CPIM-AEY TO RLO-IIC-ILIC-ATR                    
               MOVE FRM-CPIM-AEY TO RLO-NUM-IOPC-ATR.                   
      *AFRI-FIN/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
      *>>>>
       FIN-UNP-IKY-RLO.
           EXIT.
       
       UNP-MKY-RLO SECTION.
       INI-UNP-MKY-RLO.
       FIN-UNP-MKY-RLO.
           EXIT.
       
       UNP-AKY-RLO SECTION.
       INI-UNP-AKY-RLO.
       FIN-UNP-AKY-RLO.
           EXIT.
       
       UNP-FLD-RLO SECTION.
       INI-UNP-FLD-RLO.
           MOVE FRM-CPIM-UBY TO FRM-VAL-MLIB-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO FRM-CAI-ILIC-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-ILIC-ATR IN RLO-FLD.
           PERFORM UNP-RLO-RLO.
      *<<<< FIN-UNP-FLD-RLO                                             
           IF SCR-CMND = 'TRL'                                          
               MOVE FRM-CPIM-AEY TO RLO-COD-CGTA-ATR IN RLO-FLD         
               MOVE FRM-CPIM-AEY TO RLO-COD-DENV-ATR IN RLO-FLD         
               MOVE FRM-CPIM-AEY TO FRM-VAL-MLIB-ATR IN RLO-FLD.        
      *>>>>                                                             
       FIN-UNP-FLD-RLO.
           EXIT.
       
       UNP-RLO-RLO SECTION.
       INI-UNP-RLO-RLO.
           MOVE FRM-CPIM-UBY TO RLO-COD-CGTA-ATR IN RLO-FLD.
           MOVE FRM-CPIM-UBY TO RLO-COD-DENV-ATR IN RLO-FLD.
       FIN-UNP-RLO-RLO.
           EXIT.
       
       VAL-KEY-RLO SECTION.
       INI-VAL-KEY-RLO.
           PERFORM VAL-IKY-RLO.
           PERFORM VAL-MKY-RLO.
           PERFORM VAL-AKY-RLO.
       FIN-VAL-KEY-RLO.
           EXIT.
       
       VAL-IKY-RLO SECTION.
       INI-VAL-IKY-RLO.
           PERFORM VAL-RLO-CAI-ILIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-CAI-ILIC-LEN IN RLO-FLD
                GO TO FIN-VAL-IKY-RLO.
           PERFORM VAL-RLO-IIC-ILIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-IIC-ILIC-LEN IN RLO-FLD
                GO TO FIN-VAL-IKY-RLO.
           PERFORM VAL-RLO-CAI-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-CAI-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-IKY-RLO.
           PERFORM VAL-RLO-IIC-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-IIC-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-IKY-RLO.
           PERFORM VAL-RLO-NUM-IOPC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO RLO-NUM-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-IKY-RLO.
       FIN-VAL-IKY-RLO.
           EXIT.
       
       VAL-MKY-RLO SECTION.
       INI-VAL-MKY-RLO.
       FIN-VAL-MKY-RLO.
           EXIT.
       
       VAL-AKY-RLO SECTION.
       INI-VAL-AKY-RLO.
       FIN-VAL-AKY-RLO.
           EXIT.
       
       VAL-RLO-CAI-ILIC SECTION.
       INI-VAL-RLO-CAI-ILIC.
      *<<<<
      *AFRI-INI/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
           IF SCR-CMND = WSS-GLS-IBLI
                GO TO FIN-VAL-RLO-CAI-ILIC.                             
      *AFRI-FIN/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
      *>>>>
           IF RLO-CAI-ILIC IN RLO-FLD NOT > SPACES AND                  
              SCR-CMND NOT = 'CON'                                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-RLO-CAI-ILIC.                             
           GO TO FIN-VAL-RLO-CAI-ILIC.
           IF RLO-CAI-ILIC IN RLO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RLO-CAI-ILIC.
       FIN-VAL-RLO-CAI-ILIC.
           EXIT.
       
       VAL-RLO-IIC-ILIC SECTION.
       INI-VAL-RLO-IIC-ILIC.
      *<<<<
      *AFRI-INI/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
           IF SCR-CMND = WSS-GLS-IBLI
                GO TO FIN-VAL-RLO-IIC-ILIC.                             
      *AFRI-FIN/AGOSTO 2015 IMPRESION DOCUMENTO FOGAPE
      *>>>>         
           IF RLO-IIC-ILIC IN RLO-FLD NOT > SPACES AND                  
              SCR-CMND NOT = 'CON'                                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-RLO-IIC-ILIC.                             
           GO TO FIN-VAL-RLO-IIC-ILIC.
           IF RLO-IIC-ILIC IN RLO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RLO-IIC-ILIC.
       FIN-VAL-RLO-IIC-ILIC.
           EXIT.
       
       VAL-RLO-CAI-IOPC SECTION.
       INI-VAL-RLO-CAI-IOPC.
           IF RLO-CAI-IOPC IN RLO-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RLO-CAI-IOPC.
      *AFRI-INI/JUN07                                                   
      *AFRI-INI/LOF/CHC/07-2009                                         
      *    IF SCR-CMND = 'RBJ' AND                                      
           IF (SCR-CMND = 'RBJ' OR SCR-CMND = 'ING') AND                
      *AFRI-FIN/LOF/CHC/07-2009                                         
              RLO-NUM-IOPC IN RLO-FLD NOT > ZEROES                      
              MOVE RLO-CAI-IOPC IN RLO-FLD TO OPC-CAI-IOPC IN OPC       
              MOVE RLO-IIC-IOPC IN RLO-FLD TO OPC-IIC-IOPC IN OPC       
              MOVE FIO-GET-KEY             TO FIO-CMND                  
              PERFORM COL-FIO-OPC                                       
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'COL' TO MSG-COD-SIST                             
      *AFRI-INI/LOF/CHC/07-2009                                         
                 MOVE 'OPC    NEX' TO MSG-COD-MENS                      
      *AFRI-FIN/LOF/CHC/07-2009                                         
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-RLO-CAI-IOPC                             
              ELSE                                                      
                 PERFORM GET-FHOY                                       
                 IF OPC-FEC-FINP IN OPC = HOY-FHOY                      
                    MOVE 'DEU' TO MSG-COD-SIST                          
                    MOVE 'RBJ NO VAL' TO MSG-COD-MENS                   
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC TO FRM-MENS                       
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.                      
      *AFRI-FIN/JUN07                                                   
      *>>>>
       FIN-VAL-RLO-CAI-IOPC.
           EXIT.
       
       VAL-RLO-IIC-IOPC SECTION.
       INI-VAL-RLO-IIC-IOPC.
           IF RLO-IIC-IOPC IN RLO-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-RLO-IIC-IOPC.
      *AFRI-INI/JUN07                                                   
      *AFRI-INI/LOF/CHC/07-2009                                         
      *    IF SCR-CMND = 'RBJ' AND                                      
           IF (SCR-CMND = 'RBJ' OR SCR-CMND = 'ING') AND                
      *AFRI-FIN/LOF/CHC/07-2009                                         
              RLO-NUM-IOPC IN RLO-FLD NOT > ZEROES                      
              MOVE RLO-CAI-IOPC IN RLO-FLD TO OPC-CAI-IOPC IN OPC       
              MOVE RLO-IIC-IOPC IN RLO-FLD TO OPC-IIC-IOPC IN OPC       
              MOVE FIO-GET-KEY             TO FIO-CMND                  
              PERFORM COL-FIO-OPC                                       
              IF NOT FIO-STAT-OKS                                       
                 MOVE 'COL' TO MSG-COD-SIST                             
      *AFRI-INI/LOF/CHC/07-2009                                         
                 MOVE 'OPC    NEX' TO MSG-COD-MENS                      
      *AFRI-FIN/LOF/CHC/07-2009                                         
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-RLO-IIC-IOPC                             
              ELSE                                                      
                 PERFORM GET-FHOY                                       
                 IF OPC-FEC-FINP IN OPC = HOY-FHOY                      
                    MOVE 'DEU' TO MSG-COD-SIST                          
                    MOVE 'RBJ NO VAL' TO MSG-COD-MENS                   
                    PERFORM GET-MSG                                     
                    MOVE MSG-GLS-DESC TO FRM-MENS                       
                    MOVE FRM-SUAR-MAL TO FRM-SUAR.                      
      *AFRI-FIN/JUN07 
      *>>>>                                                  
       FIN-VAL-RLO-IIC-IOPC.
           EXIT.
       
       VAL-RLO-NUM-IOPC SECTION.
       INI-VAL-RLO-NUM-IOPC.
      *>>>>
      *AFRI-INI/LOF/CHC/07-2009                                         
           IF SCR-CMND = 'ING' AND RLO-NUM-IOPC IN RLO-FLD > ZEROES     
               MOVE 'COL' TO MSG-COD-SIST                               
               MOVE 'RBJNOVALPL' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-RLO-NUM-IOPC.                              
      *AFRI-FIN/LOF/CHC/07-2009                                         
      *>>>>
       FIN-VAL-RLO-NUM-IOPC.
           EXIT.
       
       VAL-CON-KEY-RLO SECTION.
       INI-VAL-CON-KEY-RLO.
           IF     RLO-CAI-ILIC IN RLO-FLD NOT > SPACES 
              AND RLO-IIC-ILIC IN RLO-FLD NOT > SPACES 
              AND RLO-CAI-IOPC IN RLO-FLD NOT > SPACES 
              AND RLO-IIC-IOPC IN RLO-FLD NOT > ZEROES 
              AND RLO-NUM-IOPC IN RLO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-RLO.
       FIN-VAL-CON-KEY-RLO.
           EXIT.
       
       VAL-CON-IKY-RLO SECTION.
       INI-VAL-CON-IKY-RLO.
           IF     RLO-CAI-ILIC IN RLO-FLD NOT > SPACES 
              AND RLO-IIC-ILIC IN RLO-FLD NOT > SPACES 
              AND RLO-CAI-IOPC IN RLO-FLD NOT > SPACES 
              AND RLO-IIC-IOPC IN RLO-FLD NOT > ZEROES 
              AND RLO-NUM-IOPC IN RLO-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-RLO.
       FIN-VAL-CON-IKY-RLO.
           EXIT.
       
       VAL-NUM-KEY-RLO SECTION.
       INI-VAL-NUM-KEY-RLO.
           PERFORM VAL-NUM-IKY-RLO.
           PERFORM VAL-NUM-MKY-RLO.
           PERFORM VAL-NUM-AKY-RLO.
       FIN-VAL-NUM-KEY-RLO.
           EXIT.
       
       VAL-NUM-IKY-RLO SECTION.
       INI-VAL-NUM-IKY-RLO.
       VAL-NUM-RLO-IIC-IOPC.
           MOVE RLO-IIC-IOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO RLO-IIC-IOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-IIC-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-IKY-RLO.
       VAL-NUM-RLO-NUM-IOPC.
           MOVE RLO-NUM-IOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO RLO-NUM-IOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-NUM-IOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-IKY-RLO.
       FIN-VAL-NUM-IKY-RLO.
           EXIT.
       
       VAL-NUM-MKY-RLO SECTION.
       INI-VAL-NUM-MKY-RLO.
       FIN-VAL-NUM-MKY-RLO.
           EXIT.
       
       VAL-NUM-AKY-RLO SECTION.
       INI-VAL-NUM-AKY-RLO.
       FIN-VAL-NUM-AKY-RLO.
           EXIT.
       
       VAL-NUM-FLD-RLO SECTION.
       INI-VAL-NUM-FLD-RLO.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-CLIE.
           MOVE FRM-NUM-CLIE-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-CLIE IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-CLIE-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-RLO-VAL-MGAR.
           MOVE RLO-VAL-MGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RLO-VAL-MGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-MGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-RLO-VAL-SGAR.
           MOVE RLO-VAL-SGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO RLO-VAL-SGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-SGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-MOPC.
           MOVE FRM-VAL-MOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-MOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-SOPC.
           MOVE FRM-VAL-SOPC-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-SOPC IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-SOPC-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * VRF-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
      * VRF-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-RLO-VAL-PGAR.
           MOVE RLO-VAL-PGAR-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO RLO-VAL-PGAR IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RLO-VAL-PGAR-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       VAL-NUM-FRM-VAL-MLIB.
           MOVE FRM-VAL-MLIB-ALF IN RLO-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-MLIB IN RLO-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MLIB-LEN IN RLO-FLD
                GO TO FIN-VAL-NUM-FLD-RLO.
       FIN-VAL-NUM-FLD-RLO.
           EXIT.
       
       EDT-KEY-RLO SECTION.
       INI-EDT-KEY-RLO.
           PERFORM EDT-IKY-RLO.
           PERFORM EDT-MKY-RLO.
           PERFORM EDT-AKY-RLO.
       FIN-EDT-KEY-RLO.
           EXIT.
       
       EDT-IKY-RLO SECTION.
       INI-EDT-IKY-RLO.
           IF RLO-IIC-IOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-IIC-IOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-IKY-RLO.
           MOVE RLO-IIC-IOPC IN RLO-FLD TO RLO-IIC-IOPC-EDT IN RLO-EDT.
           MOVE RLO-IIC-IOPC-EDT IN RLO-EDT TO 
                RLO-IIC-IOPC-ALF IN RLO-FLD.
           IF RLO-NUM-IOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-NUM-IOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-IKY-RLO.
           MOVE RLO-NUM-IOPC IN RLO-FLD TO RLO-NUM-IOPC-EDT IN RLO-EDT.
           MOVE RLO-NUM-IOPC-EDT IN RLO-EDT TO 
                RLO-NUM-IOPC-ALF IN RLO-FLD.
       FIN-EDT-IKY-RLO.
           EXIT.
       
       EDT-MKY-RLO SECTION.
       INI-EDT-MKY-RLO.
       FIN-EDT-MKY-RLO.
           EXIT.
       
       EDT-AKY-RLO SECTION.
       INI-EDT-AKY-RLO.
       FIN-EDT-AKY-RLO.
           EXIT.
       
       EDT-FLD-RLO SECTION.
       INI-EDT-FLD-RLO.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-CLIE-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-CLIE-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-NUM-CLIE IN RLO-FLD TO
                FRM-NUM-CLIE-EDT IN RLO-EDT.
           MOVE FRM-NUM-CLIE-EDT IN RLO-EDT TO
                FRM-NUM-CLIE-ALF IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF RLO-VAL-MGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-MGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-MGAR IN RLO-FLD TO RLO-VAL-MGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-MGAR-EDT IN RLO-EDT TO 
                RLO-VAL-MGAR-ALF IN RLO-FLD.
           IF RLO-VAL-SGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-SGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-SGAR IN RLO-FLD TO RLO-VAL-SGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-SGAR-EDT IN RLO-EDT TO 
                RLO-VAL-SGAR-ALF IN RLO-FLD.
           IF FRM-VAL-MOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-MOPC IN RLO-FLD TO FRM-VAL-MOPC-EDT IN RLO-EDT.
           MOVE FRM-VAL-MOPC-EDT IN RLO-EDT TO 
                FRM-VAL-MOPC-ALF IN RLO-FLD.
           IF FRM-VAL-SOPC-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-SOPC-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-SOPC IN RLO-FLD TO FRM-VAL-SOPC-EDT IN RLO-EDT.
           MOVE FRM-VAL-SOPC-EDT IN RLO-EDT TO 
                FRM-VAL-SOPC-ALF IN RLO-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-NUM-ICLI IN RLO-FLD TO
                FRM-NUM-ICLI-EDT IN RLO-EDT.
           MOVE FRM-NUM-ICLI-EDT IN RLO-EDT TO
                FRM-NUM-ICLI-ALF IN RLO-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF RLO-VAL-PGAR-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RLO-VAL-PGAR-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE RLO-VAL-PGAR IN RLO-FLD TO RLO-VAL-PGAR-EDT IN RLO-EDT.
           MOVE RLO-VAL-PGAR-EDT IN RLO-EDT TO 
                RLO-VAL-PGAR-ALF IN RLO-FLD.
           IF FRM-VAL-MLIB-LEN IN RLO-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MLIB-LEN IN RLO-FLD
                GO TO FIN-EDT-FLD-RLO.
           MOVE FRM-VAL-MLIB IN RLO-FLD TO FRM-VAL-MLIB-EDT IN RLO-EDT.
           MOVE FRM-VAL-MLIB-EDT IN RLO-EDT TO 
                FRM-VAL-MLIB-ALF IN RLO-FLD.
       FIN-EDT-FLD-RLO.
           EXIT.
