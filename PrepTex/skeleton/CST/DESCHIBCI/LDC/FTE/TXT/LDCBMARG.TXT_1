*%! Codigo adicional para archivo LDCBMARG
*% IF FIN_PUT_CLF_ARG
      *<<<< FIN_PUT_CLF_ARG
           IF CLF-COD-AOCF IN ARG-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE CLF-COD-TOCF IN ARG-FLD TO
                                        WSS-COD-TOPE IN WSS-VARI
               MOVE CLF-COD-AOCF IN ARG-FLD TO
                                        WSS-COD-AOPE IN WSS-VARI
               MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AOCF IN ARG-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-AOCF IN ARG-FLD.
      *>>>>
*% END
*% IF LDC_NUM_ILDC
      *<<<< LDC_NUM_ILDC
           IF LDC-NUM-ILDC IN ARG-FLD NOT > ZEROES AND
              SCR-CMND = 'ACT'
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'LDC    BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-LDC-NUM-ILDC.
      *>>>>
*% END
*% IF FRM_COD_TOGA
      *<<<< FRM_COD_TOGA
      *FLB CST  23-DEC-1993 LIMPIA LA GLOSA
           IF FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) NOT > SPACES OR
              FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL'      OR
              FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'FIA'
               MOVE SPACES TO FRM-GLS-TOGA IN ARG-FLD(FRM-IFLD) 
               GO TO FIN-VAL-FRM-COD-TOGA.

      *FLB CST  23-DEC-1993 SOLO GARANTIAS DE GAR
      *VAL-COD Valida Cod. Tipo de Operacion de Tabla
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'TIO'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO
                                       TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-TOGA IN ARG-FLD(FRM-IFLD)
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                              FRM-GLS-TOGA IN ARG-FLD(FRM-IFLD).

      *FLB CST  9-DEC-1993 MODIFICADO PARA ADAPTAR A DMN Y RCR
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-FRM-COD-TOGA.

           MOVE TAB TO TIO.
           IF NOT ( TIO-GLS-SIST IN TIO = 'BGL' )
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CODTIOPNOSIS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-TOGA.

      *FLB CST  10-MAY-1994 MALA ESTA VALIDACION, LA ELIMINO            
      *AMP-INI 08-OCT-1993                                              
      *    IF FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) > SPACES AND            
      *       FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) > ZEROES                
      *        MOVE 'DEU' TO MSG-COD-SIST                               
      *        MOVE 'TIOYGARINV' TO MSG-COD-MENS                        
      *        PERFORM GET-MSG                                          
      *        MOVE MSG-GLS-DESC TO FRM-MENS                            
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR                            
      *        GO TO FIN-VAL-FRM-COD-TOGA.                              
      *AMP-FIN                        

      *FLB CST  10-MAY-1994                                             
      *CGL-INI                                                          
      *    MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO GAR-TIP-OPE IN TAG.
      *    MOVE SPACES                            TO GAR-STP-OPE IN TAG.
           MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO                    
                                                  TAG-COD-TOPE IN TAG.
           MOVE SPACES                       TO TAG-COD-SOPE   IN TAG.  
      *CGL-FIN                        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.       
      *CGL-INI                                                          
      *    IF NOT ( FIO-STAT-OKS AND  
      *       GAR-TIP-OPE IN TAG = FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) )  
           IF NOT ( FIO-STAT-OKS AND  
             TAG-COD-TOPE IN TAG = FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) )  
      *CGL-FIN                        
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-FRM-COD-TOGA.
           MOVE FIO-END-BRW TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.       
     
      *FLB CST  10-MAY-1994 FIN
      *>>>>
*% END
*% IF FRM_COD_AOGA
      *<<<< FRM_COD_AOGA
      *FLB CST  23-DEC-1993 LIMPIA LA GLOSA
           IF FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOGA IN ARG-FLD(FRM-IFLD) 
               GO TO FIN-VAL-FRM-COD-AOGA.

           IF ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = SPACES OR 'AVL' 
                                                           OR 'FIA' )
                  AND
              FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) > SPACES
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'AOGA>BLK' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-AOGA.

      *VAL-COD Valida Cod. Auxiliar de Operacion de Tabla
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'AUX'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO
                                       WSS-COD-TOPE IN WSS-VARI.
           MOVE FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) TO
                                       WSS-COD-AOPE IN WSS-VARI.
           MOVE WSS-COD-COPE IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-AOGA IN ARG-FLD(FRM-IFLD)
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                              FRM-GLS-AOGA IN ARG-FLD(FRM-IFLD).

      *FLB CST 28-OCT-1993 TRASLADADO AQUI
      *AMP-INI 09-OCT-1993
      *FLB CST 9-DEC-1993 
      *    IF FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) NOT > SPACES
      *         MOVE SPACES TO FRM-COD-AOGA IN ARG-FLD(FRM-IFLD).
           IF MSG-COD-MENS > SPACES
               GO TO FIN-VAL-FRM-COD-AOGA.
      *FLB CST 9-DEC-1993 FIN
      *CGL-INI                                                          
      *    MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO                    
      *         GAR-TIP-OPE IN TAG.                                     
      *    MOVE FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) TO                    
      *         GAR-STP-OPE IN TAG.                                     
           MOVE FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) TO                    
                     TAG-COD-TOPE IN TAG.                               
           MOVE FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) TO                    
               TAG-COD-SOPE IN TAG.                                     
      *CGL-FIN                                                          
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM BGL-FIO-TAG.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'BGL'        TO MSG-COD-SIST                        
               MOVE 'TAG    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-AOGA.
      *AMP-FIN 09-OCT-1993
      *>>>>
*% END
*% IF FRM_CAI_IGAR
      *<<<< FRM_CAI_IGAR
      *<<<< FRM_CAI_IGAR
      * LTM-INI 21-04-1994
      *FLB CST  6-MAY-1994 
      *    IF FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
           IF FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) NOT > SPACES AND
              FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-FRM-CAI-IGAR.

      *FLB CST  10-MAY-1994 COHERENCIA CON LDCBULDC
           IF FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) > SPACES AND
              (
              NOT ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = ' ' OR 'AVL' OR 
                                                        'FIA' ) OR
              FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) > SPACES 
              )
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CAI>SPACES' TO MSG-COD-TMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-CAI-IGAR.

      *FLB CST  23-JUN-1994 CORREGIDO
           MOVE 'TAB'                TO FIO-SIST.
           MOVE 'VSN '               TO TAB-COD-TTAB IN TAB.
           MOVE 'CICXSUC'            TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' AND
              FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) NOT > SPACES AND
              ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = ' ' OR 'AVL' OR 
                                                    'FIA' )
               PERFORM ERR-GLS
               GO TO FIN-VAL-FRM-CAI-IGAR.

           IF FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) NOT > SPACES
               GO TO FIN-VAL-FRM-CAI-IGAR.

           MOVE FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) TO CIC-CAI-ICIC
                                                     IN CIC.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' AND
              ( ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL' OR 'FIA' ) 
                      AND
*% IF NOT ( PGM_CHI AND PGM_BCI )
                CIC-COD-TCIC IN CIC NOT = 'F' 
*% ELSE
                CIC-COD-TCIC IN CIC NOT = 'F'                           
*% END
                      OR 
                NOT 
                ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL' OR 'FIA' )
                      AND
*% IF NOT ( PGM_CHI AND PGM_BCI )
                CIC-COD-TCIC IN CIC NOT = 'G' 
*% ELSE
      *<<<< PGM_CHI AND PGM_BCI
                CIC-CAI-ICIC IN CIC NOT = '0500'
      *>>>>
*% END
              )
               MOVE 'TAB'    TO MSG-COD-SIST
               MOVE 'CAIINV' TO MSG-COD-TMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-CAI-IGAR.

           IF NOT ( FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' )
      * NO HAY QUE VALIDAR EL CAI
               GO TO FIN-VAL-FRM-CAI-IGAR.

           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-CIC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'CICSTAT' TO MSG-COD-TMSG
               MOVE CIC-STAT-NEX TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-CAI-IGAR.
      *FLB CST  23-JUN-1994 FIN
      *>>>>
*% END
*% IF FRM_IIC_IGAR
      *<<<< FRM_IIC_IGAR
      *FLB CST  10-MAY-1994 NO SE ENGANCHA A GAR O FIA
           IF FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) > SPACES AND
              FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
               PERFORM ERR-GLS
               GO TO FIN-VAL-FRM-IIC-IGAR.

      *FLB CST  10-MAY-1994 MALA ESTA VALIDACION, LA ELIMINO
      *    IF ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL' OR 'FIA' )
      *           AND
      *       FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
      *        MOVE 'DEU' TO MSG-COD-SIST
      *        MOVE 'IICIGAR=0' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-FRM-IIC-IGAR.

      *FLB CST  10-MAY-1994 MALA ESTA VALIDACION, LA ELIMINO
      *    IF FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
      *        GO TO FIN-VAL-FRM-IIC-IGAR.

      *FLB CST  10-MAY-1994 COHERENCIA CON LDCBULDC
           IF FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) > ZEROES AND 
              (
              NOT ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = ' ' OR 'AVL' OR 
                                                        'FIA' ) OR
              FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) > SPACES 
              )
               MOVE 'IICIGAR>0' TO MSG-COD-MENS
               MOVE 'DEU'       TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-IIC-IGAR.

      *FLB CST  10-MAY-1994 NO SE OTORGA CORRELATIVOS
           IF FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) NOT > ZEROES
               GO TO FIN-VAL-FRM-IIC-IGAR.

           IF ( FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL' OR 'FIA' ) 
               MOVE FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) TO 
                                              FIA-CAI-IESC IN FIA
               MOVE FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) TO 
                                              FIA-IIC-IESC IN FIA
               MOVE 1                       TO FIA-NUM-IFIA IN FIA
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DEU-FIO-FIA
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'FIA    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-FRM-IIC-IGAR
            ELSE
      *CGL-INI                                                          
      *        MOVE FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) TO                
      *                                         GAR-NUM-SIS IN GDG      
      *        MOVE FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) TO                
      *                                         GAR-COD-CRR IN GDG      
               MOVE FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) TO                
                                                GDG-CAI-GTIA IN GDG     
               MOVE FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) TO                
                                                GDG-IIC-GTIA IN GDG     
      *CGL-FIN                                                          
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM BGL-FIO-GDG                                      
               IF NOT FIO-STAT-OKS
                   MOVE 'DEU'        TO MSG-COD-SIST
                   MOVE 'GDG    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-FRM-IIC-IGAR
               ELSE
                   GO TO FIN-VAL-FRM-IIC-IGAR.
      *>>>>
*% END
*% IF FRM_NUM_PORG
      *<<<< FRM_NUM_PORG
           IF FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) = 'AVL' 
                MOVE 100 TO FRM-NUM-PORG IN ARG-FLD(FRM-IFLD).

           IF NOT (
              FRM-COD-TOGA IN ARG-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOGA IN ARG-FLD(FRM-IFLD) > SPACES OR
              FRM-CAI-IGAR IN ARG-FLD(FRM-IFLD) > SPACES OR
              FRM-IIC-IGAR IN ARG-FLD(FRM-IFLD) > ZEROES OR
              FRM-NUM-PORG IN ARG-FLD(FRM-IFLD) > ZEROES 
                  )
               GO TO FIN-VAL-FRM-NUM-PORG.

           IF FRM-NUM-PORG IN ARG-FLD(FRM-IFLD) NOT > ZEROES
               MOVE 'DEU'       TO MSG-COD-SIST
               MOVE 'PORGOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-PORG.

           PERFORM VAL-ARG-IGUA VARYING WSS-IFLD FROM 1 BY 1
                      UNTIL WSS-IFLD > 9 OR MSG-COD-MENS > SPACES.

           IF MSG-COD-MENS > SPACES
               MOVE 'DEU'   TO MSG-COD-SIST
               MOVE 'ARG=S' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.

      *>>>>
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<<
      *VAL-RUT Valida Rut para campo IDC                                
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE DBC-NUM-ICLI IN ARG-FLD TO IDC-NUM-RUTV.                
           MOVE DBC-VRF-ICLI IN ARG-FLD TO IDC-VRF-RUTV.                
           PERFORM VAL-RUT.                                             
      *>>>>
*% END
*% IF FIN_DBC_IND_ICLI
      *<<<<
      *VAL-IDC Valida identificador                                     
           MOVE DBC-IND-ICLI IN ARG-FLD TO IDC-IND-RUTV.                
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN ARG-FLD.                
      *>>>>
*% END
