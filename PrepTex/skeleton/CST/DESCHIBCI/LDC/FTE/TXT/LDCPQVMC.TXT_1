*%! Codigo adicional para archivo
*% PGM_PTC = TRUE
*% IF MI_COMMAREA
      *<<<< MI_COMMAREA
           03 CMA-VARI.
              05 SCR-IND-MCLI                         PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY TABBRCAM.
       COPY COLBRROV.
       COPY COLBRTOC.
       COPY COLBRRCV.
       COPY COLBRRDC.
       COPY COLBRDLC.
       COPY GNSBRRCE.
       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGQUE.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCWGGRP.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY LDCWGCCU.
       COPY LDCWGCEG.
       COPY LDCBRLDC.
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY SGCBRDBC.
       COPY SGCBRREC.
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.

       01  WSS-VARI.
           03 WSS-COD-CVMC.
              05  WSS-COD-MENS                         PIC X(12).
              05  WSS-COD-MEN2                         PIC X(12).
              05  WSS-NUM-MENS                         PIC 9(02).
              05  WSS-NUM-MEN2                         PIC 9(02).
              05  WSS-CAMB                             PIC X(28).
           03 WSS-MENS.
              05 WSS-MEN1                              PIC X(40).
              05 WSS-MEN2                              PIC X(40).
           03 WSS-FEC-FCIE     VALUE 0            PIC 9(08).
           03 WSS-CIC-ICLF                        PIC X(12).
           03 WSS-IBUS                             PIC 9(01).
           03 WSS-IBUS-LDC                         PIC 9(01).

           03 WSS-T                 VALUE ZEROES   PIC 9(02).
           
           03 PGM-STAT-ADI.
              05 PGM-STAT-RDC           VALUE '23' PIC X(02).
                   88 PGM-STAT-RDC-OKS  VALUE '00'.
                   88 PGM-STAT-RDC-NUL  VALUE '  '.
           03 WSS-FEC-FHOY.
              05 WSS-NUM-SHOY                      PIC 9(02).
              05 WSS-NUM-AHOY                      PIC 9(02).
              05 WSS-NUM-MHOY                      PIC 9(02).
              05 WSS-NUM-DHOY                      PIC 9(02).
              05 WSS-COD-PESO                      PIC X(06).
           03 WSS-COD-CAUX.
              05  WSS-COD-TOOC                     PIC X(03).
              05  WSS-COD-AOOC                     PIC X(03).

           03 WSS-FEC.
              05  WSS-SFEC                         PIC 9(02).
              05  WSS-AFEC                         PIC 9(02).
              05  WSS-MFEC                         PIC 9(02).
              05  WSS-DFEC                         PIC 9(02).
           03 WSS-VAR-CCU.
              05  WSS-I                              PIC 9(02).
              05  WSS-J                              PIC 9(02).
              05  WSS-K                              PIC 9(02).
              05  WSS-L                              PIC 9(02).
              05  WSS-STAT                           PIC X(02).
                  88 WSS-STAT-OKS VALUE SPACES.
              05  WSS-CMND                           PIC X(03).

      *>>>>
*% END
*% IF INI_HBL_IKY
      *<<<< INI_HBL_IKY
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-IND-MCLI.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      * SMC-INI  8-MAR-1996 
           PERFORM GNS-ERR-QUE.
      * SMC-FIN  8-MAR-1996 
      * OBTIENE CODIGO VALOR DE CAMBIO DE PESOS MEDIANTE CIC MONEDA
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               PERFORM PRG-ABT.
           MOVE TAB-COD-CTAB IN TAB TO CCU-COD-PESO IN CCU-VARI.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       LEE-PAD-CLF.
      * Lee por Capacidad de Credito y luego busca Cliente
           IF CLF-IIC-ICLF IN VMC-FLD > ZEROES
               PERFORM KEY-ALL-VMC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM LDC-FIO-CLF
               MOVE FIO-STAT TO PGM-STAT-CLF
               IF FIO-STAT-OKS
                  PERFORM GET-CUR-RDC
                  IF NOT PGM-STAT-RDC-OKS
                     MOVE 'DEU'          TO MSG-COD-SIST
                     MOVE 'CLF    NORDC' TO MSG-COD-MENS
                     MOVE SCR-STAT-CON TO SCR-STAT
                     GO TO ERR-FND-KEY
                  ELSE
                     MOVE RDC-CIC-ICLI IN RDL TO DBC-CIC-ICLI IN DBC
                     MOVE FIO-GET-KEY    TO FIO-CMND
                     PERFORM SGC-FIO-DBC
                     MOVE FIO-STAT TO PGM-STAT-DBC
                     IF NOT FIO-STAT-OKS
                        MOVE 'TAB'        TO MSG-COD-SIST
                        MOVE 'CLI    NEX' TO MSG-COD-MENS
                        PERFORM GET-MSG
                        MOVE MSG-GLS-DESC TO FRM-MENS
                        MOVE FIO-STAT-NEX TO PGM-STAT-DBC
                        MOVE SCR-STAT-CON TO SCR-STAT
                        GO TO ERR-FND-KEY
                     ELSE
                        MOVE DBC-CAI-ICLI IN DBC
                                          TO DBC-CAI-ICLI IN VMC-FLD
                        MOVE DBC-IIC-ICLI IN DBC
                                          TO DBC-IIC-ICLI IN VMC-FLD
                        PERFORM GET-NXT-RDC
                        MOVE '00' TO PGM-STAT-DBC
                        MOVE '00' TO FIO-STAT
                        GO TO FIN-BUS-PAD
           ELSE
              MOVE 'CLF    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO ERR-FND-KEY.

      * Lee Cliente y luego busca Capacidad de Credito
      *    busca el padre por alguna de las llaves (la digitada)
           IF DBC-NUM-ICLI IN VMC-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN VMC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN VMC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN VMC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN VMC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN VMC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO
                        DBC-IIC-ICLI IN VMC-FLD
                   MOVE '00' TO PGM-STAT-DBC
                   GO TO FIN-BUS-CLI-KEY.

           IF DBC-GLS-NOMC IN VMC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE DBC-GLS-NOMC IN VMC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO
                    DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO
                    DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO
                    DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE DBC-NUM-ICLI IN DBC TO
                        DBC-NUM-ICLI IN VMC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO
                        DBC-VRF-ICLI IN VMC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO
                        DBC-IND-ICLI IN VMC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO
                        DBC-GLS-ICLI IN VMC-FLD
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN VMC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO
                        DBC-CAI-ICLI IN VMC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO
                        DBC-IIC-ICLI IN VMC-FLD
                   MOVE '00' TO PGM-STAT-DBC
                   GO TO FIN-BUS-CLI-KEY.

       FIN-BUS-CLI-KEY.
            IF MSG-COD-MENS > SPACES
                MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
                GO TO ERR-FND-KEY.

           MOVE '00' TO PGM-STAT-DBC.
           MOVE SPACES TO MSG-COD-MENS
           PERFORM BUS-CLF.
           IF MSG-COD-MENS > SPACES
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              GO TO ERR-FND-KEY.

       FIN-BUS-PAD.

           IF NOT FIO-STAT-OKS
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO ERR-FND-KEY.

      * SMC-INI  8-MAR-1996
           MOVE SCR-OTRN TO QUE-TERM.
           MOVE 'TVMC'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      * SMC-FIN  8-MAR-1996

           IF ( DBC-GLS-NOMC IN VMC-FLD > SPACES OR
                DBC-NUM-ICLI IN VMC-FLD NOT = ZEROES )
                IF OPC-COD-VCOC IN VMC-FLD > SPACES
                   PERFORM LLAMA-CCU-COL
                ELSE
                   PERFORM LLAMA-CCU-LDC
           ELSE
                IF OPC-COD-VCOC IN VMC-FLD > SPACES
                   PERFORM LLAMA-CCU-COL
                ELSE
                   PERFORM LLAMA-CCU-LDC.
      * SMC-INI  8-MAR-1996
           MOVE SCR-OTRN TO QUE-TERM.
           MOVE 'TVMC'   TO QUE-TYPE.
           MOVE QUE-DEL  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      * SMC-FIN  8-MAR-1996

       ERR-FND-KEY.
           MOVE SCR-STAT-CON TO SCR-STAT.
           IF FRM-MENS > SPACES
               MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.

      *  Busca mensaje error en Sistema LDC
           IF WSS-IBUS = 0 AND WSS-IBUS-LDC = 0
      *  busco por padre y no encontro padre
               MOVE SPACES TO PGM-STAT
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE FIO-STAT-NEX TO PGM-STAT-CLF
           ELSE
      *  todos otros casos: el error pertenece al sistema LDC
               MOVE 'DEU' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE CLF-CIC-ICLF IN CLF TO RDC-CIC-ICLF IN RDL.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-CDK
               MOVE '00' TO FIO-STAT.
      *FLB CST  21-JAN-1994 
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF NOT = RDC-CIC-ICLF IN RDL
               MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC
               MOVE '23' TO FIO-STAT.

           MOVE FIO-STAT TO PGM-STAT-RDC.
       FIN-GET-CUR-RDC.
           EXIT.

       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'RDC-KEY-ICLF' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           IF FIO-STAT-OKS AND
              CLF-CIC-ICLF IN CLF = RDC-CIC-ICLF IN RDL
                MOVE 'M' TO SCR-IND-MCLI
           ELSE
                MOVE SPACES TO SCR-IND-MCLI
                IF FIO-STAT-OKS
                    MOVE FIO-END-BRW TO FIO-CMND
                    MOVE 'RDC-KEY-ICLF' TO FIO-AKEY
                    PERFORM LDC-FIO-RDC.
       FIN-GET-NXT-RDC.
           EXIT.

       BUS-CLF SECTION.
       INI-BUS-CLF.
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDL.
           MOVE SPACES              TO RDC-CIC-ICLF IN RDL.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF NOT ( FIO-STAT-OKS AND 
                    DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDL )
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CLF    NORDC' TO MSG-COD-MENS
               GO TO BRW-BUS-CLF.

           MOVE ZEROES TO WSS-FEC-FCIE.
           MOVE RDC-CIC-ICLF IN RDL TO WSS-CIC-ICLF.
       LUP-BUS-CLF.
           MOVE RDC-CIC-ICLF IN RDL TO CLF-CIC-ICLF IN CLF.
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN VMC-FLD.
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN VMC-FLD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           PERFORM LDC-FIO-CLF.
           IF NOT FIO-STAT-OKS
               MOVE 'CLF    NEX' TO MSG-COD-MENS
               GO TO BRW-BUS-CLF.

           IF NOT ( CLF-MSC-STAT IN CLF = 'C' OR 'R' )
               GO TO BRW-BUS-CLF.

           IF CLF-FEC-FCIE IN CLF > WSS-FEC-FCIE
               MOVE CLF-CIC-ICLF IN CLF TO WSS-CIC-ICLF
               MOVE CLF-FEC-FCIE IN CLF TO WSS-FEC-FCIE.

       NXT-BUS-CLF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM LDC-FIO-RDC.
           MOVE FIO-STAT TO PGM-STAT-RDC.
           IF FIO-STAT-OKS AND 
              DBC-CIC-ICLI IN DBC = RDC-CIC-ICLI IN RDL
               GO TO LUP-BUS-CLF.

           MOVE WSS-CIC-ICLF TO CLF-CIC-ICLF IN CLF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM LDC-FIO-CLF.
           MOVE FIO-STAT TO PGM-STAT-CLF.
           MOVE CLF-CAI-ICLF IN CLF TO CLF-CAI-ICLF IN VMC-FLD.
           MOVE CLF-IIC-ICLF IN CLF TO CLF-IIC-ICLF IN VMC-FLD.
       BRW-BUS-CLF.
           IF PGM-STAT-RDC-OKS
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM LDC-FIO-RDC.
       FIN-BUS-CLF.
           EXIT.

       LLAMA-CCU-LDC SECTION.
       INI-LLAMA-CCU-LDC.

           IF ( CLF-MSC-STAT IN CLF = 'A' OR 
                CLF-MSC-STAT IN CLF = 'V' OR
                CLF-COD-STAT IN CLF = 'M' AND
                CLF-MSC-STAT IN CLF NOT = 'V' OR
                CLF-COD-STAT IN CLF = 'X' ) 

               MOVE CLF-KEY-ICLF IN CLF TO CCU-CIC-ICLF
               MOVE SPACES TO CCU-CAI-IOPC(1)
               MOVE ZEROES TO CCU-IIC-IOPC(1)
               MOVE SPACES TO CCU-CAI-DCAN(1)
               MOVE ZEROES TO CCU-IIC-DCAN(1)
               MOVE ZEROES TO CCU-NUM-DCAN(1)
               MOVE SPACES TO CCU-OPE-INDS
               MOVE 'C'      TO CCU-VPAN IN CCU-VARI
               MOVE SCR-OTRN TO CCU-OTRN
               PERFORM LDC-PRO-CCU
               PERFORM OBT-DAT-TS
               IF WSS-T = ZEROS
                  MOVE 'DEU'             TO MSG-COD-SIST
                  MOVE 'CLF     SMSG'    TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES   TO FRM-MENS
                  MOVE '00' TO FIO-STAT
                  MOVE MSG-GLS-DESC TO FRM-GLS-MCCU IN VMC-FLD(01)
               ELSE
                  NEXT SENTENCE 
           ELSE
               MOVE 'CLF    NOVIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO ERR-FND-KEY.

       FIN-LLAMA-CCU-LDC.
           EXIT.

       LLAMA-CCU-COL SECTION.
       INI-LLAMA-CCU-COL.
           MOVE SPACES                  TO CCU-CAI-IOPC IN CCU-VARI(1).
           MOVE ZEROS                   TO CCU-IIC-IOPC IN CCU-VARI(1).
           MOVE OPC-VAL-CRED IN VMC-FLD TO CCU-VAL-SCRE IN CCU-VARI(1).
           MOVE OPC-COD-VCOC IN VMC-FLD TO CCU-VOPR     IN CCU-VARI.
           MOVE 'C'                     TO CCU-VPAN     IN CCU-VARI.
           PERFORM SET-CCU.
      * Respalda comando en WSS-CMND
           MOVE SCR-CMND TO WSS-CMND.
           MOVE 'ACA'    TO SCR-CMND.
           MOVE 'F'      TO CCU-ATLF.
      * Verifica llamado a rutina de evaluacion de cupos.
        COPY COLIPCCU.
      * Restaura comando desde WSS-CMND
           MOVE WSS-CMND TO SCR-CMND.
           PERFORM OBT-DAT-TS

           IF WSS-T = ZEROS
              MOVE 'DEU'             TO MSG-COD-SIST
              MOVE 'CLF     SMSG'    TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE SPACES   TO FRM-MENS
              MOVE '00' TO FIO-STAT
              MOVE MSG-GLS-DESC TO FRM-GLS-MCCU IN VMC-FLD(01).

           IF CCU-SERR = 'E'
              MOVE SPACES   TO FRM-MENS
              GO TO FIN-LLAMA-CCU-COL.



       FIN-LLAMA-CCU-COL.
           EXIT.

       SET-CCU SECTION.
       INI-SET-CCU.
           MOVE HIGH-VALUES              TO CCU-CAI-IOPC IN CCU-VARI(1).
           MOVE 99999999                 TO CCU-IIC-IOPC IN CCU-VARI(1).
           MOVE 'N'                      TO CCU-EOPC     IN CCU-VARI.
           MOVE OPC-VAL-CRED IN VMC-FLD  TO CCU-SCRE     IN CCU-VARI.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY                 TO FEC-ITM1.
           MOVE HOY-MHOY                 TO FEC-ITM2.
           MOVE HOY-SHOY                 TO FEC-ITM3.
           MOVE HOY-AHOY                 TO FEC-ITM4.
           MOVE FEC-FORM-FEC             TO FEC-FORM.
           MOVE FRM-NUM-MESC IN VMC-FLD  TO FEC-NMES.
           MOVE FEC-SUM-MES              TO FEC-CMND.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1                 TO WSS-DFEC.
           MOVE FEC-ITM2                 TO WSS-MFEC.
           MOVE FEC-ITM3                 TO WSS-SFEC.
           MOVE FEC-ITM4                 TO WSS-AFEC.
           MOVE WSS-FEC                  TO CCU-FMAV     IN CCU-VARI.
           MOVE OPC-COD-TOOC IN VMC-FLD  TO WSS-COD-TOOC.
           MOVE OPC-COD-AOOC IN VMC-FLD  TO WSS-COD-AOOC.
           MOVE WSS-COD-CAUX             TO CCU-COPR     IN CCU-VARI.
           MOVE OPC-COD-VCOC IN VMC-FLD  TO CCU-VOPR     IN CCU-VARI.
           MOVE DBC-CAI-ICLI IN VMC-FLD  TO CCU-CAI-ICLI IN CCU-VARI.
           MOVE DBC-IIC-ICLI IN VMC-FLD  TO CCU-IIC-ICLI IN CCU-VARI.
           MOVE SPACES                   TO CCU-CIC-ICLF IN CCU-VARI.
           MOVE 'C'                      TO CCU-VPAN IN CCU-VARI
           MOVE SCR-OTRN                 TO CCU-OTRN
       FIN-SET-CCU.
           EXIT.

       OBT-DAT-TS SECTION.
       INI-OBT-DAT-TS.
           PERFORM GNS-ERR-QUE.
           MOVE SCR-OTRN     TO QUE-TERM.
           MOVE 0 TO QUE-NITM WSS-T.
       LUP-PRO-TS-D.
           MOVE 'TVMC'       TO QUE-TYPE.
           ADD 1             TO QUE-NITM.
           MOVE 9999         TO QUE-LITM.
           MOVE QUE-GET      TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO FIN-OBT-DAT-TS.
           MOVE QUE-ITEM     TO WSS-COD-CVMC.
           PERFORM OBT-MSG-CCU 
           ADD 1 TO WSS-T
           MOVE WSS-MENS IN WSS-VARI TO FRM-GLS-MCCU IN VMC-FLD(WSS-T)
           GO TO LUP-PRO-TS-D.
       FIN-OBT-DAT-TS.
           EXIT.

       OBT-MSG-CCU SECTION.
       INI-OBT-MSG-CCU.
           MOVE SPACES            TO WSS-MEN1
                                     WSS-MEN2.

           MOVE 'DEU'             TO MSG-COD-SIST.
           IF WSS-NUM-MENS IN WSS-VARI > ZEROES AND
              ( WSS-NUM-MEN2 IN WSS-VARI > ZEROES OR 
                WSS-CAMB IN WSS-VARI > SPACES )
               MOVE WSS-COD-MENS IN WSS-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO WSS-MEN1
               IF WSS-CAMB IN WSS-VARI > SPACES 
                   MOVE WSS-CAMB IN WSS-VARI TO WSS-MEN2
               ELSE
                   MOVE WSS-COD-MEN2 IN WSS-VARI TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO WSS-MEN2
           ELSE
           IF WSS-NUM-MENS IN WSS-VARI > ZEROES
               MOVE WSS-COD-MENS IN WSS-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO WSS-MEN2
           ELSE
               MOVE WSS-COD-MEN2 IN WSS-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO WSS-MEN2.

      *MHM-INI 2-JUL-1999
               MOVE '00' TO FIO-STAT.
      *MHM-FIN 2-JUL-1999
       FIN-OBT-MSG-CCU.
           EXIT.


       COPY GNSBGQUE.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBGHOY.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGPES.
       COPY COLBGCCU.
       COPY LDCBGCCU.
       COPY LDCBGCEG.
       COPY LDCBKCCU.
       COPY LDCBKCEG.
       COPY LDCBFLDC.
       COPY TABBFCAM.
       COPY COLBFOPC.
       COPY COLBFROV.
       COPY COLBFTOC.
       COPY COLBFRCV.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFREC.
       COPY SGCBBGRP.
       COPY LDCBFRDC REPLACING RDC BY RDL.
       COPY SGCBGCLI.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBFUSR.
       COPY TABBBUSR.
      *>>>>
*% END
