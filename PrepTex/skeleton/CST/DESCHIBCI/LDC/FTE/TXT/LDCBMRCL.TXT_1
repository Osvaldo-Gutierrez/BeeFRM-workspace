*%!Codigo adicional BM pantalla RCL
*% IF SETTAG
*% FNCBQ = " "
*% VSNBQ = " "
*% FNCBU = " "
*% VSNBU = " "
*% END
*% IF INI_RCL_CAI_ICLF
           GO TO FIN-VAL-RCL-CAI-ICLF.
*% END
*% IF INI_RCL_IIC_ICLF
           GO TO FIN-VAL-RCL-IIC-ICLF.
*% END
*% IF FIN_PUT_ALL_RCL
      *<<<<FRM_VAL_MASO
      *AFRI-INI/AGO2008(MAE)
           MOVE RCL-CAI-ICLF IN RCL-FLD TO CLF-CAI-ICLF IN PRY-VARI.
           MOVE RCL-IIC-ICLF IN RCL-FLD TO CLF-IIC-ICLF IN PRY-VARI.
           PERFORM  CAL-MTO-ASO.
           MOVE WSS-VAL-MASO IN PRY-VARI TO FRM-VAL-MASO IN RCL-FLD.
      *AFRI-FIN/AGO2008(MAE)
      *>>>>
*% END
*% IF FIN_KEY_RCL_RCL
      *<<<< FIN_KEY_RCL_RCL
           MOVE 1                       TO RCL-NUM-TREC IN RCL.
           MOVE DBC-CAI-ICLI IN RCL-FLD TO RCL-CAI-ICLI IN RCL.
           MOVE DBC-IIC-ICLI IN RCL-FLD TO RCL-IIC-ICLI IN RCL.
      *>>>>
*% END
*% IF INI_RCL_COD_TREL
           IF RCL-COD-TREL IN RCL-FLD NOT > SPACES
              MOVE SPACES TO RCL-COD-TREL IN RCL-FLD.
      
           MOVE 'DEU' TO TAB-COD-SIST.                                  
           MOVE 'REL ' TO TAB-COD-TTAB IN TAB.                          
           MOVE RCL-COD-TREL IN RCL-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS = 'COD    NEX' OR                            
              RCL-COD-TREL IN RCL-FLD NOT > SPACES                      
               MOVE SPACES TO FRM-GLS-TREL IN RCL-FLD                   
           ELSE                                                         
               MOVE TAB-GLS-DESC IN TAB TO                              
                    FRM-GLS-TREL IN RCL-FLD.                            

           GO TO FIN-VAL-RCL-COD-TREL.
*% END
*% IF INI_VAL_CON_KEY_RCL                                         
      *<<<< INI_VAL_CON_KEY_RCL                                         
           IF RCL-CAI-ICLF IN RCL-FLD > SPACES AND                      
              RCL-IIC-ICLF IN RCL-FLD NOT > ZEROES                      
               MOVE 'COL' TO MSG-COD-SIST                               
               MOVE 'RCLICLFNOCON' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-KEY-RCL.                               
                                                                        
      * CONDICION 1 ( SOLO ICLI (NOMBRE O IDC) )                        
                                                                        
           IF NOT ((( DBC-NUM-ICLI IN RCL-FLD > ZEROES OR               
                      DBC-GLS-NOMC IN RCL-FLD > SPACES ) AND            
                      RCL-IIC-ICLF IN RCL-FLD NOT > ZEROES ) OR         
                                                                        
      * CONDICION 2 ( ICLI (NOMBRE O IDC) + ICLF )                      
                   (( DBC-NUM-ICLI IN RCL-FLD > ZEROES OR               
                      DBC-GLS-NOMC IN RCL-FLD > SPACES ) AND            
                      RCL-IIC-ICLF IN RCL-FLD > ZEROES ) OR             
                                                                        
      * CONDICION 3 ( SOLO ICLF )                                       
                    ( RCL-IIC-ICLF IN RCL-FLD > ZEROES     AND          
                      DBC-NUM-ICLI IN RCL-FLD NOT > ZEROES AND          
                      DBC-GLS-NOMC IN RCL-FLD NOT > SPACES ) OR         
                                                                        
      * CONDICION 4 ( ICLF + IDLC )                                     
                    ( RCL-IIC-ICLF IN RCL-FLD > ZEROES AND              
                      DBC-NUM-ICLI IN RCL-FLD NOT > ZEROES AND          
                      DBC-GLS-NOMC IN RCL-FLD NOT > SPACES ) OR         
                                                                        
      * CONDICION 5 ( TODO LLENO ( ICLI + ICLF + IDLC )                 
                    ( RCL-IIC-ICLF IN RCL-FLD > ZEROES AND              
                    ( DBC-NUM-ICLI IN RCL-FLD > ZEROES OR               
                      DBC-GLS-NOMC IN RCL-FLD > SPACES )))              
                                                                        
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'VALCONKEY' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-KEY-RCL.                               
      *>>>>                                                             
      *<<<<INI_VAL_CON_KEY_RCL
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_RCL                                         
      *<<<< INI_VAL_CON_IKY_RCL                                         
           IF RCL-CAI-ICLF IN RCL-FLD > SPACES AND                      
              RCL-IIC-ICLF IN RCL-FLD NOT > ZEROES                      
               MOVE 'COL' TO MSG-COD-SIST                               
               MOVE 'RCLICLFNOCON' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-IKY-RCL.                               
                                                                        
           IF NOT (( DBC-NUM-ICLI IN RCL-FLD > ZEROES OR                
                     DBC-GLS-NOMC IN RCL-FLD > SPACES ) AND             
                                                                        
                     RCL-IIC-ICLF IN RCL-FLD > ZEROES )                 
                                                                        
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'VALCONIKY' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-IKY-RCL.                               
                                                                        
      *>>>>                                                             
*% END
*% IF RCL_VAL_PRCL

      *<<<<RCL_VAL_PRCL
           IF RCL-VAL-PRCL IN RCL-FLD NOT > ZEROES
               MOVE 100 TO RCL-VAL-PRCL IN RCL-FLD.
      *AFRI-INI/AGO2008(MAE)
           MOVE RCL-VAL-PRCL IN RCL-FLD TO RCL-VAL-PRCL IN PRY-VARI.
           PERFORM  VAL-MAX-POR.
           IF (PRY-IND-ERRO IN PRY-VARI     = 'S' OR
               PRY-IND-MPOR IN PRY-VARI NOT = 'S')
                MOVE 'DEU'                    TO MSG-COD-SIST
                MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC             TO FRM-MENS
                MOVE FRM-SUAR-MAL             TO FRM-SUAR
                MOVE ZEROES TO RCL-VAL-PRCL IN RCL-FLD
                GO TO FIN-VAL-RCL-VAL-PRCL.
      *AFRI-FIN/AGO2008(MAE)
      *>>>>


*% END
*% IF FRM_VAL_MASO
      *<<<<FRM_VAL_MASO
      *AFRI-INI/AGO2008(MAE)                                            
           MOVE RCL-CAI-ICLF IN RCL-FLD TO CLF-CAI-ICLF IN PRY-VARI.
           MOVE RCL-IIC-ICLF IN RCL-FLD TO CLF-IIC-ICLF IN PRY-VARI.
           MOVE RCL-VAL-PRCL IN RCL-FLD TO RCL-VAL-PRCL IN PRY-VARI.
           PERFORM  CAL-MTO-ASO.                                        
           IF (PRY-IND-ERRO IN PRY-VARI     = 'S' OR                    
               PRY-IND-MASO IN PRY-VARI NOT = 'S')
                MOVE 'DEU'                    TO MSG-COD-SIST           
                MOVE PRY-COD-MENS IN PRY-VARI TO MSG-COD-MENS           
                PERFORM GET-MSG                                         
                MOVE MSG-GLS-DESC             TO FRM-MENS               
                MOVE FRM-SUAR-MAL             TO FRM-SUAR               
                MOVE ZEROES     TO FRM-VAL-MASO IN RCL-FLD
                GO TO FIN-VAL-FRM-VAL-MASO
            ELSE
                MOVE WSS-VAL-MASO IN PRY-VARI TO FRM-VAL-MASO
                GO TO FIN-VAL-FRM-VAL-MASO.
      *AFRI-FIN/AGO2008(MAE)                                            
      *>>>>

*% END
